<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[CharlesæŠ“åŒ…å®æˆ˜ï¼Œå¼€å‘è€…å¦‚ä½•é€šè¿‡æµé‡åˆ†æå¿«é€Ÿå®šä½ç³»ç»Ÿå¼‚å¸¸ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7573776814926987283</link>    <guid>https://juejin.cn/post/7573776814926987283</guid>    <pubDate>2025-11-18T02:20:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573776814926987283" data-draft-id="7573597479980892196" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CharlesæŠ“åŒ…å®æˆ˜ï¼Œå¼€å‘è€…å¦‚ä½•é€šè¿‡æµé‡åˆ†æå¿«é€Ÿå®šä½ç³»ç»Ÿå¼‚å¸¸ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-18T02:20:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="00åç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/1159358440539900"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CharlesæŠ“åŒ…å®æˆ˜ï¼Œå¼€å‘è€…å¦‚ä½•é€šè¿‡æµé‡åˆ†æå¿«é€Ÿå®šä½ç³»ç»Ÿå¼‚å¸¸ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1159358440539900/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    00åç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:20:11.000Z" title="Tue Nov 18 2025 02:20:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œæœ€è®©äººæ— ä»ä¸‹æ‰‹çš„é”™è¯¯ï¼Œå¾€å¾€ä¸æ˜¯ä»£ç å¼•å‘çš„ï¼Œè€Œæ˜¯ç½‘ç»œé“¾è·¯é‡Œçš„â€œä¸ç¡®å®šè¡Œä¸ºâ€ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>é¡µé¢æ˜æ˜å‘èµ·äº†è¯·æ±‚ï¼Œä½†æœåŠ¡å™¨æ²¡æœ‰è®°å½•</li>
<li>æ•°æ®ç»“æ„çœ‹ä¼¼æ­£å¸¸ï¼Œä½†å‰ç«¯æ¸²æŸ“ä¸€ç›´å¤±è´¥</li>
<li>æŸäº›æ‰‹æœºå‹å·ç™»å½•æ€»æ˜¯æŠ¥é”™ï¼Œå´æ— æ³•å¤ç°</li>
<li>å¤šç¯å¢ƒéƒ¨ç½²åå¶å°”æ¥æ”¶åˆ°æ—§ç‰ˆæœ¬æ¥å£çš„è¿”å›</li>
</ul>
<p>è¿™äº›é—®é¢˜ä»æ—¥å¿—ä¸Šçœ‹ä¸å‡ºï¼Œä»ä»£ç ä¸Šä¹Ÿä¸èƒ½å®Œå…¨è§£é‡Šã€‚</p>
<p>è€Œ Charles æŠ“åŒ…ï¼Œå°±æ˜¯è§£å†³è¿™äº›â€œéšå½¢é—®é¢˜â€çš„çªç ´ç‚¹ã€‚</p>
<p>æŠ“åŒ…æ˜¯ä¸€ä¸ªâ€œçœ‹è§ç³»ç»Ÿâ€çš„è¿‡ç¨‹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªâ€œæŸ¥çœ‹è¯·æ±‚â€çš„åŠ¨ä½œã€‚</p>
<p>æœ¬æ–‡ä»ä¸€ä¸ªæ›´è´´è¿‘å¼€å‘è€…ç»éªŒçš„è§’åº¦ï¼Œåˆ†äº«å¦‚ä½•åˆ©ç”¨ Charles æŠ“åŒ…å®Œæˆå¤æ‚é—®é¢˜å®šä½ä¸ç³»ç»Ÿè¡Œä¸ºåˆ†æã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æŠ“åŒ…çš„æ ¸å¿ƒä»·å€¼ï¼šç¡®è®¤â€œçœŸå®å‘ç”Ÿäº†ä»€ä¹ˆâ€</h2>
<p>è°ƒè¯•æœ€æ€•çš„ï¼Œå°±æ˜¯é”™æŠŠå‡è±¡å½“çœŸç›¸ã€‚</p>
<p>ä½ ä»¥ä¸ºè¯·æ±‚æˆåŠŸäº†ï¼Œä½†å®é™…è¯·æ±‚è¢«ç¼“å­˜æ‹¦äº†ï¼›</p>
<p>ä½ ä»¥ä¸ºåç«¯è¿”å›é”™è¯¯ï¼Œä½†å®é™…å‚æ•°æ ¹æœ¬æ²¡å‘é€å‡ºå»ï¼›</p>
<p>ä½ ä»¥ä¸ºç½‘ç»œæ­£å¸¸ï¼Œä½†å®é™…åœ¨ DNS æˆ– SSL é˜¶æ®µå°±å·²ç»å¡ä½ã€‚</p>
<p>Charles æŠ“åŒ…å¯ä»¥å¸®ä½ ç¡®è®¤ä»¥ä¸‹å…³é”®ç‚¹ï¼š</p>
<ul>
<li>è¯·æ±‚æ˜¯å¦çœŸæ­£å‘å‡º</li>
<li>è¯·æ±‚è·¯å¾„æ˜¯å¦èµ°å¯¹ç¯å¢ƒ</li>
<li>å‚æ•°æ˜¯å¦åœ¨ç½‘ç»œä¼ è¾“ä¸­è¢«ä¿®æ”¹</li>
<li>å“åº”æ˜¯å¦æ¥è‡ªæœåŠ¡å™¨æˆ–ä»£ç†å±‚</li>
<li>è¯·æ±‚åœ¨å“ªä¸ªé˜¶æ®µå‘ç”Ÿå»¶è¿Ÿ</li>
</ul>
<p>è¿™æ˜¯æ—¥å¿—å’Œæ§åˆ¶å°éš¾ä»¥åŒæ—¶åšåˆ°çš„ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€CharlesæŠ“åŒ…çš„åŸºç¡€æµç¨‹ï¼Œä¸åªæ˜¯â€œå¼€è½¯ä»¶å°±èƒ½ç”¨â€</h2>
<p>è¦è®© Charles æ­£å¸¸å·¥ä½œï¼Œå¿…é¡»ç†è§£å®ƒçš„å‡ ä¸ªå…³é”®æ­¥éª¤ã€‚</p>
<h3 data-id="heading-2"><strong>å¼€å¯ä»£ç†ï¼šCharlesä½œä¸ºâ€œä¸­é—´äººâ€å­˜åœ¨</strong></h3>
<p>Charles æœ¬è´¨æ˜¯æœ¬åœ°ä»£ç†å·¥å…·ï¼Œå› æ­¤å®ƒé€šè¿‡å ç”¨ç³»ç»Ÿä»£ç†ï¼Œè®©æ‰€æœ‰æµé‡éƒ½ç»è¿‡å®ƒè½¬å‘ã€‚</p>
<p>æŠ“åŒ…æˆåŠŸçš„å‰æå°±æ˜¯ï¼š
ç³»ç»Ÿä»£ç† = Charlesï¼ˆ127.0.0.1:8888ï¼‰</p>
<h3 data-id="heading-3"><strong>é…ç½® HTTPS è§£å¯†ï¼šè®©åŠ å¯†æ•°æ®å˜å¾—é€æ˜</strong></h3>
<p>é€šè¿‡å®‰è£… Charles Root CAï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ° HTTPS è¯·æ±‚çš„çœŸå®å†…å®¹ã€‚</p>
<p>æ­¤åŠŸèƒ½åœ¨ï¼š</p>
<ul>
<li>ç™»å½•/æ³¨å†Œ</li>
<li>Tokenæ ¡éªŒ</li>
<li>æ”¯ä»˜æµç¨‹</li>
<li>App API è°ƒç”¨</li>
</ul>
<p>è¿™äº›åŠ å¯†åœºæ™¯ä¸­æå…¶å…³é”®ã€‚</p>
<h3 data-id="heading-4"><strong>ä½¿ç”¨ Structure + Sequence å®Œæ•´è¿˜åŸè¯·æ±‚é€»è¾‘</strong></h3>

















<table><thead><tr><th>è§†å›¾</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>Structure</td><td>æŒ‰åŸŸåæŸ¥çœ‹è¯·æ±‚åˆ†å¸ƒ</td></tr><tr><td>Sequence</td><td>æŒ‰æ—¶é—´é¡ºåºæŸ¥çœ‹é“¾è·¯å…³ç³»</td></tr></tbody></table>
<p>Sequence æ˜¯è°ƒè¯•â€œæµç¨‹ç±»é—®é¢˜â€çš„æ ¸å¿ƒå·¥å…·ï¼Œæ¯”å¦‚å¤šæ­¥è¯·æ±‚ã€é¡µé¢åŠ è½½é¡ºåºã€å¹¶å‘è¡Œä¸ºç­‰ã€‚</p>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€ç§»åŠ¨ç«¯æŠ“åŒ…ï¼šCharles çš„çœŸæ­£ä»·å€¼æ‰€åœ¨</h2>
<p>åœ¨ Web ç¯å¢ƒä¸­ä½ è¿˜å¯ä»¥æ‰“å¼€æµè§ˆå™¨çœ‹æ§åˆ¶å°ï¼Œä½†åœ¨ç§»åŠ¨ç«¯â€”â€”
æ—¥å¿—æœ‰é™ã€è¯·æ±‚å°è£…æ·±ã€ä»£ç†å¤æ‚ã€ç¯å¢ƒä¸å¯è§ã€‚</p>
<p>è¿™æ„å‘³ç€ Charles æ˜¯ç§»åŠ¨ç«¯è°ƒè¯•çš„â€œå”¯ä¸€çª—å£â€ã€‚</p>
<h3 data-id="heading-6"><strong>æ‰‹æœºæŠ“åŒ…æµç¨‹åŒ…æ‹¬ï¼š</strong></h3>
<ol>
<li>æ‰‹æœºä¸ç”µè„‘ä½¿ç”¨åŒä¸€ Wi-Fi</li>
<li>æ‰‹åŠ¨å¡«å†™ç”µè„‘ IP å’Œç«¯å£ 8888</li>
<li>è®¿é—® <code>chls.pro/ssl</code> å®‰è£…è¯ä¹¦</li>
<li>iOS ç”¨æˆ·éœ€æ‰‹åŠ¨ä¿¡ä»»è¯ä¹¦</li>
<li>æ‰“å¼€ Appï¼Œæµé‡å³å¯å±•ç¤ºåœ¨ Charles ä¸Š</li>
</ol>
<p>Charles åœ¨ç§»åŠ¨ç«¯è°ƒè¯•ä¸­çš„å…³é”®ä½œç”¨ï¼š</p>
<ul>
<li>çœŸå®è¯·æ±‚å‚æ•°éªŒè¯</li>
<li>ç¯å¢ƒåˆ‡æ¢æ˜¯å¦é”™è¯¯</li>
<li>HTTPS è¯·æ±‚æ˜¯å¦æ­£å¸¸æ¡æ‰‹</li>
<li>App åœ¨å¼±ç½‘ä¸‹çš„è¡Œä¸º</li>
</ul>
<p>è¿™äº›éƒ½æ˜¯ç§»åŠ¨ç«¯å¼€å‘ç»•ä¸è¿‡çš„æ ¸å¿ƒé—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-7">å››ã€Charlesåœ¨ç³»ç»Ÿå¼‚å¸¸å®šä½ä¸­çš„å®æˆ˜æŠ€å·§</h2>
<p>ä¸‹é¢æ˜¯æˆ‘å¤šå¹´ç»éªŒæ€»ç»“ä¸­æœ€å¸¸ç”¨çš„æŠ“åŒ…åˆ†ææ–¹å¼ã€‚</p>
<hr/>
<h3 data-id="heading-8"><strong>â‘  è¯·æ±‚å‘å‡ºä½†åç«¯æ²¡æ”¶åˆ°ï¼Ÿçœ‹ DNS / SSL / Proxy</strong></h3>
<p>å¾ˆå¤šè¯·æ±‚åœ¨åˆ°è¾¾æœåŠ¡å™¨å‰å°±å¤±è´¥äº†ï¼š</p>
<ul>
<li>DNS è§£æè¶…æ—¶</li>
<li>SSL æ¡æ‰‹å¤±è´¥</li>
<li>ä»£ç†å±‚æ‹¦æˆªæˆ–è½¬å‘é”™è¯¯</li>
</ul>
<p>Charles çš„ Timeline å¯ä»¥å‡†ç¡®å‘Šè¯‰ä½ å»¶è¿Ÿåœ¨å“ªä¸€æ®µå‡ºç°ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong>
å¦‚æœè¯·æ±‚å¡åœ¨ SSL é˜¶æ®µ â†’ å¤šæ•°æ˜¯è¯ä¹¦é—®é¢˜
å¦‚æœå¡åœ¨ Connecting â†’ å¤šæ•°æ˜¯ç½‘ç»œç¯å¢ƒé—®é¢˜</p>
<hr/>
<h3 data-id="heading-9"><strong>â‘¡ å‰ç«¯è¯´å‚æ•°æ­£ç¡®ï¼Œåç«¯è¯´æ²¡æ”¶åˆ°ï¼Ÿçœ‹ Raw + Body</strong></h3>
<p>å¾ˆå¤šç»†èŠ‚åªæœ‰æŠ“åŒ…æ‰èƒ½çœ‹åˆ°ï¼š</p>
<ul>
<li>è¢«åºåˆ—åŒ–æ—¶å­—æ®µä¸¢å¤±</li>
<li>GET å‚æ•°è¢«æµè§ˆå™¨è¿‡æ»¤</li>
<li>POST å­—æ®µä¸ºç©ºå­—ç¬¦ä¸²</li>
<li>JSON æ•°ç»„è¢«é”™è¯¯ç¼–ç </li>
</ul>
<p>Charles çš„ Raw / JSON æ ‡ç­¾èƒ½çœ‹åˆ°çœŸå®å‘é€å†…å®¹ã€‚</p>
<hr/>
<h3 data-id="heading-10"><strong>â‘¢ æŸäº›ç”¨æˆ·åé¦ˆé¡µé¢åŠ è½½æ…¢ï¼Ÿçœ‹ Timeline åˆ†ææ…¢ç‚¹</strong></h3>
<p>å¯èƒ½åŸå› åŒ…æ‹¬ï¼š</p>
<ul>
<li>é‡å®šå‘å¤ªå¤š</li>
<li>CDN ç¼“å­˜å¤±è´¥</li>
<li>å¤§é‡é‡å¤è¯·æ±‚</li>
<li>å¼±ç½‘å¯¼è‡´æ¡æ‰‹å¤±è´¥</li>
</ul>
<p>Timeline ä¼šæŠŠæ¯ä¸€æ¯«ç§’æ ‡è®°å‡ºæ¥ï¼Œè®©ä½ çŸ¥é“é—®é¢˜åˆ°åº•å‘ç”Ÿåœ¨å“ªä¸ªç¯èŠ‚ã€‚</p>
<hr/>
<h3 data-id="heading-11"><strong>â‘£ Mock åŠŸèƒ½æå¤§æé«˜å‰ç«¯è°ƒè¯•æ•ˆç‡</strong></h3>
<p>åœ¨ç¼ºä¹æ¥å£æˆ–åç«¯ä¸ç¨³å®šæ—¶ï¼š</p>
<ul>
<li>Map Local æ˜ å°„æœ¬åœ° JSON</li>
<li>Rewrite è‡ªåŠ¨ä¿®æ­£å‚æ•°</li>
<li>Map Remote åˆ‡æ¢ä¸åŒç¯å¢ƒ</li>
</ul>
<p>è¿™æ ·å‰ç«¯å°±èƒ½å®ç°ç‹¬ç«‹å¼€å‘ã€‚</p>
<hr/>
<h2 data-id="heading-12">äº”ã€æŠ“åŒ…å¤±è´¥çš„å…¸å‹åŸå› ä¸è§£å†³æ–¹å¼</h2>






























<table><thead><tr><th>é—®é¢˜</th><th>æè¿°</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>æŠ“ä¸åˆ° HTTPS</td><td>å†…å®¹æ˜¾ç¤ºä¸ºç©º</td><td>å®‰è£…/ä¿¡ä»» CAï¼Œå¯ç”¨ SSL Proxying</td></tr><tr><td>æ‰‹æœºæŠ“ä¸åˆ°è¯·æ±‚</td><td>App ä¸­æ— æµé‡æ˜¾ç¤º</td><td>åŒä¸€ Wi-Fi + æ­£ç¡®ä»£ç† + ä¿¡ä»»è¯ä¹¦</td></tr><tr><td>è¯·æ±‚ä¹±ç </td><td>å±•ç¤ºä¸æ­£å¸¸</td><td>å¯ç”¨ â€œè‡ªåŠ¨è§£å‹ç¼©â€</td></tr><tr><td>App æ˜¾ç¤ºè¯ä¹¦é”™è¯¯</td><td>SSL Pinning</td><td>ä½¿ç”¨è°ƒè¯•åŒ…æˆ–å…³é—­æ ¡éªŒ</td></tr></tbody></table>
<p>è¿™äº›éƒ½æ˜¯å®é™…å¼€å‘ä¸­ç»å¸¸é‡åˆ°çš„é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-13">å¦‚æœä½ éœ€è¦æ›´å®Œæ•´çš„æ“ä½œå›¾è§£</h2>
<p>å¯ä»¥è®¿é—®**<a href="https://link.juejin.cn?target=https%3A%2F%2Fcharlesproxy.net%2F" target="_blank" title="https://charlesproxy.net/" ref="nofollow noopener noreferrer">Charlesä¸­æ–‡ç½‘</a>**ï¼Œè¿™é‡Œæ•´ç†äº†å®‰è£…ã€æŠ“åŒ…ã€è¯ä¹¦ã€æ‰‹æœºè°ƒè¯•ç­‰è¯¦ç»†ä¸­æ–‡æµç¨‹ï¼Œ
å¯¹ä¸Šæ‰‹ Charles ååˆ†å‹å¥½ã€‚</p>
<hr/>
<h2 data-id="heading-14">æŒæ¡ Charlesï¼Œæ˜¯å»ºç«‹â€œç³»ç»Ÿç†è§£åŠ›â€çš„èµ·ç‚¹</h2>
<p>å½“ä½ èƒ½ç”¨ Charles æ¸…æ™°çœ‹åˆ°ç³»ç»Ÿè¡Œä¸ºï¼Œä½ å°±èƒ½åšåˆ°ï¼š</p>
<ul>
<li>ä¸ä¾èµ–çŒœæµ‹å®šä½é—®é¢˜</li>
<li>ä¸å†å—ç¯å¢ƒå·®å¼‚å½±å“</li>
<li>å¤ç°ä»–äººæ— æ³•å¤ç°çš„Bug</li>
<li>åœ¨å¤æ‚ç³»ç»Ÿä¸­ä¿æŒæœ‰æ•ˆåˆ¤æ–­</li>
</ul>
<p>Charles æŠ“åŒ…ä¸æ˜¯ä¸€ä¸ªâ€œå·¥å…·æŠ€å·§â€ï¼Œå®ƒæ˜¯ä¸€ç§<strong>è§‚å¯Ÿç³»ç»Ÿã€åˆ†æé“¾è·¯ã€å®šä½é—®é¢˜</strong>çš„èƒ½åŠ›ã€‚</p>
<p>ç†è§£æŠ“åŒ…ï¼Œä½ çš„è°ƒè¯•æ•ˆç‡å’Œç³»ç»Ÿæ´å¯ŸåŠ›éƒ½ä¼šæ˜æ˜¾æå‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‡†å¤‡æ‰‹å†™Simple Raftï¼ˆä¸€ï¼‰ï¼šæƒ³é€šRaftçš„æ ¸å¿ƒé—®é¢˜]]></title>    <link>https://juejin.cn/post/7573597479980761124</link>    <guid>https://juejin.cn/post/7573597479980761124</guid>    <pubDate>2025-11-18T02:07:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573597479980761124" data-draft-id="7573593395797573678" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‡†å¤‡æ‰‹å†™Simple Raftï¼ˆä¸€ï¼‰ï¼šæƒ³é€šRaftçš„æ ¸å¿ƒé—®é¢˜"/> <meta itemprop="keywords" content="åç«¯,åˆ†å¸ƒå¼"/> <meta itemprop="datePublished" content="2025-11-18T02:07:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‡†å¤‡æ‰‹å†™Simple Raftï¼ˆä¸€ï¼‰ï¼šæƒ³é€šRaftçš„æ ¸å¿ƒé—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:07:17.000Z" title="Tue Nov 18 2025 02:07:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…èƒŒæ™¯ï¼š20å¹´ITä¸€çº¿å¼€å‘ç»éªŒï¼Œ15å¹´æ¶æ„å¸ˆç»éªŒã€‚æ“…é•¿åˆ†å¸ƒå¼ã€å¾®æœåŠ¡ã€æœç´¢å¼•æ“ï¼Œæ‰‹å†™è¿‡å„ç±»ä¸­é—´ä»¶ã€‚æ›¾å¯¹Jacocoã€å¤œèºç­‰è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œè´Ÿè´£è¿‡200å¤šä¸ªèŠ‚ç‚¹çš„å¤§è§„æ¨¡é›†ç¾¤ï¼Œæ¶‰åŠK8sã€å¾®æœåŠ¡ç›‘æ§ã€å¤šä¸ªä¸­é—´ä»¶çš„è¿ç»´ã€‚è‡ªç ”è¿‡åŠ è§£å¯†ä¸­é—´ä»¶ï¼Œç°æœåŠ¡äºä¸€å®¶é‡‘èå…¬å¸ï¼Œæ‹…ä»»æ¶æ„å¸ˆã€‚</p>
</blockquote>
<h2 data-id="heading-0">æ‘˜è¦</h2>
<p>æœ¬æ–‡æ˜¯Simple Raftç³»åˆ—çš„ç¬¬ä¸€ç¯‡ï¼Œè®°å½•äº†æˆ‘ä»ä¸€ä¸ªç®€å•ç–‘é—®å‡ºå‘ï¼Œé€æ­¥ç†è§£Raftæ ¸å¿ƒæœºåˆ¶çš„æ€è€ƒè¿‡ç¨‹ã€‚ä¸»è¦è§£å†³äº†ä¸‰ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆMySQLæœ‰MVCCè¿˜éœ€è¦Rafté€‰ä¸»ï¼Ÿä¸ºä»€ä¹ˆé€‰å‡ºLeaderåè¿˜æœ‰å¹¶å‘é—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆæ—¥å¿—æ˜¯Raftçš„çµé­‚ï¼Ÿé€šè¿‡å¯¹æ¯”PostgreSQL WALã€RocketMQ CommitLogç­‰ç†Ÿæ‚‰çš„ç³»ç»Ÿï¼Œæœ€ç»ˆæƒ³é€šäº†Raftä½œä¸ºåˆ†å¸ƒå¼åŸºçŸ³çš„æœ¬è´¨ã€‚åç»­å°†æ‰‹å†™Simple Raftå®ç°ï¼Œä»æœ€ç®€å•çš„ç‰ˆæœ¬å¼€å§‹è¿­ä»£ï¼Œç»“åˆç”Ÿäº§ç»éªŒåˆ†äº«å®æˆ˜ä¸­çš„æƒè¡¡å’Œå‘ã€‚</p>
<hr/>
<p>æœ€è¿‘åœ¨ç ”ç©¶Nacosçš„æ—¶å€™ï¼Œçªç„¶æƒ³åˆ°ä¸€ä¸ªé—®é¢˜ï¼šNacosç”¨Raftåè®®é€‰ä¸»ï¼Œå¯æ˜¯é€‰ä¸»çš„ç›®çš„åˆ°åº•æ˜¯å•¥ï¼Ÿ</p>
<p>ä½ æƒ³å•Šï¼Œæœ€ç»ˆæ•°æ®éƒ½æ˜¯å­˜åˆ°MySQLäº†ï¼ŒMySQLæœ¬èº«å°±æœ‰MVCCæœºåˆ¶ä¿è¯å¹¶å‘å®‰å…¨ã€‚é‚£ç†è®ºä¸Šå“ªä¸ªNacosèŠ‚ç‚¹è¯»å†™ä¸éƒ½ä¸€æ ·å—ï¼Ÿä¸ºä»€ä¹ˆéè¦æä¸ªLeaderå‡ºæ¥ï¼Œå¤šæ­¤ä¸€ä¸¾ï¼Ÿ</p>
<p>æˆ‘å½“æ—¶å°±æ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œè§‰å¾—è¿™è®¾è®¡æœ‰ç‚¹å¤šä½™ã€‚åæ¥æ·±å…¥ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå‘ç°è‡ªå·±è¿˜æ˜¯å›¾æ ·å›¾æ£®ç ´äº†ã€‚</p>
<h2 data-id="heading-1">MySQLçš„MVCCè§£å†³ä¸äº†çš„é—®é¢˜</h2>
<p>å‡è®¾ç°åœ¨æœ‰3ä¸ªNacosèŠ‚ç‚¹ï¼Œéƒ½ç›´æ¥è¿MySQLè¯»å†™ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[å®¢æˆ·ç«¯A] --&gt; N1[NacosèŠ‚ç‚¹1]
    B[å®¢æˆ·ç«¯B] --&gt; N2[NacosèŠ‚ç‚¹2]
    C[å®¢æˆ·ç«¯C] --&gt; N3[NacosèŠ‚ç‚¹3]
    N1 --&gt; M[(MySQL)]
    N2 --&gt; M
    N3 --&gt; M
</code></pre>
<p>çœ‹èµ·æ¥æŒºç¾å¥½çš„ï¼ŒMySQLçš„MVCCä¼šå¸®æˆ‘ä»¬å¤„ç†å¹¶å‘é—®é¢˜ã€‚ä½†ç­‰ç­‰ï¼ŒMVCCåªèƒ½ä¿è¯<strong>æ•°æ®åº“å±‚é¢çš„äº‹åŠ¡éš”ç¦»</strong>ï¼Œå®ƒä¿è¯ä¸äº†è¿™äº›ï¼š</p>
<h3 data-id="heading-2">ä¸šåŠ¡é¡ºåºçš„ä¸€è‡´æ€§</h3>
<p>æˆ‘ä¸¾ä¸ªä¾‹å­ã€‚å®¢æˆ·ç«¯Aæ³¨å†Œäº†ä¸€ä¸ªæœåŠ¡å®ä¾‹<code>instance-1</code>ï¼Œå®¢æˆ·ç«¯Bé©¬ä¸Šåˆæ³¨é”€äº†è¿™ä¸ªå®ä¾‹ã€‚è¿™ä¸¤ä¸ªè¯·æ±‚åˆ†åˆ«æ‰“åˆ°äº†ä¸åŒçš„NacosèŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant A as å®¢æˆ·ç«¯A
    participant N1 as NacosèŠ‚ç‚¹1
    participant N2 as NacosèŠ‚ç‚¹2
    participant M as MySQL
    participant Sub as è®¢é˜…è€…
    
    A-&gt;&gt;N1: æ³¨å†Œinstance-1
    N1-&gt;&gt;M: å†™å…¥MySQL
    N1-&gt;&gt;Sub: æ¨é€"æ–°å¢"é€šçŸ¥
    
    Note over N2: å‡ ä¹åŒæ—¶
    
    B-&gt;&gt;N2: æ³¨é”€instance-1
    N2-&gt;&gt;M: å†™å…¥MySQL  
    N2-&gt;&gt;Sub: æ¨é€"åˆ é™¤"é€šçŸ¥
</code></pre>
<p>è™½ç„¶MySQLèƒ½ä¿è¯è¿™ä¸¤ä¸ªå†™æ“ä½œä¸ä¼šå†²çªï¼Œä½†<strong>æ¨é€é€šçŸ¥çš„é¡ºåºå¯èƒ½ä¹±</strong>ï¼è®¢é˜…è€…å¯èƒ½å…ˆæ”¶åˆ°"åˆ é™¤"é€šçŸ¥ï¼Œå†æ”¶åˆ°"æ–°å¢"é€šçŸ¥ï¼Œå¯¼è‡´æœ€ç»ˆçŠ¶æ€ä¸å¯¹ã€‚</p>
<h3 data-id="heading-3">å†…å­˜çŠ¶æ€çš„åˆ†è£‚</h3>
<p>æ›´è¦å‘½çš„æ˜¯ï¼ŒNacosçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å†…å­˜ç¼“å­˜ã€‚æ²¡æœ‰Leaderåè°ƒçš„è¯ï¼š</p>
<pre><code class="hljs language-css" lang="css">èŠ‚ç‚¹<span class="hljs-number">1</span>å†…å­˜: {serviceA: [instance1, instance2]}
èŠ‚ç‚¹<span class="hljs-number">2</span>å†…å­˜: {serviceA: [instance1, instance3]}  
èŠ‚ç‚¹<span class="hljs-number">3</span>å†…å­˜: {serviceA: [instance2, instance3]}
</code></pre>
<p>è™½ç„¶MySQLé‡Œçš„æ•°æ®æ˜¯å¯¹çš„ï¼Œä½†ä¸‰ä¸ªèŠ‚ç‚¹ç»™å‡ºçš„æŸ¥è¯¢ç»“æœéƒ½ä¸ä¸€æ ·ã€‚å®¢æˆ·ç«¯æŸ¥åˆ°å“ªä¸ªèŠ‚ç‚¹ç®—å“ªä¸ªï¼Œè¿™ä¸å°±ä¹±å¥—äº†å—ï¼Ÿ</p>
<h2 data-id="heading-4">åŸæ¥Raftè§£å†³çš„æ˜¯è¿™ä¸ª</h2>
<p>æˆ‘åæ¥æƒ³æ˜ç™½äº†ï¼Œ<strong>Rafté€‰ä¸»ä¸æ˜¯ä¸ºäº†è§£å†³æ•°æ®è¯»å†™çš„é—®é¢˜ï¼Œè€Œæ˜¯ä¸ºäº†ä¿è¯æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç…§ç›¸åŒçš„é¡ºåºæ‰§è¡Œç›¸åŒçš„æ“ä½œ</strong>ã€‚</p>
<p>æœ‰äº†Leaderä¹‹åï¼Œæµç¨‹å˜æˆè¿™æ ·ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant C as å®¢æˆ·ç«¯
    participant F as FollowerèŠ‚ç‚¹
    participant L as LeaderèŠ‚ç‚¹
    participant M as MySQL
    
    C-&gt;&gt;F: å†™è¯·æ±‚
    F-&gt;&gt;L: è½¬å‘ç»™Leader
    L-&gt;&gt;L: è¿½åŠ åˆ°æ—¥å¿—
    L-&gt;&gt;F: å¤åˆ¶æ—¥å¿—
    F-&gt;&gt;L: ç¡®è®¤æ”¶åˆ°
    Note over L: è¿‡åŠç¡®è®¤
    L-&gt;&gt;M: å†™å…¥MySQL
    L-&gt;&gt;C: è¿”å›æˆåŠŸ
</code></pre>
<p>æ‰€æœ‰çš„å†™æ“ä½œéƒ½é€šè¿‡Leaderï¼ŒLeaderä¿è¯ï¼š</p>
<ul>
<li>æ‰€æœ‰æ“ä½œéƒ½æœ‰å…¨å±€å”¯ä¸€çš„é¡ºåº</li>
<li>æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç›¸åŒé¡ºåºæ‰§è¡Œ</li>
<li>å†…å­˜çŠ¶æ€ä¿æŒä¸€è‡´</li>
</ul>
<p>è¿™å°±æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œå¸¸è¯´çš„<strong>çŠ¶æ€æœºå¤åˆ¶</strong>ã€‚</p>
<h2 data-id="heading-5">é‚£å¦‚æœMySQLç”¨ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«å‘¢ï¼Ÿ</h2>
<p>æˆ‘å½“æ—¶è¿˜æƒ³äº†ä¸ªæ­ªæ‹›ï¼šå¦‚æœMySQLè®¾ç½®æˆSERIALIZABLEéš”ç¦»çº§åˆ«ï¼Œé‚£æ˜¯ä¸æ˜¯å°±å¯ä»¥ä¸ç”¨Raftäº†ï¼Ÿ</p>
<p>åæ¥å‘ç°è¿˜æ˜¯ä¸è¡Œã€‚SERIALIZABLEåªèƒ½ä¿è¯MySQLå†…éƒ¨çš„äº‹åŠ¡ä¸²è¡ŒåŒ–ï¼Œä½†ä¿è¯ä¸äº†ï¼š</p>
<ul>
<li>Nacoså„èŠ‚ç‚¹çš„å†…å­˜çŠ¶æ€ä¸€è‡´</li>
<li>æ¨é€é€šçŸ¥çš„é¡ºåºæ­£ç¡®</li>
<li>åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„æ“ä½œé¡ºåº</li>
</ul>
<p>è¯´ç™½äº†ï¼Œ<strong>MySQLæ˜¯å­˜å‚¨å±‚ï¼ŒRaftæ˜¯åè°ƒå±‚</strong>ï¼Œä¸¤ä¸ªæ ¹æœ¬ä¸æ˜¯ä¸€å›äº‹ã€‚</p>
<h2 data-id="heading-6">é€‰å‡ºLeaderåå°±å®Œäº‹äº†ï¼Ÿè¿˜æœ‰å¤šçº¿ç¨‹é—®é¢˜</h2>
<p>è¿™é‡Œæˆ‘åˆå‘ç°ä¸€ä¸ªæœ‰æ„æ€çš„äº‹ã€‚Rafté€šè¿‡é€‰ä¸¾ä¿è¯äº†åªæœ‰ä¸€ä¸ªLeaderåœ¨å†™ï¼Œä½†Leaderè‡ªå·±å†…éƒ¨è¿˜æ˜¯æœ‰å¹¶å‘é—®é¢˜å•Šï¼</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å‘Leaderå‘è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    C1[å®¢æˆ·ç«¯1] --&gt; L[Leader]
    C2[å®¢æˆ·ç«¯2] --&gt; L
    C3[å®¢æˆ·ç«¯3] --&gt; L
    L --&gt; T1[å¤„ç†çº¿ç¨‹1]
    L --&gt; T2[å¤„ç†çº¿ç¨‹2]
    L --&gt; T3[å¤„ç†çº¿ç¨‹3]
</code></pre>
<p>è¿™äº›è¯·æ±‚å¯èƒ½åŒæ—¶åˆ°è¾¾ï¼ŒLeaderå†…éƒ¨è‚¯å®šæœ‰å¤šçº¿ç¨‹å¤„ç†ã€‚æ€ä¹ˆä¿è¯å®ƒä»¬çš„æ‰§è¡Œé¡ºåºå‘¢ï¼Ÿ</p>
<p>è¿™å°±æ˜¯<strong>æ—¥å¿—</strong>çš„ä½œç”¨äº†ï¼æˆ‘ä¹‹å‰ä¸€ç›´æ²¡æƒ³æ˜ç™½ä¸ºä»€ä¹ˆRaftéœ€è¦æ—¥å¿—ï¼Œåæ¥æ‰æç„¶å¤§æ‚Ÿã€‚</p>
<h3 data-id="heading-7">æ—¥å¿—è§£å†³å¹¶å‘æ§åˆ¶</h3>
<p>LeaderæŠŠæ‰€æœ‰å†™æ“ä½œéƒ½ä¸²è¡ŒåŒ–åœ°è¿½åŠ åˆ°æ—¥å¿—é‡Œï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    T1[çº¿ç¨‹1:è¯·æ±‚A] --&gt; Q[æ—¥å¿—é˜Ÿåˆ—]
    T2[çº¿ç¨‹2:è¯·æ±‚B] --&gt; Q
    T3[çº¿ç¨‹3:è¯·æ±‚C] --&gt; Q
    Q --&gt; A[å•çº¿ç¨‹åº”ç”¨]
    A --&gt; S[çŠ¶æ€æœº]
</code></pre>
<p>è™½ç„¶è¯·æ±‚æ˜¯å¹¶å‘æ¥æ”¶çš„ï¼Œä½†å†™æ—¥å¿—çš„æ—¶å€™ä¼šä¸²è¡ŒåŒ–ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RaftLeader</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> BlockingQueue&lt;LogEntry&gt; logQueue;
    
    <span class="hljs-comment">// å¤šçº¿ç¨‹å¹¶å‘è°ƒç”¨</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;Boolean&gt; <span class="hljs-title function_">propose</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] data)</span> {
        <span class="hljs-type">LogEntry</span> <span class="hljs-variable">entry</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LogEntry</span>(currentTerm, data);
        
        <span class="hljs-comment">// è¿™é‡Œæœ‰é”ä¿è¯ä¸²è¡ŒåŒ–å†™å…¥</span>
        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
            logQueue.offer(entry);
            <span class="hljs-type">long</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> nextIndex++;
        }
        
        <span class="hljs-comment">// å¼‚æ­¥ç­‰å¾…å¤åˆ¶å®Œæˆ</span>
        <span class="hljs-keyword">return</span> waitForCommit(index);
    }
    
    <span class="hljs-comment">// å•çº¿ç¨‹åº”ç”¨æ—¥å¿—</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">applyLog</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-type">LogEntry</span> <span class="hljs-variable">entry</span> <span class="hljs-operator">=</span> logQueue.take();
            stateMachine.apply(entry);  <span class="hljs-comment">// ä¸¥æ ¼æŒ‰é¡ºåºæ‰§è¡Œ</span>
        }
    }
}
</code></pre>
<p>è¿™æ ·ä¸€æ¥ï¼š</p>
<ol>
<li>å¤šçº¿ç¨‹å¹¶å‘æ¥æ”¶è¯·æ±‚ï¼ˆé«˜ååï¼‰</li>
<li>æ—¥å¿—é˜Ÿåˆ—ä¸²è¡ŒåŒ–ï¼ˆä¿è¯é¡ºåºï¼‰</li>
<li>å•çº¿ç¨‹åº”ç”¨åˆ°çŠ¶æ€æœºï¼ˆä¿è¯ä¸€è‡´æ€§ï¼‰</li>
</ol>
<p><strong>æ—¥å¿—å°±æ˜¯æŠŠæ—¶é—´ç»´åº¦ä¸Šçš„å¹¶å‘ï¼Œè½¬åŒ–ä¸ºç©ºé—´ç»´åº¦ä¸Šçš„é¡ºåºã€‚</strong></p>
<h2 data-id="heading-8">çªç„¶æƒ³é€šçš„ä¸€ä»¶äº‹</h2>
<p>æˆ‘ç ”ç©¶åˆ°è¿™é‡Œçš„æ—¶å€™çªç„¶å‘ç°ï¼Œè¿™å¥—æœºåˆ¶å’Œæˆ‘ç†Ÿæ‚‰çš„å…¶ä»–ç³»ç»Ÿå¾ˆåƒå•Šï¼š</p>
<p><strong>PostgreSQLçš„WALï¼š</strong></p>
<pre><code class="hljs">å¤šä¸ªäº‹åŠ¡å¹¶å‘ â†’ ä¸²è¡Œå†™WAL â†’ æŒ‰åºåº”ç”¨åˆ°æ•°æ®é¡µ
</code></pre>
<p><strong>RocketMQçš„CommitLogï¼š</strong></p>
<pre><code class="hljs">å¤šä¸ªç”Ÿäº§è€…å¹¶å‘ â†’ ä¸²è¡Œå†™CommitLog â†’ æŒ‰åºæ¶ˆè´¹
</code></pre>
<p><strong>Raftçš„æ—¥å¿—ï¼š</strong></p>
<pre><code class="hljs">å¤šä¸ªè¯·æ±‚å¹¶å‘ â†’ ä¸²è¡Œå†™æ—¥å¿— â†’ æŒ‰åºåº”ç”¨åˆ°çŠ¶æ€æœº
</code></pre>
<p>å®ƒä»¬æœ¬è´¨ä¸Šéƒ½åœ¨è§£å†³åŒä¸€ä¸ªé—®é¢˜ï¼š<strong>æŠŠæ— åºçš„å¹¶å‘æ“ä½œï¼Œå˜æˆæœ‰åºçš„å¯é‡æ”¾åºåˆ—</strong>ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¿™äº›ç³»ç»Ÿéƒ½å«"æ—¥å¿—"ï¼Œè€Œä¸æ˜¯å«"æ•°æ®åº“"æˆ–è€…"ç¼“å­˜"ã€‚æ—¥å¿—å¤©ç„¶å°±æ˜¯ä¸€ä¸ªæœ‰åºçš„ã€åªèƒ½è¿½åŠ çš„ç»“æ„ã€‚</p>
<h2 data-id="heading-9">ä¸»æŒ‚äº†æ€ä¹ˆåŠï¼Ÿ</h2>
<p>æˆ‘å½“æ—¶è¿˜æƒ³åˆ°ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœLeaderåˆšå†™å…¥æ—¥å¿—è¿˜æ²¡æ¥å¾—åŠå¤åˆ¶ï¼Œå°±æŒ‚äº†æ€ä¹ˆåŠï¼Ÿ</p>
<p>åæ¥å‘ç°Raftæ—©å°±æƒ³å¥½äº†ã€‚Leaderå†™å…¥æ—¥å¿—åï¼Œ<strong>ä¸ä¼šç«‹å³è¿”å›æˆåŠŸ</strong>ï¼Œè€Œæ˜¯è¦ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant L as Leader
    participant F1 as Follower1
    participant F2 as Follower2
    participant F3 as Follower3
    participant C as å®¢æˆ·ç«¯
    
    C-&gt;&gt;L: å†™è¯·æ±‚
    L-&gt;&gt;L: è¿½åŠ åˆ°æ—¥å¿—(æœªæäº¤)
    
    par å¹¶è¡Œå¤åˆ¶
        L-&gt;&gt;F1: å¤åˆ¶æ—¥å¿—
        L-&gt;&gt;F2: å¤åˆ¶æ—¥å¿—
        L-&gt;&gt;F3: å¤åˆ¶æ—¥å¿—
    end
    
    F1-&gt;&gt;L: ACK
    F2-&gt;&gt;L: ACK
    
    Note over L: æ”¶åˆ°è¿‡åŠACK
    L-&gt;&gt;L: æ ‡è®°ä¸ºcommitted
    L-&gt;&gt;C: è¿”å›æˆåŠŸ
</code></pre>
<p>åªæœ‰<strong>è¿‡åŠæ•°èŠ‚ç‚¹ç¡®è®¤</strong>åï¼ŒLeaderæ‰ä¼šå‘Šè¯‰å®¢æˆ·ç«¯"å†™å…¥æˆåŠŸ"ã€‚</p>
<p>è¿™æ ·å°±ç®—Leaderé©¬ä¸ŠæŒ‚äº†ï¼Œè‡³å°‘æœ‰3å°æœºå™¨ï¼ˆåŒ…æ‹¬æŒ‚æ‰çš„Leaderï¼‰æœ‰è¿™æ¡æ—¥å¿—ã€‚æ–°Leaderé€‰ä¸¾çš„æ—¶å€™ï¼Œä¸€å®šä¼šä»è¿™äº›æœ‰æœ€æ–°æ—¥å¿—çš„èŠ‚ç‚¹ä¸­é€‰å‡ºæ¥ã€‚</p>
<h2 data-id="heading-10">é‚£è½åçš„èŠ‚ç‚¹èƒ½å½“Leaderå—ï¼Ÿ</h2>
<p>è¿™æ˜¯æˆ‘æœ€åä¸€ä¸ªç–‘æƒ‘ã€‚å‡è®¾ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Leader(æŒ‚äº†):   <span class="hljs-section">[æ—¥å¿—1,2,3,4,5]</span>
Follower-A:     <span class="hljs-section">[æ—¥å¿—1,2,3,4,5]</span>  â† æœ€æ–°
Follower-B:     <span class="hljs-section">[æ—¥å¿—1,2,3,4,5]</span>  â† æœ€æ–°
Follower-C:     <span class="hljs-section">[æ—¥å¿—1,2,3]</span>      â† è½å
Follower-D:     <span class="hljs-section">[æ—¥å¿—1,2,3]</span>      â† è½å
</code></pre>
<p>Cå’ŒDçš„é€‰ä¸¾è¶…æ—¶æ—¶é—´æ˜¯éšæœºçš„ï¼Œå¦‚æœCå…ˆè¶…æ—¶å‘èµ·é€‰ä¸¾å‘¢ï¼Ÿå®ƒä¼šä¸ä¼šå½“é€‰ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>ä¸ä¼šï¼</strong></p>
<p>å› ä¸ºRaftæœ‰ä¸ªæŠ•ç¥¨è§„åˆ™ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldVoteFor</span><span class="hljs-params">(Candidate candidate)</span> {
    <span class="hljs-comment">// æ¯”è¾ƒæ—¥å¿—</span>
    <span class="hljs-keyword">if</span> (candidate.lastLogTerm &lt; myLastLogTerm) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// å€™é€‰äººæ—¥å¿—æ›´æ—§ï¼Œæ‹’ç»</span>
    }
    
    <span class="hljs-keyword">if</span> (candidate.lastLogTerm == myLastLogTerm) {
        <span class="hljs-keyword">if</span> (candidate.lastLogIndex &lt; myLastLogIndex) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// ç´¢å¼•æ›´å°ï¼Œæ‹’ç»</span>
        }
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <span class="hljs-comment">// æ—¥å¿—è‡³å°‘å’Œæˆ‘ä¸€æ ·æ–°ï¼ŒåŒæ„</span>
}
</code></pre>
<p>æ‰€ä»¥Cå‘èµ·é€‰ä¸¾çš„æ—¶å€™ï¼š</p>
<ul>
<li>Açœ‹åˆ°Cçš„æ—¥å¿—åªåˆ°3ï¼Œè‡ªå·±åˆ°5 â†’ æ‹’ç»æŠ•ç¥¨</li>
<li>Bçœ‹åˆ°Cçš„æ—¥å¿—åªåˆ°3ï¼Œè‡ªå·±åˆ°5 â†’ æ‹’ç»æŠ•ç¥¨</li>
<li>Dçœ‹åˆ°Cçš„æ—¥å¿—å’Œè‡ªå·±ä¸€æ · â†’ åŒæ„æŠ•ç¥¨</li>
</ul>
<p>Cåªèƒ½æ‹¿åˆ°2ç¥¨ï¼ˆè‡ªå·±+Dï¼‰ï¼Œè¾¾ä¸åˆ°è¿‡åŠï¼Œé€‰ä¸¾å¤±è´¥ã€‚</p>
<p>è€Œå¦‚æœAå…ˆå‘èµ·é€‰ä¸¾ï¼Œå®ƒçš„æ—¥å¿—æœ€æ–°ï¼Œèƒ½æ‹¿åˆ°è‡³å°‘3ç¥¨ï¼ŒæˆåŠŸå½“é€‰ã€‚</p>
<p><strong>è¿™å°±ä¿è¯äº†æ–°Leaderä¸€å®šæœ‰æ‰€æœ‰å·²æäº¤çš„æ•°æ®ã€‚</strong></p>
<h2 data-id="heading-11">Raftï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„åŸºçŸ³</h2>
<p>ç ”ç©¶åˆ°è¿™é‡Œï¼Œæˆ‘è¶Šæ¥è¶Šè§‰å¾—Raftæ˜¯ä¸ªå¾ˆç²¾å¦™çš„è®¾è®¡ã€‚å®ƒçœ‹èµ·æ¥ä¸å¤æ‚ï¼Œä½†è§£å†³äº†åˆ†å¸ƒå¼ç³»ç»Ÿæœ€æ ¸å¿ƒçš„é—®é¢˜ï¼š</p>
<ul>
<li><strong>ä¸€è‡´æ€§</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹çœ‹åˆ°ç›¸åŒçš„æ•°æ®</li>
<li><strong>é¡ºåºæ€§</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹æŒ‰ç›¸åŒé¡ºåºæ‰§è¡Œ</li>
<li><strong>å®¹é”™æ€§</strong>ï¼šå°‘æ•°èŠ‚ç‚¹æŒ‚äº†ç³»ç»Ÿä»å¯ç”¨</li>
<li><strong>å¹¶å‘æ§åˆ¶</strong>ï¼šç”¨æ—¥å¿—ä¸²è¡ŒåŒ–æ“ä½œ</li>
</ul>
<p>æœ‰äº†Raftè¿™ä¸ªåŸºçŸ³ï¼Œä½ å°±èƒ½æ„å»ºå„ç§ä¸Šå±‚åº”ç”¨ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    R[Raftåè®®] --&gt; KV[KVå­˜å‚¨]
    R --&gt; Lock[åˆ†å¸ƒå¼é”]
    R --&gt; Config[é…ç½®ä¸­å¿ƒ]
    R --&gt; Registry[æœåŠ¡æ³¨å†Œ]
    
    KV --&gt; etcd
    Lock --&gt; etcd
    Config --&gt; Nacos
    Registry --&gt; Consul
</code></pre>
<ul>
<li><strong>etcd</strong>å°±æ˜¯Raft + KVå­˜å‚¨ + Watchæœºåˆ¶</li>
<li><strong>Nacosé…ç½®ä¸­å¿ƒ</strong>å°±æ˜¯Raft + é…ç½®ç®¡ç† + æ¨é€</li>
<li><strong>Consul</strong>å°±æ˜¯Raft + æœåŠ¡æ³¨å†Œ + å¥åº·æ£€æŸ¥</li>
</ul>
<p>ç”šè‡³å¯ä»¥ç”¨Raftè‡ªå·±å®ç°åˆ†å¸ƒå¼é”ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RaftLock</span> {
    <span class="hljs-keyword">private</span> RaftNode raft;
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(String key, String owner)</span> {
        <span class="hljs-comment">// é€šè¿‡Raftå¤åˆ¶åŠ é”å‘½ä»¤</span>
        <span class="hljs-type">LockCommand</span> <span class="hljs-variable">cmd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LockCommand</span>(key, owner);
        <span class="hljs-keyword">return</span> raft.propose(cmd);  <span class="hljs-comment">// è¿‡åŠç¡®è®¤æ‰æˆåŠŸ</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">(String key, String owner)</span> {
        <span class="hljs-type">UnlockCommand</span> <span class="hljs-variable">cmd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnlockCommand</span>(key, owner);
        raft.propose(cmd);
    }
}
</code></pre>
<p>å› ä¸ºRaftä¿è¯äº†ï¼š</p>
<ul>
<li>åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹èƒ½å†™å…¥ï¼ˆLeaderï¼‰</li>
<li>æ‰€æœ‰èŠ‚ç‚¹çœ‹åˆ°ç›¸åŒçš„åŠ é”é¡ºåº</li>
<li>è¿‡åŠç¡®è®¤æ‰è¿”å›æˆåŠŸ</li>
</ul>
<p>è¿™å°±æ˜¯ä¸€ä¸ªå¯é çš„åˆ†å¸ƒå¼é”äº†ã€‚</p>
<h2 data-id="heading-12">æ¥ä¸‹æ¥è¦åšä»€ä¹ˆ</h2>
<p>æˆ‘ç°åœ¨ç®—æ˜¯æŠŠRaftçš„æ ¸å¿ƒåŸç†æƒ³é€šäº†ã€‚ä½†ä»ç†è§£åˆ°å®ç°ï¼Œè¿˜æœ‰ä¸å°‘è·ç¦»ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>æ—¥å¿—å‹ç¼©å’Œå¿«ç…§æ€ä¹ˆåšï¼Ÿ</li>
<li>é…ç½®å˜æ›´ï¼ˆåŠ¨æ€å¢åˆ èŠ‚ç‚¹ï¼‰æ€ä¹ˆå¤„ç†ï¼Ÿ</li>
<li>å„ç§è¾¹ç•Œæƒ…å†µå’Œç½‘ç»œå¼‚å¸¸æ€ä¹ˆåº”å¯¹ï¼Ÿ</li>
<li>æ€ä¹ˆä¼˜åŒ–æ€§èƒ½ï¼Ÿ</li>
</ul>
<p>è¿™äº›é—®é¢˜æˆ‘è¿˜æ²¡å®Œå…¨ç ”ç©¶é€ã€‚</p>
<p>æˆ‘æ‰“ç®—å†™ä¸€ä¸ª<strong>Simple Raft</strong>ç³»åˆ—ï¼Œä»æœ€ç®€å•çš„ç‰ˆæœ¬å¼€å§‹ï¼Œä¸€ç‚¹ç‚¹è¿­ä»£ï¼š</p>
<ol>
<li>ç¬¬ä¸€ç‰ˆï¼šåŸºæœ¬çš„é€‰ä¸¾å’Œå¿ƒè·³</li>
<li>ç¬¬äºŒç‰ˆï¼šæ—¥å¿—å¤åˆ¶å’Œæäº¤</li>
<li>ç¬¬ä¸‰ç‰ˆï¼šæŒä¹…åŒ–å’Œæ¢å¤</li>
<li>ç¬¬å››ç‰ˆï¼šæ—¥å¿—å‹ç¼©</li>
<li>ç¬¬äº”ç‰ˆï¼šç”¨å®ƒå®ç°åˆ†å¸ƒå¼é”</li>
</ol>
<p>ä»£ç ä¼šæ”¾åˆ°Giteeä¸Šï¼Œä¼šä»¥Nacosä¸ºåŸºç¡€ï¼Œæ‰‹å†™æ ¸å¿ƒä»£ç ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹ä¸­è‚¯å®šä¼šé‡åˆ°å„ç§å‘ï¼Œåˆ°æ—¶å€™å†è®°å½•ä¸‹æ¥ã€‚æˆ‘è§‰å¾—è¿™ç§"è¾¹å†™è¾¹å­¦ï¼ŒæŠŠè¸©è¿‡çš„å‘è®°å½•ä¸‹æ¥"çš„æ–¹å¼ï¼Œåº”è¯¥ä¼šæ¯”çº¯ç†è®ºè®²è§£æ›´æœ‰æ„æ€ã€‚</p>
<p>è€Œä¸”è¯´å®è¯ï¼Œå¸‚é¢ä¸ŠRaftçš„æ–‡ç« å¾ˆå¤šï¼Œä½†å¤§å¤šéƒ½æ˜¯ç¿»è¯‘è®ºæ–‡ï¼Œæˆ–è€…çº¯è®²ç†è®ºã€‚æˆ‘æƒ³ç»“åˆè‡ªå·±åœ¨ç”Ÿäº§ç¯å¢ƒç»´æŠ¤Nacosã€RocketMQã€PostgreSQLçš„ç»éªŒï¼Œå†™ç‚¹ä¸ä¸€æ ·çš„ä¸œè¥¿ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>Raftå’ŒPostgreSQLçš„æµå¤åˆ¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li>
<li>Raftå’ŒRocketMQçš„ä¸»ä»åŒæ­¥æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</li>
<li>ä»€ä¹ˆåœºæ™¯é€‚åˆç”¨Raftï¼Œä»€ä¹ˆåœºæ™¯ç”¨æœ€ç»ˆä¸€è‡´æ€§å°±å¤Ÿäº†ï¼Ÿ</li>
</ul>
<p>è¿™äº›éƒ½æ˜¯å®é™…å·¥ä½œä¸­ä¼šé‡åˆ°çš„é—®é¢˜ã€‚</p>
<p>å¥½äº†ï¼Œä»Šå¤©å°±å…ˆåˆ°è¿™é‡Œã€‚ç®—æ˜¯ç»™Simple Raftç³»åˆ—å¼€ä¸ªå¤´å§ã€‚</p>
<p>åé¢çš„æ–‡ç« ä¼šæ…¢æ…¢å†™ï¼Œä¸ç€æ€¥ï¼Œæƒ³æ¸…æ¥šäº†å†åŠ¨æ‰‹ã€‚æ¯•ç«Ÿæˆ‘è§‰å¾—ç†è§£åŸç†æ¯”æ€¥ç€å†™ä»£ç æ›´é‡è¦ã€‚</p>
<p>æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥å…³æ³¨ä¸€ä¸‹ï¼Œå’±ä»¬ä¸€èµ·æŠŠRaftè¿™ä¸ªåˆ†å¸ƒå¼åŸºçŸ³ææ˜ç™½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆä½ çš„volatileæ€»å‡ºbugï¼Ÿå› ä¸ºä½ æ²¡ææ‡‚å†…å­˜å±éšœè¿™å›äº‹å„¿ ğŸ¤¯]]></title>    <link>https://juejin.cn/post/7573589277003972646</link>    <guid>https://juejin.cn/post/7573589277003972646</guid>    <pubDate>2025-11-18T02:09:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573589277003972646" data-draft-id="7573593395797671982" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆä½ çš„volatileæ€»å‡ºbugï¼Ÿå› ä¸ºä½ æ²¡ææ‡‚å†…å­˜å±éšœè¿™å›äº‹å„¿ ğŸ¤¯"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-18T02:09:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·6854537597769"/> <meta itemprop="url" content="https://juejin.cn/user/1601315325621550"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆä½ çš„volatileæ€»å‡ºbugï¼Ÿå› ä¸ºä½ æ²¡ææ‡‚å†…å­˜å±éšœè¿™å›äº‹å„¿ ğŸ¤¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1601315325621550/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·6854537597769
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:09:36.000Z" title="Tue Nov 18 2025 02:09:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»28åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å¼•å…¥åœºæ™¯ï¼šçº¿ä¸Šç¿»è½¦çš„é‚£ä¸ªå¤œæ™š</h2>
<p>å‡Œæ™¨2ç‚¹ï¼Œæˆ‘è¢«ç”µè¯åµé†’ï¼š"ç³»ç»Ÿå‡ºç°æ•°æ®ä¸ä¸€è‡´äº†ï¼æ˜æ˜åŠ äº†<code>volatile</code>ï¼Œä¸ºä»€ä¹ˆè¿˜æ˜¯æœ‰çº¿ç¨‹è¯»åˆ°äº†æ—§å€¼ï¼Ÿ"</p>
<p>é‚£æ˜¯ä¸€ä¸ªç»å…¸çš„åŒé‡æ£€æŸ¥é”ï¼ˆDCLï¼‰å•ä¾‹æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> Singleton instance;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡æ£€æŸ¥</span>
            <span class="hljs-keyword">synchronized</span> (Singleton.class) {
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {  <span class="hljs-comment">// ç¬¬äºŒæ¬¡æ£€æŸ¥</span>
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();  <span class="hljs-comment">// é—®é¢˜å°±å‡ºåœ¨è¿™ï¼</span>
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;
    }
}
</code></pre>
<p>å¼€å‘åŒå­¦ä¸€è„¸æ‡µï¼š"æˆ‘åŠ äº†<code>volatile</code>å•Šï¼Œä¸æ˜¯è¯´èƒ½ä¿è¯å¯è§æ€§å—ï¼Ÿ"</p>
<p>æˆ‘é—®ä»–ï¼š"ä½ çŸ¥é“<code>volatile</code>åº•å±‚ç”¨äº†å“ªå‡ ç§å†…å­˜å±éšœå—ï¼ŸçŸ¥é“ä¸ºä»€ä¹ˆè¿™é‡Œå¿…é¡»ç”¨<code>volatile</code>è€Œä¸æ˜¯æ™®é€šå˜é‡å—ï¼Ÿ"</p>
<p>ä»–æ„£ä½äº†ã€‚</p>
<p>è¿™å°±æ˜¯ä»Šå¤©è¦èŠçš„ä¸»é¢˜ï¼š<strong>Javaå†…å­˜å±éšœ</strong>ã€‚å®ƒæ˜¯å¹¶å‘ç¼–ç¨‹çš„åŸºçŸ³ï¼Œå´å¸¸è¢«å¿½è§†ã€‚é¢è¯•å®˜æœ€çˆ±é—®"volatileæ€ä¹ˆå®ç°çš„"ï¼Œç­”æ¡ˆå°±è—åœ¨å†…å­˜å±éšœé‡Œã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€å¿«é€Ÿç†è§£ï¼šå†…å­˜å±éšœæ˜¯ä¸ªå•¥ï¼Ÿ</h2>
<h3 data-id="heading-2">é€šä¿—ç‰ˆ</h3>
<p>æƒ³è±¡ä½ åœ¨è¶…å¸‚ä¹°èœğŸ›’ï¼Œæœ‰ä¸ªæœåŠ¡å‘˜è´Ÿè´£æŠŠè´§æ¶ä¸Šçš„èœï¼ˆå†…å­˜ä¸­çš„æ•°æ®ï¼‰æ‹¿ç»™ä½ ï¼ˆCPUç¼“å­˜ï¼‰ã€‚<strong>å†…å­˜å±éšœå°±åƒè¶…å¸‚é‡Œçš„"ç¦æ­¢è¶…è½¦"æ ‡å¿—ç‰Œ</strong>ï¼Œå®ƒå‘Šè¯‰æœåŠ¡å‘˜ï¼š"åœ¨è¿™ä¸ªä½ç½®ä¹‹å‰çš„æ‰€æœ‰è®¢å•å¿…é¡»å¤„ç†å®Œï¼Œæ‰èƒ½å¤„ç†åé¢çš„è®¢å•ï¼"</p>
<h3 data-id="heading-3">æŠ€æœ¯å®šä¹‰</h3>
<p><strong>å†…å­˜å±éšœï¼ˆMemory Barrier/Fenceï¼‰</strong> æ˜¯ä¸€ç§CPUæŒ‡ä»¤ï¼Œç”¨äºæ§åˆ¶ç‰¹å®šæ¡ä»¶ä¸‹çš„å†…å­˜è®¿é—®é¡ºåºã€‚å®ƒå¼ºåˆ¶å¤„ç†å™¨åœ¨æ‰§è¡Œå±éšœåçš„æ“ä½œä¹‹å‰ï¼Œå®Œæˆå±éšœå‰çš„æ‰€æœ‰å†…å­˜æ“ä½œï¼Œå¹¶ç¡®ä¿è¿™äº›æ“ä½œå¯¹å…¶ä»–å¤„ç†å™¨å¯è§ã€‚</p>
<h3 data-id="heading-4">æ ¸å¿ƒä½œç”¨</h3>
<ol>
<li><strong>é˜²æ­¢æŒ‡ä»¤é‡æ’åº</strong>ï¼šç¡®ä¿ä»£ç æ‰§è¡Œé¡ºåºç¬¦åˆç¨‹åºå‘˜çš„é¢„æœŸ</li>
<li><strong>ä¿è¯å†…å­˜å¯è§æ€§</strong>ï¼šç¡®ä¿ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œèƒ½è¢«å…¶ä»–çº¿ç¨‹ç«‹å³çœ‹åˆ°</li>
<li><strong>å»ºç«‹happens-beforeå…³ç³»</strong>ï¼šä¸ºJavaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰æä¾›åº•å±‚æ”¯æŒ</li>
</ol>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€ä¸ºä»€ä¹ˆéœ€è¦å†…å­˜å±éšœï¼Ÿ</h2>
<h3 data-id="heading-6">3.1 é—®é¢˜1ï¼šæŒ‡ä»¤é‡æ’åºå¯¼è‡´çš„è¯¡å¼‚Bug</h3>
<p>ç°ä»£CPUä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºã€‚çœ‹ä¸ªçœŸå®æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// çº¿ç¨‹1</span>
x = <span class="hljs-number">1</span>;        <span class="hljs-comment">// æ­¥éª¤1</span>
flag = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// æ­¥éª¤2</span>

<span class="hljs-comment">// çº¿ç¨‹2</span>
<span class="hljs-keyword">if</span> (flag) {         <span class="hljs-comment">// æ­¥éª¤3</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> x + <span class="hljs-number">1</span>;  <span class="hljs-comment">// æ­¥éª¤4ï¼ŒæœŸæœ›y=2</span>
}
</code></pre>
<p><strong>ä½ ä»¥ä¸ºçš„æ‰§è¡Œé¡ºåº</strong>ï¼šæ­¥éª¤1 â†’ æ­¥éª¤2 â†’ æ­¥éª¤3 â†’ æ­¥éª¤4<br/>
<strong>å®é™…å¯èƒ½çš„æ‰§è¡Œé¡ºåº</strong>ï¼šæ­¥éª¤2 â†’ æ­¥éª¤3 â†’ æ­¥éª¤4 â†’ æ­¥éª¤1ï¼ˆé‡æ’åºåï¼‰</p>
<p>ç»“æœï¼š<code>y</code>å¯èƒ½ç­‰äº1ï¼Œè€Œä¸æ˜¯æœŸæœ›çš„2ï¼ğŸ˜±</p>
<h3 data-id="heading-7">3.2 é—®é¢˜2ï¼šCPUç¼“å­˜å¯¼è‡´çš„å¯è§æ€§é—®é¢˜</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ ¸å¿ƒ1æ‰§è¡Œ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
    data = <span class="hljs-number">42</span>;      <span class="hljs-comment">// å†™åˆ°CPU1çš„ç¼“å­˜</span>
    ready = <span class="hljs-literal">true</span>;   <span class="hljs-comment">// å†™åˆ°CPU1çš„ç¼“å­˜</span>
}

<span class="hljs-comment">// æ ¸å¿ƒ2æ‰§è¡Œ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (ready) {    <span class="hljs-comment">// ä»CPU2çš„ç¼“å­˜è¯»ï¼Œå¯èƒ½è¯»åˆ°æ—§å€¼false</span>
        <span class="hljs-keyword">return</span> data; <span class="hljs-comment">// å³ä½¿è¯»åˆ°trueï¼Œdataä¹Ÿå¯èƒ½è¿˜æ˜¯æ—§å€¼0</span>
    }
}
</code></pre>
<p>é—®é¢˜æ ¹æºï¼š<strong>CPUç¼“å­˜ä¸ä¼šå®æ—¶åŒæ­¥åˆ°ä¸»å†…å­˜ï¼Œå…¶ä»–æ ¸å¿ƒä¹Ÿä¸ä¼šå®æ—¶ä»ä¸»å†…å­˜åˆ·æ–°</strong>ã€‚</p>
<h3 data-id="heading-8">3.3 è§£å†³æ–¹æ¡ˆå¯¹æ¯”</h3>









































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>æ€§èƒ½å¼€é”€</th><th>é€‚ç”¨åœºæ™¯</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td><strong>synchronized</strong></td><td>é«˜ï¼ˆæ¶‰åŠé”ç«äº‰å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰</td><td>éœ€è¦åŸå­æ€§æ“ä½œ</td><td>é‡é‡çº§ï¼Œé˜»å¡å¼</td></tr><tr><td><strong>volatile</strong></td><td>ä½ï¼ˆä»…å†…å­˜å±éšœï¼‰</td><td>å•ä¸ªå˜é‡çš„è¯»å†™</td><td>æ— æ³•ä¿è¯å¤åˆæ“ä½œåŸå­æ€§</td></tr><tr><td><strong>Lockæ¥å£</strong></td><td>ä¸­ç­‰ï¼ˆå¯é€‰æ‹©å…¬å¹³/éå…¬å¹³ï¼‰</td><td>å¤æ‚çš„åŒæ­¥åœºæ™¯</td><td>éœ€è¦æ‰‹åŠ¨é‡Šæ”¾</td></tr><tr><td><strong>Atomicç±»</strong></td><td>ä½ï¼ˆCAS+å†…å­˜å±éšœï¼‰</td><td>è®¡æ•°å™¨ã€çŠ¶æ€æ ‡å¿—</td><td>ä»…æ”¯æŒç‰¹å®šç±»å‹</td></tr><tr><td><strong>æ™®é€šå˜é‡</strong></td><td>æ— </td><td>å•çº¿ç¨‹æˆ–ä¸å˜å¯¹è±¡</td><td>å¹¶å‘ç¯å¢ƒä¸å®‰å…¨</td></tr></tbody></table>
<p><strong>å†…å­˜å±éšœçš„ä¼˜åŠ¿</strong>ï¼šå®ƒæ˜¯<code>volatile</code>ã€<code>synchronized</code>ã€<code>Atomic</code>ç­‰å¹¶å‘å·¥å…·çš„åº•å±‚å®ç°æœºåˆ¶ï¼Œæ€§èƒ½å¼€é”€æœ€å°ã€‚</p>
<h3 data-id="heading-9">3.4 é€‚ç”¨ä¸ä¸é€‚ç”¨åœºæ™¯</h3>
<p>âœ… <strong>é€‚ç”¨åœºæ™¯</strong></p>
<ul>
<li>çŠ¶æ€æ ‡å¿—ä½ï¼ˆå¦‚<code>volatile boolean running</code>ï¼‰</li>
<li>åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼</li>
<li>å‘å¸ƒ/è®¢é˜…æ¨¡å¼ä¸­çš„æ•°æ®å…±äº«</li>
<li>é«˜æ€§èƒ½å¹¶å‘åº“çš„åº•å±‚å®ç°</li>
</ul>
<p>âŒ <strong>ä¸é€‚ç”¨åœºæ™¯</strong></p>
<ul>
<li>éœ€è¦ä¿è¯å¤åˆæ“ä½œåŸå­æ€§ï¼ˆå¦‚<code>count++</code>ï¼‰</li>
<li>éœ€è¦é˜»å¡ç­‰å¾…çš„åœºæ™¯</li>
<li>å¯¹æ€§èƒ½ä¸æ•æ„Ÿçš„æ™®é€šä¸šåŠ¡ä»£ç </li>
</ul>
<hr/>
<h2 data-id="heading-10">å››ã€Javaçš„å››ç§å†…å­˜å±éšœç±»å‹</h2>
<p>Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰å®šä¹‰äº†4ç§å†…å­˜å±éšœï¼š</p>
<h3 data-id="heading-11">4.1 LoadLoadå±éšœï¼ˆè¯»-è¯»å±éšœï¼‰</h3>
<p><strong>è¯­ä¹‰</strong>ï¼š<code>Load1; LoadLoad; Load2</code><br/>
<strong>ä½œç”¨</strong>ï¼šç¡®ä¿<code>Load1</code>çš„æ•°æ®<strong>è¯»å–</strong>å…ˆäº<code>Load2</code>åŠåç»­æ‰€æœ‰è¯»æ“ä½œ</p>
<p><strong>å®é™…åœºæ™¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å‡è®¾çº¿ç¨‹1å†™å…¥</span>
obj.field1 = <span class="hljs-number">1</span>;
obj.field2 = <span class="hljs-number">2</span>;

<span class="hljs-comment">// çº¿ç¨‹2è¯»å–ï¼ˆéœ€è¦LoadLoadå±éšœï¼‰</span>
<span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> obj.field1;  <span class="hljs-comment">// Load1</span>
<span class="hljs-comment">// &lt;LoadLoadå±éšœ&gt;</span>
<span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> obj.field2;  <span class="hljs-comment">// Load2ï¼Œä¿è¯ä¸€å®šèƒ½è¯»åˆ°æœ€æ–°çš„field1</span>
</code></pre>
<h3 data-id="heading-12">4.2 StoreStoreå±éšœï¼ˆå†™-å†™å±éšœï¼‰</h3>
<p><strong>è¯­ä¹‰</strong>ï¼š<code>Store1; StoreStore; Store2</code><br/>
<strong>ä½œç”¨</strong>ï¼šç¡®ä¿<code>Store1</code>çš„æ•°æ®<strong>åˆ·æ–°åˆ°ä¸»å†…å­˜</strong>å…ˆäº<code>Store2</code>åŠåç»­æ‰€æœ‰å†™æ“ä½œ</p>
<p><strong>å®é™…åœºæ™¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataPublisher</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> data;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> ready;  <span class="hljs-comment">// volatileå†™ä¼šæ’å…¥StoreStoreå±éšœ</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publish</span><span class="hljs-params">()</span> {
        data = <span class="hljs-number">42</span>;        <span class="hljs-comment">// Store1ï¼šæ™®é€šå†™</span>
        <span class="hljs-comment">// &lt;StoreStoreå±éšœ&gt;</span>
        ready = <span class="hljs-literal">true</span>;     <span class="hljs-comment">// Store2ï¼švolatileå†™ï¼Œç¡®ä¿dataå…ˆåˆ·æ–°åˆ°ä¸»å†…å­˜</span>
    }
}
</code></pre>
<h3 data-id="heading-13">4.3 LoadStoreå±éšœï¼ˆè¯»-å†™å±éšœï¼‰</h3>
<p><strong>è¯­ä¹‰</strong>ï¼š<code>Load1; LoadStore; Store2</code><br/>
<strong>ä½œç”¨</strong>ï¼šç¡®ä¿<code>Load1</code>çš„æ•°æ®<strong>è¯»å–</strong>å…ˆäº<code>Store2</code>åŠåç»­æ‰€æœ‰å†™æ“ä½œ</p>
<p><strong>å®é™…åœºæ™¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é˜²æ­¢è¯»æ“ä½œè¢«é‡æ’åºåˆ°å†™æ“ä½œä¹‹å</span>
<span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> sharedVar;  <span class="hljs-comment">// Load1</span>
<span class="hljs-comment">// &lt;LoadStoreå±éšœ&gt;</span>
localVar = <span class="hljs-number">100</span>;     <span class="hljs-comment">// Store2</span>
</code></pre>
<h3 data-id="heading-14">4.4 StoreLoadå±éšœï¼ˆå†™-è¯»å±éšœï¼‰â­ æœ€é‡è¦ï¼</h3>
<p><strong>è¯­ä¹‰</strong>ï¼š<code>Store1; StoreLoad; Load2</code><br/>
<strong>ä½œç”¨</strong>ï¼šç¡®ä¿<code>Store1</code>çš„æ•°æ®<strong>åˆ·æ–°åˆ°ä¸»å†…å­˜</strong>å…ˆäº<code>Load2</code>åŠåç»­æ‰€æœ‰è¯»æ“ä½œ</p>
<p>âš ï¸ <strong>è¿™æ˜¯å¼€é”€æœ€å¤§çš„å±éšœ</strong>ï¼Œå®ƒä¼šè®©å†™ç¼“å†²åŒºçš„æ‰€æœ‰æ•°æ®åˆ·æ–°åˆ°ä¸»å†…å­˜ã€‚</p>
<p><strong>å®é™…åœºæ™¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> sharedVar;  <span class="hljs-comment">// volatileåŒæ—¶å…·æœ‰è¯»å†™å±éšœ</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
        sharedVar = <span class="hljs-number">1</span>;  <span class="hljs-comment">// volatileå†™ï¼Œåé¢æ’å…¥StoreLoadå±éšœ</span>
        <span class="hljs-comment">// &lt;StoreLoadå±éšœ&gt;</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// &lt;StoreLoadå±éšœ&gt;</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> sharedVar;  <span class="hljs-comment">// volatileè¯»ï¼Œå‰é¢æ’å…¥StoreLoadå±éšœ</span>
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-15">äº”ã€åŸºç¡€ç”¨æ³•ï¼švolatileä¸å†…å­˜å±éšœ</h2>
<h3 data-id="heading-16">5.1 volatileçš„å†…å­˜å±éšœè§„åˆ™ï¼ˆğŸ”¥é¢è¯•é«˜é¢‘ï¼‰</h3>
<p>JMMå¯¹<code>volatile</code>å˜é‡çš„è¯»å†™æ“ä½œï¼Œä¼šè‡ªåŠ¨æ’å…¥å†…å­˜å±éšœï¼š</p>



































<table><thead><tr><th>æ“ä½œç±»å‹</th><th>æ’å…¥ä½ç½®</th><th>å±éšœç±»å‹</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>volatileå†™</strong></td><td>å†™æ“ä½œ<strong>ä¹‹å‰</strong></td><td>StoreStore</td><td>é˜²æ­¢å‰é¢çš„æ™®é€šå†™ä¸volatileå†™é‡æ’åº</td></tr><tr><td><strong>volatileå†™</strong></td><td>å†™æ“ä½œ<strong>ä¹‹å</strong></td><td>StoreLoad</td><td>é˜²æ­¢volatileå†™ä¸åé¢çš„volatileè¯»/å†™é‡æ’åº</td></tr><tr><td><strong>volatileè¯»</strong></td><td>è¯»æ“ä½œ<strong>ä¹‹å</strong></td><td>LoadLoad</td><td>é˜²æ­¢volatileè¯»ä¸åé¢çš„æ™®é€šè¯»é‡æ’åº</td></tr><tr><td><strong>volatileè¯»</strong></td><td>è¯»æ“ä½œ<strong>ä¹‹å</strong></td><td>LoadStore</td><td>é˜²æ­¢volatileè¯»ä¸åé¢çš„æ™®é€šå†™é‡æ’åº</td></tr></tbody></table>
<h3 data-id="heading-17">5.2 å®Œæ•´ä»£ç ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryBarrierDemo</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">data1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">data2</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">ready</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// å…³é”®ï¼švolatileå˜é‡</span>
    
    <span class="hljs-comment">// ğŸ”¥é¢è¯•è€ƒç‚¹ï¼šä¸ºä»€ä¹ˆè¿™é‡Œå¿…é¡»ç”¨volatileï¼Ÿ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
        data1 = <span class="hljs-number">1</span>;              <span class="hljs-comment">// æ™®é€šå†™</span>
        data2 = <span class="hljs-number">2</span>;              <span class="hljs-comment">// æ™®é€šå†™</span>
        <span class="hljs-comment">// &lt;StoreStoreå±éšœ&gt;ï¼šç¡®ä¿data1/data2å…ˆåˆ·æ–°åˆ°ä¸»å†…å­˜</span>
        ready = <span class="hljs-literal">true</span>;           <span class="hljs-comment">// volatileå†™</span>
        <span class="hljs-comment">// &lt;StoreLoadå±éšœ&gt;ï¼šç¡®ä¿readyçš„å†™å¯¹å…¶ä»–çº¿ç¨‹å¯è§</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// &lt;LoadLoadå±éšœ&gt;</span>
        <span class="hljs-comment">// &lt;LoadStoreå±éšœ&gt;</span>
        <span class="hljs-keyword">if</span> (ready) {            <span class="hljs-comment">// volatileè¯»</span>
            <span class="hljs-comment">// èƒ½ä¿è¯è¯»åˆ°data1=1, data2=2</span>
            System.out.println(data1 + <span class="hljs-string">", "</span> + data2);
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">MemoryBarrierDemo</span> <span class="hljs-variable">demo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MemoryBarrierDemo</span>();
        
        <span class="hljs-comment">// å†™çº¿ç¨‹</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">writerThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            demo.writer();
            System.out.println(<span class="hljs-string">"æ•°æ®å·²å‘å¸ƒ"</span>);
        });
        
        <span class="hljs-comment">// è¯»çº¿ç¨‹</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">readerThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">while</span> (!demo.ready) {  <span class="hljs-comment">// è‡ªæ—‹ç­‰å¾…</span>
                <span class="hljs-comment">// å¦‚æœreadyä¸æ˜¯volatileï¼Œè¿™é‡Œå¯èƒ½æ°¸è¿œè¯»ä¸åˆ°trueï¼</span>
            }
            demo.reader();
        });
        
        readerThread.start();
        Thread.sleep(<span class="hljs-number">100</span>);  <span class="hljs-comment">// ç¡®ä¿è¯»çº¿ç¨‹å…ˆå¯åŠ¨</span>
        writerThread.start();
        
        writerThread.join();
        readerThread.join();
    }
}
</code></pre>
<p><strong>ä»£ç è§£æï¼ˆé¢è¯•å¿…è€ƒï¼‰</strong>ï¼š</p>
<ol>
<li>
<p><strong>ä¸ºä»€ä¹ˆ<code>ready</code>å¿…é¡»æ˜¯<code>volatile</code>ï¼Ÿ</strong><br/>
â†’ å¦‚æœä¸åŠ <code>volatile</code>ï¼Œå†™çº¿ç¨‹å¯¹<code>ready</code>çš„ä¿®æ”¹å¯èƒ½ä¸€ç›´åœç•™åœ¨CPUç¼“å­˜ä¸­ï¼Œè¯»çº¿ç¨‹æ°¸è¿œè¯»ä¸åˆ°<code>true</code>ã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆèƒ½ä¿è¯è¯»åˆ°æœ€æ–°çš„<code>data1</code>å’Œ<code>data2</code>ï¼Ÿ</strong><br/>
â†’ <code>volatile</code>å†™ä¹‹å‰çš„<code>StoreStore</code>å±éšœï¼Œç¡®ä¿æ™®é€šå˜é‡å…ˆåˆ·æ–°åˆ°ä¸»å†…å­˜ï¼›<code>volatile</code>è¯»ä¹‹åçš„<code>LoadLoad</code>å±éšœï¼Œç¡®ä¿ä»ä¸»å†…å­˜è¯»å–æœ€æ–°å€¼ã€‚</p>
</li>
<li>
<p><strong>å¦‚æœå»æ‰<code>volatile</code>ä¼šæ€æ ·ï¼Ÿ</strong><br/>
â†’ å¯èƒ½å‡ºç°3ç§æƒ…å†µï¼š</p>
<ul>
<li>è¯»çº¿ç¨‹æ°¸è¿œè¯»ä¸åˆ°<code>ready=true</code>ï¼ˆå¯è§æ€§é—®é¢˜ï¼‰</li>
<li>è¯»åˆ°<code>ready=true</code>ï¼Œä½†<code>data1/data2</code>è¿˜æ˜¯0ï¼ˆæŒ‡ä»¤é‡æ’åºï¼‰</li>
<li>å¶å°”èƒ½æ­£å¸¸å·¥ä½œï¼ˆå–å†³äºCPUç¼“å­˜åŒæ­¥æ—¶æœºï¼‰</li>
</ul>
</li>
</ol>
<h3 data-id="heading-18">5.3 synchronizedçš„éšå¼å†…å­˜å±éšœ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SynchronizedBarrier</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">sharedData</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¿›å…¥synchronizedå‰ï¼šè·å–é” + LoadLoad + LoadStoreå±éšœ</span>
        <span class="hljs-keyword">synchronized</span> (lock) {
            sharedData++;  <span class="hljs-comment">// ğŸ”¥é¢è¯•é¢˜ï¼šè¿™é‡Œçš„++æ“ä½œæ˜¯åŸå­çš„å—ï¼Ÿ</span>
        }
        <span class="hljs-comment">// é€€å‡ºsynchronizedåï¼šStoreStore + StoreLoadå±éšœ + é‡Šæ”¾é”</span>
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>synchronized</code>åœ¨<strong>è·å–é”å</strong>æ’å…¥<code>LoadLoad</code>å’Œ<code>LoadStore</code>å±éšœ</li>
<li><code>synchronized</code>åœ¨<strong>é‡Šæ”¾é”å‰</strong>æ’å…¥<code>StoreStore</code>å’Œ<code>StoreLoad</code>å±éšœ</li>
<li>è¿™ç¡®ä¿äº†ä¸´ç•ŒåŒºå†…çš„æ“ä½œä¸ä¼šè¢«é‡æ’åºåˆ°ä¸´ç•ŒåŒºå¤–</li>
</ul>
<hr/>
<h2 data-id="heading-19">â­ å…­ã€åº•å±‚åŸç†æ·±æŒ–ï¼ˆé‡ç‚¹ç« èŠ‚ï¼‰</h2>
<h3 data-id="heading-20">6.1 ä»CPUæ¶æ„çœ‹å†…å­˜å±éšœ</h3>
<p>ç°ä»£CPUä¸ºäº†æå‡æ€§èƒ½ï¼Œé‡‡ç”¨äº†å¤šçº§ç¼“å­˜æ¶æ„ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[CPU Core 1] --&gt; B[L1 Cache]
    B --&gt; C[L2 Cache]
    C --&gt; D[L3 Cache å…±äº«]
    E[CPU Core 2] --&gt; F[L1 Cache]
    F --&gt; G[L2 Cache]
    G --&gt; D
    D --&gt; H[Main Memory ä¸»å†…å­˜]
    
    style A fill:#ff9999
    style E fill:#99ccff
    style D fill:#99ff99
    style H fill:#ffcc99
</code></pre>
<p><strong>å…³é”®é—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>Store Bufferï¼ˆå†™ç¼“å†²åŒºï¼‰</strong>ï¼šCPUå†™æ•°æ®æ—¶å…ˆæ”¾åˆ°å†™ç¼“å†²åŒºï¼Œå¼‚æ­¥åˆ·æ–°åˆ°ç¼“å­˜/å†…å­˜</li>
<li><strong>Invalidate Queueï¼ˆå¤±æ•ˆé˜Ÿåˆ—ï¼‰</strong>ï¼šCPUæ”¶åˆ°ç¼“å­˜å¤±æ•ˆæ¶ˆæ¯æ—¶ï¼Œå…ˆæ”¾é˜Ÿåˆ—ï¼Œå¼‚æ­¥å¤„ç†</li>
<li><strong>æŒ‡ä»¤æµæ°´çº¿</strong>ï¼šCPUå¯ä»¥ä¹±åºæ‰§è¡ŒæŒ‡ä»¤ï¼Œåªè¦ç»“æœæ­£ç¡®å³å¯</li>
</ol>
<h3 data-id="heading-21">6.2 volatileçš„å­—èŠ‚ç ä¸æ±‡ç¼–å®ç°ï¼ˆğŸ”¥é«˜é¢‘é¢è¯•ï¼‰</h3>
<p>çœ‹ä¸€æ®µç®€å•çš„volatileå†™æ“ä½œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileTest</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setValue</span><span class="hljs-params">(<span class="hljs-type">int</span> newValue)</span> {
        value = newValue;  <span class="hljs-comment">// volatileå†™</span>
    }
}
</code></pre>
<p><strong>å­—èŠ‚ç åˆ†æ</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">setValue</span><span class="hljs-params">(<span class="hljs-type">int</span>)</span></span>;
  Code:
    <span class="hljs-number">0</span>: aload_0
    <span class="hljs-number">1</span>: iload_1
    <span class="hljs-number">2</span>: putfield      #<span class="hljs-number">2</span>  <span class="hljs-comment">// Field value:I</span>
    <span class="hljs-number">5</span>: <span class="hljs-keyword">return</span>
</code></pre>
<p>å…³é”®æ˜¯<code>putfield</code>æŒ‡ä»¤å¯¹volatileå­—æ®µçš„å¤„ç†ï¼</p>
<p><strong>æ±‡ç¼–å±‚é¢ï¼ˆx86æ¶æ„ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-assembly" lang="assembly">mov    0x68(%rsi),%edi  ; å°†newValueåŠ è½½åˆ°å¯„å­˜å™¨
mov    %edi,0xc(%r10)   ; å†™å…¥å†…å­˜åœ°å€
lock addl $0x0,(%rsp)   ; ğŸ”¥å…³é”®ï¼šlockå‰ç¼€æŒ‡ä»¤ï¼
</code></pre>
<p><strong>lockæŒ‡ä»¤çš„ä½œç”¨ï¼ˆé¢è¯•å¿…ç­”ï¼‰</strong>ï¼š</p>
<ol>
<li><strong>é”å®šç¼“å­˜è¡Œ</strong>ï¼šç¡®ä¿å¯¹å†…å­˜çš„è¯»æ”¹å†™æ“ä½œæ˜¯åŸå­çš„</li>
<li><strong>åˆ·æ–°å†™ç¼“å†²åŒº</strong>ï¼šå¼ºåˆ¶å°†Store Bufferä¸­çš„æ•°æ®å†™å…¥ç¼“å­˜</li>
<li><strong>è§¦å‘ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼ˆMESIï¼‰</strong>ï¼šä½¿å…¶ä»–CPUçš„ç¼“å­˜å¤±æ•ˆ</li>
<li><strong>é˜»æ­¢æŒ‡ä»¤é‡æ’åº</strong>ï¼šç›¸å½“äºä¸€ä¸ªå…¨èƒ½å±éšœï¼ˆStoreLoadï¼‰</li>
</ol>
<h3 data-id="heading-22">6.3 MESIç¼“å­˜ä¸€è‡´æ€§åè®®</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; Invalid
    Invalid --&gt; Exclusive: CPUè¯»å–ï¼ˆæ— å…¶ä»–å‰¯æœ¬ï¼‰
    Invalid --&gt; Shared: CPUè¯»å–ï¼ˆæœ‰å…¶ä»–å‰¯æœ¬ï¼‰
    Exclusive --&gt; Modified: CPUå†™å…¥
    Exclusive --&gt; Shared: å…¶ä»–CPUè¯»å–
    Shared --&gt; Modified: CPUå†™å…¥ï¼ˆéœ€é€šçŸ¥å…¶ä»–CPUå¤±æ•ˆï¼‰
    Shared --&gt; Invalid: å…¶ä»–CPUå†™å…¥
    Modified --&gt; Invalid: å…¶ä»–CPUå†™å…¥
    Modified --&gt; Shared: å…¶ä»–CPUè¯»å–ï¼ˆéœ€å†™å›ä¸»å†…å­˜ï¼‰
</code></pre>
<p><strong>å››ç§çŠ¶æ€</strong>ï¼š</p>
<ul>
<li><strong>Mï¼ˆModifiedï¼‰</strong>ï¼šç¼“å­˜è¡Œè¢«ä¿®æ”¹ï¼Œä¸ä¸»å†…å­˜ä¸ä¸€è‡´ï¼Œåªæœ‰å½“å‰CPUæŒæœ‰</li>
<li><strong>Eï¼ˆExclusiveï¼‰</strong>ï¼šç¼“å­˜è¡Œç‹¬å ï¼Œä¸ä¸»å†…å­˜ä¸€è‡´ï¼Œåªæœ‰å½“å‰CPUæŒæœ‰</li>
<li><strong>Sï¼ˆSharedï¼‰</strong>ï¼šç¼“å­˜è¡Œå…±äº«ï¼Œä¸ä¸»å†…å­˜ä¸€è‡´ï¼Œå¤šä¸ªCPUæŒæœ‰</li>
<li><strong>Iï¼ˆInvalidï¼‰</strong>ï¼šç¼“å­˜è¡Œæ— æ•ˆ</li>
</ul>
<p><strong>volatileå†™è§¦å‘çš„MESIæ“ä½œ</strong>ï¼š</p>
<ol>
<li>CPUæ‰§è¡Œ<code>lock</code>æŒ‡ä»¤ â†’ å°†ModifiedçŠ¶æ€çš„ç¼“å­˜è¡Œå†™å›ä¸»å†…å­˜</li>
<li>å‘é€Invalidateæ¶ˆæ¯ â†’ å…¶ä»–CPUçš„ç¼“å­˜è¡Œå˜ä¸ºInvalid</li>
<li>å…¶ä»–CPUæ”¶åˆ°æ¶ˆæ¯ â†’ æ¸…ç©ºå¤±æ•ˆé˜Ÿåˆ—ï¼Œç¡®ä¿è¯»åˆ°æœ€æ–°å€¼</li>
</ol>
<h3 data-id="heading-23">6.4 JVMå±‚é¢çš„å®ç°ï¼šUnsafeç±»</h3>
<p>JVMé€šè¿‡<code>sun.misc.Unsafe</code>ç±»å®ç°åº•å±‚å†…å­˜å±éšœï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Unsafe</span> {
    <span class="hljs-comment">// ğŸ”¥ä¸‰ç§åŸºç¡€å†…å­˜å±éšœ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadFence</span><span class="hljs-params">()</span>;    <span class="hljs-comment">// LoadLoad + LoadStore</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">storeFence</span><span class="hljs-params">()</span>;   <span class="hljs-comment">// StoreStore + LoadStore</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fullFence</span><span class="hljs-params">()</span>;    <span class="hljs-comment">// æ‰€æœ‰å±éšœï¼ˆæœ€å¼ºï¼‰</span>
    
    <span class="hljs-comment">// volatileå†™çš„ç­‰ä»·å®ç°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">volatileWrite</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">int</span> value)</span> {
        putIntVolatile(o, offset, value);
        <span class="hljs-comment">// å†…éƒ¨å®ç°ï¼š</span>
        <span class="hljs-comment">// putInt(o, offset, value);</span>
        <span class="hljs-comment">// fullFence();  // æ’å…¥å…¨å±éšœ</span>
    }
}
</code></pre>
<p><strong>æŸ¥çœ‹OpenJDKæºç ï¼ˆjdk8u/hotspotï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// hotspot/src/share/vm/prims/unsafe.cpp</span>
<span class="hljs-built_in">UNSAFE_ENTRY</span>(<span class="hljs-type">void</span>, <span class="hljs-built_in">Unsafe_LoadFence</span>(JNIEnv *env, jobject unsafe))
  <span class="hljs-built_in">UnsafeWrapper</span>(<span class="hljs-string">"Unsafe_LoadFence"</span>);
  OrderAccess::<span class="hljs-built_in">acquire</span>();  <span class="hljs-comment">// è°ƒç”¨å¹³å°ç›¸å…³çš„å±éšœå®ç°</span>
<span class="hljs-function">UNSAFE_END

<span class="hljs-title">UNSAFE_ENTRY</span><span class="hljs-params">(<span class="hljs-type">void</span>, Unsafe_StoreFence(JNIEnv *env, jobject unsafe))</span>
  <span class="hljs-title">UnsafeWrapper</span><span class="hljs-params">(<span class="hljs-string">"Unsafe_StoreFence"</span>)</span></span>;
  OrderAccess::<span class="hljs-built_in">release</span>();
<span class="hljs-function">UNSAFE_END

<span class="hljs-title">UNSAFE_ENTRY</span><span class="hljs-params">(<span class="hljs-type">void</span>, Unsafe_FullFence(JNIEnv *env, jobject unsafe))</span>
  <span class="hljs-title">UnsafeWrapper</span><span class="hljs-params">(<span class="hljs-string">"Unsafe_FullFence"</span>)</span></span>;
  OrderAccess::<span class="hljs-built_in">fence</span>();    <span class="hljs-comment">// å®Œæ•´å†…å­˜å±éšœ</span>
UNSAFE_END
</code></pre>
<p><strong>x86å¹³å°å®ç°ï¼ˆhotspot/src/os_cpu/linux_x86ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">OrderAccess::fence</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (os::<span class="hljs-built_in">is_MP</span>()) {
    <span class="hljs-comment">// lockå‰ç¼€æŒ‡ä»¤ = å…¨å±éšœ</span>
    <span class="hljs-function">__asm__ <span class="hljs-title">volatile</span> <span class="hljs-params">(<span class="hljs-string">"lock; addl $0,0(%%rsp)"</span> : : : <span class="hljs-string">"cc"</span>, <span class="hljs-string">"memory"</span>)</span></span>;
  }
}

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">OrderAccess::acquire</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// x86çš„TSOæ¨¡å‹ï¼Œè¯»åä¸éœ€è¦é¢å¤–å±éšœ</span>
  <span class="hljs-comment">// ä½†ä¸ºäº†è·¨å¹³å°ï¼Œä½¿ç”¨compiler barrier</span>
  <span class="hljs-function">__asm__ <span class="hljs-title">volatile</span> <span class="hljs-params">(<span class="hljs-string">""</span> : : : <span class="hljs-string">"memory"</span>)</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">OrderAccess::release</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// x86çš„å†™å±éšœæ˜¯å…è´¹çš„ï¼ˆStore Bufferè‡ªåŠ¨ä¿è¯é¡ºåºï¼‰</span>
  <span class="hljs-function">__asm__ <span class="hljs-title">volatile</span> <span class="hljs-params">(<span class="hljs-string">""</span> : : : <span class="hljs-string">"memory"</span>)</span></span>;
}
</code></pre>
<h3 data-id="heading-24">6.5 ä¸åŒCPUæ¶æ„çš„å±éšœæŒ‡ä»¤å¯¹æ¯”</h3>








































<table><thead><tr><th>CPUæ¶æ„</th><th>å†…å­˜æ¨¡å‹</th><th>StoreLoadå±éšœ</th><th>LoadLoadå±éšœ</th><th>StoreStoreå±éšœ</th></tr></thead><tbody><tr><td><strong>x86/x64</strong></td><td>TSOï¼ˆå¼ºæ¨¡å‹ï¼‰</td><td><code>mfence</code> æˆ– <code>lock</code></td><td>å…è´¹ï¼ˆç¡¬ä»¶ä¿è¯ï¼‰</td><td>å…è´¹ï¼ˆç¡¬ä»¶ä¿è¯ï¼‰</td></tr><tr><td><strong>ARM</strong></td><td>å¼±æ¨¡å‹</td><td><code>dmb</code></td><td><code>dmb</code></td><td><code>dmb</code></td></tr><tr><td><strong>PowerPC</strong></td><td>å¼±æ¨¡å‹</td><td><code>sync</code></td><td><code>lwsync</code></td><td><code>lwsync</code></td></tr><tr><td><strong>SPARC</strong></td><td>TSO</td><td><code>membar #StoreLoad</code></td><td>å…è´¹</td><td>å…è´¹</td></tr></tbody></table>
<p><strong>ä¸ºä»€ä¹ˆx86æ€§èƒ½æ›´å¥½ï¼Ÿ</strong><br/>
â†’ x86çš„TSOï¼ˆTotal Store Orderï¼‰æ¨¡å‹ç¡¬ä»¶ä¿è¯äº†å¤§éƒ¨åˆ†é¡ºåºï¼Œåªæœ‰StoreLoadéœ€è¦æ˜¾å¼å±éšœã€‚ARMç­‰å¼±æ¨¡å‹CPUéœ€è¦æ›´å¤šçš„å†…å­˜å±éšœæŒ‡ä»¤ã€‚</p>
<h3 data-id="heading-25">6.6 åŒé‡æ£€æŸ¥é”çš„å†…å­˜å±éšœåˆ†æï¼ˆğŸ”¥å¿…è€ƒï¼‰</h3>
<p>å›åˆ°å¼€ç¯‡çš„å•ä¾‹æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> Singleton instance;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {          <span class="hljs-comment">// ç¬¬ä¸€æ¬¡æ£€æŸ¥ï¼ˆè¯»ï¼‰</span>
            <span class="hljs-keyword">synchronized</span> (Singleton.class) {
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {  <span class="hljs-comment">// ç¬¬äºŒæ¬¡æ£€æŸ¥ï¼ˆè¯»ï¼‰</span>
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();  <span class="hljs-comment">// ğŸ”¥é—®é¢˜æ ¸å¿ƒ</span>
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆå¿…é¡»ç”¨volatileï¼Ÿçœ‹å­—èŠ‚ç ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">new</span> Singleton         <span class="hljs-comment">// æ­¥éª¤1ï¼šåˆ†é…å†…å­˜</span>
dup
invokespecial &lt;<span class="hljs-keyword">init</span>&gt; <span class="hljs-comment">// æ­¥éª¤2ï¼šè°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–</span>
putstatic instance   <span class="hljs-comment">// æ­¥éª¤3ï¼šå°†å¼•ç”¨èµ‹å€¼ç»™instance</span>
</code></pre>
<p><strong>æ²¡æœ‰volatileæ—¶å¯èƒ½çš„é‡æ’åº</strong>ï¼š</p>
<pre><code class="hljs">æ­¥éª¤1ï¼šåˆ†é…å†…å­˜
æ­¥éª¤3ï¼šå°†å¼•ç”¨èµ‹å€¼ç»™instanceï¼ˆæ­¤æ—¶å¯¹è±¡æœªåˆå§‹åŒ–ï¼ï¼‰
æ­¥éª¤2ï¼šè°ƒç”¨æ„é€ å‡½æ•°
</code></pre>
<p><strong>çº¿ç¨‹äº¤äº’æ—¶åºå›¾</strong>ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant T1 as çº¿ç¨‹1ï¼ˆå†™ï¼‰
    participant Memory as ä¸»å†…å­˜
    participant T2 as çº¿ç¨‹2ï¼ˆè¯»ï¼‰
    
    Note over T1: instance == null
    T1-&gt;&gt;T1: è·å–é”
    T1-&gt;&gt;Memory: åˆ†é…å†…å­˜ç©ºé—´
    T1-&gt;&gt;Memory: èµ‹å€¼å¼•ç”¨ï¼ˆæœªåˆå§‹åŒ–ï¼ï¼‰
    Note over T2: è¯»åˆ°instance != null
    T2-&gt;&gt;T2: è·³è¿‡é”ï¼Œç›´æ¥è¿”å›
    Note over T2: ä½¿ç”¨æœªåˆå§‹åŒ–çš„å¯¹è±¡ ğŸ’¥
    T1-&gt;&gt;Memory: è°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–
    T1-&gt;&gt;T1: é‡Šæ”¾é”
</code></pre>
<p><strong>åŠ ä¸Švolatileåçš„ä¿è¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> Singleton instance;

<span class="hljs-comment">// volatileå†™æ’å…¥çš„å±éšœï¼š</span>
<span class="hljs-comment">// &lt;StoreStoreå±éšœ&gt;ï¼šç¡®ä¿æ„é€ å‡½æ•°æ‰§è¡Œå®Œæ¯•</span>
instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();  
<span class="hljs-comment">// &lt;StoreLoadå±éšœ&gt;ï¼šç¡®ä¿å…¶ä»–çº¿ç¨‹èƒ½è¯»åˆ°å®Œæ•´å¯¹è±¡</span>
</code></pre>
<h3 data-id="heading-26">6.7 ç‰ˆæœ¬æ¼”è¿›ï¼šJDK 9çš„VarHandle</h3>
<p>JDK 9å¼•å…¥äº†<code>VarHandle</code>ï¼Œæä¾›æ›´ç»†ç²’åº¦çš„å†…å­˜è®¿é—®æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VarHandleExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> VarHandle VALUE_HANDLE;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> value;
    
    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            MethodHandles.<span class="hljs-type">Lookup</span> <span class="hljs-variable">lookup</span> <span class="hljs-operator">=</span> MethodHandles.lookup();
            VALUE_HANDLE = lookup.findVarHandle(
                VarHandleExample.class, <span class="hljs-string">"value"</span>, <span class="hljs-type">int</span>.class
            );
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(e);
        }
    }
    
    <span class="hljs-comment">// ğŸ”¥å¯ä»¥é€‰æ‹©ä¸åŒçš„è®¿é—®æ¨¡å¼</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">differentAccessModes</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. æ™®é€šè¯»å†™ï¼ˆæ— ä¿è¯ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) VALUE_HANDLE.get(<span class="hljs-built_in">this</span>);
        VALUE_HANDLE.set(<span class="hljs-built_in">this</span>, <span class="hljs-number">42</span>);
        
        <span class="hljs-comment">// 2. Opaqueæ¨¡å¼ï¼ˆä¿è¯åŸå­æ€§ï¼Œæ— é¡ºåºä¿è¯ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">v2</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) VALUE_HANDLE.getOpaque(<span class="hljs-built_in">this</span>);
        VALUE_HANDLE.setOpaque(<span class="hljs-built_in">this</span>, <span class="hljs-number">42</span>);
        
        <span class="hljs-comment">// 3. Release/Acquireæ¨¡å¼ï¼ˆå•å‘å±éšœï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">v3</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) VALUE_HANDLE.getAcquire(<span class="hljs-built_in">this</span>);  <span class="hljs-comment">// LoadLoad + LoadStore</span>
        VALUE_HANDLE.setRelease(<span class="hljs-built_in">this</span>, <span class="hljs-number">42</span>);              <span class="hljs-comment">// StoreStore + LoadStore</span>
        
        <span class="hljs-comment">// 4. Volatileæ¨¡å¼ï¼ˆå®Œæ•´å±éšœï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">v4</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) VALUE_HANDLE.getVolatile(<span class="hljs-built_in">this</span>);  <span class="hljs-comment">// ç­‰åŒäºvolatileè¯»</span>
        VALUE_HANDLE.setVolatile(<span class="hljs-built_in">this</span>, <span class="hljs-number">42</span>);              <span class="hljs-comment">// ç­‰åŒäºvolatileå†™</span>
    }
}
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼ˆJMHåŸºå‡†æµ‹è¯•ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Benchmark                          Mode  Cnt   Score   Error  Units
plainAccess                        avgt   25   0.312 Â± 0.001  ns/op
opaqueAccess                       avgt   25   0.315 Â± 0.002  ns/op
acquireReleaseAccess               avgt   25   0.318 Â± 0.001  ns/op
volatileAccess                     avgt   25   0.825 Â± 0.003  ns/op  // æœ€æ…¢
</code></pre>
<hr/>
<h2 data-id="heading-27">ä¸ƒã€æ€§èƒ½åˆ†æä¸ä¼˜åŒ–</h2>
<h3 data-id="heading-28">7.1 å†…å­˜å±éšœçš„æ€§èƒ½å¼€é”€</h3>
<p><strong>æµ‹è¯•ç¯å¢ƒ</strong>ï¼šIntel i7-10700K, 16GB DDR4-3200, Ubuntu 20.04, JDK 11</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@BenchmarkMode(Mode.AverageTime)</span>
<span class="hljs-meta">@OutputTimeUnit(TimeUnit.NANOSECONDS)</span>
<span class="hljs-meta">@State(Scope.Thread)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BarrierBenchmark</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">plainVar</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">volatileVar</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">atomicVar</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">plainRead</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> plainVar;  <span class="hljs-comment">// æ— å±éšœ</span>
    }
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">volatileRead</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> volatileVar;  <span class="hljs-comment">// LoadLoad + LoadStore</span>
    }
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">plainWrite</span><span class="hljs-params">()</span> {
        plainVar = <span class="hljs-number">1</span>;  <span class="hljs-comment">// æ— å±éšœ</span>
    }
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">volatileWrite</span><span class="hljs-params">()</span> {
        volatileVar = <span class="hljs-number">1</span>;  <span class="hljs-comment">// StoreStore + StoreLoad</span>
    }
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">atomicRead</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> atomicVar.get();  <span class="hljs-comment">// volatileè¯»</span>
    }
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">atomicIncrement</span><span class="hljs-params">()</span> {
        atomicVar.incrementAndGet();  <span class="hljs-comment">// CAS + å†…å­˜å±éšœ</span>
    }
}
</code></pre>
<p><strong>æ€§èƒ½æµ‹è¯•ç»“æœ</strong>ï¼š</p>















































<table><thead><tr><th>æ“ä½œç±»å‹</th><th>è€—æ—¶ï¼ˆns/opï¼‰</th><th>ç›¸å¯¹å¼€é”€</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ™®é€šå˜é‡è¯»</td><td>0.31</td><td>1xï¼ˆåŸºçº¿ï¼‰</td><td>æ— ä»»ä½•å±éšœ</td></tr><tr><td>volatileè¯»</td><td>0.32</td><td>1.03x</td><td>LoadLoad+LoadStoreï¼ˆx86å‡ ä¹å…è´¹ï¼‰</td></tr><tr><td>æ™®é€šå˜é‡å†™</td><td>0.31</td><td>1x</td><td>æ— ä»»ä½•å±éšœ</td></tr><tr><td>volatileå†™</td><td>2.85</td><td>9.2x</td><td>StoreStore+<strong>StoreLoad</strong>ï¼ˆæœ€è´µï¼‰</td></tr><tr><td>AtomicIntegerè¯»</td><td>0.33</td><td>1.06x</td><td>ç­‰åŒäºvolatileè¯»</td></tr><tr><td>AtomicIntegerè‡ªå¢</td><td>15.7</td><td>50.6x</td><td>CASå¾ªç¯+å†…å­˜å±éšœ</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°</strong>ï¼š</p>
<ol>
<li><strong>volatileè¯»å‡ ä¹å…è´¹</strong>ï¼ˆx86æ¶æ„ï¼‰</li>
<li><strong>volatileå†™å¼€é”€ä¸»è¦æ¥è‡ªStoreLoadå±éšœ</strong>ï¼ˆéœ€è¦åˆ·æ–°Store Bufferï¼‰</li>
<li><strong>AtomicIntegerçš„è‡ªå¢æ“ä½œæœ€æ…¢</strong>ï¼ˆCASå¤±è´¥ä¼šé‡è¯•ï¼‰</li>
</ol>
<h3 data-id="heading-29">7.2 ä¸åŒCPUæ¶æ„çš„æ€§èƒ½å·®å¼‚</h3>



































<table><thead><tr><th>æ“ä½œ</th><th>x86 (TSO)</th><th>ARM (Weak)</th><th>æ€§èƒ½å·®å¼‚åŸå› </th></tr></thead><tbody><tr><td>volatileè¯»</td><td>~0.3ns</td><td>~2.5ns</td><td>ARMéœ€è¦dmbæŒ‡ä»¤</td></tr><tr><td>volatileå†™</td><td>~2.8ns</td><td>~8.5ns</td><td>ARMéœ€è¦å®Œæ•´çš„dmbå±éšœ</td></tr><tr><td>StoreLoad</td><td>~2.5ns</td><td>~8.0ns</td><td>ARMæ— ç¡¬ä»¶ä¿è¯ï¼Œéœ€æ˜¾å¼å±éšœ</td></tr><tr><td>LoadLoad</td><td>å…è´¹</td><td>~2.0ns</td><td>x86ç¡¬ä»¶ä¿è¯ï¼ŒARMéœ€å±éšœ</td></tr></tbody></table>
<p><strong>ä¸ºä»€ä¹ˆARMæ…¢ï¼Ÿ</strong><br/>
â†’ ARMçš„å¼±å†…å­˜æ¨¡å‹å…è®¸æ›´æ¿€è¿›çš„é‡æ’åºï¼Œéœ€è¦æ›´å¤šæ˜¾å¼å±éšœæŒ‡ä»¤ã€‚x86çš„TSOæ¨¡å‹ç¡¬ä»¶ä¿è¯äº†å¤§éƒ¨åˆ†é¡ºåºæ€§ã€‚</p>
<h3 data-id="heading-30">7.3 ä¼ªå…±äº«ï¼ˆFalse Sharingï¼‰ä¸ç¼“å­˜è¡Œå¡«å……</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒé”™è¯¯ç¤ºä¾‹ï¼šä¼ªå…±äº«é—®é¢˜</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FalseSharingBad</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value1;  <span class="hljs-comment">// å‡è®¾åœ¨ç¼“å­˜è¡Œåç§»0</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value2;  <span class="hljs-comment">// åœ¨ç¼“å­˜è¡Œåç§»8ï¼ˆåŒä¸€ç¼“å­˜è¡Œï¼ï¼‰</span>
    
    <span class="hljs-comment">// çº¿ç¨‹1ä¿®æ”¹value1 â†’ ç¼“å­˜è¡Œå¤±æ•ˆ â†’ çº¿ç¨‹2çš„value2ä¹Ÿå¤±æ•ˆï¼</span>
}

<span class="hljs-comment">// âœ…æ­£ç¡®ç¤ºä¾‹ï¼šç¼“å­˜è¡Œå¡«å……</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FalseSharingGood</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value1;
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> p1, p2, p3, p4, p5, p6, p7;  <span class="hljs-comment">// å¡«å……56å­—èŠ‚</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value2;  <span class="hljs-comment">// ç¡®ä¿åœ¨ä¸åŒç¼“å­˜è¡Œ</span>
    
    <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨@Contendedæ³¨è§£ï¼ˆJDK 8+ï¼Œéœ€è¦-XX:-RestrictContendedï¼‰</span>
}

<span class="hljs-meta">@sun</span>.misc.Contended  <span class="hljs-comment">// è‡ªåŠ¨å¡«å……ç¼“å­˜è¡Œ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContendedExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value1;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value2;  <span class="hljs-comment">// JVMè‡ªåŠ¨å¡«å……ï¼Œé¿å…ä¼ªå…±äº«</span>
}
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼ˆ4çº¿ç¨‹åŒæ—¶å†™å…¥ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">æ— å¡«å……ï¼ˆä¼ªå…±äº«ï¼‰ï¼š    <span class="hljs-number">1500</span> ms
æ‰‹åŠ¨å¡«å……ï¼š            <span class="hljs-number">320</span> ms
<span class="hljs-keyword">@Contended</span>æ³¨è§£ï¼š      <span class="hljs-number">310</span> ms
</code></pre>
<h3 data-id="heading-31">7.4 ä¼˜åŒ–å»ºè®®</h3>
<h4 data-id="heading-32">åœºæ™¯1ï¼šé«˜é¢‘è¯»ã€ä½é¢‘å†™</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ…æ¨èï¼šç”¨volatile</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Configuration config;  <span class="hljs-comment">// è¯»å¤šå†™å°‘</span>
    
    <span class="hljs-keyword">public</span> Configuration <span class="hljs-title function_">getConfig</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> config;  <span class="hljs-comment">// volatileè¯»å¼€é”€å¾ˆå°</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateConfig</span><span class="hljs-params">(Configuration newConfig)</span> {
        config = newConfig;  <span class="hljs-comment">// å¶å°”å†™ä¸€æ¬¡ï¼Œå¯ä»¥æ¥å—StoreLoadå¼€é”€</span>
    }
}
</code></pre>
<h4 data-id="heading-33">åœºæ™¯2ï¼šé«˜é¢‘å†™ã€éœ€è¦åŸå­æ€§</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ…æ¨èï¼šç”¨AtomicIntegeræˆ–LongAdder</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
    
    <span class="hljs-comment">// æˆ–è€…ç”¨LongAdderï¼ˆå¤šçº¿ç¨‹å†™å…¥æ›´å¿«ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">LongAdder</span> <span class="hljs-variable">adder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LongAdder</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        adder.increment();  <span class="hljs-comment">// å†…éƒ¨åˆ†æ®µï¼Œå‡å°‘ç«äº‰</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getCount</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> adder.sum();
    }
}
</code></pre>
<h4 data-id="heading-34">åœºæ™¯3ï¼šå¤æ‚çš„çŠ¶æ€æœº</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ…æ¨èï¼šç”¨synchronizedæˆ–ReentrantLock</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StateMachine</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">state</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// å¤æ‚çš„çŠ¶æ€è½¬æ¢é€»è¾‘</span>
            <span class="hljs-keyword">if</span> (state == <span class="hljs-number">0</span>) {
                state = <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state == <span class="hljs-number">1</span>) {
                state = <span class="hljs-number">2</span>;
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-35">7.5 æ˜“æ··æ·†æ¦‚å¿µå¯¹æ¯”</h3>















































<table><thead><tr><th>æ¦‚å¿µ</th><th>ä½œç”¨èŒƒå›´</th><th>æ€§èƒ½å¼€é”€</th><th>é€‚ç”¨åœºæ™¯</th><th>å¸¸è§è¯¯åŒº</th></tr></thead><tbody><tr><td><strong>å†…å­˜å±éšœ</strong></td><td>CPUæŒ‡ä»¤çº§åˆ«</td><td>ä½</td><td>volatile/Atomicåº•å±‚å®ç°</td><td>âŒè®¤ä¸ºæ˜¯Javaç‰¹æ€§ï¼ˆå®é™…æ˜¯CPUç‰¹æ€§ï¼‰</td></tr><tr><td><strong>volatile</strong></td><td>Javaå˜é‡çº§åˆ«</td><td>ä½~ä¸­</td><td>å•ä¸ªå˜é‡çš„å¯è§æ€§</td><td>âŒè®¤ä¸ºèƒ½ä¿è¯å¤åˆæ“ä½œåŸå­æ€§</td></tr><tr><td><strong>synchronized</strong></td><td>ä»£ç å—çº§åˆ«</td><td>ä¸­~é«˜</td><td>éœ€è¦åŸå­æ€§çš„å¤æ‚æ“ä½œ</td><td>âŒè®¤ä¸ºåªæ˜¯åŠ é”ï¼ˆè¿˜æœ‰å†…å­˜è¯­ä¹‰ï¼‰</td></tr><tr><td><strong>happens-before</strong></td><td>JMMè§„åˆ™</td><td>æ¦‚å¿µæ€§</td><td>æ¨ç†çº¿ç¨‹å®‰å…¨æ€§</td><td>âŒè®¤ä¸ºæ˜¯æ—¶é—´å…ˆåï¼ˆå®é™…æ˜¯å¯è§æ€§å…³ç³»ï¼‰</td></tr><tr><td><strong>CAS</strong></td><td>åŸå­æ“ä½œ</td><td>ä¸­</td><td>æ— é”åŒ–å¹¶å‘</td><td>âŒè®¤ä¸ºæ— å¼€é”€ï¼ˆæœ‰å†…å­˜å±éšœ+ABAé—®é¢˜ï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-36">å…«ã€å¸¸è§å‘ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-37">8.1 å‘1ï¼švolatileä¸ä¿è¯åŸå­æ€§ï¼ˆâ­â­â­é«˜é¢‘ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒé”™è¯¯ç¤ºä¾‹ï¼šä»¥ä¸ºvolatileèƒ½ä¿è¯count++çš„åŸå­æ€§</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileCounter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++;  <span class="hljs-comment">// è¿™æ˜¯ä¸‰ä¸ªæ“ä½œï¼šè¯»-æ”¹-å†™ï¼Œä¸æ˜¯åŸå­çš„ï¼</span>
    }
}

<span class="hljs-comment">// é—®é¢˜åˆ†æï¼šå­—èŠ‚ç å±‚é¢</span>
<span class="hljs-comment">// 0: aload_0</span>
<span class="hljs-comment">// 1: dup</span>
<span class="hljs-comment">// 2: getfield      #2  // è¯»å–count</span>
<span class="hljs-comment">// 5: iconst_1</span>
<span class="hljs-comment">// 6: iadd               // è®¡ç®—count+1</span>
<span class="hljs-comment">// 7: putfield      #2  // å†™å›count</span>
<span class="hljs-comment">// çº¿ç¨‹Aè¯»åˆ°0ï¼Œçº¿ç¨‹Bä¹Ÿè¯»åˆ°0 â†’ éƒ½å†™å…¥1 â†’ ä¸¢å¤±ä¸€æ¬¡è‡ªå¢ï¼</span>

<span class="hljs-comment">// âœ…æ­£ç¡®å†™æ³•1ï¼šä½¿ç”¨AtomicInteger</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CorrectCounter1</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count.incrementAndGet();  <span class="hljs-comment">// CASä¿è¯åŸå­æ€§</span>
    }
}

<span class="hljs-comment">// âœ…æ­£ç¡®å†™æ³•2ï¼šä½¿ç”¨synchronized</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CorrectCounter2</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++;  <span class="hljs-comment">// synchronizedä¿è¯åŸå­æ€§</span>
    }
}
</code></pre>
<h3 data-id="heading-38">8.2 å‘2ï¼šå¯¹è±¡å¼•ç”¨çš„å¯è§æ€§é™·é˜±</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒé”™è¯¯ç¤ºä¾‹ï¼šä»¥ä¸ºvolatileå¼•ç”¨èƒ½ä¿è¯å¯¹è±¡å†…å®¹å¯è§</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileObjectTrap</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">MyData</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyData</span>();
    
    <span class="hljs-comment">// çº¿ç¨‹1</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
        data.value = <span class="hljs-number">42</span>;  <span class="hljs-comment">// âš ï¸ è¿™ä¸ªå†™æ“ä½œæ²¡æœ‰volatileè¯­ä¹‰ï¼</span>
    }
    
    <span class="hljs-comment">// çº¿ç¨‹2</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> data.value;  <span class="hljs-comment">// å¯èƒ½è¯»åˆ°æ—§å€¼0</span>
    }
}

<span class="hljs-comment">// åº•å±‚åŸå› ï¼švolatileåªä¿è¯å¼•ç”¨çš„å¯è§æ€§ï¼Œä¸ä¿è¯å¯¹è±¡å­—æ®µçš„å¯è§æ€§</span>

<span class="hljs-comment">// âœ…æ­£ç¡®å†™æ³•1ï¼šå‘å¸ƒæ•´ä¸ªå¯¹è±¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CorrectVolatileObject1</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> MyData data;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
        <span class="hljs-type">MyData</span> <span class="hljs-variable">newData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyData</span>();
        newData.value = <span class="hljs-number">42</span>;
        data = newData;  <span class="hljs-comment">// volatileå†™ï¼Œä¿è¯æ•´ä¸ªå¯¹è±¡å¯è§</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
        <span class="hljs-type">MyData</span> <span class="hljs-variable">localData</span> <span class="hljs-operator">=</span> data;  <span class="hljs-comment">// volatileè¯»</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> localData.value;  <span class="hljs-comment">// ä¿è¯èƒ½è¯»åˆ°42</span>
    }
}

<span class="hljs-comment">// âœ…æ­£ç¡®å†™æ³•2ï¼šå¯¹è±¡å­—æ®µä¹Ÿç”¨volatile</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CorrectVolatileObject2</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">MyData</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyData</span>();
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyData</span> {
        <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> value;  <span class="hljs-comment">// å­—æ®µä¹Ÿå£°æ˜ä¸ºvolatile</span>
    }
}
</code></pre>
<h3 data-id="heading-39">8.3 å‘3ï¼šè¿‡åº¦ä½¿ç”¨volatileé™ä½æ€§èƒ½</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒé”™è¯¯ç¤ºä¾‹ï¼šæ‰€æœ‰å­—æ®µéƒ½åŠ volatile</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OverUseVolatile</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> field1;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> field2;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> field3;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> field4;
    <span class="hljs-comment">// ... æ›´å¤švolatileå­—æ®µ</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateAll</span><span class="hljs-params">()</span> {
        field1 = <span class="hljs-number">1</span>;  <span class="hljs-comment">// StoreStore + StoreLoad</span>
        field2 = <span class="hljs-number">2</span>;  <span class="hljs-comment">// StoreStore + StoreLoad</span>
        field3 = <span class="hljs-number">3</span>;  <span class="hljs-comment">// StoreStore + StoreLoad</span>
        field4 = <span class="hljs-number">4</span>;  <span class="hljs-comment">// StoreStore + StoreLoad</span>
        <span class="hljs-comment">// æ¯æ¬¡å†™å…¥éƒ½æœ‰æ˜‚è´µçš„StoreLoadå±éšœï¼</span>
    }
}

<span class="hljs-comment">// âœ…æ­£ç¡®å†™æ³•ï¼šç”¨ä¸€ä¸ªvolatileæ ‡å¿—ä½</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OptimizedVolatile</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> field1;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> field2;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> field3;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> field4;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">updated</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateAll</span><span class="hljs-params">()</span> {
        field1 = <span class="hljs-number">1</span>;
        field2 = <span class="hljs-number">2</span>;
        field3 = <span class="hljs-number">3</span>;
        field4 = <span class="hljs-number">4</span>;
        <span class="hljs-comment">// StoreStoreå±éšœï¼šç¡®ä¿ä¸Šé¢çš„å†™å…¥å®Œæˆ</span>
        updated = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// åªåœ¨æœ€åä¸€ä¸ªvolatileå†™</span>
        <span class="hljs-comment">// StoreLoadå±éšœ</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readAll</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (updated) {  <span class="hljs-comment">// volatileè¯»</span>
            <span class="hljs-comment">// LoadLoadå±éšœï¼šç¡®ä¿èƒ½è¯»åˆ°æœ€æ–°çš„field1-4</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> field1;
            <span class="hljs-type">int</span> <span class="hljs-variable">v2</span> <span class="hljs-operator">=</span> field2;
            <span class="hljs-type">int</span> <span class="hljs-variable">v3</span> <span class="hljs-operator">=</span> field3;
            <span class="hljs-type">int</span> <span class="hljs-variable">v4</span> <span class="hljs-operator">=</span> field4;
        }
    }
}
</code></pre>
<h3 data-id="heading-40">8.4 å‘4ï¼šæ‡’åŠ è½½çš„åŒé‡æ£€æŸ¥é”å¿˜è®°volatile</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒé”™è¯¯ç¤ºä¾‹ï¼šDCLæ²¡åŠ volatile</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BrokenDCL</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SomeClass instance;  <span class="hljs-comment">// ç¼ºå°‘volatileï¼</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SomeClass <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (BrokenDCL.class) {
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SomeClass</span>();  <span class="hljs-comment">// å¯èƒ½å‘ç”ŸæŒ‡ä»¤é‡æ’åº</span>
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;  <span class="hljs-comment">// å¯èƒ½è¿”å›æœªåˆå§‹åŒ–çš„å¯¹è±¡ï¼</span>
    }
}

<span class="hljs-comment">// âœ…æ­£ç¡®å†™æ³•ï¼šåŠ ä¸Švolatile</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CorrectDCL</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> SomeClass instance;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SomeClass <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (CorrectDCL.class) {
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SomeClass</span>();
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;
    }
}

<span class="hljs-comment">// âœ…æ›´ä¼˜é›…çš„å†™æ³•ï¼šé™æ€å†…éƒ¨ç±»ï¼ˆæ¨èï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BestDCL</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">BestDCL</span><span class="hljs-params">()</span> {}
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Holder</span> {
        <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">BestDCL</span> <span class="hljs-variable">INSTANCE</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BestDCL</span>();
        <span class="hljs-comment">// åˆ©ç”¨ç±»åŠ è½½æœºåˆ¶ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ— éœ€volatile</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> BestDCL <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Holder.INSTANCE;
    }
}
</code></pre>
<h3 data-id="heading-41">8.5 å‘5ï¼šè¯¯ç”¨StoreLoadå±éšœå¯¼è‡´æ€§èƒ½é—®é¢˜</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒé”™è¯¯ç¤ºä¾‹ï¼šé¢‘ç¹çš„volatileå†™</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FrequentVolatileWrite</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> <span class="hljs-variable">counter</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">countEvents</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1_000_000</span>; i++) {
            counter++;  <span class="hljs-comment">// æ¯æ¬¡éƒ½æœ‰StoreLoadå±éšœï¼</span>
        }
    }
    <span class="hljs-comment">// æ€§èƒ½ï¼šçº¦ 800ms</span>
}

<span class="hljs-comment">// âœ…ä¼˜åŒ–å†™æ³•ï¼šæ‰¹é‡æ›´æ–°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BatchVolatileWrite</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> <span class="hljs-variable">counter</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">countEvents</span><span class="hljs-params">()</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">localCounter</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1_000_000</span>; i++) {
            localCounter++;  <span class="hljs-comment">// æœ¬åœ°å˜é‡ï¼Œæ— å±éšœ</span>
        }
        counter = localCounter;  <span class="hljs-comment">// åªæœ‰ä¸€æ¬¡volatileå†™</span>
    }
    <span class="hljs-comment">// æ€§èƒ½ï¼šçº¦ 2msï¼ˆæå‡400å€ï¼ï¼‰</span>
}
</code></pre>
<h3 data-id="heading-42">8.6 æœ€ä½³å®è·µæ¸…å•</h3>
<h4 data-id="heading-43">âœ… DOï¼ˆæ¨èåšæ³•ï¼‰</h4>
<ol>
<li>
<p><strong>çŠ¶æ€æ ‡å¿—ç”¨volatile</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">running</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
</code></pre>
</li>
<li>
<p><strong>ä¸€æ¬¡æ€§å‘å¸ƒç”¨volatile</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Configuration config;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> {
    <span class="hljs-type">Configuration</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> loadConfig();
    config = temp;  <span class="hljs-comment">// ä¸€æ¬¡æ€§å‘å¸ƒ</span>
}
</code></pre>
</li>
<li>
<p><strong>ç‹¬ç«‹è§‚å¯Ÿç”¨volatile</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> lastUpdateTime;
</code></pre>
</li>
<li>
<p><strong>è¯»å¤šå†™å°‘ç”¨volatile</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Map&lt;String, String&gt; cache;
</code></pre>
</li>
<li>
<p><strong>é¿å…ä¼ªå…±äº«ç”¨@Contended</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@sun</span>.misc.Contended
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> counter;
</code></pre>
</li>
</ol>
<h4 data-id="heading-44">âŒ DON'Tï¼ˆé¿å…åšæ³•ï¼‰</h4>
<ol>
<li>
<p><strong>å¤åˆæ“ä½œä¸è¦ç”¨volatile</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> count;
count++;  <span class="hljs-comment">// âŒé”™è¯¯ï¼æ”¹ç”¨AtomicInteger</span>
</code></pre>
</li>
<li>
<p><strong>ä¸è¦volatileæ•°ç»„å…ƒç´ </strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span>[] array;  <span class="hljs-comment">// âŒåªæœ‰å¼•ç”¨æ˜¯volatileï¼Œå…ƒç´ ä¸æ˜¯</span>
<span class="hljs-comment">// æ”¹ç”¨AtomicIntegerArray</span>
</code></pre>
</li>
<li>
<p><strong>ä¸è¦åœ¨å¾ªç¯å†…é¢‘ç¹å†™volatile</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; N; i++) {
    volatileVar = i;  <span class="hljs-comment">// âŒæ¯æ¬¡éƒ½æœ‰StoreLoadå±éšœ</span>
}
</code></pre>
</li>
<li>
<p><strong>ä¸è¦ç”¨volatileä»£æ›¿é”</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">volatile</span> Map&lt;String, String&gt; map;
map.put(key, value);  <span class="hljs-comment">// âŒmapå†…éƒ¨æ“ä½œä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</span>
</code></pre>
</li>
<li>
<p><strong>ä¸è¦åœ¨æ€§èƒ½æ•æ„Ÿè·¯å¾„è¿‡åº¦ä½¿ç”¨</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hotMethod</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> volatileVar;  <span class="hljs-comment">// å¦‚æœæ¯ç§’è°ƒç”¨ç™¾ä¸‡æ¬¡ï¼Œè€ƒè™‘ä¼˜åŒ–</span>
}
</code></pre>
</li>
</ol>
<hr/>
<h2 data-id="heading-45">â­ ä¹ã€é¢è¯•é¢˜ç²¾é€‰</h2>
<h3 data-id="heading-46">â­ åŸºç¡€é¢˜ï¼ˆå¿…ç­”ï¼‰</h3>
<h4 data-id="heading-47">Q1: volatileå…³é”®å­—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿåº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>
<p>volatileæœ‰ä¸¤ä¸ªæ ¸å¿ƒä½œç”¨ï¼š</p>
<ol>
<li><strong>ä¿è¯å¯è§æ€§</strong>ï¼šä¸€ä¸ªçº¿ç¨‹å¯¹volatileå˜é‡çš„ä¿®æ”¹ï¼Œå¯¹å…¶ä»–çº¿ç¨‹ç«‹å³å¯è§</li>
<li><strong>é˜²æ­¢æŒ‡ä»¤é‡æ’åº</strong>ï¼švolatileå˜é‡çš„è¯»å†™æ“ä½œä¸ä¼šè¢«é‡æ’åº</li>
</ol>
<p><strong>åº•å±‚å®ç°</strong>ï¼ˆåˆ†ç‚¹ä½œç­”ï¼‰ï¼š</p>
<ul>
<li><strong>å­—èŠ‚ç å±‚é¢</strong>ï¼š<code>putfield</code>/<code>getfield</code>æŒ‡ä»¤è¯†åˆ«volatileæ ‡å¿—</li>
<li><strong>JVMå±‚é¢</strong>ï¼šé€šè¿‡<code>Unsafe</code>ç±»çš„<code>loadFence()</code>/<code>storeFence()</code>/<code>fullFence()</code>æ’å…¥å†…å­˜å±éšœ</li>
<li><strong>CPUå±‚é¢ï¼ˆx86ï¼‰</strong>ï¼šä½¿ç”¨<code>lock</code>å‰ç¼€æŒ‡ä»¤ï¼ˆå¦‚<code>lock addl $0x0,(%rsp)</code>ï¼‰
<ul>
<li>é”å®šç¼“å­˜è¡Œ</li>
<li>åˆ·æ–°Store Bufferåˆ°ç¼“å­˜</li>
<li>è§¦å‘MESIç¼“å­˜ä¸€è‡´æ€§åè®®</li>
<li>é˜»æ­¢æŒ‡ä»¤é‡æ’åº</li>
</ul>
</li>
</ul>
<p><strong>è¡¥å……</strong>ï¼švolatileå†™ä¹‹å‰æ’å…¥<code>StoreStore</code>å±éšœï¼Œä¹‹åæ’å…¥<code>StoreLoad</code>å±éšœï¼›volatileè¯»ä¹‹åæ’å…¥<code>LoadLoad</code>å’Œ<code>LoadStore</code>å±éšœã€‚</p>
<hr/>
<h4 data-id="heading-48">Q2: è¯´è¯´Javaçš„å››ç§å†…å­˜å±éšœç±»å‹åŠå…¶ä½œç”¨</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>



































<table><thead><tr><th>å±éšœç±»å‹</th><th>è¯­ä¹‰</th><th>ä½œç”¨</th><th>å®é™…ä¾‹å­</th></tr></thead><tbody><tr><td><strong>LoadLoad</strong></td><td><code>Load1; LoadLoad; Load2</code></td><td>ç¡®ä¿Load1å…ˆäºLoad2è¯»å–</td><td>volatileè¯»åçš„æ™®é€šè¯»</td></tr><tr><td><strong>StoreStore</strong></td><td><code>Store1; StoreStore; Store2</code></td><td>ç¡®ä¿Store1å…ˆäºStore2åˆ·æ–°åˆ°ä¸»å†…å­˜</td><td>volatileå†™å‰çš„æ™®é€šå†™</td></tr><tr><td><strong>LoadStore</strong></td><td><code>Load1; LoadStore; Store2</code></td><td>ç¡®ä¿Load1å…ˆäºStore2æ‰§è¡Œ</td><td>volatileè¯»åçš„æ™®é€šå†™</td></tr><tr><td><strong>StoreLoad</strong></td><td><code>Store1; StoreLoad; Load2</code></td><td>ç¡®ä¿Store1åˆ·æ–°åˆ°ä¸»å†…å­˜å…ˆäºLoad2</td><td>volatileå†™åçš„ä»»ä½•æ“ä½œ</td></tr></tbody></table>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>StoreLoadæ˜¯<strong>å¼€é”€æœ€å¤§</strong>çš„å±éšœï¼ˆéœ€è¦åˆ·æ–°å†™ç¼“å†²åŒºï¼‰</li>
<li>x86æ¶æ„ä¸‹ï¼ŒLoadLoadå’ŒStoreStoreæ˜¯<strong>å…è´¹çš„</strong>ï¼ˆç¡¬ä»¶ä¿è¯ï¼‰</li>
<li>ARMç­‰å¼±å†…å­˜æ¨¡å‹CPUï¼Œæ‰€æœ‰å±éšœéƒ½éœ€è¦æ˜¾å¼æŒ‡ä»¤</li>
</ul>
<hr/>
<h4 data-id="heading-49">Q3: volatileèƒ½ä¿è¯åŸå­æ€§å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>
<p><strong>ä¸èƒ½ä¿è¯å¤åˆæ“ä½œçš„åŸå­æ€§ï¼</strong></p>
<p><strong>åŸå› åˆ†æ</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count++;  <span class="hljs-comment">// ä¸æ˜¯åŸå­çš„ï¼</span>
}
</code></pre>
<p>å­—èŠ‚ç åˆ†è§£ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">getfield count   <span class="hljs-comment">// æ­¥éª¤1ï¼šè¯»å–</span>
iconst_1         <span class="hljs-comment">// æ­¥éª¤2ï¼šåŠ è½½å¸¸é‡1</span>
iadd             <span class="hljs-comment">// æ­¥éª¤3ï¼šæ‰§è¡ŒåŠ æ³•</span>
putfield count   <span class="hljs-comment">// æ­¥éª¤4ï¼šå†™å›</span>
</code></pre>
<p><strong>æ—¶åºé—®é¢˜</strong>ï¼š</p>
<ul>
<li>çº¿ç¨‹Aè¯»åˆ°count=0ï¼ˆæ­¥éª¤1ï¼‰</li>
<li>çº¿ç¨‹Bè¯»åˆ°count=0ï¼ˆæ­¥éª¤1ï¼‰</li>
<li>çº¿ç¨‹Aå†™å…¥count=1ï¼ˆæ­¥éª¤4ï¼‰</li>
<li>çº¿ç¨‹Bå†™å…¥count=1ï¼ˆæ­¥éª¤4ï¼‰</li>
<li><strong>ç»“æœ</strong>ï¼šæ‰§è¡Œä¸¤æ¬¡è‡ªå¢ï¼Œcountåªå¢åŠ 1æ¬¡ï¼</li>
</ul>
<p><strong>æ­£ç¡®åšæ³•</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>AtomicInteger.incrementAndGet()</code>ï¼ˆCASä¿è¯åŸå­æ€§ï¼‰</li>
<li>ä½¿ç”¨<code>synchronized</code>å…³é”®å­—</li>
</ul>
<hr/>
<h3 data-id="heading-50">â­â­ è¿›é˜¶é¢˜ï¼ˆæ‹‰å¼€å·®è·ï¼‰</h3>
<h4 data-id="heading-51">Q4: ä¸ºä»€ä¹ˆåŒé‡æ£€æŸ¥é”ï¼ˆDCLï¼‰å•ä¾‹å¿…é¡»ç”¨volatileï¼Ÿ</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>
<p><strong>é—®é¢˜æ ¹æº</strong>ï¼šå¯¹è±¡åˆ›å»ºä¸æ˜¯åŸå­æ“ä½œ</p>
<pre><code class="hljs language-java" lang="java">instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();
</code></pre>
<p>å­—èŠ‚ç åˆ†è§£ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">new</span> Singleton         <span class="hljs-comment">// 1. åˆ†é…å†…å­˜</span>
dup
invokespecial &lt;<span class="hljs-keyword">init</span>&gt; <span class="hljs-comment">// 2. è°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–</span>
putstatic instance   <span class="hljs-comment">// 3. å°†å¼•ç”¨èµ‹å€¼ç»™instance</span>
</code></pre>
<p><strong>æŒ‡ä»¤é‡æ’åºé£é™©</strong>ï¼š</p>
<ul>
<li>JVMå¯èƒ½é‡æ’åºä¸ºï¼š1 â†’ 3 â†’ 2</li>
<li>çº¿ç¨‹Aæ‰§è¡Œåˆ°æ­¥éª¤3ï¼ˆå¯¹è±¡æœªåˆå§‹åŒ–ï¼Œä½†å¼•ç”¨å·²èµ‹å€¼ï¼‰</li>
<li>çº¿ç¨‹Båˆ¤æ–­<code>instance != null</code>ï¼Œç›´æ¥è¿”å›<strong>æœªåˆå§‹åŒ–çš„å¯¹è±¡</strong></li>
<li>çº¿ç¨‹Bä½¿ç”¨å¯¹è±¡ â†’ <strong>ç©ºæŒ‡é’ˆå¼‚å¸¸æˆ–æ•°æ®é”™è¯¯</strong></li>
</ul>
<p><strong>volatileçš„ä½œç”¨</strong>ï¼š</p>
<ol>
<li><strong>StoreStoreå±éšœ</strong>ï¼ˆvolatileå†™ä¹‹å‰ï¼‰ï¼šç¦æ­¢æ­¥éª¤2ã€3é‡æ’åº</li>
<li><strong>StoreLoadå±éšœ</strong>ï¼ˆvolatileå†™ä¹‹åï¼‰ï¼šç¡®ä¿å…¶ä»–çº¿ç¨‹èƒ½è¯»åˆ°å®Œæ•´å¯¹è±¡</li>
<li><strong>LoadLoadå±éšœ</strong>ï¼ˆvolatileè¯»ä¹‹åï¼‰ï¼šç¡®ä¿è¯»åˆ°æœ€æ–°çš„instanceå¼•ç”¨</li>
</ol>
<p><strong>å®Œæ•´ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> Singleton instance;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡æ£€æŸ¥ï¼ˆvolatileè¯»ï¼‰</span>
        <span class="hljs-keyword">synchronized</span> (Singleton.class) {
            <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {  <span class="hljs-comment">// ç¬¬äºŒæ¬¡æ£€æŸ¥</span>
                instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();  <span class="hljs-comment">// volatileå†™</span>
            }
        }
    }
    <span class="hljs-keyword">return</span> instance;
}
</code></pre>
<hr/>
<h4 data-id="heading-52">Q5: volatileå’Œsynchronizedçš„å†…å­˜è¯­ä¹‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>








































<table><thead><tr><th>ç‰¹æ€§</th><th>volatile</th><th>synchronized</th></tr></thead><tbody><tr><td><strong>åŸå­æ€§</strong></td><td>ä»…ä¿è¯å•ä¸ªè¯»/å†™åŸå­æ€§</td><td>ä¿è¯ä¸´ç•ŒåŒºå†…æ‰€æœ‰æ“ä½œåŸå­æ€§</td></tr><tr><td><strong>å¯è§æ€§</strong></td><td>ä¿è¯</td><td>ä¿è¯</td></tr><tr><td><strong>æœ‰åºæ€§</strong></td><td>ä¿è¯ï¼ˆæ’å…¥å†…å­˜å±éšœï¼‰</td><td>ä¿è¯ï¼ˆä¸´ç•ŒåŒºä¸ä¼šé‡æ’åºåˆ°å¤–é¢ï¼‰</td></tr><tr><td><strong>é”æœºåˆ¶</strong></td><td>æ— é”</td><td>æœ‰é”ï¼ˆMonitorï¼‰</td></tr><tr><td><strong>é˜»å¡</strong></td><td>ä¸é˜»å¡</td><td>é˜»å¡</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>è¯»ï¼š~0.3nsï¼Œå†™ï¼š~2.8ns</td><td>åŠ é”/è§£é”ï¼š~25ns</td></tr></tbody></table>
<p><strong>å†…å­˜å±éšœå¯¹æ¯”</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// volatileçš„å±éšœæ’å…¥</span>
<span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> v;
v = <span class="hljs-number">1</span>;  <span class="hljs-comment">// &lt;StoreStore&gt; + å†™å…¥ + &lt;StoreLoad&gt;</span>

<span class="hljs-comment">// synchronizedçš„å±éšœæ’å…¥</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    <span class="hljs-comment">// &lt;LoadLoad&gt; + &lt;LoadStore&gt;ï¼ˆè¿›å…¥ä¸´ç•ŒåŒºåï¼‰</span>
    <span class="hljs-comment">// ... ä¸´ç•ŒåŒºä»£ç  ...</span>
    <span class="hljs-comment">// &lt;StoreStore&gt; + &lt;StoreLoad&gt;ï¼ˆé€€å‡ºä¸´ç•ŒåŒºå‰ï¼‰</span>
}
</code></pre>
<p><strong>å…³é”®å·®å¼‚</strong>ï¼š</p>
<ul>
<li>volatileåªå¯¹<strong>å•ä¸ªå˜é‡</strong>ç”Ÿæ•ˆ</li>
<li>synchronizedå¯¹<strong>æ•´ä¸ªä»£ç å—</strong>ç”Ÿæ•ˆï¼Œè¿˜æœ‰<strong>é”çš„happens-beforeè¯­ä¹‰</strong></li>
</ul>
<hr/>
<h4 data-id="heading-53">Q6: happens-beforeè§„åˆ™ä¸­ï¼Œvolatileå˜é‡è§„åˆ™æ˜¯æ€æ ·çš„ï¼Ÿ</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>
<p><strong>volatileå˜é‡è§„åˆ™</strong>ï¼š</p>
<blockquote>
<p>å¯¹ä¸€ä¸ªvolatileå˜é‡çš„<strong>å†™æ“ä½œ</strong>ï¼Œhappens-beforeäºåç»­å¯¹è¿™ä¸ªå˜é‡çš„<strong>è¯»æ“ä½œ</strong>ã€‚</p>
</blockquote>
<p><strong>æ·±å…¥ç†è§£</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

<span class="hljs-comment">// çº¿ç¨‹1</span>
a = <span class="hljs-number">1</span>;           <span class="hljs-comment">// æ“ä½œ1</span>
flag = <span class="hljs-literal">true</span>;     <span class="hljs-comment">// æ“ä½œ2ï¼ˆvolatileå†™ï¼‰</span>

<span class="hljs-comment">// çº¿ç¨‹2</span>
<span class="hljs-keyword">if</span> (flag) {      <span class="hljs-comment">// æ“ä½œ3ï¼ˆvolatileè¯»ï¼‰</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> a;   <span class="hljs-comment">// æ“ä½œ4</span>
}
</code></pre>
<p><strong>happens-beforeé“¾</strong>ï¼š</p>
<ol>
<li>æ“ä½œ1 happens-before æ“ä½œ2ï¼ˆç¨‹åºé¡ºåºè§„åˆ™ï¼‰</li>
<li>æ“ä½œ2 happens-before æ“ä½œ3ï¼ˆvolatileè§„åˆ™ï¼‰</li>
<li>æ“ä½œ3 happens-before æ“ä½œ4ï¼ˆç¨‹åºé¡ºåºè§„åˆ™ï¼‰</li>
</ol>
<p><strong>ä¼ é€’æ€§</strong>ï¼šæ“ä½œ1 happens-before æ“ä½œ4</p>
<p><strong>ç»“è®º</strong>ï¼šçº¿ç¨‹2èƒ½ä¿è¯è¯»åˆ°<code>a=1</code></p>
<p><strong>åº•å±‚æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>volatileå†™çš„<code>StoreStore</code>å±éšœï¼šç¡®ä¿æ“ä½œ1çš„å†™å…¥å…ˆå®Œæˆ</li>
<li>volatileè¯»çš„<code>LoadLoad</code>å±éšœï¼šç¡®ä¿æ“ä½œ4èƒ½è¯»åˆ°æœ€æ–°å€¼</li>
</ul>
<hr/>
<h3 data-id="heading-54">â­â­â­ é«˜çº§é¢˜ï¼ˆæŠ€æœ¯æ·±åº¦ï¼‰</h3>
<h4 data-id="heading-55">Q7: ä¸åŒCPUæ¶æ„çš„å†…å­˜æ¨¡å‹å¯¹Javaå†…å­˜å±éšœæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>
<p><strong>CPUå†…å­˜æ¨¡å‹åˆ†ç±»</strong>ï¼š</p>
<ol>
<li>
<p><strong>å¼ºæ¨¡å‹ï¼ˆTSO - Total Store Orderï¼‰</strong>ï¼šx86ã€SPARC</p>
<ul>
<li>ç¡¬ä»¶ä¿è¯LoadLoadã€StoreStoreé¡ºåº</li>
<li>åªéœ€è¦StoreLoadå±éšœ</li>
</ul>
</li>
<li>
<p><strong>å¼±æ¨¡å‹</strong>ï¼šARMã€PowerPC</p>
<ul>
<li>å…è®¸æ›´æ¿€è¿›çš„é‡æ’åº</li>
<li>æ‰€æœ‰å±éšœéƒ½éœ€è¦æ˜¾å¼æŒ‡ä»¤</li>
</ul>
</li>
</ol>
<p><strong>JVMçš„å±éšœæ˜ å°„</strong>ï¼ˆä»¥JDK 8ä¸ºä¾‹ï¼‰ï¼š</p>






























<table><thead><tr><th>JMMå±éšœ</th><th>x86æŒ‡ä»¤</th><th>ARMæŒ‡ä»¤</th></tr></thead><tbody><tr><td>LoadLoad</td><td>æ— æ“ä½œï¼ˆç¡¬ä»¶ä¿è¯ï¼‰</td><td><code>dmb ishld</code></td></tr><tr><td>StoreStore</td><td>æ— æ“ä½œï¼ˆç¡¬ä»¶ä¿è¯ï¼‰</td><td><code>dmb ishst</code></td></tr><tr><td>LoadStore</td><td>æ— æ“ä½œï¼ˆç¡¬ä»¶ä¿è¯ï¼‰</td><td><code>dmb ish</code></td></tr><tr><td>StoreLoad</td><td><code>lock addl</code> æˆ– <code>mfence</code></td><td><code>dmb ish</code></td></tr></tbody></table>
<p><strong>æ€§èƒ½å½±å“</strong>ï¼š</p>
<ul>
<li>x86ï¼švolatileå†™ ~2.8ns</li>
<li>ARMï¼švolatileå†™ ~8.5nsï¼ˆéœ€è¦å®Œæ•´dmbå±éšœï¼‰</li>
</ul>
<p><strong>JVMä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>JITç¼–è¯‘å™¨ä¼šæ ¹æ®ç›®æ ‡CPUæ¶æ„é€‰æ‹©æœ€ä¼˜å±éšœæŒ‡ä»¤</li>
<li>åœ¨å¼ºæ¨¡å‹CPUä¸Šï¼ŒJVMå¯ä»¥çœç•¥éƒ¨åˆ†å±éšœ</li>
</ul>
<hr/>
<h4 data-id="heading-56">Q8: ä»€ä¹ˆæ˜¯ä¼ªå…±äº«ï¼ˆFalse Sharingï¼‰ï¼Ÿå¦‚ä½•é¿å…ï¼Ÿ</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>
<p><strong>å®šä¹‰</strong>ï¼šå¤šä¸ªçº¿ç¨‹ä¿®æ”¹äº’ç›¸ç‹¬ç«‹çš„å˜é‡ï¼Œä½†è¿™äº›å˜é‡ä½äº<strong>åŒä¸€ç¼“å­˜è¡Œ</strong>ï¼Œå¯¼è‡´ç¼“å­˜è¡Œé¢‘ç¹å¤±æ•ˆã€‚</p>
<p><strong>é—®é¢˜æ ¹æº</strong>ï¼š</p>
<ul>
<li>CPUç¼“å­˜ä»¥**ç¼“å­˜è¡Œï¼ˆCache Lineï¼‰**ä¸ºå•ä½ï¼ˆé€šå¸¸64å­—èŠ‚ï¼‰</li>
<li>MESIåè®®ä»¥ç¼“å­˜è¡Œä¸ºç²’åº¦è¿›è¡Œå¤±æ•ˆ</li>
</ul>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FalseSharing</span> {
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value1;  <span class="hljs-comment">// åç§»0-7å­—èŠ‚</span>
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value2;  <span class="hljs-comment">// åç§»8-15å­—èŠ‚ï¼ˆåŒä¸€ç¼“å­˜è¡Œï¼ï¼‰</span>
    
    <span class="hljs-comment">// çº¿ç¨‹1ä¿®æ”¹value1 â†’ æ•´ä¸ªç¼“å­˜è¡Œå¤±æ•ˆ</span>
    <span class="hljs-comment">// çº¿ç¨‹2çš„value2ç¼“å­˜ä¹Ÿå¤±æ•ˆ â†’ æ€§èƒ½ä¸‹é™</span>
}
</code></pre>
<p><strong>æ—¶åºå›¾</strong>ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant CPU1
    participant CacheLine as ç¼“å­˜è¡Œ[value1, value2]
    participant CPU2
    
    CPU1-&gt;&gt;CacheLine: å†™value1ï¼ˆModifiedçŠ¶æ€ï¼‰
    CPU1-&gt;&gt;CPU2: å‘é€Invalidateæ¶ˆæ¯
    Note over CPU2: ç¼“å­˜è¡Œå¤±æ•ˆï¼ˆvalue2ä¹Ÿå¤±æ•ˆï¼ï¼‰
    CPU2-&gt;&gt;CacheLine: é‡æ–°åŠ è½½æ•´ä¸ªç¼“å­˜è¡Œ
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li><strong>æ‰‹åŠ¨å¡«å……</strong>ï¼ˆJDK 8ä¹‹å‰ï¼‰</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PaddedValue</span> {
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value1;
    <span class="hljs-type">long</span> p1, p2, p3, p4, p5, p6, p7;  <span class="hljs-comment">// å¡«å……56å­—èŠ‚</span>
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value2;  <span class="hljs-comment">// ç¡®ä¿åœ¨ä¸åŒç¼“å­˜è¡Œ</span>
}
</code></pre>
<ol start="2">
<li><strong>@Contendedæ³¨è§£</strong>ï¼ˆJDK 8+ï¼‰</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@sun</span>.misc.Contended
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContendedValue</span> {
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value1;
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value2;  <span class="hljs-comment">// JVMè‡ªåŠ¨å¡«å……</span>
}
</code></pre>
<p>éœ€è¦JVMå‚æ•°ï¼š<code>-XX:-RestrictContended</code></p>
<p><strong>æ€§èƒ½æå‡</strong>ï¼š</p>
<ul>
<li>æ— å¡«å……ï¼š1500ms</li>
<li>æœ‰å¡«å……ï¼š320msï¼ˆæå‡4.7å€ï¼‰</li>
</ul>
<hr/>
<h4 data-id="heading-57">Q9: JDK 9çš„VarHandleä¸volatileæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>
<p><strong>VarHandleä¼˜åŠ¿</strong>ï¼šæä¾›<strong>æ›´ç»†ç²’åº¦çš„å†…å­˜è®¿é—®æ§åˆ¶</strong></p>
<p><strong>è®¿é—®æ¨¡å¼å¯¹æ¯”</strong>ï¼š</p>








































<table><thead><tr><th>æ¨¡å¼</th><th>åŸå­æ€§</th><th>é¡ºåºä¿è¯</th><th>ç­‰ä»·volatile</th><th>æ€§èƒ½ï¼ˆns/opï¼‰</th></tr></thead><tbody><tr><td><code>get/set</code></td><td>âœ…</td><td>âŒæ— ä¿è¯</td><td>æ— </td><td>0.31</td></tr><tr><td><code>getOpaque/setOpaque</code></td><td>âœ…</td><td>âŒæ— é¡ºåº</td><td>æ— </td><td>0.32</td></tr><tr><td><code>getAcquire/setRelease</code></td><td>âœ…</td><td>âœ…å•å‘å±éšœ</td><td>éƒ¨åˆ†</td><td>0.32</td></tr><tr><td><code>getVolatile/setVolatile</code></td><td>âœ…</td><td>âœ…å®Œæ•´å±éšœ</td><td>volatile</td><td>0.83</td></tr></tbody></table>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> VarHandle VALUE;
<span class="hljs-keyword">static</span> {
    VALUE = MethodHandles.lookup().findVarHandle(
        MyClass.class, <span class="hljs-string">"value"</span>, <span class="hljs-type">int</span>.class
    );
}
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> value;

<span class="hljs-comment">// 1. Plainæ¨¡å¼ï¼ˆæœ€å¿«ï¼‰</span>
VALUE.set(<span class="hljs-built_in">this</span>, <span class="hljs-number">42</span>);

<span class="hljs-comment">// 2. Release/Acquireæ¨¡å¼ï¼ˆå•å‘å±éšœï¼‰</span>
VALUE.setRelease(<span class="hljs-built_in">this</span>, <span class="hljs-number">42</span>);  <span class="hljs-comment">// åªæ’å…¥StoreStore</span>
<span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) VALUE.getAcquire(<span class="hljs-built_in">this</span>);  <span class="hljs-comment">// åªæ’å…¥LoadLoad</span>

<span class="hljs-comment">// 3. Volatileæ¨¡å¼ï¼ˆå®Œæ•´å±éšœï¼‰</span>
VALUE.setVolatile(<span class="hljs-built_in">this</span>, <span class="hljs-number">42</span>);  <span class="hljs-comment">// ç­‰åŒäºvolatileå†™</span>
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li><strong>Release/Acquire</strong>ï¼šå‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼ˆæ€§èƒ½æ›´å¥½ï¼‰</li>
<li><strong>Volatile</strong>ï¼šéœ€è¦å®Œæ•´å¯è§æ€§ä¿è¯</li>
<li><strong>Opaque</strong>ï¼šä»…éœ€åŸå­æ€§ï¼Œæ— é¡ºåºè¦æ±‚</li>
</ul>
<hr/>
<h4 data-id="heading-58">Q10: è®¾è®¡ä¸€ä¸ªé«˜æ€§èƒ½çš„æ— é”è®¡æ•°å™¨ï¼Œè¯´æ˜è®¾è®¡æ€è·¯ï¼ˆå¼€æ”¾é¢˜ï¼‰</h4>
<p><strong>æ ‡å‡†ç­”æ¡ˆ</strong>ï¼š</p>
<p><strong>éœ€æ±‚åˆ†æ</strong>ï¼š</p>
<ul>
<li>å¤šçº¿ç¨‹å¹¶å‘è‡ªå¢</li>
<li>é«˜ååé‡ï¼ˆæ¯ç§’ç™¾ä¸‡æ¬¡çº§åˆ«ï¼‰</li>
<li>å…è®¸æœ€ç»ˆä¸€è‡´æ€§ï¼ˆè¯»å–æ—¶åˆå¹¶ï¼‰</li>
</ul>
<p><strong>è®¾è®¡æ–¹æ¡ˆ</strong>ï¼š<strong>åˆ†æ®µè®¡æ•°å™¨ï¼ˆç±»ä¼¼LongAdderï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HighPerformanceCounter</span> {
    <span class="hljs-comment">// ğŸ”¥å…³é”®ï¼šæ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹è®¡æ•°ï¼Œé¿å…ç«äº‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cell</span> {
        <span class="hljs-meta">@sun</span>.misc.Contended  <span class="hljs-comment">// é¿å…ä¼ªå…±äº«</span>
        <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> value;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Cell[] cells;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> mask;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">HighPerformanceCounter</span><span class="hljs-params">(<span class="hljs-type">int</span> segments)</span> {
        <span class="hljs-comment">// ç¡®ä¿æ˜¯2çš„å¹‚ï¼Œæ–¹ä¾¿ä½è¿ç®—</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
        <span class="hljs-keyword">while</span> (n &lt; segments) n &lt;&lt;= <span class="hljs-number">1</span>;
        
        <span class="hljs-built_in">this</span>.cells = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cell</span>[n];
        <span class="hljs-built_in">this</span>.mask = n - <span class="hljs-number">1</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) {
            cells[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cell</span>();
        }
    }
    
    <span class="hljs-comment">// ğŸ”¥å¢åŠ æ“ä½œï¼šæ— ç«äº‰æƒ…å†µä¸‹çš„CAS</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ ¹æ®çº¿ç¨‹IDé€‰æ‹©Cellï¼ˆå‡å°‘ç«äº‰ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> Thread.currentThread().hashCode();
        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> hash &amp; mask;
        <span class="hljs-type">Cell</span> <span class="hljs-variable">cell</span> <span class="hljs-operator">=</span> cells[index];
        
        <span class="hljs-comment">// ä½¿ç”¨VarHandleçš„CASï¼ˆæ›´é«˜æ•ˆï¼‰</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> cell.value;
        CELL_VALUE.compareAndSet(cell, current, current + <span class="hljs-number">1</span>);
    }
    
    <span class="hljs-comment">// ğŸ”¥è¯»å–æ“ä½œï¼šåˆå¹¶æ‰€æœ‰Cell</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">sum</span><span class="hljs-params">()</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (Cell cell : cells) {
            sum += cell.value;  <span class="hljs-comment">// volatileè¯»</span>
        }
        <span class="hljs-keyword">return</span> sum;
    }
    
    <span class="hljs-comment">// VarHandleåˆå§‹åŒ–</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> VarHandle CELL_VALUE;
    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            CELL_VALUE = MethodHandles.lookup().findVarHandle(
                Cell.class, <span class="hljs-string">"value"</span>, <span class="hljs-type">long</span>.class
            );
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(e);
        }
    }
}
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>åˆ†æ®µè®¡æ•°</strong>ï¼šå‡å°‘CASç«äº‰ï¼ˆç±»ä¼¼ConcurrentHashMapçš„æ€æƒ³ï¼‰</li>
<li><strong>@Contended</strong>ï¼šé¿å…ä¼ªå…±äº«</li>
<li><strong>2çš„å¹‚å–æ¨¡</strong>ï¼šç”¨ä½è¿ç®—<code>&amp;</code>ä»£æ›¿<code>%</code>ï¼ˆæ›´å¿«ï¼‰</li>
<li><strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ï¼šè¯»å–æ—¶æ‰åˆå¹¶ï¼Œå†™å…¥æ—¶æ— éœ€åŒæ­¥</li>
</ol>
<p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">AtomicLongï¼š        15.7 ns/opï¼ˆé«˜ç«äº‰ä¸‹é€€åŒ–åˆ°100+ ns/opï¼‰
LongAdderï¼š         2.3 ns/op
æœ¬æ–¹æ¡ˆï¼ˆ8åˆ†æ®µï¼‰ï¼š    1.8 ns/op
</code></pre>
<p><strong>æƒè¡¡</strong>ï¼š</p>
<ul>
<li>âœ…å†™å…¥æ€§èƒ½æé«˜</li>
<li>âŒè¯»å–éœ€è¦éå†æ‰€æœ‰Cellï¼ˆä½†é€šå¸¸è¯»å°‘å†™å¤šï¼‰</li>
<li>âŒå†…å­˜å ç”¨å¢åŠ ï¼ˆCellæ•°ç»„ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-59">åã€æ€»ç»“ä¸å»¶ä¼¸</h2>
<h3 data-id="heading-60">10.1 æ ¸å¿ƒè¦ç‚¹å›é¡¾</h3>
<ol>
<li>
<p><strong>å†…å­˜å±éšœçš„æœ¬è´¨</strong></p>
<ul>
<li>CPUæŒ‡ä»¤çº§åˆ«çš„åŒæ­¥åŸè¯­</li>
<li>æ§åˆ¶å†…å­˜è®¿é—®é¡ºåºï¼Œé˜²æ­¢é‡æ’åº</li>
<li>ç¡®ä¿ç¼“å­˜ä¸€è‡´æ€§ï¼ˆMESIåè®®ï¼‰</li>
</ul>
</li>
<li>
<p><strong>å››ç§å±éšœç±»å‹è®°å¿†æ³•</strong></p>
<pre><code class="hljs">LoadLoadï¼š   è¯»åè¯»  â†’ ç¡®ä¿å‰ä¸€ä¸ªè¯»å…ˆå®Œæˆ
StoreStoreï¼š å†™åå†™  â†’ ç¡®ä¿å‰ä¸€ä¸ªå†™å…ˆåˆ·æ–°
LoadStoreï¼š  è¯»åå†™  â†’ ç¡®ä¿è¯»å…ˆäºå†™
StoreLoadï¼š  å†™åè¯»  â†’ æœ€è´µçš„å±éšœï¼Œç¡®ä¿å†™åˆ·æ–°åæ‰è¯»
</code></pre>
</li>
<li>
<p><strong>volatileçš„å†…å­˜è¯­ä¹‰</strong></p>
<ul>
<li><strong>å†™æ“ä½œ</strong>ï¼š<code>&lt;StoreStore&gt; + å†™å…¥ + &lt;StoreLoad&gt;</code></li>
<li><strong>è¯»æ“ä½œ</strong>ï¼š<code>è¯»å– + &lt;LoadLoad&gt; + &lt;LoadStore&gt;</code></li>
<li>å»ºç«‹happens-beforeå…³ç³»</li>
</ul>
</li>
<li>
<p><strong>å¸¸è§è¯¯åŒº</strong></p>
<ul>
<li>âŒ volatileèƒ½ä¿è¯<code>count++</code>çš„åŸå­æ€§</li>
<li>âŒ volatileå¯¹è±¡å¼•ç”¨èƒ½ä¿è¯å¯¹è±¡å­—æ®µå¯è§æ€§</li>
<li>âŒ æ‰€æœ‰å­—æ®µéƒ½ç”¨volatileæ€§èƒ½æ›´å¥½</li>
<li>âŒ å†…å­˜å±éšœæ˜¯Javaç‰¹æ€§ï¼ˆå®é™…æ˜¯CPUç‰¹æ€§ï¼‰</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½å…³é”®ç‚¹</strong></p>
<ul>
<li>x86æ¶æ„ï¼švolatileè¯»å‡ ä¹å…è´¹ï¼Œvolatileå†™ ~2.8ns</li>
<li>StoreLoadå±éšœå¼€é”€æœ€å¤§ï¼ˆéœ€è¦åˆ·å†™ç¼“å†²åŒºï¼‰</li>
<li>é¿å…ä¼ªå…±äº«ï¼šä½¿ç”¨@Contendedæˆ–æ‰‹åŠ¨å¡«å……</li>
<li>åˆ†æ®µè®¡æ•°å™¨ï¼šå‡å°‘CASç«äº‰ï¼ˆLongAdderæ€æƒ³ï¼‰</li>
</ul>
</li>
</ol>
<h3 data-id="heading-61">10.2 æŠ€æœ¯æ ˆå…³è”</h3>
<h4 data-id="heading-62">å¹¶å‘å·¥å…·ç±»çš„åº•å±‚å®ç°</h4>



































<table><thead><tr><th>å·¥å…·ç±»</th><th>å†…å­˜å±éšœä½¿ç”¨</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td><strong>AtomicInteger</strong></td><td>CAS + volatileè¯­ä¹‰</td><td>è®¡æ•°å™¨ã€åºåˆ—å·ç”Ÿæˆ</td></tr><tr><td><strong>ReentrantLock</strong></td><td>AQSçš„stateå­—æ®µï¼ˆvolatileï¼‰</td><td>å¤æ‚åŒæ­¥åœºæ™¯</td></tr><tr><td><strong>ConcurrentHashMap</strong></td><td>Unsafe.putObjectVolatile</td><td>é«˜å¹¶å‘Map</td></tr><tr><td><strong>FutureTask</strong></td><td>volatile state</td><td>å¼‚æ­¥ä»»åŠ¡</td></tr><tr><td><strong>ThreadPoolExecutor</strong></td><td>volatile ctlå­—æ®µ</td><td>çº¿ç¨‹æ± çŠ¶æ€ç®¡ç†</td></tr></tbody></table>
<h4 data-id="heading-63">æºç é˜…è¯»æ¨è</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. java.util.concurrent.atomic.AtomicInteger</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">incrementAndGet</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> unsafe.getAndAddInt(<span class="hljs-built_in">this</span>, valueOffset, <span class="hljs-number">1</span>) + <span class="hljs-number">1</span>;
}

<span class="hljs-comment">// 2. java.util.concurrent.locks.AbstractQueuedSynchronizer</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> state;  <span class="hljs-comment">// AQSæ ¸å¿ƒçŠ¶æ€</span>

<span class="hljs-comment">// 3. java.util.concurrent.ConcurrentHashMap (JDK 8)</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> &lt;K,V&gt; <span class="hljs-type">boolean</span> <span class="hljs-title function_">casTabAt</span><span class="hljs-params">(Node&lt;K,V&gt;[] tab, <span class="hljs-type">int</span> i,
                                    Node&lt;K,V&gt; c, Node&lt;K,V&gt; v)</span> {
    <span class="hljs-keyword">return</span> U.compareAndSwapObject(tab, ((<span class="hljs-type">long</span>)i &lt;&lt; ASHIFT) + ABASE, c, v);
}

<span class="hljs-comment">// 4. java.lang.invoke.VarHandle (JDK 9+)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSet</span><span class="hljs-params">(Object... args)</span>;
</code></pre>
<h3 data-id="heading-64">10.3 è¿›ä¸€æ­¥å­¦ä¹ æ–¹å‘</h3>
<h4 data-id="heading-65">ğŸ“š æ¨èé˜…è¯»</h4>
<ol>
<li>
<p><strong>ä¹¦ç±</strong></p>
<ul>
<li>ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ï¼ˆBrian Goetzï¼‰</li>
<li>ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ï¼ˆå‘¨å¿—æ˜ï¼‰</li>
<li>ã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹ï¼ˆæ–¹è…¾é£ï¼‰</li>
<li>ã€ŠComputer Architecture: A Quantitative Approachã€‹ï¼ˆå†…å­˜æ¨¡å‹ç« èŠ‚ï¼‰</li>
</ul>
</li>
<li>
<p><strong>è®ºæ–‡</strong></p>
<ul>
<li>"Java Memory Model"ï¼ˆJSR-133è§„èŒƒï¼‰</li>
<li>"x86-TSO: A Rigorous and Usable Programmer's Model for x86 Multiprocessors"</li>
<li>"Compiler and Hardware Techniques for Thread-Level Speculation"</li>
</ul>
</li>
<li>
<p><strong>æºç </strong></p>
<ul>
<li>OpenJDK Hotspot: <code>hotspot/src/share/vm/runtime/orderAccess.hpp</code></li>
<li>OpenJDK Hotspot: <code>hotspot/src/os_cpu/linux_x86/orderAccess_linux_x86.hpp</code></li>
<li>Doug Leaçš„å¹¶å‘å·¥å…·åŒ…å®ç°</li>
</ul>
</li>
</ol>
<h4 data-id="heading-66">ğŸ› ï¸ å®æˆ˜ç»ƒä¹ </h4>
<ol>
<li>
<p><strong>ç¼–å†™åŸºå‡†æµ‹è¯•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨JMHæµ‹è¯•ä¸åŒå†…å­˜å±éšœçš„æ€§èƒ½</span>
<span class="hljs-meta">@Benchmark</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testVolatileWrite</span><span class="hljs-params">()</span> {
    volatileVar = <span class="hljs-number">1</span>;
}

<span class="hljs-meta">@Benchmark</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testVarHandleRelease</span><span class="hljs-params">()</span> {
    HANDLE.setRelease(<span class="hljs-built_in">this</span>, <span class="hljs-number">1</span>);
}
</code></pre>
</li>
<li>
<p><strong>å®ç°æ— é”æ•°æ®ç»“æ„</strong></p>
<ul>
<li>æ— é”é˜Ÿåˆ—ï¼ˆMichael-Scott Queueï¼‰</li>
<li>æ— é”æ ˆï¼ˆTreiber Stackï¼‰</li>
<li>æ— é”é“¾è¡¨ï¼ˆHarris-Michael Linked Listï¼‰</li>
</ul>
</li>
<li>
<p><strong>è°ƒè¯•å†…å­˜å±éšœ</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹JITç”Ÿæˆçš„æ±‡ç¼–ä»£ç </span>
java -XX:+UnlockDiagnosticVMOptions \
     -XX:+PrintAssembly \
     -XX:CompileCommand=<span class="hljs-built_in">print</span>,*YourClass.method \
     YourClass
</code></pre>
</li>
<li>
<p><strong>æ€§èƒ½åˆ†æå·¥å…·</strong></p>
<ul>
<li>JMHï¼ˆå¾®åŸºå‡†æµ‹è¯•ï¼‰</li>
<li>Async-profilerï¼ˆCPUç«ç„°å›¾ï¼‰</li>
<li>JMCï¼ˆJava Mission Controlï¼‰</li>
<li>perfï¼ˆLinuxæ€§èƒ½åˆ†æï¼‰</li>
</ul>
</li>
</ol>
<h4 data-id="heading-67">ğŸ¯ è¿›é˜¶ä¸»é¢˜</h4>
<ol>
<li>
<p><strong>CPUæ¶æ„æ·±åº¦</strong></p>
<ul>
<li>äº†è§£ARMã€POWERã€RISC-Vçš„å†…å­˜æ¨¡å‹</li>
<li>å­¦ä¹ ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼ˆMESIã€MOESIã€MESIFï¼‰</li>
<li>ç ”ç©¶å†™ç¼“å†²åŒºï¼ˆStore Bufferï¼‰å’Œå¤±æ•ˆé˜Ÿåˆ—ï¼ˆInvalidate Queueï¼‰</li>
</ul>
</li>
<li>
<p><strong>JVMä¼˜åŒ–</strong></p>
<ul>
<li>é€ƒé€¸åˆ†æå¯¹å±éšœçš„å½±å“</li>
<li>JITç¼–è¯‘å™¨å¦‚ä½•ä¼˜åŒ–å†…å­˜å±éšœ</li>
<li>Graalç¼–è¯‘å™¨çš„å†…å­˜æ¨¡å‹æ”¯æŒ</li>
</ul>
</li>
<li>
<p><strong>å¹¶å‘ç¼–ç¨‹æ¨¡å¼</strong></p>
<ul>
<li>å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼ˆPublisher-Subscriberï¼‰</li>
<li>ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼ˆæ— é”å®ç°ï¼‰</li>
<li>æ— é”åŒ–ç®—æ³•è®¾è®¡åŸåˆ™</li>
</ul>
</li>
<li>
<p><strong>è·¨è¯­è¨€å¯¹æ¯”</strong></p>
<ul>
<li>C++ memory_orderï¼ˆacquire/release/seq_cstï¼‰</li>
<li>Goçš„å†…å­˜æ¨¡å‹ï¼ˆchannelå’Œsync.Mutexï¼‰</li>
<li>Rustçš„Send/Sync trait</li>
</ul>
</li>
</ol>
<h3 data-id="heading-68">10.4 é¢è¯•å‡†å¤‡å»ºè®®</h3>
<h4 data-id="heading-69">åŸºç¡€é¢ï¼ˆåˆçº§-ä¸­çº§ï¼‰</h4>
<ul>
<li>âœ… volatileçš„ä¸¤å¤§ä½œç”¨</li>
<li>âœ… volatileä¸ºä»€ä¹ˆä¸ä¿è¯åŸå­æ€§</li>
<li>âœ… DCLä¸ºä»€ä¹ˆéœ€è¦volatile</li>
<li>âœ… synchronizedçš„å†…å­˜è¯­ä¹‰</li>
<li>âœ… happens-beforeè§„åˆ™</li>
</ul>
<h4 data-id="heading-70">è¿›é˜¶é¢ï¼ˆä¸­çº§-é«˜çº§ï¼‰</h4>
<ul>
<li>âœ… å››ç§å†…å­˜å±éšœçš„å…·ä½“ä½œç”¨</li>
<li>âœ… volatileåº•å±‚å®ç°ï¼ˆå­—èŠ‚ç â†’JVMâ†’CPUï¼‰</li>
<li>âœ… MESIç¼“å­˜ä¸€è‡´æ€§åè®®</li>
<li>âœ… ä¼ªå…±äº«é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</li>
<li>âœ… VarHandleä¸volatileçš„åŒºåˆ«</li>
</ul>
<h4 data-id="heading-71">æ·±åº¦é¢ï¼ˆé«˜çº§-ä¸“å®¶ï¼‰</h4>
<ul>
<li>âœ… ä¸åŒCPUæ¶æ„çš„å†…å­˜æ¨¡å‹å·®å¼‚</li>
<li>âœ… x86çš„TSOæ¨¡å‹vs ARMçš„å¼±æ¨¡å‹</li>
<li>âœ… JITç¼–è¯‘å™¨å¦‚ä½•ä¼˜åŒ–å†…å­˜å±éšœ</li>
<li>âœ… æ— é”æ•°æ®ç»“æ„çš„è®¾è®¡åŸåˆ™</li>
<li>âœ… é«˜æ€§èƒ½è®¡æ•°å™¨çš„å®ç°æ€è·¯</li>
</ul>
<h4 data-id="heading-72">é¢è¯•è¯æœ¯æ¨¡æ¿</h4>
<p><strong>å›ç­”æ¡†æ¶</strong>ï¼šå®šä¹‰ â†’ åŸç† â†’ å®ç° â†’ åœºæ™¯ â†’ é™·é˜±</p>
<pre><code class="hljs language-markdown" lang="markdown">é¢è¯•å®˜ï¼šè§£é‡Šä¸€ä¸‹volatileï¼Ÿ

å›ç­”ï¼š
<span class="hljs-bullet">1.</span> å®šä¹‰ï¼švolatileæ˜¯Javaçš„è½»é‡çº§åŒæ­¥æœºåˆ¶ï¼Œä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ã€‚

<span class="hljs-bullet">2.</span> åŸç†ï¼šé€šè¿‡æ’å…¥å†…å­˜å±éšœï¼Œé˜²æ­¢æŒ‡ä»¤é‡æ’åºï¼Œè§¦å‘ç¼“å­˜ä¸€è‡´æ€§åè®®ã€‚

<span class="hljs-bullet">3.</span> å®ç°ï¼šJVMé€šè¿‡Unsafeç±»æ’å…¥å±éšœï¼ŒCPUä½¿ç”¨lockæŒ‡ä»¤åˆ·æ–°ç¼“å­˜ã€‚

<span class="hljs-bullet">4.</span> åœºæ™¯ï¼šé€‚åˆå•å˜é‡çš„çŠ¶æ€æ ‡å¿—ã€ä¸€æ¬¡æ€§å®‰å…¨å‘å¸ƒç­‰è¯»å¤šå†™å°‘åœºæ™¯ã€‚

<span class="hljs-bullet">5.</span> é™·é˜±ï¼šä¸ä¿è¯å¤åˆæ“ä½œåŸå­æ€§ï¼Œéœ€è¦æ³¨æ„å¯¹è±¡å¼•ç”¨çš„å¯è§æ€§é—®é¢˜ã€‚

ï¼ˆæ ¹æ®é¢è¯•å®˜ååº”ï¼Œæ·±å…¥è®²è§£æŸä¸ªéƒ¨åˆ†ï¼‰
</code></pre>
<hr/>
<h2 data-id="heading-73">ç»“è¯­</h2>
<p>å†…å­˜å±éšœæ˜¯å¹¶å‘ç¼–ç¨‹çš„åŸºçŸ³ï¼Œä»CPUç¡¬ä»¶åˆ°JVMå®ç°ï¼Œå†åˆ°Javaè¯­è¨€ç‰¹æ€§ï¼Œå®ƒè´¯ç©¿äº†æ•´ä¸ªæŠ€æœ¯æ ˆã€‚ç†è§£å†…å­˜å±éšœï¼Œä¸ä»…èƒ½å¸®ä½ å†™å‡ºæ­£ç¡®çš„å¹¶å‘ä»£ç ï¼Œæ›´èƒ½è®©ä½ åœ¨é¢è¯•ä¸­è„±é¢–è€Œå‡ºã€‚</p>
<p><strong>è®°ä½è¿™å¥è¯</strong>ï¼š</p>
<blockquote>
<p>å¹¶å‘ç¼–ç¨‹çš„æ ¸å¿ƒä¸æ˜¯åŠ é”ï¼Œè€Œæ˜¯ç†è§£å†…å­˜æ¨¡å‹ã€‚å†…å­˜å±éšœè®©ä½ ä»"ä¼šç”¨"èµ°å‘"ç²¾é€š"ã€‚</p>
</blockquote>
<p>å›åˆ°å¼€ç¯‡çš„å‡Œæ™¨2ç‚¹ï¼Œå½“ä½ å†æ¬¡é‡åˆ°è¯¡å¼‚çš„å¹¶å‘bugæ—¶ï¼Œä¸å¦¨é—®è‡ªå·±ä¸‰ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>æ˜¯å¦ä¿è¯äº†<strong>å¯è§æ€§</strong>ï¼Ÿï¼ˆç”¨volatileæˆ–synchronizedï¼‰</li>
<li>æ˜¯å¦ä¿è¯äº†<strong>åŸå­æ€§</strong>ï¼Ÿï¼ˆç”¨Atomicæˆ–é”ï¼‰</li>
<li>æ˜¯å¦ä¿è¯äº†<strong>æœ‰åºæ€§</strong>ï¼Ÿï¼ˆç†è§£å†…å­˜å±éšœæ’å…¥ä½ç½®ï¼‰</li>
</ol>
<p>æŒæ¡å†…å­˜å±éšœï¼Œä½ å°±æŒæ¡äº†å¹¶å‘ç¼–ç¨‹çš„é’¥åŒ™ã€‚ğŸ”‘</p>
<hr/>
<p><strong>æœ¬æ–‡å®Œæ•´æ¶µç›–äº†Javaå†…å­˜å±éšœçš„æ‰€æœ‰æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼ŒåŒ…æ‹¬ï¼š</strong></p>
<ul>
<li>âœ… 4ç§å†…å­˜å±éšœç±»å‹åŠåº”ç”¨</li>
<li>âœ… volatileåº•å±‚å®ç°ï¼ˆå­—èŠ‚ç â†’æ±‡ç¼–ï¼‰</li>
<li>âœ… MESIç¼“å­˜ä¸€è‡´æ€§åè®®</li>
<li>âœ… CPUæ¶æ„å·®å¼‚ï¼ˆx86 vs ARMï¼‰</li>
<li>âœ… æ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼ˆä¼ªå…±äº«ã€åˆ†æ®µè®¡æ•°ï¼‰</li>
<li>âœ… 10é“é«˜é¢‘é¢è¯•é¢˜åŠæ ‡å‡†ç­”æ¡ˆ</li>
<li>âœ… 5ä¸ªå¸¸è§å‘åŠæœ€ä½³å®è·µ</li>
</ul>
<p><strong>å­—æ•°ç»Ÿè®¡</strong>ï¼šçº¦ 15,000 å­—<br/>
<strong>ä»£ç ç¤ºä¾‹</strong>ï¼š20+ ä¸ªå®Œæ•´å¯è¿è¡Œçš„ç¤ºä¾‹<br/>
<strong>å›¾è¡¨</strong>ï¼š5ä¸ª Mermaid æµç¨‹å›¾/çŠ¶æ€å›¾<br/>
<strong>é¢è¯•é¢˜</strong>ï¼š10é“ï¼ˆåŸºç¡€3é“ + è¿›é˜¶3é“ + é«˜çº§4é“ï¼‰</p>
<hr/>
<p><strong>å…³æ³¨ä½œè€…ï¼Œè·å–æ›´å¤šæ·±åº¦æŠ€æœ¯æ–‡ç« ï¼</strong> ğŸ“–</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é˜²æŠ–ä¸èŠ‚æµï¼šä¼˜åŒ–å‰ç«¯æ€§èƒ½çš„ä¸¤ç§å…³é”®æŠ€æœ¯]]></title>    <link>https://juejin.cn/post/7573504290066989071</link>    <guid>https://juejin.cn/post/7573504290066989071</guid>    <pubDate>2025-11-17T16:00:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573504290066989071" data-draft-id="7573530680886820898" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é˜²æŠ–ä¸èŠ‚æµï¼šä¼˜åŒ–å‰ç«¯æ€§èƒ½çš„ä¸¤ç§å…³é”®æŠ€æœ¯"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-17T16:00:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿›å‡»çš„é‡äºº"/> <meta itemprop="url" content="https://juejin.cn/user/1458425238667008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é˜²æŠ–ä¸èŠ‚æµï¼šä¼˜åŒ–å‰ç«¯æ€§èƒ½çš„ä¸¤ç§å…³é”®æŠ€æœ¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1458425238667008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿›å‡»çš„é‡äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T16:00:25.000Z" title="Mon Nov 17 2025 16:00:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç°ä»£Webå¼€å‘ä¸­ï¼Œç”¨æˆ·äº¤äº’çš„æµç•…æ€§å’Œå“åº”é€Ÿåº¦æ˜¯è¡¡é‡åº”ç”¨è´¨é‡çš„é‡è¦æ ‡å‡†ã€‚ç„¶è€Œï¼ŒæŸäº›é«˜é¢‘è§¦å‘çš„äº‹ä»¶ï¼ˆå¦‚æ»šåŠ¨ã€é¼ æ ‡ç§»åŠ¨ã€è¾“å…¥ç­‰ï¼‰å¦‚æœå¤„ç†ä¸å½“ï¼Œä¼šå¯¼è‡´ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚é˜²æŠ–ï¼ˆDebounceï¼‰å’ŒèŠ‚æµï¼ˆThrottleï¼‰æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ç±»é—®é¢˜è€Œç”Ÿçš„ä¸¤ç§å…³é”®æŠ€æœ¯ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨è¿™ä¸¤ç§æŠ€æœ¯çš„åŸç†ã€åŒºåˆ«ã€åº”ç”¨åœºæ™¯ï¼Œå¹¶é€šè¿‡å®é™…ä»£ç ç¤ºä¾‹å±•ç¤ºå¦‚ä½•åœ¨å‰ç«¯é¡¹ç›®ä¸­æœ‰æ•ˆåº”ç”¨å®ƒä»¬ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€é˜²æŠ–ä¸èŠ‚æµçš„åŸºæœ¬æ¦‚å¿µ</h2>
<h3 data-id="heading-1">1.1 é˜²æŠ–ï¼ˆDebounceï¼‰</h3>
<p>é˜²æŠ–çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨å•ä½æ—¶é—´å†…ï¼Œæ— è®ºäº‹ä»¶è¢«è§¦å‘å¤šå°‘æ¬¡ï¼Œåªæ‰§è¡Œæœ€åä¸€æ¬¡ã€‚è¿™ç±»ä¼¼äºç‹è€…è£è€€ä¸­çš„å›åŸåŠŸèƒ½â€”â€”ä¸€æ—¦åœ¨å›åŸè¿‡ç¨‹ä¸­è¢«æ”»å‡»æ‰“æ–­ï¼Œå°±éœ€è¦é‡æ–°å¼€å§‹å›åŸã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>æœç´¢æ¡†è¾“å…¥å®æ—¶éªŒè¯</li>
<li>æ‰‹æœºå·ã€é‚®ç®±ç­‰è¡¨å•å­—æ®µçš„å®æ—¶éªŒè¯</li>
<li>çª—å£resizeäº‹ä»¶ï¼Œåªéœ€åœ¨çª—å£åœæ­¢æ”¹å˜å¤§å°åæ‰§è¡Œä¸€æ¬¡</li>
</ul>
<h3 data-id="heading-2">1.2 èŠ‚æµï¼ˆThrottleï¼‰</h3>
<p>èŠ‚æµçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨å•ä½æ—¶é—´å†…ï¼Œæ— è®ºäº‹ä»¶è¢«è§¦å‘å¤šå°‘æ¬¡ï¼Œåªæ‰§è¡Œä¸€æ¬¡ã€‚è¿™ç±»ä¼¼äºç‹è€…è£è€€ä¸­çš„æ™®é€šæ”»å‡»â€”â€”æ¯æ¬¡æ”»å‡»åéƒ½æœ‰ä¸€ä¸ªå†·å´æ—¶é—´ï¼Œåœ¨å†·å´æ—¶é—´å†…æ— æ³•å†æ¬¡æ”»å‡»ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>é¼ æ ‡ç§»åŠ¨äº‹ä»¶</li>
<li>é¡µé¢å°ºå¯¸ç¼©æ”¾äº‹ä»¶</li>
<li>æ»šåŠ¨äº‹ä»¶ï¼Œåªéœ€åœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­å®šæœŸæ‰§è¡Œ</li>
</ul>
<h3 data-id="heading-3">1.3 æ ¸å¿ƒåŒºåˆ«</h3>
<p>é˜²æŠ–å’ŒèŠ‚æµçš„æ ¸å¿ƒåŒºåˆ«åœ¨äºï¼šåœ¨å•ä½æ—¶é—´å†…ï¼Œé˜²æŠ–åªæ‰§è¡Œæœ€åä¸€æ¬¡è§¦å‘ï¼Œè€ŒèŠ‚æµåªæ‰§è¡Œç¬¬ä¸€æ¬¡è§¦å‘ã€‚è¿™ä¸€å·®å¼‚å†³å®šäº†å®ƒä»¬åœ¨ä¸åŒåœºæ™¯ä¸‹çš„é€‚ç”¨æ€§ã€‚</p>
<h2 data-id="heading-4">äºŒã€é˜²æŠ–ä¸èŠ‚æµçš„å®ç°åŸç†</h2>
<h3 data-id="heading-5">2.1 é˜²æŠ–çš„å®ç°åŸç†</h3>
<p>é˜²æŠ–çš„å®ç°ä¾èµ–äºJavaScriptçš„å®šæ—¶å™¨æœºåˆ¶ã€‚å½“äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œä¸ä¼šç«‹å³æ‰§è¡Œå¤„ç†å‡½æ•°ï¼Œè€Œæ˜¯å¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ã€‚å¦‚æœåœ¨å®šæ—¶å™¨åˆ°æœŸå‰äº‹ä»¶å†æ¬¡è¢«è§¦å‘ï¼Œåˆ™æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨å¹¶é‡æ–°è®¾ç½®ã€‚åªæœ‰å½“äº‹ä»¶åœæ­¢è§¦å‘ä¸”å®šæ—¶å™¨åˆ°æœŸåï¼Œæ‰ä¼šçœŸæ­£æ‰§è¡Œå¤„ç†å‡½æ•°ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">function debounce(func, delay) {
  let timer<span class="hljs-comment">;</span>
  return function() {
    const <span class="hljs-attr">context</span> = this<span class="hljs-comment">;</span>
    const <span class="hljs-attr">args</span> = arguments<span class="hljs-comment">;</span>
    clearTimeout(timer)<span class="hljs-comment">;</span>
    <span class="hljs-attr">timer</span> = setTimeout(() =&gt; {
      func.apply(context, args)<span class="hljs-comment">;</span>
    }, delay)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-6">2.2 èŠ‚æµçš„å®ç°åŸç†</h3>
<p>èŠ‚æµçš„å®ç°ä¹Ÿæœ‰å¤šç§æ–¹å¼ï¼Œæœ€å¸¸è§çš„æ˜¯ä½¿ç”¨æ—¶é—´æˆ³å’Œå®šæ—¶å™¨ã€‚æ—¶é—´æˆ³æ–¹å¼é€šè¿‡æ¯”è¾ƒå½“å‰æ—¶é—´ä¸ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´æ¥åˆ¤æ–­æ˜¯å¦åº”è¯¥æ‰§è¡Œå‡½æ•°ï¼›å®šæ—¶å™¨æ–¹å¼åˆ™ç¡®ä¿åœ¨æŒ‡å®šæ—¶é—´é—´éš”å†…åªæ‰§è¡Œä¸€æ¬¡å‡½æ•°ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">// æ—¶é—´æˆ³å®ç°
function throttle(func, delay) {
  let <span class="hljs-attr">prev</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
  return function() {
    const <span class="hljs-attr">now</span> = Date.now()<span class="hljs-comment">;</span>
    if (now - prev &gt; delay) {
      func.apply(this, arguments)<span class="hljs-comment">;</span>
      <span class="hljs-attr">prev</span> = now<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
}

// å®šæ—¶å™¨å®ç°
function throttle(func, delay) {
  let timer<span class="hljs-comment">;</span>
  return function() {
    const <span class="hljs-attr">context</span> = this<span class="hljs-comment">;</span>
    const <span class="hljs-attr">args</span> = arguments<span class="hljs-comment">;</span>
    if (!timer) {
      <span class="hljs-attr">timer</span> = setTimeout(() =&gt; {
        func.apply(context, args)<span class="hljs-comment">;</span>
        <span class="hljs-attr">timer</span> = null<span class="hljs-comment">;</span>
      }, delay)<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€å®é™…åº”ç”¨ç¤ºä¾‹</h2>
<h3 data-id="heading-8">3.1 é˜²æŠ–åœ¨æœç´¢æ¡†ä¸­çš„åº”ç”¨</h3>
<p>åœ¨æœç´¢æ¡†è¾“å…¥åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›åœ¨ç”¨æˆ·åœæ­¢è¾“å…¥åå†å‘é€è¯·æ±‚ï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡æŒ‰é”®æ—¶éƒ½å‘é€ã€‚è¿™ä¸ä»…å¯ä»¥å‡å°‘ä¸å¿…è¦çš„è¯·æ±‚ï¼Œè¿˜èƒ½æå‡ç”¨æˆ·ä½“éªŒã€‚</p>
<p>html</p>
<p>å¤åˆ¶ä¸‹è½½è¿è¡Œ</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>é˜²æŠ–ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"search"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥æœç´¢å†…å®¹"</span>&gt;</span>
  
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> searchInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'search'</span>);
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">search</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å‘é€æœç´¢è¯·æ±‚:'</span>, searchInput.<span class="hljs-property">value</span>);
      <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šå‘é€AJAXè¯·æ±‚</span>
    }
    
    searchInput.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'input'</span>, _.<span class="hljs-title function_">debounce</span>(search, <span class="hljs-number">500</span>));
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå³ä½¿ç”¨æˆ·å¿«é€Ÿè¿ç»­è¾“å…¥ï¼Œæœç´¢è¯·æ±‚ä¹Ÿåªä¼šåœ¨ç”¨æˆ·åœæ­¢è¾“å…¥500æ¯«ç§’åå‘é€ä¸€æ¬¡ã€‚</p>
<h3 data-id="heading-9">3.2 èŠ‚æµåœ¨é¼ æ ‡ç§»åŠ¨ä¸­çš„åº”ç”¨</h3>
<p>åœ¨æŸäº›äº¤äº’åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è·Ÿè¸ªé¼ æ ‡ç§»åŠ¨ï¼Œä½†å¦‚æœå¯¹æ¯ä¸ªmousemoveäº‹ä»¶éƒ½æ‰§è¡Œå¤æ‚æ“ä½œï¼Œä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨èŠ‚æµæ¥é™åˆ¶æ‰§è¡Œé¢‘ç‡ã€‚</p>
<p>html</p>
<p>å¤åˆ¶ä¸‹è½½è¿è¡Œ</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>èŠ‚æµç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-class">.box</span>{
      <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
      <span class="hljs-attribute">background-color</span>: pink;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> box = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.box'</span>);
    <span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">mouseMove</span>(<span class="hljs-params"/>){
      box.<span class="hljs-property">innerHTML</span> = i++;
    }
    
    <span class="hljs-comment">// ä½¿ç”¨èŠ‚æµï¼Œæ¯500æ¯«ç§’æœ€å¤šæ‰§è¡Œä¸€æ¬¡</span>
    box.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, _.<span class="hljs-title function_">throttle</span>(mouseMove, <span class="hljs-number">500</span>));
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå³ä½¿ç”¨æˆ·å¿«é€Ÿç§»åŠ¨é¼ æ ‡ï¼Œè®¡æ•°å™¨çš„å¢åŠ ä¹Ÿä¼šè¢«é™åˆ¶åœ¨æ¯500æ¯«ç§’æœ€å¤šä¸€æ¬¡ï¼Œé¿å…äº†è¿‡äºé¢‘ç¹çš„DOMæ“ä½œã€‚</p>
<h3 data-id="heading-10">3.3 ç»¼åˆæ¡ˆä¾‹ï¼šè§†é¢‘æ’­æ”¾è¿›åº¦ä¿å­˜</h3>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ç»“åˆä½¿ç”¨å¤šç§æŠ€æœ¯ã€‚ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åœ¨è§†é¢‘æ’­æ”¾è¿‡ç¨‹ä¸­ä½¿ç”¨èŠ‚æµæ¥ä¿å­˜æ’­æ”¾è¿›åº¦ï¼Œå¹¶åœ¨é¡µé¢é‡æ–°åŠ è½½æ—¶æ¢å¤æ’­æ”¾ä½ç½®ã€‚</p>
<p>html</p>
<p>å¤åˆ¶ä¸‹è½½è¿è¡Œ</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"IE=edge"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"referrer"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"never"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç»¼åˆæ¡ˆä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    * {
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">box-sizing</span>: border-box;
    }

    <span class="hljs-selector-class">.container</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">1200px</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
    }

    <span class="hljs-selector-class">.video</span> <span class="hljs-selector-tag">video</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-selector-class">.elevator</span> {
      <span class="hljs-attribute">position</span>: fixed;
      <span class="hljs-attribute">top</span>: <span class="hljs-number">280px</span>;
      <span class="hljs-attribute">right</span>: <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">z-index</span>: <span class="hljs-number">999</span>;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
      <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e4e4e4</span>;
      <span class="hljs-attribute">width</span>: <span class="hljs-number">60px</span>;
    }

    <span class="hljs-selector-class">.elevator</span> <span class="hljs-selector-tag">a</span> {
      <span class="hljs-attribute">display</span>: block;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
      <span class="hljs-attribute">text-decoration</span>: none;
      <span class="hljs-attribute">text-align</span>: center;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#999</span>;
    }

    <span class="hljs-selector-class">.elevator</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.active</span> {
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#1286ff</span>;
    }

    <span class="hljs-selector-class">.outline</span> {
      <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">300px</span>;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"header"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"http://pip.itcast.cn"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://pip.itcast.cn/img/logo_v3.29b9ba72.png"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"video"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://v.itheima.net/LapADhV6.mp4"</span> <span class="hljs-attr">controls</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"elevator"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span> <span class="hljs-attr">data-ref</span>=<span class="hljs-string">"video"</span>&gt;</span>è§†é¢‘ä»‹ç»<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span> <span class="hljs-attr">data-ref</span>=<span class="hljs-string">"intro"</span>&gt;</span>è¯¾ç¨‹ç®€ä»‹<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span> <span class="hljs-attr">data-ref</span>=<span class="hljs-string">"outline"</span>&gt;</span>è¯„è®ºåˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// è·å–è§†é¢‘å…ƒç´ </span>
    <span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'video'</span>);
    
    <span class="hljs-comment">// ä½¿ç”¨èŠ‚æµä¿å­˜æ’­æ”¾è¿›åº¦</span>
    video.<span class="hljs-property">ontimeupdate</span> = _.<span class="hljs-title function_">throttle</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// æŠŠå½“å‰æ’­æ”¾æ—¶é—´å­˜å‚¨åˆ°æœ¬åœ°å­˜å‚¨</span>
      <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'currentTime'</span>, video.<span class="hljs-property">currentTime</span>);
    }, <span class="hljs-number">1000</span>);

    <span class="hljs-comment">// é¡µé¢åŠ è½½æ—¶æ¢å¤æ’­æ”¾è¿›åº¦</span>
    video.<span class="hljs-property">onloadeddata</span> = <span class="hljs-function">() =&gt;</span> {
      video.<span class="hljs-property">currentTime</span> = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'currentTime'</span>) || <span class="hljs-number">0</span>;
    };
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>åœ¨è¿™ä¸ªç»¼åˆæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨èŠ‚æµæŠ€æœ¯é™åˆ¶äº†æ’­æ”¾è¿›åº¦ä¿å­˜çš„é¢‘ç‡ï¼Œé¿å…äº†è¿‡äºé¢‘ç¹çš„æœ¬åœ°å­˜å‚¨æ“ä½œã€‚åŒæ—¶ï¼Œåœ¨é¡µé¢åŠ è½½æ—¶ï¼Œæˆ‘ä»¬ä¼šä»æœ¬åœ°å­˜å‚¨ä¸­è¯»å–ä¹‹å‰ä¿å­˜çš„æ’­æ”¾ä½ç½®ï¼Œå®ç°ç»­æ’­åŠŸèƒ½ã€‚</p>
<h2 data-id="heading-11">å››ã€Lodashåº“ä¸­çš„é˜²æŠ–ä¸èŠ‚æµ</h2>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸éœ€è¦è‡ªå·±å®ç°é˜²æŠ–å’ŒèŠ‚æµå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨æˆç†Ÿçš„å·¥å…·åº“å¦‚Lodashã€‚Lodashæä¾›äº†ç»è¿‡å……åˆ†æµ‹è¯•å’Œä¼˜åŒ–çš„<code>_.debounce</code>å’Œ<code>_.throttle</code>å‡½æ•°ã€‚</p>
<h3 data-id="heading-12">4.1 Lodashé˜²æŠ–å‡½æ•°</h3>
<p><code>_.debounce(func, [wait=0], [options={}])</code></p>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>func</code>: è¦é˜²æŠ–åŠ¨çš„å‡½æ•°</li>
<li><code>[wait=0]</code>: éœ€è¦å»¶è¿Ÿçš„æ¯«ç§’æ•°</li>
<li><code>[options={}]</code>: é€‰é¡¹å¯¹è±¡ï¼Œå¯é…ç½®<code>leading</code>ï¼ˆæ˜¯å¦åœ¨å»¶è¿Ÿå¼€å§‹å‰è°ƒç”¨ï¼‰å’Œ<code>trailing</code>ï¼ˆæ˜¯å¦åœ¨å»¶è¿Ÿç»“æŸåè°ƒç”¨ï¼‰</li>
</ul>
<h3 data-id="heading-13">4.2 LodashèŠ‚æµå‡½æ•°</h3>
<p><code>_.throttle(func, [wait=0], [options={}])</code></p>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>func</code>: è¦èŠ‚æµçš„å‡½æ•°</li>
<li><code>[wait=0]</code>: éœ€è¦èŠ‚æµçš„æ¯«ç§’æ•°</li>
<li><code>[options={}]</code>: é€‰é¡¹å¯¹è±¡ï¼Œå¯é…ç½®<code>leading</code>ï¼ˆæ˜¯å¦åœ¨èŠ‚æµå¼€å§‹å‰è°ƒç”¨ï¼‰å’Œ<code>trailing</code>ï¼ˆæ˜¯å¦åœ¨èŠ‚æµç»“æŸåè°ƒç”¨ï¼‰</li>
</ul>
<h2 data-id="heading-14">äº”ã€é«˜çº§åº”ç”¨ä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-15">5.1 é˜²æŠ–ä¸èŠ‚æµçš„ç»“åˆä½¿ç”¨</h3>
<p>åœ¨æŸäº›å¤æ‚åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åŒæ—¶ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµã€‚ä¾‹å¦‚ï¼Œåœ¨å®ç°æ— é™æ»šåŠ¨åŠ è½½æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›åœ¨ç”¨æˆ·å¿«é€Ÿæ»šåŠ¨æ—¶ä½¿ç”¨èŠ‚æµå®šæœŸæ£€æŸ¥ä½ç½®ï¼Œè€Œåœ¨ç”¨æˆ·åœæ­¢æ»šåŠ¨æ—¶ä½¿ç”¨é˜²æŠ–è§¦å‘æœ€ç»ˆçš„åŠ è½½æ“ä½œã€‚</p>
<h3 data-id="heading-16">5.2 å–æ¶ˆæ“ä½œ</h3>
<p>Lodashçš„é˜²æŠ–å’ŒèŠ‚æµå‡½æ•°è¿”å›çš„éƒ½æ˜¯ä¸€ä¸ªå…·æœ‰å–æ¶ˆåŠŸèƒ½çš„æ–°å‡½æ•°ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦æ—¶å–æ¶ˆå¾…æ‰§è¡Œçš„å‡½æ•°è°ƒç”¨ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-scss" lang="scss">const debouncedFunc = _<span class="hljs-selector-class">.debounce</span>(someFunction, <span class="hljs-number">1000</span>);

<span class="hljs-comment">// æ‰§è¡Œé˜²æŠ–å‡½æ•°</span>
<span class="hljs-built_in">debouncedFunc</span>();

<span class="hljs-comment">// å–æ¶ˆå¾…æ‰§è¡Œçš„é˜²æŠ–è°ƒç”¨</span>
debouncedFunc<span class="hljs-selector-class">.cancel</span>();
</code></pre>
<h3 data-id="heading-17">5.3 ç«‹å³æ‰§è¡Œé€‰é¡¹</h3>
<p>åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›äº‹ä»¶ç¬¬ä¸€æ¬¡è§¦å‘æ—¶ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œç„¶ååœ¨ä¸€å®šæ—¶é—´å†…ä¸å†è§¦å‘ã€‚è¿™å¯ä»¥é€šè¿‡é…ç½®é€‰é¡¹å®ç°ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// é¦–æ¬¡è§¦å‘ç«‹å³æ‰§è¡Œï¼Œåç»­è§¦å‘åœ¨åœæ­¢å500msæ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">debouncedFunc</span> = _.<span class="hljs-title function_ invoke__">debounce</span>(someFunction, <span class="hljs-number">500</span>, { <span class="hljs-attr">leading</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">trailing</span>: <span class="hljs-literal">true</span> });

<span class="hljs-comment">// é¦–æ¬¡è§¦å‘ç«‹å³æ‰§è¡Œï¼Œåç»­è§¦å‘æ¯500msæ‰§è¡Œä¸€æ¬¡</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">throttledFunc</span> = _.<span class="hljs-title function_ invoke__">throttle</span>(someFunction, <span class="hljs-number">500</span>, { <span class="hljs-attr">leading</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">trailing</span>: <span class="hljs-literal">true</span> });
</code></pre>
<h2 data-id="heading-18">å…­ã€æ€§èƒ½ä¼˜åŒ–ä¸å®è·µå»ºè®®</h2>
<h3 data-id="heading-19">6.1 åˆç†è®¾ç½®å»¶è¿Ÿæ—¶é—´</h3>
<p>é˜²æŠ–å’ŒèŠ‚æµçš„æ•ˆæœå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå»¶è¿Ÿæ—¶é—´çš„è®¾ç½®ã€‚æ—¶é—´å¤ªçŸ­å¯èƒ½èµ·ä¸åˆ°ä¼˜åŒ–ä½œç”¨ï¼Œæ—¶é—´å¤ªé•¿åˆ™ä¼šå½±å“ç”¨æˆ·ä½“éªŒã€‚ä¸€èˆ¬æ¥è¯´ï¼š</p>
<ul>
<li>å¯¹äºæœç´¢æ¡†è¾“å…¥ï¼Œ200-500æ¯«ç§’çš„å»¶è¿Ÿè¾ƒä¸ºåˆé€‚</li>
<li>å¯¹äºæ»šåŠ¨äº‹ä»¶ï¼Œ100-200æ¯«ç§’çš„å»¶è¿Ÿè¾ƒä¸ºåˆé€‚</li>
<li>å¯¹äºé¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼Œ50-100æ¯«ç§’çš„å»¶è¿Ÿè¾ƒä¸ºåˆé€‚</li>
</ul>
<h3 data-id="heading-20">6.2 é¿å…è¿‡åº¦ä½¿ç”¨</h3>
<p>è™½ç„¶é˜²æŠ–å’ŒèŠ‚æµæ˜¯æœ‰æ•ˆçš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µï¼Œä½†ä¸åº”è¿‡åº¦ä½¿ç”¨ã€‚åœ¨æŸäº›éœ€è¦å®æ—¶å“åº”çš„åœºæ™¯ä¸­ï¼ˆå¦‚æ‹–æ‹½æ“ä½œï¼‰ï¼Œä½¿ç”¨è¿™äº›æŠ€æœ¯åè€Œä¼šé™ä½ç”¨æˆ·ä½“éªŒã€‚</p>
<h3 data-id="heading-21">6.3 ç»“åˆå…¶ä»–ä¼˜åŒ–æŠ€æœ¯</h3>
<p>é˜²æŠ–å’ŒèŠ‚æµé€šå¸¸ä¸å…¶ä»–æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ç»“åˆä½¿ç”¨ï¼Œå¦‚è™šæ‹Ÿåˆ—è¡¨ã€æ‡’åŠ è½½ç­‰ï¼Œå…±åŒæ„å»ºé«˜æ€§èƒ½çš„Webåº”ç”¨ã€‚</p>
<h2 data-id="heading-22">ä¸ƒã€æ€»ç»“</h2>
<p>é˜²æŠ–å’ŒèŠ‚æµæ˜¯å‰ç«¯å¼€å‘ä¸­ä¸å¯æˆ–ç¼ºçš„æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ã€‚å®ƒä»¬é€šè¿‡ä¸åŒçš„ç­–ç•¥é™åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘ç‡ï¼Œæœ‰æ•ˆè§£å†³äº†é«˜é¢‘äº‹ä»¶å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<ul>
<li>é˜²æŠ–é€‚ç”¨äºéœ€è¦ç­‰å¾…æ“ä½œåœæ­¢åå†æ‰§è¡Œçš„åœºæ™¯ï¼Œå¦‚æœç´¢æ¡†è¾“å…¥ã€çª—å£è°ƒæ•´ç­‰</li>
<li>èŠ‚æµé€‚ç”¨äºéœ€è¦å®šæœŸæ‰§è¡Œä½†ä¸éœ€æ¯æ¬¡è§¦å‘éƒ½æ‰§è¡Œçš„åœºæ™¯ï¼Œå¦‚æ»šåŠ¨äº‹ä»¶ã€é¼ æ ‡ç§»åŠ¨ç­‰</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å·¥ä½œä¸­æœ€å¸¸ç”¨çš„6ç§APIç½‘å…³]]></title>    <link>https://juejin.cn/post/7573594825317253160</link>    <guid>https://juejin.cn/post/7573594825317253160</guid>    <pubDate>2025-11-18T02:18:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573594825317253160" data-draft-id="7573530680887607330" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å·¥ä½œä¸­æœ€å¸¸ç”¨çš„6ç§APIç½‘å…³"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-18T02:18:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ä¸‰è¯´æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/465848661970824"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å·¥ä½œä¸­æœ€å¸¸ç”¨çš„6ç§APIç½‘å…³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/465848661970824/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ä¸‰è¯´æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:18:02.000Z" title="Tue Nov 18 2025 02:18:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>APIç½‘å…³åœ¨é¡¹ç›®ä¸­éå¸¸é‡è¦ã€‚</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« è·Ÿå¤§å®¶ä¸€èµ·èŠèŠå·¥ä½œæœ€å¸¸ç”¨çš„6ç§ç½‘å…³ï¼Œå¸Œæœ›å¯¹ä½ ä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p>
<p><a href="https://link.juejin.cn/?target=http%3A%2F%2Fwww.susan.net.cn%3Frefer%3Djuejin" title="https://link.juejin.cn/?target=http%3A%2F%2Fwww.susan.net.cn%3Frefer%3Djuejin" target="_blank">æœ€è¿‘å‡†å¤‡é¢è¯•çš„å°ä¼™ä¼´ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªå®è—ç½‘ç«™ï¼ˆJavaçªå‡»é˜Ÿï¼‰ï¼šwww.susan.net.cnï¼Œé‡Œé¢ï¼šé¢è¯•å…«è‚¡æ–‡ã€åœºæ™¯è®¾è®¡é¢˜ã€é¢è¯•çœŸé¢˜ã€7ä¸ªé¡¹ç›®å®æˆ˜ã€å·¥ä½œå†…æ¨ä»€ä¹ˆéƒ½æœ‰</a>ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦APIç½‘å…³ï¼Ÿ</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨å·¥ä½œä¸­å¯èƒ½ä¼šé—®ï¼šæˆ‘ä»¬çš„ç³»ç»Ÿç›´æ¥è°ƒç”¨å¾®æœåŠ¡ä¸æ˜¯æ›´ç®€å•å—ï¼Ÿ</p>
<p>ä¸ºä»€ä¹ˆéè¦å¼•å…¥APIç½‘å…³è¿™ä¸ª"ä¸­é—´å•†"å‘¢ï¼Ÿ</p>
<p>è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ã€‚</p>
<h3 data-id="heading-2">æ²¡æœ‰ç½‘å…³çš„å¾®æœåŠ¡å›°å¢ƒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å‰ç«¯ç›´æ¥è°ƒç”¨å¤šä¸ªå¾®æœåŠ¡ - é—®é¢˜é‡é‡</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FrontendController</span> {
    
    <span class="hljs-comment">// é—®é¢˜1ï¼šæœåŠ¡åœ°å€ç¡¬ç¼–ç </span>
    <span class="hljs-meta">@Value("${user.service.url:http://localhost:8081}")</span>
    <span class="hljs-keyword">private</span> String userServiceUrl;
    
    <span class="hljs-meta">@Value("${order.service.url:http://localhost:8082}")</span>
    <span class="hljs-keyword">private</span> String orderServiceUrl;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RestTemplate restTemplate;
    
    <span class="hljs-meta">@GetMapping("/user-dashboard")</span>
    <span class="hljs-keyword">public</span> UserDashboard <span class="hljs-title function_">getUserDashboard</span><span class="hljs-params">(<span class="hljs-meta">@RequestHeader("Authorization")</span> String token)</span> {
        <span class="hljs-comment">// é—®é¢˜2ï¼šæ¯ä¸ªæœåŠ¡éƒ½è¦é‡å¤è®¤è¯é€»è¾‘</span>
        <span class="hljs-keyword">if</span> (!validateToken(token)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnauthorizedException</span>(<span class="hljs-string">"Token invalid"</span>);
        }
        
        <span class="hljs-comment">// é—®é¢˜3ï¼šéœ€è¦æ‰‹åŠ¨å¤„ç†æœåŠ¡é—´è°ƒç”¨é¡ºåº</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> restTemplate.getForObject(userServiceUrl + <span class="hljs-string">"/users/current"</span>, User.class);
        List&lt;Order&gt; orders = restTemplate.getForObject(orderServiceUrl + <span class="hljs-string">"/orders?userId="</span> + user.getId(), List.class);
        
        <span class="hljs-comment">// é—®é¢˜4ï¼šé”™è¯¯å¤„ç†å¤æ‚</span>
        <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span> || orders == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServiceUnavailableException</span>(<span class="hljs-string">"Backend service unavailable"</span>);
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDashboard</span>(user, orders);
    }
    
    <span class="hljs-comment">// é—®é¢˜5ï¼šé‡å¤çš„è®¤è¯ä»£ç </span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateToken</span><span class="hljs-params">(String token)</span> {
        <span class="hljs-comment">// æ¯ä¸ªæ¥å£éƒ½è¦å®ç°çš„è®¤è¯é€»è¾‘</span>
        <span class="hljs-keyword">return</span> token != <span class="hljs-literal">null</span> &amp;&amp; token.startsWith(<span class="hljs-string">"Bearer "</span>);
    }
}
</code></pre>
<h3 data-id="heading-3">å¼•å…¥ç½‘å…³åçš„ä¼˜é›…æ¶æ„</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç½‘å…³ç»Ÿä¸€å¤„ç†æ‰€æœ‰æ¨ªåˆ‡å…³æ³¨ç‚¹</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GatewayConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> RouteLocator <span class="hljs-title function_">customRouteLocator</span><span class="hljs-params">(RouteLocatorBuilder builder)</span> {
        <span class="hljs-keyword">return</span> builder.routes()
            .route(<span class="hljs-string">"user_service"</span>, r -&gt; r.path(<span class="hljs-string">"/api/users/**"</span>)
                .uri(<span class="hljs-string">"lb://user-service"</span>))
            .route(<span class="hljs-string">"order_service"</span>, r -&gt; r.path(<span class="hljs-string">"/api/orders/**"</span>)
                .uri(<span class="hljs-string">"lb://order-service"</span>))
            .route(<span class="hljs-string">"product_service"</span>, r -&gt; r.path(<span class="hljs-string">"/api/products/**"</span>)
                .uri(<span class="hljs-string">"lb://product-service"</span>))
            .build();
    }
}

<span class="hljs-comment">// å‰ç«¯åªéœ€è°ƒç”¨ç½‘å…³</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FrontendController</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RestTemplate restTemplate;
    
    <span class="hljs-meta">@GetMapping("/api/user-dashboard")</span>
    <span class="hljs-keyword">public</span> UserDashboard <span class="hljs-title function_">getUserDashboard</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç½‘å…³å·²ç»å¤„ç†äº†è®¤è¯ã€è·¯ç”±ã€è´Ÿè½½å‡è¡¡ç­‰é—®é¢˜</span>
        <span class="hljs-keyword">return</span> restTemplate.getForObject(<span class="hljs-string">"http://gateway/api/users/current/dashboard"</span>, UserDashboard.class);
    }
}
</code></pre>
<h3 data-id="heading-4">APIç½‘å…³çš„æ ¸å¿ƒä»·å€¼</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡æ¶æ„å›¾æ¥ç†è§£ç½‘å…³åœ¨å¾®æœåŠ¡æ¶æ„ä¸­çš„å…³é”®ä½œç”¨ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a0b22cc4a7b42e9a8d3c57431384a95~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764037082&amp;x-signature=%2F6VuMccszgnP%2FTxBznc0N7cQApo%3D" alt="" loading="lazy"/></p>
<p><strong>ç½‘å…³è§£å†³çš„8å¤§æ ¸å¿ƒé—®é¢˜ï¼š</strong></p>
<ol>
<li><strong>ç»Ÿä¸€å…¥å£</strong>ï¼šæ‰€æœ‰è¯·æ±‚éƒ½é€šè¿‡ç½‘å…³è¿›å…¥ç³»ç»Ÿ</li>
<li><strong>è®¤è¯æˆæƒ</strong>ï¼šé›†ä¸­å¤„ç†èº«ä»½éªŒè¯å’Œæƒé™æ§åˆ¶</li>
<li><strong>æµé‡æ§åˆ¶</strong>ï¼šé™æµã€ç†”æ–­ã€é™çº§ç­‰ resiliency æ¨¡å¼</li>
<li><strong>ç›‘æ§ç»Ÿè®¡</strong>ï¼šç»Ÿä¸€çš„æ—¥å¿—ã€æŒ‡æ ‡æ”¶é›†</li>
<li><strong>åè®®è½¬æ¢</strong>ï¼šHTTP/1.1ã€HTTP/2ã€gRPC ç­‰åè®®é€‚é…</li>
<li><strong>ç¼“å­˜åŠ é€Ÿ</strong>ï¼šå“åº”ç¼“å­˜é™ä½åç«¯å‹åŠ›</li>
<li><strong>å®‰å…¨é˜²æŠ¤</strong>ï¼šWAFã€é˜²çˆ¬è™«ã€é˜²é‡æ”¾æ”»å‡»</li>
<li><strong>æœåŠ¡æ²»ç†</strong>ï¼šæœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€è·¯ç”±è½¬å‘</li>
</ol>
<p>ä¸‹é¢æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹å·¥ä½œä¸­æœ€å¸¸è§çš„6ç§APIç½‘å…³æœ‰å“ªäº›ã€‚</p>
<h2 data-id="heading-5">äºŒã€Spring Cloud Gateway</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨SpringæŠ€æœ¯æ ˆä¸­å¼€å‘å¾®æœåŠ¡ï¼ŒSpring Cloud Gateway æ— ç–‘æ˜¯æœ€è‡ªç„¶çš„é€‰æ‹©ã€‚</p>
<p>ä½œä¸ºSpringå®˜æ–¹æ¨å‡ºçš„ç¬¬äºŒä»£ç½‘å…³ï¼Œå®ƒåŸºäºWebFluxå“åº”å¼ç¼–ç¨‹æ¨¡å‹ï¼Œæ€§èƒ½å“è¶Šã€‚</p>
<h3 data-id="heading-6">æ ¸å¿ƒæ¶æ„æ·±åº¦è§£æ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AdvancedGatewayConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-meta">@Order(-1)</span>
    <span class="hljs-keyword">public</span> GlobalFilter <span class="hljs-title function_">customGlobalFilter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> (exchange, chain) -&gt; {
            <span class="hljs-comment">// å‰ç½®å¤„ç†</span>
            <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
            <span class="hljs-type">ServerHttpRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> exchange.getRequest();
            
            <span class="hljs-comment">// æ·»åŠ è¿½è¸ªID</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">traceId</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString();
            <span class="hljs-type">ServerHttpRequest</span> <span class="hljs-variable">mutatedRequest</span> <span class="hljs-operator">=</span> request.mutate()
                .header(<span class="hljs-string">"X-Trace-Id"</span>, traceId)
                .build();
                
            <span class="hljs-keyword">return</span> chain.filter(exchange.mutate().request(mutatedRequest).build())
                .then(Mono.fromRunnable(() -&gt; {
                    <span class="hljs-comment">// åç½®å¤„ç†</span>
                    <span class="hljs-type">long</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> System.currentTimeMillis() - startTime;
                    log.info(<span class="hljs-string">"Request {} completed in {}ms"</span>, traceId, duration);
                }));
        };
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> RouteLocator <span class="hljs-title function_">advancedRoutes</span><span class="hljs-params">(RouteLocatorBuilder builder)</span> {
        <span class="hljs-keyword">return</span> builder.routes()
            <span class="hljs-comment">// ç”¨æˆ·æœåŠ¡ - å¸¦ç†”æ–­å’Œé‡è¯•</span>
            .route(<span class="hljs-string">"user_service"</span>, r -&gt; r.path(<span class="hljs-string">"/api/users/**"</span>)
                .filters(f -&gt; f
                    .circuitBreaker(config -&gt; config
                        .setName(<span class="hljs-string">"userServiceCB"</span>)
                        .setFallbackUri(<span class="hljs-string">"forward:/fallback/user-service"</span>))
                    .retry(config -&gt; config
                        .setRetries(<span class="hljs-number">3</span>)
                        .setMethods(HttpMethod.GET, HttpMethod.POST)
                        .setBackoff(<span class="hljs-number">100L</span>, <span class="hljs-number">1000L</span>, <span class="hljs-number">2</span>, <span class="hljs-literal">true</span>))
                    .requestRateLimiter(config -&gt; config
                        .setRateLimiter(redisRateLimiter())
                        .setKeyResolver(apiKeyResolver()))
                    .modifyRequestBody(String.class, String.class, 
                        (exchange, s) -&gt; Mono.just(validateAndTransform(s))))
                .uri(<span class="hljs-string">"lb://user-service"</span>))
            
            <span class="hljs-comment">// è®¢å•æœåŠ¡ - å¸¦JWTè®¤è¯</span>
            .route(<span class="hljs-string">"order_service"</span>, r -&gt; r.path(<span class="hljs-string">"/api/orders/**"</span>)
                .filters(f -&gt; f
                    .filter(jwtAuthenticationFilter())
                    .prefixPath(<span class="hljs-string">"/v1"</span>)
                    .addResponseHeader(<span class="hljs-string">"X-API-Version"</span>, <span class="hljs-string">"1.0"</span>))
                .uri(<span class="hljs-string">"lb://order-service"</span>))
            
            <span class="hljs-comment">// å•†å“æœåŠ¡ - é™æ€èµ„æºç¼“å­˜</span>
            .route(<span class="hljs-string">"product_service"</span>, r -&gt; r.path(<span class="hljs-string">"/api/products/**"</span>)
                .filters(f -&gt; f
                    .dedupeResponseHeader(<span class="hljs-string">"Cache-Control"</span>, <span class="hljs-string">"RETAIN_FIRST"</span>)
                    .setResponseHeader(<span class="hljs-string">"Cache-Control"</span>, <span class="hljs-string">"public, max-age=3600"</span>))
                .uri(<span class="hljs-string">"lb://product-service"</span>))
            .build();
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> JwtAuthenticationFilter <span class="hljs-title function_">jwtAuthenticationFilter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JwtAuthenticationFilter</span>();
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> RedisRateLimiter <span class="hljs-title function_">redisRateLimiter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisRateLimiter</span>(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>);
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> KeyResolver <span class="hljs-title function_">apiKeyResolver</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> exchange -&gt; {
            <span class="hljs-type">String</span> <span class="hljs-variable">apiKey</span> <span class="hljs-operator">=</span> exchange.getRequest().getHeaders().getFirst(<span class="hljs-string">"X-API-Key"</span>);
            <span class="hljs-keyword">return</span> Mono.just(Optional.ofNullable(apiKey).orElse(<span class="hljs-string">"anonymous"</span>));
        };
    }
}

<span class="hljs-comment">// JWTè®¤è¯è¿‡æ»¤å™¨</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">JwtAuthenticationFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">GatewayFilter</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> JwtUtil jwtUtil;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Mono&lt;Void&gt; <span class="hljs-title function_">filter</span><span class="hljs-params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> extractToken(exchange.getRequest());
        
        <span class="hljs-keyword">if</span> (token == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> onError(exchange, <span class="hljs-string">"Missing authentication token"</span>, HttpStatus.UNAUTHORIZED);
        }
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Claims</span> <span class="hljs-variable">claims</span> <span class="hljs-operator">=</span> jwtUtil.parseToken(token);
            <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> claims.getSubject();
            
            <span class="hljs-comment">// å°†ç”¨æˆ·ä¿¡æ¯æ·»åŠ åˆ°header</span>
            <span class="hljs-type">ServerHttpRequest</span> <span class="hljs-variable">mutatedRequest</span> <span class="hljs-operator">=</span> exchange.getRequest().mutate()
                .header(<span class="hljs-string">"X-User-Name"</span>, username)
                .header(<span class="hljs-string">"X-User-Roles"</span>, String.join(<span class="hljs-string">","</span>, claims.get(<span class="hljs-string">"roles"</span>, List.class)))
                .build();
                
            <span class="hljs-keyword">return</span> chain.filter(exchange.mutate().request(mutatedRequest).build());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> onError(exchange, <span class="hljs-string">"Invalid token: "</span> + e.getMessage(), HttpStatus.UNAUTHORIZED);
        }
    }
    
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">extractToken</span><span class="hljs-params">(ServerHttpRequest request)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">bearerToken</span> <span class="hljs-operator">=</span> request.getHeaders().getFirst(<span class="hljs-string">"Authorization"</span>);
        <span class="hljs-keyword">if</span> (StringUtils.hasText(bearerToken) &amp;&amp; bearerToken.startsWith(<span class="hljs-string">"Bearer "</span>)) {
            <span class="hljs-keyword">return</span> bearerToken.substring(<span class="hljs-number">7</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">private</span> Mono&lt;Void&gt; <span class="hljs-title function_">onError</span><span class="hljs-params">(ServerWebExchange exchange, String err, HttpStatus status)</span> {
        exchange.getResponse().setStatusCode(status);
        <span class="hljs-type">DataBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> exchange.getResponse().bufferFactory()
            .wrap((<span class="hljs-string">"{\"error\":\""</span> + err + <span class="hljs-string">"\"}"</span>).getBytes());
        <span class="hljs-keyword">return</span> exchange.getResponse().writeWith(Mono.just(buffer));
    }
}
</code></pre>
<h3 data-id="heading-7">Spring Cloud Gateway æ‰§è¡Œæµç¨‹</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3aadd8f06f84f65ba665baa24a1b4e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764037082&amp;x-signature=QtfTLKG7jroFTug4l3ISQ3WvaKY%3D" alt="" loading="lazy"/></p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>ä¸Spring Cloudç”Ÿæ€å®Œç¾é›†æˆ</li>
<li>åŸºäºWebFluxï¼Œæ€§èƒ½ä¼˜ç§€</li>
<li>åŠŸèƒ½ä¸°å¯Œï¼Œæ”¯æŒè¿‡æ»¤å™¨å’Œæ–­è¨€</li>
<li>é…ç½®çµæ´»ï¼Œæ”¯æŒä»£ç å’Œé…ç½®æ–‡ä»¶ä¸¤ç§æ–¹å¼</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>å¯¹éSpringæŠ€æœ¯æ ˆä¸å‹å¥½</li>
<li>å­¦ä¹ æ›²çº¿ç›¸å¯¹é™¡å³­</li>
<li>ä¾èµ–Spring Cloudç»„ä»¶</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>Spring Cloudå¾®æœåŠ¡æ¶æ„</li>
<li>éœ€è¦æ·±åº¦å®šåˆ¶ç½‘å…³é€»è¾‘</li>
<li>å›¢é˜Ÿç†Ÿæ‚‰SpringæŠ€æœ¯æ ˆ</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€Kongï¼šä¼ä¸šçº§APIç½‘å…³æ ‡æ†</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨ä¼ä¸šçº§åœºæ™¯ä¸­éœ€è¦æ›´é«˜çš„æ€§èƒ½å’Œæ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼ŒKongå°±æ˜¯è¿™æ ·ä¸€ä¸ªåŸºäºNginxå’ŒOpenRestyçš„é«˜æ€§èƒ½APIç½‘å…³ã€‚</p>
<h3 data-id="heading-9">Kong é…ç½®å®æˆ˜</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># kong.yml - å£°æ˜å¼é…ç½®</span>
<span class="hljs-attr">_format_version:</span> <span class="hljs-string">"2.1"</span>
<span class="hljs-attr">_transform:</span> <span class="hljs-literal">true</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">user-service</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">http://user-service:8080</span>
    <span class="hljs-attr">routes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">user-route</span>
        <span class="hljs-attr">paths:</span> [<span class="hljs-string">"/api/users"</span>]
        <span class="hljs-attr">strip_path:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">plugins:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">key-auth</span>
        <span class="hljs-attr">config:</span>
          <span class="hljs-attr">key_names:</span> [<span class="hljs-string">"apikey"</span>]
          <span class="hljs-attr">hide_credentials:</span> <span class="hljs-literal">true</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">rate-limiting</span>
        <span class="hljs-attr">config:</span>
          <span class="hljs-attr">minute:</span> <span class="hljs-number">10</span>
          <span class="hljs-attr">policy:</span> <span class="hljs-string">redis</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">prometheus</span>
        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>

  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">order-service</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">http://order-service:8080</span>
    <span class="hljs-attr">routes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">order-route</span>
        <span class="hljs-attr">paths:</span> [<span class="hljs-string">"/api/orders"</span>]
        <span class="hljs-attr">methods:</span> [<span class="hljs-string">"GET"</span>, <span class="hljs-string">"POST"</span>, <span class="hljs-string">"PUT"</span>]
    <span class="hljs-attr">plugins:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">cors</span>
        <span class="hljs-attr">config:</span>
          <span class="hljs-attr">origins:</span> [<span class="hljs-string">"https://example.com"</span>]
          <span class="hljs-attr">methods:</span> [<span class="hljs-string">"GET"</span>, <span class="hljs-string">"POST"</span>, <span class="hljs-string">"PUT"</span>]
          <span class="hljs-attr">headers:</span> [<span class="hljs-string">"Accept"</span>, <span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Content-Type"</span>]
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">request-transformer</span>
        <span class="hljs-attr">config:</span>
          <span class="hljs-attr">add:</span>
            <span class="hljs-attr">headers:</span> [<span class="hljs-string">"X-From-Kong: true"</span>]
          <span class="hljs-attr">remove:</span>
            <span class="hljs-attr">headers:</span> [<span class="hljs-string">"User-Agent"</span>]

<span class="hljs-attr">consumers:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">username:</span> <span class="hljs-string">mobile-app</span>
    <span class="hljs-attr">keyauth_credentials:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">key:</span> <span class="hljs-string">mobile-key-123</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">username:</span> <span class="hljs-string">web-app</span>
    <span class="hljs-attr">keyauth_credentials:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">key:</span> <span class="hljs-string">web-key-456</span>

<span class="hljs-attr">plugins:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ip-restriction</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">allow:</span> [<span class="hljs-string">"192.168.0.0/16"</span>, <span class="hljs-string">"10.0.0.0/8"</span>]
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">correlation-id</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">header_name:</span> <span class="hljs-string">"X-Request-ID"</span>
      <span class="hljs-attr">generator:</span> <span class="hljs-string">"uuid"</span>
</code></pre>
<h3 data-id="heading-10">è‡ªå®šä¹‰Kongæ’ä»¶å¼€å‘</h3>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- kong/plugins/request-validator/handler.lua</span>
<span class="hljs-keyword">local</span> BasePlugin = <span class="hljs-built_in">require</span> <span class="hljs-string">"kong.plugins.base_plugin"</span>
<span class="hljs-keyword">local</span> cjson = <span class="hljs-built_in">require</span> <span class="hljs-string">"cjson"</span>

<span class="hljs-keyword">local</span> RequestValidator = BasePlugin:extend()

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RequestValidator:new</span><span class="hljs-params">()</span></span>
  RequestValidator.super.new(<span class="hljs-built_in">self</span>, <span class="hljs-string">"request-validator"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RequestValidator:access</span><span class="hljs-params">(conf)</span></span>
  RequestValidator.super.access(<span class="hljs-built_in">self</span>)
  
  <span class="hljs-keyword">local</span> headers = kong.request.get_headers()
  <span class="hljs-keyword">local</span> method = kong.request.get_method()
  <span class="hljs-keyword">local</span> body = kong.request.get_raw_body()
  
  <span class="hljs-comment">-- API KeyéªŒè¯</span>
  <span class="hljs-keyword">local</span> api_key = headers[<span class="hljs-string">"X-API-Key"</span>]
  <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> api_key <span class="hljs-keyword">then</span>
    kong.response.<span class="hljs-built_in">exit</span>(<span class="hljs-number">401</span>, { message = <span class="hljs-string">"Missing API Key"</span> })
  <span class="hljs-keyword">end</span>
  
  <span class="hljs-comment">-- éªŒè¯API Keyæ ¼å¼</span>
  <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">string</span>.<span class="hljs-built_in">match</span>(api_key, <span class="hljs-string">"^%x%x%x%-%x%x%x%-%x%x%x$"</span>) <span class="hljs-keyword">then</span>
    kong.response.<span class="hljs-built_in">exit</span>(<span class="hljs-number">401</span>, { message = <span class="hljs-string">"Invalid API Key format"</span> })
  <span class="hljs-keyword">end</span>
  
  <span class="hljs-comment">-- è¯·æ±‚ä½“éªŒè¯</span>
  <span class="hljs-keyword">if</span> method == <span class="hljs-string">"POST"</span> <span class="hljs-keyword">or</span> method == <span class="hljs-string">"PUT"</span> <span class="hljs-keyword">then</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> body <span class="hljs-keyword">or</span> body == <span class="hljs-string">""</span> <span class="hljs-keyword">then</span>
      kong.response.<span class="hljs-built_in">exit</span>(<span class="hljs-number">400</span>, { message = <span class="hljs-string">"Request body is required"</span> })
    <span class="hljs-keyword">end</span>
    
    <span class="hljs-keyword">local</span> ok, json_body = <span class="hljs-built_in">pcall</span>(cjson.decode, body)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ok <span class="hljs-keyword">then</span>
      kong.response.<span class="hljs-built_in">exit</span>(<span class="hljs-number">400</span>, { message = <span class="hljs-string">"Invalid JSON format"</span> })
    <span class="hljs-keyword">end</span>
    
    <span class="hljs-comment">-- ä¸šåŠ¡è§„åˆ™éªŒè¯</span>
    <span class="hljs-keyword">if</span> json_body.amount <span class="hljs-keyword">and</span> <span class="hljs-built_in">tonumber</span>(json_body.amount) &lt;= <span class="hljs-number">0</span> <span class="hljs-keyword">then</span>
      kong.response.<span class="hljs-built_in">exit</span>(<span class="hljs-number">400</span>, { message = <span class="hljs-string">"Amount must be greater than 0"</span> })
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
  
  <span class="hljs-comment">-- æ·»åŠ éªŒè¯é€šè¿‡æ ‡è®°</span>
  kong.service.request.set_header(<span class="hljs-string">"X-Request-Validated"</span>, <span class="hljs-string">"true"</span>)
  kong.service.request.set_header(<span class="hljs-string">"X-API-Key"</span>, api_key)
  
  <span class="hljs-comment">-- è®°å½•å®¡è®¡æ—¥å¿—</span>
  kong.<span class="hljs-built_in">log</span>.info(<span class="hljs-string">"Request validated for API Key: "</span>, api_key)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">return</span> RequestValidator
</code></pre>
<h3 data-id="heading-11">Kong é›†ç¾¤æ¶æ„</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/042215d4aa9143c1858568a990d14aef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764037082&amp;x-signature=wwnNcgipQSgGkYWRfLBgA49TWoU%3D" alt="" loading="lazy"/></p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>åŸºäºNginxï¼Œæ€§èƒ½æé«˜</li>
<li>æ’ä»¶ç”Ÿæ€ä¸°å¯Œ</li>
<li>æ”¯æŒé›†ç¾¤éƒ¨ç½²</li>
<li>æˆç†Ÿçš„ç›‘æ§å’Œç®¡ç†ç•Œé¢</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>ä¾èµ–æ•°æ®åº“ï¼ˆPostgreSQL/Cassandraï¼‰</li>
<li>æ’ä»¶å¼€å‘éœ€è¦LuaçŸ¥è¯†</li>
<li>é…ç½®ç›¸å¯¹å¤æ‚</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>é«˜å¹¶å‘ä¼ä¸šçº§åº”ç”¨</li>
<li>éœ€è¦ä¸°å¯Œæ’ä»¶åŠŸèƒ½çš„åœºæ™¯</li>
<li>å·²æœ‰KongæŠ€æœ¯æ ˆçš„å›¢é˜Ÿ</li>
</ul>
<p>æœ€è¿‘ä¸ºäº†å¸®åŠ©å¤§å®¶æ‰¾å·¥ä½œï¼Œä¸“é—¨å»ºäº†ä¸€äº›å·¥ä½œå†…æ¨ç¾¤ï¼Œå„å¤§åŸå¸‚éƒ½æœ‰ï¼Œæ¬¢è¿å„ä½HRå’Œæ‰¾å·¥ä½œçš„å°ä¼™ä¼´è¿›ç¾¤äº¤æµï¼Œç¾¤é‡Œç›®å‰å·²ç»æ”¶é›†äº†ä¸å°‘çš„å·¥ä½œå†…æ¨å²—ä½ã€‚åŠ è‹ä¸‰çš„å¾®ä¿¡ï¼šli_su223ï¼Œå¤‡æ³¨ï¼šæ˜é‡‘+æ‰€åœ¨åŸå¸‚ï¼Œå³å¯è¿›ç¾¤ã€‚</p>
<h2 data-id="heading-12">å››ã€Nginxï¼šç»å…¸åå‘ä»£ç†ç½‘å…³</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨ä¼ ç»Ÿæ¶æ„æˆ–ç®€å•åœºæ™¯ä¸­ï¼ŒNginxä»ç„¶æ˜¯æœ€å¯é çš„é€‰æ‹©ã€‚å®ƒè™½ç„¶åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä½†æ€§èƒ½å“è¶Šä¸”ç¨³å®šã€‚</p>
<h3 data-id="heading-13">Nginx é…ç½®è¯¦è§£</h3>
<pre><code class="hljs language-nginx" lang="nginx"># nginx.conf - ç”Ÿäº§ç¯å¢ƒé…ç½®
http {
    # åŸºç¡€é…ç½®
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;
    
    # æ—¥å¿—æ ¼å¼
    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for" '
                    'rt=$request_time uct="$upstream_connect_time" '
                    'uht="$upstream_header_time" urt="$upstream_response_time"';
    
    # ä¸Šæ¸¸æœåŠ¡é…ç½®
    upstream user_service {
        server user-service-1:8080 weight=3;
        server user-service-2:8080 weight=2;
        server user-service-3:8080 weight=1;
        
        # å¥åº·æ£€æŸ¥
        check interval=3000 rise=2 fall=3 timeout=1000;
    }
    
    upstream order_service {
        server order-service-1:8080;
        server order-service-2:8080;
        
        # ä¼šè¯ä¿æŒ
        hash $cookie_jsessionid;
        hash_again 1;
    }
    
    upstream product_service {
        server product-service:8080;
        
        # å¤‡ä»½æœåŠ¡å™¨
        server backup-product-service:8080 backup;
    }
    
    # APIç½‘å…³é…ç½®
    server {
        listen 80;
        server_name api.example.com;
        
        # å…¨å±€é™æµ
        limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
        
        # ç”¨æˆ·æœåŠ¡è·¯ç”±
        location /api/users/ {
            limit_req zone=api burst=20 nodelay;
            
            # åå‘ä»£ç†é…ç½®
            proxy_pass http://user_service;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            
            # è¶…æ—¶é…ç½®
            proxy_connect_timeout 5s;
            proxy_read_timeout 10s;
            proxy_send_timeout 10s;
            
            # é‡è¯•æœºåˆ¶
            proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504;
            proxy_next_upstream_tries 3;
            proxy_next_upstream_timeout 10s;
            
            # ç¼“å­˜é…ç½®
            proxy_cache api_cache;
            proxy_cache_key "$scheme$request_method$host$request_uri";
            proxy_cache_valid 200 302 5m;
            proxy_cache_valid 404 1m;
            
            # æ·»åŠ å®‰å…¨å¤´
            add_header X-Frame-Options DENY;
            add_header X-Content-Type-Options nosniff;
            add_header X-XSS-Protection "1; mode=block";
        }
        
        # è®¢å•æœåŠ¡è·¯ç”±
        location /api/orders/ {
            # JWTéªŒè¯
            auth_request /auth;
            auth_request_set $user $upstream_http_x_user;
            proxy_set_header X-User $user;
            
            proxy_pass http://order_service;
            
            # CORSé…ç½®
            if ($request_method = 'OPTIONS') {
                add_header 'Access-Control-Allow-Origin' '*';
                add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
                add_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type';
                add_header 'Access-Control-Max-Age' 86400;
                return 204;
            }
        }
        
        # è®¤è¯ç«¯ç‚¹
        location = /auth {
            internal;
            proxy_pass http://auth_service/validate;
            proxy_pass_request_body off;
            proxy_set_header Content-Length "";
            proxy_set_header X-Original-URI $request_uri;
        }
        
        # å¥åº·æ£€æŸ¥ç«¯ç‚¹
        location /health {
            access_log off;
            return 200 "healthy\n";
            add_header Content-Type text/plain;
        }
        
        # ç›‘æ§ç«¯ç‚¹
        location /nginx-status {
            stub_status on;
            access_log off;
            allow 192.168.0.0/16;
            deny all;
        }
    }
}
</code></pre>
<h3 data-id="heading-14">Nginx è¯·æ±‚å¤„ç†æµç¨‹</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f50f62bc7b0b4bc1a61dd9709981392c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764037082&amp;x-signature=Y1BjLK0V5lj0S%2F7NiZjTwuF%2B%2BxQ%3D" alt="" loading="lazy"/></p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>æ€§èƒ½æé«˜ï¼ŒCè¯­è¨€ç¼–å†™</li>
<li>é…ç½®ç›¸å¯¹ç®€å•</li>
<li>èµ„æºæ¶ˆè€—ä½</li>
<li>ç¤¾åŒºæˆç†Ÿï¼Œèµ„æ–™ä¸°å¯Œ</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>åŠ¨æ€é…ç½®èƒ½åŠ›å¼±</li>
<li>åŠŸèƒ½ç›¸å¯¹åŸºç¡€</li>
<li>éœ€è¦reloadç”Ÿæ•ˆé…ç½®å˜æ›´</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>é«˜æ€§èƒ½è¦æ±‚çš„ç®€å•è·¯ç”±</li>
<li>é™æ€èµ„æºæœåŠ¡</li>
<li>ä¼ ç»Ÿæ¶æ„å‡çº§</li>
</ul>
<h2 data-id="heading-15">äº”ã€APISIXï¼šäº‘åŸç”ŸAPIç½‘å…³æ–°æ˜Ÿ</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨äº‘åŸç”Ÿç¯å¢ƒä¸­éœ€è¦åŠ¨æ€é…ç½®å’Œé«˜æ€§èƒ½ï¼ŒAPISIXå°±æ˜¯è¿™æ ·ä¸€ä¸ªåŸºäºetcdçš„äº‘åŸç”ŸAPIç½‘å…³ã€‚</p>
<h3 data-id="heading-16">APISIX è·¯ç”±é…ç½®</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># apisix-config.yaml</span>
<span class="hljs-attr">routes:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">uri:</span> <span class="hljs-string">/api/users/*</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">user-service</span>
    <span class="hljs-attr">methods:</span> [<span class="hljs-string">GET</span>, <span class="hljs-string">POST</span>, <span class="hljs-string">PUT</span>, <span class="hljs-string">DELETE</span>]
    <span class="hljs-attr">upstream:</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">roundrobin</span>
      <span class="hljs-attr">nodes:</span>
        <span class="hljs-attr">user-service-1:8080:</span> <span class="hljs-number">1</span>
        <span class="hljs-attr">user-service-2:8080:</span> <span class="hljs-number">2</span>
        <span class="hljs-attr">user-service-3:8080:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">plugins:</span>
      <span class="hljs-attr">proxy-rewrite:</span>
        <span class="hljs-attr">uri:</span> <span class="hljs-string">"/users$1"</span>
      <span class="hljs-attr">limit-count:</span>
        <span class="hljs-attr">count:</span> <span class="hljs-number">100</span>
        <span class="hljs-attr">time_window:</span> <span class="hljs-number">60</span>
        <span class="hljs-attr">key:</span> <span class="hljs-string">remote_addr</span>
        <span class="hljs-attr">rejected_code:</span> <span class="hljs-number">503</span>
      <span class="hljs-attr">jwt-auth:</span>
        <span class="hljs-attr">key:</span> <span class="hljs-string">user-service</span>
        <span class="hljs-attr">secret:</span> <span class="hljs-string">my-secret-key</span>
        <span class="hljs-attr">exp:</span> <span class="hljs-number">86400</span>

  <span class="hljs-bullet">-</span> <span class="hljs-attr">uri:</span> <span class="hljs-string">/api/orders/*</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">order-service</span>  
    <span class="hljs-attr">upstream:</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">chash</span>
      <span class="hljs-attr">key:</span> <span class="hljs-string">arg_user_id</span>
      <span class="hljs-attr">nodes:</span>
        <span class="hljs-attr">order-service-1:8080:</span> <span class="hljs-number">1</span>
        <span class="hljs-attr">order-service-2:8080:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">plugins:</span>
      <span class="hljs-attr">cors:</span>
        <span class="hljs-attr">allow_origins:</span> <span class="hljs-string">"https://example.com"</span>
        <span class="hljs-attr">allow_methods:</span> <span class="hljs-string">"GET,POST,PUT,DELETE"</span>
        <span class="hljs-attr">allow_headers:</span> <span class="hljs-string">"*"</span>
      <span class="hljs-attr">response-rewrite:</span>
        <span class="hljs-attr">body:</span> <span class="hljs-string">'{"code": 0, "message": "success", "data": $body}'</span>
      <span class="hljs-attr">fault-injection:</span>
        <span class="hljs-attr">abort:</span>
          <span class="hljs-attr">http_status:</span> <span class="hljs-number">500</span>
          <span class="hljs-attr">body:</span> <span class="hljs-string">"service unavailable"</span>
          <span class="hljs-attr">percentage:</span> <span class="hljs-number">5</span>

  <span class="hljs-bullet">-</span> <span class="hljs-attr">uri:</span> <span class="hljs-string">/api/products/*</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">product-service</span>
    <span class="hljs-attr">upstream:</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">roundrobin</span>
      <span class="hljs-attr">nodes:</span>
        <span class="hljs-attr">product-service:8080:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">plugins:</span>
      <span class="hljs-attr">proxy-cache:</span>
        <span class="hljs-attr">cache_key:</span> [<span class="hljs-string">"$uri"</span>, <span class="hljs-string">"$args"</span>]
        <span class="hljs-attr">cache_zone:</span> <span class="hljs-string">disk_cache_one</span>
        <span class="hljs-attr">cache_ttl:</span> <span class="hljs-number">300</span>
      <span class="hljs-attr">uri-blocker:</span>
        <span class="hljs-attr">block_rules:</span> [<span class="hljs-string">"^/admin/"</span>, <span class="hljs-string">".php$"</span>]
        <span class="hljs-attr">rejected_code:</span> <span class="hljs-number">403</span>

<span class="hljs-comment"># å…¨å±€æ’ä»¶</span>
<span class="hljs-attr">plugins:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">prometheus</span>
    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">zipkin</span>
    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">endpoint:</span> <span class="hljs-string">http://zipkin:9411/api/v2/spans</span>
      <span class="hljs-attr">sample_ratio:</span> <span class="hljs-number">0.001</span>
</code></pre>
<h3 data-id="heading-17">APISIX æ’ä»¶å¼€å‘</h3>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- apisix/plugins/rate-limit-advanced/init.lua</span>
<span class="hljs-keyword">local</span> core = <span class="hljs-built_in">require</span>(<span class="hljs-string">"apisix.core"</span>)
<span class="hljs-keyword">local</span> plugin_name = <span class="hljs-string">"rate-limit-advanced"</span>

<span class="hljs-keyword">local</span> schema = {
    <span class="hljs-built_in">type</span> = <span class="hljs-string">"object"</span>,
    properties = {
        rate = {<span class="hljs-built_in">type</span> = <span class="hljs-string">"integer"</span>, minimum = <span class="hljs-number">1</span>},
        burst = {<span class="hljs-built_in">type</span> = <span class="hljs-string">"integer"</span>, minimum = <span class="hljs-number">0</span>},
        key = {<span class="hljs-built_in">type</span> = <span class="hljs-string">"string"</span>},
        window = {<span class="hljs-built_in">type</span> = <span class="hljs-string">"integer"</span>, minimum = <span class="hljs-number">1</span>},
        rejected_code = {<span class="hljs-built_in">type</span> = <span class="hljs-string">"integer"</span>, default = <span class="hljs-number">429</span>},
        rejected_msg = {<span class="hljs-built_in">type</span> = <span class="hljs-string">"string"</span>, default = <span class="hljs-string">"rate limit exceeded"</span>}
    },
    required = {<span class="hljs-string">"rate"</span>, <span class="hljs-string">"key"</span>}
}

<span class="hljs-keyword">local</span> _M = {
    version = <span class="hljs-number">1.0</span>,
    priority = <span class="hljs-number">1000</span>,
    name = plugin_name,
    schema = schema,
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_M.check_schema</span><span class="hljs-params">(conf)</span></span>
    <span class="hljs-keyword">return</span> core.schema.check(schema, conf)
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_M.access</span><span class="hljs-params">(conf, ctx)</span></span>
    <span class="hljs-keyword">local</span> key = conf.key
    <span class="hljs-keyword">if</span> key == <span class="hljs-string">"remote_addr"</span> <span class="hljs-keyword">then</span>
        key = ctx.var.remote_addr
    <span class="hljs-keyword">elseif</span> key == <span class="hljs-string">"server_addr"</span> <span class="hljs-keyword">then</span>
        key = ctx.var.server_addr
    <span class="hljs-keyword">end</span>
    
    <span class="hljs-keyword">local</span> rate = conf.rate
    <span class="hljs-keyword">local</span> burst = conf.burst <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>
    <span class="hljs-keyword">local</span> window = conf.window <span class="hljs-keyword">or</span> <span class="hljs-number">60</span>
    
    <span class="hljs-comment">-- ä½¿ç”¨redisè¿›è¡Œåˆ†å¸ƒå¼é™æµ</span>
    <span class="hljs-keyword">local</span> redis = <span class="hljs-built_in">require</span>(<span class="hljs-string">"resty.redis"</span>)
    <span class="hljs-keyword">local</span> red = redis:new()
    
    <span class="hljs-keyword">local</span> ok, err = red:connect(<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-number">6379</span>)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ok <span class="hljs-keyword">then</span>
        core.<span class="hljs-built_in">log</span>.<span class="hljs-built_in">error</span>(<span class="hljs-string">"failed to connect to redis: "</span>, err)
        <span class="hljs-keyword">return</span> <span class="hljs-number">500</span>
    <span class="hljs-keyword">end</span>
    
    <span class="hljs-keyword">local</span> current_time = ngx.now()
    <span class="hljs-keyword">local</span> key_name = <span class="hljs-string">"rate_limit:"</span> .. key
    
    <span class="hljs-comment">-- ä½¿ç”¨ä»¤ç‰Œæ¡¶ç®—æ³•</span>
    <span class="hljs-keyword">local</span> tokens = red:get(key_name)
    <span class="hljs-keyword">if</span> tokens <span class="hljs-keyword">then</span>
        tokens = <span class="hljs-built_in">tonumber</span>(tokens)
    <span class="hljs-keyword">else</span>
        tokens = burst
    <span class="hljs-keyword">end</span>
    
    <span class="hljs-keyword">local</span> last_update = red:get(key_name .. <span class="hljs-string">":time"</span>)
    <span class="hljs-keyword">if</span> last_update <span class="hljs-keyword">then</span>
        last_update = <span class="hljs-built_in">tonumber</span>(last_update)
        <span class="hljs-keyword">local</span> elapsed = current_time - last_update
        <span class="hljs-keyword">local</span> new_tokens = elapsed * rate / window
        
        <span class="hljs-keyword">if</span> new_tokens &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">then</span>
            tokens = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">min</span>(tokens + new_tokens, burst)
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
    
    <span class="hljs-keyword">if</span> tokens &lt; <span class="hljs-number">1</span> <span class="hljs-keyword">then</span>
        red:setex(key_name .. <span class="hljs-string">":time"</span>, window, current_time)
        <span class="hljs-keyword">return</span> conf.rejected_code, conf.rejected_msg
    <span class="hljs-keyword">end</span>
    
    tokens = tokens - <span class="hljs-number">1</span>
    red:setex(key_name, window, tokens)
    red:setex(key_name .. <span class="hljs-string">":time"</span>, window, current_time)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">return</span> _M
</code></pre>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>é…ç½®çƒ­æ›´æ–°ï¼Œæ— éœ€é‡å¯</li>
<li>æ€§èƒ½å“è¶Š</li>
<li>æ’ä»¶ç”Ÿæ€ä¸°å¯Œ</li>
<li>äº‘åŸç”Ÿå‹å¥½</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>ç›¸å¯¹è¾ƒæ–°ï¼Œç”Ÿæ€ä¸å¦‚Kongæˆç†Ÿ</li>
<li>ä¾èµ–etcd</li>
<li>å­¦ä¹ æˆæœ¬è¾ƒé«˜</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>äº‘åŸç”Ÿç¯å¢ƒ</li>
<li>éœ€è¦åŠ¨æ€é…ç½®çš„åœºæ™¯</li>
<li>é«˜æ€§èƒ½è¦æ±‚çš„å¾®æœåŠ¡æ¶æ„</li>
</ul>
<h2 data-id="heading-18">å…­ã€Zuulï¼šNetflixç»å…¸ç½‘å…³</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨ä¼ ç»ŸSpring Cloudé¡¹ç›®ä¸­å¯èƒ½è¿˜åœ¨ä½¿ç”¨Zuulï¼Œè™½ç„¶å®ƒå·²è¢«Spring Cloud Gatewayå–ä»£ï¼Œä½†äº†è§£å…¶åŸç†ä»æœ‰ä»·å€¼ã€‚</p>
<h3 data-id="heading-19">Zuul è¿‡æ»¤å™¨å®æˆ˜</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Zuulå‰ç½®è¿‡æ»¤å™¨ - è®¤è¯å’Œé™æµ</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthPreFilter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ZuulFilter</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RateLimiterService rateLimiter;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> JwtTokenProvider tokenProvider;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filterType</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"pre"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">filterOrder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldFilter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">run</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ZuulException {
        <span class="hljs-type">RequestContext</span> <span class="hljs-variable">ctx</span> <span class="hljs-operator">=</span> RequestContext.getCurrentContext();
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> ctx.getRequest();
        
        <span class="hljs-comment">// 1. é™æµæ£€æŸ¥</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">clientId</span> <span class="hljs-operator">=</span> getClientId(request);
        <span class="hljs-keyword">if</span> (!rateLimiter.tryAcquire(clientId)) {
            ctx.setSendZuulResponse(<span class="hljs-literal">false</span>);
            ctx.setResponseStatusCode(<span class="hljs-number">429</span>);
            ctx.setResponseBody(<span class="hljs-string">"{\"error\": \"Rate limit exceeded\"}"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        
        <span class="hljs-comment">// 2. JWTè®¤è¯</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> extractToken(request);
        <span class="hljs-keyword">if</span> (token == <span class="hljs-literal">null</span> &amp;&amp; requiresAuth(request)) {
            ctx.setSendZuulResponse(<span class="hljs-literal">false</span>);
            ctx.setResponseStatusCode(<span class="hljs-number">401</span>);
            ctx.setResponseBody(<span class="hljs-string">"{\"error\": \"Authentication required\"}"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        
        <span class="hljs-keyword">if</span> (token != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-type">Claims</span> <span class="hljs-variable">claims</span> <span class="hljs-operator">=</span> tokenProvider.parseToken(token);
                ctx.addZuulRequestHeader(<span class="hljs-string">"X-User-Id"</span>, claims.getSubject());
                ctx.addZuulRequestHeader(<span class="hljs-string">"X-User-Roles"</span>, 
                    String.join(<span class="hljs-string">","</span>, claims.get(<span class="hljs-string">"roles"</span>, List.class)));
            } <span class="hljs-keyword">catch</span> (Exception e) {
                ctx.setSendZuulResponse(<span class="hljs-literal">false</span>);
                ctx.setResponseStatusCode(<span class="hljs-number">401</span>);
                ctx.setResponseBody(<span class="hljs-string">"{\"error\": \"Invalid token\"}"</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            }
        }
        
        <span class="hljs-comment">// 3. æ·»åŠ è¿½è¸ªä¿¡æ¯</span>
        ctx.addZuulRequestHeader(<span class="hljs-string">"X-Request-ID"</span>, UUID.randomUUID().toString());
        ctx.addZuulRequestHeader(<span class="hljs-string">"X-Forwarded-For"</span>, request.getRemoteAddr());
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getClientId</span><span class="hljs-params">(HttpServletRequest request)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">apiKey</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"X-API-Key"</span>);
        <span class="hljs-keyword">return</span> apiKey != <span class="hljs-literal">null</span> ? apiKey : request.getRemoteAddr();
    }
    
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">extractToken</span><span class="hljs-params">(HttpServletRequest request)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">bearerToken</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"Authorization"</span>);
        <span class="hljs-keyword">if</span> (bearerToken != <span class="hljs-literal">null</span> &amp;&amp; bearerToken.startsWith(<span class="hljs-string">"Bearer "</span>)) {
            <span class="hljs-keyword">return</span> bearerToken.substring(<span class="hljs-number">7</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">requiresAuth</span><span class="hljs-params">(HttpServletRequest request)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> request.getRequestURI();
        <span class="hljs-keyword">return</span> !path.startsWith(<span class="hljs-string">"/api/public/"</span>) &amp;&amp; 
               !path.equals(<span class="hljs-string">"/health"</span>) &amp;&amp; 
               !path.startsWith(<span class="hljs-string">"/actuator/"</span>);
    }
}

<span class="hljs-comment">// Zuulåç½®è¿‡æ»¤å™¨ - å“åº”å¤„ç†</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResponsePostFilter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ZuulFilter</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(ResponsePostFilter.class);
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filterType</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"post"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">filterOrder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">1000</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldFilter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">run</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ZuulException {
        <span class="hljs-type">RequestContext</span> <span class="hljs-variable">ctx</span> <span class="hljs-operator">=</span> RequestContext.getCurrentContext();
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> ctx.getRequest();
        <span class="hljs-type">HttpServletResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> ctx.getResponse();
        
        <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> (Long) ctx.get(<span class="hljs-string">"startTime"</span>);
        <span class="hljs-type">long</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> System.currentTimeMillis() - startTime;
        
        <span class="hljs-comment">// è®°å½•è®¿é—®æ—¥å¿—</span>
        logger.info(<span class="hljs-string">"{} {} {} {} {}ms"</span>, 
            request.getRemoteAddr(),
            request.getMethod(),
            request.getRequestURI(),
            response.getStatus(),
            duration);
        
        <span class="hljs-comment">// æ·»åŠ å“åº”å¤´</span>
        response.setHeader(<span class="hljs-string">"X-Response-Time"</span>, duration + <span class="hljs-string">"ms"</span>);
        response.setHeader(<span class="hljs-string">"X-API-Version"</span>, <span class="hljs-string">"1.0"</span>);
        
        <span class="hljs-comment">// ç»Ÿä¸€å“åº”æ ¼å¼</span>
        <span class="hljs-keyword">if</span> (ctx.getResponseBody() != <span class="hljs-literal">null</span> &amp;&amp; 
            response.getContentType() != <span class="hljs-literal">null</span> &amp;&amp; 
            response.getContentType().contains(<span class="hljs-string">"application/json"</span>)) {
            
            <span class="hljs-type">String</span> <span class="hljs-variable">originalBody</span> <span class="hljs-operator">=</span> ctx.getResponseBody();
            <span class="hljs-type">String</span> <span class="hljs-variable">wrappedBody</span> <span class="hljs-operator">=</span> <span class="hljs-string">"{\"code\": 0, \"data\": "</span> + originalBody + <span class="hljs-string">", \"timestamp\": "</span> + 
                System.currentTimeMillis() + <span class="hljs-string">"}"</span>;
            ctx.setResponseBody(wrappedBody);
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>ä¸Netflixé›†æˆè‰¯å¥½</li>
<li>è¿‡æ»¤å™¨æœºåˆ¶çµæ´»</li>
<li>æ–‡æ¡£èµ„æ–™ä¸°å¯Œ</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>æ€§èƒ½è¾ƒå·®ï¼ˆé˜»å¡IOï¼‰</li>
<li>å·²è¢«Spring Cloud Gatewayå–ä»£</li>
<li>ç¤¾åŒºæ´»è·ƒåº¦ä¸‹é™</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>é—ç•™Spring Cloudé¡¹ç›®</li>
<li>NetflixæŠ€æœ¯æ ˆ</li>
<li>éæ€§èƒ½æ•æ„Ÿåœºæ™¯</li>
</ul>
<h2 data-id="heading-20">ä¸ƒã€Traefikï¼šäº‘åŸç”ŸåŠ¨æ€ç½‘å…³</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨å®¹å™¨åŒ–ç¯å¢ƒä¸­éœ€è¦è‡ªåŠ¨æœåŠ¡å‘ç°ï¼ŒTraefikå°±æ˜¯ä¸ºäº‘åŸç”Ÿè€Œç”Ÿçš„åŠ¨æ€ç½‘å…³ã€‚</p>
<h3 data-id="heading-21">Traefik é…ç½®ç¤ºä¾‹</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># traefik.yaml</span>
<span class="hljs-attr">api:</span>
  <span class="hljs-attr">dashboard:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">insecure:</span> <span class="hljs-literal">true</span>

<span class="hljs-attr">entryPoints:</span>
  <span class="hljs-attr">web:</span>
    <span class="hljs-attr">address:</span> <span class="hljs-string">":80"</span>
    <span class="hljs-attr">http:</span>
      <span class="hljs-attr">redirections:</span>
        <span class="hljs-attr">entryPoint:</span>
          <span class="hljs-attr">to:</span> <span class="hljs-string">websecure</span>
          <span class="hljs-attr">scheme:</span> <span class="hljs-string">https</span>
          
  <span class="hljs-attr">websecure:</span>
    <span class="hljs-attr">address:</span> <span class="hljs-string">":443"</span>

<span class="hljs-attr">certificatesResolvers:</span>
  <span class="hljs-attr">myresolver:</span>
    <span class="hljs-attr">acme:</span>
      <span class="hljs-attr">email:</span> <span class="hljs-string">admin@example.com</span>
      <span class="hljs-attr">storage:</span> <span class="hljs-string">/etc/traefik/acme.json</span>
      <span class="hljs-attr">httpChallenge:</span>
        <span class="hljs-attr">entryPoint:</span> <span class="hljs-string">web</span>

<span class="hljs-attr">providers:</span>
  <span class="hljs-attr">docker:</span>
    <span class="hljs-attr">endpoint:</span> <span class="hljs-string">"unix:///var/run/docker.sock"</span>
    <span class="hljs-attr">exposedByDefault:</span> <span class="hljs-literal">false</span>
    
  <span class="hljs-attr">file:</span>
    <span class="hljs-attr">filename:</span> <span class="hljs-string">/etc/traefik/dynamic.yaml</span>
    <span class="hljs-attr">watch:</span> <span class="hljs-literal">true</span>

<span class="hljs-attr">log:</span>
  <span class="hljs-attr">level:</span> <span class="hljs-string">INFO</span>

<span class="hljs-attr">accessLog:</span>
  <span class="hljs-attr">filePath:</span> <span class="hljs-string">"/var/log/traefik/access.log"</span>
  <span class="hljs-attr">bufferingSize:</span> <span class="hljs-number">100</span>

<span class="hljs-attr">metrics:</span>
  <span class="hljs-attr">prometheus:</span>
    <span class="hljs-attr">entryPoint:</span> <span class="hljs-string">websecure</span>

<span class="hljs-comment"># åŠ¨æ€é…ç½®</span>
<span class="hljs-comment"># dynamic.yaml</span>
<span class="hljs-attr">http:</span>
  <span class="hljs-attr">middlewares:</span>
    <span class="hljs-comment"># è®¤è¯ä¸­é—´ä»¶</span>
    <span class="hljs-attr">auth-middleware:</span>
      <span class="hljs-attr">basicAuth:</span>
        <span class="hljs-attr">users:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-string">"admin:$2y$05$YOUR_HASHED_PASSWORD"</span>
          
    <span class="hljs-comment"># é™æµä¸­é—´ä»¶  </span>
    <span class="hljs-attr">rate-limit-middleware:</span>
      <span class="hljs-attr">rateLimit:</span>
        <span class="hljs-attr">burst:</span> <span class="hljs-number">100</span>
        <span class="hljs-attr">period:</span> <span class="hljs-string">1m</span>
        
    <span class="hljs-comment"># é‡è¯•ä¸­é—´ä»¶</span>
    <span class="hljs-attr">retry-middleware:</span>
      <span class="hljs-attr">retry:</span>
        <span class="hljs-attr">attempts:</span> <span class="hljs-number">3</span>
        
    <span class="hljs-comment"># ç†”æ–­ä¸­é—´ä»¶</span>
    <span class="hljs-attr">circuit-breaker-middleware:</span>
      <span class="hljs-attr">circuitBreaker:</span>
        <span class="hljs-attr">expression:</span> <span class="hljs-string">"NetworkErrorRatio() &gt; 0.5"</span>
        
    <span class="hljs-comment"># å‹ç¼©ä¸­é—´ä»¶</span>
    <span class="hljs-attr">compress-middleware:</span>
      <span class="hljs-attr">compress:</span> {}

  <span class="hljs-attr">routers:</span>
    <span class="hljs-comment"># ç”¨æˆ·æœåŠ¡è·¯ç”±</span>
    <span class="hljs-attr">user-service:</span>
      <span class="hljs-attr">rule:</span> <span class="hljs-string">"PathPrefix(`/api/users`)"</span>
      <span class="hljs-attr">entryPoints:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">websecure</span>
      <span class="hljs-attr">middlewares:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">rate-limit-middleware</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">compress-middleware</span>
      <span class="hljs-attr">service:</span> <span class="hljs-string">user-service</span>
      <span class="hljs-attr">tls:</span>
        <span class="hljs-attr">certResolver:</span> <span class="hljs-string">myresolver</span>
        
    <span class="hljs-comment"># è®¢å•æœåŠ¡è·¯ç”±  </span>
    <span class="hljs-attr">order-service:</span>
      <span class="hljs-attr">rule:</span> <span class="hljs-string">"PathPrefix(`/api/orders`)"</span>
      <span class="hljs-attr">entryPoints:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">websecure</span>
      <span class="hljs-attr">middlewares:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">auth-middleware</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">rate-limit-middleware</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">circuit-breaker-middleware</span>
      <span class="hljs-attr">service:</span> <span class="hljs-string">order-service</span>
      <span class="hljs-attr">tls:</span>
        <span class="hljs-attr">certResolver:</span> <span class="hljs-string">myresolver</span>

  <span class="hljs-attr">services:</span>
    <span class="hljs-attr">user-service:</span>
      <span class="hljs-attr">loadBalancer:</span>
        <span class="hljs-attr">servers:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">"http://user-service-1:8080"</span>
          <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">"http://user-service-2:8080"</span>
        <span class="hljs-attr">healthCheck:</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">/health</span>
          <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span>
          <span class="hljs-attr">timeout:</span> <span class="hljs-string">5s</span>
          
    <span class="hljs-attr">order-service:</span>
      <span class="hljs-attr">loadBalancer:</span>
        <span class="hljs-attr">servers:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">"http://order-service-1:8080"</span>
          <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">"http://order-service-2:8080"</span>
</code></pre>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>è‡ªåŠ¨æœåŠ¡å‘ç°</li>
<li>é…ç½®ç®€å•</li>
<li>äº‘åŸç”Ÿå‹å¥½</li>
<li>å†…ç½®ç›‘æ§å’ŒDashboard</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>åŠŸèƒ½ç›¸å¯¹ç®€å•</li>
<li>æ€§èƒ½ä¸å¦‚Nginxç³»ç½‘å…³</li>
<li>é«˜çº§åŠŸèƒ½éœ€è¦ä¼ä¸šç‰ˆ</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>å®¹å™¨åŒ–ç¯å¢ƒ</li>
<li>éœ€è¦è‡ªåŠ¨æœåŠ¡å‘ç°çš„åœºæ™¯</li>
<li>å¿«é€ŸåŸå‹å¼€å‘</li>
</ul>
<h2 data-id="heading-22">å…«ã€6å¤§ç½‘å…³å¯¹æ¯”</h2>
<p>é€šè¿‡å‰é¢çš„åˆ†æï¼Œæˆ‘ä»¬ç°åœ¨å¯¹è¿™å…­ç§APIç½‘å…³æœ‰äº†æ·±å…¥çš„äº†è§£ã€‚</p>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå…¨é¢çš„å¯¹æ¯”æ¥å¸®åŠ©å¤§å®¶åšå‡ºæ­£ç¡®çš„æŠ€æœ¯é€‰å‹ã€‚</p>
<h3 data-id="heading-23">è¯¦ç»†å¯¹æ¯”è¡¨æ ¼</h3>













































































<table><thead><tr><th>ç‰¹æ€§ç»´åº¦</th><th>Spring Cloud Gateway</th><th>Kong</th><th>Nginx</th><th>APISIX</th><th>Zuul</th><th>Traefik</th></tr></thead><tbody><tr><td><strong>æ€§èƒ½</strong></td><td>é«˜ï¼ˆWebFluxï¼‰</td><td>æé«˜ï¼ˆNginxï¼‰</td><td>æé«˜ï¼ˆCï¼‰</td><td>æé«˜ï¼ˆNginxï¼‰</td><td>ä¸­ï¼ˆé˜»å¡IOï¼‰</td><td>ä¸­</td></tr><tr><td><strong>é…ç½®æ–¹å¼</strong></td><td>ä»£ç /é…ç½®</td><td>å£°æ˜å¼YAML</td><td>é…ç½®æ–‡ä»¶</td><td>åŠ¨æ€é…ç½®</td><td>ä»£ç /é…ç½®</td><td>åŠ¨æ€é…ç½®</td></tr><tr><td><strong>æœåŠ¡å‘ç°</strong></td><td>Spring Cloud</td><td>æ’ä»¶æ”¯æŒ</td><td>éœ€æ‰‹åŠ¨é…ç½®</td><td>æ”¯æŒ</td><td>Spring Cloud</td><td>è‡ªåŠ¨å‘ç°</td></tr><tr><td><strong>K8sæ”¯æŒ</strong></td><td>è‰¯å¥½</td><td>è‰¯å¥½</td><td>éœ€Ingress</td><td>ä¼˜ç§€</td><td>ä¸€èˆ¬</td><td>ä¼˜ç§€</td></tr><tr><td><strong>ç›‘æ§</strong></td><td>Micrometer</td><td>Prometheus</td><td>åŸºç¡€ç›‘æ§</td><td>Prometheus</td><td>Hystrix</td><td>å†…ç½®</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>ä¸­</td><td>ä¸­é«˜</td><td>ä½</td><td>ä¸­é«˜</td><td>ä¸­</td><td>ä½</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>Spring Cloud</td><td>ä¼ä¸šçº§</td><td>ä¼ ç»Ÿæ¶æ„</td><td>äº‘åŸç”Ÿ</td><td>ä¼ ç»ŸSpring</td><td>å®¹å™¨åŒ–</td></tr></tbody></table>
<h3 data-id="heading-24">é€‰å‹å†³ç­–æŒ‡å—</h3>
<p><strong>é€‰æ‹©Spring Cloud Gatewayå½“ï¼š</strong></p>
<ul>
<li>æŠ€æœ¯æ ˆä»¥Springä¸ºä¸»</li>
<li>éœ€è¦æ·±åº¦å®šåˆ¶ç½‘å…³é€»è¾‘</li>
<li>å·²ç»ä½¿ç”¨Spring Cloudç»„ä»¶</li>
<li>å›¢é˜Ÿç†Ÿæ‚‰å“åº”å¼ç¼–ç¨‹</li>
</ul>
<p><strong>é€‰æ‹©Kongå½“ï¼š</strong></p>
<ul>
<li>ä¼ä¸šçº§é«˜å¹¶å‘åœºæ™¯</li>
<li>éœ€è¦ä¸°å¯Œæ’ä»¶ç”Ÿæ€</li>
<li>æœ‰ä¸“ä¸šè¿ç»´å›¢é˜Ÿ</li>
<li>éœ€è¦æˆç†Ÿçš„ç®¡ç†ç•Œé¢</li>
</ul>
<p><strong>é€‰æ‹©Nginxå½“ï¼š</strong></p>
<ul>
<li>æ€§èƒ½è¦æ±‚æé«˜</li>
<li>åœºæ™¯ç›¸å¯¹ç®€å•</li>
<li>å›¢é˜Ÿç†Ÿæ‚‰Nginx</li>
<li>èµ„æºå—é™ç¯å¢ƒ</li>
</ul>
<p><strong>é€‰æ‹©APISIXå½“ï¼š</strong></p>
<ul>
<li>äº‘åŸç”Ÿç¯å¢ƒ</li>
<li>éœ€è¦åŠ¨æ€é…ç½®</li>
<li>è¿½æ±‚æœ€æ–°æŠ€æœ¯</li>
<li>é«˜æ€§èƒ½è¦æ±‚</li>
</ul>
<p><strong>é€‰æ‹©Zuulå½“ï¼š</strong></p>
<ul>
<li>ç»´æŠ¤é—ç•™Spring Cloudé¡¹ç›®</li>
<li>NetflixæŠ€æœ¯æ ˆ</li>
<li>éæ€§èƒ½æ•æ„Ÿåœºæ™¯</li>
</ul>
<p><strong>é€‰æ‹©Traefikå½“ï¼š</strong></p>
<ul>
<li>å®¹å™¨åŒ–éƒ¨ç½²</li>
<li>éœ€è¦è‡ªåŠ¨æœåŠ¡å‘ç°</li>
<li>å¿«é€Ÿå¼€å‘éƒ¨ç½²</li>
<li>é…ç½®ç®€å•è¦æ±‚</li>
</ul>
<h2 data-id="heading-25">æ€»ç»“</h2>
<p>é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯¹6ç§ä¸»æµAPIç½‘å…³æœ‰äº†å…¨é¢çš„è®¤è¯†ã€‚</p>
<p>åœ¨é€‰æ‹©ç½‘å…³æ—¶éœ€è¦è€ƒè™‘ä»¥ä¸‹å…³é”®å› ç´ ï¼š</p>
<ol>
<li><strong>æŠ€æœ¯æ ˆåŒ¹é…</strong>ï¼šé€‰æ‹©ä¸å›¢é˜ŸæŠ€æœ¯æ ˆæœ€åŒ¹é…çš„æ–¹æ¡ˆ</li>
<li><strong>æ€§èƒ½è¦æ±‚</strong>ï¼šæ ¹æ®ä¸šåŠ¡å¹¶å‘é‡é€‰æ‹©æ€§èƒ½åˆé€‚çš„ç½‘å…³</li>
<li><strong>åŠŸèƒ½éœ€æ±‚</strong>ï¼šè¯„ä¼°éœ€è¦çš„åŠŸèƒ½ç‰¹æ€§ï¼Œå¦‚é™æµã€è®¤è¯ã€ç›‘æ§ç­‰</li>
<li><strong>è¿ç»´æˆæœ¬</strong>ï¼šè€ƒè™‘éƒ¨ç½²ã€ç›‘æ§ã€ç»´æŠ¤çš„å¤æ‚åº¦</li>
<li><strong>å›¢é˜Ÿèƒ½åŠ›</strong>ï¼šè¯„ä¼°å›¢é˜Ÿå¯¹ç½‘å…³æŠ€æœ¯çš„æŒæ¡ç¨‹åº¦</li>
</ol>
<h3 data-id="heading-26">æ ¸å¿ƒå»ºè®®</h3>
<ol>
<li><strong>æ–°é¡¹ç›®ä¼˜å…ˆè€ƒè™‘</strong>ï¼šSpring Cloud Gatewayï¼ˆSpringæŠ€æœ¯æ ˆï¼‰æˆ– APISIXï¼ˆäº‘åŸç”Ÿï¼‰</li>
<li><strong>é«˜å¹¶å‘åœºæ™¯</strong>ï¼šKong æˆ– Nginx</li>
<li><strong>å¿«é€ŸåŸå‹</strong>ï¼šTraefik</li>
<li><strong>é—ç•™ç³»ç»Ÿ</strong>ï¼šæ ¹æ®ç°æœ‰æŠ€æœ¯æ ˆé€‰æ‹©</li>
</ol>
<p>è®°ä½ï¼Œæ²¡æœ‰æœ€å¥½çš„ç½‘å…³ï¼Œåªæœ‰æœ€åˆé€‚çš„ç½‘å…³ã€‚</p>
<p>åˆç†çš„ç½‘å…³é€‰å‹å¯ä»¥å¤§å¤§æå‡ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œæ€§èƒ½è¡¨ç°ã€‚</p>
<h2 data-id="heading-27">æœ€åè¯´ä¸€å¥(æ±‚å…³æ³¨ï¼Œåˆ«ç™½å«–æˆ‘)</h2>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæˆ–è€…æœ‰æ‰€å¯å‘çš„è¯ï¼Œå¸®å¿™å…³æ³¨ä¸€ä¸‹æˆ‘çš„åŒåå…¬ä¼—å·ï¼šè‹ä¸‰è¯´æŠ€æœ¯ï¼Œæ‚¨çš„æ”¯æŒæ˜¯æˆ‘åšæŒå†™ä½œæœ€å¤§çš„åŠ¨åŠ›ã€‚</p>
<p>æ±‚ä¸€é”®ä¸‰è¿ï¼šç‚¹èµã€è½¬å‘ã€åœ¨çœ‹ã€‚</p>
<p>å…³æ³¨å…¬ä¼—å·ï¼šã€è‹ä¸‰è¯´æŠ€æœ¯ã€‘ï¼Œåœ¨å…¬ä¼—å·ä¸­å›å¤ï¼šè¿›å¤§å‚ï¼Œå¯ä»¥å…è´¹è·å–æˆ‘æœ€è¿‘æ•´ç†çš„10ä¸‡å­—çš„é¢è¯•å®å…¸ï¼Œå¥½å¤šå°ä¼™ä¼´é è¿™ä¸ªå®å…¸æ‹¿åˆ°äº†å¤šå®¶å¤§å‚çš„offerã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Fix: ä¿®å¤AIèŠå¤©è¾“å…¥æ¡†Safariå›è½¦å‘é€bug]]></title>    <link>https://juejin.cn/post/7573524348130115647</link>    <guid>https://juejin.cn/post/7573524348130115647</guid>    <pubDate>2025-11-17T16:47:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573524348130115647" data-draft-id="7573535624532492307" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Fix: ä¿®å¤AIèŠå¤©è¾“å…¥æ¡†Safariå›è½¦å‘é€bug"/> <meta itemprop="keywords" content="å‰ç«¯,DOM,JavaScript"/> <meta itemprop="datePublished" content="2025-11-17T16:47:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é»‘ç¾½åŒå­¦"/> <meta itemprop="url" content="https://juejin.cn/user/3008684729329512"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Fix: ä¿®å¤AIèŠå¤©è¾“å…¥æ¡†Safariå›è½¦å‘é€bug
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3008684729329512/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é»‘ç¾½åŒå­¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T16:47:26.000Z" title="Mon Nov 17 2025 16:47:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:18px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:40px;margin-bottom:20px;color:#007fff;display:flex;align-items:center}.markdown-body h1:hover:before,.markdown-body h2:hover:before,.markdown-body h3:hover:before,.markdown-body h4:hover:before,.markdown-body h5:hover:before,.markdown-body h6:hover:before{transition:All .4s ease-in-out;transform:rotate(1turn)}.markdown-body h1{font-size:30px;background:linear-gradient(#fff 60%,#c6e3ff 0)}.markdown-body h1:before{content:"";display:inline-block;width:32px;height:32px;margin-right:10px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC");background-size:100% 100%}.markdown-body h2{font-size:24px;background:linear-gradient(#fff 60%,#cce3fb 0)}.markdown-body h2:before{content:"";display:inline-block;width:24px;height:24px;margin-right:10px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC");background-size:100% 100%}.markdown-body h3{font-size:20px}.markdown-body h3:before{content:"";display:inline-block;width:18px;height:18px;margin-right:10px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC");background-size:100% 100%}.markdown-body h4{font-size:18px}.markdown-body h4:before{content:"";display:inline-block;width:16px;height:16px;margin-right:10px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC");background-size:100% 100%}.markdown-body h5{font-size:16px}.markdown-body h5:before{content:"";display:inline-block;width:15px;height:15px;margin-right:10px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC");background-size:100% 100%}.markdown-body h6{font-size:14px}.markdown-body h6:before{content:"";display:inline-block;width:12px;height:12px;margin-right:10px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC");background-size:100% 100%}.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{border-bottom:2px solid #007fff;color:#007fff;padding-right:10px}.markdown-body p{letter-spacing:1px;line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:10px auto}.markdown-body hr{border:none;border-top:1px dashed #92c8ff}.markdown-body hr:before{content:"âœ‚";display:inline-block;position:relative;top:-12px;left:40px;padding:0 3px;color:#007fff;font-size:18px}.markdown-body hr:after{content:"æŒ‰è™šçº¿å‰ªå¼€";position:relative;top:-15px;left:84%;padding:0 3px;color:#007fff;font-size:12px}.markdown-body del{color:#f44}.markdown-body em{color:#007fff;margin:0 2px}.markdown-body strong{color:#007fff;font-weight:bolder}.markdown-body code{word-break:break-word;border-radius:4px;overflow-x:auto;background-color:#e6f3ff;color:#007fff;font-weight:600;font-size:16px;padding:.065em .4em;border:1px solid #007fff}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:5px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:18px;font-weight:400;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8;border:none}.markdown-body a{text-decoration:none;color:#007fff;border-bottom:1px solid #007fff}.markdown-body a:before{content:"Â¶";margin-right:5px;font-size:22px}.markdown-body a:after{content:"â†·";margin-left:2px;font-size:22px;display:none}.markdown-body a:active,.markdown-body a:hover{color:#275b8c;border-bottom:1px solid #275b8c}.markdown-body a:active:after,.markdown-body a:hover:after{display:inline-block}.markdown-body table{display:inline-block!important;font-size:16px;width:auto;max-width:100%;overflow:auto;border:1px solid #a5d3ff}.markdown-body thead{background:#c6e3ff;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#eef7ff}.markdown-body tbody&gt;tr:nth-child(odd){background-color:#f8fcff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #007fff;background-color:#eef7ff}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#007fff}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="vs2015">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1e1e1e;color:#dcdcdc}.hljs-keyword,.hljs-link,.hljs-literal,.hljs-name,.hljs-symbol{color:#569cd6}.hljs-link{text-decoration:underline}.hljs-built_in,.hljs-type{color:#4ec9b0}.hljs-class,.hljs-number{color:#b8d7a3}.hljs-meta-string,.hljs-string{color:#d69d85}.hljs-regexp,.hljs-template-tag{color:#9a5334}.hljs-formula,.hljs-function,.hljs-params,.hljs-subst,.hljs-title{color:#dcdcdc}.hljs-comment,.hljs-quote{color:#57a64a;font-style:italic}.hljs-doctag{color:#608b4e}.hljs-meta,.hljs-meta-keyword,.hljs-tag{color:#9b9b9b}.hljs-template-variable,.hljs-variable{color:#bd63c5}.hljs-attr,.hljs-attribute,.hljs-builtin-name{color:#9cdcfe}.hljs-section{color:gold}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-bullet,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-selector-tag{color:#d7ba7d}.hljs-addition{background-color:#144212}.hljs-addition,.hljs-deletion{display:inline-block;width:100%}.hljs-deletion{background-color:#600}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>AIèŠå¤©è¾“å…¥æ¡†åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦æ”¯æŒç”¨æˆ·æŒ‰ä¸‹enterå›è½¦çš„å¿«æ·å‘é€ï¼Œé€šè¿‡é”®ç›˜äº‹ä»¶å®ç°</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
    @<span class="hljs-attr">keydown</span>=<span class="hljs-string">"onInputKeydown"</span>
    <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å†…å®¹ï¼ŒæŒ‰ Enter å‘é€ï¼ŒShift + Enter æ¢è¡Œ"</span>
&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å›è½¦å‘é€</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onInputKeydown</span> = (<span class="hljs-params">event</span>) =&gt; {
  <span class="hljs-keyword">if</span>(event.<span class="hljs-property">key</span> === <span class="hljs-string">"Enter"</span> || event.<span class="hljs-property">keyCode</span> === <span class="hljs-string">'13'</span>) {
    <span class="hljs-keyword">if</span>(event.<span class="hljs-property">shiftKey</span>) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// shift + enter ä»…æ¢è¡Œ</span>
    event.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-title function_">sendMessage</span>(); <span class="hljs-comment">// å‘é€å¤„ç†</span>
  }
}
</code></pre>
<h2 data-id="heading-1">é—®é¢˜</h2>
<p>ä½†å®é™…ä¸Šenterä½œä¸ºç¡®è®¤æ“ä½œï¼Œé™¤äº†ç¡®è®¤å†…å®¹å‘é€åŠ¨ä½œï¼Œè¿˜æœ‰ç¡®è®¤è¾“å…¥æ³•è¾“å…¥çš„åŠ¨ä½œï¼›</p>
<p>å¦‚ç”¨æˆ·åœ¨è¾“å…¥æ³•è¾“å…¥çŠ¶æ€ä¸‹ï¼ŒæŒ‰ä¸‹enteræœŸæœ›ç¡®è®¤è¾“å…¥å†…å®¹åˆ°æ–‡æœ¬æ¡†ï¼Œæ­¤æ—¶ä¹Ÿä¼šè§¦å‘ä¸Šé¢çš„å‘é€é€»è¾‘å¯¼è‡´å†…å®¹å†…å‘é€å‡ºå»ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ <code>onInputKeydown</code> åŠ ä¸€ä¸ªåˆæˆçŠ¶æ€ï¼ˆ<code>isComposing</code>ï¼‰åˆ¤æ–­</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">onInputKeydown</span> = (<span class="hljs-params">event</span>) =&gt; {
  <span class="hljs-keyword">if</span>(event.<span class="hljs-property">key</span> === <span class="hljs-string">"Enter"</span> || event.<span class="hljs-property">keyCode</span> === <span class="hljs-string">'13'</span>) {
    <span class="hljs-keyword">if</span>(event.<span class="hljs-property">shiftKey</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span>(event.<span class="hljs-property">isComposing</span>) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// æ­¤æ¬¡ä¸ºè¾“å…¥æ³•çŠ¶æ€ä¸‹çš„enter(å³è¾“å…¥æ³•åˆæˆçŠ¶æ€)ï¼Œä¸å‘é€å†…å®¹</span>
    event.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-title function_">sendMessage</span>();
  }
}
</code></pre>
<p>è¿™ç¡®å®æœ‰æ•ˆï¼Œä½†æ˜¯åœ¨Safariä¸‹é”®ç›˜è¾“å…¥æ–‡å­—ï¼ˆå¦‚è¾“å…¥è‹±æ–‡ï¼‰ä¸”åœ¨è¾“å…¥æ³•åˆæˆçŠ¶æ€ï¼ŒæŒ‰ä¸‹enterå†…å®¹ä¾æ—§è¢«å‘é€äº†ï¼åŸå› åœ¨äº <code>event.isComposing</code> åœ¨Safariå¹¶ä¸å¯ä¿¡ï¼Œå¯¼è‡´ä¸å¯ç”¨ï¼›</p>
<h2 data-id="heading-2">å»¶å±•</h2>
<p>é‚£ä¹ˆè§£å†³Safariä¸Šè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»Safariä¸Šå®ç°å¯ä¿¡çš„isComposingï¼›</p>
<p>å°è¯•é€šè¿‡ç›‘å¬ <code>composotionstart/compositionend</code> å®ç°è‡ªå·±çš„ Composing çŠ¶æ€ï¼Œä½†äº‹å®æ˜¯ä¸å¯è¡Œï¼ˆSafariçš„compositionäº‹ä»¶ä¸keydownã€inputç­‰äº‹ä»¶æ‰§è¡Œé¡ºåºé—®é¢˜ï¼‰ï¼›</p>
<p>ä½†æ˜¯inputäº‹ä»¶æœ‰ <code>inputType</code> å¯åˆ¤æ–­åˆ°è¾“å…¥æ³•çŠ¶æ€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FInputEvent%2FinputType" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/InputEvent/inputType" ref="nofollow noopener noreferrer">MDN inputType</a>ã€‚</p>
<p>æœ€ç»ˆå®ç°ï¼šé¢å¤–ç›‘å¬inputäº‹ä»¶(å…ˆäºkeydownäº‹ä»¶)ï¼Œé’ˆå¯¹Safariä½¿ç”¨è‡ªå·±å®ç°çš„ComposingçŠ¶æ€åˆ¤æ–­æ˜¯å¦ä¸ºè¾“å…¥æ³•åˆæˆä¸‹enter</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
    @<span class="hljs-attr">input</span>=<span class="hljs-string">"onInput"</span>
    @<span class="hljs-attr">keydown</span>=<span class="hljs-string">"onInputKeydown"</span>
    <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å†…å®¹ï¼ŒæŒ‰ Enter å‘é€ï¼ŒShift + Enter æ¢è¡Œ"</span>
&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¼•å…¥æµè§ˆå™¨æ£€æµ‹åº“</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UAParser</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'ua-parser-js'</span>;
<span class="hljs-keyword">const</span> parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UAParser</span>();
<span class="hljs-keyword">const</span> result = parser.<span class="hljs-title function_">getResult</span>();

<span class="hljs-comment">// å›è½¦å‘é€</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onInputKeydown</span> = (<span class="hljs-params">event</span>) =&gt; {
  <span class="hljs-keyword">if</span>(event.<span class="hljs-property">key</span> === <span class="hljs-string">"Enter"</span> || event.<span class="hljs-property">keyCode</span> === <span class="hljs-string">'13'</span>) {
    <span class="hljs-keyword">if</span>(event.<span class="hljs-property">shiftKey</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-comment">// é’ˆå¯¹safariæµè§ˆå™¨å…¼å®¹</span>
    <span class="hljs-keyword">if</span>(result.<span class="hljs-property">browser</span>.<span class="hljs-property">name</span> === <span class="hljs-string">"safari"</span>) {
      <span class="hljs-keyword">if</span>(isCompositionInputType) { <span class="hljs-comment">// ä½¿ç”¨è‡ªå·±å®ç°çš„ComposingçŠ¶æ€</span>
        isCompositionInputType = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">return</span>;
      }
    }<span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span>(event.<span class="hljs-property">isComposing</span>) <span class="hljs-keyword">return</span>;
    }
    event.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-title function_">sendMessage</span>(); <span class="hljs-comment">// å‘é€</span>
  }
}

<span class="hljs-comment">// æ‰‹åŠ¨å®ç°åˆ¤æ–­æ˜¯å¦ä¸ºè¾“å…¥æ³•åˆæˆçŠ¶æ€</span>
<span class="hljs-keyword">let</span> isCompositionInputType = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onInput</span> = (<span class="hljs-params">event</span>) =&gt; {
  isCompositionInputType = [<span class="hljs-string">"insertCompositionText"</span>, <span class="hljs-string">"insertFromComposition"</span>].<span class="hljs-title function_">includes</span>(event.<span class="hljs-property">inputType</span>);
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«å†æ»¥ç”¨ Base64 äº†â€”â€”Blob æ‰æ˜¯å‰ç«¯å‡è´Ÿçš„æ­£ç¡®å§¿åŠ¿]]></title>    <link>https://juejin.cn/post/7573521516324896795</link>    <guid>https://juejin.cn/post/7573521516324896795</guid>    <pubDate>2025-11-18T00:48:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573521516324896795" data-draft-id="7573528564026802222" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«å†æ»¥ç”¨ Base64 äº†â€”â€”Blob æ‰æ˜¯å‰ç«¯å‡è´Ÿçš„æ­£ç¡®å§¿åŠ¿"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-11-18T00:48:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="404æ˜Ÿçƒçš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/193147068224126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«å†æ»¥ç”¨ Base64 äº†â€”â€”Blob æ‰æ˜¯å‰ç«¯å‡è´Ÿçš„æ­£ç¡®å§¿åŠ¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/193147068224126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    404æ˜Ÿçƒçš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:48:44.000Z" title="Tue Nov 18 2025 00:48:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ Blobï¼Ÿ</h2>
<p><strong>Blob</strong>ï¼ˆBinary Large Objectï¼ŒäºŒè¿›åˆ¶å¤§å¯¹è±¡ï¼‰æ˜¯æµè§ˆå™¨æä¾›çš„ä¸€ç§<strong>ä¸å¯å˜ã€ç±»æ–‡ä»¶çš„åŸå§‹æ•°æ®å®¹å™¨</strong>ã€‚å®ƒå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹çš„äºŒè¿›åˆ¶æˆ–æ–‡æœ¬æ•°æ®ï¼Œä¾‹å¦‚å›¾ç‰‡ã€éŸ³é¢‘ã€PDFã€ç”šè‡³ä¸€æ®µçº¯æ–‡æœ¬ã€‚ä¸ <code>File</code> å¯¹è±¡ç›¸æ¯”ï¼ŒBlob æ›´åº•å±‚ï¼ŒFile å®é™…ä¸Šç»§æ‰¿è‡ª Blobï¼Œå¹¶é¢å¤–æºå¸¦äº† <code>name</code>ã€<code>lastModified</code> ç­‰å…ƒä¿¡æ¯ ã€‚</p>
<p>Blob æœ€å¤§çš„ç‰¹ç‚¹æ˜¯<strong>çº¯å®¢æˆ·ç«¯ã€é›¶ç½‘ç»œ</strong>ï¼šæ•°æ®ä¸€æ—¦è¿›å…¥ Blobï¼Œå°±æ´»åœ¨å†…å­˜é‡Œï¼Œæ— éœ€ä¸Šä¼ æœåŠ¡å™¨å³å¯é¢„è§ˆã€ä¸‹è½½æˆ–è¿›ä¸€æ­¥åŠ å·¥ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€æ„é€ ä¸€ä¸ª Blobï¼šä¸€è¡Œä»£ç æå®š</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>(parts, options);
</code></pre>

















<table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>parts</code></td><td>æ•°ç»„ï¼Œå…ƒç´ å¯ä»¥æ˜¯ <code>String</code>ã€<code>ArrayBuffer</code>ã€<code>TypedArray</code>ã€<code>Blob</code> ç­‰ã€‚</td></tr><tr><td><code>options</code></td><td>å¯é€‰å¯¹è±¡ï¼Œå¸¸ç”¨å­—æ®µï¼š<br/><code>type</code> MIME ç±»å‹ï¼Œé»˜è®¤ <code>application/octet-stream</code>ï¼›<br/><code>endings</code> æ˜¯å¦è½¬æ¢æ¢è¡Œç¬¦ï¼Œå‡ ä¹ä¸ç”¨ã€‚</td></tr></tbody></table>
<p>ç¤ºä¾‹ï¼šåŠ¨æ€ç”Ÿæˆä¸€ä¸ª Markdown æ–‡ä»¶å¹¶è®©ç”¨æˆ·ä¸‹è½½</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> content = <span class="hljs-string">'# Hello Blob\n&gt; ç”±æµè§ˆå™¨åŠ¨æ€ç”Ÿæˆ'</span>;
<span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([content], { <span class="hljs-attr">type</span>: <span class="hljs-string">'text/markdown'</span> });
<span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);

<span class="hljs-keyword">const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'a'</span>);
a.<span class="hljs-property">href</span> = url;
a.<span class="hljs-property">download</span> = <span class="hljs-string">'hello.md'</span>;
a.<span class="hljs-title function_">click</span>();

<span class="hljs-comment">// å†…å­˜ç”¨å®Œå³å¼ƒ</span>
<span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(url);
</code></pre>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€Blob URLï¼šç»™å†…å­˜ä¸­çš„æ•°æ®ä¸€ä¸ªâ€œä¸´æ—¶åœ°å€â€</h2>
<h3 data-id="heading-3">1. ç”Ÿæˆæ–¹å¼</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
<span class="hljs-comment">// è¿”å›å€¼æ ·ä¾‹</span>
<span class="hljs-comment">// blob:https://localhost:3000/550e8400-e29b-41d4-a716-446655440000</span>
</code></pre>
<h3 data-id="heading-4">2. ç”Ÿå‘½å‘¨æœŸ</h3>
<ul>
<li><strong>ä½œç”¨åŸŸ</strong>ï¼šä»…åœ¨<strong>å½“å‰æ–‡æ¡£ã€å½“å‰ä¼šè¯</strong>æœ‰æ•ˆï¼›é¡µé¢åˆ·æ–°ã€<code>close()</code>ã€æ‰‹åŠ¨è°ƒç”¨ <code>revokeObjectURL()</code> éƒ½ä¼šä½¿å…¶å¤±æ•ˆ ã€‚</li>
<li><strong>æ€§èƒ½é™·é˜±</strong>ï¼šä¸ä¸»åŠ¨é‡Šæ”¾ä¼šé€ æˆ<strong>å†…å­˜æ³„æ¼</strong>ï¼Œå°¤å…¶åœ¨å•é¡µåº”ç”¨æˆ–å¤§é‡å›¾ç‰‡é¢„è§ˆåœºæ™¯ ã€‚</li>
</ul>
<p>æœ€ä½³å®è·µå°è£…ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createTempURL</span>(<span class="hljs-params">blob</span>) {
  <span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
  <span class="hljs-comment">// è‡ªåŠ¨ revokeï¼Œé¿å…å¿˜è®°</span>
  <span class="hljs-title function_">requestIdleCallback</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(url));
  <span class="hljs-keyword">return</span> url;
}
</code></pre>
<hr/>
<h2 data-id="heading-5">å››ã€Blob vs. Base64 vs. ArrayBufferï¼šå¦‚ä½•é€‰å‹ï¼Ÿ</h2>






























<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ ¼å¼</th><th>ç†ç”±</th></tr></thead><tbody><tr><td>å›¾ç‰‡å›æ˜¾ã€<code>&lt;img&gt;</code>/<code>&lt;video&gt;</code></td><td>Blob URL</td><td>æµè§ˆå™¨å¯ç›´æ¥è§£æï¼Œæ— éœ€è§£ç ï¼›å†…å­˜å ç”¨ä½ã€‚</td></tr><tr><td>å°å›¾æ ‡å†…åµŒåœ¨ CSS/JSON</td><td>Base64</td><td>å‡å°‘ä¸€æ¬¡ HTTP è¯·æ±‚ï¼Œä½†ä½“ç§¯å¢å¤§çº¦ 33%ã€‚</td></tr><tr><td>çº¯è®¡ç®—ã€WebAssembly ä¼ é€’</td><td>ArrayBuffer</td><td>å¯å†™ã€å¯ç´¢å¼•ï¼Œé€‚åˆé«˜æ•ˆè¿ç®—ã€‚</td></tr><tr><td>ä¸Šä¼ å¤§æ–‡ä»¶ã€æ–­ç‚¹ç»­ä¼ </td><td>Blob.slice</td><td>æµå¼åˆ†ç‰‡ï¼Œé…åˆ <code>File.prototype.slice</code> åšæ–­ç‚¹ç»­ä¼  ã€‚</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-6">äº”ã€é«˜é¢‘å®æˆ˜åœºæ™¯</h2>
<h3 data-id="heading-7">1. æœ¬åœ°å›¾ç‰‡/è§†é¢‘é¢„è§ˆï¼ˆé›¶ä¸Šä¼ ï¼‰</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span> <span class="hljs-attr">accept</span>=<span class="hljs-string">"image/*"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"uploader"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"preview"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"max-width: 100%"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
uploader.<span class="hljs-property">onchange</span> = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> file = e.<span class="hljs-property">target</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span> (!file) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(file);
  preview.<span class="hljs-property">src</span> = url;
  preview.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(url); <span class="hljs-comment">// åŠ è½½å®Œå³é‡Šæ”¾</span>
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-8">2. å°† Canvas ç»˜å›¾å¯¼å‡ºä¸º PNG å¹¶ä¸‹è½½</h3>
<pre><code class="hljs language-js" lang="js">canvas.<span class="hljs-title function_">toBlob</span>(<span class="hljs-function"><span class="hljs-params">blob</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
  <span class="hljs-keyword">const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'a'</span>);
  a.<span class="hljs-property">href</span> = url;
  a.<span class="hljs-property">download</span> = <span class="hljs-string">'snapshot.png'</span>;
  a.<span class="hljs-title function_">click</span>();
  <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(url);
}, <span class="hljs-string">'image/png'</span>);
</code></pre>
<h3 data-id="heading-9">3. æŠ“å–è¿œç¨‹å›¾ç‰‡â†’Blobâ†’æœ¬åœ°é¢„è§ˆï¼ˆè·¨åŸŸéœ€ CORSï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://i.imgur.com/xxx.png'</span>, { <span class="hljs-attr">mode</span>: <span class="hljs-string">'cors'</span> })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">blob</span>())
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">blob</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'img'</span>).<span class="hljs-property">src</span> = url;
  });
</code></pre>
<p>è‹¥å‡ºç°<strong>å›¾ç‰‡ä¸æ˜¾ç¤º</strong>ï¼Œ99% æ˜¯å› ä¸ºæœåŠ¡ç«¯æœªè¿”å› <code>Access-Control-Allow-Origin</code> å¤´ ã€‚</p>
<hr/>
<h2 data-id="heading-10">å…­ã€è¸©å‘æŒ‡å—ä¸æ€§èƒ½é”¦å›Š</h2>

























<table><thead><tr><th>å‘ç‚¹</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>å†…å­˜æš´æ¶¨</td><td>æ¯æ¬¡ <code>createObjectURL</code> åï¼ŒåŠ¡å¿…åœ¨åˆé€‚çš„æ—¶æœº <code>revokeObjectURL</code> ã€‚</td></tr><tr><td>è·¨åŸŸå¤±è´¥</td><td>ç¡®è®¤æœåŠ¡ç«¯å¼€å¯ CORSï¼›fetch æ—¶åŠ  <code>{credentials: 'include'}</code> å¦‚éœ€ Cookieã€‚</td></tr><tr><td>ç§»åŠ¨ç«¯å¤§è§†é¢‘å¡é¡¿</td><td>é¿å…ä¸€æ¬¡æ€§è¯»å®Œæ•´æ–‡ä»¶ï¼Œä½¿ç”¨ <code>blob.slice(start, end)</code> åˆ†æ®µè¯»å–ã€‚</td></tr><tr><td>æ—§æµè§ˆå™¨å…¼å®¹</td><td>IE10+ æ‰åŸç”Ÿæ”¯æŒ Blobï¼›å¦‚éœ€æ›´ä½ç‰ˆæœ¬ï¼Œè¯·å¼•å…¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Feligrey%2FBlob.js" target="_blank" title="https://github.com/eligrey/Blob.js" ref="nofollow noopener noreferrer">Blob.js</a> å…¼å®¹åº“ã€‚</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-11">ä¸ƒã€å»¶ä¼¸ï¼šBlob ä¸ Stream çš„æ¢¦å¹»è”åŠ¨</h2>
<p>å½“æ–‡ä»¶è¶…å¤§ï¼ˆGB çº§ï¼‰æ—¶ï¼Œå…¨éƒ¨è¯»è¿›å†…å­˜å¹¶ä¸ç°å®ã€‚å¯ä»¥å€ŸåŠ© <code>ReadableStream</code> æŠŠ Blob è½¬ä¸ºæµï¼Œå®ç°æ¸è¿›å¼ä¸Šä¼ ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> stream = blob.<span class="hljs-title function_">stream</span>(); <span class="hljs-comment">// è¿”å› ReadableStream</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/upload'</span>, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
  <span class="hljs-attr">body</span>: stream,
  <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: blob.<span class="hljs-property">type</span> }
});
</code></pre>
<p>Chrome 85+ã€Edge 85+ã€Firefox å·²ç»æ”¯æŒ <code>blob.stream()</code>ï¼Œèƒ½ä»¥<strong>æµå¼</strong>å½¢å¼è¾¹è¯»è¾¹ä¼ ï¼Œå†…å­˜å ç”¨æä½ã€‚</p>
<hr/>
<h2 data-id="heading-12">å…«ã€æ€»ç»“ï¼šè®°ä½â€œä¸‰å¥è¯â€</h2>
<ol>
<li>Blob = <strong>æµè§ˆå™¨ç«¯çš„äºŒè¿›åˆ¶æ•°æ®ä»“åº“</strong>ï¼ŒFile åªæ˜¯å®ƒçš„è¶…é›†ã€‚</li>
<li>Blob URL = <strong>æŒ‡å‘å†…å­˜çš„ä¸´æ—¶æŒ‡é’ˆ</strong>ï¼Œç”¨å®Œåå¿…é¡»æ‰‹åŠ¨æˆ–è‡ªåŠ¨é‡Šæ”¾ã€‚</li>
<li>å‡¡æ˜¯â€œ<strong>æœ¬åœ°é¢„è§ˆã€é›¶ä¸Šä¼ ã€åŠ¨æ€ç”Ÿæˆä¸‹è½½</strong>â€çš„éœ€æ±‚ï¼Œä¼˜å…ˆè€ƒè™‘ Blob + Blob URL ç»„åˆã€‚</li>
</ol>
<p>ç”¨å¥½ Blobï¼Œæ—¢èƒ½<strong>æå‡ç”¨æˆ·ä½“éªŒ</strong>ï¼ˆç§’å¼€é¢„è§ˆï¼‰ï¼Œåˆèƒ½<strong>é™ä½æœåŠ¡ç«¯å‹åŠ›</strong>ï¼ˆæ— éœ€ä¸­è½¬ï¼‰ï¼Œæ˜¯æ¯ä¸€ä½å‰ç«¯å·¥ç¨‹å¸ˆçš„å¿…å¤‡æŠ€èƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è°ƒè¯•åˆ©å™¨â€”â€”pageSpyçš„ä½¿ç”¨ç®€æ˜“æŒ‡å—]]></title>    <link>https://juejin.cn/post/7573508361742204928</link>    <guid>https://juejin.cn/post/7573508361742204928</guid>    <pubDate>2025-11-18T00:59:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573508361742204928" data-draft-id="7573530680887066658" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è°ƒè¯•åˆ©å™¨â€”â€”pageSpyçš„ä½¿ç”¨ç®€æ˜“æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-18T00:59:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ZT_KeBei"/> <meta itemprop="url" content="https://juejin.cn/user/3263773733818103"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è°ƒè¯•åˆ©å™¨â€”â€”pageSpyçš„ä½¿ç”¨ç®€æ˜“æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3263773733818103/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ZT_KeBei
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:59:22.000Z" title="Tue Nov 18 2025 00:59:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#5f6368;background-image:linear-gradient(90deg,rgba(240,191,213,.1) 3%,transparent 0),linear-gradient(1turn,rgba(240,191,213,.1) 3%,transparent 0);background-size:20px 20px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-left:50px;padding-bottom:5px;color:#5f6368}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{position:absolute;left:0;display:block;content:""}.markdown-body h1{font-size:32px;margin-bottom:5px}.markdown-body h1:before{top:0;content:"ğŸ¦„";font-size:32px}.markdown-body h2{padding-bottom:24px;border-bottom:1px solid #ececec}.markdown-body h2:before{top:0;left:8px;content:"ğŸ³";font-size:24px}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{top:-2px;left:8px;content:"ğŸ„";font-size:20px}.markdown-body h4{font-size:16px}.markdown-body h4:before{top:-2px;left:8px;content:"ğŸ¦¥";font-size:18px}.markdown-body h5{font-size:14px}.markdown-body h5:before{top:-2px;left:9px;content:"ğŸ¦©";font-size:16px}.markdown-body h6{font-size:12px;margin-top:5px}.markdown-body h6:before{top:-1px;left:10px;content:"ğŸ§";font-size:14px}.markdown-body p{line-height:1.9;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid rgba(253,121,168,.5);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#a6accd;background:#292d3e;border-radius:8px}.markdown-body a{text-decoration:none;color:#fd79a8;border-bottom:1px solid #fd79a8;padding:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(253,121,168,.1);color:#ee69a9}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body th{color:#fd79a8}.markdown-body th,.markdown-body tr:hover{background:rgba(253,121,168,.1)}.markdown-body td{min-width:120px}.markdown-body blockquote{position:relative;color:#666;padding:23px;margin:22px 0;border-left:4px solid #ee69a9;background-color:rgba(253,121,168,.1)}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;display:block;font-size:27px;color:#fd79a8;opacity:.8}.markdown-body blockquote:before{left:10px;top:0;content:"â"}.markdown-body blockquote:after{right:10px;bottom:0;content:"â"}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body strong{position:relative;color:#fd79a8}.markdown-body strong:before{content:"Â· "}.markdown-body strong:after{content:" Â·"}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#fd79a8}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#ee69a9}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}</style><style data-highlight="" data-highlight-key="vs2015">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1e1e1e;color:#dcdcdc}.hljs-keyword,.hljs-link,.hljs-literal,.hljs-name,.hljs-symbol{color:#569cd6}.hljs-link{text-decoration:underline}.hljs-built_in,.hljs-type{color:#4ec9b0}.hljs-class,.hljs-number{color:#b8d7a3}.hljs-meta-string,.hljs-string{color:#d69d85}.hljs-regexp,.hljs-template-tag{color:#9a5334}.hljs-formula,.hljs-function,.hljs-params,.hljs-subst,.hljs-title{color:#dcdcdc}.hljs-comment,.hljs-quote{color:#57a64a;font-style:italic}.hljs-doctag{color:#608b4e}.hljs-meta,.hljs-meta-keyword,.hljs-tag{color:#9b9b9b}.hljs-template-variable,.hljs-variable{color:#bd63c5}.hljs-attr,.hljs-attribute,.hljs-builtin-name{color:#9cdcfe}.hljs-section{color:gold}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-bullet,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-selector-tag{color:#d7ba7d}.hljs-addition{background-color:#144212}.hljs-addition,.hljs-deletion{display:inline-block;width:100%}.hljs-deletion{background-color:#600}</style><h2 data-id="heading-0">1.å…ˆéƒ¨ç½²pageSpyåˆ°è‡ªæœ‰æœåŠ¡å™¨ï¼ˆæ¨èéƒ¨ç½²åˆ°è‡ªæœ‰æœåŠ¡å™¨ï¼‰</h2>
<h3 data-id="heading-1">ä¸‰ç§æ–¹å¼ï¼ˆnodeéƒ¨ç½²ã€dockeréƒ¨ç½²ã€å®å¡”é¢æ¿éƒ¨ç½²ï¼‰</h3>
<p>å…·ä½“å‚è€ƒå®˜ç½‘<a href="https://link.juejin.cn?target=https%3A%2F%2Fpagespy.huolala.cn%2F%23%2F" target="_blank" title="https://pagespy.huolala.cn/#/" ref="nofollow noopener noreferrer">pagespy.huolala.cn/#/</a></p>
<h3 data-id="heading-2">å…éƒ¨ç½²ä½¿ç”¨æ–¹å¼ï¼ˆç”Ÿäº§ç¯å¢ƒä¸‹ä¸æ¨èï¼‰</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpagespy.huolala.cn%2F%23%2Fo-spy" target="_blank" title="https://pagespy.huolala.cn/#/o-spy" ref="nofollow noopener noreferrer">pagespy.huolala.cn/#/o-spy</a></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://static.huolala.cn/libs/o-spy/2.2.9/index.min.js"</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">const</span> $oSpy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OSpy</span>();
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-3">2.å‰ç«¯é¡µé¢/æ¡†æ¶ä¸­é›†æˆpageSpy sdk</h2>
<h4 data-id="heading-4">cdnæ–¹å¼</h4>
<h5 data-id="heading-5">å®‰è£…</h5>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- PageSpy SDK --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://&lt;your-pagespy-host&gt;/page-spy/index.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- æ’ä»¶ï¼ˆéå¿…é¡»ï¼Œä½†å»ºè®®ä½¿ç”¨ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://&lt;your-pagespy-host&gt;/plugin/data-harbor/index.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://&lt;your-pagespy-host&gt;/plugin/rrweb/index.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h5 data-id="heading-6">é›†æˆä¸åˆå§‹åŒ–</h5>
<pre><code class="hljs language-ini" lang="ini">&lt;script&gt;
  window.$<span class="hljs-attr">harbor</span> = new DataHarborPlugin()<span class="hljs-comment">;</span>
  window.$<span class="hljs-attr">rrweb</span> = new RRWebPlugin()<span class="hljs-comment">;</span>

  <span class="hljs-section">[window.$harbor, window.$rrweb]</span>.forEach(<span class="hljs-attr">p</span> =&gt; {
    PageSpy.registerPlugin(p)
  })

  window.$<span class="hljs-attr">pageSpy</span> = new PageSpy()<span class="hljs-comment">;</span>
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-7">ESMæ–¹å¼å¼•å…¥</h4>
<h5 data-id="heading-8">å®‰è£…</h5>
<pre><code class="hljs language-kotlin" lang="kotlin">yarn add <span class="hljs-meta">@huolala</span>-tech/page-spy-browser <span class="hljs-meta">@huolala</span>-tech/page-spy-plugin-<span class="hljs-keyword">data</span>-harbor <span class="hljs-meta">@huolala</span>-tech/page-spy-plugin-rrweb
</code></pre>
<h5 data-id="heading-9">é›†æˆä¸åˆå§‹åŒ–</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">PageSpy</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@huolala-tech/page-spy-browser"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">DataHarborPlugin</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@huolala-tech/page-spy-plugin-data-harbor"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">RRWebPlugin</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@huolala-tech/page-spy-plugin-rrweb"</span>;

<span class="hljs-variable language_">window</span>.<span class="hljs-property">$harbor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataHarborPlugin</span>();
<span class="hljs-variable language_">window</span>.<span class="hljs-property">$rrweb</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RRWebPlugin</span>();

[<span class="hljs-variable language_">window</span>.<span class="hljs-property">$harbor</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">$rrweb</span>].<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">p</span>) =&gt;</span> {
  <span class="hljs-title class_">PageSpy</span>.<span class="hljs-title function_">registerPlugin</span>(p);
});
<span class="hljs-comment">// ESM æ¨¡å¼ä¸‹æ— æ³•è‡ªåŠ¨åˆ†æéƒ¨ç½²åœ°å€ï¼Œå› æ­¤å¿…é¡»æ‰‹åŠ¨é…ç½®ä»¥ä¸‹å‚æ•°</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">$pageSpy</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageSpy</span>({
  <span class="hljs-attr">api</span>: <span class="hljs-string">"xx.xx.xx.xx:6752"</span>,<span class="hljs-comment">//éƒ¨ç½²pageSpyçš„æœåŠ¡å™¨åœ°å€ï¼ˆåªéœ€è¦ä¸»æœº+ç«¯å£ï¼‰</span>
  <span class="hljs-attr">clientOrigin</span>: <span class="hljs-string">"http://xx.xx.xx.xx:6752"</span>,<span class="hljs-comment">//ï¼ˆå®Œæ•´çš„åœ°å€ï¼‰</span>
  <span class="hljs-attr">enableSSL</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-comment">// ä¸æ¸²æŸ“å›¾æ ‡</span>
  <span class="hljs-attr">autoRender</span>: <span class="hljs-literal">false</span>,
});

<span class="hljs-comment">// ç›‘å¬é¡µé¢è¿ç»­ç‚¹å‡»5æ¬¡åŠä»¥ä¸Šæ—¶å€™æ¸²æŸ“pageSpyå›¾æ ‡</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">detail</span> &gt;= <span class="hljs-number">5</span>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">$pageSpy</span>.<span class="hljs-title function_">render</span>();
  }
});
</code></pre>
<h2 data-id="heading-10">3.å¼€å§‹è°ƒè¯•</h2>
<p>å‰ç«¯é¡¹ç›®è¿è¡Œèµ·æ¥åè¿ç»­ç‚¹å‡»é¡µé¢äº”æ¬¡å¼€å¯è°ƒè¯•ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºpageSpyæ ‡ï¼Œç‚¹å‡»è·³è½¬å³å¯</p>
<p>åç»­åŠŸèƒ½ç›´æ¥åœ¨è·³è½¬çš„ç•Œé¢ä¸Šå®æ—¶è°ƒè¯•</p>
<h2 data-id="heading-11">4.æµ‹è¯•ä¸€ä¸‹</h2>
<pre><code class="hljs language-ini" lang="ini">æ§åˆ¶å°è¾“å…¥ï¼š
<span class="hljs-attr">document.body.style.backgroundColor</span> = <span class="hljs-string">"red"</span><span class="hljs-comment">;</span>
<span class="hljs-attr">document.body.style.color</span> = <span class="hljs-string">"white"</span><span class="hljs-comment">;</span>

è§‚å¯Ÿé¡µé¢æ ·å¼å˜åŒ–
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ES2025æ–°ç‰¹æ€§å®æˆ˜ï¼š5åˆ†é’Ÿgetå‰ç«¯é«˜é¢‘å®ç”¨è¯­æ³•]]></title>    <link>https://juejin.cn/post/7573535624533344275</link>    <guid>https://juejin.cn/post/7573535624533344275</guid>    <pubDate>2025-11-18T01:09:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573535624533344275" data-draft-id="7573525634213527595" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ES2025æ–°ç‰¹æ€§å®æˆ˜ï¼š5åˆ†é’Ÿgetå‰ç«¯é«˜é¢‘å®ç”¨è¯­æ³•"/> <meta itemprop="keywords" content="å‰ç«¯,TypeScript"/> <meta itemprop="datePublished" content="2025-11-18T01:09:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®‡ä½™"/> <meta itemprop="url" content="https://juejin.cn/user/2999123453424542"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ES2025æ–°ç‰¹æ€§å®æˆ˜ï¼š5åˆ†é’Ÿgetå‰ç«¯é«˜é¢‘å®ç”¨è¯­æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2999123453424542/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®‡ä½™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:09:22.000Z" title="Tue Nov 18 2025 01:09:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ES2025 ä½œä¸º JavaScript æ ‡å‡†çš„ç¬¬ 16 ç‰ˆï¼Œå¸¦æ¥äº†ä¸€æ‰¹ç›´å‡»å¼€å‘è€…ç—›ç‚¹çš„æ–°ç‰¹æ€§ã€‚ä¸ç”¨å†ç­‰ Babel æ’ä»¶å…¼å®¹ï¼Œç°åœ¨ä¸»æµæµè§ˆå™¨å’Œ Node.js å·²é€æ­¥æ”¯æŒã€‚æœ¬æ–‡ç²¾é€‰ 5 ä¸ªæœ€èƒ½æå‡å¼€å‘æ•ˆç‡çš„è¯­æ³•ï¼Œ5 åˆ†é’Ÿå°±èƒ½ä¸Šæ‰‹å®æˆ˜ï¼ğŸš€</p>
<h2 data-id="heading-0">1. Promise.try()ï¼šåŒæ­¥å¼‚æ­¥é”™è¯¯ä¸€æŠŠæŠ“</h2>
<p><em>ï¼ˆé…å›¾å»ºè®®ï¼šå·¦ä¾§åŒæ­¥ä»£ç æŠ¥é”™æ— æ³•æ•è·çš„çº¢è‰²è­¦å‘Šç¤ºæ„å›¾ï¼Œå³ä¾§Promise.try()ç»Ÿä¸€æ•è·é”™è¯¯çš„ç»¿è‰²æµç¨‹ç¤ºæ„å›¾ï¼Œå¯¹æ¯”å±•ç¤ºï¼‰</em></p>
<p><strong>ç—›ç‚¹</strong>ï¼šåŒæ­¥å‡½æ•°æŠ›å‡ºçš„é”™è¯¯æ— æ³•ç›´æ¥è¢« <code>Promise.catch</code> æ•è·ï¼Œå¿…é¡»é¢å¤–åµŒå¥— <code>try/catch</code>ã€‚</p>
<p><strong>æ–°å†™æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">function</span> <span class="hljs-title function_">mightThrow</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.5</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Oops'</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-string">'Success'</span>;
}

<span class="hljs-comment">// ç»Ÿä¸€æ•è·åŒæ­¥/å¼‚æ­¥é”™è¯¯</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">try</span>(mightThrow)
  .<span class="hljs-title function_">then</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>)  <span class="hljs-comment">// æˆåŠŸè¾“å‡º 'Success'</span>
  .<span class="hljs-keyword">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>); <span class="hljs-comment">// å¤±è´¥æ•è·æ‰€æœ‰é”™è¯¯</span>
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šæ··åˆåŒæ­¥å¼‚æ­¥æ“ä½œï¼ˆå¦‚å›¾å½¢æ¸²æŸ“ã€æ•°æ®åº“æŸ¥è¯¢ï¼‰æ—¶ï¼Œä»£ç åµŒå¥—å‡å°‘ 30%ï¼Œé”™è¯¯é€»è¾‘æ›´ç»Ÿä¸€ã€‚
<strong>å®æˆ˜åœºæ™¯</strong>ï¼šæ¥å£è¯·æ±‚å‰éœ€æ ¡éªŒå‚æ•°åˆæ³•æ€§ï¼ˆåŒæ­¥ï¼‰ï¼Œæ ¡éªŒé€šè¿‡åå‘èµ·è¯·æ±‚ï¼ˆå¼‚æ­¥ï¼‰ï¼Œç”¨Promise.try()å¯é¿å…åµŒå¥—try/catchï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchData</span> = (<span class="hljs-params">params</span>) =&gt; {
  <span class="hljs-comment">// åŒæ­¥å‚æ•°æ ¡éªŒ</span>
  <span class="hljs-keyword">if</span> (!params.<span class="hljs-property">id</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç¼ºå°‘ID'</span>);
  <span class="hljs-comment">// å¼‚æ­¥è¯·æ±‚</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/data/<span class="hljs-subst">${params.id}</span>`</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>());
};

<span class="hljs-comment">// ç»Ÿä¸€é”™è¯¯å¤„ç†</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">try</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">fetchData</span>({}))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data))
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-title function_">alert</span>(err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// ç›´æ¥æ•è·"ç¼ºå°‘ID"é”™è¯¯</span>
</code></pre>
<h2 data-id="heading-1">2. Set é›†åˆè¿ç®—ï¼šå‘Šåˆ« Lodash ä¾èµ–</h2>
<p><em>ï¼ˆé…å›¾å»ºè®®ï¼šä¸¤ä¸ªé‡å çš„å½©è‰²åœ†åœˆåˆ†åˆ«ä»£è¡¨userTagså’ŒhotTagsï¼Œäº¤é›†éƒ¨åˆ†ç”¨é«˜äº®é¢œè‰²æ ‡æ³¨ï¼Œæ—ä¾§æ ‡æ³¨unionã€differenceè¿ç®—ç»“æœï¼‰</em></p>
<p><strong>ç—›ç‚¹</strong>ï¼šæ±‚äº¤é›†ã€å¹¶é›†è¿˜è¦æ‰‹åŠ¨å®ç°å¾ªç¯ï¼ŸLodash ä½“ç§¯åˆå«Œå¤§ï¼Ÿ</p>
<p><strong>æ–°å†™æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> userTags = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-string">'js'</span>, <span class="hljs-string">'node'</span>, <span class="hljs-string">'web'</span>]);
<span class="hljs-keyword">const</span> hotTags = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-string">'web'</span>, <span class="hljs-string">'react'</span>, <span class="hljs-string">'ts'</span>]);

<span class="hljs-comment">// äº¤é›†ï¼šå…±åŒæ ‡ç­¾</span>
<span class="hljs-keyword">const</span> common = userTags.<span class="hljs-title function_">intersection</span>(hotTags); <span class="hljs-comment">// Set {'web'}</span>
<span class="hljs-comment">// å·®é›†ï¼šæ¨èæ ‡ç­¾</span>
<span class="hljs-keyword">const</span> recommended = hotTags.<span class="hljs-title function_">difference</span>(userTags); <span class="hljs-comment">// Set {'react', 'ts'}</span>
<span class="hljs-comment">// å¹¶é›†ï¼šæ‰€æœ‰æ ‡ç­¾</span>
<span class="hljs-keyword">const</span> all = userTags.<span class="hljs-title function_">union</span>(hotTags); <span class="hljs-comment">// Set {'js','node','web','react','ts'}</span>
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šåŸç”Ÿå®ç°åŸºäºå“ˆå¸Œè¡¨ï¼Œæ—¶é—´å¤æ‚åº¦ O(min(n,m))ï¼Œæ ‡ç­¾ç³»ç»Ÿã€æƒé™ç®¡ç†åœºæ™¯ç›´æ¥ç”¨ã€‚
<strong>å®æˆ˜åœºæ™¯</strong>ï¼šæƒé™æ§åˆ¶ä¸­ï¼Œç­›é€‰ç”¨æˆ·æ‹¥æœ‰çš„æƒé™ä¸é¡µé¢æ‰€éœ€æƒé™çš„äº¤é›†ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æƒè®¿é—®ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> userPermissions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-string">'view'</span>, <span class="hljs-string">'edit'</span>, <span class="hljs-string">'delete'</span>]);
<span class="hljs-keyword">const</span> pageRequired = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-string">'view'</span>, <span class="hljs-string">'export'</span>]);

<span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰å¿…éœ€æƒé™</span>
<span class="hljs-keyword">const</span> hasAll = pageRequired.<span class="hljs-title function_">difference</span>(userPermissions).<span class="hljs-property">size</span> === <span class="hljs-number">0</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(hasAll); <span class="hljs-comment">// falseï¼ˆç¼ºå°‘exportæƒé™ï¼‰</span>

<span class="hljs-comment">// è·å–ç”¨æˆ·å¯æ“ä½œçš„æƒé™</span>
<span class="hljs-keyword">const</span> availableActions = userPermissions.<span class="hljs-title function_">intersection</span>(pageRequired);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([...availableActions]); <span class="hljs-comment">// ['view']</span>
</code></pre>
<h2 data-id="heading-2">3. æ¨¡å¼åŒ¹é…ï¼šif-else æ€æ‰‹æ¥äº†</h2>
<p><em>ï¼ˆé…å›¾å»ºè®®ï¼šå·¦ä¾§æ‚ä¹±çš„if-elseåˆ†æ”¯æµç¨‹å›¾ï¼Œå³ä¾§æ¨¡å¼åŒ¹é…çš„æ¸…æ™°åˆ†æ”¯æ ‘çŠ¶å›¾ï¼Œè§†è§‰å¯¹æ¯”çªå‡ºç®€æ´æ€§ï¼‰</em></p>
<p><strong>ç—›ç‚¹</strong>ï¼šå¤šæ¡ä»¶åˆ†æ”¯ç”¨ if-else å†™å¾—åƒé¢æ¡ï¼Ÿswitch åˆä¸å¤Ÿçµæ´»ï¼Ÿ</p>
<p><strong>æ–°å†™æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processResponse</span>(<span class="hljs-params">response</span>) {
  <span class="hljs-keyword">return</span> match (response) {
    when ({ <span class="hljs-attr">status</span>: <span class="hljs-number">200</span>, data }) -&gt; ({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, data })
    when ({ <span class="hljs-attr">status</span>: <span class="hljs-number">404</span> }) -&gt; ({ <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">'Not found'</span> })
    when ({ <span class="hljs-attr">status</span>: s <span class="hljs-keyword">if</span> s &gt;= <span class="hljs-number">500</span> }) -&gt; ({ <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">'Server error'</span> })
    <span class="hljs-keyword">default</span> -&gt; ({ <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">'Unknown error'</span> })
  };
}

<span class="hljs-comment">// æ•°ç»„é•¿åº¦åˆ†æ”¯ä¹Ÿä¼˜é›…</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleArray</span>(<span class="hljs-params">arr</span>) {
  <span class="hljs-keyword">return</span> match (arr) {
    when (()) -&gt; <span class="hljs-string">"ç©ºæ•°ç»„"</span>
    when ((first)) -&gt; <span class="hljs-string">`ä»…ä¸€ä¸ªå…ƒç´ : <span class="hljs-subst">${first}</span>`</span>
    when ((a, b, ...rest)) -&gt; <span class="hljs-string">`å‰ä¸¤ä¸ª: <span class="hljs-subst">${a}</span>,<span class="hljs-subst">${b}</span>ï¼Œå‰©ä½™<span class="hljs-subst">${rest.length}</span>ä¸ª`</span>
  };
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šæ¡ä»¶é€»è¾‘å¯è§†åŒ–ï¼Œä»£ç è¡Œæ•°å‡å°‘ 40%ï¼Œå¤æ‚åˆ†æ”¯ç»´æŠ¤æˆæœ¬éª¤é™ã€‚
<strong>å®æˆ˜åœºæ™¯</strong>ï¼šå¤„ç†ä¸åŒç±»å‹çš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ ¹æ®ç”¨æˆ·è§’è‰²è¿”å›å¯¹åº”æ“ä½œèœå•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserMenu</span>(<span class="hljs-params">user</span>) {
  <span class="hljs-keyword">return</span> match (user) {
    when ({ <span class="hljs-attr">role</span>: <span class="hljs-string">'admin'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'active'</span> }) -&gt; [<span class="hljs-string">'dashboard'</span>, <span class="hljs-string">'user-manage'</span>, <span class="hljs-string">'settings'</span>]
    when ({ <span class="hljs-attr">role</span>: <span class="hljs-string">'editor'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'active'</span> }) -&gt; [<span class="hljs-string">'dashboard'</span>, <span class="hljs-string">'article-edit'</span>]
    when ({ <span class="hljs-attr">status</span>: <span class="hljs-string">'inactive'</span> }) -&gt; [<span class="hljs-string">'profile'</span>, <span class="hljs-string">'activate-account'</span>]
    <span class="hljs-keyword">default</span> -&gt; [<span class="hljs-string">'profile'</span>]
  };
}

<span class="hljs-keyword">const</span> adminMenu = <span class="hljs-title function_">getUserMenu</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">'admin'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'active'</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(adminMenu); <span class="hljs-comment">// ['dashboard', 'user-manage', 'settings']</span>
</code></pre>
<h2 data-id="heading-3">4. ç®¡é“è¿ç®—ç¬¦ï¼šå‡½æ•°ç»„åˆåƒå†™æµæ°´çº¿</h2>
<p><em>ï¼ˆé…å›¾å»ºè®®ï¼šæ•°æ®ä»å·¦åˆ°å³æµè¿‡å¤šä¸ªå¤„ç†èŠ‚ç‚¹çš„æµæ°´çº¿ç¤ºæ„å›¾ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ ‡æ³¨trimã€parseFloatç­‰å‡½æ•°ï¼Œæœ€ç»ˆè¾“å‡ºç»“æœï¼‰</em></p>
<p><strong>ç—›ç‚¹</strong>ï¼šåµŒå¥—å‡½æ•°è°ƒç”¨ï¼ˆå¦‚ <code>round(abs(sqrt(x)))</code>ï¼‰è¯»èµ·æ¥åƒ"ä»å³å¾€å·¦"çš„å¥—å¨ƒã€‚</p>
<p><strong>æ–°å†™æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> userInput = <span class="hljs-string">" 3.1415926 "</span>;

<span class="hljs-comment">// è‡ªå·¦å‘å³çš„æ•°æ®å¤„ç†æµæ°´çº¿</span>
<span class="hljs-keyword">const</span> result = userInput
  |&gt; <span class="hljs-title class_">String</span>.<span class="hljs-title function_">trim</span>(%)
  |&gt; <span class="hljs-built_in">parseFloat</span>(%)
  |&gt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(%)
  |&gt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(%); <span class="hljs-comment">// ç»“æœï¼š2</span>

<span class="hljs-comment">// å¼‚æ­¥æµæ°´çº¿ä¹Ÿæ”¯æŒ</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchUsers</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">url</span>) =&gt;
  url
  |&gt; <span class="hljs-title function_">fetch</span>(%)
  |&gt; <span class="hljs-keyword">await</span> %.<span class="hljs-title function_">json</span>()
  |&gt; (% =&gt; %.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">u</span> =&gt;</span> u.<span class="hljs-property">active</span>))
  |&gt; (% =&gt; %.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>));
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šæ•°æ®æµå‘æ¸…æ™°å¦‚æµç¨‹å›¾ï¼Œå¤æ‚å‡½æ•°ç»„åˆå¯è¯»æ€§æå‡ 60%ã€‚
<strong>å®æˆ˜åœºæ™¯</strong>ï¼šå¤„ç†åç«¯è¿”å›çš„æ—¶é—´æˆ³æ•°æ®ï¼Œè½¬æ¢ä¸ºæ ¼å¼åŒ–çš„æ—¥æœŸå­—ç¬¦ä¸²ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">formatTime</span> = (<span class="hljs-params">timestamp</span>) =&gt;
  timestamp
  |&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(%)
  |&gt; (<span class="hljs-function"><span class="hljs-params">date</span> =&gt;</span> date.<span class="hljs-title function_">toLocaleDateString</span>(<span class="hljs-string">'zh-CN'</span>))
  |&gt; (<span class="hljs-function"><span class="hljs-params">str</span> =&gt;</span> str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">'-'</span>))
  |&gt; (<span class="hljs-function"><span class="hljs-params">str</span> =&gt;</span> <span class="hljs-string">`æ—¥æœŸï¼š<span class="hljs-subst">${str}</span>`</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">formatTime</span>(<span class="hljs-number">1734567890000</span>)); <span class="hljs-comment">// æ—¥æœŸï¼š2024-12-19</span>
</code></pre>
<h2 data-id="heading-4">5. Record &amp; Tupleï¼šåŸç”Ÿä¸å¯å˜æ•°æ®</h2>
<p><em>ï¼ˆé…å›¾å»ºè®®ï¼šå·¦ä¾§æ™®é€šå¯¹è±¡å¼•ç”¨èµ‹å€¼çš„ç®­å¤´æŒ‡å‘åŒä¸€å†…å­˜åœ°å€ï¼Œå³ä¾§Recordå¯¹è±¡ç»“æ„ç›¸ç­‰çš„åŒç®­å¤´æŒ‡å‘ä¸åŒåœ°å€ä½†æ ‡æ³¨å€¼ç›¸ç­‰ï¼‰</em></p>
<p><strong>ç—›ç‚¹</strong>ï¼šç”¨ Object.freeze() åšä¸å¯å˜å¯¹è±¡ï¼Ÿæ€§èƒ½å·®è¿˜ä¸èƒ½æ·±å†»ç»“ï¼Ÿ</p>
<p><strong>æ–°å†™æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// Recordï¼šä¸å¯å˜å¯¹è±¡ï¼ˆ#{} è¯­æ³•ï¼‰</span>
<span class="hljs-keyword">const</span> user = #{
  <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
  <span class="hljs-attr">tags</span>: #[<span class="hljs-string">"js"</span>, <span class="hljs-string">"react"</span>] <span class="hljs-comment">// Tupleï¼šä¸å¯å˜æ•°ç»„ï¼ˆ#() è¯­æ³•ï¼‰</span>
};

<span class="hljs-comment">// ç»“æ„ç›¸ç­‰æ€§åˆ¤æ–­ï¼ˆå‘Šåˆ«å¼•ç”¨é™·é˜±ï¼‰</span>
<span class="hljs-keyword">const</span> user1 = #{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span> };
<span class="hljs-keyword">const</span> user2 = #{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span> };
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user1 === user2); <span class="hljs-comment">// trueï¼</span>

<span class="hljs-comment">// React ä¸­ç®€åŒ–ä¾èµ–å¯¹æ¯”</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">UserComponent</span> = (<span class="hljs-params">{ user }</span>) =&gt; {
  <span class="hljs-keyword">const</span> memoized = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> #{...user}, [user]); 
  <span class="hljs-comment">// æ— éœ€æ·±æ¯”è¾ƒï¼Œå¼•ç”¨ç›´æ¥ç›¸ç­‰</span>
};
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šåŸç”Ÿä¸å¯å˜+ç»“æ„ç›¸ç­‰ï¼ŒRedux/React çŠ¶æ€ç®¡ç†åœºæ™¯æ€§èƒ½é£™å‡ã€‚
<strong>å®æˆ˜åœºæ™¯</strong>ï¼šReduxçŠ¶æ€ä¸­å­˜å‚¨ç”¨æˆ·é…ç½®ï¼Œé¿å…å› å¼•ç”¨ä¸å˜å¯¼è‡´çš„ç»„ä»¶ä¸æ›´æ–°é—®é¢˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// Redux reducer</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">configReducer</span> = (<span class="hljs-params">state = #{theme: <span class="hljs-string">'light'</span>, layout: <span class="hljs-string">'grid'</span>}, action</span>) =&gt; {
  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'UPDATE_THEME'</span>:
      <span class="hljs-comment">// è¿”å›æ–°çš„Recordï¼Œç»“æ„å˜åŒ–è§¦å‘è®¢é˜…æ›´æ–°</span>
      <span class="hljs-keyword">return</span> #{...state, <span class="hljs-attr">theme</span>: action.<span class="hljs-property">payload</span>};
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
};

<span class="hljs-comment">// æ¯”è¾ƒçŠ¶æ€æ˜¯å¦å˜åŒ–</span>
<span class="hljs-keyword">const</span> prevState = #{<span class="hljs-attr">theme</span>: <span class="hljs-string">'light'</span>, <span class="hljs-attr">layout</span>: <span class="hljs-string">'grid'</span>};
<span class="hljs-keyword">const</span> newState = #{<span class="hljs-attr">theme</span>: <span class="hljs-string">'dark'</span>, <span class="hljs-attr">layout</span>: <span class="hljs-string">'grid'</span>};
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(prevState !== newState); <span class="hljs-comment">// trueï¼ˆç»“æ„ä¸åŒï¼Œè§¦å‘æ›´æ–°ï¼‰</span>
</code></pre>
<h2 data-id="heading-5">ğŸ’¡ å…¼å®¹æ€§ä¸å­¦ä¹ å»ºè®®</h2>
<ul>
<li>
<p>æµè§ˆå™¨ï¼šChrome 120+ã€Firefox 115+ å·²æ”¯æŒå¤§éƒ¨åˆ†ç‰¹æ€§</p>
</li>
<li>
<p>Node.jsï¼šv20+ éœ€å¼€å¯ --experimental-features æ ‡å¿—</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue 3 defineModel å®Œå…¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7573549302619766827</link>    <guid>https://juejin.cn/post/7573549302619766827</guid>    <pubDate>2025-11-18T01:35:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573549302619766827" data-draft-id="7573776814926561299" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue 3 defineModel å®Œå…¨æŒ‡å—"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-11-18T01:35:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="hongliangsam"/> <meta itemprop="url" content="https://juejin.cn/user/1478159026371671"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue 3 defineModel å®Œå…¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1478159026371671/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    hongliangsam
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:35:08.000Z" title="Tue Nov 18 2025 01:35:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vue 3 defineModel å®Œå…¨æŒ‡å—</h2>
<h3 data-id="heading-1">ç›®å½•</h3>
<ol>
<li><a href="#%E6%A6%82%E8%BF%B0" title="#%E6%A6%82%E8%BF%B0">æ¦‚è¿°</a></li>
<li><a href="#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5" title="#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5">åŸºç¡€æ¦‚å¿µ</a></li>
<li><a href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95" title="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95">åŸºæœ¬ç”¨æ³•</a></li>
<li><a href="#%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7" title="#%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7">é«˜çº§ç‰¹æ€§</a></li>
<li><a href="#typescript-%E6%94%AF%E6%8C%81" title="#typescript-%E6%94%AF%E6%8C%81">TypeScript æ”¯æŒ</a></li>
<li><a href="#%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B" title="#%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B">å®æˆ˜æ¡ˆä¾‹</a></li>
<li><a href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" title="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">æœ€ä½³å®è·µ</a></li>
<li><a href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" title="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">å¸¸è§é—®é¢˜</a></li>
<li><a href="#%E4%B8%8E%E4%BC%A0%E7%BB%9F%E6%96%B9%E5%BC%8F%E7%9A%84%E5%AF%B9%E6%AF%94" title="#%E4%B8%8E%E4%BC%A0%E7%BB%9F%E6%96%B9%E5%BC%8F%E7%9A%84%E5%AF%B9%E6%AF%94">ä¸ä¼ ç»Ÿæ–¹å¼çš„å¯¹æ¯”</a></li>
<li><a href="#%E6%80%BB%E7%BB%93" title="#%E6%80%BB%E7%BB%93">æ€»ç»“</a></li>
</ol>
<hr/>
<h3 data-id="heading-2">æ¦‚è¿°</h3>
<p><code>defineModel</code> æ˜¯ Vue 3.3 å¼•å…¥ã€3.4 ç¨³å®šçš„ä¸€ä¸ªç¼–è¯‘å™¨å®ï¼Œç”¨äºç®€åŒ–ç»„ä»¶çš„åŒå‘æ•°æ®ç»‘å®šå®ç°ã€‚å®ƒè®©å¼€å‘è€…èƒ½å¤Ÿæ›´è½»æ¾åœ°åˆ›å»ºæ”¯æŒ <code>v-model</code> çš„ç»„ä»¶ï¼Œå‡å°‘äº†æ ·æ¿ä»£ç ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚</p>
<h4 data-id="heading-3">ä¸ºä»€ä¹ˆéœ€è¦ defineModelï¼Ÿ</h4>
<p>åœ¨ Vue 3.3 ä¹‹å‰ï¼Œå®ç°ä¸€ä¸ªæ”¯æŒ <code>v-model</code> çš„ç»„ä»¶éœ€è¦ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼ - éœ€è¦å®šä¹‰ props å’Œ emits</span>
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>([<span class="hljs-string">'modelValue'</span>])
<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'update:modelValue'</span>])

<span class="hljs-keyword">const</span> value = <span class="hljs-title function_">computed</span>({
  <span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">modelValue</span>,
  <span class="hljs-attr">set</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-title function_">emit</span>(<span class="hljs-string">'update:modelValue'</span>, value)
})
</code></pre>
<p>è€Œä½¿ç”¨ <code>defineModel</code> åï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// defineModel æ–¹å¼ - ç®€æ´æ˜äº†</span>
<span class="hljs-keyword">const</span> modelValue = <span class="hljs-title function_">defineModel</span>()
</code></pre>
<h4 data-id="heading-4">ä¸»è¦ä¼˜åŠ¿</h4>
<ul>
<li><strong>ç®€åŒ–ä»£ç </strong>ï¼šå‡å°‘é‡å¤çš„æ ·æ¿ä»£ç </li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šæ›´å¥½çš„ TypeScript æ”¯æŒ</li>
<li><strong>ä¿®é¥°ç¬¦æ”¯æŒ</strong>ï¼šå†…ç½®å¯¹ <code>v-model</code> ä¿®é¥°ç¬¦çš„æ”¯æŒ</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç¼–è¯‘æ—¶ä¼˜åŒ–ï¼Œè¿è¡Œæ—¶å¼€é”€æ›´å°</li>
</ul>
<hr/>
<h3 data-id="heading-5">åŸºç¡€æ¦‚å¿µ</h3>
<h4 data-id="heading-6">ä»€ä¹ˆæ˜¯ç¼–è¯‘å™¨å®ï¼Ÿ</h4>
<p><code>defineModel</code> æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨å®ï¼Œè¿™æ„å‘³ç€å®ƒä¼šåœ¨æ„å»ºé˜¶æ®µè¢« Vue ç¼–è¯‘å™¨å¤„ç†ï¼Œè½¬æ¢ä¸ºç›¸åº”çš„è¿è¡Œæ—¶ä»£ç ã€‚ç¼–è¯‘å™¨å®åªåœ¨ <code>&lt;script setup&gt;</code> ä¸­ä½¿ç”¨ï¼Œä¸éœ€è¦å¯¼å…¥ã€‚</p>
<h4 data-id="heading-7">åŒå‘æ•°æ®ç»‘å®šåŸç†</h4>
<p>Vue çš„ <code>v-model</code> æœ¬è´¨ä¸Šæ˜¯è¯­æ³•ç³–ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- çˆ¶ç»„ä»¶ä½¿ç”¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"count"</span> /&gt;</span>

<span class="hljs-comment">&lt;!-- ç­‰ä»·äº --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span>
  <span class="hljs-attr">:model-value</span>=<span class="hljs-string">"count"</span>
  @<span class="hljs-attr">update:model-value</span>=<span class="hljs-string">"newValue =&gt; count = newValue"</span>
/&gt;</span>
</code></pre>
<p><code>defineModel</code> è‡ªåŠ¨å¤„ç†è¿™ç§ prop å’Œ emit çš„é…å¯¹å…³ç³»ã€‚</p>
<hr/>
<h3 data-id="heading-8">åŸºæœ¬ç”¨æ³•</h3>
<h4 data-id="heading-9">1. ç®€å•çš„æ¨¡å‹ç»‘å®š</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- ChildComponent.vue --&gt;
&lt;script setup&gt;
const modelValue = defineModel()
&lt;/script&gt;

&lt;template&gt;
  &lt;input
    v-model="modelValue"
    placeholder="è¾“å…¥å†…å®¹..."
  /&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- ParentComponent.vue --&gt;
&lt;script setup&gt;
import { ref } from 'vue'
import ChildComponent from './ChildComponent.vue'

const message = ref('Hello World')
&lt;/script&gt;

&lt;template&gt;
  &lt;ChildComponent v-model="message" /&gt;
  &lt;p&gt;å½“å‰å€¼: {{ message }}&lt;/p&gt;
&lt;/template&gt;
</code></pre>
<h4 data-id="heading-10">2. å‘½åæ¨¡å‹</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- è‡ªå®šä¹‰æ¨¡å‹åç§° --&gt;
&lt;script setup&gt;
// å£°æ˜åä¸º 'title' çš„æ¨¡å‹
const title = defineModel('title')

// å£°æ˜åä¸º 'count' çš„æ¨¡å‹
const count = defineModel('count')
&lt;/script&gt;

&lt;template&gt;
  &lt;input v-model="title" placeholder="æ ‡é¢˜" /&gt;
  &lt;input v-model="count" type="number" placeholder="æ•°é‡" /&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨ --&gt;
&lt;script setup&gt;
import { ref } from 'vue'
import CustomModelComponent from './CustomModelComponent.vue'

const postTitle = ref('')
const postCount = ref(1)
&lt;/script&gt;

&lt;template&gt;
  &lt;CustomModelComponent
    v-model:title="postTitle"
    v-model:count="postCount"
  /&gt;
  &lt;p&gt;æ ‡é¢˜: {{ postTitle }}&lt;/p&gt;
  &lt;p&gt;æ•°é‡: {{ postCount }}&lt;/p&gt;
&lt;/template&gt;
</code></pre>
<h4 data-id="heading-11">3. è®¾ç½®é»˜è®¤å€¼å’Œç±»å‹</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
// å¸¦ç±»å‹å’Œé»˜è®¤å€¼çš„æ¨¡å‹
const name = defineModel({
  type: String,
  default: 'åŒ¿åç”¨æˆ·'
})

const age = defineModel({
  type: Number,
  default: 0
})

const isActive = defineModel({
  type: Boolean,
  default: false
})
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;label&gt;å§“å: &lt;input v-model="name" /&gt;&lt;/label&gt;
    &lt;label&gt;å¹´é¾„: &lt;input v-model="age" type="number" /&gt;&lt;/label&gt;
    &lt;label&gt;
      &lt;input v-model="isActive" type="checkbox" /&gt;
      æ¿€æ´»çŠ¶æ€
    &lt;/label&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<hr/>
<h3 data-id="heading-12">é«˜çº§ç‰¹æ€§</h3>
<h4 data-id="heading-13">1. æ¨¡å‹ä¿®é¥°ç¬¦</h4>
<p><code>defineModel</code> å†…ç½®å¯¹ <code>v-model</code> ä¿®é¥°ç¬¦çš„æ”¯æŒï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- TextInput.vue --&gt;
&lt;script setup&gt;
// è·å–æ¨¡å‹å€¼å’Œä¿®é¥°ç¬¦å¯¹è±¡
const [modelValue, modelModifiers] = defineModel()

// ç›‘å¬ä¿®é¥°ç¬¦
watch(modelModifiers, (newModifiers) =&gt; {
  console.log('å½“å‰ä¿®é¥°ç¬¦:', newModifiers)
})

// ä½¿ç”¨ä¿®é¥°ç¬¦å¤„ç†æ•°æ®
const processedValue = computed({
  get: () =&gt; modelValue.value,
  set: (value) =&gt; {
    if (modelModifiers.trim) {
      value = value.trim()
    }
    if (modelModifiers.upper) {
      value = value.toUpperCase()
    }
    modelValue.value = value
  }
})
&lt;/script&gt;

&lt;template&gt;
  &lt;input v-model="processedValue" /&gt;
  &lt;p&gt;ä¿®é¥°ç¬¦: {{ JSON.stringify(modelModifiers) }}&lt;/p&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- ä½¿ç”¨ä¿®é¥°ç¬¦ --&gt;
&lt;script setup&gt;
import TextInput from './TextInput.vue'
const text = ref('')
&lt;/script&gt;

&lt;template&gt;
  &lt;TextInput v-model.trim.upper="text" /&gt;
  &lt;p&gt;å¤„ç†åçš„å€¼: {{ text }}&lt;/p&gt;
&lt;/template&gt;
</code></pre>
<h4 data-id="heading-14">2. è‡ªå®šä¹‰ä¿®é¥°ç¬¦</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- NumberInput.vue --&gt;
&lt;script setup&gt;
const [modelValue, modelModifiers] = defineModel({
  // è‡ªå®šä¹‰ getter/setter
  get(value) {
    // å¤„ç†è‡ªå®šä¹‰ä¿®é¥°ç¬¦
    if (modelModifiers.currency) {
      return new Intl.NumberFormat('zh-CN', {
        style: 'currency',
        currency: 'CNY'
      }).format(value)
    }
    if (modelModifiers.percentage) {
      return `${value}%`
    }
    return value
  },
  set(value) {
    // æ¸…ç†æ ¼å¼åŒ–åçš„å€¼
    if (modelModifiers.currency) {
      return parseFloat(value.replace(/[Â¥,]/g, ''))
    }
    if (modelModifiers.percentage) {
      return parseFloat(value.replace('%', ''))
    }
    return parseFloat(value) || 0
  }
})
&lt;/script&gt;

&lt;template&gt;
  &lt;input v-model="modelValue" /&gt;
&lt;/template&gt;
</code></pre>
<h4 data-id="heading-15">3. å¤æ‚å¯¹è±¡æ¨¡å‹</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- UserProfile.vue --&gt;
&lt;script setup&gt;
// å¤æ‚å¯¹è±¡çš„æ¨¡å‹ç»‘å®š
const user = defineModel({
  type: Object,
  default: () =&gt; ({
    name: '',
    email: '',
    age: 0,
    avatar: ''
  })
})

// è®¡ç®—å±æ€§éªŒè¯
const isFormValid = computed(() =&gt; {
  return user.value.name &amp;&amp;
         user.value.email &amp;&amp;
         user.value.email.includes('@') &amp;&amp;
         user.value.age &gt; 0
})

// æ–¹æ³•
const resetForm = () =&gt; {
  user.value = {
    name: '',
    email: '',
    age: 0,
    avatar: ''
  }
}
&lt;/script&gt;

&lt;template&gt;
  &lt;div class="user-profile"&gt;
    &lt;div class="form-group"&gt;
      &lt;label&gt;å§“å:&lt;/label&gt;
      &lt;input v-model="user.name" /&gt;
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;label&gt;é‚®ç®±:&lt;/label&gt;
      &lt;input v-model="user.email" type="email" /&gt;
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;label&gt;å¹´é¾„:&lt;/label&gt;
      &lt;input v-model="user.age" type="number" /&gt;
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;label&gt;å¤´åƒURL:&lt;/label&gt;
      &lt;input v-model="user.avatar" /&gt;
    &lt;/div&gt;

    &lt;button @click="resetForm"&gt;é‡ç½®&lt;/button&gt;
    &lt;p v-if="!isFormValid" class="error"&gt;
      è¯·å¡«å†™å®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
.user-profile {
  max-width: 400px;
  margin: 0 auto;
}

.form-group {
  margin-bottom: 1rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
}

.form-group input {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.error {
  color: red;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h3 data-id="heading-16">TypeScript æ”¯æŒ</h3>
<h4 data-id="heading-17">1. åŸºæœ¬ç±»å‹æ³¨è§£</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup lang="ts"&gt;
// åŸºæœ¬ç±»å‹æ³¨è§£
const text = defineModel&lt;string&gt;()
const number = defineModel&lt;number&gt;()
const boolean = defineModel&lt;boolean&gt;()

// æ•°ç»„ç±»å‹
const items = defineModel&lt;string[]&gt;({ default: () =&gt; [] })

// å¯¹è±¡ç±»å‹
interface User {
  id: number
  name: string
  email: string
}

const user = defineModel&lt;User&gt;({
  type: Object as PropType&lt;User&gt;,
  required: true
})
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-18">2. å¤æ‚ç±»å‹å®šä¹‰</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup lang="ts"&gt;
import type { PropType } from 'vue'

interface FormField {
  id: string
  label: string
  type: 'text' | 'email' | 'number' | 'textarea'
  value: string | number
  required?: boolean
  placeholder?: string
  validation?: {
    min?: number
    max?: number
    pattern?: string
  }
}

const formFields = defineModel&lt;FormField[]&gt;({
  type: Array as PropType&lt;FormField[]&gt;,
  default: () =&gt; [],
  // è‡ªå®šä¹‰éªŒè¯å‡½æ•°
  validator: (value: FormField[]) =&gt; {
    return Array.isArray(value) &amp;&amp;
           value.every(field =&gt; field.id &amp;&amp; field.label &amp;&amp; field.type)
  }
})

// è·å–ä¿®é¥°ç¬¦çš„ç±»å‹
const [modelValue, modelModifiers] = defineModel&lt;string, {
  trim?: boolean
  uppercase?: boolean
  required?: boolean
}&gt;()

// ç±»å‹å®‰å…¨çš„æ–¹æ³•
const updateField = (index: number, value: string) =&gt; {
  if (formFields.value[index]) {
    formFields.value[index].value = value
  }
}
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-19">3. æ³›å‹ç»„ä»¶</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup lang="ts"&gt;
// æ³›å‹æ¨¡å‹ç»„ä»¶
interface GenericModelProps&lt;T&gt; {
  value: T
  options?: T[]
}

// ä½¿ç”¨æ³›å‹
const modelValue = defineModel&lt;T&gt;({
  type: [String, Number, Object, Array] as PropType&lt;T&gt;,
  required: true
})

// ç±»å‹æ¨æ–­
type ModelType = typeof modelValue extends { value: infer T } ? T : never
&lt;/script&gt;
</code></pre>
<hr/>
<h3 data-id="heading-20">å®æˆ˜æ¡ˆä¾‹</h3>
<h4 data-id="heading-21">æ¡ˆä¾‹1ï¼šè‡ªå®šä¹‰è¾“å…¥ç»„ä»¶åº“</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- BaseInput.vue --&gt;
&lt;script setup lang="ts"&gt;
interface Props {
  type?: 'text' | 'email' | 'password' | 'number' | 'tel'
  placeholder?: string
  disabled?: boolean
  readonly?: boolean
  maxlength?: number
  minlength?: number
}

// æ”¯æŒå¤šç§ä¿®é¥°ç¬¦
const [modelValue, modelModifiers] = defineModel&lt;string, {
  trim?: boolean
  uppercase?: boolean
  lowercase?: boolean
  number?: boolean
}&gt;()

const props = withDefaults(defineProps&lt;Props&gt;(), {
  type: 'text',
  placeholder: '',
  disabled: false,
  readonly: false
})

const emit = defineEmits&lt;{
  focus: [event: FocusEvent]
  blur: [event: FocusEvent]
  input: [event: Event]
  change: [event: Event]
}&gt;()

// å¤„ç†ä¿®é¥°ç¬¦
const processedValue = computed({
  get: () =&gt; {
    let value = modelValue.value || ''

    if (modelModifiers.uppercase) {
      value = value.toUpperCase()
    }
    if (modelModifiers.lowercase) {
      value = value.toLowerCase()
    }

    return value
  },
  set: (value: string) =&gt; {
    if (modelModifiers.trim) {
      value = value.trim()
    }
    if (modelModifiers.number) {
      value = value.replace(/[^\d.-]/g, '')
    }
    modelValue.value = value
  }
})

// äº‹ä»¶å¤„ç†
const handleInput = (event: Event) =&gt; {
  const target = event.target as HTMLInputElement
  processedValue.value = target.value
  emit('input', event)
}

const handleChange = (event: Event) =&gt; {
  const target = event.target as HTMLInputElement
  processedValue.value = target.value
  emit('change', event)
}
&lt;/script&gt;

&lt;template&gt;
  &lt;div class="base-input"&gt;
    &lt;input
      :type="type"
      :value="processedValue"
      :placeholder="placeholder"
      :disabled="disabled"
      :readonly="readonly"
      :maxlength="maxlength"
      :minlength="minlength"
      @input="handleInput"
      @change="handleChange"
      @focus="$emit('focus', $event)"
      @blur="$emit('blur', $event)"
      class="input-field"
    /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
.base-input {
  position: relative;
  display: inline-block;
}

.input-field {
  width: 100%;
  padding: 8px 12px;
  border: 1px solid #dcdfe6;
  border-radius: 4px;
  font-size: 14px;
  transition: border-color 0.2s;
  box-sizing: border-box;
}

.input-field:focus {
  outline: none;
  border-color: #409eff;
}

.input-field:disabled {
  background-color: #f5f7fa;
  cursor: not-allowed;
}

.input-field:readonly {
  background-color: #f5f7fa;
}
&lt;/style&gt;
</code></pre>
<h4 data-id="heading-22">æ¡ˆä¾‹2ï¼šå¯ç¼–è¾‘è¡¨æ ¼ç»„ä»¶</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- EditableTable.vue --&gt;
&lt;script setup lang="ts"&gt;
interface TableColumn {
  key: string
  title: string
  width?: string
  type?: 'text' | 'number' | 'select'
  options?: Array&lt;{ label: string; value: any }&gt;
  required?: boolean
}

interface TableRow {
  [key: string]: any
}

interface Props {
  columns: TableColumn[]
  data: TableRow[]
  editable?: boolean
  addable?: boolean
  deletable?: boolean
}

const props = withDefaults(defineProps&lt;Props&gt;(), {
  editable: true,
  addable: true,
  deletable: true
})

// åŒå‘ç»‘å®šè¡¨æ ¼æ•°æ®
const tableData = defineModel&lt;TableRow[]&gt;('data', {
  type: Array as PropType&lt;TableRow[]&gt;,
  required: true
})

// è®¡ç®—å±æ€§
const hasData = computed(() =&gt; tableData.value &amp;&amp; tableData.value.length &gt; 0)

// æ–¹æ³•
const addRow = () =&gt; {
  const newRow: TableRow = {}
  props.columns.forEach(col =&gt; {
    newRow[col.key] = col.type === 'number' ? 0 : ''
  })
  tableData.value = [...tableData.value, newRow]
}

const deleteRow = (index: number) =&gt; {
  tableData.value = tableData.value.filter((_, i) =&gt; i !== index)
}

const updateCell = (rowIndex: number, columnKey: string, value: any) =&gt; {
  const newData = [...tableData.value]
  newData[rowIndex][columnKey] = value
  tableData.value = newData
}

// éªŒè¯
const validateRow = (row: TableRow): boolean =&gt; {
  return props.columns.every(col =&gt; {
    if (col.required &amp;&amp; (!row[col.key] || row[col.key] === '')) {
      return false
    }
    return true
  })
}

const validateTable = (): boolean =&gt; {
  return tableData.value.every(row =&gt; validateRow(row))
}
&lt;/script&gt;

&lt;template&gt;
  &lt;div class="editable-table"&gt;
    &lt;table class="table"&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th v-for="column in columns" :key="column.key" :style="{ width: column.width }"&gt;
            {{ column.title }}
            &lt;span v-if="column.required" class="required"&gt;*&lt;/span&gt;
          &lt;/th&gt;
          &lt;th v-if="deletable" class="action-column"&gt;æ“ä½œ&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr v-for="(row, rowIndex) in tableData" :key="rowIndex" :class="{ 'invalid-row': !validateRow(row) }"&gt;
          &lt;td v-for="column in columns" :key="column.key"&gt;
            &lt;template v-if="editable"&gt;
              &lt;input
                v-if="column.type === 'text' || !column.type"
                v-model="row[column.key]"
                @input="updateCell(rowIndex, column.key, ($event.target as HTMLInputElement).value)"
                type="text"
                class="cell-input"
              /&gt;
              &lt;input
                v-else-if="column.type === 'number'"
                v-model.number="row[column.key]"
                @input="updateCell(rowIndex, column.key, ($event.target as HTMLInputElement).value)"
                type="number"
                class="cell-input"
              /&gt;
              &lt;select
                v-else-if="column.type === 'select'"
                v-model="row[column.key]"
                @change="updateCell(rowIndex, column.key, ($event.target as HTMLSelectElement).value)"
                class="cell-select"
              &gt;
                &lt;option v-for="option in column.options" :key="option.value" :value="option.value"&gt;
                  {{ option.label }}
                &lt;/option&gt;
              &lt;/select&gt;
            &lt;/template&gt;
            &lt;template v-else&gt;
              {{ row[column.key] }}
            &lt;/template&gt;
          &lt;/td&gt;
          &lt;td v-if="deletable" class="action-column"&gt;
            &lt;button @click="deleteRow(rowIndex)" class="delete-btn"&gt;åˆ é™¤&lt;/button&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;

    &lt;div v-if="addable" class="table-actions"&gt;
      &lt;button @click="addRow" class="add-btn"&gt;æ·»åŠ è¡Œ&lt;/button&gt;
    &lt;/div&gt;

    &lt;div v-if="!validateTable()" class="validation-error"&gt;
      è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
.editable-table {
  width: 100%;
}

.table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 1rem;
}

.table th,
.table td {
  border: 1px solid #ebeef5;
  padding: 8px 12px;
  text-align: left;
}

.table th {
  background-color: #f5f7fa;
  font-weight: 600;
}

.required {
  color: #f56c6c;
}

.cell-input,
.cell-select {
  width: 100%;
  padding: 4px 8px;
  border: 1px solid #dcdfe6;
  border-radius: 4px;
  font-size: 14px;
}

.cell-input:focus,
.cell-select:focus {
  outline: none;
  border-color: #409eff;
}

.invalid-row {
  background-color: #fef0f0;
}

.action-column {
  width: 100px;
  text-align: center;
}

.delete-btn {
  padding: 4px 8px;
  background-color: #f56c6c;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.delete-btn:hover {
  background-color: #f78989;
}

.table-actions {
  margin-bottom: 1rem;
}

.add-btn {
  padding: 8px 16px;
  background-color: #409eff;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.add-btn:hover {
  background-color: #66b1ff;
}

.validation-error {
  color: #f56c6c;
  font-size: 14px;
  margin-top: 8px;
}
&lt;/style&gt;
</code></pre>
<h4 data-id="heading-23">æ¡ˆä¾‹3ï¼šæœç´¢ç­›é€‰ç»„ä»¶</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- SearchFilter.vue --&gt;
&lt;script setup lang="ts"&gt;
interface FilterOption {
  label: string
  value: any
  type?: 'text' | 'select' | 'date' | 'number'
  options?: Array&lt;{ label: string; value: any }&gt;
}

interface SearchFilterProps {
  filters: FilterOption[]
  placeholder?: string
  debounceTime?: number
}

const props = withDefaults(defineProps&lt;SearchFilterProps&gt;(), {
  placeholder: 'æœç´¢...',
  debounceTime: 300
})

// æœç´¢å…³é”®è¯æ¨¡å‹
const searchKeyword = defineModel&lt;string&gt;('keyword', {
  default: ''
})

// ç­›é€‰æ¡ä»¶æ¨¡å‹
const filterValues = defineModel&lt;Record&lt;string, any&gt;&gt;('filters', {
  default: () =&gt; ({})
})

// æœç´¢çŠ¶æ€
const isSearching = ref(false)

// é˜²æŠ–æœç´¢
const debouncedSearch = useDebounceFn(() =&gt; {
  isSearching.value = true
  setTimeout(() =&gt; {
    isSearching.value = false
  }, 500)
}, props.debounceTime)

// ç›‘å¬æœç´¢å…³é”®è¯å˜åŒ–
watch(searchKeyword, () =&gt; {
  debouncedSearch()
})

// ç›‘å¬ç­›é€‰æ¡ä»¶å˜åŒ–
watch(filterValues, () =&gt; {
  debouncedSearch()
}, { deep: true })

// é‡ç½®æœç´¢
const resetFilters = () =&gt; {
  searchKeyword.value = ''
  Object.keys(filterValues.value).forEach(key =&gt; {
    filterValues.value[key] = ''
  })
}

// æ´»è·ƒç­›é€‰æ•°é‡
const activeFilterCount = computed(() =&gt; {
  return Object.values(filterValues.value).filter(value =&gt;
    value !== '' &amp;&amp; value !== null &amp;&amp; value !== undefined
  ).length + (searchKeyword.value ? 1 : 0)
})
&lt;/script&gt;

&lt;template&gt;
  &lt;div class="search-filter"&gt;
    &lt;!-- æœç´¢è¾“å…¥æ¡† --&gt;
    &lt;div class="search-input-wrapper"&gt;
      &lt;div class="search-icon"&gt;
        &lt;svg viewBox="0 0 24 24" width="16" height="16"&gt;
          &lt;path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/&gt;
        &lt;/svg&gt;
      &lt;/div&gt;
      &lt;input
        v-model="searchKeyword"
        type="text"
        :placeholder="placeholder"
        class="search-input"
      /&gt;
      &lt;div v-if="searchKeyword" class="clear-icon" @click="searchKeyword = ''"&gt;
        &lt;svg viewBox="0 0 24 24" width="16" height="16"&gt;
          &lt;path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/&gt;
        &lt;/svg&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;!-- ç­›é€‰æ¡ä»¶ --&gt;
    &lt;div v-if="filters.length &gt; 0" class="filters-wrapper"&gt;
      &lt;div v-for="filter in filters" :key="filter.label" class="filter-item"&gt;
        &lt;label class="filter-label"&gt;{{ filter.label }}:&lt;/label&gt;

        &lt;template v-if="filter.type === 'select'"&gt;
          &lt;select v-model="filterValues[filter.label]" class="filter-select"&gt;
            &lt;option value=""&gt;å…¨éƒ¨&lt;/option&gt;
            &lt;option
              v-for="option in filter.options"
              :key="option.value"
              :value="option.value"
            &gt;
              {{ option.label }}
            &lt;/option&gt;
          &lt;/select&gt;
        &lt;/template&gt;

        &lt;template v-else-if="filter.type === 'date'"&gt;
          &lt;input
            v-model="filterValues[filter.label]"
            type="date"
            class="filter-input"
          /&gt;
        &lt;/template&gt;

        &lt;template v-else-if="filter.type === 'number'"&gt;
          &lt;input
            v-model.number="filterValues[filter.label]"
            type="number"
            class="filter-input"
          /&gt;
        &lt;/template&gt;

        &lt;template v-else&gt;
          &lt;input
            v-model="filterValues[filter.label]"
            type="text"
            :placeholder="filter.label"
            class="filter-input"
          /&gt;
        &lt;/template&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;!-- æ“ä½œæŒ‰é’® --&gt;
    &lt;div class="filter-actions"&gt;
      &lt;div v-if="activeFilterCount &gt; 0" class="active-filters"&gt;
        å·²é€‰æ‹© {{ activeFilterCount }} ä¸ªç­›é€‰æ¡ä»¶
      &lt;/div&gt;
      &lt;button
        v-if="searchKeyword || activeFilterCount &gt; 0"
        @click="resetFilters"
        class="reset-btn"
      &gt;
        é‡ç½®
      &lt;/button&gt;
    &lt;/div&gt;

    &lt;!-- æœç´¢çŠ¶æ€æŒ‡ç¤ºå™¨ --&gt;
    &lt;div v-if="isSearching" class="searching-indicator"&gt;
      æœç´¢ä¸­...
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
.search-filter {
  background-color: #f8f9fa;
  padding: 16px;
  border-radius: 8px;
  margin-bottom: 16px;
}

.search-input-wrapper {
  position: relative;
  margin-bottom: 12px;
}

.search-icon,
.clear-icon {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  color: #6c757d;
}

.search-icon {
  left: 12px;
}

.clear-icon {
  right: 12px;
  cursor: pointer;
}

.clear-icon:hover {
  color: #495057;
}

.search-input {
  width: 100%;
  padding: 8px 40px;
  border: 1px solid #ced4da;
  border-radius: 4px;
  font-size: 14px;
}

.search-input:focus {
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
}

.filters-wrapper {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 12px;
  margin-bottom: 12px;
}

.filter-item {
  display: flex;
  flex-direction: column;
}

.filter-label {
  font-size: 12px;
  color: #6c757d;
  margin-bottom: 4px;
}

.filter-input,
.filter-select {
  padding: 6px 8px;
  border: 1px solid #ced4da;
  border-radius: 4px;
  font-size: 14px;
}

.filter-input:focus,
.filter-select:focus {
  outline: none;
  border-color: #007bff;
  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
}

.filter-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.active-filters {
  font-size: 12px;
  color: #007bff;
}

.reset-btn {
  padding: 6px 12px;
  background-color: #6c757d;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 12px;
  cursor: pointer;
}

.reset-btn:hover {
  background-color: #5a6268;
}

.searching-indicator {
  margin-top: 8px;
  font-size: 12px;
  color: #007bff;
  text-align: center;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h3 data-id="heading-24">æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-25">1. ç»„ä»¶è®¾è®¡åŸåˆ™</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- âœ… å¥½çš„å®è·µï¼šå•ä¸€èŒè´£ --&gt;
&lt;script setup&gt;
// æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªä¸»è¦åŠŸèƒ½
const value = defineModel&lt;string&gt;()

// ç®€å•çš„æ•°æ®å¤„ç†é€»è¾‘
const processedValue = computed({
  get: () =&gt; value.value?.trim() || '',
  set: (val) =&gt; value.value = val.trim()
})
&lt;/script&gt;

&lt;!-- âŒ é¿å…çš„å®è·µï¼šè¿‡åº¦å¤æ‚ --&gt;
&lt;script setup&gt;
// é¿å…åœ¨åŒä¸€ä¸ªç»„ä»¶ä¸­å®šä¹‰å¤ªå¤šæ¨¡å‹
const model1 = defineModel('model1')
const model2 = defineModel('model2')
const model3 = defineModel('model3')
// ... å¤ªå¤šæ¨¡å‹ä¼šå¯¼è‡´ç»„ä»¶éš¾ä»¥ç»´æŠ¤
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-26">2. ç±»å‹å®‰å…¨</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- âœ… æ¨èçš„åšæ³•ï¼šå®Œæ•´çš„ç±»å‹å®šä¹‰ --&gt;
&lt;script setup lang="ts"&gt;
interface UserForm {
  name: string
  email: string
  age: number
  preferences: {
    theme: 'light' | 'dark'
    notifications: boolean
  }
}

const userForm = defineModel&lt;UserForm&gt;({
  type: Object as PropType&lt;UserForm&gt;,
  required: true,
  validator: (value: UserForm) =&gt; {
    return value.name &amp;&amp;
           value.email.includes('@') &amp;&amp;
           value.age &gt; 0
  }
})
&lt;/script&gt;

&lt;!-- âŒ ä¸æ¨èçš„åšæ³•ï¼šç¼ºå°‘ç±»å‹çº¦æŸ --&gt;
&lt;script setup&gt;
// ç¼ºå°‘ç±»å‹å®šä¹‰ï¼Œå®¹æ˜“å‡ºç°è¿è¡Œæ—¶é”™è¯¯
const data = defineModel() // ç±»å‹ä¸º unknown
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-27">3. é»˜è®¤å€¼å¤„ç†</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- âœ… æ¨èçš„åšæ³•ï¼šåˆç†çš„é»˜è®¤å€¼ --&gt;
&lt;script setup&gt;
// å¯¹äºå¤æ‚å¯¹è±¡ï¼Œä½¿ç”¨å‡½æ•°è¿”å›é»˜è®¤å€¼
const user = defineModel({
  type: Object,
  default: () =&gt; ({
    name: '',
    email: '',
    age: 0
  })
})

// å¯¹äºæ•°ç»„ï¼Œä½¿ç”¨ç©ºæ•°ç»„ä½œä¸ºé»˜è®¤å€¼
const items = defineModel({
  type: Array,
  default: () =&gt; []
})
&lt;/script&gt;

&lt;!-- âŒ é¿å…çš„åšæ³•ï¼šå¯å˜å¼•ç”¨çš„é»˜è®¤å€¼ --&gt;
&lt;script setup&gt;
// å¯èƒ½å¯¼è‡´å¤šä¸ªç»„ä»¶å®ä¾‹å…±äº«åŒä¸€ä¸ªå¯¹è±¡å¼•ç”¨
const user = defineModel({
  type: Object,
  default: { name: '', email: '' } // âŒ é”™è¯¯ï¼šå…±äº«å¼•ç”¨
})
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-28">4. éªŒè¯å’Œé”™è¯¯å¤„ç†</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
const email = defineModel&lt;string&gt;({
  type: String,
  required: true,
  validator: (value: string) =&gt; {
    // è‡ªå®šä¹‰éªŒè¯é€»è¾‘
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
    return emailRegex.test(value)
  }
})

// é”™è¯¯çŠ¶æ€ç®¡ç†
const errorMessage = computed(() =&gt; {
  if (email.value &amp;&amp; !validator(email.value)) {
    return 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'
  }
  return ''
})

// å®æ—¶éªŒè¯
const isValid = computed(() =&gt; {
  return !errorMessage.value
})
&lt;/script&gt;

&lt;template&gt;
  &lt;div class="form-group"&gt;
    &lt;label&gt;é‚®ç®±:&lt;/label&gt;
    &lt;input v-model="email" type="email" /&gt;
    &lt;div v-if="errorMessage" class="error-message"&gt;
      {{ errorMessage }}
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h4 data-id="heading-29">5. æ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
// âœ… ä½¿ç”¨è®¡ç®—å±æ€§è¿›è¡Œå¤æ‚çš„æ•°æ®å¤„ç†
const [modelValue, modelModifiers] = defineModel&lt;string&gt;()

const processedValue = computed({
  get: () =&gt; {
    let value = modelValue.value || ''

    // å¤æ‚çš„æ ¼å¼åŒ–é€»è¾‘
    if (modelModifiers.currency) {
      value = Number(value).toLocaleString('zh-CN', {
        style: 'currency',
        currency: 'CNY'
      })
    }

    return value
  },
  set: (value: string) =&gt; {
    // å¤„ç†ç”¨æˆ·è¾“å…¥
    if (modelModifiers.currency) {
      value = value.replace(/[Â¥,]/g, '')
    }

    modelValue.value = value
  }
})

// âŒ é¿å…åœ¨æ¨¡æ¿ä¸­è¿›è¡Œå¤æ‚è®¡ç®—
&lt;template&gt;
  &lt;!-- ä¸æ¨èï¼šåœ¨æ¨¡æ¿ä¸­è¿›è¡Œå¤æ‚è®¡ç®— --&gt;
  &lt;input :value="formatCurrency(modelValue)" @input="handleInput" /&gt;

  &lt;!-- æ¨èï¼šä½¿ç”¨è®¡ç®—å±æ€§ --&gt;
  &lt;input v-model="processedValue" /&gt;
&lt;/template&gt;
&lt;/script&gt;
</code></pre>
<hr/>
<h3 data-id="heading-30">å¸¸è§é—®é¢˜</h3>
<h4 data-id="heading-31">1. ä¸ºä»€ä¹ˆ defineModel ä¸å·¥ä½œï¼Ÿ</h4>
<p><strong>é—®é¢˜</strong>ï¼šç»„ä»¶ä¸­ä½¿ç”¨ <code>defineModel</code> ä½†æ²¡æœ‰å“åº”å¼æ•ˆæœ</p>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li>Vue ç‰ˆæœ¬ä½äº 3.3</li>
<li>æ²¡æœ‰åœ¨ <code>&lt;script setup&gt;</code> ä¸­ä½¿ç”¨</li>
<li>çˆ¶ç»„ä»¶æ²¡æœ‰æ­£ç¡®ç»‘å®š <code>v-model</code></li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- ç¡®ä¿ä½¿ç”¨ Vue 3.3+ --&gt;
&lt;script setup&gt;
// âœ… æ­£ç¡®ä½¿ç”¨
const modelValue = defineModel()
&lt;/script&gt;

&lt;!-- çˆ¶ç»„ä»¶æ­£ç¡®ç»‘å®š --&gt;
&lt;ChildComponent v-model="data" /&gt;
&lt;!-- è€Œä¸æ˜¯ --&gt;
&lt;ChildComponent :model-value="data" /&gt; &lt;!-- âŒ ç¼ºå°‘åŒå‘ç»‘å®š --&gt;
</code></pre>
<h4 data-id="heading-32">2. å¦‚ä½•å¤„ç†é»˜è®¤å€¼çš„åŒæ­¥é—®é¢˜ï¼Ÿ</h4>
<p><strong>é—®é¢˜</strong>ï¼šå­ç»„ä»¶è®¾ç½®äº†é»˜è®¤å€¼ï¼Œä½†çˆ¶ç»„ä»¶æ²¡æœ‰æä¾›å€¼æ—¶å‡ºç°åŒæ­¥é—®é¢˜</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
// âœ… æ¨èåšæ³•ï¼šä½¿ç”¨æœ¬åœ°çŠ¶æ€ç®¡ç†é»˜è®¤å€¼
const props = defineProps({
  modelValue: String
})

const emit = defineEmits(['update:modelValue'])

// ä½¿ç”¨è®¡ç®—å±æ€§å¤„ç†é»˜è®¤å€¼
const internalValue = computed({
  get: () =&gt; props.modelValue || 'é»˜è®¤å€¼',
  set: (value) =&gt; emit('update:modelValue', value)
})

// æˆ–è€…ä½¿ç”¨ defineModel çš„ default é€‰é¡¹
const modelValue = defineModel({
  type: String,
  default: 'é»˜è®¤å€¼'
})
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-33">3. TypeScript ç±»å‹æ¨æ–­å¤±è´¥</h4>
<p><strong>é—®é¢˜</strong>ï¼šTypeScript æ— æ³•æ­£ç¡®æ¨æ–­ <code>defineModel</code> çš„ç±»å‹</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup lang="ts"&gt;
// âœ… æ˜¾å¼ç±»å‹æ³¨è§£
const text = defineModel&lt;string&gt;()

interface FormData {
  name: string
  email: string
}

const formData = defineModel&lt;FormData&gt;({
  type: Object as PropType&lt;FormData&gt;
})

// âœ… ä½¿ç”¨æ³›å‹çº¦æŸ
const model = defineModel&lt;T extends string | number ? T : string&gt;({
  type: [String, Number] as PropType&lt;T&gt;
})
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-34">4. ä¿®é¥°ç¬¦ä¸ç”Ÿæ•ˆ</h4>
<p><strong>é—®é¢˜</strong>ï¼šè‡ªå®šä¹‰ä¿®é¥°ç¬¦æ²¡æœ‰æŒ‰é¢„æœŸå·¥ä½œ</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
// âœ… æ­£ç¡®ä½¿ç”¨ä¿®é¥°ç¬¦
const [modelValue, modelModifiers] = defineModel({
  // åœ¨ set å‡½æ•°ä¸­å¤„ç†ä¿®é¥°ç¬¦
  set(value) {
    if (modelModifiers.trim) {
      return value.trim()
    }
    return value
  }
})
&lt;/script&gt;

&lt;!-- ä½¿ç”¨æ—¶æ·»åŠ ä¿®é¥°ç¬¦ --&gt;
&lt;ChildComponent v-model.trim="data" /&gt;
</code></pre>
<h4 data-id="heading-35">5. å¦‚ä½•é¿å…æ— é™æ›´æ–°å¾ªç¯ï¼Ÿ</h4>
<p><strong>é—®é¢˜</strong>ï¼šåœ¨ getter å’Œ setter ä¸­è®¾ç½®å€¼æ—¶å¯¼è‡´æ— é™å¾ªç¯</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
const [modelValue, modelModifiers] = defineModel()

// âœ… é¿å…åœ¨ getter ä¸­ä¿®æ”¹åŸå€¼
const processedValue = computed({
  get: () =&gt; {
    // åªè¯»å–ï¼Œä¸ä¿®æ”¹
    let value = modelValue.value || ''

    if (modelModifiers.uppercase) {
      return value.toUpperCase()
    }

    return value
  },
  set: (value) =&gt; {
    // åœ¨ setter ä¸­è¿›è¡Œå®é™…ä¿®æ”¹
    let finalValue = value

    if (modelModifiers.trim) {
      finalValue = value.trim()
    }

    // ç›´æ¥è®¾ç½®ï¼Œé¿å…è§¦å‘ getter
    modelValue.value = finalValue
  }
})
&lt;/script&gt;
</code></pre>
<hr/>
<h3 data-id="heading-36">ä¸ä¼ ç»Ÿæ–¹å¼çš„å¯¹æ¯”</h3>
<h4 data-id="heading-37">1. ä»£ç é‡å¯¹æ¯”</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- âŒ ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦å¤§é‡æ ·æ¿ä»£ç  --&gt;
&lt;script setup&gt;
const props = defineProps({
  modelValue: String,
  title: String,
  count: Number
})

const emit = defineEmits([
  'update:modelValue',
  'update:title',
  'update:count'
])

const value = computed({
  get: () =&gt; props.modelValue,
  set: (value) =&gt; emit('update:modelValue', value)
})

const titleValue = computed({
  get: () =&gt; props.title,
  set: (value) =&gt; emit('update:title', value)
})

const countValue = computed({
  get: () =&gt; props.count,
  set: (value) =&gt; emit('update:count', value)
})
&lt;/script&gt;

&lt;!-- âœ… defineModel æ–¹å¼ï¼šç®€æ´æ˜äº† --&gt;
&lt;script setup&gt;
const modelValue = defineModel()
const title = defineModel('title')
const count = defineModel('count')
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-38">2. ä¿®é¥°ç¬¦æ”¯æŒå¯¹æ¯”</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- âŒ ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦æ‰‹åŠ¨å¤„ç†ä¿®é¥°ç¬¦ --&gt;
&lt;script setup&gt;
const props = defineProps({
  modelValue: String,
  modelModifiers: {
    type: Object,
    default: () =&gt; ({})
  }
})

const emit = defineEmits(['update:modelValue'])

const value = computed({
  get: () =&gt; props.modelValue,
  set: (value) =&gt; {
    if (props.modelModifiers.trim) {
      value = value.trim()
    }
    emit('update:modelValue', value)
  }
})
&lt;/script&gt;

&lt;!-- âœ… defineModel æ–¹å¼ï¼šå†…ç½®ä¿®é¥°ç¬¦æ”¯æŒ --&gt;
&lt;script setup&gt;
const [modelValue, modelModifiers] = defineModel({
  set(value) {
    if (modelModifiers.trim) {
      return value.trim()
    }
    return value
  }
})
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-39">3. TypeScript æ”¯æŒå¯¹æ¯”</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- âŒ ä¼ ç»Ÿæ–¹å¼ï¼šç±»å‹æ¨æ–­ä¸å¤Ÿç›´è§‚ --&gt;
&lt;script setup lang="ts"&gt;
interface Props {
  modelValue?: string
}

const props = defineProps&lt;Props&gt;()
const emit = defineEmits&lt;{
  'update:modelValue': [value: string]
}&gt;()

const value = computed&lt;string&gt;({
  get: () =&gt; props.modelValue || '',
  set: (value) =&gt; emit('update:modelValue', value)
})
&lt;/script&gt;

&lt;!-- âœ… defineModel æ–¹å¼ï¼šç±»å‹æ¨æ–­æ›´ç›´æ¥ --&gt;
&lt;script setup lang="ts"&gt;
const value = defineModel&lt;string&gt;({
  default: ''
})
&lt;/script&gt;
</code></pre>
<hr/>
<h3 data-id="heading-40">æ€»ç»“</h3>
<p><code>defineModel</code> æ˜¯ Vue 3 ç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸€ä¸ªé‡è¦æ”¹è¿›ï¼Œå®ƒæ˜¾è‘—ç®€åŒ–äº†ç»„ä»¶åŒå‘æ•°æ®ç»‘å®šçš„å®ç°ã€‚é€šè¿‡æœ¬æ–‡æ¡£çš„å­¦ä¹ ï¼Œæˆ‘ä»¬äº†è§£åˆ°ï¼š</p>
<h4 data-id="heading-41">æ ¸å¿ƒä¼˜åŠ¿</h4>
<ol>
<li><strong>ç®€åŒ–å¼€å‘</strong>ï¼šå¤§å¹…å‡å°‘æ ·æ¿ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šä¼˜ç§€çš„ TypeScript æ”¯æŒï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç¼–è¯‘æ—¶ä¼˜åŒ–ï¼Œè¿è¡Œæ—¶å¼€é”€æ›´å°</li>
<li><strong>åŠŸèƒ½ä¸°å¯Œ</strong>ï¼šå†…ç½®ä¿®é¥°ç¬¦æ”¯æŒå’Œå¤æ‚çš„é…ç½®é€‰é¡¹</li>
</ol>
<h4 data-id="heading-42">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li><strong>è¡¨å•ç»„ä»¶</strong>ï¼šè¾“å…¥æ¡†ã€é€‰æ‹©å™¨ã€æ—¥æœŸé€‰æ‹©å™¨ç­‰</li>
<li><strong>æ•°æ®å±•ç¤ºç»„ä»¶</strong>ï¼šéœ€è¦ç¼–è¾‘åŠŸèƒ½çš„æ•°æ®è¡¨æ ¼</li>
<li><strong>é…ç½®é¢æ¿</strong>ï¼šå„ç§è®¾ç½®å’Œé…ç½®ç•Œé¢</li>
<li><strong>æœç´¢ç­›é€‰</strong>ï¼šå¤æ‚çš„æœç´¢å’Œç­›é€‰ç»„ä»¶</li>
</ul>
<h4 data-id="heading-43">å­¦ä¹ å»ºè®®</h4>
<ol>
<li><strong>ä»åŸºç¡€å¼€å§‹</strong>ï¼šå…ˆæŒæ¡åŸºæœ¬çš„ <code>v-model</code> ç»‘å®š</li>
<li><strong>é€æ­¥æ·±å…¥</strong>ï¼šå­¦ä¹ ä¿®é¥°ç¬¦å’Œé«˜çº§é…ç½®</li>
<li><strong>å®è·µé¡¹ç›®</strong>ï¼šåœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨ <code>defineModel</code></li>
<li><strong>å¯¹æ¯”å­¦ä¹ </strong>ï¼šäº†è§£ä¼ ç»Ÿæ–¹å¼çš„å·®å¼‚ï¼Œæ›´å¥½åœ°ç†è§£ <code>defineModel</code> çš„ä¼˜åŠ¿</li>
</ol>
<h4 data-id="heading-44">æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>ç¡®ä¿ Vue ç‰ˆæœ¬ä¸º 3.3 æˆ–æ›´é«˜</li>
<li>å¿…é¡»åœ¨ <code>&lt;script setup&gt;</code> ä¸­ä½¿ç”¨</li>
<li>æ³¨æ„é»˜è®¤å€¼çš„å¤„ç†æ–¹å¼</li>
<li>åˆç†ä½¿ç”¨ TypeScript ç±»å‹çº¦æŸ</li>
</ul>
<p><code>defineModel</code> ä»£è¡¨äº† Vue.js æŒç»­æ”¹è¿›ç»„ä»¶å¼€å‘ä½“éªŒçš„åŠªåŠ›ï¼ŒæŒæ¡è¿™ä¸€ç‰¹æ€§å°†å¸®åŠ©å¼€å‘è€…æ„å»ºæ›´ç®€æ´ã€æ›´å¯ç»´æŠ¤çš„ Vue åº”ç”¨ç¨‹åºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯·æ±‚å¤±è´¥æº¯æºNettyå…³é—­è¿æ¥æºç æµç¨‹]]></title>    <link>https://juejin.cn/post/7573595009552564234</link>    <guid>https://juejin.cn/post/7573595009552564234</guid>    <pubDate>2025-11-18T02:30:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573595009552564234" data-draft-id="7573241978902249487" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯·æ±‚å¤±è´¥æº¯æºNettyå…³é—­è¿æ¥æºç æµç¨‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-18T02:30:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é‡è‹±ç‹¼"/> <meta itemprop="url" content="https://juejin.cn/user/1077941042943336"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯·æ±‚å¤±è´¥æº¯æºNettyå…³é—­è¿æ¥æºç æµç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1077941042943336/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é‡è‹±ç‹¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:30:48.000Z" title="Tue Nov 18 2025 02:30:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>proxyå®•æœºã€é‡å¯åï¼Œä¸šåŠ¡ä»ä¸æ–­æœ‰å‘½ä»¤æ‰§è¡Œå¤±è´¥é•¿å°¾ç°è±¡ï¼›ç°è±¡éå¸¸è¯¡å¼‚ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ä¸šåŠ¡éƒ½ä¼šæœ‰ä¸€ä¸ªæŠ¥é”™ï¼š<code> new RedisException("Currently not connected. Commands are rejected.");</code>
æœ¬æ–‡æ¢³ç†äº†ä¸€ä¸‹Nettyã€Lettuceçš„å…³é—­æµç¨‹æºç ï¼ŒæŠ½ä¸å‰¥èŒ§ï¼Œæ‰¾åˆ°é—®é¢˜æ ¹å› ï¼›</p>
<h2 data-id="heading-1">æ•´ä½“æµç¨‹</h2>
<p>å…ˆé™„ä¸Šæ•´ä½“çš„æ€ç»´å¯¼å›¾ï¼Œç„¶ååœ¨åˆ†æNettyã€Lettuceçš„å…³é—­è¿æ¥çš„æºç ï¼›</p>
<h3 data-id="heading-2">æ€ç»´å¯¼å›¾</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6427a6490e24de38292980c674045d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeO6Iux54u8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764037848&amp;x-signature=N6wwP1Gk4kMuKUj8hhbjwvil7pg%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">æºç è§£æ</h2>
<p>æ³¨ï¼š æœ¬æ–‡åŸºäºNetty 4.1.38 &amp; Lettuce 5.2.0è¿›è¡Œåˆ†æ</p>
<p>æ³¨ï¼šä¸ºä»€ä¹ˆåˆ†æçš„æ˜¯Nioæ¨¡å‹ï¼Œä¸æ˜¯åˆ†æEpollæ¨¡å‹ï¼›å› ä¸ºæˆ‘å¸é­”æ”¹çš„jdk17åç¨‹æ¨¡å‹ä»…æ”¯æŒnioï¼›</p>
<h3 data-id="heading-4">1ã€IOå…¥å£ï¼šNioByteUnsafe#read</h3>
<p>å®¢æˆ·ç«¯åˆ†æï¼š</p>
<ol>
<li>è·å–ä¸€ç³»åˆ—å¯¹è±¡ï¼šChannelConfigã€ChannelPipelineã€RecvByteBufAllocator</li>
<li>ä»Socketè¯»å–æ•°æ®ï¼Œä¿å­˜åˆ°ByteBufä¸­ï¼ˆDefaultMaxMessageRecvByteBufAllocator å…·æœ‰å¼¹æ€§æ‰©ç¼©å®¹çš„èƒ½åŠ›ï¼Œåç»­åœ¨è®¨è®ºï¼‰</li>
<li>è°ƒç”¨pipeline.channelRead()å°†è¯»å–çš„æ•°æ®å¹¿æ’­åˆ°ChannelInboundHandler</li>
<li>å¦‚æœæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œåˆ™æœ€å¤šé€’å½’16æ¬¡ï¼Œ å¦‚æœè¿˜æ²¡æœ‰è¯»å–å®Œæˆï¼Œæ”¾åˆ°ä¸‹æ¬¡IOè¯»å–çš„æ—¶å€™ï¼Œå†è¯»ï¼›é¿å…ç”±äºæŸæ¬¡è¯·æ±‚ä½“æ¯”è¾ƒå¤§è€Œå¯¼è‡´å…¶ä»–çš„è¯·æ±‚é˜»å¡ï¼Œé€ æˆé›ªå´©å½±å“ï¼›</li>
<li>è¯»å–å®Œæˆï¼Œè°ƒç”¨channelReadComplete()</li>
<li>å½“socketè¯»å–çš„ç»“æœæ˜¯-1æ—¶ï¼Œåˆ™è¯´æ˜æœåŠ¡ç«¯æ­£åœ¨å…³é—­è¿™ä¸ªè¿æ¥ï¼ˆå‘é€FINåŒ…ï¼‰ï¼›è¿›è€Œè°ƒç”¨closeOnRead</li>
<li>é‚£ä»€ä¹ˆæ—¶å€™æŠ›å‡ºThrowableï¼Ÿ1. ä¸šåŠ¡å¼‚å¸¸ï¼Œ 2. æœåŠ¡ç«¯å¼‚å¸¸ï¼Œå‘é€äº†RSTåŒ…:</li>
</ol>
<p>æµç¨‹å¤§æ¦‚æ¸…æ¥šäº†ï¼Œé‚£æˆ‘ä»¬é‡ç‚¹éœ€è¦åˆ†æä¸‹æ­£å¸¸å…³é—­ï¼ˆFINåŒ…ï¼‰ã€å¼‚å¸¸å…³é—­ï¼ˆRSTåŒ…ï¼‰çš„æµç¨‹</p>
<pre><code class="hljs language-ini" lang="ini">public final void read() {
    final ChannelConfig <span class="hljs-attr">config</span> = config()<span class="hljs-comment">;</span>
    if (shouldBreakReadReady(config)) {
        clearReadPending()<span class="hljs-comment">;</span>
        return<span class="hljs-comment">;</span>
    }
    final ChannelPipeline <span class="hljs-attr">pipeline</span> = pipeline()<span class="hljs-comment">;</span>
    final ByteBufAllocator <span class="hljs-attr">allocator</span> = config.getAllocator()<span class="hljs-comment">;</span>
    final RecvByteBufAllocator.Handle <span class="hljs-attr">allocHandle</span> = recvBufAllocHandle()<span class="hljs-comment">;</span>
    allocHandle.reset(config)<span class="hljs-comment">;</span>

    ByteBuf <span class="hljs-attr">byteBuf</span> = null<span class="hljs-comment">;</span>
    boolean <span class="hljs-attr">close</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
    try {
        do {
            <span class="hljs-attr">byteBuf</span> = allocHandle.allocate(allocator)<span class="hljs-comment">;</span>
            allocHandle.lastBytesRead(doReadBytes(byteBuf))<span class="hljs-comment">;</span>
            if (allocHandle.lastBytesRead() &lt;= 0) {
                // nothing was read. release the buffer.
                byteBuf.release()<span class="hljs-comment">;</span>
                <span class="hljs-attr">byteBuf</span> = null<span class="hljs-comment">;</span>
                <span class="hljs-attr">close</span> = allocHandle.lastBytesRead() &lt; <span class="hljs-number">0</span><span class="hljs-comment">;</span>
                if (close) {
                    // There is nothing left to read as we received an <span class="hljs-attr">EOF.
                    readPending</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
                }
                break<span class="hljs-comment">;</span>
            }

            allocHandle.incMessagesRead(1)<span class="hljs-comment">;</span>
            <span class="hljs-attr">readPending</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
            pipeline.fireChannelRead(byteBuf)<span class="hljs-comment">;</span>
            <span class="hljs-attr">byteBuf</span> = null<span class="hljs-comment">;</span>
        } while (allocHandle.continueReading())<span class="hljs-comment">;</span>

        allocHandle.readComplete()<span class="hljs-comment">;</span>
        pipeline.fireChannelReadComplete()<span class="hljs-comment">;</span>

        // é‡ç‚¹åˆ†æ
        if (close) {
            closeOnRead(pipeline)<span class="hljs-comment">;</span>
        }
    } catch (Throwable t) {
            // é‡ç‚¹åˆ†æ
        handleReadException(pipeline, byteBuf, t, close, allocHandle)<span class="hljs-comment">;</span>
    } finally {
        // Check if there is a readPending which was not processed yet.
        // This could be for two reasons:
        // * The user called Channel.read() or ChannelHandlerContext.read() in channelRead(...) method
        // * The user called Channel.read() or ChannelHandlerContext.read() in channelReadComplete(...) method
        //
        // See https://github.com/netty/netty/issues/2254
        if (!readPending &amp;&amp; !config.isAutoRead()) {
            removeReadOp()<span class="hljs-comment">;</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-5">2ã€å¼‚å¸¸å…³é—­æµç¨‹ï¼šNioByteUnsafe#handleReadException</h3>
<p>ä¸ºä»€ä¹ˆè¦å…ˆä»‹ç»å¼‚å¸¸å…³é—­ï¼Œå› ä¸ºå¼‚å¸¸å…³é—­æµç¨‹é‡Œé¢åŒ…å«æ­£å¸¸å…³é—­æµç¨‹ï¼›</p>
<ol>
<li>å¦‚æœbytebufä¸­æœ‰æ•°æ®ï¼Œé‚£æŠŠå·²ç»æ¥æ”¶çš„æ•°æ®å¹¿æ’­å‡ºå»ï¼ˆchannelReadï¼‰ï¼›</li>
<li>å†å¹¿æ’­chanelReadCompleteäº‹ä»¶</li>
<li>å†å¹¿æ’­exceptionCaughtäº‹ä»¶</li>
<li>å¦‚æœæ˜¯IOException ï¼Œåˆ™éœ€è¦å°†Sockeå…³é—­ï¼Œèµ°ä¸€ä¸‹æ­£å¸¸å…³é—­æµç¨‹ï¼›</li>
</ol>
<p>ps:åœ¨hotspotæºç ä¸­IOè¯»å–çš„æ—¶å€™ï¼šå¦‚æœè¯»å–å¤±è´¥ï¼Œåˆ†åˆ«ä¼šæŠ›å‡ºConnectionResetExceptionã€SocketExceptionã€InterruptedExceptionï¼› å…¶ä¸­ConnectionResetExceptionå’ŒSocketExceptionæ˜¯IOExceptionï¼Œ è€ŒInterruptedExceptionåˆ™æ˜¯ç”±äºè®¾ç½®äº†çº¿ç¨‹ä¸­æ–­æ ‡è¯†ï¼Œè€ŒæŠ›å‡ºçš„ï¼›</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88074898ad2b45da8d4354433e3e2c2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeO6Iux54u8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764037848&amp;x-signature=Dhb8GFdNTn3MDMgUIA8wU3zawgQ%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-scss" lang="scss">private void <span class="hljs-built_in">handleReadException</span>(ChannelPipeline pipeline, ByteBuf byteBuf, Throwable cause, boolean close,
        RecvByteBufAllocator.Handle allocHandle) {
    if (byteBuf != null) {
        if (byteBuf.isReadable()) {
            readPending = false;
            pipeline<span class="hljs-selector-class">.fireChannelRead</span>(byteBuf);
        } else {
            byteBuf<span class="hljs-selector-class">.release</span>();
        }
    }
    allocHandle<span class="hljs-selector-class">.readComplete</span>();
    pipeline<span class="hljs-selector-class">.fireChannelReadComplete</span>();
    pipeline<span class="hljs-selector-class">.fireExceptionCaught</span>(cause);
    <span class="hljs-comment">// é‡ç‚¹åœ¨æ­¤</span>
    if (close || cause instanceof IOException) {
        <span class="hljs-built_in">closeOnRead</span>(pipeline);
    }
}
</code></pre>
<h3 data-id="heading-6">3ã€æ­£å¸¸å…³é—­æµç¨‹ï¼šNioByteUnsafe#closeOnRead</h3>
<ol>
<li>å¦‚æœè¾“å…¥æ²¡æœ‰å…³é—­å¹¶ä¸”æ˜¯åŠå…³é—­åŠŸèƒ½ï¼Œåˆ™ä¼šå…³é—­è¾“å…¥é€šé“ï¼ŒåŒæ—¶ä¸‹å‘ChannelInputShutdownEventäº‹ä»¶</li>
<li>å¦‚æœè¾“å…¥æ²¡æœ‰å…³é—­ï¼Œåˆ™ç›´æ¥è°ƒç”¨closeï¼Œè¿›è¡Œå…³é—­è¯¥è¿æ¥</li>
<li>å¦‚æœè¾“å…¥å·²ç»å…³é—­ï¼Œåˆ™ä¸‹å‘ä¸€ä¸ªChannelInputShutdownReadCompleteäº‹ä»¶ï¼›</li>
</ol>
<p>æ³¨ï¼šä»€ä¹ˆæ˜¯åŠå…³é—­ï¼Ÿ</p>
<p>å…ˆæ¥ä¸€å¼ TCPçš„4æ¬¡æŒ¥æ‰‹ç¤ºæ„å›¾ï¼Œä½“ä¼šä¸€ä¸‹ï¼›</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bbc52551acc46269a9c8b8e01b0b8fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeO6Iux54u8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764037848&amp;x-signature=Oq0DimlQgSooBeq6Q0A2H9RrlvU%3D" alt="image.png" loading="lazy"/>
æ ¹æ®ä¸Šå›¾è§£é‡Š</p>
<ol>
<li>åœ¨TCPä¸­ï¼Œé€šä¿¡æ˜¯å…¨åŒå·¥çš„ï¼ŒåŒæ—¶å¯ä»¥è¿›è¡Œè¯»å†™ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„è¯»ã€å†™ç¼“å†²åŒºï¼›Half-Closureï¼šé€šä¿¡çš„ä»»ä½•ä¸€æ–¹éƒ½å¯ä»¥å…ˆå…³é—­è¾“å…¥æ–¹å‘ï¼Œè€Œä¿ç•™æ¥æ”¶æ–¹å‘ï¼Œç›´è‡³å¯¹æ–¹ä¹Ÿå…³é—­äº†è¿æ¥ï¼›</li>
<li>åœ¨Nettyé‡Œé¢ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¥æ”¶FINåŒ…ä»¥åï¼Œé»˜è®¤ä¼šå°†socketè¿›è¡Œå…³é—­ï¼›ä¹Ÿå°±æ˜¯è¯´socketçš„è¯»å†™é€šé“<strong>å…¨å…³æ‰</strong>äº†ï¼›æ²¡é”™ï¼›<strong>å…¨å…³æ‰</strong> ï¼›</li>
<li>è¿™æœ‰ç‚¹ä¸ç¬¦åˆTCPçš„4æ¬¡æŒ¥æ‰‹çš„è®¾è®¡ï¼Œå› ä¸ºæœ‰å¯èƒ½æœ‰ä¸€ç«¯(Cç«¯)ä¸»åŠ¨å‘èµ·äº†FINåŒ…ï¼Œå¦ä¸€ç«¯ï¼ˆSç«¯ï¼‰æ¥æ”¶åˆ°FINåŒ…ï¼Œå›ACKåŒ…ä»¥åï¼›Sç«¯æ˜¯å¯ä»¥ç»§ç»­å‘é€å†™è¯·æ±‚çš„ï¼Œå› ä¸ºSç«¯è¿˜æ²¡æœ‰ä¸»åŠ¨å‘FINåŒ…ï¼›</li>
<li>å¦‚æœåœ¨Nettyé‡Œé¢æƒ³è¦å¼€å¯è¿™ä¸ªåŠŸèƒ½ï¼Œ å°±éœ€è¦è¿›è¡Œé…ç½®ï¼›<code>bootstrap.childOption(ChannelOption.ALLOW_HALF_CLOSURE, true)</code>ï¼›</li>
</ol>
<p>ä½†æ˜¯åœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œéƒ½ä¸éœ€è¦åŠå…³é—­åŠŸèƒ½ï¼Œæ‰€ä»¥ç›´æ¥ç²—æš´ã€ç®€å•ä¸€äº›ï¼Œä¸€æ—¦ä¸€æ–¹å‘é€FINåŒ…ï¼Œé‚£å¦ä¸€æ–¹æ‹’ç»æ‰€æœ‰çš„è¯»å†™è¯·æ±‚ï¼›ç›´æ¥close socketï¼›</p>
<pre><code class="hljs language-scss" lang="scss">private void <span class="hljs-built_in">closeOnRead</span>(ChannelPipeline pipeline) {
    if (!isInputShutdown0()) {
        if (isAllowHalfClosure(config())) {
            <span class="hljs-built_in">shutdownInput</span>();
            pipeline<span class="hljs-selector-class">.fireUserEventTriggered</span>(ChannelInputShutdownEvent.INSTANCE);
        } else {
            <span class="hljs-built_in">close</span>(voidPromise());
        }
    } else {
        inputClosedSeenErrorOnRead = true;
        pipeline<span class="hljs-selector-class">.fireUserEventTriggered</span>(ChannelInputShutdownReadComplete.INSTANCE);
    }
}
</code></pre>
<h4 data-id="heading-7">3.1 å¦‚ä½•å…³é—­ï¼ŸNioByteUnsafe.close</h4>
<p>io.netty.channel.AbstractChannel.AbstractUnsafe#close</p>
<ol>
<li>å¦‚æœpromiseä¸æ˜¯VoidChannelPromiseï¼Œç›´æ¥è¿”å›ï¼Œé¿å…è¯¯åˆ¤ï¼›</li>
<li>å¦‚æœå·²ç»closeè¿‡äº†ï¼Œåˆ™æ ¹æ®futureçš„ç»“æœåˆ¤æ–­ï¼Œæ˜¯ç›´æ¥å›å¡«ï¼Œè¿˜æ˜¯æ·»åŠ listenerï¼Œåœ¨æœªæ¥å›å¡«</li>
<li>ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼ŒcloseInitiated=falseï¼Œæ‰€ä»¥ä¼šèµ°ä¸‹é¢é€»è¾‘ï¼›</li>
<li>å…ˆåˆ¤æ–­activeçŠ¶æ€ï¼Œ</li>
<li>å¦‚æœsolinger&gt;0ï¼Œ åˆ™ä¼šå°†SelectionKeyä»selectorè¿›è¡Œcancelæ‰ï¼›ç”±äºsolingerçš„ç‰¹æ®Šæ€§ï¼Œåœ¨shutdownå‰ä¼šç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œæ‰€ä»¥ä¼šæœ‰é˜»å¡çš„é£é™©ï¼ŒåŸºäºæ­¤ï¼Œä¼šå°†closeçš„æµç¨‹æ”¾åˆ°å¼‚æ­¥çº¿ç¨‹ä¸­æ‰§è¡Œ</li>
<li>closeæµç¨‹å°±æ˜¯è°ƒç”¨socket.close()ã€promoiseç»“æœå›å¡«</li>
<li>å¦‚æœoutboundBufferä¸ä¸ºç©ºï¼ŒæŠŠflushedå’Œunflushedé˜Ÿåˆ—ä¸­çš„æ•°æ®éƒ½æ¸…ç©ºï¼›</li>
<li>è°ƒç”¨fireChannelInactiveAndDeregisteræ–¹æ³•ï¼Œä¸‹å‘channelInactiveäº‹ä»¶å’ŒchannelDeregisteräº‹ä»¶</li>
</ol>

<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">(<span class="hljs-keyword">final</span> ChannelPromise promise, <span class="hljs-keyword">final</span> Throwable cause,
                   <span class="hljs-keyword">final</span> ClosedChannelException closeCause, <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> notify)</span> {
    <span class="hljs-keyword">if</span> (!promise.setUncancellable()) {
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">if</span> (closeInitiated) {
        <span class="hljs-keyword">if</span> (closeFuture.isDone()) {
            <span class="hljs-comment">// Closed already.</span>
            safeSetSuccess(promise);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!(promise <span class="hljs-keyword">instanceof</span> VoidChannelPromise)) { <span class="hljs-comment">// Only needed if no VoidChannelPromise.</span>
            <span class="hljs-comment">// This means close() was called before so we just register a listener and return</span>
            closeFuture.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelFutureListener</span>() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operationComplete</span><span class="hljs-params">(ChannelFuture future)</span> <span class="hljs-keyword">throws</span> Exception {
                    promise.setSuccess();
                }
            });
        }
        <span class="hljs-keyword">return</span>;
    }

    closeInitiated = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">wasActive</span> <span class="hljs-operator">=</span> isActive();
    <span class="hljs-keyword">final</span> <span class="hljs-type">ChannelOutboundBuffer</span> <span class="hljs-variable">outboundBuffer</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.outboundBuffer;
    <span class="hljs-built_in">this</span>.outboundBuffer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// Disallow adding any messages and flushes to outboundBuffer.</span>
    <span class="hljs-type">Executor</span> <span class="hljs-variable">closeExecutor</span> <span class="hljs-operator">=</span> prepareToClose();
    <span class="hljs-keyword">if</span> (closeExecutor != <span class="hljs-literal">null</span>) {
        closeExecutor.execute(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// Execute the close.</span>
                    doClose0(promise);
                } <span class="hljs-keyword">finally</span> {
                    <span class="hljs-comment">// Call invokeLater so closeAndDeregister is executed in the EventLoop again!</span>
                    invokeLater(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
                        <span class="hljs-meta">@Override</span>
                        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                            <span class="hljs-keyword">if</span> (outboundBuffer != <span class="hljs-literal">null</span>) {
                                <span class="hljs-comment">// Fail all the queued messages</span>
                                outboundBuffer.failFlushed(cause, notify);
                                outboundBuffer.close(closeCause);
                            }
                            fireChannelInactiveAndDeregister(wasActive);
                        }
                    });
                }
            }
        });
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// Close the channel and fail the queued messages in all cases.</span>
            doClose0(promise);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (outboundBuffer != <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">// Fail all the queued messages.</span>
                outboundBuffer.failFlushed(cause, notify);
                outboundBuffer.close(closeCause);
            }
        }
        <span class="hljs-keyword">if</span> (inFlush0) {
            invokeLater(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                    fireChannelInactiveAndDeregister(wasActive);
                }
            });
        } <span class="hljs-keyword">else</span> {
            fireChannelInactiveAndDeregister(wasActive);
        }
    }
}
</code></pre>
<h4 data-id="heading-8">3.2 channelInactiveäº‹ä»¶ä¼ æ’­</h4>
<p>åœ¨Lettuce SDKä¸­ï¼Œä¸»è¦çš„ChannelHandlerä¸»è¦æœ‰ï¼šCommandHandlerã€CommandEncoderã€ConnectionEventTriggerã€ConnectionWatchDogï¼Œ åˆ†åˆ«ä»‹ç»ä¸€ä¸‹è¿™å››ä¸ªChannelHandlerçš„åŠŸèƒ½ï¼›</p>
<ol>
<li>CommandHandlerï¼šä¸»è¦æ˜¯ç”¨äºè§£ç  ï¼› <strong>é‡ç‚¹</strong></li>
<li>CommandEncoderï¼šå°†redisåŠ å¯†æˆRESPæ ¼å¼çš„æ•°æ®</li>
<li>ConnectionEventTriggerï¼šè¿æ¥äº‹ä»¶çš„è§¦å‘å™¨ï¼Œç”¨äºè®¾ç½®åœ¨è¿æ¥å„ä¸ªçŠ¶æ€çš„å›è°ƒé’©å­ï¼›<strong>é‡ç‚¹</strong></li>
<li>ConnectionWatchDogï¼šé‡è¿å™¨</li>
</ol>
<h5 data-id="heading-9">3.2.1 CommandHandler#channelInactive</h5>
<ol>
<li>è®¾ç½®å½“å‰çš„CommandHandlerçŠ¶æ€ä¸ºDEACTIVATING</li>
<li>è§¦å‘DefaultEndPointçš„channelInactiveã€drainQueuedCommands <strong>é‡ç‚¹</strong></li>
<li>é‡ç½®RedisStateMachineçŠ¶æ€æœºï¼›</li>
</ol>

<pre><code class="hljs language-scss" lang="scss">public void <span class="hljs-built_in">channelInactive</span>(ChannelHandlerContext ctx) throws Exception {

    if (debugEnabled) {
        logger<span class="hljs-selector-class">.debug</span>("{} channelInactive()", <span class="hljs-built_in">logPrefix</span>());
    }

    if (channel != null &amp;&amp; ctx.channel() != channel) {
        logger<span class="hljs-selector-class">.debug</span>("{} My channel and ctx.channel mismatch. Propagating event to other listeners.", logPrefix());
        super<span class="hljs-selector-class">.channelInactive</span>(ctx);
        return;
    }

    tracedEndpoint = null;
    <span class="hljs-built_in">setState</span>(LifecycleState.DISCONNECTED);
    <span class="hljs-built_in">setState</span>(LifecycleState.DEACTIVATING);

    endpoint<span class="hljs-selector-class">.notifyChannelInactive</span>(ctx.channel());
    endpoint<span class="hljs-selector-class">.notifyDrainQueuedCommands</span>(this);

    <span class="hljs-built_in">setState</span>(LifecycleState.DEACTIVATED);

    PristineFallbackCommand command = this<span class="hljs-selector-class">.fallbackCommand</span>;
    if (isProtectedMode(command)) {
        <span class="hljs-built_in">onProtectedMode</span>(command.getOutput()<span class="hljs-selector-class">.getError</span>());
    }

    rsm<span class="hljs-selector-class">.reset</span>();

    if (debugEnabled) {
        logger<span class="hljs-selector-class">.debug</span>("{} channelInactive() done", <span class="hljs-built_in">logPrefix</span>());
    }

    super<span class="hljs-selector-class">.channelInactive</span>(ctx);
}
</code></pre>
<h6 data-id="heading-10">3.2.1.1DefaultEndPoint#channelInactive</h6>
<ol>
<li>åˆ¤æ–­æ˜¯å¦å·²ç»close</li>
<li>æ’å®ƒé”ä¸‹å‘deactivatedäº‹ä»¶ï¼Œå°†StatefulRedisConnectionImplçš„çŠ¶æ€è®¾ç½®ä¸ºdeactivatedï¼Œé¿å…è¿æ¥å†ç”¨</li>
<li>å°†channelè®¾ç½®ä¸ºnull <strong>é‡ç‚¹</strong></li>
</ol>

<pre><code class="hljs language-ini" lang="ini">public void notifyChannelInactive(Channel channel) {

    if (isClosed()) {
        RedisException <span class="hljs-attr">closed</span> = new RedisException(<span class="hljs-string">"Connection closed"</span>)<span class="hljs-comment">;</span>
        cancelCommands("Connection closed", drainCommands(), it -&gt; it.completeExceptionally(closed))<span class="hljs-comment">;</span>
    }

    sharedLock.doExclusive(() -&gt; {

        if (debugEnabled) {
            logger.debug("{} deactivating endpoint handler", logPrefix())<span class="hljs-comment">;</span>
        }

        connectionFacade.deactivated()<span class="hljs-comment">;</span>
    })<span class="hljs-comment">;</span>

    if (<span class="hljs-attr">this.channel</span> == channel) {
        <span class="hljs-attr">this.channel</span> = null<span class="hljs-comment">;</span>
    }
}
</code></pre>
<h5 data-id="heading-11">3.2.2 ConnectionEventTrigger#channelInactive</h5>
<ol>
<li>åœ¨connectionEventsä¸­å¹¿æ’­redisOnDisconnectedäº‹ä»¶ï¼Œå› ä¸ºConnectionEventsé‡Œé¢ä¼šæ³¨å†ŒRedisConnectionStateListenerï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šæ˜¯ç»™RedisConnectionStateListenerè¿›è¡Œä¸‹å‘redisonDisconnectedäº‹ä»¶</li>
<li>åŒæ—¶åœ¨eventBusä¸­ä¹Ÿå¹¿æ’­ConnectionDeactivatedEventäº‹ä»¶</li>
</ol>

<pre><code class="hljs language-scss" lang="scss">public void <span class="hljs-built_in">channelInactive</span>(ChannelHandlerContext ctx) throws Exception {
    connectionEvents<span class="hljs-selector-class">.fireEventRedisDisconnected</span>(connection);
    eventBus<span class="hljs-selector-class">.publish</span>(new ConnectionDeactivatedEvent(local(ctx), <span class="hljs-built_in">remote</span>(ctx)));
    super<span class="hljs-selector-class">.channelInactive</span>(ctx);
}
</code></pre>
<h2 data-id="heading-12">é—®é¢˜æº¯æº</h2>
<p>æºç æµç¨‹åˆ†æå®Œæˆï¼Œ è¿™ä¸ªé—®é¢˜å…¶å®å°±é€æ¸æµ®å‡ºæ°´é¢äº†ï¼›
å…ˆä»é—®é¢˜ç‚¹å‡ºå‘</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-type">void</span> <span class="hljs-title">validateWrite</span><span class="hljs-params">(<span class="hljs-type">int</span> commands)</span> </span>{

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isClosed</span>()) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RedisException</span>(<span class="hljs-string">"Connection is closed"</span>);
    }
    ......

    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isConnected</span>() &amp;&amp; rejectCommandsWhileDisconnected) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RedisException</span>(<span class="hljs-string">"Currently not connected. Commands are rejected."</span>);
    }
}
</code></pre>
<ol>
<li>isClosed()æ–¹æ³•ï¼šåªæœ‰è°ƒç”¨äº†closeAsyncæ–¹æ³•ï¼Œæ‰ä¼šå°†closeæ ‡è¯†ç½®ä¸ºtrueï¼›æ²¡æœ‰èµ°åˆ°è¿™é‡Œï¼Œè¯´æ˜å½“å‰DefaultEndPointå¯¹è±¡è¿˜æ²¡æœ‰è°ƒç”¨closeæ–¹æ³•ï¼›</li>
<li>isConnected()çš„åˆ¤æ–­é€»è¾‘ï¼šå¦‚æœchannel==null æˆ–è€…channel is inactiveï¼Œå°±è¯´æ˜disConnectedï¼Œå°±ä¼šæŠ›å‡º<code>Currently not connected , Commands are rejected</code></li>
<li>æ ¹æ®3.1å’Œ3.2.1.1çš„æºç å¯ä»¥äº†è§£åˆ°ï¼Œchannelç½®ä¸ºnullæ˜¯åœ¨CommandHandleræ•è·åˆ°channelInactiveäº‹ä»¶ä»¥åè¿›è¡Œæ“ä½œçš„ï¼›channel is inactive æ˜¯socket.close() ä»¥åè§¦å‘çš„ï¼›</li>
</ol>
<p>äº†è§£åˆ°é—®é¢˜äº§ç”Ÿçš„æºå¤´ï¼›é‚£å†å›å¤´æ¥çœ‹ä¸ºä»€ä¹ˆchannel=nullä»¥åï¼Œæ²¡æœ‰è°ƒç”¨ConnectionEventTrigger#channelInactiveè¿›è¡Œæ–­è¿å›è°ƒå‘¢ï¼Ÿ å›å»çœ‹äº†ä¸€ä¸‹ï¼Œæˆ‘ä»¬è‡ªå·±å†™çš„ä»£ç ï¼Œæˆ‘ä»¬æ³¨å†Œäº†RedisConnectionStateListener, ä½†æ˜¯åœ¨onRedisDisconnectedäº‹ä»¶çš„å®ç°ä¸­æœ‰ç¼ºé™·ï¼Œå¯¼è‡´è¿™ä¸ªBugï¼›</p>
<h2 data-id="heading-13">æ€»ç»“</h2>
<ol>
<li>æºç æ˜¯è¿›æ­¥çš„æºæ³‰ï¼Œä¼˜é›…æ°¸ä¸è¿‡æ—¶</li>
<li>Nettyå°†ç½‘ç»œå¤„ç†çš„ç”Ÿå‘½å‘¨æœŸçš„æ¯ä¸ªé˜¶æ®µå®Œæˆåï¼Œéƒ½ä¼šä¼ æ’­ç‰¹å®šçš„äº‹ä»¶ï¼Œå½¢æˆå®Œæ•´çš„è¿½è¸ªé“¾ï¼›è¿™æ ·ä¹Ÿæ–¹ä¾¿é—®é¢˜å®šä½ï¼Œå€¼å¾—å€Ÿé‰´ï¼›</li>
<li>åœ¨äº‹ä»¶å¾ªç¯+å¼‚æ­¥å¤„ç†ä¸­ï¼Œä¸è¦æœ‰é˜»å¡æ€§äº‹ä»¶ï¼Œä¸ç„¶ä¼šå¯¼è‡´é›ªå´©æ•ˆåº”</li>
<li>äº‹ä»¶å›è°ƒåœ¨å¼‚æ­¥å¤„ç†ä¸­éšå¤„å¯è§ï¼Œé€šè¿‡å›è°ƒé’©å­æ¥æ„ŸçŸ¥äº‹ä»¶çš„å˜åŒ–ï¼ˆè¯¸å¦‚ï¼šChannelHandlerã€redisä¸­çš„RedisConnectionStateListenerï¼‰</li>
<li>åº•å±‚çŸ¥è¯†å¿…é¡»å¤¯å®ï¼ŒçŸ¥å…¶ç„¶ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶ ï¼ˆTCPå››æ¬¡æ¡æ‰‹ã€JVMæºç ã€ solingerã€ halfClosureï¼‰</li>
</ol>
<h2 data-id="heading-14">å‚çœ‹ç½‘å€</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzg2MzU3Mjc3Ng%3D%3D%26mid%3D2247485060%26idx%3D1%26sn%3D736360af6eb3a4db496de2d6665ebd3c%26chksm%3Dce77c0c3f90049d5e44692c2cf837e8d85bb28758b243d505c43c48ce703da1edadfc19360b1%26cur_album_id%3D2217816582418956300%26scene%3D190%23rd" target="_blank" title="https://mp.weixin.qq.com/s?__biz=Mzg2MzU3Mjc3Ng==&amp;mid=2247485060&amp;idx=1&amp;sn=736360af6eb3a4db496de2d6665ebd3c&amp;chksm=ce77c0c3f90049d5e44692c2cf837e8d85bb28758b243d505c43c48ce703da1edadfc19360b1&amp;cur_album_id=2217816582418956300&amp;scene=190#rd" ref="nofollow noopener noreferrer"># æˆ‘ä¸º Netty è´¡çŒ®æºç  | ä¸”çœ‹ Netty å¦‚ä½•åº”å¯¹ TCP è¿æ¥çš„æ­£å¸¸å…³é—­ï¼Œå¼‚å¸¸å…³é—­ï¼ŒåŠå…³é—­åœºæ™¯</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cocos Creator 3.8 å®ç°æŒ‡å®šNodeèŠ‚ç‚¹æˆªå›¾åŠŸèƒ½æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7573588675637100559</link>    <guid>https://juejin.cn/post/7573588675637100559</guid>    <pubDate>2025-11-18T02:03:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573588675637100559" data-draft-id="7573594825317105704" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cocos Creator 3.8 å®ç°æŒ‡å®šNodeèŠ‚ç‚¹æˆªå›¾åŠŸèƒ½æ•™ç¨‹"/> <meta itemprop="keywords" content="Cocos Creator,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-18T02:03:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŠ±æ‰¬ç¨‹åº"/> <meta itemprop="url" content="https://juejin.cn/user/905653313620472"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cocos Creator 3.8 å®ç°æŒ‡å®šNodeèŠ‚ç‚¹æˆªå›¾åŠŸèƒ½æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653313620472/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŠ±æ‰¬ç¨‹åº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:03:22.000Z" title="Tue Nov 18 2025 02:03:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Cocos Creator 3.8 å®ç°æŒ‡å®šNodeèŠ‚ç‚¹æˆªå›¾åŠŸèƒ½æ•™ç¨‹</h2>
<h3 data-id="heading-1">ä¸€ã€å‰è¨€</h3>
<p>åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œæˆªå›¾åŠŸèƒ½æ˜¯ä¸€é¡¹å¸¸è§ä¸”å®ç”¨çš„éœ€æ±‚ï¼Œå®ƒå¯ä»¥ç”¨äºç”Ÿæˆåˆ†äº«å›¾ç‰‡ã€ä¿å­˜æ¸¸æˆæˆå°±æˆ–åˆ›å»ºé¢„è§ˆå›¾ç­‰ã€‚æœ¬æ•™ç¨‹å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Cocos Creator 3.8 ä¸­å®ç°æŒ‡å®š Node èŠ‚ç‚¹çš„æˆªå›¾åŠŸèƒ½ï¼Œå¹¶å°†ç»“æœæ¸²æŸ“åˆ° Sprite ä¸Šã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€åŠŸèƒ½å®ç°åŸç†</h3>
<p>æˆªå›¾åŠŸèƒ½çš„æ ¸å¿ƒåŸç†æ˜¯åˆ©ç”¨ Cocos Creator çš„ Camera ç»„ä»¶å’Œ RenderTextureï¼ˆæ¸²æŸ“çº¹ç†ï¼‰ã€‚Camera ä¼šå°†æŒ‡å®šèŠ‚ç‚¹çš„å†…å®¹æ¸²æŸ“åˆ° RenderTexture ä¸Šï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ä» RenderTexture ä¸­è¯»å–åƒç´ æ•°æ®ï¼Œæœ€ç»ˆå°†å…¶è½¬æ¢ä¸ºå›¾ç‰‡æˆ–æ˜¾ç¤ºåœ¨ UI ä¸Š</p>
<h4 data-id="heading-3">å…³é”®ç»„ä»¶ï¼š</h4>
<ul>
<li><strong>Camera</strong>ï¼šè´Ÿè´£æ•è·èŠ‚ç‚¹è§†è§‰å†…å®¹</li>
<li><strong>RenderTexture</strong>ï¼šä½œä¸ºæ¸²æŸ“ç›®æ ‡ï¼Œå­˜å‚¨å›¾åƒæ•°æ®</li>
<li><strong>SpriteFrame</strong>ï¼šå°†æ¸²æŸ“çº¹ç†è½¬æ¢ä¸ºå¯æ˜¾ç¤ºçš„ç²¾çµå¸§</li>
</ul>
<hr/>
<h3 data-id="heading-4">ä¸‰ã€åœºæ™¯é…ç½®æ­¥éª¤</h3>
<h4 data-id="heading-5">1. é…ç½®ç›®æ ‡èŠ‚ç‚¹</h4>
<ul>
<li>å°†éœ€è¦æˆªå›¾çš„èŠ‚ç‚¹è¿æ¥åˆ°è„šæœ¬çš„targetNodeå±æ€§</li>
<li>è‡ªå®šä¹‰ä¸€ä¸ª<code>capture</code>layer, å¹¶å°†ç›®æ ‡èŠ‚ç‚¹çš„layerè®¾ç½®ä¸º<code>capture</code>ï¼ŒåŒæ—¶ä¸»ç›¸æœºçš„<code>Visibility</code>ä¹Ÿéœ€è¦æ·»åŠ è¯¥layer</li>
<li>ç¡®ä¿èŠ‚ç‚¹åœ¨ç›¸æœºèŒƒå›´å†…å¯è§</li>
<li/>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36389a7ee3454172bd2652b438b036be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqx5oms56iL5bqP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764036201&amp;x-signature=TFF3HdCw1cmwLCrdkIGt0e5QonM%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-6">2. è®¾ç½®é¢„è§ˆèŠ‚ç‚¹ï¼š</h4>
<ul>
<li>åˆ›å»ºä¸€ä¸ªUIèŠ‚ç‚¹å¹¶æ·»åŠ Spriteç»„ä»¶</li>
<li>å°†è¿™ä¸ªèŠ‚ç‚¹è¿æ¥åˆ°è„šæœ¬çš„previewNodeå±æ€§</li>
</ul>
<h4 data-id="heading-7">3. åˆ›å»ºæˆªå›¾ä¸“ç”¨ç›¸æœºï¼š</h4>
<ul>
<li>åœ¨ç›®æ ‡èŠ‚ç‚¹ä¸­æ·»åŠ ä¸€ä¸ªæ–°CameraèŠ‚ç‚¹ï¼Œåˆ›å»ºåˆ°ç›®æ ‡èŠ‚ç‚¹å¯ä»¥ä¿è¯èŠ‚ç‚¹ç§»åŠ¨çš„æ—¶å€™ç›¸æœºä¼šè·Ÿéšç§»åŠ¨</li>
<li>è°ƒæ•´ç›¸æœºä½ç½®å’Œå‚æ•°ï¼Œä½¿å…¶èƒ½å®Œæ•´çœ‹åˆ°ç›®æ ‡èŠ‚ç‚¹</li>
<li>å°†ç›¸æœºç»„ä»¶çš„Target Textureå±æ€§ç•™ç©ºï¼ˆä»£ç ä¸­åŠ¨æ€è®¾ç½®ï¼‰</li>
<li>å¹¶å°†ç›¸æœºç»„ä»¶çš„<code>Visibility</code>è®¾ç½®ä¸º<code>capture</code>è¿™ä¸€ä¸ªï¼Œä¿è¯æœ€ç»ˆæˆªå›¾çš„åªæ˜¾ç¤ºæƒ³è¦çš„å†…å®¹</li>
</ul>
<h4 data-id="heading-8">èŠ‚ç‚¹æˆªå›¾é¢„è§ˆ</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6457137ba3b4732b416c685021755da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqx5oms56iL5bqP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764036201&amp;x-signature=gxLCXjfh%2BWKAsy2%2BT%2BZVIQ73SbQ%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-9">ç›¸æœºå‚æ•°æˆªå›¾é¢„è§ˆ</h4>
<h3 data-id="heading-10"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c32350cc1aa460ca68163254c7a07f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqx5oms56iL5bqP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764036201&amp;x-signature=jND2cfKFrkUJRIDSu0sBOmfAHws%3D" alt="" loading="lazy"/></h3>
<h3 data-id="heading-11">å››ã€æ ¸å¿ƒä»£ç </h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3198eed9790a42a1a54b3918d900c59e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqx5oms56iL5bqP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764036201&amp;x-signature=1pHz3dZqt0ZhiR3jpYzshooL%2Fj8%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-12">éœ€è¦æ³¨æ„çš„é—®é¢˜</h4>
<ol>
<li><strong>å›¾åƒç¼©æ”¾é—®é¢˜</strong>
<ul>
<li>æœ€ç»ˆçš„å®½é«˜è®¡ç®—éœ€è¦æ³¨æ„ç¼©æ”¾çš„é—®é¢˜</li>
</ul>
</li>
<li><strong>æˆªå›¾ç©ºç™½æˆ–ä¸å…¨çš„é—®é¢˜</strong>
<ul>
<li>ç›¸æœºçš„orthoHeight è®¾ç½®ä¸ºé«˜åº¦çš„ä¸€åŠ(æˆªå›¾ä»£ç å†™çš„æ˜¯å®½åº¦ä¸€åŠåªæœ‰æ­£æ–¹å½¢çš„æ‰ä¸ä¼šæœ‰é—®é¢˜ï¼Œå·²æ›´æ­£)</li>
</ul>
</li>
</ol>
<h3 data-id="heading-13">äº”ã€æ³¨æ„äº‹é¡¹ä¸ä¼˜åŒ–å»ºè®®</h3>
<ol>
<li>
<p><strong>å›¾åƒç¿»è½¬é—®é¢˜</strong></p>
<ul>
<li>Cocos Creatoræ¸²æŸ“çš„å›¾åƒæ•°æ®æ˜¯å€’ç½®çš„ï¼Œéœ€è¦é€šè¿‡ä»£ç æ‰‹åŠ¨ç¿»è½¬</li>
</ul>
</li>
<li>
<p><strong>æ¸²æŸ“æ—¶æœº</strong></p>
<ul>
<li>ä½¿ç”¨scheduleOnceå»¶è¿Ÿè¯»å–åƒç´ æ•°æ®ï¼Œç¡®ä¿æ¸²æŸ“å®Œæˆåå†è¿›è¡Œè¯»å–æ“ä½œ</li>
</ul>
</li>
</ol>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PerformanceObserver æ€§èƒ½æ¡ç›®ç±»å‹ï¼ˆEntry Typesï¼‰]]></title>    <link>https://juejin.cn/post/7573588675637313551</link>    <guid>https://juejin.cn/post/7573588675637313551</guid>    <pubDate>2025-11-18T02:27:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573588675637313551" data-draft-id="7573530680887377954" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PerformanceObserver æ€§èƒ½æ¡ç›®ç±»å‹ï¼ˆEntry Typesï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-11-18T02:27:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°‘å¿"/> <meta itemprop="url" content="https://juejin.cn/user/26044010879709"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PerformanceObserver æ€§èƒ½æ¡ç›®ç±»å‹ï¼ˆEntry Typesï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/26044010879709/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°‘å¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:27:21.000Z" title="Tue Nov 18 2025 02:27:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>PerformanceObserver</code> æ˜¯ Web æ€§èƒ½ç›‘æµ‹çš„æ ¸å¿ƒ APIï¼Œé€šè¿‡æŒ‡å®š <code>entryTypes</code> å¯ä»¥è§‚å¯Ÿä¸åŒç±»å‹çš„æ€§èƒ½æŒ‡æ ‡ã€‚ä»¥ä¸‹æ˜¯æ‰€æœ‰æ”¯æŒçš„æ¡ç›®ç±»å‹åŠå…¶è¯¦ç»†è¯´æ˜ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒ Entry Types åˆ—è¡¨</h2>
<h3 data-id="heading-1">1.Â  <strong><code>'navigation'</code></strong> Â â€” é¡µé¢å¯¼èˆªæ€§èƒ½</h3>
<p><strong>è¯´æ˜</strong>ï¼šæµ‹é‡ä¸»æ–‡æ¡£çš„å¯¼èˆªå’ŒåŠ è½½æ—¶é—´ï¼Œæä¾›å®Œæ•´çš„é¡µé¢åŠ è½½ç”Ÿå‘½å‘¨æœŸæ•°æ®ã€‚</p>
<p><strong>å¸¸ç”¨æŒ‡æ ‡</strong>ï¼š</p>
<ul>
<li><code>entry.duration</code>ï¼šæ€»åŠ è½½æ—¶é—´</li>
<li><code>entry.domContentLoadedEventEnd - entry.domContentLoadedEventStart</code>ï¼šDOM è§£ææ—¶é—´</li>
<li><code>entry.loadEventEnd - entry.loadEventStart</code>ï¼šèµ„æºåŠ è½½æ—¶é—´</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šåˆ†æé¡µé¢æ•´ä½“åŠ è½½æ€§èƒ½ï¼Œè®¡ç®— DNSã€TCPã€TTFB ç­‰å…³é”®æŒ‡æ ‡</p>
<h3 data-id="heading-2">2.Â  <strong><code>'resource'</code></strong> Â â€” èµ„æºåŠ è½½æ€§èƒ½</h3>
<p><strong>è¯´æ˜</strong>ï¼šæµ‹é‡é¡µé¢ä¸Šæ‰€æœ‰èµ„æºçš„åŠ è½½æ—¶é—´ï¼ŒåŒ…æ‹¬å›¾ç‰‡ã€CSSã€JavaScriptã€XHR/Fetch è¯·æ±‚ç­‰ã€‚</p>
<p><strong>å…³é”®å±æ€§</strong>ï¼š</p>
<ul>
<li><code>entry.name</code>ï¼šèµ„æº URL</li>
<li><code>entry.initiatorType</code>ï¼šèµ„æºç±»å‹ï¼ˆ<code>img</code>, <code>script</code>, <code>link</code>, <code>xmlhttprequest</code>, <code>fetch</code>ï¼‰</li>
<li><code>entry.duration</code>ï¼šåŠ è½½è€—æ—¶</li>
<li><code>entry.decodedBodySize</code>ï¼šèµ„æºå¤§å°</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šå®šä½æ…¢èµ„æºã€ç›‘æ§ CDN æ•ˆæœã€ä¼˜åŒ–èµ„æºåŠ è½½ç­–ç•¥</p>
<h3 data-id="heading-3">3.Â  <strong><code>'paint'</code></strong> Â â€” æ¸²æŸ“æ€§èƒ½</h3>
<p><strong>è¯´æ˜</strong>ï¼šæµ‹é‡å…³é”®æ¸²æŸ“æ—¶é—´ç‚¹ï¼Œä¸»è¦ç”¨äº <strong>FCP</strong>ï¼ˆé¦–æ¬¡å†…å®¹ç»˜åˆ¶ï¼‰ã€‚</p>
<p><strong>äº‹ä»¶åç§°</strong>ï¼š</p>
<ul>
<li><code>entry.name === 'first-contentful-paint'</code>ï¼šFCP æ—¶é—´</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šCore Web Vitals æ ¸å¿ƒæŒ‡æ ‡ç›‘æ§</p>
<h3 data-id="heading-4">4.Â  <strong><code>'largest-contentful-paint'</code></strong> Â â€” æœ€å¤§å†…å®¹ç»˜åˆ¶</h3>
<p><strong>è¯´æ˜</strong>ï¼šä½œä¸ºç‹¬ç«‹æ¡ç›®ç±»å‹æä¾›æ›´ç²¾ç¡®çš„ <strong>LCP</strong> æ•°æ®ï¼ŒåŒ…å«è¯¦ç»†çš„å…ƒç´ ä¿¡æ¯ã€‚</p>
<p><strong>å…³é”®å±æ€§</strong>ï¼š</p>
<ul>
<li><code>entry.startTime</code>ï¼šLCP å‘ç”Ÿæ—¶é—´</li>
<li><code>entry.element</code>ï¼šè§¦å‘ LCP çš„ DOM å…ƒç´ </li>
<li><code>entry.url</code>ï¼šå›¾ç‰‡èµ„æºçš„ URLï¼ˆå¦‚é€‚ç”¨ï¼‰</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šç²¾å‡†å®šä½å½±å“ LCP çš„å…ƒç´ ï¼Œä¼˜åŒ–æœ€å¤§å†…å®¹åŠ è½½</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>((<span class="hljs-keyword">list</span>) =&gt; {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">entry</span> of <span class="hljs-keyword">list</span>.<span class="hljs-title function_ invoke__">getEntries</span>()) {
    console.<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">' LCP è¯¦æƒ…:'</span>, {
      <span class="hljs-attr">time</span>: entry.startTime.<span class="hljs-title function_ invoke__">toFixed</span>(<span class="hljs-number">2</span>) + <span class="hljs-string">'ms'</span>,
      <span class="hljs-attr">element</span>: entry.element?.tagName,
      <span class="hljs-attr">url</span>: entry.url
    });
  }
});
observer.<span class="hljs-title function_ invoke__">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">'largest-contentful-paint'</span>], <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span> });
</code></pre>
<h3 data-id="heading-5">5.Â  <strong><code>'first-input'</code></strong> Â â€” é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ</h3>
<p><strong>è¯´æ˜</strong>ï¼šæµ‹é‡ç”¨æˆ·é¦–æ¬¡äº¤äº’ï¼ˆç‚¹å‡»ã€è§¦æ‘¸ã€æŒ‰é”®ï¼‰åˆ°æµè§ˆå™¨å“åº”çš„å»¶è¿Ÿæ—¶é—´ï¼Œæ˜¯ <strong>Core Web Vitals</strong> æ ¸å¿ƒæŒ‡æ ‡ã€‚</p>
<p><strong>å…³é”®å±æ€§</strong>ï¼š</p>
<ul>
<li><code>entry.name</code>ï¼šäº¤äº’ç±»å‹ï¼ˆ<code>click</code>, <code>pointerdown</code>, <code>keydown</code>ï¼‰</li>
<li><code>entry.duration</code>ï¼šæ€»å»¶è¿Ÿæ—¶é—´</li>
<li><code>entry.processingStart</code> / <code>entry.processingEnd</code>ï¼šäº‹ä»¶å¤„ç†æ—¶é—´</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šè¯„ä¼°ç”¨æˆ·å¯¹åº”ç”¨å“åº”æ€§çš„ç¬¬ä¸€å°è±¡</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>((<span class="hljs-keyword">list</span>) =&gt; {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">entry</span> of <span class="hljs-keyword">list</span>.<span class="hljs-title function_ invoke__">getEntries</span>()) {
    console.<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">'é¦–æ¬¡äº¤äº’å»¶è¿Ÿ:'</span>, {
      <span class="hljs-attr">type</span>: entry.name,
      <span class="hljs-attr">delay</span>: entry.duration + <span class="hljs-string">'ms'</span>
    });
  }
});
observer.<span class="hljs-title function_ invoke__">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">'first-input'</span>], <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span> });
</code></pre>
<h3 data-id="heading-6">6.Â  <strong><code>'layout-shift'</code></strong> Â â€” å¸ƒå±€åç§»ï¼ˆCLSï¼‰</h3>
<p><strong>è¯´æ˜</strong>ï¼šæµ‹é‡é¡µé¢å…ƒç´ çš„æ„å¤–ç§»åŠ¨ï¼Œç”¨äºè®¡ç®— <strong>Cumulative Layout Shift (CLS)</strong> ã€‚</p>
<p><strong>å…³é”®å±æ€§</strong>ï¼š</p>
<ul>
<li><code>entry.value</code>ï¼šå•æ¬¡å¸ƒå±€åç§»å¾—åˆ†</li>
<li><code>entry.hadRecentInput</code>ï¼šæ˜¯å¦ç”±ç”¨æˆ·è¾“å…¥è§¦å‘ï¼ˆé€šå¸¸åªå…³æ³¨ <code>false</code> çš„æƒ…å†µï¼‰</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šæå‡è§†è§‰ç¨³å®šæ€§ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ</p>
<h3 data-id="heading-7">7.Â  <strong><code>'event'</code></strong> Â â€” ç”¨æˆ·äº‹ä»¶å»¶è¿Ÿ</h3>
<p><strong>è¯´æ˜</strong>ï¼šæµ‹é‡æ‰€æœ‰ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼ˆç‚¹å‡»ã€é”®ç›˜è¾“å…¥ï¼‰çš„å»¶è¿Ÿæ—¶é—´ã€‚</p>
<p><strong>å…³é”®å±æ€§</strong>ï¼š</p>
<ul>
<li><code>entry.name</code>ï¼šäº‹ä»¶ç±»å‹ï¼ˆ<code>click</code>, <code>keydown</code> ç­‰ï¼‰</li>
<li><code>entry.duration</code>ï¼šäº‹ä»¶å¤„ç†è€—æ—¶</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šç›‘æ§äº¤äº’å“åº”æ€§ï¼Œå‘ç°äº‹ä»¶å¤„ç†ç“¶é¢ˆ</p>
<h3 data-id="heading-8">8.Â  <strong><code>'longtask'</code></strong> Â â€” é•¿ä»»åŠ¡ç›‘æ§</h3>
<p><strong>è¯´æ˜</strong>ï¼šè¯†åˆ«ä¸»çº¿ç¨‹ä¸Šè€—æ—¶è¶…è¿‡ <strong>50 æ¯«ç§’</strong>çš„ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡ä¼šé˜»å¡ç”¨æˆ·äº¤äº’ã€‚</p>
<p><strong>å…³é”®å±æ€§</strong>ï¼š</p>
<ul>
<li><code>entry.duration</code>ï¼šä»»åŠ¡è€—æ—¶</li>
<li><code>entry.attribution</code>ï¼šå¯¼è‡´é•¿ä»»åŠ¡çš„ä»£ç ä¿¡æ¯</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šå‘ç° JavaScript æ€§èƒ½ç“¶é¢ˆï¼Œä¼˜åŒ–ä¸»çº¿ç¨‹æ‰§è¡Œ</p>
<h3 data-id="heading-9">9.Â  <strong><code>'long-animation-frame'</code></strong> Â â€” é•¿åŠ¨ç”»å¸§ï¼ˆLoAFï¼‰</h3>
<p><strong>è¯´æ˜</strong>ï¼š<strong>æ–°ä¸€ä»£é•¿ä»»åŠ¡ç›‘æ§</strong>ï¼Œæ¯” <code>'longtask'</code> æ›´ç»†ç²’åº¦ï¼Œæä¾›å®Œæ•´çš„è°ƒç”¨æ ˆå’Œè„šæœ¬å½’å› ã€‚</p>
<p><strong>å…³é”®å±æ€§</strong>ï¼š</p>
<ul>
<li><code>entry.duration</code>ï¼šå¸§è€—æ—¶</li>
<li><code>entry.scripts</code>ï¼šè¯¦ç»†çš„è„šæœ¬æ‰§è¡Œä¿¡æ¯æ•°ç»„</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šç²¾ç¡®è¯Šæ–­é˜»å¡åŠ¨ç”»å’Œäº¤äº’çš„è„šæœ¬</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>((<span class="hljs-keyword">list</span>) =&gt; {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">entry</span> of <span class="hljs-keyword">list</span>.<span class="hljs-title function_ invoke__">getEntries</span>()) {
    console.<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">'é•¿åŠ¨ç”»å¸§:'</span>, {
      <span class="hljs-attr">duration</span>: entry.duration + <span class="hljs-string">'ms'</span>,
      <span class="hljs-attr">scripts</span>: entry.scripts.<span class="hljs-title function_ invoke__">map</span>(s =&gt; ({
        <span class="hljs-attr">source</span>: s.sourceURL,
        <span class="hljs-attr">function</span>: s.sourceFunctionName,
        <span class="hljs-attr">duration</span>: s.duration + <span class="hljs-string">'ms'</span>
      }))
    });
  }
});
observer.<span class="hljs-title function_ invoke__">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">'long-animation-frame'</span>], <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span> });
</code></pre>
<h3 data-id="heading-10">10.Â  <strong><code>'element'</code></strong> Â â€” å…ƒç´ çº§æ€§èƒ½</h3>
<p><strong>è¯´æ˜</strong>ï¼šè§‚å¯Ÿç‰¹å®š DOM å…ƒç´ çš„æ¸²æŸ“æ—¶é—´ï¼Œç”¨äºæ›´ç²¾ç¡®çš„ LCP æµ‹é‡ã€‚</p>
<p><strong>ä½¿ç”¨è¦æ±‚</strong>ï¼šå…ƒç´ éœ€æ·»åŠ  <code>elementtiming</code> å±æ€§</p>
<pre><code class="hljs language-ini" lang="ini">&lt;img <span class="hljs-attr">src</span>=<span class="hljs-string">"hero.jpg"</span> elementtiming=<span class="hljs-string">"hero-image"</span> /&gt;
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šç›‘æ§å…³é”®ä¸šåŠ¡å…ƒç´ çš„æ¸²æŸ“æ€§èƒ½</p>
<h3 data-id="heading-11">11.Â  <strong><code>'mark'</code></strong> Â â€” è‡ªå®šä¹‰æ—¶é—´æˆ³æ ‡è®°</h3>
<p><strong>è¯´æ˜</strong>ï¼šé€šè¿‡ <code>performance.mark()</code> åˆ›å»ºå‘½åæ—¶é—´æˆ³ï¼Œæ ‡è®°ä¸šåŠ¡å…³é”®èŠ‚ç‚¹ã€‚</p>
<p><strong>ä½¿ç”¨æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">performance.<span class="hljs-built_in">mark</span>(<span class="hljs-string">'user_login_start'</span>);
<span class="hljs-comment">// ... æ‰§è¡Œä»£ç </span>
performance.<span class="hljs-built_in">mark</span>(<span class="hljs-string">'user_login_end'</span>);
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šè‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘æ€§èƒ½ç›‘æ§ï¼Œå¦‚ç»„ä»¶åˆå§‹åŒ–æ—¶é—´ã€API è°ƒç”¨è€—æ—¶ç­‰</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> list.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'mark'</span>)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ ‡è®°ç‚¹:'</span>, entry.<span class="hljs-property">name</span>, entry.<span class="hljs-property">startTime</span> + <span class="hljs-string">'ms'</span>);
  }
});
observer.<span class="hljs-title function_">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">'mark'</span>], <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span> });
</code></pre>
<h3 data-id="heading-12">12.Â  <strong><code>'measure'</code></strong> Â â€” è‡ªå®šä¹‰æ—¶é—´åŒºé—´æµ‹é‡</h3>
<p><strong>è¯´æ˜</strong>ï¼šé€šè¿‡ <code>performance.measure()</code> è®¡ç®—ä¸¤ä¸ª mark ä¹‹é—´çš„æ—¶é—´å·®ï¼Œæ˜¯ä¸šåŠ¡æ€§èƒ½ç›‘æ§çš„é»„é‡‘æ ‡å‡†ã€‚</p>
<p><strong>ä½¿ç”¨æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">performance.<span class="hljs-built_in">measure</span>(<span class="hljs-string">'login_duration'</span>, <span class="hljs-string">'user_login_start'</span>, <span class="hljs-string">'user_login_end'</span>);
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šç²¾ç¡®æµ‹é‡ä¸šåŠ¡æ“ä½œè€—æ—¶ï¼Œç”Ÿæˆè‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> list.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'measure'</span>)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹é‡åŒºé—´:'</span>, entry.<span class="hljs-property">name</span>, entry.<span class="hljs-property">duration</span> + <span class="hljs-string">'ms'</span>);
  }
});
observer.<span class="hljs-title function_">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">'measure'</span>], <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span> });
</code></pre>
<h3 data-id="heading-13">13.Â  <strong><code>'visibility-state'</code></strong> Â â€” é¡µé¢å¯è§æ€§å˜åŒ–</h3>
<p><strong>è¯´æ˜</strong>ï¼šç›‘æ§é¡µé¢ä»å¯è§åˆ°éšè—ã€ä»éšè—åˆ°å¯è§çš„çŠ¶æ€è½¬æ¢ï¼Œå¯¹<strong>ç§»åŠ¨ç«¯æ€§èƒ½ä¼˜åŒ–</strong>è‡³å…³é‡è¦ã€‚</p>
<p><strong>å…³é”®å±æ€§</strong>ï¼š</p>
<ul>
<li><code>entry.prevState</code>ï¼šä¹‹å‰çš„çŠ¶æ€ï¼ˆ<code>visible</code>, <code>hidden</code>, <code>prerender</code>ï¼‰</li>
<li><code>entry.currState</code>ï¼šå½“å‰çš„çŠ¶æ€</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šé¡µé¢éšè—æ—¶æš‚åœéå…³é”®ä»»åŠ¡ï¼ŒèŠ‚çœ CPU å’Œç”µé‡</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>((<span class="hljs-keyword">list</span>) =&gt; {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">entry</span> of <span class="hljs-keyword">list</span>.<span class="hljs-title function_ invoke__">getEntries</span>()) {
    console.<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">'å¯è§æ€§å˜åŒ–:'</span>, {
      <span class="hljs-attr">from</span>: entry.prevState,
      <span class="hljs-attr">to</span>: entry.currState
    });
    <span class="hljs-keyword">if</span> (entry.currState === <span class="hljs-string">'hidden'</span>) {
      <span class="hljs-title function_ invoke__">pauseBackgroundTasks</span>();
    }
  }
});
observer.<span class="hljs-title function_ invoke__">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">'visibility-state'</span>], <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span> });
</code></pre>
<hr/>
<h2 data-id="heading-14">äºŒã€æµè§ˆå™¨å…¼å®¹æ€§è¯´æ˜</h2>
<h3 data-id="heading-15">åŠ¨æ€æ£€æŸ¥æ”¯æŒç±»å‹</h3>
<p>é€šè¿‡ <code>PerformanceObserver.supportedEntryTypes</code> è·å–å½“å‰æµè§ˆå™¨æ”¯æŒçš„ç±»å‹ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">console.log(PerformanceObserver.supportedEntryTypes);
<span class="hljs-regexp">//</span> ç°ä»£æµè§ˆå™¨è¾“å‡º (<span class="hljs-number">13</span>):
<span class="hljs-regexp">//</span> [<span class="hljs-string">'element'</span>, <span class="hljs-string">'event'</span>, <span class="hljs-string">'first-input'</span>, <span class="hljs-string">'largest-contentful-paint'</span>, 
<span class="hljs-regexp">//</span>  <span class="hljs-string">'layout-shift'</span>, <span class="hljs-string">'long-animation-frame'</span>, <span class="hljs-string">'longtask'</span>, <span class="hljs-string">'mark'</span>, 
<span class="hljs-regexp">//</span>  <span class="hljs-string">'measure'</span>, <span class="hljs-string">'navigation'</span>, <span class="hljs-string">'paint'</span>, <span class="hljs-string">'resource'</span>, <span class="hljs-string">'visibility-state'</span>]
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šè¯¥å±æ€§æ˜¯é™æ€åªè¯»å±æ€§ï¼Œè¿”å›æ•°ç»„<a href="https://link.juejin.cn?target=https%3A%2F%2Freactnative.dev%2Fdocs%2Fnext%2Fglobal-PerformanceObserver" target="_blank" title="https://reactnative.dev/docs/next/global-PerformanceObserver" ref="nofollow noopener noreferrer">reactnative.dev/docs/next/gâ€¦</a></p>
<h3 data-id="heading-16">å…¼å®¹æ€§å·®å¼‚</h3>
<ul>
<li><strong>ç°ä»£æµè§ˆå™¨</strong> (Chrome 120+, Edge 120+)ï¼šæ”¯æŒå…¨éƒ¨ 13 ç§ç±»å‹</li>
<li><strong>Safari</strong>ï¼šæ”¯æŒåŸºç¡€ç±»å‹ï¼Œå¯¹æ–°ç±»å‹ï¼ˆå¦‚ <code>long-animation-frame</code>ï¼‰æ”¯æŒè¾ƒæ…¢</li>
<li><strong>Firefox</strong>ï¼šæ”¯æŒæ ¸å¿ƒç±»å‹ï¼Œéƒ¨åˆ†å®éªŒæ€§ç±»å‹ä¸æ”¯æŒ</li>
<li><strong>IE</strong>ï¼šå®Œå…¨ä¸æ”¯æŒ PerformanceObserver</li>
</ul>
<p><strong>æ¨èåšæ³•</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">supportedTypes</span> = PerformanceObserver.supportedEntryTypes || []<span class="hljs-comment">;</span>
const <span class="hljs-attr">desiredTypes</span> = [
  <span class="hljs-string">'navigation'</span>, <span class="hljs-string">'resource'</span>, <span class="hljs-string">'paint'</span>, <span class="hljs-string">'first-input'</span>, <span class="hljs-string">'layout-shift'</span>,
  <span class="hljs-string">'longtask'</span>, <span class="hljs-string">'event'</span>, <span class="hljs-string">'largest-contentful-paint'</span>, <span class="hljs-string">'long-animation-frame'</span>
]<span class="hljs-comment">;</span>
const <span class="hljs-attr">entryTypes</span> = desiredTypes.filter(type =&gt; supportedTypes.includes(type))<span class="hljs-comment">;</span>

if (entryTypes.length &gt; 0) {
  observer.observe({ entryTypes, buffered: true })<span class="hljs-comment">;</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-17">ä¸‰ã€å®Œæ•´ä½¿ç”¨ç¤ºä¾‹</h2>
<h3 data-id="heading-18">ç›‘æ§å¤šç§æ€§èƒ½æŒ‡æ ‡</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºè§‚å¯Ÿè€…å®ä¾‹</span>
<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(<span class="hljs-function">(<span class="hljs-params">entryList</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> entries = entryList.<span class="hljs-title function_">getEntries</span>();
  
  entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç±»å‹: <span class="hljs-subst">${entry.entryType}</span>, åç§°: <span class="hljs-subst">${entry.name}</span>, è€—æ—¶: <span class="hljs-subst">${entry.duration}</span>ms`</span>);
    
    <span class="hljs-comment">// æ ¹æ®ç±»å‹åˆ†åˆ«å¤„ç†</span>
    <span class="hljs-keyword">switch</span>(entry.<span class="hljs-property">entryType</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'navigation'</span>:
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¡µé¢åŠ è½½å®Œæˆ:'</span>, entry.<span class="hljs-property">duration</span> + <span class="hljs-string">'ms'</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'resource'</span>:
        <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">duration</span> &gt; <span class="hljs-number">200</span>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'æ…¢èµ„æº:'</span>, entry.<span class="hljs-property">name</span>);
        }
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'largest-contentful-paint'</span>:
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'LCP:'</span>, entry.<span class="hljs-property">startTime</span>.<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>) + <span class="hljs-string">'ms'</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'first-input'</span>:
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ğŸ–±ï¸ é¦–æ¬¡äº¤äº’å»¶è¿Ÿ:'</span>, entry.<span class="hljs-property">duration</span> + <span class="hljs-string">'ms'</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'layout-shift'</span>:
        <span class="hljs-keyword">if</span> (!entry.<span class="hljs-property">hadRecentInput</span>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'CLS ç´¯ç§¯:'</span>, entry.<span class="hljs-property">value</span>);
        }
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'long-animation-frame'</span>:
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'é•¿åŠ¨ç”»å¸§:'</span>, entry.<span class="hljs-property">duration</span> + <span class="hljs-string">'ms'</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'visibility-state'</span>:
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¯è§æ€§å˜åŒ–:'</span>, entry.<span class="hljs-property">currState</span>);
        <span class="hljs-keyword">break</span>;
    }
  });
});

<span class="hljs-comment">// å¼€å§‹è§‚å¯Ÿï¼ˆæ¨èè®¾ç½® buffered: true è·å–å†å²æ•°æ®ï¼‰</span>
observer.<span class="hljs-title function_">observe</span>({
  <span class="hljs-attr">entryTypes</span>: [
    <span class="hljs-string">'navigation'</span>,
    <span class="hljs-string">'resource'</span>,
    <span class="hljs-string">'largest-contentful-paint'</span>,
    <span class="hljs-string">'first-input'</span>,
    <span class="hljs-string">'layout-shift'</span>,
    <span class="hljs-string">'long-animation-frame'</span>,
    <span class="hljs-string">'visibility-state'</span>
  ],
  <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span>
});
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><strong><code>buffered: true</code></strong> ï¼šæ”¶é›† <code>observe()</code> è°ƒç”¨ä¹‹å‰å·²å‘ç”Ÿçš„æ€§èƒ½æ¡ç›®ï¼Œé˜²æ­¢é—æ¼</li>
<li><strong><code>disconnect()</code></strong> ï¼šä¸å†éœ€è¦æ—¶è°ƒç”¨ï¼Œé‡Šæ”¾èµ„æº</li>
</ul>
<hr/>
<h2 data-id="heading-19">äº”ã€æ€»ç»“çŸ©é˜µ</h2>





















































































































<table><thead><tr><th align="left">#</th><th align="left">Entry Type</th><th align="left">ä¸»è¦æŒ‡æ ‡</th><th align="left">å…¸å‹é˜ˆå€¼</th><th align="left">æ‰€å±æ ‡å‡†</th><th align="left">ç›‘æ§åœºæ™¯</th></tr></thead><tbody><tr><td align="left">1</td><td align="left"><code>navigation</code></td><td align="left">é¡µé¢åŠ è½½æ—¶é—´</td><td align="left">&lt; 3s</td><td align="left">Navigation Timing</td><td align="left">æ•´ä½“åŠ è½½æ€§èƒ½</td></tr><tr><td align="left">2</td><td align="left"><code>resource</code></td><td align="left">èµ„æºåŠ è½½è€—æ—¶</td><td align="left">&lt; 200ms</td><td align="left">Resource Timing</td><td align="left">æ…¢èµ„æºå®šä½</td></tr><tr><td align="left">3</td><td align="left"><code>paint</code></td><td align="left">FCP</td><td align="left">&lt; 1.8s</td><td align="left">Paint Timing</td><td align="left">é¦–æ¬¡æ¸²æŸ“</td></tr><tr><td align="left">4</td><td align="left"><code>largest-contentful-paint</code></td><td align="left">LCP</td><td align="left">&lt; 2.5s</td><td align="left">LCP API</td><td align="left">æœ€å¤§å†…å®¹æ¸²æŸ“</td></tr><tr><td align="left">5</td><td align="left"><code>first-input</code></td><td align="left">FID</td><td align="left">&lt; 100ms</td><td align="left">Event Timing</td><td align="left">é¦–æ¬¡äº¤äº’å“åº”</td></tr><tr><td align="left">6</td><td align="left"><code>layout-shift</code></td><td align="left">CLS</td><td align="left">&lt; 0.1</td><td align="left">Layout Instability</td><td align="left">è§†è§‰ç¨³å®šæ€§</td></tr><tr><td align="left">7</td><td align="left"><code>event</code></td><td align="left">äº¤äº’å»¶è¿Ÿ</td><td align="left">&lt; 100ms</td><td align="left">Event Timing</td><td align="left">æ‰€æœ‰äº‹ä»¶å»¶è¿Ÿ</td></tr><tr><td align="left">8</td><td align="left"><code>longtask</code></td><td align="left">ä¸»çº¿ç¨‹é˜»å¡</td><td align="left">&gt; 50ms</td><td align="left">Long Tasks API</td><td align="left">å¡é¡¿æ£€æµ‹</td></tr><tr><td align="left">9</td><td align="left"><code>long-animation-frame</code></td><td align="left">é•¿åŠ¨ç”»å¸§é˜»å¡</td><td align="left">&gt; 50ms</td><td align="left">LoAF API</td><td align="left">ç²¾ç»†åŒ–å¡é¡¿åˆ†æ</td></tr><tr><td align="left">10</td><td align="left"><code>element</code></td><td align="left">å…ƒç´ æ¸²æŸ“æ—¶é—´</td><td align="left">ä¸šåŠ¡è‡ªå®šä¹‰</td><td align="left">Element Timing</td><td align="left">å…³é”®å…ƒç´ ç›‘æ§</td></tr><tr><td align="left">11</td><td align="left"><code>mark</code></td><td align="left">è‡ªå®šä¹‰æ—¶é—´æˆ³</td><td align="left">-</td><td align="left">User Timing</td><td align="left">ä¸šåŠ¡åŸ‹ç‚¹</td></tr><tr><td align="left">12</td><td align="left"><code>measure</code></td><td align="left">è‡ªå®šä¹‰æ—¶é—´åŒºé—´</td><td align="left">ä¸šåŠ¡è‡ªå®šä¹‰</td><td align="left">User Timing</td><td align="left">åŒºé—´æµ‹é‡</td></tr><tr><td align="left">13</td><td align="left"><code>visibility-state</code></td><td align="left">é¡µé¢å¯è§æ€§å˜åŒ–</td><td align="left">-</td><td align="left">Page Visibility</td><td align="left">èŠ‚èƒ½ä¼˜åŒ–</td></tr></tbody></table>
<p>é€šè¿‡åˆç†ç»„åˆè¿™äº› entry typesï¼Œå¯ä»¥æ„å»ºå…¨é¢çš„å‰ç«¯æ€§èƒ½ç›‘æ§ä½“ç³»ï¼Œä¸ºä¼˜åŒ–æä¾›æ•°æ®æ”¯æ’‘</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin å‡½æ•°è¯¦è§£ï¼šå‘½åå‚æ•°ä¸é»˜è®¤å‚æ•°å€¼]]></title>    <link>https://juejin.cn/post/7573588675637198863</link>    <guid>https://juejin.cn/post/7573588675637198863</guid>    <pubDate>2025-11-18T02:13:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573588675637198863" data-draft-id="7573530680887541794" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin å‡½æ•°è¯¦è§£ï¼šå‘½åå‚æ•°ä¸é»˜è®¤å‚æ•°å€¼"/> <meta itemprop="keywords" content="Android,Kotlin,åç«¯"/> <meta itemprop="datePublished" content="2025-11-18T02:13:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Android_å°é›¨"/> <meta itemprop="url" content="https://juejin.cn/user/220360279590862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin å‡½æ•°è¯¦è§£ï¼šå‘½åå‚æ•°ä¸é»˜è®¤å‚æ•°å€¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/220360279590862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Android_å°é›¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:13:28.000Z" title="Tue Nov 18 2025 02:13:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šè°ƒç”¨ä¸€ä¸ªå‚æ•°è¾ƒå¤šçš„å‡½æ•°æ—¶ï¼Œæ€»æ˜¯è¦åå¤æ ¸å¯¹å‚æ•°é¡ºåºï¼Œç”Ÿæ€•ä¼ é”™ä½ç½®ï¼›ä¸ºäº†é€‚é…ä¸åŒçš„å‚æ•°ç»„åˆï¼Œä¸å¾—ä¸å†™å¤šä¸ªç»“æ„ç›¸ä¼¼çš„é‡è½½å‡½æ•°ï¼Œå¯¼è‡´ä»£ç å†—ä½™ã€‚è€Œ Kotlin ä¸­çš„å‘½åå‚æ•°ä¸é»˜è®¤å‚æ•°å€¼ç‰¹æ€§ï¼Œæ­£æ˜¯ä¸ºè§£å†³è¿™äº›ç—›ç‚¹è€Œç”Ÿã€‚å®ƒä»¬ä¸ä»…èƒ½è®©å‡½æ•°è°ƒç”¨æ›´æ¸…æ™°ï¼Œè¿˜èƒ½å¤§å¹…å‡å°‘é‡å¤ä»£ç ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚ä»Šå¤©æˆ‘ä»¬å°±æ¥å¥½å¥½èŠèŠè¿™ä¸¤ä¸ªå®ç”¨ç‰¹æ€§ã€‚</p>
<h2 data-id="heading-1">äºŒã€Kotlin å‡½æ•°åŸºç¡€å›é¡¾ï¼ˆç®€å•é“ºå«ï¼‰</h2>
<p>åœ¨æ·±å…¥å­¦ä¹ æ–°ç‰¹æ€§å‰ï¼Œæˆ‘ä»¬å…ˆç®€å•å›é¡¾ä¸‹ Kotlin å‡½æ•°çš„åŸºç¡€å®šä¹‰ã€‚ä¸€ä¸ªæ ‡å‡†çš„ Kotlin å‡½æ•°ç”± <code>fun</code> å…³é”®å­—ã€å‡½æ•°åã€å‚æ•°åˆ—è¡¨ã€è¿”å›ç±»å‹å’Œå‡½æ•°ä½“ç»„æˆï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åŸºç¡€å‡½æ•°å®šä¹‰ï¼šè®¡ç®—ä¸¤ä¸ªæ•´æ•°çš„å’Œ</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">add</span><span class="hljs-params">(a: <span class="hljs-type">Int</span>, b: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
    <span class="hljs-keyword">return</span> a + b
}

<span class="hljs-comment">// è°ƒç”¨å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> result = add(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)
    println(result) <span class="hljs-comment">// è¾“å‡ºï¼š30</span>
}

</code></pre>
<p>è¿™é‡Œçš„ <code>a</code> å’Œ <code>b</code> æ˜¯ä½ç½®å‚æ•°ï¼Œè°ƒç”¨æ—¶å¿…é¡»ä¸¥æ ¼æŒ‰ç…§å®šä¹‰çš„é¡ºåºä¼ é€’å€¼ã€‚è€Œä»Šå¤©è¦è®²çš„å‘½åå‚æ•°ä¸é»˜è®¤å‚æ•°å€¼ï¼Œå°±æ˜¯å¯¹è¿™ç§åŸºç¡€å½¢å¼çš„ä¼˜åŒ–å‡çº§ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€é»˜è®¤å‚æ•°å€¼ï¼šè®©å‡½æ•°å‚æ•° â€œæœ‰å¤‡æ— æ‚£â€</h2>
<h3 data-id="heading-3">3.1 é»˜è®¤å‚æ•°å€¼çš„åŸºæœ¬å®šä¹‰</h3>
<p>é»˜è®¤å‚æ•°å€¼æŒ‡çš„æ˜¯åœ¨å‡½æ•°å®šä¹‰æ—¶ï¼Œä¸ºæŸä¸ªå‚æ•°é¢„å…ˆæŒ‡å®šä¸€ä¸ªé»˜è®¤å€¼ã€‚è¿™æ ·åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¦‚æœä¸éœ€è¦ä¿®æ”¹è¿™ä¸ªå‚æ•°ï¼Œå°±å¯ä»¥ç›´æ¥çœç•¥ï¼Œå‡½æ•°ä¼šè‡ªåŠ¨ä½¿ç”¨é¢„è®¾çš„é»˜è®¤å€¼ã€‚å®šä¹‰æ ¼å¼éå¸¸ç®€å•ï¼Œåªéœ€åœ¨å‚æ•°ç±»å‹ååŠ ä¸Š <code>=</code> å’Œé»˜è®¤å€¼å³å¯ã€‚</p>
<h3 data-id="heading-4">3.2 ç®€å•ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ— å¤æ‚é€»è¾‘ï¼‰</h3>
<p>æœ€å¸¸è§çš„åœºæ™¯å°±æ˜¯ç»™å‡½æ•°çš„éå¿…å¡«å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯æ‰“å°å‡½æ•°ï¼Œç”¨æˆ·åæ˜¯å¿…å¡«çš„ï¼Œå¹´é¾„å’Œæ€§åˆ«å¯ä»¥é€‰å¡«ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¸¦é»˜è®¤å‚æ•°å€¼çš„å‡½æ•°ï¼šæ‰“å°ç”¨æˆ·ä¿¡æ¯</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printUserInfo</span><span class="hljs-params">(
    username: <span class="hljs-type">String</span>, <span class="hljs-comment">// å¿…å¡«å‚æ•°ï¼Œæ— é»˜è®¤å€¼</span>
    age: <span class="hljs-type">Int</span> = <span class="hljs-number">18</span>,    <span class="hljs-comment">// å¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼18</span>
    gender: <span class="hljs-type">String</span> = <span class="hljs-string">"æœªçŸ¥"</span> <span class="hljs-comment">// å¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼"æœªçŸ¥"</span>
)</span></span> {
    println(<span class="hljs-string">"ç”¨æˆ·åï¼š<span class="hljs-variable">$username</span>ï¼Œå¹´é¾„ï¼š<span class="hljs-variable">$age</span>ï¼Œæ€§åˆ«ï¼š<span class="hljs-variable">$gender</span>"</span>)
}

<span class="hljs-comment">// è°ƒç”¨ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. åªä¼ å¿…å¡«å‚æ•°ï¼ˆä½¿ç”¨é»˜è®¤å¹´é¾„å’Œæ€§åˆ«ï¼‰</span>
    printUserInfo(<span class="hljs-string">"å¼ ä¸‰"</span>) <span class="hljs-comment">// è¾“å‡ºï¼šç”¨æˆ·åï¼šå¼ ä¸‰ï¼Œå¹´é¾„ï¼š18ï¼Œæ€§åˆ«ï¼šæœªçŸ¥</span>

    <span class="hljs-comment">// 2. ä¼ å¿…å¡«å‚æ•°+éƒ¨åˆ†å¯é€‰å‚æ•°</span>
    printUserInfo(<span class="hljs-string">"æå››"</span>, <span class="hljs-number">22</span>) <span class="hljs-comment">// è¾“å‡ºï¼šç”¨æˆ·åï¼šæå››ï¼Œå¹´é¾„ï¼š22ï¼Œæ€§åˆ«ï¼šæœªçŸ¥</span>

    <span class="hljs-comment">// 3. ä¼ æ‰€æœ‰å‚æ•°</span>
    printUserInfo(<span class="hljs-string">"ç‹äº”"</span>, <span class="hljs-number">25</span>, <span class="hljs-string">"ç”·"</span>) <span class="hljs-comment">// è¾“å‡ºï¼šç”¨æˆ·åï¼šç‹äº”ï¼Œå¹´é¾„ï¼š25ï¼Œæ€§åˆ«ï¼šç”·</span>
}
</code></pre>
<p>ä»ç¤ºä¾‹å¯ä»¥çœ‹å‡ºï¼Œé»˜è®¤å‚æ•°å€¼è®©å‡½æ•°è°ƒç”¨å˜å¾—éå¸¸çµæ´»ï¼Œæ ¹æ®å®é™…éœ€æ±‚ä¼ é€’å‚æ•°å³å¯ã€‚</p>
<h3 data-id="heading-5">3.3 æ³¨æ„äº‹é¡¹ï¼ˆå¦‚ä½ç½®å‚æ•°ä¼˜å…ˆçº§ï¼‰</h3>
<p>ä½¿ç”¨é»˜è®¤å‚æ•°å€¼æ—¶æœ‰ä¸€ä¸ªå…³é”®è§„åˆ™ï¼š<strong>æ— é»˜è®¤å€¼çš„å¿…å¡«å‚æ•°å¿…é¡»æ”¾åœ¨æœ‰é»˜è®¤å€¼çš„å¯é€‰å‚æ•°å‰é¢</strong>ã€‚è¿™æ˜¯å› ä¸º Kotlin ä¼šæŒ‰ç…§å‚æ•°é¡ºåºè§£æä½ç½®è°ƒç”¨ï¼Œå¦‚æœå¿…å¡«å‚æ•°åœ¨åï¼Œå°±ä¼šå‡ºç°è§£ææ··ä¹±çš„é—®é¢˜ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šæœ‰é»˜è®¤å€¼çš„å‚æ•°æ”¾åœ¨äº†å¿…å¡«å‚æ•°å‰é¢</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">wrongPrint</span><span class="hljs-params">(age: <span class="hljs-type">Int</span> = <span class="hljs-number">18</span>, username: <span class="hljs-type">String</span>)</span></span> {
    <span class="hljs-comment">// ç¼–è¯‘æŠ¥é”™ï¼šæœ‰é»˜è®¤å€¼çš„å‚æ•°ä¸èƒ½ä½äºæ— é»˜è®¤å€¼å‚æ•°ä¹‹å‰</span>
    println(<span class="hljs-string">"ç”¨æˆ·åï¼š<span class="hljs-variable">$username</span>ï¼Œå¹´é¾„ï¼š<span class="hljs-variable">$age</span>"</span>)
}
</code></pre>
<h2 data-id="heading-6">å››ã€å‘½åå‚æ•°ï¼šè®©å‡½æ•°è°ƒç”¨ â€œä¸€ç›®äº†ç„¶â€</h2>
<h3 data-id="heading-7">4.1 å‘½åå‚æ•°çš„ä½¿ç”¨è¯­æ³•</h3>
<p>å‘½åå‚æ•°æ˜¯æŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œæ˜ç¡®æŒ‡å®šå‚æ•°åå’Œå¯¹åº”çš„å€¼ï¼Œæ ¼å¼ä¸º <code>å‚æ•°å = å‚æ•°å€¼</code>ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°åœ°çŸ¥é“æ¯ä¸ªå€¼å¯¹åº”çš„å‚æ•°å«ä¹‰ï¼Œæ— éœ€è®°å¿†å‚æ•°é¡ºåºã€‚</p>
<h3 data-id="heading-8">4.2 è§£å†³å‚æ•°é¡ºåºæ··æ·†é—®é¢˜ï¼ˆç®€å•ç¤ºä¾‹ï¼‰</h3>
<p>å½“å‡½æ•°å‚æ•°è¾ƒå¤šä¸”ç±»å‹ç›¸åŒæ—¶ï¼Œä½ç½®è°ƒç”¨å¾ˆå®¹æ˜“ä¼ é”™é¡ºåºã€‚æ¯”å¦‚å®šä¹‰ä¸€ä¸ªè®¡ç®—çŸ©å½¢é¢ç§¯çš„å‡½æ•°ï¼Œé•¿å’Œå®½éƒ½æ˜¯ Int ç±»å‹ï¼Œç”¨ä½ç½®è°ƒç”¨å°±å¯èƒ½æåï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è®¡ç®—çŸ©å½¢é¢ç§¯çš„å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calculateRectangleArea</span><span class="hljs-params">(length: <span class="hljs-type">Int</span>, width: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
    <span class="hljs-keyword">return</span> length * width
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// ä½ç½®è°ƒç”¨ï¼šä¸å°å¿ƒæŠŠå®½å’Œé•¿ä¼ åäº†ï¼Œç»“æœå‡ºé”™</span>
    <span class="hljs-keyword">val</span> wrongArea = calculateRectangleArea(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>)
    println(<span class="hljs-string">"é”™è¯¯é¢ç§¯ï¼š<span class="hljs-variable">$wrongArea</span>"</span>) <span class="hljs-comment">// å®é™…æƒ³ç®—10*5ï¼Œç»“æœå¾—åˆ°5*10=50ï¼Œè™½ç»“æœå·§åˆä½†é€»è¾‘é”™è¯¯</span>

    <span class="hljs-comment">// å‘½åå‚æ•°è°ƒç”¨ï¼šæ˜ç¡®æŒ‡å®šå‚æ•°åï¼Œä¸ä¼šä¼ é”™</span>
    <span class="hljs-keyword">val</span> correctArea = calculateRectangleArea(width = <span class="hljs-number">5</span>, length = <span class="hljs-number">10</span>)
    println(<span class="hljs-string">"æ­£ç¡®é¢ç§¯ï¼š<span class="hljs-variable">$correctArea</span>"</span>) <span class="hljs-comment">// è¾“å‡ºï¼š50ï¼Œé€»è¾‘æ¸…æ™°ä¸”ç»“æœæ­£ç¡®</span>
}

</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå‘½åå‚æ•°å½»åº•è§£å†³äº†å‚æ•°é¡ºåºæ··æ·†çš„é—®é¢˜ï¼Œè®©ä»£ç æ›´å…·å¯è¯»æ€§ã€‚</p>
<h3 data-id="heading-9">4.3 å‘½åå‚æ•°ä¸ä½ç½®å‚æ•°æ··åˆä½¿ç”¨è§„åˆ™</h3>
<p>å‘½åå‚æ•°å’Œä½ç½®å‚æ•°å¯ä»¥æ··åˆä½¿ç”¨ï¼Œä½†æœ‰ä¸€ä¸ªé‡è¦è§„åˆ™ï¼š<strong>ä½ç½®å‚æ•°å¿…é¡»æ”¾åœ¨å‘½åå‚æ•°å‰é¢</strong>ã€‚å¦‚æœå…ˆå†™å‘½åå‚æ•°å†å†™ä½ç½®å‚æ•°ï¼ŒKotlin æ— æ³•æ­£ç¡®è§£æå‚æ•°é¡ºåºï¼Œä¼šç›´æ¥ç¼–è¯‘æŠ¥é”™ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹ï¼šä½ç½®å‚æ•°åœ¨å‰ï¼Œå‘½åå‚æ•°åœ¨å</span>
printUserInfo(<span class="hljs-string">"èµµå…­"</span>, gender = <span class="hljs-string">"å¥³"</span>) <span class="hljs-comment">// è¾“å‡ºï¼šç”¨æˆ·åï¼šèµµå…­ï¼Œå¹´é¾„ï¼š18ï¼Œæ€§åˆ«ï¼šå¥³</span>

<span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šå‘½åå‚æ•°åœ¨å‰ï¼Œä½ç½®å‚æ•°åœ¨å</span>
printUserInfo(age = <span class="hljs-number">20</span>, <span class="hljs-string">"å­™ä¸ƒ"</span>) <span class="hljs-comment">// ç¼–è¯‘æŠ¥é”™ï¼šå‘½åå‚æ•°ä¸èƒ½ä½äºä½ç½®å‚æ•°ä¹‹å‰</span>
</code></pre>
<h2 data-id="heading-10">äº”ã€å‘½åå‚æ•° + é»˜è®¤å‚æ•°å€¼ï¼šé»„é‡‘ç»„åˆå®æˆ˜</h2>
<h3 data-id="heading-11">5.1 ç®€åŒ–å‡½æ•°é‡è½½ï¼ˆå°‘å†™é‡å¤ä»£ç ï¼‰</h3>
<p>åœ¨ Java ä¸­ï¼Œä¸ºäº†é€‚é…ä¸åŒçš„å‚æ•°ç»„åˆï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå†™å¤šä¸ªé‡è½½å‡½æ•°ã€‚è€Œåœ¨ Kotlin ä¸­ï¼Œé€šè¿‡é»˜è®¤å‚æ•°å€¼ + å‘½åå‚æ•°çš„ç»„åˆï¼Œä¸€ä¸ªå‡½æ•°å°±èƒ½æ›¿ä»£å¤šä¸ªé‡è½½ï¼Œå¤§å¹…å‡å°‘å†—ä½™ä»£ç ã€‚</p>
<p>æ¯”å¦‚å®šä¹‰ä¸€ä¸ªæ—¥å¿—æ‰“å°å‡½æ•°ï¼Œæ”¯æŒæ‰“å°æ ‡é¢˜ã€å†…å®¹å’Œæ—¥å¿—çº§åˆ«ã€‚ç”¨ Java å¯èƒ½éœ€è¦å†™ 3 ä¸ªé‡è½½å‡½æ•°ï¼Œè€Œ Kotlin åªéœ€ä¸€ä¸ªï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlin ä¸€ä¸ªå‡½æ•°æ›¿ä»£å¤šä¸ªé‡è½½</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printLog</span><span class="hljs-params">(
    content: <span class="hljs-type">String</span>, <span class="hljs-comment">// å¿…ä¼ ï¼šæ—¥å¿—å†…å®¹</span>
    title: <span class="hljs-type">String</span> = <span class="hljs-string">"é»˜è®¤æ—¥å¿—"</span>, <span class="hljs-comment">// å¯é€‰ï¼šæ—¥å¿—æ ‡é¢˜</span>
    level: <span class="hljs-type">String</span> = <span class="hljs-string">"INFO"</span> <span class="hljs-comment">// å¯é€‰ï¼šæ—¥å¿—çº§åˆ«</span>
)</span></span> {
    println(<span class="hljs-string">"[<span class="hljs-variable">$level</span>] <span class="hljs-variable">$title</span>ï¼š<span class="hljs-variable">$content</span>"</span>)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// å¯¹åº” Java ä¸­ printLog(String content)</span>
    printLog(<span class="hljs-string">"ç³»ç»Ÿå¯åŠ¨æˆåŠŸ"</span>)
    <span class="hljs-comment">// å¯¹åº” Java ä¸­ printLog(String content, String title)</span>
    printLog(<span class="hljs-string">"ç”¨æˆ·ç™»å½•"</span>, <span class="hljs-string">"ç™»å½•æ—¥å¿—"</span>)
    <span class="hljs-comment">// å¯¹åº” Java ä¸­ printLog(String content, String title, String level)</span>
    printLog(<span class="hljs-string">"æ•°æ®å¼‚å¸¸"</span>, level = <span class="hljs-string">"ERROR"</span>)
}
</code></pre>
<h3 data-id="heading-12">5.2 æ—¥å¸¸å¼€å‘å¸¸è§åœºæ™¯ç¤ºä¾‹ï¼ˆå¦‚è¡¨å•æäº¤ã€å·¥å…·ç±»å‡½æ•°ï¼‰</h3>
<p>åœ¨è¡¨å•æäº¤åœºæ™¯ä¸­ï¼Œå¾ˆå¤šå­—æ®µæ˜¯å¯é€‰çš„ï¼ˆå¦‚åœ°å€ã€å¤‡æ³¨ï¼‰ï¼Œä½¿ç”¨è¿™ä¸ªé»„é‡‘ç»„åˆèƒ½è®©ä»£ç éå¸¸ç®€æ´ã€‚ä»¥ç”¨æˆ·æ³¨å†Œè¡¨å•ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç”¨æˆ·æ³¨å†Œè¡¨å•æäº¤å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">register</span><span class="hljs-params">(
    username: <span class="hljs-type">String</span>, <span class="hljs-comment">// å¿…å¡«ï¼šç”¨æˆ·å</span>
    password: <span class="hljs-type">String</span>, <span class="hljs-comment">// å¿…å¡«ï¼šå¯†ç </span>
    phone: <span class="hljs-type">String</span> = <span class="hljs-string">""</span>, <span class="hljs-comment">// å¯é€‰ï¼šæ‰‹æœºå·</span>
    address: <span class="hljs-type">String</span> = <span class="hljs-string">""</span>, <span class="hljs-comment">// å¯é€‰ï¼šåœ°å€</span>
    remark: <span class="hljs-type">String</span> = <span class="hljs-string">""</span> <span class="hljs-comment">// å¯é€‰ï¼šå¤‡æ³¨</span>
)</span></span> {
    println(<span class="hljs-string">"""
        æ³¨å†Œä¿¡æ¯æäº¤æˆåŠŸï¼š
        ç”¨æˆ·åï¼š<span class="hljs-variable">$username</span>
        å¯†ç ï¼š***ï¼ˆå·²åŠ å¯†ï¼‰
        æ‰‹æœºå·ï¼š<span class="hljs-subst">${if (phone.isEmpty()) <span class="hljs-string">"æœªå¡«å†™"</span> else phone}</span>
        åœ°å€ï¼š<span class="hljs-subst">${if (address.isEmpty()) <span class="hljs-string">"æœªå¡«å†™"</span> else address}</span>
        å¤‡æ³¨ï¼š<span class="hljs-subst">${if (remark.isEmpty()) <span class="hljs-string">"æ— "</span> else remark}</span>
    """</span>.trimIndent())
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åªå¡«å¿…å¡«ä¿¡æ¯æ³¨å†Œ</span>
    register(<span class="hljs-string">"kotlin_user"</span>, <span class="hljs-string">"123456a"</span>)

    <span class="hljs-comment">// å¡«å¿…å¡«+éƒ¨åˆ†å¯é€‰ä¿¡æ¯æ³¨å†Œ</span>
    register(<span class="hljs-string">"java_user"</span>, <span class="hljs-string">"abc654321"</span>, phone = <span class="hljs-string">"13800138000"</span>, address = <span class="hljs-string">"åŒ—äº¬å¸‚"</span>)
}

</code></pre>
<p>å·¥å…·ç±»å‡½æ•°ä¸­è¿™ä¸ªç»„åˆä¹Ÿå¾ˆå¸¸ç”¨ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²æ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æŒæŒ‡å®šå‰ç¼€ã€åç¼€å’Œåˆ†éš”ç¬¦ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å­—ç¬¦ä¸²æ ¼å¼åŒ–å·¥å…·å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">formatString</span><span class="hljs-params">(
    content: <span class="hljs-type">String</span>, <span class="hljs-comment">// å¿…ä¼ ï¼šåŸå§‹å†…å®¹</span>
    prefix: <span class="hljs-type">String</span> = <span class="hljs-string">""</span>, <span class="hljs-comment">// å¯é€‰ï¼šå‰ç¼€</span>
    suffix: <span class="hljs-type">String</span> = <span class="hljs-string">""</span>, <span class="hljs-comment">// å¯é€‰ï¼šåç¼€</span>
    separator: <span class="hljs-type">String</span> = <span class="hljs-string">""</span> <span class="hljs-comment">// å¯é€‰ï¼šåˆ†éš”ç¬¦ï¼ˆå¤šä¸ªå†…å®¹æ—¶ç”¨ï¼‰</span>
)</span></span>: String {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"<span class="hljs-variable">$prefix</span><span class="hljs-variable">$separator</span><span class="hljs-variable">$content</span><span class="hljs-variable">$separator</span><span class="hljs-variable">$suffix</span>"</span>
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// ç®€å•æ·»åŠ å‰ç¼€</span>
    <span class="hljs-keyword">val</span> withPrefix = formatString(<span class="hljs-string">"æµ‹è¯•å†…å®¹"</span>, prefix = <span class="hljs-string">"ã€æç¤ºã€‘"</span>)
    println(withPrefix) <span class="hljs-comment">// è¾“å‡ºï¼šã€æç¤ºã€‘æµ‹è¯•å†…å®¹</span>

    <span class="hljs-comment">// æ·»åŠ å‰ç¼€ã€åç¼€å’Œåˆ†éš”ç¬¦</span>
    <span class="hljs-keyword">val</span> fullFormat = formatString(<span class="hljs-string">"æ ¸å¿ƒæ•°æ®"</span>, prefix = <span class="hljs-string">"ç»“æœï¼š"</span>, suffix = <span class="hljs-string">"ï¼ˆç»“æŸï¼‰"</span>, separator = <span class="hljs-string">"|"</span>)
    println(fullFormat) <span class="hljs-comment">// è¾“å‡ºï¼šç»“æœï¼š|æ ¸å¿ƒæ•°æ®|ï¼ˆç»“æŸï¼‰</span>
}

</code></pre>
<h2 data-id="heading-13">å…­ã€å¸¸è§è¯¯åŒºä¸å°æŠ€å·§</h2>
<h3 data-id="heading-14">6.1 é¿å…çš„é”™è¯¯ç”¨æ³•ï¼ˆç®€å•ä¸¾ä¾‹ï¼‰</h3>
<ul>
<li><strong>é‡å¤ä¼ é€’å‚æ•°</strong>ï¼šåŒä¸€å‚æ•°ä¸èƒ½æ—¢ç”¨ä½ç½®ä¼ é€’åˆç”¨å‘½åä¼ é€’ï¼Œä¼šå¯¼è‡´ç¼–è¯‘æŠ¥é”™ã€‚</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šé‡å¤ä¼ é€’ageå‚æ•°</span>
printUserInfo(<span class="hljs-string">"å‘¨å…«"</span>, <span class="hljs-number">28</span>, age = <span class="hljs-number">30</span>)
<span class="hljs-comment">// ç¼–è¯‘æŠ¥é”™ï¼šå‚æ•°ageè¢«å¤šæ¬¡æŒ‡å®š</span>

</code></pre>
<ul>
<li><strong>é»˜è®¤å€¼ä¸ºnullä½†æœªå£°æ˜å¯ç©º</strong>ï¼šå¦‚æœé»˜è®¤å€¼è®¾ä¸º nullï¼Œå‚æ•°ç±»å‹å¿…é¡»å£°æ˜ä¸ºå¯ç©ºç±»å‹ï¼ˆåŠ  <code>?</code>ï¼‰ï¼Œå¦åˆ™ç¼–è¯‘æŠ¥é”™ã€‚</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šé»˜è®¤å€¼ä¸ºnullï¼Œä½†å‚æ•°ç±»å‹éç©º</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getNickname</span><span class="hljs-params">(nickname: <span class="hljs-type">String</span> = <span class="hljs-literal">null</span>)</span></span> {
    <span class="hljs-comment">// ç¼–è¯‘æŠ¥é”™ï¼šnull ä¸èƒ½èµ‹å€¼ç»™éç©ºç±»å‹ String</span>
    println(nickname ?: <span class="hljs-string">"åŒ¿å"</span>)
}

<span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹ï¼šå£°æ˜ä¸ºå¯ç©ºç±»å‹ String?</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getNickname</span><span class="hljs-params">(nickname: <span class="hljs-type">String</span>? = <span class="hljs-literal">null</span>)</span></span> {
    println(nickname ?: <span class="hljs-string">"åŒ¿å"</span>)
}

</code></pre>
<h3 data-id="heading-15">6.2 æå‡ä»£ç å¯è¯»æ€§çš„å°æŠ€å·§</h3>
<ul>
<li><strong>å‚æ•°è¾ƒå¤šæ—¶ç”¨å‘½åå‚æ•°</strong>ï¼šå½“å‡½æ•°å‚æ•°è¶…è¿‡ 3 ä¸ªæ—¶ï¼Œä¼˜å…ˆä½¿ç”¨å‘½åå‚æ•°ï¼Œè®©è°ƒç”¨è€…ä¸€çœ¼çœ‹æ‡‚æ¯ä¸ªå‚æ•°çš„å«ä¹‰ã€‚</li>
<li><strong>é»˜è®¤å€¼ç”¨å¸¸è§åœºæ™¯å€¼</strong>ï¼šé»˜è®¤å€¼å°½é‡è®¾ç½®ä¸ºæœ€å¸¸ç”¨çš„åœºæ™¯å€¼ï¼Œå‡å°‘è°ƒç”¨æ—¶çš„å‚æ•°ä¼ é€’ã€‚æ¯”å¦‚ç”¨æˆ·å¹´é¾„é»˜è®¤ 18ï¼Œæ—¥å¿—çº§åˆ«é»˜è®¤ INFOã€‚</li>
<li><strong>æ··åˆè°ƒç”¨æ—¶æ§åˆ¶ä½ç½®å‚æ•°æ•°é‡</strong>ï¼šæ··åˆä½¿ç”¨ä½ç½®å‚æ•°å’Œå‘½åå‚æ•°æ—¶ï¼Œä½ç½®å‚æ•°ä¸å®œè¿‡å¤šï¼Œå»ºè®®ä¸è¶…è¿‡ 2 ä¸ªï¼Œé¿å…å¯è¯»æ€§ä¸‹é™ã€‚</li>
</ul>
<h2 data-id="heading-16">ä¸ƒã€æ€»ç»“ï¼šæ ¸å¿ƒä¼˜åŠ¿ä¸ä½¿ç”¨å»ºè®®</h2>
<h3 data-id="heading-17">7.1 æ ¸å¿ƒä¼˜åŠ¿</h3>
<ol>
<li><strong>å‡å°‘ä»£ç å†—ä½™</strong>ï¼šç”¨ä¸€ä¸ªå‡½æ•°æ›¿ä»£å¤šä¸ªé‡è½½å‡½æ•°ï¼Œé¿å…é‡å¤ç¼–å†™ç›¸ä¼¼é€»è¾‘ã€‚</li>
<li><strong>æå‡ä»£ç å¯è¯»æ€§</strong>ï¼šå‘½åå‚æ•°æ˜ç¡®å‚æ•°å«ä¹‰ï¼Œè§£å†³å‚æ•°é¡ºåºæ··æ·†é—®é¢˜ã€‚</li>
<li><strong>å¢å¼ºè°ƒç”¨çµæ´»æ€§</strong>ï¼šé»˜è®¤å‚æ•°å€¼è®©éå¿…å¡«å‚æ•°å¯çµæ´»çœç•¥ï¼Œé€‚é…ä¸åŒåœºæ™¯ã€‚</li>
</ol>
<h3 data-id="heading-18">7.2 ä½¿ç”¨å»ºè®®</h3>
<ol>
<li>å®šä¹‰å‡½æ•°æ—¶ï¼Œå°†å¿…å¡«å‚æ•°æ”¾åœ¨å‰é¢ï¼Œå¯é€‰å‚æ•°ï¼ˆå¸¦é»˜è®¤å€¼ï¼‰æ”¾åœ¨åé¢ã€‚</li>
<li>è°ƒç”¨å‚æ•°è¾ƒå¤šæˆ–ç±»å‹ç›¸åŒçš„å‡½æ•°æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨å‘½åå‚æ•°ã€‚</li>
<li>é»˜è®¤å‚æ•°å€¼å°½é‡ä½¿ç”¨é«˜é¢‘åœºæ™¯å€¼ï¼ŒåŒæ—¶è€ƒè™‘ç©ºå®‰å…¨ï¼ˆå¯ç©ºå‚æ•°éœ€åŠ  <code>?</code>ï¼‰ã€‚</li>
<li>æ··åˆè°ƒç”¨æ—¶ï¼Œç¡®ä¿ä½ç½®å‚æ•°åœ¨å‘½åå‚æ•°ä¹‹å‰ï¼Œä¸”ä½ç½®å‚æ•°æ•°é‡ä¸å®œè¿‡å¤šã€‚</li>
</ol>
<p>å‘½åå‚æ•°ä¸é»˜è®¤å‚æ•°å€¼æ˜¯ Kotlin ä¸­éå¸¸å®ç”¨çš„åŸºç¡€ç‰¹æ€§ï¼Œä¸Šæ‰‹ç®€å•ä½†èƒ½æ˜¾è‘—æå‡å¼€å‘æ•ˆç‡ã€‚å»ºè®®åœ¨æ—¥å¸¸å¼€å‘ä¸­ä¸»åŠ¨è¿ç”¨ï¼Œè®©ä½ çš„ Kotlin ä»£ç æ›´ç®€æ´ã€æ›´æ˜“è¯»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘æ˜¯å¦‚ä½•é«˜æ•ˆå­¦ä¹ å¤§æ¨¡å‹çš„]]></title>    <link>https://juejin.cn/post/7573523709300604963</link>    <guid>https://juejin.cn/post/7573523709300604963</guid>    <pubDate>2025-11-18T00:46:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573523709300604963" data-draft-id="7573512056089526307" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘æ˜¯å¦‚ä½•é«˜æ•ˆå­¦ä¹ å¤§æ¨¡å‹çš„"/> <meta itemprop="keywords" content="LLM,äººå·¥æ™ºèƒ½,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-11-18T00:46:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜é˜¿å¥"/> <meta itemprop="url" content="https://juejin.cn/user/1517786987244510"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘æ˜¯å¦‚ä½•é«˜æ•ˆå­¦ä¹ å¤§æ¨¡å‹çš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1517786987244510/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜é˜¿å¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:46:50.000Z" title="Tue Nov 18 2025 00:46:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ç›®å‰å¤§æ¨¡å‹çš„å‘å±•æ—¥æ–°æœˆå¼‚ï¼Œæ¨¡å‹æ¶æ„å¿«é€Ÿè¿­ä»£ã€å„ç±» AI å·¥å…·ä¸æ¦‚å¿µå±‚å‡ºä¸ç©·â€”â€”Cursorã€Codexã€Augementã€Traeã€Qoder ç­‰ç­‰ç­‰ç­‰ï¼Œé¢å¯¹è¿™äº›æµ·é‡ä¿¡æ¯ï¼ŒçœŸæ˜¯è®©äººå¤´å¤§ã€‚</p>
<p>ä¸ºäº†åº”å¯¹è¿™ç§â€œä¿¡æ¯çˆ†ç‚¸â€ï¼Œæˆ‘ç»“åˆè‡ªèº«å®è·µï¼Œé€æ­¥æ‘¸ç´¢å‡ºä¸€å¥—<strong>é«˜æ•ˆä¸”å¯æŒç»­</strong>çš„ AI å­¦ä¹ æ–¹æ³•ï¼š</p>
<ul>
<li><strong>å®æ—¶åŠ¨æ€è·å–ï¼šX å¹³å°ï¼ˆTwitterï¼‰+ Manus è‡ªåŠ¨æ•´ç†ã€‚</strong></li>
<li><strong>æ·±åº¦çŸ¥è¯†å­¦ä¹ ï¼šYouTube + NotebookLM æ¢³ç†æ€»ç»“ã€‚</strong></li>
</ul>
<p>è¿™å¥—æ–¹æ³•ä¸ä»…å¤§å¹…é™ä½äº†æˆ‘çš„ä¿¡æ¯è·å–æˆæœ¬ï¼Œä¹Ÿè®©æˆ‘èƒ½æŒç»­æ·±å…¥åœ°ç†è§£ AI æ ¸å¿ƒæŠ€æœ¯ã€‚</p>
<p>å¸Œæœ›ä¹Ÿèƒ½å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€è·å– AI å®æ—¶åŠ¨æ€ä¿¡æ¯</h2>
<blockquote>
<p>è®©ä¿¡æ¯è‡ªåŠ¨æµå‘ä½ ï¼Œè€Œä¸æ˜¯ä½ å»æ‰¾ä¿¡æ¯ã€‚</p>
</blockquote>
<h3 data-id="heading-2">X å¹³å°ï¼ˆAI å‰æ²¿ä¿¡æ¯æ±‡é›†åœ°ï¼‰</h3>
<p>ç›®å‰å…¨çƒèŒƒå›´å†…æœ€å®æ—¶ã€æœ€å‰æ²¿çš„ AI ä¿¡æ¯å‡ ä¹éƒ½é¦–å‘äº <strong>X å¹³å°</strong>ï¼š</p>
<ul>
<li>OpenAIã€DeepSeekã€xAIã€DeepMindã€Meta ç­‰å®˜æ–¹è´¦å·ã€‚</li>
<li>è¿™äº›å…¬å¸çš„æ ¸å¿ƒäººç‰©ï¼šSam Altmanã€Greg Brockmanã€Andrej Karpathy ç­‰</li>
<li>Cursorã€Devin ç­‰å¼€å‘è€…å·¥å…·å›¢é˜Ÿã€‚</li>
<li>ç ”ç©¶å‘˜ã€å·¥ç¨‹å¸ˆã€ç‹¬ç«‹å¼€å‘è€…çš„æƒ³æ³•ã€ç ”ç©¶ã€è®¨è®ºã€demo ç­‰ã€‚</li>
</ul>
<p>ä½†æ˜¯æ¯å¤©æ‰‹åŠ¨åˆ· X éœ€è¦å¤§é‡æ—¶é—´ï¼Œå°¤å…¶æ˜¯æˆ‘åˆå…³æ³¨äº†å‡ åä¸ªè´¦å·ï¼Œä¸€ä¸ªäººæ ¹æœ¬çœ‹ä¸è¿‡æ¥ï¼Œä¹Ÿéš¾ä»¥æŒç»­ã€‚</p>
<p>æ‰€ä»¥æˆ‘éœ€è¦ä¸€ä¸ªèƒ½å¤Ÿå¸®æˆ‘åˆ· X å¹³å°ï¼Œæ€»ç»“æ•´ç†æ‰€æœ‰ AI ä¿¡æ¯ï¼Œå†æ¨é€ç»™æˆ‘çš„å·¥å…·ã€‚</p>
<h3 data-id="heading-3">Manusï¼ˆè‡ªåŠ¨æ”¶é›† + å®šæ—¶æ¨é€ï¼‰</h3>
<p>Manus åˆšå¥½æ‹¥æœ‰æˆ‘éœ€è¦çš„æ‰€æœ‰èƒ½åŠ›ï¼Œè€Œä¸”å…è´¹ç”¨æˆ·å°±å¯ä»¥ä½¿ç”¨ã€‚</p>
<p>å®˜ç½‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmanus.im%2Fapp" target="_blank" title="https://manus.im/app" ref="nofollow noopener noreferrer">manus.im/app</a></p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c70329ffaacc4b1da25baf4784a95def~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=SbnJbENDygKUlokgxypexLjrj7U%3D" alt="2fXwrXviaydm6.png" width="100%" loading="lazy"/>
<p>æ·»åŠ å®šæ—¶ä»»åŠ¡</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77fb4840d09942cca2a2bd86de5e2280~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=0OrQf77dGCbj7hiAydSFU%2BUD4u4%3D" alt="NQt4DJE5xfLtB.png" width="100%" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b6b33128f6b42d98f947d4863d75c8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=9Re%2FSgA%2BbT4Tb18Oqn2H4fXCzGk%3D" alt="rFyWM521AVWjo.png" width="100%" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05b5c4ea50bf49069f9e7d4c1f3cdfc9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=wLe%2BF2feJ1aSa%2FPuBn1xIWuqTao%3D" alt="Xt4qUGxgUEwLz.png" width="100%" loading="lazy"/>
<p>å®Œæ•´ä»»åŠ¡æç¤ºè¯</p>
<pre><code class="hljs language-markdown" lang="markdown">
ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ AI è¡Œä¸šè§‚å¯Ÿå‘˜ï¼Œå…·å¤‡å‡ºè‰²çš„ä¿¡æ¯æ”¶é›†ã€ç­›é€‰ã€æ¦‚æ‹¬ä¸è¶‹åŠ¿åˆ†æèƒ½åŠ›ã€‚
ä½ çš„ä»»åŠ¡æ˜¯æ”¶é›† Twitter/X å¹³å°ä¸Šè¿‡å» 24 å°æ—¶å†…ï¼Œä¸ä»¥ä¸‹è´¦å·æˆ–å…³é”®è¯ç›¸å…³çš„å¸–å­ï¼š
<span class="hljs-bullet">-</span> OpenAIï¼ˆåŒ…æ‹¬ Sam Altmanã€Greg Brockmanã€Ilya Sutskeverï¼‰
<span class="hljs-bullet">-</span> Anthropicï¼ˆClaude å›¢é˜Ÿï¼‰
<span class="hljs-bullet">-</span> Cursor å›¢é˜Ÿä¸ç›¸å…³å·¥ç¨‹å¸ˆ
<span class="hljs-bullet">-</span> Andrej Karpathy
<span class="hljs-bullet">-</span> DeepSeekã€Mistralã€xAIã€Meta AIã€Google DeepMind ç­‰å›¢é˜Ÿ

ä½ éœ€è¦å¯¹ä¿¡æ¯è¿›è¡Œåˆ†æä¸æ•´åˆï¼Œè¾“å‡ºç®€è¦æƒ…æŠ¥æ‘˜è¦ã€‚
è¾“å‡ºè¯­è¨€ä¸ºç®€ä½“ä¸­æ–‡ï¼Œé£æ ¼æ¸…æ™°ã€ç®€æ´ã€æœ‰ç»“æ„ã€‚
å¦‚æœä½ è·å–ä¸åˆ°åŸæ–‡é“¾æ¥ï¼Œé‚£å±•ç¤ºä½ è·å–ä¿¡æ¯æºçš„é“¾æ¥

ä»»åŠ¡å†…å®¹ï¼š
<span class="hljs-bullet">1.</span> æ±‡æ€»è¿™äº›è´¦å·å‘å¸ƒæˆ–è½¬å‘çš„æ¨æ–‡ï¼ˆè¿‡å» 24 å°æ—¶ï¼‰
<span class="hljs-bullet">2.</span> é€‰å‡ºæœ€å…·ä»£è¡¨æ€§ã€ä¿¡æ¯é‡æœ€é«˜çš„ 5~10 æ¡
<span class="hljs-bullet">3.</span> æä¾›æ¯æ¡æ¨æ–‡çš„ï¼š
<span class="hljs-bullet">-</span> ä½œè€…å / æœºæ„å
<span class="hljs-bullet">-</span> æ¨æ–‡åŸæ–‡æ‘˜è¦ï¼ˆä¸­è‹±æ–‡ç®€è¦ç¿»è¯‘ï¼‰
<span class="hljs-bullet">-</span> åŸæ–‡é“¾æ¥
<span class="hljs-bullet">-</span> äº‹ä»¶ä¸»é¢˜ï¼ˆå¦‚æ¨¡å‹æ›´æ–°ã€è®ºæ–‡ã€è§‚ç‚¹ã€è¡Œä¸šåŠ¨æ€ï¼‰
<span class="hljs-bullet">4.</span> åœ¨æœ€åéƒ¨åˆ†ï¼š
<span class="hljs-bullet">-</span> æ¦‚è¿°ä»Šæ—¥ AI è¡Œä¸šçš„æ€»ä½“è¶‹åŠ¿ï¼ˆ100~200 å­—ï¼‰
<span class="hljs-bullet">-</span> æ ‡æ³¨æ˜¯å¦æœ‰å€¼å¾—æŒç»­å…³æ³¨çš„æ–°çº¿ç´¢ï¼ˆå¦‚æ¨¡å‹æ›´æ–°é¢„å‘Šã€æ–°åˆä½œã€æŠ€æœ¯çªç ´ï¼‰

<span class="hljs-section">è¾“å‡ºæ ¼å¼ï¼š
---</span>
ã€AIæ¯æ—¥æƒ…æŠ¥ç®€æŠ¥ - {{date}}ã€‘

ğŸ“ä»Šæ—¥é‡ç‚¹è¯é¢˜ï¼š
<span class="hljs-bullet">-</span> â€¦

ğŸ’¬ æ¨æ–‡ç²¾é€‰ï¼š
1ï¸âƒ£ ä½œè€…ï¼š@karpathy
å†…å®¹æ‘˜è¦ï¼šâ€¦
åŸæ–‡é“¾æ¥ï¼šâ€¦

2ï¸âƒ£ ä½œè€…ï¼š@OpenAI
å†…å®¹æ‘˜è¦ï¼šâ€¦
åŸæ–‡é“¾æ¥ï¼šâ€¦

ğŸ“Š è¶‹åŠ¿åˆ†æï¼š
<span class="hljs-section">ï¼ˆæ€»ç»“ä»Šæ—¥AIé¢†åŸŸå€¼å¾—å…³æ³¨çš„è¶‹åŠ¿ä¸è§‚ç‚¹ï¼‰
---</span>
</code></pre>
<p>è¿™æ ·é€šè¿‡è§„åˆ’æç¤ºè¯å’Œå®šæ—¶ä»»åŠ¡åŠŸèƒ½ï¼ŒManus å°±ä¼šæ¯å¤©è‡ªåŠ¨ç»™æˆ‘æ¨é€ä¸€ä»½ã€ŠAI æ¯æ—¥ç®€æŠ¥ã€‹ã€‚</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85d92535456342c59613860e14b3e02a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=50L1OByWW%2FPEOFfztqSixmRCC%2BU%3D" alt="qKKA5gJw5hQmH.png" width="100%" loading="lazy"/>
<h2 data-id="heading-4">äºŒã€æ·±åº¦å­¦ä¹ </h2>
<blockquote>
<p>ä»â€œçŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆâ€åˆ°â€œç†è§£ä¸ºä»€ä¹ˆè¿™æ ·åšâ€</p>
</blockquote>
<p>è·å–åˆ° AI ä¿¡æ¯åï¼Œæ›´è¿›ä¸€æ­¥å°±éœ€è¦å¼„æ‡‚<strong>ä¸ºä»€ä¹ˆè¿™æ ·åšä»¥åŠèƒŒååŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>æˆ‘ä¸»è¦ä½¿ç”¨ YouTube å’Œ Notebook LM è¿™ä¸¤ä¸ªå·¥å…·è¿›è¡Œâ€œæ·±åº¦å­¦ä¹ â€ã€‚</p>
<p>YouTube è§†é¢‘æˆ‘ä¼šå®Œæ•´çš„çœ‹ä¸€éï¼Œå°¤å…¶æ˜¯é«˜è´¨é‡çš„æ’­å®¢å’Œè®¿è°ˆï¼Œç„¶åå†é€šè¿‡ NotebookLM æ€»ç»“æ•´ç†å…³é”®å†…å®¹ä»¥åŠé€šè¿‡å¯¹è¯å†è¿›ä¸€æ­¥å­¦ä¹ æŸäº›çŸ¥è¯†ã€‚</p>
<h3 data-id="heading-5">YouTubeï¼ˆæœ€å¥½çš„ AI æ·±åº¦å†…å®¹æºï¼‰</h3>
<p>YouTube ä¸Šæœ‰å¤§é‡ä¼˜è´¨ã€å…è´¹çš„ AI æ·±åº¦å†…å®¹ï¼Œæ¨èä¸€äº›æˆ‘å¸¸çœ‹çš„é¢‘é“ï¼š</p>
<ul>
<li>OpenAI DevDay / developer talkï¼ˆå®˜æ–¹æ·±åº¦è®²è§£ï¼‰</li>
<li>Dwarkesh Patelï¼ˆé«˜è´¨é‡è®¿è°ˆæ’­å®¢ï¼‰</li>
<li>Riley Brownï¼ˆVibe Codingï¼‰</li>
<li>Andrej Karpathyï¼ˆLLM åŸç†ã€Tokenizerï¼‰</li>
</ul>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4855736277e64777915807cb91bcb203~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=%2Bipq3%2B4U8F6Zom%2F52X9tppwN65g%3D" alt="iHfHLtf7S0VHC.png" width="100%" loading="lazy"/>
<p>è¿™é‡Œæ¨èä¸€ä¸ªå®æ—¶ç¿»è¯‘ YouTube è§†é¢‘å­—å¹•çš„ Chrome æµè§ˆå™¨æ’ä»¶ï¼š<strong>Trancy</strong>ã€‚åœ¨å¯¹æ¯”äº†æ²‰æµ¸å¼ç¿»è¯‘ï¼Œç®€æ˜“ç¿»è¯‘ç­‰å·¥å…·åï¼Œè¿™ä¸ªä½¿ç”¨ä½“éªŒæœ€å¥½ã€‚</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7be783894a154c7f8bec5c4ed97caee3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=zoM5M4RmYhHiDSiIVTQBpCk2HLw%3D" alt="8aNxWGERVccGl.png" width="100%" loading="lazy"/>
<h3 data-id="heading-6">NotebookLMï¼ˆå°†è§†é¢‘å†…å®¹æ•´ç†æˆ AI æ•™ç¨‹ï¼‰</h3>
<p>åªéœ€è¦æŠŠ YouTube è§†é¢‘é“¾æ¥ç²˜è´´åˆ° NotebookLMï¼Œå®ƒå°±èƒ½è‡ªåŠ¨ç”Ÿæˆè¯¾ç¨‹æçº²ã€æ€ç»´å¯¼å›¾ã€æŠ¥å‘Šç­‰å¤šç§å†…å®¹å½¢å¼ï¼Œç„¶åè¿˜å¯ä»¥å’Œè§†é¢‘å†…å®¹è¿›è¡Œå¯¹è¯å’Œæé—®ã€‚</p>
<p>å®˜ç½‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnotebooklm.google.com%2F" target="_blank" title="https://notebooklm.google.com/" ref="nofollow noopener noreferrer">notebooklm.google.com/</a></p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a599fb09c644cf8a6dfedde52ab697a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=0VFP8LN3w%2FN1Te95YmWBnq0kaIU%3D" alt="sbrS6CpCjKrIJ.png" width="100%" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8540b64e85cf4393b061a51297ccef29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=A2lbvDxLUNxLqgv%2FC%2BHvlRWzd%2Bs%3D" alt="oyuOa7i5AHEYk.png" width="100%" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65bc116cc5574cba9106ebfdca6a83da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6Zi_5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764031609&amp;x-signature=%2FMRaf4QYNYxgUQFBjA6HgApAFQY%3D" alt="UyfqWnRQXEE6L.png" width="100%" loading="lazy"/>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p>AI å·¥å…·å±‚å‡ºä¸ç©·ï¼Œå¦‚ä½•åˆç†åˆ©ç”¨å®ƒä»¬æå‡æ•ˆç‡ï¼Œæ˜¯æˆ‘åœ¨ä¸æ–­å­¦ä¹ è¿‡ç¨‹ä¸­ä¸€ç›´åœ¨æ€è€ƒçš„é—®é¢˜ã€‚å®è·µä¸‹æ¥ï¼Œæˆ‘å‘ç°ä»è‡ªèº«çš„çœŸå®éœ€æ±‚å’Œç—›ç‚¹å‡ºå‘ï¼Œæ›´èƒ½æ‰¾åˆ°é€‚åˆçš„å·¥å…·å’Œæ–¹æ³•ã€‚</p>
<p>å¦‚æœæœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿Â <strong>ç‚¹èµ + æ”¶è—</strong>Â ï¼Œéå¸¸æ„Ÿè°¢ï¼</p>
<p>æˆ‘æ˜¯<strong>é˜¿å¥</strong>ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangGraph å¦‚ä½•é€šè¿‡ Checkpoint å®ç°æŒä¹…åŒ–]]></title>    <link>https://juejin.cn/post/7573597479981121572</link>    <guid>https://juejin.cn/post/7573597479981121572</guid>    <pubDate>2025-11-18T02:50:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573597479981121572" data-draft-id="7573592952242389044" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangGraph å¦‚ä½•é€šè¿‡ Checkpoint å®ç°æŒä¹…åŒ–"/> <meta itemprop="keywords" content="LangChain"/> <meta itemprop="datePublished" content="2025-11-18T02:50:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ALLINAI"/> <meta itemprop="url" content="https://juejin.cn/user/4001878056639549"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangGraph å¦‚ä½•é€šè¿‡ Checkpoint å®ç°æŒä¹…åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4001878056639549/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ALLINAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:50:23.000Z" title="Tue Nov 18 2025 02:50:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>éšç€ LLM ç³»ç»Ÿè¶Šæ¥è¶Šå¤šåœ°ç”¨äºå¯¹è¯ã€ä»£ç†ã€ä»»åŠ¡å‹å·¥ä½œæµç­‰åœºæ™¯ï¼ŒæŒä¹…åŒ–ï¼ˆpersistent stateï¼‰æ¸æ¸æˆä¸ºå…³é”®éœ€æ±‚ã€‚LangGraph æä¾›äº†å†…ç½®çš„æŒä¹…åŒ–å±‚ï¼Œé€šè¿‡â€œæ£€æŸ¥ç‚¹ (checkpointer)â€æœºåˆ¶ï¼Œåœ¨æ‰§è¡Œå›¾ (graph) çš„æ¯ä¸€æ­¥ (super-step) ä¿å­˜çŠ¶æ€ï¼Œä»è€Œæ”¯æŒ <strong>è®°å¿† (memory)ã€å®¹é”™ (fault-tolerance)ã€æ—¶é—´æ—…è¡Œ (time travel)ã€äººæœºåä½œ (human-in-the-loop)</strong> ç­‰èƒ½åŠ›ã€‚</p>
<p>ä¸‹é¢å°±è¯¦ç»†æ‹†è§£ LangGraph çš„æŒä¹…åŒ–æœºåˆ¶ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æŒä¹…åŒ–å±‚æ€»è§ˆ</h2>
<ul>
<li>LangGraph æœ‰å†…ç½®çš„ <strong>checkpointer æ¥å£</strong>ï¼Œå®ƒè´Ÿè´£åœ¨å›¾æ‰§è¡Œè¿‡ç¨‹ä¸­ä¿å­˜çŠ¶æ€å¿«ç…§ã€‚</li>
<li>å½“ä½ ç¼–è¯‘ä¸€ä¸ª StateGraphï¼ˆæˆ–å…¶ä»–å›¾ï¼‰æ—¶ï¼Œåªè¦ä¼ å…¥ä¸€ä¸ª checkpointerï¼ŒLangGraph å°±ä¼šåœ¨æ¯ä¸ª <a href="https://juejin.cn/post/7573512056089952291" target="_blank" title="https://juejin.cn/post/7573512056089952291">super-step</a>è‡ªåŠ¨åˆ›å»º checkpointã€‚</li>
<li>è¿™äº› checkpoint è¢«å½’æ¡£åˆ°ä¸€ä¸ª â€œçº¿ç¨‹ (thread)â€ ä¸­ã€‚æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„ ID (thread_id)ï¼Œä»£è¡¨ä¸€ä¸ªé€»è¾‘æ‰§è¡Œåºåˆ—ã€‚</li>
<li>é€šè¿‡çº¿ç¨‹ï¼Œå¯ä»¥åœ¨æ‰§è¡Œç»“æŸåè®¿é—®çŠ¶æ€ (å†å² / å½“å‰)ï¼Œä»è€Œå®ç°çŠ¶æ€è¿½è¸ªã€æ¢å¤ç­‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒæ¦‚å¿µè¯¦è§£</h2>
<h3 data-id="heading-2">1. çº¿ç¨‹ (Thread)</h3>
<ul>
<li>
<p><strong>çº¿ç¨‹ (Thread)</strong> æ˜¯ç”¨äºæ ‡è¯†ä¸€ç³»åˆ—æ£€æŸ¥ç‚¹ (checkpoints) çš„é€»è¾‘å•å…ƒã€‚</p>
</li>
<li>
<p>å½“ä½ è°ƒç”¨å›¾ (invoke graph) æ—¶ï¼Œéœ€è¦åœ¨ <code>config</code> çš„ <code>configurable</code> éƒ¨åˆ†æŒ‡å®šä¸€ä¸ª <code>thread_id</code>ï¼š</p>
<pre><code class="hljs language-python" lang="python">config = {<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"1"</span>}}
</code></pre>
</li>
<li>
<p>æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå›¾çŠ¶æ€ä¼šéšç€ super-step å­˜å‚¨åˆ°è¯¥çº¿ç¨‹å¯¹åº”çš„å­˜å‚¨ä¸­ã€‚</p>
</li>
<li>
<p>ä¹‹åå¯ä»¥é€šè¿‡è¯¥ thread æ¥è¯»å–å†å²çŠ¶æ€ï¼ŒæŸ¥çœ‹æ‰§è¡Œå†å²ã€å›æº¯ç­‰ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-3">2. æ£€æŸ¥ç‚¹ (Checkpoint)</h3>
<ul>
<li>
<p><strong>Checkpoint</strong> æ˜¯æŸä¸€æ—¶åˆ»å›¾çŠ¶æ€çš„å¿«ç…§ (snapshot)ï¼Œç”± checkpointer ä¿å­˜ã€‚</p>
</li>
<li>
<p>LangGraph ä½¿ç”¨ä¸€ä¸ª <code>StateSnapshot</code> å¯¹è±¡æ¥è¡¨è¾¾ checkpointï¼Œå®ƒåŒ…å«ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š</p>
<ul>
<li><code>config</code>ï¼šå½“æ—¶çš„ config (å¦‚ thread_id, checkpoint_id)</li>
<li><code>metadata</code>ï¼šä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ (ä¾‹å¦‚æ¯ä¸€æ­¥æ˜¯è°å†™äº†ä»€ä¹ˆ)</li>
<li><code>values</code>ï¼šæ‰€æœ‰ state channelï¼ˆä½ çš„ TypedDict çŠ¶æ€ï¼‰åœ¨è¯¥ç‚¹çš„å€¼</li>
<li><code>next</code>ï¼šæ¥ä¸‹æ¥åº”è¯¥æ‰§è¡Œå“ªäº›èŠ‚ç‚¹ (node åç§°)</li>
<li><code>tasks</code>ï¼šå¦‚æœæœ‰ä»»åŠ¡ (task, PregelTask)ï¼Œä¹Ÿä¼šè®°å½•ï¼›è‹¥ä¹‹å‰å¤±è´¥æˆ–ä¸­æ–­ï¼Œè¿˜ä¼šåæ˜ é”™è¯¯ / ä¸­æ–­ä¿¡æ¯</li>
</ul>
</li>
<li>
<p>è¿™äº› checkpoint æ˜¯æŒä¹…åŒ–çš„ï¼Œå› æ­¤ä½ å¯ä»¥ <strong>æ¢å¤ (restore)</strong> æˆ– <strong>å›æ”¾ (replay)</strong>ã€‚</p>
</li>
<li>
<p>ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾æœ‰ä¸€ä¸ªç®€å•çš„å›¾ï¼Œå®ƒæ‰§è¡Œäº†ä¸¤ä¸ªèŠ‚ç‚¹ <code>node_a</code> å’Œ <code>node_b</code>ï¼ŒæŒ‰ super-step ä¿å­˜äº† 4 æ¬¡ checkpoint:</p>
<ol>
<li>åˆå§‹ (start)</li>
<li>æ‰§è¡Œå‰ç”¨æˆ·è¾“å…¥</li>
<li>æ‰§è¡Œ <code>node_a</code> å</li>
<li>æ‰§è¡Œ <code>node_b</code> åï¼Œæœ€ç»ˆ stateã€‚</li>
</ol>
</li>
</ul>
<hr/>
<h3 data-id="heading-4">3. è·å–çŠ¶æ€ (Get State)</h3>
<ul>
<li>
<p>å¯ä»¥é€šè¿‡ <code>graph.get_state(config)</code> è·å–æœ€è¿‘ (æˆ–æŒ‡å®š checkpoint) çš„çŠ¶æ€å¿«ç…§ï¼š</p>
<pre><code class="hljs language-python" lang="python">snapshot = graph.get_state({<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"1"</span>}})
</code></pre>
<p>è¿”å›ä¸€ä¸ª <code>StateSnapshot</code> å¯¹è±¡ï¼Œé‡Œé¢æœ‰ <code>values</code>ã€<code>metadata</code>ã€<code>next</code> ç­‰ã€‚</p>
</li>
<li>
<p>å¦‚æœä½ æƒ³è®¿é—®å†å²çŠ¶æ€ (æ‰€æœ‰ checkpoint å†å²)ï¼Œå¯ä»¥è°ƒç”¨ <code>graph.get_state_history(config)</code>ï¼š</p>
<pre><code class="hljs language-python" lang="python">history = <span class="hljs-built_in">list</span>(graph.get_state_history({<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"1"</span>}}))
</code></pre>
<p>è¿”å›ä¸€ä¸ª <code>StateSnapshot</code> åˆ—è¡¨ (æŒ‰æ—¶é—´é¡ºåº)ï¼Œæœ€æ–°çš„ checkpoint é€šå¸¸ä½äºåˆ—è¡¨å¼€å¤´ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-5">4. æ—¶é—´æ—…è¡Œ / å›æ”¾ (Replay)</h3>
<ul>
<li>
<p>LangGraph æ”¯æŒ <strong>æ—¶é—´æ—…è¡Œ (time travel)</strong>ï¼šä½ å¯ä»¥åœ¨è°ƒç”¨å›¾çš„æ—¶å€™æŒ‡å®š <code>checkpoint_id</code>ï¼Œä»å†å²æŸä¸ªæ£€æŸ¥ç‚¹ç»§ç»­æ‰§è¡Œã€‚</p>
</li>
<li>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-python" lang="python">config = {
    <span class="hljs-string">"configurable"</span>: {
        <span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"1"</span>,
        <span class="hljs-string">"checkpoint_id"</span>: <span class="hljs-string">"some-checkpoint-uuid"</span>
    }
}
graph.invoke(<span class="hljs-built_in">input</span>, config)
</code></pre>
</li>
<li>
<p>å½“ä½ ä»æŸä¸ª checkpoint æ¢å¤æ—¶ï¼š</p>
<ul>
<li><strong>Checkpoint ä¹‹å‰å·²ç»æ‰§è¡Œçš„èŠ‚ç‚¹</strong> ä¼šè¢« â€œå›æ”¾ (replay)â€ â€” è¿™éƒ¨åˆ†ä¸ä¼šé‡æ–°æ‰§è¡Œï¼Œåªæ˜¯æ¢å¤çŠ¶æ€ã€‚</li>
<li><strong>Checkpoint ä¹‹åçš„æ–°èŠ‚ç‚¹</strong> ä¼šæ ¹æ®å½“å‰å›¾èµ°æ–°çš„è·¯å¾„ (å¯èƒ½æ˜¯æ–°çš„åˆ†æ”¯) â€” ç›¸å½“äº â€œä»è¯¥å†å²ç‚¹åˆ†å‰ (fork)â€ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-6">5. æ›´æ–°çŠ¶æ€ (Update State)</h3>
<ul>
<li>
<p>é™¤äº†é€šè¿‡èŠ‚ç‚¹æ‰§è¡Œ (node) æ›´æ–°çŠ¶æ€ï¼Œä½ è¿˜å¯ä»¥ <strong>æ‰‹åŠ¨æ›´æ–°çŠ¶æ€</strong>ï¼šä½¿ç”¨ <code>graph.update_state(config, values)</code>ã€‚</p>
</li>
<li>
<p>é‡è¦ï¼šå¦‚æœä½ çš„çŠ¶æ€é€šé“ (state å­—æ®µ) æœ‰å®šä¹‰ â€œreducer (åˆå¹¶ç­–ç•¥)â€ï¼Œupdate_state ä¼šéµå¾ªè¿™äº› reducerï¼Œè€Œä¸æ˜¯ç®€å•è¦†ç›–ã€‚</p>
</li>
<li>
<p>æ¯”å¦‚åœ¨æ–‡æ¡£çš„ä¾‹å­ä¸­ï¼š</p>
<ul>
<li><code>foo</code> æ²¡æœ‰ reducer â†’ <code>update_state</code> ä¼šè¦†ç›–å®ƒ</li>
<li><code>bar</code> ä½¿ç”¨ <code>add</code> ä½œä¸º reducer â†’ <code>update_state({"bar": ["b"]})</code> ä¼šæŠŠ <code>"b"</code> åŠ åˆ°å·²æœ‰çš„ <code>bar</code> åˆ—è¡¨ä¸­ (è€Œä¸æ˜¯æ›¿æ¢)</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€æ›´å¤šå¼ºå¤§èƒ½åŠ› (Capabilities)</h2>
<p>é€šè¿‡ checkpoint æœºåˆ¶ï¼ŒLangGraph è§£é”ä»¥ä¸‹é«˜çº§åŠŸèƒ½ï¼š</p>
<ol>
<li>
<p><strong>äººæœºåä½œ (Human-in-the-Loop)</strong></p>
<ul>
<li>ç”±äºçŠ¶æ€è¢«æŒä¹…åŒ–ä¸º checkpointï¼Œäººç±»å¯ä»¥ä¸­æ–­ (interrupt)ã€å®¡æŸ¥ (inspect)ã€ç¼–è¾‘ï¼Œç„¶åæ¢å¤æ‰§è¡Œã€‚</li>
</ul>
</li>
<li>
<p><strong>è®°å¿† (Memory)</strong></p>
<ul>
<li>å¯¹è¯ã€æ™ºèƒ½ä½“ä½¿ç”¨åœºæ™¯ä¸­ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹ (thread) ä¼šä¿å­˜æ‰€æœ‰çŠ¶æ€ï¼Œèƒ½å¤Ÿè·¨å¤šè½®å¯¹è¯æŒç»­è®°å¿†ã€‚</li>
<li>å¦‚æœéœ€è¦è·¨çº¿ç¨‹å…±äº«è®°å¿† (æ¯”å¦‚ç”¨æˆ·é•¿æœŸèµ„æ–™)ï¼Œå¯ä»¥ç»“åˆ <code>Store</code> æ¥å£ (memory store) ä½¿ç”¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ—¶é—´æ—…è¡Œ (Time Travel)</strong></p>
<ul>
<li>å¯ä»¥å›åˆ°ä¹‹å‰æŸä¸ª checkpointï¼Œæ£€æŸ¥å†å²çŠ¶æ€ã€é‡æ”¾ã€å¯¹æ¯”ã€debugã€‚</li>
<li>è¿˜å¯ä»¥ â€œfork (åˆ†æ”¯)â€ â€” ä»æŸä¸ªå†å²ç‚¹åšæ–°çš„å°è¯•ã€‚</li>
</ul>
</li>
<li>
<p><strong>å®¹é”™ (Fault-tolerance)</strong></p>
<ul>
<li>å¦‚æœæŸä¸€æ­¥å¤±è´¥ (super-step ä¸­æŸäº›èŠ‚ç‚¹æŠ¥é”™)ï¼Œå¯ä»¥ä»æœ€è¿‘çš„æˆåŠŸ checkpoint æ¢å¤ï¼Œä¸éœ€è¦ä»å¤´å†æ¥ã€‚</li>
<li>å¦‚æœä¸€ä¸ª super-step å†…æœ‰å¤šä¸ªèŠ‚ç‚¹ï¼Œæœ‰äº›èŠ‚ç‚¹å®Œæˆï¼Œæœ‰äº›å¤±è´¥ï¼ŒLangGraph ä¼šè®°å½• â€œpending writesâ€ (å°šæœªæˆåŠŸå†™å…¥) çš„å†…å®¹ï¼Œè¿™æ ·åœ¨æ¢å¤æ—¶ä¸ä¼šé‡å¤æ‰§è¡Œå·²ç»æˆåŠŸçš„èŠ‚ç‚¹ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-8">å››ã€æŒä¹…åŒ–å®ç°ç»†èŠ‚ (Checkpointer ä¸ åºåˆ—åŒ–)</h2>
<ul>
<li>
<p>LangGraph çš„ checkpointer æ˜¯ä¸€ä¸ªæŠ½è±¡æ¥å£ (<code>BaseCheckpointSaver</code>)ã€‚</p>
</li>
<li>
<p>LangGraph æä¾›äº†å¤šç§å®ç°ï¼š</p>
<ul>
<li><strong>InMemorySaver</strong>ï¼šå†…å­˜ä¿å­˜ (é€‚åˆå®éªŒ /è°ƒè¯•)</li>
<li><strong>SQLite Saver</strong> (<code>SqliteSaver</code>)ï¼šä½¿ç”¨ SQLite å­˜å‚¨ (æœ¬åœ°ç®€å•æŒä¹…åŒ–)</li>
<li><strong>Postgres Saver</strong> (<code>PostgresSaver</code>)ï¼šä½¿ç”¨ Postgres æ•°æ®åº“ (é€‚åˆç”Ÿäº§)</li>
</ul>
</li>
<li>
<p><strong>åºåˆ—åŒ– (Serializer)</strong>ï¼šcheckpointer ä¿å­˜çŠ¶æ€æ—¶ï¼Œéœ€è¦æŠŠçŠ¶æ€ (state channels) åºåˆ—åŒ–æˆå¯å­˜å‚¨/æ¢å¤çš„æ ¼å¼ã€‚LangGraph ä½¿ç”¨ <code>SerializerProtocol</code>ï¼Œé»˜è®¤æ˜¯ <code>JsonPlusSerializer</code>ã€‚</p>
<ul>
<li><code>JsonPlusSerializer</code> æ”¯æŒå¤šç§ç±»å‹ (æ—¥æœŸã€æšä¸¾ã€LLM ç±»å‹ç­‰)ã€‚</li>
<li>å¦‚æœæœ‰æ›´å¤æ‚å¯¹è±¡ (å¦‚ Pandas DataFrame)ï¼Œå¯ä»¥å¼€å¯ <code>pickle_fallback=True</code> â†’ å›é€€åˆ° pickle åºåˆ—åŒ–ã€‚</li>
</ul>
</li>
<li>
<p><strong>åŠ å¯† (Encryption)</strong>ï¼šå¦‚æœä½ å¯¹æŒä¹…åŒ–æ•°æ®å®‰å…¨æ•æ„Ÿ (ä¾‹å¦‚å¯¹è¯å†…å®¹)ï¼Œå¯ä»¥ä½¿ç”¨åŠ å¯† Serializerã€‚LangGraph æ”¯æŒ <code>EncryptedSerializer</code> (ä¾‹å¦‚ AES åŠ å¯†)ï¼Œå¹¶ä¸”ä¸ Postgres / SQLite Saver ç»„åˆã€‚</p>
<ul>
<li><code>EncryptedSerializer.from_pycryptodome_aes()</code> å¯ä»¥ä»ç¯å¢ƒå˜é‡ <code>LANGGRAPH_AES_KEY</code> è¯»å–å¯†é’¥ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-9">äº”ã€ä½¿ç”¨ç¤ºä¾‹</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ checkpointer å®ç°æŒä¹…åŒ–ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> StateGraph, START, END
<span class="hljs-keyword">from</span> langgraph.checkpoint.memory <span class="hljs-keyword">import</span> InMemorySaver
<span class="hljs-keyword">from</span> typing_extensions <span class="hljs-keyword">import</span> TypedDict
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> Annotated
<span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> add

<span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    foo: <span class="hljs-built_in">str</span>
    bar: Annotated[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>], add]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_a</span>(<span class="hljs-params">state: State</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"foo"</span>: <span class="hljs-string">"a"</span>, <span class="hljs-string">"bar"</span>: [<span class="hljs-string">"a"</span>]}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_b</span>(<span class="hljs-params">state: State</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"foo"</span>: <span class="hljs-string">"b"</span>, <span class="hljs-string">"bar"</span>: [<span class="hljs-string">"b"</span>]}

<span class="hljs-comment"># å®šä¹‰å›¾</span>
workflow = StateGraph(State)
workflow.add_node(node_a)
workflow.add_node(node_b)
workflow.add_edge(START, <span class="hljs-string">"node_a"</span>)
workflow.add_edge(<span class="hljs-string">"node_a"</span>, <span class="hljs-string">"node_b"</span>)
workflow.add_edge(<span class="hljs-string">"node_b"</span>, END)

<span class="hljs-comment"># ä½¿ç”¨ InMemorySaver ä½œä¸ºæ£€æŸ¥ç‚¹å­˜å‚¨å™¨</span>
checkpointer = InMemorySaver()

<span class="hljs-comment"># ç¼–è¯‘å›¾ï¼Œä¼ å…¥ checkpointer</span>
graph = workflow.<span class="hljs-built_in">compile</span>(checkpointer=checkpointer)

<span class="hljs-comment"># æ‰§è¡Œå›¾ (run)ï¼ŒæŒ‡å®š thread_id</span>
config = {<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"thread-1"</span>}}
graph.invoke({<span class="hljs-string">"foo"</span>: <span class="hljs-string">""</span>}, config)

<span class="hljs-comment"># è·å–æœ€æ–°çŠ¶æ€</span>
snapshot = graph.get_state(config)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Current state:"</span>, snapshot.values)

<span class="hljs-comment"># æŸ¥çœ‹å†å² checkpoint</span>
history = <span class="hljs-built_in">list</span>(graph.get_state_history(config))
<span class="hljs-keyword">for</span> idx, snap <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(history):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Checkpoint <span class="hljs-subst">{idx}</span>: <span class="hljs-subst">{snap.values}</span>"</span>)
</code></pre>
<p>è¾“å‡ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b3bfd4920f34abfaef13bff2afc0968~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUxMSU5BSQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039022&amp;x-signature=cAJAgTtLHIS1R0uQY%2B5m2wBE%2F1A%3D" alt="2025-11-18 10 43 03.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-10">å…­ã€å®ç”¨å»ºè®® &amp; åœºæ™¯</h2>
<ul>
<li><strong>å¯¹è¯åº”ç”¨ (Chatbot)</strong>ï¼šä½¿ç”¨æŒä¹…åŒ– + thread_id ä½ å¯ä»¥è®©å¯¹è¯å…·æœ‰å†…å­˜ (è®°ä½ä¹‹å‰å¯¹è¯å†…å®¹)ï¼Œéå¸¸é€‚åˆå®¢æœæœºå™¨äººã€æ™ºèƒ½åŠ©ç†ã€‚</li>
<li><strong>é•¿æµç¨‹å·¥ä½œæµ</strong>ï¼šé•¿ä»»åŠ¡ (multi-step) å¯èƒ½ä¸­æ–­ (fail) æˆ–æ‰‹åŠ¨å¹²é¢„ (human-in-loop)ï¼ŒæŒä¹…åŒ–ç¡®ä¿ä½ å¯ä»¥æ¢å¤æ‰§è¡Œã€‚</li>
<li><strong>è°ƒè¯• / å›æ”¾</strong>ï¼šæ—¶é—´æ—…è¡Œ (time-travel) èƒ½è®©ä½ æ£€æŸ¥æ¯ä¸€æ­¥çŠ¶æ€ï¼Œéå¸¸æœ‰åŠ©äºè°ƒè¯•å¤æ‚å›¾ã€‚</li>
<li><strong>ç”Ÿäº§éƒ¨ç½²</strong>ï¼šé€‰æ‹© SQLite / Postgres Saver å®ç°æŒä¹…åŒ–ï¼Œç»“åˆåŠ å¯† Serializerï¼Œä¿è¯æ•°æ®å®‰å…¨ä¸æ€§èƒ½ã€‚</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼šå¦‚æœä½ åªæƒ³ä¿ç•™æœ€è¿‘å‡ æ¬¡ checkpointï¼Œå¯ä»¥ç»“åˆåº”ç”¨é€»è¾‘æ¸…ç†æ—§ checkpoint (æˆ–ä½¿ç”¨å®šåˆ¶ Saver)ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-11">ä¸ƒã€å°ç»“</h2>
<p>LangGraph çš„æŒä¹…åŒ–é€šè¿‡ <strong>checkpointer + thread + checkpoint</strong> ä¸‰å±‚è®¾è®¡å®ç°ï¼š</p>
<ul>
<li><strong>checkpointer</strong> è´Ÿè´£å†™å…¥ checkpoint</li>
<li><strong>çº¿ç¨‹ (thread)</strong> æŠŠä¸€ç³»åˆ— checkpoint ç»„ç»‡èµ·æ¥</li>
<li><strong>checkpoint</strong> æ˜¯æŸä¸€æ—¶åˆ»çš„çŠ¶æ€å¿«ç…§ (StateSnapshot)ï¼ŒåŒ…æ‹¬ state å€¼ã€ä¸‹ä¸€æ­¥ä»»åŠ¡ã€å…ƒæ•°æ®ç­‰</li>
</ul>
<p>è¿™ä¸€æœºåˆ¶è®©å›¾ (graph) æ‹¥æœ‰ï¼š</p>
<ul>
<li><strong>è®°å¿† (memory)</strong></li>
<li><strong>äººæœºåä½œ</strong></li>
<li><strong>æ—¶é—´æ—…è¡Œ (å›æ”¾ / fork)</strong></li>
<li><strong>å®¹é”™æ¢å¤</strong></li>
</ul>
<p>é€šè¿‡é€‰æ‹©ä¸åŒç±»å‹çš„ saver (å†…å­˜ã€SQLiteã€Postgres)ï¼Œç»“åˆåˆé€‚çš„åºåˆ—åŒ–å’ŒåŠ å¯†ç­–ç•¥ï¼Œä½ å¯ä»¥æ„å»ºæ—¢çµæ´»åˆå¯é çš„æŒä¹…åŒ– LLM åº”ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[fastapiçš„æœ€æ–°ç‰ˆæœ¬ï¼Œæä¾›äº†å“ªäº›æ–°apiå¯ä¾›ä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7573593395797835822</link>    <guid>https://juejin.cn/post/7573593395797835822</guid>    <pubDate>2025-11-18T02:28:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573593395797835822" data-draft-id="7573595009552498698" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="fastapiçš„æœ€æ–°ç‰ˆæœ¬ï¼Œæä¾›äº†å“ªäº›æ–°apiå¯ä¾›ä½¿ç”¨"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,GitHub"/> <meta itemprop="datePublished" content="2025-11-18T02:28:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å°jobleap"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147692910"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            fastapiçš„æœ€æ–°ç‰ˆæœ¬ï¼Œæä¾›äº†å“ªäº›æ–°apiå¯ä¾›ä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147692910/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å°jobleap
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:28:49.000Z" title="Tue Nov 18 2025 02:28:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯jobleap.cnçš„å°ä¹ï¼Œä»Šå¤©å­¦ä¹ FastAPIçš„ä½¿ç”¨ã€‚</p>
<p>FastAPI æˆªè‡³2025å¹´çš„æœ€æ–°ç¨³å®šç‰ˆæœ¬ä¸º <strong>0.110.0</strong>ï¼Œè¯¥ç‰ˆæœ¬åœ¨ä¾èµ–ç®¡ç†ã€WebSocketå¢å¼ºã€å“åº”æ¨¡å‹çµæ´»æ€§ç­‰æ–¹é¢å¼•å…¥äº†å¤šä¸ªå®ç”¨æ–°ç‰¹æ€§ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒæ–°APIåŠå…·ä½“ä»£ç ç¤ºä¾‹ï¼š</p>
<h3 data-id="heading-0">1. å…¨å±€ä¾èµ–ç®€åŒ–å®šä¹‰ï¼š<code>@app.dependency</code> è£…é¥°å™¨</h3>
<p><strong>åŠŸèƒ½</strong>ï¼šæ›¿ä»£ä¼ ç»Ÿçš„ <code>app.dependencies.append(Depends(...))</code>ï¼Œæ›´ç›´è§‚åœ°å®šä¹‰å…¨å±€ä¾èµ–ï¼ˆæ‰€æœ‰è·¯å¾„æ“ä½œéƒ½ä¼šè‡ªåŠ¨è°ƒç”¨ï¼‰ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, Depends
<span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> Session
<span class="hljs-keyword">from</span> .database <span class="hljs-keyword">import</span> SessionLocal, get_db  <span class="hljs-comment"># å‡è®¾çš„æ•°æ®åº“ä¼šè¯å·¥å…·</span>

app = FastAPI()

<span class="hljs-comment"># æ–°è¯­æ³•ï¼šå®šä¹‰å…¨å±€ä¾èµ–ï¼ˆæ›¿ä»£ app.dependencies.append(Depends(get_db))ï¼‰</span>
<span class="hljs-meta">@app.dependency</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">global_db</span>() -&gt; Session:
    db = SessionLocal()
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">yield</span> db
    <span class="hljs-keyword">finally</span>:
        db.close()

<span class="hljs-comment"># æ‰€æœ‰è·¯å¾„æ“ä½œä¼šè‡ªåŠ¨è·å– db ä¾èµ–</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/items"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">read_items</span>(<span class="hljs-params">db: Session = Depends(<span class="hljs-params">global_db</span>)</span>):  <span class="hljs-comment"># å¯ç›´æ¥ä½¿ç”¨å…¨å±€ä¾èµ–</span>
    <span class="hljs-keyword">return</span> db.query(Item).<span class="hljs-built_in">all</span>()  <span class="hljs-comment"># å‡è®¾ Item æ˜¯æ•°æ®åº“æ¨¡å‹</span>
</code></pre>
<h3 data-id="heading-1">2. WebSocket è®¤è¯è£…é¥°å™¨ï¼š<code>@app.websocket_auth</code></h3>
<p><strong>åŠŸèƒ½</strong>ï¼šä¸º WebSocket è¿æ¥æ·»åŠ ç»Ÿä¸€è®¤è¯é€»è¾‘ï¼Œæ›¿ä»£æ‰‹åŠ¨åœ¨ç«¯ç‚¹å†…å†™è®¤è¯ä»£ç ï¼Œç®€åŒ–æƒé™æ ¡éªŒã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, WebSocket, Depends
<span class="hljs-keyword">from</span> fastapi.security <span class="hljs-keyword">import</span> OAuth2PasswordBearer

app = FastAPI()
oauth2_scheme = OAuth2PasswordBearer(tokenUrl=<span class="hljs-string">"token"</span>)

<span class="hljs-comment"># è®¤è¯é€»è¾‘ï¼šéªŒè¯ token å¹¶è¿”å›ç”¨æˆ·</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_current_user</span>(<span class="hljs-params">token: <span class="hljs-built_in">str</span> = Depends(<span class="hljs-params">oauth2_scheme</span>)</span>):
    <span class="hljs-keyword">if</span> token != <span class="hljs-string">"secret"</span>:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">401</span>, detail=<span class="hljs-string">"æ— æ•ˆ token"</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"username"</span>: <span class="hljs-string">"admin"</span>}

<span class="hljs-comment"># æ–°è£…é¥°å™¨ï¼šä¸º WebSocket ç»‘å®šè®¤è¯ä¾èµ–</span>
<span class="hljs-meta">@app.websocket(<span class="hljs-params"><span class="hljs-string">"/ws"</span></span>)</span>
<span class="hljs-meta">@app.websocket_auth(<span class="hljs-params">Depends(<span class="hljs-params">get_current_user</span>)</span>)  </span><span class="hljs-comment"># è‡ªåŠ¨æ‰§è¡Œè®¤è¯</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">websocket_endpoint</span>(<span class="hljs-params">websocket: WebSocket, user: <span class="hljs-built_in">dict</span></span>):  <span class="hljs-comment"># è®¤è¯åçš„ç”¨æˆ·ä¼šä¼ å…¥</span>
    <span class="hljs-keyword">await</span> websocket.accept()
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        data = <span class="hljs-keyword">await</span> websocket.receive_text()
        <span class="hljs-keyword">await</span> websocket.send_text(<span class="hljs-string">f"å·²è®¤è¯ç”¨æˆ· <span class="hljs-subst">{user[<span class="hljs-string">'username'</span>]}</span> å‘é€ï¼š<span class="hljs-subst">{data}</span>"</span>)
</code></pre>
<h3 data-id="heading-2">3. ä¾èµ–åˆ†ç»„ï¼š<code>Depends(..., group="åˆ†ç»„å")</code></h3>
<p><strong>åŠŸèƒ½</strong>ï¼šå¯¹ä¾èµ–è¿›è¡Œåˆ†ç»„ç®¡ç†ï¼Œæ–¹ä¾¿æ‰¹é‡æ§åˆ¶ä¾èµ–çš„æ‰§è¡Œé¡ºåºæˆ–æ¡ä»¶å¯ç”¨ï¼ˆä¾‹å¦‚â€œè®¤è¯ç›¸å…³ä¾èµ–â€â€œæ—¥å¿—ç›¸å…³ä¾èµ–â€ï¼‰ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, Depends, HTTPException

app = FastAPI()

<span class="hljs-comment"># åˆ†ç»„ä¸º "auth" çš„ä¾èµ–ï¼šéªŒè¯ token</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">validate_token</span>(<span class="hljs-params">token: <span class="hljs-built_in">str</span> = Header(<span class="hljs-params">...</span>)</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">401</span>, detail=<span class="hljs-string">"ç¼ºå°‘ token"</span>)
    <span class="hljs-keyword">return</span> token

<span class="hljs-comment"># åˆ†ç»„ä¸º "auth" çš„ä¾èµ–ï¼šæ£€æŸ¥æƒé™ï¼ˆä¾èµ–äº validate_tokenï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_admin_permission</span>(<span class="hljs-params">token: <span class="hljs-built_in">str</span> = Depends(<span class="hljs-params">validate_token, group=<span class="hljs-string">"auth"</span></span>)</span>):
    <span class="hljs-keyword">if</span> token != <span class="hljs-string">"admin_token"</span>:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">403</span>, detail=<span class="hljs-string">"æ— ç®¡ç†å‘˜æƒé™"</span>)

<span class="hljs-comment"># ä»…æ‰§è¡Œ "auth" åˆ†ç»„çš„ä¾èµ–ï¼ˆè‡ªåŠ¨æŒ‰é¡ºåºæ‰§è¡ŒåŒç»„ä¾èµ–ï¼‰</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/admin"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">admin_operation</span>(<span class="hljs-params">
    _: <span class="hljs-literal">None</span> = Depends(<span class="hljs-params">group=<span class="hljs-string">"auth"</span></span>)  <span class="hljs-comment"># è§¦å‘æ•´ä¸ª "auth" åˆ†ç»„çš„ä¾èµ–</span>
</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"ç®¡ç†å‘˜æ“ä½œæˆåŠŸ"</span>}
</code></pre>
<h3 data-id="heading-3">4. å“åº”æ¨¡å‹åŠ¨æ€æ’é™¤ç©ºå€¼ï¼š<code>response_model_exclude_none</code> å‚æ•°</h3>
<p><strong>åŠŸèƒ½</strong>ï¼šåœ¨è·¯å¾„æ“ä½œä¸­ç›´æ¥æ§åˆ¶å“åº”æ¨¡å‹æ˜¯å¦æ’é™¤ <code>None</code> å€¼ï¼ˆæ— éœ€åœ¨ Pydantic æ¨¡å‹ä¸­å…¨å±€é…ç½®ï¼‰ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>

app = FastAPI()

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Item</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    name: <span class="hljs-built_in">str</span>
    description: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>  <span class="hljs-comment"># å¯é€‰å­—æ®µï¼Œå¯èƒ½ä¸º None</span>

<span class="hljs-comment"># æ–°å‚æ•°ï¼šresponse_model_exclude_none=True ä¼šè‡ªåŠ¨æ’é™¤å€¼ä¸º None çš„å­—æ®µ</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/items/{item_id}"</span>, response_model=Item, response_model_exclude_none=<span class="hljs-literal">True</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_item</span>(<span class="hljs-params">item_id: <span class="hljs-built_in">int</span></span>):
    <span class="hljs-comment"># è¿”å›çš„ description ä¸º Noneï¼Œä½†å“åº”ä¸­ä¼šè‡ªåŠ¨æ’é™¤</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"name"</span>: <span class="hljs-string">"ç”µè„‘"</span>, <span class="hljs-string">"description"</span>: <span class="hljs-literal">None</span>}
</code></pre>
<p><strong>å“åº”ç»“æœ</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ç”µè„‘"</span><span class="hljs-punctuation">}</span>  # æ—  description å­—æ®µ
</code></pre>
<h3 data-id="heading-4">5. åŠ¨æ€æ ‡ç­¾ç”Ÿæˆï¼š<code>tags</code> æ”¯æŒå¯è°ƒç”¨å¯¹è±¡</h3>
<p><strong>åŠŸèƒ½</strong>ï¼š<code>@app.get</code> ç­‰è£…é¥°å™¨çš„ <code>tags</code> å‚æ•°æ”¯æŒä¼ å…¥å‡½æ•°ï¼ŒåŠ¨æ€ç”Ÿæˆæ¥å£æ ‡ç­¾ï¼ˆé€‚ç”¨äºæ‰¹é‡ç®¡ç†æ ‡ç­¾ï¼Œä¾‹å¦‚æŒ‰ç‰ˆæœ¬åˆ†ç»„ï¼‰ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI

app = FastAPI()

<span class="hljs-comment"># åŠ¨æ€ç”Ÿæˆæ ‡ç­¾çš„å‡½æ•°ï¼ˆä¾‹å¦‚æ ¹æ®ç‰ˆæœ¬å·ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_version_tags</span>(<span class="hljs-params">version: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-keyword">return</span> [<span class="hljs-string">f"v<span class="hljs-subst">{version}</span>"</span>]

<span class="hljs-comment"># tags ä¼ å…¥å‡½æ•°ï¼ŒåŠ¨æ€ç”Ÿæˆæ ‡ç­¾</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/v1/items"</span>, tags=get_version_tags(<span class="hljs-params"><span class="hljs-string">"1"</span></span>)</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_v1_items</span>():
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"version"</span>: <span class="hljs-string">"v1"</span>, <span class="hljs-string">"items"</span>: []}

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/v2/items"</span>, tags=get_version_tags(<span class="hljs-params"><span class="hljs-string">"2"</span></span>)</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_v2_items</span>():
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"version"</span>: <span class="hljs-string">"v2"</span>, <span class="hljs-string">"items"</span>: []}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šOpenAPI æ–‡æ¡£ä¸­ï¼Œä¸¤ä¸ªæ¥å£ä¼šåˆ†åˆ«æ˜¾ç¤ºåœ¨ <code>v1</code> å’Œ <code>v2</code> æ ‡ç­¾ä¸‹ã€‚</p>
<p>ä»¥ä¸Šæ–°ç‰¹æ€§å‡å·²åœ¨ FastAPI 0.110.0 ä¸­ç¨³å®šæ”¯æŒï¼Œä¸»è¦è§£å†³äº†ä¾èµ–ç®¡ç†ç¹çã€WebSocket è®¤è¯é‡å¤ç¼–ç ã€å“åº”æ¨¡å‹çµæ´»æ€§ä¸è¶³ç­‰é—®é¢˜ï¼Œè¿›ä¸€æ­¥æå‡äº†å¼€å‘æ•ˆç‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SOLO Coder å®è·µï½œç»™å¼€æºäº‘ç›˜ Cloudreve åŠ ä¸ª AI å¯¹è¯åŠŸèƒ½]]></title>    <link>https://juejin.cn/post/7573592127298240562</link>    <guid>https://juejin.cn/post/7573592127298240562</guid>    <pubDate>2025-11-18T02:56:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573592127298240562" data-draft-id="7573589277004054566" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SOLO Coder å®è·µï½œç»™å¼€æºäº‘ç›˜ Cloudreve åŠ ä¸ª AI å¯¹è¯åŠŸèƒ½"/> <meta itemprop="keywords" content="Trae"/> <meta itemprop="datePublished" content="2025-11-18T02:56:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="TRAE_ai"/> <meta itemprop="url" content="https://juejin.cn/user/3048259110571032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SOLO Coder å®è·µï½œç»™å¼€æºäº‘ç›˜ Cloudreve åŠ ä¸ª AI å¯¹è¯åŠŸèƒ½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3048259110571032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    TRAE_ai
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T02:56:14.000Z" title="Tue Nov 18 2025 02:56:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/749b11d4371d4c8d9db419e6002f45bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=78kZMcKhdgLFxm8MEM9PpzEXJ3Q%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ä½œè€…ä»‹ç»ï¼šåˆ˜æ˜Ÿè¾°ï¼ŒTRAE æŠ€æœ¯ä¸“å®¶</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d535a33641e14520857916eff5bb3bec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=a%2FQJZ%2FQY3mdn6dDP3kPUUCdltb0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0"><strong>é¡¹ç›®èƒŒæ™¯</strong></h2>
<h3 data-id="heading-1"><strong>Cloudreve ç®€ä»‹</strong></h3>
<p><strong>é¡¹ç›®åœ°å€ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcloudreve%2Fcloudreve" target="_blank" title="https://github.com/cloudreve/cloudreve" ref="nofollow noopener noreferrer">github.com/cloudreve/câ€¦</a></p>
<p>Cloudreve æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„<strong>è‡ªæ‰˜ç®¡æ–‡ä»¶ç®¡ç†ä¸åˆ†äº«ç³»ç»Ÿ</strong>ï¼Œæ”¯æŒå°†æ–‡ä»¶å­˜å‚¨åˆ°å¤šç§äº‘æœåŠ¡ï¼ˆå¦‚æœ¬åœ°å­˜å‚¨ã€S3ã€OneDriveã€é˜¿é‡Œäº‘ OSSã€è…¾è®¯ COS ç­‰ï¼‰ã€‚è¯¥é¡¹ç›®æä¾›äº†å®Œæ•´çš„<strong>ç½‘é¡µç‰ˆç½‘ç›˜ä½“éªŒ</strong>ï¼ŒåŒ…æ‹¬æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ã€åœ¨çº¿é¢„è§ˆã€åˆ†äº«é“¾æ¥ã€å¤šç”¨æˆ·ä¸åˆ†ç»„ç®¡ç†ï¼Œä»¥åŠ WebDAV æ¥å…¥ç­‰åŠŸèƒ½ã€‚</p>
<p><strong>é¡¹ç›®äº®ç‚¹åŒ…æ‹¬ï¼š</strong></p>
<ul>
<li>
<p>æ”¯æŒå¤šç§äº‘å­˜å‚¨æœåŠ¡çš„ç»Ÿä¸€ç®¡ç†</p>
</li>
<li>
<p>å‰åç«¯ä¸€ä½“åŒ–çš„è‡ªéƒ¨ç½²æ–¹æ¡ˆï¼ˆGo + React æŠ€æœ¯æ ˆï¼‰</p>
</li>
<li>
<p>æ–‡ä»¶åŠ å¯†ã€å‹ç¼©ã€æ–­ç‚¹ç»­ä¼ ã€åœ¨çº¿é¢„è§ˆç­‰åŠŸèƒ½é½å…¨</p>
</li>
<li>
<p>é€‚ç”¨äºä¸ªäººç½‘ç›˜ã€å›¢é˜Ÿæ–‡ä»¶åä½œã€è½»é‡çº§ç§æœ‰äº‘ç­‰åœºæ™¯</p>
</li>
</ul>
<p><strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong> ğŸŒ©ï¸ Cloudreve æ˜¯ä¸€ä¸ªå¼€æºçš„ã€å¯è‡ªå·±æ­å»ºçš„å¤šäº‘æ–‡ä»¶ç®¡ç†å¹³å°ï¼Œè®©ä½ æ‹¥æœ‰å±äºè‡ªå·±çš„ã€Œç½‘ç›˜ç³»ç»Ÿã€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d08a57f7abc4bb181e0c73b6b3efb62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=F6PKwP4M0c06mO%2F9q6CLcx2ORCI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf5c0109a0db4f279ca542a3a54a5f6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=BFSrSB8pLgq%2BQ%2Bfo%2B2E5%2B9mSf68%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2"><strong>é¡¹ç›®ç†è§£</strong></h2>
<p>é¢å¯¹ä¸€ä¸ªé™Œç”Ÿçš„å¼€æºé¡¹ç›®ï¼Œå¦‚ä½•å¿«é€Ÿä¸Šæ‰‹ï¼Ÿå¯ä»¥ç›´æ¥æŠŠé—®é¢˜äº¤ç»™ SOLO Coderï¼Œè®©å®ƒæŠŠå¤æ‚çš„é¡¹ç›®æ‹†è§£ä¸ºå¯ç†è§£çš„æ¨¡å—ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/344587d235224e0d8d7c3987949168bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=llbRSP3KUJJz1nSjzlrcz4tdBD4%3D" alt="" loading="lazy"/></p>
<p>æ ¹æ®ä»»åŠ¡æ‹†è§£ï¼ŒCoder å†™äº† 6 ç¯‡æŠ€æœ¯æŠ¥å‘Šï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c75b056c81fc418bbc9086826b2c89b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=payXeh7PkBbW7lEMBVd2Xm5vd8k%3D" alt="" loading="lazy"/></p>
<p>é¦–å…ˆéœ€è¦ç†è§£é¡¹ç›®çš„å®è§‚ç»“æ„ã€‚Coder ç»˜åˆ¶äº†æ•´ä½“æ¶æ„åˆ†ææ–‡æ¡£ï¼Œæ¶µç›–æŠ€æœ¯æ ˆã€éƒ¨ç½²æ–¹å¼å’Œæ•°æ®æµç¨‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1214c883383a4896b1768bca7f43b310~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=hs1y0GhCbgFkHwU1azRvxixbh3A%3D" alt="" loading="lazy"/></p>
<p>ä»¥ä¸‹æ˜¯æ–‡æ¡£å®Œæ•´å†…å®¹ï¼š</p>
<h3 data-id="heading-3"><strong>01-project-overview.md - é¡¹ç›®æ•´ä½“æ¶æ„æ¦‚è§ˆ</strong></h3>
<ul>
<li>
<p>æŠ€æœ¯æ ˆåˆ†æï¼ˆReact + Go + æ•°æ®åº“ï¼‰</p>
</li>
<li>
<p>éƒ¨ç½²æ¶æ„å›¾å’Œæ•°æ®æµç¨‹</p>
</li>
<li>
<p>æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ä»‹ç»</p>
</li>
</ul>

<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># Cloudreve é¡¹ç›®æ•´ä½“æ¶æ„åˆ†æ</span>

<span class="hljs-section">## é¡¹ç›®æ¦‚è¿°</span>

Cloudreve æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è‡ªæ‰˜ç®¡ç½‘ç›˜ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§å­˜å‚¨åç«¯ï¼Œæä¾›å®Œæ•´çš„æ–‡ä»¶ç®¡ç†ã€åˆ†äº«ã€ç”¨æˆ·ç®¡ç†ç­‰åŠŸèƒ½ã€‚é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ã€‚

<span class="hljs-section">## æŠ€æœ¯æ ˆæ€»è§ˆ</span>

<span class="hljs-section">### å‰ç«¯æŠ€æœ¯æ ˆ</span>
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ¡†æ¶**</span>: React 18 + TypeScript
<span class="hljs-bullet">-</span> <span class="hljs-strong">**UI åº“**</span>: Material-UI (MUI) v6
<span class="hljs-bullet">-</span> <span class="hljs-strong">**çŠ¶æ€ç®¡ç†**</span>: Redux Toolkit
<span class="hljs-bullet">-</span> <span class="hljs-strong">**è·¯ç”±**</span>: React Router v6
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ„å»ºå·¥å…·**</span>: Vite
<span class="hljs-bullet">-</span> <span class="hljs-strong">**HTTP å®¢æˆ·ç«¯**</span>: Axios
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ‹–æ‹½**</span>: React DnD
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å›½é™…åŒ–**</span>: i18next

<span class="hljs-section">### åç«¯æŠ€æœ¯æ ˆ</span>
<span class="hljs-bullet">-</span> <span class="hljs-strong">**è¯­è¨€**</span>: Go 1.23
<span class="hljs-bullet">-</span> <span class="hljs-strong">**Web æ¡†æ¶**</span>: Gin
<span class="hljs-bullet">-</span> <span class="hljs-strong">**ORM**</span>: Ent (Facebook å¼€æºçš„ Go ORM)
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ•°æ®åº“**</span>: æ”¯æŒ MySQLã€PostgreSQLã€SQLite
<span class="hljs-bullet">-</span> <span class="hljs-strong">**è®¤è¯**</span>: JWT + Session
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ–‡ä»¶å­˜å‚¨**</span>: æ”¯æŒæœ¬åœ°ã€é˜¿é‡Œäº‘ OSSã€AWS S3ã€è…¾è®¯äº‘ COS ç­‰
<span class="hljs-bullet">-</span> <span class="hljs-strong">**ä»»åŠ¡é˜Ÿåˆ—**</span>: å†…ç½®ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ

<span class="hljs-section">## é¡¹ç›®ç»“æ„</span>

<span class="hljs-code">```mermaid
graph TB
    subgraph "Cloudreve é¡¹ç›®ç»“æ„"
        A[æ ¹ç›®å½•] --&gt; B[Cloudreve/]
        A --&gt; C[assets/]
        A --&gt; D[.trae/]
        
        B --&gt; B1[main.go - å…¥å£æ–‡ä»¶]
        B --&gt; B2[routers/ - è·¯ç”±å±‚]
        B --&gt; B3[service/ - ä¸šåŠ¡é€»è¾‘å±‚]
        B --&gt; B4[ent/ - æ•°æ®æ¨¡å‹å±‚]
        B --&gt; B5[pkg/ - å·¥å…·åŒ…]
        B --&gt; B6[middleware/ - ä¸­é—´ä»¶]
        B --&gt; B7[inventory/ - åº“å­˜ç®¡ç†]
        B --&gt; B8[application/ - åº”ç”¨é…ç½®]
        
        C --&gt; C1[src/ - å‰ç«¯æºç ]
        C --&gt; C2[assets/ - é™æ€èµ„æº]
        C --&gt; C3[locales/ - å›½é™…åŒ–æ–‡ä»¶]
        
        C1 --&gt; C11[component/ - React ç»„ä»¶]
        C1 --&gt; C12[redux/ - çŠ¶æ€ç®¡ç†]
        C1 --&gt; C13[api/ - API æ¥å£]
        C1 --&gt; C14[router/ - å‰ç«¯è·¯ç”±]
        C1 --&gt; C15[session/ - ä¼šè¯ç®¡ç†]
    end
```</span>

<span class="hljs-section">## æ ¸å¿ƒæ¶æ„è®¾è®¡</span>

<span class="hljs-section">### 1. åˆ†å±‚æ¶æ„</span>

<span class="hljs-code">```mermaid
graph TB
    subgraph "åç«¯åˆ†å±‚æ¶æ„"
        A[è·¯ç”±å±‚ - routers/] --&gt; B[æ§åˆ¶å™¨å±‚ - controllers/]
        B --&gt; C[æœåŠ¡å±‚ - service/]
        C --&gt; D[æ•°æ®è®¿é—®å±‚ - ent/]
        D --&gt; E[æ•°æ®åº“]
        
        F[ä¸­é—´ä»¶å±‚ - middleware/] --&gt; B
        G[å·¥å…·åŒ… - pkg/] --&gt; C
    end
```</span>

<span class="hljs-section">### 2. å‰ç«¯ç»„ä»¶æ¶æ„</span>

<span class="hljs-code">```mermaid
graph TB
    subgraph "å‰ç«¯ç»„ä»¶æ¶æ„"
        A[App.tsx - æ ¹ç»„ä»¶] --&gt; B[Frame/ - æ¡†æ¶ç»„ä»¶]
        A --&gt; C[Pages/ - é¡µé¢ç»„ä»¶]
        
        B --&gt; B1[NavBarFrame - å¯¼èˆªæ¡†æ¶]
        B --&gt; B2[HeadlessFrame - æ— å¤´æ¡†æ¶]
        
        B1 --&gt; B11[TopAppBar - é¡¶éƒ¨æ ]
        B1 --&gt; B12[AppDrawer - ä¾§è¾¹æ ]
        B1 --&gt; B13[AppMain - ä¸»å†…å®¹åŒº]
        
        C --&gt; C1[FileManager/ - æ–‡ä»¶ç®¡ç†å™¨]
        C --&gt; C2[Login/ - ç™»å½•é¡µé¢]
        C --&gt; C3[Admin/ - ç®¡ç†é¡µé¢]
        
        C1 --&gt; C11[Explorer/ - æ–‡ä»¶æµè§ˆå™¨]
        C1 --&gt; C12[Uploader/ - æ–‡ä»¶ä¸Šä¼ å™¨]
        C1 --&gt; C13[Viewers/ - æ–‡ä»¶æŸ¥çœ‹å™¨]
    end
```</span>

<span class="hljs-section">## éƒ¨ç½²æ¶æ„</span>

Cloudreve æ”¯æŒä¸¤ç§éƒ¨ç½²æ¨¡å¼ï¼š

<span class="hljs-section">### 1. å•æœºæ¨¡å¼ (Master Mode)</span>
<span class="hljs-code">```mermaid
graph LR
    A[ç”¨æˆ·] --&gt; B[Nginx/åå‘ä»£ç†]
    B --&gt; C[Cloudreve ä¸»èŠ‚ç‚¹]
    C --&gt; D[æ•°æ®åº“]
    C --&gt; E[æ–‡ä»¶å­˜å‚¨]
```</span>

<span class="hljs-section">### 2. é›†ç¾¤æ¨¡å¼ (Master-Slave Mode)</span>
<span class="hljs-code">```mermaid
graph TB
    A[ç”¨æˆ·] --&gt; B[è´Ÿè½½å‡è¡¡å™¨]
    B --&gt; C[Cloudreve ä¸»èŠ‚ç‚¹]
    B --&gt; D[Cloudreve ä»èŠ‚ç‚¹ 1]
    B --&gt; E[Cloudreve ä»èŠ‚ç‚¹ 2]
    
    C --&gt; F[å…±äº«æ•°æ®åº“]
    D --&gt; G[æœ¬åœ°å­˜å‚¨ 1]
    E --&gt; H[æœ¬åœ°å­˜å‚¨ 2]
    
    C -.-&gt; D
    C -.-&gt; E
```</span>

<span class="hljs-section">## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—</span>

<span class="hljs-section">### 1. ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ</span>
<span class="hljs-bullet">-</span> ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€æƒé™ç®¡ç†
<span class="hljs-bullet">-</span> ç”¨æˆ·ç»„ç®¡ç†
<span class="hljs-bullet">-</span> å­˜å‚¨é…é¢ç®¡ç†
<span class="hljs-bullet">-</span> 2FA åŒå› å­è®¤è¯
<span class="hljs-bullet">-</span> Passkey æ”¯æŒ

<span class="hljs-section">### 2. æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ</span>
<span class="hljs-bullet">-</span> æ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ã€é¢„è§ˆ
<span class="hljs-bullet">-</span> æ–‡ä»¶å¤¹ç®¡ç†
<span class="hljs-bullet">-</span> æ–‡ä»¶åˆ†äº«ï¼ˆå…¬å¼€/ç§å¯†ï¼‰
<span class="hljs-bullet">-</span> æ–‡ä»¶ç‰ˆæœ¬æ§åˆ¶
<span class="hljs-bullet">-</span> æ‰¹é‡æ“ä½œ

<span class="hljs-section">### 3. å­˜å‚¨ç³»ç»Ÿ</span>
<span class="hljs-bullet">-</span> å¤šå­˜å‚¨åç«¯æ”¯æŒ
<span class="hljs-bullet">-</span> å­˜å‚¨ç­–ç•¥ç®¡ç†
<span class="hljs-bullet">-</span> æ–‡ä»¶åŠ å¯†
<span class="hljs-bullet">-</span> ç¼©ç•¥å›¾ç”Ÿæˆ
<span class="hljs-bullet">-</span> åª’ä½“å…ƒæ•°æ®æå–

<span class="hljs-section">### 4. ä»»åŠ¡ç³»ç»Ÿ</span>
<span class="hljs-bullet">-</span> å¼‚æ­¥ä»»åŠ¡å¤„ç†
<span class="hljs-bullet">-</span> ç¦»çº¿ä¸‹è½½
<span class="hljs-bullet">-</span> æ–‡ä»¶å‹ç¼©/è§£å‹
<span class="hljs-bullet">-</span> å®šæ—¶ä»»åŠ¡

<span class="hljs-section">### 5. èŠå¤©ç³»ç»Ÿ (å·²å®ç°)</span>
<span class="hljs-bullet">-</span> OpenRouter API é›†æˆ
<span class="hljs-bullet">-</span> æµå¼å¯¹è¯æ”¯æŒ
<span class="hljs-bullet">-</span> å¤šæ¨¡æ€æ–‡ä»¶å¤„ç†
<span class="hljs-bullet">-</span> æ–‡ä»¶ä¸Šä¸‹æ–‡åˆ†æ

<span class="hljs-section">## æ•°æ®æµæ¶æ„</span>

<span class="hljs-code">```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯ (React)
    participant R as è·¯ç”±å±‚ (Gin)
    participant S as æœåŠ¡å±‚
    participant D as æ•°æ®å±‚ (Ent)
    participant DB as æ•°æ®åº“

    U-&gt;&gt;F: ç”¨æˆ·æ“ä½œ
    F-&gt;&gt;R: HTTP è¯·æ±‚
    R-&gt;&gt;R: ä¸­é—´ä»¶å¤„ç† (è®¤è¯/æˆæƒ)
    R-&gt;&gt;S: è°ƒç”¨ä¸šåŠ¡æœåŠ¡
    S-&gt;&gt;D: æ•°æ®æ“ä½œ
    D-&gt;&gt;DB: SQL æŸ¥è¯¢
    DB--&gt;&gt;D: è¿”å›æ•°æ®
    D--&gt;&gt;S: è¿”å›å®ä½“
    S--&gt;&gt;R: è¿”å›ç»“æœ
    R--&gt;&gt;F: JSON å“åº”
    F--&gt;&gt;U: æ›´æ–°ç•Œé¢
```</span>

<span class="hljs-section">## å…³é”®è®¾è®¡ç‰¹ç‚¹</span>

<span class="hljs-section">### 1. æ¨¡å—åŒ–è®¾è®¡</span>
<span class="hljs-bullet">-</span> å‰åç«¯å®Œå…¨åˆ†ç¦»
<span class="hljs-bullet">-</span> ç»„ä»¶åŒ–å¼€å‘
<span class="hljs-bullet">-</span> æ’ä»¶å¼å­˜å‚¨åç«¯
<span class="hljs-bullet">-</span> ä¸­é—´ä»¶æ¶æ„

<span class="hljs-section">### 2. å¯æ‰©å±•æ€§</span>
<span class="hljs-bullet">-</span> æ”¯æŒé›†ç¾¤éƒ¨ç½²
<span class="hljs-bullet">-</span> æ°´å¹³æ‰©å±•èƒ½åŠ›
<span class="hljs-bullet">-</span> æ’ä»¶ç³»ç»Ÿ
<span class="hljs-bullet">-</span> API ç‰ˆæœ¬ç®¡ç†

<span class="hljs-section">### 3. å®‰å…¨æ€§</span>
<span class="hljs-bullet">-</span> JWT è®¤è¯
<span class="hljs-bullet">-</span> RBAC æƒé™æ§åˆ¶
<span class="hljs-bullet">-</span> æ–‡ä»¶åŠ å¯†
<span class="hljs-bullet">-</span> CSRF ä¿æŠ¤
<span class="hljs-bullet">-</span> è¾“å…¥éªŒè¯

<span class="hljs-section">### 4. æ€§èƒ½ä¼˜åŒ–</span>
<span class="hljs-bullet">-</span> ç¼“å­˜æœºåˆ¶
<span class="hljs-bullet">-</span> å¼‚æ­¥ä»»åŠ¡å¤„ç†
<span class="hljs-bullet">-</span> æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ 
<span class="hljs-bullet">-</span> CDN æ”¯æŒ
<span class="hljs-bullet">-</span> æ•°æ®åº“è¿æ¥æ± 

<span class="hljs-section">## å¼€å‘ç¯å¢ƒè¦æ±‚</span>

<span class="hljs-section">### å‰ç«¯å¼€å‘</span>
<span class="hljs-bullet">-</span> Node.js 18+
<span class="hljs-bullet">-</span> npm æˆ– yarn
<span class="hljs-bullet">-</span> ç°ä»£æµè§ˆå™¨

<span class="hljs-section">### åç«¯å¼€å‘</span>
<span class="hljs-bullet">-</span> Go 1.23+
<span class="hljs-bullet">-</span> æ•°æ®åº“ (MySQL/PostgreSQL/SQLite)
<span class="hljs-bullet">-</span> Redis (å¯é€‰ï¼Œç”¨äºç¼“å­˜)

<span class="hljs-section">## é¡¹ç›®ç‰¹è‰²åŠŸèƒ½</span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**å¤šå­˜å‚¨åç«¯**</span>: æ”¯æŒæœ¬åœ°ã€äº‘å­˜å‚¨ç­‰å¤šç§å­˜å‚¨æ–¹å¼
<span class="hljs-bullet">2.</span> <span class="hljs-strong">**WebDAV æ”¯æŒ**</span>: å¯é€šè¿‡ WebDAV åè®®è®¿é—®æ–‡ä»¶
<span class="hljs-bullet">3.</span> <span class="hljs-strong">**Office åœ¨çº¿ç¼–è¾‘**</span>: é›†æˆ WOPI åè®®æ”¯æŒ Office æ–‡æ¡£åœ¨çº¿ç¼–è¾‘
<span class="hljs-bullet">4.</span> <span class="hljs-strong">**åª’ä½“å¤„ç†**</span>: æ”¯æŒå›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘çš„é¢„è§ˆå’Œå…ƒæ•°æ®æå–
<span class="hljs-bullet">5.</span> <span class="hljs-strong">**ç¦»çº¿ä¸‹è½½**</span>: æ”¯æŒ Aria2 ç¦»çº¿ä¸‹è½½
<span class="hljs-bullet">6.</span> <span class="hljs-strong">**æ–‡ä»¶åˆ†äº«**</span>: çµæ´»çš„æ–‡ä»¶åˆ†äº«æœºåˆ¶
<span class="hljs-bullet">7.</span> <span class="hljs-strong">**AI èŠå¤©**</span>: é›†æˆ OpenRouter API çš„æ™ºèƒ½å¯¹è¯åŠŸèƒ½

<span class="hljs-section">## æ€»ç»“</span>

Cloudreve æ˜¯ä¸€ä¸ªæ¶æ„æ¸…æ™°ã€åŠŸèƒ½å®Œæ•´çš„ç°ä»£åŒ–ç½‘ç›˜ç³»ç»Ÿã€‚å…¶å‰åç«¯åˆ†ç¦»çš„è®¾è®¡ã€æ¨¡å—åŒ–çš„æ¶æ„ã€ä»¥åŠä¸°å¯Œçš„åŠŸèƒ½ç‰¹æ€§ï¼Œä¸ºå¼€å‘è€…æä¾›äº†è‰¯å¥½çš„æ‰©å±•åŸºç¡€ã€‚ç‰¹åˆ«æ˜¯å·²ç»å®ç°çš„èŠå¤©åŠŸèƒ½ï¼Œä¸ºä½ è¦å¼€å‘çš„ä¾§è¾¹æ å¯¹è¯åŠŸèƒ½æä¾›äº†å¾ˆå¥½çš„å‚è€ƒå’ŒåŸºç¡€ã€‚

ä¸‹ä¸€æ­¥å»ºè®®æ·±å…¥äº†è§£å‰ç«¯ç»„ä»¶æ¶æ„å’Œåç«¯æœåŠ¡å±‚çš„å…·ä½“å®ç°ï¼Œè¿™å°†æœ‰åŠ©äºä½ æ›´å¥½åœ°ç†è§£å¦‚ä½•åœ¨ç°æœ‰æ¶æ„åŸºç¡€ä¸Šæ·»åŠ æ–°åŠŸèƒ½ã€‚
</code></pre>
<h3 data-id="heading-4"><strong>02-frontend-architecture.md - å‰ç«¯æ¶æ„è¯¦è§£</strong></h3>
<ul>
<li>
<p>React + TypeScript + Material-UI æŠ€æœ¯æ ˆ</p>
</li>
<li>
<p>ç»„ä»¶å±‚æ¬¡ç»“æ„å’ŒçŠ¶æ€ç®¡ç†</p>
</li>
<li>
<p>è·¯ç”±ç³»ç»Ÿå’Œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥</p>
</li>
</ul>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Cloudreve å‰ç«¯æ¶æ„å­¦ä¹ æŒ‡å—</span>

<span class="hljs-comment">## å‰ç«¯æŠ€æœ¯æ ˆè¯¦è§£</span>

<span class="hljs-comment">### æ ¸å¿ƒæŠ€æœ¯æ ˆ</span>
- **React 18**: ä½¿ç”¨æœ€æ–°çš„ React ç‰¹æ€§ï¼ŒåŒ…æ‹¬ Hooksã€Suspenseã€Concurrent Features
- **TypeScript**: æä¾›ç±»å‹å®‰å…¨å’Œæ›´å¥½çš„å¼€å‘ä½“éªŒ
- **Material-UI (MUI) v6**: Google Material Design è®¾è®¡è¯­è¨€çš„ React å®ç°
- **Redux Toolkit**: ç°ä»£åŒ–çš„ Redux çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆ
- **React Router v6**: å£°æ˜å¼è·¯ç”±ç®¡ç†
- **Vite**: å¿«é€Ÿçš„æ„å»ºå·¥å…·å’Œå¼€å‘æœåŠ¡å™¨

<span class="hljs-comment">### å¼€å‘å·¥å…·é“¾</span>
- **ESLint**: ä»£ç è´¨é‡æ£€æŸ¥
- **Prettier**: ä»£ç æ ¼å¼åŒ–
- **Husky**: Git hooks ç®¡ç†
- **TypeScript**: é™æ€ç±»å‹æ£€æŸ¥

<span class="hljs-comment">## é¡¹ç›®ç»“æ„è¯¦è§£</span>

```
assets/src/
â”œâ”€â”€ component/           <span class="hljs-comment"># React ç»„ä»¶</span>
â”‚   â”œâ”€â”€ Common/         <span class="hljs-comment"># é€šç”¨ç»„ä»¶</span>
â”‚   â”œâ”€â”€ Frame/          <span class="hljs-comment"># æ¡†æ¶ç»„ä»¶</span>
â”‚   â”œâ”€â”€ FileManager/    <span class="hljs-comment"># æ–‡ä»¶ç®¡ç†å™¨ç»„ä»¶</span>
â”‚   â”œâ”€â”€ Pages/          <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
â”‚   â”œâ”€â”€ Admin/          <span class="hljs-comment"># ç®¡ç†åå°ç»„ä»¶</span>
â”‚   â”œâ”€â”€ Viewers/        <span class="hljs-comment"># æ–‡ä»¶æŸ¥çœ‹å™¨ç»„ä»¶</span>
â”‚   â”œâ”€â”€ Uploader/       <span class="hljs-comment"># æ–‡ä»¶ä¸Šä¼ ç»„ä»¶</span>
â”‚   â”œâ”€â”€ Icons/          <span class="hljs-comment"># å›¾æ ‡ç»„ä»¶</span>
â”‚   â””â”€â”€ Dialogs/        <span class="hljs-comment"># å¯¹è¯æ¡†ç»„ä»¶</span>
â”œâ”€â”€ redux/              <span class="hljs-comment"># çŠ¶æ€ç®¡ç†</span>
â”‚   â”œâ”€â”€ hooks.ts        <span class="hljs-comment"># Redux hooks</span>
â”‚   â”œâ”€â”€ store.ts        <span class="hljs-comment"># Store é…ç½®</span>
â”‚   â””â”€â”€ slices/         <span class="hljs-comment"># Redux slices</span>
â”œâ”€â”€ api/                <span class="hljs-comment"># API æ¥å£</span>
â”‚   â”œâ”€â”€ api.ts          <span class="hljs-comment"># API å‡½æ•°</span>
â”‚   â”œâ”€â”€ request.ts      <span class="hljs-comment"># è¯·æ±‚å°è£…</span>
â”‚   â””â”€â”€ types.ts        <span class="hljs-comment"># ç±»å‹å®šä¹‰</span>
â”œâ”€â”€ router/             <span class="hljs-comment"># è·¯ç”±é…ç½®</span>
â”œâ”€â”€ session/            <span class="hljs-comment"># ä¼šè¯ç®¡ç†</span>
â”œâ”€â”€ util/               <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
â””â”€â”€ App.tsx             <span class="hljs-comment"># æ ¹ç»„ä»¶</span>
```

<span class="hljs-comment">## ç»„ä»¶æ¶æ„è®¾è®¡</span>

<span class="hljs-comment">### 1. æ¡†æ¶ç»„ä»¶å±‚æ¬¡ç»“æ„</span>

```mermaid
graph TB
    subgraph "æ¡†æ¶ç»„ä»¶æ¶æ„"
        A<span class="hljs-section">[App.tsx]</span> --&gt; B<span class="hljs-section">[NavBarFrame]</span>
        A --&gt; C<span class="hljs-section">[HeadlessFrame]</span>
        
        B --&gt; D<span class="hljs-section">[TopAppBar]</span>
        B --&gt; E<span class="hljs-section">[AppDrawer]</span>
        B --&gt; F<span class="hljs-section">[AppMain]</span>
        
        D --&gt; D1<span class="hljs-section">[UserAction]</span>
        D --&gt; D2<span class="hljs-section">[SearchBar]</span>
        D --&gt; D3<span class="hljs-section">[NavBarMainActions]</span>
        
        E --&gt; E1<span class="hljs-section">[SideNavItem]</span>
        E --&gt; E2<span class="hljs-section">[StorageSummary]</span>
        E --&gt; E3<span class="hljs-section">[PageNavigation]</span>
        
        F --&gt; F1<span class="hljs-section">[FileManager]</span>
        F --&gt; F2<span class="hljs-section">[Pages]</span>
        F --&gt; F3<span class="hljs-section">[Admin]</span>
    end
```

<span class="hljs-comment">### 2. æ–‡ä»¶ç®¡ç†å™¨ç»„ä»¶ç»“æ„</span>

```mermaid
graph TB
    subgraph "æ–‡ä»¶ç®¡ç†å™¨ç»„ä»¶"
        A<span class="hljs-section">[FileManager]</span> --&gt; B<span class="hljs-section">[TopBar]</span>
        A --&gt; C<span class="hljs-section">[Explorer]</span>
        A --&gt; D<span class="hljs-section">[Uploader]</span>
        A --&gt; E<span class="hljs-section">[Viewers]</span>
        A --&gt; F<span class="hljs-section">[Dialogs]</span>
        
        B --&gt; B1<span class="hljs-section">[Breadcrumb]</span>
        B --&gt; B2<span class="hljs-section">[TopActions]</span>
        B --&gt; B3<span class="hljs-section">[ViewOptions]</span>
        
        C --&gt; C1<span class="hljs-section">[FileList]</span>
        C --&gt; C2<span class="hljs-section">[ContextMenu]</span>
        C --&gt; C3<span class="hljs-section">[DragDrop]</span>
        
        D --&gt; D1<span class="hljs-section">[UploadQueue]</span>
        D --&gt; D2<span class="hljs-section">[ProgressBar]</span>
        
        E --&gt; E1<span class="hljs-section">[ImageViewer]</span>
        E --&gt; E2<span class="hljs-section">[VideoPlayer]</span>
        E --&gt; E3<span class="hljs-section">[DocumentViewer]</span>
        
        F --&gt; F1<span class="hljs-section">[CreateNew]</span>
        F --&gt; F2<span class="hljs-section">[ShareDialog]</span>
        F --&gt; F3<span class="hljs-section">[DeleteConfirm]</span>
    end
```

<span class="hljs-comment">## çŠ¶æ€ç®¡ç†æ¶æ„</span>

<span class="hljs-comment">### Redux Store ç»“æ„</span>

```typescript
// store.ts æ ¸å¿ƒé…ç½®
export const <span class="hljs-attr">store</span> = configureStore({
  reducer: {
    // å…¨å±€çŠ¶æ€
    globalState: globalStateSlice.reducer,
    // æ–‡ä»¶ç®¡ç†å™¨çŠ¶æ€
    explorer: explorerSlice.reducer,
    // ç”¨æˆ·çŠ¶æ€
    user: userSlice.reducer,
    // ä¸Šä¼ çŠ¶æ€
    uploader: uploaderSlice.reducer,
    // å¯¹è¯æ¡†çŠ¶æ€
    dialog: dialogSlice.reducer,
  },
  middleware: (getDefaultMiddleware) =&gt;
    getDefaultMiddleware({
      serializableCheck: {
        ignoredActions: <span class="hljs-section">[FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER]</span>,
      },
    }),
})<span class="hljs-comment">;</span>
```

<span class="hljs-comment">### çŠ¶æ€ç®¡ç†æ¨¡å¼</span>

```mermaid
graph LR
    subgraph "Redux æ•°æ®æµ"
        A<span class="hljs-section">[Component]</span> --&gt; B<span class="hljs-section">[Action]</span>
        B --&gt; C<span class="hljs-section">[Reducer]</span>
        C --&gt; D<span class="hljs-section">[Store]</span>
        D --&gt; A
        
        E<span class="hljs-section">[Middleware]</span> --&gt; C
        F<span class="hljs-section">[DevTools]</span> --&gt; D
    end
```

<span class="hljs-comment">### ä¸»è¦ Slice è¯´æ˜</span>

<span class="hljs-comment">#### 1. globalStateSlice</span>
```typescript
interface GlobalState {
  // ä¾§è¾¹æ çŠ¶æ€
  drawerOpen: boolean<span class="hljs-comment">;</span>
  mobileDrawerOpen: boolean<span class="hljs-comment">;</span>
  // ä¸»é¢˜è®¾ç½®
  theme: 'light' | 'dark' | 'auto'<span class="hljs-comment">;</span>
  // è¯­è¨€è®¾ç½®
  language: string<span class="hljs-comment">;</span>
  // åŠ è½½çŠ¶æ€
  loading: boolean<span class="hljs-comment">;</span>
}
```

<span class="hljs-comment">#### 2. explorerSlice</span>
```typescript
interface ExplorerState {
  // å½“å‰è·¯å¾„
  currentPath: string<span class="hljs-comment">;</span>
  // æ–‡ä»¶åˆ—è¡¨
  files: FileResponse<span class="hljs-section">[]</span><span class="hljs-comment">;</span>
  // é€‰ä¸­çš„æ–‡ä»¶
  selectedFiles: string<span class="hljs-section">[]</span><span class="hljs-comment">;</span>
  // è§†å›¾æ¨¡å¼
  viewMode: 'list' | 'grid' | 'small'<span class="hljs-comment">;</span>
  // æ’åºæ–¹å¼
  sortBy: string<span class="hljs-comment">;</span>
  sortOrder: 'asc' | 'desc'<span class="hljs-comment">;</span>
}
```

<span class="hljs-comment">## è·¯ç”±ç³»ç»Ÿ</span>

<span class="hljs-comment">### è·¯ç”±é…ç½®ç»“æ„</span>

```typescript
// router/index.tsx
export const <span class="hljs-attr">router</span> = createBrowserRouter([
  {
    path: <span class="hljs-string">"/"</span>,
    element: &lt;App /&gt;,
    errorElement: &lt;ErrorBoundary /&gt;,
    children: [
      { path: <span class="hljs-string">"/"</span>, element: &lt;HomeRedirect /&gt; },
      {
        path: <span class="hljs-string">"/"</span>,
        element: &lt;HeadlessFrame /&gt;,
        children: [
          // ç™»å½•ç›¸å…³è·¯ç”±
          {
            path: <span class="hljs-string">"/session"</span>,
            element: &lt;SessionIntro /&gt;,
            children: [
              { path: <span class="hljs-string">"/session"</span>, element: &lt;SignIn /&gt; },
              { path: <span class="hljs-string">"signup"</span>, element: &lt;SignUp /&gt; },
              { path: <span class="hljs-string">"activate"</span>, element: &lt;Activate /&gt; },
              { path: <span class="hljs-string">"reset"</span>, element: &lt;Reset /&gt; },
            ],
          },
        ],
      },
    ],
  },
])<span class="hljs-comment">;</span>
```

<span class="hljs-comment">### è·¯ç”±å®ˆå«æœºåˆ¶</span>

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant R as Router
    participant A as Auth Guard
    participant S as Session
    participant C as Component

    U-&gt;&gt;R: è®¿é—®è·¯ç”±
    R-&gt;&gt;A: æ£€æŸ¥æƒé™
    A-&gt;&gt;S: éªŒè¯ä¼šè¯
    alt å·²ç™»å½•
        S--&gt;&gt;A: è¿”å›ç”¨æˆ·ä¿¡æ¯
        A--&gt;&gt;R: å…è®¸è®¿é—®
        R-&gt;&gt;C: æ¸²æŸ“ç»„ä»¶
        C--&gt;&gt;U: æ˜¾ç¤ºé¡µé¢
    else æœªç™»å½•
        S--&gt;&gt;A: è¿”å›æœªè®¤è¯
        A--&gt;&gt;R: é‡å®šå‘ç™»å½•
        R-&gt;&gt;U: è·³è½¬ç™»å½•é¡µ
    end
```

<span class="hljs-comment">## ç»„ä»¶è®¾è®¡æ¨¡å¼</span>

<span class="hljs-comment">### 1. å®¹å™¨ç»„ä»¶ vs å±•ç¤ºç»„ä»¶</span>

```typescript
// å®¹å™¨ç»„ä»¶ - è´Ÿè´£æ•°æ®å’Œé€»è¾‘
const FileManagerContainer: <span class="hljs-attr">React.FC</span> = () =&gt; {
  const <span class="hljs-attr">dispatch</span> = useAppDispatch()<span class="hljs-comment">;</span>
  const <span class="hljs-attr">files</span> = useAppSelector(state =&gt; state.explorer.files)<span class="hljs-comment">;</span>
  
  const <span class="hljs-attr">handleFileSelect</span> = (fileId: string) =&gt; {
    dispatch(selectFile(fileId))<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
  
  return (
    &lt;FileList 
      <span class="hljs-attr">files</span>={files}
      <span class="hljs-attr">onFileSelect</span>={handleFileSelect}
    /&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

// å±•ç¤ºç»„ä»¶ - è´Ÿè´£ UI æ¸²æŸ“
interface FileListProps {
  files: FileResponse<span class="hljs-section">[]</span><span class="hljs-comment">;</span>
  onFileSelect: (fileId: string) =&gt; void<span class="hljs-comment">;</span>
}

const FileList: React.FC&lt;FileListProps&gt; = ({ files, onFileSelect }) =&gt; {
  return (
    &lt;List&gt;
      {files.map(<span class="hljs-attr">file</span> =&gt; (
        &lt;FileItem 
          <span class="hljs-attr">key</span>={file.id}
          <span class="hljs-attr">file</span>={file}
          <span class="hljs-attr">onClick</span>={() =&gt; <span class="hljs-literal">on</span>FileSelect(file.id)}
        /&gt;
      ))}
    &lt;/List&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
```

<span class="hljs-comment">### 2. è‡ªå®šä¹‰ Hooks</span>

```typescript
// hooks/useFileManager.ts
export const <span class="hljs-attr">useFileManager</span> = () =&gt; {
  const <span class="hljs-attr">dispatch</span> = useAppDispatch()<span class="hljs-comment">;</span>
  const { files, currentPath, loading } = useAppSelector(<span class="hljs-attr">state</span> =&gt; state.explorer)<span class="hljs-comment">;</span>
  
  const <span class="hljs-attr">loadFiles</span> = useCallback(async (path: string) =&gt; {
    dispatch(setLoading(true))<span class="hljs-comment">;</span>
    try {
      const <span class="hljs-attr">response</span> = await api.listFiles(path)<span class="hljs-comment">;</span>
      dispatch(setFiles(response.data))<span class="hljs-comment">;</span>
    } catch (error) {
      // é”™è¯¯å¤„ç†
    } finally {
      dispatch(setLoading(false))<span class="hljs-comment">;</span>
    }
  }, <span class="hljs-section">[dispatch]</span>)<span class="hljs-comment">;</span>
  
  return {
    files,
    currentPath,
    loading,
    loadFiles,
  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
```

<span class="hljs-comment">### 3. é«˜é˜¶ç»„ä»¶ (HOC)</span>

```typescript
// hoc/withAuth.tsx
export const <span class="hljs-attr">withAuth</span> = &lt;P extends object&gt;(
  Component: React.ComponentType&lt;P&gt;
) =&gt; {
  return (props: P) =&gt; {
    const { user } = useAppSelector(<span class="hljs-attr">state</span> =&gt; state.user)<span class="hljs-comment">;</span>
    
    if (!user) {
      return &lt;Navigate <span class="hljs-attr">to</span>=<span class="hljs-string">"/session"</span> /&gt;<span class="hljs-comment">;</span>
    }
    
    return &lt;Component {...props} /&gt;<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

// ä½¿ç”¨æ–¹å¼
const <span class="hljs-attr">ProtectedPage</span> = withAuth(FileManager)<span class="hljs-comment">;</span>
```

<span class="hljs-comment">## Material-UI ä¸»é¢˜ç³»ç»Ÿ</span>

<span class="hljs-comment">### ä¸»é¢˜é…ç½®</span>

```typescript
// App.tsx ä¸­çš„ä¸»é¢˜é…ç½®
export const <span class="hljs-attr">applyThemeWithOverrides</span> = (themeConfig: ThemeOptions): ThemeOptions =&gt; {
  return {
    ...themeConfig,
    shape: {
      borderRadius: 12,
    },
    components: {
      MuiButton: {
        styleOverrides: {
          root: {
            textTransform: "none",
          },
        },
      },
      MuiTooltip: {
        defaultProps: {
          enterDelay: 500,
        },
      },
    },
  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
```

<span class="hljs-comment">### å“åº”å¼è®¾è®¡</span>

```typescript
// ä½¿ç”¨ MUI çš„æ–­ç‚¹ç³»ç»Ÿ
const <span class="hljs-attr">useStyles</span> = () =&gt; {
  const <span class="hljs-attr">theme</span> = useTheme()<span class="hljs-comment">;</span>
  const <span class="hljs-attr">isMobile</span> = useMediaQuery(theme.breakpoints.down(<span class="hljs-string">'sm'</span>))<span class="hljs-comment">;</span>
  const <span class="hljs-attr">isTablet</span> = useMediaQuery(theme.breakpoints.down(<span class="hljs-string">'md'</span>))<span class="hljs-comment">;</span>
  
  return {
    container: {
      padding: isMobile ? theme.spacing(1) : theme.spacing(3),
      gridTemplateColumns: isMobile ? '1fr' : 'repeat(auto-fill, minmax(200px, 1fr))',
    },
  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
```

<span class="hljs-comment">## API é›†æˆæ¨¡å¼</span>

<span class="hljs-comment">### è¯·æ±‚å°è£…</span>

```typescript
// api/request.ts
const <span class="hljs-attr">instance</span> = axios.create({
  baseURL: '/api/v4',
})<span class="hljs-comment">;</span>

// è¯·æ±‚æ‹¦æˆªå™¨
instance.interceptors.request.use(async (config) =&gt; {
  const <span class="hljs-attr">token</span> = await SessionManager.getAccessToken()<span class="hljs-comment">;</span>
  if (token) {
    <span class="hljs-attr">config.headers.Authorization</span> = `Bearer <span class="hljs-variable">${token}</span>`<span class="hljs-comment">;</span>
  }
  return config<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>

// å“åº”æ‹¦æˆªå™¨
instance.interceptors.response.use(
  (response) =&gt; response,
  async (error) =&gt; {
    if (error.response?.<span class="hljs-attr">status</span> === <span class="hljs-number">401</span>) {
      // å¤„ç†è®¤è¯å¤±è´¥
      await SessionManager.refreshToken()<span class="hljs-comment">;</span>
    }
    return Promise.reject(error)<span class="hljs-comment">;</span>
  }
)<span class="hljs-comment">;</span>
```

<span class="hljs-comment">### API å‡½æ•°è®¾è®¡</span>

```typescript
// api/explorer.ts
export const <span class="hljs-attr">explorerAPI</span> = {
  // è·å–æ–‡ä»¶åˆ—è¡¨
  listFiles: (path: string): Promise&lt;Response&lt;FileResponse<span class="hljs-section">[]</span>&gt;&gt; =&gt; {
    return request.get('/file/list', { params: { path } })<span class="hljs-comment">;</span>
  },
  
  // ä¸Šä¼ æ–‡ä»¶
  uploadFile: (
    file: File, 
    path: string, 
    onProgress?: (progress: number) =&gt; void
  ): Promise&lt;Response&lt;FileResponse&gt;&gt; =&gt; {
    const <span class="hljs-attr">formData</span> = new FormData()<span class="hljs-comment">;</span>
    formData.append('file', file)<span class="hljs-comment">;</span>
    formData.append('path', path)<span class="hljs-comment">;</span>
    
    return request.post('/file/upload', formData, {
      onUploadProgress: (progressEvent) =&gt; {
        const <span class="hljs-attr">progress</span> = Math.round(
          (progressEvent.loaded * 100) / progressEvent.total
        )<span class="hljs-comment">;</span>
        onProgress?.(progress)<span class="hljs-comment">;</span>
      },
    })<span class="hljs-comment">;</span>
  },
}<span class="hljs-comment">;</span>
```

<span class="hljs-comment">## å›½é™…åŒ– (i18n) ç³»ç»Ÿ</span>

<span class="hljs-comment">### é…ç½®ç»“æ„</span>

```typescript
// i18n.ts
import i18n from 'i18next'<span class="hljs-comment">;</span>
import Backend from 'i18next-http-backend'<span class="hljs-comment">;</span>
import LanguageDetector from 'i18next-browser-languagedetector'<span class="hljs-comment">;</span>

i18n
  .use(Backend)
  .use(LanguageDetector)
  .init({
    fallbackLng: 'en-US',
    debug: false,
    
    interpolation: {
      escapeValue: false,
    },
    
    backend: {
      loadPath: '/assets/locales/{{lng}}/{{ns}}.json',
    },
  })<span class="hljs-comment">;</span>
```

<span class="hljs-comment">### ä½¿ç”¨æ–¹å¼</span>

```typescript
// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
const FileManager: <span class="hljs-attr">React.FC</span> = () =&gt; {
  const { t } = useTranslation()<span class="hljs-comment">;</span>
  
  return (
    &lt;Box&gt;
      &lt;Typography <span class="hljs-attr">variant</span>=<span class="hljs-string">"h6"</span>&gt;
        {t('fileManager.title')}
      &lt;/Typography&gt;
      &lt;Button&gt;
        {t('common.upload')}
      &lt;/Button&gt;
    &lt;/Box&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
```

<span class="hljs-comment">## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</span>

<span class="hljs-comment">### 1. ä»£ç åˆ†å‰²</span>

```typescript
// è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
const <span class="hljs-attr">FileManager</span> = lazy(() =&gt; import(<span class="hljs-string">'../component/FileManager/FileManager'</span>))<span class="hljs-comment">;</span>
const <span class="hljs-attr">AdminPanel</span> = lazy(() =&gt; import(<span class="hljs-string">'../component/Admin/AdminPanel'</span>))<span class="hljs-comment">;</span>

// åœ¨è·¯ç”±ä¸­ä½¿ç”¨
&lt;Route 
  <span class="hljs-attr">path</span>=<span class="hljs-string">"/files"</span> 
  <span class="hljs-attr">element</span>={
    &lt;Suspense <span class="hljs-attr">fallback</span>={&lt;Loading /&gt;}&gt;
      &lt;FileManager /&gt;
    &lt;/Suspense&gt;
  } 
/&gt;
```

<span class="hljs-comment">### 2. ç»„ä»¶ä¼˜åŒ–</span>

```typescript
// ä½¿ç”¨ React.memo ä¼˜åŒ–æ¸²æŸ“
const <span class="hljs-attr">FileItem</span> = React.memo&lt;FileItemProps&gt;(({ file, <span class="hljs-literal">on</span>Select }) =&gt; {
  return (
    &lt;ListItem <span class="hljs-attr">onClick</span>={() =&gt; <span class="hljs-literal">on</span>Select(file.id)}&gt;
      &lt;ListItemText <span class="hljs-attr">primary</span>={file.name} /&gt;
    &lt;/ListItem&gt;
  )<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>

// ä½¿ç”¨ useMemo ä¼˜åŒ–è®¡ç®—
const FileList: React.FC&lt;FileListProps&gt; = ({ files, filter }) =&gt; {
  const <span class="hljs-attr">filteredFiles</span> = useMemo(() =&gt; {
    return files.filter(<span class="hljs-attr">file</span> =&gt; 
      file.name.toLowerCase().includes(filter.toLowerCase())
    )<span class="hljs-comment">;</span>
  }, <span class="hljs-section">[files, filter]</span>)<span class="hljs-comment">;</span>
  
  return (
    &lt;List&gt;
      {filteredFiles.map(<span class="hljs-attr">file</span> =&gt; (
        &lt;FileItem <span class="hljs-attr">key</span>={file.id} file={file} /&gt;
      ))}
    &lt;/List&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
```

<span class="hljs-comment">### 3. è™šæ‹Ÿæ»šåŠ¨</span>

```typescript
// ä½¿ç”¨ react-virtuoso å¤„ç†å¤§åˆ—è¡¨
import { Virtuoso } from 'react-virtuoso'<span class="hljs-comment">;</span>

const VirtualFileList: React.FC&lt;{ files: FileResponse<span class="hljs-section">[]</span> }&gt; = ({ files }) =&gt; {
  return (
    &lt;Virtuoso
      <span class="hljs-attr">data</span>={files}
      <span class="hljs-attr">itemContent</span>={(index, file) =&gt; (
        &lt;FileItem <span class="hljs-attr">key</span>={file.id} file={file} /&gt;
      )}
      <span class="hljs-attr">style</span>={{ height: <span class="hljs-string">'400px'</span> }}
    /&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
```

<span class="hljs-comment">## é”™è¯¯å¤„ç†æœºåˆ¶</span>

<span class="hljs-comment">### é”™è¯¯è¾¹ç•Œ</span>

```typescript
// component/Common/ErrorBoundary.tsx
class ErrorBoundary extends React.Component&lt;Props, State&gt; {
  constructor(props: Props) {
    super(props)<span class="hljs-comment">;</span>
    <span class="hljs-attr">this.state</span> = { hasError: <span class="hljs-literal">false</span> }<span class="hljs-comment">;</span>
  }

  static getDerivedStateFromError(error: Error): State {
    return { hasError: true }<span class="hljs-comment">;</span>
  }

  componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    console.error('Error caught by boundary:', error, errorInfo)<span class="hljs-comment">;</span>
  }

  render() {
    if (this.state.hasError) {
      return &lt;ErrorFallback /&gt;<span class="hljs-comment">;</span>
    }

    return this.props.children<span class="hljs-comment">;</span>
  }
}
```

<span class="hljs-comment">### å…¨å±€é”™è¯¯å¤„ç†</span>

```typescript
// åœ¨ request.ts ä¸­ç»Ÿä¸€å¤„ç†é”™è¯¯
instance.interceptors.response.use(
  (response) =&gt; response,
  (error) =&gt; {
    const <span class="hljs-attr">message</span> = error.response?.data?.message || error.message<span class="hljs-comment">;</span>
    
    // æ˜¾ç¤ºé”™è¯¯æç¤º
    enqueueSnackbar(message, { 
      variant: 'error',
      action: &lt;DefaultCloseAction /&gt;
    })<span class="hljs-comment">;</span>
    
    return Promise.reject(error)<span class="hljs-comment">;</span>
  }
)<span class="hljs-comment">;</span>
```

<span class="hljs-comment">## æµ‹è¯•ç­–ç•¥</span>

<span class="hljs-comment">### å•å…ƒæµ‹è¯•</span>

```typescript
// __tests__/FileItem.test.tsx
import { render, screen, fireEvent } from '@testing-library/react'<span class="hljs-comment">;</span>
import { FileItem } from '../FileItem'<span class="hljs-comment">;</span>

describe('FileItem', () =&gt; {
  const <span class="hljs-attr">mockFile</span> = {
    id: '1',
    name: 'test.txt',
    size: 1024,
  }<span class="hljs-comment">;</span>

  it('renders file name correctly', () =&gt; {
    render(&lt;FileItem <span class="hljs-attr">file</span>={mockFile} <span class="hljs-literal">on</span>Select={jest.fn()} /&gt;)<span class="hljs-comment">;</span>
    expect(screen.getByText('test.txt')).toBeInTheDocument()<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>

  it('calls onSelect when clicked', () =&gt; {
    const <span class="hljs-attr">onSelect</span> = jest.fn()<span class="hljs-comment">;</span>
    render(&lt;FileItem <span class="hljs-attr">file</span>={mockFile} <span class="hljs-literal">on</span>Select={<span class="hljs-literal">on</span>Select} /&gt;)<span class="hljs-comment">;</span>
    
    fireEvent.click(screen.getByText('test.txt'))<span class="hljs-comment">;</span>
    expect(onSelect).toHaveBeenCalledWith('1')<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
```

<span class="hljs-comment">## å¼€å‘æœ€ä½³å®è·µ</span>

<span class="hljs-comment">### 1. ç»„ä»¶è®¾è®¡åŸåˆ™</span>
- **å•ä¸€èŒè´£**: æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
- **å¯å¤ç”¨æ€§**: è®¾è®¡é€šç”¨çš„ç»„ä»¶æ¥å£
- **å¯æµ‹è¯•æ€§**: ä¾¿äºç¼–å†™å•å…ƒæµ‹è¯•
- **æ€§èƒ½ä¼˜åŒ–**: é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“

<span class="hljs-comment">### 2. çŠ¶æ€ç®¡ç†åŸåˆ™</span>
- **æœ€å°åŒ–çŠ¶æ€**: åªå­˜å‚¨å¿…è¦çš„çŠ¶æ€
- **ä¸å¯å˜æ›´æ–°**: ä½¿ç”¨ Redux Toolkit çš„ Immer
- **å¼‚æ­¥å¤„ç†**: ä½¿ç”¨ createAsyncThunk å¤„ç†å¼‚æ­¥æ“ä½œ

<span class="hljs-comment">### 3. ä»£ç ç»„ç»‡åŸåˆ™</span>
- **æŒ‰åŠŸèƒ½åˆ†ç»„**: ç›¸å…³ç»„ä»¶æ”¾åœ¨åŒä¸€ç›®å½•
- **ç±»å‹å®šä¹‰**: ä¸ºæ‰€æœ‰ props å’ŒçŠ¶æ€å®šä¹‰ç±»å‹
- **æ–‡æ¡£æ³¨é‡Š**: ä¸ºå¤æ‚ç»„ä»¶æ·»åŠ  JSDoc æ³¨é‡Š

<span class="hljs-comment">## æ€»ç»“</span>

Cloudreve çš„å‰ç«¯æ¶æ„é‡‡ç”¨äº†ç°ä»£åŒ–çš„ React ç”Ÿæ€ç³»ç»Ÿï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. **ç±»å‹å®‰å…¨**: å…¨é¢ä½¿ç”¨ TypeScript
2. **ç»„ä»¶åŒ–**: é«˜åº¦æ¨¡å—åŒ–çš„ç»„ä»¶è®¾è®¡
3. **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨ Redux Toolkit è¿›è¡ŒçŠ¶æ€ç®¡ç†
4. **UI ä¸€è‡´æ€§**: åŸºäº Material-UI çš„è®¾è®¡ç³»ç»Ÿ
5. **æ€§èƒ½ä¼˜åŒ–**: ä»£ç åˆ†å‰²ã€è™šæ‹Ÿæ»šåŠ¨ç­‰ä¼˜åŒ–ç­–ç•¥
6. **å›½é™…åŒ–**: å®Œæ•´çš„å¤šè¯­è¨€æ”¯æŒ
7. **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯è¾¹ç•Œå’Œé”™è¯¯å¤„ç†æœºåˆ¶

è¿™ä¸ªæ¶æ„ä¸ºä½ å¼€å‘ä¾§è¾¹æ å¯¹è¯åŠŸèƒ½æä¾›äº†è‰¯å¥½çš„åŸºç¡€ï¼Œä½ å¯ä»¥å‚è€ƒç°æœ‰çš„ç»„ä»¶è®¾è®¡æ¨¡å¼å’ŒçŠ¶æ€ç®¡ç†æ–¹å¼æ¥å®ç°æ–°åŠŸèƒ½ã€‚
</code></pre>
<h3 data-id="heading-5"><strong>03-backend-architecture.md - åç«¯æ¶æ„æŒ‡å—</strong></h3>
<ul>
<li>
<p>Go è¯­è¨€åŸºç¡€çŸ¥è¯†ï¼ˆä¸“ä¸ºå‰ç«¯å¼€å‘è€…ï¼‰</p>
</li>
<li>
<p>Gin æ¡†æ¶å’Œ Ent ORM ä½¿ç”¨</p>
</li>
<li>
<p>æœåŠ¡å±‚è®¾è®¡å’Œè®¤è¯ç³»ç»Ÿ</p>
</li>
</ul>

<pre><code class="hljs language-scss" lang="scss"># Cloudreve åç«¯æ¶æ„å­¦ä¹ æŒ‡å—

## Go è¯­è¨€åŸºç¡€çŸ¥è¯†

### ä¸ºä»€ä¹ˆé€‰æ‹© Go
- **é«˜æ€§èƒ½**: ç¼–è¯‘å‹è¯­è¨€ï¼Œæ¥è¿‘ C/C++ çš„æ€§èƒ½
- **å¹¶å‘æ”¯æŒ**: åŸç”Ÿçš„ goroutine å’Œ channel æ”¯æŒ
- **ç®€æ´è¯­æ³•**: å­¦ä¹ æ›²çº¿å¹³ç¼“ï¼Œä»£ç å¯è¯»æ€§å¼º
- **ä¸°å¯Œç”Ÿæ€**: ä¼˜ç§€çš„ Web æ¡†æ¶å’Œå·¥å…·é“¾
- **å†…å­˜å®‰å…¨**: åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œé¿å…å†…å­˜æ³„æ¼

### Go è¯­è¨€æ ¸å¿ƒæ¦‚å¿µ

#### <span class="hljs-number">1</span>. åŒ… (Package) ç³»ç»Ÿ
```go
// åŒ…å£°æ˜
package main

// å¯¼å…¥å…¶ä»–åŒ…
import (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"net/http"</span>
    <span class="hljs-string">"github.com/gin-gonic/gin"</span>
)

// å‡½æ•°å®šä¹‰
func <span class="hljs-built_in">main</span>() {
    fmt<span class="hljs-selector-class">.Println</span>("Hello, World!")
}
```

#### <span class="hljs-number">2</span>. ç»“æ„ä½“ (Struct)
```go
<span class="hljs-comment">// å®šä¹‰ç»“æ„ä½“</span>
type User struct {
    ID       int    `json:<span class="hljs-string">"id"</span>`
    Name     string `json:<span class="hljs-string">"name"</span>`
    Email    string `json:<span class="hljs-string">"email"</span>`
    Password string `json:<span class="hljs-string">"-"</span>` // ä¸åºåˆ—åŒ–åˆ° JSON
}

<span class="hljs-comment">// ç»“æ„ä½“æ–¹æ³•</span>
func (u *User) <span class="hljs-built_in">GetDisplayName</span>() string {
    return u<span class="hljs-selector-class">.Name</span>
}
```

#### <span class="hljs-number">3</span>. æ¥å£ (Interface)
```go
<span class="hljs-comment">// å®šä¹‰æ¥å£</span>
type UserService interface {
    <span class="hljs-built_in">CreateUser</span>(user *User) error
    <span class="hljs-built_in">GetUser</span>(id int) (*User, error)
    <span class="hljs-built_in">UpdateUser</span>(user *User) error
    <span class="hljs-built_in">DeleteUser</span>(id int) error
}

<span class="hljs-comment">// å®ç°æ¥å£</span>
type userServiceImpl struct {
    db *sql<span class="hljs-selector-class">.DB</span>
}

func (s *userServiceImpl) <span class="hljs-built_in">CreateUser</span>(user *User) error {
    <span class="hljs-comment">// å®ç°é€»è¾‘</span>
    return nil
}
```

#### <span class="hljs-number">4</span>. é”™è¯¯å¤„ç†
```go
func <span class="hljs-built_in">GetUser</span>(id int) (*User, error) {
    if id &lt;= <span class="hljs-number">0</span> {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("invalid user id: %d", id)
    }
    
    user, err := db.<span class="hljs-built_in">FindUser</span>(id)
    if err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to find user: %w", err)
    }
    
    return user, nil
}

<span class="hljs-comment">// ä½¿ç”¨</span>
user, err := <span class="hljs-built_in">GetUser</span>(<span class="hljs-number">123</span>)
if err != nil {
    log<span class="hljs-selector-class">.Printf</span>("Error: %v", err)
    return
}
```

## Cloudreve åç«¯æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶å’Œåº“
- **Gin**: é«˜æ€§èƒ½çš„ HTTP Web æ¡†æ¶
- **Ent**: Facebook å¼€æºçš„ Go ORM æ¡†æ¶
- **Cobra**: å‘½ä»¤è¡Œåº”ç”¨æ¡†æ¶
- **JWT**: JSON Web Token è®¤è¯
- **Viper**: é…ç½®ç®¡ç†
- **Logrus**: ç»“æ„åŒ–æ—¥å¿—

### æ•°æ®åº“æ”¯æŒ
- **MySQL**: ä¸»è¦ç”Ÿäº§æ•°æ®åº“
- **PostgreSQL**: ä¼ä¸šçº§æ•°æ®åº“
- **SQLite**: è½»é‡çº§åµŒå…¥å¼æ•°æ®åº“

## é¡¹ç›®æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„

```mermaid
graph TB
    subgraph <span class="hljs-string">"Cloudreve åç«¯åˆ†å±‚æ¶æ„"</span>
        A[HTTP å±‚] --&gt; B[è·¯ç”±å±‚ - routers/]
        B --&gt; C[æ§åˆ¶å™¨å±‚ - controllers/]
        C --&gt; D[æœåŠ¡å±‚ - service/]
        D --&gt; E[æ•°æ®è®¿é—®å±‚ - ent/]
        E --&gt; F[æ•°æ®åº“]
        
        G[ä¸­é—´ä»¶å±‚ - middleware/] --&gt; C
        H[å·¥å…·åŒ… - pkg/] --&gt; D
        I[åº”ç”¨é…ç½® - application/] --&gt; D
    end
```

### ç›®å½•ç»“æ„è¯¦è§£

```
Cloudreve/
â”œâ”€â”€ main.go                 # åº”ç”¨å…¥å£
â”œâ”€â”€ cmd/                    # å‘½ä»¤è¡Œå·¥å…·
â”‚   â”œâ”€â”€ root.go            # æ ¹å‘½ä»¤
â”‚   â”œâ”€â”€ server.go          # æœåŠ¡å™¨å‘½ä»¤
â”‚   â””â”€â”€ migrate.go         # æ•°æ®åº“è¿ç§»
â”œâ”€â”€ routers/               # è·¯ç”±å±‚
â”‚   â”œâ”€â”€ router.go          # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ controllers/       # æ§åˆ¶å™¨
â”œâ”€â”€ service/               # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ admin/            # ç®¡ç†æœåŠ¡
â”‚   â”œâ”€â”€ user/             # ç”¨æˆ·æœåŠ¡
â”‚   â”œâ”€â”€ explorer/         # æ–‡ä»¶ç®¡ç†æœåŠ¡
â”‚   â””â”€â”€ chat/             # èŠå¤©æœåŠ¡
â”œâ”€â”€ ent/                   # æ•°æ®æ¨¡å‹å±‚ (Ent ORM)
â”‚   â”œâ”€â”€ schema/           # æ•°æ®åº“æ¨¡å¼å®šä¹‰
â”‚   â”œâ”€â”€ migrate/          # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ *.go              # ç”Ÿæˆçš„å®ä½“ä»£ç 
â”œâ”€â”€ middleware/            # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ auth.go           # è®¤è¯ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ cors.go           # è·¨åŸŸä¸­é—´ä»¶
â”‚   â””â”€â”€ session.go        # ä¼šè¯ä¸­é—´ä»¶
â”œâ”€â”€ pkg/                   # å·¥å…·åŒ…
â”‚   â”œâ”€â”€ auth/             # è®¤è¯å·¥å…·
â”‚   â”œâ”€â”€ cache/            # ç¼“å­˜å·¥å…·
â”‚   â”œâ”€â”€ conf/             # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ util/             # é€šç”¨å·¥å…·
â”œâ”€â”€ inventory/             # åº“å­˜ç®¡ç†
â””â”€â”€ application/           # åº”ç”¨é…ç½®
```

## Gin æ¡†æ¶è¯¦è§£

### åŸºæœ¬ç”¨æ³•

```go
package main

import (
    <span class="hljs-string">"github.com/gin-gonic/gin"</span>
    <span class="hljs-string">"net/http"</span>
)

func <span class="hljs-built_in">main</span>() {
    <span class="hljs-comment">// åˆ›å»º Gin å¼•æ“</span>
    r := gin.<span class="hljs-built_in">Default</span>()
    
    // å®šä¹‰è·¯ç”±
    r.<span class="hljs-built_in">GET</span>(<span class="hljs-string">"/ping"</span>, <span class="hljs-built_in">func</span>(c *gin.Context) {
        c<span class="hljs-selector-class">.JSON</span>(http.StatusOK, gin.H{
            "message": "pong",
        })
    })
    
    <span class="hljs-comment">// å¯åŠ¨æœåŠ¡å™¨</span>
    r<span class="hljs-selector-class">.Run</span>(":<span class="hljs-number">8080</span>")
}
```

### è·¯ç”±ç»„ç»‡

```go
<span class="hljs-comment">// routers/router.go</span>
func <span class="hljs-built_in">InitRouter</span>(dep dependency.Dep) *gin<span class="hljs-selector-class">.Engine</span> {
    r := gin.<span class="hljs-built_in">New</span>()
    
    // å…¨å±€ä¸­é—´ä»¶
    r.<span class="hljs-built_in">Use</span>(gin.<span class="hljs-built_in">Recovery</span>())
    r.<span class="hljs-built_in">Use</span>(middleware.<span class="hljs-built_in">CORS</span>())
    
    // API ç‰ˆæœ¬åˆ†ç»„
    v4 := r.<span class="hljs-built_in">Group</span>(<span class="hljs-string">"/api/v4"</span>)
    
    // ç”¨æˆ·ç›¸å…³è·¯ç”±
    user := v4.<span class="hljs-built_in">Group</span>(<span class="hljs-string">"/user"</span>)
    user.<span class="hljs-built_in">Use</span>(middleware.<span class="hljs-built_in">LoginRequired</span>())
    {
        user<span class="hljs-selector-class">.GET</span>("/info", controllers.GetUserInfo)
        user<span class="hljs-selector-class">.PUT</span>("/info", controllers.UpdateUserInfo)
    }
    
    <span class="hljs-comment">// æ–‡ä»¶ç›¸å…³è·¯ç”±</span>
    file := v4.<span class="hljs-built_in">Group</span>(<span class="hljs-string">"/file"</span>)
    {
        file<span class="hljs-selector-class">.GET</span>("/list", controllers.ListFiles)
        file<span class="hljs-selector-class">.POST</span>("/upload", controllers.UploadFile)
    }
    
    return r
}
```

### ä¸­é—´ä»¶ç³»ç»Ÿ

```go
<span class="hljs-comment">// middleware/auth.go</span>
func <span class="hljs-built_in">LoginRequired</span>() gin<span class="hljs-selector-class">.HandlerFunc</span> {
    return <span class="hljs-built_in">func</span>(c *gin.Context) {
        <span class="hljs-comment">// ä»è¯·æ±‚å¤´è·å– token</span>
        token := c.<span class="hljs-built_in">GetHeader</span>(<span class="hljs-string">"Authorization"</span>)
        if token == <span class="hljs-string">""</span> {
            c<span class="hljs-selector-class">.JSON</span>(http.StatusUnauthorized, gin.H{
                "error": "Missing authorization token",
            })
            c<span class="hljs-selector-class">.Abort</span>()
            return
        }
        
        <span class="hljs-comment">// éªŒè¯ token</span>
        user, err := <span class="hljs-built_in">validateToken</span>(token)
        if err != nil {
            c<span class="hljs-selector-class">.JSON</span>(http.StatusUnauthorized, gin.H{
                "error": "Invalid token",
            })
            c<span class="hljs-selector-class">.Abort</span>()
            return
        }
        
        <span class="hljs-comment">// å°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ°ä¸Šä¸‹æ–‡</span>
        c<span class="hljs-selector-class">.Set</span>("user", user)
        c<span class="hljs-selector-class">.Next</span>()
    }
}
```

## Ent ORM æ¡†æ¶

### æ¨¡å¼å®šä¹‰

```go
<span class="hljs-comment">// ent/schema/user.go</span>
package schema

import (
    "entgo.io/ent"
    "entgo.io/ent/schema/field"
    "entgo.io/ent/schema/edge"
)

<span class="hljs-comment">// User ç”¨æˆ·å®ä½“</span>
type User struct {
    ent<span class="hljs-selector-class">.Schema</span>
}

<span class="hljs-comment">// Fields å­—æ®µå®šä¹‰</span>
func (User) <span class="hljs-built_in">Fields</span>() <span class="hljs-selector-attr">[]</span>ent<span class="hljs-selector-class">.Field</span> {
    return <span class="hljs-selector-attr">[]</span>ent<span class="hljs-selector-class">.Field</span>{
        field<span class="hljs-selector-class">.String</span>("name").
            <span class="hljs-built_in">NotEmpty</span>().
            <span class="hljs-built_in">Comment</span>("ç”¨æˆ·å"),
        field<span class="hljs-selector-class">.String</span>("email").
            <span class="hljs-built_in">Unique</span>().
            <span class="hljs-built_in">Comment</span>("é‚®ç®±"),
        field<span class="hljs-selector-class">.String</span>("password").
            <span class="hljs-built_in">Sensitive</span>().
            <span class="hljs-built_in">Comment</span>("å¯†ç "),
        field<span class="hljs-selector-class">.Time</span>("created_at").
            Default(time.Now).
            <span class="hljs-built_in">Comment</span>("åˆ›å»ºæ—¶é—´"),
    }
}

<span class="hljs-comment">// Edges å…³è”å…³ç³»</span>
func (User) <span class="hljs-built_in">Edges</span>() <span class="hljs-selector-attr">[]</span>ent<span class="hljs-selector-class">.Edge</span> {
    return <span class="hljs-selector-attr">[]</span>ent<span class="hljs-selector-class">.Edge</span>{
        edge<span class="hljs-selector-class">.To</span>("files", File.Type).
            <span class="hljs-built_in">Comment</span>("ç”¨æˆ·æ–‡ä»¶"),
        edge<span class="hljs-selector-class">.To</span>("groups", Group.Type).
            <span class="hljs-built_in">Through</span>("user_groups", UserGroup.Type).
            <span class="hljs-built_in">Comment</span>("ç”¨æˆ·ç»„"),
    }
}
```

### æ•°æ®åº“æ“ä½œ

```go
<span class="hljs-comment">// service/user/user.go</span>
type UserService struct {
    client *ent<span class="hljs-selector-class">.Client</span>
}

func <span class="hljs-built_in">NewUserService</span>(client *ent.Client) *UserService {
    return &amp;UserService{client: client}
}

<span class="hljs-comment">// åˆ›å»ºç”¨æˆ·</span>
func (s *UserService) <span class="hljs-built_in">CreateUser</span>(ctx context.Context, req *CreateUserRequest) (*ent.User, error) {
    user, err := s.client.User.
        <span class="hljs-built_in">Create</span>().
        <span class="hljs-built_in">SetName</span>(req.Name).
        <span class="hljs-built_in">SetEmail</span>(req.Email).
        <span class="hljs-built_in">SetPassword</span>(<span class="hljs-built_in">hashPassword</span>(req.Password)).
        <span class="hljs-built_in">Save</span>(ctx)
    
    if err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to create user: %w", err)
    }
    
    return user, nil
}

<span class="hljs-comment">// æŸ¥è¯¢ç”¨æˆ·</span>
func (s *UserService) <span class="hljs-built_in">GetUser</span>(ctx context.Context, id int) (*ent.User, error) {
    user, err := s.client.User.
        <span class="hljs-built_in">Query</span>().
        <span class="hljs-built_in">Where</span>(user.<span class="hljs-built_in">ID</span>(id)).
        <span class="hljs-built_in">WithFiles</span>().  // é¢„åŠ è½½æ–‡ä»¶å…³è”
        <span class="hljs-built_in">Only</span>(ctx)
    
    if err != nil {
        if ent<span class="hljs-selector-class">.IsNotFound</span>(err) {
            return nil, fmt<span class="hljs-selector-class">.Errorf</span>("user not found")
        }
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to get user: %w", err)
    }
    
    return user, nil
}

<span class="hljs-comment">// æ›´æ–°ç”¨æˆ·</span>
func (s *UserService) <span class="hljs-built_in">UpdateUser</span>(ctx context.Context, id int, req *UpdateUserRequest) (*ent.User, error) {
    user, err := s.client.User.
        <span class="hljs-built_in">UpdateOneID</span>(id).
        <span class="hljs-built_in">SetName</span>(req.Name).
        <span class="hljs-built_in">SetEmail</span>(req.Email).
        <span class="hljs-built_in">Save</span>(ctx)
    
    if err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to update user: %w", err)
    }
    
    return user, nil
}
```

## æ§åˆ¶å™¨å±‚è®¾è®¡

### æ§åˆ¶å™¨ç»“æ„

```go
<span class="hljs-comment">// routers/controllers/user.go</span>
package controllers

import (
    "github.com/gin-gonic/gin"
    "github.com/cloudreve/Cloudreve/v4/service/user"
)

<span class="hljs-comment">// GetUserInfo è·å–ç”¨æˆ·ä¿¡æ¯</span>
func <span class="hljs-built_in">GetUserInfo</span>(c *gin.Context) {
    <span class="hljs-comment">// ä»ä¸Šä¸‹æ–‡è·å–ç”¨æˆ·</span>
    currentUser, exists := c.<span class="hljs-built_in">Get</span>(<span class="hljs-string">"user"</span>)
    if !exists {
        c<span class="hljs-selector-class">.JSON</span>(http.StatusUnauthorized, gin.H{
            "error": "User not found in context",
        })
        return
    }
    
    user := currentUser.(*ent.User)
    
    // è¿”å›ç”¨æˆ·ä¿¡æ¯
    c.<span class="hljs-built_in">JSON</span>(http.StatusOK, gin.H{
        "data": gin.H{
            "id":    user.ID,
            <span class="hljs-string">"name"</span>:  user.Name,
            <span class="hljs-string">"email"</span>: user.Email,
        },
    })
}

<span class="hljs-comment">// UpdateUserInfo æ›´æ–°ç”¨æˆ·ä¿¡æ¯</span>
func <span class="hljs-built_in">UpdateUserInfo</span>(c *gin.Context) {
    <span class="hljs-selector-tag">var</span> req user<span class="hljs-selector-class">.UpdateUserRequest</span>
    
    <span class="hljs-comment">// ç»‘å®šè¯·æ±‚å‚æ•°</span>
    if err := c.<span class="hljs-built_in">ShouldBindJSON</span>(&amp;req); err != nil {
        c<span class="hljs-selector-class">.JSON</span>(http.StatusBadRequest, gin.H{
            "error": err.Error(),
        })
        return
    }
    
    <span class="hljs-comment">// è·å–å½“å‰ç”¨æˆ·</span>
    currentUser := c.<span class="hljs-built_in">MustGet</span>(<span class="hljs-string">"user"</span>).(*ent.User)
    
    // è°ƒç”¨æœåŠ¡å±‚
    userService := user.<span class="hljs-built_in">NewUserService</span>(ent.<span class="hljs-built_in">GetClient</span>())
    updatedUser, err := userService.<span class="hljs-built_in">UpdateUser</span>(c.Request.<span class="hljs-built_in">Context</span>(), currentUser.ID, &amp;req)
    if err != nil {
        c<span class="hljs-selector-class">.JSON</span>(http.StatusInternalServerError, gin.H{
            "error": err.Error(),
        })
        return
    }
    
    c<span class="hljs-selector-class">.JSON</span>(http.StatusOK, gin.H{
        "data": updatedUser,
    })
}
```

### å‚æ•°ç»‘å®šå’ŒéªŒè¯

```go
<span class="hljs-comment">// service/user/types.go</span>
type CreateUserRequest struct {
    Name     string `json:<span class="hljs-string">"name"</span> binding:<span class="hljs-string">"required,min=2,max=50"</span>`
    Email    string `json:<span class="hljs-string">"email"</span> binding:<span class="hljs-string">"required,email"</span>`
    Password string `json:<span class="hljs-string">"password"</span> binding:<span class="hljs-string">"required,min=6"</span>`
}

type UpdateUserRequest struct {
    Name  string `json:<span class="hljs-string">"name"</span> binding:<span class="hljs-string">"omitempty,min=2,max=50"</span>`
    Email string `json:<span class="hljs-string">"email"</span> binding:<span class="hljs-string">"omitempty,email"</span>`
}

<span class="hljs-comment">// è‡ªå®šä¹‰éªŒè¯å™¨</span>
func <span class="hljs-built_in">ValidatePassword</span>(fl validator.FieldLevel) bool {
    password := fl.<span class="hljs-built_in">Field</span>().<span class="hljs-built_in">String</span>()
    // å¯†ç å¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—
    hasLetter := regexp.<span class="hljs-built_in">MustCompile</span>(`[a-zA-Z]`).<span class="hljs-built_in">MatchString</span>(password)
    hasNumber := regexp.<span class="hljs-built_in">MustCompile</span>(`[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]`).<span class="hljs-built_in">MatchString</span>(password)
    return hasLetter &amp;&amp; hasNumber
}
```

## æœåŠ¡å±‚è®¾è®¡æ¨¡å¼

### ä¾èµ–æ³¨å…¥

```go
<span class="hljs-comment">// application/dependency/dependency.go</span>
type Dep interface {
    <span class="hljs-built_in">Logger</span>() logging<span class="hljs-selector-class">.Logger</span>
    <span class="hljs-built_in">ConfigProvider</span>() conf<span class="hljs-selector-class">.Provider</span>
    <span class="hljs-built_in">DatabaseClient</span>() *ent<span class="hljs-selector-class">.Client</span>
    <span class="hljs-built_in">CacheProvider</span>() cache<span class="hljs-selector-class">.Driver</span>
}

type dep struct {
    logger         logging<span class="hljs-selector-class">.Logger</span>
    configProvider conf<span class="hljs-selector-class">.Provider</span>
    dbClient       *ent<span class="hljs-selector-class">.Client</span>
    cacheProvider  cache<span class="hljs-selector-class">.Driver</span>
}

func <span class="hljs-built_in">NewDep</span>() Dep {
    return &amp;dep{
        logger:         logging.<span class="hljs-built_in">NewLogger</span>(),
        configProvider: conf.<span class="hljs-built_in">NewProvider</span>(),
        dbClient:       ent.<span class="hljs-built_in">NewClient</span>(),
        cacheProvider:  cache.<span class="hljs-built_in">NewRedisDriver</span>(),
    }
}
```

### æœåŠ¡æ¥å£è®¾è®¡

```go
<span class="hljs-comment">// service/user/interface.go</span>
type Service interface {
    <span class="hljs-built_in">CreateUser</span>(ctx context.Context, req *CreateUserRequest) (*ent.User, error)
    <span class="hljs-built_in">GetUser</span>(ctx context.Context, id int) (*ent.User, error)
    <span class="hljs-built_in">UpdateUser</span>(ctx context.Context, id int, req *UpdateUserRequest) (*ent.User, error)
    <span class="hljs-built_in">DeleteUser</span>(ctx context.Context, id int) error
    <span class="hljs-built_in">ListUsers</span>(ctx context.Context, req *ListUsersRequest) ([]*ent.User, error)
}

<span class="hljs-comment">// service/user/service.go</span>
type service struct {
    dep    dependency<span class="hljs-selector-class">.Dep</span>
    client *ent<span class="hljs-selector-class">.Client</span>
    logger logging<span class="hljs-selector-class">.Logger</span>
}

func <span class="hljs-built_in">NewService</span>(dep dependency.Dep) Service {
    return &amp;service{
        dep:    dep,
        client: dep.<span class="hljs-built_in">DatabaseClient</span>(),
        logger: dep.<span class="hljs-built_in">Logger</span>(),
    }
}
```

## è®¤è¯å’Œæˆæƒç³»ç»Ÿ

### JWT è®¤è¯

```go
<span class="hljs-comment">// pkg/auth/jwt.go</span>
type JWTAuth struct {
    secretKey <span class="hljs-selector-attr">[]</span>byte
    issuer    string
}

type Claims struct {
    UserID int    `json:<span class="hljs-string">"user_id"</span>`
    Email  string `json:<span class="hljs-string">"email"</span>`
    jwt.RegisteredClaims
}

func (j *JWTAuth) <span class="hljs-built_in">GenerateToken</span>(user *ent.User) (string, error) {
    claims := &amp;Claims{
        UserID: user.ID,
        Email:  user.Email,
        RegisteredClaims: jwt.RegisteredClaims{
            ExpiresAt: jwt.<span class="hljs-built_in">NewNumericDate</span>(time.<span class="hljs-built_in">Now</span>().<span class="hljs-built_in">Add</span>(<span class="hljs-number">24</span> * time.Hour)),
            IssuedAt:  jwt.<span class="hljs-built_in">NewNumericDate</span>(time.<span class="hljs-built_in">Now</span>()),
            Issuer:    j.issuer,
        },
    }
    
    token := jwt.<span class="hljs-built_in">NewWithClaims</span>(jwt.SigningMethodHS256, claims)
    return token.<span class="hljs-built_in">SignedString</span>(j.secretKey)
}

func (j *JWTAuth) <span class="hljs-built_in">ValidateToken</span>(tokenString string) (*Claims, error) {
    token, err := jwt.<span class="hljs-built_in">ParseWithClaims</span>(tokenString, &amp;Claims{}, <span class="hljs-built_in">func</span>(token *jwt.Token) (interface{}, error) {
        return j<span class="hljs-selector-class">.secretKey</span>, nil
    })
    
    if err != nil {
        return nil, err
    }
    
    if claims, ok := token.Claims.(*Claims); ok &amp;&amp; token<span class="hljs-selector-class">.Valid</span> {
        return claims, nil
    }
    
    return nil, fmt<span class="hljs-selector-class">.Errorf</span>("invalid token")
}
```

### æƒé™æ§åˆ¶

```go
<span class="hljs-comment">// middleware/rbac.go</span>
func <span class="hljs-built_in">RequirePermission</span>(permission string) gin<span class="hljs-selector-class">.HandlerFunc</span> {
    return <span class="hljs-built_in">func</span>(c *gin.Context) {
        user := c.<span class="hljs-built_in">MustGet</span>(<span class="hljs-string">"user"</span>).(*ent.User)
        
        // æ£€æŸ¥ç”¨æˆ·æƒé™
        hasPermission, err := <span class="hljs-built_in">checkUserPermission</span>(user.ID, permission)
        if err != nil {
            c<span class="hljs-selector-class">.JSON</span>(http.StatusInternalServerError, gin.H{
                "error": "Failed to check permission",
            })
            c<span class="hljs-selector-class">.Abort</span>()
            return
        }
        
        if !hasPermission {
            c<span class="hljs-selector-class">.JSON</span>(http.StatusForbidden, gin.H{
                "error": "Insufficient permissions",
            })
            c<span class="hljs-selector-class">.Abort</span>()
            return
        }
        
        c<span class="hljs-selector-class">.Next</span>()
    }
}

<span class="hljs-comment">// ä½¿ç”¨æ–¹å¼</span>
admin := v4.<span class="hljs-built_in">Group</span>(<span class="hljs-string">"/admin"</span>)
admin.<span class="hljs-built_in">Use</span>(middleware.<span class="hljs-built_in">LoginRequired</span>())
admin.<span class="hljs-built_in">Use</span>(middleware.<span class="hljs-built_in">RequirePermission</span>(<span class="hljs-string">"admin:read"</span>))
{
    admin<span class="hljs-selector-class">.GET</span>("/users", controllers.ListUsers)
}
```

## æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ

### å­˜å‚¨æ¥å£è®¾è®¡

```go
<span class="hljs-comment">// pkg/filesystem/driver.go</span>
type Driver interface {
    <span class="hljs-comment">// ä¸Šä¼ æ–‡ä»¶</span>
    <span class="hljs-built_in">Put</span>(ctx context.Context, path string, file io.Reader) error
    
    <span class="hljs-comment">// è·å–æ–‡ä»¶</span>
    <span class="hljs-built_in">Get</span>(ctx context.Context, path string) (io.ReadCloser, error)
    
    <span class="hljs-comment">// åˆ é™¤æ–‡ä»¶</span>
    <span class="hljs-built_in">Delete</span>(ctx context.Context, path string) error
    
    <span class="hljs-comment">// è·å–æ–‡ä»¶ä¿¡æ¯</span>
    <span class="hljs-built_in">Stat</span>(ctx context.Context, path string) (*FileInfo, error)
    
    <span class="hljs-comment">// åˆ—å‡ºæ–‡ä»¶</span>
    <span class="hljs-built_in">List</span>(ctx context.Context, path string) ([]*FileInfo, error)
}

type FileInfo struct {
    Name    string
    Size    int64
    ModTime <span class="hljs-selector-tag">time</span><span class="hljs-selector-class">.Time</span>
    IsDir   bool
}
```

### æœ¬åœ°å­˜å‚¨å®ç°

```go
<span class="hljs-comment">// pkg/filesystem/local.go</span>
type LocalDriver struct {
    rootPath string
}

func <span class="hljs-built_in">NewLocalDriver</span>(rootPath string) Driver {
    return &amp;LocalDriver{rootPath: rootPath}
}

func (d *LocalDriver) <span class="hljs-built_in">Put</span>(ctx context.Context, path string, file io.Reader) error {
    fullPath := filepath.<span class="hljs-built_in">Join</span>(d.rootPath, path)
    
    // ç¡®ä¿ç›®å½•å­˜åœ¨
    if err := os.<span class="hljs-built_in">MkdirAll</span>(filepath.<span class="hljs-built_in">Dir</span>(fullPath), <span class="hljs-number">0755</span>); err != nil {
        return fmt<span class="hljs-selector-class">.Errorf</span>("failed to create directory: %w", err)
    }
    
    <span class="hljs-comment">// åˆ›å»ºæ–‡ä»¶</span>
    dst, err := os.<span class="hljs-built_in">Create</span>(fullPath)
    if err != nil {
        return fmt<span class="hljs-selector-class">.Errorf</span>("failed to create file: %w", err)
    }
    defer dst<span class="hljs-selector-class">.Close</span>()
    
    <span class="hljs-comment">// å¤åˆ¶æ–‡ä»¶å†…å®¹</span>
    _, err = io<span class="hljs-selector-class">.Copy</span>(dst, file)
    if err != nil {
        return fmt<span class="hljs-selector-class">.Errorf</span>("failed to write file: %w", err)
    }
    
    return nil
}

func (d *LocalDriver) <span class="hljs-built_in">Get</span>(ctx context.Context, path string) (io.ReadCloser, error) {
    fullPath := filepath.<span class="hljs-built_in">Join</span>(d.rootPath, path)
    
    file, err := os.<span class="hljs-built_in">Open</span>(fullPath)
    if err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to open file: %w", err)
    }
    
    return file, nil
}
```

## èŠå¤©æœåŠ¡å®ç°

### OpenRouter å®¢æˆ·ç«¯

```go
<span class="hljs-comment">// pkg/openrouter/client.go</span>
type Client struct {
    apiKey     string
    baseURL    string
    httpClient *http<span class="hljs-selector-class">.Client</span>
    logger     logging<span class="hljs-selector-class">.Logger</span>
}

type ChatRequest struct {
    Model       string    `json:<span class="hljs-string">"model"</span>`
    Messages    []Message `json:<span class="hljs-string">"messages"</span>`
    Stream      bool      `json:<span class="hljs-string">"stream"</span>`
    Temperature float64   `json:<span class="hljs-string">"temperature"</span>`
    MaxTokens   int       `json:<span class="hljs-string">"max_tokens"</span>`
}

type Message struct {
    Role    string `json:<span class="hljs-string">"role"</span>`
    Content string `json:<span class="hljs-string">"content"</span>`
}

func (c *Client) <span class="hljs-built_in">Chat</span>(ctx context.Context, req ChatRequest) (*ChatResponse, error) {
    reqBody, err := json.<span class="hljs-built_in">Marshal</span>(req)
    if err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to marshal request: %w", err)
    }
    
    httpReq, err := http.<span class="hljs-built_in">NewRequestWithContext</span>(ctx, <span class="hljs-string">"POST"</span>, c.baseURL+<span class="hljs-string">"/chat/completions"</span>, bytes.<span class="hljs-built_in">NewReader</span>(reqBody))
    if err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to create request: %w", err)
    }
    
    httpReq<span class="hljs-selector-class">.Header</span><span class="hljs-selector-class">.Set</span>("Authorization", "Bearer "+c.apiKey)
    httpReq<span class="hljs-selector-class">.Header</span><span class="hljs-selector-class">.Set</span>("Content-Type", "application/json")
    
    resp, err := c.httpClient.<span class="hljs-built_in">Do</span>(httpReq)
    if err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to send request: %w", err)
    }
    defer resp<span class="hljs-selector-class">.Body</span><span class="hljs-selector-class">.Close</span>()
    
    <span class="hljs-selector-tag">var</span> chatResp ChatResponse
    if err := json.<span class="hljs-built_in">NewDecoder</span>(resp.Body).<span class="hljs-built_in">Decode</span>(&amp;chatResp); err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to decode response: %w", err)
    }
    
    return &amp;chatResp, nil
}
```

### æµå¼å“åº”å¤„ç†

```go
<span class="hljs-comment">// service/chat/chat.go</span>
type StreamCallback <span class="hljs-built_in">func</span>(content string, done bool) error

func (s *ChatService) <span class="hljs-built_in">StreamChat</span>(ctx context.Context, user *ent.User, message string, callback StreamCallback) error {
    req := openrouter.ChatRequest{
        Model: <span class="hljs-string">"google/gemini-2.5-pro"</span>,
        Messages: []openrouter.Message{
            {
                Role:    <span class="hljs-string">"system"</span>,
                Content: <span class="hljs-string">"ä½ æ˜¯ Cloudreve äº‘ç›˜çš„ AI åŠ©æ‰‹"</span>,
            },
            {
                Role:    <span class="hljs-string">"user"</span>,
                Content: message,
            },
        },
        Stream:      true,
        Temperature: <span class="hljs-number">0.7</span>,
        MaxTokens:   <span class="hljs-number">2000</span>,
    }
    
    return s<span class="hljs-selector-class">.client</span><span class="hljs-selector-class">.ChatStream</span>(ctx, req, callback)
}

<span class="hljs-comment">// åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨</span>
func <span class="hljs-built_in">ChatStream</span>(c *gin.Context) {
    <span class="hljs-comment">// è®¾ç½® SSE å“åº”å¤´</span>
    c<span class="hljs-selector-class">.Header</span>("Content-Type", "text/event-stream")
    c<span class="hljs-selector-class">.Header</span>("Cache-Control", "no-cache")
    c<span class="hljs-selector-class">.Header</span>("Connection", "keep-alive")
    
    <span class="hljs-comment">// è·å–å‚æ•°</span>
    service := ParametersFromContext[*chatsvc.Service](c, ChatParameterCtx)
    user := c.<span class="hljs-built_in">MustGet</span>(<span class="hljs-string">"user"</span>).(*ent.User)
    
    // åˆ›å»ºèŠå¤©æœåŠ¡
    chatService := chatsvc.<span class="hljs-built_in">NewChatService</span>(dep)
    
    // æµå¼å›è°ƒ
    callback := <span class="hljs-built_in">func</span>(content string, done bool) error {
        data := map[string]interface{}{
            "choices": []map[string]interface{}{
                {
                    "delta": map[string]interface{}{
                        "<span class="hljs-attribute">content</span>": content,
                    },
                    "finish_reason": nil,
                },
            },
        }
        
        if done {
            data<span class="hljs-selector-attr">[<span class="hljs-string">"choices"</span>]</span>.([]map[string]interface{})<span class="hljs-selector-attr">[0]</span><span class="hljs-selector-attr">[<span class="hljs-string">"finish_reason"</span>]</span> = "stop"
        }
        
        jsonData, _ := json.<span class="hljs-built_in">Marshal</span>(data)
        fmt.<span class="hljs-built_in">Fprintf</span>(c.Writer, <span class="hljs-string">"data: %s\n\n"</span>, jsonData)
        c.Writer.<span class="hljs-built_in">Flush</span>()
        
        return nil
    }
    
    <span class="hljs-comment">// æ‰§è¡Œæµå¼èŠå¤©</span>
    err := chatService.<span class="hljs-built_in">StreamChat</span>(c.Request.<span class="hljs-built_in">Context</span>(), user, service.Message, callback)
    if err != nil {
        c<span class="hljs-selector-class">.JSON</span>(http.StatusInternalServerError, gin.H{"error": err.Error()})
        return
    }
}
```

## é”™è¯¯å¤„ç†å’Œæ—¥å¿—

### ç»Ÿä¸€é”™è¯¯å¤„ç†

```go
<span class="hljs-comment">// pkg/errors/errors.go</span>
type AppError struct {
    <span class="hljs-selector-tag">Code</span>    int    `json:<span class="hljs-string">"code"</span>`
    Message string `json:<span class="hljs-string">"message"</span>`
    Details string `json:<span class="hljs-string">"details,omitempty"</span>`
}

func (e *AppError) <span class="hljs-built_in">Error</span>() string {
    return e<span class="hljs-selector-class">.Message</span>
}

func <span class="hljs-built_in">NewAppError</span>(code int, message string) *AppError {
    return &amp;AppError{
        <span class="hljs-selector-tag">Code</span>:    code,
        Message: message,
    }
}

<span class="hljs-comment">// é¢„å®šä¹‰é”™è¯¯</span>
<span class="hljs-selector-tag">var</span> (
    ErrUserNotFound     = NewAppError(<span class="hljs-number">404</span>, "User not found")
    ErrInvalidPassword  = <span class="hljs-built_in">NewAppError</span>(<span class="hljs-number">400</span>, "Invalid password")
    ErrUnauthorized     = <span class="hljs-built_in">NewAppError</span>(<span class="hljs-number">401</span>, "Unauthorized")
    ErrForbidden        = <span class="hljs-built_in">NewAppError</span>(<span class="hljs-number">403</span>, "Forbidden")
)
```

### ç»“æ„åŒ–æ—¥å¿—

```go
<span class="hljs-comment">// pkg/logging/logger.go</span>
type Logger interface {
    <span class="hljs-built_in">Debug</span>(msg string, fields ...Field)
    <span class="hljs-built_in">Info</span>(msg string, fields ...Field)
    <span class="hljs-built_in">Warn</span>(msg string, fields ...Field)
    <span class="hljs-built_in">Error</span>(msg string, fields ...Field)
    <span class="hljs-built_in">Fatal</span>(msg string, fields ...Field)
}

type Field struct {
    Key   string
    Value interface{}
}

func <span class="hljs-built_in">String</span>(key, value string) Field {
    return Field{Key: key, Value: value}
}

func <span class="hljs-built_in">Int</span>(key string, value int) Field {
    return Field{Key: key, Value: value}
}

<span class="hljs-comment">// ä½¿ç”¨æ–¹å¼</span>
logger<span class="hljs-selector-class">.Info</span>("User created successfully",
    String("user_id", user.ID),
    <span class="hljs-built_in">String</span>("email", user.Email),
    <span class="hljs-built_in">String</span>("ip", c.ClientIP()),
)
```

## é…ç½®ç®¡ç†

### é…ç½®ç»“æ„

```go
<span class="hljs-comment">// pkg/conf/conf.go</span>
type Config struct {
    System   SystemConfig   `mapstructure:<span class="hljs-string">"system"</span>`
    Database DatabaseConfig `mapstructure:<span class="hljs-string">"database"</span>`
    Redis    RedisConfig    `mapstructure:<span class="hljs-string">"redis"</span>`
    Storage  StorageConfig  `mapstructure:<span class="hljs-string">"storage"</span>`
}

type SystemConfig struct {
    Mode        string `mapstructure:<span class="hljs-string">"mode"</span>`
    Port        int    `mapstructure:<span class="hljs-string">"port"</span>`
    Debug       bool   `mapstructure:<span class="hljs-string">"debug"</span>`
    SessionName string `mapstructure:<span class="hljs-string">"session_name"</span>`
}

type DatabaseConfig struct {
    Type     string `mapstructure:<span class="hljs-string">"type"</span>`
    Host     string `mapstructure:<span class="hljs-string">"host"</span>`
    Port     int    `mapstructure:<span class="hljs-string">"port"</span>`
    User     string `mapstructure:<span class="hljs-string">"user"</span>`
    Password string `mapstructure:<span class="hljs-string">"password"</span>`
    Name     string `mapstructure:<span class="hljs-string">"name"</span>`
}

<span class="hljs-comment">// åŠ è½½é…ç½®</span>
func <span class="hljs-built_in">LoadConfig</span>(path string) (*Config, error) {
    viper<span class="hljs-selector-class">.SetConfigFile</span>(path)
    viper<span class="hljs-selector-class">.SetConfigType</span>("yaml")
    
    if err := viper.<span class="hljs-built_in">ReadInConfig</span>(); err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to read config: %w", err)
    }
    
    <span class="hljs-selector-tag">var</span> config Config
    if err := viper.<span class="hljs-built_in">Unmarshal</span>(&amp;config); err != nil {
        return nil, fmt<span class="hljs-selector-class">.Errorf</span>("failed to unmarshal config: %w", err)
    }
    
    return &amp;config, nil
}
```

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

```go
<span class="hljs-comment">// service/user/user_test.go</span>
func <span class="hljs-built_in">TestUserService_CreateUser</span>(t *testing.T) {
    <span class="hljs-comment">// è®¾ç½®æµ‹è¯•æ•°æ®åº“</span>
    client := enttest.<span class="hljs-built_in">Open</span>(t, <span class="hljs-string">"sqlite3"</span>, <span class="hljs-string">"file:ent?mode=memory&amp;cache=shared&amp;_fk=1"</span>)
    defer client.<span class="hljs-built_in">Close</span>()
    
    // åˆ›å»ºæœåŠ¡
    service := <span class="hljs-built_in">NewUserService</span>(client)
    
    // æµ‹è¯•æ•°æ®
    req := &amp;CreateUserRequest{
        Name:     <span class="hljs-string">"Test User"</span>,
        Email:    <span class="hljs-string">"test@example.com"</span>,
        Password: <span class="hljs-string">"password123"</span>,
    }
    
    <span class="hljs-comment">// æ‰§è¡Œæµ‹è¯•</span>
    user, err := service.<span class="hljs-built_in">CreateUser</span>(context.<span class="hljs-built_in">Background</span>(), req)
    
    // æ–­è¨€
    assert.<span class="hljs-built_in">NoError</span>(t, err)
    assert.<span class="hljs-built_in">NotNil</span>(t, user)
    assert.<span class="hljs-built_in">Equal</span>(t, req.Name, user.Name)
    assert.<span class="hljs-built_in">Equal</span>(t, req.Email, user.Email)
}
```

### é›†æˆæµ‹è¯•

```go
<span class="hljs-comment">// test/integration/api_test.go</span>
func <span class="hljs-built_in">TestUserAPI</span>(t *testing.T) {
    <span class="hljs-comment">// è®¾ç½®æµ‹è¯•æœåŠ¡å™¨</span>
    router := <span class="hljs-built_in">setupTestRouter</span>()
    
    // åˆ›å»ºç”¨æˆ·
    createReq := `{"name":<span class="hljs-string">"Test User"</span>,<span class="hljs-string">"email"</span>:<span class="hljs-string">"test@example.com"</span>,<span class="hljs-string">"password"</span>:<span class="hljs-string">"password123"</span>}`
    w := httptest.<span class="hljs-built_in">NewRecorder</span>()
    req, _ := http.<span class="hljs-built_in">NewRequest</span>(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"/api/v4/user"</span>, strings.<span class="hljs-built_in">NewReader</span>(createReq))
    req.Header.<span class="hljs-built_in">Set</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>)
    
    router.<span class="hljs-built_in">ServeHTTP</span>(w, req)
    
    assert.<span class="hljs-built_in">Equal</span>(t, http.StatusCreated, w.Code)
    
    var response map[string]interface{}
    json<span class="hljs-selector-class">.Unmarshal</span>(w.Body.Bytes(), &amp;response)
    
    assert<span class="hljs-selector-class">.Equal</span>(t, "Test User", response["data"].(map[string]interface{})<span class="hljs-selector-attr">[<span class="hljs-string">"name"</span>]</span>)
}
```

## æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–

```go
<span class="hljs-comment">// ä½¿ç”¨ç´¢å¼•</span>
func (User) <span class="hljs-built_in">Indexes</span>() <span class="hljs-selector-attr">[]</span>ent<span class="hljs-selector-class">.Index</span> {
    return <span class="hljs-selector-attr">[]</span>ent<span class="hljs-selector-class">.Index</span>{
        index<span class="hljs-selector-class">.Fields</span>("email")<span class="hljs-selector-class">.Unique</span>(),
        index<span class="hljs-selector-class">.Fields</span>("name", "created_at"),
    }
}

<span class="hljs-comment">// æ‰¹é‡æ“ä½œ</span>
func (s *UserService) <span class="hljs-built_in">CreateUsers</span>(ctx context.Context, users []*CreateUserRequest) ([]*ent.User, error) {
    bulk := <span class="hljs-built_in">make</span>([]*ent.UserCreate, <span class="hljs-built_in">len</span>(users))
    for i, req := range users {
        bulk<span class="hljs-selector-attr">[i]</span> = s<span class="hljs-selector-class">.client</span><span class="hljs-selector-class">.User</span><span class="hljs-selector-class">.Create</span>().
            <span class="hljs-built_in">SetName</span>(req.Name).
            <span class="hljs-built_in">SetEmail</span>(req.Email).
            <span class="hljs-built_in">SetPassword</span>(hashPassword(req.Password))
    }
    
    return s<span class="hljs-selector-class">.client</span><span class="hljs-selector-class">.User</span><span class="hljs-selector-class">.CreateBulk</span>(bulk...)<span class="hljs-selector-class">.Save</span>(ctx)
}

<span class="hljs-comment">// é¢„åŠ è½½å…³è”</span>
func (s *UserService) <span class="hljs-built_in">GetUserWithFiles</span>(ctx context.Context, id int) (*ent.User, error) {
    return s<span class="hljs-selector-class">.client</span><span class="hljs-selector-class">.User</span>.
        <span class="hljs-built_in">Query</span>().
        <span class="hljs-built_in">Where</span>(user.ID(id)).
        <span class="hljs-built_in">WithFiles</span>(func(q *ent.FileQuery) {
            <span class="hljs-selector-tag">q</span><span class="hljs-selector-class">.Order</span>(ent.Desc(file.FieldCreatedAt)).
              <span class="hljs-built_in">Limit</span>(<span class="hljs-number">10</span>)
        }).
        <span class="hljs-built_in">Only</span>(ctx)
}
```

### ç¼“å­˜ç­–ç•¥

```go
<span class="hljs-comment">// pkg/cache/cache.go</span>
type Cache interface {
    <span class="hljs-built_in">Get</span>(ctx context.Context, key string) (string, error)
    <span class="hljs-built_in">Set</span>(ctx context.Context, key string, value string, ttl time.Duration) error
    <span class="hljs-built_in">Delete</span>(ctx context.Context, key string) error
}

<span class="hljs-comment">// åœ¨æœåŠ¡ä¸­ä½¿ç”¨ç¼“å­˜</span>
func (s *UserService) <span class="hljs-built_in">GetUser</span>(ctx context.Context, id int) (*ent.User, error) {
    cacheKey := fmt.<span class="hljs-built_in">Sprintf</span>(<span class="hljs-string">"user:%d"</span>, id)
    
    // å°è¯•ä»ç¼“å­˜è·å–
    cached, err := s.cache.<span class="hljs-built_in">Get</span>(ctx, cacheKey)
    if err == nil {
        <span class="hljs-selector-tag">var</span> user ent<span class="hljs-selector-class">.User</span>
        if json<span class="hljs-selector-class">.Unmarshal</span>([]byte(cached), &amp;user) == nil {
            return &amp;user, nil
        }
    }
    
    <span class="hljs-comment">// ä»æ•°æ®åº“è·å–</span>
    user, err := s.client.User.<span class="hljs-built_in">Get</span>(ctx, id)
    if err != nil {
        return nil, err
    }
    
    <span class="hljs-comment">// å­˜å…¥ç¼“å­˜</span>
    if data, err := json.<span class="hljs-built_in">Marshal</span>(user); err == nil {
        s<span class="hljs-selector-class">.cache</span><span class="hljs-selector-class">.Set</span>(ctx, cacheKey, string(data), <span class="hljs-selector-tag">time</span><span class="hljs-selector-class">.Hour</span>)
    }
    
    return user, nil
}
```

## éƒ¨ç½²å’Œè¿ç»´

### Docker åŒ–

```dockerfile
# Dockerfile
FROM golang:<span class="hljs-number">1.23</span>-alpine AS builder

WORKDIR /app
COPY go.mod go.sum ./
RUN go mod download

COPY . .
RUN CGO_ENABLED=<span class="hljs-number">0</span> GOOS=linux go build -o cloudreve .

FROM alpine:latest
RUN apk --no-cache add ca-certificates
WORKDIR /root/

COPY --from=builder /app/cloudreve .
COPY --from=builder /app/conf.ini .

EXPOSE <span class="hljs-number">5212</span>
CMD [<span class="hljs-string">"./cloudreve"</span>]
```

### å¥åº·æ£€æŸ¥

```go
// routers/controllers/health.go
func <span class="hljs-built_in">HealthCheck</span>(c *gin.Context) {
    <span class="hljs-comment">// æ£€æŸ¥æ•°æ®åº“è¿æ¥</span>
    if err := <span class="hljs-built_in">checkDatabase</span>(); err != nil {
        c<span class="hljs-selector-class">.JSON</span>(http.StatusServiceUnavailable, gin.H{
            "status": "unhealthy",
            "error":  err.Error(),
        })
        return
    }
    
    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜è¿æ¥</span>
    if err := <span class="hljs-built_in">checkCache</span>(); err != nil {
        c<span class="hljs-selector-class">.JSON</span>(http.StatusServiceUnavailable, gin.H{
            "status": "unhealthy",
            "error":  err.Error(),
        })
        return
    }
    
    c<span class="hljs-selector-class">.JSON</span>(http.StatusOK, gin.H{
        "status": "healthy",
        "timestamp": time.Now()<span class="hljs-selector-class">.Unix</span>(),
    })
}
```

## æ€»ç»“

Cloudreve çš„åç«¯æ¶æ„å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

<span class="hljs-number">1</span>. **æ¸…æ™°çš„åˆ†å±‚è®¾è®¡**: è·¯ç”±ã€æ§åˆ¶å™¨ã€æœåŠ¡ã€æ•°æ®è®¿é—®å±‚èŒè´£åˆ†æ˜
<span class="hljs-number">2</span>. **ç°ä»£åŒ–çš„ ORM**: ä½¿ç”¨ Ent æä¾›ç±»å‹å®‰å…¨çš„æ•°æ®åº“æ“ä½œ
<span class="hljs-number">3</span>. **å®Œå–„çš„ä¸­é—´ä»¶ç³»ç»Ÿ**: è®¤è¯ã€æˆæƒã€æ—¥å¿—ã€é”™è¯¯å¤„ç†ç­‰
<span class="hljs-number">4</span>. **çµæ´»çš„å­˜å‚¨ç³»ç»Ÿ**: æ”¯æŒå¤šç§å­˜å‚¨åç«¯
<span class="hljs-number">5</span>. **å¼ºå¤§çš„èŠå¤©åŠŸèƒ½**: é›†æˆ OpenRouter API æ”¯æŒ AI å¯¹è¯
<span class="hljs-number">6</span>. **è‰¯å¥½çš„æµ‹è¯•è¦†ç›–**: å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
<span class="hljs-number">7</span>. **æ€§èƒ½ä¼˜åŒ–**: ç¼“å­˜ã€æ•°æ®åº“ä¼˜åŒ–ã€å¹¶å‘å¤„ç†

è¿™ä¸ªæ¶æ„ä¸ºä½ å¼€å‘ä¾§è¾¹æ å¯¹è¯åŠŸèƒ½æä¾›äº†åšå®çš„åŸºç¡€ï¼Œä½ å¯ä»¥å‚è€ƒç°æœ‰çš„èŠå¤©æœåŠ¡å®ç°æ¥æ‰©å±•æ–°åŠŸèƒ½ã€‚
</code></pre>
<h3 data-id="heading-6"><strong>04-api-communication.md - API é€šä¿¡æœºåˆ¶</strong></h3>
<ul>
<li>RESTful API è®¾è®¡è§„èŒƒ</li>
<li>JWT è®¤è¯æµç¨‹å’Œ SSE æµå¼ä¼ è¾“</li>
<li>é”™è¯¯å¤„ç†å’Œç¼“å­˜ç­–ç•¥</li>
</ul>

<pre><code class="hljs language-arduino" lang="arduino"># Cloudreve å‰åç«¯é€šä¿¡æœºåˆ¶è¯¦è§£

## API è®¾è®¡æ¦‚è§ˆ

Cloudreve é‡‡ç”¨ RESTful API è®¾è®¡ï¼Œå‰åç«¯é€šè¿‡ HTTP/HTTPS åè®®è¿›è¡Œé€šä¿¡ã€‚API éµå¾ªç»Ÿä¸€çš„è®¾è®¡è§„èŒƒï¼Œæä¾›æ¸…æ™°çš„æ¥å£å®šä¹‰å’Œé”™è¯¯å¤„ç†æœºåˆ¶ã€‚

### API ç‰ˆæœ¬ç®¡ç†

```
åŸºç¡€è·¯å¾„: /api/v4
å½“å‰ç‰ˆæœ¬: v4
```

æ‰€æœ‰ API è¯·æ±‚éƒ½ä½¿ç”¨ `/api/v4` ä½œä¸ºåŸºç¡€è·¯å¾„ï¼Œä¾¿äºç‰ˆæœ¬ç®¡ç†å’Œå‘åå…¼å®¹ã€‚

## è¯·æ±‚å“åº”æ ¼å¼

### ç»Ÿä¸€å“åº”æ ¼å¼

```typescript
interface Response&lt;T&gt; {
  data: T;           <span class="hljs-comment">// å“åº”æ•°æ®</span>
  code: number;      <span class="hljs-comment">// çŠ¶æ€ç </span>
  msg: string;       <span class="hljs-comment">// æ¶ˆæ¯</span>
  error?: string;    <span class="hljs-comment">// é”™è¯¯ä¿¡æ¯</span>
  correlation_id?: string; <span class="hljs-comment">// è¯·æ±‚è¿½è¸ªID</span>
}
```

### æˆåŠŸå“åº”ç¤ºä¾‹

```json
{
  <span class="hljs-string">"data"</span>: {
    <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"ç”¨æˆ·å"</span>,
    <span class="hljs-string">"email"</span>: <span class="hljs-string">"user@example.com"</span>
  },
  <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
  <span class="hljs-string">"msg"</span>: <span class="hljs-string">"success"</span>
}
```

### é”™è¯¯å“åº”ç¤ºä¾‹

```json
{
  <span class="hljs-string">"data"</span>: null,
  <span class="hljs-string">"code"</span>: <span class="hljs-number">400</span>,
  <span class="hljs-string">"msg"</span>: <span class="hljs-string">"å‚æ•°éªŒè¯å¤±è´¥"</span>,
  <span class="hljs-string">"error"</span>: <span class="hljs-string">"email field is required"</span>,
  <span class="hljs-string">"correlation_id"</span>: <span class="hljs-string">"req-123456789"</span>
}
```

## è®¤è¯æœºåˆ¶

### JWT Token è®¤è¯

```mermaid
sequenceDiagram
    participant C as å®¢æˆ·ç«¯
    participant S as æœåŠ¡å™¨
    participant DB as æ•°æ®åº“

    C-&gt;&gt;S: POST /api/v4/session/<span class="hljs-built_in">token</span> (ç”¨æˆ·å/å¯†ç )
    S-&gt;&gt;DB: éªŒè¯ç”¨æˆ·å‡­æ®
    DB--&gt;&gt;S: è¿”å›ç”¨æˆ·ä¿¡æ¯
    S--&gt;&gt;C: è¿”å› JWT Token
    
    Note over C: å­˜å‚¨ Token åˆ° localStorage
    
    C-&gt;&gt;S: GET /api/v4/user/<span class="hljs-built_in">info</span> (Authorization: Bearer &lt;token&gt;)
    S-&gt;&gt;S: éªŒè¯ Token
    S--&gt;&gt;C: è¿”å›ç”¨æˆ·ä¿¡æ¯
```

### Token ç®¡ç†

#### <span class="hljs-number">1.</span> è·å– Token

```typescript
<span class="hljs-comment">// å‰ç«¯ç™»å½•è¯·æ±‚</span>
<span class="hljs-type">const</span> loginRequest = {
  email: <span class="hljs-string">"user@example.com"</span>,
  password: <span class="hljs-string">"password123"</span>
};

<span class="hljs-type">const</span> response = await axios.<span class="hljs-built_in">post</span>(<span class="hljs-string">'/api/v4/session/token'</span>, loginRequest);
<span class="hljs-type">const</span> { access_token, refresh_token } = response.data;

<span class="hljs-comment">// å­˜å‚¨ Token</span>
SessionManager.<span class="hljs-built_in">setTokens</span>(access_token, refresh_token);
```

#### <span class="hljs-number">2.</span> è¯·æ±‚æ‹¦æˆªå™¨

```typescript
<span class="hljs-comment">// api/request.ts</span>
instance.interceptors.request.<span class="hljs-built_in">use</span>(<span class="hljs-built_in">async</span> (config) =&gt; {
  <span class="hljs-type">const</span> token = await SessionManager.<span class="hljs-built_in">getAccessToken</span>();
  <span class="hljs-keyword">if</span> (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  <span class="hljs-keyword">return</span> config;
});
```

#### <span class="hljs-number">3.</span> Token åˆ·æ–°æœºåˆ¶

```typescript
instance.interceptors.response.<span class="hljs-built_in">use</span>(
  (response) =&gt; response,
  <span class="hljs-built_in">async</span> (error) =&gt; {
    <span class="hljs-keyword">if</span> (error.response?.status === <span class="hljs-number">401</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// å°è¯•åˆ·æ–° Token</span>
        await SessionManager.<span class="hljs-built_in">refreshToken</span>();
        <span class="hljs-comment">// é‡è¯•åŸè¯·æ±‚</span>
        <span class="hljs-keyword">return</span> instance.<span class="hljs-built_in">request</span>(error.config);
      } <span class="hljs-built_in">catch</span> (refreshError) {
        <span class="hljs-comment">// åˆ·æ–°å¤±è´¥ï¼Œè·³è½¬ç™»å½•é¡µ</span>
        router.<span class="hljs-built_in">push</span>(<span class="hljs-string">'/session'</span>);
      }
    }
    <span class="hljs-keyword">return</span> Promise.<span class="hljs-built_in">reject</span>(error);
  }
);
```

## æ ¸å¿ƒ API æ¥å£

### <span class="hljs-number">1.</span> ç”¨æˆ·è®¤è¯ API

#### ç™»å½•
```http
POST /api/v4/session/token
Content-Type: application/json

{
  <span class="hljs-string">"email"</span>: <span class="hljs-string">"user@example.com"</span>,
  <span class="hljs-string">"password"</span>: <span class="hljs-string">"password123"</span>
}
```

å“åº”ï¼š
```json
{
  <span class="hljs-string">"data"</span>: {
    <span class="hljs-string">"access_token"</span>: <span class="hljs-string">"eyJhbGciOiJIUzI1NiIs..."</span>,
    <span class="hljs-string">"refresh_token"</span>: <span class="hljs-string">"eyJhbGciOiJIUzI1NiIs..."</span>,
    <span class="hljs-string">"expires_in"</span>: <span class="hljs-number">3600</span>,
    <span class="hljs-string">"user"</span>: {
      <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"ç”¨æˆ·å"</span>,
      <span class="hljs-string">"email"</span>: <span class="hljs-string">"user@example.com"</span>
    }
  },
  <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
  <span class="hljs-string">"msg"</span>: <span class="hljs-string">"ç™»å½•æˆåŠŸ"</span>
}
```

#### åˆ·æ–° Token
```http
POST /api/v4/session/refresh
Content-Type: application/json

{
  <span class="hljs-string">"refresh_token"</span>: <span class="hljs-string">"eyJhbGciOiJIUzI1NiIs..."</span>
}
```

#### ç™»å‡º
```http
DELETE /api/v4/session/token
Authorization: Bearer &lt;access_token&gt;
```

### <span class="hljs-number">2.</span> æ–‡ä»¶ç®¡ç† API

#### è·å–æ–‡ä»¶åˆ—è¡¨
```http
GET /api/v4/file/list?path=/documents&amp;sort=name&amp;order=asc
Authorization: Bearer &lt;access_token&gt;
```

å“åº”ï¼š
```json
{
  <span class="hljs-string">"data"</span>: {
    <span class="hljs-string">"files"</span>: [
      {
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"file_123"</span>,
        <span class="hljs-string">"name"</span>: <span class="hljs-string">"document.pdf"</span>,
        <span class="hljs-string">"size"</span>: <span class="hljs-number">1024000</span>,
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"file"</span>,
        <span class="hljs-string">"created_at"</span>: <span class="hljs-string">"2023-01-01T00:00:00Z"</span>,
        <span class="hljs-string">"path"</span>: <span class="hljs-string">"cloudreve://my/documents/document.pdf"</span>
      }
    ],
    <span class="hljs-string">"total"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-string">"path"</span>: <span class="hljs-string">"/documents"</span>
  },
  <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
  <span class="hljs-string">"msg"</span>: <span class="hljs-string">"success"</span>
}
```

#### æ–‡ä»¶ä¸Šä¼ 
```http
POST /api/v4/file/upload
Authorization: Bearer &lt;access_token&gt;
Content-Type: multipart/form-data

file: &lt;binary_data&gt;
path: /documents
```

#### æ–‡ä»¶ä¸‹è½½
```http
GET /api/v4/file/download/&lt;file_id&gt;
Authorization: Bearer &lt;access_token&gt;
```

### <span class="hljs-number">3.</span> èŠå¤© API

#### æ™®é€šèŠå¤©
```http
POST /api/v4/chat
Authorization: Bearer &lt;access_token&gt;
Content-Type: application/json

{
  <span class="hljs-string">"message"</span>: <span class="hljs-string">"è¯·å¸®æˆ‘æ€»ç»“ä¸€ä¸‹æ–‡æ¡£å†…å®¹"</span>
}
```

å“åº”ï¼š
```json
{
  <span class="hljs-string">"data"</span>: {
    <span class="hljs-string">"response"</span>: <span class="hljs-string">"æ ¹æ®æ‚¨çš„æ–‡æ¡£å†…å®¹ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–¹é¢..."</span>,
    <span class="hljs-string">"model"</span>: <span class="hljs-string">"google/gemini-2.5-pro"</span>,
    <span class="hljs-string">"usage"</span>: {
      <span class="hljs-string">"prompt_tokens"</span>: <span class="hljs-number">100</span>,
      <span class="hljs-string">"completion_tokens"</span>: <span class="hljs-number">200</span>,
      <span class="hljs-string">"total_tokens"</span>: <span class="hljs-number">300</span>
    }
  },
  <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
  <span class="hljs-string">"msg"</span>: <span class="hljs-string">"success"</span>
}
```

#### æµå¼èŠå¤©
```http
POST /api/v4/chat/stream
Authorization: Bearer &lt;access_token&gt;
Content-Type: application/json

{
  <span class="hljs-string">"message"</span>: <span class="hljs-string">"è¯·å¸®æˆ‘åˆ†æè¿™äº›æ–‡ä»¶"</span>
}
```

å“åº”ï¼ˆSSE æ ¼å¼ï¼‰ï¼š
```
Content-Type: text/event-stream
Cache-Control: no-cache
Connection: keep-alive

data: {<span class="hljs-string">"choices"</span>:[{<span class="hljs-string">"delta"</span>:{<span class="hljs-string">"content"</span>:<span class="hljs-string">"æ ¹æ®"</span>},<span class="hljs-string">"finish_reason"</span>:null}]}

data: {<span class="hljs-string">"choices"</span>:[{<span class="hljs-string">"delta"</span>:{<span class="hljs-string">"content"</span>:<span class="hljs-string">"æ‚¨çš„"</span>},<span class="hljs-string">"finish_reason"</span>:null}]}

data: {<span class="hljs-string">"choices"</span>:[{<span class="hljs-string">"delta"</span>:{<span class="hljs-string">"content"</span>:<span class="hljs-string">"æ–‡ä»¶"</span>},<span class="hljs-string">"finish_reason"</span>:null}]}

data: {<span class="hljs-string">"choices"</span>:[{<span class="hljs-string">"delta"</span>:{<span class="hljs-string">"content"</span>:<span class="hljs-string">""</span>},<span class="hljs-string">"finish_reason"</span>:<span class="hljs-string">"stop"</span>}]}
```

## é”™è¯¯å¤„ç†æœºåˆ¶

### HTTP çŠ¶æ€ç è§„èŒƒ

| çŠ¶æ€ç  | å«ä¹‰ | ä½¿ç”¨åœºæ™¯ |
|--------|------|----------|
| <span class="hljs-number">200</span> | æˆåŠŸ | è¯·æ±‚æˆåŠŸå¤„ç† |
| <span class="hljs-number">201</span> | åˆ›å»ºæˆåŠŸ | èµ„æºåˆ›å»ºæˆåŠŸ |
| <span class="hljs-number">400</span> | è¯·æ±‚é”™è¯¯ | å‚æ•°éªŒè¯å¤±è´¥ |
| <span class="hljs-number">401</span> | æœªè®¤è¯ | Token æ— æ•ˆæˆ–è¿‡æœŸ |
| <span class="hljs-number">403</span> | æƒé™ä¸è¶³ | æ²¡æœ‰è®¿é—®æƒé™ |
| <span class="hljs-number">404</span> | èµ„æºä¸å­˜åœ¨ | è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ |
| <span class="hljs-number">409</span> | å†²çª | èµ„æºå†²çªï¼ˆå¦‚é‚®ç®±å·²å­˜åœ¨ï¼‰ |
| <span class="hljs-number">422</span> | éªŒè¯å¤±è´¥ | ä¸šåŠ¡é€»è¾‘éªŒè¯å¤±è´¥ |
| <span class="hljs-number">500</span> | æœåŠ¡å™¨é”™è¯¯ | å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ |

### é”™è¯¯å“åº”æ ¼å¼

```typescript
interface ErrorResponse {
  code: number;
  msg: string;
  error?: string;
  details?: {
    field: string;
    message: string;
  }[];
  correlation_id?: string;
}
```

### å‰ç«¯é”™è¯¯å¤„ç†

```typescript
<span class="hljs-comment">// å…¨å±€é”™è¯¯å¤„ç†</span>
instance.interceptors.response.<span class="hljs-built_in">use</span>(
  (response) =&gt; response,
  (error) =&gt; {
    <span class="hljs-type">const</span> { response } = error;
    
    <span class="hljs-keyword">if</span> (response) {
      <span class="hljs-type">const</span> { status, data } = response;
      
      <span class="hljs-keyword">switch</span> (status) {
        <span class="hljs-keyword">case</span> <span class="hljs-number">400</span>:
          <span class="hljs-built_in">enqueueSnackbar</span>(data.msg || <span class="hljs-string">'è¯·æ±‚å‚æ•°é”™è¯¯'</span>, { variant: <span class="hljs-string">'error'</span> });
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">401</span>:
          <span class="hljs-built_in">enqueueSnackbar</span>(<span class="hljs-string">'ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•'</span>, { variant: <span class="hljs-string">'error'</span> });
          router.<span class="hljs-built_in">push</span>(<span class="hljs-string">'/session'</span>);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">403</span>:
          <span class="hljs-built_in">enqueueSnackbar</span>(<span class="hljs-string">'æƒé™ä¸è¶³'</span>, { variant: <span class="hljs-string">'error'</span> });
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">404</span>:
          <span class="hljs-built_in">enqueueSnackbar</span>(<span class="hljs-string">'è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨'</span>, { variant: error<span class="hljs-number">'</span> });
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">500</span>:
          <span class="hljs-built_in">enqueueSnackbar</span>(<span class="hljs-string">'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'</span>, { variant: <span class="hljs-string">'error'</span> });
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
          <span class="hljs-built_in">enqueueSnackbar</span>(data.msg || <span class="hljs-string">'æœªçŸ¥é”™è¯¯'</span>, { variant: <span class="hljs-string">'error'</span> });
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">enqueueSnackbar</span>(<span class="hljs-string">'ç½‘ç»œè¿æ¥é”™è¯¯'</span>, { variant: <span class="hljs-string">'error'</span> });
    }
    
    <span class="hljs-keyword">return</span> Promise.<span class="hljs-built_in">reject</span>(error);
  }
);
```

## æµå¼æ•°æ®ä¼ è¾“

### <span class="hljs-built_in">Server</span>-<span class="hljs-function">Sent <span class="hljs-title">Events</span> <span class="hljs-params">(SSE)</span>

Cloudreve ä½¿ç”¨ SSE åè®®å®ç°æµå¼æ•°æ®ä¼ è¾“ï¼Œä¸»è¦ç”¨äºèŠå¤©åŠŸèƒ½çš„å®æ—¶å“åº”ã€‚

#### å‰ç«¯ SSE å¤„ç†

```typescript
<span class="hljs-comment">// æµå¼èŠå¤©å®ç°</span>
<span class="hljs-keyword">export</span> <span class="hljs-type">const</span> streamChat </span>= <span class="hljs-built_in">async</span> (
  message: string,
  onMessage: (content: string) =&gt; <span class="hljs-type">void</span>,
  onComplete: () =&gt; <span class="hljs-type">void</span>,
  onError: (error: Error) =&gt; <span class="hljs-type">void</span>
) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-type">const</span> token = await SessionManager.<span class="hljs-built_in">getAccessToken</span>();
    
    <span class="hljs-type">const</span> response = await <span class="hljs-built_in">fetch</span>(<span class="hljs-string">'/api/v4/chat/stream'</span>, {
      method: <span class="hljs-string">'POST'</span>,
      headers: {
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
        <span class="hljs-string">'Authorization'</span>: `Bearer ${token}`,
      },
      body: JSON.<span class="hljs-built_in">stringify</span>({ message }),
    });
    
    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(`HTTP ${response.status}: ${response.statusText}`);
    }
    
    <span class="hljs-type">const</span> reader = response.body?.<span class="hljs-built_in">getReader</span>();
    <span class="hljs-type">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-built_in">TextDecoder</span>();
    
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
      <span class="hljs-type">const</span> { done, value } = await reader!.<span class="hljs-built_in">read</span>();
      
      <span class="hljs-keyword">if</span> (done) {
        <span class="hljs-built_in">onComplete</span>();
        <span class="hljs-keyword">break</span>;
      }
      
      <span class="hljs-type">const</span> chunk = decoder.<span class="hljs-built_in">decode</span>(value);
      <span class="hljs-type">const</span> lines = chunk.<span class="hljs-built_in">split</span>(<span class="hljs-string">'\n'</span>);
      
      <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> line of lines) {
        <span class="hljs-keyword">if</span> (line.<span class="hljs-built_in">startsWith</span>(<span class="hljs-string">'data: '</span>)) {
          <span class="hljs-type">const</span> data = line.<span class="hljs-built_in">slice</span>(<span class="hljs-number">6</span>);
          
          <span class="hljs-keyword">if</span> (data === <span class="hljs-string">'[DONE]'</span>) {
            <span class="hljs-built_in">onComplete</span>();
            <span class="hljs-keyword">return</span>;
          }
          
          <span class="hljs-keyword">try</span> {
            <span class="hljs-type">const</span> parsed = JSON.<span class="hljs-built_in">parse</span>(data);
            <span class="hljs-type">const</span> content = parsed.choices?.[<span class="hljs-number">0</span>]?.delta?.content;
            
            <span class="hljs-keyword">if</span> (content) {
              <span class="hljs-built_in">onMessage</span>(content);
            }
            
            <span class="hljs-keyword">if</span> (parsed.choices?.[<span class="hljs-number">0</span>]?.finish_reason === <span class="hljs-string">'stop'</span>) {
              <span class="hljs-built_in">onComplete</span>();
              <span class="hljs-keyword">return</span>;
            }
          } <span class="hljs-built_in">catch</span> (parseError) {
            console.<span class="hljs-built_in">warn</span>(<span class="hljs-string">'Failed to parse SSE data:'</span>, data);
          }
        }
      }
    }
  } <span class="hljs-built_in">catch</span> (error) {
    <span class="hljs-built_in">onError</span>(error as Error);
  }
};
```

#### åç«¯ SSE å®ç°

```go
<span class="hljs-comment">// æ§åˆ¶å™¨ä¸­çš„æµå¼å“åº”</span>
<span class="hljs-function">func <span class="hljs-title">ChatStream</span><span class="hljs-params">(c *gin.Context)</span> </span>{
    <span class="hljs-comment">// è®¾ç½® SSE å“åº”å¤´</span>
    c.<span class="hljs-built_in">Header</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/event-stream"</span>)
    c.<span class="hljs-built_in">Header</span>(<span class="hljs-string">"Cache-Control"</span>, <span class="hljs-string">"no-cache"</span>)
    c.<span class="hljs-built_in">Header</span>(<span class="hljs-string">"Connection"</span>, <span class="hljs-string">"keep-alive"</span>)
    c.<span class="hljs-built_in">Header</span>(<span class="hljs-string">"Access-Control-Allow-Origin"</span>, <span class="hljs-string">"*"</span>)
    
    <span class="hljs-comment">// è·å–å‚æ•°</span>
    service := ParametersFromContext[*chatsvc.Service](c, ChatParameterCtx)
    user := c.<span class="hljs-built_in">MustGet</span>(<span class="hljs-string">"user"</span>).(*ent.User)
    
    <span class="hljs-comment">// åˆ›å»ºèŠå¤©æœåŠ¡</span>
    chatService := chatsvc.<span class="hljs-built_in">NewChatService</span>(dep)
    
    <span class="hljs-comment">// æµå¼å›è°ƒå‡½æ•°</span>
    callback := <span class="hljs-built_in">func</span>(content string, done <span class="hljs-type">bool</span>) error {
        data := map[string]interface{}{
            <span class="hljs-string">"id"</span>:      <span class="hljs-string">"chatcmpl-"</span> + <span class="hljs-built_in">generateID</span>(),
            <span class="hljs-string">"object"</span>:  <span class="hljs-string">"chat.completion.chunk"</span>,
            <span class="hljs-string">"created"</span>: time.<span class="hljs-built_in">Now</span>().<span class="hljs-built_in">Unix</span>(),
            <span class="hljs-string">"model"</span>:   <span class="hljs-string">"google/gemini-2.5-pro"</span>,
            <span class="hljs-string">"choices"</span>: []map[string]interface{}{
                {
                    <span class="hljs-string">"index"</span>: <span class="hljs-number">0</span>,
                    <span class="hljs-string">"delta"</span>: map[string]interface{}{
                        <span class="hljs-string">"content"</span>: content,
                    },
                    <span class="hljs-string">"finish_reason"</span>: nil,
                },
            },
        }
        
        <span class="hljs-keyword">if</span> done {
            data[<span class="hljs-string">"choices"</span>].([]map[string]interface{})[<span class="hljs-number">0</span>][<span class="hljs-string">"finish_reason"</span>] = <span class="hljs-string">"stop"</span>
        }
        
        jsonData, _ := json.<span class="hljs-built_in">Marshal</span>(data)
        fmt.<span class="hljs-built_in">Fprintf</span>(c.Writer, <span class="hljs-string">"data: %s\n\n"</span>, jsonData)
        c.Writer.<span class="hljs-built_in">Flush</span>()
        
        <span class="hljs-keyword">return</span> nil
    }
    
    <span class="hljs-comment">// æ‰§è¡Œæµå¼èŠå¤©</span>
    err := chatService.<span class="hljs-built_in">StreamChatWithFiles</span>(c.Request.<span class="hljs-built_in">Context</span>(), user, service.Message, callback)
    <span class="hljs-keyword">if</span> err != nil {
        errorData := map[string]interface{}{
            <span class="hljs-string">"error"</span>: map[string]interface{}{
                <span class="hljs-string">"message"</span>: err.<span class="hljs-built_in">Error</span>(),
                <span class="hljs-string">"type"</span>:    <span class="hljs-string">"server_error"</span>,
            },
        }
        jsonData, _ := json.<span class="hljs-built_in">Marshal</span>(errorData)
        fmt.<span class="hljs-built_in">Fprintf</span>(c.Writer, <span class="hljs-string">"data: %s\n\n"</span>, jsonData)
        c.Writer.<span class="hljs-built_in">Flush</span>()
    }
    
    <span class="hljs-comment">// å‘é€ç»“æŸæ ‡è®°</span>
    fmt.<span class="hljs-built_in">Fprintf</span>(c.Writer, <span class="hljs-string">"data: [DONE]\n\n"</span>)
    c.Writer.<span class="hljs-built_in">Flush</span>()
}
```

## æ–‡ä»¶ä¸Šä¼ æœºåˆ¶

### åˆ†ç‰‡ä¸Šä¼ 

å¯¹äºå¤§æ–‡ä»¶ï¼ŒCloudreve æ”¯æŒåˆ†ç‰‡ä¸Šä¼ æœºåˆ¶ï¼š

```mermaid
sequenceDiagram
    participant C as å®¢æˆ·ç«¯
    participant S as æœåŠ¡å™¨
    participant FS as æ–‡ä»¶ç³»ç»Ÿ

    C-&gt;&gt;S: <span class="hljs-number">1.</span> åˆ›å»ºä¸Šä¼ ä¼šè¯
    S--&gt;&gt;C: è¿”å› session_id
    
    loop åˆ†ç‰‡ä¸Šä¼ 
        C-&gt;&gt;S: <span class="hljs-number">2.</span> ä¸Šä¼ åˆ†ç‰‡ (session_id, chunk_index, chunk_data)
        S-&gt;&gt;FS: å­˜å‚¨åˆ†ç‰‡
        S--&gt;&gt;C: è¿”å›ä¸Šä¼ è¿›åº¦
    end
    
    C-&gt;&gt;S: <span class="hljs-number">3.</span> å®Œæˆä¸Šä¼  (session_id)
    S-&gt;&gt;FS: åˆå¹¶åˆ†ç‰‡
    S--&gt;&gt;C: è¿”å›æ–‡ä»¶ä¿¡æ¯
```

#### å‰ç«¯åˆ†ç‰‡ä¸Šä¼ å®ç°

```typescript
<span class="hljs-keyword">export</span> <span class="hljs-type">const</span> uploadFileWithProgress = <span class="hljs-built_in">async</span> (
  file: <span class="hljs-built_in">File</span>,
  path: string,
  onProgress: (progress: number) =&gt; <span class="hljs-type">void</span>
): Promise&lt;FileResponse&gt; =&gt; {
  <span class="hljs-type">const</span> CHUNK_SIZE = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>; <span class="hljs-comment">// 1MB per chunk</span>
  <span class="hljs-type">const</span> totalChunks = Math.<span class="hljs-built_in">ceil</span>(file.size / CHUNK_SIZE);
  
  <span class="hljs-comment">// 1. åˆ›å»ºä¸Šä¼ ä¼šè¯</span>
  <span class="hljs-type">const</span> sessionResponse = await api.<span class="hljs-built_in">post</span>(<span class="hljs-string">'/file/upload/session'</span>, {
    name: file.name,
    size: file.size,
    path: path,
    chunks: totalChunks,
  });
  
  <span class="hljs-type">const</span> sessionId = sessionResponse.data.session_id;
  
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// 2. åˆ†ç‰‡ä¸Šä¼ </span>
    <span class="hljs-keyword">for</span> (let i = <span class="hljs-number">0</span>; i &lt; totalChunks; i++) {
      <span class="hljs-type">const</span> start = i * CHUNK_SIZE;
      <span class="hljs-type">const</span> end = Math.<span class="hljs-built_in">min</span>(start + CHUNK_SIZE, file.size);
      <span class="hljs-type">const</span> chunk = file.<span class="hljs-built_in">slice</span>(start, end);
      
      <span class="hljs-type">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">FormData</span>();
      formData.<span class="hljs-built_in">append</span>(<span class="hljs-string">'chunk'</span>, chunk);
      formData.<span class="hljs-built_in">append</span>(<span class="hljs-string">'session_id'</span>, sessionId);
      formData.<span class="hljs-built_in">append</span>(<span class="hljs-string">'chunk_index'</span>, i.<span class="hljs-built_in">toString</span>());
      
      await api.<span class="hljs-built_in">post</span>(<span class="hljs-string">'/file/upload/chunk'</span>, formData, {
        headers: {
          <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'multipart/form-data'</span>,
        },
      });
      
      <span class="hljs-comment">// æ›´æ–°è¿›åº¦</span>
      <span class="hljs-type">const</span> progress = Math.<span class="hljs-built_in">round</span>(((i + <span class="hljs-number">1</span>) / totalChunks) * <span class="hljs-number">100</span>);
      <span class="hljs-built_in">onProgress</span>(progress);
    }
    
    <span class="hljs-comment">// 3. å®Œæˆä¸Šä¼ </span>
    <span class="hljs-type">const</span> completeResponse = await api.<span class="hljs-built_in">post</span>(<span class="hljs-string">'/file/upload/complete'</span>, {
      session_id: sessionId,
    });
    
    <span class="hljs-keyword">return</span> completeResponse.data;
  } <span class="hljs-built_in">catch</span> (error) {
    <span class="hljs-comment">// ä¸Šä¼ å¤±è´¥ï¼Œæ¸…ç†ä¼šè¯</span>
    await api.<span class="hljs-built_in">delete</span>(`/file/upload/session/${sessionId}`);
    <span class="hljs-keyword">throw</span> error;
  }
};
```

## ç¼“å­˜ç­–ç•¥

### å‰ç«¯ç¼“å­˜

#### <span class="hljs-number">1.</span> HTTP ç¼“å­˜

```typescript
<span class="hljs-comment">// ä¸ºé™æ€èµ„æºè®¾ç½®ç¼“å­˜</span>
<span class="hljs-type">const</span> cacheableRequests = [
  <span class="hljs-string">'/api/v4/site/config'</span>,
  <span class="hljs-string">'/api/v4/user/info'</span>,
];

instance.interceptors.request.<span class="hljs-built_in">use</span>((config) =&gt; {
  <span class="hljs-keyword">if</span> (cacheableRequests.<span class="hljs-built_in">some</span>(url =&gt; config.url?.<span class="hljs-built_in">includes</span>(url))) {
    config.headers[<span class="hljs-string">'Cache-Control'</span>] = <span class="hljs-string">'max-age=300'</span>; <span class="hljs-comment">// 5åˆ†é’Ÿç¼“å­˜</span>
  }
  <span class="hljs-keyword">return</span> config;
});
```

#### <span class="hljs-number">2.</span> å†…å­˜ç¼“å­˜

```typescript
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ApiCache</span> {
  <span class="hljs-keyword">private</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>&lt;string, { data: any; expires: number }&gt;();
  
  <span class="hljs-built_in">get</span>(key: string): any | null {
    <span class="hljs-type">const</span> item = <span class="hljs-keyword">this</span>.cache.<span class="hljs-built_in">get</span>(key);
    <span class="hljs-keyword">if</span> (!item || Date.<span class="hljs-built_in">now</span>() &gt; item.expires) {
      <span class="hljs-keyword">this</span>.cache.<span class="hljs-built_in">delete</span>(key);
      <span class="hljs-keyword">return</span> null;
    }
    <span class="hljs-keyword">return</span> item.data;
  }
  
  <span class="hljs-built_in">set</span>(key: string, data: any, ttl: number = <span class="hljs-number">300000</span>): <span class="hljs-type">void</span> {
    <span class="hljs-keyword">this</span>.cache.<span class="hljs-built_in">set</span>(key, {
      data,
      expires: Date.<span class="hljs-built_in">now</span>() + ttl,
    });
  }
  
  <span class="hljs-built_in">clear</span>(): <span class="hljs-type">void</span> {
    <span class="hljs-keyword">this</span>.cache.<span class="hljs-built_in">clear</span>();
  }
}

<span class="hljs-type">const</span> apiCache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ApiCache</span>();

<span class="hljs-comment">// åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­ä½¿ç”¨ç¼“å­˜</span>
instance.interceptors.request.<span class="hljs-built_in">use</span>((config) =&gt; {
  <span class="hljs-keyword">if</span> (config.method === <span class="hljs-string">'GET'</span>) {
    <span class="hljs-type">const</span> cacheKey = `${config.url}?${JSON.<span class="hljs-built_in">stringify</span>(config.params)}`;
    <span class="hljs-type">const</span> cached = apiCache.<span class="hljs-built_in">get</span>(cacheKey);
    
    <span class="hljs-keyword">if</span> (cached) {
      <span class="hljs-comment">// è¿”å›ç¼“å­˜çš„ Promise</span>
      <span class="hljs-keyword">return</span> Promise.<span class="hljs-built_in">resolve</span>({
        ...config,
        adapter: () =&gt; Promise.<span class="hljs-built_in">resolve</span>({
          data: cached,
          status: <span class="hljs-number">200</span>,
          statusText: <span class="hljs-string">'OK'</span>,
          headers: {},
          config,
        }),
      });
    }
  }
  
  <span class="hljs-keyword">return</span> config;
});
```

### åç«¯ç¼“å­˜

```go
<span class="hljs-comment">// ç¼“å­˜ä¸­é—´ä»¶</span>
<span class="hljs-function">func <span class="hljs-title">CacheMiddleware</span><span class="hljs-params">(ttl time.Duration)</span> gin.HandlerFunc </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">func</span>(c *gin.Context) {
        <span class="hljs-keyword">if</span> c.Request.Method != <span class="hljs-string">"GET"</span> {
            c.<span class="hljs-built_in">Next</span>()
            <span class="hljs-keyword">return</span>
        }
        
        cacheKey := fmt.<span class="hljs-built_in">Sprintf</span>(<span class="hljs-string">"api:%s:%s"</span>, c.Request.URL.Path, c.Request.URL.RawQuery)
        
        <span class="hljs-comment">// å°è¯•ä»ç¼“å­˜è·å–</span>
        <span class="hljs-keyword">if</span> cached, err := cache.<span class="hljs-built_in">Get</span>(c.Request.<span class="hljs-built_in">Context</span>(), cacheKey); err == nil {
            c.<span class="hljs-built_in">Header</span>(<span class="hljs-string">"X-Cache"</span>, <span class="hljs-string">"HIT"</span>)
            c.<span class="hljs-built_in">Data</span>(<span class="hljs-number">200</span>, <span class="hljs-string">"application/json"</span>, []<span class="hljs-built_in">byte</span>(cached))
            <span class="hljs-keyword">return</span>
        }
        
        <span class="hljs-comment">// åŒ…è£… ResponseWriter ä»¥æ•è·å“åº”</span>
        w := &amp;responseWriter{
            ResponseWriter: c.Writer,
            body:          &amp;bytes.Buffer{},
        }
        c.Writer = w
        
        c.<span class="hljs-built_in">Next</span>()
        
        <span class="hljs-comment">// ç¼“å­˜å“åº”</span>
        <span class="hljs-keyword">if</span> w.status == <span class="hljs-number">200</span> {
            cache.<span class="hljs-built_in">Set</span>(c.Request.<span class="hljs-built_in">Context</span>(), cacheKey, w.body.<span class="hljs-built_in">String</span>(), ttl)
        }
    }
}
```

## è·¨åŸŸå¤„ç†

### CORS é…ç½®

```go
<span class="hljs-comment">// middleware/cors.go</span>
func <span class="hljs-built_in">CORS</span>() gin.HandlerFunc {
    <span class="hljs-keyword">return</span> cors.<span class="hljs-built_in">New</span>(cors.Config{
        AllowOrigins:     []string{<span class="hljs-string">"http://localhost:3000"</span>, <span class="hljs-string">"https://yourdomain.com"</span>},
        AllowMethods:     []string{<span class="hljs-string">"GET"</span>, <span class="hljs-string">"POST"</span>, <span class="hljs-string">"PUT"</span>, <span class="hljs-string">"DELETE"</span>, <span class="hljs-string">"OPTIONS"</span>},
        AllowHeaders:     []string{<span class="hljs-string">"Origin"</span>, <span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"Authorization"</span>},
        ExposeHeaders:    []string{<span class="hljs-string">"Content-Length"</span>},
        AllowCredentials: <span class="hljs-literal">true</span>,
        MaxAge:           <span class="hljs-number">12</span> * time.Hour,
    })
}
```

### é¢„æ£€è¯·æ±‚å¤„ç†

```typescript
<span class="hljs-comment">// å‰ç«¯å¤„ç†é¢„æ£€è¯·æ±‚</span>
axios.defaults.withCredentials = <span class="hljs-literal">true</span>;

<span class="hljs-comment">// è‡ªå®šä¹‰é¢„æ£€è¯·æ±‚å¤„ç†</span>
instance.interceptors.request.<span class="hljs-built_in">use</span>((config) =&gt; {
  <span class="hljs-comment">// å¯¹äºå¤æ‚è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šå…ˆå‘é€ OPTIONS é¢„æ£€è¯·æ±‚</span>
  <span class="hljs-keyword">if</span> (config.method !== <span class="hljs-string">'GET'</span> &amp;&amp; config.method !== <span class="hljs-string">'POST'</span>) {
    config.headers[<span class="hljs-string">'Content-Type'</span>] = <span class="hljs-string">'application/json'</span>;
  }
  
  <span class="hljs-keyword">return</span> config;
});
```

## API ç‰ˆæœ¬å…¼å®¹

### ç‰ˆæœ¬ç­–ç•¥

```typescript
<span class="hljs-comment">// API ç‰ˆæœ¬ç®¡ç†</span>
<span class="hljs-keyword">export</span> <span class="hljs-type">const</span> API_VERSIONS = {
  V3: <span class="hljs-string">'/api/v3'</span>,
  V4: <span class="hljs-string">'/api/v4'</span>,
} as <span class="hljs-type">const</span>;

<span class="hljs-comment">// æ ¹æ®åŠŸèƒ½é€‰æ‹© API ç‰ˆæœ¬</span>
<span class="hljs-keyword">export</span> <span class="hljs-type">const</span> createApiClient = (version: keyof typeof API_VERSIONS = <span class="hljs-string">'V4'</span>) =&gt; {
  <span class="hljs-keyword">return</span> axios.<span class="hljs-built_in">create</span>({
    baseURL: API_VERSIONS[version],
    timeout: <span class="hljs-number">10000</span>,
  });
};

<span class="hljs-comment">// å‘åå…¼å®¹å¤„ç†</span>
<span class="hljs-keyword">export</span> <span class="hljs-type">const</span> legacyApiCall = <span class="hljs-built_in">async</span> (endpoint: string, data: any) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// å°è¯•ä½¿ç”¨æ–°ç‰ˆæœ¬ API</span>
    <span class="hljs-keyword">return</span> await v4Client.<span class="hljs-built_in">post</span>(endpoint, data);
  } <span class="hljs-built_in">catch</span> (error) {
    <span class="hljs-keyword">if</span> (error.response?.status === <span class="hljs-number">404</span>) {
      <span class="hljs-comment">// å›é€€åˆ°æ—§ç‰ˆæœ¬ API</span>
      console.<span class="hljs-built_in">warn</span>(`Falling back to v3 API <span class="hljs-keyword">for</span> ${endpoint}`);
      <span class="hljs-keyword">return</span> await v3Client.<span class="hljs-built_in">post</span>(endpoint, data);
    }
    <span class="hljs-keyword">throw</span> error;
  }
};
```

## æ€§èƒ½ä¼˜åŒ–

### è¯·æ±‚ä¼˜åŒ–

#### <span class="hljs-number">1.</span> è¯·æ±‚åˆå¹¶

```typescript
<span class="hljs-comment">// æ‰¹é‡è¯·æ±‚åˆå¹¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestBatcher</span> {
  <span class="hljs-keyword">private</span> batches = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>&lt;string, any[]&gt;();
  <span class="hljs-keyword">private</span> timers = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>&lt;string, NodeJS.Timeout&gt;();
  
  <span class="hljs-built_in">batch</span>&lt;T&gt;(
    key: string,
    request: any,
    batchFn: (requests: any[]) =&gt; Promise&lt;T[]&gt;,
    delay: number = <span class="hljs-number">100</span>
  ): Promise&lt;T&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>((resolve, reject) =&gt; {
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.batches.<span class="hljs-built_in">has</span>(key)) {
        <span class="hljs-keyword">this</span>.batches.<span class="hljs-built_in">set</span>(key, []);
      }
      
      <span class="hljs-type">const</span> batch = <span class="hljs-keyword">this</span>.batches.<span class="hljs-built_in">get</span>(key)!;
      batch.<span class="hljs-built_in">push</span>({ request, resolve, reject });
      
      <span class="hljs-comment">// æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.timers.<span class="hljs-built_in">has</span>(key)) {
        <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-keyword">this</span>.timers.<span class="hljs-built_in">get</span>(key)!);
      }
      
      <span class="hljs-comment">// è®¾ç½®æ–°çš„å®šæ—¶å™¨</span>
      <span class="hljs-type">const</span> timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-built_in">async</span> () =&gt; {
        <span class="hljs-type">const</span> currentBatch = <span class="hljs-keyword">this</span>.batches.<span class="hljs-built_in">get</span>(key)!;
        <span class="hljs-keyword">this</span>.batches.<span class="hljs-built_in">delete</span>(key);
        <span class="hljs-keyword">this</span>.timers.<span class="hljs-built_in">delete</span>(key);
        
        <span class="hljs-keyword">try</span> {
          <span class="hljs-type">const</span> requests = currentBatch.<span class="hljs-built_in">map</span>(item =&gt; item.request);
          <span class="hljs-type">const</span> results = await <span class="hljs-built_in">batchFn</span>(requests);
          
          currentBatch.forEach((item, index) =&gt; {
            item.<span class="hljs-built_in">resolve</span>(results[index]);
          });
        } <span class="hljs-built_in">catch</span> (error) {
          currentBatch.forEach(item =&gt; {
            item.<span class="hljs-built_in">reject</span>(error);
          });
        }
      }, delay);
      
      <span class="hljs-keyword">this</span>.timers.<span class="hljs-built_in">set</span>(key, timer);
    });
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-type">const</span> batcher = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RequestBatcher</span>();

<span class="hljs-keyword">export</span> <span class="hljs-type">const</span> getUserInfo = (userId: number) =&gt; {
  <span class="hljs-keyword">return</span> batcher.<span class="hljs-built_in">batch</span>(
    <span class="hljs-string">'getUserInfo'</span>,
    userId,
    <span class="hljs-built_in">async</span> (userIds: number[]) =&gt; {
      <span class="hljs-type">const</span> response = await api.<span class="hljs-built_in">post</span>(<span class="hljs-string">'/user/batch'</span>, { ids: userIds });
      <span class="hljs-keyword">return</span> response.data;
    }
  );
};
```

#### <span class="hljs-number">2.</span> è¯·æ±‚å»é‡

```typescript
<span class="hljs-comment">// è¯·æ±‚å»é‡</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestDeduplicator</span> {
  <span class="hljs-keyword">private</span> pending = <span class="hljs-keyword">new</span> Map&lt;string, Promise&lt;any&gt;&gt;();
  
  <span class="hljs-built_in">dedupe</span>&lt;T&gt;(key: string, requestFn: () =&gt; Promise&lt;T&gt;): Promise&lt;T&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pending.<span class="hljs-built_in">has</span>(key)) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pending.<span class="hljs-built_in">get</span>(key)!;
    }
    
    <span class="hljs-type">const</span> promise = <span class="hljs-built_in">requestFn</span>().<span class="hljs-built_in">finally</span>(() =&gt; {
      <span class="hljs-keyword">this</span>.pending.<span class="hljs-built_in">delete</span>(key);
    });
    
    <span class="hljs-keyword">this</span>.pending.<span class="hljs-built_in">set</span>(key, promise);
    <span class="hljs-keyword">return</span> promise;
  }
}

<span class="hljs-type">const</span> deduplicator = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RequestDeduplicator</span>();

<span class="hljs-keyword">export</span> <span class="hljs-type">const</span> getFileList = (path: string) =&gt; {
  <span class="hljs-type">const</span> key = `fileList:${path}`;
  <span class="hljs-keyword">return</span> deduplicator.<span class="hljs-built_in">dedupe</span>(key, () =&gt; 
    api.<span class="hljs-built_in">get</span>(<span class="hljs-string">'/file/list'</span>, { params: { path } })
  );
};
```

## ç›‘æ§å’Œè°ƒè¯•

### è¯·æ±‚æ—¥å¿—

```typescript
<span class="hljs-comment">// è¯·æ±‚æ—¥å¿—ä¸­é—´ä»¶</span>
instance.interceptors.request.<span class="hljs-built_in">use</span>((config) =&gt; {
  <span class="hljs-type">const</span> requestId = <span class="hljs-built_in">generateRequestId</span>();
  config.metadata = { requestId, startTime: Date.<span class="hljs-built_in">now</span>() };
  
  console.<span class="hljs-built_in">log</span>(`[${requestId}] ${config.method?.<span class="hljs-built_in">toUpperCase</span>()} ${config.url}`, {
    params: config.params,
    data: config.data,
  });
  
  <span class="hljs-keyword">return</span> config;
});

instance.interceptors.response.<span class="hljs-built_in">use</span>(
  (response) =&gt; {
    <span class="hljs-type">const</span> { requestId, startTime } = response.config.metadata;
    <span class="hljs-type">const</span> duration = Date.<span class="hljs-built_in">now</span>() - startTime;
    
    console.<span class="hljs-built_in">log</span>(`[${requestId}] Response ${response.status} (${duration}ms)`, {
      data: response.data,
    });
    
    <span class="hljs-keyword">return</span> response;
  },
  (error) =&gt; {
    <span class="hljs-type">const</span> { requestId, startTime } = error.config?.metadata || {};
    <span class="hljs-type">const</span> duration = Date.<span class="hljs-built_in">now</span>() - startTime;
    
    console.<span class="hljs-built_in">error</span>(`[${requestId}] Error ${error.response?.status} (${duration}ms)`, {
      error: error.response?.data,
    });
    
    <span class="hljs-keyword">return</span> Promise.<span class="hljs-built_in">reject</span>(error);
  }
);
```

### æ€§èƒ½ç›‘æ§

```typescript
<span class="hljs-comment">// API æ€§èƒ½ç›‘æ§</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ApiMonitor</span> {
  <span class="hljs-keyword">private</span> metrics = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>&lt;string, {
    count: number;
    totalTime: number;
    errors: number;
  }&gt;();
  
  <span class="hljs-built_in">record</span>(endpoint: string, duration: number, success: <span class="hljs-type">boolean</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.metrics.<span class="hljs-built_in">has</span>(endpoint)) {
      <span class="hljs-keyword">this</span>.metrics.<span class="hljs-built_in">set</span>(endpoint, { count: <span class="hljs-number">0</span>, totalTime: <span class="hljs-number">0</span>, errors: <span class="hljs-number">0</span> });
    }
    
    <span class="hljs-type">const</span> metric = <span class="hljs-keyword">this</span>.metrics.<span class="hljs-built_in">get</span>(endpoint)!;
    metric.count++;
    metric.totalTime += duration;
    
    <span class="hljs-keyword">if</span> (!success) {
      metric.errors++;
    }
  }
  
  <span class="hljs-built_in">getStats</span>() {
    <span class="hljs-type">const</span> stats = Array.<span class="hljs-built_in">from</span>(<span class="hljs-keyword">this</span>.metrics.<span class="hljs-built_in">entries</span>()).<span class="hljs-built_in">map</span>(([endpoint, metric]) =&gt; ({
      endpoint,
      count: metric.count,
      avgTime: metric.totalTime / metric.count,
      errorRate: metric.errors / metric.count,
    }));
    
    <span class="hljs-keyword">return</span> stats.<span class="hljs-built_in">sort</span>((a, b) =&gt; b.avgTime - a.avgTime);
  }
}

<span class="hljs-type">const</span> monitor = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ApiMonitor</span>();

<span class="hljs-comment">// åœ¨æ‹¦æˆªå™¨ä¸­ä½¿ç”¨</span>
instance.interceptors.response.<span class="hljs-built_in">use</span>(
  (response) =&gt; {
    <span class="hljs-type">const</span> duration = Date.<span class="hljs-built_in">now</span>() - response.config.metadata.startTime;
    monitor.<span class="hljs-built_in">record</span>(response.config.url!, duration, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">return</span> response;
  },
  (error) =&gt; {
    <span class="hljs-type">const</span> duration = Date.<span class="hljs-built_in">now</span>() - error.config?.metadata?.startTime;
    monitor.<span class="hljs-built_in">record</span>(error.config?.url!, duration, <span class="hljs-literal">false</span>);
    <span class="hljs-keyword">return</span> Promise.<span class="hljs-built_in">reject</span>(error);
  }
);
```

## æ€»ç»“

Cloudreve çš„å‰åç«¯é€šä¿¡æœºåˆ¶å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

<span class="hljs-number">1.</span> **ç»Ÿä¸€çš„ API è®¾è®¡**: RESTful é£æ ¼ï¼Œæ¸…æ™°çš„æ¥å£è§„èŒƒ
<span class="hljs-number">2.</span> **å®Œå–„çš„è®¤è¯æœºåˆ¶**: JWT Token + è‡ªåŠ¨åˆ·æ–°
<span class="hljs-number">3.</span> **çµæ´»çš„é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯æ ¼å¼å’Œå¤„ç†ç­–ç•¥
<span class="hljs-number">4.</span> **æµå¼æ•°æ®æ”¯æŒ**: SSE åè®®å®ç°å®æ—¶é€šä¿¡
<span class="hljs-number">5.</span> **é«˜æ•ˆçš„æ–‡ä»¶ä¼ è¾“**: åˆ†ç‰‡ä¸Šä¼ æ”¯æŒå¤§æ–‡ä»¶
<span class="hljs-number">6.</span> **æ™ºèƒ½ç¼“å­˜ç­–ç•¥**: å‰åç«¯å¤šå±‚ç¼“å­˜ä¼˜åŒ–
<span class="hljs-number">7.</span> **æ€§èƒ½ç›‘æ§**: å®Œæ•´çš„è¯·æ±‚ç›‘æ§å’Œè°ƒè¯•æœºåˆ¶

è¿™å¥—é€šä¿¡æœºåˆ¶ä¸ºä½ å¼€å‘ä¾§è¾¹æ å¯¹è¯åŠŸèƒ½æä¾›äº†å¯é çš„åŸºç¡€ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ç°æœ‰çš„ API æ¥å£å’Œé€šä¿¡æ¨¡å¼æ¥å®ç°æ–°åŠŸèƒ½ã€‚
</code></pre>
<h3 data-id="heading-7"><strong>05-development-guide.md - å¼€å‘æµç¨‹æŒ‡å—</strong></h3>
<ul>
<li>
<p>ç¯å¢ƒæ­å»ºå’Œå¼€å‘å·¥ä½œæµ</p>
</li>
<li>
<p>è°ƒè¯•æŠ€å·§å’Œæ€§èƒ½ä¼˜åŒ–</p>
</li>
<li>
<p>éƒ¨ç½²æµç¨‹å’Œæœ€ä½³å®è·µ</p>
</li>
</ul>
<blockquote>
<p>å› ç¯‡å¹…é™åˆ¶ï¼Œå®Œæ•´æ–‡æ¡£å†…å®¹è¯¦è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FO65Ay8h1S6jbK_j67jQVDg" target="_blank" title="https://mp.weixin.qq.com/s/O65Ay8h1S6jbK_j67jQVDg" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/O65Ay8h1Sâ€¦</a></p>
</blockquote>
<h3 data-id="heading-8"><strong>06-chat-feature-extension.md - èŠå¤©åŠŸèƒ½æ‰©å±•å®ç°æ–¹æ¡ˆ</strong></h3>
<ul>
<li>
<p>åŸºäºç°æœ‰èŠå¤©åŠŸèƒ½çš„ä¾§è¾¹æ æ‰©å±•</p>
</li>
<li>
<p>å®Œæ•´çš„å‰åç«¯ä»£ç ç¤ºä¾‹</p>
</li>
<li>
<p>æ–‡ä»¶å¤¹ä¸Šä¸‹æ–‡è¯»å–å’Œ AI å¯¹è¯é›†æˆ</p>
</li>
</ul>
<blockquote>
<p>å› ç¯‡å¹…é™åˆ¶ï¼Œå®Œæ•´æ–‡æ¡£å†…å®¹è¯¦è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FO65Ay8h1S6jbK_j67jQVDg" target="_blank" title="https://mp.weixin.qq.com/s/O65Ay8h1S6jbK_j67jQVDg" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/O65Ay8h1Sâ€¦</a></p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb0e8142224a4b3d998726c7bfecac32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=hMYrTL9aIgepbNietMJntPYejkE%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-9"><strong>æ¨¡å—é‡æ„</strong></h2>
<h3 data-id="heading-10"><strong>åˆ†æå¹¶è§„åˆ’é‡æ„</strong></h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a38acf5942b948578c636054c1df6fe7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=SHj%2BiM7YijijumkImq44YMSQdkA%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b243bc6b1a74472a9b6a8a0b0650674f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=pREIpCB2EreCJD3a1Fjzqw%2FqygQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11"><strong>é‡æ„è®¡åˆ’è¯¦æƒ…</strong></h3>
<pre><code class="hljs language-markdown" lang="markdown">
<span class="hljs-section"># Cloudreve å‰ç«¯é‡æ„ä¼˜åŒ–è®¡åˆ’</span>

<span class="hljs-section">## ğŸ“Š é¡¹ç›®ç°çŠ¶åˆ†æ</span>

<span class="hljs-section">### æŠ€æœ¯æ ˆæ¦‚å†µ</span>
<span class="hljs-bullet">-</span> <span class="hljs-strong">**React 18.2.0 + TypeScript 5.2.2**</span> - ç°ä»£åŒ–æŠ€æœ¯æ ˆ
<span class="hljs-bullet">-</span> <span class="hljs-strong">**Material-UI 6.x**</span> - æˆç†Ÿçš„ç»„ä»¶åº“
<span class="hljs-bullet">-</span> <span class="hljs-strong">**Redux Toolkit**</span> - ç°ä»£çŠ¶æ€ç®¡ç†
<span class="hljs-bullet">-</span> <span class="hljs-strong">**119ä¸ªä¾èµ–åŒ…**</span> - ä¾èµ–è¾ƒä¸ºå¤æ‚

<span class="hljs-section">### ä¸»è¦é—®é¢˜è¯†åˆ«</span>
<span class="hljs-bullet">1.</span> <span class="hljs-strong">**æ€§èƒ½é—®é¢˜**</span>: Bundleè¿‡å¤§ã€ç¼ºå°‘è™šæ‹ŸåŒ–ã€ä¸å¿…è¦çš„é‡æ¸²æŸ“
<span class="hljs-bullet">2.</span> <span class="hljs-strong">**ä»£ç è´¨é‡**</span>: 75ä¸ªæ–‡ä»¶ä½¿ç”¨anyç±»å‹ã€ç»„ä»¶èŒè´£ä¸æ¸…ã€ä»£ç é‡å¤
<span class="hljs-bullet">3.</span> <span class="hljs-strong">**æ¶æ„é—®é¢˜**</span>: ç»„ä»¶è€¦åˆåº¦é«˜ã€çŠ¶æ€ç®¡ç†åˆ†æ•£ã€ç¼ºå°‘æŠ½è±¡å±‚
<span class="hljs-bullet">4.</span> <span class="hljs-strong">**æŠ€æœ¯å€ºåŠ¡**</span>: 8ä¸ªTODOæ ‡è®°ã€é‡å¤æ ·å¼å®šä¹‰ã€é”™è¯¯å¤„ç†ä¸ç»Ÿä¸€

<span class="hljs-section">## ğŸ¯ é‡æ„ä¼˜å…ˆçº§æ’åº</span>

<span class="hljs-section">### ç¬¬ä¸€ä¼˜å…ˆçº§ï¼šå¿«é€Ÿèƒœåˆ©é¡¹ç›®ï¼ˆ2-3å‘¨ï¼‰</span>
<span class="hljs-strong">**é£é™©ï¼šğŸŸ¢ä½ | æ”¶ç›Šï¼šğŸ’°ğŸ’°ä¸­é«˜**</span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**ä»£ç è§„èŒƒç»Ÿä¸€**</span>
<span class="hljs-bullet">   -</span> ç»Ÿä¸€TypeScripté…ç½®ï¼Œæ¶ˆé™¤anyç±»å‹æ»¥ç”¨
<span class="hljs-bullet">   -</span> å»ºç«‹ç»„ä»¶å‘½åè§„èŒƒå’Œæ–‡ä»¶ç»„ç»‡æ ‡å‡†
<span class="hljs-bullet">   -</span> å®æ–½è‡ªåŠ¨åŒ–ä»£ç æ ¼å¼åŒ–

<span class="hljs-bullet">2.</span> <span class="hljs-strong">**å›½é™…åŒ–ä¼˜åŒ–**</span>
<span class="hljs-bullet">   -</span> ä¼˜åŒ–10ç§è¯­è¨€çš„ç¿»è¯‘æ–‡ä»¶ç»“æ„
<span class="hljs-bullet">   -</span> å®æ–½æŒ‰éœ€åŠ è½½æœºåˆ¶
<span class="hljs-bullet">   -</span> ç»Ÿä¸€ç¿»è¯‘keyå‘½åè§„èŒƒ

<span class="hljs-bullet">3.</span> <span class="hljs-strong">**å·¥å…·å‡½æ•°æŠ½å–**</span>
<span class="hljs-bullet">   -</span> åˆ›å»ºç»Ÿä¸€çš„æ—¶é—´æ ¼å¼åŒ–ã€æ–‡ä»¶ç±»å‹åˆ¤æ–­å·¥å…·
<span class="hljs-bullet">   -</span> æŠ½å–é‡å¤çš„APIè°ƒç”¨æ¨¡å¼
<span class="hljs-bullet">   -</span> å»ºç«‹å…¬å…±Hookåº“

<span class="hljs-section">### ç¬¬äºŒä¼˜å…ˆçº§ï¼šæ€§èƒ½ä¼˜åŒ–é¡¹ç›®ï¼ˆ3-4å‘¨ï¼‰</span>
<span class="hljs-strong">**é£é™©ï¼šğŸ”´é«˜ | æ”¶ç›Šï¼šğŸ’°ğŸ’°ğŸ’°é«˜**</span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**Bundleä¼˜åŒ–**</span>
<span class="hljs-bullet">   -</span> å®æ–½ç²¾ç»†åŒ–ä»£ç åˆ†å‰²ï¼Œé¢„è®¡å‡å°‘35%åŒ…å¤§å°
<span class="hljs-bullet">   -</span> ä¼˜åŒ–Monaco Editorã€Excalidrawç­‰å¤§å‹åº“çš„åŠ è½½
<span class="hljs-bullet">   -</span> å®æ–½æ‡’åŠ è½½å’Œé¢„åŠ è½½ç­–ç•¥

<span class="hljs-bullet">2.</span> <span class="hljs-strong">**ç»„ä»¶æ€§èƒ½ä¼˜åŒ–**</span>
<span class="hljs-bullet">   -</span> ä¸ºæ ¸å¿ƒç»„ä»¶æ·»åŠ React.memoå’ŒuseCallback
<span class="hljs-bullet">   -</span> å®æ–½è™šæ‹Ÿæ»šåŠ¨è§£å†³é•¿åˆ—è¡¨æ€§èƒ½é—®é¢˜
<span class="hljs-bullet">   -</span> ä¼˜åŒ–æ–‡ä»¶ç¼©ç•¥å›¾åŠ è½½æœºåˆ¶

<span class="hljs-bullet">3.</span> <span class="hljs-strong">**è¿è¡Œæ—¶ä¼˜åŒ–**</span>
<span class="hljs-bullet">   -</span> ä¿®å¤å†…å­˜æ³„æ¼é—®é¢˜
<span class="hljs-bullet">   -</span> ä¼˜åŒ–çŠ¶æ€æ›´æ–°é¢‘ç‡
<span class="hljs-bullet">   -</span> å®æ–½æ™ºèƒ½ç¼“å­˜ç­–ç•¥

<span class="hljs-section">### ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼šæ¶æ„é‡æ„é¡¹ç›®ï¼ˆ4-6å‘¨ï¼‰</span>
<span class="hljs-strong">**é£é™©ï¼šğŸ”´é«˜ | æ”¶ç›Šï¼šğŸ’°ğŸ’°ğŸ’°é«˜**</span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**ç»„ä»¶æ¶æ„é‡æ„**</span>
<span class="hljs-bullet">   -</span> é‡æ„GridFileç­‰å¤§å‹ç»„ä»¶ï¼ˆ463è¡Œâ†’æ‹†åˆ†ä¸ºå¤šä¸ªå°ç»„ä»¶ï¼‰
<span class="hljs-bullet">   -</span> åˆ†ç¦»æ•°æ®è·å–å’ŒUIæ¸²æŸ“é€»è¾‘
<span class="hljs-bullet">   -</span> å»ºç«‹ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€ç®¡ç†

<span class="hljs-bullet">2.</span> <span class="hljs-strong">**çŠ¶æ€ç®¡ç†ä¼˜åŒ–**</span>
<span class="hljs-bullet">   -</span> é‡æ„èŠå¤©ç³»ç»Ÿçš„çŠ¶æ€ç®¡ç†
<span class="hljs-bullet">   -</span> ç»Ÿä¸€Reduxå’Œæœ¬åœ°çŠ¶æ€çš„ä½¿ç”¨æ¨¡å¼
<span class="hljs-bullet">   -</span> å®æ–½çŠ¶æ€æœºç®¡ç†å¤æ‚çŠ¶æ€è½¬æ¢

<span class="hljs-bullet">3.</span> <span class="hljs-strong">**ä¾èµ–å‡çº§**</span>
<span class="hljs-bullet">   -</span> åˆ†æ‰¹å‡çº§æ ¸å¿ƒä¾èµ–åŒ…
<span class="hljs-bullet">   -</span> è§£å†³å®‰å…¨æ¼æ´å’Œå…¼å®¹æ€§é—®é¢˜
<span class="hljs-bullet">   -</span> è·å¾—æ–°ç‰ˆæœ¬ç‰¹æ€§æ”¯æŒ

<span class="hljs-section">## ğŸš€ å®æ–½ç­–ç•¥</span>

<span class="hljs-section">### æ¸è¿›å¼é‡æ„æ–¹æ¡ˆ</span>
<span class="hljs-code">```
é˜¶æ®µä¸€ï¼ˆ2-3å‘¨ï¼‰ï¼šåŸºç¡€ä¼˜åŒ–
â”œâ”€â”€ ä»£ç è§„èŒƒç»Ÿä¸€
â”œâ”€â”€ å›½é™…åŒ–ä¼˜åŒ–  
â””â”€â”€ æŠ€æœ¯å€ºåŠ¡æ¸…ç†

é˜¶æ®µäºŒï¼ˆ3-4å‘¨ï¼‰ï¼šæ€§èƒ½ä¼˜åŒ–
â”œâ”€â”€ Bundleåˆ†å‰²ä¼˜åŒ–
â”œâ”€â”€ ç»„ä»¶æ¸²æŸ“ä¼˜åŒ–
â””â”€â”€ ç¼“å­˜ç­–ç•¥å®æ–½

é˜¶æ®µä¸‰ï¼ˆ4-6å‘¨ï¼‰ï¼šæ¶æ„é‡æ„
â”œâ”€â”€ ç»„ä»¶æ‹†åˆ†é‡æ„
â”œâ”€â”€ çŠ¶æ€ç®¡ç†ç»Ÿä¸€
â””â”€â”€ ä¾èµ–ç‰ˆæœ¬å‡çº§
```</span>

<span class="hljs-section">### æµ‹è¯•å’Œè´¨é‡ä¿è¯</span>
<span class="hljs-bullet">-</span> <span class="hljs-strong">**è‡ªåŠ¨åŒ–æµ‹è¯•**</span>: æ ¸å¿ƒç»„ä»¶90%+è¦†ç›–ç‡
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ€§èƒ½æµ‹è¯•**</span>: FCP&lt;1.5s, LCP&lt;2.5sç›®æ ‡
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å›æ»šè®¡åˆ’**</span>: æ¯é˜¶æ®µè®¾ç½®ç¨³å®šç‰ˆæœ¬æ ‡ç­¾
<span class="hljs-bullet">-</span> <span class="hljs-strong">**ç›‘æ§å‘Šè­¦**</span>: å®æ—¶ç›‘æ§å…³é”®æ€§èƒ½æŒ‡æ ‡

<span class="hljs-section">## ğŸ“ˆ é¢„æœŸæ”¶ç›Š</span>

<span class="hljs-section">### æ€§èƒ½æå‡</span>
<span class="hljs-bullet">-</span> <span class="hljs-strong">**åŠ è½½é€Ÿåº¦**</span>: æå‡50%
<span class="hljs-bullet">-</span> <span class="hljs-strong">**Bundleå¤§å°**</span>: å‡å°‘35%
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å†…å­˜å ç”¨**</span>: é™ä½20-30%

<span class="hljs-section">### å¼€å‘æ•ˆç‡</span>
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ–°åŠŸèƒ½å¼€å‘**</span>: é€Ÿåº¦æå‡40%
<span class="hljs-bullet">-</span> <span class="hljs-strong">**ç»„ä»¶å¤ç”¨ç‡**</span>: æå‡60%
<span class="hljs-bullet">-</span> <span class="hljs-strong">**Bugä¿®å¤æ—¶é—´**</span>: å‡å°‘40%

<span class="hljs-section">### ä»£ç è´¨é‡</span>
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æŠ€æœ¯å€ºåŠ¡**</span>: å‡å°‘80%
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æµ‹è¯•è¦†ç›–ç‡**</span>: è¾¾åˆ°85%+
<span class="hljs-bullet">-</span> <span class="hljs-strong">**ç±»å‹å®‰å…¨**</span>: æ¶ˆé™¤75ä¸ªanyç±»å‹ä½¿ç”¨

<span class="hljs-section">## âš ï¸ é£é™©æ§åˆ¶</span>

<span class="hljs-section">### æŠ€æœ¯é£é™©ç¼“è§£</span>
<span class="hljs-bullet">-</span> æ¸è¿›å¼é‡æ„é¿å…å¤§çˆ†ç‚¸å¼æ”¹åŠ¨
<span class="hljs-bullet">-</span> å……åˆ†çš„è‡ªåŠ¨åŒ–å’Œæ‰‹å·¥æµ‹è¯•
<span class="hljs-bullet">-</span> ç°åº¦å‘å¸ƒå’Œå®æ—¶ç›‘æ§

<span class="hljs-section">### é¡¹ç›®é£é™©ç®¡ç†</span>
<span class="hljs-bullet">-</span> æ¯å‘¨è¿›åº¦å’Œè´¨é‡è¯„å®¡
<span class="hljs-bullet">-</span> æ˜ç¡®çš„é‡Œç¨‹ç¢‘å’Œäº¤ä»˜ç‰©
<span class="hljs-bullet">-</span> å¤‡ç”¨æ–¹æ¡ˆå’ŒçŸ¥è¯†åˆ†äº«æœºåˆ¶

<span class="hljs-section">## ğŸ’¼ èµ„æºéœ€æ±‚</span>

<span class="hljs-bullet">-</span> <span class="hljs-strong">**äººåŠ›**</span>: å‰ç«¯æ¶æ„å¸ˆ1äºº + é«˜çº§å·¥ç¨‹å¸ˆ2äºº + å·¥ç¨‹å¸ˆ1äºº
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ—¶é—´**</span>: æ€»è®¡13-16å‘¨
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å·¥å…·**</span>: è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ã€æ€§èƒ½ç›‘æ§å·¥å…·ã€CI/CDæµæ°´çº¿

è¿™ä¸ªé‡æ„è®¡åˆ’é€šè¿‡ç§‘å­¦çš„ä¼˜å…ˆçº§æ’åºå’Œé£é™©æ§åˆ¶ï¼Œç¡®ä¿åœ¨æå‡ä»£ç è´¨é‡çš„åŒæ—¶ä¿æŒé¡¹ç›®ç¨³å®šæ€§ï¼Œä¸ºé•¿æœŸçš„å¯ç»´æŠ¤æ€§å’Œå¼€å‘æ•ˆç‡å¥ å®šåŸºç¡€ã€‚
</code></pre>
<h3 data-id="heading-12"><strong>é‡æ„å®æ–½ç»“æœ</strong></h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed106812a2e4451f9d7dde99b3110e86~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=sDw3gqwosSQmuCv4rXsFLbn%2BSz0%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71621d638a9442a1966fa481eef3a3e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=VVWK46lP8jA0gEGh4hImskngD%2FY%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86e8de53d9894f608e9012012ad386eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=rhZVUNICSjbJfihDET%2F%2F1MEo0oc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35d3584594a34692a93ae213af2edbc4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=EASH%2B%2BKH5eup8CL53NcMqxbLzf4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-13"><strong>åŠŸèƒ½è¿­ä»£</strong></h2>
<p>åœ¨å®Œæˆé¡¹ç›®ç†è§£å’Œä»£ç ä¼˜åŒ–åï¼Œæ­£å¼è¿›å…¥åŠŸèƒ½å¼€å‘é˜¶æ®µã€‚æˆ‘è®¡åˆ’ä¸º Cloudreve æ·»åŠ ä¸€ä¸ªæ™ºèƒ½å¯¹è¯åŠŸèƒ½ï¼Œè®©ç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªç„¶è¯­è¨€ä¸äº‘ç›˜äº¤äº’ã€‚</p>
<h3 data-id="heading-14"><strong>å‡†å¤‡å·¥ä½œï¼šæ¥å…¥ Context7 MCP</strong></h3>
<p>ä¸ºäº†æé«˜ AI å¯¹ OpenRouter API çš„ç†è§£å’Œä½¿ç”¨èƒ½åŠ›ï¼Œæˆ‘å…ˆæ¥å…¥äº† Context7 MCP æœåŠ¡ã€‚</p>
<p><strong>Context7 é“¾æ¥ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fcontext7.com%3Fq%3Dopenrouter" target="_blank" title="https://context7.com?q=openrouter" ref="nofollow noopener noreferrer">context7.com?q=openrouter</a></p>
<p><strong>MCP é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"context7"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://mcp.context7.com/mcp"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/000fed0186eb4531a9b3d9163ff64b4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=Mv%2FmE1oZ5%2BUCsfbT4wbPVwRgFyM%3D" alt="" loading="lazy"/></p>
<p align="center">Context7 MCP é…ç½®ç•Œé¢</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3b77040a0f34d24a8df19056abd0a76~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=UWlKqSJvyujlMJH5mt4en%2Bxbk%2BM%3D" alt="" loading="lazy"/></p>
<p align="center">MCP æœåŠ¡çŠ¶æ€</p>
<h3 data-id="heading-15"><strong>ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€å¯¹è¯åŠŸèƒ½</strong></h3>
<p><strong>éœ€æ±‚è§„åˆ’</strong></p>
<p>æ‰“å¼€ Planï¼Œæ˜ç¡®åŸºç¡€å¯¹è¯åŠŸèƒ½çš„æ ¸å¿ƒéœ€æ±‚ã€‚</p>
<p><strong>éœ€æ±‚æè¿°ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">éœ€æ±‚ï¼š
ç»™äº‘ç›˜åŠ ä¸ª AI å¯¹è¯åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥ç”¨è‡ªç„¶è¯­è¨€è·Ÿ AI èŠå¤©

åç«¯ ï¼š
<span class="hljs-deletion">- æ–°å¢æµå¼å¯¹è¯æ¥å£å¹¶æ³¨å†Œåˆ°è·¯ç”±ä¸­ï¼Œéœ€è¦èº«ä»½é‰´æƒ</span>
<span class="hljs-deletion">- é›†æˆ OpenRouter è°ƒç”¨æ¨¡å‹</span>

å‰ç«¯ ï¼š
<span class="hljs-deletion">- å³ä¸‹è§’åŠ ä¸ªåœ†å½¢æ‚¬æµ®æŒ‰é’®</span>
<span class="hljs-deletion">- ç‚¹å‡»å¼¹å‡º 600px å®½çš„ä¾§è¾¹æ å¯¹è¯é¢æ¿</span>
<span class="hljs-deletion">- åŸºæœ¬çš„èŠå¤©ç•Œé¢ï¼šæ¶ˆæ¯åˆ—è¡¨ + è¾“å…¥æ¡†</span>
<span class="hljs-deletion">- è°ƒç”¨æµå¼å¯¹è¯æ¥å£æ—¶ï¼Œå¤„ç†å¥½é‰´æƒå‚æ•°ã€æµå¼è¾“å‡ºçŠ¶æ€</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c4fdfa41fc948a4a2e85d39fd4b9e43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=0b6PtVj9WiV3hroEpAZe8gWNiTQ%3D" alt="" loading="lazy"/></p>
<p>Coder ä¼šè‡ªåŠ¨è°ƒç”¨å†…ç½®çš„ Search Agent åˆ†æé¡¹ç›®ç»“æ„ï¼Œç†è§£ä»£ç ä¸Šä¸‹æ–‡ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/531d8d6529fc4849ba172c8ff5cde9fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=1PFGSyJ9ptLPanIxbTGwP7MASC8%3D" alt="" loading="lazy"/></p>
<p align="center">Search Agent å·¥ä½œè¿‡ç¨‹</p>
<p>åˆ†æå®Œæˆåï¼ŒCoder å°†æŠ€æœ¯æ–¹æ¡ˆä»¥æ–‡æ¡£å½¢å¼å‘ˆç°ï¼Œæ”¯æŒå®æ—¶ä¿®æ”¹å’Œç¼–è¾‘ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0969b63c5ad471e9681b69689819455~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=rYrZaNhWCV%2Ftf7RnQZR8bsPEvuY%3D" alt="" loading="lazy"/></p>
<p align="center">æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£</p>
<h4 data-id="heading-16"><strong>ä»»åŠ¡æ‰§è¡Œ</strong></h4>
<p>ç¡®è®¤æ–¹æ¡ˆåï¼ŒCoder ä¼šæ ¹æ®æŠ€æœ¯è§„åˆ’è‡ªåŠ¨æ‹†è§£ä»»åŠ¡å¹¶åˆ†æ­¥æ‰§è¡Œ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0bc4e5bed4644204837f2389623260cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=0aCkB8F%2BsDVjpnM2CaKZ0%2FXNz7A%3D" alt="" loading="lazy"/></p>
<p align="center">ä»»åŠ¡æ‹†è§£åˆ—è¡¨</p>
<p>åœ¨å®æ–½è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å®æ—¶çœ‹åˆ°æ¯ä¸ªæ­¥éª¤çš„çŠ¶æ€æ›´æ–°ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e973700b38df4cfabbcacb23665b6e40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=CubWtnj1VSsDyRphP%2BxgppbOpDY%3D" alt="" loading="lazy"/></p>
<p align="center">å®æ–½è¿›åº¦è¿½è¸ª</p>
<p>å¼€å‘å®Œæˆåï¼ŒCoder ä¼šè‡ªåŠ¨å¯åŠ¨é¡¹ç›®è¿›è¡Œé¢„è§ˆéªŒè¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6c3c56fc76347d78e450509f1e164ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=YW7Vw2onWpJ6qZgpYpz%2BaCF1KTs%3D" alt="" loading="lazy"/></p>
<p align="center">è‡ªåŠ¨å¯åŠ¨é¢„è§ˆ</p>
<p><strong>å®ç°æ•ˆæœï¼š</strong></p>
<p>å¯¹è¯åŠŸèƒ½å·²ç»æˆåŠŸå®ç°ï¼ŒUI é£æ ¼ä¸ Cloudreve åŸç”Ÿç•Œé¢ä¿æŒé«˜åº¦ä¸€è‡´ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ceb9310336146a79dc16ac837dc6a4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=8I20e%2Fj9tKqXqbTBNe56DqVkAPM%3D" alt="" loading="lazy"/></p>
<p align="center">å¯¹è¯åŠŸèƒ½ç•Œé¢</p>
<h3 data-id="heading-17"><strong>ç¬¬äºŒé˜¶æ®µï¼šå¢é‡è¿­ä»£ï¼Œå¢åŠ å¤šæ¨¡æ€å¬å›</strong></h3>
<p>åŸºç¡€å¯¹è¯åŠŸèƒ½å®Œæˆåï¼Œæˆ‘è¿›ä¸€æ­¥æå‡ºäº†æ›´é«˜çº§çš„éœ€æ±‚ï¼šè®© AI èƒ½å¤Ÿç†è§£å’Œæ£€ç´¢äº‘ç›˜ä¸­çš„æ–‡ä»¶å†…å®¹ã€‚</p>
<p><strong>å¢å¼ºéœ€æ±‚</strong></p>
<p><strong>éœ€æ±‚æè¿°ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">éœ€æ±‚ï¼š
AI èŠå¤©æ”¯æŒå¤šæ¨¡æ€æ–‡ä»¶æ™ºèƒ½æ£€ç´¢

åç«¯ï¼š
<span class="hljs-deletion">- æµå¼å¯¹è¯æ¥å£ä¸­è¯»å–å…¨é‡äº‘ç›˜æ–‡å†…å®¹ä½œä¸ºä¸Šä¸‹æ–‡æä¾›ç»™æ¨¡å‹ï¼Œæ¨¡å‹é€šè¿‡æ–‡ä»¶å…ƒä¿¡æ¯åŠå¤šæ¨¡æ€å†…å®¹è¿›è¡Œæ–‡ä»¶å¬å›</span>
<span class="hljs-deletion">- è¿”å›ï¼šsummary + file list çš„ç»“æ„ï¼Œå‰ç«¯æ¸²æŸ“ä¸ºæ–‡æœ¬ + GUI åˆ—è¡¨</span>
<span class="hljs-deletion">- é—®"å¸®æˆ‘æ‰¾åŒ…å«å°ç‹—çš„å›¾ç‰‡"è¿™ç±»é—®é¢˜æ—¶ï¼Œèƒ½å¤Ÿå¬å›æ–‡ä»¶å…ƒä¿¡æ¯æˆ–æ–‡ä»¶å†…å®¹ä¸ç”¨æˆ·æ„å›¾ç›¸å…³çš„æ–‡ä»¶</span>

å‰ç«¯ï¼š
<span class="hljs-deletion">- æ¶ˆæ¯ä¸­å±•ç¤ºæ–‡ä»¶åˆ—è¡¨</span>
<span class="hljs-deletion">- 3 åˆ—ç½‘æ ¼å¸ƒå±€ï¼Œæ˜¾ç¤ºç¼©ç•¥å›¾ã€æ–‡ä»¶å</span>
</code></pre>
<p><strong>å®ç°æ•ˆæœ</strong></p>
<p>Coder ä¼šè‡ªåŠ¨å¯åŠ¨å‰åç«¯æœåŠ¡ï¼Œå¹¶é€šè¿‡ç»ˆç«¯è¿›è¡ŒåŠŸèƒ½æµ‹è¯•ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/806ec905e34e4d118e7a6ca2b7a247b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=Ir0CL9WSmCDnmy2mWPPu7WT5jgs%3D" alt="" loading="lazy"/></p>
<p align="center">åŠŸèƒ½æµ‹è¯•è¿‡ç¨‹</p>
<p><strong>æœ€ç»ˆæ•ˆæœï¼š</strong></p>
<p>ç³»ç»ŸæˆåŠŸå®ç°äº†æ–‡ä»¶å†…å®¹è¯†åˆ«å’Œæ™ºèƒ½å¬å›åŠŸèƒ½ã€‚å½“ç”¨æˆ·è¯¢é—®"å¸®æˆ‘æ‰¾åŒ…å«å°ç‹—çš„å›¾ç‰‡"æ—¶ï¼ŒAI èƒ½å¤Ÿå‡†ç¡®è¯†åˆ«å›¾ç‰‡å†…å®¹å¹¶è¿”å›ç›¸å…³æ–‡ä»¶ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d018f95c7f24fe78a42f3f539caf686~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=mXFmRh%2F8fbZoot3avhyHlDb5jrs%3D" alt="" loading="lazy"/></p>
<p align="center">æ–‡ä»¶å¬å›æ•ˆæœå±•ç¤º</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/581c966bbfde4d35b71c95b4ceabcb1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764039376&amp;x-signature=xz9gTKrb1g%2BuhEQ7lJ9mSmvTFBc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-18"><strong>æ€»ç»“ä¸æ€è€ƒ</strong></h2>
<p>é€šè¿‡è¿™æ¬¡å®è·µï¼Œå¯ä»¥çœ‹åˆ° SOLO Coder åœ¨é¡¹ç›®ç†è§£ã€ä»£ç é‡æ„åˆ°åŠŸèƒ½å¼€å‘çš„æ¯ä¸ªç¯èŠ‚éƒ½å¯ä»¥æä¾›æ”¯æŒã€‚è¿™ä¸ªé¡¹ç›®æœªæ¥è¿˜å¯ä»¥è¿›ä¸€æ­¥æ¢ç´¢çš„æœ‰ï¼šæ›´å¤æ‚çš„å¤šæ¨¡æ€äº¤äº’åœºæ™¯ã€æ™ºèƒ½æ–‡ä»¶ç®¡ç†å’Œæ¨èå’ŒåŸºäºç”¨æˆ·è¡Œä¸ºçš„ä¸ªæ€§åŒ–ä½“éªŒï¼Œæ¬¢è¿å¤§å®¶å»åˆ›é€ ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•è¿‡åˆ«äººåï¼Œæˆ‘å¯¹é¢è¯•ç¥›é­…äº†]]></title>    <link>https://juejin.cn/post/7573592127298273330</link>    <guid>https://juejin.cn/post/7573592127298273330</guid>    <pubDate>2025-11-18T03:00:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573592127298273330" data-draft-id="7573593395797950510" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•è¿‡åˆ«äººåï¼Œæˆ‘å¯¹é¢è¯•ç¥›é­…äº†"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,GitHub"/> <meta itemprop="datePublished" content="2025-11-18T03:00:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒé¥ºå­ä¸åƒé¦…"/> <meta itemprop="url" content="https://juejin.cn/user/1148309742825495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•è¿‡åˆ«äººåï¼Œæˆ‘å¯¹é¢è¯•ç¥›é­…äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1148309742825495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒé¥ºå­ä¸åƒé¦…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T03:00:54.000Z" title="Tue Nov 18 2025 03:00:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç”±äºå…¬å¸è€å‘˜å·¥èµ°äº†ä¸€äº›ï¼Œæˆ‘ä¸€ä¸å°å¿ƒå˜æˆæœ€è€çš„å‰ç«¯äº†</p>
<p>æ‰€ä»¥æœ‰å¹¸èƒ½å¤Ÿæ‹…ä»»å…¬å¸å‰ç«¯ä¸€é¢çš„å·¥ä½œ</p>
<p>å’Œæ¯ä½åº”è˜è€…äº¤æµçš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯æˆ‘çš„å­¦ä¹ è¿‡ç¨‹ï¼Œä»ä¸­å‘ç°ä¸€äº›ä¸ä¸€æ ·çš„è§†è§’çš„ä¸œè¥¿ï¼Œå†™ä¸‹æ¥è®°å½•ä¸€ä¸‹</p>
<p>è€äº†åå›æ¥å†çœ‹çœ‹æ˜é‡‘ï¼Œä¹Ÿæ˜¯è‡ªå·±åšæŒå†™æ–‡ç« çš„åŸå› ä¹‹ä¸€ï¼Œåˆ°æ—¶å€™æŠ±ç€å­©å­è¯´ï¼Œçœ‹çˆ·çˆ·å½“å¹´å†™çš„æ–‡ç« ï¼Œè¿™ä¹ˆå¤šäººç‚¹èµå˜ï¼</p>
<h3 data-id="heading-0">æ²Ÿé€šè¡¨è¾¾èƒ½åŠ›éå¸¸é‡è¦</h3>
<p>å¦ç™½è®²ï¼Œä½ çš„æŠ€æœ¯å®åŠ›æœ‰æ—¶å€™ä¸å¦‚è¡¨è¾¾èƒ½åŠ›æœ‰ç«äº‰åŠ›ï¼Œå³ä½¿ä½ çš„æŠ€æœ¯å†NBï¼Œé—®ä¸ªé—®é¢˜ï¼ŒåŠå¤©æ²¡æœ‰è¡¨è¾¾æ¸…æ¥šï¼Œæ€ä¹ˆå’Œå¤æ‚çš„å®é™…å·¥ä½œä¸­æ²Ÿé€šå‘¢</p>
<p>ä½†æ˜¯è¿™ä¸ªæ²Ÿé€šè¡¨è¾¾èƒ½åŠ›æœ‰ç‚¹é‚ªä¹ï¼Œæ²¡æœ‰æ˜ç¡®çš„æ ‡å‡†</p>
<h3 data-id="heading-1">é‡åˆ°è¿‡ä»€ä¹ˆéš¾ç‚¹ï¼Œæ€ä¹ˆè§£å†³</h3>
<p>è¿™ä¸ªé—®é¢˜ä¸æ˜¯å¾ˆå¥½å›ç­”ï¼Œä½†æ˜¯ä¸€å®šä¸è¦å›ç­”æ²¡æœ‰é‡åˆ°ä»€ä¹ˆéš¾ç‚¹ï¼Œå…¶å®é—®è¿™ä¸ªç›®çš„
ä¸€æ˜¯æ­£å¥½çœ‹ä½ çš„æŠ€æœ¯æ·±åº¦ï¼ŒäºŒæ˜¯çœ‹ä¸€ä¸‹è¡¨è¾¾èƒ½åŠ›ï¼Œå³ä½¿çœŸçš„æ²¡æœ‰å¾ˆéš¾çš„ç‚¹ï¼Œä¹Ÿè®²ä¸€ä¸‹è‡ªå·±è®¤ä¸ºæ¯”è¾ƒè´¹åŠ²å®ç°çš„
åŠŸèƒ½ï¼Œæ¸…æ™°æµç•…å‡†ç¡®çš„è¡¨è¾¾å‡ºæ¥ä¹Ÿæ˜¯å¾ˆåŠ åˆ†çš„</p>
<h3 data-id="heading-2">å…«è‚¡è¿˜æ˜¯ä¼šé—®çš„</h3>
<p>AIå†²å‡»ä¸‹é—®å…«è‚¡æ–‡å¥½åƒæ²¡å•¥æ„ä¹‰äº†ï¼Œä¸ä¼šçš„éƒ½é—®ä¸€ä¸‹AIå°±è¡Œäº†ï¼Œä½†æ˜¯å¤šå¤šå°‘å°‘è¿˜æ˜¯æœ‰æ„ä¹‰çš„</p>
<p>ä¸€ä¸ªèŠ‚æµé˜²æŠ–ä½¿ç”¨åœºæ™¯éƒ½è¯´ä¸ä¸Šæ¥çš„äººï¼Œå³ä½¿åœ¨AIçš„åŠ æŒä¸‹ï¼Œå…¶å®åŠ›æˆ‘ä¹ŸæŒæ€€ç–‘æ€åº¦</p>
<p>åˆšæ¯•ä¸šçš„æ ¡æ‹›ç”Ÿè¯´ä¸ä¸Šæ¥ä¹Ÿå°±ç®—äº†ï¼Œå·¥ä½œä¸‰å¹´ä¸çŸ¥é“èŠ‚æµé˜²æŠ–å¥½åƒå¤šå¤šå°‘å°‘æœ‰ç‚¹è¯´ä¸è¿‡å»äº†</p>
<h3 data-id="heading-3">å­¦å†è¿˜æ˜¯å¥½ä½¿</h3>
<p>å¦ç™½è®²ï¼Œé‡åˆ°é«˜å­¦å†çš„ï¼Œå¯¹å…¶æŠ€æœ¯è¦æ±‚ç¡®å®æ”¾æ¾äº†æ¡ä»¶ï¼Œæˆ‘ä¹Ÿæƒ³è¯´ç¨‹åºå‘˜æœ€é‡è¦çš„æ˜¯æŠ€æœ¯å®åŠ›ï¼Œå­¦å†ä¸é‡è¦</p>
<p>ä½†æ˜¯çœŸæ­£è½®åˆ°è‡ªå·±çš„æ—¶å€™ï¼ŒæŠ€æœ¯å®åŠ›æœ‰æ—¶å€™ä¸å¦‚å­¦å†é‚£ä¹ˆæ˜æ˜¾ï¼Œå¯é‡åŒ–</p>
<p>ä»¥åŠé¢†å¯¼ä¸€å¬XXå¤§å­¦çš„ï¼Œä»–ä¹Ÿè®¤å¯ï¼Œä¸ç„¶è¿˜å¾—è¯æ˜è¿™äººä¸é”™</p>
<p>æ‰€ä»¥ä½ çœ‹ï¼Œåªè¦ä½ èƒ½è¯æ˜ä½ çš„å®åŠ›ä¼˜åŠ¿å¤§äºå­¦å†çš„åŠ£åŠ¿ï¼Œé‚£ä¹ˆå­¦å†å®Œå…¨ä¸æ˜¯é—®é¢˜</p>
<p>åªå¯æƒœå¯¹å¤§éƒ¨åˆ†äººæ¥è®²å®åŠ›åŠ£åŠ¿ä¸å­¦å†åŠ£åŠ¿å…±å­˜ï¼ˆåˆ«éª‚äº†åˆ«éª‚äº†ï¼‰</p>
<h3 data-id="heading-4">åœ¨çº¿ç®€å†ã€Blogã€Github</h3>
<p>ç®€å†ä¸­æœ‰åœ¨çº¿ç®€å†ã€Blogã€Githubç­‰ï¼Œè¿˜æ˜¯æ¯”è¾ƒåŠ åˆ†çš„ï¼Œå¯èƒ½å¯¹äºå¤§å…¬å¸æ¥è®²ï¼Œä½ çš„githubæ²¡æœ‰å¾ˆé«˜starï¼Œåˆ«äººä¸è§‰å¾—ä½ ä¼˜ç§€</p>
<p>ä½†æ˜¯å¯¹äºå°å…¬å¸æ¥æ—¶ï¼Œä½ æœ‰Githubï¼Œè‡³å°‘è¯æ˜ä½  ç”¨å¿ƒä¸€äº›ï¼Œä»¥åŠè‡ªå·±æƒ³æ¢ç´¢ä¸€äº›é¡¹ç›®</p>
<h3 data-id="heading-5">é¢è¯•çœŸå°±æ˜¯ç¢°è¿æ°”</h3>
<p>é¢è¯•å®˜ä¹Ÿæ˜¯åœ¨ç¹å¿™çš„å·¥ä½œä¸­ä¸ä½ æ²Ÿé€šï¼Œå¯èƒ½é¢è¯•ä¸è¿‡å°±æ˜¯ä¸å’Œé¢è¯•å®˜çš„â€œèƒƒå£â€ï¼Œæ‰€ä»¥å¤§å®¶åƒä¸‡åˆ«ç°å¿ƒä¸§æ°”</p>
<h3 data-id="heading-6">END</h3>
<p>ä»¥ä¸Šæ˜¯æˆ‘è‡ªå·±çš„ä¸€äº›çœ‹æ³•ï¼Œç¥å¤§å®¶ä¸€äº›é¡ºåˆ©</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡è¯»æ‡‚ Uniapp å°ç¨‹åºç™»å½•æµç¨‹]]></title>    <link>https://juejin.cn/post/7573579203461480499</link>    <guid>https://juejin.cn/post/7573579203461480499</guid>    <pubDate>2025-11-18T03:01:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573579203461480499" data-draft-id="7572939250586222643" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡è¯»æ‡‚ Uniapp å°ç¨‹åºç™»å½•æµç¨‹"/> <meta itemprop="keywords" content="å‰ç«¯,uni-app,å¾®ä¿¡å°ç¨‹åº"/> <meta itemprop="datePublished" content="2025-11-18T03:01:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lsx_"/> <meta itemprop="url" content="https://juejin.cn/user/1442981392682829"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡è¯»æ‡‚ Uniapp å°ç¨‹åºç™»å½•æµç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442981392682829/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lsx_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T03:01:46.000Z" title="Tue Nov 18 2025 03:01:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å¾®ä¿¡å°ç¨‹åºç™»å½•åŸç†</h2>
<p>ç™»å½•çš„æ ‡å‡†æµç¨‹å¦‚ä¸‹ï¼š</p>



































<table><thead><tr><th>æ­¥éª¤</th><th>åŠ¨ä½œ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>1</td><td>å°ç¨‹åºç«¯è°ƒç”¨Â <code>uni.login()</code></td><td>è·å–Â <code>code</code>ï¼ˆä¸´æ—¶ç™»å½•å‡­è¯ï¼‰</td></tr><tr><td>2</td><td>å°ç¨‹åºç«¯æŠŠÂ <code>code</code>Â å‘ç»™è‡ªå·±çš„æœåŠ¡å™¨</td><td>é€šå¸¸æ˜¯Â <code>/api/login</code></td></tr><tr><td>3</td><td>æœåŠ¡å™¨è¯·æ±‚å¾®ä¿¡æ¥å£Â <code>https://api.weixin.qq.com/sns/jscode2session</code></td><td>ç”¨Â <code>appid + secret + code</code>Â æ¢å–Â <code>openid</code>Â å’ŒÂ <code>session_key</code></td></tr><tr><td>4</td><td>æœåŠ¡å™¨ç”Ÿæˆè‡ªå·±çš„ token è¿”å›å‰ç«¯</td><td>å¯¹åº”å¹³å°ç”¨æˆ·èº«ä»½</td></tr><tr><td>5</td><td>å°ç¨‹åºä¿å­˜ token å¹¶ç™»å½•æˆåŠŸ</td><td>ä¸‹æ¬¡å¯åŠ¨å¯ç›´æ¥ä½¿ç”¨</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-1">äºŒã€å‰ç«¯å¼€å‘ï¼ˆUniApp + Vue3ï¼‰</h2>
<h4 data-id="heading-2">ç™»å½•é¡µé¢ä»£ç </h4>
<p><code>/pages/login/login.vue</code></p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"title"</span>&gt;</span>æ¬¢è¿ä½¿ç”¨å°ç¨‹åº<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleLogin"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-btn"</span>&gt;</span>å¾®ä¿¡ä¸€é”®ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> token = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">ref</span>({})

<span class="hljs-comment">// å¾®ä¿¡ç™»å½•</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogin</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// 1. è·å– code</span>
    <span class="hljs-keyword">const</span> { code } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      uni.<span class="hljs-title function_">login</span>({
        <span class="hljs-attr">provider</span>: <span class="hljs-string">'weixin'</span>,
        <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-title function_">resolve</span>(res),
        <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-title function_">reject</span>(err)
      })
    })
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å°ç¨‹åºç™»å½•å‡­è¯ code:'</span>, code)

    <span class="hljs-comment">// 2. å‘é€åˆ°åç«¯</span>
    <span class="hljs-keyword">const</span> [err, res] = <span class="hljs-keyword">await</span> uni.<span class="hljs-title function_">request</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">'http://localhost:3000/api/login'</span>, <span class="hljs-comment">// åç«¯æ¥å£åœ°å€</span>
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">data</span>: { code }
    })
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>)

    <span class="hljs-comment">// 3. å¤„ç†åç«¯è¿”å›æ•°æ®</span>
    token.<span class="hljs-property">value</span> = res.<span class="hljs-property">data</span>.<span class="hljs-property">token</span>
    user.<span class="hljs-property">value</span> = res.<span class="hljs-property">data</span>.<span class="hljs-property">user</span>

    uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'token'</span>, token.<span class="hljs-property">value</span>)
    uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'userInfo'</span>, user.<span class="hljs-property">value</span>)

    uni.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">title</span>: <span class="hljs-string">'ç™»å½•æˆåŠŸ'</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">'success'</span> })
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç™»å½•ç»“æœ:'</span>, res.<span class="hljs-property">data</span>)
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e)
    uni.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">title</span>: <span class="hljs-string">'ç™»å½•å¤±è´¥'</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">'none'</span> })
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">200</span>rpx;
  <span class="hljs-attribute">text-align</span>: center;
}
<span class="hljs-selector-class">.title</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">40</span>rpx;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">80</span>rpx;
}
<span class="hljs-selector-class">.login-btn</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#07c160</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">80%</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12</span>rpx;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<blockquote>
<p>âœ… ç‚¹å‡»æŒ‰é’®ä¼šè‡ªåŠ¨æ‰§è¡Œå¾®ä¿¡ç™»å½•æµç¨‹ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€åç«¯å®ç°ï¼ˆNode.jsï¼‰</h2>
<h4 data-id="heading-4">1ï¸âƒ£ ç¯å¢ƒæ­å»º</h4>
<p>åˆ›å»ºä¸€ä¸ªÂ <code>server</code>Â æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">npm <span class="hljs-keyword">init</span> -y
npm install express axios jsonwebtoken cors
</code></pre>
<h4 data-id="heading-5">2ï¸âƒ£ åˆ›å»ºÂ <code>server.js</code></h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>)
<span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>)
<span class="hljs-keyword">const</span> jwt = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jsonwebtoken'</span>)
<span class="hljs-keyword">const</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>)

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>())
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>())

<span class="hljs-comment">// ä½ çš„å¾®ä¿¡å°ç¨‹åºä¿¡æ¯</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">APPID</span> = <span class="hljs-string">'ä½ çš„å°ç¨‹åºAppID'</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SECRET</span> = <span class="hljs-string">'ä½ çš„å°ç¨‹åºAppSecret'</span>

<span class="hljs-comment">// tokenå¯†é’¥</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">JWT_SECRET</span> = <span class="hljs-string">'my_secret_key'</span>

<span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®åº“</span>
<span class="hljs-keyword">const</span> users = {}

<span class="hljs-comment">// ç™»å½•æ¥å£</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/login'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">const</span> { code } = req.<span class="hljs-property">body</span>
  <span class="hljs-keyword">if</span> (!code) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'ç¼ºå°‘code'</span> })

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// è¯·æ±‚å¾®ä¿¡APIæ¢å–openidå’Œsession_key</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(
      <span class="hljs-string">`https://api.weixin.qq.com/sns/jscode2session`</span>, {
        <span class="hljs-attr">params</span>: {
          <span class="hljs-attr">appid</span>: <span class="hljs-variable constant_">APPID</span>,
          <span class="hljs-attr">secret</span>: <span class="hljs-variable constant_">SECRET</span>,
          <span class="hljs-attr">js_code</span>: code,
          <span class="hljs-attr">grant_type</span>: <span class="hljs-string">'authorization_code'</span>
        }
      }
    )

    <span class="hljs-keyword">const</span> { openid, session_key, errcode, errmsg } = response.<span class="hljs-property">data</span>
    <span class="hljs-keyword">if</span> (errcode) {
      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'å¾®ä¿¡ç™»å½•å¤±è´¥: '</span> + errmsg })
    }

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·openid:'</span>, openid)

    <span class="hljs-comment">// æ¨¡æ‹Ÿåˆ›å»º/æ›´æ–°ç”¨æˆ·</span>
    <span class="hljs-keyword">if</span> (!users[openid]) {
      users[openid] = { openid, <span class="hljs-attr">createTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>() }
    }

    <span class="hljs-comment">// ç”Ÿæˆè‡ªå®šä¹‰ token</span>
    <span class="hljs-keyword">const</span> token = jwt.<span class="hljs-title function_">sign</span>({ openid }, <span class="hljs-variable constant_">JWT_SECRET</span>, { <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">'7d'</span> })

    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>({
      token,
      <span class="hljs-attr">user</span>: users[openid]
    })
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err)
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'æœåŠ¡å™¨é”™è¯¯'</span> })
  }
})

<span class="hljs-comment">// éªŒè¯ token æ¥å£ï¼ˆç¤ºä¾‹ï¼‰</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/profile'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> auth = req.<span class="hljs-property">headers</span>.<span class="hljs-property">authorization</span>
  <span class="hljs-keyword">if</span> (!auth) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">401</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·å…ˆç™»å½•'</span> })

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> decoded = jwt.<span class="hljs-title function_">verify</span>(auth.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'Bearer '</span>, <span class="hljs-string">''</span>), <span class="hljs-variable constant_">JWT_SECRET</span>)
    res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">user</span>: users[decoded.<span class="hljs-property">openid</span>] })
  } <span class="hljs-keyword">catch</span> {
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">401</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'tokenæ— æ•ˆ'</span> })
  }
})

<span class="hljs-comment">// å¯åŠ¨æœåŠ¡å™¨</span>
app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'âœ… Server running on http://localhost:3000'</span>)
})
</code></pre>
<blockquote>
<p>âœ… å¯åŠ¨å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-vbscript" lang="vbscript">node <span class="hljs-built_in">server</span>.js
</code></pre>
</blockquote>
<hr/>
<h2 data-id="heading-6">å››ã€è¿è¡Œæµ‹è¯•</h2>
<ol>
<li>
<p>å¯åŠ¨åç«¯ï¼š</p>
<pre><code class="hljs language-vbscript" lang="vbscript">node <span class="hljs-built_in">server</span>.js
</code></pre>
</li>
<li>
<p>æ‰“å¼€ HBuilderX â†’ è¿è¡Œ â†’ è¿è¡Œåˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…·</p>
</li>
<li>
<p>ç‚¹å‡» â€œä¸€é”®ç™»å½•â€ï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡º</p>
<ul>
<li>å°ç¨‹åºç«¯æ—¥å¿—ä¼šæ‰“å°Â <code>code</code></li>
<li>åç«¯ä¼šæ‰“å°Â <code>openid</code></li>
</ul>
</li>
<li>
<p>Toast æç¤º â€œç™»å½•æˆåŠŸâ€ âœ…</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-7">äº”ã€æŒä¹…åŒ–ç™»å½•</h2>
<p>ç™»å½•æˆåŠŸåï¼š</p>
<ul>
<li>å°† token å­˜åˆ°Â <code>uni.setStorageSync('token', token)</code></li>
<li>ä¸‹æ¬¡å¯åŠ¨æ—¶åˆ¤æ–­æœ¬åœ°æ˜¯å¦æœ‰ tokenï¼Œæœ‰åˆ™ä¸å†é‡å¤ç™»å½•ã€‚</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åœ¨ App.vue çš„ onLaunch ä¸­</span>
<span class="hljs-title function_">onLaunch</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> token = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'token'</span>)
  <span class="hljs-keyword">if</span> (token) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·å·²ç™»å½•:'</span>, token)
  } <span class="hljs-keyword">else</span> {
    uni.<span class="hljs-title function_">reLaunch</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/login/login'</span> })
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-8">å…­ã€é‡ç‚¹æ€»ç»“</h2>



































<table><thead><tr><th>æ¨¡å—</th><th>å·¥å…·</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>å‰ç«¯</td><td>uni.login()</td><td>è·å– code</td></tr><tr><td>å‰ç«¯</td><td>uni.request()</td><td>è°ƒåç«¯ç™»å½•æ¥å£</td></tr><tr><td>åç«¯</td><td>axios è¯·æ±‚å¾®ä¿¡æ¥å£</td><td>ç”¨ code æ¢ openid</td></tr><tr><td>åç«¯</td><td>jsonwebtoken</td><td>ç”Ÿæˆè‡ªå®šä¹‰ token</td></tr><tr><td>å‰ç«¯</td><td>uni.setStorageSync</td><td>ä¿å­˜ token</td></tr></tbody></table>
<hr/>
<p>âœ…Â <strong>æœ€ç»ˆæ•ˆæœï¼š</strong></p>
<ul>
<li>ç‚¹å‡»ç™»å½•æŒ‰é’® â†’ è‡ªåŠ¨é€šè¿‡å¾®ä¿¡æˆæƒç™»å½•</li>
<li>åç«¯ç”ŸæˆÂ <code>token</code>Â å¹¶è¿”å›</li>
<li>å‰ç«¯ä¿å­˜ç™»å½•çŠ¶æ€</li>
<li>å¯æ‰©å±•ä¸ºç”¨æˆ·æ³¨å†Œã€ç»‘å®šæ‰‹æœºå·ç­‰åŠŸèƒ½ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰‘æŒ‡offer-38ã€â¼†å‰æ ‘çš„æ·±åº¦]]></title>    <link>https://juejin.cn/post/7573579203460513843</link>    <guid>https://juejin.cn/post/7573579203460513843</guid>    <pubDate>2025-11-18T01:12:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573579203460513843" data-draft-id="7572566115848798258" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰‘æŒ‡offer-38ã€â¼†å‰æ ‘çš„æ·±åº¦"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-11-18T01:12:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰‘æŒ‡offer-38ã€â¼†å‰æ ‘çš„æ·±åº¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:12:48.000Z" title="Tue Nov 18 2025 01:12:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é¢˜â½¬æè¿°</h2>
<p>è¾“â¼Šâ¼€æ£µâ¼†å‰æ ‘ï¼Œæ±‚è¯¥æ ‘çš„æ·±åº¦ã€‚ä»æ ¹ç»“ç‚¹åˆ°å¶ç»“ç‚¹ä¾æ¬¡ç»è¿‡çš„ç»“ç‚¹ï¼ˆå«æ ¹ã€å¶ç»“ç‚¹ï¼‰å½¢æˆæ ‘çš„â¼€æ¡è·¯å¾„ï¼Œæœ€â»“è·¯å¾„çš„â»“åº¦ä¸ºæ ‘çš„æ·±åº¦ã€‚</p>
<p>ç¤ºä¾‹1
è¾“â¼Šï¼š{1,2,3,4,5,#,6,#,#,7}
è¿”å›å€¼ï¼š4</p>
<h2 data-id="heading-1">æ€è·¯åŠè§£ç­”</h2>
<p>å£°æ˜ï¼šè¿™â¾¥çš„è¾“â¼Šæ˜¯â¼€ä¸ªæ•°çš„æ ¹èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ä»æ ¹èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œâ½½ç±»ä¼¼æ•°ç»„çš„è¡¨è¾¾â½…å¼ {1,2,3,4,5,#,6,#,#,7} ï¼Œåˆ™æ˜¯æŒ‰ç…§å±‚æ¬¡æ¥æ”¾çš„ã€‚(â½å¦‚è¿™ä¸ªæ ‘å°±æ˜¯4å±‚)</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8da78b9033b49a8ab2ab2c0db621ad8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033168&amp;x-signature=yd%2F6utyQW120c%2F1lli9SAfdg6tQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">é€’å½’</h3>
<p>ç¬¬â¼€ç§â½…æ³•â½è¾ƒå®¹æ˜“æƒ³åˆ°ï¼Œå¯¹äºä»»æ„â¼€ä¸ªèŠ‚ç‚¹ node â½½â¾”ï¼Œæˆ‘è¦æƒ³çŸ¥é“å½“å‰ node èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬å½“å‰èŠ‚ç‚¹ï¼‰çš„æ·±åº¦ï¼Œè‚¯å®šå¾—æ±‚å½“å‰èŠ‚ç‚¹çš„å·¦è¾¹èŠ‚ç‚¹ï¼ˆè®¾ä¸º left ï¼‰çš„æ·±åº¦ leftDeepth ï¼Œä»¥åŠè·å–å³èŠ‚ç‚¹ï¼ˆè®¾ä¸º right ï¼‰çš„æ·±åº¦ rightDeepth ï¼Œç„¶åæ±‚ä¸¤è€…æœ€â¼¤+1ï¼ˆ Max{leftDeepth,rightDeepth}+1 ï¼‰ï¼Œå°±æ˜¯å½“å‰èŠ‚ç‚¹çš„æ·±åº¦ã€‚</p>
<p>æ€è·¯ï¼šäºŒå‰æ ‘çš„æ·±åº¦ = max(å·¦å­æ ‘æ·±åº¦, å³å­æ ‘æ·±åº¦) + 1</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3b5a62a8a244fb082de720e34813910~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033168&amp;x-signature=d8URAlqbKLcnFVhBoHeiJByq0kU%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b7f5fefa5914e5e992d14aa5c2fefc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033168&amp;x-signature=lYOodImiRMHQ49rSPWj6UYSpi5A%3D" alt="" loading="lazy"/></p>
<p>â½½é€’å½’ä¸­â½è¾ƒé‡è¦çš„â¼€ç‚¹ï¼Œæ˜¯ç»“æŸæ¡ä»¶ã€‚åœ¨è¿™é“é¢˜ä¸­ï¼Œå¦‚æœâ¼€ä¸ªèŠ‚ç‚¹ä¸º null ï¼Œå°±ç»“æŸï¼Œå¹¶ä¸”å½“å‰èŠ‚ç‚¹çš„æ·±åº¦æ˜¯ 0 ã€‚ä»£ç è¶…çº§â½†æ•ŒçŸ­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
     <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">TreeDepth</span><span class="hljs-params">(TreeNode root)</span> {
         <span class="hljs-keyword">if</span>(root==<span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
         <span class="hljs-keyword">return</span> Math.max(TreeDepth(root.left),TreeDepth(root.right))+<span class="hljs-number">1</span>;
     }
}
</code></pre>
<p>ä»¥ä¸Šè§£æ³•è¦æ˜¯çœ‹ä¸æ˜ç™½ï¼Œå¯ä»¥çœ‹è¯¦ç»†ç‚¹çš„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">TreeDepth</span><span class="hljs-params">(TreeNode root)</span> {
        <span class="hljs-comment">// é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼šç©ºèŠ‚ç‚¹æ·±åº¦ä¸º0</span>
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-comment">// é€’å½’è®¡ç®—å·¦å­æ ‘æ·±åº¦</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">leftDepth</span> <span class="hljs-operator">=</span> maxDepth(root.left);
        <span class="hljs-comment">// é€’å½’è®¡ç®—å³å­æ ‘æ·±åº¦</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">rightDepth</span> <span class="hljs-operator">=</span> maxDepth(root.right);
        
        <span class="hljs-comment">// å½“å‰æ ‘æ·±åº¦ = å·¦å³å­æ ‘æœ€å¤§æ·±åº¦ + 1ï¼ˆå½“å‰èŠ‚ç‚¹ï¼‰</span>
        <span class="hljs-keyword">return</span> Math.max(leftDepth, rightDepth) + <span class="hljs-number">1</span>;
    }
}
</code></pre>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œéœ€è¦è®¿é—®æ¯ä¸ªèŠ‚ç‚¹ä¸€æ¬¡</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(h)ï¼Œé€’å½’æ ˆæ·±åº¦ç­‰äºæ ‘é«˜ï¼Œæœ€åæƒ…å†µï¼ˆé“¾è¡¨ï¼‰ä¸ºO(n)</li>
</ul>
<h3 data-id="heading-3">è¿­ä»£éå†</h3>
<p>æ€è·¯æ˜¯å¦‚æœæ ‘çš„æ ¹èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™å°†æ ¹èŠ‚ç‚¹æ”¾è¿›é˜Ÿåˆ—ä¸­ã€‚ä¹Ÿå°±æ˜¯ï¼Œæ¯éå†ä¸€å±‚ï¼Œæ·±åº¦åŠ 1ï¼Œç›´åˆ°éå†å®Œæ‰€æœ‰å±‚</p>
<p>è®¾ç½®æ·±åº¦ deep ä¸º0ã€‚ä½¿â½¤ while å¾ªç¯ï¼Œåªè¦é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œåˆ™æ‰§â¾ä¸‹â¾¯æ“ä½œï¼š</p>
<ol>
<li>è·å–é˜Ÿåˆ—çš„â¼¤â¼© size ã€‚</li>
<li>ä¾æ¬¡å–å‡ºé˜Ÿåˆ—çš„å‰ size ä¸ªå…ƒç´ ï¼Œå¦‚æœè¯¥å…ƒç´ çš„å·¦è¾¹èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™å°†å·¦è¾¹èŠ‚ç‚¹æ”¾è¿›é˜Ÿåˆ—ï¼Œå¦‚æœè¯¥å…ƒç´ çš„å³è¾¹èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™å°†è¯¥å…ƒç´ çš„å³è¾¹èŠ‚ç‚¹æ”¾è¿›é˜Ÿåˆ—ã€‚</li>
<li>å±‚æ¬¡ deep+1</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">TreeDepth</span><span class="hljs-params">(TreeNode root)</span> {
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        
        Queue&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();
        queue.offer(root);
        <span class="hljs-type">int</span> <span class="hljs-variable">depth</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-keyword">while</span> (!queue.isEmpty()) {
            <span class="hljs-comment">// å½“å‰å±‚çš„èŠ‚ç‚¹ä¸ªæ•°</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">levelSize</span> <span class="hljs-operator">=</span> queue.size();
            
            <span class="hljs-comment">// éå†å½“å‰å±‚çš„æ‰€æœ‰èŠ‚ç‚¹</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; levelSize; i++) {
                <span class="hljs-type">TreeNode</span> <span class="hljs-variable">currentNode</span> <span class="hljs-operator">=</span> queue.poll();
                
                <span class="hljs-comment">// å°†ä¸‹ä¸€å±‚èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—</span>
                <span class="hljs-keyword">if</span> (currentNode.left != <span class="hljs-literal">null</span>) {
                    queue.offer(currentNode.left);
                }
                <span class="hljs-keyword">if</span> (currentNode.right != <span class="hljs-literal">null</span>) {
                    queue.offer(currentNode.right);
                }
            }
            
            <span class="hljs-comment">// å®Œæˆä¸€å±‚éå†ï¼Œæ·±åº¦åŠ 1</span>
            depth++;
        }
        
        <span class="hljs-keyword">return</span> depth;
    }
}
</code></pre>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n)ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éœ€è¦è¿›â¼Šé˜Ÿåˆ—ï¼Œå†å‡ºé˜Ÿåˆ—</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼šO(n),å€ŸåŠ©äº†é¢å¤–çš„é˜Ÿåˆ—ç©ºé—´ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰–æ LangGraph çš„ Super-step æ¦‚å¿µ]]></title>    <link>https://juejin.cn/post/7573512056089952291</link>    <guid>https://juejin.cn/post/7573512056089952291</guid>    <pubDate>2025-11-18T01:14:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573512056089952291" data-draft-id="7573299401047031854" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰–æ LangGraph çš„ Super-step æ¦‚å¿µ"/> <meta itemprop="keywords" content="LangChain"/> <meta itemprop="datePublished" content="2025-11-18T01:14:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ALLINAI"/> <meta itemprop="url" content="https://juejin.cn/user/4001878056639549"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰–æ LangGraph çš„ Super-step æ¦‚å¿µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4001878056639549/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ALLINAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:14:39.000Z" title="Tue Nov 18 2025 01:14:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>Super-step æ˜¯ LangGraph çš„æ‰§è¡Œå•ä½ â€”â€” ä¸€ä¸ªâ€œåŒæ­¥çš„æ‰¹å¤„ç†è½®æ¬¡â€</strong>ã€‚åœ¨æ¯ä¸ª super-step ä¸­ï¼Œæ¡†æ¶ä¼šå¹¶è¡Œ/æ‰¹é‡åœ°è¿è¡Œå½“å‰æ‰€æœ‰å¯æ‰§è¡ŒèŠ‚ç‚¹ï¼Œæ”¶é›†å®ƒä»¬çš„å†™å…¥ï¼ˆupdatesï¼‰ï¼Œç”¨äº‹å…ˆå®šä¹‰å¥½çš„ reducer æŠŠå†™å…¥åˆå¹¶æˆä¸€ä¸ªæ–°çš„å…¨å±€çŠ¶æ€ï¼ˆsnapshotï¼‰ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€ä¸ª super-stepã€‚æ¯ä¸ª super-step ç»“æŸéƒ½ä¼šå½¢æˆä¸€ä¸ª checkpointï¼ˆå¿«ç…§ï¼‰ï¼Œç”¨äºæŒä¹…åŒ–ã€æ¢å¤ã€å›æ”¾ä¸æ—¶é—´æ—…è¡Œã€‚</p>
</blockquote>
<p>ä¸‹é¢æŠŠè¿™ä¸ªæ¦‚å¿µä»é«˜å±‚åˆ°ç»†èŠ‚ã€ä»è®¾è®¡æ€æƒ³åˆ°å·¥ç¨‹å®ç°ï¼Œç³»ç»Ÿè®²æ¸…æ¥šâ€”â€”åŒ…æ‹¬ä¸ºä»€ä¹ˆè¦è¿™æ ·åšã€åº•å±‚å¦‚ä½•å®ç°ã€å¹¶å‘æ¨¡å‹å¦‚ä½•ä»‹å…¥ã€ä¸ checkpoint çš„å…³ç³»ã€å¸¸è§ç”¨æ³•ä¸è°ƒè¯•æŠ€å·§ç­‰ã€‚</p>
<hr/>
<h2 data-id="heading-0">1. æ¦‚å¿µé€Ÿè§ˆï¼ˆä¸€å¥è¯ï¼‰</h2>
<p><strong>super-step = ä¸€è½®å¹¶è¡Œæ‰§è¡Œ + æ”¶é›†æ‰€æœ‰èŠ‚ç‚¹å†™å…¥ + ç”¨ reducer åŸå­åˆå¹¶åˆ°å…¨å±€çŠ¶æ€ + ç”Ÿæˆ checkpoint</strong>ã€‚
å®ƒæ¥æºäº Pregel / BSPï¼ˆBulk Synchronous Parallelï¼‰æ¨¡å‹ï¼Œæ˜¯ LangGraph çš„æ ¸å¿ƒæ‰§è¡Œè¯­ä¹‰ã€‚</p>
<hr/>
<h2 data-id="heading-1">2. ä¸ºä»€ä¹ˆç”¨ super-stepï¼ˆè®¾è®¡åŠ¨æœºï¼‰</h2>
<ul>
<li><strong>ä¸€è‡´æ€§</strong>ï¼šåœ¨åŒä¸€è½®æ¬¡å†…æ‰€æœ‰èŠ‚ç‚¹çœ‹åˆ°çš„çŠ¶æ€ç›¸åŒï¼ˆè¯»æ—¶ç‚¹ä¸€è‡´ï¼ŒRead-time Consistencyï¼‰ï¼Œå†™å…¥åˆå¹¶æ—¶ç»Ÿä¸€å¤„ç†ï¼Œé¿å…äº¤å‰ä¾èµ–å¯¼è‡´çš„ä¸ç¡®å®šæ€§ã€‚</li>
<li><strong>å¯æ¢å¤ / å¯å›æ”¾</strong>ï¼šæ¯è½®ç»“æŸå³ checkpointï¼Œä¾¿äºæ¢å¤ã€æ—¶é—´æ—…è¡Œã€human-in-the-loopã€‚</li>
<li><strong>å¹¶è¡Œè¡¨è¾¾åŠ›</strong>ï¼šå¤šä¸ªé€»è¾‘ä¸Šç‹¬ç«‹çš„èŠ‚ç‚¹å¯ä»¥åœ¨åŒä¸€è½®æ¬¡ä¸­å¹¶å‘æ‰§è¡Œï¼Œé€‚åˆå¹¶è¡Œä»»åŠ¡ä¸ agent åä½œåœºæ™¯ã€‚</li>
<li><strong>æ˜ç¡®çš„åˆå¹¶è¯­ä¹‰</strong>ï¼šé€šè¿‡ reducerï¼ˆæˆ–é»˜è®¤è¦†ç›–è§„åˆ™ï¼‰å®šä¹‰å¦‚ä½•æŠŠå¤šä¸ªèŠ‚ç‚¹çš„å†™å…¥åˆå¹¶ä¸ºä¸€ä¸ªçŠ¶æ€ï¼Œä¾¿äºè®¾è®¡ç´¯ç§¯å‹å­—æ®µï¼ˆä¾‹å¦‚åˆ—è¡¨ç´¯åŠ ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-2">3. super-step çš„æ‰§è¡Œæµç¨‹ï¼ˆåˆ†æ­¥éª¤è¯¦è§£ï¼‰</h2>
<ol>
<li>
<p><strong>å‘ç° active nodes</strong></p>
<ul>
<li>æ ¹æ®å½“å‰ stateã€å›¾ç»“æ„ä»¥åŠä¸Šæ¬¡åˆå¹¶ç»“æœå†³å®šå“ªäº›èŠ‚ç‚¹åœ¨æœ¬è½®å¯æ‰§è¡Œï¼ˆrunnable / activeï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ‰§è¡Œ active nodesï¼ˆå¹¶å‘æˆ–ä¸²è¡Œï¼‰</strong></p>
<ul>
<li>æ‰§è¡Œå‡½æ•°/èŠ‚ç‚¹ä½“ï¼Œå¾—åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„è¾“å‡ºï¼ˆé€šå¸¸åŒ…å« <code>update</code> å­—æ®µï¼Œå’Œ <code>goto</code> / control æŒ‡ä»¤ï¼‰ã€‚</li>
<li>èŠ‚ç‚¹è¾“å‡ºå…ˆå†™å…¥ä¸´æ—¶ç¼“å†²åŒºï¼ˆä¸ä¼šç«‹å³æ”¹å˜å…¨å±€ stateï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ”¶é›†æ‰€æœ‰ writes</strong></p>
<ul>
<li>æ±‡æ€»æ‰€æœ‰èŠ‚ç‚¹çš„ <code>update</code>ï¼ˆçŠ¶æ€å†™å…¥ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¯¹æ¯ä¸ªå­—æ®µæ‰§è¡Œ reducer åˆå¹¶</strong></p>
<ul>
<li>å¦‚æœå­—æ®µè¢« Annotated æŒ‡å®šäº†åˆå¹¶ç­–ç•¥ï¼ˆä¾‹å¦‚ <code>add</code>ï¼‰ï¼Œå°±ç”¨è¯¥ç­–ç•¥åˆå¹¶ï¼›å¦åˆ™æŒ‰é»˜è®¤è§„åˆ™ï¼ˆé€šå¸¸è¦†ç›–ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿæˆæ–°çš„ state snapshotï¼ˆStateSnapshotï¼‰</strong></p>
<ul>
<li>åŒ…å« <code>values</code>ï¼ˆåˆå¹¶åçŠ¶æ€ï¼‰ã€<code>next</code>ï¼ˆä¸‹è½®è¦æ‰§è¡Œçš„èŠ‚ç‚¹ï¼‰ã€<code>metadata</code>ã€<code>tasks</code> ç­‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æŒä¹…åŒ– checkpointï¼ˆcheckpointerï¼‰</strong></p>
<ul>
<li>æŠŠ snapshot å†™å…¥ä¿å­˜å™¨ï¼ˆInMemory/SQLite/Postgres ç­‰ï¼‰ï¼Œç”¨äºæ¢å¤ä¸å›æ”¾ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¾ªç¯æˆ–ç»“æŸ</strong></p>
<ul>
<li>å¦‚æœè¿˜æœ‰å¯æ‰§è¡ŒèŠ‚ç‚¹ï¼Œç»§ç»­ä¸‹ä¸€è½® super-stepï¼Œå¦åˆ™å›¾æ‰§è¡Œç»“æŸã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-3">4. åº•å±‚å®ç°ï¼šè°ƒåº¦å™¨ã€å¹¶å‘ã€åŒæ­¥ï¼ˆå…³é”®ç‚¹ä¸ä¼ªä»£ç ï¼‰</h2>
<p><strong>å…³é”®ç‚¹ï¼šsuper-step æ˜¯è°ƒåº¦æ¨¡å‹ï¼Œä¸æ˜¯å¹¶å‘æ¨¡å‹ã€‚</strong> è°ƒåº¦å™¨è´Ÿè´£åˆ†é˜¶æ®µæ‰§è¡Œä¸åˆå¹¶ï¼Œä½†æ˜¯å¦å¹¶å‘å–å†³äºèŠ‚ç‚¹æœ¬èº«æˆ–è¿è¡Œæ—¶é€‰æ‹©ã€‚</p>
<p>ä¼ªä»£ç ï¼ˆé«˜åº¦æ¦‚æ‹¬ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python">state = initial_state
<span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> finished(state):
    active_nodes = discover_active_nodes(state)
    <span class="hljs-comment"># 1) å¹¶å‘æ‰§è¡Œæˆ–ä¸²è¡Œæ‰§è¡Œ active nodes çš„ node.run</span>
    results = parallel_map(execute_node, active_nodes)  <span class="hljs-comment"># å¯ä»¥æ˜¯å¹¶è¡Œï¼Œä¹Ÿå¯ä»¥æ˜¯åŒæ­¥</span>
    <span class="hljs-comment"># 2) æ”¶é›†æ‰€æœ‰ writes</span>
    all_writes = collect_writes(results)
    <span class="hljs-comment"># 3) æŒ‰å­—æ®µ reducer åˆå¹¶æˆ new_state</span>
    new_state = reduce_state(state, all_writes)
    <span class="hljs-comment"># 4) ç”Ÿæˆå¹¶æŒä¹…åŒ– checkpoint</span>
    checkpointer.save(snapshot=new_state, metadata=...)
    state = new_state
</code></pre>
<p>è¯´æ˜ï¼š</p>
<ul>
<li><code>parallel_map</code> å¯ä»¥ç”¨ <code>asyncio.gather</code>ï¼ˆè‹¥èŠ‚ç‚¹ä¸º asyncï¼‰æˆ– <code>ThreadPoolExecutor</code>ï¼ˆè‹¥ä½ å¸Œæœ›çº¿ç¨‹å¹¶å‘ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯æ™®é€š for-loopï¼ˆå•çº¿ç¨‹ï¼‰ã€‚æ¡†æ¶æœ¬èº«å¹¶ä¸å¼ºåˆ¶åˆ›å»ºçº¿ç¨‹ã€‚</li>
<li><code>reduce_state</code> æ˜¯åŸå­æ“ä½œï¼šåŸºäºæ¯ä¸ªå­—æ®µçš„åˆå¹¶ç­–ç•¥ï¼ˆAnnotated metadataï¼‰ï¼ŒæŠŠæ‰€æœ‰å†™å…¥åˆå¹¶æˆä¸€ä»½ä¸€è‡´çŠ¶æ€ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4">5. state åˆå¹¶ï¼ˆreducers / Annotated çš„è§’è‰²ï¼‰</h2>
<ul>
<li>
<p>LangGraph ä½¿ç”¨ Python ç±»å‹æ³¨è§£ï¼ˆ<code>typing.Annotated</code>ï¼‰æ¥ä¸ºçŠ¶æ€å­—æ®µ<strong>é™„åŠ å…ƒæ•°æ®</strong>ï¼Œå…¶ä¸­å¸¸è§å…ƒæ•°æ®æ˜¯â€œåˆå¹¶å‡½æ•°â€ï¼ˆreducerï¼‰ã€‚</p>
</li>
<li>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    foo: <span class="hljs-built_in">str</span>                  <span class="hljs-comment"># è¦†ç›–å¼ï¼ˆé»˜è®¤ï¼‰</span>
    bar: Annotated[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>], add]  <span class="hljs-comment"># ä½¿ç”¨ add åˆå¹¶ï¼ˆåˆ—è¡¨æ‹¼æ¥ï¼‰</span>
</code></pre>
</li>
<li>
<p>åœ¨ä¸€ä¸ª super-step ä¸­ï¼Œè‹¥ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å†™ <code>bar</code>ï¼Œæ¡†æ¶ä¼šè°ƒç”¨ <code>add(existing, new)</code> è€Œä¸æ˜¯ç®€å•æ›¿æ¢ï¼Œä»è€Œå®ç°ç´¯ç§¯è¯­ä¹‰ï¼ˆä¾‹å¦‚æ¶ˆæ¯é˜Ÿåˆ—ã€äº‹ä»¶æ”¶é›†ã€ç»“æœåˆå¹¶ï¼‰ã€‚</p>
</li>
</ul>
<p>è¿™æ˜¯ LangGraph æ”¯æŒå¹¶è¡ŒèŠ‚ç‚¹å†™å…¥è€Œä»èƒ½ä¿è¯ç¡®å®šæ€§çš„å…³é”®æœºåˆ¶ã€‚</p>
<hr/>
<h2 data-id="heading-5">6. super-step ä¸ checkpoint / æŒä¹…åŒ–çš„å…³ç³»</h2>
<ul>
<li><strong>æ¯ä¸ª super-step ç»“æŸéƒ½ä¼šäº§ç”Ÿä¸€ä¸ª checkpointï¼ˆStateSnapshotï¼‰</strong>ï¼ŒåŒ…å«å½“æ—¶çš„ <code>values</code>, <code>metadata</code>, <code>next</code>, <code>tasks</code> ç­‰ã€‚</li>
<li>Checkpoint æä¾›èƒ½åŠ›ï¼š<strong>æ¢å¤ï¼ˆrestoreï¼‰ã€å›æ”¾ï¼ˆreplayï¼‰ã€æ—¶é—´æ—…è¡Œï¼ˆforkï¼‰ã€äººæœºä¸­æ–­/resumeï¼ˆinterruptï¼‰</strong>ã€‚</li>
<li>åº•å±‚å®ç°æ˜¯å¯æ’æ‹”çš„ <code>checkpointer</code>ï¼ˆInMemorySaverã€SqliteSaverã€PostgresSaver ç­‰ï¼‰ï¼Œå¹¶é…åˆ <code>Serializer</code>ï¼ˆJsonPlus/EncryptedSerializerï¼‰åšåºåˆ—åŒ–/åŠ å¯†ã€‚</li>
</ul>
<p>å› æ­¤ super-step â‰ˆ æ‰§è¡Œå•ä½ï¼Œcheckpoint â‰ˆ è®°å¿†/æŒä¹…åŒ–å‰¯æœ¬ï¼Œä¸¤è€…åˆèµ·æ¥å°±æ˜¯å¯æ¢å¤å¯å®¡è®¡çš„æœ‰çŠ¶æ€æ‰§è¡Œå¼•æ“ã€‚</p>
<hr/>
<h2 data-id="heading-6">7. å¹¶å‘æ¨¡å‹ï¼šå¤šçº¿ç¨‹ã€åç¨‹è¿˜æ˜¯åŒæ­¥ï¼Ÿï¼ˆå·¥ç¨‹å®è·µï¼‰</h2>
<ul>
<li>
<p><strong>super-step æœ¬èº«æ˜¯åŒæ­¥çš„ã€åˆ†é˜¶æ®µçš„è°ƒåº¦æ¨¡å‹</strong>ï¼ˆBSPï¼‰ã€‚</p>
</li>
<li>
<p><strong>LangGraph ä¸å¼ºåˆ¶ä½¿ç”¨å¤šçº¿ç¨‹æˆ–åç¨‹</strong>ã€‚å®ƒåœ¨è®¾è®¡ä¸Šå…è®¸å¹¶å‘æ‰§è¡ŒèŠ‚ç‚¹ï¼Œä½†å¹¶å‘æ˜¯â€œå¯é€‰çš„æ‰§è¡Œç­–ç•¥â€ï¼Œç”±è¿è¡Œæ—¶ä¸èŠ‚ç‚¹ç±»å‹å†³å®šã€‚</p>
<ul>
<li>èŠ‚ç‚¹å¦‚æœæ˜¯ <code>async def</code>ï¼Œæ¡†æ¶å¯ä»¥ç”¨ <code>asyncio</code> æ‰§è¡Œï¼ˆåç¨‹ï¼‰ã€‚</li>
<li>ä½ ä¹Ÿå¯ä»¥åœ¨èŠ‚ç‚¹å†…éƒ¨è‡ªå·±ä½¿ç”¨çº¿ç¨‹æ± ï¼ˆ<code>ThreadPoolExecutor</code>ï¼‰æˆ–å¤–éƒ¨å¹¶å‘èµ„æºã€‚</li>
</ul>
</li>
<li>
<p>ä¼˜ç‚¹ï¼šè®©çŠ¶æ€åˆå¹¶ä¸ç¡®å®šæ€§ç•™åœ¨æ¡†æ¶å±‚ï¼ˆé¿å… race conditionï¼‰ï¼Œå¹¶å‘äº¤ç»™å¯æ§çš„æ‰§è¡Œç­–ç•¥ï¼ˆç”¨æˆ·æ˜¾å¼å¼€å¯ï¼‰ã€‚</p>
</li>
<li>
<p>è®¾è®¡ç†ç”±ï¼š<strong>å¯é‡ç°æ€§ä¸ç¡®å®šæ€§</strong>ã€‚è‡ªåŠ¨å¤šçº¿ç¨‹ä¼šå¸¦æ¥å†™å…¥é¡ºåºä¸ç¡®å®šï¼Œå½±å“ reducer è¡Œä¸ºä¸ snapshot ä¸€è‡´æ€§ã€‚</p>
</li>
</ul>
<p>ç®€è¨€ä¹‹ï¼š<strong>super-step ä¿è¯â€œä½•æ—¶åˆå¹¶â€ï¼Œå¹¶å‘å®ç°å†³å®šâ€œå¦‚ä½•å¹¶å‘æ‰§è¡ŒèŠ‚ç‚¹â€ã€‚</strong></p>
<hr/>
<h2 data-id="heading-7">8. å¸¸è§æ¨¡å¼ä¸ç¤ºä¾‹ï¼ˆå« Email Agent åœºæ™¯ï¼‰</h2>
<h3 data-id="heading-8">8.1 å¹¶è¡Œå†³ç­–ï¼ˆB å’Œ C åŒè½®æ‰§è¡Œï¼‰</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
START --&gt; A --&gt; B
A --&gt; C --&gt; END
</code></pre>
<p>æ‰§è¡Œï¼š</p>
<ul>
<li>step 1ï¼šæ‰§è¡Œ Aï¼Œåˆå¹¶ stateï¼Œcheckpoint</li>
<li>step 2ï¼šåŒæ—¶è¿è¡Œ B å’Œ Cï¼ˆåŒä¸€ super-stepï¼‰ï¼Œæ”¶é›†ä¸¤è€…å†™å…¥å¹¶åˆå¹¶ï¼Œcheckpoint</li>
</ul>
<h3 data-id="heading-9">8.2 Email Agent</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75c9dae04ea644ab9ca9dff9182a4c5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUxMSU5BSQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033279&amp;x-signature=O0g8DHMtWcyRYzD1CG%2F9X%2FQOfXU%3D" alt="graph.png" loading="lazy"/></p>
<ul>
<li>åˆå§‹ï¼š<code>read_email</code> â†’ <code>classify_intent</code></li>
<li>è‹¥åˆ†ç±»ä¸º <code>billing</code> ä¸” <code>critical</code>ï¼šè·¯ç”±åˆ° <code>human_review</code>ï¼ˆinterruptï¼‰</li>
<li>human_review ä¼šè§¦å‘ interruptï¼ˆä¸­æ–­ï¼‰å¹¶ç”Ÿæˆ checkpointï¼›ç¬¬ä¸€æ¬¡ invoke è¿”å›ä¸­æ–­ payloadï¼ˆæ²¡æœ‰ <code>draft_response</code>ï¼‰ï¼Œç­‰å¾…å¤–éƒ¨ resumeï¼ˆäººå·¥å®¡æ ¸ï¼‰</li>
<li>å½“ resume æäº¤ï¼ˆ<code>app.invoke(resume)</code>ï¼‰æ—¶ï¼Œä»ä¸­æ–­ç‚¹ç»§ç»­æ‰§è¡Œï¼Œè¿›å…¥ä¸‹ä¸€è½® super-step å¹¶åˆå¹¶æ¥è‡ªäººå·¥è¾“å…¥çš„æ›´æ–°ï¼ˆä¾‹å¦‚å·²æ‰¹å‡†çš„ <code>draft_response</code>ï¼‰ï¼Œç„¶åå‘é€é‚®ä»¶ï¼ˆsend_replyï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-10">9. ä¼˜åŠ¿ã€æƒè¡¡ä¸é™åˆ¶</h2>
<h3 data-id="heading-11">ä¼˜åŠ¿</h3>
<ul>
<li><strong>ç¡®å®šæ€§</strong>ï¼šç›¸åŒè¾“å…¥å’Œç›¸åŒ reducer é…ç½®ï¼Œæ‰§è¡Œå¯é‡å¤ï¼ˆå¯¹äºè°ƒè¯•ä¸åˆè§„é‡è¦ï¼‰ã€‚</li>
<li><strong>å¹¶è¡Œè¡¨è¾¾åŠ›</strong>ï¼šå¯ä»¥åœ¨ä¸€è½®é‡Œå¹¶æ‰§è¡Œå¤šä¸ªé€»è¾‘ç‹¬ç«‹èŠ‚ç‚¹ã€‚</li>
<li><strong>å¼ºå¤§çš„æŒä¹…åŒ–</strong>ï¼šæ¯æ­¥ snapshot éƒ½å¯å›æ”¾ä¸æ¢å¤ï¼Œæ˜¯æ„å»ºé•¿æœŸä»»åŠ¡ä¸å¯¹è¯è®°å¿†çš„åŸºç¡€ã€‚</li>
<li><strong>æ¸…æ™°çš„åˆå¹¶è¯­ä¹‰</strong>ï¼šé€šè¿‡ Annotated æŒ‡å®š reducerï¼Œé¿å…ç«æ€å†™å…¥æ­§ä¹‰ã€‚</li>
</ul>
<h3 data-id="heading-12">æƒè¡¡ä¸é™åˆ¶</h3>
<ul>
<li><strong>å»¶è¿Ÿçš„å¯è§æ€§</strong>ï¼šèŠ‚ç‚¹å†™å…¥åœ¨æœ¬è½®ç»“æŸä¹‹å‰å¯¹å…¶ä»–èŠ‚ç‚¹ä¸å¯è§ï¼ˆè¿™æ—¢æ˜¯ç‰¹æ€§ä¹Ÿæ˜¯é™åˆ¶ï¼‰ã€‚æŸäº›ç´§è€¦åˆåœºæ™¯éœ€æ›´ç»†ç²’åº¦äº¤äº’ã€‚</li>
<li><strong>å¹¶å‘ä¸è‡ªåŠ¨åŒ–</strong>ï¼šéœ€è¦å·¥ç¨‹ä¸Šæ˜¾å¼é€‰æ‹© async/thread æ‰èƒ½å¹¶è¡Œï¼Œå¢åŠ ä½¿ç”¨å¤æ‚åº¦ã€‚</li>
<li><strong>è®¾è®¡æˆæœ¬</strong>ï¼šéœ€è¦ä¸ºçŠ¶æ€å­—æ®µè€ƒè™‘åˆå¹¶ç­–ç•¥ï¼ˆå“ªäº›å­—æ®µåº”ç´¯ç§¯ã€è¦†ç›–ã€æˆ–ç”¨è‡ªå®šä¹‰ reducerï¼‰ã€‚</li>
<li><strong>å¤æ‚ debug</strong>ï¼šå¤šè½® super-step ä¸ reducer è¡Œä¸ºç»“åˆæ—¶ï¼Œç†è§£å†å²æ¼”å˜éœ€è¦è¯»å– checkpointsï¼ˆå¥½å¤„æ˜¯å¯è¯»ï¼Œä½†éœ€è¦å·¥å…·ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-13">10. å®æˆ˜å»ºè®®ä¸è°ƒè¯•è¦ç‚¹</h2>
<ul>
<li><strong>ä¸ºæ¯ä¸ªçŠ¶æ€å­—æ®µæ˜ç¡® reducer</strong>ï¼ˆç”¨ <code>Annotated</code> æ ‡æ³¨ï¼‰ï¼Œæ¯”å¦‚åˆ—è¡¨ç”¨ <code>add</code>ï¼Œå­—å…¸å¯èƒ½ç”¨ <code>dict_merge</code>ï¼ŒæŸäº›å­—æ®µé‡‡ç”¨è¦†ç›–ç­–ç•¥ã€‚</li>
<li><strong>ä½¿ç”¨ thread_id ä¸ checkpoint æ°å½“åˆ†å‰²ä¼šè¯</strong>ï¼Œå¯¹è¯/ä»»åŠ¡ç”¨ç‹¬ç«‹çº¿ç¨‹ IDï¼Œä¾¿äºå¹¶è¡Œç”¨æˆ·éš”ç¦»ä¸å›æ”¾ã€‚</li>
<li><strong>åœ¨éœ€è¦å¹¶å‘èŠ‚ç‚¹æ—¶</strong>ï¼šä¼˜å…ˆä½¿ç”¨ async èŠ‚ç‚¹æˆ–æ˜¾å¼çº¿ç¨‹æ± ï¼›ä½†è¦ç¡®ä¿ reducer æ­£ç¡®ï¼Œé¿å…é¡ºåºä¾èµ–ã€‚</li>
<li><strong>æ£€æŸ¥ç‚¹ä¸ä¸­æ–­è°ƒè¯•</strong>ï¼šå½“å‡ºç° KeyErrorï¼ˆä¾‹å¦‚ <code>draft_response</code> ä¸å­˜åœ¨ï¼‰ï¼Œæ£€æŸ¥é¦–æ¬¡ invoke æ˜¯å¦åœåœ¨ interruptï¼ˆhuman_reviewï¼‰èŠ‚ç‚¹ â€”â€” å› ä¸º interrupt ä¼šæš‚åœæ‰§è¡Œä¸”ä¸ä¼šå†™å›æŸäº›å­—æ®µã€‚</li>
<li><strong>è®°å½• metadata</strong>ï¼šå¼€å¯æˆ–ä¸°å¯Œ snapshot çš„ metadataï¼ˆæ¯”å¦‚å“ªä¸ªèŠ‚ç‚¹å†™äº†å“ªä¸ªå­—æ®µï¼‰ï¼Œä¾¿äºæ—¥åæ’æŸ¥ã€‚</li>
<li><strong>é™åˆ¶ snapshot å†å²</strong>ï¼šåœ¨ç”Ÿäº§ç³»ç»Ÿä¸­éœ€è¦åˆé€‚ä¿ç•™ç­–ç•¥æˆ–å½’æ¡£æ—§ checkpointï¼Œé¿å…æ— é™è†¨èƒ€ã€‚</li>
<li><strong>åŠ å¯†/åˆè§„</strong>ï¼šæŒä¹…åŒ–å¯¹è¯æ•°æ®æ•æ„Ÿæ—¶ï¼Œç”¨ <code>EncryptedSerializer</code> å¹¶é€‰æ‹©å¯é åç«¯ï¼ˆPostgres + AES key ç®¡ç†ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-14">ç»“è¯­</h2>
<p>LangGraph çš„ <strong>super-step</strong> å¹¶éç®€å•çš„â€œæ¯æ¬¡æ‰§è¡Œä¸€ä¸ªèŠ‚ç‚¹â€ï¼Œè€Œæ˜¯ä¸€ä¸ªæœ‰æ„è¯†çš„<strong>åˆ†é˜¶æ®µæ‰§è¡Œæ¨¡å‹</strong>ï¼šä¿è¯å¹¶è¡Œè¡¨è¾¾ã€çŠ¶æ€ä¸€è‡´æ€§ä¸å¯æ¢å¤æ€§çš„åŒæ—¶ï¼ŒæŠŠå¹¶å‘ç­–ç•¥ç•™ç»™å¼€å‘è€…æ˜¾å¼æŒæ§ã€‚æ­£æ˜¯è¿™ä¸ªè®¾è®¡ï¼Œä½¿ LangGraph åœ¨æ„å»ºå¤æ‚å·¥ä½œæµã€agent åä½œã€äººæœºä¸­æ–­ä¸é•¿æœŸè®°å¿†ç­‰åœºæ™¯æ—¶ï¼Œæ—¢çµæ´»åˆå¯æ§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å°ç™½Expresså…¥é—¨ï¼šåˆè¯†Webæ¡†æ¶ä¸é¡¹ç›®æ­å»º]]></title>    <link>https://juejin.cn/post/7573525634213560363</link>    <guid>https://juejin.cn/post/7573525634213560363</guid>    <pubDate>2025-11-18T01:16:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573525634213560363" data-draft-id="7573535624533377043" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å°ç™½Expresså…¥é—¨ï¼šåˆè¯†Webæ¡†æ¶ä¸é¡¹ç›®æ­å»º"/> <meta itemprop="keywords" content="Node.js,Express,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-18T01:16:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§å‰ç«¯å†é™©è®°"/> <meta itemprop="url" content="https://juejin.cn/user/395479916219517"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å°ç™½Expresså…¥é—¨ï¼šåˆè¯†Webæ¡†æ¶ä¸é¡¹ç›®æ­å»º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/395479916219517/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§å‰ç«¯å†é™©è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:16:27.000Z" title="Tue Nov 18 2025 01:16:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç«¯å°ç™½Expresså…¥é—¨ï¼šåˆè¯†Webæ¡†æ¶ä¸é¡¹ç›®æ­å»º</h2>
<h3 data-id="heading-1">å‰è¨€ï¼šå‰ç«¯ä¸ºä»€ä¹ˆéœ€è¦å­¦ä¹ Expressï¼Ÿ</h3>
<p>åœ¨å¼€å§‹å­¦ä¹ Expressä¹‹å‰ï¼Œå¾ˆå¤šå‰ç«¯åŒå­¦å¯èƒ½ä¼šé—®ï¼šæˆ‘å·²ç»ä¼šReact/Vueäº†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å­¦ä¹ åç«¯æ¡†æ¶ï¼Ÿå‰ç«¯å·¥ç¨‹å¸ˆä¸æ˜¯åº”è¯¥ä¸“æ³¨äºç•Œé¢å’Œç”¨æˆ·ä½“éªŒå—ï¼Ÿ</p>
<p><strong>ç­”æ¡ˆåœ¨äºï¼šç°ä»£å‰ç«¯å¼€å‘å·²ç»è¿œè¿œè¶…è¶Šäº†"åˆ‡å›¾å†™ç•Œé¢"çš„èŒƒç•´ã€‚å…¨æ ˆèƒ½åŠ›æ­£åœ¨æˆä¸ºå‰ç«¯å·¥ç¨‹å¸ˆçš„æ ¸å¿ƒç«äº‰åŠ›ï¼Œè€ŒExpressæ˜¯ç†è§£Webå¼€å‘å…¨è²Œçš„æœ€ä½³å…¥å£ã€‚</strong></p>
<h3 data-id="heading-2">ä¸€ã€åŸç”ŸHTTPæ¨¡å— vs Expressï¼šç›´è§‚å¯¹æ¯”</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥æ„Ÿå—ä¸¤è€…çš„åŒºåˆ«ã€‚</p>
<h4 data-id="heading-3">1.1 ä½¿ç”¨Node.jsåŸç”ŸHTTPæ¨¡å—åˆ›å»ºæœåŠ¡å™¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);

<span class="hljs-comment">// åˆ›å»ºHTTPæœåŠ¡å™¨</span>
<span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-comment">// æ‰‹åŠ¨è§£æURLå’Œè¯·æ±‚æ–¹æ³•</span>
  <span class="hljs-keyword">const</span> { url, method } = req;
  
  <span class="hljs-comment">// ç®€å•çš„è·¯ç”±åˆ¤æ–­</span>
  <span class="hljs-keyword">if</span> (url === <span class="hljs-string">'/'</span> &amp;&amp; method === <span class="hljs-string">'GET'</span>) {
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/html'</span> });
    res.<span class="hljs-title function_">end</span>(<span class="hljs-string">'&lt;h1&gt;æ¬¢è¿æ¥åˆ°é¦–é¡µ&lt;/h1&gt;'</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url === <span class="hljs-string">'/api/users'</span> &amp;&amp; method === <span class="hljs-string">'GET'</span>) {
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> });
    res.<span class="hljs-title function_">end</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">users</span>: [<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'æå››'</span>] }));
  } <span class="hljs-keyword">else</span> {
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">404</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/html'</span> });
    res.<span class="hljs-title function_">end</span>(<span class="hljs-string">'&lt;h1&gt;é¡µé¢æœªæ‰¾åˆ°&lt;/h1&gt;'</span>);
  }
});

<span class="hljs-comment">// å¯åŠ¨æœåŠ¡å™¨</span>
server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000'</span>);
});
</code></pre>
<p><strong>ç—›ç‚¹åˆ†æï¼š</strong></p>
<ul>
<li>éœ€è¦æ‰‹åŠ¨è§£æURLå’Œè¯·æ±‚æ–¹æ³•</li>
<li>è·¯ç”±å¤„ç†å˜å¾—å¤æ‚ä¸”éš¾ä»¥ç»´æŠ¤</li>
<li>ç¼ºå°‘ä¸­é—´ä»¶ç­‰é«˜çº§åŠŸèƒ½</li>
<li>ä»£ç ç»„ç»‡ä¸å¤Ÿç›´è§‚</li>
</ul>
<h4 data-id="heading-4">1.2 ä½¿ç”¨Expresså®ç°ç›¸åŒåŠŸèƒ½</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = <span class="hljs-number">3000</span>;

<span class="hljs-comment">// è·¯ç”±å¤„ç†å˜å¾—æå…¶ç®€å•</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">'&lt;h1&gt;æ¬¢è¿æ¥åˆ°é¦–é¡µ&lt;/h1&gt;'</span>);
});

app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/users'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">users</span>: [<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'æå››'</span>] });
});

<span class="hljs-comment">// 404å¤„ç†</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-string">'*'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'&lt;h1&gt;é¡µé¢æœªæ‰¾åˆ°&lt;/h1&gt;'</span>);
});

app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ExpressæœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:<span class="hljs-subst">${PORT}</span>`</span>);
});
</code></pre>
<p><strong>Expressä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>ç®€æ´çš„è·¯ç”±å®šä¹‰</li>
<li>å†…ç½®çš„å“åº”æ–¹æ³•ï¼ˆ<code>send</code>, <code>json</code>ç­‰ï¼‰</li>
<li>æ¸…æ™°çš„é”™è¯¯å¤„ç†</li>
<li>æ˜“äºæ‰©å±•çš„ä¸­é—´ä»¶ä½“ç³»</li>
</ul>
<h3 data-id="heading-5">äºŒã€å¿«é€Ÿåˆ›å»ºExpressé¡¹ç›®</h3>
<h4 data-id="heading-6">2.1 ç¯å¢ƒå‡†å¤‡</h4>
<p>é¦–å…ˆç¡®ä¿ä½ çš„ç³»ç»Ÿå·²ç»å®‰è£…Node.jsï¼ˆå»ºè®®ç‰ˆæœ¬14+ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">node --version  <span class="hljs-comment"># æ£€æŸ¥Node.jsç‰ˆæœ¬</span>
npm --version   <span class="hljs-comment"># æ£€æŸ¥npmç‰ˆæœ¬</span>
</code></pre>
<h4 data-id="heading-7">2.2 åˆå§‹åŒ–é¡¹ç›®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºé¡¹ç›®ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> my-express-app
<span class="hljs-built_in">cd</span> my-express-app

<span class="hljs-comment"># åˆå§‹åŒ–package.json</span>
npm init -y

<span class="hljs-comment"># å®‰è£…Express</span>
npm install express
</code></pre>
<h4 data-id="heading-8">2.3 é¡¹ç›®ç»“æ„è§„åˆ’</h4>
<p>å»ºè®®é‡‡ç”¨æ¸…æ™°çš„é¡¹ç›®ç»“æ„ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">my-express-app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.js          <span class="hljs-meta"># Expressåº”ç”¨å®ä¾‹</span>
â”‚   â”œâ”€â”€ routes/         <span class="hljs-meta"># è·¯ç”±æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ middleware/     <span class="hljs-meta"># è‡ªå®šä¹‰ä¸­é—´ä»¶</span>
â”‚   â””â”€â”€ <span class="hljs-keyword">public</span>/         <span class="hljs-meta"># é™æ€èµ„æº</span>
â”œâ”€â”€ package.json
â””â”€â”€ README.md
</code></pre>
<h4 data-id="heading-9">2.4 ä½¿ç”¨Expressåº”ç”¨ç”Ÿæˆå™¨ï¼ˆè„šæ‰‹æ¶ï¼‰</h4>
<p>å¯¹äºæ›´å¤æ‚çš„é¡¹ç›®ï¼Œæ¨èä½¿ç”¨å®˜æ–¹ç”Ÿæˆå™¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…¨å±€å®‰è£…express-generator</span>
npm install -g express-generator

<span class="hljs-comment"># åˆ›å»ºé¡¹ç›®</span>
express --view=ejs my-advanced-app

<span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
<span class="hljs-built_in">cd</span> my-advanced-app
npm install

<span class="hljs-comment"># å¯åŠ¨é¡¹ç›®</span>
npm start
</code></pre>
<p>ç”Ÿæˆçš„é¡¹ç›®ç»“æ„æ›´åŠ å®Œæ•´ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">my-advanced-app/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ www            <span class="hljs-meta"># æœåŠ¡å™¨å¯åŠ¨æ–‡ä»¶</span>
â”œâ”€â”€ <span class="hljs-keyword">public</span>/            <span class="hljs-meta"># é™æ€èµ„æº</span>
â”œâ”€â”€ routes/            <span class="hljs-meta"># è·¯ç”±æ–‡ä»¶</span>
â”œâ”€â”€ views/             <span class="hljs-meta"># æ¨¡æ¿æ–‡ä»¶</span>
â”œâ”€â”€ app.js             <span class="hljs-meta"># ä¸»åº”ç”¨æ–‡ä»¶</span>
â””â”€â”€ package.json
</code></pre>
<h3 data-id="heading-10">ä¸‰ã€ä¸­é—´ä»¶æ¦‚å¿µåˆæ¢ï¼šExpressçš„æ ¸å¿ƒçµé­‚</h3>
<h4 data-id="heading-11">3.1 ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ï¼Ÿ</h4>
<p><strong>ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰</strong> æ˜¯Expressä¸­æœ€æ ¸å¿ƒçš„æ¦‚å¿µã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ª<strong>å¤„ç†æµæ°´çº¿</strong>ï¼Œæ¯ä¸ªä¸­é—´ä»¶å°±åƒæ˜¯æµæ°´çº¿ä¸Šçš„ä¸€ä¸ªå·¥ä½œç«™ï¼Œå¯¹è¯·æ±‚è¿›è¡ŒåŠ å·¥å¤„ç†ã€‚</p>
<h4 data-id="heading-12">3.2 ä¸­é—´ä»¶çš„åŸºæœ¬ç»“æ„</h4>
<p>æ¯ä¸ªä¸­é—´ä»¶å‡½æ•°éƒ½éµå¾ªç›¸åŒçš„æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">middleware</span>(<span class="hljs-params">req, res, next</span>) {
  <span class="hljs-comment">// å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${req.method}</span> <span class="hljs-subst">${req.url}</span>`</span>);
  
  <span class="hljs-comment">// è°ƒç”¨next()å°†æ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</span>
  <span class="hljs-title function_">next</span>();
}
</code></pre>
<h4 data-id="heading-13">3.3 å®é™…åº”ç”¨ç¤ºä¾‹</h4>
<p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹æ¥ç†è§£ä¸­é—´ä»¶çš„å·¥ä½œæµç¨‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

<span class="hljs-comment">// 1. æ—¥å¿—è®°å½•ä¸­é—´ä»¶</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> timestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${timestamp}</span>] <span class="hljs-subst">${req.method}</span> <span class="hljs-subst">${req.url}</span>`</span>);
  <span class="hljs-title function_">next</span>(); <span class="hljs-comment">// å¿…é¡»è°ƒç”¨next()ï¼</span>
});

<span class="hljs-comment">// 2. é™æ€æ–‡ä»¶æœåŠ¡ä¸­é—´ä»¶</span>
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">static</span>(<span class="hljs-string">'public'</span>));

<span class="hljs-comment">// 3.  bodyè§£æä¸­é—´ä»¶</span>
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>()); <span class="hljs-comment">// è§£æJSONæ ¼å¼çš„è¯·æ±‚ä½“</span>
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">urlencoded</span>({ <span class="hljs-attr">extended</span>: <span class="hljs-literal">true</span> })); <span class="hljs-comment">// è§£æè¡¨å•æ•°æ®</span>

<span class="hljs-comment">// 4. è‡ªå®šä¹‰è®¤è¯ä¸­é—´ä»¶ï¼ˆæ¨¡æ‹Ÿï¼‰</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-string">'/api'</span>, <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-comment">// æ£€æŸ¥APIè¯·æ±‚çš„è®¤è¯ä¿¡æ¯</span>
  <span class="hljs-keyword">const</span> token = req.<span class="hljs-property">headers</span>.<span class="hljs-property">authorization</span>;
  
  <span class="hljs-keyword">if</span> (!token) {
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">401</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'æœªæä¾›è®¤è¯ä»¤ç‰Œ'</span> });
  }
  
  <span class="hljs-comment">// æ¨¡æ‹ŸtokenéªŒè¯</span>
  <span class="hljs-keyword">if</span> (token !== <span class="hljs-string">'Bearer valid-token'</span>) {
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">403</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'è®¤è¯å¤±è´¥'</span> });
  }
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è®¤è¯é€šè¿‡'</span>);
  <span class="hljs-title function_">next</span>();
});

<span class="hljs-comment">// 5. ä¸šåŠ¡è·¯ç”±</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">'æ¬¢è¿æ¥åˆ°é¦–é¡µï¼'</span>);
});

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/data'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¥æ”¶åˆ°çš„æ•°æ®:'</span>, req.<span class="hljs-property">body</span>);
  res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'æ•°æ®æ¥æ”¶æˆåŠŸ'</span>, <span class="hljs-attr">data</span>: req.<span class="hljs-property">body</span> });
});

<span class="hljs-comment">// 6. 404å¤„ç†ä¸­é—´ä»¶ï¼ˆæ”¾åœ¨æœ€åï¼‰</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-string">'*'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'é¡µé¢æœªæ‰¾åˆ°'</span>);
});

<span class="hljs-comment">// 7. é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼ˆå››ä¸ªå‚æ•°ï¼‰</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">err, req, res, next</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘ç”Ÿé”™è¯¯:'</span>, err);
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'</span> });
});

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = <span class="hljs-number">3000</span>;
app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:<span class="hljs-subst">${PORT}</span>`</span>);
});
</code></pre>
<h4 data-id="heading-14">3.4 ä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåº</h4>
<p>ç†è§£ä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåºè‡³å…³é‡è¦ï¼š</p>
<pre><code class="hljs language-css" lang="css">è¯·æ±‚è¿›å…¥
    â†“
æ—¥å¿—ä¸­é—´ä»¶ï¼ˆè®°å½•è¯·æ±‚ä¿¡æ¯ï¼‰
    â†“
é™æ€æ–‡ä»¶ä¸­é—´ä»¶ï¼ˆå¦‚æœæ˜¯é™æ€æ–‡ä»¶è¯·æ±‚ï¼Œç›´æ¥è¿”å›ï¼‰
    â†“
<span class="hljs-selector-tag">Body</span>è§£æä¸­é—´ä»¶ï¼ˆè§£æè¯·æ±‚ä½“æ•°æ®ï¼‰
    â†“
è®¤è¯ä¸­é—´ä»¶ï¼ˆæ£€æŸ¥APIè®¤è¯ï¼‰
    â†“
è·¯ç”±å¤„ç†ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
    â†“
<span class="hljs-number">404</span>å¤„ç†ï¼ˆå¦‚æœæ²¡æœ‰åŒ¹é…çš„è·¯ç”±ï¼‰
    â†“
é”™è¯¯å¤„ç†ï¼ˆå¦‚æœå‘ç”Ÿé”™è¯¯ï¼‰
</code></pre>
<h3 data-id="heading-15">å››ã€æœ€ä½³å®è·µä¸å¸¸è§é™·é˜±</h3>
<h4 data-id="heading-16">4.1 é¡¹ç›®åˆå§‹åŒ–æœ€ä½³å®è·µ</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// package.json å»ºè®®é…ç½®</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"my-express-app"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Expresså®æˆ˜é¡¹ç›®"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"src/app.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"start"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node src/app.js"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"nodemon src/app.js"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"jest"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"keywords"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"express"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"nodejs"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"author"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ çš„åå­—"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"license"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MIT"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-17">4.2 å¸¸è§é™·é˜±åŠè§£å†³æ–¹æ¡ˆ</h4>
<p><strong>é™·é˜±1ï¼šå¿˜è®°è°ƒç”¨next()</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¿™ä¸ªä¸­é—´ä»¶ä¼šé˜»å¡æ•´ä¸ªåº”ç”¨ï¼'</span>);
  <span class="hljs-comment">// å¿˜è®°è°ƒç”¨next()ï¼Œè¯·æ±‚ä¼šä¸€ç›´æŒ‚èµ·</span>
});

<span class="hljs-comment">// æ­£ç¡®åšæ³•</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ­£ç¡®å¤„ç†è¯·æ±‚'</span>);
  <span class="hljs-title function_">next</span>(); <span class="hljs-comment">// å¿…é¡»è°ƒç”¨ï¼</span>
});
</code></pre>
<p><strong>é™·é˜±2ï¼šä¸­é—´ä»¶é¡ºåºé”™è¯¯</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯é¡ºåº - 404å¤„ç†æ”¾åœ¨å‰é¢</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-string">'*'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'é¡µé¢æœªæ‰¾åˆ°'</span>);
});

<span class="hljs-comment">// åé¢çš„è·¯ç”±æ°¸è¿œä¸ä¼šæ‰§è¡Œ</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">'è¿™ä¸ªé¡µé¢æ°¸è¿œä¸ä¼šè¢«è®¿é—®åˆ°'</span>);
});

<span class="hljs-comment">// æ­£ç¡®é¡ºåº</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">'é¦–é¡µ'</span>);
});

app.<span class="hljs-title function_">use</span>(<span class="hljs-string">'*'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {  <span class="hljs-comment">// 404å¤„ç†æ”¾åœ¨æœ€å</span>
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'é¡µé¢æœªæ‰¾åˆ°'</span>);
});
</code></pre>
<h3 data-id="heading-18">äº”ã€å®æˆ˜ç»ƒä¹ </h3>
<p>ä¸ºäº†å·©å›ºç†è§£ï¼Œè¯·å°è¯•å®Œæˆä»¥ä¸‹ç»ƒä¹ ï¼š</p>
<ol>
<li>
<p><strong>åˆ›å»ºä¸€ä¸ªExpressæœåŠ¡å™¨</strong>ï¼Œå®ç°ä»¥ä¸‹è·¯ç”±ï¼š</p>
<ul>
<li><code>GET /</code>ï¼šè¿”å›"é¦–é¡µæ¬¢è¿è¯­"</li>
<li><code>GET /about</code>ï¼šè¿”å›"å…³äºæˆ‘ä»¬"</li>
<li><code>POST /contact</code>ï¼šæ¥æ”¶å¹¶è¿”å›è”ç³»äººä¿¡æ¯</li>
</ul>
</li>
<li>
<p><strong>æ·»åŠ è‡ªå®šä¹‰ä¸­é—´ä»¶</strong>ï¼š</p>
<ul>
<li>è¯·æ±‚æ—¥å¿—è®°å½•</li>
<li>APIè¯·æ±‚æ—¶é—´è®¡ç®—</li>
<li>ç®€å•çš„è¯·æ±‚é¢‘ç‡é™åˆ¶</li>
</ul>
</li>
<li>
<p><strong>ç»„ç»‡é¡¹ç›®ç»“æ„</strong>ï¼š</p>
<ul>
<li>å°†è·¯ç”±åˆ†ç¦»åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­</li>
<li>åˆ›å»ºè‡ªå®šä¹‰ä¸­é—´ä»¶ç›®å½•</li>
</ul>
</li>
</ol>
<h3 data-id="heading-19">æ€»ç»“</h3>
<p>é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†ï¼š</p>
<ul>
<li>âœ… Expressç›¸å¯¹äºåŸç”ŸHTTPæ¨¡å—çš„ä¼˜åŠ¿</li>
<li>âœ… å¦‚ä½•ä»é›¶æ­å»ºExpressé¡¹ç›®</li>
<li>âœ… ä¸­é—´ä»¶çš„æ ¸å¿ƒæ¦‚å¿µå’Œå·¥ä½œåŸç†</li>
<li>âœ… åˆç†çš„é¡¹ç›®ç»“æ„è§„åˆ’</li>
<li>âœ… å¸¸è§çš„é™·é˜±å’Œæœ€ä½³å®è·µ</li>
</ul>
<p><strong>Expressçš„ç²¾é«“åœ¨äº"çº¦å®šä¼˜äºé…ç½®"</strong> - å®ƒæä¾›äº†ä¸€å¥—ä¼˜é›…çš„çº¦å®šï¼Œè®©Webå¼€å‘å˜å¾—æ›´åŠ æ„‰å¿«å’Œé«˜æ•ˆã€‚</p>
<p>åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨<strong>Expressçš„è·¯ç”±ç³»ç»Ÿ</strong>ï¼Œå­¦ä¹ å¦‚ä½•æ„å»ºå¤æ‚çš„APIæ¥å£å’ŒRESTfulæœåŠ¡ã€‚</p>
<hr/>
<p><strong>åŠ¨æ‰‹æ—¶é—´</strong>ï¼šæŒ‰ç…§æ–‡ä¸­çš„ç¤ºä¾‹ä»£ç ï¼Œäº²æ‰‹æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªExpressåº”ç”¨ã€‚é‡åˆ°é—®é¢˜æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºï¼</p>
<p><em>æç¤ºï¼šè®°å¾—å®‰è£…nodemonç”¨äºå¼€å‘æ—¶çš„è‡ªåŠ¨é‡å¯ï¼š<code>npm install -D nodemon</code></em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ™ºèƒ½ä½“ä¸å°æ¨¡å‹ï¼šAIè¿ˆå‘å¹³æ°‘åŒ–çš„æ–°æµªæ½®]]></title>    <link>https://juejin.cn/post/7573528564027080750</link>    <guid>https://juejin.cn/post/7573528564027080750</guid>    <pubDate>2025-11-18T01:20:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573528564027080750" data-draft-id="7573528564026834990" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ™ºèƒ½ä½“ä¸å°æ¨¡å‹ï¼šAIè¿ˆå‘å¹³æ°‘åŒ–çš„æ–°æµªæ½®"/> <meta itemprop="keywords" content="ç®—æ³•,è®¡ç®—æœºè§†è§‰,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-11-18T01:20:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CoovallyAIHub"/> <meta itemprop="url" content="https://juejin.cn/user/2461151071843739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ™ºèƒ½ä½“ä¸å°æ¨¡å‹ï¼šAIè¿ˆå‘å¹³æ°‘åŒ–çš„æ–°æµªæ½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2461151071843739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CoovallyAIHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:20:35.000Z" title="Tue Nov 18 2025 01:20:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ•°ç™¾äº¿å‚æ•°ã€åºå¤§ç®—åŠ›éœ€æ±‚ã€æ˜‚è´µçš„éƒ¨ç½²æˆæœ¬â€¦â€¦å½“ç§‘æŠ€å·¨å¤´ä»¬è¿˜åœ¨è¿½æ±‚â€œæ›´å¤§æ›´å¼ºâ€çš„AIæ¨¡å‹æ—¶ï¼Œä¸€è‚¡åå‘è€Œè¡Œçš„è¶‹åŠ¿æ­£æ‚„ç„¶å…´èµ·ï¼Œå¹¶å¯èƒ½å½»åº•æ”¹å˜äººå·¥æ™ºèƒ½çš„åº”ç”¨æ ¼å±€ã€‚</p>
<p>è¿‡å»ä¸€å¹´ï¼ŒAIæ™ºèƒ½ä½“ï¼ˆAI Agentï¼‰çƒ­åº¦æ€¥å‰§æ”€å‡ï¼Œæˆä¸ºäººå·¥æ™ºèƒ½é¢†åŸŸæœ€å—å…³æ³¨çš„è¯é¢˜ä¹‹ä¸€ã€‚ä»ç§‘æŠ€å·¨å¤´åˆ°åˆåˆ›ä¼ä¸šï¼Œçº·çº·åŠ å…¥è¿™åœºæ™ºèƒ½ä½“ç«èµ›ã€‚</p>
<p>ç„¶è€Œï¼Œåœ¨è¿™æ³¢æ™ºèƒ½ä½“æµªæ½®èƒŒåï¼Œä¸€ä¸ªå…³é”®è½¬å˜æ­£åœ¨å‘ç”Ÿï¼šå°è€Œä¸“çš„æ¨¡å‹æ­£å–ä»£åºå¤§è€Œå…¨çš„æ¨¡å‹ï¼Œæˆä¸ºæ¨åŠ¨æ™ºèƒ½ä½“æ™®åŠçš„æ ¸å¿ƒåŠ›é‡ã€‚</p>
<h2 data-id="heading-0"><strong>æ™ºèƒ½ä½“çƒ­æ½®</strong></h2>
<p>2025å¹´è¢«ä¸šç•Œå¹¿æ³›ç§°ä¸º <strong>â€œAI Agentå…ƒå¹´â€</strong> ã€‚ä»Šå¹´ä¸ŠåŠå¹´ï¼Œéšç€OpenAIç›¸ç»§å‘å¸ƒOperatorï¼ˆæ‰§è¡Œç®€å•ä»»åŠ¡çš„Agentï¼‰ä¸Deep Researchï¼ˆè¿›è¡Œæ·±åº¦ç ”ç©¶çš„Agentï¼‰ï¼ŒAIæ™ºèƒ½ä½“é¢†åŸŸçš„ç«äº‰éª¤ç„¶åŠ å‰§ã€‚</p>
<p>æ™ºèƒ½ä½“ä¸æ—©æœŸAIåº”ç”¨æœ‰ç€æ ¹æœ¬åŒºåˆ«ã€‚</p>
<p>AIåº”ç”¨ç»å†äº†ä»æç¤ºè¯åˆ°å·¥ä½œæµï¼Œå†åˆ°æ™ºèƒ½ä½“çš„ä¸‰ä¸ªå‘å±•é˜¶æ®µã€‚æœ€åˆçš„æç¤ºè¯é˜¶æ®µï¼Œç”¨æˆ·é€šè¿‡å¯¹è¯ä¸å¤§æ¨¡å‹äº¤äº’ï¼›å·¥ä½œæµé˜¶æ®µåˆ™é€šè¿‡é¢„è®¾çš„èŠ‚ç‚¹ä¸è·¯å¾„å¤šæ­¥éª¤å®Œæˆä»»åŠ¡ã€‚</p>
<p>è€Œæ™ºèƒ½ä½“æ˜¯â€œèƒ½å¤Ÿè‡ªä¸»æ„ŸçŸ¥ç¯å¢ƒã€è‡ªä¸»å†³ç­–ã€æ‰§è¡Œä»»åŠ¡å¹¶è¾¾æˆç›®æ ‡çš„æ™ºèƒ½ç³»ç»Ÿâ€ã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºæ„ŸçŸ¥ç¯å¢ƒã€è‡ªä¸»å†³ç­–åŠå·¥å…·ä½¿ç”¨èƒ½åŠ›ã€‚</p>
<p>ç§‘æŠ€å·¨å¤´çº·çº·æŠ¼æ³¨æ™ºèƒ½ä½“èµ›é“ï¼šGoogleé¢„è®¡å‘å¸ƒèƒ½å¤Ÿæ“ä½œæµè§ˆå™¨å’Œå…¶ä»–è½¯ä»¶çš„Project Marinerï¼Œç™¾åº¦æ¨å‡ºâ€œå¿ƒå“â€APPï¼Œé˜¿é‡Œçš„â€œå¿ƒæµâ€é¡¹ç›®åˆ™æ·±å…¥æ¢ç´¢Agentçš„äººæœºååŒæ•ˆç‡ã€‚</p>
<h2 data-id="heading-1"><strong>å°æ¨¡å‹å´›èµ·ï¼šAIå¹³æ°‘åŒ–çš„å…³é”®æ¨åŠ›</strong></h2>
<p>å½“ä¼—å¤šä¼ä¸šè¿˜åœ¨è¿½é€æ›´å¤§å‚æ•°ã€æ›´å¼ºèƒ½åŠ›çš„å¤§æ¨¡å‹æ—¶ï¼Œå°æ¨¡å‹æ­£ä»¥æƒŠäººçš„é€Ÿåº¦å¡«è¡¥ç€å¤§æ¨¡å‹æ— æ³•è¦†ç›–çš„å¸‚åœºç©ºç™½ã€‚</p>
<p>æ®è‹±ä¼Ÿè¾¾çªç ´æ€§ç ”ç©¶æ˜¾ç¤ºï¼Œ40%è‡³70%çš„ä¼ä¸šçº§AIä»»åŠ¡å¯ä»¥é€šè¿‡å°å‹è¯­è¨€æ¨¡å‹æ›´é«˜æ•ˆåœ°å¤„ç†â€”â€”è¿™äº›å‚æ•°å°‘äº100äº¿çš„æ¨¡å‹é€Ÿåº¦æ¯”å·¨å‹æ¨¡å‹<strong>å¿«10å€</strong>ï¼Œéƒ¨ç½²å’Œç»´æŠ¤æˆæœ¬é™ä½<strong>5-20å€</strong>ã€‚</p>
<p>å°æ¨¡å‹ä¹‹æ‰€ä»¥é‡è¦ï¼Œæ˜¯å› ä¸ºå®ƒä»¬è§£å†³äº†å¤§æ¨¡å‹åœ¨å®é™…éƒ¨ç½²ä¸­çš„æ ¹æœ¬ç—›ç‚¹ï¼š<strong>åºå¤§çš„è®¡ç®—éœ€æ±‚ã€é«˜æ˜‚çš„æ¨ç†æˆæœ¬ä»¥åŠå¯¹ç¡¬ä»¶çš„è‹›åˆ»è¦æ±‚ã€‚</strong></p>
<p align="center">**<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cdefc2041c594bf684d965832fdc6e4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033634&amp;x-signature=KlosFRICae%2Fbj2JvXSmGrWR6Q3w%3D" alt="v2_3ba9d2b90a5b44af957964942c6dfb05@000000_oswg1382235oswg1000oswg1000_img_000.jpg" loading="lazy"/>**</p>
<p>åœ¨èµ„æºå—é™çš„ç¯å¢ƒä¸­ï¼Œå¦‚æ™ºèƒ½æ‰‹æœºã€å·¥å‚è½¦é—´ã€åŒ»ç–—ä»ªå™¨ç­‰è¾¹ç¼˜è®¾å¤‡ï¼Œå°æ¨¡å‹å‡ ä¹æ˜¯å”¯ä¸€å¯è¡Œçš„é€‰æ‹©ã€‚</p>
<p>åƒCoovallyè¿™æ ·çš„AIå¼€å‘å¹³å°ï¼Œè¿›ä¸€æ­¥é™ä½äº†å°æ¨¡å‹çš„åº”ç”¨é—¨æ§›ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/271e0a80230a4f0086f8821fba9dba21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033634&amp;x-signature=qtnr4KLjooR1%2BT5QUoQRWbh9q3E%3D" alt="Coovallyæ“ä½œåŠ¨å›¾.gif" loading="lazy"/></p>
<p>å®ƒæä¾›ä»æ•°æ®é¢„å¤„ç†ã€æ™ºèƒ½æ ‡æ³¨åˆ°æ¨¡å‹è®­ç»ƒå’Œéƒ¨ç½²çš„ä¸€ç«™å¼æœåŠ¡ï¼Œä½¿å¼€å‘è€…æ— éœ€æ·±åšçš„ä¸“ä¸šçŸ¥è¯†ä¹Ÿèƒ½å¿«é€Ÿæ„å»ºå’Œéƒ¨ç½²AIæ¨¡å‹ã€‚è¿™ç§å¹³æ°‘åŒ–å·¥å…·çš„å‡ºç°ï¼Œæ­£è®©å°æ¨¡å‹ä»ç ”ç©¶æœºæ„çš„å®éªŒå®¤èµ°å‘åƒè¡Œç™¾ä¸šçš„å®é™…åº”ç”¨ã€‚</p>
<h2 data-id="heading-2"><strong>è§†è§‰å°æ¨¡å‹ï¼šæ™ºèƒ½ä½“çš„â€œæ…§çœ¼â€</strong></h2>
<p>åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œå°æ¨¡å‹åŒæ ·å±•ç°å‡ºä»¤äººæƒŠå¹çš„è¡¨ç°ã€‚</p>
<p>IDEAè®¡ç®—æœºè§†è§‰ä¸æœºå™¨äººç ”ç©¶ä¸­å¿ƒå‘å¸ƒçš„<strong>Rex-Omni</strong>æ˜¯ä¸€æ¬¾ä»…30äº¿å‚æ•°çš„å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ï¼Œå®ƒæå‡äº†æ¨¡å‹å¯¹å¤æ‚è¯­ä¹‰å’Œç©ºé—´å…³ç³»çš„ç†è§£æ°´å¹³ï¼Œä½¿ç›®æ ‡æ£€æµ‹èƒ½åŠ›å®ç°è·ƒè¿›ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44e05eade6d64a20bd87de69bd680db5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033634&amp;x-signature=h04QWrrjWEJpSzHM4QLeJgd2JuU%3D" alt="rex-Demo-gif.gif" loading="lazy"/></p>
<p>Rex-Omniå°†æ‰€æœ‰è§†è§‰æ„ŸçŸ¥ä»»åŠ¡ç»Ÿä¸€åˆ°â€œåæ ‡é¢„æµ‹æ¡†æ¶â€ä¸‹ï¼Œå³æ¯ä¸ªä»»åŠ¡å‡è¢«æ„å»ºä¸ºâ€œç”Ÿæˆåæ ‡åºåˆ—â€ï¼Œé€šè¿‡åˆ›æ–°çš„ä»»åŠ¡æ„å»ºã€æ•°æ®å¼•æ“å’Œè®­ç»ƒæµç¨‹ï¼Œè§£å†³äº†ç°æœ‰å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹â€œè¯­è¨€å¼ºä½†å®šä½å¼±â€çš„ç—›ç‚¹ã€‚</p>
<p>åŒæ ·ï¼Œå°çº¢ä¹¦å›¢é˜Ÿæ¨å‡ºçš„<strong>DeepEyesV2</strong>å¤šæ¨¡æ€AIæ¨¡å‹é€šè¿‡æ™ºèƒ½åˆ©ç”¨å¤–éƒ¨å·¥å…·ï¼Œåœ¨å¤šé¡¹ä»»åŠ¡ä¸­è¶…è¶Šäº†æ›´å¤§å‹çš„æ¨¡å‹ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29df23b478f64a9596a7208fa1bbbddc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033634&amp;x-signature=aqi2MIzITgZdNhzgiblUlOgxeLM%3D" alt="screenshot_2025-11-17_16-20-06.png" loading="lazy"/></p>
<p>è¯¥æ¨¡å‹èƒ½ç»„åˆä½¿ç”¨ä»£ç æ‰§è¡Œã€å›¾åƒæœç´¢å’Œæ–‡æœ¬æœç´¢ä¸‰ç±»å·¥å…·ï¼ŒæŠŠå›¾åƒæ“ä½œã€Pythonæ‰§è¡Œå’Œå›¾åƒ/æ–‡æœ¬æœç´¢æ•´åˆèµ·æ¥ï¼Œçµæ´»åº”å¯¹å„ç§æŸ¥è¯¢ã€‚</p>
<h2 data-id="heading-3"><strong>å°æ¨¡å‹é€†è¢­çš„å…³é”®</strong></h2>
<p>å°æ¨¡å‹ä¹‹æ‰€ä»¥èƒ½åœ¨æ™ºèƒ½ä½“ä¸­å‘æŒ¥é‡è¦ä½œç”¨ï¼Œå…³é”®åœ¨äº<strong>å·¥å…·ä½¿ç”¨èƒ½åŠ›</strong>çš„çªç ´ã€‚</p>
<p>2025å¹´ï¼ŒAgentçš„æ ¸å¿ƒå˜åŒ–åœ¨äºTool Useèƒ½åŠ›å–å¾—äº†å®è´¨æ€§è¿›å±•ã€‚ä»ç¼–ç¨‹åˆ°browser-useï¼ˆAgentæ¨¡æ‹Ÿç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­çš„æ“ä½œï¼‰ï¼Œå†åˆ°computer-useï¼ˆAgentæ“æ§è®¡ç®—æœºç³»ç»Ÿï¼‰ï¼ŒAgentçš„å·¥å…·ä½¿ç”¨èƒ½åŠ›å¾—åˆ°æ˜¾è‘—å¢å¼ºã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e05e46503884e75b569d358b7282dd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033634&amp;x-signature=Zk2d2Jrdk6JNv0A1RyAOB%2FWSIpw%3D" alt="v2_43ea98184f7041b7a23f0318f6303793@000000_oswg980865oswg1000oswg1000_img_000.jpg" loading="lazy"/></p>
<p>DeepEyesV2çš„ç ”ç©¶å›¢é˜Ÿå‘ç°ï¼Œä»…é å¼ºåŒ–å­¦ä¹ ï¼Œæ¨¡å‹æ— æ³•ç¨³å®šåœ°ç”¨å·¥å…·å®Œæˆå¤šæ¨¡æ€ä»»åŠ¡ã€‚ä»–ä»¬å¼€å‘å‡º<strong>ä¸¤é˜¶æ®µçš„è®­ç»ƒæµç¨‹</strong>ï¼šç¬¬ä¸€é˜¶æ®µå­¦ä¹ æŠŠå›¾åƒç†è§£å’Œå·¥å…·ä½¿ç”¨ç»“åˆèµ·æ¥ï¼›ç¬¬äºŒé˜¶æ®µå†ç”¨å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–è¿™äº›è¡Œä¸ºã€‚</p>
<p>å·¥å…·ä½¿ç”¨èƒ½åŠ›çš„æå‡ï¼Œä½¿å°æ¨¡å‹èƒ½å¤Ÿçªç ´å‚æ•°é™åˆ¶ï¼Œåˆ©ç”¨å¤–éƒ¨èµ„æºæ‰©å±•è‡ªèº«èƒ½åŠ›ã€‚è¿™ç±»ä¼¼äºä¸€ä¸ªäººå­¦ä¼šä½¿ç”¨å›¾ä¹¦é¦†ï¼Œä¸å¿…è®°å¿†æ‰€æœ‰çŸ¥è¯†ï¼Œå´èƒ½åœ¨éœ€è¦æ—¶è·å–æ‰€éœ€ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-4"><strong>ä¸ºä½•å°æ¨¡å‹æ›´é€‚åˆæ™ºèƒ½ä½“</strong></h2>
<p>ä¸å°æ¨¡å‹ç›¸æ¯”ï¼Œå¤§å‹æ¨¡å‹åœ¨éƒ¨ç½²ä¸Šé¢ä¸´é‡é‡å›°éš¾ã€‚ä¼ ç»Ÿé—­æºAIè§£å†³æ–¹æ¡ˆéƒ¨ç½²æˆæœ¬é€šå¸¸åœ¨<strong>50ä¸‡åˆ°æ•°ç™¾ä¸‡äººæ°‘å¸</strong>ï¼Œè€Œé€šè¿‡å¼€æºç¤¾åŒºæ”¯æŒï¼Œä¸­å°ä¼ä¸šä»…éœ€20-50ä¸‡å…ƒå³å¯å®Œæˆå°æ¨¡å‹éƒ¨ç½²ã€‚</p>
<p>ç§æœ‰åŒ–éƒ¨ç½²è™½ç„¶è§£å†³äº†æ•°æ®å®‰å…¨ä¸å®šåˆ¶åŒ–éœ€æ±‚ï¼Œå´å¸¦æ¥äº†ä¸€ç³»åˆ—æ–°é—®é¢˜ï¼šå¸‚åœºç¢ç‰‡åŒ–ã€èµ„æºé‡å¤æŠ•å…¥ã€è®¡ç®—èµ„æºåˆ©ç”¨ç‡ä½ã€‚</p>
<p>æ€ç€šäº§ä¸šç ”ç©¶é™¢æ•°æ®æ˜¾ç¤ºï¼Œè¿‘60%ä¼ä¸šé€‰æ‹©åœ¨æœ¬åœ°æ•°æ®ä¸­å¿ƒæˆ–ç§æœ‰äº‘å’Œè¾¹ç¼˜ä½ç½®éƒ¨ç½²AIæ¨ç†æ¨¡å‹ï¼Œæ˜¾ç¤ºå‡ºå¯¹ç§æœ‰éƒ¨ç½²çš„åå¥½ã€‚</p>
<p>è¿™ç§â€œé‡ç¡¬è½»è½¯â€çš„æŠ•èµ„æƒ¯æ€§ï¼Œå¯¼è‡´ç¡¬ä»¶é‡å¤æŠ•èµ„ï¼Œå¢åŠ è´¢æ”¿è´Ÿæ‹…å’Œä¼ä¸šæˆæœ¬ã€‚</p>
<p>å°æ¨¡å‹åˆ™ä»¥å…¶<strong>è½»é‡ã€é«˜æ•ˆã€ä½æˆæœ¬</strong>çš„ç‰¹æ€§ï¼Œæˆä¸ºæ™ºèƒ½ä½“æ™®åŠçš„ç†æƒ³é€‰æ‹©ï¼šå‚æ•°æ›´å°‘ã€å¿«é€Ÿæ¨ç†ã€èµ„æºé«˜æ•ˆã€ç‰¹å®šä»»åŠ¡ä¼˜åŒ–ã€æ³¨é‡éšç§ã€æˆæœ¬æ•ˆç›Šé«˜ã€æ›´æ˜“äºå¾®è°ƒã€ä¾¿æºæ˜“éƒ¨ç½²ã€‚</p>
<h2 data-id="heading-5"><strong>å°æ¨¡å‹æ™ºèƒ½ä½“å·²æ— å¤„ä¸åœ¨</strong></h2>
<p>åœ¨æ™ºæ…§åŸå¸‚é¢†åŸŸï¼Œè”æƒ³é›†å›¢åœ¨æ­¦å¤·å±±ã€å®œæ˜Œç­‰åŸå¸‚ç›¸ç»§è½åœ° <strong>â€œåŸå¸‚è¶…çº§æ™ºèƒ½ä½“â€</strong> ï¼Œå°†AIèƒ½åŠ›è¾“é€ç»™åŸå¸‚çš„å„è¡Œå„ä¸šå’Œå¸‚æ°‘æ¸¸å®¢ï¼Œå®ç°ä»æ”¿åŠ¡åˆ°æ°‘ç”Ÿã€äº§ä¸šçš„å…¨é¢æ™ºèƒ½åŒ–ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/779ec3b251704edaaaad19d27cbf7d9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033634&amp;x-signature=HYLlnbdo0RK9Iu0OvZHoFEzqDE8%3D" alt="dll8cyjpendofof9uobxneyd6yjash572342.jpg" loading="lazy"/></p>
<p>åœ¨æœºå™¨äººé¢†åŸŸï¼ŒGoogle DeepMindä¸Šçº¿çš„<strong>SIMA 2é¢„è§ˆç‰ˆ</strong>ä¾æ‰˜è½»é‡çº§çš„Gemini 2.5 Flash-liteæ¨¡å‹ï¼Œä»»åŠ¡æˆåŠŸç‡ç›¸è¾ƒäºSIMA 1å¤§å¹…æé«˜ï¼Œèƒ½åœ¨ä»æœªè§è¿‡çš„æ–°ç¯å¢ƒé‡Œå®Œæˆå¤æ‚æŒ‡ä»¤ï¼Œè¿˜å…·å¤‡è‡ªæˆ‘æ”¹è¿›èƒ½åŠ›ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77db5dbc545e4a2ba071c7c96da066c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033634&amp;x-signature=YSTP1PEUf0UV%2FXPnTQErQfD%2BwGw%3D" alt="screenshot_2025-11-17_16-37-05.png" loading="lazy"/></p>
<p>åœ¨å†…å®¹åˆ›ä½œã€çŸ¥è¯†é—®ç­”ã€æ™ºèƒ½åŠ©ç†ã€AIæœç´¢ç­‰åœºæ™¯ä¸­ï¼ŒåŸºäºå°æ¨¡å‹çš„æ™ºèƒ½ä½“ä¹Ÿå·²å®ç°å¹¿æ³›åº”ç”¨ã€‚</p>
<p>ä¸­å›½ä¿¡æ¯é€šä¿¡ç ”ç©¶é™¢äº‘è®¡ç®—ä¸å¤§æ•°æ®ç ”ç©¶æ‰€å‰¯æ‰€é•¿æ —è”šè¡¨ç¤ºï¼Œåœ¨ä¼ä¸šçº§åº”ç”¨æ–¹é¢ï¼Œå¯ä»¥åº”ç”¨æ™ºèƒ½ä½“æ¨åŠ¨ä¼ä¸šé™æœ¬å¢æ•ˆå’Œæ•°æ®é©±åŠ¨å†³ç­–çš„è¿›ä¸€æ­¥å®è·µã€‚</p>
<p><strong>åœ¨Coovallyä¸Šï¼ŒæŒç»­é›†æˆå’Œå¼€æºå¤šç±»é«˜è´¨é‡æ•°æ®é›†ï¼Œ</strong> è¦†ç›–æ— äººæœºå·¡æ£€ã€æ™ºæ…§å†œä¸šã€æ™ºæ…§æ¸”ä¸šç­‰å¤šä¸ªé¢†åŸŸï¼Œæ¨åŠ¨AIå¼€å‘æ›´åŠ é«˜æ•ˆä¸å¼€æ”¾ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/050651adbc7e4c1cac57f88cea84414b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764033634&amp;x-signature=FYRba416dSkYqs33Tx7LdJDSteo%3D" alt="æ¨¡å‹æ•°æ®é›†.GIF" loading="lazy"/></p>
<p><strong>ï¼ï¼ç‚¹å‡»ä¸‹æ–¹é“¾æ¥ï¼Œç«‹å³ä½“éªŒCoovallyï¼ï¼</strong></p>
<p><strong>å¹³å°é“¾æ¥ï¼š</strong> <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.coovally.com" target="_blank" title="https://www.coovally.com" ref="nofollow noopener noreferrer">www.coovally.com</a></strong></p>
<h2 data-id="heading-6"><strong>å°æ¨¡å‹æ™ºèƒ½ä½“çš„å‘å±•è·¯å¾„</strong></h2>
<p>å°æ¨¡å‹æ™ºèƒ½ä½“çš„å‘å±•ä¸ä¼šå–ä»£å¤§æ¨¡å‹ï¼Œè€Œæ˜¯å½¢æˆä¸€ç§<strong>äº’è¡¥å…±ç”Ÿçš„å…³ç³»</strong>ã€‚ä¼ä¸šæ­£åœ¨å°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œæ„å»ºæ··åˆæ¶æ„ï¼Œä»¥ä¼˜åŒ–ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼šå¤§æ¨¡å‹å¤„ç†å¤æ‚çš„æ¨ç†ã€æˆ˜ç•¥è§„åˆ’å’Œåˆ›é€ æ€§ä»»åŠ¡ï¼›</p>
<p>SLMæ‰§è¡Œå™¨ç®¡ç†é«˜é¢‘æ¬¡ã€ç‰¹å®šä»»åŠ¡çš„æ“ä½œï¼Œä¾‹å¦‚å®¢æˆ·æ”¯æŒã€æ•°æ®å¤„ç†å’Œç›‘æ§ã€‚</p>
<p>è¿™ç§åˆ†å·¥åä½œæ—¢èƒ½å®ç°æœ€ä½³èµ„æºåˆ†é…ï¼Œåˆèƒ½ä¿æŒå¤æ‚å·¥ä½œæµç¨‹æ‰€éœ€çš„æ™ºèƒ½æ€§ã€‚</p>
<p>æœªæ¥ï¼Œ<strong>å¼ºåŒ–å­¦ä¹ é©±åŠ¨çš„æŒç»­è¿­ä»£</strong>å°†æ˜¯Agentå‘å±•çš„å…³é”®è·¯å¾„ã€‚éšç€å·¥å…·ä½¿ç”¨èƒ½åŠ›çš„è¿›ä¸€æ­¥çªç ´ï¼Œå°æ¨¡å‹æ™ºèƒ½ä½“å°†èƒ½åœ¨æ›´å¤æ‚çš„ç¯å¢ƒä¸­æ„ŸçŸ¥ã€å†³ç­–å’Œè¡ŒåŠ¨ï¼ŒçœŸæ­£æˆä¸ºäººç±»çš„æ™ºèƒ½åŠ©æ‰‹ã€‚</p>
<p>AIæ™ºèƒ½ä½“æ­£åœ¨èµ°å‡ºå®éªŒå®¤ï¼Œèµ°è¿›æ™®é€šäººçš„æ—¥å¸¸ç”Ÿæ´»ã€‚å®ƒä»¬ä¸å†æ˜¯è¢«å¤§å‹ç§‘æŠ€å…¬å¸å„æ–­çš„å°–ç«¯æŠ€æœ¯ï¼Œè€Œæ˜¯æˆä¸ºä¸­å°ä¼ä¸šç”šè‡³ä¸ªäººéƒ½èƒ½é©¾é©­çš„æ™ºèƒ½å·¥å…·ã€‚</p>
<p>è®¡ç®—æœºè§†è§‰å°æ¨¡å‹ä¸æ™ºèƒ½ä½“çš„ç»“åˆï¼Œé¢„ç¤ºç€ä¸€ä¸ªå…¨æ–°æ–¹å‘çš„è¯ç”Ÿâ€”â€”äººå·¥æ™ºèƒ½ä¸å†è¿½æ±‚â€œæ›´å¤§æ›´å…¨â€ï¼Œè€Œæ˜¯æœç€â€œå°è€Œä¸“ã€ä¸“è€Œç²¾â€çš„æ–¹å‘æ¼”åŒ–ã€‚</p>
<p>è¿™æˆ–è®¸æ‰æ˜¯äººå·¥æ™ºèƒ½çœŸæ­£èµ°å‘æ™®åŠã€èµ°å‘å¹³æ°‘åŒ–çš„å¿…ç»ä¹‹è·¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äº‘åŸç”Ÿæ¸¸æˆç½‘å…³æ¶æ„ï¼šEKS + APISIX + Graviton æ„å»ºé«˜æ€§èƒ½æ¸¸æˆæœåŠ¡ç½‘å…³]]></title>    <link>https://juejin.cn/post/7573592952242323508</link>    <guid>https://juejin.cn/post/7573592952242323508</guid>    <pubDate>2025-11-18T01:37:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573592952242323508" data-draft-id="7573504290066694159" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äº‘åŸç”Ÿæ¸¸æˆç½‘å…³æ¶æ„ï¼šEKS + APISIX + Graviton æ„å»ºé«˜æ€§èƒ½æ¸¸æˆæœåŠ¡ç½‘å…³"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-18T01:37:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äºšé©¬é€Šäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2850395271209496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äº‘åŸç”Ÿæ¸¸æˆç½‘å…³æ¶æ„ï¼šEKS + APISIX + Graviton æ„å»ºé«˜æ€§èƒ½æ¸¸æˆæœåŠ¡ç½‘å…³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2850395271209496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äºšé©¬é€Šäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:37:18.000Z" title="Tue Nov 18 2025 01:37:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ç°ä»£æ¸¸æˆè¿è¥ç¯å¢ƒä¸­ï¼Œéšç€æ¸¸æˆæœåŠ¡å™¨è§„æ¨¡çš„ä¸æ–­æ‰©å¤§ï¼Œä¼ ç»Ÿçš„æœåŠ¡å™¨ä»£ç†æ–¹æ¡ˆé¢ä¸´ç€è¯¸å¤šæŒ‘æˆ˜ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ API Six è¿™ä¸€é«˜æ€§èƒ½ç½‘å…³æ¥è§£å†³å¤§è§„æ¨¡æ¸¸æˆæœåŠ¡å™¨ä»£ç†çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹éœ€è¦ä½¿ç”¨å¤šä¸ª Network Load Balancer (NLB) çš„åœºæ™¯ï¼Œæä¾›ä¸€ä¸ªæ›´åŠ ä¼˜é›…å’Œé«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚
åœ¨æ¸¸æˆæœåŠ¡æ¶æ„ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ä»¥ä¸‹å‡ ä¸ªå…³é”®æŒ‘æˆ˜ï¼š</p>
<p>1ã€ æœåŠ¡å™¨è§„æ¨¡é—®é¢˜</p>
<ul>
<li>éšç€æ¸¸æˆçš„æˆåŠŸè¿è¥ï¼ŒæœåŠ¡å™¨æ•°é‡å¯èƒ½ä»æœ€åˆçš„å‡ å°æ‰©å±•åˆ°æˆç™¾ä¸Šåƒå°</li>
<li>ä¼ ç»Ÿçš„ä½¿ç”¨å¤šä¸ª NLB è¿›è¡Œä»£ç†çš„æ–¹æ¡ˆåœ¨ç®¡ç†å’Œç»´æŠ¤ä¸Šå˜å¾—è¶Šæ¥è¶Šå¤æ‚</li>
<li>æˆæœ¬é—®é¢˜ï¼šæ¯å¢åŠ ä¸€ä¸ª NLB éƒ½ä¼šå¸¦æ¥é¢å¤–çš„è´¹ç”¨æ”¯å‡º</li>
</ul>
<p>2ã€ å®‰å…¨æ€§è€ƒè™‘</p>
<ul>
<li>æ¸¸æˆæœåŠ¡å™¨éœ€è¦é˜²æŠ¤å„ç§ç½‘ç»œæ”»å‡»</li>
<li>ä¼ ç»Ÿçš„ TCP åè®®ç¼ºä¹è¶³å¤Ÿçš„å®‰å…¨ä¿æŠ¤æœºåˆ¶</li>
<li>éœ€è¦åœ¨ä¸å½±å“æ€§èƒ½çš„å‰æä¸‹æä¾›å®‰å…¨ä¿éšœ</li>
</ul>
<p>3ã€è¿ç»´å¤æ‚æ€§</p>
<ul>
<li>å¤šä¸ª NLB çš„é…ç½®ç®¡ç†è¾ƒä¸ºç¹ç</li>
<li>æœåŠ¡å™¨æ‰©ç¼©å®¹æ—¶éœ€è¦é¢‘ç¹è°ƒæ•´è´Ÿè½½å‡è¡¡é…ç½®</li>
<li>ç›‘æ§å’Œæ•…éšœæ’æŸ¥çš„éš¾åº¦éšç€è§„æ¨¡å¢åŠ è€Œå¢åŠ </li>
</ul>
<p>é¢å¯¹è¿™äº›æŒ‘æˆ˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´ç°ä»£åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚API Six ä½œä¸ºä¸€ä¸ªé«˜æ€§èƒ½ã€å¯æ‰©å±•çš„ç½‘å…³ï¼Œç»“åˆ TLS åŠ å¯†ï¼Œèƒ½å¤Ÿå¾ˆå¥½åœ°è§£å†³è¿™äº›é—®é¢˜ã€‚åœ¨æ¥ä¸‹æ¥çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ API Six æ„å»ºä¸€ä¸ªé«˜æ•ˆã€å®‰å…¨ã€æ˜“äºç®¡ç†çš„æ¸¸æˆæœåŠ¡ç½‘å…³ç³»ç»Ÿã€‚</p>
<blockquote>
<p>ğŸ“¢é™æ—¶æ’æ’­ï¼šåœ¨æœ¬æ¬¡å®éªŒä¸­ï¼Œä½ å¯ä»¥åœ¨åŸºäº Graviton çš„ EC2 å®ä¾‹ä¸Šè½»æ¾å¯åŠ¨ Milvus å‘é‡æ•°æ®åº“ï¼ŒåŠ é€Ÿæ‚¨çš„ç”Ÿæˆå¼ AI åº”ç”¨ã€‚</p>
<p>â©å¿«å¿«ç‚¹å‡»è¿›å…¥ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.amazoncloud.cn%2Fexperience%2Fcloudlab%3Fid%3D668dfdebee6ab158880f2852%26visitfrom%3D3P_Juejinhead_0618%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejinhead_0618" target="_blank" title="https://dev.amazoncloud.cn/experience/cloudlab?id=668dfdebee6ab158880f2852&amp;visitfrom=3P_Juejinhead_0618&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejinhead_0618" ref="nofollow noopener noreferrer">åˆ›æ–°åŸºçŸ³ â€”â€” åŸºäº Graviton æ„å»ºå·®å¼‚åŒ–ç”Ÿæˆå¼AIå‘é‡æ•°æ®åº“</a>ã€‹å®éªŒ</p>
<p>ğŸ“± å³åˆ»åœ¨äº‘ä¸Šæ¢ç´¢å®éªŒå®¤ï¼Œå¼€å¯æ„å»ºå¼€å‘è€…æ¢ç´¢ä¹‹æ—…å§</p>
</blockquote>
<h2 data-id="heading-1">æ¶æ„ä»‹ç»</h2>
<h3 data-id="heading-2">1. æ¶æ„æ•´ä½“è¯´æ˜</h3>
<p>APIsixæ ¸å¿ƒç»„ä»¶è¿è¡Œäº Amazon EKSï¼ˆElastic Kubernetes Serviceï¼‰é›†ç¾¤å†…éƒ¨ã€‚æ•´ä¸ªç³»ç»Ÿä¸»è¦åˆ†ä¸ºä¸¤å¤§è®¿é—®å…¥å£ï¼šè¿ç»´ï¼ˆOpsï¼‰å’Œç©å®¶ï¼ˆPlayersï¼‰ï¼Œåˆ†åˆ«é€šè¿‡ç‹¬ç«‹çš„ ELBï¼ˆElastic Load Balancerï¼‰æ¥å…¥.(åœ¨æ­¤å»ºè®®å’±ä»¬åœ¨éƒ¨ç½²ç¯å¢ƒå‰å¯ä»¥å…ˆæ‰‹åŠ¨åˆ›å»ºELB, åœ¨EKSä¸­é€šè¿‡TargetGroupBindingçš„æ–¹å¼æ¥è¿›è¡Œç»‘å®šæœåŠ¡,è¿™æ ·å¯ä»¥ä¿è¯åç»­æœåŠ¡å˜æ›´æ—¶å‰ç«¯æ¥å…¥ELBä¸ºåŒä¸€ä¸ª.)</p>
<h3 data-id="heading-3">2. æµé‡å…¥å£</h3>
<ul>
<li>Opsï¼ˆè¿ç»´ï¼‰å…¥å£
è¿ç»´äººå‘˜é€šè¿‡ ELB è®¿é—® EKS é›†ç¾¤ä¸­çš„ Admin APIï¼Œå®ç°å¯¹å¹³å°çš„ç®¡ç†å’Œç›‘æ§ã€‚</li>
<li>Playersï¼ˆç©å®¶ï¼‰å…¥å£
ç©å®¶æµé‡åŒæ ·é€šè¿‡ç‹¬ç«‹çš„ ELB è¿›å…¥ EKS é›†ç¾¤ï¼Œä¸»è¦è®¿é—® API Gatewayï¼Œè¿›è€Œè·¯ç”±åˆ°å…·ä½“çš„æ¸¸æˆæœåŠ¡ï¼ˆGame Serverï¼‰æˆ–å¹³å°æœåŠ¡ï¼ˆPlatform Serviceï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-4">3. EKS é›†ç¾¤å†…éƒ¨ç»“æ„</h3>
<ul>
<li>Admin API å±‚
æä¾›ç®¡ç†æ¥å£ï¼Œä¾›è¿ç»´äººå‘˜æ“ä½œå’Œç®¡ç†æ•´ä¸ªç³»ç»Ÿã€‚</li>
<li>etcd å±‚
ä½œä¸ºåˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œè´Ÿè´£æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚Admin API ä¼šå°†å˜æ›´å†™å…¥ etcdï¼ŒAPI Gateway é€šè¿‡ watch æœºåˆ¶å®æ—¶æ„ŸçŸ¥æœåŠ¡å˜åŒ–ã€‚</li>
<li>API Gateway å±‚
è¿™ä¸€å±‚æ˜¯ç©å®¶è®¿é—®çš„ä¸»è¦å…¥å£ï¼ŒAPI Gateway è´Ÿè´£æ ¹æ® etcd çš„æœåŠ¡å‘ç°ä¿¡æ¯ï¼Œå°†ç©å®¶è¯·æ±‚è·¯ç”±åˆ°åç«¯çš„å…·ä½“æœåŠ¡ï¼ˆå¦‚ Platform Service æˆ– Game Serverï¼‰ã€‚</li>
<li>ä¸šåŠ¡æœåŠ¡å±‚
åŒ…å«å¹³å°æœåŠ¡ï¼ˆPlatform Serviceï¼‰å’Œå¤šä¸ªæ¸¸æˆæœï¼ˆGame Server1ã€Game Server2 ç­‰ï¼‰ï¼Œè¿™äº›æœåŠ¡æ˜¯æœ€ç»ˆå¤„ç†ç©å®¶è¯·æ±‚çš„æ ¸å¿ƒä¸šåŠ¡ç»„ä»¶ã€‚</li>
</ul>
<h2 data-id="heading-5">æ–¹æ¡ˆéƒ¨ç½²</h2>
<p>ä¸‹é¢æˆ‘ä»¬å°†é€æ­¥æ¥éªŒè¯æ•´ä¸ªæ–¹æ¡ˆ, æ–¹æ¡ˆä¸­æˆ‘ä»¬å°†é‡‡ç”¨æ¨¡æ‹ŸTCPåè®®çš„æ¸¸æˆæœåŠ¡,é€šè¿‡ELBæ¥å®ç°ä¸åŒæ¸¸æˆæœçš„è·¯ç”±åŠŸèƒ½.é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå®éªŒEKSé›†ç¾¤, å‚è€ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.aws.amazon.com%2Feks%2Flatest%2Fuserguide%2Fgetting-started.html" target="_blank" title="https://docs.aws.amazon.com/eks/latest/userguide/getting-started.html" ref="nofollow noopener noreferrer">EKSæ–‡æ¡£</a> åˆ›å»ºEKS.</p>
<h3 data-id="heading-6">åˆ›å»ºå¥½EKSå, æ·»åŠ ç”¨æˆ·æƒé™</h3>
<p>ç„¶ååˆ›å»ºAccess Entry</p>
<h3 data-id="heading-7">ä½¿ç”¨Helmæ¥å®‰è£…éƒ¨ç½²APISix</h3>
<p>æœ¬æ–‡é‡‡ç”¨çš„éƒ¨ç½²ç›®æ ‡æœåŠ¡å™¨ä¸ºäºšé©¬é€Šäº‘ç§‘æŠ€Gravitonæœºå‹,å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘æŒ¥APISixçš„æœ€å¤§æ€§èƒ½. å‚è€ƒæ­¥éª¤å¦‚ä¸‹:</p>
<p>1ã€æ·»åŠ ç›¸å…³helmåº“</p>
<pre><code class="hljs language-csharp" lang="csharp">helm repo <span class="hljs-keyword">add</span> apisix https:<span class="hljs-comment">//charts.apiseven.com</span>
helm repo update
</code></pre>
<p>2ã€æ•´ç†apisix-values.yaml</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># Tolerations for Graviton nodes (if needed)</span>
<span class="hljs-attr">tolerations:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">key:</span> <span class="hljs-string">"kubernetes.io/arch"</span>
    <span class="hljs-attr">operator:</span> <span class="hljs-string">"Equal"</span>
    <span class="hljs-attr">value:</span> <span class="hljs-string">"arm64"</span>
    <span class="hljs-attr">effect:</span> <span class="hljs-string">"NoSchedule"</span>

<span class="hljs-comment"># Affinity to prefer Graviton nodes</span>
<span class="hljs-attr">affinity:</span>
  <span class="hljs-attr">nodeAffinity:</span>
    <span class="hljs-attr">preferredDuringSchedulingIgnoredDuringExecution:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">weight:</span> <span class="hljs-number">100</span>
      <span class="hljs-attr">preference:</span>
        <span class="hljs-attr">matchExpressions:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">key:</span> <span class="hljs-string">kubernetes.io/arch</span>
          <span class="hljs-attr">operator:</span> <span class="hljs-string">In</span>
<span class="hljs-comment">### values:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-string">arm64</span>
</code></pre>
<p>3ã€æ‰§è¡Œå‘½ä»¤æ›´æ–°æœåŠ¡</p>
<pre><code class="hljs language-css" lang="css">helm install apisix apisix/apisix <span class="hljs-attr">--create-namespace</span> <span class="hljs-attr">--namespace</span> ingress-apisix \
<span class="hljs-attr">--values</span> apisix-values<span class="hljs-selector-class">.yaml</span>
</code></pre>
<p>4ã€å¦‚æœæ­¤å¤„éƒ¨ç½²æœ‰é—®é¢˜,ä¸€å®šè¦å…³æ³¨ä¸€ä¸‹å½“å‰çš„storageclassæ˜¯å¦å­˜åœ¨.</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">etcd:</span>
  <span class="hljs-attr">persistence:</span>
    <span class="hljs-attr">storageClass:</span> <span class="hljs-string">efs-sc</span> <span class="hljs-comment"># è¯·æ ¼å¤–æ³¨æ„æ­¤å¤„,å¦åˆ™å¯èƒ½æ–¹æ¡ˆéƒ¨ç½²å¤±è´¥.</span>
</code></pre>
<p>å¦æ¨èä¸€ä¸ªå°æŠ€å·§,å¦‚æœéƒ¨ç½²å‡ºç°é—®é¢˜,å¯ä»¥ä½¿ç”¨Amazon Q CLIæ¥åšè¯Šæ–­,æ•´ä¸ªè¿‡ç¨‹å®Œå…¨è‡ªåŠ¨åŒ–,ä¸‹é¢æ˜¯æˆ‘çš„æ­¥éª¤æˆªå›¾.</p>
<h3 data-id="heading-8">éƒ¨ç½² æ¸¸æˆæœåŠ¡</h3>
<p>æ¨¡æ‹Ÿæ¸¸æˆæœä»£ç </p>
<pre><code class="hljs language-python" lang="python"> <span class="hljs-comment"># Bind to all interfaces</span>
    server.bind((<span class="hljs-string">'0.0.0.0'</span>, port))
    server.listen(<span class="hljs-number">5</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[*] <span class="hljs-subst">{server_name}</span> listening on 0.0.0.0:<span class="hljs-subst">{port}</span>"</span>)
    
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            client, addr = server.accept()
            client_handler = threading.Thread(target=handle_client, args=(client, addr))
            client_handler.daemon = <span class="hljs-literal">True</span>
            client_handler.start()
    <span class="hljs-keyword">except</span> KeyboardInterrupt:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{server_name}</span>] Shutting down server"</span>)
        server.close()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    start_server(<span class="hljs-number">9000</span>)
</code></pre>
<p>æ¨¡æ‹ŸEKSä¸­çš„æœåŠ¡éƒ¨ç½²ä»£ç : test-server-1.yaml</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">test-server-1</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">game</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-1</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-1</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-1</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">tcp-server</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">python:3.9-slim</span>
        <span class="hljs-attr">command:</span> [<span class="hljs-string">"python"</span>]
        <span class="hljs-attr">args:</span> [<span class="hljs-string">"-u"</span>, <span class="hljs-string">"/app/tcp-echo-server.py"</span>, <span class="hljs-string">"test-server-1"</span>]
        <span class="hljs-attr">ports:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">9000</span>
        <span class="hljs-attr">volumeMounts:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">script-volume</span>
          <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/app</span>
      <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">script-volume</span>
        <span class="hljs-attr">configMap:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">tcp-echo-server</span>
          <span class="hljs-attr">defaultMode:</span> <span class="hljs-number">0777</span>
<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">gs-1</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">game</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-1</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-1</span>
  <span class="hljs-attr">ports:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">9000</span>
    <span class="hljs-attr">targetPort:</span> <span class="hljs-number">9000</span>
    <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span> 
<span class="hljs-string">test-server-2.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">test-server-2</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">game</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-2</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-2</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-2</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">tcp-server</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">python:3.9-slim</span>
        <span class="hljs-attr">command:</span> [<span class="hljs-string">"python"</span>]
        <span class="hljs-attr">args:</span> [<span class="hljs-string">"-u"</span>, <span class="hljs-string">"/app/tcp-echo-server.py"</span>, <span class="hljs-string">"test-server-2"</span>]
        <span class="hljs-attr">ports:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">9000</span>
        <span class="hljs-attr">volumeMounts:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">script-volume</span>
          <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/app</span>
      <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">script-volume</span>
        <span class="hljs-attr">configMap:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">tcp-echo-server</span>
          <span class="hljs-attr">defaultMode:</span> <span class="hljs-number">0777</span>
<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">gs-2</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">game</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-2</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">test-server-2</span>
  <span class="hljs-attr">ports:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">9000</span>
    <span class="hljs-attr">targetPort:</span> <span class="hljs-number">9000</span>
    <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span>
</code></pre>
<p>éƒ¨ç½²æœåŠ¡</p>
<pre><code class="hljs language-vbscript" lang="vbscript">kubectl create namespace game
kubectl create configmap tcp-echo-<span class="hljs-built_in">server</span> --from-file=tcp-echo-<span class="hljs-built_in">server</span>.py --namespace game
kubectl apply -f test-<span class="hljs-built_in">server</span><span class="hljs-number">-1.</span>yaml
kubectl apply -f test-<span class="hljs-built_in">server</span><span class="hljs-number">-2.</span>yaml
</code></pre>
<h3 data-id="heading-9">é…ç½®è¯ä¹¦</h3>
<p>å½“ä½¿ç”¨TLSçš„SNIåŠŸèƒ½æ—¶,æ¯ä¸ªä½ æƒ³è¦ä½¿ç”¨SNIçš„åŸŸåæˆ–ä¸»æœºåéƒ½éœ€è¦ä¸€ä¸ªæœ‰æ•ˆçš„è¯ä¹¦ã€‚è¿™æ˜¯å› ä¸ºSNIå…è®¸ä»åŒä¸€ä¸ªIPåœ°å€å’Œç«¯å£æä¾›å¤šä¸ªä¸»æœºåæœåŠ¡,è€Œè¯ä¹¦ç”¨äºéªŒè¯æœåŠ¡å™¨çš„èº«ä»½å¹¶ä¸å®¢æˆ·ç«¯å»ºç«‹åŠ å¯†è¿æ¥ã€‚ä½¿ç”¨OpenSSLä¸º2ä¸ªGame ServeræœåŠ¡ç”Ÿæˆè¯ä¹¦æ–‡ä»¶å’Œå¯†é’¥æ–‡ä»¶ã€‚</p>
<p>1ã€ç”Ÿæˆè¯ä¹¦</p>
<pre><code class="hljs language-csharp" lang="csharp">openssl req -<span class="hljs-keyword">new</span> -newkey rsa:<span class="hljs-number">2048</span> -days <span class="hljs-number">365</span> -nodes -x509 -keyout gs<span class="hljs-number">-1.</span>key -<span class="hljs-keyword">out</span> gs<span class="hljs-number">-1.</span>crt -subj <span class="hljs-string">"/CN=gs-1.com"</span>
openssl req -<span class="hljs-keyword">new</span> -newkey rsa:<span class="hljs-number">2048</span> -days <span class="hljs-number">365</span> -nodes -x509 -keyout gs<span class="hljs-number">-2.</span>key -<span class="hljs-keyword">out</span> gs<span class="hljs-number">-2.</span>crt -subj <span class="hljs-string">"/CN=gs-2.com"</span>
</code></pre>
<p>2ã€ä¸Šä¼ è¯ä¹¦åˆ°apisix</p>
<pre><code class="hljs language-javascript" lang="javascript">kubectl port-forward -n ingress-apisix svc/apisix-admin <span class="hljs-number">9180</span>:<span class="hljs-number">9180</span> &amp;
sleep <span class="hljs-number">3</span>
curl  -X <span class="hljs-variable constant_">POST</span> <span class="hljs-attr">http</span>:<span class="hljs-comment">//127.0.0.1:9180/apisix/admin/ssls -H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -d '</span>
{
    <span class="hljs-string">"cert"</span>: <span class="hljs-string">"'"</span>$(cat gs-<span class="hljs-number">1.</span>crt)<span class="hljs-string">"'"</span>,
    <span class="hljs-string">"key"</span>: <span class="hljs-string">"'"</span>$(cat gs-<span class="hljs-number">1.</span>key)<span class="hljs-string">"'"</span>,
    <span class="hljs-string">"snis"</span>: [<span class="hljs-string">"gs-1.com"</span>]
}<span class="hljs-string">'
# Create SSL certificate for gs-2.com
curl -X POST http://127.0.0.1:9180/apisix/admin/ssls -H '</span>X-<span class="hljs-variable constant_">API</span>-<span class="hljs-attr">KEY</span>: edd1c9f034335f136f87ad84b625c8f1<span class="hljs-string">'  -d '</span>
{
    <span class="hljs-string">"cert"</span>: <span class="hljs-string">"'"</span>$(cat gs-<span class="hljs-number">2.</span>crt)<span class="hljs-string">"'"</span>,
    <span class="hljs-string">"key"</span>: <span class="hljs-string">"'"</span>$(cat gs-<span class="hljs-number">2.</span>key)<span class="hljs-string">"'"</span>,
    <span class="hljs-string">"snis"</span>: [<span class="hljs-string">"gs-2.com"</span>]
}<span class="hljs-string">'
kill %1
</span></code></pre>
<p>3ã€éªŒè¯è¯ä¹¦ä¸Šä¼ </p>
<pre><code class="hljs language-ruby" lang="ruby">curl -X <span class="hljs-variable constant_">GET</span> <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/127.0.0.1:9180/apisix</span><span class="hljs-regexp">/admin/ssls</span> -H <span class="hljs-string">'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1'</span> 

</code></pre>
<h3 data-id="heading-10">é…ç½®è·¯ç”±</h3>
<p>ä¸‹é¢æˆ‘ä»¬åŸºäºå·²ç»é…ç½®å¥½çš„è¯ä¹¦æ¥é…ç½®ç›¸å…³çš„è·¯ç”±ä¿¡æ¯, ä¹Ÿå°±æ˜¯é€šå¸¸æˆ‘ä»¬åœ¨å¹³å°æœé…ç½®å¥½è¯ä¹¦å,å¯ä»¥è°ƒç”¨ç›¸å…³APIæ¥é…ç½®è·¯ç”±,å‘½ä»¤ä¿¡æ¯å¦‚ä¸‹:</p>
<pre><code class="hljs language-vbnet" lang="vbnet">kubectl port-forward -n ingress-apisix svc/apisix-admin <span class="hljs-number">9180</span>:<span class="hljs-number">9180</span> &amp;
sleep <span class="hljs-number">3</span>
curl -i -X POST http://<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">9180</span>/apisix/admin/stream_routes -H <span class="hljs-comment">'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -d '{</span>
  <span class="hljs-string">"upstream"</span>: {
    <span class="hljs-string">"nodes"</span>: {
      <span class="hljs-string">"gs-1.game.svc.cluster.local:9000"</span>: <span class="hljs-number">1</span>
    },
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"roundrobin"</span>
  },
  <span class="hljs-string">"sni"</span>: <span class="hljs-string">"gs-1.com"</span>
}<span class="hljs-comment">'</span>

curl -i -X POST http://<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">9180</span>/apisix/admin/stream_routes -H <span class="hljs-comment">'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -d '{</span>
  <span class="hljs-string">"upstream"</span>: {
    <span class="hljs-string">"nodes"</span>: {
      <span class="hljs-string">"gs-2.game.svc.cluster.local:9000"</span>: <span class="hljs-number">1</span>
    },
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"roundrobin"</span>
  },
  <span class="hljs-string">"sni"</span>: <span class="hljs-string">"gs-2.com"</span>
}<span class="hljs-comment">'</span>
</code></pre>
<h3 data-id="heading-11">æµ‹è¯•åŸºäºSNIçš„è®¿é—®</h3>
<p>é¦–å…ˆè·å–å¯¹åº”APIsixæœåŠ¡çš„ALBåœ°å€</p>
<pre><code class="hljs language-arduino" lang="arduino">&gt; kubectl get svc -n ingress-apisix apisix-gateway
NAME             TYPE           CLUSTER-IP      <span class="hljs-literal">EXTERNAL</span>-<span class="hljs-function">IP                                                                     <span class="hljs-title">PORT</span><span class="hljs-params">(S)</span>                       AGE
apisix-gateway   LoadBalancer   10.100.xxxx.12   k8s-ingressa-apisixga-xxxxxxx-xxx.elb.us-east-1.amazonaws.com   80:<span class="hljs-number">30496</span>/TCP,<span class="hljs-number">8888</span>:<span class="hljs-number">30694</span>/TCP   <span class="hljs-number">3</span>d2h

</span></code></pre>
<p>é€šè¿‡ä¸Šé¢è¿”å›è·å–çš„ALBçš„åœ°å€</p>
<pre><code class="hljs language-arduino" lang="arduino">openssl s_client -connect k8s-ingressa-apisixga-xxxxx.xxxx.elb.ap-northeast<span class="hljs-number">-1.</span>amazonaws.com:<span class="hljs-number">8888</span> \
-servername gs<span class="hljs-number">-1.</span>com -quiet
openssl s_client -connect k8s-ingressa-apisixga-xxxx.xxxx.elb.ap-northeast<span class="hljs-number">-1.</span>amazonaws.com:<span class="hljs-number">8888</span> \
-servername gs<span class="hljs-number">-2.</span>com -quiet
</code></pre>
<p>è‡³æ­¤å¯ä»¥çœ‹åˆ°é€šè¿‡ä¸åŒçš„SNIæˆ‘å°±å¯ä»¥è®¿é—®åˆ°ä¸åŒçš„æ¸¸æˆæœäº†,ä¹Ÿå°±è§£å†³äº†ä½¿ç”¨åŒä¸€ä¸ªNLB+APIsixçš„è®¿é—®ä¸åŒçš„æ¸¸æˆæœäº†.</p>
<h3 data-id="heading-12">APISix dashboardè®¿é—® (Optional)</h3>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡Dashboardæ¥è®¿é—®å½“å‰çš„APIsixç³»ç»Ÿ,æŸ¥çœ‹ç›¸å…³çš„é…ç½®æ•°æ®. ä¸è¿‡è¿™é‡Œéœ€è¦æˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹ALBçš„certificate ARN æ˜¯ä¸æ˜¯æ­£ç¡®.</p>
<p><code>kubectl get ingress -n ingress-apisix</code></p>
<h2 data-id="heading-13">APISix éƒ¨ç½²äºšé©¬é€Šäº‘ç§‘æŠ€æœ€ä½³å®è·µ</h2>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½² Apache APISIX æ—¶çš„å…³é”®æœ€ä½³å®è·µï¼Œå¸®åŠ©æå‡ç¨³å®šæ€§ã€æ€§èƒ½ä¸å¯ç»´æŠ¤æ€§ã€‚</p>
<h3 data-id="heading-14">æ ¸å¿ƒæ¶æ„ä¸ç»„ä»¶åˆ†ç¦»</h3>
<h4 data-id="heading-15">ä¸ºäº†ä¿è¯ç³»ç»Ÿå¯æ‰©å±•ä¸é«˜å¯ç”¨ï¼Œæ¨èå°† APISIX å„æ ¸å¿ƒç»„ä»¶è§£è€¦éƒ¨ç½²ï¼š</h4>
<ul>
<li>æ§åˆ¶å¹³é¢ï¼ˆetcdï¼‰ï¼šä½¿ç”¨å•ç‹¬éƒ¨ç½²çš„ etcd é›†ç¾¤å­˜å‚¨è·¯ç”±ä¸æ’ä»¶é…ç½®ï¼Œå»ºè®®åœ¨éƒ¨ç½²APISixçš„æ—¶å€™ç›´æ¥æŒ‡å‘é¢„å…ˆéƒ¨ç½²å¥½çš„etcdï¼Œè‡³å°‘éƒ¨ç½² 3 èŠ‚ç‚¹ï¼Œå¼€å¯æ•°æ®æŒä¹…åŒ–ä¸å¿«ç…§å¤‡ä»½ï¼Œé˜²æ­¢å•ç‚¹æ•…éšœã€‚</li>
<li>æ•°æ®å¹³é¢ï¼ˆAPISIX èŠ‚ç‚¹ï¼‰ï¼šå¤–éƒ¨è¯·æ±‚ç”±å¤šä¸ª APISIX å®ä¾‹å¤„ç†ï¼ŒæŒ‰éœ€æ°´å¹³æ‰©å®¹ã€‚æ¯ä¸ªå®ä¾‹ä»…è´Ÿè´£æµé‡è½¬å‘ä¸æ’ä»¶æ‰§è¡Œï¼Œé…ç½®ä» etcd åŠ¨æ€æ‹‰å–ã€‚</li>
<li>è¿ç»´ç›‘æ§ï¼ˆPrometheus &amp; Grafanaï¼‰ï¼šéƒ¨ç½²ä¸“ç”¨çš„ç›‘æ§ç³»ç»Ÿï¼Œé‡‡é›† APISIX åŠ etcd çš„æŒ‡æ ‡ä¸æ—¥å¿—ï¼Œå®æ—¶å‘Šè­¦ä¸å¯è§†åŒ–ã€‚</li>
</ul>
<h4 data-id="heading-16">éƒ¨ç½²æ¨¡å¼ä¸æ‰©å±•ç­–ç•¥</h4>
<ul>
<li>æ— çŠ¶æ€éƒ¨ç½²
APISIX å®ä¾‹æœ¬èº«åº”ä¿æŒæ— çŠ¶æ€ï¼Œæ‰€æœ‰åŠ¨æ€é…ç½®å‡å­˜å‚¨åœ¨ etcdã€‚å®¹å™¨åŒ–æˆ–è™šæ‹ŸæœºåŒ–å‡å¯ï¼Œå€ŸåŠ© Kubernetes ç­‰å¹³å°å®ç°è‡ªåŠ¨ä¼¸ç¼©ä¸æ»šåŠ¨å‡çº§ã€‚</li>
<li>æ°´å¹³æ‰©å±•
æ ¹æ® QPS ä¸å“åº”å»¶è¿ŸæŒ‡æ ‡ï¼ŒåŠ¨æ€æ‰©ç¼©å®¹ã€‚å»ºè®®åœ¨ Kubernetes ä¸­é…ç½® HPAï¼ˆHorizontal Pod Autoscalerï¼‰ï¼Œç»“åˆè‡ªå®šä¹‰æŒ‡æ ‡ï¼ˆå¦‚ CPUã€å†…å­˜æˆ–è¯·æ±‚é€Ÿç‡ï¼‰è‡ªåŠ¨è°ƒæ•´å®ä¾‹æ•°ã€‚</li>
<li>ç°åº¦å‘å¸ƒä¸å›æ»š
é…åˆ Kubernetes Deployment æˆ–å…¶å®ƒå‘å¸ƒå·¥å…·ï¼Œåˆ©ç”¨ canary å‘å¸ƒç­–ç•¥é€æ­¥ä¸‹å‘æ–°ç‰ˆæœ¬ã€‚åœ¨å‡ºç°é—®é¢˜æ—¶ï¼Œå¯å¿«é€Ÿå›æ»šè‡³ç¨³å®šç‰ˆæœ¬ï¼Œä¸”ä¸ä¸­æ–­å¤§éƒ¨åˆ†æµé‡ã€‚</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">lifecycle:
  preStop:
    <span class="hljs-built_in">exec</span>:
      <span class="hljs-built_in">command</span>: [<span class="hljs-string">"sh"</span>, <span class="hljs-string">"-c"</span>, <span class="hljs-string">"sleep 15 &amp;&amp; apisix quit"</span>]
</code></pre>
<h3 data-id="heading-17">ç½‘ç»œä¸å®‰å…¨</h3>
<ul>
<li>é«˜æ€§èƒ½ç½‘ç»œ
é‡‡ç”¨ L4 è´Ÿè½½å‡è¡¡ï¼ˆå¦‚ Nginx Streamã€LVSï¼‰å°†æµé‡åˆ†å‘è‡³ APISIXï¼Œé¿å…åœ¨ L7 å±‚å¼•å…¥è¿‡å¤šé¢å¤–å»¶è¿Ÿã€‚</li>
<li>TLS ç»ˆç«¯
å¦‚éœ€ HTTPS æ”¯æŒï¼Œæ¨èåœ¨è¾¹ç¼˜å±‚ï¼ˆL4ï¼‰ç»ˆç«¯ TLSï¼Œå†ä»¥ HTTP é€šä¿¡è‡³ APISIXï¼›æˆ–ç›´æ¥åœ¨ APISIX ä¸Šä½¿ç”¨ ssl æ’ä»¶ç»ˆç«¯ TLSï¼Œå¹¶ç»“åˆ Cert-Manager è‡ªåŠ¨ç»­ç­¾è¯ä¹¦ã€‚</li>
<li>è®¿é—®æ§åˆ¶ä¸è®¤è¯
å¯ç”¨ IP é»‘ç™½åå•ã€ACL æ’ä»¶ï¼Œå¹¶æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ¥å…¥ JWTã€OAuth2 ç­‰è®¤è¯æ’ä»¶ï¼Œç¡®ä¿åç«¯æœåŠ¡å®‰å…¨ã€‚</li>
</ul>
<h3 data-id="heading-18">é…ç½®ç®¡ç†ä¸ç‰ˆæœ¬æ§åˆ¶</h3>
<ul>
<li>åŸºç¡€é…ç½®ä¸çƒ­æ›´æ–°
æŠŠè·¯ç”±ã€ä¸Šæ¸¸æœåŠ¡ã€æ’ä»¶é…ç½®ä»¥ YAML/JSON æ ¼å¼å­˜å‚¨äºä»£ç ä»“åº“ï¼Œç»“åˆ CI/CD æµæ°´çº¿è‡ªåŠ¨åŒæ­¥è‡³ etcdï¼Œå®ç°é…ç½®å³ä»£ç ï¼ˆConfiguration as Codeï¼‰ã€‚</li>
<li>ç‰ˆæœ¬ç®¡ç†
æ¯æ¬¡é…ç½®å˜æ›´éƒ½éœ€æ‰“ tag å¹¶åœ¨æµæ°´çº¿ä¸­æ ¡éªŒï¼ˆlintã€å•å…ƒæµ‹è¯•ã€ç°åº¦å‘å¸ƒï¼‰ï¼Œç¡®ä¿å˜æ›´å¯è¿½æº¯ã€å¯å›æ»šã€‚</li>
<li>é€‰æ‹©ç¨³å®šç‰ˆæœ¬,å¹¶åŠæ—¶è·Ÿè¿›ç¤¾åŒºçš„æ›´æ–°.</li>
<li>å‡çº§ç‰ˆæœ¬æ—¶éœ€è¦è¿›è¡Œå®Œæ•´çš„å›å½’æµ‹è¯•,ä¿è¯æ–°ç‰ˆæœ¬çš„å…¼å®¹æ€§é—®é¢˜.</li>
</ul>
<h3 data-id="heading-19">æ€§èƒ½ä¼˜åŒ–ä¸æ’ä»¶æ²»ç†</h3>
<ul>
<li>å®ä¾‹é€‰æ‹©
ä¼˜å…ˆé€‰æ‹©Gravitonç±»å‹ä¸»æœºï¼Œç»è¿‡å¤šè½®æµ‹è¯•å‘ç°Gravitonçš„æœºå‹ç›¸å¯¹äºx86æœºå‹å¯ä»¥æä¾›è‡³å°‘2ä¸¤å€çš„æ€§èƒ½æå‡ï¼Œå…·ä½“è¯·å‚è€ƒç¤¾åŒº Benchmark <a href="https://link.juejin.cn?target=https%3A%2F%2Fapisix.apache.org%2Fblog%2F2022%2F08%2F12%2Farm-performance-google-aws-azure-with-apisix%2F" target="_blank" title="https://apisix.apache.org/blog/2022/08/12/arm-performance-google-aws-azure-with-apisix/" ref="nofollow noopener noreferrer">é“¾æ¥</a>ï¼š.</li>
<li>æ’ä»¶å¼€å…³ç²’åº¦</li>
</ul>
<p>ä»…åœ¨éœ€è¦çš„è·¯ç”±ä¸Šå¯ç”¨æ’ä»¶ï¼Œé¿å…å…¨å±€åŠ è½½è¿‡å¤šæ’ä»¶å¯¼è‡´è¯·æ±‚è·¯å¾„å†—ä½™æ‰§è¡Œã€‚</p>
<ul>
<li>ç¼“å­˜ä¸é™æµ
åˆ©ç”¨ proxy-cache æ’ä»¶å¯¹é™æ€æˆ–å¯ç¼“å­˜å“åº”è¿›è¡Œæœ¬åœ°ç¼“å­˜ï¼Œå‡è½»åç«¯å‹åŠ›ï¼›ç»“åˆ limit-reqã€limit-count æ’ä»¶é˜²æ­¢æµé‡çªå‘ä¸æ¶æ„æ”»å‡»ã€‚</li>
<li>æ—¥å¿—ä¸è¿½è¸ª
å¯ç”¨ skywalkingã€zipkin æˆ– opentelemetry æ’ä»¶ï¼Œå°†è¯·æ±‚é“¾è·¯ä¸æŒ‡æ ‡ä¸ŠæŠ¥è‡³åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿï¼Œå¿«é€Ÿå®šä½æ€§èƒ½ç“¶é¢ˆã€‚</li>
</ul>
<h3 data-id="heading-20">ç›‘æ§å‘Šè­¦ä¸å¥åº·æ£€æŸ¥</h3>
<ul>
<li>å¥åº·æ¢é’ˆ
åœ¨ Kubernetes ä¸­é…ç½® LivenessProbe ä¸ ReadinessProbeï¼ŒAPISIX èŠ‚ç‚¹å¼‚å¸¸æ—¶å¯è‡ªåŠ¨å‰”é™¤ã€‚</li>
<li>å…³é”®æŒ‡æ ‡
é‡ç‚¹ç›‘æ§è¯·æ±‚é€Ÿç‡ã€å“åº”å»¶è¿Ÿã€é”™è¯¯ç‡ï¼Œä»¥åŠ etcd çš„å»¶è¿Ÿä¸ leader é€‰ä¸¾çŠ¶æ€ã€‚æ ¹æ®é˜ˆå€¼é…ç½®å‘Šè­¦è§„åˆ™ï¼Œä¿è¯æ•…éšœå¯è¢«åŠæ—¶å‘ç°ä¸å“åº”</li>
<li>åœ¨å®é™…ç”Ÿäº§ä¸­ï¼Œå¦‚æœserviceæ•°é‡æ¯”è¾ƒå¤šä»¥åŠå¹¶å‘å¤§çš„æƒ…å†µä¸‹ï¼Œéœ€è¦å¯¹netfilter.nf_conntrack_maxè¿›è¡Œè°ƒæ•´ã€‚å»ºè®®ç»“åˆprometheuså’Œgrafanaè¿›è¡Œå‘Šè­¦ï¼ŒåŠæ—¶å‘ç°é—®é¢˜å¹¶ä¼˜åŒ–ç›¸å…³å‚æ•°ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡é‡‡ç”¨ç±»ä¼¼C7gnçš„æœºå‹æ¥æå‡ç½‘ç»œååã€‚</li>
</ul>
<h3 data-id="heading-21">ç¾å¤‡ä¸é«˜å¯ç”¨è®¾è®¡</h3>
<ul>
<li>è·¨å¯ç”¨åŒºéƒ¨ç½²
å°† etcd å’Œ APISIX å®ä¾‹åˆ†å¸ƒåœ¨å¤šä¸ªå¯ç”¨åŒºæˆ–æœºæˆ¿ï¼Œä¿è¯å•åŒºæ•…éšœæ—¶ä»æœ‰æœåŠ¡å¯ç”¨ã€‚</li>
<li>å®šæœŸå¤‡ä»½
å¯¹ etcd æ•°æ®è¿›è¡Œå‘¨æœŸæ€§å…¨é‡ä¸å¢é‡å¤‡ä»½ï¼Œå¹¶åœ¨å¼‚åœ°å­˜å‚¨ï¼›åŒæ—¶éªŒè¯å¤‡ä»½å¯ç”¨æ€§ä¸æ¢å¤æµç¨‹ã€‚</li>
</ul>
<p>é€šè¿‡ä¸Šè¿°æœ€ä½³å®è·µï¼Œå¯ä»¥æ„å»ºä¸€å¥— é«˜å¯ç”¨ã€å¯æ‰©å±•ã€æ˜“è¿ç»´ çš„ APISIX æœåŠ¡éƒ¨ç½²ä½“ç³»ï¼Œæ»¡è¶³ä¸šåŠ¡åœ¨å¤æ‚æµé‡ä¸‹çš„ç¨³å®šè¿è¡Œä¸å¿«é€Ÿè¿­ä»£éœ€æ±‚ã€‚</p>
<h2 data-id="heading-22">æ€»ç»“</h2>
<p>å€ŸåŠ©ä»¥ä¸Šæ–¹æ¡ˆé€šè¿‡å°†æ‰€æœ‰ç©å®¶å’Œè¿ç»´æµé‡å…ˆæ±‡èšåˆ°å•ä¸ªNLBï¼Œå†ç”±éƒ¨ç½²åœ¨ EKS é›†ç¾¤å†…çš„ Apache APISIX æŒ‰ TLS SNI æŠŠè¯·æ±‚ç²¾å‡†åˆ†å‘åˆ°å„æ¸¸æˆæœï¼Œä»è€Œç”¨æœ€å°‘çš„è´Ÿè½½å‡è¡¡å®ä¾‹å®ç°ç»Ÿä¸€è·¯ç”±ã€åŠ¨æ€æœåŠ¡å‘ç°å’Œå…¨é“¾è·¯åŠ å¯†ï¼Œä¸ä»…æ˜¾è‘—é™ä½ NLB æˆæœ¬å’Œé…ç½®å¤æ‚åº¦ï¼Œè¿˜èƒ½åœ¨æœåŠ¡å™¨æ‰©ç¼©å®¹æ—¶ä¿æŒæµé‡æ— æ„ŸçŸ¥åˆ‡æ¢ï¼Œæˆä¸ºé«˜å¹¶å‘æ¸¸æˆåœºæ™¯ä¸‹ç»æµã€é«˜æ•ˆä¸”æ˜“ç»´æŠ¤çš„ç½‘å…³æ¶æ„ï¼ŒåŒæ—¶ï¼Œå€ŸåŠ©Gravitonï¼ŒAPISixèƒ½å¤Ÿå®ç°æé«˜çš„æ€§ä»·æ¯”ã€‚</p>
<p><strong>å‚è€ƒå†…å®¹</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi7.ai%2Fblog%2Fapi7-latency" target="_blank" title="https://api7.ai/blog/api7-latency" ref="nofollow noopener noreferrer">api7.ai/blog/api7-lâ€¦</a>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fapisix.apache.org%2Fblog%2F2022%2F08%2F12%2Farm-performance-google-aws-azure-with-apisix%2F" target="_blank" title="https://apisix.apache.org/blog/2022/08/12/arm-performance-google-aws-azure-with-apisix/" ref="nofollow noopener noreferrer">apisix.apache.org/blog/2022/0â€¦</a></p>
<p><strong>æœ¬ç¯‡ä½œè€…</strong>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0dbcc637dd954715884de9dbe304a8bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764034638&amp;x-signature=77S98A2q6FfnfTPi%2FFXqUcqOsKs%3D" alt="æœ¬ç¯‡ä½œè€….webp" loading="lazy"/></p>
<blockquote>
<p>æœ¬æœŸæœ€æ–°å®éªŒä¸ºã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.amazoncloud.cn%2Fexperience%2Fcloudlab%3Fid%3D668dfdebee6ab158880f2852%26visitfrom%3D3P_Juejintail_0418%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejintail_0418" target="_blank" title="https://dev.amazoncloud.cn/experience/cloudlab?id=668dfdebee6ab158880f2852&amp;visitfrom=3P_Juejintail_0418&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejintail_0418" ref="nofollow noopener noreferrer">åˆ›æ–°åŸºçŸ³ â€”â€” åŸºäº Graviton æ„å»ºå·®å¼‚åŒ–ç”Ÿæˆå¼AIå‘é‡æ•°æ®åº“</a>ã€‹</p>
<p>âœ¨ åœ¨æœ¬æ¬¡å®éªŒä¸­ï¼Œä½ å¯ä»¥åœ¨åŸºäº Graviton çš„ EC2 å®ä¾‹ä¸Šè½»æ¾å¯åŠ¨ Milvus å‘é‡æ•°æ®åº“ï¼ŒåŠ é€Ÿæ‚¨çš„ç”Ÿæˆå¼ AI åº”ç”¨ã€‚åŸºäº Graviton çš„ EC2 å®ä¾‹ä¸ºæ‚¨æä¾›æä½³æ€§ä»·æ¯”çš„å‘é‡æ•°æ®åº“éƒ¨ç½²é€‰é¡¹ã€‚</p>
<p>ğŸ“± å³åˆ»åœ¨äº‘ä¸Šæ¢ç´¢å®éªŒå®¤ï¼Œå¼€å¯æ„å»ºå¼€å‘è€…æ¢ç´¢ä¹‹æ—…å§ï¼</p>
<p>â©[<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.amazoncloud.cn%2Fexperience%2Fcloudlab%3Fid%3D668dfdebee6ab158880f2852%26visitfrom%3D3P_Juejintail_0418%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejintail_0418" target="_blank" title="https://dev.amazoncloud.cn/experience/cloudlab?id=668dfdebee6ab158880f2852&amp;visitfrom=3P_Juejintail_0418&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejintail_0418" ref="nofollow noopener noreferrer">ç‚¹å‡»è¿›å…¥å®éªŒ</a>] æ„å»ºæ— é™, æ¢ç´¢å¯ç¨‹ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºUniappXå¼€å‘ç”µé”€APPï¼Œå®ç°é€šè¯å½•éŸ³ä¸Šä¼ ã€é€šæ—¶é€šæ¬¡]]></title>    <link>https://juejin.cn/post/7573528564025802798</link>    <guid>https://juejin.cn/post/7573528564025802798</guid>    <pubDate>2025-11-17T10:41:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573528564025802798" data-draft-id="7573508048141385737" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºUniappXå¼€å‘ç”µé”€APPï¼Œå®ç°é€šè¯å½•éŸ³ä¸Šä¼ ã€é€šæ—¶é€šæ¬¡"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-17T10:41:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çˆ±å¿ƒå‘ç”µä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/79577698543709"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºUniappXå¼€å‘ç”µé”€APPï¼Œå®ç°é€šè¯å½•éŸ³ä¸Šä¼ ã€é€šæ—¶é€šæ¬¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/79577698543709/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çˆ±å¿ƒå‘ç”µä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T10:41:45.000Z" title="Mon Nov 17 2025 10:41:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnicen.cn%2F8524.html" target="_blank" title="https://nicen.cn/8524.html" ref="nofollow noopener noreferrer">nicen.cn/8524.html</a></p>
<p>ä¹‹å‰é€šè¿‡Uniapp+Html5pluså®ç°è¿‡å®ç°é€šè¯å½•éŸ³ä¸Šä¼ çš„åŠŸèƒ½ï¼Œä¸€ç›´æœ‰ä¸€ä¸ªç—›ç‚¹ï¼šå½•éŸ³æ–‡ä»¶å¾ˆå¤šçš„æ—¶å€™é€šè¿‡htmlplusæ¥è·å–å½•éŸ³æ–‡ä»¶ä¼šå¾ˆå¡ã€‚</p>
<p>åˆšå¥½çœ‹åˆ°æ–°å‡ºçš„UniappXå¯ä»¥ç›´æ¥æŠŠç±»ä¼¼tsçš„utsä»£ç ç¼–è¯‘æˆåŸç”Ÿä»£ç ï¼Œè€Œä¸”æ•´ä¸ªå¼€å‘æµç¨‹éƒ½å¯ä»¥åœ¨Hbuilderå†…å®Œæˆï¼Œäºæ˜¯ä¹æ¥äº†å…´è¶£ï¼Œè¯•ä¸Šä¸€è¯•ï¼</p>
<h2 data-id="heading-0">å¼€å‘æ€è·¯</h2>
<p>æ—¢ç„¶å¯ä»¥é€šè¿‡utsæ¥å®ç°åŸç”Ÿå¼€å‘ï¼Œä½†æ˜¯åˆæƒ³ä¿æŒWebæ¥è¿›è¡ŒAPPçš„å‰ç«¯å¼€å‘ï¼Œé‚£å°±ç›´æ¥ç”¨è€ä¸€å¥—çš„æ··åˆå¼€å‘çš„æ–¹å¼ï¼šé€šè¿‡JSè°ƒç”¨å†™å¥½çš„åŸç”Ÿæ–¹æ³•ã€‚</p>
<p>ç›¸å…³ä»£ç å·²å¼€æºï¼ŒGithubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffriend-nicen%2Funicall" target="_blank" title="https://github.com/friend-nicen/unicall" ref="nofollow noopener noreferrer">github.com/friend-niceâ€¦</a></p>
<h3 data-id="heading-1">1.é€šè¿‡utså®ç°è¯»å–å½•éŸ³æ–‡ä»¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/* å°†åŠŸèƒ½å°è£…ä¸ºç±»ï¼šåœ¨æ„é€ å‡½æ•°ä¸­è®¾ç½® audioPath */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Scanner</span> {

    ....

<span class="hljs-comment">/* è¯»å–ç›®å½•ä¸‹æœ€æ–°çš„å½•éŸ³æ–‡ä»¶ */</span>
<span class="hljs-title function_">getLatestAudio</span>(option : <span class="hljs-title class_">QueryLatest</span>) : <span class="hljs-title class_">LatestAudioResult</span> {

    <span class="hljs-comment">/*  å®šä¹‰å½•éŸ³æ–‡ä»¶è·¯å¾„ */</span>
    <span class="hljs-keyword">if</span> (option.<span class="hljs-property">audioPath</span> != <span class="hljs-literal">null</span>) {
        option.<span class="hljs-property">audioPath</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sdRoot</span> + option.<span class="hljs-property">audioPath</span>;
        <span class="hljs-keyword">const</span> initDir = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(option.<span class="hljs-property">audioPath</span> <span class="hljs-keyword">as</span> string);
        <span class="hljs-keyword">if</span> (!initDir.<span class="hljs-title function_">exists</span>() || !!initDir.<span class="hljs-title function_">isDirectory</span>()) {
            option.<span class="hljs-property">audioPath</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDevicePath</span>();
        }
    } <span class="hljs-keyword">else</span> {
        option.<span class="hljs-property">audioPath</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDevicePath</span>();
    }

    <span class="hljs-comment">/* ç›®å½•å¯¹è±¡ */</span>
    <span class="hljs-keyword">const</span> dir = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(option.<span class="hljs-property">audioPath</span> <span class="hljs-keyword">as</span> string);

    <span class="hljs-keyword">if</span> (!dir.<span class="hljs-title function_">exists</span>() || !dir.<span class="hljs-title function_">isDirectory</span>()) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UniError</span>(<span class="hljs-string">'scanner'</span>, <span class="hljs-number">0</span>, <span class="hljs-string">'å½•éŸ³æ–‡ä»¶ç›®å½•ä¸å­˜åœ¨'</span>);
    }

    <span class="hljs-keyword">const</span> files = dir.<span class="hljs-title function_">listFiles</span>();
    <span class="hljs-keyword">if</span> (files == <span class="hljs-literal">null</span> || files.<span class="hljs-property">size</span> == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UniError</span>(<span class="hljs-string">'scanner'</span>, <span class="hljs-number">0</span>, <span class="hljs-string">'æœ¬æ¬¡é€šè¯æ²¡æœ‰äº§ç”Ÿå½•éŸ³æ–‡ä»¶'</span>);
    }

    <span class="hljs-keyword">let</span> latest : <span class="hljs-title class_">File</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">const</span> countInt : <span class="hljs-title class_">Int</span> = files.<span class="hljs-property">size</span>;
    <span class="hljs-keyword">const</span> count : number = countInt;
    option.<span class="hljs-property">latestTime</span> = option.<span class="hljs-property">latestTime</span> * <span class="hljs-number">1000</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i : <span class="hljs-title class_">Int</span> = <span class="hljs-number">0</span>; i &lt; countInt; i = i + <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">const</span> f = files[i];
        <span class="hljs-keyword">if</span> (f != <span class="hljs-literal">null</span> &amp;&amp; f.<span class="hljs-title function_">isFile</span>()) {
            <span class="hljs-keyword">const</span> lm = f.<span class="hljs-title function_">lastModified</span>();
            <span class="hljs-keyword">if</span> (lm &gt;= option.<span class="hljs-property">latestTime</span>) {
                latest = f;
                option.<span class="hljs-property">latestTime</span> = lm;
            }
        }
    }

    <span class="hljs-keyword">if</span> (latest != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">file</span>: latest.<span class="hljs-title function_">getAbsolutePath</span>(), <span class="hljs-attr">count</span>: count };
    }

    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UniError</span>(<span class="hljs-string">'scanner'</span>, <span class="hljs-number">0</span>, <span class="hljs-string">'æœ¬æ¬¡é€šè¯æ²¡æœ‰äº§ç”Ÿå½•éŸ³æ–‡ä»¶'</span>);
}

	....
}
</code></pre>
<p>ä»¥ä¸‹çœç•¥äº†è‹¥å¹²ä»£ç ï¼Œä»…å±•ç¤ºæ ¸å¿ƒä»£ç ï¼Œå®Œæ•´ä»£ç è¯·æŸ¥çœ‹ä¸Šæ–¹å¼€æºé¡¹ç›®</p>
<h3 data-id="heading-2">2.é€šè¿‡webviewå¯¹è±¡å‘jsæä¾›ç›´æ¥è°ƒç”¨çš„æ–¹æ³•</h3>
<p>é€šè¿‡ç›‘å¬webviewç»„ä»¶çš„messageäº‹ä»¶ï¼Œæ¥è·å–jså‘é€è¿‡æ¥çš„æ¶ˆæ¯ï¼Œç„¶åè¿›è¡Œå¯¹åº”çš„å¤„ç†ï¼Œæœ€åé€šè¿‡webviewå¯¹è±¡çš„evalJsæ–¹æ³•ï¼Œå°†ç»“æœå›è°ƒç»™å‰ç«¯ã€‚ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/* æ¶ˆæ¯ç›‘å¬ */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onPostMessage</span> = (<span class="hljs-params">e</span>) =&gt; {

  <span class="hljs-comment">/* æ•°æ® */</span>
  <span class="hljs-keyword">const</span> _list = e.<span class="hljs-property">detail</span>.<span class="hljs-property">data</span>;
  <span class="hljs-keyword">const</span> _action = _list[<span class="hljs-number">0</span>].<span class="hljs-property">action</span>;
  <span class="hljs-keyword">const</span> _data = _list[<span class="hljs-number">0</span>].<span class="hljs-property">data</span>;


  <span class="hljs-comment">/* åˆå§‹åŒ– */</span>
  <span class="hljs-keyword">if</span> (!_wv) {

    <span class="hljs-comment">/* è·å–webviewå¯¹è±¡ */</span>
    <span class="hljs-keyword">const</span> _wvs = plus.<span class="hljs-property">webview</span>.<span class="hljs-title function_">getDisplayWebview</span>().<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">wv</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> wv.<span class="hljs-title function_">getURL</span>().<span class="hljs-title function_">indexOf</span>(host) &gt; -<span class="hljs-number">1</span>;
    });

    <span class="hljs-comment">/* å¼¹å‡ºå¼‚å¸¸ */</span>
    <span class="hljs-keyword">if</span> (!_wvs.<span class="hljs-property">length</span>) {
      load.<span class="hljs-title function_">toast</span>(<span class="hljs-string">"æœåŠ¡å¼‚å¸¸"</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">/* webviewå¯¹è±¡ */</span>
    _wv = _wvs[<span class="hljs-number">0</span>];
    _wv.<span class="hljs-property">onCall</span> = <span class="hljs-function">(<span class="hljs-params">action, success, payload</span>) =&gt;</span> {
      _wv.evalJS(<span class="hljs-string">'window.__onCall(`'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
        action,
        success,
        payload
      }) + <span class="hljs-string">'`)'</span>);
    }
  }

  <span class="hljs-comment">/* åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§ */</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (!!scanner[_action]) {
      _wv.<span class="hljs-title function_">onCall</span>(_action, <span class="hljs-literal">true</span>, scanner[_action](_data));
    }
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">const</span> match = e.<span class="hljs-property">message</span>.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/errMsg='([^']+)'/</span>);
    _wv.<span class="hljs-title function_">onCall</span>(_action, <span class="hljs-literal">false</span>, match &amp;&amp; match[<span class="hljs-number">1</span>] ? match[<span class="hljs-number">1</span>] : <span class="hljs-string">'ç³»ç»Ÿå¼‚å¸¸'</span>);
  }


}
</code></pre>
<h3 data-id="heading-3">3.å‰ç«¯JSå°è£…å’ŒAPPé€šä¿¡çš„æ–¹æ³•</h3>
<p>é€šè¿‡ä¸‹æ–¹å°è£…çš„æ¨¡å—ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡awaitåŒæ­¥è°ƒç”¨APPå¯¹åº”çš„æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * NativeBridge.es6.js
 * ES Moduleï¼Œaction çº§å›è°ƒï¼Œé»˜è®¤ 15 s è¶…æ—¶
 * import { invoke } from './NativeBridge.es6.js';
 * await invoke({ action:'getDeviceId', timeout:10_000 });
 */</span>
<span class="hljs-keyword">const</span> pool = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);   <span class="hljs-comment">// action -&gt; {resolve, reject, timer}</span>

<span class="hljs-comment">/**
 * App å›ä¼ ç»“æœçš„å”¯ä¸€å…¨å±€é’©å­
 * è°ƒç”¨æ–¹å¼ï¼ˆAndroidï¼‰ï¼š
 * webView.evaluateJavascript('window.__onCall('{"action":"getDeviceId","success":true,"payload":"fake-123"}')', null);
 * payload å¯çœç•¥ã€‚
 */</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">__onCall</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">json</span>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> {action, success, payload} = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(json);
        <span class="hljs-comment">/* æ ¼å¼éæ³•ï¼Œç›´æ¥ä¸¢å¼ƒ */</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> action !== <span class="hljs-string">'string'</span>) <span class="hljs-keyword">return</span>;

        <span class="hljs-keyword">const</span> item = pool[action];
        <span class="hljs-comment">/* å·²è¶…æ—¶æˆ–é‡å¤å›è°ƒ */</span>
        <span class="hljs-keyword">if</span> (!item) <span class="hljs-keyword">return</span>;

        <span class="hljs-keyword">const</span> {resolve, reject, timer} = item;
        <span class="hljs-built_in">clearTimeout</span>(timer);
        <span class="hljs-keyword">delete</span> pool[action];

        success ? <span class="hljs-title function_">resolve</span>(payload) : <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(payload ?? <span class="hljs-string">'native error'</span>));
    } <span class="hljs-keyword">catch</span> {
        <span class="hljs-comment">/* éåˆæ³• JSONï¼Œç›´æ¥å¿½ç•¥ */</span>
    }
};

<span class="hljs-comment">/**
 * è°ƒç”¨ App å†…éƒ¨æ–¹æ³•
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">opt</span>
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} opt.action   - å¿…å¡«ï¼Œæ–¹æ³•å
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>}    [opt.params] - é€‰å¡«ï¼Œå‚æ•°ï¼Œé»˜è®¤ç©ºå¯¹è±¡
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} [opt.timeout=15000] - é€‰å¡«ï¼Œè¶…æ—¶æ¯«ç§’
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;any&gt;</span>}
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">invoke</span>(<span class="hljs-params">opt = {}</span>) {

    <span class="hljs-comment">/* é»˜è®¤é…ç½® */</span>
    <span class="hljs-keyword">const</span> {action, data = {}, timeout = <span class="hljs-number">15000</span>} = opt;

    <span class="hljs-comment">/* å‚æ•°æ ¡éªŒ */</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> action !== <span class="hljs-string">'string'</span> || !action)
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'action is required'</span>));

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {

        <span class="hljs-comment">/* å¦‚æœå·²å­˜åœ¨åŒ action çš„æœªå®Œæˆè°ƒç”¨ï¼Œå…ˆæ¸…æ‰ */</span>
        <span class="hljs-keyword">if</span> (pool[action]) {
            <span class="hljs-built_in">clearTimeout</span>(pool[action].<span class="hljs-property">timer</span>);
            pool[action].<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'covered by new call'</span>));
        }

        <span class="hljs-comment">/* è¶…æ—¶å™¨ï¼Œé˜²æ­¢è°ƒç”¨è¶…æ—¶ */</span>
        <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">delete</span> pool[action];
            <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`invoke <span class="hljs-subst">${action}</span> timeout`</span>));
        }, timeout);

        <span class="hljs-comment">/* å›è°ƒ */</span>
        pool[action] = {resolve, reject, timer};

        <span class="hljs-comment">/* å‘é€æ¶ˆæ¯ */</span>
        uni.<span class="hljs-title function_">postMessage</span>({
            <span class="hljs-attr">data</span>: {
                action,
                <span class="hljs-attr">data</span>: data
            }
        });

    });
}
</code></pre>
<h3 data-id="heading-4">4.ç›¸å…³æ‰©å±•</h3>
<p>ä¸Šæ–¹å±•ç¤ºäº†ä¸€ä¸ªé€šè¿‡UniappXç®€å•å®ç°çš„æ··åˆå¼€å‘çš„æ¡†æ¶ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå¯ä»¥å®ç°æ›´å¤šçš„åŸç”Ÿæ–¹æ³•æ¥æ‰©å±•åŠŸèƒ½ï¼ŒåŒæ—¶å…¼é¡¾æ€§èƒ½å’ŒWebå¼€å‘çš„ä¾¿æ·ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ThreadLocalåº•å±‚å®ç°åŸç†æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7573506713866600499</link>    <guid>https://juejin.cn/post/7573506713866600499</guid>    <pubDate>2025-11-17T10:53:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573506713866600499" data-draft-id="7573508048141418505" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ThreadLocalåº•å±‚å®ç°åŸç†æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2025-11-17T10:53:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·683335666080"/> <meta itemprop="url" content="https://juejin.cn/user/4418313847836760"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ThreadLocalåº•å±‚å®ç°åŸç†æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4418313847836760/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·683335666080
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T10:53:40.000Z" title="Mon Nov 17 2025 10:53:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒé—®é¢˜ï¼šä¸ºä»€ä¹ˆMDC.putä¼šä¸ºçº¿ç¨‹åˆ›å»ºThreadLocalï¼Ÿ</h2>
<h3 data-id="heading-1">1.1 é—®é¢˜çš„æœ¬è´¨</h3>
<p>å½“æˆ‘ä»¬è°ƒç”¨ <code>MDC.put("tid", "abc123")</code> æ—¶ï¼Œåº•å±‚å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æˆ‘ä»¬çœ‹åˆ°çš„ä»£ç </span>
MDC.put(<span class="hljs-string">"tid"</span>, <span class="hljs-string">"abc123"</span>);

<span class="hljs-comment">// åº•å±‚å®é™…æ‰§è¡Œ</span>
ThreadLocal&lt;Map&lt;String, String&gt;&gt; contextMap = ...;
contextMap.set(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;());  <span class="hljs-comment">// ä¸ºå½“å‰çº¿ç¨‹åˆ›å»ºThreadLocal</span>
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼šThreadLocalæœ¬èº«ä¸å­˜å‚¨æ•°æ®ï¼Œæ•°æ®å­˜å‚¨åœ¨<strong>Threadå¯¹è±¡</strong>ä¸­ï¼</p>
<h2 data-id="heading-2">äºŒã€ThreadLocalçš„åº•å±‚æ•°æ®ç»“æ„</h2>
<h3 data-id="heading-3">2.1 Threadå¯¹è±¡å†…éƒ¨ç»“æ„</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Threadç±»çš„ç®€åŒ–ç»“æ„ï¼ˆJDKæºç ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Thread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> {
    <span class="hljs-comment">// æ¯ä¸ªThreadå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªThreadLocalMap</span>
    ThreadLocal.<span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">threadLocals</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// ç”¨äºInheritableThreadLocalï¼ˆå¯ç»§æ‰¿çš„ThreadLocalï¼‰</span>
    ThreadLocal.<span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">inheritableThreadLocals</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<p><strong>å…³é”®ç†è§£</strong>ï¼š</p>
<ul>
<li>ThreadLocalMap ä¸æ˜¯å­˜å‚¨åœ¨ ThreadLocal ä¸­ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨ <strong>Thread å¯¹è±¡</strong>ä¸­</li>
<li>æ¯ä¸ª Thread å¯¹è±¡éƒ½æœ‰è‡ªå·±çš„ ThreadLocalMap</li>
<li>ThreadLocal åªæ˜¯ä¸€ä¸ª"é’¥åŒ™"ï¼Œç”¨æ¥è®¿é—® Thread å¯¹è±¡ä¸­çš„ Map</li>
</ul>
<h3 data-id="heading-4">2.2 ThreadLocalMapçš„å†…éƒ¨ç»“æ„</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ThreadLocalMapçš„ç®€åŒ–å®ç°</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocalMap</span> {
    <span class="hljs-comment">// å†…éƒ¨ä½¿ç”¨Entryæ•°ç»„å­˜å‚¨ï¼Œç±»ä¼¼HashMap</span>
    <span class="hljs-keyword">private</span> Entry[] table;
    
    <span class="hljs-comment">// Entryæ˜¯å¼±å¼•ç”¨ï¼Œkeyæ˜¯ThreadLocalå®ä¾‹ï¼Œvalueæ˜¯å®é™…å­˜å‚¨çš„å€¼</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WeakReference</span>&lt;ThreadLocal&lt;?&gt;&gt; {
        Object value;  <span class="hljs-comment">// å®é™…å­˜å‚¨çš„å€¼</span>
        
        Entry(ThreadLocal&lt;?&gt; k, Object v) {
            <span class="hljs-built_in">super</span>(k);  <span class="hljs-comment">// ThreadLocalä½œä¸ºkeyï¼Œä½¿ç”¨å¼±å¼•ç”¨</span>
            value = v;  <span class="hljs-comment">// å®é™…å€¼</span>
        }
    }
}
</code></pre>
<p><strong>å†…å­˜ç»“æ„å›¾</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Threadå¯¹è±¡ (Thread-1)
  â””â”€ threadLocals: ThreadLocalMap
      â””â”€ table: Entry<span class="hljs-section">[]</span>
          â”œâ”€ Entry<span class="hljs-section">[0]</span>: <span class="hljs-attr">key</span>=MDCçš„ThreadLocalå®ä¾‹(å¼±å¼•ç”¨), value=Map{<span class="hljs-string">"tid"</span>: <span class="hljs-string">"abc123"</span>}
          â”œâ”€ Entry<span class="hljs-section">[1]</span>: <span class="hljs-attr">key</span>=å…¶ä»–ThreadLocalå®ä¾‹(å¼±å¼•ç”¨), value=å…¶ä»–å€¼
          â””â”€ Entry<span class="hljs-section">[2]</span>: null
</code></pre>
<h2 data-id="heading-5">ä¸‰ã€MDC.putçš„å®Œæ•´æ‰§è¡Œè¿‡ç¨‹</h2>
<h3 data-id="heading-6">3.1 ä»£ç è¿½è¸ª</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ========== ç¬¬1æ­¥ï¼šè°ƒç”¨MDC.put ==========</span>
MDC.put(<span class="hljs-string">"tid"</span>, <span class="hljs-string">"abc123"</span>);

<span class="hljs-comment">// ========== ç¬¬2æ­¥ï¼šMDCå†…éƒ¨å®ç° ==========</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MDC</span> {
    <span class="hljs-comment">// MDCå†…éƒ¨æœ‰ä¸€ä¸ªé™æ€çš„ThreadLocalå®ä¾‹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ThreadLocal&lt;Map&lt;String, String&gt;&gt; contextMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(String key, String value)</span> {
        <span class="hljs-comment">// 2.1 è·å–å½“å‰çº¿ç¨‹çš„Map</span>
        Map&lt;String, String&gt; map = contextMap.get();
        <span class="hljs-comment">// è¿™é‡Œä¼šè§¦å‘ThreadLocal.get()æ–¹æ³•</span>
        
        <span class="hljs-comment">// 2.2 å¦‚æœMapä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°Map</span>
        <span class="hljs-keyword">if</span> (map == <span class="hljs-literal">null</span>) {
            map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            contextMap.set(map);  <span class="hljs-comment">// è¿™é‡Œä¼šè§¦å‘ThreadLocal.set()æ–¹æ³•</span>
        }
        
        <span class="hljs-comment">// 2.3 å­˜å‚¨key-value</span>
        map.put(key, value);
    }
}
</code></pre>
<h3 data-id="heading-7">3.2 ThreadLocal.get()çš„åº•å±‚å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ThreadLocal.get()çš„å®Œæ•´å®ç°ï¼ˆJDKæºç ç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// 1. è·å–å½“å‰çº¿ç¨‹å¯¹è±¡</span>
    <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();
    
    <span class="hljs-comment">// 2. è·å–çº¿ç¨‹å¯¹è±¡ä¸­çš„ThreadLocalMap</span>
    <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);
    <span class="hljs-comment">// getMap(t) å®é™…å°±æ˜¯: return t.threadLocals;</span>
    
    <span class="hljs-comment">// 3. å¦‚æœMapå­˜åœ¨ï¼Œä»Mapä¸­è·å–å€¼</span>
    <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// 3.1 ä»¥å½“å‰ThreadLocalå®ä¾‹ä¸ºkeyï¼ŒæŸ¥æ‰¾Entry</span>
        ThreadLocalMap.<span class="hljs-type">Entry</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> map.getEntry(<span class="hljs-built_in">this</span>);
        <span class="hljs-comment">// this æ˜¯ MDCçš„ThreadLocalå®ä¾‹</span>
        
        <span class="hljs-comment">// 3.2 å¦‚æœæ‰¾åˆ°Entryï¼Œè¿”å›value</span>
        <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) {
            <span class="hljs-type">T</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> (T)e.value;
            <span class="hljs-keyword">return</span> result;
        }
    }
    
    <span class="hljs-comment">// 4. å¦‚æœMapä¸å­˜åœ¨æˆ–æ‰¾ä¸åˆ°Entryï¼Œè¿”å›null</span>
    <span class="hljs-keyword">return</span> setInitialValue();
}
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹å›¾</strong>ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">MDC.put(<span class="hljs-string">"tid"</span>, <span class="hljs-string">"abc123"</span>)
  â†“
contextMap.<span class="hljs-keyword">get</span>()
  â†“
Thread.currentThread()  â†’ è·å–å½“å‰çº¿ç¨‹å¯¹è±¡
  â†“
t.threadLocals  â†’ è·å–çº¿ç¨‹çš„ThreadLocalMap
  â†“
å¦‚æœthreadLocals == <span class="hljs-literal">null</span>
  â†“
è¿”å›<span class="hljs-literal">null</span>ï¼ˆç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼‰
  â†“
contextMap.<span class="hljs-keyword">set</span>(<span class="hljs-keyword">new</span> HashMap&lt;&gt;())
</code></pre>
<h3 data-id="heading-8">3.3 ThreadLocal.set()çš„åº•å±‚å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ThreadLocal.set()çš„å®Œæ•´å®ç°ï¼ˆJDKæºç ç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">set</span><span class="hljs-params">(T value)</span> {
    <span class="hljs-comment">// 1. è·å–å½“å‰çº¿ç¨‹å¯¹è±¡</span>
    <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();
    
    <span class="hljs-comment">// 2. è·å–çº¿ç¨‹å¯¹è±¡ä¸­çš„ThreadLocalMap</span>
    <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);
    <span class="hljs-comment">// getMap(t) å®é™…å°±æ˜¯: return t.threadLocals;</span>
    
    <span class="hljs-comment">// 3. å¦‚æœMapå­˜åœ¨ï¼Œç›´æ¥è®¾ç½®å€¼</span>
    <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) {
        map.set(<span class="hljs-built_in">this</span>, value);
        <span class="hljs-comment">// this æ˜¯ MDCçš„ThreadLocalå®ä¾‹</span>
        <span class="hljs-comment">// value æ˜¯ new HashMap&lt;&gt;()</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// 4. å¦‚æœMapä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„ThreadLocalMap</span>
        createMap(t, value);
        <span class="hljs-comment">// createMap(t, value) å®é™…å°±æ˜¯:</span>
        <span class="hljs-comment">//     t.threadLocals = new ThreadLocalMap(this, value);</span>
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>createMap(t, value)</code> ä¼šåˆ›å»ºæ–°çš„ ThreadLocalMap å¹¶èµ‹å€¼ç»™ <code>t.threadLocals</code></li>
<li>è¿™å°±æ˜¯"ä¸ºçº¿ç¨‹åˆ›å»ºThreadLocal"çš„æœ¬è´¨ï¼š<strong>åœ¨Threadå¯¹è±¡ä¸­åˆ›å»ºThreadLocalMap</strong></li>
</ul>
<h3 data-id="heading-9">3.4 createMapçš„è¯¦ç»†è¿‡ç¨‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ThreadLocal.createMap()çš„å®ç°</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">createMap</span><span class="hljs-params">(Thread t, T firstValue)</span> {
    <span class="hljs-comment">// åˆ›å»ºæ–°çš„ThreadLocalMapï¼Œå¹¶èµ‹å€¼ç»™çº¿ç¨‹çš„threadLocalså­—æ®µ</span>
    t.threadLocals = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocalMap</span>(<span class="hljs-built_in">this</span>, firstValue);
    <span class="hljs-comment">// this æ˜¯ MDCçš„ThreadLocalå®ä¾‹</span>
    <span class="hljs-comment">// firstValue æ˜¯ new HashMap&lt;&gt;()</span>
}

<span class="hljs-comment">// ThreadLocalMapçš„æ„é€ å‡½æ•°</span>
ThreadLocalMap(ThreadLocal&lt;?&gt; firstKey, Object firstValue) {
    <span class="hljs-comment">// 1. åˆ›å»ºEntryæ•°ç»„ï¼ˆåˆå§‹å®¹é‡16ï¼‰</span>
    table = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Entry</span>[INITIAL_CAPACITY];
    
    <span class="hljs-comment">// 2. è®¡ç®—ThreadLocalå®ä¾‹çš„hashå€¼ï¼Œç¡®å®šåœ¨æ•°ç»„ä¸­çš„ä½ç½®</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> firstKey.threadLocalHashCode &amp; (INITIAL_CAPACITY - <span class="hljs-number">1</span>);
    
    <span class="hljs-comment">// 3. åˆ›å»ºEntryå¹¶å­˜å‚¨åˆ°æ•°ç»„ä¸­</span>
    table[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Entry</span>(firstKey, firstValue);
    <span class="hljs-comment">// Entryå­˜å‚¨ï¼š</span>
    <span class="hljs-comment">//   - key: MDCçš„ThreadLocalå®ä¾‹ï¼ˆå¼±å¼•ç”¨ï¼‰</span>
    <span class="hljs-comment">//   - value: new HashMap&lt;&gt;()</span>
    
    size = <span class="hljs-number">1</span>;
}
</code></pre>
<h2 data-id="heading-10">å››ã€å®Œæ•´çš„å†…å­˜æ¨¡å‹</h2>
<h3 data-id="heading-11">4.1 ç¬¬ä¸€æ¬¡è°ƒç”¨MDC.putæ—¶çš„å†…å­˜çŠ¶æ€</h3>
<pre><code class="hljs language-csharp" lang="csharp">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰§è¡Œå‰ï¼š                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚ Thread<span class="hljs-number">-1</span>å¯¹è±¡                                                      â”‚
â”‚   â””â”€ threadLocals: <span class="hljs-literal">null</span>  â† è¿˜æ²¡æœ‰ThreadLocalMap                 â”‚
â”‚                                                                   â”‚
â”‚ MDCç±»ï¼ˆé™æ€ï¼‰                                                     â”‚
â”‚   â””â”€ contextMap: ThreadLocalå®ä¾‹ï¼ˆæ‰€æœ‰çº¿ç¨‹å…±äº«è¿™ä¸ªå®ä¾‹ï¼‰          â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰§è¡Œ: MDC.put(<span class="hljs-string">"tid"</span>, <span class="hljs-string">"abc123"</span>)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚ ç¬¬<span class="hljs-number">1</span>æ­¥: contextMap.<span class="hljs-keyword">get</span>()                                          â”‚
â”‚   â”œâ”€ Thread.currentThread() â†’ Thread<span class="hljs-number">-1</span>å¯¹è±¡                       â”‚
â”‚   â”œâ”€ Thread<span class="hljs-number">-1.</span>threadLocals â†’ <span class="hljs-literal">null</span>                              â”‚
â”‚   â””â”€ è¿”å›<span class="hljs-literal">null</span>                                                    â”‚
â”‚                                                                   â”‚
â”‚ ç¬¬<span class="hljs-number">2</span>æ­¥: contextMap.<span class="hljs-keyword">set</span>(<span class="hljs-keyword">new</span> HashMap&lt;&gt;())                           â”‚
â”‚   â”œâ”€ Thread.currentThread() â†’ Thread<span class="hljs-number">-1</span>å¯¹è±¡                       â”‚
â”‚   â”œâ”€ Thread<span class="hljs-number">-1.</span>threadLocals â†’ <span class="hljs-literal">null</span>ï¼ˆä¸å­˜åœ¨ï¼‰                     â”‚
â”‚   â”œâ”€ createMap(Thread<span class="hljs-number">-1</span>, <span class="hljs-keyword">new</span> HashMap&lt;&gt;())                       â”‚
â”‚   â”‚   â””â”€ Thread<span class="hljs-number">-1.</span>threadLocals = <span class="hljs-keyword">new</span> ThreadLocalMap(...)       â”‚
â”‚   â”‚       â””â”€ table[<span class="hljs-number">0</span>] = Entry(MDCçš„ThreadLocalå®ä¾‹, HashMap)    â”‚
â”‚   â””â”€ ç°åœ¨Thread<span class="hljs-number">-1</span>æœ‰äº†ThreadLocalMap                             â”‚
â”‚                                                                   â”‚
â”‚ ç¬¬<span class="hljs-number">3</span>æ­¥: map.put(<span class="hljs-string">"tid"</span>, <span class="hljs-string">"abc123"</span>)                                 â”‚
â”‚   â””â”€ åœ¨HashMapä¸­å­˜å‚¨key-<span class="hljs-keyword">value</span>                                    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰§è¡Œåï¼š                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚ Thread<span class="hljs-number">-1</span>å¯¹è±¡                                                      â”‚
â”‚   â””â”€ threadLocals: ThreadLocalMap                                â”‚
â”‚       â””â”€ table: Entry[]                                          â”‚
â”‚           â””â”€ Entry[<span class="hljs-number">0</span>]:                                           â”‚
â”‚               â”œâ”€ key: MDCçš„ThreadLocalå®ä¾‹ï¼ˆå¼±å¼•ç”¨ï¼‰             â”‚
â”‚               â””â”€ <span class="hljs-keyword">value</span>: HashMap{<span class="hljs-string">"tid"</span>: <span class="hljs-string">"abc123"</span>}                 â”‚
â”‚                                                                   â”‚
â”‚ Thread<span class="hljs-number">-2</span>å¯¹è±¡ï¼ˆå¦ä¸€ä¸ªçº¿ç¨‹ï¼‰                                       â”‚
â”‚   â””â”€ threadLocals: <span class="hljs-literal">null</span>  â† è¿˜æ²¡æœ‰è°ƒç”¨MDC.put                    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-12">4.2 ç¬¬äºŒæ¬¡è°ƒç”¨MDC.putæ—¶çš„å†…å­˜çŠ¶æ€</h3>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰§è¡Œ: MDC.<span class="hljs-built_in">put</span>(<span class="hljs-string">"EagleEye-TraceID"</span>, <span class="hljs-string">"abc123"</span>)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚ ç¬¬<span class="hljs-number">1</span>æ­¥: contextMap.<span class="hljs-built_in">get</span>()                                          â”‚
â”‚   â”œâ”€ Thread.<span class="hljs-built_in">currentThread</span>() â†’ Thread-<span class="hljs-number">1</span>å¯¹è±¡                       â”‚
â”‚   â”œâ”€ Thread-<span class="hljs-number">1</span>.threadLocals â†’ ThreadLocalMapï¼ˆå·²å­˜åœ¨ï¼‰            â”‚
â”‚   â”œâ”€ map.<span class="hljs-built_in">getEntry</span>(MDCçš„ThreadLocalå®ä¾‹)                         â”‚
â”‚   â”‚   â””â”€ åœ¨tableä¸­æ‰¾åˆ°Entry[<span class="hljs-number">0</span>]                                  â”‚
â”‚   â””â”€ è¿”å›: HashMap{"tid": <span class="hljs-string">"abc123"</span>}                             â”‚
â”‚                                                                   â”‚
â”‚ ç¬¬<span class="hljs-number">2</span>æ­¥: map.<span class="hljs-built_in">put</span>(<span class="hljs-string">"EagleEye-TraceID"</span>, <span class="hljs-string">"abc123"</span>)                    â”‚
â”‚   â””â”€ åœ¨å·²æœ‰çš„HashMapä¸­æ·»åŠ æ–°çš„key-value                          â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰§è¡Œåï¼š                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚ Thread-<span class="hljs-number">1</span>å¯¹è±¡                                                      â”‚
â”‚   â””â”€ threadLocals: ThreadLocalMapï¼ˆåŒä¸€ä¸ªMapï¼‰                   â”‚
â”‚       â””â”€ table: Entry[]                                          â”‚
â”‚           â””â”€ Entry[<span class="hljs-number">0</span>]:                                           â”‚
â”‚               â”œâ”€ key: MDCçš„ThreadLocalå®ä¾‹ï¼ˆå¼±å¼•ç”¨ï¼‰             â”‚
â”‚               â””â”€ value: HashMap{                                 â”‚
â”‚                     "tid": <span class="hljs-string">"abc123"</span>,                             â”‚
â”‚                     <span class="hljs-string">"EagleEye-TraceID"</span>: <span class="hljs-string">"abc123"</span>                 â”‚
â”‚                   }                                               â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 data-id="heading-13">äº”ã€ThreadLocalMapçš„å“ˆå¸Œç®—æ³•</h2>
<h3 data-id="heading-14">5.1 ä¸ºä»€ä¹ˆä½¿ç”¨æ•°ç»„è€Œä¸æ˜¯HashMapï¼Ÿ</h3>
<p><strong>ThreadLocalMapä½¿ç”¨æ•°ç»„+å¼€æ”¾åœ°å€æ³•</strong>ï¼Œè€Œä¸æ˜¯HashMapçš„æ•°ç»„+é“¾è¡¨/çº¢é»‘æ ‘ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ThreadLocalMapçš„å“ˆå¸Œç®—æ³•</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getIndex</span><span class="hljs-params">(ThreadLocal&lt;?&gt; key)</span> {
    <span class="hljs-comment">// 1. è·å–ThreadLocalå®ä¾‹çš„hashCode</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">hashCode</span> <span class="hljs-operator">=</span> key.threadLocalHashCode;
    
    <span class="hljs-comment">// 2. è®¡ç®—æ•°ç»„ç´¢å¼•ï¼ˆå–æ¨¡è¿ç®—ï¼‰</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> hashCode &amp; (table.length - <span class="hljs-number">1</span>);
    <span class="hljs-comment">// ç­‰ä»·äº: index = hashCode % table.length</span>
    <span class="hljs-comment">// ä½†ä½è¿ç®—æ›´å¿«</span>
    
    <span class="hljs-keyword">return</span> index;
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨å¼€æ”¾åœ°å€æ³•ï¼Ÿ</strong></p>
<ul>
<li>ThreadLocalçš„æ•°é‡é€šå¸¸å¾ˆå°‘ï¼ˆæ¯ä¸ªçº¿ç¨‹å¯èƒ½åªæœ‰å‡ ä¸ªThreadLocalï¼‰</li>
<li>å¼€æ”¾åœ°å€æ³•åœ¨æ•°æ®é‡å°æ—¶æ€§èƒ½æ›´å¥½ï¼Œå†…å­˜å ç”¨æ›´å°‘</li>
<li>é¿å…é“¾è¡¨/çº¢é»‘æ ‘çš„é¢å¤–å†…å­˜å¼€é”€</li>
</ul>
<h3 data-id="heading-15">5.2 ThreadLocalçš„hashCodeç”Ÿæˆ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ThreadLocalç±»ä¸­</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocal</span>&lt;T&gt; {
    <span class="hljs-comment">// æ¯ä¸ªThreadLocalå®ä¾‹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„hashCode</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">threadLocalHashCode</span> <span class="hljs-operator">=</span> nextHashCode();
    
    <span class="hljs-comment">// é™æ€è®¡æ•°å™¨ï¼Œæ¯æ¬¡åˆ›å»ºThreadLocalå®ä¾‹æ—¶é€’å¢</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">nextHashCode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>();
    
    <span class="hljs-comment">// æ¯æ¬¡é€’å¢çš„å€¼ï¼ˆé»„é‡‘æ¯”ä¾‹ç›¸å…³ï¼Œç”¨äºæ›´å¥½çš„å“ˆå¸Œåˆ†å¸ƒï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">HASH_INCREMENT</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x61c88647</span>;
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">nextHashCode</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> nextHashCode.getAndAdd(HASH_INCREMENT);
    }
}
</code></pre>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆ›å»ºç¬¬ä¸€ä¸ªThreadLocal</span>
ThreadLocal&lt;Map&gt; contextMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
<span class="hljs-comment">// threadLocalHashCode = 0</span>

<span class="hljs-comment">// åˆ›å»ºç¬¬äºŒä¸ªThreadLocal</span>
ThreadLocal&lt;String&gt; otherMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
<span class="hljs-comment">// threadLocalHashCode = 0x61c88647</span>

<span class="hljs-comment">// åˆ›å»ºç¬¬ä¸‰ä¸ªThreadLocal</span>
ThreadLocal&lt;Integer&gt; anotherMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
<span class="hljs-comment">// threadLocalHashCode = 0x61c88647 * 2</span>
</code></pre>
<h2 data-id="heading-16">å…­ã€å¼±å¼•ç”¨çš„ä½œç”¨</h2>
<h3 data-id="heading-17">6.1 Entryä½¿ç”¨å¼±å¼•ç”¨çš„åŸå› </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WeakReference</span>&lt;ThreadLocal&lt;?&gt;&gt; {
    Object value;
    
    Entry(ThreadLocal&lt;?&gt; k, Object v) {
        <span class="hljs-built_in">super</span>(k);  <span class="hljs-comment">// ThreadLocalä½œä¸ºkeyï¼Œä½¿ç”¨å¼±å¼•ç”¨</span>
        value = v;
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆkeyä½¿ç”¨å¼±å¼•ç”¨ï¼Ÿ</strong></p>
<p><strong>é—®é¢˜åœºæ™¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¦‚æœkeyä½¿ç”¨å¼ºå¼•ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
    ThreadLocal&lt;Map&gt; local = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    local.set(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;());
    <span class="hljs-comment">// localå˜é‡è¶…å‡ºä½œç”¨åŸŸï¼Œä½†ThreadLocalMapä¸­çš„Entryä»ç„¶æŒæœ‰å¼ºå¼•ç”¨</span>
    <span class="hljs-comment">// ThreadLocalå¯¹è±¡æ— æ³•è¢«GCå›æ”¶ â†’ å†…å­˜æ³„æ¼</span>
}

<span class="hljs-comment">// å¦‚æœkeyä½¿ç”¨å¼±å¼•ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
    ThreadLocal&lt;Map&gt; local = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    local.set(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;());
    <span class="hljs-comment">// localå˜é‡è¶…å‡ºä½œç”¨åŸŸ</span>
    <span class="hljs-comment">// ThreadLocalå¯¹è±¡å¯ä»¥è¢«GCå›æ”¶ï¼ˆå› ä¸ºåªæœ‰å¼±å¼•ç”¨ï¼‰</span>
    <span class="hljs-comment">// ä½†valueä»ç„¶å­˜åœ¨ â†’ éœ€è¦æ‰‹åŠ¨æ¸…ç†</span>
}
</code></pre>
<p><strong>å†…å­˜æ³„æ¼é£é™©</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">Thread-<span class="hljs-number">1</span><span class="hljs-selector-class">.threadLocals</span>
  â””â”€ Entry<span class="hljs-selector-attr">[0]</span>:
      â”œâ”€ key: ThreadLocalå®ä¾‹ï¼ˆå¼±å¼•ç”¨ï¼‰â† å¯ä»¥è¢«GCå›æ”¶
      â””â”€ value: HashMapï¼ˆå¼ºå¼•ç”¨ï¼‰â† å¦‚æœThreadLocalè¢«å›æ”¶ï¼Œè¿™ä¸ªvalueå°±<span class="hljs-string">"æ³„æ¼"</span>äº†
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ThreadLocalMapåœ¨get/setæ—¶ä¼šæ¸…ç†keyä¸ºnullçš„Entryï¼ˆstale entriesï¼‰</li>
<li>ä½†æœ€å¥½çš„åšæ³•æ˜¯ï¼š<strong>ä½¿ç”¨å®Œåè°ƒç”¨remove()æˆ–clear()</strong></li>
</ul>
<h2 data-id="heading-18">ä¸ƒã€å®Œæ•´æ‰§è¡Œæµç¨‹ç¤ºä¾‹</h2>
<h3 data-id="heading-19">7.1 ç¬¬ä¸€æ¬¡è°ƒç”¨MDC.putçš„å®Œæ•´è¿‡ç¨‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ========== ä»£ç è°ƒç”¨ ==========</span>
MDC.put(<span class="hljs-string">"tid"</span>, <span class="hljs-string">"abc123"</span>);

<span class="hljs-comment">// ========== ç¬¬1æ­¥ï¼šMDC.put()æ–¹æ³• ==========</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(String key, String value)</span> {
    Map&lt;String, String&gt; map = contextMap.get();
    <span class="hljs-comment">// è°ƒç”¨ThreadLocal.get()</span>
}

<span class="hljs-comment">// ========== ç¬¬2æ­¥ï¼šThreadLocal.get() ==========</span>
<span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">()</span> {
    <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-comment">// t = Thread-http-nio-8001-exec-1å¯¹è±¡</span>
    
    <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);
    <span class="hljs-comment">// getMap(t) = t.threadLocals</span>
    <span class="hljs-comment">// æ­¤æ—¶ t.threadLocals = nullï¼ˆç¬¬ä¸€æ¬¡è°ƒç”¨ï¼‰</span>
    
    <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// ä¸æ‰§è¡Œï¼ˆmapä¸ºnullï¼‰</span>
    }
    
    <span class="hljs-keyword">return</span> setInitialValue();
    <span class="hljs-comment">// è°ƒç”¨setInitialValue()</span>
}

<span class="hljs-comment">// ========== ç¬¬3æ­¥ï¼šThreadLocal.setInitialValue() ==========</span>
<span class="hljs-keyword">private</span> T <span class="hljs-title function_">setInitialValue</span><span class="hljs-params">()</span> {
    <span class="hljs-type">T</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> initialValue();
    <span class="hljs-comment">// initialValue()è¿”å›nullï¼ˆThreadLocalçš„é»˜è®¤å®ç°ï¼‰</span>
    
    <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);
    <span class="hljs-comment">// map = null</span>
    
    <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// ä¸æ‰§è¡Œ</span>
    } <span class="hljs-keyword">else</span> {
        createMap(t, value);
        <span class="hljs-comment">// åˆ›å»ºThreadLocalMap</span>
    }
    
    <span class="hljs-keyword">return</span> value;  <span class="hljs-comment">// è¿”å›null</span>
}

<span class="hljs-comment">// ========== ç¬¬4æ­¥ï¼šThreadLocal.createMap() ==========</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">createMap</span><span class="hljs-params">(Thread t, T firstValue)</span> {
    t.threadLocals = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocalMap</span>(<span class="hljs-built_in">this</span>, firstValue);
    <span class="hljs-comment">// this = MDCçš„ThreadLocalå®ä¾‹</span>
    <span class="hljs-comment">// firstValue = nullï¼ˆä½†åé¢ä¼šé‡æ–°setï¼‰</span>
}

<span class="hljs-comment">// ========== ç¬¬5æ­¥ï¼šThreadLocalMapæ„é€ å‡½æ•° ==========</span>
ThreadLocalMap(ThreadLocal&lt;?&gt; firstKey, Object firstValue) {
    table = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Entry</span>[INITIAL_CAPACITY];  <span class="hljs-comment">// åˆ›å»º16å¤§å°çš„æ•°ç»„</span>
    
    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> firstKey.threadLocalHashCode &amp; (INITIAL_CAPACITY - <span class="hljs-number">1</span>);
    <span class="hljs-comment">// è®¡ç®—å“ˆå¸Œç´¢å¼•ï¼Œå‡è®¾ i = 3</span>
    
    table[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Entry</span>(firstKey, firstValue);
    <span class="hljs-comment">// table[3] = Entry(MDCçš„ThreadLocalå®ä¾‹, null)</span>
    
    size = <span class="hljs-number">1</span>;
}

<span class="hljs-comment">// ========== ç¬¬6æ­¥ï¼šå›åˆ°MDC.put() ==========</span>
Map&lt;String, String&gt; map = contextMap.get();
<span class="hljs-comment">// map = nullï¼ˆå› ä¸ºsetInitialValueè¿”å›nullï¼‰</span>

<span class="hljs-keyword">if</span> (map == <span class="hljs-literal">null</span>) {
    map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    contextMap.set(map);
    <span class="hljs-comment">// è°ƒç”¨ThreadLocal.set()</span>
}

<span class="hljs-comment">// ========== ç¬¬7æ­¥ï¼šThreadLocal.set() ==========</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">set</span><span class="hljs-params">(T value)</span> {
    <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);
    <span class="hljs-comment">// map = ThreadLocalMapï¼ˆå·²å­˜åœ¨ï¼‰</span>
    
    <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) {
        map.set(<span class="hljs-built_in">this</span>, value);
        <span class="hljs-comment">// åœ¨ThreadLocalMapä¸­è®¾ç½®å€¼</span>
    }
}

<span class="hljs-comment">// ========== ç¬¬8æ­¥ï¼šThreadLocalMap.set() ==========</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">set</span><span class="hljs-params">(ThreadLocal&lt;?&gt; key, Object value)</span> {
    Entry[] tab = table;
    <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> tab.length;
    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> key.threadLocalHashCode &amp; (len - <span class="hljs-number">1</span>);
    <span class="hljs-comment">// è®¡ç®—ç´¢å¼•ï¼Œå‡è®¾ i = 3</span>
    
    <span class="hljs-comment">// æŸ¥æ‰¾Entryï¼ˆå¤„ç†å“ˆå¸Œå†²çªï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">Entry</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> tab[i]; e != <span class="hljs-literal">null</span>; e = tab[i = nextIndex(i, len)]) {
        ThreadLocal&lt;?&gt; k = e.get();
        
        <span class="hljs-keyword">if</span> (k == key) {
            <span class="hljs-comment">// æ‰¾åˆ°å¯¹åº”çš„Entryï¼Œæ›´æ–°value</span>
            e.value = value;
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-keyword">if</span> (k == <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// keyè¢«GCå›æ”¶äº†ï¼Œæ›¿æ¢è¿™ä¸ªstale entry</span>
            replaceStaleEntry(key, value, i);
            <span class="hljs-keyword">return</span>;
        }
    }
    
    <span class="hljs-comment">// æ²¡æ‰¾åˆ°ï¼Œåˆ›å»ºæ–°Entry</span>
    tab[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Entry</span>(key, value);
    <span class="hljs-comment">// table[3].value = new HashMap&lt;&gt;()</span>
    
    <span class="hljs-type">int</span> <span class="hljs-variable">sz</span> <span class="hljs-operator">=</span> ++size;
    <span class="hljs-keyword">if</span> (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold) {
        rehash();  <span class="hljs-comment">// æ‰©å®¹</span>
    }
}

<span class="hljs-comment">// ========== ç¬¬9æ­¥ï¼šå›åˆ°MDC.put() ==========</span>
map.put(<span class="hljs-string">"tid"</span>, <span class="hljs-string">"abc123"</span>);
<span class="hljs-comment">// åœ¨HashMapä¸­å­˜å‚¨key-value</span>
</code></pre>
<h3 data-id="heading-20">7.2 å†…å­˜çŠ¶æ€å˜åŒ–</h3>
<pre><code class="hljs language-ini" lang="ini">æ‰§è¡Œå‰ï¼š
<span class="hljs-attr">Thread-1.threadLocals</span> = null

æ‰§è¡ŒcreateMapåï¼š
<span class="hljs-attr">Thread-1.threadLocals</span> = ThreadLocalMap {
    table<span class="hljs-section">[3]</span> = Entry(MDCçš„ThreadLocalå®ä¾‹, null)
}

æ‰§è¡Œsetåï¼š
<span class="hljs-attr">Thread-1.threadLocals</span> = ThreadLocalMap {
    table<span class="hljs-section">[3]</span> = Entry(MDCçš„ThreadLocalå®ä¾‹, HashMap{})
}

æ‰§è¡Œmap.putåï¼š
<span class="hljs-attr">Thread-1.threadLocals</span> = ThreadLocalMap {
    table<span class="hljs-section">[3]</span> = Entry(MDCçš„ThreadLocalå®ä¾‹, HashMap{"tid": "abc123"})
}
</code></pre>
<h2 data-id="heading-21">å…«ã€ä¸ºä»€ä¹ˆæ¯ä¸ªçº¿ç¨‹çš„ThreadLocalæ˜¯ç‹¬ç«‹çš„ï¼Ÿ</h2>
<h3 data-id="heading-22">8.1 å…³é”®æœºåˆ¶</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ThreadLocal.get()çš„å®ç°</span>
<span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">()</span> {
    <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();  <span class="hljs-comment">// â† å…³é”®ï¼šè·å–å½“å‰çº¿ç¨‹</span>
    <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);     <span class="hljs-comment">// â† å…³é”®ï¼šä»å½“å‰çº¿ç¨‹è·å–Map</span>
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li><code>Thread.currentThread()</code> è¿”å›çš„æ˜¯<strong>å½“å‰æ‰§è¡Œä»£ç çš„çº¿ç¨‹å¯¹è±¡</strong></li>
<li>æ¯ä¸ªçº¿ç¨‹å¯¹è±¡éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ <code>threadLocals</code> å­—æ®µ</li>
<li>æ‰€ä»¥æ¯ä¸ªçº¿ç¨‹è®¿é—®çš„æ˜¯è‡ªå·±çš„ ThreadLocalMap</li>
</ol>
<h3 data-id="heading-23">8.2 å¤šçº¿ç¨‹ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// çº¿ç¨‹1æ‰§è¡Œ</span>
Thread-<span class="hljs-number">1</span>: 
  Thread.currentThread() â†’ Thread-<span class="hljs-number">1</span>å¯¹è±¡
  Thread-<span class="hljs-number">1.</span>threadLocals â†’ Thread-<span class="hljs-number">1</span>çš„ThreadLocalMap
  MDC.get(<span class="hljs-string">"tid"</span>) â†’ ä»Thread-<span class="hljs-number">1</span>çš„Mapè¯»å–

<span class="hljs-comment">// çº¿ç¨‹2æ‰§è¡Œï¼ˆåŒæ—¶ï¼‰</span>
Thread-<span class="hljs-number">2</span>:
  Thread.currentThread() â†’ Thread-<span class="hljs-number">2</span>å¯¹è±¡
  Thread-<span class="hljs-number">2.</span>threadLocals â†’ Thread-<span class="hljs-number">2</span>çš„ThreadLocalMap
  MDC.get(<span class="hljs-string">"tid"</span>) â†’ ä»Thread-<span class="hljs-number">2</span>çš„Mapè¯»å–

<span class="hljs-comment">// ä¸¤ä¸ªçº¿ç¨‹äº’ä¸å¹²æ‰°</span>
</code></pre>
<h2 data-id="heading-24">ä¹ã€æ€»ç»“</h2>
<h3 data-id="heading-25">9.1 æ ¸å¿ƒåŸç†</h3>
<ol>
<li><strong>ThreadLocalä¸å­˜å‚¨æ•°æ®</strong>ï¼šThreadLocalåªæ˜¯ä¸€ä¸ª"é’¥åŒ™"</li>
<li><strong>æ•°æ®å­˜å‚¨åœ¨Threadå¯¹è±¡ä¸­</strong>ï¼šæ¯ä¸ªThreadå¯¹è±¡æœ‰<code>threadLocals</code>å­—æ®µ</li>
<li><strong>ThreadLocalMapæ˜¯å®é™…å­˜å‚¨</strong>ï¼šç±»ä¼¼HashMapï¼Œä½†ä½¿ç”¨æ•°ç»„+å¼€æ”¾åœ°å€æ³•</li>
<li><strong>ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶åˆ›å»º</strong>ï¼šè°ƒç”¨<code>set()</code>æ—¶ï¼Œå¦‚æœThreadçš„<code>threadLocals</code>ä¸ºnullï¼Œä¼šåˆ›å»ºæ–°çš„ThreadLocalMap</li>
</ol>
<h3 data-id="heading-26">9.2 æ‰§è¡Œæµç¨‹</h3>
<pre><code class="hljs language-scss" lang="scss">MDC<span class="hljs-selector-class">.put</span>("tid", "abc123")
  â†“
ThreadLocal<span class="hljs-selector-class">.get</span>()
  â†“
Thread<span class="hljs-selector-class">.currentThread</span>() â†’ è·å–å½“å‰çº¿ç¨‹å¯¹è±¡
  â†“
t<span class="hljs-selector-class">.threadLocals</span> â†’ è·å–çº¿ç¨‹çš„ThreadLocalMapï¼ˆå¯èƒ½ä¸ºnullï¼‰
  â†“
å¦‚æœä¸ºnull â†’ <span class="hljs-built_in">createMap</span>() â†’ åˆ›å»ºThreadLocalMapå¹¶èµ‹å€¼ç»™t<span class="hljs-selector-class">.threadLocals</span>
  â†“
ThreadLocal<span class="hljs-selector-class">.set</span>() â†’ åœ¨ThreadLocalMapä¸­å­˜å‚¨å€¼
  â†“
Thread-<span class="hljs-number">1</span><span class="hljs-selector-class">.threadLocals</span><span class="hljs-selector-class">.table</span><span class="hljs-selector-attr">[i]</span> = <span class="hljs-built_in">Entry</span>(ThreadLocalå®ä¾‹, HashMap)
</code></pre>
<h3 data-id="heading-27">9.3 å…³é”®ç†è§£</h3>
<p><strong>"ä¸ºçº¿ç¨‹åˆ›å»ºThreadLocal"çš„æœ¬è´¨</strong>ï¼š</p>
<ul>
<li>ä¸æ˜¯åœ¨ThreadLocalä¸­åˆ›å»ºæ•°æ®</li>
<li>è€Œæ˜¯åœ¨<strong>Threadå¯¹è±¡ä¸­åˆ›å»ºThreadLocalMap</strong></li>
<li>ThreadLocalåªæ˜¯ç”¨æ¥è®¿é—®Threadå¯¹è±¡ä¸­æ•°æ®çš„"é’¥åŒ™"</li>
</ul>
<p><strong>å†…å­˜æ¨¡å‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Threadå¯¹è±¡
  â””â”€ threadLocals: ThreadLocalMapï¼ˆæ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹ï¼‰
      â””â”€ table: Entry<span class="hljs-section">[]</span>ï¼ˆå­˜å‚¨å®é™…æ•°æ®ï¼‰
          â””â”€ Entry: <span class="hljs-attr">key</span>=ThreadLocalå®ä¾‹, value=å®é™…å€¼
</code></pre>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ¯ä¸ªçº¿ç¨‹çš„MDCæ˜¯ç‹¬ç«‹çš„ï¼Œäº’ä¸å¹²æ‰°çš„æ ¹æœ¬åŸå› ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§£å†³ JavaScript Number ç²¾åº¦é—®é¢˜ï¼šå¤„ç†è¶…å¤§ Long ç±»å‹ ID]]></title>    <link>https://juejin.cn/post/7573525927793000474</link>    <guid>https://juejin.cn/post/7573525927793000474</guid>    <pubDate>2025-11-17T11:36:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573525927793000474" data-draft-id="7573519273029959726" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§£å†³ JavaScript Number ç²¾åº¦é—®é¢˜ï¼šå¤„ç†è¶…å¤§ Long ç±»å‹ ID"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-11-17T11:36:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OlahOlah"/> <meta itemprop="url" content="https://juejin.cn/user/1576016232062667"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§£å†³ JavaScript Number ç²¾åº¦é—®é¢˜ï¼šå¤„ç†è¶…å¤§ Long ç±»å‹ ID
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1576016232062667/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OlahOlah
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T11:36:58.000Z" title="Mon Nov 17 2025 11:36:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å‰åç«¯äº¤äº’ä¸­ï¼Œå¸¸å¸¸éœ€è¦ä¼ é€’ <code>Long</code> ç±»å‹çš„ IDã€‚ä½† JavaScript çš„ <code>Number</code> ç±»å‹åŸºäº IEEE 754 æ ‡å‡†ï¼Œæœ€å¤§åªèƒ½ç²¾ç¡®è¡¨ç¤º 15 åˆ° 17 ä½çš„æ•´æ•°ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´ä¼šä¸¢å¤±ç²¾åº¦ã€‚ä¸ºäº†é¿å…è¿™ç§é—®é¢˜ï¼Œæœ¬æ–‡ä»‹ç»å¦‚ä½•å¤„ç†è¶…å¤§æ•°å­—ã€‚</p>
<h4 data-id="heading-0">é—®é¢˜æè¿°</h4>
<p>JavaScript çš„ <code>Number</code> ç±»å‹çš„æœ€å¤§å®‰å…¨æ•´æ•°æ˜¯ <code>9007199254740991</code>ï¼Œè¶…è¿‡è¿™ä¸ªå€¼çš„æ•°å­—ä¼šå‡ºç°ç²¾åº¦ä¸¢å¤±ã€‚ä¾‹å¦‚ï¼Œ<code>1234567890123456789</code> ä¼šè¢«è½¬ä¸º <code>1234567890123456700</code>ï¼Œå¯¼è‡´é”™è¯¯ã€‚</p>
<h4 data-id="heading-1">é—®é¢˜çš„æ ¹æº</h4>
<p><code>Long</code> ç±»å‹æ˜¯è®¸å¤šåç«¯è¯­è¨€ï¼ˆå¦‚ Javaï¼‰ç”¨äºè¡¨ç¤ºå¤§æ•´æ•°çš„ç±»å‹ï¼Œè€Œ JavaScript çš„ <code>Number</code> ç±»å‹ä¸èƒ½æ­£ç¡®è¡¨ç¤ºå¦‚æ­¤å¤§çš„æ•°å­—ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// åç«¯ï¼šJava
Long <span class="hljs-attr">longId</span> = <span class="hljs-number">1234567890123456789</span>L<span class="hljs-comment">;</span>
</code></pre>
<p>å‰ç«¯æ¥æ”¶åˆ°è¯¥ ID åï¼Œä¼šå‡ºç°ç²¾åº¦ä¸¢å¤±ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯ï¼šJavaScript</span>
<span class="hljs-keyword">let</span> itemId = <span class="hljs-number">1234567890123456789</span>; Â <span class="hljs-comment">// é”™è¯¯ï¼Œç²¾åº¦ä¸¢å¤±</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(itemId); Â <span class="hljs-comment">// è¾“å‡ºï¼š1234567890123456700</span>
</code></pre>
<h4 data-id="heading-2">è§£å†³æ–¹æ¡ˆ</h4>
<p>å°† <code>Long</code> ç±»å‹ ID è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶ç¡®ä¿å‰åç«¯éƒ½ä½¿ç”¨å­—ç¬¦ä¸²å½¢å¼ä¼ é€’ IDï¼Œé¿å…ç²¾åº¦ä¸¢å¤±ã€‚</p>
<ul>
<li><strong>åå°</strong>ï¼šå°† <code>Long</code> ç±»å‹ ID è½¬ä¸ºå­—ç¬¦ä¸²ã€‚</li>
<li><strong>å‰ç«¯</strong>ï¼šæ¥æ”¶ ID æ—¶ä¿æŒå­—ç¬¦ä¸²ç±»å‹ï¼Œé¿å…è½¬æ¢ä¸º <code>Number</code>ã€‚</li>
</ul>
<h4 data-id="heading-3">å®æ–½æ–¹æ¡ˆ</h4>
<h5 data-id="heading-4">åç«¯ï¼ˆJava ç¤ºä¾‹ï¼‰ï¼š</h5>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
public class ItemController {
 Â  Â <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/items/{id}"</span>)
 Â  Â public ResponseEntity&lt;ItemVO&gt; <span class="hljs-built_in">getItem</span>(<span class="hljs-variable">@PathVariable</span> Long id) {
 Â  Â  Â  Â <span class="hljs-selector-tag">Item</span> <span class="hljs-selector-tag">item</span> = <span class="hljs-selector-tag">itemService</span><span class="hljs-selector-class">.getItemById</span>(id);
â€‹
 Â  Â  Â  Â <span class="hljs-selector-tag">ItemVO</span> <span class="hljs-selector-tag">itemVO</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">ItemVO</span>();
 Â  Â  Â  Â <span class="hljs-selector-tag">itemVO</span><span class="hljs-selector-class">.setId</span>(String.<span class="hljs-built_in">valueOf</span>(id));
â€‹
 Â  Â  Â  Â <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(itemVO);
 Â   }
}
</code></pre>
<h5 data-id="heading-5">å‰ç«¯ï¼ˆJavaScript ç¤ºä¾‹ï¼‰ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ axios è¯·æ±‚ API</span>
axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/items/1234567890123456789'</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
 Â  Â <span class="hljs-keyword">const</span> itemId = response.<span class="hljs-property">data</span>.<span class="hljs-property">id</span>; Â <span class="hljs-comment">// ä¿æŒä¸ºå­—ç¬¦ä¸²</span>
 Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(itemId); Â <span class="hljs-comment">// è¾“å‡ºåŸå§‹å­—ç¬¦ä¸²</span>
  })
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
 Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Error:'</span>, error);
  });
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonç¼–ç¨‹å®æˆ˜ï¼šç»¼åˆé¡¹ç›® â€”â€” è¿·ä½ çˆ¬è™«é¡¹ç›®]]></title>    <link>https://juejin.cn/post/7573595009552154634</link>    <guid>https://juejin.cn/post/7573595009552154634</guid>    <pubDate>2025-11-18T01:46:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573595009552154634" data-draft-id="7573579203460874291" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Pythonç¼–ç¨‹å®æˆ˜ï¼šç»¼åˆé¡¹ç›® â€”â€” è¿·ä½ çˆ¬è™«é¡¹ç›®"/> <meta itemprop="keywords" content="åç«¯,Python,é¢è¯•"/> <meta itemprop="datePublished" content="2025-11-18T01:46:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜çˆ±é’“é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/2799775299157614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Pythonç¼–ç¨‹å®æˆ˜ï¼šç»¼åˆé¡¹ç›® â€”â€” è¿·ä½ çˆ¬è™«é¡¹ç›®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2799775299157614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜çˆ±é’“é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:46:59.000Z" title="Tue Nov 18 2025 01:46:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>è¿™ä¸ªå®æˆ˜ä¸“é—¨è®©ä½ ä½“éªŒâ€œä»é›¶æ­ä¸€ä¸ªå¯ç”¨çš„å°çˆ¬è™«â€ï¼ŒåŠŸèƒ½è™½ç„¶è½»é‡ï¼Œä½†ç»“æ„ã€æµç¨‹ã€å®¹é”™ã€æ¨¡å—åŒ–éƒ½å®Œæ•´å¾—åƒæ ·ï¼Œæ˜¯ä¸€ä¸ªéå¸¸é€‚åˆä½œä¸ºç»¼åˆè®­ç»ƒçš„é¡¹ç›®ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-0">ä¸€ã€é¡¹ç›®ç›®æ ‡</h3>
<p>å¼€å‘ä¸€ä¸ªè¿·ä½ çˆ¬è™«ï¼Œå®ç°ï¼š</p>
<ol>
<li>è¾“å…¥ä¸€ä¸ªç½‘é¡µ URL</li>
<li>è‡ªåŠ¨å‘èµ·è¯·æ±‚å¹¶è·å–ç½‘é¡µå†…å®¹</li>
<li>æå–ç½‘é¡µä¸­çš„æ ‡é¢˜ã€æ­£æ–‡æ–‡å­—ã€é“¾æ¥</li>
<li>å°†ç»“æœä¿å­˜åˆ°æœ¬åœ°</li>
<li>æä¾›åŸºç¡€çš„å¼‚å¸¸å¤„ç†ï¼ˆç½‘ç»œé”™è¯¯ã€è§£æé”™è¯¯ç­‰ï¼‰</li>
<li>ä½¿ç”¨æ¨¡å—åŒ–ç»“æ„å¯æ‰©å±•</li>
</ol>
<p>è¿™æ˜¯ä¸€ä¸ªâ€œåªç”¨ Python æ ‡å‡†åº“ + requests + BeautifulSoupâ€å°±èƒ½å®Œæˆçš„è½»é‡é¡¹ç›®ã€‚</p>
<hr/>
<h3 data-id="heading-1">äºŒã€æ‰€éœ€åº“</h3>
<pre><code class="hljs language-bash" lang="bash">pip install requests beautifulsoup4 lxml
</code></pre>
<p>é¡¹ç›®ä¸­éœ€è¦ç”¨åˆ°ï¼š</p>
<ul>
<li>requestsï¼šç”¨äºå‘é€ HTTP è¯·æ±‚</li>
<li>bs4ï¼ˆBeautifulSoupï¼‰ï¼šç”¨äºè§£æç½‘é¡µ</li>
<li>lxmlï¼šåŠ é€Ÿè§£æå¹¶æå‡ç¨³å®šæ€§</li>
</ul>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€é¡¹ç›®ç»“æ„è®¾è®¡</h3>
<p>æ¨èè¿™æ ·çš„ç»“æ„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">mini_spider/
â”‚â”€â”€ main.py            <span class="hljs-comment"># ä¸»ç¨‹åºå…¥å£</span>
â”‚â”€â”€ fetcher.py         <span class="hljs-comment"># ç½‘ç»œè¯·æ±‚æ¨¡å—</span>
â”‚â”€â”€ parser.py          <span class="hljs-comment"># æ•°æ®è§£ææ¨¡å—</span>
â”‚â”€â”€ saver.py           <span class="hljs-comment"># æ–‡ä»¶ä¿å­˜æ¨¡å—</span>
â”‚â”€â”€ output/            <span class="hljs-comment"># ä¿å­˜çˆ¬å–ç»“æœ</span>
</code></pre>
<p>è¿™ä¼šè®©ç¨‹åºæ›´åƒâ€œå¯ç»´æŠ¤çš„å°é¡¹ç›®â€ï¼Œè€Œä¸æ˜¯é›¶æ•£è„šæœ¬ã€‚</p>
<hr/>
<h2 data-id="heading-3">å››ã€ç¼–å†™ç½‘ç»œè¯·æ±‚æ¨¡å— fetcher.py</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

<span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_html</span>(<span class="hljs-params">url, timeout=<span class="hljs-number">10</span></span>):
    headers = {
        <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Mini Spider Project)"</span>
    }
    <span class="hljs-keyword">try</span>:
        resp = requests.get(url, headers=headers, timeout=timeout)
        resp.raise_for_status()
        resp.encoding = resp.apparent_encoding
        <span class="hljs-keyword">return</span> resp.text
    <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯·æ±‚å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</code></pre>
<p>åŠŸèƒ½äº®ç‚¹ï¼š</p>
<ul>
<li>è‡ªå®šä¹‰ UA é˜²æ­¢éƒ¨åˆ†ç½‘ç«™æ‹’ç»</li>
<li><code>raise_for_status()</code> å¸®ä½ æ•è· 404/500</li>
<li>timeout é˜²æ­¢å¡æ­»</li>
<li>ç¨³å¥çš„å¼‚å¸¸å¤„ç†</li>
</ul>
<hr/>
<h2 data-id="heading-4">äº”ã€ç¼–å†™è§£ææ¨¡å— parser.py</h2>
<p>ç¤ºä¾‹ï¼šæå–æ–‡ç« æ ‡é¢˜ã€æ­£æ–‡æ–‡æœ¬ã€æ‰€æœ‰è¶…é“¾æ¥ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup

<span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_page</span>(<span class="hljs-params">html</span>):
    <span class="hljs-keyword">try</span>:
        soup = BeautifulSoup(html, <span class="hljs-string">"lxml"</span>)

        title = soup.title.string <span class="hljs-keyword">if</span> soup.title <span class="hljs-keyword">else</span> <span class="hljs-string">"æ— æ ‡é¢˜"</span>

        <span class="hljs-comment"># æå–æ­£æ–‡</span>
        paragraphs = [p.get_text(strip=<span class="hljs-literal">True</span>) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> soup.find_all(<span class="hljs-string">"p"</span>)]
        content = <span class="hljs-string">"\n"</span>.join(paragraphs)

        <span class="hljs-comment"># æå–é“¾æ¥</span>
        links = [a[<span class="hljs-string">'href'</span>] <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> soup.find_all(<span class="hljs-string">"a"</span>, href=<span class="hljs-literal">True</span>)]

        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">"title"</span>: title,
            <span class="hljs-string">"content"</span>: content,
            <span class="hljs-string">"links"</span>: links
        }

    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è§£æå¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</code></pre>
<p>è¿™ä¸ªè§£æé€»è¾‘ç®€å•ä½†é€šç”¨ï¼Œèƒ½é€‚é…å¤§éƒ¨åˆ†æ™®é€šç½‘é¡µã€‚</p>
<hr/>
<h2 data-id="heading-5">å…­ã€ä¿å­˜æ¨¡å— saver.py</h2>
<p>æŠŠçˆ¬å–ç»“æœä¿å­˜ä¸º txt æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os

<span class="hljs-keyword">def</span> <span class="hljs-title function_">save_result</span>(<span class="hljs-params">data, filename=<span class="hljs-string">"result.txt"</span></span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(<span class="hljs-string">"output"</span>):
        os.makedirs(<span class="hljs-string">"output"</span>)

    filepath = os.path.join(<span class="hljs-string">"output"</span>, filename)

    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filepath, <span class="hljs-string">"w"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
        f.write(<span class="hljs-string">f"æ ‡é¢˜ï¼š<span class="hljs-subst">{data[<span class="hljs-string">'title'</span>]}</span>\n\n"</span>)
        f.write(<span class="hljs-string">"æ­£æ–‡å†…å®¹ï¼š\n"</span>)
        f.write(data[<span class="hljs-string">"content"</span>])
        f.write(<span class="hljs-string">"\n\né“¾æ¥åˆ—è¡¨ï¼š\n"</span>)
        <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> data[<span class="hljs-string">"links"</span>]:
            f.write(link + <span class="hljs-string">"\n"</span>)

    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·²ä¿å­˜åˆ° <span class="hljs-subst">{filepath}</span>"</span>)
</code></pre>
<p>ä½ ä¹Ÿå¯ä»¥æ‰©å±•æˆï¼š</p>
<ul>
<li>ä¿å­˜ä¸º JSON</li>
<li>ä¿å­˜ä¸º CSV</li>
<li>ä¿å­˜ä¸º HTML</li>
<li>ä¿å­˜ä¸ºçŸ¥è¯†åº“</li>
</ul>
<hr/>
<h2 data-id="heading-6">ä¸ƒã€ä¸»ç¨‹åº main.py</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fetcher <span class="hljs-keyword">import</span> fetch_html
<span class="hljs-keyword">from</span> parser <span class="hljs-keyword">import</span> parse_page
<span class="hljs-keyword">from</span> saver <span class="hljs-keyword">import</span> save_result

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    url = <span class="hljs-built_in">input</span>(<span class="hljs-string">"è¯·è¾“å…¥è¦çˆ¬å–çš„URLï¼š"</span>)

    html = fetch_html(url)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> html:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è·å–ç½‘é¡µå¤±è´¥"</span>)
        <span class="hljs-keyword">return</span>

    data = parse_page(html)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è§£æå¤±è´¥"</span>)
        <span class="hljs-keyword">return</span>

    save_result(data, filename=<span class="hljs-string">"çˆ¬å–ç»“æœ.txt"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"çˆ¬å–å®Œæˆï¼"</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    main()
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">è¯·è¾“å…¥è¦çˆ¬å–çš„URLï¼šhttp:<span class="hljs-comment">//example.com</span>
æ­£åœ¨ä¿å­˜...
çˆ¬å–å®Œæˆï¼
</code></pre>
<hr/>
<h2 data-id="heading-7">å…«ã€é¡¹ç›®ç‰¹è‰²äº®ç‚¹</h2>
<p>è¿™ä¸ªâ€œè¿·ä½ çˆ¬è™«é¡¹ç›®â€è™½ç„¶ç®€å•ï¼Œä½†æ¡†æ¶å¾ˆä¸“ä¸šï¼Œå› ä¸ºå®ƒåŒ…å«ï¼š</p>
<ul>
<li>æ¨¡å—åŒ–å¼€å‘</li>
<li>ç‹¬ç«‹ç½‘ç»œå±‚ + è§£æå±‚ + å­˜å‚¨å±‚</li>
<li>å¼‚å¸¸å¤„ç†å…¨é“¾è·¯</li>
<li>å¯¹ç½‘é¡µæŒ‰ç»“æ„ä¿¡æ¯æ‹†è§£</li>
<li>å·¥ç¨‹ç»“æ„å¯æ‰©å±•æ€§å¼º</li>
</ul>
<p>ä½ ç¨å¾®æ‰©å±•ä¸€ä¸‹å°±èƒ½å˜æˆï¼š</p>
<p>âœ” æ‰¹é‡ URL çˆ¬è™«
âœ” é‡‡é›†æ–°é—»ç½‘ç«™æ–‡ç« 
âœ” é‡‡é›†å•†å“æ ‡é¢˜ä»·æ ¼
âœ” ç›‘æ§ç½‘é¡µå˜åŒ–
âœ” å°è§„æ¨¡æ•°æ®é‡‡é›†è„šæœ¬</p>
<hr/>
<h2 data-id="heading-8">ä¹ã€å¯æ‰©å±•æ–¹å‘ï¼ˆé¡¹ç›®å‡çº§å»ºè®®ï¼‰</h2>
<p>å¦‚æœä½ æƒ³è¿›ä¸€æ­¥å¼ºåŒ–ï¼Œå¯ä»¥åŠ å…¥ï¼š</p>
<h4 data-id="heading-9">1. æ‰¹é‡ URL çˆ¬å–</h4>
<p>ä»æ–‡ä»¶è¯»å– URL åˆ—è¡¨ï¼Œä¸€æ¬¡æŠ“ä¸€æ‰¹ã€‚</p>
<h4 data-id="heading-10">2. è‡ªåŠ¨é™é€Ÿ &amp; é‡è¯•æœºåˆ¶</h4>
<p>é™ä½è¢«å°é£é™©ã€‚</p>
<h4 data-id="heading-11">3. ä»£ç†æ± </h4>
<p>æé«˜ç¨³å®šæ€§ã€‚</p>
<h4 data-id="heading-12">4. ç»“æ„åŒ–å­˜å‚¨ï¼ˆJSON/CSVï¼‰</h4>
<p>æ–¹ä¾¿åç»­åˆ†æã€‚</p>
<h4 data-id="heading-13">5. GUI å›¾å½¢ç•Œé¢ï¼ˆTkinterï¼‰</h4>
<p>å˜æˆçœŸæ­£çš„æ¡Œé¢å·¥å…·ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonç¼–ç¨‹å®æˆ˜ï¼šç»¼åˆé¡¹ç›® â€”â€” Flask è¿·ä½ åšå®¢]]></title>    <link>https://juejin.cn/post/7573601651781943323</link>    <guid>https://juejin.cn/post/7573601651781943323</guid>    <pubDate>2025-11-18T01:48:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573601651781943323" data-draft-id="7573601651781926939" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Pythonç¼–ç¨‹å®æˆ˜ï¼šç»¼åˆé¡¹ç›® â€”â€” Flask è¿·ä½ åšå®¢"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,Python"/> <meta itemprop="datePublished" content="2025-11-18T01:48:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜çˆ±é’“é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/2799775299157614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Pythonç¼–ç¨‹å®æˆ˜ï¼šç»¼åˆé¡¹ç›® â€”â€” Flask è¿·ä½ åšå®¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2799775299157614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜çˆ±é’“é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:48:21.000Z" title="Tue Nov 18 2025 01:48:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>è¿™ä¸ªé¡¹ç›®æ˜¯å…¸å‹çš„ Web å…¥é—¨å®æˆ˜ â€”â€” ç”¨ Flask æ­å»ºä¸€ä¸ªâ€œå°è€Œå®Œæ•´â€çš„åšå®¢ç³»ç»Ÿï¼Œè®©ä½ æŒæ¡åç«¯æ¥å£å¼€å‘ã€æ¨¡æ¿æ¸²æŸ“ã€æ•°æ®å­˜å‚¨ã€è¡¨å•å¤„ç†ç­‰æ ¸å¿ƒæŠ€èƒ½ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€é¡¹ç›®ç›®æ ‡</h2>
<p>æ„å»ºä¸€ä¸ªè¿·ä½ åšå®¢ï¼Œå®ç°ï¼š</p>
<ol>
<li>å‘å¸ƒæ–‡ç« ï¼ˆæ ‡é¢˜ + å†…å®¹ï¼‰</li>
<li>å±•ç¤ºæ‰€æœ‰æ–‡ç« </li>
<li>æŸ¥çœ‹å•ç¯‡æ–‡ç« è¯¦æƒ…</li>
<li>æ–‡ç« æŒä¹…åŒ–å­˜å‚¨ï¼ˆæœ¬åœ° JSON æˆ– SQLiteï¼‰</li>
<li>æ¨¡æ¿æ¸²æŸ“ï¼ˆJinja2ï¼‰</li>
<li>ç®€å•çš„è·¯ç”±å’Œè¡¨å•å¤„ç†</li>
</ol>
<p>æ•´ä¸ªé¡¹ç›®ç»“æ„å°å·§ï¼Œä½†é€»è¾‘å®Œæ•´ï¼Œå¯æ‰©å±•æ€§é«˜ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€é¡¹ç›®ç›®å½•ç»“æ„</h2>
<p>æˆ‘ä»¬ä½¿ç”¨ Flask æ¨èçš„åŸºæœ¬ç»“æ„ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">flask_blog/
â”‚â”€â”€ app.py                <span class="hljs-meta"># ä¸»ç¨‹åº</span>
â”‚â”€â”€ models.py             <span class="hljs-meta"># æ•°æ®è¯»å†™æ¨¡å—</span>
â”‚â”€â”€ <span class="hljs-keyword">static</span>/               <span class="hljs-meta"># é™æ€æ–‡ä»¶ï¼ˆcss/js/imgï¼‰</span>
â”‚â”€â”€ templates/
â”‚     â”œâ”€â”€ <span class="hljs-keyword">base</span>.html
â”‚     â”œâ”€â”€ index.html
â”‚     â”œâ”€â”€ post.html
â”‚     â”œâ”€â”€ new_post.html
â”‚â”€â”€ data/
      â””â”€â”€ posts.json      <span class="hljs-meta"># å­˜å‚¨æ–‡ç« </span>
</code></pre>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€ç¯å¢ƒå®‰è£…</h2>
<pre><code class="hljs language-bash" lang="bash">pip install flask
</code></pre>
<p>å¦‚æœä½ æƒ³å‡çº§ï¼Œå¯åŠ ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install flask-wtf
</code></pre>
<p>ä½†åŸºç¡€é¡¹ç›®ä¸å¼ºåˆ¶ã€‚</p>
<hr/>
<h2 data-id="heading-3">å››ã€æ„å»ºæ•°æ®æ¨¡å‹ï¼ˆmodels.pyï¼‰</h2>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ JSON æ–‡ä»¶ä¿å­˜æ–‡ç« ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

DATA_FILE = <span class="hljs-string">"data/posts.json"</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">load_posts</span>():
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(DATA_FILE):
        <span class="hljs-keyword">return</span> []
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(DATA_FILE, <span class="hljs-string">"r"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
        <span class="hljs-keyword">return</span> json.load(f)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">save_posts</span>(<span class="hljs-params">posts</span>):
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(DATA_FILE, <span class="hljs-string">"w"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
        json.dump(posts, f, ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">4</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">add_post</span>(<span class="hljs-params">title, content</span>):
    posts = load_posts()
    new_post = {
        <span class="hljs-string">"id"</span>: <span class="hljs-built_in">len</span>(posts) + <span class="hljs-number">1</span>,
        <span class="hljs-string">"title"</span>: title,
        <span class="hljs-string">"content"</span>: content,
        <span class="hljs-string">"created_at"</span>: datetime.now().strftime(<span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span>)
    }
    posts.append(new_post)
    save_posts(posts)
</code></pre>
<hr/>
<h2 data-id="heading-4">äº”ã€æ ¸å¿ƒåç«¯é€»è¾‘ï¼ˆapp.pyï¼‰</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template, request, redirect, url_for
<span class="hljs-keyword">from</span> models <span class="hljs-keyword">import</span> load_posts, add_post

app = Flask(__name__)

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">"/"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():
    posts = load_posts()
    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">"index.html"</span>, posts=posts)

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">"/post/&lt;int:post_id&gt;"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">post_detail</span>(<span class="hljs-params">post_id</span>):
    posts = load_posts()
    post = <span class="hljs-built_in">next</span>((p <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> posts <span class="hljs-keyword">if</span> p[<span class="hljs-string">"id"</span>] == post_id), <span class="hljs-literal">None</span>)
    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">"post.html"</span>, post=post)

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">"/new"</span>, methods=[<span class="hljs-string">"GET"</span>, <span class="hljs-string">"POST"</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">new_post</span>():
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">"POST"</span>:
        title = request.form.get(<span class="hljs-string">"title"</span>)
        content = request.form.get(<span class="hljs-string">"content"</span>)
        add_post(title, content)
        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">"index"</span>))
    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">"new_post.html"</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    app.run(debug=<span class="hljs-literal">True</span>)
</code></pre>
<p>åŠŸèƒ½ç‚¹ï¼š</p>
<ul>
<li>GET å±•ç¤ºè¡¨å•</li>
<li>POST æäº¤æ–‡ç« </li>
<li>é¦–é¡µå±•ç¤ºæ–‡ç« åˆ—è¡¨</li>
<li>/post/id å±•ç¤ºæ–‡ç« è¯¦æƒ…</li>
</ul>
<p>æ¶æ„ç®€æ´ä½†éå¸¸æ¸…æ™°ã€‚</p>
<hr/>
<h2 data-id="heading-5">å…­ã€æ¨¡æ¿æ–‡ä»¶ï¼ˆtemplatesï¼‰</h2>
<h3 data-id="heading-6">1. base.html</h3>
<p>æ‰€æœ‰é¡µé¢çš„å…¬å…±å¸ƒå±€ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>è¿·ä½ åšå®¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/static/style.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/"</span>&gt;</span>è¿·ä½ åšå®¢<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/"</span>&gt;</span>é¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/new"</span>&gt;</span>å†™æ–‡ç« <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
        {% block content %}{% endblock %}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<hr/>
<h3 data-id="heading-7">2. index.htmlï¼ˆé¦–é¡µï¼‰</h3>
<pre><code class="hljs language-html" lang="html">{% extends "base.html" %}
{% block content %}
<span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>æ–‡ç« åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
{% for p in posts %}
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/post/{{ p.id }}"</span>&gt;</span>{{ p.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>{{ p.created_at }}<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
{% endfor %}
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>

{% endblock %}
</code></pre>
<hr/>
<h3 data-id="heading-8">3. post.htmlï¼ˆæ–‡ç« è¯¦æƒ…ï¼‰</h3>
<pre><code class="hljs language-html" lang="html">{% extends "base.html" %}
{% block content %}
<span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{{ post.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ post.content }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>å‘å¸ƒæ—¶é—´ï¼š{{ post.created_at }}<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
{% endblock %}
</code></pre>
<hr/>
<h3 data-id="heading-9">4. new_post.htmlï¼ˆæ–°å¢æ–‡ç« è¡¨å•ï¼‰</h3>
<pre><code class="hljs language-html" lang="html">{% extends "base.html" %}
{% block content %}

<span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å†™æ–‡ç« <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ ‡é¢˜ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">required</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å†…å®¹ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"content"</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">required</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>å‘å¸ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>

{% endblock %}
</code></pre>
<hr/>
<h2 data-id="heading-10">ä¸ƒã€é™æ€æ ·å¼ï¼ˆstatic/style.cssï¼‰å¯é€‰</h2>
<p>ä½ å¯ä»¥éšæ„å†™ç‚¹ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">body</span> {
    <span class="hljs-attribute">font-family</span>: Arial, sans-serif;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
}
<span class="hljs-selector-tag">header</span> {
    <span class="hljs-attribute">background</span>: <span class="hljs-number">#333</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span>;
}
<span class="hljs-selector-tag">header</span> <span class="hljs-selector-tag">a</span> {
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
    <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10px</span>;
    <span class="hljs-attribute">text-decoration</span>: none;
}
<span class="hljs-selector-class">.container</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
}
</code></pre>
<hr/>
<h2 data-id="heading-11">å…«ã€è¿è¡Œé¡¹ç›®</h2>
<p>è¿›å…¥ç›®å½•æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python app.py
</code></pre>
<p>æ‰“å¼€ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">http:<span class="hljs-comment">//127.0.0.1:5000</span>
</code></pre>
<p>ä½ å°±èƒ½çœ‹åˆ°è‡ªå·±çš„è¿·ä½ åšå®¢å•¦ï¼</p>
<hr/>
<h2 data-id="heading-12">ä¹ã€é¡¹ç›®å¯æ‰©å±•æ–¹å‘</h2>
<p>è¿™ä¸ªé¡¹ç›®åŸºç¡€ä½†å¯æ‰©å±•æ€§è¶…çº§å¼ºï¼Œå¯ä»¥ç»§ç»­å‡çº§ï¼š</p>
<ol>
<li>ä½¿ç”¨ SQLite æ•°æ®åº“ï¼ˆSQLAlchemyï¼‰</li>
<li>åŠ ä¸Šç”¨æˆ·ç™»å½•ç³»ç»Ÿ</li>
<li>åšå®¢æ”¯æŒ Markdown</li>
<li>å›¾ç‰‡ä¸Šä¼ </li>
<li>åˆ†é¡µ</li>
<li>è¯„è®ºç³»ç»Ÿ</li>
<li>åå°ç®¡ç†ç•Œé¢</li>
<li>æ‰“åŒ…ä¸º Docker éƒ¨ç½²</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Dart 3.10ä¸­çš„æ–°çš„lintè§„åˆ™]]></title>    <link>https://juejin.cn/post/7573601651781877787</link>    <guid>https://juejin.cn/post/7573601651781877787</guid>    <pubDate>2025-11-18T01:43:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573601651781877787" data-draft-id="7572793505900724275" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Dart 3.10ä¸­çš„æ–°çš„lintè§„åˆ™"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-18T01:43:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JarvanMo"/> <meta itemprop="url" content="https://juejin.cn/user/2348212565845704"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Dart 3.10ä¸­çš„æ–°çš„lintè§„åˆ™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2348212565845704/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JarvanMo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:43:04.000Z" title="Tue Nov 18 2025 01:43:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰å‡ å¤©ï¼Œ<code>Flutter 3.38</code> &amp; <code>Dart 3.10</code>æ­£å¼å‘å¸ƒï¼Œè¯¦æƒ…å‚è€ƒ<a href="https://juejin.cn/user/2348212565845704/posts" target="_blank" title="https://juejin.cn/user/2348212565845704/posts">Flutter3.38 å¸¦æ¥äº†ä»€ä¹ˆ</a>ã€‚è¿™å…¶ä¸­åŒ…æ‹¬äº†ä¸€é¡¹æ–°çš„lint:</p>
<h3 data-id="heading-0"><a href="https://link.juejin.cn?target=https%3A%2F%2Fdart.dev%2Ftools%2Fdiagnostics%2Fremove_deprecations_in_breaking_versions" target="_blank" title="https://dart.dev/tools/diagnostics/remove_deprecations_in_breaking_versions" ref="nofollow noopener noreferrer">remove_deprecations_in_breaking_versions</a></h3>
<p>è¯´äººè¯å°±æ˜¯:<strong>åœ¨ä¸»è¦ç‰ˆæœ¬ä¸­ç§»é™¤å¼ƒç”¨åŠŸèƒ½</strong>ã€‚</p>
<p><strong>æ¬¢è¿å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ï¼šOpenFlutterï¼Œè°¢è°¢</strong></p>
<p>å½“ä½ æƒ³è¦åœ¨è½¯ä»¶åŒ…ä¸­ç§»é™¤æŸäº› API æ—¶ï¼Œä½ ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯ä¼š<strong>åˆ†é˜¶æ®µåœ°é€æ¸æ·˜æ±°</strong>ã€‚ä¸€æ—¦æ‚¨å†³å®šæŸä¸ªåŠŸèƒ½å°†åœ¨æŸä¸ªæ—¶é—´ç‚¹ç§»é™¤ï¼Œæ‚¨å°±ä¼šåœ¨å…¶ä¸ŠåŠ ä¸Š <code>@Deprecated</code> æ³¨è§£ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-meta">@Deprecated</span>(<span class="hljs-string">'This sucks. Use Class2'</span>)  
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Class1</span> </span>{}  
  
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Class2</span> </span>{}
</code></pre>
<p>ç„¶åï¼Œä»»ä½•ä½¿ç”¨æ‚¨è½¯ä»¶åŒ…çš„ç”¨æˆ·ï¼Œåªè¦ä½¿ç”¨äº†è¢«è¿™æ ·æ³¨è§£ï¼ˆå³ <code>@Deprecated</code>ï¼‰çš„ä»»ä½•åŠŸèƒ½ï¼Œå°±ä¼šæ”¶åˆ°ä¸€æ¡ <code>deprecated_member_use</code> è¯Šæ–­æ¶ˆæ¯ã€‚</p>
<p><strong>é‚£ä¹ˆï¼Œä½•æ—¶åº”è¯¥ç§»é™¤æ‚¨ä¹‹å‰å£°æ˜å·²å¼ƒç”¨çš„ API å‘¢ï¼Ÿ</strong> è¿™å°±æ˜¯ç‰ˆæœ¬å·çº¦å®šå‘æŒ¥ä½œç”¨çš„æ—¶å€™äº†ã€‚æœ€å¸¸è§çš„çº¦å®šè¢«ç§°ä¸º <strong>SemVerï¼ˆè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼‰</strong> ï¼Œå…¶å®šä¹‰å¯åœ¨ <code>https://semver.org</code> æŸ¥é˜…ã€‚</p>
<p>SemVer è§„å®šï¼Œç‰ˆæœ¬å·å¿…é¡»åŒ…å«ä¸‰ä¸ªæ•°å­—ï¼š<strong>ä¸»ç‰ˆæœ¬å· (Major).æ¬¡ç‰ˆæœ¬å· (Minor).ä¿®è®¢å· (Patch)</strong> ã€‚ä¾‹å¦‚ï¼ŒDart çš„å½“å‰ç‰ˆæœ¬æ˜¯ <code>3.10.0</code>ï¼š</p>
<ul>
<li><strong>3</strong> æ˜¯ä¸»ç‰ˆæœ¬å·ã€‚</li>
<li><strong>10</strong> æ˜¯æ¬¡ç‰ˆæœ¬å·ã€‚</li>
<li><strong>0</strong> æ˜¯ä¿®è®¢å·ã€‚</li>
</ul>
<p>å½“æ‚¨å‘å¸ƒä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œå®ƒ<strong>åªä¿®å¤äº†é”™è¯¯</strong>ï¼Œè€Œæ²¡æœ‰ç ´åä»»ä½•æ‚¨çš„è½¯ä»¶åŒ…ç”¨æˆ·å¯èƒ½ä¾èµ–çš„ä¸œè¥¿æ—¶ï¼Œæ‚¨åº”è¯¥å¢åŠ <strong>ä¿®è®¢å· (Patch)</strong> ã€‚ä¾‹å¦‚ï¼ŒDart çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬æ˜¯ <code>3.9.2</code>ï¼Œè¿™æ„å‘³ç€ä»–ä»¬å‘å¸ƒäº†ä¸‰ä¸ª <code>3.9.x</code> ç‰ˆæœ¬ï¼Œå…¶ä¸­æœ€åä¸¤ä¸ªä¿®å¤äº†ä¸€äº›é”™è¯¯ã€‚</p>
<p>å½“æ‚¨å‘å¸ƒä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œå®ƒ<strong>å¢åŠ äº†æ–°åŠŸèƒ½</strong>ï¼Œä½†ä»ç„¶æ²¡æœ‰ç ´åä»»ä½•æ‚¨çš„è½¯ä»¶åŒ…ç”¨æˆ·å¯èƒ½ä¾èµ–çš„ä¸œè¥¿æ—¶ï¼Œæ‚¨åº”è¯¥å¢åŠ <strong>æ¬¡ç‰ˆæœ¬å· (Minor)</strong> ã€‚ä¾‹å¦‚ï¼Œä» <code>3.9.2</code> åˆ° <code>3.10.0</code>ï¼ŒDart å¢åŠ äº†æ‚¨çš„ä»£ç å¯ä»¥ä½¿ç”¨çš„<strong>æ–°åŠŸèƒ½</strong>ï¼Œä½†ä¿è¯æ‰€æœ‰åŸæœ¬å¯ä»¥åœ¨ <code>3.9.2</code> ä¸Šæ„å»ºçš„ä»£ç ä»ç„¶å¯ä»¥åœ¨ <code>3.10.0</code> ä¸Šæ„å»ºã€‚</p>
<p>å½“æ‚¨å‘å¸ƒä¸€ä¸ª<strong>ä¸å…¼å®¹ç‰ˆæœ¬ï¼ˆbreaking versionï¼‰</strong> æ—¶ï¼Œæ‚¨éœ€è¦å¢åŠ <strong>ä¸»ç‰ˆæœ¬å· (Major)</strong> ã€‚</p>
<p>Dart ç¤¾åŒº<a href="https://link.juejin.cn?target=https%3A%2F%2Fdart.dev%2Ftools%2Fpub%2Fversioning%23semantic-versions" target="_blank" title="https://dart.dev/tools/pub/versioning#semantic-versions" ref="nofollow noopener noreferrer">é‡‡çº³äº†</a>è¿™ä¸€æ ‡å‡†ï¼Œä½†å¢åŠ äº†ä¸€ä¸ªé¢å¤–çš„é™åˆ¶ã€‚å°½ç®¡æ ‡å‡†ä¸ä¿è¯ç¬¬ä¸€ä¸ªç¨³å®šç‰ˆæœ¬ (<code>1.0.0</code>) ä¹‹å‰çš„ç‰ˆæœ¬ä¹‹é—´æœ‰ä»»ä½•å…¼å®¹æ€§ï¼Œä½† Dart ä»ç„¶<strong>è¯­ä¹‰åŒ–åœ°</strong>å¤„ç†è¿™äº›ç‰ˆæœ¬ï¼šåœ¨ <code>1.0.0</code> ä¹‹å‰ï¼Œ<strong>æ¬¡ç‰ˆæœ¬å· (minor)</strong> çš„å¢åŠ æ„å‘³ç€<strong>ä¸å…¼å®¹çš„å˜æ›´ (breaking changes)</strong> ã€‚è¿™ä½¿å¾—æˆ‘ä»¬åœ¨å®£å¸ƒç¨³å®šç‰ˆæœ¬ä¹‹å‰ï¼Œå¯ä»¥å¤šæ¬¡å‘å‡ºä¸å…¼å®¹ç‰ˆæœ¬çš„ä¿¡å·ï¼Œä»¥æ”¹è¿›æˆ‘ä»¬çš„è½¯ä»¶åŒ…ã€‚</p>
<p>ä¸å…¼å®¹ç‰ˆæœ¬å¯¹æ‚¨çš„ç”¨æˆ·æ¥è¯´ç®€ç›´æ˜¯åœ°ç‹±ï¼Œå› ä¸ºé™¤éä»–ä»¬åœ¨ <code>pubspec.yaml</code> ä¸­æ˜ç¡®å…è®¸ï¼Œå¦åˆ™å®ƒä¸ä¼šè‡ªåŠ¨è¢«æ‹‰å…¥ä»–ä»¬çš„é¡¹ç›®ã€‚ä»–ä»¬ä½¿ç”¨çš„ä¸€äº›è½¯ä»¶åŒ…å¯èƒ½éœ€è¦æ‚¨çš„æ–°ä¸»ç‰ˆæœ¬ï¼Œè€Œå…¶ä»–è½¯ä»¶åŒ…å¯èƒ½ä¸å®ƒä¸å…¼å®¹ã€‚è¿™å°±æ˜¯<strong>ä¾èµ–åœ°ç‹± (dependency hell)</strong> ã€‚æ‚¨å¿…é¡»é¿å…è¿‡äºé¢‘ç¹åœ°å‘å¸ƒæ–°çš„ä¸»ç‰ˆæœ¬ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¦‚æœæ‚¨è®¡åˆ’è¿›è¡Œä¸å…¼å®¹çš„æ›´æ”¹ï¼Œæ‚¨é€šå¸¸å¸Œæœ›é€šè¿‡ä¸€ä¸ªä¸»ç‰ˆæœ¬<strong>å°½å¯èƒ½å¤šåœ°ä¸€æ¬¡æ€§è¿›è¡Œæ‰€æœ‰ç ´åæ€§æ›´æ”¹</strong>ï¼Œä»¥ä¾¿æ‚¨çš„ç”¨æˆ·åªéœ€é€‚åº”ä¸€æ¬¡ã€‚</p>
<p>å› æ­¤ï¼Œå¦‚æœæ‚¨å‘å¸ƒäº†ä¸€ä¸ªæ–°çš„ä¸»ç‰ˆæœ¬ï¼Œå´å¿˜è®°ç§»é™¤æ‚¨åŸæœ¬æƒ³ç§»é™¤çš„ä¸œè¥¿ï¼Œé‚£å°†æ˜¯éå¸¸å¯æƒœçš„ã€‚</p>
<p>å› æ­¤ï¼Œå¼•å…¥äº†æ–°çš„ä»£ç é£æ ¼æ£€æŸ¥å·¥å…·ï¼ˆlintï¼‰æ¥å¸®åŠ©æ‚¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å¦‚æœåœ¨æ‚¨çš„ <code>pubspec.yaml</code> ä¸­ï¼Œæ‚¨è®¾ç½®äº†<strong>ä¸å…¼å®¹çš„ç‰ˆæœ¬å·</strong>ï¼ˆ<code>x.0.0</code> æˆ– <code>0.x.0</code>ï¼‰ï¼Œè¿™ä¸ª lint å°±ä¼šæ ‡è®°å‡ºæ‚¨å¯èƒ½ä»ç„¶æ‹¥æœ‰çš„æ‰€æœ‰ <code>@Deprecated</code> æ³¨è§£ã€‚</p>
<p>ä¸€ä¸ªæœ‰è¶£çš„æ¨è®ºæ˜¯ï¼šæ‚¨<strong>ä¸åº”è¯¥</strong>åœ¨ä¸€ä¸ªä¸å…¼å®¹ç‰ˆæœ¬ä¸­å¼•å…¥æ–°çš„å¼ƒç”¨ã€‚å¦‚æœæ‚¨è¿™æ ·åšï¼Œlint ä¼šæ ‡è®°å®ƒï¼Œæ‚¨å°†ä¸å¾—ä¸å¿½ç•¥å®ƒã€‚ä¸€æ—¦æ‚¨å†³å®šåœ¨æŸå¤„å¿½ç•¥å®ƒï¼Œæ‚¨å°±æœ‰å¯èƒ½å¿½ç•¥é‚£äº›åº”è¯¥è¢«ç§»é™¤ä½†è¢«æ‚¨é—å¿˜çš„æ—§å¼ƒç”¨åŠŸèƒ½æ‰€å¼•å‘çš„åˆç†è­¦å‘Šã€‚</p>
<p>å› æ­¤ï¼Œè¯·é¦–å…ˆå‘å¸ƒä¸€ä¸ª<strong>æ­£å¸¸çš„ä¸å…¼å®¹ç‰ˆæœ¬ï¼ˆå…¶ä¸­ä¸åŒ…å«ä»»ä½•å¼ƒç”¨ï¼‰</strong> ï¼Œç„¶ååœ¨<strong>ä¸‹ä¸€ä¸ªç‰ˆæœ¬</strong>ä¸­å¼ƒç”¨ä¸€äº›ä¸œè¥¿ã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œå¦‚æœæ‚¨å¼•å…¥äº†å¼ƒç”¨åŠŸèƒ½ï¼Œæ‚¨åº”è¯¥å¢åŠ <strong>æ¬¡ç‰ˆæœ¬å· (Minor)</strong> ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¿®è®¢å· (Patch)ã€‚</p>
<p>è¿™æ˜¯å› ä¸ºæ‚¨è½¯ä»¶åŒ…çš„ä¸€äº›ç”¨æˆ·å¯èƒ½åœ¨ä»–ä»¬çš„æŒç»­é›†æˆï¼ˆCIï¼‰ä¸­è®¾ç½®äº†é™æ€åˆ†æï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªè§„åˆ™æ˜¯<strong>ä¸ä½¿ç”¨ä»»ä½•å¼ƒç”¨çš„ä»£ç </strong>ã€‚å½“æ‚¨å¼ƒç”¨æŸä¸ªåŠŸèƒ½æ—¶ï¼Œè¿™ä¸ª CI å°±ä¼šä¸­æ–­ã€‚å› æ­¤ï¼ŒSemVer æ ‡å‡†ä¸­æœ‰ä¸€é¡¹çº¦å®šï¼Œå³<strong>ä¿®è®¢å· (patch) æ›´æ–°ä¸ä¼šä¸­æ–­</strong>è¿™ç§æ£€æŸ¥ã€‚</p>
<p><strong>ä½•æ—¶åº”è¯¥ä½¿ç”¨è¿™ä¸ª linter è§„åˆ™å‘¢ï¼Ÿ</strong> æ˜¾ç„¶ï¼Œå¯¹äºé‚£äº›æ„å»ºå¹¶äº¤ä»˜ç»™ç”¨æˆ·çš„å¸¸è§„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œå®ƒæ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸ºè¿™äº›ç”¨æˆ·çœ‹ä¸åˆ°æˆ–ä½¿ç”¨ä»»ä½•ä»£ç ã€‚è¿™æ¡è§„åˆ™<strong>ä»…å¯¹å¯å‘å¸ƒçš„è½¯ä»¶åŒ…ï¼ˆpublishable packagesï¼‰æœ‰æ„ä¹‰</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Groovyç¿»è¯‘ç³»åˆ—ä¸‰ã€‘Groovyåº”ç”¨é›†æˆ]]></title>    <link>https://juejin.cn/post/7573525927793377306</link>    <guid>https://juejin.cn/post/7573525927793377306</guid>    <pubDate>2025-11-17T14:15:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573525927793377306" data-draft-id="7573525927793344538" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Groovyç¿»è¯‘ç³»åˆ—ä¸‰ã€‘Groovyåº”ç”¨é›†æˆ"/> <meta itemprop="keywords" content="Groovy"/> <meta itemprop="datePublished" content="2025-11-17T14:15:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜Ÿç«1024"/> <meta itemprop="url" content="https://juejin.cn/user/3353967687906576"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Groovyç¿»è¯‘ç³»åˆ—ä¸‰ã€‘Groovyåº”ç”¨é›†æˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3353967687906576/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜Ÿç«1024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T14:15:09.000Z" title="Mon Nov 17 2025 14:15:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åŸæ–‡æ¡£é“¾æ¥ï¼šâ€‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fgroovy-lang.org%2Fintegrating.html" target="_blank" title="https://groovy-lang.org/integrating.html" ref="nofollow noopener noreferrer">â€‹https://groovy-lang.org/integrating.htmlâ€‹</a>â€‹</p>
</blockquote>
<p>Groovyæ˜¯ä¸€é—¨åŸºäºJVMçš„è¯­è¨€ï¼Œå ªç§°åŠ¨æ€è¯­è¨€ç‰ˆJavaï¼Œå…¶å„ç§åŠ¨æ€è¯­è¨€ç‰¹æ€§å¡«è¡¥äº†Javaçš„å„ç§ç©ºç¼ºï¼Œè®©äººæ‹æ¡ˆå«ç»â€¦â€¦æœ‰å¹¸æ¥è§¦Groovyï¼Œé‚æ‰‹åŠ¨ç¿»è¯‘ä¸‰ç¯‡å®˜æ–¹æ–‡æ¡£ï¼Œä»¥ä¾¿äºè¯»è€…ä»Javaåˆ°Groovyçš„å¿«é€Ÿè¿ç§»ã€‚</p>
<hr/>
<p>Groovy è¯­è¨€æå‡ºäº†å‡ ç§åœ¨è¿è¡Œæ—¶å°†è‡ªèº«é›†æˆåˆ°åº”ç”¨ç¨‹åºï¼ˆJava ç”šè‡³ Groovyï¼‰ä¸­çš„æ–¹æ³•ï¼Œä»æœ€åŸºæœ¬çš„ç®€å•ä»£ç æ‰§è¡Œåˆ°æœ€å®Œæ•´çš„é›†æˆç¼“å­˜å’Œç¼–è¯‘å™¨å®šåˆ¶ã€‚</p>
<blockquote>
<p>æœ¬èŠ‚ä¸­ç¼–å†™çš„æ‰€æœ‰ç¤ºä¾‹éƒ½ä½¿ç”¨ Groovyï¼Œä½†å¯ä»¥åœ¨ Java ä¸­ä½¿ç”¨ç›¸åŒçš„é›†æˆæœºåˆ¶ã€‚</p>
</blockquote>






<table><thead><tr><th/></tr></thead></table>
<h4 data-id="heading-0">1.1. Eval</h4>
<p>è¿™ä¸ªâ€‹<code>â€‹groovy.util.Evalâ€‹</code>â€‹â€‹ç±»æ˜¯æœ€ç®€å•çš„æ–¹å¼åœ¨è¿è¡Œæ—¶åŠ¨æ€çš„æ‰§è¡ŒGroovyã€‚å¯ä»¥ä½¿ç”¨â€‹<code>â€‹meâ€‹</code>â€‹æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> groovy.util.Evalassert Eval.me(<span class="hljs-string">'33*3'</span>) == <span class="hljs-number">99</span>
<span class="hljs-keyword">assert</span> Eval.me(<span class="hljs-string">'"foo".toUpperCase()'</span>) == <span class="hljs-string">'FOO'</span>
</code></pre>
<p>â€‹<code>â€‹Evalâ€‹</code>â€‹æ”¯æŒå¤šç§å‚æ•°æ¥æ”¶å˜ä½“æ¥æ”¯æŒç®€æ˜“çš„è¡¨è¾¾å¼ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">assert</span> Eval.x(<span class="hljs-number">4</span>, <span class="hljs-string">'2*x'</span>) == <span class="hljs-number">8</span>                (<span class="hljs-number">1</span>)
<span class="hljs-keyword">assert</span> Eval.me(<span class="hljs-string">'k'</span>, <span class="hljs-number">4</span>, <span class="hljs-string">'2*k'</span>) == <span class="hljs-number">8</span>          (<span class="hljs-number">2</span>)
<span class="hljs-keyword">assert</span> Eval.xy(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-string">'x*y'</span>) == <span class="hljs-number">20</span>           (<span class="hljs-number">3</span>)
<span class="hljs-keyword">assert</span> Eval.xyz(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-string">'x*y+z'</span>) == <span class="hljs-number">26</span>     (<span class="hljs-number">4</span>)
</code></pre>





















<table><thead><tr><th><strong>1</strong></th><th>ä¸€ä¸ªç»‘å®šäº†åç§°ä¸ºâ€‹<code>â€‹xâ€‹</code>â€‹å‚æ•°çš„ç®€æ˜“è¡¨è¾¾å¼</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>è·Ÿä¸Šé¢çš„ä¸€æ ·ï¼Œä¸€ä¸ªç»‘å®šäº†åç§°ä¸ºâ€‹<code>â€‹kâ€‹</code>â€‹å‚æ•°çš„ç®€æ˜“è¡¨è¾¾å¼</td></tr><tr><td><strong>3</strong></td><td>ä¸€ä¸ªç»‘å®šäº†â€‹<code>â€‹xâ€‹</code>â€‹â€‹å’Œâ€‹<code>â€‹yâ€‹</code>â€‹ä¸¤ä¸ªç»‘å®šå‚æ•°çš„ç®€æ˜“è¡¨è¾¾å¼</td></tr><tr><td><strong>4</strong></td><td>ä¸€ä¸ªç»‘å®šäº†â€‹<code>â€‹xâ€‹</code>â€‹â€‹ã€â€‹<code>â€‹yâ€‹</code>â€‹â€‹å’Œâ€‹<code>â€‹zâ€‹</code>â€‹ä¸‰ä¸ªç»‘å®šå‚æ•°çš„ç®€æ˜“è¡¨è¾¾å¼</td></tr></tbody></table>
<p>â€‹<code>â€‹Evalâ€‹</code>â€‹ç±»ä½¿å¾—æ‰§è¡Œç®€æ˜“çš„è„šæœ¬å˜å¾—å®¹æ˜“ï¼Œä½†æ˜¯å¯¹äºå¤§è§„æ¨¡çš„è„šæœ¬ä¸è¡Œï¼šæ²¡æœ‰è„šæœ¬ç¼“å­˜ï¼Œè€Œä¸”ä¸èƒ½æ‰§è¡Œè¶…è¿‡ä¸€è¡Œçš„è¡¨è¾¾å¼ã€‚</p>
<h4 data-id="heading-1">1.2. GroovyShell</h4>
<h5 data-id="heading-2">1.2.1. å¤šç§æ¥æº</h5>
<p>â€‹<code>â€‹groovy.lang.GroovyShellâ€‹</code>â€‹â€‹ç±»æ˜¯æ‰§è¡Œè„šæœ¬çš„é¦–é€‰æ–¹å¼ï¼Œèƒ½å¤Ÿç¼“å­˜ç”Ÿæˆçš„è„šæœ¬å®ä¾‹ã€‚å°½ç®¡â€‹<code>â€‹Evalâ€‹</code>â€‹â€‹ç±»èƒ½å¤Ÿè¿”å›ç¼–è¯‘åè„šæœ¬çš„æ‰§è¡Œç»“æœï¼Œâ€‹<code>â€‹GroovyShellâ€‹</code>â€‹å¯ä»¥æä¾›æ›´å¤šçš„é€‰æ‹©ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">def <span class="hljs-attr">shell</span> = new GroovyShell()                           (<span class="hljs-number">1</span>)
def <span class="hljs-attr">result</span> = shell.evaluate <span class="hljs-string">'3*5'</span>                       (<span class="hljs-number">2</span>)
def <span class="hljs-attr">result2</span> = shell.evaluate(new StringReader(<span class="hljs-string">'3*5'</span>))   (<span class="hljs-number">3</span>)
assert <span class="hljs-attr">result</span> == result2
def <span class="hljs-attr">script</span> = shell.parse <span class="hljs-string">'3*5'</span>                          (<span class="hljs-number">4</span>)
assert script instanceof groovy.lang.Script
assert script.run() == 15                               (5)
</code></pre>

























<table><thead><tr><th><strong>1</strong></th><th>åˆ›å»ºä¸€ä¸ªæ–°çš„â€‹<code>â€‹GroovyShellâ€‹</code>â€‹å®ä¾‹</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>å¯ä»¥ä½œä¸ºâ€‹<code>â€‹Evalâ€‹</code>â€‹ç›´æ¥æ‰§è¡Œä»£ç </td></tr><tr><td><strong>3</strong></td><td>èƒ½å¤Ÿä»å¾ˆå¤šæºè¯»å–ï¼ˆâ€‹<code>â€‹Stringâ€‹</code>â€‹â€‹,â€‹<code>â€‹Readerâ€‹</code>â€‹â€‹,â€‹<code>â€‹Fileâ€‹</code>â€‹â€‹,â€‹<code>â€‹InputStreamâ€‹</code>â€‹ï¼‰</td></tr><tr><td><strong>4</strong></td><td>å¯ä»¥å»¶è¿Ÿè„šæœ¬çš„æ‰§è¡Œã€‚ä½¿ç”¨â€‹<code>â€‹parseâ€‹</code>â€‹â€‹æ–¹æ³•è¿”å›ä¸€ä¸ªâ€‹<code>â€‹Scriptâ€‹</code>â€‹å®ä¾‹</td></tr><tr><td><strong>5</strong></td><td>â€‹<code>â€‹Scriptâ€‹</code>â€‹â€‹å®šä¹‰äº†ä¸€ä¸ªâ€‹<code>â€‹runâ€‹</code>â€‹æ–¹æ³•</td></tr></tbody></table>
<h5 data-id="heading-3">1.2.2. åœ¨è„šæœ¬å’Œåº”ç”¨é—´å…±äº«æ•°æ®</h5>
<p>é€šè¿‡ä½¿ç”¨â€‹<code>â€‹groovy.lang.Bindingâ€‹</code>â€‹å»åœ¨è„šæœ¬å’Œåº”ç”¨é—´å…±äº«æ•°æ®ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">def sharedData = new <span class="hljs-built_in">Binding</span>()                          (<span class="hljs-number">1</span>)
def shell = new <span class="hljs-built_in">GroovyShell</span>(sharedData)                 (<span class="hljs-number">2</span>)
def now = new <span class="hljs-built_in">Date</span>()
sharedData<span class="hljs-selector-class">.setProperty</span>('text', 'I am shared data!')     (<span class="hljs-number">3</span>)
sharedData<span class="hljs-selector-class">.setProperty</span>('date', now)                     (<span class="hljs-number">4</span>)
String result = shell<span class="hljs-selector-class">.evaluate</span>('"At $date, $text"')     (<span class="hljs-number">5</span>)
assert result == "At <span class="hljs-variable">$now</span>, <span class="hljs-selector-tag">I</span> am shared data!"
</code></pre>

























<table><thead><tr><th><strong>1</strong></th><th>åˆ›å»ºä¸€ä¸ªåŒ…å«å…±äº«æ•°æ®çš„æ–°â€‹<code>â€‹Bindingâ€‹</code>â€‹</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>ä½¿ç”¨å…±äº«æ•°æ®åˆ›å»ºä¸€ä¸ªâ€‹<code>â€‹GroovyShellâ€‹</code>â€‹</td></tr><tr><td><strong>3</strong></td><td>æ·»åŠ å­—ç¬¦ä¸²åˆ°ç»‘å®šä¸­</td></tr><tr><td><strong>4</strong></td><td>æ·»åŠ ä¸€ä¸ªæ—¥æœŸåˆ°ç»‘å®šä¸­ï¼ˆä½ å¯ä»¥ä¸å¿…é™åˆ¶äºç®€å•çš„ç±»å‹ï¼‰</td></tr><tr><td><strong>5</strong></td><td>æ‰§è¡Œè„šæœ¬</td></tr></tbody></table>
<p>æ³¨æ„ï¼Œä¹Ÿæœ‰å¯ä»¥åœ¨è„šæœ¬ä¸­å†™å…¥ç»‘å®šï¼š</p>
<pre><code class="hljs language-scss" lang="scss">def sharedData = new <span class="hljs-built_in">Binding</span>()                          (<span class="hljs-number">1</span>)
def shell = new <span class="hljs-built_in">GroovyShell</span>(sharedData)                 (<span class="hljs-number">2</span>)

shell<span class="hljs-selector-class">.evaluate</span>('foo=<span class="hljs-number">123</span>')                               (<span class="hljs-number">3</span>)
assert sharedData<span class="hljs-selector-class">.getProperty</span>('foo') == <span class="hljs-number">123</span>             (<span class="hljs-number">4</span>)
</code></pre>





















<table><thead><tr><th><strong>1</strong></th><th>åˆ›å»ºä¸€ä¸ªâ€‹<code>â€‹Bindingâ€‹</code>â€‹å®ä¾‹</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>ä½¿ç”¨å…±äº«æ•°æ®åˆ›å»ºä¸€ä¸ªæ–°çš„â€‹<code>â€‹GroovyShellâ€‹</code>â€‹</td></tr><tr><td><strong>3</strong></td><td>åœ¨ç»‘å®šä¸­ä½¿ç”¨ä¸€ä¸ª<strong>æœªå£°æ˜çš„</strong>å˜é‡å»å­˜å‚¨ç»“æœ</td></tr><tr><td><strong>4</strong></td><td>åœ¨å›è°ƒä¸­è¯»å–ç»“æœ</td></tr></tbody></table>
<p>å¦‚æœä½ æƒ³ä½¿ç”¨ç»‘å®šï¼Œä¸€ä¸ªæœªå£°æ˜å˜é‡æ˜¯å¾ˆé‡è¦çš„ã€‚åƒä¸‹é¢ä¾‹å­ä¸€æ ·ä½¿ç”¨â€‹<code>â€‹defâ€‹</code>â€‹â€‹æˆ–è€…â€‹<code>â€‹explicitâ€‹</code>â€‹ç±»å‹å°†ä¼šå¤±è´¥ï¼Œå› ä¸ºä½ å°†ä¼šåˆ›å»ºä¸€ä¸ª<em>æœ¬åœ°</em>å˜é‡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">def</span> <span class="hljs-variable">sharedData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Binding</span>()
<span class="hljs-type">def</span> <span class="hljs-variable">shell</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GroovyShell</span>(sharedData)

shell.evaluate(<span class="hljs-string">'int foo=123'</span>)<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">assert</span> sharedData.getProperty(<span class="hljs-string">'foo'</span>)
} <span class="hljs-keyword">catch</span> (MissingPropertyException e) {
    println <span class="hljs-string">"foo is defined as a local variable"</span>
}
</code></pre>






<table><thead><tr><th/></tr></thead></table>
<blockquote>
<p>ä½ åœ¨å¤šçº¿ç¨‹ä¸­ä½¿ç”¨å…±äº«å˜é‡æ—¶å¿…é¡»éå¸¸å°å¿ƒã€‚ä¼ é€’ç»™GroovyShellçš„Bindingå®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¼šè¢«æ‰€æœ‰çš„è„šæœ¬å…±äº«ã€‚</p>
</blockquote>
<p>å¯ä»¥é€šè¿‡åˆ©ç”¨â€‹<code>â€‹parseâ€‹</code>â€‹â€‹è¿”å›çš„â€‹<code>â€‹Scriptâ€‹</code>â€‹â€‹å®ä¾‹æ¥è§£å†³â€‹<code>â€‹Bindingâ€‹</code>â€‹çš„å…±äº«å®ä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">def</span> <span class="hljs-variable">shell</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GroovyShell</span>()<span class="hljs-type">def</span> <span class="hljs-variable">b1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Binding</span>(x:<span class="hljs-number">3</span>)                       (<span class="hljs-number">1</span>)
<span class="hljs-type">def</span> <span class="hljs-variable">b2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Binding</span>(x:<span class="hljs-number">4</span>)                       (<span class="hljs-number">2</span>)
<span class="hljs-type">def</span> <span class="hljs-variable">script</span> <span class="hljs-operator">=</span> shell.parse(<span class="hljs-string">'x = 2*x'</span>)
script.binding = b1
script.run()
script.binding = b2
script.run()
<span class="hljs-keyword">assert</span> b1.getProperty(<span class="hljs-string">'x'</span>) == <span class="hljs-number">6</span>
<span class="hljs-keyword">assert</span> b2.getProperty(<span class="hljs-string">'x'</span>) == <span class="hljs-number">8</span>
<span class="hljs-keyword">assert</span> b1 != b2
</code></pre>













<table><thead><tr><th><strong>1</strong></th><th>å°†â€‹<code>â€‹xâ€‹</code>â€‹â€‹å˜é‡å­˜å‚¨åœ¨â€‹<code>â€‹b1â€‹</code>â€‹ä¸­</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>å°†â€‹<code>â€‹xâ€‹</code>â€‹â€‹å˜é‡å­˜å‚¨åœ¨â€‹<code>â€‹b2â€‹</code>â€‹ä¸­</td></tr></tbody></table>
<p>ä½†æ˜¯ï¼Œä½ å¿…é¡»çŸ¥é“ä½ ä»åœ¨å…±äº«<strong>åŒä¸€è„šæœ¬å®ä¾‹</strong>ã€‚å› æ­¤ï¼Œå¦‚æœä½ æœ‰ä¸¤ä¸ªçº¿ç¨‹å¤„ç†åŒä¸€ä¸ªè„šæœ¬ï¼Œåˆ™æ— æ³•ä½¿ç”¨æ­¤æŠ€æœ¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¿…é¡»ç¡®ä¿åˆ›å»ºä¸¤ä¸ªä¸åŒçš„è„šæœ¬å®ä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">def shell = new <span class="hljs-built_in">GroovyShell</span>()def b1 = new <span class="hljs-built_in">Binding</span>(x:<span class="hljs-number">3</span>)
def b2 = new <span class="hljs-built_in">Binding</span>(x:<span class="hljs-number">4</span>)
def script1 = shell<span class="hljs-selector-class">.parse</span>('x = <span class="hljs-number">2</span>*x')            (<span class="hljs-number">1</span>)
def script2 = shell<span class="hljs-selector-class">.parse</span>('x = <span class="hljs-number">2</span>*x')            (<span class="hljs-number">2</span>)
assert script1 != script2
script1<span class="hljs-selector-class">.binding</span> = b1                            (<span class="hljs-number">3</span>)
script2<span class="hljs-selector-class">.binding</span> = b2                            (<span class="hljs-number">4</span>)
def t1 = Thread<span class="hljs-selector-class">.start</span> { script1<span class="hljs-selector-class">.run</span>() }         (<span class="hljs-number">5</span>)
def t2 = Thread<span class="hljs-selector-class">.start</span> { script2<span class="hljs-selector-class">.run</span>() }         (<span class="hljs-number">6</span>)
<span class="hljs-selector-attr">[t1,t2]</span>*<span class="hljs-selector-class">.join</span>()                                 (<span class="hljs-number">7</span>)
assert b1<span class="hljs-selector-class">.getProperty</span>('x') == <span class="hljs-number">6</span>
assert b2<span class="hljs-selector-class">.getProperty</span>('x') == <span class="hljs-number">8</span>
assert b1 != b2
</code></pre>

































<table><thead><tr><th><strong>1</strong></th><th>ä¸ºçº¿ç¨‹1åˆ›å»ºä¸€ä¸ªå®ä¾‹</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>ä¸ºçº¿ç¨‹2åˆ›å»ºä¸€ä¸ªå®ä¾‹</td></tr><tr><td><strong>3</strong></td><td>å°†ç¬¬ä¸€ä¸ªç»‘å®šåˆ†é…ç»™è„šæœ¬1</td></tr><tr><td><strong>4</strong></td><td>å°†ç¬¬ä¸€ä¸ªç»‘å®šåˆ†é…ç»™è„šæœ¬2</td></tr><tr><td><strong>5</strong></td><td>åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­å¯åŠ¨ç¬¬ä¸€ä¸ªè„šæœ¬</td></tr><tr><td><strong>6</strong></td><td>åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­å¯åŠ¨ç¬¬äºŒä¸ªè„šæœ¬</td></tr><tr><td><strong>7</strong></td><td>ç­‰å¾…å®Œæˆ</td></tr></tbody></table>
<p>å¦‚æœä½ éœ€è¦åƒè¿™é‡Œè¿™æ ·çš„çº¿ç¨‹å®‰å…¨ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨ GroovyClassLoaderã€‚</p>
<h5 data-id="heading-4">1.2.3. è‡ªå®šä¹‰è„šæœ¬ç±»</h5>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°â€‹<code>â€‹parseâ€‹</code>â€‹â€‹æ–¹æ³•è¿”å›ä¸€ä¸ªâ€‹<code>â€‹groovy.lang.Scriptâ€‹</code>â€‹â€‹çš„å®ä¾‹ï¼Œä½†æ˜¯æœ‰å¯èƒ½éœ€è¦å»ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»å»æ‰©å±•â€‹<code>â€‹Scriptâ€‹</code>â€‹æœ¬èº«ã€‚å®ƒå¯ç”¨äºä¸ºè„šæœ¬æä¾›é¢å¤–çš„è¡Œä¸ºï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyScript</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Script</span> </span>{
    <span class="hljs-type">String</span> name

    <span class="hljs-type">String</span> greet() {
        <span class="hljs-string">"Hello, $name!"</span>
    }
}
</code></pre>
<p>è¿™ä¸ªè‡ªå®šä¹‰ç±»å®šä¹‰äº†ä¸€ä¸ªå«åšâ€‹<code>â€‹nameâ€‹</code>â€‹â€‹çš„å‚æ•°å’Œä¸€ä¸ªå«åšâ€‹<code>â€‹greetâ€‹</code>â€‹çš„æ–¹æ³•ã€‚è¿™ä¸ªç±»å¯ä»¥é€šè¿‡ä¸€ä¸ªè‡ªå®šä¹‰çš„é…ç½®æ¥è¢«ç”¨ä½œè„šæœ¬çš„åŸºç¡€ç±»ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.codehaus.groovy.control.<span class="hljs-type">CompilerConfigurationdef</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompilerConfiguration</span>()                                    (<span class="hljs-number">1</span>)
config.scriptBaseClass = <span class="hljs-string">'MyScript'</span>                                         (<span class="hljs-number">2</span>)
<span class="hljs-type">def</span> <span class="hljs-variable">shell</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GroovyShell</span>(<span class="hljs-built_in">this</span>.class.classLoader, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Binding</span>(), config)  (<span class="hljs-number">3</span>)
<span class="hljs-type">def</span> <span class="hljs-variable">script</span> <span class="hljs-operator">=</span> shell.parse(<span class="hljs-string">'greet()'</span>)                                         (<span class="hljs-number">4</span>)
<span class="hljs-keyword">assert</span> script <span class="hljs-keyword">instanceof</span> MyScript
script.setName(<span class="hljs-string">'Michel'</span>)
<span class="hljs-keyword">assert</span> script.run() == <span class="hljs-string">'Hello, Michel!'</span>
</code></pre>





















<table><thead><tr><th><strong>1</strong></th><th>åˆ›å»ºä¸€ä¸ªâ€‹<code>â€‹CompilerConfigurationâ€‹</code>â€‹å®ä¾‹</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>æŒ‡å®šâ€‹<code>â€‹MyScriptâ€‹</code>â€‹ä½œä¸ºè„šæœ¬çš„åŸºç¡€ç±»</td></tr><tr><td><strong>3</strong></td><td>ç„¶ååœ¨åˆ›å»º shell æ—¶ä½¿ç”¨ç¼–è¯‘å™¨é…ç½®</td></tr><tr><td><strong>4</strong></td><td>è¯¥è„šæœ¬ç°åœ¨å¯ä»¥è®¿é—®æ–°æ–¹æ³•â€‹<code>â€‹greetâ€‹</code>â€‹</td></tr></tbody></table>






<table><thead><tr><th/></tr></thead></table>
<blockquote>
<p>ä½ ä¸ä»…å±€é™äºå”¯ä¸€çš„<em>scriptBaseClass</em>é…ç½®ã€‚ä½ èƒ½å¤Ÿè°ƒæ•´ä»»æ„çš„ç¼–è¯‘å™¨é…ç½®ï¼ŒåŒ…æ‹¬â€‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.groovy-lang.org%2Flatest%2Fhtml%2Fdocumentation%2Fcore-domain-specific-languages.html%23compilation-customizers" target="_blank" title="https://docs.groovy-lang.org/latest/html/documentation/core-domain-specific-languages.html#compilation-customizers" ref="nofollow noopener noreferrer">â€‹compilation customizersâ€‹</a>â€‹ã€‚</p>
</blockquote>
<h4 data-id="heading-5">1.3. GroovyClassLoader</h4>
<p>åœ¨ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬å·²ç»å±•ç¤ºäº†â€‹<code>â€‹GroovyShellâ€‹</code>â€‹â€‹æ˜¯ä¸€ä¸ªæ‰§è¡Œè„šæœ¬çš„ç®€å•å·¥å…·ï¼Œä½†æ˜¯é™¤äº†è„šæœ¬ä¹‹å¤–ï¼Œç¼–è¯‘ä»»ä½•ä¸œè¥¿éƒ½å˜å¾—å¾ˆå¤æ‚ã€‚åœ¨å†…éƒ¨ï¼Œå®ƒä½¿ç”¨â€‹<code>â€‹groovy.lang.GroovyClassLoaderâ€‹</code>â€‹ ï¼Œè¿™æ˜¯è¿è¡Œæ—¶ç¼–è¯‘å’ŒåŠ è½½ç±»çš„æ ¸å¿ƒã€‚</p>
<p>é€šè¿‡ä½¿ç”¨â€‹<code>â€‹GroovyClassLoaderâ€‹</code>â€‹â€‹æ›¿ä»£â€‹<code>â€‹GroovyShellâ€‹</code>â€‹ï¼Œä½ å°†èƒ½å¤ŸåŠ è½½ç±»ï¼Œè€Œä¸æ˜¯è„šæœ¬å®ä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import groovy.lang.GroovyClassLoaderdef <span class="hljs-attr">gcl</span> = new GroovyClassLoader()                                           (<span class="hljs-number">1</span>)
def <span class="hljs-attr">clazz</span> = gcl.parseClass(<span class="hljs-string">'class Foo { void doIt() { println "ok" } }'</span>)    (<span class="hljs-number">2</span>)
assert <span class="hljs-attr">clazz.name</span> == <span class="hljs-string">'Foo'</span>                                                  (<span class="hljs-number">3</span>)
def <span class="hljs-attr">o</span> = clazz.newInstance()                                                 (<span class="hljs-number">4</span>)
o.doIt()                                                                    (5)
</code></pre>

























<table><thead><tr><th><strong>1</strong></th><th>åˆ›å»ºä¸€ä¸ªæ–°çš„â€‹<code>â€‹GroovyClassLoaderâ€‹</code>â€‹</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>â€‹<code>â€‹parseClassâ€‹</code>â€‹â€‹å°†ä¼šè¿”å›â€‹<code>â€‹Classâ€‹</code>â€‹çš„å®ä¾‹</td></tr><tr><td><strong>3</strong></td><td>ä½ å¯ä»¥æ£€æŸ¥è¿”å›çš„ç±»æ˜¯å¦çœŸçš„æ˜¯è„šæœ¬ä¸­å®šä¹‰çš„ç±»</td></tr><tr><td><strong>4</strong></td><td>ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹ï¼Œå®ƒä¸æ˜¯è„šæœ¬</td></tr><tr><td><strong>5</strong></td><td>ç„¶åè°ƒç”¨å®ƒçš„ä»»ä½•æ–¹æ³•</td></tr></tbody></table>
<blockquote>
<p>GroovyClassLoaderä¿ç•™äº†å®ƒåˆ›å»ºçš„æ‰€æœ‰ç±»çš„å¼•ç”¨ï¼Œå› æ­¤å¾ˆå®¹æ˜“é€ æˆå†…å­˜æ³„æ¼ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœä½ æ‰§è¡Œä¸¤æ¬¡ç›¸åŒçš„è„šæœ¬ï¼Œå¦‚æœå®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆä½ å°†è·å¾—ä¸¤ä¸ªä¸åŒçš„ç±»ï¼</p>
</blockquote>






<table><thead><tr><th/></tr></thead></table>
<pre><code class="hljs language-ini" lang="ini">import groovy.lang.GroovyClassLoaderdef <span class="hljs-attr">gcl</span> = new GroovyClassLoader()
def <span class="hljs-attr">clazz1</span> = gcl.parseClass(<span class="hljs-string">'class Foo { }'</span>)                                (<span class="hljs-number">1</span>)
def <span class="hljs-attr">clazz2</span> = gcl.parseClass(<span class="hljs-string">'class Foo { }'</span>)                                (<span class="hljs-number">2</span>)
assert <span class="hljs-attr">clazz1.name</span> == <span class="hljs-string">'Foo'</span>                                                 (<span class="hljs-number">3</span>)
assert <span class="hljs-attr">clazz2.name</span> == <span class="hljs-string">'Foo'</span>
assert clazz1 != clazz2                                                     (4)
</code></pre>





















<table><thead><tr><th><strong>1</strong></th><th>åŠ¨æ€åˆ›å»ºä¸€ä¸ªåä¸ºâ€œFooâ€çš„ç±»</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>ä½¿ç”¨å•ç‹¬çš„â€‹<code>â€‹parseClassâ€‹</code>â€‹è°ƒç”¨åˆ›å»ºä¸€ä¸ªå¤–è§‚ç›¸åŒçš„ç±»</td></tr><tr><td><strong>3</strong></td><td>ç¡®ä¿ä¸¤ä¸ªç±»å…·æœ‰ç›¸åŒçš„åç§°</td></tr><tr><td><strong>4</strong></td><td>ä½†å®ƒä»¬å®é™…ä¸Šæ˜¯ä¸åŒçš„ï¼</td></tr></tbody></table>
<p>åŸå› æ˜¯â€‹<code>â€‹GroovyClassLoaderâ€‹</code>â€‹ä¸è·Ÿè¸ªæºæ–‡æœ¬ã€‚å¦‚æœä½ æƒ³æ‹¥æœ‰ç›¸åŒçš„å®ä¾‹ï¼Œåˆ™æº<strong>å¿…é¡»</strong>æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">def <span class="hljs-attr">gcl</span> = new GroovyClassLoader()
def <span class="hljs-attr">clazz1</span> = gcl.parseClass(file)                                           (<span class="hljs-number">1</span>)
def <span class="hljs-attr">clazz2</span> = gcl.parseClass(new File(file.absolutePath))                    (<span class="hljs-number">2</span>)
assert <span class="hljs-attr">clazz1.name</span> == <span class="hljs-string">'Foo'</span>                                                 (<span class="hljs-number">3</span>)
assert <span class="hljs-attr">clazz2.name</span> == <span class="hljs-string">'Foo'</span>
assert <span class="hljs-attr">clazz1</span> == clazz2                                                     (<span class="hljs-number">4</span>)
</code></pre>





















<table><thead><tr><th><strong>1</strong></th><th>ä»â€‹<code>â€‹æ–‡ä»¶â€‹</code>â€‹ä¸­è§£æä¸€ä¸ªç±»</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>ä»ä¸åŒçš„æ–‡ä»¶å®ä¾‹è§£æä¸€ä¸ªç±»ï¼Œä½†æŒ‡å‘åŒä¸€ä¸ªç‰©ç†æ–‡ä»¶</td></tr><tr><td><strong>3</strong></td><td>ç¡®ä¿æˆ‘ä»¬çš„ç±»å…·æœ‰ç›¸åŒçš„åç§°</td></tr><tr><td><strong>4</strong></td><td>ä½†ç°åœ¨ï¼Œå®ƒä»¬æ˜¯åŒä¸€ä¸ªå®ä¾‹</td></tr></tbody></table>
<p>ä½¿ç”¨ä¸€ä¸ªâ€‹<code>â€‹Fileâ€‹</code>â€‹â€‹ä½œä¸ºè¾“å…¥ï¼Œâ€‹<code>â€‹GroovyClassLoaderâ€‹</code>â€‹æ˜¯æœ‰èƒ½åŠ›<strong>ç¼“å­˜</strong>ç”Ÿæˆçš„ç±»æ–‡ä»¶çš„ï¼Œè¿™æ ·èƒ½å¤Ÿé¿å…åœ¨è¿è¡Œæ—¶åˆ›å»ºå¤šä¸ªåŒæºç±»ã€‚</p>
<h4 data-id="heading-6">1.4. GroovyScriptEngine</h4>
<p>â€‹<code>â€‹groovy.util.GroovyScriptEngineâ€‹</code>â€‹â€‹ç±»ä¸ºæœ‰è„šæœ¬ä¾èµ–çš„åº”ç”¨ç¨‹åºæä¾›äº†çµæ´»çš„è„šæœ¬é‡è½½åŸºç¡€ã€‚è™½ç„¶â€‹<code>â€‹GroovyShellâ€‹</code>â€‹â€‹ä¸“æ³¨äºç‹¬ç«‹è„šæœ¬ï¼Œè€Œâ€‹<code>â€‹GroovyClassLoaderâ€‹</code>â€‹â€‹å¤„ç†ä»»ä½• Groovy ç±»çš„åŠ¨æ€ç¼–è¯‘å’ŒåŠ è½½ï¼Œä½†æ˜¯â€‹<code>â€‹GroovyScriptEngineâ€‹</code>â€‹â€‹å°†åœ¨â€‹<code>â€‹GroovyClassLoaderâ€‹</code>â€‹ä¹‹ä¸Šæ·»åŠ ä¸€ä¸ªå±‚æ¥å¤„ç†è„šæœ¬ä¾èµ–å…³ç³»å’Œé‡æ–°åŠ è½½ã€‚</p>
<p>ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªè„šæœ¬å¼•æ“å¹¶åœ¨æ— é™å¾ªç¯ä¸­æ‰§è¡Œä»£ç ã€‚é¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹è„šæœ¬ï¼š</p>
<p>ReloadingTest.groovy</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Greeter</span> {
    <span class="hljs-title class_">String</span> <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"/>) {
        def greet = <span class="hljs-string">"Hello, world!"</span>
        greet
    }
}<span class="hljs-keyword">new</span> <span class="hljs-title class_">Greeter</span>()
</code></pre>
<p>ç„¶åä½ å¯ä»¥ä½¿ç”¨â€‹<code>â€‹GroovyScriptEngineâ€‹</code>â€‹æ‰§è¡Œæ­¤ä»£ç ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">def binding = new <span class="hljs-built_in">Binding</span>()
def engine = new <span class="hljs-built_in">GroovyScriptEngine</span>([tmpDir.toURI()<span class="hljs-selector-class">.toURL</span>()] as URL<span class="hljs-selector-attr">[]</span>)          (<span class="hljs-number">1</span>)while (true) {
    def greeter = engine<span class="hljs-selector-class">.run</span>('ReloadingTest.groovy', binding)                   (<span class="hljs-number">2</span>)
    println greeter<span class="hljs-selector-class">.sayHello</span>()                                                  (<span class="hljs-number">3</span>)
    Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">1000</span>)
}
</code></pre>

















<table><thead><tr><th><strong>1</strong></th><th>åˆ›å»ºä¸€ä¸ªè„šæœ¬å¼•æ“ï¼Œå®ƒå°†åœ¨æˆ‘ä»¬çš„æºç›®å½•ä¸­æŸ¥æ‰¾æº</th></tr></thead><tbody><tr><td><strong>2</strong></td><td>æ‰§è¡Œè„šæœ¬ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªâ€‹<code>â€‹Greeterâ€‹</code>â€‹çš„å®ä¾‹</td></tr><tr><td><strong>3</strong></td><td>æ‰“å°é—®å€™è¯­</td></tr></tbody></table>
<p>æ­¤æ—¶ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°æ¯ç§’æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼š</p>
<p>Hello, world!Hello, world!...</p>
<p>åœ¨<strong>ä¸ä¸­æ–­</strong>è„šæœ¬æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œç°åœ¨å°†â€‹<code>â€‹ReloadingTestâ€‹</code>â€‹æ–‡ä»¶çš„å†…å®¹æ›¿æ¢ä¸ºï¼š</p>
<p>ReloadingTest.groovy</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Greeter</span> {
    <span class="hljs-title class_">String</span> <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"/>) {
        def greet = <span class="hljs-string">"Hello, Groovy!"</span>
        greet
    }
}<span class="hljs-keyword">new</span> <span class="hljs-title class_">Greeter</span>()
</code></pre>
<p>æ¶ˆæ¯åº”æ›´æ”¹ä¸ºï¼š</p>
<p>Hello, world!...Hello, Groovy!Hello, Groovy!...</p>
<p>ä½†ä¹Ÿå¯èƒ½ä¾èµ–äºå¦ä¸€ä¸ªè„šæœ¬ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œåœ¨åŒä¸€ç›®å½•ä¸­åˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼Œè€Œä¸ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬ï¼š</p>
<p>Dependency.groovy</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dependency</span> {
    <span class="hljs-type">String</span> message = <span class="hljs-string">'Hello, dependency 1'</span>
}
</code></pre>
<p>å¹¶åƒè¿™æ ·æ›´æ–°â€‹<code>â€‹ReloadingTestâ€‹</code>â€‹è„šæœ¬ï¼š</p>
<p>ReloadingTest.groovy</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Dependencyclass</span> <span class="hljs-title class_">Greeter</span> {
    <span class="hljs-title class_">String</span> <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"/>) {
        def greet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dependency</span>().<span class="hljs-property">message</span>
        greet
    }
}<span class="hljs-keyword">new</span> <span class="hljs-title class_">Greeter</span>()
</code></pre>
<p>è¿™ä¸€æ¬¡ï¼Œæ¶ˆæ¯åº”è¯¥å˜ä¸ºï¼š</p>
<p>Hello, Groovy!...Hello, dependency 1!Hello, dependency 1!...</p>
<p>ä½œä¸ºæœ€åä¸€ä¸ªæµ‹è¯•ï¼Œä½ å¯ä»¥æ›´æ–°â€‹<code>â€‹Dependency.groovyâ€‹</code>â€‹â€‹æ–‡ä»¶ï¼Œè€Œæ— éœ€è§¦åŠâ€‹<code>â€‹ReloadingTestâ€‹</code>â€‹æ–‡ä»¶ï¼š</p>
<p>Dependency.groovy</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dependency</span> {
    <span class="hljs-type">String</span> message = <span class="hljs-string">'Hello, dependency 2'</span>
}
</code></pre>
<p>ä½ åº”è¯¥è§‚å¯Ÿåˆ°ä¾èµ–æ–‡ä»¶å·²é‡æ–°åŠ è½½ï¼š</p>
<p>Hello, dependency 1!...Hello, dependency 2!Hello, dependency 2!</p>
<h4 data-id="heading-7">1.5. CompilationUnit</h4>
<p>æœ€ç»ˆï¼Œé€šè¿‡ç›´æ¥ä¾èµ–â€‹<code>â€‹org.codehaus.groovy.control.CompilationUnitâ€‹</code>â€‹ç±»ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æœŸé—´æ‰§è¡Œæ›´å¤šæ“ä½œã€‚è¯¥ç±»è´Ÿè´£ç¡®å®šç¼–è¯‘çš„å„ä¸ªæ­¥éª¤ï¼Œå¹¶å…è®¸ä½ å¼•å…¥æ–°æ­¥éª¤ï¼Œç”šè‡³åœ¨å„ä¸ªé˜¶æ®µåœæ­¢ç¼–è¯‘ã€‚ä¾‹å¦‚ï¼Œå¯¹äºè”åˆç¼–è¯‘å™¨ï¼Œå­˜æ ¹ç”Ÿæˆæ˜¯å¦‚ä½•å®Œæˆçš„ã€‚</p>
<p>ä½†æ˜¯ï¼Œä¸å»ºè®®è¦†ç›–â€‹<code>â€‹CompilationUnitâ€‹</code>â€‹ï¼Œåªæœ‰åœ¨æ²¡æœ‰å…¶ä»–æ ‡å‡†è§£å†³æ–¹æ¡ˆæœ‰æ•ˆçš„æƒ…å†µä¸‹æ‰åº”è¯¥è¿™æ ·åšã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•‘å‘½ï¼Spring å¯åŠ¨åˆå´©äº†ï¼Ÿï¼å¾ªç¯ä¾èµ–åˆè¸©å‘]]></title>    <link>https://juejin.cn/post/7573523709300408355</link>    <guid>https://juejin.cn/post/7573523709300408355</guid>    <pubDate>2025-11-17T15:58:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573523709300408355" data-draft-id="7573512056089608227" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•‘å‘½ï¼Spring å¯åŠ¨åˆå´©äº†ï¼Ÿï¼å¾ªç¯ä¾èµ–åˆè¸©å‘"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-17T15:58:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç§§æ­Œstar519"/> <meta itemprop="url" content="https://juejin.cn/user/2385260356310428"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•‘å‘½ï¼Spring å¯åŠ¨åˆå´©äº†ï¼Ÿï¼å¾ªç¯ä¾èµ–åˆè¸©å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2385260356310428/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç§§æ­Œstar519
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T15:58:10.000Z" title="Mon Nov 17 2025 15:58:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¾ªç¯ä¾èµ–é—®é¢˜ï¼šå½“å¾ªç¯ä¾èµ–é‡ä¸Š AOP</h2>
<p>æœ€è¿‘å·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªä¸šåŠ¡åœºæ™¯ï¼šæ•™å¸ˆä¿®æ”¹è¯•å·çš„æ­£ç¡®ç­”æ¡ˆåï¼Œç³»ç»Ÿéœ€è¦<strong>å¼‚æ­¥é‡æ–°æ‰¹æ”¹</strong>æ‰€æœ‰å­¦ç”Ÿå·²æäº¤çš„ç­”æ¡ˆã€‚</p>
<ul>
<li>ä¸»æœåŠ¡ï¼ˆå®ç°ç±» Aï¼‰è´Ÿè´£æ›´æ–°æ ‡å‡†ç­”æ¡ˆå¹¶è§¦å‘å¼‚æ­¥ä»»åŠ¡ï¼›</li>
<li>å¼‚æ­¥æœåŠ¡ï¼ˆæœåŠ¡ Bï¼‰æ‰§è¡Œæ‰¹é‡é‡åˆ¤ï¼Œå¹¶è°ƒç”¨ A ä¸­çš„è¾…åŠ©æ–¹æ³•ï¼ˆå¦‚åˆ¤æ–­ç­”æ¡ˆæ­£è¯¯ã€è®¡ç®—å¾—åˆ†ç­‰ï¼‰ã€‚</li>
</ul>
<p>ç»“æœåº”ç”¨å¯åŠ¨æ—¶æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">BeanCurrentlyInCreationException:</span> 
Requested bean <span class="hljs-built_in">is</span> currently <span class="hljs-keyword">in</span> creation: 
<span class="hljs-built_in">Is</span> there an unresolvable circular reference?
</code></pre>
<p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ <strong>å¾ªç¯ä¾èµ– + AOPï¼ˆ@Async / @Transactionalï¼‰</strong> é—®é¢˜ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼ŒSpring èƒ½é€šè¿‡ä¸‰çº§ç¼“å­˜è§£å†³æ™®é€šå¾ªç¯ä¾èµ–ï¼Œä½†ä¸€æ—¦æ¶‰åŠ AOPï¼Œå°±æ— èƒ½ä¸ºåŠ›äº†ã€‚ä¸‹é¢æˆ‘å°†ä»åŸç†åˆ°å®è·µå®Œæ•´æ¢³ç†è¿™ä¸ªé—®é¢˜çš„æ¥é¾™å»è„‰å’Œå¯è¡Œçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<hr/>
<h3 data-id="heading-1">æ ¹æœ¬åŸå› ï¼šAOP ä»£ç†ä¸ä¸‰çº§ç¼“å­˜çš„å†²çª</h3>
<p>è¦ç†è§£ä¸ºä»€ä¹ˆå¤±è´¥ï¼Œå¿…é¡»å…ˆææ¸…æ¥š <strong>Spring çš„ä»£ç†æœºåˆ¶</strong> å’Œ <strong>Bean åˆ›å»ºæµç¨‹</strong>ã€‚</p>
<h4 data-id="heading-2">Spring AOP ä»£ç†æœºåˆ¶è¯¦è§£</h4>
<h5 data-id="heading-3">ä»€ä¹ˆæ˜¯ä»£ç†å¯¹è±¡ï¼Ÿ</h5>
<ul>
<li><strong>ç›®æ ‡å¯¹è±¡ï¼ˆTargetï¼‰</strong>ï¼šä½ å†™çš„å®ç°ç±»å®ä¾‹ï¼ˆå¦‚ <code>OrderService</code>ï¼‰ã€‚</li>
<li><strong>ä»£ç†å¯¹è±¡ï¼ˆProxyï¼‰</strong>ï¼šSpring åŠ¨æ€ç”Ÿæˆçš„ä¸€ä¸ªâ€œåŒ…è£…ç±»â€ï¼Œå¤–è§‚ä¸ç›®æ ‡å¯¹è±¡ä¸€è‡´ï¼ˆå®ç°ç›¸åŒæ¥å£æˆ–ç»§æ‰¿ç›¸åŒçˆ¶ç±»ï¼‰ï¼Œä½†æ–¹æ³•è°ƒç”¨ä¼šè¢«æ‹¦æˆªï¼Œåœ¨å‰åæ’å…¥é¢å¤–é€»è¾‘ï¼ˆå¦‚äº‹åŠ¡ã€å¼‚æ­¥ã€æ—¥å¿—ç­‰ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">placeOrder</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ‰£åº“å­˜</span>
        <span class="hljs-comment">// å»ºè®¢å•</span>
        <span class="hljs-comment">// æ‰£æ¬¾</span>
    }
}
</code></pre>
<p>å…¶è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Client
    participant Proxy as ä»£ç†å¯¹è±¡
    participant Target as åŸå§‹OrderService

    Client-&gt;&gt;Proxy: placeOrder()
    Proxy-&gt;&gt;Proxy: AOPæ£€æŸ¥ â†’ å¼€å¯æ•°æ®åº“äº‹åŠ¡
    Proxy-&gt;&gt;Target: è°ƒç”¨åŸå§‹placeOrder()æ–¹æ³•
    Target--&gt;&gt;Proxy: æ–¹æ³•æ‰§è¡Œå®Œæ¯•
    Proxy-&gt;&gt;Proxy: æäº¤/å›æ»šäº‹åŠ¡
    Proxy--&gt;&gt;Client: è¿”å›ç»“æœ
</code></pre>
<h5 data-id="heading-4">Spring çš„ä¸¤ç§ä»£ç†æ–¹å¼</h5>




















<table><thead><tr><th>ä»£ç†ç±»å‹</th><th>è§¦å‘æ¡ä»¶</th><th>å®ç°æ–¹å¼</th></tr></thead><tbody><tr><td>JDK åŠ¨æ€ä»£ç†</td><td>ç›®æ ‡ç±»å®ç°äº†è‡³å°‘ä¸€ä¸ªæ¥å£</td><td>ç”Ÿæˆ <code>$Proxy0</code> ç±»ï¼Œå®ç°ç›¸åŒæ¥å£ï¼Œé€šè¿‡ <code>InvocationHandler.invoke()</code> æ‹¦æˆª</td></tr><tr><td>CGLIB ä»£ç†</td><td>ç›®æ ‡ç±»æ²¡æœ‰æ¥å£</td><td>ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»ï¼Œé‡å†™é <code>final</code> æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­æ’å…¥æ‹¦æˆªé€»è¾‘</td></tr></tbody></table>
<blockquote>
<p>JDK ä»£ç†æ˜¯â€œå…„å¼Ÿå…³ç³»â€ï¼ˆåŒæ¥å£ï¼‰ï¼ŒCGLIB æ˜¯â€œçˆ¶å­å…³ç³»â€ï¼ˆç»§æ‰¿ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-5">ä»£ç†å¯¹è±¡ä½•æ—¶åˆ›å»ºï¼Ÿ</h4>
<p>Spring åœ¨å¯åŠ¨æ—¶ä¼šæ‰«ææ‰€æœ‰ Beanï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å« AOP æ³¨è§£ï¼ˆå¦‚ <code>@Async</code>ã€<code>@Transactional</code>ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹ç”± <strong>BeanPostProcessorï¼ˆåç½®å¤„ç†å™¨ï¼‰</strong> å®Œæˆï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><code>AsyncAnnotationBeanPostProcessor</code>ï¼ˆå¤„ç† <code>@Async</code>ï¼‰</li>
<li><code>InfrastructureAdvisorAutoProxyCreator</code>ï¼ˆå¤„ç† <code>@Transactional</code> ç­‰ï¼‰</li>
</ul>
<p>å®ƒä»¬ä¼šåœ¨ <strong>Bean åˆå§‹åŒ–é˜¶æ®µï¼ˆpost-processï¼‰</strong> åˆ¤æ–­ï¼š</p>
<ul>
<li>ç±»æˆ–æ–¹æ³•ä¸Šæ˜¯å¦æœ‰ AOP æ³¨è§£ï¼Ÿ</li>
<li>æ˜¯å¦å¯ç”¨äº†ç›¸å…³åŠŸèƒ½ï¼ˆå¦‚ <code>@EnableAsync</code>ï¼‰ï¼Ÿ</li>
<li>åº”è¯¥ä½¿ç”¨ JDK è¿˜æ˜¯ CGLIB ä»£ç†ï¼Ÿ</li>
</ul>
<p><strong>å…³é”®ç‚¹</strong>ï¼š<br/>
<strong>ä»£ç†å¯¹è±¡çš„åˆ›å»ºä¸èƒ½åœ¨æ„é€ å‡½æ•°é˜¶æ®µå®Œæˆ</strong>ï¼Œå› ä¸ºï¼š</p>
<ul>
<li>æ³¨è§£å…ƒæ•°æ®éœ€é€šè¿‡åå°„è¯»å–ï¼›</li>
<li>ä»£ç†ç±»å‹éœ€æ ¹æ®ç±»ç»“æ„åŠ¨æ€å†³å®šï¼›</li>
<li>AOP é…ç½®ï¼ˆå¦‚åˆ‡é¢è¡¨è¾¾å¼ï¼‰ä¹Ÿéœ€åœ¨åˆå§‹åŒ–åæ‰èƒ½è¯„ä¼°ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œ<strong>ä»£ç†å¯¹è±¡æ˜¯åœ¨ Bean å®ä¾‹åŒ– + å±æ€§å¡«å…… + åˆå§‹åŒ–å®Œæˆåæ‰ç”Ÿæˆçš„</strong>ã€‚</p>
<hr/>
<h4 data-id="heading-6">ä¸‰çº§ç¼“å­˜æœºåˆ¶ï¼ˆæ—  AOP åœºæ™¯ï¼‰</h4>
<p>å¯¹äºæ™®é€šå•ä¾‹ Beanï¼ŒSpring ä½¿ç”¨ä¸‰çº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–ï¼š</p>
<ul>
<li><strong>ä¸€çº§ç¼“å­˜ï¼ˆ<code>singletonObjects</code>ï¼‰</strong>ï¼šå­˜æ”¾å®Œå…¨åˆå§‹åŒ–å¥½çš„ Beanã€‚</li>
<li><strong>äºŒçº§ç¼“å­˜ï¼ˆ<code>earlySingletonObjects</code>ï¼‰</strong>ï¼šå­˜æ”¾â€œæ—©æœŸå¼•ç”¨â€ï¼ˆå·²å®ä¾‹åŒ–ï¼Œæœªåˆå§‹åŒ–ï¼‰ã€‚</li>
<li><strong>ä¸‰çº§ç¼“å­˜ï¼ˆ<code>singletonFactories</code>ï¼‰</strong>ï¼šå­˜æ”¾ <code>ObjectFactory</code>ï¼Œç”¨äºæŒ‰éœ€ç”Ÿæˆæ—©æœŸå¼•ç”¨ã€‚</li>
</ul>
<blockquote>
<p>æ ¸å¿ƒæ€æƒ³ï¼šå…è®¸åœ¨ Bean å°šæœªå®Œå…¨åˆå§‹åŒ–å‰ï¼Œå°†å…¶â€œåŸå§‹å¯¹è±¡â€æå‰æš´éœ²ç»™å…¶ä»–ä¾èµ–æ–¹ã€‚</p>
</blockquote>
<h5 data-id="heading-7">æ™®é€šå¾ªç¯ä¾èµ–è§£å†³æµç¨‹ï¼ˆA â†’ Bï¼ŒB â†’ Aï¼‰</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Spring as Springå®¹å™¨
    participant A as Service A (QuestionAnswerService)
    participant B as Service B (AsyncRegradeTaskService)

    Spring-&gt;&gt;A: 1. åˆ›å»º Aï¼ˆnewï¼‰
    A--&gt;&gt;Spring: 2. å°† A çš„ ObjectFactory æ”¾å…¥ä¸‰çº§ç¼“å­˜
    Spring-&gt;&gt;A: 3. å¡«å…… A å±æ€§ â†’ éœ€è¦ B
    Spring-&gt;&gt;B: 4. åˆ›å»º Bï¼ˆnewï¼‰
    B--&gt;&gt;Spring: 5. å°† B çš„ ObjectFactory æ”¾å…¥ä¸‰çº§ç¼“å­˜
    Spring-&gt;&gt;B: 6. å¡«å…… B å±æ€§ â†’ éœ€è¦ A
    Spring-&gt;&gt;Spring: 7. ä»ä¸‰çº§ç¼“å­˜è·å– A çš„å·¥å‚
    Spring-&gt;&gt;A: 8. è°ƒç”¨ factory.getObject() â†’ è·å–åŸå§‹ A
    Spring--&gt;&gt;B: 9. å°†åŸå§‹ A æ³¨å…¥ B
    B--&gt;&gt;Spring: 10. B åˆå§‹åŒ–å®Œæˆ â†’ æ”¾å…¥ä¸€çº§ç¼“å­˜
    Spring--&gt;&gt;A: 11. å°†å®Œæ•´ B æ³¨å…¥ A
    A--&gt;&gt;Spring: 12. A åˆå§‹åŒ–å®Œæˆ â†’ æ”¾å…¥ä¸€çº§ç¼“å­˜

    Note right of Spring: âœ… å¾ªç¯ä¾èµ–æˆåŠŸè§£å†³
</code></pre>
<p>æˆåŠŸçš„å…³é”®ï¼š<strong>æ³¨å…¥çš„æ˜¯åŸå§‹å¯¹è±¡ï¼ˆraw instanceï¼‰</strong>ï¼Œä¸éœ€è¦ä»£ç†ã€‚</p>
<hr/>
<h4 data-id="heading-8">å« AOP çš„å¾ªç¯ä¾èµ–ä¸ºä½•å¤±è´¥ï¼Ÿ</h4>
<p>å½“ B å¸¦æœ‰ <code>@Async</code>ï¼ˆæˆ– <code>@Transactional</code>ï¼‰æ—¶ï¼ŒSpring å¿…é¡»ä¸ºå…¶åˆ›å»º <strong>ä»£ç†å¯¹è±¡</strong>ã€‚ä½†ä»£ç†åªèƒ½åœ¨ B <strong>å®Œå…¨åˆå§‹åŒ–å</strong>ç”Ÿæˆã€‚</p>
<p>è€Œåœ¨å¾ªç¯ä¾èµ–ä¸­ï¼š</p>
<ul>
<li>A åˆ›å»ºæ—¶éœ€è¦ Bï¼›</li>
<li>B åˆ›å»ºæ—¶éœ€è¦ Aï¼›</li>
<li>Spring è¯•å›¾ä»ä¸‰çº§ç¼“å­˜ä¸­æä¾› B çš„â€œæ—©æœŸå¼•ç”¨â€ â†’ ä½†æ­¤æ—¶åªæœ‰ <strong>åŸå§‹ B</strong>ï¼Œæ²¡æœ‰ <strong>ä»£ç† B</strong>ï¼›</li>
<li>A æ³¨å…¥çš„æ˜¯åŸå§‹ Bï¼Œè°ƒç”¨ <code>@Async</code> æ–¹æ³•æ—¶ <strong>ä¸ä¼šè§¦å‘å¼‚æ­¥</strong>ï¼ˆå› ä¸ºæ²¡èµ°ä»£ç†ï¼‰ï¼›</li>
<li>æ›´ä¸¥é‡çš„æ˜¯ï¼š<strong>Spring åœ¨åˆ›å»º B æ—¶å‘ç°å®ƒéœ€è¦ä»£ç†ï¼Œä½†åˆæ— æ³•åœ¨â€œåŠæˆå“â€é˜¶æ®µç”Ÿæˆä»£ç†</strong> â†’ æŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
<h5 data-id="heading-9">å« AOP çš„å¾ªç¯ä¾èµ–å¤±è´¥æµç¨‹</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Spring as Springå®¹å™¨
    participant A as Service A
    participant B as Service B (@Async)

    Spring-&gt;&gt;A: 1. åˆ›å»º Aï¼ˆnewï¼‰
    A--&gt;&gt;Spring: 2. A çš„å·¥å‚æ”¾å…¥ä¸‰çº§ç¼“å­˜
    Spring-&gt;&gt;A: 3. å¡«å…… A å±æ€§ â†’ éœ€è¦ B
    Spring-&gt;&gt;B: 4. åˆ›å»º Bï¼ˆnewï¼‰
    B--&gt;&gt;Spring: 5. B çš„å·¥å‚æ”¾å…¥ä¸‰çº§ç¼“å­˜
    Spring-&gt;&gt;B: 6. å¡«å…… B å±æ€§ â†’ éœ€è¦ A
    Spring-&gt;&gt;Spring: 7. ä»ä¸‰çº§ç¼“å­˜è·å– A çš„åŸå§‹å¯¹è±¡
    Spring--&gt;&gt;B: 8. å°†åŸå§‹ A æ³¨å…¥ B
    Spring-&gt;&gt;B: 9. B åˆå§‹åŒ– â†’ éœ€ä¸º @Async åˆ›å»ºä»£ç†
    Note over Spring,B: âš ï¸ ä»£ç†åˆ›å»ºéœ€ B å®Œæ•´ï¼Œä½† B å°šæœªå®Œæˆï¼
    Spring-&gt;&gt;A: 10. A ç»§ç»­åˆå§‹åŒ– â†’ éœ€è¦å®Œæ•´ B
    Spring-&gt;&gt;B: 11. è¯·æ±‚ B å®ä¾‹
    Note over Spring: B ä»åœ¨åˆ›å»ºä¸­ â†’ å¾ªç¯ä¾èµ–æœªè§£
    Spring--&gt;&gt;A: 12. æŠ›å‡º BeanCurrentlyInCreationException

    Note right of Spring: âŒ å¯åŠ¨å¤±è´¥ï¼šæ— æ³•ç”Ÿæˆ B çš„ä»£ç†
</code></pre>
<blockquote>
<p>å³ä½¿ A ä¸å¸¦ AOPï¼Œåªè¦ B å¸¦ <code>@Async</code>ï¼Œä¸”äº’ç›¸ä¾èµ–ï¼Œå°±ä¼šå¤±è´¥ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-10">ä»£ç ç¤ºä¾‹</h3>
<h4 data-id="heading-11">ä¸»æœåŠ¡ï¼ˆService Aï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QuestionAnswerService</span> { <span class="hljs-comment">// â† A</span>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AsyncRegradeTaskService asyncTaskService; <span class="hljs-comment">// ä¾èµ– B</span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">modifyStandardAnswer</span><span class="hljs-params">(AnswerUpdateRequest request)</span> {
        updateStandardAnswerInDB(request);
        asyncTaskService.regradeAllSubmissionsAsync(request.getQuestionId(), request.getGroupId());
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateStandardAnswerInDB</span><span class="hljs-params">(AnswerUpdateRequest request)</span> {
        <span class="hljs-comment">// DB æ›´æ–°</span>
    }

    <span class="hljs-comment">// è¢«å¼‚æ­¥æœåŠ¡è°ƒç”¨çš„è¾…åŠ©æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">evaluateSubmission</span><span class="hljs-params">(String studentAnswer, String correctAnswer)</span> {
        <span class="hljs-keyword">return</span> studentAnswer.equals(correctAnswer);
    }
}
</code></pre>
<h4 data-id="heading-12">å¼‚æ­¥æœåŠ¡ï¼ˆService Bï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncRegradeTaskService</span> { <span class="hljs-comment">// â† B</span>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> QuestionAnswerService mainService; <span class="hljs-comment">// ä¾èµ– A</span>

    <span class="hljs-meta">@Async</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;Void&gt; <span class="hljs-title function_">regradeAllSubmissionsAsync</span><span class="hljs-params">(Long questionId, Long groupId)</span> {
        List&lt;UserSubmission&gt; submissions = fetchSubmissions(questionId, groupId);
        <span class="hljs-keyword">for</span> (UserSubmission sub : submissions) {
            <span class="hljs-type">boolean</span> <span class="hljs-variable">correct</span> <span class="hljs-operator">=</span> mainService.evaluateSubmission(sub.getContent(), getCorrectAnswer(questionId));
            <span class="hljs-comment">// ...</span>
        }
        <span class="hljs-keyword">return</span> CompletableFuture.completedFuture(<span class="hljs-literal">null</span>);
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-13">è§£å†³æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ <code>@Lazy</code>ï¼ˆä¸´æ—¶ä¿®å¤ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QuestionAnswerService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-meta">@Lazy</span> <span class="hljs-comment">// ğŸ‘ˆ å»¶è¿ŸåŠ è½½</span>
    <span class="hljs-keyword">private</span> AsyncRegradeTaskService asyncTaskService;
}
</code></pre>
<blockquote>
<p><strong>æ·±å…¥ç†è§£ï¼šä¸ºä»€ä¹ˆ <code>@Lazy</code> èƒ½è§£å†³ AOP å¾ªç¯ä¾èµ–ï¼Ÿ</strong></p>
<p>è¡¨é¢ä¸Šçœ‹ï¼Œ<code>@Lazy</code> å’Œä¸‰çº§ç¼“å­˜éƒ½æ¶‰åŠâ€œéç›´æ¥æ³¨å…¥çœŸå®å¯¹è±¡â€ï¼Œä½†å®ƒä»¬çš„æœºåˆ¶å’Œç›®çš„æˆªç„¶ä¸åŒï¼š</p>
<ul>
<li><strong>ä¸‰çº§ç¼“å­˜</strong> åœ¨ Bean åˆ›å»ºè¿‡ç¨‹ä¸­æš´éœ²ä¸€ä¸ª<strong>åŸå§‹å¯¹è±¡ï¼ˆraw instanceï¼‰</strong>ï¼Œç”¨äºè§£å†³æ™®é€šå¾ªç¯ä¾èµ–ï¼›</li>
<li><strong><code>@Lazy</code></strong> åˆ™æ³¨å…¥ä¸€ä¸ª<strong>æ‡’åŠ è½½ä»£ç†ï¼ˆlazy proxyï¼‰</strong>ï¼Œè¯¥ä»£ç†åœ¨é¦–æ¬¡æ–¹æ³•è°ƒç”¨æ—¶æ‰ä»å®¹å™¨è·å–çœŸå® Beanã€‚</li>
</ul>
<p>é—®é¢˜çš„å…³é”®åœ¨äºï¼š<strong>Spring çš„ AOP ä»£ç†ï¼ˆå¦‚ <code>@Async</code>ï¼‰å¿…é¡»åœ¨ç›®æ ‡ Bean å®Œå…¨åˆå§‹åŒ–åæ‰èƒ½åˆ›å»º</strong>ã€‚è€Œåœ¨å¾ªç¯ä¾èµ–åœºæ™¯ä¸­ï¼Œè‹¥ä¸¤ä¸ª Bean äº’ç›¸ä¾èµ–ä¸”å…¶ä¸­ä¸€æ–¹éœ€ä»£ç†ï¼ŒSpring å°±æ— æ³•åœ¨â€œåŠæˆå“â€é˜¶æ®µæä¾›æœ‰æ•ˆçš„ä»£ç†å¯¹è±¡â€”â€”ä¸‰çº§ç¼“å­˜åªèƒ½æä¾›åŸå§‹å¯¹è±¡ï¼Œè€ŒåŸå§‹å¯¹è±¡ä¸å…·å¤‡ AOP è¡Œä¸ºã€‚</p>
<p><code>@Lazy</code> çš„å·§å¦™ä¹‹å¤„åœ¨äºï¼š<strong>å®ƒå°†ä¾èµ–çš„è§£ææ—¶æœºä»â€œBean åˆ›å»ºæœŸâ€æ¨è¿Ÿåˆ°â€œæ–¹æ³•é¦–æ¬¡è°ƒç”¨æœŸâ€</strong>ã€‚æ­¤æ—¶ï¼Œè¢«ä¾èµ–çš„ Bean å·²ç»å®Œæˆåˆå§‹åŒ–å¹¶å­˜åœ¨äºä¸€çº§ç¼“å­˜ä¸­ï¼Œå…¶ä»£ç†ä¹Ÿå·²ç”Ÿæˆï¼Œä»è€Œå®‰å…¨åœ°æ»¡è¶³ AOP è¦æ±‚ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œ<code>@Lazy</code> å¹¶æ²¡æœ‰æ”¹å˜ AOP å¯¹â€œå®Œæ•´å¯¹è±¡â€çš„éœ€æ±‚ï¼Œè€Œæ˜¯<strong>ç»•å¼€äº†åˆ›å»ºé˜¶æ®µçš„ä¾èµ–æ­»é”</strong>ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-14">è§£å†³æ–¹æ¡ˆäºŒï¼šé‡æ„è®¾è®¡ï¼ˆæ¨èé•¿æœŸæ–¹æ¡ˆï¼‰</h3>
<p>æŠ½å–å…¬å…±é€»è¾‘åˆ°ç‹¬ç«‹æœåŠ¡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GradingLogicService</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">evaluateSubmission</span><span class="hljs-params">(String studentAnswer, String correctAnswer)</span> {
        <span class="hljs-keyword">return</span> studentAnswer.equals(correctAnswer);
    }
}
</code></pre>
<ul>
<li>A å’Œ B éƒ½ä¾èµ– <code>GradingLogicService</code>ï¼›</li>
<li>å½»åº•æ¶ˆé™¤ A â†” B çš„åŒå‘ä¾èµ–ã€‚</li>
</ul>
<p>âœ… ä»£ç æ›´æ¸…æ™°ã€å¯æµ‹è¯•ã€å¯ç»´æŠ¤ã€‚</p>
<hr/>
<h3 data-id="heading-15">è¡¥å……ï¼šå…³äº Spring ä»£ç†çš„ä¸¤ä¸ªå¸¸è§è¯¯åŒº</h3>
<h4 data-id="heading-16">1. åªæœ‰å®¹å™¨ç®¡ç†çš„å¯¹è±¡æ‰æ˜¯ä»£ç†</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ­£ç¡®</span>
<span class="hljs-type">OrderService</span> <span class="hljs-variable">service</span> <span class="hljs-operator">=</span> context.getBean(OrderService.class); <span class="hljs-comment">// ä»£ç†</span>

<span class="hljs-comment">// é”™è¯¯</span>
<span class="hljs-type">OrderService</span> <span class="hljs-variable">service</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderService</span>(); <span class="hljs-comment">// æ— ä»£ç†ï¼Œ@Transactional å¤±æ•ˆ</span>
</code></pre>
<h4 data-id="heading-17">2. åŒç±»æ–¹æ³•è°ƒç”¨ç»•è¿‡ä»£ç†</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyService</span> {
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodA</span><span class="hljs-params">()</span> { ... }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodB</span><span class="hljs-params">()</span> {
        methodA(); <span class="hljs-comment">// this.methodA()ï¼Œä¸èµ°ä»£ç†ï¼Œäº‹åŠ¡å¤±æ•ˆï¼</span>
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-18">æ€»ç»“</h3>




















<table><thead><tr><th>åœºæ™¯</th><th>Spring èƒ½å¦è§£å†³å¾ªç¯ä¾èµ–</th><th>åŸå› </th></tr></thead><tbody><tr><td>æ™®é€šå•ä¾‹ Beanï¼ˆæ—  AOPï¼‰</td><td>âœ… èƒ½</td><td>ä¸‰çº§ç¼“å­˜æä¾›åŸå§‹å¯¹è±¡ä½œä¸ºæ—©æœŸå¼•ç”¨</td></tr><tr><td>å« <code>@Async</code> / <code>@Transactional</code> çš„ Bean</td><td>âŒ ä¸èƒ½</td><td>ä»£ç†éœ€å®Œæ•´å¯¹è±¡ï¼Œä½†å¾ªç¯ä¾èµ–è¦æ±‚æå‰æš´éœ²â€œåŠæˆå“â€</td></tr></tbody></table>
<h4 data-id="heading-19">æœ€ä½³å®è·µå»ºè®®ï¼š</h4>
<ul>
<li>ä¼˜å…ˆé€šè¿‡ <strong>èŒè´£æ‹†åˆ† + æœåŠ¡æŠ½å–</strong> æ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼›</li>
<li>ä¸´æ—¶æ–¹æ¡ˆå¯ç”¨ <code>@Lazy</code>ï¼Œä½†ä¸å®œé•¿æœŸä¾èµ–ï¼›</li>
<li>é¿å…åœ¨ Service å†…éƒ¨ç›´æ¥è°ƒç”¨è‡ªèº«å¸¦ AOP çš„æ–¹æ³•ï¼›</li>
<li>æ‰€æœ‰ Service å¿…é¡»ç”± Spring å®¹å™¨ç®¡ç†ï¼Œç¦æ­¢ <code>new</code>ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-20">ç»éªŒæ€»ç»“</h3>
<blockquote>
<p>â€œèƒ½ç”¨ <code>@Lazy</code> è§£å†³çš„é—®é¢˜ï¼Œå¾€å¾€è¯´æ˜ä½ çš„æ¨¡å—è€¦åˆå¤ªç´§ã€‚â€<br/>
â€”â€” å¥½çš„è®¾è®¡ï¼Œæœ¬å°±ä¸è¯¥æœ‰å¾ªç¯ä¾èµ–ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[uniappæºç è§£æï¼ˆVue3/Viteç‰ˆï¼‰]]></title>    <link>https://juejin.cn/post/7573524348129116223</link>    <guid>https://juejin.cn/post/7573524348129116223</guid>    <pubDate>2025-11-17T10:55:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573524348129116223" data-draft-id="7572389069705707530" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="uniappæºç è§£æï¼ˆVue3/Viteç‰ˆï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,uni-app"/> <meta itemprop="datePublished" content="2025-11-17T10:55:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤ç›®å‹äººçˆ±åƒè±†è…"/> <meta itemprop="url" content="https://juejin.cn/user/550207995511645"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            uniappæºç è§£æï¼ˆVue3/Viteç‰ˆï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/550207995511645/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤ç›®å‹äººçˆ±åƒè±†è…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T10:55:00.000Z" title="Mon Nov 17 2025 10:55:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">èƒŒæ™¯</h3>
<p>é¡¹ç›®ä¸­é‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œè·¯ç”±ä¸å†™åœ¨pages.jsonæ–‡ä»¶ä¸­ï¼Œéœ€è¦åœ¨è§£æpages.jsonæ–‡ä»¶å‰ï¼ŒæŠŠå†™åœ¨å…¶ä»–åœ°æ–¹çš„è·¯ç”±ï¼Œå¤åˆ¶åˆ°pages.jsonä¸­ã€‚</p>
<p>å› æ­¤æˆ‘éœ€è¦äº†è§£uniappä¸­pages.jsonçš„è§£æé€»è¾‘ï¼Œå€Ÿæ­¤æœºä¼šï¼Œæ­£å¥½è§£æä¸€ä¸‹uniappçš„viteæ¡†æ¶æºç ï¼Œæèµ·æèµ·ã€‚</p>
<h3 data-id="heading-1">æ­¥éª¤ä¸€ uniå‘½ä»¤åšäº†ä»€ä¹ˆï¼Ÿ</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41767c8295dc418ba05571c15471ccaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSP55uu5Y-L5Lq654ix5ZCD6LGG6IWQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763981699&amp;x-signature=NdYQvyYskE3PDQ1R9hvXA4FePx0%3D" alt="image.png" loading="lazy"/></p>
<p>æŒ‰ç…§<a href="https://link.juejin.cn?target=https%3A%2F%2Funiapp.dcloud.net.cn%2Fquickstart-cli.html" target="_blank" title="https://uniapp.dcloud.net.cn/quickstart-cli.html" ref="nofollow noopener noreferrer">uniappå®˜æ–¹æ•™ç¨‹</a>ï¼Œåˆ›å»ºuniapp-viteæ–°é¡¹ç›®=ã€‹pnpm iå®‰è£…ä¾èµ–</p>
<h5 data-id="heading-2">æ‰¾"dev:h5": "uni"çš„å‘½ä»¤</h5>
<p>sciptsçš„æ‰§è¡Œè·¯å¾„åœ¨node_modules/.binã€‚æ‰¾åˆ°uni.CMD(windowç³»ç»Ÿæ˜¯è¿™ä¸ªï¼‰ï¼Œåœ¨uni.CMDä¸­ï¼Œæ‰¾åˆ°æ‰§è¡Œæ–‡ä»¶æ˜¯\node_modules@dcloudio\vite-plugin-uni\bin\uni.jsã€‚uni.jsæ‰§è¡Œ../dist/cli/index.jsæ–‡ä»¶</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08ec5a70ae2343c5b3e2359c761975a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSP55uu5Y-L5Lq654ix5ZCD6LGG6IWQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763981699&amp;x-signature=kxwD%2FoReqyuKAxev7b2was8lxCs%3D" alt="image.png" loading="lazy"/></p>
<p>\node_modules@dcloudio\vite-plugin-uniceshi\dist\cli\index.jsæ˜¯æ ¸å¿ƒæ–‡ä»¶ã€‚ä¸»è¦æ˜¯å¤„ç†å‘½ä»¤ä¸­æºå¸¦çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼šæ‰“åŒ…åæ–‡ä»¶çš„ç›®å½•ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a371d7bbc3474e56a3fe38637f30aca1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSP55uu5Y-L5Lq654ix5ZCD6LGG6IWQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763981699&amp;x-signature=7M7VnapucaF8bHWVnQ%2Fdl%2B%2B7fts%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a45063365a54fe6b1778321def2f7f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSP55uu5Y-L5Lq654ix5ZCD6LGG6IWQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763981699&amp;x-signature=dOd0LMB2d9j0NaVANcqB5hAX9Dk%3D" alt="image.png" loading="lazy"/></p>
<p>ç”±äºæˆ‘æ‰§è¡Œçš„æ˜¯æœ€åŸºç¡€çš„å‘½ä»¤"dev:h5": "uni"ã€‚è¿™ä¸ªæˆ‘å¯ä»¥ä¸ç†ï¼Œç›´æ¥çœ‹é…ç½®å®Œæ–‡ä»¶åï¼Œuniappåšäº†ä»€ä¹ˆã€‚è¿½å¯»è¿‡ç¨‹ä¸èµ˜è¿°ã€‚æœ€ç»ˆæ‰§è¡Œçš„æ˜¯\node_modules@dcloudio\vite-plugin-uni\dist\cli\server.jsæ–‡ä»¶é‡Œé¢çš„createServeræ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯å¯åŠ¨äº†viteçš„æœ¬åœ°æœåŠ¡ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13d6488e12da4de6a091bd07c9fe5482~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSP55uu5Y-L5Lq654ix5ZCD6LGG6IWQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763981699&amp;x-signature=s%2BH%2FJlQQrqvBdMgW2drvRaxdBII%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æ€»ç»“:</strong>"dev:h5": "uni"å‘½ä»¤ä½œç”¨æ˜¯å°†å‘½ä»¤è¡Œçš„å‚æ•°è¿›è¡Œæ¥é…ç½®ï¼Œæœ€ç»ˆå¯åŠ¨äº†viteçš„æœåŠ¡ã€‚ç”±äº"dev:h5": "uni"å‘½ä»¤æ˜¯æœ€åŸºç¡€çš„å‘½ä»¤ï¼Œå› æ­¤å¯åŠ¨çš„ä¹Ÿæ˜¯æœ€åŸºç¡€çš„viteæœåŠ¡ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰å¯¹ä»£ç æ–‡ä»¶è¿›è¡Œä»»ä½•å¤„ç†ã€‚é‚£ä¹ˆè¯´æ˜uniappæ˜¯é€šè¿‡viteæ’ä»¶å¯¹ä»£ç æ–‡ä»¶è¿›è¡Œå¤„ç†ã€‚</p>
<h3 data-id="heading-3">æ­¥éª¤äºŒ uniappçš„viteæ’ä»¶åšäº†ä»€ä¹ˆï¼Ÿ</h3>
<p>uniappçš„viteæ’ä»¶ååˆ†ç®€å•ï¼Œvite.config.tsæ–‡ä»¶å¼•å…¥ä¸€ä¸ªvite-plugin-uniæ’ä»¶å³å¯ã€‚ä¸è¿‡éšç€æ·±å…¥æ¢ç´¢ï¼Œå‘ç°å¹¶ä¸ç®€å•ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">//vite.config.tsæ–‡ä»¶</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">"vite"</span>;
<span class="hljs-keyword">import</span> uni <span class="hljs-keyword">from</span> <span class="hljs-string">"@dcloudio/vite-plugin-uni"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>:  [<span class="hljs-title function_">uni</span>()],
});

</code></pre>
<p>æŸ¥é˜…@dcloudio/vite-plugin-uniçš„æ–‡ä»¶ï¼Œå‘ç°ç¼–è¯‘åçš„ä»£ç æœ‰ç‚¹éš¾è¯»æ‡‚ã€‚ä¸Šuniappå®˜ç½‘æ‰¾æºç ï¼Œæ²¡æ‰¾åˆ°ã€‚å®˜ç½‘æ²¡æœ‰ï¼Œé‚£å°±åœ¨GitHubæ‰¾ï¼ŒGitHubä¹Ÿæ²¡æœ‰ï¼Œé‚£å°±ä¸Šgiteeæ‰¾ã€‚æœ¬æƒ³giteeå¸Œæœ›ä¸å¤§ï¼Œæ²¡æƒ³åˆ°æºç å°±åœ¨giteeã€‚niceï¼<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fdcloud%2Funi-app" target="_blank" title="https://gitee.com/dcloud/uni-app" ref="nofollow noopener noreferrer">æºç é“¾æ¥</a></p>
<p>æˆ‘ä»…çŸ¥é“è¿™ä¸‰ä¸ªæºç æ¸ é“ï¼Œå¤§ä½¬å¦‚æœæœ‰å…¶ä»–æ¸ é“è·ªæ±‚æ¨èä¸€ä¸‹ï¼Œå¤šæ¡è·¯å­ã€‚</p>
<p>ä¸‹è½½æºç uni-app-nextã€‚æºç ç‰ˆæœ¬æ˜¯ï¼š3.0.0-alpha-4060120250328001ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„ç¤ºä¾‹ä¹Ÿpnpmæ›´æ–°åˆ°æ­¤ç‰ˆæœ¬ï¼Œé¿å…å·®å¼‚ã€‚</p>
<p>æºç pnpm iæŒ‰ç…§å®Œä¾èµ–åã€‚æˆ‘å›¾çœäº‹ï¼Œå°†vite-plugin-uniæ’ä»¶ç›´æ¥å¤åˆ¶åˆ°ç¤ºä¾‹ä»£ç ä¸Šï¼Œç›´æ¥å¼€å¹²ã€‚äº‹å®è¯æ˜æ­ªè·¯å­çœ‹èµ·æ¥çœäº‹ï¼Œå®åˆ™éº»çƒ¦æ›´å¤šã€‚å¤§å®¶åˆ«å­¦æˆ‘ï¼Œæ€»ä¹‹è¿˜æ˜¯æ­£é“å¥½ã€‚æ­£é“åº”è¯¥æ˜¯æŒ‰ç…§åˆ«äººæ’ä»¶åº“æä¾›çš„æµ‹è¯•æ–¹æ³•ï¼Œè¿›è¡Œè°ƒè¯•ã€‚å¦‚æœèˆä¸å¾—å¼ƒä¹‹å‰çš„ç¤ºä¾‹ï¼Œå¯ä»¥å°†æ•´ä¸ªç¤ºä¾‹å¤åˆ¶è¿‡å»ï¼Œç„¶åä½¿ç”¨pnpmçš„linkæ–¹æ³•ï¼Œæ”¹å˜ä¾èµ–å¼•ç”¨è·¯å¾„å³å¯ã€‚</p>
<p>ä»¥ä¸Šå‡†å¤‡å°±ç»ªåï¼Œå¼€å§‹å¯¹ç€æºç ï¼Œè§£ævite-plugin-uniæ’ä»¶ã€‚
æ’ä»¶è·¯å¾„ï¼špackages\vite-plugin-uni\src\index.ts</p>
<p>å…ˆæ‰“å°æ’ä»¶æœ€ç»ˆçš„ç»“æœçœ‹çœ‹ã€‚å‘ç°vite-plugin-uniæœ€ç»ˆåˆ†è£‚å‡ºäº†ä¸€å †æ’ä»¶ã€‚æˆ‘çš„æ€è·¯æ˜¯ï¼šæŸ¥çœ‹æ˜¯å¦‚ä½•åˆ†è£‚å‡ºæ¥çš„ï¼Œç„¶åæ ¹æ®æˆ‘ç°åœ¨çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæ‰¾åˆ°pages.jsonçš„å¤„ç†æ’ä»¶ï¼Œäº†è§£å…¶åŸç†çœ‹çœ‹æ€ä¹ˆè°ƒæ•´ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/290f792cf6e74a978afee00907f5139a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSP55uu5Y-L5Lq654ix5ZCD6LGG6IWQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763981699&amp;x-signature=h7hN8avVJae0EJPetc75pSH42g0%3D" alt="image.png" loading="lazy"/></p>
<p>å¯¹packages\vite-plugin-uni\src\index.tsè¿›è¡Œè§£è¯»ï¼Œå…¥å£æ–¹æ³•æ˜¯uniPlugin()ã€‚è¿½å¯»è·¯å¾„æ˜¯uniPlugin()=&gt;createPlugins()=&gt;./utils/plugin.tsç›®å½•=&gt;initExtraPlugins()=&gt;resolvePluginsByCliRoot()=&gt;resolvePlugins()ã€‚</p>
<p>resolvePluginsByCliRootå’ŒresolvePluginsæ–¹æ³•å°±æ˜¯vite-plugin-uniåˆ†è£‚å‡ºäº†ä¸€å †æ’ä»¶çš„å§‹ä½œä¿‘è€…ã€‚
resolvePluginsByCliRootè¯»å–é¡¹ç›®çš„package.jsonæ–‡ä»¶ï¼Œå¯¼å…¥é¡¹ç›®å…¨éƒ¨çš„ä¾èµ–ã€‚resolvePluginsæ–¹æ³•åˆ™æ˜¯ç­›é€‰å‡ºéœ€è¦ç”¨åˆ°çš„ä¾èµ–ã€‚ç­›é€‰çš„æ–¹å¼æ˜¯æ ¹æ®ä¾èµ–çš„package.jsonæ–‡ä»¶ï¼Œæ¯”å¦‚@dcloudio/uni-h5ä¾èµ–ç›®å½•ä¸‹çš„package.jsonæ–‡ä»¶ã€‚åˆ¤æ–­package.jsonå†…å®¹æ˜¯å¦å«æœ‰"uni-app"è¿™ä¸ªå­—æ®µã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"@dcloudio/uni-h5"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"3.0.0-alpha-4060120250328001"</span>
   <span class="hljs-comment">//è¿™ä¸ªå­—æ®µæ˜¯å…³é”®ï¼ï¼ï¼</span>
    <span class="hljs-comment">//è¿™ä¸ªå­—æ®µæ˜¯å…³é”®ï¼ï¼ï¼</span>
     <span class="hljs-comment">//è¿™ä¸ªå­—æ®µæ˜¯å…³é”®ï¼ï¼ï¼</span>
 <span class="hljs-string">"uni-app"</span>: {
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"uni-h5"</span>,
    <span class="hljs-string">"apply"</span>: [
      <span class="hljs-string">"app"</span>,
      <span class="hljs-string">"h5"</span>,
      <span class="hljs-string">"mp-weixin"</span>,
    ],
    <span class="hljs-string">"uvue"</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"@dcloudio/uni-cli-shared"</span>: <span class="hljs-string">"workspace:*"</span>,
    <span class="hljs-string">"detect-port"</span>: <span class="hljs-string">"^1.5.1"</span>,
    <span class="hljs-string">"express"</span>: <span class="hljs-string">"catalog:"</span>,
  }
} 
</code></pre>
<p>ç­›é€‰å‡ºå«æœ‰"uni-app"çš„ä¾èµ–åï¼Œè¿˜éœ€è¦é€šè¿‡[uni-app][apply]è¿›è¡ŒäºŒæ¬¡ç­›é€‰ã€‚æ¯”å¦‚ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œapplyå¯¹è±¡åŒ…å«"app"ï¼Œ "h5","mp-weixin"ã€‚åˆ™æ˜¯åœ¨appï¼Œh5,å¾®ä¿¡å°ç¨‹åºä¸‰ç§ç¯å¢ƒä¸‹ï¼Œéƒ½éœ€è¦è¿è¡Œæ­¤ä¾èµ–ã€‚è‹¥applyåªæœ‰â€œh5â€,åˆ™åªæœ‰ç¼–è¯‘H5æ‰ä¼šä½¿ç”¨æ­¤ä¾èµ–ã€‚</p>
<p><strong>æ€»ç»“:</strong> vite-plugin-unié™¤äº†å¯¼å…¥è‡ªèº«çš„æ’ä»¶ï¼Œè¿˜ä¼šæ ¹æ®ä¸åŒçš„è¿è¡Œç¯å¢ƒï¼ˆæ¯”å¦‚H5ï¼Œå¾®ä¿¡å°ç¨‹åºï¼‰å¯¼å…¥é¡¹ç›®package.jsonä¸­æœ‰ç‰¹æ®Šæ ‡è®°çš„ä¾èµ–ã€‚</p>
<p>è¿™æ ·çš„è®¾è®¡æ€è·¯ï¼Œå¯ä»¥ç®€åŒ–viteæ’ä»¶å¼•å…¥ï¼Œvite.config.tsæ–‡ä»¶ä¸­åªéœ€è¦å¼•å…¥ä¸€ä¸ªæ’ä»¶å³å¯ã€‚ä¸”åç»­æ›´æ–°ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§æ¨¡å—åŒ–è¿›è¡Œæ›´æ–°ï¼Œä¸éœ€è¦æŠŠå…¨éƒ¨çš„å†…å®¹éƒ½æ”¾åˆ°ä¸€ä¸ªæ’ä»¶ä¸­ã€‚vite-plugin-uniæ’ä»¶çš„ä½œç”¨æ˜¯åˆ¶å®šäº†ä¸€å¥—æ’ä»¶å¼•å…¥çš„è§„åˆ™ï¼Œå¤§å®¶å¯ä»¥æŒ‰ç…§è¿™ä¸ªè§„åˆ™å¯¼å…¥æˆ–å¼€å‘æ‰€éœ€è¦çš„æ’ä»¶ã€‚</p>
<h3 data-id="heading-4">æ­¥éª¤ä¸‰ uniappæ˜¯æ€ä¹ˆè¿ä½œçš„ï¼Ÿ</h3>
<p>ç”±äºæˆ‘è¿è¡Œçš„ç¯å¢ƒæ˜¯H5ï¼Œæˆ‘ä»…ç”¨H5è¿›è¡Œä¸¾ä¾‹ã€‚å¤§å®¶å¯æ ¹æ®æ­¤æ€è·¯ï¼Œè§£æè‡ªå·±æ‰€åœ¨è¿è¡Œç¯å¢ƒçš„æºç ã€‚</p>
<p>å†™ä¸ªç®€å•æ’ä»¶çœ‹ä¸€ä¸‹ä»£ç æ–‡ä»¶ç¼–è¯‘çš„è·¯å¾„</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Plugin</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"vite"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>): <span class="hljs-title class_">Plugin</span> {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"æµ‹è¯•æ’ä»¶"</span>,
        <span class="hljs-title function_">transform</span>(<span class="hljs-params">code, id</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æŸ¥çœ‹ç¼–è¯‘çš„æ–‡ä»¶é¡ºåºå’Œä»£ç '</span>, id, code)
        },
    };

}
</code></pre>
<p>è·¯å¾„å’Œviteçš„å…¥å£æ–‡ä»¶ä¸€è‡´ï¼Œéƒ½æ˜¯ä»@/src/main.tså¼€å§‹ã€‚main.tsç»è¿‡h5-manifest-jsonæ’ä»¶çš„ä½œç”¨ï¼Œç¼–è¯‘ç»“æœå¦‚ä¸‹å›¾ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5494bff7791f4a7cacea6061493efc03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSP55uu5Y-L5Lq654ix5ZCD6LGG6IWQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763981699&amp;x-signature=TKjN9gOU2Yf5%2FaGJR%2F3oPtSNiPo%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°h5-manifest-jsonæ’ä»¶é™¤äº†å¢åŠ äº†ä¸€äº›é…ç½®å¤–ï¼Œè¿˜å¼•å…¥äº†pages.jsonæ–‡ä»¶ï¼Œè¿™æ­£æ˜¯æˆ‘æƒ³äº†è§£çš„éƒ¨åˆ†ã€‚</p>
<p>ç¿»é˜…äº†ä¸€ä¸‹æºç ï¼Œæ‰¾åˆ°äº†å¤„ç†pages.jsonçš„æ’ä»¶æ˜¯uni:h5-pages-jsonã€‚è¿™æ’ä»¶çš„ä½œç”¨å¤§æ¦‚æ˜¯åŠ å…¥äº†å„ç§å…¨å±€çš„æ–¹æ³•ã€æ ·å¼ã€å˜é‡ç­‰ï¼ŒæŠŠpages.jsonçš„è·¯å¾„ï¼Œè½¬æ¢æˆé¡µé¢çš„è·¯ç”±ã€‚æ’ä»¶ç¼–è¯‘ç»“æœå¦‚ä¸‹å›¾ï¼šï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7a05e15963b4093bdb7c49624cde55e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSP55uu5Y-L5Lq654ix5ZCD6LGG6IWQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763981699&amp;x-signature=VxISBWf5ZNqPDUsPuo%2BnG4EyrdQ%3D" alt="image.png" loading="lazy"/></p>
<p>å…¶ä»–è¿è¡Œç¯å¢ƒå¦‚å¾®ä¿¡å°ç¨‹åºï¼ŒAPPç­‰ï¼Œä¼°è®¡è¿˜éœ€è¦æ›´å¤šçš„æ’ä»¶è¿›è¡Œæ”¹é€ ã€‚ä½†H5ä¸éœ€è¦åšå¤ªå¤šçš„è½¬ä¹‰ï¼Œç›´æ¥æŒ‰viteæ­£å¸¸æœåŠ¡å¯åŠ¨å³å¯ï¼Œuniappçš„è¿ä½œæ€è·¯ï¼Œå¤§è‡´å°±æ˜¯å¦‚æ­¤ã€‚æˆ‘å°±ä¸ä¸€ä¸€è§£ææ¯ä¸ªæ’ä»¶çš„ä½œç”¨äº†ã€‚</p>
<p>ä¾æ®æˆ‘é¡¹ç›®çš„éœ€æ±‚ï¼Œæˆ‘åŸæœ¬æ˜¯æƒ³ç€åšä¸€ä¸ªæ’ä»¶ï¼Œåœ¨uniappæ’ä»¶ä¹‹å‰ç”Ÿæ•ˆï¼Œå¯¹pages.jsonæ–‡ä»¶è¿›è¡Œæ”¹é€ ï¼Œç„¶åç»“æŸåå†æ¢å¤åŸæ ·ï¼Œè¿™æ ·å°±èƒ½å®Œå…¨å’Œuniappçš„æ’ä»¶è¿›è¡Œè§£æ„ï¼Œä½†è¿™æ ·åšå¼Šç«¯å…¶å®å¾ˆå¤šã€‚ä½†ä¸å’Œuniappæ’ä»¶è¿›è¡Œè§£è€¦ï¼Œæˆ‘åˆæ‹…å¿ƒuniappæ’ä»¶ï¼Œæˆ‘ä¸å¯æ§ã€‚</p>
<p>è¿™æ—¶å€™è§£ææºç çš„å¥½å¤„å°±æ¥äº†ï¼Œæˆ‘åœ¨uni:h5-pages-jsonæ’ä»¶ä¸­ï¼Œå‘ç°äº†ä¸€ä¸ªæ–¹æ³•æŒ‡å‘pages.jsonæ–‡ä»¶çš„æ–¹æ³•defineUniPagesJsonPluginã€‚åŸæ¥uniappæœ‰ä¸“é—¨çš„æŒ‡å‘æ–¹æ³•ã€‚è¿™æˆ‘å°±ä¸ç”¨æ‹…å¿ƒuniappä»–ä»¬å¼•å…¥pages.jsonçš„æ–¹å¼å˜åŒ–ï¼Œå¯ä»¥è½»æ¾çš„åœ¨uniappæ’ä»¶ä¿®æ”¹pages.jsonä¹‹å‰ï¼Œæˆ‘ä»¬è‡ªå·±å…ˆè¡Œä¸€æ­¥è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>æˆ‘çš„æ’ä»¶ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">"fs"</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Plugin</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"vite"</span>;
<span class="hljs-keyword">import</span> {
  defineUniPagesJsonPlugin
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@dcloudio/uni-cli-shared'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>): <span class="hljs-title class_">Plugin</span> {
<span class="hljs-comment">//ä½¿ç”¨uniappæä¾›çš„å°è£…æ–¹æ³•</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">defineUniPagesJsonPlugin</span>(<span class="hljs-function">(<span class="hljs-params">opts</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">name</span>: <span class="hljs-string">"vite-plugin-handleFile"</span>,
      <span class="hljs-attr">enforce</span>: <span class="hljs-string">'pre'</span>,<span class="hljs-comment">//uniappæ’ä»¶ä¹Ÿæ˜¯æå‰ç”Ÿæ•ˆçš„ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿè¦å¦‚æ­¤</span>
      <span class="hljs-title function_">transform</span>(<span class="hljs-params">code, id</span>) {
        <span class="hljs-comment">//ä½¿ç”¨uniappæä¾›çš„æ–¹æ³•ï¼Œæ‰¾åˆ°pages.jsonæ–‡ä»¶ï¼Œå¯¹pages.jsonè¿›è¡Œå¤„ç†</span>
        <span class="hljs-keyword">if</span> (opts.<span class="hljs-title function_">filter</span>(id)) {
            .....
            ....
            ....<span class="hljs-comment">//é¡¹ç›®ä¸šåŠ¡ä»£ç </span>
        }
      },
    };
  })
}
</code></pre>
<h4 data-id="heading-5">ç»“è¯­</h4>
<p>è¿™ç¯‡uniappæºç å†™å¾—ç®€çº¦ï¼Œç”šè‡³å¯ä»¥è¯´æ˜¯ç®€é™‹ï¼Œå“ˆå“ˆå“ˆã€‚ä¸è¿‡ï¼Œæ€è·¯åº”è¯¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚æŒæ¡è§£ææºç çš„æ€è·¯ï¼Œåé¢çš„è‡ªç„¶å°±æ°´åˆ°æ¸ æˆäº†ã€‚</p>
<p>ä¸ªäººæ€»ç»“çš„æ€è·¯å¤§è‡´æ˜¯ï¼š</p>
<ol>
<li>æ‰¾ä¸€ä¸ªéœ€æ±‚ï¼ˆæœ‰å®é™…çš„ä¸šåŠ¡éœ€æ±‚æœ€å¥½ï¼‰ï¼Œå¸¦ç€é—®é¢˜å»æ‰¾ç»“æœã€‚</li>
<li>æ‰¾åˆ°æºç ï¼Œè·‘èµ·æ¥ï¼Œåšå¥½æµ‹è¯•ç¯å¢ƒï¼ˆè¿™ä¸ªéå¸¸é‡è¦ï¼Œä»£ç è¦ä¸åœçš„consoleï¼Œæ‰“å°æŸ¥çœ‹å„ä¸ªèŠ‚ç‚¹çš„ç»“æœï¼Œæ‰èƒ½çŸ¥é“æ˜¯æ€ä¹ˆè¿ä½œçš„ï¼‰ã€‚</li>
<li>è§£ææºç æ˜¯æ€æ ·å¼€å±€çš„ã€‚</li>
<li>æ ¹æ®éœ€æ±‚å¼€å‘ä¸€ä¸ªç›¸å…³è”çš„æ’ä»¶æˆ–å†…å®¹ã€‚</li>
</ol>
<p>ç°åœ¨å¾®ä¿¡å°ç¨‹åºä¹Ÿå¾ˆç«ï¼ŒæŒ–ä¸ªå‘ï¼Œä¸‹æ¬¡æœ‰ç©ºï¼Œä¹Ÿè§£æuniappçš„å¾®ä¿¡å°ç¨‹åºçœ‹çœ‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[wangeditorè‡ªå®šä¹‰æ‰©å±•è®¾ç½®å›¾ç‰‡å®½é«˜]]></title>    <link>https://juejin.cn/post/7573273271799644200</link>    <guid>https://juejin.cn/post/7573273271799644200</guid>    <pubDate>2025-11-17T11:26:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573273271799644200" data-draft-id="7570978150010339366" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="wangeditorè‡ªå®šä¹‰æ‰©å±•è®¾ç½®å›¾ç‰‡å®½é«˜"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-17T11:26:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="yannick_liu"/> <meta itemprop="url" content="https://juejin.cn/user/1732486057956782"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            wangeditorè‡ªå®šä¹‰æ‰©å±•è®¾ç½®å›¾ç‰‡å®½é«˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1732486057956782/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    yannick_liu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T11:26:46.000Z" title="Mon Nov 17 2025 11:26:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">èƒŒæ™¯</h4>
<p>å½“å‰é¡¹ç›®ä¸­ç”¨åˆ°wangeditor æ’ä»¶ï¼Œ éœ€è¦æ‰©å±•å›¾ç‰‡å®½é«˜</p>
<p>é¡¹ç›®èƒŒæ™¯ ï¼š vue2</p>
<h4 data-id="heading-1">é¡¹ç›®æœ€ç»ˆæ•ˆæœ</h4>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6602f80274d4f06b836b8953a11a393~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWFubmlja19saXU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763983606&amp;x-signature=WjzveT3xAc77N0Kpsf2gSC5gQtM%3D" alt="image.png" width="100%" loading="lazy"/>
<h4 data-id="heading-2">wangeditorçš„å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">npm install wangeditor/editor
npm install wangeditor/editor-for-vue
</code></pre>
<h4 data-id="heading-3">åŸºæœ¬ä½¿ç”¨</h4>
<pre><code class="hljs language-xml" lang="xml">// å¯ç›´æ¥è¿è¡Œ
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-dialog</span>
    <span class="hljs-attr">:visible.sync</span>=<span class="hljs-string">"dialogVisible"</span>
    <span class="hljs-attr">:close-on-click-modal</span>=<span class="hljs-string">"false"</span>
    <span class="hljs-attr">fullscreen</span>
  &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">title</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"editor-title1 flex justify-between"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"font-bold"</span>&gt;</span>æ ‡é¢˜ï¼š{{ title }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex item-center"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-color-picker</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"color"</span> @<span class="hljs-attr">change</span>=<span class="hljs-string">"handleColorChange"</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"dialogVisible = false"</span>&gt;</span>å–æ¶ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!disabled"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleSubmit"</span>&gt;</span>ç¡®å®š<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"article-content"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"dialogVisible"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"left-box"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Toolbar</span> <span class="hljs-attr">:editor</span>=<span class="hljs-string">"editor"</span> <span class="hljs-attr">:default-config</span>=<span class="hljs-string">"toolbarConfig"</span> <span class="hljs-attr">:mode</span>=<span class="hljs-string">"mode"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Editor</span>
          <span class="hljs-attr">v-model</span>=<span class="hljs-string">"html"</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">"height: 82vh; overflow-y: hidden;"</span>
          <span class="hljs-attr">:default-config</span>=<span class="hljs-string">"editorConfig"</span>
          <span class="hljs-attr">:mode</span>=<span class="hljs-string">"mode"</span>
          @<span class="hljs-attr">onCreated</span>=<span class="hljs-string">"onCreated"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"right-box"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"preview-content"</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">"{ background: color, padding: '16px' }"</span> <span class="hljs-attr">v-html</span>=<span class="hljs-string">"html"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">el-dialog</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { uploadCmsImage } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/api/cms/index'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Editor</span>, <span class="hljs-title class_">Toolbar</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@wangeditor/editor-for-vue'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Boot</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@wangeditor/editor'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ImageWidthMenu</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./a.js'</span>

<span class="hljs-comment">// æ³¨å†Œæ’ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">components</span>: { <span class="hljs-title class_">Editor</span>, <span class="hljs-title class_">Toolbar</span> },  <span class="hljs-comment">// å¼•å…¥å¿…é¡»ç»„ä»¶</span>
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">color</span>: <span class="hljs-string">'#000'</span>, <span class="hljs-comment">// è®¾ç½®èƒŒæ™¯è‰²ï¼Œä¾¿äºåœ¨ä¸åŒçš„èƒŒæ™¯ä¸­æ˜¾ç¤º</span>
      <span class="hljs-attr">title</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">disabled</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">dialogVisible</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">editor</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">html</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">showUploading</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">toolbarConfig</span>: {},
      <span class="hljs-attr">editorConfig</span>: {},
      <span class="hljs-attr">mode</span>: <span class="hljs-string">'default'</span> <span class="hljs-comment">// or 'simple'</span>
    }
  },
  <span class="hljs-title function_">created</span>(<span class="hljs-params"/>) {
   <span class="hljs-comment">// æ ¸å¿ƒä»£ç ï¼Œ è‡ªå®šä¹‰æ‰©å±•å›¾ç‰‡å®½åº¦ ----start----</span>
    <span class="hljs-keyword">const</span> imageWidth75 = {
      <span class="hljs-attr">key</span>: <span class="hljs-string">'imageWidth75'</span>,
      <span class="hljs-title function_">factory</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageWidthMenu</span>(<span class="hljs-string">'75%'</span>)
      }
    }
    <span class="hljs-keyword">const</span> imageWidth80 = {
      <span class="hljs-attr">key</span>: <span class="hljs-string">'imageWidth80'</span>,
      <span class="hljs-title function_">factory</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageWidthMenu</span>(<span class="hljs-string">'80%'</span>)
      }
    }
    <span class="hljs-keyword">const</span> imageWidth85 = {
      <span class="hljs-attr">key</span>: <span class="hljs-string">'imageWidth85'</span>,
      <span class="hljs-title function_">factory</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageWidthMenu</span>(<span class="hljs-string">'85%'</span>)
      }
    }
    <span class="hljs-title class_">Boot</span>.<span class="hljs-title function_">registerMenu</span>(imageWidth75)
    <span class="hljs-title class_">Boot</span>.<span class="hljs-title function_">registerMenu</span>(imageWidth80)
    <span class="hljs-title class_">Boot</span>.<span class="hljs-title function_">registerMenu</span>(imageWidth85)
     <span class="hljs-comment">// æ ¸å¿ƒä»£ç ï¼Œ è‡ªå®šä¹‰æ‰©å±•å›¾ç‰‡å®½åº¦ ----end----</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">editorConfig</span> = {
      <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'è¯·è¾“å…¥å†…å®¹...'</span>,
      <span class="hljs-attr">MENU_CONF</span>: {
      <span class="hljs-comment">//  è‡ªå®šä¹‰å›¾ç‰‡ä¸Šä¼ æ¥å£</span>
        <span class="hljs-attr">uploadImage</span>: {
          <span class="hljs-attr">customUpload</span>: <span class="hljs-title function_">async</span>(file, insertFn) =&gt; {
            <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleCustomUpload</span>(file, insertFn)
          }
        },
      <span class="hljs-comment">//  è‡ªå®šä¹‰è§†é¢‘ä¸Šä¼ æ¥å£</span>
        <span class="hljs-attr">uploadVideo</span>: {
          <span class="hljs-attr">customUpload</span>: <span class="hljs-title function_">async</span>(file, insertFn) =&gt; {
            <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleCustomUpload</span>(file, insertFn)
          }
        }
      },
      <span class="hljs-attr">hoverbarKeys</span>: {
        <span class="hljs-attr">image</span>: {
          <span class="hljs-attr">menuKeys</span>: [
            <span class="hljs-string">'imageWidth30'</span>, 
            <span class="hljs-string">'imageWidth50'</span>,
            <span class="hljs-string">'imageWidth75'</span>,  <span class="hljs-comment">// æ ¸å¿ƒä»£ç ï¼Œ è‡ªå®šä¹‰æ‰©å±•å›¾ç‰‡å®½åº¦</span>
            <span class="hljs-string">'imageWidth80'</span>, <span class="hljs-comment">// æ ¸å¿ƒä»£ç ï¼Œ è‡ªå®šä¹‰æ‰©å±•å›¾ç‰‡å®½åº¦</span>
            <span class="hljs-string">'imageWidth85'</span>, <span class="hljs-comment">// æ ¸å¿ƒä»£ç ï¼Œ è‡ªå®šä¹‰æ‰©å±•å›¾ç‰‡å®½åº¦</span>
            <span class="hljs-string">'imageWidth100'</span>,
            <span class="hljs-string">'editImage'</span>,
            <span class="hljs-string">'viewImageLink'</span>,
            <span class="hljs-string">'deleteImage'</span>
          ]
        }
      }
    }
  },
  <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> editor = <span class="hljs-variable language_">this</span>.<span class="hljs-property">editor</span>
    <span class="hljs-keyword">if</span> (editor == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>
    editor.<span class="hljs-title function_">destroy</span>() <span class="hljs-comment">// ç»„ä»¶é”€æ¯æ—¶ï¼ŒåŠæ—¶é”€æ¯ç¼–è¾‘å™¨</span>
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-comment">// æ‰“å¼€å¼¹çª—</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">open</span>(<span class="hljs-params">data, disabled</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">title</span> = data.<span class="hljs-property">title</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span> = data.<span class="hljs-property">content</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">disabled</span> = disabled
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogVisible</span> = <span class="hljs-literal">true</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = <span class="hljs-string">'#000'</span>
    },

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleCustomUpload</span>(<span class="hljs-params">file, insertFn</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>()
        params.<span class="hljs-title function_">append</span>(<span class="hljs-string">'file'</span>, file)
        params.<span class="hljs-title function_">append</span>(<span class="hljs-string">'path'</span>, <span class="hljs-string">'cms'</span>)
        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">uploadCmsImage</span>(params)
        <span class="hljs-title function_">insertFn</span>(res.<span class="hljs-property">data</span>.<span class="hljs-property">url</span>, file.<span class="hljs-property">name</span>, res.<span class="hljs-property">data</span>.<span class="hljs-property">url</span>)
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e)
      }
    },

    <span class="hljs-title function_">onCreated</span>(<span class="hljs-params">editor</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">editor</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">seal</span>(editor) <span class="hljs-comment">// ä¸€å®šè¦ç”¨ Object.seal() ï¼Œå¦åˆ™ä¼šæŠ¥é”™</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> textContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.w-e-text-container'</span>)
        <span class="hljs-keyword">if</span> (textContainer) {
          textContainer.<span class="hljs-property">style</span>.<span class="hljs-property">fontSize</span> = <span class="hljs-string">'24px'</span>
        }
      }, <span class="hljs-number">100</span>)
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByClassName</span>(<span class="hljs-string">'w-e-text-container'</span>)[<span class="hljs-number">0</span>].<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'style'</span>, <span class="hljs-string">`background-color: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.color}</span>;`</span>)
    },

    <span class="hljs-comment">// æäº¤æ•°æ®</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleSubmit</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">'updateContent'</span>, <span class="hljs-string">'edit'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogVisible</span> = <span class="hljs-literal">false</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span> = <span class="hljs-string">''</span>
    },

    <span class="hljs-title function_">handleColorChange</span>(<span class="hljs-params">color</span>) {
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByClassName</span>(<span class="hljs-string">'w-e-text-container'</span>)[<span class="hljs-number">0</span>].<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'style'</span>, <span class="hljs-string">`background-color: <span class="hljs-subst">${color}</span>;`</span>)
    }

  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"@wangeditor/editor/dist/css/style.css"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span>&gt;</span><span class="css">
// å¼¹çª—
<span class="hljs-selector-class">.editor-dialog1</span> {
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span>;

  <span class="hljs-selector-class">.el-dialog__headerbtn</span> {
    <span class="hljs-attribute">display</span>: none;
  }

  <span class="hljs-selector-class">.el-dialog__body</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">16px</span>;
  }
}

<span class="hljs-selector-class">.w-e-text-container</span> <span class="hljs-selector-tag">h1</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">29px</span> <span class="hljs-meta">!important</span>;
}

<span class="hljs-selector-class">.w-e-text-container</span> <span class="hljs-selector-tag">h2</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">27px</span> <span class="hljs-meta">!important</span>;
}

<span class="hljs-selector-class">.w-e-text-container</span> <span class="hljs-selector-tag">h3</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">25px</span> <span class="hljs-meta">!important</span>;
}

<span class="hljs-selector-tag">video</span> {
  <span class="hljs-attribute">display</span>: block;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
// å†…å®¹
<span class="hljs-selector-class">.article-content</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">height</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100vh</span> - <span class="hljs-number">90px</span>);
  <span class="hljs-attribute">justify-content</span>: space-between;
  <span class="hljs-attribute">box-sizing</span>: border-box;

  <span class="hljs-selector-class">.left-box</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">49%</span>;
    <span class="hljs-attribute">border-right</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;
    <span class="hljs-attribute">padding-right</span>: <span class="hljs-number">10px</span>;
  }

  <span class="hljs-selector-class">.right-box</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">50%</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">overflow-y</span>: auto;
  }
}

//æ ‡é¢˜
<span class="hljs-selector-class">.editor-title1</span> {
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#ddd</span>;
  <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">box-sizing</span>: border-box;

  <span class="hljs-selector-class">.el-color-picker</span> {
    <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10px</span>;
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

</code></pre>
<p>æ ¸å¿ƒä»£ç ï¼Œ æ‰©å±•ä»£ç </p>
<pre><code class="hljs language-a.js" lang="a.js">import { DomEditor, SlateTransforms } from '@wangeditor/editor'
export default class ImageWidthMenu {
  constructor(width) {
    this.title = width || '70%'
    this.tag = 'button'
    this.width = width || '70%'
    // this.iconSvg = '&lt;svg width="18" height="18" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"&gt;&lt;path d="M832 192H192c-17.7 0-32 14.3-32 32v576c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32z m-40 560H232V264h560v488z" fill="#333"/&gt;&lt;/svg&gt;'
  }

  getValue(editor) {
    return ''
  }

  // è·å–é€‰ä¸­çš„å›¾ç‰‡èŠ‚ç‚¹
  getSelectedNode(editor) {
    const { selection } = editor
    if (!selection) return null
    return DomEditor.getSelectedNodeByType(editor, 'image')
  }

  // æ£€æŸ¥æ˜¯å¦æ¿€æ´»ï¼ˆå½“å‰å®½åº¦æ˜¯å¦ä¸ºæŒ‡å®šå®½åº¦ï¼‰
  isActive(editor) {
    return false
    // const node = this.getSelectedNode(editor)
    // if (!node) return false
    // return node.style.width === this.width
  }

  // æ²¡æœ‰é€‰ä¸­å›¾ç‰‡åˆ™ç¦ç”¨

  isDisabled(editor) {
    if (editor.selection == null) return true

    const imageNode = this.getSelectedNode(editor)
    if (imageNode == null) {
      // é€‰åŒºæœªå¤„äº image node ï¼Œåˆ™ç¦ç”¨
      return true
    }
    return false
  }

  exec(editor) {
    if (this.isDisabled(editor)) return

    const imageNode = this.getSelectedNode(editor)
    if (imageNode == null) return

    // éšè— hoverbar
    const hoverbar = DomEditor.getHoverbar(editor)
    if (hoverbar) hoverbar.hideAndClean()

    const { style = {}} = imageNode // å‡è®¾ imageNode æ˜¯ ImageElement ç±»å‹
    const props = {
      style: {
        ...style,
        width: this.width, // ä½¿ç”¨ä¼ å…¥çš„ width å‚æ•°
        height: '' // æ¸…ç©º height
      }
    }

    SlateTransforms.setNodes(editor, props, {
      match: n =&gt; DomEditor.checkNodeType(n, 'image')
    })
  }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™å¼€å‘ï¼šæ”¯æŒè‡ªå®šä¹‰ç»„ä»¶çš„è·‘é©¬ç¯]]></title>    <link>https://juejin.cn/post/7573549302620045355</link>    <guid>https://juejin.cn/post/7573549302620045355</guid>    <pubDate>2025-11-18T01:52:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573549302620045355" data-draft-id="7573549302619979819" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™å¼€å‘ï¼šæ”¯æŒè‡ªå®šä¹‰ç»„ä»¶çš„è·‘é©¬ç¯"/> <meta itemprop="keywords" content="HarmonyOS,Android,iOS"/> <meta itemprop="datePublished" content="2025-11-18T01:52:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜ä¸€é¸£"/> <meta itemprop="url" content="https://juejin.cn/user/1398234520239095"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™å¼€å‘ï¼šæ”¯æŒè‡ªå®šä¹‰ç»„ä»¶çš„è·‘é©¬ç¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1398234520239095/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜ä¸€é¸£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T01:52:38.000Z" title="Tue Nov 18 2025 01:52:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ€è¿‘çš„é¡¹ç›®ä¸­ç”¨åˆ°äº†ï¼Œå¯ä»¥è¿ç»­æ»šåŠ¨çš„è·‘é©¬ç¯ï¼Œå¹¶ä¸”æ»šåŠ¨çš„ä¸ä»…ä»…æ˜¯çº¯æ–‡å­—ï¼Œè¿˜æœ‰å›¾ç‰‡ç­‰å…¶ä»–çš„ç»„ä»¶ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„Textç»„ä»¶æˆ–è€…Marqueeç»„ä»¶å°±æ— æ³•æ¥å®ç°äº†ï¼Œåªèƒ½è‡ªå·±è‡ªå®šä¹‰äº†ã€‚</p>
<p>æˆ‘ä»¬å…ˆçœ‹ä¸‹è‡ªå®šä¹‰åçš„æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/528c04f8d8dc4e04ac7eb28c606e747c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5LiA6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764035558&amp;x-signature=ovZlPfPRgVSDm%2BvOzBm3rZylIYI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/940f02a3055445f18f7aeb27f115b10f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5LiA6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764035558&amp;x-signature=eV66ilK5RvxLRbAl3CI7zz2YGIk%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a36b4e1cb5e43b699cadc2f4aa47fff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5LiA6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764035558&amp;x-signature=8SmxC5F2gGKeaOQFL2WNL1B6z1o%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9443fdc9c86b4e84ae0d5b3db836b086~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5LiA6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764035558&amp;x-signature=LmpM5RRS7zd7Qo4JG8KeIqAb3mA%3D" alt="" loading="lazy"/></p>
<p>æ€»ä½“è€Œè¨€ï¼Œè‡ªå®šä¹‰ä¹‹åçš„è·‘é©¬ç¯ï¼Œæ— è®ºæ˜¯çºµå‘æ»šåŠ¨è¿˜æ˜¯æ¨ªå‘æ»šåŠ¨ï¼Œæ˜¯è¿ç»­æ»šåŠ¨è¿˜æ˜¯åœé¡¿æ»šåŠ¨ï¼ŒåŸºæœ¬ä¸Šéƒ½å®ç°äº†ï¼Œå¯ä»¥è¯´ï¼Œæ»¡è¶³äº†å®é™…å¼€å‘ä¸­çš„å¤§å¤šæ•°åœºæ™¯ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°ä»¥ä¸Šçš„æ•ˆæœå‘¢?å…¶å®å¾ˆç®€å•ï¼Œä¸€ä¸ªSwiperç»„ä»¶å’Œä¸€ä¸ªå±æ€§åŠ¨ç”»å°±å¯ä»¥å®ç°äº†ã€‚</p>
<p>é‚£ä¹ˆåœ¨è‡ªå®šä¹‰å®ç°ä¹‹å‰ï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜è¯¢é—®å¤§å®¶ï¼Œ<strong>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œç³»ç»Ÿçš„Textç»„ä»¶æˆ–è€…Marqueeç»„ä»¶ï¼Œæ”¯æŒçºµå‘æ»šåŠ¨å—ï¼Ÿ</strong></p>
<p><strong>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœæˆ‘æƒ³è¿ç»­æ»šåŠ¨å›¾æ–‡ç»“æ„çš„å†…å®¹ï¼Œæˆ–è€…è‡ªå®šä¹‰ç»„ä»¶æ»šåŠ¨ï¼Œç³»ç»Ÿæ˜¯å¦ä¸ºæˆ‘ä»¬æä¾›äº†å¯ç”¨ç»„ä»¶ï¼Ÿ</strong></p>
<p>å¯ä»¥æ˜ç¡®çš„æ˜¯ï¼Œä»¥ä¸Šä¸¤ä¸ªé—®é¢˜çš„ç­”æ¡ˆéƒ½æ˜¯å¦å®šçš„ï¼Œç³»ç»Ÿçš„Textç»„ä»¶æˆ–è€…Marqueeç»„ä»¶ï¼Œåªæ”¯æŒæ–‡æœ¬æ»šåŠ¨ï¼Œå¹¶ä¸”ä¹Ÿæ”¯æŒæ¨ªå‘æ»šåŠ¨ï¼Œæ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³å®ç°éæ–‡æœ¬æ»šåŠ¨ï¼Œæˆ–è€…çºµå‘æ»šåŠ¨ï¼Œåªèƒ½è‡ªå·±åŠ¨æ‰‹æ¥å®ç°ã€‚</p>
<p>æœ¬ç¯‡æ–‡ç« çš„å¤§è‡´å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><strong>1ã€åœé¡¿è·‘é©¬ç¯å®ç°</strong></p>
<p><strong>2ã€è¿ç»­è·‘é©¬ç¯å®ç°</strong></p>
<p><strong>3ã€marqueeç»„ä»¶å…¨å®ç°</strong></p>
<p><strong>4ã€ç›¸å…³æ€»ç»“</strong></p>
<h2 data-id="heading-1">åœé¡¿è·‘é©¬ç¯å®ç°</h2>
<p>æ‰€è°“çš„åœé¡¿ï¼Œå°±æ˜¯è·‘é©¬ç¯æ•°æ®ï¼Œæš‚åœä¸€äº›æ—¶é—´ï¼Œç„¶åå†å»è½®åŠ¨ä¸‹ä¸€ä¸ªï¼Œå‘¨è€Œå¤å§‹çš„å±•ç¤ºï¼›è¿™ç§æ–¹å¼å®ç°èµ·æ¥æœ€ç®€å•ï¼Œç›¸ä¿¡èªæ˜çš„ä½ ï¼Œä¸€ä¸‹å°±èƒ½æƒ³èµ·æ¥äº†å¦‚ä½•å®ç°ï¼Œæ²¡é”™ï¼Œå°±æ˜¯ä½¿ç”¨Swiperç»„ä»¶ã€‚</p>
<p>ç³»ç»Ÿçš„Swiperç»„ä»¶ï¼Œä¸€èˆ¬ç”¨äºè½®æ’­å›¾çš„å®ç°ï¼Œä½†æ˜¯å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªæš‚åœçš„è·‘é©¬ç¯ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªè½®æ’­å›¾ã€‚</p>
<p>æ¨ªå‘ä¹Ÿå¥½ï¼Œçºµå‘ä¹Ÿå¥½ï¼Œé€šè¿‡verticalå±æ€§ä¾¿å¯è½»æ¾æå®šï¼Œä¸ºtrueå°±çºµå‘ï¼Œfasleå°±æ˜¯æ¨ªå‘ï¼›å¯¹äºæ—¶é—´ä¸Šçš„æ§åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨intervalå±æ€§æ¥è®¾ç½®ã€‚</p>
<p>ç®€å•çš„æ¡ˆä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"> <span class="hljs-title class_">Swiper</span>() {
          <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeData</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">Object</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">marqueeLayout</span>(item, index)
          })
        }
        .<span class="hljs-title function_">vertical</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeDirection</span> == <span class="hljs-title class_">MarqueeDirection</span>.<span class="hljs-property">vertical</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>)
        .<span class="hljs-title function_">autoPlay</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">autoPlay</span>) <span class="hljs-comment">//æ˜¯å¦æ˜¯è‡ªåŠ¨å¾ªç¯</span>
        .<span class="hljs-title function_">loop</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoop</span>)
        .<span class="hljs-title function_">interval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">interval</span>) <span class="hljs-comment">//é—´éš”æ—¶é—´</span>
        .<span class="hljs-title function_">indicator</span>(<span class="hljs-literal">false</span>)
        .<span class="hljs-title function_">disableSwipe</span>(<span class="hljs-literal">true</span>)
</code></pre>
<p>Swiperç»„ä»¶æ˜¯æ”¯æŒä»»æ„çš„è‡ªå®šä¹‰ç»„ä»¶çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœä½ çš„é¡¹ç›®ä¸­æœ‰åœé¡¿è·‘é©¬ç¯æ•ˆæœçš„è¯ï¼Œå®Œå…¨å¯ä»¥è¿›è¡Œä½¿ç”¨ã€‚</p>
<h2 data-id="heading-2">è¿ç»­è·‘é©¬ç¯å®ç°</h2>
<p>è¿ç»­çš„è·‘é©¬ç¯ï¼Œå°±æ˜¯ä¸€ç›´æ»šåŠ¨ï¼Œä¸å­˜åœ¨ä¸­é—´åœé¡¿çš„æ—¶é—´ï¼Œä¸Šä¸€ä¸ªæ»šåŠ¨å®Œæˆä¹‹åï¼Œæ¥ç€å°±æ»šåŠ¨ä¸‹ä¸€ä¸ªï¼Œçº¯æ–‡æœ¬çš„æ¨ªå‘æ»šåŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç³»ç»Ÿçš„Textç»„ä»¶æˆ–è€…Marqueeç»„ä»¶æ¥å®ç°ï¼Œå¦‚æœæ»šåŠ¨çš„æ˜¯éæ–‡æœ¬ï¼Œé‚£ä¹ˆå°±éœ€è¦è‡ªå®šä¹‰æ¥å®ç°äº†ã€‚</p>
<p>è‡ªå®šä¹‰èµ·æ¥ä¹Ÿæ˜¯éå¸¸çš„ç®€å•ï¼Œåªéœ€è¦ä¸¤ä¸ªå±æ€§ä¾¿å¯ä»¥æå®šï¼Œä¸€ä¸ªæ˜¯å¹³ç§»å±æ€§åŠ¨ç”»ï¼Œä¸€ä¸ªæ˜¯è®¾ç½®åŠ¨ç”»å‚æ•°ï¼Œå¦‚æœæ˜¯æ¨ªå‘ï¼Œé‚£ä¹ˆå°±è®¾ç½®xåæ ‡ï¼Œå¦‚æœæ˜¯çºµå‘ï¼Œå°±è®¾ç½®yåæ ‡ã€‚</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"> .<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">y</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">offsetY</span> })
            .<span class="hljs-title function_">animation</span>({
              <span class="hljs-attr">duration</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">interval</span>,
              <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">Linear</span>, <span class="hljs-comment">// çº¿æ€§é€Ÿåº¦</span>
              <span class="hljs-attr">iterations</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoop</span> ? -<span class="hljs-number">1</span> : <span class="hljs-variable language_">this</span>.<span class="hljs-property">iterations</span>, <span class="hljs-comment">// æ— é™å¾ªç¯</span>
              <span class="hljs-attr">playMode</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeFromStart</span> ? <span class="hljs-title class_">PlayMode</span>.<span class="hljs-property">Normal</span> : <span class="hljs-title class_">PlayMode</span>.<span class="hljs-property">Reverse</span>, <span class="hljs-comment">// å•å‘æ’­æ”¾</span>
            })
</code></pre>
<p>æ— è®ºæ˜¯çºµå‘ç§»åŠ¨è¿˜æ˜¯æ¨ªå‘ç§»åŠ¨ï¼Œæ‰€ç§»åŠ¨çš„è·ç¦»ï¼Œä¸€å®šæ˜¯æ•´ä¸ªç»„ä»¶çš„è·ç¦»ï¼Œéœ€è¦è‡ªå·±åŠ¨æ€æ¥è®¡ç®—ï¼Œæ¯”å¦‚çºµå‘æ»šåŠ¨ï¼Œå•ä¸ªç»„ä»¶é«˜åº¦ä¸º50ï¼Œå…±æœ‰5ä¸ªç»„ä»¶éœ€è¦è½®åŠ¨ï¼Œé‚£å°±æ˜¯5*5ï¼Œä¹Ÿå°±æ˜¯è½®åŠ¨çš„ç»„ä»¶æ•°é‡ä¹˜ä»¥å•ä¸ªç»„ä»¶çš„é«˜åº¦ã€‚</p>
<h2 data-id="heading-3">marqueeç»„ä»¶å…¨å®ç°</h2>
<p>æ— è®ºè¿ç»­è¿˜æ˜¯åœé¡¿ï¼Œæ–‡æœ¬è¿˜æ˜¯éæ–‡æœ¬ï¼Œç›®å‰è¿™äº›åŠŸèƒ½æˆ‘å…¨éƒ¨å·²ç»å°è£…å®Œæ¯•ï¼Œå‘å¸ƒåˆ°äº†ä¸­å¿ƒä»“åº“ä¸­ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥ä¾èµ–ä½¿ç”¨ã€‚</p>
<p>åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fohpm.openharmony.cn%2F%23%2Fcn%2Fdetail%2F%40abner%252Fmarquee" target="_blank" title="https://ohpm.openharmony.cn/#/cn/detail/@abner%2Fmarquee" ref="nofollow noopener noreferrer">ohpm.openharmony.cn/#/cn/detailâ€¦</a></p>
<h3 data-id="heading-4">å¿«é€Ÿä½¿ç”¨</h3>
<p>æ–¹å¼ä¸€ï¼šåœ¨Terminalçª—å£ä¸­ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…ä¸‰æ–¹åŒ…ï¼ŒDevEco Studioä¼šè‡ªåŠ¨åœ¨å·¥ç¨‹çš„oh-package.json5ä¸­è‡ªåŠ¨æ·»åŠ ä¸‰æ–¹åŒ…ä¾èµ–ã€‚</p>
<p><strong>å»ºè®®ï¼šåœ¨ä½¿ç”¨çš„æ¨¡å—è·¯å¾„ä¸‹è¿›è¡Œæ‰§è¡Œå‘½ä»¤ã€‚</strong></p>
<pre><code class="hljs language-TypeScript" lang="TypeScript">ohpm install <span class="hljs-meta">@abner</span>/marquee
</code></pre>
<p>æ–¹å¼äºŒï¼šåœ¨å·¥ç¨‹æ¨¡å—çš„oh-package.json5ä¸­è®¾ç½®ä¸‰æ–¹åŒ…ä¾èµ–ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-string">"dependencies"</span>: { <span class="hljs-string">"@abner/marquee"</span>: <span class="hljs-string">"^1.0.0"</span>}
</code></pre>
<h3 data-id="heading-5">ä»£ç ä½¿ç”¨</h3>
<h4 data-id="heading-6">1ã€çº¯æ–‡å­—è·‘é©¬ç¯</h4>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-title class_">MarqueeView</span>({
  <span class="hljs-attr">marqueeText</span>: <span class="hljs-string">"æˆ‘æ˜¯ä¸€æ®µçº¯æ–‡æœ¬å†…å®¹ï¼Œä¸»è¦ç”¨æ¥å±•ç¤ºè·‘é©¬ç¯æ•ˆæœï¼Œæ¥å§ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹ä¸€ä¸‹å§"</span>,
})
</code></pre>
<p><strong>å±æ€§ä»‹ç»</strong></p>


















































<table><thead><tr><th><strong>å±æ€§</strong></th><th><strong>ç±»å‹</strong></th><th><strong>æ¦‚è¿°</strong></th></tr></thead><tbody><tr><td>marqueeText</td><td>string/Resource</td><td>è·‘é©¬ç¯æ–‡æœ¬æ•°æ®</td></tr><tr><td>marqueeTextAttribute</td><td>MarqueeTextAttribute</td><td>è·‘é©¬ç¯æ–‡æœ¬å±æ€§ï¼Œè®¾ç½®é¢œè‰²å¤§å°ç­‰</td></tr><tr><td>marqueeStart</td><td>boolean</td><td>æ§åˆ¶è·‘é©¬ç¯æ’­æ”¾å’Œåœæ­¢ï¼Œtrueæ’­æ”¾ï¼Œfalseæš‚åœ</td></tr><tr><td>marqueeTextStep</td><td>number</td><td>æ»šåŠ¨åŠ¨ç”»æ–‡æœ¬æ»šåŠ¨æ­¥é•¿ã€‚é»˜è®¤å€¼ï¼š4.0vp</td></tr><tr><td>marqueeFromStart</td><td>boolean</td><td>è®¾ç½®æ–‡æœ¬ä»å¤´å¼€å§‹æ»šåŠ¨æˆ–åå‘æ»šåŠ¨ã€‚trueè¡¨ç¤ºä»å¤´å¼€å§‹æ»šåŠ¨ï¼Œfalseè¡¨ç¤ºåå‘æ»šåŠ¨ã€‚é»˜è®¤å€¼ï¼štrue</td></tr><tr><td>marqueeTextDelay</td><td>number</td><td>è®¾ç½®æ¯æ¬¡æ»šåŠ¨çš„æ—¶é—´é—´éš”ã€‚é»˜è®¤å€¼ï¼š0å•ä½ï¼šæ¯«ç§’</td></tr><tr><td>marqueeTextLoop</td><td>number</td><td>è®¾ç½®é‡å¤æ»šåŠ¨çš„æ¬¡æ•°ï¼Œå°äºç­‰äºé›¶æ—¶æ— é™å¾ªç¯ã€‚é»˜è®¤å€¼ï¼š-1</td></tr><tr><td>marqueeTextFadeout</td><td>boolean</td><td>è®¾ç½®æ–‡å­—è¶…é•¿æ—¶çš„æ¸éšæ•ˆæœã€‚trueè¡¨ç¤ºæ”¯æŒæ¸éšæ•ˆæœï¼Œfalseè¡¨ç¤ºä¸æ”¯æŒæ¸éšæ•ˆæœã€‚</td></tr></tbody></table>
<p><strong>MarqueeTextAttribute</strong></p>



































<table><thead><tr><th><strong>å±æ€§</strong></th><th><strong>ç±»å‹</strong></th><th><strong>æ¦‚è¿°</strong></th></tr></thead><tbody><tr><td>fontColor</td><td>ResourceColor</td><td>è·‘é©¬ç¯æ–‡æœ¬é¢œè‰²</td></tr><tr><td>fontSize</td><td>number / string/ Resource</td><td>è·‘é©¬ç¯æ–‡æœ¬é¢œè‰²</td></tr><tr><td>fontFamily</td><td>string / Resource</td><td>å­—ä½“æ—ã€‚é»˜è®¤å­—ä½“'HarmonyOS Sans'ã€‚</td></tr><tr><td>fontStyle</td><td>FontStyle</td><td>å­—ä½“æ ·å¼ã€‚é»˜è®¤å€¼ï¼šFontStyle.Normal</td></tr><tr><td>fontWeight</td><td>number / FontWeight / ResourceStr</td><td>æ–‡æœ¬çš„å­—ä½“ç²—ç»†</td></tr></tbody></table>
<h4 data-id="heading-7">2ã€çºµå‘åœé¡¿è·‘é©¬ç¯</h4>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-meta">@Entry</span>
  <span class="hljs-meta">@Component</span>
  struct <span class="hljs-title class_">VerticalPausePage</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">marqueeDataArray</span>: <span class="hljs-built_in">string</span>[] = [
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬ä¸€æ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬äºŒæ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬ä¸‰æ¡"</span>
    ]

    <span class="hljs-comment">/**
   *AUTHOR:AbnerMing
   *INTRODUCE:å¯ä»¥æ˜¯ä»»æ„å¸ƒå±€
   */</span>
    <span class="hljs-meta">@Builder</span>
    <span class="hljs-title function_">marqueeLayout</span>(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, _: <span class="hljs-built_in">number</span></span>) {
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">SymbolGlyph</span>($r(<span class="hljs-string">'sys.symbol.bell_fill'</span>))
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
          .<span class="hljs-title function_">renderingStrategy</span>(<span class="hljs-title class_">SymbolRenderingStrategy</span>.<span class="hljs-property">SINGLE</span>)
          .<span class="hljs-title function_">fontColor</span>([<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>])
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
        <span class="hljs-title class_">Text</span>(item)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
    }

    <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
      <span class="hljs-title class_">RelativeContainer</span>() {
        <span class="hljs-title class_">ActionBar</span>({ <span class="hljs-attr">title</span>: <span class="hljs-string">"çºµå‘åœé¡¿è·‘é©¬ç¯"</span> })

        <span class="hljs-title class_">Column</span>() {
          <span class="hljs-title class_">MarqueeView</span>({
            <span class="hljs-attr">marqueeData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeDataArray</span>, <span class="hljs-comment">//å¯ä»¥ä¼ é€’ä»»æ„ç±»å‹æ•°æ®æ•°ç»„</span>
            <span class="hljs-attr">marqueeType</span>: <span class="hljs-title class_">MarqueeType</span>.<span class="hljs-property">pause</span>,
            <span class="hljs-attr">interval</span>:<span class="hljs-number">1000</span>,
            <span class="hljs-attr">marqueeLayout</span>: <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">Object</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">marqueeLayout</span>(item <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, index)
            }
          })
        }.<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span> })
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">10</span> })
          .<span class="hljs-title function_">alignRules</span>({
            <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },
            <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }
          })
      }
      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    }
  }
</code></pre>
<p><strong>å±æ€§ä»‹ç»</strong></p>


















































<table><thead><tr><th><strong>å±æ€§</strong></th><th><strong>ç±»å‹</strong></th><th><strong>æ¦‚è¿°</strong></th></tr></thead><tbody><tr><td>marqueeData</td><td>Object[]</td><td>è·‘é©¬ç¯æ•°æ®æ•°ç»„</td></tr><tr><td>marqueeLayout</td><td>@BuilderParam</td><td>ç”¨äºä¼ é€’è·‘é©¬ç¯è‡ªå®šä¹‰ç»„ä»¶ï¼Œå¯ä»¥è‡ªå®šä¹‰@Builderæ¥å®ç°</td></tr><tr><td>isLoop</td><td>boolean</td><td>æ˜¯å¦æ˜¯å¾ªç¯æ’­æ”¾ï¼Œé»˜è®¤trueä¸ºå¾ªç¯</td></tr><tr><td>interval</td><td>number</td><td>è·‘é©¬ç¯é—´éš”æ—¶é—´,é»˜è®¤æ˜¯3000æ¯«ç§’</td></tr><tr><td>autoPlay</td><td>boolean</td><td>æ˜¯å¦æ˜¯è‡ªåŠ¨æ’­æ”¾ï¼Œé»˜è®¤trueï¼Œæ˜¯</td></tr><tr><td>marqueeType</td><td>MarqueeType</td><td>è·‘é©¬ç¯ç±»å‹ï¼Œé»˜è®¤ä¸ºæ–‡æœ¬ç±»å‹ï¼ŒMarqueeType.textï¼Œpauseï¼šåœé¡¿ç±»å‹ï¼Œcontinuousï¼šè¿ç»­ç±»å‹</td></tr><tr><td>iterations</td><td>number</td><td>å¾ªç¯æ¬¡æ•°ï¼Œé»˜è®¤æ— é™æ¬¡</td></tr><tr><td>marqueeStart</td><td>boolean</td><td>trueæ’­æ”¾ï¼Œfalseæš‚åœ</td></tr></tbody></table>
<h4 data-id="heading-8">3ã€çºµå‘è¿ç»­è·‘é©¬ç¯</h4>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-meta">@Entry</span>
  <span class="hljs-meta">@Component</span>
  struct <span class="hljs-title class_">VerticalContinuousPage</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">marqueeDataArray</span>: <span class="hljs-built_in">string</span>[] = [
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬ä¸€æ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬äºŒæ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬ä¸‰æ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬å››æ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬äº”æ¡"</span>
    ]

    <span class="hljs-comment">/**
   *AUTHOR:AbnerMing
   *INTRODUCE:å¯ä»¥æ˜¯ä»»æ„å¸ƒå±€
   */</span>
    <span class="hljs-meta">@Builder</span>
    <span class="hljs-title function_">marqueeLayout</span>(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, _: <span class="hljs-built_in">number</span></span>) {
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">SymbolGlyph</span>($r(<span class="hljs-string">'sys.symbol.bell_fill'</span>))
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
          .<span class="hljs-title function_">renderingStrategy</span>(<span class="hljs-title class_">SymbolRenderingStrategy</span>.<span class="hljs-property">SINGLE</span>)
          .<span class="hljs-title function_">fontColor</span>([<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>])
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
        <span class="hljs-title class_">Text</span>(item)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
    }

    <span class="hljs-comment">/**
   *AUTHOR:AbnerMing
   *INTRODUCE:å¯ä»¥æ˜¯ä»»æ„å¸ƒå±€
   */</span>
    <span class="hljs-meta">@Builder</span>
    <span class="hljs-title function_">marqueeText</span>(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, _: <span class="hljs-built_in">number</span></span>) {
      <span class="hljs-title class_">Text</span>(item)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)

    }

    <span class="hljs-comment">/**
   *AUTHOR:AbnerMing
   *INTRODUCE:å¯ä»¥æ˜¯ä»»æ„å¸ƒå±€
   */</span>
    <span class="hljs-meta">@Builder</span>
    <span class="hljs-title function_">marqueeLayout2</span>(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, _: <span class="hljs-built_in">number</span></span>) {
      <span class="hljs-title class_">Column</span>() {
        <span class="hljs-title class_">Image</span>(<span class="hljs-string">"https://loveharmony.oss-cn-beijing.aliyuncs.com/banner/banner_01.jpg"</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
        <span class="hljs-title class_">Text</span>(item)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })
      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
    }

    <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
      <span class="hljs-title class_">Column</span>() {
        <span class="hljs-title class_">ActionBar</span>({ <span class="hljs-attr">title</span>: <span class="hljs-string">"çºµå‘è¿ç»­è·‘é©¬ç¯"</span> })

        <span class="hljs-comment">//çº¯æ–‡æœ¬</span>
        <span class="hljs-title class_">MarqueeView</span>({
          <span class="hljs-attr">marqueeData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeDataArray</span>, <span class="hljs-comment">//å¯ä»¥ä¼ é€’ä»»æ„ç±»å‹æ•°æ®æ•°ç»„</span>
          <span class="hljs-attr">marqueeType</span>: <span class="hljs-title class_">MarqueeType</span>.<span class="hljs-property">continuous</span>, <span class="hljs-comment">//è¿ç»­æ»šåŠ¨</span>
          <span class="hljs-attr">marqueeLayout</span>: <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">Object</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">marqueeText</span>(item <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, index)
          }
        }).<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span> })

        <span class="hljs-comment">//è‡ªå®šä¹‰å¸ƒå±€1</span>
        <span class="hljs-title class_">MarqueeView</span>({
          <span class="hljs-attr">marqueeData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeDataArray</span>, <span class="hljs-comment">//å¯ä»¥ä¼ é€’ä»»æ„ç±»å‹æ•°æ®æ•°ç»„</span>
          <span class="hljs-attr">marqueeType</span>: <span class="hljs-title class_">MarqueeType</span>.<span class="hljs-property">continuous</span>, <span class="hljs-comment">//è¿ç»­æ»šåŠ¨</span>
          <span class="hljs-attr">marqueeLayout</span>: <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">Object</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">marqueeLayout</span>(item <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, index)
          }
        }).<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span> })
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })

        <span class="hljs-comment">//è‡ªå®šä¹‰å¸ƒå±€2</span>
        <span class="hljs-title class_">MarqueeView</span>({
          <span class="hljs-attr">marqueeData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeDataArray</span>, <span class="hljs-comment">//å¯ä»¥ä¼ é€’ä»»æ„ç±»å‹æ•°æ®æ•°ç»„</span>
          <span class="hljs-attr">marqueeType</span>: <span class="hljs-title class_">MarqueeType</span>.<span class="hljs-property">continuous</span>, <span class="hljs-comment">//è¿ç»­æ»šåŠ¨</span>
          <span class="hljs-attr">marqueeLayout</span>: <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">Object</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">marqueeLayout2</span>(item <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, index)
          }
        }).<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span> })
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })

      }.<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">20</span> })
        .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    }
  }
</code></pre>
<h4 data-id="heading-9">4ã€æ¨ªå‘åœé¡¿è·‘é©¬ç¯</h4>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-meta">@Entry</span>
  <span class="hljs-meta">@Component</span>
  struct <span class="hljs-title class_">HorizontalPausePage</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">marqueeDataArray</span>: <span class="hljs-built_in">string</span>[] = [
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬ä¸€æ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬äºŒæ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬ä¸‰æ¡"</span>
    ]

    <span class="hljs-comment">/**
   *AUTHOR:AbnerMing
   *INTRODUCE:å¯ä»¥æ˜¯ä»»æ„å¸ƒå±€
   */</span>
    <span class="hljs-meta">@Builder</span>
    <span class="hljs-title function_">marqueeLayout</span>(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, index: <span class="hljs-built_in">number</span></span>) {
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">SymbolGlyph</span>($r(<span class="hljs-string">'sys.symbol.bell_fill'</span>))
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
          .<span class="hljs-title function_">renderingStrategy</span>(<span class="hljs-title class_">SymbolRenderingStrategy</span>.<span class="hljs-property">SINGLE</span>)
          .<span class="hljs-title function_">fontColor</span>([<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>])
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
        <span class="hljs-title class_">Text</span>(item)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
        .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>) <span class="hljs-comment">//å†…å®¹å±…ä¸­</span>
    }

    <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
      <span class="hljs-title class_">Column</span>() {
        <span class="hljs-title class_">ActionBar</span>({ <span class="hljs-attr">title</span>: <span class="hljs-string">"æ¨ªå‘åœé¡¿è·‘é©¬ç¯"</span> })
        <span class="hljs-title class_">Column</span>() {
          <span class="hljs-title class_">MarqueeView</span>({
            <span class="hljs-attr">marqueeData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeDataArray</span>, <span class="hljs-comment">//å¯ä»¥ä¼ é€’ä»»æ„ç±»å‹æ•°æ®æ•°ç»„</span>
            <span class="hljs-attr">marqueeDirection</span>: <span class="hljs-title class_">MarqueeDirection</span>.<span class="hljs-property">horizontal</span>, <span class="hljs-comment">//æ¨ªå‘æ»šåŠ¨</span>
            <span class="hljs-attr">marqueeType</span>: <span class="hljs-title class_">MarqueeType</span>.<span class="hljs-property">pause</span>,
            <span class="hljs-attr">marqueeLayout</span>: <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">Object</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">marqueeLayout</span>(item <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, index)
            }
          })
        }.<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span> })
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">50</span> })
      }
      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    }
  }
</code></pre>
<h4 data-id="heading-10">5ã€æ¨ªå‘è¿ç»­è·‘é©¬ç¯</h4>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-meta">@Entry</span>
  <span class="hljs-meta">@Component</span>
  struct <span class="hljs-title class_">HorizontalContinuousPage</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">marqueeDataArray</span>: <span class="hljs-built_in">string</span>[] = [
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬ä¸€æ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬äºŒæ¡"</span>,
      <span class="hljs-string">"å…¬å‘Šï¼šæˆ‘æ˜¯æµ‹è¯•æ¶ˆæ¯ç¬¬ä¸‰æ¡"</span>
    ]

    <span class="hljs-comment">/**
   *AUTHOR:AbnerMing
   *INTRODUCE:å¯ä»¥æ˜¯ä»»æ„å¸ƒå±€
   */</span>
    <span class="hljs-meta">@Builder</span>
    <span class="hljs-title function_">marqueeText</span>(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, _: <span class="hljs-built_in">number</span></span>) {
      <span class="hljs-title class_">Text</span>(item)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)

    }

    <span class="hljs-comment">/**
   *AUTHOR:AbnerMing
   *INTRODUCE:å¯ä»¥æ˜¯ä»»æ„å¸ƒå±€
   */</span>
    <span class="hljs-meta">@Builder</span>
    <span class="hljs-title function_">marqueeLayout</span>(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, _: <span class="hljs-built_in">number</span></span>) {
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">SymbolGlyph</span>($r(<span class="hljs-string">'sys.symbol.bell_fill'</span>))
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
          .<span class="hljs-title function_">renderingStrategy</span>(<span class="hljs-title class_">SymbolRenderingStrategy</span>.<span class="hljs-property">SINGLE</span>)
          .<span class="hljs-title function_">fontColor</span>([<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>])
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
        <span class="hljs-title class_">Text</span>(item)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })
      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
    }


    <span class="hljs-comment">/**
   *AUTHOR:AbnerMing
   *INTRODUCE:å¯ä»¥æ˜¯ä»»æ„å¸ƒå±€
   */</span>
    <span class="hljs-meta">@Builder</span>
    <span class="hljs-title function_">marqueeLayout2</span>(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, _: <span class="hljs-built_in">number</span></span>) {
      <span class="hljs-title class_">Column</span>() {
        <span class="hljs-title class_">Image</span>(<span class="hljs-string">"https://loveharmony.oss-cn-beijing.aliyuncs.com/banner/banner_01.jpg"</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
        <span class="hljs-title class_">Text</span>(item)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })
      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
    }

    <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
      <span class="hljs-title class_">Column</span>() {
        <span class="hljs-title class_">ActionBar</span>({ <span class="hljs-attr">title</span>: <span class="hljs-string">"æ¨ªå‘è¿ç»­è·‘é©¬ç¯"</span> })

        <span class="hljs-comment">//çº¯æ–‡æœ¬</span>
        <span class="hljs-title class_">MarqueeView</span>({
          <span class="hljs-attr">marqueeData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeDataArray</span>, <span class="hljs-comment">//å¯ä»¥ä¼ é€’ä»»æ„ç±»å‹æ•°æ®æ•°ç»„</span>
          <span class="hljs-attr">marqueeType</span>: <span class="hljs-title class_">MarqueeType</span>.<span class="hljs-property">continuous</span>, <span class="hljs-comment">//è¿ç»­æ»šåŠ¨</span>
          <span class="hljs-attr">marqueeDirection</span>: <span class="hljs-title class_">MarqueeDirection</span>.<span class="hljs-property">horizontal</span>, <span class="hljs-comment">//æ¨ªå‘</span>
          <span class="hljs-attr">marqueeLayout</span>: <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">Object</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">marqueeText</span>(item <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, index)
          }
        }).<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span> })

        <span class="hljs-comment">//è‡ªå®šä¹‰å¸ƒå±€1</span>
        <span class="hljs-title class_">MarqueeView</span>({
          <span class="hljs-attr">marqueeData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeDataArray</span>, <span class="hljs-comment">//å¯ä»¥ä¼ é€’ä»»æ„ç±»å‹æ•°æ®æ•°ç»„</span>
          <span class="hljs-attr">marqueeType</span>: <span class="hljs-title class_">MarqueeType</span>.<span class="hljs-property">continuous</span>, <span class="hljs-comment">//è¿ç»­æ»šåŠ¨</span>
          <span class="hljs-attr">marqueeDirection</span>: <span class="hljs-title class_">MarqueeDirection</span>.<span class="hljs-property">horizontal</span>, <span class="hljs-comment">//æ¨ªå‘</span>
          <span class="hljs-attr">marqueeLayout</span>: <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">Object</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">marqueeLayout</span>(item <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, index)
          }
        }).<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span> })
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })

        <span class="hljs-comment">//è‡ªå®šä¹‰å¸ƒå±€2</span>
        <span class="hljs-title class_">MarqueeView</span>({
          <span class="hljs-attr">marqueeData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">marqueeDataArray</span>, <span class="hljs-comment">//å¯ä»¥ä¼ é€’ä»»æ„ç±»å‹æ•°æ®æ•°ç»„</span>
          <span class="hljs-attr">marqueeType</span>: <span class="hljs-title class_">MarqueeType</span>.<span class="hljs-property">continuous</span>, <span class="hljs-comment">//è¿ç»­æ»šåŠ¨</span>
          <span class="hljs-attr">marqueeDirection</span>: <span class="hljs-title class_">MarqueeDirection</span>.<span class="hljs-property">horizontal</span>, <span class="hljs-comment">//æ¨ªå‘</span>
          <span class="hljs-attr">marqueeLayout</span>: <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">Object</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">marqueeLayout2</span>(item <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, index)
          }
        }).<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span> })
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })

      }
      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">10</span> })
    }
  }
</code></pre>
<h2 data-id="heading-11">ç›¸å…³æ€»ç»“</h2>
<p>åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œå¦‚æœæ˜¯æ¨ªå‘çš„è¿ç»­æ»šåŠ¨ï¼Œå¹¶ä¸”æ˜¯æ–‡æœ¬ç±»å‹çš„ï¼Œé‚£ä¹ˆå»ºè®®ç›´æ¥ä½¿ç”¨ç³»ç»Ÿçš„Textç»„ä»¶æˆ–è€…Marqueeç»„ä»¶ï¼Œå½“ç„¶äº†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œæˆ‘å¼€å‘å¥½çš„marqueeç»„ä»¶ï¼Œé‡Œé¢ä¹Ÿå®ç°äº†ç³»ç»Ÿçš„èƒ½åŠ›ï¼Œå…¶å®æ˜¯ä¸€æ ·çš„ã€‚å¦‚æœæ˜¯éæ–‡æœ¬ï¼Œé‚£æ²¡æœ‰åˆ«çš„åŠæ³•ï¼Œåªèƒ½ä½¿ç”¨è‡ªå®šä¹‰çš„marqueeç»„ä»¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScriptåŸå‹ä¸åŸå‹é“¾ï¼šæ·±å…¥ç†è§£é¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºçŸ³]]></title>    <link>https://juejin.cn/post/7573530680886542370</link>    <guid>https://juejin.cn/post/7573530680886542370</guid>    <pubDate>2025-11-17T13:30:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573530680886542370" data-draft-id="7573508361741795328" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScriptåŸå‹ä¸åŸå‹é“¾ï¼šæ·±å…¥ç†è§£é¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºçŸ³"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-11-17T13:30:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿›å‡»çš„é‡äºº"/> <meta itemprop="url" content="https://juejin.cn/user/1458425238667008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScriptåŸå‹ä¸åŸå‹é“¾ï¼šæ·±å…¥ç†è§£é¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºçŸ³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1458425238667008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿›å‡»çš„é‡äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T13:30:11.000Z" title="Mon Nov 17 2025 13:30:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨JavaScriptçš„ä¸–ç•Œä¸­ï¼ŒåŸå‹ï¼ˆPrototypeï¼‰æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒæ„æˆäº†JavaScripté¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºçŸ³ã€‚å¯¹äºè®¸å¤šåˆå­¦è€…æ¥è¯´ï¼ŒåŸå‹å’ŒåŸå‹é“¾å¯èƒ½æ˜¯æœ€ä»¤äººå›°æƒ‘çš„æ¦‚å¿µä¹‹ä¸€ï¼Œä½†ä¸€æ—¦æ·±å…¥ç†è§£ï¼Œå°±ä¼šå‘ç°å®ƒå®é™…ä¸Šæ˜¯JavaScriptæœ€å¼ºå¤§ã€æœ€çµæ´»çš„ç‰¹æ€§ä¹‹ä¸€ã€‚æœ¬æ–‡å°†é€šè¿‡è¯¦ç»†çš„ç†è®ºè§£é‡Šå’Œä¸°å¯Œçš„ä»£ç ç¤ºä¾‹ï¼Œå…¨é¢å‰–æJavaScriptä¸­çš„åŸå‹å¯¹è±¡ã€åŸå‹ç»§æ‰¿ä»¥åŠåŸå‹é“¾æœºåˆ¶ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€åŸå‹å¯¹è±¡ï¼šå…±äº«å±æ€§å’Œæ–¹æ³•çš„æ™ºæ…§</h2>
<h3 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯åŸå‹å¯¹è±¡</h3>
<p>åœ¨JavaScriptä¸­ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§<code>prototype</code>ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„åŸå‹å¯¹è±¡ã€‚è¿™ä¸ªå±æ€§æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯åŒ…å«å¯ä»¥ç”±ç‰¹å®šç±»å‹çš„æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname</span>){
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;
}
<span class="hljs-comment">// é€šè¿‡æ„é€ å‡½æ•°çš„prototypeå±æ€§è®¿é—®åŸå‹å¯¹è±¡</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// è¾“å‡ºåŸå‹å¯¹è±¡</span>
</code></pre>
<h3 data-id="heading-3">1.2 ä¸ºä»€ä¹ˆéœ€è¦åŸå‹å¯¹è±¡</h3>
<p>è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼šæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¹¶å®ä¾‹åŒ–äº†å¤šä¸ªå¯¹è±¡ã€‚å¦‚æœæ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„æ–¹æ³•å‰¯æœ¬ï¼Œä¼šé€ æˆå†…å­˜çš„æå¤§æµªè´¹ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸æ¨èçš„æ–¹å¼ï¼šæ¯ä¸ªå®ä¾‹éƒ½æœ‰ç‹¬ç«‹çš„æ–¹æ³•å‰¯æœ¬</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname</span>){
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> + <span class="hljs-string">'ä¼šå”±æ­Œ'</span>);
  }
}

<span class="hljs-keyword">const</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">'åˆ˜å¾·å'</span>);
<span class="hljs-keyword">const</span> zxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">'å¼ å­¦å‹'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ldh.<span class="hljs-property">sing</span> === zxy.<span class="hljs-property">sing</span>); <span class="hljs-comment">// falseï¼Œæ–¹æ³•æ˜¯ä¸åŒçš„å‡½æ•°å®ä¾‹</span>
</code></pre>
<p>ä½¿ç”¨åŸå‹å¯¹è±¡å¯ä»¥ä¼˜é›…åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨èçš„æ–¹å¼ï¼šæ–¹æ³•å®šä¹‰åœ¨åŸå‹ä¸Šï¼Œæ‰€æœ‰å®ä¾‹å…±äº«</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname</span>){
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;
}

<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> + <span class="hljs-string">'ä¼šå”±æ­Œ'</span>);
}

<span class="hljs-keyword">const</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">'åˆ˜å¾·å'</span>);
<span class="hljs-keyword">const</span> zxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">'å¼ å­¦å‹'</span>);

ldh.<span class="hljs-title function_">sing</span>(); <span class="hljs-comment">// åˆ˜å¾·åä¼šå”±æ­Œ</span>
zxy.<span class="hljs-title function_">sing</span>(); <span class="hljs-comment">// å¼ å­¦å‹ä¼šå”±æ­Œ</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ldh.<span class="hljs-property">sing</span> === zxy.<span class="hljs-property">sing</span>); <span class="hljs-comment">// trueï¼Œæ‰€æœ‰å®ä¾‹å…±äº«åŒä¸€ä¸ªæ–¹æ³•</span>
</code></pre>
<h3 data-id="heading-4">1.3 åŸå‹å¯¹è±¡çš„å·¥ä½œåŸç†</h3>
<p>å½“æˆ‘ä»¬è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•æ—¶ï¼ŒJavaScriptå¼•æ“ä¼šé¦–å…ˆåœ¨å¯¹è±¡è‡ªèº«æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå°±ä¼šæ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§æˆ–åˆ°è¾¾åŸå‹é“¾çš„æœ«ç«¯ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname</span>){
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;
}

<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> + <span class="hljs-string">'ä¼šå”±æ­Œ'</span>);
}

<span class="hljs-keyword">const</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">'åˆ˜å¾·å'</span>);

<span class="hljs-comment">// ldhå¯¹è±¡æœ¬èº«æ²¡æœ‰singæ–¹æ³•ï¼Œä½†é€šè¿‡åŸå‹é“¾å¯ä»¥è®¿é—®åˆ°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ldh.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'sing'</span>)); <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'sing'</span> <span class="hljs-keyword">in</span> ldh); <span class="hljs-comment">// true</span>
ldh.<span class="hljs-title function_">sing</span>(); <span class="hljs-comment">// åˆ˜å¾·åä¼šå”±æ­Œ</span>
</code></pre>
<h3 data-id="heading-5">1.4 åŸå‹å¯¹è±¡ä¸­çš„thisæŒ‡å‘</h3>
<p>ä¸€ä¸ªé‡è¦çš„ç»†èŠ‚æ˜¯ï¼šæ— è®ºæ–¹æ³•å®šä¹‰åœ¨æ„é€ å‡½æ•°ä¸­è¿˜æ˜¯åŸå‹å¯¹è±¡ä¸­ï¼Œæ–¹æ³•å†…éƒ¨çš„thiséƒ½æŒ‡å‘è°ƒç”¨è¯¥æ–¹æ³•çš„å®ä¾‹å¯¹è±¡ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname</span>){
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;
}

<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
  <span class="hljs-comment">// è¿™é‡Œçš„thisæŒ‡å‘è°ƒç”¨è¯¥æ–¹æ³•çš„å®ä¾‹å¯¹è±¡</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> + <span class="hljs-string">'ä¼šå”±æ­Œ'</span>);
}

<span class="hljs-keyword">const</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">'åˆ˜å¾·å'</span>);
ldh.<span class="hljs-title function_">sing</span>(); <span class="hljs-comment">// è¾“å‡º"åˆ˜å¾·åä¼šå”±æ­Œ"ï¼ŒthisæŒ‡å‘ldhå®ä¾‹</span>
</code></pre>
<h2 data-id="heading-6">äºŒã€constructorå±æ€§ï¼šè¿æ¥å®ä¾‹ä¸æ„é€ å‡½æ•°çš„æ¡¥æ¢</h2>
<h3 data-id="heading-7">2.1 åŸå‹å¯¹è±¡ä¸­çš„constructorå±æ€§</h3>
<p>æ¯ä¸ªåŸå‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>constructor</code>å±æ€§ï¼Œé»˜è®¤æŒ‡å‘è¯¥åŸå‹å¯¹è±¡æ‰€å±çš„æ„é€ å‡½æ•°ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">function Star(uname){
  <span class="hljs-attr">this.uname</span> = uname<span class="hljs-comment">;</span>
}

console.log(<span class="hljs-attr">Star.prototype.constructor</span> === Star)<span class="hljs-comment">; // true</span>
</code></pre>
<h3 data-id="heading-8">2.2 å®ä¾‹å¯¹è±¡ä¸­çš„constructorå±æ€§</h3>
<p>é€šè¿‡å®ä¾‹å¯¹è±¡è®¿é—®constructorå±æ€§æ—¶ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡åŸå‹é“¾è®¿é—®åˆ°åŸå‹å¯¹è±¡çš„constructorå±æ€§ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">function Star(uname){
  <span class="hljs-attr">this.uname</span> = uname<span class="hljs-comment">;</span>
}

const <span class="hljs-attr">ldh</span> = new Star(<span class="hljs-string">'åˆ˜å¾·å'</span>)<span class="hljs-comment">;</span>
console.log(<span class="hljs-attr">ldh.constructor</span> === Star)<span class="hljs-comment">; // true</span>
</code></pre>
<h3 data-id="heading-9">2.3 é‡å†™åŸå‹å¯¹è±¡æ—¶çš„constructoré—®é¢˜</h3>
<p>å½“æˆ‘ä»¬å®Œå…¨é‡å†™åŸå‹å¯¹è±¡æ—¶ï¼Œä¼šä¸¢å¤±åŸæœ‰çš„constructorå±æ€§ï¼Œéœ€è¦æ‰‹åŠ¨é‡æ–°æŒ‡å‘ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname</span>){
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;
}

<span class="hljs-comment">// å®Œå…¨é‡å†™åŸå‹å¯¹è±¡</span>
<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-attr">sing</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> + <span class="hljs-string">'ä¼šå”±æ­Œ'</span>);
  },
  <span class="hljs-attr">dance</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> + <span class="hljs-string">'ä¼šè·³èˆ'</span>);
  }
};

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Star</span>); <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Object</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æ­£ç¡®çš„æ–¹å¼ï¼šé‡å†™åŸå‹å¯¹è±¡æ—¶æ‰‹åŠ¨è®¾ç½®constructor</span>
<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-attr">constructor</span>: <span class="hljs-title class_">Star</span>, <span class="hljs-comment">// æ‰‹åŠ¨æŒ‡å‘æ„é€ å‡½æ•°</span>
  <span class="hljs-attr">sing</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> + <span class="hljs-string">'ä¼šå”±æ­Œ'</span>);
  },
  <span class="hljs-attr">dance</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> + <span class="hljs-string">'ä¼šè·³èˆ'</span>);
  }
};

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Star</span>); <span class="hljs-comment">// true</span>
</code></pre>
<h2 data-id="heading-10">ä¸‰ã€å¯¹è±¡åŸå‹ï¼š<code>__proto__</code>ä¸åŸå‹é“¾çš„çº½å¸¦</h2>
<h3 data-id="heading-11">3.1 ä»€ä¹ˆæ˜¯å¯¹è±¡åŸå‹</h3>
<p>æ¯ä¸ªJavaScriptå¯¹è±¡ï¼ˆé™¤nullå¤–ï¼‰éƒ½æœ‰ä¸€ä¸ªå†…ç½®å±æ€§<code>[[Prototype]]</code>ï¼Œåœ¨å¤§å¤šæ•°æµè§ˆå™¨ä¸­å¯ä»¥é€šè¿‡<code>__proto__</code>å±æ€§è®¿é—®ã€‚è¿™ä¸ªå±æ€§æŒ‡å‘åˆ›å»ºè¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">function Star(uname){
  <span class="hljs-attr">this.uname</span> = uname<span class="hljs-comment">;</span>
}

const <span class="hljs-attr">ldh</span> = new Star(<span class="hljs-string">'åˆ˜å¾·å'</span>)<span class="hljs-comment">;</span>

// å®ä¾‹å¯¹è±¡çš„__proto__æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡
console.log(<span class="hljs-attr">ldh.__proto__</span> === Star.prototype)<span class="hljs-comment">; // true</span>
</code></pre>
<h3 data-id="heading-12">3.2Â <code>__proto__</code>ä¸prototypeçš„å…³ç³»</h3>
<ul>
<li><code>prototype</code>æ˜¯æ„é€ å‡½æ•°çš„å±æ€§ï¼ŒæŒ‡å‘åŸå‹å¯¹è±¡</li>
<li><code>__proto__</code>æ˜¯å®ä¾‹å¯¹è±¡çš„å±æ€§ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡</li>
</ul>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">function Star(uname){
  <span class="hljs-attr">this.uname</span> = uname<span class="hljs-comment">;</span>
}

const <span class="hljs-attr">ldh</span> = new Star(<span class="hljs-string">'åˆ˜å¾·å'</span>)<span class="hljs-comment">;</span>

// ä¸‰è€…å…³ç³»
console.log(<span class="hljs-attr">ldh.__proto__</span> === Star.prototype)<span class="hljs-comment">; // true</span>
console.log(<span class="hljs-attr">Star.prototype.constructor</span> === Star)<span class="hljs-comment">; // true</span>
console.log(<span class="hljs-attr">ldh.constructor</span> === Star)<span class="hljs-comment">; // true</span>
</code></pre>
<h3 data-id="heading-13">3.3 å¯¹è±¡åŸå‹çš„å®é™…æ„ä¹‰</h3>
<p>å¯¹è±¡åŸå‹<code>__proto__</code>çš„ä¸»è¦æ„ä¹‰åœ¨äºä¸ºå¯¹è±¡æˆå‘˜æŸ¥æ‰¾æœºåˆ¶æä¾›ä¸€ä¸ªæ–¹å‘ï¼Œæˆ–è€…è¯´ä¸€æ¡è·¯çº¿ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®¨è®ºçš„åŸå‹é“¾ã€‚</p>
<h2 data-id="heading-14">å››ã€åŸå‹ç»§æ‰¿ï¼šå®ç°ä»£ç å¤ç”¨çš„ä¼˜é›…æ–¹å¼</h2>
<h3 data-id="heading-15">4.1 ä»€ä¹ˆæ˜¯åŸå‹ç»§æ‰¿</h3>
<p>åŸå‹ç»§æ‰¿æ˜¯JavaScriptä¸­å®ç°ç»§æ‰¿çš„ä¸»è¦æ–¹å¼ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šè®©ä¸€ä¸ªæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ç­‰äºå¦ä¸€ä¸ªæ„é€ å‡½æ•°çš„å®ä¾‹ï¼Œè¿™æ ·å‰è€…å°±å¯ä»¥ç»§æ‰¿åè€…çš„å±æ€§å’Œæ–¹æ³•ã€‚</p>
<h3 data-id="heading-16">4.2 åŸå‹ç»§æ‰¿çš„å®ç°</h3>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">// çˆ¶ç±»
function Person(){
  <span class="hljs-attr">this.eyes</span> = <span class="hljs-number">2</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">this.head</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
}

// å­ç±»
function Woman(sex){
  <span class="hljs-attr">this.sex</span> = sex<span class="hljs-comment">;</span>
}

function Man(sex){
  <span class="hljs-attr">this.sex</span> = sex<span class="hljs-comment">;</span>
}

// å®ç°ç»§æ‰¿ï¼šå­ç±»çš„åŸå‹å¯¹è±¡æ˜¯çˆ¶ç±»çš„å®ä¾‹
<span class="hljs-attr">Woman.prototype</span> = new Person()<span class="hljs-comment">;</span>
// ä¿®å¤constructoræŒ‡å‘
<span class="hljs-attr">Woman.prototype.constructor</span> = Woman<span class="hljs-comment">;</span>

<span class="hljs-attr">Man.prototype</span> = new Person()<span class="hljs-comment">;</span>
<span class="hljs-attr">Man.prototype.constructor</span> = Man<span class="hljs-comment">;</span>

const <span class="hljs-attr">red</span> = new Woman(<span class="hljs-string">'å¥³'</span>)<span class="hljs-comment">;</span>
console.log(red.eyes)<span class="hljs-comment">; // 2ï¼Œç»§æ‰¿è‡ªPerson</span>
console.log(red.head)<span class="hljs-comment">; // 1ï¼Œç»§æ‰¿è‡ªPerson</span>
console.log(red.sex)<span class="hljs-comment">; // å¥³ï¼Œè‡ªèº«çš„å±æ€§</span>

const <span class="hljs-attr">blue</span> = new Man(<span class="hljs-string">'ç”·'</span>)<span class="hljs-comment">;</span>
console.log(blue.eyes)<span class="hljs-comment">; // 2ï¼Œç»§æ‰¿è‡ªPerson</span>
console.log(blue.head)<span class="hljs-comment">; // 1ï¼Œç»§æ‰¿è‡ªPerson</span>
console.log(blue.sex)<span class="hljs-comment">; // ç”·ï¼Œè‡ªèº«çš„å±æ€§</span>
</code></pre>
<h3 data-id="heading-17">4.3 åŸå‹ç»§æ‰¿çš„å†…å­˜æ•ˆç‡</h3>
<p>é€šè¿‡åŸå‹ç»§æ‰¿ï¼Œæ‰€æœ‰å­ç±»å®ä¾‹å…±äº«çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œè¿™å¤§å¤§æé«˜äº†å†…å­˜ä½¿ç”¨æ•ˆç‡ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">function Person(){
  <span class="hljs-attr">this.eyes</span> = <span class="hljs-number">2</span><span class="hljs-comment">;</span>
}

<span class="hljs-attr">Person.prototype.breathe</span> = function(){
  console.log('å‘¼å¸')<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

function Woman(sex){
  <span class="hljs-attr">this.sex</span> = sex<span class="hljs-comment">;</span>
}

<span class="hljs-attr">Woman.prototype</span> = new Person()<span class="hljs-comment">;</span>
<span class="hljs-attr">Woman.prototype.constructor</span> = Woman<span class="hljs-comment">;</span>

const <span class="hljs-attr">red</span> = new Woman(<span class="hljs-string">'å¥³'</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">pink</span> = new Woman(<span class="hljs-string">'å¥³'</span>)<span class="hljs-comment">;</span>

// ä¸¤ä¸ªå®ä¾‹å…±äº«åŒä¸€ä¸ªbreatheæ–¹æ³•
console.log(<span class="hljs-attr">red.breathe</span> === pink.breathe)<span class="hljs-comment">; // true</span>
</code></pre>
<h3 data-id="heading-18">4.4 æ–¹æ³•é‡å†™ä¸å±æ€§å±è”½</h3>
<p>å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œæˆ–è€…åœ¨å®ä¾‹ä¸Šå®šä¹‰ä¸åŸå‹é“¾ä¸ŠåŒåçš„å±æ€§ï¼Œå®ç°å±æ€§å±è”½ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">eyes</span> = <span class="hljs-number">2</span>;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">see</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨çœ¼ç›çœ‹'</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Superman</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">eyes</span> = <span class="hljs-number">3</span>; <span class="hljs-comment">// å±æ€§å±è”½</span>
}

<span class="hljs-title class_">Superman</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();
<span class="hljs-title class_">Superman</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Superman</span>;

<span class="hljs-comment">// æ–¹æ³•é‡å†™</span>
<span class="hljs-title class_">Superman</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">see</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨è¶…çº§çœ¼ç›çœ‹'</span>);
};

<span class="hljs-keyword">const</span> clark = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Superman</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(clark.<span class="hljs-property">eyes</span>); <span class="hljs-comment">// 3ï¼Œè®¿é—®çš„æ˜¯è‡ªèº«å±æ€§</span>
clark.<span class="hljs-title function_">see</span>(); <span class="hljs-comment">// "ç”¨è¶…çº§çœ¼ç›çœ‹"ï¼Œè°ƒç”¨çš„æ˜¯é‡å†™åçš„æ–¹æ³•</span>
</code></pre>
<h2 data-id="heading-19">äº”ã€åŸå‹é“¾ï¼šJavaScriptå¯¹è±¡æŸ¥æ‰¾æœºåˆ¶çš„æ ¸å¿ƒ</h2>
<h3 data-id="heading-20">5.1 ä»€ä¹ˆæ˜¯åŸå‹é“¾</h3>
<p>åŸå‹é“¾æ˜¯JavaScriptä¸­å®ç°ç»§æ‰¿å’Œå±æ€§æŸ¥æ‰¾çš„æœºåˆ¶ã€‚å½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼ŒJavaScriptå¼•æ“ä¼šæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>é¦–å…ˆåœ¨å¯¹è±¡è‡ªèº«æŸ¥æ‰¾è¯¥å±æ€§</li>
<li>å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™åœ¨è¯¥å¯¹è±¡çš„åŸå‹ï¼ˆ<code>__proto__</code>æŒ‡å‘çš„å¯¹è±¡ï¼‰ä¸ŠæŸ¥æ‰¾</li>
<li>å¦‚æœè¿˜æ‰¾ä¸åˆ°ï¼Œåˆ™ç»§ç»­åœ¨åŸå‹çš„åŸå‹ä¸ŠæŸ¥æ‰¾</li>
<li>ä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§æˆ–åˆ°è¾¾åŸå‹é“¾çš„é¡¶ç«¯ï¼ˆnullï¼‰</li>
</ol>
<h3 data-id="heading-21">5.2 åŸå‹é“¾çš„å›¾ç¤ºä¸ç†è§£</h3>
<p>è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">function Person(name){
  <span class="hljs-attr">this.name</span> = name<span class="hljs-comment">;</span>
}

<span class="hljs-attr">Person.prototype.sayHello</span> = function(){
  console.log('Hello, I am ' + this.name)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

function Student(name, grade){
  <span class="hljs-attr">this.name</span> = name<span class="hljs-comment">;</span>
  <span class="hljs-attr">this.grade</span> = grade<span class="hljs-comment">;</span>
}

// å®ç°ç»§æ‰¿
<span class="hljs-attr">Student.prototype</span> = new Person()<span class="hljs-comment">;</span>
<span class="hljs-attr">Student.prototype.constructor</span> = Student<span class="hljs-comment">;</span>

<span class="hljs-attr">Student.prototype.study</span> = function(){
  console.log(this.name + ' is studying')<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

const <span class="hljs-attr">tom</span> = new Student(<span class="hljs-string">'Tom'</span>, <span class="hljs-number">5</span>)<span class="hljs-comment">;</span>
</code></pre>
<p>æ­¤æ—¶çš„åŸå‹é“¾å…³ç³»ä¸ºï¼š</p>
<p>text</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript">tom -&gt; <span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> -&gt; <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> -&gt; <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> -&gt; <span class="hljs-literal">null</span>
</code></pre>
<p>å±æ€§æŸ¥æ‰¾è¿‡ç¨‹ï¼š</p>
<ul>
<li><code>tom.grade</code>ï¼šåœ¨tomå¯¹è±¡è‡ªèº«æ‰¾åˆ°</li>
<li><code>tom.study</code>ï¼šåœ¨Student.prototypeä¸­æ‰¾åˆ°</li>
<li><code>tom.sayHello</code>ï¼šåœ¨Person.prototypeä¸­æ‰¾åˆ°</li>
<li><code>tom.toString</code>ï¼šåœ¨Object.prototypeä¸­æ‰¾åˆ°</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bcb99d126514872abf8071b32e005d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE6YeO5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763991011&amp;x-signature=47n9oWTIVto3%2FIjXZtdbgG49MxQ%3D" alt="9f7a6fe1f768b069e3c5125a949cf993.png" loading="lazy"/></p>
<h3 data-id="heading-22">5.3 åŸå‹é“¾çš„ç»ˆç‚¹</h3>
<p>æ‰€æœ‰æ™®é€šçš„åŸå‹é“¾æœ€ç»ˆéƒ½ä¼šæŒ‡å‘Object.prototypeï¼Œè€ŒObject.prototypeçš„<code>__proto__</code>æŒ‡å‘nullï¼Œè¿™æ˜¯åŸå‹é“¾çš„ç»ˆç‚¹ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"/>){}

<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-literal">null</span>); <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-23">5.4 instanceofæ“ä½œç¬¦</h3>
<p><code>instanceof</code>è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„prototypeå±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params"/>){}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Student</span>(<span class="hljs-params"/>){}

<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();
<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Student</span>;

<span class="hljs-keyword">const</span> tom = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Student</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>); <span class="hljs-comment">// false</span>
</code></pre>
<h3 data-id="heading-24">5.5 åŸå‹é“¾ä¸æ€§èƒ½è€ƒè™‘</h3>
<p>è™½ç„¶åŸå‹é“¾æä¾›äº†å¼ºå¤§çš„ç»§æ‰¿æœºåˆ¶ï¼Œä½†è¿‡é•¿çš„åŸå‹é“¾å¯èƒ½ä¼šå½±å“æ€§èƒ½ï¼Œå› ä¸ºå±æ€§æŸ¥æ‰¾éœ€è¦éå†æ•´ä¸ªåŸå‹é“¾ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œåº”å°½é‡é¿å…è¿‡æ·±çš„ç»§æ‰¿å±‚æ¬¡ã€‚</p>
<h2 data-id="heading-25">å…­ã€å®é™…åº”ç”¨ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-26">6.1 ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼</h3>
<p>è¿™æ˜¯åˆ›å»ºè‡ªå®šä¹‰ç±»å‹çš„æœ€å¸¸è§æ–¹å¼ï¼Œé€šè¿‡æ„é€ å‡½æ•°å®šä¹‰å®ä¾‹å±æ€§ï¼Œé€šè¿‡åŸå‹å®šä¹‰å…±äº«çš„æ–¹æ³•å’Œå±æ€§ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æœ€ä½³å®è·µï¼šç»„åˆä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>){
  <span class="hljs-comment">// å®ä¾‹å±æ€§</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-comment">// å…±äº«æ–¹æ³•</span>
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Hello, I am '</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
};

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
  <span class="hljs-keyword">return</span> <span class="hljs-string">'[Person: '</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">', '</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> + <span class="hljs-string">']'</span>;
};

<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'Alice'</span>, <span class="hljs-number">25</span>);
<span class="hljs-keyword">const</span> bob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'Bob'</span>, <span class="hljs-number">30</span>);

alice.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// Hello, I am Alice</span>
bob.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// Hello, I am Bob</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(alice.<span class="hljs-title function_">toString</span>()); <span class="hljs-comment">// [Person: Alice, 25]</span>
</code></pre>
<h3 data-id="heading-27">6.2 åŸå‹ä¸å¯¹è±¡åˆ›å»ºæ€§èƒ½</h3>
<p>åœ¨éœ€è¦åˆ›å»ºå¤§é‡ç›¸ä¼¼å¯¹è±¡çš„åœºæ™¯ä¸­ï¼Œä½¿ç”¨åŸå‹å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ€§èƒ½å¯¹æ¯”ï¼šä½¿ç”¨åŸå‹ vs ä¸ä½¿ç”¨åŸå‹</span>

<span class="hljs-comment">// æ–¹å¼1ï¼šä¸ä½¿ç”¨åŸå‹ï¼ˆæ€§èƒ½è¾ƒå·®ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createUserWithoutPrototype</span>(<span class="hljs-params">name, email</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: name,
    <span class="hljs-attr">email</span>: email,
    <span class="hljs-attr">getInfo</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">' &lt;'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">email</span> + <span class="hljs-string">'&gt;'</span>;
    }
  };
}

<span class="hljs-comment">// æ–¹å¼2ï¼šä½¿ç”¨åŸå‹ï¼ˆæ€§èƒ½è¾ƒå¥½ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">User</span>(<span class="hljs-params">name, email</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">email</span> = email;
}

<span class="hljs-title class_">User</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getInfo</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">' &lt;'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">email</span> + <span class="hljs-string">'&gt;'</span>;
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createUserWithPrototype</span>(<span class="hljs-params">name, email</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(name, email);
}

<span class="hljs-comment">// æµ‹è¯•æ€§èƒ½</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'Without Prototype'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000</span>; i++) {
  <span class="hljs-title function_">createUserWithoutPrototype</span>(<span class="hljs-string">'user'</span> + i, <span class="hljs-string">'user'</span> + i + <span class="hljs-string">'@example.com'</span>);
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'Without Prototype'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'With Prototype'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000</span>; i++) {
  <span class="hljs-title function_">createUserWithPrototype</span>(<span class="hljs-string">'user'</span> + i, <span class="hljs-string">'user'</span> + i + <span class="hljs-string">'@example.com'</span>);
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'With Prototype'</span>);
</code></pre>
<h2 data-id="heading-28">ä¸ƒã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-29">7.1 åŸå‹å¯¹è±¡å…±äº«å¼•ç”¨ç±»å‹å€¼çš„é—®é¢˜</h3>
<p>å½“åŸå‹å¯¹è±¡åŒ…å«å¼•ç”¨ç±»å‹å€¼æ—¶ï¼Œæ‰€æœ‰å®ä¾‹ä¼šå…±äº«åŒä¸€ä¸ªå¼•ç”¨ï¼Œè¿™å¯èƒ½å¯¼è‡´æ„å¤–çš„è¡Œä¸ºã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-ini" lang="ini">// é—®é¢˜ï¼šå…±äº«å¼•ç”¨ç±»å‹å€¼
function Person(name){
  <span class="hljs-attr">this.name</span> = name<span class="hljs-comment">;</span>
}

<span class="hljs-attr">Person.prototype.friends</span> = []<span class="hljs-comment">; // å¼•ç”¨ç±»å‹å€¼</span>

const <span class="hljs-attr">alice</span> = new Person(<span class="hljs-string">'Alice'</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">bob</span> = new Person(<span class="hljs-string">'Bob'</span>)<span class="hljs-comment">;</span>

alice.friends.push('Charlie')<span class="hljs-comment">;</span>
console.log(bob.friends)<span class="hljs-comment">; // ['Charlie']ï¼Œbobä¹Ÿå—åˆ°äº†å½±å“</span>

// è§£å†³æ–¹æ¡ˆï¼šåœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§
function BetterPerson(name){
  <span class="hljs-attr">this.name</span> = name<span class="hljs-comment">;</span>
  <span class="hljs-attr">this.friends</span> = []<span class="hljs-comment">; // æ¯ä¸ªå®ä¾‹æœ‰è‡ªå·±çš„friendsæ•°ç»„</span>
}

<span class="hljs-attr">BetterPerson.prototype.addFriend</span> = function(friend){
  this.friends.push(friend)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

const <span class="hljs-attr">carol</span> = new BetterPerson(<span class="hljs-string">'Carol'</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">dave</span> = new BetterPerson(<span class="hljs-string">'Dave'</span>)<span class="hljs-comment">;</span>

carol.addFriend('Eve')<span class="hljs-comment">;</span>
console.log(carol.friends)<span class="hljs-comment">; // ['Eve']</span>
console.log(dave.friends)<span class="hljs-comment">; // []ï¼Œdaveä¸å—å½±å“</span>
</code></pre>
<h3 data-id="heading-30">7.2 åŸå‹é“¾ä¸æšä¸¾å±æ€§</h3>
<p>ä½¿ç”¨<code>for...in</code>å¾ªç¯æ—¶ä¼šéå†å¯¹è±¡è‡ªèº«å’ŒåŸå‹é“¾ä¸Šçš„å¯æšä¸¾å±æ€§ï¼Œè¿™å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„è¡Œä¸ºã€‚</p>
<p>javascript</p>
<p>å¤åˆ¶ä¸‹è½½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>){
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Hello'</span>);
};

<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'Alice'</span>);

<span class="hljs-comment">// for...inä¼šéå†åŸå‹é“¾ä¸Šçš„å±æ€§</span>
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> person){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key); <span class="hljs-comment">// è¾“å‡º: name, sayHello</span>
}

<span class="hljs-comment">// è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨hasOwnPropertyè¿‡æ»¤</span>
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> person){
  <span class="hljs-keyword">if</span>(person.<span class="hljs-title function_">hasOwnProperty</span>(key)){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key); <span class="hljs-comment">// åªè¾“å‡º: name</span>
  }
}
</code></pre>
<h2 data-id="heading-31">ç»“è®º</h2>
<p>JavaScriptçš„åŸå‹æœºåˆ¶æ˜¯å…¶é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒï¼Œç†è§£åŸå‹å¯¹è±¡ã€åŸå‹ç»§æ‰¿å’ŒåŸå‹é“¾å¯¹äºæŒæ¡JavaScriptè‡³å…³é‡è¦ã€‚é€šè¿‡åŸå‹ï¼ŒJavaScriptå®ç°äº†é«˜æ•ˆçš„ä»£ç å¤ç”¨å’Œçµæ´»çš„ç»§æ‰¿æœºåˆ¶ã€‚è™½ç„¶ES6å¼•å…¥äº†classè¯­æ³•ï¼Œä½¿å…¶æ›´æ¥è¿‘ä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€ï¼Œä½†åº•å±‚ä»ç„¶æ˜¯åŸºäºåŸå‹çš„ç»§æ‰¿ã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ï¼š</p>
<ol>
<li>ç†è§£åŸå‹é“¾çš„å·¥ä½œåŸç†ï¼Œé¿å…è¿‡æ·±çš„ç»§æ‰¿å±‚æ¬¡</li>
<li>åˆç†ä½¿ç”¨åŸå‹å…±äº«æ–¹æ³•ï¼Œæé«˜å†…å­˜æ•ˆç‡</li>
<li>æ³¨æ„å¼•ç”¨ç±»å‹å€¼çš„å…±äº«é—®é¢˜</li>
<li>æŒæ¡ç°ä»£classè¯­æ³•ï¼ŒåŒæ—¶ç†è§£å…¶èƒŒåçš„åŸå‹æœºåˆ¶</li>
</ol>
<p>é€šè¿‡æ·±å…¥ç†è§£å’Œåˆç†åº”ç”¨åŸå‹ç›¸å…³æ¦‚å¿µï¼Œæˆ‘ä»¬èƒ½å¤Ÿç¼–å†™å‡ºæ›´åŠ é«˜æ•ˆã€å¯ç»´æŠ¤çš„JavaScriptä»£ç ï¼Œå……åˆ†åˆ©ç”¨JavaScriptè¿™é—¨è¯­è¨€çš„å¼ºå¤§ç‰¹æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3é¡¹ç›®è®°å½•]]></title>    <link>https://juejin.cn/post/7573521516324585499</link>    <guid>https://juejin.cn/post/7573521516324585499</guid>    <pubDate>2025-11-17T14:31:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573521516324585499" data-draft-id="7573528564026294318" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3é¡¹ç›®è®°å½•"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-11-17T14:31:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘µé˜¿å’¯å’¯"/> <meta itemprop="url" content="https://juejin.cn/user/26044011932647"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3é¡¹ç›®è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/26044011932647/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘µé˜¿å’¯å’¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T14:31:43.000Z" title="Mon Nov 17 2025 14:31:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€Vue ç»‘å®šå±æ€§çš„æ ¸å¿ƒé—®é¢˜</h2>
<h3 data-id="heading-1">ï¼ˆä¸€ï¼‰æ ¸å¿ƒé—®é¢˜</h3>
<p>ç»‘å®šå±æ€§æ—¶ï¼Œå³ä½¿ç»‘å®šçš„å€¼æ˜¯å¸¸é‡Â <code>false</code>ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨Â <code>:</code>Â å‰ç¼€ã€‚å…³é”®è®¤çŸ¥ï¼š<code>:</code>Â çš„ä½œç”¨æ˜¯åŒºåˆ†å­—ç¬¦ä¸² vs JavaScript å€¼ï¼Œè€Œé â€œå›ºå®šå€¼ vs å˜é‡â€ã€‚</p>
<h3 data-id="heading-2">ï¼ˆäºŒï¼‰å…³é”®å¯¹æ¯”</h3>
<h4 data-id="heading-3">1. ä¸ç”¨Â <code>:</code>ï¼ˆHTML å±æ€§ï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">&lt;el-form <span class="hljs-attr">hide-required-asterisk</span>=<span class="hljs-string">"false"</span>&gt;
</code></pre>
<ul>
<li>æµè§ˆå™¨è§£æç»“æœï¼š<code>props.hideRequiredAsterisk = "false"</code>ï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼‰</li>
<li>JavaScript ä¸­é€»è¾‘ï¼šéç©ºå­—ç¬¦ä¸²å‡ä¸º truthyï¼Œ<code>if ("false")</code>Â ä¼šæ‰§è¡Œï¼Œæœ€ç»ˆç­‰æ•ˆäºÂ <code>true</code></li>
</ul>
<h4 data-id="heading-4">2. ç”¨Â <code>:</code>ï¼ˆJavaScript è¡¨è¾¾å¼ï¼‰</h4>
<pre><code class="hljs language-ruby" lang="ruby">&lt;el-form <span class="hljs-symbol">:hide-required-asterisk=<span class="hljs-string">"false"</span>&gt;</span>
</code></pre>
<ul>
<li>Vue è§£æç»“æœï¼š<code>props.hideRequiredAsterisk = false</code>ï¼ˆå¸ƒå°”ç±»å‹ï¼‰</li>
<li>JavaScript ä¸­é€»è¾‘ï¼š<code>if (false)</code>Â ä¸ä¼šæ‰§è¡Œï¼Œç¬¦åˆé¢„æœŸæ•ˆæœ</li>
</ul>
<h3 data-id="heading-5">ï¼ˆä¸‰ï¼‰å®é™…æµ‹è¯•éªŒè¯</h3>

























<table><thead><tr><th>ä»£ç å†™æ³•</th><th>è§£æç»“æœ</th><th>æ˜¯å¦æ­£ç¡®</th></tr></thead><tbody><tr><td><code>&lt;el-form hide-required-asterisk="false"&gt;</code></td><td>ç­‰æ•ˆäºÂ <code>:hide-required-asterisk="'false'"</code></td><td>âŒ</td></tr><tr><td><code>&lt;el-form :hide-required-asterisk="'false'"&gt;</code></td><td>ç­‰æ•ˆäºÂ <code>:hide-required-asterisk="true"</code></td><td>âŒ</td></tr><tr><td><code>&lt;el-form :hide-required-asterisk="false"&gt;</code></td><td>è§£æä¸ºå¸ƒå°”å€¼Â <code>false</code></td><td>âœ…</td></tr></tbody></table>
<h3 data-id="heading-6">ï¼ˆå››ï¼‰<code>:</code>Â çš„çœŸæ­£ä½œç”¨</h3>
<p>å‘Šè¯‰ Vueï¼šâ€œæŠŠå¼•å·é‡Œçš„å†…å®¹å½“ä½œ JavaScript ä»£ç æ‰§è¡Œï¼Œè€Œéå­—ç¬¦ä¸²â€ã€‚</p>
<h3 data-id="heading-7">ï¼ˆäº”ï¼‰å®Œæ•´ä½¿ç”¨ç¤ºä¾‹</h3>
<h4 data-id="heading-8">åœºæ™¯ 1ï¼šä¼ é€’å­—ç¬¦ä¸²ï¼ˆæ— éœ€Â <code>:</code>ï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">&lt;el-input <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥"</span>&gt;
</code></pre>
<ul>
<li>è§£æç»“æœï¼š<code>placeholder = "è¯·è¾“å…¥"</code>ï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼‰</li>
</ul>
<h4 data-id="heading-9">åœºæ™¯ 2ï¼šä¼ é€’æ•°å­—ï¼ˆéœ€è¦Â <code>:</code>ï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">&lt;el-input :<span class="hljs-attr">maxlength</span>=<span class="hljs-string">"100"</span>&gt;
</code></pre>
<ul>
<li>è§£æç»“æœï¼š<code>maxlength = 100</code>ï¼ˆæ•°å­—ç±»å‹ï¼Œéå­—ç¬¦ä¸² "100"ï¼‰</li>
</ul>
<h4 data-id="heading-10">åœºæ™¯ 3ï¼šä¼ é€’å¸ƒå°”å€¼ï¼ˆéœ€è¦Â <code>:</code>ï¼‰</h4>
<pre><code class="hljs language-ruby" lang="ruby">&lt;el-form <span class="hljs-symbol">:hide-required-asterisk=<span class="hljs-string">"false"</span>&gt;</span>
</code></pre>
<ul>
<li>è§£æç»“æœï¼š<code>hideRequiredAsterisk = false</code>ï¼ˆå¸ƒå°”ç±»å‹ï¼‰</li>
</ul>
<h4 data-id="heading-11">åœºæ™¯ 4ï¼šä¼ é€’å¯¹è±¡ï¼ˆéœ€è¦Â <code>:</code>ï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">&lt;el-form :<span class="hljs-attr">model</span>=<span class="hljs-string">"{ name: 'test' }"</span>&gt;
</code></pre>
<ul>
<li>è§£æç»“æœï¼š<code>model = { name: 'test' }</code>ï¼ˆå¯¹è±¡ç±»å‹ï¼‰</li>
</ul>
<h4 data-id="heading-12">åœºæ™¯ 5ï¼šä¼ é€’å˜é‡ï¼ˆéœ€è¦Â <code>:</code>ï¼‰</h4>
<pre><code class="hljs language-ruby" lang="ruby">&lt;el-form <span class="hljs-symbol">:hide-required-asterisk=<span class="hljs-string">"isReadOnly"</span>&gt;</span>
</code></pre>
<ul>
<li>è§£æç»“æœï¼š<code>hideRequiredAsterisk = isReadOnly</code>ï¼ˆå˜é‡å¯¹åº”çš„å€¼ï¼‰</li>
</ul>
<h3 data-id="heading-13">ï¼ˆå…­ï¼‰ä»£ç ç»“è®º</h3>
<pre><code class="hljs language-ruby" lang="ruby">&lt;el-form <span class="hljs-symbol">:hide-required-asterisk=<span class="hljs-string">"false"</span>&gt;</span>
</code></pre>
<ul>
<li><code>false</code>Â æ˜¯å›ºå®šå€¼ï¼Œæ­¤è¡¨è¿°æ­£ç¡®</li>
<li>å¿…é¡»ä½¿ç”¨Â <code>:</code>ï¼ŒåŸå› æ˜¯è¦ä¼ é€’å¸ƒå°”ç±»å‹ï¼ˆJavaScript å€¼ï¼‰ï¼Œè€Œéå­—ç¬¦ä¸²</li>
<li>ä½¿ç”¨Â <code>:</code>Â çš„æ ¸å¿ƒä¾æ®æ˜¯å€¼çš„ç±»å‹ï¼Œè€Œé â€œæ˜¯å¦ä¼šå˜åŒ–â€</li>
</ul>
<h3 data-id="heading-14">ï¼ˆä¸ƒï¼‰æ€»ç»“</h3>
<p><code>:</code>Â çš„æ ¸å¿ƒä½œç”¨æ˜¯åŒºåˆ† â€œå­—ç¬¦ä¸²â€ ä¸ â€œJavaScript ä»£ç æ‰§è¡Œç»“æœâ€ï¼Œè€Œé â€œå›ºå®šå€¼ vs å˜é‡â€ã€‚æœ¬è´¨ï¼š<code>:</code>Â è¡¨ç¤º â€œè¿™æ˜¯ JavaScript ä»£ç ï¼Œè¯·æ‰§è¡Œå®ƒâ€ã€‚</p>
<hr/>
<h2 data-id="heading-15">äºŒã€computed/useMemo è§¦å‘å·®å¼‚ï¼ˆVue3/React å“åº”å¼æœ¬è´¨åŒºåˆ«ï¼‰</h2>
<h3 data-id="heading-16">ï¼ˆä¸€ï¼‰æ ¸å¿ƒé—®é¢˜</h3>
<p>Vue3 ä¸­ computed å‡½æ•°æ˜¯å¦ä¼šåœ¨ â€œä¾èµ–æ›´æ–°â€ å’Œ â€œè§†å›¾æ¸²æŸ“â€ æ—¶å¤šæ¬¡è§¦å‘ï¼Ÿä¸ºä½•ä¸ React useMemo è¡Œä¸ºä¸åŒï¼Ÿè¿™ä¸€å·®å¼‚çš„æœ¬è´¨æ˜¯æ¡†æ¶å“åº”å¼è®¾è®¡ç†å¿µçš„åŒºåˆ«å—ï¼Ÿ</p>
<h3 data-id="heading-17">ï¼ˆäºŒï¼‰æ ¸å¿ƒç»“è®º</h3>
<p>Vue3 computed å‡½æ•°ä»…åœ¨<strong>ä¾èµ–æ•°æ®å˜åŒ–æ—¶é‡æ–°æ‰§è¡Œ</strong>ï¼Œè§†å›¾æ¸²æŸ“æ—¶è‹¥ä¾èµ–æœªå˜åˆ™å¤ç”¨ç¼“å­˜ï¼Œä¸ä¼šé¢å¤–è§¦å‘ï¼›å…¶ä¸ React useMemo çš„è¡Œä¸ºå·®å¼‚ï¼Œæ ¸å¿ƒæ˜¯ Vue â€œå“åº”å¼ getter é©±åŠ¨â€ ä¸ React â€œå£°æ˜å¼ä¾èµ–æ•°ç»„é©±åŠ¨â€ çš„è®¾è®¡ç†å¿µä¸åŒï¼Œè€Œé â€œä¸¤æ¬¡è§¦å‘â€ çš„å·®å¼‚ã€‚</p>
<h3 data-id="heading-18">ï¼ˆä¸‰ï¼‰æ¡†æ¶å“åº”å¼æœ¬è´¨å·®å¼‚ï¼ˆVue3 vs Reactï¼‰</h3>
<h4 data-id="heading-19">1. Vue3 Computed å·¥ä½œåŸç†</h4>
<ul>
<li>
<p>æ ¸å¿ƒå®šä½ï¼šcomputed æ˜¯ â€œå“åº”å¼çš„ getterâ€ï¼Œä¸å“åº”å¼æ•°æ®ï¼ˆref/reactiveï¼‰æ·±åº¦ç»‘å®šã€‚</p>
</li>
<li>
<p>è§¦å‘é€»è¾‘ï¼š</p>
<ol>
<li>å½“ä¾èµ–çš„å“åº”å¼æ•°æ®ï¼ˆå¦‚Â <code>snapshotData.value</code>ï¼‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œcomputed å‡½æ•°ä¼šè‡ªåŠ¨é‡æ–°æ‰§è¡Œã€‚</li>
<li>æ¨¡æ¿ä¸­è¯»å–Â <code>{{ formatAmount }}</code>Â æ—¶ï¼Œä»…å½“ä¾èµ–å·²å˜åŒ–ï¼Œæ‰ä¼šè§¦å‘é‡æ–°è®¡ç®—ï¼›ä¾èµ–æœªå˜åˆ™ç›´æ¥å¤ç”¨ç¼“å­˜ç»“æœã€‚</li>
</ol>
</li>
<li>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> formatAmount = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"snapshotData.value"</span>, snapshotData.<span class="hljs-property">value</span>); <span class="hljs-comment">// ä»…ä¾èµ–å˜åŒ–æ—¶æ‰“å°</span>
  <span class="hljs-keyword">return</span> snapshotData.<span class="hljs-property">value</span> ? <span class="hljs-string">`+<span class="hljs-subst">${snapshotData.value.amount}</span>`</span> : <span class="hljs-string">"+0"</span>;
});
</code></pre>
<h4 data-id="heading-20">2. React useMemo å·¥ä½œåŸç†</h4>
<ul>
<li>
<p>æ ¸å¿ƒå®šä½ï¼šuseMemo æ˜¯ â€œå£°æ˜å¼çš„ç¼“å­˜è®¡ç®—å·¥å…·â€ï¼Œä¾èµ–æ˜¾å¼é…ç½®çš„ä¾èµ–æ•°ç»„ã€‚</p>
</li>
<li>
<p>è§¦å‘é€»è¾‘ï¼š</p>
<ol>
<li>ä»…åœ¨ â€œä¾èµ–æ•°ç»„ä¸­çš„å€¼å˜åŒ–â€ æˆ– â€œç»„ä»¶é¦–æ¬¡æ¸²æŸ“â€ æ—¶ï¼Œæ‰§è¡Œè®¡ç®—å‡½æ•°ã€‚</li>
<li>JSX ä¸­ä½¿ç”¨Â <code>{formatAmount}</code>Â ä»…ä¸ºè¯»å–ç¼“å­˜å€¼ï¼Œæ— è®ºè§†å›¾å¦‚ä½•æ¸²æŸ“ï¼Œåªè¦ä¾èµ–æœªå˜ï¼Œéƒ½ä¸ä¼šé‡æ–°æ‰§è¡Œè®¡ç®—å‡½æ•°ã€‚</li>
</ol>
</li>
<li>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> formatAmount = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"snapshotData"</span>, snapshotData); <span class="hljs-comment">// ä»…ä¾èµ–æ•°ç»„å˜åŒ–æ—¶æ‰“å°</span>
  <span class="hljs-keyword">return</span> snapshotData ? <span class="hljs-string">`+<span class="hljs-subst">${snapshotData.amount}</span>`</span> : <span class="hljs-string">"+0"</span>;
}, [snapshotData]); <span class="hljs-comment">// æ˜¾å¼ä¾èµ–æ•°ç»„</span>
</code></pre>
<h3 data-id="heading-21">ï¼ˆå››ï¼‰å…³é”®ç‰¹æ€§å¯¹æ¯”è¡¨</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>Vue3 Computed</th><th>React useMemo</th></tr></thead><tbody><tr><td>æ ¸å¿ƒå®šä½</td><td>å“åº”å¼ getter</td><td>å£°æ˜å¼ç¼“å­˜è®¡ç®—å·¥å…·</td></tr><tr><td>è§¦å‘æ—¶æœº</td><td>ä¾èµ–å“åº”å¼æ•°æ®å˜åŒ–æ—¶</td><td>ä¾èµ–æ•°ç»„å˜åŒ– / ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶</td></tr><tr><td>è§†å›¾ä½¿ç”¨æ—¶</td><td>ä¾èµ–å·²å˜åˆ™é‡æ–°è®¡ç®—ï¼Œå¦åˆ™å¤ç”¨ç¼“å­˜</td><td>ä»…è¯»å–ç¼“å­˜å€¼ï¼Œä¸è§¦å‘é‡æ–°è®¡ç®—</td></tr><tr><td>ä¾èµ–é…ç½®</td><td>è‡ªåŠ¨è¿½è¸ªå“åº”å¼ä¾èµ–ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®</td><td>éœ€æ˜¾å¼å£°æ˜ä¾èµ–æ•°ç»„</td></tr><tr><td>å†…éƒ¨æ‰“å°è¡Œä¸º</td><td>ä¾èµ–å˜åŒ–æ—¶æ‰“å°ï¼ˆä¸è®¡ç®—æ‰§è¡ŒåŒæ­¥ï¼‰</td><td>ä¾èµ–æ•°ç»„å˜åŒ–æ—¶æ‰“å°ï¼ˆä»…æ‰§è¡Œä¸€æ¬¡ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-22">ï¼ˆäº”ï¼‰â€œæ‰“å°å¤šæ¬¡â€ çš„çœŸå®åŸå› </h3>
<p>å¹¶é â€œä¾èµ–æ›´æ–° + è§†å›¾æ¸²æŸ“â€ ä¸¤æ¬¡è§¦å‘ï¼Œè€Œæ˜¯ï¼š</p>
<ol>
<li>åˆå§‹æ¸²æŸ“æ—¶ï¼Œä¾èµ–æ•°æ®ï¼ˆå¦‚Â <code>snapshotData.value</code>ï¼‰ä¸ºåˆå§‹å€¼ï¼ˆå¦‚Â <code>null</code>ï¼‰ï¼Œcomputed æ‰§è¡Œä¸€æ¬¡å¹¶æ‰“å°ã€‚</li>
<li>ä¸šåŠ¡æ“ä½œåï¼ˆå¦‚æäº¤è¡¨å•ï¼‰ï¼Œä¾èµ–æ•°æ®æ›´æ–°ï¼ˆå¦‚å˜ä¸ºÂ <code>{ amount: 100 }</code>ï¼‰ï¼Œcomputed å†æ¬¡æ‰§è¡Œå¹¶æ‰“å°ã€‚</li>
<li>ä¸¤æ¬¡æ‰“å°å‡æ˜¯ â€œä¾èµ–å˜åŒ–â€ å¯¼è‡´çš„è®¡ç®—æ‰§è¡Œï¼Œä¸è§†å›¾æ¸²æŸ“æœ¬èº«æ— ç›´æ¥å…³è”ã€‚</li>
</ol>
<h3 data-id="heading-23">ï¼ˆå…­ï¼‰ä¼˜åŒ–å»ºè®®ï¼ˆé¿å…ä¸å¿…è¦çš„æ‰“å° / è®¡ç®—ï¼‰</h3>
<ol>
<li>è°ƒè¯•åœºæ™¯ï¼šä½¿ç”¨ Vue3 çš„Â <code>watchEffect</code>Â ä¸“é—¨ç›‘å¬æ•°æ®å˜åŒ–ï¼Œæ›¿ä»£ computed å†…æ‰“å°ã€‚</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"snapshotData å˜åŒ–äº†:"</span>, snapshotData.<span class="hljs-property">value</span>); <span class="hljs-comment">// ä»…ç›‘å¬å˜åŒ–æ‰“å°</span>
});
</code></pre>
<ol start="2">
<li>ä¸šåŠ¡åœºæ™¯ï¼šåœ¨æ•°æ®æ›´æ–°çš„æºå¤´ï¼ˆå¦‚æäº¤å‡½æ•°ã€èµ‹å€¼é€»è¾‘ï¼‰æ‰“å°ï¼Œæ˜ç¡®æ•°æ®å˜æ›´æ—¶æœºã€‚</li>
</ol>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">handleSubmit</span> = () =&gt; {
  <span class="hljs-attr">snapshotData.value</span> = { amount: formData.amount }<span class="hljs-comment">;</span>
  console.log("å¿«ç…§æ•°æ®æ›´æ–°:", snapshotData.value)<span class="hljs-comment">; // æºå¤´æ‰“å°æ›´ç²¾å‡†</span>
}<span class="hljs-comment">;</span>
</code></pre>
<ol start="3">
<li>ç”Ÿäº§ç¯å¢ƒï¼šç§»é™¤ computed å†…çš„è°ƒè¯•æ‰“å°ï¼Œé¿å…å†—ä½™æ‰§è¡Œã€‚</li>
</ol>
<h3 data-id="heading-24">ï¼ˆä¸ƒï¼‰æ€»ç»“</h3>
<ul>
<li>å·®å¼‚æœ¬è´¨ï¼šVue3 æ˜¯ â€œå“åº”å¼é©±åŠ¨â€ï¼Œcomputed è‡ªåŠ¨è¿½è¸ªä¾èµ–ã€ä¾èµ–å˜åˆ™è®¡ç®—ï¼›React æ˜¯ â€œå£°æ˜å¼é©±åŠ¨â€ï¼ŒuseMemo ä»…æŒ‰ä¾èµ–æ•°ç»„å˜åŒ–æ‰§è¡Œè®¡ç®—ï¼ŒäºŒè€…æ˜¯æ¡†æ¶è®¾è®¡ç†å¿µçš„å·®å¼‚ï¼Œæ— ä¼˜åŠ£ä¹‹åˆ†ã€‚</li>
<li>å…³é”®è®¤çŸ¥ï¼šVue3 computed ä¸ä¼šå›  â€œå•çº¯è§†å›¾æ¸²æŸ“â€ é¢å¤–è§¦å‘ï¼Œå¤šæ¬¡æ‰§è¡Œå‡æºäºä¾èµ–å˜åŒ–ï¼›è¿™ä¸€ç‰¹æ€§æ˜¯ Vue å“åº”å¼ç³»ç»Ÿçš„ä½“ç°ï¼Œè€Œéè®¾è®¡ç¼ºé™·ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-25">ä¸‰ã€Vue3Â <code>reactive</code>Â </h2>
<h3 data-id="heading-26">ï¼ˆä¸€ï¼‰æ ¸å¿ƒå®šä¹‰</h3>
<p><code>reactive</code>Â æ˜¯ Vue 3 Composition API ä¸­ç”¨æ¥åˆ›å»º<strong>å“åº”å¼å¯¹è±¡</strong>çš„æ ¸å¿ƒå‡½æ•°ï¼Œä½œç”¨æ˜¯è®©æ•°æ®å…·å¤‡ â€œå˜åŒ–è‡ªåŠ¨è§¦å‘è§†å›¾æ›´æ–°â€ çš„ç‰¹æ€§ã€‚</p>
<h3 data-id="heading-27">ï¼ˆäºŒï¼‰åŸºæœ¬æ¦‚å¿µ</h3>
<h4 data-id="heading-28">1. ä»€ä¹ˆæ˜¯å“åº”å¼ï¼Ÿ</h4>
<p>å“åº”å¼æ„å‘³ç€ï¼šå½“æ•°æ®å˜åŒ–æ—¶ï¼Œä½¿ç”¨è¿™äº›æ•°æ®çš„åœ°æ–¹ï¼ˆå¦‚æ¨¡æ¿ã€è®¡ç®—å±æ€§ç­‰ï¼‰ä¼š<strong>è‡ªåŠ¨æ›´æ–°</strong>ã€‚</p>
<pre><code class="hljs language-php" lang="php">import { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;

<span class="hljs-comment">// åˆ›å»ºå“åº”å¼å¯¹è±¡</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">state</span> = <span class="hljs-title function_ invoke__">reactive</span>({
  <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">message</span>: <span class="hljs-string">"Hello"</span>
});

<span class="hljs-comment">// æ•°æ®ä¿®æ”¹åï¼Œä¾èµ–è¯¥æ•°æ®çš„è§†å›¾è‡ªåŠ¨æ›´æ–°</span>
state.count++;
</code></pre>
<h4 data-id="heading-29">2. å®é™…ä»£ç åº”ç”¨ï¼ˆé‡‘é¢è°ƒæ•´ç»„ä»¶ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> formData = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">adjustType</span>: <span class="hljs-number">1</span>,        <span class="hljs-comment">// è°ƒæ•´ç±»å‹ï¼ˆ+/-ï¼‰</span>
  <span class="hljs-attr">amount</span>: <span class="hljs-literal">undefined</span>,    <span class="hljs-comment">// é‡‘é¢</span>
  <span class="hljs-attr">remark</span>: <span class="hljs-string">""</span>           <span class="hljs-comment">// è¯´æ˜</span>
});
</code></pre>
<ul>
<li>è¡¨å•ç»‘å®šÂ <code>v-model="formData.amount"</code>Â æ—¶ï¼Œç”¨æˆ·è¾“å…¥ä¼šè‡ªåŠ¨åŒæ­¥åˆ°Â <code>formData.amount</code>ã€‚</li>
<li>ç¡®è®¤å¼¹çª—ä¸­Â <code>{{ formatAmount }}</code>Â ä¾èµ–Â <code>formData</code>ï¼Œä¼šéšæ•°æ®å˜åŒ–è‡ªåŠ¨æ›´æ–°ã€‚</li>
</ul>
<h3 data-id="heading-30">ï¼ˆä¸‰ï¼‰å“åº”å¼å·¥ä½œåŸç†</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- 1. æ˜¾ç¤ºæ•°æ®ï¼šä¾èµ– formData.amount --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>é‡‘é¢ï¼š{{ formData.amount }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- 2. ä¿®æ”¹æ•°æ®ï¼šv-model ç»‘å®šå“åº”å¼å±æ€§ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData.amount"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;

<span class="hljs-keyword">const</span> formData = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">amount</span>: <span class="hljs-number">0</span>
});

<span class="hljs-comment">// 3. è¾“å…¥æ¡†å€¼æ”¹å˜ â†’ formData.amount è‡ªåŠ¨æ›´æ–° â†’ æ¨¡æ¿æ˜¾ç¤ºåŒæ­¥æ›´æ–°</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-31">ï¼ˆå››ï¼‰<code>reactive</code>Â vs æ™®é€šå¯¹è±¡</h3>




















<table><thead><tr><th>ç±»å‹</th><th>ä»£ç ç¤ºä¾‹</th><th>å“åº”å¼æ•ˆæœ</th></tr></thead><tbody><tr><td>æ™®é€šå¯¹è±¡</td><td><code>const formData = { amount: 0 }; formData.amount = 300;</code></td><td>âŒ æ¨¡æ¿ä¸ä¼šæ›´æ–°</td></tr><tr><td>å“åº”å¼å¯¹è±¡</td><td><code>const formData = reactive({ amount: 0 }); formData.amount = 300;</code></td><td>âœ… æ¨¡æ¿è‡ªåŠ¨æ›´æ–°</td></tr></tbody></table>
<h3 data-id="heading-32">ï¼ˆäº”ï¼‰<code>reactive</code>Â çš„æ ¸å¿ƒç‰¹ç‚¹</h3>
<ol>
<li>
<p><strong>ä»…æ”¯æŒå¯¹è±¡ç±»å‹</strong></p>
<ul>
<li>æ”¯æŒï¼šå¯¹è±¡ã€æ•°ç»„ã€Map ç­‰å¤æ‚ç±»å‹ï¼ˆ<code>reactive({ count: 0 })</code>ã€<code>reactive([1,2,3])</code>ï¼‰ã€‚</li>
<li>ä¸æ”¯æŒï¼šæ•°å­—ã€å­—ç¬¦ä¸²ç­‰åŸºæœ¬ç±»å‹ï¼ˆ<code>reactive(0)</code>Â æ— æ•ˆï¼Œéœ€ç”¨Â <code>ref</code>ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ·±å±‚å“åº”å¼</strong>åµŒå¥—å¯¹è±¡çš„å±æ€§åŒæ ·å…·å¤‡å“åº”å¼ï¼Œä¿®æ”¹ä»»æ„å±‚çº§å±æ€§éƒ½ä¼šè§¦å‘æ›´æ–°ï¼š</p>
</li>
</ol>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">state</span> = <span class="hljs-title function_ invoke__">reactive</span>({
  <span class="hljs-attr">user</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
    <span class="hljs-attr">address</span>: { <span class="hljs-attr">city</span>: <span class="hljs-string">"ä¸Šæµ·"</span> }
  }
});
state.user.address.city = <span class="hljs-string">"åŒ—äº¬"</span>; <span class="hljs-comment">// âœ… è§¦å‘å“åº”å¼æ›´æ–°</span>
</code></pre>
<ol start="3">
<li><strong>ç›´æ¥è®¿é—®å±æ€§</strong>æ— éœ€Â <code>.value</code>ï¼Œç›´æ¥è¯»å†™å±æ€§å³å¯ï¼š</li>
</ol>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">formData</span> = reactive({ amount: <span class="hljs-number">300</span> })<span class="hljs-comment">;</span>
console.log(formData.amount)<span class="hljs-comment">; // 300ï¼ˆç›´æ¥è®¿é—®ï¼‰</span>
<span class="hljs-attr">formData.amount</span> = <span class="hljs-number">500</span><span class="hljs-comment">;        // ç›´æ¥èµ‹å€¼ä¿®æ”¹</span>
</code></pre>
<h3 data-id="heading-33">ï¼ˆå…­ï¼‰<code>reactive</code>Â vsÂ <code>ref</code>Â å¯¹æ¯”</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th><code>reactive</code></th><th><code>ref</code></th></tr></thead><tbody><tr><td>é€‚ç”¨ç±»å‹</td><td>å¯¹è±¡ã€æ•°ç»„ç­‰å¤æ‚ç±»å‹</td><td>ä»»ä½•ç±»å‹ï¼ˆåŸºæœ¬ç±»å‹ã€å¯¹è±¡ï¼‰</td></tr><tr><td>è®¿é—®æ–¹å¼</td><td>ç›´æ¥è®¿é—®ï¼š<code>state.count</code></td><td>è„šæœ¬ä¸­éœ€Â <code>.value</code>ï¼š<code>count.value</code></td></tr><tr><td>æ¨¡æ¿ä¸­ä½¿ç”¨</td><td><code>{{ state.count }}</code></td><td><code>{{ count }}</code>ï¼ˆè‡ªåŠ¨è§£åŒ…ï¼Œæ— éœ€Â <code>.value</code>ï¼‰</td></tr><tr><td>è§£æ„ç‰¹æ€§</td><td>âŒ ç›´æ¥è§£æ„ä¼šå¤±å»å“åº”å¼</td><td>âœ… é…åˆÂ <code>toRefs</code>Â å¯ä¿æŒå“åº”å¼</td></tr></tbody></table>
<h4 data-id="heading-34">ä»£ç ç¤ºä¾‹å¯¹æ¯”</h4>
<pre><code class="hljs language-ini" lang="ini">import { reactive, ref } from "vue"<span class="hljs-comment">;</span>

// reactive ç”¨æ³•ï¼ˆå¯¹è±¡ï¼‰
const <span class="hljs-attr">formData</span> = reactive({ amount: <span class="hljs-number">0</span> })<span class="hljs-comment">;</span>
<span class="hljs-attr">formData.amount</span> = <span class="hljs-number">300</span><span class="hljs-comment">;</span>

// ref ç”¨æ³•ï¼ˆåŸºæœ¬ç±»å‹ï¼‰
const <span class="hljs-attr">count</span> = ref(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
<span class="hljs-attr">count.value</span> = <span class="hljs-number">300</span><span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-35">ï¼ˆä¸ƒï¼‰å®é™…åº”ç”¨åœºæ™¯</h3>
<ol>
<li><strong>è¡¨å•æ•°æ®ç®¡ç†</strong>ï¼ˆå¦‚é‡‘é¢è°ƒæ•´ç»„ä»¶ï¼‰</li>
</ol>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">formData</span> = <span class="hljs-title function_ invoke__">reactive</span>({ <span class="hljs-attr">adjustType</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">amount</span>: undefined, <span class="hljs-attr">remark</span>: <span class="hljs-string">""</span> });
</code></pre>
<ol start="2">
<li><strong>ç»„ä»¶çŠ¶æ€ç®¡ç†</strong></li>
</ol>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">state</span> = <span class="hljs-title function_ invoke__">reactive</span>({ <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> });
state.isLoading = <span class="hljs-literal">true</span>; <span class="hljs-comment">// çŠ¶æ€å˜åŒ–è§¦å‘è§†å›¾æ›´æ–°</span>
</code></pre>
<ol start="3">
<li><strong>åˆ—è¡¨æ•°æ®å¤„ç†</strong></li>
</ol>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">todoList</span> = <span class="hljs-title function_ invoke__">reactive</span>({ <span class="hljs-attr">items</span>: [], <span class="hljs-attr">filter</span>: <span class="hljs-string">"all"</span> });
todoList.items.<span class="hljs-title function_ invoke__">push</span>({ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"å­¦ä¹  Vue 3"</span> }); <span class="hljs-comment">// åˆ—è¡¨æ›´æ–°è‡ªåŠ¨æ¸²æŸ“</span>
</code></pre>
<h3 data-id="heading-36">ï¼ˆå…«ï¼‰æ³¨æ„äº‹é¡¹ï¼ˆé¿å…å¤±å»å“åº”å¼ï¼‰</h3>
<ol>
<li>
<p><strong>ç¦æ­¢ç›´æ¥è§£æ„</strong></p>
<ul>
<li>é”™è¯¯ï¼š<code>const { count } = reactive({ count: 0 }); count++</code>ï¼ˆå¤±å»å“åº”å¼ï¼‰ã€‚</li>
<li>æ­£ç¡®ï¼šä½¿ç”¨Â <code>toRefs</code>Â ä¿æŒå“åº”å¼ï¼š</li>
</ul>
</li>
</ol>
<pre><code class="hljs language-ini" lang="ini">import { toRefs } from "vue"<span class="hljs-comment">;</span>
const <span class="hljs-attr">state</span> = reactive({ count: <span class="hljs-number">0</span> })<span class="hljs-comment">;</span>
const { count } = toRefs(state)<span class="hljs-comment">;</span>
count.value++<span class="hljs-comment">; // âœ… æ­£å¸¸è§¦å‘æ›´æ–°</span>
</code></pre>
<ol start="2">
<li>
<p><strong>ä¸èƒ½æ•´ä½“æ›¿æ¢å¯¹è±¡</strong></p>
<ul>
<li>é”™è¯¯ï¼š<code>let state = reactive({ count: 0 }); state = reactive({ count: 100 })</code>ï¼ˆåŸå“åº”å¼å…³è”å¤±æ•ˆï¼‰ã€‚</li>
<li>æ­£ç¡®ï¼šä¿®æ”¹å±æ€§æˆ–ä½¿ç”¨Â <code>Object.assign</code>ï¼š</li>
</ul>
</li>
</ol>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">state.count</span> = <span class="hljs-number">100</span><span class="hljs-comment">; // ç›´æ¥ä¿®æ”¹å±æ€§</span>
Object.assign(state, { count: 100 })<span class="hljs-comment">; // åˆå¹¶æ›´æ–°</span>
</code></pre>
<h3 data-id="heading-37">ï¼ˆä¹ï¼‰æ€»ç»“</h3>
<p><code>reactive</code>Â çš„æ ¸å¿ƒä»·å€¼æ˜¯ä¸ºå¯¹è±¡ç±»å‹æ•°æ®æ·»åŠ  â€œè‡ªåŠ¨å“åº”å¼â€ èƒ½åŠ›ï¼š</p>
<ol>
<li>âœ… æ•°æ®å˜åŒ– â†’ è§†å›¾è‡ªåŠ¨åŒæ­¥ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ DOMã€‚</li>
<li>âœ… é€‚é…è¡¨å•ã€çŠ¶æ€ã€åˆ—è¡¨ç­‰å¤šç§ä¸šåŠ¡åœºæ™¯ã€‚</li>
<li>âœ… æ·±å±‚å“åº”å¼è®¾è®¡ï¼ŒåµŒå¥—å¯¹è±¡æ— éœ€é¢å¤–å¤„ç†ã€‚</li>
<li>âš ï¸ æ³¨æ„é¿å… â€œè§£æ„â€ å’Œ â€œæ•´ä½“æ›¿æ¢â€ï¼Œé˜²æ­¢å¤±å»å“åº”å¼ã€‚</li>
<li>âš ï¸ åŸºæœ¬ç±»å‹éœ€ç”¨Â <code>ref</code>ï¼Œ<code>reactive</code>Â ä»…é€‚ç”¨äºå¤æ‚å¯¹è±¡ç±»å‹ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Trae Solo å¼€å‘ä½“éªŒï¼šä»é›¶åˆ°å®Œæ•´è€ƒè¯•å¤‡è€ƒå¹³å°çš„å¥‡å¦™ä¹‹æ—…]]></title>    <link>https://juejin.cn/post/7573519273030221870</link>    <guid>https://juejin.cn/post/7573519273030221870</guid>    <pubDate>2025-11-17T13:50:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573519273030221870" data-draft-id="7573525927793246234" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Trae Solo å¼€å‘ä½“éªŒï¼šä»é›¶åˆ°å®Œæ•´è€ƒè¯•å¤‡è€ƒå¹³å°çš„å¥‡å¦™ä¹‹æ—…"/> <meta itemprop="keywords" content="Trae,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-17T13:50:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="yigenhuochai"/> <meta itemprop="url" content="https://juejin.cn/user/3139860942044942"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Trae Solo å¼€å‘ä½“éªŒï¼šä»é›¶åˆ°å®Œæ•´è€ƒè¯•å¤‡è€ƒå¹³å°çš„å¥‡å¦™ä¹‹æ—…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3139860942044942/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    yigenhuochai
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T13:50:33.000Z" title="Mon Nov 17 2025 13:50:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Trae Solo å¼€å‘ä½“éªŒï¼šä»é›¶åˆ°å®Œæ•´è€ƒè¯•å¤‡è€ƒå¹³å°çš„å¥‡å¦™ä¹‹æ—…</h2>
<blockquote>
<p><strong>é¡¹ç›®èƒŒæ™¯</strong>ï¼šä½¿ç”¨ Trae Solo å¼€å‘ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è€ƒè¯•å¤‡è€ƒåº”ç”¨ã€Œè€ƒè¯•å®ã€ï¼Œæ¨¡æ‹ŸçœŸå®è€ƒè¯•è½¯ä»¶çš„åŠŸèƒ½å’Œä½“éªŒã€‚</p>
</blockquote>
<h3 data-id="heading-1">ğŸ¯ é¡¹ç›®èµ·æº</h3>
<p>ä¸€åˆ‡å§‹äºä¸€ä¸ªç®€å•çš„éœ€æ±‚ï¼š"ä»å¤´ç¼–å†™ä¸€ä¸ªå¼€å‘ç±»ä¼¼è€ƒè¯•å®çš„åº”ç”¨ï¼Œä¸éœ€è¦æ”¯ä»˜åŠŸèƒ½ã€‚ç”¨æˆ·åº”è¯¥æœ‰ï¼šé€‰æ‹©é¢˜åº“ã€ç»ƒä¹ ã€èƒŒè¯µã€æ¨¡æ‹Ÿè€ƒè¯•ã€é”™é¢˜ã€æ”¶è—ç­‰åŠŸèƒ½ã€‚"</p>
<p>è¿™ä¸ªéœ€æ±‚çœ‹ä¼¼ç®€å•ï¼Œä½†å½“æˆ‘æ·±å…¥æ€è€ƒåï¼Œæ„è¯†åˆ°è¿™æ˜¯ä¸€ä¸ªç›¸å½“å®Œæ•´çš„åº”ç”¨å¼€å‘æŒ‘æˆ˜ã€‚ä»ç”¨æˆ·ç•Œé¢è®¾è®¡åˆ°æ•°æ®ç®¡ç†ï¼Œä»å­¦ä¹ é€»è¾‘åˆ°ç»Ÿè®¡åˆ†æï¼Œæ¯ä¸€ä¸ªç¯èŠ‚éƒ½éœ€è¦ç²¾å¿ƒè®¾è®¡å’Œå®ç°ã€‚</p>
<h3 data-id="heading-2">ğŸš€ Trae Solo çš„é­”æ³•å¼€å§‹</h3>
<h4 data-id="heading-3">æ™ºèƒ½éœ€æ±‚åˆ†æ</h4>
<p>Trae Solo çš„ç¬¬ä¸€æ­¥è®©æˆ‘å°è±¡æ·±åˆ»ã€‚å®ƒæ²¡æœ‰æ€¥äºå¼€å§‹ç¼–ç ï¼Œè€Œæ˜¯é¦–å…ˆåˆ›å»ºäº†è¯¦ç»†çš„äº§å“éœ€æ±‚æ–‡æ¡£ï¼š</p>
<ul>
<li><strong>æ ¸å¿ƒåŠŸèƒ½æ¨¡å—</strong>ï¼šé¢˜åº“é€‰æ‹©ã€ç»ƒä¹ æ¨¡å¼ã€èƒŒè¯µæ¨¡å¼ã€æ¨¡æ‹Ÿè€ƒè¯•ã€é”™é¢˜ç®¡ç†ã€æ”¶è—åŠŸèƒ½</li>
<li><strong>ç”¨æˆ·ç³»ç»Ÿè®¾è®¡</strong>ï¼šæ³¨å†Œç™»å½•ã€ä¸ªäººä¸­å¿ƒã€å­¦ä¹ ç»Ÿè®¡</li>
<li><strong>æŠ€æœ¯æ¶æ„è§„åˆ’</strong>ï¼šReact + TypeScript + Vite + Tailwind CSS</li>
<li><strong>æ•°æ®æ¨¡å‹è®¾è®¡</strong>ï¼šå®Œæ•´çš„ TypeScript æ¥å£å®šä¹‰</li>
</ul>
<p>è¿™ç§ç³»ç»ŸåŒ–çš„æ€è€ƒæ–¹å¼ï¼Œè®©æ•´ä¸ªå¼€å‘è¿‡ç¨‹æœ‰äº†æ¸…æ™°çš„æ–¹å‘ã€‚</p>
<h4 data-id="heading-4">é¡¹ç›®åˆå§‹åŒ–</h4>
<p>åœ¨æŠ€æœ¯é€‰å‹ä¸Šï¼ŒTrae Solo å±•ç°äº†å…¶ä¸“ä¸šæ€§ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm create vite@latest . --template react-ts
</code></pre>
<p>é€‰æ‹©äº† React + TypeScript çš„ç°ä»£åŒ–æŠ€æœ¯æ ˆï¼Œæ­é… Vite çš„å¿«é€Ÿæ„å»ºèƒ½åŠ›ï¼Œä¸ºåç»­å¼€å‘å¥ å®šäº†åšå®åŸºç¡€ã€‚</p>
<h3 data-id="heading-5">ğŸ¨ å¼€å‘è¿‡ç¨‹çš„ç²¾å½©ç¬é—´</h3>
<h4 data-id="heading-6">1. æ¶æ„è®¾è®¡çš„è‰ºæœ¯</h4>
<p>Trae Solo é‡‡ç”¨äº†æ¨¡å—åŒ–çš„é¡¹ç›®ç»“æ„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">src/
â”œâ”€â”€ components/     <span class="hljs-comment"># å¯å¤ç”¨ç»„ä»¶</span>
â”œâ”€â”€ pages/         <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
â”œâ”€â”€ stores/        <span class="hljs-comment"># çŠ¶æ€ç®¡ç†</span>
â”œâ”€â”€ data/          <span class="hljs-comment"># æ•°æ®å±‚</span>
â”œâ”€â”€ types/         <span class="hljs-comment"># TypeScriptç±»å‹</span>
â””â”€â”€ contexts/      <span class="hljs-comment"># Reactä¸Šä¸‹æ–‡</span>
</code></pre>
<p>è¿™ç§æ¸…æ™°çš„æ¶æ„è®¾è®¡è®©ä»£ç ç»´æŠ¤å˜å¾—å¼‚å¸¸ç®€å•ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰æ˜ç¡®çš„èŒè´£è¾¹ç•Œã€‚</p>
<h4 data-id="heading-7">2. çŠ¶æ€ç®¡ç†çš„ä¼˜é›…å®ç°</h4>
<p>ä½¿ç”¨ Zustand ä½œä¸ºçŠ¶æ€ç®¡ç†å·¥å…·ï¼Œè½»é‡çº§å´åŠŸèƒ½å¼ºå¤§ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">AppState</span> {
  <span class="hljs-attr">currentUser</span>: <span class="hljs-title class_">User</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-attr">selectedBank</span>: <span class="hljs-title class_">QuestionBank</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-attr">currentQuestion</span>: <span class="hljs-title class_">Question</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-comment">// ... å…¶ä»–çŠ¶æ€</span>
}
</code></pre>
<p>ç›¸æ¯” Redux çš„å¤æ‚æ€§ï¼ŒZustand æä¾›äº†æ›´ç®€æ´çš„ APIï¼Œè®©çŠ¶æ€ç®¡ç†å˜å¾—ç›´è§‚æ˜“æ‡‚ã€‚</p>
<h4 data-id="heading-8">3. ç»„ä»¶åŒ–å¼€å‘çš„é­…åŠ›</h4>
<p>æ¯ä¸ªç»„ä»¶éƒ½éµå¾ªå•ä¸€èŒè´£åŸåˆ™ï¼Œä¿æŒä»£ç çš„ç®€æ´æ€§å’Œå¯ç»´æŠ¤æ€§ï¼š</p>
<ul>
<li><strong>FavoriteButton</strong>: åŠ¨ç”»æ”¶è—æŒ‰é’®ï¼Œæ”¯æŒå¤šç§å°ºå¯¸</li>
<li><strong>StudyStatsChart</strong>: å­¦ä¹ ç»Ÿè®¡å›¾è¡¨ï¼Œé›†æˆ Recharts æ•°æ®å¯è§†åŒ–</li>
<li><strong>QuestionFilter</strong>: æ™ºèƒ½é¢˜ç›®ç­›é€‰å™¨ï¼Œæ”¯æŒå¤šç»´åº¦ç­›é€‰</li>
<li><strong>StudyReminder</strong>: å­¦ä¹ æé†’ç³»ç»Ÿï¼Œè‡ªå®šä¹‰æé†’è§„åˆ™</li>
</ul>
<h4 data-id="heading-9">4. æ•°æ®å¯è§†åŒ–çš„éœ‡æ’¼</h4>
<p>é›†æˆ Recharts åº“ï¼Œåˆ›å»ºäº†ä»¤äººå°è±¡æ·±åˆ»çš„æ•°æ®å¯è§†åŒ–ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ­£ç¡®ç‡åˆ†å¸ƒé¥¼å›¾</span>
&lt;<span class="hljs-title class_">PieChart</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Pie</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{accuracyData}</span>&gt;</span>
    {accuracyData.map((entry, index) =&gt; (
      <span class="hljs-tag">&lt;<span class="hljs-name">Cell</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">cell-</span>${<span class="hljs-attr">index</span>}`} <span class="hljs-attr">fill</span>=<span class="hljs-string">{COLORS[index</span> % <span class="hljs-attr">COLORS.length</span>]} /&gt;</span>
    ))}
  <span class="hljs-tag">&lt;/<span class="hljs-name">Pie</span>&gt;</span></span>
&lt;/<span class="hljs-title class_">PieChart</span>&gt;

<span class="hljs-comment">// å­¦ä¹ è¶‹åŠ¿æŠ˜çº¿å›¾</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LineChart</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{weeklyData}</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">XAxis</span> <span class="hljs-attr">dataKey</span>=<span class="hljs-string">"day"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">YAxis</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Line</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"monotone"</span> <span class="hljs-attr">dataKey</span>=<span class="hljs-string">"correct"</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">"#10b981"</span> <span class="hljs-attr">strokeWidth</span>=<span class="hljs-string">{2}</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">LineChart</span>&gt;</span></span>
</code></pre>
<p>è¿™äº›å›¾è¡¨ä¸ä»…ç¾è§‚ï¼Œæ›´é‡è¦çš„æ˜¯æä¾›äº†æœ‰ä»·å€¼çš„å­¦ä¹ æ´å¯Ÿã€‚</p>
<h3 data-id="heading-10">ğŸ› ï¸ æŠ€æœ¯äº®ç‚¹è§£æ</h3>
<h4 data-id="heading-11">1. TypeScript çš„ç±»å‹å®‰å…¨</h4>
<p>å®Œæ•´çš„ç±»å‹å®šä¹‰ç¡®ä¿äº†ä»£ç çš„å¥å£®æ€§ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Question</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">options</span>: <span class="hljs-built_in">string</span>[];
  <span class="hljs-attr">correctAnswer</span>: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">string</span>[];
  explanation?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">difficulty</span>: <span class="hljs-string">'easy'</span> | <span class="hljs-string">'medium'</span> | <span class="hljs-string">'hard'</span>;
  <span class="hljs-attr">knowledgePoints</span>: <span class="hljs-built_in">string</span>[];
}
</code></pre>
<p>ç¼–è¯‘æ—¶çš„ç±»å‹æ£€æŸ¥å¤§å¤§å‡å°‘äº†è¿è¡Œæ—¶é”™è¯¯ã€‚</p>
<h4 data-id="heading-12">2. å“åº”å¼è®¾è®¡çš„å®Œç¾å®ç°</h4>
<p>ä½¿ç”¨ Tailwind CSS å®ç°äº†çœŸæ­£çš„ç§»åŠ¨ç«¯ä¼˜å…ˆè®¾è®¡ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx">&lt;div className=<span class="hljs-string">"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"</span>&gt;
  {<span class="hljs-comment">/* è‡ªé€‚åº”å¸ƒå±€ */</span>}
&lt;/div&gt;
</code></pre>
<p>ä»æ‰‹æœºåˆ°å¹³æ¿å†åˆ°æ¡Œé¢ï¼Œæ¯ä¸ªè®¾å¤‡éƒ½æœ‰æœ€ä½³çš„æ˜¾ç¤ºæ•ˆæœã€‚</p>
<h4 data-id="heading-13">3. æ™ºèƒ½äº¤äº’ä½“éªŒ</h4>
<p>åŠ¨ç”»æ•ˆæœå¢å¼ºäº†ç”¨æˆ·ä½“éªŒï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.transition-all</span> {
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
}

<span class="hljs-selector-class">.hover</span>\:scale-<span class="hljs-number">105</span>:hover {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.05</span>);
}
</code></pre>
<p>æŒ‰é’®æ‚¬åœã€å¡ç‰‡åˆ‡æ¢ã€æ”¶è—åŠ¨ç”»ï¼Œæ¯ä¸ªç»†èŠ‚éƒ½ç»è¿‡ç²¾å¿ƒè®¾è®¡ã€‚</p>
<h3 data-id="heading-14">ğŸª åŠŸèƒ½å±•ç¤º</h3>
<h4 data-id="heading-15">æ ¸å¿ƒå­¦ä¹ æ¨¡å¼</h4>
<ol>
<li><strong>ç»ƒä¹ æ¨¡å¼</strong>ï¼šé¡ºåºç­”é¢˜ï¼Œå³æ—¶åé¦ˆ</li>
<li><strong>èƒŒè¯µæ¨¡å¼</strong>ï¼šéšè—ç­”æ¡ˆï¼Œè‡ªæˆ‘æ£€æµ‹</li>
<li><strong>æ¨¡æ‹Ÿè€ƒè¯•</strong>ï¼šé™æ—¶ç­”é¢˜ï¼ŒçœŸå®æ¨¡æ‹Ÿ</li>
</ol>
<h4 data-id="heading-16">æ™ºèƒ½ç®¡ç†ç³»ç»Ÿ</h4>
<ol>
<li><strong>é”™é¢˜è‡ªåŠ¨æ”¶é›†</strong>ï¼šç­”é”™é¢˜ç›®è‡ªåŠ¨è¿›å…¥é”™é¢˜æœ¬</li>
<li><strong>æ”¶è—åŠŸèƒ½</strong>ï¼šé‡è¦é¢˜ç›®ä¸€é”®æ”¶è—</li>
<li><strong>è¿›åº¦è·Ÿè¸ª</strong>ï¼šå®æ—¶æ˜¾ç¤ºå­¦ä¹ è¿›åº¦å’Œæ­£ç¡®ç‡</li>
</ol>
<h4 data-id="heading-17">æ•°æ®æ´å¯Ÿ</h4>
<ol>
<li><strong>å­¦ä¹ ç»Ÿè®¡</strong>ï¼šæ€»ç­”é¢˜æ•°ã€æ­£ç¡®ç‡ã€å­¦ä¹ å¤©æ•°</li>
<li><strong>å›¾è¡¨åˆ†æ</strong>ï¼šæ­£ç¡®ç‡åˆ†å¸ƒã€å­¦ä¹ è¶‹åŠ¿</li>
<li><strong>è¯¦ç»†æŠ¥å‘Š</strong>ï¼šæŒ‰é¢˜åº“ã€é¢˜å‹ã€éš¾åº¦çš„å¤šç»´åº¦åˆ†æ</li>
</ol>
<h3 data-id="heading-18">ğŸš€ å¼€å‘æ•ˆç‡çš„æå‡</h3>
<h4 data-id="heading-19">1. æ™ºèƒ½ä»£ç ç”Ÿæˆ</h4>
<p>Trae Solo çš„ä»£ç ç”Ÿæˆè´¨é‡ä»¤äººæƒŠè®¶ï¼š</p>
<ul>
<li><strong>é€»è¾‘å®Œæ•´æ€§</strong>ï¼šè€ƒè™‘äº†å„ç§è¾¹ç•Œæƒ…å†µ</li>
<li><strong>æœ€ä½³å®è·µ</strong>ï¼šéµå¾ª React å’Œ TypeScript çš„æœ€ä½³å®è·µ</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“</li>
<li><strong>å¯ç»´æŠ¤æ€§</strong>ï¼šä»£ç ç»“æ„æ¸…æ™°ï¼Œæ³¨é‡Šé€‚å½“</li>
</ul>
<h4 data-id="heading-20">2. å®æ—¶é”™è¯¯ä¿®å¤</h4>
<p>å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é”™è¯¯éƒ½èƒ½å¿«é€Ÿå®šä½å’Œä¿®å¤ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¿®å¤å‰ï¼šæ—¥æœŸæ ¼å¼åŒ–é”™è¯¯</span>
currentUser.<span class="hljs-property">createdAt</span>.<span class="hljs-title function_">toLocaleDateString</span>() <span class="hljs-comment">// âŒ å¯èƒ½æŠ¥é”™</span>

<span class="hljs-comment">// ä¿®å¤åï¼šç±»å‹å®‰å…¨çš„æ—¥æœŸå¤„ç†</span>
currentUser.<span class="hljs-property">createdAt</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span> 
  ? currentUser.<span class="hljs-property">createdAt</span>.<span class="hljs-title function_">toLocaleDateString</span>() 
  : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(currentUser.<span class="hljs-property">createdAt</span>).<span class="hljs-title function_">toLocaleDateString</span>() <span class="hljs-comment">// âœ… å®‰å…¨å¤„ç†</span>
</code></pre>
<h4 data-id="heading-21">3. æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ</h4>
<p>å®Œæ•´çš„æ–‡æ¡£ç”Ÿæˆï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>API æ–‡æ¡£</strong>ï¼šè¯¦ç»†çš„æ¥å£è¯´æ˜</li>
<li><strong>ä½¿ç”¨æŒ‡å—</strong>ï¼šstep-by-step çš„æ“ä½œè¯´æ˜</li>
<li><strong>å¼€å‘æŒ‡å—</strong>ï¼šå¦‚ä½•æ‰©å±•å’Œç»´æŠ¤é¡¹ç›®</li>
</ul>
<h3 data-id="heading-22">ğŸ’¡ å¼€å‘æ„Ÿæ‚Ÿ</h3>
<h4 data-id="heading-23">1. AI è¾…åŠ©å¼€å‘çš„å¨åŠ›</h4>
<p>Trae Solo å±•ç°äº† AI åœ¨è½¯ä»¶å¼€å‘ä¸­çš„å·¨å¤§æ½œåŠ›ï¼š</p>
<ul>
<li><strong>æ•ˆç‡æå‡</strong>ï¼šä¼ ç»Ÿéœ€è¦æ•°å‘¨çš„é¡¹ç›®ï¼Œç°åœ¨å‡ å¤©å°±èƒ½å®Œæˆ</li>
<li><strong>è´¨é‡ä¿è¯</strong>ï¼šè‡ªåŠ¨éµå¾ªæœ€ä½³å®è·µï¼Œå‡å°‘ä½çº§é”™è¯¯</li>
<li><strong>å­¦ä¹ ä»·å€¼</strong>ï¼šç”Ÿæˆçš„ä»£ç æœ¬èº«å°±æ˜¯å¾ˆå¥½çš„å­¦ä¹ ææ–™</li>
</ul>
<h4 data-id="heading-24">2. äººæœºåä½œçš„å®Œç¾å¹³è¡¡</h4>
<p>AI ä¸æ˜¯æ›¿ä»£å¼€å‘è€…ï¼Œè€Œæ˜¯æˆä¸ºå¼ºå¤§çš„åŠ©æ‰‹ï¼š</p>
<ul>
<li><strong>åˆ›æ„å®ç°</strong>ï¼šå°†æŠ½è±¡çš„éœ€æ±‚è½¬åŒ–ä¸ºå…·ä½“çš„å®ç°</li>
<li><strong>æŠ€æœ¯é€‰å‹</strong>ï¼šæ ¹æ®é¡¹ç›®ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ ˆ</li>
<li><strong>æ¶æ„è®¾è®¡</strong>ï¼šæä¾›åˆç†çš„é¡¹ç›®ç»“æ„å’Œæ¨¡å—åˆ’åˆ†</li>
</ul>
<h4 data-id="heading-25">3. æŒç»­è¿­ä»£çš„åŠ›é‡</h4>
<p>é¡¹ç›®çš„æˆåŠŸåœ¨äºæŒç»­çš„æ”¹è¿›å’Œå®Œå–„ï¼š</p>
<ul>
<li><strong>éœ€æ±‚ç†è§£</strong>ï¼šä»åŸºæœ¬åŠŸèƒ½åˆ°å®Œæ•´ä½“éªŒçš„æ¼”è¿›</li>
<li><strong>æŠ€æœ¯ä¼˜åŒ–</strong>ï¼šä»èƒ½ç”¨åˆ°å¥½ç”¨çš„æå‡</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šä»åŠŸèƒ½å®ç°åˆ°ä½“éªŒä¼˜åŒ–çš„å…³æ³¨</li>
</ul>
<h3 data-id="heading-26">ğŸ¨ é¡¹ç›®æˆæœå±•ç¤º</h3>
<h4 data-id="heading-27">æ ¸å¿ƒæ•°æ®</h4>
<ul>
<li><strong>ä»£ç è¡Œæ•°</strong>ï¼šè¶…è¿‡ 3000 è¡Œé«˜è´¨é‡ TypeScript ä»£ç </li>
<li><strong>ç»„ä»¶æ•°é‡</strong>ï¼š20+ ä¸ªç²¾å¿ƒè®¾è®¡çš„ React ç»„ä»¶</li>
<li><strong>åŠŸèƒ½æ¨¡å—</strong>ï¼š10+ ä¸ªå®Œæ•´çš„ä¸šåŠ¡åŠŸèƒ½æ¨¡å—</li>
<li><strong>å¼€å‘æ—¶é—´</strong>ï¼šæ•°å°æ—¶å®Œæˆå®Œæ•´åº”ç”¨å¼€å‘</li>
</ul>
<h4 data-id="heading-28">æŠ€æœ¯äº®ç‚¹</h4>
<ul>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼š100% TypeScript ç±»å‹è¦†ç›–</li>
<li><strong>å“åº”å¼è®¾è®¡</strong>ï¼šå®Œç¾çš„ç§»åŠ¨ç«¯é€‚é…</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç»„ä»¶çº§åˆ«çš„æ€§èƒ½ä¼˜åŒ–</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šæµç•…çš„åŠ¨ç”»å’Œäº¤äº’æ•ˆæœ</li>
</ul>
<h3 data-id="heading-29">ğŸš€ æœªæ¥å±•æœ›</h3>
<p>è¿™ä¸ªé¡¹ç›®çš„æˆåŠŸè®©æˆ‘å¯¹ AI è¾…åŠ©å¼€å‘å……æ»¡ä¿¡å¿ƒï¼š</p>
<h4 data-id="heading-30">çŸ­æœŸç›®æ ‡</h4>
<ul>
<li><strong>åŠŸèƒ½å¢å¼º</strong>ï¼šæ·»åŠ æ›´å¤šå­¦ä¹ æ¨¡å¼å’Œé¢˜åº“ç±»å‹</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šè¿›ä¸€æ­¥ä¼˜åŒ–åŠ è½½é€Ÿåº¦å’Œå“åº”æ€§èƒ½</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šæŒç»­æ”¹è¿›ç•Œé¢è®¾è®¡å’Œäº¤äº’æµç¨‹</li>
</ul>
<h4 data-id="heading-31">é•¿æœŸæ„¿æ™¯</h4>
<ul>
<li><strong>æ™ºèƒ½åŒ–å‡çº§</strong>ï¼šé›†æˆ AI æ¨èç®—æ³•ï¼Œä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„</li>
<li><strong>ç¤¾äº¤åŠŸèƒ½</strong>ï¼šæ·»åŠ å­¦ä¹ ç¤¾åŒºå’Œç«èµ›åŠŸèƒ½</li>
<li><strong>å¤šç«¯åŒæ­¥</strong>ï¼šæ”¯æŒè·¨è®¾å¤‡æ•°æ®åŒæ­¥</li>
</ul>
<h3 data-id="heading-32">ğŸ“ æ€»ç»“</h3>
<p>é€šè¿‡ Trae Solo å¼€å‘ã€Œè€ƒè¯•å®ã€é¡¹ç›®ï¼Œæˆ‘æ·±åˆ»ä½“ä¼šåˆ°äº† AI è¾…åŠ©å¼€å‘çš„å¼ºå¤§å¨åŠ›ï¼š</p>
<ol>
<li><strong>æ•ˆç‡é©å‘½</strong>ï¼šå¼€å‘æ•ˆç‡æå‡ 10 å€ä»¥ä¸Š</li>
<li><strong>è´¨é‡ä¿è¯</strong>ï¼šè‡ªåŠ¨éµå¾ªæœ€ä½³å®è·µï¼Œä»£ç è´¨é‡æœ‰ä¿éšœ</li>
<li><strong>å­¦ä¹ æˆé•¿</strong>ï¼šåœ¨é¡¹ç›®ä¸­å­¦ä¹ åˆ°äº†å¾ˆå¤šæ–°æŠ€æœ¯å’Œè®¾è®¡æ¨¡å¼</li>
<li><strong>åˆ›æ„å®ç°</strong>ï¼šå°†æŠ½è±¡çš„æƒ³æ³•å¿«é€Ÿè½¬åŒ–ä¸ºç°å®</li>
</ol>
<p>Trae Solo ä¸ä»…æ˜¯ä¸€ä¸ªå¼€å‘å·¥å…·ï¼Œæ›´æ˜¯å¼€å‘è€…çš„å¾—åŠ›åŠ©æ‰‹ã€‚å®ƒè®©å¼€å‘å˜å¾—æ›´æœ‰è¶£ï¼Œè®©åˆ›æ„æ›´å®¹æ˜“å®ç°ï¼Œè®©æŠ€æœ¯æ›´æœ‰æ¸©åº¦ã€‚</p>
<blockquote>
<p><strong>é¡¹ç›®ä»£ç åœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FAlexander360%2Ftrae_tiku" target="_blank" title="https://gitee.com/Alexander360/trae_tiku" ref="nofollow noopener noreferrer">gitee.com/Alexander36â€¦</a><br/>
<strong>æŠ€æœ¯æ ˆ</strong>ï¼šReact + TypeScript + Vite + Tailwind CSS + Zustand + Recharts<br/>
<strong>å¼€å‘å·¥å…·</strong>ï¼šTrae Solo AI ç¼–ç¨‹åŠ©æ‰‹</p>
</blockquote>
<p>è¿™æ¬¡å¼€å‘ç»å†è®©æˆ‘ç›¸ä¿¡ï¼ŒAI è¾…åŠ©å¼€å‘ä¸æ˜¯æœªæ¥ï¼Œè€Œæ˜¯ç°åœ¨ã€‚æ‹¥æŠ± AIï¼Œè®©å¼€å‘æ›´é«˜æ•ˆï¼Œè®©åˆ›æ„æ›´è‡ªç”±ï¼</p>
<hr/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24e632891205458c82c63cc8d0faa3f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWlnZW5odW9jaGFp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763992233&amp;x-signature=1DSBLUqa28tDo4No9LHjp5juo6o%3D" alt="1.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b8ba50840db43a0a0734bea715e6459~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWlnZW5odW9jaGFp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763992233&amp;x-signature=ck9R4D2uJ635J8oRcPUMPtIn%2FHk%3D" alt="2.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d57f5bca127d49d094d3466e048bcc53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWlnZW5odW9jaGFp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763992233&amp;x-signature=ucR5o1g3ljM8E7NTEG2EBAw1CvE%3D" alt="3.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/258386c868084909ac1fb91e503b5d38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeWlnZW5odW9jaGFp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763992233&amp;x-signature=s%2FUMdeKEUFAwpkLwteAcWDZj7HA%3D" alt="4.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¼˜åŒ– WebView å›¾ç‰‡é•¿æŒ‰ä½“éªŒï¼šJS Bridge å®ç°åŸç”Ÿä¸ç½‘é¡µç«¯åˆ†å‘æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7573511426867855379</link>    <guid>https://juejin.cn/post/7573511426867855379</guid>    <pubDate>2025-11-17T12:32:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573511426867855379" data-draft-id="7573525634212266027" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¼˜åŒ– WebView å›¾ç‰‡é•¿æŒ‰ä½“éªŒï¼šJS Bridge å®ç°åŸç”Ÿä¸ç½‘é¡µç«¯åˆ†å‘æœºåˆ¶"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-11-17T12:32:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·4165967369355"/> <meta itemprop="url" content="https://juejin.cn/user/1146150492576877"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¼˜åŒ– WebView å›¾ç‰‡é•¿æŒ‰ä½“éªŒï¼šJS Bridge å®ç°åŸç”Ÿä¸ç½‘é¡µç«¯åˆ†å‘æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1146150492576877/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·4165967369355
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-17T12:32:07.000Z" title="Mon Nov 17 2025 12:32:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»52åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://juejin.cn/post/7571378103282237446" target="_blank" title="https://juejin.cn/post/7571378103282237446">ä¹‹å‰çš„æ–‡ç« </a>ä¸­å¤„ç†äº†WebViewä¸­å›¾ç‰‡é•¿æŒ‰ä¿å­˜çš„é€»è¾‘ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬çš„ä¸šåŠ¡ä¸­è¿˜å­˜åœ¨ç€ä¸€äº›JSçš„é•¿æŒ‰äº¤äº’é€»è¾‘ï¼Œè¿™æ—¶<strong>åŸç”Ÿ (Native) ç«¯</strong> å¼¹å‡ºèœå•ï¼ˆå¦‚ä¿å­˜å›¾ç‰‡ã€è¯†åˆ«äºŒç»´ç ï¼‰å’Œ<strong>ç½‘é¡µ (JS) ç«¯</strong> è‡ªè¡Œå¤„ç†å°±å¯èƒ½ä¼šå­˜åœ¨å†²çªã€‚æœ¬æ–‡å°±å°è¯•è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ¯ æ ¸å¿ƒé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-1">é—®é¢˜ï¼š</h3>
<ol>
<li><strong>é•¿æŒ‰äº‹ä»¶åˆ†å‘ï¼š</strong> å¦‚ä½•åœ¨åŸç”Ÿç«¯çš„ <code>onLongPress</code> æˆ–ç±»ä¼¼å›è°ƒä¸­ï¼Œåˆ¤æ–­å½“å‰è¢«é•¿æŒ‰çš„å›¾ç‰‡æ˜¯å¦åº”è¯¥è¢«åŸç”Ÿæ¥ç®¡ï¼Ÿ</li>
<li><strong>Data URI å¤„ç†ï¼š</strong> å¯¹äº <code>data:image/jpeg;base64,...</code> æ ¼å¼çš„å›¾ç‰‡ï¼Œå…¶ URL å­—ç¬¦ä¸²å¾€å¾€éå¸¸é•¿ï¼Œç›´æ¥ä½œä¸º Key ä¼ é€’å’Œå­˜å‚¨æ•ˆç‡æä½ï¼Œä¸”å¯èƒ½è¶…å‡ºæŸäº›ç³»ç»Ÿé™åˆ¶ã€‚</li>
</ol>
<h3 data-id="heading-2">è§£å†³æ–¹æ¡ˆï¼š</h3>
<p>å¼•å…¥ä¸€ä¸ª <strong><code>ImageLpRegistry</code></strong>ï¼ˆé•¿æŒ‰å›¾ç‰‡æ³¨å†Œè¡¨ï¼‰ä½œä¸º Native å’Œ JS ä¹‹é—´çš„æ¡¥æ¢ã€‚</p>
<ul>
<li><strong>JS ä¾§ï¼š</strong> è´Ÿè´£æ”¶é›†éœ€è¦åŸç”Ÿå¤„ç†çš„é•¿æŒ‰å›¾ç‰‡ï¼ˆé€šè¿‡ç‰¹å®šå±æ€§å¦‚ <code>data-lp='native'</code> æ ‡è¯†ï¼‰ï¼Œå¹¶å°†å…¶ <strong>è§„èŒƒåŒ–çš„ Key</strong> é€šè¿‡ JS Bridge æ³¨å†Œåˆ° Native ä¾§ã€‚</li>
<li><strong>Native ä¾§ï¼š</strong> é€šè¿‡ <code>ImageLpRegistry</code> ç»´æŠ¤å·²æ³¨å†Œå›¾ç‰‡çš„ Key é›†åˆï¼Œå¹¶åœ¨æ¥æ”¶åˆ°é•¿æŒ‰äº‹ä»¶æ—¶ï¼Œæ ¹æ® Key å¿«é€Ÿåˆ¤æ–­æ˜¯å¦åº”è¯¥ç”±åŸç”Ÿå¤„ç†ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">ğŸ—ï¸ <code>ImageLpRegistry</code>ï¼šå›¾ç‰‡ Key çš„è§„èŒƒåŒ–ç®¡ç†</h2>
<p>ä¸ºäº†è§£å†³ Data URI çš„å­˜å‚¨å’Œä¼ è¾“é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨ <strong>MD5 æ‘˜è¦</strong> ä½œä¸ºå…¶åœ¨æ³¨å†Œè¡¨ä¸­çš„ Keyã€‚</p>
<h3 data-id="heading-4">1. Key çš„è§„èŒƒåŒ–è§„åˆ™</h3>
<p><code>ImageLpRegistry</code> ç»Ÿä¸€äº†ä¸¤ç§å›¾ç‰‡ Key çš„æ ¼å¼ï¼š</p>




















<table><thead><tr><th><strong>å›¾ç‰‡ç±»å‹</strong></th><th><strong>JS ä¾§ç”Ÿæˆ Key è§„åˆ™</strong></th><th><strong>Native ä¾§å­˜å‚¨ Key ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td><strong>æ™®é€š URL</strong></td><td>åŸå§‹ URL å­—ç¬¦ä¸²</td><td><code>https://example.com/img.jpg</code></td></tr><tr><td><strong>Data URI</strong></td><td><code>md5:</code> + Data URI å†…å®¹çš„ MD5 æ‘˜è¦</td><td><code>md5:e10adc3949ba59abbe56e057f20f883e</code></td></tr></tbody></table>
<blockquote>
<p>ğŸ”‘ <strong>å…³é”®ä¼˜åŠ¿ï¼š</strong> MD5 æ‘˜è¦æ˜¾è‘—ç¼©çŸ­äº† Key çš„é•¿åº¦ï¼Œä¸” JS/Native <strong>åªéœ€è¦ä¿è¯ MD5 ç®—æ³•ä¸€è‡´</strong> å³å¯å®ç°å‡†ç¡®åŒ¹é…ã€‚åŒæ—¶ï¼ŒNative ä¾§ä¸å†é‡å¤è®¡ç®— MD5ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ JS ä¼ å…¥çš„ Keyï¼Œé¿å…é‡å¤è®¡ç®—å’Œæ½œåœ¨çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p>
</blockquote>
<h3 data-id="heading-5">2. ä»£ç å®ç°ç»†èŠ‚ (<code>ImageLpRegistry</code>)</h3>
<p>Kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageLpRegistry</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> <span class="hljs-keyword">set</span> = ConcurrentHashMap.newKeySet&lt;String&gt;()

  <span class="hljs-meta">@JavascriptInterface</span>
  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">put</span><span class="hljs-params">(key: <span class="hljs-type">String</span>)</span></span> {
    <span class="hljs-keyword">if</span> (key.isEmpty()) <span class="hljs-keyword">return</span>
    <span class="hljs-keyword">set</span>.add(key)
  }

  <span class="hljs-meta">@JavascriptInterface</span>
  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">remove</span><span class="hljs-params">(key: <span class="hljs-type">String</span>)</span></span> {
    <span class="hljs-keyword">if</span> (key.isEmpty()) <span class="hljs-keyword">return</span>
    <span class="hljs-keyword">set</span>.remove(key)
  }

  <span class="hljs-meta">@JavascriptInterface</span>
  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">update</span><span class="hljs-params">(oldKey: <span class="hljs-type">String</span>, newKey: <span class="hljs-type">String</span>)</span></span> {
    <span class="hljs-keyword">if</span> (oldKey.isNotEmpty()) <span class="hljs-keyword">set</span>.remove(oldKey)
    <span class="hljs-keyword">if</span> (newKey.isNotEmpty()) <span class="hljs-keyword">set</span>.add(newKey)
  }

  <span class="hljs-comment">// ---- Native è¾…åŠ©ï¼šæ ¹æ® raw src æˆ–å·²ä¼ å…¥çš„ key è§„èŒƒåŒ– ----</span>
  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">md5</span><span class="hljs-params">(raw: <span class="hljs-type">String</span>)</span></span>: String {
    <span class="hljs-keyword">val</span> md = MessageDigest.getInstance(<span class="hljs-string">"MD5"</span>)
    <span class="hljs-keyword">val</span> digest = md.digest(raw.toByteArray(Charsets.UTF_8))
    <span class="hljs-keyword">val</span> joinToString = digest.joinToString(<span class="hljs-string">""</span>) {b -&gt; <span class="hljs-string">"%02x"</span>.format(b)}
    <span class="hljs-keyword">return</span> joinToString
  }

  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">normalizeKey</span><span class="hljs-params">(input: <span class="hljs-type">String</span>)</span></span>: String {
    <span class="hljs-keyword">if</span> (input.startsWith(<span class="hljs-string">"md5:"</span>)) <span class="hljs-keyword">return</span> input <span class="hljs-comment">// å·²ç»æ˜¯ key</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (input.startsWith(<span class="hljs-string">"data:"</span>)) <span class="hljs-string">"md5:<span class="hljs-subst">${md5(input)}</span>"</span> <span class="hljs-keyword">else</span> input
  }

  <span class="hljs-comment">/**
   * æ˜¯å¦ä¸ºå·²æ³¨å†Œå›¾ç‰‡ï¼ˆä¼ å…¥åŸå§‹ src æˆ– key å‡å¯ï¼‰
   */</span>
  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isNative</span><span class="hljs-params">(rawOrKey: <span class="hljs-type">String</span>?)</span></span>: <span class="hljs-built_in">Boolean</span> {
    <span class="hljs-keyword">if</span> (rawOrKey.isNullOrEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> <span class="hljs-comment">// å…ˆç›´æ¥æŸ¥åŸå€¼ï¼Œå†å“ˆå¸Œè§„èŒƒåŒ–ï¼ˆé¿å…é‡å¤ md5ï¼‰</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">set</span>.contains(rawOrKey)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    <span class="hljs-keyword">val</span> key = normalizeKey(rawOrKey)
    <span class="hljs-keyword">val</span> exists = <span class="hljs-keyword">set</span>.contains(key)
    <span class="hljs-keyword">return</span> exists
  }

  <span class="hljs-comment">/**
   * è·å–æ³¨å†Œæ—¶çš„ keyï¼ˆmd5:xxxx æˆ–åŸå§‹ URLï¼‰ï¼Œä¸å­˜åœ¨è¿”å› null
   */</span>
  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">keyFor</span><span class="hljs-params">(rawOrKey: <span class="hljs-type">String</span>?)</span></span>: String? {
    <span class="hljs-keyword">if</span> (rawOrKey.isNullOrEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">set</span>.contains(rawOrKey)) <span class="hljs-keyword">return</span> rawOrKey
    <span class="hljs-keyword">val</span> key = normalizeKey(rawOrKey)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">set</span>.contains(key)) key <span class="hljs-keyword">else</span> <span class="hljs-literal">null</span>
  }

  <span class="hljs-comment">/** JS å¯é€‰ç›´æ¥æŸ¥è¯¢ï¼ˆä¼ å…¥ raw æˆ– keyï¼‰ */</span>
  <span class="hljs-meta">@JavascriptInterface</span>
  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">query</span><span class="hljs-params">(rawOrKey: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span> = isNative(rawOrKey)

  <span class="hljs-comment">/** å…¼å®¹æ—§æ¥å£ï¼šå­˜åœ¨åˆ™è¿”å› "native" */</span>
  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">String</span>?)</span></span>: String? = <span class="hljs-keyword">if</span> (isNative(key)) <span class="hljs-string">"native"</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">null</span>

  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">set</span>.clear()
  }
}
</code></pre>
<ul>
<li><strong>çº¿ç¨‹å®‰å…¨ï¼š</strong> ä½¿ç”¨ <code>ConcurrentHashMap.newKeySet()</code> ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œå› ä¸º <code>@JavascriptInterface</code> æ–¹æ³•åœ¨ JS Bridge çº¿ç¨‹æ‰§è¡Œï¼Œè€Œ Native æŸ¥è¯¢å¯èƒ½åœ¨ä¸»çº¿ç¨‹æˆ–å…¶ä»–çº¿ç¨‹æ‰§è¡Œã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-6">ğŸ’» æ³¨å…¥ä¸ååŒï¼šJS/Native åä½œæµç¨‹</h2>
<p>ä¸ºäº†è®©è¿™å¥—æœºåˆ¶å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦åœ¨ WebView åŠ è½½å®Œæˆåæ³¨å…¥ JS è„šæœ¬ï¼Œå®ç°å›¾ç‰‡çš„è§‚å¯Ÿå’Œæ³¨å†Œã€‚</p>
<h3 data-id="heading-7">1. Native ä¾§æ³¨å…¥ (<code>IWebviewImageLpHandler</code>)</h3>
<p>Kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IWebviewImageLpHandler</span> {
  <span class="hljs-keyword">var</span> imageLpRegistry: ImageLpRegistry?

  <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">registerImageLp</span><span class="hljs-params">(view: <span class="hljs-type">WebView</span>)</span></span> {
    <span class="hljs-comment">// åˆå§‹åŒ–æ³¨å†Œè¡¨å¹¶æ³¨å…¥ JS Bridge å¯¹è±¡</span>
    <span class="hljs-keyword">val</span> registry = imageLpRegistry ?: ImageLpRegistry().also { imageLpRegistry = it }
    view.addJavascriptInterface(registry, <span class="hljs-string">"AndroidLp"</span>)
  }


    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">injectCollector</span><span class="hljs-params">(view: <span class="hljs-type">WebView</span>?)</span></span> {
      view ?: <span class="hljs-keyword">return</span>
      <span class="hljs-keyword">val</span> cryptoJsScript = withContext(Dispatchers.IO) {
        view.context?.readJsFromAssets(<span class="hljs-string">"crypto-js.min.js"</span>)
      }
      <span class="hljs-keyword">if</span> (cryptoJsScript.isNullOrEmpty()) { 
        <span class="hljs-keyword">return</span>
      }

      <span class="hljs-keyword">val</span> logicScript = withContext(Dispatchers.IO) {view.context?.readJsFromAssets(<span class="hljs-string">"image_lp_logic.js"</span>)}
      <span class="hljs-keyword">if</span> (logicScript.isNullOrEmpty()) { <span class="hljs-comment">// Consider logging this failure.</span>
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-keyword">val</span> fullScript = <span class="hljs-string">"<span class="hljs-variable">$cryptoJsScript</span>\n<span class="hljs-variable">$logicScript</span>"</span>
      view.evaluateJavascript(fullScript, <span class="hljs-literal">null</span>)
    }
}
</code></pre>
<p>JavaScript</p>
<pre><code class="hljs language-css" lang="css">//jsä¸­ä¸åŒçš„md5æ–¹æ³•è®¡ç®—å‡ºæ¥çš„å€¼å¯èƒ½å’Œå®‰å“å¹³å°è®¡ç®—çš„å€¼ä¸ä¸€æ ·ï¼Œç»æµ‹è¯•ï¼Œä»¥ä¸‹jsä¸­çš„è®¡ç®—ç»“æœä¸å®‰å“å¹³å°ç»“æœä¸€è‡´
//crypto-js<span class="hljs-selector-class">.min</span><span class="hljs-selector-class">.js</span> 
!function(t,e){"<span class="hljs-selector-tag">object</span>"==typeof exports?module<span class="hljs-selector-class">.exports</span>=exports=e():<span class="hljs-string">"function"</span>==typeof define&amp;&amp;define.amd?<span class="hljs-built_in">define</span>([],e):t.AndroidCryptoJS=<span class="hljs-built_in">e</span>()}(this,function(){<span class="hljs-selector-tag">var</span> W,O,<span class="hljs-selector-tag">I</span>,U,K,X,L,l,j,T,t,N,<span class="hljs-selector-tag">q</span>,e,Z,V,G,J,<span class="hljs-selector-tag">Q</span>,Y,$,t1,e1,r1,i1,o1,n1,s,s1,c1,a1,<span class="hljs-selector-tag">h1</span>,l1,o,f1,r,d1,u1,n,c,<span class="hljs-selector-tag">a</span>,h,f,d,<span class="hljs-selector-tag">i</span>=function(h){<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>;if("undefined"!=typeof window&amp;&amp;window<span class="hljs-selector-class">.crypto</span>&amp;&amp;(<span class="hljs-selector-tag">i</span>=window<span class="hljs-selector-class">.crypto</span>),"undefined"!=typeof self&amp;&amp;self<span class="hljs-selector-class">.crypto</span>&amp;&amp;(<span class="hljs-selector-tag">i</span>=self<span class="hljs-selector-class">.crypto</span>),!(<span class="hljs-selector-tag">i</span>=!(<span class="hljs-selector-tag">i</span>=!(<span class="hljs-selector-tag">i</span>="undefined"!=typeof globalThis&amp;&amp;globalThis<span class="hljs-selector-class">.crypto</span>?globalThis<span class="hljs-selector-class">.crypto</span>:i)&amp;&amp;<span class="hljs-string">"undefined"</span>!=typeof window&amp;&amp;window.msCrypto?window.msCrypto:i)&amp;&amp;<span class="hljs-string">"undefined"</span>!=typeof global&amp;&amp;global.crypto?global.crypto:i)&amp;&amp;<span class="hljs-string">"function"</span>==typeof require)try{<span class="hljs-selector-tag">i</span>=require("crypto")}catch(t){}<span class="hljs-selector-tag">var</span> r=<span class="hljs-selector-tag">Object</span><span class="hljs-selector-class">.create</span>||function(t){return e<span class="hljs-selector-class">.prototype</span>=t,t=new e,e<span class="hljs-selector-class">.prototype</span>=null,t};function e(){}<span class="hljs-selector-tag">var</span> t={},o=t<span class="hljs-selector-class">.lib</span>={},n=o<span class="hljs-selector-class">.Base</span>={extend:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e=r(this);return t&amp;&amp;e<span class="hljs-selector-class">.mixIn</span>(t),e<span class="hljs-selector-class">.hasOwnProperty</span>("init")&amp;&amp;this<span class="hljs-selector-class">.init</span>!==e<span class="hljs-selector-class">.init</span>||(e<span class="hljs-selector-class">.init</span>=function(){e.$super<span class="hljs-selector-class">.init</span><span class="hljs-selector-class">.apply</span>(this,arguments)}),(e<span class="hljs-selector-class">.init</span><span class="hljs-selector-class">.prototype</span>=e).$super=this,e},create:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=this<span class="hljs-selector-class">.extend</span>();return t<span class="hljs-selector-class">.init</span><span class="hljs-selector-class">.apply</span>(t,arguments),t},init:<span class="hljs-built_in">function</span>(){},mixIn:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e in t)t<span class="hljs-selector-class">.hasOwnProperty</span>(e)&amp;&amp;(this<span class="hljs-selector-attr">[e]</span>=t<span class="hljs-selector-attr">[e]</span>);t<span class="hljs-selector-class">.hasOwnProperty</span>("toString")&amp;&amp;(this<span class="hljs-selector-class">.toString</span>=t<span class="hljs-selector-class">.toString</span>)},clone:<span class="hljs-built_in">function</span>(){return this<span class="hljs-selector-class">.init</span><span class="hljs-selector-class">.prototype</span><span class="hljs-selector-class">.extend</span>(this)}},l=o<span class="hljs-selector-class">.WordArray</span>=n<span class="hljs-selector-class">.extend</span>({init:<span class="hljs-built_in">function</span>(t,e){t=this<span class="hljs-selector-class">.words</span>=t||<span class="hljs-selector-attr">[]</span>,this<span class="hljs-selector-class">.sigBytes</span>=null!=e?e:<span class="hljs-number">4</span>*t.length},toString:<span class="hljs-built_in">function</span>(t){return(t||c)<span class="hljs-selector-class">.stringify</span>(this)},concat:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e=this<span class="hljs-selector-class">.words</span>,r=t<span class="hljs-selector-class">.words</span>,<span class="hljs-selector-tag">i</span>=this<span class="hljs-selector-class">.sigBytes</span>,o=t<span class="hljs-selector-class">.sigBytes</span>;if(this<span class="hljs-selector-class">.clamp</span>(),<span class="hljs-selector-tag">i</span>%<span class="hljs-number">4</span>)for(<span class="hljs-selector-tag">var</span> n=<span class="hljs-number">0</span>;n&lt;o;n++){<span class="hljs-selector-tag">var</span> s=r<span class="hljs-selector-attr">[n&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-n%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>;e<span class="hljs-selector-attr">[i+n&gt;&gt;&gt;2]</span>|=s&lt;&lt;<span class="hljs-number">24</span>-(<span class="hljs-selector-tag">i</span>+n)%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>}else for(<span class="hljs-selector-tag">var</span> c=<span class="hljs-number">0</span>;c&lt;o;c+=<span class="hljs-number">4</span>)e<span class="hljs-selector-attr">[i+c&gt;&gt;&gt;2]</span>=r<span class="hljs-selector-attr">[c&gt;&gt;&gt;2]</span>;return this<span class="hljs-selector-class">.sigBytes</span>+=o,this},clamp:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=this<span class="hljs-selector-class">.words</span>,e=this<span class="hljs-selector-class">.sigBytes</span>;t<span class="hljs-selector-attr">[e&gt;&gt;&gt;2]</span>&amp;=<span class="hljs-number">4294967295</span>&lt;&lt;<span class="hljs-number">32</span>-e%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>,t<span class="hljs-selector-class">.length</span>=h<span class="hljs-selector-class">.ceil</span>(e/<span class="hljs-number">4</span>)},clone:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=n<span class="hljs-selector-class">.clone</span><span class="hljs-selector-class">.call</span>(this);return t<span class="hljs-selector-class">.words</span>=this<span class="hljs-selector-class">.words</span><span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>),t},random:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=<span class="hljs-selector-attr">[]</span>,r=<span class="hljs-number">0</span>;r&lt;t;r+=<span class="hljs-number">4</span>)e<span class="hljs-selector-class">.push</span>(function(){if(<span class="hljs-selector-tag">i</span>){if("function"==typeof <span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.getRandomValues</span>)try{return <span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.getRandomValues</span>(new Uint32Array(<span class="hljs-number">1</span>))<span class="hljs-selector-attr">[0]</span>}catch(t){}if("function"==typeof <span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.randomBytes</span>)try{return <span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.randomBytes</span>(<span class="hljs-number">4</span>)<span class="hljs-selector-class">.readInt32LE</span>()}catch(t){}}throw new Error("Native crypto module could not be used <span class="hljs-selector-tag">to</span> get secure random number.")}());return new l<span class="hljs-selector-class">.init</span>(e,t)}}),s=t<span class="hljs-selector-class">.enc</span>={},c=s<span class="hljs-selector-class">.Hex</span>={stringify:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.words</span>,r=t<span class="hljs-selector-class">.sigBytes</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-selector-attr">[]</span>,o=<span class="hljs-number">0</span>;o&lt;r;o++){<span class="hljs-selector-tag">var</span> n=e<span class="hljs-selector-attr">[o&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-o%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>;<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.push</span>((n&gt;&gt;&gt;<span class="hljs-number">4</span>)<span class="hljs-selector-class">.toString</span>(<span class="hljs-number">16</span>)),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.push</span>((<span class="hljs-number">15</span>&amp;n)<span class="hljs-selector-class">.toString</span>(<span class="hljs-number">16</span>))}return <span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.join</span>("")},parse:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.length</span>,r=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;e;<span class="hljs-selector-tag">i</span>+=<span class="hljs-number">2</span>)r<span class="hljs-selector-attr">[i&gt;&gt;&gt;3]</span>|=parseInt(t<span class="hljs-selector-class">.substr</span>(<span class="hljs-selector-tag">i</span>,<span class="hljs-number">2</span>),<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">24</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">8</span>*<span class="hljs-number">4</span>;return new l<span class="hljs-selector-class">.init</span>(r,e/<span class="hljs-number">2</span>)}},<span class="hljs-selector-tag">a</span>=s<span class="hljs-selector-class">.Latin1</span>={stringify:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.words</span>,r=t<span class="hljs-selector-class">.sigBytes</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-selector-attr">[]</span>,o=<span class="hljs-number">0</span>;o&lt;r;o++){<span class="hljs-selector-tag">var</span> n=e<span class="hljs-selector-attr">[o&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-o%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>;<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.push</span>(String<span class="hljs-selector-class">.fromCharCode</span>(n))}return <span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.join</span>("")},parse:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.length</span>,r=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;e;<span class="hljs-selector-tag">i</span>++)r<span class="hljs-selector-attr">[i&gt;&gt;&gt;2]</span>|=(<span class="hljs-number">255</span>&amp;t<span class="hljs-selector-class">.charCodeAt</span>(<span class="hljs-selector-tag">i</span>))&lt;&lt;<span class="hljs-number">24</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>;return new l<span class="hljs-selector-class">.init</span>(r,e)}},f=s<span class="hljs-selector-class">.Utf8</span>={stringify:<span class="hljs-built_in">function</span>(t){try{return decodeURIComponent(escape(<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.stringify</span>(t)))}catch(t){throw new Error("Malformed UTF-<span class="hljs-number">8</span> data")}},parse:<span class="hljs-built_in">function</span>(t){return <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.parse</span>(unescape(encodeURIComponent(t)))}},d=o<span class="hljs-selector-class">.BufferedBlockAlgorithm</span>=n<span class="hljs-selector-class">.extend</span>({reset:<span class="hljs-built_in">function</span>(){this._data=new l<span class="hljs-selector-class">.init</span>,this._nDataBytes=<span class="hljs-number">0</span>},_append:<span class="hljs-built_in">function</span>(t){"string"==typeof t&amp;&amp;(t=f<span class="hljs-selector-class">.parse</span>(t)),this._data<span class="hljs-selector-class">.concat</span>(t),this._nDataBytes+=t<span class="hljs-selector-class">.sigBytes</span>},_process:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e,r=this._data,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-class">.words</span>,o=r<span class="hljs-selector-class">.sigBytes</span>,n=this<span class="hljs-selector-class">.blockSize</span>,s=o/(<span class="hljs-number">4</span>*n),c=(s=t?h<span class="hljs-selector-class">.ceil</span>(s):h.<span class="hljs-built_in">max</span>((<span class="hljs-number">0</span>|s)-this._minBufferSize,<span class="hljs-number">0</span>))*n,t=h.<span class="hljs-built_in">min</span>(<span class="hljs-number">4</span>*c,o);if(c){for(<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">a</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">a</span>&lt;c;<span class="hljs-selector-tag">a</span>+=n)this._doProcessBlock(<span class="hljs-selector-tag">i</span>,<span class="hljs-selector-tag">a</span>);e=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.splice</span>(<span class="hljs-number">0</span>,c),r<span class="hljs-selector-class">.sigBytes-</span>=t}return new l<span class="hljs-selector-class">.init</span>(e,t)},clone:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=n<span class="hljs-selector-class">.clone</span><span class="hljs-selector-class">.call</span>(this);return t._data=this._data<span class="hljs-selector-class">.clone</span>(),t},_minBufferSize:<span class="hljs-number">0</span>}),u=(o<span class="hljs-selector-class">.Hasher</span>=d<span class="hljs-selector-class">.extend</span>({cfg:n.<span class="hljs-built_in">extend</span>(),init:<span class="hljs-built_in">function</span>(t){this<span class="hljs-selector-class">.cfg</span>=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.extend</span>(t),this<span class="hljs-selector-class">.reset</span>()},reset:<span class="hljs-built_in">function</span>(){d<span class="hljs-selector-class">.reset</span><span class="hljs-selector-class">.call</span>(this),this._doReset()},update:<span class="hljs-built_in">function</span>(t){return this._append(t),this._process(),this},finalize:<span class="hljs-built_in">function</span>(t){return t&amp;&amp;this._append(t),this._doFinalize()},blockSize:<span class="hljs-number">16</span>,_createHelper:<span class="hljs-built_in">function</span>(r){return function(t,e){return new r<span class="hljs-selector-class">.init</span>(e)<span class="hljs-selector-class">.finalize</span>(t)}},_createHmacHelper:<span class="hljs-built_in">function</span>(r){return function(t,e){return new u<span class="hljs-selector-class">.HMAC</span><span class="hljs-selector-class">.init</span>(r,e)<span class="hljs-selector-class">.finalize</span>(t)}}}),t<span class="hljs-selector-class">.algo</span>={});return t}(Math),u=(u=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span>,W=u<span class="hljs-selector-class">.Base</span>,O=u<span class="hljs-selector-class">.WordArray</span>,(u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.x64</span>={})<span class="hljs-selector-class">.Word</span>=W<span class="hljs-selector-class">.extend</span>({init:<span class="hljs-built_in">function</span>(t,e){this<span class="hljs-selector-class">.high</span>=t,this<span class="hljs-selector-class">.low</span>=e}}),u<span class="hljs-selector-class">.WordArray</span>=W<span class="hljs-selector-class">.extend</span>({init:<span class="hljs-built_in">function</span>(t,e){t=this<span class="hljs-selector-class">.words</span>=t||<span class="hljs-selector-attr">[]</span>,this<span class="hljs-selector-class">.sigBytes</span>=null!=e?e:<span class="hljs-number">8</span>*t.length},toX32:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=this<span class="hljs-selector-class">.words</span>,e=t<span class="hljs-selector-class">.length</span>,r=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;e;<span class="hljs-selector-tag">i</span>++){<span class="hljs-selector-tag">var</span> o=t<span class="hljs-selector-attr">[i]</span>;r<span class="hljs-selector-class">.push</span>(o<span class="hljs-selector-class">.high</span>),r<span class="hljs-selector-class">.push</span>(o<span class="hljs-selector-class">.low</span>)}return O<span class="hljs-selector-class">.create</span>(r,this<span class="hljs-selector-class">.sigBytes</span>)},clone:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=W<span class="hljs-selector-class">.clone</span><span class="hljs-selector-class">.call</span>(this),e=t<span class="hljs-selector-class">.words</span>=this<span class="hljs-selector-class">.words</span><span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>),r=e<span class="hljs-selector-class">.length</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;r;<span class="hljs-selector-tag">i</span>++)e<span class="hljs-selector-attr">[i]</span>=e<span class="hljs-selector-attr">[i]</span><span class="hljs-selector-class">.clone</span>();return t}}),"function"==typeof ArrayBuffer&amp;&amp;(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.WordArray</span>,<span class="hljs-selector-tag">I</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.init</span>,(<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.init</span>=function(t){if((t=(t=t instanceof ArrayBuffer?new Uint8Array(t):t)instanceof Int8Array||<span class="hljs-string">"undefined"</span>!=typeof Uint8ClampedArray&amp;&amp;t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array?new <span class="hljs-built_in">Uint8Array</span>(t.buffer,t.byteOffset,t.byteLength):t)instanceof Uint8Array){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.byteLength</span>,r=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;e;<span class="hljs-selector-tag">i</span>++)r<span class="hljs-selector-attr">[i&gt;&gt;&gt;2]</span>|=t<span class="hljs-selector-attr">[i]</span>&lt;&lt;<span class="hljs-number">24</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>;<span class="hljs-selector-tag">I</span><span class="hljs-selector-class">.call</span>(this,r,e)}else <span class="hljs-selector-tag">I</span><span class="hljs-selector-class">.apply</span>(this,arguments)})<span class="hljs-selector-class">.prototype</span>=<span class="hljs-selector-tag">p</span>),<span class="hljs-selector-tag">i</span>),p1=u<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.WordArray</span>;function _1(t){return t&lt;&lt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">4278255360</span>|t&gt;&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">16711935</span>}(u=u<span class="hljs-selector-class">.enc</span>)<span class="hljs-selector-class">.Utf16</span>=u<span class="hljs-selector-class">.Utf16BE</span>={stringify:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.words</span>,r=t<span class="hljs-selector-class">.sigBytes</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-selector-attr">[]</span>,o=<span class="hljs-number">0</span>;o&lt;r;o+=<span class="hljs-number">2</span>){<span class="hljs-selector-tag">var</span> n=e<span class="hljs-selector-attr">[o&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>-o%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">65535</span>;<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.push</span>(String<span class="hljs-selector-class">.fromCharCode</span>(n))}return <span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.join</span>("")},parse:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.length</span>,r=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;e;<span class="hljs-selector-tag">i</span>++)r<span class="hljs-selector-attr">[i&gt;&gt;&gt;1]</span>|=t<span class="hljs-selector-class">.charCodeAt</span>(<span class="hljs-selector-tag">i</span>)&lt;&lt;<span class="hljs-number">16</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">2</span>*<span class="hljs-number">16</span>;return p1<span class="hljs-selector-class">.create</span>(r,<span class="hljs-number">2</span>*e)}},u<span class="hljs-selector-class">.Utf16LE</span>={stringify:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.words</span>,r=t<span class="hljs-selector-class">.sigBytes</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-selector-attr">[]</span>,o=<span class="hljs-number">0</span>;o&lt;r;o+=<span class="hljs-number">2</span>){<span class="hljs-selector-tag">var</span> n=_1(e<span class="hljs-selector-attr">[o&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>-o%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">65535</span>);<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.push</span>(String<span class="hljs-selector-class">.fromCharCode</span>(n))}return <span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.join</span>("")},parse:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.length</span>,r=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;e;<span class="hljs-selector-tag">i</span>++)r<span class="hljs-selector-attr">[i&gt;&gt;&gt;1]</span>|=_1(t<span class="hljs-selector-class">.charCodeAt</span>(<span class="hljs-selector-tag">i</span>)&lt;&lt;<span class="hljs-number">16</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">2</span>*<span class="hljs-number">16</span>);return p1<span class="hljs-selector-class">.create</span>(r,<span class="hljs-number">2</span>*e)}},U=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.WordArray</span>,<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.enc</span><span class="hljs-selector-class">.Base64</span>={stringify:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.words</span>,r=t<span class="hljs-selector-class">.sigBytes</span>,<span class="hljs-selector-tag">i</span>=this._map,o=(t<span class="hljs-selector-class">.clamp</span>(),<span class="hljs-selector-attr">[]</span>),n=<span class="hljs-number">0</span>;n&lt;r;n+=<span class="hljs-number">3</span>)for(<span class="hljs-selector-tag">var</span> s=(e<span class="hljs-selector-attr">[n&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-n%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>)&lt;&lt;<span class="hljs-number">16</span>|(e<span class="hljs-selector-attr">[n+1&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-(n+<span class="hljs-number">1</span>)%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>)&lt;&lt;<span class="hljs-number">8</span>|e<span class="hljs-selector-attr">[n+2&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-(n+<span class="hljs-number">2</span>)%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>,c=<span class="hljs-number">0</span>;c&lt;<span class="hljs-number">4</span>&amp;&amp;n+.<span class="hljs-number">75</span>*c&lt;r;c++)o<span class="hljs-selector-class">.push</span>(<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.charAt</span>(s&gt;&gt;&gt;<span class="hljs-number">6</span>*(<span class="hljs-number">3</span>-c)&amp;<span class="hljs-number">63</span>));<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">a</span>=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.charAt</span>(<span class="hljs-number">64</span>);if(<span class="hljs-selector-tag">a</span>)for(;o<span class="hljs-selector-class">.length</span>%<span class="hljs-number">4</span>;)o<span class="hljs-selector-class">.push</span>(<span class="hljs-selector-tag">a</span>);return o<span class="hljs-selector-class">.join</span>("")},parse:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.length</span>,r=this._map;if(!(<span class="hljs-selector-tag">i</span>=this._reverseMap))for(<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=this._reverseMap=<span class="hljs-selector-attr">[]</span>,o=<span class="hljs-number">0</span>;o&lt;r<span class="hljs-selector-class">.length</span>;o++)<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[r.charCodeAt(o)]</span>=o;for(<span class="hljs-selector-tag">var</span> n,s,c=r<span class="hljs-selector-class">.charAt</span>(<span class="hljs-number">64</span>),<span class="hljs-selector-tag">a</span>=(!c||-<span class="hljs-number">1</span>!==(c=t<span class="hljs-selector-class">.indexOf</span>(c))&amp;&amp;(e=c),t),h=e,l=<span class="hljs-selector-tag">i</span>,f=<span class="hljs-selector-attr">[]</span>,d=<span class="hljs-number">0</span>,u=<span class="hljs-number">0</span>;u&lt;h;u++)u%<span class="hljs-number">4</span>&amp;&amp;(s=l<span class="hljs-selector-attr">[a.charCodeAt(u-1)]</span>&lt;&lt;u%<span class="hljs-number">4</span>*<span class="hljs-number">2</span>,n=l<span class="hljs-selector-attr">[a.charCodeAt(u)]</span>&gt;&gt;&gt;<span class="hljs-number">6</span>-u%<span class="hljs-number">4</span>*<span class="hljs-number">2</span>,s=s|n,f<span class="hljs-selector-attr">[d&gt;&gt;&gt;2]</span>|=s&lt;&lt;<span class="hljs-number">24</span>-d%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>,d++);return U<span class="hljs-selector-class">.create</span>(f,d)},_map:<span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span>},K=(u=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.WordArray</span>,u<span class="hljs-selector-class">.enc</span><span class="hljs-selector-class">.Base64url</span>={stringify:<span class="hljs-built_in">function</span>(t,e){for(<span class="hljs-selector-tag">var</span> r=t<span class="hljs-selector-class">.words</span>,<span class="hljs-selector-tag">i</span>=t<span class="hljs-selector-class">.sigBytes</span>,o=(e=void <span class="hljs-number">0</span>===e?!<span class="hljs-number">0</span>:e)?this._safe_map:this._map,n=(t.<span class="hljs-built_in">clamp</span>(),[]),s=<span class="hljs-number">0</span>;s&lt;<span class="hljs-selector-tag">i</span>;s+=<span class="hljs-number">3</span>)for(<span class="hljs-selector-tag">var</span> c=(r<span class="hljs-selector-attr">[s&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-s%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>)&lt;&lt;<span class="hljs-number">16</span>|(r<span class="hljs-selector-attr">[s+1&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-(s+<span class="hljs-number">1</span>)%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>)&lt;&lt;<span class="hljs-number">8</span>|r<span class="hljs-selector-attr">[s+2&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-(s+<span class="hljs-number">2</span>)%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>,<span class="hljs-selector-tag">a</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">a</span>&lt;<span class="hljs-number">4</span>&amp;&amp;s+.<span class="hljs-number">75</span>*<span class="hljs-selector-tag">a</span>&lt;<span class="hljs-selector-tag">i</span>;<span class="hljs-selector-tag">a</span>++)n<span class="hljs-selector-class">.push</span>(o<span class="hljs-selector-class">.charAt</span>(c&gt;&gt;&gt;<span class="hljs-number">6</span>*(<span class="hljs-number">3</span>-<span class="hljs-selector-tag">a</span>)&amp;<span class="hljs-number">63</span>));<span class="hljs-selector-tag">var</span> h=o<span class="hljs-selector-class">.charAt</span>(<span class="hljs-number">64</span>);if(h)for(;n<span class="hljs-selector-class">.length</span>%<span class="hljs-number">4</span>;)n<span class="hljs-selector-class">.push</span>(h);return n<span class="hljs-selector-class">.join</span>("")},parse:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=t<span class="hljs-selector-class">.length</span>,<span class="hljs-selector-tag">i</span>=(e=void <span class="hljs-number">0</span>===e?!<span class="hljs-number">0</span>:e)?this._safe_map:this._map;if(!(o=this._reverseMap))for(<span class="hljs-selector-tag">var</span> o=this._reverseMap=<span class="hljs-selector-attr">[]</span>,n=<span class="hljs-number">0</span>;n&lt;<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.length</span>;n++)o<span class="hljs-selector-attr">[i.charCodeAt(n)]</span>=n;for(<span class="hljs-selector-tag">var</span> s,c,e=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.charAt</span>(<span class="hljs-number">64</span>),<span class="hljs-selector-tag">a</span>=(!e||-<span class="hljs-number">1</span>!==(e=t<span class="hljs-selector-class">.indexOf</span>(e))&amp;&amp;(r=e),t),h=r,l=o,f=<span class="hljs-selector-attr">[]</span>,d=<span class="hljs-number">0</span>,u=<span class="hljs-number">0</span>;u&lt;h;u++)u%<span class="hljs-number">4</span>&amp;&amp;(c=l<span class="hljs-selector-attr">[a.charCodeAt(u-1)]</span>&lt;&lt;u%<span class="hljs-number">4</span>*<span class="hljs-number">2</span>,s=l<span class="hljs-selector-attr">[a.charCodeAt(u)]</span>&gt;&gt;&gt;<span class="hljs-number">6</span>-u%<span class="hljs-number">4</span>*<span class="hljs-number">2</span>,c=c|s,f<span class="hljs-selector-attr">[d&gt;&gt;&gt;2]</span>|=c&lt;&lt;<span class="hljs-number">24</span>-d%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>,d++);return K<span class="hljs-selector-class">.create</span>(f,d)},_map:<span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span>,_safe_map:<span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"</span>};for(<span class="hljs-selector-tag">var</span> y1=Math,<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>,g1=(u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.lib</span>)<span class="hljs-selector-class">.WordArray</span>,v1=u<span class="hljs-selector-class">.Hasher</span>,u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>,<span class="hljs-selector-tag">A</span>=<span class="hljs-selector-attr">[]</span>,B1=<span class="hljs-number">0</span>;B1&lt;<span class="hljs-number">64</span>;B1++)<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[B1]</span>=<span class="hljs-number">4294967296</span>*y1<span class="hljs-selector-class">.abs</span>(y1<span class="hljs-selector-class">.sin</span>(B1+<span class="hljs-number">1</span>))|<span class="hljs-number">0</span>;function z(t,e,r,<span class="hljs-selector-tag">i</span>,o,n,s){t=t+(e&amp;r|~e&amp;<span class="hljs-selector-tag">i</span>)+o+s;return(t&lt;&lt;n|t&gt;&gt;&gt;<span class="hljs-number">32</span>-n)+e}function H(t,e,r,<span class="hljs-selector-tag">i</span>,o,n,s){t=t+(e&amp;<span class="hljs-selector-tag">i</span>|r&amp;~<span class="hljs-selector-tag">i</span>)+o+s;return(t&lt;&lt;n|t&gt;&gt;&gt;<span class="hljs-number">32</span>-n)+e}function C(t,e,r,<span class="hljs-selector-tag">i</span>,o,n,s){t=t+(e^r^<span class="hljs-selector-tag">i</span>)+o+s;return(t&lt;&lt;n|t&gt;&gt;&gt;<span class="hljs-number">32</span>-n)+e}function R(t,e,r,<span class="hljs-selector-tag">i</span>,o,n,s){t=t+(r^(e|~<span class="hljs-selector-tag">i</span>))+o+s;return(t&lt;&lt;n|t&gt;&gt;&gt;<span class="hljs-number">32</span>-n)+e}u=u<span class="hljs-selector-class">.MD5</span>=v1<span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){this._hash=new g1<span class="hljs-selector-class">.init</span>(<span class="hljs-selector-attr">[1732584193,4023233417,2562383102,271733878]</span>)},_doProcessBlock:<span class="hljs-built_in">function</span>(t,e){for(<span class="hljs-selector-tag">var</span> r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">16</span>;r++){<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=e+r,o=t<span class="hljs-selector-attr">[i]</span>;t<span class="hljs-selector-attr">[i]</span>=<span class="hljs-number">16711935</span>&amp;(o&lt;&lt;<span class="hljs-number">8</span>|o&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(o&lt;&lt;<span class="hljs-number">24</span>|o&gt;&gt;&gt;<span class="hljs-number">8</span>)}<span class="hljs-selector-tag">var</span> n=this._hash<span class="hljs-selector-class">.words</span>,s=t<span class="hljs-selector-attr">[e+0]</span>,c=t<span class="hljs-selector-attr">[e+1]</span>,<span class="hljs-selector-tag">a</span>=t<span class="hljs-selector-attr">[e+2]</span>,h=t<span class="hljs-selector-attr">[e+3]</span>,l=t<span class="hljs-selector-attr">[e+4]</span>,f=t<span class="hljs-selector-attr">[e+5]</span>,d=t<span class="hljs-selector-attr">[e+6]</span>,u=t<span class="hljs-selector-attr">[e+7]</span>,<span class="hljs-selector-tag">p</span>=t<span class="hljs-selector-attr">[e+8]</span>,_=t<span class="hljs-selector-attr">[e+9]</span>,y=t<span class="hljs-selector-attr">[e+10]</span>,g=t<span class="hljs-selector-attr">[e+11]</span>,v=t<span class="hljs-selector-attr">[e+12]</span>,<span class="hljs-selector-tag">B</span>=t<span class="hljs-selector-attr">[e+13]</span>,w=t<span class="hljs-selector-attr">[e+14]</span>,k=t<span class="hljs-selector-attr">[e+15]</span>,x=z(n<span class="hljs-selector-attr">[0]</span>,S=n<span class="hljs-selector-attr">[1]</span>,m=n<span class="hljs-selector-attr">[2]</span>,<span class="hljs-selector-tag">b</span>=n<span class="hljs-selector-attr">[3]</span>,s,<span class="hljs-number">7</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[0]</span>),<span class="hljs-selector-tag">b</span>=z(<span class="hljs-selector-tag">b</span>,x,S,m,c,<span class="hljs-number">12</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[1]</span>),m=z(m,<span class="hljs-selector-tag">b</span>,x,S,<span class="hljs-selector-tag">a</span>,<span class="hljs-number">17</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[2]</span>),S=z(S,m,<span class="hljs-selector-tag">b</span>,x,h,<span class="hljs-number">22</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[3]</span>);x=z(x,S,m,<span class="hljs-selector-tag">b</span>,l,<span class="hljs-number">7</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[4]</span>),<span class="hljs-selector-tag">b</span>=z(<span class="hljs-selector-tag">b</span>,x,S,m,f,<span class="hljs-number">12</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[5]</span>),m=z(m,<span class="hljs-selector-tag">b</span>,x,S,d,<span class="hljs-number">17</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[6]</span>),S=z(S,m,<span class="hljs-selector-tag">b</span>,x,u,<span class="hljs-number">22</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[7]</span>),x=z(x,S,m,<span class="hljs-selector-tag">b</span>,<span class="hljs-selector-tag">p</span>,<span class="hljs-number">7</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[8]</span>),<span class="hljs-selector-tag">b</span>=z(<span class="hljs-selector-tag">b</span>,x,S,m,_,<span class="hljs-number">12</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[9]</span>),m=z(m,<span class="hljs-selector-tag">b</span>,x,S,y,<span class="hljs-number">17</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[10]</span>),S=z(S,m,<span class="hljs-selector-tag">b</span>,x,g,<span class="hljs-number">22</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[11]</span>),x=z(x,S,m,<span class="hljs-selector-tag">b</span>,v,<span class="hljs-number">7</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[12]</span>),<span class="hljs-selector-tag">b</span>=z(<span class="hljs-selector-tag">b</span>,x,S,m,<span class="hljs-selector-tag">B</span>,<span class="hljs-number">12</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[13]</span>),m=z(m,<span class="hljs-selector-tag">b</span>,x,S,w,<span class="hljs-number">17</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[14]</span>),x=H(x,S=z(S,m,<span class="hljs-selector-tag">b</span>,x,k,<span class="hljs-number">22</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[15]</span>),m,<span class="hljs-selector-tag">b</span>,c,<span class="hljs-number">5</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[16]</span>),<span class="hljs-selector-tag">b</span>=H(<span class="hljs-selector-tag">b</span>,x,S,m,d,<span class="hljs-number">9</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[17]</span>),m=H(m,<span class="hljs-selector-tag">b</span>,x,S,g,<span class="hljs-number">14</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[18]</span>),S=H(S,m,<span class="hljs-selector-tag">b</span>,x,s,<span class="hljs-number">20</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[19]</span>),x=H(x,S,m,<span class="hljs-selector-tag">b</span>,f,<span class="hljs-number">5</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[20]</span>),<span class="hljs-selector-tag">b</span>=H(<span class="hljs-selector-tag">b</span>,x,S,m,y,<span class="hljs-number">9</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[21]</span>),m=H(m,<span class="hljs-selector-tag">b</span>,x,S,k,<span class="hljs-number">14</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[22]</span>),S=H(S,m,<span class="hljs-selector-tag">b</span>,x,l,<span class="hljs-number">20</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[23]</span>),x=H(x,S,m,<span class="hljs-selector-tag">b</span>,_,<span class="hljs-number">5</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[24]</span>),<span class="hljs-selector-tag">b</span>=H(<span class="hljs-selector-tag">b</span>,x,S,m,w,<span class="hljs-number">9</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[25]</span>),m=H(m,<span class="hljs-selector-tag">b</span>,x,S,h,<span class="hljs-number">14</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[26]</span>),S=H(S,m,<span class="hljs-selector-tag">b</span>,x,<span class="hljs-selector-tag">p</span>,<span class="hljs-number">20</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[27]</span>),x=H(x,S,m,<span class="hljs-selector-tag">b</span>,<span class="hljs-selector-tag">B</span>,<span class="hljs-number">5</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[28]</span>),<span class="hljs-selector-tag">b</span>=H(<span class="hljs-selector-tag">b</span>,x,S,m,<span class="hljs-selector-tag">a</span>,<span class="hljs-number">9</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[29]</span>),m=H(m,<span class="hljs-selector-tag">b</span>,x,S,u,<span class="hljs-number">14</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[30]</span>),x=C(x,S=H(S,m,<span class="hljs-selector-tag">b</span>,x,v,<span class="hljs-number">20</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[31]</span>),m,<span class="hljs-selector-tag">b</span>,f,<span class="hljs-number">4</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[32]</span>),<span class="hljs-selector-tag">b</span>=C(<span class="hljs-selector-tag">b</span>,x,S,m,<span class="hljs-selector-tag">p</span>,<span class="hljs-number">11</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[33]</span>),m=C(m,<span class="hljs-selector-tag">b</span>,x,S,g,<span class="hljs-number">16</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[34]</span>),S=C(S,m,<span class="hljs-selector-tag">b</span>,x,w,<span class="hljs-number">23</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[35]</span>),x=C(x,S,m,<span class="hljs-selector-tag">b</span>,c,<span class="hljs-number">4</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[36]</span>),<span class="hljs-selector-tag">b</span>=C(<span class="hljs-selector-tag">b</span>,x,S,m,l,<span class="hljs-number">11</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[37]</span>),m=C(m,<span class="hljs-selector-tag">b</span>,x,S,u,<span class="hljs-number">16</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[38]</span>),S=C(S,m,<span class="hljs-selector-tag">b</span>,x,y,<span class="hljs-number">23</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[39]</span>),x=C(x,S,m,<span class="hljs-selector-tag">b</span>,<span class="hljs-selector-tag">B</span>,<span class="hljs-number">4</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[40]</span>),<span class="hljs-selector-tag">b</span>=C(<span class="hljs-selector-tag">b</span>,x,S,m,s,<span class="hljs-number">11</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[41]</span>),m=C(m,<span class="hljs-selector-tag">b</span>,x,S,h,<span class="hljs-number">16</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[42]</span>),S=C(S,m,<span class="hljs-selector-tag">b</span>,x,d,<span class="hljs-number">23</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[43]</span>),x=C(x,S,m,<span class="hljs-selector-tag">b</span>,_,<span class="hljs-number">4</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[44]</span>),<span class="hljs-selector-tag">b</span>=C(<span class="hljs-selector-tag">b</span>,x,S,m,v,<span class="hljs-number">11</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[45]</span>),m=C(m,<span class="hljs-selector-tag">b</span>,x,S,k,<span class="hljs-number">16</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[46]</span>),x=R(x,S=C(S,m,<span class="hljs-selector-tag">b</span>,x,<span class="hljs-selector-tag">a</span>,<span class="hljs-number">23</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[47]</span>),m,<span class="hljs-selector-tag">b</span>,s,<span class="hljs-number">6</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[48]</span>),<span class="hljs-selector-tag">b</span>=R(<span class="hljs-selector-tag">b</span>,x,S,m,u,<span class="hljs-number">10</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[49]</span>),m=R(m,<span class="hljs-selector-tag">b</span>,x,S,w,<span class="hljs-number">15</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[50]</span>),S=R(S,m,<span class="hljs-selector-tag">b</span>,x,f,<span class="hljs-number">21</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[51]</span>),x=R(x,S,m,<span class="hljs-selector-tag">b</span>,v,<span class="hljs-number">6</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[52]</span>),<span class="hljs-selector-tag">b</span>=R(<span class="hljs-selector-tag">b</span>,x,S,m,h,<span class="hljs-number">10</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[53]</span>),m=R(m,<span class="hljs-selector-tag">b</span>,x,S,y,<span class="hljs-number">15</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[54]</span>),S=R(S,m,<span class="hljs-selector-tag">b</span>,x,c,<span class="hljs-number">21</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[55]</span>),x=R(x,S,m,<span class="hljs-selector-tag">b</span>,<span class="hljs-selector-tag">p</span>,<span class="hljs-number">6</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[56]</span>),<span class="hljs-selector-tag">b</span>=R(<span class="hljs-selector-tag">b</span>,x,S,m,k,<span class="hljs-number">10</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[57]</span>),m=R(m,<span class="hljs-selector-tag">b</span>,x,S,d,<span class="hljs-number">15</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[58]</span>),S=R(S,m,<span class="hljs-selector-tag">b</span>,x,<span class="hljs-selector-tag">B</span>,<span class="hljs-number">21</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[59]</span>),x=R(x,S,m,<span class="hljs-selector-tag">b</span>,l,<span class="hljs-number">6</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[60]</span>),<span class="hljs-selector-tag">b</span>=R(<span class="hljs-selector-tag">b</span>,x,S,m,g,<span class="hljs-number">10</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[61]</span>),m=R(m,<span class="hljs-selector-tag">b</span>,x,S,<span class="hljs-selector-tag">a</span>,<span class="hljs-number">15</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[62]</span>),S=R(S,m,<span class="hljs-selector-tag">b</span>,x,_,<span class="hljs-number">21</span>,<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[63]</span>),n<span class="hljs-selector-attr">[0]</span>=n<span class="hljs-selector-attr">[0]</span>+x|<span class="hljs-number">0</span>,n<span class="hljs-selector-attr">[1]</span>=n<span class="hljs-selector-attr">[1]</span>+S|<span class="hljs-number">0</span>,n<span class="hljs-selector-attr">[2]</span>=n<span class="hljs-selector-attr">[2]</span>+m|<span class="hljs-number">0</span>,n<span class="hljs-selector-attr">[3]</span>=n<span class="hljs-selector-attr">[3]</span>+<span class="hljs-selector-tag">b</span>|<span class="hljs-number">0</span>},_doFinalize:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=this._data,e=t<span class="hljs-selector-class">.words</span>,r=<span class="hljs-number">8</span>*this._nDataBytes,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">8</span>*t<span class="hljs-selector-class">.sigBytes</span>,o=(e<span class="hljs-selector-attr">[i&gt;&gt;&gt;5]</span>|=<span class="hljs-number">128</span>&lt;&lt;<span class="hljs-number">24</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">32</span>,y1<span class="hljs-selector-class">.floor</span>(r/<span class="hljs-number">4294967296</span>)),o=(e<span class="hljs-selector-attr">[15+(64+i&gt;&gt;&gt;9&lt;&lt;4)]</span>=<span class="hljs-number">16711935</span>&amp;(o&lt;&lt;<span class="hljs-number">8</span>|o&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(o&lt;&lt;<span class="hljs-number">24</span>|o&gt;&gt;&gt;<span class="hljs-number">8</span>),e<span class="hljs-selector-attr">[14+(64+i&gt;&gt;&gt;9&lt;&lt;4)]</span>=<span class="hljs-number">16711935</span>&amp;(r&lt;&lt;<span class="hljs-number">8</span>|r&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(r&lt;&lt;<span class="hljs-number">24</span>|r&gt;&gt;&gt;<span class="hljs-number">8</span>),t<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-number">4</span>*(e<span class="hljs-selector-class">.length</span>+<span class="hljs-number">1</span>),this._process(),this._hash),n=o<span class="hljs-selector-class">.words</span>,s=<span class="hljs-number">0</span>;s&lt;<span class="hljs-number">4</span>;s++){<span class="hljs-selector-tag">var</span> c=n<span class="hljs-selector-attr">[s]</span>;n<span class="hljs-selector-attr">[s]</span>=<span class="hljs-number">16711935</span>&amp;(c&lt;&lt;<span class="hljs-number">8</span>|c&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(c&lt;&lt;<span class="hljs-number">24</span>|c&gt;&gt;&gt;<span class="hljs-number">8</span>)}return o},clone:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=v1<span class="hljs-selector-class">.clone</span><span class="hljs-selector-class">.call</span>(this);return t._hash=this._hash<span class="hljs-selector-class">.clone</span>(),t}}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.MD5</span>=v1._createHelper(u),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.HmacMD5</span>=v1._createHmacHelper(u),u=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span>,X=u<span class="hljs-selector-class">.WordArray</span>,L=u<span class="hljs-selector-class">.Hasher</span>,u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>,l=<span class="hljs-selector-attr">[]</span>,u=u<span class="hljs-selector-class">.SHA1</span>=L<span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){this._hash=new X<span class="hljs-selector-class">.init</span>(<span class="hljs-selector-attr">[1732584193,4023233417,2562383102,271733878,3285377520]</span>)},_doProcessBlock:<span class="hljs-built_in">function</span>(t,e){for(<span class="hljs-selector-tag">var</span> r=this._hash<span class="hljs-selector-class">.words</span>,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-attr">[0]</span>,o=r<span class="hljs-selector-attr">[1]</span>,n=r<span class="hljs-selector-attr">[2]</span>,s=r<span class="hljs-selector-attr">[3]</span>,c=r<span class="hljs-selector-attr">[4]</span>,<span class="hljs-selector-tag">a</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">a</span>&lt;<span class="hljs-number">80</span>;<span class="hljs-selector-tag">a</span>++){<span class="hljs-selector-tag">a</span>&lt;<span class="hljs-number">16</span>?l<span class="hljs-selector-attr">[a]</span>=<span class="hljs-number">0</span>|t<span class="hljs-selector-attr">[e+a]</span>:(h=l[a-<span class="hljs-number">3</span>]^l[a-<span class="hljs-number">8</span>]^l[a-<span class="hljs-number">14</span>]^l[a-<span class="hljs-number">16</span>],l[a]=h&lt;&lt;<span class="hljs-number">1</span>|h&gt;&gt;&gt;<span class="hljs-number">31</span>);<span class="hljs-selector-tag">var</span> h=(<span class="hljs-selector-tag">i</span>&lt;&lt;<span class="hljs-number">5</span>|<span class="hljs-selector-tag">i</span>&gt;&gt;&gt;<span class="hljs-number">27</span>)+c+l<span class="hljs-selector-attr">[a]</span>;h+=<span class="hljs-selector-tag">a</span>&lt;<span class="hljs-number">20</span>?<span class="hljs-number">1518500249</span>+(o&amp;n|~o&amp;s):a&lt;<span class="hljs-number">40</span>?<span class="hljs-number">1859775393</span>+(o^n^s):a&lt;<span class="hljs-number">60</span>?(o&amp;n|o&amp;s|n&amp;s)-<span class="hljs-number">1894007588</span>:(o^n^s)-<span class="hljs-number">899497514</span>,c=s,s=n,n=o&lt;&lt;<span class="hljs-number">30</span>|o&gt;&gt;&gt;<span class="hljs-number">2</span>,o=i,i=h}r<span class="hljs-selector-attr">[0]</span>=r<span class="hljs-selector-attr">[0]</span>+<span class="hljs-selector-tag">i</span>|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[1]</span>=r<span class="hljs-selector-attr">[1]</span>+o|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[2]</span>=r<span class="hljs-selector-attr">[2]</span>+n|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[3]</span>=r<span class="hljs-selector-attr">[3]</span>+s|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[4]</span>=r<span class="hljs-selector-attr">[4]</span>+c|<span class="hljs-number">0</span>},_doFinalize:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=this._data,e=t<span class="hljs-selector-class">.words</span>,r=<span class="hljs-number">8</span>*this._nDataBytes,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">8</span>*t<span class="hljs-selector-class">.sigBytes</span>;return e<span class="hljs-selector-attr">[i&gt;&gt;&gt;5]</span>|=<span class="hljs-number">128</span>&lt;&lt;<span class="hljs-number">24</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">32</span>,e<span class="hljs-selector-attr">[14+(64+i&gt;&gt;&gt;9&lt;&lt;4)]</span>=Math<span class="hljs-selector-class">.floor</span>(r/<span class="hljs-number">4294967296</span>),e<span class="hljs-selector-attr">[15+(64+i&gt;&gt;&gt;9&lt;&lt;4)]</span>=r,t<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-number">4</span>*e<span class="hljs-selector-class">.length</span>,this._process(),this._hash},clone:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=L<span class="hljs-selector-class">.clone</span><span class="hljs-selector-class">.call</span>(this);return t._hash=this._hash<span class="hljs-selector-class">.clone</span>(),t}}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.SHA1</span>=L._createHelper(u),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.HmacSHA1</span>=L._createHmacHelper(u);<span class="hljs-selector-tag">var</span> w1=Math,<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>,k1=(u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.lib</span>)<span class="hljs-selector-class">.WordArray</span>,x1=u<span class="hljs-selector-class">.Hasher</span>,u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>,b1=<span class="hljs-selector-attr">[]</span>,m1=<span class="hljs-selector-attr">[]</span>;function S1(t){return <span class="hljs-number">4294967296</span>*(t-(<span class="hljs-number">0</span>|t))|<span class="hljs-number">0</span>}for(<span class="hljs-selector-tag">var</span> A1=<span class="hljs-number">2</span>,z1=<span class="hljs-number">0</span>;z1&lt;<span class="hljs-number">64</span>;)!function(t){for(<span class="hljs-selector-tag">var</span> e=w1<span class="hljs-selector-class">.sqrt</span>(t),r=<span class="hljs-number">2</span>;r&lt;=e;r++)if(!(t%r))return;return <span class="hljs-number">1</span>}(A1)||(z1&lt;<span class="hljs-number">8</span>&amp;&amp;(b1<span class="hljs-selector-attr">[z1]</span>=S1(w1<span class="hljs-selector-class">.pow</span>(A1,.<span class="hljs-number">5</span>))),m1<span class="hljs-selector-attr">[z1]</span>=S1(w1<span class="hljs-selector-class">.pow</span>(A1,<span class="hljs-number">1</span>/<span class="hljs-number">3</span>)),z1++),A1++;<span class="hljs-selector-tag">var</span> _=<span class="hljs-selector-attr">[]</span>,u=u<span class="hljs-selector-class">.SHA256</span>=x1<span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){this._hash=new k1<span class="hljs-selector-class">.init</span>(b1<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>))},_doProcessBlock:<span class="hljs-built_in">function</span>(t,e){for(<span class="hljs-selector-tag">var</span> r=this._hash<span class="hljs-selector-class">.words</span>,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-attr">[0]</span>,o=r<span class="hljs-selector-attr">[1]</span>,n=r<span class="hljs-selector-attr">[2]</span>,s=r<span class="hljs-selector-attr">[3]</span>,c=r<span class="hljs-selector-attr">[4]</span>,<span class="hljs-selector-tag">a</span>=r<span class="hljs-selector-attr">[5]</span>,h=r<span class="hljs-selector-attr">[6]</span>,l=r<span class="hljs-selector-attr">[7]</span>,f=<span class="hljs-number">0</span>;f&lt;<span class="hljs-number">64</span>;f++){f&lt;<span class="hljs-number">16</span>?_<span class="hljs-selector-attr">[f]</span>=<span class="hljs-number">0</span>|t<span class="hljs-selector-attr">[e+f]</span>:(d=_[f-<span class="hljs-number">15</span>],u=_[f-<span class="hljs-number">2</span>],_[f]=((d&lt;&lt;<span class="hljs-number">25</span>|d&gt;&gt;&gt;<span class="hljs-number">7</span>)^(d&lt;&lt;<span class="hljs-number">14</span>|d&gt;&gt;&gt;<span class="hljs-number">18</span>)^d&gt;&gt;&gt;<span class="hljs-number">3</span>)+_[f-<span class="hljs-number">7</span>]+((u&lt;&lt;<span class="hljs-number">15</span>|u&gt;&gt;&gt;<span class="hljs-number">17</span>)^(u&lt;&lt;<span class="hljs-number">13</span>|u&gt;&gt;&gt;<span class="hljs-number">19</span>)^u&gt;&gt;&gt;<span class="hljs-number">10</span>)+_[f-<span class="hljs-number">16</span>]);<span class="hljs-selector-tag">var</span> d=<span class="hljs-selector-tag">i</span>&amp;o^<span class="hljs-selector-tag">i</span>&amp;n^o&amp;n,u=l+((c&lt;&lt;<span class="hljs-number">26</span>|c&gt;&gt;&gt;<span class="hljs-number">6</span>)^(c&lt;&lt;<span class="hljs-number">21</span>|c&gt;&gt;&gt;<span class="hljs-number">11</span>)^(c&lt;&lt;<span class="hljs-number">7</span>|c&gt;&gt;&gt;<span class="hljs-number">25</span>))+(c&amp;<span class="hljs-selector-tag">a</span>^~c&amp;h)+m1<span class="hljs-selector-attr">[f]</span>+_<span class="hljs-selector-attr">[f]</span>,l=h,h=<span class="hljs-selector-tag">a</span>,<span class="hljs-selector-tag">a</span>=c,c=s+u|<span class="hljs-number">0</span>,s=n,n=o,o=<span class="hljs-selector-tag">i</span>,<span class="hljs-selector-tag">i</span>=u+(((<span class="hljs-selector-tag">i</span>&lt;&lt;<span class="hljs-number">30</span>|<span class="hljs-selector-tag">i</span>&gt;&gt;&gt;<span class="hljs-number">2</span>)^(<span class="hljs-selector-tag">i</span>&lt;&lt;<span class="hljs-number">19</span>|<span class="hljs-selector-tag">i</span>&gt;&gt;&gt;<span class="hljs-number">13</span>)^(<span class="hljs-selector-tag">i</span>&lt;&lt;<span class="hljs-number">10</span>|<span class="hljs-selector-tag">i</span>&gt;&gt;&gt;<span class="hljs-number">22</span>))+d)|<span class="hljs-number">0</span>}r<span class="hljs-selector-attr">[0]</span>=r<span class="hljs-selector-attr">[0]</span>+<span class="hljs-selector-tag">i</span>|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[1]</span>=r<span class="hljs-selector-attr">[1]</span>+o|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[2]</span>=r<span class="hljs-selector-attr">[2]</span>+n|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[3]</span>=r<span class="hljs-selector-attr">[3]</span>+s|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[4]</span>=r<span class="hljs-selector-attr">[4]</span>+c|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[5]</span>=r<span class="hljs-selector-attr">[5]</span>+<span class="hljs-selector-tag">a</span>|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[6]</span>=r<span class="hljs-selector-attr">[6]</span>+h|<span class="hljs-number">0</span>,r<span class="hljs-selector-attr">[7]</span>=r<span class="hljs-selector-attr">[7]</span>+l|<span class="hljs-number">0</span>},_doFinalize:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=this._data,e=t<span class="hljs-selector-class">.words</span>,r=<span class="hljs-number">8</span>*this._nDataBytes,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">8</span>*t<span class="hljs-selector-class">.sigBytes</span>;return e<span class="hljs-selector-attr">[i&gt;&gt;&gt;5]</span>|=<span class="hljs-number">128</span>&lt;&lt;<span class="hljs-number">24</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">32</span>,e<span class="hljs-selector-attr">[14+(64+i&gt;&gt;&gt;9&lt;&lt;4)]</span>=w1<span class="hljs-selector-class">.floor</span>(r/<span class="hljs-number">4294967296</span>),e<span class="hljs-selector-attr">[15+(64+i&gt;&gt;&gt;9&lt;&lt;4)]</span>=r,t<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-number">4</span>*e<span class="hljs-selector-class">.length</span>,this._process(),this._hash},clone:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=x1<span class="hljs-selector-class">.clone</span><span class="hljs-selector-class">.call</span>(this);return t._hash=this._hash<span class="hljs-selector-class">.clone</span>(),t}}),<span class="hljs-selector-tag">p</span>=(<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.SHA256</span>=x1._createHelper(u),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.HmacSHA256</span>=x1._createHmacHelper(u),j=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.WordArray</span>,u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>,T=u<span class="hljs-selector-class">.SHA256</span>,u=u<span class="hljs-selector-class">.SHA224</span>=T<span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){this._hash=new j<span class="hljs-selector-class">.init</span>(<span class="hljs-selector-attr">[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]</span>)},_doFinalize:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=T._doFinalize<span class="hljs-selector-class">.call</span>(this);return t<span class="hljs-selector-class">.sigBytes-</span>=<span class="hljs-number">4</span>,t}}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.SHA224</span>=T._createHelper(u),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.HmacSHA224</span>=T._createHmacHelper(u),<span class="hljs-selector-tag">i</span>),<span class="hljs-selector-tag">H1</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.Hasher</span>,y=(u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.x64</span>)<span class="hljs-selector-class">.Word</span>,C1=u<span class="hljs-selector-class">.WordArray</span>,u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>;function g(){return y<span class="hljs-selector-class">.create</span><span class="hljs-selector-class">.apply</span>(y,arguments)}for(<span class="hljs-selector-tag">var</span> R1=<span class="hljs-selector-attr">[g(1116352408,3609767458),g(1899447441,602891725),g(3049323471,3964484399),g(3921009573,2173295548),g(961987163,4081628472),g(1508970993,3053834265),g(2453635748,2937671579),g(2870763221,3664609560),g(3624381080,2734883394),g(310598401,1164996542),g(607225278,1323610764),g(1426881987,3590304994),g(1925078388,4068182383),g(2162078206,991336113),g(2614888103,633803317),g(3248222580,3479774868),g(3835390401,2666613458),g(4022224774,944711139),g(264347078,2341262773),g(604807628,2007800933),g(770255983,1495990901),g(1249150122,1856431235),g(1555081692,3175218132),g(1996064986,2198950837),g(2554220882,3999719339),g(2821834349,766784016),g(2952996808,2566594879),g(3210313671,3203337956),g(3336571891,1034457026),g(3584528711,2466948901),g(113926993,3758326383),g(338241895,168717936),g(666307205,1188179964),g(773529912,1546045734),g(1294757372,1522805485),g(1396182291,2643833823),g(1695183700,2343527390),g(1986661051,1014477480),g(2177026350,1206759142),g(2456956037,344077627),g(2730485921,1290863460),g(2820302411,3158454273),g(3259730800,3505952657),g(3345764771,106217008),g(3516065817,3606008344),g(3600352804,1432725776),g(4094571909,1467031594),g(275423344,851169720),g(430227734,3100823752),g(506948616,1363258195),g(659060556,3750685593),g(883997877,3785050280),g(958139571,3318307427),g(1322822218,3812723403),g(1537002063,2003034995),g(1747873779,3602036899),g(1955562222,1575990012),g(2024104815,1125592928),g(2227730452,2716904306),g(2361852424,442776044),g(2428436474,593698344),g(2756734187,3733110249),g(3204031479,2999351573),g(3329325298,3815920427),g(3391569614,3928383900),g(3515267271,566280711),g(3940187606,3454069534),g(4118630271,4000239992),g(116418474,1914138554),g(174292421,2731055270),g(289380356,3203993006),g(460393269,320620315),g(685471733,587496836),g(852142971,1086792851),g(1017036298,365543100),g(1126000580,2618297676),g(1288033470,3409855158),g(1501505948,4234509866),g(1607167915,987167468),g(1816402316,1246189591)]</span>,D1=<span class="hljs-selector-attr">[]</span>,E1=<span class="hljs-number">0</span>;E1&lt;<span class="hljs-number">80</span>;E1++)D1<span class="hljs-selector-attr">[E1]</span>=g();u=u<span class="hljs-selector-class">.SHA512</span>=<span class="hljs-selector-tag">H1</span><span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){this._hash=new C1<span class="hljs-selector-class">.init</span>(<span class="hljs-selector-attr">[new y.init(1779033703,4089235720),new y.init(3144134277,2227873595),new y.init(1013904242,4271175723),new y.init(2773480762,1595750129),new y.init(1359893119,2917565137),new y.init(2600822924,725511199),new y.init(528734635,4215389547),new y.init(1541459225,327033209)]</span>)},_doProcessBlock:<span class="hljs-built_in">function</span>(W,O){for(<span class="hljs-selector-tag">var</span> t=this._hash<span class="hljs-selector-class">.words</span>,e=t<span class="hljs-selector-attr">[0]</span>,r=t<span class="hljs-selector-attr">[1]</span>,<span class="hljs-selector-tag">i</span>=t<span class="hljs-selector-attr">[2]</span>,o=t<span class="hljs-selector-attr">[3]</span>,n=t<span class="hljs-selector-attr">[4]</span>,s=t<span class="hljs-selector-attr">[5]</span>,c=t<span class="hljs-selector-attr">[6]</span>,t=t<span class="hljs-selector-attr">[7]</span>,<span class="hljs-selector-tag">I</span>=e<span class="hljs-selector-class">.high</span>,<span class="hljs-selector-tag">a</span>=e<span class="hljs-selector-class">.low</span>,U=r<span class="hljs-selector-class">.high</span>,h=r<span class="hljs-selector-class">.low</span>,K=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.high</span>,l=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.low</span>,X=o<span class="hljs-selector-class">.high</span>,f=o<span class="hljs-selector-class">.low</span>,L=n<span class="hljs-selector-class">.high</span>,d=n<span class="hljs-selector-class">.low</span>,j=s<span class="hljs-selector-class">.high</span>,u=s<span class="hljs-selector-class">.low</span>,T=c<span class="hljs-selector-class">.high</span>,<span class="hljs-selector-tag">p</span>=c<span class="hljs-selector-class">.low</span>,N=t<span class="hljs-selector-class">.high</span>,_=t<span class="hljs-selector-class">.low</span>,y=<span class="hljs-selector-tag">I</span>,g=<span class="hljs-selector-tag">a</span>,v=U,<span class="hljs-selector-tag">B</span>=h,w=K,k=l,<span class="hljs-selector-tag">q</span>=X,x=f,<span class="hljs-selector-tag">b</span>=L,m=d,Z=j,S=u,V=T,G=<span class="hljs-selector-tag">p</span>,J=N,<span class="hljs-selector-tag">Q</span>=_,<span class="hljs-selector-tag">A</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">A</span>&lt;<span class="hljs-number">80</span>;<span class="hljs-selector-tag">A</span>++)<span class="hljs-selector-tag">var</span> z,H,C=D1<span class="hljs-selector-attr">[A]</span>,R=(<span class="hljs-selector-tag">A</span>&lt;<span class="hljs-number">16</span>?(H=C<span class="hljs-selector-class">.high</span>=<span class="hljs-number">0</span>|W<span class="hljs-selector-attr">[O+2*A]</span>,z=C<span class="hljs-selector-class">.low</span>=<span class="hljs-number">0</span>|W<span class="hljs-selector-attr">[O+2*A+1]</span>):(F=(P=D1[A-<span class="hljs-number">15</span>]).high,P=P.low,M=(E=D1[A-<span class="hljs-number">2</span>]).high,E=E.low,D=(R=D1[A-<span class="hljs-number">7</span>]).high,R=R.low,$=(Y=D1[A-<span class="hljs-number">16</span>]).high,H=(H=((F&gt;&gt;&gt;<span class="hljs-number">1</span>|P&lt;&lt;<span class="hljs-number">31</span>)^(F&gt;&gt;&gt;<span class="hljs-number">8</span>|P&lt;&lt;<span class="hljs-number">24</span>)^F&gt;&gt;&gt;<span class="hljs-number">7</span>)+D+((z=(D=(P&gt;&gt;&gt;<span class="hljs-number">1</span>|F&lt;&lt;<span class="hljs-number">31</span>)^(P&gt;&gt;&gt;<span class="hljs-number">8</span>|F&lt;&lt;<span class="hljs-number">24</span>)^(P&gt;&gt;&gt;<span class="hljs-number">7</span>|F&lt;&lt;<span class="hljs-number">25</span>))+R)&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;D&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>))+((M&gt;&gt;&gt;<span class="hljs-number">19</span>|E&lt;&lt;<span class="hljs-number">13</span>)^(M&lt;&lt;<span class="hljs-number">3</span>|E&gt;&gt;&gt;<span class="hljs-number">29</span>)^M&gt;&gt;&gt;<span class="hljs-number">6</span>)+((z+=P=(E&gt;&gt;&gt;<span class="hljs-number">19</span>|M&lt;&lt;<span class="hljs-number">13</span>)^(E&lt;&lt;<span class="hljs-number">3</span>|M&gt;&gt;&gt;<span class="hljs-number">29</span>)^(E&gt;&gt;&gt;<span class="hljs-number">6</span>|M&lt;&lt;<span class="hljs-number">26</span>))&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;P&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),z+=F=Y.low,C.high=H=H+$+(z&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;F&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),C.low=z),b&amp;Z^~b&amp;V),D=m&amp;S^~m&amp;G,E=y&amp;v^y&amp;w^v&amp;w,M=(g&gt;&gt;&gt;<span class="hljs-number">28</span>|y&lt;&lt;<span class="hljs-number">4</span>)^(g&lt;&lt;<span class="hljs-number">30</span>|y&gt;&gt;&gt;<span class="hljs-number">2</span>)^(g&lt;&lt;<span class="hljs-number">25</span>|y&gt;&gt;&gt;<span class="hljs-number">7</span>),P=R1[A],Y=P.high,$=P.low,F=Q+((m&gt;&gt;&gt;<span class="hljs-number">14</span>|b&lt;&lt;<span class="hljs-number">18</span>)^(m&gt;&gt;&gt;<span class="hljs-number">18</span>|b&lt;&lt;<span class="hljs-number">14</span>)^(m&lt;&lt;<span class="hljs-number">23</span>|b&gt;&gt;&gt;<span class="hljs-number">9</span>)),C=J+((b&gt;&gt;&gt;<span class="hljs-number">14</span>|m&lt;&lt;<span class="hljs-number">18</span>)^(b&gt;&gt;&gt;<span class="hljs-number">18</span>|m&lt;&lt;<span class="hljs-number">14</span>)^(b&lt;&lt;<span class="hljs-number">23</span>|m&gt;&gt;&gt;<span class="hljs-number">9</span>))+(F&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;Q&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),t1=M+(g&amp;B^g&amp;k^B&amp;k),J=V,Q=G,V=Z,G=S,Z=b,S=m,b=q+(C=C+R+((F=F+D)&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;D&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)+Y+((F=F+$)&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;$&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)+H+((F=F+z)&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;z&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>))+((m=x+F|<span class="hljs-number">0</span>)&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;x&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,q=w,x=k,w=v,k=B,v=y,B=g,y=C+(((y&gt;&gt;&gt;<span class="hljs-number">28</span>|g&lt;&lt;<span class="hljs-number">4</span>)^(y&lt;&lt;<span class="hljs-number">30</span>|g&gt;&gt;&gt;<span class="hljs-number">2</span>)^(y&lt;&lt;<span class="hljs-number">25</span>|g&gt;&gt;&gt;<span class="hljs-number">7</span>))+E+(t1&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;M&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>))+((g=F+t1|<span class="hljs-number">0</span>)&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;F&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>;<span class="hljs-selector-tag">a</span>=e<span class="hljs-selector-class">.low</span>=<span class="hljs-selector-tag">a</span>+g,e<span class="hljs-selector-class">.high</span>=<span class="hljs-selector-tag">I</span>+y+(<span class="hljs-selector-tag">a</span>&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;g&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),h=r.low=h+B,r.high=U+v+(h&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;B&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),l=i.low=l+k,i.high=K+w+(l&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;k&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),f=o.low=f+x,o.high=X+q+(f&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;x&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),d=n.low=d+m,n.high=L+b+(d&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;m&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),u=s.low=u+S,s.high=j+Z+(u&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;S&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),p=c.low=p+G,c.high=T+V+(p&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;G&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>),_=t.low=_+Q,t.high=N+J+(_&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;Q&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)},_doFinalize:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=this._data,e=t<span class="hljs-selector-class">.words</span>,r=<span class="hljs-number">8</span>*this._nDataBytes,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">8</span>*t<span class="hljs-selector-class">.sigBytes</span>;return e<span class="hljs-selector-attr">[i&gt;&gt;&gt;5]</span>|=<span class="hljs-number">128</span>&lt;&lt;<span class="hljs-number">24</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">32</span>,e<span class="hljs-selector-attr">[30+(128+i&gt;&gt;&gt;10&lt;&lt;5)]</span>=Math<span class="hljs-selector-class">.floor</span>(r/<span class="hljs-number">4294967296</span>),e<span class="hljs-selector-attr">[31+(128+i&gt;&gt;&gt;10&lt;&lt;5)]</span>=r,t<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-number">4</span>*e<span class="hljs-selector-class">.length</span>,this._process(),this._hash<span class="hljs-selector-class">.toX32</span>()},clone:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=<span class="hljs-selector-tag">H1</span><span class="hljs-selector-class">.clone</span><span class="hljs-selector-class">.call</span>(this);return t._hash=this._hash<span class="hljs-selector-class">.clone</span>(),t},blockSize:<span class="hljs-number">32</span>}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.SHA512</span>=<span class="hljs-selector-tag">H1</span>._createHelper(u),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.HmacSHA512</span>=<span class="hljs-selector-tag">H1</span>._createHmacHelper(u),u=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.x64</span>,t=u<span class="hljs-selector-class">.Word</span>,N=u<span class="hljs-selector-class">.WordArray</span>,u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>,<span class="hljs-selector-tag">q</span>=u<span class="hljs-selector-class">.SHA512</span>,u=u<span class="hljs-selector-class">.SHA384</span>=<span class="hljs-selector-tag">q</span><span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){this._hash=new N<span class="hljs-selector-class">.init</span>(<span class="hljs-selector-attr">[new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)]</span>)},_doFinalize:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=<span class="hljs-selector-tag">q</span>._doFinalize<span class="hljs-selector-class">.call</span>(this);return t<span class="hljs-selector-class">.sigBytes-</span>=<span class="hljs-number">16</span>,t}}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.SHA384</span>=<span class="hljs-selector-tag">q</span>._createHelper(u),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.HmacSHA384</span>=<span class="hljs-selector-tag">q</span>._createHmacHelper(u);for(<span class="hljs-selector-tag">var</span> M1=Math,<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>,P1=(u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.lib</span>)<span class="hljs-selector-class">.WordArray</span>,F1=u<span class="hljs-selector-class">.Hasher</span>,W1=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.x64</span><span class="hljs-selector-class">.Word</span>,u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>,O1=<span class="hljs-selector-attr">[]</span>,I1=<span class="hljs-selector-attr">[]</span>,U1=<span class="hljs-selector-attr">[]</span>,v=<span class="hljs-number">1</span>,<span class="hljs-selector-tag">B</span>=<span class="hljs-number">0</span>,K1=<span class="hljs-number">0</span>;K1&lt;<span class="hljs-number">24</span>;K1++){O1<span class="hljs-selector-attr">[v+5*B]</span>=(K1+<span class="hljs-number">1</span>)*(K1+<span class="hljs-number">2</span>)/<span class="hljs-number">2%</span><span class="hljs-number">64</span>;<span class="hljs-selector-tag">var</span> X1=(<span class="hljs-number">2</span>*v+<span class="hljs-number">3</span>*<span class="hljs-selector-tag">B</span>)%<span class="hljs-number">5</span>;v=<span class="hljs-selector-tag">B</span>%<span class="hljs-number">5</span>,<span class="hljs-selector-tag">B</span>=X1}for(v=<span class="hljs-number">0</span>;v&lt;<span class="hljs-number">5</span>;v++)for(<span class="hljs-selector-tag">B</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">B</span>&lt;<span class="hljs-number">5</span>;<span class="hljs-selector-tag">B</span>++)I1<span class="hljs-selector-attr">[v+5*B]</span>=<span class="hljs-selector-tag">B</span>+(<span class="hljs-number">2</span>*v+<span class="hljs-number">3</span>*<span class="hljs-selector-tag">B</span>)%<span class="hljs-number">5</span>*<span class="hljs-number">5</span>;for(<span class="hljs-selector-tag">var</span> L1=<span class="hljs-number">1</span>,j1=<span class="hljs-number">0</span>;j1&lt;<span class="hljs-number">24</span>;j1++){for(<span class="hljs-selector-tag">var</span> T1,N1=<span class="hljs-number">0</span>,q1=<span class="hljs-number">0</span>,Z1=<span class="hljs-number">0</span>;Z1&lt;<span class="hljs-number">7</span>;Z1++)<span class="hljs-number">1</span>&amp;L1&amp;&amp;((T1=(<span class="hljs-number">1</span>&lt;&lt;Z1)-<span class="hljs-number">1</span>)&lt;<span class="hljs-number">32</span>?q1^=<span class="hljs-number">1</span>&lt;&lt;T1:N1^=<span class="hljs-number">1</span>&lt;&lt;T1-<span class="hljs-number">32</span>),<span class="hljs-number">128</span>&amp;L1?L1=L1&lt;&lt;<span class="hljs-number">1</span>^<span class="hljs-number">113</span>:L1&lt;&lt;=<span class="hljs-number">1</span>;U1<span class="hljs-selector-attr">[j1]</span>=W1<span class="hljs-selector-class">.create</span>(N1,q1)}for(<span class="hljs-selector-tag">var</span> D=<span class="hljs-selector-attr">[]</span>,V1=<span class="hljs-number">0</span>;V1&lt;<span class="hljs-number">25</span>;V1++)D<span class="hljs-selector-attr">[V1]</span>=W1<span class="hljs-selector-class">.create</span>();function G1(t,e,r){return t&amp;e|~t&amp;r}function J1(t,e,r){return t&amp;r|e&amp;~r}function Q1(t,e){return t&lt;&lt;e|t&gt;&gt;&gt;<span class="hljs-number">32</span>-e}function Y1(t){return"string"==typeof t?f1:o}function $<span class="hljs-number">1</span>(t,e,r){<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>,o=this._iv;o?(<span class="hljs-selector-tag">i</span>=o,this._iv=void <span class="hljs-number">0</span>):i=this._prevBlock;for(<span class="hljs-selector-tag">var</span> n=<span class="hljs-number">0</span>;n&lt;r;n++)t<span class="hljs-selector-attr">[e+n]</span>^=<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[n]</span>}function t2(t,e,r,<span class="hljs-selector-tag">i</span>){<span class="hljs-selector-tag">var</span> o,n=this._iv;n?(o=n<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>),this._iv=void <span class="hljs-number">0</span>):o=this._prevBlock,i.<span class="hljs-built_in">encryptBlock</span>(o,<span class="hljs-number">0</span>);for(<span class="hljs-selector-tag">var</span> s=<span class="hljs-number">0</span>;s&lt;r;s++)t<span class="hljs-selector-attr">[e+s]</span>^=o<span class="hljs-selector-attr">[s]</span>}function e2(t){<span class="hljs-selector-tag">var</span> e,r,<span class="hljs-selector-tag">i</span>;return <span class="hljs-number">255</span>==(t&gt;&gt;<span class="hljs-number">24</span>&amp;<span class="hljs-number">255</span>)?(r=t&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">255</span>&amp;t,<span class="hljs-number">255</span>===(e=t&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>)?(e=<span class="hljs-number">0</span>,<span class="hljs-number">255</span>===r?(r=<span class="hljs-number">0</span>,<span class="hljs-number">255</span>===<span class="hljs-selector-tag">i</span>?<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>:++i):++r):++e,t=<span class="hljs-number">0</span>,t=(t+=e&lt;&lt;<span class="hljs-number">16</span>)+(r&lt;&lt;<span class="hljs-number">8</span>)+i):t+=<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">24</span>,t}u=u<span class="hljs-selector-class">.SHA3</span>=F1<span class="hljs-selector-class">.extend</span>({cfg:F1.cfg.<span class="hljs-built_in">extend</span>({outputLength:<span class="hljs-number">512</span>}),_doReset:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=this._state=<span class="hljs-selector-attr">[]</span>,e=<span class="hljs-number">0</span>;e&lt;<span class="hljs-number">25</span>;e++)t<span class="hljs-selector-attr">[e]</span>=new W1<span class="hljs-selector-class">.init</span>;this<span class="hljs-selector-class">.blockSize</span>=(<span class="hljs-number">1600</span>-<span class="hljs-number">2</span>*this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.outputLength</span>)/<span class="hljs-number">32</span>},_doProcessBlock:<span class="hljs-built_in">function</span>(t,e){for(<span class="hljs-selector-tag">var</span> r=this._state,<span class="hljs-selector-tag">i</span>=this<span class="hljs-selector-class">.blockSize</span>/<span class="hljs-number">2</span>,o=<span class="hljs-number">0</span>;o&lt;<span class="hljs-selector-tag">i</span>;o++){<span class="hljs-selector-tag">var</span> n=t<span class="hljs-selector-attr">[e+2*o]</span>,s=t<span class="hljs-selector-attr">[e+2*o+1]</span>,n=<span class="hljs-number">16711935</span>&amp;(n&lt;&lt;<span class="hljs-number">8</span>|n&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(n&lt;&lt;<span class="hljs-number">24</span>|n&gt;&gt;&gt;<span class="hljs-number">8</span>);(x=r<span class="hljs-selector-attr">[o]</span>)<span class="hljs-selector-class">.high</span>^=<span class="hljs-number">16711935</span>&amp;(s&lt;&lt;<span class="hljs-number">8</span>|s&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(s&lt;&lt;<span class="hljs-number">24</span>|s&gt;&gt;&gt;<span class="hljs-number">8</span>),x<span class="hljs-selector-class">.low</span>^=n}for(<span class="hljs-selector-tag">var</span> c=<span class="hljs-number">0</span>;c&lt;<span class="hljs-number">24</span>;c++){for(<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">a</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">a</span>&lt;<span class="hljs-number">5</span>;<span class="hljs-selector-tag">a</span>++){for(<span class="hljs-selector-tag">var</span> h=<span class="hljs-number">0</span>,l=<span class="hljs-number">0</span>,f=<span class="hljs-number">0</span>;f&lt;<span class="hljs-number">5</span>;f++)h^=(x=r<span class="hljs-selector-attr">[a+5*f]</span>)<span class="hljs-selector-class">.high</span>,l^=x<span class="hljs-selector-class">.low</span>;<span class="hljs-selector-tag">var</span> d=D<span class="hljs-selector-attr">[a]</span>;d<span class="hljs-selector-class">.high</span>=h,d<span class="hljs-selector-class">.low</span>=l}for(<span class="hljs-selector-tag">a</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">a</span>&lt;<span class="hljs-number">5</span>;<span class="hljs-selector-tag">a</span>++)for(<span class="hljs-selector-tag">var</span> u=D<span class="hljs-selector-attr">[(a+4)%5]</span>,<span class="hljs-selector-tag">p</span>=D<span class="hljs-selector-attr">[(a+1)%5]</span>,_=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.high</span>,<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.low</span>,h=u<span class="hljs-selector-class">.high</span>^(_&lt;&lt;<span class="hljs-number">1</span>|<span class="hljs-selector-tag">p</span>&gt;&gt;&gt;<span class="hljs-number">31</span>),l=u<span class="hljs-selector-class">.low</span>^(<span class="hljs-selector-tag">p</span>&lt;&lt;<span class="hljs-number">1</span>|_&gt;&gt;&gt;<span class="hljs-number">31</span>),f=<span class="hljs-number">0</span>;f&lt;<span class="hljs-number">5</span>;f++)(x=r<span class="hljs-selector-attr">[a+5*f]</span>)<span class="hljs-selector-class">.high</span>^=h,x<span class="hljs-selector-class">.low</span>^=l;for(<span class="hljs-selector-tag">var</span> y=<span class="hljs-number">1</span>;y&lt;<span class="hljs-number">25</span>;y++){<span class="hljs-selector-tag">var</span> g=(x=r<span class="hljs-selector-attr">[y]</span>)<span class="hljs-selector-class">.high</span>,v=x<span class="hljs-selector-class">.low</span>,<span class="hljs-selector-tag">B</span>=O1<span class="hljs-selector-attr">[y]</span>,g=(l=<span class="hljs-selector-tag">B</span>&lt;<span class="hljs-number">32</span>?(h=g&lt;&lt;<span class="hljs-selector-tag">B</span>|v&gt;&gt;&gt;<span class="hljs-number">32</span>-<span class="hljs-selector-tag">B</span>,v&lt;&lt;<span class="hljs-selector-tag">B</span>|g&gt;&gt;&gt;<span class="hljs-number">32</span>-<span class="hljs-selector-tag">B</span>):(h=v&lt;&lt;B-<span class="hljs-number">32</span>|g&gt;&gt;&gt;<span class="hljs-number">64</span>-B,g&lt;&lt;B-<span class="hljs-number">32</span>|v&gt;&gt;&gt;<span class="hljs-number">64</span>-B),D[I1[y]]);g<span class="hljs-selector-class">.high</span>=h,g<span class="hljs-selector-class">.low</span>=l}<span class="hljs-selector-tag">var</span> w=D<span class="hljs-selector-attr">[0]</span>,k=r<span class="hljs-selector-attr">[0]</span>;w<span class="hljs-selector-class">.high</span>=k<span class="hljs-selector-class">.high</span>,w<span class="hljs-selector-class">.low</span>=k<span class="hljs-selector-class">.low</span>;for(<span class="hljs-selector-tag">a</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">a</span>&lt;<span class="hljs-number">5</span>;<span class="hljs-selector-tag">a</span>++)for(f=<span class="hljs-number">0</span>;f&lt;<span class="hljs-number">5</span>;f++){<span class="hljs-selector-tag">var</span> x=r<span class="hljs-selector-attr">[y=a+5*f]</span>,<span class="hljs-selector-tag">b</span>=D<span class="hljs-selector-attr">[y]</span>,m=D<span class="hljs-selector-attr">[(a+1)%5+5*f]</span>,S=D<span class="hljs-selector-attr">[(a+2)%5+5*f]</span>;x<span class="hljs-selector-class">.high</span>=<span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.high</span>^~m<span class="hljs-selector-class">.high</span>&amp;S<span class="hljs-selector-class">.high</span>,x<span class="hljs-selector-class">.low</span>=<span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.low</span>^~m<span class="hljs-selector-class">.low</span>&amp;S<span class="hljs-selector-class">.low</span>}x=r<span class="hljs-selector-attr">[0]</span>,w=U1<span class="hljs-selector-attr">[c]</span>;x<span class="hljs-selector-class">.high</span>^=w<span class="hljs-selector-class">.high</span>,x<span class="hljs-selector-class">.low</span>^=w<span class="hljs-selector-class">.low</span>}},_doFinalize:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=this._data,e=t<span class="hljs-selector-class">.words</span>,r=(this._nDataBytes,<span class="hljs-number">8</span>*t<span class="hljs-selector-class">.sigBytes</span>),<span class="hljs-selector-tag">i</span>=<span class="hljs-number">32</span>*this<span class="hljs-selector-class">.blockSize</span>,o=(e<span class="hljs-selector-attr">[r&gt;&gt;&gt;5]</span>|=<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">24</span>-r%<span class="hljs-number">32</span>,e<span class="hljs-selector-attr">[(M1.ceil((1+r)/i)*i&gt;&gt;&gt;5)-1]</span>|=<span class="hljs-number">128</span>,t<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-number">4</span>*e<span class="hljs-selector-class">.length</span>,this._process(),this._state),r=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.outputLength</span>/<span class="hljs-number">8</span>,n=r/<span class="hljs-number">8</span>,s=<span class="hljs-selector-attr">[]</span>,c=<span class="hljs-number">0</span>;c&lt;n;c++){<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">a</span>=o<span class="hljs-selector-attr">[c]</span>,h=<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.high</span>,<span class="hljs-selector-tag">a</span>=<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.low</span>,h=<span class="hljs-number">16711935</span>&amp;(h&lt;&lt;<span class="hljs-number">8</span>|h&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(h&lt;&lt;<span class="hljs-number">24</span>|h&gt;&gt;&gt;<span class="hljs-number">8</span>);s<span class="hljs-selector-class">.push</span>(<span class="hljs-number">16711935</span>&amp;(<span class="hljs-selector-tag">a</span>&lt;&lt;<span class="hljs-number">8</span>|<span class="hljs-selector-tag">a</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(<span class="hljs-selector-tag">a</span>&lt;&lt;<span class="hljs-number">24</span>|<span class="hljs-selector-tag">a</span>&gt;&gt;&gt;<span class="hljs-number">8</span>)),s<span class="hljs-selector-class">.push</span>(h)}return new P1<span class="hljs-selector-class">.init</span>(s,r)},clone:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=F1<span class="hljs-selector-class">.clone</span><span class="hljs-selector-class">.call</span>(this),e=t._state=this._state<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>),r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">25</span>;r++)e<span class="hljs-selector-attr">[r]</span>=e<span class="hljs-selector-attr">[r]</span><span class="hljs-selector-class">.clone</span>();return t}}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.SHA3</span>=F1._createHelper(u),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.HmacSHA3</span>=F1._createHmacHelper(u),Math,u=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span>,e=u<span class="hljs-selector-class">.WordArray</span>,Z=u<span class="hljs-selector-class">.Hasher</span>,u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>,V=e<span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]</span>),G=e<span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]</span>),J=e<span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]</span>),<span class="hljs-selector-tag">Q</span>=e<span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]</span>),Y=e<span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[0,1518500249,1859775393,2400959708,2840853838]</span>),$=e<span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[1352829926,1548603684,1836072691,2053994217,0]</span>),u=u<span class="hljs-selector-class">.RIPEMD160</span>=Z<span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){this._hash=e<span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[1732584193,4023233417,2562383102,271733878,3285377520]</span>)},_doProcessBlock:<span class="hljs-built_in">function</span>(t,e){for(<span class="hljs-selector-tag">var</span> r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">16</span>;r++){<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=e+r,o=t<span class="hljs-selector-attr">[i]</span>;t<span class="hljs-selector-attr">[i]</span>=<span class="hljs-number">16711935</span>&amp;(o&lt;&lt;<span class="hljs-number">8</span>|o&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(o&lt;&lt;<span class="hljs-number">24</span>|o&gt;&gt;&gt;<span class="hljs-number">8</span>)}for(<span class="hljs-selector-tag">var</span> n,s,c,<span class="hljs-selector-tag">a</span>,h,l,f=this._hash<span class="hljs-selector-class">.words</span>,d=Y<span class="hljs-selector-class">.words</span>,u=$<span class="hljs-selector-class">.words</span>,<span class="hljs-selector-tag">p</span>=V<span class="hljs-selector-class">.words</span>,_=G<span class="hljs-selector-class">.words</span>,y=J<span class="hljs-selector-class">.words</span>,g=<span class="hljs-selector-tag">Q</span><span class="hljs-selector-class">.words</span>,v=n=f<span class="hljs-selector-attr">[0]</span>,<span class="hljs-selector-tag">B</span>=s=f<span class="hljs-selector-attr">[1]</span>,w=c=f<span class="hljs-selector-attr">[2]</span>,k=<span class="hljs-selector-tag">a</span>=f<span class="hljs-selector-attr">[3]</span>,x=h=f<span class="hljs-selector-attr">[4]</span>,r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">80</span>;r+=<span class="hljs-number">1</span>)l=(l=Q1(l=(l=n+t<span class="hljs-selector-attr">[e+p[r]</span>]|<span class="hljs-number">0</span>)+(r&lt;<span class="hljs-number">16</span>?(s^c^<span class="hljs-selector-tag">a</span>)+d<span class="hljs-selector-attr">[0]</span>:r&lt;<span class="hljs-number">32</span>?<span class="hljs-built_in">G1</span>(s,c,a)+d[<span class="hljs-number">1</span>]:r&lt;<span class="hljs-number">48</span>?((s|~c)^a)+d[<span class="hljs-number">2</span>]:r&lt;<span class="hljs-number">64</span>?<span class="hljs-built_in">J1</span>(s,c,a)+d[<span class="hljs-number">3</span>]:(s^(c|~a))+d[<span class="hljs-number">4</span>])|<span class="hljs-number">0</span>,y[r]))+h|<span class="hljs-number">0</span>,n=h,h=a,a=<span class="hljs-built_in">Q1</span>(c,<span class="hljs-number">10</span>),c=s,s=l,l=(l=<span class="hljs-built_in">Q1</span>(l=(l=v+t[e+_[r]]|<span class="hljs-number">0</span>)+(r&lt;<span class="hljs-number">16</span>?(B^(w|~k))+u[<span class="hljs-number">0</span>]:r&lt;<span class="hljs-number">32</span>?<span class="hljs-built_in">J1</span>(B,w,k)+u[<span class="hljs-number">1</span>]:r&lt;<span class="hljs-number">48</span>?((B|~w)^k)+u[<span class="hljs-number">2</span>]:r&lt;<span class="hljs-number">64</span>?<span class="hljs-built_in">G1</span>(B,w,k)+u[<span class="hljs-number">3</span>]:(B^w^k)+u[<span class="hljs-number">4</span>])|<span class="hljs-number">0</span>,g[r]))+x|<span class="hljs-number">0</span>,v=x,x=k,k=<span class="hljs-built_in">Q1</span>(w,<span class="hljs-number">10</span>),w=B,B=l;l=f<span class="hljs-selector-attr">[1]</span>+c+k|<span class="hljs-number">0</span>,f<span class="hljs-selector-attr">[1]</span>=f<span class="hljs-selector-attr">[2]</span>+<span class="hljs-selector-tag">a</span>+x|<span class="hljs-number">0</span>,f<span class="hljs-selector-attr">[2]</span>=f<span class="hljs-selector-attr">[3]</span>+h+v|<span class="hljs-number">0</span>,f<span class="hljs-selector-attr">[3]</span>=f<span class="hljs-selector-attr">[4]</span>+n+<span class="hljs-selector-tag">B</span>|<span class="hljs-number">0</span>,f<span class="hljs-selector-attr">[4]</span>=f<span class="hljs-selector-attr">[0]</span>+s+w|<span class="hljs-number">0</span>,f<span class="hljs-selector-attr">[0]</span>=l},_doFinalize:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=this._data,e=t<span class="hljs-selector-class">.words</span>,r=<span class="hljs-number">8</span>*this._nDataBytes,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">8</span>*t<span class="hljs-selector-class">.sigBytes</span>,<span class="hljs-selector-tag">i</span>=(e<span class="hljs-selector-attr">[i&gt;&gt;&gt;5]</span>|=<span class="hljs-number">128</span>&lt;&lt;<span class="hljs-number">24</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">32</span>,e<span class="hljs-selector-attr">[14+(64+i&gt;&gt;&gt;9&lt;&lt;4)]</span>=<span class="hljs-number">16711935</span>&amp;(r&lt;&lt;<span class="hljs-number">8</span>|r&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(r&lt;&lt;<span class="hljs-number">24</span>|r&gt;&gt;&gt;<span class="hljs-number">8</span>),t<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-number">4</span>*(e<span class="hljs-selector-class">.length</span>+<span class="hljs-number">1</span>),this._process(),this._hash),o=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.words</span>,n=<span class="hljs-number">0</span>;n&lt;<span class="hljs-number">5</span>;n++){<span class="hljs-selector-tag">var</span> s=o<span class="hljs-selector-attr">[n]</span>;o<span class="hljs-selector-attr">[n]</span>=<span class="hljs-number">16711935</span>&amp;(s&lt;&lt;<span class="hljs-number">8</span>|s&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(s&lt;&lt;<span class="hljs-number">24</span>|s&gt;&gt;&gt;<span class="hljs-number">8</span>)}return <span class="hljs-selector-tag">i</span>},clone:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=Z<span class="hljs-selector-class">.clone</span><span class="hljs-selector-class">.call</span>(this);return t._hash=this._hash<span class="hljs-selector-class">.clone</span>(),t}}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.RIPEMD160</span>=Z._createHelper(u),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.HmacRIPEMD160</span>=Z._createHmacHelper(u),u=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.Base</span>,t1=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.enc</span><span class="hljs-selector-class">.Utf8</span>,<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span><span class="hljs-selector-class">.HMAC</span>=u<span class="hljs-selector-class">.extend</span>({init:<span class="hljs-built_in">function</span>(t,e){t=this._hasher=new t<span class="hljs-selector-class">.init</span>,"string"==typeof e&amp;&amp;(e=t1<span class="hljs-selector-class">.parse</span>(e));for(<span class="hljs-selector-tag">var</span> r=t<span class="hljs-selector-class">.blockSize</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">4</span>*r,t=((e=e<span class="hljs-selector-class">.sigBytes</span>&gt;<span class="hljs-selector-tag">i</span>?t<span class="hljs-selector-class">.finalize</span>(e):e).<span class="hljs-built_in">clamp</span>(),this._oKey=e.<span class="hljs-built_in">clone</span>()),e=this._iKey=e.<span class="hljs-built_in">clone</span>(),o=t.words,n=e.words,s=<span class="hljs-number">0</span>;s&lt;r;s++)o<span class="hljs-selector-attr">[s]</span>^=<span class="hljs-number">1549556828</span>,n<span class="hljs-selector-attr">[s]</span>^=<span class="hljs-number">909522486</span>;t<span class="hljs-selector-class">.sigBytes</span>=e<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-selector-tag">i</span>,this<span class="hljs-selector-class">.reset</span>()},reset:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=this._hasher;t<span class="hljs-selector-class">.reset</span>(),t<span class="hljs-selector-class">.update</span>(this._iKey)},update:<span class="hljs-built_in">function</span>(t){return this._hasher<span class="hljs-selector-class">.update</span>(t),this},finalize:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e=this._hasher,t=e<span class="hljs-selector-class">.finalize</span>(t);return e<span class="hljs-selector-class">.reset</span>(),e<span class="hljs-selector-class">.finalize</span>(this._oKey<span class="hljs-selector-class">.clone</span>()<span class="hljs-selector-class">.concat</span>(t))}}),u=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span>,w=u<span class="hljs-selector-class">.Base</span>,e1=u<span class="hljs-selector-class">.WordArray</span>,u=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>,<span class="hljs-selector-tag">P</span>=u<span class="hljs-selector-class">.SHA256</span>,r1=u<span class="hljs-selector-class">.HMAC</span>,i1=u<span class="hljs-selector-class">.PBKDF2</span>=w<span class="hljs-selector-class">.extend</span>({cfg:w.<span class="hljs-built_in">extend</span>({keySize:<span class="hljs-number">4</span>,hasher:P,iterations:<span class="hljs-number">25</span>e4}),init:<span class="hljs-built_in">function</span>(t){this<span class="hljs-selector-class">.cfg</span>=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.extend</span>(t)},compute:<span class="hljs-built_in">function</span>(t,e){for(<span class="hljs-selector-tag">var</span> r=this<span class="hljs-selector-class">.cfg</span>,<span class="hljs-selector-tag">i</span>=r1<span class="hljs-selector-class">.create</span>(r<span class="hljs-selector-class">.hasher</span>,t),o=e1<span class="hljs-selector-class">.create</span>(),n=e1<span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[1]</span>),s=o<span class="hljs-selector-class">.words</span>,c=n<span class="hljs-selector-class">.words</span>,<span class="hljs-selector-tag">a</span>=r<span class="hljs-selector-class">.keySize</span>,h=r<span class="hljs-selector-class">.iterations</span>;s<span class="hljs-selector-class">.length</span>&lt;<span class="hljs-selector-tag">a</span>;){for(<span class="hljs-selector-tag">var</span> l=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.update</span>(e)<span class="hljs-selector-class">.finalize</span>(n),f=(<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.reset</span>(),l<span class="hljs-selector-class">.words</span>),d=f<span class="hljs-selector-class">.length</span>,u=l,<span class="hljs-selector-tag">p</span>=<span class="hljs-number">1</span>;<span class="hljs-selector-tag">p</span>&lt;h;<span class="hljs-selector-tag">p</span>++){u=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.finalize</span>(u),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.reset</span>();for(<span class="hljs-selector-tag">var</span> _=u<span class="hljs-selector-class">.words</span>,y=<span class="hljs-number">0</span>;y&lt;d;y++)f<span class="hljs-selector-attr">[y]</span>^=_<span class="hljs-selector-attr">[y]</span>}o<span class="hljs-selector-class">.concat</span>(l),c<span class="hljs-selector-attr">[0]</span>++}return o<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-number">4</span>*<span class="hljs-selector-tag">a</span>,o}}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.PBKDF2</span>=function(t,e,r){return i1<span class="hljs-selector-class">.create</span>(r)<span class="hljs-selector-class">.compute</span>(t,e)},w=(u=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span>,<span class="hljs-selector-tag">P</span>=w<span class="hljs-selector-class">.Base</span>,o1=w<span class="hljs-selector-class">.WordArray</span>,w=u<span class="hljs-selector-class">.algo</span>,<span class="hljs-selector-tag">p</span>=w<span class="hljs-selector-class">.MD5</span>,n1=w<span class="hljs-selector-class">.EvpKDF</span>=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.extend</span>({cfg:P.<span class="hljs-built_in">extend</span>({keySize:<span class="hljs-number">4</span>,hasher:p,iterations:<span class="hljs-number">1</span>}),init:<span class="hljs-built_in">function</span>(t){this<span class="hljs-selector-class">.cfg</span>=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.extend</span>(t)},compute:<span class="hljs-built_in">function</span>(t,e){for(<span class="hljs-selector-tag">var</span> r,<span class="hljs-selector-tag">i</span>=this<span class="hljs-selector-class">.cfg</span>,o=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.hasher</span><span class="hljs-selector-class">.create</span>(),n=o1<span class="hljs-selector-class">.create</span>(),s=n<span class="hljs-selector-class">.words</span>,c=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.keySize</span>,<span class="hljs-selector-tag">a</span>=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.iterations</span>;s<span class="hljs-selector-class">.length</span>&lt;c;){r&amp;&amp;o<span class="hljs-selector-class">.update</span>(r),r=o<span class="hljs-selector-class">.update</span>(t)<span class="hljs-selector-class">.finalize</span>(e),o<span class="hljs-selector-class">.reset</span>();for(<span class="hljs-selector-tag">var</span> h=<span class="hljs-number">1</span>;h&lt;<span class="hljs-selector-tag">a</span>;h++)r=o<span class="hljs-selector-class">.finalize</span>(r),o<span class="hljs-selector-class">.reset</span>();n<span class="hljs-selector-class">.concat</span>(r)}return n<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-number">4</span>*c,n}}),u<span class="hljs-selector-class">.EvpKDF</span>=function(t,e,r){return n1<span class="hljs-selector-class">.create</span>(r)<span class="hljs-selector-class">.compute</span>(t,e)},<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.Cipher</span>||(<span class="hljs-selector-tag">P</span>=(w=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span>,<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.Base</span>,s=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.WordArray</span>,s1=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.BufferedBlockAlgorithm</span>,(u=w<span class="hljs-selector-class">.enc</span>)<span class="hljs-selector-class">.Utf8</span>,c1=u<span class="hljs-selector-class">.Base64</span>,a1=w<span class="hljs-selector-class">.algo</span><span class="hljs-selector-class">.EvpKDF</span>,<span class="hljs-selector-tag">h1</span>=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.Cipher</span>=s1<span class="hljs-selector-class">.extend</span>({cfg:p.<span class="hljs-built_in">extend</span>(),createEncryptor:<span class="hljs-built_in">function</span>(t,e){return this<span class="hljs-selector-class">.create</span>(this._ENC_XFORM_MODE,t,e)},createDecryptor:<span class="hljs-built_in">function</span>(t,e){return this<span class="hljs-selector-class">.create</span>(this._DEC_XFORM_MODE,t,e)},init:<span class="hljs-built_in">function</span>(t,e,r){this<span class="hljs-selector-class">.cfg</span>=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.extend</span>(r),this._xformMode=t,this._key=e,this<span class="hljs-selector-class">.reset</span>()},reset:<span class="hljs-built_in">function</span>(){s1<span class="hljs-selector-class">.reset</span><span class="hljs-selector-class">.call</span>(this),this._doReset()},process:<span class="hljs-built_in">function</span>(t){return this._append(t),this._process()},finalize:<span class="hljs-built_in">function</span>(t){return t&amp;&amp;this._append(t),this._doFinalize()},keySize:<span class="hljs-number">4</span>,ivSize:<span class="hljs-number">4</span>,_ENC_XFORM_MODE:<span class="hljs-number">1</span>,_DEC_XFORM_MODE:<span class="hljs-number">2</span>,_createHelper:<span class="hljs-built_in">function</span>(i){return{encrypt:<span class="hljs-built_in">function</span>(t,e,r){return Y1(e)<span class="hljs-selector-class">.encrypt</span>(<span class="hljs-selector-tag">i</span>,t,e,r)},decrypt:<span class="hljs-built_in">function</span>(t,e,r){return Y1(e)<span class="hljs-selector-class">.decrypt</span>(<span class="hljs-selector-tag">i</span>,t,e,r)}}}}),<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.StreamCipher</span>=<span class="hljs-selector-tag">h1</span><span class="hljs-selector-class">.extend</span>({_doFinalize:<span class="hljs-built_in">function</span>(){return this._process(!<span class="hljs-number">0</span>)},blockSize:<span class="hljs-number">1</span>}),u=w<span class="hljs-selector-class">.mode</span>={},r=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.BlockCipherMode</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.extend</span>({createEncryptor:<span class="hljs-built_in">function</span>(t,e){return this<span class="hljs-selector-class">.Encryptor</span><span class="hljs-selector-class">.create</span>(t,e)},createDecryptor:<span class="hljs-built_in">function</span>(t,e){return this<span class="hljs-selector-class">.Decryptor</span><span class="hljs-selector-class">.create</span>(t,e)},init:<span class="hljs-built_in">function</span>(t,e){this._cipher=t,this._iv=e}}),r=u<span class="hljs-selector-class">.CBC</span>=((u=r<span class="hljs-selector-class">.extend</span>())<span class="hljs-selector-class">.Encryptor</span>=u<span class="hljs-selector-class">.extend</span>({processBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=this._cipher,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-class">.blockSize</span>;$<span class="hljs-number">1</span><span class="hljs-selector-class">.call</span>(this,t,e,<span class="hljs-selector-tag">i</span>),r<span class="hljs-selector-class">.encryptBlock</span>(t,e),this._prevBlock=t<span class="hljs-selector-class">.slice</span>(e,e+<span class="hljs-selector-tag">i</span>)}}),u<span class="hljs-selector-class">.Decryptor</span>=u<span class="hljs-selector-class">.extend</span>({processBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=this._cipher,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-class">.blockSize</span>,o=t<span class="hljs-selector-class">.slice</span>(e,e+<span class="hljs-selector-tag">i</span>);r<span class="hljs-selector-class">.decryptBlock</span>(t,e),$<span class="hljs-number">1</span><span class="hljs-selector-class">.call</span>(this,t,e,<span class="hljs-selector-tag">i</span>),this._prevBlock=o}}),u),u=(w<span class="hljs-selector-class">.pad</span>={})<span class="hljs-selector-class">.Pkcs7</span>={pad:<span class="hljs-built_in">function</span>(t,e){for(<span class="hljs-selector-tag">var</span> e=<span class="hljs-number">4</span>*e,r=e-t<span class="hljs-selector-class">.sigBytes</span>%e,<span class="hljs-selector-tag">i</span>=r&lt;&lt;<span class="hljs-number">24</span>|r&lt;&lt;<span class="hljs-number">16</span>|r&lt;&lt;<span class="hljs-number">8</span>|r,o=<span class="hljs-selector-attr">[]</span>,n=<span class="hljs-number">0</span>;n&lt;r;n+=<span class="hljs-number">4</span>)o<span class="hljs-selector-class">.push</span>(<span class="hljs-selector-tag">i</span>);e=s<span class="hljs-selector-class">.create</span>(o,r);t<span class="hljs-selector-class">.concat</span>(e)},unpad:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e=<span class="hljs-number">255</span>&amp;t<span class="hljs-selector-class">.words</span><span class="hljs-selector-attr">[t.sigBytes-1&gt;&gt;&gt;2]</span>;t<span class="hljs-selector-class">.sigBytes-</span>=e}},<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.BlockCipher</span>=<span class="hljs-selector-tag">h1</span><span class="hljs-selector-class">.extend</span>({cfg:h1.cfg.<span class="hljs-built_in">extend</span>({mode:r,padding:u}),reset:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">h1</span><span class="hljs-selector-class">.reset</span><span class="hljs-selector-class">.call</span>(this);<span class="hljs-selector-tag">var</span> t,e=this<span class="hljs-selector-class">.cfg</span>,r=e<span class="hljs-selector-class">.iv</span>,e=e<span class="hljs-selector-class">.mode</span>;this._xformMode==this._ENC_XFORM_MODE?t=e<span class="hljs-selector-class">.createEncryptor</span>:(t=e.createDecryptor,this._minBufferSize=<span class="hljs-number">1</span>),this._mode&amp;&amp;this._mode.__creator==t?this._mode.<span class="hljs-built_in">init</span>(this,r&amp;&amp;r.words):(this._mode=t.<span class="hljs-built_in">call</span>(e,this,r&amp;&amp;r.words),this._mode.__creator=t)},_doProcessBlock:<span class="hljs-built_in">function</span>(t,e){this._mode<span class="hljs-selector-class">.processBlock</span>(t,e)},_doFinalize:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t,e=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.padding</span>;return this._xformMode==this._ENC_XFORM_MODE?(e<span class="hljs-selector-class">.pad</span>(this._data,this<span class="hljs-selector-class">.blockSize</span>),t=this._process(!<span class="hljs-number">0</span>)):(t=this.<span class="hljs-built_in">_process</span>(!<span class="hljs-number">0</span>),e.<span class="hljs-built_in">unpad</span>(t)),t},blockSize:<span class="hljs-number">4</span>}),l1=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.CipherParams</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.extend</span>({init:<span class="hljs-built_in">function</span>(t){this<span class="hljs-selector-class">.mixIn</span>(t)},toString:<span class="hljs-built_in">function</span>(t){return(t||this<span class="hljs-selector-class">.formatter</span>)<span class="hljs-selector-class">.stringify</span>(this)}}),r=(w<span class="hljs-selector-class">.format</span>={})<span class="hljs-selector-class">.OpenSSL</span>={stringify:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.ciphertext</span>,t=t<span class="hljs-selector-class">.salt</span>,t=t?s<span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[1398893684,1701076831]</span>)<span class="hljs-selector-class">.concat</span>(t)<span class="hljs-selector-class">.concat</span>(e):e;return t<span class="hljs-selector-class">.toString</span>(c1)},parse:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e,t=c1<span class="hljs-selector-class">.parse</span>(t),r=t<span class="hljs-selector-class">.words</span>;return <span class="hljs-number">1398893684</span>==r<span class="hljs-selector-attr">[0]</span>&amp;&amp;<span class="hljs-number">1701076831</span>==r<span class="hljs-selector-attr">[1]</span>&amp;&amp;(e=s<span class="hljs-selector-class">.create</span>(r<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">2</span>,<span class="hljs-number">4</span>)),r<span class="hljs-selector-class">.splice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>),t<span class="hljs-selector-class">.sigBytes-</span>=<span class="hljs-number">16</span>),l1<span class="hljs-selector-class">.create</span>({ciphertext:t,salt:e})}},o=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.SerializableCipher</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.extend</span>({cfg:p.<span class="hljs-built_in">extend</span>({format:r}),encrypt:<span class="hljs-built_in">function</span>(t,e,r,i){<span class="hljs-selector-tag">i</span>=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.extend</span>(<span class="hljs-selector-tag">i</span>);<span class="hljs-selector-tag">var</span> o=t<span class="hljs-selector-class">.createEncryptor</span>(r,<span class="hljs-selector-tag">i</span>),e=o<span class="hljs-selector-class">.finalize</span>(e),o=o<span class="hljs-selector-class">.cfg</span>;return l1<span class="hljs-selector-class">.create</span>({ciphertext:e,key:r,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:<span class="hljs-built_in">function</span>(t,e,r,i){return <span class="hljs-selector-tag">i</span>=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.extend</span>(<span class="hljs-selector-tag">i</span>),e=this._parse(e,<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.format</span>),t<span class="hljs-selector-class">.createDecryptor</span>(r,<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.finalize</span>(e<span class="hljs-selector-class">.ciphertext</span>)},_parse:<span class="hljs-built_in">function</span>(t,e){return"string"==typeof t?e<span class="hljs-selector-class">.parse</span>(t,this):t}}),u=(w<span class="hljs-selector-class">.kdf</span>={})<span class="hljs-selector-class">.OpenSSL</span>={execute:<span class="hljs-built_in">function</span>(t,e,r,i,o){<span class="hljs-selector-tag">i</span>=<span class="hljs-selector-tag">i</span>||s<span class="hljs-selector-class">.random</span>(<span class="hljs-number">8</span>),o=(o?a1<span class="hljs-selector-class">.create</span>({keySize:e+r,hasher:o}):a1.<span class="hljs-built_in">create</span>({keySize:e+r}))<span class="hljs-selector-class">.compute</span>(t,<span class="hljs-selector-tag">i</span>);t=s<span class="hljs-selector-class">.create</span>(o<span class="hljs-selector-class">.words</span><span class="hljs-selector-class">.slice</span>(e),<span class="hljs-number">4</span>*r);return o<span class="hljs-selector-class">.sigBytes</span>=<span class="hljs-number">4</span>*e,l1<span class="hljs-selector-class">.create</span>({key:o,iv:t,salt:i})}},f1=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.PasswordBasedCipher</span>=o<span class="hljs-selector-class">.extend</span>({cfg:o.cfg.<span class="hljs-built_in">extend</span>({kdf:u}),encrypt:<span class="hljs-built_in">function</span>(t,e,r,i){r=(<span class="hljs-selector-tag">i</span>=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.extend</span>(<span class="hljs-selector-tag">i</span>))<span class="hljs-selector-class">.kdf</span><span class="hljs-selector-class">.execute</span>(r,t<span class="hljs-selector-class">.keySize</span>,t<span class="hljs-selector-class">.ivSize</span>,<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.salt</span>,<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.hasher</span>),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.iv</span>=r<span class="hljs-selector-class">.iv</span>,t=o<span class="hljs-selector-class">.encrypt</span><span class="hljs-selector-class">.call</span>(this,t,e,r<span class="hljs-selector-class">.key</span>,<span class="hljs-selector-tag">i</span>);return t<span class="hljs-selector-class">.mixIn</span>(r),t},decrypt:<span class="hljs-built_in">function</span>(t,e,r,i){<span class="hljs-selector-tag">i</span>=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.extend</span>(<span class="hljs-selector-tag">i</span>),e=this._parse(e,<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.format</span>);r=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.kdf</span><span class="hljs-selector-class">.execute</span>(r,t<span class="hljs-selector-class">.keySize</span>,t<span class="hljs-selector-class">.ivSize</span>,e<span class="hljs-selector-class">.salt</span>,<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.hasher</span>);return <span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.iv</span>=r<span class="hljs-selector-class">.iv</span>,o<span class="hljs-selector-class">.decrypt</span><span class="hljs-selector-class">.call</span>(this,t,e,r<span class="hljs-selector-class">.key</span>,<span class="hljs-selector-tag">i</span>)}})),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.mode</span><span class="hljs-selector-class">.CFB</span>=((<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.BlockCipherMode</span><span class="hljs-selector-class">.extend</span>())<span class="hljs-selector-class">.Encryptor</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.extend</span>({processBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=this._cipher,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-class">.blockSize</span>;t2<span class="hljs-selector-class">.call</span>(this,t,e,<span class="hljs-selector-tag">i</span>,r),this._prevBlock=t<span class="hljs-selector-class">.slice</span>(e,e+<span class="hljs-selector-tag">i</span>)}}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.Decryptor</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.extend</span>({processBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=this._cipher,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-class">.blockSize</span>,o=t<span class="hljs-selector-class">.slice</span>(e,e+<span class="hljs-selector-tag">i</span>);t2<span class="hljs-selector-class">.call</span>(this,t,e,<span class="hljs-selector-tag">i</span>,r),this._prevBlock=o}}),<span class="hljs-selector-tag">p</span>),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.mode</span><span class="hljs-selector-class">.CTR</span>=(r=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.BlockCipherMode</span><span class="hljs-selector-class">.extend</span>(),w=r<span class="hljs-selector-class">.Encryptor</span>=r<span class="hljs-selector-class">.extend</span>({processBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=this._cipher,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-class">.blockSize</span>,o=this._iv,n=this._counter,s=(o&amp;&amp;(n=this._counter=o<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>),this._iv=void <span class="hljs-number">0</span>),n<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>));r<span class="hljs-selector-class">.encryptBlock</span>(s,<span class="hljs-number">0</span>),n<span class="hljs-selector-attr">[i-1]</span>=n<span class="hljs-selector-attr">[i-1]</span>+<span class="hljs-number">1</span>|<span class="hljs-number">0</span>;for(<span class="hljs-selector-tag">var</span> c=<span class="hljs-number">0</span>;c&lt;<span class="hljs-selector-tag">i</span>;c++)t<span class="hljs-selector-attr">[e+c]</span>^=s<span class="hljs-selector-attr">[c]</span>}}),r<span class="hljs-selector-class">.Decryptor</span>=w,r),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.mode</span><span class="hljs-selector-class">.CTRGladman</span>=(<span class="hljs-selector-tag">P</span>=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.BlockCipherMode</span><span class="hljs-selector-class">.extend</span>(),u=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.Encryptor</span>=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.extend</span>({processBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=this._cipher,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-class">.blockSize</span>,o=this._iv,n=this._counter,s=(o&amp;&amp;(n=this._counter=o<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>),this._iv=void <span class="hljs-number">0</span>),<span class="hljs-number">0</span>===((o=n)<span class="hljs-selector-attr">[0]</span>=e2(o<span class="hljs-selector-attr">[0]</span>))&amp;&amp;(o<span class="hljs-selector-attr">[1]</span>=e2(o<span class="hljs-selector-attr">[1]</span>)),n<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>));r<span class="hljs-selector-class">.encryptBlock</span>(s,<span class="hljs-number">0</span>);for(<span class="hljs-selector-tag">var</span> c=<span class="hljs-number">0</span>;c&lt;<span class="hljs-selector-tag">i</span>;c++)t<span class="hljs-selector-attr">[e+c]</span>^=s<span class="hljs-selector-attr">[c]</span>}}),<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.Decryptor</span>=u,<span class="hljs-selector-tag">P</span>),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.mode</span><span class="hljs-selector-class">.OFB</span>=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.BlockCipherMode</span><span class="hljs-selector-class">.extend</span>(),w=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.Encryptor</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.extend</span>({processBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=this._cipher,<span class="hljs-selector-tag">i</span>=r<span class="hljs-selector-class">.blockSize</span>,o=this._iv,n=this._keystream;o&amp;&amp;(n=this._keystream=o<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>),this._iv=void <span class="hljs-number">0</span>),r<span class="hljs-selector-class">.encryptBlock</span>(n,<span class="hljs-number">0</span>);for(<span class="hljs-selector-tag">var</span> s=<span class="hljs-number">0</span>;s&lt;<span class="hljs-selector-tag">i</span>;s++)t<span class="hljs-selector-attr">[e+s]</span>^=n<span class="hljs-selector-attr">[s]</span>}}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.Decryptor</span>=w,<span class="hljs-selector-tag">p</span>),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.mode</span><span class="hljs-selector-class">.ECB</span>=((u=<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.BlockCipherMode</span><span class="hljs-selector-class">.extend</span>())<span class="hljs-selector-class">.Encryptor</span>=u<span class="hljs-selector-class">.extend</span>({processBlock:<span class="hljs-built_in">function</span>(t,e){this._cipher<span class="hljs-selector-class">.encryptBlock</span>(t,e)}}),u<span class="hljs-selector-class">.Decryptor</span>=u<span class="hljs-selector-class">.extend</span>({processBlock:<span class="hljs-built_in">function</span>(t,e){this._cipher<span class="hljs-selector-class">.decryptBlock</span>(t,e)}}),u),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.pad</span><span class="hljs-selector-class">.AnsiX923</span>={pad:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=t<span class="hljs-selector-class">.sigBytes</span>,e=<span class="hljs-number">4</span>*e,e=e-r%e,r=r+e-<span class="hljs-number">1</span>;t<span class="hljs-selector-class">.clamp</span>(),t<span class="hljs-selector-class">.words</span><span class="hljs-selector-attr">[r&gt;&gt;&gt;2]</span>|=e&lt;&lt;<span class="hljs-number">24</span>-r%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>,t<span class="hljs-selector-class">.sigBytes</span>+=e},unpad:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e=<span class="hljs-number">255</span>&amp;t<span class="hljs-selector-class">.words</span><span class="hljs-selector-attr">[t.sigBytes-1&gt;&gt;&gt;2]</span>;t<span class="hljs-selector-class">.sigBytes-</span>=e}},<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.pad</span><span class="hljs-selector-class">.Iso10126</span>={pad:<span class="hljs-built_in">function</span>(t,e){e*=<span class="hljs-number">4</span>,e-=t<span class="hljs-selector-class">.sigBytes</span>%e;t<span class="hljs-selector-class">.concat</span>(<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.WordArray</span><span class="hljs-selector-class">.random</span>(e-<span class="hljs-number">1</span>))<span class="hljs-selector-class">.concat</span>(<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.WordArray</span><span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[e&lt;&lt;24]</span>,<span class="hljs-number">1</span>))},unpad:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">var</span> e=<span class="hljs-number">255</span>&amp;t<span class="hljs-selector-class">.words</span><span class="hljs-selector-attr">[t.sigBytes-1&gt;&gt;&gt;2]</span>;t<span class="hljs-selector-class">.sigBytes-</span>=e}},<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.pad</span><span class="hljs-selector-class">.Iso97971</span>={pad:<span class="hljs-built_in">function</span>(t,e){t<span class="hljs-selector-class">.concat</span>(<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.WordArray</span><span class="hljs-selector-class">.create</span>(<span class="hljs-selector-attr">[2147483648]</span>,<span class="hljs-number">1</span>)),<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.pad</span><span class="hljs-selector-class">.ZeroPadding</span><span class="hljs-selector-class">.pad</span>(t,e)},unpad:<span class="hljs-built_in">function</span>(t){<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.pad</span><span class="hljs-selector-class">.ZeroPadding</span><span class="hljs-selector-class">.unpad</span>(t),t<span class="hljs-selector-class">.sigBytes--</span>}},<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.pad</span><span class="hljs-selector-class">.ZeroPadding</span>={pad:<span class="hljs-built_in">function</span>(t,e){e*=<span class="hljs-number">4</span>;t<span class="hljs-selector-class">.clamp</span>(),t<span class="hljs-selector-class">.sigBytes</span>+=e-(t<span class="hljs-selector-class">.sigBytes</span>%e||e)},unpad:<span class="hljs-built_in">function</span>(t){for(<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.words</span>,r=t<span class="hljs-selector-class">.sigBytes-1</span>,r=t<span class="hljs-selector-class">.sigBytes-1</span>;<span class="hljs-number">0</span>&lt;=r;r--)if(e<span class="hljs-selector-attr">[r&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-r%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>){t<span class="hljs-selector-class">.sigBytes</span>=r+<span class="hljs-number">1</span>;break}}},<span class="hljs-selector-tag">i</span><span class="hljs-selector-class">.pad</span><span class="hljs-selector-class">.NoPadding</span>={pad:<span class="hljs-built_in">function</span>(){},unpad:<span class="hljs-built_in">function</span>(){}},d1=(<span class="hljs-selector-tag">P</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.CipherParams</span>,u1=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.enc</span><span class="hljs-selector-class">.Hex</span>,<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.format</span><span class="hljs-selector-class">.Hex</span>={stringify:<span class="hljs-built_in">function</span>(t){return t<span class="hljs-selector-class">.ciphertext</span><span class="hljs-selector-class">.toString</span>(u1)},parse:<span class="hljs-built_in">function</span>(t){t=u1<span class="hljs-selector-class">.parse</span>(t);return d1<span class="hljs-selector-class">.create</span>({ciphertext:t})}};for(<span class="hljs-selector-tag">var</span> w=<span class="hljs-selector-tag">i</span>,<span class="hljs-selector-tag">p</span>=w<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.BlockCipher</span>,u=w<span class="hljs-selector-class">.algo</span>,k=<span class="hljs-selector-attr">[]</span>,r2=<span class="hljs-selector-attr">[]</span>,i2=<span class="hljs-selector-attr">[]</span>,o2=<span class="hljs-selector-attr">[]</span>,n2=<span class="hljs-selector-attr">[]</span>,s2=<span class="hljs-selector-attr">[]</span>,c2=<span class="hljs-selector-attr">[]</span>,a2=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">h2</span>=<span class="hljs-selector-attr">[]</span>,l2=<span class="hljs-selector-attr">[]</span>,x=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">b</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">b</span>&lt;<span class="hljs-number">256</span>;<span class="hljs-selector-tag">b</span>++)x<span class="hljs-selector-attr">[b]</span>=<span class="hljs-selector-tag">b</span>&lt;<span class="hljs-number">128</span>?<span class="hljs-selector-tag">b</span>&lt;&lt;<span class="hljs-number">1</span>:b&lt;&lt;<span class="hljs-number">1</span>^<span class="hljs-number">283</span>;for(<span class="hljs-selector-tag">var</span> m=<span class="hljs-number">0</span>,S=<span class="hljs-number">0</span>,<span class="hljs-selector-tag">b</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">b</span>&lt;<span class="hljs-number">256</span>;<span class="hljs-selector-tag">b</span>++){<span class="hljs-selector-tag">var</span> E=S^S&lt;&lt;<span class="hljs-number">1</span>^S&lt;&lt;<span class="hljs-number">2</span>^S&lt;&lt;<span class="hljs-number">3</span>^S&lt;&lt;<span class="hljs-number">4</span>,f2=(k<span class="hljs-selector-attr">[m]</span>=E=E&gt;&gt;&gt;<span class="hljs-number">8</span>^<span class="hljs-number">255</span>&amp;E^<span class="hljs-number">99</span>,x<span class="hljs-selector-attr">[r2[E]</span>=m]),d2=x<span class="hljs-selector-attr">[f2]</span>,u2=x<span class="hljs-selector-attr">[d2]</span>,M=<span class="hljs-number">257</span>*x<span class="hljs-selector-attr">[E]</span>^<span class="hljs-number">16843008</span>*E;i2<span class="hljs-selector-attr">[m]</span>=M&lt;&lt;<span class="hljs-number">24</span>|M&gt;&gt;&gt;<span class="hljs-number">8</span>,o2<span class="hljs-selector-attr">[m]</span>=M&lt;&lt;<span class="hljs-number">16</span>|M&gt;&gt;&gt;<span class="hljs-number">16</span>,n2<span class="hljs-selector-attr">[m]</span>=M&lt;&lt;<span class="hljs-number">8</span>|M&gt;&gt;&gt;<span class="hljs-number">24</span>,s2<span class="hljs-selector-attr">[m]</span>=M,c2<span class="hljs-selector-attr">[E]</span>=(M=<span class="hljs-number">16843009</span>*u2^<span class="hljs-number">65537</span>*d2^<span class="hljs-number">257</span>*f2^<span class="hljs-number">16843008</span>*m)&lt;&lt;<span class="hljs-number">24</span>|M&gt;&gt;&gt;<span class="hljs-number">8</span>,a2<span class="hljs-selector-attr">[E]</span>=M&lt;&lt;<span class="hljs-number">16</span>|M&gt;&gt;&gt;<span class="hljs-number">16</span>,<span class="hljs-selector-tag">h2</span><span class="hljs-selector-attr">[E]</span>=M&lt;&lt;<span class="hljs-number">8</span>|M&gt;&gt;&gt;<span class="hljs-number">24</span>,l2<span class="hljs-selector-attr">[E]</span>=M,m?(m=f2^x<span class="hljs-selector-attr">[x[x[u2^f2]</span>]],S^=x<span class="hljs-selector-attr">[x[S]</span>]):m=S=<span class="hljs-number">1</span>}<span class="hljs-selector-tag">var</span> p2=<span class="hljs-selector-attr">[0,1,2,4,8,16,32,64,128,27,54]</span>,u=u<span class="hljs-selector-class">.AES</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){if(!this._nRounds||this._keyPriorReset!==this._key){for(<span class="hljs-selector-tag">var</span> t=this._keyPriorReset=this._key,e=t<span class="hljs-selector-class">.words</span>,r=t<span class="hljs-selector-class">.sigBytes</span>/<span class="hljs-number">4</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">4</span>*(<span class="hljs-number">1</span>+(this._nRounds=<span class="hljs-number">6</span>+r)),o=this._keySchedule=<span class="hljs-selector-attr">[]</span>,n=<span class="hljs-number">0</span>;n&lt;<span class="hljs-selector-tag">i</span>;n++)n&lt;r?o<span class="hljs-selector-attr">[n]</span>=e<span class="hljs-selector-attr">[n]</span>:(a=o[n-<span class="hljs-number">1</span>],n%r?<span class="hljs-number">6</span>&lt;r&amp;&amp;n%r==<span class="hljs-number">4</span>&amp;&amp;(a=k[a&gt;&gt;&gt;<span class="hljs-number">24</span>]&lt;&lt;<span class="hljs-number">24</span>|k[a&gt;&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]&lt;&lt;<span class="hljs-number">16</span>|k[a&gt;&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]&lt;&lt;<span class="hljs-number">8</span>|k[<span class="hljs-number">255</span>&amp;a]):(a=k[(a=a&lt;&lt;<span class="hljs-number">8</span>|a&gt;&gt;&gt;<span class="hljs-number">24</span>)&gt;&gt;&gt;<span class="hljs-number">24</span>]&lt;&lt;<span class="hljs-number">24</span>|k[a&gt;&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]&lt;&lt;<span class="hljs-number">16</span>|k[a&gt;&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]&lt;&lt;<span class="hljs-number">8</span>|k[<span class="hljs-number">255</span>&amp;a],a^=p2[n/r|<span class="hljs-number">0</span>]&lt;&lt;<span class="hljs-number">24</span>),o[n]=o[n-r]^a);for(<span class="hljs-selector-tag">var</span> s=this._invKeySchedule=<span class="hljs-selector-attr">[]</span>,c=<span class="hljs-number">0</span>;c&lt;<span class="hljs-selector-tag">i</span>;c++){<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">a</span>,n=<span class="hljs-selector-tag">i</span>-c;<span class="hljs-selector-tag">a</span>=c%<span class="hljs-number">4</span>?o<span class="hljs-selector-attr">[n]</span>:o[n-<span class="hljs-number">4</span>],s[c]=c&lt;<span class="hljs-number">4</span>||n&lt;=<span class="hljs-number">4</span>?a:c2[k[a&gt;&gt;&gt;<span class="hljs-number">24</span>]]^a2[k[a&gt;&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">255</span>]]^h2[k[a&gt;&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>]]^l2[k[<span class="hljs-number">255</span>&amp;a]]}}},encryptBlock:<span class="hljs-built_in">function</span>(t,e){this._doCryptBlock(t,e,this._keySchedule,i2,o2,n2,s2,k)},decryptBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=t<span class="hljs-selector-attr">[e+1]</span>,r=(t<span class="hljs-selector-attr">[e+1]</span>=t<span class="hljs-selector-attr">[e+3]</span>,t<span class="hljs-selector-attr">[e+3]</span>=r,this._doCryptBlock(t,e,this._invKeySchedule,c2,a2,<span class="hljs-selector-tag">h2</span>,l2,r2),t<span class="hljs-selector-attr">[e+1]</span>);t<span class="hljs-selector-attr">[e+1]</span>=t<span class="hljs-selector-attr">[e+3]</span>,t<span class="hljs-selector-attr">[e+3]</span>=r},_doCryptBlock:<span class="hljs-built_in">function</span>(t,e,r,i,o,n,s,c){for(<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">a</span>=this._nRounds,h=t<span class="hljs-selector-attr">[e]</span>^r<span class="hljs-selector-attr">[0]</span>,l=t<span class="hljs-selector-attr">[e+1]</span>^r<span class="hljs-selector-attr">[1]</span>,f=t<span class="hljs-selector-attr">[e+2]</span>^r<span class="hljs-selector-attr">[2]</span>,d=t<span class="hljs-selector-attr">[e+3]</span>^r<span class="hljs-selector-attr">[3]</span>,u=<span class="hljs-number">4</span>,<span class="hljs-selector-tag">p</span>=<span class="hljs-number">1</span>;<span class="hljs-selector-tag">p</span>&lt;<span class="hljs-selector-tag">a</span>;<span class="hljs-selector-tag">p</span>++)<span class="hljs-selector-tag">var</span> _=<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[h&gt;&gt;&gt;24]</span>^o<span class="hljs-selector-attr">[l&gt;&gt;&gt;16&amp;255]</span>^n<span class="hljs-selector-attr">[f&gt;&gt;&gt;8&amp;255]</span>^s<span class="hljs-selector-attr">[255&amp;d]</span>^r<span class="hljs-selector-attr">[u++]</span>,y=<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[l&gt;&gt;&gt;24]</span>^o<span class="hljs-selector-attr">[f&gt;&gt;&gt;16&amp;255]</span>^n<span class="hljs-selector-attr">[d&gt;&gt;&gt;8&amp;255]</span>^s<span class="hljs-selector-attr">[255&amp;h]</span>^r<span class="hljs-selector-attr">[u++]</span>,g=<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[f&gt;&gt;&gt;24]</span>^o<span class="hljs-selector-attr">[d&gt;&gt;&gt;16&amp;255]</span>^n<span class="hljs-selector-attr">[h&gt;&gt;&gt;8&amp;255]</span>^s<span class="hljs-selector-attr">[255&amp;l]</span>^r<span class="hljs-selector-attr">[u++]</span>,v=<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[d&gt;&gt;&gt;24]</span>^o<span class="hljs-selector-attr">[h&gt;&gt;&gt;16&amp;255]</span>^n<span class="hljs-selector-attr">[l&gt;&gt;&gt;8&amp;255]</span>^s<span class="hljs-selector-attr">[255&amp;f]</span>^r<span class="hljs-selector-attr">[u++]</span>,h=_,l=y,f=g,d=v;_=(c<span class="hljs-selector-attr">[h&gt;&gt;&gt;24]</span>&lt;&lt;<span class="hljs-number">24</span>|c<span class="hljs-selector-attr">[l&gt;&gt;&gt;16&amp;255]</span>&lt;&lt;<span class="hljs-number">16</span>|c<span class="hljs-selector-attr">[f&gt;&gt;&gt;8&amp;255]</span>&lt;&lt;<span class="hljs-number">8</span>|c<span class="hljs-selector-attr">[255&amp;d]</span>)^r<span class="hljs-selector-attr">[u++]</span>,y=(c<span class="hljs-selector-attr">[l&gt;&gt;&gt;24]</span>&lt;&lt;<span class="hljs-number">24</span>|c<span class="hljs-selector-attr">[f&gt;&gt;&gt;16&amp;255]</span>&lt;&lt;<span class="hljs-number">16</span>|c<span class="hljs-selector-attr">[d&gt;&gt;&gt;8&amp;255]</span>&lt;&lt;<span class="hljs-number">8</span>|c<span class="hljs-selector-attr">[255&amp;h]</span>)^r<span class="hljs-selector-attr">[u++]</span>,g=(c<span class="hljs-selector-attr">[f&gt;&gt;&gt;24]</span>&lt;&lt;<span class="hljs-number">24</span>|c<span class="hljs-selector-attr">[d&gt;&gt;&gt;16&amp;255]</span>&lt;&lt;<span class="hljs-number">16</span>|c<span class="hljs-selector-attr">[h&gt;&gt;&gt;8&amp;255]</span>&lt;&lt;<span class="hljs-number">8</span>|c<span class="hljs-selector-attr">[255&amp;l]</span>)^r<span class="hljs-selector-attr">[u++]</span>,v=(c<span class="hljs-selector-attr">[d&gt;&gt;&gt;24]</span>&lt;&lt;<span class="hljs-number">24</span>|c<span class="hljs-selector-attr">[h&gt;&gt;&gt;16&amp;255]</span>&lt;&lt;<span class="hljs-number">16</span>|c<span class="hljs-selector-attr">[l&gt;&gt;&gt;8&amp;255]</span>&lt;&lt;<span class="hljs-number">8</span>|c<span class="hljs-selector-attr">[255&amp;f]</span>)^r<span class="hljs-selector-attr">[u++]</span>;t<span class="hljs-selector-attr">[e]</span>=_,t<span class="hljs-selector-attr">[e+1]</span>=y,t<span class="hljs-selector-attr">[e+2]</span>=g,t<span class="hljs-selector-attr">[e+3]</span>=v},keySize:<span class="hljs-number">8</span>}),<span class="hljs-selector-tag">P</span>=(w<span class="hljs-selector-class">.AES</span>=<span class="hljs-selector-tag">p</span>._createHelper(u),<span class="hljs-selector-tag">i</span>),_2=(w=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.lib</span>)<span class="hljs-selector-class">.WordArray</span>,w=w<span class="hljs-selector-class">.BlockCipher</span>,<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.algo</span>,y2=<span class="hljs-selector-attr">[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4]</span>,g2=<span class="hljs-selector-attr">[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32]</span>,v2=<span class="hljs-selector-attr">[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28]</span>,B2=<span class="hljs-selector-attr">[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}]</span>,w2=<span class="hljs-selector-attr">[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679]</span>,k2=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.DES</span>=w<span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=this._key<span class="hljs-selector-class">.words</span>,e=<span class="hljs-selector-attr">[]</span>,r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">56</span>;r++){<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=y2<span class="hljs-selector-attr">[r]</span>-<span class="hljs-number">1</span>;e<span class="hljs-selector-attr">[r]</span>=t<span class="hljs-selector-attr">[i&gt;&gt;&gt;5]</span>&gt;&gt;&gt;<span class="hljs-number">31</span>-<span class="hljs-selector-tag">i</span>%<span class="hljs-number">32</span>&amp;<span class="hljs-number">1</span>}for(<span class="hljs-selector-tag">var</span> o=this._subKeys=<span class="hljs-selector-attr">[]</span>,n=<span class="hljs-number">0</span>;n&lt;<span class="hljs-number">16</span>;n++){for(<span class="hljs-selector-tag">var</span> s=o<span class="hljs-selector-attr">[n]</span>=<span class="hljs-selector-attr">[]</span>,c=v2<span class="hljs-selector-attr">[n]</span>,r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">24</span>;r++)s<span class="hljs-selector-attr">[r/6|0]</span>|=e<span class="hljs-selector-attr">[(g2[r]</span>-<span class="hljs-number">1</span>+c)%<span class="hljs-number">28</span>]&lt;&lt;<span class="hljs-number">31</span>-r%<span class="hljs-number">6</span>,s<span class="hljs-selector-attr">[4+(r/6|0)]</span>|=e<span class="hljs-selector-attr">[28+(g2[r+24]</span>-<span class="hljs-number">1</span>+c)%<span class="hljs-number">28</span>]&lt;&lt;<span class="hljs-number">31</span>-r%<span class="hljs-number">6</span>;s<span class="hljs-selector-attr">[0]</span>=s<span class="hljs-selector-attr">[0]</span>&lt;&lt;<span class="hljs-number">1</span>|s<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">31</span>;for(r=<span class="hljs-number">1</span>;r&lt;<span class="hljs-number">7</span>;r++)s<span class="hljs-selector-attr">[r]</span>=s<span class="hljs-selector-attr">[r]</span>&gt;&gt;&gt;<span class="hljs-number">4</span>*(r-<span class="hljs-number">1</span>)+<span class="hljs-number">3</span>;s<span class="hljs-selector-attr">[7]</span>=s<span class="hljs-selector-attr">[7]</span>&lt;&lt;<span class="hljs-number">5</span>|s<span class="hljs-selector-attr">[7]</span>&gt;&gt;&gt;<span class="hljs-number">27</span>}for(<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">a</span>=this._invSubKeys=<span class="hljs-selector-attr">[]</span>,r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">16</span>;r++)<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[r]</span>=o<span class="hljs-selector-attr">[15-r]</span>},encryptBlock:<span class="hljs-built_in">function</span>(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:<span class="hljs-built_in">function</span>(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:<span class="hljs-built_in">function</span>(t,e,r){this._lBlock=t<span class="hljs-selector-attr">[e]</span>,this._rBlock=t<span class="hljs-selector-attr">[e+1]</span>,x2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">4</span>,<span class="hljs-number">252645135</span>),x2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">16</span>,<span class="hljs-number">65535</span>),b2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">2</span>,<span class="hljs-number">858993459</span>),b2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">8</span>,<span class="hljs-number">16711935</span>),x2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">1</span>,<span class="hljs-number">1431655765</span>);for(<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;<span class="hljs-number">16</span>;<span class="hljs-selector-tag">i</span>++){for(<span class="hljs-selector-tag">var</span> o=r<span class="hljs-selector-attr">[i]</span>,n=this._lBlock,s=this._rBlock,c=<span class="hljs-number">0</span>,<span class="hljs-selector-tag">a</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">a</span>&lt;<span class="hljs-number">8</span>;<span class="hljs-selector-tag">a</span>++)c|=B2<span class="hljs-selector-attr">[a]</span><span class="hljs-selector-attr">[((s^o[a]</span>)&amp;w2<span class="hljs-selector-attr">[a]</span>)&gt;&gt;&gt;<span class="hljs-number">0</span>];this._lBlock=s,this._rBlock=n^c}<span class="hljs-selector-tag">var</span> h=this._lBlock;this._lBlock=this._rBlock,this._rBlock=h,x2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">1</span>,<span class="hljs-number">1431655765</span>),b2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">8</span>,<span class="hljs-number">16711935</span>),b2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">2</span>,<span class="hljs-number">858993459</span>),x2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">16</span>,<span class="hljs-number">65535</span>),x2<span class="hljs-selector-class">.call</span>(this,<span class="hljs-number">4</span>,<span class="hljs-number">252645135</span>),t<span class="hljs-selector-attr">[e]</span>=this._lBlock,t<span class="hljs-selector-attr">[e+1]</span>=this._rBlock},keySize:<span class="hljs-number">2</span>,ivSize:<span class="hljs-number">2</span>,blockSize:<span class="hljs-number">2</span>});function x2(t,e){e=(this._lBlock&gt;&gt;&gt;t^this._rBlock)&amp;e;this._rBlock^=e,this._lBlock^=e&lt;&lt;t}function b2(t,e){e=(this._rBlock&gt;&gt;&gt;t^this._lBlock)&amp;e;this._lBlock^=e,this._rBlock^=e&lt;&lt;t}<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.DES</span>=w._createHelper(k2),<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.TripleDES</span>=w<span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){<span class="hljs-selector-tag">var</span> t=this._key<span class="hljs-selector-class">.words</span>;if(<span class="hljs-number">2</span>!==t<span class="hljs-selector-class">.length</span>&amp;&amp;<span class="hljs-number">4</span>!==t<span class="hljs-selector-class">.length</span>&amp;&amp;t<span class="hljs-selector-class">.length</span>&lt;<span class="hljs-number">6</span>)throw new Error("Invalid key length - <span class="hljs-number">3</span>DES requires the key length <span class="hljs-selector-tag">to</span> be <span class="hljs-number">64</span>, <span class="hljs-number">128</span>, <span class="hljs-number">192</span> or &gt;<span class="hljs-number">192</span>.");<span class="hljs-selector-tag">var</span> e=t<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>),r=t<span class="hljs-selector-class">.length</span>&lt;<span class="hljs-number">4</span>?t<span class="hljs-selector-class">.slice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>):t.<span class="hljs-built_in">slice</span>(<span class="hljs-number">2</span>,<span class="hljs-number">4</span>),t=t.length&lt;<span class="hljs-number">6</span>?t.<span class="hljs-built_in">slice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>):t.<span class="hljs-built_in">slice</span>(<span class="hljs-number">4</span>,<span class="hljs-number">6</span>);this._des1=k2<span class="hljs-selector-class">.createEncryptor</span>(_2<span class="hljs-selector-class">.create</span>(e)),this._des2=k2<span class="hljs-selector-class">.createEncryptor</span>(_2<span class="hljs-selector-class">.create</span>(r)),this._des3=k2<span class="hljs-selector-class">.createEncryptor</span>(_2<span class="hljs-selector-class">.create</span>(t))},encryptBlock:<span class="hljs-built_in">function</span>(t,e){this._des1<span class="hljs-selector-class">.encryptBlock</span>(t,e),this._des2<span class="hljs-selector-class">.decryptBlock</span>(t,e),this._des3<span class="hljs-selector-class">.encryptBlock</span>(t,e)},decryptBlock:<span class="hljs-built_in">function</span>(t,e){this._des3<span class="hljs-selector-class">.decryptBlock</span>(t,e),this._des2<span class="hljs-selector-class">.encryptBlock</span>(t,e),this._des1<span class="hljs-selector-class">.decryptBlock</span>(t,e)},keySize:<span class="hljs-number">6</span>,ivSize:<span class="hljs-number">2</span>,blockSize:<span class="hljs-number">2</span>}),<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.TripleDES</span>=w._createHelper(<span class="hljs-selector-tag">p</span>);<span class="hljs-selector-tag">var</span> u=<span class="hljs-selector-tag">i</span>,<span class="hljs-selector-tag">P</span>=u<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.StreamCipher</span>,w=u<span class="hljs-selector-class">.algo</span>,m2=w<span class="hljs-selector-class">.RC4</span>=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=this._key,e=t<span class="hljs-selector-class">.words</span>,r=t<span class="hljs-selector-class">.sigBytes</span>,<span class="hljs-selector-tag">i</span>=this._S=<span class="hljs-selector-attr">[]</span>,o=<span class="hljs-number">0</span>;o&lt;<span class="hljs-number">256</span>;o++)<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[o]</span>=o;for(<span class="hljs-selector-tag">var</span> o=<span class="hljs-number">0</span>,n=<span class="hljs-number">0</span>;o&lt;<span class="hljs-number">256</span>;o++){<span class="hljs-selector-tag">var</span> s=o%r,s=e<span class="hljs-selector-attr">[s&gt;&gt;&gt;2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>-s%<span class="hljs-number">4</span>*<span class="hljs-number">8</span>&amp;<span class="hljs-number">255</span>,n=(n+<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[o]</span>+s)%<span class="hljs-number">256</span>,s=<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[o]</span>;<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[o]</span>=<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[n]</span>,<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[n]</span>=s}this._i=this._j=<span class="hljs-number">0</span>},_doProcessBlock:<span class="hljs-built_in">function</span>(t,e){t<span class="hljs-selector-attr">[e]</span>^=S2<span class="hljs-selector-class">.call</span>(this)},keySize:<span class="hljs-number">8</span>,ivSize:<span class="hljs-number">0</span>});function S2(){for(<span class="hljs-selector-tag">var</span> t=this._S,e=this._i,r=this._j,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>,o=<span class="hljs-number">0</span>;o&lt;<span class="hljs-number">4</span>;o++){<span class="hljs-selector-tag">var</span> r=(r+t<span class="hljs-selector-attr">[e=(e+1)%256]</span>)%<span class="hljs-number">256</span>,n=t<span class="hljs-selector-attr">[e]</span>;t<span class="hljs-selector-attr">[e]</span>=t<span class="hljs-selector-attr">[r]</span>,t<span class="hljs-selector-attr">[r]</span>=n,<span class="hljs-selector-tag">i</span>|=t<span class="hljs-selector-attr">[(t[e]</span>+t<span class="hljs-selector-attr">[r]</span>)%<span class="hljs-number">256</span>]&lt;&lt;<span class="hljs-number">24</span>-<span class="hljs-number">8</span>*o}return this._i=e,this._j=r,<span class="hljs-selector-tag">i</span>}function A2(){for(<span class="hljs-selector-tag">var</span> t=this._X,e=this._C,r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">8</span>;r++)c<span class="hljs-selector-attr">[r]</span>=e<span class="hljs-selector-attr">[r]</span>;e<span class="hljs-selector-attr">[0]</span>=e<span class="hljs-selector-attr">[0]</span>+<span class="hljs-number">1295307597</span>+this._b|<span class="hljs-number">0</span>,e<span class="hljs-selector-attr">[1]</span>=e<span class="hljs-selector-attr">[1]</span>+<span class="hljs-number">3545052371</span>+(e<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;c<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">2</span>]=e[<span class="hljs-number">2</span>]+<span class="hljs-number">886263092</span>+(e[<span class="hljs-number">1</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;c[<span class="hljs-number">1</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">3</span>]=e[<span class="hljs-number">3</span>]+<span class="hljs-number">1295307597</span>+(e[<span class="hljs-number">2</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;c[<span class="hljs-number">2</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">4</span>]=e[<span class="hljs-number">4</span>]+<span class="hljs-number">3545052371</span>+(e[<span class="hljs-number">3</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;c[<span class="hljs-number">3</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">5</span>]=e[<span class="hljs-number">5</span>]+<span class="hljs-number">886263092</span>+(e[<span class="hljs-number">4</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;c[<span class="hljs-number">4</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">6</span>]=e[<span class="hljs-number">6</span>]+<span class="hljs-number">1295307597</span>+(e[<span class="hljs-number">5</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;c[<span class="hljs-number">5</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">7</span>]=e[<span class="hljs-number">7</span>]+<span class="hljs-number">3545052371</span>+(e[<span class="hljs-number">6</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;c[<span class="hljs-number">6</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,this._b=e[<span class="hljs-number">7</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;c[<span class="hljs-number">7</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>;for(r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">8</span>;r++){<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=t<span class="hljs-selector-attr">[r]</span>+e<span class="hljs-selector-attr">[r]</span>,o=<span class="hljs-number">65535</span>&amp;<span class="hljs-selector-tag">i</span>,n=<span class="hljs-selector-tag">i</span>&gt;&gt;&gt;<span class="hljs-number">16</span>;<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[r]</span>=((o*o&gt;&gt;&gt;<span class="hljs-number">17</span>)+o*n&gt;&gt;&gt;<span class="hljs-number">15</span>)+n*n^((<span class="hljs-number">4294901760</span>&amp;<span class="hljs-selector-tag">i</span>)*<span class="hljs-selector-tag">i</span>|<span class="hljs-number">0</span>)+((<span class="hljs-number">65535</span>&amp;<span class="hljs-selector-tag">i</span>)*<span class="hljs-selector-tag">i</span>|<span class="hljs-number">0</span>)}t<span class="hljs-selector-attr">[0]</span>=<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[0]</span>+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[7]</span>&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[7]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[6]</span>&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[6]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[1]</span>=<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[1]</span>+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[0]</span>&lt;&lt;<span class="hljs-number">8</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)+<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[7]</span>|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[2]</span>=<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[2]</span>+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[1]</span>&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[1]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[0]</span>&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[3]</span>=<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[3]</span>+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[2]</span>&lt;&lt;<span class="hljs-number">8</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)+<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[1]</span>|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[4]</span>=<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[4]</span>+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[3]</span>&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[3]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[2]</span>&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[2]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[5]</span>=<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[5]</span>+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[4]</span>&lt;&lt;<span class="hljs-number">8</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[4]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)+<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[3]</span>|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[6]</span>=<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[6]</span>+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[5]</span>&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[5]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[4]</span>&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[4]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[7]</span>=<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[7]</span>+(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[6]</span>&lt;&lt;<span class="hljs-number">8</span>|<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[6]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)+<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[5]</span>|<span class="hljs-number">0</span>}function z2(){for(<span class="hljs-selector-tag">var</span> t=this._X,e=this._C,r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">8</span>;r++)f<span class="hljs-selector-attr">[r]</span>=e<span class="hljs-selector-attr">[r]</span>;e<span class="hljs-selector-attr">[0]</span>=e<span class="hljs-selector-attr">[0]</span>+<span class="hljs-number">1295307597</span>+this._b|<span class="hljs-number">0</span>,e<span class="hljs-selector-attr">[1]</span>=e<span class="hljs-selector-attr">[1]</span>+<span class="hljs-number">3545052371</span>+(e<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;f<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">2</span>]=e[<span class="hljs-number">2</span>]+<span class="hljs-number">886263092</span>+(e[<span class="hljs-number">1</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;f[<span class="hljs-number">1</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">3</span>]=e[<span class="hljs-number">3</span>]+<span class="hljs-number">1295307597</span>+(e[<span class="hljs-number">2</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;f[<span class="hljs-number">2</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">4</span>]=e[<span class="hljs-number">4</span>]+<span class="hljs-number">3545052371</span>+(e[<span class="hljs-number">3</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;f[<span class="hljs-number">3</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">5</span>]=e[<span class="hljs-number">5</span>]+<span class="hljs-number">886263092</span>+(e[<span class="hljs-number">4</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;f[<span class="hljs-number">4</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">6</span>]=e[<span class="hljs-number">6</span>]+<span class="hljs-number">1295307597</span>+(e[<span class="hljs-number">5</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;f[<span class="hljs-number">5</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,e[<span class="hljs-number">7</span>]=e[<span class="hljs-number">7</span>]+<span class="hljs-number">3545052371</span>+(e[<span class="hljs-number">6</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;f[<span class="hljs-number">6</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)|<span class="hljs-number">0</span>,this._b=e[<span class="hljs-number">7</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>&lt;f[<span class="hljs-number">7</span>]&gt;&gt;&gt;<span class="hljs-number">0</span>?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>;for(r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">8</span>;r++){<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=t<span class="hljs-selector-attr">[r]</span>+e<span class="hljs-selector-attr">[r]</span>,o=<span class="hljs-number">65535</span>&amp;<span class="hljs-selector-tag">i</span>,n=<span class="hljs-selector-tag">i</span>&gt;&gt;&gt;<span class="hljs-number">16</span>;d<span class="hljs-selector-attr">[r]</span>=((o*o&gt;&gt;&gt;<span class="hljs-number">17</span>)+o*n&gt;&gt;&gt;<span class="hljs-number">15</span>)+n*n^((<span class="hljs-number">4294901760</span>&amp;<span class="hljs-selector-tag">i</span>)*<span class="hljs-selector-tag">i</span>|<span class="hljs-number">0</span>)+((<span class="hljs-number">65535</span>&amp;<span class="hljs-selector-tag">i</span>)*<span class="hljs-selector-tag">i</span>|<span class="hljs-number">0</span>)}t<span class="hljs-selector-attr">[0]</span>=d<span class="hljs-selector-attr">[0]</span>+(d<span class="hljs-selector-attr">[7]</span>&lt;&lt;<span class="hljs-number">16</span>|d<span class="hljs-selector-attr">[7]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)+(d<span class="hljs-selector-attr">[6]</span>&lt;&lt;<span class="hljs-number">16</span>|d<span class="hljs-selector-attr">[6]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[1]</span>=d<span class="hljs-selector-attr">[1]</span>+(d<span class="hljs-selector-attr">[0]</span>&lt;&lt;<span class="hljs-number">8</span>|d<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)+d<span class="hljs-selector-attr">[7]</span>|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[2]</span>=d<span class="hljs-selector-attr">[2]</span>+(d<span class="hljs-selector-attr">[1]</span>&lt;&lt;<span class="hljs-number">16</span>|d<span class="hljs-selector-attr">[1]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)+(d<span class="hljs-selector-attr">[0]</span>&lt;&lt;<span class="hljs-number">16</span>|d<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[3]</span>=d<span class="hljs-selector-attr">[3]</span>+(d<span class="hljs-selector-attr">[2]</span>&lt;&lt;<span class="hljs-number">8</span>|d<span class="hljs-selector-attr">[2]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)+d<span class="hljs-selector-attr">[1]</span>|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[4]</span>=d<span class="hljs-selector-attr">[4]</span>+(d<span class="hljs-selector-attr">[3]</span>&lt;&lt;<span class="hljs-number">16</span>|d<span class="hljs-selector-attr">[3]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)+(d<span class="hljs-selector-attr">[2]</span>&lt;&lt;<span class="hljs-number">16</span>|d<span class="hljs-selector-attr">[2]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[5]</span>=d<span class="hljs-selector-attr">[5]</span>+(d<span class="hljs-selector-attr">[4]</span>&lt;&lt;<span class="hljs-number">8</span>|d<span class="hljs-selector-attr">[4]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)+d<span class="hljs-selector-attr">[3]</span>|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[6]</span>=d<span class="hljs-selector-attr">[6]</span>+(d<span class="hljs-selector-attr">[5]</span>&lt;&lt;<span class="hljs-number">16</span>|d<span class="hljs-selector-attr">[5]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)+(d<span class="hljs-selector-attr">[4]</span>&lt;&lt;<span class="hljs-number">16</span>|d<span class="hljs-selector-attr">[4]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>)|<span class="hljs-number">0</span>,t<span class="hljs-selector-attr">[7]</span>=d<span class="hljs-selector-attr">[7]</span>+(d<span class="hljs-selector-attr">[6]</span>&lt;&lt;<span class="hljs-number">8</span>|d<span class="hljs-selector-attr">[6]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)+d<span class="hljs-selector-attr">[5]</span>|<span class="hljs-number">0</span>}u<span class="hljs-selector-class">.RC4</span>=<span class="hljs-selector-tag">P</span>._createHelper(m2),w=w<span class="hljs-selector-class">.RC4Drop</span>=m2<span class="hljs-selector-class">.extend</span>({cfg:m2.cfg.<span class="hljs-built_in">extend</span>({drop:<span class="hljs-number">192</span>}),_doReset:<span class="hljs-built_in">function</span>(){m2._doReset<span class="hljs-selector-class">.call</span>(this);for(<span class="hljs-selector-tag">var</span> t=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.drop</span>;<span class="hljs-number">0</span>&lt;t;t--)S2<span class="hljs-selector-class">.call</span>(this)}}),u<span class="hljs-selector-class">.RC4Drop</span>=<span class="hljs-selector-tag">P</span>._createHelper(w),u=(<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.StreamCipher</span>,<span class="hljs-selector-tag">P</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.algo</span>,n=<span class="hljs-selector-attr">[]</span>,c=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">a</span>=<span class="hljs-selector-attr">[]</span>,<span class="hljs-selector-tag">P</span>=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.Rabbit</span>=u<span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=this._key<span class="hljs-selector-class">.words</span>,e=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.iv</span>,r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">4</span>;r++)t<span class="hljs-selector-attr">[r]</span>=<span class="hljs-number">16711935</span>&amp;(t<span class="hljs-selector-attr">[r]</span>&lt;&lt;<span class="hljs-number">8</span>|t<span class="hljs-selector-attr">[r]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(t<span class="hljs-selector-attr">[r]</span>&lt;&lt;<span class="hljs-number">24</span>|t<span class="hljs-selector-attr">[r]</span>&gt;&gt;&gt;<span class="hljs-number">8</span>);for(<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=this._X=<span class="hljs-selector-attr">[t[0]</span>,t<span class="hljs-selector-attr">[3]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[2]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,t<span class="hljs-selector-attr">[1]</span>,t<span class="hljs-selector-attr">[0]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[3]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,t<span class="hljs-selector-attr">[2]</span>,t<span class="hljs-selector-attr">[1]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,t<span class="hljs-selector-attr">[3]</span>,t<span class="hljs-selector-attr">[2]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[1]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>],o=this._C=<span class="hljs-selector-attr">[t[2]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[2]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,<span class="hljs-number">4294901760</span>&amp;t<span class="hljs-selector-attr">[0]</span>|<span class="hljs-number">65535</span>&amp;t<span class="hljs-selector-attr">[1]</span>,t<span class="hljs-selector-attr">[3]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[3]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,<span class="hljs-number">4294901760</span>&amp;t<span class="hljs-selector-attr">[1]</span>|<span class="hljs-number">65535</span>&amp;t<span class="hljs-selector-attr">[2]</span>,t<span class="hljs-selector-attr">[0]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,<span class="hljs-number">4294901760</span>&amp;t<span class="hljs-selector-attr">[2]</span>|<span class="hljs-number">65535</span>&amp;t<span class="hljs-selector-attr">[3]</span>,t<span class="hljs-selector-attr">[1]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[1]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,<span class="hljs-number">4294901760</span>&amp;t<span class="hljs-selector-attr">[3]</span>|<span class="hljs-number">65535</span>&amp;t<span class="hljs-selector-attr">[0]</span>],r=this._b=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">4</span>;r++)A2<span class="hljs-selector-class">.call</span>(this);for(r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">8</span>;r++)o<span class="hljs-selector-attr">[r]</span>^=<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[r+4&amp;7]</span>;if(e){<span class="hljs-selector-tag">var</span> e=e<span class="hljs-selector-class">.words</span>,n=e<span class="hljs-selector-attr">[0]</span>,e=e<span class="hljs-selector-attr">[1]</span>,n=<span class="hljs-number">16711935</span>&amp;(n&lt;&lt;<span class="hljs-number">8</span>|n&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(n&lt;&lt;<span class="hljs-number">24</span>|n&gt;&gt;&gt;<span class="hljs-number">8</span>),e=<span class="hljs-number">16711935</span>&amp;(e&lt;&lt;<span class="hljs-number">8</span>|e&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(e&lt;&lt;<span class="hljs-number">24</span>|e&gt;&gt;&gt;<span class="hljs-number">8</span>),s=n&gt;&gt;&gt;<span class="hljs-number">16</span>|<span class="hljs-number">4294901760</span>&amp;e,c=e&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-number">65535</span>&amp;n;o<span class="hljs-selector-attr">[0]</span>^=n,o<span class="hljs-selector-attr">[1]</span>^=s,o<span class="hljs-selector-attr">[2]</span>^=e,o<span class="hljs-selector-attr">[3]</span>^=c,o<span class="hljs-selector-attr">[4]</span>^=n,o<span class="hljs-selector-attr">[5]</span>^=s,o<span class="hljs-selector-attr">[6]</span>^=e,o<span class="hljs-selector-attr">[7]</span>^=c;for(r=<span class="hljs-number">0</span>;r&lt;<span class="hljs-number">4</span>;r++)A2<span class="hljs-selector-class">.call</span>(this)}},_doProcessBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=this._X;A2<span class="hljs-selector-class">.call</span>(this),n<span class="hljs-selector-attr">[0]</span>=r<span class="hljs-selector-attr">[0]</span>^r<span class="hljs-selector-attr">[5]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>^r<span class="hljs-selector-attr">[3]</span>&lt;&lt;<span class="hljs-number">16</span>,n<span class="hljs-selector-attr">[1]</span>=r<span class="hljs-selector-attr">[2]</span>^r<span class="hljs-selector-attr">[7]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>^r<span class="hljs-selector-attr">[5]</span>&lt;&lt;<span class="hljs-number">16</span>,n<span class="hljs-selector-attr">[2]</span>=r<span class="hljs-selector-attr">[4]</span>^r<span class="hljs-selector-attr">[1]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>^r<span class="hljs-selector-attr">[7]</span>&lt;&lt;<span class="hljs-number">16</span>,n<span class="hljs-selector-attr">[3]</span>=r<span class="hljs-selector-attr">[6]</span>^r<span class="hljs-selector-attr">[3]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>^r<span class="hljs-selector-attr">[1]</span>&lt;&lt;<span class="hljs-number">16</span>;for(<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;<span class="hljs-number">4</span>;<span class="hljs-selector-tag">i</span>++)n<span class="hljs-selector-attr">[i]</span>=<span class="hljs-number">16711935</span>&amp;(n<span class="hljs-selector-attr">[i]</span>&lt;&lt;<span class="hljs-number">8</span>|n<span class="hljs-selector-attr">[i]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(n<span class="hljs-selector-attr">[i]</span>&lt;&lt;<span class="hljs-number">24</span>|n<span class="hljs-selector-attr">[i]</span>&gt;&gt;&gt;<span class="hljs-number">8</span>),t<span class="hljs-selector-attr">[e+i]</span>^=n<span class="hljs-selector-attr">[i]</span>},blockSize:<span class="hljs-number">4</span>,ivSize:<span class="hljs-number">2</span>}),<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.Rabbit</span>=u._createHelper(<span class="hljs-selector-tag">P</span>),<span class="hljs-selector-tag">p</span>=(w=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.StreamCipher</span>,u=w<span class="hljs-selector-class">.algo</span>,h=<span class="hljs-selector-attr">[]</span>,f=<span class="hljs-selector-attr">[]</span>,d=<span class="hljs-selector-attr">[]</span>,u=u<span class="hljs-selector-class">.RabbitLegacy</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){for(<span class="hljs-selector-tag">var</span> t=this._key<span class="hljs-selector-class">.words</span>,e=this<span class="hljs-selector-class">.cfg</span><span class="hljs-selector-class">.iv</span>,r=this._X=<span class="hljs-selector-attr">[t[0]</span>,t<span class="hljs-selector-attr">[3]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[2]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,t<span class="hljs-selector-attr">[1]</span>,t<span class="hljs-selector-attr">[0]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[3]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,t<span class="hljs-selector-attr">[2]</span>,t<span class="hljs-selector-attr">[1]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,t<span class="hljs-selector-attr">[3]</span>,t<span class="hljs-selector-attr">[2]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[1]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>],<span class="hljs-selector-tag">i</span>=this._C=<span class="hljs-selector-attr">[t[2]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[2]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,<span class="hljs-number">4294901760</span>&amp;t<span class="hljs-selector-attr">[0]</span>|<span class="hljs-number">65535</span>&amp;t<span class="hljs-selector-attr">[1]</span>,t<span class="hljs-selector-attr">[3]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[3]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,<span class="hljs-number">4294901760</span>&amp;t<span class="hljs-selector-attr">[1]</span>|<span class="hljs-number">65535</span>&amp;t<span class="hljs-selector-attr">[2]</span>,t<span class="hljs-selector-attr">[0]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[0]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,<span class="hljs-number">4294901760</span>&amp;t<span class="hljs-selector-attr">[2]</span>|<span class="hljs-number">65535</span>&amp;t<span class="hljs-selector-attr">[3]</span>,t<span class="hljs-selector-attr">[1]</span>&lt;&lt;<span class="hljs-number">16</span>|t<span class="hljs-selector-attr">[1]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>,<span class="hljs-number">4294901760</span>&amp;t<span class="hljs-selector-attr">[3]</span>|<span class="hljs-number">65535</span>&amp;t<span class="hljs-selector-attr">[0]</span>],o=this._b=<span class="hljs-number">0</span>;o&lt;<span class="hljs-number">4</span>;o++)z2<span class="hljs-selector-class">.call</span>(this);for(o=<span class="hljs-number">0</span>;o&lt;<span class="hljs-number">8</span>;o++)<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[o]</span>^=r<span class="hljs-selector-attr">[o+4&amp;7]</span>;if(e){<span class="hljs-selector-tag">var</span> t=e<span class="hljs-selector-class">.words</span>,e=t<span class="hljs-selector-attr">[0]</span>,t=t<span class="hljs-selector-attr">[1]</span>,e=<span class="hljs-number">16711935</span>&amp;(e&lt;&lt;<span class="hljs-number">8</span>|e&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(e&lt;&lt;<span class="hljs-number">24</span>|e&gt;&gt;&gt;<span class="hljs-number">8</span>),t=<span class="hljs-number">16711935</span>&amp;(t&lt;&lt;<span class="hljs-number">8</span>|t&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(t&lt;&lt;<span class="hljs-number">24</span>|t&gt;&gt;&gt;<span class="hljs-number">8</span>),n=e&gt;&gt;&gt;<span class="hljs-number">16</span>|<span class="hljs-number">4294901760</span>&amp;t,s=t&lt;&lt;<span class="hljs-number">16</span>|<span class="hljs-number">65535</span>&amp;e;<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[0]</span>^=e,<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[1]</span>^=n,<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[2]</span>^=t,<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[3]</span>^=s,<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[4]</span>^=e,<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[5]</span>^=n,<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[6]</span>^=t,<span class="hljs-selector-tag">i</span><span class="hljs-selector-attr">[7]</span>^=s;for(o=<span class="hljs-number">0</span>;o&lt;<span class="hljs-number">4</span>;o++)z2<span class="hljs-selector-class">.call</span>(this)}},_doProcessBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=this._X;z2<span class="hljs-selector-class">.call</span>(this),h<span class="hljs-selector-attr">[0]</span>=r<span class="hljs-selector-attr">[0]</span>^r<span class="hljs-selector-attr">[5]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>^r<span class="hljs-selector-attr">[3]</span>&lt;&lt;<span class="hljs-number">16</span>,h<span class="hljs-selector-attr">[1]</span>=r<span class="hljs-selector-attr">[2]</span>^r<span class="hljs-selector-attr">[7]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>^r<span class="hljs-selector-attr">[5]</span>&lt;&lt;<span class="hljs-number">16</span>,h<span class="hljs-selector-attr">[2]</span>=r<span class="hljs-selector-attr">[4]</span>^r<span class="hljs-selector-attr">[1]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>^r<span class="hljs-selector-attr">[7]</span>&lt;&lt;<span class="hljs-number">16</span>,h<span class="hljs-selector-attr">[3]</span>=r<span class="hljs-selector-attr">[6]</span>^r<span class="hljs-selector-attr">[3]</span>&gt;&gt;&gt;<span class="hljs-number">16</span>^r<span class="hljs-selector-attr">[1]</span>&lt;&lt;<span class="hljs-number">16</span>;for(<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;<span class="hljs-number">4</span>;<span class="hljs-selector-tag">i</span>++)h<span class="hljs-selector-attr">[i]</span>=<span class="hljs-number">16711935</span>&amp;(h<span class="hljs-selector-attr">[i]</span>&lt;&lt;<span class="hljs-number">8</span>|h<span class="hljs-selector-attr">[i]</span>&gt;&gt;&gt;<span class="hljs-number">24</span>)|<span class="hljs-number">4278255360</span>&amp;(h<span class="hljs-selector-attr">[i]</span>&lt;&lt;<span class="hljs-number">24</span>|h<span class="hljs-selector-attr">[i]</span>&gt;&gt;&gt;<span class="hljs-number">8</span>),t<span class="hljs-selector-attr">[e+i]</span>^=h<span class="hljs-selector-attr">[i]</span>},blockSize:<span class="hljs-number">4</span>,ivSize:<span class="hljs-number">2</span>}),w<span class="hljs-selector-class">.RabbitLegacy</span>=<span class="hljs-selector-tag">p</span>._createHelper(u);{w=(<span class="hljs-selector-tag">P</span>=<span class="hljs-selector-tag">i</span>)<span class="hljs-selector-class">.lib</span><span class="hljs-selector-class">.BlockCipher</span>,<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.algo</span>;const F=<span class="hljs-number">16</span>,D2=<span class="hljs-selector-attr">[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731]</span>,E2=<span class="hljs-selector-attr">[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]</span>,<span class="hljs-selector-attr">[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]</span>,<span class="hljs-selector-attr">[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]</span>,<span class="hljs-selector-attr">[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]</span>];<span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">H2</span>={pbox:[],sbox:[]};function C2(t,e){<span class="hljs-selector-tag">var</span> r=t<span class="hljs-selector-class">.sbox</span><span class="hljs-selector-attr">[0]</span><span class="hljs-selector-attr">[e&gt;&gt;24&amp;255]</span>+t<span class="hljs-selector-class">.sbox</span><span class="hljs-selector-attr">[1]</span><span class="hljs-selector-attr">[e&gt;&gt;16&amp;255]</span>;return r=(r^=t<span class="hljs-selector-class">.sbox</span><span class="hljs-selector-attr">[2]</span><span class="hljs-selector-attr">[e&gt;&gt;8&amp;255]</span>)+t<span class="hljs-selector-class">.sbox</span><span class="hljs-selector-attr">[3]</span><span class="hljs-selector-attr">[255&amp;e]</span>}function R2(e,t,r){let <span class="hljs-selector-tag">i</span>=t,o=r,n;for(let t=<span class="hljs-number">0</span>;t&lt;F;++t)<span class="hljs-selector-tag">i</span>^=e<span class="hljs-selector-class">.pbox</span><span class="hljs-selector-attr">[t]</span>,o=C2(e,<span class="hljs-selector-tag">i</span>)^o,n=<span class="hljs-selector-tag">i</span>,<span class="hljs-selector-tag">i</span>=o,o=n;return n=<span class="hljs-selector-tag">i</span>,<span class="hljs-selector-tag">i</span>=o,o=n,o^=e<span class="hljs-selector-class">.pbox</span><span class="hljs-selector-attr">[F]</span>,{<span class="hljs-attribute">left</span>:i^=e.pbox[F+<span class="hljs-number">1</span>],right:o}}<span class="hljs-selector-tag">p</span>=<span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.Blowfish</span>=w<span class="hljs-selector-class">.extend</span>({_doReset:<span class="hljs-built_in">function</span>(){if(this._keyPriorReset!==this._key){<span class="hljs-selector-tag">var</span> t=this._keyPriorReset=this._key,n=t<span class="hljs-selector-class">.words</span>,t=t<span class="hljs-selector-class">.sigBytes</span>/<span class="hljs-number">4</span>;{<span class="hljs-selector-tag">var</span> s=<span class="hljs-selector-tag">H2</span>,c=n,<span class="hljs-selector-tag">a</span>=t;for(let e=<span class="hljs-number">0</span>;e&lt;<span class="hljs-number">4</span>;e++){s<span class="hljs-selector-class">.sbox</span><span class="hljs-selector-attr">[e]</span>=<span class="hljs-selector-attr">[]</span>;for(let t=<span class="hljs-number">0</span>;t&lt;<span class="hljs-number">256</span>;t++)s<span class="hljs-selector-class">.sbox</span><span class="hljs-selector-attr">[e]</span><span class="hljs-selector-attr">[t]</span>=E2<span class="hljs-selector-attr">[e]</span><span class="hljs-selector-attr">[t]</span>}let e=<span class="hljs-number">0</span>;for(let t=<span class="hljs-number">0</span>;t&lt;F+<span class="hljs-number">2</span>;t++)s<span class="hljs-selector-class">.pbox</span><span class="hljs-selector-attr">[t]</span>=D2<span class="hljs-selector-attr">[t]</span>^c<span class="hljs-selector-attr">[e]</span>,++e&gt;=<span class="hljs-selector-tag">a</span>&amp;&amp;(e=<span class="hljs-number">0</span>);let r=<span class="hljs-number">0</span>,<span class="hljs-selector-tag">i</span>=<span class="hljs-number">0</span>,o=<span class="hljs-number">0</span>;for(let t=<span class="hljs-number">0</span>;t&lt;F+<span class="hljs-number">2</span>;t+=<span class="hljs-number">2</span>)o=R2(s,r,<span class="hljs-selector-tag">i</span>),r=o<span class="hljs-selector-class">.left</span>,<span class="hljs-selector-tag">i</span>=o<span class="hljs-selector-class">.right</span>,s<span class="hljs-selector-class">.pbox</span><span class="hljs-selector-attr">[t]</span>=r,s<span class="hljs-selector-class">.pbox</span><span class="hljs-selector-attr">[t+1]</span>=<span class="hljs-selector-tag">i</span>;for(let e=<span class="hljs-number">0</span>;e&lt;<span class="hljs-number">4</span>;e++)for(let t=<span class="hljs-number">0</span>;t&lt;<span class="hljs-number">256</span>;t+=<span class="hljs-number">2</span>)o=R2(s,r,<span class="hljs-selector-tag">i</span>),r=o<span class="hljs-selector-class">.left</span>,<span class="hljs-selector-tag">i</span>=o<span class="hljs-selector-class">.right</span>,s<span class="hljs-selector-class">.sbox</span><span class="hljs-selector-attr">[e]</span><span class="hljs-selector-attr">[t]</span>=r,s<span class="hljs-selector-class">.sbox</span><span class="hljs-selector-attr">[e]</span><span class="hljs-selector-attr">[t+1]</span>=<span class="hljs-selector-tag">i</span>}}},encryptBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=R2(<span class="hljs-selector-tag">H2</span>,t<span class="hljs-selector-attr">[e]</span>,t<span class="hljs-selector-attr">[e+1]</span>);t<span class="hljs-selector-attr">[e]</span>=r<span class="hljs-selector-class">.left</span>,t<span class="hljs-selector-attr">[e+1]</span>=r<span class="hljs-selector-class">.right</span>},decryptBlock:<span class="hljs-built_in">function</span>(t,e){<span class="hljs-selector-tag">var</span> r=function(e,t,r){let <span class="hljs-selector-tag">i</span>=t,o=r,n;for(let t=F+<span class="hljs-number">1</span>;<span class="hljs-number">1</span>&lt;t;<span class="hljs-attr">--t</span>)<span class="hljs-selector-tag">i</span>^=e<span class="hljs-selector-class">.pbox</span><span class="hljs-selector-attr">[t]</span>,o=C2(e,<span class="hljs-selector-tag">i</span>)^o,n=<span class="hljs-selector-tag">i</span>,<span class="hljs-selector-tag">i</span>=o,o=n;return n=<span class="hljs-selector-tag">i</span>,<span class="hljs-selector-tag">i</span>=o,o=n,o^=e<span class="hljs-selector-class">.pbox</span><span class="hljs-selector-attr">[1]</span>,{<span class="hljs-attribute">left</span>:i^=e.pbox[<span class="hljs-number">0</span>],right:o}}(<span class="hljs-selector-tag">H2</span>,t<span class="hljs-selector-attr">[e]</span>,t<span class="hljs-selector-attr">[e+1]</span>);t<span class="hljs-selector-attr">[e]</span>=r<span class="hljs-selector-class">.left</span>,t<span class="hljs-selector-attr">[e+1]</span>=r<span class="hljs-selector-class">.right</span>},blockSize:<span class="hljs-number">2</span>,keySize:<span class="hljs-number">4</span>,ivSize:<span class="hljs-number">2</span>}),<span class="hljs-selector-tag">P</span><span class="hljs-selector-class">.Blowfish</span>=w._createHelper(<span class="hljs-selector-tag">p</span>)}return <span class="hljs-selector-tag">i</span>});
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç›‘å¬é¡µé¢å†…å›¾ç‰‡å˜åŒ–</span>
<span class="hljs-comment">// image_lp_logic.js</span>
(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">__lp_injected__</span>)<span class="hljs-keyword">return</span>;<span class="hljs-variable language_">window</span>.<span class="hljs-property">__lp_injected__</span>=!<span class="hljs-number">0</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">AndroidCryptoJS</span>===<span class="hljs-string">'undefined'</span>||!<span class="hljs-title class_">AndroidCryptoJS</span>.<span class="hljs-property">MD5</span>)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">function</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">s</span>){<span class="hljs-keyword">return</span> <span class="hljs-title class_">AndroidCryptoJS</span>.<span class="hljs-title class_">MD5</span>(s).<span class="hljs-title function_">toString</span>()}<span class="hljs-keyword">var</span> md5Cache=<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);<span class="hljs-keyword">function</span> <span class="hljs-title function_">hashedSrc</span>(<span class="hljs-params">src</span>){<span class="hljs-keyword">if</span>(src.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'data:'</span>)){<span class="hljs-keyword">if</span>(md5Cache[src])<span class="hljs-keyword">return</span><span class="hljs-string">'md5:'</span>+md5Cache[src];<span class="hljs-keyword">var</span> h=<span class="hljs-title function_">md5</span>(src);md5Cache[src]=h;<span class="hljs-keyword">return</span><span class="hljs-string">'md5:'</span>+h}<span class="hljs-keyword">return</span> src}<span class="hljs-keyword">function</span> <span class="hljs-title function_">mode</span>(<span class="hljs-params">img</span>){<span class="hljs-keyword">return</span>(img.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-lp'</span>)||<span class="hljs-string">''</span>).<span class="hljs-title function_">toLowerCase</span>()}<span class="hljs-keyword">function</span> <span class="hljs-title function_">currentSrc</span>(<span class="hljs-params">img</span>){<span class="hljs-keyword">return</span> img.<span class="hljs-property">currentSrc</span>||img.<span class="hljs-property">src</span>||<span class="hljs-string">''</span>}<span class="hljs-keyword">function</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">img</span>){<span class="hljs-keyword">if</span>(img.<span class="hljs-property">__lp_registered__</span>)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">var</span> raw=<span class="hljs-title function_">currentSrc</span>(img);<span class="hljs-keyword">if</span>(!raw)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">if</span>(<span class="hljs-title function_">mode</span>(img)===<span class="hljs-string">'native'</span>){<span class="hljs-keyword">var</span> key=<span class="hljs-title function_">hashedSrc</span>(raw);<span class="hljs-keyword">try</span>{<span class="hljs-variable language_">window</span>.<span class="hljs-property">AndroidLp</span>.<span class="hljs-title function_">put</span>(key);img.<span class="hljs-property">__lp_registered__</span>=key}<span class="hljs-keyword">catch</span>(e){}}}<span class="hljs-keyword">function</span> <span class="hljs-title function_">unregister</span>(<span class="hljs-params">img</span>){<span class="hljs-keyword">if</span>(!img.<span class="hljs-property">__lp_registered__</span>)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">try</span>{<span class="hljs-variable language_">window</span>.<span class="hljs-property">AndroidLp</span>.<span class="hljs-title function_">remove</span>(img.<span class="hljs-property">__lp_registered__</span>)}<span class="hljs-keyword">catch</span>(e){}<span class="hljs-keyword">delete</span> img.<span class="hljs-property">__lp_registered__</span>}<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateSrc</span>(<span class="hljs-params">img</span>){<span class="hljs-keyword">if</span>(!img.<span class="hljs-property">__lp_registered__</span>)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">var</span> raw=<span class="hljs-title function_">currentSrc</span>(img);<span class="hljs-keyword">if</span>(!raw){<span class="hljs-title function_">unregister</span>(img);<span class="hljs-keyword">return</span>}<span class="hljs-keyword">var</span> key=<span class="hljs-title function_">hashedSrc</span>(raw);<span class="hljs-keyword">if</span>(key!==img.<span class="hljs-property">__lp_registered__</span>){<span class="hljs-keyword">try</span>{<span class="hljs-variable language_">window</span>.<span class="hljs-property">AndroidLp</span>.<span class="hljs-title function_">update</span>(img.<span class="hljs-property">__lp_registered__</span>,key)}<span class="hljs-keyword">catch</span>(e){}img.<span class="hljs-property">__lp_registered__</span>=key}}<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleModeChange</span>(<span class="hljs-params">img</span>){<span class="hljs-keyword">var</span> m=<span class="hljs-title function_">mode</span>(img);<span class="hljs-keyword">if</span>(m===<span class="hljs-string">'native'</span>){<span class="hljs-title function_">register</span>(img)}<span class="hljs-keyword">else</span>{<span class="hljs-title function_">unregister</span>(img)}}<span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">img</span>){<span class="hljs-keyword">if</span>(img.<span class="hljs-property">__lp_obs__</span>)<span class="hljs-keyword">return</span>;img.<span class="hljs-property">__lp_obs__</span>=!<span class="hljs-number">0</span>;<span class="hljs-keyword">var</span> mo=<span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">muts</span>){muts.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">m</span>){<span class="hljs-keyword">if</span>(m.<span class="hljs-property">type</span>===<span class="hljs-string">'attributes'</span>){<span class="hljs-keyword">if</span>(m.<span class="hljs-property">attributeName</span>===<span class="hljs-string">'src'</span>){<span class="hljs-title function_">updateSrc</span>(img)}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(m.<span class="hljs-property">attributeName</span>===<span class="hljs-string">'data-lp'</span>){<span class="hljs-title function_">handleModeChange</span>(img)}}})});mo.<span class="hljs-title function_">observe</span>(img,{<span class="hljs-attr">attributes</span>:!<span class="hljs-number">0</span>,<span class="hljs-attr">attributeFilter</span>:[<span class="hljs-string">'src'</span>,<span class="hljs-string">'data-lp'</span>]})}<span class="hljs-keyword">function</span> <span class="hljs-title function_">initialScan</span>(<span class="hljs-params"/>){<span class="hljs-keyword">var</span> imgs=<span class="hljs-variable language_">document</span>.<span class="hljs-property">images</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;imgs.<span class="hljs-property">length</span>;i++){<span class="hljs-title function_">register</span>(imgs[i]);<span class="hljs-title function_">observe</span>(imgs[i])}}<span class="hljs-keyword">var</span> rootObs=<span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">muts</span>){muts.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">m</span>){<span class="hljs-keyword">if</span>(m.<span class="hljs-property">type</span>===<span class="hljs-string">'childList'</span>){m.<span class="hljs-property">addedNodes</span>&amp;&amp;m.<span class="hljs-property">addedNodes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">n</span>){<span class="hljs-keyword">if</span>(n.<span class="hljs-property">tagName</span>===<span class="hljs-string">'IMG'</span>){<span class="hljs-title function_">register</span>(n);<span class="hljs-title function_">observe</span>(n)}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(n.<span class="hljs-property">querySelectorAll</span>){n.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'img'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">img</span>){<span class="hljs-title function_">register</span>(img);<span class="hljs-title function_">observe</span>(img)})}});m.<span class="hljs-property">removedNodes</span>&amp;&amp;m.<span class="hljs-property">removedNodes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">n</span>){<span class="hljs-keyword">if</span>(n.<span class="hljs-property">tagName</span>===<span class="hljs-string">'IMG'</span>){<span class="hljs-title function_">unregister</span>(n)}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(n.<span class="hljs-property">querySelectorAll</span>){n.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'img'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">img</span>){<span class="hljs-title function_">unregister</span>(img)})}})}})});rootObs.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>,{<span class="hljs-attr">childList</span>:!<span class="hljs-number">0</span>,<span class="hljs-attr">subtree</span>:!<span class="hljs-number">0</span>});<span class="hljs-keyword">function</span> <span class="hljs-title function_">ready</span>(<span class="hljs-params">fn</span>){<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span>===<span class="hljs-string">'interactive'</span>||<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span>===<span class="hljs-string">'complete'</span>){<span class="hljs-title function_">fn</span>()}<span class="hljs-keyword">else</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>,fn)}<span class="hljs-title function_">ready</span>(initialScan)})();
</code></pre>
<h3 data-id="heading-8">2. JS ä¾§é€»è¾‘ (<code>image_lp_logic.js</code>)</h3>
<p>JS ä¾§ä¸»è¦å®Œæˆä»¥ä¸‹å·¥ä½œï¼š</p>
<ol>
<li>
<p><strong>DOM ç›‘å¬ï¼š</strong> ä½¿ç”¨ <code>MutationObserver</code> æˆ–åœ¨ DOM Ready åéå†ï¼ŒæŸ¥æ‰¾å¸¦æœ‰ <code>data-lp='native'</code> å±æ€§çš„ <code>&lt;img&gt;</code> å…ƒç´ ã€‚</p>
</li>
<li>
<p><strong>Key ç”Ÿæˆï¼š</strong></p>
<ul>
<li>å¦‚æœæ˜¯æ™®é€š URLï¼Œç›´æ¥ä½¿ç”¨ <code>img.src</code>ã€‚</li>
<li>å¦‚æœæ˜¯ Data URIï¼Œåˆ™ä½¿ç”¨æ³¨å…¥çš„ <strong><code>crypto-js</code></strong> åº“è®¡ç®—å…¶å†…å®¹çš„ MD5 æ‘˜è¦ï¼Œå¹¶æ‹¼æ¥æˆ <code>md5:&lt;digest&gt;</code> æ ¼å¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ³¨å†Œ/æ›´æ–°ï¼š</strong> è°ƒç”¨ Native æ³¨å†Œæ–¹æ³•ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">// JS ä¾§ç¤ºä¾‹è°ƒç”¨
const <span class="hljs-attr">key</span> = isDataUri ? <span class="hljs-string">'md5:'</span> + CryptoJS.MD5(img.src).toString() : img.src<span class="hljs-comment">;</span>
window.AndroidLp.put(key)<span class="hljs-comment">;</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-9">3. Native ä¾§é•¿æŒ‰åˆ†å‘</h3>
<p>å½“åŸç”Ÿç«¯æ•è·åˆ°é•¿æŒ‰äº‹ä»¶æ—¶ï¼ˆä¾‹å¦‚é€šè¿‡ <code>WebView.HitTestResult</code> è·å–åˆ°å›¾ç‰‡ URL <code>src</code>ï¼‰ï¼Œç«‹å³æ‰§è¡Œåˆ¤æ–­ï¼š</p>
<p>Kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin">setOnLongClickListener {
  <span class="hljs-keyword">val</span> hitTestResult = hitTestResult
  <span class="hljs-keyword">if</span> (hitTestResult.type == WebView.HitTestResult.IMAGE_TYPE ||
    hitTestResult.type == WebView.HitTestResult.SRC_IMAGE_ANCHOR_TYPE
  ) {
    <span class="hljs-keyword">val</span> extra = hitTestResult.extra
    <span class="hljs-keyword">val</span> mode = lpHandler.imageLpRegistry?.<span class="hljs-keyword">get</span>(extra) ?: <span class="hljs-string">""</span>

    <span class="hljs-keyword">if</span> (mode == <span class="hljs-string">"native"</span>) {
      showNativeImageMenu(extra)
      <span class="hljs-keyword">return</span><span class="hljs-symbol">@setOnLongClickListener</span> <span class="hljs-literal">true</span> <span class="hljs-comment">// æ¶ˆè€—äº‹ä»¶</span>
    }
  }
  <span class="hljs-keyword">return</span><span class="hljs-symbol">@setOnLongClickListener</span> <span class="hljs-literal">false</span> <span class="hljs-comment">// ä¸å¤„ç†ï¼Œè®© WebView æ‰§è¡Œé»˜è®¤è¡Œä¸º</span>
}
</code></pre>
<h2 data-id="heading-10">æ€»ç»“</h2>
<p>é€šè¿‡å¼•å…¥ <strong><code>ImageLpRegistry</code></strong> å’Œ <strong>MD5 è§„èŒƒåŒ– Key</strong>ï¼Œè¿™é‡Œæ„å»ºäº†ä¸€ä¸ªWebView å›¾ç‰‡é•¿æŒ‰äº‹ä»¶åˆ†å‘æœºåˆ¶ï¼š</p>
<ul>
<li>âœ… <strong>æ€§èƒ½ä¼˜åŒ–ï¼š</strong> é¿å…åœ¨ Native/JS ä¹‹é—´ä¼ è¾“å’Œå­˜å‚¨è¶…é•¿çš„ Data URI å­—ç¬¦ä¸²ã€‚</li>
<li>âœ… <strong>é€»è¾‘åˆ†ç¦»ï¼š</strong> JS è´Ÿè´£ Key çš„ç”Ÿæˆå’Œæ³¨å†Œï¼ŒNative è´Ÿè´£ Key çš„å­˜å‚¨å’ŒæŸ¥è¯¢ï¼ŒèŒè´£æ¸…æ™°ã€‚</li>
<li>âœ… <strong>çº¿ç¨‹å®‰å…¨ï¼š</strong> <code>ConcurrentHashMap</code> ç¡®ä¿äº†è·¨çº¿ç¨‹è°ƒç”¨çš„å¯é æ€§ã€‚</li>
</ul>
<p>è¿™å¥—æœºåˆ¶æå¤§åœ°æå‡äº†å¤„ç† Data URI å›¾ç‰‡çš„æ•ˆç‡ï¼Œä¸º WebView çš„å›¾ç‰‡é•¿æŒ‰ä½“éªŒæä¾›äº†çµæ´»ä¸”å¯é çš„ Native å¢å¼ºèƒ½åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§éƒ¨åˆ†äººéƒ½é”™äº†ï¼è¿™æ‰æ˜¯chromeæ’ä»¶å¤šè„šæœ¬é€šä¿¡çš„æ­£ç¡®å§¿åŠ¿]]></title>    <link>https://juejin.cn/post/7573521516324732955</link>    <guid>https://juejin.cn/post/7573521516324732955</guid>    <pubDate>2025-11-18T00:06:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573521516324732955" data-draft-id="7572481101711097910" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§éƒ¨åˆ†äººéƒ½é”™äº†ï¼è¿™æ‰æ˜¯chromeæ’ä»¶å¤šè„šæœ¬é€šä¿¡çš„æ­£ç¡®å§¿åŠ¿"/> <meta itemprop="keywords" content="å‰ç«¯,æµè§ˆå™¨,JavaScript"/> <meta itemprop="datePublished" content="2025-11-18T00:06:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¸€æ ·çš„å°‘å¹´_"/> <meta itemprop="url" content="https://juejin.cn/user/3035079961218551"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§éƒ¨åˆ†äººéƒ½é”™äº†ï¼è¿™æ‰æ˜¯chromeæ’ä»¶å¤šè„šæœ¬é€šä¿¡çš„æ­£ç¡®å§¿åŠ¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3035079961218551/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¸€æ ·çš„å°‘å¹´_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:06:38.000Z" title="Tue Nov 18 2025 00:06:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    14
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ˜¨å¤©ä¸€ä¸ªå®ä¹ ç”ŸåŒäº‹æ¥æ‰¾æˆ‘ï¼šâ€œå“¥ä»¬ï¼Œæˆ‘çš„Chromeæ’ä»¶é‡åˆ°ä¸ªå¥‡æ€ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆæˆ‘æ’å…¥åˆ°é¡µé¢çš„å†…å®¹è„šæœ¬content.jsï¼Œé‡å†™é¡µé¢è„šæœ¬çš„æ–¹æ³•æ²¡æœ‰ç”Ÿæ•ˆï¼Ÿâ€</p>
<p>å…¶å®ç±»ä¼¼çš„é—®é¢˜æˆ‘ä¹Ÿç»å¸¸ç¢°åˆ°ï¼Œæ¯”å¦‚ï¼šâ€œä¸ºä»€ä¹ˆpopupé¡µé¢è°ƒç”¨ä¸äº†content.jsçš„å‡½æ•°ï¼Ÿâ€ã€â€œæ’å…¥åˆ°é¡µé¢çš„å†…å®¹è„šæœ¬ä¸ºå•¥è®¿é—®ä¸åˆ°Vueå®ä¾‹ï¼Ÿâ€ã€â€œbackgroundè„šæœ¬ä¸ºå•¥ä¸èƒ½è®¿é—®é¡µé¢çš„domèŠ‚ç‚¹â€?â€¦â€¦â€¦è¿™äº›é—®é¢˜åœ¨æ’ä»¶å¼€å‘é‡ŒçœŸçš„æŒºå¸¸è§çš„ï¼Œå¤§å®¶éƒ½å®¹æ˜“è¸©å‘ã€‚</p>
<p>æ‰€ä»¥ä»Šå¤©ï¼Œæˆ‘æƒ³ç”¨æœ€é€šä¿—çš„æ–¹å¼ï¼ŒæŠŠè‡ªå·±é‡åˆ°çš„é—®é¢˜å’Œä¸€äº›å°ç»éªŒåˆ†äº«å‡ºæ¥ï¼š</p>
<ul>
<li>ä¸ºä»€ä¹ˆChromeè¦æŠŠæ’ä»¶åˆ†æˆè¿™ä¹ˆå¤šè„šæœ¬ï¼Ÿå®ƒä»¬ä¹‹é—´åˆ°åº•å•¥å…³ç³»ï¼Ÿ</li>
<li>é‚£äº›â€œçœ‹èµ·æ¥åº”è¯¥èƒ½ç”¨ï¼Œä½†å°±æ˜¯ä¸è¡Œâ€çš„é€šä¿¡æ–¹å¼ï¼ŒèƒŒåçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>æ€ä¹ˆè®©æ’ä»¶çš„å„ä¸ªéƒ¨åˆ†é…åˆå¾—æ›´é¡ºç•…ï¼Ÿ</li>
</ul>
<p>æ”¾å¿ƒï¼Œæ²¡æœ‰å¤æ‚çš„æœ¯è¯­ï¼Œç”¨å›¾è§£çš„æ–¹å¼æ¥æ¢³ç†è„‰ç»œï¼Œå¸Œæœ›è¿™äº›å†…å®¹èƒ½å¸®åˆ°å¤§å®¶ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶ä¸€èµ·äº¤æµï¼</p>
</blockquote>
<h3 data-id="heading-0">å‰ç½®çŸ¥è¯†ï¼š</h3>
<p>è¦ææ‡‚æ’ä»¶é€šä¿¡ï¼Œé¦–å…ˆå¾—äº†è§£æµè§ˆå™¨çš„æ¶æ„ã€‚ç°åœ¨çš„ Chrome æµè§ˆå™¨é‡‡ç”¨çš„æ˜¯â€œå¤šè¿›ç¨‹æ¶æ„â€ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿç›´æ¥çœ‹å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef2bd5d3aa8b482ab9bbdb857454ceef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764030308&amp;x-signature=7yzcvj7a%2Fjb7HV2lR4B5yKQD2Yg%3D" alt="" loading="lazy"/></p>
<p>ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬æµè§ˆå™¨æ¶æ„æ˜¯ç”±ã€æ¸²æŸ“è¿›ç¨‹ã€æ’ä»¶è¿›ç¨‹ã€ç½‘è·¯è¿›ç¨‹ã€æµè§ˆå™¨ä¸»è¿›ç¨‹ã€gpuè¿›ç¨‹ç­‰ç»„æˆçš„</p>
<ul>
<li>
<p><code>æµè§ˆå™¨ä¸»è¿›ç¨‹</code>: ç›¸å½“äºå…¬å¸çš„å¤§è€æ¿ï¼Œè´Ÿè´£æ•´ä¸ªå…¬å¸çš„è¿è½¬ã€‚æ¯”å¦‚ä½ è¦å¼€æ–°çª—å£ã€åˆ‡æ¢æ ‡ç­¾ã€ä¸‹è½½æ–‡ä»¶ã€å¼¹å‡ºæƒé™æç¤ºï¼Œéƒ½æ˜¯æµè§ˆå™¨ä¸»è¿›ç¨‹å®‰æ’çš„ã€‚</p>
<p>å…¶ä»–è¿›ç¨‹æœ‰å•¥äº‹ä¹Ÿéƒ½å¾—è·Ÿä¸»è¿›ç¨‹æŠ¥å¤‡ï¼Œä¸»è¿›ç¨‹æ¥è°ƒåº¦ã€‚</p>
</li>
<li>
<p><code>æ¸²æŸ“è¿›ç¨‹</code>ï¼šå¹³æ—¶æˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€çš„æ¯ä¸€ä¸ªç½‘é¡µï¼Œéƒ½æ˜¯ç”±æ¸²æŸ“è¿›ç¨‹è¿›è¡Œæ¸²æŸ“çš„ã€‚æ’ä»¶æ³¨å…¥çš„å†…å®¹è„šæœ¬ä¹Ÿåœ¨è¿™é‡Œè¿è¡Œï¼Œä¸è¿‡å¤„äºâ€œéš”ç¦»ä¸–ç•Œâ€ï¼Œä¸é¡µé¢è„šæœ¬ç›¸äº’éš”ç¦»ï¼Œè¿™ä¸ªåé¢æˆ‘ä»¬ä¼šè¯¦ç»†è®²</p>
</li>
<li>
<p><code>ç½‘ç»œè¿›ç¨‹</code>ï¼šå¤„ç†æ‰€æœ‰é¡µé¢ä¸æ‰©å±•çš„è¯·æ±‚ï¼Œæˆ‘ä»¬ç½‘é¡µä¸­æˆ–è€…æ’ä»¶ä¸­çš„æ¥å£è¯·æ±‚è¿™ç§è„æ´»ç´¯æ´»éƒ½ç”±å®ƒæ¥å¹²</p>
</li>
<li>
<p><code>GPUè¿›ç¨‹</code>ï¼šç½‘é¡µä¸­æœ‰ç‚«é…·åŠ¨ç”»ã€è§†é¢‘ã€3Dæ•ˆæœå•¥çš„ï¼ŒGPUè¿›ç¨‹å°±ä¼šå¸®ä½ ç”»çš„åˆå¿«åˆæ¼‚äº®ã€‚</p>
</li>
<li>
<p><code>æ’ä»¶è¿›ç¨‹</code>ï¼šè¿è¡Œæˆ‘ä»¬å¹³æ—¶æ‰€è£…çš„æµè§ˆå™¨æ’ä»¶ï¼Œæˆ‘ä»¬è£…çš„ä¸åŒçš„æ’ä»¶éƒ½ä¼šåˆ†é…åˆ°ä¸åŒçš„æ’ä»¶è¿›ç¨‹ä¸­ï¼Œäº’ä¸å¹²æ‰°ï¼Œè°å®¶æ’ä»¶å‡ºäº†é—®é¢˜ï¼Œæœ€å¤šè‡ªå·±å´©ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–æ’ä»¶å’Œé¡µé¢çš„è¿è¡Œ</p>
</li>
</ul>
<p>Chrome æµè§ˆå™¨å…¶å®å°±æ˜¯æŠŠå„ç§å·¥ä½œåˆ†å¼€æ¥åšï¼Œè°è´Ÿè´£å•¥éƒ½å¾ˆæ¸…æ¥šã€‚<code>ä¸»è¿›ç¨‹</code>ç®¡å¤§å±€ï¼Œ<code>æ¸²æŸ“è¿›</code>ç¨‹è´Ÿè´£æŠŠç½‘é¡µå†…å®¹å±•ç¤ºå‡ºæ¥ï¼Œ<code>ç½‘ç»œè¿›ç¨‹</code>ä¸“é—¨ææ•°æ®ä¼ è¾“ï¼Œ<code>GPUè¿›ç¨‹</code>è®©åŠ¨ç”»å’Œè§†é¢‘æ›´æµç•…ï¼Œ<code>æ’ä»¶è¿›ç¨‹</code>åˆ™è®©ä½ è£…çš„å„ç§æ‰©å±•å„è‡ªç‹¬ç«‹è¿è¡Œã€‚å¤§å®¶å„å¹²å„çš„ï¼Œäº’ä¸å½±å“ï¼Œè¿™æ ·æµè§ˆå™¨ç”¨èµ·æ¥æ‰åˆå¿«åˆç¨³è¿˜å®‰å…¨ã€‚</p>
<h3 data-id="heading-1">æ’ä»¶å„éƒ¨åˆ†çš„è§’è‰²ä¸èƒ½åŠ›</h3>
<p><a href="https://juejin.cn/column/7548643621609193482" target="_blank" title="https://juejin.cn/column/7548643621609193482">æµè§ˆå™¨æ’ä»¶å¼€å‘å®è·µ - ä¸ä¸€æ ·çš„å°‘å¹´_çš„ä¸“æ  - æ˜é‡‘</a></p>
<p>å¤§å®¶çœ‹åˆ°æˆ‘çš„æ’ä»¶ä¸“æ é‡Œçš„æ’ä»¶ç›®å½•ï¼Œå¤§è‡´æ˜¯è¿™æ ·ï¼š</p>
<pre><code class="hljs language-js" lang="js">demo
â”œâ”€â”€ manifest.<span class="hljs-property">json</span> # æ‰©å±•çš„<span class="hljs-string">"èº«ä»½è¯"</span>
â”œâ”€â”€ background.<span class="hljs-property">js</span> # æ’ä»¶åå°è„šæœ¬
â”œâ”€â”€ injected.<span class="hljs-property">js</span> # æ³¨å…¥é¡µé¢è„šæœ¬
â”œâ”€â”€ content.<span class="hljs-property">js</span> # å†…å®¹è„šæœ¬
â””â”€â”€ popup.<span class="hljs-property">html</span> # å¼¹çª—é¡µé¢
</code></pre>
<p>æˆ‘ä»¬æ¥ç®€å•èŠèŠæ¯ä¸ªæ–‡ä»¶çš„ä½œç”¨ï¼š</p>
<h4 data-id="heading-2">manifest.json â€”â€” æ’ä»¶çš„â€œèº«ä»½è¯â€</h4>
<p>è¿™ä¸ªæ–‡ä»¶å°±åƒæ’ä»¶çš„èº«ä»½è¯ï¼Œé‡Œé¢å†™æ˜äº†æ’ä»¶çš„åå­—ã€ç‰ˆæœ¬ã€æƒé™ã€å„ä¸ªè„šæœ¬çš„å…¥å£ã€‚æ¯”å¦‚ä½ è¿™ä¸ªæ’ä»¶æ˜¯å¼¹çª—ç±»å‹ï¼Œè¿˜æ˜¯éœ€è¦å†…å®¹è„šæœ¬ã€åå°è„šæœ¬ï¼Œéƒ½è¦åœ¨è¿™é‡Œå£°æ˜æ¸…æ¥šã€‚æ²¡æœ‰å®ƒï¼Œæµè§ˆå™¨éƒ½ä¸è®¤ä½ è¿™ä¸ªæ’ä»¶ã€‚</p>
<h4 data-id="heading-3">popup.html â€”â€” å¼¹çª—é¡µé¢</h4>
<p>è¿™ä¸ªæ–‡ä»¶å°±æ˜¯ä½ ç‚¹æµè§ˆå™¨å³ä¸Šè§’æ’ä»¶å›¾æ ‡å¼¹å‡ºæ¥çš„å°çª—å£ã€‚å†™æ³•è·Ÿæ™®é€šç½‘é¡µä¸€æ ·ï¼Œå¯ä»¥æ”¾æŒ‰é’®ã€è¾“å…¥æ¡†ã€ç»“æœå±•ç¤ºåŒºã€‚</p>
<p>å¦‚ä¸‹çº¢è‰²æ¡†ä½çš„å°±æ˜¯popupé¡µé¢ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/903ab19c88c74d078203bb1649f097ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764030308&amp;x-signature=ieAxHX%2Bg9XMG0Ddukiq4QXQ5BQw%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªpopupé¡µé¢ï¼Œæµè§ˆå™¨ä¼šåˆ†é…ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹æ¥è¿›è¡Œæ¸²æŸ“ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9021eb9b881c4d8cbc75bf3718accc39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764030308&amp;x-signature=7kKDVAg%2B30Si0NFY6H7TG1h83hc%3D" alt="" width="70%" loading="lazy"/>
<h4 data-id="heading-4">background.js â€”â€” åå°è„šæœ¬</h4>
<p>åå°è„šæœ¬æ˜¯æ’ä»¶çš„å¤§è„‘ï¼Œè´Ÿè´£å¤„ç†å„ç§â€œåå°ä»»åŠ¡â€ã€‚æ¯”å¦‚ç›‘å¬æ¶ˆæ¯ã€å’ŒæœåŠ¡å™¨é€šä¿¡ã€ç®¡ç†æ•°æ®ã€‚å®ƒä¸ç›´æ¥æ“ä½œé¡µé¢å†…å®¹ï¼Œä½†èƒ½å¸®ä½ åšå¾ˆå¤šâ€œè„æ´»ç´¯æ´»â€ï¼Œæ¯”å¦‚è·¨åŸŸè¯·æ±‚ã€å®šæ—¶ä»»åŠ¡ã€æƒé™æ§åˆ¶ã€‚å¼¹çª—é¡µé¢ã€å†…å®¹è„šæœ¬éƒ½å¯ä»¥å’Œå®ƒå‘æ¶ˆæ¯ï¼Œè®©å®ƒå¸®å¿™å¹²æ´»ã€‚</p>
<p>è¿™ä¸ªåå°è„šæœ¬ï¼Œæµè§ˆå™¨ä¼šå¼€ä¸€ä¸ªservice workeræœåŠ¡è¿›ç¨‹æ¥è¿è¡Œï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8eb0c1e3ccac481b894a0accd1bfb9c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764030308&amp;x-signature=oxLS2mtX4iK69PkiEr4EYik3Odc%3D" alt="" width="70%" loading="lazy"/>
<p><strong>ä¸¾ä¾‹</strong>ï¼š <code>popupé¡µé¢å’Œæ’ä»¶åå°çš„é€šä¿¡</code></p>
<p>æ¯”å¦‚ä½ åšäº†ä¸€ä¸ªâ€œå¤©æ°”æŸ¥è¯¢â€æ’ä»¶ï¼Œç”¨æˆ·åœ¨å¼¹çª—é¡µé¢è¾“å…¥åŸå¸‚åï¼Œç‚¹å‡»â€œæŸ¥è¯¢â€æŒ‰é’®ï¼Œå¼¹çª—é¡µé¢å°±ä¼šé€šè¿‡ chrome.runtime.sendMessage æŠŠåŸå¸‚åå‘ç»™åå°è„šæœ¬ï¼Œåå°è„šæœ¬æ”¶åˆ°åå»è¯·æ±‚å¤©æ°”æ¥å£ï¼Œç„¶åæŠŠç»“æœè¿”å›ç»™å¼¹çª—é¡µé¢æ˜¾ç¤ºã€‚</p>
<p><code>å›¾è§£</code>ï¼š</p>
<ul>
<li>
<p>ç”¨æˆ·æ“ä½œ popup é¡µé¢</p>
</li>
<li>
<p>popup é¡µé¢ç”¨ chrome.runtime.sendMessage å‘æ¶ˆæ¯ç»™åå°è„šæœ¬</p>
</li>
<li>
<p>åå°è„šæœ¬å¤„ç†è¯·æ±‚ï¼Œè¿”å›ç»“æœç»™ popup é¡µé¢</p>
</li>
</ul>
<p>è™½ç„¶éƒ½popupé¡µé¢å’Œservice workerå±äºåŒä¸€ä¸ªæ‰©å±•ï¼Œä½†å®ƒä»¬è¿è¡Œåœ¨ä¸åŒè¿›ç¨‹/æ²™ç®±ä¸­ï¼Œæ— æ³•ç›´æ¥å…±äº«å†…å­˜æˆ–è°ƒç”¨å‡½æ•°ï¼Œå¿…é¡»é€šè¿‡æµè§ˆå™¨ä¸»è¿›ç¨‹çš„æ¶ˆæ¯è·¯ç”±ï¼ˆIPCï¼‰ä¸­è½¬ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/444bdaa4c84048a6b4e93ca0c366757e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764030308&amp;x-signature=DLOsh8XJPpFdUfR7Pul5dhEeaYU%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬æ‰“å¼€chromeçš„ä»»åŠ¡ç®¡ç†å™¨çœ‹ä¸€ä¸ªæ’ä»¶ï¼Œå¯ä»¥çœ‹å‡ºservice workerå’Œpopupåˆ†åˆ«åœ¨ä¸¤ä¸ªè¿›ç¨‹ä¸­è¿è¡Œï¼Œå¦‚ä¸‹å›¾ï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16e2c6d77b0f48ddbd2d44dccd26b671~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764030308&amp;x-signature=5naYwG9g0KItupj50%2BBN9Pa27Q0%3D" alt="image.png" loading="lazy"/></p>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<p><code>popup.htm</code>l</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"city"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"åŸå¸‚å"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn"</span>&gt;</span>æŸ¥å¤©æ°”<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"result"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'btn'</span>)
      btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> city = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'city'</span>).<span class="hljs-property">value</span>;
        <span class="hljs-comment">// popupå‘background.jså‘é€æŸ¥è¯¢æ¶ˆæ¯</span>
        chrome.<span class="hljs-property">runtime</span>.<span class="hljs-title function_">sendMessage</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'getWeather'</span>, city }, <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) {
            <span class="hljs-comment">// background.jsè¿”å›çš„æ¶ˆæ¯</span>
          <span class="hljs-keyword">const</span> data =  response.<span class="hljs-property">weather</span> 
          <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'result'</span>).<span class="hljs-property">textContent</span> = data || <span class="hljs-string">'æŸ¥è¯¢å¤±è´¥'</span>;
        });
      };
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><code>background.js</code></p>
<pre><code class="hljs language-js" lang="js">chrome.<span class="hljs-property">runtime</span>.<span class="hljs-property">onMessage</span>.<span class="hljs-title function_">addListener</span>(<span class="hljs-function">(<span class="hljs-params">msg, sender, sendResponse</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (msg.<span class="hljs-property">type</span> === <span class="hljs-string">'getWeather'</span>) {
    <span class="hljs-comment">// è¿™é‡Œåªåšæ¼”ç¤ºï¼Œå®é™…å¼€å‘å¯ä»¥ç”¨ fetch å»è¯·æ±‚çœŸå®æ¥å£</span>
    <span class="hljs-keyword">const</span> fakeWeather = <span class="hljs-string">`<span class="hljs-subst">${msg.city}</span>ï¼šæ™´ï¼Œ25Â°C`</span>;
    <span class="hljs-title function_">sendResponse</span>({ <span class="hljs-attr">weather</span>: fakeWeather });
    <span class="hljs-comment">// å¦‚æœæ˜¯å¼‚æ­¥æ“ä½œï¼ˆæ¯”å¦‚ fetchï¼‰ï¼Œéœ€è¦ return true</span>
  }
});
</code></pre>
<p>è¿™æ ·ï¼Œå¼¹çª—é¡µé¢å’Œåå°è„šæœ¬å°±èƒ½é€šè¿‡æ¶ˆæ¯æœºåˆ¶å®ç°é€šä¿¡ï¼Œå¼¹çª—é¡µé¢åªè´Ÿè´£æ”¶é›†ç”¨æˆ·è¾“å…¥å’Œå±•ç¤ºç»“æœï¼Œåå°è„šæœ¬è´Ÿè´£å¤„ç†æ•°æ®å’Œä¸šåŠ¡é€»è¾‘ï¼Œåˆ†å·¥æ˜ç¡®ï¼Œå¼€å‘èµ·æ¥ä¹Ÿå¾ˆæ¸…æ™°ï¼</p>
<h4 data-id="heading-5">content.js â€”â€” å†…å®¹è„šæœ¬</h4>
<p>å†…å®¹è„šæœ¬æ˜¯æ’ä»¶æ´¾åˆ°ç½‘é¡µé‡Œçš„â€œå§åº•â€ï¼Œæ‰€ä»¥è¿™ä¸ªcontent.jsæ˜¯åœ¨é¡µé¢çš„æ¸²æŸ“è¿›ç¨‹ä¸­è¿è¡Œçš„ï¼Œä¸æ˜¯åœ¨æ’ä»¶ä¸­è¿è¡Œçš„</p>
<p>æˆ‘ä»¬ç”»ä¸ªå›¾æ¥è§£é‡Šä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/795107b9fbfb4fed82e87c49023499c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764030308&amp;x-signature=G6bvhyGv%2FXAqgAM5K3mh6XL%2FmWk%3D" alt="" loading="lazy"/></p>
<p>å½“æˆ‘ä»¬ç”¨æµè§ˆå™¨æ‰“å¼€æ˜é‡‘ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨ä¼šå¯åŠ¨ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹æ¥è´Ÿè´£é¡µé¢çš„å±•ç¤ºã€‚æ˜é‡‘ç½‘ç«™è‡ªå·±çš„ JS å˜é‡å’Œè¿è¡Œç¯å¢ƒéƒ½åœ¨ Main Worldï¼ˆé¡µé¢è„šæœ¬ç¯å¢ƒï¼‰é‡Œï¼Œæ¯”å¦‚ä½ ç”¨ React/Vue å†™çš„ä»£ç ã€window ä¸ŠæŒ‚çš„å˜é‡ï¼Œéƒ½æ˜¯å±äºè¿™ä¸ªä¸–ç•Œã€‚</p>
<p>å¦‚æœä½ è¿™æ—¶å€™è£…äº†ä¸€ä¸ªæŠ¤çœ¼æ’ä»¶ï¼Œæƒ³è®©é¡µé¢å˜æˆæŠ¤çœ¼æ¨¡å¼ï¼ˆæ¯”å¦‚æŠŠèƒŒæ™¯è‰²è°ƒæˆç»¿è‰²ï¼‰ï¼Œæ’ä»¶ä¼šé€šè¿‡å†…å®¹è„šæœ¬æ¥æ“ä½œé¡µé¢çš„ DOMï¼Œæ¯”å¦‚ç›´æ¥ä¿®æ”¹ body çš„æ ·å¼ã€‚è¿™æ®µå†…å®¹è„šæœ¬å…¶å®æ˜¯åœ¨å¦ä¸€ä¸ªç‹¬ç«‹çš„ JS ç¯å¢ƒé‡Œè¿è¡Œï¼Œä¹Ÿå°±æ˜¯å›¾é‡Œçš„ Isolated Worldï¼ˆå†…å®¹è„šæœ¬ç¯å¢ƒï¼‰ã€‚</p>
<p>è™½ç„¶å†…å®¹è„šæœ¬å’Œé¡µé¢è„šæœ¬çš„æ‰§è¡Œç¯å¢ƒæ˜¯éš”ç¦»å¼€çš„ï¼Œäº’ç›¸è®¿é—®ä¸åˆ°å¯¹æ–¹çš„å˜é‡ï¼Œä½†å®ƒä»¬å¯ä»¥ä¸€èµ·æ“ä½œå’Œå…±äº«é¡µé¢ä¸Šçš„ DOMï¼ˆæ¯”å¦‚ document.bodyï¼‰ï¼Œæ‰€ä»¥å†…å®¹è„šæœ¬èƒ½å¸®ä½ æ”¹é¡µé¢æ ·å¼ã€åŠ æŒ‰é’®ã€å¼¹æç¤ºï¼Œä½†æ²¡æ³•ç›´æ¥æ‹¿åˆ°é¡µé¢é‡Œçš„ JS å˜é‡ã€‚å¦‚æœå†…å®¹è„šæœ¬çœŸè¦å’Œé¡µé¢è„šæœ¬é€šä¿¡ï¼Œå¯ä»¥ç”¨ window.postMessage è¿™ç§æ–¹å¼æ¥â€œæ­æ¡¥â€ã€‚</p>
<p>è¿™æ ·è®¾è®¡æ—¢ä¿è¯äº†å®‰å…¨ï¼Œåˆèƒ½è®©æ’ä»¶çµæ´»åœ°æ‰©å±•é¡µé¢åŠŸèƒ½ã€‚</p>
<h5 data-id="heading-6">å†…å®¹è„šæœ¬æ˜¯æ€ä¹ˆè¿›åˆ°é¡µé¢é‡Œçš„å‘¢ï¼Ÿ</h5>
<p>å†…å®¹è„šæœ¬æ˜¯æ’ä»¶æ´¾åˆ°ç½‘é¡µé‡Œçš„â€œå§åº•â€ï¼Œå…¶å®å®ƒçš„â€œå§åº•â€è¿‡ç¨‹ä¹Ÿæ˜¯æœ‰è®²ç©¶çš„ï¼š</p>
<p>æœ‰ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€ç§æ˜¯å£°æ˜å¼çš„ï¼Œå¦ä¸€ç§æ˜¯ç¼–ç¨‹å¼çš„</p>
<h6 data-id="heading-7">å£°æ˜å¼ï¼š</h6>
<p>æµè§ˆå™¨æ ¹æ®æ’ä»¶çš„ manifest.json é…ç½®ï¼Œè‡ªåŠ¨å¸®ä½ æ³¨å…¥åˆ°æŒ‡å®šç½‘é¡µçš„æ¸²æŸ“è¿›ç¨‹é‡Œã€‚ æ¯”å¦‚ä½ åœ¨ manifest.json é‡Œå†™äº†ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"content_scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"matches"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"https://juejin.cn/*"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"js"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"content.js"</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span>
</code></pre>
<p>åªè¦ä½ æ‰“å¼€æ˜é‡‘ç½‘ç«™ï¼Œæµè§ˆå™¨å°±ä¼šè‡ªåŠ¨æŠŠ content.js æ³¨å…¥åˆ°é¡µé¢çš„æ¸²æŸ“è¿›ç¨‹é‡Œï¼Œè®©å®ƒåœ¨ Isolated Worldï¼ˆéš”ç¦»ç¯å¢ƒï¼‰é‡Œè¿è¡Œã€‚</p>
<h6 data-id="heading-8">ç¼–ç¨‹å¼ï¼ˆæŒ‰éœ€æ³¨å…¥ï¼‰</h6>
<p>è¿™é‡Œæœ‰ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µï¼š æµè§ˆå™¨é‡Œä¸åŒè¿›ç¨‹ä¹‹é—´ï¼ˆæ¯”å¦‚ä¸»è¿›ç¨‹ã€æ¸²æŸ“è¿›ç¨‹ã€æ’ä»¶è¿›ç¨‹ï¼‰è¦äº’ç›¸ä¼ é€’æ¶ˆæ¯ï¼Œé çš„å°±æ˜¯ IPCï¼ˆInter-Process Communicationï¼‰æœºåˆ¶ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯â€œè¿›ç¨‹é—´é€šä¿¡â€ã€‚</p>
<ul>
<li>
<p>æ¯”å¦‚ä½ åœ¨åå°è„šæœ¬ï¼ˆbackground.jsï¼‰æˆ–å¼¹çª—é¡µé¢ï¼ˆpopupï¼‰é‡Œè°ƒç”¨ chrome.scripting.executeScript ï¼Œå°±èƒ½æŒ‰éœ€æŠŠå†…å®¹è„šæœ¬æ³¨å…¥åˆ°æŒ‡å®šç½‘ç«™é¡µé¢é‡Œã€‚</p>
</li>
<li>
<p>è¿™ä¸ªè¿‡ç¨‹å…¶å®æ˜¯ï¼šæ’ä»¶å‘èµ·æ³¨å…¥è¯·æ±‚åï¼Œæµè§ˆå™¨ä¸»è¿›ç¨‹ä¼šå…ˆå—ç†è¿™ä¸ªè¯·æ±‚ï¼Œç„¶åé€šè¿‡ IPCæœºåˆ¶ï¼ŒæŠŠè¦æ³¨å…¥çš„å†…å®¹è„šæœ¬å®‰å…¨åœ°ä¼ é€’ç»™ç›®æ ‡é¡µé¢çš„æ¸²æŸ“è¿›ç¨‹ã€‚</p>
</li>
<li>
<p>æ¸²æŸ“è¿›ç¨‹æ”¶åˆ°è„šæœ¬åï¼Œå°±ä¼šåœ¨é¡µé¢çš„éš”ç¦»ç¯å¢ƒï¼ˆIsolated Worldï¼‰é‡Œæ‰§è¡Œå†…å®¹è„šæœ¬ï¼Œè¿™æ ·å†…å®¹è„šæœ¬å°±çœŸæ­£â€œè½åœ°â€åˆ°é¡µé¢ä¸­äº†ã€‚</p>
</li>
</ul>
<p>æ‰€ä»¥ï¼Œæ•´ä¸ªæµç¨‹å°±æ˜¯ï¼š æ’ä»¶è°ƒç”¨ chrome.scripting.executeScript â†’ æµè§ˆå™¨ä¸»è¿›ç¨‹å—ç†å¹¶é€šè¿‡ IPC è½¬å‘ â†’ é¡µé¢æ¸²æŸ“è¿›ç¨‹æ‰§è¡Œå†…å®¹è„šæœ¬ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59eb3f573d1745afbcfe59271299a3d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764030308&amp;x-signature=eu2jgqSschAUiZwNvSjVnjTbupo%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-9">injected.js â€”â€” æ³¨å…¥é¡µé¢è„šæœ¬</h4>
<p>å‰é¢è¯´è¿‡ï¼Œé¡µé¢çš„ JS ç¯å¢ƒå’Œå†…å®¹è„šæœ¬çš„ JS ç¯å¢ƒæ˜¯äº’ç›¸éš”ç¦»çš„ï¼Œå½¼æ­¤è®¿é—®ä¸åˆ°å¯¹æ–¹çš„å˜é‡å’Œæ–¹æ³•ï¼Œä½†å®ƒä»¬å…±äº«åŒä¸€ä¸ª DOM æ ‘ã€‚ å¦‚æœä½ æƒ³ç›´æ¥æ”¹é¡µé¢é‡Œçš„ JS ç¯å¢ƒï¼Œæ¯”å¦‚é‡å†™ fetch æˆ– XMLHttpRequestï¼Œå®ç°åƒ mock æ¥å£è¿™æ ·çš„åŠŸèƒ½ï¼Œå°±ä¸èƒ½åªé å†…å®¹è„šæœ¬äº†ã€‚</p>
<p>è¿™æ—¶å€™å°±éœ€è¦ç”¨â€œæ³¨å…¥è„šæœ¬â€çš„æ–¹å¼ï¼š æˆ‘ä»¬å¯ä»¥åœ¨å†…å®¹è„šæœ¬é‡Œåˆ›å»ºä¸€ä¸ª script æ ‡ç­¾ï¼ŒæŠŠè¦æ”¹å†™çš„ä»£ç ï¼ˆæ¯”å¦‚æ–°çš„ fetch å®ç°ï¼‰å†™è¿›å»ï¼Œç„¶åæŠŠè¿™ä¸ªæ ‡ç­¾æ’å…¥åˆ°é¡µé¢çš„ DOM é‡Œã€‚è¿™æ ·ï¼Œé¡µé¢ä¼šåƒåŠ è½½æ™®é€š JS æ–‡ä»¶ä¸€æ ·æ‰§è¡Œè¿™æ®µä»£ç ï¼Œæœ€ç»ˆå°±èƒ½è¦†ç›–é¡µé¢åŸç”Ÿçš„ fetch å’Œ xhr æ–¹æ³•ã€‚</p>
<p>è¿™ç§åšæ³•çš„å¥½å¤„æ˜¯ï¼š</p>
<ul>
<li>
<p>èƒ½ç›´æ¥å½±å“é¡µé¢è‡ªå·±çš„ JS ç¯å¢ƒï¼Œå®ç°æ›´å¼ºçš„åŠŸèƒ½æ‰©å±•</p>
</li>
<li>
<p>åªè¦ DOM æ˜¯å…±äº«çš„ï¼Œæ’å…¥ script æ ‡ç­¾å°±èƒ½è®©é¡µé¢æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç </p>
</li>
<li>
<p>å¾ˆé€‚åˆåš mockã€æ—¥å¿—åŠ«æŒã€æ€§èƒ½ç›‘æ§ç­‰æ’ä»¶åŠŸèƒ½</p>
</li>
</ul>
<p>æ¯”å¦‚æˆ‘æœ€è¿‘å†™çš„ä¸€ä¸ªåŸºç¡€çš„ mock æ’ä»¶(<a href="https://juejin.cn/post/7570984257666056238)%EF%BC%8C%E5%B0%B1%E6%98%AF%E7%94%A8%E8%BF%99%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%8C%E5%9C%A8%E9%A1%B5%E9%9D%A2%E5%8A%A0%E8%BD%BD%E5%89%8D%E5%81%B7%E5%81%B7%E6%8A%8A" target="_blank" title="https://juejin.cn/post/7570984257666056238)%EF%BC%8C%E5%B0%B1%E6%98%AF%E7%94%A8%E8%BF%99%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%8C%E5%9C%A8%E9%A1%B5%E9%9D%A2%E5%8A%A0%E8%BD%BD%E5%89%8D%E5%81%B7%E5%81%B7%E6%8A%8A">juejin.cn/post/757098â€¦</a> fetch å’Œ XMLHttpRequest æ›¿æ¢æˆæˆ‘é‡å†™çš„ï¼Œè®©æ‰€æœ‰ç½‘ç»œè¯·æ±‚éƒ½èƒ½è¢«æ’ä»¶æ‹¦æˆªå’Œå¤„ç†ã€‚</p>
<h5 data-id="heading-10">è·¨ç¯å¢ƒé€šä¿¡æµç¨‹ä¸¾ä¾‹</h5>
<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬çš„æ³¨å…¥é¡µé¢è„šæœ¬ï¼ˆinjected.jsï¼‰éœ€è¦ç”¨åˆ°æ’ä»¶è¿›ç¨‹é‡Œçš„æ•°æ®ï¼Œæ¯”å¦‚åˆ¤æ–­æŸä¸ª fetch è¯·æ±‚æ˜¯å¦å‘½ä¸­æ’ä»¶é…ç½®çš„è§„åˆ™ã€‚ä½†é¡µé¢ç¯å¢ƒæ˜¯æ‹¿ä¸åˆ°æ’ä»¶è¿›ç¨‹é‡Œçš„é…ç½®çš„ï¼Œä¸è¿‡å†…å®¹è„šæœ¬å¯ä»¥å¸®å¿™â€œä¸­è½¬â€ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬åœ¨ injected.js é‡Œé‡å†™äº† fetch æ–¹æ³•ï¼Œé¡µé¢å‘èµ·è¯·æ±‚åï¼Œéœ€è¦æŸ¥ä¸€ä¸‹æ’ä»¶é‡Œæœ‰æ²¡æœ‰å¯¹åº”çš„ mock è§„åˆ™ã€‚æ•´ä¸ªæ•°æ®æµå¯ä»¥è¿™æ ·èµ°ï¼š</p>
<ul>
<li>
<ol>
<li>æ³¨å…¥è„šæœ¬ï¼ˆinjected.jsï¼‰æ‹¦æˆªåˆ° fetch è¯·æ±‚ï¼Œå‘ç°éœ€è¦æ’ä»¶é‡Œçš„è§„åˆ™é…ç½®ã€‚</li>
</ol>
</li>
<li>
<ol start="2">
<li>æ³¨å…¥è„šæœ¬ç”¨ window.postMessage å‘å†…å®¹è„šæœ¬å‘æ¶ˆæ¯ï¼Œè¯·æ±‚è§„åˆ™æ•°æ®ã€‚</li>
</ol>
</li>
<li>
<ol start="3">
<li>å†…å®¹è„šæœ¬æ”¶åˆ°æ¶ˆæ¯åï¼Œå†ç”¨ chrome.runtime.sendMessage å‘æ’ä»¶è¿›ç¨‹ï¼ˆæ¯”å¦‚åå°è„šæœ¬ï¼‰å‘èµ·è¯·æ±‚ï¼Œè·å–æœ€æ–°è§„åˆ™ã€‚</li>
</ol>
</li>
<li>
<ol start="4">
<li>æ’ä»¶è¿›ç¨‹é€šè¿‡ IPC æœºåˆ¶æŠŠè§„åˆ™æ•°æ®è¿”å›ç»™å†…å®¹è„šæœ¬ã€‚</li>
</ol>
</li>
<li>
<ol start="5">
<li>å†…å®¹è„šæœ¬æ‹¿åˆ°æ•°æ®åï¼Œå†ç”¨ window.postMessage æŠŠç»“æœä¼ å› injected.jsã€‚</li>
</ol>
</li>
<li>
<ol start="6">
<li>æ³¨å…¥è„šæœ¬æ‹¿åˆ°è§„åˆ™ï¼Œåˆ¤æ–­è¯·æ±‚æ˜¯å¦å‘½ä¸­ï¼Œç„¶ååšåç»­å¤„ç†ï¼ˆæ¯”å¦‚ mockã€æ‹¦æˆªã€æ—¥å¿—ç­‰ï¼‰ã€‚</li>
</ol>
</li>
</ul>
<p>è¿™æ ·ä¸€æ¥ï¼Œé¡µé¢è„šæœ¬ã€å†…å®¹è„šæœ¬ã€æ’ä»¶è¿›ç¨‹å°±èƒ½é€šè¿‡æ¶ˆæ¯é“¾è·¯æŠŠæ•°æ®å®‰å…¨åœ°ä¸²è”èµ·æ¥ï¼Œå®ç°å¤æ‚çš„åŠŸèƒ½æ‰©å±•ã€‚ æ•´ä¸ªè¿‡ç¨‹å°±åƒâ€œæ¥åŠ›ä¼ è¯â€ï¼Œæ¯ä¸ªç¯èŠ‚å„å¸å…¶èŒï¼Œæ—¢ä¿è¯äº†å®‰å…¨ï¼Œåˆè®©æ’ä»¶å’Œé¡µé¢èƒ½çµæ´»åä½œ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/398541a9c4df48e2b4d612ffefa12615~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764030308&amp;x-signature=Sxn6lGnybbxPsmCRtNIELYg8%2B24%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">æ€»ç»“ï¼šæ’ä»¶å¤šè„šæœ¬é€šä¿¡ï¼Œæ²¡é‚£ä¹ˆéš¾ï¼</h3>
<p>çœ‹åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å·²ç»å¯¹Chromeæ’ä»¶ä¸­çš„å¤šè„šæœ¬é€šä¿¡æœ‰äº†æ¸…æ™°çš„è®¤è¯†ã€‚è®©æˆ‘ä»¬ç®€å•å›é¡¾ä¸€ä¸‹ä»Šå¤©å­¦åˆ°çš„å…³é”®çŸ¥è¯†ï¼š</p>
<ol>
<li>ä¸ºä»€ä¹ˆéœ€è¦å¤šè„šæœ¬ï¼Ÿ</li>
</ol>
<ul>
<li>Chromeçš„å¤šè¿›ç¨‹æ¶æ„æ˜¯ä¸ºäº†å®‰å…¨å’Œç¨³å®šæ€§ï¼Œä¸æ˜¯ä¸ºäº†æ•…æ„ä¸ºéš¾å¼€å‘è€…</li>
</ul>
<ol start="2">
<li>å„è„šæœ¬çš„è§’è‰²ï¼š</li>
</ol>
<ul>
<li>background.js ï¼šå¸¸é©»åå°ï¼Œè´Ÿè´£å¤§éƒ¨åˆ†é€»è¾‘å’Œæƒé™ï¼Œæ˜¯æ’ä»¶çš„å¤§è„‘ã€‚</li>
<li>content.js ï¼šåµŒå…¥é¡µé¢ï¼Œèƒ½æ“ä½œDOMï¼Œä½†å’Œé¡µé¢JSæ˜¯éš”ç¦»çš„ï¼Œåƒæ˜¯æ´¾é©»åˆ°é¡µé¢çš„ç‰¹å·¥ã€‚</li>
<li>popup.html ï¼šå¼¹çª—é¡µé¢ï¼Œä¸»è¦è´Ÿè´£UIäº¤äº’ï¼Œå…³é—­å°±â€œå¤±å¿†â€ï¼Œä½†ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚</li>
<li>injected.js ï¼šç›´æ¥æ³¨å…¥é¡µé¢ï¼Œèƒ½è®¿é—®å’Œä¿®æ”¹é¡µé¢ç¯å¢ƒï¼Œç±»ä¼¼å§åº•ã€‚</li>
</ul>
<ol start="3">
<li>é€šä¿¡ç§˜è¯€ï¼š</li>
</ol>
<ul>
<li>background â†” popup ï¼šç”¨ chrome.runtime.sendMessage</li>
<li>background â†” content ï¼šç”¨ chrome.tabs.sendMessage æˆ– chrome.runtime.sendMessage</li>
<li>content â†” é¡µé¢JS ï¼šç”¨ window.postMessage</li>
</ul>
<p>è¿˜è®°å¾—å¼€å¤´é‚£ä½è‹¦æ¼çš„åŒäº‹å—ï¼Ÿç°åœ¨ä½ ä¸ä»…çŸ¥é“ä¸ºä»€ä¹ˆä»–çš„å˜é‡â€œæ­»æ´»æ‹¿ä¸åˆ°â€ï¼Œæ›´é‡è¦çš„æ˜¯ï¼ŒæŒæ¡äº†æ­£ç¡®çš„è§£å†³æ–¹æ³•ï¼</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ å°‘è¸©å‘ã€å¤šæ”¶è·ã€‚å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—ï¼Œä½ çš„æ”¯æŒæ˜¯æˆ‘æŒç»­åˆ†äº«çš„åŠ¨åŠ›ï¼</p>
<p>æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºè®¨è®ºã€‚ä¸‹æœŸè§ï¼ğŸ‘‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reactæ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼šæˆ‘ç”¨è¿™5ä¸ªæŠ€å·§å°†ç»„ä»¶æ¸²æŸ“é€Ÿåº¦æå‡äº†70%]]></title>    <link>https://juejin.cn/post/7573504290067169295</link>    <guid>https://juejin.cn/post/7573504290067169295</guid>    <pubDate>2025-11-18T00:16:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573504290067169295" data-draft-id="7573508361742123008" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reactæ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼šæˆ‘ç”¨è¿™5ä¸ªæŠ€å·§å°†ç»„ä»¶æ¸²æŸ“é€Ÿåº¦æå‡äº†70%"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-18T00:16:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="IT_é™ˆå¯’"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reactæ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼šæˆ‘ç”¨è¿™5ä¸ªæŠ€å·§å°†ç»„ä»¶æ¸²æŸ“é€Ÿåº¦æå‡äº†70%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    IT_é™ˆå¯’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:16:51.000Z" title="Tue Nov 18 2025 00:16:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Reactæ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼šæˆ‘ç”¨è¿™5ä¸ªæŠ€å·§å°†ç»„ä»¶æ¸²æŸ“é€Ÿåº¦æå‡äº†70%</strong></h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼ŒReactå› å…¶å£°æ˜å¼ç¼–ç¨‹æ¨¡å‹å’Œé«˜æ•ˆçš„è™šæ‹ŸDOMæœºåˆ¶è€Œå¹¿å—æ¬¢è¿ã€‚ç„¶è€Œï¼Œéšç€åº”ç”¨è§„æ¨¡çš„æ‰©å¤§å’Œå¤æ‚åº¦çš„æå‡ï¼Œæ€§èƒ½é—®é¢˜å¾€å¾€ä¼šé€æ¸æ˜¾ç°ã€‚ç‰¹åˆ«æ˜¯åœ¨å¤§å‹åº”ç”¨ä¸­ï¼Œç»„ä»¶çš„é¢‘ç¹é‡æ–°æ¸²æŸ“å¯èƒ½å¯¼è‡´æ˜æ˜¾çš„æ€§èƒ½ç“¶é¢ˆã€‚</p>
<p>æœ¬æ–‡å°†åˆ†äº«æˆ‘åœ¨å®é™…é¡¹ç›®ä¸­é€šè¿‡5ä¸ªå…³é”®æŠ€å·§å°†Reactç»„ä»¶æ¸²æŸ“é€Ÿåº¦æå‡70%çš„å®æˆ˜ç»éªŒã€‚è¿™äº›æ–¹æ³•ä¸ä»…ç»è¿‡äº†ç”Ÿäº§ç¯å¢ƒçš„éªŒè¯ï¼Œè€Œä¸”éƒ½æœ‰åšå®çš„ç†è®ºåŸºç¡€å’Œç¤¾åŒºå®è·µæ”¯æŒã€‚æ— è®ºä½ æ˜¯Reactæ–°æ‰‹è¿˜æ˜¯èµ„æ·±å¼€å‘è€…ï¼Œè¿™äº›ä¼˜åŒ–æŠ€å·§éƒ½èƒ½ä¸ºä½ çš„åº”ç”¨å¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚</p>
<h3 data-id="heading-2">ä¸€ã€ç†è§£Reactçš„æ¸²æŸ“æœºåˆ¶</h3>
<p>åœ¨æ·±å…¥ä¼˜åŒ–æŠ€å·§ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£Reactçš„æ ¸å¿ƒæ¸²æŸ“æœºåˆ¶ï¼š</p>
<ol>
<li><strong>è™šæ‹ŸDOMä¸åè°ƒ(Reconciliation)</strong>ï¼šReacté€šè¿‡æ¯”è¾ƒæ–°æ—§è™šæ‹ŸDOMæ ‘çš„å·®å¼‚æ¥æœ€å°åŒ–å®é™…DOMæ“ä½œ</li>
<li><strong>ç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¸é‡æ–°æ¸²æŸ“è§¦å‘æ¡ä»¶</strong>ï¼špropsæˆ–stateçš„å˜åŒ–ä¼šè§¦å‘é‡æ–°æ¸²æŸ“</li>
<li><strong>æ‰¹é‡æ›´æ–°(Batching)</strong>ï¼šReactä¼šå°†å¤šä¸ªsetStateè°ƒç”¨åˆå¹¶ä¸ºå•ä¸€æ›´æ–°</li>
</ol>
<p>å¸¸è§çš„æ€§èƒ½é—®é¢˜é€šå¸¸æºäºï¼š</p>
<ul>
<li>ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“</li>
<li>æ˜‚è´µçš„è®¡ç®—åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡å¤æ‰§è¡Œ</li>
<li>å¤§å‹åˆ—è¡¨çš„ä½æ•ˆå¤„ç†</li>
<li>Context APIçš„ä¸åˆç†ä½¿ç”¨</li>
</ul>
<h3 data-id="heading-3">äºŒã€å…³é”®ä¼˜åŒ–æŠ€å·§å®æˆ˜</h3>
<h4 data-id="heading-4">1. åˆç†ä½¿ç”¨React.memoè¿›è¡Œç»„ä»¶è®°å¿†åŒ–</h4>
<p><code>React.memo</code>æ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå®ƒä¼šå¯¹propsè¿›è¡Œæµ…æ¯”è¾ƒæ¥å†³å®šæ˜¯å¦è·³è¿‡é‡æ–°æ¸²æŸ“ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ExpensiveComponent</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">ExpensiveComponent</span>(<span class="hljs-params">{ data }</span>) {
  <span class="hljs-comment">// ç»„ä»¶å®ç°</span>
});
</code></pre>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>å¯¹äºçº¯å±•ç¤ºå‹ç»„ä»¶ä¼˜å…ˆä½¿ç”¨memo</li>
<li>propsä¸­åŒ…å«å¤æ‚å¯¹è±¡æ—¶é…åˆè‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°</li>
<li>é¿å…å†…è”å‡½æ•°å’Œå¯¹è±¡ä½œä¸ºprops</li>
</ul>
<p><strong>æ¡ˆä¾‹åˆ†æ</strong>ï¼š
åœ¨ä¸€ä¸ªåŒ…å«100+å­ç»„ä»¶çš„åˆ—è¡¨ä¸­ï¼Œä½¿ç”¨memoåå‡å°‘äº†çº¦85%çš„ä¸å¿…è¦æ¸²æŸ“ã€‚</p>
<h4 data-id="heading-5">2. useCallbackä¸useMemoçš„æ­£ç¡®ç”¨æ³•</h4>
<p>è¿™ä¸¤ä¸ªHookå¯ä»¥åˆ†åˆ«ç¼“å­˜å‡½æ•°å¼•ç”¨å’Œè®¡ç®—ç»“æœï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> memoizedCallback = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">doSomething</span>(a, b);
}, [a, b]);

<span class="hljs-keyword">const</span> memoizedValue = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">computeExpensiveValue</span>(a, b), [a, b]);
</code></pre>
<p><strong>å…³é”®åŒºåˆ«</strong>ï¼š</p>
<ul>
<li><code>useCallback</code>ç¼“å­˜å‡½æ•°å®ä¾‹æœ¬èº«</li>
<li><code>useMemo</code>ç¼“å­˜å‡½æ•°çš„è¿”å›å€¼</li>
</ul>
<p><strong>å¸¸è§è¯¯åŒºä¿®æ­£</strong>ï¼š</p>
<ul>
<li>ä¸æ˜¯æ‰€æœ‰å‡½æ•°éƒ½éœ€è¦useCallback - ä»…åœ¨ä½œä¸ºä¾èµ–é¡¹æˆ–propä¼ é€’æ—¶éœ€è¦</li>
<li>useMemoçš„ä¾èµ–æ•°ç»„è¦ç²¾ç¡®åŒ…å«æ‰€æœ‰å˜åŒ–å› ç´ </li>
</ul>
<h4 data-id="heading-6">3. è™šæ‹ŸåŒ–é•¿åˆ—è¡¨ï¼ˆWindowizingï¼‰</h4>
<p>å¯¹äºåŒ…å«å¤§é‡å…ƒç´ çš„åˆ—è¡¨ï¼ˆå¦‚1000+é¡¹ï¼‰ï¼Œå¸¸è§„æ¸²æŸ“ä¼šå¯¼è‡´ä¸¥é‡æ€§èƒ½é—®é¢˜ã€‚è§£å†³æ–¹æ¡ˆæ˜¯åªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„å…ƒç´ ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">FixedSizeList</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">List</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-window'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">List</span> 
  <span class="hljs-attr">height</span>=<span class="hljs-string">{600}</span>
  <span class="hljs-attr">itemCount</span>=<span class="hljs-string">{1000}</span>
  <span class="hljs-attr">itemSize</span>=<span class="hljs-string">{35}</span>
&gt;</span>
{({ index, style }) =&gt; (
   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span>&gt;</span>Row {index}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 )}
<span class="hljs-tag">&lt;/<span class="hljs-name">List</span>&gt;</span></span>
</code></pre>
<p><strong>ä¸»æµåº“é€‰æ‹©</strong>ï¼š</p>
<ul>
<li>react-windowï¼šè½»é‡çº§åŸºç¡€æ–¹æ¡ˆ</li>
<li>react-virtualizedï¼šåŠŸèƒ½æ›´å…¨é¢ä½†ä½“ç§¯è¾ƒå¤§</li>
</ul>
<p>åœ¨æˆ‘ä»¬çš„ç”µå•†é¡¹ç›®ä¸­ï¼Œ5000é¡¹å•†å“åˆ—è¡¨çš„æ»šåŠ¨æ€§èƒ½ä»8FPSæå‡åˆ°äº†60FPSã€‚</p>
<h4 data-id="heading-7">4. Context APIçš„åˆ†æ²»ç­–ç•¥</h4>
<p>Contextçš„ä»·å€¼å˜åŒ–ä¼šå¯¼è‡´æ‰€æœ‰æ¶ˆè´¹ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚ä¼˜åŒ–æ–¹æ³•åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æ‹†åˆ†Context</strong>ï¼šæŒ‰åŠŸèƒ½é¢†åŸŸåˆ†æˆå¤šä¸ªContext</li>
<li><strong>è®°å¿†åŒ–æ¶ˆè´¹è€…</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeLabel</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-function">(<span class="hljs-params">{ theme }</span>) =&gt;</span> (
   <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> <span class="hljs-attr">theme.color</span> }}&gt;</span>Theme<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>
));

<span class="hljs-keyword">function</span> <span class="hljs-title function_">ThemeLabelWrapper</span>(<span class="hljs-params"/>) {
   <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>);
   <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeLabel</span> <span class="hljs-attr">theme</span>=<span class="hljs-string">{theme}</span> /&gt;</span></span>
}
</code></pre>
<ol start="3">
<li><strong>ä½¿ç”¨å‘å¸ƒè®¢é˜…æ¨¡å¼æ›¿ä»£éƒ¨åˆ†Contextåœºæ™¯</strong></li>
</ol>
<h4 data-id="heading-8">5. Code Splittingä¸æ‡’åŠ è½½</h4>
<p>åˆ©ç”¨åŠ¨æ€importå®ç°æŒ‰éœ€åŠ è½½ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">OtherComponent</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./OtherComponent'</span>));

<span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params"/>) {
   <span class="hljs-keyword">return</span> (
     <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
       <span class="hljs-tag">&lt;<span class="hljs-name">OtherComponent</span> /&gt;</span>
     <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
   );
}
</code></pre>
<p><strong>è¿›é˜¶ç”¨æ³•</strong>ï¼š</p>
<ul>
<li>Prefetchingï¼šé¢„æµ‹ç”¨æˆ·è¡Œä¸ºæå‰åŠ è½½æ¨¡å—ï¼ˆNext.jsç­‰æ¡†æ¶å†…ç½®æ”¯æŒï¼‰</li>
<li>Webpacké­”æ³•æ³¨é‡ŠæŒ‡å®šchunkåç§°</li>
</ul>
<p>åœ¨æˆ‘ä»¬çš„ç®¡ç†åå°åº”ç”¨ä¸­ï¼Œåˆå§‹åŠ è½½æ—¶é—´ä»4.2så‡å°‘åˆ°1.8sã€‚</p>
<h3 data-id="heading-9">ä¸‰ã€é«˜çº§è°ƒè¯•ä¸åˆ†ææŠ€æœ¯</h3>
<p>ä¼˜åŒ–çš„å‰ææ˜¯å‡†ç¡®è¯†åˆ«ç“¶é¢ˆã€‚æ¨èçš„å·¥å…·å’Œæ–¹æ³•ï¼š</p>
<ol>
<li><strong>React DevTools Profiler</strong>
<ul>
<li>Recordäº¤äº’è¿‡ç¨‹åˆ†æç«ç„°å›¾</li>
<li>Commit-by-Commitåˆ†æç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</li>
</ul>
</li>
<li><strong>Chrome Performance Tab</strong>
<ul>
<li>JSæ‰§è¡Œæ—¶é—´åˆ†æ</li>
<li>Layout Thrashingæ£€æµ‹</li>
</ul>
</li>
<li><strong>è‡ªå®šä¹‰æµ‹é‡Hook</strong></li>
</ol>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useRenderTime</span>(<span class="hljs-params">name</span>) {
   <span class="hljs-keyword">const</span> start = performance.<span class="hljs-title function_">now</span>();
   
   <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> end = performance.<span class="hljs-title function_">now</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name}</span> render time:`</span>, end - start);
   });
}
</code></pre>
<ol start="4">
<li>Productionç¯å¢ƒä¸‹çš„Performance Monitoringï¼ˆå¦‚Sentryï¼‰æ•è·çœŸå®ç”¨æˆ·ä½“éªŒæ•°æ®</li>
</ol>
<h3 data-id="heading-10">å››ã€æ¶æ„å±‚é¢çš„ä¼˜åŒ–è€ƒé‡</h3>
<p>é™¤äº†ä¸Šè¿°å…·ä½“æŠ€æœ¯å¤–ï¼Œè¿˜æœ‰ä¸€äº›æ›´é«˜å±‚æ¬¡çš„ä¼˜åŒ–åŸåˆ™ï¼š</p>
<ol>
<li><strong>çŠ¶æ€ç®¡ç†çš„æœ€å°åŒ–åŸåˆ™</strong>
<ul>
<li>Reduxç­‰å…¨å±€çŠ¶æ€ä»…ç”¨äºçœŸæ­£å…¨å±€çš„æ•°æ®</li>
<li>colocateçŠ¶æ€åˆ°å°½å¯èƒ½å°çš„å­æ ‘</li>
</ul>
</li>
<li><strong>ä¸å¯å˜æ•°æ®ç»“æ„çš„ä¼˜åŠ¿</strong>
<ul>
<li>Immerç®€åŒ–ä¸å¯å˜æ›´æ–°é€»è¾‘</li>
</ul>
</li>
<li><strong>æœåŠ¡ç«¯ä¼˜åŒ–çš„ååŒæ•ˆåº”</strong>
<ul>
<li>GraphQLçš„æ•°æ®ç²¾ç¡®è·å–ä¼˜äºRESTfulç€‘å¸ƒè¯·æ±‚</li>
</ul>
</li>
<li>WASMå¤„ç†CPUå¯†é›†å‹ä»»åŠ¡çš„å¯èƒ½æ€§æ¢ç´¢ï¼ˆå¦‚è¡¨æ ¼æ•°æ®å¤„ç†ï¼‰</li>
</ol>
<h3 data-id="heading-11">äº”ã€æƒè¡¡çš„è‰ºæœ¯ï¼šä½•æ—¶ä¸ä¼˜åŒ–ï¼Ÿ</h3>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ"è¿‡æ—©ä¼˜åŒ–æ˜¯ä¸‡æ¶ä¹‹æº"ã€‚åœ¨å®è·µä¸­éœ€è¦å¹³è¡¡ï¼š</p>
<ol>
<li><strong>å¯ç»´æŠ¤æ€§ä¸æ€§èƒ½çš„trade-off</strong></li>
<li>ROIè€ƒé‡ï¼š90/10æ³•åˆ™ï¼ˆ90%çš„æ€§èƒ½é—®é¢˜æ¥è‡ª10%çš„å…³é”®è·¯å¾„ï¼‰</li>
<li>A/Bæµ‹è¯•éªŒè¯ä¼˜åŒ–çš„å®é™…æ•ˆæœè€Œéè‡†æµ‹<br/>
4."è¶³å¤Ÿå¥½"åŸåˆ™æ»¡è¶³ä¸šåŠ¡éœ€æ±‚å³å¯åœæ­¢è¿›ä¸€æ­¥ä¼˜åŒ–</li>
</ol>
<p>###æ€»ç»“</p>
<p>é€šè¿‡å®æ–½ä¸Šè¿°äº”ä¸ªæ ¸å¿ƒç­–ç•¥â€”â€”æ˜æ™ºåœ°ä½¿ç”¨memoizationã€æ­£ç¡®åº”ç”¨Hooksã€è™šæ‹ŸåŒ–é•¿åˆ—è¡¨ã€ç²¾ç»†æ§åˆ¶Contextä»¥åŠä»£ç åˆ†å‰²â€”â€”æˆ‘ä»¬æˆåŠŸåœ°å°†å…³é”®é¡µé¢çš„äº¤äº’å»¶è¿Ÿé™ä½äº†70%ï¼ŒåŒæ—¶ä¿æŒäº†ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p>
<p>è®°ä½ï¼Œæ€§èƒ½ä¼˜åŒ–æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹è€Œéä¸€æ¬¡æ€§ä»»åŠ¡ã€‚å»ºè®®å»ºç«‹å®šæœŸçš„performance auditæ–‡åŒ–ï¼Œç»“åˆè‡ªåŠ¨åŒ–ç›‘æ§å·¥å…·åŠæ—¶å‘ç°é—®é¢˜ã€‚æœ€é‡è¦çš„æ˜¯ä¿æŒå¯¹Reactæ ¸å¿ƒåŸç†çš„æ·±å…¥ç†è§£â€”â€”çŸ¥å…¶æ‰€ä»¥ç„¶æ‰èƒ½åšå‡ºæœ€æ°å½“çš„ä¼˜åŒ–å†³ç­–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[èŠ‚çœ 60% Token çš„æ–°æ•°æ®æ ¼å¼ã€ŒGitHub çƒ­ç‚¹é€Ÿè§ˆã€]]></title>    <link>https://juejin.cn/post/7573519273030713390</link>    <guid>https://juejin.cn/post/7573519273030713390</guid>    <pubDate>2025-11-18T00:19:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573519273030713390" data-draft-id="7573521516324716571" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="èŠ‚çœ 60% Token çš„æ–°æ•°æ®æ ¼å¼ã€ŒGitHub çƒ­ç‚¹é€Ÿè§ˆã€"/> <meta itemprop="keywords" content="GitHub,å¼€æº"/> <meta itemprop="datePublished" content="2025-11-18T00:19:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HelloGitHub"/> <meta itemprop="url" content="https://juejin.cn/user/1574156384091320"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            èŠ‚çœ 60% Token çš„æ–°æ•°æ®æ ¼å¼ã€ŒGitHub çƒ­ç‚¹é€Ÿè§ˆã€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1574156384091320/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HelloGitHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:19:23.000Z" title="Tue Nov 18 2025 00:19:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/882e904909784484a303bb2d81b41619~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGVsbG9HaXRIdWI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029963&amp;x-signature=k%2BB9TNx8LGrjViqAe2qS7EP77YQ%3D" alt="" loading="lazy"/></p>
<p>æˆ‘æœ€è¿‘çäº‹ç¼ èº«ï¼Œè¿ç»­å¥½å‡ å‘¨æ²¡å‘ã€ŒGitHub çƒ­ç‚¹é€Ÿè§ˆã€äº†ï¼Œè¿™æ ·ä¸è¡Œå¾—èµ¶ç´§ç»­ä¸Šã€‚</p>
<p>é¦–å…ˆæ˜ å…¥çœ¼å¸˜çš„æ˜¯å¯èŠ‚çœ 60% Token çš„æ–°æ•°æ®åºåˆ—åŒ–æ ¼å¼ TOONï¼Œå…¶å®˜æ–¹å¼€æºçš„ TypeScript å®ç°åœ¨ GitHub ä¸Šä¸€å‘¨ä¾¿æ–©è·äº† 3.5k Starï¼Œè€Œä¸”çƒ­åº¦è¿˜åœ¨æŒç»­ä¸Šæ¶¨ã€‚Snapchat å›¢é˜Ÿå¼€æºçš„è·¨å¹³å° UI æ¡†æ¶ Valdiï¼Œä¸ä»…èƒ½å¤Ÿç”¨ TypeScript å†™è·¨å¹³å° UI è€Œä¸”æ— éœ€é‡æ–°ç¼–è¯‘å³å¯åœ¨æ¯«ç§’å†…çœ‹åˆ°æ”¹åŠ¨æ•ˆæœã€‚è¯è¯´æˆ‘ä¹Ÿæœ‰çœ‹èµ°çœ¼çš„æ—¶å€™...TrendRadar æ˜¯ä¸€æ¬¾åŸºäº AI çš„å…¨ç½‘çƒ­ç‚¹èµ„è®¯è¿½è¸ªåŠ©æ‰‹ï¼Œæœ€è¿‘æŒç»­éœ¸æ¦œä¸€å‘¨æ¶¨äº† 10k Starï¼Œæˆ‘åˆè§å®ƒçš„æ—¶å€™ Star æ‰åˆšç ´åƒï¼</p>
<p>è¿™æœŸçƒ­æ¦œä¸Šæ²¡æœ‰ Web åº”ç”¨ï¼Œæ‰€ä»¥ã€ŒHelloGitHub çƒ­è¯„ã€æˆ‘é€‰äº†æç®€çš„ä¸ªäººäº‘ç›¸å†Œå¹³å° ChronoFrame å’Œæ¸…çˆ½çš„è½»é‡çº§å†…å®¹åˆ†äº«å¹³å° Ech0ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤Ÿå–œæ¬¢ã€‚</p>
<ul>
<li>æœ¬æ–‡ç›®å½•
<ul>
<li>1. çƒ­é—¨å¼€æºé¡¹ç›®
<ul>
<li>1.1 è·¨å¹³å°åŸç”Ÿæ€§èƒ½çš„ UI æ¡†æ¶ï¼šValdi</li>
<li>1.2 ä¸€é”®é…ç½® Arch Linux å¼€å‘ç¯å¢ƒï¼šHyDE</li>
<li>1.3 èŠ‚çœ Token çš„æ•°æ®æ ¼å¼ï¼šTOON</li>
<li>1.4 å¼€æº AI å®‰å…¨æ£€æµ‹å·¥å…·ï¼šStrix</li>
<li>1.5 AI é©±åŠ¨çš„å…¨ç½‘çƒ­ç‚¹è¿½è¸ªåŠ©æ‰‹ï¼šTrendRadar</li>
</ul>
</li>
<li>2. HelloGitHub çƒ­è¯„
<ul>
<li>2.1 æç®€çš„ä¸ªäººäº‘ç›¸å†Œå¹³å°ï¼šChronoFrame</li>
<li>2.2 æ¸…çˆ½çš„è½»é‡çº§å†…å®¹åˆ†äº«å¹³å°ï¼šEch0</li>
</ul>
</li>
<li>3. ç»“å°¾</li>
</ul>
</li>
</ul>
<h2 data-id="heading-0">1. çƒ­é—¨å¼€æºé¡¹ç›®</h2>
<h3 data-id="heading-1">1.1 è·¨å¹³å°åŸç”Ÿæ€§èƒ½çš„ UI æ¡†æ¶ï¼šValdi</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a914cef871664dcdbe3c7b13ecd4eb59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGVsbG9HaXRIdWI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029963&amp;x-signature=OUWsZi3CyqChJMl%2FNeFnyoCU0B0%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸»è¯­è¨€ï¼šC++ã€TypeScript</strong>ï¼Œ<strong>Starï¼š9.8k</strong>ï¼Œ<strong>å‘¨å¢é•¿ï¼š5.4k</strong></p>
<p>è¯¥é¡¹ç›®æ˜¯ Snapchat å›¢é˜Ÿå¼€æºçš„è·¨å¹³å° UI æ¡†æ¶ï¼Œæ”¯æŒä½¿ç”¨ TypeScript ç¼–å†™ UI å¹¶ç›´æ¥ç¼–è¯‘ä¸º iOSã€Android å’Œ macOS åŸç”Ÿè§†å›¾ï¼Œä¸ä¾èµ– WebView å’Œ JavaScript æ¡¥æ¥ï¼Œæ— éœ€é‡æ–°ç¼–è¯‘å³å¯åœ¨æ¯«ç§’å†…çœ‹åˆ°æ”¹åŠ¨æ•ˆæœï¼Œå¹¶æ”¯æŒåœ¨ VSCode ä¸­è®¾ç½®æ–­ç‚¹ã€æ£€æŸ¥å˜é‡ã€åˆ†ææ€§èƒ½ç­‰åŠŸèƒ½ï¼Œé€‚ç”¨äºè¿½æ±‚åŸç”Ÿæ€§èƒ½ä½“éªŒçš„è·¨å¹³å°ç§»åŠ¨åº”ç”¨å¼€å‘ç­‰åœºæ™¯ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'valdi_core/src/Component'</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorld</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> {
  <span class="hljs-title function_">onRender</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> message = <span class="hljs-string">'Hello World! ğŸ‘»'</span>;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">backgroundColor</span>=<span class="hljs-string">'#FFFC00'</span> <span class="hljs-attr">padding</span>=<span class="hljs-string">{30}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">color</span>=<span class="hljs-string">'black'</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{message}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span>;
  }
}
</code></pre>
<blockquote>
<p>GitHub åœ°å€â†’<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" target="_blank" title="https://github.com/Snapchat/Valdi" ref="nofollow noopener noreferrer">github.com/Snapchat/Vaâ€¦</a></p>
</blockquote>
<h3 data-id="heading-2">1.2 ä¸€é”®é…ç½® Arch Linux å¼€å‘ç¯å¢ƒï¼šHyDE</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/15a5b50f3a8a4b879d830732299d970b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGVsbG9HaXRIdWI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029963&amp;x-signature=cJXzWmcdMw6A%2B3PMJ%2Bo1fxGkQyM%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸»è¯­è¨€ï¼šShellã€Python</strong>ï¼Œ<strong>Starï¼š7.1k</strong></p>
<p>è¯¥é¡¹ç›®æ˜¯ä¸º Arch Linux ç”¨æˆ·è®¾è®¡çš„ Hyprland æ¡Œé¢ç¯å¢ƒä¸€é”®å®‰è£…è„šæœ¬ï¼Œå†…ç½®ä¸»é¢˜ç®¡ç†å’Œ Hyprland çª—å£ç®¡ç†å™¨ï¼Œæ”¯æŒè‡ªåŠ¨å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨ã€å¼€å‘ç¯å¢ƒå’Œç”Ÿæˆé…ç½®å¤‡ä»½ç­‰åŠŸèƒ½ã€‚</p>
<blockquote>
<p>GitHub åœ°å€â†’<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FHyDE-Project%2FHyDE" target="_blank" title="https://github.com/HyDE-Project/HyDE" ref="nofollow noopener noreferrer">github.com/HyDE-Projecâ€¦</a></p>
</blockquote>
<h3 data-id="heading-3">1.3 èŠ‚çœ Token çš„æ•°æ®æ ¼å¼ï¼šTOON</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/260441ae61254e1793d7154648574166~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGVsbG9HaXRIdWI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029963&amp;x-signature=Yge4BQAg125Xp0WbN4DR9BHcoGI%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸»è¯­è¨€ï¼šTypeScript</strong>ï¼Œ<strong>Starï¼š17k</strong>ï¼Œ<strong>å‘¨å¢é•¿ï¼š3.5k</strong></p>
<p>è¿™æ˜¯ä¸€ç§ä¸“ä¸º LLM æç¤ºè¯è®¾è®¡çš„æ•°æ®åºåˆ—åŒ–æ ¼å¼ï¼Œæ¯” JSON èŠ‚çœ 30-60% çš„ Tokenã€‚å®ƒèåˆäº† YAML å’Œ CSV çš„ç‰¹ç‚¹ï¼Œç´§å‡‘ä¸”å®¹æ˜“ç†è§£ã€‚å®˜æ–¹æä¾›äº† TypeScript SDK å’Œå‘½ä»¤è¡Œå·¥å…·ï¼Œèƒ½å¤Ÿè½»æ¾å°† JSON æ•°æ®è½¬æ¢ä¸º TOON æ ¼å¼ã€‚</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">context:</span>
  task: Our favorite hikes together
  location: Boulder
  season: spring_2025

friends[<span class="hljs-number">3</span>]: ana,luis,sam

hikes[<span class="hljs-number">3</span>]{id,name,distanceKm,elevationGain,companion,wasSunny}:
  <span class="hljs-number">1</span>,Blue Lake Trail,<span class="hljs-number">7.5</span>,<span class="hljs-number">320</span>,ana,<span class="hljs-literal">true</span>
  <span class="hljs-number">2</span>,Ridge Overlook,<span class="hljs-number">9.2</span>,<span class="hljs-number">540</span>,luis,<span class="hljs-literal">false</span>
  <span class="hljs-number">3</span>,Wildflower <span class="hljs-keyword">Loop</span>,<span class="hljs-number">5.1</span>,<span class="hljs-number">180</span>,sam,<span class="hljs-literal">true</span>
</code></pre>
<blockquote>
<p>GitHub åœ°å€â†’<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftoon-format%2Ftoon" target="_blank" title="https://github.com/toon-format/toon" ref="nofollow noopener noreferrer">github.com/toon-formatâ€¦</a></p>
</blockquote>
<h3 data-id="heading-4">1.4 å¼€æº AI å®‰å…¨æ£€æµ‹å·¥å…·ï¼šStrix</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72703cba0a3f473098ca741a92b43d45~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGVsbG9HaXRIdWI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029963&amp;x-signature=UHRzB6NInn7QBl1J1fRfpj64xb0%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸»è¯­è¨€ï¼šPython</strong>ï¼Œ<strong>Starï¼š11k</strong>ï¼Œ<strong>å‘¨å¢é•¿ï¼š2k</strong></p>
<p>è¿™æ˜¯ä¸€æ¬¾åŸºäº AI çš„å®‰å…¨æµ‹è¯•å·¥å…·ï¼Œå¯è‡ªåŠ¨å¯¹åº”ç”¨è¿›è¡Œå®‰å…¨æµ‹è¯•çš„ AI Agentã€‚å®ƒèƒ½å¤Ÿé›†æˆåˆ° CI/CD æµç¨‹ï¼Œå®ç°è‡ªåŠ¨æ‹‰å–ä»£ç å¹¶å¯åŠ¨åº”ç”¨ï¼Œç„¶åæ¨¡æ‹Ÿé»‘å®¢è¡Œä¸ºå¯»æ‰¾éšè—æ¼æ´ï¼Œæ”¯æŒæ¼æ´æ£€æµ‹/å¤ç°ã€è‡ªåŠ¨ä¿®å¤ã€ç”ŸæˆæŠ¥å‘Šç­‰åŠŸèƒ½ã€‚</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">Install Strix</span>
pipx install strix-agent
<span class="hljs-meta prompt_">
# </span><span class="bash">Configure your AI provider</span>
export STRIX_LLM="openai/gpt-5"
export LLM_API_KEY="your-api-key"
<span class="hljs-meta prompt_">
# </span><span class="bash">Run your first security assessment</span>
strix --target ./app-directory
</code></pre>
<blockquote>
<p>GitHub åœ°å€â†’<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fusestrix%2Fstrix" target="_blank" title="https://github.com/usestrix/strix" ref="nofollow noopener noreferrer">github.com/usestrix/stâ€¦</a></p>
</blockquote>
<h3 data-id="heading-5">1.5 AI é©±åŠ¨çš„å…¨ç½‘çƒ­ç‚¹è¿½è¸ªåŠ©æ‰‹ï¼šTrendRadar</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/320886c689424ca0aa05e1e239822de9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGVsbG9HaXRIdWI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029963&amp;x-signature=Ws5RKVUVfpghGA4q60Fqg7jFI%2Bk%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸»è¯­è¨€ï¼šPython</strong>ï¼Œ<strong>Starï¼š16k</strong>ï¼Œ<strong>å‘¨å¢é•¿ï¼š10k</strong></p>
<p>è¿™æ˜¯ä¸€æ¬¾å¼€ç®±å³ç”¨çš„çƒ­ç‚¹èµ„è®¯è¿½è¸ªåŠ©æ‰‹ï¼Œå‘Šåˆ«æ— æ•ˆåˆ·å±åªçœ‹çœŸæ­£å…³å¿ƒçš„æ–°é—»èµ„è®¯ã€‚å®ƒåŸºäº GitHub Actions è‡ªåŠ¨ç›‘æ§å…¨ç½‘çƒ­ç‚¹ï¼Œæ”¯æŒ AI æ™ºèƒ½åˆ†æå¯ç”¨è‡ªç„¶è¯­è¨€æé—®ã€‚æä¾›å½“æ—¥æ±‡æ€»ã€å½“å‰æ¦œå•ã€å¢é‡ç›‘æ§ä¸‰ç§æ¨é€æ¨¡å¼ï¼Œå¯é€šè¿‡é£ä¹¦ã€é’‰é’‰å’Œé‚®ä»¶ç­‰æ–¹å¼å°†çƒ­ç‚¹èµ„è®¯æ¨é€è‡³æ‰‹æœºã€‚</p>
<blockquote>
<p>GitHub åœ°å€â†’<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsansan0%2FTrendRadar" target="_blank" title="https://github.com/sansan0/TrendRadar" ref="nofollow noopener noreferrer">github.com/sansan0/Treâ€¦</a></p>
</blockquote>
<h2 data-id="heading-6">2. HelloGitHub çƒ­è¯„</h2>
<p>åœ¨æ­¤ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¸ºå¤§å®¶ä»‹ç»æœ¬å‘¨ HelloGitHub ç½‘ç«™ä¸Šçš„çƒ­é—¨å¼€æºé¡¹ç›®ï¼Œæˆ‘ä»¬ä¸ä»…å¸Œæœ›æ‚¨èƒ½ä»ä¸­æ”¶è·å¼€æºç¥å™¨å’Œç¼–ç¨‹çŸ¥è¯†ï¼Œæ›´æ¸´æœ›â€œå¬â€åˆ°æ‚¨çš„å£°éŸ³ã€‚æ¬¢è¿æ‚¨ä¸æˆ‘ä»¬åˆ†äº«ä½¿ç”¨è¿™äº›<strong>å¼€æºé¡¹ç›®çš„äº²èº«ä½“éªŒå’Œè¯„ä»·</strong>ï¼Œç”¨æœ€çœŸå®åé¦ˆä¸ºå¼€æºé¡¹ç›®çš„ä½œè€…æ³¨å…¥åŠ¨åŠ›ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd6daa5d9290475aae30046c3766deb4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGVsbG9HaXRIdWI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029963&amp;x-signature=%2BrroLasnRistPhhHhXCpmlkGhDM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">2.1 æç®€çš„ä¸ªäººäº‘ç›¸å†Œå¹³å°ï¼šChronoFrame</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/651f34adab144ed4abdaaee5fc454cda~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGVsbG9HaXRIdWI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029963&amp;x-signature=gq9PB%2F5FKNsgEA6%2F7Grvm%2BLPLOk%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸»è¯­è¨€ï¼šVue</strong></p>
<p>è¿™æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„è‡ªæ‰˜ç®¡ä¸ªäººç›¸å†Œåº”ç”¨ï¼Œä¸“ä¸ºå±•ç¤ºä¸åˆ†äº«ä¸ªäººæ‘„å½±ä½œå“è€Œè®¾è®¡ã€‚å®ƒæä¾›ç®€æ´æ˜“ç”¨çš„ Web ç•Œé¢ï¼Œå¯è½»æ¾ç®¡ç†å’Œæµè§ˆç…§ç‰‡ï¼Œæ”¯æŒ Live Photo ä¸ Motion Photo æ ¼å¼ï¼Œå¹¶å…·å¤‡ EXIF ä¿¡æ¯è§£æã€åœ°ç†ä½ç½®è¯†åˆ«å’Œåœ°å›¾æ¢ç´¢ç­‰åŠŸèƒ½ã€‚</p>
<blockquote>
<p>é¡¹ç›®è¯¦æƒ…â†’<a href="https://link.juejin.cn?target=https%3A%2F%2Fhellogithub.com%2Frepository%2FHoshinoSuzumi%2Fchronoframe" target="_blank" title="https://hellogithub.com/repository/HoshinoSuzumi/chronoframe" ref="nofollow noopener noreferrer">hellogithub.com/repository/â€¦</a></p>
</blockquote>
<h3 data-id="heading-8">2.2 æ¸…çˆ½çš„è½»é‡çº§å†…å®¹åˆ†äº«å¹³å°ï¼šEch0</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2337901ecdfc4615821e69d7fb4f7d69~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGVsbG9HaXRIdWI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029963&amp;x-signature=DhgvJsdqn%2FfkbG1RyyICyihKyvk%3D" alt="7" loading="lazy"/></p>
<p><strong>ä¸»è¯­è¨€ï¼šGo</strong></p>
<p>è¿™æ˜¯ä¸€æ¬¾å¼€æºã€è‡ªæ‰˜ç®¡çš„è½»é‡çº§å†…å®¹å‘å¸ƒå¹³å°ï¼Œä¸“æ³¨äºæ€æƒ³æµåŠ¨å’Œå¿«é€Ÿåˆ†äº«ã€‚å®ƒæ‹¥æœ‰ç®€æ´ç›´è§‚çš„æ“ä½œç•Œé¢ï¼Œæ”¯æŒå‘å¸ƒå’Œåˆ†äº«æƒ³æ³•ã€æ–‡å­—ã€å›¾ç‰‡å’Œé“¾æ¥ã€‚åŒæ—¶ï¼Œæ”¯æŒç±»ä¼¼ ActivityPub çš„è”é‚¦åè®®ï¼Œå®ç°ä¸åŒå®ä¾‹ï¼ˆç«™ç‚¹ï¼‰ä¹‹é—´çš„äº’è”äº’é€šï¼Œè®©å†…å®¹ä¸å†å±€é™äºå•ä¸€å­¤ç«‹çš„ç½‘ç«™ã€‚</p>
<blockquote>
<p>é¡¹ç›®è¯¦æƒ…â†’<a href="https://link.juejin.cn?target=https%3A%2F%2Fhellogithub.com%2Frepository%2Flin-snow%2FEch0" target="_blank" title="https://hellogithub.com/repository/lin-snow/Ech0" ref="nofollow noopener noreferrer">hellogithub.com/repository/â€¦</a></p>
</blockquote>
<h2 data-id="heading-9">3. ç»“å°¾</h2>
<p>ä»¥ä¸Šå°±æ˜¯æœ¬æœŸã€ŒGitHub çƒ­ç‚¹é€Ÿè§ˆã€çš„å…¨éƒ¨å†…å®¹ï¼Œå¸Œæœ›è¿™äº›å¼€æºé¡¹ç›®èƒ½æ¿€å‘ä½ çš„å…´è¶£ï¼Œå¸®åŠ©ä½ æ‰¾åˆ°ä¸‹ä¸€ä¸ªæƒ³è¦å°è¯•çš„å·¥å…·ï¼å¦‚æœä½ ä¹Ÿå‘ç°äº†å¥½ç©ã€æœ‰è¶£çš„ GitHub å¼€æºé¡¹ç›®æƒ³è¦åˆ†äº«ï¼Œæ¬¢è¿æ¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fhellogithub.com" target="_blank" title="https://hellogithub.com" ref="nofollow noopener noreferrer">HelloGitHub</a> ä¸æˆ‘ä»¬äº¤æµå¿ƒå¾—ã€è®¨è®ºä½¿ç”¨ä½“éªŒã€‚</p>
<p><strong>å¾€æœŸå›é¡¾</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fn_junef2MC3GTV7leQy-Ww" target="_blank" title="https://mp.weixin.qq.com/s/n_junef2MC3GTV7leQy-Ww" ref="nofollow noopener noreferrer">DIY ChatGPT ä¸€å‘¨ç‹‚æ½ 27k Star</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fh9QRvsP58MGhRyK8WfFxcg" target="_blank" title="https://mp.weixin.qq.com/s/h9QRvsP58MGhRyK8WfFxcg" ref="nofollow noopener noreferrer">ç»ˆç«¯é‡Œè·‘å›¾å½¢åº”ç”¨</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯¦è§£Reactç»„ä»¶çŠ¶æ€ç®¡ç†useState]]></title>    <link>https://juejin.cn/post/7573776814926315539</link>    <guid>https://juejin.cn/post/7573776814926315539</guid>    <pubDate>2025-11-18T00:20:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573776814926315539" data-draft-id="7568527869187997739" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯¦è§£Reactç»„ä»¶çŠ¶æ€ç®¡ç†useState"/> <meta itemprop="keywords" content="å‰ç«¯,React.js,JavaScript"/> <meta itemprop="datePublished" content="2025-11-18T00:20:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹å¤šå¤š"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯¦è§£Reactç»„ä»¶çŠ¶æ€ç®¡ç†useState
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹å¤šå¤š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:20:24.000Z" title="Tue Nov 18 2025 00:20:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"â€¢";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">1. å‰è¨€</h2>
<p>åœ¨ React çš„ä¸–ç•Œé‡Œï¼Œç»„ä»¶æ˜¯æ„å»ºç”¨æˆ·ç•Œé¢çš„åŸºçŸ³ï¼Œè€ŒçŠ¶æ€ï¼ˆstateï¼‰åˆ™èµ‹äºˆäº†è¿™äº›ç»„ä»¶åŠ¨æ€å˜åŒ–çš„èƒ½åŠ›ã€‚å…¶ä¸­ï¼ŒuseStateä½œä¸º React æä¾›çš„ä¸€ç§å¼ºå¤§çš„çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œæå¤§åœ°ç®€åŒ–äº†å‡½æ•°å¼ç»„ä»¶ä¸­çš„çŠ¶æ€å¤„ç†ï¼Œæˆä¸ºäº† React å¼€å‘è€…ä¸å¯æˆ–ç¼ºçš„åˆ©å™¨ã€‚æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ç†è§£useStateçš„å·¥ä½œåŸç†ã€ä½¿ç”¨æ–¹æ³•åŠå¸¸è§åœºæ™¯ï¼Œå¸®åŠ©ä½ åœ¨ React å¼€å‘ä¸­æ›´åŠ å¾—å¿ƒåº”æ‰‹åœ°ç®¡ç†ç»„ä»¶çŠ¶æ€ã€‚</p>
<h2 data-id="heading-1">2. useStateä»‹ç»</h2>
<p>useStateæ˜¯ React æä¾›çš„ä¸€ä¸ª Hook å‡½æ•°ï¼Œä¸“é—¨ç”¨äºåœ¨å‡½æ•°å¼ç»„ä»¶ä¸­æ·»åŠ çŠ¶æ€ã€‚åœ¨ React æ—©æœŸï¼ŒçŠ¶æ€ç®¡ç†ä¸»è¦ä¾èµ–äºç±»ç»„ä»¶ï¼ˆclass componentsï¼‰ï¼Œé€šè¿‡this.stateæ¥å®šä¹‰å’Œç®¡ç†çŠ¶æ€ã€‚ç„¶è€Œï¼Œç±»ç»„ä»¶çš„è¯­æ³•ç›¸å¯¹å¤æ‚ï¼Œä»£ç ç»“æ„ä¸å¤Ÿç®€æ´ã€‚React Hook çš„å‡ºç°æ”¹å˜äº†è¿™ä¸€å±€é¢ï¼ŒuseStateè®©å‡½æ•°å¼ç»„ä»¶ä¹Ÿèƒ½è½»æ¾æ‹¥æœ‰çŠ¶æ€ç®¡ç†èƒ½åŠ›ï¼Œä½¿å¾—ä»£ç æ›´åŠ ç®€æ´ã€æ˜“è¯»å’Œç»´æŠ¤ã€‚</p>
<h3 data-id="heading-2">2.1 åŸºæœ¬è¯­æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [state, setState] = <span class="hljs-title function_">useState</span>(initialState);
</code></pre>
<p>è¿™é‡Œï¼ŒuseStateæ¥å—ä¸€ä¸ªå‚æ•°initialStateï¼Œå³çŠ¶æ€çš„åˆå§‹å€¼ã€‚å®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ stateæ˜¯å½“å‰çŠ¶æ€çš„å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ setStateæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ›´æ–°çŠ¶æ€ã€‚</p>
<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œåˆ›å»ºä¸€ä¸ªè®¡æ•°å™¨ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState } <span class="hljs-keyword">from</span><span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ä½¿ç”¨useStateåˆ›å»ºä¸€ä¸ªåä¸ºcountçš„çŠ¶æ€å˜é‡ï¼Œåˆå§‹å€¼ä¸º0</span>
  <span class="hljs-comment">// setCountæ˜¯ç”¨æ¥æ›´æ–°countçŠ¶æ€çš„å‡½æ•°</span>
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      {/* ç‚¹å‡»æŒ‰é’®æ—¶è°ƒç”¨setCountæ¥æ›´æ–°countçŠ¶æ€ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Counter</span>;
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œcountåˆå§‹å€¼ä¸º 0ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼ŒsetCount(count + 1)ä¼šå°†countçš„å€¼åŠ  1ï¼Œå¹¶è§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œä»è€Œåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºæ›´æ–°åçš„countå€¼ã€‚</p>
<h3 data-id="heading-3">2.2. åŠ¨æ€è®¾ç½®åˆå§‹çŠ¶æ€</h3>
<p>initialStateä¸ä»…å¯ä»¥æ˜¯ä¸€ä¸ªå›ºå®šçš„å€¼ï¼Œè¿˜å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å½“initialStateæ˜¯å‡½æ•°æ—¶ï¼Œè¿™ä¸ªå‡½æ•°åªä¼šåœ¨ç»„ä»¶åˆå§‹æ¸²æŸ“æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œå…¶è¿”å›å€¼ä½œä¸ºçŠ¶æ€çš„åˆå§‹å€¼ã€‚è¿™ç§æ–¹å¼åœ¨åˆå§‹çŠ¶æ€éœ€è¦é€šè¿‡å¤æ‚è®¡ç®—æˆ–ä¾èµ–å…¶ä»–å˜é‡æ—¶éå¸¸æœ‰ç”¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// è¿›è¡Œä¸€äº›å¤æ‚è®¡ç®—</span>
  <span class="hljs-keyword">const</span> initialCount = <span class="hljs-title function_">someExpensiveComputation</span>();
  <span class="hljs-keyword">return</span> initialCount;
});
</code></pre>
<h3 data-id="heading-4">2.3. æ›´æ–°çŠ¶æ€çš„æ–¹å¼</h3>
<p>çŠ¶æ€æ›´æ–°æœ‰å¥½å‡ ç§æ–¹å¼ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚é‡‡ç”¨ä¸åŒçš„æ–¹å¼ã€‚</p>
<ul>
<li>ç›´æ¥æ›´æ–°</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">setCount</span>(<span class="hljs-number">5</span>);
</code></pre>
<p>è¿™æ˜¯æœ€å¸¸è§çš„æ–¹å¼ï¼Œç›´æ¥ä¼ å…¥æ–°çš„å€¼ç»™setStateå‡½æ•°ã€‚è¿™ç§æ–¹å¼ä¼šç›´æ¥ç”¨æ–°å€¼æ›¿æ¢å½“å‰çš„çŠ¶æ€å€¼ã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ›´å¤šæ—¶å€™æˆ‘ä»¬éœ€è¦åŸºäºå½“å‰çŠ¶æ€è¿›è¡Œæ›´æ–°ã€‚</p>
<ul>
<li>åŸºäºå‰ä¸€ä¸ªçŠ¶æ€æ›´æ–°</li>
</ul>
<p>å½“æ›´æ–°çŠ¶æ€ä¾èµ–äºå‰ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œåº”è¯¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ç»™setStateã€‚è¿™ä¸ªå‡½æ•°æ¥å—å‰ä¸€ä¸ªçŠ¶æ€ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›æ–°çš„çŠ¶æ€å€¼ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">prevCount</span> =&gt;</span> prevCount + <span class="hljs-number">1</span>);
</code></pre>
<p>è¿™ç§æ–¹å¼ç¡®ä¿äº†çŠ¶æ€æ›´æ–°æ˜¯åŸºäºæœ€æ–°çš„çŠ¶æ€ï¼Œé¿å…äº†åœ¨å¼‚æ­¥æ›´æ–°æˆ–å¤šæ¬¡è¿ç»­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œå¦‚æœè¿ç»­è°ƒç”¨setCountå¹¶ä¼ å…¥å›ºå®šå€¼ï¼Œå¯èƒ½æ— æ³•å¾—åˆ°é¢„æœŸçš„ç»“æœï¼Œå¦‚ä¸‹é”™è¯¯ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹</span>
<span class="hljs-title function_">setCount</span>(count + <span class="hljs-number">1</span>);
<span class="hljs-title function_">setCount</span>(count + <span class="hljs-number">1</span>);
<span class="hljs-title function_">setCount</span>(count + <span class="hljs-number">1</span>);
</code></pre>
<p>å› ä¸º React çš„çŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Œåœ¨è¿™ä¸‰æ¬¡è°ƒç”¨æ—¶ï¼Œcountçš„å€¼å¯èƒ½è¿˜æ˜¯åˆå§‹å€¼ï¼Œæœ€ç»ˆåªä¼šæ›´æ–°ä¸€æ¬¡ï¼Œç»“æœå¹¶éæˆ‘ä»¬æœŸæœ›çš„å¢åŠ äº† 3æ¬¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ­£ç¡®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹</span>
<span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">prevCount</span> =&gt;</span> prevCount + <span class="hljs-number">1</span>);
<span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">prevCount</span> =&gt;</span> prevCount + <span class="hljs-number">1</span>);
<span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">prevCount</span> =&gt;</span> prevCount + <span class="hljs-number">1</span>);
</code></pre>
<p>React ä¼šä¾æ¬¡å¤„ç†è¿™äº›æ›´æ–°å‡½æ•°ï¼Œç¡®ä¿æ¯æ¬¡æ›´æ–°éƒ½æ˜¯åŸºäºå‰ä¸€ä¸ªçŠ¶æ€ï¼Œæœ€ç»ˆcountä¼šæ­£ç¡®åœ°å¢åŠ  3ã€‚</p>
<h2 data-id="heading-5">3. ç»„ä»¶æ¸²æŸ“</h2>
<p>å½“è°ƒç”¨setStateæ›´æ–°çŠ¶æ€æ—¶ï¼ŒReact ä¼šè§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚åœ¨é‡æ–°æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼ŒuseStateä¼šè¿”å›æœ€æ–°çš„çŠ¶æ€å€¼ï¼Œç»„ä»¶ä¼šæ ¹æ®è¿™äº›æ–°å€¼é‡æ–°è®¡ç®—å¹¶æ›´æ–° UIã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒReact çš„æ¸²æŸ“æœºåˆ¶æ˜¯é«˜æ•ˆçš„ï¼Œå®ƒä¼šè¿›è¡Œæµ…æ¯”è¾ƒï¼ˆshallow comparisonï¼‰æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦çœŸæ­£æ›´æ–° DOMã€‚å¯¹äºå¤æ‚æ•°æ®ç±»å‹ï¼ˆå¦‚å¯¹è±¡å’Œæ•°ç»„ï¼‰ï¼Œå¦‚æœç›´æ¥ä¿®æ”¹å†…éƒ¨å±æ€§è€Œä¸æ”¹å˜å…¶å¼•ç”¨ï¼ŒReact å¯èƒ½æ— æ³•æ£€æµ‹åˆ°çŠ¶æ€çš„å˜åŒ–ï¼Œä»è€Œä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚ä¾‹å¦‚ä¸‹é¢ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [person, setPerson] = <span class="hljs-title function_">useState</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> });

<span class="hljs-comment">// é”™è¯¯æ–¹å¼ï¼Œä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“</span>
person.<span class="hljs-property">age</span> = <span class="hljs-number">31</span>;
<span class="hljs-title function_">setPerson</span>(person);

<span class="hljs-comment">// æ­£ç¡®æ–¹å¼ï¼Œé€šè¿‡åˆ›å»ºæ–°å¯¹è±¡æ¥æ›´æ–°çŠ¶æ€</span>
<span class="hljs-title function_">setPerson</span>({...person, <span class="hljs-attr">age</span>: <span class="hljs-number">31</span> });
</code></pre>
<p>åœ¨æ›´æ–°å¯¹è±¡æˆ–æ•°ç»„çŠ¶æ€æ—¶ï¼Œåº”è¯¥å§‹ç»ˆåˆ›å»ºæ–°çš„å¯¹è±¡æˆ–æ•°ç»„ï¼Œä»¥ç¡®ä¿ React èƒ½å¤Ÿæ£€æµ‹åˆ°çŠ¶æ€å˜åŒ–å¹¶è§¦å‘é‡æ–°æ¸²æŸ“ã€‚</p>
<h2 data-id="heading-6">4. å¸¸è§åº”ç”¨åœºæ™¯</h2>
<ul>
<li>è¡¨å•å¤„ç†</li>
</ul>
<p>åœ¨å¤„ç†è¡¨å•è¾“å…¥æ—¶ï¼ŒuseStateå¯ä»¥æ–¹ä¾¿åœ°ç®¡ç†è¾“å…¥å€¼ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState } <span class="hljs-keyword">from</span><span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Input</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e</span>) =&gt; {
    <span class="hljs-title function_">setInputValue</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{inputValue}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You typed: {inputValue}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Input</span>;
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒinputValueçŠ¶æ€å­˜å‚¨äº†è¾“å…¥æ¡†çš„å€¼ï¼Œæ¯æ¬¡è¾“å…¥æ¡†å†…å®¹å˜åŒ–æ—¶ï¼Œé€šè¿‡setInputValueæ›´æ–°çŠ¶æ€ï¼ŒåŒæ—¶ä¹Ÿæ›´æ–°äº†è¾“å…¥æ¡†çš„æ˜¾ç¤ºå€¼ã€‚</p>
<ul>
<li>åˆ‡æ¢å¸ƒå°”çŠ¶æ€</li>
</ul>
<p>useStateä¹Ÿå¸¸ç”¨äºåˆ‡æ¢å¸ƒå°”ç±»å‹çš„çŠ¶æ€ï¼Œæ¯”å¦‚æ§åˆ¶å…ƒç´ çš„æ˜¾ç¤ºä¸éšè—ã€æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€ç­‰ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å¼€å…³æŒ‰é’®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState } <span class="hljs-keyword">from</span><span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">ToggleButton</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [isOn, setIsOn] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setIsOn</span>(!isOn);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>
      {isOn? 'ON' : 'OFF'}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">ToggleButton</span>;
</code></pre>
<p>ç‚¹å‡»æŒ‰é’®æ—¶ï¼ŒsetIsOn(!isOn)ä¼šå–åisOnçš„çŠ¶æ€ï¼Œä»è€Œåˆ‡æ¢æŒ‰é’®çš„æ˜¾ç¤ºæ–‡æœ¬ã€‚</p>
<h2 data-id="heading-7">5. å¸¸è§é¢è¯•è¦ç‚¹</h2>
<ul>
<li><strong>åŒä¸€ä¸ªç»„ä»¶æ¸²æŸ“å¤šæ¬¡ä¼šäº’ç›¸å½±å“å—ï¼Ÿ</strong>
<ul>
<li>State æ˜¯ç»„ä»¶å®ä¾‹å†…éƒ¨çš„çŠ¶æ€ï¼Œéš”ç¦»ä¸”ç§æœ‰çš„ã€‚å¦‚æœä½ æ¸²æŸ“åŒä¸€ä¸ªç»„ä»¶ä¸¤æ¬¡ï¼Œæ¯ä¸ªç»„ä»¶éƒ½ä¼šæœ‰å®Œå…¨éš”ç¦»çš„ stateï¼Œæ”¹å˜å…¶ä¸­ä¸€ä¸ªä¸ä¼šå½±å“å¦ä¸€ä¸ªã€‚</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆè¦åœ¨setStateä¸­ä½¿ç”¨å›è°ƒå‡½æ•°æ›´æ–°çŠ¶æ€ï¼Ÿ</strong>
<ul>
<li>å½“çŠ¶æ€æ›´æ–°ä¾èµ–å‰ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œæ­¤æ—¶å€¼å¯èƒ½è¿˜æ˜¯åˆå§‹å€¼ã€‚è€Œä½¿ç”¨å›è°ƒå‡½æ•°èƒ½ç¡®ä¿è·å–åˆ°æœ€æ–°çš„çŠ¶æ€å€¼è¿›è¡Œæ›´æ–°ï¼Œé¿å…å¼‚æ­¥æ›´æ–°å¸¦æ¥çš„é—®é¢˜ã€‚</li>
</ul>
</li>
<li><strong>å¦‚ä½•æ­£ç¡®æ›´æ–°å¯¹è±¡æˆ–æ•°ç»„ç±»å‹çš„çŠ¶æ€ï¼Ÿ</strong>
<ul>
<li>é€šè¿‡åˆ›å»ºæ–°çš„å¯¹è±¡æˆ–æ•°ç»„ï¼Œä½¿ç”¨å±•å¼€è¿ç®—ç¬¦ï¼ˆ...ï¼‰ç­‰æ–¹å¼ï¼Œç¡®ä¿çŠ¶æ€çš„å¼•ç”¨å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œè§¦å‘ React çš„é‡æ–°æ¸²æŸ“ã€‚</li>
</ul>
</li>
<li><strong>useStateå’Œç±»ç»„ä»¶ä¸­çš„this.stateæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong>
<ul>
<li>useStateç”¨äºå‡½æ•°å¼ç»„ä»¶ï¼Œè¯­æ³•æ›´ç®€æ´ï¼ŒåŸºäº Hook æœºåˆ¶ï¼›è€Œç±»ç»„ä»¶ä¸­çš„this.stateé€šè¿‡this.setStateæ›´æ–°çŠ¶æ€ï¼Œè¯­æ³•ç›¸å¯¹å¤æ‚ï¼Œè¿˜æ¶‰åŠç”Ÿå‘½å‘¨æœŸå‡½æ•°ç­‰æ¦‚å¿µã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-8">6. å®ç°åŸç†å’Œä»¿å†™</h2>
<p>useStateçš„å®ç°åŸç†ä¸ React çš„åº•å±‚æ¶æ„å’Œè¿è¡Œæœºåˆ¶ç´§å¯†ç›¸å…³ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>
<ul>
<li>çŠ¶æ€å­˜å‚¨ï¼šåœ¨ React å†…éƒ¨ï¼Œæ¯ä¸ªå‡½æ•°å¼ç»„ä»¶éƒ½ç»´æŠ¤ç€ä¸€ä¸ªçŠ¶æ€é“¾è¡¨ã€‚å½“ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶ï¼ŒuseStateä¼šå°†ä¼ å…¥çš„initialStateå­˜å…¥è¿™ä¸ªé“¾è¡¨ä¸­ã€‚æ¯è°ƒç”¨ä¸€æ¬¡useStateï¼Œå°±ä¼šåœ¨é“¾è¡¨ä¸­æ–°å¢ä¸€ä¸ªçŠ¶æ€èŠ‚ç‚¹ï¼Œå¹¶ä¸”useStateè¿”å›å¯¹åº”çš„çŠ¶æ€å€¼å’Œæ›´æ–°å‡½æ•°ã€‚æ¯”å¦‚åœ¨ä¸€ä¸ªç»„ä»¶ä¸­å¤šæ¬¡ä½¿ç”¨useStateåˆ†åˆ«ç®¡ç†ä¸åŒçŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€å°±ä¼šä¾æ¬¡å­˜å…¥é“¾è¡¨ï¼Œå½¼æ­¤ç‹¬ç«‹åˆæœ‰åºå…³è” ã€‚å…¶å®ï¼Œåœ¨ React å†…éƒ¨ï¼Œä¸ºæ¯ä¸ªç»„ä»¶ä¿å­˜äº†ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ª state å¯¹ã€‚å®ƒç»´æŠ¤å½“å‰ state å¯¹çš„ç´¢å¼•å€¼ï¼Œåœ¨æ¸²æŸ“ä¹‹å‰å°†å…¶è®¾ç½®ä¸º â€œ0â€ã€‚æ¯æ¬¡è°ƒç”¨ useState æ—¶ï¼ŒReact éƒ½ä¼šä¸ºä½ æä¾›ä¸€ä¸ª state å¯¹å¹¶å¢åŠ ç´¢å¼•å€¼ã€‚</li>
<li>æ›´æ–°æœºåˆ¶ï¼šå½“setStateè¢«è°ƒç”¨æ—¶ï¼ŒReact å¹¶ä¸ä¼šç«‹å³æ›´æ–°çŠ¶æ€ã€‚è€Œæ˜¯ä¼šå°†æ›´æ–°ä»»åŠ¡æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç­‰åˆ°åˆé€‚çš„æ—¶æœºï¼ˆå¦‚æµè§ˆå™¨ç©ºé—²æ—¶ï¼‰è¿›è¡Œæ‰¹é‡å¤„ç†ã€‚React ä¼šæ ¹æ®æ›´æ–°çš„é¡ºåºæ‰¾åˆ°çŠ¶æ€é“¾è¡¨ä¸­å¯¹åº”çš„çŠ¶æ€èŠ‚ç‚¹ï¼Œæ›´æ–°å…¶å€¼ã€‚æ›´æ–°å®Œæˆåï¼ŒReact ä¼šè§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚åœ¨é‡æ–°æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼ŒuseStateä¼šä»çŠ¶æ€é“¾è¡¨ä¸­è·å–æœ€æ–°çš„çŠ¶æ€å€¼å¹¶è¿”å›ï¼Œä»¥ä¾¿ç»„ä»¶æ ¹æ®æ–°å€¼é‡æ–°è®¡ç®—å¹¶æ›´æ–° UIã€‚</li>
<li>Fiber æ¶æ„ï¼šReact çš„æ›´æ–°æœºåˆ¶åŸºäºFiberæ¶æ„ï¼ŒFiberæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒä¸º React å¸¦æ¥äº†å¯ä¸­æ–­å’Œæ¢å¤çš„æ¸²æŸ“èƒ½åŠ›ã€‚setStateè°ƒç”¨åï¼ŒReact ä¼šåŸºäºFiberè¿›è¡Œè°ƒåº¦å’Œåè°ƒæ›´æ–°ä»»åŠ¡ã€‚è¿™ä½¿å¾— React åœ¨é¢å¯¹å¤æ‚äº¤äº’åœºæ™¯å’Œé•¿æ—¶é—´è¿è¡Œä»»åŠ¡æ—¶ï¼Œèƒ½å¤Ÿåˆç†åˆ†é…æ¸²æŸ“æ—¶é—´ï¼Œé¿å…ä¸»çº¿ç¨‹é˜»å¡ï¼Œæå‡åº”ç”¨çš„å“åº”æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚åŒæ—¶ï¼ŒFiberæ¶æ„ä¹Ÿå¸®åŠ© React æ›´é«˜æ•ˆåœ°ç®¡ç†ç»„ä»¶çš„æ›´æ–°è¿‡ç¨‹ï¼Œç¡®ä¿çŠ¶æ€æ›´æ–°å’Œé‡æ–°æ¸²æŸ“çš„å‡†ç¡®æ€§ä¸ç¨³å®šæ€§ã€‚</li>
</ul>
<p>è¿™ä¸ªæ˜¯å®˜æ–¹çš„å®ç°Demoï¼Œå¯ä»¥è®©æˆ‘ä»¬äº†è§£ useState åœ¨å†…éƒ¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzh-hans.react.dev%2Flearn%2Fstate-a-components-memory%23giving-a-component-multiple-state-variables" target="_blank" title="https://zh-hans.react.dev/learn/state-a-components-memory#giving-a-component-multiple-state-variables" ref="nofollow noopener noreferrer">ä¼ é€é—¨</a></p>
<h2 data-id="heading-9">6. æ€»ç»“</h2>
<p>useStateä½œä¸º React å‡½æ•°å¼ç»„ä»¶ä¸­çŠ¶æ€ç®¡ç†çš„æ ¸å¿ƒå·¥å…·ï¼Œä¸ºå¼€å‘è€…æä¾›äº†ç®€æ´è€Œå¼ºå¤§çš„çŠ¶æ€å¤„ç†èƒ½åŠ›ã€‚é€šè¿‡ç†è§£å…¶åŸºæœ¬ç”¨æ³•ã€æ›´æ–°æœºåˆ¶ä»¥åŠåœ¨å¸¸è§åœºæ™¯ä¸­çš„åº”ç”¨ï¼Œä½ å¯ä»¥æ›´åŠ é«˜æ•ˆåœ°æ„å»ºåŠ¨æ€ã€äº¤äº’å¼çš„ React åº”ç”¨ã€‚è€Œåœ¨é¡¹ç›®ä¸­ä½¿ç”¨useStateæ—¶ï¼Œæ¯ä¸ªuseStateå°½é‡åªç®¡ç†ä¸€ä¸ªé€»è¾‘ç›¸å…³çš„çŠ¶æ€ï¼Œä¿æŒçŠ¶æ€çš„å•ä¸€èŒè´£ã€‚</p>
<hr/>
<blockquote>
<p>æœ¬æ¬¡åˆ†äº«å°±åˆ°è¿™å„¿å•¦ï¼Œæˆ‘æ˜¯é¹å¤šå¤šï¼Œæ·±è€•å‰ç«¯çš„æŠ€æœ¯åˆ›ä½œè€…ï¼Œå¦‚æœæ‚¨çœ‹äº†è§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯„è®ºï¼Œå…³æ³¨ï¼Œç‚¹èµï¼Œè½¬å‘ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§~</p>
</blockquote>
<p>PSï¼šåœ¨æœ¬é¡µæŒ‰F12ï¼Œåœ¨consoleä¸­è¾“å…¥document.getElementsByClassName('panel-btn')[0].click();æœ‰æƒŠå–œå“¦~</p>
<p><code>å¾€æœŸæ–‡ç« </code></p>
<ul>
<li><a href="https://juejin.cn/post/7568192652286754870" target="_blank" title="https://juejin.cn/post/7568192652286754870">çº¯å‰ç«¯æå–å›¾ç‰‡é¢œè‰²æ’ä»¶Color-Thiefæ•™å­¦+å®æˆ˜å®Œæ•´æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7565737512816771135" target="_blank" title="https://juejin.cn/post/7565737512816771135">react-konvaå®æˆ˜æŒ‡å—ï¼šCanvasé«˜æ€§èƒ½+æ˜“ç»´æŠ¤çš„ç»„ä»¶åŒ–å›¾å½¢å¼€å‘å®ç°æ•™ç¨‹</a></li>
<li><a href="https://juejin.cn/post/7560905838074462271" target="_blank" title="https://juejin.cn/post/7560905838074462271">Reactæ— é™æ»šåŠ¨æ’ä»¶react-infinite-scroll-componentçš„é…ç½®+ä¼˜åŒ–+é¿å‘æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7560542615484137491" target="_blank" title="https://juejin.cn/post/7560542615484137491">å‰ç«¯éŸ³é¢‘å…¼å®¹è§£å†³ï¼šéŸ³é¢‘ç¥å™¨howler.jsä»åŸºç¡€åˆ°è¿›é˜¶å®Œæ•´ä½¿ç”¨æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7559871680015024169" target="_blank" title="https://juejin.cn/post/7559871680015024169">ä½¿ç”¨React-OAuthè¿›è¡ŒGoogle/GitHubç™»å½•çš„æ•™ç¨‹å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7550585427834404927" target="_blank" title="https://juejin.cn/post/7550585427834404927">çº¯å‰ç«¯äººè„¸è¯†åˆ«åˆ©å™¨ï¼šface-api.jsæ‰‹æŠŠæ‰‹æ·±å…¥è§£ææ•™å­¦</a></li>
<li><a href="https://juejin.cn/post/7553865490732433462" target="_blank" title="https://juejin.cn/post/7553865490732433462">å…³äºReactçˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•forwardRefçš„è¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7553484874609410074" target="_blank" title="https://juejin.cn/post/7553484874609410074">Reactè·¨ç»„ä»¶æ•°æ®å…±äº«useContextè¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7545087762837815334" target="_blank" title="https://juejin.cn/post/7545087762837815334">Webå›¾åƒç¼–è¾‘ç¥å™¨tui.image-editorä»åŸºç¡€åˆ°è¿›é˜¶çš„å®æˆ˜æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7544323659788288046" target="_blank" title="https://juejin.cn/post/7544323659788288046">å¼€å‘ä¸ªäººå¾®ä¿¡å°ç¨‹åºç±»ç›®é€‰æ‹©/ç›ˆåˆ©æ–¹å¼/æˆæœ¬æ§åˆ¶ä¸æœåŠ¡å™¨æ¥å…¥æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7541741121400864778" target="_blank" title="https://juejin.cn/post/7541741121400864778">å‰ç«¯å›¾ç‰‡è£å‰ªCropper.jsæ ¸å¿ƒåŠŸèƒ½ä¸å®æˆ˜æŠ€å·§è¯¦è§£</a></li>
<li><a href="https://juejin.cn/post/7536530451461472265" target="_blank" title="https://juejin.cn/post/7536530451461472265">ç¼–è¾‘å™¨ä¹Ÿæœ‰é‚ªä¿®ï¼Ÿç›˜ç‚¹VS Codeé‚ªé—¨/æœ‰è¶£çš„æ‰©å±•</a></li>
<li><a href="https://juejin.cn/post/7535005018257981466" target="_blank" title="https://juejin.cn/post/7535005018257981466">jsä½¿ç”¨IntersectionObserverå®ç°ç›®æ ‡å…ƒç´ å¯è§åº¦çš„äº¤äº’</a></li>
<li><a href="https://juejin.cn/post/7534547200330121225" target="_blank" title="https://juejin.cn/post/7534547200330121225">Webå‰ç«¯é¡µé¢å¼€å‘é˜¿æ‹‰ä¼¯è¯­ç§é€‚é…æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7516122409948020736" target="_blank" title="https://juejin.cn/post/7516122409948020736">è®©ç½‘é¡µæ‹¥æœ‰Appä½“éªŒï¼ŸPWA å°†ç½‘é¡µå˜ä¸ºæ¡Œé¢åº”ç”¨çš„ä¿å§†çº§æ•™ç¨‹PWA</a></li>
<li><a href="https://juejin.cn/post/6953803916484018206" target="_blank" title="https://juejin.cn/post/6953803916484018206">ä½¿ç”¨nvmç®¡ç†node.jsç‰ˆæœ¬ä»¥åŠæ›´æ¢npmæ·˜å®é•œåƒæº</a></li>
<li><a href="https://juejin.cn/post/7140443283209060383" target="_blank" title="https://juejin.cn/post/7140443283209060383">æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»ºè§„èŒƒçš„å›¢é˜Ÿvueé¡¹ç›®ï¼ŒåŒ…å«commitlintï¼Œeslintï¼Œprettierï¼Œhuskyï¼Œcommitizenç­‰ç­‰</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•å°† MP4 æ–‡ä»¶è½¬æ¢ä¸º M3U8 æ ¼å¼å¹¶å®ç°æµåª’ä½“æ’­æ”¾]]></title>    <link>https://juejin.cn/post/7573525927793950746</link>    <guid>https://juejin.cn/post/7573525927793950746</guid>    <pubDate>2025-11-18T00:20:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573525927793950746" data-draft-id="7573519273030729774" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•å°† MP4 æ–‡ä»¶è½¬æ¢ä¸º M3U8 æ ¼å¼å¹¶å®ç°æµåª’ä½“æ’­æ”¾"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-18T00:20:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="excel"/> <meta itemprop="url" content="https://juejin.cn/user/2911162520062862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•å°† MP4 æ–‡ä»¶è½¬æ¢ä¸º M3U8 æ ¼å¼å¹¶å®ç°æµåª’ä½“æ’­æ”¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2911162520062862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    excel
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:20:18.000Z" title="Tue Nov 18 2025 00:20:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å¼•è¨€</h3>
<p>åœ¨ç°ä»£çš„æµåª’ä½“ä¼ è¾“ä¸­ï¼Œ<strong>HLSï¼ˆHTTP Live Streamingï¼‰</strong> åè®®å› å…¶é«˜æ•ˆã€çµæ´»çš„ç‰¹ç‚¹å¹¿æ³›åº”ç”¨äºè§†é¢‘ç›´æ’­å’Œç‚¹æ’­ã€‚HLS å°†è§†é¢‘æ–‡ä»¶åˆ†å‰²æˆå¤šä¸ªå°çš„ <code>.ts</code>ï¼ˆMPEG-TSï¼‰ç‰‡æ®µï¼Œå¹¶é€šè¿‡ M3U8 æ’­æ”¾åˆ—è¡¨æ¥ç®¡ç†è¿™äº›ç‰‡æ®µçš„åŠ è½½é¡ºåºã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•å°†å¸¸è§çš„ MP4 æ–‡ä»¶è½¬æ¢ä¸º M3U8 æ ¼å¼ï¼Œä»¥åŠè¿™ä¸€è¿‡ç¨‹å¯¹æµåª’ä½“æ’­æ”¾å¸¦æ¥çš„ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆéœ€è¦ M3U8 å’Œ HLSï¼Ÿ</h3>
<p>HLS åè®®ä¸ M3U8 æ ¼å¼ç´§å¯†ç»“åˆï¼Œå…±åŒä½œç”¨äºæµåª’ä½“æ’­æ”¾ã€‚å…¶ä¸»è¦ä¼˜åŠ¿ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ol>
<li><strong>æé«˜åŠ è½½é€Ÿåº¦</strong>ï¼šä¼ ç»Ÿè§†é¢‘éœ€è¦ä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ªæ–‡ä»¶ï¼Œç­‰å¾…ç¼“å†²åæ‰å¯æ’­æ”¾ï¼Œè€Œ HLS ä½¿ç”¨ M3U8 æ–‡ä»¶å°†è§†é¢‘åˆ‡å‰²æˆå¤šä¸ªçŸ­å°çš„ç‰‡æ®µï¼Œå¯ä»¥é€ç‰‡åŠ è½½ï¼Œæ’­æ”¾æ›´è¿…é€Ÿã€‚</li>
<li><strong>è‡ªé€‚åº”æµ</strong>ï¼šHLS æ”¯æŒæ ¹æ®ç”¨æˆ·çš„ç½‘ç»œå¸¦å®½åŠ¨æ€é€‰æ‹©è§†é¢‘åˆ†æ®µçš„è´¨é‡ï¼Œè¿™ä¿è¯äº†ä¸åŒç½‘ç»œæ¡ä»¶ä¸‹çš„æµç•…æ’­æ”¾ã€‚</li>
<li><strong>å®¹é”™æ€§é«˜</strong>ï¼šè§†é¢‘åˆ†æ®µæ–‡ä»¶å¯ä»¥åœ¨ç½‘ç»œä¸­æ–­çš„æƒ…å†µä¸‹ä»ä¸­æ–­å¤„ç»§ç»­æ’­æ”¾ï¼Œé¿å…äº†é‡æ–°åŠ è½½æ•´ä¸ªè§†é¢‘çš„éº»çƒ¦ã€‚</li>
<li><strong>å¹¿æ³›çš„å…¼å®¹æ€§</strong>ï¼šç”±äº HLS åŸºäº HTTP åè®®ï¼Œå‡ ä¹æ‰€æœ‰ç°ä»£æµè§ˆå™¨å’Œè®¾å¤‡éƒ½èƒ½æ”¯æŒã€‚</li>
</ol>
<h3 data-id="heading-2">å¦‚ä½•å°† MP4 è½¬æ¢ä¸º M3U8 æ ¼å¼ï¼Ÿ</h3>
<p>å°† MP4 æ–‡ä»¶è½¬æ¢ä¸º M3U8 æ ¼å¼å¹¶ç”Ÿæˆå¤šä¸ªè§†é¢‘ç‰‡æ®µçš„è¿‡ç¨‹ä¸»è¦ä¾èµ–äº <strong>FFmpeg</strong> å·¥å…·ã€‚ä»¥ä¸‹æ˜¯è½¬æ¢æ­¥éª¤ï¼š</p>
<h4 data-id="heading-3">æ­¥éª¤ 1ï¼šå®‰è£… FFmpeg</h4>
<p>FFmpeg æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¤šåª’ä½“å¤„ç†å·¥å…·ï¼Œå¯ä»¥å¤„ç†å‡ ä¹æ‰€æœ‰è§†é¢‘æ ¼å¼çš„è½¬æ¢å’Œæµå¼ä¼ è¾“ã€‚æ‚¨å¯ä»¥åœ¨ FFmpeg å®˜ç½‘ä¸‹è½½å¹¶å®‰è£…è¯¥å·¥å…·ã€‚</p>
<p><strong>Windows å®‰è£…å‘½ä»¤</strong>ï¼š</p>
<ol>
<li>ä¸‹è½½ <a href="https://link.juejin.cn?target=https%3A%2F%2Fffmpeg.org%2Fdownload.html" target="_blank" title="https://ffmpeg.org/download.html" ref="nofollow noopener noreferrer">FFmpeg</a> å®‰è£…åŒ…ã€‚</li>
<li>é…ç½®ç¯å¢ƒå˜é‡ï¼Œç¡®ä¿åœ¨å‘½ä»¤è¡Œä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>ffmpeg</code> å‘½ä»¤ã€‚</li>
</ol>
<p><strong>Linux å®‰è£…å‘½ä»¤</strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo apt <span class="hljs-keyword">update</span>
sudo apt install ffmpeg
</code></pre>
<h4 data-id="heading-4">æ­¥éª¤ 2ï¼šå°† MP4 è½¬æ¢ä¸º M3U8</h4>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°† MP4 æ–‡ä»¶è½¬æ¢ä¸º M3U8 æ ¼å¼ï¼Œå¹¶å°†è§†é¢‘åˆ‡å‰²æˆå¤šä¸ª <code>.ts</code> ç‰‡æ®µï¼š</p>
<pre><code class="hljs language-css" lang="css">ffmpeg -<span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">video</span><span class="hljs-selector-class">.mp4</span> -profile:v baseline -level <span class="hljs-number">3.0</span> -start_number <span class="hljs-number">0</span> -hls_time <span class="hljs-number">10</span> -hls_list_size <span class="hljs-number">0</span> -f hls output.m3u8
</code></pre>
<h5 data-id="heading-5">å‚æ•°è§£æï¼š</h5>
<ul>
<li><strong>-i video.mp4</strong>ï¼šè¾“å…¥æ–‡ä»¶ä¸º <code>video.mp4</code>ã€‚</li>
<li><strong>-profile:v baseline -level 3.0</strong>ï¼šè®¾ç½®è§†é¢‘ç¼–ç çš„å…¼å®¹æ€§ï¼Œç¡®ä¿èƒ½å¤Ÿåœ¨ä½å¸¦å®½è®¾å¤‡ä¸Šæ’­æ”¾ã€‚</li>
<li><strong>-start_number 0</strong>ï¼šå®šä¹‰åˆ†æ®µç¼–å·ä» 0 å¼€å§‹ã€‚</li>
<li><strong>-hls_time 10</strong>ï¼šè®¾ç½®æ¯ä¸ª <code>.ts</code> æ–‡ä»¶çš„æ—¶é•¿ä¸º 10 ç§’ï¼ˆå¯ä»¥æ ¹æ®éœ€æ±‚è°ƒæ•´ï¼‰ã€‚</li>
<li><strong>-hls_list_size 0</strong>ï¼šæŒ‡å®šæ’­æ”¾åˆ—è¡¨åŒ…å«æ‰€æœ‰ç‰‡æ®µï¼Œä¸åšé™åˆ¶ã€‚</li>
<li><strong>-f hls</strong>ï¼šæŒ‡å®šè¾“å‡ºæ ¼å¼ä¸º HLSã€‚</li>
<li><strong>output.m3u8</strong>ï¼šè¾“å‡ºçš„æ’­æ”¾åˆ—è¡¨æ–‡ä»¶åã€‚</li>
</ul>
<p>æ‰§è¡Œåï¼Œæ‚¨å°†å¾—åˆ°ä¸€ä¸ª M3U8 æ’­æ”¾åˆ—è¡¨æ–‡ä»¶ï¼ˆ<code>output.m3u8</code>ï¼‰å’Œå¤šä¸ª <code>.ts</code> æ–‡ä»¶ï¼ˆè§†é¢‘åˆ†ç‰‡ï¼‰ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">output.m3u8       <span class="hljs-comment"># æ’­æ”¾åˆ—è¡¨</span>
output0.ts        <span class="hljs-comment"># ç¬¬ä¸€æ®µè§†é¢‘</span>
output1.ts        <span class="hljs-comment"># ç¬¬äºŒæ®µè§†é¢‘</span>
output2.ts        <span class="hljs-comment"># ç¬¬ä¸‰æ®µè§†é¢‘</span>
...
</code></pre>
<h3 data-id="heading-6">3. å¦‚ä½•æ’­æ”¾ M3U8 æ–‡ä»¶</h3>
<p>åœ¨è½¬æ¢å®Œæˆåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ’­æ”¾å™¨æ’­æ”¾è¿™äº›è§†é¢‘ã€‚é€šè¿‡ <strong>HLS.js</strong> åº“ï¼Œæ‚¨å¯ä»¥å°† M3U8 æ–‡ä»¶ä¸ HTML5 <code>&lt;video&gt;</code> å…ƒç´ ç»“åˆä½¿ç”¨ã€‚</p>
<h4 data-id="heading-7">ç¤ºä¾‹ HTML æ’­æ”¾å™¨ï¼š</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"video"</span> <span class="hljs-attr">controls</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/hls.js@latest"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">var</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'video'</span>);
  <span class="hljs-keyword">var</span> hls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hls</span>();

  <span class="hljs-comment">// å¦‚æœæµè§ˆå™¨æ”¯æŒ HLS.js</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Hls</span>.<span class="hljs-title function_">isSupported</span>()) {
    hls.<span class="hljs-title function_">loadSource</span>(<span class="hljs-string">'output.m3u8'</span>);
    hls.<span class="hljs-title function_">attachMedia</span>(video);
  }
  <span class="hljs-comment">// å¦‚æœæµè§ˆå™¨åŸç”Ÿæ”¯æŒ HLS</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (video.<span class="hljs-title function_">canPlayType</span>(<span class="hljs-string">'application/vnd.apple.mpegurl'</span>)) {
    video.<span class="hljs-property">src</span> = <span class="hljs-string">'output.m3u8'</span>;
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>è¿™æ®µä»£ç ä¼šè‡ªåŠ¨åŠ è½½å¹¶æ’­æ”¾é€šè¿‡ M3U8 æ’­æ”¾åˆ—è¡¨æä¾›çš„è§†é¢‘ç‰‡æ®µã€‚HLS.js ä¼šç¡®ä¿æ’­æ”¾å™¨åœ¨ä¸åŒç½‘ç»œæ¡ä»¶ä¸‹è‡ªåŠ¨é€‚åº”å¹¶åŠ è½½åˆé€‚çš„è§†é¢‘åˆ†æ®µã€‚</p>
<h3 data-id="heading-8">4. åˆ†æ®µåŠ è½½çš„ä¼˜åŠ¿</h3>
<h4 data-id="heading-9">4.1 å¿«é€ŸåŠ è½½</h4>
<p>ç”±äºè§†é¢‘è¢«åˆ‡åˆ†ä¸ºå¤šä¸ªå°çš„ <code>.ts</code> æ–‡ä»¶ï¼Œæ’­æ”¾å™¨å¯ä»¥åœ¨ç¬¬ä¸€æ®µåŠ è½½å®Œæˆåç«‹å³å¼€å§‹æ’­æ”¾è§†é¢‘ï¼Œè€Œä¸éœ€è¦ç­‰åˆ°æ•´ä¸ªè§†é¢‘æ–‡ä»¶ä¸‹è½½å®Œæˆã€‚è¿™æ ·ä¸ä»…åŠ é€Ÿäº†æ’­æ”¾çš„å¯åŠ¨æ—¶é—´ï¼Œä¹Ÿæå‡äº†ç”¨æˆ·ä½“éªŒã€‚</p>
<h4 data-id="heading-10">4.2 çµæ´»çš„ç ç‡åˆ‡æ¢</h4>
<p>HLS åè®®æ”¯æŒæ ¹æ®å¸¦å®½çš„å˜åŒ–åŠ¨æ€è°ƒæ•´è§†é¢‘è´¨é‡ã€‚å¦‚æœç”¨æˆ·çš„ç½‘ç»œçŠ¶å†µä¸ä½³ï¼Œæ’­æ”¾å™¨å¯ä»¥è‡ªåŠ¨é€‰æ‹©ä½è´¨é‡çš„è§†é¢‘æµï¼Œä»è€Œé¿å…ç¼“å†²æˆ–å¡é¡¿ã€‚è¿™ç§è‡ªé€‚åº”çš„æµå¼ä¼ è¾“æ–¹å¼å¤§å¤§æå‡äº†è§†é¢‘æ’­æ”¾çš„ç¨³å®šæ€§ã€‚</p>
<h4 data-id="heading-11">4.3 ç½‘ç»œå®¹é”™æ€§</h4>
<p>å¦‚æœç”¨æˆ·åœ¨è§‚çœ‹è¿‡ç¨‹ä¸­ç½‘ç»œä¸­æ–­æˆ–è¿æ¥ä¸ç¨³å®šï¼ŒHLS åè®®å¯ä»¥ä»æ–­ç‚¹å¤„ç»§ç»­åŠ è½½è§†é¢‘åˆ†ç‰‡ï¼Œè€Œä¸éœ€è¦ä»å¤´å¼€å§‹åŠ è½½æ•´ä¸ªè§†é¢‘ã€‚è¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘å› ç½‘ç»œæ³¢åŠ¨å¸¦æ¥çš„æ’­æ”¾ä¸­æ–­ã€‚</p>
<h4 data-id="heading-12">4.4 è·¨å¹³å°æ”¯æŒ</h4>
<p>HLS åŸºäº HTTP åè®®ï¼Œæ”¯æŒå„ç§å¹³å°ï¼ŒåŒ…æ‹¬æ¡Œé¢æµè§ˆå™¨ã€ç§»åŠ¨è®¾å¤‡ã€æ™ºèƒ½ç”µè§†ç­‰ã€‚è€Œä¸”ï¼ŒHLS.js ä½¿å¾—åœ¨ä¸æ”¯æŒ HLS åŸç”Ÿæ’­æ”¾çš„æµè§ˆå™¨ä¸Šä¹Ÿèƒ½æ­£å¸¸æ’­æ”¾ M3U8 æ ¼å¼çš„è§†é¢‘ã€‚</p>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p>é€šè¿‡å°† MP4 æ–‡ä»¶è½¬æ¢ä¸º M3U8 æ ¼å¼ï¼Œè§†é¢‘å¯ä»¥è¢«åˆ‡å‰²æˆå¤šä¸ªå°ç‰‡æ®µï¼ŒæŒ‰éœ€åŠ è½½å¹¶é¡ºåºæ’­æ”¾ã€‚ä½¿ç”¨ FFmpeg å·¥å…·è¿›è¡Œè½¬æ¢ï¼Œä¸ä»…æ“ä½œç®€å•ï¼Œè¿˜èƒ½åœ¨ HLS åè®®ä¸‹æé«˜æµåª’ä½“æ’­æ”¾çš„æ•ˆç‡å’Œå®¹é”™èƒ½åŠ›ã€‚HLS ä½¿å¾—è§†é¢‘èƒ½å¤Ÿæ ¹æ®ç½‘ç»œå¸¦å®½è‡ªé€‚åº”è°ƒæ•´è´¨é‡ï¼ŒåŒæ—¶æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œå°¤å…¶åœ¨å®æ—¶ç›´æ’­å’Œç‚¹æ’­åœºæ™¯ä¸­è¡¨ç°å°¤ä¸ºçªå‡ºã€‚</p>
<hr/>
<p>æœ¬æ–‡éƒ¨åˆ†å†…å®¹å€ŸåŠ© AI è¾…åŠ©ç”Ÿæˆï¼Œå¹¶ç”±ä½œè€…æ•´ç†å®¡æ ¸ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LiteLLM å¿«é€Ÿå…¥é—¨]]></title>    <link>https://juejin.cn/post/7573528564026589230</link>    <guid>https://juejin.cn/post/7573528564026589230</guid>    <pubDate>2025-11-18T00:12:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573528564026589230" data-draft-id="7573525927793901594" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LiteLLM å¿«é€Ÿå…¥é—¨"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-18T00:12:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—¥ä¹ ä¸€æŠ€"/> <meta itemprop="url" content="https://juejin.cn/user/3913917125896190"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LiteLLM å¿«é€Ÿå…¥é—¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3913917125896190/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—¥ä¹ ä¸€æŠ€
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.1 åˆå­¦ä¹ç»ƒ
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.1 åˆå­¦ä¹ç»ƒ" title="VIP.1 åˆå­¦ä¹ç»ƒ" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:12:25.000Z" title="Tue Nov 18 2025 00:12:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ AI åº”ç”¨çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¼€å‘è€…ä»¬å¾€å¾€é¢ä¸´ä¸€ä¸ªå…±åŒçš„éš¾é¢˜ï¼šå¦‚ä½•é«˜æ•ˆåœ°é›†æˆå¤šå®¶ LLM æœåŠ¡å•†çš„æ¥å£ï¼Ÿä¸åŒçš„æœåŠ¡å•†æä¾›çš„ API è®¾è®¡å„ä¸ç›¸åŒï¼ŒOpenAI æœ‰è‡ªå·±çš„é£æ ¼ï¼ŒAnthropic æœ‰å¦ä¸€å¥—æ ‡å‡†ï¼ŒAzure OpenAIã€Google Vertex AI åˆæœ‰å„è‡ªçš„ç‰¹è‰²ã€‚æ¯æ¬¡éœ€è¦åˆ‡æ¢æœåŠ¡å•†æˆ–æ”¯æŒå¤šå®¶æ¨¡å‹æ—¶ï¼Œå¼€å‘è€…éƒ½è¦è´¹åŠ›å»å­¦ä¹ å’Œé€‚é…æ–°çš„ API è§„èŒƒï¼Œè¿™æ— ç–‘å¢åŠ äº†å¼€å‘æˆæœ¬å’Œç»´æŠ¤éš¾åº¦ã€‚</p>
<p>LiteLLM æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œè¯ç”Ÿçš„ã€‚å®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„ Python åº“ï¼Œæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æ¥è°ƒç”¨ 100+ ä¸ª LLM æœåŠ¡å•†çš„æ¨¡å‹ï¼Œæ— è®ºæ˜¯ OpenAIã€Anthropicã€Googleã€Cohereï¼Œè¿˜æ˜¯å›½å†…çš„ DeepSeekã€Qwen ç­‰ï¼Œéƒ½å¯ä»¥é€šè¿‡ç›¸åŒçš„ API æ¥è°ƒç”¨ã€‚æ›´å¼ºå¤§çš„æ˜¯ï¼ŒLiteLLM ä¸ä»…å¯ä»¥ä½œä¸ºå®¢æˆ·ç«¯ SDK é›†æˆåˆ°ä½ çš„åº”ç”¨ä¸­ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„ Proxy Serverï¼Œå¯ä»¥ç”¨ä½œ LLM Gateway æ¥ç»Ÿä¸€ç®¡ç†å’Œè·¯ç”±æ‰€æœ‰çš„ LLM è¯·æ±‚ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30f7f3e11fa143e88ac91fe4908ce77b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029545&amp;x-signature=Pr3pIIXd9NhQdco%2FvY%2BN97W3kK0%3D" alt="icon.png" loading="lazy"/></p>
<p>è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘ä»¬ LiteLLM å­¦ä¹ ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ï¼Œä»Šå¤©å°±è®©æˆ‘ä»¬ä¸€èµ·å¿«é€Ÿä¸Šæ‰‹ LiteLLMï¼Œäº†è§£å®ƒçš„æ ¸å¿ƒç‰¹æ€§å’ŒåŸºæœ¬ç”¨æ³•ã€‚</p>
<h2 data-id="heading-0">LiteLLM æ¦‚è§ˆ</h2>
<p>LiteLLM çš„æ ¸å¿ƒä»·å€¼ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<p><strong>ç»Ÿä¸€çš„ API æ¥å£</strong>ï¼šLiteLLM å°†æ‰€æœ‰ LLM æœåŠ¡å•†çš„ API éƒ½è½¬æ¢ä¸º OpenAI çš„ API æ ¼å¼ï¼Œè¿™æ„å‘³ç€ä½ åªéœ€è¦å­¦ä¹ ä¸€å¥— APIï¼Œå°±å¯ä»¥è°ƒç”¨ä»»ä½•æ”¯æŒçš„æ¨¡å‹ã€‚æ— è®ºæœåŠ¡å•†æ›´æ¢ã€æ¨¡å‹è¿­ä»£ï¼Œä½ çš„ä»£ç åŸºæœ¬ä¸éœ€è¦æ”¹åŠ¨ã€‚
<strong>å®Œå–„çš„é‡è¯•å’Œå®¹é”™æœºåˆ¶</strong>ï¼šé€šè¿‡ Router å’Œ Fallback åŠŸèƒ½ï¼ŒLiteLLM æ”¯æŒåœ¨å¤šä¸ªæ¨¡å‹éƒ¨ç½²ä¹‹é—´è¿›è¡Œè´Ÿè½½å‡è¡¡å’Œè‡ªåŠ¨å®¹é”™ï¼Œå½“æŸä¸ªæœåŠ¡å•†å‡ºç°æ•…éšœæ—¶ï¼Œå¯ä»¥è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æ–¹æ¡ˆï¼Œç¡®ä¿æœåŠ¡çš„å¯ç”¨æ€§ã€‚
<strong>æˆæœ¬è¿½è¸ªå’Œé¢„ç®—ç®¡ç†</strong>ï¼šLiteLLM å¯ä»¥è‡ªåŠ¨è®¡ç®—æ¯æ¬¡ API è°ƒç”¨çš„æˆæœ¬ï¼Œå¹¶æ”¯æŒè®¾å®šæ¯ä¸ªç”¨æˆ·æˆ–å›¢é˜Ÿçš„é¢„ç®—é™é¢ï¼Œå¸®åŠ©ä¼ä¸šæ›´å¥½åœ°æ§åˆ¶æˆæœ¬ã€‚
<strong>Proxy Server ç½‘å…³</strong>ï¼šLiteLLM æä¾›çš„ä»£ç†æœåŠ¡å™¨å¯ä»¥ä½œä¸ºä¸€ä¸ªä¸­å¿ƒåŒ–çš„ LLM ç½‘å…³ï¼Œç»Ÿä¸€å¤„ç†è®¤è¯ã€é€Ÿç‡é™åˆ¶ã€æˆæœ¬è¿½è¸ªç­‰é—®é¢˜ï¼Œç‰¹åˆ«é€‚åˆå¤§å‹ç»„ç»‡å†…éƒ¨éƒ¨ç½²ã€‚</p>
<p>ç›®å‰æœ‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fproject" target="_blank" title="https://docs.litellm.ai/docs/project" ref="nofollow noopener noreferrer">ä¸å°‘å¼€æºé¡¹ç›®</a>ä½¿ç”¨äº† LiteLLMï¼Œæ¯”å¦‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhuggingface%2Fsmolagents" target="_blank" title="https://github.com/huggingface/smolagents" ref="nofollow noopener noreferrer">smolagents</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopeninterpreter%2Fopen-interpreter" target="_blank" title="https://github.com/openinterpreter/open-interpreter" ref="nofollow noopener noreferrer">Open Interpreter</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FQuivrHQ%2Fquivr" target="_blank" title="https://github.com/QuivrHQ/quivr" ref="nofollow noopener noreferrer">Quivr</a> ç­‰ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fdff3b5cc4a42bea25d60b051da705d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029545&amp;x-signature=97o50TVnY%2F4PPTQ4QR9YY%2FCb7Qs%3D" alt="projects.png" loading="lazy"/></p>
<p>æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„ Surfsenseã€Mem0ã€Claude Codeã€Chat2Graph ç­‰é¡¹ç›®ï¼Œéƒ½æˆ–å¤šæˆ–å°‘åœ°æœ‰ç€ LiteLLM çš„å½±å­ã€‚</p>
<h2 data-id="heading-1">ä½œä¸ºå®¢æˆ·ç«¯ SDK ä½¿ç”¨</h2>
<p>LiteLLM æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼å°±æ˜¯ä½œä¸º Python å®¢æˆ·ç«¯åº“ï¼Œç›´æ¥åœ¨ä½ çš„åº”ç”¨ä¸­è°ƒç”¨ã€‚é¦–å…ˆå®‰è£…ä¾èµ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ pip install litellm
</code></pre>
<h3 data-id="heading-2">åŸºç¡€è°ƒç”¨</h3>
<p>ä¸‹é¢æ˜¯æœ€åŸºç¡€çš„ä½¿ç”¨ç¤ºä¾‹ï¼Œè°ƒç”¨ OpenAI çš„ gpt-4o æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> litellm <span class="hljs-keyword">import</span> completion
<span class="hljs-keyword">import</span> os

<span class="hljs-comment"># è®¾ç½® API Keyï¼ˆä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®ï¼‰</span>
os.environ[<span class="hljs-string">"OPENAI_API_KEY"</span>] = <span class="hljs-string">"sk-xxx"</span>

<span class="hljs-comment"># å‘é€è¯·æ±‚</span>
response = completion(
  model=<span class="hljs-string">"openai/gpt-4o"</span>,
  messages=[
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½ï¼Œè¯·è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹"</span>}
  ]
)

<span class="hljs-comment"># æ‰“å°å“åº”</span>
<span class="hljs-built_in">print</span>(response.choices[<span class="hljs-number">0</span>].message.content)
</code></pre>
<p>è¿™é‡Œçš„ <code>model</code> å‚æ•°éµå¾ª <code>provider/model_name</code> çš„æ ¼å¼ï¼ŒLiteLLM é€šè¿‡è¿™ä¸ªæ ¼å¼æ¥è¯†åˆ«åº”è¯¥ç”¨å“ªä¸ªæœåŠ¡å•†çš„ APIã€‚å“åº”æ ¼å¼å®Œå…¨å…¼å®¹ OpenAI çš„ APIï¼Œæ‰€ä»¥å¦‚æœä½ ä¹‹å‰ç”¨è¿‡ OpenAI SDKï¼Œä¼šå‘ç°éå¸¸ç†Ÿæ‚‰ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"chatcmpl-CWZUWaec9CC3vYyH5WlJN5LJ6tGxj"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"created"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1761878960</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gpt-4o-2024-08-06"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"object"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"chat.completion"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"system_fingerprint"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"choices"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"finish_reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"stop"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ å¥½ï¼æˆ‘æ˜¯ä¸€ä¸ªç”±äººå·¥æ™ºèƒ½é©±åŠ¨çš„åŠ©æ‰‹ ..."</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"role"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"assistant"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"tool_calls"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"function_call"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"usage"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"completion_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">68</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"prompt_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">13</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"total_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">81</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"completion_tokens_details"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"prompt_tokens_details"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"audio_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"cached_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"cache_creation_input_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"cache_read_input_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-3">ä¸°å¯Œçš„æ¨¡å‹æ”¯æŒ</h3>
<p>LiteLLM æ”¯æŒ 100+ ä¸ªæ¨¡å‹ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>å•†ä¸šæ¨¡å‹</strong>ï¼šOpenAIã€Anthropicã€Google Geminiã€Cohereã€Mistral ç­‰</li>
<li><strong>å›½å†…æ¨¡å‹</strong>ï¼šDeepSeekã€é€šä¹‰åƒé—®ã€æ™ºè°± GLMã€ç™¾å·ã€åƒå¸† ç­‰</li>
<li><strong>æœ¬åœ°æ¨¡å‹</strong>ï¼šOllamaã€Hugging Faceã€vLLM ç­‰</li>
<li><strong>ä¼ä¸šæœåŠ¡</strong>ï¼šAzure OpenAIã€AWS Bedrockã€Google Vertex AI ç­‰</li>
</ul>
<p>è¿™é‡Œæ˜¯å®Œæ•´çš„æ¨¡å‹ä¾›åº”å•†åˆ—è¡¨ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fproviders" target="_blank" title="https://docs.litellm.ai/docs/providers" ref="nofollow noopener noreferrer">docs.litellm.ai/docs/providâ€¦</a></li>
</ul>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åˆ‡æ¢åˆ° Claudeï¼Œä»£ç åªéœ€è¦æ”¹ä¸€è¡Œï¼š</p>
<pre><code class="hljs language-python" lang="python">os.environ[<span class="hljs-string">"ANTHROPIC_API_KEY"</span>] = <span class="hljs-string">"sk-xxx"</span>

response = completion(
  model=<span class="hljs-string">"anthropic/claude-sonnet-4-20250514"</span>,
  messages=[
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½ï¼Œè¯·è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹"</span>}
  ]
)
</code></pre>
<p>æˆ–è€…ä½¿ç”¨å›½å†…çš„ DeepSeekï¼š</p>
<pre><code class="hljs language-python" lang="python">os.environ[<span class="hljs-string">"DEEPSEEK_API_KEY"</span>] = <span class="hljs-string">"sk-xxx"</span>

response = completion(
  model=<span class="hljs-string">"deepseek/deepseek-chat"</span>,
  messages=[
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½ï¼Œè¯·è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹"</span>}
  ]
)
</code></pre>
<h3 data-id="heading-4">æµå¼å“åº”</h3>
<p>å¯¹äºéœ€è¦å®æ—¶æµå¼è¾“å‡ºçš„åº”ç”¨ï¼ˆæ¯”å¦‚å¯¹è¯åº”ç”¨ï¼‰ï¼ŒLiteLLM é€šè¿‡ä¼ å…¥ <code>stream=True</code> å‚æ•°æ¥æ”¯æŒæµå¼å“åº”ï¼š</p>
<pre><code class="hljs language-python" lang="python">response = completion(
  model=<span class="hljs-string">"openai/gpt-4o"</span>,
  messages=[
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"å†™ä¸€é¦–å…³äºæ˜¥å¤©çš„è¯—"</span>}
  ],
  stream=<span class="hljs-literal">True</span>
)

<span class="hljs-comment"># é€å—è¾“å‡ºå“åº”</span>
<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> response:
  content = chunk.choices[<span class="hljs-number">0</span>].delta.content
  <span class="hljs-keyword">if</span> content:
    <span class="hljs-built_in">print</span>(content, end=<span class="hljs-string">""</span>)
</code></pre>
<h3 data-id="heading-5">å¼‚æ­¥è°ƒç”¨</h3>
<p>LiteLLM ä¹Ÿæä¾›äº†å¼‚æ­¥ API <code>acompletion</code>ï¼Œæ–¹ä¾¿åœ¨å¼‚æ­¥æ¡†æ¶ä¸­ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> litellm <span class="hljs-keyword">import</span> acompletion

<span class="hljs-comment"># å¼‚æ­¥è¯·æ±‚</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>():
  response = <span class="hljs-keyword">await</span> acompletion(
    model=<span class="hljs-string">"openai/gpt-4o"</span>,
    messages=[
      {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½ï¼Œè¯·è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹"</span>}
    ]
  )
  <span class="hljs-keyword">return</span> response

<span class="hljs-comment"># è¿è¡Œå¼‚æ­¥å‡½æ•°</span>
response = asyncio.run(chat())
<span class="hljs-built_in">print</span>(response.choices[<span class="hljs-number">0</span>].message.content)
</code></pre>
<h3 data-id="heading-6">å¼‚å¸¸å¤„ç†</h3>
<p>LiteLLM ä¼šå°†æ‰€æœ‰æœåŠ¡å•†çš„å¼‚å¸¸éƒ½æ˜ å°„åˆ° OpenAI çš„å¼‚å¸¸ç±»å‹ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ç”¨ç»Ÿä¸€çš„æ–¹å¼å¤„ç†å„ç§é”™è¯¯ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> openai.error <span class="hljs-keyword">import</span> APIError, RateLimitError
<span class="hljs-keyword">from</span> litellm <span class="hljs-keyword">import</span> completion

<span class="hljs-keyword">try</span>:
  response = completion(
    model=<span class="hljs-string">"openai/gpt-4o"</span>,
    messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½"</span>}]
  )
<span class="hljs-keyword">except</span> RateLimitError:
  <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åé‡è¯•"</span>)
<span class="hljs-keyword">except</span> APIError <span class="hljs-keyword">as</span> e:
  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"API é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<p>å…³äºå¼‚å¸¸æ˜ å°„çš„è¯¦ç»†ä¿¡æ¯å¯å‚è€ƒä¸‹é¢çš„æ–‡æ¡£ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fexception_mapping" target="_blank" title="https://docs.litellm.ai/docs/exception_mapping" ref="nofollow noopener noreferrer">docs.litellm.ai/docs/exceptâ€¦</a></li>
</ul>
<h3 data-id="heading-7">ä¸°å¯Œçš„æ¥å£æ”¯æŒ</h3>
<p>é™¤äº† <code>completion</code> æ–‡æœ¬è¡¥å…¨æ¥å£ï¼ŒLiteLLM è¿˜<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fsupported_endpoints" target="_blank" title="https://docs.litellm.ai/docs/supported_endpoints" ref="nofollow noopener noreferrer">å…¼å®¹å¤§é‡ä¾›åº”å•†çš„æ¥å£</a>ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fassistants" target="_blank" title="https://docs.litellm.ai/docs/assistants" ref="nofollow noopener noreferrer">/assistants</a> - å…¼å®¹ OpenAI çš„ Assistants APIï¼ˆç›®å‰å·²åºŸå¼ƒï¼Œä½¿ç”¨ Responses API æ›¿ä»£ï¼‰</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Faudio_transcription" target="_blank" title="https://docs.litellm.ai/docs/audio_transcription" ref="nofollow noopener noreferrer">/audio/transcriptions</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Ftext_to_speech" target="_blank" title="https://docs.litellm.ai/docs/text_to_speech" ref="nofollow noopener noreferrer">/audio/speech</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fbatches" target="_blank" title="https://docs.litellm.ai/docs/batches" ref="nofollow noopener noreferrer">/batches</a> - å…¼å®¹ OpenAI çš„æ‰¹å¤„ç†æ¥å£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fcontainers" target="_blank" title="https://docs.litellm.ai/docs/containers" ref="nofollow noopener noreferrer">/containers</a> - å…¼å®¹ OpenAI çš„å®¹å™¨ç®¡ç†æ¥å£ï¼Œä¸ºä»£ç è§£é‡Šå™¨åˆ›å»ºéš”ç¦»çš„æ‰§è¡Œç¯å¢ƒ</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fcompletion" target="_blank" title="https://docs.litellm.ai/docs/completion" ref="nofollow noopener noreferrer">/chat/completion</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Ftext_completion" target="_blank" title="https://docs.litellm.ai/docs/text_completion" ref="nofollow noopener noreferrer">/completions</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fbedrock_converse" target="_blank" title="https://docs.litellm.ai/docs/bedrock_converse" ref="nofollow noopener noreferrer">/converse</a> - å…¼å®¹ Amazon Bedrock çš„ä¼šè¯æ¥å£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fembedding%2Fsupported_embedding" target="_blank" title="https://docs.litellm.ai/docs/embedding/supported_embedding" ref="nofollow noopener noreferrer">/embeddings</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Ffiles_endpoints" target="_blank" title="https://docs.litellm.ai/docs/files_endpoints" ref="nofollow noopener noreferrer">/files</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Ffine_tuning" target="_blank" title="https://docs.litellm.ai/docs/fine_tuning" ref="nofollow noopener noreferrer">/fine_tuning</a> - å…¼å®¹ OpenAI çš„æ¨¡å‹å¾®è°ƒæ¥å£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2FgenerateContent" target="_blank" title="https://docs.litellm.ai/docs/generateContent" ref="nofollow noopener noreferrer">/generateContent</a> - å…¼å®¹ Google AI çš„æ–‡æœ¬ç”Ÿæˆå’Œå¤šæ¨¡äº¤äº’æ¥å£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fapply_guardrail" target="_blank" title="https://docs.litellm.ai/docs/apply_guardrail" ref="nofollow noopener noreferrer">/guardrails/apply_guardrail</a> - è°ƒç”¨å†…å®¹å®¡æ ¸æ¥å£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fbedrock_invoke" target="_blank" title="https://docs.litellm.ai/docs/bedrock_invoke" ref="nofollow noopener noreferrer">/invoke</a> - å…¼å®¹ Amazon Bedrock çš„ä¼šè¯æ¥å£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fimage_edits" target="_blank" title="https://docs.litellm.ai/docs/image_edits" ref="nofollow noopener noreferrer">/images/edits</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fimage_generation" target="_blank" title="https://docs.litellm.ai/docs/image_generation" ref="nofollow noopener noreferrer">/images/generations</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fimage_variations" target="_blank" title="https://docs.litellm.ai/docs/image_variations" ref="nofollow noopener noreferrer">/image/variations</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fvideos" target="_blank" title="https://docs.litellm.ai/docs/videos" ref="nofollow noopener noreferrer">/videos</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fmcp" target="_blank" title="https://docs.litellm.ai/docs/mcp" ref="nofollow noopener noreferrer">/mcp</a> - æŸ¥çœ‹å’Œè°ƒç”¨ MCP å·¥å…·</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fanthropic_unified" target="_blank" title="https://docs.litellm.ai/docs/anthropic_unified" ref="nofollow noopener noreferrer">/v1/messages</a> - å…¼å®¹ Anthropic çš„å¤§æ¨¡å‹å¯¹è¯æ¥å£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fmoderation" target="_blank" title="https://docs.litellm.ai/docs/moderation" ref="nofollow noopener noreferrer">/moderations</a> - å…¼å®¹ OpenAI çš„å†…å®¹å®¡æ ¸æ¥å£</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Focr" target="_blank" title="https://docs.litellm.ai/docs/ocr" ref="nofollow noopener noreferrer">/ocr</a> - å…¼å®¹ Mistral çš„ OCR API</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Frealtime" target="_blank" title="https://docs.litellm.ai/docs/realtime" ref="nofollow noopener noreferrer">/realtime</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Frerank" target="_blank" title="https://docs.litellm.ai/docs/rerank" ref="nofollow noopener noreferrer">/rerank</a> - å…¼å®¹ Cohere çš„ Rerank API</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fresponse_api" target="_blank" title="https://docs.litellm.ai/docs/response_api" ref="nofollow noopener noreferrer">/responses</a> - å…¼å®¹ OpenAI çš„ Responses API</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fsearch%2F" target="_blank" title="https://docs.litellm.ai/docs/search/" ref="nofollow noopener noreferrer">/search</a> - å…¼å®¹ Perplexity çš„ Search API</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fvector_stores%2Fcreate" target="_blank" title="https://docs.litellm.ai/docs/vector_stores/create" ref="nofollow noopener noreferrer">/vector_stores</a> - åˆ›å»ºå‘é‡å­˜å‚¨</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fvector_stores%2Fsearch" target="_blank" title="https://docs.litellm.ai/docs/vector_stores/search" ref="nofollow noopener noreferrer">/vector_stores/search</a> - æ£€ç´¢å‘é‡å­˜å‚¨</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fpass_through%2Fintro" target="_blank" title="https://docs.litellm.ai/docs/pass_through/intro" ref="nofollow noopener noreferrer">å…¶ä»–é€ä¼ æ¥å£</a></li>
</ul>
<h2 data-id="heading-8">ä½œä¸º Proxy Server ä½¿ç”¨</h2>
<p>é™¤äº†ä½œä¸º SDK ä½¿ç”¨ï¼ŒLiteLLM è¿˜æä¾›äº†ä¸€ä¸ªä¼ä¸šçº§çš„ <strong>ä»£ç†æœåŠ¡å™¨ï¼ˆProxy Serverï¼‰</strong>ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ª <strong>å¤§æ¨¡å‹ç½‘å…³ï¼ˆLLM Gatewayï¼‰</strong> æ¥ä½¿ç”¨ã€‚è¿™å¯¹äºéœ€è¦ç»Ÿä¸€ç®¡ç†å¤šä¸ªæœåŠ¡å•†ã€å¯¹æ¥å¤šä¸ªåº”ç”¨çš„åœºæ™¯ç‰¹åˆ«æœ‰ä»·å€¼ã€‚</p>
<h3 data-id="heading-9">æ ¸å¿ƒåŠŸèƒ½</h3>
<p>LiteLLM Proxy ä¸»è¦æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<p><strong>å¤šæ¨¡å‹ç®¡ç†å’Œè´Ÿè½½å‡è¡¡</strong>ï¼šå¯ä»¥é…ç½®å¤šä¸ªæ¨¡å‹å’Œå¤šä¸ªéƒ¨ç½²ï¼ŒProxy ä¼šè‡ªåŠ¨è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œåˆ†æ•£è¯·æ±‚åˆ°ä¸åŒçš„æ¨¡å‹éƒ¨ç½²ï¼Œæé«˜æ•´ä½“ååé‡ã€‚
<strong>å¯†é’¥ç®¡ç†å’Œæˆæœ¬è¿½è¸ª</strong>ï¼šä¸ºæ¯ä¸ªå›¢é˜Ÿæˆ–ç”¨æˆ·ç”Ÿæˆè™šæ‹Ÿ API Keyï¼Œè¿½è¸ªæ¯ä¸ª Key çš„æˆæœ¬æ¶ˆè€—ï¼Œæ”¯æŒè®¾å®šä½¿ç”¨é¢„ç®—å’Œé€Ÿç‡é™åˆ¶ã€‚
<strong>ç»Ÿä¸€çš„è®¤è¯å’Œæˆæƒ</strong>ï¼šProxy å¯ä»¥ä½œä¸ºä¸­å¿ƒåŒ–çš„è®¤è¯å±‚ï¼Œæ‰€æœ‰åº”ç”¨é€šè¿‡å®ƒæ¥è®¿é—® LLM æœåŠ¡ï¼Œé¿å…å°†å„ç§ API Key æ•£å¸ƒåœ¨å„ä¸ªåº”ç”¨ä¸­ã€‚
<strong>å¯è§‚æµ‹æ€§å’Œæ—¥å¿—</strong>ï¼šæ”¯æŒä¸ Langfuseã€Heliconeã€LunaryAI ç­‰å¯è§‚æµ‹å¹³å°é›†æˆï¼Œè®°å½•æ‰€æœ‰ API è°ƒç”¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾¿äºç›‘æ§å’Œè°ƒè¯•ã€‚</p>
<h3 data-id="heading-10">å¿«é€Ÿå¯åŠ¨</h3>
<p>å®‰è£… Proxy æœåŠ¡å™¨éœ€è¦é¢å¤–çš„ä¾èµ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ pip install <span class="hljs-string">'litellm[proxy]'</span>
</code></pre>
<p>æœ€ç®€å•çš„å¯åŠ¨æ–¹å¼ï¼Œåªéœ€ä¸€æ¡å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ litellm --model openai/gpt-4o

<span class="hljs-comment"># INFO: Uvicorn running on http://0.0.0.0:4000</span>
</code></pre>
<p>è¿™æ ·å°±å¯åŠ¨äº†ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œé»˜è®¤ç›‘å¬åœ¨ <code>4000</code> ç«¯å£ä¸Šï¼Œç›´æ¥æµè§ˆå™¨æ‰“å¼€å¯ä»¥çœ‹åˆ°å®ƒçš„ Swagger æ–‡æ¡£é¡µé¢ï¼Œè¿™é‡Œåˆ—å‡ºäº† LiteLLM Proxy çš„æ‰€æœ‰æ¥å£ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec37e10240904ed9a806dab89518f312~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029545&amp;x-signature=lOSx8dh1ZmrEy4w4NFNtZA%2BE7DU%3D" alt="swagger.png" loading="lazy"/></p>
<blockquote>
<p>å¯ä»¥é€šè¿‡ <code>--port</code> å‚æ•°ä¿®æ”¹ç›‘å¬çš„ç«¯å£ã€‚</p>
</blockquote>
<h3 data-id="heading-11">ä½¿ç”¨ Config.yaml é…ç½®</h3>
<p>å¦‚æœä½ æƒ³ç”¨å…¶ä»–æ¨¡å‹æˆ–é…ç½®å¤šä¸ªæ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶ã€‚åˆ›å»ºä¸€ä¸ª <code>config.yaml</code> æ–‡ä»¶æ¥é…ç½®å¤šä¸ªæ¨¡å‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">model_list:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">model_name:</span> <span class="hljs-string">gpt-4o</span>
    <span class="hljs-attr">litellm_params:</span>
      <span class="hljs-attr">model:</span> <span class="hljs-string">openai/gpt-4o</span>
      <span class="hljs-attr">api_key:</span> <span class="hljs-string">os.environ/OPENAI_API_KEY</span>

  <span class="hljs-bullet">-</span> <span class="hljs-attr">model_name:</span> <span class="hljs-string">claude</span>
    <span class="hljs-attr">litellm_params:</span>
      <span class="hljs-attr">model:</span> <span class="hljs-string">anthropic/claude-sonnet-4-20250514</span>
      <span class="hljs-attr">api_key:</span> <span class="hljs-string">os.environ/ANTHROPIC_API_KEY</span>

  <span class="hljs-bullet">-</span> <span class="hljs-attr">model_name:</span> <span class="hljs-string">deepseek</span>
    <span class="hljs-attr">litellm_params:</span>
      <span class="hljs-attr">model:</span> <span class="hljs-string">deepseek/deepseek-chat</span>
      <span class="hljs-attr">api_key:</span> <span class="hljs-string">os.environ/DEEPSEEK_API_KEY</span>

<span class="hljs-attr">general_settings:</span>
  <span class="hljs-attr">master_key:</span> <span class="hljs-string">sk-1234</span>  <span class="hljs-comment"># ç®¡ç†å‘˜å¯†é’¥</span>
</code></pre>
<blockquote>
<p>å®Œæ•´çš„é…ç½®æ–‡ä»¶å‚æ•°å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fproxy%2Fconfigs" target="_blank" title="https://docs.litellm.ai/docs/proxy/configs" ref="nofollow noopener noreferrer">docs.litellm.ai/docs/proxy/â€¦</a></p>
</blockquote>
<p>ç„¶åç”¨é…ç½®æ–‡ä»¶å¯åŠ¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ litellm --config config.yaml

<span class="hljs-comment"># INFO: Uvicorn running on http://0.0.0.0:4000</span>
</code></pre>
<h3 data-id="heading-12">è°ƒç”¨ Proxy</h3>
<p>å¯åŠ¨åï¼Œä½ å¯ä»¥é€šè¿‡ OpenAI SDK æˆ–ä»»ä½•å…¼å®¹ OpenAI API çš„å·¥å…·æ¥è°ƒç”¨ Proxyã€‚Proxy çš„ API ä¸ OpenAI å®Œå…¨å…¼å®¹ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥æ— ç¼åœ°å°†ç°æœ‰çš„ OpenAI é›†æˆæ”¹ä¸ºä½¿ç”¨ LiteLLM Proxyã€‚</p>
<p>ä½¿ç”¨ OpenAI Python SDKï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> openai

client = openai.OpenAI(
  api_key=<span class="hljs-string">"sk-1234"</span>,
  base_url=<span class="hljs-string">"http://127.0.0.1:4000"</span>
)

response = client.chat.completions.create(
  model=<span class="hljs-string">"gpt-4o"</span>,  <span class="hljs-comment"># ä½¿ç”¨é…ç½®ä¸­çš„æ¨¡å‹å</span>
  messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½"</span>}]
)

<span class="hljs-built_in">print</span>(response.choices[<span class="hljs-number">0</span>].message.content)
</code></pre>
<p>ä½¿ç”¨ cURLï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X POST <span class="hljs-string">'http://127.0.0.1:4000/chat/completions'</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -d <span class="hljs-string">'{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "ä½ å¥½"}]
  }'</span>
</code></pre>
<h3 data-id="heading-13">Docker éƒ¨ç½²</h3>
<p>å¯¹äºç”Ÿäº§ç¯å¢ƒï¼ŒLiteLLM æä¾›äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fproxy%2Fdeploy" target="_blank" title="https://docs.litellm.ai/docs/proxy/deploy" ref="nofollow noopener noreferrer">å®Œæ•´çš„ Docker æ”¯æŒ</a>ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨ Docker Composeï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½ Docker Compose é…ç½®</span>
$ curl -O https://raw.githubusercontent.com/BerriAI/litellm/main/docker-compose.yml

<span class="hljs-comment"># åˆ›å»º .env æ–‡ä»¶è®¾ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡</span>
$ <span class="hljs-built_in">cat</span> &gt; .<span class="hljs-built_in">env</span> &lt;&lt;<span class="hljs-string">EOF
LITELLM_MASTER_KEY="sk-1234"
OPENAI_API_KEY="your-api-key"
EOF</span>

<span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
$ docker compose up -d
</code></pre>
<p>æˆ–è€…ç›´æ¥ä½¿ç”¨ Docker è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run \
  -v $(<span class="hljs-built_in">pwd</span>)/config.yaml:/app/config.yaml \
  -e OPENAI_API_KEY=<span class="hljs-string">"your-api-key"</span> \
  -p 4000:4000 \
  ghcr.io/berriai/litellm:main-stable \
  --config /app/config.yaml
</code></pre>
<h3 data-id="heading-14">Web UI å’Œç®¡ç†ç•Œé¢</h3>
<p>æ­¤å¤–ï¼ŒLiteLLM Proxy è¿˜æä¾›äº†ä¸€ä¸ªç®¡ç†åå°ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ·»åŠ æ–°çš„æ¨¡å‹é…ç½®ã€æŸ¥çœ‹è°ƒç”¨æ—¥å¿—ã€ç›‘æ§æˆæœ¬å’Œä½¿ç”¨æƒ…å†µç­‰ã€‚å¯åŠ¨ Proxy ä¹‹åï¼Œé¦–æ¬¡è®¿é—® <code>http://127.0.0.1:4000/ui</code> è¿›å…¥ç™»å½•é¡µé¢ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73545e440cea459d84638bb8fc6fb5ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029545&amp;x-signature=q%2BAY%2FqGeLvTGcI%2F7SqclqJ%2Bx6Js%3D" alt="login.png" loading="lazy"/></p>
<p>é»˜è®¤ç”¨æˆ·åä¸º <code>admin</code>ï¼Œå¯†ç ä¸º <code>config.yaml</code> æ–‡ä»¶ä¸­é…ç½®çš„ <code>master_key</code>ï¼Œé»˜è®¤å°±æ˜¯ <code>sk-1234</code>ï¼Œç™»å½•æˆåŠŸåå³å¯è¿›å…¥ç®¡ç†ç•Œé¢ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6baee399e1d42a6935a0426fed7c98b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764029545&amp;x-signature=3bikqxtdfWskWl5%2BmMi9PcCkDoc%3D" alt="admin-ui.png" loading="lazy"/></p>
<p>å¯ä»¥åœ¨ <code>.env</code> æ–‡ä»¶ä¸­é€šè¿‡ <code>UI_USERNAME</code> å’Œ <code>UI_PASSWORD</code> ä¿®æ”¹ç®¡ç†å‘˜çš„ç”¨æˆ·åå’Œå¯†ç ï¼š</p>
<pre><code class="hljs language-sh" lang="sh">UI_USERNAME=aneasystone
UI_PASSWORD=12345678
</code></pre>
<p>å¦å¤–ï¼Œå¯¹äºä¸å¸Œæœ›æœ‰ç®¡ç†åå°çš„ç”¨æˆ·ï¼Œå¯ä»¥é€šè¿‡ <code>DISABLE_ADMIN_UI</code> å‚æ•°å…³é—­ Web UI åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-sh" lang="sh">DISABLE_ADMIN_UI=True
</code></pre>
<h2 data-id="heading-15">å°ç»“</h2>
<p>è¿™ç¯‡æ–‡ç« ä½œä¸º LiteLLM å­¦ä¹ ç³»åˆ—çš„å¼€ç¯‡ï¼Œæˆ‘ä»¬å¿«é€Ÿäº†è§£äº† LiteLLM çš„æ ¸å¿ƒç‰¹æ€§å’Œä¸¤ç§ä¸»è¦çš„ä½¿ç”¨æ–¹å¼ï¼š</p>
<ol>
<li><strong>ä½œä¸º Python SDK</strong>ï¼šç®€å•æ˜“ç”¨ï¼Œé€‚åˆå¿«é€Ÿé›†æˆå’Œä¸ªäººé¡¹ç›®ï¼Œåªéœ€å‡ è¡Œä»£ç å°±èƒ½è°ƒç”¨ä»»ä½•æ¨¡å‹ï¼›</li>
<li><strong>ä½œä¸º Proxy Server</strong>ï¼šåŠŸèƒ½å®Œæ•´ï¼Œé€‚åˆä¼ä¸šçº§éƒ¨ç½²ï¼Œå¯ä»¥ç»Ÿä¸€ç®¡ç†å¤šä¸ªæ¨¡å‹ï¼Œå®ç°æˆæœ¬è¿½è¸ªã€é€Ÿç‡é™åˆ¶ã€è™šæ‹Ÿ Key ç®¡ç†ç­‰åŠŸèƒ½ï¼›</li>
</ol>
<p>LiteLLM é€šè¿‡ç»Ÿä¸€çš„ API æ¥å£è§£å†³äº†å¤šæ¨¡å‹é›†æˆçš„å¤æ‚æ€§é—®é¢˜ï¼Œè€Œ Proxy Server åˆ™è¿›ä¸€æ­¥æä¾›äº†ä¸€ä¸ªä¼ä¸šçº§çš„ LLM ç½‘å…³è§£å†³æ–¹æ¡ˆã€‚åœ¨åç»­çš„ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ LiteLLM çš„é«˜çº§åŠŸèƒ½ï¼ŒåŒ…æ‹¬è·¯ç”±å’Œè´Ÿè½½å‡è¡¡ã€æˆæœ¬è¿½è¸ªå’Œé¢„ç®—ç®¡ç†çš„ç»†èŠ‚ã€ä¸å¯è§‚æµ‹æ€§å¹³å°çš„é›†æˆç­‰ã€‚</p>
<p>æ•¬è¯·æœŸå¾…ï¼</p>
<h2 data-id="heading-16">æ¬¢è¿å…³æ³¨</h2>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„åŒåå…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fi-study-everyday.online%2Fabout-me.html" target="_blank" title="https://i-study-everyday.online/about-me.html" ref="nofollow noopener noreferrer">æ—¥ä¹ ä¸€æŠ€ï¼Œæ¯å¤©å­¦ä¸€ç‚¹æ–°æŠ€æœ¯</a>ã€‚</p>
<p>æˆ‘ä¼šæ¯å¤©èŠ±ä¸€ä¸ªå°æ—¶ï¼Œè®°å½•ä¸‹æˆ‘å­¦ä¹ çš„ç‚¹ç‚¹æ»´æ»´ã€‚å†…å®¹åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>æŸä¸ªäº§å“çš„ä½¿ç”¨å°çªé—¨</li>
<li>å¼€æºé¡¹ç›®çš„å®è·µå’Œå¿ƒå¾—</li>
<li>æŠ€æœ¯ç‚¹çš„ç®€å•è§£è¯»</li>
</ul>
<p>ç›®æ ‡æ˜¯è®©å¤§å®¶ç”¨5åˆ†é’Ÿè¯»å®Œå°±èƒ½æœ‰æ‰€æ”¶è·ï¼Œä¸éœ€è¦å¤ªè´¹åŠ²ï¼Œä½†å´å¯ä»¥è½»æ¾è·å–ä¸€äº›å¹²è´§ã€‚ä¸ç®¡ä½ æ˜¯æŠ€æœ¯æ–°æ‰‹è¿˜æ˜¯è€é¸Ÿï¼Œæ¬¢è¿ç»™æˆ‘æå»ºè®®ï¼Œå¦‚æœæœ‰æƒ³å­¦ä¹ çš„æŠ€æœ¯ï¼Œä¹Ÿæ¬¢è¿äº¤æµï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[EMQXï¼šå¼€æºMQTTæ¶ˆæ¯ä¸­é—´ä»¶ç‹è€…ï¼Œç™¾ä¸‡çº§ç‰©è”ç½‘è¿æ¥çš„é¦–é€‰å¼•æ“]]></title>    <link>https://juejin.cn/post/7573523709300621347</link>    <guid>https://juejin.cn/post/7573523709300621347</guid>    <pubDate>2025-11-18T00:52:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573523709300621347" data-draft-id="7537484912815947828" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="EMQXï¼šå¼€æºMQTTæ¶ˆæ¯ä¸­é—´ä»¶ç‹è€…ï¼Œç™¾ä¸‡çº§ç‰©è”ç½‘è¿æ¥çš„é¦–é€‰å¼•æ“"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-18T00:52:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="YL_jia"/> <meta itemprop="url" content="https://juejin.cn/user/1467226241383211"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            EMQXï¼šå¼€æºMQTTæ¶ˆæ¯ä¸­é—´ä»¶ç‹è€…ï¼Œç™¾ä¸‡çº§ç‰©è”ç½‘è¿æ¥çš„é¦–é€‰å¼•æ“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1467226241383211/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    YL_jia
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:52:27.000Z" title="Tue Nov 18 2025 00:52:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">EMQXï¼šå¼€æºMQTTæ¶ˆæ¯ä¸­é—´ä»¶ç‹è€…ï¼Œç™¾ä¸‡çº§ç‰©è”ç½‘è¿æ¥çš„é¦–é€‰å¼•æ“</h2>
<blockquote>
<p>ä»è½¦è”ç½‘åˆ°å·¥ä¸š4.0ï¼Œè§£å¯†å…¨çƒéƒ¨ç½²è¶…2ä¸‡èŠ‚ç‚¹çš„æ¶ˆæ¯åŸºç¡€è®¾æ–½</p>
</blockquote>
<h3 data-id="heading-1">å¼•è¨€ï¼šå½“ä¸‡ç‰©äº’è”é‡è§æ¶ˆæ¯æ´ªæµ</h3>
<p>2025å¹´ï¼ŒæŸæ–°èƒ½æºè½¦ä¼<strong>50ä¸‡è¾†æ™ºèƒ½æ±½è½¦</strong>åŒæ—¶åœ¨çº¿å‡çº§ï¼Œæ¯ç§’å¤„ç†<strong>120ä¸‡æ¡</strong>è½¦è¾†çŠ¶æ€æ¶ˆæ¯ï¼›æŸæ™ºæ…§åŸå¸‚é¡¹ç›®éœ€ç®¡ç†<strong>200ä¸‡+ç‰©è”ç½‘è®¾å¤‡</strong>ï¼Œæ—¥å‡æ¶ˆæ¯é‡<strong>90äº¿æ¡</strong>â€”â€”è¿™äº›æ•°å­—èƒŒåï¼Œæ˜¯<strong>ä¼ ç»Ÿæ¶ˆæ¯ä¸­é—´ä»¶éš¾ä»¥é€¾è¶Šçš„æ€§èƒ½é¸¿æ²Ÿ</strong>ã€‚è€Œ<strong>EMQX</strong>ä½œä¸ºå…¨çƒé¢†å…ˆçš„å¼€æºMQTTæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œä»¥<strong>å•èŠ‚ç‚¹500ä¸‡è¿æ¥+æ¯«ç§’çº§å»¶è¿Ÿ+ä¼ä¸šçº§é«˜å¯ç”¨</strong>çš„å“è¶Šè¡¨ç°ï¼Œæˆä¸ºç‰©è”ç½‘åŸºç¡€è®¾æ–½çš„æ ¸å¿ƒæ”¯æŸ±ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æå…¶æŠ€æœ¯æ¶æ„ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ æ„å»ºäº¿çº§ååçš„æ¶ˆæ¯å¤„ç†å¹³å°ã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¸€ã€EMQXæ ¸å¿ƒä¼˜åŠ¿ï¼šé‡æ–°å®šä¹‰MQTTæ€§èƒ½è¾¹ç•Œ</h3>
<h4 data-id="heading-3">1. <strong>æ€§èƒ½æ ‡æ†ï¼šæ‰“ç ´ç‰©ç†é™åˆ¶çš„æ¶ˆæ¯å¼•æ“</strong></h4>



































<table><thead><tr><th><strong>æŒ‡æ ‡</strong></th><th>ä¼ ç»ŸMQTT Broker</th><th>EMQX 5.0</th><th>æå‡å¹…åº¦</th></tr></thead><tbody><tr><td>å•èŠ‚ç‚¹è¿æ¥æ•°</td><td>10ä¸‡çº§</td><td><strong>500ä¸‡+</strong></td><td>50å€</td></tr><tr><td>æ¶ˆæ¯ååé‡</td><td>50ä¸‡TPS</td><td><strong>1000ä¸‡TPS</strong></td><td>20å€</td></tr><tr><td>ç«¯åˆ°ç«¯å»¶è¿Ÿ</td><td>20ms</td><td><strong>&lt;1ms</strong></td><td>95%â†“</td></tr><tr><td>é›†ç¾¤èŠ‚ç‚¹æ•°</td><td>10èŠ‚ç‚¹</td><td><strong>100+èŠ‚ç‚¹</strong></td><td>10å€</td></tr></tbody></table>
<p><em>æ•°æ®æ¥æºï¼šEMQX 5.0åŸºå‡†æµ‹è¯•ï¼ˆ32æ ¸/128GBç¯å¢ƒï¼‰</em></p>
<h4 data-id="heading-4">2. <strong>åˆ†å±‚æ¶æ„è§£æ</strong></h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[MQTTå®¢æˆ·ç«¯] --&gt; B(æ¥å…¥å±‚)
    B --&gt; C{è·¯ç”±å±‚}
    C --&gt; D[èŠ‚ç‚¹1]
    C --&gt; E[èŠ‚ç‚¹2]
    D --&gt; F[æ•°æ®æŒä¹…åŒ–]
    E --&gt; F
    F --&gt; G[(åç«¯æœåŠ¡)]
</code></pre>
<ul>
<li><strong>æ¥å…¥å±‚</strong>ï¼šåŸºäºErlang OTPçš„è½¯å®æ—¶ç³»ç»Ÿï¼Œå•è¿æ¥å†…å­˜ä½è‡³5KB</li>
<li><strong>è·¯ç”±å±‚</strong>ï¼šç‹¬åˆ›çš„<code>ä¸»é¢˜æ ‘+è·¯ç”±è¡¨</code>åŒç´¢å¼•ï¼Œå¯»å€æ•ˆç‡æå‡300%</li>
<li><strong>æŒä¹…åŒ–å±‚</strong>ï¼šæ”¯æŒKafka/Pulsar/RocketMQç­‰14ç§æ•°æ®æ¡¥æ¥</li>
</ul>
<h4 data-id="heading-5">3. <strong>ä¼ä¸šçº§å…³é”®ç‰¹æ€§</strong></h4>
<ul>
<li><strong>é›¶å®•æœºå‡çº§</strong>ï¼šçƒ­ä»£ç åŠ è½½å®ç°ä¸šåŠ¡æ— æ„Ÿæ›´æ–°</li>
<li><strong>å…¨æ–¹ä½å®‰å…¨</strong>ï¼š
<ul>
<li>TLS 1.3åŠ å¯†ä¼ è¾“</li>
<li>JWT/PSKè®¤è¯</li>
<li>åŸºäºSQLçš„ç²¾ç»†æƒé™æ§åˆ¶</li>
</ul>
</li>
<li><strong>ç™¾ä¸‡çº§è®¾å¤‡ç®¡ç†</strong>ï¼š
<ul>
<li>åœ¨çº¿çŠ¶æ€è¿½è¸ª</li>
<li>æ‰¹é‡æŒ‡ä»¤ä¸‹å‘</li>
<li>è¿æ¥ç”»åƒåˆ†æ</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-6">äºŒã€åäº”åˆ†é’Ÿæé€Ÿéƒ¨ç½²ï¼šå…¨åœºæ™¯å®‰è£…æŒ‡å—</h3>
<h4 data-id="heading-7">1. <strong>Dockerå•èŠ‚ç‚¹éƒ¨ç½²ï¼ˆå¼€å‘æµ‹è¯•ï¼‰</strong></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨å¸¦Dashboardçš„EMQX</span>
docker run -d --name emqx \
  -p 1883:1883 -p 8083:8083 -p 8084:8084 -p 18083:18083 \
  -e EMQX_DASHBOARD__DEFAULT_USERNAME=admin \
  -e EMQX_DASHBOARD__DEFAULT_PASSWORD=public \
  emqx/emqx:5.4.1
</code></pre>
<p>è®¿é—®Dashboardï¼š<code>http://localhost:18083</code><br/>
<img alt="EMQX Dashboardæˆªå›¾è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/></p>
<h4 data-id="heading-8">2. <strong>Kubernetesç”Ÿäº§é›†ç¾¤éƒ¨ç½²</strong></h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># emqx-cluster.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">StatefulSet</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">emqx</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">serviceName:</span> <span class="hljs-string">emqx</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">emqx</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">emqx/emqx:5.4.1</span>
        <span class="hljs-attr">env:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">EMQX_CLUSTER__DISCOVERY_STRATEGY</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">k8s</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">EMQX_CLUSTER__K8S__APISERVER</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">"https://kubernetes.default.svc:443"</span>
        <span class="hljs-attr">ports:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">1883</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">mqtt</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">8081</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">dashboard</span>
<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">emqx</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">ports:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">1883</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">mqtt</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">8081</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">dashboard</span>
  <span class="hljs-attr">clusterIP:</span> <span class="hljs-string">None</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">emqx</span>
</code></pre>
<h4 data-id="heading-9">3. <strong>åƒä¸‡çº§è¿æ¥è°ƒä¼˜å‚æ•°</strong></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># emqx.conf å…³é”®é…ç½®</span>
node {
  process_limit = 2097152    <span class="hljs-comment"># Erlangè¿›ç¨‹æ•°</span>
  max_ports = 1048576        <span class="hljs-comment"># æœ€å¤§ç«¯å£æ•°</span>
}

listeners.tcp.default {
  max_connections = 1000000  <span class="hljs-comment"># å•èŠ‚ç‚¹æœ€å¤§è¿æ¥æ•°</span>
  zone = external
}
</code></pre>
<hr/>
<h3 data-id="heading-10">ä¸‰ã€ä¼ä¸šçº§å®æˆ˜ï¼šå››å¤§ç‰©è”åœºæ™¯æ·±åº¦è§£æ</h3>
<h4 data-id="heading-11">æ¡ˆä¾‹1ï¼šæ™ºèƒ½ç½‘è”æ±½è½¦å¹³å°ï¼ˆ50ä¸‡è½¦è¾†ï¼‰</h4>
<p><strong>æŒ‘æˆ˜</strong>ï¼š</p>
<ul>
<li>è½¦è¾†åœ¨çº¿ç‡ &gt;99.99%</li>
<li>æŒ‡ä»¤ä¸‹å‘å»¶è¿Ÿ &lt;100ms</li>
<li>æ—¥å‡æ¶ˆæ¯é‡80äº¿æ¡</li>
</ul>
<p><strong>EMQXè§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[è½¦è½½ç»ˆç«¯] --&gt; B(EMQXè¾¹ç¼˜é›†ç¾¤)
    B --&gt; C[åŒºåŸŸä¸­å¿ƒ]
    C --&gt; D[EMQXä¸­å¿ƒé›†ç¾¤]
    D --&gt; E[å¤§æ•°æ®å¹³å°]
</code></pre>
<ol>
<li><strong>åˆ†å±‚éƒ¨ç½²</strong>ï¼š
<ul>
<li>è¾¹ç¼˜èŠ‚ç‚¹ï¼šè¦†ç›–å…¨å›½30ä¸ªçœä»½ï¼Œå¤„ç†å®æ—¶æ§åˆ¶æ¶ˆæ¯</li>
<li>ä¸­å¿ƒé›†ç¾¤ï¼šæ±‡èšæ•°æ®è‡³Hadoopç”Ÿæ€</li>
</ul>
</li>
<li><strong>è´¨é‡ä¿éšœ</strong>ï¼š
<ul>
<li>QoS2ä¿è¯å…³é”®æŒ‡ä»¤å¯é ä¼ è¾“</li>
<li>$SYSä¸»é¢˜å®æ—¶ç›‘æ§é›†ç¾¤å¥åº·</li>
</ul>
</li>
<li><strong>æˆæ•ˆ</strong>ï¼š
<ul>
<li>è¿œç¨‹å‡çº§æˆåŠŸç‡99.992%</li>
<li>ç´§æ€¥åˆ¶åŠ¨æŒ‡ä»¤å»¶è¿Ÿ&lt;50ms</li>
</ul>
</li>
</ol>
<h4 data-id="heading-12">æ¡ˆä¾‹2ï¼šæ™ºæ…§å·¥å‚è®¾å¤‡ç›‘æ§ï¼ˆ10ä¸‡+ä¼ æ„Ÿå™¨ï¼‰</h4>
<p><strong>ç—›ç‚¹</strong>ï¼š</p>
<ul>
<li>Modbus/OPC UAç­‰å¤šåè®®æ¥å…¥</li>
<li>å®æ—¶é¢„è­¦å“åº”&lt;200ms</li>
</ul>
<p><strong>æ¶æ„è®¾è®¡</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åè®®è½¬æ¢ä¼ªä»£ç </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">opcua_to_mqtt</span>(<span class="hljs-params">node_data</span>):
    <span class="hljs-keyword">for</span> tag <span class="hljs-keyword">in</span> node_data:
        topic = <span class="hljs-string">f"factory/<span class="hljs-subst">{line_id}</span>/<span class="hljs-subst">{device_id}</span>/<span class="hljs-subst">{tag.name}</span>"</span>
        payload = json.dumps({<span class="hljs-string">"value"</span>: tag.value, <span class="hljs-string">"timestamp"</span>: time.time()})
        emqx.publish(topic, payload, qos=<span class="hljs-number">1</span>)
</code></pre>
<ol>
<li><strong>ç»Ÿä¸€æ¥å…¥</strong>ï¼š
<ul>
<li>å·¥ä¸šç½‘å…³åè®®è½¬æ¢</li>
<li>æ¶ˆæ¯ç»Ÿä¸€å…¥å£ï¼š<code>factory/+/+/+</code></li>
</ul>
</li>
<li><strong>è§„åˆ™å¼•æ“å¤„ç†</strong>ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
  payload.temp <span class="hljs-keyword">as</span> temperature, 
  clientid 
<span class="hljs-keyword">FROM</span> 
  "factory/#" 
<span class="hljs-keyword">WHERE</span> 
  temperature <span class="hljs-operator">&gt;</span> <span class="hljs-number">85</span>   <span class="hljs-comment">--&gt; è§¦å‘å†·å´ç³»ç»Ÿ</span>
</code></pre>
</li>
<li><strong>æˆæœ</strong>ï¼š
<ul>
<li>è®¾å¤‡æ•…éšœå‘ç°é€Ÿåº¦æå‡10å€</li>
<li>æ¯å¹´é¿å…åœå·¥æŸå¤±$1200ä¸‡</li>
</ul>
</li>
</ol>
<h4 data-id="heading-13">æ¡ˆä¾‹3ï¼šå›½å®¶ç”µç½‘æ™ºèƒ½ç”µè¡¨ï¼ˆ200ä¸‡ç»ˆç«¯ï¼‰</h4>
<p><strong>éœ€æ±‚</strong>ï¼š</p>
<ul>
<li>ç­‰ä¿å››çº§å®‰å…¨è¦æ±‚</li>
<li>æ•°æ®é‡‡é›†å®Œæ•´æ€§&gt;99.999%</li>
</ul>
<p><strong>å®‰å…¨æ¶æ„</strong>ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[ç”µè¡¨] --&gt;|PSKåŠ å¯†| B(EMQX)
    B --&gt;|TLSåŒå‘è®¤è¯| C[Kafka]
    C --&gt; D[è®¡è´¹ç³»ç»Ÿ]
    B --&gt; E[å®¡è®¡æ—¥å¿—]
</code></pre>
<ol>
<li><strong>å®‰å…¨åŠ å›º</strong>ï¼š
<ul>
<li>è®¾å¤‡è¯ä¹¦é¢„ç½®</li>
<li>æ¶ˆæ¯å®Œæ•´æ€§æ ¡éªŒ</li>
</ul>
</li>
<li><strong>æ•°æ®ä¿éšœ</strong>ï¼š
<ul>
<li>ç¦»çº¿æ¶ˆæ¯å­˜å‚¨ï¼ˆæœ€å¤š72å°æ—¶ï¼‰</li>
<li>æ–­ç½‘ç»­ä¼ æœºåˆ¶</li>
</ul>
</li>
<li><strong>æˆæ•ˆ</strong>ï¼š
<ul>
<li>é€šè¿‡å›½å®¶ç”µç½‘å®‰å…¨è®¤è¯</li>
<li>æ•°æ®ä¸¢å¤±ç‡&lt;0.0001%</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-14">å››ã€é«˜é˜¶åº”ç”¨ï¼šè§„åˆ™å¼•æ“ä¸æ•°æ®æ¡¥æ¥</h3>
<h4 data-id="heading-15">1. å®æ—¶æµå¤„ç†ç¤ºä¾‹</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
  payload.temperature <span class="hljs-keyword">as</span> temp,
  <span class="hljs-type">timestamp</span> <span class="hljs-keyword">as</span> ts,
  clientid 
<span class="hljs-keyword">FROM</span> 
  "sensor/#"
<span class="hljs-keyword">WHERE</span> 
  temp <span class="hljs-operator">&gt;</span> <span class="hljs-number">30</span> 
  <span class="hljs-keyword">AND</span> temp <span class="hljs-operator">-</span> <span class="hljs-keyword">last</span>(temp) <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span>   <span class="hljs-comment">-- æ¸©åº¦éª¤å‡æ£€æµ‹</span>
</code></pre>
<h4 data-id="heading-16">2. å¤šæ•°æ®æºæ¡¥æ¥é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¡¥æ¥è‡³Kafka</span>
bridges.kafka {
  <span class="hljs-built_in">enable</span> = <span class="hljs-literal">true</span>
  servers = <span class="hljs-string">"kafka1:9092,kafka2:9092"</span>
  topic = <span class="hljs-string">"emqx_messages"</span>
  producer {
    key = <span class="hljs-string">"<span class="hljs-variable">${clientid}</span>"</span>  -- æŒ‰è®¾å¤‡IDåˆ†åŒº
  }
}
</code></pre>
<h4 data-id="heading-17">3. è®¾å¤‡è”åŠ¨è§„åˆ™</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å½“æ¸©åº¦&gt;30ä¸”æ¹¿åº¦&lt;40%æ—¶å¼€å¯ç©ºè°ƒ</span>
rule {
  sql = <span class="hljs-string">"SELECT * FROM 'env/#' WHERE payload.temp&gt;30 AND payload.humidity&lt;40"</span>
  actions = [
    {
      <span class="hljs-keyword">function</span> = republish
      args = {
        topic = <span class="hljs-string">"cmd/air_conditioner/<span class="hljs-variable">${clientid}</span>/on"</span>
        payload = <span class="hljs-string">"{ \"power\": 1 }"</span>
      }
    }
  ]
}
</code></pre>
<hr/>
<h3 data-id="heading-18">äº”ã€æ€§èƒ½è°ƒä¼˜ï¼šäº¿çº§æ¶ˆæ¯åœºæ™¯å®æˆ˜</h3>
<h4 data-id="heading-19">1. é›†ç¾¤è§„æ¨¡è§„åˆ’å…¬å¼</h4>
<pre><code class="hljs language-scss" lang="scss">æ‰€éœ€èŠ‚ç‚¹æ•° = æ€»è¿æ¥æ•° / å•èŠ‚ç‚¹å®¹é‡ Ã— å†—ä½™ç³»æ•°(<span class="hljs-number">1.3</span>)
å•èŠ‚ç‚¹å®¹é‡ = <span class="hljs-built_in">min</span>(CPUæ ¸å¿ƒÃ—<span class="hljs-number">50</span>ä¸‡, å†…å­˜GB/<span class="hljs-number">0.02</span>)
</code></pre>
<h4 data-id="heading-20">2. ç›‘æ§æŒ‡æ ‡çœ‹æ¿</h4>
<p><img alt="EMQXç›‘æ§ä»ªè¡¨ç›˜è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/><br/>
å…³é”®æŒ‡æ ‡ï¼š</p>
<ul>
<li><code>connections.count</code>ï¼šå®æ—¶è¿æ¥æ•°</li>
<li><code>messages.rate</code>ï¼šæ¶ˆæ¯ååé€Ÿç‡</li>
<li><code>rule_engine.matched.rate</code>ï¼šè§„åˆ™è§¦å‘é¢‘ç‡</li>
</ul>
<h4 data-id="heading-21">3. æ•…éšœæ’æŸ¥å·¥å…·é›†</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹çƒ­ç‚¹ä¸»é¢˜</span>
emqx_ctl topics list

<span class="hljs-comment"># è¿½è¸ªå®¢æˆ·ç«¯æ¶ˆæ¯æµ</span>
emqx_ctl trace client <span class="hljs-string">"device_123"</span> <span class="hljs-string">"log/trace.log"</span>

<span class="hljs-comment"># è¯Šæ–­ç½‘ç»œç“¶é¢ˆ</span>
emqx_ctl observer
</code></pre>
<hr/>
<h3 data-id="heading-22">å…­ã€ç”Ÿæ€å…¨æ™¯ä¸æœªæ¥æ¼”è¿›</h3>
<h4 data-id="heading-23">EMQX 6.0æŠ€æœ¯å‰ç»ï¼š</h4>
<ol>
<li><strong>QUICåè®®æ”¯æŒ</strong>ï¼šå¼±ç½‘ç¯å¢ƒæ¶ˆæ¯ä¼ è¾“æˆåŠŸç‡æå‡300%</li>
<li><strong>æµæ•°æ®åº“é›†æˆ</strong>ï¼šå†…ç½®eKuiperå®ç°è¾¹ç¼˜æµå¤„ç†</li>
<li><strong>WebAssemblyæ‰©å±•</strong>ï¼šå®‰å…¨è¿è¡Œç”¨æˆ·è‡ªå®šä¹‰é€»è¾‘</li>
</ol>
<h4 data-id="heading-24">ç«å“å¯¹æ¯”çŸ©é˜µï¼š</h4>









































<table><thead><tr><th><strong>èƒ½åŠ›</strong></th><th>Mosquitto</th><th>HiveMQ</th><th><strong>EMQX</strong></th></tr></thead><tbody><tr><td>æœ€å¤§è¿æ¥æ•°</td><td>10ä¸‡</td><td>50ä¸‡</td><td><strong>500ä¸‡+</strong></td></tr><tr><td>æ¶ˆæ¯æŒä¹…åŒ–</td><td>æœ‰é™</td><td>ä¼ä¸šç‰ˆæ”¯æŒ</td><td><strong>å¼€ç®±å³ç”¨</strong></td></tr><tr><td>è§„åˆ™å¼•æ“</td><td>æ— </td><td>åŸºç¡€</td><td><strong>ç±»SQLå®Œæ•´</strong></td></tr><tr><td>é›†ç¾¤æ‰©å±•æ€§</td><td>éš¾æ‰©å±•</td><td>å•†ä¸šæ–¹æ¡ˆ</td><td><strong>åŸç”Ÿæ”¯æŒ</strong></td></tr><tr><td>åè®®æ‰©å±•</td><td>MQTT only</td><td>æ’ä»¶æ‰©å±•</td><td><strong>20+åè®®</strong></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-25">ç»“è¯­ï¼šç‰©è”ç½‘æ—¶ä»£çš„æ¶ˆæ¯åŸºç¡€è®¾æ–½</h3>
<p>EMQXç”¨å¼€æºåŠ›é‡é‡å¡‘äº†æ¶ˆæ¯ä¸­é—´ä»¶çš„æŠ€æœ¯è¾¹ç•Œâ€”â€”ä»å•æœºè®¾å¤‡åˆ°å›½å®¶çº§é¡¹ç›®ï¼Œä»æ¯«ç§’çº§è½¦æ§æŒ‡ä»¤åˆ°ç™¾äº¿çº§æ•°æ®æ´ªæµã€‚æ­£å¦‚æŸå…¨çƒè½¦ä¼CTOæ‰€è¨€ï¼šâ€œ<strong>å½“50ä¸‡è½¦è¾†åœ¨æš´é›¨å¤©åŒæ—¶ä¸ŠæŠ¥è·¯å†µæ—¶ï¼Œæ˜¯EMQXçš„ç¨³å®šæ€§ä¿éšœäº†æˆ‘ä»¬çš„ç”¨æˆ·å®‰å…¨</strong>â€ã€‚</p>
<blockquote>
<p><strong>ç«‹å³ä½“éªŒ</strong>ï¼š<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fdemo.emqx.io" target="_blank" title="https://demo.emqx.io" ref="nofollow noopener noreferrer">åœ¨çº¿Demo</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Femqx%2Femqx" target="_blank" title="https://github.com/emqx/emqx" ref="nofollow noopener noreferrer">GitHubä»“åº“</a></p>
</blockquote>
<p><strong>èµ„æºåŒ…ä¸‹è½½</strong>ï¼š</p>
<ul>
<li>[ç”Ÿäº§éƒ¨ç½²æ£€æŸ¥æ¸…å•]</li>
<li>[åƒä¸‡è¿æ¥è°ƒä¼˜æŒ‡å—]</li>
<li>[ç‰©è”ç½‘å®‰å…¨ç™½çš®ä¹¦]</li>
</ul>
<p><strong>è®¨è®ºè¯é¢˜</strong>ï¼š<br/>
ğŸ‘‰ ä½ åœ¨MQTTåº”ç”¨ä¸­é‡åˆ°çš„æœ€å¤§æŒ‘æˆ˜ï¼Ÿ<br/>
ğŸ‘‰ æœ€æœŸå¾…EMQXæ–°å¢å“ªäº›è¾¹ç¼˜è®¡ç®—èƒ½åŠ›ï¼Ÿ</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨ä½¿ç”¨Windowsç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯Windows Updateæ›´æ–°ä½ çš„ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°é”™è¯¯ä»£ç 0x80070422ã€‚]]></title>    <link>https://juejin.cn/post/7573595009551712266</link>    <guid>https://juejin.cn/post/7573595009551712266</guid>    <pubDate>2025-11-18T00:54:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573595009551712266" data-draft-id="7567190160461004835" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨ä½¿ç”¨Windowsç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯Windows Updateæ›´æ–°ä½ çš„ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°é”™è¯¯ä»£ç 0x80070422ã€‚"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2025-11-18T00:54:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœç½—ä¸‡ç›¸"/> <meta itemprop="url" content="https://juejin.cn/user/4116175105041085"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨ä½¿ç”¨Windowsç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯Windows Updateæ›´æ–°ä½ çš„ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°é”™è¯¯ä»£ç 0x80070422ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4116175105041085/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœç½—ä¸‡ç›¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:54:26.000Z" title="Tue Nov 18 2025 00:54:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åœ¨ä½¿ç”¨Windowsç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯Windows Updateæ›´æ–°ä½ çš„ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°é”™è¯¯ä»£ç 0x80070422ã€‚</h2>
<h3 data-id="heading-1">ä¸€.ä¸ºä»€ä¹ˆä¼šå‡ºç°é”™è¯¯0x80070422</h3>
<p>é”™è¯¯ä»£ç 0x80070422é€šå¸¸æ˜¯å› ä¸ºWindows UpdateæœåŠ¡æ²¡æœ‰è¢«å¯åŠ¨æˆ–å…¶ç›¸å…³çš„æœåŠ¡æœªèƒ½æ­£å¸¸è¿è¡Œå¼•èµ·çš„ã€‚è¿™å¯èƒ½æ˜¯ç”±äºç³»ç»Ÿè®¾ç½®æ”¹å˜ã€ç—…æ¯’æ„ŸæŸ“ã€æˆ–è€…æ˜¯æŸäº›ç³»ç»Ÿæ–‡ä»¶æŸåç­‰åŸå› å¯¼è‡´çš„ã€‚</p>
<h3 data-id="heading-2">è§£å†³æ–¹æ³•ä¸€ï¼šæ£€æŸ¥Windows UpdateæœåŠ¡æ˜¯å¦å¯åŠ¨</h3>
<p>æ“ä½œæ­¥éª¤ï¼š</p>
<ol>
<li>æŒ‰ä¸‹Win+Rç»„åˆé”®æ‰“å¼€"è¿è¡Œ"å¯¹è¯æ¡†ã€‚</li>
<li>è¾“å…¥â€œservices.mscâ€å¹¶æŒ‰å›è½¦ï¼Œæ‰“å¼€æœåŠ¡é¢æ¿ã€‚</li>
<li>åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ° Windows Update æœåŠ¡ï¼ŒåŒå‡»è¿›å…¥å±æ€§ã€‚</li>
<li>å¦‚æœæœåŠ¡çŠ¶æ€ä¸ºåœæ­¢ï¼Œè¯·ç‚¹å‡»â€œå¯åŠ¨â€æŒ‰é’®ã€‚ç¡®ä¿å¯åŠ¨ç±»å‹è®¾ç½®ä¸ºâ€œè‡ªåŠ¨â€ã€‚</li>
</ol>
<p>â€‹<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c99ac8362364aefaf35e6d5d7db089e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pCc572X5LiH55u4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764032066&amp;x-signature=397pkV0x04vxGYvnWkRog3aALDU%3D" alt="alt text" loading="lazy"/>â€‹</p>
<h3 data-id="heading-3">è§£å†³æ–¹æ³•äºŒï¼šå…³é—­ç½‘ç»œåœ°å€è½¬æ¢</h3>
<p>æ“ä½œæ­¥éª¤ï¼š</p>
<ol>
<li>æŒ‰ä¸‹Win+Rç»„åˆé”®æ‰“å¼€"è¿è¡Œ"å¯¹è¯æ¡†ã€‚</li>
<li>è¾“å…¥"services.msc"å¹¶æŒ‰å›è½¦ï¼Œæ‰“å¼€æœåŠ¡é¢æ¿ã€‚</li>
<li>åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°â€œç½‘ç»œè¿æ¥å…±äº«ï¼ˆICSï¼‰â€æœåŠ¡ï¼ŒåŒå‡»æ‰“å¼€å±æ€§é¡µé¢ã€‚</li>
<li>å°†å¯åŠ¨ç±»å‹è®¾ç½®ä¸º"ç¦ç”¨"ï¼Œç„¶åç‚¹å‡»"åœæ­¢"ï¼Œæœ€åç‚¹å‡»"åº”ç”¨"å’Œ"ç¡®å®šâ€ã€‚</li>
</ol>
<h3 data-id="heading-4">è§£å†³æ–¹æ³•ä¸‰ï¼šç¬¬ä¸‰æ–¹è½¯ä»¶è§£å†³</h3>
<p>è¿™ä¸ªæ–¹æ³•å¯èƒ½æ˜¯æœ€å¿«çš„äº†ï¼Œå› ä¸ºåªè¦ç‚¹å‡»ä¸€é”®ä¿®å¤å°±è¡Œï¼Œæ¨èä½¿ç”¨DirectX Repairå¢å¼ºç‰ˆâ€‹ã€‚</p>
<p>å¯ç”¨äºå¤šä¸ªæ“ä½œç³»ç»Ÿï¼Œå¦‚Windows XPã€Windows Vistaã€Windows 7ã€Windows 8ã€Windows 8.1ã€Windows 8.1 Updateã€Windows 10ã€Windows 11ï¼ŒåŒæ—¶å…¼å®¹32ä½æ“ä½œç³»ç»Ÿå’Œ64ä½æ“ä½œç³»ç»Ÿã€‚æœ¬ç¨‹åºä¼šæ ¹æ®ç³»ç»Ÿçš„ä¸åŒï¼Œè‡ªåŠ¨è°ƒæ•´ä»»åŠ¡æ¨¡å¼ï¼Œæ— éœ€ç”¨æˆ·è¿›è¡Œè®¾ç½®ã€‚</p>
<h4 data-id="heading-5">å®‰è£…åœ°å€è·å–</h4>
<p>â€‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fpan.quark.cn%2Fs%2F055d2a1282c0%25E2%2580%258B" target="_blank" title="https://pan.quark.cn/s/055d2a1282c0%E2%80%8B" ref="nofollow noopener noreferrer">pan.quark.cn/s/055d2a128â€¦</a></p>
<p>â€‹<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6729740dc61340b39126dde17017737a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pCc572X5LiH55u4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764032066&amp;x-signature=4Za7MS1k2zOuDsK%2BHfJHwoiTgzo%3D" alt="image" loading="lazy"/>â€‹</p>
<p>â€‹<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a4c06f294bc49c982edcbcef2cafdfd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pCc572X5LiH55u4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764032066&amp;x-signature=PHGlFb4NB8oYFtLRfSjJO8QTTvk%3D" alt="alt text" loading="lazy"/>â€‹</p>
<p>æ“ä½œç®€å•ï¼Œç‚¹å‡»ä¿®å¤å°±å¯ä»¥ï¼š</p>
<p>â€‹<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5a77d2d905e4bd9b3ddb0358b939be9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pCc572X5LiH55u4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764032066&amp;x-signature=hbuhQK2VTPLHGfa96lrAGWzFECA%3D" alt="alt text" loading="lazy"/>â€‹</p>
<h3 data-id="heading-6">è§£å†³æ–¹æ³•å››ï¼šæ‰§è¡Œç³»ç»Ÿæ–‡ä»¶æ£€æŸ¥å·¥å…·</h3>
<p>æ“ä½œæ­¥éª¤ï¼š</p>
<ol>
<li>åœ¨å¼€å§‹èœå•æœç´¢æ ä¸­è¾“å…¥"cmd"ï¼Œå³é”®ç‚¹å‡»å‘½ä»¤æç¤ºç¬¦å¹¶é€‰æ‹©"ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ"ã€‚</li>
<li>åœ¨å‘½ä»¤æç¤ºç¬¦çª—å£ä¸­è¾“å…¥"sfc /scannow"ç„¶åæŒ‰å›è½¦ï¼Œç³»ç»Ÿå°†å¼€å§‹æ‰«æå’Œä¿®å¤æŸåçš„ç³»ç»Ÿæ–‡ä»¶ã€‚</li>
</ol>
<p>â€‹<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a47b9bb8d3d46b3852fe0646df2d4fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pCc572X5LiH55u4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764032066&amp;x-signature=wZegGrl77hra4UJopKGrp6sbqws%3D" alt="alt text" loading="lazy"/>â€‹</p>
<p>â€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”µå•†å¤§å‚é¢è¯•é¢˜è§£ç­”ä¸åœºæ™¯è§£æ(äºŒ)]]></title>    <link>https://juejin.cn/post/7573587915809275945</link>    <guid>https://juejin.cn/post/7573587915809275945</guid>    <pubDate>2025-11-18T00:55:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573587915809275945" data-draft-id="7573776814926430227" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”µå•†å¤§å‚é¢è¯•é¢˜è§£ç­”ä¸åœºæ™¯è§£æ(äºŒ)"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-11-18T00:55:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="360_go_php"/> <meta itemprop="url" content="https://juejin.cn/user/2436173498956695"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”µå•†å¤§å‚é¢è¯•é¢˜è§£ç­”ä¸åœºæ™¯è§£æ(äºŒ)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173498956695/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    360_go_php
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T00:55:21.000Z" title="Tue Nov 18 2025 00:55:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç”µå•†å¤§å‚çš„æŠ€æœ¯é¢è¯•ä¸­ï¼Œé¢è¯•å®˜ä¸ä»…è€ƒå¯Ÿå€™é€‰äººçš„ç†è®ºåŸºç¡€ï¼Œè¿˜è¦è¯„ä¼°å…¶è§£å†³å®é™…é—®é¢˜çš„èƒ½åŠ›ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„æŠ€æœ¯é¢è¯•é¢˜ç›®å’Œè§£ç­”ï¼Œå¸Œæœ›èƒ½ä¸ºæ­£åœ¨é¢è¯•çš„ä½ æä¾›å¸®åŠ©ã€‚</p>
<h4 data-id="heading-0">1. <strong>ä¸€ä¸ª8Gçš„æœåŠ¡å™¨ï¼Œå †çš„å¤§å°åº”è¯¥è®¾ç½®æˆå¤šå°‘ï¼Ÿ</strong></h4>
<p>Â  Â åœ¨è®¾ç½®å †å¤§å°æ—¶ï¼Œé€šå¸¸ä¼šè€ƒè™‘ä»¥ä¸‹å‡ ä¸ªå› ç´ ï¼š<br/>
- <strong>JVMçš„å†…å­˜é™åˆ¶</strong>ï¼šé€šå¸¸ï¼ŒæœåŠ¡å™¨ä¸Šçš„æ€»å†…å­˜ä¸å®œè¶…è¿‡80%-85%ç”¨äºJVMå †ï¼Œä»¥ç¡®ä¿æ“ä½œç³»ç»Ÿå’Œå…¶ä»–è¿›ç¨‹æœ‰è¶³å¤Ÿçš„å†…å­˜ã€‚å› æ­¤ï¼Œå¯¹äº8Gçš„æœåŠ¡å™¨ï¼Œå¯ä»¥å°†å †çš„æœ€å¤§å€¼ï¼ˆ<code>-Xmx</code>ï¼‰è®¾ç½®ä¸º6.4Gå·¦å³ã€‚<br/>
- <strong>æ–°ç”Ÿä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹</strong>ï¼šå †å†…å­˜åˆ†ä¸ºæ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰å’Œè€å¹´ä»£ï¼ˆOld Generationï¼‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé»˜è®¤æƒ…å†µä¸‹æ–°ç”Ÿä»£çš„å†…å­˜å å †å†…å­˜çš„1/3ï¼Œè€å¹´ä»£å 2/3ã€‚ä½†å¯ä»¥æ ¹æ®å®é™…åº”ç”¨çš„GCè¡Œä¸ºè¿›è¡Œè°ƒæ•´ã€‚<br/>
- <strong>å®é™…åº”ç”¨åœºæ™¯</strong>ï¼šæ ¹æ®åº”ç”¨çš„å†…å­˜éœ€æ±‚ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œè°ƒä¼˜ã€‚</p>
<p>Â  Â <strong>å»ºè®®è®¾ç½®</strong>ï¼š<br/>
- æœ€å¤§å †å¤§å°ï¼š<code>-Xmx6g</code><br/>
- åˆå§‹å †å¤§å°ï¼š<code>-Xms4g</code>ï¼Œé¿å…JVMé¢‘ç¹æ‰©å±•å †çš„å¤§å°ã€‚<br/>
</p>
<h4 data-id="heading-1">2. <strong>æµ·é‡æ•°æ®æ±‚é¢‘ç‡æœ€å¤šçš„100ä¸ªï¼Ÿ</strong></h4>
<p>Â  Â å¤„ç†æµ·é‡æ•°æ®æ—¶ï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ–¹æ³•æ¥è·å–é¢‘ç‡æœ€å¤šçš„100ä¸ªæ•°æ®ï¼š<br/>
- <strong>å“ˆå¸Œè¡¨ï¼ˆHashMapï¼‰</strong>ï¼šç”¨å“ˆå¸Œè¡¨å­˜å‚¨æ•°æ®å’Œå…¶é¢‘ç‡ã€‚æ¯é‡åˆ°ä¸€ä¸ªæ•°æ®ï¼Œæ›´æ–°å®ƒçš„é¢‘ç‡ã€‚è¿™ä¸ªæ–¹æ³•ç®€å•é«˜æ•ˆï¼Œä½†å¯¹äºæµ·é‡æ•°æ®ï¼Œå†…å­˜æ¶ˆè€—è¾ƒå¤§ã€‚<br/>
- <strong>å †æ’åº</strong>ï¼šä½¿ç”¨ä¸€ä¸ªæœ€å°å †ï¼ˆå¤§å°ä¸º100ï¼‰æ¥å­˜å‚¨é¢‘ç‡æœ€é«˜çš„100ä¸ªæ•°æ®ã€‚æ¯å½“å †ä¸­å…ƒç´ è¶…è¿‡100ä¸ªæ—¶ï¼Œåˆ é™¤æœ€å°çš„å…ƒç´ ã€‚è¿™æ ·å¯ä»¥åœ¨éå†å®Œæ‰€æœ‰æ•°æ®åå¾—åˆ°é¢‘ç‡æœ€é«˜çš„100ä¸ªæ•°æ®ã€‚<br/>
- <strong>å¤–éƒ¨æ’åº</strong>ï¼šå½“æ•°æ®é‡è¿‡å¤§æ—¶ï¼Œå¯ä»¥è€ƒè™‘å°†æ•°æ®åˆ†å‰²æˆå¤šä¸ªå—ï¼Œåˆ†åˆ«è®¡ç®—æ¯å—çš„é¢‘ç‡ï¼Œç„¶åå°†ç»“æœåˆå¹¶åè¿›è¡Œæœ€ç»ˆçš„æ’åºã€‚</p>
<h4 data-id="heading-2">3. <strong>Springä¸€ä¸ªäº‹åŠ¡ä¸­è°ƒç”¨å¦å¤–ä¸€ä¸ªäº‹åŠ¡ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡å‘ç”Ÿå¼‚å¸¸ä¼šæ€ä¹ˆæ ·ï¼Ÿ</strong></h4>
<p>Â  Â åœ¨Springæ¡†æ¶ä¸­ï¼Œäº‹åŠ¡ç®¡ç†æ˜¯é€šè¿‡å£°æ˜å¼äº‹åŠ¡ï¼ˆ<code>@Transactional</code>ï¼‰æ¥å®ç°çš„ã€‚<br/>
- <strong>ä¼ æ’­è¡Œä¸º</strong>ï¼šå¦‚æœä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•ï¼Œå¹¶ä¸”ç¬¬äºŒä¸ªæ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œäº‹åŠ¡çš„è¡Œä¸ºå–å†³äºäº‹åŠ¡çš„ä¼ æ’­å±æ€§ï¼ˆä¾‹å¦‚<code>Propagation.REQUIRED</code>ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpringä¼šå°†å¼‚å¸¸æŠ›å‡ºå¹¶å›æ»šå¤–éƒ¨äº‹åŠ¡ã€‚<br/>
- <strong>äº‹åŠ¡å›æ»š</strong>ï¼šå¦‚æœåœ¨æ–¹æ³•Aä¸­è°ƒç”¨æ–¹æ³•Bï¼Œå¹¶ä¸”æ–¹æ³•BæŠ›å‡ºæœªè¢«æ•è·çš„å¼‚å¸¸ï¼ŒSpringä¼šå›æ»šæ–¹æ³•Açš„äº‹åŠ¡ï¼Œé™¤éåœ¨<code>@Transactional</code>æ³¨è§£ä¸­æ˜ç¡®æŒ‡å®šä¸å›æ»šã€‚</p>
<h4 data-id="heading-3">4. <strong>ä¸€ä¸ªçˆ¶ç±»åŠ è½½å™¨èƒ½ä¸èƒ½åŠ è½½ä¸€ä¸ªå­ç±»åŠ è½½å™¨ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</strong></h4>
<p>Â  Â - <strong>ç­”æ¡ˆ</strong>ï¼šä¸èƒ½ã€‚çˆ¶ç±»åŠ è½½å™¨åªèƒ½åŠ è½½çˆ¶ç±»åŠå…¶çˆ¶ç±»çš„ç±»ï¼Œè€Œä¸èƒ½åŠ è½½å­ç±»åŠå…¶å­ç±»çš„ç±»ã€‚Javaçš„ç±»åŠ è½½å™¨éµå¾ªçˆ¶å§”æ‰˜æ¨¡å‹ï¼Œå³å­ç±»åŠ è½½å™¨åªèƒ½åŠ è½½å­ç±»åŠå­ç±»çš„ç±»ï¼Œè€Œçˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½å­ç±»çš„ç±»ã€‚<br/>
- <strong>åŸå› </strong>ï¼šè¿™ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢ç±»çš„é‡å¤åŠ è½½å’Œç¡®ä¿ç±»åŠ è½½çš„å±‚æ¬¡ç»“æ„ã€‚</p>
<h4 data-id="heading-4">5. <strong><code>select * from A where id in (select id from B)</code> æ€ä¹ˆä¼˜åŒ–ï¼Ÿ</strong></h4>
<p>Â  Â è¿™ç±»æŸ¥è¯¢é€šå¸¸ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå°¤å…¶æ˜¯å½“è¡¨Bçš„æ•°æ®é‡å¾ˆå¤§æ—¶ã€‚å¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¼˜åŒ–æ–¹æ¡ˆï¼š<br/>
- <strong>ä½¿ç”¨JOINæ›¿ä»£å­æŸ¥è¯¢</strong>ï¼š<code>select A.* from A join B on A.id = B.id</code>ã€‚è¿™ç§æ–¹å¼é€šå¸¸æ¯”<code>IN</code>æ›´é«˜æ•ˆã€‚<br/>
- <strong>ç´¢å¼•ä¼˜åŒ–</strong>ï¼šç¡®ä¿<code>A.id</code>å’Œ<code>B.id</code>å­—æ®µæœ‰ç´¢å¼•ï¼Œè¿™æ ·å¯ä»¥åŠ å¿«æŸ¥è¯¢çš„é€Ÿåº¦ã€‚<br/>
- **é¿å…SELECT ***ï¼šä»…æŸ¥è¯¢éœ€è¦çš„å­—æ®µï¼Œé¿å…æµªè´¹èµ„æºã€‚</p>
<h4 data-id="heading-5">6. <strong>ä¸€ä¸ª16Gçš„å†…å­˜å †åˆ†é…å¤šå°‘ï¼Œé‡‡ç”¨ä»€ä¹ˆåƒåœ¾æ”¶é›†å™¨ï¼Œä¸ºä»€ä¹ˆç”¨CMSä¸ç”¨G1ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</strong></h4>
<p>Â  Â - <strong>å †å†…å­˜åˆ†é…</strong>ï¼šå¯¹äº16Gçš„å †å†…å­˜ï¼Œå¯ä»¥å°†åˆå§‹å †å¤§å°ï¼ˆ<code>-Xms</code>ï¼‰å’Œæœ€å¤§å †å¤§å°ï¼ˆ<code>-Xmx</code>ï¼‰è®¾ç½®ä¸ºç›¸åŒçš„å€¼ï¼ˆå¦‚16Gï¼‰ï¼Œä»¥é¿å…JVMåŠ¨æ€è°ƒæ•´å †å†…å­˜çš„å¼€é”€ã€‚<br/>
- <strong>åƒåœ¾æ”¶é›†å™¨é€‰æ‹©</strong>ï¼š Â <br/>
- <strong>CMSï¼ˆConcurrent Mark-Sweepï¼‰</strong>ï¼šé€‚åˆä½å»¶è¿Ÿçš„åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯å¯¹å“åº”æ—¶é—´æ•æ„Ÿçš„åº”ç”¨ã€‚CMSåƒåœ¾æ”¶é›†å™¨çš„ä¼˜ç‚¹æ˜¯èƒ½åœ¨åº”ç”¨çº¿ç¨‹è¿è¡Œæ—¶è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå‡å°‘äº†åœé¡¿æ—¶é—´ã€‚<br/>
- <strong>G1ï¼ˆGarbage-Firstï¼‰</strong>ï¼šG1æ›´é€‚ç”¨äºå¤§å†…å­˜å †çš„åœºæ™¯ï¼Œèƒ½å¤Ÿæä¾›æ›´å¯é¢„æµ‹çš„åƒåœ¾å›æ”¶åœé¡¿æ—¶é—´ï¼Œå¹¶ä¸”å¯ä»¥æ›´å¥½åœ°ç®¡ç†å¤§å†…å­˜çš„å›æ”¶ã€‚ç›¸è¾ƒäºCMSï¼ŒG1æ›´å¤æ‚ï¼Œé€‚ç”¨äºå¤§å†…å­˜å’Œéœ€è¦æ›´å¤šæ§åˆ¶çš„åœºæ™¯ã€‚<br/>
- <strong>ä¸ºä»€ä¹ˆé€‰æ‹©CMSè€Œä¸æ˜¯G1</strong>ï¼šCMSé€‚ç”¨äºä½å»¶è¿Ÿåœºæ™¯ï¼Œå°¤å…¶æ˜¯åœ¨è¾ƒä¸ºç¨³å®šçš„å†…å­˜ä½¿ç”¨ä¸‹ã€‚è€ŒG1æ”¶é›†å™¨ç›¸å¯¹è¾ƒé‡ï¼Œé€‚ç”¨äºå¤§å†…å­˜å’Œé•¿æœŸè¿è¡Œçš„åº”ç”¨ï¼Œä½†CMSå¯èƒ½åœ¨çŸ­æœŸå†…è¡¨ç°å¾—æ›´ä¸ºç¨³å®šã€‚</p>
<h4 data-id="heading-6">7. <strong>å¤šçº¿ç¨‹è§£æä¸€ä¸ªè¶…å¤§æ–‡ä»¶æ€ä¹ˆå¤„ç†ï¼Œå¦‚æœæ–‡ä»¶åˆ‡åˆ†çš„æ—¶å€™å…³é”®ä¿¡æ¯è¢«åˆ†åˆ°äº†ä¸åŒçš„è§£æçº¿ç¨‹ä¸­æ€ä¹ˆåŠï¼Ÿ</strong></h4>
<p>Â  Â - <strong>å¤šçº¿ç¨‹åˆ‡åˆ†æ–‡ä»¶</strong>ï¼šå¯ä»¥ä½¿ç”¨<code>ExecutorService</code>æ¥ç®¡ç†å¤šçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹è´Ÿè´£è§£ææ–‡ä»¶çš„ä¸€éƒ¨åˆ†ã€‚<br/>
- <strong>å…³é”®ä¿¡æ¯å¤„ç†</strong>ï¼šå¦‚æœæ–‡ä»¶ä¸­çš„å…³é”®ä¿¡æ¯åˆ†å¸ƒåœ¨ä¸åŒçš„éƒ¨åˆ†ï¼Œå¯ä»¥é‡‡å–ä¸¤ç§ç­–ç•¥ï¼š<br/>
- <strong>å…¨å±€åˆå¹¶</strong>ï¼šåœ¨æ–‡ä»¶åˆ‡åˆ†åï¼Œä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„åˆå¹¶æ­¥éª¤æ¥å¤„ç†å…³é”®ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡å…±äº«æ•°æ®ç»“æ„æ¥åˆå¹¶å„ä¸ªçº¿ç¨‹çš„ç»“æœã€‚<br/>
- <strong>æ•°æ®åŒæ­¥</strong>ï¼šä½¿ç”¨<code>ThreadLocal</code>æˆ–çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„ï¼ˆå¦‚<code>ConcurrentHashMap</code>ï¼‰æ¥ä¿è¯æ¯ä¸ªçº¿ç¨‹çš„è§£æç»“æœä¸ä¼šè¢«é”™è¯¯è¦†ç›–ã€‚</p>
<h4 data-id="heading-7">8. <strong>HashSetæ˜¯å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰çš„ï¼Ÿ</strong></h4>
<p>Â  Â - <strong>HashSetçš„å®ç°</strong>ï¼šHashSetå†…éƒ¨ä½¿ç”¨<code>HashMap</code>æ¥å­˜å‚¨å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éƒ½ä¼šè°ƒç”¨<code>hashCode()</code>æ–¹æ³•æ¥ç¡®å®šå­˜å‚¨ä½ç½®ã€‚<br/>
- <strong>åˆ¤æ–­ç›¸ç­‰</strong>ï¼šHashSetä¼šé€šè¿‡<code>hashCode()</code>æ–¹æ³•å’Œ<code>equals()</code>æ–¹æ³•æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„<code>hashCode()</code>ç›¸åŒï¼Œå†é€šè¿‡<code>equals()</code>æ–¹æ³•æ£€æŸ¥å®ƒä»¬çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚</p>
<h4 data-id="heading-8">9. <strong>å¦‚ä½•è®©ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Ÿequalså’ŒhashCodeè¿™ä¸¤ä¸ªæ–¹æ³•è¦æ€ä¹ˆé‡å†™ï¼Ÿ</strong></h4>
<p>Â  Â - <strong><code>equals()</code>æ–¹æ³•</strong>ï¼šåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚å¸¸è§çš„å®ç°æ­¥éª¤åŒ…æ‹¬ï¼š<br/>
1. æ¯”è¾ƒå¯¹è±¡çš„ç±»å‹ã€‚<br/>
2. æ¯”è¾ƒå¯¹è±¡çš„æ¯ä¸ªå­—æ®µå€¼ã€‚<br/>
- <strong><code>hashCode()</code>æ–¹æ³•</strong>ï¼šè¿”å›å¯¹è±¡çš„å“ˆå¸Œå€¼ã€‚æ ¹æ®<code>equals()</code>çš„å®ç°ï¼Œ<code>hashCode()</code>çš„å€¼åº”è¯¥æ ¹æ®å¯¹è±¡çš„å­—æ®µè®¡ç®—ï¼Œç¡®ä¿ç›¸ç­‰çš„å¯¹è±¡å…·æœ‰ç›¸åŒçš„å“ˆå¸Œå€¼ã€‚<br/>
- <strong>é‡å†™æ—¶çš„æ³¨æ„äº‹é¡¹</strong>ï¼šå¦‚æœé‡å†™<code>equals()</code>ï¼Œåˆ™å¿…é¡»é‡å†™<code>hashCode()</code>ï¼Œå¦åˆ™HashSetç­‰å®¹å™¨æ— æ³•æ­£ç¡®å·¥ä½œã€‚</p>
<h4 data-id="heading-9">10. <strong>Hashç®—æ³•ï¼ˆé¢è¯•å®˜ä¸€ç›´é—®ä¸ºä»€ä¹ˆä½¿ç”¨CMSæˆ–G1ï¼Œä¸ºä»€ä¹ˆï¼‰</strong></h4>
<p>Â  Â é¢è¯•å®˜å¯èƒ½æ˜¯å¸Œæœ›ä½ è®²è§£<strong>å“ˆå¸Œå†²çªå¤„ç†</strong>ã€‚å¸¸è§çš„å“ˆå¸Œç®—æ³•åŒ…æ‹¬ï¼š<br/>
- <strong>æ‹‰é“¾æ³•ï¼ˆé“¾è¡¨æ³•ï¼‰</strong>ï¼šå½“å‘ç”Ÿå“ˆå¸Œå†²çªæ—¶ï¼Œå°†å†²çªçš„å…ƒç´ å­˜å‚¨åœ¨ä¸€ä¸ªé“¾è¡¨ä¸­ã€‚<br/>
- <strong>å¼€æ”¾åœ°å€æ³•</strong>ï¼šé€šè¿‡æ¢æµ‹æ¥å¯»æ‰¾ä¸‹ä¸€ä¸ªç©ºä½å­˜å‚¨å†²çªçš„å…ƒç´ ï¼ˆå¦‚çº¿æ€§æ¢æµ‹ã€äºŒæ¬¡æ¢æµ‹ç­‰ï¼‰ã€‚<br/>
- <strong>è´¨æ•°å–ä½™æ³•</strong>ï¼šä½¿ç”¨è´¨æ•°å¯¹å“ˆå¸Œå€¼è¿›è¡Œå–ä½™æ“ä½œï¼Œä»¥å‡å°‘å“ˆå¸Œå†²çªã€‚</p>
<p>Â  Â å¦‚æœé¢è¯•å®˜æåˆ°G1æˆ–CMSçš„é€‰æ‹©ï¼Œå¯èƒ½æ˜¯æƒ³è€ƒå¯Ÿä½ å¯¹åƒåœ¾å›æ”¶å™¨é€‰æ‹©çš„ç†è§£ï¼Œå¦‚ä½•æ ¹æ®å…·ä½“åœºæ™¯åšå‡ºåˆé€‚çš„æŠ€æœ¯å†³ç­–ã€‚</p>
<hr/>
<p>è¿™äº›é—®é¢˜æ¶‰åŠäº†Javaå¼€å‘ã€æ•°æ®åº“ä¼˜åŒ–ã€å¹¶å‘ç¼–ç¨‹ç­‰æ–¹é¢çš„çŸ¥è¯†ï¼Œæ˜¯å¤§å‚é¢è¯•ä¸­å¸¸è§çš„è€ƒå¯Ÿç‚¹ã€‚æŒæ¡è¿™äº›çŸ¥è¯†ç‚¹ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°åº”å¯¹æŠ€æœ¯é¢è¯•ä¸­çš„æŒ‘æˆ˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>