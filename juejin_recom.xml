<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>掘金文章推荐</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>一个帮助开发者成长的社区</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[LangGraph1.0速通指南（一）—— LangGraph1.0 核心概念、点、边]]></title>    <link>https://juejin.cn/post/7584689488770252835</link>    <guid>https://juejin.cn/post/7584689488770252835</guid>    <pubDate>2025-12-18T00:10:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584689488770252835" data-draft-id="7583980250734460991" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangGraph1.0速通指南（一）—— LangGraph1.0 核心概念、点、边"/> <meta itemprop="keywords" content="人工智能,LangChain,Agent"/> <meta itemprop="datePublished" content="2025-12-18T00:10:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="大模型真好玩"/> <meta itemprop="url" content="https://juejin.cn/user/3140624091453053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangGraph1.0速通指南（一）—— LangGraph1.0 核心概念、点、边
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3140624091453053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    大模型真好玩
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:10:55.000Z" title="Thu Dec 18 2025 00:10:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读14分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"「";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"」";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"✓";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">前言</h2>
<p>在之前的系列中，笔者已经系统梳理了 <a href="https://juejin.cn/post/7567301894648004648" target="_blank" title="https://juejin.cn/post/7567301894648004648">LangChain 1.0 的核心知识点</a>，并通过一个 <a href="https://juejin.cn/post/7572836557142491136" target="_blank" title="https://juejin.cn/post/7572836557142491136">多模态 RAG 项目</a> 带领大家实践了 LangChain 1.0 的关键技术。从本篇开始，笔者将为大家进一步分享 <strong>LangGraph 1.0</strong> 的相关知识。与 LangChain 1.0 相比，LangGraph 1.0 的整体架构变动不大，但其定位发生了重要转变：在 1.0 版本之后，<strong>LangGraph 不再是 LangChain 的能力延伸，而是成为 LangChain 的能力底座</strong>。它通过灵活的状态管理、“点”与“边”的抽象、记忆机制以及“人在回路”的高效控制，特别适合构建精细化、可编排的工作流。</p>
<p>从本期开始笔者将逐步介绍 LangGraph 1.0 的这些核心特性，并最终使用 LangGraph 搭建一个 <strong>邮件自动回复工具流</strong>。本期先从基础入手，讲解 <strong>LangGraph 1.0 的核心概念</strong>，重点解析  <strong>“点”与“边”</strong>  的设计与使用。</p>
<p>LangGraph1.0 与先前版本变动不大，预计花费三节左右的时间讲解，同时也要说明笔者的专栏<a href="https://juejin.cn/column/7526240014499495972" target="_blank" title="https://juejin.cn/column/7526240014499495972">《深入浅出LangChain&amp;LangGraph AI Agent 智能体开发》</a>适合所有对 LangChain 感兴趣的学习者，无论之前是否接触过 LangChain。该专栏基于笔者在实际项目中的深度使用经验，系统讲解了使用LangChain/LangGraph如何开发智能体，目前已更新 30 讲，并持续补充实战与拓展内容。欢迎感兴趣的同学关注笔者的掘金账号与专栏，也可关注笔者的同名微信公众号 <strong>大模型真好玩</strong>，每期分享涉及的代码均可在公众号私信: <strong>LangChain智能体开发</strong>免费获取。</p>
<h2 data-id="heading-1">一、LangGraph 核心特性</h2>
<p>LangGraph 是一个极其灵活的框架，其核心设计理念可以概括为：<strong>它是一种用于构建智能体的“编程语言”</strong> 。</p>
<p>如同任何编程语言都包含数据、函数、控制流等基本要素一样，LangGraph 也提供了功能对等的抽象组件，使开发者能够以声明式的方式编排智能体工作流。其核心特性的对应关系如下：</p>



































<table><thead><tr><th>编程语言要素</th><th>LangGraph 对应概念</th><th>说明</th></tr></thead><tbody><tr><td><strong>数据 (Data)</strong></td><td><strong>状态 (State)</strong></td><td>工作流执行过程中传递和更新的信息载体。</td></tr><tr><td><strong>函数 (Function)</strong></td><td><strong>节点 (Node)</strong></td><td>对状态进行操作（如调用模型、执行工具）的基本单元。</td></tr><tr><td><strong>控制逻辑 (Control Flow)</strong></td><td><strong>边 (Edge)</strong></td><td>决定节点间执行顺序的逻辑，可以是<strong>条件分支</strong>或<strong>静态路径</strong>，支持串行与并行。</td></tr><tr><td><strong>存储 (Storage)</strong></td><td><strong>检查点 / 记忆 (Checkpointing / Memory)</strong></td><td>状态的持久化机制，允许工作流暂停、恢复或具有长期记忆。</td></tr><tr><td><strong>中断 (Interrupt)</strong></td><td><strong>人在回路 (Human-in-the-Loop)</strong></td><td>通过中断控制流，在关键环节引入人工审核或干预的能力。</td></tr></tbody></table>
<p>通过以上组件，LangGraph 使得构建一个具备复杂逻辑、可持续运行且支持人机协作的智能体系统变得直观且高效。</p>
<h2 data-id="heading-2">二、状态State和节点Node</h2>
<h3 data-id="heading-3">2.1 状态State</h3>
<p>LangGraph是一个状态图，状态可以理解为图的数据。在定义图之前首先应该定义一个状态作为初始值，在图的更新过程中状态值是可以被图更新并返回给用户的。</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29734f786fdf4e659924befbc507ebd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=LiAKCXBNQikqkB2TIwaxg0Q9FRc%3D" alt="0.png" width="30%" loading="lazy"/></p>
<p>图本身是无状态的，在定义图时，首先要定义图将操作的状态。这个状态由图中的所有节点共享。状态通常是一个Python数据结构。定义状态的方式可以采用类型化字典。比如下面代码就定义了包含名为<code>nList</code>字符串列表的状态值。当图被调用时，状态会被初始化，LangGraph运行时会选择一个节点来执行，然后它会提供当前状态，运行节点，最后更新状态再到结束。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    nlist: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]
</code></pre>
<h3 data-id="heading-4">2.2 节点</h3>
<p>在LangGraph中，节点的本质是一个函数。节点函数的输入参数是状态，输出则是对状态的更新。举例如下：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">node_a</span>(<span class="hljs-params">state: State</span>):
    ...
    <span class="hljs-keyword">return</span> ({<span class="hljs-string">"nlist"</span>:[note]})
</code></pre>
<p>以上节点函数执行完成后会对字符串列表进行更新。State 可以被持久化（通过 Checkpointing 机制）。这意味着如果节点执行失败或工作流被中断，可以从上一个检查点恢复状态重新运行，保证了工作流的鲁棒性。</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efe406695db94be68c276d0910b483cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=dvYK0Nmfkq5FOBoRBiPhifKf36w%3D" alt="1.png" width="50%" loading="lazy"/></p>
<h3 data-id="heading-5">2.3 使用LangGraph构建简单图</h3>
<p>下面笔者通过一个完整的代码示例，将 State 和 Node 的概念串联起来，构建一个最简单的单节点图。在开始之前，请大家确保已经安装了langgraph相关环境。如未安装，可以运行 <code>pip install -U langgraph</code>命令。</p>
<ol>
<li>
<p>导入依赖库</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> START, END, StateGraph
</code></pre>
</li>
<li>
<p>创建图表的第一步是定义一个<strong>State</strong>类，类型是字典。它包含一个字符串类型的列表,状态可以是一个Python数据类也可以是一个Pydantic基类模型，关于pydantic的使用大家可以参考笔者的文章: <a href="https://juejin.cn/post/7551665834499899444#heading-6" target="_blank" title="https://juejin.cn/post/7551665834499899444#heading-6">深入浅出LangGraph AI Agent智能体开发教程（六）—LangGraph 底层API入门</a>, 也可查看<a href="https://link.juejin.cn?target=https%3A%2F%2Fpydantic.com.cn%2F" target="_blank" title="https://pydantic.com.cn/" ref="nofollow noopener noreferrer">pydantic官方文档</a>， 这里不加赘述了。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    nList: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]
</code></pre>
</li>
<li>
<p>定义节点，节点实际上就是Python函数，该函数接收状态，打印信息然后返回状态的更新。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">node_a</span>(<span class="hljs-params">state</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"noda_a接收到<span class="hljs-subst">{state[<span class="hljs-string">'nList'</span>]}</span>"</span>)
    note = <span class="hljs-string">"Hello, 我是节点a"</span>
    <span class="hljs-keyword">return</span>(State(nList=[note]))
</code></pre>
</li>
<li>
<p>编译状态图，将节点加入到图中，定义为"a"节点，同时添加从START节点到"a"节点的边，然后添加从"a"到END的边。这里的START和END都是LangGraph定义的常量节点，仅包含语义信息。最后编译图</p>
<pre><code class="hljs language-python" lang="python">builder = StateGraph(State)
builder.add_node(<span class="hljs-string">"a"</span>, node_a)
builder.add_edge(START, <span class="hljs-string">"a"</span>)
builder.add_edge(<span class="hljs-string">"a"</span>, END)
graph = builder.<span class="hljs-built_in">compile</span>()
</code></pre>
<p>以上代码构建了一个如下的简单图。</p>
</li>
</ol>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d12cc1a68fc4422be3d511bfc6a0bc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=oN%2BDrwFIByZcN%2BjPocOW%2B%2FsnNY4%3D" alt="2.png" width="30%" loading="lazy"/></p>
<ol start="5">
<li>接下来测试这个图，首先使用State初始化一个状态变量，然后通过<code>.invoke</code>方法运行图。可以看到节点A接收了初始状态，然后当调用图完成后返回了更新后的状态。
<pre><code class="hljs language-python" lang="python">initial_state = State(
    nList=[<span class="hljs-string">"Hello Node a, how are you?"</span>]
)
<span class="hljs-built_in">print</span>(graph.invoke(initial_state))
</code></pre>
</li>
</ol>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6e0f755a2c14b18993db2bf0174aa00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=s9wt%2FbmroUD%2Bogrey4ZexWuu%2F%2Bk%3D" alt="15.png" loading="lazy"/></p>
<p>通过以上案例大家应该可以理解在定义图和状态时，图中所有节点可以共享相同的状态。</p>
<h2 data-id="heading-6">三、边</h2>
<p>在定义了“数据”（State）和“操作”（Node）之后，笔者接下来介绍<strong>边</strong>。<strong>边 (Edge)</strong>  是 LangGraph 中定义工作流<strong>执行逻辑</strong>的核心。它决定了节点之间的连接关系与执行顺序，是实现串行、并行、条件分支等复杂逻辑的关键。</p>
<h3 data-id="heading-7">3.1 普通边</h3>
<p><strong>普通边（静态边）</strong>  用于连接两个节点，指定了确定无误的执行顺序。它是最简单的控制流，定义了工作流中“下一步该执行谁”。</p>
<ul>
<li><strong>串行执行</strong>：通过连续的普通边连接多个节点，形成一个线性的执行链。例如：<code>START -&gt; A -&gt; B -&gt; C -&gt; END</code>。</li>
<li><strong>并行执行</strong>：一个节点可以同时拥有多个出边（<code>outgoing edges</code>），指向不同的后续节点。LangGraph 运行时会在当前节点完成后，<strong>同时触发</strong>所有这些后续节点的执行。</li>
</ul>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88136b7fd0114e4a8537f626e6b5e734~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=zKSjIck1IXcc9UtVD4kHgNYUAFc%3D" alt="3.png" width="70%" loading="lazy"/></p>
<h3 data-id="heading-8">3.2 条件边</h3>
<p>除普通边外，LangGraph还有另一种条件边。条件边允许工作流根据运行时状态<strong>动态决定</strong>下一步的执行路径。它需要一个<strong>路由函数</strong>，该函数接收当前状态，并选择下一个要执行的节点。下图左侧根据条件选择将状态传递给下一级左侧节点进行处理。条件边还有一个特殊情况是<strong>MapReduce</strong>, 它可以创建可变数量的下游节点，并且每个节点都传递了一个唯一值（笔者之后也会讲到）。</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/deb91ce98454469cb0a891760ca3572c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=EgMsRCv%2Bg%2F%2B7X%2FkrZMpNvO6MA3Y%3D" alt="5.png" width="70%" loading="lazy"/></p>
<h3 data-id="heading-9">3.3 Reducer详解</h3>
<p>当一个节点拥有多个出边（即触发了并行执行）时，多个后续节点可能<strong>同时更新 State 中的同一个字段</strong>。此时就会产生冲突：以谁的更新为准？默认情况下，节点的更新是<strong>覆盖式</strong>的。如果节点B和节点C并行执行，都尝试更新<code>state[‘messages’]</code>，后完成的节点会覆盖先完成节点的结果，导致数据丢失。</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5b1355ca283410bbb8c5607c466b81d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=q72h4XxsKO%2BQ7s22OQEGJ1hXzP0%3D" alt="6.png" width="70%" loading="lazy"/></p>
<p>为了更精确的控制，这时就需要用到<strong>Reducer（归约器）</strong> 来解决解决此问题。它是一个<strong>合并函数</strong>，定义了当多个更新同时作用于同一个状态字段时，应如何合并这些更新。下面的状态定义中的<code>operator.add</code>就是一个Reducer，它指定了列表状态应该是合并而不是覆写</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> operator
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict, Annotated


<span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    nList: Annotated[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>], operator.add]
</code></pre>
<p>LangGraph 提供了一些开箱即用的 Reducer，下表列出了最常见的几种：</p>








































<table><thead><tr><th>Reducer 函数</th><th>导入来源</th><th>适用数据类型</th><th>主要行为</th><th>典型应用场景</th></tr></thead><tbody><tr><td><strong><code>operator.add</code></strong></td><td><code>operator</code> (Python标准库)</td><td><code>int</code>, <code>float</code></td><td>数值<strong>累加</strong></td><td>计数器、计分器</td></tr><tr><td><strong><code>operator.extend</code></strong></td><td><code>operator</code> (Python标准库)</td><td><code>List[T]</code></td><td>列表<strong>扩展</strong> (<code>list.extend</code>)</td><td>收集多项结果，如搜索条目</td></tr><tr><td><strong><code>operator.or_</code></strong></td><td><code>operator</code> (Python标准库)</td><td><code>Set[T]</code></td><td>集合<strong>取并集</strong>，自动去重</td><td>收集标签、唯一ID集合</td></tr><tr><td><strong><code>update_dict</code></strong></td><td><code>langgraph.utils</code></td><td><code>Dict</code></td><td><strong>合并字典</strong>，新值覆盖旧键</td><td>更新配置或元数据</td></tr></tbody></table>
<p>除了使用内置的Reducer外，开发者甚至可以自定义reducer进行处理。Reducer就是一个合并函数，该函数接收当前值和新传入值作为参数，并在函数中定义处理逻辑。以下是一个自定义Reducer的代码示例：该函数合并新值和旧值并返回去重后结果。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict, <span class="hljs-type">List</span>, Annotated
<span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> START, END, StateGraph

<span class="hljs-keyword">def</span> <span class="hljs-title function_">deduplicate_merge</span>(<span class="hljs-params">old_list: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], new_list: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
    <span class="hljs-string">"""自定义Reducer：合并列表并去重"""</span>
    combined = old_list + new_list
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(<span class="hljs-built_in">dict</span>.fromkeys(combined)) <span class="hljs-comment"># 保持顺序的去重</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyState</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    unique_items: Annotated[<span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], deduplicate_merge]


<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict, <span class="hljs-type">List</span>, Annotated

<span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    unique_items: Annotated[<span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], deduplicate_merge]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_a</span>(<span class="hljs-params">state: State</span>) -&gt; State:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Adding 'A' to <span class="hljs-subst">{state[<span class="hljs-string">'unique_items'</span>]}</span>"</span>)
    <span class="hljs-keyword">return</span> State(unique_items=[<span class="hljs-string">"A"</span>])

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_A_extra</span>(<span class="hljs-params">state: State</span>) -&gt; State:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Adding 'A' to <span class="hljs-subst">{state[<span class="hljs-string">'unique_items'</span>]}</span>"</span>)
    <span class="hljs-keyword">return</span> State(unique_items=[<span class="hljs-string">"A"</span>])

builder = StateGraph(State)

builder.add_node(<span class="hljs-string">"a"</span>, node_a)
builder.add_node(<span class="hljs-string">"a_extra"</span>, node_A_extra)

builder.add_edge(START, <span class="hljs-string">"a"</span>)
builder.add_edge(<span class="hljs-string">"a"</span>, <span class="hljs-string">"a_extra"</span>)
builder.add_edge(<span class="hljs-string">"a_extra"</span>, END)

graph = builder.<span class="hljs-built_in">compile</span>()

initial_state = State(
    unique_items = [<span class="hljs-string">'Initial String'</span>]
)

<span class="hljs-built_in">print</span>(graph.invoke(initial_state))
</code></pre>
<p>上面代码的图结构如下所示，按理说列表中应该有两个“A”，但是因为添加时会去重，所以最后列表中只有这一个“A”了。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55d0f61cfc114b3fafc6b8a14f75bfd8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=zWmGcW345lyqV9X%2Fw1f1jsuZYew%3D" alt="10.png" loading="lazy"/></p>
<p>最后的结果如下：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be248369b69d43e6b4ba37efd433cabf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=aMzyW7XxkdtSgTWE8Azbg%2Bu%2BrPo%3D" alt="9.png" loading="lazy"/></p>
<h3 data-id="heading-10">3.4 探索LangGraph边的并行与数据共享</h3>
<p>笔者接下来将构建下图所示的工作流，来帮助大家直观理解<strong>并行执行</strong>与<strong>全局状态共享</strong>。</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e8e9cdd7ab54f3f9e5cc927cd39f831~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=sQnGlRqZVO5SHdvIJXWcftDXb2A%3D" alt="7.png" width="30%" loading="lazy"/></p>
<ol>
<li>
<p>第一步同样的需要定义状态，不同的是这里的状态需要用reducer来指明列表的状态是累加而不是覆盖原来的值</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> operator
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict, <span class="hljs-type">List</span>, Annotated

<span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    nList: Annotated[<span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], operator.add]
</code></pre>
</li>
<li>
<p>下一步来定义节点函数，每个节点都接收状态，并返回对<code>nList</code>字段的更新</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">node_a</span>(<span class="hljs-params">state: State</span>) -&gt; State:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Adding 'A' to <span class="hljs-subst">{state[<span class="hljs-string">'nList'</span>]}</span>"</span>)
    <span class="hljs-keyword">return</span> State(nList=[<span class="hljs-string">"A"</span>])

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_b</span>(<span class="hljs-params">state: State</span>) -&gt; State:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Adding 'B' to <span class="hljs-subst">{state[<span class="hljs-string">'nList'</span>]}</span>"</span>)
    <span class="hljs-keyword">return</span> State(nList=[<span class="hljs-string">"B"</span>])

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_c</span>(<span class="hljs-params">state: State</span>) -&gt; State:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Adding 'C' to <span class="hljs-subst">{state[<span class="hljs-string">'nList'</span>]}</span>"</span>)
    <span class="hljs-keyword">return</span> State(nList=[<span class="hljs-string">"C"</span>])

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_bb</span>(<span class="hljs-params">state: State</span>) -&gt; State:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Adding 'BB' to <span class="hljs-subst">{state[<span class="hljs-string">'nList'</span>]}</span>"</span>)
    <span class="hljs-keyword">return</span> State(nList=[<span class="hljs-string">"BB"</span>])

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_cc</span>(<span class="hljs-params">state: State</span>) -&gt; State:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Adding 'CC' to <span class="hljs-subst">{state[<span class="hljs-string">'nList'</span>]}</span>"</span>)
    <span class="hljs-keyword">return</span> State(nList=[<span class="hljs-string">"CC"</span>])

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_d</span>(<span class="hljs-params">state: State</span>) -&gt; State:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Adding 'D' to <span class="hljs-subst">{state[<span class="hljs-string">'nList'</span>]}</span>"</span>)
    <span class="hljs-keyword">return</span> State(nList=[<span class="hljs-string">"D"</span>])
</code></pre>
</li>
<li>
<p>用状态实例化StateGraph，然后添加定义好的节点并按照参考图中的边将不同的节点连接起来，最后编译图。</p>
<pre><code class="hljs language-python" lang="python">builder = StateGraph(State)

builder.add_node(<span class="hljs-string">"a"</span>, node_a)
builder.add_node(<span class="hljs-string">"b"</span>, node_b)
builder.add_node(<span class="hljs-string">"c"</span>, node_c)
builder.add_node(<span class="hljs-string">"bb"</span>, node_bb)
builder.add_node(<span class="hljs-string">"cc"</span>, node_cc)
builder.add_node(<span class="hljs-string">"d"</span>, node_d)

builder.add_edge(START, <span class="hljs-string">"a"</span>)
builder.add_edge(<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>)
builder.add_edge(<span class="hljs-string">"a"</span>, <span class="hljs-string">"c"</span>)
builder.add_edge(<span class="hljs-string">"b"</span>, <span class="hljs-string">"bb"</span>)
builder.add_edge(<span class="hljs-string">"c"</span>, <span class="hljs-string">"cc"</span>)
builder.add_edge(<span class="hljs-string">"bb"</span>, <span class="hljs-string">"d"</span>)
builder.add_edge(<span class="hljs-string">"cc"</span>, <span class="hljs-string">"d"</span>)
builder.add_edge(<span class="hljs-string">"d"</span>, END)

graph = builder.<span class="hljs-built_in">compile</span>()
</code></pre>
</li>
<li>
<p>提供一个初始状态来调用图表，大家先来思考一下最后的运行结果。</p>
<pre><code class="hljs language-python" lang="python">initial_state = State(
    nList = [<span class="hljs-string">'Initial String'</span>]
)
<span class="hljs-built_in">print</span>(graph.invoke(initial_state))
</code></pre>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b5ad1efa57345f6b381d9fd5cf92a26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=Zal7Y9KoIqu84oP%2Byp8LvmsmQWk%3D" alt="8.png" loading="lazy"/></p>
<ul>
<li><strong>并行与合并</strong>：节点B和C在<strong>同一步骤</strong>中并行执行，它们都接收到了来自节点A更新后的状态 <code>[‘Initial‘， ‘A’]</code>。它们的更新（<code>”B”</code>和<code>”C”</code>）通过Reducer被<strong>追加</strong>到了<code>nList</code>中。</li>
<li><strong>全局状态共享</strong>：节点BB和CC运行时，它能“看到”的状态包含了其上游节点B的更新<code>(‘B’)</code>，<strong>也包含了并行分支节点C的更新`(‘C’)</strong> 。这是因为LangGraph的状态是<strong>全局共享</strong>的，边只控制执行顺序，不隔离数据。</li>
</ul>
<h3 data-id="heading-11">3.5 条件边</h3>
<p>对于条件边笔者这里直接通过代码讲解，使用条件边实现下图结构，下图中的虚线表示条件边，实线表示普通边。</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/396ac2fb7239477582ae0a3f598e62a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=fPoFcJocKNjIBKKh09eFUpoDg9M%3D" alt="11.png" loading="lazy"/></p>
<ol>
<li>
<p>定义状态</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> START, END, StateGraph
<span class="hljs-keyword">import</span> operator
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict, <span class="hljs-type">List</span>, Annotated

<span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    nList: Annotated[<span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], operator.add]
</code></pre>
</li>
<li>
<p>定义节点函数</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">node_a</span>(<span class="hljs-params">state: State</span>):
    <span class="hljs-keyword">return</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_b</span>(<span class="hljs-params">state: State</span>):
    <span class="hljs-keyword">return</span> State(nList=[<span class="hljs-string">'B'</span>])

<span class="hljs-keyword">def</span> <span class="hljs-title function_">node_c</span>(<span class="hljs-params">state: State</span>):
    <span class="hljs-keyword">return</span> State(nList=[<span class="hljs-string">'C'</span>])
</code></pre>
</li>
<li>
<p>定义图，首先添加实线普通边</p>
<pre><code class="hljs language-python" lang="python">builder = StateGraph(State)
builder.add_node(<span class="hljs-string">"a"</span>, node_a)
builder.add_node(<span class="hljs-string">"b"</span>, node_b)
builder.add_node(<span class="hljs-string">"c"</span>, node_c)

builder.add_edge(START, <span class="hljs-string">"a"</span>)
builder.add_edge(<span class="hljs-string">"b"</span>, END)
builder.add_edge(<span class="hljs-string">"c"</span>, END)

graph = builder.<span class="hljs-built_in">compile</span>()
</code></pre>
</li>
<li>
<p>学习条件边的定义方法，条件边需要定义条件路由函数，该函数接受状态并返回一个值，这个值代表想要分支到的下一节点。笔者下面定义的函数接收图最近一次写入的状态，然后返回一个值。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">conditional_edge</span>(<span class="hljs-params">state: State</span>) -&gt; <span class="hljs-type">Literal</span>[<span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>, END]:
    select = state[<span class="hljs-string">"nList"</span>][-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> select == <span class="hljs-string">"b"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'b'</span>
    <span class="hljs-keyword">elif</span> select == <span class="hljs-string">'c'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'c'</span>
    <span class="hljs-keyword">elif</span> select == <span class="hljs-string">'q'</span>:
        <span class="hljs-keyword">return</span> END
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> END
</code></pre>
</li>
<li>
<p>在构建图时使用添加条件边的语法来添加条件边，</p>
<pre><code class="hljs language-python" lang="python">builder.add_conditional_edges(<span class="hljs-string">"a"</span>, conditional_edge)
</code></pre>
</li>
<li>
<p>测试条件边的逻辑。下面代码笔者从用户那里获取输入作为初始输入状态，然后用该状态调用图表：</p>
<pre><code class="hljs language-python" lang="python">user = <span class="hljs-built_in">input</span>(<span class="hljs-string">'b, c or q to quit:'</span>)
input_state = State(
    nList=[user]
)
graph.invoke(input_state)
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5a522b1780540b5a2a0216a02b87aae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=cc7HCQBEQ7bxLussYDZbfyo98UE%3D" alt="12.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/515f5e55cc224ce981d4d46453c13d97~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=Asvl8DvKChgokXZDxKEdPbCDb9U%3D" alt="13.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28fd5481a2f542d9a0a1bbdcb2a5ff0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766621455&amp;x-signature=mXkmp6EZlDPSqozD%2FKmEWPjmo8M%3D" alt="14.png" loading="lazy"/></p>
</li>
</ol>
<p>可以看到当用户输入b, 会走到b节点，在b节点中添加字符串'B', 当用户输入c, 会走到c节点，在c节点中添加字符串‘C’，输入q 则会直接到结束节点，这就是条件边的控制逻辑。完整代码大家可以关注笔者的同名微信公众号 <strong>大模型真好玩</strong>，并私信: <strong>LangChain智能体开发</strong>免费获取。</p>
<p>以上就是今天的全部内容啦！内容篇幅较长，大家消化一下~</p>
<h2 data-id="heading-12">四、总结</h2>
<p>本期分享笔者为大家介绍了LangGraph 1.0，LangGraph1.0是构建智能体的编程语言。它通过<strong>状态（State）</strong> 管理数据，<strong>节点（Node）</strong> 作为处理函数，<strong>边（Edge）</strong> 定义串行、并行或条件执行逻辑。借助<strong>Reducer</strong>处理并行写入冲突，并支持<strong>人在回路</strong>控制。这使其成为搭建复杂、可编排AI工作流的强大底座。本期分享着重介绍了LangGraph的节点和边的定义，并用点和边构造了简单的图。然而LangGraph不仅仅有如上所示的图的定义方法，在下期分享笔者将为大家介绍更多点和边的构建方法，以及介绍记忆Memory和人在回路Human In the loop，大家敬请期待~</p>
<p><a href="https://juejin.cn/column/7526240014499495972" title="https://juejin.cn/column/7526240014499495972" target="_blank">《深入浅出LangChain&amp;LangGraph AI Agent 智能体开发》</a>专栏内容源自笔者在实际学习和工作中对 LangChain 与 LangGraph 的深度使用经验，旨在帮助大家系统性地、高效地掌握 AI Agent 的开发方法，在各大技术平台获得了不少关注与支持。目前已更新30讲，正在更新LangGraph1.0速通指南，并随时补充笔者在实际工作中总结的拓展知识点。如果大家感兴趣，欢迎关注笔者的掘金账号与专栏，也可关注笔者的同名微信公众号 <strong>大模型真好玩</strong>，每期分享涉及的代码均可在公众号私信: <strong>LangChain智能体开发</strong>免费获取。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3性能优化实战：这5个技巧让我的应用加载速度提升了40%]]></title>    <link>https://juejin.cn/post/7584689488770334755</link>    <guid>https://juejin.cn/post/7584689488770334755</guid>    <pubDate>2025-12-18T00:16:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584689488770334755" data-draft-id="7584711683772678144" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3性能优化实战：这5个技巧让我的应用加载速度提升了40%"/> <meta itemprop="keywords" content="后端,前端,人工智能"/> <meta itemprop="datePublished" content="2025-12-18T00:16:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="阿橙的百宝箱"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3性能优化实战：这5个技巧让我的应用加载速度提升了40%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    阿橙的百宝箱
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:16:54.000Z" title="Thu Dec 18 2025 00:16:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Vue3性能优化实战：这5个技巧让我的应用加载速度提升了40%</strong></h2>
<h2 data-id="heading-1">引言</h2>
<p>在现代前端开发中，性能优化是一个永恒的话题。随着Vue3的普及，其响应式系统、组合式API和编译时优化等特性为开发者提供了更多的性能提升空间。然而，即使是最先进的框架，如果不加以合理配置和优化，仍然可能导致应用加载缓慢、交互卡顿等问题。</p>
<p>本文将分享我在实际项目中通过5个关键技巧将Vue3应用的加载速度提升40%的实战经验。这些技巧涵盖了从代码分割到懒加载、从编译优化到运行时性能调优等多个方面，希望能为你的Vue3项目带来实质性的性能提升。</p>
<hr/>
<h2 data-id="heading-2">主体</h2>
<h3 data-id="heading-3">1. 代码分割与路由懒加载</h3>
<h4 data-id="heading-4">问题背景</h4>
<p>单页应用（SPA）的一个常见问题是首次加载时需要下载所有路由对应的代码包，导致首屏时间变长。尤其是在大型项目中，这个问题尤为明显。</p>
<h4 data-id="heading-5">解决方案</h4>
<p>Vue3结合Vue Router支持动态导入（Dynamic Import），可以将路由组件按需加载。以下是实现方式：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/dashboard'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./views/Dashboard.vue'</span>) <span class="hljs-comment">// 动态导入</span>
  },
  <span class="hljs-comment">// 其他路由...</span>
];
</code></pre>
<h4 data-id="heading-6">效果</h4>
<p>通过路由懒加载，我们可以将初始包体积减少50%以上（具体取决于项目规模），从而显著提升首屏加载速度。</p>
<hr/>
<h3 data-id="heading-7">2. Tree Shaking与按需引入依赖</h3>
<h4 data-id="heading-8">问题背景</h4>
<p>许多第三方库（如Element Plus、Lodash等）体积庞大，但实际项目中可能只用到了其中一小部分功能。如果不进行优化，这些未使用的代码会被打包到最终产物中。</p>
<h4 data-id="heading-9">解决方案</h4>
<ul>
<li><strong>使用ES模块版本</strong>：确保第三方库支持ES模块（例如<code>lodash-es</code>）。</li>
<li><strong>按需引入</strong>：对于UI库如Element Plus或Ant Design Vue，使用其提供的按需引入功能：</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElButton</span>, <span class="hljs-title class_">ElInput</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'element-plus'</span>;
</code></pre>
<ul>
<li><strong>配置构建工具</strong>：在Vite或Webpack中启用Tree Shaking：</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vite.config.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">rollupOptions</span>: {
      <span class="hljs-attr">treeshake</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// Vite默认启用</span>
    }
  }
};
</code></pre>
<h4 data-id="heading-10">效果</h4>
<p>在我的项目中，仅通过按需引入Element Plus组件就减少了约30%的打包体积。</p>
<hr/>
<h3 data-id="heading-11">3. Vue3编译时优化：静态节点提升与补丁标志</h3>
<h4 data-id="heading-12">Vue3的底层优化</h4>
<p>Vue3在编译阶段会对模板进行静态分析并生成更高效的渲染函数：</p>
<ol>
<li><strong>静态节点提升（Static Node Hoisting）</strong>：将静态DOM节点提升到渲染函数外部，避免重复创建。</li>
<li><strong>补丁标志（Patch Flags）</strong>：动态更新时只比对带有标记的节点，跳过静态内容。</li>
</ol>
<h4 data-id="heading-13">实战建议</h4>
<ul>
<li><strong>利用单文件组件（SFC）</strong>：Vue3对SFC的支持更完善，能更好地应用上述优化。</li>
<li><strong>避免过度使用动态绑定</strong>：减少不必要的<code>v-if</code>或<code>v-for</code>嵌套以降低运行时开销。</li>
</ul>
<hr/>
<h3 data-id="heading-14">4. Web Worker处理CPU密集型任务</h3>
<h4 data-id="heading-15">问题背景</h4>
<p>某些计算密集型任务（如大数据处理、复杂动画）会阻塞主线程，导致界面卡顿。</p>
<h4 data-id="heading-16">Vue3中的实现方案</h4>
<ol>
<li><strong>将任务移至Web Worker</strong>：例如处理大型数据集或加密运算时可以使用Worker。</li>
<li><strong>Composable封装</strong>：用组合式API封装Worker逻辑以实现复用：</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// useWorker.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useWorker</span>(<span class="hljs-params">workerScript</span>) {
  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(workerScript);

  worker.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    result.<span class="hljs-property">value</span> = e.<span class="hljs-property">data</span>;
  };

  <span class="hljs-keyword">return</span> { result };
}
</code></pre>
<p>####效果示例<br/>
在一个数据可视化的项目中，我将图表数据的预处理逻辑移至Web Worker后主线程FPS提升了20%。</p>
<hr/>
<p>###5 .缓存策略与服务端渲染(SSR)/静态站点生成(SSG)</p>
<p>#####为什么需要缓存？<br/>
频繁请求不变资源(如图片、JS/CSS文件)会拖慢页面速度 。</p>
<p>#####最佳实践<br/>
-<strong>长期缓存(Long-term Caching)</strong> :通过文件名哈希配置强缓存 :</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vite.config.js    </span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {       
   <span class="hljs-attr">build</span>: {         
     <span class="hljs-attr">rollupOptions</span>: {           
       <span class="hljs-attr">output</span>: {             
         <span class="hljs-attr">assetFileNames</span>: <span class="hljs-string">'[name].[hash].[ext]'</span>          
       }        
     }      
   }    
};   
</code></pre>
<p>-<strong>SSR/SSG选择</strong>:<br/>
1 .高动态内容→使用Nuxt.js实现服务端渲染 ;<br/>
2 .内容稳定→采用Vitepress或VitePress生成静态站点 。</p>
<p>######实测数据<br/>
启用HTTP/2 +长期缓存后 ，我的应用二次加载时间缩短了60% 。</p>
<hr/>
<p>##总结</p>
<p>性能优化是一个系统工程 ，需要从代码 、构建 、网络等多维度切入 。本文介绍的五个技巧——路由懒加载 、Tree Shaking 、编译时优化 、Web Worker和缓存策略 ——在实际项目中帮助我将Vue3应用的加载速度提升了40%。当然 ，每个项目的技术栈和业务场景不同 ，建议根据具体情况选择合适的方案并进行量化测试 。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python的条件编译-Type_Checking]]></title>    <link>https://juejin.cn/post/7584987267266314250</link>    <guid>https://juejin.cn/post/7584987267266314250</guid>    <pubDate>2025-12-18T00:24:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584987267266314250" data-draft-id="7584742635500929051" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python的条件编译-Type_Checking"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-12-18T00:24:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="自由生长2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python的条件编译-Type_Checking
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    自由生长2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:24:28.000Z" title="Thu Dec 18 2025 00:24:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>TYPE_CHECKING</code> 是 Python 标准库 <code>typing</code> 模块中的一个常量，其本质是一个<strong>布尔值（bool）</strong>，在运行时始终为 <code>False</code>，但在<strong>类型检查工具（如 mypy、PyCharm、VSCode 等）分析代码时会被视为 <code>True</code></strong>。</p>
<hr/>
<h3 data-id="heading-0">一、设计目的</h3>
<p><code>TYPE_CHECKING</code> 的主要目的是：</p>
<blockquote>
<p><strong>解决类型注解中的“循环导入”（circular import）问题，同时避免在运行时引入不必要的模块依赖。</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-1">二、工作原理</h3>
<ul>
<li>
<p>在<strong>程序实际运行时</strong>：<br/>
<code>TYPE_CHECKING</code> 的值是 <code>False</code>，因此 <code>if TYPE_CHECKING:</code> 块内的代码<strong>不会被执行</strong>，也不会被导入。</p>
</li>
<li>
<p>在<strong>静态类型检查时</strong>（例如使用 mypy）：<br/>
类型检查器会<strong>假装 <code>TYPE_CHECKING</code> 是 <code>True</code></strong>，从而分析 <code>if TYPE_CHECKING:</code> 块中的类型注解，用于类型推断和检查。</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-2">三、典型使用场景</h3>
<h4 data-id="heading-3">场景1：避免循环导入</h4>
<p>假设有两个模块互相引用：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># file: user.py</span>
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TYPE_CHECKING
<span class="hljs-keyword">if</span> TYPE_CHECKING:
    <span class="hljs-keyword">from</span> .order <span class="hljs-keyword">import</span> Order  <span class="hljs-comment"># 只在类型检查时导入</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_orders</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-string">'Order'</span>]:
        ...
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># file: order.py</span>
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TYPE_CHECKING
<span class="hljs-keyword">if</span> TYPE_CHECKING:
    <span class="hljs-keyword">from</span> .user <span class="hljs-keyword">import</span> User

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-string">'User'</span>:
        ...
</code></pre>
<p>如果不使用 <code>TYPE_CHECKING</code>，直接在模块顶层 <code>import</code> 对方，就会造成循环导入错误。而用 <code>TYPE_CHECKING</code> 包裹后，运行时不会真正导入，但类型检查器仍能理解 <code>Order</code> 和 <code>User</code> 的类型。</p>
<h4 data-id="heading-4">场景2：减少运行时开销</h4>
<p>有些类型注解需要导入大型模块（如 <code>pandas.DataFrame</code>），但这些类型只用于注解，不需要在运行时加载：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TYPE_CHECKING

<span class="hljs-keyword">if</span> TYPE_CHECKING:
    <span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-keyword">def</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">data: <span class="hljs-string">'pd.DataFrame'</span></span>) -&gt; <span class="hljs-literal">None</span>:
    ...
</code></pre>
<p>这样可以避免在运行时加载 <code>pandas</code>（如果函数体中并不真正使用 <code>pd</code>），提升启动速度或减少内存占用。</p>
<hr/>
<h3 data-id="heading-5">四、技术本质总结</h3>





























<table><thead><tr><th>属性</th><th>说明</th></tr></thead><tbody><tr><td>类型</td><td><code>bool</code></td></tr><tr><td>运行时值</td><td><code>False</code></td></tr><tr><td>类型检查时值</td><td>被视为 <code>True</code></td></tr><tr><td>所属模块</td><td><code>typing.TYPE_CHECKING</code>（Python 3.5.2+ 引入）</td></tr><tr><td>用途</td><td>条件性地仅在类型检查期间包含代码</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-6">五、补充说明</h3>
<ul>
<li>从 Python 3.7 开始，配合 <code>from __future__ import annotations</code>（PEP 563），<strong>所有注解默认以字符串形式延迟求值</strong>，进一步减少了对 <code>TYPE_CHECKING</code> 的依赖，但 <code>TYPE_CHECKING</code> 仍然在需要<strong>前向引用之外的类型导入</strong>时非常有用。</li>
<li>即使使用了 <code>from __future__ import annotations</code>，如果你在类型注解中需要使用<strong>其他模块中定义的类名</strong>（而非字符串），仍可能需要 <code>TYPE_CHECKING</code> 来安全导入。</li>
</ul>
<hr/>
<h3 data-id="heading-7">六、示例对比</h3>
<p>✅ 正确用法：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TYPE_CHECKING

<span class="hljs-keyword">if</span> TYPE_CHECKING:
    <span class="hljs-keyword">from</span> heavy_module <span class="hljs-keyword">import</span> BigClass

<span class="hljs-keyword">def</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">x: <span class="hljs-string">'BigClass'</span></span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>❌ 错误用法（可能导致循环导入或运行时开销）：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> heavy_module <span class="hljs-keyword">import</span> BigClass  <span class="hljs-comment"># 运行时就导入！</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">x: BigClass</span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-keyword">pass</span>
</code></pre>
<hr/>
<h3 data-id="heading-8">总结</h3>
<p><code>TYPE_CHECKING</code> 的本质是一个<strong>运行时恒为 False、类型检查时视为 True 的布尔标志</strong>，用于<strong>条件性地仅在类型检查阶段引入类型信息</strong>，从而优雅地解决循环导入和性能问题，是 Python 类型系统中一个非常实用的“编译期/分析期”技巧。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Next.js第十四章(缓存策略)]]></title>    <link>https://juejin.cn/post/7584651851905712147</link>    <guid>https://juejin.cn/post/7584651851905712147</guid>    <pubDate>2025-12-18T00:30:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584651851905712147" data-draft-id="7584659460247224339" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Next.js第十四章(缓存策略)"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-12-18T00:30:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="小满zs"/> <meta itemprop="url" content="https://juejin.cn/user/2463384809252397"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Next.js第十四章(缓存策略)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2463384809252397/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    小满zs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:30:42.000Z" title="Thu Dec 18 2025 00:30:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">缓存策略(Cache Strategies)</h2>
<blockquote>
<p>友情提示：光敏性癫痫患者请勿观看！！！</p>
</blockquote>
<p>缓存策略分两种：</p>
<h4 data-id="heading-1">未启用缓存组件:</h4>
<p>确保<code>cacheComponents</code>配置为<code>false</code>或者不配置。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">NextConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">nextConfig</span>: <span class="hljs-title class_">NextConfig</span> = {
  <span class="hljs-comment">/* config options here */</span>
  <span class="hljs-attr">cacheComponents</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 缓存组件(关闭或者不配置)</span>
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig;
</code></pre>
<p>src/app/home/page.tsx(新建一个页面)</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> randomImage = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://www.dmoe.cc/random.php?return=json'</span>) <span class="hljs-comment">//这个接口随机返回一个二刺猿图片</span>
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> randomImage.<span class="hljs-title function_">json</span>()
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{data.imgurl}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"random image"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd7740981bfd4c4195cbed9d5969f1b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622642&amp;x-signature=X4cl%2FaUFEM9wUzOyY5t7sYjuQP4%3D" alt="9.gif" loading="lazy"/></p>
<p>我们可以看到上图在开发模式是没有任何问题的，每次刷新图片都会重新获取。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/325f85e5f2b24c448e0318f5ef27ef74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622642&amp;x-signature=TwJ6rGuYChJfooZjCMk5rz9url8%3D" alt="10.gif" loading="lazy"/></p>
<p>但是当我们进行构建之后<code>npm run build &amp;&amp; npm run start</code>我们发现每次刷新图片都不会变化，始终是同一个图片。</p>
<p>原因是：Next.js会尽可能多的进行缓存，以提高性能降低成本，这意味着路由会被静态渲染，以及数据请求也会被缓存，除非禁用缓存。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7021a1ea242c4d6894f4547685b4b348~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622642&amp;x-signature=kg25Oem%2BCTsnYOFHBMxiHbpZzBI%3D" alt="image.png" loading="lazy"/></p>
<p>我们观察上图可以发现有两个符号：</p>
<ul>
<li><code>○</code>(空心圆): 表示这是预渲染的静态内容。</li>
<li><code>ƒ</code>(f函数符): 表示这是动态内容。</li>
</ul>
<h4 data-id="heading-2">那么如何退出缓存呢?</h4>
<h5 data-id="heading-3">第一种方案重新验证</h5>
<p>使用<code>revalidate</code>属性，可以设置缓存时间，单位为秒。</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> revalidate = <span class="hljs-number">5</span> <span class="hljs-comment">// 5秒后重新更新</span>
<span class="hljs-comment">//export const revalidate = 0 // 设置为0表示不缓存</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> randomImage = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://www.dmoe.cc/random.php?return=json'</span>)
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> randomImage.<span class="hljs-title function_">json</span>()
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{data.imgurl}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"random image"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16218a9968414d3faba6fcb1abb5c7b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622642&amp;x-signature=W%2Bn8B5R4HlmQEAcGNxqmfyV69go%3D" alt="image.png" loading="lazy"/></p>
<p>当我们重新运行之后，每过5秒，图片会重新获取，并且会显示新的图片。</p>
<h5 data-id="heading-4">第二种方案使用dynamic属性</h5>
<p>使用<code>dynamic</code>属性，并且设置为<code>force-dynamic</code>，表示将禁用缓存，每次请求都会重新获取数据。</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> dynamic = <span class="hljs-string">'force-dynamic'</span> <span class="hljs-comment">// 动态更新 缓存组件不需要使用这个 默认都是动态内容</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> randomImage = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://www.dmoe.cc/random.php?return=json'</span>)
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> randomImage.<span class="hljs-title function_">json</span>()
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{data.imgurl}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"random image"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/394e6f10671e4c0981fd4237c07b19ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622642&amp;x-signature=3kJkaaxsy0g4aFASv0gswvYpBQI%3D" alt="image.png" loading="lazy"/></p>
<h5 data-id="heading-5">第三种方案使用禁用缓存</h5>
<p>使用<code>cache</code>属性，并且设置为<code>no-store</code>，表示将禁用缓存，每次请求都会重新获取数据。</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> randomImage = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://www.dmoe.cc/random.php?return=json'</span>,{<span class="hljs-attr">cache</span>:<span class="hljs-string">'no-store'</span>})
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> randomImage.<span class="hljs-title function_">json</span>()
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{data.imgurl}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"random image"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<h5 data-id="heading-6">第四种方案使用任意动态内容API</h5>
<p>当你使用以下任意API时，该路由会被视为动态内容，不会被缓存。</p>
<ul>
<li>cookies</li>
<li>headers</li>
<li>connection</li>
<li>searchParams</li>
<li>fetch和{ cache: 'no-store' }</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { connection } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/server"</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">connection</span>()
    <span class="hljs-keyword">const</span> randomImage = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://www.dmoe.cc/random.php?return=json'</span>)
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> randomImage.<span class="hljs-title function_">json</span>()
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{data.imgurl}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"random image"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<h4 data-id="heading-7">启用缓存组件:</h4>
<p>确保<code>cacheComponents</code>配置为<code>true</code>。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">NextConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">nextConfig</span>: <span class="hljs-title class_">NextConfig</span> = {
  <span class="hljs-comment">/* config options here */</span>
  <span class="hljs-attr">cacheComponents</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//开启缓存组件</span>
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig;
</code></pre>
<blockquote>
<p>启用缓存组件之后，所有组件默认为<code>动态内容</code>，因此<code>export const dynamic = 'force-dynamic'</code>不需要配置。</p>
</blockquote>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">DynamicImage</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> randomImage = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://www.dmoe.cc/random.php?return=json'</span>)
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> randomImage.<span class="hljs-title function_">json</span>()
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{500}</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{data.imgurl}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"random image"</span> /&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">DynamicImage</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4a284ed5a7e449d97c42f63ca151412~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622642&amp;x-signature=zH%2F83nsVhxSeSj3nA%2FCY0z9ydVM%3D" alt="image.png" loading="lazy"/></p>
<p>然后你会发现多了一个符号</p>
<ul>
<li><code>◐</code>(部分预渲染): 表示页面预渲染为静态 HTML，同时包含动态服务器流式传输的内容。</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python的私有方法技巧-双下划线开头]]></title>    <link>https://juejin.cn/post/7584655946087710766</link>    <guid>https://juejin.cn/post/7584655946087710766</guid>    <pubDate>2025-12-18T00:34:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584655946087710766" data-draft-id="7584655946087694382" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python的私有方法技巧-双下划线开头"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-12-18T00:34:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="自由生长2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python的私有方法技巧-双下划线开头
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    自由生长2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:34:22.000Z" title="Thu Dec 18 2025 00:34:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在 Python 中，以<strong>两个下划线开头</strong>（如 <code>__method</code>）的方法或属性，并不完全是“私有方法”（private method）——因为 Python 并没有像 Java 或 C++ 那样严格的访问控制机制。但这种命名方式会触发一种叫做 <strong>名称改写</strong>（name mangling）的机制，从而在一定程度上实现“私有性”。</p>
<h3 data-id="heading-0">1. 名称改写（Name Mangling）</h3>
<p>当你在一个类中定义一个以双下划线开头、且不以双下划线结尾的方法或属性时，Python 解释器会自动将其名称改写为：</p>
<pre><code class="hljs">_ClassName__original_name
</code></pre>
<p>例如：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.__private_var = <span class="hljs-number">42</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__private_method</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-string">"This is private"</span>

obj = MyClass()
<span class="hljs-comment"># obj.__private_method()  # AttributeError!</span>
<span class="hljs-built_in">print</span>(obj._MyClass__private_method())  <span class="hljs-comment"># 可以访问，但不推荐</span>
</code></pre>
<p>虽然你仍然可以通过 <code>_ClassName__name</code> 的方式访问到这个“私有”成员，但这是一种<strong>约定+语言机制</strong>，目的是防止子类意外覆盖父类的内部方法，也提示开发者“这是内部使用的，不要直接调用”。</p>
<hr/>
<h3 data-id="heading-1">2. 与单下划线的区别</h3>
<ul>
<li><strong>单下划线开头</strong>（如 <code>_method</code>）：只是<strong>约定</strong>表示“内部使用”，不会触发名称改写，外部仍可访问。</li>
<li><strong>双下划线开头</strong>（如 <code>__method</code>）：触发名称改写，提供更强的封装暗示。</li>
</ul>
<hr/>
<h3 data-id="heading-2">3. 特殊方法（魔术方法）例外</h3>
<p>注意：如果方法名<strong>前后都有两个下划线</strong>（如 <code>__init__</code>, <code>__str__</code>），这是 Python 的<strong>特殊方法</strong>（也叫魔术方法），<strong>不会</strong>被名称改写，也不表示私有，而是用于实现特定语言特性。</p>
<hr/>
<h3 data-id="heading-3">总结</h3>
<ul>
<li>Python 没有真正的“私有方法”。</li>
<li><code>__method</code> 会被名称改写，起到<strong>模拟私有</strong>的作用。</li>
<li>仍可通过 <code>_ClassName__method</code> 访问，但应避免这样做。</li>
<li>这是一种<strong>约定 + 语言机制</strong>，用于封装和避免命名冲突。</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TRAE 内 GPT-5.2 实测：10 轮对话，生成的代码一次都没让我撤回]]></title>    <link>https://juejin.cn/post/7584651851905728531</link>    <guid>https://juejin.cn/post/7584651851905728531</guid>    <pubDate>2025-12-18T00:39:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584651851905728531" data-draft-id="7584650421125218345" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TRAE 内 GPT-5.2 实测：10 轮对话，生成的代码一次都没让我撤回"/> <meta itemprop="keywords" content="Trae,GPT,人工智能"/> <meta itemprop="datePublished" content="2025-12-18T00:39:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="飞哥数智谈"/> <meta itemprop="url" content="https://juejin.cn/user/3825956195409223"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TRAE 内 GPT-5.2 实测：10 轮对话，生成的代码一次都没让我撤回
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3825956195409223/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    飞哥数智谈
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:39:14.000Z" title="Thu Dec 18 2025 00:39:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>本来今天计划研究下 <code>Cursor</code> 的 <code>Debug Mode</code> 的。</p>
<p>但计划赶不上变化，下午原定的项目开发有点超出预期的顺利，就想着一鼓作气把明天相关的任务一起做完得了。</p>
<p>下午的使用的 <code>TRAE 国际版</code> + <code>GPT-5.2</code>，<strong>没错，TRAE 已经上了 GPT-5.2</strong>。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0dc253b1c2e4d3ab6af4f9bb78ada5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623154&amp;x-signature=JxZjJxQrUi%2Bp5dNS%2FQOXmw2vSik%3D" alt="" loading="lazy"/></p>
<p>更新速度上，使用 <code>TRAE</code> 的同学们应该深有体会，2、3天更新一次都是非常常见的。</p>
<p>项目具体内容就不细说了，整体是一个 <code>Vue3</code> + <code>Element Plus</code> + <code>Python Flask</code> + <code>MySQL</code> 的内部工程，代码逻辑上是前后端分离的，其中需要调用第三方终端命令。</p>
<p>期间我一共花了<strong>4个小时</strong>，完成了<strong>3个模块</strong>，<strong>2个大功能</strong>，顺便还在团队内简单分享了 <code>GPT-5.2</code> 的使用体验。</p>
<p>对话大概有 10 轮，包含：</p>
<ul>
<li>初版两个关联模块的一次性生成</li>
<li>新增字段的前后端代码更新</li>
<li>根据第三方文档实现外部终端命令调用</li>
<li>自然语言实现 UI 上的细小调整</li>
</ul>
<p>上述对话指令的场景倒是常见，但是下午实际使用过程中，<strong>没有一次生成结果需要撤回</strong>，这个就很恐怖了。</p>
<p>直追 <code>Claude 4</code> 还能用的时候，甚至在指令遵循上，感觉比 <code>Claude 4</code> 还要听话一些。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89734d4b734a4f90917af29bd6be85e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623154&amp;x-signature=Hj5cKeug0fw71qyNdmIOyFAjDBo%3D" alt="直观使用感受上，这张图还是比较靠谱的" loading="lazy"/></p>
<p>对于这种非常规项目，由于涉及到手写部分代码，我一般会使用 <code>Cursor</code>，今天为什么没有使用呢？</p>
<p>因为我的 <code>Pro</code> 订阅已经超了，这个订阅周期才刚过了一半啊。我查看了用量明细，<code>Claude 4.5</code> 真的废 <code>Token</code>，大家如果也有使用的，一定要注意。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e7f7af9ec3e4303ae7808f8847f0563~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623154&amp;x-signature=rtLmpTVxXAS0NvbKkNP4PGHVGO8%3D" alt="一个token消耗的直观对比" loading="lazy"/></p>
<p>虽然，外界对 <code>GPT-5.2</code> 的评价褒贬不一，但我感觉在编程场景中，表现真的很棒，非常值得大家亲自试试。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[代理式人工智能：让大模型从“被动回答”走向“主动执行”]]></title>    <link>https://juejin.cn/post/7584730308752015410</link>    <guid>https://juejin.cn/post/7584730308752015410</guid>    <pubDate>2025-12-18T00:34:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584730308752015410" data-draft-id="7584714813365633062" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="代理式人工智能：让大模型从“被动回答”走向“主动执行”"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2025-12-18T00:34:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="掘金安东尼"/> <meta itemprop="url" content="https://juejin.cn/user/1521379823340792"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            代理式人工智能：让大模型从“被动回答”走向“主动执行”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379823340792/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    掘金安东尼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:34:17.000Z" title="Thu Dec 18 2025 00:34:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>一、从生成式 AI 到代理式 AI：智能的进化方向</strong>**</p>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>过去几年，生成式 AI 带来了惊人的内容生产能力——它能写代码、能回答问题、能生成图片，但它依然是“被动的”。</p>
<p>无论是 ChatGPT、Claude 还是 Gemini，当你输入一个指令，它就执行一个响应；但一旦上下文结束，它就像“断电”的机器人，失去了延续性与目标意识。</p>
<p>直到 2024 年底，<strong>代理式人工智能（Agentic AI）</strong> 的概念爆发。<br/>
无论是 Anthropic 推出的 MCP（Model Context Protocol），还是 <strong>亚马逊云（Amazon Cloud）</strong> 的 <strong>Amazon Bedrock AgentCore</strong>，行业都在朝着同一个方向前进：<br/>
让 AI 从“对话助手”升级为“主动代理人”，能感知环境、规划任务、调用工具、执行行动，并在过程中自我反思与优化。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51654f2ccf814b189a0ec0d01bf96b2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR5a6J5Lic5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622857&amp;x-signature=JwDupbMulv6W8rAOnEJXA7GhCI4%3D" alt="" loading="lazy"/></p>
<p>换句话说，<strong>AI 不再是一个回答者，而是一个执行者。</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fcn%2Ffree%3Ftrk%3D9469125f-7396-4b5a-8ec9-2c71ac1c7f30%26sc_channel%3Dsm" target="_blank" title="https://aws.amazon.com/cn/free?trk=9469125f-7396-4b5a-8ec9-2c71ac1c7f30&amp;sc_channel=sm" ref="nofollow noopener noreferrer"><strong>【传送门】</strong></a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af9b2af6de8a44f2a73cc48ccabadd96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR5a6J5Lic5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622857&amp;x-signature=3%2F%2Feyh%2Bj8ju5%2BA4p9dECK%2FT0Mzs%3D" alt="" loading="lazy"/></p>






<table><thead><tr><th>图示说明：智能体从“被动回答”到“主动执行”的演化，正是 AI 能力从静态到动态的跃迁。</th></tr></thead></table>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>二、代理式 AI 的核心原理：感知、思考、行动、反思</strong></p>
<p>如果说生成式 AI 是“被动问答”，那么代理式 AI 的本质，就是让模型能主动完成完整的任务闭环。</p>
<p>它遵循一个经典的循环逻辑：</p>






<table><thead><tr><th><strong>感知（Perceive） → 思考（Reason） → 行动（Act） → 反思（Reflect）</strong></th></tr></thead></table>
<p><strong>感知</strong>：代理从外部系统、数据库或互联网中收集信息；</p>
<p><strong>思考</strong>：代理根据目标和上下文生成行动计划；</p>
<p><strong>行动</strong>：调用工具或执行代码以实现任务目标；</p>
<p><strong>反思</strong>：检查执行结果，修正错误或优化下一步策略。</p>
<p>这套循环机制，使得 AI 拥有了类似“元认知”的自我调节能力。它不再局限于“对话完成度”，而是可以在复杂环境下持续学习与调整。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edba89244a4249c38bbf159d6154fbd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR5a6J5Lic5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622857&amp;x-signature=cKM6UYgNicwAAF3DQw0V10S5Asw%3D" alt="" loading="lazy"/></p>






<table><thead><tr><th>图示说明：代理通过持续循环实现自我校正，形成“智能反馈环”。</th></tr></thead></table>
<p><strong>Amazon Bedrock AgentCore</strong> 正是这套架构的工程化落地方案。<br/>
它提供了完整的代理基础设施：<strong>运行时、内存、身份管理、网关、可观测性和工具集成</strong>，允许开发者用任意模型、安全地部署多代理系统。</p>
<p>如果把生成式 AI 比作“大脑”，那代理式 AI 就是<strong>大脑 + 神经系统 + 肢体动作</strong>。<br/>
它能思考，也能动，还能与其他代理协作完成复杂目标。</p>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>三、在亚马逊云上构建你的第一个代理</strong></p>
<p>为了更直观地理解，我们来演示一个简单的代理示例：</p>
<p>让一个 AI 自动生成销售报告。</p>
<p>初始化环境</p>
<p>在 <strong>Amazon Bedrock 控制台</strong>中启用 <strong>AgentCore</strong>，并配置访问 Amazon Q、S3 与 DynamoDB。</p>
<p>定义代理与工具</p>






<table><thead><tr><th>Python from bedrock_agentcore import Agent, Tool, Memory  # 定义可调用工具 s3_tool = Tool("S3Reader", action="read_sales_data") report_tool = Tool("ReportWriter", action="generate_summary")  # 创建代理实例 sales_agent = Agent( name="SalesReporter", memory=Memory(), tools=[s3_tool, report_tool] )</th></tr></thead></table>
<p>设定任务与执行</p>






<table><thead><tr><th>Python goal = "生成上周销售汇总报告" sales_agent.plan(goal) sales_agent.act()</th></tr></thead></table>
<p>输出结果（可视化执行计划）</p>






<table><thead><tr><th>Bash 代理计划： 1. 从 S3 获取销售数据 2. 汇总结果并生成报表 3. 输出至 Dashboard</th></tr></thead></table>
<p>短短几行代码，AI 就能主动完成一个完整流程。</p>
<p>这就是“代理式”的关键差异——它具备执行链条，而不仅仅是文字生成。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21debced366441b7886ebb1e469ff540~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR5a6J5Lic5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766622857&amp;x-signature=f%2BAN1PsKbxIIzGzEinbSnSJtKLU%3D" alt="" loading="lazy"/></p>






<table><thead><tr><th>图示说明：代理通过工具调用与结果反馈形成闭环，构成完整的执行路径。</th></tr></thead></table>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>四、企业级应用的价值与趋势</strong></p>
<p>代理式人工智能并不是噱头，而是企业智能化的下一个阶段。</p>
<p>它带来的核心价值，在于**“自动决策 + 自动执行”**的融合。</p>
<p>在亚马逊云的生态中，这种趋势已经落地到多个行业：</p>
<p>🌾 <strong>Syngenta</strong> 通过多代理协作分析农业数据，帮助农户提升产量。</p>
<p>🧾 <strong>汤森路透</strong> 使用 .NET 自动化代理，将系统迁移速度提升 4 倍，成本下降 30%。</p>
<p>💰 <strong>Rocket Companies</strong> 借助智能代理让贷款结算率提升三倍。</p>
<p>可以预见的是，未来企业中将不再只有“一个 AI 助手”，而是<strong>一组具备分工协作能力的智能代理团队</strong>：<br/>
一个负责监控指标，一个负责汇报数据，一个负责编写代码，它们之间通过标准化协议（如 MCP）互联互通。</p>
<p>这就是智能体生态的雏形，也是“企业自动化 2.0”的方向。</p>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>五、未来的想象：从工具到伙伴</strong></p>
<p>当 AI 能理解任务、规划路径、执行操作、并从错误中学习，它就不再是工具，而是<strong>合作者</strong>。代理式 AI 的出现，正是在重新定义“智能”的边界。</p>
<p>亚马逊云在这场变革中扮演的角色，不仅是提供算力和模型，更是<strong>构建智能基础设施</strong>。未来，我们将看到更多代理以模块化方式存在：它们可能运行在本地，也可能跨云协作；它们会与人共事，也会与 AI 协同；它们将成为企业生产力系统中的“新员工”。</p>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>🔗 延伸阅读</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fcn%2Fbedrock%2Fagentcore" target="_blank" title="https://aws.amazon.com/cn/bedrock/agentcore" ref="nofollow noopener noreferrer">Amazon Bedrock AgentCore 简介</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2F" target="_blank" title="https://modelcontextprotocol.io/" ref="nofollow noopener noreferrer">代理互操作性的开放协议：MCP</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fblogs%2F" target="_blank" title="https://aws.amazon.com/blogs/" ref="nofollow noopener noreferrer">自主代理的兴起：企业领导者需要了解的新浪潮</a></p>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>🧭 总结与思考</strong></p>
<p>代理式人工智能并不是一个短暂的风口，而是智能系统真正“长出手脚”的关键一步。它让模型不仅能“说”，还能“做”；不仅能“生成”，还能“决策”。从亚马逊云 AgentCore 到 MCP 协议，我们正进入一个 <strong>多代理协作、跨系统执行的 AI 时代</strong>。</p>






<table><thead><tr><th>真正的智能，不是回答，而是行动。当大模型学会执行，AI 才算真正“觉醒”。</th></tr></thead></table>
<p>以上就是本文的全部内容啦。最后提醒一下各位工友，如果后续不再使用相关服务，别忘了在控制台关闭，避免超出免费额度产生费用～</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[一万四千字重温 Android 四大组件]]></title>    <link>https://juejin.cn/post/7584689488770465827</link>    <guid>https://juejin.cn/post/7584689488770465827</guid>    <pubDate>2025-12-18T00:48:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584689488770465827" data-draft-id="7577690150093946920" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="一万四千字重温 Android 四大组件"/> <meta itemprop="keywords" content="Android,Kotlin"/> <meta itemprop="datePublished" content="2025-12-18T00:48:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            一万四千字重温 Android 四大组件
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:48:07.000Z" title="Thu Dec 18 2025 00:48:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读37分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;color:#282d36}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px;color:#2f845e}.markdown-body h2{font-size:22px;display:inline-block;font-weight:700;background:#2f845e;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(47,132,194,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 32px);border-bottom:3px solid #2f845e}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%;box-shadow:6px 6px 6px #888}.markdown-body hr{border:none;border-top:1px solid rgba(66,185,131,.15);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:16px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#262626;border:1px solid #2f845e;border-top:8px solid #2f845e;background:linear-gradient(180deg,rgba(66,185,131,.1),transparent)!important}.markdown-body pre&gt;code.hljs[lang]:before{top:8px!important;color:#2f845e!important}.markdown-body pre&gt;code.language-awesome_error{border:1px solid #ff4d4f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ff4d4f!important;background:#fff2f0!important}.markdown-body pre&gt;code.language-awesome_error:before{content:"!"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ff4d4f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_warn{border:1px solid #ffc46f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ffc46f!important;background:#fffbe6!important}.markdown-body pre&gt;code.language-awesome_warn:before{content:"☂"!important;position:absolute;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ffc46f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_success{border:1px solid #52c41a!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#52c41a!important;background:#f6ffed!important}.markdown-body pre&gt;code.language-awesome_success:before{content:"✓"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#52c41a!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_info{border:1px solid #1890ff!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#1890ff!important;background:#e6f7ff!important}.markdown-body pre&gt;code.language-awesome_info:before{content:"i"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#1890ff!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body strong{background-color:inherit;color:#2f845e}.markdown-body em{background-color:inherit;color:#949415}.markdown-body a{text-decoration:none;color:#2f8e54;border-bottom:1px solid #3f9e64}.markdown-body a:active,.markdown-body a:hover{color:#3f9e64}.markdown-body a[class^=footnote]{margin-left:4px}.markdown-body a:before{content:"➤ "}.markdown-body table{font-size:12px;width:100%;max-width:100%;overflow:auto;border:2px solid #2f8e54}.markdown-body thead{background:#2f8e54;color:#fff;text-align:left;font-weight:700}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:22px}.markdown-body td{min-width:120px}.markdown-body blockquote{padding:1px 22px;margin:22px 0;border-left:6px solid #2f845e;background-color:rgba(66,185,131,.1);border-radius:2px}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#2f845e}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px;color:#282d36}.markdown-body del{color:#2f845e}.markdown-body input[type=checkbox]:checked:before{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/klEQVQ4T72TMU7DQBBF318XdFR06egQEnAXRINEGlqgowoIR8AF4AZOZ4JEGq5AC5EixBU4A55BNrEVHAcSBTHlaubt37/zxZKlcn7n6mDPXJvz8IJ89HzWu8t7C8D2dfsY52ae4apHnLx0ktsCsHXZjiUuFgG40x2eJ/H/AhztB+zDUTpLwWj8jGkzxSHiHaMPrDQC8sMoilKzLAUqiKQjmb+ZuAdW80tmelCHODoNgSfP7AFprTTaRTzsJN1GEyuIZ7uW6TEEHwCtyV/6EVBKJHhfzgC0Xv/iXwEFBF4FG0378bd7sPQq5xK/hSnk6sdlX3mZrKkwLZKBeu8n9XuWEUE7X+YAAAAASUVORK5CYII=);position:relative;top:-1px;left:-1px}.markdown-body .math .katex{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}@media (max-width:720px){.markdown-body h1{font-size:22px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="xcode">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.xml .hljs-meta{color:silver}.hljs-comment,.hljs-quote{color:#007400}.hljs-attribute,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#aa0d91}.hljs-template-variable,.hljs-variable{color:#3f6e74}.hljs-code,.hljs-meta-string,.hljs-string{color:#c41a16}.hljs-link,.hljs-regexp{color:#0e0eff}.hljs-bullet,.hljs-number,.hljs-symbol,.hljs-title{color:#1c00cf}.hljs-meta,.hljs-section{color:#643820}.hljs-built_in,.hljs-builtin-name,.hljs-class .hljs-title,.hljs-params,.hljs-type{color:#5c2699}.hljs-attr{color:#836c28}.hljs-subst{color:#000}.hljs-formula{background-color:#eee;font-style:italic}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-selector-class,.hljs-selector-id{color:#9b703f}.hljs-doctag,.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}</style><p><em>本系列为小说《逆袭西二旗》的技术讲解，用于详细说明<a href="https://juejin.cn/post/7583891046206799924" target="_blank" title="https://juejin.cn/post/7583891046206799924">剧情</a>里涉及的开发细节。</em></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfc6d9e032fe44caa2ab7184df795655~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=W72Vk18upBtmPkzVqEEpqtpBmw8%3D" alt="0.png" loading="lazy"/></p>
<p>我相信各位开发者对于 Android 四大组件熟悉的不能再熟悉了。但正因如此，我们往往容易忽略它们背后的设计初衷、生命周期细节以及在现代架构中的最佳实践。</p>
<p>现在，来一次深入的回顾，不仅能帮我们避开隐藏的坑点，更能重新理解 Android 系统的运行逻辑，让代码更健壮、架构更清晰。</p>
<h2 data-id="heading-0">什么是 Application</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bdf20e0f2ab40829d20d8f123f58ac3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=%2BzBFgsxwZrsPQEhs3M0shfT1iFc%3D" alt="4.png" loading="lazy"/></p>
<p>在 Android 中，<code>Application</code> 类是用于维护应用全局状态和生命周期的基类。它充当整个应用的入口点，在任何其他组件（如 <code>Activity</code>、<code>Service</code> 或 <code>BroadcastReceiver</code>）初始化之前就被创建。<code>Application</code> 类提供了一个贯穿整个应用生命周期的 <code>Context</code>，因此非常适合用来初始化那些需要全局共享的资源。</p>
<h3 data-id="heading-1">面试问题</h3>
<p><code>Application</code> 类的作用是什么？</p>
<p>它和 <code>Activity</code> 在生命周期和资源管理上有何区别？</p>
<h3 data-id="heading-2">Application 的作用</h3>
<p><code>Application</code> 类的设计初衷就是保存全局状态，并执行应用范围内的初始化操作。开发者通常会继承这个类，用以设置依赖项、配置第三方库，以及管理那些需要在多个 <code>Activity</code> 和 <code>Service</code> 之间持续存在的资源。</p>
<p>默认情况下，每个 Android 应用都会使用系统提供的 <code>Application</code> 基类实现，除非你在 <code>AndroidManifest.xml</code> 文件中明确指定了一个自定义的子类。</p>
<h3 data-id="heading-3">Application 类中的关键方法</h3>
<ol>
<li><code>onCreate()</code>：当应用进程被创建时调用。这是你初始化全局依赖项（比如数据库实例、网络库或分析工具）的标准位置。在整个应用生命周期中，该方法只会被调用一次。</li>
<li><code>onTerminate()</code>：仅在模拟器环境中应用终止时调用。在真实设备的生产环境中不会被触发，因为 Android 并不保证它会被执行。</li>
<li><code>onLowMemory()</code> 与 <code>onTrimMemory()</code>：当系统检测到内存不足时触发。<code>onLowMemory()</code> 主要用于较老的 API 版本，而 <code>onTrimMemory()</code> 提供了更细粒度的控制，能根据应用当前的内存状态做出响应。</li>
</ol>
<h3 data-id="heading-4">如何使用 Application 类</h3>
<p>要定义一个自定义的 <code>Application</code> 类，你需要继承 <code>Application</code>，并在 <code>AndroidManifest.xml</code> 的 <code>&lt;application&gt;</code> 标签中声明它：</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomApplication</span> : <span class="hljs-type">Application</span>() {

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        <span class="hljs-comment">// 初始化全局依赖</span>
        initializeDatabase()
        initializeAnalytics()
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initializeDatabase</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// 设置数据库实例</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initializeAnalytics</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// 配置分析追踪</span>
    }
}
</code></pre>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">application</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">".CustomApplication"</span>
    <span class="hljs-attr">...</span> &gt;</span>
    ...
<span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">适用场景</h3>
<ol>
<li><strong>全局资源管理</strong>：数据库、<code>SharedPreferences</code> 或网络客户端等资源只需初始化一次，即可在全应用复用。</li>
<li><strong>组件初始化</strong>：像 <strong>Firebase Analytics</strong>、<strong>Timber</strong> 这类工具应在应用启动阶段完成初始化，以确保在整个生命周期中无缝运行。</li>
<li><strong>依赖注入</strong>：你可以在这里初始化 <strong>Dagger</strong> 或 <strong>Hilt</strong> 等依赖注入框架，为整个应用提供统一的依赖管理。</li>
</ol>
<h3 data-id="heading-6">最佳实践</h3>
<ol>
<li>避免在 <code>onCreate()</code> 中执行耗时操作，以免拖慢应用启动速度。</li>
<li>不要把 <code>Application</code> 类当成“杂物抽屉”。只放真正全局相关的逻辑，保持职责单一。</li>
<li>管理共享资源时注意线程安全，尤其是在多线程环境下访问这些资源。</li>
</ol>
<h3 data-id="heading-7">总结</h3>
<p><code>Application</code> 类是整个应用中初始化和管理全局资源的核心场所。虽然它是进行全局配置的重要基础 API，但应仅用于真正需要全局处理的任务，以保持代码清晰，避免不必要的复杂性。</p>
<hr/>
<h2 data-id="heading-8">AndroidManifest 文件</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79b02c35dcfc459a8f80acc4faec3ff3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=kNPp6KtZJZTJ0UC3SOi4qkdXZsA%3D" alt="5.png" loading="lazy"/></p>
<p><code>AndroidManifest.xml</code> 文件是 Android 项目中的一个关键配置文件，它向 Android 操作系统定义了关于应用程序的重要信息。它充当了应用程序与操作系统之间的桥梁，告知操作系统应用程序的组件、权限、硬件和软件特性等信息。</p>
<p>它就像一张身份证，告诉系统：我是谁、我能干啥、需要什么权限、依赖哪些硬件——没它，你的 App 连门都进不去。</p>
<h3 data-id="heading-9">面试问题</h3>
<p><code>AndroidManifest</code> 中的意图过滤器如何实现应用程序之间的交互？</p>
<p>如果一个 <code>Activity</code> 类未在 <code>AndroidManifest</code> 中注册会发生什么？</p>
<h3 data-id="heading-10">关键功能</h3>
<ol>
<li><strong>应用程序组件声明</strong>：它注册了诸如 <code>Activity</code> 、<code>Service</code>、 <code>BroadcastReceiver</code> 和 <code>ContentProvider</code> 等基本组件， 以便 Android 系统知道如何启动或与它们交互。</li>
<li><strong>权限</strong>：它声明了应用程序所需的权限，例如 <code>INTERNET</code>、<code>ACCESS_FINE_LOCATION</code> 或 <code>READ_CONTACTS</code>，这样用户就能知道应用程序将访问哪些资源，并可以授予或拒绝这些权限。</li>
<li><strong>硬件和软件要求</strong>：它指定了应用程序依赖的功能，例如摄像头、GPS 或 某些屏幕尺寸，帮助应用商店过滤掉不符合这些要求的设备。</li>
<li><strong>应用程序元数据</strong>：提供了应用程序的基本信息，例如包名、版本、最低和目标 API 级别、主题和样式，系统在安装和执行应用程序时会使用这些信息。</li>
<li><strong>意图过滤器</strong>：为组件（例如 <code>Activity</code>）定义了 <code>IntentFilter</code> ，以指定它们可以响应的意图类型， 如打开链接或共享内容，从而允许其他应用程序与之交互。</li>
<li><strong>应用程序配置和设置</strong>：包括设置主启动器 <code>Activity</code>、配置备份行为以及指定主题等配置， 这些有助于控制应用程序的行为和显示方式。 以下是一个 <code>AndroidManifest.xml</code> 文件的示例，如下所示：</li>
</ol>
<pre><code class="hljs language-xml" lang="xml">1  <span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>&gt;</span>
2  
3      <span class="hljs-comment">&lt;!-- Permissions --&gt;</span>
4      <span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.INTERNET"</span> /&gt;</span>
5      <span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.ACCESS_FINE_LOCATION"</span> /&gt;</span>
6  
7  <span class="hljs-tag">&lt;<span class="hljs-name">application</span>
<span class="hljs-attr">8</span>      <span class="hljs-attr">android:allowBackup</span>=<span class="hljs-string">"true"</span>
<span class="hljs-attr">9</span>      <span class="hljs-attr">android:icon</span>=<span class="hljs-string">"@mipmap/ic_launcher"</span>
<span class="hljs-attr">10</span>     <span class="hljs-attr">android:label</span>=<span class="hljs-string">"@string/app_name"</span>
<span class="hljs-attr">11</span>     <span class="hljs-attr">android:theme</span>=<span class="hljs-string">"@style/AppTheme"</span>&gt;</span>
12 
13     <span class="hljs-comment">&lt;!-- Main Activity --&gt;</span>
14     <span class="hljs-tag">&lt;<span class="hljs-name">activity</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MainActivity"</span>&gt;</span>
15         <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
16             <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.MAIN"</span> /&gt;</span>
17             <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.LAUNCHER"</span> /&gt;</span>
18         <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
19     <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>
20 
21     <span class="hljs-comment">&lt;!-- Additional Components --&gt;</span>
22     <span class="hljs-tag">&lt;<span class="hljs-name">service</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MyService"</span> /&gt;</span>
23     <span class="hljs-tag">&lt;<span class="hljs-name">receiver</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MyBroadcastReceiver"</span> /&gt;</span>
24 
25 <span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>
26 <span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span>
</code></pre>
<h3 data-id="heading-11">总结</h3>
<p><code>AndroidManifest.xml</code> 文件对每个 App 至关重要，它向 Android 操作系统提供了管理应用程序生命周期、权限和交互所需的所有细节。它本质上充当了一个定义应用程序结构和要求的蓝图。</p>
<p>这里给出一个较长（但还远远不够完整）的例子：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
  <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">"http://schemas.android.com/tools"</span> &gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.INTERNET"</span> /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">application</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">".FeedinApp"</span>
    <span class="hljs-attr">android:allowBackup</span>=<span class="hljs-string">"false"</span>
    <span class="hljs-attr">android:icon</span>=<span class="hljs-string">"@mipmap/ic_launcher"</span>
    <span class="hljs-attr">android:label</span>=<span class="hljs-string">"@string/app_name"</span>
    <span class="hljs-attr">android:supportsRtl</span>=<span class="hljs-string">"true"</span>
    <span class="hljs-attr">android:theme</span>=<span class="hljs-string">"@style/AppTheme"</span>
    <span class="hljs-attr">tools:ignore</span>=<span class="hljs-string">"AllowBackup"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">activity</span>
      <span class="hljs-attr">android:name</span>=<span class="hljs-string">".ui.main.MainActivity"</span>
      <span class="hljs-attr">android:exported</span>=<span class="hljs-string">"true"</span>
      <span class="hljs-attr">android:launchMode</span>=<span class="hljs-string">"singleTop"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.MAIN"</span> /&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.LAUNCHER"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">activity</span>
      <span class="hljs-attr">android:name</span>=<span class="hljs-string">".ui.details.DetailActivity"</span>
      <span class="hljs-attr">android:launchMode</span>=<span class="hljs-string">"singleTop"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">provider</span>
      <span class="hljs-attr">android:name</span>=<span class="hljs-string">"androidx.startup.InitializationProvider"</span>
      <span class="hljs-attr">android:authorities</span>=<span class="hljs-string">"io.xetom.feedin.androidx-startup"</span>
      <span class="hljs-attr">android:exported</span>=<span class="hljs-string">"false"</span>
      <span class="hljs-attr">tools:node</span>=<span class="hljs-string">"merge"</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span>
        <span class="hljs-attr">android:name</span>=<span class="hljs-string">"io.xetom.feedin.initializer.TimberInitializer"</span>
        <span class="hljs-attr">android:value</span>=<span class="hljs-string">"androidx.startup"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">provider</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">profileable</span>
      <span class="hljs-attr">android:shell</span>=<span class="hljs-string">"true"</span>
      <span class="hljs-attr">tools:targetApi</span>=<span class="hljs-string">"q"</span> /&gt;</span>

  <span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span>
</code></pre>
<hr/>
<h2 data-id="heading-12">Activity 的生命周期</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6be4aaca79664543a1793a18aa1ba9c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=80vSzX1mDpeWMQAVG9BJaCjTiz4%3D" alt="6.png" loading="lazy"/></p>
<p>Android <code>Activity</code> 的生命周期描述了 <code>Activity</code> 在其生命周期中从创建到销毁所经历的不同状态。理解这些状态对于有效管理资源、处理用户输入以及确保流畅的用户体验至关重要。</p>
<h3 data-id="heading-13">面试问题</h3>
<p><code>onPause()</code> 和 <code>onStop()</code> 有什么区别？</p>
<p>在哪些场景下应该分别用来处理耗资源的操作？</p>
<h3 data-id="heading-14">生命周期回调</h3>
<p>以下是 <code>Activity</code> 生命周期的主要阶段：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cf1838790574679a4e96c24256be178~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=SN1jGZ0VfKFy%2FELQMVejhwP2Rn8%3D" alt="1png.png" loading="lazy"/></p>
<ol>
<li><code>onCreate()</code>：当一个 <code>Activity</code> 被创建时，这是第一个被调用的方法。在这里你可以初始化 <code>Activity</code>、设置 UI 组件，并恢复任何保存的实例状态。除非 <code>Activity</code> 被销毁并重新创建，否则在整个 <code>Activity</code> 生命周期中只会调用一次。</li>
<li><code>onStart()</code>：<code>Activity</code> 对用户变得可见，但尚不可交互。该方法在 <code>onCreate()</code> 之后和 <code>onResume()</code> 之前被调用。</li>
<li><code>onRestart()</code>：如果 <code>Activity</code> 停止后又被重新启动（例如，用户重新回到该 <code>Activity</code>），此方法会在 <code>onStart</code> 之前被调用。</li>
<li><code>onResume()</code>： <code>Activity</code> 处于前台，用户可以与之互动。这是恢复暂停的UI更新、动画或输入监听器的地方。</li>
<li><code>onPause()</code>：当 <code>Activity</code> 被另一个 <code>Activity</code> 部分遮挡时（例如，弹出对话框），会调用此方法。<code>Activity</code> 仍然可见但不在焦点上。通常用于暂停动画、传感器更新或保存数据等操作。</li>
<li><code>onStop()</code>： <code>Activity</code> 对用户不再可见（例如，另一个 <code>Activity</code> 进入前台）。你应该释放 <code>Activity</code> 停止期间不需要的资源，比如后台任务或大型对象。</li>
<li><code>onDestroy()</code>：在 <code>Activity</code> 被完全销毁并从内存中移除之前调用。这是释放所有剩余资源的最终清理方法。</li>
</ol>
<h3 data-id="heading-15">总结</h3>
<p>一个 <code>Activity</code> 会根据用户的操作和 Android 系统对资源的管理依次回调这些方法。开发者通过这些回调来处理界面切换、节省资源、保证用户体验流畅。</p>
<h3 data-id="heading-16">进阶：Activity 切换</h3>
<p>关于 <code>Activity</code> 生命周期，一个常见的进阶问题是：</p>
<p>“你能描述一下依次启动 <code>Activity</code> A、然后 <code>Activity</code> B，最后返回 <code>Activity</code> A 时发生的生命周期变化吗？”</p>
<p>这个问题能很好地检验你对 Android 系统如何管理多个 <code>Activity</code> 状态的理解。</p>
<p>在两个 <code>Activity</code> 之间导航时（比如从 <code>Activity</code> A 跳到 <code>Activity</code> B），每个 <code>Activity</code> 的生命周期回调会按特定顺序触发。我们来一步步拆解这个过程：</p>
<p><code>Activity</code> A 和 <code>Activity</code> B 的完整生命周期流程：</p>
<ul>
<li>
<p>初次启动 <code>Activity</code> A<br/>
<code>Activity</code> A: <code>onCreate()</code> → <code>onStart()</code> → <code>onResume()</code>。这是首次创建时的标准流程。此时用户正在与 <code>Activity</code> A 交互。</p>
</li>
<li>
<p>从 <code>Activity</code> A 跳转到 <code>Activity</code> B<br/>
<code>Activity</code> A: <code>onPause()</code>。暂停 UI 更新，释放与可见性相关的轻量资源。</p>
<p><code>Activity</code> B: <code>onCreate()</code> → <code>onStart()</code> → <code>onResume()</code>。创建并进入前台，获得用户焦点。</p>
<p><code>Activity</code> A: <code>onStop()</code>。如果 <code>Activity</code> B 完全覆盖了 <code>Activity</code> A（比如是全屏页面），系统会接着调用 <code>onStop()</code>。这一步不是总发生，但常见于标准跳转。</p>
</li>
<li>
<p>从 <code>Activity</code> B 返回 <code>Activity</code> A<br/>
<code>Activity</code> B: <code>onPause()</code>。
<code>Activity</code> A: <code>onRestart()</code> → <code>onStart()</code> → <code>onResume()</code>。重新激活，回到前台继续交互。</p>
<p><code>Activity</code> B: <code>onStop()</code> → <code>onDestroy()</code>。若系统决定回收它（比如通过返回键退出），就会走完销毁流程。</p>
</li>
</ul>
<p>总之：</p>
<p>在 <code>Activity</code> 切换过程中，前台的 <code>Activity</code> 总是先调用 <code>onPause()</code>，再退到后台。</p>
<p>新启动的 <code>Activity</code> 从 <code>onCreate()</code> 开始，一路走到 <code>onResume()</code>，接管用户焦点。</p>
<p>而当你返回之前的 <code>Activity</code>，它不会重新 <code>onCreate()</code>，而是通过 <code>onRestart()</code> 恢复状态。</p>
<p>理解这些生命周期的转换可以确保资源的正确管理和流畅的用户体验。</p>
<h3 data-id="heading-17">进阶：Activity 中的 lifecycle</h3>
<p>每个 <code>Activity</code> 都与一个 <code>Lifecycle</code> 实例相关联，该实例提供了一种观察和响应 <code>Activity</code> 生命周期事件的方式。<code>Lifecycle</code> 是 <strong>Jetpack Lifecycle</strong> 库的一部分，它让开发人员以干净、结构化的方式管理代码，以应对 <code>Activity</code> 的生命周期变化。</p>
<p><code>Activity</code> 中的 <code>lifecycle</code> 是 <code>Lifecycle</code> 类的一个实例，由所有 <code>ComponentActivity</code> 子类暴露出来。它表示当前 <code>Activity</code> 的生命周期状态，并提供了一种观察生命周期事件（<code>如onCreate</code>、<code>onStart</code>、<code>onResume</code> 等）的方式，而无需重写这些生命周期方法。这对于管理 UI 更新、资源清理或以生命周期感知的方式观察 <code>LiveData</code> 特别有用。</p>
<p><em>后续我将用 <code>lifecycle</code> 表示 <code>Lifecycle</code> 的实例（首字母小写）。</em></p>
<p>如何使用 <code>lifecycle</code>？</p>
<p>可以在 <code>lifecycle</code> 上添加 <code>LifecycleObserver</code> 或 <code>DefaultLifecycleObserver</code> 对象，以响应特定的生命周期事件。</p>
<p>例如，如果你想监听 <code>onStart</code> 和 <code>onStop</code>，可以注册一个观察者来处理这些回调：</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyObserver</span> : <span class="hljs-type">DefaultLifecycleObserver</span> {

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-keyword">super</span>.onStart(owner)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStop</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-keyword">super</span>.onStop(owner)
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">ComponentActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        lifecycle.addObserver(MyObserver())
    }
}
</code></pre>
<p>在此示例中，<code>MyObserver</code> 类观察 <code>MainActivity</code> 的生命周期变化。当 <code>Activity</code> 进入 <code>STARTED</code> 或 <code>STOPPED</code> 状态时，相应的函数会被调用。</p>
<p>使用 <code>lifecycle</code> 的好处如下：</p>
<ol>
<li><strong>生命周期感知</strong>：使用生命周期实例可以让你的组件了解 <code>Activity</code> 的生命周期状态，避免在 <code>Activity</code> 不在期望状态时执行不必要的或错误的操作。</li>
<li><strong>关注点分离</strong>：你可以将依赖生命周期的逻辑移出 <code>Activity</code> 类，从而提高可读性和可维护性。</li>
<li><strong>与 Jetpack 库集成</strong>：像 <code>LiveData</code> 和 <code>ViewModel</code> 这样的库设计为与生命周期实例无缝协作，支持响应式编程和高效的资源管理。</li>
</ol>
<p>总之：</p>
<p><code>Activity</code> 上的生命周期实例是 Android 现代架构的关键组成部分，使开发人员能够以结构化和可重用的方式处理生命周期事件。通过利用 <code>LifecycleObserver</code> 和其他 <strong>Jetpack</strong> 组件，你可以创建更强大、更易于维护的应用程序。</p>
<hr/>
<h2 data-id="heading-18">Fragment 的生命周期</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4697e0ef6c04db2ab25e659efeb26a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=Pizbu%2BY4%2FDvk8NVGCxpl831jPVs%3D" alt="7.png" loading="lazy"/></p>
<p>每个 <code>Fragment</code> 实例都有自己的生命周期，和它所属的 <code>Activity</code> 生命周期是分开的。当用户在 App 里操作时，<code>Fragment</code> 会随着添加、移除、上屏或下屏等动作，在不同的生命周期状态之间切换——比如创建、启动、可见、活跃，再到不再需要时的停止或销毁。</p>
<p>管好这些状态切换，才能让 <code>Fragment</code> 高效地使用资源、保持 UI 一致，并对用户操作做出流畅响应。</p>
<h3 data-id="heading-19">面试问题</h3>
<p><code>onCreateView()</code> 和 <code>onDestroyView()</code> 的作用是什么？</p>
<p>为什么在这些方法中正确处理与视图相关的资源很重要？</p>
<h3 data-id="heading-20">生命周期回调</h3>
<p>Android 中的 <code>Fragment</code> 生命周期和 <code>Activity</code> 很像，但也有自己独有的方法和行为，更细、更灵活。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a25d59dcbefe4d749f8b669f14266b23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=zqb2aGpnvYf%2F39ouC8Bseo%2FjGOg%3D" alt="图片.png" loading="lazy"/></p>
<ol>
<li><code>onAttach()</code>：当 <code>Fragment</code> 被关联到它的父 <code>Activity</code> 时，这是第一个被调用的回调。此时 <code>Fragment</code> 已经绑定，可以和 <code>Activity</code> 的上下文交互了。</li>
<li><code>onCreate()</code>：用于初始化 <code>Fragment</code>。此时 <code>Fragment</code> 已创建，但 UI 还没生成。通常在这里初始化核心组件或恢复之前保存的状态。</li>
<li><code>onCreateView()</code>：当 <code>Fragment</code> 的 UI 第一次被绘制时调用。你需要在这个方法里返回布局的根视图，也就是用 <code>LayoutInflater</code> 加载布局的地方。</li>
<li><code>onViewStateRestored()</code>：在 <code>Fragment</code> 的视图层级创建完成、且保存的状态已恢复到视图后调用。</li>
<li><code>onViewCreated()</code>：在 <code>Fragment</code> 的视图创建完成后触发。常用来设置 UI 组件，以及处理用户交互所需的逻辑。</li>
<li><code>onStart()</code>：<code>Fragment</code> 对用户可见了。这和 <code>Activity</code> 的 <code>onStart()</code> 类似——此时它已经活跃，但还没处于前台。</li>
<li><code>onResume()</code>：<code>Fragment</code> 完全激活并运行在前台，用户可以与之交互。当 <code>Fragment</code> 的 UI 可见且可操作时，会调用这个方法。</li>
<li><code>onPause()</code>：当 <code>Fragment</code> 不再处于前台但仍然可见时调用。它即将失去焦点，你应该暂停那些不该在后台继续运行的任务。</li>
<li><code>onStop()</code>：<code>Fragment</code> 不再可见。这里要停止那些不需要在屏幕外继续运行的操作。</li>
<li><code>onSaveInstanceState()</code>：在 <code>Fragment</code> 被销毁前调用，用来保存与 UI 相关的状态数据，以便后续能恢复。</li>
<li><code>onDestroyView()</code>：当 <code>Fragment</code> 的视图层级被移除时调用。你应该清理与视图相关的资源，比如清空适配器、置空引用，防止内存泄漏。</li>
<li><code>onDestroy()</code>：<code>Fragment</code> 本身正在被销毁。所有资源都应该在此时释放，但它仍与父 <code>Activity</code> 关联着。</li>
<li><code>onDetach()</code>：<code>Fragment</code> 从父 <code>Activity</code> 上解绑，不再与其关联。这是最后一个回调，标志着 <code>Fragment</code> 生命周期结束。</li>
</ol>
<h3 data-id="heading-21">总结</h3>
<p>理解 <code>Fragment</code> 的生命周期，对高效管理资源、应对配置变更、保证 Android 应用体验流畅至关重要。</p>
<h3 data-id="heading-22">进阶：childFragmentManager</h3>
<p>在 Android 中，<code>fragmentManager</code> 和 <code>childFragmentManager</code> 都是用来管理 <code>Fragment</code> 的，但它们的作用不同，运行的范围也不同。</p>
<p><code>fragmentManager</code> 与 <code>FragmentActivity</code> 或 <code>Fragment</code> 本身绑定，负责在 <code>Activity</code> 级别管理 <code>Fragment</code>。它能直接添加、替换或移除与父 <code>Activity</code> 关联的 <code>Fragment</code>。</p>
<p>当你在 <code>Activity</code> 中调用 <code>supportFragmentManager</code>，就是在访问这个 <code>fragmentManager</code>。由它管理的 <code>Fragment</code> 是兄弟关系，处于同一层级。</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">// 在 Activity 层级管理 Fragment</span>
supportFragmentManager.beginTransaction()
    .replace(R.id.container, ExampleFragment())
    .commit()
</code></pre>
<p>这通常用于那些属于 <code>Activity</code> 主要导航或 UI 结构的 <code>Fragment</code>。</p>
<p><code>childFragmentManager</code> 是某个 <code>Fragment</code> 专属的，用来管理它的子 <code>Fragment</code>。这让一个 <code>Fragment</code> 能嵌套其他 <code>Fragment</code>，形成多层结构。</p>
<p>使用 <code>childFragmentManager</code> 时，你是在父 <code>Fragment</code> 的生命周期内定义子 <code>Fragment</code>。这特别适合把 UI 和逻辑封装在某个 <code>Fragment</code> 内部，尤其是当它需要一组独立于 <code>Activity</code> 生命周期的嵌套 <code>Fragment</code> 时。</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">// 在父 Fragment 内管理子 Fragment</span>
childFragmentManager.beginTransaction()
    .replace(R.id.child_container, ChildFragment())
    .commit()
</code></pre>
<p>由 <code>childFragmentManager</code> 管理的子 <code>Fragment</code> 只属于父 <code>Fragment</code> 的作用域——它们的生命周期和父 <code>Fragment</code> 绑定。比如，当父 <code>Fragment</code> 被销毁时，它的所有子 <code>Fragment</code> 也会一起被销毁。</p>
<p>他们之间的区别如下。</p>
<p>从作用范围来看：</p>
<ul>
<li><code>fragmentManager</code> 在 <code>Activity</code> 层级工作，管理直接绑定到 <code>Activity</code> 的 <code>Fragment</code>。</li>
<li><code>childFragmentManager</code> 在某个 <code>Fragment</code> 内部运行，用于管理嵌套在父 <code>Fragment</code> 中的子 <code>Fragment</code>。</li>
</ul>
<p>从使用场景看：</p>
<ul>
<li>当你需要管理构成 <code>Activity</code> 主要 UI 组件的 <code>Fragment</code> 时，使用 <code>fragmentManager</code>。</li>
<li>当一个 <code>Fragment</code> 需要自己管理内部的子 <code>Fragment</code> 时，使用 <code>childFragmentManager</code>，这样可以让 UI 更模块化、更易复用。</li>
</ul>
<p>从生命周期看：</p>
<ul>
<li>由 <code>fragmentManager</code> 管理的 <code>Fragment</code> 遵循 <code>Activity</code> 的生命周期。</li>
<li>由 <code>childFragmentManager</code> 管理的 <code>Fragment</code> 则跟随其父 <code>Fragment</code> 的生命周期。</li>
</ul>
<p>总之：</p>
<p>选择使用 <code>fragmentManager</code> 还是 <code>childFragmentManager</code>，取决于你应用 UI 的层级结构。</p>
<ul>
<li>如果是 <code>Activity</code> 级别的 <code>Fragment</code>，用 <code>fragmentManager</code>。</li>
<li>如果要在某个 <code>Fragment</code> 内嵌套其他 <code>Fragment</code>，就用 <code>childFragmentManager</code>。</li>
</ul>
<p>理解它们的作用域和生命周期，能让你的 Android 应用结构更清晰、组件更独立。</p>
<h3 data-id="heading-23">进阶：Fragment 中的 viewLifecycleOwner</h3>
<p>在 Android 开发中，一个 <code>Fragment</code> 有自己的生命周期，它和宿主 <code>Activity</code> 绑定。但 <code>Fragment</code> 也有自己独立的生命周期。这个区别在管理像 <code>LiveData</code> 这样的生命周期感知数据源时特别重要。</p>
<p><code>viewLifecycleOwner</code> 实例就是用来帮你搞清楚这层关系、避免出问题的。</p>
<p><code>viewLifecycleOwner</code> 是一个与 <code>Fragment</code> 视图关联的 <code>LifecycleOwner</code>。它代表的是 <code>View</code> 的生命周期——从 <code>onCreateView()</code> 被调用开始，到 <code>onDestroyView()</code> 被调用结束。</p>
<p>这意味着你可以把 UI 相关的数据或资源，绑定到 <code>View</code> 的生命周期上，而不是整个 <code>Fragment</code>。这样能更精准地控制资源，防止内存泄漏这类问题。</p>
<p><code>Fragment</code> 的视图生命周期比 <code>Fragment</code> 自身短。</p>
<p>如果你用 <code>Fragment</code> 的生命周期（比如 <code>lifecycleOwner</code>）来观察数据或处理事件，一旦 <code>View</code> 被销毁了，你可能还在试图访问它，结果就是崩溃或异常行为。</p>
<p>而使用 <code>viewLifecycleOwner</code>，就能确保所有观察者或生命周期感知组件都只在 <code>View</code> 存在时生效。当 <code>View</code> 被销毁时，更新会自动停止，干净又卫生...哦，不对，是干净又安全。</p>
<p>下面是一个在 <code>Fragment</code> 中观察 <code>LiveData</code> 并避免内存泄漏甚至崩溃的例子：</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyFragment</span> : <span class="hljs-type">Fragment</span>(R.layout.fragment_example) {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel: MyViewModel <span class="hljs-keyword">by</span> viewModel()

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onViewCreated(view, savedInstanceState)

        <span class="hljs-comment">// 使用 viewLifecycleOwner 观察 LiveData</span>
        viewModel.<span class="hljs-keyword">data</span>.observe(viewLifecycleOwner) { <span class="hljs-keyword">data</span> -&gt;
            <span class="hljs-comment">// 用新数据更新 UI</span>
            textView.text = <span class="hljs-keyword">data</span>
        }
    }
}
</code></pre>
<p>在这个例子中，<code>viewLifecycleOwner</code> 确保了当 <code>Fragment</code> 的 <code>View</code> 被销毁时，观察者会被自动移除——即使 <code>Fragment</code> 本身还活着，也不会继续接收数据，避免了内存泄漏。</p>
<p><code>lifecycleOwner</code> 和 <code>viewLifecycleOwner</code> 的区别：</p>
<ul>
<li><code>lifecycleOwner</code>（<code>Fragment</code> 的生命周期）：代表整个 <code>Fragment</code> 的生命周期，持续时间更长，与宿主 <code>Activity</code> 绑定。</li>
<li><code>viewLifecycleOwner</code>（<code>Fragment</code> 的 <code>View</code> 生命周期）：代表 <code>Fragment</code> 中 <code>View</code> 的生命周期，从 <code>onCreateView</code> 开始，到 <code>onDestroyView</code> 结束。</li>
</ul>
<p>总之：</p>
<p>使用 <code>viewLifecycleOwner</code> 在 UI 相关任务中特别有用，尤其是在必须尊重 <code>View</code> 生命周期的场景下，比如观察 <code>LiveData</code> 或管理与 <code>View</code> 关联的资源。这样能避免内存泄漏，确保更新在 <code>View</code> 销毁时自动停止。</p>
<hr/>
<h2 data-id="heading-24">Service</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09c5d79b9c1c4428a4b571edaa2b0329~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=3172TWcCDAJzSVB%2FGS9Yd%2Flj3cA%3D" alt="8.png" loading="lazy"/></p>
<p><code>Service</code> 是一个后台组件，可以让应用在不依赖用户交互的情况下执行长时间运行的操作。</p>
<p>与 <code>Activity</code> 不同，<code>Service</code> 没有用户界面，即使应用不在前台，它也能继续运行。通常用于下载文件、播放音乐、同步数据或处理网络请求等后台任务。</p>
<h3 data-id="heading-25">面试问题</h3>
<p>Android 中，<code>started service</code> 和 <code>bound service</code> 有什么区别？分别在什么场景下使用？</p>
<h3 data-id="heading-26">启动型 Service</h3>
<p>当某个应用组件调用 <code>startService()</code> 时，<code>Service</code> 就会被启动。它会在后台持续运行，直到自己调用 <code>stopSelf()</code> 或被外部通过 <code>stopService()</code> 明确停止。</p>
<p>使用场景：</p>
<ul>
<li>播放背景音乐。</li>
<li>上传或下载文件。</li>
</ul>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyService</span> : <span class="hljs-type">Service</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStartCommand</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?, flags: <span class="hljs-type">Int</span>, startId: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-comment">// 在后台执行长时间任务</span>
        <span class="hljs-keyword">return</span> START_STICKY
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBind</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?)</span></span>: IBinder? = <span class="hljs-literal">null</span>
}
</code></pre>
<h3 data-id="heading-27">绑定型 Service</h3>
<p>其他组件通过 <code>bindService()</code> 来绑定 <code>Service</code>，并与它建立连接。只要还有组件绑定着它，<code>Service</code> 就会保持活跃；当所有客户端都断开连接后，它会自动停止。</p>
<p>使用场景：</p>
<ul>
<li>从服务器获取数据（指长时间需要通过 <code>Service</code> 来获取数据）。</li>
<li>管理后台蓝牙连接。</li>
</ul>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BoundService</span> : <span class="hljs-type">Service</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> binder = LocalBinder()

    <span class="hljs-keyword">inner</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalBinder</span> : <span class="hljs-type">Binder</span>() {
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getService</span><span class="hljs-params">()</span></span>: BoundService = <span class="hljs-keyword">this</span><span class="hljs-symbol">@BoundService</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBind</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?)</span></span>: IBinder = binder
}
</code></pre>
<h3 data-id="heading-28">前台 Service</h3>
<p>前台 <code>Service</code> 是一种特殊的 <code>Service</code>，它在运行时会显示一个持续的通知。这种服务适用于需要用户持续感知的任务，比如播放音乐、导航或位置追踪。</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForegroundService</span> : <span class="hljs-type">Service</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStartCommand</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?, flags: <span class="hljs-type">Int</span>, startId: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">val</span> notification = createNotification()
        startForeground(<span class="hljs-number">1</span>, notification)
        <span class="hljs-keyword">return</span> START_STICKY
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createNotification</span><span class="hljs-params">()</span></span>: Notification {
        <span class="hljs-keyword">return</span> NotificationCompat.Builder(<span class="hljs-keyword">this</span>, <span class="hljs-string">"channel_id"</span>)
            .setContentTitle(<span class="hljs-string">"Foreground Service"</span>)
            .setContentText(<span class="hljs-string">"Running..."</span>)
            .setSmallIcon(R.drawable.ic_notification)
            .build()
    }
}
</code></pre>
<h3 data-id="heading-29">各类 Service 的关键区别</h3>





























<table><thead><tr><th>Service 类型</th><th>是否在后台运行</th><th>是否自动停止</th><th>是否需要 UI 通知</th></tr></thead><tbody><tr><td>Started Service</td><td>✅ 是</td><td>❌ 否</td><td>❌ 否</td></tr><tr><td>Bound Service</td><td>✅ 是</td><td>✅ 是（当所有客户端解绑后）</td><td>❌ 否</td></tr><tr><td>Foreground Service</td><td>✅ 是</td><td>❌ 否</td><td>✅ 是</td></tr></tbody></table>
<h3 data-id="heading-30">最佳实践</h3>
<ul>
<li>对于不需要立即执行的后台任务，优先使用 <code>Jetpack WorkManager</code> 而不是 <code>Service</code>。</li>
<li>任务完成后及时停止 <code>Service</code>，避免不必要的资源消耗。</li>
<li>合理使用前台 <code>Service</code>，提供清晰的通知，保证透明性。</li>
<li>正确处理生命周期变化（如 <code>Service</code> 的生命周期），防止内存泄漏。</li>
</ul>
<h3 data-id="heading-31">总结</h3>
<p><code>Service</code> 让应用能在无用户交互的情况下进行后台处理。</p>
<ul>
<li><code>Started Service</code> 会一直运行，直到手动停止；</li>
<li><code>Bound Service</code> 用于与其他组件通信；</li>
<li><code>Foreground Service</code> 通过持续通知保持活跃。</li>
</ul>
<p>合理管理 <code>Service</code>，才能保证系统资源高效利用，同时带来流畅的用户体验。</p>
<h3 data-id="heading-32">进阶：如何处理前台 Service</h3>
<p>前台 <code>Service</code> 是一种特殊类型的 <code>Service</code>，用于执行用户能明显感知的任务。它会在通知栏显示一个持续的通知，确保用户知道它的运行状态。这类服务常用于高优先级任务，比如媒体播放、位置追踪或文件上传。</p>
<p>与普通 <code>Service</code> 的关键区别在于：前台 <code>Service</code> 必须在启动时立即调用 <code>startForeground()</code> 并展示通知，否则系统会强制终止它：</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForegroundService</span> : <span class="hljs-type">Service</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        <span class="hljs-comment">// 初始化资源</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStartCommand</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?, flags: <span class="hljs-type">Int</span>, startId: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">val</span> notification = createNotification()
        startForeground(<span class="hljs-number">1</span>, notification) <span class="hljs-comment">// 以前台方式启动服务</span>
        <span class="hljs-comment">// 执行任务</span>
        <span class="hljs-keyword">return</span> START_STICKY
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createNotification</span><span class="hljs-params">()</span></span>: Notification {
        <span class="hljs-keyword">val</span> notificationChannelId = <span class="hljs-string">"ForegroundServiceChannel"</span>
        <span class="hljs-keyword">val</span> channel = NotificationChannel(
            notificationChannelId,
            <span class="hljs-string">"Foreground Service"</span>,
            NotificationManager.IMPORTANCE_DEFAULT
        )
        getSystemService(NotificationManager::<span class="hljs-keyword">class</span>.java).createNotificationChannel(channel)
        <span class="hljs-keyword">return</span> NotificationCompat.Builder(<span class="hljs-keyword">this</span>, notificationChannelId)
            .setContentTitle(<span class="hljs-string">"Foreground Service"</span>)
            .setContentText(<span class="hljs-string">"Running in the foreground"</span>)
            .setSmallIcon(R.drawable.ic_notification)
            .build()
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onDestroy()
        <span class="hljs-comment">// 清理资源</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBind</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?)</span></span>: IBinder? = <span class="hljs-literal">null</span>
}
</code></pre>
<p><code>Service</code> 和 <code>Foreground Service</code> 的关键区别在于：</p>
<ol>
<li><strong>用户感知</strong>：普通 <code>Service</code> 可以在后台默默运行，用户无感；而 <code>Foreground Service</code> 必须显示通知，让用户清楚知道它正在运行。</li>
<li><strong>优先级</strong>：<code>Foreground Service</code> 优先级更高，在内存紧张时更不容易被系统杀死。</li>
<li><strong>使用场景</strong>：普通 <code>Service</code> 适合轻量级后台任务；<code>Foreground Service</code> 更适合持续、用户可见的任务，比如播放音乐或上传文件。</li>
</ol>
<p>那么，使用 <code>Service</code> 有哪些建议呢？</p>
<ol>
<li>任务完成后一定要及时停止 <code>Service</code>，避免浪费系统资源。</li>
<li>对于不需要立即执行的后台任务，优先使用 <code>WorkManager</code>。</li>
<li>使用前台 <code>Service</code> 时，确保通知简洁友好、信息明确，保持透明度。</li>
</ol>
<p>总之：</p>
<p>Android 的 <code>Service</code> 能高效执行后台任务，而 <code>Foreground Service</code> 则适用于需要持续运行且用户可见的场景。两者都对构建资源管理合理、体验流畅的应用至关重要。</p>
<h3 data-id="heading-33">进阶：Service 的生命周期</h3>
<p>正如你之前所学，一个 <code>Service</code> 可以以两种模式运行：</p>
<ol>
<li>通过 <code>startService()</code> 启动：会一直运行，直到被明确调用 <code>stopSelf()</code> 或 <code>stopService()</code> 停止。</li>
<li>通过 <code>bindService()</code> 与一个或多个组件绑定：只要还有组件绑定着它，它就会持续存在。</li>
</ol>
<p>它的生命周期通过 <code>onCreate()</code>、<code>onStartCommand()</code>、<code>onBind()</code> 和 <code>onDestroy()</code> 等方法进行管理。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/baa6bf16d831405a9fa8d346548997eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=38tHcXqx7w4ATUrsgQ35Q8QB2Fs%3D" alt="3.png" loading="lazy"/></p>
<p>当 <code>startService()</code>：</p>
<ol>
<li><code>onCreate()</code>：当 <code>Service</code> 首次创建时调用。用于初始化 <code>Service</code> 所需的资源。</li>
<li><code>onStartCommand()</code>：当通过 <code>startService()</code> 启动 <code>Service</code> 时触发。该方法负责执行实际任务，并通过返回值（如 <code>START_STICKY</code>、<code>START_NOT_STICKY</code>）决定服务被杀死后是否重启。</li>
<li><code>onDestroy()</code>：当使用 <code>stopSelf()</code> 或 <code>stopService()</code> 停止 <code>Service</code> 时调用。用于执行清理操作，比如释放资源或停止线程。</li>
</ol>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleStartedService</span> : <span class="hljs-type">Service</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        <span class="hljs-comment">// 初始化资源</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStartCommand</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?, flags: <span class="hljs-type">Int</span>, startId: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-comment">// 执行长时间任务</span>
        <span class="hljs-keyword">return</span> START_STICKY <span class="hljs-comment">// 如果服务被杀死，系统会尝试重启它</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onDestroy()
        <span class="hljs-comment">// 清理资源</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBind</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?)</span></span>: IBinder? = <span class="hljs-literal">null</span> <span class="hljs-comment">// 启动型服务不使用绑定</span>
}
</code></pre>
<p>当 <code>bindService()</code>：</p>
<ol>
<li><code>onCreate()</code>：与启动型服务类似，当 <code>Service</code> 创建时调用，用于初始化所需资源。</li>
<li><code>onBind()</code>：当某个组件通过 <code>bindService()</code> 绑定到该服务时触发。此方法返回一个接口（<code>IBinder</code>），供客户端与服务通信。</li>
<li><code>onUnbind()</code>：当最后一个客户端从服务解绑时调用。这里是清理与绑定客户端相关资源的地方。</li>
<li><code>onDestroy()</code>：当服务被终止时调用，负责释放资源并停止正在进行的操作。</li>
</ol>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleBoundService</span> : <span class="hljs-type">Service</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> binder = LocalBinder()

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        <span class="hljs-comment">// 初始化资源</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBind</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?)</span></span>: IBinder {
        <span class="hljs-keyword">return</span> binder <span class="hljs-comment">// 返回绑定服务的接口</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onUnbind</span><span class="hljs-params">(intent: <span class="hljs-type">Intent</span>?)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-comment">// 当没有客户端绑定时进行清理</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onUnbind(intent)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onDestroy()
        <span class="hljs-comment">// 清理资源</span>
    }

    <span class="hljs-keyword">inner</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalBinder</span> : <span class="hljs-type">Binder</span>() {
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getService</span><span class="hljs-params">()</span></span>: SimpleBoundService = <span class="hljs-keyword">this</span><span class="hljs-symbol">@SimpleBoundService</span>
    }
}
</code></pre>
<p>启动型与绑定型 <code>Service</code> 生命周期的关键区别在于：</p>
<ol>
<li><strong>Started Service</strong>：独立于任何组件运行，直到被明确停止才会结束。</li>
<li><strong>Bound Service</strong>：仅在至少有一个客户端绑定时才存在，一旦所有客户端解绑，服务就会终止。</li>
</ol>
<p>总之：</p>
<p>理解 <code>Service</code> 的生命周期，对实现高效、可靠的后台任务至关重要。</p>
<p>启动型服务执行独立任务，持续运行直到被停止；而绑定型服务为客户端提供交互接口，一旦解绑即终止。</p>
<p>正确管理这些生命周期，能确保资源使用最优，并避免内存泄漏。</p>
<hr/>
<h2 data-id="heading-34">BroadcastReceiver</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a68efbaca73418292762774fb81980e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=j602UcokUNZ18noKrXH%2BA%2BthwFg%3D" alt="9.png" loading="lazy"/></p>
<p><code>BroadcastReceiver</code> 是一个组件，它让你的 App 能够监听并响应系统级广播消息或应用自定义的广播。这些广播通常由系统或其他应用触发，用于通知各种事件，比如电池状态变化、网络连接更新，或者 App 内部发送的自定义 <code>Intent</code>。</p>
<p><code>BroadcastReceiver</code> 是构建响应式应用的重要机制，能让你的程序对动态的系统或应用级事件做出及时反应。</p>
<p><em><code>BroadcastReceiver</code> 正确的中文翻译是广播接收器，而广播应该是 <code>Broadcast</code>，但是开发者不会区分这么细。当你着重发送的时候，我们指的是广播，而着重接收的时候，我们指的是广播接收器。后续将会沿用这种习惯。</em></p>
<h3 data-id="heading-35">面试问题</h3>
<p>广播有哪些不同类型？</p>
<p>系统广播与自定义广播在功能和用途上有什么区别？</p>
<h3 data-id="heading-36">BroadcastReceiver 的作用</h3>
<p><code>BroadcastReceiver</code> 用来处理那些不直接与 <code>Activity</code> 或 <code>Service</code> 生命周期相关的事件。</p>
<p>它相当于一个消息系统，让你的 App 能在不需要一直后台运行的情况下，对系统变化做出响应，从而节省资源。</p>
<h3 data-id="heading-37">广播的类型</h3>
<ol>
<li><strong>系统广播</strong>：由 Android 操作系统发出，用于通知应用系统事件，比如电池电量变化、时区更新或网络连接状态改变。</li>
<li><strong>自定义广播</strong>：由应用自身发出，用于在应用内部或不同应用之间传递特定信息或事件。</li>
</ol>
<h3 data-id="heading-38">声明一个 BroadcastReceiver</h3>
<p>要创建一个 <code>BroadcastReceiver</code>，你需要继承 <code>BroadcastReceiver</code> 类，并重写 <code>onReceive</code> 方法，在其中定义处理广播的逻辑。</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyBroadcastReceiver</span> : <span class="hljs-type">BroadcastReceiver</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onReceive</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>, intent: <span class="hljs-type">Intent</span>)</span></span> {
        <span class="hljs-keyword">val</span> action = intent.action
        <span class="hljs-keyword">if</span> (action == Intent.ACTION_BATTERY_LOW) {
            <span class="hljs-comment">// 处理低电量事件</span>
            Log.d(<span class="hljs-string">"MyBroadcastReceiver"</span>, <span class="hljs-string">"Battery is low!"</span>)
        }
    }
}
</code></pre>
<h3 data-id="heading-39">注册 BroadcastReceiver</h3>
<p>你可以通过两种方式注册 <code>BroadcastReceiver</code>：</p>
<ol>
<li><strong>静态注册</strong> ：适用于即使应用未运行也需要处理的事件。在 <code>AndroidManifest.xml</code> 文件中添加 <code>&lt;intent-filter&gt;</code>。</li>
</ol>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">receiver</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MyBroadcastReceiver"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.BATTERY_LOW"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">receiver</span>&gt;</span>
</code></pre>
<ol start="2">
<li><strong>动态注册</strong> ：适用于仅在应用处于活跃状态或特定场景下才需要处理的事件。</li>
</ol>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">val</span> receiver = MyBroadcastReceiver()
<span class="hljs-keyword">val</span> intentFilter = IntentFilter(Intent.ACTION_BATTERY_LOW)
registerReceiver(receiver, intentFilter)
</code></pre>
<h3 data-id="heading-40">注意事项</h3>
<ul>
<li><strong>生命周期管理</strong>：如果使用动态注册，务必在适当时候调用 <code>unregisterReceiver</code> 取消注册，避免内存泄漏。</li>
<li><strong>后台限制</strong>：从 Android 8.0（API 级别 26）开始，后台应用接收广播受到限制，不能在 <code>AndroidManifest</code> 中为隐式广播注册 <code>BroadcastReceiver</code>，除非该广播是专门发送给它们的。建议使用 <code>Context.registerReceiver</code> 或 <code>JobScheduler</code> 来处理这类场景。</li>
<li><strong>安全问题</strong>：如果广播包含敏感信息，应通过权限保护，防止未经授权的访问。</li>
</ul>
<h3 data-id="heading-41">广播的典型用例</h3>
<ul>
<li>监听网络连接状态的变化。</li>
<li>响应短信或电话事件。</li>
<li>根据系统事件（如充电状态）更新 UI。</li>
<li>使用自定义广播来调度任务或闹钟。</li>
</ul>
<h3 data-id="heading-42">总结</h3>
<p><code>BroadcastReceiver</code> 是构建响应式应用程序的关键组件，尤其适用于与操作系统交互。它们使您的应用能够高效地监听并响应系统或应用事件。正确使用 <code>BroadcastReceiver</code>，特别是结合生命周期感知的注册方式，并遵守较新 Android 版本的限制要求，可确保您的应用保持稳定且资源高效。</p>
<hr/>
<h2 data-id="heading-43">ContentProvider</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66f0a7667acc412ab968646514e98dec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=y2%2Bwqs0q%2B662h23bIrg7tjy6uqE%3D" alt="10.png" loading="lazy"/></p>
<p><code>ContentProvider</code> 是一种管理对结构化数据集访问的组件，并为应用程序间的数据共享提供标准化接口。它作为一个中央存储库，供其他应用或组件查询、插入、更新或删除数据，从而确保跨应用的数据共享既安全又一致。</p>
<p><code>ContentProvider</code> 在多个应用需要访问相同数据，或希望在不暴露数据库或内部存储结构的情况下向其他应用提供数据时尤其有用。</p>
<h3 data-id="heading-44">面试问题</h3>
<p><code>ContentProvider</code> <strong>URI</strong> 的关键组成部分有哪些？</p>
<p><code>ContentResolver</code> 如何与 <code>ContentProvider</code> 交互以查询或修改数据？</p>
<h3 data-id="heading-45">作用</h3>
<p><code>ContentProvider</code> 的主要目的是封装数据访问逻辑，使跨应用共享数据更加简单和安全。它抽象了底层数据源（可以是 <strong>SQLite</strong> 数据库、文件系统，甚至是基于网络的数据），并提供一个统一的接口来与数据进行交互。</p>
<h3 data-id="heading-46">关键组成部分</h3>
<p><code>ContentProvider</code> 使用 <strong>URI</strong>（统一资源标识符）作为其数据访问地址。<strong>URI</strong> 由以下部分组成：</p>
<ol>
<li><strong>Authority（权限）</strong> ：标识 <code>ContentProvider</code>（例如：<code>com.example.myapp.provider</code>）。</li>
<li><strong>Path（路径）</strong> ：指定数据类型（例如：<code>/users</code> 或 <code>/products</code>）。</li>
<li><strong>ID（可选）</strong> ：指向数据集中某个特定项目。</li>
</ol>
<h3 data-id="heading-47">实现一个 ContentProvider</h3>
<p>要创建一个 <code>ContentProvider</code>，必须继承 <code>ContentProvider</code> 类并实现以下方法：</p>
<ul>
<li><code>onCreate()</code>：初始化 <code>ContentProvider</code>。</li>
<li><code>query()</code>：获取数据。</li>
<li><code>insert()</code>：添加新数据。</li>
<li><code>update()</code>：修改现有数据。</li>
<li><code>delete()</code>：删除数据。</li>
<li><code>getType()</code>：返回数据的 <strong>MIME</strong> 类型。</li>
</ul>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyContentProvider</span> : <span class="hljs-type">ContentProvider</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> database: SQLiteDatabase

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {
        database = MyDatabaseHelper(context!!).writableDatabase
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">query</span><span class="hljs-params">(
        uri: <span class="hljs-type">Uri</span>,
        projection: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;?,
        selection: <span class="hljs-type">String</span>?,
        selectionArgs: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;?,
        sortOrder: <span class="hljs-type">String</span>?
    )</span></span>: Cursor? {
        <span class="hljs-keyword">return</span> database.query(<span class="hljs-string">"users"</span>, projection, selection, selectionArgs, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, sortOrder)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insert</span><span class="hljs-params">(uri: <span class="hljs-type">Uri</span>, values: <span class="hljs-type">ContentValues</span>?)</span></span>: Uri? {
        <span class="hljs-keyword">val</span> id = database.insert(<span class="hljs-string">"users"</span>, <span class="hljs-literal">null</span>, values)
        <span class="hljs-keyword">return</span> ContentUris.withAppendedId(uri, id)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">update</span><span class="hljs-params">(uri: <span class="hljs-type">Uri</span>, values: <span class="hljs-type">ContentValues</span>?, selection: <span class="hljs-type">String</span>?, selectionArgs: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;?)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">return</span> database.update(<span class="hljs-string">"users"</span>, values, selection, selectionArgs)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">delete</span><span class="hljs-params">(uri: <span class="hljs-type">Uri</span>, selection: <span class="hljs-type">String</span>?, selectionArgs: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;?)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">return</span> database.delete(<span class="hljs-string">"users"</span>, selection, selectionArgs)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getType</span><span class="hljs-params">(uri: <span class="hljs-type">Uri</span>)</span></span>: String? {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"vnd.android.cursor.dir/vnd.com.example.myapp.users"</span>
    }
}
</code></pre>
<h3 data-id="heading-48">注册 ContentProvider</h3>
<p>为了让其他应用程序能够访问你的 <code>ContentProvider</code>，你必须在 <code>AndroidManifest.xml</code> 文件中对其进行声明。其中 <code>android:authority</code> 属性用于唯一标识你的 <code>ContentProvider</code>。</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">provider</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MyContentProvider"</span>
    <span class="hljs-attr">android:authorities</span>=<span class="hljs-string">"com.example.myapp.provider"</span>
    <span class="hljs-attr">android:exported</span>=<span class="hljs-string">"true"</span>
    <span class="hljs-attr">android:grantUriPermissions</span>=<span class="hljs-string">"true"</span> /&gt;</span>
</code></pre>
<h3 data-id="heading-49">从 ContentProvider 访问数据</h3>
<p>你可以使用 <code>ContentResolver</code> 类从另一个应用程序与 <code>ContentProvider</code> 进行交互。<code>ContentResolver</code> 提供了查询、插入、更新或删除数据的方法。</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">val</span> contentResolver = context.contentResolver

<span class="hljs-comment">// 查询数据</span>
<span class="hljs-keyword">val</span> cursor = contentResolver.query(
    Uri.parse(<span class="hljs-string">"content://com.example.myapp.provider/users"</span>),
    <span class="hljs-literal">null</span>,
    <span class="hljs-literal">null</span>,
    <span class="hljs-literal">null</span>,
    <span class="hljs-literal">null</span>
)

<span class="hljs-comment">// 插入数据</span>
<span class="hljs-keyword">val</span> values = ContentValues().apply {
    put(<span class="hljs-string">"name"</span>, <span class="hljs-string">"John Doe"</span>)
    put(<span class="hljs-string">"email"</span>, <span class="hljs-string">"johndoe@example.com"</span>)
}
contentResolver.insert(Uri.parse(<span class="hljs-string">"content://com.example.myapp.provider/users"</span>), values)
</code></pre>
<h3 data-id="heading-50">ContentProvider 的使用场景</h3>
<ul>
<li>在不同应用程序之间共享数据。</li>
<li>在应用启动过程中初始化组件或资源。</li>
<li>提供对结构化数据的访问，例如联系人、媒体文件或应用特定数据。</li>
<li>实现与 Android 系统功能的集成，例如联系人应用或文件选择器。</li>
<li>允许通过细粒度的安全控制进行数据访问。</li>
</ul>
<h3 data-id="heading-51">总结</h3>
<p><code>ContentProvider</code> 是在应用程序之间安全、高效地共享结构化数据的关键组件。它为数据访问提供了标准化接口，同时抽象了底层的数据存储机制。正确的实现和注册可以确保数据完整性、安全性，并与 Android 系统功能保持兼容。</p>
<h3 data-id="heading-52">进阶：使用 ContentProvider 初始化资源</h3>
<p><code>ContentProvider</code> 的另一个重要用途是：<strong>在应用启动时初始化资源或配置</strong>。</p>
<p>通常，资源或库的初始化是在 <code>Application</code> 类中完成的。但你可以将这部分逻辑封装到一个独立的 <code>ContentProvider</code> 中，以实现更好的职责分离。通过创建一个自定义的 <code>ContentProvider</code> 并在 <code>AndroidManifest.xml</code> 中注册它，可以高效地委托初始化任务。</p>
<p><code>ContentProvider</code> 的 <code>onCreate()</code> 方法会在 <code>Application.onCreate()</code> 之前被调用，因此是一个非常理想的早期初始化入口点。例如，<strong>Firebase SDK</strong> 就使用了一个自定义的 <code>ContentProvider</code> 来自动初始化 <strong>Firebase SDK</strong>。这种方式避免了在 <code>Application</code> 类中手动调用 <code>FirebaseApp.initializeApp(this)</code>。</p>
<p>以下是 <strong>Firebase</strong> 提供的一个示例实现：</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FirebaseInitProvider</span> <span class="hljs-title">extends</span> <span class="hljs-title">ContentProvider</span> {
    <span class="hljs-comment">/** 在 {<span class="hljs-doctag">@link</span> Application#onCreate()} 之前被调用。 */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> boolean onCreate() {
        <span class="hljs-keyword">try</span> {
            currentlyInitializing.<span class="hljs-keyword">set</span>(<span class="hljs-literal">true</span>);
            <span class="hljs-keyword">if</span> (FirebaseApp.initializeApp(getContext()) == <span class="hljs-literal">null</span>) {
                Log.i(TAG, <span class="hljs-string">"FirebaseApp initialization unsuccessful"</span>);
            } <span class="hljs-keyword">else</span> {
                Log.i(TAG, <span class="hljs-string">"FirebaseApp initialization successful"</span>);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">finally</span> {
            currentlyInitializing.<span class="hljs-keyword">set</span>(<span class="hljs-literal">false</span>);
        }
    }
}
</code></pre>
<p><code>FirebaseInitProvider</code> 在其 XML 文件中的注册方式如下所示：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">"http://schemas.android.com/tools"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 虽然 SDK 版本信息在 Gradle 构建文件中已捕获，但非 Gradle 构建仍需此配置 --&gt;</span>
    <span class="hljs-comment">&lt;!-- &lt;uses-sdk android:minSdkVersion="21"/&gt; --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">application</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">provider</span>
            <span class="hljs-attr">android:name</span>=<span class="hljs-string">"com.google.firebase.provider.FirebaseInitProvider"</span>
            <span class="hljs-attr">android:authorities</span>=<span class="hljs-string">"${applicationId}.firebaseinitprovider"</span>
            <span class="hljs-attr">android:directBootAware</span>=<span class="hljs-string">"true"</span>
            <span class="hljs-attr">android:exported</span>=<span class="hljs-string">"false"</span>
            <span class="hljs-attr">android:initOrder</span>=<span class="hljs-string">"100"</span> /&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span>
</code></pre>
<p>这种模式确保了关键资源或库能够在应用生命周期的早期自动完成初始化，从而实现更清晰、更模块化的设计。</p>
<p>另一个值得注意的 <code>ContentProvider</code> 用例是 <strong>Jetpack App Startup</strong> 库，它提供了一种简单高效的方式来在应用启动时初始化组件。其内部实现使用了一个名为 <code>InitializationProvider</code> 的类，该类利用 <code>ContentProvider</code> 来初始化所有实现了 <code>Initializer</code> 接口的预定义类。这确保了初始化逻辑在 <code>Application.onCreate()</code> 方法被调用之前就已经完成。</p>
<p>以下是 <code>InitializationProvider</code> 的内部实现，它是 <strong>Jetpack App Startup</strong> 库的核心组件：</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-comment">/**
 * The {<span class="hljs-doctag">@link</span> ContentProvider} which discovers {<span class="hljs-doctag">@link</span> Initializer}s in an application and    
 * initializes them before {<span class="hljs-doctag">@link</span> Application#onCreate()}.
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InitializationProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ContentProvider</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> getContext();
        <span class="hljs-keyword">if</span> (context != <span class="hljs-literal">null</span>) {
            <span class="hljs-type">Context</span> <span class="hljs-variable">applicationContext</span> <span class="hljs-operator">=</span> context.getApplicationContext();
            <span class="hljs-keyword">if</span> (applicationContext != <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">// Initialize all registered Initializer classes.</span>
                AppInitializer.getInstance(context).discoverAndInitialize(getClass());
            } <span class="hljs-keyword">else</span> {
                StartupLogger.w(<span class="hljs-string">"Deferring initialization because `applicationContext` is null."</span>);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StartupException</span>(<span class="hljs-string">"Context cannot be null"</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<p>该实现中的 <code>onCreate()</code> 方法会调用
<code>AppInitializer.getInstance(context).discoverAndInitialize(getClass())</code>，<br/>
它会自动发现并初始化所有已注册的 <code>Initializer</code> 实现类，<strong>在应用生命周期开始之前完成</strong>。<br/>
这确保了应用组件可以在不污染 <code>Application.onCreate()</code> 方法的情况下被高效地初始化。</p>
<hr/>
<h2 data-id="heading-53">如何处理配置变更</h2>
<p>处理配置变更对于保持流畅的用户体验至关重要，尤其是在屏幕旋转、语言切换、深色/浅色模式切换，以及字体大小或粗细调整等场景中。默认情况下，当这些变更发生时，Android 系统会重启 <code>Activity</code>，这可能导致临时 UI 状态的丢失。</p>
<h3 data-id="heading-54">面试问题</h3>
<p>处理配置变更有哪些不同的策略？</p>
<p><code>ViewModel</code> 在此类事件中如何帮助保存与 UI 相关的数据？</p>
<p><code>AndroidManifest.xml</code> 中的 <code>android:configChanges</code> 属性如何影响 <code>Activity</code> 的生命周期行为？</p>
<p>在哪些场景下应使用 <code>onConfigurationChanged()</code> 方法，而不是依赖 <code>Activity</code> 的重建？</p>
<h3 data-id="heading-55">实战</h3>
<p>为了有效应对这些变化，可以考虑以下策略：</p>
<ol>
<li><strong>保存和恢复 UI 状态</strong>：实现 <code>onSaveInstanceState()</code> 和 <code>onRestoreInstanceState()</code> 方法，以在 <code>Activity</code> 重建期间保存和恢复 UI 状态。这可以确保用户在配置变更后返回到相同的状态。</li>
<li><strong>使用 <code>ViewModel</code></strong>：利用 <code>ViewModel</code> 类来存储与 UI 相关的数据，这些数据可以在配置变更时存活。<code>ViewModel</code> 对象的设计目标是跨越 <code>Activity</code> 重建而存在，因此非常适合在这些事件中管理数据。</li>
<li><strong>手动处理配置变更</strong>：如果您的应用不需要在特定配置变更时更新资源，并且希望避免 <code>Activity</code> 重启，可以在 <code>AndroidManifest.xml</code> 中使用 <code>android:configChanges</code> 属性声明您的 <code>Activity</code> 所处理的配置变更。然后，重写 <code>onConfigurationChanged()</code> 方法以手动管理这些变更。</li>
<li><strong>在 Jetpack Compose 中使用 <code>rememberSaveable</code></strong>：在 Jetpack Compose 中，可以使用 <code>rememberSaveable</code> 来跨配置变更保存 UI 状态。它的工作方式类似于 <code>onSaveInstanceState()</code>，但专为 Compose 设计，有助于保持可组合函数状态的一致性。这块内容后续会讲到。</li>
</ol>
<h3 data-id="heading-56">额外提示</h3>
<ul>
<li><strong>导航与返回栈的保留</strong>：使用 <strong>Navigation</strong> 组件可以在配置变更时保留导航返回栈。</li>
<li><strong>避免存储与配置相关的数据</strong>：尽可能避免在 UI 层直接存储依赖于配置的值。建议使用 <code>ViewModel</code> 等替代方案，它专门设计用于在配置变更期间处理数据。</li>
</ul>
<h3 data-id="heading-57">总结</h3>
<p>正确处理配置变更对于提升用户体验至关重要，可以确保用户数据不会因意外情况而丢失。</p>
<hr/>
<h2 data-id="heading-58">内存泄漏</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df5bf1e72d6e43a08c77d42bc55ef374~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766623687&amp;x-signature=GUY6deFchG07hWDdt9VXuR%2FW4PY%3D" alt="11.png" loading="lazy"/></p>
<p>Android 通过一种<strong>垃圾回收（garbage collection）机制</strong>来管理内存，该机制会自动回收未使用的内存，从而确保活跃应用和服务的内存分配高效。它依赖于托管内存环境，这意味着开发者无需像在 C++ 等语言中那样手动分配和释放内存。</p>
<p><strong>Dalvik</strong> 或 <strong>ART</strong> 运行时会监控内存使用情况，清理不再被引用的对象，并防止过度的内存消耗。</p>
<p>当系统内存不足时，Android 会使用一个称为 <strong>低内存杀手（low-memory killer）</strong> 的机制来终止后台进程，以优先保证前台应用的流畅运行。开发者必须确保自己的应用能够高效地利用资源，以最小化对系统性能的影响。</p>
<h3 data-id="heading-59">面试问题</h3>
<p>应用程序中内存泄漏的常见原因有哪些？开发者如何预防它们？</p>
<p>Android 的垃圾回收机制是如何工作的？开发者可以使用哪些工具来检测和修复应用中的内存泄漏？</p>
<h3 data-id="heading-60">如何避免内存泄漏</h3>
<p>内存泄漏发生在应用程序持有对不再需要的对象的引用时，这会阻止垃圾回收器回收内存。常见原因包括：生命周期管理不当、静态引用，或长时间持有对 <code>Context</code> 的引用。</p>
<h3 data-id="heading-61">最佳实践</h3>
<ol>
<li><strong>使用生命周期感知组件</strong>：利用 <code>ViewModel</code>、<code>Flow</code> 配合 <code>collectAsStateWithLifecycle</code> 或 <code>LiveData</code> 等生命周期感知组件，可确保在相关生命周期结束时资源被正确释放。这些组件会在关联的生命周期不再活跃或进入特定状态时自动管理清理工作。</li>
<li><strong>避免持有 <code>Context</code> 的引用</strong>：避免在静态字段或单例等长生命周期对象中保留对 <code>Activity</code> 或 <code>Context</code> 的引用。应尽可能使用 <code>ApplicationContext</code>，因为它不与 <code>Activity</code> 或 <code>Fragment</code> 的生命周期绑定。</li>
<li><strong>注销监听器和回调</strong>：始终在适当的生命周期方法中注销监听器、观察者或回调。例如，在 <code>onPause()</code> 或 <code>onStop()</code> 中注销 <code>BroadcastReceiver</code>。</li>
<li><strong>对非关键对象使用弱引用（<code>WeakReference</code>）</strong> ：对于不需要强引用的对象，使用 <code>WeakReference</code>。这允许垃圾回收器在需要内存时回收这些对象。</li>
<li><strong>使用工具检测内存泄漏</strong>：使用如 <strong>LeakCanary</strong> 这类工具在开发过程中识别并修复内存泄漏。该工具能揭示哪些对象导致了内存泄漏以及如何解决。此外，你还可以使用 Android Studio 中的 <strong>Memory Profiler</strong> 来帮助识别可能导致卡顿、冻结甚至应用崩溃的内存泄漏和内存抖动问题。</li>
<li><strong>避免对 <code>View</code> 的静态引用</strong>：不应将 <code>View</code> 存储在静态字段中，因为这会通过持有 <code>Activity</code> 的上下文而导致内存泄漏。</li>
<li><strong>及时关闭资源</strong>：当资源不再需要时，务必显式释放文件流、游标或数据库连接等资源。例如，在数据库查询后应关闭游标。</li>
<li><strong>合理使用 <code>Fragment</code> 和 <code>Activity</code></strong>：避免过度使用 <code>Fragment</code> 或在它们之间错误地持有引用。应在 <code>onDestroyView()</code> 或 <code>onDetach()</code> 中清理 <code>Fragment</code> 的引用。</li>
</ol>
<h3 data-id="heading-62">总结</h3>
<p>Android 的内存管理机制高效，但要求开发者遵循最佳实践以防止内存泄漏。使用生命周期感知组件、避免对 <code>Context</code> 或 <code>View</code> 的静态引用，并借助如 <strong>LeakCanary</strong> 等工具，可以显著降低内存泄漏的风险。在适当的生命周期事件中进行资源管理和清理，有助于确保应用性能更流畅、用户体验更佳。</p>
<hr/>
<h2 data-id="heading-63">难搞的 ANR</h2>
<p><strong>ANR</strong>（Application Not Responding，应用无响应）是 Android 中的一种错误，当应用程序的主线程（即 UI 线程）被阻塞超过一定时间（通常为<strong>5秒或更长</strong>）时就会发生。当出现 <strong>ANR</strong> 时，Android 会提示用户选择关闭应用或等待其响应。<strong>ANR</strong> 会严重影响用户体验，其常见原因包括：</p>
<ul>
<li>在主线程上执行耗时超过<strong>5秒</strong>的复杂计算（即阻塞主线程<strong>5秒</strong>）；</li>
<li>执行长时间的网络或数据库操作；</li>
<li>阻塞 UI 操作（例如，在 UI 线程上执行同步操作）。</li>
</ul>
<h3 data-id="heading-64">面试问题</h3>
<p>如何检测和诊断 ANR？</p>
<p>如何优化应用性能以改善用户体验？</p>
<h3 data-id="heading-65">如何防止 ANR</h3>
<p>要防止 <strong>ANR</strong>，关键在于保持主线程的响应性，通过将耗时或计算密集型任务移出主线程来实现。以下是一些最佳实践：</p>
<ol>
<li><strong>将耗时任务移出主线程</strong>：使用后台线程（如 <code>AsyncTask</code>、<code>Executors</code> 或 <code>Thread</code>）处理文件 I/O、网络请求或数据库操作等任务。对于更现代且安全的方法，建议使用 Kotlin 协程配合 <code>Dispatchers.IO</code> 来高效管理后台任务。</li>
<li><strong>使用 <code>WorkManager</code> 处理持久性任务</strong>：对于需要在后台运行的任务（如数据同步），使用 <code>WorkManager</code>。该 API 可确保任务在主线程之外被调度和执行。</li>
<li><strong>优化数据获取</strong>：实现分页机制，以高效处理大型数据集，每次只获取小块可管理的数据，避免 UI 过载并提升性能。</li>
<li><strong>减少配置变更期间的 UI 操作</strong>：利用 <code>ViewModel</code> 保存与 UI 相关的数据，避免在屏幕旋转等配置变更时发生不必要的 UI 重新加载。</li>
<li><strong>使用 Android Studio 进行监控和性能分析</strong>：借助 <strong>Android Studio Profiler</strong> 工具监控 CPU、内存和网络使用情况。这些工具有助于识别和解决可能导致 <strong>ANR</strong> 的性能瓶颈。</li>
<li><strong>避免阻塞调用</strong>：防止在主线程上执行长时间循环、睡眠调用或同步网络请求，以确保应用运行流畅。</li>
<li><strong>使用 <code>Handler</code> 实现短延迟</strong>：使用 <code>Handler.postDelayed()</code> 而不是 <code>Thread.sleep()</code> 来引入短暂延迟，从而避免阻塞主线程，保持应用响应性。</li>
</ol>
<h3 data-id="heading-66">总结</h3>
<p><strong>ANR</strong> 是 Android 中的一种错误，当应用的主线程（UI 线程）被阻塞超过<strong>5秒或更长时间</strong>时就会发生，这会降低用户体验并丢失当前用户状态。为防止 <strong>ANR</strong>，应通过将耗时工作移至后台线程（如网络请求、数据库查询和复杂计算）来保持主线程轻量。同时，可以优化数据操作，并使用 <strong>Android Studio Profiler</strong> 对应用进行性能分析。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[适合很多公司和团队的 AI Coding 落地范式（一）]]></title>    <link>https://juejin.cn/post/7584714813365747750</link>    <guid>https://juejin.cn/post/7584714813365747750</guid>    <pubDate>2025-12-18T00:53:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584714813365747750" data-draft-id="7584655946087759918" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="适合很多公司和团队的 AI Coding 落地范式（一）"/> <meta itemprop="keywords" content="前端,AIGC,AI编程"/> <meta itemprop="datePublished" content="2025-12-18T00:53:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LV技术派"/> <meta itemprop="url" content="https://juejin.cn/user/2013961035453927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            适合很多公司和团队的 AI Coding 落地范式（一）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2013961035453927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LV技术派
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:53:22.000Z" title="Thu Dec 18 2025 00:53:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"「"}.markdown-body b:after,.markdown-body strong:after{content:"」"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><p>大家好，我是 lv。</p>
<p>我从 0 ～ 1 探索前端 AI 落地，到现在已经 3 年多时间了。</p>
<p>从一开始的 V0、Bolt、Github Copilot、Devin 等 <strong>AI Coding 平台</strong>，到现在市面上成熟的 <strong>AI Coding 基建</strong>，如 Cursor 、Claude Code 等。</p>
<p>不同的产品形态都有自己的受众人群、面向的场景、以及解决的问题。</p>
<p>下面这个系列，<strong>总共两篇文章</strong>，我们来探讨，基于不同形态的 AI Coding 产品，适合很多公司和团队的 AI Coding 落地范式。</p>
<p>有同学也已经在团队内部落地实施了这套范式。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29894879f12c4c0c9824d26e77c01885~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTFbmioDmnK_mtL4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624001&amp;x-signature=Mh%2BgyxXquABmCKtwVmO8s1P1kUo%3D" alt="" loading="lazy"/></p>
<p>不多说，开始<strong>第一篇</strong>～</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fai.iamlv.cn%2Fme.html" target="_blank" title="https://ai.iamlv.cn/me.html" ref="nofollow noopener noreferrer">欢迎加入最懂 AI 的前端伙伴们群</a></p>
<h2 data-id="heading-0">AI Coding 生态现状</h2>
<p>现在市面上的 AI Coding 产品，我们划分为两大类型：</p>
<ul>
<li>AI Coding 平台类产品：如 Bolt New、V0、Lovable、<strong>Compoder</strong> 等。</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3766f0b0bfd846c8b83a04f53b51eae9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTFbmioDmnK_mtL4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624001&amp;x-signature=Rnnw%2BXKKeGqVN%2FdnGl1lY6iRsLc%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>Compoder 是一个 AI 驱动的组件代码生成引擎，可以基于它定制基于特定技术栈（React、Vue、开源组件库、私有组件库）、特定业务场景（landing page 等）的组件代码生成器。</p>
<p>详见: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIamLiuLv%2Fcompoder" target="_blank" title="https://github.com/IamLiuLv/compoder" ref="nofollow noopener noreferrer">github.com/IamLiuLv/co…</a></p>
</blockquote>
<ul>
<li>AI Coding 基建类产品：具有代表性的如 Cursor、Claude Code 等，这也是程序员现在日常工作都高频使用的产品。</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03e48f1b9888411d984334b89829ec9a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTFbmioDmnK_mtL4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624001&amp;x-signature=FcF0rtdxJ4y4nu4lMHh4Mvr9QNM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-1">不同产品形态的侧重点</h3>
<p>先聊 AI Coding 平台类产品，平台方（V0、Bolt New、Lovable、Compoder）已经内置了一整套产品研发的环境，同时把 AI 融入到了这个研发的环境中。</p>
<p>作为用户来说，核心的三个步骤就是：</p>
<p>1、输入需求（prompt）</p>
<p>2、查看效果（preview）</p>
<p>3、发布上线（deploy）</p>
<p>中间的<strong>代码生成、代码运行环境、代码执行效果、构建发布</strong>等，这都都交给了平台方。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/146e04d734d6496f931d4ee8630b9b53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTFbmioDmnK_mtL4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624001&amp;x-signature=tc3WyntUzLC8Q7nf9L3u0WTcgo8%3D" alt="" loading="lazy"/></p>
<p>那作为 AI Coding 基建来说，其实本质上就是把 AI 生成代码的能力集成到了现有程序员的编码环境中来。</p>
<p>对于开发人员来说，相当于在产品研发的各个环节多个一个很强的 AI 助手，随时提供帮助。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e64e888036eb4947992ed98a70bd58e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTFbmioDmnK_mtL4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624001&amp;x-signature=xhVuUaIpCFucLGZBb9N3jya0lm8%3D" alt="" loading="lazy"/></p>
<p>所以这种 AI Coding 基础建的产品形态作为程序员来说，用起来的心智负担会更小。</p>
<p>下面我们来聊下他们的优缺点。</p>
<h3 data-id="heading-2">不同产品形态的优缺点</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d7e289ca89240c385eaaf04c96522e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTFbmioDmnK_mtL4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624001&amp;x-signature=II8VuGUDCgzLZ0UUMFh8jk5Fkjw%3D" alt="" loading="lazy"/></p>
<p>总结起来一句话：AI Coding 平台类产品的<strong>门槛低，但灵活性有限</strong>，AI Coding 基建类产品的<strong>门槛相对较高，同时灵活性也更高</strong>。</p>
<blockquote>
<p>这里的优缺点是这两类产品相比较于对方来说的。</p>
</blockquote>
<p>举一个例子：</p>
<p>我们可以基于 V0 快速生成一个产品的原型代码出来，也可以迅速发布上线到 Vercel 平台上。</p>
<p>如果原型代码本身不需要进行后续的维护和迭代，保持当前的形态，那 V0 产品就足够了。</p>
<p>但是如果我们进行后续的迭代开发，那么 V0 产品就不太能够满足需求了。</p>
<p>首先从技术栈来说，V0 大概率生成的是 nextjs + shadcnui 技术栈的代码（自家产品，自产自销），如果公司团队内部使用的是其它技术栈，那基于 V0 定制特定技术栈的代码就比较麻烦了。</p>
<p><strong>这里加一句</strong>，Compoder 产品的<strong>其中一个形态</strong>是属于 AI Coding 平台类的产品，和市面上其他 AI Coding 平台类产品对比起来，灵活性会更高，用户可以基于 Compoder 定制基于特定技术栈、代码规范的代码生成器，具体我们下一篇文章再探讨。</p>
<p>言归正传。</p>
<p>所以对于需要进行长期迭代的项目来说，AI Coding 基建类产品会更加合适。</p>
<p>比如说，我可以基于 Cursor 的 Rules 能力，定制化出一套符合公司内部研发规范的代码生成规则，然后基于这套规则，我可以快速生成符合公司内部研发流程的代码。</p>
<p>尤其是在基于已有复杂项目的迭代场景下，我们需要深入到代码实现细节进行调节，那就需要很灵活的 AI 辅助能力来配合。</p>
<p>如果我选择的是 Cursor，那我的迭代开发路径大概是：<strong>Vibing =&gt; Plan =&gt; Coding</strong></p>
<p><strong>Vibing：</strong> 在 Chat 模式下，和 AI 聊天，梳理需求、讨论方案。</p>
<p><strong>Plan：</strong> 在 Plan 模式下，规划具体的技术方案实现路径，具体到针对哪些文件进行哪些更高。</p>
<p><strong>Coding：</strong> 基于 Plan 出来的技术方案实现路径，Agent Build 实际的代码。</p>
<h3 data-id="heading-3">不同产品形态面向的人群</h3>
<p>基于以上分析，我们可以理解不同产品形态面向的人群大致分布情况。</p>
<p>下图中的 75% 和 25%，不代表实际的值，只是为了方便对比。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02813fba4aee4343b1c93949ca07a6df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTFbmioDmnK_mtL4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766624001&amp;x-signature=148QbE2iJdlh8AYiOmv67jysGDM%3D" alt="" loading="lazy"/></p>
<p>AI Coding 基建类产品，<strong>程序员</strong>是绝对的主力军，占了大多数。</p>
<p>AI Coding 平台类产品，面向的人群大部分是 <strong>非程序员</strong>，尤其是程序员的上游岗，如产品经理、设计师、运营等。</p>
<h2 data-id="heading-4">适合很多公司和团队的 AI Coding 落地范式</h2>
<p>不同形态的 AI Coding 产品，在公司和团队中，面向的人群，解决的问题场景是不同的。</p>
<p>了解了不同 AI Coding 产品的不同形态、特征、优缺点和面向的人群之后。</p>
<p>下一篇文章，我们来探讨，AI Coding 平台类产品、以及 AI Coding 基建类产品，在公司和团队中，落地的范式是什么样的。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[领域驱动设计（DDD）：从业务复杂性到代码结构的系统性解法]]></title>    <link>https://juejin.cn/post/7584987267266445322</link>    <guid>https://juejin.cn/post/7584987267266445322</guid>    <pubDate>2025-12-18T00:58:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584987267266445322" data-draft-id="7584730308752080946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="领域驱动设计（DDD）：从业务复杂性到代码结构的系统性解法"/> <meta itemprop="keywords" content="架构"/> <meta itemprop="datePublished" content="2025-12-18T00:58:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="自由生长2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            领域驱动设计（DDD）：从业务复杂性到代码结构的系统性解法
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    自由生长2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T00:58:12.000Z" title="Thu Dec 18 2025 00:58:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>摘要：领域驱动设计（DDD）是一种以业务为核心、应对复杂系统的软件开发方法论。通过统一语言、限界上下文和领域建模，DDD 帮助团队构建高内聚、可演进的系统架构，尤其适用于微服务与长期维护的业务场景。</p>
<h2 data-id="heading-0">领域驱动设计（DDD）：从业务复杂性到代码结构的系统性解法</h2>
<hr/>
<h3 data-id="heading-1">引言：为什么我们总在“救火”？</h3>
<p>你是否经历过以下场景？</p>
<ul>
<li>产品经理说“加个优惠券功能”，结果你发现要改 10 个 Service、5 个 Controller 和一堆数据库字段；</li>
<li>新人入职三个月还搞不清“用户”“客户”“账户”到底是不是同一个东西；</li>
<li>微服务拆分后，订单服务和库存服务互相调用，形成“分布式大泥球”；</li>
<li>系统上线三年，没人敢动核心逻辑，因为“一改就崩”。</li>
</ul>
<p>这些问题的根源，往往不是技术不够新，而是<strong>软件没有真正反映业务的本质</strong>。</p>
<p>而 <strong>领域驱动设计（Domain-Driven Design, DDD）</strong>，正是为解决这类“业务复杂性”而生的一套系统性方法论。</p>
<hr/>
<h3 data-id="heading-2">一、DDD 是什么？它真的是“新东西”吗？</h3>
<p>很多人以为 DDD 是近几年微服务热潮带火的“新概念”。其实不然。</p>
<p>DDD 由 <strong>Eric Evans</strong> 在 <strong>2003 年</strong> 的经典著作《Domain-Driven Design: Tackling Complexity in the Heart of Software》中首次系统提出。它的核心理念是：</p>
<blockquote>
<p><strong>让软件成为业务的精准映射，而非技术堆砌。</strong></p>
</blockquote>
<p>近年来，随着微服务、云原生、高内聚低耦合架构的普及，DDD 的价值被重新发现——它恰好为<strong>如何合理划分服务边界、如何建模复杂业务</strong>提供了理论支撑。</p>
<p>所以，DDD 不是新潮流，而是<strong>被时代重新需要的老智慧</strong>。</p>
<hr/>
<h3 data-id="heading-3">二、DDD 的核心思想：以业务为中心</h3>
<p>传统开发流程常是：</p>
<pre><code class="hljs">需求 → 数据库设计 → API 接口 → 业务逻辑填充
</code></pre>
<p>而 DDD 主张：</p>
<pre><code class="hljs">深入理解业务 → 提炼统一语言 → 划分限界上下文 → 构建领域模型 → 技术实现
</code></pre>
<h4 data-id="heading-4">关键转变：</h4>
<ul>
<li><strong>从“数据驱动”转向“行为驱动”</strong></li>
<li><strong>从“技术术语”转向“业务术语”</strong></li>
<li><strong>从“全局一张表”转向“局部一致性”</strong></li>
</ul>
<hr/>
<h3 data-id="heading-5">三、DDD 的两大支柱：战略设计 + 战术设计</h3>
<h4 data-id="heading-6">1. 战略设计（Strategic Design）—— 宏观架构</h4>
<h5 data-id="heading-7">✅ 统一语言（Ubiquitous Language）</h5>
<ul>
<li>开发、产品、业务专家使用<strong>完全一致的术语</strong>。</li>
<li>例如：全团队都称“购物车项”为 <code>CartItem</code>，而不是有的叫 <code>OrderLine</code>，有的叫 <code>ProductItem</code>。</li>
<li><strong>代码中的类名、方法名、变量名，必须来自这套语言。</strong></li>
</ul>
<h5 data-id="heading-8">✅ 限界上下文（Bounded Context）</h5>
<ul>
<li>将庞大系统划分为多个<strong>业务边界清晰的子域</strong>。</li>
<li>每个上下文拥有独立的模型、规则和数据。</li>
<li>示例：电商系统可划分为：
<ul>
<li>用户上下文（User）</li>
<li>订单上下文（Order）</li>
<li>支付上下文（Payment）</li>
<li>库存上下文（Inventory）</li>
</ul>
</li>
</ul>
<blockquote>
<p>⚠️ 上下文之间通过<strong>防腐层（Anti-Corruption Layer）</strong> 集成，避免模型污染。</p>
</blockquote>
<hr/>
<h4 data-id="heading-9">2. 战术设计（Tactical Design）—— 微观建模</h4>
<p>在每个限界上下文中，使用以下构件构建领域模型：</p>








































<table><thead><tr><th>构件</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><strong>实体（Entity）</strong></td><td>有唯一标识的对象，生命周期长</td><td><code>Order(id=123)</code></td></tr><tr><td><strong>值对象（Value Object）</strong></td><td>无 ID，靠属性值判断相等</td><td><code>Address("北京", "朝阳")</code></td></tr><tr><td><strong>聚合（Aggregate）</strong></td><td>一组对象的集合，由<strong>聚合根</strong>保证一致性</td><td><code>Order</code> 聚合包含 <code>OrderItems</code></td></tr><tr><td><strong>领域服务（Domain Service）</strong></td><td>跨多个实体的业务逻辑</td><td><code>PromotionCalculator</code></td></tr><tr><td><strong>仓储（Repository）</strong></td><td>提供聚合的“集合式”访问接口</td><td><code>OrderRepository.save(order)</code></td></tr><tr><td><strong>领域事件（Domain Event）</strong></td><td>表达业务上发生的事实</td><td><code>OrderPaidEvent</code></td></tr></tbody></table>
<blockquote>
<p>💡 <strong>关键原则</strong>：业务逻辑应尽可能放在<strong>领域模型内部</strong>（充血模型），而非 Service 层（贫血模型）。</p>
</blockquote>
<hr/>
<h3 data-id="heading-10">四、代码组织：模块化 ≠ DDD，但它是 DDD 的自然结果</h3>
<p>很多团队会说：“我们把订单相关的 Controller、Service、DB 都放在一起了，这就是 DDD。”</p>
<p>这其实是<strong>对 DDD 的常见误解</strong>。</p>
<h4 data-id="heading-11">✅ 正确认知：</h4>
<ul>
<li><strong>按功能/上下文垂直切分代码目录</strong>，是 DDD <strong>落地后的工程体现</strong>，但不是 DDD 本身。</li>
<li>它反映了“限界上下文”的物理边界，是一种<strong>架构对齐业务</strong>的良好实践。</li>
</ul>
<h5 data-id="heading-12">推荐的模块化结构（以订单为例）：</h5>
<pre><code class="hljs language-bash" lang="bash">src/
└── order/                     <span class="hljs-comment"># 限界上下文：订单</span>
    ├── api/                   <span class="hljs-comment"># 接口层（Controller, DTO）</span>
    ├── application/           <span class="hljs-comment"># 应用层（用例编排，事务控制）</span>
    ├── domain/                <span class="hljs-comment"># 领域层（核心！）</span>
    │   ├── model/             <span class="hljs-comment"># 实体、值对象、聚合</span>
    │   ├── service/           <span class="hljs-comment"># 领域服务</span>
    │   └── repository/        <span class="hljs-comment"># 仓储接口（抽象）</span>
    └── infrastructure/        <span class="hljs-comment"># 基础设施实现</span>
        ├── persistence/       <span class="hljs-comment"># DB 实现（如 MyBatis/JPA）</span>
        └── mq/                <span class="hljs-comment"># 消息队列适配</span>
</code></pre>
<p>对比传统分层结构：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ❌ 传统分层（技术导向）</span>
controller/
service/
repository/
entity/
</code></pre>
<blockquote>
<p>垂直分包让<strong>业务变更的影响范围局部化</strong>，极大提升可维护性。</p>
</blockquote>
<hr/>
<h3 data-id="heading-13">五、DDD 适合什么场景？</h3>
<h4 data-id="heading-14">✅ 推荐使用 DDD 的情况：</h4>
<ul>
<li>业务规则复杂、频繁变化（如金融、保险、电商促销）</li>
<li>系统需长期演进（3 年以上）</li>
<li>多团队协作，需明确边界</li>
<li>正在设计微服务，需要合理的服务划分依据</li>
</ul>
<h4 data-id="heading-15">❌ 不建议强行使用 DDD 的情况：</h4>
<ul>
<li>简单 CRUD 系统（如后台管理、报表导出）</li>
<li>快速原型或短期项目</li>
<li>团队缺乏业务专家参与</li>
</ul>
<blockquote>
<p><strong>DDD 的成本在于前期建模和沟通，收益在于长期可维护性。</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-16">六、DDD 与微服务的关系</h3>
<p>DDD 并不等于微服务，但它是<strong>微服务划分的最佳指南</strong>。</p>
<ul>
<li><strong>一个限界上下文 ≈ 一个微服务</strong>（理想情况下）</li>
<li>上下文之间的集成方式（API、事件、共享数据库）决定了微服务的耦合度</li>
<li>领域事件天然支持<strong>事件驱动架构（EDA）</strong>，实现服务解耦</li>
</ul>
<blockquote>
<p>没有 DDD 指导的微服务，很容易变成“分布式单体”。</p>
</blockquote>
<hr/>
<h3 data-id="heading-17">七、实践建议：如何开始 DDD？</h3>
<ol>
<li><strong>从小处着手</strong>：选一个核心子域（如“订单创建”）试点</li>
<li><strong>拉通业务与技术</strong>：组织“事件风暴（Event Storming）”工作坊，识别命令、事件、聚合</li>
<li><strong>先建模型，再写代码</strong>：用白板画出实体关系和业务流程</li>
<li><strong>拒绝贫血模型</strong>：让 <code>Order</code> 自己知道如何计算总价、能否取消</li>
<li><strong>持续演进</strong>：DDD 不是一次性设计，而是随业务一起成长</li>
</ol>
<hr/>
<h3 data-id="heading-18">结语：DDD 不是银弹，但它是照亮复杂性的灯</h3>
<p>DDD 不会自动让你写出高性能、零 bug 的代码。<br/>
但它能帮你回答一个更根本的问题：</p>
<blockquote>
<p><strong>“我们到底在做什么业务？”</strong></p>
</blockquote>
<p>当你的代码不仅能运行，还能“说话”——当新成员读代码就能理解业务规则，当产品经理看到类图就点头说“对，就是这样”——你就真正走上了 DDD 之路。</p>
<p>正如 Eric Evans 所言：</p>
<blockquote>
<p>“<strong>优秀的软件不是构建出来的，而是演化出来的。</strong>”</p>
</blockquote>
<p>而 DDD，就是那套帮助我们在混沌中找到秩序的演化指南。</p>
<hr/>
<h4 data-id="heading-19">延伸阅读</h4>
<ul>
<li>《Domain-Driven Design: Tackling Complexity in the Heart of Software》— Eric Evans</li>
<li>《Implementing Domain-Driven Design》— Vaughn Vernon</li>
<li>事件风暴（Event Storming）工作坊实践</li>
<li>六边形架构 / 洋葱架构 / Clean Architecture</li>
</ul>
<hr/>
<p><strong>欢迎在评论区分享你的 DDD 实践故事或困惑~</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[你看到什么，决定你成为什么]]></title>    <link>https://juejin.cn/post/7584987267266461706</link>    <guid>https://juejin.cn/post/7584987267266461706</guid>    <pubDate>2025-12-18T01:01:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584987267266461706" data-draft-id="7584730308752113714" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="你看到什么，决定你成为什么"/> <meta itemprop="keywords" content="AI编程"/> <meta itemprop="datePublished" content="2025-12-18T01:01:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HBLOG"/> <meta itemprop="url" content="https://juejin.cn/user/131597124767479"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            你看到什么，决定你成为什么
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/131597124767479/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HBLOG
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-18T01:01:49.000Z" title="Thu Dec 18 2025 01:01:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>同一件事，放在不同的人眼里，会变成完全不同的意义。</p>
<p>最近，我做了一个 App。<br/>
从 0 到 1，一个人，用 AI 辅助开发，完成产品、调试、打包、提交审核，最后成功上架 App Store。</p>
<p>当我把它分享出去后，我收到了两种截然不同的反馈。</p>
<p>第一种人说：</p>
<blockquote>
<p>“你是小白，却真的把一个 App 做出来并上架了，太厉害了。”<br/>
“原来普通人也可以做到这一点。”<br/>
“这让我开始相信，我也可以试试。”</p>
</blockquote>
<p>第二种人说：</p>
<blockquote>
<p>“界面有点丑。”<br/>
“这个按钮不太好看。”<br/>
“设计感不行。”</p>
</blockquote>
<p>没有对错。<br/>
但这两种声音，背后是<strong>两种完全不同的人生视角</strong>。</p>
<h3 data-id="heading-0">有些人，看见的是「路」</h3>
<p>他们看到的是：</p>
<ul>
<li>从零开始的勇气</li>
<li>不懂技术却愿意学习的决心</li>
<li>跌跌撞撞也要把事情做完的执行力</li>
</ul>
<p>他们不会先问“完不完美”，<br/>
他们更关心的是：</p>
<blockquote>
<p><strong>“原来这条路真的存在。”</strong></p>
</blockquote>
<p>这样的人，眼里装着的是可能性。<br/>
他们的人生里，世界是可被尝试的，是能被突破的。</p>
<p>所以他们往前走。</p>
<h3 data-id="heading-1">有些人，看见的是「缺点」</h3>
<p>他们也很聪明，也很敏锐。<br/>
他们能迅速发现问题、瑕疵、不足。</p>
<p>但可惜的是——<br/>
他们习惯站在终点，去否定起点。<br/>
站在岸上，去点评下水的人。</p>
<p>他们看到的是：</p>
<ul>
<li>哪里不够好</li>
<li>哪里不符合自己的审美</li>
<li>哪里“还差得远”</li>
</ul>
<p>这样的人，眼里装着的是评判。<br/>
而评判，往往替代了行动。</p>
<p>于是他们停在原地。</p>
<h3 data-id="heading-2">真正拉开人与人差距的，不是能力</h3>
<p>而是你<strong>习惯用什么角度看世界</strong>。</p>
<ul>
<li>你是看到“这件事我能不能学到什么”</li>
<li>还是看到“这件事配不配得上我的标准”</li>
<li>你是被“有人做到了”点燃</li>
<li>还是被“做得还不够好”劝退</li>
</ul>
<p>你看到什么，<br/>
会一点点塑造你的心态，<br/>
而心态，最终会把你带到不同的地方。</p>
<h3 data-id="heading-3">我的 App 并不完美</h3>
<p>界面确实不惊艳，<br/>
功能也在慢慢打磨。</p>
<p>但它真实存在。<br/>
它是我从犹豫、怀疑、自我否定中，一步步走出来的结果。</p>
<p>它不是终点，<br/>
它只是证明了一件事：</p>
<blockquote>
<p><strong>普通人，只要愿意开始，也能走到 1。</strong></p>
</blockquote>
<h3 data-id="heading-4">我想说的，不只是 App</h3>
<p>而是这句话：</p>
<blockquote>
<p><strong>你看到什么，决定你成为什么。</strong></p>
</blockquote>
<p>如果你总是看到希望，<br/>
你的人生就会多出很多条路。</p>
<p>如果你总是忙着挑错，<br/>
你可能会永远站在原地，等一个“完美的开始”。</p>
<p>而这个世界，<br/>
从来不会把完美，送给不愿出发的人。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Docker 容器实现按顺序启动]]></title>    <link>https://juejin.cn/post/7584651851905597459</link>    <guid>https://juejin.cn/post/7584651851905597459</guid>    <pubDate>2025-12-17T23:22:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584651851905597459" data-draft-id="7584714813365174310" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Docker 容器实现按顺序启动"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-17T23:22:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="风象南"/> <meta itemprop="url" content="https://juejin.cn/user/2524134428655159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Docker 容器实现按顺序启动
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524134428655159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    风象南
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T23:22:29.000Z" title="Wed Dec 17 2025 23:22:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在日常开发和运维中，我们会遇到这样的需求：<strong>多个 Docker 容器需要按特定顺序启动</strong>。例如，应用依赖数据库，消息队列依赖服务初始化等，如果顺序启动不当，可能导致容器无法正常运行或出现错误。</p>
<h2 data-id="heading-0">问题背景</h2>
<p>假设有三个服务：</p>
<p><strong>1.数据库服务（MySQL）</strong></p>
<p><strong>2.缓存服务（Redis）</strong></p>
<p><strong>3.应用服务（Spring Boot Web 应用）</strong></p>
<p>如果应用服务在数据库或缓存尚未就绪时启动，就会出现启动失败或报错。传统 Docker 启动方式（<code>docker run -d</code>）是异步启动的，无法保证顺序。</p>
<h2 data-id="heading-1">实现思路</h2>
<p>按顺序启动 Docker 容器，主要有以下几种方法：</p>
<p><strong>1.使用 Docker Compose <code>depends_on</code></strong></p>
<p><strong>2.在容器入口脚本中等待依赖就绪</strong></p>
<p><strong>3.使用外部脚本（Shell/Makefile）控制启动顺序</strong></p>
<h4 data-id="heading-2">1. Docker Compose <code>depends_on</code></h4>
<p>Docker Compose 提供了 <code>depends_on</code> 配置，可以指定启动依赖：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">"3.9"</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">mysql:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"3306:3306"</span>

  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:7.0</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"6379:6379"</span>

  <span class="hljs-attr">app:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">my-springboot-app:latest</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:8080"</span>
</code></pre>
<p><strong>注意：</strong></p>
<ul>
<li><code>depends_on</code> 只保证 <strong>容器启动顺序</strong>，并不能保证依赖服务就绪。</li>
<li>如果数据库启动慢，应用服务可能仍然启动失败。</li>
</ul>
<h4 data-id="heading-3">2. 容器入口脚本等待依赖</h4>
<p>为解决“容器启动顺序不等于服务就绪”的问题，可以在应用容器的入口脚本中增加 <strong>依赖等待逻辑</strong>：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># wait-for.sh</span>

<span class="hljs-comment"># 等待 MySQL 启动</span>
until nc -z -v -w30 mysql 3306; <span class="hljs-keyword">do</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Waiting for MySQL..."</span>
  <span class="hljs-built_in">sleep</span> 3
<span class="hljs-keyword">done</span>

<span class="hljs-comment"># 等待 Redis 启动</span>
until nc -z -v -w30 redis 6379; <span class="hljs-keyword">do</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Waiting for Redis..."</span>
  <span class="hljs-built_in">sleep</span> 3
<span class="hljs-keyword">done</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"All dependencies are up. Starting application..."</span>
java -jar /app/my-springboot-app.jar
</code></pre>
<p>然后在 Dockerfile 中：</p>
<pre><code class="hljs language-perl" lang="perl">COPY <span class="hljs-keyword">wait</span>-for.sh /<span class="hljs-keyword">wait</span>-for.sh
RUN <span class="hljs-keyword">chmod</span> +<span class="hljs-keyword">x</span> /<span class="hljs-keyword">wait</span>-for.sh
ENTRYPOINT [<span class="hljs-string">"/wait-for.sh"</span>]
</code></pre>
<p>优点：</p>
<ul>
<li>可以保证服务依赖完全就绪后再启动应用</li>
<li>支持多层级依赖</li>
</ul>
<h4 data-id="heading-4">3. 外部脚本控制启动顺序</h4>
<p>如果不使用 Compose，也可以用 Shell 脚本控制容器按顺序启动：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

docker run -d --name mysql -e MYSQL_ROOT_PASSWORD=root mysql:8.0
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Waiting for MySQL..."</span>
<span class="hljs-built_in">sleep</span> 20  <span class="hljs-comment"># 简单等待，或使用健康检查循环</span>

docker run -d --name redis redis:7.0
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Waiting for Redis..."</span>
<span class="hljs-built_in">sleep</span> 10

docker run -d --name app --<span class="hljs-built_in">link</span> mysql --<span class="hljs-built_in">link</span> redis my-springboot-app:latest
</code></pre>
<p><strong>改进版</strong>：可以使用 <code>docker inspect</code> 检查容器健康状态，动态判断是否就绪，而不是固定 sleep 时间。</p>
<h4 data-id="heading-5">4. 健康检查 + Compose 等待策略</h4>
<p>在 Docker Compose 中可以使用 <code>healthcheck</code> 配合 <code>depends_on</code> 条件：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">services:</span>
  <span class="hljs-attr">mysql:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">healthcheck:</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD"</span>, <span class="hljs-string">"mysqladmin"</span>, <span class="hljs-string">"ping"</span>, <span class="hljs-string">"-h"</span>, <span class="hljs-string">"localhost"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">5s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">5</span>

  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:7.0</span>
    <span class="hljs-attr">healthcheck:</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD"</span>, <span class="hljs-string">"redis-cli"</span>, <span class="hljs-string">"ping"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">5s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">5</span>

  <span class="hljs-attr">app:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">my-springboot-app:latest</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-attr">mysql:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">service_healthy</span>
      <span class="hljs-attr">redis:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">service_healthy</span>
</code></pre>
<p>优点：</p>
<ul>
<li>自动等待依赖容器健康</li>
<li>避免硬编码 sleep 时间，提高启动可靠性</li>
</ul>
<h2 data-id="heading-6">总结</h2>
<p>按顺序启动 Docker 容器不仅仅是容器启动顺序问题，更重要的是 <strong>服务依赖就绪问题</strong>。</p>
<p>实际需要根据项目复杂度选择合适的启动策略</p>



































<table><thead><tr><th>方案</th><th>适用场景</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>简单<code>depends_on</code></td><td>服务启动快、依赖简单的场景</td><td>配置简单，开箱即用</td><td>不保证服务就绪</td></tr><tr><td>健康检查 + <code>depends_on</code></td><td>生产环境、复杂依赖</td><td>可靠性高，自动化管理</td><td>需要配置健康检查</td></tr><tr><td>入口脚本等待</td><td>需要精细化控制</td><td>灵活可控，支持复杂逻辑</td><td>需要编写和维护脚本</td></tr><tr><td>外部脚本</td><td>特殊定制需求</td><td>完全自定义控制流程</td><td>维护成本高</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C#.NET struct 全解析：什么时候该用值类型？]]></title>    <link>https://juejin.cn/post/7584650673826201640</link>    <guid>https://juejin.cn/post/7584650673826201640</guid>    <pubDate>2025-12-17T23:21:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584650673826201640" data-draft-id="7584711683772547072" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C#.NET struct 全解析：什么时候该用值类型？"/> <meta itemprop="keywords" content="C#,.NET"/> <meta itemprop="datePublished" content="2025-12-17T23:21:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="唐青枫"/> <meta itemprop="url" content="https://juejin.cn/user/3737995266234280"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C#.NET struct 全解析：什么时候该用值类型？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3737995266234280/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    唐青枫
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T23:21:42.000Z" title="Wed Dec 17 2025 23:21:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">简介</h3>
<p><code>struct</code> 是 值类型（<code>Value Type</code>），用于封装一组相关的数据。
与类（<code>class</code>）相比，结构体通常更轻量，适用于小型、短生命周期的对象。</p>
<p>⚡ 关键特点：</p>
<ul>
<li>
<p>存储在 栈（<code>stack</code>）上（也可能嵌套在堆中，但本质仍是值类型）。</p>
</li>
<li>
<p>按值传递（赋值/参数传递时会复制整个结构）。</p>
</li>
<li>
<p>无需垃圾回收（<code>GC</code>），生命周期由作用域决定。</p>
</li>
<li>
<p>可包含字段、属性、方法、构造函数、运算符重载等。</p>
</li>
</ul>
<h3 data-id="heading-1">基本语法</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> Point
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> X;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Y;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Point</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> x, <span class="hljs-built_in">int</span> y</span>)</span>
    {
        X = x;
        Y = y;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Move</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> dx, <span class="hljs-built_in">int</span> dy</span>)</span>
    {
        X += dx;
        Y += dy;
    }
}
</code></pre>
<p>使用：</p>
<pre><code class="hljs language-csharp" lang="csharp">Point p1 = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>);
p1.Move(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{p1.X}</span>, <span class="hljs-subst">{p1.Y}</span>"</span>); <span class="hljs-comment">// 4, 6</span>
</code></pre>
<h3 data-id="heading-2">内存模型与分配</h3>

























<table><thead><tr><th>分配场景</th><th>存储位置</th><th>说明</th></tr></thead><tbody><tr><td><strong>局部变量</strong></td><td>栈</td><td>最典型场景，生命周期由方法作用域决定</td></tr><tr><td><strong>作为类字段</strong></td><td>堆</td><td>包含在类对象内部，但值本身在堆内存中</td></tr><tr><td><strong>数组元素</strong></td><td>堆</td><td>数组本身在堆上，每个元素紧密排列</td></tr></tbody></table>
<p>即使 <code>struct</code> 位于堆中（例如类字段、数组元素），它仍然是值类型，操作时是按值复制。</p>
<h3 data-id="heading-3">与 class 的区别</h3>













































<table><thead><tr><th>特性</th><th><code>class</code>(引用类型)</th><th><code>struct</code>(值类型)</th></tr></thead><tbody><tr><td>内存分配</td><td>堆（GC 管理）</td><td>栈/堆中嵌入</td></tr><tr><td>传递方式</td><td>按引用传递（复制引用）</td><td>按值传递（复制整个对象）</td></tr><tr><td>默认构造函数</td><td>可定义无参/有参</td><td>系统提供无参构造，用户<strong>不能定义</strong></td></tr><tr><td>继承</td><td>支持继承/虚方法</td><td>不能继承，只能实现接口</td></tr><tr><td>空值（null）</td><td>可以为 null</td><td>不可为 null（除非 <code>Nullable&lt;T&gt;</code>）</td></tr><tr><td>装箱/拆箱</td><td>不涉及</td><td>赋值给 <code>object</code> 时会装箱</td></tr><tr><td>性能</td><td>分配慢（GC）</td><td>分配快，生命周期短时更高效</td></tr></tbody></table>
<h3 data-id="heading-4">构造函数与初始化</h3>
<h4 data-id="heading-5">默认构造函数</h4>
<ul>
<li>
<p>所有结构体都有一个隐式的无参构造函数，将所有字段初始化为 默认值（如 <code>0</code>、<code>null</code>）。</p>
</li>
<li>
<p>用户不能显式定义无参构造函数（<code>C# 10</code> 开始支持，但有限制）。</p>
</li>
</ul>
<h4 data-id="heading-6">自定义构造函数</h4>
<p>可以定义有参构造函数，但必须初始化所有字段。</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Point</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> x, <span class="hljs-built_in">int</span> y</span>)</span>
{
    X = x;          <span class="hljs-comment">// 必须全部赋值</span>
    Y = y;
}
</code></pre>
<h4 data-id="heading-7">结构体的成员</h4>
<p>结构体可以包含：</p>
<ul>
<li>
<p>字段（<code>Field</code>）</p>
</li>
<li>
<p>属性（<code>Property</code>）</p>
</li>
<li>
<p>方法（<code>Method</code>）</p>
</li>
<li>
<p>事件（<code>Event</code>）</p>
</li>
<li>
<p>运算符重载</p>
</li>
<li>
<p>静态成员</p>
</li>
<li>
<p>构造函数（但无参构造受限）</p>
</li>
</ul>
<p>不支持：</p>
<ul>
<li>
<p>继承其他类/结构体（只能实现接口）。</p>
</li>
<li>
<p>明确的析构函数（<code>~Destructor</code>）。</p>
</li>
</ul>
<h3 data-id="heading-8">值类型的特性</h3>
<h4 data-id="heading-9">按值传递</h4>
<p>结构体赋值时会复制整个值：</p>
<pre><code class="hljs language-csharp" lang="csharp">Point p1 = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
Point p2 = p1;   <span class="hljs-comment">// 复制</span>
p2.X = <span class="hljs-number">99</span>;
Console.WriteLine(p1.X); <span class="hljs-comment">// 1，不受 p2 修改影响</span>
</code></pre>
<h4 data-id="heading-10">装箱/拆箱</h4>
<p>赋值给 <code>object</code> 或接口时，会将结构体复制到堆中：</p>
<pre><code class="hljs language-csharp" lang="csharp">Point p = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
<span class="hljs-built_in">object</span> obj = p;      <span class="hljs-comment">// 装箱：复制到堆</span>
Point p2 = (Point)obj; <span class="hljs-comment">// 拆箱：从堆复制回栈</span>
</code></pre>
<p>装箱/拆箱会带来性能开销，应尽量避免频繁发生。</p>
<h4 data-id="heading-11">不可变结构体（Immutable struct）</h4>
<p>为了避免复制带来的副作用，结构体推荐设计为不可变：</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">struct</span> Point
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> X { <span class="hljs-keyword">get</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Y { <span class="hljs-keyword">get</span>; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Point</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> x, <span class="hljs-built_in">int</span> y</span>)</span> =&gt; (X, Y) = (x, y);
}
</code></pre>
<h4 data-id="heading-12">实现接口</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IDrawable</span>
{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Draw</span>()</span>;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> Circle : IDrawable
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">double</span> Radius { <span class="hljs-keyword">get</span>; }
    <span class="hljs-keyword">public</span> Point Center { <span class="hljs-keyword">get</span>; }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Circle</span>(<span class="hljs-params"><span class="hljs-built_in">double</span> radius, Point center</span>)</span>
    {
        Radius = radius;
        Center = center;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Draw</span>()</span>
    {
        Console.WriteLine(<span class="hljs-string">$"Drawing circle at <span class="hljs-subst">{Center}</span> with radius <span class="hljs-subst">{Radius}</span>"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">double</span> Area =&gt; Math.PI * Radius * Radius;
}
</code></pre>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">struct</span> Rectangle : IEquatable&lt;Rectangle&gt;
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Width, Height;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">Equals</span>(<span class="hljs-params">Rectangle other</span>)</span>
    {
        <span class="hljs-keyword">return</span> Width == other.Width &amp;&amp; Height == other.Height;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">Equals</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> obj</span>)</span> =&gt; obj <span class="hljs-keyword">is</span> Rectangle other &amp;&amp; Equals(other);
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-built_in">int</span> <span class="hljs-title">GetHashCode</span>()</span> =&gt; HashCode.Combine(Width, Height);
}

<span class="hljs-keyword">var</span> r1 = <span class="hljs-keyword">new</span> Rectangle { Width = <span class="hljs-number">10</span>, Height = <span class="hljs-number">20</span> };
<span class="hljs-keyword">var</span> r2 = <span class="hljs-keyword">new</span> Rectangle { Width = <span class="hljs-number">10</span>, Height = <span class="hljs-number">20</span> };
Console.WriteLine(r1.Equals(r2)); <span class="hljs-comment">// 输出: True</span>
</code></pre>
<h4 data-id="heading-13">运算符重载示例</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">struct</span> Point
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> X, Y;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Point</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> x, <span class="hljs-built_in">int</span> y</span>)</span>
    {
        X = x;
        Y = y;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Point <span class="hljs-keyword">operator</span> +(Point a, Point b)
    {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Point(a.X + b.X, a.Y + b.Y);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-built_in">string</span> <span class="hljs-title">ToString</span>()</span> =&gt; <span class="hljs-string">$"(<span class="hljs-subst">{X}</span>, <span class="hljs-subst">{Y}</span>)"</span>;
}

<span class="hljs-keyword">var</span> p1 = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
<span class="hljs-keyword">var</span> p2 = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>);
<span class="hljs-keyword">var</span> sum = p1 + p2;
Console.WriteLine(sum); <span class="hljs-comment">// 输出: (4, 6)</span>
</code></pre>
<h3 data-id="heading-14">结构体的新特性</h3>
<h4 data-id="heading-15">readonly struct</h4>
<ul>
<li>
<p>表示完全不可变。</p>
</li>
<li>
<p>编译器强制所有字段为 <code>readonly</code>。</p>
</li>
<li>
<p>防止无意修改。</p>
</li>
</ul>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">struct</span> Vector
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">double</span> X;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">double</span> Y;
}
</code></pre>
<h4 data-id="heading-16">ref struct</h4>
<ul>
<li>
<p>只能在栈上分配。</p>
</li>
<li>
<p>用于高性能场景，如 <code>Span&lt;T&gt;</code>。</p>
</li>
</ul>
<h4 data-id="heading-17">record struct</h4>
<p>值类型的 记录类型，支持内建的值比较、<code>with</code> 表达式。</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-keyword">struct</span> <span class="hljs-title">Point</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> X, <span class="hljs-built_in">int</span> Y</span>)</span>;
<span class="hljs-keyword">var</span> p1 = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);
<span class="hljs-keyword">var</span> p2 = p1 <span class="hljs-keyword">with</span> { X = <span class="hljs-number">3</span> }; <span class="hljs-comment">// 基于值的复制</span>
</code></pre>
<h3 data-id="heading-18">高级用法</h3>
<h4 data-id="heading-19">与模式匹配结合使用</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> RGBColor
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">byte</span> R;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">byte</span> G;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">byte</span> B;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">RGBColor</span>(<span class="hljs-params"><span class="hljs-built_in">byte</span> r, <span class="hljs-built_in">byte</span> g, <span class="hljs-built_in">byte</span> b</span>)</span>
    {
        R = r;
        G = g;
        B = b;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Deconstruct</span>(<span class="hljs-params"><span class="hljs-keyword">out</span> <span class="hljs-built_in">byte</span> r, <span class="hljs-keyword">out</span> <span class="hljs-built_in">byte</span> g, <span class="hljs-keyword">out</span> <span class="hljs-built_in">byte</span> b</span>)</span>
    {
        r = R;
        g = G;
        b = B;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">string</span> <span class="hljs-title">GetColorName</span>(<span class="hljs-params">RGBColor color</span>)</span>
    {
        <span class="hljs-keyword">return</span> color <span class="hljs-keyword">switch</span>
        {
            (<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) =&gt; <span class="hljs-string">"Red"</span>,
            (<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>) =&gt; <span class="hljs-string">"Green"</span>,
            (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>) =&gt; <span class="hljs-string">"Blue"</span>,
            (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>) =&gt; <span class="hljs-string">"White"</span>,
            (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) =&gt; <span class="hljs-string">"Black"</span>,
            _ =&gt; <span class="hljs-string">"Unknown"</span>
        };
    }
    
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        RGBColor red = <span class="hljs-keyword">new</span> RGBColor(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        Console.WriteLine(GetColorName(red)); <span class="hljs-comment">// 输出: Red</span>
    }
}
</code></pre>
<h3 data-id="heading-20">适用场景</h3>
<p>✅ 适合：</p>
<ul>
<li>
<p>轻量级、小数据对象（坐标、颜色、矩形、数值容器等）。</p>
</li>
<li>
<p>高性能计算（避免 <code>GC</code> 开销）。</p>
</li>
<li>
<p>频繁创建销毁的对象。</p>
</li>
</ul>
<p>❌ 不适合：</p>
<ul>
<li>
<p>对象非常大（复制开销高）。</p>
</li>
<li>
<p>需要继承层次。</p>
</li>
<li>
<p>需要引用语义（共享同一对象）。</p>
</li>
</ul>
<blockquote>
<p>如果类型大小超过 16 字节，且频繁传递，建议使用 <code>class</code> 而不是 <code>struct</code>。</p>
</blockquote>
<h3 data-id="heading-21">实战示例</h3>
<h4 data-id="heading-22">高性能点计算</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">struct</span> Point
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">double</span> X;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">double</span> Y;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Point</span>(<span class="hljs-params"><span class="hljs-built_in">double</span> x, <span class="hljs-built_in">double</span> y</span>)</span> =&gt; (X, Y) = (x, y);

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">double</span> <span class="hljs-title">Distance</span>(<span class="hljs-params">Point other</span>)</span> =&gt;
        Math.Sqrt(Math.Pow(X - other.X, <span class="hljs-number">2</span>) + Math.Pow(Y - other.Y, <span class="hljs-number">2</span>));
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Demo</span>()</span>
{
    Point p1 = <span class="hljs-keyword">new</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
    Point p2 = <span class="hljs-keyword">new</span>(<span class="hljs-number">4</span>, <span class="hljs-number">6</span>);
    Console.WriteLine(p1.Distance(p2)); <span class="hljs-comment">// 5</span>
}
</code></pre>
<ul>
<li>
<p>无 <code>GC</code> 压力。</p>
</li>
<li>
<p>值传递保证线程安全。</p>
</li>
</ul>
<h3 data-id="heading-23">总结</h3>













































<table><thead><tr><th>特性</th><th>说明</th></tr></thead><tbody><tr><td>类型</td><td>值类型（Value Type）</td></tr><tr><td>内存分配</td><td>栈分配或嵌入堆中</td></tr><tr><td>继承</td><td>不能继承其他类/结构体，只能实现接口</td></tr><tr><td>构造函数</td><td>系统提供无参构造；用户可定义有参构造</td></tr><tr><td>默认初始化</td><td>所有字段自动初始化为默认值</td></tr><tr><td>传递方式</td><td>按值传递（复制整个对象）</td></tr><tr><td>典型场景</td><td>小型数据对象（Point、Color）、高性能计算</td></tr><tr><td>高级特性</td><td><code>readonly struct</code>、<code>ref struct</code>、<code>record struct</code></td></tr><tr><td>设计建议</td><td>尽量保持不可变，避免装箱，避免过大对象</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[10 个强大且值得掌握的 Linux 命令]]></title>    <link>https://juejin.cn/post/7584651851905630227</link>    <guid>https://juejin.cn/post/7584651851905630227</guid>    <pubDate>2025-12-17T23:58:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584651851905630227" data-draft-id="7584651851905613843" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="10 个强大且值得掌握的 Linux 命令"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-17T23:58:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            10 个强大且值得掌握的 Linux 命令
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T23:58:48.000Z" title="Wed Dec 17 2025 23:58:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">10 个强大且值得掌握的 Linux 命令</h2>
<h3 data-id="heading-1">引言：当终端开始“解决问题”</h3>
<p>很多人第一次真正感受到 Linux 的能力，是在终端里执行了一条自己并不完全理解的命令：按下回车后，问题被快速定位或直接消失。没有图形界面，没有向导，也没有额外解释，只有结果。</p>
<p>Linux 早已不再被视为“难用的系统”，但它仍然提供了不少底层工具：它们能把系统状态和执行细节直接摊开，让排障从“猜测”变成“证据”。</p>
<p>下面整理 10 个非常实用的 Linux 命令。它们并不是什么“危险技巧”，但很多人在第一次用对之后，都会意识到：</p>
<p>“原来问题还可以这样查。”</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2025-12%2F10-linux-commands-that-feel-illegal-to-know" target="_blank" title="https://catchadmin.com/post/2025-12/10-linux-commands-that-feel-illegal-to-know" ref="nofollow noopener noreferrer">原文链接 10 个强大且值得掌握的 Linux 命令</a></p>
<h3 data-id="heading-2">strace：跟踪系统调用</h3>
<p><code>strace</code> 用于实时跟踪进程的系统调用（system call）及其返回值。</p>
<pre><code class="hljs language-bash" lang="bash">strace -p 1234
</code></pre>
<p>当程序“莫名其妙”失败时，<code>strace</code> 往往能让你直接看到它卡在了哪一步：文件访问、网络调用、权限检查，以及具体的错误码。</p>
<p>为什么它很有用：</p>
<ul>
<li>能定位失败发生在哪个系统调用</li>
<li>能快速发现权限不足、路径不存在、依赖缺失等问题</li>
<li>让“它不工作”变成可复盘的具体原因</li>
</ul>
<h3 data-id="heading-3">lsof：查看文件/端口占用</h3>
<p>当你删除文件、释放端口或卸载目录时遇到占用问题，<code>lsof</code> 可以列出正在使用目标资源的进程。</p>
<pre><code class="hljs language-bash" lang="bash">lsof /path/to/file
</code></pre>
<p>为什么它很有用：</p>
<ul>
<li>能快速定位“到底是谁在占用”</li>
<li>排查端口占用、文件句柄泄漏时非常直接</li>
<li>适合用于线上排障与运维定位</li>
</ul>
<h3 data-id="heading-4">dd：底层数据复制/写入工具</h3>
<p><code>dd</code> 是一个非常底层的工具，用于按块读取/写入数据。它常用于制作镜像、数据迁移、备份与恢复。</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/zero of=/dev/sda
</code></pre>
<p>上面这条命令会把设备写入全 0 数据。在生产环境中误用，可能导致数据不可恢复，因此务必确认 <code>of=</code> 指向的目标设备。</p>
<p>为什么它很有用：</p>
<ul>
<li>可以直接对块设备进行读写</li>
<li>适合做镜像制作、备份与恢复</li>
<li>使用门槛不高，但风险很高，需要严格确认参数</li>
</ul>
<h3 data-id="heading-5">nc（netcat）：网络调试与临时通信</h3>
<p><code>nc</code>（Netcat）是一个轻量但非常强大的网络工具，可用于监听端口、测试连通性、传输数据等。</p>
<pre><code class="hljs language-bash" lang="bash">nc -l 4444
</code></pre>
<p>一行命令，你就开了一个监听端口。再多敲几下，你能传文件、测端口、临时搭服务、排查网络问题。</p>
<p>为什么它很有用：</p>
<ul>
<li>一条命令即可快速启动监听或建立连接</li>
<li>适合用于端口调试、服务联调与简单数据传输</li>
<li>工具轻量，适用范围很广</li>
</ul>
<h3 data-id="heading-6">watch：周期性执行命令</h3>
<p>有些问题需要观察变化过程，而不是只看某一刻的结果。</p>
<pre><code class="hljs language-bash" lang="bash">watch -n 1 <span class="hljs-built_in">df</span> -h
</code></pre>
<p>每秒刷新一次，你能看到磁盘占用实时变化；也能用来盯 CPU、内存、文件变化……不用写脚本、不用装 agent。</p>
<p>为什么它很有用：</p>
<ul>
<li>可以把任何命令输出快速变成“实时刷新”的视图</li>
<li>不依赖额外监控系统，排查现场问题很方便</li>
<li>适合观察磁盘、内存、进程等随时间变化的指标</li>
</ul>
<h3 data-id="heading-7">xargs：把输出转换为参数</h3>
<p><code>xargs</code> 会把上一条命令的输出转换为另一个命令的参数，是常见的批处理工具。</p>
<pre><code class="hljs language-bash" lang="bash">find . -name <span class="hljs-string">"*.log"</span> | xargs <span class="hljs-built_in">rm</span>
</code></pre>
<p>为什么它很有用：</p>
<ul>
<li>很多批量操作可以用一行管道完成</li>
<li>适合清理、检索、批处理文件等场景</li>
<li>让命令行工具的组合能力发挥出来</li>
</ul>
<h3 data-id="heading-8">nohup：让进程在会话结束后继续运行</h3>
<p>当你希望某个任务在断开 SSH、退出终端后继续运行时，可以使用 <code>nohup</code>。</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">nohup</span> long_task &amp;
</code></pre>
<p>你断开连接，它照样跑完。没人需要守着它。</p>
<p>为什么它很有用：</p>
<ul>
<li>适合跑长任务或后台任务</li>
<li>不需要保持终端会话</li>
<li>常用于脚本化与自动化执行</li>
</ul>
<h3 data-id="heading-9">/proc：通过虚拟文件系统查看系统信息</h3>
<p>Linux 会通过 <code>/proc</code> 这个虚拟文件系统暴露大量内核与进程信息。</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /proc/cpuinfo
</code></pre>
<p>为什么它很有用：</p>
<ul>
<li>系统状态和硬件信息可以直接读取</li>
<li>排查性能与资源问题时很常用</li>
<li>让很多“系统内部信息”变得可见</li>
</ul>
<h3 data-id="heading-10">rsync：增量同步工具</h3>
<p><code>rsync</code> 不只是复制文件，它会根据差异进行增量传输，并能保留权限等元数据。</p>
<pre><code class="hljs language-bash" lang="bash">rsync -av --delete <span class="hljs-built_in">source</span>/ dest/
</code></pre>
<p>它只传差异文件、保留权限，还能把目录镜像得很干净。</p>
<p>为什么它很有用：</p>
<ul>
<li>适合用于备份、部署、目录镜像等场景</li>
<li>传输效率高，尤其适合大目录同步</li>
<li>在工程实践中非常常见</li>
</ul>
<h3 data-id="heading-11">history | grep：检索历史命令</h3>
<p>当你忘记自己以前用过哪条命令时，可以直接在 shell 的历史记录里搜索。</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">history</span> | grep ssh
</code></pre>
<p>为什么它很有用：</p>
<ul>
<li>能快速复用过去的命令</li>
<li>排查与运维时能节省大量时间</li>
<li>随着使用时间增长，命令历史会变成一份可检索的经验库</li>
</ul>
<h3 data-id="heading-12">Linux 的特点：直接、透明</h3>
<p>这些命令之所以让人印象深刻，主要是因为它们减少了中间层：你能更直接地看到系统发生了什么、哪个环节出了问题、当前资源到底被谁占用。</p>
<p>Linux 不会替你隐藏复杂度，但它会把关键细节以可验证的方式提供出来。掌握这些工具之后，很多问题不再需要猜。</p>
<h3 data-id="heading-13">结语</h3>
<p>你不需要背下所有命令，但需要知道“有哪些手段可以用”。当你逐渐熟悉这些工具，Linux 对你来说就不只是一个系统，而是一套高效、可控的工作方式.</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[从已损坏的备份中拯救数据]]></title>    <link>https://juejin.cn/post/7584722109583474731</link>    <guid>https://juejin.cn/post/7584722109583474731</guid>    <pubDate>2025-12-17T16:15:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584722109583474731" data-draft-id="7584695558158942249" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="从已损坏的备份中拯救数据"/> <meta itemprop="keywords" content="后端,运维,前端工程化"/> <meta itemprop="datePublished" content="2025-12-17T16:15:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="神奇的程序员"/> <meta itemprop="url" content="https://juejin.cn/user/3984285870859614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            从已损坏的备份中拯救数据
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3984285870859614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    神奇的程序员
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T16:15:55.000Z" title="Wed Dec 17 2025 16:15:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/020d21aaca80490da6d4c4b1e8c3ffee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=LRG%2BqijNWJbDmxuIFa%2BAFUB6V8U%3D" alt="999" loading="lazy"/></p>
<h2 data-id="heading-0">前言</h2>
<p>12月15号早上，一觉醒来，拿起手机看到我的邮箱收到了内网服务无法访问的告警邮件，本以为只是简单的服务卡死，将服务器重启后就去上班了。</p>
<p>后来，陆续有好友联系我说网站挂了。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/254461b49e2f493ea63d61b390d359f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=PjIICfEbNNcZ8be1jUt0dr25zm0%3D" alt="iPhone镜像 2025-12-17 21.18.12" loading="lazy"/></p>
<h2 data-id="heading-1">定位问题</h2>
<p>晚上下班回家后，尝试将电脑断电重启，发现pve只能存活2分钟左右，然后整个系统卡死，无法进行任何操作。首先，我想到的是：会不会某个vm虚拟机或者ct容器影响到宿主机了。</p>
<p>因为系统只能存活几分钟，在执行禁用操作的时候，强制重启了好几次服务器。当所有的服务都停止启动后，卡死的问题依旧存在。</p>
<h3 data-id="heading-2">翻日志</h3>
<p>没辙了，这已经不是简单的软件问题了，只好翻日志，看报错信息了。</p>
<pre><code class="hljs language-bash" lang="bash">nvme nvme0: I/O <span class="hljs-built_in">timeout</span>, aborting
</code></pre>
<p>如上所示，日志中出现了好几条I/O超时消息，顿感不妙，该不会硬盘坏了吧....</p>
<h3 data-id="heading-3">找到原因</h3>
<p>找了一圈方案，大部分都说这个错误是nvme硬盘的通病，他有一个省电模式，在某些硬件+内核的组合下会导致控制器假死。</p>
<p>解决方案也很简单，找到GRUB的配置文件，关闭他的自动睡眠和省电模式，在pve中这个文件位于<code>/etc/default/grub</code>，打开这个文件后，找到GRUB_CMDLINE_LINUX_DEFAULT属性，添加两个值：</p>
<ul>
<li>nvme_core.default_ps_max_latency_us=0</li>
<li>pcie_aspm=off</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">GRUB_CMDLINE_LINUX_DEFAULT=<span class="hljs-string">"quiet nvme_core.default_ps_max_latency_us=0 pcie_aspm=off"</span>
</code></pre>
<p>保存文件后，执行：<code>update-grub</code> 命令，随后重启整个pve主机。</p>
<h2 data-id="heading-4">VM无法启动</h2>
<p>pve启动卡死的问题解决了，现在又有了新的问题。启动我那台跑了整个网站服务的vm虚拟机时，出现了如下所示的错误：</p>
<pre><code class="hljs language-bash" lang="bash">mount: mounting /dev/sda3 /dev/sda3 on /sysroot failed: No error information
Mounting root failed.
initramfs emergency recovery shell launched.
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bef0a009e7c54e97a734efba093492b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=5kHjIvyVoY0kBuGEu80LxYZcIN4%3D" alt="2222" loading="lazy"/></p>
<p>这下坏事了，linux的根分区无法挂载了😭，应该是刚才频繁的卡死，我不断的启动pve，容器不停的启动、强制终止导致盘里这块区域的数据受损了，处于半死不活状态了。</p>
<h2 data-id="heading-5">从备份中还原</h2>
<p>幸好我之前设置了vm容器的整机备份，连续备份并存储3天，全部放在了内网另一台机器的机械硬盘中，通过网络挂载到pve上的。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/259b1621715e4078a5d7bf10a916920f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=QTaRGIU%2BLRPjr1DDEEYDuHRNq2Y%3D" alt="image-20251217224605905" loading="lazy"/></p>
<p>本以为一切都会很顺利，还原的时候出现了错误， zstd 解码时，发现压缩块损坏，导致还原失败。</p>
<pre><code class="hljs language-bash" lang="bash">_15-03_00_03.vma.zst : Decoding error (36) : Corrupted block detected vma: restore failed - short vma extent (2801635 &lt; 3801600) /bin/bash: line 1: 2131 Exit 1 zstd -q -d -c /mnt/pve/nfs_usb_4t/dump/vzdump-qemu-100-2025_12_15-03_00_03.vma.zst
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3cb240a7baa488495a09bb804edd210~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=6XZhjc%2FgPPA0zJl%2F4si2b2oJDbU%3D" alt="image-20251217225055348" loading="lazy"/></p>
<p>于是，我又尝试了另外两个备份，结果都无法还原，全部都是相同的错误。当初做备份的时候，想着我都整机备份了，而且保存了3天的备份，总不可能三个全坏吧。</p>
<pre><code class="hljs language-bash" lang="bash">progress 99% (<span class="hljs-built_in">read</span> 318901321728 bytes, duration 722 sec) 

_13-03_00_02.vma.zst : Decoding error (36) : Restored data doesn<span class="hljs-string">'t match checksum progress 100% (read 322122547200 bytes, duration 755 sec) total bytes read 322122547200, sparse bytes 196604751872 (61%) space reduction due to 4K zero blocks 0.414% temporary volume '</span><span class="hljs-built_in">local</span>:121/vm-121-disk-0.qcow2<span class="hljs-string">' sucessfuly removed no lock found trying to remove '</span>create<span class="hljs-string">' lock error before or during data restore, some or all disks were not completely restored. VM 121 state is NOT cleaned up. TASK ERROR: command '</span><span class="hljs-built_in">set</span> -o pipefail &amp;&amp; zstd -q -d -c /mnt/pve/nfs_usb_4t/dump/vzdump-qemu-100-2025_12_13-03_00_02.vma.zst | vma extract -v -r /var/tmp/vzdumptmp10764.fifo - /var/tmp/vzdumptmp10764<span class="hljs-string">' failed: exit code 1
</span></code></pre>
<p>现在狠狠的打脸了，我手里目前只有<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.kaisir.cn%2Fpost%2F175" target="_blank" title="https://www.kaisir.cn/post/175" ref="nofollow noopener noreferrer">2023年11月迁移技术栈</a>时，那份docker compose的初始数据。相当于我丢失了2年的数据，这我是不能接受的。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b96d82c24784138b59bfe769ff3d449~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=nvsnSQ1e2Fa%2FaipD0iiY6G5J17s%3D" alt="毀滅吧我累了- 毀滅吧我累了updated their profile picture." loading="lazy"/></p>
<p>折腾到这里，我一看时间，已经凌晨1:30了，明天还要上班，带着郁闷的心情去睡觉了。</p>
<h2 data-id="heading-6">强行提取数据</h2>
<p>睡醒后，不愿接受这个现实，想到改造的那个<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.kaisir.cn%2Fenglish-study%2F" target="_blank" title="https://www.kaisir.cn/english-study/" ref="nofollow noopener noreferrer">练习英语单词的开源项目</a>，这1年多时间下来，平均的日活跃人数已经有40多个了，数据库存储8w多条单词数据了😑，太难受了😭</p>
<p>实在是想不到什么好法子了，只好在v站和朋友圈都发了<a href="https://link.juejin.cn?target=https%3A%2F%2Fv2ex.com%2Ft%2F1179127" target="_blank" title="https://v2ex.com/t/1179127" ref="nofollow noopener noreferrer">求助帖</a>。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/047d0a8774e846a3b8179b49a423e284~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=zijU5Uh9n6wJ5oSMeZBvbi8lnVI%3D" alt="IMG_0911" loading="lazy"/></p>
<h3 data-id="heading-7">找到方案</h3>
<p>在此，感谢v站老哥<a href="https://link.juejin.cn?target=https%3A%2F%2Fv2ex.com%2Fmember%2FDylanC" target="_blank" title="https://v2ex.com/member/DylanC" ref="nofollow noopener noreferrer">DylanC</a>，给了我一组关键词。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/704da5ee37a4422cadf3a4f1f0711cbd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=bkDvRfctNziStIGuzFg7qxPnBNA%3D" alt="image-20251217231654428" loading="lazy"/></p>
<p>晚上回家后，开始找资料，问GPT，经过一番折腾总算是把数据提取出来了。</p>
<h3 data-id="heading-8">跳过校验</h3>
<p>从上述的错误日志中能看出，我在还原的时候已经读了99%的数据了，只是文件的完整性校验过不了，我的vm虚拟机里一整个全是docker compose编排的服务（mysql、redis、java、nginx等），理论上是比较好找回的。</p>
<p>pve的定时备份采用的是vzdump服务，备份出来的产物是<code>.vma.zst</code>格式的，他的本质是：</p>
<ul>
<li>zstd 压缩</li>
<li>内部是 <code>vma</code> 归档</li>
<li>包含：
<ul>
<li><code>qemu-server.conf</code></li>
<li><code>disk-drive-scsi0.raw</code></li>
</ul>
</li>
</ul>
<p>知道这些后，我们先把网络存储中的备份文件拷贝到pve主机的<code>/var/lib/vz/dump</code>目录，执行下述命令，忽略校验，强行解压。</p>
<pre><code class="hljs language-bash" lang="bash">zstd -d -c --no-check vzdump-qemu-100-2025_12_13-03_00_02.vma.zst \
| vma extract -v - ./extract.partial
</code></pre>
<p>等待一段时间后，程序执行结束，你会发现报错依然存在，但是这不影响已经读取的数据，cd到./extract.partial目录，你应该能看到<code>xxx.conf</code>和<code>xxx.raw</code>文件，然后看下.raw后缀文件的空间占用，只要不是太小(占用&lt;1GB)，那么这份数据基本是没问题的，磁盘的 RAW 文件也算是被解出来了。</p>
<h3 data-id="heading-9">挂载RAW磁盘</h3>
<p>为了防止数据遭到破坏，我们需要做只读挂载，命令如下：</p>
<pre><code class="hljs language-bash" lang="bash">losetup -fP /var/lib/vz/dump/extract.partial/disk-drive-scsi0.raw
</code></pre>
<p>然后，执行命令查看结果。</p>
<pre><code class="hljs language-bash" lang="bash">losetup -a
lsblk
</code></pre>
<p>执行后，应该能看到类似<code>loop0</code>、<code>loop0p1</code>、<code>loop0p2</code>这样的数据，找到那块空间跟你在extract.partial目录下看到的空间差不多大小的盘。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/43800309663e4cb1a587c6959ae4a61f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=cP27t8xeOooOtugnEjf9Lug3LmM%3D" alt="image-20251217234910684" loading="lazy"/></p>
<h3 data-id="heading-10">挂载分区</h3>
<p>首先，我们通过下述命令来创建一个挂载点：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p /mnt/rescue
</code></pre>
<p>随后，尝试挂载分区（loop0p1、loop0p2....等），找你的根分区，如果你运气好，p1就挂载成功了，那就不需要挂载其他的了。</p>
<p>我的根分区是p3，那么我挂载p3即可。</p>
<pre><code class="hljs language-bash" lang="bash">mount -o ro,norecovery /dev/loop0p3 /mnt/rescue
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b71255c3aad04b29b8bf9c5d1fcbfb3e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=XCw%2FxWGDhG96gOArVILwLcuVuWU%3D" alt="image-20251217235136772" loading="lazy"/></p>
<p>如果失败的话，代表它不是文件系统，需要继续尝试挂载其他分区，直到成功为止。</p>
<pre><code class="hljs language-bash" lang="bash">umount /mnt/rescue 2&gt;/dev/null
mount -o ro,norecovery /dev/loop0p2 /mnt/rescue
</code></pre>
<p>最后，查看挂载点里是否有你的数据。</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">ls</span> /mnt/rescue
</code></pre>
<p>不出意外的话，你应该能看到类似下图所示的内容。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbb59c826bef4dc28fb5498c75cacb71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766592955&amp;x-signature=3ioKB0V0gkPF%2F4xQ21vHVyTg1qU%3D" alt="image-20251217235434358" loading="lazy"/></p>
<p>文件成功恢复，接下来要做的就是把这些文件拷贝到安全的地方即可。</p>
<h2 data-id="heading-11">写在最后</h2>
<p>至此，文章就分享完毕了。</p>
<p>我是<strong>神奇的程序员</strong>，一位前端开发工程师。</p>
<p>如果你对我感兴趣，请移步我的<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.kaisir.cn%2F" target="_blank" title="https://www.kaisir.cn/" ref="nofollow noopener noreferrer">个人网站</a>，进一步了解。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[🚀你以为你在写 React？其实你在“搭一套前端操作系统”]]></title>    <link>https://juejin.cn/post/7584712109171425306</link>    <guid>https://juejin.cn/post/7584712109171425306</guid>    <pubDate>2025-12-17T16:37:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584712109171425306" data-draft-id="7584657447803469850" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" 🚀你以为你在写 React？其实你在“搭一套前端操作系统”"/> <meta itemprop="keywords" content="前端,React.js"/> <meta itemprop="datePublished" content="2025-12-17T16:37:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="白兰地空瓶"/> <meta itemprop="url" content="https://juejin.cn/user/191753514127514"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             🚀你以为你在写 React？其实你在“搭一套前端操作系统”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/191753514127514/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    白兰地空瓶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T16:37:20.000Z" title="Wed Dec 17 2025 16:37:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">——从 Vite + React 架构出发，对照 Vue，彻底看懂现代前端工程化</h2>
<blockquote>
<p>👉 <em>“现代前端不是写页面，而是在设计一套「运行在浏览器里的应用架构」。”</em></p>
</blockquote>
<hr/>
<h2 data-id="heading-1">一、先说结论：React / Vue 早就不只是“框架”了</h2>
<p>很多人学 React / Vue 的路径是这样的：</p>
<blockquote>
<p>JSX / template → 组件 → 状态 → 路由 → API 请求<br/>
✋ 到此为止</p>
</blockquote>
<p><strong>但面试官想听的不是这个。</strong></p>
<p>他们更关心的是：</p>
<ul>
<li>你知不知道<strong>项目是怎么被“跑起来”的</strong></li>
<li>dev / test / production 在架构层面有什么区别</li>
<li>React 和 Vue 在“设计哲学”上的根本差异</li>
</ul>
<p>而你给的这套 <strong>Vite + React 架构材料</strong>，刚好是理解这一切的<strong>钥匙</strong>。</p>
<hr/>
<h2 data-id="heading-2">二、npm init vite：不是创建项目，是“选择一套世界观”</h2>
<pre><code class="hljs language-csharp" lang="csharp">npm <span class="hljs-keyword">init</span> vite
</code></pre>
<p>表面上看：<br/>
👉 创建一个 React / Vue 项目</p>
<p>实际上是：</p>
<blockquote>
<p><strong>你在选择一套“前端运行时 + 构建体系 + 模块规范”的组合</strong></p>
</blockquote>
<h3 data-id="heading-3">为什么是 Vite？</h3>
<p>一句话总结：</p>
<blockquote>
<p><strong>Vite = 为 ESM 而生的开发期引擎</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-4">🔥 Vite 做了什么？</h3>





















<table><thead><tr><th>传统工具（Webpack）</th><th>Vite</th></tr></thead><tbody><tr><td>打包后再启动 dev server</td><td><strong>先启动 server</strong></td></tr><tr><td>一切都是 bundle</td><td><strong>开发期不打包</strong></td></tr><tr><td>冷启动慢</td><td><strong>ESM 原生加载，冷启动极快</strong></td></tr></tbody></table>
<p>📌 <strong>关键点</strong> ：</p>
<blockquote>
<p><strong>Vite 在 dev 阶段几乎不做打包，而是把模块加载权交给浏览器。</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-5">三、dev → test → production：这是“阶段”，不是环境变量</h2>
<blockquote>
<p><strong>dev → test → production</strong></p>
</blockquote>
<p>很多人理解成：</p>
<blockquote>
<p>换几个 <code>.env</code> 文件</p>
</blockquote>
<p>❌ 错</p>
<h3 data-id="heading-6">正确理解是：</h3>





















<table><thead><tr><th>阶段</th><th>核心目标</th></tr></thead><tbody><tr><td>dev</td><td>开发效率最大化</td></tr><tr><td>test</td><td>稳定性、可测试</td></tr><tr><td>production</td><td>性能、体积、安全</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-7">为什么 devDependencies 和 dependencies 要分开？</h3>
<pre><code class="hljs language-css" lang="css">npm <span class="hljs-selector-tag">i</span> -D vite stylus
npm <span class="hljs-selector-tag">i</span> react react-dom
</code></pre>
<p>这是<strong>工程级别的架构意识</strong>。</p>
<ul>
<li><code>devDependencies</code><br/>
👉 <strong>只在开发和构建阶段存在</strong></li>
<li><code>dependencies</code><br/>
👉 <strong>最终会进到用户浏览器</strong></li>
</ul>
<p>📌 <strong>一句面试金句</strong>：</p>
<blockquote>
<p>“依赖划分的本质，是在控制「哪些代码会进入最终产物」。”</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">四、React 项目结构，本质是“三权分立”</h2>
<p>你现在的 React 架构，其实非常清晰：</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">src</span>/
 ├─ <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.jsx</span>        <span class="hljs-comment">// 应用入口</span>
 ├─ <span class="hljs-selector-tag">App</span><span class="hljs-selector-class">.jsx</span>         <span class="hljs-comment">// 应用壳</span>
 ├─ <span class="hljs-selector-tag">router</span>/         <span class="hljs-comment">// 路由系统</span>
 ├─ <span class="hljs-selector-tag">pages</span>/          <span class="hljs-comment">// 页面级组件</span>
 ├─ <span class="hljs-selector-tag">components</span>/     <span class="hljs-comment">// 通用组件</span>
 └─ <span class="hljs-selector-tag">styles</span>/         <span class="hljs-comment">// 全局样式</span>
</code></pre>
<p>这背后是一个非常经典的思想：</p>
<blockquote>
<p><strong>入口、调度、业务 —— 各司其职</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-9">1️⃣ main.jsx：应用启动器（Bootloader）</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">createRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'root'</span>))
  .<span class="hljs-title function_">render</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>)
</code></pre>
<p>📌 它只干一件事：</p>
<blockquote>
<p><strong>把 React 应用“挂”到真实 DOM 上</strong></p>
</blockquote>
<p>对比 Vue：</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">createApp</span>(App)<span class="hljs-selector-class">.mount</span>('#app')
</code></pre>
<p>👉 <strong>本质完全一致</strong>：<br/>
都是“把虚拟世界接管真实 DOM”</p>
<hr/>
<h3 data-id="heading-10">2️⃣ App.jsx：应用壳（Shell）</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">AppRoutes</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span>
</code></pre>
<p>📌 App 不是页面<br/>
👉 <strong>App 是“应用框架”</strong></p>
<p>它负责：</p>
<ul>
<li>路由接管</li>
<li>布局结构</li>
<li>全局样式</li>
<li>上下文（Context）</li>
</ul>
<hr/>
<h3 data-id="heading-11">3️⃣ pages：页面级组件 ≠ 普通组件</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">Home</span> = () =&gt; {
  const <span class="hljs-section">[repos, setRepos]</span> = useState(<span class="hljs-section">[]</span>)
}
</code></pre>
<p>📌 <strong>页面组件的特点</strong>：</p>
<ul>
<li>和路由一一对应</li>
<li>负责数据请求</li>
<li>负责业务编排</li>
</ul>
<p>👉 <strong>它们是“业务容器”，不是 UI 零件</strong></p>
<hr/>
<h2 data-id="heading-12">五、React Router：不是路由库，是“前端导航系统”</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span> /&gt;</span>} /&gt;
  <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/about"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">About</span> /&gt;</span>} /&gt;
<span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
</code></pre>
<h3 data-id="heading-13">BrowserRouter vs HashRouter</h3>
<p>你写得非常关键：</p>
<pre><code class="hljs language-arduino" lang="arduino">BrowserRouter <span class="hljs-comment">// HTML5 history</span>
HashRouter    <span class="hljs-comment">// # 路由</span>
</code></pre>
<p>📌 面试这样说直接加分：</p>
<blockquote>
<p>“BrowserRouter 更接近后端路由，但依赖服务器支持；HashRouter 是前端自包含方案。”</p>
</blockquote>
<hr/>
<h2 data-id="heading-14">六、useState + useEffect：不是 API，是“状态驱动模型”</h2>
<pre><code class="hljs language-scss" lang="scss">const <span class="hljs-selector-attr">[repos, setRepos]</span> = <span class="hljs-built_in">useState</span>([])
</code></pre>
<p>很多人背：</p>
<blockquote>
<p>useState 是响应式<br/>
useEffect 是副作用</p>
</blockquote>
<p>但<strong>架构层的理解是</strong>：</p>
<hr/>
<h3 data-id="heading-15">React 的核心模型</h3>
<blockquote>
<p><strong>UI = f(state)</strong></p>
</blockquote>
<ul>
<li>state 改变</li>
<li>UI 自动重新计算</li>
</ul>
<p>而 <code>useEffect</code> 的存在是因为：</p>
<blockquote>
<p><strong>有些逻辑不属于“渲染”本身</strong></p>
</blockquote>
<p>比如：</p>
<ul>
<li>请求数据</li>
<li>订阅事件</li>
<li>操作 DOM</li>
</ul>
<hr/>
<h3 data-id="heading-16">对比 Vue</h3>





















<table><thead><tr><th>Vue</th><th>React</th></tr></thead><tbody><tr><td>ref / reactive</td><td>useState</td></tr><tr><td>watch / onMounted</td><td>useEffect</td></tr><tr><td>模板自动追踪依赖</td><td><strong>手动声明依赖</strong></td></tr></tbody></table>
<p>📌 <strong>哲学差异</strong>：</p>
<blockquote>
<p>Vue：我帮你想<br/>
React：你来决定</p>
</blockquote>
<hr/>
<h2 data-id="heading-17">七、Vue = react + react-dom？这句话为什么对</h2>
<blockquote>
<p><strong>vue = react(core) + react-dom(component render dom)</strong></p>
</blockquote>
<p>这句话的本质是：</p>
<ul>
<li>React：<strong>只关心状态 → UI 的映射</strong></li>
<li>react-dom：<strong>把虚拟 UI 映射到浏览器</strong></li>
<li>Vue：<strong>两者合一，外加编译期优化</strong></li>
</ul>
<p>📌 所以才有：</p>
<ul>
<li>React Native</li>
<li>React Three Fiber</li>
<li>Vue 的模板编译优化</li>
</ul>
<hr/>
<h2 data-id="heading-18">🔚 写在最后</h2>
<blockquote>
<p><strong>当你真正理解架构时，你就不再纠结“用 React 还是 Vue”。</strong></p>
<p>因为你知道：<br/>
👉 框架只是语法<br/>
👉 架构才是能力</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[告别抽卡玄学：OpenAI GPT Image 1.5 到底强在哪？]]></title>    <link>https://juejin.cn/post/7584639987213484066</link>    <guid>https://juejin.cn/post/7584639987213484066</guid>    <pubDate>2025-12-17T15:26:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584639987213484066" data-draft-id="7584702863688269839" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="告别抽卡玄学：OpenAI GPT Image 1.5 到底强在哪？"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-17T15:26:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="墨风如雪"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            告别抽卡玄学：OpenAI GPT Image 1.5 到底强在哪？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    墨风如雪
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T15:26:12.000Z" title="Wed Dec 17 2025 15:26:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>就在2025年12月17日，OpenAI 没有任何预兆地扔下了一枚重磅炸弹：GPT Image 1.5 正式上线。</p>
<p>对于在这个圈子里摸爬滚打的人来说，这一次的更新不仅仅是版本号的数字跳动，更像是一种风向标的彻底转变。如果说以前用 AI 生图像是在玩“抽卡游戏”，赌的是概率和运气，那么 GPT Image 1.5 的出现，终于让这门技术开始像真正的 PhotoShop 笔刷一样，变得听话、可控了。</p>
<p>作为一名长期关注生成式 AI 的创作者，我第一时间上手体验了这款被 OpenAI 寄予厚望的旗舰模型，甚至对比了隔壁 Google 家的 Nano Banana Pro。下面聊聊这一天体验下来的真实感受。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-17_23.13.20-1024x561.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-17_23.13.20-1024x561.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae5945bf03aa4f1fb7195948ad803740~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766589972&amp;x-signature=8fQ7EJdnl%2FOL6Ld5G9YUfr0RwN4%3D" alt="iShot_2025-12-17_23.13.20" loading="lazy"/></a></p>
<p><strong>不再是“改一处，乱一片”</strong></p>
<p>一直以来，AI 生图最大的痛点就是“不可控”。你让它给人物换件衣服，它可能顺便把脸给换了，甚至连背后的光影和构图都给你重塑一遍。但在 GPT Image 1.5 上，OpenAI 终于把“精准控制”这块硬骨头啃下来了。</p>
<p>新模型的最大亮点在于它对“指令遵循”的变态级理解。官方称之为“精准编辑”，实测下来确实惊艳。当你要求“去掉桌上的咖啡杯”或者“给模特换上红色毛衣”时，它能极其克制地只修改你指定的区域，而画面原本的光照逻辑、人物的神态、甚至复杂的背景纹理，都能保持惊人的一致性。</p>
<p>对于设计师来说，这意味着 AI 终于能进真正的生产工作流了。OpenAI 甚至透露已经和迪士尼达成了合作，这本身就是对模型“角色一致性”最大的背书。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-17_23.15.08-1024x574.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-17_23.15.08-1024x574.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c7ca260811e4c63a58331c52deb5eb3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766589972&amp;x-signature=yMfskc8RWxQToMh0R8ltEvQi%2FsI%3D" alt="iShot_2025-12-17_23.15.08" loading="lazy"/></a></p>
<p><strong>快了四倍，还便宜了</strong></p>
<p>在性能方面，OpenAI 这次也一点没藏着掖着。GPT Image 1.5 的生成速度比上一代快了整整 4 倍。</p>
<p>以前生成一张高质量大图，你可能得盯着进度条发呆好一会儿，思路很容易被打断。现在的体验是，这边的提示词刚敲完，那边的图几乎就即时刷出来了，而且支持多图并行生成。这种流畅感，对于灵感稍纵即逝的创意工作者来说，是无价的。</p>
<p>更有意思的是，API 的调用成本反而降低了 20%。降价提速，摆明了是要抢占商业应用的市场，尤其是电商海报、产品变体图这些原本需要大量人工修图的领域。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-17_23.15.47-914x1024.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-17_23.15.47-914x1024.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9859969b3b54559bbd8705084efe167~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766589972&amp;x-signature=ovY3e9bYanYy2w0tO2z4nKYo6d0%3D" alt="iShot_2025-12-17_23.15.47" loading="lazy"/></a></p>
<p><strong>文字渲染的惊喜与遗憾</strong></p>
<p>这一代模型在处理图片内的文字排版上有了长足进步。以前 AI 生成的文字大多是一堆不可名状的鬼画符，但现在 GPT Image 1.5 处理密集型的小字体、制作信息图表甚至海报排版，都能做到清晰可读。</p>
<p>但这引出了它的一个明显短板——中文。</p>
<p>不得不吐槽，虽然它的英文文本渲染能力很强，但在中文生成上依然经常“翻车”，错字连篇是常态。如果你指望直接用它生成一张带完美中文标语的电商海报，目前恐怕还得配合后期手动修图。这一点上，它依然不够接地气。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-17_23.16.23-1024x925.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-17_23.16.23-1024x925.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e2d6634d480459d9583a2d4b8e2541f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766589972&amp;x-signature=JkGEld4aqp%2B7kYtHy1GWgUg5ss8%3D" alt="iShot_2025-12-17_23.16.23" loading="lazy"/></a></p>
<p><strong>真实感：还有提升空间</strong></p>
<p>虽然 GPT Image 1.5 在听话程度上做到了极致，但在画面的“绝对真实感”上，我认为它略逊于 Google 的 Nano Banana Pro。</p>
<p>在部分实测中，GPT Image 1.5 的出图依然带有一种难以言喻的“AI 味”——画面很完美，光影很正确，但就是太干净了，缺少真实摄影中那种粗粝的质感。相比之下，Google 的竞品在模拟真实照片的颗粒感和随机性上，目前似乎仍略胜一筹。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-17_23.16.35-1024x947.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-17_23.16.35-1024x947.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dec207a3bc5845cb93e926b24a9527fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766589972&amp;x-signature=CfFA4%2FG7ee0AKFnvldxsyuov7Nw%3D" alt="iShot_2025-12-17_23.16.35" loading="lazy"/></a></p>
<p><strong>写在最后</strong></p>
<p>总的来说，GPT Image 1.5 是一款极具“工具属性”的产品。OpenAI 似乎想通了，不再单纯追求生成多么天马行空的艺术画作，而是转头去解决“怎么让 AI 更好用”这个问题。</p>
<p>全新的 ChatGPT “图像”专用界面也印证了这一点：预设滤镜、所见即所得的编辑栏，体验越来越像一个简易版的创意工作室。</p>
<p>如果你是需要稳定输出、精细控制画面的商业用户或设计师，GPT Image 1.5 绝对是目前的效率神器；但如果你追求的是极致的摄影真实感，或者必须处理大量中文文本，那你可能还需要再观望一下，或者结合其他工具一起使用。</p>
<p>AI 生图，终于从“玩具”走向了“工具”。</p>
<p><strong>如果你也对最新的AI信息感兴趣或者有疑问 都可以加入我的大家庭 第一时间分享最新AI资讯、工具、教程、文档 欢迎你的加入！！！😉😉😉</strong></p>
<p>公众号：墨风如雪小站</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[测试 mcp]]></title>    <link>https://juejin.cn/post/7584639987213582370</link>    <guid>https://juejin.cn/post/7584639987213582370</guid>    <pubDate>2025-12-17T15:43:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584639987213582370" data-draft-id="7584689488769646627" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="测试 mcp"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-12-17T15:43:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="青椒肉丝_"/> <meta itemprop="url" content="https://juejin.cn/user/1574156384076631"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            测试 mcp
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1574156384076631/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    青椒肉丝_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T15:43:47.000Z" title="Wed Dec 17 2025 15:43:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>测试 mcp</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[APM（一）：Skywalking 与 Easyearch 集成]]></title>    <link>https://juejin.cn/post/7584722109583392811</link>    <guid>https://juejin.cn/post/7584722109583392811</guid>    <pubDate>2025-12-17T15:45:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584722109583392811" data-draft-id="7584695558158843945" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="APM（一）：Skywalking 与 Easyearch 集成"/> <meta itemprop="keywords" content="数据库,云原生"/> <meta itemprop="datePublished" content="2025-12-17T15:45:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="极限实验室"/> <meta itemprop="url" content="https://juejin.cn/user/1258294223312599"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            APM（一）：Skywalking 与 Easyearch 集成
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1258294223312599/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    极限实验室
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T15:45:24.000Z" title="Wed Dec 17 2025 15:45:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">概述</h2>
<p>SkyWalking 是一个开源的可观测性平台，用于收集、分析、聚合和可视化服务和云原生基础设施的数据。SkyWalking 提供了一种简单的方法，即使在云之间也能保持对分布式系统的清晰视图。它是一个现代的 APM，专门为云原生、基于容器的分布式系统设计。</p>
<p>SkyWalking 涵盖了云原生世界中所有的可观测性需求，包括：</p>
<ul>
<li>Tracing: SkyWalking 原生数据格式，以及 v1 和 v2 格式的 Zipkin 跟踪都得到支持。</li>
<li>Metrics: SkyWalking 支持成熟的指标格式，包括原生计量格式、OTEL 指标格式和 Telegraf 格式。SkyWalking 与服务网格平台（通常为 Istio 和 Envoy）集成，将可观测性构建到数据平面或控制平面。此外，SkyWalking 原生代理可以在指标模式下运行，从而显著提升性能。</li>
<li>Logging: 包括从磁盘收集或通过网络收集的日志。原生代理可以自动将追踪上下文与日志绑定，或使用 SkyWalking 通过文本内容绑定追踪和日志。</li>
<li>Profiling: Profiling 是一种强大的工具，帮助开发者从代码行角度理解应用程序的性能。SkyWalking 提供了内置于原生语言代理和独立的 eBPF 代理的剖析功能。</li>
<li>Event: 事件是一种特殊类型的数据，用于记录系统中的重要时刻，例如版本升级、配置变更等。将事件与指标关联有助于解释指标中的峰值或谷值，将事件与追踪和日志关联有助于排查根本原因。</li>
</ul>
<p>更详细的信息请大家移步 <a href="https://link.juejin.cn?target=https%3A%2F%2Fskywalking.apache.org%2F" target="_blank" title="https://skywalking.apache.org/" ref="nofollow noopener noreferrer">Skywalking</a> 官方网站。</p>
<h2 data-id="heading-1">测试环境</h2>
<p>本篇使用的 Skywalking 版本是 10.2.0 ，需要 Java 11/17/21。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Feasysearch.cn" target="_blank" title="https://easysearch.cn" ref="nofollow noopener noreferrer">Easyearch</a> 使用的版本是 1.14.1，需要开启 Elastic 兼容模式，具体操作参考<a href="https://link.juejin.cn?target=https%3A%2F%2Finfinilabs.cn%2Fblog%2F2025%2Ffilebeat-8-connect-eaysearch%2F" target="_blank" title="https://infinilabs.cn/blog/2025/filebeat-8-connect-eaysearch/" ref="nofollow noopener noreferrer">文档</a> 。</p>
<h2 data-id="heading-2">生成 Java 密钥库文件</h2>
<p>使用如下命令将 Easysearch 的 CA 证书（ca.crt）导入到一个新的 Java 密钥库文件（es_keystore.jks）中，以便 SkyWalking 能够信任由该 CA 颁发的所有证书。生产环境中使用请替换命令中的密码。</p>
<pre><code class="hljs language-plain" lang="plain">keytool -import -v -trustcacerts -file ca.crt -keystore es_keystore.jks -keypass changeit -storepass changeit
</code></pre>
<h2 data-id="heading-3">修改配置文件</h2>
<p>SkyWalking 后端服务配置文件为 config/application.yml，这也是与 Easyearch 集成时需要修改的文件。Skywalking 与 Easyearch 集成有两种通信方式：http 或 https。http 方式非常简单，留给大家自行探索。本篇采用 https 方式，这也是 Easysearch 初始化后默认对外服务的协议。</p>
<p>拷贝上面生成的密钥库文件到 Skywalking 的 home 目录下，修改 application.yml 的 storage 部分</p>
<pre><code class="hljs language-plain" lang="plain">storage:
  selector: ${SW_STORAGE:elasticsearch}
  banyandb:
    # Since 10.2.0, the banyandb configuration is separated to an independent configuration file: `bydb.yaml`.
  elasticsearch:
    namespace: ${SW_NAMESPACE:""}
    clusterNodes: ${SW_STORAGE_ES_CLUSTER_NODES:es1.infini.cloud:9200}
    protocol: ${SW_STORAGE_ES_HTTP_PROTOCOL:"https"}
    connectTimeout: ${SW_STORAGE_ES_CONNECT_TIMEOUT:3000}
    socketTimeout: ${SW_STORAGE_ES_SOCKET_TIMEOUT:30000}
    responseTimeout: ${SW_STORAGE_ES_RESPONSE_TIMEOUT:15000}
    numHttpClientThread: ${SW_STORAGE_ES_NUM_HTTP_CLIENT_THREAD:0}
    user: ${SW_ES_USER:"admin"}
    password: ${SW_ES_PASSWORD:"infiniyyds@2025"}
    trustStorePath: ${SW_STORAGE_ES_SSL_JKS_PATH:"../es_keystore.jks"}
    trustStorePass: ${SW_STORAGE_ES_SSL_JKS_PASS:"changeit"}
</code></pre>
<p>注意 clusterNodes 配置的是域名，需要在 Skywalking 的主机上用 /etc/hosts 解析成具体的地址，如果有多个 Easysearch 节点，可以用逗号分隔。</p>
<h2 data-id="heading-4">启动</h2>
<p>确保 Easysearch 启动完毕后，再启动 Skywalking。正常启动完成后，可访问 Skywalking 服务页面，默认端口 8080。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe31a5b115ff4fb7b7715f1b43de0715~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6B6ZmQ5a6e6aqM5a6k:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766591124&amp;x-signature=dU38PL3hatuLF7MOqB%2BywHF6vLM%3D" alt="" loading="lazy"/></p>
<p>正常连接后，Skywalking 会在 Easysearch 中创建很多 sw 开头的索引。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e1e6ebbc0dc4d689bc34fc7b0025aeb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6B6ZmQ5a6e6aqM5a6k:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766591124&amp;x-signature=ZlwZDf1fS4yNCMbB79vCYCkb04g%3D" alt="" loading="lazy"/></p>
<p>OK，服务集成就到此完毕，后续我们将探索更多的 APM 内容。</p>
<h2 data-id="heading-5">关于 Easysearch</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7542ae07a8a74ff98fd2758290090392~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6B6ZmQ5a6e6aqM5a6k:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766591124&amp;x-signature=I7EipEsj5Wc5FA%2Fn%2BZTWpwgMAwE%3D" alt="" loading="lazy"/></p>
<p>INFINI Easysearch 是一个分布式的搜索型数据库，实现非结构化数据检索、全文检索、向量检索、地理位置信息查询、组合索引查询、多语种支持、聚合分析等。Easysearch 可以完美替代 Elasticsearch，同时添加和完善多项企业级功能。Easysearch 助您拥有简洁、高效、易用的搜索体验。</p>
<p>官网文档：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.infinilabs.com%2Feasysearch" target="_blank" title="https://docs.infinilabs.com/easysearch" ref="nofollow noopener noreferrer">docs.infinilabs.com/easysearch</a></p>
<blockquote>
<p>作者：杨帆，极限科技（INFINI Labs）高级解决方案架构师、《老杨玩搜索》栏目 B 站 UP 主，拥有十余年金融行业服务工作经验，熟悉 Linux、数据库、网络等领域。目前主要从事 Easysearch、Elasticsearch 等搜索引擎的技术支持工作，服务国内私有化部署的客户。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI服务商切换太麻烦?一个AI Gateway搞定监控、缓存和故障转移(成本降40%)]]></title>    <link>https://juejin.cn/post/7584712109171359770</link>    <guid>https://juejin.cn/post/7584712109171359770</guid>    <pubDate>2025-12-17T15:48:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584712109171359770" data-draft-id="7584714813365288998" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI服务商切换太麻烦?一个AI Gateway搞定监控、缓存和故障转移(成本降40%)"/> <meta itemprop="keywords" content="OpenAI,API,后端"/> <meta itemprop="datePublished" content="2025-12-17T15:48:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="技术更好说"/> <meta itemprop="url" content="https://juejin.cn/user/2735240657517816"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI服务商切换太麻烦?一个AI Gateway搞定监控、缓存和故障转移(成本降40%)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2735240657517816/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    技术更好说
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T15:48:14.000Z" title="Wed Dec 17 2025 15:48:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读20分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d51415f7bca49dfa6ff6eb9f798aa93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oqA5pyv5pu05aW96K-0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766591294&amp;x-signature=rt87muK4JZcRFBDDK4b3CbojyRA%3D" alt="2.jpg" loading="lazy"/>
凌晨两点,你被电话吵醒,客户说AI功能挂了。打开监控一看,OpenAI又双叒限流了。你赶紧打开代码,把所有<code>openai.chat.completions.create</code>改成Claude的API,结果发现Claude的请求格式完全不一样,<code>messages</code>要改成<code>anthropic.messages.create</code>,参数结构也不对...改到三点半终于上线,累得要死。
第二天早上,老板发来账单截图:"这个月AI费用怎么从500美元飙到8000美元了?!"你一脸懵,根本不知道钱都花哪了,哪个团队用得最多,有多少是重复请求...完全一团乱麻。
说实话,这种痛苦经历,只要做过AI应用的人都懂。多个AI服务商切来切去太麻烦,成本失控心里慌,服务挂了业务就炸,想想都头疼。
其实,你只需要一个<strong>AI Gateway</strong>,就能彻底解决这些问题。改一行代码,OpenAI、Claude、Gemini随便切;自动故障转移,主模型挂了秒切备用;智能缓存加监控,成本直接降40%。今天这篇文章,我手把手教你10分钟搭建自己的AI Gateway,从此告别半夜改代码的噩梦。</p>
<h2 data-id="heading-0">为什么需要AI Gateway?三个真实痛点</h2>
<h3 data-id="heading-1">痛点1:多服务商切换是噩梦</h3>
<p>你可能有这种经历:项目开始用的OpenAI GPT-4,后来发现Anthropic的Claude在某些任务上效果更好,于是想切过去试试。打开代码一看,整个人都不好了。
OpenAI是这样调用的:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> openai = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenAI</span>({<span class="hljs-attr">apiKey</span>: <span class="hljs-string">'sk-xxx'</span>});
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> openai.<span class="hljs-property">chat</span>.<span class="hljs-property">completions</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">"gpt-4"</span>,
  <span class="hljs-attr">messages</span>: [{<span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">"Hello"</span>}]
});
</code></pre>
<p>Claude是这样的:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> anthropic = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Anthropic</span>({<span class="hljs-attr">apiKey</span>: <span class="hljs-string">'sk-ant-xxx'</span>});
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> anthropic.<span class="hljs-property">messages</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">"claude-3-5-sonnet-20241022"</span>,
  <span class="hljs-attr">max_tokens</span>: <span class="hljs-number">1024</span>,
  <span class="hljs-attr">messages</span>: [{<span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">"Hello"</span>}]
});
</code></pre>
<p>看到没?连基础结构都不一样,还有一堆参数差异。如果你的代码里有几十个地方调用AI,改起来能崩溃。更惨的是,Google Gemini、Cohere、Azure OpenAI...每家API格式都不一样,这哪顶得住啊!
数据不会骗人:调研显示<strong>70%的AI应用都在用2个以上的模型服务商</strong>。为啥?不同模型擅长不同任务,GPT-4贵但效果好,Claude便宜点适合批量,Gemini免费额度高适合测试...你总得切换吧?但切换成本高到让人怀疑人生。</p>
<h3 data-id="heading-2">痛点2:成本黑洞无法控制</h3>
<p>说个真事:我朋友公司做了个AI客服,开始每月500美元,挺正常。突然某个月账单8000美元,老板直接炸了。查了半天才发现,是有个开发测试时忘了删日志,每次请求都调了两遍API,而且缓存没开,同样的问题重复问了无数次。
这就是没有统一监控的痛。你根本不知道:</p>
<ul>
<li><strong>每天花了多少钱?</strong> 等账单出来已经晚了</li>
<li><strong>哪个团队用得最猛?</strong> 产品那边在疯狂测试,你还被蒙在鼓里</li>
<li><strong>哪些请求最贵?</strong> GPT-4的长文本生成是大头,但你不知道</li>
<li><strong>有多少浪费?</strong> 40%的重复请求在烧钱,你看不见
某机构报告显示,企业AI支出同比增长<strong>300%</strong>,但其中有<strong>40%是重复请求造成的浪费</strong>。这钱花得多冤啊!</li>
</ul>
<h3 data-id="heading-3">痛点3:单点故障随时爆炸</h3>
<p>2024年OpenAI至少宕机了6次,平均每次2小时。如果你的服务完全依赖OpenAI,那就是:</p>
<ul>
<li>凌晨4点,告警炸了</li>
<li>客户投诉涌进来</li>
<li>你盯着OpenAI状态页面干着急</li>
<li>老板问你怎么回事,你说"OpenAI挂了,我也没办法"</li>
<li>老板:"那为啥不搞个备用的?"</li>
<li>你:"......"
没有容错机制就是这么被动。主模型一挂,业务跟着挂,完全没有Plan B。你说慌不慌?
其实,如果有个<strong>AI Gateway配置好自动故障转移(Fallback)</strong>,OpenAI挂了自动切换到Claude,Claude也挂了再切Gemini,整个过程秒级完成,用户甚至感觉不到。可用性直接从95%干到99.9%以上。</li>
</ul>
<h2 data-id="heading-4">AI Gateway核心功能全解析</h2>
<p>说了这么多痛点,那AI Gateway到底是咋解决的?其实它就像一个超级中间层,站在你的应用和各个AI服务商之间,帮你搞定所有脏活累活。</p>
<h3 data-id="heading-5">功能1:统一API入口 - 一套代码走天下</h3>
<p>这个功能简直太爽了。你还是用熟悉的OpenAI SDK写代码,但只需要改一行<code>baseURL</code>,就能调用Claude、Gemini、甚至200+种模型。
比如用Portkey Gateway,你的代码是这样:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> openai = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenAI</span>({
  <span class="hljs-attr">apiKey</span>: <span class="hljs-string">'your-openai-key'</span>,
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">"http://localhost:8787/v1"</span>,  <span class="hljs-comment">// 就改这一行!</span>
  <span class="hljs-attr">defaultHeaders</span>: {
    <span class="hljs-string">'x-portkey-provider'</span>: <span class="hljs-string">'openai'</span>  <span class="hljs-comment">// 想切Claude?改成'anthropic'就行</span>
  }
});
<span class="hljs-comment">// 后面代码一行不改</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> openai.<span class="hljs-property">chat</span>.<span class="hljs-property">completions</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">"gpt-4"</span>,
  <span class="hljs-attr">messages</span>: [{<span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">"Hello"</span>}]
});
</code></pre>
<p>想切换到Claude?把<code>x-portkey-provider</code>改成<code>anthropic</code>,model改成<code>claude-3-5-sonnet-20241022</code>,完事!不用改任何业务逻辑,是不是超简单?
Cloudflare的方案也类似,只需要把baseURL指向他们的Gateway endpoint就行。这样一来,你随时可以在OpenAI、Anthropic、Google、Azure之间切换,再也不用改一堆代码了。</p>
<h3 data-id="heading-6">功能2:智能缓存省钱 - 重复问题不花钱</h3>
<p>这个功能是真省钱。原理很简单:AI Gateway会记住之前问过的问题和答案,如果有人又问了一遍,直接返回缓存结果,不调用API,不花token。
AI Gateway支持两种缓存:</p>
<ul>
<li><strong>精确缓存</strong>:问题文本完全一样才命中。比如你问了"什么是AI?",下次再问这6个字,直接返回缓存</li>
<li><strong>语义缓存</strong>:意思差不多就行。"什么是AI?"和"AI是什么?"是同一个意思,也能命中缓存
阿里云的数据显示,<strong>通义千问的缓存命中价格只有原价的40%</strong>。如果你的缓存命中率能做到50%,成本直接砍一半!
实际场景超级有用。比如客服机器人,用户经常问"怎么退货?""运费多少?",这些高频问题开启缓存后,成本能降60%以上。
不过要注意,实时性要求高的别用缓存。比如"今天天气怎么样?""最新新闻是啥?",这种问题缓存了就不对了。AI Gateway一般允许你配置缓存规则,哪些路径开缓存,缓存多久(TTL),都能自己定。</li>
</ul>
<h3 data-id="heading-7">功能3:自动故障转移(Fallback) - 主模型挂了秒切备用</h3>
<p>这个功能是稳定性保障。你可以配置多级Fallback策略,比如:</p>
<ol>
<li>先调OpenAI GPT-4,重试5次</li>
<li>如果还失败,自动切换到Claude 3.5 Sonnet</li>
<li>Claude也挂了,最后用Gemini Pro兜底
整个过程自动化,你的业务代码完全无感知。看个Portkey的配置示例:</li>
</ol>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"retry"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"strategy"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"mode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fallback"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"targets"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"openai"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"api_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sk-xxx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"override_params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gpt-4"</span><span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"anthropic"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"api_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sk-ant-xxx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"override_params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"claude-3-5-sonnet-20241022"</span><span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"google"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"api_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gt5xxx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"override_params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gemini-pro"</span><span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>只要在header里传这个配置,Gateway就会按照你设定的顺序自动Fallback。Cloudflare的Universal Endpoint也支持类似功能,一个请求里填多个provider,自动切换。
有了这个,可用性能从95%提升到<strong>99.9%以上</strong>。OpenAI宕机?不怕,自动切Claude。Claude限流?没事,Gemini顶上。用户根本察觉不到,稳得一批。</p>
<h3 data-id="heading-8">功能4:请求监控和成本分析 - 花钱心里有数</h3>
<p>AI Gateway会实时记录每个请求的关键指标:</p>
<ul>
<li><strong>QPS</strong>:每秒请求数,流量高峰一目了然</li>
<li><strong>Token消耗</strong>:每个模型用了多少token,实时统计</li>
<li><strong>成本</strong>:按不同模型的定价算出实际花费</li>
<li><strong>错误率</strong>:哪些请求失败了,什么原因
Cloudflare的监控面板特别强,除了基础的QPS和Error Rate,还有专门针对LLM的Token、Cost和Cache命中率面板。你能看到:</li>
<li>今天花了多少钱,趋势是涨是跌</li>
<li>哪个团队(消费者)用得最多</li>
<li>哪个模型最贵</li>
<li>缓存帮你省了多少钱
这下心里有数了吧?成本失控的问题彻底解决。你还能设置告警,比如"日消耗超100美元就通知我",预算超了第一时间知道。</li>
</ul>
<h3 data-id="heading-9">功能5:限流和权限管理 - 不让某个团队搞崩服务</h3>
<p>企业级场景必备功能。你可以给不同团队分配独立的API Key,每个Key有自己的配额和限流规则。
比如:</p>
<ul>
<li>研发团队:每天10万token额度,用GPT-4</li>
<li>测试团队:每天1万token额度,只能用GPT-3.5</li>
<li>产品团队:每天5万token额度,用Claude
这样一来,测试团队疯狂调用也不会把额度耗光,影响生产环境。每个团队用了多少,一清二楚。
高级一点的AI Gateway还支持<strong>敏感内容过滤</strong>,自动检测和拦截违规请求,保护数据安全。阿里云Higress就有这个能力,企业级安全管控都能搞定。</li>
</ul>
<h2 data-id="heading-10">三大主流方案对比:Cloudflare vs Portkey vs 阿里云</h2>
<p>市面上AI Gateway方案挺多,但主流的就这三家。咱们客观对比一下,帮你选出最适合的。</p>
<h3 data-id="heading-11">方案1:Cloudflare AI Gateway - 新手友好,上手最快</h3>
<p><strong>优势</strong>:</p>
<ul>
<li><strong>完全免费</strong>:所有Cloudflare账号都能用,不额外收费</li>
<li><strong>零部署</strong>:不用装任何东西,注册账号就能用</li>
<li><strong>一行代码接入</strong>:改个baseURL就行,5分钟搞定</li>
<li><strong>全球加速</strong>:靠Cloudflare的CDN网络,速度快
<strong>限制</strong>:</li>
<li>数据会经过Cloudflare的服务器(虽然他们承诺不看)</li>
<li>语义缓存还在计划中,目前只有精确缓存</li>
<li>支持的模型相对少,10+主流提供商
<strong>适合场景</strong>:</li>
<li>个人项目,快速验证想法</li>
<li>小团队,没有运维资源</li>
<li>对数据隐私要求不那么严格的场景
Cloudflare的数据很牛,自2023年9月beta版发布以来,已经代理了<strong>超过5亿个请求</strong>。证明确实好用,大家都在用。</li>
</ul>
<h3 data-id="heading-12">方案2:Portkey Gateway - 企业首选,功能最强</h3>
<p><strong>优势</strong>:</p>
<ul>
<li><strong>开源免费</strong>:GitHub上开源,私有部署完全可控</li>
<li><strong>支持超多模型</strong>:200+ LLM,基本你能想到的都支持</li>
<li><strong>性能爆表</strong>:官方数据比其他网关快9.9倍,安装后仅45kb</li>
<li><strong>功能最全</strong>:负载均衡、自动重试、指数退避、50+护栏规则全都有
<strong>部署方式</strong>:</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 本地运行超简单</span>
npx @portkey-ai/gateway
<span class="hljs-comment"># 你的AI Gateway现在运行在 http://localhost:8787</span>
</code></pre>
<p><strong>特色功能</strong>:</p>
<ul>
<li>支持语义缓存(DashVector向量缓存)</li>
<li>自动重试机制特别智能,结合指数退避策略</li>
<li>可以部署到Cloudflare Workers、Docker、Node.js、Replit等多种环境
<strong>适合场景</strong>:</li>
<li>中大型企业,有数据安全合规要求</li>
<li>需要私有化部署</li>
<li>想要最强大的功能和最高的性能</li>
</ul>
<h3 data-id="heading-13">方案3:阿里云Higress - 国内企业最佳</h3>
<p><strong>优势</strong>:</p>
<ul>
<li><strong>国内访问快</strong>:服务器在国内,延迟低</li>
<li><strong>深度集成</strong>:无缝对接阿里云百炼、PAI平台</li>
<li><strong>企业级稳定</strong>:阿里内部在用,支撑他们自己的AI应用</li>
<li><strong>MCP协议支持</strong>:支持API快速转MCP,适配最新标准
<strong>技术亮点</strong>:</li>
<li>三合一架构:容器网关 + 微服务网关 + AI网关</li>
<li>支持多云和私有化部署</li>
<li>专门针对国内大模型优化(通义、文心一言等)
<strong>适合场景</strong>:</li>
<li>已经在用阿里云的企业</li>
<li>需要混合云架构(本地+云端)</li>
<li>主要面向国内用户,延迟敏感</li>
</ul>
<h3 data-id="heading-14">三大方案对比表</h3>







































































<table><thead><tr><th>功能</th><th>Cloudflare</th><th>Portkey</th><th>Higress</th></tr></thead><tbody><tr><td><strong>部署方式</strong></td><td>云服务</td><td>开源/云服务</td><td>私有化/云</td></tr><tr><td><strong>价格</strong></td><td>免费</td><td>开源免费</td><td>按量付费</td></tr><tr><td><strong>支持模型数</strong></td><td>10+</td><td>200+</td><td>主流全覆盖</td></tr><tr><td><strong>语义缓存</strong></td><td>计划中</td><td>✅ 支持</td><td>✅ 支持</td></tr><tr><td><strong>私有部署</strong></td><td>❌</td><td>✅</td><td>✅</td></tr><tr><td><strong>国内访问</strong></td><td>一般</td><td>一般</td><td>⭐⭐⭐</td></tr><tr><td><strong>监控面板</strong></td><td>⭐⭐⭐</td><td>⭐⭐</td><td>⭐⭐⭐</td></tr><tr><td><strong>上手难度</strong></td><td>超简单</td><td>简单</td><td>中等</td></tr><tr><td><strong>企业级功能</strong></td><td>基础</td><td>⭐⭐⭐</td><td>⭐⭐⭐</td></tr><tr><td><strong>我的建议</strong>:</td><td/><td/><td/></tr></tbody></table>
<ul>
<li><strong>个人项目/快速测试</strong> → Cloudflare,5分钟上手,完全免费</li>
<li><strong>创业公司/中小企业</strong> → Portkey,开源免费,功能够用</li>
<li><strong>大型企业/已用阿里云</strong> → Higress,稳定可靠,服务有保障</li>
<li><strong>海外项目</strong> → Cloudflare或Portkey,别选国内的</li>
<li><strong>国内项目且延迟敏感</strong> → Higress,国内访问最快</li>
</ul>
<h2 data-id="heading-15">实战演练:10分钟搭建你的第一个AI Gateway</h2>
<p>光说不练假把式,咱们直接动手搞一个。我选<strong>Portkey</strong>做示范,因为它本地就能跑,不用注册账号,最快验证效果。</p>
<h3 data-id="heading-16">Step 1:一键部署Gateway(30秒)</h3>
<p>打开终端,运行:</p>
<pre><code class="hljs language-bash" lang="bash">npx @portkey-ai/gateway
</code></pre>
<p>看到这个提示就成功了:</p>
<pre><code class="hljs language-arduino" lang="arduino">🚀 AI Gateway running on http:<span class="hljs-comment">//localhost:8787</span>
</code></pre>
<p>就这么简单!你的AI Gateway已经在本地跑起来了。控制台访问 <code>http://localhost:8787/public/</code> 还能看到管理界面。</p>
<h3 data-id="heading-17">Step 2:配置多模型Fallback(2分钟)</h3>
<p>现在配置一个三级备份策略:OpenAI → Claude → Gemini。
创建一个配置文件 <code>gateway-config.json</code>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"retry"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"strategy"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"mode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fallback"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"targets"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"openai"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"api_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"你的OpenAI Key"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"override_params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gpt-4"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"anthropic"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"api_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"你的Claude Key"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"override_params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"claude-3-5-sonnet-20241022"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"google"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"api_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"你的Google Key"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"override_params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gemini-pro"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>配置说明</strong>:</p>
<ul>
<li><code>retry.count: 5</code> → 主模型失败时重试5次</li>
<li><code>strategy.mode: "fallback"</code> → 使用故障转移模式</li>
<li><code>targets</code> → 按顺序尝试三个提供商</li>
</ul>
<h3 data-id="heading-18">Step 3:改造你的业务代码(1分钟)</h3>
<p>原来你的代码可能是这样:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> openai = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenAI</span>({
  <span class="hljs-attr">apiKey</span>: <span class="hljs-string">'sk-xxx'</span>
});
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> openai.<span class="hljs-property">chat</span>.<span class="hljs-property">completions</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">"gpt-4"</span>,
  <span class="hljs-attr">messages</span>: [{<span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">"写一首诗"</span>}]
});
</code></pre>
<p>现在只需要改3行:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> config = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'./gateway-config.json'</span>));
<span class="hljs-keyword">const</span> openai = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenAI</span>({
  <span class="hljs-attr">apiKey</span>: <span class="hljs-string">'any-key'</span>,  <span class="hljs-comment">// 不重要了,配置文件里有真实的key</span>
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">"http://localhost:8787/v1"</span>,  <span class="hljs-comment">// 👈 改这里</span>
  <span class="hljs-attr">defaultHeaders</span>: {
    <span class="hljs-string">'x-portkey-config'</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(config)  <span class="hljs-comment">// 👈 加这个</span>
  }
});
<span class="hljs-comment">// 后面完全不用改!</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> openai.<span class="hljs-property">chat</span>.<span class="hljs-property">completions</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">"gpt-4"</span>,  <span class="hljs-comment">// 这个会被配置里的override_params覆盖</span>
  <span class="hljs-attr">messages</span>: [{<span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">"写一首诗"</span>}]
});
</code></pre>
<p>就这样!现在你的代码已经有了三级容错能力。OpenAI挂了自动切Claude,完全无感知。</p>
<h3 data-id="heading-19">Step 4:测试Fallback效果(1分钟)</h3>
<p>故意让OpenAI失败,验证是否自动切换。把配置文件里OpenAI的api_key改成错误的:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"openai"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"api_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sk-wrong-key"</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 👈 故意写错</span>
  <span class="hljs-attr">"override_params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gpt-4"</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>运行代码,观察日志:</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">Gateway</span>] OpenAI request failed: Invalid API Key
[<span class="hljs-meta">Gateway</span>] Retrying <span class="hljs-keyword">with</span> anthropic...
[<span class="hljs-meta">Gateway</span>] <span class="hljs-function">Success <span class="hljs-keyword">with</span> <span class="hljs-title">anthropic</span> (<span class="hljs-params">claude<span class="hljs-number">-3</span><span class="hljs-number">-5</span>-sonnet<span class="hljs-number">-20241022</span></span>)
</span></code></pre>
<p>看到没?Gateway检测到OpenAI失败后,自动重试了5次,然后切换到Claude,最终成功返回结果。整个过程自动化,你的代码完全不需要处理错误。</p>
<h3 data-id="heading-20">Step 5:开启缓存降低成本(2分钟)</h3>
<p>Portkey支持缓存,但需要配置。简化版可以用Redis:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 如果你有Redis,可以这样配置缓存</span>
<span class="hljs-keyword">const</span> openai = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenAI</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">"http://localhost:8787/v1"</span>,
  <span class="hljs-attr">defaultHeaders</span>: {
    <span class="hljs-string">'x-portkey-config'</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(config),
    <span class="hljs-string">'x-portkey-cache'</span>: <span class="hljs-string">'simple'</span>,  <span class="hljs-comment">// 开启简单缓存</span>
    <span class="hljs-string">'x-portkey-cache-force-refresh'</span>: <span class="hljs-string">'false'</span>
  }
});
</code></pre>
<p>第一次请求:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">await</span> openai.<span class="hljs-property">chat</span>.<span class="hljs-property">completions</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">messages</span>: [{<span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">"什么是AI?"</span>}]
});
<span class="hljs-comment">// 调用真实API,耗时800ms,花费0.002美元</span>
</code></pre>
<p>第二次相同请求:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">await</span> openai.<span class="hljs-property">chat</span>.<span class="hljs-property">completions</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">messages</span>: [{<span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">"什么是AI?"</span>}]
});
<span class="hljs-comment">// 命中缓存,耗时50ms,花费0美元</span>
</code></pre>
<p>看到效果了吧?速度快了16倍,成本直接省掉。高频问题越多,省得越多。</p>
<h3 data-id="heading-21">Step 6:查看监控数据(1分钟)</h3>
<p>访问 <code>http://localhost:8787/public/</code>,你能看到:</p>
<ul>
<li>总请求数和成功率</li>
<li>每个provider的调用次数</li>
<li>缓存命中率</li>
<li>错误日志
虽然Portkey本地版的监控面板比较简单,但够用了。如果你要更强大的监控,可以:</li>
<li>用Portkey Cloud(他们的托管版,免费额度够个人用)</li>
<li>换Cloudflare AI Gateway(监控面板超强)</li>
<li>自己对接Prometheus + Grafana</li>
</ul>
<h3 data-id="heading-22">完整示例代码</h3>
<p>把上面的整合起来,一个完整的例子:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">OpenAI</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'openai'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-comment">// 读取配置文件</span>
<span class="hljs-keyword">const</span> config = {
  <span class="hljs-string">"retry"</span>: {<span class="hljs-string">"count"</span>: <span class="hljs-number">5</span>},
  <span class="hljs-string">"strategy"</span>: {<span class="hljs-string">"mode"</span>: <span class="hljs-string">"fallback"</span>},
  <span class="hljs-string">"targets"</span>: [
    {
      <span class="hljs-string">"provider"</span>: <span class="hljs-string">"openai"</span>,
      <span class="hljs-string">"api_key"</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">OPENAI_KEY</span>,
      <span class="hljs-string">"override_params"</span>: {<span class="hljs-string">"model"</span>: <span class="hljs-string">"gpt-4"</span>}
    },
    {
      <span class="hljs-string">"provider"</span>: <span class="hljs-string">"anthropic"</span>,
      <span class="hljs-string">"api_key"</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">ANTHROPIC_KEY</span>,
      <span class="hljs-string">"override_params"</span>: {<span class="hljs-string">"model"</span>: <span class="hljs-string">"claude-3-5-sonnet-20241022"</span>}
    }
  ]
};
<span class="hljs-comment">// 初始化客户端</span>
<span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenAI</span>({
  <span class="hljs-attr">apiKey</span>: <span class="hljs-string">'placeholder'</span>,
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">"http://localhost:8787/v1"</span>,
  <span class="hljs-attr">defaultHeaders</span>: {
    <span class="hljs-string">'x-portkey-config'</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(config),
    <span class="hljs-string">'x-portkey-cache'</span>: <span class="hljs-string">'simple'</span>
  }
});
<span class="hljs-comment">// 使用</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">prompt</span>) {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> client.<span class="hljs-property">chat</span>.<span class="hljs-property">completions</span>.<span class="hljs-title function_">create</span>({
    <span class="hljs-attr">model</span>: <span class="hljs-string">"gpt-4"</span>,  <span class="hljs-comment">// 实际模型由配置决定</span>
    <span class="hljs-attr">messages</span>: [{<span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: prompt}]
  });
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">message</span>.<span class="hljs-property">content</span>;
}
<span class="hljs-comment">// 测试</span>
<span class="hljs-title function_">chat</span>(<span class="hljs-string">"用一句话解释AI Gateway"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>);
</code></pre>
<p>运行后,你会发现即使OpenAI失败,也能从Claude拿到回复,完全不影响业务。
<strong>实测数据</strong>:</p>
<ul>
<li><strong>部署时间</strong>:30秒(一行命令)</li>
<li><strong>改造成本</strong>:改3行代码,5分钟搞定</li>
<li><strong>成本降低</strong>:缓存命中率30%的情况下,成本降低<strong>约30%</strong></li>
<li><strong>可用性提升</strong>:从单模型95%提升到多模型<strong>99.5%以上</strong></li>
</ul>
<h2 data-id="heading-23">企业级最佳实践与避坑指南</h2>
<p>搭建AI Gateway只是第一步,要真正用好它,还得注意这些细节。这些都是实际踩过的坑,血泪教训啊!</p>
<h3 data-id="heading-24">最佳实践1:分环境管理 - 开发生产别混用</h3>
<p>这个坑我踩过。一开始图省事,开发测试生产都用一个Gateway配置,结果:</p>
<ul>
<li>测试团队在生产环境疯狂调用,把配额耗光</li>
<li>开发调试时改了配置,生产也跟着变,直接炸了</li>
<li>账单分不清哪些是测试,哪些是真实业务
<strong>正确做法</strong>:</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 根据环境变量切换配置</span>
<span class="hljs-keyword">const</span> config = process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">'production'</span>
  ? productionConfig  <span class="hljs-comment">// 生产:用GPT-4 + Claude 3.5备份</span>
  : developmentConfig; <span class="hljs-comment">// 开发:用GPT-3.5省钱,甚至用本地模型</span>
<span class="hljs-comment">// 生产配置</span>
<span class="hljs-keyword">const</span> productionConfig = {
  <span class="hljs-string">"targets"</span>: [
    {<span class="hljs-string">"provider"</span>: <span class="hljs-string">"openai"</span>, <span class="hljs-string">"api_key"</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">PROD_OPENAI_KEY</span>,
     <span class="hljs-string">"override_params"</span>: {<span class="hljs-string">"model"</span>: <span class="hljs-string">"gpt-4"</span>}},
    {<span class="hljs-string">"provider"</span>: <span class="hljs-string">"anthropic"</span>, <span class="hljs-string">"api_key"</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">PROD_ANTHROPIC_KEY</span>,
     <span class="hljs-string">"override_params"</span>: {<span class="hljs-string">"model"</span>: <span class="hljs-string">"claude-3-5-sonnet-20241022"</span>}}
  ]
};
<span class="hljs-comment">// 开发配置</span>
<span class="hljs-keyword">const</span> developmentConfig = {
  <span class="hljs-string">"targets"</span>: [
    {<span class="hljs-string">"provider"</span>: <span class="hljs-string">"openai"</span>, <span class="hljs-string">"api_key"</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DEV_OPENAI_KEY</span>,
     <span class="hljs-string">"override_params"</span>: {<span class="hljs-string">"model"</span>: <span class="hljs-string">"gpt-3.5-turbo"</span>}}  <span class="hljs-comment">// 便宜的模型</span>
  ]
};
</code></pre>
<p>这样开发测试想怎么玩怎么玩,不影响生产。API Key也分开,安全又省钱。</p>
<h3 data-id="heading-25">最佳实践2:成本控制策略 - 不让账单失控</h3>
<p>没有成本控制就是烧钱。这几个策略必须上:
<strong>1. 为每个团队设置月度预算</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 在Gateway配置里设置限额</span>
{
  <span class="hljs-string">"consumer"</span>: <span class="hljs-string">"product-team"</span>,
  <span class="hljs-string">"budget"</span>: {
    <span class="hljs-string">"monthly_limit_usd"</span>: <span class="hljs-number">1000</span>,  <span class="hljs-comment">// 每月最多1000美元</span>
    <span class="hljs-string">"alert_threshold"</span>: <span class="hljs-number">0.8</span>  <span class="hljs-comment">// 80%时告警</span>
  }
}
</code></pre>
<p><strong>2. 高频问题必须开缓存</strong>
统计你的请求,找出Top 10高频问题,全部开缓存。比如客服场景:</p>
<ul>
<li>"怎么退货?"</li>
<li>"运费多少?"</li>
<li>"发票怎么开?"
这些问题答案基本不变,缓存一周都没问题,能省60%以上的成本。
<strong>3. 定期审查Token消耗</strong>
每周看一次监控面板,找出Token消耗Top 10的请求:</li>
<li>有没有异常长的输入?(有人可能把整本书丢进去了)</li>
<li>哪些请求成本特别高?能不能优化prompt?</li>
<li>有没有重复请求?为啥没命中缓存?
我朋友公司发现有个请求每次都用8000 token,一查才知道prompt里包含了一堆不必要的例子。优化后降到2000 token,成本直接砍75%。</li>
</ul>
<h3 data-id="heading-26">最佳实践3:安全防护 - 别让敏感数据泄露</h3>
<p>这个特别重要,尤其企业场景。</p>
<p><strong>1. 敏感数据不要发外部API</strong>
配置内容过滤器,自动检测手机号、身份证、信用卡等敏感信息:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 伪代码,实际需要在Gateway层配置</span>
<span class="hljs-keyword">if</span> (request.<span class="hljs-property">content</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-variable constant_">PHONE_PATTERN</span>)) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">error</span>(<span class="hljs-string">"检测到敏感信息,请求已拦截"</span>);
}
</code></pre>
<p>Higress这类企业级网关都支持这个功能。</p>
<p><strong>2. API Key定期轮换</strong>
不要一个Key用到天荒地老。每3个月轮换一次,泄露了也能及时止损。用Secret Manager管理,别硬编码在代码里。</p>
<p><strong>3. 生产环境日志脱敏</strong>
Gateway的日志里别记录完整的用户输入,万一日志泄露就炸了:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 日志示例(脱敏后)</span>
{
  <span class="hljs-string">"request_id"</span>: <span class="hljs-string">"abc123"</span>,
  <span class="hljs-string">"model"</span>: <span class="hljs-string">"gpt-4"</span>,
  <span class="hljs-string">"input_length"</span>: <span class="hljs-number">256</span>,  <span class="hljs-comment">// 只记录长度</span>
  <span class="hljs-string">"input_sample"</span>: <span class="hljs-string">"用户咨询关于...[已脱敏]"</span>,  <span class="hljs-comment">// 前10个字+脱敏</span>
  <span class="hljs-string">"cost"</span>: <span class="hljs-number">0.002</span>
}
</code></pre>
<h3 data-id="heading-27">避坑指南1:缓存滥用 - 实时数据别缓存</h3>
<p><strong>踩坑案例</strong>:某天用户投诉"你们的天气预报怎么总是不准?"一查,原来AI返回的天气信息被缓存了24小时,用户早上问是晴天,晚上下雨了还说晴天。
<strong>解决方案</strong>:
区分场景,设置缓存白名单:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> cacheRules = {
  <span class="hljs-comment">// 可以缓存的路径</span>
  <span class="hljs-attr">cacheable</span>: [
    <span class="hljs-string">"/api/ai/faq"</span>,  <span class="hljs-comment">// 常见问题</span>
    <span class="hljs-string">"/api/ai/docs-summary"</span>  <span class="hljs-comment">// 文档总结</span>
  ],
  <span class="hljs-comment">// 禁止缓存的路径</span>
  <span class="hljs-attr">nocache</span>: [
    <span class="hljs-string">"/api/ai/realtime"</span>,  <span class="hljs-comment">// 实时数据</span>
    <span class="hljs-string">"/api/ai/news"</span>,  <span class="hljs-comment">// 新闻类</span>
    <span class="hljs-string">"/api/ai/personalized"</span>  <span class="hljs-comment">// 个性化内容</span>
  ]
};
</code></pre>
<p>或者设置很短的TTL:</p>
<pre><code class="hljs language-javascript" lang="javascript">{
  <span class="hljs-string">"cache"</span>: {
    <span class="hljs-string">"ttl"</span>: <span class="hljs-number">300</span>  <span class="hljs-comment">// 5分钟,适合准实时场景</span>
  }
}
</code></pre>
<h3 data-id="heading-28">避坑指南2:Fallback配置不当 - 备用模型能力要匹配</h3>
<p><strong>踩坑案例</strong>:为了省钱,配置了GPT-4 fallback到GPT-3.5。结果GPT-4偶尔限流时,自动切到GPT-3.5,生成质量暴跌,用户直接投诉"你们的AI怎么突然变傻了?"
<strong>解决方案</strong>:
备用模型选同级别的,不要降级:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"targets"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span><span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"openai"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gpt-4"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span><span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"anthropic"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"claude-3-5-sonnet"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// ✅ 同级别</span>
    <span class="hljs-punctuation">{</span><span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"google"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gemini-pro"</span><span class="hljs-punctuation">}</span>  <span class="hljs-comment">// ✅ 同级别</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>不要这样:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"targets"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span><span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"openai"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gpt-4"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span><span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"openai"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gpt-3.5-turbo"</span><span class="hljs-punctuation">}</span>  <span class="hljs-comment">// ❌ 降级了</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>如果实在要降级备用,至少做个提示:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (response.<span class="hljs-property">provider</span> === <span class="hljs-string">'fallback_model'</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'当前使用备用模型,质量可能下降'</span>);
}
</code></pre>
<h3 data-id="heading-29">避坑指南3:监控指标不看 - 部署了等于没部署</h3>
<p><strong>常见问题</strong>:很多团队辛辛苦苦部署了Gateway,结果从来不看监控面板,等出问题了才发现早就有征兆。
<strong>解决方案</strong>:</p>
<ol>
<li><strong>设置周报自动发送</strong>
每周一早上自动发邮件,包含:
<ul>
<li>上周总请求数、成功率、成本</li>
<li>Token消耗Top 10</li>
<li>错误日志汇总</li>
<li>缓存命中率趋势</li>
</ul>
</li>
<li><strong>关键指标告警</strong>
必须配置的告警:
<ul>
<li>成本告警:日消耗超预算80%</li>
<li>错误率告警:失败率超5%</li>
<li>延迟告警:P99延迟超3秒</li>
<li>Fallback告警:备用模型调用超20%</li>
</ul>
</li>
<li><strong>每周Review会议</strong>
技术负责人每周花15分钟看一次数据,问三个问题:
<ul>
<li>有没有异常的成本增长?</li>
<li>哪些错误可以优化?</li>
<li>缓存命中率还能提升吗?
<strong>真实案例</strong>:某公司每周Review后发现,周三下午3-5点请求量特别大。一查是产品团队每周三开会,会上疯狂测试新功能。调整后让他们用开发环境测试,生产环境成本直接降30%。</li>
</ul>
</li>
</ol>
<h2 data-id="heading-30">结论</h2>
<p>说了这么多,其实核心就三句话:</p>
<p><strong>第一</strong>,多AI服务商切换、成本失控、单点故障,这三个痛点只要做AI应用就避不开。你可以选择每次半夜起来改代码,也可以选择一次性把AI Gateway搭起来,从此高枕无忧。</p>
<p><strong>第二</strong>,AI Gateway不是什么高深技术,10分钟就能跑起来。Portkey一行命令,Cloudflare注册就能用,真没那么复杂。改3行代码,就能获得多模型Fallback、智能缓存、全局监控,成本降40%,可用性提升到99.9%,这买卖划算得不行。</p>
<p><strong>第三</strong>,部署只是开始,真正的价值在于<strong>持续优化</strong>。每周看一次监控数据,调整缓存策略,优化Fallback配置,清理无效请求...这些小动作积累下来,半年能帮你省几千甚至上万美元。
<strong>现在就行动</strong>:</p>
<ol>
<li><strong>今天就试试</strong>:花10分钟跑一个Portkey本地实例,感受一下有多简单</li>
<li><strong>小步快跑</strong>:先在一个小项目试点,成功了再推广到全公司</li>
<li><strong>养成习惯</strong>:每周一看一次监控面板,每月Review一次成本数据</li>
<li><strong>分享经验</strong>:评论区说说你用AI Gateway遇到的问题,咱们一起交流
别等了,多服务商切换的麻烦只会越来越多,成本只会越来越高。早一天部署AI Gateway,早一天省心省钱。试试吧,反正又不花钱,万一效果好呢?</li>
</ol>
<blockquote>
<p>原文首发<a href="https://link.juejin.cn?target=https%3A%2F%2Feastondev.com%2Fblog%2Fzh%2Fposts%2Fai%2F20251201-ai-gateway-guide%2F" target="_blank" title="https://eastondev.com/blog/zh/posts/ai/20251201-ai-gateway-guide/" ref="nofollow noopener noreferrer">自个人博客</a></p>
</blockquote>
<hr/>
<p><strong>参考资料</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cloudflare.com%2Fai-gateway-is-generally-available%2F" target="_blank" title="https://blog.cloudflare.com/ai-gateway-is-generally-available/" ref="nofollow noopener noreferrer">Cloudflare AI Gateway官方博客</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FPortkey-AI%2Fgateway" target="_blank" title="https://github.com/Portkey-AI/gateway" ref="nofollow noopener noreferrer">Portkey Gateway GitHub仓库</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Fapi-gateway%2Fai-gateway%2Fproduct-overview%2Fwhat-is-an-ai-gateway" target="_blank" title="https://help.aliyun.com/zh/api-gateway/ai-gateway/product-overview/what-is-an-ai-gateway" ref="nofollow noopener noreferrer">阿里云AI网关文档</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Fapi-gateway%2Fai-gateway%2Fuser-guide%2Fai-fallback" target="_blank" title="https://help.aliyun.com/zh/api-gateway/ai-gateway/user-guide/ai-fallback" ref="nofollow noopener noreferrer">AI Fallback配置指南</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[使用命令行工具 ogr2ogr 将 CSV 转换为 Shp 数据（二）]]></title>    <link>https://juejin.cn/post/7584659460246781971</link>    <guid>https://juejin.cn/post/7584659460246781971</guid>    <pubDate>2025-12-17T14:08:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584659460246781971" data-draft-id="7584659460246683667" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="使用命令行工具 ogr2ogr 将 CSV 转换为 Shp 数据（二）"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-12-17T14:08:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GIS之路"/> <meta itemprop="url" content="https://juejin.cn/user/4346787284915481"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            使用命令行工具 ogr2ogr 将 CSV 转换为 Shp 数据（二）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4346787284915481/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GIS之路
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T14:08:19.000Z" title="Wed Dec 17 2025 14:08:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<blockquote>
<p>❝</p>
<p><strong>ogr2ogr</strong> 是一个数据转换工具，可用于在文件格式之间转换简单要素数据。它还可以在转换过程中执行各种操作，如空间或属性选择、减少属性集、设置输出坐标系，甚至在转换过程中重新投影特征。</p>
</blockquote>
<p>如有兴趣，可参阅文章：</p>
<p>GDAL 实现将 CSV 转换为 Shp 数据（一）[1]</p>
<p><code>ogr2ogr</code> 作为 <code>GDAL（Geospatial Data Abstraction Library）</code>库中的一个命令行工具，用于转换和处理地理空间数据。它可以读取多种矢量数据格式（如<code>Shapefile、GeoJSON、KML、GML、PostGIS</code>等），并进行格式转换、坐标转换、属性过滤、几何操作等。</p>
<h2 data-id="heading-1">1. 用户环境</h2>
<p>本文使用如下用户环境，以供参考。</p>
<p>时间：<code>2025年</code></p>
<p>系统：<code>Windows 11</code></p>
<p>Python：<code>3.11.7</code></p>
<p>GDAL：<code>3.11.1</code></p>
<p>ogr2ogr：<code>3.9.2</code></p>
<h2 data-id="heading-2">2. 验证 <code>ogr2ogr</code> 工具信息</h2>
<p>打开命令行终端，输入命令<code>ogr2ogr --version</code>查看版本信息。如果<code>ogr2ogr</code>正确安装并添加到环境变量，便会输出其版本号。<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bcde0ff0b694f04b403e616ef3a2dda~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766585298&amp;x-signature=w3A%2BVEV4BqPc9uXwvwjd7olLozc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">3. 将CSV转换为Shp数据</h2>
<p>原始CSV数据内容显示如下，具有四个字段，分别为“名称”、“地址”、“LATQ”代表纬度，“LNGQ”代表经度。<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e09a8252eee246bf88d6e40199aba840~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766585298&amp;x-signature=Cx0Dju6rphS85zhxM%2FEsNphATt0%3D" alt="" loading="lazy"/></p>
<p>在命令行终端输入以下命令进行数据转换。</p>
<pre><code class="hljs language-ini" lang="ini">ogr2ogr -f "ESRI Shapefile" E:datatest_dataogr_transform.shp E:datatest_data景点.csv -oo <span class="hljs-attr">X_POSSIBLE_NAMES</span>=LNGQ,longitude,x,X -oo Y_POSSIBLE_NAMES=LATQ,latitude,y,Y  -a_srs EPSG:<span class="hljs-number">4326</span>
</code></pre>
<p>以下是<code>ogr2ogr</code>工具常用参数解释：</p>













































<table><thead><tr><th><strong>选项</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td><code>-f "ESRI Shapefile"</code></td><td>指定输出格式，如“ESRI Shapefile”</td></tr><tr><td><code>-a_srs EPSG:4326</code></td><td>设置空间参考</td></tr><tr><td><code>-select "field1,field2"</code></td><td>选择特定字段</td></tr><tr><td><code>-where "value &gt; 100"</code></td><td>过滤条件</td></tr><tr><td><code>-lco ENCODING=UTF-8</code></td><td>设置字符编码</td></tr><tr><td><code>-oo AUTODETECT_TYPE=YES</code></td><td>自动检测字段类型</td></tr><tr><td><code>-oo SEPARATOR=TAB</code></td><td>设置分隔符（TAB/COMMA/SEMICOLON）</td></tr><tr><td><code>-oo X_POSSIBLE_NAMES</code></td><td>指定经度字段，可书写多个可能值</td></tr><tr><td><code>-oo Y_POSSIBLE_NAMES</code></td><td>指定纬度字段，可书写多个可能值</td></tr></tbody></table>
<h2 data-id="heading-4">4. 中文转换错误解决办法</h2>
<p>由于CSV文件中具有中文字段，直接进行转换工具会报错，无法创建中文字段。此时需要指定正确的字符编码。<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2febbe5fca3b4ebba8cc0df3f921135b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766585298&amp;x-signature=p%2Bto2QQNgYCzhlS84sQIHCry8vM%3D" alt="" loading="lazy"/></p>
<p>在命令中添加<code>-lco ENCODING=UTF-8</code>选项以正确转换中文字符。</p>
<pre><code class="hljs language-ini" lang="ini">ogr2ogr -f "ESRI Shapefile" E:datatest_dataogr_transform.shp E:datatest_data景点.csv -oo <span class="hljs-attr">X_POSSIBLE_NAMES</span>=LNGQ,longitude,x,X -oo Y_POSSIBLE_NAMES=LATQ,latitude,y,Y -lco ENCODING=UTF-<span class="hljs-number">8</span> -a_srs EPSG:<span class="hljs-number">4326</span>
</code></pre>
<p>将CSV转换为Shp数据在ArcGIS中的显示结果。<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ebf2d25306d4e3e8a7d26f0a9621d92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766585298&amp;x-signature=Qx7NkMkCfY%2Fr0TQTUTGoQARN83I%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">5. 常见字符编码</h2>
<p>以下是一些常见编码格式。</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># UTF-8（推荐）</span>
-lco <span class="hljs-attr">ENCODING</span>=UTF-<span class="hljs-number">8</span>

<span class="hljs-comment"># 中文编码</span>
-lco <span class="hljs-attr">ENCODING</span>=GBK      <span class="hljs-comment"># 简体中文</span>
-lco <span class="hljs-attr">ENCODING</span>=BIG5     <span class="hljs-comment"># 繁体中文</span>
-lco <span class="hljs-attr">ENCODING</span>=GB2312   <span class="hljs-comment"># 简体中文旧版</span>

<span class="hljs-comment"># 其他编码</span>
-lco <span class="hljs-attr">ENCODING</span>=LATIN1
-lco <span class="hljs-attr">ENCODING</span>=ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">1</span>
-lco <span class="hljs-attr">ENCODING</span>=CP1252
</code></pre>
<h2 data-id="heading-6">6. 数据转换事项</h2>
<p>使用<code>ogr2ogr</code>工具进行数据转换时如果所有的命令都写在一行，那么显示效果不仅不美观，也不具有可读性，所以可按照转换内容对其进行分行展示。在<code>windows</code>和<code>linux</code>系统中换行符略有差别。</p>
<p><code>windows</code>系统进行分行展示时使用符号"<code>^</code>"进行分隔：</p>
<pre><code class="hljs language-ini" lang="ini">ogr2ogr -f "ESRI Shapefile" "E:\datatest_data\ogr_transform5.shp" "E:\data\test_data\景点.csv" ^
-oo <span class="hljs-attr">X_POSSIBLE_NAMES</span>=LNGQ,longitude,x,X ^
-oo <span class="hljs-attr">Y_POSSIBLE_NAMES</span>=LATQ,latitude,y,Y ^
-lco <span class="hljs-attr">ENCODING</span>=UTF-<span class="hljs-number">8</span> ^
-a_srs EPSG:4326
</code></pre>
<p><code>linux</code>系统进行分行展示时使用符号"``"进行分隔</p>
<pre><code class="hljs language-ini" lang="ini">ogr2ogr -f "ESRI Shapefile" "E:\datatest_data\ogr_transform5.shp" "E:\data\test_data\景点.csv" ^
-oo <span class="hljs-attr">X_POSSIBLE_NAMES</span>=LNGQ,longitude,x,X ^
-oo <span class="hljs-attr">Y_POSSIBLE_NAMES</span>=LATQ,latitude,y,Y ^
-lco <span class="hljs-attr">ENCODING</span>=UTF-<span class="hljs-number">8</span> ^
-a_srs EPSG:4326
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[面试官问"try-catch影响性能吗"，我用数据打脸]]></title>    <link>https://juejin.cn/post/7584653722593820724</link>    <guid>https://juejin.cn/post/7584653722593820724</guid>    <pubDate>2025-12-17T14:42:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584653722593820724" data-draft-id="7584650673825546280" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="面试官问&quot;try-catch影响性能吗&quot;，我用数据打脸"/> <meta itemprop="keywords" content="前端,JavaScript,面试"/> <meta itemprop="datePublished" content="2025-12-17T14:42:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="也无风雨也雾晴"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            面试官问"try-catch影响性能吗"，我用数据打脸
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    也无风雨也雾晴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T14:42:06.000Z" title="Wed Dec 17 2025 14:42:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">面试官问"try-catch影响性能吗"，我用数据打脸</h2>
<p>面试的时候被问到这个问题：<strong>try-catch 会影响性能吗？</strong></p>
<p>当时我有点懵，回答了一个模糊的"会有一点影响吧"。面试官追问：影响多大？什么情况下影响大？我就说不上来了。</p>
<p>回来之后认真研究了一下，发现这个问题的答案比想象中有意思。</p>
<h3 data-id="heading-1">先说结论</h3>
<p><strong>在现代 JavaScript 引擎中，try-catch 本身几乎不影响性能，但异常抛出是昂贵的操作。</strong></p>
<p>听起来有点绕？用人话说就是：</p>
<ul>
<li>代码外面套一层 try-catch → 基本没影响</li>
<li>代码里频繁 throw Error → 性能会很差</li>
</ul>
<p>下面用数据说话。</p>
<h3 data-id="heading-2">实测数据</h3>
<p>我写了个简单的测试：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> iterations = <span class="hljs-number">1000000</span>;

<span class="hljs-comment">// 测试1：不用 try-catch</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'无 try-catch'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(i);
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'无 try-catch'</span>);

<span class="hljs-comment">// 测试2：用 try-catch，但不抛异常</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'有 try-catch，不抛异常'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(i);
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-comment">// 不会执行</span>
    }
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'有 try-catch，不抛异常'</span>);

<span class="hljs-comment">// 测试3：用 try-catch，每次都抛异常（注意迭代次数少很多）</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'有 try-catch，每次抛异常'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'test'</span>);
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-comment">// 处理异常</span>
    }
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'有 try-catch，每次抛异常'</span>);
</code></pre>
<p>结果（Node.js v20，M1 Mac）：</p>

























<table><thead><tr><th>场景</th><th>迭代次数</th><th>耗时</th></tr></thead><tbody><tr><td>无 try-catch</td><td>1,000,000</td><td>1.8ms</td></tr><tr><td>有 try-catch，不抛异常</td><td>1,000,000</td><td>1.2ms</td></tr><tr><td>有 try-catch，每次抛异常</td><td>10,000</td><td>13.9ms</td></tr></tbody></table>
<p><strong>有意思的是，加了 try-catch 反而更快了？</strong></p>
<p>是的，这可能是 V8 引擎的优化效果。但重点是：只要不抛异常，try-catch 的开销可以忽略不计。</p>
<p>而抛异常的场景呢？迭代次数少了100倍，耗时却多了10倍。换算一下，<strong>异常抛出比正常执行慢约1000倍</strong>。</p>
<h3 data-id="heading-3">为什么异常抛出这么慢？</h3>
<p>因为 JavaScript 引擎需要做三件事：</p>
<ol>
<li><strong>创建 Error 对象</strong> - 这个对象包含了错误信息</li>
<li><strong>捕获堆栈跟踪</strong> - 遍历调用栈，记录每一层的函数名、文件名、行号</li>
<li><strong>展开调用栈</strong> - 从抛出点一直往上找，直到找到匹配的 catch 块</li>
</ol>
<p>其中第 2 步最耗时。调用栈越深，捕获堆栈跟踪的开销越大。</p>
<h3 data-id="heading-4">什么时候该用 try-catch？</h3>
<p>记住一个原则：<strong>异常是用来处理异常情况的，不是用来控制正常流程的</strong>。</p>
<h4 data-id="heading-5">正确用法：处理真正的异常</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// JSON 解析可能失败</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(userInput);
    <span class="hljs-title function_">processData</span>(data);
} <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-title function_">showError</span>(<span class="hljs-string">'输入的格式不对'</span>);
}

<span class="hljs-comment">// 网络请求可能失败</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/data'</span>);
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
} <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-title function_">showError</span>(<span class="hljs-string">'网络连接失败'</span>);
}
</code></pre>
<p>这些场景下，异常是"意外情况"，不是每次都会发生。用 try-catch 完全没问题。</p>
<h4 data-id="heading-6">错误用法：用异常控制流程</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 错误示范：用异常来判断用户是否存在</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">findUser</span>(<span class="hljs-params">id</span>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> database.<span class="hljs-title function_">query</span>(<span class="hljs-string">`SELECT * FROM users WHERE id = <span class="hljs-subst">${id}</span>`</span>);
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;  <span class="hljs-comment">// 用异常来返回"找不到"</span>
    }
}
</code></pre>
<p>如果大部分查询都找不到用户，那每次都会抛异常，性能会很差。</p>
<p>正确做法是先检查，再操作：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 正确做法</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">findUser</span>(<span class="hljs-params">id</span>) {
    <span class="hljs-keyword">const</span> result = database.<span class="hljs-title function_">query</span>(<span class="hljs-string">`SELECT * FROM users WHERE id = <span class="hljs-subst">${id}</span>`</span>);
    <span class="hljs-keyword">return</span> result || <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-7">循环里怎么用 try-catch？</h3>
<p>这是另一个常见问题。看两种写法：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 写法1：try-catch 在循环内</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> items) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-title function_">processItem</span>(item);
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'处理失败:'</span>, item);
    }
}

<span class="hljs-comment">// 写法2：try-catch 在循环外</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> items) {
        <span class="hljs-title function_">processItem</span>(item);
    }
} <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'处理失败:'</span>, e);
}
</code></pre>
<p><strong>性能上，两者差不多</strong>。因为只要不抛异常，try-catch 本身几乎没开销。</p>
<p>区别在于<strong>错误处理策略</strong>：</p>
<ul>
<li>写法1：某一项失败了，继续处理其他项</li>
<li>写法2：某一项失败了，整个循环终止</li>
</ul>
<p>根据业务需求选择，别纠结性能。</p>
<h3 data-id="heading-8">关于早期 V8 的问题</h3>
<p>网上有些老文章说"try-catch 会阻止 V8 优化"，这在早期版本确实存在。但在 V8 6.0+（Node.js 8.3+，Chrome 60+）之后，这个问题已经解决了。</p>
<p>所以如果你看到有人说"try-catch 会让函数无法被优化"，看看文章发布时间。2018 年之前的文章可以参考，但别太当真。</p>
<h3 data-id="heading-9">最佳实践总结</h3>
<ol>
<li><strong>放心用 try-catch</strong> - 现代引擎下，性能影响可以忽略</li>
<li><strong>异常是异常</strong> - 用于处理真正的错误情况，不是控制流程</li>
<li><strong>先检查，再操作</strong> - 能用 if 判断的，别用异常处理</li>
<li><strong>catch 里要做事</strong> - 空的 catch 块是代码坏味道</li>
<li><strong>错误要有上下文</strong> - catch 里记录足够的信息方便排查</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 最佳实践示例</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUserData</span>(<span class="hljs-params">userId</span>) {
    <span class="hljs-keyword">if</span> (!userId) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;  <span class="hljs-comment">// 先检查，不用异常</span>
    }

    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);
        <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
            <span class="hljs-comment">// HTTP 错误，但不一定是异常</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`获取用户失败: <span class="hljs-subst">${response.status}</span>`</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-comment">// 真正的异常：网络断开、JSON 解析失败等</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'获取用户数据异常:'</span>, {
            userId,
            <span class="hljs-attr">error</span>: e.<span class="hljs-property">message</span>,
            <span class="hljs-attr">stack</span>: e.<span class="hljs-property">stack</span>
        });
        <span class="hljs-keyword">throw</span> e;  <span class="hljs-comment">// 根据需要决定是否重新抛出</span>
    }
}
</code></pre>
<h3 data-id="heading-10">面试怎么答？</h3>
<p>下次再被问到这个问题，可以这样回答：</p>
<blockquote>
<p>try-catch 本身在现代 JavaScript 引擎中几乎没有性能开销。真正影响性能的是异常的抛出和捕获，因为需要创建 Error 对象和捕获堆栈跟踪。所以建议把 try-catch 用于处理真正的异常情况，而不是用来控制正常的程序流程。比如用户输入校验，应该用 if 判断而不是 try-catch。</p>
</blockquote>
<hr/>
<p>如果你觉得这篇文章有帮助，欢迎关注我的 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i" target="_blank" title="https://github.com/tt-a1i" ref="nofollow noopener noreferrer">GitHub</a>，下面是我的一些开源项目：</p>
<p><strong>Claude Code Skills</strong>（按需加载，意图自动识别，不浪费 token，<a href="https://juejin.cn/post/7578714735307735066" target="_blank" title="https://juejin.cn/post/7578714735307735066">介绍文章</a>）：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">code-review-skill</a> - 代码审查技能，覆盖 React 19、Vue 3、TypeScript、Rust 等约 9000 行规则（<a href="https://juejin.cn/post/7578709098255908902" target="_blank" title="https://juejin.cn/post/7578709098255908902">详细介绍</a>）</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2F5-whys-skill" target="_blank" title="https://github.com/tt-a1i/5-whys-skill" ref="nofollow noopener noreferrer">5-whys-skill</a> - 5 Whys 根因分析，说"找根因"自动激活</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Ffirst-principles-skill" target="_blank" title="https://github.com/tt-a1i/first-principles-skill" ref="nofollow noopener noreferrer">first-principles-skill</a> - 第一性原理思考，适合架构设计和技术选型</li>
</ul>
<p><strong>全栈项目</strong>（适合学习现代技术栈）：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fprompt-vault" target="_blank" title="https://github.com/tt-a1i/prompt-vault" ref="nofollow noopener noreferrer">prompt-vault</a> - Prompt 管理器，用的都是最新的技术栈，适合用来学习了解最新的前端全栈开发范式：Next.js 15 + React 19 + tRPC 11 + Supabase 全栈示例，clone 下来配个免费 Supabase 就能跑</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fchat_edit" target="_blank" title="https://github.com/tt-a1i/chat_edit" ref="nofollow noopener noreferrer">chat_edit</a> - 双模式 AI 应用（聊天+富文本编辑），Vue 3.5 + TypeScript + Vite 5 + Quill 2.0 + IndexedDB</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[第一章：信息化发展核心知识体系]]></title>    <link>https://juejin.cn/post/7584695558158762025</link>    <guid>https://juejin.cn/post/7584695558158762025</guid>    <pubDate>2025-12-17T14:47:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584695558158762025" data-draft-id="7584651851905286163" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="第一章：信息化发展核心知识体系"/> <meta itemprop="keywords" content="团队管理"/> <meta itemprop="datePublished" content="2025-12-17T14:47:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="90后晨仔"/> <meta itemprop="url" content="https://juejin.cn/user/2717648476705773"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            第一章：信息化发展核心知识体系
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2717648476705773/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    90后晨仔
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T14:47:06.000Z" title="Wed Dec 17 2025 14:47:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">一、信息的本质与特征</h2>
<h3 data-id="heading-1">1.1 信息科学定义</h3>
<p><strong>香农信息论</strong>：信息是用来消除随机不确定性的东西</p>
<ul>
<li><strong>单位</strong>：bit（比特）—信息量的度量单位</li>
<li><strong>核心关系</strong>：信息 = 负熵（有序度的度量）</li>
</ul>
<p><strong>深入理解</strong>：</p>
<ul>
<li>信息是不同于物质、能量的第三种存在形式</li>
<li>信息量越大，不确定性消除得越多</li>
<li>熵代表混乱度，信息代表有序度，两者互为相反</li>
</ul>
<h3 data-id="heading-2">1.2 信息11大特征详解</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[信息11大特征] --&gt; B[存在维度 3个]
    A --&gt; C[变化维度 2个]
    A --&gt; D[依存维度 2个]
    A --&gt; E[流动维度 2个]
    A --&gt; F[结构维度 2个]
    
    B --&gt; B1[客观性]
    B --&gt; B2[普遍性]
    B --&gt; B3[无限性]
    
    C --&gt; C1[动态性]
    C --&gt; C2[相对性]
    
    D --&gt; D1[依附性]
    D --&gt; D2[变换性]
    
    E --&gt; E1[传递性]
    E --&gt; E2[转化性]
    
    F --&gt; F1[层次性]
    F --&gt; F2[系统性]
</code></pre>
<h4 data-id="heading-3">存在维度（3个）</h4>
<ol>
<li>
<p><strong>客观性</strong></p>
<ul>
<li><strong>含义</strong>：信息反映客观事物的存在方式和运动状态</li>
<li><strong>举例</strong>：温度计读数反映实际温度，传感器数据反映设备状态</li>
<li><strong>重要性</strong>：确保信息的真实性和可靠性</li>
</ul>
</li>
<li>
<p><strong>普遍性</strong></p>
<ul>
<li><strong>含义</strong>：信息无处不在，物质存在即信息存在</li>
<li><strong>举例</strong>：自然界声、光、电信号，社会活动中的各种记录</li>
<li><strong>扩展</strong>：信息普遍存在决定了信息化建设的必要性</li>
</ul>
</li>
<li>
<p><strong>无限性</strong></p>
<ul>
<li><strong>含义</strong>：信息量无限，对同一事物的描述可以无限深入</li>
<li><strong>举例</strong>：一个人的信息可以从基本信息到DNA序列无限描述</li>
<li><strong>应用</strong>：大数据时代的理论基础</li>
</ul>
</li>
</ol>
<h4 data-id="heading-4">变化维度（2个）</h4>
<ol start="4">
<li>
<p><strong>动态性</strong></p>
<ul>
<li><strong>含义</strong>：信息随时间变化，具有时效性</li>
<li><strong>举例</strong>：股票价格、交通流量、天气预报</li>
<li><strong>管理</strong>：需要实时更新和维护</li>
</ul>
</li>
<li>
<p><strong>相对性</strong></p>
<ul>
<li><strong>含义</strong>：同一信息对不同主体价值不同</li>
<li><strong>举例</strong>：财务数据对财务部门和销售部门意义不同</li>
<li><strong>设计</strong>：信息系统需要考虑用户角色的差异性</li>
</ul>
</li>
</ol>
<h4 data-id="heading-5">依存维度（2个）</h4>
<ol start="6">
<li>
<p><strong>依附性</strong></p>
<ul>
<li><strong>含义</strong>：信息需要载体存在，不能独立存在</li>
<li><strong>举例</strong>：声音需要空气传播，文件需要存储介质</li>
<li><strong>类型</strong>：物理载体（纸张、磁盘）、电子载体（信号、代码）</li>
</ul>
</li>
<li>
<p><strong>变换性</strong></p>
<ul>
<li><strong>含义</strong>：信息形式可以转换，内容可以重组</li>
<li><strong>举例</strong>：文字转语音、数据转图表、视频压缩</li>
<li><strong>技术</strong>：编码、压缩、格式转换等技术基础</li>
</ul>
</li>
</ol>
<h4 data-id="heading-6">流动维度（2个）</h4>
<ol start="8">
<li>
<p><strong>传递性</strong></p>
<ul>
<li><strong>含义</strong>：信息可以在时间和空间上传递</li>
<li><strong>时间传递</strong>：存储、传承（如历史档案）</li>
<li><strong>空间传递</strong>：传播、扩散（如网络传输）</li>
<li><strong>技术</strong>：通信技术、存储技术的理论基础</li>
</ul>
</li>
<li>
<p><strong>转化性</strong></p>
<ul>
<li><strong>含义</strong>：信息可以转化为物质和能量</li>
<li><strong>举例</strong>：设计图→产品、知识→生产力</li>
<li><strong>价值</strong>：信息价值的最终体现</li>
</ul>
</li>
</ol>
<h4 data-id="heading-7">结构维度（2个）</h4>
<ol start="10">
<li>
<p><strong>层次性</strong></p>
<ul>
<li><strong>含义</strong>：信息具有分层结构</li>
<li><strong>层次</strong>：战略层→战术层→作业层信息</li>
<li><strong>举例</strong>：企业数据：战略规划→部门计划→执行记录</li>
</ul>
</li>
<li>
<p><strong>系统性</strong></p>
<ul>
<li><strong>含义</strong>：信息相互关联形成有机整体</li>
<li><strong>特点</strong>：整体性、关联性、协调性</li>
<li><strong>举例</strong>：ERP系统各模块数据紧密关联</li>
</ul>
</li>
</ol>
<p><strong>记忆口诀</strong>：</p>
<ul>
<li><strong>数字法</strong>：三二二二二（3存在+2变化+2依存+2流动+2结构）</li>
<li><strong>串联法</strong>：客普无限动，相依附变换，传递转化层系全</li>
</ul>
<h3 data-id="heading-8">1.3 信息质量7大属性详解</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[信息质量属性] --&gt; B[精确性]
    A --&gt; C[完整性]
    A --&gt; D[可靠性]
    A --&gt; E[及时性]
    A --&gt; F[经济性]
    A --&gt; G[可验证性]
    A --&gt; H[安全性]
</code></pre>
<h4 data-id="heading-9">详细解释：</h4>
<ol>
<li>
<p><strong>精确性</strong></p>
<ul>
<li><strong>定义</strong>：信息与实际情况的匹配程度</li>
<li><strong>衡量</strong>：误差范围、准确率</li>
<li><strong>举例</strong>：GPS定位精度±10米，传感器数据误差±0.5%</li>
</ul>
</li>
<li>
<p><strong>完整性</strong></p>
<ul>
<li><strong>定义</strong>：信息包含全部重要事实的程度</li>
<li><strong>维度</strong>：广度覆盖、深度挖掘</li>
<li><strong>举例</strong>：客户档案包含基本信息、交易记录、服务历史</li>
</ul>
</li>
<li>
<p><strong>可靠性</strong></p>
<ul>
<li><strong>定义</strong>：信息来源、采集、传输过程可信</li>
<li><strong>要素</strong>：来源权威性、方法科学性</li>
<li><strong>举例</strong>：官方统计数据 vs 网络传言</li>
</ul>
</li>
<li>
<p><strong>及时性</strong></p>
<ul>
<li><strong>定义</strong>：信息产生到获取的时间间隔</li>
<li><strong>要求</strong>：实时性、时效性</li>
<li><strong>举例</strong>：实时监控数据 vs 月度报告</li>
</ul>
</li>
<li>
<p><strong>经济性</strong></p>
<ul>
<li><strong>定义</strong>：获取信息的成本效益比</li>
<li><strong>考虑</strong>：时间成本、资金成本、机会成本</li>
<li><strong>平衡</strong>：质量与成本的权衡</li>
</ul>
</li>
<li>
<p><strong>可验证性</strong></p>
<ul>
<li><strong>定义</strong>：信息可以被证实或证伪的程度</li>
<li><strong>方法</strong>：交叉验证、追溯验证</li>
<li><strong>举例</strong>：带原始数据的实验报告</li>
</ul>
</li>
<li>
<p><strong>安全性</strong></p>
<ul>
<li><strong>定义</strong>：防止未授权访问的能力</li>
<li><strong>措施</strong>：加密、权限控制、审计</li>
<li><strong>分级</strong>：公开、内部、机密、绝密</li>
</ul>
</li>
</ol>
<p><strong>记忆口诀</strong>：精完可靠及经安验（精完可-可靠及-经安验）</p>
<h2 data-id="heading-10">二、信息系统核心概念详解</h2>
<h3 data-id="heading-11">2.1 信息系统六大组件</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[信息系统组件] --&gt; B[硬件]
    A --&gt; C[软件]
    A --&gt; D[数据库]
    A --&gt; E[网络]
    A --&gt; F[人员]
    A --&gt; G[规程]
</code></pre>
<h4 data-id="heading-12">组件详解：</h4>
<ol>
<li>
<p><strong>硬件</strong></p>
<ul>
<li><strong>内容</strong>：计算机、服务器、存储设备、网络设备</li>
<li><strong>作用</strong>：物理基础，提供计算、存储、通信能力</li>
<li><strong>趋势</strong>：云化、虚拟化</li>
</ul>
</li>
<li>
<p><strong>软件</strong></p>
<ul>
<li><strong>分类</strong>：系统软件（OS）、应用软件（ERP、CRM）</li>
<li><strong>作用</strong>：逻辑核心，实现业务功能</li>
<li><strong>开发</strong>：定制开发、套装软件</li>
</ul>
</li>
<li>
<p><strong>数据库</strong></p>
<ul>
<li><strong>作用</strong>：存储和管理数据</li>
<li><strong>类型</strong>：关系型（MySQL）、非关系型（MongoDB）</li>
<li><strong>管理</strong>：数据建模、备份恢复、性能优化</li>
</ul>
</li>
<li>
<p><strong>网络</strong></p>
<ul>
<li><strong>功能</strong>：数据传输和系统连接</li>
<li><strong>类型</strong>：局域网、广域网、互联网</li>
<li><strong>技术</strong>：TCP/IP、无线网络、5G</li>
</ul>
</li>
<li>
<p><strong>人员</strong></p>
<ul>
<li><strong>角色</strong>：系统用户、管理员、开发者</li>
<li><strong>技能</strong>：业务知识、技术能力</li>
<li><strong>管理</strong>：培训、考核、激励</li>
</ul>
</li>
<li>
<p><strong>规程</strong></p>
<ul>
<li><strong>内容</strong>：操作手册、管理制度、标准规范</li>
<li><strong>作用</strong>：确保系统有序运行</li>
<li><strong>制定</strong>：基于最佳实践，持续改进</li>
</ul>
</li>
</ol>
<p><strong>记忆</strong>：硬软数网人规（六位一体）</p>
<h3 data-id="heading-13">2.2 信息系统生命周期详解</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[规划] --&gt; B[分析]
    B --&gt; C[设计]
    C --&gt; D[实施]
    D --&gt; E[运维]
    E -.-&gt; A
</code></pre>
<h4 data-id="heading-14">五阶段详解：</h4>
<ol>
<li>
<p><strong>规划阶段</strong></p>
<ul>
<li><strong>任务</strong>：可行性研究、战略规划、资源计划</li>
<li><strong>产出</strong>：项目章程、可行性报告</li>
<li><strong>关键</strong>：回答"要不要做"</li>
</ul>
</li>
<li>
<p><strong>分析阶段</strong></p>
<ul>
<li><strong>任务</strong>：需求收集、分析、规格定义</li>
<li><strong>产出</strong>：需求规格说明书</li>
<li><strong>关键</strong>：回答"要做什么"</li>
</ul>
</li>
<li>
<p><strong>设计阶段</strong></p>
<ul>
<li><strong>任务</strong>：架构设计、详细设计、界面设计</li>
<li><strong>产出</strong>：系统设计文档</li>
<li><strong>关键</strong>：回答"怎么做"</li>
</ul>
</li>
<li>
<p><strong>实施阶段</strong></p>
<ul>
<li><strong>任务</strong>：编码、测试、部署、培训</li>
<li><strong>产出</strong>：可运行系统、用户手册</li>
<li><strong>关键</strong>：实际建设</li>
</ul>
</li>
<li>
<p><strong>运维阶段</strong></p>
<ul>
<li><strong>任务</strong>：维护、优化、升级、退役</li>
<li><strong>产出</strong>：运维报告、优化方案</li>
<li><strong>关键</strong>：持续价值</li>
</ul>
</li>
</ol>
<p><strong>五阶段口诀</strong>：规分设实维（规划→分析→设计→实施→运维）</p>
<h2 data-id="heading-15">三、信息化发展体系详解</h2>
<h3 data-id="heading-16">3.1 信息化四大内涵详解</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[信息化内涵] --&gt; B[信息网络体系]
    A --&gt; C[信息产业基础]
    A --&gt; D[社会运行环境]
    A --&gt; E[效用积累过程]
    
    B --&gt; B1[基础设施]
    C --&gt; C1[产业支撑]
    D --&gt; D1[政策环境]
    E --&gt; E1[价值实现]
</code></pre>
<h4 data-id="heading-17">内涵详解：</h4>
<ol>
<li>
<p><strong>信息网络体系</strong></p>
<ul>
<li><strong>内容</strong>：网络设施、信息系统、信息资源</li>
<li><strong>比喻</strong>：高速公路系统</li>
<li><strong>建设</strong>：5G、数据中心、云计算平台</li>
</ul>
</li>
<li>
<p><strong>信息产业基础</strong></p>
<ul>
<li><strong>内容</strong>：信息制造业、软件业、服务业</li>
<li><strong>比喻</strong>：汽车制造厂和驾驶员</li>
<li><strong>发展</strong>：芯片、操作系统、应用软件</li>
</ul>
</li>
<li>
<p><strong>社会运行环境</strong></p>
<ul>
<li><strong>内容</strong>：政策法规、标准规范、文化教育</li>
<li><strong>比喻</strong>：交通规则和驾驶文化</li>
<li><strong>完善</strong>：网络安全法、数据保护条例</li>
</ul>
</li>
<li>
<p><strong>效用积累过程</strong></p>
<ul>
<li><strong>内容</strong>：生产力提升、生活质量改善</li>
<li><strong>体现</strong>：经济增长、社会进步</li>
<li><strong>衡量</strong>：信息化发展指数</li>
</ul>
</li>
</ol>
<h3 data-id="heading-18">3.2 国家信息化六要素详解</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[信息技术应用] --&gt; B[信息资源]
    B --&gt; C[信息网络]
    C --&gt; A
    
    D[信息化人才] --&gt; A
    E[政策法规] --&gt; A
    F[标准规范] --&gt; A
</code></pre>
<h4 data-id="heading-19">六要素详解：</h4>
<ol>
<li>
<p><strong>信息技术应用</strong>（龙头）</p>
<ul>
<li><strong>地位</strong>：信息化建设的出发点和归宿</li>
<li><strong>领域</strong>：政务、企业、民生各个领域</li>
<li><strong>作用</strong>：体现建设效益</li>
</ul>
</li>
<li>
<p><strong>信息资源</strong>（核心）</p>
<ul>
<li><strong>地位</strong>：国家战略资源</li>
<li><strong>类型</strong>：政务数据、企业数据、个人数据</li>
<li><strong>开发</strong>：采集、整合、挖掘、利用</li>
</ul>
</li>
<li>
<p><strong>信息网络</strong>（手段）</p>
<ul>
<li><strong>地位</strong>：信息传输基础设施</li>
<li><strong>融合</strong>：电信网、广电网、互联网三网融合</li>
<li><strong>发展</strong>：5G、物联网、工业互联网</li>
</ul>
</li>
<li>
<p><strong>信息化人才</strong>（根本）</p>
<ul>
<li><strong>地位</strong>：所有工作的执行者</li>
<li><strong>培养</strong>：高等教育、职业培训</li>
<li><strong>结构</strong>：技术人才、管理人才、应用人才</li>
</ul>
</li>
<li>
<p><strong>政策法规</strong>（保障）</p>
<ul>
<li><strong>作用</strong>：规范信息化建设</li>
<li><strong>内容</strong>：法律法规、发展规划</li>
<li><strong>举例</strong>：《网络安全法》、《数据安全法》</li>
</ul>
</li>
<li>
<p><strong>标准规范</strong>（保障）</p>
<ul>
<li><strong>作用</strong>：确保互联互通</li>
<li><strong>内容</strong>：技术标准、管理规范</li>
<li><strong>制定</strong>：国家标准、行业标准</li>
</ul>
</li>
</ol>
<p><strong>六要素口诀</strong>：</p>
<ul>
<li><strong>应用龙头资源心，网络手段人才本，政策标准双保障</strong></li>
</ul>
<h3 data-id="heading-20">3.3 组织信息化四阶段详解</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[产品信息化] --&gt; B[产业信息化]
    B --&gt; C[社会生活信息化]
    C --&gt; D[国民经济信息化]
</code></pre>
<h4 data-id="heading-21">四阶段详解：</h4>
<ol>
<li>
<p><strong>产品信息化</strong></p>
<ul>
<li><strong>特点</strong>：产品智能化、嵌入式系统</li>
<li><strong>举例</strong>：智能家电、可穿戴设备</li>
<li><strong>目标</strong>：提升产品附加值</li>
</ul>
</li>
<li>
<p><strong>产业信息化</strong></p>
<ul>
<li><strong>特点</strong>：产业链数字化、企业间协同</li>
<li><strong>举例</strong>：工业互联网、供应链管理</li>
<li><strong>目标</strong>：优化资源配置</li>
</ul>
</li>
<li>
<p><strong>社会生活信息化</strong></p>
<ul>
<li><strong>特点</strong>：公共服务数字化、智慧生活</li>
<li><strong>举例</strong>：智慧城市、在线教育、远程医疗</li>
<li><strong>目标</strong>：改善民生服务</li>
</ul>
</li>
<li>
<p><strong>国民经济信息化</strong></p>
<ul>
<li><strong>特点</strong>：经济系统一体化、数据要素化</li>
<li><strong>举例</strong>：数字中国、国家大数据体系</li>
<li><strong>目标</strong>：提升国家竞争力</li>
</ul>
</li>
</ol>
<p><strong>演进逻辑</strong>：产品→产业→社会→国民经济</p>
<h3 data-id="heading-22">3.4 国家信息化三步走详解</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[2020年&lt;br/&gt;部分领先] --&gt; B[2025年&lt;br/&gt;基本自主]
    B --&gt; C[21世纪中叶&lt;br/&gt;全面引领]
</code></pre>
<h4 data-id="heading-23">战略详解：</h4>
<p><strong>第一步：2020年目标</strong></p>
<ul>
<li>关键技术部分达到国际先进水平</li>
<li>信息产业国际竞争力大幅提升</li>
<li>信息化成为驱动现代化的重要力量</li>
</ul>
<p><strong>第二步：2025年目标</strong></p>
<ul>
<li>建成国际领先的移动通信网络</li>
<li>突破核心关键技术瓶颈</li>
<li>培育具有国际竞争力的跨国企业</li>
</ul>
<p><strong>第三步：21世纪中叶目标</strong></p>
<ul>
<li>网络强国地位日益稳固</li>
<li>引领全球信息化发展</li>
<li>全面支撑社会主义现代化建设</li>
</ul>
<h2 data-id="heading-24">四、知识体系总结</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[信息化发展知识体系]
    
    A --&gt; B[信息基础]
    A --&gt; C[信息系统]
    A --&gt; D[信息化体系]
    A --&gt; E[发展趋势]
    
    B --&gt; B1[特征-11个]
    B1 --&gt; B11[客观性&lt;br&gt;普遍性&lt;br&gt;无限性]
    B1 --&gt; B12[动态性&lt;br&gt;相对性]
    B1 --&gt; B13[依附性&lt;br&gt;变换性]
    B1 --&gt; B14[传递性&lt;br&gt;转化性]
    B1 --&gt; B15[层次性&lt;br&gt;系统性]
    
    B --&gt; B2[质量-7个]
    B2 --&gt; B21[精确性&lt;br&gt;完整性&lt;br&gt;可靠性]
    B2 --&gt; B22[及时性&lt;br&gt;经济性]
    B2 --&gt; B23[安全性&lt;br&gt;可验证性]
    
    C --&gt; C1[组件-6个]
    C1 --&gt; C11[硬件&lt;br&gt;软件&lt;br&gt;数据库]
    C1 --&gt; C12[网络&lt;br&gt;人员&lt;br&gt;规程]
    
    C --&gt; C2[周期-5个]
    C2 --&gt; C21[规划&lt;br&gt;分析&lt;br&gt;设计]
    C2 --&gt; C22[实施&lt;br&gt;运维]
    
    D --&gt; D1[内涵-4个]
    D1 --&gt; D11[网络体系&lt;br&gt;产业基础]
    D1 --&gt; D12[运行环境&lt;br&gt;效用积累]
    
    D --&gt; D2[要素-6个]
    D2 --&gt; D21[应用&lt;br&gt;资源&lt;br&gt;网络]
    D2 --&gt; D22[人才&lt;br&gt;政策&lt;br&gt;标准]
    
    E --&gt; E1[组织-4阶]
    E1 --&gt; E11[产品&lt;br&gt;产业]
    E1 --&gt; E12[社会&lt;br&gt;国家]
    
    E --&gt; E2[战略-3步]
    E2 --&gt; E21[2020&lt;br&gt;2025]
    E2 --&gt; E22[2050]
</code></pre>
<h2 data-id="heading-25">知识点详细说明表</h2>



































<table><thead><tr><th>模块</th><th>核心内容</th><th>关键点</th><th>记忆方法</th></tr></thead><tbody><tr><td><strong>信息基础</strong></td><td>信息特征 + 质量属性</td><td>11大特征，7大属性</td><td>特征:三二二二二<br/>属性:精完可靠及经安验</td></tr><tr><td><strong>信息系统</strong></td><td>组件 + 生命周期</td><td>六组件，五阶段</td><td>组件:硬软数网人规<br/>阶段:规分设实维</td></tr><tr><td><strong>信息化体系</strong></td><td>内涵 + 要素</td><td>四内涵，六要素</td><td>内涵:网络/产业/环境/效用<br/>要素:口诀记忆</td></tr><tr><td><strong>发展趋势</strong></td><td>组织 + 国家</td><td>四阶段，三步走</td><td>阶段:产品→产业→社会→经济<br/>战略:2020→2025→2050</td></tr></tbody></table>
<h2 data-id="heading-26">核心逻辑关系图</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    Start[学习路径] --&gt; Step1[基础概念]
    Step1 --&gt;|信息本质| Step2[信息系统]
    Step2 --&gt;|技术支持| Step3[信息化建设]
    Step3 --&gt;|应用发展| Step4[发展趋势]
    Step4 --&gt; End[知识掌握]
    
    %% 详细内容
    subgraph Step1_Details[基础概念]
        S1A[信息特征]
        S1B[质量属性]
    end
    
    subgraph Step2_Details[信息系统]
        S2A[六组件]
        S2B[五阶段]
    end
    
    subgraph Step3_Details[信息化建设]
        S3A[四内涵]
        S3B[六要素]
    end
    
    subgraph Step4_Details[发展趋势]
        S4A[组织四阶段]
        S4B[国家三步走]
    end
    
    Step1 --&gt; Step1_Details
    Step2 --&gt; Step2_Details
    Step3 --&gt; Step3_Details
    Step4 --&gt; Step4_Details
</code></pre>
<h2 data-id="heading-27">记忆口诀总汇表</h2>













































<table><thead><tr><th>知识点</th><th>口诀</th><th>解释</th></tr></thead><tbody><tr><td><strong>信息11大特征</strong></td><td>三二二二二</td><td>3存在+2变化+2依存+2流动+2结构</td></tr><tr><td><strong>信息7大属性</strong></td><td>精完可靠及经安验</td><td>精确/完整/可靠/及时/经济/安全/可验证</td></tr><tr><td><strong>信息系统组件</strong></td><td>硬软数网人规</td><td>硬件/软件/数据库/网络/人员/规程</td></tr><tr><td><strong>生命周期阶段</strong></td><td>规分设实维</td><td>规划/分析/设计/实施/运维</td></tr><tr><td><strong>六要素模型</strong></td><td>应用龙头资源心，网络手段人才本，政策标准双保障</td><td>各要素定位关系</td></tr><tr><td><strong>组织四阶段</strong></td><td>产产社国</td><td>产品→产业→社会→国家</td></tr><tr><td><strong>国家三步走</strong></td><td>2020→2025→2050</td><td>时间节点与目标</td></tr></tbody></table>
<h2 data-id="heading-28">五、核心记忆口诀汇总</h2>
<h3 data-id="heading-29">1. 信息特征记忆</h3>
<p><strong>"三二二二二"分类法</strong></p>
<ul>
<li>3存在：客观、普遍、无限</li>
<li>2变化：动态、相对</li>
<li>2依存：依附、变换</li>
<li>2流动：传递、转化</li>
<li>2结构：层次、系统</li>
</ul>
<h3 data-id="heading-30">2. 质量属性记忆</h3>
<p><strong>"精完可靠及经安验"</strong></p>
<ul>
<li>精确性、完整性、可靠性</li>
<li>及时性、经济性</li>
<li>安全性、可验证性</li>
</ul>
<h3 data-id="heading-31">3. 信息系统记忆</h3>
<p><strong>"硬软数网人规"</strong>（六组件）
<strong>"规分设实维"</strong>（五阶段）</p>
<h3 data-id="heading-32">4. 六要素记忆</h3>
<p><strong>"应用龙头资源心，网络手段人才本，政策标准双保障"</strong></p>
<h3 data-id="heading-33">5. 四阶段记忆</h3>
<p><strong>"产产社国"</strong>（产品→产业→社会→国家）</p>
<h2 data-id="heading-34">六、考试重点与答题技巧</h2>
<h3 data-id="heading-35">高频考点</h3>
<ol>
<li><strong>信息特征</strong>：客观性、动态性、传递性必考</li>
<li><strong>生命周期</strong>：各阶段区别和联系</li>
<li><strong>六要素</strong>：各要素的定位和关系</li>
<li><strong>质量属性</strong>：7个属性的实际应用</li>
</ol>
<h3 data-id="heading-36">易混淆概念辨析</h3>
<ol>
<li>
<p><strong>信息 vs 数据</strong></p>
<ul>
<li>数据：原始事实（如：25℃）</li>
<li>信息：有意义的解释（如：温度适宜）</li>
</ul>
</li>
<li>
<p><strong>客观性 vs 普遍性</strong></p>
<ul>
<li>客观性：反映事实真实性</li>
<li>普遍性：存在广泛性</li>
</ul>
</li>
<li>
<p><strong>产品信息化 vs 产业信息化</strong></p>
<ul>
<li>产品：单个产品智能化</li>
<li>产业：整个产业链数字化</li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Navigation 最佳实践]]></title>    <link>https://juejin.cn/post/7584652662328754226</link>    <guid>https://juejin.cn/post/7584652662328754226</guid>    <pubDate>2025-12-17T13:03:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584652662328754226" data-draft-id="7584742635483430922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Navigation 最佳实践"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-17T13:03:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Best_Jerry"/> <meta itemprop="url" content="https://juejin.cn/user/1099167360106999"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Navigation 最佳实践
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1099167360106999/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Best_Jerry
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T13:03:35.000Z" title="Wed Dec 17 2025 13:03:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DgoFpG25uoc8" target="_blank" title="https://www.youtube.com/watch?v=goFpG25uoc8" ref="nofollow noopener noreferrer">Type safe, multi-module best practices with Navigation Compose</a></p>
<p>了解使用 Navigation Compose 的最佳实践，以便您能以可在所有导航调用中维持类型安全的方式，在多个模块中展开导航图。</p>
<h2 data-id="heading-0">1. Define your screen as state in，events out</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a79b0980b9f94979b560ef634c5ff70d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=6ZimAl8DTJvDYYKbXrlmRInMOWY%3D" alt="image.png" loading="lazy"/></p>
<p>你的屏幕不应该在意你的数据是来自视图模型，还是只是你为单个测试创建的静态状态。它也不应该关心接收事件的对象是谁。</p>
<h2 data-id="heading-1">2. Split up your navigation graph</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f0f7c89e61a47f58096760002d8a8ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=Uze5wY2jcjii8gPA5bDF%2Buul1h8%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fc4a971a8334c80a9ffa89114d433d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=z%2BIu0q%2Bp5bbJvJlU%2FG2HAgYduNw%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">3. Build only the public APIs you need</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d481c62f6f14047b638d1fceaae4b20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=ab0DUWCcipYKdK4%2F%2BBpGaCnd%2B%2FY%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96b63663f1714399a8cc5e9534363cc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=tlduCgL3mlXuG6vWOyRj%2BsKGOHk%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5ce079422684139b7c0679457110f51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=%2BqbZRrUOFSinGdoAEyZLGBL8gZE%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b86ebec1c3b248f19f8fbd136b913238~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=%2BWC3a3Za9Ag%2BfeOr8g4TUGH%2F1Rs%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fdb837429d1416e9bc521f3e76bff5c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=fPgJF4Ca23iWQ8%2B4eO3VbNVsVTY%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">4. Module structure -&gt; Graph structure</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cda362dec234547ac2c4abefeef09b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=FKCSHoxuEeN3yOOPRmFJXrLliPY%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/140261aeb8e445d9891dd5786ca9e6af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=gqXx0o0k3vtbP%2F9nc1I6JWWFnXM%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92e525948c084dbcb31c07b655ac09cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmVzdF9KZXJyeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581414&amp;x-signature=biXTnQALe9XBBTb3aq3AZIy9uIE%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">5. Check out the Updated resources</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fguide%2Fnavigation%2Fdesign%2Ftype-safety%3Fhl%3Dzh-cn" target="_blank" title="https://developer.android.com/guide/navigation/design/type-safety?hl=zh-cn" ref="nofollow noopener noreferrer">Kotlin DSL 和 Navigation Compose 中的类型安全</a></p>
<p>NowInAndroid app: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fandroid%2Fnowinandroid" target="_blank" title="https://github.com/android/nowinandroid" ref="nofollow noopener noreferrer">github.com/android/now…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[用 Turborepo 打造 Strapi 插件开发的极速全栈体验]]></title>    <link>https://juejin.cn/post/7584653722593689652</link>    <guid>https://juejin.cn/post/7584653722593689652</guid>    <pubDate>2025-12-17T13:05:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584653722593689652" data-draft-id="7584567736186699814" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="用 Turborepo 打造 Strapi 插件开发的极速全栈体验"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2025-12-17T13:05:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="知航驿站"/> <meta itemprop="url" content="https://juejin.cn/user/4125023356335576"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            用 Turborepo 打造 Strapi 插件开发的极速全栈体验
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4125023356335576/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    知航驿站
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T13:05:58.000Z" title="Wed Dec 17 2025 13:05:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{font-family:-apple-system,BlinkMacSystemFont,PingFang SC,Helvetica Neue,Helvetica,Arial,sans-serif;word-break:break-word;line-height:1.75;font-weight:200;font-size:16px;overflow-x:hidden;color:#666;letter-spacing:.5px}.markdown-body a{text-decoration:none;color:#0064c8;position:relative}.markdown-body a:after{content:"";position:absolute;bottom:-2px;left:0;width:100%;height:1px;background-color:rgba(0,100,200,.7);transform:scale(0);transition:all .4s ease-in-out}.markdown-body a:link:hover:after{transform:scale(1)}.markdown-body code{padding:2px 4px;font-size:.9em;font-family:Menlo,Monaco,Consolas,Courier New,monospace;border-radius:2px;background-color:rgba(0,46,70,.0431);color:#39f}.markdown-body strong{font-weight:400}.markdown-body em{color:#ff6a00}.markdown-body del,.markdown-body s{color:#bbb}.markdown-body small{font-size:.8em;color:#bbb}.markdown-body kbd{margin:0 .1em;padding:5px 8px 3px;border:1px solid #d1d5d9;border-radius:3px;box-shadow:0 1px 0 0 #e3e4e6,inset 0 0 0 2px #fff;background-color:#eee;font-weight:600;font-size:.8em;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;white-space:nowrap;color:#666}.markdown-body kbd:first-child{margin-left:0}.markdown-body kbd:last-child{margin-right:0}.markdown-body img{display:block;border:0;max-width:calc(100% - 20px);min-width:20px;min-height:20px;margin:0 10px;box-shadow:0 2px 8px 2px rgba(0,0,0,.2);transition:all .25s ease-in-out}.markdown-body img:hover{transform:translateY(-4px)}.markdown-body blockquote,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{line-height:inherit;font-size:inherit;color:inherit}.markdown-body blockquote:first-child,.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child,.markdown-body ol:first-child,.markdown-body p:first-child,.markdown-body pre:first-child,.markdown-body table:first-child,.markdown-body ul:first-child{margin-top:0}.markdown-body blockquote:last-child,.markdown-body h1:last-child,.markdown-body h2:last-child,.markdown-body h3:last-child,.markdown-body h4:last-child,.markdown-body h5:last-child,.markdown-body h6:last-child,.markdown-body ol:last-child,.markdown-body p:last-child,.markdown-body pre:last-child,.markdown-body table:last-child,.markdown-body ul:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:1.6em 0 .6em;color:#333;font-weight:400;position:relative}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{position:absolute;left:-2em}.markdown-body h1{font-size:1.75em}.markdown-body h1:before{content:"#"}.markdown-body h1:first-child{margin-top:0}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.35em}.markdown-body h4{font-size:1.2em}.markdown-body h5{font-size:1.1em}.markdown-body h6{font-size:1em}.markdown-body blockquote,.markdown-body ol,.markdown-body pre,.markdown-body table,.markdown-body ul{margin:1em 0}.markdown-body p{margin:.7em 0;word-break:break-word}.markdown-body pre{padding:8px 12px;color:#666;background-color:rgba(0,46,70,.0431);border:1px solid #ebebeb;tab-size:4;white-space:pre-wrap;line-height:1.4}.markdown-body pre code{color:inherit;background-color:transparent;padding:0}.markdown-body ol,.markdown-body ul{margin:1em 0 1em 2em;padding:0;line-height:1.5!important;font-size:inherit;color:inherit}.markdown-body ol:first-child,.markdown-body ul:first-child{margin-top:0}.markdown-body ol:last-child,.markdown-body ul:last-child{margin-bottom:0}.markdown-body ol li,.markdown-body ul li{margin:.5em 0;list-style:inherit}.markdown-body ul{list-style:disc outside}.markdown-body ul ul{list-style-type:circle}.markdown-body ul ul ul{list-style-type:square}.markdown-body ol{list-style:decimal outside}.markdown-body ol ol{list-style-type:lower-alpha}.markdown-body ol ol ol{list-style-type:lower-roman}.markdown-body blockquote{font-size:.9em;padding:8px 20px 8px 15px;color:#666;border-left:5px solid rgba(0,100,200,.7);background-color:rgba(0,100,200,.1)}.markdown-body table{border-collapse:collapse;border-spacing:0;max-width:100%;min-width:50%;word-wrap:break-word;color:inherit}.markdown-body table thead tr{background-color:#f4f6f7}.markdown-body table td,.markdown-body table th{padding:4px 16px;font-size:.95em;text-align:left;color:inherit;border:0;min-width:72px}.markdown-body table td[align=center],.markdown-body table th[align=center]{text-align:center}.markdown-body table td[align=right],.markdown-body table th[align=right]{text-align:right}.markdown-body table th{border-bottom:2px solid #e3e4e6;color:#333;font-weight:400;white-space:nowrap}.markdown-body table td{border-bottom:1px solid #ebebeb}.markdown-body hr{margin:1.5em 0;padding:0;border:0;background:linear-gradient(90deg,rgba(0,46,70,.0431),#ebebeb 50%,rgba(0,46,70,.0431));height:1px}.markdown-body br{content:"";display:block}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">什么是Turborepo</h2>
<p>我在两三年前听到这个名词一直没搞懂，今天我借助AI+实践搞懂了这个架构，以及我们为什么要用它</p>
<p>在现代前端工程化中，"Monorepo" 已经成为了一个绕不开的热词。但很多开发者在初次接触时，容易把它和 "Multirepo" 甚至 "Turborepo" 混淆</p>
<h3 data-id="heading-1">1. Multirepo：各自为政的“独栋别墅”</h3>
<p><strong>Multirepo (Multiple Repositories)</strong> 是最传统的管理方式。</p>
<blockquote>
<p>🏠 <strong>比喻</strong>：你的前端团队住在 A 栋别墅，后端团队住在 B 栋别墅，UI 组件库团队住在 C 栋别墅。大家互不干扰，物理隔离。</p>
</blockquote>
<h4 data-id="heading-2">这种模式是怎样的？</h4>
<ul>
<li>每个项目都有<strong>独立</strong>的 Git 仓库（例如 <code>git/frontend</code>，<code>git/backend</code>）。</li>
<li>每个仓库有自己独立的配置（ESLint, TSConfig）。</li>
</ul>
<h4 data-id="heading-3">✅ 优点</h4>
<ul>
<li><strong>权限清晰</strong>：你可以只给新人开前端仓库的权限，他看不到后端的代码。</li>
<li><strong>体积小</strong>：<code>git clone</code> 很快，因为你只拉取了这一个项目的代码。</li>
</ul>
<h4 data-id="heading-4">❌ 痛点</h4>
<ul>
<li><strong>协作噩梦</strong>：当你修了一个 Bug，需要同时改动前端和后端代码时，你无法在一个 Commit 里完成。</li>
<li><strong>依赖地狱</strong>：如果你改了 <code>UI组件库</code> 的代码，你得先发个 npm 包，然后去前端项目里升级版本号，再 <code>npm install</code>……这一套流程下来，一下午就过去了。</li>
</ul>
<h6 data-id="heading-5">这种模式应该是目前大家所最常用的一种模式，这个主要是思维惯性与工具默认，早期的 CI/CD 工具（如 Jenkins）也更习惯于一个仓库对应一条流水线， 当你用 create-react-app 或 git init 时，默认就是创建一个仓库管一个项目</h6>
<hr/>
<h3 data-id="heading-6">2. Monorepo：欢聚一堂的“大平层”</h3>
<p>为了解决 Multirepo 的协作痛点，Google、Facebook 等大厂率先采用了 <strong>Monorepo (Monolithic Repository)</strong>。</p>
<blockquote>
<p>🏢 <strong>比喻</strong>：大家搬进了一栋巨大的大平层公寓。虽然每人还有自己的房间（目录），但都在同一个大门（Git 仓库）里进出。</p>
</blockquote>
<h4 data-id="heading-7">这种模式是怎样的？</h4>
<ul>
<li><strong>所有项目</strong>都在同一个 Git 仓库里（例如 <code>apps/web</code>，<code>apps/docs</code>，<code>packages/ui</code>）。</li>
<li>使用 Workspace（工作区）技术将它们在本地软链接起来。</li>
</ul>
<h4 data-id="heading-8">✅ 优点</h4>
<ul>
<li><strong>原子提交 (Atomic Commits)</strong>：你可以一次 Commit 同时修复前后端的 Bug，保证版本的一致性。</li>
<li><strong>代码共享零成本</strong>：你在 <code>packages/ui</code> 里改了按钮颜色，保存一下，<code>apps/web</code> 里立马生效，根本不需要发包！</li>
<li><strong>统一规范</strong>：大家共用一套配置，从此不再有“你用 2 空格缩进，我用 4 空格”的争吵。</li>
</ul>
<h4 data-id="heading-9">❌ 新的问题</h4>
<ul>
<li><strong>构建太慢了！</strong> 以前你只构建一个项目，现在仓库里有 10 个项目。如果每次改一行代码，CI（持续集成）都要把 10 个项目全跑一遍，那就要等到天荒地老</li>
</ul>
<p>在微服务架构流行之前（大概 2015 年以前），绝大多数项目（包括 JSP、ASP.NET、PHP）其实都是单体。那时候大家默认就是“一个仓库管所有代码”，根本不需要发明 Monorepo 这个词。后来，微服务和前后端分离流行起来了，大家把仓库拆散了（Multirepo）。再后来，大家发现拆太散了不好管，又把它们合并回来了，这时候为了区分“强耦合的单体”和“松耦合的多项目集合”，才强调了 Monorepo 这个概念</p>
<hr/>
<h3 data-id="heading-10">3. Turborepo：大平层的“智能管家”</h3>
<p>这时候，<strong>Turborepo</strong> 登场了。</p>
<p>很多人的误区在于：<em>“我要用 Turborepo 还是用 Monorepo？”</em>
<strong>这是一个错误的问题。</strong> Turborepo 不是 Monorepo 的替代品，而是它的<strong>加速器</strong>。</p>
<blockquote>
<p>🤖 <strong>比喻</strong>：Turborepo 是这栋大平层公寓配备的<strong>AI 智能管家</strong>。</p>
</blockquote>
<h4 data-id="heading-11">Turborepo 解决了什么？</h4>
<p>它专门解决 Monorepo “构建慢、任务乱” 的问题。</p>
<h5 data-id="heading-12">⚡️ 核心黑科技 1：任务编排 (Pipeline)</h5>
<p>它知道 <code>web</code> 应用依赖 <code>ui</code> 包。当你运行构建命令时，它会自动先构建 <code>ui</code>，而且能把互不相关的任务（比如 <code>lint</code> 和 <code>test</code>）利用多核 CPU <strong>并行执行</strong>。</p>
<h5 data-id="heading-13">⚡️ 核心黑科技 2：智能缓存 (Caching)</h5>
<p>这是 Turborepo 的杀手锏。当你运行构建时，它会先检查：“哎，这个文件之前构建过吗？输入变了吗？”</p>
<ul>
<li>如果没变：<strong>直接从缓存复制粘贴结果</strong>。时间消耗：<strong>几毫秒</strong>。</li>
<li>甚至支持<strong>云端缓存</strong>：你同事构建过的结果，你拉下来也能直接用！</li>
</ul>
<hr/>
<h4 data-id="heading-14">4. 项目实践</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fturborepo.com%2Fdocs%2Fgetting-started%2Finstallation" target="_blank" title="https://turborepo.com/docs/getting-started/installation" ref="nofollow noopener noreferrer">Turborepo官网</a></p>
<p>安装</p>
<pre><code class="hljs language-bash" lang="bash">pnpm dlx create-turbo@latest
</code></pre>
<p>以下是我工程目录</p>
<p>我们的目标目录结构如下：</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-strapi-monorepo/
├── apps/
│   ├── backend/          <span class="hljs-comment"># Strapi v5 主程序</span>
│   └── docs/             <span class="hljs-comment"># VitePress 文档站</span>
├── packages/
│   ├── strapi-plugin-bag/ <span class="hljs-comment"># 我们的插件核心代码</span>
│   └── ui/               <span class="hljs-comment"># (可选) 共享 UI 组件库</span>
├── package.json
├── pnpm-workspace.yaml
└── turbo.json
</code></pre>
<p>这种结构清晰地分离了“宿主应用”和“插件包”，模拟了真实的 npm 包引用场景。</p>
<h4 data-id="heading-15">统一依赖管理 (Workspace)</h4>
<p>在根目录的 <code>pnpm-workspace.yaml</code> 中，我们将所有项目串联起来：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">packages:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">"apps/*"</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">"packages/*"</span>
</code></pre>
<p>然后，在 <code>apps/backend/package.json</code> 中，我们可以直接引用本地插件，无需发包，无需 <code>npm link</code>：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"strapi-plugin-bag"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"workspace:*"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>这意味着，<code>strapi-plugin-bag</code> 的任何修改，对于 <code>backend</code> 来说都是实时可见的。</p>
<h4 data-id="heading-16">配置 turbo.json</h4>
<p>这是 Turborepo 的大脑。我们需要告诉它，Strapi 的构建产物在哪里，以及哪些任务需要并行。</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"$schema"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://turborepo.com/schema.json"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"tasks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-comment">// 依赖上游的 build (例如 backend 依赖插件先 build 完)</span>
      <span class="hljs-attr">"dependsOn"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"^build"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-comment">// 告诉 Turbo 哪些文件是产物，下次命中缓存直接恢复，不用真跑</span>
      <span class="hljs-attr">"outputs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"dist/**"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"build/**"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">".next/**"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-comment">// 开发服务器不需要缓存，且需要持久化运行</span>
      <span class="hljs-attr">"cache"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"persistent"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>小技巧</strong>：Strapi 的产物在 <code>build/</code>，插件在 <code>dist/</code>，VitePress 在 <code>.vitepress/dist</code>。确保把这些目录都加到 <code>outputs</code> 里，Turbo 的缓存才能生效。</p>
<h4 data-id="heading-17">一键启动全栈环境</h4>
<p>在根目录运行：</p>
<pre><code class="hljs language-bash" lang="bash">pnpm dev
</code></pre>
<p>Turborepo 会自动寻找所有子项目中的 <code>dev</code> 脚本并并行执行：</p>
<ul>
<li>✅ <strong>Backend</strong>: 启动 Strapi CMS (<code>http://localhost:1337</code>)</li>
<li>✅ <strong>Plugin</strong>: 开启 TypeScript 实时编译监听</li>
<li>✅ <strong>Docs</strong>: 启动 VitePress 文档 (<code>http://localhost:5173</code>)</li>
</ul>
<p>所有日志汇聚在一个终端，互不干扰，配合极好。</p>
<h4 data-id="heading-18">精准构建</h4>
<p>只想重新构建插件？不需要跑整个仓库：</p>
<pre><code class="hljs language-bash" lang="bash">turbo run build --filter=strapi-plugin-bag
</code></pre>
<p>Turbo 的 <code>--filter</code> 参数非常强大，支持依赖拓扑筛选。比如 <code>turbo run build --filter=backend...</code> 会自动先构建 backend 依赖的所有包（插件），然后再构建 backend，--filter=等于项目名字(在package.json)</p>
<h3 data-id="heading-19">📝 总结</h3>
<p>通过引入 Turborepo，我们将分散的 Strapi 插件开发流程整合成了一个有机的整体。</p>
<ul>
<li><strong>开发</strong>：<code>pnpm dev</code> 一键起飞。</li>
<li><strong>调试</strong>：Workspace 软链接让源码修改即时生效。</li>
<li><strong>文档</strong>：代码和文档同仓管理，版本同步更容易。</li>
</ul>
<p>如果你也在做 Strapi 插件开发，强烈推荐尝试这种架构，它会让你从繁琐的 <code>cd</code> 命令中解放出来，专注于代码本身。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58ab86cdce434487bbea4507fbe1941d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6Iiq6am_56uZ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766581558&amp;x-signature=ZNCrYEB0pUmRqYQKcZ3TaldJOHo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-20">总结：该怎么选？</h3>

























<table><thead><tr><th align="left">模式</th><th align="left">适用场景</th><th align="left">关键特点</th></tr></thead><tbody><tr><td align="left"><strong>Multirepo</strong></td><td align="left">团队完全隔离，技术栈无关，项目间几乎没有代码复用。</td><td align="left">简单，但协作成本高。</td></tr><tr><td align="left"><strong>Monorepo</strong></td><td align="left">全栈团队，前后端紧密协作，有公共组件库或工具库。</td><td align="left">协作爽，代码复用率高。</td></tr><tr><td align="left"><strong>Turborepo</strong></td><td align="left"><strong>只要你用了 Monorepo，就强烈建议用它！</strong></td><td align="left">让 Monorepo 快得飞起。</td></tr></tbody></table>
<p><strong>一句话总结：</strong>
Monorepo 是一种<strong>架构风格</strong>（把大家聚在一起），而 Turborepo 是<strong>工具</strong>（让大家聚在一起还能高效干活）</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[为什么 JavaScript 可以单线程却能处理异步？]]></title>    <link>https://juejin.cn/post/7584650857070641161</link>    <guid>https://juejin.cn/post/7584650857070641161</guid>    <pubDate>2025-12-17T13:07:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584650857070641161" data-draft-id="7584680708138827827" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="为什么 JavaScript 可以单线程却能处理异步？"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2025-12-17T13:07:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="天涯学馆"/> <meta itemprop="url" content="https://juejin.cn/user/3394916565129287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            为什么 JavaScript 可以单线程却能处理异步？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3394916565129287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    天涯学馆
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T13:07:48.000Z" title="Wed Dec 17 2025 13:07:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读16分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>今天咱们聊一个前端最核心的机制：​<strong>​JavaScript 单线程却能处理异步操作的秘密——事件循环（Event Loop）​</strong>​。</p>
<p>你可能遇到过这种情况：用 <code>setTimeout</code> 延迟执行代码，或者用 <code>fetch</code> 发网络请求时，主线程并没有卡住，反而能继续执行后面的代码。明明 JS 是单线程的（同一时间只能做一件事），这是怎么做到的？</p>
<p>别急，我会用 ​<strong>​“底层机制+代码演示+流程拆解”​</strong>​ 的方式，带你彻底搞懂事件循环的运行原理。</p>
<h2 data-id="heading-0">前置知识：JS 单线程的本质</h2>
<h3 data-id="heading-1">什么是单线程？</h3>
<p>单线程指的是 ​<strong>​JavaScript 引擎（如 V8）的主线程同一时间只能执行一个任务​</strong>​。这意味着：</p>
<ul>
<li>所有同步代码必须按顺序执行，前一个任务没完成，后一个任务必须等待；</li>
<li>如果有一个任务耗时很长（比如死循环、大量计算），后面的任务会被“阻塞”（卡住）。</li>
</ul>
<p>​<strong>​举个栗子​</strong>​：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'开始'</span>);
<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {  <span class="hljs-comment">// 死循环（耗时任务）</span>
  <span class="hljs-comment">// 主线程被卡死，后面的代码永远执行不到</span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'结束'</span>);  <span class="hljs-comment">// 永远不会输出</span>
</code></pre>
<p>这就是单线程的“缺陷”——容易阻塞。但 JS 又必须处理异步操作（比如网络请求、文件读取），否则早就被淘汰了。</p>
<h3 data-id="heading-2">为什么 JS 必须支持异步？</h3>
<p>因为浏览器需要处理大量“耗时但不阻塞主线程”的操作：</p>
<ul>
<li>网络请求（<code>fetch</code>、<code>XMLHttpRequest</code>）；</li>
<li>定时器（<code>setTimeout</code>、<code>setInterval</code>）；</li>
<li>事件监听（点击、滚动）；</li>
<li>文件操作（Node.js 中的 <code>fs</code> 模块）。</li>
</ul>
<p>如果这些操作都用同步方式执行，浏览器会直接“假死”（比如点一个按钮要等 3 秒才能响应）。所以 JS 必须设计一套机制，让这些耗时操作“在后台执行”，不阻塞主线程。</p>
<h2 data-id="heading-3">事件循环的核心角色：谁在“调度”任务？</h2>
<p>要理解事件循环，必须先明确 JS 运行时的几个核心“角色”：</p>






























<table><thead><tr><th>角色</th><th>职责</th><th>所属环境</th></tr></thead><tbody><tr><td>​<strong>​调用栈（Call Stack）​</strong>​</td><td>存储同步任务的执行上下文（函数调用链），按“后进先出”顺序执行</td><td>JS 引擎（V8）</td></tr><tr><td>​<strong>​Web APIs​</strong>​</td><td>浏览器提供的“后台线程能力”（如定时器、网络请求、DOM 事件监听）</td><td>浏览器（非 JS 引擎）</td></tr><tr><td>​<strong>​任务队列（Task Queue）​</strong>​</td><td>存储异步任务完成后的“回调函数”，等待事件循环调度执行</td><td>浏览器</td></tr><tr><td>​<strong>​事件循环（Event Loop）​</strong>​</td><td>不断检查调用栈是否为空，若为空则从任务队列中取出回调函数执行</td><td>浏览器</td></tr></tbody></table>
<p>​<strong>​一句话总结​</strong>​：<br/>
JS 主线程（调用栈）只负责执行同步代码；遇到异步操作（如 <code>setTimeout</code>），就交给 Web APIs 后台处理；Web APIs 完成任务后，把回调函数“丢”到任务队列；事件循环负责“盯着”调用栈，一旦调用栈空了，就从任务队列里“捞”回调函数来执行。</p>
<h2 data-id="heading-4">事件循环的执行流程（附代码演示）</h2>
<h3 data-id="heading-5">基础流程：同步任务 → 微任务 → 宏任务</h3>
<p>事件循环的执行顺序有一个核心规则：​<strong>​同步任务优先，微任务（Microtask）次之，宏任务（Macrotask）最后​</strong>​。</p>
<h4 data-id="heading-6">关键概念区分：</h4>
<ul>
<li>​<strong>​同步任务​</strong>​：直接在调用栈中执行的任务（如 <code>console.log</code>、普通函数调用）；</li>
<li>​<strong>​微任务​</strong>​：由 <code>Promise.then</code>、<code>MutationObserver</code> 等 API 产生的回调，优先级高于宏任务；</li>
<li>​<strong>​宏任务​</strong>​：由 <code>setTimeout</code>、<code>setInterval</code>、<code>I/O</code>、DOM 事件等 API 产生的回调，优先级低于微任务。</li>
</ul>
<h4 data-id="heading-7">代码演示 1：基础执行顺序</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1: 同步任务'</span>);

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3: 宏任务（setTimeout）'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2: 微任务（Promise.then）'</span>);
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4: 微任务（另一个 Promise.then）'</span>);
  });
</code></pre>
<p>​<strong>​输出顺序​</strong>​：<code>1 → 2 → 4 → 3</code></p>
<p>​<strong>​执行流程拆解​</strong>​：</p>
<ol>
<li>
<p>​<strong>​执行同步任务​</strong>​：调用栈先执行 <code>console.log('1')</code>，输出 <code>1</code>；</p>
</li>
<li>
<p>​<strong>​处理异步任务​</strong>​：</p>
<ul>
<li>遇到 <code>setTimeout</code>，将其交给 Web APIs 的定时器线程处理（定时 0ms）；</li>
<li>遇到 <code>Promise.resolve().then()</code>，将其回调（第一个 <code>then</code>）加入微任务队列；</li>
</ul>
</li>
<li>
<p>​<strong>​同步任务执行完毕​</strong>​：调用栈清空；</p>
</li>
<li>
<p>​<strong>​执行微任务​</strong>​：事件循环检查微任务队列，按顺序执行两个 <code>then</code> 回调，输出 <code>2</code> 和 <code>4</code>；</p>
</li>
<li>
<p>​<strong>​执行宏任务​</strong>​：微任务队列清空后，事件循环检查宏任务队列，执行 <code>setTimeout</code> 的回调，输出 <code>3</code>。</p>
</li>
</ol>
<h3 data-id="heading-8">进阶流程：嵌套异步任务</h3>
<p>实际代码中，异步任务可能嵌套（比如 <code>setTimeout</code> 里又有 <code>Promise</code>），事件循环的处理逻辑依然遵循“同步→微任务→宏任务”的顺序，但需要注意​<strong>​每一轮事件循环只处理一个宏任务​</strong>​（除非宏任务队列为空）。</p>
<h4 data-id="heading-9">代码演示 2：嵌套异步任务</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'A: 同步任务'</span>);

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'B: 宏任务（外层 setTimeout）'</span>);
  
  <span class="hljs-comment">// 嵌套的微任务</span>
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'C: 微任务（外层 setTimeout 内的 then）'</span>);
  });
  
  <span class="hljs-comment">// 嵌套的宏任务</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'D: 宏任务（内层 setTimeout）'</span>);
  }, <span class="hljs-number">0</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-comment">// 顶层的微任务</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'E: 微任务（顶层 then）'</span>);
});
</code></pre>
<p>​<strong>​输出顺序​</strong>​：<code>A → E → B → C → D</code></p>
<p>​<strong>​执行流程拆解​</strong>​：</p>
<ol>
<li>
<p>​<strong>​执行同步任务​</strong>​：输出 <code>A</code>；</p>
</li>
<li>
<p>​<strong>​处理异步任务​</strong>​：</p>
<ul>
<li>外层 <code>setTimeout</code> 交给定时器线程（0ms）；</li>
<li>顶层 <code>Promise.then</code> 回调加入微任务队列；</li>
</ul>
</li>
<li>
<p>​<strong>​同步任务结束​</strong>​：调用栈清空；</p>
</li>
<li>
<p>​<strong>​执行微任务​</strong>​：执行顶层 <code>then</code> 回调，输出 <code>E</code>；</p>
</li>
<li>
<p>​<strong>​第一轮事件循环结束​</strong>​，开始处理宏任务队列：</p>
<ul>
<li>取出外层 <code>setTimeout</code> 的回调执行，输出 <code>B</code>；</li>
<li>外层 <code>setTimeout</code> 回调中遇到新的 <code>Promise.then</code>，将其加入微任务队列；</li>
<li>外层 <code>setTimeout</code> 回调中遇到内层 <code>setTimeout</code>，交给定时器线程（0ms）；</li>
</ul>
</li>
<li>
<p>​<strong>​第一轮宏任务处理完毕​</strong>​，立即执行新产生的微任务：</p>
<ul>
<li>执行外层 <code>setTimeout</code> 内的 <code>then</code> 回调，输出 <code>C</code>；</li>
</ul>
</li>
<li>
<p>​<strong>​第二轮事件循环开始​</strong>​，处理宏任务队列：</p>
<ul>
<li>取出内层 <code>setTimeout</code> 的回调执行，输出 <code>D</code>。</li>
</ul>
</li>
</ol>
<h3 data-id="heading-10">特殊场景：DOM 事件与异步</h3>
<p>DOM 事件（如点击、滚动）的回调属于宏任务，但它们的触发时机与事件循环密切相关。</p>
<h4 data-id="heading-11">代码演示 3：DOM 事件回调</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn"</span>&gt;</span>点击我<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1: 同步任务'</span>);

  <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'btn'</span>);
  btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3: DOM 事件回调（宏任务）'</span>);
    
    <span class="hljs-comment">// 事件回调中的微任务</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4: 事件回调内的微任务'</span>);
    });
  });

  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2: 宏任务（setTimeout）'</span>);
  }, <span class="hljs-number">0</span>);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>​<strong>​可能的输出顺序​</strong>​（取决于用户何时点击按钮）：</p>
<ul>
<li>如果用户在 <code>setTimeout</code> 回调执行前点击按钮：<code>1 → 3 → 4 → 2</code>；</li>
<li>如果用户在 <code>setTimeout</code> 回调执行后点击按钮：<code>1 → 2 → 3 → 4</code>。</li>
</ul>
<p>​<strong>​执行流程拆解​</strong>​：</p>
<ol>
<li>
<p>执行同步任务，输出 <code>1</code>；</p>
</li>
<li>
<p>注册 <code>setTimeout</code>（宏任务）和 <code>click</code> 事件监听（宏任务）；</p>
</li>
<li>
<p>若用户先点击按钮：</p>
<ul>
<li>点击事件触发，回调被加入宏任务队列；</li>
<li><code>setTimeout</code> 回调也被加入宏任务队列；</li>
<li>事件循环先处理 <code>click</code> 宏任务（因为先进入队列），输出 <code>3</code>；</li>
<li>执行 <code>click</code> 回调中的微任务，输出 <code>4</code>；</li>
<li>最后处理 <code>setTimeout</code> 宏任务，输出 <code>2</code>；</li>
</ul>
</li>
<li>
<p>若用户后点击按钮：</p>
<ul>
<li><code>setTimeout</code> 回调先被处理，输出 <code>2</code>；</li>
<li>然后处理 <code>click</code> 宏任务，输出 <code>3</code>；</li>
<li>最后执行 <code>click</code> 回调中的微任务，输出 <code>4</code>。</li>
</ul>
</li>
</ol>
<h2 data-id="heading-12">为什么 JS 单线程还能“异步”？核心答案</h2>
<p>现在回到最初的问题：​<strong>​JS 单线程却能处理异步，本质原因是什么？​</strong>​</p>
<h3 data-id="heading-13">异步操作不由 JS 引擎主线程执行</h3>
<p>JS 引擎（如 V8）只负责执行同步代码和调度任务。像网络请求、定时器这些耗时操作，实际是由浏览器的其他线程（如网络线程、定时器线程）完成的。JS 主线程只需要“注册”异步任务（比如告诉定时器线程“3 秒后执行这个函数”），然后继续执行后面的同步代码。</p>
<h3 data-id="heading-14">事件循环负责“调度”异步回调</h3>
<p>当异步任务完成后（比如定时器到时间、网络请求返回数据），浏览器会将对应的回调函数放入任务队列。事件循环会不断检查调用栈是否为空：</p>
<ul>
<li>如果调用栈空了，就从任务队列中取出回调函数，交给调用栈执行；</li>
<li>如果调用栈不空（还在执行同步代码），事件循环就继续等待。</li>
</ul>
<h3 data-id="heading-15">微任务和宏任务的优先级设计</h3>
<p>通过区分微任务和宏任务，JS 可以更精细地控制异步回调的执行顺序。微任务（如 <code>Promise.then</code>）会在当前调用栈清空后立即执行（属于“本轮事件循环”），而宏任务（如 <code>setTimeout</code>）会在下一轮事件循环执行。这种设计保证了异步操作的高效调度。</p>
<h2 data-id="heading-16">事件循环的“隐藏阶段”：浏览器和 Node.js 的差异</h2>
<p>你可能不知道：​<strong>​浏览器和 Node.js 的事件循环实现完全不同​</strong>​！虽然核心目标一致（调度异步任务），但具体阶段划分和执行顺序差异很大。</p>
<h3 data-id="heading-17">浏览器的事件循环：聚焦“渲染”与“用户交互”</h3>
<p>浏览器的事件循环围绕 ​<strong>​“页面渲染”​</strong>​ 设计，核心目标是让用户界面流畅响应。它的执行流程可简化为以下步骤（简化版）：</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> 执行调用栈中的同步任务 → 
<span class="hljs-bullet">2.</span> 执行所有微任务（Microtask Queue） → 
<span class="hljs-bullet">3.</span> 检查是否需要渲染（如距离上次渲染超过 16ms） → 
   a. 执行 UI 渲染（重排/重绘） → 
<span class="hljs-bullet">4.</span> 从宏任务队列（Macrotask Queue）中取出一个任务执行 → 
<span class="hljs-bullet">5.</span> 重复步骤 2~4（直到所有队列为空）
</code></pre>
<p>​<strong>​关键细节​</strong>​：</p>
<ul>
<li>​<strong>​渲染时机​</strong>​：浏览器默认以 ​<strong>​60Hz 刷新率​</strong>​（约 16ms/帧）渲染页面。如果同步任务执行时间超过 16ms，会导致“掉帧”（页面卡顿）。因此，事件循环会在每轮宏任务后检查是否需要渲染，避免长时间阻塞渲染。</li>
<li>​<strong>​宏任务的“公平性”​</strong>​：浏览器宏任务队列是“队列优先”（FIFO），但为了保证交互响应，用户触发的事件（如点击、滚动）的回调会被“插队”到队列头部，优先执行。</li>
</ul>
<p>​<strong>​代码演示：渲染与事件循环的关系​</strong>​</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'开始'</span>);

<span class="hljs-comment">// 同步任务：耗时 20ms（超过 16ms 渲染间隔）</span>
<span class="hljs-keyword">const</span> start = performance.<span class="hljs-title function_">now</span>();
<span class="hljs-keyword">while</span> (performance.<span class="hljs-title function_">now</span>() - start &lt; <span class="hljs-number">20</span>) {}

<span class="hljs-comment">// 宏任务：setTimeout</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setTimeout 执行'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-comment">// 微任务：Promise.then</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Promise.then 执行'</span>);
});

<span class="hljs-comment">// 输出顺序：开始 → Promise.then → setTimeout 执行</span>
</code></pre>
<p>​<strong>​执行流程​</strong>​：</p>
<ul>
<li>同步任务耗时 20ms，导致页面无法在第 16ms 渲染（掉帧）；</li>
<li>同步任务结束后，先执行微任务（<code>Promise.then</code>）；</li>
<li>最后执行宏任务（<code>setTimeout</code>）。</li>
</ul>
<h3 data-id="heading-18">Node.js 的事件循环：聚焦“ I/O 与异步操作”</h3>
<p>Node.js 的事件循环是为 ​<strong>​服务器端高并发 I/O​</strong>​ 设计的，核心目标是高效处理大量异步 I/O 请求（如文件读写、数据库查询）。它的阶段划分更复杂，具体分为 6 个阶段（按执行顺序）：</p>








































<table><thead><tr><th>阶段</th><th>职责</th><th>对应的宏任务类型</th></tr></thead><tbody><tr><td>​<strong>​timers​</strong>​</td><td>执行 <code>setTimeout</code>、<code>setInterval</code> 的回调</td><td>定时器相关宏任务</td></tr><tr><td>​<strong>​I/O callbacks​</strong>​</td><td>处理上一轮未完成的 I/O 错误回调（如 TCP 连接错误）</td><td>系统级 I/O 错误回调</td></tr><tr><td>​<strong>​idle/prepare​</strong>​</td><td>内部使用，仅在 Node.js 启动时执行</td><td>无</td></tr><tr><td>​<strong>​poll​</strong>​</td><td>核心阶段：等待新的 I/O 事件（如文件读取完成、网络请求响应）</td><td>大部分 I/O 相关宏任务（除 <code>setImmediate</code>）</td></tr><tr><td>​<strong>​check​</strong>​</td><td>执行 <code>setImmediate</code> 的回调</td><td><code>setImmediate</code> 宏任务</td></tr><tr><td>​<strong>​close callbacks​</strong>​</td><td>执行关闭事件的回调（如 <code>socket.on('close')</code>）</td><td>连接关闭相关回调</td></tr></tbody></table>
<p>​<strong>​关键细节​</strong>​：</p>
<ul>
<li>​<strong>​<code>setImmediate</code> vs <code>setTimeout(0)</code>​</strong>​：
<ul>
<li><code>setImmediate</code> 的回调在 <code>check</code> 阶段执行（本轮事件循环的最后阶段）；</li>
<li><code>setTimeout(0)</code> 的回调在 <code>timers</code> 阶段执行（下一轮事件循环的开始阶段）。<br/>
因此，<code>setImmediate</code> 永远比 <code>setTimeout(0)</code> 先执行（在 Node.js 中）。</li>
</ul>
</li>
</ul>
<p>​<strong>​代码演示：Node.js 事件循环阶段​</strong>​</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-comment">// 阶段 1：timers（setTimeout）</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1: setTimeout（timers 阶段）'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-comment">// 阶段 4：poll（fs.readFile 是 I/O 操作）</span>
fs.<span class="hljs-title function_">readFile</span>(__filename, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2: fs.readFile 回调（poll 阶段）'</span>);
  
  <span class="hljs-comment">// 阶段 5：check（setImmediate）</span>
  <span class="hljs-title function_">setImmediate</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3: setImmediate（check 阶段）'</span>);
  });
  
  <span class="hljs-comment">// 阶段 1：timers（嵌套的 setTimeout）</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4: 嵌套 setTimeout（timers 阶段）'</span>);
  }, <span class="hljs-number">0</span>);
});

<span class="hljs-comment">// 阶段 5：check（直接调用 setImmediate）</span>
<span class="hljs-title function_">setImmediate</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'5: 顶层 setImmediate（check 阶段）'</span>);
});
</code></pre>
<p>​<strong>​输出顺序​</strong>​（每次运行可能略有不同，但 <code>setImmediate</code> 总在 <code>setTimeout(0)</code> 前）：</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">1: setTimeout（timers 阶段）</span>
<span class="hljs-section">2: fs.readFile 回调（poll 阶段）</span>
<span class="hljs-section">3: setImmediate（check 阶段）</span>
<span class="hljs-section">5: 顶层 setImmediate（check 阶段）</span>
<span class="hljs-section">4: 嵌套 setTimeout（timers 阶段）</span>
</code></pre>
<h2 data-id="heading-19">宏任务与微任务的“细分家族”：你以为的“宏任务”可能不是真宏任务</h2>
<p>之前我们简单区分了宏任务和微任务，但实际上它们的“家族成员”各有不同。明确每个任务的来源，能帮你更精准地控制执行顺序。</p>
<h3 data-id="heading-20">宏任务（Macrotask）的常见类型</h3>
<p>宏任务是“需要等待当前调用栈和微任务队列清空后才能执行”的任务，常见来源包括：</p>



































<table><thead><tr><th>来源</th><th>示例</th><th>说明</th></tr></thead><tbody><tr><td>​<strong>​定时器​</strong>​</td><td><code>setTimeout</code>、<code>setInterval</code></td><td>基于时间的延迟执行</td></tr><tr><td>​<strong>​I/O 操作​</strong>​</td><td><code>fs.readFile</code>（Node.js）、<code>fetch</code></td><td>网络请求、文件读写等异步 I/O</td></tr><tr><td>​<strong>​UI 渲染​</strong>​（浏览器）</td><td><code>requestAnimationFrame</code>（部分场景）</td><td>浏览器渲染帧的回调</td></tr><tr><td>​<strong>​事件监听​</strong>​</td><td><code>click</code>、<code>scroll</code> 等 DOM 事件回调</td><td>用户交互触发的回调</td></tr><tr><td>​<strong>​<code>setImmediate</code>​</strong>​（Node.js）</td><td><code>setImmediate(() =&gt; {})</code></td><td>Node.js 特有的“本轮事件循环结束后”执行</td></tr></tbody></table>
<h3 data-id="heading-21">微任务（Microtask）的常见类型</h3>
<p>微任务是“在当前调用栈清空后立即执行”的任务，优先级高于宏任务，常见来源包括：</p>






























<table><thead><tr><th>来源</th><th>示例</th><th>说明</th></tr></thead><tbody><tr><td>​<strong>​Promise 回调​</strong>​</td><td><code>Promise.then()</code>、<code>Promise.catch()</code></td><td>Promise 状态变为 <code>fulfilled</code> 或 <code>rejected</code> 后的回调</td></tr><tr><td>​<strong>​MutationObserver​</strong>​（浏览器）</td><td><code>new MutationObserver(callback)</code></td><td>监听 DOM 变化的回调</td></tr><tr><td>​<strong>​process.nextTick​</strong>​（Node.js）</td><td><code>process.nextTick(() =&gt; {})</code></td><td>Node.js 特有的“微任务队列优先级最高”的任务（比普通微任务更早执行）</td></tr><tr><td>​<strong>​async/await​</strong>​（本质是 Promise）</td><td><code>async function() { await ... }</code></td><td><code>await</code> 后的代码会被包装成微任务</td></tr></tbody></table>
<p>​<strong>​关键细节​</strong>​：</p>
<ul>
<li><code>async/await</code> 的底层是 Promise：<code>await</code> 会暂停函数执行，将后续代码包装成微任务，等待 Promise 解决后执行。</li>
<li><code>process.nextTick</code> 在 Node.js 中是“伪微任务”：它的优先级比普通微任务（如 <code>Promise.then</code>）更高，会在当前调用栈清空后​<strong>​立即执行​</strong>​（甚至在宏任务之前）。</li>
</ul>
<p>​<strong>​代码演示：Node.js 中 <code>process.nextTick</code> 的优先级​</strong>​</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'开始'</span>);

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1: setTimeout（宏任务）'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2: Promise.then（微任务）'</span>);
});

process.<span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3: process.nextTick（伪微任务）'</span>);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'结束'</span>);
</code></pre>
<p>​<strong>​输出顺序​</strong>​：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">开始</span> <span class="hljs-string">→</span> <span class="hljs-string">结束</span> <span class="hljs-string">→</span> <span class="hljs-attr">3:</span> <span class="hljs-string">process.nextTick</span> <span class="hljs-string">→</span> <span class="hljs-attr">2:</span> <span class="hljs-string">Promise.then</span> <span class="hljs-string">→</span> <span class="hljs-attr">1:</span> <span class="hljs-string">setTimeout</span>
</code></pre>
<h2 data-id="heading-22">调试工具：用 Chrome DevTools“看见”事件循环</h2>
<p>理论看懂了，但如何验证？推荐用 Chrome DevTools 的 ​<strong>​Performance 面板​</strong>​ 直接观察事件循环的执行过程。</p>
<h3 data-id="heading-23">步骤 1：打开 Performance 面板</h3>
<ol>
<li>按 <code>F12</code> 打开 DevTools；</li>
<li>点击 <code>Performance</code> 标签；</li>
<li>点击左上角的 <code>录制</code> 按钮（或按 <code>Ctrl+E</code>）开始记录。</li>
</ol>
<h3 data-id="heading-24">步骤 2：执行测试代码</h3>
<p>在控制台执行以下代码：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'同步任务'</span>);

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'宏任务（setTimeout）'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'微任务（Promise.then）'</span>);
});
</code></pre>
<h3 data-id="heading-25">步骤 3：分析记录结果</h3>
<p>停止录制后，Performance 面板会显示时间线。重点关注 ​<strong>​Main 线程​</strong>​ 的调用栈和任务队列：</p>
<ul>
<li>​<strong>​同步任务​</strong>​：显示为连续的调用栈（如 <code>console.log('同步任务')</code>）；</li>
<li>​<strong>​微任务​</strong>​：在调用栈清空后，显示为 <code>Promise.then</code> 的执行；</li>
<li>​<strong>​宏任务​</strong>​：在微任务执行后，显示为 <code>setTimeout</code> 的回调执行。</li>
</ul>
<p>​<strong>​截图示例​</strong>​（文字描述）：</p>
<ul>
<li>时间轴 0ms：开始执行同步任务；</li>
<li>时间轴 1ms：同步任务结束，调用栈清空；</li>
<li>时间轴 1ms：执行微任务（<code>Promise.then</code>）；</li>
<li>时间轴 2ms：微任务结束，开始执行宏任务（<code>setTimeout</code>）。</li>
</ul>
<h2 data-id="heading-26">实战避坑：事件循环的常见陷阱</h2>
<h3 data-id="heading-27">陷阱 1：定时器“延迟不准”</h3>
<p>你可能遇到过：<code>setTimeout(fn, 100)</code> 实际执行时间远大于 100ms。原因是 ​<strong>​同步任务耗时过长，阻塞了事件循环​</strong>​，导致定时器回调无法按时执行。</p>
<p>​<strong>​示例​</strong>​：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'定时器执行'</span>); <span class="hljs-comment">// 实际延迟可能远大于 100ms</span>
}, <span class="hljs-number">100</span>);

<span class="hljs-comment">// 同步任务耗时 1000ms</span>
<span class="hljs-keyword">const</span> start = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
<span class="hljs-keyword">while</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - start &lt; <span class="hljs-number">1000</span>) {}
</code></pre>
<p>​<strong>​解决方案​</strong>​：</p>
<ul>
<li>避免在主线程执行耗时操作（如大数据计算）；</li>
<li>将耗时任务拆分为小任务（用 <code>setTimeout</code> 或 <code>requestIdleCallback</code> 分段执行）；</li>
<li>使用 Web Workers（浏览器）或 Worker Threads（Node.js）将任务放到后台线程。</li>
</ul>
<h3 data-id="heading-28">陷阱 2：微任务“堆积导致页面卡死”</h3>
<p>微任务会在当前调用栈清空后立即执行，如果微任务队列无限增长（如递归调用 <code>Promise.then</code>），会导致页面永远无法渲染（因为事件循环被微任务阻塞）。</p>
<p>​<strong>​示例​</strong>​：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">recursiveMicrotask</span>(<span class="hljs-params"/>) {
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'微任务执行'</span>);
    <span class="hljs-title function_">recursiveMicrotask</span>(); <span class="hljs-comment">// 递归添加微任务</span>
  });
}

<span class="hljs-title function_">recursiveMicrotask</span>();
</code></pre>
<p>​<strong>​现象​</strong>​：</p>
<ul>
<li>控制台会无限输出 <code>微任务执行</code>；</li>
<li>页面无法响应点击、滚动等交互（因为事件循环被微任务队列占满，无法执行渲染或事件回调）。</li>
</ul>
<p>​<strong>​解决方案​</strong>​：</p>
<ul>
<li>避免在微任务中递归调用自身；</li>
<li>限制微任务的数量（如设置最大递归次数）；</li>
<li>将部分任务转为宏任务（如用 <code>setTimeout</code> 包裹）。</li>
</ul>
<h3 data-id="heading-29">陷阱 3：Node.js 中 <code>setImmediate</code> 与 <code>setTimeout</code> 的“竞争”</h3>
<p>在 Node.js 中，<code>setImmediate</code> 和 <code>setTimeout(0)</code> 的执行顺序可能不稳定（取决于事件循环的启动时间）。</p>
<p>​<strong>​示例​</strong>​：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setTimeout（timers 阶段）'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-title function_">setImmediate</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setImmediate（check 阶段）'</span>);
});
</code></pre>
<p>​<strong>​可能的输出​</strong>​：</p>
<ul>
<li>第一次运行：<code>setTimeout</code> 先执行（如果 <code>timers</code> 阶段的延迟接近 0）；</li>
<li>第二次运行：<code>setImmediate</code> 先执行（如果 <code>timers</code> 阶段没有其他任务）。</li>
</ul>
<p>​<strong>​解决方案​</strong>​：</p>
<ul>
<li>如果需要严格的执行顺序，避免依赖 <code>setImmediate</code> 和 <code>setTimeout(0)</code> 的顺序；</li>
<li>明确使用 <code>setImmediate</code> 表示“本轮事件循环结束后执行”，<code>setTimeout</code> 表示“延迟指定时间后执行”。</li>
</ul>
<h2 data-id="heading-30">常见误区与总结</h2>
<h3 data-id="heading-31">误区 1：JS 是多线程的？</h3>
<p>​<strong>​错误​</strong>​。JS 主线程是单线程的，但浏览器环境（如 Web APIs）是多线程的。JS 通过事件循环与这些线程协作，实现了“异步”的效果。</p>
<h3 data-id="heading-32">误区 2：<code>setTimeout(0)</code> 会立即执行？</h3>
<p>​<strong>​错误​</strong>​。<code>setTimeout(0)</code> 表示“将回调函数放入宏任务队列，等待当前调用栈和微任务队列清空后立即执行”，而不是立即执行。</p>
<h3 data-id="heading-33">误区 3：微任务比宏任务优先级高，所以会插队？</h3>
<p>​<strong>​正确​</strong>​。微任务队列的优先级高于宏任务队列，所以每轮事件循环会先清空微任务队列，再处理宏任务队列。</p>
<h2 data-id="heading-34">事件循环的“口诀”</h2>
<p>事件循环的核心是 ​<strong>​“协作式调度”​</strong>​：JS 主线程负责同步任务，异步任务交给其他线程处理，完成后通过回调函数“排队”，事件循环按优先级（微任务→宏任务）调度执行。</p>
<p>同步任务先执行，调用栈里排好队；<br/>
遇到异步交后台，Web APIs 帮你忙；<br/>
定时网络事件等，完成回调放队列；<br/>
微任务队列优先级，当前循环接着跑；<br/>
宏任务队列下一轮，事件循环来回跑；<br/>
单线程不阻塞住，异步全靠事件环。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【AI 编程实战】第 4 篇：一次完美 vs 五轮对话 - UnoCSS 配置的正确姿势]]></title>    <link>https://juejin.cn/post/7584472215976116239</link>    <guid>https://juejin.cn/post/7584472215976116239</guid>    <pubDate>2025-12-17T12:07:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584472215976116239" data-draft-id="7584633505104724020" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【AI 编程实战】第 4 篇：一次完美 vs 五轮对话 - UnoCSS 配置的正确姿势"/> <meta itemprop="keywords" content="前端,uni-app,AI编程"/> <meta itemprop="datePublished" content="2025-12-17T12:07:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HashTang"/> <meta itemprop="url" content="https://juejin.cn/user/1117561754756488"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【AI 编程实战】第 4 篇：一次完美 vs 五轮对话 - UnoCSS 配置的正确姿势
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1117561754756488/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HashTang
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T12:07:48.000Z" title="Wed Dec 17 2025 12:07:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读12分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="vs2015">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1e1e1e;color:#dcdcdc}.hljs-keyword,.hljs-link,.hljs-literal,.hljs-name,.hljs-symbol{color:#569cd6}.hljs-link{text-decoration:underline}.hljs-built_in,.hljs-type{color:#4ec9b0}.hljs-class,.hljs-number{color:#b8d7a3}.hljs-meta-string,.hljs-string{color:#d69d85}.hljs-regexp,.hljs-template-tag{color:#9a5334}.hljs-formula,.hljs-function,.hljs-params,.hljs-subst,.hljs-title{color:#dcdcdc}.hljs-comment,.hljs-quote{color:#57a64a;font-style:italic}.hljs-doctag{color:#608b4e}.hljs-meta,.hljs-meta-keyword,.hljs-tag{color:#9b9b9b}.hljs-template-variable,.hljs-variable{color:#bd63c5}.hljs-attr,.hljs-attribute,.hljs-builtin-name{color:#9cdcfe}.hljs-section{color:gold}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-bullet,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-selector-tag{color:#d7ba7d}.hljs-addition{background-color:#144212}.hljs-addition,.hljs-deletion{display:inline-block;width:100%}.hljs-deletion{background-color:#600}</style><blockquote>
<p>很多教程告诉你"写好提示词就能让 AI 一次给出正确答案"，但现实是：<strong>你不可能一开始就知道所有细节</strong>。真正高效的 AI 协作，是在对话中逐步明确需求。这篇文章通过一个完整的 UnoCSS 配置案例，展示我和 TRAE SOLO 的<strong>真实交互过程</strong>——从模糊想法到完整方案，中间经历了哪些沟通和调整。</p>
<p>这是《<a href="https://juejin.cn/column/7579556047783624756" target="_blank" title="https://juejin.cn/column/7579556047783624756">AI 编程实战：TRAE SOLO 全栈开发指南</a>》专栏的第四篇文章，带你学会如何与 AI 正确的沟通协作。</p>
</blockquote>
<h2 data-id="heading-0">一、开篇：别被"完美提示词"骗了</h2>
<h3 data-id="heading-1">1.1 一个常见的误区</h3>
<p>网上很多 AI 教程会给你看这样的"完美提示词"：</p>
<pre><code class="hljs language-txt" lang="txt">帮我配置 UnoCSS，项目环境和需求如下：
【项目环境】UniApp + Vue3 + Vite，目标平台微信小程序
【功能需求】支持 attributify、@apply、图标、安全区适配
【已知问题】小程序 transform 类需要预设 CSS 变量
【输出要求】完整的 uno.config.ts 配置文件
</code></pre>
<p>然后告诉你："看，一次就能得到完美答案！"</p>
<p><strong>但问题是</strong>：</p>
<ul>
<li>你一开始怎么知道需要"安全区适配"？</li>
<li>你怎么知道"transform 类需要预设 CSS 变量"？</li>
<li>这些都是<strong>踩坑之后才知道的</strong></li>
</ul>
<h3 data-id="heading-2">1.2 真实的 AI 协作是什么样的</h3>
<p>真实的 AI 协作是一个<strong>渐进式对话</strong>的过程：</p>
<pre><code class="hljs language-txt" lang="txt">第 1 轮：我有个模糊的需求
    ↓
AI：给出初步方案 + 执行计划
    ↓
第 2 轮：我发现问题 / 补充细节
    ↓
AI：调整方案
    ↓
第 3 轮：遇到报错 / 样式不生效
    ↓
AI：排查问题 + 修复
    ↓
最终：得到完整可用的方案
</code></pre>
<p>接下来，我会完整展示和 TRAE SOLO 配置 UnoCSS 的<strong>真实对话过程</strong>。</p>
<h2 data-id="heading-3">二、第一轮对话：从模糊需求开始</h2>
<h3 data-id="heading-4">2.1 我的第一句话</h3>
<p>刚开始，我对 UnoCSS 的了解很有限，只知道它是"原子化 CSS"。我的第一句话很简单：</p>
<pre><code class="hljs language-txt" lang="txt">我：项目需要用 UnoCSS，帮我配置一下
</code></pre>
<h3 data-id="heading-5">2.2 TRAE SOLO 的响应：先给执行计划</h3>
<p>TRAE SOLO 没有直接开始写代码，而是先给出了<strong>执行计划</strong>：</p>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：好的，我来帮你配置 UnoCSS。在开始之前，我需要先了解一些信息：

📋 执行计划：
1. 分析项目结构，确定技术栈
2. 选择合适的 UnoCSS 预设
3. 生成配置文件
4. 配置 Vite 插件

🤔 我有几个问题：
1. 这是什么类型的项目？（Vue/React/UniApp）
2. 目标运行平台是什么？（Web/小程序/App）
3. 有没有特别想要的功能？（图标/attributify 模式等）

请告诉我这些信息，或者我可以先分析你的项目结构来判断。
</code></pre>
<p><strong>关键点</strong>：TRAE SOLO 主动<strong>询问上下文</strong>，而不是瞎猜。</p>
<h3 data-id="heading-6">2.3 我补充信息</h3>
<pre><code class="hljs language-txt" lang="txt">我：UniApp + Vue3 项目，主要跑微信小程序，也要支持 H5。
    功能的话，我也不太清楚，你看着配吧，常用的都加上。
</code></pre>
<h3 data-id="heading-7">2.4 TRAE SOLO 分析项目后给出方案</h3>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：我分析了你的项目结构，发现：
- 框架：UniApp + Vue3 + Vite
- UI 库：已安装 wot-design-uni
- 目标：微信小程序 + H5

📋 更新执行计划：

1. 安装依赖
   - unocss
   - @uni-helper/unocss-preset-uni （UniApp 专用预设，必须）
   - @iconify-json/carbon （图标库，可选）

2. 创建 uno.config.ts，包含：
   - presetUni：小程序适配
   - presetAttributify：支持属性化写法
   - presetIcons：图标支持
   - transformerDirectives：支持 @apply 指令

3. 修改 vite.config.ts，添加 UnoCSS 插件

4. 在 main.ts 中引入 uno.css

是否按这个计划执行？或者你想调整什么？
</code></pre>
<h3 data-id="heading-8">2.5 我确认执行</h3>
<pre><code class="hljs language-txt" lang="txt">我：可以，就按这个来
</code></pre>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：好的，开始执行...

✅ 正在安装依赖...
✅ 创建 uno.config.ts...
✅ 修改 vite.config.ts...
✅ 修改 main.ts...

配置完成！你可以这样使用：

&lt;view class="flex items-center gap-4 p-4 bg-white rounded-xl"&gt;
  &lt;text class="text-lg font-bold"&gt;Hello UnoCSS&lt;/text&gt;
&lt;/view&gt;

运行 pnpm dev:mp-weixin 试试看效果。
</code></pre>
<h2 data-id="heading-9">三、第二轮对话：遇到问题，继续沟通</h2>
<h3 data-id="heading-10">3.1 我发现样式不生效</h3>
<p>运行项目后，我发现部分样式不生效：</p>
<pre><code class="hljs language-txt" lang="txt">我：样式大部分生效了，但是 translate-x-2 这个类没效果，
    元素没有移动
</code></pre>
<h3 data-id="heading-11">3.2 TRAE SOLO 排查问题</h3>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：让我检查一下...

我查看了生成的 CSS，发现 translate-x-2 生成的代码是：

transform: translateX(var(--un-translate-x));

问题在于：小程序环境没有预设 --un-translate-x 这个 CSS 变量。

在浏览器中，UnoCSS 会通过 :root 选择器预设这些变量，
但小程序不支持 :root 选择器。

🔧 修复方案：
在 uno.config.ts 中添加 preflights，手动为小程序元素预设变量。

是否需要我帮你修复？
</code></pre>
<h3 data-id="heading-12">3.3 我让它修复</h3>
<pre><code class="hljs language-txt" lang="txt">我：帮我修复吧
</code></pre>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：好的，我来修改 uno.config.ts...

添加了以下配置：

preflights: [
  {
    layer: 'unocss-transform-fix',
    getCSS: () =&gt; `
page, view, text, image {
  --un-translate-x: 0;
  --un-translate-y: 0;
  --un-rotate: 0;
  --un-scale-x: 1;
  --un-scale-y: 1;
  /* ... 其他变量 */
}
`,
  },
],

✅ 已修复，重新运行项目试试。
</code></pre>
<h3 data-id="heading-13">3.4 我验证修复成功</h3>
<pre><code class="hljs language-txt" lang="txt">我：好了，translate 生效了
</code></pre>
<h2 data-id="heading-14">四、第三轮对话：追加新需求</h2>
<h3 data-id="heading-15">4.1 我想添加安全区适配</h3>
<p>开发过程中，我发现 iPhone 底部有安全区域遮挡内容：</p>
<pre><code class="hljs language-txt" lang="txt">我：iPhone 底部有个横条会挡住内容，UnoCSS 能处理这个吗？
</code></pre>
<h3 data-id="heading-16">4.2 TRAE SOLO 给出方案</h3>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：这是 iPhone 的安全区域问题。可以通过自定义 UnoCSS 规则来解决。

📋 方案：
添加以下自定义规则：
- pb-safe：底部安全区内边距
- pt-safe：顶部安全区内边距（刘海屏）
- p-safe：四边安全区内边距

使用方式：
&lt;view class="pb-safe"&gt;底部内容会避开安全区&lt;/view&gt;

是否需要我添加这些规则？
</code></pre>
<pre><code class="hljs language-txt" lang="txt">我：加上吧
</code></pre>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：好的，在 uno.config.ts 的 rules 中添加：

rules: [
  ['pb-safe', { 'padding-bottom': 'env(safe-area-inset-bottom)' }],
  ['pt-safe', { 'padding-top': 'env(safe-area-inset-top)' }],
  ['p-safe', {
    padding: 'env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)',
  }],
],

✅ 已添加，现在可以使用 pb-safe 类了。
</code></pre>
<h2 data-id="heading-17">五、第四轮对话：优化开发体验</h2>
<h3 data-id="heading-18">5.1 我觉得类名太长了</h3>
<pre><code class="hljs language-txt" lang="txt">我：flex items-center justify-between 每次都要写这么长，
    有没有办法简化？
</code></pre>
<h3 data-id="heading-19">5.2 TRAE SOLO 介绍 shortcuts</h3>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：可以用 UnoCSS 的 shortcuts 功能，把常用组合定义成短类名。

比如：
- center = flex justify-center items-center
- between = flex justify-between items-center

你想定义哪些快捷方式？或者我根据你的代码分析常用组合？
</code></pre>
<pre><code class="hljs language-txt" lang="txt">我：你分析一下吧，看哪些用得多
</code></pre>
<h3 data-id="heading-20">5.3 TRAE SOLO 分析代码后给出建议</h3>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：我扫描了你的代码，发现以下组合出现频率较高：

📊 使用频率分析：
1. flex items-center （出现 23 次）
2. flex items-center justify-between （出现 15 次）
3. flex items-center justify-center （出现 12 次）
4. flex flex-col （出现 8 次）
5. bg-white rounded-xl p-4 （出现 7 次）

🔧 建议添加的 shortcuts：

shortcuts: [
  { 'center': 'flex justify-center items-center' },
  { 'between': 'flex justify-between items-center' },
  { 'col': 'flex flex-col' },
  { 'card': 'bg-white rounded-xl p-4' },
],

是否按这个配置？或者你想调整？
</code></pre>
<pre><code class="hljs language-txt" lang="txt">我：可以，就这样
</code></pre>
<h2 data-id="heading-21">六、第五轮对话：处理动态类名问题</h2>
<h3 data-id="heading-22">6.1 我遇到动态类名不生效</h3>
<pre><code class="hljs language-txt" lang="txt">我：我有个地方根据状态切换颜色：

    &lt;text :class="`text-${status}-500`"&gt;状态&lt;/text&gt;

    status 可能是 red、green、blue，但样式不生效
</code></pre>
<h3 data-id="heading-23">6.2 TRAE SOLO 解释原因并给方案</h3>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：这是 UnoCSS 的一个限制。

🔍 原因：
UnoCSS 在构建时静态扫描代码，`text-${status}-500` 这种
动态拼接的类名无法被识别，所以不会生成对应的 CSS。

🔧 解决方案有三种：

【方案一】对象语法（推荐）
&lt;text :class="{
  'text-red-500': status === 'red',
  'text-green-500': status === 'green',
  'text-blue-500': status === 'blue',
}"&gt;状态&lt;/text&gt;

【方案二】safelist 预声明
在 uno.config.ts 中添加：
safelist: ['text-red-500', 'text-green-500', 'text-blue-500']

【方案三】CSS 变量
&lt;text class="text-[var(--status-color)]"
      :style="{ '--status-color': statusColor }"&gt;
  状态
&lt;/text&gt;

你的场景用哪种方案比较合适？
</code></pre>
<pre><code class="hljs language-txt" lang="txt">我：颜色就这三种，用方案二吧，简单
</code></pre>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：好的，已添加到 safelist：

safelist: [
  'text-red-500',
  'text-green-500',
  'text-blue-500',
  'i-carbon-code', // 之前已有的图标
],

✅ 现在动态类名可以正常工作了。
</code></pre>
<h2 data-id="heading-24">七、最终配置：多轮对话的成果</h2>
<p>经过 5 轮对话，最终的 <code>uno.config.ts</code> 是这样的：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// uno.config.ts</span>
<span class="hljs-comment">// 这个配置是通过多轮对话逐步完善的，不是一次性写出来的</span>

<span class="hljs-keyword">import</span> { presetUni } <span class="hljs-keyword">from</span> <span class="hljs-string">'@uni-helper/unocss-preset-uni'</span>
<span class="hljs-keyword">import</span> {
  defineConfig,
  presetAttributify,
  presetIcons,
  transformerDirectives,
  transformerVariantGroup,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'unocss'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-comment">// 【第 1 轮】基础预设</span>
  <span class="hljs-attr">presets</span>: [
    <span class="hljs-title function_">presetUni</span>({
      <span class="hljs-attr">attributify</span>: {
        <span class="hljs-attr">prefixedOnly</span>: <span class="hljs-literal">true</span>,
      },
    }),
    <span class="hljs-title function_">presetIcons</span>({
      <span class="hljs-attr">scale</span>: <span class="hljs-number">1.2</span>,
      <span class="hljs-attr">warn</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">extraProperties</span>: {
        <span class="hljs-string">'display'</span>: <span class="hljs-string">'inline-block'</span>,
        <span class="hljs-string">'vertical-align'</span>: <span class="hljs-string">'middle'</span>,
      },
    }),
    <span class="hljs-title function_">presetAttributify</span>(),
  ],

  <span class="hljs-comment">// 【第 1 轮】转换器</span>
  <span class="hljs-attr">transformers</span>: [
    <span class="hljs-title function_">transformerDirectives</span>(),
    <span class="hljs-title function_">transformerVariantGroup</span>(),
  ],

  <span class="hljs-comment">// 【第 2 轮】修复小程序 transform 不生效</span>
  <span class="hljs-attr">preflights</span>: [
    {
      <span class="hljs-attr">layer</span>: <span class="hljs-string">'unocss-transform-fix'</span>,
      <span class="hljs-attr">getCSS</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-string">`
page, view, text, image {
  --un-translate-x: 0;
  --un-translate-y: 0;
  --un-translate-z: 0;
  --un-rotate: 0;
  --un-rotate-x: 0;
  --un-rotate-y: 0;
  --un-rotate-z: 0;
  --un-skew-x: 0;
  --un-skew-y: 0;
  --un-scale-x: 1;
  --un-scale-y: 1;
  --un-scale-z: 1;
}
`</span>,
    },
  ],

  <span class="hljs-comment">// 【第 3 轮】安全区适配</span>
  <span class="hljs-attr">rules</span>: [
    [<span class="hljs-string">'p-safe'</span>, {
      <span class="hljs-attr">padding</span>: <span class="hljs-string">'env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)'</span>,
    }],
    [<span class="hljs-string">'pt-safe'</span>, { <span class="hljs-string">'padding-top'</span>: <span class="hljs-string">'env(safe-area-inset-top)'</span> }],
    [<span class="hljs-string">'pb-safe'</span>, { <span class="hljs-string">'padding-bottom'</span>: <span class="hljs-string">'env(safe-area-inset-bottom)'</span> }],
  ],

  <span class="hljs-comment">// 【第 4 轮】常用快捷方式</span>
  <span class="hljs-attr">shortcuts</span>: [
    { <span class="hljs-string">'center'</span>: <span class="hljs-string">'flex justify-center items-center'</span> },
    { <span class="hljs-string">'between'</span>: <span class="hljs-string">'flex justify-between items-center'</span> },
    { <span class="hljs-string">'col'</span>: <span class="hljs-string">'flex flex-col'</span> },
    { <span class="hljs-string">'card'</span>: <span class="hljs-string">'bg-white rounded-xl p-4'</span> },
  ],

  <span class="hljs-comment">// 【第 5 轮】动态类名预声明</span>
  <span class="hljs-attr">safelist</span>: [
    <span class="hljs-string">'text-red-500'</span>,
    <span class="hljs-string">'text-green-500'</span>,
    <span class="hljs-string">'text-blue-500'</span>,
    <span class="hljs-string">'i-carbon-code'</span>,
  ],

  <span class="hljs-comment">// 【第 1 轮】主题配置</span>
  <span class="hljs-attr">theme</span>: {
    <span class="hljs-attr">colors</span>: {
      <span class="hljs-attr">primary</span>: <span class="hljs-string">'var(--wot-color-theme, #0957DE)'</span>,
    },
    <span class="hljs-attr">fontSize</span>: {
      <span class="hljs-string">'2xs'</span>: [<span class="hljs-string">'20rpx'</span>, <span class="hljs-string">'28rpx'</span>],
      <span class="hljs-string">'3xs'</span>: [<span class="hljs-string">'18rpx'</span>, <span class="hljs-string">'26rpx'</span>],
    },
  },
})
</code></pre>
<h2 data-id="heading-25">八、组件开发：同样是对话式协作</h2>
<h3 data-id="heading-26">8.1 开发回复卡片组件</h3>
<p>配置完成后，我开始开发业务组件。同样是对话式协作：</p>
<pre><code class="hljs language-txt" lang="txt">我：帮我写一个回复卡片组件，用来展示 AI 生成的回复。
    左边是语气标签（比如"高情商"），中间是回复文字，右边是复制按钮。
</code></pre>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：好的，我来帮你开发这个组件。

📋 执行计划：
1. 创建 ReplyCard.vue 组件
2. 定义 Props：tone（语气）、text（文本）
3. 定义 Events：copy（复制）
4. 使用 UnoCSS 原子类实现样式

🤔 几个问题：
1. 语气标签的颜色是固定的还是根据内容变化？
2. 复制按钮是图标还是文字？
3. 有没有设计稿可以参考？
</code></pre>
<pre><code class="hljs language-txt" lang="txt">我：标签颜色根据语气类型自动变，用哈希算法分配吧。
    复制按钮用图标。设计稿没有，你自己设计一个好看的。
</code></pre>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：明白了，我来实现：

【设计方案】
- 卡片：白色背景、圆角、内边距
- 标签：小圆角、根据文字哈希分配 5 种颜色
- 文本：深灰色、支持多行
- 按钮：圆形点击区域、图标居中

开始生成代码...
</code></pre>
<h3 data-id="heading-27">8.2 TRAE SOLO 生成的组件</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- components/ReplyCard.vue --&gt;
&lt;template&gt;
  &lt;view class="flex items-center gap-2.5 bg-white rounded-xl p-4 pr-2"&gt;
    &lt;!-- 语气标签 --&gt;
    &lt;view
      v-show="!hideTag"
      class="text-xs font-bold rounded-sm px-2 py-1 flex-shrink-0"
      :style="{ backgroundColor: tagStyle.bg, color: tagStyle.text }"
    &gt;
      {{ tone }}
    &lt;/view&gt;

    &lt;!-- 回复文本 --&gt;
    &lt;view class="text-sm text-#1F2937 flex-1"&gt;
      {{ text }}
    &lt;/view&gt;

    &lt;!-- 复制按钮 --&gt;
    &lt;view
      class="w-9 h-9 center cursor-pointer"
      @click="$emit('copy', text)"
    &gt;
      &lt;image src="/static/images/home/copy.svg" mode="aspectFit" class="w-5 h-5" /&gt;
    &lt;/view&gt;
  &lt;/view&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { computed } from 'vue';

interface Props {
  tone: string;
  text: string;
  hideTag?: boolean;
}

const props = withDefaults(defineProps&lt;Props&gt;(), {
  hideTag: false,
});

defineEmits&lt;{
  copy: [text: string];
}&gt;();

// 5 种预设颜色
const COLORS = [
  { bg: '#F3E8FF', text: '#8B5CF6' },  // 紫色
  { bg: '#E6FFFA', text: '#319795' },  // 青色
  { bg: '#FFF5E6', text: '#F56500' },  // 橙色
  { bg: '#FFE4E6', text: '#E11D48' },  // 粉色
  { bg: '#E0F2FE', text: '#0284C7' },  // 蓝色
];

// 根据语气文字哈希分配颜色
const tagStyle = computed(() =&gt; {
  let hash = 0;
  for (let i = 0; i &lt; props.tone.length; i++) {
    hash = (hash + props.tone.charCodeAt(i)) % COLORS.length;
  }
  return COLORS[hash];
});
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-28">8.3 我提出修改意见</h3>
<pre><code class="hljs language-txt" lang="txt">我：不错，但我想加一个功能：有时候不需要显示标签，能不能加个 prop 控制？
</code></pre>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：已经有了，就是 hideTag 这个 prop。

使用方式：
&lt;ReplyCard tone="高情商" text="回复内容" :hide-tag="true" /&gt;

设置 hide-tag 为 true 就会隐藏标签。
</code></pre>
<pre><code class="hljs language-txt" lang="txt">我：哦对，我没注意看。那再加个需求：复制成功后给个反馈
</code></pre>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：复制反馈建议在父组件处理，因为：
1. 卡片组件应该保持简单，只负责 UI
2. 复制逻辑和 toast 提示是业务逻辑，放父组件更合适

父组件这样用：

&lt;ReplyCard
  tone="高情商"
  text="回复内容"
  @copy="handleCopy"
/&gt;

const handleCopy = async (text: string) =&gt; {
  await copyText(text);
  toast.success('已复制');
};

你觉得这样合理吗？还是希望把 toast 放在组件内部？
</code></pre>
<pre><code class="hljs language-txt" lang="txt">我：你说得对，放父组件更好
</code></pre>
<h2 data-id="heading-29">九、核心经验：与 AI 协作的正确姿势</h2>
<h3 data-id="heading-30">9.1 不要追求"一次完美"</h3>





















<table><thead><tr><th>错误做法</th><th>正确做法</th></tr></thead><tbody><tr><td>花 30 分钟写一个"完美提示词"</td><td>花 1 分钟说出需求，让 AI 提问</td></tr><tr><td>一次性想清楚所有细节</td><td>边做边发现问题，逐步完善</td></tr><tr><td>把 AI 当执行工具</td><td>把 AI 当协作伙伴，可以对话</td></tr></tbody></table>
<h3 data-id="heading-31">9.2 让 AI 先给执行计划</h3>
<p>每次提需求后，让 AI 先给出<strong>执行计划</strong>：</p>
<pre><code class="hljs language-txt" lang="txt">我：[需求描述]

AI：📋 执行计划：
    1. xxx
    2. xxx
    3. xxx

    🤔 有几个问题：
    1. xxx？
    2. xxx？

    确认后我开始执行。
</code></pre>
<p><strong>好处</strong>：</p>
<ul>
<li>确保 AI 理解正确</li>
<li>发现遗漏的需求</li>
<li>可以在执行前调整方向</li>
</ul>
<h3 data-id="heading-32">9.3 遇到问题时提供上下文</h3>
<p><strong>❌ 错误方式</strong>：</p>
<pre><code class="hljs language-txt" lang="txt">我：样式不生效
</code></pre>
<p><strong>✅ 正确方式</strong>：</p>
<pre><code class="hljs language-txt" lang="txt">我：translate-x-2 这个类在小程序里不生效，但在 H5 正常。
    我看了生成的 CSS，是 transform: translateX(var(--un-translate-x))。
    是不是变量没定义？
</code></pre>
<h3 data-id="heading-33">9.4 让 AI 解释它的方案</h3>
<p>当 AI 给出方案时，追问原理：</p>
<pre><code class="hljs language-txt" lang="txt">我：为什么要用 preflights？直接写 CSS 不行吗？
</code></pre>
<pre><code class="hljs language-txt" lang="txt">TRAE SOLO：preflights 是 UnoCSS 的预设样式注入机制，和直接写 CSS 的区别：

1. preflights 会被注入到所有生成的 CSS 之前，确保优先级正确
2. 可以通过 layer 控制加载顺序
3. 统一管理，修改时只需要改配置文件

直接写 CSS 也可以，但需要确保加载顺序正确，否则可能被覆盖。
</code></pre>
<p><strong>好处</strong>：理解原理后，下次遇到类似问题可以自己判断。</p>
<h2 data-id="heading-34">十、总结：对话式协作 &gt; 完美提示词</h2>
<h3 data-id="heading-35">10.1 本文的核心观点</h3>
<ol>
<li><strong>不要追求"一次完美的提示词"</strong>，真实的 AI 协作是多轮对话</li>
<li><strong>让 AI 先给执行计划</strong>，确认后再执行</li>
<li><strong>遇到问题时提供上下文</strong>，帮助 AI 定位问题</li>
<li><strong>追问原理</strong>，理解 AI 的方案，下次才能举一反三</li>
</ol>
<h3 data-id="heading-36">10.2 5 轮对话完成的工作</h3>



































<table><thead><tr><th>轮次</th><th>需求</th><th>成果</th></tr></thead><tbody><tr><td>第 1 轮</td><td>基础配置</td><td>presets、transformers、theme</td></tr><tr><td>第 2 轮</td><td>修复 transform 问题</td><td>preflights</td></tr><tr><td>第 3 轮</td><td>安全区适配</td><td>自定义 rules</td></tr><tr><td>第 4 轮</td><td>简化常用类名</td><td>shortcuts</td></tr><tr><td>第 5 轮</td><td>动态类名支持</td><td>safelist</td></tr></tbody></table>
<h3 data-id="heading-37">10.3 下一篇预告</h3>
<p><strong>《【AI 编程实战】第 5 篇：Pinia 状态管理不会写？让 AI 手把手教你最佳实践》</strong></p>
<p>下一篇继续展示对话式协作，教你：</p>
<ul>
<li>如何让 AI 设计 Store 结构</li>
<li>状态持久化的对话过程</li>
<li>用户登录态管理的多轮沟通</li>
</ul>
<hr/>
<blockquote>
<p>与 AI 协作的关键不是"写出完美提示词"，而是<strong>学会和 AI 对话</strong>。</p>
<p>如果这篇文章对你有帮助，请点赞、收藏！</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[想偷懒购买现成的应用，结果一更新就遇到了4.3a！]]></title>    <link>https://juejin.cn/post/7584680708138745907</link>    <guid>https://juejin.cn/post/7584680708138745907</guid>    <pubDate>2025-12-17T12:36:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584680708138745907" data-draft-id="7584650673825202216" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="想偷懒购买现成的应用，结果一更新就遇到了4.3a！"/> <meta itemprop="keywords" content="APP,Apple,uni-app"/> <meta itemprop="datePublished" content="2025-12-17T12:36:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iOS研究院"/> <meta itemprop="url" content="https://juejin.cn/user/1421041942671774"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            想偷懒购买现成的应用，结果一更新就遇到了4.3a！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1421041942671774/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iOS研究院
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T12:36:04.000Z" title="Wed Dec 17 2025 12:36:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">背景</h2>
<p>对于Appstore来说，除了开发者自行研发产品之外。也可以通过AppStore留下的后门，<strong>转让功能</strong>！</p>
<p>今天就简单聊聊，一位粉丝因为产品上架不顺利，所以反手买了同类型的竞品。</p>
<h3 data-id="heading-1">交易背景</h3>
<p>某粉丝因为自己制作的工具产品遭遇了3.2f封号的洗礼，又想快速抢回自己的市场，所以<code>自以为聪明的购买了一套AppStore线上的产品</code>。</p>
<p>出发点本身没有问题，确实是解决问题最快的方式，但是忽略几个关键的信息内容：</p>
<ul>
<li>老包App上架、迭代时间</li>
<li>账号潜在风险</li>
</ul>
<h3 data-id="heading-2">老包上架时间</h3>
<p>购买的老包上架时间为2020年06月17日，最近一次迭代时间为2021年11月17日。历时更新了13个版本，无论是从包本身还是版本迭代周期，其实产品本身肯定是健康的。<code>毕竟活了将近5年的产品，账号的权重和产品的权重，无需多言</code>。</p>
<p>那为什么把这点单独提出来，是因为<code>最近迭代更新的时间</code>。</p>
<p>在2021年的时候，<code>苹果审核的算法肯定是今非昔比</code>。这种情况不亚于，<strong>用前朝的剑斩本朝的官</strong>。</p>
<p>直白来讲，之前更新顺利是因为苹果查的不严，竞品不多。在这种背景下，产品是健硕。无论是当时的用户交互还是UI设计，肯定是符合当下苹果开发者准则。</p>
<p>但时至今日，那很难说了。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84934b6b2f3b419383e36f23f062d93d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaU9T56CU56m26Zmi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766579764&amp;x-signature=UJfPK%2BFY4A1cNBuOMG0C%2BO5E2JQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">账号潜在风险</h3>
<p>交易的账号有几款产品，但是粉丝只需要其中一款。那么问题来了，之后的事情没有人可以担保不发生意外。</p>
<p><strong>首先就是关联风险，这种App转让的行为是强关联。</strong> 买过来的产品继续当良民最好一些隔离措施，但是不表明卖家一直可以健健康康。如果卖家一旦出现不可控的违规行为，<code>那么买过来的产品到底能活多久？是一个大大问号</code>！</p>
<p>客观来说非要转让产品，<strong>除非打包一起买</strong>，不然多增加变量。</p>
<p>不过话说回来，这种成本又被间接性拉高，同时未必卖家愿意。</p>
<h3 data-id="heading-4">4.3a破局</h3>
<p>粉丝在遭遇了2次4.3a后，一时间乱了阵脚。主动在后台留言咨询，请求付费破局。在了解到整个事件来龙去脉后，<code>耗时7天工作日，成功完成App迭代工作</code>。</p>
<p>主要协助解决了<strong>API接口处理，内购订阅功能，3.2f老包版本功能植入</strong>。</p>
<p><code>遵守规则，方得长治久安</code>，最后祝大家大吉大利，今晚过审！</p>
<h3 data-id="heading-5">相关推荐</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FURmC_4vxQv5ttOg8yYe7Eg" target="_blank" title="https://mp.weixin.qq.com/s/URmC_4vxQv5ttOg8yYe7Eg" ref="nofollow noopener noreferrer"># 苹果开发者续费大坑及成功续费方案！亲测有效</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F1bAA90Tzpx03tTHZbdg3aw" target="_blank" title="https://mp.weixin.qq.com/s/1bAA90Tzpx03tTHZbdg3aw" ref="nofollow noopener noreferrer"># AppStore敏感词排查手册，多维度分析Guideline 2.3.1隐藏功能，轻松过审。</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FV2F4BaEYh5HfeUUHm1tI6Q" target="_blank" title="https://mp.weixin.qq.com/s/V2F4BaEYh5HfeUUHm1tI6Q" ref="nofollow noopener noreferrer"># 如何主动提防苹果3.2f的进攻，自查防御手册（代码篇）</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FLs3su8fmMckTocPwMmFaNQ" target="_blank" title="https://mp.weixin.qq.com/s/Ls3su8fmMckTocPwMmFaNQ" ref="nofollow noopener noreferrer"># 如何主动提防苹果3.2f的进攻，自查防御手册（ASO篇）</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484371%26idx%3D1%26sn%3D33568c58e90a5bf4d2612d803ecb2a27%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484371&amp;idx=1&amp;sn=33568c58e90a5bf4d2612d803ecb2a27&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># 苹果加急审核是“绿色通道”还是“死亡陷阱”？</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484362%26idx%3D1%26sn%3Dea61bd42d5ae8b99d2a56cbfb8d91e88%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484362&amp;idx=1&amp;sn=ea61bd42d5ae8b99d2a56cbfb8d91e88&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># 苹果开发者邮箱，突然收到11.2通知严重么？</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484413%26idx%3D1%26sn%3D82870d4c8892fa65803a8e05fd5ac938%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484413&amp;idx=1&amp;sn=82870d4c8892fa65803a8e05fd5ac938&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># 不想被苹果卡审最好错开这两个提审时间</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484349%26idx%3D1%26sn%3D1c75a6b08cb5de64ddf41a88b61ff108%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484349&amp;idx=1&amp;sn=1c75a6b08cb5de64ddf41a88b61ff108&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># 手撕苹果审核4.3是代码问题还是设计问题？</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484344%26idx%3D1%26sn%3D4399eb8d8bf82e9c5df26a18b8564cfb%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484344&amp;idx=1&amp;sn=4399eb8d8bf82e9c5df26a18b8564cfb&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># 有幸和Appstore审核人员进行了一场视频会议特此记录。</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android Charles Proxy 抓包]]></title>    <link>https://juejin.cn/post/7584650421124513833</link>    <guid>https://juejin.cn/post/7584650421124513833</guid>    <pubDate>2025-12-17T12:36:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584650421124513833" data-draft-id="7584650421124464681" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android Charles Proxy 抓包"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-17T12:36:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="louisgeek"/> <meta itemprop="url" content="https://juejin.cn/user/1099167357208151"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android Charles Proxy 抓包
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1099167357208151/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    louisgeek
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T12:36:34.000Z" title="Wed Dec 17 2025 12:36:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Android Charles Proxy 抓包</h2>
<ul>
<li>抓包工具 Charles Proxy，是一款跨平台的 HTTP/HTTPS 代理服务器与网络封包分析工具，核心是通过拦截转发网络请求实现抓包、调试与模拟，广泛用于移动开发、Web 开发与接口联调</li>
<li>可以实现弱网模拟、Mock 数据、压力测试等场景</li>
<li>可以通过安装 Charles 根证书来解决 HTTPS 抓包问题（HTTPS 请求显示 unknown）</li>
</ul>
<h3 data-id="heading-1">启动代理服务​</h3>
<ul>
<li>Charles 启动后，会自动配置系统代理（默认端口：8888），此时电脑的所有网络请求访问都会经过 Charles 转发，可在 Charles 窗口查看请求记录（比如访问 <a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.example.com%25EF%25BC%258C%25E7%2594%25B1%25E4%25BA%258E" target="_blank" title="https://api.example.com%EF%BC%8C%E7%94%B1%E4%BA%8E" ref="nofollow noopener noreferrer">api.example.com，由于</a> HTTPS 请求是加密的，默认无法查看内容，需要额外安装 Charles 根证书）</li>
<li>可以通过菜单 Proxy -&gt; Windows proxy 取消勾选来关闭这个系统代理</li>
</ul>
<h3 data-id="heading-2">配置手机代理</h3>
<ul>
<li>通过 Charles 菜单的 Help -&gt; Local IP Addresses 功能可以查看电脑的 IP（选中后可以用 Ctrl + C 进行复制），或通过操作系统设置自行查看</li>
<li>通过 Charles 菜单的 Proxy -&gt; Proxy Settings 设置监听端口（默认端口：8888）</li>
<li>手机上设置代理：设置 -&gt; WLAN 设置 -&gt; 连上指定的 Wifi（需要确保与电脑在同一局域网） -&gt; 网络详情 -&gt; 代理 -&gt; 选择手动 -&gt; 主机名填入电脑的 IP，端口填入 8888 后保存</li>
</ul>
<h3 data-id="heading-3">HTTPS 请求抓包</h3>
<ul>
<li>通过 Charles 菜单的 Proxy -&gt; SSL Proxying Settings -&gt; 勾选 Enable SSL Proxying 来开启 SSL 代理，选中对应标签页，在下方点击 + 号添加一条规则，Host 填写目标域名（比如输入通配符 *，代理所有 HTTPS 请求），Port 输入 443（HTTPS 默认端口），也可以根据需要添加特定域名（比如 *.example.com）</li>
<li>如果抓包电脑端的请求，通过菜单的 Help -&gt; SSL Proxying -&gt; Install Charles Root Certificate，按照向导来安装根证书</li>
<li>如果抓包手机端的请求，手机上通过浏览器访问 chls.pro/ssl 网址（Charles 提供的证书下载地址，可以通过 Charles 菜单的 Help -&gt; SSL Proxying -&gt; Install Charles Root Certificate on a Mobile Device or Remote Browser 查看信息），下载并安装 Charles  根证书，打开手机设置 -&gt; 安全 -&gt; 更多安全设置 -&gt; 加密与凭据 -&gt; 安装证书（从存储设备安装） -&gt; CA 证书 -&gt; 在本地 SD 存储中找到已下载的证书文件</li>
<li>也可以通过 Charles 菜单的 Help -&gt; SSL Proxying -&gt; Save Charles Root Certificate，将证书保存为 .cer 文件（记得切换文件类型），自行进行手动导入。最终 Charles 里如果能看到请求的明文内容，就说明所有必需的配置都设置成功了</li>
<li>安卓从 Android 7.0（API 24）开始，出于安全考虑引入了安全机制，系统默认不再信任用户安装的 CA 证书，这意味着像 Charles、Fiddler 等抓包工具的 HTTPS 证书，会被 App 拒绝，导致无法抓包，解决方案就是修改 App 的 AndroidManifest.xml 中配置的网络安全配置文件，指定在调试模式下信任用户证书</li>
</ul>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">application</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MyApplication"</span>
    <span class="hljs-attr">android:networkSecurityConfig</span>=<span class="hljs-string">"@xml/network_security_config"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 其他配置 --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>
</code></pre>
<p>network_security_config.xml</p>
<pre><code class="hljs language-xml" lang="xml">&lt;​?xml version="1.0" encoding="utf-8"?&gt;
<span class="hljs-tag">&lt;<span class="hljs-name">network-security-config</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- debug 调试模式下信任证书（为了 Charles/Fiddler 抓包），此配置仅在 debug 版本生效（android:debuggable="true"），release 版本会自动失效，确保发布版本的安全性 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">debug-overrides</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">trust-anchors</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- 信任系统预装的证书 --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">certificates</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"system"</span> /&gt;</span>
            <span class="hljs-comment">&lt;!-- 信任用户安装的证书 --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">certificates</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"user"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">trust-anchors</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">debug-overrides</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">network-security-config</span>&gt;</span>
</code></pre>
<h3 data-id="heading-4">模拟弱网环境</h3>
<ul>
<li>用于测试应用在恶劣网络下的表现​，通过 Charles 菜单的 Proxy -&gt; Throttling settings 勾选 Enable Throttling 启用限流（节流）功能，可精准模拟 3G、4G 等弱网环境，提供了常见的网络预设模板供快速选择</li>
</ul>
<h3 data-id="heading-5">修改请求与响应</h3>
<ul>
<li>Mock 数据，右键点击请求，选择 Breakpoints 设置断点，当请求发送时，Charles 会暂停，可修改请求头或参数后点执行继续，当响应到来时，Charles 会暂停，修改返回的 JSON 等数据后点执行继续</li>
</ul>
<h3 data-id="heading-6">重复发送请求</h3>
<ul>
<li>右键点击请求，选择 Repeat 立即重复发送一次请求，选择 Repeat Advanced 可设置 Iterations 重复次数、Concurrency 并发量、Delay 延迟等参数后再进行执行，可以用于模拟压力测试</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[有了开源的 MySQL，为什么还要选择 PostgreSQL？]]></title>    <link>https://juejin.cn/post/7584742635484594186</link>    <guid>https://juejin.cn/post/7584742635484594186</guid>    <pubDate>2025-12-17T12:47:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584742635484594186" data-draft-id="7584657447802961946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="有了开源的 MySQL，为什么还要选择 PostgreSQL？"/> <meta itemprop="keywords" content="MySQL"/> <meta itemprop="datePublished" content="2025-12-17T12:47:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="皮皮林551"/> <meta itemprop="url" content="https://juejin.cn/user/2447981921436084"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            有了开源的 MySQL，为什么还要选择 PostgreSQL？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2447981921436084/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    皮皮林551
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T12:47:37.000Z" title="Wed Dec 17 2025 12:47:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>近年来，随着信创推进与数据库自主可控需求提升，PostgreSQL 凭借其开源、稳定、功能强大的特性，已成为国产数据库创新的首选技术底座。</p>
<p>国内多家头部科技企业纷纷基于 PostgreSQL 深度定制，打造出满足自身业务需求的分布式、云原生或 HTAP 数据库系统。</p>
<p>1.腾讯云 TDSQL PG 版（开源代号：TBase） <code>https://github.com/Tencent/TBase</code></p>
<ul>
<li>引入 GTM 全局事务管理器 + 分布式协调，实现跨 shard 事务。</li>
</ul>
<p>2.阿里云 PolarDB for PostgreSQL</p>
<ul>
<li>重构存储层，实现“一写多读共享存储”，秒级扩容只读节点。</li>
</ul>
<p>3.华为云 GaussDB(for openGauss) —— 部分兼容 PG 生态 <code>https://opengauss.org</code></p>
<ul>
<li>加入列存储引擎、AI 优化器，支持 HTAP。</li>
</ul>
<p>4.杭州易景数通 openHalo <code>https://github.com/HaloTech-Co-Ltd/openHalo</code></p>
<blockquote>
<p>“</p>
<p>那么，为什么这些大厂不选择同样流行的 MySQL，而是纷纷押注 PostgreSQL？这背后，是 PostgreSQL 在多个关键技术维度上的显著优势。</p>
</blockquote>
<h3 data-id="heading-0"><strong>为什么已经有了开源的MySQL还要使用PgSQL呢？</strong></h3>
<p>因为在MySQL使用中有关键的短板，而PgSQL能显著改善。</p>
<h4 data-id="heading-1"><strong>1. MySQL 的数据类型不够丰富</strong></h4>
<p>问题本质：</p>
<p>MySQL 的核心数据类型相对基础，虽然满足大多数业务需求，但在处理复杂场景时显得“力不从心”。</p>
<p>比如：</p>
<ul>
<li><strong>数组类型：</strong>  PostgreSQL 支持 ARRAY，可以存储多个值在一个字段中。</li>
<li><strong>范围类型：</strong>  int4range, tsrange 等，用于表示时间区间、价格区间等。</li>
<li><strong>复合类型：</strong>  自定义结构体（如 POINT(x,y)），直接建模现实世界对象。</li>
<li><strong>JSONB 类型：</strong>  不仅支持 JSON 存储，还能索引、查询、更新，性能远超普通 JSON 字段。</li>
</ul>
<h4 data-id="heading-2"><strong>2. MySQL 不支持序列概念（Sequence）</strong></h4>
<p>MySQL 5.7+ 已经支持 SEQUENCE，但它是通过 <code>AUTO_INCREMENT + 3088413</code> 模拟实现的。</p>
<p>更关键的是：MySQL 缺少真正的独立序列对象（像 Oracle 或 PostgreSQL 那样），无法脱离表单独使用。</p>
<p>举个例子：</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- PostgreSQL 中创建独立序列 </span>
<span class="hljs-keyword">CREATE</span> SEQUENCE order_seq <span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> <span class="hljs-number">1</span> INCREMENT <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>;
<span class="hljs-comment">-- 使用序列生成 ID </span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> orders (id, name) <span class="hljs-keyword">VALUES</span> (nextval(<span class="hljs-string">'order_seq'</span>), <span class="hljs-string">'test'</span>);
</code></pre>
<p>而MySQL：</p>
<pre><code class="hljs language-ini" lang="ini">-- 必须绑定到某张表的 AUTO_INCREMENT 
ALTER TABLE orders <span class="hljs-attr">AUTO_INCREMENT</span> = <span class="hljs-number">1000</span><span class="hljs-comment">;</span>
-- 或者用变量模拟 
SET @<span class="hljs-attr">next_id</span> = <span class="hljs-number">3088413</span> + <span class="hljs-number">1</span><span class="hljs-comment">;</span>
</code></pre>
<ul>
<li>不能跨表共享序列。</li>
<li>分布式环境下难以保证唯一性（除非配合 Redis 等中间件）。</li>
</ul>
<h4 data-id="heading-3"><strong>3. 使用 MySQL 时，网上比较好用的扩展功能插件不多</strong></h4>
<p>PostgreSQL 的生态优势在于其强大的 扩展机制 ，例如：</p>
<ul>
<li><code>TimescaleDB</code>：    时序数据库（自动分区、压缩）</li>
<li><code>pg_trgm</code>:    模糊匹配、相似度搜索</li>
<li><code>Citus</code>:  分布式数据库扩展</li>
<li><code>pg_stat_statements</code>:SQL执行统计监控</li>
</ul>
<blockquote>
<p>“</p>
<p>PostgreSQL 是“可编程数据库”，你可以把整个系统当作一个“应用平台”来扩展；而 MySQL 更像是一个“执行引擎”。</p>
</blockquote>
<h4 data-id="heading-4"><strong>4. MySQL 的性能优化监控工具不是很多，定位问题的成本比较高</strong></h4>
<p><strong>MySQL 的监控短板：</strong></p>
<ul>
<li><strong>官方工具较少：</strong>  虽有 <code>Performance Schema</code> 和 <code>slow_query_log</code>，但配置复杂，解读困难。</li>
<li><strong>缺乏可视化集成：</strong>  不像 PgAdmin 或 DBeaver 提供直观的执行计划、锁等待视图。</li>
<li><strong>诊断依赖经验：</strong>  很多问题需要手动分析日志、查看 <code>SHOW PROCESSLIST</code>、<code>EXPLAIN</code> 等。</li>
</ul>
<p><strong>PostgreSQL 的优势：</strong></p>
<ul>
<li>内置 <code>pg_stat_activity</code>, <code>pg_stat_statements</code>, <code>pg_locks</code> 等丰富的统计视图。</li>
<li>支持 <code>EXPLAIN ANALYZE</code>，能显示真实执行时间和行数。</li>
<li>第三方工具成熟：如 <code>PgAdmin</code>, <code>pg_stat_monitor</code>, <code>Prometheus + Grafana</code> 集成良好。</li>
<li>开源社区活跃，文档齐全，调试资源丰富。</li>
</ul>
<h4 data-id="heading-5"><strong>5.MySQL 主从复制的问题：</strong></h4>
<ul>
<li><strong>异步复制为主：</strong>  默认是异步复制，存在延迟风险。</li>
<li><strong>无强一致性保障：</strong>  主库宕机后，从库可能丢失部分事务。</li>
<li><strong>GTID 机制虽好，但易出错：</strong>  GTID（Global Transaction Identifier）解决了部分问题，但配置不当会导致复制中断。</li>
<li><strong>半同步复制（semi-sync）需额外配置：</strong>  非默认启用，且对网络要求高。</li>
</ul>
<p><strong>PostgreSQL 的解决方案：</strong></p>
<ul>
<li><strong>流复制（Streaming Replication） ：</strong>  支持异步/同步模式。</li>
<li><strong>逻辑复制（Logical Replication） ：</strong>  可以按表复制，甚至跨版本迁移。</li>
<li><strong>WAL（Write-Ahead Logging）机制成熟：</strong>  确保数据持久性和一致性。</li>
<li><strong>支持同步复制（Synchronous Replication） ：</strong>  主库等待至少一个备库确认后再提交事务，实现 零数据丢失。</li>
</ul>
<blockquote>
<p>“</p>
<p>MySQL 的复制更像是“备份机制”；而 PostgreSQL 的复制更接近“高可用架构”的一部分。</p>
</blockquote>
<h4 data-id="heading-6"><strong>6. MySQL 虽然开源，but，不够彻底</strong></h4>
<p>“不够彻底”体现在哪里？</p>






























<table><thead><tr><th>维度</th><th>MySQL</th><th>PostgreSQL</th></tr></thead><tbody><tr><td><strong>许可证</strong></td><td>GPL + 商业许可（Oracle 控制）</td><td>BSD-like，完全自由</td></tr><tr><td><strong>企业版 vs 社区版</strong></td><td>企业版包含高级功能（如审计、加密）</td><td>社区版即完整版，无功能阉割</td></tr><tr><td><strong>源码透明度</strong></td><td>Oracle 掌控核心开发，社区贡献受限</td><td>全球开发者共同维护，开放透明</td></tr><tr><td><strong>长期稳定性</strong></td><td>Oracle 有时会调整路线（如收购 Sun 后影响）</td><td>由基金会主导，不受单一公司控制</td></tr></tbody></table>
<p>举个例子：</p>
<ul>
<li>MySQL 8.0 的某些新特性（如窗口函数）直到 8.0 才引入，而 PostgreSQL 早已支持。</li>
<li>Oracle 为了推动商业产品，可能会故意放缓社区版的功能迭代。</li>
</ul>
<blockquote>
<p>“</p>
<p>PostgreSQL是真正的开源——用户驱动、技术优先、长期稳定</p>
</blockquote>
<h4 data-id="heading-7"><strong>7. PostgreSQL 的 MVCC 实现和 MySQL 不大一样。</strong></h4>
<p>MVCC（多版本并发控制）原理简述：</p>




















<table><thead><tr><th>数据库</th><th>版本管理方式</th><th>优点</th></tr></thead><tbody><tr><td>PostgreSQL</td><td><strong>每行存储多个版本</strong>，旧版本保留在堆中，直到被清理</td><td>读写完全隔离，支持可串行化快照隔离</td></tr><tr><td>MySQL</td><td><strong>只保留当前版本</strong>，旧版本在 undo log 中暂存</td><td>读取更快，但长事务可能导致回滚段膨胀</td></tr></tbody></table>
<p><strong>具体表现：</strong></p>
<ul>
<li>在 PostgreSQL 中，即使你在写数据，别人也可以读取“之前的状态”。</li>
<li>在 MySQL 中，如果事务未提交，其他事务看到的是“脏读”或“不可重复读”（取决于隔离级别）。</li>
</ul>
<h5 data-id="heading-8"><strong>补充：</strong></h5>
<p>尽管 PostgreSQL 在功能上更强大，但 MySQL 依然在特定场景下具有不可替代的优势，并被广泛使用。</p>
<h5 data-id="heading-9"><strong>MySQL 的五大核心优势：</strong></h5>





























<table><thead><tr><th>优势</th><th>说明</th></tr></thead><tbody><tr><td><strong>1. 极简部署与运维</strong></td><td>配置文件少，默认参数合理，适合快速上线。</td></tr><tr><td><strong>2. 读性能优异</strong></td><td>InnoDB 缓冲池 + 主从复制，轻松支撑高并发读（如首页、商品列表）。</td></tr><tr><td><strong>3. 成熟的 Web 生态</strong></td><td>WordPress、Laravel、Django（默认支持）、Drupal 等均原生适配 MySQL。</td></tr><tr><td><strong>4. 云厂商深度优化</strong></td><td>阿里云 RDS、AWS RDS、腾讯云 CDB 对 MySQL 的自动调优、备份、监控极为成熟。</td></tr><tr><td><strong>5. 社区资源丰富</strong></td><td>CSDN、Stack Overflow、知乎上问题多、答案全，新手友好。</td></tr></tbody></table>
<h3 data-id="heading-10"><strong>结语</strong></h3>
<p>PostgreSQL 与 MySQL 并非简单的谁更好，而是谁更适合。对于追求长期演进、复杂数据模型和强一致性的系统，PostgreSQL 是更坚实的基础；而对于快速上线、读多写少的 Web 应用，MySQL 依然是高效之选。而国产数据库的崛起，正是站在 PostgreSQL 的肩膀上，走出了一条自主创新之路。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Akamai Cloud客户案例 | IPPRA的简洁、经济、易用的云计算服务]]></title>    <link>https://juejin.cn/post/7584680708138418227</link>    <guid>https://juejin.cn/post/7584680708138418227</guid>    <pubDate>2025-12-17T11:16:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584680708138418227" data-draft-id="7584657447802601498" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Akamai Cloud客户案例 | IPPRA的简洁、经济、易用的云计算服务"/> <meta itemprop="keywords" content="人工智能,云计算"/> <meta itemprop="datePublished" content="2025-12-17T11:16:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AKAMAI"/> <meta itemprop="url" content="https://juejin.cn/user/829502942352628"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Akamai Cloud客户案例 | IPPRA的简洁、经济、易用的云计算服务
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/829502942352628/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AKAMAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T11:16:24.000Z" title="Wed Dec 17 2025 11:16:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>"我们必须快速获取数据，并具备在紧迫时间内管理此类项目所需的一切条件。这就是为什么让Linode（现属Akamai）协助我们变得如此重要。"</p>
<p>——俄克拉荷马大学IPPRA研究院副主任 Joe Ripberger 博士</p>
</blockquote>
<hr/>
<p>如您所在的企业也在考虑采购云服务或进行云迁移，</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.akamai.com%2Fzh%2Flp%2Fakamai-cloud-computing-freetrial%3Futm_campaign%3Df-mc-65893%26utm_id%3Dapj_cc%26utm_source%3Djuejin%26utm_medium%3Darticle_advertorial%26utm_content%3Djuejin_251217_blogarticles236" target="_blank" title="https://www.akamai.com/zh/lp/akamai-cloud-computing-freetrial?utm_campaign=f-mc-65893&amp;utm_id=apj_cc&amp;utm_source=juejin&amp;utm_medium=article_advertorial&amp;utm_content=juejin_251217_blogarticles236" ref="nofollow noopener noreferrer">点击链接</a>了解Akamai Linode解决方案，现在申请试用可得高达5000美元专属额度</p>
<hr/>
<p>要理解并应对社会风险，提升社区与社会的韧性，离不开海量数据和强大基础设施的支持。公共政策研究与分析研究院（IPPRA）便是最好的例证——作为全球顶尖的风险研究机构，该院致力于研究自然、科技及人为因素引发的风险，并开展相关教学与公众推广。IPPRA坐落于俄克拉荷马大学，汇聚政策、心理、传播、工程等跨领域专家，结合前沿建模技术，共同探索帮助社区增强风险应对能力的更优路径。</p>
<p>Joe Ripberger和Matthew Henderson是推动IPPRA使命的核心成员，他们的工作正让世界变得更安全。"我们研究各类风险，从能源安全、核武器等国家安全议题，到自然灾害等公共健康风险，"IPPRA研究院副主任Ripberger介绍道。</p>
<p>自该研究在俄克拉荷马大学启动以来，IPPRA的职责范围和应对的风险场景不断扩展。从最初专注于风险与危机管理，如今已发展成为跨学科研究机构，研究人员曾与美国国家科学基金会、国家海洋和大气管理局及能源部等全球关键科研组织合作。</p>
<p>研究院的部分工作包括与国家气象局合作设计调查问卷，分析人们如何接收、理解不同天气预警信息并采取防护行动。研究人员通过分析收集的数据，在地方和区域层面构建精准的危险天气系统社区预警机制。</p>
<p>另一项研究则关注新冠疫情中的公众认知与错误信息。2020年3月，IPPRA团队开始分析数百万条疫情相关社交媒体帖子，并与全国性调查数据交叉比对，通过数据集对比深入解析错误信息与个人疫情认知对行为决策的影响。</p>
<p>这些关键且及时的研究成果，既帮助政策制定者理解准确健康信息对行为的正向引导作用，也为其评估错误信息导致负面健康后果的行为影响提供了衡量依据。</p>
<p><strong><strong>简洁、经济、易用的云计算服务</strong></strong></p>
<p>面对如此规模的研究项目，IPPRA研究团队需要可靠的云基础设施合作伙伴来处理海量信息。正因如此，Ripberger、Henderson及其团队与Linode（现属Akamai）已保持逾十年合作。</p>
<p>借助灵活可扩展的数据存储架构和便捷的信息获取能力，IPPRA团队在持续收集数据的同时能够无缝呈现研究成果。这种能力使研究人员得以通过数据构建重要合作关系，并始终保持研究完整性。</p>
<p>"这正是Linode（现属Akamai）多年来对我们至关重要的原因之一，"研究院研究支持与整合副主任Henderson强调，"我们大量项目需要在线上线下灵活切换，必须确保快速响应能力。"</p>
<p>对于需在物理防火墙后运行的工作负载，IPPRA采用云基础设施与本地资源混合的部署模式。</p>
<p>Akamai（原Linode）以符合研究院预算规划的固定价格提供云计算服务，持续赋能IPPRA的前沿研究。Ripberger指出，在学术领域，成本预判往往直接决定项目能否立项："实现可靠的成本预估，赋予我们推进项目的充足信心。计算资源绝不能超支，因为我们根本无法承担赤字运营。"</p>
<p>随着IPPRA研究团队持续探索全球社区风险应对新路径，Henderson和Ripberger深信，与Akamai的合作将始终助力这个具有前瞻思维的团队保持这项宝贵研究的领先优势。</p>
<p><strong><strong>关于IPPRA</strong></strong></p>
<p>IPPRA团队通过融合公共政策学术研究与物理工程科学，致力于构建合作伙伴关系并开展前沿研究。其工作聚焦解决复杂公共政策问题，创造贯通自然、科技与社会系统的机遇，从而提升人类福祉，优化社会选择基础设施，增强社会韧性。</p>
<hr/>
<p>如您所在的企业也在考虑采购云服务或进行云迁移，</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.akamai.com%2Fzh%2Flp%2Fakamai-cloud-computing-freetrial%3Futm_campaign%3Df-mc-65893%26utm_id%3Dapj_cc%26utm_source%3Djuejin%26utm_medium%3Darticle_advertorial%26utm_content%3Djuejin_251217_blogarticles236_end" target="_blank" title="https://www.akamai.com/zh/lp/akamai-cloud-computing-freetrial?utm_campaign=f-mc-65893&amp;utm_id=apj_cc&amp;utm_source=juejin&amp;utm_medium=article_advertorial&amp;utm_content=juejin_251217_blogarticles236_end" ref="nofollow noopener noreferrer">点击链接</a>了解Akamai Linode解决方案，现在申请试用可得高达5000美元专属额度</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nop入门：增加DSL模型解析器]]></title>    <link>https://juejin.cn/post/7584653722593525812</link>    <guid>https://juejin.cn/post/7584653722593525812</guid>    <pubDate>2025-12-17T11:26:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584653722593525812" data-draft-id="7584472215976067087" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nop入门：增加DSL模型解析器"/> <meta itemprop="keywords" content="后端,架构,Spring Boot"/> <meta itemprop="datePublished" content="2025-12-17T11:26:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="canonical_entropy"/> <meta itemprop="url" content="https://juejin.cn/user/4212984289694429"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nop入门：增加DSL模型解析器
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984289694429/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    canonical_entropy
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T11:26:22.000Z" title="Wed Dec 17 2025 11:26:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Nop平台为开发自定义DSL（Domain Specific Language，领域特定语言）提供了一系列基础设施，核心机制是通过XDef元模型（Nop平台的元模型语言）定义XML格式的语法结构，然后自动根据XDef生成AST（Abstract Syntax Tree，抽象语法树）节点类，并实现解析器、
生成器、验证器等工具。具体介绍参见<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FgEvFblzpQghOfr9qzVRydA" target="_blank" title="https://mp.weixin.qq.com/s/gEvFblzpQghOfr9qzVRydA" ref="nofollow noopener noreferrer">XDef：一种面向演化的元模型及其构造哲学</a>。</p>
<p>虽然XDef元模型语言采用XML语法格式，但这并不意味着Nop平台中的DSL只能使用XML格式表达。实际上，根据<strong>可逆计算理论</strong>, 同一信息结构具有多种表达形式，这些表达形式之间可以自动进行可逆转换。</p>
<p>本文将介绍如何为DSL引入Markdown语法格式，并演示如何实现Markdown与XML/JSON之间的双向转换。</p>
<p>为了更好地理解如何扩展DSL加载器，我们首先需要了解Nop平台的核心模块结构：</p>
<h2 data-id="heading-0">1. nop-kernel核心模块</h2>
<p>Nop平台内置了丰富的模块，但用于支持DSL定义和实现的核心部分（也是可逆计算理论的实现核心）完全集中在<code>nop-kernel</code>目录下。该目录包含以下关键子模块：</p>
<ol>
<li><strong>nop-dependencies</strong>: 统一管理Nop平台使用的外部第三方依赖库版本</li>
<li><strong>nop-api-core</strong>: 提供各类注解以及<code>ApiRequest</code>/<code>ApiResponse</code>等框架级别的DTO定义</li>
<li><strong>nop-commons</strong>: 包含各种工具类（Utility Helpers）</li>
<li><strong>nop-core</strong>: 实现虚拟文件系统、XML/JSON等基础格式解析器和反射机制</li>
<li><strong>nop-javac</strong>: 对Java内置JavaC编译器的封装</li>
<li><strong>nop-dataset</strong>: 封装<code>IRecordInput</code>/<code>IDataSet</code>接口，统一处理各类列表数据和表格数据</li>
<li><strong>nop-xdefs</strong>: 集中存放Nop平台内置的所有XDef元模型</li>
<li><strong>nop-xlang</strong>: 实现Xpl模板语言、XScript脚本语言以及Delta合并算法</li>
<li><strong>nop-antlr4</strong>: 为XScript脚本语言提供antlr4扩展和封装支持</li>
<li><strong>nop-codegen</strong>: 提供<code>XCodeGenerator</code>代码生成器</li>
<li><strong>nop-record-mapping</strong>: 实现异构对象映射模型，用于辅助实现Markdown结构与一般模型对象之间的双向映射</li>
<li><strong>nop-markdown</strong>: 为Markdown格式的DSL解析提供额外封装，包含一个简易的Markdown解析器</li>
<li><strong>nop-kernel-cli</strong>: 演示用的命令行工具，提供<code>convert</code>（模型格式转换）和<code>gen</code>（模板驱动代码生成）两个指令</li>
</ol>
<ul>
<li>其中，<code>nop-kernel-cli</code>模块下的<code>demo</code>目录包含了DSL自定义解析器和自定义代码生成模板的示例</li>
</ul>
<p>了解了核心模块结构后，接下来我们将学习如何为DSL注册自定义加载器：</p>
<h2 data-id="heading-1">2. 注册加载器</h2>
<p>在Nop平台中，所有DSL文件格式都对应一个唯一的文件类型(fileType)。
全局模型加载器<code>ResourceComponentManager</code>在加载文件时会根据文件类型动态确定使用的加载器。</p>
<p>因此，为了给<code>orm.xml</code>这种文件定义DSL加载器，需要编写<code>/nop/core/registry/orm.register-model.xml</code></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">model</span> <span class="hljs-attr">x:schema</span>=<span class="hljs-string">"/nop/schema/register-model.xdef"</span> <span class="hljs-attr">xmlns:x</span>=<span class="hljs-string">"/nop/schema/xdsl.xdef"</span>
       <span class="hljs-attr">name</span>=<span class="hljs-string">"orm"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">loaders</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 为XML/JSON/YAML格式注册内置加载器 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">xdsl-loader</span> <span class="hljs-attr">fileType</span>=<span class="hljs-string">"orm.xml"</span> <span class="hljs-attr">schemaPath</span>=<span class="hljs-string">"/nop/schema/orm/orm.xdef"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">xdsl-loader</span> <span class="hljs-attr">fileType</span>=<span class="hljs-string">"orm.json"</span> <span class="hljs-attr">schemaPath</span>=<span class="hljs-string">"/nop/schema/orm/orm.xdef"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">xdsl-loader</span> <span class="hljs-attr">fileType</span>=<span class="hljs-string">"orm.yaml"</span> <span class="hljs-attr">schemaPath</span>=<span class="hljs-string">"/nop/schema/orm/orm.xdef"</span>/&gt;</span>

    <span class="hljs-comment">&lt;!-- 为Markdown格式注册自定义加载器 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">loader</span> <span class="hljs-attr">fileType</span>=<span class="hljs-string">"orm.md"</span> <span class="hljs-attr">mappingName</span>=<span class="hljs-string">"orm.Md_to_OrmModel"</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"io.nop.record_mapping.md.MarkdownDslResourceLoaderFactory"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">loaders</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">model</span>&gt;</span>
</code></pre>
<p>上述配置文件定义了ORM模型的加载器注册信息：</p>
<ul>
<li><code>xdsl-loader</code>：用于配置XML/JSON/YAML格式的模型加载器。Nop平台内置了<code>DslJsonResourceLoader</code>和<code>DslXmlResourceLoader</code>，它们会根据文件类型自动选择合适的解析器。</li>
<li><code>loader</code>：用于定义扩展加载器，可支持自定义文件格式。
<ul>
<li><code>fileType</code>：指定文件类型标识符</li>
<li><code>mappingName</code>：指定用于解析的映射规则名称</li>
<li><code>class</code>：指定加载器工厂类的实现路径，需实现<code>IResourceObjectLoaderFactory</code>或<code>IResourceObjectLoader</code>接口</li>
</ul>
</li>
</ul>
<p>以下是相关接口的定义：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 资源对象加载器工厂接口</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">IResourceObjectLoaderFactory</span>&lt;T&gt; {
    IResourceObjectLoader&lt;T&gt; <span class="hljs-title function_">newResourceObjectLoader</span><span class="hljs-params">(ComponentModelConfig config, Map&lt;String, Object&gt; attributes)</span>;
}

<span class="hljs-comment">// 资源对象加载器接口</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">IResourceObjectLoader</span>&lt;T&gt; {
  T <span class="hljs-title function_">loadObjectFromResource</span><span class="hljs-params">(IResource resource)</span>;
}

<span class="hljs-comment">// 资源对象保存器接口</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">IResourceObjectSaver</span>&lt;T&gt; {
  <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveObjectToResource</span><span class="hljs-params">(IResource resource, T obj)</span>;
}
</code></pre>
<p>MarkdownDslResourceLoaderFactory返回的MarkdownDslResourceLoader实现了如下四个接口</p>
<ul>
<li><code>IResourceObjectLoader</code>: 解析资源文件得到模型对象</li>
<li><code>IResourceObjectSaver</code>: 将模型对象保存到资源文件中</li>
<li><code>IResourceDslNodeLoader</code>: 解析资源文件得到XNode（Nop平台中通用的DSL抽象语法树节点，用于统一表示不同格式的DSL结构）</li>
<li><code>IResourceDslNodeSaver</code>: 将XNode保存到资源文件中</li>
</ul>
<p>除了<code>IResourceObjectLoader</code>接口之外，其他三个接口都是可选的。实现这些接口后，就可以支持双向转换功能。</p>
<p>注册完加载器后，我们需要定义Markdown与模型对象之间的映射规则。这正是<code>RecordMapping</code>机制的用武之地：</p>
<h2 data-id="heading-2">3. 基于Mapping模型的Markdown解析和生成</h2>
<p><code>RecordMapping</code>是Nop平台内置的对象映射机制，用于定义两个异构Java对象之间的相互映射规则，支持字段映射、类型转换、表达式计算等功能。
在RecordMapping格式的基础上补充<code>md:format</code>等扩展字段信息，就可以实现MarkdownSection对象与DSL模型对象之间的映射。</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">definitions</span> <span class="hljs-attr">xmlns:x</span>=<span class="hljs-string">"/nop/schema/xdsl.xdef"</span> <span class="hljs-attr">x:schema</span>=<span class="hljs-string">"/nop/schema/record/record-mappings.xdef"</span>
             <span class="hljs-attr">xmlns:md</span>=<span class="hljs-string">"md"</span> <span class="hljs-attr">x:dump</span>=<span class="hljs-string">"true"</span>&gt;</span>


  <span class="hljs-comment">&lt;!-- 定义从Markdown到ORM模型的映射规则 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Md_to_OrmModel"</span> <span class="hljs-attr">md:titleField</span>=<span class="hljs-string">"displayName"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">fields</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- 直接映射displayName字段 --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"displayName"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"displayName"</span>/&gt;</span>

      <span class="hljs-comment">&lt;!-- 映射extends字段，并指定别名 --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"x:extends"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"extends"</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"Extends"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">schema</span> <span class="hljs-attr">stdDomain</span>=<span class="hljs-string">"string"</span>/&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">field</span>&gt;</span>

      <span class="hljs-comment">&lt;!-- 映射实体定义，使用Md_to_EntityModel作为子项映射规则 --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"entities"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"实体定义"</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"Entities"</span> <span class="hljs-attr">keyProp</span>=<span class="hljs-string">"name"</span>
             <span class="hljs-attr">itemMapping</span>=<span class="hljs-string">"Md_to_EntityModel"</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">field</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">fields</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">mapping</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- 定义从Markdown到实体模型的映射规则 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Md_to_EntityModel"</span> <span class="hljs-attr">md:titleField</span>=<span class="hljs-string">"name"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">fields</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- 映射对象名，使用表达式生成完整类名 --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"对象名"</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"Object Name"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">schema</span> <span class="hljs-attr">stdDomain</span>=<span class="hljs-string">"class-name"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">valueExpr</span>&gt;</span>
          value?.$fullClassName(rootRecord['ext:entityPackageName'])
        <span class="hljs-tag">&lt;/<span class="hljs-name">valueExpr</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">field</span>&gt;</span>

      <span class="hljs-comment">&lt;!-- 映射表名，设置为必填字段 --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"tableName"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"表名"</span> <span class="hljs-attr">mandatory</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"Table Name"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">schema</span> <span class="hljs-attr">stdDomain</span>=<span class="hljs-string">"prop-name"</span>/&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">field</span>&gt;</span>

      <span class="hljs-comment">&lt;!-- 映射中文名，设置为必填字段 --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"displayName"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"中文名"</span> <span class="hljs-attr">mandatory</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"Chinese Name"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">schema</span> <span class="hljs-attr">stdDomain</span>=<span class="hljs-string">"string"</span>/&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">field</span>&gt;</span>

      <span class="hljs-comment">&lt;!-- 映射字段列表，指定为表格格式 --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"columns"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"字段列表"</span> <span class="hljs-attr">keyProp</span>=<span class="hljs-string">"name"</span>
             <span class="hljs-attr">alias</span>=<span class="hljs-string">"Column List"</span> <span class="hljs-attr">itemMapping</span>=<span class="hljs-string">"Md_to_ColumnModel"</span> <span class="hljs-attr">md:format</span>=<span class="hljs-string">"table"</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">field</span>&gt;</span>

      <span class="hljs-comment">&lt;!-- 映射关联列表，指定为表格格式 --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"relations"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"关联列表"</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"Relation List"</span>
             <span class="hljs-attr">itemMapping</span>=<span class="hljs-string">"Md_to_RelationModel"</span> <span class="hljs-attr">md:format</span>=<span class="hljs-string">"table"</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">field</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-name">fields</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">mapping</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">definitions</span>&gt;</span>
</code></pre>
<p>Nop平台通过<code>MappingBasedMarkdownParser</code>和<code>MappingBasedMarkdownGenerator</code>根据Mapping模型配置实现解析与生成功能：</p>
<ul>
<li><code>md:titleField</code>: 用于指定标题对应的解析字段</li>
<li><code>md:format</code>: 指定字段对应的Markdown格式，目前支持<code>table|code</code>，分别对应表格格式和代码块格式</li>
</ul>
<p>我们约定了简单的Markdown编码规则：</p>
<ol>
<li>每个section只能是List/Table/CodeBlock等几种格式</li>
<li>通过子section实现复杂对象，标题对应属性名</li>
<li>若section对应于List，则每个子section对应一个对象，此时section的标题对应对象的titleField</li>
</ol>
<p>以下是一个完整的Markdown格式ORM模型示例：</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># AI模型管理</span>

<span class="hljs-bullet">-</span> extends:  demo.orm.md

<span class="hljs-section">## gen-extends</span>
<span class="hljs-code">```xml
&lt;orm-gen:DefaultPostExtends xpl:lib="/xlib/orm-gen.xlib"/&gt;
```</span>

<span class="hljs-section">## 5 实体定义</span>

<span class="hljs-section">### 5.1 NopAiProject</span>

<span class="hljs-bullet">-</span> 表名: nop<span class="hljs-emphasis">_ai_</span>project
<span class="hljs-bullet">-</span> 类名: NopAiProject
<span class="hljs-bullet">-</span> 中文名: AI项目
<span class="hljs-bullet">-</span> 备注: 存储AI项目基本信息

<span class="hljs-section">#### 5.1.1 字段列表</span>

|编号|标签|主键|非空|字段名|属性名|显示|中文名|英文名|数据域|标准域|类型|长度|小数位数|字典|备注|缺省值|控件|根节点级别|
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | seq | true | true | id | id | X | 主键 |  |  |  | VARCHAR | 36 |  |  |  |  |  |  |
| 2 |  | false | true | language | language |  | 项目语言 |  |  |  | VARCHAR | 4 |  | ai/project<span class="hljs-emphasis">_language | 项目使用的编程语言类型：JAVA, PYTHON等 |  |  |  |
| 3 |  | false | true | name | name |  | 项目名称 |  |  |  | VARCHAR | 100 |  |  |  |  |  |  |
| 4 |  | false | false | prototype_</span>id | prototypeId |  | 模板项目ID |  |  |  | VARCHAR | 36 |  |  |  |  |  |  |
| 5 |  | false | false | project<span class="hljs-emphasis">_dir | projectDir |  | 项目目录 |  |  |  | VARCHAR | 400 |  |  | 项目在文件系统中的存储路径，例如：/data/projects/order-system |  | textarea |  |

</span></code></pre>
<p>上述Markdown文件解析后得到的XML格式如下：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">orm</span> <span class="hljs-attr">ext:mavenArtifactId</span>=<span class="hljs-string">"nop-ai"</span> <span class="hljs-attr">ext:entityPackageName</span>=<span class="hljs-string">"io.nop.ai.dao.entity"</span> <span class="hljs-attr">ext:allowIdAsColName</span>=<span class="hljs-string">"true"</span>
     <span class="hljs-attr">ext:basePackageName</span>=<span class="hljs-string">"io.nop.ai"</span> <span class="hljs-attr">ext:appName</span>=<span class="hljs-string">"nop-ai"</span> <span class="hljs-attr">ext:registerShortName</span>=<span class="hljs-string">"true"</span>
     <span class="hljs-attr">ext:mavenGroupId</span>=<span class="hljs-string">"io.github.entropy-cloud"</span> <span class="hljs-attr">x:schema</span>=<span class="hljs-string">"/nop/schema/orm/orm.xdef"</span> <span class="hljs-attr">xmlns:x</span>=<span class="hljs-string">"/nop/schema/xdsl.xdef"</span>
     <span class="hljs-attr">xmlns:ext</span>=<span class="hljs-string">"ext"</span> <span class="hljs-attr">displayName</span>=<span class="hljs-string">"AI模型管理"</span>
     <span class="hljs-attr">xmlns:ui</span>=<span class="hljs-string">"ui"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">entities</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">entity</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"io.nop.ai.dao.entity.NopAiProject"</span> <span class="hljs-attr">displayName</span>=<span class="hljs-string">"AI项目"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"io.nop.ai.dao.entity.NopAiProject"</span>
            <span class="hljs-attr">registerShortName</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">tableName</span>=<span class="hljs-string">"nop_ai_project"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">columns</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">column</span> <span class="hljs-attr">code</span>=<span class="hljs-string">"id"</span> <span class="hljs-attr">displayName</span>=<span class="hljs-string">"主键"</span> <span class="hljs-attr">mandatory</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"id"</span> <span class="hljs-attr">precision</span>=<span class="hljs-string">"36"</span> <span class="hljs-attr">primary</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">propId</span>=<span class="hljs-string">"1"</span>
                <span class="hljs-attr">stdDataType</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">stdSqlType</span>=<span class="hljs-string">"VARCHAR"</span> <span class="hljs-attr">tagSet</span>=<span class="hljs-string">"seq"</span> <span class="hljs-attr">ui:show</span>=<span class="hljs-string">"X"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">column</span> <span class="hljs-attr">code</span>=<span class="hljs-string">"language"</span> <span class="hljs-attr">comment</span>=<span class="hljs-string">"项目使用的编程语言类型：JAVA, PYTHON等"</span> <span class="hljs-attr">displayName</span>=<span class="hljs-string">"项目语言"</span>
                <span class="hljs-attr">mandatory</span>=<span class="hljs-string">"true"</span>
                <span class="hljs-attr">name</span>=<span class="hljs-string">"language"</span> <span class="hljs-attr">precision</span>=<span class="hljs-string">"4"</span> <span class="hljs-attr">propId</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">stdDataType</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">stdSqlType</span>=<span class="hljs-string">"VARCHAR"</span>
                <span class="hljs-attr">ext:dict</span>=<span class="hljs-string">"ai/project_language"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">column</span> <span class="hljs-attr">code</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">displayName</span>=<span class="hljs-string">"项目名称"</span> <span class="hljs-attr">mandatory</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">precision</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">propId</span>=<span class="hljs-string">"3"</span>
                <span class="hljs-attr">stdDataType</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">stdSqlType</span>=<span class="hljs-string">"VARCHAR"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">column</span> <span class="hljs-attr">code</span>=<span class="hljs-string">"prototype_id"</span> <span class="hljs-attr">displayName</span>=<span class="hljs-string">"模板项目ID"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"prototypeId"</span> <span class="hljs-attr">precision</span>=<span class="hljs-string">"36"</span> <span class="hljs-attr">propId</span>=<span class="hljs-string">"4"</span>
                <span class="hljs-attr">stdDataType</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">stdSqlType</span>=<span class="hljs-string">"VARCHAR"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">column</span> <span class="hljs-attr">code</span>=<span class="hljs-string">"project_dir"</span> <span class="hljs-attr">comment</span>=<span class="hljs-string">"项目在文件系统中的存储路径，例如：/data/projects/order-system"</span>
                <span class="hljs-attr">displayName</span>=<span class="hljs-string">"项目目录"</span>
                <span class="hljs-attr">name</span>=<span class="hljs-string">"projectDir"</span> <span class="hljs-attr">precision</span>=<span class="hljs-string">"400"</span> <span class="hljs-attr">propId</span>=<span class="hljs-string">"5"</span> <span class="hljs-attr">stdDataType</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">stdSqlType</span>=<span class="hljs-string">"VARCHAR"</span>
                <span class="hljs-attr">ui:control</span>=<span class="hljs-string">"textarea"</span>/&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">columns</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">comment</span>&gt;</span>存储AI项目基本信息<span class="hljs-tag">&lt;/<span class="hljs-name">comment</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">entity</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">entities</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">orm</span>&gt;</span>
</code></pre>
<p>可以看到，Markdown中定义的字段列表（表格格式）被正确转换为XML中的<code>&lt;columns&gt;</code>节点，包括字段名称、数据类型、约束条件等信息都被准确映射。</p>
<p>完成了加载器注册和映射规则定义后，我们就可以使用<code>nop-kernel-cli</code>工具进行实际的模型转换和代码生成操作了：</p>
<h2 data-id="heading-3">4. 通过元编程自动生成反向映射</h2>
<p>Nop平台提供了强大的元编程能力，可以根据已定义的正向映射自动生成反向映射配置。例如，当我们定义了从Markdown到ORM模型的映射<code>Md_to_OrmModel</code>后，系统可以自动生成从ORM模型到Markdown的反向映射<code>OrmModel_to_Md</code>。</p>
<h3 data-id="heading-4">4.1 自动生成反向映射的配置</h3>
<p>通过在RecordMapping配置中添加<code>record-mapping-gen:GenReverseMappings</code>扩展，系统会自动为所有正向映射生成对应的反向映射：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">definitions</span> <span class="hljs-attr">xmlns:x</span>=<span class="hljs-string">"/nop/schema/xdsl.xdef"</span> <span class="hljs-attr">x:schema</span>=<span class="hljs-string">"/nop/schema/record/record-mappings.xdef"</span>
             <span class="hljs-attr">xmlns:md</span>=<span class="hljs-string">"md"</span> <span class="hljs-attr">x:dump</span>=<span class="hljs-string">"true"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">x:post-extends</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">c:import</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"/nop/record/xlib/record-mapping-gen.xlib"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">record-mapping-gen:GenReverseMappings</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">x:post-extends</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 正向映射配置 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Md_to_OrmModel"</span> <span class="hljs-attr">...</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 正向映射规则 --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">mapping</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 系统会自动生成OrmModel_to_Md反向映射 --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">definitions</span>&gt;</span>
</code></pre>
<p>执行后，系统会自动生成名为<code>OrmModel_to_Md</code>的反向映射，其字段映射关系与<code>Md_to_OrmModel</code>相反，确保数据可以在两种格式之间无损转换。</p>
<h3 data-id="heading-5">4.2 差量修正反向映射配置</h3>
<p>自动生成的反向映射可能无法完全满足所有需求，这时可以在当前文件中添加差量修正部分来微调配置。根据可逆计算理论，差量定义与全量定义格式完全一致。</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">definitions</span> <span class="hljs-attr">xmlns:x</span>=<span class="hljs-string">"/nop/schema/xdsl.xdef"</span> <span class="hljs-attr">x:schema</span>=<span class="hljs-string">"/nop/schema/record/record-mappings.xdef"</span>
             <span class="hljs-attr">xmlns:md</span>=<span class="hljs-string">"md"</span> <span class="hljs-attr">x:dump</span>=<span class="hljs-string">"true"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">x:post-extends</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">c:import</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"/nop/record/xlib/record-mapping-gen.xlib"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">record-mapping-gen:GenReverseMappings</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">x:post-extends</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 正向映射配置 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Md_to_OrmModel"</span> <span class="hljs-attr">...</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 正向映射规则 --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">mapping</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"EntityModel_to_Md"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">fields</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"对象名"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">valueExpr</span>&gt;</span>
                    value?.$removePackageName(sourceRoot['ext:entityPackageName']);
                <span class="hljs-tag">&lt;/<span class="hljs-name">valueExpr</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">field</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"类名"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">valueExpr</span>&gt;</span>
                    value?.$removePackageName(sourceRoot['ext:entityPackageName']);
                <span class="hljs-tag">&lt;/<span class="hljs-name">valueExpr</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">field</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">fields</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">definitions</span>&gt;</span>
</code></pre>
<h2 data-id="heading-6">5. 使用nop-kernel-cli执行模型转换和代码生成</h2>
<p>完成DSL加载器配置后，可以使用<code>nop-kernel-cli</code>工具执行模型格式转换和代码生成操作。以下是常用命令示例：</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">将XML格式的ORM模型转换为Markdown格式</span>
java -jar nop-kernel-cli.jar convert demo.orm.xml -o=demo.orm.md
<span class="hljs-meta prompt_">
# </span><span class="bash">将Markdown格式的ORM模型转换回XML格式</span>
java -jar nop-kernel-cli.jar convert demo.orm.md -o=demo.orm.xml
<span class="hljs-meta prompt_">
# </span><span class="bash">基于Markdown格式的ORM模型生成代码</span>
java -jar nop-kernel-cli.jar gen demo.orm.md -t=/nop/templates/orm -o=target
</code></pre>
<p>通过上述命令，我们可以实现不同格式DSL模型之间的双向转换，以及基于这些模型的代码生成，充分体现了Nop平台的灵活性和可逆计算理论的实践价值。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Netty（15）Netty的线程模型是什么？它有哪些线程池类型？]]></title>    <link>https://juejin.cn/post/7584633505105690676</link>    <guid>https://juejin.cn/post/7584633505105690676</guid>    <pubDate>2025-12-17T11:55:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584633505105690676" data-draft-id="7584653722593558580" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Netty（15）Netty的线程模型是什么？它有哪些线程池类型？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-17T11:55:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Netty（15）Netty的线程模型是什么？它有哪些线程池类型？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T11:55:55.000Z" title="Wed Dec 17 2025 11:55:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Netty的线程模型是基于事件循环的，它使用了一种称为"Reactor"模式的设计模式。在Netty中，所有的I/O操作都是异步的，通过事件驱动的方式进行处理。</p>
<p>Netty的线程模型主要由两个部分组成：EventLoopGroup和EventLoop。</p>
<ol>
<li>
<p>EventLoopGroup：
EventLoopGroup是一个线程池，负责管理一组EventLoop。它可以有多个EventLoop，并且可以选择使用不同的线程池类型。EventLoopGroup通常用于处理连接的接受和建立，并将连接分配给EventLoop进行处理。</p>
</li>
<li>
<p>EventLoop：
EventLoop是一个单独的线程，负责处理事件和执行任务。每个EventLoop都绑定到一个特定的线程，并且只能在绑定的线程上执行任务。EventLoop通过事件循环（Event Loop）来处理事件，包括接收数据、处理数据、发送数据和定时任务等。</p>
</li>
</ol>
<p>Netty提供了不同类型的线程池，可以根据实际需求选择合适的线程池类型。以下是一些常见的线程池类型：</p>
<ol>
<li>NioEventLoopGroup：基于Java NIO的线程池，适用于TCP和UDP传输。</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();
</code></pre>
<ol start="2">
<li>OioEventLoopGroup：基于Java IO的线程池，适用于阻塞I/O。</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OioEventLoopGroup</span>();
</code></pre>
<ol start="3">
<li>EpollEventLoopGroup：基于Linux epoll的线程池，适用于高性能的TCP传输。</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EpollEventLoopGroup</span>();
</code></pre>
<ol start="4">
<li>KQueueEventLoopGroup：基于BSD kqueue的线程池，适用于高性能的TCP传输。</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">KQueueEventLoopGroup</span>();
</code></pre>
<p>通过选择合适的线程池类型，可以充分利用底层操作系统的特性和优化，提高Netty应用程序的性能和可扩展性。</p>
<p>以下是一个使用NioEventLoopGroup的示例代码：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();

<span class="hljs-keyword">try</span> {
    <span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();
    b.group(group)
            .channel(NioServerSocketChannel.class)
            .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyChannelInitializer</span>())
            .option(ChannelOption.SO_BACKLOG, <span class="hljs-number">128</span>)
            .childOption(ChannelOption.SO_KEEPALIVE, <span class="hljs-literal">true</span>);

    <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> b.bind(port).sync();
    f.channel().closeFuture().sync();
} <span class="hljs-keyword">finally</span> {
    group.shutdownGracefully();
}
</code></pre>
<p>在上面的示例中，我们创建了一个NioEventLoopGroup，并将其作为参数传递给ServerBootstrap。通过调用bind()方法来绑定端口，并最终调用closeFuture()方法来关闭服务器。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Netty（16）Netty的零拷贝机制是什么？它如何提高性能？]]></title>    <link>https://juejin.cn/post/7584633505105707060</link>    <guid>https://juejin.cn/post/7584633505105707060</guid>    <pubDate>2025-12-17T11:57:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584633505105707060" data-draft-id="7584653722593574964" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Netty（16）Netty的零拷贝机制是什么？它如何提高性能？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2025-12-17T11:57:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Netty（16）Netty的零拷贝机制是什么？它如何提高性能？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T11:57:25.000Z" title="Wed Dec 17 2025 11:57:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Netty的零拷贝（Zero-copy）机制是一种优化技术，用于在数据传输过程中减少数据拷贝的次数，从而提高性能和降低CPU开销。</p>
<p>传统的I/O操作中，数据通常需要从内核空间（Kernel Space）拷贝到用户空间（User Space），然后再进行处理或发送。这个过程涉及了多次数据拷贝，会增加CPU的负载和内存带宽的消耗。</p>
<p>Netty的零拷贝机制通过使用操作系统提供的特性来避免数据拷贝，从而提高性能。具体来说，Netty使用了以下两种技术来实现零拷贝：</p>
<ol>
<li>零拷贝文件传输：
Netty通过FileRegion接口，实现了零拷贝的文件传输。当需要将文件从一个地方传输到另一个地方时，Netty可以直接将文件描述符传递给操作系统，而不需要将文件的内容拷贝到用户空间。这样可以避免数据在内核空间和用户空间之间的多次拷贝。</li>
</ol>
<p>以下是一个示例代码，演示了如何使用零拷贝实现文件传输：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"path/to/file"</span>);
<span class="hljs-type">RandomAccessFile</span> <span class="hljs-variable">raf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RandomAccessFile</span>(file, <span class="hljs-string">"r"</span>);

<span class="hljs-type">FileChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> raf.getChannel();
<span class="hljs-type">long</span> <span class="hljs-variable">position</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-type">long</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> file.length();

ctx.write(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultFileRegion</span>(channel, position, count));
</code></pre>
<p>在上面的示例中，我们创建了一个FileRegion对象，并将其写入到Channel中进行传输。通过使用DefaultFileRegion，Netty可以直接传递文件描述符给操作系统，而不需要进行数据拷贝。</p>
<ol start="2">
<li>零拷贝内存传输：
Netty通过使用Direct Memory（直接内存）来实现零拷贝的内存传输。直接内存是一种在堆外分配的内存，可以直接与操作系统进行交互。在Netty中，通过使用ByteBuf的零拷贝特性，可以在内存之间直接传输数据，而不需要进行额外的拷贝操作。</li>
</ol>
<p>以下是一个示例代码，演示了如何使用零拷贝实现内存传输：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ByteBuf</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> Unpooled.directBuffer();
buffer.writeBytes(<span class="hljs-string">"Hello, Netty!"</span>.getBytes());

ctx.write(buffer);
</code></pre>
<p>在上面的示例中，我们创建了一个Direct Buffer（直接缓冲区），并将数据写入到其中。通过使用Direct Buffer，Netty可以直接将数据传递给操作系统，而不需要进行数据拷贝。</p>
<p>通过使用零拷贝机制，Netty可以减少数据拷贝的次数，降低CPU的负载和内存带宽的消耗，从而提高性能和吞吐量。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SIGGRAPH Asia 2025：摩尔线程赢图形顶会3DGS挑战赛大奖，自研LiteGS全面开源]]></title>    <link>https://juejin.cn/post/7584680708138238003</link>    <guid>https://juejin.cn/post/7584680708138238003</guid>    <pubDate>2025-12-17T10:13:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584680708138238003" data-draft-id="7584657447802322970" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SIGGRAPH Asia 2025：摩尔线程赢图形顶会3DGS挑战赛大奖，自研LiteGS全面开源"/> <meta itemprop="keywords" content="人工智能,OpenAI"/> <meta itemprop="datePublished" content="2025-12-17T10:13:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="机器之心"/> <meta itemprop="url" content="https://juejin.cn/user/1873223543167902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SIGGRAPH Asia 2025：摩尔线程赢图形顶会3DGS挑战赛大奖，自研LiteGS全面开源
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1873223543167902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    机器之心
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:13:02.000Z" title="Wed Dec 17 2025 10:13:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>12 月 17 日，在香港举办的全球图形学领域备受瞩目的顶级学术盛会 SIGGRAPH Asia 2025 上，摩尔线程在 3D Gaussian Splatting Reconstruction Challenge（3DGS 重建挑战赛）中凭借自研技术 LiteGS 出色的算法实力和软硬件协同优化能力，斩获大赛银奖，再次证明摩尔线程在新一代图形渲染技术上的深度积累与学术界的高度认可。 <br/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/552761f19ba8419ea2beff725acdc12d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571181&amp;x-signature=pM4u98HZlG9SL7%2FzNTPJk5H45NI%3D" alt="图片" loading="lazy"/></p>
<p>3DGS：下一代图形渲染的范式革命</p>
<p>开启 AI 加速的高效渲染时代</p>
<p>3D Gaussian Splatting（3DGS，三维高斯溅射）是 2023 年提出的一项革命性 3D 场景表示与渲染技术，以可参数化的 3D 高斯分布为核心，实现了画质、效率与资源占用之间的卓越平衡。与传统 NeRF 相比，3DGS 在保持逼真渲染质量的前提下，将渲染效率提升数百至上千倍，并在光线追踪、VR/AR 实时渲染、多模态融合等方向展现出极强的适应性与扩展性。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4eeed73d7754990ac9f6e0aaefb87d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571181&amp;x-signature=2OaB681wVkDQ3OvHibY6R28HILo%3D" alt="图片" loading="lazy"/></p>
<p>（* 上图仅作示意）</p>
<p>作为近年来快速发展的神经渲染技术，3DGS 不仅在三维重建与实时渲染等方向展现出卓越优势，也在更广泛的 AI 场景中具备潜在的基础价值。尤其是在具身智能（Embodied AI）等需要智能体理解并与真实环境交互的前沿领域，高质量、低延迟的三维环境建模至关重要。3DGS 以其高保真场景显示、快速优化能力和轻量级结构，为构建准确的世界模型提供了可靠支撑，有助于提升路径规划、环境感知和复杂操作任务的能力。随着 AI 技术向 “理解并操作真实世界” 方向不断延展，3DGS 正逐渐成为具身智能训练场景中的关键基础技术之一。</p>
<p>正因其对未来图形学技术路线的关键意义，3DGS 已成为全球学术界与产业界竞相投入的研究方向，受到 SIGGRAPH Asia 等权威机构的高度关注。</p>
<p>极致挑战：60 秒高质量重建</p>
<p>推动 3DGS 技术走向实用化临界点</p>
<p>本次竞赛为参赛团队设置了极具挑战性的任务：参赛者需在 60 秒内，基于主办方提供的真实终端视频序列（10–30 秒）、存在误差的相机轨迹以及终端 SLAM 点云，在极短时间内完成完整的 3DGS 高质量重建。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c87bd05ae60410fb50149c244a46757~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571181&amp;x-signature=Co0Jp%2FpxKOR9ok4R7hBofNFz7xQ%3D" alt="图片" loading="lazy"/></p>
<p>主办方以 PSNR（重建质量）与重建速度为综合评价指标，力求在完全公开、公正的条件下得出权威排名。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eedccefa71ee427f9abc0630b033e777~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571181&amp;x-signature=5j3TzDmRvXcUkirjJX2Cfz1M3SA%3D" alt="图片" loading="lazy"/></p>
<p>目前 3D Gaussian Splatting Reconstruction Challenge（3DGS 重建挑战赛）的结果及数据集已向全球公开，相关资料可在 SIGGRAPH Asia 官方网站获取。</p>
<p>地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgaplab.cuhk.edu.cn%2Fprojects%2FgsRaceSIGA2025%2F" target="_blank" title="https://gaplab.cuhk.edu.cn/projects/gsRaceSIGA2025/" ref="nofollow noopener noreferrer">gaplab.cuhk.edu.cn/projects/gs…</a></p>
<p>摩尔线程的技术答卷</p>
<p>以全栈能力实现精度与速度的极致平衡</p>
<p>摩尔线程 AI 团队以参赛编号 “MT-AI” 进入决赛阶段，在重建精度与效率两项指标上取得均衡且亮眼的表现：</p>
<ul>
<li>
<p>平均 PSNR：27.58（位列前三）</p>
</li>
<li>
<p>重建耗时：34 秒（显著领先多数队伍）</p>
</li>
</ul>
<p>凭借行业领先的 3DGS 算法构建能力与软硬件协同优化优势，摩尔线程最终获得二等奖（银牌）的优秀成绩。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14c21f2c651c4cb2a502b5c1e9f9fdfa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571181&amp;x-signature=TvuSIf9svVQczJwsj24Ydswa7OU%3D" alt="图片" loading="lazy"/></p>
<p>开放协作</p>
<p>摩尔线程开源 3DGS 基础库 LiteGS</p>
<p>作为一种新兴的场景表示与新视角合成技术，3DGS 凭借高渲染质量与实时渲染速度，在计算机图形学与视觉领域实现了显著突破。该技术通过数以百万计的各向异性三维高斯基元来表示三维场景，以实现逼真的渲染效果，并在自动驾驶、虚拟现实、数字孪生等领域展现出巨大潜力。然而，尽管 3DGS 的渲染速度极快，其训练过程却往往需要数十分钟甚至数小时，成为制约其广泛应用的主要瓶颈。现有优化方案往往仅从单一层面入手，难以系统性地解决训练过程中的性能制约。</p>
<p>为此，摩尔线程自主研发了 3DGS 基础库 LiteGS，首次实现了从底层 GPU 系统、中层数据管理到高层算法设计的全链路协同优化：</p>
<ul>
<li>
<p>在 GPU 系统层面，摩尔线程创新提出基于 “One Warp Per Tile” 原则的 “Warp-Based Raster” 新范式，将梯度聚合简化为一次 Warp 内归约，并结合扫描线算法与混合精度策略，大幅降低梯度计算开销，同时实现高效的像素级统计能力；</p>
</li>
<li>
<p>在数据管理层，引入 “聚类-剔除-压缩” 流水线，借助 Morton 编码以极低开销对高斯基元进行动态空间重排，显著提升数据局部性，减少缓存失效与 Warp 分支；</p>
</li>
<li>
<p>在算法设计层，摒弃原有模糊的度量指标，采用更为鲁棒的像素不透明度梯度方差作为致密化的核心判据，精准识别欠拟合区域，其轻量化计算直接受益于底层光栅化器的高效统计支持。</p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c35476dc45384f6d9226d698423f5856~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571181&amp;x-signature=hLqvscMt4e5iWsb5sOIKKqAc0%2Bg%3D" alt="图片" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e750b1047f04fb793352e5629ec9049~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571181&amp;x-signature=ze1820j4peW2QXedZq1nQFvmmpQ%3D" alt="图片" loading="lazy"/></p>
<p>通过系统与算法的协同优化，LiteGS 在训练效率与重建质量上均实现显著领先，树立了该领域新的性能标杆。</p>
<ul>
<li>
<p>在达到与当前质量最优方案同等水平时，LiteGS 可获得高达 10.8 倍的训练加速，且参数量减少一半以上。</p>
</li>
<li>
<p>在相同参数量下，LiteGS 在 PSNR 指标上超出主流方案 0.2–0.4 dB，训练时间缩短 3.8 至 7 倍。</p>
</li>
<li>
<p>针对轻量化模型，LiteGS 仅需原版 3DGS 约 10% 的训练时间与 20% 的参数量，即可实现同等质量，展现出卓越的工程实用性与技术前瞻性。</p>
</li>
</ul>
<p>目前，LiteGS 已在 GitHub 平台全面开源，以推动三维重建与渲染技术的开放协作与持续演进。</p>
<p>开源地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMooreThreads%2FLiteGS" target="_blank" title="https://github.com/MooreThreads/LiteGS" ref="nofollow noopener noreferrer">github.com/MooreThread…</a></p>
<p>摩尔线程此次在国际图形学顶会赛事上的获奖，不止是一次竞赛胜利，更是准确把握全球技术发展趋势并引领未来图形计算技术方向的战略体现。作为图形学领域未来发展的重要方向，3DGS 技术对算法与硬件协同提出了极高要求。摩尔线程通过创新的算法设计、深度优化的自研硬件以及高效的软硬件协同，在本次赛事中展现了卓越的综合能力。这一成就，印证了摩尔线程在图形智能计算领域技术路径的前瞻性与工程可行性，并体现了公司将前沿研究快速转化为实践成果的强大执行力。</p>
<p>2025 年 12 月 20 日 - 21 日，摩尔线程将于首届 MUSA 开发者大会设立技术专题，深入探讨 3DGS 等图形智能技术如何塑造未来，赋能具身智能等前沿领域，诚邀您共同关注与探讨。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenAI推出全新ChatGPT Images，奥特曼亮出腹肌搞宣传]]></title>    <link>https://juejin.cn/post/7584742635484069898</link>    <guid>https://juejin.cn/post/7584742635484069898</guid>    <pubDate>2025-12-17T10:11:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584742635484069898" data-draft-id="7584742635484037130" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenAI推出全新ChatGPT Images，奥特曼亮出腹肌搞宣传"/> <meta itemprop="keywords" content="人工智能,OpenAI"/> <meta itemprop="datePublished" content="2025-12-17T10:11:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="机器之心"/> <meta itemprop="url" content="https://juejin.cn/user/1873223543167902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenAI推出全新ChatGPT Images，奥特曼亮出腹肌搞宣传
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1873223543167902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    机器之心
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:11:42.000Z" title="Wed Dec 17 2025 10:11:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>如果你刚刚打开 X 并且正好关注了 OpenAI 和山姆・奥特曼，那么你可能会看到这样的照片：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84b05c34cc2f4c329d320db475d4fe96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=tTTEJECbSpycA7SpUdztvXog%2FmE%3D" alt="图片" loading="lazy"/></p>
<p>是的，确实有点辣眼睛。就连 OpenAI 官方号也忍不住吐槽（其实是刷热度）：sam.</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7cad5ad4ed9d46daadb5ddbcd97e0e8d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=Mr7M3EgDVOI080GjC8Uia9sednw%3D" alt="图片" loading="lazy"/></p>
<p>而在评论区，更是一片吐槽和调侃：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bbe7a10715c4712807afb103cf6ea64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=dtF%2F5JPmC9Js8tJw9QynrLjgfEA%3D" alt="图片" loading="lazy"/></p>
<p>但不管怎么说，热度是有了。</p>
<p>实际上，山姆・奥特曼之所以发这样一张辣眼睛的图片，正是为 OpenAI 刚刚推出的全新 ChatGPT Images 造势。而且这也不是唯一一张基于奥特曼照片改的图。OpenAI 官方号还专门单独特地发了一张这样的：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c21d5949c894830bef36aba0c3c0fc3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=W05tQuK3RpP8VPiJDsP5TWdZqRA%3D" alt="图片" loading="lazy"/></p>
<p>而且以身入局的 OpenAI 大佬还不止他一个。OpenAI 首席研究官 Mark Chen 和 OpenAI 总裁 Greg Brockman 都贡献了自己的照片。比如下面即是其官方博客分享的修图对话记录：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b50f6ad55c3240f89beb682eb9ce9c3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=jGnHoW1B7GqGrb%2FASxR6hqEjE70%3D" alt="长图滚动查看" loading="lazy"/>上下滑动查看</p>
<p>新版 ChatGPT Images</p>
<p>ChatGPT Images 的新版本由 OpenAI 全新的旗舰图像生成模型驱动。该公司表示：「现在，无论你是从零开始创作还是编辑照片，都能得到你脑海中构想的画面。它能在进行精准编辑的同时保持细节完好，图像生成速度更是提升了 4 倍。」</p>
<p>其核心特性是：精准编辑，保留关键细节。</p>
<p>现在，当用户要求对上传的图片进行编辑时，模型能更可靠地遵循用户的意图。按 OpenAI 的说法是「细致入微到每一个小细节」，比如仅改变用户要求的部分，同时在输入、输出和后续编辑中保持光影、构图和人物外观等元素的一致性。</p>
<p>这能解锁很多潜在用例，比如更实用的照片编辑、更逼真的服装和发型试穿，还是保留原始图像精髓的风格滤镜和概念转换。</p>
<p>编辑功能</p>
<p>OpenAI 表示：该模型擅长各种类型的编辑，包括添加、删减、组合、融合和置换。</p>
<p>下面是一个从生成到各种编辑的示例。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58e42fa63c4b486a93adda66d7769243~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=S%2Bfbc811o4bG%2Bosq335eMb1Ai3k%3D" alt="长图滚动查看" loading="lazy"/></p>
<p>创意转换</p>
<p>该模型还具备 transformation 功能，即可以改变和添加元素（如文本和布局）来实现想法，同时保留重要细节。OpenAI 表示，这些转换既适用于简单的概念，也适用于复杂的概念，并且可以通过新版 ChatGPT Images 功能中的预设风格和创意轻松尝试 —— 无需手动编写提示词。</p>
<p>比如，你可以将一张日常照片转换成电影海报。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46125a89a79f4f06b6d6942ec41695a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=jUGRDSfw%2Brkts643EYZl8Zko94E%3D" alt="图片" loading="lazy"/></p>
<p>或制作一张戴珍珠耳环的奥特曼。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e7eb3e8ae3d47618fbc36f008497953~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=f%2FcYb6x7GpdKqvAaSIrvvF4zZEw%3D" alt="图片" loading="lazy"/></p>
<p>遵循指令</p>
<p>OpenAI 称：「与我们的初始版本相比，该模型能更可靠地遵循指令。这不仅实现了更精准的编辑，还能处理更复杂的原始构图，按预期保留元素之间的关系。」下面给出了一个对比示例：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c50096c0ffa4115b68963675e1861cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=ujtYhphYGb9yainbQFa791TGf24%3D" alt="图片" loading="lazy"/></p>
<p>文本渲染</p>
<p>该模型在文本渲染方面又迈进了一步，能够处理更密集、更小的文本。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61105c618a1642588228aa7e2519d09c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=MI4GElIJMxzkkZnNV5wOSTLiuUE%3D" alt="长图滚动查看" loading="lazy"/></p>
<p>其他质量改进</p>
<p>该模型还在其他维度上进行了改进，使得输出结果能更直接地投入使用，例如渲染许多小尺寸的人脸以及提升输出结果的自然程度。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1651ecefa0804391b0349885da78499d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=ujPlpFAa62BJh6Vhw6L%2FvqjtWdw%3D" alt="图片" loading="lazy"/></p>
<p>全新的创作空间</p>
<p>另外，OpenAI 还在 ChatGPT 中推出了全新的「Images」（图片）功能，「旨在让图像生成体验更加令人愉悦 —— 不仅能激发灵感，还能让创意探索变得毫不费力。」</p>
<p>用户可通过移动应用的侧边栏和 chatgpt.com 访问，让图像的探索和尝试变得更快、更简单。它包含了数十种预设滤镜和提示词以快速激发灵感，并会定期更新以反映新兴趋势。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37980b8a9648476898be8f28de849bfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=iohd53uf39BsJEb5jip25XU3Ie4%3D" alt="图片" loading="lazy"/></p>
<p>可用性</p>
<p>全新的 Images 模型于今日起向所有 ChatGPT 用户推出，并通过 API 以 GPT Image 1.5 的形式提供。与 GPT Image 1 相比，GPT Image 1.5 的图像输入和输出价格降低了 20%，因此用户可以在预算不变的情况下生成和迭代更多图像。</p>
<p>ChatGPT 中全新的 Images 体验也于今日向大多数用户开放，商业版（Business）和企业版（Enterprise）的访问权限将在稍后推出。</p>
<p>OpenAI 表示：「我们相信，我们仍处于图像生成所能实现的可能性的开端。今天的更新是向前迈出的有意义的一步，未来还将有更多功能推出，从更细粒度的编辑到跨语言的更丰富、更详细的输出。」</p>
<p>结语</p>
<p>最后，我们也使用一个同样的提示词，简单测试对比了 ChatGPT Images 与谷歌的 Nano Banana Pro。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c09530327164ebd89acb7ffee50b85c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=05Gr0A%2BXipvc30CWUCeFvm4N9wQ%3D" alt="图片" loading="lazy"/></p>
<p>ChatGPT Images 的结果</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd8926f0ede74544b82dd987817c4f99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571102&amp;x-signature=twXowkatk3pICSto%2FlLGYykOeuM%3D" alt="图片" loading="lazy"/></p>
<p>Nano Banana Pro 的结果</p>
<p>看起来，至少在这个特定案例中，ChatGPT Images 的结果更加符合我们的指令。</p>
<p>综合来看，在这场 AI 生图之战中，OpenAI 此次发布的 ChatGPT Images 标志着竞争的维度正在变化：从单纯的「模型能力」转向了综合的「产品体验」。OpenAI 这一次甚至没有放出任何量化的基准测试结果！</p>
<p>同时，Sam Altman 亲自下场自黑虽然充满了硅谷式的幽默，但其背后的信号非常清晰：OpenAI 正在极力降低用户的心理门槛。通过推出独立的「Images」入口、预设风格滤镜以及极大幅度的降价，OpenAI 试图将图像生成从一种需要精心调试提示词的专业技能，变成一种像发推特一样简单的日常交互。</p>
<p>你看好 ChatGPT Images 吗？</p>
<p>参考链接</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fopenai.com%2Findex%2Fnew-chatgpt-images-is-here%2F" target="_blank" title="https://openai.com/index/new-chatgpt-images-is-here/" ref="nofollow noopener noreferrer">openai.com/index/new-c…</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FOpenAI%2Fstatus%2F2000990989629161873" target="_blank" title="https://x.com/OpenAI/status/2000990989629161873" ref="nofollow noopener noreferrer">x.com/OpenAI/stat…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter运行iOS26真机的两个问题]]></title>    <link>https://juejin.cn/post/7584633505105313844</link>    <guid>https://juejin.cn/post/7584633505105313844</guid>    <pubDate>2025-12-17T10:14:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584633505105313844" data-draft-id="7584379805899817012" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter运行iOS26真机的两个问题"/> <meta itemprop="keywords" content="Flutter,iOS"/> <meta itemprop="datePublished" content="2025-12-17T10:14:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="往来凡尘"/> <meta itemprop="url" content="https://juejin.cn/user/3553229180502071"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter运行iOS26真机的两个问题
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3553229180502071/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    往来凡尘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:14:59.000Z" title="Wed Dec 17 2025 10:14:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">一、Debug编译崩溃</h2>
<blockquote>
<p>../../../flutter/third_party/dart/runtime/vm/virtual_memory_posix.cc: 428: error: mprotect failed: 13 (Permission denied)</p>
</blockquote>
<blockquote>
<p>在iOS上Dart不管是JIT运行还是进行hotload的时候，都需要涉及代码在内存从RW变成RX的调整，而这在Flutter低版本是通过<code>mprotect</code>完成，而这在iOS 26被禁止了</p>
</blockquote>
<p>所以Flutter在Debug模式下真机运行iOS 26设备就崩溃了。如果确实需要在iOS 26上真机调试，方案如下：</p>
<ol>
<li>目前测试最新的3.38.5版本可以正常在Debug模式运行iOS 26设备。</li>
<li>如果不能升级Flutter版本，只能暂时使用Release或Profile模式运行(修改iOS项目Scheme,设置run-&gt;Build Configuration)</li>
</ol>
<h2 data-id="heading-1">二、Flutter适配UIScene</h2>
<p>当我的iOS 26的设备正常运行后，发现Xcode控制台有一行打印：</p>
<blockquote>
<p><code>UIScene</code> lifecycle will soon be required. Failure to adopt will result in an assert in the future.</p>
</blockquote>
<p>强制使用UIScene不然未来就可能触发断言，太可怕了😱那就顺便做了吧。</p>
<p>Flutter<code>最低版本</code>：</p>
<pre><code class="hljs language-dart" lang="dart">environment:
  sdk: ^<span class="hljs-number">3.10</span><span class="hljs-number">.0</span>
  flutter: <span class="hljs-string">"&gt;=3.38.0"</span>
</code></pre>
<p><strong>方案一：</strong> 自动化迁移，适合iOS <code>AppDelegate</code>文件没有大量定制化修改,在项目终端运行命令：</p>
<pre><code class="hljs language-sh" lang="sh">flutter config --enable-uiscene-migration
</code></pre>
<p>迁移成功后，会在构建日志中看到 <strong>"Finished migration to UIScene lifecycle"</strong> 的提示，否则工具会给出警告，并提示你手动迁移。</p>
<p><strong>方案二：</strong> 手动迁移</p>
<ol>
<li><code>AppDelegate</code>移除window生命周期相关的方法，使用<code>UIScene lifecycle</code>的对应方法，保留<code>application(_:didFinishLaunchingWithOptions:)</code>方法，移除所有创建和设置<code>window</code>的代码</li>
<li><code>AppDelegate</code>类遵循协议：<code>FlutterImplicitEngineDelegate</code>，并在<code>didInitializeImplicitFlutterEngine</code>方法中注册插件，并将创建Method Channels或Platform Views的逻辑都迁移到此处，因为在<code>didFinishLaunchingWithOptions</code>执行时，<code>FlutterViewController</code>可能还不存在</li>
</ol>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> Flutter
<span class="hljs-keyword">import</span> UIKit

<span class="hljs-keyword">@main</span>
<span class="hljs-keyword">@objc</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppDelegate</span>: <span class="hljs-title class_">FlutterAppDelegate</span>, <span class="hljs-title class_">FlutterImplicitEngineDelegate</span> {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">application</span>(
    <span class="hljs-keyword">_</span> <span class="hljs-params">application</span>: <span class="hljs-type">UIApplication</span>, 
    <span class="hljs-params">didFinishLaunchingWithOptions</span> <span class="hljs-params">launchOptions</span>: [<span class="hljs-type">UIApplication</span>.<span class="hljs-params">LaunchOptionsKey</span>: <span class="hljs-keyword">Any</span>]<span class="hljs-operator">?</span>
  ) -&gt; <span class="hljs-type">Bool</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.application(application, didFinishLaunchingWithOptions: launchOptions)
  }
  
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">didInitializeImplicitFlutterEngine</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">engineBridge</span>: <span class="hljs-keyword">any</span> <span class="hljs-type">FlutterImplicitEngineBridge</span>) {
        <span class="hljs-type">GeneratedPluginRegistrant</span>.register(with: engineBridge.pluginRegistry)
        <span class="hljs-comment">// Channel、Platform Views</span>
    }
}
</code></pre>
<ol start="3">
<li>创建<code>SceneDelegate.swift</code>文件，基础定义如下：</li>
</ol>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> UIKit
<span class="hljs-keyword">import</span> Flutter

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SceneDelegate</span>: <span class="hljs-title class_">FlutterSceneDelegate</span> {
}
</code></pre>
<ol start="4">
<li><code>info.plist</code>添加<code>Application Scene Manifest</code>相关key：</li>
</ol>
<pre><code class="hljs language-XML" lang="XML"><span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UIApplicationSceneManifest<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UIApplicationSupportsMultipleScenes<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">false</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UISceneConfigurations<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UIWindowSceneSessionRoleApplication<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UISceneConfigurationName<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>Default Configuration<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UISceneDelegateClassName<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>$(PRODUCT_MODULE_NAME).SceneDelegate<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UISceneStoryboardFile<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>Main<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
</code></pre>
<p>key缺失可能会导致启动黑屏或控制台打印xxxkey缺失，其中key：</p>
<ul>
<li>UISceneConfigurationName：<code>Default Configuration</code>或<code>flutter</code>均可</li>
<li>UISceneDelegateClassName：<code>FlutterSceneDelegate</code>或<code>$(PRODUCT_MODULE_NAME).SceneDelegate</code>均可</li>
</ul>
<p>到此基础配置就完成了，恭喜你demo项目可以正常运行了，如果你的项目其他定制化修改还需要迁移，详细可以参考下面的<code>Flutter Docs</code>。</p>
<h3 data-id="heading-2">参考链接</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.flutter.dev%2Frelease%2Fbreaking-changes%2Fuiscenedelegate%23if-you-cant-directly-make-flutterscenedelegate-a-subclass" target="_blank" title="https://docs.flutter.dev/release/breaking-changes/uiscenedelegate#if-you-cant-directly-make-flutterscenedelegate-a-subclass" ref="nofollow noopener noreferrer">Flutter Docs</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Ftechnotes%2Ftn3187-migrating-to-the-uikit-scene-based-life-cycle" target="_blank" title="https://developer.apple.com/documentation/technotes/tn3187-migrating-to-the-uikit-scene-based-life-cycle" ref="nofollow noopener noreferrer">Apple Docs</a></li>
<li><a href="https://juejin.cn/post/7565733796269981738" target="_blank" title="https://juejin.cn/post/7565733796269981738">iOS 26 开始强制 UIScene</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[是个公司都在用AI Agent，但大家真的用明白了吗？？| MEET2026圆桌论坛]]></title>    <link>https://juejin.cn/post/7584408254820483107</link>    <guid>https://juejin.cn/post/7584408254820483107</guid>    <pubDate>2025-12-17T10:19:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584408254820483107" data-draft-id="7584472215975788559" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="是个公司都在用AI Agent，但大家真的用明白了吗？？| MEET2026圆桌论坛"/> <meta itemprop="keywords" content="AI编程,AIGC"/> <meta itemprop="datePublished" content="2025-12-17T10:19:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="量子位"/> <meta itemprop="url" content="https://juejin.cn/user/2858385963484488"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            是个公司都在用AI Agent，但大家真的用明白了吗？？| MEET2026圆桌论坛
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2858385963484488/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    量子位
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:19:48.000Z" title="Wed Dec 17 2025 10:19:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读29分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>“每个人每天使用最高频的三个 APP 中有两个是 Agent 时，才意味着 AI Agent 进入新发展阶段。”</p>
<p>“一个好 Agent 的衡量指标，包括可控性、可解释性以及持续稳定执行任务的能力。”</p>
<p>“多数 Agent 存在负毛利问题，完成任务的代价高于用户支付意愿，这对创业者来说是巨大挑战。”</p>
<p>……</p>
<p>在量子位 MEET2026 智能未来大会的<strong>圆桌环节</strong>，三位来自产业一线的嘉宾围绕 <strong>AI Agent 的革新进程</strong>展开深入讨论。他们分别是：</p>
<ul>
<li>
<p>联汇科技 CEO 兼首席科学家赵天成博士</p>
</li>
<li>
<p>小宿科技联合创始人兼 CEO 杜知恒先生</p>
</li>
<li>
<p>蚂蚁集团平台体验技术部负责人徐达峰先生</p>
</li>
</ul>
<p>2025 年普遍被视为 “Agent 元年”。从客服、理赔等相对标准化的场景开始，Agent 已经完成了初步落地，并验证了技术可行性与阶段性价值。</p>
<p>但真正的难题才刚刚显现——</p>
<p>如何让 Agent 同时跑通技术、产品与商业三条曲线，形成可持续的正向闭环，仍是摆在整个行业面前的共同挑战。</p>
<p>而在这场圆桌讨论中，三位嘉宾从产品形态、技术演进与商业现实等多个维度出发，分享了他们对 Agent 下一程的判断。</p>
<p>透过这些观点，我们或可窥见 Agent 从技术概念走向规模应用的关键路径，以及产业先行者们在探索中所面临的思考与抉择。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d43778f4e8c43e0a10943928136ac2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571588&amp;x-signature=dfLK7hyJH%2Fo%2B7PIRrE9UUmIEVDI%3D" alt="" loading="lazy"/></p>
<p>本次圆桌环节由量子位智库首席分析师刘萌媛主持。在不改变原意的基础上，本文对内容进行了编辑整理。希望能够给你带来更多的启发与思考。</p>
<p><em>MEET2026 智能未来大会是由量子位主办的行业峰会，近 30 位产业代表与会讨论。线下到场参会观众近 1500 人，线上直播观众 350 万 +，获得了主流媒体的广泛关注与报道。</em></p>
<h2 data-id="heading-0">话题要点</h2>
<ul>
<li>
<p>目前在 AI Agent 及相关领域重点从事哪些工作？</p>
</li>
<li>
<p>各自落地效果最好的案例是什么？</p>
</li>
<li>
<p>真正好用的 AI Agent 产品应该关注哪些指标？</p>
</li>
<li>
<p>未来还有哪些对于 AI Agent 发展比较关键的卡点？</p>
</li>
<li>
<p>AI Agent 的下一步关键演进方向是什么？进入新阶段的标志性节点是什么？</p>
</li>
</ul>
<p><em>以下为圆桌对话全文：</em></p>
<h2 data-id="heading-1">圆桌实录</h2>
<p><strong>量子位</strong>：</p>
<p>无论是在前面各位嘉宾的演讲中，还是在整个 2025 年的讨论里，相信大家已经多次听到 “AI Agent” 这一关键词。</p>
<p>无论是技术迭代还是产品涌现，AI Agent 确实屡屡让人眼前一亮。今天，我们将从更加理性、务实的角度来探讨：<strong>千行百业距离广泛应用 AI Agent 究竟还有多远？</strong></p>
<p>为此，我们邀请到三位嘉宾，他们分别代表 AI Agent 产业链上不同领域的最前沿产品与技术，来为大家带来切实的分享。</p>
<p><strong>首先，请三位嘉宾简要介绍一下自己，以及目前在 AI Agent 相关领域所从事的工作</strong>。</p>
<p><strong>赵天成</strong>：</p>
<p>大家好，我是来自联汇科技的赵天成。在过去的五年里，我们团队一直在做的事情是：</p>
<p>第一，研发信号终端侧的多模态模型；</p>
<p>第二，探索如何让智能体从在虚拟世界做 PPT、写写画画，走向物理世界，真正操控终端设备，也就是实现所谓的 <strong>“物理智能体”</strong>。</p>
<p>目前我们在两个方向做了很多工作，一是致力于让多模态智能体本地化运行，不完全依赖云端强大算力。例如，让它在端侧设备_（如 AI PC）_上，甚至在飞机等无网络环境中，也能高效处理海量多模态数据，并转化为真正实用、能帮用户解决实际问题的智能体。</p>
<p>更进一步，我们致力于将无人机、机器人、摄像头等具备真正执行能力的智能终端串联起来，形成协同工作的智能体网络。这是一个非常有意思的课题。目前大家熟悉的智能体，或许更多体现在处理工作流或特定查询场景中。<strong>而我们探索的是更系统的物理联动</strong>。</p>
<p>举个例子，一个智能摄像头探测到火灾，它可以自动通知另一个终端——比如一台配备灭火装置的机器狗。机器狗收到指令后前往现场扑灭火情，并在任务完成后返回基地，自动生成一份报告给管理员，说明 “火灾已发生并被扑灭，问题已解决”。</p>
<p>这样一个从感知、决策、执行到反馈的完整闭环，能否通过智能体流畅地串联与调度，从而实现智能体从数字世界走向物理世界的跨越？这正是我们团队过去两年来持续深耕的核心方向。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f00532be7d44eaa82c1fc60a1a60e86~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571588&amp;x-signature=cXbwz58Wo%2F0vjap38hDGDLRxWZU%3D" alt="" loading="lazy"/></p>
<p><strong>徐达峰</strong>：</p>
<p>大家好，我是来自蚂蚁平台体验技术团队的徐达峰。我们目前主要聚焦在两个方向：</p>
<p><strong>一是重构软件的研发方式</strong>。我们正在构建一套完整的智能研发体系——WeaveFox，其中包含 WeaveFox-Coder、Vibe-Coding、Spec-Coding 等模块，并打造了面向工程体系的 Coding-Agent 基础设施和软件工程 - Agent 基础设施。</p>
<p>我们的核心目标，不仅仅是 “让模型能够写代码”，更是要将多模态生成代码、任务自动拆解、工具链智能协同等能力，真正融入到生产环境中。我们致力于让 AI 从辅助工具，转变为研发体系的原生能力，从而推动整个工程链路实现更高水平的自动化。</p>
<p><strong>二是致力于将多智能体能力带给大众用户</strong>。</p>
<p>为此，我们推出了 “蚂蚁百宝箱” 以及“百宝箱超级智能体”。我们的愿景是将其打造成一个“通用 Agent 平台”——无需任何代码依赖，也不要求使用者具备技术背景，真正做到开箱即用。用户只需用自然语言描述需求，就能轻松构建并发布属于自己的智能体应用。</p>
<p>无论是内容创作类的需求，如生成文案、制作 PPT、撰写报告、设计网页，还是通过多 Agent 协作完成更复杂的工作流任务，都可以通过这个平台实现。我们的目标，是将 AI 智能体从高门槛的 “专业工具”，转变为人人都能用起来的 “工具箱”。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d55c3d4ee31b4c618eac4d1e4cfd8a63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571588&amp;x-signature=1oZImH%2FnZ0Cr72B9lpjEWbKD9NQ%3D" alt="" loading="lazy"/></p>
<p><strong>杜知恒</strong>：</p>
<p>我是杜知恒，小宿科技打造的是<strong>面向 Agent 的一站式基础设施平台</strong>。</p>
<p>我们认为，其中尤为重要的一个产品是为 Agent 设计的搜索引擎。这里我们也呼应一下蚂蚁的观点：我们相信，优秀的 Agent 能够胜任人类可以完成的工作。</p>
<p>过去，搜索引擎和信息获取一直是人们工作、学习乃至日常生活中最主要的信息获取工具。我们提供的正是一个多语言、全球化的搜索引擎工具，专门服务于 Agent。</p>
<p>除了搜索能力，我们还提供模型服务、AI 沙盒等多样化的 Agent 工具集，致力于为大家打造一站式的 Agent Infra 平台。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40ed1f23e7d0406398f65667f72d8cc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571588&amp;x-signature=M0Lw48N2wuStv%2BwAratKkyP6XTY%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-2">各自落地效果最好的案例是什么？</h4>
<p><strong>量子位</strong>：</p>
<p>在三位做的 Agent 相关的产品里面，效果最好的 Agent 落地案例是什么？能否结合具体数据和观众分享一下，让大家对 Agent 落地价值有更直观的感受？</p>
<p><strong>赵天成</strong>：</p>
<p>今年有两个点带来的 ROI_（投资回报率）_提升还是非常明显的。</p>
<p>第一个是有了<strong>多模态</strong>。今年的确是 VLM_（视觉语言大模型）_大幅度成熟的一年，之前大家用 ChatGPT、GPT-4 比较多，今年 GPT-4o、Gemini 3 这些新出来的多模态模型对于图像和视频的理解能力其实有质的飞跃。</p>
<p>有了这个能力之后，我们的智能体可以算是打开了新的窗户。之前 Agent 只能处理文本，要做图片任务还需要一段描述，再给到模型去理解执行，现在有了端到端模型之后，直接给视频、给扫描件、给一张图片甚至混合在一起都可以直接做（任务），很多以前不敢想的场景瞬间打开。</p>
<p>我们在多模态领域扎根很久，之前就在做很多探索，今年的确感受到建模本身的提升，多模态能力可以让我们的智能体即使在数字空间场景中，也可以做很多以前不可能做到的事情。</p>
<p>第二个是有了<strong>执行智能体</strong>。以前的 AI 即使可以理解视频、理解图像，也只能给你一个提醒 “这边发生事故赶快修复”、“这边有问题赶快派人去吧”，现在有了执行智能体，无论是操控机械臂还是执行其他操作，现场就能直接解决问题。</p>
<p>这对于用户来说，投资回报率和价值完全不在一个量级，比如以前一个终端最多付一千块钱，有了智能执行端之后愿意付十万块钱，这是一百倍的本身价值的提升。</p>
<p>智能体核心逻辑在于<strong>结果即服务</strong>，提供的是一个结果，这个结果的价值定义了产品有多大的能力边界，一个是帮你看着，提醒你赶快灭火吧；第二个是直接告诉你已经帮你把火扑灭了，比人扑的更快一些，这个对客户来说价值是 100 倍的提升，这也是为什么我们非常笃定地相信<strong>多模态 + 执行</strong>是智能体在后续发展中非常重要的板块和体现。</p>
<p><strong>杜知恒</strong>：</p>
<p>过去这一年 Agent 进化还是很明显的，从大家只会用 Chatbot 到真正开始用 AI 做各种各样的任务、工作，包括陪伴式的娱乐、学习。</p>
<p>我观察到在这几个场景中，Agent 能做越来越多智能化的工作。</p>
<p>第一个就是刚才说的做 PPT、写产品文档，包括 Coding，在核心工作流中 Agent 开始能交付实习生水平的结果，这是过去一年中 Agent 领域非常明显的进步和进化。</p>
<p>另外可以看到，各种各样的垂类软件正在越来越多地采用 AI 技术，无论是客服系统、数据平台还是其他各类软件工具。我的观察是，上一代 SaaS 公司正在快速引入 AI 能力，这显著提升了它们服务客户的效率与质量。</p>
<p><strong>徐达峰</strong>：</p>
<p>前面老师提到智能客服，还有端到端多模态 + 执行，我补充一个 Coding Agent 能力方面的个人观察。</p>
<p>Coding Agent 已经从<strong>写一段代码进化为跑一段流程</strong>。在 WeaveFox 的实践中，Agent 能看懂设计稿、理解上下文和组件规范，然后自动生成可上线代码。过去通常需要工程师在 IDE 中花半天时间调试，现在 Agent 几十秒就能跑完。而且这是在多个规模化项目里，我们稳定看到了 3~5 倍的效率提升。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f36425066d5141feb4546069166fc804~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571588&amp;x-signature=2vQ8H9oE3ABPQNCRxPenBQ%2B6p%2FM%3D" alt="" loading="lazy"/></p>
<p>这说明，<strong>只要工具链和上下文足够清晰，Agent 的能力是可以被 “工程化复制” 的</strong>。</p>
<h4 data-id="heading-3">真正好用的 AI Agent 产品应该关注哪些指标？</h4>
<p><strong>量子位</strong>：</p>
<p>今天邀请到的三位嘉宾在 AI Agent 里面处于不同的生态位，小宿处于基础设施层，另外两位老师偏向于产品层，请各位在不同的生态位上定义真的好用、或者有价值的 AI Agent 产品，你们觉得现在更应该关注哪些指标？有哪些指标大家没有关注？下一步应该在哪些方面投入更多技术和精力呢？</p>
<p><strong>杜知恒</strong>：</p>
<p>我的观点还是一样的，（如果 AI）能更像人一样，交付一个从高中生到大学生到博士生能交付的结果，这就是好场景。</p>
<p>企业愿意为这类 AI 支付更高成本，背后的逻辑很明确：过去，大家把 AI 当作普通软件看待，关注点局限在软件订阅费的高低；而现在，大家会将其价值与实习生、全职员工的人力价值做对比。</p>
<p>即便目前存在<strong>堆砌 Token 完成任务</strong>的争议，包括我们公司在内，许多企业在高频使用 AI 进行代码编写（Coding）、撰写产品需求文档（PRD）、搭建各类工作流以优化效率的过程中，通过 AI 节省的人工成本，也远远超过了在 Token 上投入的费用，即使 Claude Code 很贵。</p>
<p>我觉得我们内部对 Agent 可用性最主要的评判标准，就是<strong>它能不能在特定场景交付一个相对完整的结果</strong>。</p>
<p>Agent 在中国被叫智能体，但其实我觉得 <strong>“代理人”</strong> 这个翻译是更好的，一个 Agent 不能给你交付结果，你肯定不会花钱雇他，包括 Coding 这些场景在内，AI 越来越能够真正交付结果。</p>
<p>现在 Coding 还有抽卡的情况，但即使是抽卡抽三次性价比依然很高。</p>
<p><strong>赵天成</strong>：</p>
<p>我们从时间上来看，有两方面是整个业界要慢慢接受和改变的，因为智能体跟以前信息化系统和纯粹软件还是不太一样的。</p>
<p>第一个是之前很多人说做 AI 原生的 Agent，我们发现以前软件系统有很多 UI 式、表单式结构，很多时候 AI 就是把表单的某些环节换成模型，这是比较方便的方式，但也有很多时候换汤不换药，还是原来的工作流做的事情。</p>
<p>其实可以把一个环节彻底用 Agent 代替，这时候可能会有一些更加创新型的产品并落地应用，这样才真正能把智能体的优势发挥出来，而不是受限于很条条框框的地方，只能做以前一些环节的替代。大家（才）会接受智能体可以真正替代一个流程一个环节，真正用 AI 的方式做这个事情。</p>
<p>第二个是 Agent 本身是可以进化的，在以往的 AI 应用中，包括我们的不少甲方客户在内，很多人会陷入一种认知误区：认为采购 AI 本质上就是采购一套算法，并且对算法的准确率、召回率有明确要求，若初始阶段无法达到既定指标，就不会验收。</p>
<p>但实际上，Agent 的价值体现在实际应用过程中，Context_（上下文信息）_会不断丰富，它自身具备记忆能力，再结合用户给出的反馈，会逐渐熟悉用户的业务流程，最终真正帮用户解决实际问题。然而当前许多场景下，用户并不能接受这种渐进式优化的模式，他们往往期望一步到位，要求 AI 在初始阶段就达到 95% 的准确率。</p>
<p>这就陷入了 “鸡生蛋还是蛋生鸡” 的矛盾问题。如果用户不使用 AI、不提供反馈、不补充 Context，不给 AI 学习和适应的机会，AI 自然无法达到理想的使用效果；可用户又因 AI 初始效果未达预期而不愿启用，形成了恶性循环。</p>
<p>不过这种情况也在逐渐改变，越来越多人也正在接受，说明大家用豆包、用 GPT，已经习惯了越聊越聪明的交互模式，慢慢（把它）变成自己想要的数字员工。</p>
<p>这个可进化性也是我们内部衡量智能体的非常重要的指标。假如一个智能体做出来就是这样了，你再跟它聊它都不会有变化，那就不是好的智能体，如果通过一天、一周、一个月使用变得更加个性化了，就是好的智能体。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00476deb3e5f436b99118fe51f2e4e71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571588&amp;x-signature=8EiEmBNIo4OUQH9E0Z7NhLzXazM%3D" alt="" loading="lazy"/></p>
<p><strong>量子位</strong>：</p>
<p>我想再追问一下赵总，您刚刚提到用 Agent 彻底替代某一部分工作流，或者某一部分工作场景，那让你畅想一下在未来 6 个月或者一年之内，您觉得会有哪些行业或者场景率先有可能被彻底改变工作流呢？</p>
<p><strong>赵天成</strong>：</p>
<p>假如是 6 个月的时间，在那些失败结果没有那么灾难性的地方，相关问题或许可以得到彻底解决。（这些场景的容错空间相对较大），AI 一次没做好，大不了再做一次，而且如果做三次的成本，比我自己干整个过程的成本还是低很多，那这类工作就可以被替换掉。</p>
<p><strong>量子位</strong>：</p>
<p>也就是说结果不够致命，有一点容错空间的任务基本可以实现 AI 替代人。</p>
<p>那么徐总，蚂蚁目前在做的这些产品，包括您刚才提到的 Coding Agent，以及面向群众的产品，从您的角度来说，一款 AI Agent 产品最值得关注的指标是什么呢？</p>
<p><strong>徐达峰</strong>：</p>
<p>在我看来，判断一款 Agent 是否优秀，可以从以下几个角度界定标准，比如可控性、可解释性，乃至于稳定性，这是基础要求，在此就不赘述了。</p>
<p>需要明确的是，Agent 一定是基于某一类特定任务去设计的，很多场景里，任务本身就是开放型问题、还存在各种例外情况，模型也不可能 100% 完美解决所有问题。所以我认为优秀的标准是<strong>看 Agent 产品有没有设计人机协作的流程</strong>。</p>
<p>企业真正需要的不是 “永不犯错”，而是犯错时能暴露不确定性，是否具有回滚的能力，能不能回溯回去找到问题。另外在这个过程中，在出现问题后，能顺畅地将任务交由人工接管。</p>
<p>也就是说，它要像一位可靠的同事，而不是像一名（缺乏协作性的）天才小学生。如果没有如上指标，即便效果再惊艳，也很难真正落地，我觉得这是一个好的 Agent 的标准指标。</p>
<p><strong>量子位</strong>：</p>
<p>如果把刚刚给赵总的问题再抛给您，目前您涉及的所有用户场景里，未来 6 个月，您觉得哪一个是被改写最彻底的？</p>
<p><strong>徐达峰</strong>：</p>
<p>彻底不敢谈。我认为<strong>软件工程</strong>可能仍会面临较大的冲击和变革。</p>
<p>这主要是因为其工具链相对成熟，有上一代数字基建作为基础，且任务本身偏向结构化。</p>
<p>同时，进一步自动化的收益非常高。这些因素共同作用，将推动整个流程越来越自动化，通过辅助编码和自动化流程，研发团队也会更容易接受。因此，我认为是软件工程。</p>
<p><strong>量子位</strong>：</p>
<p>我们把这个问题换一个方向问杜总，您作为基础设施层的代表，您认为基础设施层究竟是如何影响不同 AI Agent 产品最终呈现的任务水平呢？能否结合小宿或其他具体案例，为我们解析一下具体的影响链路？</p>
<p><strong>杜知恒</strong>：</p>
<p>其实我们很难直接影响到 Agent 本身，更多是客户基于自身场景对基础设施提出更高要求，我们去响应和满足。</p>
<p>回到搜索本身，从 ToC 时代到 ToAgent 时代，三十年来它的核心标准——<strong>相关性、权威性、时效性</strong>，本质上没有改变。变化的是这些标准的重要程度。</p>
<p>过去，用户搜索时前三条结果必须吸引点击，所以相关性是最重要的指标。（但仅有相关性还不够）即使内容相关但质量很差，排到前面用户接受的概率，也比展示不相关信息要低得多。</p>
<p>但对于 AI 而言，调用搜索的核心原因在于消除信息幻觉与获取时效内容。</p>
<p>对 AI Agent 来说，搜索的首要要求是<strong>权威性——信息必须准确、全面</strong>。即便在前十条结果中，哪怕极端情况下有两条不相关，也远比 “十条看似相关、却缺乏精准性和时效性的信息” 要好，后者带来的后果反而更加灾难性。</p>
<h4 data-id="heading-4">未来还有哪些对于 AI Agent 发展比较关键的卡点？</h4>
<p><strong>量子位</strong>：</p>
<p>我们刚刚几个问题都聊的是 Agent 今天有怎么样的成就和价值，那我们现在从批判的角度聊一聊。</p>
<p>首先想问一下，从各位的角度来看，除了现在常说的推理大模型，或者语言大模型，还有哪些对于 AI Agent 未来发展比较关键的卡点？</p>
<p>既可以是技术方面，也可以是生态运营方面的，不知道各位是怎么看待这个问题的？</p>
<p><strong>赵天成</strong>：</p>
<p>我最近比较关注的是智能体的<strong>双脑架构</strong>。</p>
<p>刚才提到的代码生成这些创新都是用大语言模型做快速的处理，但是到我们这种物理场景之后，有时候你逃不掉，必须做双脑架构。</p>
<p>什么叫双脑？比如大语言模型给出一个指令，说无人机几点几分到这个地方去，但是在飞行过程中怎么飞？假如还是依赖云端语言模型思考的话，这个飞机干脆不要飞了，每飞 5 米就要想一想再飞一下，不太现实。</p>
<p>所以必须在端侧要有快速的、类似于小脑的模型做飞行这一块的执行，这个就跟常规的 MCP 模式还不太一样，以往云端模型调用工具，可能只是完成一次搜索、查询或简单指令下发；但在双脑架构里，云端大脑调用的不是普通工具，而是要驱动端侧小脑模型，让它把飞机飞过去。</p>
<p>这其实和目前主流智能体架构有区别，跟学术界研究的问题也不太一样。这里面得有一个框架，方便把各种小脑和大脑集成在一起，真正形成一个指挥官和类似于行动单元的组合的形态。</p>
<p>这个是我们近期一直在看的点，因为现在的确碰到了这样的现实问题，而且需要解决这些问题。</p>
<p><strong>徐达峰</strong>：</p>
<p>我可以补充一个企业视角下的观点，Agent 如果要在企业中落地，可能还会有一些挑战。尤其是大规模用在企业端时，首当其冲的可能是会面临访问核心资产数据，以及隐私和安全审计问题。</p>
<p>怎么样能够让这样的 Agent 可以被安全地运行？它访问数据是否有权限？能不能被审计？这些都是关键命题。</p>
<p>**以往很多流程设计更多是针对常规系统和人类操作场景设计的，很少有为 Agent 设计的，这是很关键的基础设施的缺漏。**这样的安全基础设施建立起来之后，才可能会为 Agent 大规模落地铺好前提。</p>
<p>面向 Agent 的设计，很可能是权限体系的重新设计和重塑。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1bbc086ccb6437fa355c9978b810f34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571588&amp;x-signature=6cT8uGoodjlSQLJamAy%2F8LvsaVo%3D" alt="" loading="lazy"/></p>
<p><strong>杜知恒</strong>：</p>
<p>我也说一个非常现实的问题，我们看 Agent，特别是 ToC 的 Agent 最大的挑战就是成本和 ROI 的问题。</p>
<p>因为即使当下的 Agent 可以帮你完成一些任务，但其实它完成任务所付出的代价和用户愿意付的成本还是有一个很明显的差距，目前市场上绝大多数的 Agent 都是以负毛利在运营，这在长期看来是一个很大的挑战，因为你很难在一个负毛利商业模式下做大规模的用户渗透。</p>
<p>除非像蚂蚁、字节这样的巨头，可以为获取客户长期承担非常大规模的亏损，这个对于大部分的 Agent 创业者来说可能也是一个挑战。所以核心问题就是怎么能把商业模式跑通，能够把用掉的 Token 和工具的钱赚回来？</p>
<p>对于一个基础设施提供方来说，对客户健康度的判断很重要，如果我的客户都很赚钱，那我大概率收取的价格是比较合理且可持续的，如果所有人都在亏钱，或者说大家都是期待下一轮的融资再来付今天用的基础设施的钱，（那么整个生态的健康度就会存疑），对于我们来说也非常关心这个问题。</p>
<p><strong>量子位</strong>：</p>
<p>有关产品线的 ROI，也想再问一下徐总，您刚刚提到咱们有做一些面向大众普惠型的产品，像刚刚提到收费方面的问题，会不会从您的角度来看，为了让大众使用 AI Agent 的产品，除了技术上要达成一些目标，是不是还有其他的要素也需要注意的？</p>
<p><strong>徐达峰</strong>：</p>
<p>说一点个人的粗浅判断。</p>
<p>首先，使用门槛在产品设计上必须足够低，不能预设用户具备专业知识背景，更不能假定他们本身就懂代码。现实中，这样的前提不太可能成立。</p>
<p>其次，更高频的使用场景，可能集中在文案、PPT 等内容创作上，其本质是信息的聚合、创作过程的协助，以及后续内容排版等工作。这类场景天然更适合大众用户。</p>
<p>此外，还会出现许多新的特色玩法。比如蚂蚁最近发布的 “灵光” 产品，就是一款很有意思的 App，用户可以用它制作小游戏、小应用，实用性很强。大致会是这类产品设计方向。</p>
<h4 data-id="heading-5">Agent 的下一步关键演进方向是什么？</h4>
<p><strong>量子位</strong>：</p>
<p>众所周知，2025 年已被视为 AI Agent 的元年。那么，元年之后下一个关键的演进方向是什么？刚才赵总提到了 “双端” 和“多模态”，我们想请各位具体展望一下，对于 Agent 而言，下一步的关键方向是什么？</p>
<p><strong>赵天成</strong>：</p>
<p>虽然 2025 年被称为 “智能体元年”，但可能现实生活中还没有那么多智能体。<strong>今年更像是 iPhone 1 的阶段，距离真正成熟、普及的 iPhone 4，还有很多要做的事情</strong>。</p>
<p>就我个人在 C 端的使用体验而言，日常可能会用一个类似豆包的智能体，来替代部分搜索类工作，我觉得已经达到了 “可用” 的水平。但如果是下一轮融资的 PPT，让智能体来完成，即便是现在最好的智能体也做不到，这仍然需要我自己完成大量策略层面的思考，才能有比较好的结果。</p>
<p>所以在我看来，即使是目前定义已经相当成熟的智能体，在可靠性和实际效果上，依然有大量提升空间。</p>
<p>这种提升可能来自基础模型能力的增强，也可能来自工程化能力的改进，也可能正如前面几位所提到的，是多个层面的共同进步。</p>
<p>只有这些条件都到位，智能体才能真正把哪怕是 “做 PPT” 这样看似简单的功能，提升到一个全民都能够使用的水平——这是第一个方面。</p>
<p>第二个方面，是我们自己正在做的事情。我们一直相信，如果未来的 AI 只停留在替代一部分数字化工作，那一定是不够的。它最终必须能够替代部分蓝领工作，走向现实世界，帮我们在物理世界干活。</p>
<p>（而要实现这一点），需要解决的问题依然非常多，包括前面多位老师提到的 VLA、世界模型等，这些很可能都是不可或缺的组成部分，只有在它们被有效拼合之后，智能体才有可能真正走向物理世界。</p>
<p>在这里有两个关键问题。第一，未来是否会一直是 “大语言模型 + 其他模型” 的组合形式？短期来看大概率如此，但从长期看并不一定——完全有可能被一种全新的架构彻底取代，这并非不可能。其实早两年我们看待大语言模型时，也曾觉得这条路径不太可能，但现在它已经成为主流。</p>
<p>第二，还是可靠性的问题。（当智能体进入物理世界），可靠性就变得更加严肃，不能说一下子把桌子砸了，那会是灾难性的后果——在电脑里最多是误删文件，虽然也很严重，但相比之下还是要轻一些。</p>
<p>因此我认为，<strong>可靠性是所有智能体真正成为 “每个人每天都在使用” 的工具之前，必须解决的核心问题之一</strong>。</p>
<p><strong>杜知恒</strong>：</p>
<p>我可能更多是从商业视角来看这个问题。对于 2026 年，我有几个基本预期。</p>
<p><strong>第一会是巨头的大规模下场</strong>。</p>
<p>无论是在 B 端还是 C 端，都会出现真正意义上的重投入，去争夺 DAU、ARR 和核心客户。2025 年我们已经看到，超大规模投入主要来自字节的豆包，BAT 其他几家以及蚂蚁更多是在下半年才逐渐发力。</p>
<p>我认为到明年，这一趋势会变得非常清晰且激烈——所有 Tier 1、Tier 2 的传统大型互联网公司，都会在 Agent 方向上加大投入，围绕 “入口” 展开竞争。</p>
<p>第二个预期也由此引出：在这种大规模投入的推动下，<strong>AI 的整体渗透率会显著提升</strong>。</p>
<p>包括现场各位的手机和电脑，其 AI 含量也都会大幅上升。头部 Agent 会开始真正进入二线、三线城市，被非专业用户广泛使用，甚至包括我们父母这一代人，也会逐步开始接受和使用。</p>
<p>因此，在我看来，Agent 的大规模渗透将是 2026 年我比较期待的事情。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59bc58cf760a48308c6d273dc743013a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571588&amp;x-signature=9ROruT724lkIc7YmK0KfRo5d8IU%3D" alt="" loading="lazy"/></p>
<p><strong>徐达峰</strong>：</p>
<p>如果说未来一年的 Agent 的话，我可能会分几个层次看。</p>
<p><strong>第一层次是数据和算法，再上层是模型能力</strong>，可以看到，这两层的技术能力呈现慢慢收敛的趋势。<strong>第三层是 Agent 的框架，以及和系统交互和集成</strong>，无论是 C 端还是 B 端，都可以看到有更多的数据管控、权限管控、接入集成等多方面的实践。</p>
<p>另外再往上延伸至产品侧与行业应用层面。目前可以看到越来越明显的趋势。</p>
<p>除了能解决一些日常小工具类的任务，或者一些小型的效率场景，也可以看到有一些 Killer App（现象级应用）出现。这类应用往往会锚定泛娱乐赛道，给用户提供很多情绪价值，甚至慢慢 App 扩展到智能硬件上，这些是能看到的趋势。</p>
<p>当然，也期待 2026 年这样的趋势逐步爆发，可以给大家带来更多的 AI Agent 在各行业，各领域的体验。</p>
<h4 data-id="heading-6">AI Agent 进入新发展阶段的标志节点</h4>
<p><strong>量子位</strong>：</p>
<p>最后一个问题，再替公众朋友们试图向三位嘉宾询问一下不确定中的确定性。</p>
<p>像刚刚提到，不管是从技术需要的基础设施，还是未来的产品形态，其实都有可能还有很多新的内容出现。</p>
<p>如果从三位嘉宾的角度来看，有没有哪个节点是你们觉得如果看到了就意味着 AI Agent 已经进入新的发展阶段了，不是像现在这样只是从无到有，而是真正彻底改写，而且普惠大众的，有没有哪个标志性的节点是各位现在最期待的？</p>
<p><strong>杜知恒</strong>：</p>
<p>可能是我妈妈开始用 Manus 开始画 PPT 或者做一个什么事情的时候开始。</p>
<p>我觉得当前 Agent 的渗透率虽然看起来如火如荼，但是在三、四线城市和人们日常生活中还是一个超级低的状态。</p>
<p>可能我自己的观察指标是身边的年长，或者非技术行业的人真正开始在用一些 Agent，改变他的生活方式，或者提升他的生活体验。</p>
<p><strong>赵天成</strong>：</p>
<p>我觉得就是当你每天最高频使用的三个 APP 里面有两个是 Agent，到那天可能就差不多了。</p>
<p><strong>徐达峰</strong>：</p>
<p>我比较赞同赵天成老师的看法，如果你每天用的软件都已经是 Agent，那就已经产生质变了。</p>
<p><strong>量子位</strong>：</p>
<p>确实，今年我们看到很多 Agent 产品出现，无论是现场和线上的观众可以多去尝试尝试不断出现的新的 Agent 产品，看这些产品能不能带来一些新的收获和新的价值。</p>
<p>再次感谢三位嘉宾今天来到圆桌，跟我们从一线视角聊一聊 AI Agent 还需要进步的地方，以及现在明确能够带给我们的价值，谢谢大家。</p>
<p><strong>欢迎在评论区留下你的想法！</strong></p>
<p>— <strong>完</strong> —</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【Starrocks + Hive 】BitMap + 物化视图 实战记录]]></title>    <link>https://juejin.cn/post/7584659460245880851</link>    <guid>https://juejin.cn/post/7584659460245880851</guid>    <pubDate>2025-12-17T10:17:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584659460245880851" data-draft-id="7584443518036951103" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【Starrocks + Hive 】BitMap + 物化视图 实战记录"/> <meta itemprop="keywords" content="大数据"/> <meta itemprop="datePublished" content="2025-12-17T10:17:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="小C806"/> <meta itemprop="url" content="https://juejin.cn/user/2596377122057817"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【Starrocks + Hive 】BitMap + 物化视图 实战记录
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2596377122057817/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    小C806
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:17:50.000Z" title="Wed Dec 17 2025 10:17:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">BitMap 简单介绍</h2>
<p>高效的数据结构（bit数组），使用二进制位（0或1）来简洁地表示信息，适用于处理海量数据（大规模整数）的去重、查询和统计。</p>
<p><em><strong>更优的Bitmap - RoaringBitmap</strong></em></p>
<p>将32位整数分成高16位(计算桶的索引位置)和低16位（实际存放数据的桶），使用桶来存储。Container有三种类型：ArrayContainer、BitmapContainer和RunContainer</p>
<p><strong>使用要求:</strong></p>
<p>字段为 int 类型:
连续性越好，性能越高</p>
<p><strong>示例:</strong></p>
<p>单位关系: (1byte = 8bit) 1 int = 4byte</p>
<p>bitmap 实际空间: 99999999 / 8 / 1024 /1024 = 11.92 M</p>
<p>RoaringBitmap 实际空间:  2<em>2 + 2</em>2 = 8 byte
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ceb44d4f833c449e8b2f182827474c00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=%2FrXfWGvXNdc%2Bw8oWewChOL3lOJQ%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<h2 data-id="heading-1">在Hive 和 Starrocks 联合使用</h2>
<p><em><strong>使用场景:</strong></em></p>
<p>大量数据精确去重场景: 热门网站 pv pu , 用户画像圈人等场景</p>
<ul>
<li>bitmap 索引加速(starrocks 使用较多)</li>
<li>hive 中使用（包括spark）</li>
<li>hive中原生不支持 bitmap，一般需要自己构建UDF将数据转成bitmap格式，然后存储为 binary 类型。</li>
</ul>
<h2 data-id="heading-2">UDF 构建</h2>
<p>在新版本的starrocks中，有官方提高的 <strong>hive-udf.jar</strong> 包可以支持 hive bitmap的使用;</p>
<p>jar 包地址</p>
<blockquote>
<p>fe/hive-udf/hive-udf-1.0.0.jar</p>
</blockquote>
<p><strong>使用场景</strong></p>
<ul>
<li>原始数据量大，需要导入 starrocks 构建bitmap类型字段，直接导入会导致 SR 集群<strong>负载高</strong>，希望在 hive 中构建完成再导入。</li>
<li>导出 starrocks 中的 bitmap 至 hive，提供其他场景使用</li>
</ul>
<p><strong>支持的 hive bitmap udf 函数:</strong></p>
<p>具体参考: <code>https://docs.starrocks.io/zh/docs/3.5/sql-reference/sql-functions/hive_bitmap_udf/#%E6%94%AF%E6%8C%81%E7%94%9F%E6%88%90%E7%9A%84-hive-bitmap-udf-%E5%87%BD%E6%95%B0</code></p>
<p><strong>常用以下：</strong></p>
<ul>
<li>bitmapAgg ：将数据列转成 bitmap 类型，性能好</li>
<li>bitmapcount：统计bitmap中的数据值</li>
<li>bitmapunion: 求一组bitmap的并集一般联合 bitmapcount 使用, 效果类时 count distinct</li>
</ul>
<p><em><strong>使用前提(对象列必须为 整数类型):</strong></em></p>
<p>非整数字符串数据需要构建<strong>全局字典表</strong>进行映射</p>
<p><strong>构建方式:</strong></p>
<ol>
<li>hive 中处理</li>
</ol>
<pre><code class="hljs language-sql" lang="sql">

<span class="hljs-comment">-- 字典表</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> prd_tmp.dict_test (id string,load_date string, id_int <span class="hljs-type">bigint</span>) <span class="hljs-keyword">using</span> orc;
 
<span class="hljs-comment">-- 数据写入 or 更新</span>
<span class="hljs-keyword">with</span>
  max_id_int <span class="hljs-keyword">as</span> (
  <span class="hljs-keyword">select</span> ifnull(<span class="hljs-built_in">max</span>(id_int),<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> max_id_int <span class="hljs-keyword">from</span> prd_tmp.dict_test
  )
  ,
  new_data <span class="hljs-keyword">as</span> (
<span class="hljs-keyword">select</span>
  sale_ordr_doc
  ,date_format(<span class="hljs-built_in">CURRENT_TIMESTAMP</span>(),<span class="hljs-string">'yyyyMMdd'</span>) load_date
  ,(<span class="hljs-built_in">row_number</span>() <span class="hljs-keyword">over</span>(<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> sale_ordr_doc )) <span class="hljs-operator">+</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> max_id_int) id_int
  <span class="hljs-keyword">from</span> prd_dwd.ordr_detl  t1
  <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> prd_tmp.dict_test t2 <span class="hljs-keyword">on</span> t1.sale_ordr_doc <span class="hljs-operator">=</span> t2.id
  <span class="hljs-keyword">where</span> t2.id <span class="hljs-keyword">is</span> <span class="hljs-keyword">null</span> <span class="hljs-keyword">and</span> t1.stat_date <span class="hljs-operator">=</span> <span class="hljs-string">'20251213'</span>
  <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> sale_ordr_doc limit <span class="hljs-number">100</span>
)
 
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> prd_tmp.dict_test
<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> new_data


</code></pre>
<p><strong>效果如下:</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62be12a251bc42afaedf15c5040a3f85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=oW1FmFwOFDgmDLlAIL7uQMEbHSA%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<ol start="2">
<li>Starrocks 中处理</li>
</ol>
<p>Starrocks 3.0 + 版本支持，<strong>auto_increment</strong> 可简化全局字典构建流程</p>
<p>详情：<code>https://docs.starrocks.io/zh/docs/sql-reference/sql-statements/table_bucket_part_index/auto_increment/</code></p>
<p>使用注意事项：<code>https://docs.starrocks.io/zh/docs/sql-reference/sql-statements/table_bucket_part_index/auto_increment/#%E5%8D%95%E8%B0%83%E6%80%A7%E4%BF%9D%E8%AF%81</code></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 构建带自增的主键表，主键为需要替换的ID</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> test_tbl1
(
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    number <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT
)
<span class="hljs-keyword">PRIMARY</span> KEY (id)
DISTRIBUTED <span class="hljs-keyword">BY</span> HASH(id)
PROPERTIES("replicated_storage" <span class="hljs-operator">=</span> "true");
</code></pre>
<h2 data-id="heading-3">hive 中使用bitmap UDF查询</h2>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 1. 将 hive-udf.jar 上传至hdfs目录, 这里假如上传至 /tmp 目录</span>
<span class="hljs-comment">-- 2. 链接hive或者spark</span>
 
<span class="hljs-comment">-- 3. 注册jar</span>
<span class="hljs-keyword">add</span> jar hdfs:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>hive<span class="hljs-operator">-</span>udf.jar;
 
<span class="hljs-comment">-- 4. 创建函数</span>
<span class="hljs-keyword">create</span> temporary <span class="hljs-keyword">function</span> bitmap_count <span class="hljs-keyword">as</span> <span class="hljs-string">'com.starrocks.hive.udf.UDFBitmapCount'</span>;
<span class="hljs-keyword">create</span> temporary <span class="hljs-keyword">function</span> bitmap_agg <span class="hljs-keyword">as</span> <span class="hljs-string">'com.starrocks.hive.udf.UDAFBitmapAgg'</span>;
 
<span class="hljs-comment">-- 5. bitmap 函数去重查询</span>
<span class="hljs-keyword">select</span> bitmap_count(bitmap_agg(id_int)) <span class="hljs-keyword">from</span>
  (<span class="hljs-keyword">select</span>
  t1.sale_ordr_doc,
  t2.id_int
  <span class="hljs-keyword">from</span>
  ordr_detl t1
  <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> prd_tmp.dict_test t2 <span class="hljs-keyword">on</span> t1.sale_ordr_doc <span class="hljs-operator">=</span> t2.id
  <span class="hljs-keyword">where</span> t1.dt <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'20250710'</span> <span class="hljs-keyword">and</span> t1.dt<span class="hljs-operator">&lt;=</span><span class="hljs-string">'20251210'</span> ) a ;
 
 
<span class="hljs-comment">-- 6. 不使用bitmap 函数去重查询 (也可以不关联 prd_tmp.dict_test ，直接count原表的 id，这里为了验证 id_int 的数据量是否准确，所以保持一致 )</span>
<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-keyword">DISTINCT</span> id_int) <span class="hljs-keyword">from</span>
  (<span class="hljs-keyword">select</span>
  t1.sale_ordr_doc,
  t2.id_int
  <span class="hljs-keyword">from</span>
  ordr_detl t1
  <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> prd_tmp.dict_test t2 <span class="hljs-keyword">on</span> t1.sale_ordr_doc <span class="hljs-operator">=</span> t2.id
  <span class="hljs-keyword">where</span>  t1.stat_date <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'20250710'</span> <span class="hljs-keyword">and</span> t1.stat_date<span class="hljs-operator">&lt;=</span><span class="hljs-string">'20251210'</span> ) a ;
</code></pre>
<p>两者执行DAG和耗时如下: 左边为不使用 bitmap，右边为使用 bitmap, 耗时方面有所提升 （<em><code>为什么: 因为 【bitmap_agg(id_int)】过程为将查询的 int_id 构建为bitmap , 也存在性能损耗</code></em>）</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7df0c8c8c0fe4fff89b75c0216a4f0c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=t8e1OciF%2BVLIUGktSiHeAqCm5NI%3D" alt="在这里插入图片描述" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b206071a6804ea8a53388653487c932~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=CoW8NUaAHIBGlGjkdQru7CVSqwU%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<p>对比下来，速度有一定提升，主要差别体现在执行计划上, 使用bitmap是，少了一段 shuffle 过程, 在数据的交换上也比count distinct 上小一个量级，<strong>在资源上有一定的节省</strong>。</p>
<h2 data-id="heading-4">Starrocks 中使用</h2>
<p>方式 ：</p>
<ul>
<li>在hive中根据使用场景构建完bitmap后导入starrocks</li>
<li>直接在starrocks中使用明细数据在物化视图中使用</li>
</ul>
<p>两者根据场景选择，第一种适用于查询场景固定且数据量巨大，可以降低starrocks的集群负载，</p>
<p>第二种属于直接在starrocks中进行计算构建，集群负载比第一种场景要高。</p>
<p><em><strong>hive中构建导入</strong></em></p>
<p>某个商品的订单数:</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 构建 hive bitmap 表</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> prd_tmp.bitmap_goods_ordr_test(
goods_code <span class="hljs-type">varchar</span>(<span class="hljs-number">16</span>),
bitmap_col <span class="hljs-type">binary</span>) <span class="hljs-keyword">using</span> orc;
 
<span class="hljs-comment">-- 数据写入</span>
 
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> prd_tmp.bitmap_goods_ordr_test
<span class="hljs-keyword">select</span>
  t1.goods_code
  ,bitmap_agg(t2.id_int) <span class="hljs-keyword">as</span> bitmap_col
  <span class="hljs-keyword">from</span>
  ordr_detl t1
  <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> prd_tmp.dict_test t2
  <span class="hljs-keyword">on</span> t1.sale_ordr_doc <span class="hljs-operator">=</span> t2.id
  <span class="hljs-keyword">where</span>  t2.id <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> <span class="hljs-keyword">and</span> t1.stat_date <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'20250710'</span> <span class="hljs-keyword">and</span> t1.stat_date<span class="hljs-operator">&lt;=</span><span class="hljs-string">'20251210'</span>
  <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> t1.goods_code
 
<span class="hljs-comment">-- sr 建表</span>
 <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> bitmap_goods_ordr_test(
goods_code <span class="hljs-type">varchar</span>(<span class="hljs-number">16</span>), bitmap_col bitmap bitmap_union)
aggregate key(goods_code) 
distributed <span class="hljs-keyword">by</span> hash(goods_code);
 
<span class="hljs-comment">-- 数据写入 方式有很多种这里使用 broker load</span>
LOAD LABEL rpt_db.bitmap_goods_ordr_test_1
(
    data infile("hdfs://xxxx:8020/warehouse/tablespace/managed/hive/prd_tmp.db/bitmap_goods_ordr_test/*")
    <span class="hljs-keyword">into</span> <span class="hljs-keyword">table</span> bitmap_goods_ordr_test
    format <span class="hljs-keyword">as</span> "orc"
)
<span class="hljs-keyword">WITH</span> BROKER
(
    "username" <span class="hljs-operator">=</span> "hdfs"
)
 
<span class="hljs-comment">-- starrocks 数据查询</span>
<span class="hljs-comment">-- bitmap_to_string(bitmap_col) 将 bitmap 转成字符串</span>
<span class="hljs-comment">-- bitmap_count 计算bitmap中的id个数</span>
 
<span class="hljs-keyword">select</span>  goods_code,bitmap_to_string(bitmap_col) <span class="hljs-keyword">as</span> c2,bitmap_count(bitmap_col) <span class="hljs-keyword">as</span> cnt 
<span class="hljs-keyword">from</span> bitmap_goods_ordr_test <span class="hljs-keyword">where</span> goods_code <span class="hljs-keyword">in</span> (<span class="hljs-string">'1000310'</span>,<span class="hljs-string">'1000324'</span>,<span class="hljs-string">'1000330'</span>);
</code></pre>
<p>c2 为转换后的 int 类型的订单ID
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4e56cbb620544dea29806ffaddc9773~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=XsjPhZywdh3CtW3WJJVdoJjl6F8%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<p><strong>Starrocks 中使用构建使用</strong></p>
<ul>
<li>创建明细表</li>
<li>创建字典表</li>
<li>替换或者关联字典表使用</li>
<li>使用 dit_mapping 函数， <code>版本 3.x 之后且不支持存算分离部署方式</code>
结合物化视图</li>
</ul>
<pre><code class="hljs language-sql" lang="sql">
```<span class="hljs-keyword">sql</span>
<span class="hljs-comment">-- 创建明细表</span>
 
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> ordr_detl (
store_code string,
goods_code string,
sale_ordr_doc string ,
int_sale_ordr_doc <span class="hljs-type">bigint</span> ,
dt <span class="hljs-type">date</span>
)
ENGINE<span class="hljs-operator">=</span>OLAP
DUPLICATE KEY(store_code,goods_code,sale_ordr_doc,dt)
<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">RANGE</span>(`dt`)()
 DISTRIBUTED <span class="hljs-keyword">BY</span> HASH(`store_code`) BUCKETS <span class="hljs-number">10</span>
PROPERTIES (
 "replication_num" <span class="hljs-operator">=</span> "3",
 "dynamic_partition.enable" <span class="hljs-operator">=</span> "true",
 "dynamic_partition.time_unit" <span class="hljs-operator">=</span> "DAY",
 "dynamic_partition.time_zone" <span class="hljs-operator">=</span> "Asia/Shanghai",
 "dynamic_partition.start" <span class="hljs-operator">=</span> "-180",
 "dynamic_partition.end" <span class="hljs-operator">=</span> "1",
 "dynamic_partition.prefix" <span class="hljs-operator">=</span> "p",
 "dynamic_partition.replication_num" <span class="hljs-operator">=</span> "3",
 "dynamic_partition.buckets" <span class="hljs-operator">=</span> "3",
 "in_memory" <span class="hljs-operator">=</span> "false"
);
 
<span class="hljs-comment">-- 示例查询</span>
<span class="hljs-keyword">select</span> stsc_mon , phmc_code , <span class="hljs-built_in">count</span>(<span class="hljs-keyword">DISTINCT</span> sale_ordr_doc)
<span class="hljs-keyword">from</span> ordr_detl <span class="hljs-keyword">where</span> dt <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'2025-07-01'</span>
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>  phmc_code,stsc_mon;
 
 
<span class="hljs-keyword">select</span> stsc_mon , phmc_code , bitmap_count(bitmap_union(to_bitmap(int_sale_ordr_doc)))
<span class="hljs-keyword">from</span> ordr_detl <span class="hljs-keyword">where</span> dt <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'2025-07-01'</span>
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>  phmc_code,stsc_mon;
</code></pre>
<p>耗时对比: 上述为 bitmap ， 下述为 count distinct <code>修正这里的耗时仅作为参考，bitmap_union(to_bitmap(int_sale_ordr_doc) ) 代表需要从整数构建成bitmap类型的过程，当基数较大时耗费的时间和CPU会很长，从而导致耗时比distinct更长，所以一般将该部分放在物化视图中进行构建，查询时之间使用</code></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d4a8f55f8554f40a263df5b61401971~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=J133DJaFEw5o8ajBidC4nNPN49A%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<p>在查询资源消耗上 bitmap 有很大的节省. [图片太大无法上传]</p>
<p><strong>使用场景分析</strong></p>
<ul>
<li>需要实时分析的场景+数据量较大的count去重分析+查询灵活多变：一般建议使用明细模型+物化视图+bitmap进行处理 灵活处理。</li>
<li>固定场景+离线分析：可以使用hive进行离线计算后导入使用，及预计算。</li>
</ul>
<h2 data-id="heading-5">物化视图</h2>
<p>分为<strong>同步物化视图</strong>和<strong>异步物化视图</strong></p>
<ul>
<li>同步物化视图
<ul>
<li>仅支持单表</li>
<li>同步刷新，无需人工操作</li>
<li>仅支持基于 default catalog 的单表构建</li>
<li>支持的聚合函数: min, max, hll_union, percentile_union, count, sum, bitmap_union</li>
</ul>
</li>
<li>异步物化视图
<ul>
<li>支持多表关联</li>
<li>异步更新，手动刷新</li>
<li>支持多表构建：Default catalog、external catalog (v2.5)、已有异步物化视图(v2.5)、已有视图（v3.1）</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 定义查询场景</span>
<span class="hljs-keyword">select</span> dt,phmc_code,<span class="hljs-built_in">count</span>(<span class="hljs-keyword">DISTINCT</span> int_sale_ordr_doc) ordr_cnt
<span class="hljs-keyword">from</span> ordr_detl
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> dt,phmc_code ;
 
<span class="hljs-comment">-- 构建物化视图</span>
<span class="hljs-keyword">CREATE</span> MATERIALIZED <span class="hljs-keyword">VIEW</span> store_ordr_cnt <span class="hljs-keyword">AS</span>
<span class="hljs-keyword">select</span> dt,phmc_code,bitmap_union(to_bitmap(int_sale_ordr_doc))  ordr_cnt
<span class="hljs-keyword">from</span> ordr_detl
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> dt,phmc_code ;
 
<span class="hljs-comment">-- 查看物化视图构建状态</span>
<span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">ALTER</span> MATERIALIZED <span class="hljs-keyword">VIEW</span>
 
<span class="hljs-comment">-- 取消正在构建的物化视图 12090 为 job ID 使用 【SHOW ALTER MATERIALIZED VIEW】 获取</span>
CANCEL <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">ROLLUP</span> <span class="hljs-keyword">FROM</span>  ordr_detl  (<span class="hljs-number">12090</span>);
 
<span class="hljs-comment">-- 删除构建完成的物化视图</span>
 
<span class="hljs-keyword">DROP</span> MATERIALIZED <span class="hljs-keyword">VIEW</span> store_amt;
</code></pre>
<p>构建状态：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80c8c4088bb54a7d962e96eded56f496~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=nfrYfgmxuojhpvrS4bdXvCdHjIs%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<p>之前的查询计划：【使用原表作为查询底表】
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9cbc3694ea64e4e8852b866bf4f3636~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=8mEt4Y%2B%2Feiwiw0Unjnj%2FjgYE2nM%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<p>构建完成后再次执行查看执行计划:【<strong>使用物化视图作为底表查询</strong>】</p>
<p>备注 在执行sql  SR 会根据已有的物化视图自动改写查询，如果匹配中有可用的物化视图则会</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">select</span> dt,phmc_code,<span class="hljs-built_in">count</span>(<span class="hljs-keyword">DISTINCT</span> int_sale_ordr_doc) ordr_cnt
<span class="hljs-keyword">from</span> ordr_detl
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> dt,phmc_code ;
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ab46e2ee209451b85f79621c1340838~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=5wv1c74GYbwNBw3FAaJvwLvRxVM%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<p>查看表结构会发现多出一个物化视图相关的信息：【DESC ordr_detl_flag ALL】
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ce84d0c0263487395a25d0c920f0a7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=BR%2FtzB5xkBY3kK2zrVSGYoVs2sU%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<h2 data-id="heading-6">异步物化视图</h2>
<ul>
<li>多表关联</li>
<li>手动调用、定时任务、或者自动触发刷新</li>
<li>支持部分分区刷新</li>
<li>支持更多的聚合算子</li>
</ul>
<p><strong>使用场景</strong>：</p>
<p><strong>数仓环境</strong>:</p>
<ul>
<li>加速重复聚合查询：大量可重复使用的子查询，占用大量资源</li>
<li>周期性多表关联查询：多表关联形成宽表，可以避免手动关联调度任务，设置定期刷新规则</li>
<li>数仓分层</li>
<li>湖仓加速：查询数据湖可能因为网络延迟或者对象存储吞吐限制变慢，构建物化视图固化</li>
</ul>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 查询示例 </span>
<span class="hljs-keyword">select</span> dt,phmc_code,ordr_sour_code ,<span class="hljs-built_in">count</span>(<span class="hljs-keyword">DISTINCT</span> sale_ordr_doc) ordr_cnt <span class="hljs-keyword">from</span> dwb_sd_so_ordr_detl_flag_d
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> dt,phmc_code,ordr_sour_code
 
DISTRIBUTED <span class="hljs-keyword">BY</span> HASH(`order_id`)
<span class="hljs-keyword">CREATE</span> MATERIALIZED <span class="hljs-keyword">VIEW</span> order_mv
REFRESH ASYNC <span class="hljs-keyword">START</span>(<span class="hljs-string">'2022-09-01 10:00:00'</span>) <span class="hljs-keyword">EVERY</span> (<span class="hljs-type">interval</span> <span class="hljs-number">1</span> <span class="hljs-keyword">day</span>)
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">select</span> dt,phmc_code,ordr_sour_code ,bitmap_union(to_bitmap(int_sale_ordr_doc)) ordr_cnt <span class="hljs-keyword">from</span> dwb_sd_so_ordr_detl_flag_d
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> dt,phmc_code,ordr_sour_code
</code></pre>
<p>查看异步视图执行状态：</p>
<p>查看 tasks 表中的最新任务 <code>select * from information_schema.tasks order by CREATE_TIME desc limit 1;</code>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33d7b2eebe39434b9907dca519791830~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=z70UpOTl85vdvyQzd6D1uAzNHUQ%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<p>查看 在 task_runs 表中的执行状态 <code>select * from information_schema.task_runs where task_name='mv-10647552' order by CREATE_TIME;</code>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d08f439409ba4ef988b9eb756075e906~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=H5skegcsILu%2FmbhGxzBhQFewKTQ%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<p>手动刷新异步视图 <code>REFRESH MATERIALIZED VIEW order_mv;</code></p>
<p><strong>实际使用:</strong></p>
<p>基于 异步视图 order_mv 测试</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 查询语句在 ordr_mv 的子集中 SR 自动改写使用了 物化视图</span>
 
<span class="hljs-keyword">select</span> phmc_code,ordr_sour_code,<span class="hljs-built_in">count</span>(<span class="hljs-keyword">DISTINCT</span> int_sale_ordr_doc) ordr_cnt <span class="hljs-keyword">from</span> ordr_detl
<span class="hljs-keyword">where</span> dt <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'2025-10-01'</span>
<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> phmc_code,ordr_sour_code
</code></pre>
<p>explain 如下:  count distinct 也转成了 bitmap 操作</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aef22c5941b44227b51e7555c3a0faf1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCPQzgwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571470&amp;x-signature=SjzwexWnZSdUiV%2FxAY9PqjjQO%2B8%3D" alt="在这里插入图片描述" loading="lazy"/></p>
<p><strong>可以将物化视图看成一张物理表，索引、分区、分桶等优化操作都可执行，具体参考官网 ： <code>https://docs.starrocks.io/zh/docs/3.5/sql-reference/sql-statements/materialized_view/CREATE_MATERIALIZED_VIEW/</code></strong></p>
<h2 data-id="heading-7">性能虽好合理使用：</h2>
<p><strong>优点：</strong></p>
<ul>
<li>提升响应速度，优化查询性能</li>
<li>优化任务分层逻辑</li>
</ul>
<p><strong>不足：</strong></p>
<ul>
<li>人工配置，维护成本高</li>
<li>异步视图，定时刷新，难以保证数据的强一致性</li>
<li>过多的物化视图导致集群压力过大，维护困难</li>
<li>物化视图空间换时间，存储成本增加</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Google全链路赋能出海：3人团队调度千个智能体，可成独角兽｜MEET2026]]></title>    <link>https://juejin.cn/post/7584639987212845090</link>    <guid>https://juejin.cn/post/7584639987212845090</guid>    <pubDate>2025-12-17T10:20:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584639987212845090" data-draft-id="7584633505105362996" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Google全链路赋能出海：3人团队调度千个智能体，可成独角兽｜MEET2026"/> <meta itemprop="keywords" content="AIGC,AI编程"/> <meta itemprop="datePublished" content="2025-12-17T10:20:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="量子位"/> <meta itemprop="url" content="https://juejin.cn/user/2858385963484488"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Google全链路赋能出海：3人团队调度千个智能体，可成独角兽｜MEET2026
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2858385963484488/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    量子位
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:20:41.000Z" title="Wed Dec 17 2025 10:20:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>未来应该是智能体之间自主协同，解决复杂问题、自动化工作流程、自主下达任务，创建一种全新的商业模式。</p>
</blockquote>
<p>在量子位 MEET2026 智能未来大会上 Google Cloud 大中华区企业与中国初创业务负责人 Dennis Yue 分享了一个与技术本身同样重要的命题：AI 智能体作为新的生产力单元，正在为初创企业的出海逻辑注入新的内涵。</p>
<p>这不仅是对技术趋势的判断，也是对创业范式转移的思考。当 3 到 10 人的团队可以调度成百上千个智能体，当智能体与智能体之间能够跨企业自主通信，创业公司的边界、人效比、商业模式都将被重新定义。</p>
<p>在 Dennis 看来，<strong>智能体赛道才刚刚开始，未来一两年会经历剧烈变化，这也是中国初创企业出海的重大机遇窗口</strong>。</p>
<p>面对这一机遇与挑战，谷歌推出了 AI 驱动的一体化解决方案，全链路赋能初创企业高效出海。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3245d5434cce433ea8a0d74b5fa84630~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YeP5a2Q5L2N:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571640&amp;x-signature=n0fQ5B9z0CjNXxX82g3JmW8hKrw%3D" alt="" loading="lazy"/></p>
<p><em>MEET2026 智能未来大会是由量子位主办的行业峰会，近 30 位产业代表与会讨论。线下参会观众近 1500 人，线上直播观众 350 万 +，获得了主流媒体的广泛关注与报道。</em></p>
<h2 data-id="heading-0">核心观点</h2>
<ul>
<li>
<p>初创企业在全球化过程中面临不同侧重点与挑战，Google 的全链路生态在每一阶段都可以为初创企业助力，赋能高效出海。</p>
</li>
<li>
<p>Gemini 3 是一次真正的突破，在多个权威榜单中排名第一，标志着从 “辅助工具” 向“自主智能体”的跨越。</p>
</li>
<li>
<p>谷歌主导推出了 A2A 协议（Agent-to-Agent Protocol，智能体间通信协议），旨在打通跨企业、跨系统的智能体协同。</p>
</li>
<li>
<p>商业模式正在从 SaaS 按月订阅转向 Outcome-based 按结果付费，这是智能体时代的底层逻辑变化。</p>
</li>
<li>
<p>3 到 10 人的初创团队完全可能通过调度大量智能体成长为独角兽，但需要重视数据壁垒、行业深度集成以及法律合规。</p>
</li>
</ul>
<h2 data-id="heading-1">初创出海的五个阶段与 Google 全链路解决方案</h2>
<p>在演讲开篇，Dennis 系统梳理了初创企业出海的五个阶段，以及谷歌在每个阶段能够提供的支持。</p>
<p>第一阶段是萌芽与战略规划期。 创始人刚刚有了初步想法，需要进行大量信息收集和竞品分析。Dennis 观察到，很多创始人会使用 Gemini 进行市场调研，因为它储存了海量资料，能够辅助完成从市场洞察到 MVP（最小可行产品）的整个流程。</p>
<p>第二阶段是产品推出期。 当第一个产品成型并准备推向市场时，Google Cloud 平台可以提供稳定的云基础设施支撑。</p>
<p>第三阶段是首个市场验证期。 找到第一批客户是从 0 到 1 破局的关键，此时 Google Ads 团队可以帮助初创公司，通过高效的广告渠道触达目标客户群体。</p>
<p>第四阶段是多市场扩张期。 当第一个市场站稳脚跟、准备拓展第二个市场时，Google Play、Google AdMob/AdSense、Google Maps 等产品都可以提供协同支持。</p>
<p>第五阶段是 IPO 成熟期。 公司进入持续迭代和规模化增长阶段，谷歌的数据分析工具和周边服务可以助力企业完成上市前的最后冲刺。</p>
<p>Dennis 还谈到了大模型领域的共同难题：幻觉（Hallucination，即模型生成不准确或虚构的信息）。</p>
<p>解决路径包括更好的模型训练、更好的工程化实践、以及引导客户侧进行更好的上下文工程。配合 Gemini 本身强大的原生推理能力，幻觉问题正在逐步得到缓解。</p>
<p>Dennis 认为，未来一年整个 AI 领域会继续快速演进。对于初创公司而言，无论产品是刚刚起步还是已经上路，都应该认真思考如何将智能体协同、上下文工程、按结果付费等新概念融入自身业务。 </p>
<p>“我认为 AI 智能体才刚刚开始，未来一两年变化会非常大。如果通过智能体这个赛道出海，现在是值得认真考虑的时机。”</p>
<p>Google 全链路生态，高效驱动出海创业增长，欢迎扫描文末二维码，了解更多 Google 出海解决方案。</p>
<h2 data-id="heading-2">Gemini 的进化：从初具雏形到全面领先</h2>
<p>谈及对中国出海初创企业的赋能，Dennis 回顾了 Gemini 的成长历程。</p>
<p>两年多前，谷歌将 Google Brain 与 DeepMind 两大 AI 团队合并，在极短时间内推出了 Gemini 1。</p>
<p>Gemini 1 作为第一个原生多模态模型，已经开始帮助一批初创公司开展业务。</p>
<p>到了 1.5 和 2 版本，Gemini 经历了质的提升，推理能力、理解能力和问题解决能力都有了显著增强。<strong>而 2025 年 11 月发布的 Gemini 3，则全面超越了前两代产品</strong>。这一版本基于此前迭代积累的经验进行了重构，在多个权威评测榜单中拿下第一名，引发了行业媒体的广泛报道。</p>
<p>为什么 Gemini 3 是一次突破？Dennis 认为，这几年 AI 发展出了两条路径：一条是智能体（Agent），另一条是代理式 AI（Agentic AI）。他在与初创公司的交流中发现，已经有团队成功地将智能体产品化，转化为真实的 ARR（年度经常性收入）和 ACV（年度合同价值）。</p>
<p><strong>智能体不再是概念，而是具备真实变现能力的应用。</strong></p>
<h2 data-id="heading-3">A2A 协议：打通智能体之间的 “语言”</h2>
<p>当单个企业内部的智能体逐渐成熟，一个更棘手的问题浮出水面：不同企业的智能体之间如何有效通信？</p>
<p>企业内部的智能体相对容易连接，通过编写提示词（Prompt）或配置工作流就能实现协同。<strong>但当一个企业的智能体需要与另一个企业的智能体对话时，就缺乏统一的标准和协议。</strong></p>
<p>为此，谷歌主导推出了 A2A 协议（Agent-to-Agent Protocol）。这一协议的核心目标是让智能体之间能够自主协同、自主下达任务、自主执行工作流程。</p>
<p>可以想象这样一幅图景：每一个节点代表企业内部不同部门的智能体，或者代表不同企业的智能体，甚至是企业外部的第三方智能体。如果为每个智能体定义好功能层面的 API（应用程序接口），这些 API 就可以被复用，智能体之间就能跨界协同。在特定场景或问题面前，它们可以自主请求其他智能体提供方案，再通过 AI 算法做出最优选择。</p>
<p><strong>A2A 协议不是谷歌的独角戏。</strong> 埃森哲、Salesforce、麦肯锡等全球顶级咨询公司，SAP 等传统 ERP 厂商，以及众多知名科技公司都已开始拥抱这一协议。谷歌正在推动将 A2A 全球化，让智能体之间的通信基于统一标准进行。</p>
<p>除了通信协议，商业世界还需要解决信任和支付问题。为此，谷歌又提出了 AP2 协议（Agent Payment Protocol，智能体支付协议）。这一协议已获得传统金融机构和新兴金融科技公司的广泛支持，目标是让智能体之间的交易不被锁定在某个单一支付系统中，而是基于多方共识形成高信任度的支付网络。</p>
<h2 data-id="heading-4">商业模式之变：从 SaaS 订阅到按结果付费</h2>
<p>Dennis 在与大量创业者交流后观察到，智能体时代正在催生商业模式的根本性变化。</p>
<p>**旧生态的典型形态是 SaaS（软件即服务）：**B2B 公司以按月订阅的方式，帮助企业解决特定功能需求。这更像是一个助手模式，帮你写邮件、帮你安排会议，按时间收费。</p>
<p>**新生态的核心逻辑是 Outcome-based（按结果付费）：**智能体不仅帮你写邮件，还帮你成功约到客户、安排好视频会议。你为最终结果付费，而不是为过程中的动作付费。这种模式已经开始在市场上出现，甚至逐渐成为竞争中的差异化卖点。</p>
<p>这种转变带来了一个令人振奋的可能性：**3 到 10 人的初创公司可以成长为独角兽。**因为在智能体时代，每个员工都可以调度十个、一百个、甚至一千个智能体。繁重的执行工作由智能体完成，人类专注于战略决策和系统优化。</p>
<p>但 Dennis 也提醒，新模式下的护城河正在发生变化。以往，漂亮的 UI（用户界面）和良好的用户体验是竞争壁垒；现在，<strong>真正的护城河来自与传统行业的深度集成，以及独有的专有数据。</strong></p>
<p>同时，智能体自主决策也带来了新的风险：如果智能体犯错，赔偿责任如何界定？不同国家对此有不同的法律规定。这是初创公司在出海时必须认真考量的问题。</p>
<h2 data-id="heading-5">Gemini 3 的三大能力与工程化思维</h2>
<p>在技术层面，Dennis 介绍了 Gemini 3 的几个关键能力。</p>
<p><strong>第一是超长上下文窗口，支持 100 万 Token。</strong></p>
<p>过去大家关注的是 Prompt Engineering（提示词工程），现在更重要的是 Context Engineering（上下文工程）。如果丢给智能体的信息未经整理和结构化处理，即便模型再强大，输出的结果也不会足够智能。</p>
<p><strong>第二是原生多模态能力。</strong></p>
<p>Gemini 3 可以像理解文字一样理解视频、图像和语音，且清晰度和准确度大幅提升。</p>
<p><strong>第三是 Function Calling（精准工具调用）能力。</strong></p>
<p>这让智能体开始 “长出手脚”，能够调用外部工具和服务。配合 Vertex AI、Agent Builder 等工程化平台，开发者可以构建更加智能、更加专业化的智能体。</p>
<p>Dennis 特别强调，Gemini 3 是我们迄今为止最安全的模型，并且接受了 Google AI 模型中最全面的一套安全评估。</p>
<p>对 Google 全链路出海解决方案感兴趣的中国出海初创企业可以扫码进一步了解。</p>
<p><strong>欢迎在评论区留下你的想法！</strong></p>
<p>— <strong>完</strong> —</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[改了CSS刷新没反应-你可能不懂HTTP缓存]]></title>    <link>https://juejin.cn/post/7584650421124333609</link>    <guid>https://juejin.cn/post/7584650421124333609</guid>    <pubDate>2025-12-17T10:24:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584650421124333609" data-draft-id="7584443518037033023" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="改了CSS刷新没反应-你可能不懂HTTP缓存"/> <meta itemprop="keywords" content="前端,JavaScript,面试"/> <meta itemprop="datePublished" content="2025-12-17T10:24:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="也无风雨也雾晴"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            改了CSS刷新没反应-你可能不懂HTTP缓存
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    也无风雨也雾晴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:24:20.000Z" title="Wed Dec 17 2025 10:24:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">改了 CSS 刷新没反应？你可能不懂 HTTP 缓存</h2>
<p>做前端的应该都遇到过这种情况：明明改了 CSS，浏览器里看到的还是旧样式。网上搜一下，告诉你"清缓存"，Ctrl+F5 一刷新就好了。</p>
<p>但问题是：</p>
<ul>
<li>缓存到底是怎么工作的？</li>
<li>为什么有时候会用缓存，有时候不会？</li>
<li>Network 面板里的 <code>(disk cache)</code> 和 <code>304 Not Modified</code> 有什么区别？</li>
</ul>
<p>今天把这个问题彻底搞清楚。</p>
<h3 data-id="heading-1">HTTP 缓存的两层机制</h3>
<p>浏览器缓存分两层：<strong>强缓存</strong>和<strong>协商缓存</strong>。</p>
<p>简单说：</p>
<ul>
<li><strong>强缓存</strong>：直接用本地缓存，不问服务器</li>
<li><strong>协商缓存</strong>：问一下服务器"我这个还能用吗？"服务器说"能"，就用缓存</li>
</ul>
<pre><code class="hljs language-csharp" lang="csharp">浏览器想请求资源
    │
    ▼
检查本地缓存
    │
    ├── 有缓存且没过期 → 强缓存命中 → 返回 <span class="hljs-number">200</span> (<span class="hljs-keyword">from</span> cache)
    │
    └── 没缓存 / 过期了
            │
            ▼
        发请求给服务器，带上验证信息
            │
            ├── 服务器说没变 → 协商缓存命中 → 返回 <span class="hljs-number">304</span>
            │
            └── 服务器说变了 → 返回 <span class="hljs-number">200</span> + 新资源
</code></pre>
<h3 data-id="heading-2">强缓存：完全不发请求</h3>
<p>强缓存命中时，浏览器直接从本地拿资源，Network 面板会显示：</p>
<ul>
<li><strong>Size</strong> 列：<code>(disk cache)</code> 或 <code>(memory cache)</code></li>
<li><strong>Time</strong> 列：<code>0ms</code> 或很小的数字</li>
</ul>
<p>控制强缓存的响应头：</p>
<pre><code class="hljs language-http" lang="http"># 方式1：Cache-Control（推荐）
Cache-Control: max-age=31536000

# 方式2：Expires（老方式，优先级低于 Cache-Control）
Expires: Wed, 21 Oct 2025 07:28:00 GMT
</code></pre>
<p><code>max-age=31536000</code> 意思是"这个资源 31536000 秒（一年）内有效"。</p>
<h4 data-id="heading-3">memory cache vs disk cache</h4>
<p>两者区别：</p>























<table><thead><tr><th>类型</th><th>存储位置</th><th>速度</th><th>什么时候用</th></tr></thead><tbody><tr><td>memory cache</td><td>内存</td><td>最快</td><td>当前会话、小文件、频繁访问的资源</td></tr><tr><td>disk cache</td><td>硬盘</td><td>稍慢</td><td>跨会话、大文件</td></tr></tbody></table>
<p>关了浏览器 Tab，memory cache 就没了，disk cache 还在。</p>
<h3 data-id="heading-4">协商缓存：问一下服务器</h3>
<p>当强缓存过期（或被设置为 <code>no-cache</code>），浏览器会发请求给服务器验证资源是否变化。</p>
<p>有两种验证方式：</p>
<h4 data-id="heading-5">方式1：ETag / If-None-Match（推荐）</h4>
<p>基于内容哈希：</p>
<pre><code class="hljs language-http" lang="http"># 第一次请求，服务器返回
HTTP/1.1 200 OK
ETag: "abc123"
Cache-Control: no-cache

# 后续请求，浏览器带上 If-None-Match
GET /style.css HTTP/1.1
If-None-Match: "abc123"

# 如果内容没变，服务器返回
HTTP/1.1 304 Not Modified
ETag: "abc123"

# 如果内容变了，服务器返回
HTTP/1.1 200 OK
ETag: "xyz789"
[新的文件内容]
</code></pre>
<h4 data-id="heading-6">方式2：Last-Modified / If-Modified-Since</h4>
<p>基于修改时间：</p>
<pre><code class="hljs language-http" lang="http"># 第一次请求，服务器返回
HTTP/1.1 200 OK
Last-Modified: Wed, 21 Oct 2024 07:28:00 GMT

# 后续请求，浏览器带上 If-Modified-Since
GET /style.css HTTP/1.1
If-Modified-Since: Wed, 21 Oct 2024 07:28:00 GMT

# 如果文件没改过，服务器返回 304
</code></pre>
<h4 data-id="heading-7">ETag vs Last-Modified</h4>
<p>优先用 ETag，因为 Last-Modified 有问题：</p>
<ol>
<li><strong>精度只到秒</strong> - 1 秒内改多次，检测不到</li>
<li><strong>时间可能不准</strong> - 服务器时间、部署时间等问题</li>
<li><strong>只看时间不看内容</strong> - 文件内容没变但时间变了，也会重新下载</li>
</ol>
<h3 data-id="heading-8">不同资源该用什么策略？</h3>
<h4 data-id="heading-9">静态资源（JS/CSS/图片）</h4>
<pre><code class="hljs language-http" lang="http">Cache-Control: max-age=31536000, immutable
</code></pre>
<p>配合文件名哈希：<code>app.abc123.js</code></p>
<p>内容变了 → 文件名变了 → 请求新文件，老文件继续用缓存。</p>
<p>这是现代前端打包工具（Webpack、Vite）的标准做法。</p>
<h4 data-id="heading-10">HTML 文件</h4>
<pre><code class="hljs language-http" lang="http">Cache-Control: no-cache
ETag: "page-v1"
</code></pre>
<p><code>no-cache</code> 不是"不缓存"，而是"每次都要验证"。HTML 文件要保证用户能拿到最新版本，否则会引用旧的 JS/CSS 文件名。</p>
<h4 data-id="heading-11">API 接口</h4>
<p>根据数据特性选择：</p>
<pre><code class="hljs language-http" lang="http"># 几乎不变的数据（如配置）
Cache-Control: max-age=3600

# 实时性要求高的数据
Cache-Control: no-cache

# 敏感数据（不要缓存）
Cache-Control: no-store
</code></pre>
<p><code>no-store</code> 才是真正的"不缓存"，连验证都不做。</p>
<h3 data-id="heading-12">常见问题排查</h3>
<h4 data-id="heading-13">改了文件，浏览器没反应</h4>
<p>原因：强缓存还没过期。</p>
<p>解决方案：</p>
<ol>
<li><strong>开发环境</strong> - 打开 DevTools，勾选 "Disable cache"</li>
<li><strong>生产环境</strong> - 用文件名哈希，别用 <code>?v=1.0</code> 这种</li>
</ol>
<h4 data-id="heading-14">用了 ?v=1.0 还是不行</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/css/style.css?v=1.0"</span>&gt;</span>
</code></pre>
<p>问题：有些 CDN 会忽略查询参数，或者浏览器缓存策略不一致。</p>
<p>正确做法：</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/css/style.abc123.css"</span>&gt;</span>
</code></pre>
<p>让打包工具自动生成哈希，内容变了文件名才变。</p>
<h4 data-id="heading-15">CDN 缓存了旧文件</h4>
<p>部署了新版本，但用户还是拿到旧文件。</p>
<p>原因：CDN 节点还在缓存期内。</p>
<p>解决方案：</p>
<ol>
<li>部署时清除 CDN 缓存</li>
<li>用文件名哈希（CDN 会认为是新文件）</li>
</ol>
<h3 data-id="heading-16">Nginx 配置参考</h3>
<pre><code class="hljs language-nginx" lang="nginx"># 静态资源长期缓存
location ~* \.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}

# HTML 文件协商缓存
location ~* \.html$ {
    add_header Cache-Control "no-cache";
    etag on;
}

# API 不缓存
location /api/ {
    add_header Cache-Control "no-store";
}
</code></pre>
<h3 data-id="heading-17">快速判断缓存类型</h3>
<p>打开 DevTools Network 面板：</p>






























<table><thead><tr><th>看到什么</th><th>缓存类型</th><th>含义</th></tr></thead><tbody><tr><td>200 + <code>(disk cache)</code></td><td>强缓存</td><td>从硬盘读取</td></tr><tr><td>200 + <code>(memory cache)</code></td><td>强缓存</td><td>从内存读取</td></tr><tr><td>304 Not Modified</td><td>协商缓存</td><td>服务器说没变</td></tr><tr><td>200 + 正常大小</td><td>无缓存</td><td>重新下载</td></tr></tbody></table>
<h3 data-id="heading-18">一句话总结</h3>
<ul>
<li><strong>强缓存</strong>：不问服务器，直接用。适合长期不变的静态资源。</li>
<li><strong>协商缓存</strong>：问服务器，没变就用缓存。适合需要保持最新的内容。</li>
<li><strong>文件名哈希</strong>：解决缓存更新问题的银弹。</li>
</ul>
<hr/>
<p>如果你觉得这篇文章有帮助，欢迎关注我的 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i" target="_blank" title="https://github.com/tt-a1i" ref="nofollow noopener noreferrer">GitHub</a>，下面是我的一些开源项目：</p>
<p><strong>Claude Code Skills</strong>（按需加载，意图自动识别，不浪费 token，<a href="https://juejin.cn/post/7578714735307735066" target="_blank" title="https://juejin.cn/post/7578714735307735066">介绍文章</a>）：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">code-review-skill</a> - 代码审查技能，覆盖 React 19、Vue 3、TypeScript、Rust 等约 9000 行规则（<a href="https://juejin.cn/post/7578709098255908902" target="_blank" title="https://juejin.cn/post/7578709098255908902">详细介绍</a>）</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2F5-whys-skill" target="_blank" title="https://github.com/tt-a1i/5-whys-skill" ref="nofollow noopener noreferrer">5-whys-skill</a> - 5 Whys 根因分析，说"找根因"自动激活</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Ffirst-principles-skill" target="_blank" title="https://github.com/tt-a1i/first-principles-skill" ref="nofollow noopener noreferrer">first-principles-skill</a> - 第一性原理思考，适合架构设计和技术选型</li>
</ul>
<p><strong>全栈项目</strong>（适合学习现代技术栈）：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fprompt-vault" target="_blank" title="https://github.com/tt-a1i/prompt-vault" ref="nofollow noopener noreferrer">prompt-vault</a> - Prompt 管理器，用的都是最新的技术栈，适合用来学习了解最新的前端全栈开发范式：Next.js 15 + React 19 + tRPC 11 + Supabase 全栈示例，clone 下来配个免费 Supabase 就能跑</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fchat_edit" target="_blank" title="https://github.com/tt-a1i/chat_edit" ref="nofollow noopener noreferrer">chat_edit</a> - 双模式 AI 应用（聊天+富文本编辑），Vue 3.5 + TypeScript + Vite 5 + Quill 2.0 + IndexedDB</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[快速构建企业 AI 开放平台，HiMarket 重磅升级]]></title>    <link>https://juejin.cn/post/7584659460245930003</link>    <guid>https://juejin.cn/post/7584659460245930003</guid>    <pubDate>2025-12-17T10:26:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584659460245930003" data-draft-id="7584443518163615780" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="快速构建企业 AI 开放平台，HiMarket 重磅升级"/> <meta itemprop="keywords" content="云原生"/> <meta itemprop="datePublished" content="2025-12-17T10:26:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="阿里云云原生"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            快速构建企业 AI 开放平台，HiMarket 重磅升级
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    阿里云云原生
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:26:26.000Z" title="Wed Dec 17 2025 10:26:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>本文作者：赵恒、岛风、文想、彦林、于怀2025 是 Agent 元年，企业开始大规模落地 Agent，都会遇到多 Agent 管理，多 MCP 工具管理，多模型管理问题，如何查找和选择合适的 Agent/MCP/Model？哪些高频场景可以快速让所有人参与？多个团队如何协同，权限如何管理，成本如何分摊？</p>
<p>为了解决这些挑战，阿里巴巴升级 AI 开放平台 HiMarket，基于阿里巴巴内部 IdeaLAB，扩展 AI 开放平台的能力，推出 v0.5.0 版本，<strong>提供 Agent/MCP/Model 市场能力，提供基于 Chat 的高频使用场景，提供账号权限管理和成本分摊能力。</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e4cc6dcce1d44e98ccea2903f4ae066~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=YnmhmYVYmj3CQjedUd2ghxprgKk%3D" alt="BB584FD1-A8C3-4F31-8338-910BA4BB8499.png" loading="lazy"/></p>
<h2 data-id="heading-0">HiMarket 是什么</h2>
<p>HiMarket 是开源的 AI 开放平台，帮助企业快速构建 Agent 市场，释放 AI 创新潜能。对企业全员提供高频 AI 场景，释放 AI 创新潜能；为开发者提供 Agent 市场/MCP 市场/Model 市场，提升研发效能；为维护者提供 AI 治理能力，提升 AI 把控力。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c71ab916fc4141f993a7cc3153e7abe7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=rrV0ugC%2BY0pL4JiE53I7VPQ05nI%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">使用场景</h2>
<h3 data-id="heading-2">AI 场景（面对企业员工）</h3>
<p>HiMarket 提供了 HiChat 能力，通过 Chat 模式替代搜索，做市场调研和产品调研，生成运营图片等工作。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5d77eb3517f49b08e35f2601e412d05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=T1UXNe2dc45bRyjV8XeQl2TbJkw%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>企业全员 AI 使用入口</strong>：通过 HiMarket AI 开放平台，同时解决了员工不知道用哪些模型，企业如何管控员工用模型的两个问题；全员可以通过这个入口进行使用 AI 模型能力，企业可以进行整体安全合规审核，保证企业和员工使用 AI 范围安全可控。</li>
<li><strong>多模型对比</strong>：可以选择多个模型市场的模型，输入一次对比多个模型，快速直接对比模型返回内容差异，选取最优内容。</li>
<li><strong>会话历史记录</strong>：方便员工管理历史会话记录，可以快速基于历史信息进行对话回溯，并且计划后续基于对话可以形成知识点，知识点可以进行横向传递，提升数据共享效率。</li>
<li><strong>联网搜索</strong>：通过体验中心可以支持配置联网搜索能力，配置 Higress AI 网关联网搜索能力之后，所有模型都可以支持联网搜索，AI 网关会把对应搜索内容传递给模型使用摘取，扩大实时数据能力。</li>
<li><strong>支持关联 MCP 工具</strong>：体验中心聊天框支持关联 MCP 市场，可以实时快速的使用 MCP 能力，可以快速体验验证 MCP 本身能力情况，并且支持企业原本 API 快速配置化转换成 MCP 协议，结合模型做快速验证。</li>
</ul>
<h3 data-id="heading-3">AI 市场（面对开发者）</h3>
<p>HiMarket 支持构建涵盖 Agent、MCP Server、Model 的完整 AI 市场，让企业的各类 AI 资源不再分散，而是以标准化方式汇聚在一个平台上。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5b53549f1f54eda87997e9280a31483~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=ARsw05IOiqCHoLgl5JdSfii%2F0yg%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>Agent 市场</strong>：支持将复杂的 AI Agent 应用打包上架，可对接 AgentScope 等 Agent 开发平台，例如通过 AgentScope 构建的 Agent 可一键注册到 HiMarket，其他开发者订阅后即可直接使用，无需从零搭建；支持跨框架、跨语言的 agent 一键发布到 Agent 市场。</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4207d39a8b064864aee33fecfa09bc01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=VBf8dWb0FNEsacYKcRWCLnAzIss%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>MCP 市场</strong>：支持接入不同平台的 MCP Server，并支持将外部 API 转换为标准化的 MCP Server，开发者订阅后，即可让 AI 应用轻松调用外部能力。</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbc913cb2745434e8ee8b3c925978091~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=FwANgRUj77A0%2FMihW%2FsW4dmuOD4%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>模型市场</strong>：支持公有云模型及企业自研私有模型的快速接入，平台以 Higress 作为模型服务的网关代理，提供内容安全、Token 限流等防护能力，保障模型服务对外开放的安全合规。</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d9888e1541243b7838c754a4edeb0ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=gc9jrg9vzRuEXk1zBm%2FAOwPff9E%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>AI 资产生命周期管理</strong>：管理员将资源接入平台，配置访问策略和使用文档，发布上架；开发者在门户浏览、订阅、获取调用凭证即可订阅使用。</li>
</ul>
<h3 data-id="heading-4">AI 治理（面对 AI 维护者）</h3>
<p>HiMarket 实现了对 AI 资源的集中式治理，提供全方位的安全管控和协作能力：</p>
<ul>
<li><strong>安全合规保障</strong>：通过 Higress 网关统一管控所有 AI 资源的访问，支持内容安全检测、敏感信息过滤、访问权限控制，确保企业 AI 能力对外开放时符合安全合规要求。</li>
<li><strong>高效协作共享</strong>：打破团队间的“能力孤岛”，一个模型或工具接入后，可被多个部门订阅复用，避免重复采购和重复开发。</li>
<li><strong>降低使用门槛</strong>：开发者无需逐一对接不同厂商的 API，HiMarket 提供统一的协议标准和开箱即用的调用凭证，大幅降低接入成本，让团队更专注于业务创新而非基础设施搭建。</li>
</ul>
<h2 data-id="heading-5">产品优势</h2>
<h3 data-id="heading-6">企业级能力</h3>
<p>HiMarket 内置完善的企业级管理能力，确保 AI 资源的安全开放与高效运营。</p>
<ul>
<li><strong>产品管理</strong>：管理员可为不同 API 产品配置独立的认证鉴权和可见性策略，同时提供流量控制、IP 白名单等防护能力，保障服务安全稳定。</li>
<li><strong>观测分析</strong>：提供管理员视角的全局观测大盘，展示 AI API 的调用趋势、热门产品排行、异常流量预警等，支持按时间、产品类型、开发者等维度进行多维分析，为企业运营优化提供数据依据。</li>
<li><strong>计量计费</strong>：支持基于 Token、调用次数等多种计量模式，自动统计资源消耗并生成账单明细，既能服务企业内部的成本核算，也能支撑对外商业化运营。</li>
<li><strong>版本管理</strong>：支持 API 产品的多版本并行，管理员可以发布新版本、维护旧版本并平滑迁移用户，通过版本对比、灰度发布、快速回滚等功能，确保产品迭代的安全稳定。</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2d59b45cba94fd2910f81d2fa8c24a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=2x9bm4MpE2iLfGSr4IwAjrv16ic%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-7">丰富观测能力</h3>
<p>观测分析（目前 v0.5.0 版本依赖阿里云商业化 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.aliyun.com%2Fproduct%2Fsls%3Fspm%3Da1z389.11499242.0.0.65452413PLWe13%26utm_content%3Dg_1000408139" target="_blank" title="https://www.aliyun.com/product/sls?spm=a1z389.11499242.0.0.65452413PLWe13&amp;utm_content=g_1000408139" ref="nofollow noopener noreferrer">SLS</a>，开源版本的观测分析实现计划在后续版本中提供）：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/518f976e75e04e21a4678c55609f05d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=z72oV2gq5252xG7MbIbGsBuoFjg%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">灵活扩展能力</h3>
<p>为了能够快速对接企业现有的系统，HiMarket 提供了灵活的定制能力，包括：</p>
<ul>
<li><strong>门户品牌</strong>：管理员可为门户配置自定义域名、Logo、主题色、布局样式等元素，并灵活配置首页模块、产品分类、推荐栏等功能区域。</li>
<li><strong>身份认证</strong>：支持内置账号密码和企业 OIDC 认证方式，可与企业 SSO、IDaaS 等身份系统无缝集成，实现统一的用户管理和身份认证。</li>
<li><strong>审批流程</strong>：开发者注册、凭证申请、API 订阅等关键流程可灵活配置自动或人工审批。</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/752c1b918c074137993e97043f8d5e89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=ddBJO9VG5%2F7jt70v%2BlVhT1Ee47Y%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-9">快速体验</h2>
<p>HiMarket 提供多种部署方式，满足不同场景需求：</p>
<ul>
<li>本地快速体验：HiMarket 本地部署指南 <strong>[</strong> <strong>1]</strong> 。</li>
<li>Docker Compose 部署：HiMarket Docker 部署指南 <strong>[</strong> <strong>2]</strong> 。</li>
<li>Kubernetes 部署：HiMarket Helm 部署指南 <strong>[</strong> <strong>3]</strong> 。</li>
</ul>
<h3 data-id="heading-10">一键部署，开箱即用的完整方案</h3>
<p>HiMarket、Higress、Nacos 三大组件自动编排部署，无需人工干预。部署过程自动完成示例 MCP Server 的注册、配置和发布，让你在部署完成后即可体验 HiMarket 能力市场。无论是 Docker Compose 还是 Kubernetes 部署，均只需一条命令：</p>
<pre><code class="hljs language-bash" lang="bash">./deploy.sh install
</code></pre>
<p>部署脚本会自动完成以下所有工作：</p>
<ul>
<li><strong>核心组件部署</strong>：自动拉起 MySQL、Nacos 配置中心、Higress 网关服务</li>
<li><strong>应用本体部署</strong>：部署 HiMarket 全套服务（管理后台、开发者门户、后端服务）</li>
<li><strong>智能初始化</strong>：自动创建管理员账号、配置示例 MCP Server、发布演示 API 产品</li>
<li><strong>即开即用</strong>：部署完成后即可访问管理后台和开发者门户，无需任何手动配置</li>
</ul>
<p>方案支持灵活的场景适配：</p>
<ul>
<li>支持使用内置 MySQL 或对接已有数据库</li>
<li>支持使用阿里云商业化 MSE 服务和 AI 网关服务</li>
<li>支持 ./deploy.sh himarket-only<code> </code>仅部署 HiMarket 本体</li>
</ul>
<p>详细步骤请参考：HiMarket Docker 一键部署指南 <strong>[</strong> <strong>4]</strong> ，HiMarket Helm 一键部署指南 <strong>[</strong> <strong>5]</strong> 。</p>
<h2 data-id="heading-11">HiMarket Roadmap 规划</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41ef995213464ff4bd5b237faf2b6176~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766571986&amp;x-signature=9V3OWgQipWNfEeJaPdTulSW9aVc%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-12">欢迎共建</h2>
<p>HiMarket 是多个开源社区共同发起的开源项目，核心参与者包括阿里云、蚂蚁数科、高德、淘天等团队，面向开源可以助力企业快速构建 AI 开放平台，提供开箱即用的能力。</p>
<p>特别感谢淘天 IdeaLAB 团队为 HiMarket 提供的基础，期待更多企业一起参与共建～</p>
<p>HiMarket 仓库：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhigress-group%2FHiMarket" target="_blank" title="https://github.com/higress-group/HiMarket" ref="nofollow noopener noreferrer">github.com/higress-gro…</a><br/>
基于 HiMarket 实现的 MCP 金融级市场：<a href="https://link.juejin.cn?target=https%3A%2F%2Fantdigital.com%2Fproducts%2FMCP" target="_blank" title="https://antdigital.com/products/MCP" ref="nofollow noopener noreferrer">antdigital.com/products/MC…</a></p>
<p>HiMarket 钉钉社区群（2 群）：163370001036</p>
<p>入群链接（复制到浏览器打开）：<a href="https://link.juejin.cn?target=https%3A%2F%2Fqr.dingtalk.com%2Faction%2Fjoingroup%3Fcode%3Dv1%2Ck1%2Cd%2BMJWsDVtfHq6XanvQEUxsVX3vVL1m%2B7DWfkoUkYxVM%3D%26_dt_no_comment%3D1%26origin%3D11" target="_blank" title="https://qr.dingtalk.com/action/joingroup?code=v1,k1,d+MJWsDVtfHq6XanvQEUxsVX3vVL1m+7DWfkoUkYxVM=&amp;_dt_no_comment=1&amp;origin=11" ref="nofollow noopener noreferrer">qr.dingtalk.com/action/join…</a></p>
<p><strong>推荐文章：</strong></p>
<p>《<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU4NzU0MDIzOQ%3D%3D%26mid%3D2247520193%26idx%3D1%26sn%3Dcb69fc4c4e061fc0065e1f245f55bbed%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU4NzU0MDIzOQ==&amp;mid=2247520193&amp;idx=1&amp;sn=cb69fc4c4e061fc0065e1f245f55bbed&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">AgentScope Java v1.0 发布，让 Java 开发者轻松构建企业级 Agentic 应用</a>》</p>
<p><strong>相关链接：</strong></p>
<p>[1] HiMarket 本地部署指南</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhigress-group%2Fhimarket%2Fblob%2Fmain%2FREADME.md" target="_blank" title="https://github.com/higress-group/himarket/blob/main/README.md" ref="nofollow noopener noreferrer">github.com/higress-gro…</a></p>
<p>[2] HiMarket Docker 部署指南</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhigress-group%2Fhimarket%2Fblob%2Fmain%2Fdeploy%2Fdocker%2FDocker%25E9%2583%25A8%25E7%25BD%25B2%25E8%25AF%25B4%25E6%2598%258E.md" target="_blank" title="https://github.com/higress-group/himarket/blob/main/deploy/docker/Docker%E9%83%A8%E7%BD%B2%E8%AF%B4%E6%98%8E.md" ref="nofollow noopener noreferrer">github.com/higress-gro…</a></p>
<p>[3] HiMarket Helm 部署指南</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhigress-group%2Fhimarket%2Fblob%2Fmain%2Fdeploy%2Fhelm%2FHelm%25E9%2583%25A8%25E7%25BD%25B2%25E8%25AF%25B4%25E6%2598%258E.md" target="_blank" title="https://github.com/higress-group/himarket/blob/main/deploy/helm/Helm%E9%83%A8%E7%BD%B2%E8%AF%B4%E6%98%8E.md" ref="nofollow noopener noreferrer">github.com/higress-gro…</a></p>
<p>[4] HiMarket Docker 一键部署指南</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhigress-group%2Fhimarket%2Fblob%2Fmain%2Fdeploy%2Fdocker%2FDocker%25E9%2583%25A8%25E7%25BD%25B2%25E8%2584%259A%25E6%259C%25AC%25E8%25AF%25B4%25E6%2598%258E.md" target="_blank" title="https://github.com/higress-group/himarket/blob/main/deploy/docker/Docker%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC%E8%AF%B4%E6%98%8E.md" ref="nofollow noopener noreferrer">github.com/higress-gro…</a></p>
<p>[5] HiMarket Helm 一键部署指南</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhigress-group%2Fhimarket%2Fblob%2Fmain%2Fdeploy%2Fhelm%2FHelm%25E9%2583%25A8%25E7%25BD%25B2%25E8%2584%259A%25E6%259C%25AC%25E8%25AF%25B4%25E6%2598%258E.md" target="_blank" title="https://github.com/higress-group/himarket/blob/main/deploy/helm/Helm%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC%E8%AF%B4%E6%98%8E.md" ref="nofollow noopener noreferrer">github.com/higress-gro…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[在 DataWorks 中一键部署大模型，即刻用于数据集成和数据开发]]></title>    <link>https://juejin.cn/post/7584633505105444916</link>    <guid>https://juejin.cn/post/7584633505105444916</guid>    <pubDate>2025-12-17T10:43:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584633505105444916" data-draft-id="7584633505105412148" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="在 DataWorks 中一键部署大模型，即刻用于数据集成和数据开发"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2025-12-17T10:43:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="阿里云大数据AI技术"/> <meta itemprop="url" content="https://juejin.cn/user/2414974667341287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            在 DataWorks 中一键部署大模型，即刻用于数据集成和数据开发
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2414974667341287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    阿里云大数据AI技术
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:43:08.000Z" title="Wed Dec 17 2025 10:43:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在 AI 应用快速落地的今天，越来越多企业希望将大模型能力融入数据处理流程——无论是文本分析、智能摘要，还是 RAG 知识库构建。但传统模式下，模型部署依赖专业 MLOps 团队，需自行搭建推理环境、配置 GPU 资源、维护服务稳定性，门槛高、周期长、成本重。</p>
<p>现在，阿里云 <strong>DataWorks 发布大模型服务能力</strong>，基于 <strong>Serverless 资源组</strong>，支持用户 <strong>一键部署主流大模型</strong>，并可在 <strong>数据集成和数据开发任务中直接调用模型 API</strong>，实现“部署—集成—使用”全流程闭环，真正让数据工程师也能轻松玩转大模型！</p>
<p><img src="https://static001.geekbang.org/infoq/b7/b7d9d38118d77f6bef7b12ee83eb1538.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">三步完成模型部署，零代码上手</h2>
<p>通过 DataWorks 大模型服务管理功能，您只需三个步骤即可完成模型上线：</p>
<ol>
<li>
<p><strong>选择模型</strong> 支持通义千问 Qwen3 系列、DeepSeek 系列等多种主流模型，涵盖生成、推理、向量化等场景。</p>
</li>
<li>
<p><strong>一键部署</strong> 在控制台点击“部署”，选择目标 <strong>Serverless 资源组</strong> 和 GPU 规格（如 vGPU-1/4、vGPU-1），系统自动完成镜像拉取、服务启动与健康检查。</p>
</li>
<li>
<p><strong>获取调用地址</strong> 部署成功后，自动生成标准 OpenAPI 接口地址和鉴权 Token，可用于后续任务调用。</p>
</li>
</ol>
<p><img src="https://static001.geekbang.org/infoq/21/21954c17748c0bb90aa8d7c75f4b83cc.png" alt="" loading="lazy"/></p>
<p><em>大模型部署页面</em></p>
<p>整个过程 <strong>无需关注底层资源调度、容器编排或网络配置</strong>，真正做到“点一下，就可用”，大幅降低大模型落地门槛。</p>
<h2 data-id="heading-1">核心优势</h2>
<p><img src="https://static001.geekbang.org/infoq/35/350b5a1610e02f6f1128735628ec6693.png" alt="" loading="lazy"/></p>
<p>得益于底层资源优化与轻量化推理引擎，对于参数规模较小的模型（如 Qwen-Turbo、Embedding 模型），在 Serverless 资源组上的 <strong>平均推理延迟显著降低，性能提升近 10 倍</strong>，特别适合高频、低延迟的在线推理场景。</p>
<h2 data-id="heading-2">一键开启数据集成与开发的大模型应用</h2>
<p>目前支持在数据集成、数据开发中调用大模型，实现对数据的智能处理。</p>
<h3 data-id="heading-3">数据集成中调用</h3>
<p>在单表离线同步任务中，可使用大模型服务对同步中的数据进行<a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Fdataworks%2Fuser-guide%2Foffline-synchronization-task-ai-auxiliary-processing" target="_blank" title="https://help.aliyun.com/zh/dataworks/user-guide/offline-synchronization-task-ai-auxiliary-processing" ref="nofollow noopener noreferrer">AI辅助处理</a>。</p>
<p><img src="https://static001.geekbang.org/infoq/5d/5d0552e369f5436e0d3caa4e5f1fcb17.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">数据开发中调用</h3>
<h4 data-id="heading-5">方式1、大模型节点调用大语言模型</h4>
<p>DataWorks 新版数据开发 Data Studio 提供专属的大模型节点，支持通过可视化配置方式直接调用已部署的生成类或向量类大模型。用户无需编写代码，只需选择目标模型、输入提示词（Prompt）并设置参数，即可完成文本生成、摘要提取或文本向量化等任务，适用于快速验证模型效果和构建轻量级 AI 流程。</p>
<p><img src="https://static001.geekbang.org/infoq/27/27b9ee04aa350f0795e8a1dc60799f69.gif" alt="" loading="lazy"/></p>
<h4 data-id="heading-6">方式2、Shell 节点调用大语言模型</h4>
<p>用户可在 Shell 节点中通过 curl 命令调用大模型服务 API，实现对生成模型或向量模型的灵活调用。例如，发送自然语言请求获取模型回复，或将文本传入 Embedding 模型生成向量。该方式适合熟悉命令行操作的开发者，结合调度配置可实现自动化任务执行。</p>
<h4 data-id="heading-7">方式3、Python节点调用大语言模型</h4>
<p>通过 Python 节点，用户可使用 requests 等库编写脚本，以编程方式调用大模型服务。支持流式输出处理、自定义解析逻辑和复杂业务封装，适用于写诗、报告生成、结构化输出等需要精细控制的场景。需基于自定义镜像安装必要依赖后运行，并可集成至完整数据链路中。</p>
<p>接下来举个🌰展示如何在Python节点通过调用大语言模型完成写诗指令。</p>
<ol>
<li>当前示例依赖Python的<code>requests</code>库，请参考以下主要参数，基于DataWorks官方镜像创建<a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Fdataworks%2Fuser-guide%2Fcustom-image" target="_blank" title="https://help.aliyun.com/zh/dataworks/user-guide/custom-image" ref="nofollow noopener noreferrer">自定义镜像</a>安装该依赖环境。</li>
</ol>
<p><img src="https://static001.geekbang.org/infoq/4d/4d163cb955199f76f1fdaa7ce5007cba.png" alt="" loading="lazy"/></p>
<p>2. <a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Fdataworks%2Fuser-guide%2Fnode-development-of-data-studio%2F%2313d1ad442e1tc" target="_blank" title="https://help.aliyun.com/zh/dataworks/user-guide/node-development-of-data-studio/#13d1ad442e1tc" ref="nofollow noopener noreferrer">创建Python节点</a>，在Python节点添加如下示例代码：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> sys

<span class="hljs-keyword">def</span> <span class="hljs-title function_">stream_print_response</span>():
    httpUrl = <span class="hljs-string">"http://ms-xxxx.cn-beijing.dataworks-model.aliyuncs.com"</span>
    apikey = <span class="hljs-string">"DW-ms-xxxx"</span>
    url = httpUrl + <span class="hljs-string">"/v1/completions"</span>
    headers = {
        <span class="hljs-string">"Authorization"</span>: apikey,
        <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>
    }
    data = {
        <span class="hljs-string">"prompt"</span>: <span class="hljs-string">"请写一篇关于春天的诗"</span>,
        <span class="hljs-string">"stream"</span>: <span class="hljs-literal">True</span>,
        <span class="hljs-string">"max_tokens"</span>: <span class="hljs-number">512</span>
    }

    <span class="hljs-keyword">try</span>:
        response = requests.post(url, headers=headers, json=data, stream=<span class="hljs-literal">True</span>)
        response.raise_for_status()

        full_text = <span class="hljs-string">""</span>  <span class="hljs-comment"># 累积完整回复，防止丢失</span>
        buffer = <span class="hljs-string">""</span>     <span class="hljs-comment"># 用于处理不完整的 JSON 行（可选）</span>

        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> response.iter_lines():
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line:
                <span class="hljs-keyword">continue</span>  <span class="hljs-comment"># 跳过空行</span>

            line_str = line.decode(<span class="hljs-string">'utf-8'</span>).strip()
            <span class="hljs-comment"># print(f"[DEBUG] 收到行: {line_str}")  # 调试用</span>

            <span class="hljs-keyword">if</span> line_str.startswith(<span class="hljs-string">"data:"</span>):
                data_str = line_str[<span class="hljs-number">5</span>:].strip()  <span class="hljs-comment"># 去掉 "data: "</span>

                <span class="hljs-keyword">if</span> data_str == <span class="hljs-string">"[DONE]"</span>:
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n[流式响应结束]"</span>)
                    <span class="hljs-keyword">break</span>

                <span class="hljs-comment"># 尝试解析 JSON</span>
                <span class="hljs-keyword">try</span>:
                    parsed = json.loads(data_str)
                    choices = parsed.get(<span class="hljs-string">"choices"</span>, [])
                    <span class="hljs-keyword">if</span> choices:
                        delta_text = choices[<span class="hljs-number">0</span>].get(<span class="hljs-string">"text"</span>, <span class="hljs-string">""</span>)
                        <span class="hljs-keyword">if</span> delta_text:
                            <span class="hljs-comment"># 累积到完整文本</span>
                            full_text += delta_text

                            <span class="hljs-comment"># 逐字打印新增的字符</span>
                            <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> delta_text:
                                <span class="hljs-built_in">print</span>(char, end=<span class="hljs-string">''</span>, flush=<span class="hljs-literal">True</span>)
                                sys.stdout.flush()
                                time.sleep(<span class="hljs-number">0.03</span>)  <span class="hljs-comment"># 打字机效果</span>

                <span class="hljs-keyword">except</span> json.JSONDecodeError <span class="hljs-keyword">as</span> e:
                    <span class="hljs-comment"># print(f"[警告] JSON 解析失败: {e}, 原文: {data_str}")</span>
                    <span class="hljs-keyword">continue</span>

        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n\n[完整回复长度: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(full_text)}</span> 字]"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[ 完整内容]:\n<span class="hljs-subst">{full_text}</span>"</span>)

    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f" 请求失败: <span class="hljs-subst">{e}</span>"</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f" 其他错误: <span class="hljs-subst">{e}</span>"</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    stream_print_response()
</code></pre>
<p><strong>说明</strong>：请将代码中以<code>http</code>开头的大模型服务调用地址和以<code>DW</code>开头的Token信息替换为您的实际值。</p>
<p>3. 编辑节点内容后，在节点编辑页面右侧的<strong>调试配置</strong>中，选择已完成网络连通配置的资源组和<code>步骤1</code>中安装了<code>requests</code>库的自定义<strong>镜像</strong>。</p>
<p>4. 单击<strong>运行</strong>节点，即可调用已部署的服务模型执行相关命令。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PF4J 日志类冲突与 JVM 类加载机制]]></title>    <link>https://juejin.cn/post/7584651851904811027</link>    <guid>https://juejin.cn/post/7584651851904811027</guid>    <pubDate>2025-12-17T10:48:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584651851904811027" data-draft-id="7584650421124366377" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PF4J 日志类冲突与 JVM 类加载机制"/> <meta itemprop="keywords" content="JVM,后端"/> <meta itemprop="datePublished" content="2025-12-17T10:48:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jaising666"/> <meta itemprop="url" content="https://juejin.cn/user/2418581311850301"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PF4J 日志类冲突与 JVM 类加载机制
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2418581311850301/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jaising666
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:48:34.000Z" title="Wed Dec 17 2025 10:48:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>本文从 JVM 类加载机制出发，分析 PF4J 插件框架的类加载原理，并通过 ClickHouse 插件的实际案例解释类加载冲突的根本原因和解决方案。</p>
<h2 data-id="heading-0">JVM 类加载机制（Java 8）</h2>
<h3 data-id="heading-1">为什么需要类加载机制</h3>
<p><strong>类加载机制的核心价值</strong>：</p>
<ol>
<li><strong>动态性</strong>：Java 程序在运行时才加载需要的类，而不是启动时加载所有类</li>
<li><strong>安全性</strong>：通过类加载器验证字节码，防止恶意代码执行</li>
<li><strong>隔离性</strong>：不同类加载器提供独立的命名空间，避免类冲突</li>
<li><strong>扩展性</strong>：支持自定义类加载器，实现插件化架构</li>
</ol>
<p><strong>解决的核心问题</strong>：</p>
<ul>
<li><strong>内存优化</strong>：按需加载，减少内存占用</li>
<li><strong>版本管理</strong>：同一 JVM 中可以存在同一类的多个版本</li>
<li><strong>安全控制</strong>：限制类的加载来源和权限</li>
<li><strong>模块化</strong>：支持复杂应用的模块化部署</li>
</ul>
<h3 data-id="heading-2">类加载器层次结构</h3>
<pre><code class="hljs language-java" lang="java">Bootstrap <span class="hljs-title function_">ClassLoader</span> <span class="hljs-params">(启动类加载器)</span>
    ↓
Extension <span class="hljs-title function_">ClassLoader</span> <span class="hljs-params">(扩展类加载器)</span> 
    ↓
Application <span class="hljs-title function_">ClassLoader</span> <span class="hljs-params">(应用类加载器)</span>
    ↓
Custom <span class="hljs-title function_">ClassLoader</span> <span class="hljs-params">(自定义类加载器)</span>
</code></pre>
<h4 data-id="heading-3">1. Bootstrap ClassLoader</h4>
<ul>
<li><strong>职责</strong>：加载 JVM 核心类库（如 <code>java.lang.*</code>、<code>java.util.*</code> 等）</li>
<li><strong>实现</strong>：C++ 实现，Java 中表现为 null</li>
<li><strong>加载路径</strong>：<code>$JAVA_HOME/jre/lib/rt.jar</code> 等核心 jar 包</li>
</ul>
<h4 data-id="heading-4">2. Extension ClassLoader</h4>
<ul>
<li><strong>职责</strong>：加载 Java 扩展库</li>
<li><strong>实现</strong>：<code>sun.misc.Launcher$ExtClassLoader</code></li>
<li><strong>加载路径</strong>：<code>$JAVA_HOME/jre/lib/ext/</code> 目录下的 jar 包</li>
</ul>
<h4 data-id="heading-5">3. Application ClassLoader</h4>
<ul>
<li><strong>职责</strong>：加载应用程序类路径（classpath）下的类</li>
<li><strong>实现</strong>：<code>sun.misc.Launcher$AppClassLoader</code></li>
<li><strong>加载路径</strong>：<code>-cp</code> 参数指定的路径、当前目录下的类</li>
</ul>
<h3 data-id="heading-6">双亲委托模型</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> Class&lt;?&gt; loadClass(String name, <span class="hljs-type">boolean</span> resolve) <span class="hljs-keyword">throws</span> ClassNotFoundException {
    <span class="hljs-comment">// 1. 检查类是否已被加载</span>
    Class&lt;?&gt; c = findLoadedClass(name);
    <span class="hljs-keyword">if</span> (c == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 2. 委托给父类加载器</span>
            <span class="hljs-keyword">if</span> (parent != <span class="hljs-literal">null</span>) {
                c = parent.loadClass(name, <span class="hljs-literal">false</span>);
            } <span class="hljs-keyword">else</span> {
                c = findBootstrapClassOrNull(name);
            }
        } <span class="hljs-keyword">catch</span> (ClassNotFoundException e) {
            <span class="hljs-comment">// 3. 父类加载器无法加载时，自己尝试加载</span>
            c = findClass(name);
        }
    }
    <span class="hljs-keyword">return</span> c;
}
</code></pre>
<p><strong>委托流程</strong>：</p>
<ol>
<li>检查类是否已加载</li>
<li>委托父类加载器加载</li>
<li>父类加载器失败时，自己加载</li>
<li>都失败则抛出 <code>ClassNotFoundException</code></li>
</ol>
<h3 data-id="heading-7">类加载器特性</h3>
<h4 data-id="heading-8">1. 唯一性</h4>
<p>同一个类加载器不会重复加载同一个类。</p>
<h4 data-id="heading-9">2. 可见性</h4>
<p>子类加载器可以看到父类加载器加载的类，反之不行。</p>
<h4 data-id="heading-10">3. 隔离性</h4>
<p>不同类加载器加载的同名类被 JVM 视为不同类型，每个类加载器都有独立的命名空间，类的完整标识是：<code>类加载器 + 类全名</code>。</p>
<h2 data-id="heading-11">PF4J 类加载架构</h2>
<h3 data-id="heading-12">类加载器扩展层次</h3>
<pre><code class="hljs language-css" lang="css">Bootstrap ClassLoader
    ↓
Extension ClassLoader  
    ↓
Application ClassLoader (主应用)
    ↓
PluginClassLoader (插件<span class="hljs-selector-tag">A</span>)    PluginClassLoader (插件<span class="hljs-selector-tag">B</span>)
    ↓                           ↓
Plugin <span class="hljs-selector-tag">A</span> Classes            Plugin <span class="hljs-selector-tag">B</span> Classes
</code></pre>
<p>PF4J 在标准 JVM 类加载器基础上，为每个插件创建独立的 <code>PluginClassLoader</code>：</p>
<ol>
<li><strong>插件隔离</strong>：每个插件拥有独立的类加载器和命名空间</li>
<li><strong>委托机制</strong>：继承双亲委托模型，优先使用主应用的类</li>
<li><strong>依赖共享</strong>：插件可访问主应用类，但插件间相互隔离</li>
</ol>
<h3 data-id="heading-13">PluginClassLoader 实现原理</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PluginClassLoader</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">URLClassLoader</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> Class&lt;?&gt; loadClass(String name, <span class="hljs-type">boolean</span> resolve) <span class="hljs-keyword">throws</span> ClassNotFoundException {
        <span class="hljs-comment">// 1. 检查类缓存</span>
        Class&lt;?&gt; loadedClass = findLoadedClass(name);
        <span class="hljs-keyword">if</span> (loadedClass != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> loadedClass;
        }
        
        <span class="hljs-comment">// 2. 委托给父类加载器（遵循双亲委托）</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.loadClass(name, resolve);
        } <span class="hljs-keyword">catch</span> (ClassNotFoundException e) {
            <span class="hljs-comment">// 3. 从插件jar中加载</span>
            <span class="hljs-keyword">return</span> findClass(name);
        }
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="hljs-keyword">throws</span> ClassNotFoundException {
        <span class="hljs-comment">// 从插件jar包中查找并定义类</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.findClass(name);
    }
}
</code></pre>
<p><strong>加载策略</strong>：</p>
<ol>
<li>优先使用主应用已加载的类（避免重复加载核心库）</li>
<li>主应用无法提供时，从插件 jar 中加载</li>
<li>保持插件间的类隔离</li>
</ol>
<h2 data-id="heading-14">类加载冲突案例分析</h2>
<h3 data-id="heading-15">问题现象</h3>
<p>在 ClickHouse 插件中出现以下异常：</p>
<pre><code class="hljs language-kotlin" lang="kotlin">java.lang.LinkageError: loader constraint violation: 
<span class="hljs-keyword">when</span> resolving method <span class="hljs-string">"org.slf4j.impl.StaticLoggerBinder.getLoggerFactory()Lorg/slf4j/ILoggerFactory;"</span> 
the <span class="hljs-keyword">class</span> <span class="hljs-title class_">loader</span> (instance of org/pf4j/PluginClassLoader) of the current <span class="hljs-keyword">class</span>, org/slf4j/LoggerFactory, 
and the <span class="hljs-keyword">class</span> <span class="hljs-title class_">loader</span> (instance of sun/misc/Launcher$AppClassLoader) <span class="hljs-keyword">for</span> the method<span class="hljs-string">'s defining class, 
org/slf4j/impl/StaticLoggerBinder, have different Class objects for the type org/slf4j/ILoggerFactory 
used in the signature
</span></code></pre>
<h3 data-id="heading-16">冲突原理分析</h3>
<h4 data-id="heading-17">1. 类加载器隔离导致的问题</h4>
<pre><code class="hljs language-markdown" lang="markdown">主应用 (AppClassLoader)
├── slf4j-api-1.7.30.jar
│   ├── org.slf4j.LoggerFactory
│   └── org.slf4j.ILoggerFactory
└── logback-classic-1.2.3.jar
<span class="hljs-code">    └── ch.qos.logback.classic.Logger
</span>
ClickHouse插件 (PluginClassLoader)
├── clickhouse-jdbc-0.3.2.jar
└── slf4j-api-1.7.25.jar  ← 版本冲突！
<span class="hljs-code">    ├── org.slf4j.LoggerFactory
    └── org.slf4j.ILoggerFactory
</span></code></pre>
<h4 data-id="heading-18">2. 类型不匹配分析</h4>
<p><strong>冲突场景</strong>：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ClickHouse 插件代码</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClickHousePlugin</span> {
    <span class="hljs-comment">// LoggerFactory 来自 PluginClassLoader (slf4j-1.7.25)</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(ClickHousePlugin.class);
}
</code></pre>
<p><strong>调用链分析</strong>：</p>
<ol>
<li><code>LoggerFactory.getLogger()</code> → <code>getILoggerFactory()</code></li>
<li><code>getILoggerFactory()</code> → <code>StaticLoggerBinder.getLoggerFactory()</code></li>
<li><code>StaticLoggerBinder</code> 由 AppClassLoader 加载（主应用 logback）</li>
<li>返回 AppClassLoader 中的 <code>ILoggerFactory</code> 实例</li>
<li>但调用方期望 PluginClassLoader 中的 <code>ILoggerFactory</code> 类型</li>
<li>JVM 类型检查失败 → <code>LinkageError</code></li>
</ol>
<p><strong>根本原因</strong>：同一接口的不同版本被不同类加载器加载，JVM 无法进行类型转换。</p>
<h4 data-id="heading-19">3. LinkageError 详解</h4>
<p><strong>JVM 类型约束</strong>：
JVM 要求方法签名中的所有类型必须由相同类加载器加载，或存在可见性关系。</p>
<p><strong>违反约束的调用链</strong>:</p>
<pre><code class="hljs language-scss" lang="scss">PluginClassLoader<span class="hljs-selector-class">.LoggerFactory</span> (slf4j-<span class="hljs-number">1.7</span>.<span class="hljs-number">25</span>)
    ↓ 调用方法
AppClassLoader<span class="hljs-selector-class">.StaticLoggerBinder</span> (logback-<span class="hljs-number">1.2</span>.<span class="hljs-number">3</span>)  
    ↓ 返回类型
AppClassLoader<span class="hljs-selector-class">.ILoggerFactory</span> (slf4j-<span class="hljs-number">1.7</span>.<span class="hljs-number">30</span>)
    ↓ 类型检查
PluginClassLoader期望的ILoggerFactory (slf4j-<span class="hljs-number">1.7</span>.<span class="hljs-number">25</span>) ← 类型不匹配
</code></pre>
<p><strong>JVM 检查逻辑</strong>：</p>
<ol>
<li>方法调用时检查参数和返回值类型</li>
<li>发现 <code>ILoggerFactory</code> 存在两个不同的 Class 对象</li>
<li>无法确定类型兼容性</li>
<li>抛出 <code>LinkageError</code> 保证类型安全</li>
</ol>
<h2 data-id="heading-20">解决方案：exclude 配置</h2>
<h3 data-id="heading-21">配置方式</h3>
<p>在 ClickHouse 插件的 <code>build.gradle</code> 中添加：</p>
<pre><code class="hljs language-gradle" lang="gradle">dependencies {
    implementation('ru.yandex.clickhouse:clickhouse-jdbc:0.3.2') {
        exclude group: 'org.slf4j'  // 排除 SLF4J 依赖
    }
    // 其他依赖...
}
</code></pre>
<h3 data-id="heading-22">解决原理</h3>
<h4 data-id="heading-23">1. 依赖排除机制</h4>
<pre><code class="hljs language-gradle" lang="gradle">// 排除冲突依赖
exclude group: 'org.slf4j'
</code></pre>
<p><strong>依赖树变化</strong>：</p>
<pre><code class="hljs language-scss" lang="scss">修改前：
ClickHouse 插件 (PluginClassLoader)
├── clickhouse-jdbc-<span class="hljs-number">0.3</span><span class="hljs-selector-class">.2</span><span class="hljs-selector-class">.jar</span>
│   └── slf4j-api-<span class="hljs-number">1.7</span><span class="hljs-selector-class">.25</span><span class="hljs-selector-class">.jar</span>  ← 冲突源
└── 其他依赖

修改后：
ClickHouse 插件 (PluginClassLoader)  
├── clickhouse-jdbc-<span class="hljs-number">0.3</span><span class="hljs-selector-class">.2</span><span class="hljs-selector-class">.jar</span> (无 slf4j 依赖)
└── 其他依赖
</code></pre>
<h4 data-id="heading-24">2. 类加载委托生效</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 插件中的日志调用</span>
LoggerFactory.getLogger(ClickHousePlugin.class)
    ↓
<span class="hljs-comment">// PluginClassLoader 中无 LoggerFactory</span>
<span class="hljs-comment">// 根据双亲委托，向上查找</span>
AppClassLoader.loadClass(<span class="hljs-string">"org.slf4j.LoggerFactory"</span>)
    ↓  
<span class="hljs-comment">// 统一使用主应用的 SLF4J 实现</span>
<span class="hljs-comment">// 所有相关类都来自 AppClassLoader</span>
<span class="hljs-comment">// 类型一致，调用成功</span>
</code></pre>
<h4 data-id="heading-25">3. 统一命名空间</h4>
<pre><code class="hljs language-scss" lang="scss">解决后的类加载结构：
AppClassLoader (统一命名空间)
├── org<span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.LoggerFactory</span>
├── org<span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.ILoggerFactory</span>
├── ch<span class="hljs-selector-class">.qos</span><span class="hljs-selector-class">.logback</span><span class="hljs-selector-class">.classic</span><span class="hljs-selector-class">.StaticLoggerBinder</span>  
└── ch<span class="hljs-selector-class">.qos</span><span class="hljs-selector-class">.logback</span><span class="hljs-selector-class">.classic</span><span class="hljs-selector-class">.LoggerContext</span>

插件通过委托机制共享主应用的日志实现
</code></pre>
<h2 data-id="heading-26">最佳实践</h2>
<h3 data-id="heading-27">1. 依赖管理策略</h3>
<pre><code class="hljs language-gradle" lang="gradle">// 推荐：排除常见的日志框架
dependencies {
    implementation('third-party-library:1.0.0') {
        exclude group: 'org.slf4j'
        exclude group: 'ch.qos.logback'
        exclude group: 'log4j'
        exclude group: 'commons-logging'
    }
}
</code></pre>
<h3 data-id="heading-28">2. 类加载冲突预防规范</h3>
<h4 data-id="heading-29">依赖作用域对比</h4>













































<table><thead><tr><th>作用域</th><th>编译时</th><th>运行时</th><th>测试时</th><th>打包</th><th>说明</th></tr></thead><tbody><tr><td>implementation</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>完整依赖</td></tr><tr><td>compileOnly</td><td>✓</td><td>✗</td><td>✗</td><td>✗</td><td>编译时依赖，类似provided</td></tr><tr><td>runtimeOnly</td><td>✗</td><td>✓</td><td>✓</td><td>✓</td><td>运行时依赖</td></tr><tr><td>testImplementation</td><td>✗</td><td>✗</td><td>✓</td><td>✗</td><td>测试依赖</td></tr></tbody></table>
<h4 data-id="heading-30">最佳实践配置</h4>
<pre><code class="hljs language-gradle" lang="gradle">// 最佳实践：既支持独立调试，又避免冲突
dependencies {
    // 1. 主应用 API（编译时需要，运行时由主应用提供）
    compileOnly project(':plugin-api')
    
    // 2. 主应用基础设施（编译时需要，运行时由主应用提供）
    compileOnly 'org.slf4j:slf4j-api:1.7.30'
    compileOnly 'com.fasterxml.jackson.core:jackson-core:2.12.3'
    compileOnly 'org.apache.commons:commons-lang3:3.12.0'
    
    // 3. 插件特有依赖（会打包到插件中，需要排除冲突）
    implementation('ru.yandex.clickhouse:clickhouse-jdbc:0.3.2') {
        exclude group: 'org.slf4j'
        exclude group: 'com.fasterxml.jackson.core'
        exclude group: 'org.apache.commons'
    }
    
    // 4. 测试和调试依赖（完整依赖，支持独立运行）
    testImplementation project(':plugin-api')
    testImplementation 'org.slf4j:slf4j-api:1.7.30'
    testImplementation 'ch.qos.logback:logback-classic:1.2.3'
    testImplementation 'com.fasterxml.jackson.core:jackson-core:2.12.3'
    testImplementation 'org.apache.commons:commons-lang3:3.12.0'
}

// 插件打包（只包含 implementation 依赖）
jar {
    archiveClassifier = 'plugin'
    
    manifest {
        attributes(
            'Plugin-Class': 'com.idss.plugin.impl.ClickHousePlugin',
            'Plugin-Id': 'clickhouse-plugin',
            'Plugin-Version': version
        )
    }
}
</code></pre>
<h3 data-id="heading-31">4. JVM 类加载诊断工具</h3>
<h4 data-id="heading-32">使用 -verbose:class 参数</h4>
<p>JVM 提供了内置的类加载跟踪功能：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 启动应用时添加 verbose 参数</span>
java -verbose:class -jar your-application.jar

<span class="hljs-comment"># 或者更详细的类加载信息</span>
java -verbose:class -XX:+TraceClassLoading -jar your-application.jar
</code></pre>
<p><strong>输出示例</strong>：</p>
<pre><code class="hljs language-javascript" lang="javascript">[<span class="hljs-title class_">Loaded</span> org.<span class="hljs-property">slf4j</span>.<span class="hljs-property">LoggerFactory</span> <span class="hljs-keyword">from</span> <span class="hljs-attr">file</span>:<span class="hljs-regexp">/app/</span>lib/slf4j-api-<span class="hljs-number">1.7</span><span class="hljs-number">.30</span>.<span class="hljs-property">jar</span>]
[<span class="hljs-title class_">Loaded</span> org.<span class="hljs-property">slf4j</span>.<span class="hljs-property">ILoggerFactory</span> <span class="hljs-keyword">from</span> <span class="hljs-attr">file</span>:<span class="hljs-regexp">/app/</span>lib/slf4j-api-<span class="hljs-number">1.7</span><span class="hljs-number">.30</span>.<span class="hljs-property">jar</span>]
[<span class="hljs-title class_">Loaded</span> ch.<span class="hljs-property">qos</span>.<span class="hljs-property">logback</span>.<span class="hljs-property">classic</span>.<span class="hljs-property">Logger</span> <span class="hljs-keyword">from</span> <span class="hljs-attr">file</span>:<span class="hljs-regexp">/app/</span>lib/logback-classic-<span class="hljs-number">1.2</span><span class="hljs-number">.3</span>.<span class="hljs-property">jar</span>]
[<span class="hljs-title class_">Loaded</span> com.<span class="hljs-property">idss</span>.<span class="hljs-property">plugin</span>.<span class="hljs-property">impl</span>.<span class="hljs-property">ClickHousePlugin</span> <span class="hljs-keyword">from</span> <span class="hljs-attr">file</span>:<span class="hljs-regexp">/plugins/</span>clickhouse-plugin.<span class="hljs-property">jar</span>]
</code></pre>
<h4 data-id="heading-33">使用 jcmd 工具</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 获取进程 ID</span>
jps

<span class="hljs-comment"># 查看类加载器层次</span>
jcmd &lt;pid&gt; VM.classloader_stats

<span class="hljs-comment"># 查看已加载的类</span>
jcmd &lt;pid&gt; VM.class_hierarchy
</code></pre>
<h4 data-id="heading-34">使用 JConsole/VisualVM</h4>
<p>通过 JMX 监控类加载情况：</p>
<ul>
<li>连接到目标 JVM 进程</li>
<li>查看"类"标签页</li>
<li>监控类加载数量和卸载情况</li>
</ul>
<h2 data-id="heading-35">相同版本依赖的情况分析</h2>
<h3 data-id="heading-36">场景：插件和主应用使用相同版本 SLF4J</h3>
<p>假设主应用和 ClickHouse 插件都使用 <code>slf4j-api-1.7.30</code>：</p>
<pre><code class="hljs language-scss" lang="scss">主应用 (AppClassLoader)
├── slf4j-api-<span class="hljs-number">1.7</span><span class="hljs-selector-class">.30</span><span class="hljs-selector-class">.jar</span>
└── logback-classic-<span class="hljs-number">1.2</span><span class="hljs-selector-class">.3</span><span class="hljs-selector-class">.jar</span>

ClickHouse 插件 (PluginClassLoader)  
├── clickhouse-jdbc-<span class="hljs-number">0.3</span><span class="hljs-selector-class">.2</span><span class="hljs-selector-class">.jar</span>
└── slf4j-api-<span class="hljs-number">1.7</span><span class="hljs-selector-class">.30</span><span class="hljs-selector-class">.jar</span>  ← 相同版本
</code></pre>
<h3 data-id="heading-37">是否还会有冲突？</h3>
<p><strong>答案：仍然会有 LinkageError！</strong></p>
<p><strong>原因分析</strong>：</p>
<ol>
<li><strong>类加载器隔离依然存在</strong>：即使版本相同，PluginClassLoader 仍会加载自己的 SLF4J 类</li>
<li><strong>JVM 类型检查机制</strong>：JVM 比较的是 Class 对象的身份，而不是类的内容</li>
<li><strong>不同命名空间</strong>：两个类加载器创建了两个不同的 <code>ILoggerFactory</code> Class 对象</li>
</ol>
<p><strong>冲突流程</strong>：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 插件中的调用</span>
PluginClassLoader.LoggerFactory.getLogger()  <span class="hljs-comment">// slf4j-1.7.30 (插件版本)</span>
    ↓
AppClassLoader.StaticLoggerBinder.getLoggerFactory()  <span class="hljs-comment">// logback 实现</span>
    ↓  
返回 AppClassLoader.ILoggerFactory 实例  <span class="hljs-comment">// slf4j-1.7.30 (主应用版本)</span>
    ↓
类型检查: PluginClassLoader.ILoggerFactory != AppClassLoader.ILoggerFactory
    ↓
LinkageError: 不同 Class 对象
</code></pre>
<h3 data-id="heading-38">验证代码</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SameVersionConflictDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// 模拟两个类加载器加载相同版本的类</span>
        URL[] urls = {<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"slf4j-api-1.7.30.jar"</span>).toURI().toURL()};
        
        <span class="hljs-comment">// 设置 parent 为 null，打破双亲委派</span>
        <span class="hljs-type">URLClassLoader</span> <span class="hljs-variable">loader1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLClassLoader</span>(urls, <span class="hljs-literal">null</span>);
        <span class="hljs-type">URLClassLoader</span> <span class="hljs-variable">loader2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLClassLoader</span>(urls, <span class="hljs-literal">null</span>);
        
        Class&lt;?&gt; class1 = loader1.loadClass(<span class="hljs-string">"org.slf4j.ILoggerFactory"</span>);
        Class&lt;?&gt; class2 = loader2.loadClass(<span class="hljs-string">"org.slf4j.ILoggerFactory"</span>);
        
        System.out.println(<span class="hljs-string">"相同版本，不同类加载器:"</span>);
        System.out.println(<span class="hljs-string">"Class1: "</span> + class1);
        System.out.println(<span class="hljs-string">"Class2: "</span> + class2);
        System.out.println(<span class="hljs-string">"是否相等: "</span> + (class1 == class2)); <span class="hljs-comment">// false!</span>
        System.out.println(<span class="hljs-string">"类加载器1: "</span> + class1.getClassLoader());
        System.out.println(<span class="hljs-string">"类加载器2: "</span> + class2.getClassLoader());
    }
}
</code></pre>
<p><strong>输出结果</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin">相同版本，不同类加载器:
Class1: <span class="hljs-keyword">interface</span> <span class="hljs-title class_">org</span>.<span class="hljs-title">slf4j</span>.<span class="hljs-title">ILoggerFactory</span>
Class2: <span class="hljs-keyword">interface</span> <span class="hljs-title class_">org</span>.<span class="hljs-title">slf4j</span>.<span class="hljs-title">ILoggerFactory</span>
是否相等: <span class="hljs-literal">false</span>
类加载器<span class="hljs-number">1</span>: java.net.<span class="hljs-symbol">URLClassLoader@</span>232204a1
类加载器<span class="hljs-number">2</span>: java.net.<span class="hljs-symbol">URLClassLoader@</span>677327b6
</code></pre>
<h3 data-id="heading-39">关键结论</h3>
<p><strong>版本相同不等于类型相同</strong>！JVM 的类型系统基于以下规则：</p>
<pre><code class="hljs language-java" lang="java">类的完整标识 = 类加载器实例 + 类的全限定名
</code></pre>
<p>即使是完全相同的字节码，被不同类加载器加载后也是不同的类型。</p>
<h2 data-id="heading-40">其他常见冲突场景</h2>
<h3 data-id="heading-41">1. Jackson 序列化框架冲突</h3>
<pre><code class="hljs language-gradle" lang="gradle">dependencies {
    implementation('some-library:1.0.0') {
        exclude group: 'com.fasterxml.jackson.core'
        exclude group: 'com.fasterxml.jackson.databind'
    }
}
</code></pre>
<h3 data-id="heading-42">2. Apache Commons 冲突</h3>
<pre><code class="hljs language-gradle" lang="gradle">dependencies {
    implementation('some-library:1.0.0') {
        exclude group: 'commons-lang'
        exclude group: 'commons-io'
        exclude group: 'commons-collections'
    }
}
</code></pre>
<h3 data-id="heading-43">3. Spring 框架冲突</h3>
<pre><code class="hljs language-gradle" lang="gradle">dependencies {
    implementation('some-library:1.0.0') {
        exclude group: 'org.springframework'
    }
}
</code></pre>
<h2 data-id="heading-44">类加载冲突的本质</h2>
<h3 data-id="heading-45">冲突根源</h3>
<ol>
<li><strong>类加载器隔离</strong>：JVM 将不同类加载器的同名类视为不同类型（即使版本相同）</li>
<li><strong>跨类加载器调用</strong>：方法调用跨越类加载器边界时的类型不匹配</li>
<li><strong>JVM 类型安全</strong>：严格的类型检查机制防止类型混淆</li>
</ol>
<p><strong>重要认知</strong>：冲突的根本原因不是版本差异，而是类加载器隔离！</p>
<h3 data-id="heading-46">解决策略</h3>
<ol>
<li><strong>依赖排除</strong>：移除插件中的冲突依赖，统一使用主应用版本</li>
<li><strong>委托机制</strong>：利用双亲委托让插件使用主应用的类</li>
<li><strong>命名空间统一</strong>：确保相关类都在同一类加载器的命名空间中</li>
</ol>
<h2 data-id="heading-47">总结</h2>
<p><strong>JVM 类加载机制</strong>为 Java 提供了强大的模块化能力，但也带来了复杂的类型安全约束。<strong>PF4J 插件框架</strong>在此基础上实现了插件隔离，但需要 careful 处理共享依赖。</p>
<p><strong>核心原则</strong>：</p>
<ul>
<li>理解双亲委托模型的工作机制</li>
<li>识别类加载器边界和可见性规则</li>
<li>通过依赖管理避免类型冲突</li>
<li>利用委托机制实现依赖共享</li>
</ul>
<p>通过 <code>exclude</code> 配置解决 SLF4J 冲突，本质上是将插件的日志依赖委托给主应用，确保所有相关类都在 AppClassLoader 的统一命名空间中，从而避免 JVM 的类型安全检查失败。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[从零搭建使用 Open-AutoGML 搜索附近的美食]]></title>    <link>https://juejin.cn/post/7584650421124382761</link>    <guid>https://juejin.cn/post/7584650421124382761</guid>    <pubDate>2025-12-17T10:49:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584650421124382761" data-draft-id="7584640225645051967" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="从零搭建使用 Open-AutoGML 搜索附近的美食"/> <meta itemprop="keywords" content="人工智能,Android"/> <meta itemprop="datePublished" content="2025-12-17T10:49:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Exploring"/> <meta itemprop="url" content="https://juejin.cn/user/2172290705131016"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            从零搭建使用 Open-AutoGML 搜索附近的美食
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2172290705131016/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Exploring
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T10:49:17.000Z" title="Wed Dec 17 2025 10:49:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. 环境配置</h2>
<p>下载项目库：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzai-org%2FOpen-AutoGLM" target="_blank" title="https://github.com/zai-org/Open-AutoGLM" ref="nofollow noopener noreferrer">github.com/zai-org/Ope…</a> ，
使用 Open-AutoGML 需要安装以下开发环境：</p>
<ul>
<li>python 环境</li>
<li>ADB 调试工具</li>
<li>ADB Keyboard(用于文本输入)</li>
<li>模型部署（可以使用 BigModel 三方模型）</li>
</ul>
<h3 data-id="heading-1">1.1. Python 环境搭建</h3>
<p>检查 python 环境。建议使用 Python 3.10 及以上版本。</p>
<pre><code class="hljs">python3 -V
</code></pre>
<p>这里建议使用虚拟环境创建对应的环境。可以使用 Poetry 或 Python 自带的虚拟环境管理。这里使用 Python 自带的虚拟环境管理。</p>
<ul>
<li>创建虚拟环境：python3 -m venv 环境名</li>
<li>激活虚拟环境：source 环境名/bin/activate</li>
<li>删除旧环境：rm -rf venv</li>
<li>用python3.9创建新环境：python3.9 -m venv venv</li>
<li>退出环境：deactivate</li>
</ul>
<p>安装示例如下：</p>
<pre><code class="hljs language-sql" lang="sql">➜  <span class="hljs-keyword">Open</span><span class="hljs-operator">-</span>AutoGLM git:(main) python3<span class="hljs-number">.10</span> <span class="hljs-operator">-</span>m venv venv3<span class="hljs-number">.10</span>
➜  <span class="hljs-keyword">Open</span><span class="hljs-operator">-</span>AutoGLM git:(main) source venv3<span class="hljs-number">.10</span><span class="hljs-operator">/</span>bin<span class="hljs-operator">/</span>activate
(venv3<span class="hljs-number">.10</span>) ➜  <span class="hljs-keyword">Open</span><span class="hljs-operator">-</span>AutoGLM git:(main) 
</code></pre>
<p>这样我们就进入了创建的3.14虚拟环境。</p>
<h3 data-id="heading-2">1.2. ADB 调试工具</h3>
<p>这里可以参照 Android 官方 ADB 指令的下载与安装文档：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Ftools%2Freleases%2Fplatform-tools%3Fhl%3Dzh-cn" target="_blank" title="https://developer.android.com/tools/releases/platform-tools?hl=zh-cn" ref="nofollow noopener noreferrer">developer.android.com/tools/relea…</a></p>
<p>adb 安装完毕后，可打开终端命令行来检查一下是否成功。</p>
<pre><code class="hljs language-arduino" lang="arduino">➜  ~ adb devices
List of devices attached
<span class="hljs-number">2212</span>d99e	device
</code></pre>
<h3 data-id="heading-3">1.3. ADB Keyboard(用于文本输入)</h3>
<p>下载 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsenzhk%2FADBKeyBoard%2Fblob%2Fmaster%2FADBKeyboard.apk" target="_blank" title="https://github.com/senzhk/ADBKeyBoard/blob/master/ADBKeyboard.apk" ref="nofollow noopener noreferrer">安装包</a> 并在对应的安卓设备中进行安装。 注意，安装完成后还需要到 <code>设置-输入法</code> 或者 <code>设置-键盘列表</code> 中启用 <code>ADB Keyboard</code> 才能生效(或使用命令<code>adb shell ime enable com.android.adbkeyboard/.AdbIME</code><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsenzhk%2FADBKeyBoard%2Fblob%2Fmaster%2FREADME.md%23how-to-use" target="_blank" title="https://github.com/senzhk/ADBKeyBoard/blob/master/README.md#how-to-use" ref="nofollow noopener noreferrer">How-to-use</a>)。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/866b2c19d59a44eaa4b398d93c04a811~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXhwbG9yaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766573356&amp;x-signature=QyYmAvYasAAz63gcLA1GSzgl31E%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">1.4. 安装项目依赖</h3>
<p>将 Open-AutoGML（<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzai-org%2FOpen-AutoGLM" target="_blank" title="https://github.com/zai-org/Open-AutoGLM" ref="nofollow noopener noreferrer">github.com/zai-org/Ope…</a>）项目下载到本地后，进入该项目对应的环境。执行以下指令：</p>
<pre><code class="hljs language-erlang" lang="erlang">pip install -r requirements.txt 
pip install -e .
</code></pre>
<h3 data-id="heading-5">1.5. 启动模型服务</h3>
<p>你可以选择自行部署模型服务，或使用第三方模型服务商。如果机器资源比较大，可以选择自行部署模型服务。这里我选择使用<strong>智谱 BigModel。</strong></p>
<ul>
<li>文档: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.bigmodel.cn%2Fcn%2Fapi%2Fintroduction" target="_blank" title="https://docs.bigmodel.cn/cn/api/introduction" ref="nofollow noopener noreferrer">docs.bigmodel.cn/cn/api/intr…</a></li>
<li><code>--base-url</code>: <code>https://open.bigmodel.cn/api/paas/v4</code></li>
<li><code>--model</code>: <code>autoglm-phone</code></li>
<li><code>--apikey</code>: 在智谱平台申请你的 API Key</li>
</ul>
<p>使用示例：</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># 使用智谱 BigModel</span>
python main.py --base-url <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/open.bigmodel.cn/api</span><span class="hljs-regexp">/paas/v</span>4 --model <span class="hljs-string">"autoglm-phone"</span> --apikey <span class="hljs-string">"your-bigmodel-api-key"</span> <span class="hljs-string">"打开美团搜索附近的火锅店"</span>
</code></pre>
<h4 data-id="heading-6">1.5.1. 验证 apiKey</h4>
<p>我们在智谱AI开放平台申请 apikey 后可以参照 API 使用文档（<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.bigmodel.cn%2Fcn%2Fapi%2Fintroduction" target="_blank" title="https://docs.bigmodel.cn/cn/api/introduction" ref="nofollow noopener noreferrer">docs.bigmodel.cn/cn/api/intr…</a>）来验证是否可用。</p>
<p>使用 curl 指令输入：</p>
<pre><code class="hljs language-vbnet" lang="vbnet">curl -X POST <span class="hljs-string">"https://open.bigmodel.cn/api/paas/v4/chat/completions"</span> \
-H <span class="hljs-string">"Content-Type: application/json"</span> \
-H <span class="hljs-string">"Authorization: Bearer YOUR_API_KEY"</span> \
-d <span class="hljs-comment">'{</span>
    <span class="hljs-string">"model"</span>: <span class="hljs-string">"glm-4.6"</span>,
    <span class="hljs-string">"messages"</span>: [
        {
            <span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>,
            <span class="hljs-string">"content"</span>: <span class="hljs-string">"你是一个有用的AI助手。"</span>
        },
        {
            <span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>,
            <span class="hljs-string">"content"</span>: <span class="hljs-string">"你好，请介绍一下自己。"</span>
        }
    ],
    <span class="hljs-string">"temperature"</span>: <span class="hljs-number">1.0</span>,
    <span class="hljs-string">"stream"</span>: <span class="hljs-literal">true</span>
}<span class="hljs-comment">'</span>
</code></pre>
<p>输出类似下面的内容时说明可用：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fca7d48b6c16488eae3d33227edaa029~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXhwbG9yaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766573356&amp;x-signature=VmYVS0qQte7xx9%2Blwskm9VVsBHI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">2. 实操用智谱 AI 帮我点外卖</h2>
<p>在完成环境安装后，我们来进行一次火锅的搜索。在工程项目目录中执行：</p>
<pre><code class="hljs language-css" lang="css"> python <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.py</span> <span class="hljs-attr">--base-url</span> https://open.bigmodel.cn/api/paas/v4 --model <span class="hljs-string">"autoglm-phone"</span> --apikey <span class="hljs-string">"apikey"</span> <span class="hljs-string">"打开美团搜索附近的火锅店"</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0019ec9625eb452c8185e5ea1027c87c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXhwbG9yaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766573356&amp;x-signature=kKBrvzqQ%2BjctNtwH0z2t3tejpS4%3D" alt="desktop1.gif" loading="lazy"/></p>
<h2 data-id="heading-8">3. 常见错误</h2>
<h3 data-id="heading-9">3.1. ERROR: No matching distribution found for Pillow&gt;=12.0.0</h3>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">ERROR:</span> No matching distribution found <span class="hljs-keyword">for</span> Pillow&gt;=<span class="hljs-number">12.0</span>.<span class="hljs-number">0</span>
<span class="hljs-symbol">WARNING:</span> You are <span class="hljs-keyword">using</span> pip version <span class="hljs-number">21.1</span>.<span class="hljs-number">2</span>; however, version <span class="hljs-number">25.3</span> <span class="hljs-built_in">is</span> available.
You should consider upgrading via the <span class="hljs-comment">'/Users/dengshiwei/Documents/AI/Open-AutoGLM/venv/bin/python -m pip install --upgrade pip' command.</span>
</code></pre>
<p>使用的 python3.14 版本，在安装依赖时找不到 Pillow &gt;= 12.0.0 的版本，解决方法时降低到 python 版本到 3.10。这里可以使用 pyenv 来管理本地多个 python 版本。</p>
<pre><code class="hljs language-sql" lang="sql">brew <span class="hljs-keyword">update</span>
brew install pyenv
pyenv install <span class="hljs-number">3.10</span><span class="hljs-number">.14</span>
进入到项目，切换对应的 python 版本：pyenv <span class="hljs-keyword">local</span> <span class="hljs-number">3.10</span><span class="hljs-number">.14</span>
</code></pre>
<h3 data-id="heading-10">3.2. 键盘没效果</h3>
<p>我本地已经展示安装了键盘，但是运行 main.py 时还是提示找不到。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8498eef71b564b82a86e530ae71446b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXhwbG9yaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766573356&amp;x-signature=VIo%2BI6cp5a2DPuumTXqUJOc%2BKbQ%3D" alt="" loading="lazy"/></p>
<p>这里的原因是源码中的检测方法遇到手机权限的问题。</p>
<pre><code class="hljs language-ini" lang="ini"> <span class="hljs-attr">result</span> = subprocess.run(
          <span class="hljs-section">["adb", "shell", "ime", "list", "-s"]</span>,
          <span class="hljs-attr">capture_output</span>=<span class="hljs-literal">True</span>,
          <span class="hljs-attr">text</span>=<span class="hljs-literal">True</span>,
          <span class="hljs-attr">timeout</span>=<span class="hljs-number">10</span>,
      )
</code></pre>
<p>本质上是 <code>adb shell ime list -s</code> 指令，但是很多手机都没权限了。</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">java.lang.SecurityException:</span> <span class="hljs-string">uid</span> <span class="hljs-number">2000 </span><span class="hljs-string">does</span> <span class="hljs-string">not</span> <span class="hljs-string">have</span> <span class="hljs-string">android.permission.WRITE_SECURE_SETTINGS.</span>
</code></pre>
<p>这里可以改为：</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">result</span> = subprocess.run(
    <span class="hljs-section">["adb", "shell", "settings", "get", "secure", "enabled_input_methods"]</span>,
    <span class="hljs-attr">capture_output</span>=<span class="hljs-literal">True</span>,
    <span class="hljs-attr">text</span>=<span class="hljs-literal">True</span>,
    <span class="hljs-attr">timeout</span>=<span class="hljs-number">3</span>,
)
</code></pre>
<p>后续我会提交一个 MR 来兼容一下这个问题。</p>
<h2 data-id="heading-11">4. 体验感受</h2>
<p>使用 <strong>智谱 BigModel 的模型情况下，</strong> 环境的搭建还是比较方便的，能够很快把开发环境搭建完成。如果是本地部署模型会比较耗费时间。总体来看还是比较智能的，能够操作挺多 App 的，还需要继续体验，但是目前感觉要商业化这个耗时还得继续优化，我执行了一个搜索火锅的指令，大概整体耗时在35s左右，跟中兴的 AI 手机体验比，耗时还有点多。持续进步吧。</p>
<p>#AutoGLM #智谱AI #OpenAutoGLM</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[解锁Git隐藏力量：从熟练到大师的高级命令指南]]></title>    <link>https://juejin.cn/post/7583912899389521963</link>    <guid>https://juejin.cn/post/7583912899389521963</guid>    <pubDate>2025-12-16T00:14:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583912899389521963" data-draft-id="7583910637958742035" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="解锁Git隐藏力量：从熟练到大师的高级命令指南"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2025-12-16T00:14:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="小马写码"/> <meta itemprop="url" content="https://juejin.cn/user/3940246036939358"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            解锁Git隐藏力量：从熟练到大师的高级命令指南
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3940246036939358/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    小马写码
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T00:14:36.000Z" title="Tue Dec 16 2025 00:14:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>你是否曾对Git感到畏惧，认为它仅仅是一个复杂的版本控制工具？对于许多开发者而言，Git的日常使用仅限于<code>add</code>、<code>commit</code>和<code>push</code>这几个基础命令。然而，在这看似简单的界面之下，隐藏着一个强大而优雅的版本控制系统，等待着我们去探索和掌握。</p>
<p>本文将带你超越Git的基础操作，深入那些能够显著提升工作效率、解决复杂问题的高级命令和技巧，让你从Git使用者蜕变为Git大师。</p>
<h2 data-id="heading-0">一、时光旅行者：精准操控提交历史</h2>
<h3 data-id="heading-1">交互式变基：重写历史的能力</h3>
<pre><code class="hljs language-bash" lang="bash">git rebase -i HEAD~5
</code></pre>
<p>这个命令会打开一个交互式界面，允许你重新排序、合并、编辑或删除最近的5个提交。这不仅仅是整理提交历史的美容工具，更是保持项目历史清晰可读的关键。</p>
<p><strong>实用场景</strong>：将多个琐碎的提交合并成一个逻辑完整的提交，使代码审查更加高效。</p>
<h3 data-id="heading-2">引用日志：找回丢失的提交</h3>
<pre><code class="hljs language-bash" lang="bash">git reflog
</code></pre>
<p>当你意外地执行了<code>git reset --hard</code>或删除了分支，<code>reflog</code>就是你的时光机。它记录了仓库中所有的HEAD移动历史，让你能够找回看似"丢失"的提交。</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 找回丢失的提交</span>
git reflog
<span class="hljs-comment"># 找到对应的提交哈希</span>
git checkout &lt;commit-hash&gt;
</code></pre>
<h2 data-id="heading-3">二、侦探模式：深入代码变更分析</h2>
<h3 data-id="heading-4">二分查找：快速定位问题引入点</h3>
<pre><code class="hljs language-bash" lang="bash">git bisect start
git bisect bad HEAD
git bisect good v1.0
</code></pre>
<p>当你在数百个提交中寻找引入bug的那个特定提交时，<code>git bisect</code>可以自动化这个过程。Git会智能地引导你在提交历史中进行二分查找，大大缩短问题定位时间。</p>
<h3 data-id="heading-5">高级日志筛选：精准过滤提交历史</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 查找特定作者在特定时间范围内的提交</span>
git <span class="hljs-built_in">log</span> --author=<span class="hljs-string">"John"</span> --since=<span class="hljs-string">"2023-01-01"</span> --until=<span class="hljs-string">"2023-06-30"</span>

<span class="hljs-comment"># 查找包含特定字符串的提交</span>
git <span class="hljs-built_in">log</span> -S <span class="hljs-string">"functionName"</span> --oneline

<span class="hljs-comment"># 可视化分支拓扑结构</span>
git <span class="hljs-built_in">log</span> --graph --oneline --all --decorate
</code></pre>
<h2 data-id="heading-6">三、工作流优化：提升日常效率</h2>
<h3 data-id="heading-7">储藏区的高级用法</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 储藏时添加描述</span>
git stash push -m <span class="hljs-string">"正在修复登录功能"</span>

<span class="hljs-comment"># 应用特定储藏</span>
git stash apply stash@{2}

<span class="hljs-comment"># 创建新分支并应用储藏</span>
git stash branch feature-login-fix stash@{1}
</code></pre>
<p>储藏不仅仅是临时保存更改，结合描述和分支创建，它可以成为上下文切换的强大工具。</p>
<h3 data-id="heading-8">提交修正：完善最近的提交</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 修改最近的提交信息</span>
git commit --amend

<span class="hljs-comment"># 添加文件到最近的提交</span>
git add forgotten_file.js
git commit --amend --no-edit
</code></pre>
<p><code>--amend</code>选项允许你修改最近的提交，而不是创建一个新的提交，保持历史整洁。</p>
<h2 data-id="heading-9">四、高级合并与冲突解决</h2>
<h3 data-id="heading-10">使用ours/theirs策略</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 在合并冲突时，选择特定版本</span>
git checkout --ours conflicted-file.js
git checkout --theirs conflicted-file.js
</code></pre>
<p>当处理复杂合并冲突时，这些命令可以快速选择保留当前分支或合并分支的版本。</p>
<h3 data-id="heading-11">重新应用合并</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 放弃当前合并尝试，重新开始</span>
git merge --abort

<span class="hljs-comment"># 使用特定策略重新合并</span>
git merge -X patience feature-branch
</code></pre>
<p><code>-X patience</code>选项使用更智能的差异算法，在处理复杂重构时特别有用。</p>
<h2 data-id="heading-12">五、钩子与自定义：自动化工作流</h2>
<p>Git钩子位于<code>.git/hooks</code>目录中，允许你在特定事件发生时执行脚本：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 示例：提交前检查代码格式</span>
<span class="hljs-comment">#!/bin/bash</span>
<span class="hljs-comment"># pre-commit hook</span>
<span class="hljs-keyword">if</span> ! npm run lint; <span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"代码格式检查失败，请修复后再提交"</span>
  <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>
</code></pre>
<p>通过自定义钩子，你可以集成代码检查、测试运行、提交信息验证等自动化流程。</p>
<h2 data-id="heading-13">六、性能优化与维护</h2>
<h3 data-id="heading-14">垃圾回收与优化</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 清理不必要的文件并优化本地仓库</span>
git gc --aggressive --prune=now

<span class="hljs-comment"># 重新打包对象以提高效率</span>
git repack -a -d --depth=250 --window=250
</code></pre>
<p>对于大型仓库，定期执行这些维护命令可以显著提升Git性能。</p>
<h3 data-id="heading-15">部分克隆：处理巨型仓库</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 只克隆最近的历史</span>
git <span class="hljs-built_in">clone</span> --depth=1 https://github.com/large-repo.git

<span class="hljs-comment"># 按需获取特定目录</span>
git <span class="hljs-built_in">clone</span> --filter=blob:none --sparse https://github.com/large-repo.git
<span class="hljs-built_in">cd</span> large-repo
git sparse-checkout <span class="hljs-built_in">set</span> src/core
</code></pre>
<h2 data-id="heading-16">结语：从工具使用者到流程设计者</h2>
<p>正如我们所见，Git远不止于基础版本控制。这些高级命令和技巧将你从被动的工具使用者转变为主动的版本控制流程设计者。当你掌握了<code>reflog</code>的恢复能力、<code>bisect</code>的侦探技巧、交互式变基的历史重塑能力时，Git不再是一个需要小心应对的复杂系统，而是你开发工作流的自然延伸。</p>
<p>真正掌握Git的高级功能意味着你能以更少的努力完成更多工作，在团队协作中提供更多价值，并在面对复杂版本控制场景时保持从容。开始尝试这些命令，将它们融入你的日常工作中，你将会发现一个更高效、更可控的开发体验。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[一个看似“送分”的需求为何翻车？——前端状态机实战指南]]></title>    <link>https://juejin.cn/post/7584071941025497103</link>    <guid>https://juejin.cn/post/7584071941025497103</guid>    <pubDate>2025-12-16T10:55:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584071941025497103" data-draft-id="7583799807594201122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="一个看似“送分”的需求为何翻车？——前端状态机实战指南"/> <meta itemprop="keywords" content="前端,JavaScript,面试"/> <meta itemprop="datePublished" content="2025-12-16T10:55:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="前端一小卒"/> <meta itemprop="url" content="https://juejin.cn/user/1943592286564045"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            一个看似“送分”的需求为何翻车？——前端状态机实战指南
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592286564045/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    前端一小卒
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T10:55:02.000Z" title="Tue Dec 16 2025 10:55:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>源码太枯燥？一个人啃不动？关注公众号-「前端小卒」，让我做你的源码领读人。这里没有晦涩的说教，只有清晰的 <strong>Vue 3 &amp; React 19</strong> 源码拆解。积跬步以至千里，<strong>小卒也能进阶为大将</strong>，我们一起过河！♟️</p>
</blockquote>
<p>故事的开始总是惊人的相似。</p>
<p>上个月，需求评审会上，收到了产品经理的一个需求：“做一个扫码支付弹窗。逻辑很简单：打开弹窗获取二维码，然后每隔 2 秒轮询一次接口，扫码成功就跳转，30 秒超时就让用户刷新”</p>
<p>一拍脑袋，凭经验判断，需求不难。作为一名熟练的“React工程师”，我极其自信地敲下代码，开始写需求代码。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [isLoading, setIsLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// 加载二维码中</span>
<span class="hljs-keyword">const</span> [isPolling, setIsPolling] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// 轮询接口中</span>
<span class="hljs-keyword">const</span> [isError, setIsError] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);     <span class="hljs-comment">// 出错了</span>
<span class="hljs-keyword">const</span> [retryCount, setRetryCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);   <span class="hljs-comment">// 重试次数</span>
<span class="hljs-comment">// ...后面还有一堆 useEffect 和 useRef 用来存定时器ID</span>
</code></pre>
<p>当时的我还未意识到，这几个state给我带来了好几个bug单。</p>
<h2 data-id="heading-0">隐形的“状态爆炸”</h2>
<p>正式提测之后，我就陆陆续续收到了好几个bug单。</p>
<p>“大佬，我就在网络卡顿的时候多点了几下‘刷新’，页面就乱了”</p>
<p>浏览器的Network 面板上，几十个轮询请求在并发执行。UI 界面上，“正在加载”的转圈动画和“网络错误”的红字提示竟然同时存在，甚至还能点击“重试”按钮！！！</p>
<p>按照我的逻辑，<code>isLoading</code> 为 <code>true</code> 时，<code>isError</code> 肯定得是 <code>false</code> 啊。我明明写了 <code>setLoading(true); setError(false)</code>，为啥会出现这种问题！</p>
<p><strong>为什么会失控？</strong></p>
<p>问题的根源就在于试图用线性的逻辑，去对抗非线性的现实。</p>
<p>当 <code>isLoading</code>、<code>isPolling</code>、<code>isError</code> 三个布尔值混在一起时，理论上它们能组合出 2^3=8 种状态。而在真实的业务逻辑中，合法的状态可能只有 3 种（加载中、轮询中、失败）。那么<strong>剩下的那 5 种“不可能存在的状态”，一不小心没处理就会存在大量的缺陷。</strong></p>
<p>我们花费 80% 的时间，不是在写业务，而是在写防御代码，去堵那些因为逻辑漏洞而产生的混沌状态。</p>
<p>面对那坨膨胀且脆弱的代码，再进行修修补补已经无济于事，必须要大刀阔斧式的推倒重来，和PM和运营沟通，需求进行延期，代码打回去重写。</p>
<p>解决此类问题的最佳方案，不是更高超的 <code>if-else</code> 技巧，而是一个经典的数学模型——<strong>有限状态机</strong> 。它的核心理念是：<strong>系统在任何时刻只能处于一种状态，且状态的流转是确定的。</strong></p>
<h2 data-id="heading-1">引入有限状态机 (FSM)</h2>
<h3 data-id="heading-2">绘制状态流转图</h3>
<p>在写代码之前，我先画了一张图。这才是逻辑的核心：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1a5e676a636492fa064b0e5d1417ea8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LiA5bCP5Y2S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766487301&amp;x-signature=bhvOGCRnUe0UJ6YFfe0nvs14GVQ%3D" alt="svgviewer-png-output (52).png" loading="lazy"/></p>
<p>流程图清晰的展示出来：</p>
<ul>
<li>只有在 <code>FAILURE</code> 或 <code>IDLE</code> 状态下，才允许发起 <code>FETCH</code>。</li>
<li>在 <code>LOADING</code> 状态下，无论用户怎么点击，都不会触发多余的请求。</li>
</ul>
<h3 data-id="heading-3">引入useReducer</h3>
<p>React 的 <code>useReducer</code> 是实现状态机的绝佳工具，通过它可以将状态管理收敛到一个纯函数中。</p>
<p><strong>定义状态与事件</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 状态枚举，只有这五种状态</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">STATES</span> = {
  <span class="hljs-attr">IDLE</span>: <span class="hljs-string">'idle'</span>,
  <span class="hljs-attr">LOADING</span>: <span class="hljs-string">'loading'</span>,
  <span class="hljs-attr">POLLING</span>: <span class="hljs-string">'polling'</span>,
  <span class="hljs-attr">SUCCESS</span>: <span class="hljs-string">'success'</span>,
  <span class="hljs-attr">FAILURE</span>: <span class="hljs-string">'failure'</span>,
};

<span class="hljs-comment">// 事件枚举：用户或系统能做的动作</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">EVENTS</span> = {
  <span class="hljs-attr">FETCH</span>: <span class="hljs-string">'FETCH'</span>,      <span class="hljs-comment">// 触发获取</span>
  <span class="hljs-attr">RESOLVE</span>: <span class="hljs-string">'RESOLVE'</span>,  <span class="hljs-comment">// 成功拿到二维码</span>
  <span class="hljs-attr">REJECT</span>: <span class="hljs-string">'REJECT'</span>,    <span class="hljs-comment">// 失败</span>
  <span class="hljs-attr">DONE</span>: <span class="hljs-string">'DONE'</span>,        <span class="hljs-comment">// 支付完成</span>
  <span class="hljs-attr">TIMEOUT</span>: <span class="hljs-string">'TIMEOUT'</span>,  <span class="hljs-comment">// 超时</span>
};
</code></pre>
<p><strong>编写 Reducer</strong></p>
<p>这里使用双重 Switch 结构：先判断<strong>当前处于什么状态</strong>，再判断<strong>发生了什么事件</strong>。</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">const</span> machineReducer = (state, event) =&gt; {
  <span class="hljs-keyword">switch</span> (state.status) {
    <span class="hljs-keyword">case</span> STATES.IDLE:
    <span class="hljs-keyword">case</span> STATES.FAILURE:
      <span class="hljs-comment">// 只有在空闲或失败时，才允许发起 FETCH</span>
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.FETCH) {
        <span class="hljs-keyword">return</span> { ...state, status: STATES.LOADING, <span class="hljs-type">error</span>: null };
      }
      <span class="hljs-keyword">return</span> state; <span class="hljs-comment">// 其他事件直接忽略！</span>

    <span class="hljs-keyword">case</span> STATES.LOADING:
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.RESOLVE) {
        <span class="hljs-keyword">return</span> { ...state, status: STATES.POLLING, qrCode: event.data };
      }
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.REJECT) {
        <span class="hljs-keyword">return</span> { ...state, status: STATES.FAILURE, <span class="hljs-type">error</span>: event.<span class="hljs-type">error</span> };
      }
      <span class="hljs-comment">// 🔥 重点：这里没有处理 'FETCH' 事件。</span>
      <span class="hljs-comment">// 这意味着：在 Loading 状态下，无论用户怎么狂点按钮，代码都不会有任何反应！</span>
      <span class="hljs-keyword">return</span> state;

    <span class="hljs-keyword">case</span> STATES.POLLING:
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.DONE) <span class="hljs-keyword">return</span> { ...state, status: STATES.SUCCESS };
      <span class="hljs-keyword">if</span> (event.<span class="hljs-keyword">type</span> === EVENTS.TIMEOUT) <span class="hljs-keyword">return</span> { ...state, status: STATES.FAILURE, <span class="hljs-type">error</span>: <span class="hljs-string">'超时'</span> };
      <span class="hljs-keyword">return</span> state;

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
};
</code></pre>
<p><strong>组件层调用（分离副作用）</strong></p>
<p>现在，组件层的代码变得异常清爽。我们只需要根据状态去渲染 UI，并利用 <code>useEffect</code> 处理轮询副作用。</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">PaymentModal</span> = () =&gt; {
  const <span class="hljs-section">[state, dispatch]</span> = useReducer(machineReducer, { status: STATES.IDLE })<span class="hljs-comment">;</span>

  // 业务动作：只负责派发意图，不负责判断逻辑
  const <span class="hljs-attr">handleFetch</span> = () =&gt; {
    dispatch({ type: EVENTS.FETCH })<span class="hljs-comment">;</span>
    api.getQrCode()
      .then(<span class="hljs-attr">data</span> =&gt; dispatch({ type: EVENTS.RESOLVE, data }))
      .catch(<span class="hljs-attr">err</span> =&gt; dispatch({ type: EVENTS.REJECT, error: err }))<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  // 副作用管理：由状态驱动轮询
  useEffect(() =&gt; {
    let <span class="hljs-attr">timer</span> = null<span class="hljs-comment">;</span>
    if (<span class="hljs-attr">state.status</span> === STATES.POLLING) {
      <span class="hljs-attr">timer</span> = setInterval(async () =&gt; {
        const <span class="hljs-attr">res</span> = await api.checkStatus()<span class="hljs-comment">;</span>
        if (res.success) dispatch({ type: EVENTS.DONE })<span class="hljs-comment">;</span>
      }, 2000)<span class="hljs-comment">;</span>
    }
    return () =&gt; clearInterval(timer)<span class="hljs-comment">;</span>
  }, <span class="hljs-section">[state.status]</span>)<span class="hljs-comment">; // 状态变了，副作用自动清理或重启</span>

  return (
    &lt;div&gt;
      {<span class="hljs-attr">state.status</span> === STATES.LOADING &amp;&amp; &lt;Spinner /&gt;}
      {<span class="hljs-attr">state.status</span> === STATES.POLLING &amp;&amp; &lt;QRCode img={state.qrCode} /&gt;}
      {<span class="hljs-attr">state.status</span> === STATES.FAILURE &amp;&amp; &lt;ErrorView <span class="hljs-literal">on</span>Retry={handleFetch} /&gt;}
      {<span class="hljs-attr">state.status</span> === STATES.SUCCESS &amp;&amp; &lt;SuccessView /&gt;}
    &lt;/div&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>看懂了吗？我们不再修补漏洞，通过清晰的定义状态和触发事件，收敛业务代码复杂度，消除可能产生的bug。</p>
<hr/>
<h2 data-id="heading-4">深度解析状态机</h2>
<p>写到这里，可能很多同学会问： <strong>“这不就是 Switch-Case 吗？为什么要叫它状态机？”</strong> 我们需要把视角拉高，从理论层面彻底理解它，以便应对更复杂的场景。</p>
<h3 data-id="heading-5">什么是有限状态机</h3>
<p>有限状态机不是一种代码写法，而是一个数学模型。它由五个要素组成：</p>
<ul>
<li><strong>有限的状态</strong> ：比如红绿灯只有红、黄、绿，不可能出现“红绿”。</li>
<li><strong>有限的事件</strong> ：比如“倒计时结束”、“按下按钮”。</li>
<li><strong>转换规则</strong> ：即 <code>状态 A + 事件 B -&gt; 状态 C</code>。</li>
<li><strong>初始状态</strong> 。</li>
<li><strong>最终状态</strong> 。</li>
</ul>
<p>它的核心理念就是：<strong>系统在任何时刻只能处于一种状态，且状态的流转是确定的。</strong></p>
<h3 data-id="heading-6">为什么前端需要它</h3>
<p>前端早已不是“展示页面”那么简单了，我们是在浏览器里跑 APP。以下场景如果不以状态机思维去写，迟早会崩：</p>
<ul>
<li><strong>多媒体播放器</strong>： 你以为只有 <code>Play</code> 和 <code>Pause</code>？错。 还有 <code>Buffering</code>（缓冲中）、<code>Seeking</code>（拖拽进度条中）、<code>Ended</code>（播放结束）、<code>Error</code>（加载失败）这些场景。</li>
<li><strong>复杂的表单向导</strong> ： 第一步 -&gt; 第二步 -&gt; 第三步。 用户在第二步点了“上一步”，数据怎么存？在第三步提交失败了，退回哪一步？</li>
<li><strong>TCP/WebSocket 连接管理</strong>： <code>Connecting</code> -&gt; <code>Connected</code> -&gt; <code>Reconnecting</code> -&gt; <code>Disconnected</code>。 如果在 <code>Reconnecting</code> 期间用户手动点了“断开”，应该去哪？</li>
<li><strong>Canvas 游戏/交互可视化</strong>： 拖拽模式、绘图模式、选中模式。</li>
</ul>
<p>读到这里，你可能已经热血沸腾，准备把项目里的所有组件都重写一遍。</p>
<p><strong>且慢。</strong></p>
<p>软件工程的核心在于权衡，如果需求仅仅是控制一个模态框的显示与隐藏，引入状态机只会增加无谓的代码复杂度。</p>
<p>那么，在实际业务开发中，我们应该依据哪些标准来判定是否需要引入状态机？当你的组件出现以下三种特征之一时，就可以结合业务适当的考虑重构了。</p>
<h3 data-id="heading-7">存在多个需要“手动同步”的boolean变量</h3>
<p>这是最显著的信号。检查一下你的组件 State 定义，如果出现了两个及以上的boolean，且彼此之间存在逻辑关联，就需要警惕，<strong>当你需要维护多个布尔值变量的同步关系时，状态机是更优解</strong>。</p>
<p>例如：</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// 典型的高风险代码</span>
const <span class="hljs-selector-attr">[isLoading, setLoading]</span> = <span class="hljs-built_in">useState</span>(false);
const <span class="hljs-selector-attr">[isError, setError]</span> = <span class="hljs-built_in">useState</span>(false);
const <span class="hljs-selector-attr">[hasData, setHasData]</span> = <span class="hljs-built_in">useState</span>(false);
</code></pre>
<p>在这种结构下，开发者需要时刻警惕变量间的同步问题。比如在 <code>setLoading(true)</code> 时，必须记得同时重置 <code>setError(false)</code>。这种依赖“人为细心”来维护的代码，随着迭代周期的拉长，几乎必然会产生 Bug。</p>
<h3 data-id="heading-8">业务逻辑要求状态必须“互斥”</h3>
<p>在很多场景下，业务状态在逻辑上是完全排他的。</p>
<p>比如开头的“扫码轮询”场景：一个请求不可能既在“进行中”又“已失败”。然而，如果使用分散的布尔值控制，代码层面是允许 <code>{ isLoading: true, isError: true }</code> 这种非法组合存在的。</p>
<p>这种逻辑上的“排他性”如果不能在代码结构上得到强制保证，就会导致 UI 渲染出错（例如 Loading 动画和错误提示重叠显示）。所以如果UI展示依赖于严格互斥的状态（如 Promise 的 Pending/Resolved/Rejected），请尽可能的使用状态机强制约束。</p>
<h3 data-id="heading-9">状态流转路径有严格限制</h3>
<p>简单的业务状态流转是自由的，而复杂的业务往往是有向图。</p>
<p>以“退款流程”为例：</p>
<ul>
<li>✅ 合法路径：<code>申请中</code> -&gt; <code>审核通过</code> -&gt; <code>打款中</code></li>
<li>❌ 非法路径：<code>申请中</code> -&gt; <code>打款中</code>（跳过审核）</li>
</ul>
<p>如果使用传统的 <code>if-else</code> 来防御非法跳转，代码中会充斥着大量 <code>if (status === 'AUDIT_PASS')</code> 这样的防御性判断。而状态机可以通过配置 <code>transitions</code>，天然地禁止了所有未定义的跳转路径。</p>
<p>所以当业务逻辑不仅仅关乎“当前是什么状态”，更关乎“当前状态允许变更为哪些状态”时，可以考虑引入状态机。</p>
<h3 data-id="heading-10">技术选型对照表</h3>
<p>在开始写代码前，可以参考下表进行决策：</p>

























<table><thead><tr><th><strong>业务场景特征</strong></th><th><strong>推荐方案</strong></th></tr></thead><tbody><tr><td>简单的开/关状态 (Toggle)</td><td><code>useState(boolean)</code></td></tr><tr><td>简单的互斥状态 (Loading/Success/Error)</td><td>字符串枚举 (String Enum)</td></tr><tr><td><strong>状态复杂，且存在特定的流转规则</strong></td><td><strong>状态机 (Reducer / XState)</strong></td></tr><tr><td><strong>涉及定时器、重试、取消等异步竞态问题</strong></td><td><strong>状态机 (推荐)</strong></td></tr></tbody></table>
<p>记住，工具是为了解决复杂度而生的。简单留给 <code>useState</code>，复杂留给状态机。</p>
<h2 data-id="heading-11">限制即自由</h2>
<p>写烂代码的本质，往往是我们试图在混乱中保留过多的“自由度”。而优秀架构的本质，通常在于<strong>限制</strong>。正如那句话说的：「<strong>喜欢就会放肆，但爱就是克制</strong>」</p>
<p>状态机严格规定了什么状态下能做什么事，这种克制提高了我们的前端稳定性。</p>
<p><strong>最后送给所有的前端的一句话：</strong></p>
<blockquote>
<p>所有的 Bug，本质上都是 <strong>“非法的状态”或“错误的转换”</strong>。</p>
<p>TypeScript 帮我们在编译时静态地规避了非法类型，而状态机则帮我们在运行时动态地管理状态流转。</p>
<p>TypeScript + State Machine = 前端逻辑的绝对防御。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[微信小程序真机预览-数字不等宽如何解决]]></title>    <link>https://juejin.cn/post/7584650857070051337</link>    <guid>https://juejin.cn/post/7584650857070051337</guid>    <pubDate>2025-12-17T09:55:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7584650857070051337" data-draft-id="7584742635483529226" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="微信小程序真机预览-数字不等宽如何解决"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2025-12-17T09:55:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="人生_何处_不相逢"/> <meta itemprop="url" content="https://juejin.cn/user/3940246036976285"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            微信小程序真机预览-数字不等宽如何解决
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3940246036976285/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    人生_何处_不相逢
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-17T09:55:41.000Z" title="Wed Dec 17 2025 09:55:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"🍋"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"🍓"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"🍑"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"🍉"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"🍒"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h4 data-id="heading-0"><strong>数字显示不等宽</strong></h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa06a35eb6fe4196aed98801878d1b37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq655SfX-S9leWkhF_kuI3nm7jpgKI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766570140&amp;x-signature=3zXRONF6Pdr3LsINcE18a903n9A%3D" alt="image.png" loading="lazy"/></p>
<p><strong>你按照设计稿， 把右侧时间设置了同一个字号， 以为就是100%还原了UI设计，还心里小小得意🤔</strong></p>
<p><strong>真机预览你发现</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e97b9d23f0b44679f19d53a31693a94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq655SfX-S9leWkhF_kuI3nm7jpgKI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766570140&amp;x-signature=WWrqgV205ODyhCMXcRW5IOAesFU%3D" alt="image.png" loading="lazy"/></p>
<p><strong>哎呦我去</strong>，我猜你肯定区检查了字体大小，肯定也预览了好几遍，才确认这个情况确实不是字体大小不一样导致的</p>
<p>😂😂😂 其实是因为 <code>0</code> 和 <code>1</code> 与其它数字宽度不一致导致的</p>
<p>那解决方法肯定是 <strong>设置一个等宽字体</strong> 但是那么多等宽字体 <strong>到底应该选择那个字体？</strong></p>
<p>选择的不对，就会造成下面的效果</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b5796ff319e4786b3fc54d4890fdb37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq655SfX-S9leWkhF_kuI3nm7jpgKI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766570140&amp;x-signature=sX%2F%2FwSH36ggY7f71Qag7wX%2FspfA%3D" alt="image.png" loading="lazy"/></p>
<p>或者这样</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4395107f11f4853a8165fa1f34b3ae3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq655SfX-S9leWkhF_kuI3nm7jpgKI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766570140&amp;x-signature=naE%2FFV1antOI1%2BStGw0dE31p3Hc%3D" alt="image.png" loading="lazy"/></p>
<p><strong>如果你也出现上述问题，你不妨设置</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">font-family</span>: Helvetica Neue;
</code></pre>
<p>这个试试看，你会得到以下结果</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93017b3d83704a3fa27d6927c7a0c933~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq655SfX-S9leWkhF_kuI3nm7jpgKI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766570140&amp;x-signature=H%2Bk9DfgO87dFlaGeK8qB5%2FFiixA%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>好了，最后希望大家都不要踩坑，愿所有bug的解决方法 都可以百度到 谢谢</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[flutter使用package_info_plus库获取应用信息的教程]]></title>    <link>https://juejin.cn/post/7583910637958807571</link>    <guid>https://juejin.cn/post/7583910637958807571</guid>    <pubDate>2025-12-16T00:40:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583910637958807571" data-draft-id="7583577045578530842" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="flutter使用package_info_plus库获取应用信息的教程"/> <meta itemprop="keywords" content="前端,Flutter,Android"/> <meta itemprop="datePublished" content="2025-12-16T00:40:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="鹏多多"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            flutter使用package_info_plus库获取应用信息的教程
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    鹏多多
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-16T00:40:41.000Z" title="Tue Dec 16 2025 00:40:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"•";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">1. 简介</h2>
<p>在 Flutter 应用开发中，获取应用自身的信息（如应用名称、版本号、包名等）是一项常见需求，这些信息可用于展示在关于页面、用于统计分析或实现特定业务逻辑。<code>package_info_plus</code> 插件是 Flutter 生态中获取应用元数据的最佳选择，支持多平台且使用简单。本文将详细介绍如何使用该插件获取各类应用信息。</p>
<p><code>package_info_plus</code> 是一个跨平台插件，用于获取应用的包信息和元数据，它是 <code>package_info</code> 插件的升级版，由 Flutter Community 维护。</p>
<p><strong>核心特点</strong>：</p>
<ul>
<li>支持 iOS、Android、Web、Windows、macOS 和 Linux 多平台</li>
<li>能够获取应用名称、包名、版本号、构建号等关键信息</li>
<li>用法简单，API 直观</li>
<li>与最新的 Flutter 版本保持兼容</li>
</ul>
<p><strong>可获取的主要信息</strong>：</p>
<ul>
<li>应用名称（应用商店中显示的名称）</li>
<li>包名/应用 ID（如 com.example.myapp）</li>
<li>版本名称（如 1.0.0）</li>
<li>版本号/构建号（如 1）</li>
<li>应用签名（部分平台）</li>
</ul>
<h2 data-id="heading-1">2. 安装与配置</h2>
<p>在项目的 <code>pubspec.yaml</code> 文件中添加 <code>package_info_plus</code> 依赖：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">dependencies:</span>
  <span class="hljs-attr">flutter:</span>
    <span class="hljs-attr">sdk:</span> <span class="hljs-string">flutter</span>
  <span class="hljs-attr">package_info_plus:</span> <span class="hljs-string">^4.0.0</span>  <span class="hljs-comment"># 使用最新版本</span>
</code></pre>
<p>运行以下命令安装依赖：</p>
<pre><code class="hljs language-bash" lang="bash">flutter pub get
</code></pre>
<h3 data-id="heading-2">2.1. 平台特定配置</h3>
<p><code>package_info_plus</code> 在大多数平台上无需额外配置即可使用，但某些平台可能需要注意以下事项：</p>
<p><strong>Web 平台</strong>：
需要在 <code>web/index.html</code> 中添加一些元数据，插件会从这里读取信息：</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- 其他头部内容 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"application-name"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"你的应用名称"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"version"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"1.0.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"build-number"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"1"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"package"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"com.example.myapp"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
</code></pre>
<p><strong>其他平台</strong>：
Android、iOS、Windows、macOS 和 Linux 平台不需要额外配置，插件会自动从各自的配置文件中读取信息。</p>
<h2 data-id="heading-3">3. 基本使用方法</h2>
<p>在需要使用的 Dart 文件中导入 <code>package_info_plus</code>：</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:package_info_plus/package_info_plus.dart'</span>;
</code></pre>
<h3 data-id="heading-4">3.1. 获取应用信息</h3>
<p><code>package_info_plus</code> 提供了一个 <code>PackageInfo</code> 类，通过它可以获取所有应用信息。获取过程是异步的，通常使用 <code>await</code> 关键字：</p>
<pre><code class="hljs language-dart" lang="dart">Future&lt;<span class="hljs-keyword">void</span>&gt; getAppInfo() <span class="hljs-keyword">async</span> {
  PackageInfo packageInfo = <span class="hljs-keyword">await</span> PackageInfo.fromPackageInfo();
  
  <span class="hljs-built_in">String</span> appName = packageInfo.appName;
  <span class="hljs-built_in">String</span> packageName = packageInfo.packageName;
  <span class="hljs-built_in">String</span> version = packageInfo.version;
  <span class="hljs-built_in">String</span> buildNumber = packageInfo.buildNumber;
  
  <span class="hljs-built_in">print</span>(<span class="hljs-string">'应用名称: <span class="hljs-subst">$appName</span>'</span>);
  <span class="hljs-built_in">print</span>(<span class="hljs-string">'包名: <span class="hljs-subst">$packageName</span>'</span>);
  <span class="hljs-built_in">print</span>(<span class="hljs-string">'版本号: <span class="hljs-subst">$version</span>'</span>);
  <span class="hljs-built_in">print</span>(<span class="hljs-string">'构建号: <span class="hljs-subst">$buildNumber</span>'</span>);
}
</code></pre>
<h3 data-id="heading-5">3.2. 详细信息说明</h3>
<p><code>PackageInfo</code> 类提供的主要属性：</p>








































<table><thead><tr><th>属性</th><th>说明</th><th>平台支持</th></tr></thead><tbody><tr><td><code>appName</code></td><td>应用的用户可见名称</td><td>所有平台</td></tr><tr><td><code>packageName</code></td><td>应用的唯一标识符（Android 的包名，iOS 的 Bundle ID 等）</td><td>所有平台</td></tr><tr><td><code>version</code></td><td>应用的版本名称（如 1.0.0）</td><td>所有平台</td></tr><tr><td><code>buildNumber</code></td><td>应用的构建号或版本代码（通常是整数）</td><td>所有平台</td></tr><tr><td><code>buildSignature</code></td><td>应用的签名信息</td><td>Android 特有</td></tr><tr><td><code>installerStore</code></td><td>应用的安装来源商店</td><td>Android 特有</td></tr></tbody></table>
<h2 data-id="heading-6">4. 实战示例</h2>
<p>下面是一个完整的示例，创建一个展示应用信息的"关于"页面：</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:package_info_plus/package_info_plus.dart'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AboutPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> AboutPage({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  State&lt;AboutPage&gt; createState() =&gt; _AboutPageState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_AboutPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">AboutPage</span>&gt; </span>{
  <span class="hljs-keyword">late</span> Future&lt;PackageInfo&gt; _packageInfoFuture;

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    <span class="hljs-comment">// 初始化时获取应用信息</span>
    _packageInfoFuture = PackageInfo.fromPackageInfo();
  }

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Scaffold(
      appBar: AppBar(
        title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'关于我们'</span>),
      ),
      body: FutureBuilder&lt;PackageInfo&gt;(
        future: _packageInfoFuture,
        builder: (context, snapshot) {
          <span class="hljs-keyword">if</span> (snapshot.connectionState == ConnectionState.waiting) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> Center(child: CircularProgressIndicator());
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (snapshot.hasError) {
            <span class="hljs-keyword">return</span> Center(child: Text(<span class="hljs-string">'获取应用信息失败: <span class="hljs-subst">${snapshot.error}</span>'</span>));
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!snapshot.hasData) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> Center(child: Text(<span class="hljs-string">'无法获取应用信息'</span>));
          }

          PackageInfo packageInfo = snapshot.data!;

          <span class="hljs-keyword">return</span> SingleChildScrollView(
            padding: <span class="hljs-keyword">const</span> EdgeInsets.all(<span class="hljs-number">16.0</span>),
            child: Column(
              children: [
                <span class="hljs-comment">// 应用图标</span>
                <span class="hljs-keyword">const</span> CircleAvatar(
                  radius: <span class="hljs-number">60</span>,
                  child: Icon(Icons.android, size: <span class="hljs-number">60</span>), <span class="hljs-comment">// 实际项目中替换为应用图标</span>
                ),
                <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">24</span>),
                
                <span class="hljs-comment">// 应用名称</span>
                Text(
                  packageInfo.appName,
                  style: Theme.of(context).textTheme.headlineMedium,
                ),
                <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">8</span>),
                
                <span class="hljs-comment">// 版本信息</span>
                Text(
                  <span class="hljs-string">'版本: <span class="hljs-subst">${packageInfo.version}</span> (<span class="hljs-subst">${packageInfo.buildNumber}</span>)'</span>,
                  style: Theme.of(context).textTheme.titleMedium,
                ),
                <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">24</span>),
                
                <span class="hljs-comment">// 详细信息列表</span>
                _buildInfoItem(<span class="hljs-string">'包名'</span>, packageInfo.packageName),
                <span class="hljs-keyword">if</span> (packageInfo.buildSignature.isNotEmpty)
                  _buildInfoItem(<span class="hljs-string">'应用签名'</span>, packageInfo.buildSignature),
                <span class="hljs-keyword">if</span> (packageInfo.installerStore != <span class="hljs-keyword">null</span> &amp;&amp; packageInfo.installerStore!.isNotEmpty)
                  _buildInfoItem(<span class="hljs-string">'安装来源'</span>, packageInfo.installerStore!),
                
                <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">32</span>),
                
                <span class="hljs-comment">// 版权信息</span>
                <span class="hljs-keyword">const</span> Text(
                  <span class="hljs-string">'© 2023 你的公司名称. 保留所有权利.'</span>,
                  style: TextStyle(color: Colors.grey),
                ),
              ],
            ),
          );
        },
      ),
    );
  }

  <span class="hljs-comment">// 构建信息项</span>
  Widget _buildInfoItem(<span class="hljs-built_in">String</span> label, <span class="hljs-built_in">String</span> value) {
    <span class="hljs-keyword">return</span> Padding(
      padding: <span class="hljs-keyword">const</span> EdgeInsets.symmetric(vertical: <span class="hljs-number">8.0</span>),
      child: Row(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text(
            <span class="hljs-string">'<span class="hljs-subst">$label</span>: '</span>,
            style: <span class="hljs-keyword">const</span> TextStyle(
              fontWeight: FontWeight.bold,
              width: <span class="hljs-number">100</span>,
            ),
          ),
          Expanded(
            child: Text(value),
          ),
        ],
      ),
    );
  }
}
</code></pre>
<p>这个示例创建了一个完整的"关于"页面，包含以下功能：</p>
<ul>
<li>使用 <code>FutureBuilder</code> 处理异步获取应用信息的过程</li>
<li>展示加载状态、错误状态和成功状态</li>
<li>显示应用名称、图标、版本号等基本信息</li>
<li>根据平台特性选择性展示签名和安装来源信息</li>
</ul>
<h2 data-id="heading-7">5. 高级应用场景</h2>
<p>下面是一些高级的应用场景，例如：</p>
<h3 data-id="heading-8">5.1. 版本更新检查</h3>
<p>可以使用获取到的版本号实现版本更新检查功能：</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VersionChecker</span> </span>{
  <span class="hljs-comment">// 假设这是从服务器获取的最新版本号</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> _latestVersion = <span class="hljs-string">"1.1.0"</span>;
  
  Future&lt;<span class="hljs-built_in">bool</span>&gt; isUpdateAvailable() <span class="hljs-keyword">async</span> {
    PackageInfo packageInfo = <span class="hljs-keyword">await</span> PackageInfo.fromPackageInfo();
    <span class="hljs-keyword">return</span> _compareVersions(packageInfo.version, _latestVersion) &lt; <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-comment">// 版本号比较工具方法</span>
  <span class="hljs-built_in">int</span> _compareVersions(<span class="hljs-built_in">String</span> current, <span class="hljs-built_in">String</span> latest) {
    <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">int</span>&gt; currentParts = current.split(<span class="hljs-string">'.'</span>).map(<span class="hljs-built_in">int</span>.parse).toList();
    <span class="hljs-built_in">List</span>&lt;<span class="hljs-built_in">int</span>&gt; latestParts = latest.split(<span class="hljs-string">'.'</span>).map(<span class="hljs-built_in">int</span>.parse).toList();
    
    <span class="hljs-built_in">int</span> maxLength = max(currentParts.length, latestParts.length);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; maxLength; i++) {
      <span class="hljs-built_in">int</span> currentPart = i &lt; currentParts.length ? currentParts[i] : <span class="hljs-number">0</span>;
      <span class="hljs-built_in">int</span> latestPart = i &lt; latestParts.length ? latestParts[i] : <span class="hljs-number">0</span>;
      
      <span class="hljs-keyword">if</span> (currentPart &lt; latestPart) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
      <span class="hljs-keyword">if</span> (currentPart &gt; latestPart) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  }
}

<span class="hljs-comment">// 使用示例</span>
<span class="hljs-keyword">void</span> checkForUpdates() <span class="hljs-keyword">async</span> {
  VersionChecker checker = VersionChecker();
  <span class="hljs-built_in">bool</span> hasUpdate = <span class="hljs-keyword">await</span> checker.isUpdateAvailable();
  <span class="hljs-keyword">if</span> (hasUpdate) {
    <span class="hljs-comment">// 显示更新提示</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"有新版本可用！"</span>);
  }
}
</code></pre>
<h3 data-id="heading-9">5.2. 应用使用统计</h3>
<p>结合设备信息和应用信息，可以实现应用使用统计：</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:device_info_plus/device_info_plus.dart'</span>;

Future&lt;<span class="hljs-keyword">void</span>&gt; trackAppUsage() <span class="hljs-keyword">async</span> {
  PackageInfo packageInfo = <span class="hljs-keyword">await</span> PackageInfo.fromPackageInfo();
  DeviceInfoPlugin deviceInfo = DeviceInfoPlugin();
  
  <span class="hljs-built_in">String</span> trackingInfo = <span class="hljs-string">'''
  应用信息:
  - 名称: <span class="hljs-subst">${packageInfo.appName}</span>
  - 版本: <span class="hljs-subst">${packageInfo.version}</span>
  - 包名: <span class="hljs-subst">${packageInfo.packageName}</span>
  
  设备信息:
  '''</span>;
  
  <span class="hljs-keyword">if</span> (Platform.isAndroid) {
    AndroidDeviceInfo androidInfo = <span class="hljs-keyword">await</span> deviceInfo.androidInfo;
    trackingInfo += <span class="hljs-string">'- 设备: <span class="hljs-subst">${androidInfo.brand}</span> <span class="hljs-subst">${androidInfo.model}</span>\n'</span>;
    trackingInfo += <span class="hljs-string">'- 系统版本: Android <span class="hljs-subst">${androidInfo.version.release}</span>'</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Platform.isIOS) {
    IosDeviceInfo iosInfo = <span class="hljs-keyword">await</span> deviceInfo.iosInfo;
    trackingInfo += <span class="hljs-string">'- 设备: <span class="hljs-subst">${iosInfo.model}</span>\n'</span>;
    trackingInfo += <span class="hljs-string">'- 系统版本: iOS <span class="hljs-subst">${iosInfo.systemVersion}</span>'</span>;
  }
  
  <span class="hljs-comment">// 实际项目中，这里会将统计信息发送到服务器</span>
  <span class="hljs-built_in">print</span>(trackingInfo);
}
</code></pre>
<h3 data-id="heading-10">5.3. 动态配置应用行为</h3>
<p>根据应用版本动态配置应用行为：</p>
<pre><code class="hljs language-dart" lang="dart">Future&lt;<span class="hljs-keyword">void</span>&gt; configureAppBehavior() <span class="hljs-keyword">async</span> {
  PackageInfo packageInfo = <span class="hljs-keyword">await</span> PackageInfo.fromPackageInfo();
  
  <span class="hljs-comment">// 根据不同版本启用不同功能</span>
  <span class="hljs-keyword">if</span> (packageInfo.version.startsWith(<span class="hljs-string">'1.0.'</span>)) {
    <span class="hljs-comment">// v1.0.x 版本的配置</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'配置基础功能'</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (packageInfo.version.startsWith(<span class="hljs-string">'1.1.'</span>)) {
    <span class="hljs-comment">// v1.1.x 版本的配置</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'配置高级功能'</span>);
  }
  
  <span class="hljs-comment">// 根据构建号启用测试功能</span>
  <span class="hljs-built_in">int</span> buildNumber = <span class="hljs-built_in">int</span>.tryParse(packageInfo.buildNumber) ?? <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (buildNumber &gt;= <span class="hljs-number">100</span>) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'启用beta功能'</span>);
  }
}
</code></pre>
<h2 data-id="heading-11">6. 注意事项</h2>
<ul>
<li><strong>异步处理</strong>
<ul>
<li><code>PackageInfo.fromPackageInfo()</code> 是异步方法，必须正确处理异步操作</li>
<li>建议在应用启动时获取一次应用信息并缓存，避免重复获取</li>
<li>使用 <code>FutureBuilder</code> 或状态管理工具（如 Provider、Bloc）处理 UI 渲染</li>
</ul>
</li>
<li><strong>平台差异</strong>
<ul>
<li>不同平台上的信息可能有所不同，尤其是 <code>buildSignature</code> 和 <code>installerStore</code> 等平台特定属性</li>
<li>Web 平台需要手动配置元数据，其他平台则自动读取</li>
<li>处理平台特定属性时，应先检查其是否存在或不为空</li>
</ul>
</li>
<li><strong>版本号管理</strong>
<ul>
<li>保持 <code>pubspec.yaml</code>、AndroidManifest.xml 和 Info.plist 中的版本信息同步</li>
<li>建立清晰的版本号命名规则（如语义化版本 主版本.次版本.修订号）</li>
<li>构建号应随每次构建递增，用于区分不同构建</li>
</ul>
</li>
<li><strong>性能考虑</strong>
<ul>
<li>应用信息不会频繁变化，无需多次获取</li>
<li>建议在应用初始化阶段获取并存储在全局状态中</li>
<li>避免在 UI 渲染关键路径中获取应用信息</li>
</ul>
</li>
</ul>
<h2 data-id="heading-12">7. 常见问题解决</h2>
<ul>
<li><strong>信息不准确或未更新</strong>
<ul>
<li>确保所有平台的配置文件都已更新版本信息</li>
<li>运行 <code>flutter clean</code> 清理缓存后重新构建</li>
<li>对于 Web 平台，检查 <code>index.html</code> 中的元数据是否正确</li>
</ul>
</li>
<li><strong>某些属性为空</strong>
<ul>
<li>某些属性（如 <code>installerStore</code>）仅在特定条件下才有值</li>
<li>检查是否在正确的平台上访问平台特定属性</li>
<li>Web 平台需要手动配置所有属性</li>
</ul>
</li>
<li><strong>构建错误</strong>
<ul>
<li>确保使用的 <code>package_info_plus</code> 版本与 Flutter 版本兼容</li>
<li>检查是否正确导入了包</li>
<li>尝试更新插件到最新版本</li>
</ul>
</li>
</ul>
<h2 data-id="heading-13">8. 总结</h2>
<p><code>package_info_plus</code> 是 Flutter 开发中获取应用元数据的实用工具，它提供了简单直观的 API，支持多平台，能够满足大多数应用对获取自身信息的需求。</p>
<p>合理利用应用信息可以提升用户体验，简化开发流程，并为应用的统计分析提供支持。更多详细信息可以参考 <a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fpackage_info_plus" target="_blank" title="https://pub.dev/packages/package_info_plus" ref="nofollow noopener noreferrer">官方文档</a>。</p>
<hr/>
<blockquote>
<p>本次分享就到这儿啦，我是鹏多多，深耕前端的技术创作者，如果您看了觉得有帮助，欢迎评论，关注，点赞，转发，我们下次见~</p>
</blockquote>
<p>PS：在本页按F12，在console中输入document.getElementsByClassName('panel-btn')[0].click();有惊喜哦~</p>
<p><code>往期文章</code></p>
<ul>
<li><a href="https://juejin.cn/post/7582808491582619684" target="_blank" title="https://juejin.cn/post/7582808491582619684">Flutter输入框TextField的属性与实战用法全面解析+示例</a></li>
<li><a href="https://juejin.cn/post/7581693431740448831" target="_blank" title="https://juejin.cn/post/7581693431740448831">Flutter自定义日历table_calendar完全指南+案例</a></li>
<li><a href="https://juejin.cn/post/7580389111921786943" target="_blank" title="https://juejin.cn/post/7580389111921786943">flutter-屏幕自适应插件flutter_screenutil教程全指南</a></li>
<li><a href="https://juejin.cn/post/7579101504289882166" target="_blank" title="https://juejin.cn/post/7579101504289882166">flutter-使用url_launcher打开链接/应用/短信/邮件和评分跳转等</a></li>
<li><a href="https://juejin.cn/post/7570923924365230143" target="_blank" title="https://juejin.cn/post/7570923924365230143">flutter图片选择库multi_image_picker_plus和image_picker的对比和使用解析</a></li>
<li><a href="https://juejin.cn/post/7568136081302978623" target="_blank" title="https://juejin.cn/post/7568136081302978623">解锁flutter弹窗新姿势：dialog-flutter_smart_dialog插件解读+案例</a></li>
<li><a href="https://juejin.cn/post/7559089440901545999" target="_blank" title="https://juejin.cn/post/7559089440901545999">flutter-切换状态显示不同组件10种实现方案全解析</a></li>
<li><a href="https://juejin.cn/post/7555079970491318308" target="_blank" title="https://juejin.cn/post/7555079970491318308">flutter-详解控制组件显示的两种方式Offstage与Visibility</a></li>
<li><a href="https://juejin.cn/post/7535358416182788122" target="_blank" title="https://juejin.cn/post/7535358416182788122">flutter-使用AnimatedDefaultTextStyle实现文本动画</a></li>
<li><a href="https://juejin.cn/post/7537339432291434496" target="_blank" title="https://juejin.cn/post/7537339432291434496">flutter-使用SafeArea组件处理各机型的安全距离</a></li>
<li><a href="https://juejin.cn/spost/7537593417099149321" target="_blank" title="https://juejin.cn/spost/7537593417099149321">flutter-实现渐变色边框背景以及渐变色文字</a></li>
<li><a href="https://juejin.cn/post/7543474419240370185" target="_blank" title="https://juejin.cn/post/7543474419240370185">flutter-使用confetti制作炫酷纸屑爆炸粒子动画</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>