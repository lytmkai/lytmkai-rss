<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[@tdesign/uniapp çš„ Vue2.x é€‚é…è¯´æ˜]]></title>    <link>https://juejin.cn/post/7602901195154030644</link>    <guid>https://juejin.cn/post/7602901195154030644</guid>    <pubDate>2026-02-05T04:52:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901195154030644" data-draft-id="7602916013877067791" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="@tdesign/uniapp çš„ Vue2.x é€‚é…è¯´æ˜"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T04:52:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Novlan1"/> <meta itemprop="url" content="https://juejin.cn/user/1987523605435432"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            @tdesign/uniapp çš„ Vue2.x é€‚é…è¯´æ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1987523605435432/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Novlan1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T04:52:25.000Z" title="Thu Feb 05 2026 04:52:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">èƒŒæ™¯</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ftdesign.tencent.com%2Funiapp%2F" target="_blank" title="https://tdesign.tencent.com/uniapp/" ref="nofollow noopener noreferrer">@tdesign/uniapp</a> åœ¨ Vue2 ä¸­éœ€è¦åšä¸€äº›é€‚é…ã€‚</p>
<ol>
<li>ç»„ä»¶åº“ä½¿ç”¨äº† <code>:v-deep(xxx)</code>ï¼ŒVue2 ä¸‹éœ€è¦ç”¨æ’ä»¶è½¬æˆ <code>::v-deep xxx</code></li>
<li>ç»„ä»¶åº“å•ä½ä½¿ç”¨äº† <code>rpx</code>ï¼Œè¿™æ ·åœ¨å°ç¨‹åºç­‰åœºæ™¯æ›´åˆé€‚ã€‚ä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ H5 ç¯å¢ƒ <code>node_modules</code> æˆ– <code>uni_modules</code> ä¸‹çš„å†…å®¹å…¶å®ä¸ä¼šè½¬åŒ–ã€‚</li>
</ol>
<h3 data-id="heading-1">CLI æ¨¡å¼</h3>
<p>æ¨¡æ¿é¡¹ç›® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnovlan1%2Ftdesign-uniapp-vue2-cli-starter" target="_blank" title="https://github.com/novlan1/tdesign-uniapp-vue2-cli-starter" ref="nofollow noopener noreferrer">github.com/novlan1/tdeâ€¦</a></p>
<p>è§£å†³æ–¹æ¡ˆæ˜¯</p>
<ol>
<li>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnovlan1%2Ftdesign-uniapp-vue2-cli-starter%2Fblob%2Fmaster%2Fpostcss.config.js" target="_blank" title="https://github.com/novlan1/tdesign-uniapp-vue2-cli-starter/blob/master/postcss.config.js" ref="nofollow noopener noreferrer">postcss.config.js</a> ä¸­å¢åŠ ä¸€äº›æ’ä»¶</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnovlan1%2Ftdesign-uniapp-vue2-cli-starter%2Fblob%2Fmaster%2Fvue.config.js" target="_blank" title="https://github.com/novlan1/tdesign-uniapp-vue2-cli-starter/blob/master/vue.config.js" ref="nofollow noopener noreferrer">transpileDependencies</a> ä¸­é…ç½® <code>['tdesign-uniapp', 'tdesign-uniapp-chat']</code></li>
</ol>
<h3 data-id="heading-2">HBuilderX æ¨¡å¼</h3>
<p>æ¨¡æ¿é¡¹ç›® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnovlan1%2Ftdesign-uniapp-vue2-hx-starter" target="_blank" title="https://github.com/novlan1/tdesign-uniapp-vue2-hx-starter" ref="nofollow noopener noreferrer">github.com/novlan1/tdeâ€¦</a></p>
<p>è§£å†³æ–¹æ¡ˆç±»ä¼¼</p>
<ol>
<li>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnovlan1%2Ftdesign-uniapp-vue2-cli-starter%2Fblob%2Fmaster%2Fpostcss.config.js" target="_blank" title="https://github.com/novlan1/tdesign-uniapp-vue2-cli-starter/blob/master/postcss.config.js" ref="nofollow noopener noreferrer">postcss.config.js</a> ä¸­å¢åŠ ä¸€äº›æ’ä»¶ï¼Œä¸ CLI æ¨¡å¼æœ‰å·®å¼‚</li>
<li>å…ˆä¸´æ—¶ä¿®æ”¹ uni_modules/tdesign-uniapp/components ç»„ä»¶æ ·å¼å¼•å…¥æ–¹å¼</li>
</ol>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-deletion">- &lt;style scoped&gt;</span>
<span class="hljs-deletion">-  @import './button.css';</span>
<span class="hljs-addition">+ &lt;style scoped src="./button.css"&gt;</span>
&lt;/style&gt;
</code></pre>
<p>ç¬¬2æ¡æ˜¯ä¸´æ—¶æ–¹æ¡ˆï¼Œä¸‹ä¸€ä¸ªç‰ˆæœ¬ä¼˜åŒ–ä¸‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[react18+é‚£äº›ä¸å¸¸ç”¨hooks]]></title>    <link>https://juejin.cn/post/7602825342229037090</link>    <guid>https://juejin.cn/post/7602825342229037090</guid>    <pubDate>2026-02-05T03:05:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602825342229037090" data-draft-id="7602825342229004322" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="react18+é‚£äº›ä¸å¸¸ç”¨hooks"/> <meta itemprop="keywords" content="React.js"/> <meta itemprop="datePublished" content="2026-02-05T03:05:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯æ¢é™©å®¶Rick"/> <meta itemprop="url" content="https://juejin.cn/user/1623331421554183"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            react18+é‚£äº›ä¸å¸¸ç”¨hooks
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1623331421554183/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯æ¢é™©å®¶Rick
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:05:36.000Z" title="Thu Feb 05 2026 03:05:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>react18+é‚£äº›ä¸å¸¸ç”¨çš„hooksæ±‡æ€»</p>
<h3 data-id="heading-1">useActionState</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useActionState</code> æ˜¯ä¸€ä¸ªå¯ä»¥æ ¹æ®æŸä¸ªè¡¨å•åŠ¨ä½œçš„ç»“æœæ›´æ–° state çš„ Hookã€‚
ä½¿ç”¨åœºæ™¯ï¼šå¦‚æœéœ€è¦æäº¤è¡¨å•ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨åŸç”Ÿè¡¨å•åŠŸèƒ½ï¼Œä½ éœ€è¦æäº¤è¡¨å•å<strong>ä»åœ¨å½“å‰é¡µé¢</strong>ï¼ŒåŒæ—¶<strong>è®°å½•ä¸‹æäº¤çš„ä¿¡æ¯</strong>ï¼Œé‚£ä¹ˆè¿™ä¸ªhooksä¼šå¾ˆæœ‰å¸®åŠ©ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params"/>) {  
<span class="hljs-keyword">const</span> [state, formAction, isPending] = <span class="hljs-title function_">useActionState</span>(fn, initialState, permalink);
<span class="hljs-comment">// formAction ç”¨äºä¸formç»‘å®š</span>
<span class="hljs-comment">// state æäº¤åçš„çŠ¶æ€è®°å½•</span>
<span class="hljs-comment">// isPending å¯ä»¥åœ¨å¤„ç† action çš„è¿‡ç¨‹ä¸­ä½¿ç”¨å®ƒ  </span>
<span class="hljs-keyword">return</span> (  
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">{formAction}</span>&gt;</span>  
{/* ... */}  
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>  
);  
}
</code></pre>
<h3 data-id="heading-2">useFormStatus</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useFormStatus</code> æ˜¯ä¸€ä¸ªæä¾›ä¸Šæ¬¡è¡¨å•<strong>æäº¤çŠ¶æ€</strong>ä¿¡æ¯çš„ Hookã€‚
ä½¿ç”¨åœºæ™¯ï¼š<code>useFormStatus</code> é€šå¸¸ä¼šå’Œ<code>useActionState</code>åŒæ—¶ä½¿ç”¨ã€‚</p>
<ul>
<li><strong><code>useActionState</code></strong>Â å‘Šè¯‰é¡µé¢ï¼šâ€œä¸Šæ¬¡æäº¤è¿”å›äº†ä»€ä¹ˆï¼Ÿâ€ â†’ å†³å®šæ˜¯å¦æ˜¾ç¤ºâ€œå¯†ç é”™è¯¯â€</li>
<li><strong><code>useFormStatus</code></strong>Â å‘Šè¯‰æŒ‰é’®ï¼šâ€œç°åœ¨æ˜¯ä¸æ˜¯åœ¨æäº¤ï¼Ÿâ€ â†’ å†³å®šæŒ‰é’®æ˜¾ç¤ºâ€œç™»å½•ä¸­...â€œ</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Submit</span>(<span class="hljs-params"/>) {  
<span class="hljs-keyword">const</span> status = <span class="hljs-title function_">useFormStatus</span>();  <span class="hljs-comment">//å¯ä»¥çœ‹åˆ°ä¸éœ€è¦ä¼ é€’ä»»ä½•å‚æ•°</span>
<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{status.pending}</span>&gt;</span>æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>  

} 

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {  
<span class="hljs-keyword">return</span> (  
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">{action}</span>&gt;</span>  
<span class="hljs-tag">&lt;<span class="hljs-name">Submit</span> /&gt;</span>  
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>  
);  
}
</code></pre>
<h3 data-id="heading-3">useSyncExternalStore</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useSyncExternalStore</code> æ˜¯ä¸€ä¸ªè®©ä½ è®¢é˜…å¤–éƒ¨ store çš„ React Hookã€‚
å®ƒçš„ä½œç”¨æ˜¯è¿æ¥å¤–éƒ¨åº“ä¹‹åï¼Œå¤–éƒ¨åº“çš„çŠ¶æ€æ”¹å˜ï¼Œèƒ½çŸ¥é“ä»–ä»¬è¢«æ›´æ–°äº†ã€‚è¿™ä¸ªhooksæˆ‘è®¤ä¸ºåœ¨åŸºç¡€å¼€å‘çš„è¿‡ç¨‹å¹¶æ²¡æœ‰å¿…è¦ï¼Œä½†å¦‚æœæƒ³è‡ªå·±åŠ¨æ‰‹é€ ä¸€ä¸ªç±»ä¼¼reduxçš„åº“ï¼Œé‚£ä¹ˆè¿™ä¸ªç‰¹æ€§å¯ä»¥åŠ å…¥åˆ°ä½ çš„åº“ä¸­ã€‚åœ¨æœ€æ–°çš„redux Tooltik æˆ–è€…zustandä¸­éƒ½æ˜¯åœ¨åº“çš„å†…éƒ¨å°è£…å¥½çš„ã€‚
è¿™é‡Œä¸¾ä¸€ä¸ªå…¶ä»–ä¾‹å­</p>
<p><strong>ç›‘å¬çª—å£å°ºå¯¸ï¼ˆå“åº”å¼å¸ƒå±€ï¼‰</strong></p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// è‡ªå®šä¹‰ Hookï¼šè·å–çª—å£å®½é«˜ </span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useWindowSize</span>(<span class="hljs-params"/>) { 
<span class="hljs-keyword">return</span> <span class="hljs-title function_">useSyncExternalStore</span>(<span class="hljs-function">(<span class="hljs-params">callback</span>) =&gt;</span> { 
	<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, callback); 
<span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> 
	<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'resize'</span>, callback); }, <span class="hljs-function">() =&gt;</span> ({ 
		<span class="hljs-attr">width</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-attr">height</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> 
	}), <span class="hljs-function">() =&gt;</span> ({ 
		<span class="hljs-attr">width</span>: <span class="hljs-number">1200</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">800</span> }) <span class="hljs-comment">// SSR é»˜è®¤å€¼ </span>
	)}
<span class="hljs-comment">// ä½¿ç”¨ </span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) { 
	<span class="hljs-keyword">const</span> { width } = <span class="hljs-title function_">useWindowSize</span>(); 
	<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å½“å‰å®½åº¦: {width}px<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>; 
}
</code></pre>
<p><strong>è®¢é˜… localStorageï¼ˆè·¨æ ‡ç­¾åŒæ­¥ï¼‰</strong></p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// å°è£… localStorage è®¢é˜…</span>
<span class="hljs-keyword">const</span> localStorageStore = {
  <span class="hljs-attr">getSnapshot</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'theme'</span>) || <span class="hljs-string">'light'</span>,
  <span class="hljs-attr">subscribe</span>: <span class="hljs-function">(<span class="hljs-params">callback</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleStorage</span> = (<span class="hljs-params">e</span>) =&gt; {
      <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'theme'</span>) <span class="hljs-title function_">callback</span>();
    };
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'storage'</span>, handleStorage);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'storage'</span>, handleStorage);
  }
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">useTheme</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useSyncExternalStore</span>(
    localStorageStore.<span class="hljs-property">subscribe</span>,
    localStorageStore.<span class="hljs-property">getSnapshot</span>
  );
}

<span class="hljs-comment">// æ”¹å˜ä¸»é¢˜ï¼ˆå…¶ä»–æ ‡ç­¾é¡µä¼šè‡ªåŠ¨æ›´æ–°ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">setTheme</span>(<span class="hljs-params">theme</span>) {
  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'theme'</span>, theme);
  <span class="hljs-comment">// è§¦å‘ storage äº‹ä»¶ï¼ˆåŒåŸŸä¸‹å…¶ä»–æ ‡ç­¾é¡µä¼šæ”¶åˆ°ï¼‰</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StorageEvent</span>(<span class="hljs-string">'storage'</span>, { <span class="hljs-attr">key</span>: <span class="hljs-string">'theme'</span> }));
}
</code></pre>
<h3 data-id="heading-4">useDebugValue</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useDebugValue</code> æ˜¯ä¸€ä¸ª React Hookï¼Œå¯ä»¥è®©ä½ åœ¨ React å¼€å‘å·¥å…·ä¸­ä¸ºè‡ªå®šä¹‰ Hook æ·»åŠ æ ‡ç­¾ã€‚
hooksç‰¹æ€§ï¼šè§£å†³å¼€å‘è€…æ’æŸ¥é—®é¢˜çš„ç—›ç‚¹</p>
<ol>
<li>ä¸ä¼šæ±¡æŸ“æ§åˆ¶å°</li>
<li>ä¸ä¼šå’Œå…¶ä»–<code>console.log</code>æ··åœ¨ä¸€èµ·</li>
<li>åœ¨<code>react dev tools</code> ä¸­å±•ç¤º</li>
<li>å’Œç»„ä»¶æ ‘ã€<code>props</code>ã€<code>state</code> åŒå±æŸ¥çœ‹
ä¹Ÿå°±æ˜¯è¯´å®ƒèƒ½æ›´å¥½çš„æ’æŸ¥æ˜¯å“ªä¸ªhookså‡ºç°çš„é—®é¢˜ã€‚æœ€å¥½çš„æ–¹å¼æ˜¯<code>useDebugValue</code>ã€<code>console.log</code>ã€<code>debugger</code>ååŒä½¿ç”¨</li>
</ol>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useDebugValue } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;  

<span class="hljs-keyword">function</span> <span class="hljs-title function_">useOnlineStatus</span>(<span class="hljs-params"/>) {  
<span class="hljs-comment">// ...  </span>
<span class="hljs-title function_">useDebugValue</span>(isOnline ? <span class="hljs-string">'Online'</span> : <span class="hljs-string">'Offline'</span>);  
<span class="hljs-comment">// ...  </span>
}
</code></pre>
<h3 data-id="heading-5">useEffectEvent</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useEffectEvent</code> æ˜¯ä¸€ä¸ª React Hookï¼Œå®ƒå¯ä»¥è®©ä½ å°† Effect ä¸­çš„éå“åº”å¼é€»è¾‘æå–åˆ°ä¸€ä¸ªå¯å¤ç”¨çš„å‡½æ•°ä¸­ï¼Œè¿™ä¸ªå‡½æ•°ç§°ä¸º Effect Eventã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useEffect, useContext, useEffectEvent } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;  

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Page</span>(<span class="hljs-params">{ url }</span>) {  
<span class="hljs-keyword">const</span> { items } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ShoppingCartContext</span>);  
<span class="hljs-keyword">const</span> numberOfItems = items.<span class="hljs-property">length</span>;  
<span class="hljs-keyword">const</span> onNavigate = <span class="hljs-title function_">useEffectEvent</span>(<span class="hljs-function">(<span class="hljs-params">visitedUrl</span>) =&gt;</span> {  
<span class="hljs-title function_">logVisit</span>(visitedUrl, numberOfItems);  
});  
  
<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {  
<span class="hljs-title function_">onNavigate</span>(url);  
}, [url]);  
<span class="hljs-comment">// ...  </span>
}
</code></pre>
<p>å½“<code>useEffect</code>ä¸­è°ƒç”¨ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°æœ‰å¯èƒ½ä¸æ˜¯æœ€æ–°çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ä½¿ç”¨åˆ°äº†ã€‚è¿™æ˜¯ä¸€ä¸ªçœ‹èµ·æ¥å¾ˆå¥‡æ€ªçš„å·¥å…·ï¼Œå› ä¸ºå¤§å¤šæ•°æ—¶å€™æˆ‘ä»¬æ˜¯ç”¨ä¸ä¸Šçš„ã€‚
<strong>åœºæ™¯ 1ï¼šå‡½æ•°åªä¾èµ– propsï¼Œä¸” props å˜åŒ–æ—¶ effect æœ¬å°±åº”è¯¥é‡è·‘</strong></p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">UserProfile</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">fetchUser</span>(userId); <span class="hljs-comment">//  ç›´æ¥ç”¨ userIdï¼ŒæŠŠ userId æ”¾è¿›ä¾èµ–</span>
  }, [userId]); 
}
</code></pre>
<p><strong>åœºæ™¯ 2ï¼šå‡½æ•°æ˜¯çº¯å·¥å…·å‡½æ•°ï¼Œä¸è¯»ä»»ä½•ç»„ä»¶çŠ¶æ€</strong></p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">formatDate</span> = (<span class="hljs-params">date</span>) =&gt; date.<span class="hljs-title function_">toISOString</span>();

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">formatDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>())); <span class="hljs-comment">//æ— å‰¯ä½œç”¨ã€æ— é—­åŒ…é—®é¢˜</span>
}, []);
</code></pre>
<p><strong>åœºæ™¯ 3ï¼šå‡½æ•°é€šè¿‡å‚æ•°ä¼ å…¥æœ€æ–°å€¼</strong></p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">checkStatus</span>(roomId); <span class="hljs-comment">// roomId ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œæ²¡é—®é¢˜</span>
  }, <span class="hljs-number">5000</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(timer);
}, [roomId]); 
</code></pre>
<p><strong>çœŸæ­£éœ€è¦Â <code>useEffectEvent</code>Â çš„å…¸å‹åœºæ™¯ï¼ˆæå°‘æ•°ï¼‰</strong></p>
<ul>
<li><strong>ç›‘å¬å…¨å±€äº‹ä»¶</strong>ï¼ˆå¦‚Â <code>window.addEventListener</code>ï¼‰ï¼Œå›è°ƒä¸­è¦è¯»æœ€æ–° state</li>
<li><strong>å¯åŠ¨é•¿æœŸè¿è¡Œçš„å®šæ—¶å™¨</strong>ï¼ˆå¦‚å¿ƒè·³ã€è½®è¯¢ï¼‰ï¼Œä¸”éœ€è¦è®¿é—®æœ€æ–°æ•°æ®</li>
<li><strong>ä¸ç¬¬ä¸‰æ–¹åº“é›†æˆ</strong>ï¼Œå…¶å›è°ƒæ— æ³•æ§åˆ¶è°ƒç”¨æ—¶æœº</li>
</ul>
<h3 data-id="heading-6">useInsertionEffect</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useInsertionEffect</code> å¯ä»¥åœ¨å¸ƒå±€å‰¯ä½œç”¨è§¦å‘ä¹‹å‰å°†å…ƒç´ æ’å…¥åˆ° DOM ä¸­ã€‚<code>useInsertionEffect</code> æ˜¯ä¸º [[CSS-in-JS]]  åº“çš„ä½œè€…ç‰¹æ„æ‰“é€ çš„ã€‚é™¤éä½ æ­£åœ¨ä½¿ç”¨ CSS-in-JS åº“å¹¶ä¸”éœ€è¦æ³¨å…¥æ ·å¼ï¼Œå¦åˆ™ä½ åº”è¯¥ä½¿ç”¨ <code>useEffect</code> æˆ–è€… <code>useLayoutEffect</code>ã€‚
åœ¨ React 18 ä¹‹å‰ï¼Œæœ‰äº› CSS-in-JS åº“ï¼ˆæ¯”å¦‚æ—©æœŸçš„ styled-componentsï¼‰ä¼šåœ¨Â <strong>ç»„ä»¶æ¸²æŸ“æ—¶</strong>Â æˆ–Â <strong><code>useLayoutEffect</code>Â ä¸­</strong>åŠ¨æ€æ’å…¥Â <code>&lt;style&gt;</code>Â æ ‡ç­¾ã€‚
ä½†è¿™ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼š</p>
<ul>
<li>å¦‚æœåœ¨Â <strong>æ¸²æŸ“æœŸé—´</strong>Â æ’å…¥ï¼šæ¯å¸§éƒ½å¯èƒ½è§¦å‘æµè§ˆå™¨é‡æ–°è®¡ç®—æ ·å¼ï¼ˆéå¸¸æ…¢ï¼‰</li>
<li>å¦‚æœåœ¨Â <strong><code>useLayoutEffect</code></strong>Â æ’å…¥ï¼šè™½ç„¶åœ¨ DOM æ›´æ–°åï¼Œä½†åœ¨ layout è®¡ç®—å‰ï¼Œ<strong>å¯èƒ½è®©å¸ƒå±€è¯»å–åˆ°â€œè¿˜æ²¡ç”Ÿæ•ˆâ€çš„æ ·å¼</strong>ï¼Œå¯¼è‡´é”™è¯¯</li>
</ul>
<p>äºæ˜¯ React å›¢é˜ŸåŠ äº†ä¸€ä¸ª<strong>æ›´æ—©çš„æ—¶æœº</strong>ï¼š<strong>åœ¨ DOM æ›´æ–°ä¹‹åã€layout è®¡ç®—ä¹‹å‰</strong>ï¼Œä¸“é—¨ç»™ CSS-in-JS æ³¨å…¥æ ·å¼ç”¨ã€‚æ‰€ä»¥æ™®é€šä¸šåŠ¡æ— éœ€å…³æ³¨ã€‚</p>
<h3 data-id="heading-7">useImperativeHandle</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useImperativeHandle</code> æ˜¯ React ä¸­çš„ä¸€ä¸ª Hookï¼Œå®ƒèƒ½è®©ä½ è‡ªå®šä¹‰ç”± refæš´éœ²å‡ºæ¥çš„å¥æŸ„ã€‚
ç®€å•çš„è¯´å°±æ˜¯å­ç»„ä»¶æä¾›ä¸€ä¸ªå¯¹å¤–å¼€æ”¾çš„APIå¯ä»¥ä¾›çˆ¶ç»„ä»¶æ“ä½œï¼Œä»–è§£å†³äº†ä¸æƒ³æš´éœ²æ•´ä¸ªDOMèŠ‚ç‚¹è€Œæ˜¯åªæš´éœ²å…¶ä¸­å‡ ä¸ªç‰¹å®šæ–¹æ³•ã€‚
Â ä¸¾ä¸ªç»å…¸ä¾‹å­ï¼šè‡ªå®šä¹‰è¾“å…¥æ¡†</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">//  é»˜è®¤æƒ…å†µä¸‹ï¼Œçˆ¶ç»„ä»¶æ‹¿åˆ°çš„æ˜¯æ•´ä¸ª &lt;input&gt; DOM èŠ‚ç‚¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">MyInput</span>(<span class="hljs-params">props</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> {<span class="hljs-attr">...props</span>} /&gt;</span></span>;
}

<span class="hljs-comment">// çˆ¶ç»„ä»¶</span>
<span class="hljs-keyword">const</span> inputRef = <span class="hljs-title function_">useRef</span>();
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span> /&gt;</span></span> <span class="hljs-comment">// inputRef.current å°±æ˜¯åŸç”Ÿ input å…ƒç´ </span>
</code></pre>
<p>ä½†ä½ å¯èƒ½<strong>ä¸æƒ³è®©çˆ¶ç»„ä»¶ç›´æ¥æ“ä½œ DOM</strong>ï¼ˆæ¯”å¦‚æ”¹æ ·å¼ã€è¯» valueï¼‰ï¼Œè€Œåªå…è®¸å®ƒè°ƒç”¨Â <code>focus()</code>Â æˆ–Â <code>clear()</code>ã€‚
è¿™æ—¶å°±ç”¨Â <code>useImperativeHandle</code>ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { forwardRef, useImperativeHandle, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>; 
<span class="hljs-keyword">const</span> <span class="hljs-title class_">MyInput</span> = <span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> { 
<span class="hljs-keyword">const</span> inputRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>); 
<span class="hljs-comment">//  å…³é”®ï¼šè‡ªå®šä¹‰ ref æš´éœ²çš„å†…å®¹ </span>
	<span class="hljs-title function_">useImperativeHandle</span>(ref, <span class="hljs-function">() =&gt;</span> ({ 
	<span class="hljs-attr">focus</span>: <span class="hljs-function">() =&gt;</span> { 
		inputRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>(); 
	}, 
	<span class="hljs-attr">clear</span>: <span class="hljs-function">() =&gt;</span> { inputRef.<span class="hljs-property">current</span>.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>; } 
	<span class="hljs-comment">// ä¸æš´éœ² inputRef.current æœ¬èº«ï¼ </span>
	})); 
	<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span> {<span class="hljs-attr">...props</span>} /&gt;</span></span>; });
</code></pre>
<p>çˆ¶ç»„ä»¶ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> myInputRef = <span class="hljs-title function_">useRef</span>(); <span class="hljs-comment">// åªèƒ½è°ƒç”¨ä½ å…è®¸çš„æ–¹æ³• </span>
	myInputRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>(); <span class="hljs-comment">// å¯ä»¥ </span>
	myInputRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">clear</span>(); <span class="hljs-comment">// å¯ä»¥ </span>
	myInputRef.<span class="hljs-property">current</span>.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">'red'</span>; <span class="hljs-comment">// æŠ¥é”™ï¼æ²¡æœ‰ style å±æ€§</span>
</code></pre>
<p>è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªä¸‡èƒ½çš„æ–¹å¼ï¼Œå…¶å®å®ƒå¾ˆå®¹æ˜“è¢«propsæ‰€æ›¿ä»£ï¼Œä½†æ˜¯å¦‚æœæ­£åœ¨åšä¸€ä¸ªæå…¶å¤æ‚çš„ç»„ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä½¿ç”¨è¿™ä¸ªhooksã€‚</p>
<h3 data-id="heading-8">useOptimistic</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useOptimistic</code> æ˜¯ä¸€ä¸ª React Hookï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ æ›´ä¹è§‚åœ°æ›´æ–°ç”¨æˆ·ç•Œé¢ã€‚
å®˜æ–¹è¯´äº†å’Œæ²¡è¯´ä¸€æ ·ï¼Œä½†ç”¨äººè¯è¯´å°±æ˜¯è™½ç„¶è¿˜æ²¡åˆ°å¯ä»¥æ›´æ–°çš„æ—¶å€™ï¼Œæˆ‘å…ˆæ›´æ–°äº†ï¼Œå¯ä»¥å¢åŠ ç”¨æˆ·ä½“éªŒã€‚è¿™ç§åšæ³•è®©ç•Œé¢å“åº”é€Ÿåº¦ä¸ç½‘ç»œå»¶è¿Ÿå®ç°äº†è„±é’©ã€‚æœ€å…¸å‹çš„ä¾‹å­å°±æ˜¯â€œç‚¹èµâ€æŒ‰é’®ã€‚
ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå¼€å…³ï¼Œæ¯æ¬¡æ”¹å˜å¼€å…³éƒ½ä¼šè°ƒä¸€æ¬¡æ¥å£ï¼Œæˆ‘ä»¬æ ¹æ®æ¥å£çš„è¿”å›å€¼åˆ¤æ–­æ˜¯å¦æ›´æ–°é¡µé¢æ¸²æŸ“ã€‚ä½†æ˜¯è¿™ä¸ªæ—¶å€™å¤§æ¦‚ç‡ä¼šä¸€å¡ä¸€å¡çš„ï¼Œå°¤å…¶æ˜¯æ¥å£æ²¡è¿”å›å°±ç‚¹å‡»ä¸‹ä¸€æ¬¡ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„çŠ¶æ€å¯èƒ½å’Œæˆ‘ä»¬ç†æƒ³çš„çŠ¶æ€ä¸ä¸€è‡´ã€‚
ä¼ ç»Ÿçš„åšæ³•æ˜¯æˆ‘ä»¬å†ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€ä¸ºpendingï¼Œæ²¡æœ‰ç»“æŸçš„æ—¶å€™ä¸èƒ½ç‚¹å‡»ã€‚æ­¤æ—¶å¦‚æœä¸šåŠ¡é€»è¾‘å·²ç»å¾ˆå¤æ‚äº†ï¼Œæ·»åŠ çš„çŠ¶æ€åªä¼šè®©ä»£ç æ›´åŠ å¤æ‚ã€‚
<code>useOptimistic</code>åšçš„äº‹æƒ…æ˜¯å…ˆæ”¹å˜çŠ¶æ€ï¼Œå†è¯·æ±‚åˆ°ç»“æœï¼Œå¦‚æœè°ƒç”¨å¤±è´¥æˆ–è€…è¿”å›å¤±è´¥é‚£ä¹ˆå†å˜å›å»ã€‚æ¯”å¦‚è¯´ç‚¹èµçº¢å¿ƒã€‚
è™½ç„¶<code>useOptimistic</code>æ­£åœ¨è¢«reacté€æ¸æ¨å‘ä¸€ç­‰å…¬æ°‘çš„èº«ä»½ï¼Œä½†æ˜¯ä»ç„¶æœ‰é—®é¢˜ï¼Œå®ƒæ›´é€‚åˆåšä¸€äº›ç®€å•å¯å›æ»šçš„æ“ä½œï¼Œæ¯”å¦‚è¯´ç‚¹èµï¼Œå¹¶æ²¡æœ‰å¾ˆå¹¿çš„é€‚ç”¨æ€§ã€‚</p>
<h3 data-id="heading-9">useDeferredValue</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useDeferredValue</code> æ˜¯ä¸€ä¸ª React Hookï¼Œå¯ä»¥è®©ä½ å»¶è¿Ÿæ›´æ–° UI çš„æŸäº›éƒ¨åˆ†ã€‚
è¿™æ˜¯ä¸€ä¸ªé¢è¯•å¸¸è€ƒçš„hooksï¼Œä½œä¸ºæ€§èƒ½ä¼˜åŒ–çš„ä¸€ç§æ–¹å¼ã€‚
ä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½ åœ¨è¾“å…¥æ¡†ä¸­è¿›è¡Œè¾“å…¥ï¼Œä¸‹é¢çš„åˆ—è¡¨å°±è·Ÿç€æ¸²æŸ“ï¼Œæ­¤æ—¶å†reactçš„æ¸²æŸ“æœºåˆ¶ä¸­ä»–ä»¬çš„æƒé‡æ˜¯ä¸€è‡´çš„ï¼Œä¸€æ—¦è¡¨å•å‘ç”Ÿæ”¹å˜ï¼Œè¾“å…¥æ¡†ä¸å¤§åˆ—è¡¨åŒæ—¶æ¸²æŸ“é‚£ä¹ˆå°±ä¼šå¡å¡çš„ã€‚<code>useDeferredValue</code>åšçš„äº‹å°±æ˜¯è®©åˆ—è¡¨çš„ä¼˜å…ˆçº§æ”¾ä½ï¼Œæ­¤æ—¶ä¼˜å…ˆè¾“å…¥æ¡†æ¸²æŸ“ã€‚
ä½†æ˜¯å¦‚æœæ˜¯æ•°æ®é‡æ²¡æœ‰é‚£ä¹ˆå¤§çš„æƒ…å†µä¸‹ä½¿ç”¨<code>useDeferredValue</code>è¿˜ä¼šåå‘å½±å“ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useState, useDeferredValue } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;  

<span class="hljs-keyword">function</span> <span class="hljs-title function_">SearchPage</span>(<span class="hljs-params"/>) {  
<span class="hljs-keyword">const</span> [query, setQuery] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);  
<span class="hljs-keyword">const</span> deferredQuery = <span class="hljs-title function_">useDeferredValue</span>(query);  
<span class="hljs-comment">// ...  </span>
}
</code></pre>
<h3 data-id="heading-10">useTransition</h3>
<p>å®˜æ–¹æè¿°ï¼š<code>useTransition</code> æ˜¯ä¸€ä¸ªè®©ä½ å¯ä»¥åœ¨åå°æ¸²æŸ“éƒ¨åˆ† UI çš„ React Hookã€‚
è¿™ä¸ªåŒæ ·æ˜¯ä½œä¸ºä¼˜åŒ–çš„æ–°ç‰¹æ€§ï¼Œé¢è¯•ä¼šè€ƒã€‚<code>useTransition</code> çš„æ ¸å¿ƒåŸç†åŸºäº React çš„å¹¶å‘æ¨¡å¼ï¼ˆConcurrent Modeï¼‰ã€‚åœ¨å¹¶å‘æ¨¡å¼ä¸‹ï¼ŒReact å¯ä»¥æš‚åœã€ä¸­æ­¢æˆ–é‡æ–°å¯åŠ¨æ¸²æŸ“ä»»åŠ¡ï¼Œæ ¹æ®ä»»åŠ¡çš„ä¼˜å…ˆçº§çµæ´»è°ƒåº¦ã€‚<code>useTransition</code> ä¼šå°†æ›´æ–°ä»»åŠ¡æ ‡è®°ä¸ºä½ä¼˜å…ˆçº§ï¼Œä½¿å¾—é«˜ä¼˜å…ˆçº§çš„ç”¨æˆ·äº¤äº’äº‹ä»¶èƒ½å¤Ÿä¼˜å…ˆå¾—åˆ°å¤„ç†ï¼Œé¿å…ç•Œé¢å‡ºç°å‡æ­»æˆ–å¡é¡¿ç°è±¡ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> {useState, useTransition} <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;  

<span class="hljs-keyword">function</span> <span class="hljs-title function_">CheckoutForm</span>(<span class="hljs-params"/>) {  
<span class="hljs-keyword">const</span> [isPending, startTransition] = <span class="hljs-title function_">useTransition</span>();  
<span class="hljs-comment">// â€¦â€¦  </span>
}
</code></pre>
<ul>
<li><strong>startTransition</strong>ï¼šç”¨äºåŒ…è£¹éç´§æ€¥çŠ¶æ€æ›´æ–°çš„å‡½æ•°</li>
<li><strong>isPending</strong>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¿‡æ¸¡æ˜¯å¦è¿›è¡Œä¸­</li>
</ul>

























<table><thead><tr><th>åœºæ™¯</th><th>æ¨è Hook</th></tr></thead><tbody><tr><td>ç”¨æˆ·è¾“å…¥åéœ€è¦æ›´æ–°å¤§é‡åˆ—è¡¨ï¼ˆå¦‚æœç´¢ï¼‰</td><td>ä¸¤è€…éƒ½å¯ç”¨ï¼Œä½† <code>useDeferredValue</code> æ›´ç®€æ´</td></tr><tr><td>å¤šä¸ªçŠ¶æ€æ›´æ–°ä¸­ï¼Œåªæƒ³å»¶è¿Ÿå…¶ä¸­ä¸€éƒ¨åˆ†</td><td><code>useTransition</code></td></tr><tr><td>ä¸æƒ³æ”¹åŠ¨çŠ¶æ€æ›´æ–°é€»è¾‘ï¼Œåªå»¶è¿Ÿæ¸²æŸ“ç»“æœ</td><td><code>useDeferredValue</code></td></tr><tr><td>éœ€è¦æ˜¾ç¤ºâ€œåŠ è½½ä¸­â€çŠ¶æ€</td><td><code>useTransition</code>ï¼ˆè‡ªå¸¦ <code>isPending</code>ï¼‰</td></tr></tbody></table>
<p><strong><code>useTransition</code>Â æ§åˆ¶â€œæ›´æ–°æ˜¯å¦ç´§æ€¥â€ï¼Œ<code>useDeferredValue</code>Â æ§åˆ¶â€œå€¼æ˜¯å¦ç«‹å³æ¸²æŸ“â€ã€‚</strong></p>
<h2 data-id="heading-11">æ€»ç»“</h2>
<p>è¿™äº›hookså¯ä»¥åˆ†ä¸ºå››ç±»</p>

























<table><thead><tr><th>ç±»å‹</th><th>hooks</th></tr></thead><tbody><tr><td>å¤„ç†è¡¨å•ç±»</td><td>useActionStateã€useFormStatus</td></tr><tr><td>hooksè¡ç”Ÿç±»</td><td>useEffectEventã€useInsertionEffectã€useImperativeHandle</td></tr><tr><td>æå‡ç”¨æˆ·ä½“éªŒç±»</td><td>useOptimisticã€useDeferredValueã€useTransition</td></tr><tr><td>ååŠ©å¼€å‘ç±»</td><td>useSyncExternalStoreã€useDebugValue</td></tr></tbody></table>
<p>æ€»ä½“è€Œè¨€è¿™äº›hookséƒ½æ˜¯ä¸ºäº†è§£å†³ç‰¹æ®Šåœºæ™¯çš„ç‰¹æ®Šæ–¹æ¡ˆï¼Œä¸å…·æœ‰æ™®é€‚æ€§ï¼Œå½“é¡¹ç›®åº”ç”¨èŒƒå›´å°ï¼Œæ•°æ®é‡ä½ç­‰åœºæ™¯ï¼ŒåŸºç¡€çš„hookså°±èƒ½æ»¡è¶³éœ€æ±‚ã€‚ä¹‹åæˆ‘ä¼šæ±‡æ€»reactæ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼Œå°†<code>useOptimistic</code>ã€<code>useDeferredValue</code>ã€<code>useTransition</code>è¯¦ç»†ä»‹ç»ã€‚å¯¹ä¸€äº›è¡ç”Ÿç±»çš„hooksè¿›è¡Œæ‹†è§£ï¼Œè§£æå…¶ä¸­çš„åŸç†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥Promise ä»å…¥é—¨åˆ°ç²¾é€šï¼šå½»åº•è§£å†³å‰ç«¯å¼‚æ­¥å›è°ƒé—®é¢˜ï¼ï¼ï¼]]></title>    <link>https://juejin.cn/post/7602921143490117675</link>    <guid>https://juejin.cn/post/7602921143490117675</guid>    <pubDate>2026-02-05T03:06:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602921143490117675" data-draft-id="7603004323870834731" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥Promise ä»å…¥é—¨åˆ°ç²¾é€šï¼šå½»åº•è§£å†³å‰ç«¯å¼‚æ­¥å›è°ƒé—®é¢˜ï¼ï¼ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-02-05T03:06:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é©¬_xiaoen"/> <meta itemprop="url" content="https://juejin.cn/user/4438063859920414"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥Promise ä»å…¥é—¨åˆ°ç²¾é€šï¼šå½»åº•è§£å†³å‰ç«¯å¼‚æ­¥å›è°ƒé—®é¢˜ï¼ï¼ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4438063859920414/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é©¬_xiaoen
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:06:55.000Z" title="Thu Feb 05 2026 03:06:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">Promise ä»å…¥é—¨åˆ°ç²¾é€šï¼šå½»åº•è§£å†³å‰ç«¯å¼‚æ­¥å›è°ƒé—®é¢˜</h2>
<h3 data-id="heading-1">ğŸš€ ä¸€ã€Promise æ ¸å¿ƒä»‹ç»</h3>
<h4 data-id="heading-2">1. ä»€ä¹ˆæ˜¯ Promiseï¼Ÿ</h4>
<p>Promise æ˜¯ ES6ï¼ˆECMAScript 2015ï¼‰å¼•å…¥çš„<strong>å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆ</strong>ï¼Œæ˜¯ä¸€ä¸ªç”¨äºå°è£…å¼‚æ­¥æ“ä½œå¹¶ç®¡ç†å…¶ç»“æœçš„å¯¹è±¡ã€‚å®ƒè§£å†³äº†ä¼ ç»Ÿå¼‚æ­¥ç¼–ç¨‹ä¸­<strong>å›è°ƒåœ°ç‹±ï¼ˆCallback Hellï¼‰</strong> çš„åµŒå¥—é—®é¢˜ï¼Œè®©å¼‚æ­¥ä»£ç çš„é€»è¾‘æ›´æ¸…æ™°ã€æ›´æ˜“ç»´æŠ¤ï¼ŒåŒæ—¶æä¾›äº†ç»Ÿä¸€çš„å¼‚æ­¥é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæ˜¯ç°ä»£å‰ç«¯å¼‚æ­¥ç¼–ç¨‹çš„åŸºç¡€ï¼ˆasync/await æ­£æ˜¯åŸºäº Promise å®ç°çš„è¯­æ³•ç³–ï¼‰ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼šPromise å°±åƒä¸€ä¸ª<strong>å¼‚æ­¥æ“ä½œçš„â€œæ‰¿è¯ºâ€</strong> â€”â€” å¼‚æ­¥æ“ä½œæ‰§è¡Œå‰ï¼Œå®ƒå¤„äºç­‰å¾…çŠ¶æ€ï¼›å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œå®ƒä¼šå…‘ç°â€œæ‰¿è¯ºâ€ï¼ˆè¿”å›æˆåŠŸç»“æœï¼‰æˆ–æ‹’ç»â€œæ‰¿è¯ºâ€ï¼ˆè¿”å›å¤±è´¥åŸå› ï¼‰ï¼Œä¸”è¿™ä¸ªç»“æœä¸€æ—¦ç¡®å®šå°±<strong>ä¸å¯ä¿®æ”¹</strong>ã€‚</p>
<h4 data-id="heading-3">2. æ ¸å¿ƒç‰¹æ€§</h4>
<ul>
<li><strong>çŠ¶æ€ä¸å¯é€†</strong>ï¼šPromise æœ‰ä¸”ä»…æœ‰ä¸‰ç§çŠ¶æ€ï¼ŒçŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±ä¼šæ°¸ä¹…ä¿æŒè¯¥çŠ¶æ€ï¼Œä¸ä¼šå†å‘ç”Ÿå˜åŒ–ï¼›</li>
<li><strong>ç»Ÿä¸€çš„å¼‚æ­¥èŒƒå¼</strong>ï¼šå°†ä¸åŒç±»å‹çš„å¼‚æ­¥æ“ä½œï¼ˆAJAXã€å®šæ—¶å™¨ã€æ–‡ä»¶æ“ä½œç­‰ï¼‰å°è£…ä¸ºç»Ÿä¸€çš„ Promise æ¥å£ï¼Œè§£å†³å¼‚æ­¥æ“ä½œæ ¼å¼ä¸ç»Ÿä¸€çš„é—®é¢˜ï¼›</li>
<li><strong>é“¾å¼è°ƒç”¨</strong>ï¼šæ”¯æŒ <code>.then()</code>ã€<code>.catch()</code>ã€<code>.finally()</code> é“¾å¼è°ƒç”¨ï¼Œæ›¿ä»£å¤šå±‚å›è°ƒåµŒå¥—ï¼Œè®©å¼‚æ­¥ä»£ç çº¿æ€§åŒ–ï¼›</li>
<li><strong>é›†ä¸­é”™è¯¯å¤„ç†</strong>ï¼šæ”¯æŒå…¨å±€é”™è¯¯æ•è·ï¼Œä¸€ä¸ª <code>.catch()</code> å¯æ•è·é“¾å¼è°ƒç”¨ä¸­æ‰€æœ‰å‰ç½®æ“ä½œçš„é”™è¯¯ï¼Œé¿å…å•ç‹¬å¤„ç†æ¯ä¸ªå¼‚æ­¥æ“ä½œçš„å¼‚å¸¸ï¼›</li>
<li><strong>éé˜»å¡æ‰§è¡Œ</strong>ï¼šPromise å°è£…çš„å¼‚æ­¥æ“ä½œä¸ä¼šé˜»å¡æµè§ˆå™¨ä¸»çº¿ç¨‹ï¼Œä¿è¯é¡µé¢äº¤äº’çš„æµç•…æ€§ï¼›</li>
<li><strong>ä¸€æ¬¡æ€§æ‰§è¡Œ</strong>ï¼šPromise å†…éƒ¨çš„å¼‚æ­¥æ“ä½œä¸€æ—¦æ‰§è¡Œï¼Œå°±ä¼šå®Œæˆæ•´ä¸ªæµç¨‹ï¼Œä¸ä¼šè¢«é‡å¤è§¦å‘ã€‚</li>
</ul>
<h4 data-id="heading-4">3. è§£å†³çš„æ ¸å¿ƒé—®é¢˜ï¼šå›è°ƒåœ°ç‹±</h4>
<p>ä¼ ç»Ÿå¼‚æ­¥ç¼–ç¨‹ä¾èµ–å›è°ƒå‡½æ•°ï¼Œå½“å¤šä¸ªå¼‚æ­¥æ“ä½œå­˜åœ¨<strong>é¡ºåºä¾èµ–</strong>ï¼ˆåä¸€ä¸ªæ“ä½œä¾èµ–å‰ä¸€ä¸ªæ“ä½œçš„ç»“æœï¼‰æ—¶ï¼Œä¼šå‡ºç°å¤šå±‚å›è°ƒåµŒå¥—ï¼Œå½¢æˆ<strong>å›è°ƒåœ°ç‹±</strong>ï¼Œä»£ç è¡¨ç°ä¸ºã€Œå±‚å±‚ç¼©è¿›çš„é‡‘å­—å¡”ç»“æ„ã€ï¼Œå­˜åœ¨<strong>å¯è¯»æ€§å·®ã€ç»´æŠ¤å›°éš¾ã€é”™è¯¯æ— æ³•ç»Ÿä¸€æ•è·</strong>ç­‰é—®é¢˜ã€‚</p>
<p><strong>å›è°ƒåœ°ç‹±ç¤ºä¾‹ï¼ˆå®šæ—¶å™¨åµŒå¥—ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// éœ€æ±‚ï¼šä¾æ¬¡æ‰§è¡Œä¸‰ä¸ªå¼‚æ­¥æ“ä½œï¼Œåä¸€ä¸ªæ“ä½œç­‰å¾…å‰ä¸€ä¸ªå®Œæˆ</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸€æ­¥æ“ä½œå®Œæˆ'</span>);
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒæ­¥æ“ä½œå®Œæˆ'</span>);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸‰æ­¥æ“ä½œå®Œæˆ'</span>);
      <span class="hljs-comment">// æ›´å¤šåµŒå¥—...</span>
    }, <span class="hljs-number">1000</span>);
  }, <span class="hljs-number">1000</span>);
}, <span class="hljs-number">1000</span>);
</code></pre>
<p><strong>Promise æ”¹é€ åï¼ˆé“¾å¼è°ƒç”¨ï¼Œæ— åµŒå¥—ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å°è£…Promiseç‰ˆå®šæ—¶å™¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params">time</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, time));
}

<span class="hljs-comment">// çº¿æ€§é“¾å¼è°ƒç”¨ï¼Œé€»è¾‘æ¸…æ™°</span>
<span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸€æ­¥æ“ä½œå®Œæˆ'</span>))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒæ­¥æ“ä½œå®Œæˆ'</span>))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸‰æ­¥æ“ä½œå®Œæˆ'</span>));
</code></pre>
<p>å¯¹æ¯”å¯è§ï¼šPromise å½»åº•æ‘†è„±äº†å›è°ƒåµŒå¥—ï¼Œè®©å¼‚æ­¥ä»£ç çš„æ‰§è¡Œæµç¨‹ä¸åŒæ­¥ä»£ç ä¸€è‡´ï¼Œå¤§å¹…æå‡äº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<h4 data-id="heading-5">4. Promise ä¸ä¼ ç»Ÿå¼‚æ­¥æ–¹æ¡ˆçš„å¯¹æ¯”</h4>















































<table><thead><tr><th>ç‰¹æ€§</th><th>Promise</th><th>ä¼ ç»Ÿå›è°ƒå‡½æ•°</th><th>async/await</th></tr></thead><tbody><tr><td>ä»£ç ç»“æ„</td><td>é“¾å¼è°ƒç”¨ï¼Œæ— åµŒå¥—</td><td>å¤šå±‚åµŒå¥—ï¼Œå›è°ƒåœ°ç‹±</td><td>åŒæ­¥åŒ–å†™æ³•ï¼Œæœ€ç®€æ´</td></tr><tr><td>é”™è¯¯å¤„ç†</td><td>ç»Ÿä¸€ <code>.catch()</code> æ•è·</td><td>æ¯ä¸ªå›è°ƒå•ç‹¬å¤„ç†é”™è¯¯</td><td>try/catch æ•è·ï¼Œæ›´ç¬¦åˆç›´è§‰</td></tr><tr><td>å¼‚æ­¥æµç¨‹æ§åˆ¶</td><td>åŸç”Ÿæ”¯æŒï¼ˆ.then é“¾å¼ï¼‰</td><td>æ‰‹åŠ¨åµŒå¥—æ§åˆ¶</td><td>åŒæ­¥æµç¨‹æ§åˆ¶ï¼ˆåŸºäºPromiseï¼‰</td></tr><tr><td>å­¦ä¹ æˆæœ¬</td><td>ä¸­ç­‰</td><td>ä½ï¼ˆä½†å¤æ‚åœºæ™¯æ˜“å‡ºé”™ï¼‰</td><td>é«˜ï¼ˆéœ€å…ˆæŒæ¡Promiseï¼‰</td></tr><tr><td>ä¾èµ–å…³ç³»</td><td>æ— ï¼ˆES6åŸç”Ÿï¼‰</td><td>æ— </td><td>ä¾èµ–Promiseï¼ˆES7ï¼‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>ç®€å•è‡³å¤æ‚å¼‚æ­¥æµç¨‹</td><td>ç®€å•å¼‚æ­¥æ“ä½œï¼ˆæ— ä¾èµ–ï¼‰</td><td>å¤æ‚å¼‚æ­¥æµç¨‹ã€å¤šè¯·æ±‚ä¾èµ–</td></tr></tbody></table>
<p><strong>æ ¸å¿ƒç»“è®º</strong>ï¼šasync/await æ˜¯ Promise çš„è¯­æ³•ç³–ï¼Œä¼ ç»Ÿå›è°ƒæ˜¯åŸºç¡€ï¼ŒPromise æ˜¯ç°ä»£å‰ç«¯å¼‚æ­¥ç¼–ç¨‹çš„<strong>æ ¸å¿ƒæ¡¥æ¢</strong>ã€‚</p>
<h3 data-id="heading-6">ğŸ¯ äºŒã€Promise æ ¸å¿ƒæ¦‚å¿µ</h3>
<h4 data-id="heading-7">1. ä¸‰ç§çŠ¶æ€ä¸çŠ¶æ€è½¬æ¢</h4>
<p>Promise çš„æ ¸å¿ƒæ˜¯<strong>çŠ¶æ€ç®¡ç†</strong>ï¼Œå…¶ä¸€ç”Ÿä»…æœ‰ä¸‰ç§çŠ¶æ€ï¼Œä¸”çŠ¶æ€è½¬æ¢<strong>ä¸å¯é€†ã€ä»…èƒ½å‘ç”Ÿä¸€æ¬¡</strong>ï¼Œè¿™æ˜¯ Promise è§£å†³å¼‚æ­¥ä¸ç¡®å®šæ€§çš„å…³é”®ã€‚</p>
<h5 data-id="heading-8">ä¸‰ç§åŸºç¡€çŠ¶æ€</h5>
<ol>
<li><strong>pendingï¼ˆè¿›è¡Œä¸­ï¼‰</strong>ï¼šåˆå§‹çŠ¶æ€ï¼Œå¼‚æ­¥æ“ä½œå°šæœªå®Œæˆï¼Œæ­¤æ—¶æ—¢æœªæˆåŠŸä¹Ÿæœªå¤±è´¥ï¼›</li>
<li><strong>fulfilledï¼ˆå·²æˆåŠŸï¼‰</strong>ï¼šå¼‚æ­¥æ“ä½œé¡ºåˆ©å®Œæˆï¼ŒPromise å…‘ç°æ‰¿è¯ºï¼Œè¿”å›æˆåŠŸç»“æœï¼›</li>
<li><strong>rejectedï¼ˆå·²å¤±è´¥ï¼‰</strong>ï¼šå¼‚æ­¥æ“ä½œæ‰§è¡Œå¤±è´¥ï¼ŒPromise æ‹’ç»æ‰¿è¯ºï¼Œè¿”å›å¤±è´¥åŸå› ï¼ˆé”™è¯¯å¯¹è±¡ï¼‰ã€‚</li>
</ol>
<h5 data-id="heading-9">å”¯ä¸€çš„ä¸¤ç§çŠ¶æ€è½¬æ¢è·¯å¾„</h5>
<p>Promise åªèƒ½ä»åˆå§‹çŠ¶æ€å‘æœ€ç»ˆçŠ¶æ€è½¬æ¢ï¼Œä¸”è½¬æ¢åçŠ¶æ€æ°¸ä¹…å›ºå®šï¼Œ<strong>æ— æ³•åå‘è½¬æ¢ï¼Œä¹Ÿæ— æ³•åœ¨æˆåŠŸ/å¤±è´¥ä¹‹é—´åˆ‡æ¢</strong>ï¼š</p>
<ul>
<li>è·¯å¾„1ï¼š<code>pending</code> â†’ <code>fulfilled</code>ï¼ˆå¼‚æ­¥æ“ä½œæˆåŠŸï¼Œè°ƒç”¨ <code>resolve()</code> è§¦å‘ï¼‰ï¼›</li>
<li>è·¯å¾„2ï¼š<code>pending</code> â†’ <code>rejected</code>ï¼ˆå¼‚æ­¥æ“ä½œå¤±è´¥ï¼Œè°ƒç”¨ <code>reject()</code> è§¦å‘ï¼‰ã€‚</li>
</ul>
<p><strong>æ ¸å¿ƒæ³¨æ„</strong>ï¼šä¸€æ—¦çŠ¶æ€å˜ä¸º <code>fulfilled</code> æˆ– <code>rejected</code>ï¼Œå°±ä¼šæˆä¸º<strong>å®šå‹çŠ¶æ€ï¼ˆsettledï¼‰</strong>ï¼Œåç»­å†è°ƒç”¨ <code>resolve()</code> æˆ– <code>reject()</code> å‡æ— æ•ˆã€‚</p>
<h4 data-id="heading-10">2. ä¸¤ä¸ªæ ¸å¿ƒå›è°ƒå‡½æ•°</h4>
<p>Promise æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ª<strong>æ‰§è¡Œå™¨å‡½æ•°ï¼ˆexecutorï¼‰</strong>ï¼Œè¯¥å‡½æ•°ä¼šåœ¨ Promise åˆ›å»ºæ—¶<strong>ç«‹å³åŒæ­¥æ‰§è¡Œ</strong>ï¼Œä¸”æ¥æ”¶ä¸¤ä¸ªå†…ç½®çš„æ ¸å¿ƒå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç”¨äºæ‰‹åŠ¨è§¦å‘çŠ¶æ€è½¬æ¢ï¼š</p>
<ol>
<li><strong>resolve(result)</strong>ï¼šå°† Promise çŠ¶æ€ä» <code>pending</code> è½¬ä¸º <code>fulfilled</code>ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„<strong>æˆåŠŸç»“æœ</strong>ä¼ é€’å‡ºå»ï¼ˆresult å¯ä¸ºä»»æ„ç±»å‹ï¼šåŸºæœ¬ç±»å‹ã€å¯¹è±¡ã€æ•°ç»„ï¼Œç”šè‡³å¦ä¸€ä¸ª Promiseï¼‰ï¼›</li>
<li><strong>reject(reason)</strong>ï¼šå°† Promise çŠ¶æ€ä» <code>pending</code> è½¬ä¸º <code>rejected</code>ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„<strong>å¤±è´¥åŸå› </strong>ä¼ é€’å‡ºå»ï¼ˆreason é€šå¸¸ä¸º Error å¯¹è±¡ï¼Œä¾¿äºåç»­é”™è¯¯æ•è·å’Œæ ˆè¿½è¸ªï¼‰ã€‚</li>
</ol>
<p><strong>æ ¸å¿ƒæ³¨æ„</strong>ï¼šæ‰§è¡Œå™¨å‡½æ•°æ˜¯<strong>åŒæ­¥æ‰§è¡Œ</strong>çš„ï¼Œå†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ˜¯<strong>å¼‚æ­¥æ‰§è¡Œ</strong>çš„ï¼Œè¿™æ˜¯å®¹æ˜“æ··æ·†çš„å…³é”®ç‚¹ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Promise æ‰§è¡Œå™¨å‡½æ•°ï¼šåŒæ­¥æ‰§è¡Œ'</span>); <span class="hljs-comment">// ç«‹å³è¾“å‡º</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼‚æ­¥æ“ä½œï¼šå¼‚æ­¥æ‰§è¡Œ'</span>); <span class="hljs-comment">// 1ç§’åè¾“å‡º</span>
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'å¼‚æ­¥æ“ä½œæˆåŠŸ'</span>);
  }, <span class="hljs-number">1000</span>);
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Promise åˆ›å»ºå®Œæˆ'</span>); <span class="hljs-comment">// æ‰§è¡Œå™¨åç«‹å³è¾“å‡º</span>
</code></pre>
<p><strong>è¾“å‡ºé¡ºåº</strong>ï¼šPromise æ‰§è¡Œå™¨å‡½æ•° â†’ Promise åˆ›å»ºå®Œæˆ â†’ å¼‚æ­¥æ“ä½œï¼šå¼‚æ­¥æ‰§è¡Œã€‚</p>
<h4 data-id="heading-11">3. å®šå‹çŠ¶æ€ï¼ˆSettledï¼‰</h4>
<p>å®šå‹çŠ¶æ€æ˜¯ Promise çš„<strong>æœ€ç»ˆçŠ¶æ€ç»Ÿç§°</strong>ï¼ŒæŒ‡ Promise å·²å®ŒæˆçŠ¶æ€è½¬æ¢ï¼Œä¸å†å¤„äº <code>pending</code> çŠ¶æ€ï¼ŒåŒ…å«ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li><code>fulfilled</code>ï¼ˆå·²æˆåŠŸï¼‰æ˜¯å®šå‹çŠ¶æ€ï¼›</li>
<li><code>rejected</code>ï¼ˆå·²å¤±è´¥ï¼‰ä¹Ÿæ˜¯å®šå‹çŠ¶æ€ã€‚</li>
</ul>
<p>åç»­çš„ <code>.then()</code>ã€<code>.catch()</code>ã€<code>.finally()</code> æ–¹æ³•ï¼Œæœ¬è´¨éƒ½æ˜¯<strong>ç›‘å¬ Promise çš„å®šå‹çŠ¶æ€</strong>ï¼Œä¸€æ—¦çŠ¶æ€å®šå‹ï¼Œå°±ä¼šæ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°ã€‚</p>
<h3 data-id="heading-12">ğŸ“ ä¸‰ã€Promise å®ä¾‹çš„æ ¸å¿ƒæ–¹æ³•</h3>
<p>Promise å®ä¾‹æä¾›äº† <code>.then()</code>ã€<code>.catch()</code>ã€<code>.finally()</code> ä¸‰ä¸ªæ ¸å¿ƒåŸå‹æ–¹æ³•ï¼Œå‡æ”¯æŒ<strong>é“¾å¼è°ƒç”¨</strong>ï¼ˆæ ¸å¿ƒåŸå› ï¼šæ¯ä¸ªæ–¹æ³•æ‰§è¡Œåéƒ½ä¼š<strong>è¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹</strong>ï¼Œè€ŒéåŸå®ä¾‹ï¼‰ï¼Œè¿™æ˜¯è§£å†³å›è°ƒåœ°ç‹±çš„å…³é”®ã€‚</p>
<p>æ‰€æœ‰æ–¹æ³•çš„å›è°ƒå‡½æ•°éƒ½ä¼šè¢«åŠ å…¥<strong>å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼Œåœ¨æµè§ˆå™¨ä¸»çº¿ç¨‹åŒæ­¥ä»£ç æ‰§è¡Œå®Œæˆåã€å®ä»»åŠ¡æ‰§è¡Œå‰æ‰§è¡Œï¼ˆPromise å±äºå¾®ä»»åŠ¡ï¼Œè¿™æ˜¯äº‹ä»¶å¾ªç¯çš„é‡è¦çŸ¥è¯†ç‚¹ï¼‰ã€‚</p>
<h4 data-id="heading-13">1. then(onFulfilled, onRejected)ï¼šå¤„ç†æˆåŠŸ/å¤±è´¥ç»“æœ</h4>
<p><code>.then()</code> æ˜¯ Promise æœ€æ ¸å¿ƒçš„æ–¹æ³•ï¼Œç”¨äº<strong>ç›‘å¬ Promise çš„å®šå‹çŠ¶æ€</strong>ï¼Œæ¥æ”¶ä¸¤ä¸ªå¯é€‰çš„å›è°ƒå‚æ•°ï¼š</p>
<ul>
<li><strong>onFulfilled(result)</strong>ï¼šå¯é€‰ï¼ŒPromise çŠ¶æ€ä¸º <code>fulfilled</code> æ—¶æ‰§è¡Œï¼Œå‚æ•° <code>result</code> æ˜¯ <code>resolve()</code> ä¼ é€’çš„æˆåŠŸç»“æœï¼›</li>
<li><strong>onRejected(reason)</strong>ï¼šå¯é€‰ï¼ŒPromise çŠ¶æ€ä¸º <code>rejected</code> æ—¶æ‰§è¡Œï¼Œå‚æ•° <code>reason</code> æ˜¯ <code>reject()</code> ä¼ é€’çš„å¤±è´¥åŸå› ã€‚</li>
</ul>
<h5 data-id="heading-14">æ ¸å¿ƒç‰¹æ€§</h5>
<ol>
<li><strong>é“¾å¼è°ƒç”¨åŸºç¡€</strong>ï¼š<code>.then()</code> æ‰§è¡Œåè¿”å›<strong>æ–°çš„ Promise å®ä¾‹</strong>ï¼Œæ–°å®ä¾‹çš„çŠ¶æ€ç”±å½“å‰å›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœå†³å®šï¼›</li>
<li><strong>å‚æ•°å¯é€‰</strong>ï¼šå¯åªä¼  <code>onFulfilled</code>ï¼ˆä»…å¤„ç†æˆåŠŸï¼‰ï¼Œä¹Ÿå¯åªä¼  <code>onRejected</code>ï¼ˆä½†æ›´æ¨èç”¨ <code>.catch()</code> å¤„ç†å¤±è´¥ï¼‰ï¼›</li>
<li><strong>å€¼çš„ä¼ é€’</strong>ï¼šè‹¥å›è°ƒå‡½æ•°è¿”å›ä¸€ä¸ªæ™®é€šå€¼ï¼ˆé Promiseã€éæŠ›å‡ºé”™è¯¯ï¼‰ï¼Œæ–° Promise ä¼šä»¥ <code>fulfilled</code> çŠ¶æ€å°†è¯¥å€¼ä¼ é€’ç»™ä¸‹ä¸€ä¸ª <code>.then()</code>ï¼›</li>
<li><strong>é”™è¯¯é€ä¼ </strong>ï¼šè‹¥å›è°ƒå‡½æ•°æŠ›å‡ºé”™è¯¯ï¼Œæ–° Promise ä¼šä»¥ <code>rejected</code> çŠ¶æ€å°†é”™è¯¯ä¼ é€’ç»™åç»­çš„ <code>.catch()</code> æˆ– <code>.then()</code> çš„ <code>onRejected</code>ã€‚</li>
</ol>
<h5 data-id="heading-15">åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> random = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>();
  <span class="hljs-keyword">if</span> (random &gt; <span class="hljs-number">0.5</span>) {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">`æˆåŠŸï¼šéšæœºæ•°<span class="hljs-subst">${random.toFixed(<span class="hljs-number">2</span>)}</span>`</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`å¤±è´¥ï¼šéšæœºæ•°<span class="hljs-subst">${random.toFixed(<span class="hljs-number">2</span>)}</span>`</span>));
  }
});

<span class="hljs-comment">// å¤„ç†æˆåŠŸå’Œå¤±è´¥</span>
p.<span class="hljs-title function_">then</span>(
  <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'thenæˆåŠŸå›è°ƒï¼š'</span>, res),
  <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'thenå¤±è´¥å›è°ƒï¼š'</span>, err.<span class="hljs-property">message</span>)
);
</code></pre>
<h5 data-id="heading-16">é“¾å¼è°ƒç”¨ç¤ºä¾‹ï¼ˆæ ¸å¿ƒï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é“¾å¼è°ƒç”¨ï¼šä¾æ¬¡å¤„ç†ï¼Œå€¼çš„ä¼ é€’</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸€æ­¥ï¼š'</span>, num); <span class="hljs-comment">// 1</span>
    <span class="hljs-keyword">return</span> num + <span class="hljs-number">1</span>; <span class="hljs-comment">// è¿”å›æ™®é€šå€¼ï¼Œä¼ é€’ç»™ä¸‹ä¸€ä¸ªthen</span>
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒæ­¥ï¼š'</span>, num); <span class="hljs-comment">// 2</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(num + <span class="hljs-number">1</span>), <span class="hljs-number">1000</span>)); <span class="hljs-comment">// è¿”å›Promise</span>
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸‰æ­¥ï¼š'</span>, num); <span class="hljs-comment">// 3ï¼ˆ1ç§’åï¼‰</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ä¸»åŠ¨æŠ›å‡ºé”™è¯¯'</span>); <span class="hljs-comment">// æŠ›å‡ºé”™è¯¯ï¼Œè§¦å‘åç»­catch</span>
  })
  .<span class="hljs-title function_">then</span>(
    <span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬å››æ­¥ï¼š'</span>, num), <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œ</span>
    <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'thenæ•è·é”™è¯¯ï¼š'</span>, err.<span class="hljs-property">message</span>) <span class="hljs-comment">// å¯æ•è·ï¼Œä½†æ¨èç”¨catch</span>
  );
</code></pre>
<h4 data-id="heading-17">2. catch(onRejected)ï¼šä¸“é—¨å¤„ç†å¤±è´¥ç»“æœ</h4>
<p><code>.catch()</code> æ˜¯ <code>.then(null, onRejected)</code> çš„<strong>è¯­æ³•ç³–</strong>ï¼Œä¸“é—¨ç”¨äºæ•è· Promise é“¾å¼è°ƒç”¨ä¸­<strong>æ‰€æœ‰å‰ç½®æ“ä½œ</strong>çš„é”™è¯¯ï¼ˆåŒ…æ‹¬ <code>reject()</code> è§¦å‘çš„å¤±è´¥ã€å›è°ƒå‡½æ•°ä¸­æŠ›å‡ºçš„é”™è¯¯ã€åŒæ­¥ä»£ç é”™è¯¯ï¼‰ï¼Œæ˜¯ Promise é”™è¯¯å¤„ç†çš„<strong>æ¨èæ–¹å¼</strong>ã€‚</p>
<h5 data-id="heading-18">æ ¸å¿ƒç‰¹æ€§</h5>
<ol>
<li><strong>å…¨å±€é”™è¯¯æ•è·</strong>ï¼šä¸€ä¸ª <code>.catch()</code> å¯æ•è·é“¾å¼è°ƒç”¨ä¸­<strong>æ‰€æœ‰å‰ç½®</strong> <code>.then()</code> çš„é”™è¯¯ï¼Œæ— éœ€åœ¨æ¯ä¸ª <code>.then()</code> ä¸­å•ç‹¬å¤„ç†ï¼›</li>
<li><strong>é“¾å¼è°ƒç”¨</strong>ï¼š<code>.catch()</code> æ‰§è¡Œåä¹Ÿä¼šè¿”å›æ–°çš„ Promise å®ä¾‹ï¼Œè‹¥åœ¨ <code>.catch()</code> ä¸­è¿”å›æ™®é€šå€¼ï¼Œå¯ç»§ç»­é“¾å¼è°ƒç”¨ <code>.then()</code>ï¼›</li>
<li><strong>é”™è¯¯å…œåº•</strong>ï¼šè‹¥ Promise é“¾å¼è°ƒç”¨ä¸­æ²¡æœ‰ <code>.catch()</code>ï¼Œæœªæ•è·çš„é”™è¯¯ä¼šè§¦å‘æµè§ˆå™¨çš„ <code>unhandledrejection</code> äº‹ä»¶ï¼Œå¯¼è‡´æ§åˆ¶å°æŠ¥é”™ï¼ˆç”Ÿäº§ç¯å¢ƒéœ€é¿å…ï¼‰ï¼›</li>
<li><strong>æ•è·èŒƒå›´</strong>ï¼šä¸ä»…æ•è· Promise è‡ªèº«çš„ <code>reject()</code>ï¼Œè¿˜æ•è·æ‰€æœ‰å›è°ƒå‡½æ•°ä¸­çš„<strong>åŒæ­¥é”™è¯¯</strong>å’Œ<strong>å¼‚æ­¥é”™è¯¯</strong>ï¼ˆå¦‚å›è°ƒä¸­è°ƒç”¨æœªå®šä¹‰çš„å˜é‡ï¼‰ã€‚</li>
</ol>
<h5 data-id="heading-19">åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å¼‚æ­¥æ“ä½œå¤±è´¥'</span>));
})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æˆåŠŸï¼š'</span>, res)) <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œ</span>
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'catchæ•è·é”™è¯¯ï¼š'</span>, err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// è¾“å‡ºï¼šå¼‚æ­¥æ“ä½œå¤±è´¥</span>
</code></pre>
<h5 data-id="heading-20">å…¨å±€é”™è¯¯æ•è·ç¤ºä¾‹ï¼ˆé“¾å¼æ ¸å¿ƒï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸€ä¸ªcatchæ•è·æ‰€æœ‰å‰ç½®é”™è¯¯</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>);
})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num);
    a++; <span class="hljs-comment">// å¼•ç”¨æœªå®šä¹‰å˜é‡ï¼ŒåŒæ­¥é”™è¯¯</span>
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num)) <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œ</span>
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'catchæ•è·æ‰€æœ‰é”™è¯¯ï¼š'</span>, err.<span class="hljs-property">message</span>); <span class="hljs-comment">// è¾“å‡ºï¼ša is not defined</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">10</span>; <span class="hljs-comment">// è¿”å›æ™®é€šå€¼ï¼Œç»§ç»­é“¾å¼è°ƒç”¨</span>
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'catchåç»§ç»­æ‰§è¡Œï¼š'</span>, num)); <span class="hljs-comment">// è¾“å‡ºï¼š10</span>
</code></pre>
<h4 data-id="heading-21">3. finally(onFinally)ï¼šå¤„ç†æœ€ç»ˆæ”¶å°¾æ“ä½œ</h4>
<p><code>.finally()</code> æ˜¯ ES2018 å¼•å…¥çš„æ–¹æ³•ï¼Œç”¨äºæŒ‡å®š<strong>æ— è®º Promise çŠ¶æ€æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ”¶å°¾æ“ä½œ</strong>ï¼Œæ¯”å¦‚å…³é—­åŠ è½½å¼¹çª—ã€é‡Šæ”¾èµ„æºã€å–æ¶ˆå®šæ—¶å™¨ç­‰ã€‚</p>
<h5 data-id="heading-22">æ ¸å¿ƒç‰¹æ€§</h5>
<ol>
<li><strong>æ— å‚æ•°</strong>ï¼š<code>.finally()</code> çš„å›è°ƒå‡½æ•°<strong>ä¸æ¥æ”¶ä»»ä½•å‚æ•°</strong>ï¼Œå› ä¸ºå®ƒæ— éœ€å…³å¿ƒ Promise çš„æ‰§è¡Œç»“æœï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰ï¼Œä»…åšé€šç”¨æ”¶å°¾ï¼›</li>
<li><strong>å¿…ç„¶æ‰§è¡Œ</strong>ï¼šæ— è®º Promise æ˜¯ <code>fulfilled</code> è¿˜æ˜¯ <code>rejected</code>ï¼Œä¹Ÿæ— è®ºé“¾å¼è°ƒç”¨ä¸­æ˜¯å¦æœ‰ <code>.catch()</code>ï¼Œ<code>.finally()</code> éƒ½ä¼šæ‰§è¡Œï¼›</li>
<li><strong>é“¾å¼è°ƒç”¨</strong>ï¼š<code>.finally()</code> ä¹Ÿä¼šè¿”å›æ–°çš„ Promise å®ä¾‹ï¼Œä¸”ä¼š<strong>é€ä¼ </strong>å‰ç½® Promise çš„æˆåŠŸç»“æœæˆ–å¤±è´¥åŸå› ï¼ˆå³ä¸æ”¹å˜åŸæœ‰çš„ç»“æœï¼‰ï¼›</li>
<li><strong>æ— è¿”å›å€¼å½±å“</strong>ï¼š<code>.finally()</code> çš„å›è°ƒå‡½æ•°è¿”å›çš„å€¼ä¼šè¢«å¿½ç•¥ï¼Œä¸ä¼šå½±å“åç»­é“¾å¼è°ƒç”¨çš„å‚æ•°ã€‚</li>
</ol>
<h5 data-id="heading-23">åŸºç¡€ä½¿ç”¨ç¤ºä¾‹ï¼ˆæœ€å¸¸ç”¨åœºæ™¯ï¼šå…³é—­åŠ è½½ï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿæ¥å£è¯·æ±‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ˜¾ç¤ºåŠ è½½å¼¹çª—'</span>);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> isSuccess = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.5</span>;
      <span class="hljs-keyword">if</span> (isSuccess) {
        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'è¯·æ±‚æˆåŠŸï¼šè·å–åˆ°æ•°æ®'</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥ï¼šç½‘ç»œé”™è¯¯'</span>));
      }
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-comment">// æ‰§è¡Œè¯·æ±‚ï¼Œfinallyå…³é—­åŠ è½½</span>
<span class="hljs-title function_">requestData</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res))
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>))
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å…³é—­åŠ è½½å¼¹çª—'</span>); <span class="hljs-comment">// æ— è®ºæˆåŠŸ/å¤±è´¥ï¼Œéƒ½ä¼šæ‰§è¡Œ</span>
  });
</code></pre>
<h5 data-id="heading-24">é€ä¼ ç»“æœç¤ºä¾‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// finallyé€ä¼ æˆåŠŸç»“æœ</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æˆåŠŸæ•°æ®'</span>))
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰§è¡Œfinally'</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">'finallyçš„è¿”å›å€¼'</span>; <span class="hljs-comment">// ä¼šè¢«å¿½ç•¥</span>
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€ç»ˆç»“æœï¼š'</span>, res)); <span class="hljs-comment">// è¾“å‡ºï¼šæˆåŠŸæ•°æ®</span>

<span class="hljs-comment">// finallyé€ä¼ å¤±è´¥åŸå› </span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">reject</span>) =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å¤±è´¥åŸå› '</span>)))
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰§è¡Œfinally'</span>))
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€ç»ˆé”™è¯¯ï¼š'</span>, err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// è¾“å‡ºï¼šå¤±è´¥åŸå› </span>
</code></pre>
<h3 data-id="heading-25">ğŸš€ å››ã€Promise æ„é€ å‡½æ•°çš„é™æ€æ–¹æ³•</h3>
<p>Promise æ„é€ å‡½æ•°æœ¬èº«æä¾›äº†å¤šä¸ª<strong>é™æ€æ–¹æ³•</strong>ï¼Œç”¨äºå¿«é€Ÿåˆ›å»º Promise å®ä¾‹æˆ–æ‰¹é‡ç®¡ç†å¤šä¸ª Promise å®ä¾‹ï¼Œæ˜¯å¤„ç†<strong>å¤šå¼‚æ­¥æ“ä½œæµç¨‹æ§åˆ¶</strong>çš„æ ¸å¿ƒï¼Œæ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨é¢‘ç‡æé«˜ã€‚</p>
<h4 data-id="heading-26">1. Promise.resolve(value)ï¼šå¿«é€Ÿåˆ›å»ºæˆåŠŸçš„ Promise</h4>
<p>ç”¨äºå¿«é€Ÿåˆ›å»ºä¸€ä¸ª<strong>çŠ¶æ€ä¸º fulfilled</strong> çš„ Promise å®ä¾‹ï¼Œç­‰ä»·äº <code>new Promise(resolve =&gt; resolve(value))</code>ï¼Œé€‚åˆå°†<strong>æ™®é€šå€¼ã€é Promise å¼‚æ­¥æ“ä½œ</strong>è½¬ä¸º Promise æ ¼å¼ï¼Œå®ç°ç»Ÿä¸€çš„å¼‚æ­¥æ¥å£ã€‚</p>
<h5 data-id="heading-27">æ ¸å¿ƒç‰¹æ€§</h5>
<ul>
<li>è‹¥å‚æ•° <code>value</code> æ˜¯<strong>æ™®é€šå€¼</strong>ï¼ˆåŸºæœ¬ç±»å‹ã€å¯¹è±¡ï¼‰ï¼Œæ–° Promise ç›´æ¥ä»¥è¯¥å€¼ä¸ºæˆåŠŸç»“æœï¼›</li>
<li>è‹¥å‚æ•° <code>value</code> æ˜¯<strong>å¦ä¸€ä¸ª Promise å®ä¾‹</strong>ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥å®ä¾‹ï¼ˆçŠ¶æ€å’Œç»“æœå‡é€ä¼ ï¼‰ï¼›</li>
<li>è‹¥å‚æ•° <code>value</code> æ˜¯<strong>å…·æœ‰ then æ–¹æ³•çš„å¯¹è±¡ï¼ˆthenableï¼‰</strong>ï¼Œåˆ™ä¼šæ‰§è¡Œå…¶ <code>then</code> æ–¹æ³•ï¼Œæ ¹æ® <code>then</code> æ–¹æ³•çš„æ‰§è¡Œç»“æœç¡®å®šæ–° Promise çš„çŠ¶æ€ã€‚</li>
</ul>
<h5 data-id="heading-28">ä½¿ç”¨ç¤ºä¾‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. ä¼ å…¥æ™®é€šå€¼</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">123</span>);
p1.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1)); <span class="hljs-comment">// 123</span>

<span class="hljs-comment">// 2. ä¼ å…¥Promiseå®ä¾‹</span>
<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'åŸPromise'</span>));
<span class="hljs-keyword">const</span> p3 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(p2);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p2 === p3); <span class="hljs-comment">// trueï¼ˆç›´æ¥è¿”å›åŸå®ä¾‹ï¼‰</span>

<span class="hljs-comment">// 3. ä¼ å…¥thenableå¯¹è±¡</span>
<span class="hljs-keyword">const</span> thenable = {
  <span class="hljs-title function_">then</span>(<span class="hljs-params">resolve</span>) {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'thenableæ‰§è¡ŒæˆåŠŸ'</span>);
  }
};
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(thenable).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)); <span class="hljs-comment">// thenableæ‰§è¡ŒæˆåŠŸ</span>
</code></pre>
<h4 data-id="heading-29">2. Promise.reject(reason)ï¼šå¿«é€Ÿåˆ›å»ºå¤±è´¥çš„ Promise</h4>
<p>ç”¨äºå¿«é€Ÿåˆ›å»ºä¸€ä¸ª<strong>çŠ¶æ€ä¸º rejected</strong> çš„ Promise å®ä¾‹ï¼Œç­‰ä»·äº <code>new Promise((resolve, reject) =&gt; reject(reason))</code>ï¼Œé€‚åˆå¿«é€ŸæŠ›å‡ºå¼‚æ­¥é”™è¯¯ã€‚</p>
<h5 data-id="heading-30">æ ¸å¿ƒç‰¹æ€§</h5>
<ul>
<li>æ— è®ºå‚æ•° <code>reason</code> æ˜¯ä»€ä¹ˆç±»å‹ï¼ˆæ™®é€šå€¼ã€Promise å®ä¾‹ã€thenable å¯¹è±¡ï¼‰ï¼Œéƒ½ä¼šç›´æ¥ä½œä¸º<strong>å¤±è´¥åŸå› </strong>ä¼ é€’ç»™ <code>.catch()</code>ï¼Œ<strong>ä¸ä¼šé€ä¼ </strong> Promise å®ä¾‹çš„çŠ¶æ€ï¼ˆä¸ <code>Promise.resolve</code> ä¸åŒï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-31">ä½¿ç”¨ç¤ºä¾‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. ä¼ å…¥æ™®é€šé”™è¯¯</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">'ç®€å•é”™è¯¯'</span>).<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err)); <span class="hljs-comment">// ç®€å•é”™è¯¯</span>

<span class="hljs-comment">// 2. ä¼ å…¥Errorå¯¹è±¡ï¼ˆæ¨èï¼‰</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ ‡å‡†é”™è¯¯'</span>)).<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// æ ‡å‡†é”™è¯¯</span>

<span class="hljs-comment">// 3. ä¼ å…¥Promiseå®ä¾‹ï¼ˆä¸ä¼šé€ä¼ ï¼Œç›´æ¥ä½œä¸ºåŸå› ï¼‰</span>
<span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æˆåŠŸçš„Promise'</span>);
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(p).<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err === p)); <span class="hljs-comment">// true</span>
</code></pre>
<h4 data-id="heading-32">3. Promise.all(iterable)ï¼šæ‰€æœ‰å¼‚æ­¥æ“ä½œéƒ½æˆåŠŸæ‰æˆåŠŸ</h4>
<p><strong>æ ¸å¿ƒåœºæ™¯</strong>ï¼šå¤„ç†<strong>å¹¶è¡Œçš„å¤šä¸ªå¼‚æ­¥æ“ä½œ</strong>ï¼Œä¸”<strong>æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»æˆåŠŸ</strong>ï¼Œæ‰è¿”å›æ‰€æœ‰ç»“æœï¼›åªè¦æœ‰ä¸€ä¸ªæ“ä½œå¤±è´¥ï¼Œç«‹å³è¿”å›è¯¥å¤±è´¥åŸå› ï¼ˆ<strong>å¿«é€Ÿå¤±è´¥</strong>æœºåˆ¶ï¼‰ã€‚</p>
<h5 data-id="heading-33">æ ¸å¿ƒç‰¹æ€§</h5>
<ul>
<li>å‚æ•° <code>iterable</code>ï¼šå¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚æ•°ç»„ï¼‰ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ Promise å®ä¾‹ï¼›</li>
<li>æˆåŠŸç»“æœï¼šå½“<strong>æ‰€æœ‰</strong> Promise éƒ½å˜ä¸º <code>fulfilled</code>ï¼Œæ–° Promise ä»¥ <code>fulfilled</code> çŠ¶æ€è¿”å›<strong>ç»“æœæ•°ç»„</strong>ï¼Œæ•°ç»„é¡ºåºä¸ä¼ å…¥çš„ Promise é¡ºåºä¸€è‡´ï¼ˆä¸æ‰§è¡Œå®Œæˆé¡ºåºæ— å…³ï¼‰ï¼›</li>
<li>å¤±è´¥æœºåˆ¶ï¼šåªè¦æœ‰<strong>ä¸€ä¸ª</strong> Promise å˜ä¸º <code>rejected</code>ï¼Œæ–° Promise ç«‹å³ä»¥ <code>rejected</code> çŠ¶æ€è¿”å›è¯¥å¤±è´¥åŸå› ï¼Œå…¶ä½™æœªå®Œæˆçš„ Promise ä»ä¼šæ‰§è¡Œï¼Œä½†ç»“æœä¼šè¢«å¿½ç•¥ï¼›</li>
<li>ç©ºæ•°ç»„ï¼šè‹¥ä¼ å…¥ç©ºæ•°ç»„ï¼Œä¼š<strong>ç«‹å³æˆåŠŸ</strong>ï¼Œè¿”å›ç©ºæ•°ç»„ã€‚</li>
</ul>
<h5 data-id="heading-34">ä½¿ç”¨ç¤ºä¾‹ï¼ˆå¹¶è¡Œè¯·æ±‚å¤šä¸ªæ¥å£ï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿ3ä¸ªå¹¶è¡Œçš„æ¥å£è¯·æ±‚</span>
<span class="hljs-keyword">const</span> request1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ¥å£1æ•°æ®'</span>);
<span class="hljs-keyword">const</span> request2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ¥å£2æ•°æ®'</span>), <span class="hljs-number">1000</span>));
<span class="hljs-keyword">const</span> request3 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ¥å£3æ•°æ®'</span>);

<span class="hljs-comment">// æ‰€æœ‰è¯·æ±‚éƒ½æˆåŠŸæ‰è¿”å›ç»“æœ</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([request1, request2, request3])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰€æœ‰è¯·æ±‚æˆåŠŸï¼š'</span>, res); <span class="hljs-comment">// è¾“å‡ºï¼š['æ¥å£1æ•°æ®', 'æ¥å£2æ•°æ®', 'æ¥å£3æ•°æ®']ï¼ˆ1ç§’åï¼‰</span>
    <span class="hljs-keyword">const</span> [data1, data2, data3] = res; <span class="hljs-comment">// æŒ‰é¡ºåºè§£æ„</span>
  })
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ‰è¯·æ±‚å¤±è´¥ï¼š'</span>, err.<span class="hljs-property">message</span>));

<span class="hljs-comment">// ä¸€ä¸ªè¯·æ±‚å¤±è´¥çš„æƒ…å†µ</span>
<span class="hljs-keyword">const</span> request4 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ¥å£4è¯·æ±‚å¤±è´¥'</span>));
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([request1, request4, request3])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)) <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œ</span>
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// ç«‹å³è¾“å‡ºï¼šæ¥å£4è¯·æ±‚å¤±è´¥</span>
</code></pre>
<h4 data-id="heading-35">4. Promise.race(iterable)ï¼šç¬¬ä¸€ä¸ªå®Œæˆçš„å¼‚æ­¥æ“ä½œå†³å®šç»“æœ</h4>
<p><strong>æ ¸å¿ƒåœºæ™¯</strong>ï¼šå¤„ç†<strong>å¹¶è¡Œçš„å¤šä¸ªå¼‚æ­¥æ“ä½œ</strong>ï¼Œ<strong>è°å…ˆå®Œæˆï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰ï¼Œå°±å–è°çš„ç»“æœ</strong>ï¼Œå…¶ä½™æœªå®Œæˆçš„ Promise ä»ä¼šæ‰§è¡Œï¼Œä½†ç»“æœä¼šè¢«å¿½ç•¥ï¼ˆâ€œèµ›è·‘â€æœºåˆ¶ï¼‰ã€‚</p>
<h5 data-id="heading-36">æ ¸å¿ƒç‰¹æ€§</h5>
<ul>
<li>å‚æ•° <code>iterable</code>ï¼šå¯è¿­ä»£å¯¹è±¡ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ Promise å®ä¾‹ï¼›</li>
<li>ç»“æœç”±â€œç¬¬ä¸€ä¸ªå®šå‹â€çš„ Promise å†³å®šï¼šæ— è®ºç¬¬ä¸€ä¸ªå®Œæˆçš„æ˜¯ <code>fulfilled</code> è¿˜æ˜¯ <code>rejected</code>ï¼Œæ–° Promise éƒ½ä¼šç»§æ‰¿å…¶çŠ¶æ€å’Œç»“æœï¼›</li>
<li>ç©ºæ•°ç»„ï¼šè‹¥ä¼ å…¥ç©ºæ•°ç»„ï¼Œæ–° Promise ä¼šä¸€ç›´å¤„äº <code>pending</code> çŠ¶æ€ï¼Œæ°¸ä¸å®šå‹ã€‚</li>
</ul>
<h5 data-id="heading-37">ç»å…¸ä½¿ç”¨ç¤ºä¾‹ï¼šæ¥å£è¯·æ±‚è¶…æ—¶æ§åˆ¶</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿæ¥å£è¯·æ±‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">request</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ¥å£è¯·æ±‚æˆåŠŸ'</span>), <span class="hljs-number">2000</span>); <span class="hljs-comment">// 2ç§’åå®Œæˆ</span>
  });
}

<span class="hljs-comment">// æ¨¡æ‹Ÿè¶…æ—¶å™¨ï¼ˆ1.5ç§’åå¤±è´¥ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">timeout</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¯·æ±‚è¶…æ—¶ï¼š1.5ç§’æœªå“åº”'</span>)), <span class="hljs-number">1500</span>);
  });
}

<span class="hljs-comment">// èµ›è·‘ï¼šè¯·æ±‚å’Œè¶…æ—¶å™¨ï¼Œè°å…ˆå®Œæˆå–è°çš„ç»“æœ</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([<span class="hljs-title function_">request</span>(), <span class="hljs-title function_">timeout</span>()])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)) <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œï¼Œå› ä¸ºè¶…æ—¶å™¨å…ˆå®Œæˆ</span>
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// è¾“å‡ºï¼šè¯·æ±‚è¶…æ—¶ï¼š1.5ç§’æœªå“åº”</span>
</code></pre>
<h4 data-id="heading-38">5. Promise.allSettled(iterable)ï¼šç­‰å¾…æ‰€æœ‰å¼‚æ­¥æ“ä½œéƒ½å®Œæˆ</h4>
<p><strong>æ ¸å¿ƒåœºæ™¯</strong>ï¼šå¤„ç†<strong>å¹¶è¡Œçš„å¤šä¸ªå¼‚æ­¥æ“ä½œ</strong>ï¼Œ<strong>æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä¼šç­‰å¾…æ‰€æœ‰æ“ä½œå®Œæˆ</strong>ï¼Œå¹¶è¿”å›æ¯ä¸ªæ“ä½œçš„è¯¦ç»†ç»“æœï¼ˆåŒ…å«çŠ¶æ€å’Œå€¼/åŸå› ï¼‰ï¼Œè§£å†³äº† <code>Promise.all</code> å¿«é€Ÿå¤±è´¥çš„é—®é¢˜ï¼ˆé€‚åˆéœ€è¦çŸ¥é“æ‰€æœ‰æ“ä½œç»“æœçš„åœºæ™¯ï¼Œå¦‚æ‰¹é‡ä¸Šä¼ ï¼‰ã€‚</p>
<h5 data-id="heading-39">æ ¸å¿ƒç‰¹æ€§</h5>
<ul>
<li>ES2020 å¼•å…¥ï¼Œç°ä»£æµè§ˆå™¨å‡æ”¯æŒï¼›</li>
<li>å‚æ•° <code>iterable</code>ï¼šå¯è¿­ä»£å¯¹è±¡ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ Promise å®ä¾‹ï¼›</li>
<li>æˆåŠŸç»“æœï¼šå½“<strong>æ‰€æœ‰</strong> Promise éƒ½å®šå‹ï¼ˆsettledï¼‰ï¼Œæ–° Promise ä¸€å®šæ˜¯ <code>fulfilled</code> çŠ¶æ€ï¼Œè¿”å›<strong>ç»“æœæ•°ç»„</strong>ï¼Œæ•°ç»„é¡ºåºä¸ä¼ å…¥é¡ºåºä¸€è‡´ï¼›</li>
<li>æ¯ä¸ªç»“æœå¯¹è±¡åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š
<ul>
<li><code>status</code>ï¼šå­—ç¬¦ä¸²ï¼Œå€¼ä¸º <code>fulfilled</code> æˆ– <code>rejected</code>ï¼›</li>
<li><code>value</code>ï¼šä»… <code>status</code> ä¸º <code>fulfilled</code> æ—¶å­˜åœ¨ï¼Œæ˜¯æˆåŠŸç»“æœï¼›</li>
<li><code>reason</code>ï¼šä»… <code>status</code> ä¸º <code>rejected</code> æ—¶å­˜åœ¨ï¼Œæ˜¯å¤±è´¥åŸå› ã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-40">ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ‰¹é‡ä¸Šä¼ ï¼Œéœ€çŸ¥é“æ¯ä¸ªæ–‡ä»¶çš„ä¸Šä¼ ç»“æœï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿ3ä¸ªæ–‡ä»¶ä¸Šä¼ çš„å¼‚æ­¥æ“ä½œï¼ˆ2æˆåŠŸ1å¤±è´¥ï¼‰</span>
<span class="hljs-keyword">const</span> upload1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ–‡ä»¶1ä¸Šä¼ æˆåŠŸ'</span>);
<span class="hljs-keyword">const</span> upload2 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ–‡ä»¶2ä¸Šä¼ å¤±è´¥ï¼šæ–‡ä»¶è¿‡å¤§'</span>));
<span class="hljs-keyword">const</span> upload3 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ–‡ä»¶3ä¸Šä¼ æˆåŠŸ'</span>);

<span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰ä¸Šä¼ æ“ä½œå®Œæˆï¼Œè·å–æ¯ä¸ªæ“ä½œçš„ç»“æœ</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">allSettled</span>([upload1, upload2, upload3])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰€æœ‰ä¸Šä¼ ç»“æœï¼š'</span>, results);
    <span class="hljs-comment">// ç­›é€‰æˆåŠŸ/å¤±è´¥çš„ç»“æœ</span>
    <span class="hljs-keyword">const</span> successList = results.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">status</span> === <span class="hljs-string">'fulfilled'</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">value</span>);
    <span class="hljs-keyword">const</span> failList = results.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">status</span> === <span class="hljs-string">'rejected'</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">reason</span>.<span class="hljs-property">message</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æˆåŠŸçš„ä¸Šä¼ ï¼š'</span>, successList); <span class="hljs-comment">// ['æ–‡ä»¶1ä¸Šä¼ æˆåŠŸ', 'æ–‡ä»¶3ä¸Šä¼ æˆåŠŸ']</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤±è´¥çš„ä¸Šä¼ ï¼š'</span>, failList); <span class="hljs-comment">// ['æ–‡ä»¶2ä¸Šä¼ å¤±è´¥ï¼šæ–‡ä»¶è¿‡å¤§']</span>
  });
</code></pre>
<h4 data-id="heading-41">6. Promise.any(iterable)ï¼šç¬¬ä¸€ä¸ªæˆåŠŸçš„å¼‚æ­¥æ“ä½œå†³å®šç»“æœ</h4>
<p><strong>æ ¸å¿ƒåœºæ™¯</strong>ï¼šå¤„ç†<strong>å¹¶è¡Œçš„å¤šä¸ªå¼‚æ­¥æ“ä½œ</strong>ï¼Œ<strong>å¿½ç•¥å¤±è´¥çš„æ“ä½œï¼Œç­‰å¾…ç¬¬ä¸€ä¸ªæˆåŠŸçš„æ“ä½œ</strong>è¿”å›ç»“æœï¼›è‹¥æ‰€æœ‰æ“ä½œéƒ½å¤±è´¥ï¼Œæ‰è¿”å›èšåˆé”™è¯¯ï¼ˆé€‚åˆå¤šèŠ‚ç‚¹è¯·æ±‚ï¼Œå–æœ€å¿«æˆåŠŸçš„èŠ‚ç‚¹æ•°æ®ï¼‰ã€‚</p>
<h5 data-id="heading-42">æ ¸å¿ƒç‰¹æ€§</h5>
<ul>
<li>ES2021 å¼•å…¥ï¼Œç°ä»£æµè§ˆå™¨å‡æ”¯æŒï¼›</li>
<li>å‚æ•° <code>iterable</code>ï¼šå¯è¿­ä»£å¯¹è±¡ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ Promise å®ä¾‹ï¼›</li>
<li>æˆåŠŸæœºåˆ¶ï¼šåªè¦æœ‰<strong>ä¸€ä¸ª</strong> Promise å˜ä¸º <code>fulfilled</code>ï¼Œæ–° Promise ç«‹å³ç»§æ‰¿å…¶æˆåŠŸç»“æœï¼Œå…¶ä½™æœªå®Œæˆçš„ Promise ä»ä¼šæ‰§è¡Œï¼Œç»“æœè¢«å¿½ç•¥ï¼›</li>
<li>å¤±è´¥æœºåˆ¶ï¼šè‹¥<strong>æ‰€æœ‰</strong> Promise éƒ½å˜ä¸º <code>rejected</code>ï¼Œæ–° Promise ä¼šå˜ä¸º <code>rejected</code>ï¼ŒæŠ›å‡º <code>AggregateError</code> é”™è¯¯ï¼ˆåŒ…å«æ‰€æœ‰å¤±è´¥åŸå› ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-43">ä½¿ç”¨ç¤ºä¾‹ï¼ˆå¤šèŠ‚ç‚¹è¯·æ±‚ï¼Œå–æœ€å¿«æˆåŠŸçš„ç»“æœï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿ3ä¸ªèŠ‚ç‚¹çš„æ¥å£è¯·æ±‚ï¼ˆ2å¤±è´¥1æˆåŠŸï¼ŒæˆåŠŸçš„èŠ‚ç‚¹æœ€æ…¢ï¼‰</span>
<span class="hljs-keyword">const</span> requestNode1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'èŠ‚ç‚¹1è¯·æ±‚å¤±è´¥'</span>));
<span class="hljs-keyword">const</span> requestNode2 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'èŠ‚ç‚¹2è¯·æ±‚å¤±è´¥'</span>));
<span class="hljs-keyword">const</span> requestNode3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'èŠ‚ç‚¹3è¯·æ±‚æˆåŠŸï¼Œè·å–æ•°æ®'</span>), <span class="hljs-number">1000</span>));

<span class="hljs-comment">// å–ç¬¬ä¸€ä¸ªæˆåŠŸçš„è¯·æ±‚ç»“æœ</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">any</span>([requestNode1, requestNode2, requestNode3])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€å¿«æˆåŠŸçš„èŠ‚ç‚¹ï¼š'</span>, res)) <span class="hljs-comment">// è¾“å‡ºï¼šèŠ‚ç‚¹3è¯·æ±‚æˆåŠŸï¼Œè·å–æ•°æ®</span>
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰€æœ‰èŠ‚ç‚¹éƒ½å¤±è´¥ï¼š'</span>, err);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰€æœ‰å¤±è´¥åŸå› ï¼š'</span>, err.<span class="hljs-property">errors</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.<span class="hljs-property">message</span>));
  });

<span class="hljs-comment">// æ‰€æœ‰æ“ä½œéƒ½å¤±è´¥çš„æƒ…å†µ</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">any</span>([<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">'å¤±è´¥1'</span>), <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">'å¤±è´¥2'</span>)])
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">AggregateError</span>); <span class="hljs-comment">// true</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">errors</span>); <span class="hljs-comment">// ['å¤±è´¥1', 'å¤±è´¥2']</span>
  });
</code></pre>
<h3 data-id="heading-44">âŒ› äº”ã€Promise ç»å…¸å®æˆ˜åœºæ™¯</h3>
<h4 data-id="heading-45">1. å°è£… AJAX è¯·æ±‚ï¼ˆPromise ç‰ˆï¼‰</h4>
<p>ä¼ ç»Ÿ AJAX åŸºäºå›è°ƒï¼Œå°è£…ä¸º Promise åæ”¯æŒé“¾å¼è°ƒç”¨å’Œç»Ÿä¸€é”™è¯¯å¤„ç†ï¼Œæ˜¯å‰ç«¯æœ€åŸºç¡€çš„å®æˆ˜åœºæ™¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * Promise ç‰ˆ AJAX å°è£…
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">url</span> - è¯·æ±‚åœ°å€
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">method</span> - è¯·æ±‚æ–¹æ³•ï¼šGET/POST
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">data</span> - è¯·æ±‚å‚æ•°
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params">{ url, method = <span class="hljs-string">'GET'</span>, data = {} }</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
    <span class="hljs-comment">// å¤„ç†GETå‚æ•°</span>
    <span class="hljs-keyword">if</span> (method.<span class="hljs-title function_">toUpperCase</span>() === <span class="hljs-string">'GET'</span> &amp;&amp; <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>(data).<span class="hljs-title function_">toString</span>();
      url += <span class="hljs-string">'?'</span> + params;
    }
    xhr.<span class="hljs-title function_">open</span>(method, url, <span class="hljs-literal">true</span>);
    <span class="hljs-comment">// è®¾ç½®POSTè¯·æ±‚å¤´</span>
    <span class="hljs-keyword">if</span> (method.<span class="hljs-title function_">toUpperCase</span>() === <span class="hljs-string">'POST'</span>) {
      xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'application/x-www-form-urlencoded'</span>);
    }
    <span class="hljs-comment">// å“åº”å¤„ç†</span>
    xhr.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> res = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>); <span class="hljs-comment">// è§£æJSON</span>
          <span class="hljs-title function_">resolve</span>(res);
        } <span class="hljs-keyword">catch</span> (err) {
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å“åº”æ•°æ®è§£æå¤±è´¥ï¼š'</span> + err.<span class="hljs-property">message</span>));
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`è¯·æ±‚å¤±è´¥ï¼šçŠ¶æ€ç <span class="hljs-subst">${xhr.status}</span>ï¼Œ<span class="hljs-subst">${xhr.statusText}</span>`</span>));
      }
    };
    <span class="hljs-comment">// ç½‘ç»œé”™è¯¯</span>
    xhr.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç½‘ç»œé”™è¯¯ï¼šæ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨'</span>));
    };
    <span class="hljs-comment">// å‘é€è¯·æ±‚</span>
    <span class="hljs-keyword">if</span> (method.<span class="hljs-title function_">toUpperCase</span>() === <span class="hljs-string">'POST'</span>) {
      xhr.<span class="hljs-title function_">send</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>(data).<span class="hljs-title function_">toString</span>());
    } <span class="hljs-keyword">else</span> {
      xhr.<span class="hljs-title function_">send</span>();
    }
  });
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-title function_">ajax</span>({
  <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/user'</span>,
  <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span> }
})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚æˆåŠŸï¼š'</span>, res))
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥ï¼š'</span>, err.<span class="hljs-property">message</span>));
</code></pre>
<h4 data-id="heading-46">2. å°è£…å®šæ—¶å™¨ï¼ˆPromise ç‰ˆï¼‰</h4>
<p>å°† setTimeout/setInterval å°è£…ä¸º Promiseï¼Œæ”¯æŒ async/await è°ƒç”¨ï¼Œè§£å†³å®šæ—¶å™¨åµŒå¥—é—®é¢˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * Promise ç‰ˆå®šæ—¶å™¨ï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">time</span> - å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} <span class="hljs-variable">value</span> - å»¶è¿Ÿåè¿”å›çš„å€¼
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params">time, value</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(value), time);
  });
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹ï¼šasync/await è°ƒç”¨</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">doTask</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹æ‰§è¡Œä»»åŠ¡'</span>);
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>); <span class="hljs-comment">// å»¶è¿Ÿ1ç§’</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1ç§’åæ‰§è¡Œä¸‹ä¸€æ­¥'</span>);
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">'å»¶è¿Ÿ2ç§’çš„è¿”å›å€¼'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data); <span class="hljs-comment">// å»¶è¿Ÿ2ç§’çš„è¿”å›å€¼</span>
}
<span class="hljs-title function_">doTask</span>();
</code></pre>
<h4 data-id="heading-47">3. å¼‚æ­¥æµç¨‹æ§åˆ¶ï¼šä¸²è¡Œ/å¹¶è¡Œæ‰§è¡Œ</h4>
<h5 data-id="heading-48">3.1 ä¸²è¡Œæ‰§è¡Œï¼ˆä¾æ¬¡æ‰§è¡Œï¼Œåä¸€ä¸ªä¾èµ–å‰ä¸€ä¸ªç»“æœï¼‰</h5>
<p>é€‚åˆæœ‰é¡ºåºä¾èµ–çš„å¼‚æ­¥æ“ä½œï¼ˆå¦‚å…ˆè·å–tokenï¼Œå†ç”¨tokenè·å–ç”¨æˆ·ä¿¡æ¯ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿä¸¤ä¸ªæœ‰ä¾èµ–çš„å¼‚æ­¥æ“ä½œ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getToken</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'user_token_123'</span>), <span class="hljs-number">1000</span>));
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params">token</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>({ token, <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> }), <span class="hljs-number">1000</span>));
}

<span class="hljs-comment">// ä¸²è¡Œæ‰§è¡Œï¼šasync/await æ›´ç®€æ´ï¼ˆåŸºäºPromiseï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserData</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getToken</span>(); <span class="hljs-comment">// å…ˆè·å–token</span>
  <span class="hljs-keyword">const</span> userInfo = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserInfo</span>(token); <span class="hljs-comment">// å†ç”¨tokenè·å–ç”¨æˆ·ä¿¡æ¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·æ•°æ®ï¼š'</span>, userInfo);
}
<span class="hljs-title function_">getUserData</span>(); <span class="hljs-comment">// æ€»è€—æ—¶2ç§’</span>
</code></pre>
<h5 data-id="heading-49">3.2 å¹¶è¡Œæ‰§è¡Œï¼ˆåŒæ—¶æ‰§è¡Œï¼Œæ— ä¾èµ–ï¼‰</h5>
<p>é€‚åˆæ— ä¾èµ–çš„å¼‚æ­¥æ“ä½œï¼Œæå‡æ‰§è¡Œæ•ˆç‡ï¼ˆå¦‚åŒæ—¶è¯·æ±‚å¤šä¸ªæ— å…³è”çš„æ¥å£ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿ3ä¸ªæ— ä¾èµ–çš„æ¥å£è¯·æ±‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getArticleList</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">'æ–‡ç« åˆ—è¡¨'</span>); }
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getCommentList</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">'è¯„è®ºåˆ—è¡¨'</span>); }
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getLikeList</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">'ç‚¹èµåˆ—è¡¨'</span>); }

<span class="hljs-comment">// å¹¶è¡Œæ‰§è¡Œï¼šPromise.all å®ç°ï¼Œæ€»è€—æ—¶1ç§’ï¼ˆè€Œé3ç§’ï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getHomeData</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'æ€»è€—æ—¶'</span>);
  <span class="hljs-comment">// åŒæ—¶æ‰§è¡Œï¼Œç­‰å¾…æ‰€æœ‰å®Œæˆ</span>
  <span class="hljs-keyword">const</span> [articles, comments, likes] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
    <span class="hljs-title function_">getArticleList</span>(),
    <span class="hljs-title function_">getCommentList</span>(),
    <span class="hljs-title function_">getLikeList</span>()
  ]);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¦–é¡µæ•°æ®ï¼š'</span>, { articles, comments, likes });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'æ€»è€—æ—¶'</span>); <span class="hljs-comment">// æ€»è€—æ—¶ï¼šçº¦1000ms</span>
}
<span class="hljs-title function_">getHomeData</span>();
</code></pre>
<h3 data-id="heading-50">âš ï¸ å…­ã€Promise å¸¸è§å‘ä¸é¿å‘æŒ‡å—</h3>
<h4 data-id="heading-51">1. å¿˜è®°å†™ return å¯¼è‡´é“¾å¼è°ƒç”¨æ–­é“¾</h4>
<p><strong>é—®é¢˜</strong>ï¼š<code>.then()</code> ä¸­æœªå†™ returnï¼Œå¯¼è‡´ä¸‹ä¸€ä¸ª <code>.then()</code> æ¥æ”¶çš„å‚æ•°æ˜¯ <code>undefined</code>ï¼Œä¸”æ‰§è¡Œæ—¶æœºæå‰ï¼ˆå› ä¸ºè¿”å›çš„æ˜¯é»˜è®¤çš„ Promise.resolve(undefined)ï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">num</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 1</span>
    <span class="hljs-comment">// å¿˜è®°returnï¼Œé»˜è®¤è¿”å›undefined</span>
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">num</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num)); <span class="hljs-comment">// undefinedï¼ˆç«‹å³æ‰§è¡Œï¼‰</span>

<span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">num</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 1</span>
    <span class="hljs-keyword">return</span> num + <span class="hljs-number">1</span>; <span class="hljs-comment">// å¿…é¡»å†™return</span>
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">num</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num)); <span class="hljs-comment">// 2</span>
</code></pre>
<h4 data-id="heading-52">2. é”™è¯¯æœªè¢«æ•è·ï¼ˆæ§åˆ¶å°æŠ¥ UnhandledPromiseRejectionï¼‰</h4>
<p><strong>é—®é¢˜</strong>ï¼šPromise è¢« reject åï¼Œæ²¡æœ‰ä»»ä½• <code>.catch()</code> æˆ– <code>.then()</code> çš„ onRejected å¤„ç†ï¼Œå¯¼è‡´æµè§ˆå™¨æŠ›å‡ºæœªæ•è·é”™è¯¯ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šæ— é”™è¯¯å¤„ç†</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æœªæ•è·çš„é”™è¯¯'</span>)); <span class="hljs-comment">// æ§åˆ¶å°æŠ¥é”™ï¼šUnhandledPromiseRejection</span>

<span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹ï¼šå¿…é¡»æ·»åŠ catch</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å·²æ•è·çš„é”™è¯¯'</span>))
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// æ­£å¸¸è¾“å‡º</span>
</code></pre>
<h4 data-id="heading-53">3. è®¤ä¸º Promise æ‰§è¡Œå™¨æ˜¯å¼‚æ­¥çš„</h4>
<p><strong>é—®é¢˜</strong>ï¼šPromise æ„é€ å‡½æ•°çš„æ‰§è¡Œå™¨å‡½æ•°æ˜¯<strong>åŒæ­¥ç«‹å³æ‰§è¡Œ</strong>çš„ï¼Œå†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ‰æ˜¯å¼‚æ­¥çš„ï¼Œå®¹æ˜“å¯¼è‡´å˜é‡èµ‹å€¼é¡ºåºé”™è¯¯ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯è®¤çŸ¥ï¼šè®¤ä¸ºæ‰§è¡Œå™¨æ˜¯å¼‚æ­¥çš„</span>
<span class="hljs-keyword">let</span> a = <span class="hljs-number">0</span>;
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  a = <span class="hljs-number">1</span>; <span class="hljs-comment">// åŒæ­¥æ‰§è¡Œï¼Œç«‹å³èµ‹å€¼</span>
  <span class="hljs-title function_">resolve</span>();
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// 1ï¼ˆè€Œé0ï¼‰</span>

<span class="hljs-comment">// æ­£ç¡®ç†è§£ï¼šæ‰§è¡Œå™¨åŒæ­¥ï¼Œå†…éƒ¨æ“ä½œå¼‚æ­¥</span>
<span class="hljs-keyword">let</span> b = <span class="hljs-number">0</span>;
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    b = <span class="hljs-number">1</span>; <span class="hljs-comment">// å¼‚æ­¥æ‰§è¡Œï¼Œ1ç§’åèµ‹å€¼</span>
    <span class="hljs-title function_">resolve</span>();
  }, <span class="hljs-number">1000</span>);
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b); <span class="hljs-comment">// 0ï¼ˆç«‹å³è¾“å‡ºï¼‰</span>
</code></pre>
<h4 data-id="heading-54">4. Promise.all ä¼ å…¥é Promise æ•°ç»„</h4>
<p><strong>é—®é¢˜</strong>ï¼š<code>Promise.all</code> ä¼ å…¥çš„æ•°ç»„ä¸­åŒ…å«æ™®é€šå€¼ï¼Œä¼šè¢«è‡ªåŠ¨è½¬ä¸º <code>Promise.resolve(æ™®é€šå€¼)</code>ï¼Œçœ‹ä¼¼æ²¡é—®é¢˜ï¼Œä½†å¦‚æœåŒ…å«<strong>åŒæ­¥é”™è¯¯</strong>ï¼Œä¼šç«‹å³è§¦å‘å¤±è´¥ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ— å®³æƒ…å†µï¼šæ™®é€šå€¼è¢«è½¬ä¸ºæˆåŠŸçš„Promise</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">3</span>)])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)); <span class="hljs-comment">// [1,2,3]</span>

<span class="hljs-comment">// å±é™©æƒ…å†µï¼šåŒæ­¥é”™è¯¯ç«‹å³è§¦å‘å¤±è´¥</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">'{'</span>)]) <span class="hljs-comment">// JSON.parseåŒæ­¥æŠ¥é”™</span>
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res))
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// Unexpected token } in JSON at position 1</span>
</code></pre>
<p><strong>é¿å‘</strong>ï¼šç¡®ä¿ <code>Promise.all</code> æ•°ç»„ä¸­çš„å…ƒç´ è¦ä¹ˆæ˜¯ Promise å®ä¾‹ï¼Œè¦ä¹ˆæ˜¯å®‰å…¨çš„æ™®é€šå€¼ï¼ˆæ— åŒæ­¥é”™è¯¯ï¼‰ã€‚</p>
<h4 data-id="heading-55">5. å¤šæ¬¡è°ƒç”¨ resolve/reject æ— æ•ˆ</h4>
<p><strong>é—®é¢˜</strong>ï¼šè®¤ä¸ºå¤šæ¬¡è°ƒç”¨ resolve/reject å¯ä»¥æ”¹å˜ Promise çŠ¶æ€ï¼Œå®åˆ™çŠ¶æ€ä¸€æ—¦å®šå‹ï¼Œåç»­è°ƒç”¨å‡æ— æ•ˆã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬ä¸€æ¬¡resolve'</span>);
  <span class="hljs-title function_">reject</span>(<span class="hljs-string">'reject'</span>); <span class="hljs-comment">// æ— æ•ˆ</span>
  <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬äºŒæ¬¡resolve'</span>); <span class="hljs-comment">// æ— æ•ˆ</span>
})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)) <span class="hljs-comment">// ç¬¬ä¸€æ¬¡resolve</span>
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err)); <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œ</span>
</code></pre>
<h3 data-id="heading-56">â« ä¸ƒã€Promise é«˜çº§çŸ¥è¯†ç‚¹ï¼šå¾®ä»»åŠ¡ä¸äº‹ä»¶å¾ªç¯</h3>
<p>Promise çš„å›è°ƒå‡½æ•°ï¼ˆ<code>.then()</code>/<code>.catch()</code>/<code>.finally()</code>ï¼‰å±äº<strong>å¾®ä»»åŠ¡ï¼ˆMicrotaskï¼‰</strong>ï¼Œè¿™æ˜¯ Promise æ‰§è¡Œæ—¶æœºçš„å…³é”®ï¼Œä¹Ÿæ˜¯å‰ç«¯é¢è¯•çš„é«˜é¢‘è€ƒç‚¹ã€‚</p>
<h4 data-id="heading-57">1. å¾®ä»»åŠ¡ä¸å®ä»»åŠ¡çš„åŒºåˆ«</h4>
<p>æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯ä¸­ï¼Œä»»åŠ¡åˆ†ä¸º<strong>å®ä»»åŠ¡ï¼ˆMacrotaskï¼‰</strong> å’Œ<strong>å¾®ä»»åŠ¡ï¼ˆMicrotaskï¼‰</strong>ï¼Œæ‰§è¡Œé¡ºåºä¸ºï¼š<strong>å…ˆæ‰§è¡ŒåŒæ­¥ä»£ç  â†’ æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ â†’ æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ â†’ å†æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ â†’ å¾ªç¯</strong>ã€‚</p>
<ul>
<li><strong>å®ä»»åŠ¡</strong>ï¼šsetTimeoutã€setIntervalã€AJAXã€DOM äº‹ä»¶ã€script æ•´ä½“ä»£ç ï¼›</li>
<li><strong>å¾®ä»»åŠ¡</strong>ï¼šPromise å›è°ƒã€async/awaitã€MutationObserverã€queueMicrotaskã€‚</li>
</ul>
<h4 data-id="heading-58">2. Promise å¾®ä»»åŠ¡æ‰§è¡Œç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. åŒæ­¥ä»£ç å¼€å§‹'</span>); <span class="hljs-comment">// åŒæ­¥</span>

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4. å®ä»»åŠ¡ï¼šsetTimeout'</span>); <span class="hljs-comment">// å®ä»»åŠ¡ï¼Œæœ€åæ‰§è¡Œ</span>
}, <span class="hljs-number">0</span>);

<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. Promiseæ‰§è¡Œå™¨ï¼šåŒæ­¥'</span>); <span class="hljs-comment">// åŒæ­¥</span>
  <span class="hljs-title function_">resolve</span>();
}).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. å¾®ä»»åŠ¡ï¼šPromise.then'</span>); <span class="hljs-comment">// å¾®ä»»åŠ¡ï¼ŒåŒæ­¥åæ‰§è¡Œ</span>
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'5. åŒæ­¥ä»£ç ç»“æŸ'</span>); <span class="hljs-comment">// åŒæ­¥</span>
</code></pre>
<p><strong>è¾“å‡ºé¡ºåº</strong>ï¼š1â†’2â†’5â†’3â†’4ï¼ˆæ ¸å¿ƒï¼šå¾®ä»»åŠ¡åœ¨å®ä»»åŠ¡å‰æ‰§è¡Œï¼‰ã€‚</p>
<h3 data-id="heading-59">ğŸ“• å…«ã€Promise ä¸ async/await ç»“åˆä½¿ç”¨</h3>
<p>async/await æ˜¯ ES7 å¼•å…¥çš„<strong>Promise è¯­æ³•ç³–</strong>ï¼Œå®ƒè®©å¼‚æ­¥ä»£ç çš„å†™æ³•<strong>å®Œå…¨åŒæ­¥åŒ–</strong>ï¼Œæ˜¯ç›®å‰å‰ç«¯å¼‚æ­¥ç¼–ç¨‹çš„<strong>æœ€ä¼˜æ–¹æ¡ˆ</strong>ï¼Œä½†å®ƒçš„åº•å±‚ä¾ç„¶æ˜¯ Promiseï¼Œå¿…é¡»æŒæ¡ Promise æ‰èƒ½çœŸæ­£ç†è§£ async/awaitã€‚</p>
<h4 data-id="heading-60">1. æ ¸å¿ƒè§„åˆ™</h4>
<ul>
<li><code>async</code> ä¿®é¥°çš„å‡½æ•°ï¼Œè¿”å›å€¼ä¸€å®šæ˜¯ Promise å®ä¾‹ï¼ˆå³ä½¿è¿”å›æ™®é€šå€¼ï¼Œä¹Ÿä¼šè¢«è½¬ä¸º Promise.resolve(æ™®é€šå€¼)ï¼‰ï¼›</li>
<li><code>await</code> åªèƒ½åœ¨ <code>async</code> å‡½æ•°ä¸­ä½¿ç”¨ï¼Œç”¨äºç­‰å¾… Promise å®šå‹ï¼Œ<strong>æš‚åœå‡½æ•°æ‰§è¡Œ</strong>ï¼Œç›´åˆ° Promise è¿”å›ç»“æœï¼›</li>
<li><code>await</code> åé¢å¯ä»¥è·Ÿä»»æ„å€¼ï¼Œè‹¥ä¸æ˜¯ Promiseï¼Œä¼šè¢«è‡ªåŠ¨è½¬ä¸º Promise.resolve(å€¼)ï¼›</li>
<li>é”™è¯¯å¤„ç†ï¼šä½¿ç”¨ <code>try/catch</code> æ•è· <code>await</code> åçš„ Promise é”™è¯¯ï¼ˆç­‰ä»·äº Promise çš„ <code>.catch()</code>ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-61">2. ç»“åˆä½¿ç”¨ç¤ºä¾‹ï¼ˆæœ€ç®€æ´çš„å¼‚æ­¥ä»£ç ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchData</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">'è·å–åˆ°æ•°æ®'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchUser</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span> });

<span class="hljs-comment">// async/await å†™æ³•ï¼ŒåŒæ­¥åŒ–æµç¨‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹æ‰§è¡Œ'</span>);
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>(); <span class="hljs-comment">// ç­‰å¾…ç¬¬ä¸€ä¸ªå¼‚æ­¥æ“ä½œ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data); <span class="hljs-comment">// è·å–åˆ°æ•°æ®</span>
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUser</span>(); <span class="hljs-comment">// ç­‰å¾…ç¬¬äºŒä¸ªå¼‚æ­¥æ“ä½œ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user); <span class="hljs-comment">// { name: 'å¼ ä¸‰' }</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰€æœ‰æ“ä½œå®Œæˆ'</span>);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é”™è¯¯ï¼š'</span>, err.<span class="hljs-property">message</span>); <span class="hljs-comment">// æ•è·æ‰€æœ‰å¼‚æ­¥é”™è¯¯</span>
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶å°¾æ“ä½œ'</span>); <span class="hljs-comment">// æ— è®ºæˆåŠŸ/å¤±è´¥éƒ½æ‰§è¡Œ</span>
  }
}

<span class="hljs-title function_">main</span>();
</code></pre>
<h3 data-id="heading-62">ğŸ“Œ ä¹ã€æ€»ç»“</h3>
<ol>
<li>Promise æ˜¯ ES6 æ ¸å¿ƒçš„å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œ<strong>è§£å†³äº†å›è°ƒåœ°ç‹±é—®é¢˜</strong>ï¼Œæä¾›äº†ç»Ÿä¸€çš„å¼‚æ­¥æ¥å£å’Œé›†ä¸­çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼›</li>
<li>Promise æœ‰ä¸‰ç§ä¸å¯é€†çŠ¶æ€ï¼špendingã€fulfilledã€rejectedï¼Œä»…èƒ½é€šè¿‡ resolve/reject å®Œæˆä¸¤æ¬¡çŠ¶æ€è½¬æ¢ï¼ŒçŠ¶æ€å®šå‹åä¸å¯ä¿®æ”¹ï¼›</li>
<li>å®ä¾‹æ–¹æ³• <code>.then()</code>/<code>.catch()</code>/<code>.finally()</code> æ”¯æŒé“¾å¼è°ƒç”¨ï¼Œæ ¸å¿ƒåŸå› æ˜¯<strong>æ¯ä¸ªæ–¹æ³•éƒ½è¿”å›æ–°çš„ Promise å®ä¾‹</strong>ï¼Œ<code>.catch()</code> ç»Ÿä¸€æ•è·é”™è¯¯ï¼Œ<code>.finally()</code> å¤„ç†é€šç”¨æ”¶å°¾ï¼›</li>
<li>æ„é€ å‡½æ•°é™æ€æ–¹æ³•æ˜¯å¼‚æ­¥æµç¨‹æ§åˆ¶çš„æ ¸å¿ƒï¼š<code>all</code>ï¼ˆæ‰€æœ‰æˆåŠŸï¼‰ã€<code>race</code>ï¼ˆç¬¬ä¸€ä¸ªå®Œæˆï¼‰ã€<code>allSettled</code>ï¼ˆæ‰€æœ‰å®Œæˆï¼‰ã€<code>any</code>ï¼ˆç¬¬ä¸€ä¸ªæˆåŠŸï¼‰ã€<code>resolve</code>/<code>reject</code>ï¼ˆå¿«é€Ÿåˆ›å»ºï¼‰ï¼›</li>
<li>Promise å›è°ƒå±äº<strong>å¾®ä»»åŠ¡</strong>ï¼Œæ‰§è¡Œé¡ºåºåœ¨åŒæ­¥ä»£ç åã€å®ä»»åŠ¡å‰ï¼Œè¿™æ˜¯ç†è§£ Promise æ‰§è¡Œæ—¶æœºçš„å…³é”®ï¼›</li>
<li>async/await æ˜¯ Promise çš„è¯­æ³•ç³–ï¼Œè®©å¼‚æ­¥ä»£ç åŒæ­¥åŒ–ï¼Œæ˜¯ç›®å‰æœ€ä¼˜çš„å¼‚æ­¥å†™æ³•ï¼Œä½†åº•å±‚ä¾èµ– Promiseï¼›</li>
<li>å¼€å‘ä¸­é¿å…å¸¸è§å‘ï¼šå¿˜è®° return æ–­é“¾ã€æœªæ•è·é”™è¯¯ã€æ··æ·†æ‰§è¡Œå™¨åŒæ­¥ç‰¹æ€§ã€å¤šæ¬¡è°ƒç”¨ resolve/rejectï¼›</li>
<li>Promise æ˜¯ç°ä»£å‰ç«¯å¼€å‘çš„å¿…å¤‡æŠ€èƒ½ï¼Œæ˜¯ Vueã€React ç­‰æ¡†æ¶å¼‚æ­¥æ“ä½œã€æ¥å£è¯·æ±‚ã€çŠ¶æ€ç®¡ç†çš„åŸºç¡€ï¼Œä¹Ÿæ˜¯å‰ç«¯é¢è¯•çš„é«˜é¢‘è€ƒç‚¹ã€‚</li>
</ol>
<p>æŒæ¡ Promise ä¸ä»…èƒ½å†™å‡ºæ›´ä¼˜é›…ã€æ›´æ˜“ç»´æŠ¤çš„å¼‚æ­¥ä»£ç ï¼Œæ›´èƒ½ç†è§£ç°ä»£å‰ç«¯å¼‚æ­¥ç¼–ç¨‹çš„åº•å±‚é€»è¾‘ï¼Œä¸ºåç»­å­¦ä¹  async/awaitã€äº‹ä»¶å¾ªç¯ã€å‰ç«¯å·¥ç¨‹åŒ–æ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LeanCloudåœæœ&CloudBase è¿ç§»æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7602940720690429998</link>    <guid>https://juejin.cn/post/7602940720690429998</guid>    <pubDate>2026-02-05T03:12:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602940720690429998" data-draft-id="7602562585099878434" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LeanCloudåœæœ&amp;CloudBase è¿ç§»æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T03:12:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è…¾è®¯äº‘å¼€å‘CloudBase"/> <meta itemprop="url" content="https://juejin.cn/user/2963939080036493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LeanCloudåœæœ&amp;CloudBase è¿ç§»æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2963939080036493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è…¾è®¯äº‘å¼€å‘CloudBase
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:12:56.000Z" title="Thu Feb 05 2026 03:12:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç”±äºLeanCloudä»2026å¹´èµ·å°†åœæ­¢å¯¹å¤–æä¾›æœåŠ¡ï¼Œåœ¨<strong>2027 å¹´ 1 æœˆ 12 æ—¥</strong>å‰ï¼Œå¹³å°å°†æ­£å¼å…³é—­æ‰€æœ‰é¢å‘å…¬ä¼—çš„æœåŠ¡ï¼ŒåŒ…æ‹¬åº”ç”¨è®¿é—®ã€æ•°æ®è¯»å†™ã€API è°ƒç”¨ã€æ§åˆ¶å°ä½¿ç”¨ç­‰</p>
<p>è…¾è®¯äº‘ CloudBase é’ˆå¯¹ LeanCloud ç”¨æˆ·æ¨å‡ºäº†æ•´ä½“è¿ç§»æ–¹æ¡ˆï¼ŒååŠ©å¼€å‘è€…å¹³ç¨³è¿‡æ¸¡ã€‚ä¸ä»…æä¾›å…è´¹äº‘èµ„æºï¼Œä¸”æä¾›æ•°æ®åº“ã€äº‘å‡½æ•°ã€äº‘å­˜å‚¨ã€èº«ä»½è®¤è¯ç­‰ä¸ LeanCloud ç±»ä¼¼çš„èƒ½åŠ›ï¼ŒåŒæ—¶é…å¤‡å®Œæ•´è¿ç§»æŒ‡å—åŠæ™ºèƒ½è¿ç§»è„šæœ¬ï¼Œæ”¯æŒè‡ªåŠ¨æ•°æ®æ ¼å¼è½¬æ¢ã€‚</p>
<p>è¿ç§»è¯¦æƒ…å‚è€ƒï¼šä» LeanCloud è¿ç§»è‡³ CloudBase å®Œæ•´æŒ‡å—
<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.cloudbase.net%2Fquick-start%2Fmigration%2Fleancloud" target="_blank" title="https://docs.cloudbase.net/quick-start/migration/leancloud" ref="nofollow noopener noreferrer">docs.cloudbase.net/quick-startâ€¦</a></p>
<p>è¿ç§»ç”¨æˆ·å¯ä½¿ç”¨ä¸“å±ä¼˜æƒ ç é¢†å–å…è´¹äº‘èµ„æºï¼š
<a href="https://link.juejin.cn?target=https%3A%2F%2Fbuy.cloud.tencent.com%2Flowcode%3FbuyType%3Dtcb" target="_blank" title="https://buy.cloud.tencent.com/lowcode?buyType=tcb" ref="nofollow noopener noreferrer">buy.cloud.tencent.com/lowcode?buyâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30821664bf2345d08ff11c1a3a65f252~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-RQ2xvdWRCYXNl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770865975&amp;x-signature=PG2ylkJKlhqIY1LxEaRdf4Z6JNs%3D" alt="è¿ç§»æ–¹æ¡ˆæµ·æŠ¥.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‹’ç»æ­»ç›¯å±å¹•ï¼æ•™ä½ ç»™ Claude Code åŠ ä¸Šâ€œè¯­éŸ³æç¤ºéŸ³â€ï¼Œè®©Claude Codeä¸»åŠ¨æŠ¥å¤‡ï¼Œæç¤º/å®Œæˆå…¨çŸ¥é“]]></title>    <link>https://juejin.cn/post/7602816610932047935</link>    <guid>https://juejin.cn/post/7602816610932047935</guid>    <pubDate>2026-02-04T20:34:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602816610932047935" data-draft-id="7602807243705139263" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‹’ç»æ­»ç›¯å±å¹•ï¼æ•™ä½ ç»™ Claude Code åŠ ä¸Šâ€œè¯­éŸ³æç¤ºéŸ³â€ï¼Œè®©Claude Codeä¸»åŠ¨æŠ¥å¤‡ï¼Œæç¤º/å®Œæˆå…¨çŸ¥é“"/> <meta itemprop="keywords" content="è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2026-02-04T20:34:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Insight"/> <meta itemprop="url" content="https://juejin.cn/user/1192316023081726"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‹’ç»æ­»ç›¯å±å¹•ï¼æ•™ä½ ç»™ Claude Code åŠ ä¸Šâ€œè¯­éŸ³æç¤ºéŸ³â€ï¼Œè®©Claude Codeä¸»åŠ¨æŠ¥å¤‡ï¼Œæç¤º/å®Œæˆå…¨çŸ¥é“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1192316023081726/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Insight
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T20:34:19.000Z" title="Wed Feb 04 2026 20:34:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ€è¿‘å¤§å®¶éƒ½åœ¨ç”¨ <strong>Claude Code</strong> (Anthropic å®˜æ–¹å‡ºçš„ CLI å·¥å…·) æ¥å†™ä»£ç ã€‚ä¸å¾—ä¸è¯´ï¼Œå®ƒçš„ Agent èƒ½åŠ›ç¡®å®å¼ºï¼Œä½†ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªæ–°çš„çƒ¦æ¼ï¼š</p>
<p><strong>å®ƒå¤ªçˆ±æé—®äº†ï¼</strong> ğŸ˜©</p>
<blockquote>
<p>"Claude wants to run this command..." (ç­‰å¾…æˆæƒ)
"Cost estimation..." (ç­‰å¾…ç¡®è®¤)
"Thinking..." (é•¿æ—¶é—´æ€è€ƒ)</p>
</blockquote>
<p>å¦‚æœä½ ä¸ç›¯ç€å±å¹•ï¼Œå®ƒå°±ä¼šä¸€ç›´å¡åœ¨ç¡®è®¤ç•Œé¢ï¼›å¦‚æœä½ ç›¯ç€å±å¹•ï¼Œåˆæµªè´¹äº†å®è´µçš„æ‘¸é±¼æ—¶é—´ã€‚</p>
<p>ä»Šå¤©åˆ†äº«ä¸€ä¸ªç¡¬æ ¸æŠ€å·§ï¼Œ<strong>ç»™ä½ çš„ Claude åŠ ä¸Šâ€œè¯­éŸ³æç¤ºâ€</strong>ã€‚ä¸ç®¡æ˜¯å®ƒæ˜¯åœä¸‹æ¥é—®ä½ é—®é¢˜ï¼Œè¿˜æ˜¯ä»»åŠ¡å…¨éƒ¨è·‘å®Œï¼Œéƒ½èƒ½â€œæ»´â€ä¸€å£°å–Šä½ å›æ¥æ¬ç –ã€‚</p>
<p>æˆ‘ä»¬<strong>ä¸å†™ä»»ä½•è„šæœ¬</strong>ï¼Œ<strong>ä¸è£… Node.js ç¯å¢ƒ</strong>ï¼Œåªç”¨ Claude Code åŸç”Ÿçš„é…ç½®æ–‡ä»¶ <code>hooks</code> åŠŸèƒ½æ¥å®ç°ï¼</p>
<hr/>
<h2 data-id="heading-1">Claude Code CLI åŸç”Ÿé…ç½®</h2>
<p>å¦‚æœä½ ä¹ æƒ¯ç›´æ¥åœ¨ç»ˆç«¯ä½¿ç”¨ <code>claude</code> å‘½ä»¤ï¼Œè¯·ä¿®æ”¹ CLI çš„å…¨å±€é…ç½®æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-2">1. æ‰¾åˆ°é…ç½®æ–‡ä»¶</h3>
<p>é…ç½®æ–‡ä»¶é€šå¸¸åä¸º <code>config.json</code> (éƒ¨åˆ†ç‰ˆæœ¬å¯èƒ½æ˜¯ <code>settings.json</code>)ï¼Œä½äº <code>.claude</code> éšè—æ–‡ä»¶å¤¹ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>ğŸªŸ Windows</strong>:<br/>
<code>C:\Users\ä½ çš„ç”¨æˆ·å\.claude\config.json</code><br/>
<em>(æˆ–è€…åœ¨èµ„æºç®¡ç†å™¨åœ°å€æ è¾“å…¥ <code>%USERPROFILE%\.claude\</code> å¿«é€Ÿè¿›å…¥)</em></p>
</li>
<li>
<p><strong>ğŸ macOS</strong>:<br/>
<code>~/.claude/config.json</code><br/>
<em>(åœ¨ç»ˆç«¯è¾“å…¥ <code>open ~/.claude/</code> å¯æ‰“å¼€æ–‡ä»¶å¤¹)</em></p>
</li>
<li>
<p><strong>ğŸ§ Linux</strong>:<br/>
<code>~/.claude/config.json</code></p>
</li>
</ul>
<h3 data-id="heading-3">2. æ·»åŠ  Hooks é…ç½®</h3>
<p>ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œåœ¨ JSON çš„ä¸€çº§å±‚çº§ä¸‹æ·»åŠ  <code>hooks</code> å­—æ®µã€‚</p>
<p>è¯·å°†ä¸‹æ–¹ä»£ç ä¸­çš„ <code>ã€åœ¨è¿™é‡Œå¡«å…¥æç¤ºå‘½ä»¤ã€‘</code> æ›¿æ¢ä¸ºæ–‡ç« ååŠéƒ¨åˆ†æä¾›çš„<strong>å…·ä½“ç³»ç»Ÿå‘½ä»¤</strong>ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"Stop"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"matcher"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"permission"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ã€åœ¨è¿™é‡Œå¡«å…¥ä½ å–œæ¬¢çš„æç¤ºå‘½ä»¤ã€‘"</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"Notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"matcher"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"permission"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ã€åœ¨è¿™é‡Œå¡«å…¥ä½ å–œæ¬¢çš„æç¤ºå‘½ä»¤ã€‘"</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// å…¶å®ƒé…ç½®</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-4">ğŸµ æ ¸å¿ƒå¹²è´§ï¼šå„å¤§ç³»ç»Ÿæç¤ºéŸ³å‘½ä»¤å¤§å…¨</h2>
<p><strong>è¿™æ˜¯æ³¨å…¥çµé­‚çš„ä¸€æ­¥ï¼</strong> è¯·æ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿï¼ŒæŒ‘é€‰ä¸€æ¡æœ€å¿ƒä»ªçš„æŒ‡ä»¤å¡«å…¥é…ç½®ã€‚ æ— è®ºä½ æ˜¯æƒ³è¦<strong>æç®€çš„èœ‚é¸£éŸ³</strong>ã€<strong>ä¼˜é›…çš„ç³»ç»Ÿæç¤ºéŸ³</strong>ï¼Œè¿˜æ˜¯æƒ³æ•´ç‚¹â€œèŠ±æ´»â€æ¥æ®µ<strong>è¶…çº§ç›ä¸½çš„é€šå…³ BGM</strong>ï¼Œç”šè‡³ç›´æ¥è®©ç”µè„‘åŒ–èº«**â€œè´¾ç»´æ–¯â€**ç”¨è¯­éŸ³å‘ä½ æ±‡æŠ¥â€¦â€¦è¿™é‡Œç»Ÿç»Ÿéƒ½èƒ½æ»¡è¶³ä½ ï¼</p>
<h3 data-id="heading-5">ğŸªŸ Windows (PowerShell)</h3>
<p>Windows çš„å¯ç©æ€§æœ€é«˜ï¼Œä¾èµ– PowerShell è°ƒç”¨ .NET åº“ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong> å¡«å…¥ JSON æ—¶ï¼Œå¤–å±‚ç”¨åŒå¼•å·ï¼Œå†…å±‚å‘½ä»¤å‚æ•°è¯·åŠ¡å¿…ä½¿ç”¨<strong>å•å¼•å·</strong>ï¼Œé˜²æ­¢è½¬ä¹‰é”™è¯¯ã€‚</p>
</blockquote>






























<table><thead><tr><th align="left">éŸ³æ•ˆç±»å‹</th><th align="left">JSON ä¸­åº”å¡«å†™çš„ Command å€¼ (å¤åˆ¶è¿™ä¸€åˆ—)</th><th align="left">æ•ˆæœæè¿°</th></tr></thead><tbody><tr><td align="left"><strong>1. èœ‚é¸£ (Beep)</strong></td><td align="left"><code>powershell -c "[System.Console]::Beep(800, 500)"</code></td><td align="left">å‘å‡º 800èµ«å…¹ æŒç»­ 0.5ç§’ çš„æœºæ¢°éŸ³ï¼ˆä¸»æ¿æŠ¥è­¦é£ï¼‰ã€‚</td></tr><tr><td align="left"><strong>2. ç³»ç»Ÿæç¤ºéŸ³</strong></td><td align="left"><code>powershell -c "[System.Media.SystemSounds]::Asterisk.Play()"</code></td><td align="left"><strong>æ¨è</strong>ã€‚æ’­æ”¾ç³»ç»Ÿé»˜è®¤çš„â€œæ˜Ÿå·â€æç¤ºéŸ³ï¼ˆé€šå¸¸æ˜¯â€œå®â€ï¼‰ã€‚å¯é€‰ï¼š<code>Beep</code>, <code>Exclamation</code>, <code>Hand</code>, <code>Question</code>ç­‰ã€‚</td></tr><tr><td align="left"><strong>3. æ’­æ”¾ WAV</strong></td><td align="left"><code>powershell -c "(New-Object Media.SoundPlayer 'C:\\Sounds\\notify.wav').PlaySync()"</code></td><td align="left"><strong>è‡ªå®šä¹‰å…šæ¨è</strong>ã€‚æ’­æ”¾æœ¬åœ° WAV æ–‡ä»¶ï¼ˆæ³¨æ„è·¯å¾„ç”¨åŒåæ–œæ  <code>\\</code>ï¼‰ã€‚<code>.SoundPlayer</code> ç±»<strong>ä¸æ”¯æŒ MP3</strong>ï¼Œåªæ”¯æŒ WAVã€‚</td></tr><tr><td align="left"><strong>4. è¯­éŸ³åˆæˆ (TTS)</strong></td><td align="left"><code>powershell -c "Add-Type -A System.Speech; (New-Object System.Speech.Synthesis.SpeechSynthesizer).Speak('Master, waiting for command')"</code></td><td align="left"><strong>æå®¢é£</strong>ã€‚ç›´æ¥è®©ç”µè„‘å¼€å£è¯´è¯å–Šä½ ã€‚</td></tr></tbody></table>
<h3 data-id="heading-6">ğŸ macOS (Terminal / Zsh)</h3>
<p>Mac çš„å‘½ä»¤è¡ŒéŸ³é¢‘æ”¯æŒæœ€ä¼˜é›…ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚</p>






























<table><thead><tr><th align="left">éŸ³æ•ˆç±»å‹</th><th align="left">JSON ä¸­åº”å¡«å†™çš„ Command å€¼ (å¤åˆ¶è¿™ä¸€åˆ—)</th><th align="left">æ•ˆæœæè¿°</th></tr></thead><tbody><tr><td align="left"><strong>1. ç³»ç»Ÿæç¤ºéŸ³</strong></td><td align="left"><code>tput bel</code></td><td align="left">è§¦å‘ iTerm2 æˆ–ç»ˆç«¯é…ç½®çš„é»˜è®¤æç¤ºéŸ³ã€‚</td></tr><tr><td align="left"><strong>2. æ’­æ”¾ç³»ç»ŸéŸ³æ•ˆ</strong></td><td align="left"><code>afplay /System/Library/Sounds/Glass.aiff</code></td><td align="left"><strong>æ¨è</strong>ã€‚æ¸…è„†æ‚¦è€³çš„ç»ç’ƒå£°ã€‚å¯é€‰ï¼š<code>Ping</code>, <code>Hero</code>, <code>Submarine</code>, <code>Submarine</code>ç­‰ã€‚</td></tr><tr><td align="left"><strong>3. æ’­æ”¾ä»»æ„æ–‡ä»¶</strong></td><td align="left"><code>afplay '/Users/yourname/Music/alert.mp3'</code></td><td align="left">æ”¯æŒ MP3, WAV, AIFF ç­‰å‡ ä¹æ‰€æœ‰æ ¼å¼ã€‚</td></tr><tr><td align="left"><strong>4. è¯­éŸ³åˆæˆ (TTS)</strong></td><td align="left"><code>say 'Claude needs permission'</code></td><td align="left"><strong>æ¨è</strong>ã€‚ç›´æ¥è¯­éŸ³æ’­æŠ¥ï¼Œå¯ç”¨ <code>say -v Samantha 'Hello'</code> æ¢äººå£°ã€‚</td></tr></tbody></table>
<h3 data-id="heading-7">ğŸ§ Linux (Ubuntu / Debian / CentOS)</h3>
<p>Linux å–å†³äºä½ çš„æ¡Œé¢ç¯å¢ƒå’ŒéŸ³é¢‘é©±åŠ¨ï¼Œæ¨èä½¿ç”¨ <code>paplay</code>ã€‚</p>






























<table><thead><tr><th align="left">éŸ³æ•ˆç±»å‹</th><th align="left">JSON ä¸­åº”å¡«å†™çš„ Command å€¼ (å¤åˆ¶è¿™ä¸€åˆ—)</th><th align="left">æ•ˆæœæè¿°</th></tr></thead><tbody><tr><td align="left"><strong>1. èœ‚é¸£ (Beep)</strong></td><td align="left"><code>echo -e "\a"</code></td><td align="left">è§¦å‘ç»ˆç«¯æ¨¡æ‹Ÿå™¨çš„å“é“ƒï¼ˆéƒ¨åˆ†å‘è¡Œç‰ˆé»˜è®¤é™éŸ³ï¼‰ã€‚</td></tr><tr><td align="left"><strong>2. æ’­æ”¾ç³»ç»ŸéŸ³æ•ˆ</strong></td><td align="left"><code>paplay /usr/share/sounds/freedesktop/stereo/complete.oga</code></td><td align="left"><strong>æ¨è</strong> (PulseAudio)ã€‚å¤§å¤šæ•°ç°ä»£å‘è¡Œç‰ˆï¼ˆUbuntuç­‰ï¼‰é€šç”¨ã€‚</td></tr><tr><td align="left"><strong>3. æ’­æ”¾ WAV</strong></td><td align="left"><code>aplay /path/to/file.wav</code> æˆ– <code>mpg123 /path/to/file.mp3</code></td><td align="left">æœ€åº•å±‚ ALSA é©±åŠ¨ï¼Œä»…æ”¯æŒ WAVã€‚æ’­æ”¾ MP3 é€šå¸¸éœ€è¦å®‰è£… <code>mpg123</code> æˆ– <code>ffmpeg</code></td></tr><tr><td align="left"><strong>4. è¯­éŸ³åˆæˆ (TTS)</strong></td><td align="left"><code>spd-say 'Attention please'</code></td><td align="left">éœ€è¦å®‰è£… <code>speech-dispatcher</code>ï¼Œæˆ–è€…ç”¨ <code>espeak "Done"</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-8">âš¡ï¸ æœ€ç»ˆæ•ˆæœæ¼”ç¤º (ä»¥ Mac è¯­éŸ³ä¸ºä¾‹)</h2>
<p>å‡è®¾ä½ é…ç½®äº† <code>say "Sir, permission required"</code>ã€‚</p>
<ol>
<li>ä½ åœ¨ç»ˆç«¯è¾“å…¥ï¼š<code>claude "é‡æ„ä¸€ä¸‹ç™»å½•æ¨¡å—"</code></li>
<li>ä½ åˆ‡å‡ºå»å›å¾®ä¿¡ã€‚</li>
<li>Claude åˆ†æå®Œä»£ç ï¼Œå‡†å¤‡ä¿®æ”¹æ–‡ä»¶ï¼Œåœåœ¨ç¡®è®¤ç•Œé¢ã€‚</li>
<li>ä½ çš„ç”µè„‘çªç„¶ä¼ æ¥æ ‡å‡†çš„ Siri è¯­éŸ³ï¼š<strong>"Sir, permission required."</strong></li>
<li>ä½ æ·¡å®šåˆ‡å›ç»ˆç«¯ï¼Œæ•²ä¸ª <code>y</code>ï¼Œæ·±è—åŠŸä¸åã€‚</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9c846967e004419954642afc221cbb0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSW5zaWdodA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770848279&amp;x-signature=%2BX7btUQyo9Fu1zR6QIfuqEBLauQ%3D" alt="image.png" loading="lazy"/></p>
<p>å¿«å»è¯•è¯•å§ï¼è®©ä½ çš„ Claude å˜æˆçœŸæ­£çš„ AI åŠ©ç†ã€‚ ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€å¼ºåŒ–å­¦ä¹ ã€‘ç¬¬äº”ç« ï¼šæ— æ¨¡å‹è¯„ä¼°ï¼šè’™ç‰¹å¡æ´›å­¦ä¹ ã€æ—¶åºå·®åˆ†å­¦ä¹ ã€TD(Î»)]]></title>    <link>https://juejin.cn/post/7602846823326220323</link>    <guid>https://juejin.cn/post/7602846823326220323</guid>    <pubDate>2026-02-05T02:03:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602846823326220323" data-draft-id="7602901195153326132" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€å¼ºåŒ–å­¦ä¹ ã€‘ç¬¬äº”ç« ï¼šæ— æ¨¡å‹è¯„ä¼°ï¼šè’™ç‰¹å¡æ´›å­¦ä¹ ã€æ—¶åºå·®åˆ†å­¦ä¹ ã€TD(Î»)"/> <meta itemprop="keywords" content="å¼ºåŒ–å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-02-05T02:03:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®è´å„¿å¥½"/> <meta itemprop="url" content="https://juejin.cn/user/2737129399522635"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€å¼ºåŒ–å­¦ä¹ ã€‘ç¬¬äº”ç« ï¼šæ— æ¨¡å‹è¯„ä¼°ï¼šè’™ç‰¹å¡æ´›å­¦ä¹ ã€æ—¶åºå·®åˆ†å­¦ä¹ ã€TD(Î»)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2737129399522635/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®è´å„¿å¥½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:03:15.000Z" title="Thu Feb 05 2026 02:03:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»æœ¬ç¯‡ç« å¼€å§‹ï¼Œæˆ‘ä»¬å¼€å¯<strong>æ— æ¨¡å‹</strong>(Model-free)çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€æ¢³ç†æœ¬ç« åœ¨å¼ºåŒ–å­¦ä¹ ä¸­çš„ä½ç½®</h3>
<p><strong>1ã€æœ‰æ¨¡å‹å¼ºåŒ–å­¦ä¹ -&gt;æ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ </strong><br/>
åœ¨å¼ºåŒ–å­¦ä¹ ä¸­æˆ‘ä»¬ç»å¸¸å¬åˆ°æœ‰æ¨¡å‹ã€æ— æ¨¡å‹è¿™å¯¹å„¿æ¦‚å¿µã€‚</p>
<p><strong>æœ‰æ¨¡å‹</strong>æ˜¯æŒ‡å¯ä»¥å°†ç°å®é—®é¢˜<strong>æŠ½è±¡æˆä¸€ä¸ªå®Œå¤‡çš„MDP</strong>ã€‚å®Œå¤‡çš„MDPå°±æ˜¯æˆ‘ä»¬<strong>æ˜¯çŸ¥é“</strong>ç¯å¢ƒä¸­çš„çŠ¶æ€é›†åˆï¼Œä»¥åŠæ¯ä¸ªçŠ¶æ€ä¸‹çš„åŠ¨ä½œé›†åˆï¼Œ<strong>è€Œä¸”çŸ¥é“</strong>çŠ¶æ€ä¹‹é—´çš„è½¬ç§»æ¦‚ç‡ï¼Œ<strong>å¹¶ä¸”çŸ¥é“</strong>ç³»ç»Ÿçš„å³æ—¶å¥–åŠ±ã€‚æ­¤æ—¶æˆ‘ä»¬ç”¨<strong>è´å°”æ›¼æœŸæœ›æ–¹ç¨‹+åŠ¨æ€è§„åˆ’</strong>å°±å¯ä»¥è§£å†³ï¼Œä¸€èˆ¬ç§°ä¸º<strong>DPç®—æ³•</strong>ï¼Œå…·ä½“å®ç°è¿‡ç¨‹å¯ä»¥å‚è€ƒç¬¬ä¸‰ã€ç¬¬å››ç¯‡ç« ã€‚</p>
<p><strong>æ— æ¨¡å‹</strong>(Model-free)æ˜¯æŒ‡ç°å®é—®é¢˜æ˜¯ä¸€ä¸ª<strong>éå®Œå¤‡çš„MDP</strong>ï¼Œæˆ‘ä»¬<strong>ä¸çŸ¥é“</strong>ç³»ç»ŸèƒŒåçš„çŠ¶æ€é›†åˆå’ŒåŠ¨ä½œé›†åˆï¼Œ<strong>æ›´ä¸çŸ¥é“</strong>çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œæˆ‘ä»¬åªèƒ½å®å®åœ¨åœ¨çš„å»<strong>æ‰“å‡ æ­¥æˆ–è€…æ‰“å®Œ</strong>æ•´ä¸ªæ¸¸æˆï¼Œç„¶åå¾—åˆ°ä¸€äº›s,a,råºåˆ—ï¼Œç„¶åé€šè¿‡è¿™äº›åºåˆ—å»è®¡ç®—çŠ¶æ€ä»·å€¼ã€‚æ­¤æ—¶æ¸¸æˆä¸­çš„<strong>çŠ¶æ€ä»·å€¼çš„è®¡ç®—</strong>å°±å¾—ç”¨<strong>æ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ æ–¹æ³•</strong>ï¼Œæ¯”å¦‚<strong>è’™ç‰¹å¡æ´›å­¦ä¹ </strong>(MC)ã€<strong>æ—¶åºå·®åˆ†å­¦ä¹ </strong>(TD)ã€<strong>TD(Î»)</strong>ã€‚è¿™ä¸‰ä¸ªç®—æ³•ä¹Ÿæ˜¯<strong>æœ¬ç¯‡è®²è§£çš„é‡ç‚¹å†…å®¹</strong>ã€‚<br/>
åœ¨æ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ç»™è¿™ç§â€œå®å®åœ¨åœ¨æ‰“å‡ æ­¥æˆ–æ‰“å¤šè½®æ¸¸æˆï¼Œå¾—åˆ°çš„s,a,råºåˆ—â€å«<strong>æ•°æ®</strong>æˆ–è€…å«<strong>ç»éªŒ</strong>ã€‚</p>
<p><strong>2ã€DPã€MCã€TDã€TD(Î»)çš„åº”ç”¨åœºåˆ</strong><br/>
ä¹Ÿæ˜¯æœ‰æ¨¡å‹ç®—æ³•å’Œæ— æ¨¡å‹ç®—æ³•ä¹‹é—´çš„è”ç³»ä¸åŒºåˆ«ï¼š</p>
<p>ï¼ˆ1ï¼‰DP<strong>åªèƒ½</strong>ç”¨äºå®Œå¤‡çš„MDPï¼Œ<strong>è€Œä¸”</strong>DPå¯ä»¥ç›´æ¥è®¡ç®—å‡ºæœ€ä¼˜ç­–ç•¥ã€‚æˆ–è€…è¯´DPå¾—æœ‰æ¨¡å‹ï¼Œæ— æ¨¡å‹DPç®—æ³•ä¸èƒ½ç”¨ã€‚</p>
<p>ï¼ˆ2ï¼‰æ— æ¨¡å‹ç®—æ³•<strong>é€šå¸¸</strong>æ˜¯ç”¨äºè§£å†³éå®Œå¤‡MDPé—®é¢˜çš„ï¼Œå½“ç„¶å®ƒä»¬<strong>ä¹Ÿå¯ä»¥</strong>ç”¨æ¥è§£å†³å®Œå¤‡çš„MDPé—®é¢˜ï¼Œåªæ˜¯å®Œå¤‡çš„MDPé—®é¢˜ç”¨DPè§£å†³æ•ˆæœè¦æ¯”æ— æ¨¡å‹ç®—æ³•çš„æ•ˆæœ<strong>å¥½å¾ˆå¤š</strong>ï¼å› ä¸ºDPè§£å‡ºæ¥çš„æ˜¯ç²¾ç¡®è§£ï¼Œè€Œä¸”è¿˜å¯ä»¥ç®—å‡ºæœ€ä¼˜ç­–ç•¥ï¼Œå…¶ä»–ç®—æ³•éƒ½æ˜¯å¯¹DPçš„è¿‘ä¼¼ï¼Œæ‰€ä»¥å…¶ä»–ç®—æ³•éƒ½æ˜¯ä¼°è®¡è§£ï¼Œè‡ªç„¶æ¯”ä¸äº†DPçš„æ•ˆæœäº†ã€‚æ‰€ä»¥å¾ˆå¤šæ—¶å€™é€‰æ‹©ç®—æ³•æ—¶ï¼Œä¸€å®šä¸€å®šè¦å’Œä½ çš„å®é™…é—®é¢˜åŒ¹é…ã€‚é—®é¢˜å’Œç®—æ³•ä¸åŒ¹é…ï¼Œå¾—åˆ°çš„æ•ˆæœè‚¯å®šä¸å¥½ã€‚</p>
<p>ï¼ˆ3ï¼‰ä¸ºä»€ä¹ˆè¯´å¼ºåŒ–å­¦ä¹ çš„å…¶ä»–ç®—æ³•(å½“ç„¶ä¹ŸåŒ…æ‹¬æœ¬ç« çš„æ— æ¨¡å‹ç®—æ³•)éƒ½æ˜¯å¯¹DPçš„è¿‘ä¼¼ï¼Ÿå› ä¸ºå…¶ä»–ç®—æ³•éƒ½æ˜¯åœ¨DPçš„åŸºç¡€ä¸Šï¼Œè¦ä¹ˆæ˜¯<strong>å‡å¼±äº†å¯¹ç¯å¢ƒæ¨¡å‹å®Œå¤‡æ€§çš„å‡è®¾</strong>ï¼Œè¦ä¹ˆå°±æ˜¯<strong>é™ä½äº†è®¡ç®—å¤æ‚åº¦</strong>ã€‚</p>
<p>ï¼ˆ4ï¼‰DPè¿™ä¹ˆå¥½ï¼Œè¿˜è¦å…¶ä»–ç®—æ³•å¹²å˜›ï¼ŸDPè™½å¥½ä¹Ÿæœ‰å…¶ç¼ºç‚¹ï¼Œæ¯”å¦‚éå®Œå¤‡çš„MDPé—®é¢˜ï¼ŒDPæ˜¯æ— æ³•æ±‚è§£çš„ã€‚è€Œä¸”DPçš„è®¡ç®—å¤æ‚åº¦ä¹Ÿæ˜¯éå¸¸é«˜çš„ã€‚æ­¤æ—¶ä½ å°±<strong>å¿…é¡»å¾—ç”¨</strong>æ— æ¨¡å‹ç®—æ³•ã€‚ä¸€å¥è¯ï¼Œå®é™…è¦å’Œç®—æ³•åŒ¹é…ï¼</p>
<p>ï¼ˆ5ï¼‰æ— æ¨¡å‹ç®—æ³•å¯ä»¥ä¸éœ€è¦æ¨¡å‹ï¼Œä½†å¿…é¡»å¾—æœ‰<strong>æ•°æ®</strong>(ç»éªŒ)ã€‚ä¹Ÿå°±æ˜¯ä½ å¾—æ˜¯å®å®åœ¨åœ¨å»æ‰“æ¸¸æˆï¼Œç®—æ³•æ ¹æ®è¿™äº›æ¸¸æˆæ•°æ®å»å­¦ä¹ å’Œæå‡ç­–ç•¥ã€‚</p>
<p><strong>3ã€æ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ï¼šæ— æ¨¡å‹é¢„æµ‹-&gt;æ— æ¨¡å‹æ§åˆ¶</strong><br/>
ï¼ˆ1ï¼‰é€šè¿‡å‰é¢ç« èŠ‚çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“<strong>æœ‰æ¨¡å‹å¼ºåŒ–å­¦ä¹ DP</strong>çš„å­¦ä¹ è¿‡ç¨‹æ˜¯åˆ†2æ­¥ï¼šç¬¬1æ­¥<strong>è¯„ä¼°ä»·å€¼å‡½æ•°</strong>ï¼Œç¬¬2æ­¥è´ªå©ªåŒ–è¿­ä»£å±€éƒ¨æœ€ä¼˜ç­–ç•¥ã€‚å¦‚æ­¤å¾ªç¯è¿™ä¸¤æ­¥ç›´åˆ°ç­–ç•¥æ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥ï¼Œdoneï¼</p>
<p>ï¼ˆ2ï¼‰åŒç†ï¼Œæ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ ä¹Ÿæ˜¯è¦åˆ†ä¸¤æ­¥ï¼š<br/>
ç¬¬1æ­¥ï¼šå°±æ˜¯ç”¨æœ¬ç« å°†è¦è®²è§£çš„MCã€TDã€TD(Î»)ä¸‰ä¸ªç®—æ³•æ¥<strong>æ— æ¨¡å‹é¢„æµ‹</strong>ï¼Œæˆ–è€…è¯´<strong>ä¼°è®¡ä¸€ä¸ªæœªçŸ¥MDPçš„ä»·å€¼å‡½æ•°</strong>ã€‚åœ¨æ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œè¿™ç§è®¡ç®—ä»·å€¼çš„ç®—æ³•å«<strong>è¯„ä¼°</strong>ã€‚æ‰€ä»¥æœ¬ç« çš„ç®—æ³•éƒ½<strong>åªæ˜¯</strong>ç”¨æ¥è®¡ç®—<strong>çŠ¶æ€ä»·å€¼</strong>çš„ã€‚</p>
<p>ç¬¬2æ­¥ï¼š<strong>æ— æ¨¡å‹æ§åˆ¶</strong>ï¼Œä¹Ÿå°±æ˜¯<strong>ä¼˜åŒ–ä¸€ä¸ªæœªçŸ¥MDPçš„ä»·å€¼å‡½æ•°</strong> ç”±äºæœ‰äº›éå®Œå¤‡MDPé—®é¢˜ï¼Œæ¯”å¦‚æŠ•èµ„ã€æœºå™¨äººè¡Œèµ°ç­‰ä¸€äº›åœºæ™¯ï¼Œè™½ç„¶ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªé©¬å°”å¯å¤«è¿‡ç¨‹ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹å¤ªå¤æ‚ï¼Œæˆ‘ä»¬å¯èƒ½æ ¹æœ¬è¿çŠ¶æ€-è¡ŒåŠ¨-å¥–åŠ±çš„åºåˆ—éƒ½æ— æ³•æè¿°å‡ºæ¥ï¼Œæ­¤æ—¶å°±éœ€è¦æ— æ¨¡å‹æ§åˆ¶æ¥è§£å†³è¿™ç±»é—®é¢˜ã€‚æ‰€ä»¥<strong>ä¸‹ä¸€ä¸ªç¯‡ç« </strong>æˆ‘ä»¬è®²æ— æ¨¡å‹æ§åˆ¶ã€‚</p>
<p><strong>4ã€ä½ å¿…å¤‡çš„åŸºç¡€</strong><br/>
ä¸Šé¢æ€»ç»“çš„ä¸€äº›ç»“è®ºï¼Œå¦‚æœä½ çœ‹ä¸æ˜ç™½ï¼Œè¯´æ˜ä½ è¿˜æ²¡æœ‰å¼ºåŒ–å­¦ä¹ çš„åŸºç¡€ï¼Œé‚£æœ¬ç« ä½ ç†è§£èµ·æ¥ä¹Ÿä¼šéå¸¸æŠ½è±¡å’Œéš¾æ‡‚ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸€å¼€å§‹å°±è¦èŠ±å¤§é‡ç¯‡å¹…å»è®²DPçš„åŸå› ã€‚ä½ å¿…é¡»è¦å½»åº•å¼„æ‡‚ï¼Œç¬¬äºŒç« çš„<strong>å¢é‡å¼å‡å€¼è®¡ç®—</strong>ã€<strong>æŒ‡æ•°ç§»åŠ¨å¹³å‡</strong>ï¼Œç¬¬ä¸‰ç« çš„<strong>è´å°”æ›¼æœŸæœ›æ–¹ç¨‹</strong>ï¼Œç¬¬å››ç« åŠ¨æ€è§„åˆ’ä¸­çš„<strong>è¿­ä»£ç­–ç•¥è¯„ä¼°</strong>ï¼Œè¿™äº›å†…å®¹åŠ¡å¿…å¼„é€äº†ï¼Œæœ¬ç« çš„ä¸€äº›å…³é”®ç»†èŠ‚ä½ å°±è½»æ¾æ‹¿ä¸‹äº†ã€‚</p>
<h3 data-id="heading-1">äºŒã€è’™ç‰¹å¡æ´›å­¦ä¹ (Monte-Carlo Learning)</h3>
<p><strong>1ã€MCçš„åŸºæœ¬æè¿°å’ŒåŸºæœ¬æ€æƒ³</strong><br/>
è’™ç‰¹å¡æ´›å­¦ä¹ ï¼Œç®€ç§°MCï¼Œæ˜¯ä¸€ä¸ªå…¸å‹çš„æ— æ¨¡å‹ç®—æ³•ï¼Œä¸»è¦ç”¨äºè®¡ç®—éå®Œå¤‡MDPä¸­çš„çŠ¶æ€ä»·å€¼ã€‚<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a899482d1c0949f4af0de122445fbf1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=7PYyz4%2FSaInoAB%2ByCmv51nz41no%3D" alt="" loading="lazy"/>ï¼ˆ1ï¼‰MCæ–¹æ³•æ˜¯éœ€è¦<strong>agentå’Œç¯å¢ƒè¿›è¡Œäº¤äº’çš„</strong>ï¼Œå› ä¸ºæœ‰äº¤äº’æ‰å¯ä»¥è·å¾—äº¤äº’æ•°æ®ï¼Œç„¶åä»äº¤äº’æ•°æ®ä¸­è®¡ç®—çŠ¶æ€ä»·å€¼ã€‚</p>
<p>ï¼ˆ2ï¼‰MCæ–¹æ³•è¦æ±‚agentå¾—<strong>ä»å¤´æ‰“åˆ°æ¸¸æˆç»“æŸ</strong>ã€‚æ‰€ä»¥MCåªèƒ½ç”¨äº<strong>æœ‰åˆ†å¹•çš„æƒ…å†µ</strong>ï¼Œå°±æ˜¯è¦æœ‰æ¸¸æˆç»“æŸçš„æƒ…å†µã€‚ä¸ºä»€ä¹ˆè¦è¾¾åˆ°æ¸¸æˆç»“æŸå‘¢ï¼Ÿå› ä¸ºMCè®¡ç®—çŠ¶æ€ä»·å€¼æ˜¯é€šè¿‡ä¸€æ¡æ¡å¹•è®¡ç®—å‡å€¼çš„ï¼Œè€Œè®¡ç®—è¿‡ç¨‹æ˜¯ä»ç»ˆæ­¢çŠ¶æ€ä¸€æ­¥æ­¥å›æº¯è®¡ç®—çš„ï¼Œæ¸¸æˆä¸æ‰“å®Œå°±æ²¡æ³•ç®—å•Šï¼</p>
<p>ï¼ˆ3ï¼‰MCå°±æ˜¯ç”¨æ ·æœ¬å‡å€¼ä¼°è®¡æ€»ä½“å‡å€¼çš„æ–¹æ³•ï¼Œå°±æ˜¯ç”¨æ ·æœ¬å‡å€¼é€¼è¿‘æ€»ä½“å‡å€¼ï¼Œæˆ–è€…è¯´å°±æ˜¯ç”¨é¢‘ç‡é€¼è¿‘æ¦‚ç‡çš„æ€è·¯ã€‚åœ¨å®Œå¤‡çš„MDPä¸­æˆ‘ä»¬æ˜¯æœ‰çŠ¶æ€è½¬ç§»çŸ©é˜µçš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ¦‚ç‡ç®—å‡ºçŠ¶æ€ä»·å€¼çš„æœŸæœ›ï¼Œä½†æ˜¯æ— æ¨¡å‹æ˜¯ä¸çŸ¥é“ç³»ç»ŸçŠ¶æ€æ˜¯å¦‚ä½•è½¬ç§»çš„ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡å®å®åœ¨åœ¨èµ°å‡ºçš„ä¸€æ¡æ¡å¹•ï¼Œé€šè¿‡è¿™äº›å¹•ä¸­çš„çŠ¶æ€<strong>å®é™…å›æŠ¥</strong>çš„<strong>å‡å€¼</strong>æ¥ä¼°è®¡çŠ¶æ€ä»·å€¼ã€‚</p>
<p><strong>2ã€MCå…·ä½“æ˜¯å¦‚ä½•è®¡ç®—çŠ¶æ€ä»·å€¼çš„ï¼Ÿ</strong><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53fc8bcd4f9342f2bdac5c9da01d5356~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=N3QhsnaOraxiNz6akFzo1LbY4OI%3D" alt="" loading="lazy"/>ï¼ˆ1ï¼‰MCå¯ä»¥é€šè¿‡ä¸Šé¢ä¸¤ç§æ–¹æ³•æ¥è®¡ç®—çŠ¶æ€ä»·å€¼ï¼š<strong>first-visit</strong>æˆ–è€…<strong>every-visit</strong>ã€‚</p>
<p>ï¼ˆ2ï¼‰ä¸Šå›¾æ˜¯agentå®å®åœ¨åœ¨çš„æ‰“äº†6è½®æ¸¸æˆï¼Œäº§ç”Ÿäº†6æ¡åˆ†å¹•ï¼Œæˆ‘ä»¬ç°åœ¨æ˜¯è¦é€šè¿‡è¿™6æ¡åˆ†å¹•æ¥è®¡ç®—çŠ¶æ€ä»·å€¼çš„ã€‚<br/>
æ³¨æ„ï¼šè¿™6æ¡åˆ†å¹•å¿…é¡»æ˜¯åŒä¸€ä¸ªç­–ç•¥ä¸‹çš„æ¸¸æˆåºåˆ—ï¼ä¸èƒ½æ˜¯ä¸åŒç­–ç•¥ä¸‹çš„åºåˆ—ï¼å› ä¸ºä¸åŒç­–ç•¥å¯¹åº”ç€ä¸åŒçš„ä»·å€¼å‡½æ•°ã€‚ç°åœ¨æˆ‘ä»¬åªæ˜¯è®¡ç®—ä»·å€¼å‡½æ•°ï¼Œä¸æ˜¯æå‡ç­–ç•¥ï¼Œæå‡ç­–ç•¥ä¸‹ä¸€ä¸ªç« èŠ‚è®²ã€‚</p>
<p>ï¼ˆ3ï¼‰ä¸Šå·¦å›¾æ˜¯åˆ©ç”¨è¿™6æ¡åˆ†å¹•æ¥è®¡ç®—çŠ¶æ€s0çš„ä»·å€¼å€¼çš„ç¤ºä¾‹ã€‚å…·ä½“åšæ³•æ˜¯ï¼š</p>
<blockquote>
<p>é¦–å…ˆåœ¨æ¯æ¡åˆ†å¹•ä¸­æ‰¾åˆ°çŠ¶æ€s0<strong>ç¬¬ä¸€æ¬¡å‡ºç°</strong>çš„åœ°æ–¹ã€‚æ¯”å¦‚åˆ†å¹•1ä¸­ï¼Œs0ç¬¬ä¸€å‡ºç°åœ¨aå¤„ï¼Œè™½ç„¶bå¤„ä¹Ÿå‡ºç°äº†s0ï¼Œä½†æ˜¯ä¸ç”¨ç®¡bå¤„ï¼Œæˆ‘ä»¬åªè®¡ç®—aå¤„s0çš„ä»·å€¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå«first-visitçš„åŸå› ã€‚é‚£aå¤„s0çš„ä»·å€¼=å…¶åæ‰€æœ‰çŠ¶æ€çš„ç³»ç»Ÿå¥–åŠ±å’Œã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆMCå¿…é¡»è¦æ±‚agentä»å¤´æ‰“å®Œä¸€æ•´å±€æ¸¸æˆï¼Œå¿…é¡»æœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œå¦åˆ™æ²¡æ³•ç®—å•Šã€‚<strong>å¦‚æ­¤ä¾¿ç®—å‡ºäº†ç¬¬ä¸€ä¸ªs0çš„ä»·å€¼å€¼</strong>ã€‚</p>
<p>åŒç†ï¼Œè§‚å¯Ÿåˆ†å¹•2ä¸­s0å‡ºç°çš„ä½ç½®ï¼Œå‘ç°åˆ†å¹•2ä¸­å‹æ ¹å°±æ²¡å‡ºç°çŠ¶æ€s0ï¼Œé‚£å°±å¼ƒç”¨è¿™æ¡åˆ†å¹•ï¼</p>
<p>åŒç†ï¼Œè®¡ç®—åˆ†å¹•3ã€åˆ†å¹•4ã€åˆ†å¹•6ä¸­çš„s0ä»·å€¼å€¼ã€‚è¿™æ ·å°±åˆå¾—åˆ°3ä¸ªs0çš„ä»·å€¼å€¼ã€‚</p>
<p>æœ€åï¼Œæ±‚è¿™4ä¸ªs0ä»·å€¼å€¼çš„å‡å€¼ï¼Œ<strong>å°±å¾—åˆ°çŠ¶æ€s0çš„ä»·å€¼å€¼</strong>ã€‚</p>
<p>å¦‚æ­¤æ–¹æ³•è®¡ç®—å…¶ä»–çŠ¶æ€çš„ä»·å€¼ã€‚</p>
</blockquote>
<p>ï¼ˆ4ï¼‰ä¸Šå³å›¾ï¼šæ–¹æ³•2ç¤ºä¾‹çš„ä¹Ÿæ˜¯<strong>å¦‚ä½•è®¡ç®—çŠ¶æ€s0çš„ä»·å€¼å€¼</strong>ã€‚ä½†æ˜¯every-visité‡‡ç”¨çš„æ˜¯ï¼Œ<strong>åªè¦å¹•ä¸­å‡ºç°çŠ¶æ€s0ï¼Œå°±ç»Ÿç»Ÿè®¡ç®—å…¶ä»·å€¼å€¼</strong>ï¼Œç„¶åæ±‚å¹³å‡ï¼Œå¹³å‡å€¼å°±æ˜¯s0çš„ä»·å€¼å€¼ã€‚ç®€å•ç²—æš´ã€‚</p>
<p>ï¼ˆ5ï¼‰æˆ‘ä»¬ä¸€èˆ¬<strong>å¤šæ•°</strong>ç”¨çš„æ˜¯every-visitæ–¹å¼ã€‚anywayï¼Œä¸ç®¡æ˜¯first-visitè¿˜æ˜¯every-visitï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯å¯ä»¥æ”¶æ•›çš„ï¼Œæ‰€ä»¥è¿™ä¸¤ç§æ–¹æ³•å·®åˆ«ä¸å¤§ï¼Œä½ éšä¾¿é€‰ä¸€ç§å³å¯ï¼Œä¸å¿…çº ç»“ã€‚</p>
<p><strong>3ã€å¢é‡å¼MCã€æŒ‡æ•°ç§»åŠ¨å¹³å‡MC</strong><br/>
MCçš„åŸç†éå¸¸éå¸¸ç®€å•ï¼Œä½†æ˜¯å·¥ç¨‹å®ç°ä¸Šè¿˜æœ‰<strong>ä¸¤ä¸ªæŠ€å·§</strong>ï¼š<br/>
ï¼ˆ1ï¼‰å¯¹äºç¨³æ€ç¯å¢ƒé—®é¢˜ï¼Œå·¥ç¨‹ä¸Šä¸€èˆ¬æ˜¯ç”¨<strong>å¢é‡</strong>(incremental)æ¥è®¡ç®—ä»·å€¼å‡å€¼çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„<strong>å¢é‡å¼MC</strong>ã€‚</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆä¼šæœ‰å¢é‡å¼MCï¼Ÿ</p>
<p>é¦–å…ˆï¼Œæ¯”å¦‚ä¸Šé¢first-visitå’Œevery-visitæ±‚s0çš„ç¤ºä¾‹ä¸­ï¼Œæ˜¯æ™ºèƒ½ä½“ä¸€æ¬¡æ€§æ‰“å®Œ6è½®æ¸¸æˆï¼Œæ‹¿åˆ°6æ¡åˆ†å¹•çš„æ•°æ®ï¼Œç„¶åæ‰å¼€å§‹è®¡ç®—s0ã€‚é‚£åœ¨å·¥ç¨‹å®ç°ä¸Šï¼Œæ˜¯ä¸æ˜¯å¾—ä¿ç•™6æ¡åˆ†å¹•çš„æ‰€æœ‰æ•°æ®åï¼Œæ‰èƒ½è®¡ç®—çŠ¶æ€ä»·å€¼ã€‚å¦‚æœä¸€ä¸ªæ¸¸æˆè¦ç©æ•°åä¸‡è½®æ•°ç™¾ä¸‡è½®è®¡ç®—ç»“æœæ‰å¯é ï¼Œé‚£ä¸å°±å¾—è¦ä¿å­˜æ•°åä¸‡æ¡æ•°ç™¾ä¸‡æ¡åˆ†å¹•ï¼å…¶å®æ²¡å¿…è¦ï¼Œæˆ‘ä»¬çš„ç›®çš„<strong>åªæ˜¯è®¡ç®—å‡å€¼è€Œå·²</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨agentæ‰“å®Œç¬¬1æ¡åˆ†å¹•åï¼Œå°±è®¡ç®—ä¸€æ¬¡s0ï¼Œagentç»§ç»­æ‰“å®Œç¬¬2æ¡åˆ†å¹•åï¼Œå†è®¡ç®—(æ›´æ–°)ä¸€æ¬¡s0ï¼Œå¦‚æ­¤ä¸æ–­æ›´æ–°å³å¯ã€‚è¿™æ ·ä¹‹å‰æ‰“çš„åˆ†å¹•å°±æ²¡å¿…è¦ä¿å­˜äº†ï¼Œè¿™æ ·å°±æ›´èŠ‚çœå†…å­˜å’Œç®—åŠ›äº†ã€‚æ‰€ä»¥ï¼Œç°å®ä¸­æˆ‘ä»¬ä¸æ˜¯åç­‰agentæ‰“å®Œæ•°åä¸‡æ•°ç™¾ä¸‡è½®æ¸¸æˆåå†è®¡ç®—ï¼Œä¸€èˆ¬éƒ½æ˜¯æ‰“å®Œä¸€å±€æ¸¸æˆå°±è®¡ç®—ä¸€æ¬¡ã€‚</p>
<p>å…¶æ¬¡ï¼Œ<strong>å¢é‡å¼MCçš„è®¡ç®—ç»“æœå’Œæ€»ä½“æ±‚å¹³å‡çš„ç»“æœæ˜¯ä¸€æ ·çš„</strong>ï¼Œè€Œä¸”<strong>å„é¡¹çš„æƒé‡æ˜¯ä¸€æ ·çš„</strong>ã€‚</p>
</blockquote>
<p>ï¼ˆ2ï¼‰å¯¹äºéç¨³æ€ç¯å¢ƒé—®é¢˜ï¼Œä¸€èˆ¬æ˜¯ç”¨<strong>æŒ‡æ•°ç§»åŠ¨å¹³å‡</strong>æ¥è®¡ç®—ä»·å€¼å‡å€¼çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„<strong>æŒ‡æ•°ç§»åŠ¨å¹³å‡MC</strong>ã€‚</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆä¼šæœ‰æŒ‡æ•°ç§»åŠ¨å¹³å‡MCï¼Ÿ</p>
<p>ç¨³æ€ç¯å¢ƒå°±æ˜¯æ¯”å¦‚agentæ‰“æ¸¸æˆï¼Œæ¯æ¬¡æ‰“åˆ°çŠ¶æ€s1ï¼Œå¹¶ä¸”agentåšäº†a1åŠ¨ä½œåï¼Œç³»ç»Ÿè½¬ç§»åˆ°å…¶ä»–çŠ¶æ€çš„æ¦‚ç‡æ˜¯ç¨³å®šçš„ã€‚è¿™ç§æƒ…å†µæˆ‘ä»¬ä¸€èˆ¬ç§°ä¸ºç¨³æ€ã€‚éç¨³æ€å°±æ˜¯agentæ‰“åˆ°çŠ¶æ€s1å¹¶ä¸”åšäº†a1åŠ¨ä½œåï¼Œç³»ç»Ÿè¿ç§»åˆ°å…¶ä»–çŠ¶æ€æ˜¯é£˜å¿½ä¸å®šçš„ï¼Œå°±æ˜¯æ²¡æœ‰ä¸€ä¸ªå›ºå®šæ¦‚ç‡çš„è½¬ç§»é›†åˆã€‚è¿™ç§æƒ…å†µå°±æ˜¯éç¨³æ€æƒ…å†µã€‚æ­¤æ—¶å¦‚æœagentå†æŒ‰ç…§ä¹‹å‰æ‰“æ¸¸æˆçš„ç»éªŒæ¥æ‰“æœ¬è½®æ¸¸æˆï¼Œå²‚ä¸æ˜¯ä¼šåƒäºï¼Œå› ä¸ºä¹‹å‰çš„ç»éªŒä¸å¯é äº†ï¼Œæ‰€ä»¥æ­¤æ—¶å°±å¾—ç”¨<strong>æŒ‡æ•°ç§»åŠ¨å¹³å‡</strong>æ¥è®¡ç®—ä»·å€¼ï¼Œå°±æ˜¯åœ¨è®¡ç®—æ—¶ï¼Œç»™æœ€è¿‘è½®æ¬¡çš„ç»éªŒæ›´é«˜çš„æƒé‡ï¼Œè¶Šå¾€å‰çš„ç»éªŒç»™æ›´å°çš„æƒé‡ã€‚</p>
</blockquote>
<p>ï¼ˆ3ï¼‰<strong>å¢é‡å¼MC</strong>å’Œ<strong>æŒ‡æ•°ç§»åŠ¨å¹³å‡MC</strong>çš„è¿­ä»£è¿‡ç¨‹çš„<strong>æ•°å­¦è¡¨ç¤º</strong>ï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/063d487046f94aca81f327da9a088a32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=OWRZpy4idF7xkblLwmkHX7mj%2B7M%3D" alt="" loading="lazy"/>ï¼ˆ4ï¼‰ä¸‹é¢æˆ‘å†ç”¨ä¸€ä¸ªå°ä¾‹å­å¯¹æ¯”ä¸€ä¸‹å¢é‡å¼MCã€æŒ‡æ•°ç§»åŠ¨å¹³å‡MCä¹‹é—´çš„å„é¡¹æƒé‡çš„å·®å¼‚ï¼Œå› ä¸ºä¸ç®¡æ˜¯è¿™é‡Œçš„éç¨³æ€MCè¿˜æ˜¯åé¢è¦è®²çš„æ—¶åºå·®åˆ†ï¼Œéƒ½æœ‰Î±è¿™ä¸ªè¶…å‚æ•°ï¼Œè€Œä¸”Î±å¯¹ç®—æ³•çš„æ”¶æ•›æ€§çš„å½±å“è¿˜å¾ˆå¤§ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å†ç›´è§‚çš„çœ‹çœ‹è¶…å‚Î±åœ¨è®¡ç®—ä¸­çš„ä½œç”¨ï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3639ad71bb2a4128aecc0e5e25a10ad9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=Ip%2B8R5EgvudgOFh77BMrXD10Y5Q%3D" alt="" loading="lazy"/>ä»è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥æ¸…æ™°çœ‹åˆ°å¢é‡å¼MCå’Œæ™®é€šçš„æ±‚å‡å€¼æ•ˆæœæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ä½†æ˜¯æŒ‡æ•°ç§»åŠ¨å¹³å‡MCçš„æƒé‡æ˜¯ä¸€ä¸ªæŒ‡æ•°é€’å‡çš„è¿‡ç¨‹ï¼Œä¾‹å­ä¸­Î±=1/5ï¼Œæ¯æ¬¡æƒé‡æŒ‰ç…§ä¸Šæ¬¡çš„20%é€Ÿç‡è¿›è¡Œé€’å‡ï¼Œæ‰€ä»¥è¶Šå¾€åæƒé‡è¶Šå°ã€‚</p>
<p>å…¶å®ä¸ç®¡æ˜¯<strong>å¢é‡å¼è®¡ç®—çŠ¶æ€ä»·å€¼</strong>è¿˜æ˜¯<strong>æŒ‡æ•°ç§»åŠ¨å¹³å‡è®¡ç®—çŠ¶æ€</strong>ï¼Œæˆ‘åœ¨ç¬¬äºŒç« éƒ½å·²ç»ç”¨<strong>å®é™…ä¾‹å­</strong>å’Œ<strong>å…·ä½“ä»£ç </strong>ç»™å¤§å®¶å±•ç¤ºè¿‡äº†ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Ffriday1203%2Farticle%2Fdetails%2F155787017%3Fspm%3D1001.2014.3001.5501" target="_blank" title="https://blog.csdn.net/friday1203/article/details/155787017?spm=1001.2014.3001.5501" ref="nofollow noopener noreferrer">blog.csdn.net/friday1203/â€¦</a> è¿˜æ˜¯ä¸ç†è§£çš„åŒå­¦å¯ä»¥å›çœ‹æˆ‘è¿™ç¯‡åšæ–‡ä¸­çš„ä¾‹å­ã€‚</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•å°±è®¡ç®—å‡ºäº†<strong>ç­–ç•¥Î ä¸‹çš„ç³»ç»ŸçŠ¶æ€ä»·å€¼</strong>ã€‚ç°åœ¨å›çœ‹è¿™éƒ¨åˆ†çš„åŸç†æ˜¯ä¸æ˜¯ç‰¹åˆ«ç‰¹åˆ«ç®€å•å’Œé€šä¿—ï¼è€Œä¸”è¿™ä¸ªæ€æƒ³å…¶å®æˆ‘åœ¨ç¬¬ä¸‰ç« è®²<strong>çŠ¶æ€æ”¶ç›Š</strong>(return)çš„æ—¶å€™å°±å·²ç»æåˆ°äº†ã€‚</p>
<h3 data-id="heading-2">ä¸‰ã€æ—¶åºå·®åˆ†å­¦ä¹ (Temporal-Difference Learning)</h3>
<p><strong>1ã€æ—¶åºå·®åˆ†æ˜¯ç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ</strong><br/>
MCæ–¹æ³•æœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯<strong>éœ€è¦agentæ‰“å®Œæ¯ä¸€è½®æ¸¸æˆ</strong>ï¼Œæ‰èƒ½ä»ä¸€æ¡æ¡æ¸¸æˆåºåˆ—<strong>episode</strong>ä¸­è®¡ç®—å‡ºçŠ¶æ€ä»·å€¼ã€‚è¿™æ ·æ˜¯éå¸¸ä½æ•ˆçš„ï¼Œæ¯”å¦‚æœ‰çš„å¤æ‚æ¸¸æˆéœ€è¦æ‰“éå¸¸éå¸¸å¤šè½®ï¼Œæœ‰çš„çŠ¶æ€æ‰å‡ºç°ä¸€æ¬¡ï¼Œè€Œä¸”ä¸€è½®æ¸¸æˆéœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œé‚£ä¸æ˜¯è¦é‡‡æ ·åˆ°å¤©è’åœ°è€äº†å—ï¼Ÿè€Œä¸”æœ‰çš„æ¸¸æˆå‹æ ¹å°±æ²¡æœ‰ç»“æŸçŠ¶æ€ï¼Œé‚£MCå°±æ²¡æ³•ç”¨äº†ã€‚<strong>æ—¶åºå·®åˆ†å­¦ä¹ </strong>å°±åœ¨è¿™ä¸ªåœºæ™¯ä¸‹è¯ç”Ÿäº†ã€‚</p>
<p>æ‰€ä»¥æ—¶åºå·®åˆ†å­¦ä¹ æ˜¯ç”¨æ¥è®¡ç®—<strong>æ— æ³•è¿›è¡Œåˆ†å¹•</strong>çš„ã€éå®Œå¤‡çš„MDPä¸­çš„çŠ¶æ€ä»·å€¼çš„ã€‚ä¹Ÿæ‰€ä»¥æ—¶åºå·®åˆ†å­¦ä¹ ä¹Ÿæ˜¯ä¸€ä¸ª<strong>æ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ æ–¹æ³•</strong>ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸Šé¢çš„MCç®—æ³•åªèƒ½<strong>ç¦»çº¿å­¦ä¹ </strong>ï¼Œæ—¶åºå·®åˆ†å­¦ä¹ å¯ä»¥<strong>åœ¨çº¿å­¦ä¹ </strong>ã€‚</p>
<ul>
<li>
<p><strong>åœ¨çº¿å­¦ä¹ (Online Learning)å’Œç¦»çº¿å­¦ä¹ (Offline Learning)</strong></p>
<blockquote>
<p>åœ¨çº¿å­¦ä¹ å’Œç¦»çº¿å­¦ä¹ æ˜¯å¼ºåŒ–å­¦ä¹ ä¸­çš„ä¸¤ç§èŒƒå¼ï¼Œæè¿°çš„æ˜¯<strong>æ•°æ®çš„æ¥æºæ–¹å¼</strong>ï¼šä½ çš„ç®—æ³•åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ˜¯å¦èƒ½æŒç»­ä¸ç¯å¢ƒäº¤äº’ï¼Œå®æ—¶æ”¶é›†æ–°æ•°æ®ï¼Ÿ</p>
<p>ï¼ˆ1ï¼‰ç¦»çº¿å­¦ä¹ ï¼šè¡¨ç¤ºæ¸¸æˆçš„è½®æ¬¡(å¯ä»¥æ˜¯ä¸€ä¸ªepisodeï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªepisode)å·²ç»å…¨éƒ¨æ‰“å®Œï¼Œç„¶åå†è®¡ç®—çŠ¶æ€ä»·å€¼ã€‚æ¯”å¦‚MCå°±å¿…é¡»è¦è‡³å°‘æ‰“å®Œä¸€å±€æ¸¸æˆï¼Œæ‰èƒ½å¼€å§‹è®¡ç®—çŠ¶æ€ä»·å€¼ï¼Œæ‰€ä»¥MCæ˜¯ç¦»çº¿å­¦ä¹ ã€‚</p>
<p>ï¼ˆ2ï¼‰åœ¨çº¿å­¦ä¹ ï¼šè¡¨ç¤ºè¾¹æ‰“æ¸¸æˆè¾¹è®¡ç®—çŠ¶æ€ä»·å€¼ï¼Œæˆ–è€…è¯´ï¼Œç”šè‡³å¯ä»¥æ‰“ä¸€æ­¥æ¸¸æˆå°±è¯„ä¼°ä¸€æ¬¡çŠ¶æ€ä»·å€¼ã€‚æ¯”å¦‚TDå°±æ˜¯åœ¨çº¿è¿›å­¦ä¹ ã€‚</p>
</blockquote>
</li>
</ul>
<p>å°±æ˜¯MCå­¦çš„æ˜¯Î ç­–ç•¥ä¸‹çš„episode,è€Œæ—¶åºå·®åˆ†å¯ä»¥å­¦Î ç­–ç•¥ä¸‹çš„trajectoryï¼Œä¹Ÿå°±æ˜¯åªè¦æœ‰Î ç­–ç•¥ä¸‹çš„(st,rt+1,st+1)ç‰‡æ®µå°±å¯ä»¥ç”¨TDè¿›è¡Œä»·å€¼è¯„ä¼°äº†ã€‚<br/>
TD learning is online.It can update the state/action values immediately after receiving a reward.<br/>
MC learning is offline.It has to wait until an episode has been completely collected.</p>
<p>ä¹Ÿæ‰€ä»¥TDå¯ä»¥å¤„ç†episodic tasks å’Œ continuing tasksã€‚è€ŒMCåªèƒ½å¤„ç†continuing tasksã€‚</p>
<p><strong>2ã€æ—¶åºå·®åˆ†çš„åŸºæœ¬æè¿°å’ŒåŸºæœ¬æ€æƒ³</strong><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f9e3540bf7447688bc03b15d14a60cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=XzRwKnCysidz8Fq9CsFaMjoziJU%3D" alt="" loading="lazy"/>ï¼ˆ1ï¼‰ä¸Šå›¾å·¦è¾¹æ˜¯<strong>æ—¶åºå·®åˆ†çš„åŸºæœ¬æè¿°</strong>ã€‚ä¸­é—´æ˜¯<strong>éç¨³æ€çš„every-visitè’™ç‰¹å¡æ´›å­¦ä¹ </strong>ã€‚å³è¾¹æ˜¯<strong>æœ€ç®€å•çš„æ—¶åºå·®åˆ†å­¦ä¹ </strong>ã€‚å°†TDå’ŒMCæ”¾ä¸€èµ·å› ä¸ºTDæ˜¯å¯¹MCçš„æ”¹è¿›ç®—æ³•ï¼Œæ–¹ä¾¿å¯¹äºŒè€…è¿›è¡Œå¯¹æ¯”ã€‚</p>
<p>ï¼ˆ2ï¼‰Aå¤„ï¼šå‰é¢è®²<strong>åŠ¨æ€è§„åˆ’</strong>æ—¶çš„<strong>è¿­ä»£ç­–ç•¥è¯„ä¼°</strong>ä¸­ï¼Œå½“æ—¶å°±è¯´é‚£ä¸ªè¿­ä»£è¿‡ç¨‹å«<strong>è‡ªä¸¾</strong> bootstrappingï¼Œå°±æ˜¯<strong>ä»ä¸€ç»„éæ”¶æ•›çš„</strong>çŠ¶æ€ä»·å€¼è¿­ä»£åˆ°<strong>ä¸€ç»„æ”¶æ•›çš„</strong>çŠ¶æ€ä»·å€¼ï¼æˆ–è€…è¯´å°±æ˜¯ï¼Œé€šè¿‡ä¸€ç»„é¢„æµ‹å€¼æ¥é¢„æµ‹å¦å¤–ä¸€ç»„é¢„æµ‹å€¼ï¼Œå°±è¿™æ ·ä¸æ–­åœ°é¢„æµ‹ï¼Œæœ€åè¿˜èƒ½é¢„æµ‹æ­£ç¡®å€¼ï¼å…¶å®è¿™ä¹Ÿæ˜¯å¼ºåŒ–å­¦ä¹ æœ€å¤§çš„ç¼ºç‚¹ï¼Œä¹Ÿæ˜¯å¯¼è‡´å¼ºåŒ–å­¦ä¹ çš„æ”¶æ•›æ€§ä¸€ç›´éƒ½æ˜¯ä¸€ä¸ªè¡Œä¸šé—®é¢˜ã€‚æ‰€ä»¥åœ¨å¾ˆå¤šå¤æ‚æƒ…å†µä¸‹ï¼Œå¼ºåŒ–å­¦ä¹ çš„æ”¶æ•›æ€§ä¸€ç›´æ˜¯æ— æ³•è¯æ˜çš„ã€‚</p>
<p>æ­¤å¤„ä½ å¯ä»¥ç±»æ¯”<strong>æ¢¯åº¦ä¸‹é™ç®—æ³•</strong>ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•ä¹Ÿæ˜¯ä»ä¸€ä¸ªéšæœºçŠ¶æ€å‡ºå‘ï¼Œä¸€æ­¥æ­¥è¿­ä»£ï¼Œè™½ç„¶æ”¶æ•›åˆ°å…¨å±€æœ€ä¼˜å¤„æ¯”è¾ƒéš¾ï¼Œä½†æ˜¯æ‰¾åˆ°ä¸€ä¸ªå±€éƒ¨æœ€ä¼˜è¿˜æ˜¯å¯ä»¥çš„ã€‚å…¶å®æ¢¯åº¦ä¸‹é™ç®—æ³•ä¹Ÿæ˜¯bootstrappingçš„è¿­ä»£è¿‡ç¨‹ã€‚</p>
<p>ç”±äºTDä¸»è¦æ˜¯ç”¨äºæ— æ¨¡å‹æƒ…æ™¯ï¼Œæ‰€ä»¥TDç®—æ³•æ˜¯ä»ä¸€ä¸ªéšæœºçš„åˆå§‹çŠ¶æ€å‡ºå‘ï¼Œç„¶åé€šè¿‡åæ¥çš„å®é™…æ•°æ®ï¼Œè®¡ç®—TD errorï¼Œé€šè¿‡TD errorä¸€æ­¥æ­¥çŸ«æ­£é¢„æµ‹ï¼Œæœ€åå¾—åˆ°æœ€ä¼˜è§£ã€‚The TD error can be interpreted as innovation, which means new information obtained from experience(st, rt+1,st+1)ã€‚è¿™é‡Œçš„experienceå°±æ˜¯å®å®åœ¨åœ¨æ‰“å‡ æ­¥çš„æ¸¸æˆåºåˆ—æ•°æ®ã€‚</p>
<p>TD bootstraps because the update of a value relies on the previous estimate of this value. Hence, it requires initial guesses.<br/>
MC is not bootstrapping, because it can directly estimate state/action values without any initial guess.</p>
<p>ï¼ˆ3ï¼‰Cå¤„ï¼šAå¤„è¯´TDæ˜¯é€šè¿‡ä¸æ–­åœ°è‡ªä¸¾è¿­ä»£æ¥è®¡ç®—<strong>æ”¶æ•›çš„çŠ¶æ€ä»·å€¼</strong>çš„ã€‚é‚£TDå…·ä½“å¦‚ä½•è‡ªä¸¾è¿­ä»£çš„å‘¢ï¼Ÿå°±æ˜¯<strong>ä¸Šå›¾Cå¤„çš„å¼å­</strong>ï¼Œè¿™ä¸ªå¼å­å°±æ˜¯TDè‡ªä¸¾çš„è¿‡ç¨‹ã€‚</p>
<ul>
<li>æˆ‘ä»¬å…ˆçœ‹Cå¤„<strong>ç°æ¡†ä¸­çš„çº¢è‰²å­—ä½“éƒ¨åˆ†</strong>ï¼š</li>
</ul>
<blockquote>
<p>å®ƒä¸å°±æ˜¯å‰é¢ç¬¬ä¸‰ç« ä¸­çš„<strong>è´å°”æ›¼æœŸæœ›æ–¹ç¨‹</strong>çš„å½¢å¼ä¹‹ä¸€å˜›ï¼å¯è§ï¼Œåˆæ˜¯æŠŠæ— é™è®¡ç®—å˜æˆæœ‰é™å±€éƒ¨å…³ç³»çš„æˆç ï¼</p>
<p>MCè®¡ç®—æ”¶æ•›çš„çŠ¶æ€ä»·å€¼æ—¶ï¼Œæ˜¯å¾—agentå®å®åœ¨åœ¨åœ°æ‰“äº†å¾ˆå¤šæ­¥æ¸¸æˆï¼Œæ¸¸æˆä¸­çš„æ¯ä¸ªçŠ¶æ€éƒ½éœ€è¦å‡ºç°å¾ˆå¤šæ¬¡ï¼Œæ‰èƒ½é€¼è¿‘çœŸå®çš„æœŸæœ›Gtã€‚æ‰€ä»¥MCç®—æ³•æ˜¯ç”¨<strong>å®é™…å›æŠ¥</strong>æ¥æ›´æ–°è¿­ä»£çŠ¶æ€ä»·å€¼ï¼Œç›´åˆ°é€¼è¿‘åˆ°çœŸæ­£çš„çŠ¶æ€ä»·å€¼(ä¹Ÿå°±æ˜¯æ”¶æ•›çš„çŠ¶æ€ä»·å€¼)ã€‚ä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œå°¤å…¶æ˜¯æœ‰äº›å¤æ‚æ¸¸æˆï¼ŒçŠ¶æ€ä¸ªæ•°éå¸¸å¤šçš„æ¸¸æˆï¼ŒMCå°±æ²¡æ³•ç®—äº†ï¼Œå› ä¸ºå¯èƒ½æœ‰äº›çŠ¶æ€MCéƒ½æ‰“äº†1ä¸‡è½®äº†ä¹Ÿæ²¡ç¢°åˆ°è¿‡ï¼Œæ‰€ä»¥æ­¤æ—¶å°±å¾—ç”¨TDäº†ã€‚</p>
<p>TDå°±éå¸¸é«˜æ˜äº†ï¼Œæˆ‘æƒ³å®ƒä¸€å®šæ˜¯å€Ÿé‰´äº†<strong>è´å°”æ›¼æœŸæœ›æ–¹ç¨‹</strong>çš„æ€è·¯ï¼šTDç”±äºæ²¡æœ‰åƒMCé‚£æ ·æ‰“äº†å¾ˆå¤šå¹•çš„æ¸¸æˆï¼Œæœ‰å¾ˆå¤šä¿¡æ¯ï¼ŒTDå¯èƒ½åªæ‰“äº†å‡ æ­¥æ¸¸æˆï¼Œæ‰€ä»¥å¯¹äºTDæ¥è¯´ï¼Œæ—¢ç„¶æ•´ä½“æ— æ³•æ±‚è§£ï¼Œé‚£æˆ‘å°±è§‚å¯Ÿå±€éƒ¨ï¼Œæˆ‘æ‰¾å‡ºå±€éƒ¨ä¹‹é—´çš„å…³ç³»ï¼Œè®©ä¸€ä¸ªæ— é™çš„ä¸œè¥¿å˜æˆäº†ä¸€ä¸ªé€’æ¨å¼ï¼Œå°±è®©<strong>æ— é™å˜æˆäº†æœ‰é™</strong>ã€‚å°±æ˜¯TD<strong>ç©çš„æ¸¸æˆçš„æ­¥æ•°</strong>æ˜¯æ— é™çš„ï¼Œä½†æ˜¯TDå¯èƒ½å°±åªç©äº†å‡ æ­¥ï¼Œé‚£æƒ³ä»æ— é™çš„æ¸¸æˆä¸­ç®—å‡ºGtï¼Œå°±åªèƒ½åˆ—å‡ºæ¸¸æˆä¸­<strong>æœ‰é™çŠ¶æ€ä¹‹é—´</strong>çš„Gtçš„å…³ç³»ï¼æ‰€ä»¥TDç”¨çš„æ˜¯<strong>ä¼°è®¡å›æŠ¥</strong>æ¥æ›´æ–°è¿­ä»£çŠ¶æ€ä»·å€¼çš„ã€‚è¿™é‡Œä½ å¯ä»¥ç±»æ¯”<strong>åŠ¨æ€è§„åˆ’</strong>ä¸­çš„<strong>è¿­ä»£ç­–ç•¥è¯„ä¼°</strong>ï¼Œé€šè¿‡é¢„æµ‹å€¼æ¥é¢„æµ‹å¦å¤–ä¸€ç»„é¢„æµ‹å€¼ï¼Œä¸€è½®è½®é¢„æµ‹ï¼Œæœ€åä¹Ÿèƒ½æ”¶æ•›åˆ°çœŸæ­£çš„çŠ¶æ€ä»·å€¼ã€‚</p>
<p>ä¹Ÿæ‰€ä»¥ï¼Œè¿™é‡Œçš„<strong>Î³æ˜¯å›æŠ¥çš„æŠ˜æ‰£å› å­</strong>ã€‚å’Œæˆ‘ä»¬è®¡ç®—ç¬¬ä¸‰ç« ä¸­è®¡ç®—çŠ¶æ€å›æŠ¥å…¬å¼ä¸­çš„Î³å«ä¹‰ä¸€æ ·ï¼ï¼</p>
</blockquote>
<ul>
<li>ä¸‹é¢æˆ‘ä»¬å†çœ‹<strong>Cå¤„æ•´ä¸ªå¼å­</strong>ï¼š</li>
</ul>
<blockquote>
<p>Cå¤„æ•´ä¸ªå¼å­è¡¨ç¤ºçš„æ˜¯TDæ˜¯<strong>å¦‚ä½•è¿­ä»£åˆ°æ”¶æ•›çš„çŠ¶æ€ä»·å€¼</strong>çš„è¿‡ç¨‹ã€‚TDè¿˜æ˜¯<strong>ä¸åŒäº</strong>åŠ¨æ€è§„åˆ’ä¸­çš„è¿­ä»£ç­–ç•¥è¯„ä¼°çš„ï¼Œç¬¬ä¸‰ç« è®²åŒæ­¥DPå’Œå¼‚æ­¥DPæ—¶ï¼Œéƒ½æ˜¯ä¸€æ¬¡è¿­ä»£ï¼Œå°±æ›´æ–°äº†å…¨éƒ¨çš„çŠ¶æ€ä»·å€¼ï¼Œå°±æ˜¯ä»v0-&gt;v1-&gt;v2-v3-&gt;...ä¸€ç›´æ”¶æ•›çš„vã€‚ä½†æ˜¯TDçš„è¿­ä»£æ–¹å¼å¼<strong>ä¸åŒ</strong>äºDPã€‚TDæ˜¯è¿­ä»£ä¸€æ¬¡ï¼Œè¿­ä»£çš„æ˜¯<strong>å·®å¼‚</strong>ï¼šv0 --&gt; v1' =v0+Î±(v1-v0) --&gt; v2'=v1'+Î±(v2-v1') --&gt; v3'=v2'+Î±(v3-v2') --&gt;.....ç›´åˆ°å¾—åˆ°æ”¶æ•›çš„ä¸€ç»„çŠ¶æ€ä»·å€¼ï¼Œåœæ­¢è¿­ä»£ã€‚</p>
<p>æ‰€ä»¥TDå«æ—¶åºå·®åˆ†å­¦ä¹ ï¼å› ä¸ºå®ƒè¿­ä»£çš„æ˜¯çŠ¶æ€åºåˆ—ä¹‹é—´çš„ä»·å€¼å·®å€¼ã€‚</p>
<p>è¯´æ˜ï¼šè¿™é‡Œçš„<strong>Î±</strong>æ˜¯<strong>è¿­ä»£çŠ¶æ€ä»·å€¼æ—¶ï¼Œç»éªŒçš„æŠ˜æ‰£å› å­</strong>ï¼æ„æ€å°±æ˜¯åœ¨è¿­ä»£è®¡ç®—çŠ¶æ€ä»·å€¼ï¼ŒÎ±å‚æ•°æ˜¯ç»™å½“å‰ç»éªŒå’Œè¿‡å»ç»éªŒçš„æƒé‡å‚æ•°ã€‚åœ¨éç¨³æ€ç¯å¢ƒä¸­ï¼Œè¿‡å»çš„ç»éªŒå¯èƒ½å‚è€ƒæ€§è¦å°å¾ˆå¤šï¼Œå› ä¸ºå‡ ä¸ªåŠ¨ä½œä¸‹æ¥ï¼Œå·²ç»æ—¶è¿‡å¢ƒè¿äº†ï¼Œç¯å¢ƒå·²ç»å‘ç”Ÿäº†å¾ˆå¤§çš„å˜åŒ–ï¼Œæ‰€ä»¥å½“å‰ç»éªŒæ¯”è¿‡å»ç»éªŒè¦æ›´å¯ä¿¡ï¼Œæ‰€ä»¥å‚æ•°Î±æ˜¯è°ƒæ•´å½“å‰ç»éªŒå’Œè¿‡å»ç»éªŒçš„å‚æ•°ã€‚ä¸€å®šè¦å’ŒÎ³åŒºåˆ«å¼€ã€‚äºŒè€…å«ä¹‰å¤©å·®åœ°åˆ«çš„ã€‚</p>
</blockquote>
<p>ï¼ˆ4ï¼‰Bå¤„ï¼šBå¤„æ˜¯MCçš„è¿­ä»£è¿‡ç¨‹ï¼Œåœ¨è®²MCæ—¶<strong>å·²ç»è®²è¿‡</strong>å®ƒçš„åŸç†äº†ã€‚è¿™é‡Œæƒ³è¯´çš„æ˜¯ï¼ŒTDç®—æ³•(Cå¤„)æ˜¯MCç®—æ³•(Bå¤„)çš„<strong>æ”¹è¿›ç®—æ³•</strong>ï¼Œæ”¹çš„ä»…ä»…æ˜¯<strong>Gtçš„è®¡ç®—æ–¹å¼</strong>ã€‚MCè®¡ç®—Gtæ˜¯é€šè¿‡ä¸€æ¡æ¡å®é™…æ‰“å‡ºæ¥çš„<strong>å¹•</strong>ä¸­å›æº¯è®¡ç®—è€Œå¾—çš„<strong>å®é™…å›æŠ¥</strong>ï¼Œè€ŒTDåˆ™æ˜¯åˆ©ç”¨<strong>è´å°”æ›¼æœŸæœ›æ–¹ç¨‹</strong>ä¼°è®¡çš„å›æŠ¥ã€‚ä¹Ÿæ‰€ä»¥<strong>MCå’ŒTDçš„æœ¬è´¨å·®å¼‚</strong>æ˜¯ï¼š</p>
<blockquote>
<p><strong>MCæ²¡æœ‰åˆ©ç”¨é©¬å°”å¯å¤«æ€§</strong>ï¼Œæ‰€ä»¥MCé€šå¸¸åœ¨éé©¬å°”å¯å¤«ç¯å¢ƒä¸­æ›´æœ‰æ•ˆã€‚<br/>
<strong>TDåˆ©ç”¨äº†é©¬å°”å¯å¤«æ€§</strong>ï¼Œæ‰€ä»¥TDé€šå¸¸åœ¨é©¬å°”å¯å¤«ç¯å¢ƒä¸­æ•ˆç‡æ›´é«˜ã€‚</p>
</blockquote>
<p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„å·®å¼‚å‘¢ï¼ŸMCæœ‰å®å®åœ¨åœ¨çš„æ¸¸æˆå›åˆæ•°æ®å•Šï¼Œè€ŒTDæ²¡æœ‰ï¼TDå¯¹åº”çš„æ˜¯æ— ç»ˆæ­¢çŠ¶æ€çš„æ¸¸æˆï¼Œè€Œä¸”å¾ˆå¯èƒ½åªæœ‰æ‰“äº†å‡ æ­¥æ¸¸æˆçš„æœ‰é™æ•°æ®å•Šã€‚</p>
<p>ï¼ˆ5ï¼‰å°ç»“ï¼š<br/>
ç›´è§‚ç†è§£å°±æ˜¯ï¼š<strong>TDç®—æ³•æ˜¯åœ¨æ²¡æœ‰æ¨¡å‹çš„æƒ…å†µä¸‹æ¥æ±‚è§£è´å°”æ›¼å…¬å¼</strong>ã€‚TD algorithm solves the Bellaman equation of a given policyã€‚</p>
<p>æ²¡æœ‰æ¨¡å‹å°±å¾—æœ‰æ•°æ®ï¼Œæ²¡æœ‰æ•°æ®å°±å¾—æœ‰æ¨¡å‹ï¼Œä¸ç„¶å°±æ²¡æ³•å­¦ï¼</p>
<p><strong>3ã€MCå’ŒTDçš„ä½¿ç”¨åœºæ™¯å¯¹æ¯”</strong><br/>
æ—¶åºå·®åˆ†æ˜¯ç°åœ¨å¾ˆå¤šå¼ºåŒ–å­¦ä¹ æ–¹æ³•çš„ä¾æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>ç°åœ¨å¾ˆå¤šå¼ºåŒ–å­¦ä¹ æ–¹æ³•æ˜¯ä¾æ®æ—¶åºå·®åˆ†æ¥åšçš„</strong>ã€‚å› ä¸ºTDåªè¦é‡‡é›†<strong>å½“ä¸‹åŠ¨ä½œçš„ç³»ç»Ÿå¥–åŠ±</strong>å’Œ<strong>ä¸‹ä¸€ä¸ªçŠ¶æ€çš„ä»¥å‰çš„ä»·å€¼å€¼</strong>å³å¯ï¼ŒTDå°±å¯ä»¥è¿­ä»£ä¸€ç»„<strong>æ–°çš„</strong>ç³»ç»ŸçŠ¶æ€ä»·å€¼äº†ã€‚è€ŒMCçš„è®¡ç®—<strong>ä¸ä»…</strong>éœ€è¦å½“ä¸‹åŠ¨ä½œçš„ç³»ç»Ÿå¥–åŠ±ï¼Œ<strong>è¿˜è¦</strong>å½“ä¸‹çŠ¶æ€ä»¥åçš„æ‰€æœ‰çŠ¶æ€çš„ç³»ç»Ÿå¥–åŠ±ã€‚å½“æˆ‘ä»¬æ— æ³•é‡‡é›†åˆ°å¾ˆå¤šåç»­çŠ¶æ€çš„ç³»ç»Ÿå¥–åŠ±æ—¶ï¼ŒMCç®—æ³•å°±æ— èƒ½ä¸ºåŠ›äº†ï¼Œæ­¤æ—¶TDç®—æ³•å°±å¯å ªå¤§ä»»ã€‚<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ef608bdb9d9400694a851a96216f1c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=Ae9sK7VydbUQdeecNKYkEdf4k%2FY%3D" alt="" loading="lazy"/>æ­¤å¤–ï¼š</p>
<p>ï¼ˆ1ï¼‰<strong>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒTDä¸€èˆ¬ä¼šæ¯”MCæ”¶æ•›çš„å¿«ä¸€äº›</strong>ã€‚<br/>
ï¼ˆ2ï¼‰<strong>Î±å¤§å°çš„è®¾ç½®ä¹Ÿæ˜¯å½±å“æ¨¡å‹æ”¶æ•›çš„é‡è¦å› ç´ </strong>ã€‚æœ‰æ—¶Î±è®¾ç½®å¾—ä¸åˆé€‚ï¼Œæ¨¡å‹å¯èƒ½éƒ½æ— æ³•æ”¶æ•›ã€‚</p>
<h3 data-id="heading-3">å››ã€å¼ºåŒ–å­¦ä¹ ä¸­çš„å‡ ä¸ªé‡è¦æ¦‚å¿µå’Œå¸¸è¯†</h3>
<p><strong>1ã€çœŸå®å€¼å’Œä¼°è®¡å€¼çš„è¡¨ç¤º</strong><br/>
åœ¨å¼ºåŒ–å­¦ä¹ é¢†åŸŸï¼Œäººä»¬ä¹ æƒ¯ç”¨ç¬¦å·væˆ–Væ¥è¡¨ç¤ºçŠ¶æ€ä»·å€¼(væ˜¯valueçš„é¦–å­—æ¯)ã€‚ä½†æ˜¯ä¸€èˆ¬ç”¨å°vè¡¨ç¤º"ç³»ç»Ÿä¸­çš„æ‰€æœ‰çŠ¶æ€çš„<strong>çœŸå®</strong>ä»·å€¼"ï¼Œè€Œå¤§Vè¡¨ç¤º"ç³»ç»Ÿä¸­çš„æ‰€æœ‰çŠ¶æ€çš„<strong>ä¼°è®¡</strong>ä»·å€¼"ã€‚æˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¸çŸ¥é“ä¸€ä¸ªç³»ç»Ÿä¸­çš„æ‰€æœ‰çŠ¶æ€çš„çœŸå®ä»·å€¼çš„ï¼Œå› æ­¤éœ€è¦â€œä¼°è®¡â€è¿™ä¸ªå€¼ã€‚</p>
<p><strong>2ã€æ–¹å·®å’Œåå·®</strong><br/>
åå·®å’Œæ–¹å·®æ˜¯æœºå™¨å­¦ä¹ ä¸­çš„ä¸€å¯¹å„¿é‡è¦æ¦‚å¿µï¼ŒæŒ‡çš„æ˜¯æ¨¡å‹åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šçš„è¡¨ç°ã€‚æˆ‘ä»¬çŸ¥é“è®­ç»ƒé›†éƒ½æ˜¯ä¸€äº›å·²ç»åˆ‡åˆ‡å®å®å‘ç”Ÿäº†çš„æ ·æœ¬æ•°æ®ï¼Œè€Œæµ‹è¯•é›†è¢«çœ‹ä½œæ˜¯ä»æ€»ä½“ä¸­æ–°æŠ½æ ·çš„æ•°æ®ã€‚ä¸€ä¸ªæ¨¡å‹å¦‚æœåœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°å¾ˆå¥½ï¼Œæµ‹è¯•é›†ä¸Šè¡¨ç°å¾ˆç³Ÿï¼Œæˆ‘ä»¬å°±è¯´è¿™ä¸ªæ¨¡å‹åå·®å°ä½†æ–¹å·®å¤§ï¼Œè¿‡æ‹Ÿåˆäº†ã€‚å¦‚æœä¸€ä¸ªæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°æ¯”è¾ƒå¥½ï¼Œæµ‹è¯•é›†ä¸Šè¡¨ç°ä¹Ÿå¯ä»¥ï¼Œé‚£æˆ‘ä»¬å°±è¯´è¿™ä¸ªæ¨¡å‹æ‹Ÿåˆå¾—æ¯”è¾ƒå¥½ã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šæ•…æ„ç‰ºç‰²ä¸€ç‚¹è®­ç»ƒé›†ä¸Šçš„æ•ˆæœï¼Œæ¥æå‡æµ‹è¯•é›†çš„æ•ˆæœï¼Œä¹Ÿå°±æ˜¯ç‰ºç‰²ä¸€ç‚¹æ¨¡å‹åå·®æ¥æå‡æ¨¡å‹æ–¹å·®ã€‚</p>
<p>å¼ºåŒ–å­¦ä¹ ä¸­ä¹Ÿå­˜åœ¨æ–¹å·®ä¸åå·®ï¼Œæ¯”å¦‚MCå’ŒTDå°±æ˜¯ä¸€ä¸ªæ–¹å·®ä¸åå·®çš„é—®é¢˜ï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c8113da904844588334779dfed65b64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=u7V0qyQdiHr1KP599ypoLAjz%2FZg%3D" alt="" loading="lazy"/>æ„æ€å°±æ˜¯Aå¤„å…¶å®æ˜¯æœ‰å¾ˆå¤šæ¡è½¨è¿¹çš„ï¼Œæ¯”å¦‚Aå¤„æœ‰100æ­¥ï¼Œæ¯æ­¥æœ‰5ä¸ªåŠ¨ä½œï¼Œé‚£å…¶å®Aåºåˆ—æ˜¯æœ‰5çš„100æ¬¡æ–¹æ¡çš„ã€‚æ‰€ä»¥ç”±Aè®¡ç®—çš„ç»“æœæ–¹å·®(variance)è‚¯å®šå¤§ã€‚</p>
<p>Bå¤„è™½ç„¶æ–¹å·®ä¸å¤§ï¼Œä½†åå·®(mean/expectation)æ˜¯bias(æœ‰å)çš„ï¼Œå› ä¸ºBå¤„æ˜¯æå¤§ä¾èµ–<strong>åˆå§‹ä¼°è®¡</strong>çš„ï¼Œå¦‚æœåˆå§‹ä¼°è®¡å°±æ˜¯ä¸å‡†ç¡®çš„å€¼ï¼Œé‚£Bå¤„çš„ä¼°è®¡å°±ä¹Ÿæ˜¯ä¸å‡†ç¡®çš„ã€‚å½“ç„¶ï¼Œå¦‚æœBå¤„æœ‰æ›´å¤šçš„æ•°æ®å‚ä¸ä¼°è®¡ï¼Œbiaså°±ä¼šæ…¢æ…¢å‡å°ï¼Œç›´åˆ°æœ€åå¯ä»¥æ”¶æ•›åˆ°ä¸€ä¸ªæ­£ç¡®çš„ä¼°è®¡å€¼ã€‚åŒç†ï¼ŒMCæ˜¯ä¸æ¶‰åŠåˆ°ä»»ä½•åˆå§‹å€¼çš„ï¼ŒMCæ±‚å‡ºçš„æœŸæœ›å°±ç­‰äºçœŸå®çš„state valueæˆ–action valueã€‚æ‰€ä»¥MCæ˜¯æ— åçš„ã€‚</p>
<p><strong>3ã€å°æ‰¹é‡ï¼šBatch MC\TD</strong><br/>
åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ¢¯åº¦ä¸‹é™ä¼˜åŒ–ç®—æ³•å°±å¸¸ç”¨å°æ‰¹é‡(batch)æ ·æœ¬æ¥è¿­ä»£æŸå¤±å‡½æ•°ï¼Œå…¶å¥½å¤„å’Œä¼˜ç‚¹è¿™é‡Œæˆ‘å°±ä¸å±•å¼€è¯´ï¼Œæ„Ÿå…´è¶£å¯ä»¥æŸ¥çœ‹æˆ‘ä¹‹å‰çš„æ·±åº¦å­¦ä¹ æ–‡ç« ã€‚</p>
<p>åœ¨å¼ºåŒ–å­¦ä¹ ä¸­åŒæ ·ä¹Ÿæœ‰batchè¿™ä¸ªæ¦‚å¿µçš„ï¼Œä½†å¼ºåŒ–å­¦ä¹ ä¸­çš„batchæ“ä½œç¨å¾®å¤æ‚ä¸€ç‚¹ï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a4b11b728cc45879dee3b4a132a5e0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=O0JZGnKmhGT0RuLD%2FptA6MUDfcU%3D" alt="" loading="lazy"/>æ³¨æ„ï¼šä¸Šé¢çš„Kæ¡åˆ†å¹•å¿…é¡»æ˜¯åŒä¸€ä¸ªç­–ç•¥ä¸‹çš„æ¸¸æˆåºåˆ—ï¼</p>
<p><strong>4ã€æ— æ¨¡å‹å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬èŒƒå¼</strong><br/>
å¼ºåŒ–å­¦ä¹ çš„æœ€ç»ˆç›®çš„æ˜¯å¯»æ‰¾æœ€ä¼˜ç­–ç•¥çš„ï¼Œå°±æ˜¯å¦‚ä½•è®©ä¸€ä¸ªagentä»å°ç™½é€æ¸æˆä¸ºé«˜æ‰‹çš„ã€‚è¿™ä¸ªç›®çš„ä¸€èˆ¬ç”±é¢„æµ‹+æ§åˆ¶æ¥è¾¾åˆ°ã€‚<br/>
æ¯”å¦‚ï¼Œåœ¨DPä¸­æˆ‘ä»¬æ˜¯é€šè¿‡ä¸¤æ­¥æ¥å¯»æ‰¾æœ€ä¼˜ç­–ç•¥çš„ï¼Œç¬¬ä¸€æ­¥æ˜¯æ±‚æ”¶æ•›çš„ä»·å€¼å‡½æ•°ï¼Œç¬¬äºŒæ­¥è´ªå©ªåŒ–çš„æ›´æ–°ç­–ç•¥ï¼Œç›´åˆ°å¾—åˆ°æœ€ä¼˜ç­–ç•¥ã€‚é‚£ç¬¬ä¸€æ­¥å°±æ˜¯<strong>é¢„æµ‹</strong>ï¼Œä¹Ÿå«<strong>è¯„ä¼°å’Œä¼˜åŒ–ä»·å€¼å‡½æ•°</strong>ã€‚ç¬¬äºŒæ­¥å°±æ˜¯<strong>æ§åˆ¶</strong>ï¼Œä¹Ÿå°±æ˜¯<strong>ç­–ç•¥æå‡</strong>ä»»åŠ¡ã€‚</p>
<p>æœ¬ç« çš„MC\TD\TD(Î»)éƒ½æ˜¯<strong>æ— æ¨¡å‹å­¦ä¹ </strong>ï¼Œä¹Ÿå«<strong>æ— æ¨¡å‹è¯„ä¼°</strong>ï¼Œéƒ½æ˜¯ç”¨äºè®¡ç®—<strong>ç­–ç•¥Î ä¸‹çš„ç³»ç»ŸçŠ¶æ€ä»·å€¼</strong>çš„ï¼Œä¹Ÿå°±æ˜¯è§£å†³é¢„æµ‹ä»»åŠ¡çš„ï¼Œåé¢ç´§æ¥ç€å°±éœ€è¦è¿›è¡Œ<strong>æ— æ¨¡å‹æ§åˆ¶</strong>ã€‚ä½†æ˜¯å¯¹äºéå®Œå¤‡çš„MDPé—®é¢˜ï¼Œæˆ‘ä»¬æ˜¯ä¸çŸ¥é“å„ä¸ªçŠ¶æ€ä¸‹çš„åŠ¨ä½œé›†åˆçš„ï¼Œä¹Ÿä¸çŸ¥é“çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œæ‰€ä»¥å°±æ— æ³•ç”¨åƒDPä¸­çš„è´ªå©ªåŒ–æ–¹å¼å¯»æ‰¾æœ€ä¼˜ç­–ç•¥ã€‚æ‰€ä»¥<strong>æ— æ¨¡å‹çš„æ§åˆ¶ä»»åŠ¡</strong>è¦å¤æ‚å¾ˆå¤šï¼Œä¸‹ä¸€ä¸ªç¯‡ç« æˆ‘ä»¬ä¸“é—¨å±•å¼€è¿™ä¸ªè¯é¢˜ã€‚</p>
<h3 data-id="heading-4">äº”ã€TD(Î»)</h3>
<p><strong>1ã€TD(Î»)æ˜¯ç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ</strong><br/>
TD(Î»)æ–¹æ³•å¯ä»¥çœ‹ä½œæ˜¯<strong>è’™ç‰¹å¡æ´›æ–¹æ³•å’Œæ—¶åºå·®åˆ†æ–¹æ³•çš„æ··åˆ</strong>ã€‚å› ä¸ºTD(0)æœ€å¤§çš„ç¼ºç‚¹æ˜¯åå·®å¤§ï¼ŒMCæœ€å¤§çš„ç¼ºç‚¹æ˜¯æ–¹å·®å¤§ï¼Œæ‰€ä»¥TD(Î»)èåˆäº†äºŒè€…ï¼Œæ—¢ç»§æ‰¿äº†MCçš„åå·®å°ä¼˜ç‚¹ï¼Œåˆç»§æ‰¿äº†TDçš„æ–¹å·®å°ä¼˜ç‚¹ã€‚</p>
<p><strong>2ã€TD(0)ï¼šnæ­¥TD</strong><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be96e7c2d877448da4b2c4449069efdf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=m3EkAePr9s48jcOlN8tiEwAMfAk%3D" alt="" loading="lazy"/>å‰é¢æˆ‘ä»¬å­¦çš„TDï¼Œå…¶å®åº”è¯¥å†™æˆTD(0)ï¼Œå› ä¸ºå®ƒè®¡ç®—çŠ¶æ€ä»·å€¼æ—¶ï¼Œç”¨çš„åºåˆ—æ ·æœ¬éƒ½æ˜¯æ¯”å¦‚èµ°1æ­¥çš„åºåˆ—ç‰‡æ®µï¼Œæˆ–è€…éƒ½æ˜¯èµ°2æ­¥çš„åºåˆ—ç‰‡æ®µï¼Œæˆ–è€…éƒ½æ˜¯èµ°3æ­¥çš„åºåˆ—ç‰‡æ®µï¼Œæˆ–è€…...ï¼Œæ‰€ä»¥å«TD(0)ã€‚ä¸Šå·¦å›¾ä¸­çš„"1æ­¥TD"ã€"2æ­¥TD"ã€"næ­¥TD"éƒ½å«TD(0)ã€‚</p>
<p><strong>3ã€TD(0)-&gt;TD(Î»)</strong><br/>
ä½†æ˜¯ï¼Œåœ¨å®é™…ä¸­ï¼Œæˆ‘ä»¬<strong>ä¸æ˜¯</strong>éå¾—åªé‡‡æ ·1æ­¥çš„æ ·æœ¬ç‰‡æ®µã€æˆ–è€…åªé‡‡æ ·2æ­¥çš„æ ·æœ¬ç‰‡æ®µï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥é‡‡æ ·<strong>éšæ„æ­¥æ•°</strong>çš„åºåˆ—ç‰‡æ®µçš„ï¼Œå½“ç„¶æœ€å¤§æ­¥æ•°å°±æ˜¯MCçš„æ­¥æ•°ï¼šç›´åˆ°æ¸¸æˆç»“æŸã€‚</p>
<p>å½“TDç®—æ³•åœ¨è®¡ç®—çŠ¶æ€ä»·å€¼æ—¶ï¼Œç”¨çš„æ ·æœ¬æ˜¯<strong>éšæ„æ­¥æ•°</strong>çš„åºåˆ—ç‰‡æ®µã€å¹¶ä¸”è¿™äº›ä¸åŒæ­¥é•¿ç‰‡æ®µä¹‹é—´çš„<strong>æƒé‡</strong>æŒ‰(1-Î»)ä¹˜ä»¥Î»çš„n-1æ¬¡æ–¹(Î»åœ¨0-1ä¹‹é—´)æ¥åˆ†é…çš„æƒé‡çš„ï¼Œç”¨æ­¤æ—¶è®¡ç®—å‡ºæ¥çš„Gtï¼Œæ¥æ›´æ–°è¿­ä»£çŠ¶æ€ä»·å€¼æ—¶ï¼Œæˆ‘ä»¬å«TD(Î»)ï¼Œå¦‚ä¸‹é¢å³å›¾æ‰€ç¤ºï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/963991e5f9294942a5c8bb68df2c7c21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=mCP2GYgkJTgCiNHRQ%2FqUrrIuTFc%3D" alt="" loading="lazy"/>ç”±äºTDç®—æ³•ä¸»è¦åº”ç”¨äºæ— ç»ˆæ­¢çŠ¶æ€çš„åœºæ™¯ä¸­ï¼Œæ¯”å¦‚ç»ˆæ­¢çŠ¶æ€çš„æ¸¸æˆï¼Œæ‰€ä»¥æ­¥æ•°næ˜¯è¶‹å‘æ— ç©·å¤§çš„ï¼Œæ‰€ä»¥ä¸Šå›¾ç»¿æ¡†ä¸­çš„æƒé‡åˆ†é…æ–¹å¼ä¹Ÿæ¯”è¾ƒåˆç†ã€‚æ‰“æ¸¸æˆçš„æ­¥æ•°è¶Šé•¿ï¼Œæƒé‡å°±è¶Šä½ã€‚è¿™æ˜¯åˆç†çš„ã€‚å› ä¸ºæ­¤æ—¶TDå°±åå¡ŒæˆMCäº†ï¼Œå°±æ˜¯æ‰€æœ‰çš„å¯èƒ½æ€§éƒ½åå¡Œäº†ï¼Œæ‰€ä»¥è®¡ç®—çš„ä»·å€¼è™½ç„¶åå·®å°ï¼Œä½†æ–¹å·®å¤§ã€‚ä¸‹å›¾æ˜¯ç»¿æ¡†æƒé‡çš„è¡°å‡å›¾ï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/330788647dd84ac181e430dea89410b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6d6LSd5YS_5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863463&amp;x-signature=1yMKOmkegw2egJ0g9lyoswt3Blg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">å…­ã€DPã€MCã€TDã€TD(Î»)å¯¹æ¯”æ€»ç»“1ã€MCå’ŒTDéƒ½éœ€è¦é‡‡æ ·ï¼ŒDPä¸éœ€è¦é‡‡æ ·ã€‚</h3>
<p>2ã€DPä¸ç”¨é‡‡æ ·ï¼Œå› ä¸ºèƒ½ç”¨DPè§£å†³é—®é¢˜ï¼Œè¯´æ˜è¿™ä¸ªé—®é¢˜æ˜¯ä¸€ä¸ªå®Œå¤‡çš„MDPé—®é¢˜ï¼Œå®Œå¤‡çš„MDPæ˜¯çŸ¥é“ç³»ç»Ÿçš„çŠ¶æ€è½¬ç§»çŸ©é˜µã€ç³»ç»Ÿå¥–åŠ±ã€ä»¥åŠæ¯ä¸ªçŠ¶æ€ä¸‹çš„åŠ¨ä½œé›†åˆçš„ã€‚æ‰€ä»¥DP<strong>æ ¹æ®æ¦‚ç‡</strong>å°±èƒ½<strong>å‡†ç¡®</strong>æ±‚å‡º<strong>æœŸæœ›ä»·å€¼</strong>ï¼Œå‹æ ¹ä¸éœ€è¦é‡‡æ ·ã€‚</p>
<p>3ã€MCæ˜¯è¦å®å®åœ¨åœ¨æ‰“å‡ºä¸€å¹•æ¸¸æˆæ•°æ®ï¼Œå°±æ˜¯éœ€è¦é‡‡æ ·ä¸€æ¡å®Œæ•´çš„åºåˆ—ï¼Œç„¶åå†è®¡ç®—çŠ¶æ€ä»·å€¼ã€‚è¿™å¯ä»¥çœ‹ä½œæ˜¯æ·±åº¦ä¼˜å…ˆã€‚</p>
<p>4ã€TD(0)æ˜¯ä¸ç”¨æ‰“å®Œæ¸¸æˆï¼Œæ‰“å®Œ1æ­¥ä¹Ÿå¯ä»¥ç®—çŠ¶æ€ä»·å€¼äº†ã€‚ä¹Ÿå°±æ˜¯TD(0)åªéœ€è¦é‡‡æ ·åºåˆ—ç‰‡æ®µå°±å¯ä»¥è®¡ç®—äº†ã€‚</p>
<p>5ã€TD(Î»)æ˜¯å…¼é¡¾äº†æ·±åº¦çš„å®½åº¦æ¢ç´¢ï¼Œæ‰€ä»¥ä¹Ÿå«æš´åŠ›æœç´¢ã€æˆ–è€…å«ç©·ä¸¾æ³•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Exceptionå¼‚å¸¸æ¶æ„è®¾è®¡ï¼šå¼‚å¸¸åˆ†ç±»ï¼ˆ02ï¼‰]]></title>    <link>https://juejin.cn/post/7602901565025550345</link>    <guid>https://juejin.cn/post/7602901565025550345</guid>    <pubDate>2026-02-05T01:06:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901565025550345" data-draft-id="7602834985902293042" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Exceptionå¼‚å¸¸æ¶æ„è®¾è®¡ï¼šå¼‚å¸¸åˆ†ç±»ï¼ˆ02ï¼‰"/> <meta itemprop="keywords" content="è¿ç»´,æ¶æ„,è‡ªåŠ¨åŒ–è¿ç»´"/> <meta itemprop="datePublished" content="2026-02-05T01:06:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è€å®å·´äº¤çš„éº»åŒª"/> <meta itemprop="url" content="https://juejin.cn/user/4218156332615384"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Exceptionå¼‚å¸¸æ¶æ„è®¾è®¡ï¼šå¼‚å¸¸åˆ†ç±»ï¼ˆ02ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4218156332615384/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è€å®å·´äº¤çš„éº»åŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:06:40.000Z" title="Thu Feb 05 2026 01:06:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto;border:3px solid rgba(62,175,124,.2)}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-weight:700;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:6px;border:2px solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c}.markdown-body a:active,.markdown-body a:hover{border-bottom:1.5px solid #3eaf7c}.markdown-body a:before{content:"â‡²"}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(62,175,124,.2)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:.5rem solid;border-color:#42b983;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none}.markdown-body ul li:before{content:"â€¢";margin-right:4px;color:#3eaf7c}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿå’Œå¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¼‚å¸¸ä¸å†æ˜¯å¶ç„¶çš„"æ„å¤–"ï¼Œè€Œæ˜¯ç³»ç»Ÿè¿è¡Œçš„å¸¸æ€ã€‚éšç€ç³»ç»Ÿå¤æ‚åº¦çš„æå‡ï¼Œå¼‚å¸¸çš„ç§ç±»å’Œæ•°é‡å‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œå¦‚ä½•å¯¹å¼‚å¸¸è¿›è¡Œç§‘å­¦çš„åˆ†ç±»å’Œç®¡ç†ï¼Œæˆä¸ºä¿éšœç³»ç»Ÿç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§çš„å…³é”®ç¯èŠ‚ã€‚</p>
<p>å¼‚å¸¸åˆ†ç±»æ˜¯å¼‚å¸¸æ¶æ„è®¾è®¡çš„åŸºç¡€ï¼Œå®ƒç›´æ¥å½±å“ç€å¼‚å¸¸å¤„ç†ç­–ç•¥çš„åˆ¶å®šã€ç›‘æ§å‘Šè­¦çš„é…ç½®ä»¥åŠæ•…éšœè¯Šæ–­çš„æ•ˆç‡ã€‚ä¸€ä¸ªæ¸…æ™°ã€åˆç†çš„å¼‚å¸¸åˆ†ç±»ä½“ç³»ï¼Œèƒ½å¤Ÿè®©å¼€å‘å›¢é˜Ÿå¿«é€Ÿå®šä½é—®é¢˜ï¼Œå¸®åŠ©è¿ç»´äººå‘˜å‡†ç¡®åˆ¤æ–­æ•…éšœç­‰çº§ï¼Œä½¿äº§å“å›¢é˜Ÿæ›´å¥½åœ°ç†è§£ä¸šåŠ¡å½±å“ã€‚</p>
<h2 data-id="heading-0">åˆ†ç±»ç»´åº¦</h2>
<p>ä»å®è·µç»éªŒæ¥çœ‹ï¼Œä¼˜ç§€çš„å¼‚å¸¸åˆ†ç±»åº”å…·å¤‡ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<ul>
<li><strong>æ˜ç¡®æ€§</strong>ï¼šæ¯ç§å¼‚å¸¸ç±»å‹éƒ½æœ‰æ¸…æ™°çš„å®šä¹‰å’Œè¾¹ç•Œ</li>
<li><strong>å®ç”¨æ€§</strong>ï¼šåˆ†ç±»æ ‡å‡†ä¸å®é™…ä¸šåŠ¡åœºæ™¯ç´§å¯†ç»“åˆ</li>
<li><strong>å¯æ“ä½œæ€§</strong>ï¼šä¾¿äºè‡ªåŠ¨åŒ–å¤„ç†å’Œäººå·¥å¹²é¢„</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šèƒ½å¤Ÿé€‚åº”ä¸šåŠ¡å‘å±•å’ŒæŠ€æœ¯æ¼”è¿›</li>
</ul>
<p>å¼‚å¸¸åˆ†ç±»å¯ä»ä»¥ä¸‹å¤šç»´åº¦åˆ‡å…¥ï¼š</p>
<p><strong>æ ¸å¿ƒè´£ä»»ç»´åº¦</strong></p>
<ul>
<li><strong>æ¥æº</strong>ï¼šç³»ç»Ÿå¼‚å¸¸ï¼ˆå¤–éƒ¨/åŸºç¡€è®¾æ–½ï¼‰ vs ä¸šåŠ¡å¼‚å¸¸ï¼ˆå†…éƒ¨è§„åˆ™ï¼‰</li>
<li><strong>è´£ä»»æ–¹</strong>ï¼šå®¢æˆ·ç«¯é”™è¯¯ï¼ˆ4xxï¼‰ vs æœåŠ¡å™¨é”™è¯¯ï¼ˆ5xxï¼‰</li>
</ul>
<p><strong>è¿ç»´ç›‘æ§ç»´åº¦</strong></p>
<ul>
<li><strong>ä¸¥é‡ç¨‹åº¦</strong>ï¼šè‡´å‘½/é”™è¯¯/è­¦å‘Š/ä¿¡æ¯</li>
<li><strong>å¯æ¢å¤æ€§</strong>ï¼šå¯é‡è¯•/ä¸å¯é‡è¯•/å¯é™çº§</li>
<li><strong>å½±å“èŒƒå›´</strong>ï¼šç”¨æˆ·/ç§Ÿæˆ·/æœåŠ¡/ç³»ç»Ÿçº§</li>
</ul>
<p><strong>æŠ€æœ¯æ¶æ„ç»´åº¦</strong></p>
<ul>
<li><strong>ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ</strong>ï¼šå¯åŠ¨/è¿è¡Œ/å…³é—­</li>
<li><strong>æ•°æ®æµé˜¶æ®µ</strong>ï¼šè¾“å…¥/å¤„ç†/è¾“å‡º/å­˜å‚¨</li>
<li><strong>æ¶æ„å±‚æ¬¡</strong>ï¼šè¡¨ç°å±‚/åº”ç”¨å±‚/é¢†åŸŸå±‚/åŸºç¡€è®¾æ–½å±‚</li>
</ul>
<p><strong>å•†ä¸šè€ƒé‡ç»´åº¦</strong></p>
<ul>
<li><strong>SLAå½±å“</strong>ï¼šè¿ä¾‹/é£é™©/æ— å½±å“</li>
</ul>
<p>åˆ†ç±»ç›®çš„æ˜¯æŒ‡å¯¼å¤„ç†ç­–ç•¥ï¼Œè€Œéè¿‡åº¦è®¾è®¡ã€‚å¯¹äºç»å¤§å¤šæ•°åŸºç¡€é¡¹ç›®ï¼ŒæŒ‰ç…§<strong>æ¥æº+è´£ä»»æ–¹</strong>æ¥è¿›è¡Œåˆ†ç±»æ˜¯åˆé€‚çš„ï¼Œæ˜¯è¶³å¤Ÿæ»¡è¶³ä¸šåŠ¡éœ€æ±‚çš„ã€‚</p>
<hr/>
<p>ç‰¹åˆ«åœ°ï¼Œå¯¹äº<strong>æ¥æº</strong>ï¼Œä»å¼€å‘è€…è§†è§’æ¥åˆ’åˆ†ï¼š</p>
<ul>
<li>å¹³å°å¼‚å¸¸ï¼ˆå¤–éƒ¨å¼‚å¸¸ã€å†…ç½®å¼‚å¸¸ï¼‰ï¼šç¼–ç¨‹è¯­è¨€ã€å¼€å‘æ¡†æ¶ã€ä¸­é—´ä»¶ã€ç¬¬ä¸‰æ–¹åº“ã€è¿œç¨‹è°ƒç”¨ç­‰æŠ›å‡ºçš„å¼‚å¸¸ï¼Œç”±å…ƒå¼€å‘è€…å®šä¹‰ã€‚</li>
<li>åº”ç”¨å¼‚å¸¸ï¼šç”±ä¸šåŠ¡å¼€å‘è€…å®šä¹‰çš„å¼‚å¸¸ã€‚</li>
</ul>
<blockquote>
<p>å…ƒå¼€å‘è€…ï¼ŒæŒ‡çš„æ˜¯ä¸ºå¼€å‘è€…æœåŠ¡çš„å¼€å‘è€…ã€‚</p>
</blockquote>
<h3 data-id="heading-1">å¹³å°å¼‚å¸¸</h3>
<p>ç”±ç¼–ç¨‹è¯­è¨€ã€è¿è¡Œæ—¶ã€æ¡†æ¶ã€ä¸­é—´ä»¶ç­‰"å…ƒå¼€å‘è€…"å®šä¹‰çš„å¼‚å¸¸ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 1. è¯­è¨€è¿è¡Œæ—¶</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">language_runtime</span>():
    <span class="hljs-comment"># å†…å­˜ã€ç±»å‹ã€è¿ç®—ç­‰åŸºç¡€é”™è¯¯</span>
    <span class="hljs-keyword">try</span>:
        x = <span class="hljs-number">1</span> / <span class="hljs-number">0</span>                    <span class="hljs-comment"># ZeroDivisionError</span>
        y = <span class="hljs-built_in">int</span>(<span class="hljs-string">"abc"</span>)               <span class="hljs-comment"># ValueError</span>
        z = {}[<span class="hljs-string">"nonexistent"</span>]        <span class="hljs-comment"># KeyError</span>
    <span class="hljs-keyword">except</span> (ZeroDivisionError, ValueError, KeyError) <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯­è¨€è¿è¡Œæ—¶å¼‚å¸¸: <span class="hljs-subst">{<span class="hljs-built_in">type</span>(e).__name__}</span>"</span>)

<span class="hljs-comment"># 2. æ“ä½œç³»ç»Ÿ/æ–‡ä»¶ç³»ç»Ÿ</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">os_filesystem</span>():
    <span class="hljs-comment"># æ–‡ä»¶ã€è¿›ç¨‹ã€æƒé™ç­‰OSç›¸å…³é”™è¯¯</span>
    <span class="hljs-keyword">import</span> os
    <span class="hljs-keyword">try</span>:
        os.remove(<span class="hljs-string">"/nonexistent.txt"</span>) <span class="hljs-comment"># FileNotFoundError</span>
        <span class="hljs-keyword">import</span> subprocess
        subprocess.run([<span class="hljs-string">"invalid"</span>])   <span class="hljs-comment"># FileNotFoundError</span>
    <span class="hljs-keyword">except</span> OSError <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ“ä½œç³»ç»Ÿå¼‚å¸¸: <span class="hljs-subst">{e}</span>"</span>)

<span class="hljs-comment"># 3. ç½‘ç»œ/å¤–éƒ¨æœåŠ¡ï¼ŒåŒ…æ‹¬è¿œç¨‹å…³ç³»è°ƒç”¨RPC</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">network_external</span>():
    <span class="hljs-comment"># ç½‘ç»œè¿æ¥ã€HTTPè¯·æ±‚ç­‰</span>
    <span class="hljs-keyword">import</span> requests
    <span class="hljs-keyword">try</span>:
        response = requests.get(<span class="hljs-string">"http://invalid"</span>, timeout=<span class="hljs-number">1</span>)
    <span class="hljs-keyword">except</span> requests.exceptions.ConnectionError <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç½‘ç»œå¼‚å¸¸: <span class="hljs-subst">{e}</span>"</span>)
    <span class="hljs-keyword">except</span> requests.exceptions.Timeout <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¶…æ—¶å¼‚å¸¸: <span class="hljs-subst">{e}</span>"</span>)

<span class="hljs-comment"># 4. æ•°æ®åº“/ä¸­é—´ä»¶</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">database_middleware</span>():
    <span class="hljs-comment"># æ•°æ®åº“è¿æ¥ã€æŸ¥è¯¢ã€äº‹åŠ¡ç­‰</span>
    <span class="hljs-keyword">import</span> sqlite3
    <span class="hljs-keyword">try</span>:
        conn = sqlite3.connect(<span class="hljs-string">":memory:"</span>)
        conn.execute(<span class="hljs-string">"INVALID SQL"</span>)   <span class="hljs-comment"># sqlite3.OperationalError</span>
    <span class="hljs-keyword">except</span> sqlite3.Error <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ•°æ®åº“å¼‚å¸¸: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<p>å¼€å‘è€…ä¸éœ€è¦å®šä¹‰å¹³å°å¼‚å¸¸ï¼Œä½†éœ€è¦å¯¹å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œåç»­ç³»åˆ—æ–‡ç« ä¸­å†è¯¦ç»†æè¿°å¼‚å¸¸å¤„ç†ã€‚</p>
<h3 data-id="heading-2">åº”ç”¨å¼‚å¸¸</h3>
<p>åˆç§°ä¸ºè‡ªå®šä¹‰å¼‚å¸¸ï¼Œç”±ä¸šåŠ¡å¼€å‘è€…ä¸ºäº†æ»¡è¶³ç‰¹å®šä¸šåŠ¡éœ€æ±‚è€Œåˆ›å»ºçš„å¼‚å¸¸ï¼Œåæ˜ ä¸šåŠ¡è§„åˆ™ã€æµç¨‹é™åˆ¶å’Œé¢†åŸŸé€»è¾‘ï¼Œç»§æ‰¿<code>Exception</code>ç±»åˆ›å»ºæ–°ç±»<code>class AppException(Exception)</code>ã€‚åº”ç”¨å¼‚å¸¸çš„æ ¸å¿ƒç‰¹å¾ï¼š</p>
<ul>
<li><strong>ä¸šåŠ¡è¯­ä¹‰æ€§</strong>ï¼šå¼‚å¸¸åç§°å’Œæ¶ˆæ¯åæ˜ ä¸šåŠ¡æ¦‚å¿µï¼Œå¦‚ï¼š<code>InsufficientFundsException</code>ï¼ˆä½™é¢ä¸è¶³ï¼‰</li>
<li><strong>å®Œå…¨å¯æ§</strong>ï¼šå¼€å‘è€…å†³å®šä½•æ—¶æŠ›å‡ºã€æŠ›å‡ºä»€ä¹ˆï¼Œå¯ä»¥æ·»åŠ ä»»ä½•ä¸šåŠ¡ç›¸å…³å±æ€§</li>
<li><strong>å±‚æ¬¡ç»“æ„åŒ–</strong>ï¼šå¯ä»¥å»ºç«‹æœ‰æ„ä¹‰çš„ç»§æ‰¿ä½“ç³»ï¼Œä¾¿äºåˆ†ç±»å¤„ç†å’Œç›‘æ§</li>
<li><strong>ä¸»åŠ¨è®¾è®¡</strong>ï¼šä½œä¸ºä¸šåŠ¡é€»è¾‘çš„ä¸€éƒ¨åˆ†ï¼Œæå‰è®¾è®¡å¼‚å¸¸ç±»å‹å’Œåœºæ™¯</li>
</ul>
<p>åŸºäº<strong>é˜²å¾¡æ€§ç¼–ç¨‹ã€Fail-Fastã€ç”¨æˆ·å‹å¥½ã€å¯è§‚æµ‹æ€§</strong>å››å¤§æ ¸å¿ƒåŸåˆ™ï¼Œå°†è‡ªå®šä¹‰å¼‚å¸¸ç»†åˆ†ä¸º<strong>å®¢æˆ·ç«¯å¼‚å¸¸ã€ä¸šåŠ¡å¼‚å¸¸ã€æœåŠ¡ç«¯å¼‚å¸¸</strong>ä¸‰å±‚æ¶æ„ï¼Œæ˜¯å½“å‰ä¼ä¸šçº§åº”ç”¨å¼€å‘ä¸­<strong>æˆç†Ÿä¸”åˆç†çš„åˆ†å±‚å¼‚å¸¸æ²»ç†æ–¹æ¡ˆ</strong>ï¼Œç›¸æ¯”å•ä¸€è‡ªå®šä¹‰å¼‚å¸¸æˆ–åŸç”Ÿå¼‚å¸¸æ··ç”¨çš„æ¨¡å¼ï¼Œå…·å¤‡æ˜¾è‘—çš„å·¥ç¨‹åŒ–ä¼˜åŠ¿ã€‚</p>
<h4 data-id="heading-3">å®¢æˆ·ç«¯å¼‚å¸¸ 4xx</h4>
<p>å®¢æˆ·ç«¯å¼‚å¸¸æ˜¯ç”±<strong>è°ƒç”¨æ–¹</strong>ï¼ˆå‰ç«¯ç”¨æˆ·ã€ç¬¬ä¸‰æ–¹æœåŠ¡ã€å†…éƒ¨è°ƒç”¨æ–¹ï¼‰çš„è¡Œä¸ºæˆ–è¾“å…¥ä¸ç¬¦åˆæœåŠ¡çº¦å®šè€Œå¼•å‘çš„å¼‚å¸¸ï¼ŒæœåŠ¡ç«¯æœ¬èº«æ— ä»»ä½•æ•…éšœï¼Œè´£ä»»å®Œå…¨åœ¨è°ƒç”¨æ–¹ã€‚</p>
<p><strong>å…¸å‹åœºæ™¯</strong></p>
<ul>
<li>è¯·æ±‚å‚æ•°é”™è¯¯ï¼šå‚æ•°ç¼ºå¤±ã€å‚æ•°ç±»å‹ä¸åŒ¹é…ã€å‚æ•°æ ¼å¼éæ³•ï¼ˆå¦‚æ‰‹æœºå·æ ¼å¼é”™è¯¯ã€é‚®ç®±æ ¼å¼é”™è¯¯ã€IDä¸ºéæ•°å­—ï¼‰</li>
<li>è¯·æ±‚æƒé™ä¸è¶³ï¼šæœªç™»å½•ã€ç™»å½•è¿‡æœŸã€æ— æ¥å£è®¿é—®æƒé™ã€æ— èµ„æºæ“ä½œæƒé™</li>
<li>è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼šè®¿é—®çš„æ¥å£è·¯å¾„é”™è¯¯ã€è¯·æ±‚çš„æ–‡ä»¶/æ•°æ®IDä¸å­˜åœ¨</li>
<li>è¯·æ±‚æ–¹å¼é”™è¯¯ï¼šä½¿ç”¨GETè¯·æ±‚è°ƒç”¨ä»…æ”¯æŒPOSTçš„æ¥å£ã€è¯·æ±‚å¤´ç¼ºå¤±å¿…è¦å­—æ®µ</li>
<li>è°ƒç”¨é¢‘ç‡è¶…é™ï¼šè§¦å‘æ¥å£é™æµã€é˜²åˆ·è§„åˆ™</li>
</ul>
<h4 data-id="heading-4">ä¸šåŠ¡å¼‚å¸¸ 299</h4>
<p>ä¸šåŠ¡å¼‚å¸¸æ˜¯<strong>åœ¨æœåŠ¡ç«¯é€»è¾‘æ­£å¸¸æ‰§è¡Œã€è¯·æ±‚å‚æ•°åˆæ³•çš„å‰æä¸‹ï¼Œå› ä¸šåŠ¡è§„åˆ™ä¸æ»¡è¶³ã€ä¸šåŠ¡æµç¨‹æ— æ³•ç»§ç»­æ¨è¿›</strong>è€Œå¼•å‘çš„å¼‚å¸¸ï¼Œå±äºä¸šåŠ¡å±‚é¢çš„é¢„æœŸæ€§é˜»æ–­ï¼Œè€Œéç³»ç»Ÿæ•…éšœã€‚ä¸šåŠ¡å¼‚å¸¸å¯ä»¥å½’å±äºæ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘ï¼Œå› æ­¤å¯å°†å…¶åˆ’åˆ†åˆ°çŠ¶æ€ç 2xxåºåˆ—ï¼Œæˆ–è€…è‡ªè¡Œå®šä¹‰ä¸€ä¸ªç‰¹å®šå€¼æˆ–åŒºé—´å€¼ï¼Œä¾¿äºè¿›è¡Œå¼‚å¸¸å¤„ç†ã€‚</p>
<p><strong>å…¸å‹åœºæ™¯</strong></p>
<ul>
<li>ä¸šåŠ¡è§„åˆ™æ ¡éªŒï¼šè´¦æˆ·ä½™é¢ä¸è¶³ã€å•†å“åº“å­˜ä¸è¶³ã€ç”¨æˆ·å·²å­˜åœ¨ã€è®¢å•çŠ¶æ€ä¸æ”¯æŒå½“å‰æ“ä½œã€éªŒè¯ç é”™è¯¯</li>
<li>ä¸šåŠ¡æµç¨‹é˜»æ–­ï¼šé‡å¤æäº¤è®¢å•ã€æœªå®åè®¤è¯æ— æ³•å‘èµ·æç°ã€å•†å“å·²ä¸‹æ¶æ— æ³•è´­ä¹°</li>
<li>ä¸šåŠ¡é€»è¾‘é™åˆ¶ï¼šè½¬è´¦é‡‘é¢è¶…å‡ºå•æ—¥é™é¢ã€ç”¨æˆ·è´¦å·å·²å†»ç»“</li>
</ul>
<h4 data-id="heading-5">æœåŠ¡ç«¯å¼‚å¸¸ 5XX</h4>
<p>æœåŠ¡ç«¯å¼‚å¸¸æ˜¯<strong>ç”±æœåŠ¡è‡ªèº«çš„ä»£ç ç¼ºé™·ã€åŸºç¡€è®¾æ–½æ•…éšœã€ä¾èµ–æœåŠ¡ä¸å¯ç”¨</strong>å¼•å‘çš„å¼‚å¸¸ï¼Œè´£ä»»å®Œå…¨åœ¨æœåŠ¡æä¾›æ–¹ï¼Œå±äºéé¢„æœŸçš„ç³»ç»Ÿçº§æ•…éšœã€‚</p>
<p><strong>å…¸å‹åœºæ™¯</strong></p>
<ul>
<li>ä»£ç é€»è¾‘é”™è¯¯ï¼šç©ºæŒ‡é’ˆå¼‚å¸¸ã€æ•°ç»„è¶Šç•Œã€ç±»å‹è½¬æ¢å¼‚å¸¸ã€æ­»å¾ªç¯ã€ç®—æ³•é€»è¾‘bug</li>
<li>åŸºç¡€è®¾æ–½æ•…éšœï¼šæ•°æ®åº“è¿æ¥å¤±è´¥ã€Rediså®•æœºã€MQæ¶ˆæ¯å‘é€å¤±è´¥ã€ç£ç›˜ç©ºé—´ä¸è¶³</li>
<li>ä¾èµ–æœåŠ¡å¼‚å¸¸ï¼šè°ƒç”¨ç¬¬ä¸‰æ–¹æ¥å£è¶…æ—¶ã€å†…éƒ¨å¾®æœåŠ¡è°ƒç”¨å¤±è´¥ã€ç†”æ–­é™çº§è§¦å‘</li>
<li>èµ„æºè€—å°½ï¼šçº¿ç¨‹æ± è€—å°½ã€å†…å­˜æº¢å‡ºã€æ–‡ä»¶å¥æŸ„ä¸è¶³</li>
</ul>
<h4 data-id="heading-6">æœªçŸ¥å¼‚å¸¸</h4>
<p>æœªçŸ¥å¼‚å¸¸æ˜¯å¼‚å¸¸æ²»ç†çš„é‡ç‚¹ï¼Œå› ä¸ºå®ƒä»£è¡¨äº†ç³»ç»Ÿä¸­å°šæœªè¢«å……åˆ†ç†è§£å’Œå¤„ç†çš„æ½œåœ¨é£é™©ã€‚è¿™ç±»å¼‚å¸¸é€šå¸¸åœ¨å¼€å‘é˜¶æ®µæœªèƒ½é¢„è§ï¼Œä½†åœ¨è¿è¡Œæ—¶å´å¯èƒ½å‡ºç°ï¼Œå¯¹ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§æ„æˆæŒ‘æˆ˜ã€‚æœªçŸ¥å¼‚å¸¸åº”å½“å½’ç±»åˆ°æœåŠ¡ç«¯å¼‚å¸¸ï¼ˆ5XXç³»åˆ—ï¼‰ä¸­ï¼Œä½œä¸ºServerExceptionçš„å­ç±»UnknownExceptionè¿›è¡Œä¸“é—¨å¤„ç†ã€‚</p>
<p><strong>å…¸å‹åœºæ™¯</strong>ï¼š</p>
<ul>
<li>ç¬¬ä¸‰æ–¹åº“å‡çº§å¼•å…¥çš„æ–°å¼‚å¸¸ç±»å‹</li>
<li>ç³»ç»Ÿç¯å¢ƒå˜åŒ–å¯¼è‡´çš„å¼‚å¸¸ï¼ˆå¦‚æ–°ç‰ˆæœ¬æ“ä½œç³»ç»ŸAPIå˜æ›´ï¼‰</li>
<li>ç¡¬ä»¶æ•…éšœå¯¼è‡´çš„åº•å±‚å¼‚å¸¸</li>
<li>æœªå……åˆ†æµ‹è¯•çš„è¾¹ç¼˜æƒ…å†µ</li>
<li>ä¾èµ–æœåŠ¡çš„æœªé¢„æœŸè¡Œä¸ºå˜åŒ–</li>
</ul>
<p><strong>å¤„ç†åŸåˆ™</strong>ï¼š</p>
<ul>
<li>ç»Ÿä¸€å½’ç±»åˆ°æœåŠ¡ç«¯å¼‚å¸¸ï¼Œè¿”å›5xxçŠ¶æ€ç </li>
<li>è®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå †æ ˆè·Ÿè¸ªï¼Œä¾¿äºåç»­åˆ†æ</li>
<li>è§¦å‘å‘Šè­¦ï¼Œé€šçŸ¥å¼€å‘å›¢é˜Ÿå…³æ³¨</li>
<li>è®¾ç½®å…œåº•æœºåˆ¶ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§</li>
<li>å»ºç«‹åé¦ˆæœºåˆ¶ï¼Œå°†æœªçŸ¥å¼‚å¸¸è½¬åŒ–ä¸ºå·²çŸ¥å¼‚å¸¸</li>
</ul>
<p><strong>åœ¨å¼‚å¸¸æ²»ç†ä¸­çš„é‡è¦æ€§</strong>ï¼š</p>
<ul>
<li><strong>é£é™©è¯†åˆ«</strong>ï¼šæœªçŸ¥å¼‚å¸¸æ˜¯ç³»ç»Ÿæ½œåœ¨é£é™©çš„æŒ‡ç¤ºå™¨ï¼Œå¸®åŠ©å›¢é˜Ÿå‘ç°ç³»ç»Ÿä¸­çš„è–„å¼±ç¯èŠ‚</li>
<li><strong>æŒç»­æ”¹è¿›</strong>ï¼šé€šè¿‡å¯¹æœªçŸ¥å¼‚å¸¸çš„åˆ†æå’Œå¤„ç†ï¼Œä¸æ–­å®Œå–„å¼‚å¸¸å¤„ç†ç­–ç•¥</li>
<li><strong>ç³»ç»ŸéŸ§æ€§</strong>ï¼šè‰¯å¥½çš„æœªçŸ¥å¼‚å¸¸å¤„ç†æœºåˆ¶èƒ½å¤Ÿæå‡ç³»ç»Ÿçš„å®¹é”™èƒ½åŠ›å’Œæ¢å¤èƒ½åŠ›</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šæœªçŸ¥å¼‚å¸¸çš„å‡ºç°é¢‘ç‡å’Œæ¨¡å¼æ˜¯é‡è¦çš„ç³»ç»Ÿå¥åº·æŒ‡æ ‡</li>
</ul>
<p>åœ¨å¼‚å¸¸å¤„ç†å®è·µä¸­ï¼Œè®¾ç½®é€šç”¨å¼‚å¸¸å¤„ç†å™¨ï¼Œå°†æ‰€æœ‰æœªæ˜ç¡®å¤„ç†çš„å¼‚å¸¸è½¬æ¢ä¸ºUnknownExceptionï¼Œé¿å…æ•æ„Ÿä¿¡æ¯æ³„éœ²ç»™å®¢æˆ·ç«¯ã€‚åŒæ—¶ï¼Œåº”å»ºç«‹<strong>å¼‚å¸¸æ²»ç†</strong>æµç¨‹ï¼Œå®šæœŸåˆ†æUnknownExceptionçš„ç±»å‹å’Œé¢‘ç‡ï¼Œé€æ­¥å°†å…¶è½¬åŒ–ä¸ºå…·ä½“çš„ã€å¯å¤„ç†çš„å¼‚å¸¸ç±»å‹ï¼Œä»è€Œä¸æ–­ä¼˜åŒ–å¼‚å¸¸æ²»ç†ä½“ç³»ã€‚</p>
<h3 data-id="heading-7">å¼‚å¸¸åˆ†ç±»ä¸¾ä¾‹</h3>
<ul>
<li><strong>å®¢æˆ·ç«¯å¼‚å¸¸</strong>ï¼šåŸºäºä¸»é”®IDæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œä¼ å…¥çš„IDæ ¼å¼éæ³•æˆ–ä¸ºnullï¼Œè¿”å›å‚æ•°é”™è¯¯å¼‚å¸¸</li>
<li><strong>ä¸šåŠ¡å¼‚å¸¸</strong>ï¼šåŸºäºä¸»é”®IDæŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œä½†ç”¨æˆ·ä¿¡æ¯æ˜¯åŠ å¯†çš„åªå…è®¸ç‰¹å®šäººå‘˜æŸ¥çœ‹ï¼Œè¿”å›æƒé™ä¸è¶³å¼‚å¸¸</li>
<li><strong>æœåŠ¡ç«¯å¼‚å¸¸</strong>ï¼šåŸºäºä¸»é”®IDæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œæ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œè¿”å›ç³»ç»Ÿå¼‚å¸¸</li>
</ul>
<p>å¯¹äºæˆ‘åœ¨å·¥ä½œä¸­é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šä¸€ä¸ªå®¡æ‰¹æµç¨‹ï¼Œæœ€åä¸€ä¸ªç¯èŠ‚éœ€è¦éƒ¨é—¨é¢†å¯¼ç”³è¯·ï¼Œä½†æ˜¯éƒ¨é—¨é¢†å¯¼æ²¡æœ‰æ³¨å†Œè¯¥ç³»ç»Ÿè´¦æˆ·ï¼Œå¯¼è‡´å·¥å•åˆ°éƒ¨é—¨é¢†å¯¼å®¡æ‰¹ç»“ç‚¹æ—¶è¢«é˜»å¡ã€‚è¿™ç§ä¸šåŠ¡å¼‚å¸¸çš„ç¨½æ ¸è§„åˆ™åº”å‰ç½®åˆ°å‘èµ·è¯¥å®¡æ‰¹æµç¨‹çš„æ—¶å€™ï¼šâ€œè¯¥æµç¨‹éœ€è¦éƒ¨é—¨é¢†å¯¼å®¡æ‰¹ï¼Œæ²¡æœ‰æŸ¥è¯¢åˆ°æ‚¨æ‰€å±éƒ¨é—¨é¢†å¯¼çš„è´¦æˆ·ä¿¡æ¯ï¼Œè¯·æ ¸å®â€ã€‚</p>
<h3 data-id="heading-8">ç¼–ç¨‹å®è·µ</h3>
<p><strong>å¼‚å¸¸å±‚æ¬¡æ¶æ„</strong></p>
<pre><code class="hljs language-scss" lang="scss">Exception (Pythonå†…ç½®é¡¶å±‚çˆ¶ç±»ï¼Œæ‰€æœ‰å¼‚å¸¸æ ¹èŠ‚ç‚¹ï¼Œä»…ä½œä¸ºåº•å±‚æ•è·æº)
â””â”€ AppBaseException (å¯é€‰æŠ½è±¡åŸºç±»ï¼Œå°è£…é€šç”¨å±æ€§ï¼šé”™è¯¯ç /æç¤º/HTTPçŠ¶æ€ç ï¼Œæ¨èä½¿ç”¨)
   â”œâ”€ ClientException (å®¢æˆ·ç«¯å¼‚å¸¸æ ¹ç±»ï¼Œæ¥å£å±‚æŠ›å‡º)
   â”‚  â”œâ”€ ValidationException (å‚æ•°æ ¡éªŒï¼šæ ¼å¼/éç©º/èŒƒå›´é”™è¯¯)
   â”‚  â”œâ”€ AuthenticationException (è®¤è¯ï¼šæœªç™»å½•/Tokenè¿‡æœŸ/è®¤è¯å¤±è´¥)
   â”‚  â””â”€ AuthorizationException (æˆæƒï¼šæ— æ¥å£/èµ„æºæ“ä½œæƒé™)
   â”‚
   â”œâ”€ BizException (ä¸šåŠ¡å¼‚å¸¸æ ¹ç±»ï¼Œä¸šåŠ¡å±‚æŠ›å‡º)
   â”‚  â”œâ”€ BusinessRuleException (é€šç”¨ä¸šåŠ¡è§„åˆ™ï¼šä½™é¢/åº“å­˜ä¸è¶³ã€è§„åˆ™æ ¡éªŒå¤±è´¥)
   â”‚  â”œâ”€ ResourceException (èµ„æºï¼šä¸å­˜åœ¨/å·²è¢«å ç”¨/å·²åˆ é™¤)
   â”‚  â””â”€ StateException (çŠ¶æ€ï¼šè®¢å•/å•†å“çŠ¶æ€ä¸æ”¯æŒå½“å‰æ“ä½œ)
   â”‚
   â””â”€ ServerException (æœåŠ¡ç«¯å¼‚å¸¸æ ¹ç±»ï¼Œæ•°æ®/ä¾èµ–å±‚æŠ›å‡ºï¼Œæ‰¿æ¥æ‰€æœ‰ç³»ç»Ÿå¼‚å¸¸è½¬æ¢)
      â”œâ”€ InfrastructureException (åŸºç¡€è®¾æ–½å¼‚å¸¸ï¼šæ•°æ®åº“/ç¼“å­˜/MQ/æ–‡ä»¶ç³»ç»Ÿæ•…éšœ)
      â”œâ”€ ExternalServiceException (å¤–éƒ¨æœåŠ¡å¼‚å¸¸ï¼šç¬¬ä¸‰æ–¹/å†…éƒ¨å¹³å°è°ƒç”¨è¶…æ—¶/è¿æ¥å¤±è´¥)
      â”œâ”€ UnexpectedException (é¢„æœŸå†…ç³»ç»Ÿå¼‚å¸¸ï¼šå¯æ•è·çš„åŸç”Ÿå¼‚å¸¸è½¬æ¢ï¼Œå¦‚KeyError/IndexError)
      â””â”€ UnknownException (æœªçŸ¥å¼‚å¸¸ï¼šæœªä¸“é—¨å¤„ç†çš„åŸç”Ÿå¼‚å¸¸/æœªé¢„è§å¼‚å¸¸ï¼Œæœ€ç»ˆå…œåº•)
</code></pre>
<p>å…¶ä¸­ï¼ŒUnknownExceptionä½œä¸ºæœåŠ¡ç«¯å¼‚å¸¸çš„å…œåº•åˆ†ç±»ï¼Œä¸“é—¨ç”¨äºå¤„ç†é‚£äº›åœ¨å¼€å‘é˜¶æ®µæœªèƒ½é¢„è§çš„å¼‚å¸¸æƒ…å†µã€‚æœªçŸ¥å¼‚å¸¸æ˜¯å¼‚å¸¸æ²»ç†çš„é‡ç‚¹ï¼Œå› ä¸ºå®ƒä»¬ä»£è¡¨äº†ç³»ç»Ÿä¸­å°šæœªè¢«å……åˆ†ç†è§£å’Œå¤„ç†çš„æ½œåœ¨é£é™©ã€‚è¿™ç±»å¼‚å¸¸è™½ç„¶åœ¨å‘ç”Ÿæ—¶æ— æ³•ç²¾ç¡®åˆ†ç±»ï¼Œä½†é€šè¿‡ç»Ÿä¸€çš„UnknownExceptionå¤„ç†ï¼Œå¯ä»¥ç¡®ä¿ï¼š</p>
<ul>
<li>ç³»ç»Ÿä¿æŒç¨³å®šè¿è¡Œ</li>
<li>ä¸ºå¼€å‘å›¢é˜Ÿæä¾›åé¦ˆï¼Œä»¥ä¾¿åç»­ä¼˜åŒ–</li>
<li>é¿å…æ•æ„Ÿä¿¡æ¯æ³„éœ²ç»™å®¢æˆ·ç«¯</li>
<li>ä¾¿äºç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿçš„ç»Ÿä¸€ç®¡ç†</li>
<li>ä½œä¸ºå¼‚å¸¸æ²»ç†çš„é‡è¦æŒ‡æ ‡ï¼Œæ¨åŠ¨ç³»ç»ŸæŒç»­æ”¹è¿›</li>
</ul>
<p>è‡ªå®šä¹‰å¼‚å¸¸è®¾è®¡å®è·µï¼š</p>
<blockquote>
<p>é¿å…è¿‡åº¦è®¾è®¡ï¼Œå‚æ•°å¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ·»åŠ </p>
</blockquote>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>, <span class="hljs-type">Dict</span>, <span class="hljs-type">Any</span>

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AppBaseException</span>(<span class="hljs-title class_ inherited__">Exception</span>):
    <span class="hljs-string">"""åº”ç”¨å¼‚å¸¸åŸºç±»ï¼Œå°è£…é€šç”¨å±æ€§"""</span>
    message: <span class="hljs-built_in">str</span> = <span class="hljs-string">"ç³»ç»Ÿå¼‚å¸¸"</span>
    error_code: <span class="hljs-built_in">str</span> = <span class="hljs-string">"SYSTEM_ERROR"</span>
    http_status: <span class="hljs-built_in">int</span> = <span class="hljs-number">500</span>
    details: <span class="hljs-type">Optional</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]] = <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__post_init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">super</span>().__init__(self.message)

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ClientException</span>(<span class="hljs-title class_ inherited__">AppBaseException</span>):
    <span class="hljs-string">"""å®¢æˆ·ç«¯å¼‚å¸¸åŸºç±»"""</span>
    message: <span class="hljs-built_in">str</span> = <span class="hljs-string">"å®¢æˆ·ç«¯å¼‚å¸¸"</span>
    error_code: <span class="hljs-built_in">str</span> = <span class="hljs-string">"CLIENT_ERROR"</span>
    http_status: <span class="hljs-built_in">int</span> = <span class="hljs-number">400</span>

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ValidationException</span>(<span class="hljs-title class_ inherited__">ClientException</span>):
    <span class="hljs-string">"""å‚æ•°æ ¡éªŒå¼‚å¸¸"""</span>
    message: <span class="hljs-built_in">str</span> = <span class="hljs-string">"å‚æ•°æ ¡éªŒå¤±è´¥"</span>
    error_code: <span class="hljs-built_in">str</span> = <span class="hljs-string">"VALIDATION_ERROR"</span>
    http_status: <span class="hljs-built_in">int</span> = <span class="hljs-number">400</span>

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthenticationException</span>(<span class="hljs-title class_ inherited__">ClientException</span>):
    <span class="hljs-string">"""è®¤è¯å¼‚å¸¸"""</span>
    message: <span class="hljs-built_in">str</span> = <span class="hljs-string">"è®¤è¯å¤±è´¥"</span>
    error_code: <span class="hljs-built_in">str</span> = <span class="hljs-string">"AUTHENTICATION_ERROR"</span>
    http_status: <span class="hljs-built_in">int</span> = <span class="hljs-number">401</span>

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthorizationException</span>(<span class="hljs-title class_ inherited__">ClientException</span>):
    <span class="hljs-string">"""æˆæƒå¼‚å¸¸"""</span>
    message: <span class="hljs-built_in">str</span> = <span class="hljs-string">"æƒé™ä¸è¶³"</span>
    error_code: <span class="hljs-built_in">str</span> = <span class="hljs-string">"AUTHORIZATION_ERROR"</span>
    http_status: <span class="hljs-built_in">int</span> = <span class="hljs-number">403</span>

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BizException</span>(<span class="hljs-title class_ inherited__">AppBaseException</span>):
    <span class="hljs-string">"""ä¸šåŠ¡å¼‚å¸¸åŸºç±»"""</span>
    message: <span class="hljs-built_in">str</span> = <span class="hljs-string">"ä¸šåŠ¡å¼‚å¸¸"</span>
    error_code: <span class="hljs-built_in">str</span> = <span class="hljs-string">"BUSINESS_ERROR"</span>
    http_status: <span class="hljs-built_in">int</span> = <span class="hljs-number">299</span>

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ServerException</span>(<span class="hljs-title class_ inherited__">AppBaseException</span>):
    <span class="hljs-string">"""æœåŠ¡ç«¯å¼‚å¸¸åŸºç±»"""</span>
    message: <span class="hljs-built_in">str</span> = <span class="hljs-string">"æœåŠ¡å™¨å¼‚å¸¸"</span>
    error_code: <span class="hljs-built_in">str</span> = <span class="hljs-string">"SERVER_ERROR"</span>
    http_status: <span class="hljs-built_in">int</span> = <span class="hljs-number">500</span>

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UnknownException</span>(<span class="hljs-title class_ inherited__">ServerException</span>):
    <span class="hljs-string">"""æœªçŸ¥å¼‚å¸¸ç±»ï¼Œç”¨äºå¤„ç†æœªé¢„è§åˆ°çš„å¼‚å¸¸æƒ…å†µ"""</span>
    message: <span class="hljs-built_in">str</span> = <span class="hljs-string">"æœªçŸ¥å¼‚å¸¸"</span>
    error_code: <span class="hljs-built_in">str</span> = <span class="hljs-string">"UNKNOWN_ERROR"</span>
    http_status: <span class="hljs-built_in">int</span> = <span class="hljs-number">500</span>

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">example_usage</span>():
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># æ¨¡æ‹Ÿä¸šåŠ¡é€»è¾‘</span>
        <span class="hljs-keyword">raise</span> ValidationException(
            message=<span class="hljs-string">"æ‰‹æœºå·æ ¼å¼é”™è¯¯"</span>,
            error_code=<span class="hljs-string">"INVALID_PHONE_FORMAT"</span>,
            details={<span class="hljs-string">"field"</span>: <span class="hljs-string">"phone"</span>, <span class="hljs-string">"value"</span>: <span class="hljs-string">"123"</span>}
        )
    <span class="hljs-keyword">except</span> ValidationException <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ•è·åˆ°å¼‚å¸¸: <span class="hljs-subst">{e.message}</span>, é”™è¯¯ç : <span class="hljs-subst">{e.error_code}</span>"</span>)
        <span class="hljs-comment"># è¾“å‡º: æ•è·åˆ°å¼‚å¸¸: æ‰‹æœºå·æ ¼å¼é”™è¯¯, é”™è¯¯ç : INVALID_PHONE_FORMAT</span>
</code></pre>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¼‚å¸¸åˆ†ç±»çš„å¤šç»´åº¦æ¨¡å‹å’Œåˆ†ç±»åŸåˆ™ï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>åˆ†ç±»ç»´åº¦</strong>ï¼šä»æ ¸å¿ƒè´£ä»»ã€è¿ç»´ç›‘æ§ã€æŠ€æœ¯æ¶æ„ã€å•†ä¸šè€ƒé‡å››ä¸ªç»´åº¦å¯¹å¼‚å¸¸è¿›è¡Œåˆ†ç±»</li>
<li><strong>å¼‚å¸¸æ¥æº</strong>ï¼šåŒºåˆ†å¹³å°å¼‚å¸¸ï¼ˆç³»ç»Ÿçº§ï¼‰å’Œåº”ç”¨å¼‚å¸¸ï¼ˆä¸šåŠ¡çº§ï¼‰</li>
<li><strong>ä¸‰å¤§å¼‚å¸¸ç±»å‹</strong>ï¼šå®¢æˆ·ç«¯å¼‚å¸¸ï¼ˆ4xxï¼‰ã€ä¸šåŠ¡å¼‚å¸¸ï¼ˆ299ï¼‰ã€æœåŠ¡ç«¯å¼‚å¸¸ï¼ˆ5xxï¼‰</li>
<li><strong>æœªçŸ¥å¼‚å¸¸å¤„ç†</strong>ï¼šä½œä¸ºå¼‚å¸¸æ²»ç†çš„é‡ç‚¹ï¼Œéœ€è¦å»ºç«‹å…œåº•æœºåˆ¶</li>
<li><strong>å¼‚å¸¸å±‚æ¬¡æ¶æ„</strong>ï¼šå»ºç«‹äº†æ¸…æ™°çš„å¼‚å¸¸ç»§æ‰¿ä½“ç³»</li>
</ol>
<p>é€šè¿‡ç§‘å­¦çš„å¼‚å¸¸åˆ†ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li>æ˜ç¡®é—®é¢˜è´£ä»»è¾¹ç•Œï¼Œå¿«é€Ÿå®šä½æ•…éšœæ ¹æº</li>
<li>ä¾¿äºç›‘æ§å‘Šè­¦é…ç½®ï¼Œæé«˜è¿ç»´æ•ˆç‡</li>
<li>ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œæä¾›å‹å¥½çš„é”™è¯¯ä¿¡æ¯</li>
<li>ä¸ºåç»­å¼‚å¸¸å¤„ç†ç­–ç•¥å¥ å®šåŸºç¡€</li>
</ul>
<h2 data-id="heading-10">ä¸‹ä¸€ç¯‡é¢„å‘Šï¼šå¼‚å¸¸å¤„ç†</h2>
<p>åœ¨æ˜ç¡®äº†å¼‚å¸¸åˆ†ç±»ä¹‹åï¼Œä¸‹ä¸€æ­¥æ˜¯å»ºç«‹æœ‰æ•ˆçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œå°†æ·±å…¥æ¢è®¨ï¼š</p>
<ul>
<li><strong>å¼‚å¸¸å¤„ç†ç­–ç•¥</strong>ï¼šä¸åŒå¼‚å¸¸ç±»å‹çš„å¤„ç†æ–¹å¼ï¼Œå¼‚å¸¸æŠ›å‡º</li>
<li><strong>æ¶æ„å±‚å¤„ç†</strong>ï¼šController-Service-Repositoryä¸‰å±‚å¼‚å¸¸å¤„ç†å®è·µ</li>
<li><strong>å¼‚å¸¸è½¬æ¢</strong>ï¼šå¦‚ä½•å°†åº•å±‚å¼‚å¸¸è½¬æ¢ä¸ºç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯ï¼Œä¿æŒå¼‚å¸¸ä¿¡æ¯çš„å®Œæ•´æ€§</li>
<li><strong>å…¨å±€å¼‚å¸¸å¤„ç†å™¨</strong>ï¼šç»Ÿä¸€å¼‚å¸¸å¤„ç†æœºåˆ¶</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Cè¯­è¨€æ·±å…¥æ¢ç´¢ã€‘æŒ‡é’ˆé«˜çº§åº”ç”¨ä¸æè‡´æŠ€å·§ï¼ˆä¸€ï¼‰]]></title>    <link>https://juejin.cn/post/7602800677712199714</link>    <guid>https://juejin.cn/post/7602800677712199714</guid>    <pubDate>2026-02-05T01:08:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602800677712199714" data-draft-id="7602824293165023247" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Cè¯­è¨€æ·±å…¥æ¢ç´¢ã€‘æŒ‡é’ˆé«˜çº§åº”ç”¨ä¸æè‡´æŠ€å·§ï¼ˆä¸€ï¼‰"/> <meta itemprop="keywords" content="Cè¯­è¨€"/> <meta itemprop="datePublished" content="2026-02-05T01:08:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="byteè½»éª‘å…µ"/> <meta itemprop="url" content="https://juejin.cn/user/3995005743010080"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Cè¯­è¨€æ·±å…¥æ¢ç´¢ã€‘æŒ‡é’ˆé«˜çº§åº”ç”¨ä¸æè‡´æŠ€å·§ï¼ˆä¸€ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3995005743010080/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    byteè½»éª‘å…µ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:08:21.000Z" title="Thu Feb 05 2026 01:08:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¯¦è§£Cè¯­è¨€æŒ‡é’ˆé«˜çº§åº”ç”¨ï¼Œæ¶µç›–æŒ‡é’ˆç®—æœ¯è¿ç®—ã€ä¸ç»“æ„ä½“ç»“åˆã€åŠ¨æ€å†…å­˜åˆ†é…ï¼ˆmalloc/freeï¼‰ã€å‡½æ•°æŒ‡é’ˆï¼ˆå›è°ƒ/æ•°ç»„ï¼‰ã€äºŒçº§æŒ‡é’ˆï¼Œé™„ä»£ç ç¤ºä¾‹ï¼Œæé†’é¿å…å†…å­˜æ³„æ¼ã€ç¡®ä¿æŒ‡é’ˆæœ‰æ•ˆï¼ŒåŠ©åŠ›æŒæ¡æŒ‡é’ˆè¿›é˜¶ç”¨æ³•ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—è¯¦è§£</h2>
<p>æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—æ˜¯Cè¯­è¨€ä¸­ä¸€ä¸ªéå¸¸é‡è¦ä¸”å¼ºå¤§çš„ç‰¹æ€§ï¼Œå®ƒå…è®¸ç¨‹åºå‘˜ç›´æ¥å¯¹å†…å­˜åœ°å€è¿›è¡Œæ“ä½œã€‚</p>
<h3 data-id="heading-1">1.1. åŸºæœ¬æ¦‚å¿µ</h3>
<blockquote>
<p><strong>æŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå…¶å­˜å‚¨çš„æ˜¯å¦ä¸€ä¸ªå˜é‡çš„åœ°å€ã€‚åœ¨Cè¯­è¨€ä¸­ï¼ŒæŒ‡é’ˆçš„ç®—æœ¯è¿ç®—å®é™…ä¸Šæ˜¯å¯¹æŒ‡é’ˆæ‰€æŒ‡å‘çš„<strong><strong>å†…å­˜</strong></strong>åœ°å€è¿›è¡Œç®—æœ¯æ“ä½œã€‚</strong></p>
</blockquote>
<h3 data-id="heading-2">1.2. é€’å¢ä¸é€’å‡è¿ç®—</h3>
<ul>
<li>
<p>**é€’å¢ï¼ˆ++ï¼‰è¿ç®—ï¼š**å½“å¯¹æŒ‡é’ˆè¿›è¡Œé€’å¢è¿ç®—æ—¶ï¼ŒæŒ‡é’ˆä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå†…å­˜åœ°å€ã€‚è¿™ä¸ªâ€œä¸‹ä¸€ä¸ªâ€æ˜¯ç›¸å¯¹äºæŒ‡é’ˆæ‰€æŒ‡å‘çš„æ•°æ®ç±»å‹è€Œè¨€çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªintç±»å‹çš„æ•°ç»„å…ƒç´ ï¼Œé‚£ä¹ˆé€’å¢è¿ç®—ä¼šä½¿æŒ‡é’ˆç§»åŠ¨åˆ°æ•°ç»„ä¸­ä¸‹ä¸€ä¸ªintå…ƒç´ çš„åœ°å€ã€‚</p>
</li>
<li>
<p>**é€’å‡ï¼ˆ--ï¼‰è¿ç®—ï¼š**é€’å‡è¿ç®—ä¸é€’å¢è¿ç®—ç›¸åï¼Œå®ƒä¼šä½¿æŒ‡é’ˆç§»åŠ¨åˆ°å‰ä¸€ä¸ªå†…å­˜åœ°å€ã€‚</p>
</li>
</ul>
<blockquote>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé€’å¢å’Œé€’å‡è¿ç®—åªåœ¨æŒ‡å‘ç›¸åŒç±»å‹çš„æ•°æ®æ—¶æ‰æœ‰æ„ä¹‰ã€‚å› ä¸ºä¸åŒç±»å‹çš„æ•°æ®å¯èƒ½å ç”¨ä¸åŒå¤§å°çš„<strong><strong>å†…å­˜</strong></strong>ç©ºé—´ï¼Œå¦‚æœå¯¹ä¸åŒç±»å‹çš„æ•°æ®æŒ‡é’ˆè¿›è¡Œé€’å¢æˆ–é€’å‡è¿ç®—ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸å¯é¢„æµ‹çš„ç»“æœã€‚</strong></p>
</blockquote>
<h3 data-id="heading-3">1.3. åŠ æ³•ä¸å‡æ³•è¿ç®—</h3>
<ul>
<li>
<p>**åŠ æ³•ï¼ˆ+ï¼‰è¿ç®—ï¼š**æŒ‡é’ˆçš„åŠ æ³•è¿ç®—å…è®¸ä»¥å…ƒç´ ä¸ºå•ä½ç§»åŠ¨æŒ‡é’ˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼Œå¹¶ä¸”æƒ³ç§»åŠ¨åˆ°æ•°ç»„çš„ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼Œå¯ä»¥é€šè¿‡å°†æŒ‡é’ˆä¸2ï¼ˆå› ä¸ºæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼Œæ‰€ä»¥ç¬¬ä¸‰ä¸ªå…ƒç´ çš„ç´¢å¼•æ˜¯2ï¼‰ç›¸åŠ æ¥å®ç°ã€‚</p>
</li>
<li>
<p>**å‡æ³•ï¼ˆ-ï¼‰è¿ç®—ï¼š**å‡æ³•è¿ç®—ä¸åŠ æ³•è¿ç®—ç›¸åï¼Œå®ƒå…è®¸ä»¥å…ƒç´ ä¸ºå•ä½å‘åç§»åŠ¨æŒ‡é’ˆã€‚</p>
</li>
</ul>
<p>åŒæ ·åœ°ï¼ŒåŠ æ³•ä¸å‡æ³•è¿ç®—ä¹Ÿåªåœ¨æŒ‡å‘ç›¸åŒç±»å‹çš„æ•°æ®æ—¶æ‰æœ‰æ„ä¹‰ã€‚</p>
<h3 data-id="heading-4">1.4. ç¤ºä¾‹ä»£ç </h3>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºæŒ‡é’ˆçš„ç®—æœ¯è¿ç®—ï¼šåˆ›å»ºä¸€ä¸ªæ•´å‹æ•°ç»„<code>arr</code>ï¼Œå¹¶åˆå§‹åŒ–äº†ä¸€äº›å€¼ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ<code>ptr</code>ï¼Œå¹¶æ¼”ç¤ºäº†é€’å¢ã€é€’å‡ã€åŠ æ³•å’Œå‡æ³•è¿ç®—ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span>  </span>
  
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{  
    <span class="hljs-type">int</span> arr[] = {<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>};  
    <span class="hljs-type">int</span> *ptr = arr; <span class="hljs-comment">// æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ  </span>
  
    <span class="hljs-comment">// é€’å¢è¿ç®—  </span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"After incrementing ptr: %d\n"</span>, *(ptr++)); <span class="hljs-comment">// è¾“å‡º1ï¼Œç„¶åptræŒ‡å‘ç¬¬äºŒä¸ªå…ƒç´   </span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Now ptr points to: %d\n"</span>, *ptr); <span class="hljs-comment">// è¾“å‡º2  </span>
  
    <span class="hljs-comment">// é€’å‡è¿ç®—ï¼ˆæ³¨æ„ï¼šè¿™é‡Œåªæ˜¯æ¼”ç¤ºï¼Œå®é™…ä½¿ç”¨ä¸­å¾ˆå°‘å¯¹å·²ç»é€’å¢è¿‡çš„æŒ‡é’ˆè¿›è¡Œé€’å‡ï¼‰  </span>
    ptr++; <span class="hljs-comment">// å…ˆè®©ptræŒ‡å‘ç¬¬ä¸‰ä¸ªå…ƒç´   </span>
    ptr--; <span class="hljs-comment">// å†è®©ptræŒ‡å›ç¬¬äºŒä¸ªå…ƒç´   </span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"After decrementing ptr: %d\n"</span>, *ptr); <span class="hljs-comment">// è¾“å‡º2  </span>
  
    <span class="hljs-comment">// åŠ æ³•ä¸å‡æ³•è¿ç®—  </span>
    <span class="hljs-type">int</span> *new_ptr = arr + <span class="hljs-number">2</span>; <span class="hljs-comment">// new_ptræŒ‡å‘æ•°ç»„çš„ç¬¬ä¸‰ä¸ªå…ƒç´   </span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"new_ptr points to: %d\n"</span>, *new_ptr); <span class="hljs-comment">// è¾“å‡º3  </span>
  
    new_ptr -= <span class="hljs-number">1</span>; <span class="hljs-comment">// new_ptrç°åœ¨æŒ‡å‘æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´   </span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"After decrementing new_ptr: %d\n"</span>, *new_ptr); <span class="hljs-comment">// è¾“å‡º2  </span>
  
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  
}
</code></pre>
<p><strong>è¿è¡Œç»“æœï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64371964f6f947a080fc9da87a617d7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0Zei9u-mqkeWFtQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770858627&amp;x-signature=KC%2BD9L3MrbV2Oxd7kORK0Y2GMpw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">1.5. æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>
<p>æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—å¿…é¡»è°¨æ…è¿›è¡Œï¼Œä»¥é¿å…è®¿é—®éæ³•çš„å†…å­˜åœ°å€ã€‚</p>
</li>
<li>
<p>æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—åªåœ¨æŒ‡å‘ç›¸åŒç±»å‹çš„æ•°æ®æ—¶æ‰æœ‰æ„ä¹‰ï¼Œå› æ­¤åœ¨è¿›è¡Œè¿ç®—ä¹‹å‰ï¼Œå¿…é¡»ç¡®ä¿æŒ‡é’ˆçš„ç±»å‹æ˜¯ä¸€è‡´çš„ã€‚</p>
</li>
<li>
<p>åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼ˆå¦‚ä½¿ç”¨<code>malloc</code>å‡½æ•°åˆ†é…çš„å†…å­˜ï¼‰ä¹Ÿå¯ä»¥ä½¿ç”¨æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—æ¥è®¿é—®ä¸åŒçš„å†…å­˜ä½ç½®ï¼Œä½†åŒæ ·éœ€è¦æ³¨æ„ä¸è¦è®¿é—®éæ³•çš„å†…å­˜åœ°å€ã€‚</p>
</li>
</ul>
<blockquote>
<p><strong>æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—æ˜¯Cè¯­è¨€ä¸­ä¸€ä¸ªéå¸¸å¼ºå¤§ä¸”çµæ´»çš„ç‰¹æ€§ï¼Œå®ƒå…è®¸ç¨‹åºå‘˜ç›´æ¥å¯¹<strong><strong>å†…å­˜</strong></strong>åœ°å€è¿›è¡Œæ“ä½œã€‚ç„¶è€Œï¼Œè¿™ä¸ªç‰¹æ€§ä¹Ÿå¸¦æ¥äº†ä¸€å®šçš„é£é™©ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶å¿…é¡»è°¨æ…ã€‚</strong></p>
</blockquote>
<h2 data-id="heading-6">äºŒã€æŒ‡é’ˆä¸ç»“æ„ä½“</h2>
<p>åœ¨Cè¯­è¨€ä¸­ï¼Œç»“æ„ä½“ï¼ˆ<code>struct</code>ï¼‰æ˜¯ä¸€ç§ç”¨æˆ·å®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œå®ƒå…è®¸å°†å¤šä¸ªä¸åŒç±»å‹çš„æ•°æ®é¡¹ç»„åˆæˆä¸€ä¸ªå•ä¸€çš„å¤åˆç±»å‹ã€‚å½“æŒ‡é’ˆä¸ç»“æ„ä½“ç»“åˆä½¿ç”¨æ—¶ï¼Œå¯ä»¥å®ç°è®¸å¤šé«˜çº§çš„æ•°æ®ç»“æ„å’Œç®—æ³•ã€‚</p>
<h3 data-id="heading-7">2.1. ç»“æ„ä½“å®šä¹‰ä¸å®ä¾‹</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ç±»å‹ï¼Œå¹¶åˆ›å»ºè¯¥ç±»å‹çš„å®ä¾‹ï¼ˆå˜é‡ï¼‰ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span>  </span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span>  </span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span>  </span>
  
<span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ç±»å‹  </span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Person</span> {  
    <span class="hljs-type">char</span> name[<span class="hljs-number">50</span>];  
    <span class="hljs-type">int</span> age;  
    <span class="hljs-type">float</span> height;  
};  
  
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{  
    <span class="hljs-comment">// åˆ›å»ºç»“æ„ä½“çš„å®ä¾‹  </span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Person</span> person1 = {<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>, <span class="hljs-number">5.5</span>};  
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Person</span> person2;  
  
    <span class="hljs-comment">// ...ï¼ˆå¯¹ç»“æ„ä½“å®ä¾‹è¿›è¡Œæ“ä½œï¼‰  </span>
  
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  
}
</code></pre>
<h3 data-id="heading-8">2.2. æŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆ</h3>
<p>å¯ä»¥å®šä¹‰ä¸€ä¸ªæŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œå¹¶è®©å®ƒæŒ‡å‘ä¸€ä¸ªç»“æ„ä½“å®ä¾‹ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">struct Person *<span class="hljs-attr">ptr</span> = &amp;person1<span class="hljs-comment">;</span>
</code></pre>
<p>ç°åœ¨ï¼Œ<code>ptr</code>æ˜¯ä¸€ä¸ªæŒ‡å‘<code>struct Person</code>ç±»å‹çš„æŒ‡é’ˆï¼Œå®ƒæŒ‡å‘<code>person1</code>çš„åœ°å€ã€‚</p>
<h3 data-id="heading-9">2.3. ä½¿ç”¨-&gt;è¿ç®—ç¬¦è®¿é—®ç»“æ„ä½“æˆå‘˜</h3>
<p>é€šè¿‡æŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œå¯ä»¥ä½¿ç”¨<code>-&gt;</code>è¿ç®—ç¬¦æ¥è®¿é—®ç»“æ„ä½“çš„æˆå‘˜ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">printf</span>(<span class="hljs-string">"Name: %s\n"</span>, ptr-&gt;name);  
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"Age: %d\n"</span>, ptr-&gt;age);  
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"Height: %.1f\n"</span>, ptr-&gt;height);
</code></pre>
<p>è¿™é‡Œçš„<code>ptr-&gt;name</code>ã€<code>ptr-&gt;age</code>å’Œ<code>ptr-&gt;height</code>åˆ†åˆ«è¡¨ç¤ºé€šè¿‡æŒ‡é’ˆ<code>ptr</code>è®¿é—®<code>struct Person</code>ç±»å‹çš„<code>name</code>ã€<code>age</code>å’Œ<code>height</code>æˆå‘˜ã€‚</p>
<h3 data-id="heading-10">2.4. åŠ¨æ€åˆ†é…ç»“æ„ä½“æ•°ç»„</h3>
<p>åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œå¯èƒ½éœ€è¦åŠ¨æ€åˆ†é…ä¸€ä¸ªç»“æ„ä½“æ•°ç»„ã€‚è¿™æ—¶ï¼ŒæŒ‡é’ˆä¸ç»“æ„ä½“çš„ç»“åˆä½¿ç”¨å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#include &lt;stdio.h&gt;</span>
<span class="hljs-comment">#include &lt;stdlib.h&gt;</span>
<span class="hljs-comment">#include &lt;string.h&gt;</span>
 
// å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ç±»å‹
struct Person {
    char name<span class="hljs-section">[50]</span><span class="hljs-comment">;</span>
    int age<span class="hljs-comment">;</span>
    float height<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
 
int main() {
    int <span class="hljs-attr">num_people</span> = <span class="hljs-number">3</span><span class="hljs-comment">;</span>
    struct Person *<span class="hljs-attr">people</span> = (struct Person *)malloc(num_people * sizeof(struct Person))<span class="hljs-comment">;</span>
 
    if (<span class="hljs-attr">people</span> == NULL) {
        // å¤„ç†å†…å­˜åˆ†é…å¤±è´¥çš„æƒ…å†µ
        fprintf(stderr, "Memory allocation failed\n")<span class="hljs-comment">;</span>
        return 1<span class="hljs-comment">;</span>
    }
 
    // åˆå§‹åŒ–ç»“æ„ä½“æ•°ç»„
    strcpy(people<span class="hljs-section">[0]</span>.name, "Bob")<span class="hljs-comment">;</span>
    people<span class="hljs-section">[0]</span>.<span class="hljs-attr">age</span> = <span class="hljs-number">25</span><span class="hljs-comment">;</span>
    people<span class="hljs-section">[0]</span>.<span class="hljs-attr">height</span> = <span class="hljs-number">6.0</span><span class="hljs-comment">;</span>
 
    strcpy(people<span class="hljs-section">[1]</span>.name, "Charlie")<span class="hljs-comment">;</span>
    people<span class="hljs-section">[1]</span>.<span class="hljs-attr">age</span> = <span class="hljs-number">35</span><span class="hljs-comment">;</span>
    people<span class="hljs-section">[1]</span>.<span class="hljs-attr">height</span> = <span class="hljs-number">5.9</span><span class="hljs-comment">;</span>
 
    strcpy(people<span class="hljs-section">[2]</span>.name, "Jor")<span class="hljs-comment">;</span>
    people<span class="hljs-section">[2]</span>.<span class="hljs-attr">age</span> = <span class="hljs-number">38</span><span class="hljs-comment">;</span>
    people<span class="hljs-section">[2]</span>.<span class="hljs-attr">height</span> = <span class="hljs-number">6.3</span><span class="hljs-comment">;</span>
 
 
    // ä½¿ç”¨-&gt;è¿ç®—ç¬¦è®¿é—®åŠ¨æ€åˆ†é…çš„ç»“æ„ä½“æ•°ç»„çš„æˆå‘˜
    for (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; num_people; i++) {</span>
        printf("Person %d: Name: %s, Age: %d, Height: %.1f\n", i + 1, people<span class="hljs-section">[i]</span>.name, people<span class="hljs-section">[i]</span>.age, people<span class="hljs-section">[i]</span>.height)<span class="hljs-comment">;</span>
        // æˆ–è€…ä½¿ç”¨æŒ‡é’ˆç®—æœ¯å’Œ-&gt;è¿ç®—ç¬¦
        // printf("Person %d: Name: %s, Age: %d, Height: %.1f\n", i + 1, (people + i)-&gt;name, (people + i)-&gt;age, (people + i)-&gt;height)<span class="hljs-comment">;</span>
    }
 
    // é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜
    free(people)<span class="hljs-comment">;</span>
}
</code></pre>
<p>åœ¨è®¿é—®åŠ¨æ€åˆ†é…çš„ç»“æ„ä½“æ•°ç»„çš„æˆå‘˜æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨æ•°ç»„ç´¢å¼•ï¼ˆå¦‚<code>people[i].name</code>ï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡é’ˆç®—æœ¯å’Œ<code>-&gt;</code>è¿ç®—ç¬¦ï¼ˆå¦‚<code>(people + i)-&gt;name</code>ï¼‰æ¥å®ç°ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>free</code>å‡½æ•°é‡Šæ”¾äº†åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚</p>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f39807a342e6440a95ddfd498ab97869~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0Zei9u-mqkeWFtQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770858627&amp;x-signature=HDmGxCkKHO8%2BH1bFDRmcoOeive0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">2.5. æ³¨æ„äº‹é¡¹</h3>
<blockquote>
<ul>
<li>
<p>åœ¨ä½¿ç”¨åŠ¨æ€åˆ†é…çš„å†…å­˜æ—¶ï¼Œä¸€å®šè¦ç¡®ä¿åœ¨ä¸å†éœ€è¦æ—¶é‡Šæ”¾å®ƒï¼Œä»¥é¿å…å†…å­˜æ³„æ¼ã€‚</p>
</li>
<li>
<p>åœ¨è®¿é—®ç»“æ„ä½“æˆå‘˜æ—¶ï¼Œè¦ç¡®ä¿æŒ‡é’ˆæ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”æŒ‡å‘çš„ç»“æ„ä½“å®ä¾‹æ˜¯å­˜åœ¨çš„ã€‚</p>
</li>
<li>
<p>å½“ä½¿ç”¨æŒ‡é’ˆè®¿é—®ç»“æ„ä½“æˆå‘˜æ—¶ï¼Œè¦å°å¿ƒä¸è¦è¶Šç•Œè®¿é—®æœªåˆå§‹åŒ–çš„å†…å­˜åŒºåŸŸã€‚</p>
</li>
</ul>
</blockquote>
<h2 data-id="heading-12">ä¸‰ã€åŠ¨æ€å†…å­˜åˆ†é…ï¼ˆmalloc/freeï¼‰</h2>
<p>åœ¨Cè¯­è¨€ä¸­ï¼ŒåŠ¨æ€å†…å­˜åˆ†é…æ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„ç‰¹æ€§ï¼Œå®ƒå…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦åˆ†é…æˆ–é‡Šæ”¾å†…å­˜ã€‚è¿™ç§æœºåˆ¶é€šè¿‡<code>malloc</code>ï¼ˆmemory allocationï¼‰å’Œ<code>free</code>å‡½æ•°æ¥å®ç°ã€‚</p>
<h3 data-id="heading-13">3.1.mallocå‡½æ•°</h3>
<p><code>malloc</code>å‡½æ•°ç”¨äºä»å †ï¼ˆheapï¼‰ä¸­åˆ†é…æŒ‡å®šå¤§å°çš„å†…å­˜å—ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å†…å­˜å—çš„æŒ‡é’ˆã€‚å¦‚æœåˆ†é…å¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œç”±äºå†…å­˜ä¸è¶³ï¼‰ï¼Œåˆ™è¿”å›<code>NULL</code>ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span> <span class="hljs-comment">// åŒ…å«mallocå’Œfreeå‡½æ•°çš„å£°æ˜  </span></span>
  
<span class="hljs-function"><span class="hljs-type">void</span>* <span class="hljs-title">malloc</span><span class="hljs-params">(<span class="hljs-type">size_t</span> size)</span></span>;
</code></pre>
<ul>
<li>
<p><code>size</code>ï¼šè¦åˆ†é…çš„å­—èŠ‚æ•°ã€‚</p>
</li>
<li>
<p>è¿”å›å€¼ï¼šæŒ‡å‘åˆ†é…çš„å†…å­˜å—çš„æŒ‡é’ˆï¼Œå¦‚æœåˆ†é…å¤±è´¥åˆ™è¿”å›<code>NULL</code>ã€‚</p>
</li>
</ul>
<h3 data-id="heading-14">3.2.freeå‡½æ•°</h3>
<p><code>free</code>å‡½æ•°ç”¨äºé‡Šæ”¾ä¹‹å‰é€šè¿‡<code>malloc</code>ï¼ˆæˆ–<code>calloc</code>ã€<code>realloc</code>ï¼‰åˆ†é…çš„å†…å­˜å—ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span>  </span>
  
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">free</span><span class="hljs-params">(<span class="hljs-type">void</span>* ptr)</span></span>;
</code></pre>
<ul>
<li><code>ptr</code>ï¼šæŒ‡å‘è¦é‡Šæ”¾çš„å†…å­˜å—çš„æŒ‡é’ˆã€‚</li>
</ul>
<h3 data-id="heading-15">3.3. ä»£ç ç¤ºä¾‹</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨<code>malloc</code>å’Œ<code>free</code>è¿›è¡ŒåŠ¨æ€å†…å­˜åˆ†é…çš„ç®€å•ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span>  </span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span>  </span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span>  </span>
  
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {  
    <span class="hljs-comment">// åŠ¨æ€åˆ†é…ä¸€ä¸ªè¶³å¤Ÿå­˜å‚¨100ä¸ªå­—ç¬¦çš„å†…å­˜å—  </span>
    <span class="hljs-type">char</span>* str = (<span class="hljs-type">char</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">100</span> * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">char</span>));  
    <span class="hljs-keyword">if</span> (str == <span class="hljs-literal">NULL</span>) {  
        <span class="hljs-comment">// åˆ†é…å¤±è´¥ï¼Œå¤„ç†é”™è¯¯  </span>
        <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">"Memory allocation failed\n"</span>);  
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;  
    }  
  
    <span class="hljs-comment">// åˆå§‹åŒ–å†…å­˜å—  </span>
    <span class="hljs-built_in">strcpy</span>(str, <span class="hljs-string">"Hello, World!"</span>);  
  
    <span class="hljs-comment">// ä½¿ç”¨å†…å­˜å—  </span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"String: %s\n"</span>, str);  
  
    <span class="hljs-comment">// é‡Šæ”¾å†…å­˜å—  </span>
    <span class="hljs-built_in">free</span>(str);  
  
    <span class="hljs-comment">// æ³¨æ„ï¼šæ­¤æ—¶ä¸è¦å°è¯•è®¿é—®strï¼Œå› ä¸ºå®ƒå·²æŒ‡å‘æ— æ•ˆçš„å†…å­˜  </span>
    <span class="hljs-comment">// str[0] = 'A'; // è¿™å°†å¯¼è‡´æœªå®šä¹‰è¡Œä¸º  </span>
  
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  
}
</code></pre>
<p><strong>è¿è¡Œç»“æœï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b5a528b9f4040768a4cbe505d8457f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0Zei9u-mqkeWFtQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770858627&amp;x-signature=fwvUW70Yf1PZWSmDWDDMqx0F8qU%3D" alt="" loading="lazy"/></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨é‡Šæ”¾å†…å­˜åï¼Œæˆ‘ä»¬ä¸åº”è¯¥å†å°è¯•è®¿é—®<code>str</code>æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å—ï¼Œå› ä¸ºå®ƒç°åœ¨å·²ç»æŒ‡å‘äº†æ— æ•ˆçš„å†…å­˜ã€‚å°è¯•è®¿é—®å·²é‡Šæ”¾çš„å†…å­˜å—å°†å¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ•°æ®æŸåã€‚</p>
<h3 data-id="heading-16">3.4. æ³¨æ„äº‹é¡¹</h3>
<blockquote>
<ul>
<li>
<p><strong>æœªåˆå§‹åŒ–çš„****å†…å­˜</strong>ï¼š<code>malloc</code>åˆ†é…çš„å†…å­˜ä¸ä¼šè‡ªåŠ¨åˆå§‹åŒ–ï¼Œå…¶å†…å®¹æ˜¯æœªå®šä¹‰çš„ã€‚å¦‚æœéœ€è¦ï¼Œåº”æ‰‹åŠ¨åˆå§‹åŒ–åˆ†é…çš„å†…å­˜ã€‚</p>
</li>
<li>
<p><strong>é¿å…å†…å­˜æ³„æ¼</strong>ï¼šæ¯æ¬¡ä½¿ç”¨<code>malloc</code>åˆ†é…å†…å­˜åï¼Œéƒ½åº”åœ¨é€‚å½“çš„æ—¶å€™ä½¿ç”¨<code>free</code>é‡Šæ”¾å®ƒï¼Œä»¥é¿å…å†…å­˜æ³„æ¼ã€‚</p>
</li>
<li>
<p><strong>æŒ‡é’ˆæœ‰æ•ˆæ€§</strong>ï¼šåœ¨é‡Šæ”¾å†…å­˜åï¼Œä¸è¦å°è¯•è®¿é—®å·²é‡Šæ”¾çš„å†…å­˜å—ï¼Œä¹Ÿä¸è¦ä½¿ç”¨æŒ‡å‘å·²é‡Šæ”¾å†…å­˜çš„æŒ‡é’ˆã€‚</p>
</li>
<li>
<p><strong>å†…å­˜****å¯¹é½å’Œå¤§å°</strong>ï¼š<code>malloc</code>åˆ†é…çš„å†…å­˜å—å¤§å°é€šå¸¸æ˜¯ç³»ç»Ÿå†…å­˜é¡µå¤§å°çš„æ•´æ•°å€ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é¢å¤–çš„å†…å­˜å¼€é”€ã€‚</p>
</li>
</ul>
</blockquote>
<h2 data-id="heading-17">å››ã€å‡½æ•°æŒ‡é’ˆ</h2>
<p>åœ¨Cè¯­è¨€ä¸­ï¼Œå‡½æ•°æŒ‡é’ˆæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æŒ‡é’ˆï¼Œå®ƒæŒ‡å‘å‡½æ•°è€Œä¸æ˜¯å˜é‡ã€‚é€šè¿‡å‡½æ•°æŒ‡é’ˆï¼Œç¨‹åºå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°é€‰æ‹©è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œè¿™ç§æœºåˆ¶åœ¨<strong>å›è°ƒå‡½æ•°****ã€äº‹ä»¶å¤„ç†ã€ä»¥åŠå®ç°å‡½æ•°è¡¨</strong>ï¼ˆä¹Ÿç§°ä¸ºè™šå‡½æ•°è¡¨æˆ–vtableï¼Œåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­æ¨¡æ‹Ÿå¤šæ€æ€§ï¼‰ç­‰åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚</p>
<h3 data-id="heading-18">4.1. å‡½æ•°æŒ‡é’ˆçš„å®šä¹‰</h3>
<p>å‡½æ•°æŒ‡é’ˆçš„å®šä¹‰æ–¹å¼ä¸æ™®é€šæŒ‡é’ˆç±»ä¼¼ï¼Œä½†éœ€è¦æŒ‡å®šæŒ‡é’ˆæ‰€æŒ‡å‘çš„å‡½æ•°çš„è¿”å›ç±»å‹å’Œå‚æ•°ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè¿”å›<code>int</code>ç±»å‹å¹¶æ¥å—ä¸¤ä¸ª<code>int</code>ç±»å‹å‚æ•°çš„å‡½æ•°ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªæŒ‡å‘è¿™ç§å‡½æ•°çš„æŒ‡é’ˆå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> (*func_ptr)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>);
</code></pre>
<p><code>func_ptr</code>æ˜¯ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆï¼Œè¯¥å‡½æ•°è¿”å›<code>int</code>ç±»å‹ï¼Œå¹¶æ¥å—ä¸¤ä¸ª<code>int</code>ç±»å‹çš„å‚æ•°ã€‚</p>
<h3 data-id="heading-19">4.2. å‡½æ•°æŒ‡é’ˆçš„èµ‹å€¼</h3>
<p>è¦å°†ä¸€ä¸ªå‡½æ•°çš„åœ°å€èµ‹å€¼ç»™å‡½æ•°æŒ‡é’ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‡½æ•°åï¼ˆåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå‡½æ•°åä¼šè¢«ç¼–è¯‘å™¨è§£é‡Šä¸ºå‡½æ•°çš„åœ°å€ï¼‰ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-built_in">int</span> <span class="hljs-title">add</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> a, <span class="hljs-built_in">int</span> b</span>)</span> {  
    <span class="hljs-keyword">return</span> a + b;  
}  
  
<span class="hljs-function"><span class="hljs-built_in">int</span> <span class="hljs-title">main</span>()</span> {  
    <span class="hljs-built_in">int</span> (*func_ptr)(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>);  
    func_ptr = <span class="hljs-keyword">add</span>; <span class="hljs-comment">// å°†addå‡½æ•°çš„åœ°å€èµ‹å€¼ç»™func_ptr  </span>
    <span class="hljs-built_in">int</span> result = func_ptr(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>); <span class="hljs-comment">// é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨addå‡½æ•°  </span>
    printf(<span class="hljs-string">"Result: %d\n"</span>, result); <span class="hljs-comment">// è¾“å‡º: Result: 8  </span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  
}
</code></pre>
<p><strong>è¿è¡Œç»“æœï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3ba85dabbb841efbc217a227550a8c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0Zei9u-mqkeWFtQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770858627&amp;x-signature=9d%2FPkwnBrAjGXBLer7NIziuoXRc%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-20">4.3. é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°</h3>
<p>ä¸€æ—¦å‡½æ•°æŒ‡é’ˆè¢«èµ‹å€¼ï¼Œå°±å¯ä»¥é€šè¿‡å®ƒæ¥è°ƒç”¨å‡½æ•°ã€‚è°ƒç”¨æ–¹å¼ä¸æ™®é€šå‡½æ•°è°ƒç”¨ç±»ä¼¼ï¼Œä½†éœ€è¦ä½¿ç”¨å‡½æ•°æŒ‡é’ˆçš„è§£å¼•ç”¨æ“ä½œï¼ˆå³ä½¿ç”¨<code>(*func_ptr)(...)</code>ï¼‰æˆ–è€…ç›´æ¥ä½¿ç”¨å‡½æ•°æŒ‡é’ˆåï¼ˆå¦‚æœä¸Šä¸‹æ–‡å…è®¸çš„è¯ï¼ŒCè¯­è¨€å…è®¸åœ¨å‡½æ•°è°ƒç”¨è¡¨è¾¾å¼ä¸­çœç•¥è§£å¼•ç”¨æ“ä½œï¼‰ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">int</span> result = (*func_ptr)(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>); <span class="hljs-regexp">//</span> ä½¿ç”¨è§£å¼•ç”¨æ“ä½œè°ƒç”¨å‡½æ•°  // æˆ–è€…  <span class="hljs-keyword">int</span> result = func_ptr(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>); <span class="hljs-regexp">//</span> åœ¨å‡½æ•°è°ƒç”¨è¡¨è¾¾å¼ä¸­çœç•¥è§£å¼•ç”¨æ“ä½œ
</code></pre>
<h3 data-id="heading-21">4.4. å›è°ƒå‡½æ•°</h3>
<p>å›è°ƒå‡½æ•°æ˜¯ä¸€ç§é€šè¿‡å‡½æ•°æŒ‡é’ˆå®ç°çš„æœºåˆ¶ï¼Œå®ƒå…è®¸ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶åœ¨åè€…å†…éƒ¨è¢«è°ƒç”¨ã€‚è¿™ç§æœºåˆ¶åœ¨äº‹ä»¶å¤„ç†ã€å¼‚æ­¥ç¼–ç¨‹ç­‰åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span>  </span>
  
<span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå›è°ƒå‡½æ•°ç±»å‹  </span>
<span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span> <span class="hljs-params">(*CallbackFunc)</span><span class="hljs-params">(<span class="hljs-type">int</span>)</span></span>;  
  
<span class="hljs-comment">// ä¸€ä¸ªç®€å•çš„å›è°ƒå‡½æ•°å®ç°  </span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">multiplyByTwo</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> </span>{  
    <span class="hljs-keyword">return</span> x * <span class="hljs-number">2</span>;  
}  
  
<span class="hljs-comment">// æ¥å—å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°  </span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">processWithCallback</span><span class="hljs-params">(<span class="hljs-type">int</span> value, CallbackFunc callback)</span> </span>{  
    <span class="hljs-type">int</span> result = <span class="hljs-built_in">callback</span>(value);  
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Result: %d\n"</span>, result);  
}  
  
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{  
    <span class="hljs-built_in">processWithCallback</span>(<span class="hljs-number">5</span>, multiplyByTwo); <span class="hljs-comment">// ä¼ é€’å›è°ƒå‡½æ•°ç»™processWithCallback  </span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  
}
</code></pre>
<p><code>multiplyByTwo</code>æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå®ƒè¢«ä¼ é€’ç»™<code>processWithCallback</code>å‡½æ•°ï¼Œå¹¶åœ¨åè€…å†…éƒ¨è¢«è°ƒç”¨ã€‚</p>
<p><strong>è¿è¡Œç»“æœï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb3c6529523d4ff09ff5f2d327a983ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0Zei9u-mqkeWFtQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770858627&amp;x-signature=DMggQvGRsqs2lRtr9sVgNiWnbXU%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-22">4.5. å‡½æ•°æŒ‡é’ˆæ•°ç»„å’Œå‡½æ•°ï¼ˆè™šå‡½æ•°è¡¨ï¼‰</h3>
<p>å‡½æ•°æŒ‡é’ˆä¹Ÿå¯ä»¥å­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œä»è€Œå½¢æˆä¸€ä¸ªå‡½æ•°è¡¨ã€‚é€šè¿‡ç´¢å¼•å‡½æ•°è¡¨ï¼Œå¯ä»¥æ ¹æ®éœ€è¦åœ¨è¿è¡Œæ—¶é€‰æ‹©è°ƒç”¨å“ªä¸ªå‡½æ•°ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span>  </span>
  
<span class="hljs-comment">// å®šä¹‰ä¸¤ä¸ªå‡½æ•°ï¼Œå®ƒä»¬å…·æœ‰ç›¸åŒçš„è¿”å›ç±»å‹å’Œå‚æ•°ç±»å‹  </span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">operation1</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> </span>{  
    <span class="hljs-keyword">return</span> a * b;  
}  
  
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">operation2</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> </span>{  
    <span class="hljs-keyword">return</span> a - b;  
}  
  
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{  
    <span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„  </span>
    <span class="hljs-built_in">int</span> (*operations[])(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>) = {operation1, operation2};  
    <span class="hljs-type">int</span> num1 = <span class="hljs-number">6</span>, num2 = <span class="hljs-number">4</span>;  
    <span class="hljs-type">int</span> choice;  
  
    <span class="hljs-comment">// è®©ç”¨æˆ·é€‰æ‹©æ“ä½œ  </span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Choose an operation:\n"</span>);  
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"1. Multiply\n"</span>);  
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"2. Subtract\n"</span>);  
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;choice);  
  
    <span class="hljs-comment">// æ ¹æ®ç”¨æˆ·çš„é€‰æ‹©è°ƒç”¨ç›¸åº”çš„å‡½æ•°  </span>
    <span class="hljs-keyword">if</span> (choice == <span class="hljs-number">1</span>) {  
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Result: %d\n"</span>, operations[<span class="hljs-number">0</span>](num1, num2)); <span class="hljs-comment">// è°ƒç”¨operation1  </span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (choice == <span class="hljs-number">2</span>) {  
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Result: %d\n"</span>, operations[<span class="hljs-number">1</span>](num1, num2)); <span class="hljs-comment">// è°ƒç”¨operation2  </span>
    } <span class="hljs-keyword">else</span> {  
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Invalid choice!\n"</span>);  
    }  
  
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  
}
</code></pre>
<p>å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°<code>operation1</code>å’Œ<code>operation2</code>ï¼Œåˆ†åˆ«æ‰§è¡Œä¹˜æ³•å’Œå‡æ³•æ“ä½œã€‚ç„¶åï¼Œåˆ›å»ºäº†ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„<code>operations</code>ï¼Œå¹¶å°†è¿™ä¸¤ä¸ªå‡½æ•°çš„åœ°å€å­˜å‚¨åœ¨å…¶ä¸­ã€‚æœ€åï¼Œæ ¹æ®ç”¨æˆ·çš„è¾“å…¥é€‰æ‹©å¹¶è°ƒç”¨äº†ç›¸åº”çš„å‡½æ•°ã€‚</p>
<p><strong>è¿è¡Œç»“æœï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2a6135fbef74cb1953d6147cde1a1d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0Zei9u-mqkeWFtQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770858627&amp;x-signature=cyoexS766ADoi4fOOBbLU4jnu6g%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69af67bd9ccd41f7b58f8c904dd22c51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0Zei9u-mqkeWFtQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770858627&amp;x-signature=eJQ1d6Yq9tcU1wpGBYCYU8KCyNw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-23">4.6. æ³¨æ„äº‹é¡¹</h3>
<blockquote>
<ul>
<li>
<p>å½“ä½¿ç”¨å‡½æ•°æŒ‡é’ˆæ—¶ï¼Œç¡®ä¿å‡½æ•°æŒ‡é’ˆçš„ç±»å‹ä¸æ‰€æŒ‡å‘çš„å‡½æ•°çš„ç±»å‹å®Œå…¨åŒ¹é…ï¼ŒåŒ…æ‹¬è¿”å›ç±»å‹ã€å‚æ•°ç±»å‹å’Œæ•°é‡ã€‚</p>
</li>
<li>
<p>åœ¨è°ƒç”¨é€šè¿‡å‡½æ•°æŒ‡é’ˆæŒ‡å‘çš„å‡½æ•°æ—¶ï¼Œä½¿ç”¨æ­£ç¡®çš„å‚æ•°ç±»å‹å’Œæ•°é‡ã€‚</p>
</li>
<li>
<p>åœ¨é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼ˆå¦‚æœå‡½æ•°æŒ‡é’ˆæ˜¯ä½œä¸ºåŠ¨æ€åˆ†é…ç»“æ„ä½“çš„ä¸€éƒ¨åˆ†ï¼‰æ—¶ï¼Œç¡®ä¿ä¸ä¼šæ„å¤–åœ°é‡Šæ”¾å‡½æ•°æŒ‡é’ˆæœ¬èº«ï¼ˆå› ä¸ºå‡½æ•°æŒ‡é’ˆé€šå¸¸ä¸æŒ‡å‘åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œè€Œæ˜¯æŒ‡å‘ç¼–è¯‘æ—¶ç¡®å®šçš„å‡½æ•°åœ°å€ï¼‰ã€‚</p>
</li>
</ul>
</blockquote>
<h2 data-id="heading-24">äº”ã€æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼ˆäºŒçº§æŒ‡é’ˆï¼‰è¯¦è§£</h2>
<p>åœ¨Cè¯­è¨€ä¸­ï¼ŒæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œä¹Ÿç§°ä¸ºäºŒçº§æŒ‡é’ˆæˆ–æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„æŒ‡é’ˆç±»å‹ï¼Œå®ƒå­˜å‚¨çš„æ˜¯å¦ä¸€ä¸ªæŒ‡é’ˆå˜é‡çš„åœ°å€ã€‚é€šè¿‡ä½¿ç”¨äºŒçº§æŒ‡é’ˆï¼Œç¨‹åºå‘˜å¯ä»¥ç›´æ¥æ“ä½œæŒ‡é’ˆçš„åœ°å€ï¼Œè¿™åœ¨å¤„ç†åŠ¨æ€å†…å­˜åˆ†é…ã€æ•°ç»„ã€é“¾è¡¨ç­‰é«˜çº§æ•°æ®ç»“æ„æ—¶éå¸¸æœ‰ç”¨ã€‚</p>
<h3 data-id="heading-25">5.1. äºŒçº§æŒ‡é’ˆçš„å®šä¹‰</h3>
<p>äºŒçº§æŒ‡é’ˆçš„å®šä¹‰æ–¹å¼ä¸æ™®é€šæŒ‡é’ˆç±»ä¼¼ï¼Œä½†éœ€è¦æŒ‡å®šæŒ‡é’ˆæ‰€æŒ‡å‘çš„å¦ä¸€ä¸ªæŒ‡é’ˆçš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæŒ‡å‘<code>int</code>ç±»å‹æŒ‡é’ˆçš„äºŒçº§æŒ‡é’ˆï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰å®ƒï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">int</span> **ptr_to_ptr;
</code></pre>
<p><code>ptr_to_ptr</code>æ˜¯ä¸€ä¸ªæŒ‡å‘<code>int*</code>ç±»å‹ï¼ˆå³æŒ‡å‘<code>int</code>ç±»å‹æŒ‡é’ˆï¼‰çš„æŒ‡é’ˆã€‚</p>
<h3 data-id="heading-26">5.2. äºŒçº§æŒ‡é’ˆçš„ä½¿ç”¨</h3>
<ul>
<li>
<p><strong>åŠ¨æ€å†…å­˜åˆ†é…</strong>ï¼šäºŒçº§æŒ‡é’ˆå¸¸ç”¨äºåŠ¨æ€å†…å­˜åˆ†é…ï¼Œç‰¹åˆ«æ˜¯å½“éœ€è¦åˆ†é…ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„æ—¶ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨äºŒçº§æŒ‡é’ˆæ¥åŠ¨æ€åˆ†é…ä¸€ä¸ªæ•´å‹æŒ‡é’ˆæ•°ç»„ï¼Œæ¯ä¸ªæŒ‡é’ˆéƒ½å¯ä»¥æŒ‡å‘ä¸€ä¸ªæ•´å‹æ•°ç»„ã€‚</p>
</li>
<li>
<p><strong>é“¾è¡¨****æ“ä½œ</strong>ï¼šåœ¨å¤„ç†é“¾è¡¨æ—¶ï¼ŒäºŒçº§æŒ‡é’ˆä¹Ÿéå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬éœ€è¦åœ¨é“¾è¡¨ä¸­æ’å…¥æˆ–åˆ é™¤èŠ‚ç‚¹æ—¶ï¼Œéœ€è¦ä¿®æ”¹å‰ä¸€ä¸ªèŠ‚ç‚¹çš„<code>next</code>æŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘æ–°çš„èŠ‚ç‚¹æˆ–è·³è¿‡è¢«åˆ é™¤çš„èŠ‚ç‚¹ã€‚è¿™æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªäºŒçº§æŒ‡é’ˆæ¥æ–¹ä¾¿åœ°ä¿®æ”¹è¿™ä¸ª<code>next</code>æŒ‡é’ˆã€‚</p>
</li>
<li>
<p><strong>ä¼ é€’æŒ‡é’ˆçš„åœ°å€</strong>ï¼šæœ‰æ—¶ï¼Œéœ€è¦å°†æŒ‡é’ˆçš„åœ°å€ä¼ é€’ç»™å‡½æ•°ï¼Œä»¥ä¾¿åœ¨å‡½æ•°å†…éƒ¨ä¿®æ”¹è¿™ä¸ªæŒ‡é’ˆã€‚è¿™æ—¶ï¼Œå¯ä»¥ä½¿ç”¨äºŒçº§æŒ‡é’ˆä½œä¸ºå‡½æ•°å‚æ•°ã€‚</p>
</li>
</ul>
<h3 data-id="heading-27">5.3. ä»£ç ç¤ºä¾‹</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨äºŒçº§æŒ‡é’ˆæ¥åŠ¨æ€åˆ†é…ä¸€ä¸ªæ•´å‹æŒ‡é’ˆæ•°ç»„ï¼Œå¹¶åˆå§‹åŒ–æ¯ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæ•´å‹å€¼ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span>  </span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span>  </span>
  
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {  
    <span class="hljs-type">int</span> n = <span class="hljs-number">3</span>; <span class="hljs-comment">// è¦åˆ†é…çš„æ•´å‹æŒ‡é’ˆçš„æ•°é‡  </span>
    <span class="hljs-type">int</span> **array_of_pointers = (<span class="hljs-type">int</span> **)<span class="hljs-built_in">malloc</span>(n * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span> *)); <span class="hljs-comment">// åŠ¨æ€åˆ†é…æ•´å‹æŒ‡é’ˆæ•°ç»„  </span>
    <span class="hljs-keyword">if</span> (array_of_pointers == <span class="hljs-literal">NULL</span>) {  
        <span class="hljs-comment">// å¤„ç†å†…å­˜åˆ†é…å¤±è´¥çš„æƒ…å†µ  </span>
        <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">"Memory allocation failed\n"</span>);  
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;  
    }  
  
    <span class="hljs-comment">// ä¸ºæ¯ä¸ªæŒ‡é’ˆåˆ†é…å†…å­˜å¹¶åˆå§‹åŒ–  </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {  
        array_of_pointers[i] = (<span class="hljs-type">int</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));  
        <span class="hljs-keyword">if</span> (array_of_pointers[i] == <span class="hljs-literal">NULL</span>) {  
            <span class="hljs-comment">// å¤„ç†å†…å­˜åˆ†é…å¤±è´¥çš„æƒ…å†µï¼Œå¹¶é‡Šæ”¾ä¹‹å‰åˆ†é…çš„å†…å­˜  </span>
            <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">"Memory allocation failed at index %d\n"</span>, i);  
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; i; j++) {  
                <span class="hljs-built_in">free</span>(array_of_pointers[j]);  
            }  
            <span class="hljs-built_in">free</span>(array_of_pointers);  
            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;  
        }  
        array_of_pointers[i][<span class="hljs-number">0</span>] = i * <span class="hljs-number">10</span>; <span class="hljs-comment">// åˆå§‹åŒ–æ¯ä¸ªæ•´å‹å€¼ä¸ºi*10  </span>
    }  
  
    <span class="hljs-comment">// æ‰“å°æ¯ä¸ªæ•´å‹å€¼  </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {  
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"array_of_pointers[%d] = %d\n"</span>, i, array_of_pointers[i][<span class="hljs-number">0</span>]);  
    }  
  
    <span class="hljs-comment">// é‡Šæ”¾å†…å­˜  </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {  
        <span class="hljs-built_in">free</span>(array_of_pointers[i]);  
    }  
    <span class="hljs-built_in">free</span>(array_of_pointers);  
  
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  
}
</code></pre>
<p>é¦–å…ˆåŠ¨æ€åˆ†é…äº†ä¸€ä¸ªæ•´å‹æŒ‡é’ˆæ•°ç»„<code>array_of_pointers</code>ï¼Œç„¶åä¸ºæ¯ä¸ªæŒ‡é’ˆåˆ†é…äº†å†…å­˜ï¼Œå¹¶åˆå§‹åŒ–äº†å®ƒä»¬æŒ‡å‘çš„æ•´å‹å€¼ã€‚æœ€åï¼Œæˆ‘ä»¬æ‰“å°äº†æ¯ä¸ªæ•´å‹å€¼ï¼Œå¹¶é‡Šæ”¾äº†æ‰€æœ‰åˆ†é…çš„å†…å­˜ã€‚</p>
<p><strong>è¿è¡Œç»“æœï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57c779175e274f4bb627973a31f5e147~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0Zei9u-mqkeWFtQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770858627&amp;x-signature=yQcAjmc0np20UEA%2FX2ot0zL8P9U%3D" alt="" loading="lazy"/></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨<code>malloc</code>åˆ†é…å†…å­˜åï¼Œåº”è¯¥å§‹ç»ˆæ£€æŸ¥è¿”å›å€¼æ˜¯å¦ä¸º<code>NULL</code>ï¼Œä»¥ç¡®ä¿å†…å­˜åˆ†é…æˆåŠŸã€‚æ­¤å¤–ï¼Œåœ¨é‡Šæ”¾å†…å­˜æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥æŒ‰ç…§ä¸åˆ†é…ç›¸åçš„é¡ºåºæ¥é‡Šæ”¾ï¼Œä»¥é¿å…å†…å­˜æ³„æ¼ã€‚</p>
<h2 data-id="heading-28">å…­ã€æµ‹è¯•</h2>
<blockquote>
<p><strong>é—®é¢˜</strong>ï¼šCè¯­è¨€æŒ‡é’ˆç®—æœ¯è¿ç®—çš„æ ¸å¿ƒç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿä½¿ç”¨æ—¶éœ€éµå®ˆå“ªäº›è§„åˆ™ï¼Ÿ<strong>ï¼ˆæŸäº’è”ç½‘å…¬å¸2024æ ¡æ‹›ï¼‰</strong></p>
</blockquote>
<p><strong>ç­”æ¡ˆ</strong>ï¼š</p>
<p>æ ¸å¿ƒç‰¹æ€§æ˜¯æŒ‰æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ç±»å‹å¤§å°åç§»ï¼ˆå¦‚intæŒ‡é’ˆ+1åç§»4å­—èŠ‚ï¼‰ï¼›</p>
<p>è§„åˆ™ï¼šä»…å¯¹åŒç±»å‹æŒ‡é’ˆæœ‰æ•ˆï¼Œç¦æ­¢è®¿é—®éæ³•å†…å­˜åœ°å€ã€‚</p>
<blockquote>
<p><strong>é—®é¢˜</strong>ï¼šå‡½æ•°æŒ‡é’ˆçš„å®šä¹‰æ ¼å¼æ˜¯ä»€ä¹ˆï¼Ÿå›è°ƒå‡½æ•°çš„å®ç°æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ<strong>ï¼ˆæŸç¡¬ä»¶å…¬å¸2023ç¤¾æ‹›ï¼‰</strong></p>
</blockquote>
<p><strong>ç­”æ¡ˆ</strong>ï¼š</p>
<p>å®šä¹‰æ ¼å¼ï¼š<code>è¿”å›å€¼ç±»å‹ (*æŒ‡é’ˆå)(å‚æ•°ç±»å‹åˆ—è¡¨)</code>ï¼ˆå¦‚<code>int (*func_ptr)(int, int)</code>ï¼‰ï¼›</p>
<p>å®ç°æœ¬è´¨ï¼šå°†å‡½æ•°åœ°å€ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œåœ¨ç›®æ ‡å‡½æ•°å†…åŠ¨æ€è°ƒç”¨ã€‚</p>
<blockquote>
<p><strong>é—®é¢˜</strong>ï¼šäºŒçº§æŒ‡é’ˆåœ¨åŠ¨æ€å†…å­˜åˆ†é…ä¸­ä¸»è¦ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿé‡Šæ”¾å†…å­˜çš„é¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p><strong>ç­”æ¡ˆ</strong>ï¼š</p>
<p>åœºæ™¯ï¼šåŠ¨æ€åˆ›å»ºæŒ‡é’ˆæ•°ç»„ï¼ˆå¦‚<code>int**</code>æŒ‡å‘å¤šä¸ª<code>int*</code>ï¼‰ï¼›</p>
<p>é‡Šæ”¾é¡ºåºï¼šå…ˆé‡Šæ”¾æ¯ä¸ªå­æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ï¼Œæœ€åé‡Šæ”¾äºŒçº§æŒ‡é’ˆæœ¬èº«ã€‚</p>
<blockquote>
<p><strong>é—®é¢˜</strong>ï¼šæŒ‡é’ˆåŠ 1çš„å®é™…åœ°å€å¢é‡ç”±ä»€ä¹ˆå†³å®šï¼Ÿï¼ˆ2023è…¾è®¯Cè¯­è¨€å¼€å‘å²—çœŸé¢˜ï¼‰</p>
</blockquote>
<p>**ç­”æ¡ˆï¼š**ç”±æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ç±»å‹å¤§å°å†³å®šï¼ˆå³<code>sizeof(ç±»å‹)</code>ï¼‰ã€‚å¦‚<code>int*</code>åŠ 1å¢4å­—èŠ‚ï¼ˆ<code>sizeof(int)=4</code>ï¼‰ã€‚</p>
<blockquote>
<p><strong><code>é—®é¢˜ï¼š</code></strong><code>malloc</code>åˆ†é…çš„å†…å­˜æœªåˆå§‹åŒ–ï¼Œå¦‚ä½•æ¸…é›¶ï¼Ÿï¼ˆ2022é˜¿é‡Œåç«¯å¼€å‘çœŸé¢˜ï¼‰</p>
</blockquote>
<p><strong>ç­”æ¡ˆï¼š</strong></p>
<p>ç”¨<code>calloc</code>ï¼ˆè‡ªåŠ¨æ¸…é›¶ï¼‰æˆ–<code>memset(ptr, 0, size)</code>ï¼Œæˆ–æ‰‹åŠ¨èµ‹å€¼ã€‚</p>
<blockquote>
<p><strong>é—®é¢˜</strong>ï¼šå‡½æ•°æŒ‡é’ˆçš„å®šä¹‰åŠè°ƒç”¨æ–¹å¼ï¼Ÿï¼ˆ2021ç™¾åº¦C++å²—æ¨¡æ‹Ÿé¢˜ï¼‰</p>
</blockquote>
<p><strong>ç­”æ¡ˆï¼š</strong></p>
<p>å®šä¹‰å¦‚<code>int (*fp)(int,int);</code>ï¼›èµ‹å€¼<code>fp=func</code>ï¼›è°ƒç”¨ç”¨<code>fp(a,b)</code>æˆ–<code>(*fp)(a,b)</code>ã€‚</p>
<blockquote>
<p><strong>é¢˜ç›®</strong>ï¼šCè¯­è¨€ä¸­ï¼Œå‡½æ•°æŒ‡é’ˆå’Œå›è°ƒå‡½æ•°æœ‰ä»€ä¹ˆåº”ç”¨ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜ã€‚</p>
</blockquote>
<p><strong>ç­”æ¡ˆ</strong>ï¼š</p>
<p>å‡½æ•°æŒ‡é’ˆç”¨äºå®ç°å›è°ƒæœºåˆ¶ï¼Œå…è®¸å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œå¸¸è§äºäº‹ä»¶å¤„ç†ã€å¼‚æ­¥ç¼–ç¨‹å’Œç®—æ³•æŠ½è±¡ï¼ˆå¦‚<code>qsort</code>çš„æ¯”è¾ƒå‡½æ•°ï¼‰ã€‚ä¾‹å¦‚ï¼Œå›¾å½¢åº“ä¸­å¯ä¼ å…¥ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„ç»˜å›¾å‡½æ•°æŒ‡é’ˆï¼Œç”±ç³»ç»Ÿåœ¨ç‰¹å®šäº‹ä»¶æ—¶è°ƒç”¨ã€‚</p>
<blockquote>
<p><strong>é¢˜ç›®</strong>ï¼šå¦‚ä½•ä½¿ç”¨äºŒçº§æŒ‡é’ˆï¼ˆ<code>int **p</code>ï¼‰åŠ¨æ€åˆ†é…ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Ÿå¹¶è¯´æ˜åœ¨é‡Šæ”¾å†…å­˜æ—¶åº”æ³¨æ„ä»€ä¹ˆã€‚</p>
</blockquote>
<p><strong>ç­”æ¡ˆ</strong>ï¼š</p>
<p>é¦–å…ˆä¸ºâ€œè¡ŒæŒ‡é’ˆæ•°ç»„â€åˆ†é…å†…å­˜ï¼š<code>int **p = (int**)malloc(row * sizeof(int*))</code>ï¼›ç„¶åä¸ºæ¯ä¸€è¡Œåˆ†é…å†…å­˜ï¼š<code>for(i=0; i&lt;row; i++) p[i] = (int*)malloc(col * sizeof(int))</code>ã€‚é‡Šæ”¾æ—¶é¡ºåºç›¸åï¼šå…ˆå¾ªç¯é‡Šæ”¾æ¯ä¸€è¡Œ<code>free(p[i])</code>ï¼Œå†é‡Šæ”¾è¡ŒæŒ‡é’ˆæ•°ç»„<code>free(p)</code>ï¼Œä»¥é˜²æ­¢å†…å­˜æ³„æ¼ã€‚</p>
<blockquote>
<p><strong>é¢˜ç›®</strong>ï¼šè§£é‡Šä»¥ä¸‹ä»£ç ä¸­<code>ptr++</code>å’Œ<code>(*ptr)++</code>çš„åŒºåˆ«ã€‚<code>int arr[] = {1,2,3}; int *ptr = arr;</code></p>
</blockquote>
<p><strong>ç­”æ¡ˆ</strong>ï¼š</p>
<p><code>ptr++</code>æ˜¯æŒ‡é’ˆç®—æœ¯è¿ç®—ï¼Œä½¿æŒ‡é’ˆ<code>ptr</code>å‘åç§»åŠ¨ä¸€ä¸ª<code>int</code>ç±»å‹å¤§å°çš„å†…å­˜å•å…ƒï¼ŒæŒ‡å‘æ•°ç»„çš„ä¸‹ä¸€ä¸ªå…ƒç´ <code>arr[1]</code>ã€‚<code>(*ptr)++</code>æ˜¯è§£å¼•ç”¨åå¯¹æ‰€æŒ‡æ•°æ®è¿›è¡Œè‡ªå¢ï¼Œå³å°†<code>arr[0]</code>çš„å€¼ä»1å¢åŠ ä¸º2ï¼Œä½†<code>ptr</code>æœ¬èº«æŒ‡å‘çš„åœ°å€ä¸å˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ†åº“åˆ†è¡¨ä¸‹çš„åˆ†é¡µæŸ¥è¯¢ï¼Œåˆ°åº•è¯¥æ€ä¹ˆæï¼Ÿï¼ˆå®æˆ˜å®Œæ•´ç‰ˆï¼‰]]></title>    <link>https://juejin.cn/post/7602841282802876457</link>    <guid>https://juejin.cn/post/7602841282802876457</guid>    <pubDate>2026-02-05T01:09:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602841282802876457" data-draft-id="7602807243705401407" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ†åº“åˆ†è¡¨ä¸‹çš„åˆ†é¡µæŸ¥è¯¢ï¼Œåˆ°åº•è¯¥æ€ä¹ˆæï¼Ÿï¼ˆå®æˆ˜å®Œæ•´ç‰ˆï¼‰"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2026-02-05T01:09:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="whatä¸¶k"/> <meta itemprop="url" content="https://juejin.cn/user/2578801884147418"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ†åº“åˆ†è¡¨ä¸‹çš„åˆ†é¡µæŸ¥è¯¢ï¼Œåˆ°åº•è¯¥æ€ä¹ˆæï¼Ÿï¼ˆå®æˆ˜å®Œæ•´ç‰ˆï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2578801884147418/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    whatä¸¶k
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:09:53.000Z" title="Thu Feb 05 2026 01:09:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨åç«¯å¼€å‘ä¸­ï¼Œåˆ†åº“åˆ†è¡¨æ˜¯è§£å†³å•åº“å•è¡¨æ•°æ®é‡çˆ†ç‚¸ã€å¹¶å‘ç“¶é¢ˆçš„å¿…ç»ä¹‹è·¯ã€‚ä½†éšä¹‹è€Œæ¥çš„ï¼Œæ˜¯ä¸€ç³»åˆ—â€œç®€å•åŠŸèƒ½å˜å¤æ‚â€çš„å‘â€”â€”åˆ†é¡µæŸ¥è¯¢å°±æ˜¯æœ€å…¸å‹çš„ä¸€ä¸ªã€‚</p>
<p>å•åº“å•è¡¨æ—¶ä»£ï¼Œæˆ‘ä»¬ç”¨ <code>LIMIT offset, size</code> å°±èƒ½è½»æ¾å®ç°åˆ†é¡µï¼Œæ¯”å¦‚æŸ¥è¯¢ç¬¬11é¡µï¼ˆæ¯é¡µ10æ¡ï¼‰ï¼Œä¸€å¥ <code>SELECT * FROM t_order ORDER BY create_time DESC LIMIT 100, 10</code> å°±èƒ½æå®šï¼Œæ•°æ®åº“å¼•æ“èƒ½é€šè¿‡ç´¢å¼•å¿«é€Ÿå®šä½å…¨å±€æœ‰åºæ•°æ®ï¼Œæ€§èƒ½ç¨³å®šã€‚</p>
<p>å¯å½“æ•°æ®è¢«æ‹†åˆ†åˆ°å¤šä¸ªåº“ã€å¤šä¸ªè¡¨åï¼Œè¿™å¥ç®€å•çš„SQLå°±å½»åº•â€œå¤±çµâ€äº†ï¼šè¦ä¹ˆæŸ¥å‡ºæ¥çš„æ•°æ®é‡å¤ã€ç¼ºå¤±ï¼Œè¦ä¹ˆæ·±åº¦åˆ†é¡µæ—¶æ€§èƒ½é›ªå´©ï¼Œç”šè‡³å‡ºç°æ’åºé”™ä¹±ã€‚å¾ˆå¤šå¼€å‘è€…å¡åœ¨è¿™é‡Œåå¤è°ƒè¯•ï¼Œå´å§‹ç»ˆæ‰¾ä¸åˆ°ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±å½»åº•æŠŠè¿™ä¸ªé—®é¢˜è®²é€â€”â€”ä»é—®é¢˜æ ¹æºå‡ºå‘ï¼Œæ‹†è§£4ç§ä¸»æµå®æˆ˜æ–¹æ¡ˆï¼Œåˆ†æå„è‡ªçš„ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯ï¼Œå†æ€»ç»“é¿å‘æŠ€å·§ï¼Œå¸®ä½ åœ¨å®é™…ä¸šåŠ¡ä¸­å¿«é€Ÿé€‰å‹ã€è½åœ°ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆææ‡‚ï¼šåˆ†åº“åˆ†è¡¨åï¼Œåˆ†é¡µæŸ¥è¯¢ä¸ºä»€ä¹ˆä¼šâ€œä¹±â€ï¼Ÿ</h2>
<p>åˆ†é¡µæŸ¥è¯¢å˜éš¾çš„æ ¸å¿ƒæ ¹æºï¼Œä¸æ˜¯â€œæ•°æ®å¤šâ€ï¼Œè€Œæ˜¯<strong>åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„å…¨å±€æœ‰åºæ€§ç¼ºå¤±</strong>â€”â€”å•åº“å•è¡¨ä¸­ï¼Œæ•°æ®åº“ç»´æŠ¤ç€å…¨å±€æœ‰åºç´¢å¼•ï¼ˆæ¯”å¦‚ <code>create_time</code> ä¸Šçš„B+æ ‘ï¼‰ï¼Œ<code>offset</code> å’Œ <code>size</code>æ˜¯åŸºäºå…¨å±€æ•°æ®çš„æˆªå–ï¼›ä½†åˆ†åº“åˆ†è¡¨åï¼Œæ¯ä¸ªåˆ†ç‰‡éƒ½æ˜¯ç‹¬ç«‹çš„æ•°æ®åº“å®ä¾‹ï¼Œä»…ç»´æŠ¤æœ¬åœ°æ•°æ®çš„æœ‰åºæ€§ï¼Œç¼ºä¹â€œå…¨å±€æœ‰åºè§†å›¾â€ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œä¼šé‡åˆ°3ä¸ªæ ¸å¿ƒé—®é¢˜ï¼Œæ¯ä¸€ä¸ªéƒ½èƒ½ç›´æ¥å½±å“ä¸šåŠ¡ä½“éªŒï¼š</p>
<h3 data-id="heading-1">1. æ·±åº¦åˆ†é¡µæ€§èƒ½æš´è·Œï¼ˆæœ€å¸¸è§ç—›ç‚¹ï¼‰</h3>
<p>å½“ <code>offset</code> è¿‡å¤§æ—¶ï¼ˆæ¯”å¦‚ <code>LIMIT 100000, 10</code>ï¼‰ï¼ŒæŸ¥è¯¢è€—æ—¶ä¼šå‘ˆæŒ‡æ•°çº§å¢é•¿ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾ <code>t_order</code> æŒ‰ç”¨æˆ·IDå“ˆå¸Œåˆ†ä¸º10ä¸ªåˆ†ç‰‡ï¼ˆt_order_0è‡³t_order_9ï¼‰ï¼Œå¦‚æœæ²¿ç”¨å•åº“åˆ†é¡µé€»è¾‘ï¼Œä¼šå‘ç”Ÿä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li>åº”ç”¨ä¼šå‘10ä¸ªåˆ†ç‰‡å„å‘é€ <code>SELECT * FROM t_order_x ORDER BY create_time DESC LIMIT 100010</code>ï¼ˆè¦å–åˆ°å…¨å±€ç¬¬100001-100010æ¡ï¼Œæ¯ä¸ªåˆ†ç‰‡éƒ½è¦æŸ¥å‰100010æ¡ï¼‰ï¼›</li>
<li>æ”¶é›†10ä¸ªåˆ†ç‰‡è¿”å›çš„100100æ¡æ•°æ®ï¼Œåœ¨åº”ç”¨å±‚æ’åºåï¼Œå†æˆªå–å‰10æ¡ä½œä¸ºç»“æœã€‚</li>
</ol>
<p>è¿™å°±æ„å‘³ç€ï¼ŒåŸæœ¬åªéœ€æ‰«æ1010æ¡æ•°æ®çš„æ“ä½œï¼Œå˜æˆäº†æ‰«æ100ä¸‡+æ¡æ•°æ®ï¼Œå¤§é‡å†—ä½™æ•°æ®çš„ä¼ è¾“å’Œå†…å­˜æ’åºï¼Œç›´æ¥æ‹–å®åº”ç”¨æ€§èƒ½ï¼Œç”šè‡³å¯¼è‡´æŸ¥è¯¢è¶…æ—¶ã€‚æŸç”µå•†æ¡ˆä¾‹æ˜¾ç¤ºï¼Œ<code>LIMIT 10000000, 10</code> çš„æ‰§è¡Œæ—¶é—´æ˜¯ <code>LIMIT 10, 10</code> çš„200å€ä»¥ä¸Šã€‚</p>
<h3 data-id="heading-2">2. åˆ†é¡µç»“æœä¸å‡†ç¡®ï¼ˆæ•°æ®é‡å¤/ç¼ºå¤±ï¼‰</h3>
<p>å¾ˆå¤šæ—¶å€™ï¼Œåˆ†é¡µæŸ¥å‡ºæ¥çš„æ•°æ®è¦ä¹ˆé‡å¤å‡ºç°ï¼Œè¦ä¹ˆè«åç¼ºå¤±ï¼Œæ ¸å¿ƒåŸå› æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>åˆ†ç‰‡è§„åˆ™ä¸æ’åºå­—æ®µä¸åŒ¹é…ï¼šæ¯”å¦‚æŒ‰ç”¨æˆ·IDåˆ†ç‰‡ï¼Œå´æŒ‰åˆ›å»ºæ—¶é—´æ’åºï¼Œä¸åŒåˆ†ç‰‡çš„æ—¶é—´èŒƒå›´é‡å ï¼Œèšåˆæ—¶å¾ˆå®¹æ˜“æ¼æ‰è·¨åˆ†ç‰‡çš„è¿ç»­æ•°æ®ï¼Œæˆ–é‡å¤ç»Ÿè®¡åŒä¸€æ‰¹æ•°æ®ï¼›</li>
<li>æ•°æ®åŠ¨æ€å˜æ›´ï¼šæŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼ŒæŸåˆ†ç‰‡æ’å…¥ã€åˆ é™¤æˆ–æ›´æ–°äº†æ•°æ®ï¼Œä¼šå¯¼è‡´å‰åé¡µæ•°æ®é‡å ï¼ˆæ¯”å¦‚ç¬¬1é¡µæœ«å°¾æ•°æ®ä¸ç¬¬2é¡µå¼€å¤´æ•°æ®é‡å¤ï¼‰ï¼Œæˆ–æŸæ¡æ•°æ®å‡­ç©ºæ¶ˆå¤±ã€‚</li>
</ul>
<h3 data-id="heading-3">3. å¤šç»´åº¦æ’åºæ— æ³•æ”¯æŒ</h3>
<p>å½“ä¸šåŠ¡éœ€è¦æŒ‰éåˆ†ç‰‡é”®å¤šå­—æ®µæ’åºæ—¶ï¼ˆæ¯”å¦‚â€œæŒ‰è®¢å•é‡‘é¢é™åº+æ”¯ä»˜æ—¶é—´å‡åºâ€ï¼‰ï¼Œæ€§èƒ½ä¼šæå·®ç”šè‡³æ— æ³•å®ç°ã€‚å› ä¸ºéåˆ†ç‰‡é”®å­—æ®µæ²¡æœ‰å…¨å±€ç´¢å¼•ï¼Œå¿…é¡»æ‰«ææ‰€æœ‰åˆ†ç‰‡çš„å…¨é‡æ•°æ®æ‰èƒ½å®Œæˆæ’åºï¼Œç›¸å½“äºâ€œåˆ†å¸ƒå¼å…¨è¡¨æ‰«æâ€ï¼Œåˆ†ç‰‡æ•°è¶Šå¤šï¼Œæ€§èƒ½è¶Šå·®ã€‚</p>
<h2 data-id="heading-4">äºŒã€4ç§ä¸»æµå®æˆ˜æ–¹æ¡ˆï¼šä»â€œèƒ½ç”¨â€åˆ°â€œä¼˜é›…â€</h2>
<p>åˆ†åº“åˆ†è¡¨åˆ†é¡µæ²¡æœ‰â€œé“¶å¼¹â€ï¼Œæ‰€æœ‰æ–¹æ¡ˆéƒ½æ˜¯â€œtrade-offâ€ï¼ˆå–èˆï¼‰ã€‚ä¸‹é¢4ç§æ–¹æ¡ˆï¼Œè¦†ç›–ä»æµ…åˆ†é¡µåˆ°æ·±åˆ†é¡µã€ä»ç®€å•æŸ¥è¯¢åˆ°å¤æ‚æŸ¥è¯¢çš„æ‰€æœ‰åœºæ™¯ï¼Œå»ºè®®ç»“åˆè‡ªèº«ä¸šåŠ¡é€‰å‹ã€‚</p>
<h3 data-id="heading-5">æ–¹æ¡ˆ1ï¼šå…¨å±€æ‰«ææ³•ï¼ˆæš´åŠ›æ³•ï¼‰â€”â€” æœ€ç®€å•ï¼Œä½†æ€§èƒ½æœ€å·®</h3>
<p>è¿™æ˜¯æœ€åŸºç¡€ã€æœ€é€šç”¨çš„æ–¹æ¡ˆï¼Œæœ¬è´¨æ˜¯â€œå…ˆæ‹‰å–ã€å†èšåˆã€æœ€åæˆªå–â€ï¼Œå®Œå…¨æ²¿ç”¨å•åº“åˆ†é¡µé€»è¾‘ï¼Œä»…åœ¨åº”ç”¨å±‚å¢åŠ èšåˆæ’åºæ­¥éª¤ã€‚</p>
<h4 data-id="heading-6">å®ç°æ€è·¯</h4>
<ol>
<li>SQLæ”¹å†™ï¼šå°†åˆ†é¡µSQLå‘é€åˆ°æ‰€æœ‰åˆ†ç‰‡ï¼Œæ³¨æ„<strong>æ¯ä¸ªåˆ†ç‰‡éƒ½è¦æŸ¥è¯¢â€œoffset+sizeâ€æ¡æ•°æ®</strong>ï¼ˆé¿å…é—æ¼å…¨å±€æ•°æ®ï¼‰ï¼›</li>
<li>å¹¶è¡ŒæŸ¥è¯¢ï¼šé€šè¿‡çº¿ç¨‹æ± å¹¶è¡Œè°ƒç”¨æ‰€æœ‰åˆ†ç‰‡ï¼Œå‡å°‘ç­‰å¾…æ—¶é—´ï¼›</li>
<li>å…¨å±€èšåˆï¼šæ”¶é›†æ‰€æœ‰åˆ†ç‰‡çš„è¿”å›ç»“æœï¼Œåœ¨åº”ç”¨å±‚æŒ‰æ’åºå­—æ®µåšå…¨å±€æ’åºï¼›</li>
<li>ç²¾å‡†æˆªå–ï¼šä»æ’åºåçš„å…¨å±€åˆ—è¡¨ä¸­ï¼Œæˆªå– <code>offset</code> åˆ° <code>offset+size</code> çš„æ•°æ®ï¼Œä½œä¸ºæœ€ç»ˆåˆ†é¡µç»“æœã€‚</li>
</ol>
<h4 data-id="heading-7">ä¼ªä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-ini" lang="ini">// 1. æ„å»ºåˆ†ç‰‡SQLï¼ˆæ¯ä¸ªåˆ†ç‰‡éƒ½æŸ¥offset+sizeæ¡ï¼‰
String <span class="hljs-attr">sql</span> = <span class="hljs-string">"SELECT * FROM t_order_{0} ORDER BY create_time DESC LIMIT "</span> + (<span class="hljs-literal">off</span>set + size)<span class="hljs-comment">;</span>
// 2. å¹¶è¡ŒæŸ¥è¯¢æ‰€æœ‰åˆ†ç‰‡
List&lt;List&lt;Order&gt;&gt; <span class="hljs-attr">allShardData</span> = shardExecutor.parallelExecute(sql)<span class="hljs-comment">;</span>
// 3. å…¨å±€èšåˆæ’åº
List&lt;Order&gt; <span class="hljs-attr">globalData</span> = allShardData.stream()
    .flatMap(Collection::stream)
    .sorted(Comparator.comparing(Order::getCreateTime).reversed())
    .collect(Collectors.toList())<span class="hljs-comment">;</span>
// 4. æˆªå–ç›®æ ‡é¡µæ•°æ®
int <span class="hljs-attr">start</span> = <span class="hljs-literal">off</span>set<span class="hljs-comment">;</span>
int <span class="hljs-attr">end</span> = Math.min(<span class="hljs-literal">off</span>set + size, globalData.size())<span class="hljs-comment">;</span>
List&lt;Order&gt; <span class="hljs-attr">pageData</span> = globalData.subList(start, end)<span class="hljs-comment">;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-8">ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šå¼€å‘æˆæœ¬æä½ï¼Œæ— éœ€ä¿®æ”¹åˆ†ç‰‡è§„åˆ™ï¼Œå¯¹ä¸šåŠ¡é€æ˜ï¼Œæ”¯æŒä»»æ„è·³é¡µå’Œå¤šç»´åº¦æ’åºï¼›</li>
<li>ç¼ºç‚¹ï¼šæ·±åº¦åˆ†é¡µæ€§èƒ½é›ªå´©ï¼Œå†—ä½™æ•°æ®ä¼ è¾“é‡å¤§ï¼Œå†…å­˜æ’åºå‹åŠ›å¤§ï¼Œåˆ†ç‰‡æ•°è¶Šå¤šæ€§èƒ½è¶Šå·®ï¼›</li>
<li>é€‚ç”¨åœºæ™¯ï¼šåˆ†ç‰‡æ•°é‡å°‘ï¼ˆ&lt;4ï¼‰ã€åˆ†é¡µä¸æ·±ï¼ˆoffset&lt;1000ï¼‰ã€æŸ¥è¯¢é¢‘ç‡ä½çš„åœºæ™¯ï¼ˆæ¯”å¦‚åå°ç®¡ç†ç³»ç»Ÿçš„ä½é¢‘åˆ†é¡µæŸ¥è¯¢ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-9">æ–¹æ¡ˆ2ï¼šå…¨å±€å”¯ä¸€é”®äºŒæ¬¡æŸ¥è¯¢æ³•â€”â€” æµ…åˆ†é¡µé¦–é€‰ï¼Œæ€§èƒ½ä¼˜åŒ–æ˜æ˜¾</h3>
<p>æ–¹æ¡ˆ1çš„æ ¸å¿ƒé—®é¢˜æ˜¯â€œä¼ è¾“å…¨é‡æ•°æ®â€ï¼Œè€Œæ–¹æ¡ˆ2é€šè¿‡â€œå…ˆæŸ¥ä¸»é”®ã€å†æŸ¥è¯¦æƒ…â€çš„æ–¹å¼ï¼Œå¤§å¹…å‡å°‘æ•°æ®ä¼ è¾“é‡ï¼Œæ˜¯æµ…åˆ†é¡µï¼ˆoffset&lt;1ä¸‡ï¼‰åœºæ™¯çš„é¦–é€‰æ–¹æ¡ˆã€‚</p>
<h4 data-id="heading-10">æ ¸å¿ƒæ€è·¯</h4>
<p>åˆ©ç”¨å…¨å±€å”¯ä¸€æœ‰åºé”®ï¼ˆæ¯”å¦‚é›ªèŠ±IDã€<code>create_time+order_id</code>ï¼‰ï¼Œå°†åˆ†é¡µæŸ¥è¯¢æ‹†åˆ†ä¸ºä¸¤æ¬¡ï¼šç¬¬ä¸€æ¬¡ä»…æŸ¥è¯¢ä¸»é”®å’Œæ’åºå­—æ®µï¼ˆæ•°æ®é‡æå°ï¼‰ï¼Œèšåˆæ’åºåç¡®å®šç›®æ ‡é¡µçš„ä¸»é”®åˆ—è¡¨ï¼›ç¬¬äºŒæ¬¡æ ¹æ®ä¸»é”®åˆ—è¡¨ï¼Œè·¯ç”±åˆ°å¯¹åº”åˆ†ç‰‡æŸ¥è¯¢å®Œæ•´æ•°æ®ï¼Œé¿å…ä¼ è¾“å†—ä½™å­—æ®µã€‚</p>
<h4 data-id="heading-11">å®ç°æ­¥éª¤</h4>
<ol>
<li>ç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼ˆæ‹‰å–ä¸»é”®ï¼‰ï¼šå‘å„åˆ†ç‰‡å‘é€ä»…æŸ¥è¯¢æ’åºå­—æ®µå’Œä¸»é”®çš„SQLï¼Œå‡å°‘æ•°æ®ä¼ è¾“é‡ï¼› <code> -- åˆ†ç‰‡t_order_0çš„æŸ¥è¯¢ï¼ˆä»…æŸ¥ä¸»é”®å’Œæ’åºå­—æ®µï¼‰  ``SELECT order_id, create_time FROM t_order_0 ORDER BY create_time DESC LIMIT 10010;</code></li>
<li>å…¨å±€èšåˆæ’åºï¼šæ”¶é›†æ‰€æœ‰åˆ†ç‰‡çš„ï¼ˆorder_id, create_timeï¼‰æ•°æ®ï¼Œåœ¨åº”ç”¨å±‚æŒ‰ <code>create_time</code> æ’åºï¼Œæˆªå–ç¬¬10000-10010æ¡çš„ <code>order_id</code> åˆ—è¡¨ï¼ˆå¦‚ (100001, 100002, â€¦, 100010)ï¼‰ï¼›</li>
<li>ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼ˆæ‹‰å–è¯¦æƒ…ï¼‰ï¼šæ ¹æ® <code>order_id</code> çš„åˆ†ç‰‡è§„åˆ™ï¼ˆæ¯”å¦‚å“ˆå¸Œè·¯ç”±ï¼‰ï¼Œè·¯ç”±åˆ°å¯¹åº”åˆ†ç‰‡ï¼ŒæŸ¥è¯¢å®Œæ•´æ•°æ®å¹¶æ’åºï¼›<code> -- è·¯ç”±åˆ°order_idå¯¹åº”çš„åˆ†ç‰‡ï¼ŒæŸ¥è¯¢å®Œæ•´æ•°æ®  ``SELECT * FROM t_order_0 WHERE order_id IN (100001, 100002, ..., 100010) ORDER BY create_time DESC;</code></li>
</ol>
<h4 data-id="heading-12">ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šç›¸æ¯”æ–¹æ¡ˆ1ï¼Œæ•°æ®ä¼ è¾“é‡å‡å°‘80%ä»¥ä¸Šï¼ˆä¸»é”®ä»…8-16å­—èŠ‚ï¼Œå®Œæ•´è¡Œå¯èƒ½æ•°ç™¾å­—èŠ‚ï¼‰ï¼Œæµ…åˆ†é¡µæ€§èƒ½æå‡æ˜æ˜¾ï¼Œæ”¯æŒè·³é¡µï¼›</li>
<li>ç¼ºç‚¹ï¼šoffsetè¿‡å¤§æ—¶ï¼ˆå¦‚10ä¸‡ï¼‰ï¼Œç¬¬ä¸€æ¬¡æŸ¥è¯¢ä»éœ€æ‹‰å–å¤§é‡ä¸»é”®ï¼Œæ€§èƒ½ä¾ç„¶è¡°å‡ï¼›ä¾èµ–å…¨å±€å”¯ä¸€æœ‰åºé”®ï¼Œéœ€é¢å¤–ç»´æŠ¤ï¼›</li>
<li>é€‚ç”¨åœºæ™¯ï¼šæµ…åˆ†é¡µï¼ˆoffset&lt;1ä¸‡ï¼‰ã€éœ€è¦è·³é¡µã€å¯¹æ€§èƒ½æœ‰ä¸€å®šè¦æ±‚çš„åœºæ™¯ï¼ˆæ¯”å¦‚åå°ç®¡ç†ç³»ç»Ÿçš„å¸¸è§„åˆ†é¡µæŸ¥è¯¢ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-13">æ–¹æ¡ˆ3ï¼šæ¸¸æ ‡åˆ†é¡µæ³•ï¼ˆæ— åç§»é‡ï¼‰â€”â€” æ·±åˆ†é¡µé¦–é€‰ï¼Œæ€§èƒ½æ’å®š</h3>
<p>æ— è®ºæ˜¯æ–¹æ¡ˆ1è¿˜æ˜¯æ–¹æ¡ˆ2ï¼Œéƒ½æ— æ³•è§£å†³â€œoffsetè¿‡å¤§å¯¼è‡´çš„æ€§èƒ½é›ªå´©â€ã€‚è€Œæ¸¸æ ‡åˆ†é¡µæ³•æ”¾å¼ƒäº† <code>offset</code>ï¼Œæ”¹ç”¨â€œä¸Šä¸€é¡µæœ€åä¸€æ¡æ•°æ®çš„æ¸¸æ ‡ä½ç½®â€ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼Œå®ç°â€œæ— åç§»é‡â€åˆ†é¡µï¼Œæ€§èƒ½ä¸é¡µç æ— å…³ï¼Œæ˜¯æ·±åˆ†é¡µåœºæ™¯çš„æœ€ä¼˜è§£ã€‚</p>
<h4 data-id="heading-14">æ ¸å¿ƒæ€è·¯</h4>
<p>ç±»æ¯”æˆ‘ä»¬è¯»ä¹¦ï¼šä¼ ç»Ÿoffsetåˆ†é¡µæ˜¯â€œç¿»åˆ°ç¬¬100é¡µâ€ï¼Œè€Œæ¸¸æ ‡åˆ†é¡µæ˜¯â€œä»ç¬¬99é¡µæœ€åä¸€è¡Œç»§ç»­è¯»â€ã€‚æ¯æ¬¡æŸ¥è¯¢æ—¶ï¼Œç”¨ä¸Šæ¬¡åˆ†é¡µè¿”å›çš„â€œæœ€åä¸€æ¡æ•°æ®çš„æ’åºå­—æ®µå€¼â€ï¼ˆæ¸¸æ ‡ï¼‰ä½œä¸ºè¿‡æ»¤æ¡ä»¶ï¼Œä»…æŸ¥è¯¢æ¸¸æ ‡ä¹‹åçš„æ•°æ®ï¼Œæ— éœ€æ‰«æå‰é¢çš„å†—ä½™æ•°æ®ã€‚</p>
<h4 data-id="heading-15">å®ç°æ­¥éª¤ï¼ˆä»¥è®¢å•è¡¨ä¸ºä¾‹ï¼‰</h4>
<ol>
<li>
<p>æŸ¥è¯¢ç¬¬ä¸€é¡µï¼šæ— éœ€æ¸¸æ ‡ï¼Œç›´æ¥æŸ¥è¯¢å‰10æ¡æ•°æ®ï¼Œè®°å½•æœ€åä¸€æ¡æ•°æ®çš„æ¸¸æ ‡</p>
<pre><code class="hljs language-sql" lang="sql">ï¼ˆæ¯”å¦‚ create_time<span class="hljs-operator">=</span><span class="hljs-number">2026</span><span class="hljs-number">-02</span><span class="hljs-number">-05</span> <span class="hljs-number">10</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>ï¼Œorder_id<span class="hljs-operator">=</span><span class="hljs-number">100010</span>ï¼‰ï¼›
       <span class="hljs-comment">-- ç¬¬ä¸€é¡µï¼šæŒ‰åˆ›å»ºæ—¶é—´å€’åºï¼Œå–10æ¡</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_order <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> create_time <span class="hljs-keyword">DESC</span>, order_id <span class="hljs-keyword">DESC</span> LIMIT <span class="hljs-number">10</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
</li>
<li>
<p>æŸ¥è¯¢ä¸‹ä¸€é¡µï¼šç”¨æ¸¸æ ‡ä½œä¸ºè¿‡æ»¤æ¡ä»¶ï¼ŒæŸ¥è¯¢æ¸¸æ ‡ä¹‹åçš„æ•°æ®ï¼ŒåŒæ ·å–10æ¡ï¼Œæ›´æ–°æ¸¸æ ‡ï¼›<code>-- ä¸‹ä¸€é¡µï¼šç”¨ä¸Šæ¬¡çš„æ¸¸æ ‡è¿‡æ»¤ï¼Œé¿å…offset</code></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_order 
<span class="hljs-keyword">WHERE</span> create_time <span class="hljs-operator">&lt;</span> <span class="hljs-string">'2026-02-05 10:00:00'</span> 
<span class="hljs-keyword">OR</span> (create_time <span class="hljs-operator">=</span> <span class="hljs-string">'2026-02-05 10:00:00'</span> <span class="hljs-keyword">AND</span> order_id <span class="hljs-operator">&lt;</span> <span class="hljs-number">100010</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> create_time <span class="hljs-keyword">DESC</span>, order_id <span class="hljs-keyword">DESC</span> LIMIT <span class="hljs-number">10</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
</li>
<li>
<p>åˆ†åº“åˆ†è¡¨é€‚é…ï¼šå°†ä¸Šè¿°SQLå‘é€åˆ°æ‰€æœ‰åˆ†ç‰‡ï¼Œå„åˆ†ç‰‡ä»…æŸ¥è¯¢ç¬¦åˆæ¸¸æ ‡æ¡ä»¶çš„10æ¡æ•°æ®ï¼Œåº”ç”¨å±‚èšåˆæ’åºåï¼Œå†å–å‰10æ¡ï¼ˆé¿å…è·¨åˆ†ç‰‡æ•°æ®é—æ¼ï¼‰ã€‚</p>
</li>
</ol>
<h4 data-id="heading-16">å…³é”®ä¼˜åŒ–ï¼šå¤šå­—æ®µæ’åºçš„æ¸¸æ ‡æ„å»º</h4>
<p>å¦‚æœæ’åºå­—æ®µä¸å”¯ä¸€ï¼ˆæ¯”å¦‚ <code>create_time</code> å¯èƒ½é‡å¤ï¼‰ï¼Œä»…ç”¨å•ä¸ªå­—æ®µä½œä¸ºæ¸¸æ ‡ä¼šå¯¼è‡´æ•°æ®ç¼ºå¤±ã€‚æ­¤æ—¶éœ€è¦ç”¨â€œæ’åºå­—æ®µç»„åˆâ€ä½œä¸ºæ¸¸æ ‡ï¼ˆå¦‚ <code>create_time+order_id</code>ï¼‰ï¼Œç¡®ä¿æ¸¸æ ‡å”¯ä¸€ï¼Œé¿å…é—æ¼æ•°æ®ã€‚</p>
<h4 data-id="heading-17">æ€§èƒ½å¯¹æ¯”ï¼ˆ1000ä¸‡æ¡æ•°æ®æµ‹è¯•ï¼‰</h4>



































<table><thead><tr><th>é¡µç </th><th>Offsetåˆ†é¡µè€—æ—¶</th><th>æ¸¸æ ‡åˆ†é¡µè€—æ—¶</th><th>æ€§èƒ½æå‡</th></tr></thead><tbody><tr><td>ç¬¬1é¡µ</td><td>5ms</td><td>5ms</td><td>-</td></tr><tr><td>ç¬¬100é¡µ</td><td>150ms</td><td>6ms</td><td>25å€</td></tr><tr><td>ç¬¬1000é¡µ</td><td>1.2s</td><td>6ms</td><td>200å€</td></tr><tr><td>ç¬¬10000é¡µ</td><td>8.5s</td><td>7ms</td><td>1200å€</td></tr></tbody></table>
<h4 data-id="heading-18">ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šæ€§èƒ½æ’å®šï¼Œä¸é¡µç æ— å…³ï¼Œæ·±åˆ†é¡µåœºæ™¯ä¼˜åŠ¿æå¤§ï¼›æ— éœ€æ‰«æå†—ä½™æ•°æ®ï¼Œå†…å­˜å‹åŠ›å°ï¼›æ”¯æŒå¤§æ•°æ®é‡è¿ç»­æµè§ˆï¼›</li>
<li>ç¼ºç‚¹ï¼šä¸æ”¯æŒè·³é¡µï¼ˆæ— æ³•ç›´æ¥è·³åˆ°ç¬¬100é¡µï¼‰ï¼Œæ— æ³•è®¡ç®—æ€»é¡µæ•°ï¼›å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚é«˜ï¼Œæ•°æ®åŠ¨æ€å˜æ›´å¯èƒ½å¯¼è‡´é‡å¤/ç¼ºå¤±ï¼›</li>
<li>é€‚ç”¨åœºæ™¯ï¼šæ·±åˆ†é¡µï¼ˆoffset&gt;1ä¸‡ï¼‰ã€è¿ç»­æµè§ˆåœºæ™¯ï¼ˆæ¯”å¦‚è®¢å•æµæ°´ã€æ—¥å¿—æµæ°´ã€Feedæµã€å•†å“åˆ—è¡¨æ»šåŠ¨åŠ è½½ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-19">æ–¹æ¡ˆ4ï¼šæœç´¢å¼•æ“è¾…åŠ©æ³•â€”â€” å¤æ‚æŸ¥è¯¢ã€å¤šç»´åº¦æ’åºé¦–é€‰</h3>
<p>å¦‚æœä¸šåŠ¡éœ€è¦â€œå¤šæ¡ä»¶ç­›é€‰+å¤šç»´åº¦æ’åº+æ·±åº¦åˆ†é¡µâ€ï¼ˆæ¯”å¦‚ç”µå•†çš„å•†å“æœç´¢åˆ†é¡µã€ç”¨æˆ·è¡Œä¸ºæ—¥å¿—æŸ¥è¯¢ï¼‰ï¼Œå‰é¢3ç§æ–¹æ¡ˆéƒ½æ— æ³•æ»¡è¶³æ€§èƒ½è¦æ±‚ã€‚æ­¤æ—¶æœ€ä¼˜é›…çš„æ–¹å¼ï¼Œæ˜¯é‡‡ç”¨â€œæŸ¥è¯¢ä¸å­˜å‚¨åˆ†ç¦»â€çš„æ¶æ„ï¼Œç”¨æœç´¢å¼•æ“ï¼ˆElasticsearch/OpenSearchï¼‰æ‰¿æ‹…åˆ†é¡µæŸ¥è¯¢å‹åŠ›ã€‚</p>
<h4 data-id="heading-20">æ ¸å¿ƒæ¶æ„</h4>
<p>æ•°æ®çš„CRUDæ“ä½œåœ¨MySQLåˆ†åº“åˆ†è¡¨ä¸­å®Œæˆï¼Œåˆ†é¡µæŸ¥è¯¢ã€å¤šæ¡ä»¶ç­›é€‰ã€æ’åºæ“ä½œåœ¨æœç´¢å¼•æ“ä¸­å®Œæˆï¼Œé€šè¿‡binlogåŒæ­¥æ•°æ®ï¼Œå®ç°â€œå­˜å‚¨å¼ºä¸€è‡´ã€æŸ¥è¯¢é«˜æ€§èƒ½â€ã€‚</p>
<ol>
<li>å­˜å‚¨å±‚ï¼šMySQLåˆ†åº“åˆ†è¡¨ï¼Œè´Ÿè´£æ•°æ®çš„å†™å…¥ã€æ›´æ–°ã€åˆ é™¤ï¼Œä¿è¯æ•°æ®å¼ºä¸€è‡´æ€§ï¼›</li>
<li>åŒæ­¥å±‚ï¼šé€šè¿‡Canalã€Debeziumç­‰å·¥å…·ï¼Œç›‘å¬MySQLçš„binlogï¼Œå°†æ•°æ®å¢é‡åŒæ­¥åˆ°æœç´¢å¼•æ“ï¼ˆESï¼‰ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼ˆå»¶è¿Ÿå¯æ§åˆ¶åœ¨100mså†…ï¼‰ï¼›</li>
<li>æŸ¥è¯¢å±‚ï¼šåº”ç”¨çš„åˆ†é¡µæŸ¥è¯¢ã€å¤šæ¡ä»¶ç­›é€‰è¯·æ±‚ï¼Œç›´æ¥å‘é€åˆ°ESï¼Œåˆ©ç”¨ESçš„åˆ†å¸ƒå¼ç´¢å¼•ä¼˜åŠ¿ï¼Œé«˜æ•ˆå®Œæˆæ’åºå’Œåˆ†é¡µï¼›MySQLä»…æ‰¿æ‹…è¯¦æƒ…æŸ¥è¯¢ã€å†™å…¥ç­‰æ“ä½œã€‚</li>
</ol>
<h4 data-id="heading-21">å®ç°ç¤ºä¾‹ï¼ˆESåˆ†é¡µæŸ¥è¯¢ï¼‰</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"query"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"bool"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"must"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span><span class="hljs-attr">"term"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"user_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">123</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">{</span><span class="hljs-attr">"range"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"create_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"gte"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026-01-01"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"sort"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"create_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"desc"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"order_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"desc"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"from"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100000</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// æ·±åˆ†é¡µæ— å‹åŠ›</span>
  <span class="hljs-attr">"size"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-22">ä¼˜ç¼ºç‚¹ä¸é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šåŠŸèƒ½æœ€å¼ºï¼Œå¤©ç„¶æ”¯æŒå¤šæ¡ä»¶æ£€ç´¢ã€å¤šç»´åº¦æ’åºã€æ·±åº¦åˆ†é¡µï¼Œæ€§èƒ½ä¼˜å¼‚ï¼›æ— éœ€ä¿®æ”¹åˆ†åº“åˆ†è¡¨æ¶æ„ï¼Œå¯¹ä¸šåŠ¡ä¾µå…¥æ€§ä½ï¼›</li>
<li>ç¼ºç‚¹ï¼šæ¶æ„å¤æ‚åº¦æå‡ï¼Œéœ€ç»´æŠ¤ESé›†ç¾¤å’Œæ•°æ®åŒæ­¥é“¾è·¯ï¼›éœ€å¤„ç†åŒæ­¥å»¶è¿Ÿï¼ˆå¯é€šè¿‡â€œå…³é”®æ•°æ®æŸ¥ä¸»åº“â€å…œåº•ï¼‰ï¼›ESæ·±åº¦åˆ†é¡µéœ€é¢å¤–ä¼˜åŒ–ï¼ˆå¦‚ç”¨search_afteræ›¿ä»£from/sizeï¼‰ï¼›</li>
<li>é€‚ç”¨åœºæ™¯ï¼šå¤šæ¡ä»¶ç­›é€‰+å¤šç»´åº¦æ’åº+æ·±åº¦åˆ†é¡µçš„åœºæ™¯ï¼ˆæ¯”å¦‚ç”µå•†å•†å“æœç´¢ã€ç”¨æˆ·è¡Œä¸ºåˆ†æã€æ—¥å¿—æŸ¥è¯¢ç³»ç»Ÿï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-23">ä¸‰ã€è¿›é˜¶ä¼˜åŒ–ï¼šé¢„è®¡ç®—é”šç‚¹æ³•ï¼ˆéå®æ—¶åœºæ™¯è¡¥å……ï¼‰</h2>
<p>å¯¹äºéå®æ—¶åœºæ™¯ï¼ˆæ¯”å¦‚æŠ¥è¡¨ç³»ç»Ÿã€å†å²æ•°æ®æŸ¥è¯¢ï¼‰ï¼Œè¿˜å¯ä»¥é‡‡ç”¨â€œé¢„è®¡ç®—åˆ†é¡µé”šç‚¹â€çš„æ–¹å¼ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½ï¼Œå‡å°‘æ— æ•ˆæ‰«æã€‚</p>
<h4 data-id="heading-24">æ ¸å¿ƒæ€è·¯</h4>
<p>é€šè¿‡å®šæ—¶ä»»åŠ¡ï¼Œé¢„è®¡ç®—å„åˆ†ç‰‡çš„â€œåˆ†é¡µé”šç‚¹â€ï¼ˆæ¯”å¦‚æ¯1000æ¡è®°å½•çš„æ’åºå­—æ®µå€¼ï¼‰ï¼Œå­˜å‚¨åœ¨Redisç­‰å…ƒæ•°æ®æœåŠ¡ä¸­ã€‚æŸ¥è¯¢æ—¶ï¼Œå…ˆé€šè¿‡é”šç‚¹å®šä½ç›®æ ‡æ•°æ®æ‰€åœ¨çš„åˆ†ç‰‡åŠèŒƒå›´ï¼Œå‡å°‘å„åˆ†ç‰‡çš„æ‰«æé‡ã€‚</p>
<h4 data-id="heading-25">å®ç°æ­¥éª¤</h4>
<ol>
<li>é”šç‚¹è®¡ç®—ï¼šæ¯æ—¥å‡Œæ™¨å¯¹å„åˆ†ç‰‡æ‰§è¡Œ <code>SELECT id, create_time FROM orders ORDER BY create_time LIMIT 0, 1000, 2000...</code>ï¼Œè®°å½•æ¯1000æ¡çš„ <code>create_time</code> ä½œä¸ºé”šç‚¹ï¼Œå­˜å…¥Redisï¼›</li>
<li>æŸ¥è¯¢è·¯ç”±ï¼šç”¨æˆ·æŸ¥è¯¢ç¬¬100ä¸‡é¡µï¼ˆoffset=999990ï¼‰æ—¶ï¼Œå…ƒæ•°æ®æœåŠ¡è®¡ç®—é”šç‚¹èŒƒå›´ï¼ˆ999990â‰ˆ1000Ã—999.99ï¼‰ï¼Œè·å–å„åˆ†ç‰‡ç¬¬999ä¸ªé”šç‚¹çš„ <code>create_time</code> å€¼ï¼Œç¡®å®šå…¨å±€æœ€å° <code>time_min</code>ï¼›</li>
<li>ç²¾å‡†æ‰«æï¼šå„åˆ†ç‰‡ä»…æŸ¥è¯¢ <code>create_time &gt;= time_min</code> çš„æ•°æ®ï¼ŒæŒ‰ <code>create_time</code> æ’åºåå–å‰20æ¡ï¼ˆå†—ä½™é‡é¿å…è¾¹ç•Œè¯¯å·®ï¼‰ï¼Œæ±‡æ€»åå†æ’åºå–ç›®æ ‡10æ¡ã€‚</li>
</ol>
<h4 data-id="heading-26">é€‚ç”¨åœºæ™¯</h4>
<p>éå®æ—¶åœºæ™¯ï¼ˆå¦‚æŠ¥è¡¨ç³»ç»Ÿã€å†å²æ•°æ®æŸ¥è¯¢ï¼‰ï¼Œå¯¹æ•°æ®å»¶è¿Ÿå®¹å¿åº¦é«˜ï¼ˆåˆ†é’Ÿçº§ï¼‰ï¼Œä½†å¯¹æŸ¥è¯¢æ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯ã€‚</p>
<h2 data-id="heading-27">å››ã€é¿å‘æŒ‡å—ï¼š5ä¸ªæœ€å®¹æ˜“è¸©çš„å‘åŠè§£å†³æ–¹æ¡ˆ</h2>
<p>å³ä½¿é€‰å¯¹äº†æ–¹æ¡ˆï¼Œè½åœ°æ—¶ä¹Ÿå®¹æ˜“è¸©å‘ã€‚ä¸‹é¢5ä¸ªå‘ï¼Œæ˜¯æˆ‘åœ¨å®é™…é¡¹ç›®ä¸­åå¤é‡åˆ°çš„ï¼Œé™„ä¸Šå…·ä½“è§£å†³æ–¹æ¡ˆï¼Œå¸®ä½ å°‘èµ°å¼¯è·¯ã€‚</p>
<h3 data-id="heading-28">å‘1ï¼šåç§»é‡è¿‡å¤§å¯¼è‡´æ€§èƒ½é›ªå´©</h3>
<p>ã€Œè¡¨ç°ã€ï¼šoffsetè¶…è¿‡1ä¸‡åï¼ŒæŸ¥è¯¢è€—æ—¶æ€¥å‰§å¢åŠ ï¼Œç”šè‡³è¶…æ—¶ï¼›ã€Œæ ¹æºã€ï¼šå…¨å±€åç§»é‡æ— æ³•è½¬åŒ–ä¸ºæœ¬åœ°åç§»é‡ï¼Œæ¯ä¸ªåˆ†ç‰‡éƒ½è¦æ‰«æå¤§é‡å†—ä½™æ•°æ®ï¼›ã€Œè§£å†³æ–¹æ¡ˆã€ï¼šç¦ç”¨æ·±åˆ†é¡µè·³é¡µï¼Œæ”¹ç”¨æ¸¸æ ‡åˆ†é¡µï¼›æˆ–ç”¨é¢„è®¡ç®—é”šç‚¹æ³•ä¼˜åŒ–ï¼›æµ…åˆ†é¡µåœºæ™¯ç”¨æ–¹æ¡ˆ2ã€‚</p>
<h3 data-id="heading-29">å‘2ï¼šåˆ†ç‰‡é”®ä¸æ’åºå­—æ®µä¸åŒ¹é…å¯¼è‡´åˆ†é¡µé”™ä¹±</h3>
<p>ã€Œè¡¨ç°ã€ï¼šåˆ†é¡µæ•°æ®æ— åºã€ç¼ºå¤±ï¼›ã€Œæ ¹æºã€ï¼šæŒ‰å“ˆå¸Œåˆ†ç‰‡ï¼ˆå¦‚ç”¨æˆ·IDï¼‰ï¼Œå´æŒ‰éåˆ†ç‰‡é”®ï¼ˆå¦‚åˆ›å»ºæ—¶é—´ï¼‰æ’åºï¼Œå„åˆ†ç‰‡æ•°æ®èŒƒå›´é‡å ï¼›ã€Œè§£å†³æ–¹æ¡ˆã€ï¼šåˆ†è¡¨æ—¶å°½é‡é€‰æ‹©â€œæ’åºå­—æ®µ+åˆ†ç‰‡é”®â€çš„ç»„åˆï¼ˆå¦‚æŒ‰åˆ›å»ºæ—¶é—´èŒƒå›´åˆ†ç‰‡ï¼‰ï¼›è‹¥å·²æŒ‰å“ˆå¸Œåˆ†ç‰‡ï¼Œæ’åºæ—¶éœ€åœ¨åº”ç”¨å±‚åšå…¨å±€æ’åºï¼Œç¡®ä¿ç»“æœæœ‰åºã€‚</p>
<h3 data-id="heading-30">å‘3ï¼šæ•°æ®åŠ¨æ€å˜æ›´å¯¼è‡´é‡å¤/ç¼ºå¤±</h3>
<p>ã€Œè¡¨ç°ã€ï¼šå‰åé¡µæ•°æ®é‡å¤ï¼Œæˆ–æŸæ¡æ•°æ®å‡­ç©ºæ¶ˆå¤±ï¼›ã€Œæ ¹æºã€ï¼šæŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼Œåˆ†ç‰‡æ’å…¥ã€åˆ é™¤ã€æ›´æ–°æ•°æ®ï¼Œå¯¼è‡´å…¨å±€æ’åºç»“æœå˜åŒ–ï¼›ã€Œè§£å†³æ–¹æ¡ˆã€ï¼šæ¸¸æ ‡åˆ†é¡µæ—¶ï¼Œç”¨â€œå”¯ä¸€æ¸¸æ ‡â€ï¼ˆå¦‚create_time+order_idï¼‰ï¼›å…³é”®ä¸šåŠ¡åœºæ™¯ï¼Œåˆ†é¡µæŸ¥è¯¢èµ°ä¸»åº“ï¼Œé¿å…ä»åº“åŒæ­¥å»¶è¿Ÿï¼›å¯æ·»åŠ ç‰ˆæœ¬å·ï¼Œè¿‡æ»¤å·²åˆ é™¤/æ›´æ–°çš„æ•°æ®ã€‚</p>
<h3 data-id="heading-31">å‘4ï¼šå¤šè¡¨å…³è”åˆ†é¡µå¤æ‚åº¦é£™å‡</h3>
<p>ã€Œè¡¨ç°ã€ï¼šå…³è”åˆ†åº“åˆ†è¡¨åçš„ä¸¤å¼ è¡¨ï¼ˆå¦‚è®¢å•è¡¨+ç”¨æˆ·è¡¨ï¼‰åˆ†é¡µï¼Œæ€§èƒ½æå·®ï¼›ã€Œæ ¹æºã€ï¼šå…³è”å­—æ®µå¯èƒ½ä¸åœ¨åŒä¸€ä¸ªåˆ†ç‰‡ï¼Œéœ€è·¨åˆ†ç‰‡å…³è”ï¼Œå†åˆ†é¡µï¼Œæˆæœ¬æé«˜ï¼›ã€Œè§£å†³æ–¹æ¡ˆã€ï¼šä¼˜å…ˆç”¨å®½è¡¨è®¾è®¡ï¼ˆå°†ç”¨æˆ·ä¿¡æ¯å†—ä½™åˆ°è®¢å•è¡¨ï¼‰ï¼Œé¿å…è·¨è¡¨å…³è”ï¼›è‹¥å¿…é¡»å…³è”ï¼Œåœ¨ä¸šåŠ¡å±‚åšä¸¤æ¬¡æŸ¥è¯¢ï¼ˆå…ˆæŸ¥è®¢å•åˆ†é¡µï¼Œå†æ‰¹é‡æŸ¥ç”¨æˆ·ä¿¡æ¯ï¼‰ï¼Œè€Œéæ•°æ®åº“å±‚å…³è”ã€‚</p>
<h3 data-id="heading-32">å‘5ï¼šè¯»å†™åˆ†ç¦»åœºæ™¯ä¸‹çš„æ•°æ®ä¸ä¸€è‡´</h3>
<p>ã€Œè¡¨ç°ã€ï¼šåˆ†é¡µæŸ¥è¯¢ä»åº“ï¼Œå‡ºç°æ•°æ®ç¼ºå¤±ï¼ˆä¸»åº“å·²å†™å…¥ï¼Œä»åº“æœªåŒæ­¥ï¼‰ï¼›ã€Œæ ¹æºã€ï¼šä¸»ä»åŒæ­¥å»¶è¿Ÿï¼›ã€Œè§£å†³æ–¹æ¡ˆã€ï¼šå…³é”®ä¸šåŠ¡çš„åˆ†é¡µæŸ¥è¯¢èµ°ä¸»åº“ï¼›éå…³é”®ä¸šåŠ¡ï¼Œå¯ç­‰å¾…ä»åº“åŒæ­¥å®Œæˆï¼ˆå¦‚å»¶è¿Ÿ100msï¼‰å†æŸ¥è¯¢ï¼›æˆ–ç”¨â€œä¸»ä»ä¸€è‡´æ€§æ ¡éªŒâ€ï¼Œå‘ç°ç¼ºå¤±æ•°æ®æ—¶ä»ä¸»åº“è¡¥æŸ¥ã€‚</p>
<h2 data-id="heading-33">äº”ã€å®è·µå»ºè®®ï¼šå¦‚ä½•å¿«é€Ÿé€‰å‹è½åœ°ï¼Ÿ</h2>
<p>ç»“åˆå‰é¢çš„æ–¹æ¡ˆå’Œé¿å‘æŠ€å·§ï¼Œç»™å‡º4æ¡è½åœ°å»ºè®®ï¼Œå¸®ä½ å¿«é€Ÿé€‰å‹ï¼Œé™ä½å¼€å‘æˆæœ¬ï¼š</p>
<h3 data-id="heading-34">1. ä¼˜å…ˆæŒ‰ä¸šåŠ¡åœºæ™¯é€‰æ–¹æ¡ˆï¼ˆæ ¸å¿ƒåŸåˆ™ï¼‰</h3>
<ul>
<li>è¿ç»­æµè§ˆåœºæ™¯ï¼ˆFeedæµã€è®¢å•æµæ°´ï¼‰ï¼šé¦–é€‰æ¸¸æ ‡åˆ†é¡µæ³•ï¼›</li>
<li>æµ…åˆ†é¡µ+è·³é¡µåœºæ™¯ï¼ˆåå°ç®¡ç†ç³»ç»Ÿï¼‰ï¼šé¦–é€‰å…¨å±€å”¯ä¸€é”®äºŒæ¬¡æŸ¥è¯¢æ³•ï¼›</li>
<li>å¤šæ¡ä»¶ç­›é€‰+å¤šç»´åº¦æ’åºï¼ˆå•†å“æœç´¢ï¼‰ï¼šé¦–é€‰æœç´¢å¼•æ“è¾…åŠ©æ³•ï¼›</li>
<li>éå®æ—¶åœºæ™¯ï¼ˆæŠ¥è¡¨ã€å†å²æ•°æ®ï¼‰ï¼šè¡¥å……é¢„è®¡ç®—é”šç‚¹æ³•ï¼›</li>
<li>åˆ†ç‰‡å°‘ã€æŸ¥è¯¢ä½é¢‘ï¼šå¯ç”¨å…¨å±€æ‰«ææ³•ï¼ˆå¿«é€Ÿè½åœ°ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-35">2. åˆ†è¡¨è®¾è®¡æ—¶ï¼Œæå‰è€ƒè™‘åˆ†é¡µéœ€æ±‚</h3>
<p>åˆ†è¡¨å‰ï¼Œæ˜ç¡®åˆ†é¡µçš„æ’åºå­—æ®µå’ŒæŸ¥è¯¢åœºæ™¯ï¼Œå°½é‡é€‰æ‹©â€œæ’åºå­—æ®µ+åˆ†ç‰‡é”®â€çš„ç»„åˆï¼ˆå¦‚æŒ‰åˆ›å»ºæ—¶é—´èŒƒå›´åˆ†ç‰‡ï¼‰ï¼Œå‡å°‘åç»­åˆ†é¡µä¼˜åŒ–çš„æˆæœ¬ï¼›é¿å…ç”¨æ— æ„ä¹‰çš„å“ˆå¸Œé”®åˆ†ç‰‡ï¼ˆå¦‚éšæœºIDï¼‰ï¼Œå¦åˆ™å¤šç»´åº¦æ’åºä¼šéå¸¸å›°éš¾ã€‚</p>
<h3 data-id="heading-36">3. é¿å…è¿‡åº¦ä¼˜åŒ–ï¼Œä¼˜å…ˆæ»¡è¶³ä¸šåŠ¡éœ€æ±‚</h3>
<p>å¦‚æœä¸šåŠ¡åˆ†é¡µæŸ¥è¯¢é¢‘ç‡ä½ã€æ•°æ®é‡ä¸å¤§ï¼Œæ— éœ€è¿½æ±‚â€œæœ€ä¼˜æ–¹æ¡ˆâ€ï¼Œç”¨å…¨å±€æ‰«ææ³•å¿«é€Ÿè½åœ°å³å¯ï¼›åªæœ‰å½“åˆ†é¡µæˆä¸ºæ€§èƒ½ç“¶é¢ˆæ—¶ï¼Œå†é€æ­¥ä¼˜åŒ–ä¸ºæ¸¸æ ‡åˆ†é¡µæˆ–æœç´¢å¼•æ“è¾…åŠ©æ³•ã€‚</p>
<h3 data-id="heading-37">4. åšå¥½ç›‘æ§ä¸å…œåº•</h3>
<p>ç›‘æ§å„åˆ†ç‰‡çš„æŸ¥è¯¢è€—æ—¶ã€å†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŠæ—¶å‘ç°çƒ­ç‚¹åˆ†ç‰‡ï¼›ç»™åˆ†é¡µæŸ¥è¯¢è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ˆå¦‚500msï¼‰ï¼Œè¶…æ—¶åé™çº§ï¼ˆå¦‚è¿”å›å‰100é¡µæ•°æ®ï¼‰ï¼›å…³é”®ä¸šåŠ¡åœºæ™¯ï¼Œé¢„ç•™â€œå›é€€æ–¹æ¡ˆâ€ï¼ˆå¦‚åˆ‡æ¢åˆ°å•åº“æŸ¥è¯¢ã€ä¸´æ—¶å…³é—­åˆ†åº“åˆ†è¡¨ï¼‰ã€‚</p>
<h2 data-id="heading-38">å…­ã€æ€»ç»“ï¼šæ²¡æœ‰é“¶å¼¹ï¼Œé€‚é…ä¸šåŠ¡æ‰æ˜¯å…³é”®</h2>
<p>åˆ†åº“åˆ†è¡¨ä¸‹çš„åˆ†é¡µæŸ¥è¯¢ï¼Œæœ¬è´¨æ˜¯â€œè§£å†³åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„å…¨å±€æœ‰åºæ€§å’Œæ€§èƒ½å¹³è¡¡â€é—®é¢˜ã€‚æˆ‘ä»¬ä¸éœ€è¦æŒæ¡æ‰€æœ‰æ–¹æ¡ˆï¼Œåªéœ€è®°ä½ï¼š</p>
<ul>
<li>æµ…åˆ†é¡µ+è·³é¡µï¼šç”¨å…¨å±€å”¯ä¸€é”®äºŒæ¬¡æŸ¥è¯¢æ³•ï¼›</li>
<li>æ·±åˆ†é¡µ+è¿ç»­æµè§ˆï¼šç”¨æ¸¸æ ‡åˆ†é¡µæ³•ï¼›</li>
<li>å¤æ‚æŸ¥è¯¢+å¤šç»´åº¦æ’åºï¼šç”¨æœç´¢å¼•æ“è¾…åŠ©æ³•ï¼›</li>
<li>æ‰€æœ‰æ–¹æ¡ˆéƒ½æœ‰å–èˆï¼Œè½åœ°æ—¶éœ€ç»“åˆä¸šåŠ¡åœºæ™¯ã€æ•°æ®é‡ã€æ€§èƒ½è¦æ±‚ï¼Œå¹³è¡¡å¼€å‘æˆæœ¬å’Œç”¨æˆ·ä½“éªŒã€‚</li>
</ul>
<p>éšç€åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆå¦‚ShardingSphereã€TiDBï¼‰çš„å‘å±•ï¼Œå¾ˆå¤šåˆ†é¡µé—®é¢˜å·²ç»å¯ä»¥é€šè¿‡ä¸­é—´ä»¶è‡ªåŠ¨å¤„ç†ï¼ˆå¦‚ShardingSphereçš„åˆ†é¡µæ’ä»¶ï¼Œå¯è‡ªåŠ¨ä¼˜åŒ–offsetåˆ†é¡µï¼‰ã€‚ä½†äº†è§£åº•å±‚åŸç†å’Œæ‰‹åŠ¨ä¼˜åŒ–æ–¹æ¡ˆï¼Œèƒ½è®©æˆ‘ä»¬åœ¨é‡åˆ°å¤æ‚åœºæ™¯æ—¶ï¼Œä¾ç„¶èƒ½å¿«é€Ÿå®šä½é—®é¢˜ã€è§£å†³é—®é¢˜ã€‚</p>
<p>æœ€åï¼Œå¦‚æœä½ åœ¨å®é™…é¡¹ç›®ä¸­é‡åˆ°äº†ç‰¹æ®Šçš„åˆ†é¡µåœºæ™¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµï¼Œä¸€èµ·æ¢è®¨æœ€ä¼˜è§£å†³æ–¹æ¡ˆï½</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SVGæ ‡ç­¾ä¸­pathè·¯å¾„å‚æ•°å­¦ä¹ ]]></title>    <link>https://juejin.cn/post/7602893600251838510</link>    <guid>https://juejin.cn/post/7602893600251838510</guid>    <pubDate>2026-02-05T03:14:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602893600251838510" data-draft-id="7602928386595848218" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SVGæ ‡ç­¾ä¸­pathè·¯å¾„å‚æ•°å­¦ä¹ "/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T03:14:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024å°ç¥"/> <meta itemprop="url" content="https://juejin.cn/user/70007368988926"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SVGæ ‡ç­¾ä¸­pathè·¯å¾„å‚æ•°å­¦ä¹ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/70007368988926/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024å°ç¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:14:19.000Z" title="Thu Feb 05 2026 03:14:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘çš„å¼€æºé¡¹ç›®PakePluså¯ä»¥å°†ç½‘é¡µ/Vue/Reacté¡¹ç›®æ‰“åŒ…ä¸ºæ¡Œé¢/æ‰‹æœºåº”ç”¨å¹¶ä¸”å°äº5Måªéœ€å‡ åˆ†é’Ÿï¼Œå®˜ç½‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpakeplus.com" target="_blank" title="https://pakeplus.com" ref="nofollow noopener noreferrer">pakeplus.com</a></p><p><img alt="" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/32bda2cb54964def8532da6d38131011~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" width="2628" loading="lazy"/></p><p/>
<p>å®˜æ–¹æ–‡æ¡£é“¾æ¥ï¼š<a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#path" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23path" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#path" target="_blank" ref="nofollow noopener noreferrer">developer.mozilla.org/zh-CN/docs/â€¦</a></p>
<p>è·¯å¾„å‘½ä»¤æ˜¯å¯¹è¦ç»˜åˆ¶çš„è·¯å¾„çš„è¯´æ˜ã€‚æ¯ä¸€ä¸ªå‘½ä»¤ç”±ä»£è¡¨å‘½ä»¤çš„å­—æ¯å’Œä»£è¡¨å‚æ•°çš„æ•°å­—ç»„æˆã€‚</p>
<p>SVG å®šä¹‰äº†å…­ç§è·¯å¾„å‘½ä»¤ç±»å‹ï¼Œä¸€å…± 20 æ¡å‘½ä»¤ï¼š</p>
<p>MoveToï¼šMã€m<br/>
LineToï¼šLã€lã€Hã€hã€Vã€v<br/>
ä¸‰æ¬¡è´å¡å°”æ›²çº¿ï¼šCã€cã€Sã€s<br/>
äºŒæ¬¡è´å¡å°”æ›²çº¿ï¼šQã€qã€Tã€t<br/>
æ¤­åœ†æ›²çº¿ï¼šAã€a<br/>
ClosePathï¼šZã€z<br/>
å¤‡æ³¨ï¼šå‘½ä»¤æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚å¤§å†™çš„å‘½ä»¤æŒ‡å®šç»å¯¹åæ ‡ï¼Œè€Œå°å†™å‘½ä»¤æŒ‡å®šç›¸å¯¹ï¼ˆäºå½“å‰ä½ç½®çš„ï¼‰åæ ‡ã€‚</p>
<p>å¤‡æ³¨ï¼šå‘½ä»¤æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚å¤§å†™çš„å‘½ä»¤æŒ‡å®šç»å¯¹åæ ‡ï¼Œè€Œå°å†™å‘½ä»¤æŒ‡å®šç›¸å¯¹ï¼ˆäºå½“å‰ä½ç½®çš„ï¼‰åæ ‡ã€‚</p>
<p>å§‹ç»ˆå¯ä»¥å°†è´Ÿå€¼ä½œä¸ºå‘½ä»¤çš„å‚æ•°ï¼š</p>
<p>è´Ÿçš„è§’åº¦æ˜¯é€†æ—¶é’ˆçš„ï¼›<br/>
ç»å¯¹åæ ‡ä¸­ï¼Œè´Ÿçš„ x å’Œ y å°†è¢«è§£é‡Šä¸ºè´Ÿåæ ‡ï¼›<br/>
ç›¸å¯¹åæ ‡ä¸­ï¼Œè´Ÿçš„ x å€¼ä¸ºå‘å·¦ç§»åŠ¨ï¼Œè´Ÿçš„ y å€¼ä¸ºå‘ä¸Šç§»åŠ¨ã€‚</p>
<p><img alt="" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8fbd5534562e41cf8074b6fe02f471a0~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" width="1534" loading="lazy"/></p>
<h3 id="user-content-lineto_è·¯å¾„å‘½ä»¤" data-id="heading-0"><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="Lineto è·¯å¾„å‘½ä»¤" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23lineto_%25E8%25B7%25AF%25E5%25BE%2584%25E5%2591%25BD%25E4%25BB%25A4" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#lineto_%E8%B7%AF%E5%BE%84%E5%91%BD%E4%BB%A4" target="_blank" ref="nofollow noopener noreferrer">Lineto è·¯å¾„å‘½ä»¤</a></h3>
<p><em>Lineto</em>Â æŒ‡ä»¤å°†ç»˜åˆ¶ä¸€æ¡ç›´çº¿æ®µã€‚è¿™ä¸ªç›´çº¿æ®µä»<em>å½“å‰ä½ç½®</em>ï¼ˆ<em>Po</em>; {<em>xo</em>,Â <em>yo</em>}ï¼‰ç§»åˆ°<em>æŒ‡å®šä½ç½®</em>ï¼ˆ<em>Pn</em>; {<em>xn</em>,Â <em>yn</em>}ï¼‰ã€‚ç„¶åï¼Œ<em>æŒ‡å®šä½ç½®</em>ï¼ˆ<em>Pn</em>ï¼‰å°†å˜æˆä¸‹ä¸€ä¸ªå‘½ä»¤ä¸­çš„<em>å½“å‰ä½ç½®</em>ï¼ˆ<em>Poâ€²</em>ï¼‰ã€‚</p>
<table>
	<tbody>
		<tr>
			<th scope="col">å‘½ä»¤</th>
			<th scope="col">å‚æ•°</th>
			<th scope="col">å¤‡æ³¨</th>
		</tr>
		<tr>
			<th scope="row">L</th>
			<td>(<code>x</code>,Â <code>y</code>)+</td>
			<td>
			<p>åœ¨<em>å½“å‰ä½ç½®</em>å’Œ<em>æŒ‡å®šä½ç½®</em>Â <code>x</code>,<code>y</code>Â ä¹‹é—´ç»˜åˆ¶ä¸€æ¡çº¿æ®µã€‚åç»­å­åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç»å¯¹ä½ç½®çš„ LineToï¼ˆ<code>L</code>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚</p>
<pre><code class="hljs language-xml" lang="xml">		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>l<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>)+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¹‹é—´ç»˜åˆ¶ä¸€æ¡çº¿æ®µï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ã€‚åç»­å­åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç›¸å¯¹ä½ç½®çš„ LineToï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>L<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {xo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span>yo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>H<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¹‹é—´ç»˜åˆ¶ä¸€æ¡æ°´å¹³çº¿æ®µã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ç”±<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å‚æ•°å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>çš„<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>åæ ‡æŒ‡å®šã€‚åç»­å­åºåˆ—çš„å€¼å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç»å¯¹ä½ç½®çš„ LineToï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>H<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span>yo}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>h<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¹‹é—´ç»˜åˆ¶ä¸€æ¡æ°´å¹³çº¿æ®µã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ç”±<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>çš„<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>åæ ‡å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>çš„<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>åæ ‡æŒ‡å®šã€‚åç»­å­åºåˆ—çš„å€¼å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç›¸å¯¹ä½ç½®çš„ LineToï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>h<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {xo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span>yo}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>V<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¹‹é—´ç»˜åˆ¶ä¸€æ¡å‚ç›´çº¿æ®µã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ç”±<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å‚æ•°å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>çš„<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>åæ ‡æŒ‡å®šã€‚åç»­å­åºåˆ—çš„å€¼å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç»å¯¹ä½ç½®çš„ LineToï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>V<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {xo,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>v<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¹‹é—´ç»˜åˆ¶ä¸€æ¡å‚ç›´çº¿æ®µã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æŒ‡å®šä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ç”±<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>çš„<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>åæ ‡å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>çš„<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>åæ ‡æŒ‡å®šã€‚åç»­å­åºåˆ—çš„å€¼å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç›¸å¯¹ä½ç½®çš„ LineToï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>v<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {xo,<span class="hljs-symbol">&amp;nbsp;</span>yo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
</code></pre>
</td></tr></tbody></table>
<p>ç¤ºä¾‹</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 0 200 100"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ä½¿ç”¨ç»å¯¹åæ ‡çš„ LineTo å‘½ä»¤ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"red"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 10,10
           L 90,90
           V 10
           H 50"</span> /&gt;</span>

  <span class="hljs-comment">&lt;!-- ä½¿ç”¨ç›¸å¯¹åæ ‡çš„ LineTo å‘½ä»¤ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"red"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 110,10
           l 80,80
           v -80
           h -40"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></code></pre>
<p><img alt="" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4adc39e589b944a2a18cf612924ea5a0~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" width="1246" loading="lazy"/></p>
<h3 id="user-content-ä¸‰æ¬¡è´å¡å°”æ›²çº¿" data-id="heading-1"><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="ä¸‰æ¬¡è´å¡å°”æ›²çº¿" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E4%25B8%2589%25E6%25AC%25A1%25E8%25B4%259D%25E5%25A1%259E%25E5%25B0%2594%25E6%259B%25B2%25E7%25BA%25BF" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E4%B8%89%E6%AC%A1%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF" target="_blank" ref="nofollow noopener noreferrer">ä¸‰æ¬¡è´å¡å°”æ›²çº¿</a></h3>
<p><em>ä¸‰æ¬¡</em><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="è´å¡å°”æ›²çº¿" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FGlossary%2FBezier_curve" title="https://developer.mozilla.org/zh-CN/docs/Glossary/Bezier_curve" target="_blank" ref="nofollow noopener noreferrer">è´å¡å°”æ›²çº¿</a>æ˜¯ä½¿ç”¨å››ä¸ªç‚¹å®šä¹‰çš„å¹³æ»‘æ›²çº¿ï¼š</p>
<p><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="èµ·å§‹ç‚¹ï¼ˆå½“å‰ä½ç½®ï¼‰" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E8%25B5%25B7%25E5%25A7%258B%25E7%2582%25B9%25EF%25BC%2588%25E5%25BD%2593%25E5%2589%258D%25E4%25BD%258D%25E7%25BD%25AE%25EF%25BC%2589" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E8%B5%B7%E5%A7%8B%E7%82%B9%EF%BC%88%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%EF%BC%89" target="_blank" ref="nofollow noopener noreferrer">èµ·å§‹ç‚¹ï¼ˆå½“å‰ä½ç½®ï¼‰</a></p>
<p>(<em>Po</em>Â = {<em>xo</em>,Â <em>yo</em>})</p>
<p><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="ç»ˆç‚¹" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E7%25BB%2588%25E7%2582%25B9" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E7%BB%88%E7%82%B9" target="_blank" ref="nofollow noopener noreferrer">ç»ˆç‚¹</a></p>
<p>(<em>Pn</em>Â = {<em>xn</em>,Â <em>yn</em>})</p>
<p><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="èµ·å§‹æ§åˆ¶ç‚¹" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E8%25B5%25B7%25E5%25A7%258B%25E6%258E%25A7%25E5%2588%25B6%25E7%2582%25B9" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E8%B5%B7%E5%A7%8B%E6%8E%A7%E5%88%B6%E7%82%B9" target="_blank" ref="nofollow noopener noreferrer">èµ·å§‹æ§åˆ¶ç‚¹</a></p>
<p>(<em>Pcs</em>Â = {<em>xcs</em>,Â <em>ycs</em>})ï¼ˆæ§åˆ¶åœ¨èµ·ç‚¹é™„è¿‘çš„æ›²çº¿çš„æ›²ç‡ï¼‰</p>
<p><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="ç»ˆç‚¹æ§åˆ¶ç‚¹" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E7%25BB%2588%25E7%2582%25B9%25E6%258E%25A7%25E5%2588%25B6%25E7%2582%25B9" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E7%BB%88%E7%82%B9%E6%8E%A7%E5%88%B6%E7%82%B9" target="_blank" ref="nofollow noopener noreferrer">ç»ˆç‚¹æ§åˆ¶ç‚¹</a></p>
<p>(<em>Pce</em>Â = {<em>xce</em>,Â <em>yce</em>})ï¼ˆæ§åˆ¶åœ¨ç»ˆç‚¹é™„è¿‘çš„æ›²çº¿çš„æ›²ç‡ï¼‰</p>
<p>ç»˜åˆ¶åï¼Œ<em>ç»ˆç‚¹</em>ï¼ˆ<em>Pn</em>ï¼‰å°†æˆä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤ä¸­çš„<em>å½“å‰ä½ç½®</em>ï¼ˆ<em>Poâ€²</em>ï¼‰ã€‚</p>
<table>
	<tbody>
		<tr>
			<th scope="col">å‘½ä»¤</th>
			<th scope="col">å‚æ•°</th>
			<th scope="col">å¤‡æ³¨</th>
		</tr>
		<tr>
			<th scope="row">C</th>
			<td>(<code>x1</code>,<code>y1</code>,Â <code>x2</code>,<code>y2</code>,Â <code>x</code>,<code>y</code>)+</td>
			<td>
			<p>åœ¨<em>å½“å‰ä½ç½®</em>å’Œ<em>ç»ˆç‚¹</em>Â <code>x</code>,<code>y</code>Â ä¹‹é—´ç»˜åˆ¶ä¸€æ¡ä¸‰æ¬¡è´å¡å°”æ›²çº¿ã€‚<em>èµ·å§‹æ§åˆ¶ç‚¹</em>é€šè¿‡Â <code>x1</code>,<code>y1</code>Â æŒ‡å®šï¼Œè€Œ<em>ç»ˆç‚¹æ§åˆ¶ç‚¹</em>é€šè¿‡Â <code>x2</code>,<code>y2</code>Â æŒ‡å®šã€‚åç»­çš„ä¸‰å…ƒç»„åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç»å¯¹ä½ç½®çš„ä¸‰æ¬¡è´å¡å°”æ›²çº¿ï¼ˆ<code>C</code>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚</p>
<pre><code class="hljs language-xml" lang="xml">		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">data-link-icon</span>=<span class="hljs-string">"https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8"</span> <span class="hljs-attr">data-link-title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E5%85%AC%E5%BC%8F%EF%BC%9A"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>} ;<span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
		Pcs<span class="hljs-symbol">&amp;nbsp;</span>= {<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>} ;<span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
		Pce<span class="hljs-symbol">&amp;nbsp;</span>= {<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>c<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>)+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ï¼‰ä¹‹é—´ç»˜åˆ¶ä¸€æ¡ä¸‰æ¬¡è´å¡å°”æ›²çº¿ã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>èµ·å§‹æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ï¼›è€Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ã€‚åç»­çš„ä¸‰å…ƒç»„åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç›¸å¯¹ä½ç½®çš„ä¸‰æ¬¡è´å¡å°”æ›²çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>c<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">data-link-icon</span>=<span class="hljs-string">"https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8"</span> <span class="hljs-attr">data-link-title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E5%85%AC%E5%BC%8F%EF%BC%9A_2"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {xo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span>yo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>} ;<span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
		Pcs<span class="hljs-symbol">&amp;nbsp;</span>= {xo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span>yo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>} ;<span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
		Pce<span class="hljs-symbol">&amp;nbsp;</span>= {xo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span>yo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>S<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>)+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä¹‹é—´ç»˜åˆ¶ä¸€æ¡å¹³æ»‘çš„ä¸‰æ¬¡è´å¡å°”æ›²çº¿ã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>é€šè¿‡<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>æŒ‡å®šã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>èµ·å§‹æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ˜¯ä¸Šä¸€æ¡æ›²çº¿å‘½ä»¤çš„<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸Šçš„åå°„ç‚¹ï¼›è‹¥ä¸Šä¸€æ¡å‘½ä»¤ä¸æ˜¯æ›²çº¿å‘½ä»¤ï¼Œåˆ™å…¶ä¸æ›²çº¿çš„èµ·å§‹ç‚¹ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼‰ç›¸åŒã€‚åç»­æˆå¯¹çš„åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç»å¯¹ä½ç½®çš„å¹³æ»‘ä¸‰æ¬¡è´å¡å°”æ›²çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>S<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>s<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>)+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ï¼‰ä¹‹é—´ç»˜åˆ¶ä¸€æ¡å¹³æ»‘çš„ä¸‰æ¬¡è´å¡å°”æ›²çº¿ã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy2<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>èµ·å§‹æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ˜¯ä¸Šä¸€æ¡æ›²çº¿å‘½ä»¤çš„<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸Šçš„åå°„ç‚¹ï¼›è‹¥ä¸Šä¸€æ¡å‘½ä»¤ä¸æ˜¯æ›²çº¿å‘½ä»¤ï¼Œåˆ™å…¶ä¸æ›²çº¿çš„èµ·å§‹ç‚¹ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼‰ç›¸åŒã€‚åç»­æˆå¯¹çš„åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç›¸å¯¹ä½ç½®çš„å¹³æ»‘ä¸‰æ¬¡è´å¡å°”æ›²çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>s<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
</code></pre>
</td></tr></tbody></table>
<p>ç¤ºä¾‹</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>
  <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 0 200 100"</span>
  <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span>
  <span class="hljs-attr">xmlns:xlink</span>=<span class="hljs-string">"http://www.w3.org/1999/xlink"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ä½¿ç”¨ç»å¯¹åæ ‡çš„ä¸‰æ¬¡è´å¡å°”æ›²çº¿ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"red"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 10,90
           C 30,90 25,10 50,10
           S 70,90 90,90"</span> /&gt;</span>

  <span class="hljs-comment">&lt;!-- ä½¿ç”¨ç›¸å¯¹åæ ‡çš„ä¸‰æ¬¡è´å¡å°”æ›²çº¿ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"red"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 110,90
           c 20,0 15,-80 40,-80
           s 20,80 40,80"</span> /&gt;</span>

  <span class="hljs-comment">&lt;!-- é«˜äº®æ˜¾ç¤ºæ›²çº¿é¡¶ç‚¹å’Œæ§åˆ¶ç‚¹ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"ControlPoints"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ç¬¬ä¸€æ®µä¸‰æ¬¡è´å¡å°”æ›²çº¿çš„æ§åˆ¶ç‚¹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">line</span> <span class="hljs-attr">x1</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">y1</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">x2</span>=<span class="hljs-string">"30"</span> <span class="hljs-attr">y2</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">"lightgrey"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"30"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">line</span> <span class="hljs-attr">x1</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">y1</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">x2</span>=<span class="hljs-string">"25"</span> <span class="hljs-attr">y2</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">"lightgrey"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"25"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- ç¬¬äºŒæ®µå¹³æ»‘ä¸‰æ¬¡è´å¡å°”æ›²çº¿çš„æ§åˆ¶ç‚¹ï¼ˆç¬¬ä¸€ä¸ªæ˜¯éšå¼çš„ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">line</span>
      <span class="hljs-attr">x1</span>=<span class="hljs-string">"50"</span>
      <span class="hljs-attr">y1</span>=<span class="hljs-string">"10"</span>
      <span class="hljs-attr">x2</span>=<span class="hljs-string">"75"</span>
      <span class="hljs-attr">y2</span>=<span class="hljs-string">"10"</span>
      <span class="hljs-attr">stroke</span>=<span class="hljs-string">"lightgrey"</span>
      <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">"2"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"75"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"lightgrey"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">line</span> <span class="hljs-attr">x1</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">y1</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">x2</span>=<span class="hljs-string">"70"</span> <span class="hljs-attr">y2</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">"lightgrey"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"70"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- æ›²çº¿é¡¶ç‚¹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"90"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">use</span> <span class="hljs-attr">xlink:href</span>=<span class="hljs-string">"#ControlPoints"</span> <span class="hljs-attr">x</span>=<span class="hljs-string">"100"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></code></pre>
<p><img alt="" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/98ce867a36a444d6b8b3d38ce4a57879~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" width="1008" loading="lazy"/></p>
<h3 id="user-content-äºŒæ¬¡è´å¡å°”æ›²çº¿" data-id="heading-2"><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="äºŒæ¬¡è´å¡å°”æ›²çº¿" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E4%25BA%258C%25E6%25AC%25A1%25E8%25B4%259D%25E5%25A1%259E%25E5%25B0%2594%25E6%259B%25B2%25E7%25BA%25BF" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E4%BA%8C%E6%AC%A1%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF" target="_blank" ref="nofollow noopener noreferrer">äºŒæ¬¡è´å¡å°”æ›²çº¿</a></h3>
<p><em>äºŒæ¬¡</em><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="è´å¡å°”æ›²çº¿" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FGlossary%2FBezier_curve" title="https://developer.mozilla.org/zh-CN/docs/Glossary/Bezier_curve" target="_blank" ref="nofollow noopener noreferrer">è´å¡å°”æ›²çº¿</a>æ˜¯ä½¿ç”¨ä¸‰ä¸ªç‚¹å®šä¹‰çš„å¹³æ»‘æ›²çº¿ï¼š</p>
<p><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="èµ·å§‹ç‚¹ï¼ˆå½“å‰ä½ç½®ï¼‰" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E8%25B5%25B7%25E5%25A7%258B%25E7%2582%25B9%25EF%25BC%2588%25E5%25BD%2593%25E5%2589%258D%25E4%25BD%258D%25E7%25BD%25AE%25EF%25BC%2589_2" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E8%B5%B7%E5%A7%8B%E7%82%B9%EF%BC%88%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%EF%BC%89_2" target="_blank" ref="nofollow noopener noreferrer">èµ·å§‹ç‚¹ï¼ˆå½“å‰ä½ç½®ï¼‰</a></p>
<p><em>Po</em>Â = {<em>xo</em>,Â <em>yo</em>}</p>
<p><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="ç»ˆç‚¹" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E7%25BB%2588%25E7%2582%25B9_2" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E7%BB%88%E7%82%B9_2" target="_blank" ref="nofollow noopener noreferrer">ç»ˆç‚¹</a></p>
<p><em>Pn</em>Â = {<em>xn</em>,Â <em>yn</em>}</p>
<p><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="æ§åˆ¶ç‚¹" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E6%258E%25A7%25E5%2588%25B6%25E7%2582%25B9" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E6%8E%A7%E5%88%B6%E7%82%B9" target="_blank" ref="nofollow noopener noreferrer">æ§åˆ¶ç‚¹</a></p>
<p><em>Pc</em>Â = {<em>xc</em>,Â <em>yc</em>}ï¼ˆæ§åˆ¶æ›²ç‡ï¼‰</p>
<p>ç»˜åˆ¶åï¼Œ<em>ç»ˆç‚¹</em>ï¼ˆ<em>Pn</em>ï¼‰å°†æˆä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤ä¸­çš„<em>å½“å‰ä½ç½®</em>ï¼ˆ<em>Poâ€²</em>ï¼‰ã€‚</p>
<table>
	<tbody>
		<tr>
			<th scope="col">å‘½ä»¤</th>
			<th scope="col">å‚æ•°</th>
			<th scope="col">å¤‡æ³¨</th>
		</tr>
		<tr>
			<th scope="row">Q</th>
			<td>(<code>x1</code>,<code>y1</code>,Â <code>x</code>,<code>y</code>)+</td>
			<td>
			<p>åœ¨<em>å½“å‰ä½ç½®</em>å’Œ<em>ç»ˆç‚¹</em>Â <code>x</code>,<code>y</code>Â ä¹‹é—´ç»˜åˆ¶ä¸€æ¡äºŒæ¬¡è´å¡å°”æ›²çº¿ã€‚<em>æ§åˆ¶ç‚¹</em>é€šè¿‡Â <code>x1</code>,<code>y1</code>Â æŒ‡å®šã€‚åç»­æˆå¯¹çš„åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç»å¯¹ä½ç½®çš„äºŒæ¬¡è´å¡å°”æ›²çº¿ï¼ˆ<code>Q</code>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚</p>
<pre><code class="hljs language-xml" lang="xml">		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">data-link-icon</span>=<span class="hljs-string">"https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8"</span> <span class="hljs-attr">data-link-title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E5%85%AC%E5%BC%8F%EF%BC%9A_3"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>} ;<span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
		Pc<span class="hljs-symbol">&amp;nbsp;</span>= {<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>q<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>)+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ï¼‰ä¹‹é—´ç»˜åˆ¶ä¸€æ¡äºŒæ¬¡è´å¡å°”æ›²çº¿ã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼ˆæ›²çº¿çš„èµ·å§‹ç‚¹ï¼‰æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ã€‚åç»­æˆå¯¹çš„åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç›¸å¯¹ä½ç½®çš„äºŒæ¬¡è´å¡å°”æ›²çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>q<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">data-link-icon</span>=<span class="hljs-string">"https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8"</span> <span class="hljs-attr">data-link-title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E5%85%AC%E5%BC%8F%EF%BC%9A_4"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {xo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span>yo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>} ;<span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
		Pc<span class="hljs-symbol">&amp;nbsp;</span>= {xo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span>yo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>T<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>)+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä¹‹é—´ç»˜åˆ¶ä¸€æ¡å¹³æ»‘çš„äºŒæ¬¡è´å¡å°”æ›²çº¿ã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ˜¯ä¸Šä¸€æ¡æ›²çº¿å‘½ä»¤çš„<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸Šçš„åå°„ç‚¹ï¼›è‹¥ä¸Šä¸€æ¡å‘½ä»¤ä¸æ˜¯æ›²çº¿å‘½ä»¤ï¼Œåˆ™å…¶ä¸æ›²çº¿çš„èµ·å§‹ç‚¹ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼‰ç›¸åŒã€‚åç»­çš„åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç»å¯¹ä½ç½®çš„å¹³æ»‘äºŒæ¬¡è´å¡å°”æ›²çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>T<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">data-link-icon</span>=<span class="hljs-string">"https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8"</span> <span class="hljs-attr">data-link-title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E5%85%AC%E5%BC%8F%EF%BC%9A_5"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>t<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>)+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç»ˆç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ï¼‰ä¹‹é—´ç»˜åˆ¶ä¸€æ¡å¹³æ»‘çš„äºŒæ¬¡è´å¡å°”æ›²çº¿ã€‚<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>æ˜¯ä¸Šä¸€æ¡æ›²çº¿å‘½ä»¤çš„<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>æ§åˆ¶ç‚¹<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>åœ¨<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ä¸Šçš„åå°„ç‚¹ï¼›è‹¥ä¸Šä¸€æ¡å‘½ä»¤ä¸æ˜¯æ›²çº¿å‘½ä»¤ï¼Œåˆ™å…¶ä¸æ›²çº¿çš„èµ·å§‹ç‚¹ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å½“å‰ä½ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼‰ç›¸åŒã€‚åç»­çš„åæ ‡åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç›¸å¯¹ä½ç½®çš„å¹³æ»‘äºŒæ¬¡è´å¡å°”æ›²çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>t<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">data-link-icon</span>=<span class="hljs-string">"https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8"</span> <span class="hljs-attr">data-link-title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E5%85%AC%E5%BC%8F%EF%BC%9A_6"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"å…¬å¼ï¼š"</span>&gt;</span>å…¬å¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Po<span class="hljs-symbol">&amp;prime;</span><span class="hljs-symbol">&amp;nbsp;</span>=<span class="hljs-symbol">&amp;nbsp;</span>Pn<span class="hljs-symbol">&amp;nbsp;</span>= {xo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-symbol">&amp;nbsp;</span>yo<span class="hljs-symbol">&amp;nbsp;</span>+<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
</code></pre>
</td></tr></tbody></table>
<p>ç¤ºä¾‹</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>
  <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 0 200 100"</span>
  <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span>
  <span class="hljs-attr">xmlns:xlink</span>=<span class="hljs-string">"http://www.w3.org/1999/xlink"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- äºŒæ¬¡è´å¡å°”æ›²çº¿ï¼Œå¸¦æœ‰éšå¼é‡å¤ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"red"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 10,50
           Q 25,25 40,50
           t 30,0 30,0 30,0 30,0 30,0"</span> /&gt;</span>

  <span class="hljs-comment">&lt;!-- é«˜äº®æ˜¾ç¤ºæ›²çº¿é¡¶ç‚¹å’Œæ§åˆ¶ç‚¹ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">g</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">polyline</span> <span class="hljs-attr">points</span>=<span class="hljs-string">"10,50 25,25 40,50"</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">"rgba(0,0,0,.2)"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"25"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"25"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- æ›²çº¿é¡¶ç‚¹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"40"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"SmoothQuadraticDown"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">polyline</span>
        <span class="hljs-attr">points</span>=<span class="hljs-string">"40,50 55,75 70,50"</span>
        <span class="hljs-attr">stroke</span>=<span class="hljs-string">"rgba(0,0,0,.2)"</span>
        <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">"2"</span>
        <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"55"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"75"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"lightgrey"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"70"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"SmoothQuadraticUp"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">polyline</span>
        <span class="hljs-attr">points</span>=<span class="hljs-string">"70,50 85,25 100,50"</span>
        <span class="hljs-attr">stroke</span>=<span class="hljs-string">"rgba(0,0,0,.2)"</span>
        <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">"2"</span>
        <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"85"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"25"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"lightgrey"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"1.5"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">use</span> <span class="hljs-attr">xlink:href</span>=<span class="hljs-string">"#SmoothQuadraticDown"</span> <span class="hljs-attr">x</span>=<span class="hljs-string">"60"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">use</span> <span class="hljs-attr">xlink:href</span>=<span class="hljs-string">"#SmoothQuadraticUp"</span> <span class="hljs-attr">x</span>=<span class="hljs-string">"60"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">use</span> <span class="hljs-attr">xlink:href</span>=<span class="hljs-string">"#SmoothQuadraticDown"</span> <span class="hljs-attr">x</span>=<span class="hljs-string">"120"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></code></pre>
<p><img alt="" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ea010fbb5eae47da9880aebe6b777277~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" width="858" loading="lazy"/></p>
<h3 id="user-content-æ¤­åœ†æ›²çº¿" data-id="heading-3"><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="æ¤­åœ†æ›²çº¿" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23%25E6%25A4%25AD%25E5%259C%2586%25E6%259B%25B2%25E7%25BA%25BF" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF" target="_blank" ref="nofollow noopener noreferrer">æ¤­åœ†æ›²çº¿</a></h3>
<p><em>æ¤­åœ†æ›²çº¿</em>æ˜¯å®šä¹‰ä¸ºæ¤­åœ†çš„ä¸€éƒ¨åˆ†çš„æ›²çº¿ã€‚æœ‰æ—¶ï¼Œä½¿ç”¨æ¤­åœ†æ›²çº¿ç»˜åˆ¶é«˜åº¦è§„åˆ™çš„æ›²çº¿ä¼šæ¯”ä½¿ç”¨è´å¡å°”æ›²çº¿æ›´å®¹æ˜“ã€‚</p>
<table>
	<tbody>
		<tr>
			<th scope="col">å‘½ä»¤</th>
			<th scope="col">å‚æ•°</th>
			<th scope="col">å¤‡æ³¨</th>
		</tr>
		<tr>
			<th scope="row">A</th>
			<td>(<code>rx</code>Â <code>ry</code>Â <code>angle</code>Â <code>large-arc-flag</code>Â <code>sweep-flag</code>Â <code>x</code>Â <code>y</code>)+</td>
			<td>
			<p>åœ¨å½“å‰ä½ç½®å’Œåæ ‡Â <code>x</code>,<code>y</code>Â ä¹‹é—´ç»˜åˆ¶ä¸€æ¡æ¤­åœ†æ›²çº¿ã€‚ç”¨äºç»˜åˆ¶åœ†å¼§çš„æ¤­åœ†ä¸­å¿ƒæ ¹æ®å‘½ä»¤çš„å…¶ä»–å‚æ•°ç¡®å®šï¼š</p>
<pre><code class="hljs language-xml" lang="xml">		<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
			<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>rx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>ry<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>æ˜¯æ¤­åœ†çš„ä¸¤ä¸ªåŠå¾„ï¼›<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
			<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>angle<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>è¡¨ç¤ºæ¤­åœ†ç›¸å¯¹äº x è½´çš„æ—‹è½¬è§’åº¦ï¼›<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
			<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>large-arc-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å’Œ<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>sweep-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å…è®¸é€‰æ‹©å¿…é¡»ç»˜åˆ¶çš„å¼§çº¿ï¼Œå› ä¸ºå…¶ä»–å‚æ•°å¯ä»¥ç»˜åˆ¶ 4 æ¡å¯èƒ½çš„å¼§çº¿ã€‚
			<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
				<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>large-arc-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å…è®¸é€‰æ‹©ä¸€ä¸ªå¤§å¼§çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰æˆ–ä¸€ä¸ªå°å¼§çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰ï¼Œ<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
				<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>sweep-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å…è®¸é€‰æ‹©ä¸€æ¡é¡ºæ—¶é’ˆæ—‹è½¬çš„å¼§çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰æˆ–ä¸€æ¡é€†æ—¶é’ˆæ—‹è½¬çš„å¼§çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
			<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
			<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
		åæ ‡<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>,<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>y<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å°†æˆä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤ä¸­çš„å½“å‰ä½ç½®ã€‚åç»­å‚æ•°é›†åˆçš„åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç»å¯¹ä½ç½®çš„æ¤­åœ†æ›²çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>a<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>rx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>ry<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>angle<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>large-arc-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>sweep-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>)+<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨å½“å‰ä½ç½®å’ŒæŒ‡å®šä½ç½®ä¹‹é—´ç»˜åˆ¶ä¸€æ¡æ¤­åœ†æ›²çº¿ã€‚æŒ‡å®šä½ç½®ä¸ºå½“å‰ä½ç½®æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dy<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å¤„ã€‚ç”¨äºç»˜åˆ¶åœ†å¼§çš„æ¤­åœ†ä¸­å¿ƒæ ¹æ®å‘½ä»¤çš„å…¶ä»–å‚æ•°ç¡®å®šï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
			<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>rx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å’Œ<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>ry<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>æ˜¯æ¤­åœ†çš„ä¸¤ä¸ªåŠå¾„ï¼›<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
			<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>angle<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>è¡¨ç¤ºæ¤­åœ†ç›¸å¯¹äº x è½´çš„æ—‹è½¬è§’åº¦ï¼›<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
			<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>large-arc-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å’Œ<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>sweep-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å…è®¸é€‰æ‹©å¿…é¡»ç»˜åˆ¶çš„å¼§çº¿ï¼Œå› ä¸ºå…¶ä»–å‚æ•°å¯ä»¥ç»˜åˆ¶ 4 æ¡å¯èƒ½çš„å¼§çº¿ã€‚
			<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
				<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>large-arc-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å…è®¸é€‰æ‹©ä¸€ä¸ªå¤§å¼§çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰æˆ–ä¸€ä¸ªå°å¼§çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰ï¼Œ<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
				<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>sweep-flag<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>å…è®¸é€‰æ‹©ä¸€æ¡é¡ºæ—¶é’ˆæ—‹è½¬çš„å¼§çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰æˆ–ä¸€æ¡é€†æ—¶é’ˆæ—‹è½¬çš„å¼§çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
			<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
			<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
		å½“å‰ä½ç½®æ²¿ x è½´åç§»<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>dx<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-symbol">&amp;nbsp;</span>ä»¥åŠæ²¿ y è½´åç§»åçš„ä½ç½®å°†æˆä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤ä¸­çš„å½“å‰ä½ç½®ã€‚åç»­å‚æ•°é›†åˆçš„åºåˆ—å°†è¢«è§£é‡Šä¸ºéšå¼çš„ç›¸å¯¹ä½ç½®çš„æ¤­åœ†æ›²çº¿ï¼ˆ<span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>a<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>ï¼‰å‘½ä»¤çš„å‚æ•°ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
</code></pre>
</td></tr></tbody></table>
<p>ç¤ºä¾‹</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 0 20 20"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- é€šè¿‡å¼§å½¢æ ‡å¿—ç»˜åˆ¶ä¸åŒçš„å¼§å½¢è·¯å¾„ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"red"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 6,10
           A 6 4 10 1 0 14,10"</span> /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"lime"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 6,10
           A 6 4 10 1 1 14,10"</span> /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"purple"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 6,10
           A 6 4 10 0 1 14,10"</span> /&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"pink"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 6,10
           A 6 4 10 0 0 14,10"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></code></pre>
<p><img alt="" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9d9fb5bd2d54424fb43d956153a7c48c~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" width="872" loading="lazy"/></p>
<h3 id="user-content-closepath" data-id="heading-4"><a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="ClosePath" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fd%23closepath" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/d#closepath" target="_blank" ref="nofollow noopener noreferrer">ClosePath</a></h3>
<p><em>ClosePath</em>Â å‘½ä»¤å°†ä»<em>å½“å‰ä½ç½®</em>ç»˜åˆ¶ä¸€æ¡ç›´çº¿åˆ°è·¯å¾„ä¸­çš„ç¬¬ä¸€ä¸ªç‚¹ã€‚</p>
<table>
	<tbody>
		<tr>
			<th scope="col">å‘½ä»¤</th>
			<th scope="col">å‚æ•°</th>
			<th scope="col">å¤‡æ³¨</th>
		</tr>
		<tr>
			<th scope="row">Z, z</th>
			<td/>
			<td>é€šè¿‡è¿æ¥è·¯å¾„çš„æœ€åä¸€ä¸ªç‚¹ä¸è·¯å¾„çš„èµ·å§‹ç‚¹æ¥é—­åˆå½“å‰çš„å­è·¯å¾„ã€‚å¦‚æœè¿™ä¸¤ä¸ªç‚¹çš„åæ ‡ä¸åŒï¼Œåˆ™åœ¨ä¸¤è€…ä¹‹é—´ç»˜åˆ¶ä¸€æ¡ç›´çº¿ã€‚</td>
		</tr>
	</tbody>
</table>
<p><strong>å¤‡æ³¨ï¼š</strong>ä½¿ç”¨Â <em>ClosePath</em>Â å‘½ä»¤é—­åˆçš„å½¢çŠ¶çš„å¤–è§‚å¯èƒ½ä¸ä½¿ç”¨å…¶ä»–å‘½ä»¤å‘èµ·å§‹ç‚¹ç»˜åˆ¶ä¸€æ¡çº¿è€Œé—­åˆçš„å½¢çŠ¶ä¸åŒï¼Œå› ä¸ºå‰è€…æ˜¯å°†çº¿æ¡çš„æœ«ç«¯è¿æ¥åœ¨ä¸€èµ·ï¼ˆæ ¹æ®Â <a data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="stroke-linejoin" href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Fstroke-linejoin" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/stroke-linejoin" target="_blank" ref="nofollow noopener noreferrer">stroke-linejoin</a>Â çš„è®¾ç½®ï¼‰ï¼Œè€Œä¸æ˜¯ä»…ä»…ç»˜åˆ¶åˆ°åæ ‡ç‚¹ä¸Šã€‚</p>
<p>ç¤ºä¾‹</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 -1 30 11"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span>&gt;</span>
  <span class="hljs-comment">&lt;!--
  ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ä¸åŒçš„å¼€æ”¾å½¢çŠ¶
  --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"red"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 5,1
           l -4,8 8,0"</span> /&gt;</span>

  <span class="hljs-comment">&lt;!--
  ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ç›¸åŒçš„å¼€æ”¾å½¢çŠ¶
  --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"red"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 15,1
           l -4,8 8,0 -4,-8"</span> /&gt;</span>

  <span class="hljs-comment">&lt;!--
  ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ä¸åŒçš„é—­åˆå½¢çŠ¶
  --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span>
    <span class="hljs-attr">stroke</span>=<span class="hljs-string">"red"</span>
    <span class="hljs-attr">d</span>=<span class="hljs-string">"M 25,1
           l -4,8 8,0
           z"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></code></pre>
<p><img alt="" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8a58c4cf549e4948a4fa3f6318162f3f~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" width="1106" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å±å¹•ä¸å¤Ÿï¼Œç®—æ³•æ¥å‡‘(äºŒ)ï¼šESP32 å•è‰²å±ä¸Šçš„ Ditherpunk å®æˆ˜]]></title>    <link>https://juejin.cn/post/7602894102992093194</link>    <guid>https://juejin.cn/post/7602894102992093194</guid>    <pubDate>2026-02-05T01:48:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602894102992093194" data-draft-id="7602893600251133998" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å±å¹•ä¸å¤Ÿï¼Œç®—æ³•æ¥å‡‘(äºŒ)ï¼šESP32 å•è‰²å±ä¸Šçš„ Ditherpunk å®æˆ˜"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2026-02-05T01:48:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="chaosgoo"/> <meta itemprop="url" content="https://juejin.cn/user/2541726616010317"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å±å¹•ä¸å¤Ÿï¼Œç®—æ³•æ¥å‡‘(äºŒ)ï¼šESP32 å•è‰²å±ä¸Šçš„ Ditherpunk å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2541726616010317/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    chaosgoo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:48:26.000Z" title="Thu Feb 05 2026 01:48:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡é¦–å‘äºæˆ‘çš„ä¸ªäººåšå®¢ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fchaosgoo.com%2F2025%2F12%2F30%2FDitherpunk-The-Art-of-Dithering-2-ESP32%2F" target="_blank" title="https://chaosgoo.com/2025/12/30/Ditherpunk-The-Art-of-Dithering-2-ESP32/" ref="nofollow noopener noreferrer">chaosgoo.com</a>ï¼Œæ¬¢è¿æ¥è®¿äº¤æµã€‚</p>
</blockquote>
<blockquote>
<p>ç”±äºæ˜é‡‘æ— æ³•è¿è¡Œè‡ªå®šä¹‰çš„Javascriptè„šæœ¬,æ‰€ä»¥ä¸Šä¸€ç¯‡æ–‡ç« æ— æ³•å‘å¸ƒåœ¨æ­¤, æƒ³è¦é˜…è¯»ä¸Šç¯‡æ–‡ç« è¯·åˆ°æºç«™ç‚¹äº†è§£æ›´å¤š,
<a href="https://link.juejin.cn?target=https%3A%2F%2Fchaosgoo.com%2F2025%2F12%2F22%2FDitherpunk-The-Art-of-Dithering%2F" target="_blank" title="https://chaosgoo.com/2025/12/22/Ditherpunk-The-Art-of-Dithering/" ref="nofollow noopener noreferrer">å±å¹•ä¸å¤Ÿï¼Œç®—æ³•æ¥å‡‘(ä¸€)ï¼šDitherpunk æŠ–åŠ¨ç®—æ³•åŸç†ä¸ JS å®æ—¶æ¼”ç¤º</a></p>
</blockquote>
<blockquote>
<p>åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fchaosgoo.com%2F2025%2F12%2F22%2FDitherpunk-The-Art-of-Dithering%2F" target="_blank" title="https://chaosgoo.com/2025/12/22/Ditherpunk-The-Art-of-Dithering/" ref="nofollow noopener noreferrer">ä¸Šç¯‡æ–‡ç« </a>ä¸­æˆ‘ç”¨ JS å®ç°äº†ä¸€ä¸ªå¯äº¤äº’çš„å¯¹æ¯”å·¥å…·ï¼Œå»ºè®®é…åˆé£Ÿç”¨ä»¥ç†è§£ç®—æ³•è¯¯å·®åˆ†é…çš„æ•°å­¦åŸç†ã€‚è™½ç„¶åŸç†é€šé€äº†ï¼Œä½†çœŸæ­£çš„æŒ‘æˆ˜åœ¨äºç¡¬ä»¶ç«¯ï¼š<strong>å¦‚ä½•åœ¨èµ„æºå—é™çš„åµŒå…¥å¼è®¾å¤‡ä¸Šå¤ç°è¿™äº›æ•ˆæœï¼Ÿ</strong></p>
</blockquote>
<p>æœ¬æ–‡å°†è®°å½•æˆ‘åŸºäº ESP32-S3 å’Œä¸€å— 1.54 å¯¸ ST7305 å•è‰²å±çš„å®æˆ˜è¿‡ç¨‹ï¼Œæ¢è®¨å¦‚ä½•åœ¨å•ç‰‡æœºä¸Šå®ç°ä»åŸºç¡€çš„é˜ˆå€¼æ³•åˆ°å¤æ‚çš„è¯¯å·®æ‰©æ•£ç­‰å¤šç§å›¾åƒå¤„ç†ç®—æ³•ã€‚</p>

<h2 data-id="heading-0">0x01 ç¡¬ä»¶ç¯å¢ƒ</h2>
<ul>
<li><strong>MCU</strong>: ESP32-S3 (å½“ç„¶ï¼Œæ™®é€šçš„ ESP32 ç”šè‡³ ESP8266 ä¹Ÿå®Œå…¨è¶³ä»¥èƒœä»»)</li>
<li><strong>å±å¹•</strong>: 1.54 inch Monochrome Display é±¼é¹°å…‰ç”µå•è‰²å±å¹•</li>
<li><strong>é©±åŠ¨</strong>: ST7305 (è¿™ç§æ§åˆ¶å™¨ä¹Ÿå¸¸è§äºä¸€äº›é»‘ç™½åŒè‰²æˆ–é»‘ç™½çº¢ä¸‰è‰²çš„å°å°ºå¯¸å¢¨æ°´å±)</li>
<li><strong>åˆ†è¾¨ç‡</strong>: 200 x 200 (1-bit Monza, çº¯é»‘ç™½)</li>
</ul>
<p>é€‰æ‹© ESP32-S3 ä¸»è¦æ˜¯å› ä¸ºå…¶å†…ç½®çš„å¤§å®¹é‡ SRAMï¼ˆ512KB+ï¼‰å’Œå¯¹ PSRAM çš„æ”¯æŒï¼Œè®©æˆ‘ä»¬åœ¨å¤„ç† 200x200ï¼ˆåªè¦ 5KBï¼‰ç”šè‡³æ›´é«˜åˆ†è¾¨ç‡çš„å›¾åƒç¼“å†²åŒºæ—¶æ¸¸åˆƒæœ‰ä½™ã€‚è€Œ ST7305 æ˜¯ä¸€æ¬¾ä¸»è¦ç”¨äºç‚¹é˜µç”µå­çº¸æ˜¾ç¤ºå™¨çš„é©±åŠ¨èŠ¯ç‰‡ï¼Œé€šè¿‡ SPI æ¥å£é€šä¿¡ã€‚</p>
<h2 data-id="heading-1">0x02 æ ¸å¿ƒæŒ‘æˆ˜</h2>
<p>åœ¨ PC ç½‘é¡µç«¯ï¼Œæˆ‘ä»¬æœ‰ <code>Float32Array</code> å’Œè¿‘ä¹æ— é™çš„å†…å­˜ã€‚ä½†åœ¨ ESP32-S3 ä¸Šï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨ï¼š</p>
<ol>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼šå°½é‡å¤ç”¨ Bufferï¼Œé¿å…é¢‘ç¹ <code>malloc/free</code> äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</li>
<li><strong>Gamma æ ¡æ­£</strong>ï¼šå¿…é¡»åœ¨ C è¯­è¨€ä¸­æ‰‹åŠ¨å®ç° Gamma Tableï¼Œå¦åˆ™ç”»é¢ä¼šä¸¥é‡åæš—ã€‚</li>
<li><strong>é©±åŠ¨é€‚é…</strong>ï¼šå±å¹•é€šå¸¸éœ€è¦è¾ƒä¸ºå¤æ‚çš„ SPI åˆå§‹åŒ–åºåˆ—ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ä¸åŒçš„å±å¹•ç»ç’ƒé¢æ¿ï¼Œéœ€è¦é…ç½®æ­£ç¡®çš„ç”µå‹å’Œé©±å±æ³¢å½¢ã€‚</li>
</ol>
<h2 data-id="heading-2">0x03 ä»£ç å®ç°è¯¦è§£</h2>
<p>é¡¹ç›®å·¥ç¨‹ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-text" lang="text">main/
â”œâ”€â”€ blue_noise.h      // é¢„è®¡ç®—çš„è“å™ªå£°çº¹ç†æ•°ç»„
â”œâ”€â”€ esp_lcd_st7305.c  // å±å¹•é©±åŠ¨å®ç°
â”œâ”€â”€ hello_world_main.c// æ ¸å¿ƒé€»è¾‘ä¸ç®—æ³•å®ç°
â””â”€â”€ sample_img.h      // æµ‹è¯•ç”¨ç°åº¦å›¾ç‰‡æ•°ç»„
</code></pre>
<h3 data-id="heading-3">å»ºç«‹ Gamma æŸ¥æ‰¾è¡¨ (LUT)</h3>
<p>æ­£å¦‚ç¬¬ä¸€ç¯‡æ‰€è¿°ï¼Œè¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚å¦‚æœä¸åš Gamma æ ¡æ­£ï¼Œçº¿æ€§ç©ºé—´çš„æŠ–åŠ¨ç®—æ³•å¤„ç† sRGB å›¾ç‰‡æ—¶ï¼Œä¸­é—´è°ƒä¼šåæš—ã€‚ç”±äº <code>powf</code> å‡½æ•°åœ¨åµŒå…¥å¼ä¸Šè®¡ç®—éå¸¸æ˜‚è´µï¼Œæˆ‘ä»¬ç»å¯¹ä¸èƒ½å¯¹æ¯ä¸ªåƒç´ å®æ—¶è®¡ç®—ã€‚ä¸ºäº†æ€§èƒ½ï¼Œæˆ‘ä»¬åœ¨å¯åŠ¨æ—¶é¢„è®¡ç®—ä¸€ä¸ª 256 é•¿åº¦çš„æŸ¥æ‰¾è¡¨ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// Gamma correction LUT (0-255 -&gt; 0.0-1.0 linear)</span>
<span class="hljs-type">static</span> <span class="hljs-type">float</span> s_gamma_lut[<span class="hljs-number">256</span>];

<span class="hljs-type">void</span> <span class="hljs-title function_">init_gamma_lut</span><span class="hljs-params">()</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">256</span>; i++) {
    <span class="hljs-comment">// sRGB to Linear: ((val / 255.0) ^ 2.2)</span>
    s_gamma_lut[i] = powf(i / <span class="hljs-number">255.0f</span>, <span class="hljs-number">2.2f</span>);
  }
}
</code></pre>
<p>ä»»ä½•åç»­çš„åƒç´ è¯»å–ï¼Œéƒ½é€šè¿‡ <code>s_gamma_lut[pixel]</code> æ¥è·å–å…¶çº¿æ€§äº®åº¦å€¼ã€‚è¿™æ˜¯ä¸€ç§ç»å…¸çš„ç©ºé—´æ¢æ—¶é—´ç­–ç•¥ã€‚</p>
<h3 data-id="heading-4">åŸºç¡€ç®—æ³•ï¼šThreshold &amp; Random</h3>
<p>æœ€ç®€å•çš„ç®—æ³•å¾€å¾€æ˜¯å¾ˆå¥½çš„åŸºå‡†çº¿ã€‚</p>
<p><strong>Threshold (é˜ˆå€¼æ³•)</strong> ï¼š
ä¹Ÿå°±æ˜¯äºŒå€¼åŒ–ã€‚è¿™æ˜¯æœ€å¿«çš„æ–¹æ³•ï¼Œä½†ä¹Ÿæ˜¯æ•ˆæœæœ€å·®çš„æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">dither_threshold</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">uint8_t</span> *src, <span class="hljs-type">uint8_t</span> *dst)</span> {
  <span class="hljs-built_in">memset</span>(dst, <span class="hljs-number">0</span>, ST7305_FRAMEBUFFER_SIZE);
  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; ST7305_WIDTH * ST7305_HEIGHT; i++) {
    <span class="hljs-type">float</span> val = s_gamma_lut[src[i]];
    <span class="hljs-type">bool</span> white = val &gt; <span class="hljs-number">0.5f</span>;
    set_pixel_1bit(dst, i % ST7305_WIDTH, i / ST7305_WIDTH, white);
  }
}
</code></pre>
<p><strong>å®æ‹æ•ˆæœ</strong>ï¼šç»†èŠ‚å¤§é‡ä¸¢å¤±ï¼Œä¿—ç§°â€œä¸¤è‰²å›¾â€ã€‚å®ƒåªèƒ½ä¿ç•™æœ€ç¡¬çš„è¾¹ç¼˜ï¼Œå‡ ä¹å®Œå…¨ä¸¢å¤±äº†æ‰€æœ‰çš„ç°åº¦ä¿¡æ¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70d15449817c4b30b424ff2469ececba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hhb3Nnb28=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860905&amp;x-signature=MSydDoaX%2BXNQrZIFwrJRvTvV6No%3D" alt="Threshold æ•ˆæœ" loading="lazy"/></p>
<p><strong>Random (éšæœºæŠ–åŠ¨)</strong>
ä¸ºäº†æ‰¾å›ä¸¢å¤±çš„ç°åº¦ï¼Œæˆ‘ä»¬å¼•å…¥ <code>rand()</code> æ¥æ‰“ç ´é‡åŒ–é˜¶æ¢¯ã€‚é€šè¿‡ç»™æ¯ä¸ªåƒç´ å€¼å¢åŠ ä¸€ä¸ªéšæœºå™ªå£°ï¼Œä½¿å¾—åŸæœ¬åœ¨é˜ˆå€¼é™„è¿‘çš„åƒç´ æœ‰ä¸€åŠæ¦‚ç‡ç¿»è½¬ï¼Œä»è€Œå®è§‚ä¸Šè¡¨ç°å‡ºç°åº¦ã€‚</p>
<pre><code class="hljs language-c" lang="c">    <span class="hljs-type">float</span> noise = ((<span class="hljs-type">float</span>)rand() / RAND_MAX) - <span class="hljs-number">0.5f</span>; <span class="hljs-comment">// -0.5 to 0.5</span>
    <span class="hljs-type">bool</span> white = (val + noise) &gt; <span class="hljs-number">0.5f</span>;
</code></pre>
<p><strong>å®æ‹æ•ˆæœ</strong>ï¼šè™½ç„¶æœ‰ç°åº¦æ„Ÿäº†ï¼Œä½†ç”»é¢éå¸¸è„ï¼Œå……æ»¡äº†ç™½å™ªå£°ã€‚è¿™ç§é«˜é¢‘å™ªå£°åœ¨äººçœ¼çœ‹æ¥å°±æ˜¯â€œé›ªèŠ±ç‚¹â€ï¼Œå¹¶ä¸è®¨å–œã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/820f402f90314055aa9e977324ea40e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hhb3Nnb28=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860905&amp;x-signature=%2FsHViFFZ8zjxaxezO%2BAyYQYFzdk%3D" alt="Random æ•ˆæœ" loading="lazy"/></p>
<h3 data-id="heading-5">æœ‰åºæŠ–åŠ¨ï¼šBayer Matrix</h3>
<p>æœ‰åºæŠ–åŠ¨éå¸¸é€‚åˆæ²¡æœ‰ Framebuffer çš„è¶…ä½ç«¯å•ç‰‡æœºï¼ˆå¦‚ Arduino Uno, ATtiny85ï¼‰ï¼Œå› ä¸ºå®ƒæ˜¯ <strong>Point-Operationï¼ˆç‚¹æ“ä½œï¼‰</strong>ï¼Œä¸éœ€è¦çŸ¥é“é‚»å±…åƒç´ çš„ä¿¡æ¯ï¼Œä¹Ÿä¸éœ€è¦å­˜å‚¨ä¸Šä¸€è¡Œçš„è¯¯å·®ã€‚æˆ‘ä»¬å¯ä»¥å¯¹æ¯ä¸ªåƒç´ ç‹¬ç«‹è®¡ç®—ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">float</span> s_bayer_matrix[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>] = {
    {<span class="hljs-number">0.0f</span> / <span class="hljs-number">16.0f</span>, <span class="hljs-number">8.0f</span> / <span class="hljs-number">16.0f</span>, <span class="hljs-number">2.0f</span> / <span class="hljs-number">16.0f</span>, <span class="hljs-number">10.0f</span> / <span class="hljs-number">16.0f</span>},
    {<span class="hljs-number">12.0f</span> / <span class="hljs-number">16.0f</span>, <span class="hljs-number">4.0f</span> / <span class="hljs-number">16.0f</span>, <span class="hljs-number">14.0f</span> / <span class="hljs-number">16.0f</span>, <span class="hljs-number">6.0f</span> / <span class="hljs-number">16.0f</span>},
    <span class="hljs-comment">// ... complete matrix</span>
};

<span class="hljs-comment">// Inside loop</span>
<span class="hljs-type">float</span> threshold = s_bayer_matrix[y % <span class="hljs-number">4</span>][x % <span class="hljs-number">4</span>];
<span class="hljs-type">bool</span> white = (val &gt; threshold);
</code></pre>
<p><strong>å®æ‹æ•ˆæœ</strong>ï¼šç»å…¸çš„åå­—äº¤å‰ç½‘çº¹ã€‚è¿™ç§é£æ ¼åœ¨å¤å¤ GameBoy æ¸¸æˆå’Œæ—©æœŸçš„ Macintosh ç³»ç»Ÿä¸­éå¸¸å¸¸è§ã€‚å®ƒé€šè¿‡è§„åˆ™çš„çº¹ç†æ¥æ¨¡æ‹Ÿç°åº¦ï¼Œè™½ç„¶çœ‹èµ·æ¥æœ‰ç‚¹â€œäººå·¥â€ï¼Œä½†æ¯”éšæœºæŠ–åŠ¨å¹²å‡€å¾—å¤šã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92dc20f567934ab0a6f1a10e3485fb8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hhb3Nnb28=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860905&amp;x-signature=Alk6O56Xmscu7SFkYH8owDwjB%2FA%3D" alt="Bayer æ•ˆæœ" loading="lazy"/></p>
<h3 data-id="heading-6">è¯¯å·®æ‰©æ•£ï¼šFloyd-Steinberg &amp; Atkinson</h3>
<p>å¯¹äºæ”¯æŒ Framebuffer çš„è®¾å¤‡ï¼ˆESP32 æœ‰è¶³å¤Ÿ RAMï¼‰ï¼Œè¯¯å·®æ‰©æ•£æ˜¯æœ€ä½³é€‰æ‹©ã€‚ä½ éœ€è¦ä¸€ä¸ªæµ®ç‚¹æ•° Buffer æ¥å­˜å‚¨æ‰©æ•£è¿‡ç¨‹ä¸­çš„è¯¯å·®ã€‚</p>
<p><strong>Floyd-Steinberg</strong> æ˜¯æ•™ç§‘ä¹¦èˆ¬çš„æ ‡å‡†ï¼Œæ‰©æ•£ç³»æ•°ä¸º <code>7, 3, 5, 1</code> (/16)ã€‚å®ƒè¯•å›¾å°†é‡åŒ–äº§ç”Ÿçš„æ¯ä¸€ä¸ªè¯¯å·®éƒ½å®Œç¾åœ°åˆ†é…ç»™é‚»å±…ï¼Œä»æ•°å­¦ä¸Šè®²æ˜¯æœ€ç²¾ç¡®çš„ã€‚
<strong>å®æ‹æ•ˆæœ</strong>ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5fe814f9a294734a878cc8ab6c2b98f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hhb3Nnb28=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860905&amp;x-signature=7muL6lMEqmikrcW5YXo3RbV3A5o%3D" alt="Floyd-Steinberg æ•ˆæœ" loading="lazy"/></p>
<p><strong>Atkinson</strong> åˆ™æ›´é€‚åˆè¿™ç§é«˜è§£æåº¦ä½†ä½è‰²æ·±çš„å±å¹•ã€‚å®ƒç”± Bill Atkinson è®¾è®¡ï¼Œä¸åƒ Floyd-Steinberg é‚£æ ·ä¿ç•™ 100% çš„è¯¯å·®ï¼Œè€Œæ˜¯åªä¿ç•™ 75% çš„è¯¯å·®ç”¨äºæ‰©æ•£ï¼Œè¿™å°±äººä¸ºåˆ¶é€ äº†ä¸€äº›â€œæ­»é»‘â€å’Œâ€œæ­»ç™½â€åŒºåŸŸã€‚è¿™å¬èµ·æ¥åƒæ˜¯ç¼ºç‚¹ï¼Œä½†åœ¨ä½å¯¹æ¯”åº¦çš„å•è‰²å±ä¸Šï¼Œä½†è¿™åè€Œå¢åŠ äº†å±€éƒ¨å¯¹æ¯”åº¦ï¼Œè®©å›¾åƒçœ‹èµ·æ¥æ›´æ¸…æ™°é”åˆ©ï¼Œå‡å°‘äº†â€œè •è™«â€ä¼ªå½±ã€‚</p>
<pre><code class="hljs language-c" lang="c">      <span class="hljs-comment">// Distribute 1/8 to neighbors (Atkinson)</span>
      <span class="hljs-type">float</span> err_part = quant_error / <span class="hljs-number">8.0f</span>;

      <span class="hljs-keyword">if</span> (x + <span class="hljs-number">1</span> &lt; ST7305_WIDTH)
        work_buf[y * ST7305_WIDTH + x + <span class="hljs-number">1</span>] += err_part;
      <span class="hljs-keyword">if</span> (x + <span class="hljs-number">2</span> &lt; ST7305_WIDTH)
        work_buf[y * ST7305_WIDTH + x + <span class="hljs-number">2</span>] += err_part;
      <span class="hljs-comment">// ... bottom neighbors</span>
</code></pre>
<p><strong>å®æ‹æ•ˆæœ</strong>ï¼šè¿™æ˜¯æˆ‘åœ¨è¿™å—å±ä¸Šæœ€å–œæ¬¢çš„ç®—æ³•ã€‚çº¿æ¡ç¡¬æœ—ï¼Œè´¨æ„Ÿæä½³ï¼Œç‰¹åˆ«é€‚åˆæ˜¾ç¤ºæ–‡å­—å’Œ icon æ··åˆçš„ UI ç•Œé¢ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33ed38844029418eaa3781c13fc4c2ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hhb3Nnb28=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860905&amp;x-signature=IxI7FfOGOOxNMSXhQY8uQolXf0k%3D" alt="Atkinson æ•ˆæœ" loading="lazy"/></p>
<h3 data-id="heading-7">åˆ«æœ‰é£å‘³ï¼šBlue Noise (è“å™ªå£°)</h3>
<p>å¦‚æœåœ¨åµŒå…¥å¼è®¾å¤‡ä¸Šæƒ³è¦æ¨¡æ‹Ÿèƒ¶ç‰‡æ„Ÿï¼Œè“å™ªå£°æ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚å®ƒçš„è®¡ç®—æˆæœ¬å’Œ Bayer ä¸€æ ·ä½ï¼ˆåªéœ€è¦æŸ¥è¡¨ï¼‰ï¼Œä½†æ•ˆæœå´èƒ½é€šè¿‡â€œæ’åˆ—æ— åºä½†åˆ†å¸ƒå‡åŒ€â€çš„å™ªç‚¹æ¥æ¬ºéª—äººçœ¼ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å°†ä¸€å¼ é¢„è®¡ç®—å¥½çš„è“å™ªå£°çº¹ç†è½¬æ¢æˆ C æ•°ç»„ (<code>blue_noise.h</code>) å­˜å‚¨åœ¨ Flash ä¸­ã€‚è¿™æ„å‘³ç€ä½ éœ€è¦ç‰ºç‰²å‡ å KB çš„ Flash ç©ºé—´æ¥æ¢å–è¿™ç§æ•ˆæœã€‚</p>
<pre><code class="hljs language-c" lang="c">      <span class="hljs-comment">// Map 0-255 texture to 0.0-1.0</span>
      <span class="hljs-type">float</span> threshold = blue_noise_map[(y % BN_H) * BN_W + (x % BN_W)] / <span class="hljs-number">255.0f</span>;
      <span class="hljs-type">bool</span> white = (val &gt; threshold);
</code></pre>
<p><strong>å®æ‹æ•ˆæœ</strong>ï¼šéå¸¸è‡ªç„¶çš„é¢—ç²’æ„Ÿï¼Œæ²¡æœ‰ä»»ä½•è§„å¾‹æ€§æ¡çº¹ï¼Œå°±åƒä¸€å¼ è€ç…§ç‰‡ã€‚è¿™ç§ç®—æ³•ç‰¹åˆ«é€‚åˆæ˜¾ç¤ºäººåƒå’Œé£æ™¯æ‘„å½±ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d08df4e3841492c8b01201bd3b258f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hhb3Nnb28=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860905&amp;x-signature=NyqLWdcoHjdkCEQjiZOIy2OB0K4%3D" alt="Blue Noise æ•ˆæœ" loading="lazy"/></p>
<h2 data-id="heading-8">0x04 æ€»ç»“</h2>
<p>åœ¨ ESP32 è¿™ç§çº§åˆ«çš„ MCU ä¸Šï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å®ç°é«˜è´¨é‡çš„å³æ—¶å›¾åƒæŠ–åŠ¨ã€‚ä¸åŒçš„ç®—æ³•é€‚ç”¨äºä¸åŒçš„åœºæ™¯ï¼š</p>
<ul>
<li><strong>Bayer æœ‰åºæŠ–åŠ¨</strong>ï¼šè®¡ç®—å¼€é”€æœ€å°ï¼Œé€‚åˆèµ„æºæç«¯å—é™ï¼ˆå¦‚ä¸å¸¦ RAM çš„ä½ç«¯å•ç‰‡æœºï¼‰æˆ–å¤å¤é£æ ¼æ¸¸æˆã€‚</li>
<li><strong>Atkinson</strong>ï¼šå¯¹æ¯”åº¦æœ€é«˜ï¼Œè¾¹ç¼˜æ¸…æ™°ï¼Œé€‚åˆ UI ç•Œé¢ã€æ–‡å­—æ··æ’åœºæ™¯ã€‚</li>
<li><strong>Blue Noise</strong>ï¼šé¢—ç²’æ„Ÿè‡ªç„¶ï¼Œé€‚åˆæ˜¾ç¤ºæ‘„å½±å›¾ç‰‡ï¼Œä½†éœ€è¦é¢å¤–çš„ Flash ç©ºé—´å­˜å‚¨çº¹ç†ã€‚</li>
</ul>
<p>å¸Œæœ›æœ¬æ–‡èƒ½ä¸ºä½ åœ¨å•è‰²å±å¹•å¼€å‘ä¸­æä¾›ä¸€äº›æ€è·¯ã€‚</p>
<p><strong>åè®°</strong>ï¼š è¿™ä¸ªæŠ–åŠ¨ç®—æ³•å®éªŒæ˜¯æˆ‘ <strong>Friday Ink2</strong> é¡¹ç›®çš„ä¸€éƒ¨åˆ†å‰ç»ç ”ç©¶ã€‚å¦‚æœä½ å¯¹å¦‚ä½•å°†è¿™ç§å¤å¤è§†è§‰æ•ˆæœåº”ç”¨åˆ°å®é™…ç¡¬ä»¶æ„Ÿå…´è¶£ï¼Œæ¬¢è¿è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ <a href="https://link.juejin.cn?target=https%3A%2F%2Fchaosgoo.com%2Fprojects%2F" target="_blank" title="https://chaosgoo.com/projects/" ref="nofollow noopener noreferrer">chaosgoo.com/projects/</a> æŸ¥é˜…æ›´å¤š DIY ç¬”è®°ã€‚</p>
<h2 data-id="heading-9">0x05 å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsurma.dev%2Fthings%2Fditherpunk%2F" target="_blank" title="https://surma.dev/things/ditherpunk/" ref="nofollow noopener noreferrer">Ditherpunk â€” The article I wish I had about monochrome image dithering</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FKevincoooool%2Fesp_lcd_st7305" target="_blank" title="https://github.com/Kevincoooool/esp_lcd_st7305" ref="nofollow noopener noreferrer">Kevincoooool/esp_lcd_st7305</a> - æœ¬æ–‡ ST7305 é©±åŠ¨ç§»æ¤å‚è€ƒ</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDuRuofu%2Fesp-idf-st7305-Ink-screen" target="_blank" title="https://github.com/DuRuofu/esp-idf-st7305-Ink-screen" ref="nofollow noopener noreferrer">DuRuofu/esp-idf-st7305-Ink-screen</a> - å¦ä¸€ä¸ªä¼˜ç§€çš„ ST7305 é©±åŠ¨å®ç°</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»„ä»¶åº“äºŒæ¬¡å°è£…é¿å‘æŒ‡å—ï¼šattrsé€ä¼ ã€äº‹ä»¶åˆå¹¶ç­‰4å¤§ç—›ç‚¹ï¼Œä¸€æ¬¡æ€§æ ¹æ²»ï¼]]></title>    <link>https://juejin.cn/post/7602825342228906018</link>    <guid>https://juejin.cn/post/7602825342228906018</guid>    <pubDate>2026-02-05T02:45:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602825342228906018" data-draft-id="7602135278665121844" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»„ä»¶åº“äºŒæ¬¡å°è£…é¿å‘æŒ‡å—ï¼šattrsé€ä¼ ã€äº‹ä»¶åˆå¹¶ç­‰4å¤§ç—›ç‚¹ï¼Œä¸€æ¬¡æ€§æ ¹æ²»ï¼"/> <meta itemprop="keywords" content="JavaScript,é¢è¯•,Vue.js"/> <meta itemprop="datePublished" content="2026-02-05T02:45:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="boooooooom"/> <meta itemprop="url" content="https://juejin.cn/user/3078273283917399"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»„ä»¶åº“äºŒæ¬¡å°è£…é¿å‘æŒ‡å—ï¼šattrsé€ä¼ ã€äº‹ä»¶åˆå¹¶ç­‰4å¤§ç—›ç‚¹ï¼Œä¸€æ¬¡æ€§æ ¹æ²»ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3078273283917399/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    boooooooom
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:45:07.000Z" title="Thu Feb 05 2026 02:45:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    19
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ­£æ–‡</h2>
<h3 data-id="heading-1">ä¸€ã€å‰è¨€ï¼šä¸ºä»€ä¹ˆç»„ä»¶åº“äºŒæ¬¡å°è£…æ€»è¸©å‘ï¼Ÿ</h3>
<p>åœ¨Vue/Reacté¡¹ç›®å¼€å‘ä¸­ï¼Œç»„ä»¶åº“ï¼ˆElement Plusã€Ant Designç­‰ï¼‰äºŒæ¬¡å°è£…æ˜¯å¸¸æ€â€”â€”ä¸ºäº†ç»Ÿä¸€é¡¹ç›®æ ·å¼ã€å¤ç”¨ä¸šåŠ¡é€»è¾‘ã€ç®€åŒ–ä½¿ç”¨æˆæœ¬ï¼Œæˆ‘ä»¬å¸¸ä¼šåŸºäºåŸºç¡€ç»„ä»¶å°è£…ä¸šåŠ¡ç»„ä»¶ã€‚</p>
<p>ä½†å°è£…è¿‡ç¨‹ä¸­ï¼Œå‡ ä¹æ‰€æœ‰å¼€å‘è€…éƒ½ä¼šé‡åˆ°åŒæ ·çš„å›°å¢ƒï¼šattrsé€ä¼ ä¸¢å¤±ã€äº‹ä»¶å†²çªä¸è§¦å‘ã€slotsæ’æ§½é”™ä¹±ã€TSç±»å‹æŠ¥é”™â€¦â€¦è¿™äº›ç—›ç‚¹çœ‹ä¼¼ç»†å°ï¼Œå´ä¼šå¯¼è‡´å°è£…ç»„ä»¶æ˜“ç”¨æ€§éª¤é™ã€ç»´æŠ¤æˆæœ¬ç¿»å€ï¼Œç”šè‡³è¿èƒŒäºŒæ¬¡å°è£…çš„åˆè¡·ã€‚</p>
<p>æœ¬æ–‡èšç„¦ç»„ä»¶åº“äºŒæ¬¡å°è£…æœ€æ ¸å¿ƒçš„4å¤§ç—›ç‚¹ï¼Œç»“åˆVue3å®æ“æ¡ˆä¾‹ï¼Œä»â€œç—›ç‚¹åˆ†æ+è§£å†³æ–¹æ¡ˆâ€åŒç»´åº¦æ‹†è§£ï¼Œæ–°æ‰‹ä¹Ÿèƒ½ç›´æ¥å¥—ç”¨ï¼Œå½»åº•å‘Šåˆ«å°è£…å†…è€—ã€‚</p>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒç—›ç‚¹æ‹†è§£+å®æ“è§£å†³æ–¹æ¡ˆï¼ˆé‡ç‚¹ï¼ï¼‰</h3>
<p>ä»¥ä¸‹4å¤§ç—›ç‚¹ï¼Œè¦†ç›–ç»„ä»¶åº“äºŒæ¬¡å°è£…80%çš„é«˜é¢‘é—®é¢˜ï¼Œä¼˜å…ˆè§£å†³â€œå®ç”¨æ€§â€ï¼Œæ‰€æœ‰æ–¹æ¡ˆå‡é€‚é…Vue3ï¼ˆ<code>&lt;script setup&gt;+TS</code>ï¼‰ï¼Œå…¼é¡¾æ˜“ç”¨æ€§å’Œè§„èŒƒæ€§ã€‚</p>
<h4 data-id="heading-3">ç—›ç‚¹1ï¼šattrsé€ä¼ ä¸¢å¤±ï¼ˆæœ€å¸¸è§ï¼Œæ–°æ‰‹å¿…è¸©ï¼‰</h4>
<h5 data-id="heading-4">ç—›ç‚¹è¡¨ç°</h5>
<p>åŸºäºåŸºç¡€ç»„ä»¶å°è£…æ—¶ï¼Œçˆ¶ç»„ä»¶ä¼ é€’çš„é¢å¤–å±æ€§ï¼ˆå¦‚placeholderã€disabledã€classï¼‰ï¼Œæ— æ³•é€ä¼ åˆ°åº•å±‚åŸºç¡€ç»„ä»¶ï¼Œå¯¼è‡´åŸºç¡€ç»„ä»¶åŠŸèƒ½å¤±æ•ˆã€‚</p>
<p>ç¤ºä¾‹ï¼šå°è£…ElInputç»„ä»¶ï¼Œçˆ¶ç»„ä»¶ä¼ é€’placeholderï¼Œå´æ— æ³•æ˜¾ç¤ºã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;!-- å°è£…ç»„ä»¶ <span class="hljs-title class_">MyInput</span>.<span class="hljs-property">vue</span>ï¼ˆæœ‰é—®é¢˜å†™æ³•ï¼‰ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ElInput</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"inputVal"</span> /&amp;<span class="hljs-attr">gt</span>; &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">æœªé€ä¼ attrs</span>ï¼Œ<span class="hljs-attr">çˆ¶ç»„ä»¶ä¼ é€’çš„placeholderæ— æ³•ç”Ÿæ•ˆ</span> <span class="hljs-attr">--</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>([<span class="hljs-string">'modelValue'</span>])
<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'update:modelValue'</span>])
<span class="hljs-keyword">const</span> inputVal = <span class="hljs-title function_">toRef</span>(props, <span class="hljs-string">'modelValue'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- çˆ¶ç»„ä»¶ä½¿ç”¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">MyInput</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"val"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å†…å®¹"</span> /&gt;</span> <span class="hljs-comment">&lt;!-- placeholderä¸æ˜¾ç¤º --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span></span>è§£å†³æ–¹æ¡ˆï¼šv-bind=<span class="hljs-string">"$attrs"</span> å®Œæ•´é€ä¼ <span class="hljs-title class_">Vue3</span>ä¸­ï¼Œ$attrsåŒ…å«çˆ¶ç»„ä»¶ä¼ é€’çš„æ‰€æœ‰æœªè¢«propså£°æ˜çš„å±æ€§ï¼Œé€šè¿‡v-bind=<span class="hljs-string">"$attrs"</span>ï¼Œå¯å°†æ‰€æœ‰attrsä¸€æ¬¡æ€§é€ä¼ åˆ°åº•å±‚åŸºç¡€ç»„ä»¶ï¼ŒåŒæ—¶æ³¨æ„inheritAttrsçš„åˆç†ä½¿ç”¨ã€‚&lt;!-- å°è£…ç»„ä»¶ <span class="hljs-title class_">MyInput</span>.<span class="hljs-property">vue</span>ï¼ˆæ­£ç¡®å†™æ³•ï¼‰ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- æ ¸å¿ƒï¼šv-bind="$attrs" é€ä¼ æ‰€æœ‰æœªå£°æ˜çš„å±æ€§ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ElInput</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"inputVal"</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"$attrs"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { toRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// ä»…å£°æ˜éœ€è¦å¤„ç†çš„propsï¼Œå…¶ä½™å±æ€§è‡ªåŠ¨è¿›å…¥$attrs</span>
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>([<span class="hljs-string">'modelValue'</span>])
<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'update:modelValue'</span>])
<span class="hljs-keyword">const</span> inputVal = <span class="hljs-title function_">toRef</span>(props, <span class="hljs-string">'modelValue'</span>)

<span class="hljs-comment">// å¯é€‰ï¼šè‹¥éœ€è‡ªå®šä¹‰attrsé€ä¼ ï¼ˆå¦‚å‰”é™¤éƒ¨åˆ†å±æ€§ï¼‰</span>
<span class="hljs-keyword">const</span> attrs = <span class="hljs-title function_">useAttrs</span>()
<span class="hljs-comment">// è§£æ„å‰”é™¤ä¸éœ€è¦é€ä¼ çš„å±æ€§ï¼Œå†é€ä¼ å‰©ä½™éƒ¨åˆ†</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">class</span>: _, ...restAttrs } = attrs
<span class="hljs-comment">// &lt;ElInput v-model="inputVal" v-bind="restAttrs" /&gt;</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p>å…³é”®æ³¨æ„ï¼šinheritAttrsé»˜è®¤å€¼ä¸ºtrueï¼Œè‹¥è®¾ç½®ä¸ºfalseï¼Œéœ€æ‰‹åŠ¨é€ä¼ class/styleï¼ˆVue3ä¸­$attrså·²åŒ…å«class/styleï¼‰ï¼Œé¿å…æ ·å¼ä¸¢å¤±ã€‚</p>
<h4 data-id="heading-5">ç—›ç‚¹2ï¼šäº‹ä»¶åˆå¹¶å†²çªï¼ˆæ˜“å¿½ç•¥ï¼Œéš¾æ’æŸ¥ï¼‰</h4>
<h5 data-id="heading-6">ç—›ç‚¹è¡¨ç°</h5>
<p>å°è£…ç»„ä»¶æ—¶ï¼Œåº•å±‚åŸºç¡€ç»„ä»¶çš„äº‹ä»¶ï¼ˆå¦‚ElButtonçš„clickï¼‰ä¸å°è£…ç»„ä»¶è‡ªèº«çš„äº‹ä»¶é‡åï¼Œå¯¼è‡´çˆ¶ç»„ä»¶ç»‘å®šçš„äº‹ä»¶ä¸è§¦å‘ï¼Œæˆ–è§¦å‘å¼‚å¸¸ï¼›ç”šè‡³å‡ºç°â€œå¤šæ¬¡è§¦å‘â€çš„é—®é¢˜ã€‚</p>
<p>ç¤ºä¾‹ï¼šå°è£…ElButtonï¼Œè‡ªèº«ç»‘å®šclickäº‹ä»¶å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œçˆ¶ç»„ä»¶ç»‘å®šçš„clickäº‹ä»¶æ— æ³•è§¦å‘ã€‚</p>
<h5 data-id="heading-7">è§£å†³æ–¹æ¡ˆï¼šäº‹ä»¶é€ä¼ +åˆå¹¶ï¼ˆ$emit+å±•å¼€è¿ç®—ç¬¦ï¼‰</h5>
<p>æ ¸å¿ƒæ€è·¯ï¼šå°è£…ç»„ä»¶è‡ªèº«çš„äº‹ä»¶å¤„ç†å®Œæˆåï¼Œé€šè¿‡$emité€ä¼ åº•å±‚ç»„ä»¶çš„äº‹ä»¶ï¼›è‹¥éœ€åˆå¹¶äº‹ä»¶ï¼Œå¯ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦ï¼Œå°†åº•å±‚ç»„ä»¶çš„äº‹ä»¶ä¸€æ¬¡æ€§é€ä¼ ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;!-- å°è£…ç»„ä»¶ <span class="hljs-title class_">MyButton</span>.<span class="hljs-property">vue</span>ï¼ˆæ­£ç¡®å†™æ³•ï¼‰ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- æ ¸å¿ƒï¼š@click="handleClick" å¤„ç†è‡ªèº«ä¸šåŠ¡ï¼ŒåŒæ—¶é€ä¼ åº•å±‚äº‹ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ElButton</span> 
    <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"$attrs"</span> 
    @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleClick"</span>
    @<span class="hljs-attr">blur</span>=<span class="hljs-string">"$emit('blur')"</span> &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">é€ä¼ å•ä¸ªäº‹ä»¶</span> <span class="hljs-attr">--</span>&gt;</span>
    v-on="$listeners" <span class="hljs-comment">&lt;!-- Vue2å†™æ³•ï¼ŒVue3å¯çœç•¥ï¼Œ$attrså·²åŒ…å«äº‹ä»¶ --&gt;</span>
  &gt;
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ElButton</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'click'</span>, <span class="hljs-string">'blur'</span>])

<span class="hljs-comment">// è‡ªèº«ä¸šåŠ¡é€»è¾‘å¤„ç†</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-comment">// 1. å¤„ç†å°è£…ç»„ä»¶çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æƒé™åˆ¤æ–­ã€åŠ è½½çŠ¶æ€ï¼‰</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†ä¸šåŠ¡é€»è¾‘'</span>)
  <span class="hljs-comment">// 2. é€ä¼ clickäº‹ä»¶ç»™çˆ¶ç»„ä»¶ï¼Œç¡®ä¿çˆ¶ç»„ä»¶ç»‘å®šçš„äº‹ä»¶è§¦å‘</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">'click'</span>, e)
}

<span class="hljs-comment">// è‹¥éœ€åˆå¹¶å¤šä¸ªäº‹ä»¶ï¼ˆç®€åŒ–å†™æ³•ï¼‰</span>
<span class="hljs-keyword">const</span> emits = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'click'</span>, <span class="hljs-string">'blur'</span>, <span class="hljs-string">'focus'</span>])
<span class="hljs-comment">// åº•å±‚ç»„ä»¶çš„æ‰€æœ‰äº‹ä»¶ï¼Œä¸€æ¬¡æ€§é€ä¼ </span>
<span class="hljs-comment">// &lt;ElButton v-bind="$attrs" v-on="$listeners" /&gt;</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p>å…³é”®æ³¨æ„ï¼šVue3ä¸­ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mi>s</mi><mtext>å·²åŒ…å«æ‰€æœ‰äº‹ä»¶ï¼ˆ</mtext></mrow><annotation encoding="application/x-tex">attrså·²åŒ…å«æ‰€æœ‰äº‹ä»¶ï¼ˆ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">rs</span><span class="mord cjk_fallback">å·²åŒ…å«æ‰€æœ‰äº‹ä»¶ï¼ˆ</span></span></span></span></span>listenerså·²è¢«åˆå¹¶åˆ°<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mi>s</mi><mtext>ä¸­ï¼‰ï¼Œå¯ç›´æ¥ç”¨</mtext><mi>v</mi><mo>âˆ’</mo><mi>b</mi><mi>i</mi><mi>n</mi><mi>d</mi><mo>=</mo><mi mathvariant="normal">"</mi></mrow><annotation encoding="application/x-tex">attrsä¸­ï¼‰ï¼Œå¯ç›´æ¥ç”¨v-bind="</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"/><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">rs</span><span class="mord cjk_fallback">ä¸­ï¼‰ï¼Œå¯ç›´æ¥ç”¨</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">bin</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord">"</span></span></span></span></span>attrs" åŒæ—¶é€ä¼ å±æ€§å’Œäº‹ä»¶ï¼Œæ— éœ€é¢å¤–å†™v-on="$listeners"ã€‚</p>
<h4 data-id="heading-8">ç—›ç‚¹3ï¼šslotsæ’æ§½é€ä¼ é”™ä¹±ï¼ˆæ ·å¼/å†…å®¹é”™ä½ï¼‰</h4>
<h5 data-id="heading-9">ç—›ç‚¹è¡¨ç°</h5>
<p>åŸºç¡€ç»„ä»¶çš„å…·åæ’æ§½ï¼ˆå¦‚ElSelectçš„prefixã€suffixæ’æ§½ï¼‰ï¼Œåœ¨å°è£…åæ— æ³•è¢«çˆ¶ç»„ä»¶æ­£å¸¸ä½¿ç”¨ï¼›æˆ–å°è£…ç»„ä»¶è‡ªèº«çš„æ’æ§½ä¸åº•å±‚ç»„ä»¶æ’æ§½å†²çªï¼Œå¯¼è‡´å†…å®¹æ¸²æŸ“é”™ä½ã€‚</p>
<p>ç¤ºä¾‹ï¼šå°è£…ElSelectï¼Œçˆ¶ç»„ä»¶æ— æ³•ä½¿ç”¨prefixæ’æ§½æ·»åŠ å‰ç¼€å›¾æ ‡ã€‚</p>
<h5 data-id="heading-10">è§£å†³æ–¹æ¡ˆï¼šæ’æ§½é€ä¼ ï¼ˆé»˜è®¤æ’æ§½+å…·åæ’æ§½å…¨è¦†ç›–ï¼‰</h5>
<p>æ ¸å¿ƒæ€è·¯ï¼šå°è£…ç»„ä»¶ä¸­ï¼Œä¿ç•™åº•å±‚ç»„ä»¶çš„æ‰€æœ‰æ’æ§½ï¼Œé€šè¿‡æ ‡ç­¾é€ä¼ ï¼Œé»˜è®¤æ’æ§½ç›´æ¥ç”¨ï¼Œå…·åæ’æ§½éœ€æŒ‡å®šnameå±æ€§ï¼Œç¡®ä¿çˆ¶ç»„ä»¶å¯æ­£å¸¸ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;!-- å°è£…ç»„ä»¶ <span class="hljs-title class_">MySelect</span>.<span class="hljs-property">vue</span>ï¼ˆæ­£ç¡®å†™æ³•ï¼‰ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ElSelect</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"value"</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"$attrs"</span> @<span class="hljs-attr">change</span>=<span class="hljs-string">"$emit('change')"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 1. é€ä¼ é»˜è®¤æ’æ§½ï¼ˆé€‰é¡¹åˆ—è¡¨ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>/&gt;</span>
    
    <span class="hljs-comment">&lt;!-- 2. é€ä¼ å…·åæ’æ§½ï¼ˆprefixã€suffixç­‰ï¼Œåº•å±‚ç»„ä»¶æœ‰çš„éƒ½è¦é€ä¼ ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">prefix</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"suffix"</span>/&gt;</span> <span class="hljs-comment">&lt;!-- çˆ¶ç»„ä»¶å¯é€šè¿‡#prefixä½¿ç”¨ --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">suffix</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"suffix"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- 3. å°è£…ç»„ä»¶è‡ªèº«çš„æ’æ§½ï¼ˆå¯è‡ªå®šä¹‰åç§°ï¼Œé¿å…å†²çªï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">myCustom</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>å°è£…ç»„ä»¶è‡ªèº«çš„æ’æ§½å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ElSelect</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>([<span class="hljs-string">'modelValue'</span>])
<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'update:modelValue'</span>, <span class="hljs-string">'change'</span>])
<span class="hljs-keyword">const</span> value = <span class="hljs-title function_">toRef</span>(props, <span class="hljs-string">'modelValue'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p>å…³é”®æ³¨æ„ï¼šå…·åæ’æ§½å¿…é¡»â€œä¸€ä¸€å¯¹åº”â€ï¼Œåº•å±‚ç»„ä»¶æœ‰å¤šå°‘ä¸ªå…·åæ’æ§½ï¼Œå°è£…ç»„ä»¶å°±éœ€è¦é€ä¼ å¤šå°‘ä¸ªï¼›è‹¥æ— éœ€è‡ªå®šä¹‰å¤„ç†ï¼Œå¯ç›´æ¥ç”¨ é€ä¼ ï¼Œæ— éœ€é¢å¤–åµŒå¥—ã€‚</p>
<h4 data-id="heading-11">ç—›ç‚¹4ï¼šTSç±»å‹æ”¯æŒç¼ºå¤±ï¼ˆå¤§å‹é¡¹ç›®å¿…è¸©ï¼‰</h4>
<h5 data-id="heading-12">ç—›ç‚¹è¡¨ç°</h5>
<p>ä½¿ç”¨TSå¼€å‘æ—¶ï¼Œå°è£…ç»„ä»¶æ— æ³•ç»§æ‰¿åº•å±‚åŸºç¡€ç»„ä»¶çš„ç±»å‹ï¼Œå¯¼è‡´çˆ¶ç»„ä»¶ä¼ é€’propsã€äº‹ä»¶æ—¶ï¼Œæ²¡æœ‰ç±»å‹æç¤ºã€ç±»å‹æŠ¥é”™ï¼›ç”šè‡³å‡ºç°â€œä¼ é”™å‚æ•°â€å´æ— æ³•æå‰å‘ç°çš„é—®é¢˜ï¼Œè¿èƒŒTSçš„ç±»å‹å®‰å…¨ç†å¿µã€‚</p>
<p>ç¤ºä¾‹ï¼šå°è£…ElInputï¼Œçˆ¶ç»„ä»¶ä¼ é€’type="textarea"æ—¶ï¼ŒTSæç¤ºâ€œç±»å‹ä¸å­˜åœ¨â€ã€‚</p>
<h5 data-id="heading-13">è§£å†³æ–¹æ¡ˆï¼šç»§æ‰¿åº•å±‚ç»„ä»¶ç±»å‹ï¼ˆVue3+TSå®æ“ï¼‰</h5>
<p>æ ¸å¿ƒæ€è·¯ï¼šé€šè¿‡Vue3æä¾›çš„ComponentPropsã€ComponentEmitsç­‰å·¥å…·ç±»å‹ï¼Œç»§æ‰¿åº•å±‚åŸºç¡€ç»„ä»¶çš„propsã€emitsç±»å‹ï¼Œå†æ‰©å±•å°è£…ç»„ä»¶è‡ªèº«çš„ç±»å‹ï¼Œå®ç°ç±»å‹å…¨è¦†ç›–ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;!-- å°è£…ç»„ä»¶ <span class="hljs-title class_">MyInput</span>.<span class="hljs-property">vue</span>ï¼ˆ<span class="hljs-variable constant_">TS</span>æ­£ç¡®å†™æ³•ï¼‰ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ElInput</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"inputVal"</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"$attrs"</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">"$emit('input')"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

&lt;script setup&gt;
import { toRef } from 'vue'
import { ElInput } from 'element-plus'
// 1. ç»§æ‰¿ElInputçš„propsç±»å‹ï¼Œå†æ‰©å±•è‡ªèº«éœ€è¦çš„props
type MyInputProps = ComponentProps&lt;typeof ElInput&gt; &amp; {
  // å°è£…ç»„ä»¶è‡ªèº«æ–°å¢çš„propsï¼Œå¯é€‰
  customProp?: string
}

// 2. ç»§æ‰¿ElInputçš„emitsç±»å‹ï¼Œå†æ‰©å±•è‡ªèº«çš„emits
type MyInputEmits = ComponentEmits&lt;typeof ElInput&gt; &amp; {
  // å°è£…ç»„ä»¶è‡ªèº«æ–°å¢çš„äº‹ä»¶ï¼Œå¯é€‰
  customEmit?: (value: string) =&gt; void
}

// 3. åº”ç”¨ç±»å‹
const props = defineProps&lt;MyInputProps&gt;()
const emit = defineEmits&lt;MyInputEmits&gt;()

const inputVal = toRef(props, 'modelValue')
&lt;/script&gt;
</code></pre>
<p>å…³é”®æ³¨æ„ï¼š</p>
<ul>
<li>ComponentPropsã€ComponentEmits æ˜¯Vue3å†…ç½®çš„å·¥å…·ç±»å‹ï¼Œéœ€ç¡®ä¿Vueç‰ˆæœ¬â‰¥3.3.0ï¼›</li>
<li>æ‰©å±•ç±»å‹æ—¶ï¼Œä½¿ç”¨&amp;ï¼ˆäº¤å‰ç±»å‹ï¼‰ï¼Œé¿å…è¦†ç›–åº•å±‚ç»„ä»¶çš„åŸæœ‰ç±»å‹ï¼›</li>
<li>è‹¥å°è£…ç»„ä»¶æ— éœ€æ–°å¢props/emitsï¼Œå¯ç›´æ¥ä½¿ç”¨<code>defineProps&lt;ComponentProps&lt;typeof ElInput&gt;&gt;()</code>ï¼Œæ— éœ€é¢å¤–æ‰©å±•ã€‚</li>
</ul>
<h3 data-id="heading-14">ä¸‰ã€å°è£…é€šç”¨è§„èŒƒï¼ˆé¿å‘å»¶ä¼¸ï¼Œæå‡å¯ç»´æŠ¤æ€§ï¼‰</h3>
<p>è§£å†³ç—›ç‚¹çš„åŒæ—¶ï¼Œéµå¾ªä»¥ä¸‹è§„èŒƒï¼Œå¯è®©å°è£…çš„ç»„ä»¶æ›´æ˜“ç”¨ã€æ›´æ˜“ç»´æŠ¤ï¼Œé¿å…åç»­è¸©æ–°å‘ï¼š</p>
<ol>
<li>æœ€å°å°è£…åŸåˆ™ï¼šä»…å°è£…ä¸šåŠ¡é€»è¾‘å’Œç»Ÿä¸€æ ·å¼ï¼Œä¸å±è”½åº•å±‚ç»„ä»¶çš„åŸæœ‰åŠŸèƒ½ï¼ˆattrsã€äº‹ä»¶ã€æ’æ§½å°½é‡å®Œæ•´é€ä¼ ï¼‰ï¼›</li>
<li>å‘½åè§„èŒƒï¼šå°è£…ç»„ä»¶å‰ç¼€ç»Ÿä¸€ï¼ˆå¦‚MyButtonã€MyInputï¼‰ï¼Œé¿å…ä¸åŸºç¡€ç»„ä»¶ã€å…¶ä»–ä¸šåŠ¡ç»„ä»¶é‡åï¼›</li>
<li>æ³¨é‡Šæ¸…æ™°ï¼šæ˜ç¡®æ ‡æ³¨é€ä¼ çš„propsã€äº‹ä»¶ã€æ’æ§½ï¼Œä»¥åŠå°è£…ç»„ä»¶è‡ªèº«çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ–¹ä¾¿å›¢é˜Ÿåä½œï¼›</li>
<li>é¿å…è¿‡åº¦å°è£…ï¼šè‹¥åŸºç¡€ç»„ä»¶å¯ç›´æ¥æ»¡è¶³éœ€æ±‚ï¼Œæ— éœ€å¼ºè¡Œå°è£…ï¼Œå¦åˆ™ä¼šå¢åŠ å†—ä½™ä»£ç å’Œç»´æŠ¤æˆæœ¬ã€‚</li>
</ol>
<h3 data-id="heading-15">å››ã€æ€»ç»“ï¼šäºŒæ¬¡å°è£…æ ¸å¿ƒè¦ç‚¹ï¼ˆæ–°æ‰‹å¿…èƒŒï¼‰</h3>
<p>ç»„ä»¶åº“äºŒæ¬¡å°è£…çš„æ ¸å¿ƒï¼Œæ˜¯â€œå¤ç”¨+ç®€åŒ–â€ï¼Œè€Œä¸æ˜¯â€œå¤æ‚åŒ–â€ã€‚è®°ä½ä»¥ä¸‹4ä¸ªæ ¸å¿ƒè¦ç‚¹ï¼Œå°±èƒ½é¿å¼€80%çš„å‘ï¼š</p>
<ol>
<li>attrsé€ä¼ ï¼šç”¨v-bind="$attrs" å®Œæ•´é€ä¼ ï¼ŒæŒ‰éœ€è§£æ„å‰”é™¤ä¸éœ€è¦çš„å±æ€§ï¼›</li>
<li>äº‹ä»¶åˆå¹¶ï¼šè‡ªèº«äº‹ä»¶å¤„ç†åé€ä¼ ï¼ŒVue3å¯é€šè¿‡$attrsè‡ªåŠ¨åˆå¹¶äº‹ä»¶ï¼›</li>
<li>slotsé€ä¼ ï¼šé»˜è®¤æ’æ§½+å…·åæ’æ§½å…¨è¦†ç›–ï¼Œé¿å…æ’æ§½é”™ä¹±ï¼›</li>
<li>ç±»å‹æ”¯æŒï¼šTSé¡¹ç›®ç»§æ‰¿åº•å±‚ç»„ä»¶ç±»å‹ï¼Œæ‰©å±•è‡ªèº«ç±»å‹ï¼Œä¿è¯ç±»å‹å®‰å…¨ã€‚</li>
</ol>
<p>å…¶å®ç»„ä»¶åº“äºŒæ¬¡å°è£…å¹¶ä¸å¤æ‚ï¼Œåªè¦åƒé€è¿™4å¤§ç—›ç‚¹çš„è§£å†³æ–¹æ¡ˆï¼Œå†éµå¾ªé€šç”¨è§„èŒƒï¼Œå°±èƒ½å°è£…å‡ºæ˜“ç”¨ã€æ˜“ç»´æŠ¤çš„ä¸šåŠ¡ç»„ä»¶ï¼Œæ—¢æå‡å¼€å‘æ•ˆç‡ï¼Œåˆä¿è¯é¡¹ç›®è§„èŒƒæ€§ã€‚æ–°æ‰‹å»ºè®®å…ˆä»ç®€å•ç»„ä»¶ï¼ˆå¦‚æŒ‰é’®ã€è¾“å…¥æ¡†ï¼‰å…¥æ‰‹ï¼Œç†Ÿç»ƒåå†å°è£…å¤æ‚ç»„ä»¶ï¼ˆå¦‚è¡¨æ ¼ã€è¡¨å•ï¼‰ï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦è§£æï¼šNginx å¦‚ä½•æ‰›ä½ç™¾ä¸‡å¹¶å‘ï¼Ÿåº•å±‚é€»è¾‘ä¸å®æˆ˜ä¼˜åŒ–å…¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7602928783595995142</link>    <guid>https://juejin.cn/post/7602928783595995142</guid>    <pubDate>2026-02-05T03:10:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602928783595995142" data-draft-id="7602900131541205033" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦è§£æï¼šNginx å¦‚ä½•æ‰›ä½ç™¾ä¸‡å¹¶å‘ï¼Ÿåº•å±‚é€»è¾‘ä¸å®æˆ˜ä¼˜åŒ–å…¨æŒ‡å—"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2026-02-05T03:10:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="whatä¸¶k"/> <meta itemprop="url" content="https://juejin.cn/user/2578801884147418"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦è§£æï¼šNginx å¦‚ä½•æ‰›ä½ç™¾ä¸‡å¹¶å‘ï¼Ÿåº•å±‚é€»è¾‘ä¸å®æˆ˜ä¼˜åŒ–å…¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2578801884147418/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    whatä¸¶k
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:10:50.000Z" title="Thu Feb 05 2026 03:10:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±åº¦è§£æï¼šNginx å¦‚ä½•æ‰›ä½ç™¾ä¸‡å¹¶å‘ï¼Ÿåº•å±‚é€»è¾‘ä¸å®æˆ˜ä¼˜åŒ–å…¨æŒ‡å—</h2>
<p>åœ¨é«˜å¹¶å‘äº’è”ç½‘åœºæ™¯ä¸­ï¼ŒNginx æ—©å·²æˆä¸ºæ€§èƒ½æ ‡æ†â€”â€”æ— è®ºæ˜¯ç”µå•†å¤§ä¿ƒçš„æµé‡æ´ªå³°ã€çŸ­è§†é¢‘å¹³å°çš„äº¿çº§è¯·æ±‚ï¼Œè¿˜æ˜¯åˆ†å¸ƒå¼æ¶æ„ä¸­çš„åå‘ä»£ç†æ¢çº½ï¼ŒNginx éƒ½èƒ½ç¨³å®šæ‰¿è½½ç™¾ä¸‡çº§å¹¶å‘è¿æ¥ï¼Œç”šè‡³åœ¨ä¼˜åŒ–åˆ°ä½çš„å•æœºç¯å¢ƒä¸­å®ç°åƒä¸‡çº§ååã€‚ä¸åŒäº Apache çš„å¤šè¿›ç¨‹/å¤šçº¿ç¨‹æ¨¡å‹ï¼ŒNginx çš„é«˜æ€§èƒ½å¹¶éç®€å•çš„ä»£ç ä¼˜åŒ–ï¼Œè€Œæ˜¯æ¶æ„è®¾è®¡ã€äº‹ä»¶é©±åŠ¨ã€é…ç½®è°ƒä¼˜ä¸ç³»ç»ŸååŒçš„ç»¼åˆç»“æœã€‚æœ¬æ–‡å°†ä»åº•å±‚åŸç†å‡ºå‘ï¼Œå±‚å±‚æ‹†è§£ Nginx æ‰›ä½ç™¾ä¸‡å¹¶å‘çš„æ ¸å¿ƒé€»è¾‘ï¼Œç»“åˆç”Ÿäº§çº§ä¼˜åŒ–å®æˆ˜ï¼Œè®©ä½ æ—¢èƒ½ç†è§£â€œä¸ºä»€ä¹ˆâ€ï¼Œä¹Ÿèƒ½æŒæ¡â€œæ€ä¹ˆåšâ€ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€åŸºçŸ³ï¼šNginx çš„æ ¸å¿ƒæ¶æ„è®¾è®¡ï¼ˆå¹¶å‘çš„åº•å±‚æ”¯æ’‘ï¼‰</h2>
<p>Nginx ä¹‹æ‰€ä»¥èƒ½çªç ´ä¼ ç»Ÿ Web æœåŠ¡å™¨çš„å¹¶å‘ç“¶é¢ˆï¼Œæ ¸å¿ƒåœ¨äºå…¶â€œä¸»ä»è¿›ç¨‹ + å¤šè¿›ç¨‹/å¤šçº¿ç¨‹â€çš„æ¶æ„è®¾è®¡ï¼Œä»¥åŠä¸ CPU å¤šæ ¸æ¶æ„çš„æ·±åº¦é€‚é…ï¼Œä»æ ¹æºä¸Šå‡å°‘äº†è¿›ç¨‹åˆ‡æ¢ä¸èµ„æºç«äº‰çš„å¼€é”€ï¼Œä¸ºé«˜å¹¶å‘å¥ å®šäº†åŸºç¡€ã€‚</p>
<h3 data-id="heading-2">1.1 Master-Worker è¿›ç¨‹æ¨¡å‹ï¼ˆåˆ†å·¥æ˜ç¡®ï¼Œç¨³å®šæ€§æ‹‰æ»¡ï¼‰</h3>
<p>Nginx å¯åŠ¨åï¼Œä¼šäº§ç”Ÿä¸¤ç±»è¿›ç¨‹ï¼ŒäºŒè€…åˆ†å·¥æ¸…æ™°ã€ç›¸äº’ç‹¬ç«‹ï¼Œæ—¢ä¿è¯äº†é…ç½®çš„çƒ­åŠ è½½ï¼Œä¹Ÿé¿å…äº†å•ä¸ªè¿›ç¨‹æ•…éšœå¯¼è‡´æ•´ä½“æœåŠ¡é›ªå´©ï¼Œè¿™æ˜¯é«˜å¹¶å‘åœºæ™¯ä¸‹ç¨³å®šæ€§çš„æ ¸å¿ƒä¿éšœï¼š</p>
<ul>
<li>â€‹**Master è¿›ç¨‹ï¼ˆä¸»è¿›ç¨‹ï¼‰**â€‹ï¼šä½œä¸ºâ€œç®¡ç†è€…â€ï¼Œä¸ç›´æ¥å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œä»…è´Ÿè´£æ ¸å¿ƒç®¡æ§å·¥ä½œâ€”â€”è¯»å–å¹¶è§£æé…ç½®æ–‡ä»¶ã€å¯åŠ¨/åœæ­¢ Worker è¿›ç¨‹ã€é‡å¯æ•…éšœ Worker è¿›ç¨‹ã€æ¥æ”¶ä¿¡å·ï¼ˆå¦‚é‡å¯ã€é‡è½½é…ç½®ï¼‰ã€‚Master è¿›ç¨‹å ç”¨èµ„æºæå°‘ï¼Œå³ä¾¿å‡ºç°å¼‚å¸¸ï¼Œä¹Ÿèƒ½å¿«é€Ÿé‡å¯ï¼Œä¸”ä¸ä¼šå½±å“æ­£åœ¨å¤„ç†è¯·æ±‚çš„ Worker è¿›ç¨‹ï¼Œå®ç°â€œæ— ç¼é‡è½½â€ï¼Œè¿™ä¹Ÿæ˜¯ç”Ÿäº§ç¯å¢ƒä¸­ Nginx èƒ½ 7Ã—24 å°æ—¶ç¨³å®šè¿è¡Œçš„å…³é”®ã€‚</li>
<li>â€‹**Worker è¿›ç¨‹ï¼ˆå·¥ä½œè¿›ç¨‹ï¼‰**â€‹ï¼šä½œä¸ºâ€œæ‰§è¡Œè€…â€ï¼Œæ˜¯å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„æ ¸å¿ƒè½½ä½“ã€‚Master è¿›ç¨‹ä¼šæ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„ worker_processes å‚æ•°ï¼Œfork å‡ºå¤šä¸ª Worker è¿›ç¨‹ï¼ˆé€šå¸¸å»ºè®®è®¾ç½®ä¸º CPU æ ¸å¿ƒæ•°ï¼Œæˆ– auto è‡ªåŠ¨é€‚é…ï¼‰ï¼Œæ¯ä¸ª Worker è¿›ç¨‹éƒ½æ˜¯ç‹¬ç«‹çš„è¿›ç¨‹ï¼Œæ‹¥æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´å’Œæ–‡ä»¶æè¿°ç¬¦ï¼Œç›¸äº’ä¹‹é—´æ— å…±äº«èµ„æºï¼Œé¿å…äº†å¤šè¿›ç¨‹é—´çš„é”ç«äº‰å¼€é”€ã€‚</li>
</ul>
<p>å®æˆ˜ç»éªŒï¼šåœ¨ 32 æ ¸æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨ worker_processes auto æ¯”æ‰‹åŠ¨è®¾ç½® 32 ä¸ªè¿›ç¨‹æ€§èƒ½æå‡ 15%ï¼Œå› ä¸º Nginx ä¼šæ™ºèƒ½é€‚é… NUMA æ¶æ„ï¼Œé¿å…è¿›ç¨‹åœ¨ä¸åŒ CPU æ ¸å¿ƒé—´è¿ç§»ï¼Œå‡å°‘ç¼“å­˜å¤±æ•ˆçš„å¼€é”€ã€‚</p>
<h3 data-id="heading-3">1.2 è¿›ç¨‹ä¸ CPU å¤šæ ¸çš„æ·±åº¦é€‚é…ï¼ˆæœ€å¤§åŒ–åˆ©ç”¨ç¡¬ä»¶èµ„æºï¼‰</h3>
<p>ä¼ ç»Ÿ Web æœåŠ¡å™¨ï¼ˆå¦‚ Apacheï¼‰çš„å¤šè¿›ç¨‹æ¨¡å‹ï¼Œä¼šå¯¼è‡´è¿›ç¨‹åœ¨å¤šä¸ª CPU æ ¸å¿ƒé—´é¢‘ç¹åˆ‡æ¢ï¼Œæ¯æ¬¡åˆ‡æ¢éƒ½ä¼šæ¶ˆè€—å¤§é‡ CPU èµ„æºï¼Œéšç€å¹¶å‘é‡å¢åŠ ï¼Œåˆ‡æ¢å¼€é”€ä¼šæ€¥å‰§ä¸Šå‡ï¼Œæˆä¸ºå¹¶å‘ç“¶é¢ˆã€‚è€Œ Nginx é€šè¿‡â€œCPU äº²å’Œæ€§ç»‘å®šâ€ï¼Œå°†æ¯ä¸ª Worker è¿›ç¨‹å›ºå®šåˆ°ç‰¹å®šçš„ CPU æ ¸å¿ƒä¸Šï¼Œä»æ ¹æºä¸Šå‡å°‘äº†è¿›ç¨‹åˆ‡æ¢çš„å¼€é”€ã€‚</p>
<p>é…ç½®ç¤ºä¾‹ï¼ˆç”Ÿäº§çº§æ¨èï¼‰ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx"># ç»‘å®šWorkerè¿›ç¨‹åˆ°æŒ‡å®šCPUæ ¸å¿ƒï¼ˆ4æ ¸CPUç¤ºä¾‹ï¼‰
worker_processes 4;
worker_cpu_affinity 0001 0010 0100 1000;

# è‡ªåŠ¨é€‚é…CPUæ ¸å¿ƒï¼ˆæ¨èï¼Œæ— éœ€æ‰‹åŠ¨è®¡ç®—ï¼‰
worker_processes auto;
worker_cpu_affinity auto;
</code></pre>
<p>æ­¤å¤–ï¼Œæ¯ä¸ª Worker è¿›ç¨‹éƒ½æ˜¯å•çº¿ç¨‹ï¼ˆæˆ–å¯é…ç½®çº¿ç¨‹æ± ï¼‰æ¨¡å‹ï¼Œç»“åˆäº‹ä»¶é©±åŠ¨æœºåˆ¶ï¼Œèƒ½é«˜æ•ˆåˆ©ç”¨ CPU èµ„æºï¼Œé¿å…äº†å¤šçº¿ç¨‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€â€”â€”è¿™ä¹Ÿæ˜¯ Nginx åœ¨é«˜å¹¶å‘ä¸‹ CPU ä½¿ç”¨ç‡å§‹ç»ˆä¿æŒåˆç†æ°´å¹³çš„æ ¸å¿ƒåŸå› ä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-4">äºŒã€æ ¸å¿ƒï¼šReactor å¼‚æ­¥äº‹ä»¶é©±åŠ¨ï¼ˆçªç ´å¹¶å‘ç“¶é¢ˆçš„å…³é”®ï¼‰</h2>
<p>å¦‚æœè¯´æ¶æ„è®¾è®¡æ˜¯ Nginx çš„â€œéª¨æ¶â€ï¼Œé‚£ä¹ˆ Reactor å¼‚æ­¥äº‹ä»¶é©±åŠ¨å°±æ˜¯ Nginx çš„â€œå¿ƒè„â€ã€‚ä¼ ç»Ÿ Web æœåŠ¡å™¨é‡‡ç”¨â€œä¸€è¯·æ±‚ä¸€çº¿ç¨‹/è¿›ç¨‹â€çš„æ¨¡å‹ï¼Œæ¯ä¸ªè¿æ¥éƒ½éœ€è¦å ç”¨ä¸€ä¸ªçº¿ç¨‹/è¿›ç¨‹ï¼Œè€Œçº¿ç¨‹/è¿›ç¨‹çš„åˆ›å»ºå’Œé”€æ¯ã€ä¸Šä¸‹æ–‡åˆ‡æ¢éƒ½ä¼šæ¶ˆè€—å¤§é‡èµ„æºï¼Œå½“å¹¶å‘è¿æ¥è¾¾åˆ°ä¸‡çº§ä»¥ä¸Šæ—¶ï¼Œèµ„æºä¼šè¢«å¿«é€Ÿè€—å°½ï¼Œå¯¼è‡´æœåŠ¡å´©æºƒã€‚</p>
<p>Nginx åˆ™é‡‡ç”¨â€œå•çº¿ç¨‹ï¼ˆWorker å†…ï¼‰+ å¼‚æ­¥éé˜»å¡ I/Oâ€çš„ Reactor äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œæ ¸å¿ƒé€»è¾‘æ˜¯ï¼šâ€‹<strong>ä¸€ä¸ª Worker è¿›ç¨‹é€šè¿‡ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œç®¡ç†æˆåƒä¸Šä¸‡çš„å¹¶å‘è¿æ¥ï¼Œä»…åœ¨è¿æ¥æœ‰æ•°æ®å¯è¯»/å¯å†™æ—¶æ‰è¿›è¡Œå¤„ç†ï¼Œå…¶ä½™æ—¶é—´å¤„äºç©ºé—²å¾…å‘½çŠ¶æ€ï¼Œæ— éœ€æµªè´¹èµ„æºç­‰å¾…</strong>â€‹ã€‚è¿™ç§æ¨¡å‹ä»æ ¹æºä¸Šè§£å†³äº†ä¼ ç»Ÿæ¨¡å‹çš„å¹¶å‘ç“¶é¢ˆï¼Œå®ç°äº†â€œç”¨å°‘é‡èµ„æºæ‰¿è½½æµ·é‡è¿æ¥â€ã€‚</p>
<h3 data-id="heading-5">2.1 Reactor äº‹ä»¶é©±åŠ¨çš„æ ¸å¿ƒæµç¨‹ï¼ˆé€šä¿—æ‹†è§£ï¼‰</h3>
<p>Reactor æ¨¡å¼æœ¬è´¨æ˜¯ä¸€ç§â€œåŒæ­¥äº‹ä»¶è§‚å¯Ÿè€…æ¨¡å¼â€ï¼ŒåŒ…å«å››ä¸ªæ ¸å¿ƒè§’è‰²ï¼šèµ„æºï¼ˆSocketï¼‰ã€åŒæ­¥äº‹ä»¶åˆ†ç¦»å™¨ï¼ˆEpoll ç­‰ï¼‰ã€ååº”å™¨ï¼ˆReactorï¼‰ã€äº‹ä»¶å¤„ç†å™¨ï¼ˆEvent Handlerï¼‰ï¼Œå››è€…ååŒå®Œæˆè¯·æ±‚çš„é«˜æ•ˆå¤„ç†ï¼Œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>â€‹<strong>åˆå§‹åŒ–é˜¶æ®µ</strong>â€‹ï¼šNginx å¯åŠ¨åï¼ŒMaster è¿›ç¨‹åˆ›å»ºç›‘å¬ Socketï¼ŒWorker è¿›ç¨‹å°†ç›‘å¬ Socket æ³¨å†Œåˆ°åŒæ­¥äº‹ä»¶åˆ†ç¦»å™¨ï¼ˆå¦‚ Linux ä¸‹çš„ Epollï¼‰ï¼Œå¹¶æ³¨å†Œâ€œè¿æ¥å»ºç«‹â€äº‹ä»¶ï¼Œæ­¤æ—¶ Worker è¿›ç¨‹è¿›å…¥ç©ºé—²å¾…å‘½çŠ¶æ€ï¼Œä¸æ¶ˆè€— CPU èµ„æºã€‚</li>
<li>â€‹<strong>è¿æ¥å»ºç«‹é˜¶æ®µ</strong>â€‹ï¼šå½“å®¢æˆ·ç«¯å‘èµ· TCP è¿æ¥æ—¶ï¼Œç›‘å¬ Socket è§¦å‘â€œè¿æ¥å»ºç«‹â€äº‹ä»¶ï¼ŒEpoll å¿«é€Ÿæ„ŸçŸ¥å¹¶å°†äº‹ä»¶é€šçŸ¥ç»™ Reactorï¼ˆWorker çš„äº‹ä»¶å¾ªç¯ï¼‰ã€‚</li>
<li>â€‹<strong>äº‹ä»¶åˆ†å‘é˜¶æ®µ</strong>â€‹ï¼šReactor æ ¹æ®äº‹ä»¶ç±»å‹ï¼ˆè¿æ¥å»ºç«‹ã€æ•°æ®å¯è¯»ã€æ•°æ®å¯å†™ï¼‰ï¼Œè°ƒç”¨å¯¹åº”çš„äº‹ä»¶å¤„ç†å™¨â€”â€”æ¯”å¦‚â€œè¿æ¥å»ºç«‹â€äº‹ä»¶å¯¹åº”â€œæ¥æ”¶è¿æ¥â€å¤„ç†å™¨ï¼Œå®Œæˆ TCP ä¸‰æ¬¡æ¡æ‰‹ï¼Œåˆ›å»ºå®¢æˆ·ç«¯è¿æ¥ Socketï¼Œå¹¶å°†è¯¥ Socket æ³¨å†Œåˆ° Epoll ä¸­ï¼Œç›‘å¬â€œæ•°æ®å¯è¯»â€äº‹ä»¶ã€‚</li>
<li>â€‹<strong>è¯·æ±‚å¤„ç†é˜¶æ®µ</strong>â€‹ï¼šå½“å®¢æˆ·ç«¯å‘é€ HTTP è¯·æ±‚ï¼ˆæ•°æ®å¯è¯»ï¼‰æ—¶ï¼ŒEpoll æ„ŸçŸ¥äº‹ä»¶å¹¶é€šçŸ¥ Reactorï¼ŒReactor è°ƒç”¨â€œæ•°æ®è¯»å–â€å¤„ç†å™¨ï¼Œéé˜»å¡åœ°è¯»å–è¯·æ±‚æ•°æ®ã€è§£æè¯·æ±‚ï¼Œå†è°ƒç”¨å¯¹åº”çš„ä¸šåŠ¡å¤„ç†å™¨ï¼ˆå¦‚é™æ€èµ„æºè¯»å–ã€åå‘ä»£ç†ï¼‰å¤„ç†è¯·æ±‚ã€‚</li>
<li>â€‹<strong>å“åº”è¿”å›é˜¶æ®µ</strong>â€‹ï¼šå¤„ç†å®Œæˆåï¼ŒReactor å°†å“åº”æ•°æ®å†™å…¥å®¢æˆ·ç«¯ Socketï¼ˆæ•°æ®å¯å†™äº‹ä»¶ï¼‰ï¼Œå®Œæˆåæ— éœ€ç­‰å¾…å®¢æˆ·ç«¯ç¡®è®¤ï¼Œç«‹å³é‡Šæ”¾è¿æ¥èµ„æºï¼ˆæˆ–æ”¾å…¥é•¿è¿æ¥æ± ï¼‰ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªå°±ç»ªäº‹ä»¶ã€‚</li>
</ol>
<p>æ ¸å¿ƒä¼˜åŠ¿ï¼šæ•´ä¸ªæµç¨‹ä¸­ï¼ŒWorker è¿›ç¨‹å§‹ç»ˆå¤„äºâ€œé«˜æ•ˆå·¥ä½œâ€çŠ¶æ€ï¼Œæ— éœ€ç­‰å¾… I/O æ“ä½œï¼ˆå¦‚ç½‘ç»œä¼ è¾“ã€ç£ç›˜è¯»å–ï¼‰å®Œæˆï¼Œä¸€ä¸ª Worker è¿›ç¨‹çš„å•ä¸ªäº‹ä»¶å¾ªç¯ï¼Œå°±èƒ½ç®¡ç†ä¸Šä¸‡ç”šè‡³å‡ åä¸‡çš„å¹¶å‘è¿æ¥ï¼Œä¸”æ¯ä¸ªè¿æ¥ä»…å ç”¨å°‘é‡å†…å­˜ï¼ˆçº¦ 1KBï¼‰ï¼Œæå¤§åœ°é™ä½äº†èµ„æºæ¶ˆè€—ã€‚</p>
<h3 data-id="heading-6">2.2 å…³é”®æ”¯æ’‘ï¼šI/O å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼ˆEpoll çš„æ ¸å¿ƒä½œç”¨ï¼‰</h3>
<p>Reactor æ¨¡å¼çš„é«˜æ•ˆè¿è¡Œï¼Œç¦»ä¸å¼€ I/O å¤šè·¯å¤ç”¨æŠ€æœ¯çš„æ”¯æ’‘ã€‚I/O å¤šè·¯å¤ç”¨çš„æ ¸å¿ƒä½œç”¨æ˜¯ï¼šâ€‹<strong>ä¸€ä¸ªè¿›ç¨‹/çº¿ç¨‹å¯ä»¥åŒæ—¶ç›‘å¬å¤šä¸ª Socket è¿æ¥ï¼Œå¿«é€Ÿæ„ŸçŸ¥å“ªäº›è¿æ¥æœ‰äº‹ä»¶å‘ç”Ÿï¼ˆå¯è¯»/å¯å†™/å¼‚å¸¸ï¼‰ï¼Œå¹¶ä»…å¤„ç†è¿™äº›æ´»è·ƒè¿æ¥ï¼Œé¿å…ç›²ç›®è½®è¯¢</strong>â€‹ã€‚</p>
<p>Nginx æ”¯æŒå¤šç§ I/O å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼ˆæ ¹æ®æ“ä½œç³»ç»Ÿè‡ªåŠ¨é€‚é…ï¼‰ï¼Œå…¶ä¸­ Linux ç³»ç»Ÿä¸‹çš„ Epoll æ˜¯æ€§èƒ½æœ€ä¼˜çš„é€‰æ‹©ï¼Œä¹Ÿæ˜¯ Nginx èƒ½æ‰›ä½ç™¾ä¸‡å¹¶å‘çš„â€œæ ¸å¿ƒæ­¦å™¨â€ã€‚å¯¹æ¯”ä¼ ç»Ÿçš„ Select/Poll æŠ€æœ¯ï¼ŒEpoll çš„ä¼˜åŠ¿æä¸ºæ˜æ˜¾ï¼š</p>

































<table><thead><tr><th>æŠ€æœ¯</th><th>æœ€å¤§è¿æ¥æ•°é™åˆ¶</th><th>äº‹ä»¶æ£€æµ‹æ–¹å¼</th><th>æ€§èƒ½å¼€é”€</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Select</td><td>é»˜è®¤ 1024ï¼ˆå¯ä¿®æ”¹ï¼Œä½†æœ‰é™åˆ¶ï¼‰</td><td>è½®è¯¢æ‰€æœ‰è¿æ¥ï¼Œç›²ç›®éå†</td><td>O(n)ï¼Œéšè¿æ¥æ•°å¢åŠ æ€¥å‰§ä¸Šå‡</td><td>ä½å¹¶å‘åœºæ™¯ï¼ˆä¸‡çº§ä»¥ä¸‹ï¼‰</td></tr><tr><td>Poll</td><td>æ— ç¡¬é™åˆ¶ï¼Œä½†å—ç³»ç»Ÿèµ„æºçº¦æŸ</td><td>è½®è¯¢æ‰€æœ‰è¿æ¥ï¼Œç›²ç›®éå†</td><td>O(n)ï¼Œä¸ Select ç±»ä¼¼</td><td>ä¸­ä½å¹¶å‘åœºæ™¯</td></tr><tr><td>Epoll</td><td>æ— ç¡¬é™åˆ¶ï¼Œä»…å—ç³»ç»Ÿå†…å­˜çº¦æŸ</td><td>äº‹ä»¶é€šçŸ¥æ¨¡å¼ï¼Œä»…è¿”å›æ´»è·ƒè¿æ¥</td><td>O(1)ï¼Œä¸è¿æ¥æ•°æ— å…³</td><td>é«˜å¹¶å‘åœºæ™¯ï¼ˆä¸‡çº§ä»¥ä¸Šï¼Œæ”¯æŒç™¾ä¸‡çº§ï¼‰</td></tr></tbody></table>
<p>Epoll çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºâ€œäº‹ä»¶é€šçŸ¥â€è€Œéâ€œç›²ç›®è½®è¯¢â€ï¼šå®ƒä¼šä¸»åŠ¨è®°å½•æ‰€æœ‰æ³¨å†Œçš„ Socket è¿æ¥ï¼Œå½“æŸä¸ªè¿æ¥æœ‰äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå†…æ ¸ä¼šç«‹å³é€šçŸ¥ Epollï¼ŒEpoll å†å°†è¯¥æ´»è·ƒè¿æ¥è¿”å›ç»™ Nginx çš„ Worker è¿›ç¨‹ï¼ŒWorker è¿›ç¨‹ä»…å¤„ç†è¿™äº›æ´»è·ƒè¿æ¥ï¼Œæ— éœ€éå†æ‰€æœ‰è¿æ¥ã€‚è¿™ç§æœºåˆ¶ä½¿å¾— Epoll çš„æ€§èƒ½ä¸ä¼šéšè¿æ¥æ•°å¢åŠ è€Œä¸‹é™ï¼Œå³ä¾¿æ‰¿è½½ç™¾ä¸‡çº§è¿æ¥ï¼Œä¹Ÿèƒ½ä¿æŒé«˜æ•ˆå“åº”â€”â€”è¿™æ­£æ˜¯ Nginx çªç ´å¹¶å‘ç“¶é¢ˆçš„å…³é”®æŠ€æœ¯æ”¯æ’‘ã€‚</p>
<h3 data-id="heading-7">2.3 è¡¥å……ä¼˜åŒ–ï¼šçº¿ç¨‹æ± æ¨¡å‹ï¼ˆå¤„ç†é˜»å¡ I/Oï¼‰</h3>
<p>è™½ç„¶ Nginx çš„å¼‚æ­¥éé˜»å¡ I/O èƒ½å¤„ç†ç»å¤§å¤šæ•°é«˜å¹¶å‘åœºæ™¯ï¼Œä½†åœ¨é¢å¯¹ç£ç›˜ I/Oï¼ˆå¦‚è¯»å–å¤§ä½“ç§¯é™æ€æ–‡ä»¶ï¼‰ã€SSL åŠ å¯†è§£å¯†ç­‰é˜»å¡æ“ä½œæ—¶ï¼Œä»ä¼šå¯¼è‡´äº‹ä»¶å¾ªç¯é˜»å¡ï¼Œå½±å“å¹¶å‘å¤„ç†æ•ˆç‡ã€‚ä¸ºæ­¤ï¼ŒNginx å¼•å…¥äº†çº¿ç¨‹æ± æ¨¡å‹ï¼Œå°†é˜»å¡æ“ä½œæ”¾å…¥ç‹¬ç«‹çº¿ç¨‹æ± å¤„ç†ï¼Œé¿å…é˜»å¡ä¸»äº‹ä»¶å¾ªç¯ã€‚</p>
<p>é…ç½®ç¤ºä¾‹ï¼ˆç”Ÿäº§çº§æ¨èï¼‰ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx"># åˆ›å»ºçº¿ç¨‹æ± ï¼Œè®¾ç½®çº¿ç¨‹æ•°å’Œé˜Ÿåˆ—å¤§å°
thread_pool default threads=32 max_queue=65536;

http {
    sendfile on;
    aio threads=default; # ä½¿ç”¨çº¿ç¨‹æ± å¤„ç†å¼‚æ­¥I/O
}
</code></pre>
<p>çº¿ç¨‹æ± çš„å¼•å…¥ï¼Œè®© Nginx åœ¨å¤„ç†é˜»å¡æ“ä½œæ—¶ï¼Œä¾ç„¶èƒ½ä¿æŒä¸»äº‹ä»¶å¾ªç¯çš„é«˜æ•ˆè¿è¡Œï¼Œè¿›ä¸€æ­¥æå‡äº†é«˜å¹¶å‘åœºæ™¯ä¸‹çš„ç¨³å®šæ€§å’Œååé‡ã€‚</p>
<h2 data-id="heading-8">ä¸‰ã€å®æˆ˜ï¼šNginx æ ¸å¿ƒé…ç½®ä¼˜åŒ–ï¼ˆä»åä¸‡åˆ°ç™¾ä¸‡å¹¶å‘çš„çªç ´ï¼‰</h2>
<p>åº•å±‚æ¶æ„å’Œäº‹ä»¶é©±åŠ¨æ˜¯ Nginx é«˜å¹¶å‘çš„åŸºç¡€ï¼Œä½†è¦çœŸæ­£æ‰›ä½ç™¾ä¸‡å¹¶å‘ï¼Œè¿˜éœ€è¦è¿›è¡Œé’ˆå¯¹æ€§çš„é…ç½®ä¼˜åŒ–â€”â€”é»˜è®¤é…ç½®çš„ Nginx ä»…èƒ½æ‰¿è½½æ•°ä¸‡å¹¶å‘ï¼Œé€šè¿‡ç³»ç»ŸåŒ–çš„é…ç½®è°ƒä¼˜ï¼Œå¯å®ç°ä»åä¸‡ QPS åˆ°ç™¾ä¸‡ QPS çš„è·¨è¶Šå¼æå‡ã€‚ä»¥ä¸‹æ˜¯ç”Ÿäº§çº§æ ¸å¿ƒä¼˜åŒ–é…ç½®ï¼ŒæŒ‰â€œåŸºç¡€å¹¶å‘ â†’TCP è¿æ¥ â†’ ç¼“å­˜å‹ç¼© â†’ è´Ÿè½½å‡è¡¡â€åˆ†ç±»ï¼Œé™„åŸç†è¯´æ˜å’Œå®æˆ˜å‚æ•°ã€‚</p>
<h3 data-id="heading-9">3.1 åŸºç¡€å¹¶å‘é…ç½®ï¼ˆæœ€å¤§åŒ–åˆ©ç”¨ Worker èµ„æºï¼‰</h3>
<p>æ ¸å¿ƒç›®æ ‡ï¼šè®© Worker è¿›ç¨‹çš„èµ„æºåˆ†é…ä¸ç¡¬ä»¶åŒ¹é…ï¼Œæœ€å¤§åŒ–æå‡å•ä¸ª Worker çš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</p>
<pre><code class="hljs language-nginx" lang="nginx"># 1. è®¾ç½®Workerè¿›ç¨‹æ•°ï¼ˆæ¨è=CPUæ ¸å¿ƒæ•°ï¼Œæˆ–autoï¼‰
worker_processes auto;

# 2. ç»‘å®šCPUæ ¸å¿ƒï¼ˆé¿å…è¿›ç¨‹è¿ç§»ï¼Œæå‡ç¼“å­˜å‘½ä¸­ç‡ï¼‰
worker_cpu_affinity auto;

# 3. è®¾ç½®å•ä¸ªWorkerè¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°ï¼ˆå…³é”®å‚æ•°ï¼‰
events {
    use epoll; # å¯ç”¨Epolläº‹ä»¶æ¨¡å‹ï¼ˆLinuxå¿…é…ï¼‰
    worker_connections 65535; # å•ä¸ªWorkeræœ€å¤§è¿æ¥æ•°ï¼ˆä¸Šé™å—ç³»ç»Ÿæ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼‰
    multi_accept on; # å…è®¸Workerè¿›ç¨‹åŒæ—¶æ¥å—å¤šä¸ªè¿æ¥ï¼Œæå‡è¿æ¥å»ºç«‹æ•ˆç‡
    worker_rlimit_nofile 655350; # æå‡Workerè¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼Œä¸ç³»ç»Ÿçº§é…ç½®åŒ¹é…
}
</code></pre>
<p>å…³é”®è¯´æ˜ï¼šworker_connections çš„å–å€¼å¹¶éè¶Šå¤§è¶Šå¥½ï¼Œéœ€ç»“åˆç³»ç»Ÿæ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼ˆåç»­ç³»ç»Ÿä¼˜åŒ–ä¼šè®²ï¼‰ï¼Œé€šå¸¸è®¾ç½®ä¸º 65535ï¼ˆå•ä¸ª Worker æœ€å¤§æ”¯æŒ 65535 ä¸ªè¿æ¥ï¼‰ï¼Œè‹¥æœåŠ¡å™¨ä¸º 32 æ ¸ CPUï¼Œå¯ç”¨ 32 ä¸ª Worker è¿›ç¨‹ï¼Œç†è®ºä¸Šå¯æ”¯æŒ 32Ã—65535â‰ˆ200 ä¸‡å¹¶å‘è¿æ¥ï¼ˆå®é™…éœ€æ‰£é™¤ç›‘å¬è¿æ¥ã€åç«¯ä»£ç†è¿æ¥ï¼Œçº¦ 150 ä¸‡ +ï¼‰ã€‚</p>
<h3 data-id="heading-10">3.2 TCP è¿æ¥ä¼˜åŒ–ï¼ˆå‡å°‘è¿æ¥å¼€é”€ï¼Œæå‡è¿æ¥å¤ç”¨ç‡ï¼‰</h3>
<p>TCP è¿æ¥çš„å»ºç«‹ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰å’Œå…³é—­ï¼ˆå››æ¬¡æŒ¥æ‰‹ï¼‰ä¼šæ¶ˆè€—å¤§é‡ç½‘ç»œèµ„æºå’Œæ—¶é—´ï¼Œå°¤å…¶æ˜¯é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œé¢‘ç¹çš„è¿æ¥å»ºç«‹/å…³é—­ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚é€šè¿‡ TCP è¿æ¥ä¼˜åŒ–ï¼Œå¯å‡å°‘è¿æ¥å¼€é”€ï¼Œæå‡è¿æ¥å¤ç”¨ç‡ï¼Œå»¶é•¿è¿æ¥ç”Ÿå‘½å‘¨æœŸã€‚</p>
<pre><code class="hljs language-nginx" lang="nginx">http {
    # 1. å¼€å¯TCP_NODELAYï¼Œå‡å°‘å°åŒ…å»¶è¿Ÿï¼ˆç¦ç”¨Nagleç®—æ³•ï¼‰
    tcp_nodelay on;
    # 2. å¼€å¯TCP_NOPUSHï¼Œä¸sendfileé…åˆä½¿ç”¨ï¼Œæé«˜ç½‘ç»œä¼ è¾“æ•ˆç‡ï¼ˆæ‰¹é‡å‘é€æ•°æ®ï¼‰
    tcp_nopush on;
    # 3. å¯ç”¨HTTPé•¿è¿æ¥ï¼Œå¤ç”¨TCPè¿æ¥ï¼Œå‡å°‘è¿æ¥å»ºç«‹/å…³é—­å¼€é”€
    keepalive_timeout 65; # é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå®¢æˆ·ç«¯65ç§’å†…æ— è¯·æ±‚åˆ™å…³é—­è¿æ¥
    keepalive_requests 10000; # å•ä¸ªé•¿è¿æ¥å¯å¤„ç†çš„æœ€å¤§è¯·æ±‚æ•°ï¼Œé¿å…é•¿è¿æ¥é•¿æœŸå ç”¨èµ„æº
    keepalive_disable msie6; # ç¦ç”¨IE6çš„é•¿è¿æ¥æ”¯æŒï¼ˆå…¼å®¹æ€§ä¼˜åŒ–ï¼‰
    
    # 4. å®¢æˆ·ç«¯è¯·æ±‚ç¼“å†²åŒºä¼˜åŒ–ï¼Œé¿å…é¢‘ç¹è¯»å–ç£ç›˜
    client_max_body_size 20m; # å®¢æˆ·ç«¯è¯·æ±‚ä½“æœ€å¤§å¤§å°
    client_body_buffer_size 128k; # è¯·æ±‚ä½“ç¼“å†²åŒºå¤§å°ï¼Œå°äºè¯¥å€¼ç›´æ¥å­˜å†…å­˜ï¼Œå¤§äºåˆ™å­˜ç£ç›˜
    client_header_buffer_size 4k; # è¯·æ±‚å¤´ç¼“å†²åŒºå¤§å°
    large_client_header_buffers 8 8k; # å¤§è¯·æ±‚å¤´ç¼“å†²åŒºï¼ˆå¦‚Cookieè¾ƒå¤šçš„åœºæ™¯ï¼‰
}
</code></pre>
<p>å…³é”®æ•ˆæœï¼šå¯ç”¨é•¿è¿æ¥åï¼Œå®¢æˆ·ç«¯åªéœ€å»ºç«‹ä¸€æ¬¡ TCP è¿æ¥ï¼Œå³å¯å‘é€å¤šä¸ª HTTP è¯·æ±‚ï¼Œè¿æ¥å¤ç”¨ç‡å¯æå‡ 80% ä»¥ä¸Šï¼Œå¤§å¹…å‡å°‘ TCP ä¸‰æ¬¡æ¡æ‰‹/å››æ¬¡æŒ¥æ‰‹çš„å¼€é”€ï¼Œå°¤å…¶é€‚åˆé™æ€èµ„æºè¯·æ±‚ï¼ˆå¦‚å›¾ç‰‡ã€CSSã€JSï¼‰è¾ƒå¤šçš„åœºæ™¯ã€‚</p>
<h3 data-id="heading-11">3.3 ç¼“å­˜ä¸å‹ç¼©ä¼˜åŒ–ï¼ˆå‡å°‘åç«¯å‹åŠ›ï¼Œæå‡å“åº”é€Ÿåº¦ï¼‰</h3>
<p>é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œå¤§é‡è¯·æ±‚ä¼šè®¿é—®ç›¸åŒçš„é™æ€èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€CSSã€JSï¼‰æˆ–é‡å¤çš„åŠ¨æ€è¯·æ±‚ï¼Œè‹¥æ¯æ¬¡éƒ½è¯·æ±‚åç«¯æœåŠ¡ï¼Œä¼šå¯¼è‡´åç«¯å‹åŠ›è¿‡å¤§ã€‚é€šè¿‡ç¼“å­˜å’Œå‹ç¼©ä¼˜åŒ–ï¼Œå¯è®© Nginx ç›´æ¥è¿”å›ç¼“å­˜å†…å®¹ï¼Œå‡å°‘åç«¯è¯·æ±‚ï¼ŒåŒæ—¶å‹ç¼©å“åº”æ•°æ®ï¼Œå‡å°‘ç½‘ç»œä¼ è¾“é‡ã€‚</p>
<h4 data-id="heading-12">3.3.1 é™æ€èµ„æºç¼“å­˜ï¼ˆæ ¸å¿ƒä¼˜åŒ–ï¼Œæå‡é™æ€èµ„æºååï¼‰</h4>
<pre><code class="hljs language-nginx" lang="nginx">http {
    # é™æ€èµ„æºç¼“å­˜é…ç½®ï¼ˆåŒ¹é…å›¾ç‰‡ã€CSSã€JSç­‰é™æ€æ–‡ä»¶ï¼‰
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|pdf|txt)$ {
        root /var/www/static; # é™æ€èµ„æºæ ¹ç›®å½•
        expires 1y; # ç¼“å­˜æœ‰æ•ˆæœŸ1å¹´ï¼ˆé•¿æœŸç¼“å­˜é™æ€èµ„æºï¼‰
        add_header Cache-Control "public, immutable"; # å‘ŠçŸ¥å®¢æˆ·ç«¯ç¼“å­˜ç­–ç•¥ï¼Œç¦æ­¢é‡å¤è¯·æ±‚
        add_header Pragma "cache"; # å…¼å®¹HTTP/1.0
        gzip_static on; # å¯ç”¨é¢„å‹ç¼©çš„é™æ€èµ„æºï¼ˆæå‰å‹ç¼©å¥½ï¼Œé¿å…å®æ—¶å‹ç¼©å¼€é”€ï¼‰
        sendfile on; # å¯ç”¨é›¶æ‹·è´æŠ€æœ¯ï¼Œå‡å°‘å†…æ ¸ä¸ç”¨æˆ·ç©ºé—´çš„æ•°æ®æ‹·è´
        sendfile_max_chunk 1m; # é›¶æ‹·è´å•æ¬¡ä¼ è¾“æœ€å¤§å¤§å°ï¼Œé¿å…å ç”¨è¿‡å¤šå†…å­˜
        access_log off; # å…³é—­é™æ€èµ„æºçš„è®¿é—®æ—¥å¿—ï¼Œå‡å°‘ç£ç›˜I/Oå¼€é”€
        open_file_cache max=10000 inactive=60s; # ç¼“å­˜æ–‡ä»¶å¥æŸ„ï¼Œå‡å°‘ç£ç›˜æ–‡ä»¶æ‰“å¼€å¼€é”€
        open_file_cache_valid 80s; # ç¼“å­˜æ–‡ä»¶å¥æŸ„çš„æœ‰æ•ˆæœŸ
        open_file_cache_min_uses 2; # ç¼“å­˜æ–‡ä»¶å¥æŸ„çš„æœ€å°ä½¿ç”¨æ¬¡æ•°
    }
}
</code></pre>
<h4 data-id="heading-13">3.3.2 åŠ¨æ€å‹ç¼©ä¼˜åŒ–ï¼ˆå‡å°‘å“åº”æ•°æ®ä½“ç§¯ï¼‰</h4>
<pre><code class="hljs language-nginx" lang="nginx">http {
    # Gzipå‹ç¼©é…ç½®ï¼ˆé»˜è®¤å¯ç”¨ï¼Œä¼˜åŒ–æ–‡æœ¬ç±»å“åº”ï¼‰
    gzip on;
    gzip_vary on; # å‘ŠçŸ¥å®¢æˆ·ç«¯å½“å‰å“åº”å·²å‹ç¼©ï¼Œæå‡å…¼å®¹æ€§
    gzip_min_length 1024; # ä»…å‹ç¼©å¤§äº1KBçš„æ•°æ®ï¼ˆå°æ•°æ®å‹ç¼©æ— æ„ä¹‰ï¼Œåè€Œå¢åŠ å¼€é”€ï¼‰
    gzip_comp_level 6; # å‹ç¼©çº§åˆ«ï¼ˆ1-9ï¼‰ï¼Œ6ä¸ºå…¼é¡¾æ€§èƒ½å’Œå‹ç¼©æ¯”çš„æœ€ä¼˜å€¼
    gzip_types text/plain text/css text/xml text/javascript application/json application/javascript application/xml+rss application/atom+xml; # éœ€å‹ç¼©çš„æ–‡ä»¶ç±»å‹
    
    # Brotliå‹ç¼©é…ç½®ï¼ˆéœ€ç¼–è¯‘æ¨¡å—ï¼Œæ¯”Gzipå‹ç¼©æ¯”æ›´é«˜ï¼‰
    brotli on;
    brotli_comp_level 6;
    brotli_types text/plain text/css application/json application/javascript;
}
</code></pre>
<p>å…³é”®æ•ˆæœï¼šå¯ç”¨ Gzip å‹ç¼©åï¼Œæ–‡æœ¬ç±»å“åº”æ•°æ®ä½“ç§¯å¯å‡å°‘ 50%-70%ï¼›å¯ç”¨ Brotli å‹ç¼©åï¼Œä¼ è¾“æ•°æ®é‡å¯è¿›ä¸€æ­¥å‡å°‘ 25%ï¼Œé¡µé¢åŠ è½½é€Ÿåº¦æå‡ 35%ï¼ŒåŒæ—¶å‡å°‘ç½‘ç»œå¸¦å®½å ç”¨ï¼Œé—´æ¥æå‡å¹¶å‘æ‰¿è½½èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-14">3.4 è´Ÿè½½å‡è¡¡ä¸åç«¯è¿æ¥ä¼˜åŒ–ï¼ˆåˆ†æ•£å‹åŠ›ï¼Œæå‡å¯ç”¨æ€§ï¼‰</h3>
<p>å½“å¹¶å‘é‡è¾¾åˆ°ç™¾ä¸‡çº§æ—¶ï¼Œå•å°åç«¯æœåŠ¡å™¨æ— æ³•æ‰¿è½½å‹åŠ›ï¼ŒNginx ä½œä¸ºåå‘ä»£ç†ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡å°†è¯·æ±‚åˆ†å‘åˆ°å¤šå°åç«¯æœåŠ¡å™¨ï¼Œåˆ†æ•£å‹åŠ›ï¼ŒåŒæ—¶ä¼˜åŒ–åç«¯è¿æ¥æ± ï¼Œæå‡ä»£ç†æ•ˆç‡ã€‚</p>
<pre><code class="hljs language-nginx" lang="nginx">http {
    # åç«¯æœåŠ¡å™¨é›†ç¾¤é…ç½®ï¼ˆè´Ÿè½½å‡è¡¡æ± ï¼‰
    upstream backend {
        least_conn; # è´Ÿè½½å‡è¡¡ç®—æ³•ï¼ˆæœ€å°è¿æ¥æ•°ç®—æ³•ï¼Œé€‚åˆåç«¯å¤„ç†æ—¶é—´ä¸å‡çš„åœºæ™¯ï¼‰
        # ip_hash; # å¯é€‰ï¼šIPå“ˆå¸Œç®—æ³•ï¼Œä¿è¯åŒä¸€å®¢æˆ·ç«¯è¯·æ±‚åˆ†å‘åˆ°åŒä¸€åç«¯æœåŠ¡å™¨ï¼ˆä¼šè¯ä¿æŒï¼‰
        # åç«¯æœåŠ¡å™¨é…ç½®ï¼Œè®¾ç½®æœ€å¤§å¤±è´¥æ¬¡æ•°å’Œå¤±è´¥è¶…æ—¶æ—¶é—´
        server 192.168.1.10:8080 max_fails=3 fail_timeout=30s;
        server 192.168.1.11:8080 max_fails=3 fail_timeout=30s;
        server 192.168.1.12:8080 max_fails=3 fail_timeout=30s backup; # backupï¼šå¤‡ç”¨æœåŠ¡å™¨ï¼Œä¸»æœåŠ¡å™¨æ•…éšœæ—¶å¯ç”¨
        
        # åç«¯è¿æ¥æ± ä¼˜åŒ–ï¼Œå¤ç”¨ä¸åç«¯çš„TCPè¿æ¥
        keepalive 300; # åç«¯è¿æ¥æ± çš„æœ€å¤§ç©ºé—²è¿æ¥æ•°
        keepalive_requests 1000; # å•ä¸ªåç«¯è¿æ¥å¯å¤„ç†çš„æœ€å¤§è¯·æ±‚æ•°
        keepalive_timeout 60s; # åç«¯è¿æ¥çš„è¶…æ—¶æ—¶é—´
    }
    
    server {
        listen 80;
        server_name example.com;
        
        location / {
            proxy_pass http://backend; # åå‘ä»£ç†åˆ°åç«¯é›†ç¾¤
            proxy_http_version 1.1; # å¯ç”¨HTTP/1.1ï¼Œæ”¯æŒé•¿è¿æ¥
            proxy_set_header Connection ""; # æ¸…é™¤å®¢æˆ·ç«¯Connectionå¤´ï¼Œå¤ç”¨åç«¯é•¿è¿æ¥
            # åç«¯ä»£ç†ç¼“å†²åŒºä¼˜åŒ–ï¼Œå‡å°‘I/Oç­‰å¾…
            proxy_buffering on;
            proxy_buffer_size 128k;
            proxy_buffers 8 128k;
            proxy_busy_buffers_size 256k;
            # åç«¯è¿æ¥è¶…æ—¶é…ç½®ï¼Œé¿å…é•¿æœŸé˜»å¡
            proxy_connect_timeout 5s; # ä¸åç«¯å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´
            proxy_send_timeout 10s; # å‘åç«¯å‘é€è¯·æ±‚çš„è¶…æ—¶æ—¶é—´
            proxy_read_timeout 10s; # è¯»å–åç«¯å“åº”çš„è¶…æ—¶æ—¶é—´
        }
    }
}
</code></pre>
<h2 data-id="heading-15">å››ã€æ”¯æ’‘ï¼šLinux ç³»ç»Ÿçº§ä¼˜åŒ–ï¼ˆçªç ´ç³»ç»Ÿç“¶é¢ˆï¼‰</h2>
<p>Nginx çš„é«˜å¹¶å‘æ€§èƒ½ï¼Œä¸ä»…ä¾èµ–è‡ªèº«é…ç½®ï¼Œè¿˜å— Linux ç³»ç»Ÿå†…æ ¸å‚æ•°çš„çº¦æŸâ€”â€”é»˜è®¤çš„ Linux ç³»ç»Ÿå‚æ•°ï¼Œæ˜¯ä¸ºé€šç”¨åœºæ™¯è®¾è®¡çš„ï¼Œæ— æ³•æ»¡è¶³ç™¾ä¸‡å¹¶å‘çš„éœ€æ±‚ï¼Œè‹¥ä¸è¿›è¡Œç³»ç»Ÿä¼˜åŒ–ï¼Œå³ä¾¿ Nginx é…ç½®åˆ°ä½ï¼Œä¹Ÿä¼šå› ç³»ç»Ÿç“¶é¢ˆå¯¼è‡´å¹¶å‘å¤±è´¥ï¼ˆå¦‚æ–‡ä»¶æè¿°ç¬¦ä¸è¶³ã€TCP è¿æ¥é˜Ÿåˆ—æº¢å‡ºï¼‰ã€‚ä»¥ä¸‹æ˜¯ç”Ÿäº§çº§ Linux ç³»ç»Ÿä¼˜åŒ–æ–¹æ¡ˆï¼Œé’ˆå¯¹ CentOS/RHEL ç³»ç»Ÿï¼Œç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶å³å¯ç”Ÿæ•ˆã€‚</p>
<h3 data-id="heading-16">4.1 æå‡æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼ˆæ ¸å¿ƒä¼˜åŒ–ï¼‰</h3>
<p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œä¸€åˆ‡çš†æ–‡ä»¶ï¼ŒSocket è¿æ¥æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§æ–‡ä»¶ï¼Œæ¯ä¸ª Socket è¿æ¥ä¼šå ç”¨ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒLinux ç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼ˆæ¯ä¸ªè¿›ç¨‹ã€æ¯ä¸ªç”¨æˆ·ï¼‰å¾ˆä½ï¼ˆå¦‚ 1024ï¼‰ï¼Œå½“å¹¶å‘è¿æ¥è¾¾åˆ°ä¸‡çº§ä»¥ä¸Šæ—¶ï¼Œä¼šå‡ºç°â€œtoo many open filesâ€é”™è¯¯ï¼Œå¯¼è‡´è¿æ¥å¤±è´¥ã€‚</p>
<ol>
<li>â€‹<strong>ç”¨æˆ·çº§é™åˆ¶è°ƒæ•´</strong>â€‹ï¼šä¿®æ”¹/etc/security/limits.confï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰ï¼š<code># é’ˆå¯¹nginxç”¨æˆ·çš„æ–‡ä»¶æè¿°ç¬¦å’Œè¿›ç¨‹æ•°é™åˆ¶ </code>â€‹<code>nginx soft nofile 655350 </code>â€‹<code>nginx hard nofile 655350 </code>â€‹<code>nginx soft nproc 655350 </code>â€‹<code>nginx hard nproc 655350</code></li>
<li>â€‹<strong>ç³»ç»Ÿçº§é™åˆ¶è°ƒæ•´</strong>â€‹ï¼šä¿®æ”¹/etc/sysctl.confï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰ï¼š<code># ç³»ç»Ÿçº§æœ€å¤§æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ </code>â€‹<code>fs.file-max = 6815744</code></li>
<li>â€‹<strong>systemd æœåŠ¡é™åˆ¶è°ƒæ•´</strong>â€‹ï¼šå¾ˆå¤šå·¥ç¨‹å¸ˆä¼šå¿½ç•¥ systemd æœåŠ¡çš„é™åˆ¶ï¼Œéœ€ä¿®æ”¹ nginx.serviceï¼ˆé€šå¸¸åœ¨/usr/lib/systemd/system/nginx.serviceï¼‰ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š<code>[Service] </code>â€‹<code>LimitNOFILE=655350 </code>â€‹<code>LimitNPROC=655350</code></li>
</ol>
<h3 data-id="heading-17">4.2 TCP å†…æ ¸å‚æ•°ä¼˜åŒ–ï¼ˆæå‡ TCP è¿æ¥æ€§èƒ½ï¼‰</h3>
<p>ä¿®æ”¹/etc/sysctl.confï¼Œæ·»åŠ ä»¥ä¸‹ TCP å†…æ ¸å‚æ•°ï¼Œä¼˜åŒ– TCP è¿æ¥çš„å»ºç«‹ã€å¤ç”¨å’Œä¼ è¾“æ•ˆç‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. TCPè¿æ¥é˜Ÿåˆ—ä¼˜åŒ–ï¼Œé¿å…è¿æ¥æº¢å‡º</span>
net.core.somaxconn = 65535 <span class="hljs-comment"># ç›‘å¬é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦ï¼Œä¸nginxçš„listen_backlogåŒ¹é…</span>
net.core.netdev_max_backlog = 30000 <span class="hljs-comment"># ç½‘ç»œè®¾å¤‡æ¥æ”¶é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦</span>
net.ipv4.tcp_max_syn_backlog = 65535 <span class="hljs-comment"># TCPä¸‰æ¬¡æ¡æ‰‹æ—¶ï¼ŒSYNé˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦</span>

<span class="hljs-comment"># 2. TCPè¿æ¥å¤ç”¨ä¸å›æ”¶ï¼Œå‡å°‘TIME_WAITçŠ¶æ€è¿æ¥</span>
net.ipv4.tcp_tw_reuse = 1 <span class="hljs-comment"># å…è®¸å¤ç”¨TIME_WAITçŠ¶æ€çš„è¿æ¥ï¼ˆä»…ç”¨äºå®¢æˆ·ç«¯ï¼‰</span>
net.ipv4.tcp_tw_recycle = 0 <span class="hljs-comment"># ç¦ç”¨TIME_WAITè¿æ¥å›æ”¶ï¼ˆé«˜å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½å¯¼è‡´è¿æ¥å¼‚å¸¸ï¼‰</span>
net.ipv4.tcp_fin_timeout = 10 <span class="hljs-comment"># TIME_WAITçŠ¶æ€çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤60ç§’ï¼Œæ”¹ä¸º10ç§’åŠ é€Ÿå›æ”¶</span>
net.ipv4.tcp_max_tw_buckets = 100000 <span class="hljs-comment"># ç³»ç»Ÿå…è®¸çš„æœ€å¤§TIME_WAITè¿æ¥æ•°</span>

<span class="hljs-comment"># 3. TCPç¼“å†²åŒºä¼˜åŒ–ï¼Œæå‡ç½‘ç»œä¼ è¾“æ•ˆç‡</span>
net.core.rmem_max = 67108864 <span class="hljs-comment"># æ¥æ”¶ç¼“å†²åŒºæœ€å¤§å¤§å°ï¼ˆ64MBï¼‰</span>
net.core.wmem_max = 67108864 <span class="hljs-comment"># å‘é€ç¼“å†²åŒºæœ€å¤§å¤§å°ï¼ˆ64MBï¼‰</span>
net.ipv4.tcp_rmem = 4096 87380 67108864 <span class="hljs-comment"># æ¥æ”¶ç¼“å†²åŒºé»˜è®¤ã€æœ€å°ã€æœ€å¤§å¤§å°</span>
net.ipv4.tcp_wmem = 4096 65536 67108864 <span class="hljs-comment"># å‘é€ç¼“å†²åŒºé»˜è®¤ã€æœ€å°ã€æœ€å¤§å¤§å°</span>

<span class="hljs-comment"># 4. å…¶ä»–ä¼˜åŒ–</span>
net.ipv4.tcp_syncookies = 1 <span class="hljs-comment"># å¯ç”¨SYN Cookieï¼Œé˜²æ­¢SYNæ´ªæ°´æ”»å‡»</span>
net.ipv4.ip_local_port_range = 1024 65535 <span class="hljs-comment"># å¯ç”¨çš„æœ¬åœ°ç«¯å£èŒƒå›´ï¼Œå¢åŠ ç«¯å£æ•°é‡</span>
net.core.default_qdisc = fq_codel <span class="hljs-comment"># å¯ç”¨é˜Ÿåˆ—è°ƒåº¦ç®—æ³•ï¼Œå‡å°‘ç½‘ç»œå»¶è¿Ÿ</span>
</code></pre>
<p>é…ç½®ç”Ÿæ•ˆå‘½ä»¤ï¼šsysctl -pï¼ˆç«‹å³ç”Ÿæ•ˆï¼‰ï¼Œæ— éœ€é‡å¯ç³»ç»Ÿã€‚</p>
<h2 data-id="heading-18">äº”ã€å®æˆ˜éªŒè¯ï¼šç™¾ä¸‡å¹¶å‘çš„æ€§èƒ½ç“¶é¢ˆæ’æŸ¥ä¸ä¼˜åŒ–æ•ˆæœ</h2>
<h3 data-id="heading-19">5.1 ä¼˜åŒ–å‰åæ€§èƒ½å¯¹æ¯”ï¼ˆç”Ÿäº§ç¯å¢ƒå®æµ‹ï¼‰</h3>
<p>ä»¥ä¸‹æ˜¯æŸé«˜æµé‡ç”µå•†å¹³å°çš„ Nginx ä¼˜åŒ–å‰åæ€§èƒ½å¯¹æ¯”æ•°æ®ï¼ŒæœåŠ¡å™¨é…ç½®ä¸ºï¼š32 æ ¸ CPUã€64GB å†…å­˜ã€10G ç½‘å¡ï¼Œä¼˜åŒ–åå®ç°å•æœºç™¾ä¸‡çº§ QPS æ‰¿è½½ï¼Œå“åº”æ—¶é—´å¤§å¹…é™ä½ï¼š</p>








































<table><thead><tr><th>ä¼˜åŒ–é˜¶æ®µ</th><th>QPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰</th><th>å“åº”æ—¶é—´ï¼ˆmsï¼‰</th><th>CPU ä½¿ç”¨ç‡</th><th>å†…å­˜ä½¿ç”¨ï¼ˆGBï¼‰</th></tr></thead><tbody><tr><td>é»˜è®¤é…ç½®</td><td>8 ä¸‡</td><td>125</td><td>85%</td><td>2.1</td></tr><tr><td>åŸºç¡€é…ç½®ä¼˜åŒ–</td><td>25 ä¸‡</td><td>45</td><td>68%</td><td>1.8</td></tr><tr><td>æ·±åº¦ä¼˜åŒ–ï¼ˆç¼“å­˜ + å‹ç¼©ï¼‰</td><td>60 ä¸‡</td><td>18</td><td>45%</td><td>1.5</td></tr><tr><td>æé™ä¼˜åŒ–ï¼ˆç³»ç»Ÿ + è¿æ¥æ± ï¼‰</td><td>120 ä¸‡ +</td><td>8</td><td>35%</td><td>1.2</td></tr></tbody></table>
<h3 data-id="heading-20">5.2 å¸¸è§ç“¶é¢ˆæ’æŸ¥æ–¹æ³•</h3>
<p>åœ¨é«˜å¹¶å‘å‹æµ‹æˆ–ç”Ÿäº§è¿è¡Œä¸­ï¼Œè‹¥ Nginx æ— æ³•è¾¾åˆ°é¢„æœŸå¹¶å‘æ€§èƒ½ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ’æŸ¥ç“¶é¢ˆï¼š</p>
<ol>
<li>â€‹<strong>æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—</strong>â€‹ï¼štail -f /var/log/nginx/error.logï¼Œæ’æŸ¥â€œtoo many open filesâ€ï¼ˆæ–‡ä»¶æè¿°ç¬¦ä¸è¶³ï¼‰ã€â€œconnection timed outâ€ï¼ˆè¿æ¥è¶…æ—¶ï¼‰ç­‰é”™è¯¯ã€‚</li>
<li>â€‹<strong>æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨</strong>â€‹ï¼šä½¿ç”¨ topã€mpstat æŸ¥çœ‹ CPU ä½¿ç”¨ç‡ï¼ˆè‹¥å•ä¸ª CPU æ ¸å¿ƒæ»¡è½½ï¼Œå¯èƒ½æ˜¯ Worker è¿›ç¨‹ç»‘å®šä¸å½“ï¼‰ï¼›ä½¿ç”¨ freeã€vmstat æŸ¥çœ‹å†…å­˜ä½¿ç”¨ï¼ˆé¿å…å†…å­˜æº¢å‡ºï¼‰ï¼›ä½¿ç”¨ iftop æŸ¥çœ‹ç½‘ç»œå¸¦å®½ï¼ˆé¿å…å¸¦å®½ç“¶é¢ˆï¼‰ã€‚</li>
<li>â€‹<strong>æŸ¥çœ‹ TCP è¿æ¥çŠ¶æ€</strong>â€‹ï¼šä½¿ç”¨ ss -s æŸ¥çœ‹ TCP è¿æ¥ç»Ÿè®¡ï¼Œé‡ç‚¹å…³æ³¨ TIME_WAIT çŠ¶æ€è¿æ¥æ•°ï¼ˆè‹¥è¿‡å¤šï¼Œéœ€ä¼˜åŒ– tcp_tw_reuse å’Œ tcp_fin_timeoutï¼‰ï¼›ä½¿ç”¨ ss -tulnp | grep nginx æŸ¥çœ‹ Nginx çš„è¿æ¥æƒ…å†µã€‚</li>
<li>â€‹<strong>å‹æµ‹éªŒè¯</strong>â€‹ï¼šä½¿ç”¨ abã€wrkã€jmeter ç­‰å·¥å…·è¿›è¡Œå‹æµ‹ï¼Œæ¨¡æ‹Ÿç™¾ä¸‡å¹¶å‘åœºæ™¯ï¼Œè§‚å¯Ÿ QPSã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡ç­‰æŒ‡æ ‡ï¼Œå®šä½ç“¶é¢ˆç‚¹ï¼ˆå¦‚åç«¯æœåŠ¡ã€ç³»ç»Ÿå‚æ•°ã€Nginx é…ç½®ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-21">å…­ã€æ€»ç»“ï¼šNginx æ‰›ä½ç™¾ä¸‡å¹¶å‘çš„æ ¸å¿ƒé€»è¾‘</h2>
<p>Nginx èƒ½æ‰›ä½ç™¾ä¸‡å¹¶å‘ï¼Œå¹¶éå•ä¸€æŠ€æœ¯çš„åŠŸåŠ³ï¼Œè€Œæ˜¯â€œæ¶æ„è®¾è®¡ + äº‹ä»¶é©±åŠ¨ + é…ç½®ä¼˜åŒ– + ç³»ç»ŸååŒâ€çš„ç»¼åˆç»“æœï¼Œæ ¸å¿ƒé€»è¾‘å¯æ€»ç»“ä¸ºä¸‰ç‚¹ï¼š</p>
<ol>
<li>â€‹<strong>æ¶æ„å±‚é¢</strong>â€‹ï¼šMaster-Worker è¿›ç¨‹æ¨¡å‹ï¼Œåˆ†å·¥æ˜ç¡®ã€ç¨³å®šæ€§é«˜ï¼Œç»“åˆ CPU äº²å’Œæ€§ç»‘å®šï¼Œæœ€å¤§åŒ–åˆ©ç”¨å¤šæ ¸èµ„æºï¼Œå‡å°‘è¿›ç¨‹åˆ‡æ¢å¼€é”€ï¼›</li>
<li>â€‹<strong>æ ¸å¿ƒæœºåˆ¶å±‚é¢</strong>â€‹ï¼šReactor å¼‚æ­¥äº‹ä»¶é©±åŠ¨ +Epoll I/O å¤šè·¯å¤ç”¨ï¼Œå®ç°â€œå•çº¿ç¨‹ç®¡ç†æµ·é‡è¿æ¥â€ï¼Œä»…å¤„ç†æ´»è·ƒè¿æ¥ï¼Œä»æ ¹æºä¸Šçªç ´å¹¶å‘ç“¶é¢ˆï¼›</li>
<li>â€‹<strong>å®æˆ˜å±‚é¢</strong>â€‹ï¼šé€šè¿‡ Nginx æ ¸å¿ƒé…ç½®ä¼˜åŒ–ï¼ˆå¹¶å‘ã€TCPã€ç¼“å­˜ã€è´Ÿè½½å‡è¡¡ï¼‰ï¼Œæå‡è‡ªèº«å¤„ç†æ•ˆç‡ï¼Œå‡å°‘åç«¯å‹åŠ›ï¼›åŒæ—¶ä¼˜åŒ– Linux ç³»ç»Ÿå‚æ•°ï¼Œçªç ´ç³»ç»Ÿç“¶é¢ˆï¼Œä¸º Nginx é«˜å¹¶å‘æä¾›æ”¯æ’‘ã€‚</li>
</ol>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç™¾ä¸‡å¹¶å‘çš„æ‰¿è½½çš„å¹¶éå•æœº Nginx èƒ½ç‹¬ç«‹å®Œæˆçš„ï¼ˆå®é™…ç”Ÿäº§ä¸­ï¼Œé€šå¸¸ä¼šéƒ¨ç½² Nginx é›†ç¾¤ï¼Œç»“åˆ LVSã€Keepalived å®ç°è´Ÿè½½å‡è¡¡å’Œé«˜å¯ç”¨ï¼‰ï¼Œä½†å•æœº Nginx çš„é«˜æ€§èƒ½ï¼Œæ˜¯æ•´ä¸ªé«˜å¹¶å‘æ¶æ„çš„åŸºç¡€ã€‚</p>
<p>éšç€äº’è”ç½‘æµé‡çš„æŒç»­å¢é•¿ï¼ŒNginx ä¹Ÿåœ¨ä¸æ–­è¿›åŒ–ï¼ˆå¦‚æ”¯æŒ HTTP/3ã€QUIC åè®®ï¼Œè¿›ä¸€æ­¥æå‡é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ€§èƒ½ï¼‰ï¼Œä½†æ ¸å¿ƒè®¾è®¡ç†å¿µå§‹ç»ˆæœªå˜â€”â€”â€œç”¨æœ€å°‘çš„èµ„æºï¼Œå¤„ç†æœ€å¤šçš„è¯·æ±‚â€ã€‚æŒæ¡ Nginx çš„åº•å±‚åŸç†å’Œä¼˜åŒ–æ–¹æ³•ï¼Œä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬åº”å¯¹ç™¾ä¸‡å¹¶å‘åœºæ™¯ï¼Œæ›´èƒ½æ·±å…¥ç†è§£é«˜å¹¶å‘æ¶æ„çš„è®¾è®¡æ€è·¯ï¼Œä¸ºæ„å»ºé«˜æ€§èƒ½ã€é«˜å¯ç”¨çš„ç³»ç»Ÿæä¾›æ”¯æ’‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[pythonä¸­å¸¸ç”¨çš„éƒ¨åˆ†å†…å®¹åˆ†äº«]]></title>    <link>https://juejin.cn/post/7602928386595930138</link>    <guid>https://juejin.cn/post/7602928386595930138</guid>    <pubDate>2026-02-05T03:23:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602928386595930138" data-draft-id="7602901565026484233" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="pythonä¸­å¸¸ç”¨çš„éƒ¨åˆ†å†…å®¹åˆ†äº«"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-02-05T03:23:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="snowsnow"/> <meta itemprop="url" content="https://juejin.cn/user/4350092611685976"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            pythonä¸­å¸¸ç”¨çš„éƒ¨åˆ†å†…å®¹åˆ†äº«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4350092611685976/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    snowsnow
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:23:37.000Z" title="Thu Feb 05 2026 03:23:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»53åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Slice notation åˆ‡ç‰‡</h2>
<p>Python çš„åˆ‡ç‰‡è¡¨ç¤ºæ³•</p>
<p>pythonä¸­è®¿é—®åˆ—è¡¨çš„æ–¹å¼è¶…ä¹æƒ³è±¡çš„æ–¹ä¾¿. åŸºäºå®ƒçš„ slice æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„è·å–æˆ‘ä»¬éœ€è¦çš„åˆ—è¡¨å…ƒç´ </p>
<p>å¯¹äºä¸€ä¸ªåŒ…å«å…­ä¸ªå…ƒç´ çš„åˆ—è¡¨, Python çš„ç´¢å¼•ç”¨äºæšä¸¾å…ƒç´ , åˆ‡ç‰‡ç”¨äºæšä¸¾å…ƒç´ ä¹‹é—´çš„é—´éš”</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># @description: list slice notation</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">slice_test</span>():
    a = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>, <span class="hljs-string">"d"</span>, <span class="hljs-string">"e"</span>, <span class="hljs-string">"f"</span>]

    <span class="hljs-built_in">print</span>(
        <span class="hljs-string">f"Index from front(): [<span class="hljs-subst">{a[<span class="hljs-number">0</span>]}</span>, <span class="hljs-subst">{a[<span class="hljs-number">1</span>]}</span>, <span class="hljs-subst">{a[<span class="hljs-number">2</span>]}</span>, <span class="hljs-subst">{a[<span class="hljs-number">3</span>]}</span>, <span class="hljs-subst">{a[<span class="hljs-number">4</span>]}</span>, <span class="hljs-subst">{a[<span class="hljs-number">5</span>]}</span>]"</span>)
    <span class="hljs-built_in">print</span>(
        <span class="hljs-string">f"Index from rear(): [<span class="hljs-subst">{a[-<span class="hljs-number">6</span>]}</span>, <span class="hljs-subst">{a[-<span class="hljs-number">5</span>]}</span>, <span class="hljs-subst">{a[-<span class="hljs-number">4</span>]}</span>, <span class="hljs-subst">{a[-<span class="hljs-number">3</span>]}</span>, <span class="hljs-subst">{a[-<span class="hljs-number">2</span>]}</span>, <span class="hljs-subst">{a[-<span class="hljs-number">1</span>]}</span>]"</span>)

    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-string">"-"</span> * <span class="hljs-number">10</span>}</span> slice from front <span class="hljs-subst">{<span class="hljs-string">"-"</span> * <span class="hljs-number">10</span>}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"a[1:] = <span class="hljs-subst">{a[<span class="hljs-number">1</span>:]}</span>"</span>)  <span class="hljs-comment"># [b, c, d, e, f]</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"a[:1] = <span class="hljs-subst">{a[:<span class="hljs-number">1</span>]}</span>"</span>)  <span class="hljs-comment"># [a]</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"a[::] = <span class="hljs-subst">{a[::]}</span>"</span>)  <span class="hljs-comment"># [a, b, c, d, e, f]</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"a[1:4] = <span class="hljs-subst">{a[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>]}</span>"</span>)  <span class="hljs-comment"># [b, c, d]</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-string">"-"</span> * <span class="hljs-number">10</span>}</span> slice from rear <span class="hljs-subst">{<span class="hljs-string">"-"</span> * <span class="hljs-number">10</span>}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"a[-1:] = <span class="hljs-subst">{a[-<span class="hljs-number">1</span>:]}</span>"</span>)  <span class="hljs-comment"># [f]</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"a[:-1] = <span class="hljs-subst">{a[:-<span class="hljs-number">1</span>]}</span>"</span>)  <span class="hljs-comment"># [a, b, c, d, e]</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"a[::] = <span class="hljs-subst">{a[::]}</span>"</span>)  <span class="hljs-comment"># [a, b, c, d, e, f]</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"a[-5:-1] = <span class="hljs-subst">{a[-<span class="hljs-number">5</span>:-<span class="hljs-number">1</span>]}</span>"</span>)  <span class="hljs-comment"># [b, c, d, e]</span>


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    slice_test()

</code></pre>
<h2 data-id="heading-1">iterator and iterable</h2>
<p>æˆ‘ä»¬å¯èƒ½ä¼šå‘ç°æœ‰äº›å¯¹è±¡å±…ç„¶å¯ä»¥ç›´æ¥ä½¿ç”¨ for è¯­å¥</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]:
    <span class="hljs-built_in">print</span>(element)
<span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>):
    <span class="hljs-built_in">print</span>(element)
<span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> {<span class="hljs-string">'one'</span>:<span class="hljs-number">1</span>, <span class="hljs-string">'two'</span>:<span class="hljs-number">2</span>}:
    <span class="hljs-built_in">print</span>(key)
<span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> <span class="hljs-string">"123"</span>:
    <span class="hljs-built_in">print</span>(char)
<span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">"myfile.txt"</span>):
    <span class="hljs-built_in">print</span>(line, end=<span class="hljs-string">''</span>)
</code></pre>
<p>è¿™ç§è®¿é—®é£æ ¼æ¸…æ™°ã€ç®€æ´åˆæ–¹ä¾¿.</p>
<p>è¿­ä»£å™¨çš„ä½¿ç”¨éå¸¸æ™®éå¹¶ä½¿å¾— Python æˆä¸ºä¸€ä¸ªç»Ÿä¸€çš„æ•´ä½“, æ‰€ä»¥æƒ³è¦å­¦å¥½python, iterator æ˜¯æˆ‘ä»¬å¿…é¡»è¦æŒæ¡çš„ä¸€ä¸ªçŸ¥è¯†</p>
<p>forå¾ªç¯çš„å¹•å, ä¼šå¯¹inçš„å¯¹è±¡è°ƒç”¨å…¶iter()æ–¹æ³•, ä»–è¦æ±‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª å®šä¹‰äº† <code>__next__</code>æ–¹æ³•çš„è¿­ä»£å™¨å¯¹è±¡. ç„¶åfor loopä¼šåŸºäºè¯¥å¯¹è±¡, è°ƒç”¨<code>__next__</code>æ–¹æ³•æ¥é€ä¸€çš„è®¿é—®å®¹å™¨çš„å…ƒç´ .</p>
<p>å½“å…ƒç´ ç”¨å°½æ—¶, <code>__next__()</code> å°†å¼•å‘ <code>StopIteration</code> å¼‚å¸¸æ¥é€šçŸ¥ç»ˆæ­¢ <code>for</code> å¾ªç¯</p>
<p>ä¾‹å¦‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:
    <span class="hljs-string">"""test class"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, lst</span>):
        self.lst = lst
        self._index = <span class="hljs-number">0</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__iter__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> self

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__next__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">if</span> self._index &gt;= <span class="hljs-built_in">len</span>(self.lst):
            <span class="hljs-keyword">raise</span> StopIteration
        tmp = self._index
        self._index = self._index + <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> self.lst[tmp]


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    a = A([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:
        <span class="hljs-built_in">print</span>(i)
</code></pre>
<p><strong>è¯¥å¦‚ä½•ç†è§£ iterator &amp; iterable?</strong></p>
<ul>
<li>iterator: ç®—æ˜¯è·å–æ•°æ®çš„ä¸€ä¸ªå·¥å…·, æ‰€ä»¥ä»–éœ€è¦å®ç°ä¸€ä¸ª<code>__next__</code>æ–¹æ³•, æ¥è·å–æ•°æ®</li>
<li>iterable: ç®—æ˜¯æ•°æ®çš„å®¹å™¨, ä»–å¯ä»¥ä¸çŸ¥é“å¦‚ä½•è·å–æ•°æ®, ä½†æ˜¯ä»–éœ€è¦å¯¹å¤–æä¾›ä¸€ä¸ªè·å–æ•°æ®çš„å¯¹è±¡, ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„<code>iterator</code>å¯¹è±¡, æ‰€ä»¥ä»–éœ€è¦æä¾›<code>__iter__</code>æ–¹æ³•, è¯¥æ–¹æ³•ç”¨äºè·å–iteratorå¯¹è±¡</li>
</ul>
<h2 data-id="heading-2">comprehensions(æ¨å¯¼å¼)</h2>
<h4 data-id="heading-3">æ¦‚è¿°</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2F3%2Freference%2Fexpressions.html%23displays-for-lists-sets-and-dictionaries" target="_blank" title="https://docs.python.org/3/reference/expressions.html#displays-for-lists-sets-and-dictionaries" ref="nofollow noopener noreferrer">docs.python.org/3/referenceâ€¦</a></p>
<p>å¯¹äºæ„é€  list, set æˆ–è€… dictionary, pythonæä¾›äº†ä¸€ç§åä¸º"displays"çš„ç‰¹æ®Šè¯­æ³•. ä»–ä»¬æœ‰å¦‚ä¸‹çš„2ç§å½¢å¼</p>
<ol>
<li>ä¸€ç§æ˜¯<strong>æ˜¾å¼åˆ—å‡º</strong>å®¹å™¨ä¸­çš„å†…å®¹</li>
<li>é€šè¿‡å¯¹ä¸€ä¸ªæ•°æ®é›†è¿›è¡Œå¾ªç¯å’Œè¿‡æ»¤çš„æŒ‡ä»¤æ¥è®¡ç®—å¾—åˆ°, è¿™ç§æˆ‘ä»¬ç§°ä¹‹ä¸ºä¸€ä¸ª æ¨å¯¼å¼(comprehension)</li>
</ol>
<p>æ¨å¯¼å¼çš„è¯­æ³•è§„åˆ™å¦‚ä¸‹</p>
<pre><code class="hljs language-plain" lang="plain">comprehension ::= assignment_expression comp_for
comp_for      ::= ["async"] "for" target_list "in" or_test [comp_iter]
comp_iter     ::= comp_for | comp_if
comp_if       ::= "if" or_test [comp_iter]
</code></pre>
<p>æ¨å¯¼å¼è¡¨ç¤ºä¸€ä¸ªè¡¨è¾¾å¼åé¢è·Ÿä¸Šä¸€ä¸ª<code>for</code> è¯­å¥å³å¯, å¹¶å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ª for æˆ– if å­å¥. åœ¨è¿™ç§æƒ…å†µä¸‹, æ–°å®¹å™¨ä¸­çš„å…ƒç´ æ˜¯é€šè¿‡å°†æ¯ä¸ª for æˆ– if å­å¥è§†ä¸ºä¸€ä¸ªåµŒå¥—çš„ä»£ç å—, ä»å·¦åˆ°å³ä¾æ¬¡åµŒå¥—æ‰§è¡Œ, å¹¶åœ¨æ¯æ¬¡åˆ°è¾¾æœ€å†…å±‚çš„ä»£ç å—æ—¶è®¡ç®—è¯¥è¡¨è¾¾å¼æ¥ç”Ÿæˆçš„</p>
<p>æœ€å·¦ä¾§ <code>for</code> ä¸­çš„å¯è¿­ä»£è¡¨è¾¾å¼æ˜¯åœ¨<strong>å¤–éƒ¨ä½œç”¨åŸŸä¸­ç›´æ¥æ±‚å€¼</strong>çš„, ç„¶åä½œä¸ºå‚æ•°ä¼ é€’ç»™åç»­çš„for / ifè¯­å¥.</p>
<p><strong>æ³¨æ„æ„é€ çš„æ˜¯list, set, dic å–å†³äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç±»å‹çš„æ¨å¯¼å¼</strong></p>
<h5 data-id="heading-4">åˆ—è¡¨æ¨å¯¼å¼</h5>
<p>åˆ—è¡¨æ˜¾ç¤ºæ˜¯ä¸€ä¸ªç”¨æ–¹æ‹¬å·æ‹¬èµ·æ¥çš„å¯èƒ½ä¸ºç©ºçš„è¡¨è¾¾å¼ç³»åˆ—</p>
<pre><code class="hljs language-python" lang="python">list_display ::= <span class="hljs-string">"["</span> comprehension<span class="hljs-string">"]"</span>
</code></pre>
<p><code>[]</code>æ˜¾ç¤ºä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„åˆ—è¡¨å¯¹è±¡, å…¶å†…å®¹é€šè¿‡ä¸€ç³»åˆ—è¡¨è¾¾å¼æˆ–ä¸€ä¸ªæ¨å¯¼å¼æ¥æŒ‡å®š.  <strong>å½“æä¾›ä¸€ä¸ªæ¨å¯¼å¼æ—¶, åˆ—è¡¨ä¼šæ ¹æ®æ¨å¯¼å¼æ‰€äº§ç”Ÿçš„ç»“æœå…ƒç´ è¿›è¡Œæ„å»º, ç›¸å½“äºæŠŠæ¨å¯¼å¼ç”Ÿæˆçš„ç»“æœ, ä¸€ä¸ªä¸€ä¸ªçš„æ”¾å…¥åˆ—è¡¨å¯¹è±¡ä¸­</strong></p>
<p>ä¾‹å¦‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">list_comprehension</span>():
    <span class="hljs-string">"""åˆ—è¡¨æ¨å¯¼å¼çš„æµ‹è¯•"""</span>
    lst = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]
    squares = [i ** <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lst]
    <span class="hljs-built_in">print</span>(squares)
</code></pre>
<ul>
<li>åµŒå¥—çš„åˆ—è¡¨æ¨å¯¼å¼</li>
</ul>
<p>åˆ—è¡¨æ¨å¯¼å¼ä¸­çš„åˆå§‹è¡¨è¾¾å¼å¯ä»¥æ˜¯ä»»ä½•è¡¨è¾¾å¼, ç”šè‡³å¯ä»¥æ˜¯å¦ä¸€ä¸ªåˆ—è¡¨æ¨å¯¼å¼</p>
<p>å†…éƒ¨çš„åˆ—è¡¨æ¨å¯¼å¼æ˜¯åœ¨å®ƒä¹‹åçš„ for çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ±‚å€¼çš„</p>
<p>åˆå§‹è¡¨è¾¾å¼ä½œä¸ºä¸€ä¸ªæ•´ä½“åœ¨åç»­çš„forå­å¥ä¸­è¿›è¡Œå¤„ç†</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">example03</span>():
    matrix = [
        [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],
        [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>],
        [<span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>],
    ]

    <span class="hljs-comment"># æˆ‘ä»¬å°è¯•è¿›è¡Œè¡Œåˆ—è½¬æ¢</span>
    res = []
    tmp = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):
        <span class="hljs-keyword">for</span> it <span class="hljs-keyword">in</span> matrix:
            tmp.append(it[i])

        res.append(<span class="hljs-built_in">tuple</span>(tmp))
        tmp.clear()
    <span class="hljs-built_in">print</span>(res)
    res.clear()

    <span class="hljs-comment"># é€šè¿‡åˆ—è¡¨æ¨å¯¼å¼è¿›è¡Œå¤„ç†</span>
    <span class="hljs-comment"># å†…éƒ¨çš„åˆ—è¡¨æ¨å¯¼å¼æ˜¯åœ¨å®ƒä¹‹åçš„ for çš„ä¸Šä¸‹æ–‡ä¸­è¢«æ±‚å€¼çš„</span>
    res = [[item[i] <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> matrix] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]
    <span class="hljs-built_in">print</span>(res)
</code></pre>
<blockquote>
<p>[!note]</p>
<p>è¿™æ ·çš„ä»£ç æˆ–è®¸å¹¶ä¸æ˜¯ç‰¹åˆ«å®¹æ˜“é˜…è¯», æ‰€ä»¥å¦‚æœæ˜¯å¤šäººå¼€å‘, è€ƒè™‘å¯è¯»æ€§, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨zipå‡½æ•°</p>
</blockquote>
<pre><code class="hljs language-python" lang="python">res = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">zip</span>(*matrix))
</code></pre>
<h5 data-id="heading-5">é›†åˆæ¨å¯¼å¼</h5>
<p>é›†åˆæ˜¾ç¤ºæ˜¯ç”¨èŠ±æ‹¬å·æ ‡æ˜çš„, ä¸å­—å…¸æ˜¾ç¤ºçš„åŒºåˆ«åœ¨äºæ²¡æœ‰å†’å·åˆ†éš”çš„é”®å’Œå€¼</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_comprehension</span>():
    <span class="hljs-string">"""é›†åˆæ¨å¯¼å¼çš„æµ‹è¯•"""</span>
    <span class="hljs-comment"># setä¼šå»é‡</span>
    s = {<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>}
    squares = [i ** <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s]
    <span class="hljs-built_in">print</span>(squares)
</code></pre>
<h5 data-id="heading-6">å­—å…¸æ¨å¯¼å¼</h5>
<p>å­—å…¸æ˜¾ç¤ºæ˜¯ä¸€ä¸ªç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥çš„å¯èƒ½ä¸ºç©ºçš„å­—å…¸æ¡ç›®ï¼ˆé”®/å€¼å¯¹ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">dict_comprehension</span>():
    <span class="hljs-string">"""å­—å…¸æ¨å¯¼å¼"""</span>
    d = {<span class="hljs-string">"name"</span>: <span class="hljs-string">"alice"</span>, <span class="hljs-string">"age"</span>: <span class="hljs-number">28</span>}
    name_info = {k: v <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> d.items() <span class="hljs-keyword">if</span> k == <span class="hljs-string">"name"</span>}
    <span class="hljs-built_in">print</span>(name_info)

    <span class="hljs-comment"># å°†ä¸¤ä¸ªåˆ—è¡¨åˆå¹¶ä¸ºå­—å…¸</span>
    keys = [<span class="hljs-string">'å­™ç‡•å§¿'</span>, <span class="hljs-string">'å‘¨æ°ä¼¦'</span>, <span class="hljs-string">'æ–¹å¤§åŒ'</span>]
    values = [<span class="hljs-string">"æˆ‘æ€€å¿µçš„"</span>, <span class="hljs-string">"å›åˆ°è¿‡å»"</span>, <span class="hljs-string">"Love Song"</span>]
    songs = {name: song <span class="hljs-keyword">for</span> name, song <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(keys, values)}
    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> songs.items():
        <span class="hljs-built_in">print</span>(item)
</code></pre>
<ul>
<li>äºŒç»´å­—å…¸æ¨å¯¼å¼</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># äºŒç»´å­—å…¸æ¨å¯¼å¼</span>
matrix = {
    row: {col: row * col <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>( <span class="hljs-number">1</span>, <span class="hljs-number">6</span>)}
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)
}
<span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> matrix.items():
    <span class="hljs-built_in">print</span>(item)
    
<span class="hljs-string">"""
è¾“å‡º
(0, {1: 0, 2: 0, 3: 0, 4: 0, 5: 0})
(1, {1: 1, 2: 2, 3: 3, 4: 4, 5: 5})
(2, {1: 2, 2: 4, 3: 6, 4: 8, 5: 10})
"""</span>
</code></pre>
<p>åˆè¯†æ±‚å€¼çš„è¡¨è¾¾å¼æ€»æ˜¯ä¼šæ”¾åœ¨åç»­è¡¨è¾¾å¼ä¸­è¿›è¡Œæ‰§è¡Œ.</p>
<p>ä¹Ÿå¸¸ç”¨è¿™äº›å¤„ç†</p>
<p>ç±»åˆ«æ ‡ç­¾ç¼–ç </p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">print_dict</span>(<span class="hljs-params">src: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]</span>):
    <span class="hljs-string">"""keyå¯¹é½çš„æ–¹å¼æ‰“å°å­—å…¸æ•°æ®"""</span>
    max_len = <span class="hljs-built_in">max</span>(<span class="hljs-built_in">len</span>(k) <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> src.keys())
    <span class="hljs-built_in">print</span>(max_len)

    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{k.rjust(max_len, <span class="hljs-string">' '</span>)}</span>: <span class="hljs-subst">{v}</span>"</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">dict_comperhension_demo</span>():
    <span class="hljs-string">"""ç±»åˆ«æ ‡ç­¾ç¼–ç å°æ¡ˆä¾‹"""</span>
    labels = [<span class="hljs-string">'cat'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'bird'</span>, <span class="hljs-string">'cat'</span>, <span class="hljs-string">'bird'</span>]
    unique_labels = <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">set</span>(labels))
    <span class="hljs-comment"># è·å–labelå¯¹åº”çš„ç¼–ç , è¿™é‡Œä»¥ç´¢å¼•ä¸ºä¾‹</span>
    label_to_id = {
        label: <span class="hljs-built_in">id</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">id</span>, label <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(unique_labels)
    }
    print_dict(label_to_id)

    <span class="hljs-comment"># å¯¹labels è¿›è¡Œencode</span>
    encoded = [label_to_id[item] <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> labels]
    <span class="hljs-built_in">print</span>(encoded)
    
<span class="hljs-string">"""
è¾“å‡º
bird: 0
 cat: 1
 dog: 2
[1, 2, 0, 1, 0]
"""</span>
</code></pre>
<h2 data-id="heading-7">è£…é¥°å™¨</h2>
<p>åœ¨ python çš„ä¸–ç•Œ<strong>è£…é¥°å™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚</strong></p>
<p>è€Œè£…é¥°å™¨çš„æ ¸å¿ƒä½œç”¨ï¼šåœ¨ä¸ä¿®æ”¹åŸå‡½æ•°ä»£ç çš„æƒ…å†µä¸‹ï¼Œä¸ºå‡½æ•°æ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä¸€ç§å‡½æ•°è°ƒç”¨çš„è¯­æ³•ç³–ï¼Œå°±åƒè¿™æ ·</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@decorator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():
    <span class="hljs-keyword">pass</span>

<span class="hljs-comment"># ç­‰ä»·äº</span>
func = decorator(func)
</code></pre>
<p>æˆ‘ä»¬æœ‰æ—¶ä¹Ÿå¯èƒ½çœ‹è§è¿™æ ·çš„å†™æ³•</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@decorator()  </span><span class="hljs-comment"># æ³¨æ„ï¼Œåœ¨è£…é¥°å™¨åé¢åŠ ä¸Šäº† ()</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():
    <span class="hljs-keyword">pass</span>

<span class="hljs-comment"># ç­‰ä»·äº</span>
res = decorator()
func = res(func)
</code></pre>
<p>å› ä¸ºåœ¨Pythonä¸­ï¼Œå‡½æ•°å¯ä»¥åƒæ™®é€šå˜é‡ä¸€æ ·è¢«ä¼ é€’å’Œä½¿ç”¨ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬æœ‰æ—¶è¯´å‡½æ•°æ˜¯â€œä¸€ç­‰å…¬æ°‘â€</p>
<h3 data-id="heading-8">å¿«é€Ÿå…¥é—¨</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_decorator</span>(<span class="hljs-params">func</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):  <span class="hljs-comment"># æ¥æ”¶ä»»æ„å‚æ•°</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è°ƒç”¨å‡½æ•°: <span class="hljs-subst">{func.__name__}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‚æ•°: args=<span class="hljs-subst">{args}</span>, kwargs=<span class="hljs-subst">{kwargs}</span>"</span>)
        result = func(*args, **kwargs)  <span class="hljs-comment"># è°ƒç”¨åŸå‡½æ•°å¹¶è·å–è¿”å›å€¼</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¿”å›å€¼: <span class="hljs-subst">{result}</span>"</span>)
        <span class="hljs-keyword">return</span> result

    <span class="hljs-keyword">return</span> wrapper


<span class="hljs-meta">@my_decorator  </span><span class="hljs-comment"># ç­‰åŒäº add = my_decorator(add)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x, y</span>):
    <span class="hljs-keyword">return</span> x + y


result = add(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>)
<span class="hljs-built_in">print</span>(add.__name__)  <span class="hljs-comment"># è¾“å‡ºï¼šwrapper</span>
</code></pre>
<p>æˆ‘ä»¬è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªè£…é¥°å™¨ï¼Œè¿™ä¸ªè£…é¥°å™¨çš„åŠŸèƒ½å°±æ˜¯åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œè¿›è¡Œä¸€äº›æ—¥å¿—çš„è¾“å‡ºï¼Œå¦‚æœæˆ‘ä»¬æ„¿æ„ï¼Œä¹Ÿå¯ä»¥å°†è¿™é‡Œçš„æ—¥å¿—è¾“å‡ºæ”¹ä¸ºå¯¹åº”çš„ä¸€äº›èµ„æºåˆå§‹åŒ–æˆ–è€…æ¸…ç†çš„æ“ä½œ</p>
<p>ä½†è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¢«è£…é¥°å‡½æ•°çš„å…ƒæ•°æ®å‘ç”Ÿäº†æ”¹å˜ï¼Œä¹Ÿå°±æ˜¯è¿™è¡Œç¨‹åºçš„è¾“å‡ºæœ‰äº›ä¸å¦‚é¢„æœŸï¼Œå½“ç„¶æˆ‘ä»¬æ˜ç™½ä¸ºä½•è¿™æ · <code>print(add.__name__)  # è¾“å‡ºï¼šwrapper</code></p>
<p>è€Œä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº› python å®˜æ–¹æä¾›çš„å‡½æ•°å·¥å…·</p>
<h3 data-id="heading-9">functools çš„ä½¿ç”¨</h3>
<p>å…³äº functools çš„æ›´å¤šè¯´æ˜ï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2F3%2Flibrary%2Ffunctools.html" target="_blank" title="https://docs.python.org/3/library/functools.html" ref="nofollow noopener noreferrer">docs.python.org/3/library/fâ€¦</a></p>
<p>è£…é¥°å™¨çš„ PEP çš„æå‡ºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpeps.python.org%2Fpep-0318%2F" target="_blank" title="https://peps.python.org/pep-0318/" ref="nofollow noopener noreferrer">peps.python.org/pep-0318/</a></p>
<h5 data-id="heading-10">wraps</h5>
<h4 data-id="heading-11">å¿«é€Ÿå…¥é—¨</h4>
<p><code>functools.wraps</code>è£…é¥°å™¨çš„ä½¿ç”¨</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> wraps


<span class="hljs-keyword">def</span> <span class="hljs-title function_">my_decorator</span>(<span class="hljs-params">func</span>):
<span class="hljs-meta">    @wraps(<span class="hljs-params">func</span>)  </span><span class="hljs-comment"># è¿™æ˜¯æ¶‰åŠå‡½æ•°çš„å¤šæ¬¡åµŒå¥—ï¼šé¦–å…ˆæ˜¯ wraps(func) è¿›è¡Œè°ƒç”¨ï¼Œç„¶åè¿”å›äº†ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œç„¶åè¯¥å‡½æ•°å¯¹è±¡å¯¹æˆ‘ä»¬è¿™é‡Œå®šä¹‰çš„ wrapper å‡½æ•°è¿›è¡Œè£…é¥°ï¼Œæ‰€ä»¥wrapperæœ€åå˜æˆäº†è¢«è£…é¥°åçš„å‡½æ•°ã€‚</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è°ƒç”¨å‡½æ•°: <span class="hljs-subst">{func.__name__}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‚æ•°: args=<span class="hljs-subst">{args}</span>, kwargs=<span class="hljs-subst">{kwargs}</span>"</span>)
        result = func(*args, **kwargs)  <span class="hljs-comment"># è°ƒç”¨åŸå‡½æ•°å¹¶è·å–è¿”å›å€¼</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¿”å›å€¼: <span class="hljs-subst">{result}</span>"</span>)
        <span class="hljs-keyword">return</span> result

    <span class="hljs-keyword">return</span> wrapper


<span class="hljs-meta">@my_decorator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x, y</span>):
    <span class="hljs-keyword">return</span> x + y


add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
<span class="hljs-built_in">print</span>(add.__name__)  <span class="hljs-comment"># è¾“å‡º add</span>
</code></pre>
<p>ä¸ºä½•éœ€è¦è¯¥å·¥å…·ï¼Ÿ</p>
<p>æƒ³è±¡ä¸€äº›åœºæ™¯ï¼š</p>
<ul>
<li>è°ƒè¯•åœºæ™¯ï¼Œæˆ‘ä»¬é‡åˆ°ä¸€äº›é”™è¯¯æ—¥å¿—ï¼Œä½†æ˜¯è¿™äº›é”™è¯¯çš„å †æ ˆè·Ÿè¸ªæ˜¾ç¤ºçš„éƒ½æ˜¯  wrapperï¼Œæˆ‘ä»¬æˆ–è®¸å¾ˆéš¾å®šä½åˆ°å…·ä½“çš„é”™è¯¯ä¿¡æ¯</li>
<li>python ä¸­å¾ˆå¤šçš„æ¨¡å—ä¸ºäº†ç®€åŒ–ä»£ç çš„ç¼–å†™ï¼Œæˆ‘ä»¬å¯ä»¥é»˜è®¤ä½¿ç”¨å‡½æ•°çš„ doc ä½œä¸ºä¸€äº›å‚æ•°çš„é»˜è®¤èµ‹å€¼ï¼Œä½¿ç”¨äº†è£…é¥°å™¨ä¹‹åï¼Œæˆ‘ä»¬å°†ä¸¢å¤±è¯¥å†…å®¹</li>
<li>åœ¨ä¸€äº›é«˜çº§å¼€å‘ä¸­ï¼Œå¯èƒ½éœ€è¦å¯¹æˆ‘ä»¬çš„å‡½æ•°è¿›è¡Œåå°„ï¼Œè¿™æ—¶å€™æ¡†æ¶åœ¨è·å–è·å–å‡½æ•°ç­¾åæ—¶éœ€è¦æ­£ç¡®çš„å…ƒæ•°æ®ï¼Œä½†æˆ‘ä»¬æ­¤æ—¶ä¸¢å¤±äº†å‡½æ•°åŸæœ¬çš„å…ƒæ•°æ®</li>
</ul>
<p><strong>æ‰€ä»¥æ¯”è¾ƒ pythonic çš„åšæ³•æ˜¯å§‹ç»ˆåœ¨è£…é¥°å™¨ä¸­ä½¿ç”¨ @wraps(func)</strong></p>
<h5 data-id="heading-12">æ¢ç©¶</h5>
<p>functools.wraps çš„æºç åˆ†æ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">wraps</span>(<span class="hljs-params">wrapped,
          assigned = WRAPPER_ASSIGNMENTS,
          updated = WRAPPER_UPDATES</span>):
    <span class="hljs-string">"""Decorator factory to apply update_wrapper() to a wrapper function

       Returns a decorator that invokes update_wrapper() with the decorated
       function as the wrapper argument and the arguments to wraps() as the
       remaining arguments. Default arguments are as for update_wrapper().
       This is a convenience function to simplify applying partial() to
       update_wrapper().

    wraps æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª è£…é¥°å™¨å·¥å‚
    
    """</span>
    <span class="hljs-keyword">return</span> partial(update_wrapper, wrapped=wrapped,
                   assigned=assigned, updated=updated)



</code></pre>
<p>å‚æ•° è¯´æ˜</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># éœ€è¦ä»åŸå‡½æ•°ç›´æ¥å¤åˆ¶çš„å±æ€§</span>
WRAPPER_ASSIGNMENTS = (<span class="hljs-string">'__module__'</span>, <span class="hljs-string">'__name__'</span>, <span class="hljs-string">'__qualname__'</span>, <span class="hljs-string">'__doc__'</span>,
                       <span class="hljs-string">'__annotations__'</span>, <span class="hljs-string">'__type_params__'</span>)
<span class="hljs-comment"># éœ€è¦æ›´æ–° / åˆå¹¶ çš„å±æ€§</span>
WRAPPER_UPDATES = (<span class="hljs-string">'__dict__'</span>,)
</code></pre>
<p>æ›´æ–°å‡½æ•° update_wrapper</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">update_wrapper</span>(<span class="hljs-params">wrapper,
                   wrapped,
                   assigned = WRAPPER_ASSIGNMENTS,
                   updated = WRAPPER_UPDATES</span>):
    <span class="hljs-string">"""Update a wrapper function to look like the wrapped function

       wrapper is the function to be updated
       wrapped is the original function
       assigned is a tuple naming the attributes assigned directly
       from the wrapped function to the wrapper function (defaults to
       functools.WRAPPER_ASSIGNMENTS)
       updated is a tuple naming the attributes of the wrapper that
       are updated with the corresponding attribute from the wrapped
       function (defaults to functools.WRAPPER_UPDATES)
    """</span>
    <span class="hljs-comment"># éå†éœ€è¦å¤åˆ¶å±æ€§</span>
    <span class="hljs-keyword">for</span> attr <span class="hljs-keyword">in</span> assigned:
        <span class="hljs-keyword">try</span>:
            value = <span class="hljs-built_in">getattr</span>(wrapped, attr)  <span class="hljs-comment"># ä»åŸå‡½æ•°è·å–å±æ€§</span>
        <span class="hljs-keyword">except</span> AttributeError:
            <span class="hljs-keyword">pass</span>  <span class="hljs-comment"># å¦‚æœåŸå‡½æ•°è¯¥å±æ€§ä¸å­˜åœ¨ï¼Œè·³è¿‡</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">setattr</span>(wrapper, attr, value)  <span class="hljs-comment"># è®¾ç½®åˆ°åŒ…è£…å™¨å‡½æ•°</span>
            
    <span class="hljs-keyword">for</span> attr <span class="hljs-keyword">in</span> updated:  <span class="hljs-comment"># æ›´æ–° __dict__</span>
        <span class="hljs-built_in">getattr</span>(wrapper, attr).update(<span class="hljs-built_in">getattr</span>(wrapped, attr, {}))

    <span class="hljs-comment"># è®¾ç½® __wrapped__ å±æ€§ï¼ˆæŒ‡å‘åŸå‡½æ•°ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡ func.__wrapped__ è®¿é—®åŸå‡½æ•°</span>
    wrapper.__wrapped__ = wrapped
   
    <span class="hljs-keyword">return</span> wrapper
</code></pre>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥åˆ†æ <code>functools.wraps</code>ç¬¬ä¸€æ­¥çš„æ“ä½œäº†</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@wraps(<span class="hljs-params">func</span>) </span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        ...

<span class="hljs-comment"># è·å–wrapså‡½æ•°çš„è¿”å›å€¼</span>
tmp = partial(update_wrapper, wrapped=func, assigned=assigned, updated=updated)

<span class="hljs-comment"># é€šè¿‡è¯¥å¯¹è±¡å¯¹æˆ‘ä»¬è‡ªå®šä¹‰çš„wrapperè¿›è¡Œè£…é¥°</span>
wrapper = tmp(wrapper)  <span class="hljs-comment"># ç›¸å½“äºè°ƒç”¨ partial ç±»çš„ __call__ æ–¹æ³•</span>

<span class="hljs-comment"># partial ç±»çš„ __call__ æ–¹æ³• ä¼šè¿”å› update_wrapper æ‰§è¡Œç»“æœ</span>
wrapper = update_wrapper(wrapper, func, WRAPPER_ASSIGNMENTS, WRAPPER_UPDATES)

<span class="hljs-comment"># äºæ˜¯æˆ‘ä»¬çš„wrapperçš„å…ƒæ•°æ®å°±è¢«æŒ‡å‘åˆ°äº† func(wrapped) çš„å†…å®¹ä¸­äº†</span>
</code></pre>
<p>partial æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯ä¸€ä¸ªç±»ï¼Œä½†æ˜¯å®ç°äº† <code>__call__</code>æ‰€ä»¥å¯ä»¥å½“æˆå‡½æ•°ï¼Œè¿™é‡Œå¯ä»¥å½“æˆæ˜¯ä¸€ä¸ª çº¯å‡½æ•°</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Purely functional, no descriptor behaviour</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">partial</span>:
    <span class="hljs-string">"""New function with partial application of the given arguments
    and keywords.
    """</span>

    <span class="hljs-comment"># é™åˆ¶å®ä¾‹åªèƒ½æ‹¥æœ‰è¿™äº›å±æ€§ï¼Œä¸ä½¿ç”¨é»˜è®¤çš„ __dict__</span>
    <span class="hljs-comment"># å¦‚æœä¸ä½¿ç”¨ __slots__ï¼Œåˆ™æ¯ä¸ªå®ä¾‹éƒ½æœ‰ä¸€ä¸ª __dict__ å­—å…¸ï¼Œå ç”¨æ›´å¤šå†…å­˜</span>
    
    __slots__ = <span class="hljs-string">"func"</span>, <span class="hljs-string">"args"</span>, <span class="hljs-string">"keywords"</span>, <span class="hljs-string">"__dict__"</span>, <span class="hljs-string">"__weakref__"</span>

    <span class="hljs-comment"># funcä¸€å®šè¦æ³¨æ„ï¼Œå®ƒæ˜¯æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„update_wrapperå‡½æ•°å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è´Ÿè´£å¯¹åŸæœ‰çš„addè¿™æ ·çš„å‡½æ•°çš„å…ƒæ•°æ®è¿›è¡Œç»´æŠ¤</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, func, /, *args, **keywords</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">callable</span>(func):
            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">"the first argument must be callable"</span>)

        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(func, <span class="hljs-string">"func"</span>):  <span class="hljs-comment"># å¦‚æœ func æœ¬èº«å°±æ˜¯ä¸€ä¸ª partial å¯¹è±¡ï¼Œåˆå¹¶å®ƒçš„å‚æ•°</span>
            args = func.args + args
            keywords = {**func.keywords, **keywords}
            func = func.func

        self = <span class="hljs-built_in">super</span>(partial, cls).__new__(cls)

        self.func = func  <span class="hljs-comment"># ç»´æŠ¤çš„åŸå§‹å‡½æ•°</span>
        self.args = args  <span class="hljs-comment"># ç»´æŠ¤çš„å‡½æ•°å‚æ•°</span>
        self.keywords = keywords
        <span class="hljs-keyword">return</span> self

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, /, *args, **keywords</span>):
        keywords = {**self.keywords, **keywords}
        <span class="hljs-keyword">return</span> self.func(*self.args, *args, **keywords)  <span class="hljs-comment"># è°ƒç”¨çš„æ—¶å€™ï¼Œå±•å¼€å‚æ•°</span>

    ...

    __class_getitem__ = <span class="hljs-built_in">classmethod</span>(GenericAlias)
</code></pre>
<p>å…³äº <code>__slots__</code>çš„åŠŸèƒ½</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¸ä½¿ç”¨ __slots__ çš„æ™®é€šç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NormalClass</span>:
    <span class="hljs-keyword">pass</span>

<span class="hljs-comment"># æ¯ä¸ªå®ä¾‹éƒ½æœ‰ä¸€ä¸ª __dict__ å­—å…¸ï¼Œå ç”¨æ›´å¤šå†…å­˜</span>
obj = NormalClass()
obj.a = <span class="hljs-number">1</span>
obj.b = <span class="hljs-number">2</span>  <span class="hljs-comment"># å¯ä»¥éšæ„æ·»åŠ å±æ€§</span>

<span class="hljs-comment"># ä½¿ç”¨ __slots__ çš„ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OptimizedClass</span>:
    __slots__ = (<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>)

obj = OptimizedClass()
obj.a = <span class="hljs-number">1</span>
obj.b = <span class="hljs-number">2</span>
<span class="hljs-comment"># obj.c = 3  # æŠ¥é”™ï¼æ— æ³•æ·»åŠ æœªå£°æ˜çš„å±æ€§</span>
</code></pre>
<p>å…³äº<code>__new__</code>çš„åŠŸèƒ½</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> partial

<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b, c, d</span>):
    <span class="hljs-keyword">return</span> a + b + c + d

<span class="hljs-comment"># é“¾å¼ partial</span>
step1 = partial(add, <span class="hljs-number">1</span>)           <span class="hljs-comment"># ç»‘å®š a=1</span>
step2 = partial(step1, <span class="hljs-number">2</span>)         <span class="hljs-comment"># ç»‘å®š b=2</span>
step3 = partial(step2, <span class="hljs-number">3</span>)         <span class="hljs-comment"># ç»‘å®š c=3</span>

<span class="hljs-comment"># ä¸åšä¼˜åŒ–çš„è¯ï¼Œä¼šå½¢æˆåµŒå¥—è°ƒç”¨ï¼š</span>
<span class="hljs-comment"># step3(4) -&gt; step2(3, 4) -&gt; step1(2, 3, 4) -&gt; add(1, 2, 3, 4)</span>

<span class="hljs-comment"># ä½†é€šè¿‡ __new__ çš„ä¼˜åŒ–ï¼Œç›´æ¥å±•å¹³ä¸ºï¼š</span>
<span class="hljs-comment"># step3.func = add (åŸå§‹å‡½æ•°)</span>
<span class="hljs-comment"># step3.args = (1, 2, 3) (æ‰€æœ‰ç»‘å®šçš„å‚æ•°) å› ä¸ºä¼šåˆ¤æ–­å½“å‰çš„partialçš„å‚æ•°æ˜¯ä¸æ˜¯å…·æœ‰funcå±æ€§ï¼Œæœ‰äº†çš„è¯ï¼Œç›´æ¥å‚æ•°åˆå¹¶ï¼Œé¿å…æŠŠåŸå…ˆçš„funcè¿›è¡Œèµ‹å€¼ä¼ é€’</span>
<span class="hljs-comment"># step3(4) -&gt; add(1, 2, 3, 4) åªè°ƒç”¨ä¸€æ¬¡ï¼</span>
</code></pre>
<p>è¿™é‡Œ python çš„å®˜æ–¹ä½¿ç”¨ partial ä½œä¸ºè¿”å›å€¼ç±»å‹ï¼Œäº‹å®ä¸Šæˆ‘ä»¬å¯ä»¥ä¸ç”¨è¿”å›è¯¥ç±»å‹ä¹Ÿå¯ä»¥å®ç°</p>
<h5 data-id="heading-13">è‡ªå®šä¹‰ wraps</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_wraps</span>(<span class="hljs-params">func</span>):  <span class="hljs-comment"># æ¥å— wrapped</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">wrapper</span>):  <span class="hljs-comment"># æ¥å—wrapper</span>
        <span class="hljs-string">"""ç¯¡æ”¹wrapperçš„å…ƒæ•°æ®åªæƒ³"""</span>
        wrapper.__name__ = func.__name__
        wrapper.__doc__ = func.__doc__
        wrapper.__module__ = func.__module__
        wrapper.__wrapped__ = func

        <span class="hljs-keyword">return</span> wrapper

    <span class="hljs-keyword">return</span> decorator


<span class="hljs-keyword">def</span> <span class="hljs-title function_">my_decorator</span>(<span class="hljs-params">func</span>):
<span class="hljs-meta">    @my_wraps(<span class="hljs-params">func</span>)</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è°ƒç”¨å‡½æ•°: <span class="hljs-subst">{func.__name__}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‚æ•°: args=<span class="hljs-subst">{args}</span>, kwargs=<span class="hljs-subst">{kwargs}</span>"</span>)
        result = func(*args, **kwargs)  <span class="hljs-comment"># è°ƒç”¨åŸå‡½æ•°å¹¶è·å–è¿”å›å€¼</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¿”å›å€¼: <span class="hljs-subst">{result}</span>"</span>)
        <span class="hljs-keyword">return</span> result

    <span class="hljs-keyword">return</span> wrapper


<span class="hljs-meta">@my_decorator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x, y</span>):
    <span class="hljs-keyword">return</span> x + y


add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
<span class="hljs-built_in">print</span>(add.__name__)  <span class="hljs-comment"># add</span>
</code></pre>
<p>æˆ‘ä»¬è¿™é‡Œ my_wraps æ–¹æ³•å†…éƒ¨çš„ <code>decorator</code>å°±å¯ä»¥ç­‰åŒäºä¹‹å‰<code>functools.wraps</code>çš„è¿”å›çš„ partial</p>
<p>å¯ä»¥å‘ç°æˆ‘ä»¬è‡ªå®šä¹‰çš„ç¨‹åºå¯èƒ½æ¯”å®˜æ–¹æºç æ›´åŠ å®¹æ˜“ç†è§£ä¸€ä¸‹ï¼Œä½†æ˜¯è¿™ä¸ªç¨‹åºå´ä¸å¦‚å®˜æ–¹çš„ç¨‹åºé‚£ä¹ˆé€šç”¨ï¼Œå­˜åœ¨å¦‚ä¸‹çš„ä¸€äº›ç¼ºé™·</p>
<ol>
<li>å‚æ•°çš„çµæ´»</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è‡ªå®šä¹‰çš„å®ç°</span>
<span class="hljs-meta">@my_wraps(<span class="hljs-params">func</span>)  </span><span class="hljs-comment"># å›ºå®šå¤åˆ¶ __name__, __doc__, __module__, __wrapped__</span>

<span class="hljs-comment"># å®˜æ–¹å®ç°ï¼šæ ¹æ®éœ€æ±‚è®¾ç½®</span>
<span class="hljs-meta">@wraps(<span class="hljs-params">func, assigned=(<span class="hljs-params"><span class="hljs-string">'__name__'</span>,</span>), updated=(<span class="hljs-params"/>)</span>)  </span><span class="hljs-comment"># åªå¤åˆ¶ __name__</span>
</code></pre>
<p>ä¸è¿‡è¿™é‡Œä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå…¶å® wraps ä¸­çš„æ ¸å¿ƒåœ¨äº update_wrapper çš„åŠŸèƒ½ï¼Œè€Œä¸æ˜¯ partialï¼Œä½† partial çš„å¥½å¤„åœ¨äºå®ƒç»´æŠ¤äº† wrapped çš„å¼•ç”¨ã€‚</p>
<h5 data-id="heading-14">ç†è§£ wraps çš„ç”¨å¤„</h5>
<p>æˆ‘ä»¬çŸ¥é“<code>functools.wraps</code>çš„åº•å±‚é€šè¿‡å‚æ•°æ§åˆ¶è¦æ‹·è´çš„åˆå§‹åŒ–å‚æ•°ï¼Œé‚£æˆ‘ä»¬å…¶å®å¯ä»¥è‡ªå·±å¯¹å®ƒè¿›è¡Œå°è£…ï¼Œæ”¹é€ å‡ºæˆ‘ä»¬éœ€è¦çš„è£…é¥°å™¨ï¼Œä¾‹å¦‚APIè·¯ç”±è£…é¥°å™¨</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è‡ªå®šä¹‰wrapsï¼šåªå¤åˆ¶å¿…è¦çš„å…ƒæ•°æ®ï¼Œå¿½ç•¥å…¶ä»–</span>
minimal_wraps = <span class="hljs-keyword">lambda</span> f: wraps(f, assigned=(<span class="hljs-string">'__name__'</span>,), updated=())

<span class="hljs-keyword">def</span> <span class="hljs-title function_">api_route</span>(<span class="hljs-params">path</span>):
    <span class="hljs-string">"""APIè·¯ç”±è£…é¥°å™¨ - åªéœ€è¦ä¿ç•™å‡½æ•°åç”¨äºæ—¥å¿—"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">func</span>):
<span class="hljs-meta">        @minimal_wraps(<span class="hljs-params">func</span>)</span>
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
            <span class="hljs-keyword">return</span> func(*args, **kwargs)
        wrapper.route_path = path  <span class="hljs-comment"># æ·»åŠ è·¯ç”±ä¿¡æ¯</span>
        <span class="hljs-keyword">return</span> wrapper
    <span class="hljs-keyword">return</span> decorator

<span class="hljs-meta">@api_route(<span class="hljs-params"><span class="hljs-string">'/users'</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_users</span>():
    <span class="hljs-string">"""è·å–ç”¨æˆ·åˆ—è¡¨"""</span>
    <span class="hljs-keyword">return</span> [<span class="hljs-string">"Alice"</span>, <span class="hljs-string">"Bob"</span>]
</code></pre>
<h4 data-id="heading-15">lru_cache</h4>
<h5 data-id="heading-16">å¿«é€Ÿå…¥é—¨</h5>
<p>å®é™…å¼€å‘ä¸­ï¼Œé™¤äº† wraps ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ç»å¸¸ä¼šä½¿ç”¨ lru_cache è¿™ä¸ªè£…é¥°å™¨</p>
<p>ä»€ä¹ˆæ˜¯ LRU Cacheï¼Ÿ</p>
<p>LRU (Least Recently Used) æ˜¯ä¸€ç§ç¼“å­˜æ·˜æ±°ç­–ç•¥ï¼š</p>
<ul>
<li>ç¼“å­˜æœ€è¿‘ä½¿ç”¨çš„ç»“æœ</li>
<li>å½“ç¼“å­˜æ»¡æ—¶ï¼Œåˆ é™¤æœ€ä¹…æœªä½¿ç”¨çš„é¡¹</li>
</ul>
<p>å…¶æ¬¡é€šè¿‡å®ƒæˆ‘ä»¬è¿˜å¯ä»¥ä¿è¯æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å•ä¾‹å¯¹è±¡ï¼Œä¾‹å¦‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> logging
<span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> lru_cache

<span class="hljs-keyword">from</span> core.config <span class="hljs-keyword">import</span> get_settings

<span class="hljs-keyword">from</span> redis.asyncio <span class="hljs-keyword">import</span> Redis

logger = logging.getLogger(__name__)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisClient</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self._settings = get_settings()
        self._client: Redis | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">if</span> self._client:
            logger.warning(<span class="hljs-string">"Redis client already initialized"</span>)
            <span class="hljs-keyword">return</span>
        <span class="hljs-keyword">try</span>:
            self._client = Redis(
                host=self._settings.redis_host,
                port=self._settings.redis_port,
                db=self._settings.redis_db,
                password=self._settings.redis_password)

            <span class="hljs-keyword">await</span> self._client.ping()
            logger.debug(<span class="hljs-string">"Redis client initialized"</span>)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            logger.error(<span class="hljs-string">"Redis client initialization failed"</span>, e)
            <span class="hljs-keyword">raise</span> e

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">shutdown</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">if</span> self._client:
            <span class="hljs-keyword">await</span> self._client.close()
            self._client = <span class="hljs-literal">None</span>
            logger.debug(<span class="hljs-string">"Redis client closed"</span>)

        <span class="hljs-comment"># clean cache</span>
        get_redis_client.cache_clear()

<span class="hljs-meta">    @property</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">client</span>(<span class="hljs-params">self</span>) -&gt; Redis:
        <span class="hljs-keyword">if</span> self._client <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">raise</span> AttributeError(<span class="hljs-string">"Redis client not initialized"</span>)
        <span class="hljs-keyword">return</span> self._client

<span class="hljs-meta">@lru_cache</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_redis_client</span>() -&gt; RedisClient:
    <span class="hljs-keyword">return</span> RedisClient()
</code></pre>
<p>è¿™é‡Œæ¯æ¬¡è°ƒç”¨ get_redis_client éƒ½ä¼šä»ç¼“å­˜ä¸­æä¾›ã€‚</p>
<h5 data-id="heading-17">è‡ªå®šä¹‰ lru_cache</h5>
<p>ç©ºè¯´æœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬çœ‹ç‚¹å®é™…çš„ä»£ç ï¼Œçœ‹çœ‹ lru_cache å…·ä½“æ˜¯æ€ä¹ˆå®Œæˆçš„</p>
<p>åœ¨çœ‹å…·ä½“ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå°è¯•è‡ªå·±å®šä¹‰ä¸€ä¸ª lru_cache</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> functools
<span class="hljs-keyword">import</span> inspect


<span class="hljs-keyword">def</span> <span class="hljs-title function_">make_key</span>(<span class="hljs-params">args, func</span>):
    <span class="hljs-comment"># å¦‚æœå‡½æ•°æ˜¯ç©ºå‚ï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°åä½œä¸ºkey</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(args) == <span class="hljs-number">0</span>:
        module_obj = inspect.getmodule(func)
        module_file_path = module_obj.__file__
        module_func_key = module_file_path + <span class="hljs-string">"."</span> + func.__name__

        <span class="hljs-keyword">return</span> <span class="hljs-built_in">hash</span>(module_func_key)

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">hash</span>(args)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">simple_lru_cache</span>(<span class="hljs-params">maxsize=<span class="hljs-number">128</span></span>):  <span class="hljs-comment"># å®šä¹‰è¯¥è£…é¥°å™¨æ¥æ”¶çš„å‚æ•°ï¼Œè¡¨ç¤ºå½“å‰è¿™ä¸ªå†…å­˜ä¸­å…è®¸ä½¿ç”¨çš„æœ€å¤§ç¼“å­˜æ•°é‡</span>
    <span class="hljs-comment"># å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°ï¼Œè¯´æ˜æ˜¯ä¸å¸¦æ‹¬å·çš„ç”¨æ³•</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">callable</span>(maxsize):  <span class="hljs-comment"># è¿™ä¸ªè¡Œä¸ºæ˜¯ä¸ºäº†é¿å…ç”¨æˆ·ä½¿ç”¨ @simple_lru_cache æ–¹å¼è¿›è¡Œè°ƒç”¨</span>
        func = maxsize
        maxsize = <span class="hljs-number">128</span>
        <span class="hljs-comment"># ç›´æ¥è¿”å›è£…é¥°åçš„å‡½æ•°</span>
        <span class="hljs-keyword">return</span> simple_lru_cache()(func)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">func</span>):
        <span class="hljs-string">"""ç®€åŒ–ç‰ˆ LRU ç¼“å­˜ï¼ˆä»…æ”¯æŒä½ç½®å‚æ•°ï¼‰"""</span>
        cache = {}  <span class="hljs-comment"># ç¼“å­˜çš„å­—å…¸</span>
        order = []  <span class="hljs-comment"># è®¿é—®çš„é¡ºåºåˆ—è¡¨</span>

<span class="hljs-meta">        @functools.wraps(<span class="hljs-params">func</span>)</span>
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args</span>):
            <span class="hljs-comment"># åˆ¤æ–­ä¼ é€’çš„è¿™ä¸ªå‚æ•°ä¹‹å‰æœ‰æ²¡æœ‰è°ƒç”¨è¿‡</span>
            <span class="hljs-keyword">if</span> make_key(args, func) <span class="hljs-keyword">in</span> cache:
                order.remove(args)
                order.insert(<span class="hljs-number">0</span>, args)  <span class="hljs-comment"># åœ¨å¤´éƒ¨æ’å…¥è¯¥å‚æ•°ï¼Œæ¥å®ç°ç¼“å­˜æ›´æ–°ï¼Œè¡¨ç¤ºæœ€æ–°ä½¿ç”¨è¿‡äº†è¿™ä¸ªæ•°æ®</span>
                <span class="hljs-keyword">return</span> cache[make_key(args, func)]  <span class="hljs-comment"># ç¼“å­˜å‘½ä¸­</span>

            <span class="hljs-comment"># ä¹‹å‰æ²¡æœ‰ç¼“å­˜è¿‡æ•°æ®</span>
            result = func(*args)
            cache[make_key(args, func)] = result
            order.insert(<span class="hljs-number">0</span>, args)

            <span class="hljs-comment"># ç¼“å­˜æ»¡äº†ï¼Œåˆ é™¤æœ€æ—§çš„</span>
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(order) &gt; maxsize:
                oldest = order.pop(<span class="hljs-built_in">len</span>(order) - <span class="hljs-number">1</span>)
                <span class="hljs-keyword">del</span> cache[oldest]

            <span class="hljs-keyword">return</span> result

        <span class="hljs-keyword">return</span> wrapper

    <span class="hljs-keyword">return</span> decorator


<span class="hljs-meta">@simple_lru_cache</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">foo</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"foo"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>


<span class="hljs-meta">@simple_lru_cache</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">bar</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"bar"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>


foo()
foo()
bar()
bar()
</code></pre>
<pre><code class="hljs language-python" lang="python">foo
bar
</code></pre>
<h5 data-id="heading-18">æ¢ç©¶</h5>
<p>functools.lru_cache çš„å…·ä½“å®ç°ã€‚</p>
<ol>
<li>lru_cache è£…é¥°å™¨å…¥å£</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">lru_cache</span>(<span class="hljs-params">maxsize=<span class="hljs-number">128</span>, typed=<span class="hljs-literal">False</span></span>):
    <span class="hljs-string">"""LRU ç¼“å­˜è£…é¥°å™¨

    å‚æ•°:
        maxsize: æœ€å¤§ç¼“å­˜å¤§å°ï¼ŒNone è¡¨ç¤ºæ— é™åˆ¶
        typed: True æ—¶ï¼Œä¸åŒç±»å‹çš„å‚æ•°ä¼šåˆ†åˆ«ç¼“å­˜ï¼ˆå¦‚ 3 å’Œ 3.0ï¼‰
    """</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(maxsize, <span class="hljs-built_in">int</span>):
        <span class="hljs-keyword">if</span> maxsize &lt; <span class="hljs-number">0</span>:
            maxsize = <span class="hljs-number">0</span>

    <span class="hljs-comment"># @lru_cache (ä¸å¸¦æ‹¬å·ï¼Œç›´æ¥è£…é¥°å‡½æ•°ï¼Œæ­¤æ—¶maxsizeæœ¬è´¨ä¸Šæ˜¯æˆ‘ä»¬è¢«è£…é¥°çš„å‡½æ•°å¯¹è±¡)</span>
    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">callable</span>(maxsize) <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(typed, <span class="hljs-built_in">bool</span>):
        user_function = maxsize
        maxsize = <span class="hljs-number">128</span>
        <span class="hljs-comment"># è·å–è£…é¥°å™¨å‡½æ•°ï¼Œåç»­çœŸæ­£æ‰§è¡Œçš„æ˜¯è¯¥å‡½æ•°</span>
        wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)
        wrapper.cache_parameters = <span class="hljs-keyword">lambda</span> : {<span class="hljs-string">'maxsize'</span>: maxsize, <span class="hljs-string">'typed'</span>: typed}
        <span class="hljs-comment"># æ›´æ–°user_functionçš„å…ƒä¿¡æ¯ï¼Œé¿å…å› ä¸ºè£…é¥°ä¸¢å¤±å…ƒä¿¡æ¯</span>
        <span class="hljs-keyword">return</span> update_wrapper(wrapper, user_function)

    <span class="hljs-comment"># maxsize å‚æ•°é”™è¯¯</span>
    <span class="hljs-keyword">elif</span> maxsize <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">'Expected first argument to be an integer, a callable, or None'</span>)

    <span class="hljs-comment"># è£…é¥°å™¨å·¥å‚ï¼Œå¸¸è§„ä½¿ç”¨ å³ @lru_cache() çš„æ–¹å¼</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorating_function</span>(<span class="hljs-params">user_function</span>):
        wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)
        wrapper.cache_parameters = <span class="hljs-keyword">lambda</span> : {<span class="hljs-string">'maxsize'</span>: maxsize, <span class="hljs-string">'typed'</span>: typed}
        <span class="hljs-keyword">return</span> update_wrapper(wrapper, user_function)

    <span class="hljs-keyword">return</span> decorating_function
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥é‡ç‚¹å…³æ³¨ä¸€ä¸‹  æƒ…å†µ2 <code>@lru_cache</code>è¿™ç§è°ƒç”¨ï¼ŒåŸºæœ¬è¦†ç›–æ‰€æœ‰çš„ lru_cache çš„åœºæ™¯ã€‚</p>
<p>å½“è¿™æ ·è£…é¥°å‡½æ•°ä¹‹åï¼Œè¢«è£…é¥°çš„å‡½æ•° <code>wrapped / user_function</code>å°±å˜æˆäº† <code>update_wrapper()</code>è¿”å›ç»“æœï¼Œåç»­çš„è°ƒç”¨ï¼ŒåŸºæœ¬éƒ½æ˜¯åœ¨è°ƒç”¨ <code>wrapper</code>è¯¥å‡½æ•°</p>
<p>lru_cache çš„é‡ç‚¹ä¹Ÿå°±æ˜¯è¯¥<code>wrapper</code>å‡½æ•°ï¼Œå³ <code>_lru_cache_wrapper</code></p>
<p>æˆ‘ä»¬è¿™é‡Œåªå…³æ³¨ maxsize &gt; 0 çš„çŠ¶æ€</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_lru_cache_wrapper</span>(<span class="hljs-params">user_function, maxsize, typed, _CacheInfo</span>):
    sentinel = <span class="hljs-built_in">object</span>()          <span class="hljs-comment"># unique object used to signal cache misses</span>
    make_key = _make_key         <span class="hljs-comment"># build a key from the function arguments</span>
    PREV, NEXT, KEY, RESULT = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>   <span class="hljs-comment"># é€šè¿‡æ•°ç»„çš„å½¢å¼å®Œæˆé“¾è¡¨ï¼Œè¿™é‡Œå››ä¸ªå…ƒç´ å°†æ„å»ºé“¾è¡¨çš„ä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§</span>

    cache = {}  <span class="hljs-comment"># è¯¥å‡½æ•°ç»´æŠ¤çš„æ‰€æœ‰ç¼“å­˜å­—å…¸, ç±»å‹ä¸º dict[str, (PREV, NEXT, KEY, RESULT)]</span>
    hits = misses = <span class="hljs-number">0</span>
    full = <span class="hljs-literal">False</span>
    cache_get = cache.get    <span class="hljs-comment"># ä»å­—å…¸ä¸­è·å–æ•°æ®çš„æ–¹æ³•</span>
    cache_len = cache.__len__  <span class="hljs-comment"># get cache size without calling len()</span>
    lock = RLock()           <span class="hljs-comment"># é€šè¿‡åŠ é”æ¥é¿å…å¤šçº¿ç¨‹æƒ…å†µä¸‹çš„æ•°æ®ç«äº‰é—®é¢˜</span>
    root = []                <span class="hljs-comment"># root of the circular doubly linked list</span>
    root[:] = [root, root, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>]     <span class="hljs-comment"># åˆå§‹åŒ–é“¾è¡¨ï¼Œ</span>

    ...

    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwds</span>):
            <span class="hljs-comment"># Size limited caching that tracks accesses by recency</span>
            <span class="hljs-keyword">nonlocal</span> root, hits, misses, full
            key = make_key(args, kwds, typed)  <span class="hljs-comment"># ç”Ÿæˆç¼“å­˜é”®</span>
            <span class="hljs-keyword">with</span> lock:  <span class="hljs-comment"># åŠ é”ï¼Œæ¥ä¿è¯çº¿ç¨‹å®‰å…¨</span>
                link = cache_get(key)  <span class="hljs-comment"># ä»ç¼“å­˜ä¸­å°è¯•è·å–æ•°æ®ï¼Œå¦‚æœkeyä¸å­˜åœ¨ï¼Œè¿”å›None</span>
                <span class="hljs-keyword">if</span> link <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:  <span class="hljs-comment"># ç¼“å­˜å‘½ä¸­</span>
                    <span class="hljs-comment"># æ¥ä¸‹æ¥çš„æ“ä½œå°†å‘½ä¸­çš„ç¼“å­˜ä»æœ€åä½ç½®ç§»åŠ¨åˆ°æœ€å…ˆçš„ä½ç½®</span>
                    link_prev, link_next, _key, result = link
                    link_prev[NEXT] = link_next
                    link_next[PREV] = link_prev
                    last = root[PREV]
                    last[NEXT] = root[PREV] = link
                    link[PREV] = last
                    link[NEXT] = root
                    hits += <span class="hljs-number">1</span>
                    <span class="hljs-keyword">return</span> result
                misses += <span class="hljs-number">1</span>
            result = user_function(*args, **kwds)
            <span class="hljs-keyword">with</span> lock:
                <span class="hljs-keyword">if</span> key <span class="hljs-keyword">in</span> cache:
                    <span class="hljs-keyword">pass</span>
                <span class="hljs-keyword">elif</span> full:
                    oldroot = root
                    oldroot[KEY] = key
                    oldroot[RESULT] = result
                    root = oldroot[NEXT]
                    oldkey = root[KEY]
                    oldresult = root[RESULT]
                    root[KEY] = root[RESULT] = <span class="hljs-literal">None</span>
                    <span class="hljs-keyword">del</span> cache[oldkey]
                    cache[key] = oldroot
                <span class="hljs-keyword">else</span>:
                    last = root[PREV]
                    link = [last, root, key, result]
                    last[NEXT] = root[PREV] = cache[key] = link
                    full = (cache_len() &gt;= maxsize)
            <span class="hljs-keyword">return</span> result
</code></pre>
<p>è¿™é‡Œçš„åˆ‡æ¢æµç¨‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7afa5d5c391415ebbe673e941c9d4f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc25vd3Nub3c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770866616&amp;x-signature=ejjBYt4ofMvFM7c1WhvrEPoVxZU%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªç±»è¿˜æä¾›äº† 2 ä¸ªè¾…åŠ©æ–¹æ³•</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">cache_info</span>():
    <span class="hljs-string">"""æŠ¥å‘Šç¼“å­˜ç»Ÿè®¡ä¿¡æ¯"""</span>
    <span class="hljs-keyword">with</span> lock:
        <span class="hljs-keyword">return</span> _CacheInfo(hits, misses, maxsize, cache_len())

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cache_clear</span>():
    <span class="hljs-string">"""æ¸…ç©ºç¼“å­˜å’Œç»Ÿè®¡"""</span>
    <span class="hljs-keyword">nonlocal</span> hits, misses, full
    <span class="hljs-keyword">with</span> lock:
        cache.clear()
        root[:] = [root, root, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>]
        hits = misses = <span class="hljs-number">0</span>
        full = <span class="hljs-literal">False</span>
</code></pre>
<p>æ‰€ä»¥å†å¼€å§‹æˆ‘ä»¬å¯¹å•ä¾‹è¿›è¡Œ shutdown çš„æ—¶å€™ï¼Œæ€»ä¼šè°ƒç”¨ lru_cache è£…é¥°çš„å‡½æ•°çš„ <code>cache_clear</code>æ¥æ¸…ç©ºå†…å­˜ä¿¡æ¯</p>
<h3 data-id="heading-19">ç±»è£…é¥°å™¨</h3>
<p>å…¶å®è¿™é‡Œè¯´çš„ç±»è£…é¥°å™¨ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å‡½æ•°ï¼Œåªä¸è¿‡ python çš„è¯­æ³•çµæ´»ï¼Œå¯ä»¥æŠŠç±»çœ‹æˆå‡½æ•°ï¼Œå…¶æ¬¡å€Ÿç”¨ <code>@</code>è¿™ä¸ªè¯­æ³•ç³–</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CountCalls</span>:
    <span class="hljs-string">"""ç»Ÿè®¡å‡½æ•°è°ƒç”¨æ¬¡æ•°çš„ç±»è£…é¥°å™¨"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, func</span>):
        functools.update_wrapper(self, func)
        self.func = func
        self.count = <span class="hljs-number">0</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, *args, **kwargs</span>):
        self.count += <span class="hljs-number">1</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">{self.count}</span>"</span>)
        <span class="hljs-keyword">return</span> self.func(*args, **kwargs)

<span class="hljs-meta">@CountCalls</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params">name</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Hello, <span class="hljs-subst">{name}</span>!"</span>)

greet(<span class="hljs-string">"Alice"</span>)  <span class="hljs-comment"># è°ƒç”¨æ¬¡æ•°: 1</span>
greet(<span class="hljs-string">"Bob"</span>)    <span class="hljs-comment"># è°ƒç”¨æ¬¡æ•°: 2</span>
</code></pre>
<p>ä»–è¿™é‡Œå°±ç›¸å½“äºåˆå§‹åŒ–ä¸€ä¸ªç±»å¯¹è±¡ï¼Œç„¶åè°ƒç”¨ç±»çš„ <code>__call__</code>æ–¹æ³•ï¼Œä½†æ˜¯è¦æ³¨æ„ func åœ¨ <code>__init__</code>ä¸­ä¼ é€’çš„ã€‚</p>
<h2 data-id="heading-20">Class</h2>
<h3 data-id="heading-21">namespace å‘½åç©ºé—´</h3>
<p>å’Œæ¨¡å—ä¸€æ ·, ç±»ä¹Ÿæ”¯æŒ Python åŠ¨æ€ç‰¹æ€§: åœ¨è¿è¡Œæ—¶åˆ›å»º, åˆ›å»ºåè¿˜å¯ä»¥ä¿®æ”¹</p>
<p>Python çš„ç±»ä¹Ÿæ˜¯å¯¹è±¡, è¿™ä¸ºå¯¼å…¥å’Œé‡å‘½åæä¾›äº†è¯­ä¹‰æ”¯æŒ, ä»¥åŠç±»å‹ç¼–ç¨‹æä¾›äº†å¯è¡Œ</p>
<p>å¯¹è±¡ä¹‹é—´ç›¸äº’ç‹¬ç«‹, å¤šä¸ªåç§°(ç”šè‡³æ˜¯å¤šä¸ªä½œç”¨åŸŸå†…çš„å¤šä¸ªåç§°)å¯ä»¥ç»‘å®šåˆ°åŒä¸€å¯¹è±¡</p>
<p>ä¸€å®šè¦æ³¨æ„ name å’Œ å…·ä½“çš„æ•°æ®å¯¹è±¡ä»–ä»¬æ˜¯å­˜åœ¨ä¸åŒçš„. nameä½¿æˆ‘ä»¬ç»™è¿™ä¸ªæ•°æ®å¯¹è±¡èµ·çš„ä¸€ä¸ªæ ‡è¯†è€Œå·²</p>
<p>namespace: <strong>æ˜¯ä»åç§°åˆ°å¯¹è±¡çš„æ˜ å°„</strong>.</p>
<p>ç°åœ¨, å¤§å¤šæ•°å‘½åç©ºé—´éƒ½ä½¿ç”¨ Python çš„dictå®ç°, æ‰€ä»¥ä»–å¯ä»¥ç®€å•çš„ç†è§£ä¸ºå°±æ˜¯ä¸€ä¸ªé€šè¿‡dictå®ç°çš„nameå’Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»å¯¹è±¡.</p>
<p>ä½†é™¤éæ¶‰åŠåˆ°æ€§èƒ½ä¼˜åŒ–, æˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šå…³æ³¨è¿™æ–¹é¢çš„äº‹æƒ…, è€Œä¸”å°†æ¥ä¹Ÿå¯èƒ½ä¼šæ”¹å˜è¿™ç§æ–¹å¼</p>
<p>å…³äºnamespaceçš„å…·ä½“ç¤ºä¾‹æœ‰:</p>
<ol>
<li>å†…ç½®åç§°çš„é›†åˆ(ä¾‹å¦‚abs()å‡½æ•°, è¿˜æœ‰å¼‚å¸¸ç­‰)</li>
<li>ä¸€ä¸ªæ¨¡å—(.pyæ–‡ä»¶)çš„å…¨å±€åç§°</li>
<li>å‡½æ•°è°ƒç”¨ä¸­çš„å±€éƒ¨åç§°</li>
</ol>
<p>ä¸ºä½•è¦å¼ºè°ƒ namespace çš„è¯´æ˜, å› ä¸º <strong>ä¸åŒå‘½åç©ºé—´ä¸­çš„åç§°ä¹‹é—´ç»å¯¹æ²¡æœ‰å…³ç³»</strong></p>
<p>ä¾‹å¦‚, ä¸¤ä¸ªä¸åŒçš„æ¨¡å—(.pyæ–‡ä»¶)éƒ½å¯ä»¥å®šä¹‰ maximize å‡½æ•°, ä¸”ä¸ä¼šé€ æˆæ··æ·†. ç”¨æˆ·ä½¿ç”¨å‡½æ•°æ—¶å¿…é¡»è¦åœ¨å‡½æ•°åå‰é¢åŠ ä¸Šæ¨¡å—å</p>
<p>å†…ç½®åç§°çš„å‘½åç©ºé—´æ˜¯åœ¨ Python è§£é‡Šå™¨å¯åŠ¨æ—¶åˆ›å»ºçš„, æ°¸è¿œä¸ä¼šè¢«åˆ é™¤.</p>
<p>æ¨¡å—çš„å…¨å±€å‘½åç©ºé—´(ä¹Ÿå°±æ˜¯æ¨¡å—ä¸­å…¨å±€nameä¸å¯¹è±¡ä¹‹é—´çš„å…³ç³»)åœ¨è¯»å–æ¨¡å—å®šä¹‰æ—¶åˆ›å»º; é€šå¸¸, æ¨¡å—çš„å‘½åç©ºé—´ä¹Ÿä¼šæŒç»­åˆ°è§£é‡Šå™¨é€€å‡º</p>
<h3 data-id="heading-22">Scopes ä½œç”¨åŸŸ</h3>
<p>ä¸€ä¸ªå‘½åç©ºé—´çš„ ä½œç”¨åŸŸ æ˜¯ Python ä»£ç ä¸­çš„ä¸€æ®µæ–‡æœ¬åŒºåŸŸ, <strong>ä»è¿™ä¸ªåŒºåŸŸå¯ç›´æ¥è®¿é—®è¯¥å‘½åç©ºé—´.</strong></p>
<p>é€šä¿—ç†è§£å°±æ˜¯, æˆ‘ä»¬åœ¨è¿™ä¸ªåŒºåŸŸå¯ä»¥ç›´æ¥è®¿é—®å˜é‡ / å‡½æ•° ç­‰è¿™äº›name, æ‰¾åˆ°ä»–ä»¬å¯¹åº”çš„å¯¹è±¡(å€¼ / è°ƒç”¨å‡½æ•°)</p>
<p>ä½œç”¨åŸŸè™½ç„¶æ˜¯è¢«é™æ€ç¡®å®šçš„, ä½†ä¼šè¢«åŠ¨æ€ä½¿ç”¨</p>
<ol>
<li>æœ€å†…å±‚ä½œç”¨åŸŸ, åŒ…å«å±€éƒ¨åç§°, å¹¶é¦–å…ˆåœ¨å…¶ä¸­è¿›è¡Œæœç´¢</li>
<li>é‚£äº›å¤–å±‚é—­åŒ…å‡½æ•°çš„ä½œç”¨åŸŸ, åŒ…å« "éå±€éƒ¨ã€éå…¨å±€" çš„åç§°, ä»æœ€é å†…å±‚çš„é‚£ä¸ªä½œç”¨åŸŸå¼€å§‹, é€å±‚å‘å¤–æœç´¢</li>
<li>å€’æ•°ç¬¬äºŒå±‚ä½œç”¨åŸŸ, åŒ…å«å½“å‰æ¨¡å—çš„å…¨å±€åç§°</li>
<li>æœ€å¤–å±‚(æœ€åæœç´¢)çš„ä½œç”¨åŸŸ, æ˜¯å†…ç½®åç§°çš„å‘½åç©ºé—´</li>
</ol>
<p>è€Œå†…ç½®åç§°çš„namespaceåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2Fzh-cn%2F3.13%2Flibrary%2Fbuiltins.html%23module-builtins" target="_blank" title="https://docs.python.org/zh-cn/3.13/library/builtins.html#module-builtins" ref="nofollow noopener noreferrer">builtins</a>æ¨¡å—ä¸‹, ä¾‹å¦‚åœ¨è¯¥namespaceä¸‹, æˆ‘ä»¬æœ‰ False, True, None</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-string">"""
Module: quickstart.py
Description: ç±»çš„åˆè¯†
Author: Falling Snow
Date: 2025-06-06
"""</span>

<span class="hljs-comment"># -*- coding: utf-8 -*-</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">scopes_global_nonlocal_test</span>():
    <span class="hljs-string">"""global nonlocal å˜é‡æµ‹è¯•"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_local</span>():
        spam = <span class="hljs-string">"local spam"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_nonlocal</span>():
        <span class="hljs-comment"># ä½¿ç”¨ nonlocal éœ€è¦åœ¨å½“å‰defçš„scopeå¤–éƒ¨åˆ›å»ºä¸€ä¸ªspam</span>
        <span class="hljs-keyword">nonlocal</span> spam
        spam = <span class="hljs-string">"nonlocal spam"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_global</span>():
        <span class="hljs-keyword">global</span> spam
        spam = <span class="hljs-string">"global spam"</span>

    spam = <span class="hljs-string">"test spam"</span>
    do_local()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"After local assignment:"</span>, spam)
    do_nonlocal()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"After nonlocal assignment:"</span>, spam)
    do_global()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"After global assignment:"</span>, spam)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    scopes_global_nonlocal_test()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"In global scope: "</span>, spam)

</code></pre>

<p><img src="%E8%BD%AC%E5%AD%98%E5%A4%B1%E8%B4%A5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%20class/global_nonlocal_var_step.png" alt="è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa7739fb3d5142f89514f2e79d1f7f85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc25vd3Nub3c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770866616&amp;x-signature=oxPxNYKmuEZE8dh2jI1Zzh0cRME%3D" alt="" loading="lazy"/></p>
<p>:::info
nonlocalçš„èµ‹å€¼ä¼šæ”¹å˜æˆ‘ä»¬çš„å¯¹äºå˜é‡çš„ç»‘å®š, è€Œglobalä¼šä¿®æ”¹æ¨¡å—å±‚çº§çš„ç»‘å®š</p>
<p>nonlocalä¼šæƒ³å½“å‰ä½œç”¨åŸŸçš„å¤–éƒ¨è¿›è¡Œå¯»æ‰¾, è€Œglobalä¼šåœ¨å…¨å±€ä½œç”¨åŸŸä¸­å¤„ç†</p>
<p>:::</p>
<h3 data-id="heading-23">class</h3>
<p>å½“è¿›å…¥ç±»å®šä¹‰æ—¶, å°†åˆ›å»ºä¸€ä¸ªæ–°çš„å‘½åç©ºé—´, å¹¶å°†å…¶ç”¨ä½œå±€éƒ¨ä½œç”¨åŸŸ --- å› æ­¤, æ‰€æœ‰å¯¹å±€éƒ¨å˜é‡çš„èµ‹å€¼éƒ½æ˜¯åœ¨è¿™ä¸ªæ–°å‘½åç©ºé—´ä¹‹å†…</p>
<p>å¦‚æœä¸æ”¯æŒç»§æ‰¿, è¯­è¨€ç‰¹æ€§å°±ä¸å€¼å¾—ç§°ä¸º"ç±»". æ´¾ç”Ÿç±»å®šä¹‰çš„è¯­æ³•å¦‚ä¸‹æ‰€ç¤º</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DerivedClassName</span>(<span class="hljs-title class_ inherited__">BaseClassName</span>):
    &lt;è¯­å¥-<span class="hljs-number">1</span>&gt;
    .
    .
    .
    &lt;è¯­å¥-N&gt;
</code></pre>
<h4 data-id="heading-24">å…ƒç±»</h4>
<p>ç±»å®ƒä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡, ä»–ä»¬æœ‰è¿™æ ·çš„å…³ç³»</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/363c12d4dc264ac4bde11bc60c830838~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc25vd3Nub3c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770866616&amp;x-signature=2BPllBNYnS80UJruE%2FCi9iPTtUM%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-25">isinstance &amp; issubclass</h4>
<p>Pythonæœ‰ä¸¤ä¸ªå†…ç½®å‡½æ•°å¯è¢«ç”¨äºç»§æ‰¿æœºåˆ¶:</p>
<ul>
<li>ä½¿ç”¨<code>isinstance()</code>æ¥æ£€æŸ¥ä¸€ä¸ª<strong>å®ä¾‹çš„ç±»å‹</strong>: <code>isinstance(obj, int)</code>ä»…ä¼šåœ¨<code>obj.__class__</code> ä¸º int æˆ–æ´¾ç”Ÿäº int çš„ç±»æ—¶ä¸ºTrue</li>
<li>ä½¿ç”¨<code>issubclass()</code> æ¥æ£€æŸ¥<strong>ç±»çš„ç»§æ‰¿å…³ç³»</strong>: <code>issubclass(bool, int)</code>ä¸ºTrue, å› ä¸ºboolæ˜¯intçš„å­ç±», ä½†æ˜¯<code>issubclass(float, int)</code> ä¸º <code>False</code>, å› ä¸º <code>float</code> ä¸æ˜¯ <code>int</code> çš„å­ç±»</li>
</ul>
<p>è¡¥å……ä¸€ä¸‹<code>obj.__class__</code>çš„æ¦‚å¿µ:</p>
<p>pythonä¸­æ¯ä¸€ä¸ªå€¼éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡, è€Œå¯¹äºå®ä¾‹è€Œè¨€, ä»–ä»¬ä¼šä¿å­˜å…¶ç±»å‹ä¿¡æ¯, é€šè¿‡<code>obj.__class__</code> è¿›è¡Œå­˜å‚¨</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>():
    <span class="hljs-keyword">pass</span>


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    i = <span class="hljs-number">233</span>
    <span class="hljs-built_in">print</span>(i.__class__)  <span class="hljs-comment"># &lt;class 'int'&gt;</span>

    <span class="hljs-built_in">print</span>(A().__class__)  <span class="hljs-comment"># &lt;class '__main__.A'&gt;</span>
</code></pre>
<h4 data-id="heading-26">å¤šç»§æ‰¿</h4>
<p>å¦‚æœå¤šç»§æ‰¿äº†, æˆ‘ä»¬è®¿é—®åŒåå±æ€§, ä»–ä¼šè°ƒç”¨è°çš„å‘¢?</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DerivedClassName</span>(Base1, Base2, Base3):
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>ä»çˆ¶ç±»æ‰€ç»§æ‰¿å±æ€§çš„æ“ä½œæ˜¯æ·±åº¦ä¼˜å…ˆã€ä»å·¦åˆ°å³çš„, å½“å±‚æ¬¡ç»“æ„å­˜åœ¨é‡å æ—¶ä¸ä¼šåœ¨åŒä¸€ä¸ªç±»ä¸­æœç´¢ä¸¤æ¬¡. å› æ­¤, å¦‚æœæŸä¸ªå±æ€§åœ¨ <code>DerivedClassName</code> ä¸­æ‰¾ä¸åˆ°, å°±ä¼šåœ¨ <code>Base1</code> ä¸­æœç´¢å®ƒ, ç„¶åï¼ˆé€’å½’åœ°ï¼‰åœ¨ <code>Base1</code> çš„åŸºç±»ä¸­æœç´¢, å¦‚æœåœ¨é‚£é‡Œä¹Ÿæ‰¾ä¸åˆ°, å°±å°†åœ¨ <code>Base2</code> ä¸­æœç´¢, ä¾æ­¤ç±»æ¨</p>
<h4 data-id="heading-27">private</h4>
<p><strong>é‚£ç§ä»…é™ä»ä¸€ä¸ªå¯¹è±¡å†…éƒ¨è®¿é—®çš„"ç§æœ‰"å®ä¾‹å˜é‡åœ¨ Python ä¸­å¹¶ä¸å­˜åœ¨</strong></p>
<p>ä½†æ˜¯, å¤§å¤šæ•° Python ä»£ç éƒ½éµå¾ªè¿™æ ·ä¸€ä¸ªçº¦å®š: å¸¦æœ‰ä¸€ä¸ªä¸‹åˆ’çº¿çš„åç§° (ä¾‹å¦‚ <code>_spam</code>) åº”è¯¥è¢«å½“ä½œæ˜¯ API çš„éå…¬æœ‰éƒ¨åˆ† (æ— è®ºå®ƒæ˜¯å‡½æ•°ã€æ–¹æ³•æˆ–æ˜¯æ•°æ®æˆå‘˜)</p>
<p>ä½†è¿™ç§è¡Œä¸ºç»ˆç©¶åªæ˜¯çº¦å®š, å¦‚æœæˆ‘ä»¬çœŸçš„å¸Œæœ›ä½¿ç”¨ä¸€äº›ç§æœ‰çš„æˆå‘˜,  pythonæä¾›äº†ä¸€ç§è¾ƒä¸ºè„†å¼±çš„æœºåˆ¶: <code>name mangling</code> å¯¹çš„, å°±åƒæ˜¯c++ä¸­å‡½æ•°é‡è½½çš„æœºåˆ¶ä¸€æ ·, python<strong>ä¼šå¯¹åŒä¸‹åˆ’çº¿çš„æˆå‘˜è¿›è¡Œname mangling</strong>, ä¾‹å¦‚<code>__spam</code> ä¼šè¢«æ”¹ä¸º <code>_classname__spam</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Mapping</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, iterable</span>):
        self.items_list = []
        self.__update(iterable)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self, iterable</span>):
        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> iterable:
            self.items_list.append(item)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__next__</span>(<span class="hljs-params">self, index</span>):
        <span class="hljs-keyword">if</span> index &gt;= <span class="hljs-built_in">len</span>(self.items_list):
            <span class="hljs-keyword">raise</span> StopIteration
        <span class="hljs-keyword">return</span> self.items_list[index]

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__iter__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">iter</span>(self.items_list)

    __update = update  <span class="hljs-comment"># update çš„å‰¯æœ¬, ä½†æ˜¯è¯¥æ–¹æ³•æ˜¯ç§æœ‰çš„</span>


<span class="hljs-keyword">class</span> <span class="hljs-title class_">MappingSubclass</span>(<span class="hljs-title class_ inherited__">Mapping</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self, keys, values</span>):  <span class="hljs-comment"># ä¸ä¼šç ´åMappingçš„__init__ä¸­self.__update(iterable)è¿™ä¸ªé€»è¾‘, è¿˜æä¾›äº†updateæ–°çš„ç­¾å</span>
        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(keys, values):
            self.items_list.append(item)  <span class="hljs-comment"># item is a Tuple(key, value)</span>


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    ms = MappingSubclass([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])
    <span class="hljs-built_in">print</span>(<span class="hljs-string">', '</span>.join(<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ms))
    ms.update([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-string">'alice'</span>, <span class="hljs-string">'bob'</span>, <span class="hljs-string">'jude'</span>])
    <span class="hljs-built_in">print</span>(<span class="hljs-string">', '</span>.join(<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ms))

    ms.__update([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])  <span class="hljs-comment"># AttributeError: 'MappingSubclass' object has no attribute '__update'. Did you mean: 'update'?</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">', '</span>.join(<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ms))
</code></pre>
<h4 data-id="heading-28">odds and ends(æ‚é¡¹)</h4>
<ul>
<li>æ•°æ®ç±»</li>
</ul>
<p>å¿«é€Ÿä½¿ç”¨</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span>:
    name: <span class="hljs-built_in">str</span>
    dept: <span class="hljs-built_in">str</span>
    salary: <span class="hljs-built_in">int</span>
</code></pre>
<p>å½“æˆ‘ä»¬ç»™ç±»æ·»åŠ äº†<code>@dataclass</code>è£…é¥°å™¨, å®ƒç”¨äºè‡ªåŠ¨ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»æ·»åŠ ç”Ÿæˆä¸€äº› <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2Fzh-cn%2F3.13%2Fglossary.html%23term-special-method" target="_blank" title="https://docs.python.org/zh-cn/3.13/glossary.html#term-special-method" ref="nofollow noopener noreferrer">ç‰¹æ®Šæ–¹æ³•</a> ä¾‹å¦‚ <code>__init__()</code> å’Œ <code>__repr__()</code>ã€‚ å®ƒçš„åˆå§‹æè¿°è§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fpeps.python.org%2Fpep-0557%2F" target="_blank" title="https://peps.python.org/pep-0557/" ref="nofollow noopener noreferrer"><strong>PEP 557</strong></a></p>
<p>ä»–ä»¬å…·æœ‰å¦‚ä¸‹çš„è½¬æ¢å…³ç³»</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryItem</span>:
    <span class="hljs-string">'''Class for keeping track of an item in inventory.'''</span>
    name: <span class="hljs-built_in">str</span>
    unit_price: <span class="hljs-built_in">float</span>
    quantity_on_hand: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">total_cost</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">float</span>:
        <span class="hljs-keyword">return</span> self.unit_price * self.quantity_on_hand
</code></pre>
<p><code>@dataclass</code>è£…é¥°å™¨å°†å‘ç±»æ·»åŠ è¿™äº›å†…å®¹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span>, unit_price: <span class="hljs-built_in">float</span>, quantity_on_hand: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span></span>) -&gt; <span class="hljs-literal">None</span>:
    self.name = name
    self.unit_price = unit_price
    self.quantity_on_hand = quantity_on_hand
<span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):
    <span class="hljs-comment"># &lt;expression&gt;!r ç­‰åŒäº repr(&lt;expression&gt;)</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f'InventoryItem(name=<span class="hljs-subst">{self.name!r}</span>, unit_price=<span class="hljs-subst">{self.unit_price!r}</span>, quantity_on_hand=<span class="hljs-subst">{self.quantity_on_hand!r}</span>)'</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">self, other</span>):
    <span class="hljs-keyword">if</span> other.__class__ <span class="hljs-keyword">is</span> self.__class__:
        <span class="hljs-keyword">return</span> (self.name, self.unit_price, self.quantity_on_hand) == (other.name, other.unit_price, other.quantity_on_hand)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NotImplemented</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">__ne__</span>(<span class="hljs-params">self, other</span>):
    <span class="hljs-keyword">if</span> other.__class__ <span class="hljs-keyword">is</span> self.__class__:
        <span class="hljs-keyword">return</span> (self.name, self.unit_price, self.quantity_on_hand) != (other.name, other.unit_price, other.quantity_on_hand)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NotImplemented</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">__lt__</span>(<span class="hljs-params">self, other</span>):
    <span class="hljs-keyword">if</span> other.__class__ <span class="hljs-keyword">is</span> self.__class__:
        <span class="hljs-keyword">return</span> (self.name, self.unit_price, self.quantity_on_hand) &lt; (other.name, other.unit_price, other.quantity_on_hand)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NotImplemented</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">__le__</span>(<span class="hljs-params">self, other</span>):
    <span class="hljs-keyword">if</span> other.__class__ <span class="hljs-keyword">is</span> self.__class__:
        <span class="hljs-keyword">return</span> (self.name, self.unit_price, self.quantity_on_hand) &lt;= (other.name, other.unit_price, other.quantity_on_hand)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NotImplemented</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">__gt__</span>(<span class="hljs-params">self, other</span>):
    <span class="hljs-keyword">if</span> other.__class__ <span class="hljs-keyword">is</span> self.__class__:
        <span class="hljs-keyword">return</span> (self.name, self.unit_price, self.quantity_on_hand) &gt; (other.name, other.unit_price, other.quantity_on_hand)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NotImplemented</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">__ge__</span>(<span class="hljs-params">self, other</span>):
    <span class="hljs-keyword">if</span> other.__class__ <span class="hljs-keyword">is</span> self.__class__:
        <span class="hljs-keyword">return</span> (self.name, self.unit_price, self.quantity_on_hand) &gt;= (other.name, other.unit_price, other.quantity_on_hand)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NotImplemented</span>
</code></pre>
<p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬åŸºç¡€çš„ <code>__init__</code>, <code>__repr__</code>, Rich_Comparsion method, å½“ç„¶, å®ƒå…è®¸æˆ‘ä»¬é‡å†™ä¸€äº›æ–¹æ³•</p>
<p>ä»è¿™é‡Œ, æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡º, ä¸€èˆ¬<code>__repr__</code>ç”¨äºå±•ç¤ºæˆ‘ä»¬çš„è¿™ä¸ªå®ä¾‹çš„ç»“æ„</p>
<h2 data-id="heading-29">Generator(ç”Ÿæˆå™¨)</h2>
<p>æ¦‚è¿°: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2Fzh-cn%2F3.13%2Ftutorial%2Fclasses.html%23generators" target="_blank" title="https://docs.python.org/zh-cn/3.13/tutorial/classes.html#generators" ref="nofollow noopener noreferrer">docs.python.org/zh-cn/3.13/â€¦</a></p>
<p>å…·ä½“: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2Fzh-cn%2F3.13%2Fglossary.html%23term-generator" target="_blank" title="https://docs.python.org/zh-cn/3.13/glossary.html#term-generator" ref="nofollow noopener noreferrer">docs.python.org/zh-cn/3.13/â€¦</a></p>
<p>def: ç”Ÿæˆå™¨ æ˜¯ä¸€ä¸ªç”¨äº<strong>åˆ›å»ºè¿­ä»£å™¨</strong>çš„ç®€å•è€Œå¼ºå¤§çš„å·¥å…·.</p>
<p>è€ŒGenerator expressionè¿”å›çš„å¯¹è±¡çš„ç±»å‹æ˜¯ä¸€ä¸ª <strong>generator iterator</strong>. æ³¨æ„è¿™æ˜¯ä¸€ä¸ªiterator, æ„å‘³ç€å®ƒå®ç°äº†.</p>
<p>ç”Ÿæˆå™¨å’Œè¿­ä»£å™¨æ€»æ˜¯ä¸€èµ·è®¨è®º</p>
<p>æˆ‘ä»¬æ‰€è¯´çš„ç”Ÿæˆå™¨(Generator)é€šå¸¸æ˜¯æŒ‡ä¸€ä¸ªç”Ÿæˆå™¨çš„å‡½æ•°, è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡, è¯¥å¯¹è±¡é€šå¸¸ç§°ä¹‹ä¸º Generator Iterator(ç”Ÿæˆå™¨è¿­ä»£å™¨)</p>
<p>åè¯:</p>
<ul>
<li>Generator: ç”Ÿæˆå™¨</li>
<li>Generator Iterator: ç”Ÿæˆå™¨è¿­ä»£å™¨</li>
</ul>
<p>Generatorå¾ˆåƒæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°, ä½†æ˜¯å…³é”®çš„åœ°æ–¹åœ¨äº, ä»–ä¼šåœ¨å‡½æ•°ä¸­ä½¿ç”¨<strong>yieldè¡¨è¾¾å¼</strong>, ä»è€Œè¿”å›ä¸€ä¸ª Generator Iterator.</p>
<p>é€šè¿‡è¯¥Generator Iterator æˆ‘ä»¬è¿›è¡Œfor-loop æˆ–è€…åŸºäºè¯¥å¯¹è±¡çš„next()æ–¹æ³•é€æ­¥çš„è·å–æ‰€æœ‰æ•°æ®</p>
<p>æµ‹è¯•</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> collections.abc <span class="hljs-keyword">import</span> Iterator, Generator
<span class="hljs-keyword">from</span> builtins <span class="hljs-keyword">import</span> <span class="hljs-built_in">list</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse</span>(<span class="hljs-params">data</span>):
    <span class="hljs-string">""" ç¿»è½¬æ•°æ® """</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data) - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):
        <span class="hljs-keyword">yield</span> data[i]


<span class="hljs-keyword">def</span> <span class="hljs-title function_">example01</span>():
    gi = reverse([<span class="hljs-number">11</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>, <span class="hljs-number">44</span>])
    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">isinstance</span>(gi, (Iterator)))  <span class="hljs-comment"># True</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(gi))  <span class="hljs-comment"># generator</span>

    <span class="hljs-comment"># å®ƒæ˜¯ä¸€ä¸ª Iterator, æ‰€ä»¥å¯ä»¥è¿›è¡Œ for</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> gi:
        <span class="hljs-built_in">print</span>(i)
</code></pre>
<p>å¯ä»¥ç”¨ç”Ÿæˆå™¨æ¥å®Œæˆçš„ä»»ä½•åŠŸèƒ½åŒæ ·å¯ä»¥é€šè¿‡åŸºäºç±»çš„è¿­ä»£å™¨æ¥å®Œæˆ. ä½†ç”Ÿæˆå™¨çš„å†™æ³•æ›´ä¸ºç´§å‡‘, å› ä¸ºå®ƒä¼šè‡ªåŠ¨åˆ›å»º <code>__iter__()</code> å’Œ <code>__next__()</code> æ–¹æ³•</p>
<p>ç°åœ¨æˆ‘ä»¬åŸºäºç”Ÿæˆå™¨ å’Œ è¿­ä»£å™¨çš„æ–¹å¼, å®ç°æˆ‘ä»¬çš„ è¯»å–æ–‡æœ¬è¡Œçš„åŠŸèƒ½. ä½†æ˜¯å¯¹è¿™ä¸ªåŠŸèƒ½, æˆ‘ä»¬éœ€è¦åšå‡ºä¸€äº›æ‹“å±•</p>
<p>ä¾‹å¦‚ <code># </code> å¼€å§‹çš„æ–‡æœ¬è¡Œä¸è¯»å–, ç©ºè¡Œä¸è¯»å–</p>
<ul>
<li>åŸºäºIteratorå®ç°</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClearFileIterator</span>:
    <span class="hljs-string">"""åŸºäºè¿­ä»£å™¨çš„æ–¹å¼è¯»å–å¹²å‡€çš„æ–‡æœ¬è¡Œ"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self: <span class="hljs-string">'ClearFileIterator'</span>, file_path: <span class="hljs-built_in">str</span></span>):
        self.file_path = file_path
        self.file = <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__iter__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> self

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__next__</span>(<span class="hljs-params">self</span>):
        line = self.file.readline()
        <span class="hljs-keyword">while</span> line:
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">len</span>(line.strip()) == <span class="hljs-number">0</span>) <span class="hljs-keyword">or</span> line.startswith(<span class="hljs-string">'#'</span>):
                <span class="hljs-comment"># è¡¨ç¤ºå†…å®¹ä¸ºç©ºè¡Œæˆ–è€…ä»¥ # å¼€å§‹, æ˜¯æ³¨é‡Š, è·³è¿‡</span>
                line = self.file.readline()
                <span class="hljs-keyword">continue</span>
            <span class="hljs-keyword">return</span> line

        <span class="hljs-comment"># è¡¨ç¤ºå†…å®¹è¯»å–å®Œæ¯•</span>
        self.file.close()
        <span class="hljs-keyword">raise</span> StopIteration
</code></pre>
<ul>
<li>åŸºäºç”Ÿæˆå™¨</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">clear_file_generator</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""åŸºäºç”Ÿæˆå™¨çš„æ–¹å¼, è¯»å–å¹²å‡€çš„æ–‡æœ¬è¡Œ"""</span>
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> file:
        line = file.readline()
        <span class="hljs-keyword">while</span> line:
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">len</span>(line.strip()) == <span class="hljs-number">0</span>) <span class="hljs-keyword">or</span> line.startswith(<span class="hljs-string">'#'</span>):
                <span class="hljs-comment"># è¡¨ç¤ºå†…å®¹ä¸ºç©ºè¡Œæˆ–è€…ä»¥ # å¼€å§‹, æ˜¯æ³¨é‡Š, è·³è¿‡</span>
                line = file.readline()
                <span class="hljs-keyword">continue</span>
            <span class="hljs-keyword">yield</span> line
            line = file.readline()
</code></pre>
<p><strong>ç›¸è¾ƒäºè¿­ä»£å™¨, é‡å†™<code>**__iter__**</code>, <code>**__next__**</code>, ç›´æ¥ä½¿ç”¨ yield æ¯«æ— ç–‘é—®ä»£ç è¦ç®€åŒ–å¾ˆå¤š.</strong></p>
<p><strong>ä¸ºä½•è¦æ˜¯ç”¨ç”Ÿæˆå™¨ / è¿­ä»£å™¨?</strong></p>
<hr/>
<h2 data-id="heading-30">Generator expressions(ç”Ÿæˆå™¨è¡¨è¾¾å¼)</h2>
<p>Generator expressions: æˆ‘ä»¬æœ‰æ—¶ä¹Ÿä¼šç§°ä¸ºç”Ÿæˆå¼</p>
<p>ç”Ÿæˆå¼è¯­æ³•è§„åˆ™å¦‚ä¸‹</p>
<pre><code class="hljs language-python" lang="python">generator_expression ::= <span class="hljs-string">"("</span> expression comp_for <span class="hljs-string">")"</span>
</code></pre>
<p>ç”Ÿæˆå™¨è¡¨è¾¾å¼ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„<strong>ç”Ÿæˆå™¨å¯¹è±¡(Generator Object)</strong>. å®ƒçš„è¯­æ³•ä¸æ¨å¯¼å¼ç›¸åŒ, åªä¸è¿‡å®ƒè¢«åŒ…å«åœ¨åœ†æ‹¬å·ä¸­</p>
<p><strong>ç”Ÿæˆå™¨å¯¹è±¡(Generator Object)</strong>: ç”Ÿæˆå™¨å¯¹è±¡æ˜¯Pythonç”¨æ¥å®ç°ç”Ÿæˆå™¨è¿­ä»£å™¨çš„å¯¹è±¡. å®ƒä»¬é€šå¸¸é€šè¿‡<strong>è¿­ä»£äº§ç”Ÿå€¼çš„å‡½æ•°</strong>æ¥åˆ›å»º, è€Œä¸æ˜¯æ˜¾å¼è°ƒç”¨</p>
<p><strong>The parentheses can be omitted on calls with only one argument. å¦‚æœè°ƒç”¨çš„å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°, å¯ä»¥å¿½ç•¥ç”Ÿæˆå¼çš„æ‹¬å·</strong></p>
<p>ä¾‹å¦‚</p>
<pre><code class="hljs language-python" lang="python">nums = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
res = <span class="hljs-string">', '</span>.join(<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> nums)
<span class="hljs-built_in">print</span>(res)

<span class="hljs-string">"""
è¾“å‡º
1, 2, 3, 4, 5
"""</span>
</code></pre>
<p>ä¸ºä½•ä½¿ç”¨ç”Ÿæˆå¼?  æƒ°æ€§æ±‚å€¼.</p>
<p>å› ä¸ºç”Ÿæˆå™¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„å˜é‡ä¼šåœ¨ç”Ÿæˆå™¨å¯¹è±¡è°ƒç”¨ <code>__next__()</code> æ–¹æ³•æ—¶<strong>æƒ°æ€§æ±‚å€¼</strong>ï¼ˆä¸æ™®é€šç”Ÿæˆå™¨çš„å·¥ä½œæ–¹å¼ç›¸åŒï¼‰. ç„¶è€Œ, <strong>æœ€å·¦ä¾§ <strong><code>for</code></strong> å­å¥ä¸­çš„å¯è¿­ä»£è¡¨è¾¾å¼</strong>ä¼š<strong>ç«‹å³æ±‚å€¼</strong>. è¿™æ„å‘³ç€å¦‚æœè¿™ä¸ªå¯è¿­ä»£è¡¨è¾¾å¼äº§ç”Ÿäº†é”™è¯¯, é‚£ä¹ˆé”™è¯¯å°†åœ¨å®šä¹‰ç”Ÿæˆå™¨è¡¨è¾¾å¼çš„ä½ç½®å°±è¢«æŠ›å‡º, è€Œä¸æ˜¯ç­‰åˆ°ç¬¬ä¸€æ¬¡å–å€¼çš„æ—¶å€™.</p>
<p>è‡³äºåç»­çš„ <code>for</code> å­å¥, ä»¥åŠæœ€å·¦ä¾§ <code>for</code> å­å¥ä¸­çš„ä»»ä½•è¿‡æ»¤æ¡ä»¶, å®ƒä»¬<strong>ä¸èƒ½åœ¨å¤–éƒ¨ä½œç”¨åŸŸä¸­æå‰æ±‚å€¼</strong>ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ä¾èµ–äºä»æœ€å·¦ä¾§çš„å¯è¿­ä»£å¯¹è±¡ä¸­è·å¾—çš„å€¼ã€‚</p>
<p>ä¾‹å¦‚ï¼š<code>(x*y for x in range(10) for y in range(x, x+10))</code></p>
<p><code>for x in range(10)</code> ç«‹å³æ±‚å€¼, åç»­çš„<code>for y in range(...)</code> ä¼šåœ¨æ¯æ¬¡å–å€¼çš„æ—¶å€™åœ¨æ±‚å€¼(evaluate)</p>
<h2 data-id="heading-31">import</h2>
<h3 data-id="heading-32">Relative import</h3>
<p>ä½¿ç”¨ç›¸å¯¹å¯¼å…¥æ—¶ï¼Œå¯¹äºå•ç‹¬çš„ python æ–‡ä»¶åœ¨è¿è¡Œæ—¶ï¼Œåº”è¯¥å°†å…¶è§†ä¸ºä¸€ä¸ª package, è€Œä¸æ˜¯ module, é¿å…å‡ºç°é—®é¢˜ã€‚</p>
<p>æ–¹æ³•å¾ˆç®€å•ï¼Œè¿è¡Œæ—¶åŠ ä¸Š -m å³å¯ï¼Œè¿™æ ·è¿è¡Œ</p>
<p>æ–‡ä»¶ç»“æ„å¦‚ä¸‹</p>
<pre><code class="hljs language-python" lang="python">â””â”€python
    â”œâ”€demo01.py
    â””â”€demo02.py
</code></pre>
<p>æˆ‘ä»¬åœ¨ python ç›®å½•ä¹‹å¤–ï¼Œä½¿ç”¨å¦‚ä¸‹çš„è¿è¡Œ</p>
<pre><code class="hljs language-shell" lang="shell">python -m python.demo01
</code></pre>
<p>demo01 çš„å†…å®¹å¦‚ä¸‹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> .demo02 <span class="hljs-keyword">import</span> demo02

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    demo02()
</code></pre>
<h2 data-id="heading-33">Special Method</h2>
<p>official: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2Fzh-cn%2F3.13%2Freference%2Fdatamodel.html%23special-method-names" target="_blank" title="https://docs.python.org/zh-cn/3.13/reference/datamodel.html#special-method-names" ref="nofollow noopener noreferrer">docs.python.org/zh-cn/3.13/â€¦</a></p>
<h3 data-id="heading-34">é€šç”¨</h3>
<p><code>__new__</code> ä½¿ç”¨è¾ƒå°‘. å¦‚æœæˆ‘ä»¬éœ€è¦ä½¿ç”¨å•ä¾‹è¿™ç§, å°±éœ€è¦ä½¿ç”¨è¯¥æ–¹æ³•, ä¹Ÿå°±æ˜¯å®¢åˆ¶åŒ–å»ºç«‹çš„è¿‡ç¨‹, æˆ–è€…metaclassçš„æ—¶å€™</p>
<p><code>__new__</code>å»ºç«‹obj, æ‰€ä»¥ä»–å¿…é¡»è¦è¿”å›ä¸€ä¸ªobj, è¿™æ˜¯å’Œ<code>__init__</code> ä¸åŒ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># @author: falling snow</span>
<span class="hljs-comment"># @date: 2025-05-20</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:
    name = <span class="hljs-string">'falling snow'</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, name</span>):
        <span class="hljs-comment"># class &gt; object</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"create a object"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"__new__: name: "</span> + name)
        <span class="hljs-comment"># è¿™é‡Œçš„å†™æ³•éœ€è¦æ³¨æ„.</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().__new__(cls)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-comment"># have a object, init some properties</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"object initialize"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'__init__: name: <span class="hljs-subst">{name}</span>'</span>)
        self.name = name


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:

    <span class="hljs-comment"># a = A()  # error, A.__new__() missing 1 required positional argument: 'name'</span>

    <span class="hljs-comment"># if using arguments</span>
    a1 = A(<span class="hljs-string">'alice'</span>)
    <span class="hljs-comment"># equals</span>
    <span class="hljs-comment"># a1 = __new__(A,'alice')</span>
    <span class="hljs-comment"># __init__(a1, 'alice')</span>

    <span class="hljs-built_in">print</span>(<span class="hljs-string">'name = '</span> + a1.name)
</code></pre>
<ul>
<li><code>__del__</code></li>
</ul>
<p>delå¯ä»¥å½“æˆCppçš„ææ„, ä½†æ˜¯å®ƒä¸æ˜¯. ä»–çš„ä¼šåœ¨å¯¹è±¡é‡Šæ”¾å, è¿›è¡Œè°ƒç”¨, åšä¸€äº›å¤„ç†.</p>
<p>ä½†æ˜¯Pythonä¸­å¯¹è±¡çš„é‡Šæ”¾. è¾ƒä¸ºå¤æ‚, ä¾‹å¦‚:</p>
<ol>
<li>åœ¨å¼•ç”¨ä¸º0æ—¶, é‡Šæ”¾.</li>
<li>åœ¨GCæ—¶å€™å¯èƒ½é‡Šæ”¾.</li>
</ol>
<p><strong>é‡Šæ”¾çš„æ—¶æœºæ˜¯ä»»æ„æ—¶æœŸ. è¿™ä¸ªè¿‡ç¨‹æ— æ³•æ§åˆ¶, æ‰€ä»¥ç”¨çš„ä¸å¤š</strong></p>
<p><code>__del__</code> å’Œ <code>del</code> å…³é”®å­—ä¸åŒ.</p>
<p><code>del obj</code> åªæ˜¯è®©objå°‘ä¸€ä¸ªå¼•ç”¨, ä½†æ˜¯å¹¶ä¸ä¼šè§¦å‘<code>__del__</code></p>
<p>ä¾‹å¦‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__del__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'__del__'</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:

    a = A()
    x = a
    <span class="hljs-keyword">del</span> a  <span class="hljs-comment"># A()åˆ›å»ºçš„å¯¹è±¡å‡å°‘ä¸€æ¬¡å¼•ç”¨. ä½†æ˜¯ä¾æ—§ä¸ä¼šé‡Šæ”¾</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'main finish'</span>)
</code></pre>
<p>output</p>
<pre><code class="hljs language-python" lang="python">main finish
__del__
</code></pre>
<ul>
<li><code>__str__</code> &amp; <code>__repr__</code></li>
</ul>
<p>äºŒè€…ä¸»è¦æ˜¯è¯­ä¹‰ä¸Šä¸åŒ, éƒ½æ˜¯è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤º.</p>
<p><code>__str__</code> è¿”å›äººç±»ç†è§£çš„, æ³¨é‡å¯è¯»æ€§</p>
<p><code>__repr__</code>è¿”å›æ›´è¯¦ç»†çš„ä¿¡æ¯, æ­¤æ–¹æ³•é€šå¸¸è¢«ç”¨äºè°ƒè¯•, å› æ­¤ç¡®ä¿å…¶è¡¨ç¤ºçš„å†…å®¹åŒ…å«ä¸°å¯Œä¿¡æ¯ä¸”æ— æ­§ä¹‰æ˜¯å¾ˆé‡è¦çš„</p>
<p>å¦‚æœä¸€ä¸ªç±»å®šä¹‰äº† <code>__repr__()</code> ä½†æœªå®šä¹‰ <code>__str__()</code>, åˆ™åœ¨éœ€è¦è¯¥ç±»çš„å®ä¾‹çš„ "éæ­£å¼" å­—ç¬¦ä¸²è¡¨ç¤ºæ—¶ä¹Ÿä¼šä½¿ç”¨ <code>__repr__()</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">repr</span>(A()))
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(A()))
<span class="hljs-built_in">print</span>(A())  <span class="hljs-comment"># å­˜åœ¨__str__, è°ƒç”¨å®ƒ, æ²¡æœ‰çš„è¯è°ƒç”¨__repr__</span>
</code></pre>
<ul>
<li><code>__bytes__</code></li>
</ul>
<p>å¦‚æœä¸å®¢åˆ¶åŒ–è¿™ä¸ªå¯¹è±¡çš„äºŒè¿›åˆ¶è¡¨ç¤º. å¾ˆå°‘ä½¿ç”¨:D</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__bytes__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># using bytes(obj), will call the method</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"__bytes__called"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])  <span class="hljs-comment"># return need bytes</span>


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(A()))

</code></pre>
<h3 data-id="heading-35">æ¯”è¾ƒ</h3>
<h4 data-id="heading-36">eq and ne</h4>
<p>pythonå°†æ¯”è¾ƒå¤§å°çš„è¡Œä¸ºç§°ä¸º Rich Comparison</p>
<p>Rich Comparisonä¸€å…±æœ‰6ä¸ªæ“ä½œç¬¦</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-built_in">object</span>.__lt__(self, other)  <span class="hljs-comment"># &lt;</span>
<span class="hljs-built_in">object</span>.__le__(self, other)  <span class="hljs-comment"># &lt;=</span>
<span class="hljs-built_in">object</span>.__eq__(self, other)  <span class="hljs-comment"># ==</span>
<span class="hljs-built_in">object</span>.__ne__(self, other)  <span class="hljs-comment"># !=</span>
<span class="hljs-built_in">object</span>.__gt__(self, other)  <span class="hljs-comment"># &gt;</span>
<span class="hljs-built_in">object</span>.__ge__(self, other)  <span class="hljs-comment"># &gt;=</span>
</code></pre>
<p>æˆ‘ä»¬ä¸€èˆ¬ç”¨äºè‡ªå®šä¹‰çš„å¯¹è±¡æ¯”è¾ƒ</p>
<p>å› ä¸ºåœ¨pythonä¸­æˆ‘ä»¬åœ¨æ²¡æœ‰å®ç°ä¸€ä¸ªç±»çš„æ¯”è¾ƒè¿ç®—ç¬¦æ—¶, ä»–é»˜è®¤è°ƒç”¨çš„æ˜¯<code>is</code></p>
<p>è€Œ<code>is</code> çš„è¿ç®—:</p>
<blockquote>
<p>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ç›¸åº”çš„æ ‡è¯†å·ã€ç±»å‹å’Œå€¼ã€‚ ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºåå®ƒçš„ <em>æ ‡è¯†å·</em> å°±ç»ä¸ä¼šæ”¹å˜ï¼›ä½ å¯ä»¥å°†å…¶ç†è§£ä¸ºè¯¥å¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚ <code>is</code> è¿ç®—ç¬¦æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„æ ‡è¯†å·æ˜¯å¦ç›¸åŒï¼›<code>id()</code> å‡½æ•°è¿”å›ä¸€ä¸ªä»£è¡¨å…¶æ ‡è¯†å·çš„æ•´æ•°ã€‚</p>
<p>åœ¨ CPython ä¸­ï¼Œ<code>id(x)</code> å°±æ˜¯å­˜æ”¾ <code>x</code> çš„å†…å­˜çš„åœ°å€</p>
</blockquote>
<p>æ‰€ä»¥</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Date</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, year, month, day</span>):
        self.year = year
        self.month = month
        self.day = day


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    d1 = Date(<span class="hljs-number">2025</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>)
    d2 = Date(<span class="hljs-number">2025</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>)
    <span class="hljs-built_in">print</span>(d1 == d2)  <span class="hljs-comment"># False</span>
    <span class="hljs-comment"># equals</span>
    <span class="hljs-built_in">print</span>(d1 <span class="hljs-keyword">is</span> d2)  <span class="hljs-comment"># False</span>
</code></pre>
<ul>
<li><code>__eq__</code></li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Date</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, year, month, day</span>):
        self.year = year
        self.month = month
        self.day = day

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-comment"># override = operator</span>
        <span class="hljs-keyword">return</span> (self.year == other.year <span class="hljs-keyword">and</span>
                self.month == other.month <span class="hljs-keyword">and</span>
                self.day == other.day)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    d1 = Date(<span class="hljs-number">2025</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>)
    d2 = Date(<span class="hljs-number">2025</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>)
    <span class="hljs-built_in">print</span>(d1 == d2)  <span class="hljs-comment"># True</span>
    <span class="hljs-comment"># if obj not override __eq__(equals), python will call is</span>
    <span class="hljs-built_in">print</span>(d1 <span class="hljs-keyword">is</span> d2)  <span class="hljs-comment"># False</span>

</code></pre>
<blockquote>
<p>[!note]</p>
<p>pythonå¯¹äºè¿™äº› Rich Comparisonçš„æ–¹æ³•çš„è¿”å›å€¼æ²¡æœ‰åšçº¦æŸ, å¸¸è§„æƒ…å†µä¸‹, æˆ‘ä»¬ä¼šä½¿ç”¨ä¸€ä¸ªboolean.</p>
<p>ä½†åœ¨ä¸€äº›ç‰¹æ®Šåœºæ™¯, æˆ‘ä»¬å¯èƒ½ä½¿ç”¨ä¸€äº›ébooleanå€¼, åšä¸€äº›hack</p>
<p>ä¾‹å¦‚å‘é‡ä¹‹é—´çš„æ¯”è¾ƒ, æˆ‘ä»¬å¯èƒ½å°±ä¼šè¿”å›ä¸€ä¸ªå‘é‡</p>
</blockquote>
<ul>
<li><code>__ne__</code></li>
</ul>
<p>é»˜è®¤æƒ…å†µä¸‹, å¦‚æœæ²¡æœ‰å®ç°è¯¥æ–¹æ³•æ—¶, å¯¹äº <code>__ne__()</code> , é»˜è®¤ä¼šå§”æ‰˜ç»™ <code>__eq__()</code> å¹¶å¯¹ç»“æœå–å</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-built_in">print</span>(d1 != d2)  <span class="hljs-comment"># equal !d1.__eq__(d2)</span>
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Date</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, year, month, day</span>):
        self.year = year
        self.month = month
        self.day = day

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__ne__</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-comment"># override != operator</span>
        <span class="hljs-keyword">return</span> (self.year != other.year <span class="hljs-keyword">or</span>
                self.month != other.month <span class="hljs-keyword">or</span>
                self.day != other.day)
</code></pre>
<h4 data-id="heading-37">gt and lt</h4>
<ul>
<li><code>__gt__</code> &amp; <code>__lt__</code></li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Date</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, year, month, day</span>):
        self.year = year
        self.month = month
        self.day = day

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-comment"># override == operator</span>
        <span class="hljs-keyword">return</span> (self.year == other.year <span class="hljs-keyword">and</span>
                self.month == other.month <span class="hljs-keyword">and</span>
                self.day == other.day)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__ne__</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-comment"># override != operator</span>
        <span class="hljs-keyword">return</span> (self.year != other.year <span class="hljs-keyword">or</span>
                self.month != other.month <span class="hljs-keyword">or</span>
                self.day != other.day)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__gt__</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"__gt__"</span>)
        <span class="hljs-keyword">if</span> self.year &gt; other.year:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">if</span> self.year == other.year:
            <span class="hljs-keyword">if</span> self.month &gt; other.month:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
            <span class="hljs-keyword">if</span> self.month == other.month:
                <span class="hljs-keyword">return</span> self.day &gt; other.day

        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__lt__</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"__lt__"</span>)
        <span class="hljs-keyword">if</span> self.year &lt; other.year:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">if</span> self.year == other.year:
            <span class="hljs-keyword">if</span> self.month &lt; other.month:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
            <span class="hljs-keyword">if</span> self.month == other.month:
                <span class="hljs-keyword">return</span> self.day &lt; other.day

        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

      
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    d1 = Date(<span class="hljs-number">2025</span>, <span class="hljs-number">4</span>, <span class="hljs-number">20</span>)
    d2 = Date(<span class="hljs-number">2025</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>)
    <span class="hljs-built_in">print</span>(d1 &gt; d2)  <span class="hljs-comment"># False</span>
    <span class="hljs-built_in">print</span>(d1 &lt; d2)  <span class="hljs-comment"># True</span>
</code></pre>
<p><code>d1 &lt; d2</code> å¯¹äº<code>d1</code>è€Œè¨€æ˜¯å°äºå·, ä½†æ˜¯å¯¹äº<code>d2</code>æ˜¯å¤§äºå·. é‚£pythonå¦‚ä½•ç¡®å®šä½¿ç”¨ä»€ä¹ˆç¬¦å·å‘¢?</p>
<p>å¯¹äºè¿™æ ·çš„è¡¨è¾¾å¼</p>
<pre><code class="hljs language-python" lang="python">x &lt; y
</code></pre>
<p>å¦‚æœx, yä¸æ˜¯åŒä¸€ä¸ªç±»çš„å¯¹è±¡, å¦‚æœyæ˜¯xçš„è¡ç”Ÿç±», é‚£ä¼˜å…ˆä½¿ç”¨yçš„Rich Comparison</p>
<blockquote>
<p>å¦‚æœä¸¤ä¸ªæ“ä½œæ•°çš„ç±»å‹ä¸åŒ, ä¸”å³æ“ä½œæ•°çš„ç±»å‹æ˜¯å·¦æ“ä½œæ•°ç±»å‹çš„ç›´æ¥æˆ–é—´æ¥å­ç±», åˆ™ä¼˜å…ˆé€‰æ‹©å³æ“ä½œæ•°çš„åå°„æ–¹æ³•, åœ¨å…¶ä»–æƒ…å†µä¸‹ä¼˜å…ˆé€‰æ‹©å·¦æ“ä½œæ•°çš„æ–¹æ³•</p>
</blockquote>
<p>ä¾‹å¦‚, æˆ‘ä»¬å®šä¹‰å¦‚ä¸‹çš„ç±»</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Date</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, year, month, day</span>):
        self.year = year
        self.month = month
        self.day = day

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__gt__</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"__gt__"</span>)
        <span class="hljs-built_in">print</span>(
            <span class="hljs-string">f'self info: year: <span class="hljs-subst">{self.year}</span>, month: <span class="hljs-subst">{self.month}</span>, day: <span class="hljs-subst">{self.day}</span>'</span>)
        <span class="hljs-built_in">print</span>(
            <span class="hljs-string">f'other info: year: <span class="hljs-subst">{other.year}</span>, month: <span class="hljs-subst">{other.month}</span>, day: <span class="hljs-subst">{other.day}</span>'</span>)
        <span class="hljs-keyword">if</span> self.year &gt; other.year:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">if</span> self.year == other.year:
            <span class="hljs-keyword">if</span> self.month &gt; other.month:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
            <span class="hljs-keyword">if</span> self.month == other.month:
                <span class="hljs-keyword">return</span> self.day &gt; other.day

        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__lt__</span>(<span class="hljs-params">self, other</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"__lt__"</span>)
        <span class="hljs-built_in">print</span>(
            <span class="hljs-string">f'self info: year: <span class="hljs-subst">{self.year}</span>, month: <span class="hljs-subst">{self.month}</span>, day: <span class="hljs-subst">{self.day}</span>'</span>)
        <span class="hljs-built_in">print</span>(
            <span class="hljs-string">f'other info: year: <span class="hljs-subst">{other.year}</span>, month: <span class="hljs-subst">{other.month}</span>, day: <span class="hljs-subst">{other.day}</span>'</span>)

        <span class="hljs-keyword">if</span> self.year &lt; other.year:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">if</span> self.year == other.year:
            <span class="hljs-keyword">if</span> self.month &lt; other.month:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
            <span class="hljs-keyword">if</span> self.month == other.month:
                <span class="hljs-keyword">return</span> self.day &lt; other.day

        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>


<span class="hljs-comment"># define a subclass of Date</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SubDate</span>(<span class="hljs-title class_ inherited__">Date</span>):
    <span class="hljs-keyword">pass</span>
  
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    d1 = Date(<span class="hljs-number">2025</span>, <span class="hljs-number">4</span>, <span class="hljs-number">20</span>)
    nd = SubDate(<span class="hljs-number">2025</span>, <span class="hljs-number">1</span>, <span class="hljs-number">20</span>)

    <span class="hljs-built_in">print</span>(d1 &lt; nd)
</code></pre>
<p>è¾“å‡º</p>
<pre><code class="hljs language-python" lang="python">__gt__
self info: year: <span class="hljs-number">2025</span>, month: <span class="hljs-number">1</span>, day: <span class="hljs-number">20</span> 
other info: year: <span class="hljs-number">2025</span>, month: <span class="hljs-number">4</span>, day: <span class="hljs-number">20</span>
<span class="hljs-literal">False</span>
</code></pre>
<p>æ‰€ä»¥, å› ä¸ºndæ˜¯d1çš„å­ç±», ä»ç»“æœå¯ä»¥çœ‹è§, è°ƒç”¨çš„æ˜¯å­ç±»çš„æ–¹æ³•.</p>
<h4 data-id="heading-38">hash</h4>
<p>æˆ‘ä»¬æœ€é•¿ä½¿ç”¨hashçš„åœºæ™¯å°±æ˜¯å°†ä¸€ä¸ªå¯¹è±¡çš„hashä½œä¸ºå­—å…¸çš„key</p>
<p>pythonå¯¹äºæ¯ä¸ªè‡ªå®šä¹‰çš„ç±»éƒ½é»˜è®¤ç”Ÿæˆäº†ä¸€ä¸ªhash ä»¥åŠ eqå‡½æ•°, ä½†å¦‚æœæˆ‘ä»¬é‡å†™äº†eq, é‚£é»˜è®¤ç”Ÿæˆçš„hashå°±ä¸ä¼šç”Ÿæˆäº†.</p>
<p>å› ä¸ºhashçš„å®šä¹‰æ˜¯. å¦‚æœ2ä¸ªå¯¹è±¡ç›¸ç­‰, é‚£ä»–çš„hashåº”è¯¥ä¸€è‡´. è€Œå¦‚æœæˆ‘ä»¬è‡ªå®šä¹‰äº†eq, é‚£pythonå¹¶ä¸çŸ¥é“æˆ‘ä»¬æ˜¯å¦ä¼šä½¿ç”¨hash, æ‰€ä»¥ä¸¢å¼ƒäº†é»˜è®¤ç”Ÿæˆçš„hash.</p>
<p>ä½†å¦‚æœæˆ‘ä»¬å¸Œæœ›å°†objä½œä¸ºdictçš„key, é™¤äº†å®šä¹‰eqå¤–, è¿˜è¦å®šä¹‰hash</p>
<p>hashçš„è¦æ±‚:</p>
<ol>
<li>è¿”å›ä¸€ä¸ªæ•´æ•°</li>
<li>2ä¸ªç›¸åŒå¯¹è±¡çš„hashä¸€å®šè¦ä¸€è‡´.</li>
</ol>
<p>pythonå®˜æ–¹çš„å»ºè®®æ˜¯, ä½¿ç”¨å†…ç½®çš„hashæ–¹æ³•. å°†æˆ‘ä»¬å¯¹è±¡çš„æ ¸å¿ƒå±æ€§ç»„æˆä¸€ä¸ªtuple, è¿›è¡Œè®¡ç®—, ç„¶åè¿”å›.</p>
<blockquote>
<p>[!note]</p>
<p>å¦‚æœ å¯¹è±¡æœ¬èº«å°±æ˜¯ mutable , é‚£æˆ‘ä»¬åº”è¯¥æ€è€ƒä¸ºä½•è¦å°†ä¸€ä¸ªmutableçš„å¯¹è±¡ä½œä¸ºkey?</p>
<p>è¿™é‡Œæ˜¯æŒ‡æ˜¯å¦å½“æˆmutableä½¿ç”¨, å› ä¸ºpythonä¸­æ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯mutableçš„å˜›.</p>
<p>è¿™æ˜¯ä¸€ä¸ªåˆæ³•, ä½†ä¸å¤ªèªæ˜çš„è¡Œä¸º.</p>
</blockquote>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Date</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, year, month, day</span>):
        self.year = year
        self.month = month
        self.day = day

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"Date[year: <span class="hljs-subst">{self.year}</span>, month: <span class="hljs-subst">{self.month}</span>, day: <span class="hljs-subst">{self.day}</span>]"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__hash__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">hash</span>((self.year, self.month, self.day))

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__bool__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># using the method of if segement </span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"__bool__"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
      

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    d1 = Date(<span class="hljs-number">2025</span>, <span class="hljs-number">5</span>, <span class="hljs-number">21</span>)
    d2 = Date(<span class="hljs-number">2025</span>, <span class="hljs-number">5</span>, <span class="hljs-number">21</span>)

    <span class="hljs-comment"># a dict</span>
    income = {}
    income[d1] = <span class="hljs-number">100</span>
    income[d2] = <span class="hljs-number">100</span>
    <span class="hljs-built_in">print</span>(income)

    <span class="hljs-keyword">if</span> (d1):
        <span class="hljs-comment"># equal bool(d1) === d1.__bool__()</span>
        <span class="hljs-keyword">pass</span>
</code></pre>
<h3 data-id="heading-39">å±æ€§</h3>
<ul>
<li><code>__getattr__</code></li>
</ul>
<p>è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶, æˆ‘ä»¬è¯¥åšä»€ä¹ˆ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, desc</span>):
        self.desc = desc
        self.counter = <span class="hljs-number">0</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"the name properties not exist"</span>)
        <span class="hljs-keyword">raise</span> AttributeError()


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    a = A(<span class="hljs-string">"alice"</span>)
    <span class="hljs-built_in">print</span>(a.name)
</code></pre>
<ul>
<li><code>__getattribute__</code></li>
</ul>
<blockquote>
<p>æ­¤æ–¹æ³•ä¼šæ— æ¡ä»¶åœ°è¢«è°ƒç”¨ä»¥å®ç°å¯¹ç±»å®ä¾‹å±æ€§çš„è®¿é—®ã€‚å¦‚æœç±»è¿˜å®šä¹‰äº† <code>__getattr__()</code>ï¼Œåˆ™åè€…ä¸ä¼šè¢«è°ƒç”¨ï¼Œé™¤é <code>__getattribute__()</code> æ˜¾å¼åœ°è°ƒç”¨å®ƒæˆ–æ˜¯å¼•å‘äº† <code>AttributeError</code>ã€‚æ­¤æ–¹æ³•åº”å½“è¿”å›ï¼ˆæ‰¾åˆ°çš„ï¼‰å±æ€§å€¼æˆ–æ˜¯å¼•å‘ä¸€ä¸ª <code>AttributeError</code> å¼‚å¸¸ã€‚ä¸ºäº†é¿å…æ­¤æ–¹æ³•ä¸­çš„æ— é™é€’å½’ï¼Œå…¶å®ç°åº”è¯¥æ€»æ˜¯è°ƒç”¨å…·æœ‰ç›¸åŒåç§°çš„åŸºç±»æ–¹æ³•æ¥è®¿é—®å®ƒæ‰€éœ€è¦çš„ä»»ä½•å±æ€§ï¼Œä¾‹å¦‚ <code>object.__getattribute__(name)</code></p>
</blockquote>
<p><strong>æ³¨æ„ä¸è¦ä½¿ç”¨getattr(self, name)å‡½æ•°, å› ä¸ºå®ƒä¼šè°ƒç”¨</strong><code>__getattribute__</code><strong>, ä»è€Œäº§ç”Ÿä¸€ä¸ªæ— é™é€’å½’</strong></p>
<p><strong>å¦‚æœéœ€è¦è·å–å½“å‰å±æ€§, éœ€è¦é€šè¿‡superçš„æ–¹å¼è°ƒç”¨</strong><code>super().__getattribute__(name)</code>. å½“ç„¶ä½¿ç”¨<code>object.__getattribute__(name)</code> ä¹Ÿæ˜¯å…è®¸çš„</p>
<p>ä¸‹é¢è¿™ç§ä¹Ÿæ˜¯ä¸€ç§é€’å½’è°ƒç”¨!</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, desc</span>):
        self.desc = desc
        self.counter = <span class="hljs-number">0</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-keyword">pass</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattribute__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"__getattribute__"</span>)
        <span class="hljs-comment"># æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›ç»Ÿè®¡å±æ€§çš„è®¿é—®æ¬¡æ•°. å¯èƒ½ä¼šå†™å‡ºå¦‚ä¸‹çš„ä»£ç </span>
        self.counter += <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().__getattribute__(name)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    a = A(<span class="hljs-string">"alice"</span>)
    <span class="hljs-built_in">print</span>(a.desc)
</code></pre>
<p>å› ä¸º<code>self.counter += 1</code> è¿™ä¸ªæ“ä½œä¼šè§¦å‘ <code>__getattribute__</code> è°ƒç”¨.</p>
<ul>
<li><code>__setattr__</code></li>
</ul>
<blockquote>
<p>æ­¤æ–¹æ³•åœ¨ä¸€ä¸ªå±æ€§è¢«å°è¯•èµ‹å€¼æ—¶è¢«è°ƒç”¨ã€‚è¿™ä¸ªè°ƒç”¨ä¼šå–ä»£æ­£å¸¸æœºåˆ¶ï¼ˆå³å°†å€¼ä¿å­˜åˆ°å®ä¾‹å­—å…¸ï¼‰ã€‚ <em>name</em> ä¸ºå±æ€§åç§°ï¼Œ <em>value</em> ä¸ºè¦èµ‹ç»™å±æ€§çš„å€¼ã€‚</p>
<p>å¦‚æœ <code>__setattr__()</code> æƒ³è¦èµ‹å€¼ç»™ä¸€ä¸ªå®ä¾‹å±æ€§ï¼Œå®ƒåº”è¯¥è°ƒç”¨åŒåçš„åŸºç±»æ–¹æ³•ï¼Œä¾‹å¦‚ <code>object.__setattr__(self, name, value)</code></p>
</blockquote>
<p>åœ¨ç¤¾åŒºçš„ä¸€äº›ç¼–å†™è¿‡ç¨‹ä¸­, æˆ‘ä»¬é€šå¸¸å¯èƒ½ä½¿ç”¨<code>super().__setattr__(name, value)</code>è¿™ç§æ–¹å¼æ›¿ä»£æˆ‘ä»¬çš„object...çš„å½¢å¼, å› ä¸ºæˆ‘ä»¬çš„ç±»å¯èƒ½æ˜¯å­˜åœ¨å¤šå±‚ç»§æ‰¿çš„å…³ç³»å˜›.</p>
<p>è€Œè¯¥special methodæ›´å¤šçš„æ˜¯ç”¨äºæ‹¦æˆªæˆ‘ä»¬çš„èµ‹å€¼è¡Œä¸º, ä»è€Œå®ç°ä¸€äº›å§”æ‰˜ä»£ç†çš„å‘³é“.</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, desc</span>):
        self.desc = desc
        self.counter = <span class="hljs-number">0</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-keyword">pass</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattribute__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-keyword">pass</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__setattr__</span>(<span class="hljs-params">self, name, value</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"__setattr__"</span>)
        <span class="hljs-comment"># å®Œæˆèµ‹å€¼è¡Œä¸ºçš„é»˜è®¤å®šä¹‰. å®ç°å…·ä½“çš„èµ‹å€¼åŠŸèƒ½</span>
        <span class="hljs-built_in">super</span>().__setattr__(name, value)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    a = A(<span class="hljs-string">"alice"</span>)
    a.desc = <span class="hljs-string">"hello, world!"</span>
    <span class="hljs-built_in">print</span>(a.desc)
    <span class="hljs-built_in">print</span>(a.name)  <span class="hljs-comment"># error </span>
</code></pre>
<p>å› ä¸º<code>__setattr__</code>å¯ä»¥æ‹¦æˆªèµ‹å€¼æ“ä½œ, æ‰€ä»¥æœ‰æ—¶å€™æˆ‘ä»¬å¯ä»¥åšä¸€äº›ç¥å¥‡çš„ä¸œè¥¿. ä¾‹å¦‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:
    _attr = {}

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.data = <span class="hljs-string">"alice"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-keyword">if</span> name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self._attr:
            <span class="hljs-keyword">raise</span> AttributeError
        <span class="hljs-comment"># Note: call __getattribute__</span>
        <span class="hljs-keyword">return</span> self._attr[name]

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__setattr__</span>(<span class="hljs-params">self, name, value</span>):
        self._attr[name] = value


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    o1 = A()
    o2 = A()
    o1.data = <span class="hljs-string">"Bob"</span>
    <span class="hljs-built_in">print</span>(o2.data)  <span class="hljs-comment"># Bob</span>
</code></pre>
<p>æˆ‘ä»¬çš„<code>_attr</code>å±æ€§æ˜¯å±äºAè¿™ä¸ªclassçš„. ä»–æ²¡æœ‰å’Œselfå…³è”, è¿™æ„å‘³ç€æ‰€æœ‰åŸºäºA Classåˆ›å»ºçš„objectéƒ½æ‹¥æœ‰è¿™ä¸ª<code>_attr</code>å±æ€§</p>
<p>è€Œæˆ‘ä»¬å¯¹æ¯ä¸ªobjectçš„å±æ€§èµ‹å€¼, æœ€ç»ˆéƒ½ä¼šæŒ‚è½½åˆ°æˆ‘ä»¬çš„<code>_attr</code>ä¸Š. æ˜¯ä¸æ˜¯å¾ˆç¥å¥‡.</p>
<p>è¿˜æœ‰åœ¨<code>__getattr__</code>ä¸­è°ƒç”¨çš„<code>self._attr[name]</code> ä¼šè°ƒç”¨ç³»ç»Ÿæä¾›çš„ <code>__getattribute__</code> ä»è€Œä¸ä¼šå‡ºç°é€’å½’è°ƒç”¨</p>
<ul>
<li><code>__delattr__</code></li>
</ul>
<p>åœ¨ä¸€ä¸ªå¯¹è±¡æ­£å¸¸çš„äº§ç”Ÿå’Œæ¶ˆäº¡, å¹¶ä¸ä¼šè°ƒç”¨è¯¥æ–¹æ³•</p>
<p>ä»–æ˜¯åœ¨æˆ‘ä»¬å°è¯•åˆ é™¤ä¸€ä¸ªobjectå±æ€§, å®ƒæ‰ä¼šè°ƒç”¨</p>
<p>getattr è¿™ä¸ª special method ä¼šç»å¸¸ç”¨äºæˆ‘ä»¬å°è£…ä¸€äº› wrapper çš„æ–¹æ³•ï¼Œä¾‹å¦‚ Dify åœ¨è®¾è®¡å®ƒä»¬çš„ Redis å®¢æˆ·ç«¯çš„æ—¶å€™ï¼Œè€ƒè™‘åˆ° python æ¨¡å—åŠ è½½çš„ç‰¹æ®Šæ€§ï¼Œæ‰€ä»¥ä½¿ç”¨ Wrapper åŒ…è£¹å…·ä½“çš„ redis å®¢æˆ·ç«¯ï¼Œå…·ä½“å®ç°ä¸ºï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> TYPE_CHECKING:
    <span class="hljs-keyword">from</span> redis.lock <span class="hljs-keyword">import</span> Lock

logger = logging.getLogger(__name__)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisClientWrapper</span>:
    <span class="hljs-string">"""
    A wrapper class for the Redis client that addresses the issue where the global
    `redis_client` variable cannot be updated when a new Redis instance is returned
    by Sentinel.

    This class allows for deferred initialization of the Redis client, enabling the
    client to be re-initialized with a new instance when necessary. This is particularly
    useful in scenarios where the Redis instance may change dynamically, such as during
    a failover in a Sentinel-managed Redis setup.

    Attributes:
        _client: The actual Redis client instance. It remains None until
                 initialized with the `initialize` method.

    Methods:
        initialize(client): Initializes the Redis client if it hasn't been initialized already.
        __getattr__(item): Delegates attribute access to the Redis client, raising an error
                           if the client is not initialized.
    """</span>

    _client: <span class="hljs-type">Union</span>[redis.Redis, RedisCluster, <span class="hljs-literal">None</span>]

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-literal">None</span>:
        self._client = <span class="hljs-literal">None</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">self, client: <span class="hljs-type">Union</span>[redis.Redis, RedisCluster]</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">if</span> self._client <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            self._client = client

    <span class="hljs-keyword">if</span> TYPE_CHECKING:
        <span class="hljs-comment"># Type hints for IDE support and static analysis</span>
        <span class="hljs-comment"># These are not executed at runtime but provide type information</span>
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span> | <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-type">Any</span>: ...

        ...

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, item: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Any</span>:
        <span class="hljs-keyword">if</span> self._client <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">"Redis client is not initialized. Call init_app first."</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(self._client, item)


redis_client: RedisClientWrapper = RedisClientWrapper()


...
</code></pre>
<h2 data-id="heading-40">WSGI &amp; ASGI</h2>
<p>ä¸€ä¸ªWebåº”ç”¨çš„æœ¬è´¨å°±æ˜¯ï¼š</p>
<ul>
<li>æµè§ˆå™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚ï¼›</li>
<li>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œç”Ÿæˆä¸€ä¸ªHTMLæ–‡æ¡£ï¼›</li>
<li>æœåŠ¡å™¨æŠŠHTMLæ–‡æ¡£ä½œä¸ºHTTPå“åº”çš„Bodyå‘é€ç»™æµè§ˆå™¨ï¼›</li>
<li>æµè§ˆå™¨æ”¶åˆ°HTTPå“åº”ï¼Œä»HTTP Bodyå–å‡ºHTMLæ–‡æ¡£å¹¶æ˜¾ç¤ºã€‚</li>
</ul>
<p>è€Œå¸¸è§„çš„webæœåŠ¡å™¨ä¼šå¸®æˆ‘å®ç°å¥½ä¸€äº›åŸºç¡€çš„æ“ä½œï¼Œä¾‹å¦‚<br/>
æ¥å—HTTPè¯·æ±‚ã€è§£æHTTPè¯·æ±‚ã€å‘é€HTTPå“åº”</p>
<p>å½“ç„¶æˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ï¼Œä½†æ˜¯è¿™äº›å†…å®¹å¹¶ä¸å®¹æ˜“ã€‚æˆ‘ä»¬éœ€è¦å¯¹TCP, HTTPï¼ŒHTTPS ç­‰è§„èŒƒæœ‰ç€æ·±åˆ»çš„ç†è§£</p>
<p>å¤§éƒ¨åˆ†åº”ç”¨ä¼šå°†è¿™äº›å°è£…å¥½ï¼Œå¯¹æˆ‘ä»¬ä¸Šå±‚å¼€å‘è€…æä¾›å¯¹åº”çš„æ¥å£ï¼Œä»è€Œæ–¹ä¾¿æˆ‘ä»¬ç¼–å†™å¯¹åº”çš„webä¸šåŠ¡ã€‚<br/>
ä½†ä¸åŒçš„æœåŠ¡å™¨å¯èƒ½ä¼šæä¾›ä¸åŒçš„æ¥å£ï¼Œè¿™é‡Œè¯­è¨€çš„è®¾è®¡å›¢é˜Ÿä¸€èˆ¬ä¼šæä¾›ä¸€å¥—è®¾è®¡å¥½çš„æ¥å£ï¼Œä»è€Œä½¿å¾—æ¯ä¸ª<br/>
webæœåŠ¡æä¾›çš„ä¸Šå±‚æ¥å£æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>pythonä¸­webæ¥å£æœ‰ï¼š</p>
<ul>
<li>WSGIï¼šWeb Server Gateway Interfaceï¼šPEP 3333ï¼ˆ2003å¹´æå‡ºï¼Œç”¨äºåŒæ­¥ï¼‰</li>
<li>ASGIï¼šAsynchronous Server Gateway Interfaceï¼šç”± Django Channels å›¢é˜Ÿå‘èµ·ï¼Œç°å·²æˆä¸ºå¼‚æ­¥ Python Web çš„äº‹å®æ ‡å‡†</li>
</ul>
<p>è¿™æ ·webæœåŠ¡å™¨å¼€å‘å’Œwebæ¡†æ¶çš„å¼€å‘å°±æ˜¯åˆ†ç¦»ï¼Œä¾‹å¦‚ FastAPI æ˜¯ä¸€ä¸ªwebæ¡†æ¶ï¼Œå®ƒåŸºäºASGIå®ç°ï¼Œè€ŒASGIå¯¹åº”çš„æœåŠ¡å™¨æœ‰uvicorn, Daphneï¼Œ Hypercorn<br/>
æˆ–è®¸æœªæ¥æœ‰æ›´é«˜æ•ˆçš„ASGIæœåŠ¡å™¨ï¼Œé‚£fastAPIä¹Ÿå¯ä»¥æ— ç¼è¡”æ¥ã€‚<br/>
æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">pip install fastapi
pip install hypercorn
pip install uvicorn
</code></pre>
<p>ç¤ºä¾‹ä»£ç </p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI
<span class="hljs-comment"># hypercornçš„å¯åŠ¨</span>
<span class="hljs-keyword">from</span> hypercorn.config <span class="hljs-keyword">import</span> Config
<span class="hljs-keyword">from</span> hypercorn.asyncio <span class="hljs-keyword">import</span> serve
<span class="hljs-keyword">import</span> asyncio

app = FastAPI()


<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/hello"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>():
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"desc"</span>: <span class="hljs-string">"hello, world"</span>
    }


<span class="hljs-comment"># æ–¹å¼ 1ï¼šä½¿ç”¨ asyncio + serveï¼ˆæ¨èï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    config = Config()
    config.bind = [<span class="hljs-string">"0.0.0.0:8000"</span>]
    config.workers = <span class="hljs-number">1</span>  <span class="hljs-comment"># æ³¨æ„ï¼šasyncio serve æœ¬èº«æ˜¯å•è¿›ç¨‹ï¼Œworkers åœ¨è¿™é‡Œæ— æ•ˆ</span>
    <span class="hljs-comment"># è¿™é‡Œå¯èƒ½ä¼šæœ‰è­¦å‘Šï¼Œå› ä¸ºstarletteå’Œhypercornçš„ç±»å‹å£°æ˜ä¸å®Œå…¨ä¸€è‡´ï¼Œä½†ç¬¦åˆASGIè¦å»</span>
    <span class="hljs-comment"># ASGI https://asgi.readthedocs.io/en/latest/specs/main.html#applications</span>
    <span class="hljs-comment"># receive: an awaitable callable that will yield a new event dictionary when one is available</span>
    <span class="hljs-comment"># receiveï¼šè°ƒç”¨ä¸€æ¬¡ receive()ï¼Œawait ä¸€æ¬¡ï¼Œå¾—åˆ°ä¸€ä¸ªäº‹ä»¶å­—å…¸</span>
    <span class="hljs-comment"># åªè¦å®šä¹‰å¦‚ä¸‹çš„ ç±»å‹ å£°æ˜å°±å¯ä»¥äº†</span>
    <span class="hljs-comment"># from typing import Callable, Awaitable, Dict, Any</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># Receive = Callable[[], Awaitable[Dict[str, Any]]]</span>
    <span class="hljs-keyword">await</span> serve(app, config)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">application</span>(<span class="hljs-params">environ, start_response</span>):
    <span class="hljs-string">"""

    :param environï¼šä¸€ä¸ªåŒ…å«æ‰€æœ‰HTTPè¯·æ±‚ä¿¡æ¯çš„dictå¯¹è±¡ï¼›
    :param start_responseï¼šä¸€ä¸ªå‘é€HTTPå“åº”çš„å‡½æ•°ã€‚
    :return: æœ‰äº†WSGIï¼Œæˆ‘ä»¬å…³å¿ƒçš„å°±æ˜¯å¦‚ä½•ä»environè¿™ä¸ªdictå¯¹è±¡æ‹¿åˆ°HTTPè¯·æ±‚ä¿¡æ¯ï¼Œç„¶åæ„é€ HTMLï¼Œé€šè¿‡start_response()å‘é€Headerï¼Œæœ€åè¿”å›Body
    é€šè¿‡è°ƒç”¨ä¸€äº›å®ç°äº†WSGIçš„æœåŠ¡å™¨ï¼Œåº•å±‚ä»£ç ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±ç¼–å†™ï¼Œæˆ‘ä»¬åªè´Ÿè´£åœ¨æ›´é«˜å±‚æ¬¡ä¸Šè€ƒè™‘å¦‚ä½•å“åº”è¯·æ±‚å°±å¯ä»¥äº†

    """</span>

    <span class="hljs-comment"># ä»è¯·æ±‚ä¸­è·å–ä¸€äº›ä¿¡æ¯ï¼ŒåŠ¨æ€è¿”å›å†…å®¹</span>
    path = environ[<span class="hljs-string">"PATH_INFO"</span>][<span class="hljs-number">1</span>:] <span class="hljs-keyword">or</span> <span class="hljs-string">"world"</span>

    <span class="hljs-comment"># è®¾ç½®è¿”å›çš„å“åº”å¤´</span>
    start_response(<span class="hljs-string">'200 OK'</span>, [(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/html'</span>)])
    <span class="hljs-comment"># è®¾ç½®è¿”å›çš„å“åº”body</span>
    resp_body = <span class="hljs-string">f"&lt;h1&gt;Hello, <span class="hljs-subst">{path}</span>&lt;/h1&gt;"</span>
    <span class="hljs-keyword">return</span> [resp_body.encode()]


<span class="hljs-keyword">def</span> <span class="hljs-title function_">wsgiServer</span>():
    <span class="hljs-comment"># ä»wsgirefæ¨¡å—å¯¼å…¥:</span>
    <span class="hljs-keyword">from</span> wsgiref.simple_server <span class="hljs-keyword">import</span> make_server

    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼ŒIPåœ°å€ä¸ºç©ºï¼Œç«¯å£æ˜¯8000ï¼Œå¤„ç†å‡½æ•°æ˜¯application:</span>
    httpd = make_server(<span class="hljs-string">''</span>, <span class="hljs-number">8000</span>, application)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'Serving HTTP on port 8000...'</span>)
    <span class="hljs-comment"># å¼€å§‹ç›‘å¬HTTPè¯·æ±‚:</span>
    httpd.serve_forever()


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-comment"># import uvicorn</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># uvicorn.run("WSGI_interface_learn:app")</span>

    <span class="hljs-comment"># hypercornçš„å¯åŠ¨</span>
    <span class="hljs-comment"># asyncio.run(main())</span>

    <span class="hljs-comment"># å®˜æ–¹çš„wsgiref çš„å¯åŠ¨ï¼Œè¯¥æœåŠ¡å™¨æ˜¯pythonå®˜æ–¹åŸºäºWSGIæ¥å£å®ç°çš„ä¸€ä¸ªç®€æ˜“çš„æœåŠ¡å™¨</span>
    wsgiServer()
</code></pre>
<p>è¿™é‡Œå› ä¸º FastAPI æ˜¯åŸºäº ASGI æ¥å£è¿›è¡Œçš„å¼€å‘ï¼Œæ‰€ä»¥åªè¦ä»»ä½•å®ç°äº†è¯¥æ¥å£çš„æœåŠ¡å™¨ï¼Œéƒ½å¯ä»¥è¿è¡Œ FastAPI çš„ç¨‹åºï¼Œä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ uvicornï¼Œä»¥åŠhypercorn è¿›è¡Œäº†æµ‹è¯•</p>
<h2 data-id="heading-41">Coroutine</h2>
<p>ä¸ºäº†ç®€åŒ–è®²è§£ï¼Œæˆ‘ä»¬è¿™é‡Œå°†å¿½ç•¥å†…æ ¸çº¿ç¨‹ï¼Œç”¨æˆ·çº¿ç¨‹ç­‰ä¸“ä¸šçš„æ¦‚å¿µ</p>
<p>åç¨‹æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ</p>
<p>æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯åç¨‹æé«˜çš„æ‰§è¡Œæ•ˆç‡ã€‚å› ä¸ºå­ç¨‹åºåˆ‡æ¢ä¸æ˜¯çº¿ç¨‹åˆ‡æ¢ï¼Œè€Œæ˜¯ç”±ç¨‹åºè‡ªèº«æ§åˆ¶ï¼Œ</p>
<p>å› æ­¤ï¼Œæ²¡æœ‰çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œå’Œå¤šçº¿ç¨‹æ¯”ï¼Œçº¿ç¨‹æ•°é‡è¶Šå¤šï¼Œåç¨‹çš„æ€§èƒ½ä¼˜åŠ¿å°±è¶Šæ˜æ˜¾</p>
<p>ç¬¬äºŒå¤§ä¼˜åŠ¿å°±æ˜¯ä¸éœ€è¦å¤šçº¿ç¨‹çš„é”æœºåˆ¶ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿä¸å­˜åœ¨åŒæ—¶å†™å˜é‡å†²çªï¼ˆç«æ€æ¡ä»¶ï¼‰</p>
<p>åœ¨åç¨‹ä¸­æ§åˆ¶å…±äº«èµ„æºä¸åŠ é”ï¼Œåªéœ€è¦åˆ¤æ–­çŠ¶æ€å°±å¥½äº†ï¼Œæ‰€ä»¥æ‰§è¡Œæ•ˆç‡æ¯”å¤šçº¿ç¨‹é«˜å¾ˆå¤š</p>
<p>å› ä¸ºåç¨‹æ˜¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œæƒ³è¦åˆ©ç”¨å¤šæ ¸CPUã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯å¤šè¿›ç¨‹+åç¨‹ï¼Œå› ä¸º python å­˜åœ¨ GIL çš„å­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œéœ€è¦å¤šè¿›ç¨‹ã€‚ä»è€Œå……åˆ†åˆ©ç”¨å¤šæ ¸ï¼Œåˆå……åˆ†å‘æŒ¥åç¨‹çš„é«˜æ•ˆç‡ï¼Œå¯è·å¾—æé«˜çš„æ€§èƒ½</p>
<p>Pythonå¯¹åç¨‹çš„æ”¯æŒæ˜¯é€šè¿‡ generator å®ç°çš„ã€‚ä¹Ÿå°±æ˜¯ç”Ÿæˆå™¨ï¼Œè€Œç”Ÿæˆå™¨çš„è¯­æ³•æ ¸å¿ƒåœ¨yield, æ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆäº†è§£ yield, yield formæ˜¯ä»€ä¹ˆ</p>
<p>æ‰€ä»¥æˆ‘ä»¬å…ˆå­¦ä¹  Generator çš„å†…å®¹ï¼Œä¸è¿‡ generator ä¾èµ–æˆ‘ä»¬ä»¥å‰å­¦ä¹ çš„ iterator</p>
<p>ä» è¯¥ pep å¼€å§‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fpeps.python.org%2Fpep-0342%2F" target="_blank" title="https://peps.python.org/pep-0342/" ref="nofollow noopener noreferrer">peps.python.org/pep-0342/</a><br/>
å°† yield é‡æ–°å®šä¹‰ä¸ºè¡¨è¾¾å¼ï¼ˆexpressionï¼‰ï¼Œè€Œä¸æ˜¯è¯­å¥ï¼ˆstatementï¼‰ï¼Œä½†æ¯å½“ç”Ÿæˆå™¨é€šè¿‡æ­£å¸¸çš„ next() è°ƒç”¨æ¢å¤æ—¶ï¼Œyield è¡¨è¾¾å¼çš„å€¼éƒ½æ˜¯ None</p>
<p>è¡¨è¾¾å¼ç›¸è¾ƒäºè¯­å¥çš„å¥½å¤„å°±æ˜¯ï¼Œå¯ä»¥æœ‰è¿”å›å€¼</p>
<ul>
<li>send: ä¸ºç”Ÿæˆå™¨è¿­ä»£å™¨æ·»åŠ ä¸€ä¸ªæ–°çš„ send() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¢å¤ç”Ÿæˆå™¨å¹¶å‘é€ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼æˆä¸ºå½“å‰ yield-expression çš„ç»“æœã€‚</li>
<li>send()æ–¹æ³•è¿”å›ç”Ÿæˆå™¨äº§ç”Ÿçš„ä¸‹ä¸€ä¸ªå€¼ï¼Œæˆ–è€…å¦‚æœç”Ÿæˆå™¨é€€å‡ºè€Œæ²¡æœ‰äº§ç”Ÿå¦ä¸€ä¸ªå€¼ï¼Œåˆ™å¼•å‘ StopIteration</li>
</ul>
<p>**è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼šè°ƒç”¨ send(None) å®Œå…¨ç­‰åŒäºè°ƒç”¨ç”Ÿæˆå™¨çš„ next() æ–¹æ³•, å…¶æ¬¡ ç”±äºç”Ÿæˆå™¨è¿­ä»£å™¨åœ¨ç”Ÿæˆå™¨å‡½æ•°ä½“çš„é¡¶éƒ¨å¼€å§‹æ‰§è¡Œï¼Œ  **</p>
<p>**å› æ­¤å½“ç”Ÿæˆå™¨åˆšåˆšåˆ›å»ºæ—¶ï¼Œæ²¡æœ‰ yield è¡¨è¾¾å¼æ¥æ¥æ”¶å€¼ã€‚å› æ­¤ï¼Œå½“ç”Ÿæˆå™¨è¿­ä»£å™¨åˆšåˆšå¯åŠ¨æ—¶ï¼Œç¦æ­¢ä½¿ç”¨é None å‚æ•°è°ƒç”¨ send()ï¼Œ   **</p>
<p>**å¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œåˆ™ä¼šå¼•å‘ TypeErrorï¼ˆå¯èƒ½æ˜¯ç”±äºæŸç§é€»è¾‘é”™è¯¯ï¼‰ã€‚  **</p>
<p><strong>å› æ­¤ï¼Œåœ¨ä¸åç¨‹é€šä¿¡ä¹‹å‰ï¼Œå¿…é¡»å…ˆè°ƒç”¨ next() æˆ– send(None) å°†å…¶æ‰§è¡Œæ¨è¿›åˆ°ç¬¬ä¸€ä¸ª yield è¡¨è¾¾å¼</strong></p>
<ul>
<li>close: ä¸ºç”Ÿæˆå™¨è¿­ä»£å™¨ï¼ˆgenerator-iteratorï¼‰æ·»åŠ ä¸€ä¸ª close() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨ç”Ÿæˆå™¨ä¸Šæ¬¡æš‚åœçš„ä½ç½®æŠ›å‡º GeneratorExit å¼‚å¸¸ã€‚</li>
<li>å¦‚æœç”Ÿæˆå™¨éšåæŠ›å‡º StopIterationï¼ˆä¾‹å¦‚é€šè¿‡æ­£å¸¸ç»“æŸï¼Œæˆ–å› å·²è¢«å…³é—­ï¼‰æˆ– GeneratorExitï¼ˆä¾‹å¦‚æœªæ•è·è¯¥å¼‚å¸¸ï¼‰ï¼Œåˆ™</li>
<li>close() æ–¹æ³•ä¼šæ­£å¸¸è¿”å›ç»™è°ƒç”¨è€…ã€‚</li>
<li>å¦‚æœç”Ÿæˆå™¨åœ¨å¤„ç† GeneratorExit æ—¶åˆ yield äº†ä¸€ä¸ªå€¼ï¼Œåˆ™ä¼šå¼•å‘ RuntimeErrorã€‚</li>
<li>å¦‚æœç”Ÿæˆå™¨æŠ›å‡ºå…¶ä»–ä»»ä½•å¼‚å¸¸ï¼Œè¯¥å¼‚å¸¸ä¼šå‘ä¸Šä¼ æ’­ç»™è°ƒç”¨è€…ã€‚</li>
<li>å¦‚æœç”Ÿæˆå™¨å·²ç»å› å¼‚å¸¸æˆ–æ­£å¸¸é€€å‡ºè€Œç»“æŸï¼Œclose() æ–¹æ³•å°†ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚</li>
</ul>
<h3 data-id="heading-42">asyncio å¿«é€Ÿå…¥é—¨</h3>
<h4 data-id="heading-43">åŸºäº async å…³é”®å­—åˆ›å»º coroutine</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">my_coroutine</span>() -&gt; <span class="hljs-literal">None</span>:
  <span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello world!"</span>)
</code></pre>
<p>è¿™ä¸ªå‡½æ•°å¾ˆç®€å•, ä»…ä»…æ˜¯åŠ ä¸Šäº†ä¸€ä¸ª async å…³é”®å­—.</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">coroutine_add_one</span>(<span class="hljs-params">number: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> number + <span class="hljs-number">1</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">add_one</span>(<span class="hljs-params">number: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> number + <span class="hljs-number">1</span>


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    function_result = add_one(<span class="hljs-number">1</span>)
    coroutine_result = coroutine_add_one(<span class="hljs-number">1</span>)

    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ™®é€šå‡½æ•°ç»“æœä¸º: <span class="hljs-subst">{function_result}</span> è¿”å›å€¼çš„ç±»å‹ä¸º: <span class="hljs-subst">{<span class="hljs-built_in">type</span>(function_result)}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"coroutineç»“æœä¸º: <span class="hljs-subst">{coroutine_result}</span> è¿”å›å€¼çš„ç±»å‹ä¸º: <span class="hljs-subst">{<span class="hljs-built_in">type</span>(coroutine_result)}</span>"</span>)
æ™®é€šå‡½æ•°ç»“æœä¸º: <span class="hljs-number">2</span> è¿”å›å€¼çš„ç±»å‹ä¸º: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'int'</span>&gt;
coroutineç»“æœä¸º: &lt;coroutine <span class="hljs-built_in">object</span> coroutine_add_one at <span class="hljs-number">0x000002915BA9E570</span>&gt; è¿”å›å€¼çš„ç±»å‹ä¸º: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'coroutine'</span>&gt;
</code></pre>
<p><strong>å½“æˆ‘ä»¬è°ƒç”¨æ—¶coroutineå‡½æ•°æ—¶, ä¸ä¼šæ‰§è¡Œåç¨‹ä¸­çš„ä»£ç . æˆ‘ä»¬å¾—åˆ°çš„æ˜¯ä¸€ä¸ªcoroutineå¯¹è±¡</strong>, è¿™ä¸ªå¯¹è±¡æ˜¯å¯ä»¥ç¨åæ‰§è¡Œçš„, å¦‚æœå¸Œæœ›è¿è¡Œä¸€ä¸ª coroutine, éœ€è¦åœ¨äº‹ä»¶å¾ªç¯ä¸Šè¿›è¡Œè¿è¡Œ.</p>
<p>ç°åœ¨çš„é—®é¢˜æ˜¯, å¦‚ä½•åˆ›å»ºäº‹ä»¶å¾ªç¯?</p>
<p>åœ¨python3.7ä¹‹å, asyncioæä¾›äº†å‡ ä¸ªæ–¹ä¾¿çš„å‡½æ•°, è€Œå…¶ä¸­æœ‰ä¸€ä¸ª <code>asyncio.run</code> å¯ä»¥ç”¨æ¥è¿è¡Œåç¨‹</p>
<ul>
<li>è¿è¡Œä¸€ä¸ªcoroutine</li>
</ul>
<p>å…³äº asyncio.run: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2Fzh-cn%2F3.15%2Flibrary%2Fasyncio-runner.html%23asyncio.run" target="_blank" title="https://docs.python.org/zh-cn/3.15/library/asyncio-runner.html#asyncio.run" ref="nofollow noopener noreferrer">docs.python.org/zh-cn/3.15/â€¦</a></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">coroutine_add_one</span>(<span class="hljs-params">number: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> number + <span class="hljs-number">1</span>


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-comment"># è¿™é‡Œæ˜¯ä¼ é€’coroutine, è€Œä¸æ˜¯å‡½æ•°å¯¹è±¡</span>
    result = asyncio.run(coroutine_add_one(<span class="hljs-number">1</span>))

    <span class="hljs-built_in">print</span>(result)
</code></pre>
<p><code>asyncio.run</code>å®ƒåˆ›é€ äº†ä¸€ä¸ªäº‹ä»¶å¾ªç¯. ä¸€æ—¦å®ƒæˆåŠŸ, å®ƒå°±ä¼šæ¥å—ä¼ é€’ç»™å®ƒçš„åç¨‹å¹¶è¿è¡Œå®ƒ, ç›´åˆ°åç¨‹æ‰§è¡Œå®Œæˆ, è¿”å›ç»“æœ</p>
<p>å¯èƒ½æœ€é‡è¦çš„æ˜¯, å®ƒæ—¨åœ¨æˆä¸ºæˆ‘ä»¬<strong>åˆ›å»ºçš„ asyncio åº”ç”¨ç¨‹åºçš„ä¸»è¦å…¥å£ç‚¹</strong></p>
<p>å®ƒåªæ‰§è¡Œä¸€ä¸ªåç¨‹, å¹¶ä¸”è¯¥åç¨‹åº”è¯¥å¯åŠ¨æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å…¶ä»–æ–¹é¢.</p>
<p>åœ¨åé¢çš„å†…å®¹ä¸­, æˆ‘ä»¬å°†æ¸æ¸ä½¿ç”¨æ­¤å‡½æ•°ä½œä¸ºå‡ ä¹æ‰€æœ‰åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹. <code>asyncio.run</code>æ‰§è¡Œçš„åç¨‹å°†åˆ›å»ºå¹¶è¿è¡Œå…¶ä»–åç¨‹, è¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨ asyncio çš„å¹¶å‘æ€§è´¨</p>
<h4 data-id="heading-44">é€šè¿‡ await å…³é”®å­—æš‚åœæ‰§è¡Œ</h4>
<p>asyncio çš„çœŸæ­£å¥½å¤„æ˜¯èƒ½å¤Ÿæš‚åœæ‰§è¡Œ, è®©äº‹ä»¶å¾ªç¯åœ¨æ‰§è¡Œä¸€ä¸ªå°è¯•æ“ä½œçš„æ—¶å€™, è¿è¡Œå…¶ä»–ä»»åŠ¡</p>
<p>å¦‚æœå¸Œæœ›æš‚åœ, å¯ä»¥é€šè¿‡ await å…³é”®å­—, è¯¥å…³é”®å­—åé¢è·Ÿç€coroutinçš„è°ƒç”¨(æ›´å…·ä½“åœ°è¯´, æ˜¯ä¸€ä¸ªç§°ä¸º <em>awaitable</em> çš„å¯¹è±¡, å®ƒå¹¶ä¸æ€»æ˜¯coroutine, æˆ‘ä»¬å°†åœ¨åé¢äº†è§£æœ‰å…³ awaitables çš„æ›´å¤šä¿¡æ¯)</p>
<p>ä½¿ç”¨awaitå°†å¯¼è‡´å…¶åé¢çš„åç¨‹è¢«è¿è¡Œ, è¿™ä¸ç›´æ¥è°ƒç”¨åç¨‹ä¸åŒ.</p>
<p>æ³¨æ„: è¯¥<code>await awaitable</code>è¡¨è¾¾å¼, è¿˜å°†æš‚åœåŒ…å«å®ƒçš„åç¨‹, ç›´åˆ°è¿™ä¸ªç­‰å¾…çš„åç¨‹å®Œæˆå¹¶è¿”å›ç»“æœ, ç„¶åç¨‹åºå¾€ä¸‹æ‰§è¡Œ.</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">coroutine_add_one</span>(<span class="hljs-params">number: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> number + <span class="hljs-number">1</span>


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>() -&gt; <span class="hljs-literal">None</span>:
    one_plus_one = <span class="hljs-keyword">await</span> coroutine_add_one(<span class="hljs-number">1</span>)
    two_plus_one = <span class="hljs-keyword">await</span> coroutine_add_one(<span class="hljs-number">2</span>)

    <span class="hljs-built_in">print</span>(one_plus_one)
    <span class="hljs-built_in">print</span>(two_plus_one)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    asyncio.run(main())
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b62913ffea9a4f918f22c355cf55bebf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc25vd3Nub3c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770866616&amp;x-signature=K8x88bZA%2B89w5tw0JzPwMBaQ1OI%3D" alt="img" loading="lazy"/></p>
<p>è¿™é‡Œmainæ˜¯çˆ¶coroutine å‡½æ•°, è€Œadd_oneè¿™ä¸ªæ˜¯å­coroutine å‡½æ•°</p>
<p>æˆ‘ä»¬æš‚åœçˆ¶åç¨‹å¹¶åœ¨ await è¡¨è¾¾å¼ä¸­è¿è¡Œadd_oneåç¨‹, å®Œæˆå, æˆ‘ä»¬æ¢å¤çˆ¶åç¨‹å¹¶è·å–è¿”å›å€¼.</p>
<p>å°±ç›®å‰è€Œè¨€, æ­¤ä»£ç çš„ä½œæ–¹å¼ä¸æ™®é€šé¡ºåºä»£ç æ²¡æœ‰åŒºåˆ«, awaitä¹‹åçš„ç¨‹åºä¹Ÿæ²¡æœ‰ä»»ä½•IOçš„è¡Œä¸º.</p>
<p>ç”¨ viztracerï¼ˆpythonä¸€ä¸ªå¯è§†åŒ–åº“ï¼‰ å¯ä»¥çœ‹åˆ°è¿™æ ·çš„æ‰§è¡Œæµç¨‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1d3c12414d849de9ba144a3dec8b69b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc25vd3Nub3c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770866616&amp;x-signature=emqd62rIXtfN1v9ID9ArqXMs9ew%3D" alt="img" loading="lazy"/></p>
<p>ä¸è¿‡åœ¨python3.14ä¹‹åå®˜æ–¹æä¾›äº†æŸ¥çœ‹å¼‚æ­¥ä»»åŠ¡çš„apiäº†ã€‚</p>
<h4 data-id="heading-45">å¼•å…¥ åŸºäº sleep çš„é•¿æ—¶è¿è¡Œçš„åç¨‹</h4>
<p><code>asyncio.sleep</code>å¯ä»¥"ç¡çœ "åˆ¶å®šçš„ç§’æ•°, è¿™ä¸ªå‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ª coroutine, æ‰€ä»¥åº”è¯¥é…åˆawait ä½¿ç”¨, è€Œä¸èƒ½ç›´æ¥è°ƒç”¨. ä»è€Œæ¨¡æ‹Ÿä½¿ç”¨ ä¸€äº› è€—æ—¶ çš„ I / O è¡Œä¸º</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_world_message</span>() -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello World!"</span>


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>() -&gt; <span class="hljs-literal">None</span>:
    message = <span class="hljs-keyword">await</span> hello_world_message()
    <span class="hljs-built_in">print</span>(message)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    asyncio.run(main())
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ceabb198e454339af62d65c98c04108~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc25vd3Nub3c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770866616&amp;x-signature=Q32E8ZYAju1MTCV%2BAfjBY4PY6H0%3D" alt="img" loading="lazy"/></p>
<p>å› ä¸ºåç»­ä¼šç»å¸¸ä½¿ç”¨ sleep, æ‰€ä»¥æˆ‘ä»¬å°è¯•è®¾ç½®ä¸€ä¸ªå¯å¤ç”¨çš„ delayåç¨‹</p>
<p>è¯¥æ–‡ä»¶ä½äº util æ¨¡å—ä¸‹.</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-string">"""
@file_name: delay_functions.py
@desc: å¯å¤ç”¨çš„ delay å‡½æ•°
"""</span>

<span class="hljs-keyword">import</span> asyncio


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params">delay_second: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¡çœ  <span class="hljs-subst">{delay_second}</span> ç§’"</span>)
    <span class="hljs-keyword">await</span> asyncio.sleep(delay_second)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¡çœ  <span class="hljs-subst">{delay_second}</span> ç§’ å·²å®Œæˆ"</span>)
    <span class="hljs-keyword">return</span> delay_second
</code></pre>
<ul>
<li>å¤š await ç¨‹åº</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> util <span class="hljs-keyword">import</span> delay


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_one</span>(<span class="hljs-params">number: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> number + <span class="hljs-number">1</span>


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_world_message</span>() -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-keyword">await</span> delay(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello World!"</span>


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>() -&gt; <span class="hljs-literal">None</span>:
    message = <span class="hljs-keyword">await</span> hello_world_message()
    one_plus_one = <span class="hljs-keyword">await</span> add_one(<span class="hljs-number">1</span>)
    <span class="hljs-built_in">print</span>(one_plus_one)
    <span class="hljs-built_in">print</span>(message)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    asyncio.run(main())
ç¡çœ  <span class="hljs-number">1</span> ç§’
ç¡çœ  <span class="hljs-number">1</span> ç§’ å·²å®Œæˆ
<span class="hljs-number">2</span>
Hello World!
</code></pre>
<p>å½“æˆ‘ä»¬è¿è¡Œå®ƒæ—¶, åœ¨æ‰“å°ä¸¤ä¸ªå‡½æ•°è°ƒç”¨çš„ç»“æœä¹‹å‰ç»è¿‡ 1 ç§’. æˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯ <code>add_one(1)</code>çš„å€¼å’Œ <code>hello_world_message()</code> å¹¶å‘è¿è¡Œæ—¶ç«‹å³æ‰“å°. é‚£ä¹ˆä¸ºä»€ä¹ˆè¿™æ®µä»£ç æ²¡æœ‰å‘ç”Ÿè¿™ç§æƒ…å†µå‘¢? ç­”æ¡ˆæ˜¯ await æš‚åœæˆ‘ä»¬å½“å‰çš„åç¨‹, å¹¶ä¸”åœ¨è¡¨è¾¾å¼ç»™æˆ‘ä»¬ä¸€ä¸ªå€¼ä¹‹å‰ä¸ä¼šåœ¨è¯¥åç¨‹ä¸­æ‰§è¡Œä»»ä½•å…¶ä»–ä»£ç </p>
<p>è¿™ç§æƒ…å†µä¸‹, æˆ‘ä»¬çš„ä»£ç è¡¨ç°å¾—å¥½åƒå®ƒæ˜¯é¡ºåºçš„</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8985ac98a78f42e68e42c66c7e8fc20d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc25vd3Nub3c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770866616&amp;x-signature=I3VNEilUVu%2FlsN3k5zJCZKDJ28Q%3D" alt="img" loading="lazy"/></p>
<p>ä¸ºäº†å®ç° æ‰§è¡Œåç¨‹æ—¶, ä¸ä¼šé˜»ç¢åç»­ç¨‹åºçš„æ‰§è¡Œ, æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ª Task çš„æ¦‚å¿µ.</p>
<h4 data-id="heading-46">åŸºäº Tasks è¿›è¡Œå¹¶å‘è¿è¡Œ</h4>
<p>Taskæ˜¯coroutineçš„åŒ…è£…å™¨, ç”¨äºå®‰æ’coroutineå°½å¿«åœ¨äº‹ä»¶å¾ªç¯ä¸Šè¿è¡Œ. è¿™ç§è°ƒåº¦å’Œæ‰§è¡Œä»¥<strong>éé˜»å¡æ–¹å¼</strong>è¿›è¡Œ, è¿™æ„å‘³ç€, ä¸€æ—¦æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªä»»åŠ¡, æˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»åŠ¡è¿è¡Œæ—¶ç«‹å³æ‰§è¡Œå…¶ä»–ä»£ç </p>
<p>è¿™ä¸æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨<code>await</code> è¡¨è¾¾å¼å­˜åœ¨æ˜¾è‘—çš„ä¸åŒ.</p>
<p>é€šè¿‡å®ƒ, æˆ‘ä»¬å¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡. ä¹Ÿå°±æ˜¯é™ä½æˆ‘ä»¬çš„I / O çš„ç­‰å¾…æ—¶é—´.</p>
<h5 data-id="heading-47">åˆ›å»ºtask</h5>
<p>æˆ‘ä»¬éœ€è¦é€šè¿‡ <code>asyncio.create_task</code> åˆ›å»ºTask.</p>
<p>è¯¥å‡½æ•°æ¥å—çš„å‚æ•°ç±»å‹ä¸º: <code>Generator[Any, None, _T] | Coroutine[Any, Any, _T]</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio

<span class="hljs-keyword">from</span> util <span class="hljs-keyword">import</span> delay


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    sleep_for_three = asyncio.create_task(delay(<span class="hljs-number">3</span>))
    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(sleep_for_three))
    result = <span class="hljs-keyword">await</span> sleep_for_three
    <span class="hljs-built_in">print</span>(result)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    asyncio.run(main())
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'_asyncio.Task'</span>&gt;
ç¡çœ  <span class="hljs-number">3</span> ç§’
ç¡çœ  <span class="hljs-number">3</span> ç§’ å·²å®Œæˆ
<span class="hljs-number">3</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91d525d49328442a8dcd10bcf02afbc1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc25vd3Nub3c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770866616&amp;x-signature=jOygyGut2jDHz1gyA8%2B79jmKRng%3D" alt="img" loading="lazy"/></p>
<p>å€¼çš„æ³¨æ„çš„æ˜¯: å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨ await ç­‰å¾…coroutineè¿è¡Œç»“æŸ, æˆ‘ä»¬çš„Taskå°†è¢«å®‰æ’è¿è¡Œ, ä½†åœ¨å…³é—­äº‹ä»¶å¾ªç¯æ—¶, å®ƒå‡ ä¹ä¼šç«‹å³åœæ­¢å¹¶â€œæ¸…ç†â€</p>
<p>è¿™ä¸ªé—®é¢˜, æˆ‘ä»¬åœ¨åé¢ä¼šæä¾›ä¸€äº›æ–¹å¼æ¥å¤„ç†.</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio

<span class="hljs-keyword">from</span> util <span class="hljs-keyword">import</span> delay


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    sleep_for_three = asyncio.create_task(delay(<span class="hljs-number">3</span>))
    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(sleep_for_three))


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    asyncio.run(main())
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'_asyncio.Task'</span>&gt;
ç¡çœ  <span class="hljs-number">3</span> ç§’
</code></pre>
<p>ç¨‹åºæ²¡æœ‰æ‰§è¡Œå®Œæ¯•.</p>
<h5 data-id="heading-48">å¹¶å‘è¿è¡Œå¤štasks</h5>
<p>å¹¶å‘è¿è¡Œå¤šä»»åŠ¡</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">from</span> util <span class="hljs-keyword">import</span> delay


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    start = time.time()
    sleep_for_three = asyncio.create_task(delay(<span class="hljs-number">3</span>))
    sleep_again = asyncio.create_task(delay(<span class="hljs-number">3</span>))
    sleep_one_more_time = asyncio.create_task(delay(<span class="hljs-number">3</span>))

    <span class="hljs-keyword">await</span> sleep_for_three
    <span class="hljs-keyword">await</span> sleep_again
    <span class="hljs-keyword">await</span> sleep_one_more_time
    end = time.time()

    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰§è¡Œè€—æ—¶: <span class="hljs-subst">{end - start:<span class="hljs-number">.4</span>f}</span>"</span>)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    asyncio.run(main())
ç¡çœ  <span class="hljs-number">3</span> ç§’
ç¡çœ  <span class="hljs-number">3</span> ç§’
ç¡çœ  <span class="hljs-number">3</span> ç§’
ç¡çœ  <span class="hljs-number">3</span> ç§’ å·²å®Œæˆ
ç¡çœ  <span class="hljs-number">3</span> ç§’ å·²å®Œæˆ
ç¡çœ  <span class="hljs-number">3</span> ç§’ å·²å®Œæˆ
æ‰§è¡Œè€—æ—¶: <span class="hljs-number">3.0056</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a23591a567094a2e960c1e45c0aae0ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc25vd3Nub3c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770866616&amp;x-signature=myq38l%2F5Mzsh1jT1KDEdAyxSyic%3D" alt="img" loading="lazy"/></p>
<p><strong>æ³¨æ„</strong>: æ ‡è®°ä¸º RUN delay(3) çš„ä»»åŠ¡ä¸­çš„ä»£ç (åœ¨ä¸Šé¢ä»£ç ä¸­, æŸäº› print è¯­å¥)ä¸ä¼šä¸å…¶ä»–ä»»åŠ¡åŒæ—¶è¿è¡Œ; åªæœ‰è¿›è¡Œ sleep çš„æ—¶å€™åŒæ—¶è¿è¡Œ</p>
<p>åœ¨æ²¡æœ‰ åç¨‹ çš„æ—¶å€™, æˆ‘ä»¬çš„è¿™ä¸ªç¨‹åºå¯èƒ½éœ€è¦9ç§’, åœ¨æ‹¥æœ‰äº† åç¨‹ ä¹‹å æˆ‘ä»¬å°†æ­¤åº”ç”¨ç¨‹åºçš„æ€»è¿è¡Œæ—¶é—´ç¼©çŸ­äº†ä¸‰å€</p>
<p><strong>åŒæ—¶æ‰§è¡Œè¿™äº›é•¿æ—¶é—´è¿è¡Œçš„ä½œæ˜¯ asyncio çœŸæ­£é—ªè€€çš„åœ°æ–¹, å®ƒæå¤§åœ°æé«˜äº†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ€§èƒ½, ä¸è¿‡ä¹Ÿå¯ä»¥å‘ç°å®ƒå‡å°‘çš„æ˜¯ I / O æ—¶é—´</strong></p>
<p>åœ¨ä»£ç ç­‰å¾…æœŸé—´, æˆ‘ä»¬å¯ä»¥æ‰§è¡Œå…¶ä»–ä»£ç . ä¾‹å¦‚, å‡è®¾æˆ‘ä»¬æƒ³åœ¨è¿è¡Œä¸€äº›é•¿æ—¶ä»»åŠ¡æ—¶æ¯ç§’æ‰“å°ä¸€æ¡çŠ¶æ€æ¶ˆæ¯</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio

<span class="hljs-keyword">from</span> util <span class="hljs-keyword">import</span> delay


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_every_second</span>() -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">1</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æˆ‘åœ¨ç­‰å¾…çš„æ—¶å€™æ­£åœ¨è¿è¡Œå…¶ä»–ä»£ç !"</span>)


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>() -&gt; <span class="hljs-literal">None</span>:
    first_delay = asyncio.create_task(delay(<span class="hljs-number">3</span>))
    second_delay = asyncio.create_task(delay(<span class="hljs-number">3</span>))
    asyncio.create_task(hello_every_second())
    <span class="hljs-keyword">await</span> first_delay
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"first_delay after"</span>)
    <span class="hljs-keyword">await</span> second_delay
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"second_delay after"</span>)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    asyncio.run(main())
</code></pre>
<p>è¿™ä¸ªç¨‹åº <code>print("æˆ‘åœ¨ç­‰å¾…çš„æ—¶å€™æ­£åœ¨è¿è¡Œå…¶ä»–ä»£ç !")</code>å¯èƒ½ä¼šè¾“å‡º2æ¬¡, ä¹Ÿå¯èƒ½è¾“å‡º3æ¬¡.</p>
<p>è¾“å‡º2æ¬¡æ˜¯åœ¨mainæ‰§è¡Œå®Œæ¯•å, hello_every_secondå®Œæˆäº†2æ¬¡ç­‰å¾….</p>
<p>è¾“å‡º3æ¬¡æ˜¯åœ¨mainæ‰§è¡Œå®Œæ¯•å, hello_every_secondå®Œæˆäº†3æ¬¡ç­‰å¾….</p>
<p>å› ä¸º sleep çš„è¿™ä¸ªç¡çœ ä¸èƒ½ä¿è¯å®Œå…¨å‡†ç¡®, æ‰€ä»¥å¯èƒ½ä¼šæœ‰ä¸€å®šçš„è¯¯å·®. å¦‚æœå¸Œæœ›ç­‰å¾… hello_every_second æ‰§è¡Œå®Œæ¯•, å¯ä»¥åŠ ä¸Šawait</p>
<h4 data-id="heading-49">gatherçš„ä½¿ç”¨</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> threading


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>(<span class="hljs-params">name</span>):
    <span class="hljs-comment"># æ‰“å°nameå’Œå½“å‰çº¿ç¨‹:</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Hello <span class="hljs-subst">{name}</span>! <span class="hljs-subst">{threading.current_thread()}</span>"</span>)
    <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">1</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Hello <span class="hljs-subst">{name}</span> again! <span class="hljs-subst">{threading.current_thread()}</span>"</span>)
    <span class="hljs-keyword">return</span> name


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">wget</span>(<span class="hljs-params">host: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"wget <span class="hljs-subst">{host}</span> ..."</span>)
    <span class="hljs-comment"># ä½¿ç”¨asyncioè·å–éé˜»å¡çš„å¼‚æ­¥socket</span>
    reader, writer = <span class="hljs-keyword">await</span> asyncio.open_connection(host, <span class="hljs-number">80</span>)

    <span class="hljs-comment"># å‘é€ HTTP è¯·æ±‚</span>
    header = <span class="hljs-string">f"GET / HTTP/1.0\r\nHost: <span class="hljs-subst">{host}</span>\r\n\r\n"</span>
    writer.write(header.encode(<span class="hljs-string">"utf-8"</span>))
    <span class="hljs-keyword">await</span> writer.drain()

    <span class="hljs-comment"># è·å–å“åº”æ•°æ®</span>
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        line: <span class="hljs-built_in">bytes</span> = <span class="hljs-keyword">await</span> reader.readline()
        <span class="hljs-comment"># è¿™é‡Œåªè¯»å–header, æ²¡æœ‰è¯»å–body</span>
        <span class="hljs-keyword">if</span> line == <span class="hljs-string">b"\r\n"</span>:
            <span class="hljs-keyword">break</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{host}</span> è¿”å›æ•°æ® <span class="hljs-subst">{line.decode(<span class="hljs-string">'utf-8'</span>)}</span>"</span>)

    <span class="hljs-comment"># å…³é—­socket</span>
    writer.close()
    <span class="hljs-keyword">await</span> writer.wait_closed()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{host}</span> wget å®Œæˆ"</span>)


<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-comment"># ç”¨asyncio.gather()åŒæ—¶è°ƒåº¦å¤šä¸ªasyncå‡½æ•°, è¯¥å‡½æ•°ä¼šè¿”å›å¼‚æ­¥å‡½æ•°çš„æ‰§è¡Œç»“æœã€‚ä¸è¿‡gatheræ— æ³•æŒ‡å®šå‡½æ•°çš„æ‰§è¡Œé¡ºåº</span>
    <span class="hljs-comment"># ä»çº¿ç¨‹idå¯ä»¥çœ‹å‡ºéƒ½æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ 4832</span>
    <span class="hljs-comment"># L = await asyncio.gather(hello("alice"), hello("bob"))</span>
    <span class="hljs-comment"># print(L)</span>

    <span class="hljs-keyword">await</span> asyncio.gather(wget(<span class="hljs-string">"www.example.com"</span>), wget(<span class="hljs-string">"www.baidu.com"</span>))


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-comment"># asyncio.run(main())</span>
    <span class="hljs-built_in">print</span>(asyncio.get_event_loop_policy())
</code></pre>
<p>æ³¨æ„ gather çš„ä½¿ç”¨ï¼Œä»–ä¼šåŒæ—¶è°ƒç”¨æ‰€æœ‰çš„å¼‚æ­¥æ–¹æ³•ï¼Œå…¶æ¬¡ä¼šç­‰åˆ°æ‰€æœ‰å‡½æ•°è°ƒç”¨å®Œæˆåè¿”å›ç»“æœï¼Œä½†æ˜¯ä»–æ— æ³•è®©æˆ‘ä»¬è‡ªå®šä¹‰å‡½æ•°çš„æ‰§è¡Œé¡ºåºã€‚</p>
<blockquote>
<p>[!note]</p>
<p>asyncioæ˜¯ä¸€ä¸ªåºå¤§çš„é¢†åŸŸï¼Œåœ¨åé¢æœ‰æ—¶é—´çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç»§ç»­åˆ†äº«, æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥è¡¥å……ï¼š</p>
<p>å–æ¶ˆä»»åŠ¡å’Œè®¾ç½®è¶…æ—¶ä»»åŠ¡.</p>
<p>Tasks, coroutines, futures, awaitables çš„çŸ¥è¯†</p>
<p>ä»¥åŠcpythonä¸­å¯¹äº yield è¿™ç§è®©å‡ºæ‰§è¡Œï¼Œç¬é—´ä¿å­˜äº†å“ªäº›ä¸Šä¸‹æ–‡çš„å†…å®¹ï¼Œè¿™æ˜¯éƒ½æ˜¯å¾ˆæœ‰æ„æ€çš„å†…å®¹</p>
<p>ä¸è¿‡asyncioè§£å†³çš„æ˜¯io-boundé—®é¢˜æ²¡æœ‰è§£å†³cpu-boundé—®é¢˜ï¼Œå¯¹äºcpu-bound æ¨èä½¿ç”¨å¤šè¿›ç¨‹çš„æ–¹å¼ã€‚æˆ–è€…ä½¿ç”¨ c / cpp / rust å†™æ¡¥</p>
</blockquote>
<h2 data-id="heading-50">Annotated</h2>
<p><code>Annotated</code>å®ƒ æ˜¯ Python 3.9+ å¼•å…¥çš„ç±»å‹æ³¨è§£ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯åœ¨ç±»å‹æ³¨è§£ä¸Šé™„åŠ é¢å¤–çš„å…ƒæ•°æ®ï¼Œè€Œä¸å½±å“ç±»å‹æœ¬èº«</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> Annotated
<span class="hljs-comment"># Python è¿è¡Œæ—¶å¯ä»¥æå–è¿™äº›å…ƒæ•°æ®</span>
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> get_args, get_origin


<span class="hljs-comment"># Annotated[ç±»å‹, å…ƒæ•°æ®1, å…ƒæ•°æ®2, ...]</span>
hint = Annotated[<span class="hljs-built_in">str</span>, <span class="hljs-string">"è¿™æ˜¯ç”¨æˆ·å"</span>, <span class="hljs-string">"æœ€å¤§é•¿åº¦100"</span>]

<span class="hljs-built_in">print</span>(get_origin(hint))  <span class="hljs-comment"># &lt;class 'typing.Annotated'&gt;</span>
<span class="hljs-built_in">print</span>(get_args(hint))    <span class="hljs-comment"># (str, 'è¿™æ˜¯ç”¨æˆ·å', 'æœ€å¤§é•¿åº¦100')</span>
<span class="hljs-comment">#                           â†‘ç±»å‹   â†‘å…ƒæ•°æ®1      â†‘å…ƒæ•°æ®2</span>
</code></pre>
<p>ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œç»™ç±»å‹æ·»åŠ äº†å…ƒæ•°æ®ä¹‹åï¼Œå¯ä»¥è·å–æ›´å¤šçš„å˜é‡ä¿¡æ¯ã€‚</p>
<p>åœ¨ python çš„ç°ä»£åŒ–å¼€å‘ä¸­è¿™ä¸ªç±»å‹ç»å¸¸ä½¿ç”¨ï¼Œä¾‹å¦‚ FastAPI å°±ä¼šä½¿ç”¨å®ƒæ¥åšä¾èµ–æ³¨å…¥çš„ç‰¹æ®Šå¤„ç†ï¼Œpython çš„ä¸€ä¸ªç‰¹ç‚¹ä¹‹ä¸€ Free</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> get_args, get_origin, Annotated

<span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_parameter</span>(<span class="hljs-params">annotation, default</span>):
    <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æ˜¯ Annotated ç±»å‹</span>
    <span class="hljs-keyword">if</span> get_origin(annotation) <span class="hljs-keyword">is</span> Annotated:
        args = get_args(annotation)
        
        actual_type = args[<span class="hljs-number">0</span>]        <span class="hljs-comment"># str | None</span>
        metadata = args[<span class="hljs-number">1</span>:]          <span class="hljs-comment"># (Header(description="è®¾å¤‡æ ‡è¯†"),)</span>
        
        <span class="hljs-comment"># éå†å…ƒæ•°æ®ï¼Œæ‰¾åˆ° FastAPI èƒ½å¤Ÿè¯†åˆ«çš„å¯¹è±¡</span>
        <span class="hljs-keyword">for</span> meta <span class="hljs-keyword">in</span> metadata:
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(meta, Header):
                <span class="hljs-comment"># æ‰¾åˆ°äº†ï¼è¿™æ˜¯ä¸€ä¸ª Header å‚æ•°</span>
                <span class="hljs-keyword">return</span> {
                    <span class="hljs-string">"type"</span>: actual_type,
                    <span class="hljs-string">"source"</span>: <span class="hljs-string">"header"</span>,
                    <span class="hljs-string">"convert_underscores"</span>: meta.convert_underscores,
                    <span class="hljs-string">"description"</span>: meta.description,
                }
    
    <span class="hljs-comment"># ä¸æ˜¯ Annotatedï¼ŒæŒ‰æ™®é€šå‚æ•°å¤„ç†</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"type"</span>: annotation}
</code></pre>
<p>å¾…ç»­...</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[godot-rustï¼ˆgdextï¼‰ä½ çš„ç¬¬ä¸€ä¸ª2Dæ¸¸æˆ - 7]]></title>    <link>https://juejin.cn/post/7602900131540811817</link>    <guid>https://juejin.cn/post/7602900131540811817</guid>    <pubDate>2026-02-05T02:19:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602900131540811817" data-draft-id="7602503154505941033" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="godot-rustï¼ˆgdextï¼‰ä½ çš„ç¬¬ä¸€ä¸ª2Dæ¸¸æˆ - 7"/> <meta itemprop="keywords" content="æ¸¸æˆ"/> <meta itemprop="datePublished" content="2026-02-05T02:19:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŸšè¦åšç”šç "/> <meta itemprop="url" content="https://juejin.cn/user/2200546203156138"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            godot-rustï¼ˆgdextï¼‰ä½ çš„ç¬¬ä¸€ä¸ª2Dæ¸¸æˆ - 7
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2200546203156138/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŸšè¦åšç”šç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:19:54.000Z" title="Thu Feb 05 2026 02:19:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç®€ä»‹</h2>
<p>æœ¬æ–‡ä»¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.godotengine.org%2Fzh-cn%2F4.5%2Fgetting_started%2Ffirst_2d_game%2Findex.html" target="_blank" title="https://docs.godotengine.org/zh-cn/4.5/getting_started/first_2d_game/index.html" ref="nofollow noopener noreferrer">ä½ çš„ç¬¬ä¸€ä¸ª 2D æ¸¸æˆ â€” Godot Engine (4.5) ç®€ä½“ä¸­æ–‡æ–‡æ¡£</a>ä¸ºè“æœ¬æ’°å†™ï¼Œgodot-rustæä¾›äº†è¯¥æ•™ç¨‹çš„ä¸€ä¸ªrustçš„å®ç°<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgodot-rust%2Fdemo-projects%2Ftree%2Fmaster%2Fdodge-the-creeps" target="_blank" title="https://github.com/godot-rust/demo-projects/tree/master/dodge-the-creeps" ref="nofollow noopener noreferrer">dodge-the-creeps</a>ï¼Œä¸æœ¬æ–‡æ–¹æ³•ä¼šç¨æœ‰ä¸åŒã€‚å¦‚æœä½ å¯¹rustã€godotç­‰å†…å®¹æ¯”è¾ƒç”Ÿç–æˆ–æ„Ÿåˆ°ç–‘æƒ‘ï¼Œå¯ä»¥å…ˆé˜…è¯»<a href="https://link.juejin.cn/?target=https%3A%2F%2Fcolinwttt.github.io%2Fgodot-rust-book-chinese%2Fintro%2Findex.html" title="https://link.juejin.cn/?target=https%3A%2F%2Fcolinwttt.github.io%2Fgodot-rust-book-chinese%2Fintro%2Findex.html" target="_blank">godot-rustå…¥é—¨æ–‡æ¡£</a>ã€‚</p>
<p>æœ¬æ–‡æ­å»ºåœ¨<a href="https://juejin.cn/post/7599566082212986932" target="_blank" title="https://juejin.cn/post/7599566082212986932">godot-rustï¼ˆgdextï¼‰åˆ›å»ºé¡¹ç›®</a>çš„åŸºç¡€ä¹‹ä¸Šï¼Œå¦‚æœä½ å¯¹è¯¥éƒ¨åˆ†å†…å®¹æ„Ÿåˆ°ç”Ÿç–ï¼Œå¯ä»¥å…ˆé˜…è¯»è¿™éƒ¨åˆ†å†…å®¹ï¼Œä¸ºæ¥ä¸‹æ¥çš„æ“ä½œåšå¥½å‡†å¤‡ã€‚</p>
<p><strong>æ³¨æ„ï¼Œæœ¬æ–‡ä½¿ç”¨çš„godotç‰ˆæœ¬ä¸º4.5.1ï¼Œgodotç‰ˆæœ¬çš„å˜åŒ–å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›å†…å®¹å¤±æ•ˆ</strong>ã€‚</p>
<p>æœ¬æ–‡æ“ä½œå‡åœ¨Windowsä¸Šæ‰§è¡Œã€‚</p>
<h2 data-id="heading-1">æ­£æ–‡</h2>
<blockquote>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æ¸¸æˆçš„æ‰€æœ‰åŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å‰©ä½™çš„æ­¥éª¤ï¼Œä¸ºæ¸¸æˆåŠ ç‚¹â€œæ–™â€ï¼Œæ”¹å–„æ¸¸æˆä½“éªŒã€‚
éšæ„ç”¨ä½ è‡ªå·±çš„æƒ³æ³•æ‰©å±•æ¸¸æˆç©æ³•ã€‚</p>
</blockquote>
<h3 data-id="heading-2">èƒŒæ™¯</h3>
<p>å‘<code>Main</code>æ·»åŠ å­èŠ‚ç‚¹<code>ColorRect</code>ï¼Œåœ¨<strong>åœºæ™¯é¢æ¿</strong>ä¸­ï¼Œå†ç”¨é¼ æ ‡å·¦é”®æ‹–åŠ¨åˆ°<code>Main</code>ä¸‹çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™æ ·è¿™ä¸ªèŠ‚ç‚¹å°±ä¼šç»˜åˆ¶åœ¨å…¶ä»–èŠ‚ç‚¹ä¹‹åã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5f577799487481681afb4ebe33d4d22~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-a6KaB5YGa55Sa56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770862795&amp;x-signature=PQCRE1k95h4b0nt%2BR7l1jiSbwys%3D" alt="è®¾ç½®æ¸¸æˆèƒŒæ™¯" loading="lazy"/></p>
<p>çœ‹åˆ°godotç¼–è¾‘å™¨å³è¾¹çš„<strong>æ£€æŸ¥å™¨</strong>ï¼Œåœ¨<code>ColorRect</code>ä¸‹åªæœ‰ä¸€ä¸ªå±æ€§<code>Color</code>ï¼Œé€‰æ‹©ä½ å–œæ¬¢çš„é¢œè‰²ï¼ŒåŸæ¸¸æˆçš„èƒŒæ™¯ä½¿ç”¨çš„æ˜¯<code>3a6d70</code>ï¼Œè¿™ä¹Ÿæ˜¯æœ¬æ–‡é€‰æ‹©çš„é¢œè‰²ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f23bf547913f4a0c80d6d25360665afe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-a6KaB5YGa55Sa56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770862795&amp;x-signature=Tqw7jkgF2Fii9wusxcwlnIK8kXk%3D" alt="è®¾ç½®èƒŒæ™¯é¢œè‰²" loading="lazy"/></p>
<p>å†åˆ°å·¥å…·æ çš„<strong>é”šç‚¹é¢„è®¾</strong>ä¸­è®¾ç½®ä¸º<code>æ•´ä¸ªçŸ©å½¢</code></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95c021d634df4b23ab18bf8f489bae5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-a6KaB5YGa55Sa56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770862795&amp;x-signature=Iyqr7sgXHIyvQ3QHZQAK3KpEqcc%3D" alt="å¹³é“ºèƒŒæ™¯" loading="lazy"/></p>
<blockquote>
<p>å¦‚æœä½ æœ‰èƒŒæ™¯å›¾ç‰‡ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨<code>TextureRect</code>èŠ‚ç‚¹æ¥æ·»åŠ å®ƒã€‚</p>
</blockquote>
<h3 data-id="heading-3">éŸ³æ•ˆ</h3>
<blockquote>
<p>å£°éŸ³å’ŒéŸ³ä¹å¯èƒ½æ˜¯å¢å¼ºæ¸¸æˆå¸å¼•åŠ›çš„æœ€æœ‰æ•ˆæ–¹æ³•ã€‚åœ¨æ¸¸æˆÂ <strong>art</strong>Â æ–‡ä»¶å¤¹ä¸­ï¼Œæœ‰ä¸¤ä¸ªå£°éŸ³æ–‡ä»¶ï¼šâ€œHouse in a Forest Loop.oggâ€ç”¨äºèƒŒæ™¯éŸ³ä¹ï¼Œè€Œâ€œgameover.wavâ€ç”¨äºå½“ç©å®¶å¤±è´¥æ—¶ã€‚</p>
</blockquote>
<p>åœ¨<code>Main</code>èŠ‚ç‚¹ä¸‹æ–°å¢ä¸¤ä¸ªå­èŠ‚ç‚¹<code>AudioStreamPlayer</code>ï¼Œä¸€ä¸ªå‘½åä¸º<code>Music</code>ï¼Œå¦ä¸€ä¸ªä¸º<code>DeathSound</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14e1692272d24f24a0ce591caba85be0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-a6KaB5YGa55Sa56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770862795&amp;x-signature=6F%2Fw9Swo1Mkp8I%2BtqOO0xAFuiiY%3D" alt="æ·»åŠ ä¸¤ä¸ªAudioStreamPlayer" loading="lazy"/></p>
<p>é€šè¿‡<strong>æ£€æŸ¥å™¨</strong>-&gt;<code>AudioStreamPlayer</code>-&gt;<code>Stream</code>æ¥åŠ è½½éŸ³é¢‘</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5491a54ce1034bda8977290cc7e73cd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-a6KaB5YGa55Sa56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770862795&amp;x-signature=u8YyQEy683CYR0weGR%2BdQg7pq78%3D" alt="æ— æ ‡é¢˜.jpg" loading="lazy"/></p>
<ul>
<li><code>Music</code>ï¼šä½¿ç”¨<code>House in a Forest Loop.ogg</code>æ–‡ä»¶</li>
<li><code>DeathSound</code>ï¼šä½¿ç”¨<code>gameover.wav</code>æ–‡ä»¶</li>
</ul>
<p>èƒŒæ™¯éŸ³ä¹<code>Music</code>éœ€è¦å¾ªç¯æ’­æ”¾ï¼Œä½†è¿™ä¸ªæ—¶å€™ä½ ä¼šå‘ç°<strong>æ£€æŸ¥å™¨</strong>çš„<code>AudioStreamPlayer</code>é‡Œ<code>Loop</code>é€‰é¡¹æ˜¯ç°è‰²çš„ã€‚ç‚¹å‡»Streamçš„å‘ä¸‹ç®­å¤´ï¼Œç‚¹å‡»<code>å”¯ä¸€åŒ–</code>ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©å¾ªç¯äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63d5bb07c581419b860796df0b824082~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-a6KaB5YGa55Sa56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770862795&amp;x-signature=mt9LNNqDoosudXVh77Ecvl7RNUs%3D" alt="éŸ³é¢‘å”¯ä¸€åŒ–" loading="lazy"/></p>
<p>æˆ‘ä»¬éœ€è¦åœ¨rusté‡Œå¯æ§åˆ¶éŸ³ä¹çš„æ’­æ”¾ï¼Œå›åˆ°rustçš„<code>Main</code>ä¸­ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">game_over</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>) {
    ......
    <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">base</span>().get_node_as::&lt;AudioStreamPlayer&gt;(<span class="hljs-string">"Music"</span>).<span class="hljs-title function_ invoke__">stop</span>();
    <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">base</span>()
        .get_node_as::&lt;AudioStreamPlayer&gt;(<span class="hljs-string">"DeathSound"</span>)
        .<span class="hljs-title function_ invoke__">play</span>();
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">new_game</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>) {
    ......
    <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">base</span>().get_node_as::&lt;AudioStreamPlayer&gt;(<span class="hljs-string">"Music"</span>).<span class="hljs-title function_ invoke__">play</span>();
}
</code></pre>
<h3 data-id="heading-4">å¿«æ·é”®</h3>
<p>å¿«æ·é”®å¯ä»¥æå‡æ¸¸æˆä½“éªŒï¼Œæ¯”å¦‚ä¾¿æ·åœ°å¼€å§‹æ¸¸æˆã€‚</p>
<p>å›å¿†ä¸€ä¸‹æˆ‘ä»¬æ·»åŠ é”®ç›˜è¾“å…¥æ¥æ§åˆ¶<code>Player</code>ç§»åŠ¨ï¼ŒåŒæ ·ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªè¾“å…¥<code>start_game</code>ï¼Œæ˜ å°„é”®ç›˜çš„<code>Enter</code>ï¼Œæ¥å¼€å§‹æ¸¸æˆï¼Œ<strong>é¡¹ç›®</strong>-&gt;<strong>é¡¹ç›®è®¾ç½®</strong>-&gt;<strong>è¾“å…¥æ˜ å°„</strong>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42889c4a3b48416896ab91a713255b00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-a6KaB5YGa55Sa56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770862795&amp;x-signature=zl2yd33JYr50J5KW8xv%2B01wqvWE%3D" alt="æ·»åŠ start_gameè¾“å…¥" loading="lazy"/></p>
<blockquote>
<p>å¦‚æœä½ æœ‰ä¸€ä¸ªæ‰‹æŸ„ï¼Œç°åœ¨å¯ä»¥æ·»åŠ ä¸€ä¸ªæ‰‹æŸ„æ”¯æŒã€‚è¿æ¥ä¸Šä½ çš„æ‰‹æŸ„ï¼Œç„¶ååœ¨æ¯ä¸€ä¸ªä½ æƒ³æ·»åŠ æ‰‹æŸ„æ”¯æŒçš„è¾“å…¥åŠ¨ä½œä¸‹ï¼Œç‚¹å‡» "+" æŒ‰é’®ç„¶åæŒ‰ä¸‹è¯¥è¾“å…¥åŠ¨ä½œå¯¹åº”çš„æŒ‰é’®ï¼Œæ–¹å‘é”®æˆ–è€…æ‘‡æ†ã€‚</p>
</blockquote>
<p>æ¥ä¸‹æ¥åˆ‡æ¢åˆ°<code>hud</code>åœºæ™¯ï¼Œé€‰ä¸­<code>StartButton</code>èŠ‚ç‚¹ï¼Œåœ¨<strong>æ£€æŸ¥å™¨</strong>-&gt;<code>BaseButton</code>-&gt;<code>Shortcut</code>ï¼Œæ–°å»ºä¸€ä¸ª<code>Shortcut</code>ï¼Œç‚¹è§£ä½ æ–°å»ºçš„<code>Shortcut</code>ç‚¹å‡»æ·»åŠ å…ƒç´ ï¼Œæ·»åŠ ä¸€ä¸ª<code>InputEventAction</code>ï¼Œå†ç‚¹å‡»<code>InputEventAction</code>æ‰“å¼€æ¬¡çº§é¢æ¿ï¼Œé€‰æ‹©<code>Action</code>ä¸ºä½ åˆšåˆ›å»ºçš„<code>start_game</code>ã€‚ä½ å¯ä»¥ä½¿ç”¨å›è½¦é”®å¼€å§‹æ¸¸æˆäº†:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2727af92f8d434fbdb4e97b1dfb0354~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-a6KaB5YGa55Sa56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770862795&amp;x-signature=6ikuMD1qSunKHefal42AnPgCxcE%3D" alt="æ·»åŠ å¿«æ·é”®" loading="lazy"/></p>
<p>è®°å¾—ä¿å­˜godotç¼–è¾‘å™¨é‡Œä½ æ‰€æœ‰çš„<strong>åœºæ™¯</strong>ï¼Œå°†rustç¼–è¯‘</p>
<pre><code class="hljs">cargo build
</code></pre>
<blockquote>
<p>å°±è¿™æ ·ï¼Œä½ åœ¨ Godot ä¸­å®Œæˆäº†ä½ çš„ç¬¬ä¸€ä¸ª 2D æ¸¸æˆã€‚</p>
</blockquote>
<h3 data-id="heading-5">åˆ†äº«æ¸¸æˆ</h3>
<blockquote>
<p>å¦‚æœä½ å¸Œæœ›åˆ«äººæ— éœ€å®‰è£… Godot å°±èƒ½è¯•ç©ä½ çš„æ¸¸æˆï¼Œä½ éœ€è¦å°†é¡¹ç›®å¯¼å‡ºä¸ºç›®æ ‡æ“ä½œç³»ç»Ÿå¯ç©çš„æ ¼å¼ã€‚æœ‰å…³è¯¦ç»†è¯´æ˜ï¼Œè¯·å‚è§Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.godotengine.org%2Fzh-cn%2F4.5%2Ftutorials%2Fexport%2Fexporting_projects.html%23doc-exporting-projects" target="_blank" title="https://docs.godotengine.org/zh-cn/4.5/tutorials/export/exporting_projects.html#doc-exporting-projects" ref="nofollow noopener noreferrer">å¯¼å‡ºé¡¹ç›®</a>ã€‚</p>
<p>å¯¼å‡ºé¡¹ç›®åï¼Œå°†å¯¼å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶å’Œ PCK æ–‡ä»¶ï¼ˆä¸æ˜¯åŸå§‹é¡¹ç›®æ–‡ä»¶ï¼‰å‹ç¼©ä¸º ZIP æ–‡ä»¶ï¼Œç„¶åå°†æ­¤ ZIP æ–‡ä»¶ä¸Šä¼ åˆ°æ–‡ä»¶å…±äº«ç½‘ç«™ã€‚</p>
</blockquote>
<h3 data-id="heading-6">æ›´å¤š</h3>
<p>ç»†å¿ƒçš„ä½ ä¼šå‘ç°ï¼Œå½“åœ¨è°ƒè¯•å®Œæˆçš„æ¸¸æˆæ—¶ï¼Œä½ ä¼šå‘ç°godotæç¤ºäº†ä¸€äº›é”™è¯¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8f47f65ca54494baa082d5bf8f69117~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-a6KaB5YGa55Sa56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770862795&amp;x-signature=fewKivcUJVTb%2FM7dIli%2Bxc9kE5w%3D" alt="rustçš„ç»‘å®šæŠ¥é”™" loading="lazy"/></p>
<p>ç»è¿‡åå¤è°ƒæ•´ä»£ç å’Œæµ‹è¯•ï¼Œæˆ‘ä»¬å°è¯•æ‰¾åˆ°äº†ä¸€äº›ç«¯å€ªã€‚</p>
<p>åœ¨<code>Hud</code>ä¸­åœ¨<code>MessageTimer</code>timeoutæ—¶ä¼šè°ƒç”¨æ–¹æ³•<code>on_message_timer_timeout()</code>:</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">base</span>()
    .get_node_as::&lt;Timer&gt;(<span class="hljs-string">"MessageTimer"</span>)
    .<span class="hljs-title function_ invoke__">signals</span>()
    .<span class="hljs-title function_ invoke__">timeout</span>()
    .<span class="hljs-title function_ invoke__">connect_other</span>(<span class="hljs-keyword">self</span>, <span class="hljs-keyword">Self</span>::on_message_timer_timeout);
</code></pre>
<p>æ³¨æ„è¿™ä¸ªç»‘å®šå°†<code>self</code>ä¼ äº†è¿›å»ï¼Œä¹Ÿå°±æ˜¯<code>hud</code>è‡ªå·±ã€‚</p>
<p>å›å¿†ä¸€ä¸‹å½“æ¸¸æˆç»“æŸæ—¶<code>Main</code>ä¸­çš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">game_over</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>) {
    ......
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">hud</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">base</span>().get_node_as::&lt;Hud&gt;(<span class="hljs-string">"Hud"</span>);
    <span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">move</span> {
        hud.<span class="hljs-title function_ invoke__">bind_mut</span>().<span class="hljs-title function_ invoke__">show_game_over</span>().<span class="hljs-keyword">await</span>;
    });
    ......
}
</code></pre>
<p>è¿™æ—¶<code>hud</code>æ‰§è¡Œäº†ä¸€æ¬¡<code>bind()</code>ç”¨ä»¥è°ƒç”¨<code>show_game_over()</code>ï¼Œç”±äºrustç‰¹æ€§ï¼Œ<code>hud</code>å®ä¾‹å°†ä¼šé”å®š</p>
<p>è¿›å…¥åˆ°<code>show_game_over()</code></p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">show_game_over</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>) {
    <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">show_message</span>(<span class="hljs-string">"Game Over"</span>);
    <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">base</span>()
        .get_node_as::&lt;Timer&gt;(<span class="hljs-string">"MessageTimer"</span>)
        .<span class="hljs-title function_ invoke__">signals</span>()
        .<span class="hljs-title function_ invoke__">timeout</span>()
        .<span class="hljs-title function_ invoke__">to_future</span>()
        .<span class="hljs-keyword">await</span>;
    <span class="hljs-comment">// æŠ¥é”™å‘ç”Ÿåœ¨æ­¤å¤„</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">message</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">base</span>().get_node_as::&lt;Label&gt;(<span class="hljs-string">"Message"</span>);

    message.<span class="hljs-title function_ invoke__">set_text</span>(<span class="hljs-string">"Dodge the Creeps!"</span>);
    message.<span class="hljs-title function_ invoke__">show</span>(); <span class="hljs-comment">// æœ¬è¡Œç”šè‡³å¯ä»¥åˆ é™¤</span>

    <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">base</span>()
        .<span class="hljs-title function_ invoke__">get_tree</span>()
        .<span class="hljs-title function_ invoke__">unwrap</span>()
        .<span class="hljs-title function_ invoke__">create_timer</span>(<span class="hljs-number">1.0</span>)
        .<span class="hljs-title function_ invoke__">unwrap</span>()
        .<span class="hljs-title function_ invoke__">signals</span>()
        .<span class="hljs-title function_ invoke__">timeout</span>()
        .<span class="hljs-title function_ invoke__">to_future</span>()
        .<span class="hljs-keyword">await</span>;

    <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">base</span>().get_node_as::&lt;Button&gt;(<span class="hljs-string">"StartButton"</span>).<span class="hljs-title function_ invoke__">show</span>();
}
</code></pre>
<p>æç¤º<strong>Game Over</strong>ä¹‹åï¼Œæˆ‘ä»¬ç­‰å¾…<code>MessageTimer</code>èµ°å®Œï¼Œè¿™æ—¶<code>MessageTimer</code>ä¼šè‡ªåŠ¨è°ƒç”¨å‰é¢æåˆ°çš„ç»‘å®šçš„<code>hud</code>çš„<code>on_message_timer_timeout()</code>æ–¹æ³•ï¼Œä½†æ­¤æ—¶<code>show_game_over()</code>å¹¶æœªå®Œæˆï¼Œä¹Ÿå°±æ˜¯è¯´<code>hud.bind_mut().show_game_over().await</code>è¿™è¡Œä»£ç å¹¶æœªé‡Šæ”¾<code>bind_mut()</code>ï¼Œè€Œ<code>MessageTimer</code>åœ¨å°è¯•è°ƒç”¨<code>hud</code>ã€‚</p>
<p>ä½†æ˜¯æŠ¥é”™å¹¶ä¸å½±å“æˆ‘ä»¬æ¸¸æˆæ­£ç¡®è¿è¡Œï¼Œå› ä¸ºç´§æ¥ç€æˆ‘ä»¬ç«‹é©¬åˆä½¿ç”¨äº†<code>message</code>æ¥æ˜¾ç¤º"Dodge the Creeps!"æç¤ºï¼Œ<code>on_message_timer_timeout()</code>æ˜¯å¦è¢«è°ƒç”¨æˆåŠŸï¼Œå³<code>message</code>æ˜¯å¦è¢«éšè—å¯¹æ­¤å¤„é€»è¾‘æ— å…³ç—›ç—’ï¼Œç”šè‡³å¯ä»¥åˆ©ç”¨æ­¤å¤„æŠ¥é”™é€»è¾‘ï¼Œå°†<code>message.show();</code>æ­¤è¡Œä»£ç åˆ é™¤ã€‚</p>
<p><em>æˆ‘ä»¬å¹¶ä¸çŸ¥é“æŒ‰ç…§åŸæ•™ç¨‹ä¸­<code>GDScript</code>å¯¹åº”çš„è°ƒç”¨æ˜¯å¦ä¼šæŠ¥é”™ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±äºrustä¸¥æ ¼çš„å€Ÿç”¨è§„åˆ™é€ æˆäº†æ­¤å¤„é—®é¢˜ã€‚ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ï¼Œæ­¤å¤„æŠ¥é”™æ„å‘³ç€åœ¨godot-rustä¸­ä½¿ç”¨<code>future</code>è¦æ›´ä¸ºè°¨æ…ã€‚æŒ‰ç…§godot-rustä¸­æä¾›çš„<code>demo</code>æ¼”ç¤ºï¼Œä¼˜åŒ–ä½ çš„ä»£ç æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</em></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsunderlands%2Fdodge-the-creeps-2d.git" target="_blank" title="https://github.com/sunderlands/dodge-the-creeps-2d.git" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>æ˜¯æœ¬æ–‡çš„æœ€ç»ˆä»£ç ï¼Œå¦‚æœéœ€è¦è¿è¡Œè¯·ç¼–è¯‘rustï¼Œ<strong>æ³¨æ„æœ¬æ–‡ä½¿ç”¨çš„ç¯å¢ƒä¸ºwin11</strong>ã€‚</p>
<h2 data-id="heading-7">å‚è€ƒ</h2>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.godotengine.org%2Fzh-cn%2F4.5%2Fgetting_started%2Ffirst_2d_game%2Findex.html" target="_blank" title="https://docs.godotengine.org/zh-cn/4.5/getting_started/first_2d_game/index.html" ref="nofollow noopener noreferrer">ä½ çš„ç¬¬ä¸€ä¸ª 2D æ¸¸æˆ â€” Godot Engine (4.5) ç®€ä½“ä¸­æ–‡æ–‡æ¡£</a></li>
<li><a href="https://juejin.cn/post/7599566082212986932" target="_blank" title="https://juejin.cn/post/7599566082212986932">godot-rustï¼ˆgdextï¼‰åˆ›å»ºé¡¹ç›® - æ˜é‡‘</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.rs%2Fgodot%2F0.4.5%2Fgodot%2F" target="_blank" title="https://docs.rs/godot/0.4.5/godot/" ref="nofollow noopener noreferrer">godot - Rust</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgodot-rust%2Fdemo-projects%2Ftree%2Fmaster%2Fdodge-the-creeps" target="_blank" title="https://github.com/godot-rust/demo-projects/tree/master/dodge-the-creeps" ref="nofollow noopener noreferrer">demo-projects/dodge-the-creeps at master Â· godot-rust/demo-projects Â· GitHub</a></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•è§£å†³ Cursor å¼€å‘ Unity æ—¶çš„ä»£ç æç¤ºå¤±æ•ˆé—®é¢˜]]></title>    <link>https://juejin.cn/post/7602928783596240902</link>    <guid>https://juejin.cn/post/7602928783596240902</guid>    <pubDate>2026-02-05T03:34:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602928783596240902" data-draft-id="7602916406980788265" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•è§£å†³ Cursor å¼€å‘ Unity æ—¶çš„ä»£ç æç¤ºå¤±æ•ˆé—®é¢˜"/> <meta itemprop="keywords" content="Unity3D"/> <meta itemprop="datePublished" content="2026-02-05T03:34:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¼Ÿå¤§çš„ä¼Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/1643111318034364"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•è§£å†³ Cursor å¼€å‘ Unity æ—¶çš„ä»£ç æç¤ºå¤±æ•ˆé—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1643111318034364/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¼Ÿå¤§çš„ä¼Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:34:55.000Z" title="Thu Feb 05 2026 03:34:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>éšç€ AI è¾…åŠ©ç¼–ç¨‹å·¥å…·çš„å…´èµ·ï¼Œè¶Šæ¥è¶Šå¤šçš„ Unity å¼€å‘è€…å¸Œæœ›å°† Cursorã€Trae ç­‰ AI ä»£ç ç¼–è¾‘å™¨å¼•å…¥æ—¥å¸¸å¼€å‘æµç¨‹ã€‚ç„¶è€Œï¼Œä¸ Visual Studioã€VS Code ç­‰ä¼ ç»Ÿç¼–è¾‘å™¨ä¸åŒï¼Œè¿™äº›æ–°å…´å·¥å…·å¹¶æœªè·å¾— Unity å®˜æ–¹çš„åŸç”Ÿæ”¯æŒï¼Œåœ¨é¡¹ç›®å¼€å‘ä¸­ä¼šé‡åˆ°ä»£ç ä¸Šä¸‹æ–‡ç¼ºå¤±ã€ç±»å‹å¼•ç”¨å¤±æ•ˆç­‰é—®é¢˜ã€‚</p>
<p>æœ¬æ–‡å°†ç³»ç»Ÿæ€§åœ°åˆ†æè¯¥é—®é¢˜çš„æˆå› ï¼Œä»¥ Cursor ä¸ºä¸»è¦ç ”ç©¶å¯¹è±¡ï¼Œæä¾›ä¸¤ç§å¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå¸®åŠ©å¼€å‘è€…é¡ºåˆ©å®Œæˆ AI ç¼–ç¨‹å·¥å…·ä¸ Unity é¡¹ç›®çš„é›†æˆé…ç½®ã€‚</p>
<h2 data-id="heading-1">é—®é¢˜èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆéœ€è¦æŒ‡å®šé»˜è®¤ä»£ç ç¼–è¾‘å™¨</h2>
<h3 data-id="heading-2">Unity é¡¹ç›®çš„è§£å†³æ–¹æ¡ˆæœºåˆ¶</h3>
<p>Unity åœ¨è®¾è®¡ä¹‹åˆä¾¿è€ƒè™‘åˆ°äº†ä¸å¤–éƒ¨ä»£ç ç¼–è¾‘å™¨çš„åä½œéœ€æ±‚ã€‚ä¸ºå®ç°è¿™ä¸€ç›®æ ‡ï¼ŒUnity é€šè¿‡å†…ç½®çš„ IDE æ”¯æŒæ’ä»¶ï¼ˆå¦‚ Visual Studio Editorã€Visual Studio Code Editorï¼‰è‡ªåŠ¨ç”Ÿæˆ C# è§£å†³æ–¹æ¡ˆæ–‡ä»¶ï¼ˆ.slnï¼‰åŠé¡¹ç›®æ–‡ä»¶ï¼ˆ.csprojï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86799d38b682472595df72c6cc64f935~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lyf5aSn55qE5Lyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867294&amp;x-signature=%2FVMx2LnUsQHfWUT89rzvIiWLz28%3D" alt="Unity IDE æ”¯æŒæ’ä»¶" loading="lazy"/></p>
<p>å½“å¼€å‘è€…é€šè¿‡æŒ‡å®šçš„ç¼–è¾‘å™¨æ‰“å¼€è„šæœ¬æ—¶ï¼Œåœ¨æ’ä»¶çš„æ”¯æŒä¸‹ï¼Œä»£ç ç¼–è¾‘å™¨ä¼šè‡ªåŠ¨åŠ è½½è¯¥è§£å†³æ–¹æ¡ˆï¼Œä»è€Œå®ç°ï¼š</p>
<ul>
<li>è·¨è„šæœ¬çš„ç±»å‹å¼•ç”¨ä¸æ™ºèƒ½æç¤º</li>
<li>å‘½åç©ºé—´çš„è‡ªåŠ¨å¯¼å…¥</li>
<li>å®Œæ•´çš„ä»£ç è¡¥å…¨ä¸é‡æ„åŠŸèƒ½</li>
</ul>
<p>è€Œå¯¹äº AI ç¼–ç¨‹å·¥å…·æ¥è¯´ï¼Œç”±äºæ²¡æœ‰ç›¸å…³æ’ä»¶çš„æ”¯æŒï¼Œä»…ä»…æ˜¯åœ¨External Tools ä¸­æŒ‡å®šé»˜è®¤ä»£ç ç¼–è¾‘å™¨ï¼Œå¹¶ä¸èƒ½å¼•èµ· Unity çš„è”åŠ¨åŠ è½½ã€‚è¿™ç§ç®€å•æŒ‡å®šä»£ç ç¼–è¾‘å™¨çš„åšæ³•ï¼Œæ›´åƒæ˜¯åœ¨ Windows ç³»ç»Ÿä¸­æŒ‡å®šæ–‡ä»¶çš„é»˜è®¤æ‰“å¼€æ–¹å¼ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03f6ccbc8a634cd08f39287d38f05a4a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lyf5aSn55qE5Lyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867294&amp;x-signature=7MTENf0nNuVexXCQw1R%2FaWLL4u8%3D" alt="Unity External Tools è®¾ç½®ç•Œé¢" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58ecc089c749424ca61a600de8a74272~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lyf5aSn55qE5Lyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867294&amp;x-signature=CcZf8jJOjG7h6peWjXIxmqPGCaM%3D" alt="Cursorä¸­æ— æ³•è½½å…¥Unityè§£å†³æ–¹æ¡ˆ" loading="lazy"/></p>
<p>å—æ­¤å½±å“ï¼ŒAI ä»£ç ç¼–è¾‘å™¨ä¸èƒ½åƒ Visual Studio é‚£æ ·ï¼Œåœ¨è„šæœ¬ä¸­ç¼–å†™ä»£ç æ—¶è·å¾— Unity API çš„æ™ºèƒ½æç¤ºå’Œç±»å‹è¯†åˆ«ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37dd220a14fa4458930c9000ffe1610b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lyf5aSn55qE5Lyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867294&amp;x-signature=IXUE8hsJzSGKmorYgOcg78GAJcc%3D" alt="Cursorä¸­æ— æ³•è¯†åˆ«Unity API" loading="lazy"/></p>
<p>ä»"æ°›å›´ç¼–ç¨‹"ï¼ˆVibe Codingï¼‰çš„è§†è§’æ¥çœ‹ï¼Œè¿™æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª<strong>ä¸Šä¸‹æ–‡ä¿¡æ¯ä¸å®Œæ•´</strong>çš„é—®é¢˜ã€‚</p>
<p>PSï¼šè™½ç„¶æŸäº› Vibe Coding çš„åšå®šæ”¯æŒè€…è®¤ä¸ºä»£ç è¡¥å…¨å¹¶ä¸é‡è¦ï¼Œä½†æ˜¯ï¼Œå¯¹äºå…·å¤‡å¤šå¹´ç¼–ç¨‹ç»éªŒçš„å¼€å‘è€…æ¥è¯´ï¼Œè¿˜æ˜¯æ”¾ä¸ä¸‹æœºæ¢°é”®ç›˜çš„ã€‚</p>
<h2 data-id="heading-3">è§£å†³æ–¹æ¡ˆä¸€ï¼šé€šè¿‡ç¤¾åŒºæ’ä»¶å®ç°ï¼ˆCursor ä¸“ç”¨ï¼‰</h2>
<p>é’ˆå¯¹ Cursor ç¼–è¾‘å™¨ï¼Œç¤¾åŒºå¼€å‘è€…æä¾›äº†ä¸“ç”¨çš„ Unity é›†æˆæ’ä»¶ï¼Œå¯å®ç°ä¸å®˜æ–¹æ”¯æŒç¼–è¾‘å™¨ç›¸åŒçš„ä½“éªŒã€‚</p>
<h3 data-id="heading-4">æ’ä»¶è·å–</h3>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fboxqkrtm%2Fcom.unity.ide.cursor" target="_blank" title="https://github.com/boxqkrtm/com.unity.ide.cursor" ref="nofollow noopener noreferrer">github.com/boxqkrtm/coâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6d0e2068b7240adb53bcdf18db4975e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lyf5aSn55qE5Lyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867294&amp;x-signature=IH45DXe1%2BJbnELai9kghw%2B1NWXY%3D" alt="æ’ä»¶ GitHub ä»“åº“" loading="lazy"/></p>
<h3 data-id="heading-5">å®‰è£…æ­¥éª¤</h3>
<p>å¼€å‘è€…å¯æ ¹æ®ä»£ç ä»“åº“è¯´æ˜ï¼Œé€šè¿‡ Unity Package Manager å®‰è£…è¯¥æ’ä»¶ï¼ŒåŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>åœ¨ Unity ä¸­æ‰“å¼€ Package Manager</li>
<li>ç‚¹å‡»"+"æŒ‰é’®ï¼Œé€‰æ‹©"Add package from git URL"</li>
<li>è¾“å…¥ä»“åº“åœ°å€å¹¶ç¡®è®¤å®‰è£…</li>
</ol>
<p>å®‰è£…å®Œæˆåï¼ŒæŒ‡å®š Cursor ä¸ºé»˜è®¤ä»£ç ç¼–è¾‘å™¨ï¼ŒCursor å°†èƒ½å¤Ÿæ­£ç¡®åŠ è½½ Unity é¡¹ç›®çš„è§£å†³æ–¹æ¡ˆæ–‡ä»¶ï¼Œå®ç°å®Œæ•´çš„ä»£ç ä¸Šä¸‹æ–‡æ”¯æŒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fcc6e9559ab4c49888192b5ba201140~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lyf5aSn55qE5Lyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867294&amp;x-signature=NkgXXjXkg%2FTOJmiO1gcHP4lipMw%3D" alt="Cursor æˆåŠŸåŠ è½½ Unity è§£å†³æ–¹æ¡ˆ" loading="lazy"/></p>
<h3 data-id="heading-6">æ–¹æ¡ˆè¯„ä¼°</h3>





















<table><thead><tr><th>ä¼˜åŠ¿</th><th>å±€é™æ€§</th></tr></thead><tbody><tr><td>å®‰è£…é…ç½®ç®€å•</td><td>ä»…é€‚ç”¨äº Cursor ç¼–è¾‘å™¨</td></tr><tr><td>ä¸å®˜æ–¹æ’ä»¶ä½“éªŒä¸€è‡´</td><td>ä¾èµ–ç¤¾åŒºç»´æŠ¤ï¼Œæ›´æ–°å¯èƒ½æ»å</td></tr><tr><td>æ— éœ€æ‰‹åŠ¨é…ç½®å‚æ•°</td><td>ä¸é€‚ç”¨äºå…¶ä»– AI ç¼–ç¨‹å·¥å…·</td></tr></tbody></table>
<h2 data-id="heading-7">è§£å†³æ–¹æ¡ˆäºŒï¼šé€šç”¨å‘½ä»¤è¡Œé…ç½®ï¼ˆæ¨èï¼‰</h2>
<p>å¦‚å‰æ‰€è¿°ï¼Œæ–¹æ¡ˆä¸€çš„å±€é™æ€§åœ¨äºä»…é€‚ç”¨äº Cursorï¼Œå¹¶ä¸é€‚ç”¨äº Traeã€Qoderã€Code Buddy ç­‰å…¶ä»– AI ç¼–ç¨‹å·¥å…·ï¼ˆå½“ç„¶å¼€å‘è€…ä¹Ÿå¯è‡ªè¡Œ Fork ä»¥ä¸Šæ’ä»¶ï¼Œç”¨ AI ä»¿å†™ä¸€ä¸ªæ”¯æŒå¯¹åº”ç¼–è¾‘å™¨çš„ç‰ˆæœ¬ï¼‰ï¼Œæ‰€ä»¥æ›´ä¸ºé€šç”¨çš„æ–¹æ¡ˆæ˜¯åœ¨ä¸å®‰è£…æ’ä»¶çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é…ç½®å¤–éƒ¨ç¼–è¾‘å™¨å‚æ•°å®ç°åŒç­‰æ•ˆæœã€‚</p>
<h3 data-id="heading-8">é…ç½®æ­¥éª¤</h3>
<h4 data-id="heading-9">æ­¥éª¤ä¸€ï¼šè®¾ç½®é¡¹ç›®é»˜è®¤ä»£ç ç¼–è¾‘å™¨ã€‚</h4>
<p>åœ¨ Unity ä¸­é€‰æ‹©èœå•å‘½ä»¤ï¼š<code>Edit - Preferences - External Tools</code>ï¼Œæ‰“å¼€å¤–éƒ¨å·¥å…·è®¾ç½®ç•Œé¢ã€‚åœ¨ <code>External Script Editor</code> ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©é»˜è®¤ä»£ç ç¼–è¾‘å™¨ï¼Œä»¥ Cursor ä¸ºä¾‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5fb0b3611b44fb9b9b9e12206e2f4ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lyf5aSn55qE5Lyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867294&amp;x-signature=JT0Za12cBigB8l8D8akuN7nluyA%3D" alt="Unity å¤–éƒ¨ç¼–è¾‘å™¨é…ç½®ç•Œé¢" loading="lazy"/></p>
<h4 data-id="heading-10">æ­¥éª¤äºŒï¼šé…ç½®ç¼–è¾‘å™¨å‚æ•°</h4>
<p>åœ¨ <code>External Script Editor Args</code> è¾“å…¥æ¡†ä¸­å¡«å…¥ä»¥ä¸‹å‚æ•°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">-r -g $(<span class="hljs-title class_">File</span>):$(<span class="hljs-title class_">Line</span>):$(<span class="hljs-title class_">Column</span>) $(<span class="hljs-title class_">ProjectPath</span>)
</code></pre>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb3bcfb4053b4ad0ba2893fd6725bd66~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lyf5aSn55qE5Lyf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867294&amp;x-signature=rH%2BA%2BHoMrbDb56iXatQRW2f5e8k%3D" alt="å‚æ•°è®¾ç½®" loading="lazy"/></p>
<p><strong>å‚æ•°å¡«å†™æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ul>
<li><code>-g $(File):$(Line):$(Column)</code> å¯ç†è§£ä¸ºå‡½æ•°è°ƒç”¨ï¼Œå…¶ä¸­ <code>-g</code> ä¸ºæŒ‡ä»¤ï¼Œå†’å·ï¼ˆ<code>:</code>ï¼‰ä½œä¸ºå‚æ•°åˆ†éš”ç¬¦ï¼Œç±»ä¼¼äºå‡½æ•°è°ƒç”¨ä¸­çš„é€—å·ï¼Œ<code>$</code> ä¸ºå˜é‡å‰ç¼€ã€‚</li>
<li><code>$(Column)</code> ä¸ <code>$(ProjectPath)</code> ä¹‹é—´å¿…é¡»æœ‰ç©ºæ ¼åˆ†éš”ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å‚æ•°ï¼Œ<code>$(ProjectPath)</code> å¹¶ä¸å±äº <code>-g</code> æŒ‡ä»¤çš„å‚æ•°èŒƒå›´ã€‚</li>
</ul>
<p>ä»¥ä¸‹ä¸ºå„å‚æ•°çš„å…·ä½“å«ä¹‰ã€‚</p>
<h3 data-id="heading-11">å‚æ•°è¯¦è§£</h3>








































<table><thead><tr><th>å‚æ•°</th><th>åç§°</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td><code>-r</code></td><td>Reuse Window</td><td>å¤ç”¨å·²æœ‰ç¼–è¾‘å™¨çª—å£ï¼Œé¿å…é‡å¤å¼€å¯æ–°å®ä¾‹</td></tr><tr><td><code>-g</code></td><td>Go to Line</td><td>å¯ç”¨è¡Œå·å®šä½åŠŸèƒ½</td></tr><tr><td><code>$(File)</code></td><td>æ–‡ä»¶è·¯å¾„</td><td>Unity ä¼ é€’çš„å½“å‰è„šæœ¬ç»å¯¹è·¯å¾„</td></tr><tr><td><code>$(Line)</code></td><td>è¡Œå·</td><td>ç›®æ ‡è·³è½¬è¡Œå·ï¼ˆç”¨äºé”™è¯¯å®šä½ï¼‰</td></tr><tr><td><code>$(Column)</code></td><td>åˆ—å·</td><td>ç›®æ ‡è·³è½¬åˆ—å·</td></tr><tr><td><code>$(ProjectPath)</code></td><td>é¡¹ç›®è·¯å¾„</td><td>Unity é¡¹ç›®æ ¹ç›®å½•è·¯å¾„</td></tr></tbody></table>
<p>ä»¥ä¸Šé…ç½®å®Œæˆåï¼Œå¼€å‘è€…åœ¨ Project çª—å£ä¸­åŒå‡»è„šæœ¬æ–‡ä»¶ï¼ŒAI ä»£ç ç¼–è¾‘å™¨å°†è‡ªåŠ¨åŠ è½½ Unity ç”Ÿæˆçš„è§£å†³æ–¹æ¡ˆï¼Œå®ç°å®Œæ•´çš„ä¸Šä¸‹æ–‡æ”¯æŒã€‚</p>
<p>è‡³äº Traeã€Qoder ç­‰å…¶ä»– AI ç¼–ç¨‹å·¥å…·ï¼ŒåŒæ ·å¯é€šè¿‡è¯¥æ–¹æ¡ˆå®ç°ã€‚</p>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>æœ¬æ–‡é’ˆå¯¹ AI ç¼–ç¨‹å·¥å…·ä¸ Unity é¡¹ç›®é›†æˆçš„æ ¸å¿ƒé—®é¢˜ï¼Œæä¾›äº†æ’ä»¶å®‰è£…ä¸å‘½ä»¤è¡Œé…ç½®ä¸¤ç§è§£å†³æ–¹æ¡ˆã€‚å¯¹äº Cursor ç”¨æˆ·ï¼Œæ¨èä½¿ç”¨ç¤¾åŒºæ’ä»¶ä»¥è·å¾—å¼€ç®±å³ç”¨çš„ä½“éªŒï¼›å¯¹äºå…¶ä»– AI ç¼–ç¨‹å·¥å…·ç”¨æˆ·ï¼Œå‘½ä»¤è¡Œå‚æ•°é…ç½®æ–¹æ¡ˆå…·æœ‰æ›´å¼ºçš„é€šç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ Tiptap åšååŒç¼–è¾‘å™¨ï¼Œé‚£ä¹ˆæˆ‘å»ºè®®ä½ ä½¿ç”¨ Monorepo æ¶æ„æ˜¯æœ€èˆ’æœçš„é€‰æ‹©]]></title>    <link>https://juejin.cn/post/7602900131541401641</link>    <guid>https://juejin.cn/post/7602900131541401641</guid>    <pubDate>2026-02-05T03:37:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602900131541401641" data-draft-id="7602921143490347051" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ Tiptap åšååŒç¼–è¾‘å™¨ï¼Œé‚£ä¹ˆæˆ‘å»ºè®®ä½ ä½¿ç”¨ Monorepo æ¶æ„æ˜¯æœ€èˆ’æœçš„é€‰æ‹©"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-02-05T03:37:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Moment"/> <meta itemprop="url" content="https://juejin.cn/user/3782764966460398"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ Tiptap åšååŒç¼–è¾‘å™¨ï¼Œé‚£ä¹ˆæˆ‘å»ºè®®ä½ ä½¿ç”¨ Monorepo æ¶æ„æ˜¯æœ€èˆ’æœçš„é€‰æ‹©
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3782764966460398/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Moment
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:37:38.000Z" title="Thu Feb 05 2026 03:37:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>æ˜¨å¤©æŠŠ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxun082%2FDocFlow" target="_blank" title="https://github.com/xun082/DocFlow" ref="nofollow noopener noreferrer">DocFlow</a> é‡æ„æˆäº† Monorepo æ¶æ„ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³ååŒç¼–è¾‘ä¸­çš„ Schema åŒæ­¥é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d98019f421fa4d219332ccf6b67e4f9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9tZW50:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867458&amp;x-signature=VSDrMGblClxK2n0TMgnc30GRIp0%3D" alt="20260205105346" loading="lazy"/></p>
<p>é¡¹ç›®ä½¿ç”¨ Tiptap åšååŒç¼–è¾‘ï¼Œè‡ªå®šä¹‰èŠ‚ç‚¹è¾ƒå¤šï¼Œè€Œ Yjs ä¼ é€’çš„æ˜¯äºŒè¿›åˆ¶æ•°æ®ã€‚åƒè­¦å‘Šæ¡† <code>Alert</code> è¿™ç±»è‡ªå®šä¹‰èŠ‚ç‚¹ï¼Œåœ¨å‰ç«¯æ˜¯å…·ä½“çš„ UI ç»„ä»¶ï¼Œä½†åœ¨ Hocuspocus åç«¯å¿…é¡»æœ‰å¯¹åº”çš„ Transformer é€»è¾‘ï¼Œæ‰èƒ½å°†äºŒè¿›åˆ¶æ•°æ®å‡†ç¡®è¿˜åŸæˆ JSON æˆ– HTMLã€‚</p>
<p>æ²¡æœ‰ Monorepo æ—¶ï¼Œæ¯åŠ ä¸€ä¸ªæ–°åŠŸèƒ½ï¼ˆå¦‚ alert.tsï¼‰ï¼Œéƒ½è¦åœ¨å‰ç«¯å’Œåç«¯åˆ†åˆ«ç»´æŠ¤ä¸€å¥— Schemaã€‚ä¸€æ—¦æ¼æ‰åŒæ­¥ï¼Œåç«¯è§£ææ—¶å°±ä¸è®¤è¯†è¿™ä¸ªèŠ‚ç‚¹ï¼Œè¾›è¾›è‹¦è‹¦å­˜çš„æ•°æ®å¯èƒ½ç›´æ¥ä¸¢å¤±ã€‚</p>
<p>é‡‡ç”¨ Monorepo åï¼Œæ¶æ„æ¸…æ™°å¤šäº†ï¼š</p>
<ul>
<li>åŸå­åŒ–è§£è€¦ï¼šæ¯ä¸ªè‡ªå®šä¹‰èŠ‚ç‚¹å¦‚ <code>@syncflow/alert</code> éƒ½æ˜¯ç‹¬ç«‹åŒ…ï¼ŒèŒè´£å•ä¸€ï¼Œ</li>
<li>é€»è¾‘å…±äº«ï¼š<code>transformer</code> åŒ…ç»Ÿä¸€ç»„è£…è¿™äº›èŠ‚ç‚¹ï¼Œå¯¼å‡ºä¸€ä¸ªå…¨èƒ½çš„è§£æå™¨</li>
<li>å¤šç«¯å¤ç”¨ï¼šå‰ç«¯ç¼–è¾‘å™¨ç”¨å®ƒæ¥æ¸²æŸ“ï¼Œåç«¯ Hocuspocus ç”¨å®ƒåšæ•°æ®è½¬æ¢</li>
</ul>
<p>æœ€ç»ˆå®ç°ä¸€å¥— <code>Schema</code> å®šä¹‰ï¼Œå…¨é“¾è·¯é€šç”¨ï¼Œæ”¹ä¸€ä¸‹ alert.ts çš„è§„åˆ™ï¼Œå…¨ç«¯è‡ªåŠ¨ç”Ÿæ•ˆï¼Œç»´æŠ¤æ•ˆç‡å¤§å¹…æå‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Chat æ¨¡å¼æ˜¯å’Œ AI æœ€å¥½çš„äº¤äº’èŒƒå¼å—ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7602916406980821033</link>    <guid>https://juejin.cn/post/7602916406980821033</guid>    <pubDate>2026-02-05T03:33:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602916406980821033" data-draft-id="7602846823326498851" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Chat æ¨¡å¼æ˜¯å’Œ AI æœ€å¥½çš„äº¤äº’èŒƒå¼å—ï¼Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,äº¤äº’è®¾è®¡,ChatGPT"/> <meta itemprop="datePublished" content="2026-02-05T03:33:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="vivoäº’è”ç½‘æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/993614243303053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Chat æ¨¡å¼æ˜¯å’Œ AI æœ€å¥½çš„äº¤äº’èŒƒå¼å—ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614243303053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    vivoäº’è”ç½‘æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:33:24.000Z" title="Thu Feb 05 2026 03:33:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…ï¼švivo äº’è”ç½‘é¡¹ç›®å›¢é˜Ÿ- Ding Junjie<br/>
æœ¬æ–‡ä»ä½œè€…ä½¿ç”¨AIçš„å®è·µç»éªŒå‡ºå‘ï¼Œæ¢è®¨äº†Chatæ¨¡å¼ä½œä¸ºAIäº¤äº’èŒƒå¼çš„ç‰¹ç‚¹å’Œä¼˜åŠ¿ã€‚ä½œè€…æå‡ºäº†"æ„å›¾ä¿¡æ¯å¯†åº¦åŒ¹é…"çš„æ ¸å¿ƒæ¦‚å¿µï¼Œè®¤ä¸ºå¥½çš„AIäº¤äº’è®¾è®¡æœ¬è´¨ä¸Šéƒ½åœ¨è§£å†³äººæœºæ„å›¾ä¿¡æ¯å¯†åº¦åŒ¹é…é—®é¢˜ã€‚é€šè¿‡åˆ†æCursor Tabè¡¥å…¨ã€Granolaä¼šè®®ç¬”è®°ç­‰æˆåŠŸæ¡ˆä¾‹ï¼Œä»¥åŠå¯¹æ¯”ä¸€é”®ç”Ÿæˆæ¨¡å¼çš„å±€é™æ€§ï¼Œæ–‡ç« æ€»ç»“äº†ä¸åŒAIäº¤äº’æ¨¡å¼çš„é€‚ç”¨åœºæ™¯å’Œè®¾è®¡åŸåˆ™ã€‚ä½œè€…è®¤ä¸ºChatæ¨¡å¼è™½ç„¶ä¸æ˜¯å”¯ä¸€çš„æœ€ä½³äº¤äº’èŒƒå¼ï¼Œä½†å®ƒä½“ç°äº†é«˜å¯†åº¦æ„å›¾äº¤äº’çš„é‡è¦åŸåˆ™ï¼Œå…³é”®æ˜¯è¦æ ¹æ®ç”¨æˆ·æ„å›¾çš„å¤æ‚ç¨‹åº¦è®¾è®¡åˆé€‚å¯†åº¦çš„äº¤äº’æ–¹å¼ã€‚</p>
</blockquote>
<p>1åˆ†é’Ÿçœ‹å›¾æŒæ¡æ ¸å¿ƒè§‚ç‚¹ğŸ‘‡</p>
<p><img src="https://pic-out.zhimg.com/v2-928ac0f2f5068bfde5f5402d536fc29d~resize:1440:q75.gif?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1770260058-0-0-766f2b1b7d2bb0bd000180ef2567de49&amp;bizSceneCode=article_draft&amp;expiration=1770260058&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" alt="" loading="lazy"/><img src="https://pic-out.zhimg.com/v2-be8cb55048a9a92252c6447fdd6fc904~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1770260058-0-0-7ad186930f49a38b279518a725ee0289&amp;bizSceneCode=article_draft&amp;expiration=1770260058&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" alt="" loading="lazy"/></p>
<p><em>å›¾1 VS å›¾2ï¼Œæ‚¨æ›´å€¾å‘äºå“ªå¼ å›¾æ¥è¾…åŠ©ç†è§£å…¨æ–‡å‘¢ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</em></p>
<p>æˆ‘ä» GPT-3.5 å‘å¸ƒç¬¬ä¸€ä¸ªæœˆå°±å¼€å§‹ç”¨ AIï¼Œä¹Ÿå°è¯•å†™è¿‡å„ç§demoé¡¹ç›®ï¼Œå‚ä¸è¿‡æ—©æœŸçš„NextChatå¼€æºé¡¹ç›®ï¼Œç°åœ¨æ¯å¤©éƒ½ç¦»ä¸å¼€å„ç±»AIå·¥å…·ã€‚æœ€è¿‘åœ¨æƒ³ä¸€ä¸ªé—®é¢˜ï¼š<strong>Chatæ¨¡å¼æ˜¯å’ŒAIæœ€å¥½çš„äº¤äº’èŒƒå¼å—ï¼Ÿ</strong></p>
<p><img src="https://pic-out.zhimg.com/v2-d1874fd10c099cc7fedafd68d1183496~resize:1440:q75.png?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1770260058-0-0-a1c2ee135b19f126be9a55919ea02a90&amp;bizSceneCode=article_draft&amp;expiration=1770260058&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" alt="" loading="lazy"/></p>
<p><em>å›¾ç‰‡æ¥æºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fnewsletter.futureailab.com%2Fp%2Ftop-50-gen-ai-web-products" target="_blank" title="https://newsletter.futureailab.com/p/top-50-gen-ai-web-products" ref="nofollow noopener noreferrer">TOP 50 GEN AI WEB PRODUCTS</a></em></p>
<h2 data-id="heading-0">ä¸€ã€Chat æ¨¡å¼ä¸ºä»€ä¹ˆè®©äººæ„Ÿè§‰èˆ’æœï¼Ÿ</h2>
<p>ç”¨ChatGPTçš„æ—¶å€™ï¼Œæˆ‘ç»å¸¸æœ‰ç§æ„Ÿè§‰ï¼šå°±åƒåœ¨å’Œä¸€ä¸ªå¾ˆèªæ˜çš„æœ‹å‹èŠå¤©ã€‚æˆ‘è¯´ä¸€å¥ï¼Œå®ƒå›ä¸€å¥ï¼Œæˆ‘ä»¬æ…¢æ…¢æŠŠé—®é¢˜èŠæ¸…æ¥šã€‚</p>
<p>è¿™ç§æ„Ÿè§‰å’Œç”¨å…¶ä»–AIåŠŸèƒ½å¾ˆä¸ä¸€æ ·ã€‚æ¯”å¦‚ä¸€äº›"ä¸€é”®ç”Ÿæˆ"çš„åŠŸèƒ½ï¼Œæˆ‘ç‚¹ä¸€ä¸‹ï¼Œå®ƒå“—å•¦å•¦è¾“å‡ºä¸€å¤§å †ï¼Œæˆ‘çœ‹ç€å°±å¤´å¤§ã€‚</p>
<p>æƒ³äº†æƒ³ï¼Œå‘ç°Chatæ¨¡å¼æœ‰ä¸ªç‰¹ç‚¹ï¼š<strong>ä½ ä¸€å¥ï¼Œæˆ‘ä¸€å¥ï¼Œæ¯æ¬¡äº¤æ¢çš„ä¿¡æ¯éƒ½æ˜¯å°å—çš„ã€‚</strong></p>
<h2 data-id="heading-1">äºŒã€ä»AIçš„å·¥ä½œåŸç†çœ‹Chatæ¨¡å¼</h2>
<p>å¤§æ¨¡å‹æœ¬è´¨ä¸Šæ˜¯é¢„æµ‹ä¸‹ä¸€ä¸ªtokenã€‚å®ƒéœ€è¦åŸºäºå‰é¢çš„å†…å®¹æ¥é¢„æµ‹åé¢çš„å†…å®¹ã€‚</p>
<p>è¿™è®©æˆ‘æƒ³åˆ°ä¸€ä¸ªè§’åº¦ï¼š<strong>Chatæ¨¡å¼ä¸­ï¼Œæ¯æ¬¡ç”¨æˆ·çš„ä¸€å¥è¯ï¼Œå…¶å®éƒ½æ˜¯å¯¹AIé¢„æµ‹ä¸‹ä¸€æ®µtokençš„è°ƒæ•´ã€‚</strong></p>
<p>æˆ–è€…ç”¨æ›´æŠ€æœ¯çš„è¯­è¨€è¯´ï¼šæ¯æ¬¡äººçš„è¾“å…¥éƒ½åœ¨å‡å°‘AIç†è§£ç”¨æˆ·æ„å›¾çš„ç†µã€‚</p>
<p>Chatäº¤äº’æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">ç”¨æˆ·: <span class="hljs-string">"æˆ‘æƒ³å†™ä¸ªç”¨æˆ·ç®¡ç†åŠŸèƒ½"</span>AI: <span class="hljs-string">"å¥½çš„ï¼Œä½ éœ€è¦å“ªäº›å…·ä½“åŠŸèƒ½ï¼Ÿå¢åˆ æ”¹æŸ¥ï¼Ÿè¿˜æ˜¯..."</span>ç”¨æˆ·: <span class="hljs-string">"ä¸»è¦æ˜¯æŸ¥è¯¢å’Œç¼–è¾‘ï¼Œè¦æ”¯æŒåˆ†é¡µ"</span>AI: <span class="hljs-string">"æ˜ç™½äº†ï¼Œä½ ç”¨çš„æ˜¯ä»€ä¹ˆæŠ€æœ¯æ ˆï¼Ÿæ•°æ®åº“æ˜¯..."</span>ç”¨æˆ·: <span class="hljs-string">"React + Node.jsï¼ŒMongoDB"</span>AI: <span class="hljs-string">"å¥½çš„ï¼Œæˆ‘æ¥å¸®ä½ å†™ä¸€ä¸ªåŸºäºè¿™ä¸ªæŠ€æœ¯æ ˆçš„ç”¨æˆ·ç®¡ç†..."</span>
</code></pre>
<p>æ¯ä¸€è½®å¯¹è¯ï¼ŒAIå¯¹ç”¨æˆ·æ„å›¾çš„ç†è§£éƒ½æ›´ç²¾ç¡®ä¸€äº›</p>
<h2 data-id="heading-2">ä¸‰ã€æ„å›¾ä¿¡æ¯å¯†åº¦åŒ¹é…çš„æ¦‚å¿µ</h2>
<p>ä»è¿™ä¸ªè§‚å¯Ÿä¸­ï¼Œæˆ‘æƒ³åˆ°ä¸€ä¸ªæ¦‚å¿µï¼š<strong>æ„å›¾ä¿¡æ¯å¯†åº¦åŒ¹é…</strong>ã€‚</p>
<p>ç”¨æˆ·çš„æ„å›¾ä¿¡æ¯å¯†åº¦ï¼š</p>
<p>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</p>
<p>â”‚ å…·ä½“ç›®æ ‡ + ä½¿ç”¨åœºæ™¯ â”‚</p>
<p>â”‚ + ä¸ªäººåå¥½ + çº¦æŸæ¡ä»¶ â”‚</p>
<p>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</p>
<p>AIç†è§£çš„æ„å›¾ä¿¡æ¯å¯†åº¦ï¼š</p>
<p>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</p>
<p>â”‚ ä»å¯¹è¯ä¸­æå–çš„ â”‚</p>
<p>â”‚ ç”¨æˆ·çœŸå®æ„å›¾ç¨‹åº¦ â”‚</p>
<p>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</p>
<p><strong>å½“ä¸¤è€…åŒ¹é…åº¦é«˜æ—¶ï¼ŒAIè¾“å‡ºå°±ç¬¦åˆæœŸæœ›ï¼›å½“å·®è·è¿‡å¤§æ—¶ï¼ŒAIè¾“å‡ºå°±ä¼šåç¦»é¢„æœŸã€‚</strong></p>
<p>æ— è®ºæ˜¯AIç†è§£ä¸äº†äººï¼Œè¿˜æ˜¯äººä¸å†èƒ½å¤Ÿç†è§£AIè¾“å‡ºçš„å†…å®¹ï¼Œéƒ½ä¸æ˜¯ä¸€ä¸ªå¥½çš„ä½“éªŒã€‚</p>
<p>Chatæ¨¡å¼çš„æœ¬è´¨å°±æ˜¯ï¼š<strong>å®ƒèƒ½å’ŒAIè¿›è¡Œé«˜å¯†åº¦çš„æ„å›¾äº¤äº’ã€‚</strong></p>
<h2 data-id="heading-3">å››ã€å…¶ä»–æˆåŠŸçš„äº¤äº’æ¨¡å¼ä¹Ÿæœ‰ç±»ä¼¼ç‰¹å¾</h2>
<p>æƒ³åˆ°è¿™é‡Œï¼Œæˆ‘å¼€å§‹è§‚å¯Ÿå…¶ä»–å¥½ç”¨çš„AIåŠŸèƒ½ï¼Œå‘ç°å®ƒä»¬è™½ç„¶ä¸æ˜¯Chatæ¨¡å¼ï¼Œä½†æœ¬è´¨ä¸Šä¹Ÿåœ¨åšç±»ä¼¼çš„äº‹æƒ…ã€‚</p>
<h2 data-id="heading-4">4.1 Cursor Tabè¡¥å…¨ï¼šå¦ä¸€ç§"ä½ ä¸€å¥æˆ‘ä¸€å¥"</h2>
<pre><code class="hljs language-typescript" lang="typescript">æˆ‘: <span class="hljs-keyword">function</span> <span class="hljs-title function_">calculatePrice</span>(<span class="hljs-params">AI: items: Product[], discount: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {æˆ‘: â†µ (é‡‡çº³)  <span class="hljs-keyword">const</span> basePrice = <span class="hljs-attr">AI</span>: items.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.<span class="hljs-property">price</span>, <span class="hljs-number">0</span>);æˆ‘: â†µ (é‡‡çº³)  <span class="hljs-keyword">return</span> basePrice * <span class="hljs-attr">AI</span>: (<span class="hljs-number">1</span> - discount);
</code></pre>
<p>è¿™ä¹Ÿæ˜¯äººä¸€ä¸‹ï¼ŒAIä¸€ä¸‹çš„æ¨¡å¼ã€‚æˆ‘å†™å‰å‡ ä¸ªå•è¯ï¼ŒAIé¢„æµ‹åé¢çš„ï¼Œæˆ‘é€‰æ‹©æ˜¯å¦é‡‡çº³ã€‚æ•´ä¸ªè¿‡ç¨‹ååŒå¯†åº¦è¶³å¤Ÿé«˜ï¼Œæ¯ä¸€æ­¥éƒ½åœ¨å¯¹é½è®¤çŸ¥ã€‚</p>
<p><img src="https://pic-out.zhimg.com/v2-729df98f8f7a23c0de85b4d0efa91e91~resize:1440:q75.png?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1770260058-0-0-f426562147afb9081175b7fa9c13eeab&amp;bizSceneCode=article_draft&amp;expiration=1770260058&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">4.2 Granolaä¼šè®®ç¬”è®°ï¼šå¹¶è¡Œç†è§£ï¼ŒAIå¾€äººé </h2>
<p>ä¼šè®®è¿›è¡Œä¸­ï¼š</p>
<p>ï¼ˆ1ï¼‰æˆ‘æ‰‹åŠ¨è®°å½•ï¼š</p>
<p>[é‡è¦å†³å®š] ä¸‹å‘¨å‘å¸ƒæ–°åŠŸèƒ½</p>
<p>[é£é™©ç‚¹] æ•°æ®åº“æ€§èƒ½</p>
<p>[è¡ŒåŠ¨é¡¹] å¼ ä¸‰è´Ÿè´£æµ‹è¯•</p>
<p>ï¼ˆ2ï¼‰AIåŒæ—¶è®°å½•ï¼š</p>
<p>å®Œæ•´çš„ä¼šè®®è½¬å½•å†…å®¹</p>
<p>ï¼ˆ3ï¼‰ç»“åˆé˜¶æ®µï¼š</p>
<p>AIåŸºäºæˆ‘çš„é‡ç‚¹æ ‡è®°æ¥ç»„ç»‡å®ƒè®°å½•çš„è¯¦ç»†å†…å®¹</p>
<p>è¿™ä¸ªè®¾è®¡å¾ˆæœ‰æ„æ€ï¼šå®ƒæ²¡æœ‰é‡‡å–"ä½ ä¸€å¥æˆ‘ä¸€å¥"ï¼Œè€Œæ˜¯é‡‡å–<strong>å¹¶è¡Œç†è§£ç›¸åŒçš„å†…å®¹ï¼Œç„¶åAIå¾€äººçš„ç†è§£ä¸Šé </strong>ã€‚</p>
<p>æœ¬è´¨ä¹Ÿæ˜¯åœ¨å‡å°‘ç†µå¢ï¼Œæ‹‰é½è®¤çŸ¥ï¼Œå¹¶ä¸”ä»¥äººä¸ºä¸»å¯¼ã€‚</p>
<p><img src="https://pic-out.zhimg.com/v2-c91ffbe119ea9af6edc2eacf1ed05bf5~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1770260058-0-0-61a6da47be00324948a49d79f86c4e61&amp;bizSceneCode=article_draft&amp;expiration=1770260058&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" alt="" loading="lazy"/></p>
<p><em>å›¾ç‰‡æ¥æºäºgranolaï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.granola.ai%2F" target="_blank" title="https://www.granola.ai/" ref="nofollow noopener noreferrer">www.granola.ai/</a>ï¼‰</em></p>
<p>äº”ã€ä¸ºä»€ä¹ˆä¸€é”®ç”Ÿæˆå¸¸å¸¸è®©äººå¤±æœ›ï¼Ÿ</p>
<p>å¯¹æ¯”ä¸€ä¸‹ä¸€é”®ç”Ÿæˆçš„æ¨¡å¼ï¼š</p>
<p>ä¸€é”®ç”Ÿæˆæ¨¡å¼ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">ç”¨æˆ·: "å¸®æˆ‘å†™ä¸ªç”µå•†ç½‘ç«™"AI: <span class="hljs-section">[ç”Ÿæˆå¤§é‡ä»£ç å’Œæ–‡æ¡£]</span>ç”¨æˆ·: <span class="hljs-section">[éœ€è¦èŠ±å¾ˆå¤šæ—¶é—´ç†è§£å’Œä¿®æ”¹ï¼Œæœ€åå‘ç°æ ¹æœ¬ç”¨ä¸äº†ï¼ï¼ï¼]</span>
</code></pre>
<p>é—®é¢˜åœ¨äºï¼š</p>
<ul>
<li>ç”¨æˆ·ä¸€æ¬¡æ€§æè¿°å¾ˆéš¾ä¼ è¾¾å®Œæ•´æ„å›¾</li>
<li>AIå¤§é‡è¾“å‡ºè®©ç”¨æˆ·è®¤çŸ¥è´Ÿè·çˆ†ç‚¸</li>
<li>ç¼ºä¹ä¸­é—´çš„æ„å›¾æ ¡å‡†è¿‡ç¨‹</li>
</ul>
<h2 data-id="heading-6">å…­ã€æˆåŠŸçš„AIäº§å“/åŠŸèƒ½éƒ½åœ¨ä¸æ–­æ‹‰é½äººå’ŒAIçš„å…±åŒè®¤çŸ¥</h2>
<p>è§‚å¯Ÿä¸€äº›çœŸæ­£å¥½ç”¨çš„AIäº§å“ï¼š</p>
<ul>
<li>**GitHub Copilotï¼š**åœ¨ä»£ç ç¼–å†™è¿‡ç¨‹ä¸­å®æ—¶é¢„æµ‹ï¼Œä¿æŒé«˜é¢‘æ„å›¾åŒæ­¥</li>
<li>**Notion AIï¼š**åŸºäºå·²æœ‰æ–‡æ¡£å†…å®¹è¿›è¡Œç»­å†™ï¼Œä¸Šä¸‹æ–‡ä¸°å¯Œ</li>
<li>**Figma AIï¼š**åœ¨ç°æœ‰è®¾è®¡åŸºç¡€ä¸Šè°ƒæ•´ï¼Œæ„å›¾è¾¹ç•Œæ¸…æ™°</li>
</ul>
<p>å®ƒä»¬çš„å…±åŒç‚¹ï¼š<strong>éƒ½åœ¨ç”¨æˆ·æä¾›ä¸°å¯Œæ„å›¾ä¸Šä¸‹æ–‡çš„åŸºç¡€ä¸Šè¿›è¡ŒAIå¢å¼ºï¼ŒåŒæ—¶ä¿æŒäººå’ŒAIä¸€è‡´æ€§ç†è§£ã€‚</strong></p>
<h2 data-id="heading-7">ä¸ƒã€ä»€ä¹ˆåœºæ™¯é€‚åˆ"ä¸€é”®ç”Ÿæˆ"ï¼Ÿ</h2>
<p>å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›åœºæ™¯é€‚åˆå¤§é¢—ç²’åº¦ç”Ÿæˆï¼š</p>
<h2 data-id="heading-8">7.1 æ„å›¾ç®€å•æ˜ç¡®çš„åœºæ™¯</h2>
<ul>
<li>**ç¿»è¯‘ï¼š**æ„å›¾å°±æ˜¯è½¬æ¢è¯­è¨€</li>
<li>**æ ¼å¼è½¬æ¢ï¼š**è§„åˆ™æ¸…æ™°ï¼Œæ²¡æœ‰æ­§ä¹‰</li>
<li>**æ¨¡æ¿ç”Ÿæˆï¼š**æ ‡å‡†åŒ–ç¨‹åº¦é«˜</li>
</ul>
<h2 data-id="heading-9">7.2 å®¹é”™åº¦é«˜çš„åœºæ™¯</h2>
<ul>
<li>**å¤´è„‘é£æš´ï¼š**éšä¾¿ç”Ÿæˆæƒ³æ³•ï¼Œé”™äº†ä¹Ÿæ— æ‰€è°“</li>
<li>**å¿«é€ŸåŸå‹ï¼š**åªè¦èƒ½è·‘èµ·æ¥å°±è¡Œ</li>
</ul>
<p>è¿™äº›åœºæ™¯çš„<strong>ç‰¹ç‚¹</strong>æ˜¯ï¼šç”¨æˆ·æ„å›¾ç›¸å¯¹ç®€å•ï¼Œæˆ–è€…å¯¹ç»“æœè¦æ±‚ä¸é«˜ã€‚</p>
<p>æ¯”å¦‚é£ä¹¦çš„ä¼šè®®æ€»ç»“å°±æ˜¯å¥½çš„åº”ç”¨åœºæ™¯</p>
<p><img src="https://pic-out.zhimg.com/v2-b167ecd982e8d60f884c3230bdfa84a7~resize:1440:q75.png?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1770260058-0-0-bd0759334f83f6d34eeba297675181b0&amp;bizSceneCode=article_draft&amp;expiration=1770260058&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" alt="" loading="lazy"/></p>
<p><em>å›¾ç‰‡æ¥æºäºé£ä¹¦appï¼ˆ<a href="https://link.juejin.cn?target=http%3A%2F%2Ffeishu.cn%2F" target="_blank" title="http://feishu.cn/" ref="nofollow noopener noreferrer">feishu.cn</a>ï¼‰</em></p>
<h2 data-id="heading-10">å…«ã€ä¸€äº›æ€è€ƒ</h2>
<p>åŸºäºè¿™äº›è§‚å¯Ÿï¼Œæˆ‘è§‰å¾—è®¾è®¡AIåŠŸèƒ½æ—¶å¯ä»¥è€ƒè™‘ï¼š</p>
<h2 data-id="heading-11">8.1 è¯„ä¼°æ„å›¾å¤æ‚åº¦</h2>
<ul>
<li>ç”¨æˆ·æ„å›¾æ˜¯å¦å®¹æ˜“ä¸€æ¬¡æ€§æè¿°æ¸…æ¥šï¼Ÿ</li>
<li>ä¸ªæ€§åŒ–éœ€æ±‚æœ‰å¤šå¼ºï¼Ÿ</li>
<li>å¯¹ç»“æœçš„ç²¾ç¡®åº¦è¦æ±‚å¦‚ä½•ï¼Ÿ</li>
</ul>
<h2 data-id="heading-12">8.2 é€‰æ‹©åˆé€‚çš„äº¤äº’å¯†åº¦</h2>
<ul>
<li>**å¤æ‚æ„å›¾ï¼š**é«˜é¢‘äº¤äº’ï¼Œä¿æŒåŒæ­¥ï¼ˆåƒChatã€Tabè¡¥å…¨ã€Granolaè¿™ç§åç½®æ‹‰é½aiå’ŒäººååŒçš„è®¤çŸ¥ï¼‰</li>
<li>**ç®€å•æ„å›¾ï¼š**å¯ä»¥æ”¯æŒä¸€é”®ç”Ÿæˆ</li>
</ul>
<h2 data-id="heading-13">8.3 è®¾è®¡æ„å›¾æ ¡å‡†æœºåˆ¶</h2>
<ul>
<li>å¦‚ä½•è®©ç”¨æˆ·è½»æ¾æä¾›ä¸Šä¸‹æ–‡ï¼Ÿ</li>
<li>å¦‚ä½•åŠæ—¶å‘ç°æ„å›¾ç†è§£åå·®ï¼Ÿ</li>
<li>å¦‚ä½•ä¿æŒä»¥äººä¸ºä¸»å¯¼ï¼Ÿ</li>
</ul>
<h2 data-id="heading-14">ä¹ã€æœªæ¥çš„æ–¹å‘</h2>
<p>ä»æŠ€æœ¯å‘å±•çœ‹ï¼Œå¯èƒ½çš„ä¼˜åŒ–æ–¹å‘ï¼š</p>
<ul>
<li>**æ›´é•¿çš„ä¸Šä¸‹æ–‡çª—å£ï¼š**èƒ½å¤„ç†æ›´ä¸°å¯Œçš„æ„å›¾ä¿¡æ¯</li>
<li>**æ›´å¥½çš„æ„å›¾æ¨æ–­ï¼š**ä»å°‘é‡è¾“å…¥ä¸­ç†è§£æ›´å¤šæ„å›¾</li>
<li>**å¤šæ¨¡æ€æ„å›¾æ•è·ï¼š**ç»“åˆè¯­éŸ³ã€æ‰‹åŠ¿ã€è§†è§‰ç­‰</li>
<li>**ä¸ªæ€§åŒ–è®°å¿†ï¼š**è®°ä½ç”¨æˆ·çš„ä¹ æƒ¯å’Œåå¥½</li>
</ul>
<p>ä½†æ ¸å¿ƒè¿˜æ˜¯ï¼š<strong>äººæœºæ„å›¾ä¿¡æ¯å¯†åº¦åŒ¹é…ã€‚</strong></p>
<h2 data-id="heading-15">åã€å›åˆ°æœ€åˆçš„é—®é¢˜</h2>
<p>Chatæ¨¡å¼æ˜¯å’ŒAIæœ€å¥½çš„äº¤äº’èŒƒå¼å—ï¼Ÿ</p>
<p>æˆ‘è§‰å¾—ä¸æ˜¯å”¯ä¸€çš„ï¼Œä½†å®ƒç¡®å®ä½“ç°äº†ä¸€ä¸ªé‡è¦åŸåˆ™ï¼š<strong>é«˜å¯†åº¦çš„æ„å›¾äº¤äº’ã€‚</strong></p>
<p>å¥½çš„AIäº¤äº’è®¾è®¡ï¼Œæœ¬è´¨ä¸Šéƒ½åœ¨è§£å†³äººæœºæ„å›¾ä¿¡æ¯å¯†åº¦åŒ¹é…é—®é¢˜ã€‚Chatæ¨¡å¼æ˜¯ä¸€ç§å¾ˆå¥½çš„å®ç°æ–¹å¼ï¼Œä½†ä¸æ˜¯å”¯ä¸€çš„æ–¹å¼ã€‚</p>
<p>å…³é”®æ˜¯è¦ç†è§£ä½ çš„ç”¨æˆ·æ„å›¾æœ‰å¤šå¤æ‚ï¼Œç„¶åè®¾è®¡åˆé€‚å¯†åº¦çš„äº¤äº’æ–¹å¼ã€‚</p>
<p>è¿™æ˜¯ä½œè€…ä½œä¸ºé‡åº¦AIç”¨æˆ·çš„ä¸€äº›è§‚å¯Ÿå’Œæ€è€ƒã€‚</p>
<p>ä½ åœ¨ç”¨AIæ—¶æœ‰ä»€ä¹ˆæ„Ÿå—ï¼Ÿæœ‰æ²¡æœ‰å‘ç°å…¶ä»–æœ‰è¶£çš„äº¤äº’æ¨¡å¼ï¼Ÿæ¬¢è¿äº¤æµ~ï¼</p>
<p><em>æœ¬æ–‡ä»…åˆ†äº«ä½œè€…åŸºäºä¸ªäººæŠ€æœ¯å®è·µçš„æ€è€ƒå’Œä¸»è§‚è§‚ç‚¹ï¼Œä¸æ„æˆå†³ç­–ä¾æ®ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§‚æµ‹äº‘äº§å“æ›´æ–° | æ•…éšœä¸­å¿ƒã€é”™è¯¯ã€æŒ‡æ ‡åˆ†æã€åŸºç¡€è®¾æ–½ã€åœºæ™¯ç­‰]]></title>    <link>https://juejin.cn/post/7602901195153817652</link>    <guid>https://juejin.cn/post/7602901195153817652</guid>    <pubDate>2026-02-05T03:44:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901195153817652" data-draft-id="7602846823326760995" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§‚æµ‹äº‘äº§å“æ›´æ–° | æ•…éšœä¸­å¿ƒã€é”™è¯¯ã€æŒ‡æ ‡åˆ†æã€åŸºç¡€è®¾æ–½ã€åœºæ™¯ç­‰"/> <meta itemprop="keywords" content="äº§å“"/> <meta itemprop="datePublished" content="2026-02-05T03:44:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¯è§‚æµ‹æ€§ç”¨è§‚æµ‹äº‘"/> <meta itemprop="url" content="https://juejin.cn/user/2392958212523102"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§‚æµ‹äº‘äº§å“æ›´æ–° | æ•…éšœä¸­å¿ƒã€é”™è¯¯ã€æŒ‡æ ‡åˆ†æã€åŸºç¡€è®¾æ–½ã€åœºæ™¯ç­‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2392958212523102/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¯è§‚æµ‹æ€§ç”¨è§‚æµ‹äº‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:44:19.000Z" title="Thu Feb 05 2026 03:44:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è§‚æµ‹äº‘æ›´æ–°</h2>
<h3 data-id="heading-1">æ•…éšœä¸­å¿ƒ</h3>
<p>åŸ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fexception%2F" target="_blank" title="https://docs.guance.com/exception/" ref="nofollow noopener noreferrer">â€œå¼‚å¸¸è¿½è¸ªâ€</a>åŠŸèƒ½å…¨é¢å‡çº§ä¸º<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fincidents%2F" target="_blank" title="https://docs.guance.com/incidents/" ref="nofollow noopener noreferrer">â€œæ•…éšœä¸­å¿ƒâ€</a>ã€‚</p>
<p>æ•…éšœä¸­å¿ƒæä¾›ä¸€ä½“åŒ–çš„æ•…éšœå¤„ç†æ”¯æŒã€‚å½“ç›‘æ§å™¨å‘ç°å¼‚å¸¸æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆæ•…éšœäº‹ä»¶ï¼Œåˆå¹¶é‡å¤å‘Šè­¦ï¼Œå¹¶æŒ‰å€¼ç­è§„åˆ™é€šçŸ¥è´Ÿè´£äººã€‚è‹¥è¶…æ—¶æœªå¤„ç†ï¼Œå°†æ ¹æ®å‡çº§ç­–ç•¥æ‰©å¤§é€šçŸ¥èŒƒå›´ã€‚åœ¨æ•…éšœè¯¦æƒ…é¡µä¸­ï¼Œå¯ä¸€ç«™å¼æŸ¥çœ‹å…³è”çš„ç›‘æ§æŒ‡æ ‡ã€é”™è¯¯æ—¥å¿—ã€è°ƒç”¨é“¾è·¯ç­‰ä¿¡æ¯ï¼Œæ”¯æŒçŠ¶æ€æµè½¬ä¸å›¢é˜Ÿåä½œï¼Œæ‰€æœ‰æ“ä½œå‡æœ‰å®Œæ•´è®°å½•ã€‚æ•…éšœä¸­å¿ƒè¿™ä¸€åŠŸèƒ½å°†è¿›ä¸€æ­¥å¸®åŠ©å›¢é˜Ÿè§„èŒƒæ•…éšœå¤„ç†æµç¨‹ï¼Œæå‡å“åº”æ•ˆç‡ä¸è¿‡ç¨‹é€æ˜åº¦ã€‚</p>
<p>åœ¨æ•…éšœä¸­å¿ƒçš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fbilling-method%2Fcommercial-billing-logic%2F%23trigger" target="_blank" title="https://docs.guance.com/billing-method/commercial-billing-logic/#trigger" ref="nofollow noopener noreferrer">è®¡è´¹é€»è¾‘</a>ä¸­ï¼šæ¯å‘½ä¸­ä¸€æ¬¡<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fincidents%2Fcalendar%2F%23upgrade" target="_blank" title="https://docs.guance.com/incidents/calendar/#upgrade" ref="nofollow noopener noreferrer">å‡çº§ç­–ç•¥</a>ï¼Œåœ¨å‘é€é€šçŸ¥æ—¶è®°å½• 100 æ¬¡ä»»åŠ¡è°ƒç”¨ã€‚</p>
<ul>
<li>åˆ›å»ºç›‘æ§å™¨æ—¶ï¼Œå¼€å¯ã€Œå…³è”æ•…éšœã€ï¼Œè‡ªåŠ¨ç”Ÿæˆæ•…éšœäº‹ä»¶</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/921f444083ba48b297b7aa4772efe6e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=j%2BbxaVocydF8LeVEdtYbDFuA7Ws%3D" alt="" loading="lazy"/></p>
<ul>
<li>æ•…éšœäº‹ä»¶åˆ—è¡¨</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ceed00e94bfa441da6991c93b964b3cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=gOYz4YQqiVeMyl0XVkTZEu88cZY%3D" alt="" loading="lazy"/></p>
<ul>
<li>æ•…éšœäº‹ä»¶è¯¦æƒ…é¡µ</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d6dff90b8ba43a7a382154d4aab37e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=3ysG8e%2B8eK%2FRFcyiGY%2FCOMSGbuc%3D" alt="" loading="lazy"/></p>
<ul>
<li>å€¼ç­è§„åˆ™é…ç½®</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f73a0d8b0184a4a83caac2432b654a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=0SZl9spgmfN0Bo2LQmqsGKTvr10%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">é”™è¯¯</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Ferrors%2F" target="_blank" title="https://docs.guance.com/errors/" ref="nofollow noopener noreferrer">â€œé”™è¯¯ä¸­å¿ƒâ€</a>åŠŸèƒ½å…¨æ–°ä¸Šçº¿ï¼å¯è‡ªåŠ¨æ±‡æ€» APMã€RUM å’Œæ—¥å¿—ä¸­çš„é”™è¯¯ï¼Œå¹¶é€šè¿‡æ™ºèƒ½èšåˆå°†ç›¸åŒé—®é¢˜æ”¶æ•›ä¸ºç»Ÿä¸€ Issue è¿›è¡Œè·Ÿè¸ªã€‚ä½¿ç”¨å‰éœ€<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Ferrors%2Fcreate-error-rule%2F" target="_blank" title="https://docs.guance.com/errors/create-error-rule/" ref="nofollow noopener noreferrer">é…ç½®æŠ•é€’è§„åˆ™</a>ä»¥è®¾å®šç›‘æ§èŒƒå›´ï¼Œå³å¯åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Ferrors%2Ferror-rule-list%2F" target="_blank" title="https://docs.guance.com/errors/error-rule-list/" ref="nofollow noopener noreferrer">åˆ—è¡¨</a>ä¸­æŸ¥çœ‹é”™è¯¯æ¦‚å†µã€å¤„ç†çŠ¶æ€ä¸å‘ç”Ÿè¶‹åŠ¿ï¼Œä¹Ÿå¯è¿›å…¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Ferrors%2Ferror-rule-details%2F" target="_blank" title="https://docs.guance.com/errors/error-rule-details/" ref="nofollow noopener noreferrer">è¯¦æƒ…é¡µ</a>åˆ†æå®Œæ•´å †æ ˆã€å…³è”é“¾è·¯å’Œç”¨æˆ·ä¼šè¯ã€‚æ‰€æœ‰é”™è¯¯æ”¯æŒçŠ¶æ€æµè½¬ä¸å›¢é˜Ÿåä½œï¼Œå®ç°ä»å‘ç°åˆ°è§£å†³çš„å…¨æµç¨‹ç®¡ç†ã€‚</p>
<p>åŒæ­¥å¢åŠ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fbilling-method%2Fcommercial-billing-logic%2F%23error-issue-records" target="_blank" title="https://docs.guance.com/billing-method/commercial-billing-logic/#error-issue-records" ref="nofollow noopener noreferrer">â€œé”™è¯¯æ¡æ•°â€è®¡è´¹</a>ï¼Œç»Ÿè®¡æ¯æ—¥æ–°å¢çš„ Issue æ•°æ®æ¡æ•°ï¼ŒåŒ…å«é”™è¯¯ä¸­å¿ƒäº§ç”Ÿçš„ Issue æ•°æ®ã€‚</p>
<ul>
<li>é”™è¯¯ä¸­å¿ƒåˆ—è¡¨ï¼Œå¯è‡ªå®šä¹‰ç­›é€‰æŸ¥çœ‹ä¸åŒæ¥æºçš„é”™è¯¯åˆ—è¡¨</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22b0bec7484248508858cbc7c7020177~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=ySB%2F9At1pcQRofOFpolz8XNhtWM%3D" alt="" loading="lazy"/></p>
<ul>
<li>é”™è¯¯è¯¦æƒ…é¡µï¼ŒåŸºäºé”™è¯¯æ¥æºå±•ç¤ºå¯¹åº”çš„è¯¦æƒ…é¡µï¼Œä¸‹å›¾ä¸ºç”¨æˆ·è®¿é—®ç›‘æµ‹é”™è¯¯è¯¦æƒ…é¡µ</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bacdc2c87c347fa90505596c3aefcb7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=XU6WHvt0gY3O%2Bfc6stND6khZUn0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">Open API</h3>
<p>1ã€èµ„æºç›®å½•ï¼šæ–°å¢æ”¯æŒåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤èµ„æºåˆ†ç»„ä¿¡æ¯ï¼›</p>
<p>2ã€æ”¯æŒç›´æ¥ç¼–è¾‘è´¦å·çŠ¶æ€ï¼ˆå€¼ç­ä¸­ã€ä¼‘å‡ä¸­ï¼‰ã€‚</p>
<h3 data-id="heading-4">æŒ‡æ ‡åˆ†æ</h3>
<p>1ã€æ–°å¢Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fmetrics%2Fmetric-analysis%2F%23data-returned" target="_blank" title="https://docs.guance.com/metrics/metric-analysis/#data-returned" ref="nofollow noopener noreferrer">Top N åºåˆ—åŠæœ€å¤§è¿”å›ç‚¹æ•°</a>é€‰é¡¹ï¼Œå¯ä»¥æŒ‡å®šåœ¨æ¯ä¸ªæŸ¥è¯¢ä¸­ï¼Œè¿”å›æ’åºåæœ€å¤§æˆ–æœ€å°çš„è‹¥å¹²æ¡ï¼ˆ20/50/100/500ï¼‰æ•°æ®åºåˆ—ï¼›</p>
<p>2ã€æ–°å¢æ”¯æŒç‚¹å‡»å›¾è¡¨æ•°æ®ç‚¹ï¼Œä¸‹æ‹‰é€‰æ‹©æŸ¥çœ‹ç›¸ä¼¼è¶‹åŠ¿æŒ‡æ ‡ã€ä¸‹é’»åˆ†ææˆ–å…¶ä»–å…³è”æŸ¥çœ‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/924623261ba449c594795264b3598abf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=qzz3tOSPRyk4jCpRzul5l8UZqRs%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">åŸºç¡€è®¾æ–½</h3>
<p>1ã€ä¸»æœºï¼š</p>
<ul>
<li>æ–°å¢æ”¯æŒé€šè¿‡Â <code>df_mute</code>Â å­—æ®µè¿›è¡Œåˆ—è¡¨ç­›é€‰ï¼›</li>
<li>å¯¹äºé€šè¿‡ Open API æˆ–è§„åˆ™åˆ›å»ºçš„ä¸»æœºå…¨å±€<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Finfrastructure%2Fhost%2F%23mute" target="_blank" title="https://docs.guance.com/infrastructure/host/#mute" ref="nofollow noopener noreferrer">é™é»˜</a>ï¼Œç³»ç»Ÿå°†åœ¨ä¸»æœºåˆ—è¡¨æ–°å¢æ”¯æŒå±•ç¤ºâ€œé™é»˜â€æ ‡è¯†ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/601e8fdc129a4b4b8be70e5ff246bf71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=zVnx8yklBe8iGjLI3t5EpuPZeIA%3D" alt="" loading="lazy"/></p>
<p>2ã€èµ„æºç›®å½•ï¼šæ–°å¢â€œæœåŠ¡æ¸…å•â€åˆ—è¡¨å…¥å£ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af86866800be411b92562fb826dd46ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=Pz8G6koRDdXyXJsz%2FLVM46emTkQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">åœºæ™¯</h3>
<p>1ã€ä»ªè¡¨æ¿ï¼šæ–°å¢<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fscene%2Fdashboard%2Fconfig-list%2F%23relate-to-dashboard" target="_blank" title="https://docs.guance.com/scene/dashboard/config-list/#relate-to-dashboard" ref="nofollow noopener noreferrer">å…³è”ç›‘æ§å™¨</a>æŒ‰é’®ï¼Œæ”¯æŒä¸€é”®æŸ¥çœ‹ä¸è¯¥ä»ªè¡¨æ¿å…³è”çš„ç›‘æ§å™¨ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77061cb1a3f64c37a521ad1fc5da5bf6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=DHlWY7tKwbjGQ8ZKraLg%2BrvCCco%3D" alt="" loading="lazy"/></p>
<p>2ã€å›¾è¡¨ï¼šä¸ºæ‰€æœ‰å›¾è¡¨åˆ«åé…ç½®æ–°å¢ç»Ÿä¸€åºå·æ ‡è¯†å’Œæ‚¬åœè”åŠ¨ç›´è§‚åŒ–å±•ç¤ºå¤šæŸ¥è¯¢è¡Œé…ç½®æ—¶çš„å¯¹åº”å…³ç³»ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acdc9f1f731d45f5810ecd97f40e6c0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=LQl%2Bq5LS2kyn5IO7FhNa4kb4ZuQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">APM</h3>
<p>Profilingï¼šè‹¥ Profile æ–‡ä»¶ä½“ç§¯è¶…è¿‡ 20MBï¼Œç³»ç»Ÿæš‚ä¸æ”¯æŒåœ¨çº¿è§£æï¼ŒåŒæ—¶<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fapplication-performance-monitoring%2Fprofile%2F%23performance" target="_blank" title="https://docs.guance.com/application-performance-monitoring/profile/#performance" ref="nofollow noopener noreferrer">æ–°å¢å‹å¥½æç¤º</a>ï¼Œæ‚¨å¯ä½¿ç”¨ä¸“ä¸šåˆ†æå·¥å…·è¿›è¡ŒæŸ¥çœ‹ã€‚</p>
<h3 data-id="heading-8">LLM ç›‘æµ‹</h3>
<p>LLM æŸ¥çœ‹å™¨ã€æ‰€æœ‰ Traceã€‘åˆ—è¡¨ä¸­ï¼Œâ€œæ€» Tokens æ•°â€ è°ƒæ•´ä¸ºç»Ÿè®¡æ•´æ¡ Trace æ¶ˆè€—çš„ Tokens æ•°ï¼›æ€» Tokens åˆ—å°†åŒæ­¥æ˜¾ç¤ºè¾“å…¥ã€è¾“å‡º Tokens æ•°é‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2230e2de2064afd8187992c281f4f88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=UTKSUCUurLqqKTe%2FyHHlOmKWZ3w%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">æ—¥å¿—</h3>
<p>æŸ¥çœ‹å™¨ï¼šåœ¨æ˜¾ç¤ºé¡¹é€‰æ‹©â€œé‡ç½®ä¸ºé»˜è®¤å­—æ®µâ€åï¼Œ<code>message</code>Â å­—æ®µ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Flogs%2Fmanag-explorer%2F%23reset" target="_blank" title="https://docs.guance.com/logs/manag-explorer/#reset" ref="nofollow noopener noreferrer">æ˜¾ç¤ºé€»è¾‘ä¼˜åŒ–</a>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ded4c4140c34903b02086ea70ee7d2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770867863&amp;x-signature=MD538Q8YZlTCSSo2iqzu1q8fV3E%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-10">ç®¡ç†</h3>
<p>SSO ç®¡ç†ï¼šä¼˜åŒ– SSO ç™»å½•æµç¨‹ã€‚ç”¨æˆ·éœ€å…ˆé€šè¿‡é‚®ç®±é€‰æ‹©èº«ä»½æä¾›å•†å¹¶å®Œæˆè®¤è¯ï¼ŒæˆåŠŸåæ‰èƒ½åœ¨å—ä¿æŠ¤çŠ¶æ€ä¸‹æŸ¥çœ‹å¯è®¿é—®çš„å·¥ä½œç©ºé—´ï¼Œé¿å…æƒé™ä¿¡æ¯å¤–æ³„ã€‚</p>
<h3 data-id="heading-11">éƒ¨ç½²ç‰ˆ</h3>
<p>ç®¡ç†åå° &gt; å…¨å±€é…ç½®ï¼šæ–°å¢<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fdeployment%2Fsetting%2F%23noticifications" target="_blank" title="https://docs.guance.com/deployment/setting/#noticifications" ref="nofollow noopener noreferrer">å¹³å°çº§ç³»ç»Ÿå…¬å‘Šç®¡ç†é…ç½®</a>ã€‚</p>
<h2 data-id="heading-12">é›†æˆæ›´æ–°</h2>
<ul>
<li>æ–°å¢ RedPeaks SAP é›†æˆï¼›</li>
<li>æ›´æ–° AWS rds mysql ä»ªè¡¨ç›˜ï¼›</li>
<li>æ–°å¢ kingbase ç›‘æ§å™¨ï¼›</li>
<li>æ›´æ–°è‹±æ–‡ç‰ˆæœ¬dashbordï¼Œä¸»è¦å¤„ç†ä¸­è‹±æ–‡è½¬æ¢é—®é¢˜ï¼›</li>
<li>æ›´æ–°è…¾è®¯ PGSQL ä»ªè¡¨æ¿&amp;ç›‘æ§å™¨ï¼›</li>
<li>æ›´æ–°èµ„æºç›®å½• icon ä»¥åŠåˆ†ç±»ç›®å½•ã€‚</li>
</ul>
<h2 data-id="heading-13">DataKit æ›´æ–°</h2>
<h3 data-id="heading-14">æ–°åŠ åŠŸèƒ½</h3>
<ul>
<li>æ–°å¢ä¸»æœºå˜æ›´æ£€æµ‹åŠŸèƒ½ï¼Œæ”¯æŒç”¨æˆ·ã€crontabã€æœåŠ¡åŠæ–‡ä»¶å˜æ›´ç›‘æ§</li>
<li>flameshot æ”¯æŒæŒç»­é‡‡é›†æ¨¡å¼ï¼Œå¢åŠ é»˜è®¤å®šæ—¶é‡‡é›†å’Œé˜ˆå€¼è§¦å‘æŒç»­é‡‡é›†åŠŸèƒ½</li>
<li>æ–°å¢ DataKit è‡ªèº«æ—¥å¿—é‡‡é›†é…ç½®åŠŸèƒ½</li>
</ul>
<h3 data-id="heading-15">é—®é¢˜ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ Prometheus export é‡‡é›†å™¨ tags ä¼˜å…ˆçº§é”™è¯¯é—®é¢˜</li>
<li>ä¿®å¤å…¨å±€Â <code>host</code>Â æ ‡ç­¾è®¾ç½®Â <code>host=__datakit_ip</code>Â æ—¶æ— æ•ˆçš„é—®é¢˜</li>
<li>ä¿®å¤ eBPF é‡‡é›†å™¨å¯¼è‡´Â <code>istio-init</code>Â å®¹å™¨ä¸é€€å‡ºçš„é—®é¢˜</li>
<li>ä¿®å¤å®¹å™¨æ—¥å¿—é‡‡é›†ä½¿ç”¨é»˜è®¤ stdout é…ç½®æ—¶å­˜åœ¨æ— ç”¨æ“ä½œçš„é—®é¢˜</li>
<li>ä¿®å¤ WAL é”æ–‡ä»¶ä½¿ç”¨ PID å¯¼è‡´é€€å‡ºåæ— æ³•é‡ç”¨çš„é—®é¢˜</li>
<li>ä¿®å¤ profile é‡‡é›†å™¨åˆå§‹åŒ–æ—¶æœºé—®é¢˜ï¼Œé¿å…ç£ç›˜ç¼“å­˜æœªåˆå§‹åŒ–å¯¼è‡´çš„ panic</li>
<li>ä¿®å¤ Statsd æŒ‡æ ‡é‡‡é›†ï¼Œæ–°å¢ event/service check é‡‡é›†ï¼Œè¿™ä¿©ç±»æ•°æ®ç›®å‰ä»¥æ—¥å¿—å½¢å¼æ¥é‡‡é›†</li>
</ul>
<h3 data-id="heading-16">åŠŸèƒ½ä¼˜åŒ–</h3>
<ul>
<li>ä¸ºé€‰ä¸¾æ¨¡å—å¢åŠ æ›´å¤šæ—¥å¿—å’ŒæŒ‡æ ‡ï¼Œä¾¿äºæ£€æµ‹é€‰ä¸¾é¢‘ç¹åˆ‡æ¢å’Œé‡‡é›†å™¨æš‚åœå¤±è´¥é—®é¢˜</li>
<li>æ›´æ–° DataKit HTTP å®¢æˆ·ç«¯æŒ‡æ ‡ï¼Œå¢åŠ  URL è·¯å¾„æ ‡ç­¾å’Œè¯·æ±‚ä½“ä¼ è¾“æ±‡æ€»æŒ‡æ ‡</li>
<li>SQLServer é‡‡é›†å™¨æ–°å¢Â <code>sqlserver_host</code>Â æ ‡ç­¾ï¼Œå¹¶å°†Â <code>instance</code>Â æ ‡ç­¾æ”¹ä¸ºÂ <code>counter_instance</code></li>
<li>bug report æ–°å¢ Git é…ç½®æ–‡ä»¶æ”¶é›†åŠŸèƒ½</li>
<li>Windows è¿›ç¨‹é‡‡é›†å™¨æ–°å¢ status å­—æ®µæ”¯æŒ</li>
<li>DDTrace é‡‡é›†æ–°å¢æ›´å¤šÂ <code>source_type</code>Â æ”¯æŒ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JS-æ‰‹å†™ç³»åˆ—ï¼šæ ‘ä¸æ•°ç»„ç›¸äº’è½¬æ¢]]></title>    <link>https://juejin.cn/post/7602850166732554249</link>    <guid>https://juejin.cn/post/7602850166732554249</guid>    <pubDate>2026-02-05T03:48:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602850166732554249" data-draft-id="7602928386595946522" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JS-æ‰‹å†™ç³»åˆ—ï¼šæ ‘ä¸æ•°ç»„ç›¸äº’è½¬æ¢"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-05T03:48:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JS-æ‰‹å†™ç³»åˆ—ï¼šæ ‘ä¸æ•°ç»„ç›¸äº’è½¬æ¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:48:22.000Z" title="Thu Feb 05 2026 03:48:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>åœ¨å‰ç«¯ä¸šåŠ¡ä¸­ï¼Œåç«¯è¿”å›çš„æ‰å¹³åŒ–æ•°ç»„ï¼ˆArrayï¼‰å¾€å¾€éœ€è¦è½¬æ¢ä¸ºæ ‘å½¢ç»“æ„ï¼ˆTreeï¼‰æ¥é€‚é… UI ç»„ä»¶ï¼ˆå¦‚ Element UI çš„ Tree æˆ– Cascaderï¼‰ã€‚æŒæ¡å¤šç§è½¬æ¢æ€è·¯åŠæ€§èƒ½å·®å¼‚ï¼Œæ˜¯è¿›é˜¶é«˜çº§å‰ç«¯çš„å¿…å¤‡æŠ€èƒ½ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ æ ¸å¿ƒæ¦‚å¿µï¼šç»“æ„å¯¹æ¯”</h2>
<ul>
<li>
<p><strong>æ•°ç»„ç»“æ„</strong>ï¼šæ¯ä¸€é¡¹é€šè¿‡ <code>parentId</code> æŒ‡å‘çˆ¶çº§ã€‚</p>
<pre><code class="hljs language-json" lang="json">  const nodes = <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'èŠ‚ç‚¹C'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'èŠ‚ç‚¹F'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">3</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'root'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'èŠ‚ç‚¹A'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'èŠ‚ç‚¹H'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">4</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'èŠ‚ç‚¹D'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'èŠ‚ç‚¹B'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'èŠ‚ç‚¹E'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'èŠ‚ç‚¹G'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> id<span class="hljs-punctuation">:</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">:</span> 'èŠ‚ç‚¹I'<span class="hljs-punctuation">,</span> parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">5</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">]</span>;
</code></pre>
</li>
<li>
<p><strong>æ ‘å½¢ç»“æ„</strong>ï¼šçˆ¶çº§é€šè¿‡ <code>children</code> æ•°ç»„åŒ…è£¹å­çº§ã€‚</p>
<pre><code class="hljs language-json" lang="json">  let tree = <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      id<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      name<span class="hljs-punctuation">:</span> 'text1'<span class="hljs-punctuation">,</span>
      parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      children<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span>
          id<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
          name<span class="hljs-punctuation">:</span> 'text2'<span class="hljs-punctuation">,</span>
          parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
          children<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
              id<span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span>
              name<span class="hljs-punctuation">:</span> 'text4'<span class="hljs-punctuation">,</span>
              parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
          <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">{</span>
          id<span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
          name<span class="hljs-punctuation">:</span> 'text3'<span class="hljs-punctuation">,</span>
          parentId<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">]</span>;
</code></pre>
</li>
</ul>
<hr/>
<h2 data-id="heading-2">äºŒã€ æ•°ç»„è½¬æ ‘</h2>
<h3 data-id="heading-3">1. é€’å½’æ€è·¯</h3>
<p><strong>åŸç†</strong>ï¼š</p>
<ol>
<li>é¦–å…ˆéœ€è¦ä¼ é€’ç»™å‡½æ•°ä¸¤ä¸ªå‚æ•°ï¼šæ•°ç»„ã€å½“å‰çš„çˆ¶èŠ‚ç‚¹id</li>
<li>è®¾ç½®ä¸€ä¸ªç»“æœæ•°ç»„resï¼Œéå†æ•°ç»„ï¼Œå…ˆæ‰¾åˆ°å­å…ƒç´ çš„çˆ¶èŠ‚ç‚¹idä¸çˆ¶èŠ‚ç‚¹idä¸€è‡´çš„å­é¡¹</li>
<li>å°†è¿™ä¸ªå­é¡¹çš„idä½œä¸ºçˆ¶èŠ‚ç‚¹idä¼ å…¥å‡½æ•°ï¼Œç»§ç»­éå†</li>
<li>å°†éå†çš„ç»“æœä½œä¸ºchildrenè¿”å›ï¼Œå¹¶ç»™å½“å‰é¡¹æ·»åŠ children</li>
<li>å°†è¿™ä¸ªå½“å‰é¡¹ï¼Œæ’å…¥åˆ°resé‡Œé¢ï¼Œå¹¶è¿”å›</li>
</ol>
<blockquote>
<p>æ³¨æ„ï¼šå¦‚æœä¸æƒ³å½±å“åŸæ•°ç»„ï¼Œéœ€è¦å…ˆæ·±æ‹·è´ä¸€ä¸‹æ•°ç»„ã€‚<code>const cloneArr = JSON.parse(JSON.stringify (arr))</code></p>
</blockquote>
<pre><code class="hljs language-JavaScript" lang="JavaScript">  <span class="hljs-keyword">const</span> nodes = [
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'èŠ‚ç‚¹C'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-number">1</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'èŠ‚ç‚¹F'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-number">3</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'root'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-literal">null</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'èŠ‚ç‚¹A'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-number">0</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'èŠ‚ç‚¹H'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-number">4</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'èŠ‚ç‚¹D'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-number">1</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'èŠ‚ç‚¹B'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-number">0</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'èŠ‚ç‚¹E'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-number">2</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">7</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'èŠ‚ç‚¹G'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-number">2</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">9</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'èŠ‚ç‚¹I'</span>, <span class="hljs-attr">parentId</span>: <span class="hljs-number">5</span> },
  ];
  <span class="hljs-comment">//é€’å½’å†™æ³•</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">arrToTree1</span> = (<span class="hljs-params">arr, id</span>) =&gt; {
    <span class="hljs-keyword">const</span> res = [];
    arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (item.<span class="hljs-property">parentId</span> === id) {
        <span class="hljs-keyword">const</span> children = <span class="hljs-title function_">arrToTree1</span>(arr, item.<span class="hljs-property">id</span>);
        <span class="hljs-comment">//å¦‚æœå¸Œæœ›æ¯ä¸ªå…ƒç´ éƒ½æœ‰childrenå±æ€§ï¼Œå¯ä»¥ç›´æ¥èµ‹å€¼</span>
        <span class="hljs-keyword">if</span> (children.<span class="hljs-property">length</span> !== <span class="hljs-number">0</span>) {
          item.<span class="hljs-property">children</span> = children;
        }
        res.<span class="hljs-title function_">push</span>(item);
      }
    });
    <span class="hljs-keyword">return</span> res;
  };
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">arrToTree1</span>(nodes, <span class="hljs-literal">null</span>));
</code></pre>
<h3 data-id="heading-4">2. éé€’å½’æ€è·¯</h3>
<p><strong>åŸç†</strong>ï¼šåˆ©ç”¨ <code>filter</code> è¿›è¡ŒäºŒæ¬¡ç­›é€‰ã€‚è™½ç„¶å†™æ³•ç®€æ´ï¼Œä½†åœ¨å¤§æ•°æ®é‡ä¸‹æ€§èƒ½è¾ƒå·®ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ï¼‰ã€‚</p>
<ol>
<li>å‡½æ•°åªéœ€è¦æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯éœ€è¦è½¬æ¢çš„æ•°ç»„arr</li>
<li>ç¬¬ä¸€å±‚è¿‡æ»¤æ•°ç»„ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªparentIdä¸ºæ ¹idçš„å…ƒç´ </li>
<li>ä½†æ˜¯åœ¨è¿”å›ä¹‹é—´ï¼Œéœ€è¦å†æ ¹æ®å½“å‰idè¿‡æ»¤é‡Œé¢çš„æ¯ä¸€é¡¹ï¼ˆè¿‡æ»¤è§„åˆ™ä¸ºå¦‚æœå­é¡¹çš„paentIdä¸ºå½“å‰çš„idï¼Œåˆ™åœ¨å½“å‰é¡¹çš„childrenæ’å…¥è¿™ä¸ªå­é¡¹ï¼‰</li>
</ol>
<pre><code class="hljs language-JavaScript" lang="JavaScript">  <span class="hljs-keyword">const</span> <span class="hljs-title function_">arrToTree2</span> = (<span class="hljs-params">arr</span>) =&gt; {
    <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">father</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> childrenArr = arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">children</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> children.<span class="hljs-property">parentId</span> === father.<span class="hljs-property">id</span>;
      });
      <span class="hljs-comment">//å¦‚æœå¸Œæœ›æ¯ä¸ªå…ƒç´ éƒ½æœ‰childrenå±æ€§ï¼Œå¯ä»¥ç›´æ¥èµ‹å€¼</span>
      <span class="hljs-keyword">if</span> (childrenArr.<span class="hljs-property">length</span> !== <span class="hljs-number">0</span>) {
        father.<span class="hljs-property">children</span> = childrenArr;
      }
      <span class="hljs-keyword">return</span> father.<span class="hljs-property">parentId</span> === <span class="hljs-literal">null</span>;
    });
  };
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">arrToTree2</span>(nodes));
</code></pre>
<h3 data-id="heading-5">3. Map å¯¹è±¡æ–¹æ¡ˆï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> æ—¶é—´å¤æ‚åº¦ï¼‰</h3>
<p><strong>åŸç†</strong>ï¼šåˆ©ç”¨å¯¹è±¡çš„å¼•ç”¨æ€§è´¨ã€‚å…ˆå°†æ•°ç»„è½¬ä¸º Mapï¼Œå†éå†ä¸€æ¬¡å³å¯å®Œæˆã€‚<strong>è¿™æ˜¯åœ¨å¤§æ•°æ®é‡ä¸‹çš„é¦–é€‰æ–¹æ¡ˆã€‚</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">  <span class="hljs-keyword">const</span> <span class="hljs-title function_">arrToTree3</span> = (<span class="hljs-params">arr</span>) =&gt; {
    <span class="hljs-keyword">const</span> map = {};
    <span class="hljs-keyword">const</span> res = [];

    <span class="hljs-comment">// 1. å»ºç«‹æ˜ å°„è¡¨</span>
    arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      map[item.<span class="hljs-property">id</span>] = { ...item, <span class="hljs-attr">children</span>: [] };
    });

    <span class="hljs-comment">// 2. ç»„è£…æ ‘ç»“æ„</span>
    arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> node = map[item.<span class="hljs-property">id</span>];
      <span class="hljs-keyword">if</span> (item.<span class="hljs-property">parentId</span> === <span class="hljs-literal">null</span>) {
        res.<span class="hljs-title function_">push</span>(node);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (map[item.<span class="hljs-property">parentId</span>]) {
          map[item.<span class="hljs-property">parentId</span>].<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(node);
        }
      }
    });
    <span class="hljs-keyword">return</span> res;
  };
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">arrToTree3</span>(nodes));
</code></pre>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€ æ ‘è½¬æ•°ç»„</h2>
<h3 data-id="heading-7">1. é€’å½’éå†æ€è·¯</h3>
<p><strong>åŸç†</strong>ï¼šå®šä¹‰ä¸€ä¸ªç»“æœæ•°ç»„ï¼Œé€’å½’éå†æ ‘çš„æ¯ä¸€å±‚ï¼Œå°†èŠ‚ç‚¹ä¿¡æ¯ï¼ˆæ’é™¤ <code>children</code>ï¼‰æ¨å…¥æ•°ç»„ã€‚</p>
<ol>
<li>é¦–å…ˆå®šä¹‰ä¸€ä¸ªç»“æœæ•°ç»„resï¼Œéå†ä¼ å…¥çš„æ ‘</li>
<li>ç›´æ¥å°†å½“å‰é¡¹çš„idã€nameã€parentIdåŒ…è£…åœ¨ä¸€ä¸ªæ–°å¯¹è±¡é‡Œæ’å…¥</li>
<li>åˆ¤æ–­æ˜¯å¦æœ‰childrenå±æ€§ï¼Œå¦‚æœæœ‰åˆ™éå†childrenå±æ€§æ¯ä¸€é¡¹ï¼Œç»§ç»­æ‰§è¡Œ2ã€3æ­¥éª¤</li>
</ol>
<pre><code class="hljs language-JavaScript" lang="JavaScript">  <span class="hljs-keyword">let</span> tree = [
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">'text1'</span>,
      <span class="hljs-attr">parentId</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">children</span>: [
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
          <span class="hljs-attr">name</span>: <span class="hljs-string">'text2'</span>,
          <span class="hljs-attr">parentId</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">children</span>: [
            {
              <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>,
              <span class="hljs-attr">name</span>: <span class="hljs-string">'text4'</span>,
              <span class="hljs-attr">parentId</span>: <span class="hljs-number">2</span>,
            },
          ],
        },
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,
          <span class="hljs-attr">name</span>: <span class="hljs-string">'text3'</span>,
          <span class="hljs-attr">parentId</span>: <span class="hljs-number">1</span>,
        },
      ],
    },
  ];
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">treeToArr</span> = (<span class="hljs-params">tree</span>) =&gt; {
    <span class="hljs-keyword">const</span> res = [];
    tree.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">loop</span> = (<span class="hljs-params">data</span>) =&gt; {
        res.<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">id</span>: data.<span class="hljs-property">id</span>,
          <span class="hljs-attr">name</span>: data.<span class="hljs-property">name</span>,
          <span class="hljs-attr">parseId</span>: data.<span class="hljs-property">parentId</span>,
        });
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">children</span>) {
          data.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">itemChild</span>) =&gt;</span> {
            <span class="hljs-title function_">loop</span>(itemChild);
          });
        }
      };
      <span class="hljs-title function_">loop</span>(item);
    });
    <span class="hljs-keyword">return</span> res;
  };
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">treeToArr</span>(tree));
</code></pre>
<hr/>
<h2 data-id="heading-8">å››ã€ æ³¨æ„äº‹é¡¹ï¼šæ·±æ‹·è´çš„å¿…è¦æ€§</h2>
<p>åœ¨å¤„ç†è¿™äº›è½¬æ¢æ—¶ï¼Œç”±äº JS çš„å¯¹è±¡æ˜¯<strong>å¼•ç”¨ç±»å‹</strong>ï¼Œç›´æ¥ä¿®æ”¹ <code>item.children</code> ä¼šæ”¹å˜åŸå§‹æ•°ç»„çš„å†…å®¹ã€‚</p>
<ul>
<li><strong>å¿«æ·æ–¹æ¡ˆ</strong>ï¼š<code>const cloneArr = JSON.parse(JSON.stringify(arr))</code>ã€‚</li>
<li><strong>é¿å‘ç‚¹</strong>ï¼šå¦‚æœæ•°ç»„é¡¹ä¸­åŒ…å« <code>Date</code> å¯¹è±¡ã€<code>RegExp</code> æˆ– <code>Function</code>ï¼Œ<code>JSON.parse</code> ä¼šå¯¼è‡´æ•°æ®å¤±çœŸï¼Œæ­¤æ—¶åº”ä½¿ç”¨å…¶ä»–æ·±æ‹·è´æ–¹æ¡ˆã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Claude Code é¢åº¦ç”¨å®Œäº†ï¼Ÿæ•™ä½ ç”¨æœ¬åœ°æ¨¡å‹æ— ç¼æ¥åŠ›]]></title>    <link>https://juejin.cn/post/7602900131541499945</link>    <guid>https://juejin.cn/post/7602900131541499945</guid>    <pubDate>2026-02-05T03:52:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602900131541499945" data-draft-id="7602900131541483561" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Claude Code é¢åº¦ç”¨å®Œäº†ï¼Ÿæ•™ä½ ç”¨æœ¬åœ°æ¨¡å‹æ— ç¼æ¥åŠ›"/> <meta itemprop="keywords" content="Claude"/> <meta itemprop="datePublished" content="2026-02-05T03:52:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ivanvolt"/> <meta itemprop="url" content="https://juejin.cn/user/2295436011638104"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Claude Code é¢åº¦ç”¨å®Œäº†ï¼Ÿæ•™ä½ ç”¨æœ¬åœ°æ¨¡å‹æ— ç¼æ¥åŠ›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2295436011638104/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ivanvolt
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T03:52:51.000Z" title="Thu Feb 05 2026 03:52:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ç”¨ Claude Code å†™ä»£ç ç¡®å®çˆ½ï¼Œä½†å¦‚æœä½ å’Œæˆ‘ä¸€æ ·ç”¨çš„æ˜¯ä¾¿å®œå¥—é¤ï¼Œå¤§æ¦‚ç‡ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š</p>
<p><strong>é¢åº¦ç”¨å®Œäº†ã€‚</strong></p>
<p>æ­£å†™å¾—èµ·åŠ²å‘¢ï¼Œçªç„¶è¢«å‘ŠçŸ¥ä»Šå¤©çš„é…é¢å·²è€—å°½ï¼Œåªèƒ½å¹²ç­‰ã€‚</p>
<p>æœ€è¿‘åœ¨æŸæŠ€æœ¯ç¤¾åŒºçœ‹åˆ°ä¸€ä¸ªå®ç”¨çš„è§£å†³æ–¹æ¡ˆï¼š<strong>é¢åº¦ç”¨å®Œåï¼Œæ— ç¼åˆ‡æ¢åˆ°æœ¬åœ°å¼€æºæ¨¡å‹ç»§ç»­å¹²æ´»</strong>ã€‚</p>
<p>äº²æµ‹æœ‰æ•ˆï¼Œåˆ†äº«ç»™å¤§å®¶ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€å…ˆæŸ¥çœ‹ä½ çš„é¢åº¦ä½¿ç”¨æƒ…å†µ</h2>
<p>åœ¨ Claude Code é‡Œè¾“å…¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/usage
</code></pre>
<p>å¯ä»¥çœ‹åˆ°å½“å‰é¢åº¦å‰©ä½™é‡å’Œæ¶ˆè€—é€Ÿåº¦ã€‚å»ºè®®å…»æˆä¹ æƒ¯ï¼Œéšæ—¶å…³æ³¨ã€‚</p>
<hr/>
<h2 data-id="heading-2">äºŒã€æ¨èçš„æœ¬åœ°æ¨¡å‹</h2>
<p>ç›®å‰è¡¨ç°è¾ƒå¥½çš„ä¸¤ä¸ªå¼€æºæ¨¡å‹ï¼š</p>
<ol>
<li><strong>GLM-4.7-Flash</strong></li>
<li><strong>Qwen3-Coder-Next</strong></li>
</ol>
<p>å¦‚æœä½ çš„æ˜¾å¡å†…å­˜æœ‰é™ï¼Œå¯ä»¥é€‰æ‹©é‡åŒ–ç‰ˆæœ¬ï¼ŒåŠ è½½æ›´å¿«ï¼Œå ç”¨æ›´å°‘ï¼Œä½†ä»£ç è´¨é‡ä¼šæœ‰æ‰€ä¸‹é™ã€‚</p>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€æ–¹æ³•ä¸€ï¼šé€šè¿‡ LM Studio è¿æ¥</h2>
<p><strong>LM Studio</strong> æ˜¯ä¸€ä¸ªæœ¬åœ°è¿è¡Œå¼€æºæ¨¡å‹çš„å·¥å…·ï¼Œç•Œé¢å‹å¥½ï¼Œå°ç™½ä¹Ÿèƒ½ç”¨ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<ol>
<li>
<p><strong>å®‰è£… LM Studio</strong> â€”â€” å®˜ç½‘ä¸‹è½½å³å¯</p>
</li>
<li>
<p><strong>ä¸‹è½½æ¨¡å‹</strong> â€”â€” æ‰“å¼€ LM Studioï¼Œæœç´¢å¹¶ä¸‹è½½ä½ æƒ³ç”¨çš„æ¨¡å‹ï¼ˆå»ºè®®ä¸Šä¸‹æ–‡çª—å£ &gt; 25Kï¼‰</p>
</li>
<li>
<p><strong>å¯åŠ¨æœåŠ¡å¹¶é…ç½®ç¯å¢ƒå˜é‡</strong> â€”â€” æ‰“å¼€ç»ˆç«¯ï¼Œä¾æ¬¡æ‰§è¡Œï¼š</p>
</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨æœ¬åœ°æœåŠ¡</span>
lms server start --port 1234

<span class="hljs-comment"># é…ç½®ç¯å¢ƒå˜é‡ï¼Œè®© Claude Code æŒ‡å‘æœ¬åœ°æœåŠ¡</span>
<span class="hljs-built_in">export</span> ANTHROPIC_BASE_URL=http://localhost:1234
<span class="hljs-built_in">export</span> ANTHROPIC_AUTH_TOKEN=lmstudio

<span class="hljs-comment"># å¯åŠ¨ Claude Codeï¼ŒæŒ‡å®šä½¿ç”¨æœ¬åœ°æ¨¡å‹</span>
claude --model openai/gpt-oss-20b
</code></pre>
<ol start="4">
<li><strong>ç¡®è®¤å½“å‰ä½¿ç”¨çš„æ¨¡å‹</strong> â€”â€” åœ¨ Claude Code é‡Œè¾“å…¥ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">/model
</code></pre>
<p>å¯ä»¥æŸ¥çœ‹å½“å‰è¿æ¥çš„æ˜¯å“ªä¸ªæ¨¡å‹ï¼Œä¹Ÿå¯ä»¥éšæ—¶åˆ‡æ¢å›å®˜æ–¹ Claudeã€‚</p>
<hr/>
<h2 data-id="heading-4">å››ã€æ–¹æ³•äºŒï¼šç›´æ¥è¿æ¥ llama.cpp</h2>
<p>LM Studio åº•å±‚æ˜¯åŸºäºå¼€æºé¡¹ç›® <strong>llama.cpp</strong> çš„ã€‚</p>
<p>å¦‚æœä½ ä¸æƒ³è£… LM Studioï¼Œå¯ä»¥ç›´æ¥å®‰è£… llama.cpp å¹¶è¿æ¥ Claude Codeã€‚ç½‘ä¸Šæœ‰è¯¦ç»†æ•™ç¨‹ï¼Œæœä¸€ä¸‹å°±èƒ½æ‰¾åˆ°ã€‚</p>
<p>ä¸è¿‡è¯´å®è¯ï¼Œé™¤éä½ æœ‰å¾®è°ƒæ¨¡å‹çš„éœ€æ±‚ï¼Œå¦åˆ™ LM Studio çš„æ–¹æ¡ˆæ›´ç®€å•çœäº‹ã€‚</p>
<hr/>
<h2 data-id="heading-5">äº”ã€å†™åœ¨æœ€å</h2>
<p>éœ€è¦å®¢è§‚çœ‹å¾…çš„æ˜¯ï¼Œ<strong>æœ¬åœ°æ¨¡å‹ç›®å‰æ›´é€‚åˆä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ</strong>ï¼Œè€Œä¸æ˜¯å®Œå…¨æ›¿ä»£ã€‚</p>
<p>åœ¨æ˜¾å¡é…ç½®æœ‰é™çš„æƒ…å†µä¸‹ï¼Œé€Ÿåº¦å’Œä»£ç è´¨é‡éƒ½ä¼šæ˜æ˜¾å¼±äºå®˜æ–¹ Claudeï¼Œä½†å®ƒçš„ä»·å€¼åœ¨äºï¼š
é¢åº¦ç”¨å®Œä¹Ÿèƒ½ç»§ç»­å†™ä»£ç 
å¿ƒæµä¸ä¸­æ–­
å¯éšæ—¶åˆ‡å›å®˜æ–¹æ¨¡å‹
å®Œå…¨æœ¬åœ°è¿è¡Œï¼Œéšç§æ›´å¯æ§</p>
<p>å¦å¤–ï¼Œå¦‚æœä½ è§‰å¾—æœ¬åœ°éƒ¨ç½²è¿˜æ˜¯å¤ªæŠ˜è…¾ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä¸€äº›å›½å†…çš„ä¸­è½¬æˆ–é•œåƒæ–¹æ¡ˆã€‚
æˆ‘è¿™è¾¹æ˜¯å’Œæœ‹å‹ä¸€èµ·æ­è¿‡ä¸€å¥—ï¼Œç¨³å®šæ€§è¿˜ä¸é”™ï¼Œä¸»è¦æ˜¯çœå»äº†ç¯å¢ƒé…ç½®çš„æˆæœ¬ã€‚</p>
<p>æœ‰éœ€è¦çš„è¯å¯ä»¥çœ‹æˆ‘ä¸»é¡µæˆ–è€…ç§ä¿¡ï¼Œæˆ‘å¯ä»¥æŠŠæ€è·¯æˆ–æ³¨æ„äº‹é¡¹äº¤æµä¸€ä¸‹ã€‚</p>
<hr/>
<p>å¯¹äºéœ€è¦é•¿æ—¶é—´ç¼–ç ã€åˆä¸æƒ³è¢«é¢åº¦é™åˆ¶æ‰“æ–­å¿ƒæµçš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™äº›æ–¹æ¡ˆéƒ½å€¼å¾—ä¸€è¯•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å·¥ç¨‹åŒ– - Viteåˆå§‹åŒ–Vueé¡¹ç›®åŠä»£ç è§„èŒƒé…ç½®]]></title>    <link>https://juejin.cn/post/7602816610932277311</link>    <guid>https://juejin.cn/post/7602816610932277311</guid>    <pubDate>2026-02-05T00:40:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602816610932277311" data-draft-id="7602807243705204799" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å·¥ç¨‹åŒ– - Viteåˆå§‹åŒ–Vueé¡¹ç›®åŠä»£ç è§„èŒƒé…ç½®"/> <meta itemprop="keywords" content="å‰ç«¯å·¥ç¨‹åŒ–,Vite,Vue.js"/> <meta itemprop="datePublished" content="2026-02-05T00:40:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="EchoEcho"/> <meta itemprop="url" content="https://juejin.cn/user/2920774267837208"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å·¥ç¨‹åŒ– - Viteåˆå§‹åŒ–Vueé¡¹ç›®åŠä»£ç è§„èŒƒé…ç½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2920774267837208/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    EchoEcho
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T00:40:58.000Z" title="Thu Feb 05 2026 00:40:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰ç«¯å·¥ç¨‹åŒ–æ˜¯é€šè¿‡å·¥å…·å’Œè§„èŒƒï¼Œæå‡å¼€å‘æ•ˆç‡ã€ä»£ç è´¨é‡å’Œå›¢é˜Ÿåä½œçš„ç³»ç»ŸåŒ–æ–¹æ¡ˆã€‚å¤§è‡´åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>ä»£ç è§„èŒƒ</li>
<li>Git Hooks</li>
<li>ç¯å¢ƒå˜é‡</li>
<li>æ„å»ºä¼˜åŒ–</li>
</ul>
<p><strong>æœ¬æ–‡å†…å®¹åŒ…å«</strong>ï¼š</p>
<ol>
<li><a href="#%E4%BD%BF%E7%94%A8vite%E5%88%9B%E5%BB%BAvue%E9%A1%B9%E7%9B%AE" title="#%E4%BD%BF%E7%94%A8vite%E5%88%9B%E5%BB%BAvue%E9%A1%B9%E7%9B%AE">ä½¿ç”¨ vite åˆ›å»º vue é¡¹ç›®</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%A0%BC%E5%BC%8F%E5%8C%96" title="#%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%A0%BC%E5%BC%8F%E5%8C%96">é…ç½®ä»£ç è§„èŒƒåŠç›¸å…³æ ¼å¼åŒ–</a></li>
<li>
<ul>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A0%A1%E9%AA%8C" title="#%E9%85%8D%E7%BD%AE%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A0%A1%E9%AA%8C">é…ç½®æ ¼å¼åŒ–æ ¡éªŒ</a></li>
<li><a href="#%E9%85%8D%E7%BD%AEcss%E6%A0%BC%E5%BC%8F%E6%A0%A1%E9%AA%8C%E5%8F%8A%E5%85%B6%E4%BB%96" title="#%E9%85%8D%E7%BD%AEcss%E6%A0%BC%E5%BC%8F%E6%A0%A1%E9%AA%8C%E5%8F%8A%E5%85%B6%E4%BB%96">é…ç½®cssæ ¼å¼æ ¡éªŒåŠå…¶ä»–</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BF%9D%E5%AD%98%E6%97%B6%E8%87%AA%E5%8A%A8%E6%A0%BC%E5%BC%8F%E5%8C%96" title="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BF%9D%E5%AD%98%E6%97%B6%E8%87%AA%E5%8A%A8%E6%A0%BC%E5%BC%8F%E5%8C%96">é…ç½®æ–‡ä»¶ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–</a></li>
</ul>
</li>
</ol>
<h3 data-id="heading-0">ä¸€ã€ä½¿ç”¨viteåˆ›å»ºvueé¡¹ç›®</h3>
<h4 data-id="heading-1">åˆå§‹åŒ–é¡¹ç›®</h4>
<pre><code class="hljs language-lua" lang="lua">pnpm <span class="hljs-built_in">create</span> vue
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88ed00619c68491d9489d84685c6a45d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWNob0VjaG8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770856857&amp;x-signature=7fR3%2BfLCNkbxF%2BMlc3Grl11J%2B38%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æŒ‰éœ€å®Œå–„é¡¹ç›®ç»“æ„</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e83dcfc949c04594961ee8f5cca16ac2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWNob0VjaG8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770856857&amp;x-signature=cvxCv%2F1KaO7oDkcs%2BWR%2FmX6wKA4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-2">è®¾ç½®åˆ«å</h4>
<p>ä¿®æ”¹<code>vite.config.ts</code></p>
<pre><code class="hljs language-csharp" lang="csharp">import path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>
â€‹
...
resolve: {
 Â  Â <span class="hljs-keyword">alias</span>: {
 Â  Â  Â  Â <span class="hljs-string">'@'</span>: path.resolve(__dirname, <span class="hljs-string">'src'</span>),
 Â   }
}
...
</code></pre>
<p>ä¿®æ”¹<code>tsconfig.app.json</code></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
 Â  Â <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
 Â  Â  Â  Â <span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"."</span><span class="hljs-punctuation">,</span>
 Â  Â  Â  Â <span class="hljs-attr">"paths"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">"@/*"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"src/*"</span><span class="hljs-punctuation">]</span>
 Â  Â  Â   <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
 Â   <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-3">ä¸ºé¡¹ç›®æ·»åŠ è‡ªåŠ¨å¯¼å…¥</h4>
<pre><code class="hljs language-arduino" lang="arduino">pnpm add -D unplugin-<span class="hljs-keyword">auto</span>-<span class="hljs-keyword">import</span> unplugin-vue-components
</code></pre>
<p>ä¿®æ”¹<code>vite.config.ts</code></p>
<pre><code class="hljs language-php" lang="php">import AutoImport <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-auto-import/vite'</span>
import Components <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-vue-components/vite'</span>
â€‹
export <span class="hljs-keyword">default</span> <span class="hljs-title function_ invoke__">defineConfig</span>({
 Â  <span class="hljs-attr">Â plugins</span>: [
 Â  Â  Â  Â <span class="hljs-title function_ invoke__">vue</span>(),
 Â  Â  Â  Â // æ–°å¢
 Â  Â  Â  Â <span class="hljs-title function_ invoke__">AutoImport</span>({
 Â  Â  Â  Â  Â  <span class="hljs-attr">Â imports</span>: [<span class="hljs-string">'vue'</span>],
 Â  Â  Â  Â  Â  <span class="hljs-attr">Â dts</span>: <span class="hljs-string">'./src/auto-imports.d.ts'</span>,
 Â  Â  Â  Â  Â  <span class="hljs-attr">Â eslintrc</span>: {
 Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">Â enabled</span>: <span class="hljs-literal">true</span>,
 Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">Â filepath</span>: <span class="hljs-string">'./src/.eslintrc-auto-import.json'</span>,
 Â  Â  Â  Â  Â   }
 Â  Â  Â   }),
 Â  Â  Â  Â // æ–°å¢
 Â  Â  Â  Â <span class="hljs-title function_ invoke__">Components</span>({
 Â  Â  Â  Â  Â  <span class="hljs-attr">Â dirs</span>: [<span class="hljs-string">'src/components'</span>],
 Â  Â  Â  Â  Â  <span class="hljs-attr">Â extensions</span>: [<span class="hljs-string">'vue'</span>],
 Â  Â  Â  Â  Â  <span class="hljs-attr">Â deep</span>: <span class="hljs-literal">true</span>,
 Â  Â  Â  Â  Â  <span class="hljs-attr">Â dts</span>: <span class="hljs-string">'./src/components.d.ts'</span>,
 Â  Â  Â  Â  Â  <span class="hljs-attr">Â resolvers</span>: []
 Â  Â  Â   })
 Â   ]
})
</code></pre>
<p>ä¿®æ”¹<code>tsconfig.app.json</code></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
 Â ...
 Â <span class="hljs-attr">"include"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
 Â  Â <span class="hljs-string">"src/**/*.ts"</span><span class="hljs-punctuation">,</span>
 Â  Â <span class="hljs-string">"src/**/*.tsx"</span><span class="hljs-punctuation">,</span>
 Â  Â <span class="hljs-string">"src/**/*.vue"</span><span class="hljs-punctuation">,</span>
 Â  Â <span class="hljs-string">"src/auto-imports.d.ts"</span><span class="hljs-punctuation">,</span> Â  <span class="hljs-comment">// æ–°å¢</span>
 Â  Â <span class="hljs-string">"src/components.d.ts"</span> Â  Â  <span class="hljs-comment">// æ–°å¢</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-4">äºŒã€é…ç½®ä»£ç è§„èŒƒåŠç›¸å…³æ ¼å¼åŒ–</h3>
<h4 data-id="heading-5">é…ç½®æ ¼å¼åŒ–æ ¡éªŒ</h4>
<blockquote>
<p>ç»Ÿä¸€ä»£ç é£æ ¼ï¼Œè‡ªåŠ¨æ£€æŸ¥å¸¸è§é”™è¯¯å’Œæ½œåœ¨é—®é¢˜</p>
</blockquote>
<ul>
<li>
<p>ESLint: ä»£ç è´¨é‡æ£€æŸ¥ï¼ˆè¯­æ³•ã€æœ€ä½³å®è·µï¼‰</p>
<blockquote>
<p>ESLint 9.x ä¸å†æ”¯æŒ .eslintrc.*ï¼Œéœ€è¦ä½¿ç”¨æ–°çš„æ‰å¹³é…ç½®æ ¼å¼ eslint.config.js</p>
</blockquote>
</li>
<li>
<p>Prettier: ä»£ç æ ¼å¼åŒ–ï¼ˆç¼©ç´§ã€å¼•å·ã€åˆ†å·ç­‰ï¼‰</p>
</li>
<li>
<p>ä¾èµ–ï¼š</p>
</li>
</ul>

<pre><code class="hljs language-sql" lang="sql">pnpm <span class="hljs-keyword">add</span> <span class="hljs-operator">-</span>D \
eslint \
<span class="hljs-variable">@typescript</span><span class="hljs-operator">-</span>eslint<span class="hljs-operator">/</span>parser \
<span class="hljs-variable">@typescript</span><span class="hljs-operator">-</span>eslint<span class="hljs-operator">/</span>eslint<span class="hljs-operator">-</span>plugin \
eslint<span class="hljs-operator">-</span>plugin<span class="hljs-operator">-</span>vue \
<span class="hljs-variable">@eslint</span><span class="hljs-operator">/</span>js \
vue<span class="hljs-operator">-</span>eslint<span class="hljs-operator">-</span>parser \
prettier \
eslint<span class="hljs-operator">-</span>config<span class="hljs-operator">-</span>prettier \
eslint<span class="hljs-operator">-</span>plugin<span class="hljs-operator">-</span>prettier
</code></pre>
<ul>
<li>é…ç½®æ–‡ä»¶ï¼š <code>eslint.config.js</code>ã€<code>.prettierrc.cjs</code>ã€<code>.prettierignore</code></li>
<li>è„šæœ¬ï¼šåœ¨<code>package.json</code>ä¸­æ·»åŠ æ£€éªŒå’Œæ ¼å¼åŒ–å‘½ä»¤</li>
</ul>
<p>æ·»åŠ <code>eslint.config.js</code></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> js <span class="hljs-keyword">from</span> <span class="hljs-string">'@eslint/js'</span>
<span class="hljs-keyword">import</span> tsPlugin <span class="hljs-keyword">from</span> <span class="hljs-string">'@typescript-eslint/eslint-plugin'</span>
<span class="hljs-keyword">import</span> tsParser <span class="hljs-keyword">from</span> <span class="hljs-string">'@typescript-eslint/parser'</span>
<span class="hljs-keyword">import</span> vueParser <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-eslint-parser'</span>
<span class="hljs-keyword">import</span> vuePlugin <span class="hljs-keyword">from</span> <span class="hljs-string">'eslint-plugin-vue'</span>
<span class="hljs-keyword">import</span> prettierConfig <span class="hljs-keyword">from</span> <span class="hljs-string">'eslint-config-prettier'</span>
<span class="hljs-keyword">import</span> prettierPlugin <span class="hljs-keyword">from</span> <span class="hljs-string">'eslint-plugin-prettier'</span>
â€‹
exportdefault [
 Â  Â <span class="hljs-comment">// åŸºç¡€é…ç½®</span>
 Â  Â js.<span class="hljs-property">configs</span>.<span class="hljs-property">recommended</span>,
â€‹
 Â  Â <span class="hljs-comment">// å…¨å±€å¿½ç•¥</span>
 Â   {
 Â  Â  Â  Â <span class="hljs-attr">ignores</span>: [<span class="hljs-string">'node_modules/**'</span>, <span class="hljs-string">'dist/**'</span>, <span class="hljs-string">'*.config.*'</span>, <span class="hljs-string">'pnpm-lock.yaml'</span>],
 Â   },
â€‹
 Â  Â <span class="hljs-comment">// vueæ–‡ä»¶é…ç½®</span>
 Â   {
 Â  Â  Â  Â <span class="hljs-attr">files</span>: [<span class="hljs-string">'**/*.vue'</span>],
 Â  Â  Â  Â <span class="hljs-attr">languageOptions</span>: {
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">parser</span>: vueParser,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">parserOptions</span>: {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">parser</span>: tsParser,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-string">'latest'</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'module'</span>,
 Â  Â  Â  Â  Â   },
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">globals</span>: {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">console</span>: <span class="hljs-string">'readonly'</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">process</span>: <span class="hljs-string">'readonly'</span>,
 Â  Â  Â  Â  Â   },
 Â  Â  Â   },
 Â  Â  Â  Â <span class="hljs-attr">plugins</span>: {
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">vue</span>: vuePlugin,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint'</span>: tsPlugin,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">prettier</span>: prettierPlugin,
 Â  Â  Â   },
 Â  Â  Â  Â <span class="hljs-comment">/**
 Â  Â  Â  Â  * "off" æˆ– 0 Â   ==&gt;  å…³é—­è§„åˆ™
 Â  Â  Â  Â  * "warn" æˆ– 1 Â  ==&gt;  æ‰“å¼€çš„è§„åˆ™ä½œä¸ºè­¦å‘Šï¼ˆä¸å½±å“ä»£ç æ‰§è¡Œï¼‰
 Â  Â  Â  Â  * "error" æˆ– 2  ==&gt;  è§„åˆ™ä½œä¸ºä¸€ä¸ªé”™è¯¯ï¼ˆä»£ç ä¸èƒ½æ‰§è¡Œï¼Œç•Œé¢æŠ¥é”™ï¼‰
 Â  Â  Â  Â  */</span>
 Â  Â  Â  Â <span class="hljs-attr">rules</span>: {
 Â  Â  Â  Â  Â  Â ...prettierConfig.<span class="hljs-property">rules</span>,
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// eslint è§„åˆ™</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'no-var'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// è¦æ±‚ä½¿ç”¨ let æˆ– const è€Œä¸æ˜¯ var</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'no-multiple-empty-lines'</span>: [<span class="hljs-string">'error'</span>, { <span class="hljs-attr">max</span>: <span class="hljs-number">1</span> }], <span class="hljs-comment">// ä¸å…è®¸å¤šä¸ªç©ºè¡Œ</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'prefer-const'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ä½¿ç”¨ let å…³é”®å­—å£°æ˜ä½†åœ¨åˆå§‹åˆ†é…åä»æœªé‡æ–°åˆ†é…çš„å˜é‡ï¼Œè¦æ±‚ä½¿ç”¨ const</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'no-use-before-define'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢åœ¨ å‡½æ•°/ç±»/å˜é‡ å®šä¹‰ä¹‹å‰ä½¿ç”¨å®ƒä»¬</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'no-param-reassign'</span>: [<span class="hljs-string">'error'</span>, { <span class="hljs-attr">props</span>: <span class="hljs-literal">false</span> }], <span class="hljs-comment">// ç¦æ­¢ä¿®æ”¹å‡½æ•°å‚æ•°</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'max-classes-per-file'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢ç±»è¶…è¿‡ä¸€ä¸ªæ–‡ä»¶</span>
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// typescript è§„åˆ™</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-unused-vars'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// ç¦æ­¢å®šä¹‰æœªä½¿ç”¨çš„å˜é‡</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-empty-function'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// ç¦æ­¢ç©ºå‡½æ•°</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/prefer-ts-expect-error'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// ç¦æ­¢ä½¿ç”¨ @ts-ignore</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/ban-ts-comment'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// ç¦æ­¢ @ts-&lt;directive&gt; ä½¿ç”¨æ³¨é‡Šæˆ–è¦æ±‚åœ¨æŒ‡ä»¤åè¿›è¡Œæè¿°</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-inferrable-types'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢å¯¹åˆå§‹åŒ–ä¸ºæ•°å­—ã€å­—ç¬¦ä¸²æˆ–å¸ƒå°”å€¼çš„å˜é‡æˆ–å‚æ•°è¿›è¡Œæ˜¾å¼ç±»å‹å£°æ˜</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-namespace'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢ä½¿ç”¨ namespace å£°æ˜</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-explicit-any'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢ä½¿ç”¨ any ç±»å‹</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/ban-types'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢ä½¿ç”¨ any ç±»å‹</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-var-requires'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢ä½¿ç”¨ require è¯­å¥</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-non-null-assertion'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢ä½¿ç”¨ ! æ–­è¨€</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-use-before-define'</span>: [
 Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'error'</span>,
 Â  Â  Â  Â  Â  Â   {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">functions</span>: <span class="hljs-literal">false</span>,
 Â  Â  Â  Â  Â  Â   },
 Â  Â  Â  Â  Â   ],
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// vue è§„åˆ™</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 'vue/script-setup-uses-vars': 'error', // è¦æ±‚åœ¨ script setup ä¸­ä½¿ç”¨å·²å®šä¹‰çš„å˜é‡</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/v-slot-style'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// è¦æ±‚ v-slot æŒ‡ä»¤çš„å†™æ³•æ­£ç¡®</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/no-mutating-props'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// ç¦æ­¢ä¿®æ”¹ç»„ä»¶çš„ props</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/custom-event-name-casing'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// è¦æ±‚è‡ªå®šä¹‰äº‹ä»¶åç§°ç¬¦åˆ kebab-case è§„èŒƒ</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/html-closing-bracket-newline'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// è¦æ±‚ HTML é—­åˆæ ‡ç­¾æ¢è¡Œ</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/attribute-hyphenation'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// å¯¹æ¨¡æ¿ä¸­çš„è‡ªå®šä¹‰ç»„ä»¶å¼ºåˆ¶æ‰§è¡Œå±æ€§å‘½åæ ·å¼ï¼šmy-prop="prop"</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/attributes-order'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// vue apiä½¿ç”¨é¡ºåºï¼Œå¼ºåˆ¶æ‰§è¡Œå±æ€§é¡ºåº</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/no-v-html'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢ä½¿ç”¨ v-html</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/require-default-prop'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// æ­¤è§„åˆ™è¦æ±‚ä¸ºæ¯ä¸ª prop ä¸ºå¿…å¡«æ—¶ï¼Œå¿…é¡»æä¾›é»˜è®¤å€¼</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/multi-word-component-names'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// è¦æ±‚ç»„ä»¶åç§°å§‹ç»ˆä¸º â€œ-â€ é“¾æ¥çš„å•è¯</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/no-setup-props-destructure'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢è§£æ„ props ä¼ é€’ç»™ setup</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/max-len'</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// å¼ºåˆ¶æ‰€æœ‰è¡Œéƒ½å°äº 80 ä¸ªå­—ç¬¦</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'vue/singleline-html-element-content-newline'</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// å¼ºåˆ¶å•è¡Œå…ƒç´ çš„å†…å®¹æŠ˜è¡Œ</span>
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// Prettier è§„åˆ™</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'prettier/prettier'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// å¼ºåˆ¶ä½¿ç”¨ prettier æ ¼å¼åŒ–ä»£ç </span>
 Â  Â  Â   }
 Â   },
 Â  Â <span class="hljs-comment">// jsæ–‡ä»¶é…ç½®</span>
 Â   {
 Â  Â  Â  Â <span class="hljs-attr">files</span>: [<span class="hljs-string">'**/*.{js,jsx,cjs,mjs,ts,tsx,cts,mts}'</span>],
 Â  Â  Â  Â <span class="hljs-attr">languageOptions</span>: {
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">parser</span>: tsParser,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">parserOptions</span>: {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-string">'latest'</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'module'</span>,
 Â  Â  Â  Â  Â   },
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">globals</span>: {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">console</span>: <span class="hljs-string">'readonly'</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">process</span>: <span class="hljs-string">'readonly'</span>,
 Â  Â  Â  Â  Â   }
 Â  Â  Â   },
 Â  Â  Â  Â <span class="hljs-attr">plugins</span>: {
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint'</span>: tsPlugin,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">prettier</span>: prettierPlugin,
 Â  Â  Â   },
 Â  Â  Â  Â <span class="hljs-attr">rules</span>: {
 Â  Â  Â  Â  Â  Â ...prettierConfig.<span class="hljs-property">rules</span>,
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// eslint è§„åˆ™</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'no-var'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// è¦æ±‚ä½¿ç”¨ let æˆ– const è€Œä¸æ˜¯ var</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'no-multiple-empty-lines'</span>: [<span class="hljs-string">'error'</span>, { <span class="hljs-attr">max</span>: <span class="hljs-number">1</span> }], <span class="hljs-comment">// ä¸å…è®¸å¤šä¸ªç©ºè¡Œ</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'prefer-const'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ä½¿ç”¨ let å…³é”®å­—å£°æ˜ä½†åœ¨åˆå§‹åˆ†é…åä»æœªé‡æ–°åˆ†é…çš„å˜é‡ï¼Œè¦æ±‚ä½¿ç”¨ const</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'no-use-before-define'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-comment">// ç¦æ­¢åœ¨ å‡½æ•°/ç±»/å˜é‡ å®šä¹‰ä¹‹å‰ä½¿ç”¨å®ƒä»¬</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'prettier/prettier'</span>: <span class="hljs-string">'error'</span>, <span class="hljs-comment">// å¼ºåˆ¶ä½¿ç”¨ prettier æ ¼å¼åŒ–ä»£ç </span>
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// TypeScript è§„åˆ™</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-unused-vars'</span>: <span class="hljs-string">'error'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-empty-function'</span>: <span class="hljs-string">'error'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/prefer-ts-expect-error'</span>: <span class="hljs-string">'error'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/ban-ts-comment'</span>: <span class="hljs-string">'error'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-inferrable-types'</span>: <span class="hljs-string">'off'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-namespace'</span>: <span class="hljs-string">'off'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-explicit-any'</span>: <span class="hljs-string">'off'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/ban-types'</span>: <span class="hljs-string">'off'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-var-requires'</span>: <span class="hljs-string">'off'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-non-null-assertion'</span>: <span class="hljs-string">'off'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'@typescript-eslint/no-use-before-define'</span>: [
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'error'</span>,
 Â  Â  Â  Â  Â  Â  Â   {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">functions</span>: <span class="hljs-literal">false</span>,
 Â  Â  Â  Â  Â  Â  Â   },
 Â  Â  Â  Â  Â   ],
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'prettier/prettier'</span>: <span class="hljs-string">'error'</span>,
 Â  Â  Â   }
 Â   }
]
</code></pre>
<p>æ·»åŠ <code>.prettierrc.cjs</code></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
 * Prettier ä»£ç æ ¼å¼åŒ–é…ç½®
 * æ–‡æ¡£ï¼šhttps://prettier.io/docs/en/configuration.html
 */</span>
<span class="hljs-keyword">module</span>.exports= {
 Â <span class="hljs-comment">// æ˜¯å¦åœ¨è¯­å¥æœ«å°¾æ·»åŠ åˆ†å·</span>
 Â semi: <span class="hljs-literal">false</span>,
 Â <span class="hljs-comment">// æ˜¯å¦ä½¿ç”¨å•å¼•å·</span>
 Â singleQuote: <span class="hljs-literal">true</span>,
 Â <span class="hljs-comment">// è®¾ç½®ç¼©è¿›</span>
 Â tabWidth: <span class="hljs-number">2</span>,
 Â <span class="hljs-comment">// å°¾éšé€—å·</span>
 Â trailingComma: <span class="hljs-string">'es5'</span>,
 Â <span class="hljs-comment">// æ¯è¡Œæœ€å¤§å­—ç¬¦æ•°</span>
 Â printWidth: <span class="hljs-number">120</span>,
 Â <span class="hljs-comment">// ç®­å¤´å‡½æ•°å‚æ•°æ‹¬å·ï¼š avoid( é¿å… ) | always( æ€»æ˜¯ )</span>
 Â arrowParens: <span class="hljs-string">'avoid'</span>,
 Â <span class="hljs-comment">// æ–‡ä»¶è¡Œå°¾ï¼š lf( æ¢è¡Œ ) | crlf( å›è½¦æ¢è¡Œ ) | auto( è‡ªåŠ¨ )</span>
 Â endOfLine: <span class="hljs-string">'lf'</span>,
}
</code></pre>
<p>æ·»åŠ <code>.prettierignore</code></p>
<pre><code class="hljs language-csharp" lang="csharp">node_modules
dist
*.specstory
*.local
pnpm-<span class="hljs-keyword">lock</span>.yaml
package-<span class="hljs-keyword">lock</span>.json
.DS_Store
coverage
.vscode
.idea
<span class="hljs-keyword">public</span>
</code></pre>
<p>åœ¨<code>package.json</code>ä¸­æ·»åŠ ç›¸å…³<code>scripts</code></p>
<pre><code class="hljs language-json" lang="json">...
<span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
 Â ...
 Â  Â <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint . --fix"</span><span class="hljs-punctuation">,</span>
 Â  Â <span class="hljs-attr">"format"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"prettier --write "</span>src<span class="hljs-comment">/**/</span>*.<span class="hljs-punctuation">{</span>js<span class="hljs-punctuation">,</span>ts<span class="hljs-punctuation">,</span>vue<span class="hljs-punctuation">,</span>json<span class="hljs-punctuation">,</span>css<span class="hljs-punctuation">,</span>scss<span class="hljs-punctuation">,</span>md<span class="hljs-punctuation">}</span><span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
 Â  Â <span class="hljs-attr">"lint:check"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint ."</span><span class="hljs-punctuation">,</span>
 Â  Â <span class="hljs-attr">"format:check"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"prettier --check "</span>src<span class="hljs-comment">/**/</span>*.<span class="hljs-punctuation">{</span>js<span class="hljs-punctuation">,</span>ts<span class="hljs-punctuation">,</span>vue<span class="hljs-punctuation">,</span>json<span class="hljs-punctuation">,</span>css<span class="hljs-punctuation">,</span>scss<span class="hljs-punctuation">,</span>md<span class="hljs-punctuation">}</span><span class="hljs-string">""</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
...
</code></pre>
<h4 data-id="heading-6">é…ç½®<code>css</code>æ ¼å¼æ ¡éªŒåŠå…¶ä»–</h4>
<ul>
<li>Stylelint: <code>css/scss</code>æ ·å¼æ ¡éªŒå’Œæ ¼å¼åŒ–ï¼Œç»Ÿä¸€æ ·å¼ä»£ç é£æ ¼ï¼Œå‘ç°æ ·å¼é”™è¯¯</li>
<li>EditorConfig: ç»Ÿä¸€ç¼–è¾‘å™¨é…ç½®ï¼Œä¿è¯è·¨ç¼–è¾‘å™¨ä¿æŒä¸€è‡´çš„ç¼–ç é£æ ¼</li>
<li>Commitlint: Git æäº¤ä¿¡æ¯æ ¼å¼æ ¡éªŒï¼Œè§„èŒƒæäº¤ä¿¡æ¯ï¼Œä¾¿äºè¿½è¸ªå’Œç”Ÿæˆchangeling</li>
<li>Husky + lint-staged: Git hooks è‡ªåŠ¨åŒ–æ ¡éªŒï¼Œä»£ç æäº¤å‰è‡ªåŠ¨æ£€æŸ¥ï¼Œé¿å…æäº¤ä¸ç¬¦åˆè§„èŒƒçš„ä»£ç </li>
</ul>
<ol>
<li>
<p>å®‰è£…ç›¸å…³ä¾èµ–</p>
<pre><code class="hljs language-arduino" lang="arduino"># åŸºç¡€ä¾èµ–ï¼ˆå¿…éœ€ï¼‰
<span class="hljs-meta"># stylelint-config-html: HTML/Vueæ¨¡æ¿æ ·å¼æ ¼å¼åŒ–</span>
<span class="hljs-meta"># stylelint-config-recess-order: csså±æ€§ä¹¦å†™é¡ºåº</span>
<span class="hljs-meta"># stylelint-config-recommended-vue: Vueæ¨èé…ç½®</span>
pnpm add -D \
  stylelint \
  stylelint-config-standard \
  stylelint-config-standard-vue \
  stylelint-config-prettier \
  stylelint-config-html \ 
  stylelint-config-recess-order \ Â 
  stylelint-config-recommended-vue \ 
  @commitlint/cli \
  @commitlint/config-conventional \
  husky \
  lint-staged \
  postcss-html 
â€‹
â€‹
# å¯é€‰ä¾èµ–ï¼ˆæ ¹æ®é¡¹ç›®éœ€è¦ï¼‰
# å¦‚æœä½¿ç”¨ Tailwind CSS
pnpm add -D stylelint-config-tailwindcss
â€‹
# å¦‚æœä½¿ç”¨SCSS
pnpm add -D stylelint-config-standard-scss stylelint-scss
</code></pre>
</li>
</ol>

<ol>
<li>
<p>åˆ›å»º<code>.stylelintrc.cjs</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span>= {
 Â <span class="hljs-comment">// ç»§æ‰¿è§„åˆ™</span>
 Â extends: [
 Â  Â <span class="hljs-string">'stylelint-config-standard'</span>, <span class="hljs-comment">// é…ç½® stylelint æ‹“å±•æ’ä»¶</span>
 Â  Â <span class="hljs-string">'stylelint-config-html/vue'</span>, <span class="hljs-comment">// é…ç½® vue ä¸­ template æ ·å¼æ ¼å¼åŒ–</span>
 Â  Â <span class="hljs-string">'stylelint-config-recess-order'</span>, <span class="hljs-comment">// é…ç½® stylelint css å±æ€§ä¹¦å†™é¡ºåºæ’ä»¶,</span>
 Â  Â <span class="hljs-string">'stylelint-config-standard-scss'</span>, <span class="hljs-comment">// é…ç½® stylelint scss æ’ä»¶</span>
 Â  Â <span class="hljs-string">'stylelint-config-recommended-vue/scss'</span>, <span class="hljs-comment">// é…ç½® vue ä¸­ scss æ ·å¼æ ¼å¼åŒ–</span>
 Â  Â <span class="hljs-string">'stylelint-config-tailwindcss'</span>,
  ],
 Â overrides: [
 Â  Â <span class="hljs-comment">// æ‰«æ .vue/html æ–‡ä»¶ä¸­çš„ &lt;style&gt; æ ‡ç­¾å†…çš„æ ·å¼</span>
 Â   {
 Â  Â  Â files: [<span class="hljs-string">'**/*.{vue,html}'</span>],
 Â  Â  Â <span class="hljs-comment">// ä½¿ç”¨ postcss-html è§£æå™¨</span>
 Â  Â  Â customSyntax: <span class="hljs-string">'postcss-html'</span>,
 Â   },
  ],
 Â rules: {
 Â  Â <span class="hljs-string">'keyframes-name-pattern'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// å¼ºåˆ¶å…³é”®å¸§åç§°çš„æ ¼å¼</span>
 Â  Â <span class="hljs-string">'custom-property-pattern'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// å¼ºåˆ¶è‡ªå®šä¹‰å±æ€§çš„æ ¼å¼</span>
 Â  Â <span class="hljs-string">'selector-id-pattern'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// å¼ºåˆ¶é€‰æ‹©å™¨ ID çš„æ ¼å¼</span>
 Â  Â <span class="hljs-string">'declaration-block-no-redundant-longhand-properties'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// ç¦æ­¢å†—ä½™çš„é•¿å±æ€§</span>
 Â  Â <span class="hljs-string">'function-url-quotes'</span>: <span class="hljs-string">'always'</span>, <span class="hljs-comment">// URL çš„å¼•å· "always(å¿…é¡»åŠ ä¸Šå¼•å·)"|"never(æ²¡æœ‰å¼•å·)"</span>
 Â  Â <span class="hljs-string">'color-hex-length'</span>: <span class="hljs-string">'long'</span>, <span class="hljs-comment">// æŒ‡å®š 16 è¿›åˆ¶é¢œè‰²çš„ç®€å†™æˆ–æ‰©å†™ "short(16è¿›åˆ¶ç®€å†™)"|"long(16è¿›åˆ¶æ‰©å†™)"</span>
 Â  Â <span class="hljs-string">'rule-empty-line-before'</span>: <span class="hljs-string">'never'</span>, <span class="hljs-comment">// è¦æ±‚æˆ–ç¦æ­¢åœ¨è§„åˆ™ä¹‹å‰çš„ç©ºè¡Œ "always(è§„åˆ™ä¹‹å‰å¿…é¡»å§‹ç»ˆæœ‰ä¸€ä¸ªç©ºè¡Œ)"|"never(è§„åˆ™å‰ç»ä¸èƒ½æœ‰ç©ºè¡Œ)"|"always-multi-line(å¤šè¡Œè§„åˆ™ä¹‹å‰å¿…é¡»å§‹ç»ˆæœ‰ä¸€ä¸ªç©ºè¡Œ)"|"never-multi-line(å¤šè¡Œè§„åˆ™ä¹‹å‰ç»ä¸èƒ½æœ‰ç©ºè¡Œ)"</span>
 Â  Â <span class="hljs-string">'font-family-no-missing-generic-family-keyword'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// ç¦æ­¢åœ¨å­—ä½“æ—åç§°åˆ—è¡¨ä¸­ç¼ºå°‘é€šç”¨å­—ä½“æ—å…³é”®å­—</span>
 Â  Â <span class="hljs-string">'property-no-unknown'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// ç¦æ­¢æœªçŸ¥çš„å±æ€§</span>
 Â  Â <span class="hljs-string">'no-empty-source'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// ç¦æ­¢ç©ºæºç </span>
 Â  Â <span class="hljs-string">'selector-class-pattern'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// å¼ºåˆ¶é€‰æ‹©å™¨ç±»åçš„æ ¼å¼</span>
 Â  Â <span class="hljs-string">'value-no-vendor-prefix'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// å…³é—­ vendor-prefix (ä¸ºäº†è§£å†³å¤šè¡Œçœç•¥ -webkit-box)</span>
 Â  Â <span class="hljs-string">'no-descending-specificity'</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// ä¸å…è®¸è¾ƒä½ç‰¹å¼‚æ€§çš„é€‰æ‹©å™¨å‡ºç°åœ¨è¦†ç›–è¾ƒé«˜ç‰¹å¼‚æ€§çš„é€‰æ‹©å™¨</span>
 Â  Â <span class="hljs-comment">// ç¦æ­¢æœªçŸ¥çš„ä¼ªç±»</span>
 Â  Â <span class="hljs-string">'selector-pseudo-class-no-unknown'</span>: [
 Â  Â  Â <span class="hljs-literal">true</span>,
 Â  Â   {
 Â  Â  Â  Â ignorePseudoClasses: [<span class="hljs-string">'global'</span>, <span class="hljs-string">'v-deep'</span>, <span class="hljs-string">'deep'</span>],
 Â  Â   },
 Â   ],
 Â  Â <span class="hljs-comment">// ç¦æ­¢æœªçŸ¥çš„ at-rule</span>
 Â  Â <span class="hljs-string">'scss/at-rule-no-unknown'</span>: [
 Â  Â  Â <span class="hljs-literal">true</span>,
 Â  Â   {
 Â  Â  Â  Â ignoreAtRules: [<span class="hljs-string">'tailwind'</span>, <span class="hljs-string">'apply'</span>],
 Â  Â   },
 Â   ],
 Â  Â <span class="hljs-comment">// ç¦æ­¢æœªçŸ¥çš„å‡½æ•°</span>
 Â  Â <span class="hljs-string">'function-no-unknown'</span>: [
 Â  Â  Â <span class="hljs-literal">true</span>,
 Â  Â   {
 Â  Â  Â  Â ignoreFunctions: [<span class="hljs-string">'constant'</span>],
 Â  Â   },
 Â   ],
  },
 Â ignoreFiles: [<span class="hljs-string">'**/*.js'</span>, <span class="hljs-string">'**/*.ts'</span>, <span class="hljs-string">'**/*.jsx'</span>, <span class="hljs-string">'**/*.tsx'</span>, <span class="hljs-string">'node_modules/**'</span>, <span class="hljs-string">'dist/**'</span>],
}
</code></pre>
</li>
</ol>

<ol>
<li>
<p>åˆ›å»º<code>.editorconfig</code></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># EditorConfig æ˜¯å¸®åŠ©å¤šä¸ªç¼–è¾‘å™¨å’Œ IDE ç»´æŠ¤ä¸€è‡´çš„ç¼–ç æ ·å¼çš„é…ç½®æ–‡ä»¶</span>
<span class="hljs-comment"># https://editorconfig.org</span>
â€‹
<span class="hljs-attr">root</span> = <span class="hljs-literal">true</span>
â€‹
<span class="hljs-section">[*]</span> <span class="hljs-comment"># è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶é€‚ç”¨</span>
<span class="hljs-attr">charset</span> = utf-<span class="hljs-number">8</span> <span class="hljs-comment"># è®¾ç½®æ–‡ä»¶å­—ç¬¦é›†ä¸º utf-8</span>
<span class="hljs-attr">end_of_line</span> = lf <span class="hljs-comment"># è®¾ç½®æ–‡ä»¶è¡Œå°¾ä¸º LF</span>
<span class="hljs-attr">indent_style</span> = space <span class="hljs-comment"># ç¼©è¿›é£æ ¼ï¼ˆtab | spaceï¼‰</span>
<span class="hljs-attr">indent_size</span> = <span class="hljs-number">2</span> <span class="hljs-comment"># ç¼©è¿›å¤§å°</span>
<span class="hljs-attr">insert_final_newline</span> = <span class="hljs-literal">true</span> <span class="hljs-comment"># åœ¨æ–‡ä»¶æœ«å°¾æ’å…¥ä¸€ä¸ªæ–°è¡Œ</span>
<span class="hljs-attr">trim_trailing_whitespace</span> = <span class="hljs-literal">true</span> <span class="hljs-comment"># åˆ é™¤è¡Œå°¾çš„ç©ºæ ¼</span>
<span class="hljs-attr">max_line_length</span> = <span class="hljs-number">130</span> <span class="hljs-comment"># æœ€å¤§è¡Œé•¿åº¦</span>
â€‹
<span class="hljs-section">[*.md]</span> <span class="hljs-comment"># è¡¨ç¤ºä»…å¯¹ md æ–‡ä»¶é€‚ç”¨ä»¥ä¸‹è§„åˆ™</span>
<span class="hljs-attr">max_line_length</span> = <span class="hljs-literal">off</span> <span class="hljs-comment"># å…³é—­æœ€å¤§è¡Œé•¿åº¦é™åˆ¶</span>
<span class="hljs-attr">trim_trailing_whitespace</span> = <span class="hljs-literal">false</span> <span class="hljs-comment"># å…³é—­æœ«å°¾ç©ºæ ¼ä¿®å‰ª</span>
â€‹
<span class="hljs-section">[*.{yml,yaml}]</span>
<span class="hljs-attr">indent_size</span> = <span class="hljs-number">2</span> <span class="hljs-comment"># è®¾ç½® yaml æ–‡ä»¶çš„ç¼©è¿›å¤§å°ä¸º 2</span>
â€‹
<span class="hljs-section">[Makefile]</span>
<span class="hljs-attr">indent_style</span> = tab <span class="hljs-comment"># è®¾ç½® Makefile æ–‡ä»¶çš„ç¼©è¿›é£æ ¼ä¸º tab</span>
</code></pre>
</li>
</ol>

<ol>
<li>
<p>åˆ›å»º<code>commitlint.config.js</code>æ–‡ä»¶</p>
<pre><code class="hljs language-php" lang="php">exportdefault {
 Â  Â <span class="hljs-keyword">extends</span>: [<span class="hljs-string">'@commitlint/config-conventional'</span>],
 Â  Â rules: {
 Â  Â  Â  Â <span class="hljs-string">'type-enum'</span>: [
 Â  Â  Â  Â  Â  Â <span class="hljs-number">2</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'always'</span>,
 Â  Â  Â  Â  Â   [
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'feat'</span>, <span class="hljs-comment">// æ–°åŠŸèƒ½</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'fix'</span>, <span class="hljs-comment">// ä¿®å¤é—®é¢˜</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'docs'</span>, <span class="hljs-comment">// æ–‡æ¡£æ›´æ–°</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'style'</span>, <span class="hljs-comment">// ä»£ç æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'refactor'</span>, <span class="hljs-comment">// é‡æ„ä»£ç ï¼ˆæ—¢ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®å¤é—®é¢˜çš„ä»£ç å˜åŠ¨ï¼‰</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'perf'</span>, <span class="hljs-comment">// æ€§èƒ½ä¼˜åŒ–</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'test'</span>, <span class="hljs-comment">// æ·»åŠ æµ‹è¯•</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'chore'</span>, <span class="hljs-comment">// æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'build'</span>, <span class="hljs-comment">// æ‰“åŒ…</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'ci'</span>, <span class="hljs-comment">// CIé…ç½®</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'revert'</span>, <span class="hljs-comment">// å›é€€</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'release'</span>, <span class="hljs-comment">// å‘å¸ƒ</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'wip'</span>, <span class="hljs-comment">// å¼€å‘ä¸­</span>
 Â  Â  Â  Â  Â   ]
 Â  Â  Â   ],
 Â  Â  Â  Â <span class="hljs-comment">// ç±»å‹å¿…é¡»å°å†™</span>
 Â  Â  Â  Â <span class="hljs-string">'type-case'</span>: [
 Â  Â  Â  Â  Â  Â <span class="hljs-number">2</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'always'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'lower-case'</span>
 Â  Â  Â   ],
 Â  Â  Â  Â <span class="hljs-comment">// ç±»å‹ä¸èƒ½ä¸ºç©º</span>
 Â  Â  Â  Â <span class="hljs-string">'type-empty'</span>: [<span class="hljs-number">2</span>, <span class="hljs-string">'never'</span>],
 Â  Â  Â  Â <span class="hljs-comment">// ä½œç”¨åŸŸå¿…é¡»å°å†™</span>
 Â  Â  Â  Â <span class="hljs-string">'scope-case'</span>: [
 Â  Â  Â  Â  Â  Â <span class="hljs-number">2</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'always'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'lower-case'</span>
 Â  Â  Â   ],
 Â  Â  Â  Â <span class="hljs-comment">// ä¸»é¢˜å¿…é¡»å°å†™</span>
 Â  Â  Â  Â <span class="hljs-string">'subject-case'</span>: [
 Â  Â  Â  Â  Â  Â <span class="hljs-number">2</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'always'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'lower-case'</span>
 Â  Â  Â   ],
 Â  Â  Â  Â <span class="hljs-comment">// å¤´éƒ¨æœ€å¤§é•¿åº¦ä¸º 100 ä¸ªå­—ç¬¦</span>
 Â  Â  Â  Â <span class="hljs-string">'header-max-length'</span>: [
 Â  Â  Â  Â  Â  Â <span class="hljs-number">2</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'always'</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-number">100</span>
 Â  Â  Â   ],
 Â  Â  Â  Â <span class="hljs-comment">// ä¸»ä½“å‰é¢å¿…é¡»æœ‰ä¸€ä¸ªç©ºè¡Œ</span>
 Â  Â  Â  Â <span class="hljs-string">'body-leading-blank'</span>: [
 Â  Â  Â  Â  Â  Â <span class="hljs-number">2</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-string">'always'</span>
 Â  Â  Â   ],
 Â   }
}
</code></pre>
</li>
</ol>

<ol>
<li>
<p>åˆ›å»º<code>.lintstagedrc.js</code></p>
<pre><code class="hljs language-arduino" lang="arduino">exportdefault {
 Â <span class="hljs-string">'*.{js,jsx,ts,tsx,vue}'</span>: [<span class="hljs-string">'eslint --fix'</span>, <span class="hljs-string">'prettier --write'</span>],
 Â <span class="hljs-string">'*.{css,scss,less,styl}'</span>: [<span class="hljs-string">'stylelint --fix'</span>, <span class="hljs-string">'prettier --write'</span>],
 Â <span class="hljs-string">'*.{json,md,yml,yaml}'</span>: [<span class="hljs-string">'prettier --write'</span>],
}
</code></pre>
</li>
</ol>

<ol>
<li>
<p>æ›´æ–°<code>package.json</code></p>
<pre><code class="hljs language-swift" lang="swift">{
<span class="hljs-operator">...</span>
<span class="hljs-string">"scripts"</span>: {
 Â  Â <span class="hljs-string">"lint"</span>: <span class="hljs-string">"eslint . --fix"</span>,
 Â  Â <span class="hljs-string">"format"</span>: <span class="hljs-string">"prettier --write "</span>src<span class="hljs-comment">/**/</span><span class="hljs-operator">*</span>.{js,ts,vue,json,css,scss,md}<span class="hljs-string">""</span>,
 Â  Â <span class="hljs-string">"lint:check"</span>: <span class="hljs-string">"eslint ."</span>,
 Â  Â <span class="hljs-string">"format:check"</span>: <span class="hljs-string">"prettier --check "</span>src<span class="hljs-comment">/**/</span><span class="hljs-operator">*</span>.{js,ts,vue,json,css,scss,md}<span class="hljs-string">""</span>,
â€‹
 Â  Â <span class="hljs-string">"lint:style"</span>: <span class="hljs-string">"stylelint "</span><span class="hljs-operator">**/*</span>.{css,scss,vue}<span class="hljs-string">" --fix"</span>,
 Â  Â <span class="hljs-string">"lint:style:check"</span>: <span class="hljs-string">"stylelint "</span><span class="hljs-operator">**/*</span>.{css,scss,vue}<span class="hljs-string">""</span>,
â€‹
 Â  Â <span class="hljs-string">"type-check"</span>: <span class="hljs-string">"vue-tsc --noEmit"</span>,
â€‹
 Â  Â <span class="hljs-string">"check"</span>: <span class="hljs-string">"pnpm lint:check &amp;&amp; pnpm format:check &amp;&amp; pnpm lint:style:check &amp;&amp; pnpm type-check"</span>,
 Â  Â <span class="hljs-string">"fix"</span>: <span class="hljs-string">"pnpm lint &amp;&amp; pnpm format &amp;&amp; pnpm lint:style"</span>,
â€‹
 Â  Â <span class="hljs-string">"prepare"</span>: <span class="hljs-string">"husky install"</span>
},
<span class="hljs-operator">...</span>
}
</code></pre>
</li>
<li>
<p>åˆå§‹åŒ–Huskyï¼ˆGit Hooksï¼‰</p>
<pre><code class="hljs language-arduino" lang="arduino">pnpm prepare
</code></pre>
<p>è¿™ä¼šåœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆ<code>.husky</code>ç›®å½•ï¼Œå…¶ä¸­åŒ…å«äº†<code>_</code>å­ç›®å½•ï¼Œå°†å­ç›®å½•ä¸‹çš„<code>commit-msg</code>å’Œ<code>pre-commit</code>æ–‡ä»¶æ‹·è´åˆ°<code>.husky</code>ç›®å½•ä¸‹ï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><code>.husky/commit-msg</code>æ–‡ä»¶å†…å®¹</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/usr/bin/env sh</span>
. <span class="hljs-string">"<span class="hljs-subst">$(dirname -- <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>)</span> /_/husky.sh"</span>
â€‹
npx --no -- commitlint --edit <span class="hljs-variable">$1</span>
</code></pre>
<p><code>.husky/pre-commit</code>æ–‡ä»¶å†…å®¹</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/usr/bin/env sh</span>
. <span class="hljs-string">"<span class="hljs-subst">$(dirname -- <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>)</span>/_/husky.sh"</span>
â€‹
pnpm lint-staged
</code></pre>
</li>
<li>
<p>éªŒè¯é…ç½®æ–‡ä»¶è¯­æ³•</p>
<p>å¦‚æœæŸäº›éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š</p>
<ul>
<li>
<p>ä¾èµ–æ˜¯å¦å·²æ­£ç¡®å®‰è£…</p>
</li>
<li>
<p>é…ç½®æ–‡ä»¶è¯­æ³•æ˜¯å¦æ­£ç¡®</p>
</li>
<li>
<p>æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®</p>
</li>
</ul>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. éªŒè¯ ESLint é…ç½®</span>
pnpm <span class="hljs-built_in">exec</span> eslint --print-config src/App.vue &gt; /dev/null &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… ESLint é…ç½®æ­£ç¡®"</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">"âŒ ESLint é…ç½®æœ‰è¯¯"</span>
â€‹
<span class="hljs-comment"># 2. éªŒè¯ Prettier é…ç½®</span>
pnpm <span class="hljs-built_in">exec</span> prettier --check . &gt; /dev/null 2&gt;&amp;1 &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… Prettier é…ç½®æ­£ç¡®"</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">"âš ï¸  Prettier å‘ç°æ ¼å¼é—®é¢˜ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼‰"</span>
â€‹
<span class="hljs-comment"># 3. éªŒè¯ Stylelint é…ç½®</span>
pnpm <span class="hljs-built_in">exec</span> stylelint --print-config src/style.css &gt; /dev/null &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… Stylelint é…ç½®æ­£ç¡®"</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">"âŒ Stylelint é…ç½®æœ‰è¯¯"</span>
â€‹
<span class="hljs-comment"># 4. éªŒè¯ Commitlint é…ç½®</span>
pnpm <span class="hljs-built_in">exec</span> commitlint --<span class="hljs-built_in">help</span> &gt; /dev/null &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… Commitlint å·²å®‰è£…"</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">"âŒ Commitlint æœªå®‰è£…"</span>
â€‹
<span class="hljs-comment"># 5. éªŒè¯ TypeScript é…ç½®</span>
pnpm <span class="hljs-built_in">exec</span> vue-tsc --version &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… vue-tsc å·²å®‰è£…"</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">"âŒ vue-tsc æœªå®‰è£…"</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb49442348aa4c529a43c4da3061ae0b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWNob0VjaG8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770856857&amp;x-signature=9NQrVRjY5tsulPYNEBBvvwDVMh4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
</li>
</ol>

<ol>
<li>
<p>è¿è¡Œæ£€æŸ¥å‘½ä»¤</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 1. æ£€æŸ¥ä»£ç æ ¼å¼ï¼ˆESLintï¼‰</span>
pnpm lint:check
â€‹
<span class="hljs-comment"># 2. æ£€æŸ¥ä»£ç æ ¼å¼ï¼ˆPrettierï¼‰</span>
pnpm <span class="hljs-built_in">format</span>:check
â€‹
<span class="hljs-comment"># 3. æ£€æŸ¥æ ·å¼æ ¼å¼ï¼ˆStylelintï¼‰</span>
pnpm lint:style:check
â€‹
<span class="hljs-comment"># 4. æ£€æŸ¥ TypeScript ç±»å‹</span>
pnpm <span class="hljs-built_in">type</span>-check
â€‹
<span class="hljs-comment"># 5. ç»¼åˆæ£€æŸ¥ï¼ˆè¿è¡Œæ‰€æœ‰æ£€æŸ¥ï¼‰</span>
pnpm check
â€‹
<span class="hljs-comment"># 6. è‡ªåŠ¨ä¿®å¤</span>
pnpm fix
</code></pre>
</li>
</ol>
<h4 data-id="heading-7">é…ç½®æ–‡ä»¶ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–</h4>
<ol>
<li>å®‰è£…ç›¸å…³æ’ä»¶</li>
<li>
<ul>
<li>Prettier - Code formatter</li>
<li>ESLint</li>
<li>Stylelint</li>
<li>Volar</li>
<li>TypeScript Vue Plugin</li>
</ul>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78f4a289d35c4a7c97a06f9197344cf6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWNob0VjaG8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770856857&amp;x-signature=mVtQIb1JFxNRO0kTrR8atUp9Nd0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ol>
<li>
<p>åˆ›å»º<code>.vscode/setting.json</code></p>
<pre><code class="hljs language-swift" lang="swift">{
 Â <span class="hljs-comment">// ç¼–è¾‘å™¨åŸºç¡€é…ç½®</span>
 Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>,
 Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â <span class="hljs-string">"editor.codeActionsOnSave"</span>: {
 Â  Â <span class="hljs-string">"source.fixAll.eslint"</span>: <span class="hljs-string">"explicit"</span>,
 Â  Â <span class="hljs-string">"source.fixAll.stylelint"</span>: <span class="hljs-string">"explicit"</span>
  },
â€‹
 Â <span class="hljs-comment">// Vue æ–‡ä»¶ç‰¹æ®Šé…ç½® - ä½¿ç”¨ Volar æ ¼å¼åŒ–</span>
 Â <span class="hljs-string">"[vue]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"Vue.volar"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>,
 Â  Â <span class="hljs-string">"editor.codeActionsOnSave"</span>: {
 Â  Â  Â <span class="hljs-string">"source.fixAll.eslint"</span>: <span class="hljs-string">"explicit"</span>,
 Â  Â  Â <span class="hljs-string">"source.fixAll.stylelint"</span>: <span class="hljs-string">"explicit"</span>
 Â   }
  },
â€‹
 Â <span class="hljs-comment">// Volar é…ç½®</span>
 Â <span class="hljs-string">"volar.formatting.printWidth"</span>: <span class="hljs-number">120</span>,
 Â <span class="hljs-string">"volar.formatting.singleQuote"</span>: <span class="hljs-literal">true</span>,
 Â <span class="hljs-string">"volar.formatting.semi"</span>: <span class="hljs-literal">false</span>,
 Â <span class="hljs-string">"volar.formatting.tabSize"</span>: <span class="hljs-number">2</span>,
 Â <span class="hljs-string">"volar.formatting.trailingComma"</span>: <span class="hljs-string">"es5"</span>,
 Â <span class="hljs-string">"volar.formatting.arrowParens"</span>: <span class="hljs-string">"avoid"</span>,
 Â <span class="hljs-string">"volar.formatting.endOfLine"</span>: <span class="hljs-string">"lf"</span>,
â€‹
 Â <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨ Prettier æ ¼å¼åŒ– Vueï¼ˆéœ€è¦é…ç½®ï¼‰</span>
 Â <span class="hljs-comment">// "[vue]": {</span>
 Â <span class="hljs-comment">// Â  "editor.defaultFormatter": "esbenp.prettier-vscode",</span>
 Â <span class="hljs-comment">// Â  "editor.formatOnSave": true</span>
 Â <span class="hljs-comment">// },</span>
â€‹
 Â <span class="hljs-comment">// æ–‡ä»¶ç±»å‹ç‰¹å®šé…ç½®</span>
 Â <span class="hljs-string">"[javascript]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[javascriptreact]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[typescript]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[typescriptreact]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[json]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[jsonc]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[css]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[scss]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[less]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[html]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
 Â <span class="hljs-string">"[markdown]"</span>: {
 Â  Â <span class="hljs-string">"editor.defaultFormatter"</span>: <span class="hljs-string">"esbenp.prettier-vscode"</span>,
 Â  Â <span class="hljs-string">"editor.formatOnSave"</span>: <span class="hljs-literal">true</span>
  },
â€‹
 Â <span class="hljs-comment">// ESLint é…ç½®</span>
 Â <span class="hljs-string">"eslint.enable"</span>: <span class="hljs-literal">true</span>,
 Â <span class="hljs-string">"eslint.validate"</span>: [
 Â  Â <span class="hljs-string">"javascript"</span>,
 Â  Â <span class="hljs-string">"javascriptreact"</span>,
 Â  Â <span class="hljs-string">"typescript"</span>,
 Â  Â <span class="hljs-string">"typescriptreact"</span>,
 Â  Â <span class="hljs-string">"vue"</span>
  ],
 Â <span class="hljs-string">"eslint.format.enable"</span>: <span class="hljs-literal">true</span>,
 Â <span class="hljs-string">"eslint.codeAction.showDocumentation"</span>: {
 Â  Â <span class="hljs-string">"enable"</span>: <span class="hljs-literal">true</span>
  },
â€‹
 Â <span class="hljs-comment">// Stylelint é…ç½®</span>
 Â <span class="hljs-string">"stylelint.enable"</span>: <span class="hljs-literal">true</span>,
 Â <span class="hljs-string">"stylelint.validate"</span>: [
 Â  Â <span class="hljs-string">"css"</span>,
 Â  Â <span class="hljs-string">"scss"</span>,
 Â  Â <span class="hljs-string">"less"</span>,
 Â  Â <span class="hljs-string">"vue"</span>
  ],
â€‹
 Â <span class="hljs-comment">// Prettier é…ç½®</span>
 Â <span class="hljs-string">"prettier.enable"</span>: <span class="hljs-literal">true</span>,
 Â <span class="hljs-string">"prettier.requireConfig"</span>: <span class="hljs-literal">true</span>,
 Â <span class="hljs-string">"prettier.configPath"</span>: <span class="hljs-string">".prettierrc.cjs"</span>,
â€‹
 Â <span class="hljs-comment">// ä½¿ç”¨ Prettier æ ¼å¼åŒ– Vueï¼ˆå¦‚æœä½¿ç”¨ Prettier è€Œä¸æ˜¯ Volarï¼‰</span>
 Â <span class="hljs-string">"prettier.documentSelectors"</span>: [<span class="hljs-string">"**/*.vue"</span>],
â€‹
 Â <span class="hljs-comment">// å…¶ä»–ç¼–è¾‘å™¨é…ç½®</span>
 Â <span class="hljs-string">"files.eol"</span>: <span class="hljs-string">"<span class="hljs-subst">\n</span>"</span>,
 Â <span class="hljs-string">"files.insertFinalNewline"</span>: <span class="hljs-literal">true</span>,
 Â <span class="hljs-string">"files.trimTrailingWhitespace"</span>: <span class="hljs-literal">true</span>,
 Â <span class="hljs-string">"files.encoding"</span>: <span class="hljs-string">"utf8"</span>,
â€‹
 Â <span class="hljs-comment">// Vue ç›¸å…³é…ç½® - ç¦ç”¨ Veturï¼ˆå¦‚æœå®‰è£…äº†ï¼‰</span>
 Â <span class="hljs-string">"vetur.format.enable"</span>: <span class="hljs-literal">false</span>,
 Â <span class="hljs-string">"vetur.validation.template"</span>: <span class="hljs-literal">false</span>,
 Â <span class="hljs-string">"vetur.validation.script"</span>: <span class="hljs-literal">false</span>,
 Â <span class="hljs-string">"vetur.validation.style"</span>: <span class="hljs-literal">false</span>,
â€‹
 Â <span class="hljs-comment">// TypeScript é…ç½®</span>
 Â <span class="hljs-string">"typescript.tsdk"</span>: <span class="hljs-string">"node_modules/typescript/lib"</span>,
 Â <span class="hljs-string">"typescript.enablePromptUseWorkspaceTsdk"</span>: <span class="hljs-literal">true</span>
}
</code></pre>
</li>
</ol>

<ol>
<li>
<p>éªŒè¯é…ç½®</p>
<p>æ‰“å¼€ä»»æ„<code>.vue</code>ã€<code>ts</code>æˆ–<code>.js</code>æ–‡ä»¶ï¼Œæ•…æ„å†™ä¸€äº›æ ¼å¼ä¸è§„èŒƒçš„ä»£ç ï¼ˆä¾‹å¦‚ï¼šå¤šä½™ç©ºæ ¼ï¼Œç¼ºå°‘åˆ†å·ç­‰ï¼‰ï¼Œä¿å­˜æ–‡ä»¶ï¼Œæ£€æŸ¥ä»£ç æ˜¯å¦è‡ªåŠ¨æ ¼å¼åŒ–</p>
</li>
</ol>
<h3 data-id="heading-8">å¸¸è§é—®é¢˜ï¼š</h3>
<h4 data-id="heading-9">1. ä¿å­˜æ—¶æ ¼å¼åŒ–ä¸ç”Ÿæ•ˆ</h4>
<ul>
<li>æ£€æŸ¥ VSCode æ‰©å±•æ˜¯å¦å·²å®‰è£…</li>
<li>æ£€æŸ¥ <code>.vscode/settings.json</code> æ˜¯å¦æ­£ç¡®é…ç½®</li>
<li>é‡å¯ VSCode æˆ–é‡æ–°åŠ è½½çª—å£</li>
</ul>
<h4 data-id="heading-10">2. ESLint æŠ¥é”™æ‰¾ä¸åˆ°æ¨¡å—</h4>
<ul>
<li>è¿è¡Œ <code>pnpm install</code> é‡æ–°å®‰è£…ä¾èµ–</li>
<li>æ£€æŸ¥ <code>eslint.config.js</code> ä¸­çš„å¯¼å…¥è·¯å¾„</li>
</ul>
<h4 data-id="heading-11">3. Git Hooks ä¸ç”Ÿæ•ˆ</h4>
<ul>
<li>æ£€æŸ¥ <code>.husky/pre-commit</code> å’Œ <code>.husky/commit-msg</code> æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”å¯æ‰§è¡Œ</li>
<li>è¿è¡Œ <code>chmod +x .husky/pre-commit .husky/commit-msg</code> æ·»åŠ æ‰§è¡Œæƒé™</li>
</ul>
<h3 data-id="heading-12">æ€»ç»“</h3>
<p>é€šè¿‡ä»¥ä¸Šé…ç½®ï¼Œæˆ‘ä»¬å·²ç»ä¸º Vue 3 + TypeScript + Vite é¡¹ç›®æ­å»ºäº†å®Œæ•´çš„ä»£ç è§„èŒƒä½“ç³»ï¼š</p>
<p>âœ… <strong>ä»£ç è´¨é‡æ£€æŸ¥</strong>ï¼šESLint + TypeScript ç±»å‹æ£€æŸ¥</p>
<p>âœ… <strong>ä»£ç æ ¼å¼åŒ–</strong>ï¼šPrettier</p>
<p>âœ… <strong>æ ·å¼è§„èŒƒ</strong>ï¼šStylelint + EditorConfig</p>
<p>âœ… <strong>æäº¤è§„èŒƒ</strong>ï¼šCommitlint + Husky + lint-staged</p>
<p>âœ… <strong>å¼€å‘ä½“éªŒ</strong>ï¼šVSCode ä¿å­˜è‡ªåŠ¨æ ¼å¼åŒ–</p>
<h4 data-id="heading-13"/>
<h4 data-id="heading-14">é…ç½®æ¸…å•</h4>
<p>é¡¹ç›®æ ¹ç›®å½•ä¸‹åº”åŒ…å«ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š</p>
<ul>
<li><code>eslint.config.js</code> - ESLint é…ç½®</li>
<li><code>.prettierrc.cjs</code> - Prettier é…ç½®</li>
<li><code>.prettierignore</code> - Prettier å¿½ç•¥æ–‡ä»¶</li>
<li><code>.stylelintrc.cjs</code> - Stylelint é…ç½®</li>
<li><code>.editorconfig</code> - ç¼–è¾‘å™¨é…ç½®</li>
<li><code>commitlint.config.js</code> - Commitlint é…ç½®</li>
<li><code>.lintstagedrc.js</code> - lint-staged é…ç½®</li>
<li><code>.husky/pre-commit</code> - Git pre-commit hook</li>
<li><code>.husky/commit-msg</code> - Git commit-msg hook</li>
<li><code>.vscode/settings.json</code> - VSCode å·¥ä½œåŒºé…ç½®</li>
</ul>
<p><strong>ç›¸å…³èµ„æº</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Feslint.org%2F" target="_blank" title="https://eslint.org/" ref="nofollow noopener noreferrer">ESLint å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fprettier.io%2F" target="_blank" title="https://prettier.io/" ref="nofollow noopener noreferrer">Prettier å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fstylelint.io%2F" target="_blank" title="https://stylelint.io/" ref="nofollow noopener noreferrer">Stylelint å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcommitlint.js.org%2F" target="_blank" title="https://commitlint.js.org/" ref="nofollow noopener noreferrer">Commitlint å®˜æ–¹æ–‡æ¡£</a></li>
</ul>
<p>ğŸ“¦ å®Œæ•´ç¤ºä¾‹ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2F1193082625%2Fvite-vue-demo%2Freleases%2Ftag%2Fv1.0.0" target="_blank" title="https://github.com/1193082625/vite-vue-demo/releases/tag/v1.0.0" ref="nofollow noopener noreferrer">GitHub ä»“åº“åœ°å€</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”±viteé¡¹ç›®å¼•èµ·çš„Nginxå­¦ä¹ ]]></title>    <link>https://juejin.cn/post/7602841282802860073</link>    <guid>https://juejin.cn/post/7602841282802860073</guid>    <pubDate>2026-02-05T01:08:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602841282802860073" data-draft-id="7602814773497233450" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”±viteé¡¹ç›®å¼•èµ·çš„Nginxå­¦ä¹ "/> <meta itemprop="keywords" content="Nginx,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T01:08:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="EchoEcho"/> <meta itemprop="url" content="https://juejin.cn/user/2920774267837208"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”±viteé¡¹ç›®å¼•èµ·çš„Nginxå­¦ä¹ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2920774267837208/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    EchoEcho
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:08:01.000Z" title="Thu Feb 05 2026 01:08:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸€ç›´å¯¹<code>nginx</code>å¤„äºæ¯”è¾ƒæµ…æ˜¾çš„äº†è§£ï¼Œè¶ç€è¿™æ¬¡è°ƒè¯•é¡¹ç›®ï¼Œå¯¹äº†è§£åˆ°çš„<code>nginx</code>ä¹Ÿåšä¸€æ¬¡æ€»ç»“ã€‚</p>
<p><strong>é—®é¢˜èƒŒæ™¯</strong>ï¼š</p>
<p>æœ¬åœ°<code>vite</code>é¡¹ç›®è¿è¡Œæ­£å¸¸ï¼Œä½†æ˜¯éƒ¨ç½²åˆ°å¯¹åº”ç¯å¢ƒåï¼Œé¡µé¢æ— æ³•æ­£å¸¸è®¿é—®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/619a1eff94194b92a5b01d22bb930291~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWNob0VjaG8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770858489&amp;x-signature=AwNk5gupBUH%2FIajexOHYZ6MQsp4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<blockquote>
<p>Â é¢„è®¡æ­¤é—®é¢˜æ˜¯æœªæ­£å¸¸è¯·æ±‚åˆ°èµ„æºå¯¼è‡´è¿”å›äº†å…œåº•çš„<code>html</code>å†…å®¹ï¼Œç„¶è€Œè¯·æ±‚çš„æ˜¯<code>js</code>æ–‡ä»¶ï¼Œå¾—åˆ°çš„å´æ˜¯<code>html</code>æ–‡ä»¶ï¼Œæ‰€ä»¥å¯¼è‡´çš„æ­¤æŠ¥é”™ã€‚</p>
<p>æŸ¥çœ‹äº†<code>vite.config.ts</code>ï¼Œå‘ç°å½“å‰<code>base</code>é…ç½®æ˜¯<code>./</code>ã€ç›¸å¯¹è·¯å¾„ã€‘ï¼Œå°†å…¶ä¿®æ”¹ä¸º<code>/</code>ã€ç»å¯¹è·¯å¾„ã€‘åï¼Œå¸Œæœ›åœ¨æœ¬åœ°ç¡®è®¤ä¸€ä¸‹æ˜¯å¦æ­£å¸¸åå†éƒ¨ç½²åˆ°å¯¹åº”ç¯å¢ƒï¼Œå°±æœ‰äº†ä»¥ä¸‹æµç¨‹ã€‚</p>
</blockquote>
<p><strong>è°ƒè¯•è¿‡ç¨‹</strong>ï¼š</p>
<p>å…ˆåœ¨æœ¬åœ°æ‰§è¡Œå¯¹åº”ç¯å¢ƒçš„æ‰“åŒ…å‘½ä»¤ï¼š<code>pnpm run build:test</code>ï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆ<code>dist</code>æ–‡ä»¶ã€‚</p>
<p>ç”±äº<code>Vite</code>ä¸­å†…ç½®çš„<code>Vite preview</code>ä¸æ”¯æŒä»£ç†ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨<code>pnpm run preview</code>ç›´æ¥è¿è¡Œ<code>dist</code>ã€‚</p>
<p>æ­¤æ—¶é€‰æ‹©ä½¿ç”¨<code>Nginx</code>è¿è¡Œæœ¬åœ°<code>dist</code>ã€‚</p>
<p>åœ¨æœ¬åœ°<code>nginx</code>é…ç½®ä¸­æ·»åŠ å¯¹æ­¤é¡¹ç›®çš„ä»£ç†:</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ‰€æœ‰è¡Œéƒ½éœ€è¦ ; ç»“å°¾</span>
...
serverÂ {
Â  Â  <span class="hljs-comment"># ç›‘å¬ç«¯å£å·</span>
Â  Â  listenÂ 3333<span class="hljs-comment">;</span>
Â  Â  <span class="hljs-comment"># é…ç½®ååœ¨æµè§ˆå™¨ä¸­çš„åœ°å€å°±æ˜¯localhost:3333</span>
Â  Â  server_nameÂ localhost<span class="hljs-comment">;</span>

Â  Â  <span class="hljs-comment"># é™æ€æ–‡ä»¶ç›®å½•ã€ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‘</span>
Â  Â  rootÂ E:/work/object/dist<span class="hljs-comment">;</span>

Â  Â  indexÂ index.html<span class="hljs-comment">;</span>

Â  Â Â <span class="hljs-comment"># é™æ€èµ„æºç¼“å­˜</span>
Â  Â Â location~*Â .(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|wasm)$Â {
Â  Â  Â  Â Â expiresÂ 1y<span class="hljs-comment">;</span>
Â  Â  }
Â  Â Â 
Â  Â Â <span class="hljs-comment"># API ä»£ç†</span>
Â  Â Â locationÂ /api/ {
Â  Â  Â  Â Â proxy_passÂ http://1.1.1.1:1111<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â Â client_max_body_sizeÂ 500m<span class="hljs-comment">;Â # å…è®¸ä¸Šä¼ æœ€å¤§ 500MB æ–‡ä»¶</span>
Â  Â  Â  Â Â proxy_connect_timeoutÂ 600<span class="hljs-comment">;Â # è¿æ¥è¶…æ—¶ 600 ç§’</span>
Â  Â  Â  Â Â proxy_send_timeoutÂ 600<span class="hljs-comment">;</span>
Â  Â  Â  Â Â proxy_read_timeoutÂ 600<span class="hljs-comment">;Â # è¯»å–è¶…æ—¶ 600 ç§’</span>
Â  Â  }
Â  Â Â 
Â  Â Â <span class="hljs-comment"># SPA è·¯ç”±æ”¯æŒ</span>
Â  Â Â locationÂ / {
Â  Â  Â  Â Â <span class="hljs-comment"># æ–‡ä»¶æŸ¥æ‰¾é¡ºåº å…ˆæ‰¾ç²¾ç¡®è·¯å¾„ï¼ˆ/aa.htmlï¼‰ å†æ‰¾ç›®å½•ï¼ˆ/aa/ï¼‰ æœ€åç”¨å¤‡ç”¨é¡µé¢ï¼ˆå›é€€åˆ°é¦–é¡µï¼‰</span>
Â  Â  Â  Â Â try_filesÂ $uriÂ $uri/ /index.html<span class="hljs-comment">;</span>
Â  Â  }
Â  Â Â 
Â  Â Â error_page 500Â 502 503Â 504Â /50x.html<span class="hljs-comment">;</span>
Â  Â Â <span class="hljs-attr">location</span>Â = <span class="hljs-number">50</span>x.htmlÂ {
Â  Â  Â  Â Â rootÂ html<span class="hljs-comment">;</span>
Â  Â  }
}
...
</code></pre>
<p>é‡å¯<code>nginx</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥nginx.exeæ‰€åœ¨ç›®å½•</span>

<span class="hljs-comment"># 1. åœæ­¢Nginx</span>
./nginxÂ -sÂ stop

<span class="hljs-comment"># 2. é‡æ–°åŠ è½½é…ç½®</span>
./nginxÂ -sÂ reload

<span class="hljs-comment"># 3. æ£€æŸ¥ Nginx è¿›ç¨‹</span>
tasklist | findstr nginx
</code></pre>
<p>é™¤äº†ä»¥ä¸Šæ–¹æ³•ä¹Ÿå¯ä»¥åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­æ‰‹åŠ¨åœæ­¢å¯¹åº”çš„<code>nginx</code>è¿›è¡Œåï¼Œå†åŒå‡»<code>nginx.exe</code>å¯åŠ¨</p>
<p><code>nginx</code>æ­£å¸¸è¿è¡Œåï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—®äº†<code>http:localhost:3333</code>ã€‚å‘ç°ä¿®æ”¹<code>base</code>çš„è®¾ç½®åï¼Œç¡®å®è§£å†³äº†ä¸Šè¿°é—®é¢˜ã€‚å°±å¯ä»¥æ­£å¸¸æäº¤ä»£ç å¹¶åœ¨å¯¹åº”ç¯å¢ƒéƒ¨ç½²äº†ã€‚</p>
<p><strong>é—®é¢˜è§£æ</strong></p>
<p>æ­¤æ¬¡é—®é¢˜æ˜¯å› ä¸ºæ–°å¢äº†ä¸€ä¸ªäºŒçº§è·¯ç”±ï¼Œå½“ä»¥<code>base:Â "./"</code>è®¾ç½®è®¿é—®å­è·¯ç”±<code>/second/page</code>æ—¶ï¼Œ</p>
<p>å½“å‰URLä¸ºï¼š<code>http://localhost:3333/second/page</code></p>
<p>èµ„æºè·¯å¾„ä¸ºï¼š<code>./assets/xxx.js</code></p>
<p>è§£æç»“æœä¸ºï¼š<code>http://localhost:3333/second/assets/xxx.js</code>âŒ</p>
<p>æµè§ˆå™¨ä¼šåŸºäºå½“å‰è·¯å¾„è§£æç›¸å¯¹è·¯å¾„ï¼Œ<code>./assets/xxx.js</code>è¢«è§£ææˆäº†<code>second/assets/xxx.js</code>ï¼Œè€Œå®é™…æ–‡ä»¶åœ¨<code>/assets/xxx.js</code>ï¼Œæ‰€ä»¥å¯¼è‡´èµ„æºæ–‡ä»¶404ï¼ŒæœåŠ¡å™¨è¿”å›äº†<code>index.html</code>ã€<code>SPA fallback</code>ã€‘ï¼Œä½†æµè§ˆå™¨æœŸæœ›<code>js</code>æ–‡ä»¶ï¼Œå› æ­¤æŠ¥é”™<code>Expected a JavaScript-or-Wasm module script but the server responded with a MIME type of 'text/html'</code>ã€‚</p>
<p>è¿™ä¸ªé—®é¢˜æ²¡æœ‰åœ¨æœ¬åœ°è¿è¡Œæ—¶æŠ¥é”™ï¼Œæ˜¯å› ä¸º<code>vite</code>å¼€å‘æœåŠ¡å™¨ä¼šåŠ¨æ€å¤„ç†æ‰€æœ‰è¯·æ±‚ï¼Œä¸å—<code>base</code>é…ç½®å½±å“ã€‚</p>
<p><strong>å…¶ä»–è¡¥å……</strong>ï¼š</p>
<ul>
<li>
<p>æ­£å‘ä»£ç†ï¼šÂ </p>
<p>Nginxä½œä¸ºå®¢æˆ·ç«¯ä»£ç†ï¼Œé€šå¸¸ç”¨äºVPNã€ç¿»å¢™ã€å…¬å¸å†…ç½‘ä»£ç†</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å…¬å¸å†…ç½‘ä»£ç†é…ç½®</span>
<span class="hljs-comment"># å‘˜å·¥ç”µè„‘é…ç½®ä»£ç†ï¼š192.168.1.100:3128</span>
<span class="hljs-comment"># æ‰€æœ‰å¤–ç½‘è¯·æ±‚éƒ½é€šè¿‡è¿™ä¸ªä»£ç†</span>
serverÂ {
Â  Â  listenÂ 3128<span class="hljs-comment">;Â # å¸¸ç”¨ä»£ç†ç«¯å£</span>
Â  Â Â server_nameÂ proxy.example.com<span class="hljs-comment">;</span>
Â  Â Â 
Â  Â  resolverÂ 8.8.8.8<span class="hljs-comment">;Â # DNS æœåŠ¡å™¨åœ°å€</span>

Â  Â  <span class="hljs-comment"># å…è®¸çš„å®¢æˆ·ç«¯IPï¼ˆå®‰å…¨ï¼‰</span>
Â  Â  allowÂ 192.168.1.0/24<span class="hljs-comment">;Â åªå…è®¸å†…ç½‘</span>
Â  Â  denyÂ all<span class="hljs-comment">;</span>

Â  Â Â locationÂ / {Â 
Â  Â  Â  Â Â proxy_passÂ http://$http_host$request_uri<span class="hljs-comment">;Â # åŠ¨æ€ç›®æ ‡</span>
Â  Â  Â  Â Â proxy_set_headerÂ HostÂ $http_host<span class="hljs-comment">;</span>
Â  Â  Â  Â Â proxy_set_headerÂ X-Real-IPÂ $remote_addr<span class="hljs-comment">;</span>
Â  Â  Â  Â Â proxy_bufferingÂ off<span class="hljs-comment">;Â # å…³é—­ç¼“å†²ï¼Œæé«˜æ€§èƒ½</span>
Â  Â  Â  Â Â <span class="hljs-comment"># æ—¥å¿—</span>
Â  Â  Â  Â Â access_logÂ logs/proxy_access.log<span class="hljs-comment">;</span>
Â  Â  }
}
</code></pre>
</li>
<li>
<p>åå‘ä»£ç†ï¼š</p>
<p>Nginxä½œä¸ºæœåŠ¡å™¨ä»£ç†ï¼Œä¸Šé¢çš„ä¾‹å­å°±æ˜¯åå‘ä»£ç†</p>
<pre><code class="hljs language-bash" lang="bash">localtionÂ /api/ {
Â  Â  proxy_passÂ http://1.1.1.1:7788;Â <span class="hljs-comment"># è½¬ç»™åç«¯</span>
}
</code></pre>
</li>
<li>
<p>è´Ÿè½½å‡è¡¡ï¼š</p>
<p>å¯ä»¥è®¾ç½®è‡ªåŠ¨è½®è¯¢ï¼Œè®¾ç½®æƒé‡ï¼Œæˆ–è€…è‡ªå®šä¹‰</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¤šä¸ªåç«¯ï¼ŒæŒ‰æƒé‡åˆ†é…è¯·æ±‚</span>
upstreamÂ backendÂ {
Â  Â  serverÂ localhost:8080 <span class="hljs-attr">weight</span>=<span class="hljs-number">3</span><span class="hljs-comment">;Â # æƒé‡ 3</span>
Â  Â  serverÂ localhost:8081 <span class="hljs-attr">weight</span>=<span class="hljs-number">1</span><span class="hljs-comment">;Â # æƒé‡ 1</span>
Â  Â  serverÂ localhost:8082 backup<span class="hljs-comment">;Â # å¤‡ç”¨æœåŠ¡å™¨</span>
}
serverÂ {
Â  Â  locationÂ /api/ {
Â  Â proxy_passÂ http://backend<span class="hljs-comment">;Â # ä½¿ç”¨è´Ÿè½½å‡è¡¡</span>
Â  Â  }
}
</code></pre>
</li>
<li>
<p>é™æ€æ–‡ä»¶å¤„ç†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">serverÂ {
Â  Â  rootÂ E:/work/app/dist;Â <span class="hljs-comment"># æ–‡ä»¶ä»“åº“ã€ç»å¯¹è·¯å¾„ã€‘</span>

Â  Â  locationÂ / {
Â  Â try_filesÂ <span class="hljs-variable">$uri</span>Â <span class="hljs-variable">$uri</span>/ /index.html;
Â  Â  }
}
</code></pre>
</li>
<li>
<p><code>Gzip</code>å‹ç¼©</p>
<p>ä¼ è¾“å‰å‹ç¼©ï¼Œå¯ä»¥å‡å°‘å¸¦å®½</p>
<p>å›¾ç‰‡ã€è§†é¢‘ã€PDFç­‰å¦‚æœå·²ç»å‹ç¼©è¿‡ï¼Œå°±ä¸éœ€è¦å†å‹ç¼©äº†ï¼Œå†æ¬¡å‹ç¼©æ•ˆæœå·®</p>
<p>å°æ–‡ä»¶å‹ç¼©æ”¶ç›Šå°ï¼Œåè€Œå¢åŠ CPUå¼€é”€</p>
<pre><code class="hljs language-bash" lang="bash">httpÂ {
Â  Â Â gzipÂ on;Â <span class="hljs-comment"># å¼€å¯å‹ç¼©</span>
Â  Â Â 
Â  Â Â <span class="hljs-comment"># å‹ç¼©çº§åˆ«ï¼ˆ1-9ï¼Œæ•°å­—è¶Šå¤§å‹ç¼©è¶Šå¥½ä½†è¶Šæ…¢ï¼‰</span>
Â  Â Â gzip_comp_levelÂ 6; Â <span class="hljs-comment"># æ¨è 6ï¼Œå¹³è¡¡å‹ç¼©ç‡å’Œé€Ÿåº¦</span>
Â  Â Â 
Â  Â Â <span class="hljs-comment"># å¤§äº 1KB æ‰å‹ç¼©ï¼Œå¤ªå°å‹ç¼©æ„ä¹‰ä¸å¤§</span>
Â  Â Â gzip_min_lengthÂ 1024;
Â  Â Â 
Â  Â Â <span class="hljs-comment"># å‹ç¼©çš„æ–‡ä»¶ç±»å‹</span>
Â  Â Â gzip_types
Â  Â  Â  Â  text/plainÂ Â  Â  Â  Â  Â Â <span class="hljs-comment"># çº¯æ–‡æœ¬</span>
Â  Â  Â  Â  text/cssÂ Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># CSS</span>
Â  Â  Â  Â  text/javascriptÂ Â  Â  Â <span class="hljs-comment"># JavaScript</span>
Â  Â  Â  Â  application/javascript
Â  Â  Â  Â  application/jsonÂ Â  Â Â <span class="hljs-comment"># JSON</span>
Â  Â  Â  Â  text/xmlÂ Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># XML</span>
Â  Â  Â  Â  application/xml
Â  Â  Â  Â  application/xml+rss
Â  Â  Â  Â  text/html; Â  Â  Â  Â  Â Â <span class="hljs-comment"># HTML</span>
Â  Â Â 
Â  Â Â <span class="hljs-comment"># å‹ç¼©ç¼“å†²åŒºå¤§å°</span>
Â  Â Â gzip_buffersÂ 16 8k; Â <span class="hljs-comment"># 16ä¸ª8KBç¼“å†²åŒº</span>
Â  Â Â 
Â  Â Â <span class="hljs-comment"># æ˜¯å¦æ·»åŠ  Vary: Accept-Encoding å¤´</span>
Â  Â Â <span class="hljs-comment"># å‘Šè¯‰ç¼“å­˜æœåŠ¡å™¨æ”¯æŒå‹ç¼© Â æ”¯æŒå‹ç¼©çš„æµè§ˆå™¨ç»™å‹ç¼©ç‰ˆï¼Œä¸æ”¯æŒçš„ç»™åŸç‰ˆ</span>
Â  Â Â gzip_varyÂ on; Â 
Â  Â Â 
Â  Â Â <span class="hljs-comment"># ç¦ç”¨æŸäº›æµè§ˆå™¨çš„å‹ç¼©ï¼ˆæ—§ç‰ˆ IEï¼‰</span>
Â  Â Â gzip_disableÂ <span class="hljs-string">"msie6"</span>; Â <span class="hljs-comment"># ç¦ç”¨ IE6</span>
}
</code></pre>
</li>
<li>
<p>ç¼“å­˜æ§åˆ¶</p>
<p>é™æ€èµ„æºç¼“å­˜ï¼Œå‡å°‘é‡å¤è¯·æ±‚ï¼Œå‡è½»æœåŠ¡å™¨å‹åŠ›</p>
<p>ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼š<code>æµè§ˆå™¨ -&gt; æœåŠ¡å™¨ -&gt; è¿”å›æ–‡ä»¶ -&gt; æµè§ˆå™¨ï¼ˆåŒæ—¶ç¼“å­˜ï¼‰</code></p>
<p>ç¬¬äºŒæ¬¡è¯·æ±‚ï¼š<code>æµè§ˆå™¨ -&gt; nginx -&gt; ç›´æ¥è¿”å›ç¼“å­˜</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é™æ€èµ„æºï¼ˆJSã€CSSã€å›¾ç‰‡ï¼‰- é•¿æœŸç¼“å­˜</span>
locationÂ ~*Â .(js|css|png|jpg)$Â {
Â  Â  expiresÂ 1y;Â <span class="hljs-comment"># ç¼“å­˜1å¹´ Â -1ã€ä¸ç¼“å­˜ã€‘| epochã€ä¸ç¼“å­˜ã€‘ | maxã€æœ€å¤§ç¼“å­˜æ—¶é—´10å¹´ã€‘| 1yã€ä¸€å¹´ã€‘| 1Mã€ä¸€ä¸ªæœˆã€‘...</span>
<span class="hljs-comment"># æ›´è¯¦ç»†çš„ç¼“å­˜è§„åˆ™ å…¬å…±ç¼“å­˜ï¼Œ1å¹´æœ‰æ•ˆï¼Œä¸ä¼šæ”¹å˜</span>
Â  Â Â add_headerÂ Cache-ControlÂ <span class="hljs-string">"public, max-age=31536000, immutable"</span>;
Â  Â Â access_logÂ off; Â <span class="hljs-comment"># ä¸è®°å½•è®¿é—®æ—¥å¿—ï¼ˆå¯é€‰ï¼‰</span>
}

<span class="hljs-comment"># HTMLæ–‡ä»¶ - çŸ­æœŸç¼“å­˜æˆ–ä¸ç¼“å­˜</span>
locationÂ ~*Â .html$Â {
Â  Â  expiresÂ 1h;Â <span class="hljs-comment"># ç¼“å­˜1å°æ—¶</span>
Â  Â  add_headerÂ Cache-ControlÂ <span class="hljs-string">"public, max-age=3600"</span>;
}

<span class="hljs-comment"># APIå“åº” - ä¸ç¼“å­˜</span>
locationÂ /apiÂ {
Â  Â  proxy_passÂ http://localhost:8080;
Â  Â  add_headerÂ Cache-ControlÂ <span class="hljs-string">"no-cache, no-store, must-revalidate"</span>;
}

<span class="hljs-comment"># å…¶ä»–æ–‡ä»¶</span>
locationÂ / {
Â  Â  try_filesÂ <span class="hljs-variable">$uri</span>Â <span class="hljs-variable">$uri</span>/ /index.html;
}
</code></pre>
<p><code>Cache-Control</code>å‚æ•°è¯´æ˜ï¼š</p>








































<table><thead><tr><th>æŒ‡ä»¤</th><th>å«ä¹‰</th><th>æ¯”å–»</th></tr></thead><tbody><tr><td>public</td><td>å¯ä»¥è¢«ä»»ä½•ç¼“å­˜å­˜å‚¨</td><td>å…¬å…±è´§æ¶ï¼Œè°éƒ½èƒ½ç”¨</td></tr><tr><td>private</td><td>åªèƒ½è¢«æµè§ˆå™¨ç¼“å­˜</td><td>ç§äººè´§æ¶ï¼Œåªæœ‰ä½ èƒ½ç”¨</td></tr><tr><td>max-age=ç§’æ•°</td><td>ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰</td><td>ä¿è´¨æœŸ</td></tr><tr><td>immutable</td><td>æ–‡ä»¶ä¸ä¼šæ”¹å˜</td><td>æ°¸ä¹…ä¸å˜</td></tr><tr><td>no-cache</td><td>éœ€è¦éªŒè¯æ‰èƒ½ä½¿ç”¨</td><td>æ¯æ¬¡éƒ½è¦æ£€æŸ¥</td></tr><tr><td>no-store</td><td>ä¸ç¼“å­˜</td><td>ä¸æ”¾åœ¨è´§æ¶ä¸Š</td></tr></tbody></table>
</li>
<li>
<p>HTTPSã€SSLã€‘</p>
<pre><code class="hljs language-bash" lang="bash">serverÂ {
Â  Â  listenÂ 443 ssl;Â <span class="hljs-comment"># HTTPS ç«¯å£</span>
Â  Â  server_nameÂ example.com;

Â  Â  <span class="hljs-comment"># SSLè¯ä¹¦é…ç½®</span>
Â  Â  ssl_certificateÂ /path/to/certificate.crt;Â <span class="hljs-comment"># è¯ä¹¦æ–‡ä»¶</span>
Â  Â  ssl_certificate_keyÂ /path/to/private.key;Â <span class="hljs-comment"># ç§é’¥æ–‡ä»¶</span>

}
</code></pre>
</li>
<li>
<p>é™æµ</p>
<p>é˜²æ­¢è¯·æ±‚è¿‡å¤šï¼Œä¿æŠ¤æœåŠ¡å™¨</p>
<pre><code class="hljs language-ini" lang="ini">limit_req_zoneÂ $binary_remote_addr <span class="hljs-attr">zone</span>=api_limit:<span class="hljs-number">10</span>m rate=<span class="hljs-number">10</span>r/s<span class="hljs-comment">;</span>

locationÂ /api/ {
Â  Â  limit_reqÂ <span class="hljs-attr">zone</span>=api_limit burst=<span class="hljs-number">20</span><span class="hljs-comment">;Â # æ¯ç§’10ä¸ªè¯·æ±‚</span>
Â  Â  proxy_passÂ http://localhost:8080<span class="hljs-comment">;</span>
}
</code></pre>
</li>
<li>
<p>è·¨åŸŸã€CORSã€‘</p>
<p>å…è®¸ä¸åŒåŸŸåçš„å‰ç«¯è®¿é—®API</p>
<pre><code class="hljs language-bash" lang="bash">locationÂ /apiÂ {
Â  Â  add_headerÂ Access-Control-Allow-OriginÂ *;
Â  Â  add_headerÂ Access-Control-Allow-MethodsÂ <span class="hljs-string">'GET, POST, PUT, DELETE'</span>;
Â  Â  add_headerÂ Access-Control-Allow-HeadersÂ <span class="hljs-string">'Content-Type, Â  Â  Authorization'</span>;

Â  Â  proxy_passÂ http://localhost:8080;
}
</code></pre>
</li>
<li>
<p>é‡å®šå‘</p>
<p>URLå˜æ›´ï¼Œè‡ªåŠ¨è·³è½¬</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 301 æ°¸ä¹…é‡å®šå‘</span>
<span class="hljs-comment"># æµè§ˆå™¨è¡Œä¸ºï¼šè®°ä½æ–°åœ°å€ï¼Œä¸‹æ¬¡ç›´æ¥è®¿é—®ï¼›é€‚ç”¨äºåŸŸåå˜æ›´æˆ–URLæ°¸ä¹…å˜æ›´</span>
locationÂ /oldÂ {
Â  Â  <span class="hljs-built_in">return</span>Â 301Â /new;
}

<span class="hljs-comment"># 302 ä¸´æ—¶é‡å®šå‘</span>
<span class="hljs-comment"># æµè§ˆå™¨è¡Œä¸ºï¼šä¸è®°ä½ï¼Œæ¯æ¬¡éƒ½è¯¢é—®ï¼›é€‚ç”¨äºä¸´æ—¶ç»´æŠ¤ã€A/Bæµ‹è¯•</span>
locationÂ /tempÂ {
Â  Â  <span class="hljs-built_in">return</span>Â 302Â /new;
}
</code></pre>
</li>
<li>
<p>è¯·æ±‚å¤´ä¿®æ”¹</p>
<pre><code class="hljs language-bash" lang="bash">locationÂ /apiÂ {
Â  Â  proxy_set_headerÂ HostÂ <span class="hljs-variable">$host</span>;Â <span class="hljs-comment"># è®¾ç½®Host</span>
Â  Â  proxy_set_headerÂ X-Real-IPÂ <span class="hljs-variable">$remote_addr</span>;Â <span class="hljs-comment"># çœŸå®IP</span>
Â  Â  proxy_set_headerÂ X-Forwarded-ForÂ <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;

Â  Â  proxy_passÂ http://localhost:8080;
}
</code></pre>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[nestjsé“¾æ¥mongodb]]></title>    <link>https://juejin.cn/post/7602940720689676334</link>    <guid>https://juejin.cn/post/7602940720689676334</guid>    <pubDate>2026-02-05T01:53:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602940720689676334" data-draft-id="7602842876255469614" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="nestjsé“¾æ¥mongodb"/> <meta itemprop="keywords" content="åç«¯,MySQL"/> <meta itemprop="datePublished" content="2026-02-05T01:53:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‰§é‡æ˜Ÿè¾°"/> <meta itemprop="url" content="https://juejin.cn/user/166781500788429"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            nestjsé“¾æ¥mongodb
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/166781500788429/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‰§é‡æ˜Ÿè¾°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:53:42.000Z" title="Thu Feb 05 2026 01:53:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å®‰è£…ä¾èµ–</p>
<pre><code class="hljs language-js" lang="js">npm i @nestjs/mongoose mongoose
npm i @nestjs/config
</code></pre>
<p>åˆ›å»º<code>.env</code>ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable constant_">MONGODB_URI</span>=<span class="hljs-attr">mongodb</span>:<span class="hljs-comment">//localhost:27017/projectdata</span>
</code></pre>
<p>é…ç½®é“¾æ¥mongodbï¼Œä¸»è¦ä¿®æ”¹å¯ä»¥çœ‹ä¸‹æ–¹æˆªå›¾</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Module</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppController</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.controller'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.service'</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ConfigModule</span>,<span class="hljs-title class_">ConfigService</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/config'</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">MongooseModule</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/mongoose'</span>;

@<span class="hljs-title class_">Module</span>({
  <span class="hljs-attr">imports</span>: [
    <span class="hljs-title class_">ConfigModule</span>.<span class="hljs-title function_">forRoot</span>({
      <span class="hljs-attr">isGlobal</span>:<span class="hljs-literal">true</span>,<span class="hljs-comment">//å…¨å±€æ¨¡å—ï¼Œå¯åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨</span>
    }),
    <span class="hljs-title class_">MongooseModule</span>.<span class="hljs-title function_">forRootAsync</span>({
      <span class="hljs-attr">imports</span>:[<span class="hljs-title class_">ConfigModule</span>],
      <span class="hljs-attr">useFactory</span>:<span class="hljs-keyword">async</span> (<span class="hljs-attr">configService</span>:<span class="hljs-title class_">ConfigService</span>)=&gt;({
        <span class="hljs-attr">uri</span>:configService.<span class="hljs-property">get</span>&lt;string&gt;(<span class="hljs-string">'MONGODB_URI'</span>)||<span class="hljs-string">'mongodb://localhost:27017/projectdata'</span>
      }),
      <span class="hljs-attr">inject</span>:[<span class="hljs-title class_">ConfigService</span>]
    })
  ],
  <span class="hljs-attr">controllers</span>: [<span class="hljs-title class_">AppController</span>],
  <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">AppService</span>],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppModule</span> {}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a70376856354b929debb97dce7334b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54mn6YeO5pif6L6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770861222&amp;x-signature=QugJps%2F8SA68AlbP0bNi3HxLBgI%3D" alt="image.png" loading="lazy"/></p>
<p>å¼€å‘ç¯å¢ƒä½¿ç”¨.env</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1.ä¸‹è½½dotenv</span>
npm i dotenv
<span class="hljs-comment">// 2.src/main.tsä¸­é…ç½®</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> dotenv <span class="hljs-keyword">from</span> <span class="hljs-string">'dotenv'</span>;
dotenv.<span class="hljs-title function_">config</span>();
</code></pre>
<p><code>npm run start:dev</code>è¿è¡Œé¡¹ç›®æ˜¾ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤ºå³ä¸ºæˆåŠŸ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb3131bd980e41c4877d12d69a4705d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54mn6YeO5pif6L6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770861222&amp;x-signature=hmbY8vDKrLAmyu%2FzylmXssLRkpM%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥ğŸ”¥ğŸ”¥ React18 æºç å­¦ä¹  - hook åŸç† - useState & useReducer]]></title>    <link>https://juejin.cn/post/7603004323870064683</link>    <guid>https://juejin.cn/post/7603004323870064683</guid>    <pubDate>2026-02-04T17:54:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603004323870064683" data-draft-id="7602825342228168738" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥ğŸ”¥ğŸ”¥ React18 æºç å­¦ä¹  - hook åŸç† - useState &amp; useReducer"/> <meta itemprop="keywords" content="React.js,æºç é˜…è¯»"/> <meta itemprop="datePublished" content="2026-02-04T17:54:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="yyyao"/> <meta itemprop="url" content="https://juejin.cn/user/4266531531793976"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥ğŸ”¥ğŸ”¥ React18 æºç å­¦ä¹  - hook åŸç† - useState &amp; useReducer
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4266531531793976/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    yyyao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T17:54:07.000Z" title="Wed Feb 04 2026 17:54:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ¬æ–‡çš„<code>React</code>ä»£ç ç‰ˆæœ¬ä¸º<code>18.2.0</code></p>
<p>å¯è°ƒè¯•çš„ä»£ç ä»“åº“ä¸ºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyyyao-hh%2Freact-debug%2Ftree%2Fmaster-pure" target="_blank" title="https://github.com/yyyao-hh/react-debug/tree/master-pure" ref="nofollow noopener noreferrer">GitHub - yyyao-hh/react-debug at master-pure</a></p>
<p>åœ¨<code>React16.8</code>å¼•å…¥Hooksä¹‹å‰ï¼ŒçŠ¶æ€é€»è¾‘å¤ç”¨ä¸€ç›´å›°æ‰°ç€<code>React</code>å¼€å‘è€…ã€‚<code>Hooks</code>çš„è¯ç”Ÿä¸ä»…è§£å†³äº†çŠ¶æ€é€»è¾‘å¤ç”¨çš„é—®é¢˜ï¼Œæ›´é‡è¦çš„æ˜¯ç»Ÿä¸€äº†å‡½æ•°ç»„ä»¶ä¸ç±»ç»„ä»¶çš„èƒ½åŠ›è¾¹ç•Œã€‚ä½œä¸º<code>React</code>ä¸­æœ€åŸºç¡€ä¹Ÿæœ€æ ¸å¿ƒçš„ä¸¤ä¸ª<code>Hooks</code>ï¼Œ<code>useState</code>å’Œ<code>useReducer</code>å…±åŒæ„å»ºäº†å‡½æ•°ç»„ä»¶çš„çŠ¶æ€ç®¡ç†ä½“ç³»ã€‚</p>
<h2 data-id="heading-1">useState æºç </h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹<code>useState</code>çš„æºç ã€‚åœ¨<code>Hook</code>é‚£ä¸€ç« èŠ‚è®²è¿‡ï¼Œå¯¹äº<code>Hooks</code>çš„å¤„ç†ä¼šåˆ†ä¸º<code>mount</code>å’Œ<code>update</code>ä¸¤ä¸ªé˜¶æ®µï¼Œç„¶åä¸åŒé˜¶æ®µè°ƒç”¨ä¸åŒå‡½æ•°å¯¹<code>Hook</code>è¿›è¡Œå¤„ç†ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥ç›´æ¥å»çœ‹ä¸åŒé˜¶æ®µå¤„ç†æ–¹æ³•çš„å†…éƒ¨å®ç°</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">/*</span> <span class="hljs-string">react/packages/react-reconciler/src/ReactFiberHooks.old.js</span> <span class="hljs-string">*/</span>

<span class="hljs-string">//</span> <span class="hljs-string">mount</span> <span class="hljs-string">é˜¶æ®µ</span>
<span class="hljs-attr">const HooksDispatcherOnMount:</span> <span class="hljs-string">Dispatcher</span> <span class="hljs-string">=</span> {
  <span class="hljs-attr">useEffect:</span> <span class="hljs-string">mountEffect</span>,
  <span class="hljs-attr">useRef:</span> <span class="hljs-string">mountRef</span>,
  <span class="hljs-attr">useState:</span> <span class="hljs-string">mountState</span>,
  <span class="hljs-string">...</span>
}<span class="hljs-string">;</span>

<span class="hljs-string">//</span> <span class="hljs-string">update</span> <span class="hljs-string">é˜¶æ®µ</span>
<span class="hljs-attr">const HooksDispatcherOnUpdate:</span> <span class="hljs-string">Dispatcher</span> <span class="hljs-string">=</span> {
  <span class="hljs-attr">useEffect:</span> <span class="hljs-string">updateEffect</span>,
  <span class="hljs-attr">useRef:</span> <span class="hljs-string">updateRef</span>,
  <span class="hljs-attr">useState:</span> <span class="hljs-string">updateState</span>,
  <span class="hljs-string">...</span>
}<span class="hljs-string">;</span>
</code></pre>
<h3 data-id="heading-2">æŒ‚è½½é˜¶æ®µ</h3>
<p>å› æ­¤æˆ‘ä»¬ç›´æ¥çœ‹<code>mountState</code>çš„å®ç°ï¼Œå®ƒæ˜¯<code>useState</code>åœ¨ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶çš„åˆå§‹åŒ–é€»è¾‘ã€‚å®ƒçš„ä»»åŠ¡ä¸æ˜¯è®¡ç®—çŠ¶æ€ï¼Œè€Œæ˜¯æ­å»ºå¥½æ•´ä¸ªçŠ¶æ€ç®¡ç†æ‰€éœ€çš„â€œåŸºç¡€è®¾æ–½â€ã€‚</p>
<ol>
<li>é¦–å…ˆ<code>mountWorkInProgressHook</code>çš„ä½œç”¨æ˜¯ï¼šåˆ›å»ºæ–°çš„<code>Hook</code>å¯¹è±¡å¹¶æ·»åŠ åˆ°æ­£åœ¨æ¸²æŸ“çš„<code>Fiber</code>èŠ‚ç‚¹çš„<code>Hook</code>é“¾è¡¨æœ«å°¾ï¼ˆ<code>Hook</code>åŸç†ä¸€æ–‡è¯¦ç»†æåˆ°è¿‡ï¼‰</li>
<li>ç„¶åè®¡ç®—åˆå§‹çŠ¶æ€å€¼ï¼Œå¹¶æ”¾åˆ°<code>hook</code>å¯¹è±¡çš„<code>memoizedState</code>å’Œ<code>baseState</code>å±æ€§ä¸Š</li>
</ol>

<ol>
<li>
<ol>
<li><code>memoizedState</code>ï¼šå½“å‰æ¸²æŸ“å‘¨æœŸçš„çŠ¶æ€å€¼ï¼Œç»„ä»¶æ¸²æŸ“æ—¶ä½¿ç”¨è¿™ä¸ªå€¼ï¼ˆå³<code>state</code>çŠ¶æ€ï¼‰</li>
<li><code>baseState</code>ï¼šåŸºç¡€çŠ¶æ€ï¼Œç”¨äºè®¡ç®—æ›´æ–°</li>
<li>ä¸¤è€…åˆå§‹å€¼ç›¸åŒï¼Œä½†åœ¨æ›´æ–°è¿‡ç¨‹ä¸­å¯èƒ½ä¸åŒï¼ˆç‰¹åˆ«æ˜¯å­˜åœ¨è·³è¿‡çš„æ›´æ–°æ—¶ï¼‰</li>
</ol>
</li>
</ol>

<ol start="3">
<li>ç„¶ååˆ›å»ºæ›´æ–°é˜Ÿåˆ—æ”¾åœ¨<code>hook</code>å¯¹è±¡çš„<code>queue</code>å±æ€§ï¼Œç®¡ç†çŠ¶æ€æ›´æ–°</li>
<li>æœ€åé€šè¿‡<code>dispatchSetState</code>åˆ›å»º<code>dispatch</code>å‡½æ•°ï¼ˆå³<code>setState</code>å‡½æ•°ï¼‰</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/* src/react/packages/react-reconciler/src/ReactFiberHooks.old.js */</span>

<span class="hljs-keyword">function</span> mountState&lt;S&gt;(
  <span class="hljs-attr">initialState</span>: (<span class="hljs-function">() =&gt;</span> S) | S,
): [S, <span class="hljs-title class_">Dispatch</span>&lt;<span class="hljs-title class_">BasicStateAction</span>&lt;S&gt;&gt;] {
  <span class="hljs-comment">// åˆ›å»ºæ–°çš„Hookå¯¹è±¡å¹¶æ·»åŠ åˆ°æ­£åœ¨æ¸²æŸ“çš„FiberèŠ‚ç‚¹çš„Hooké“¾è¡¨æœ«å°¾</span>
  <span class="hljs-keyword">const</span> hook = <span class="hljs-title function_">mountWorkInProgressHook</span>();
  
  <span class="hljs-comment">// è®¡ç®—åˆå§‹çŠ¶æ€å€¼ (æ”¯æŒæƒ°æ€§åˆå§‹åŒ–)</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> initialState === <span class="hljs-string">'function'</span>) {
    initialState = <span class="hljs-title function_">initialState</span>();
  }
  hook.<span class="hljs-property">memoizedState</span> = hook.<span class="hljs-property">baseState</span> = initialState;
  <span class="hljs-keyword">const</span> <span class="hljs-attr">queue</span>: <span class="hljs-title class_">UpdateQueue</span>&lt;S, <span class="hljs-title class_">BasicStateAction</span>&lt;S&gt;&gt; = {
    <span class="hljs-attr">pending</span>: <span class="hljs-literal">null</span>,     <span class="hljs-comment">// æŒ‡å‘æ›´æ–°é˜Ÿåˆ—ä¸­æœ€åä¸€ä¸ªæ›´æ–° (ç¯å½¢é“¾è¡¨)</span>
    <span class="hljs-attr">interleaved</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// åœ¨å¹¶å‘æ¸²æŸ“ä¸­, ç”¨äºå­˜å‚¨è¢«ä¸­æ–­åæ’å…¥çš„æ›´æ–° (ç¯å½¢é“¾è¡¨)</span>
    <span class="hljs-attr">lanes</span>: <span class="hljs-title class_">NoLanes</span>,    <span class="hljs-comment">// è¡¨ç¤ºå½“å‰æ›´æ–°é˜Ÿåˆ—çš„ä¼˜å…ˆçº§ (è½¦é“æ¨¡å‹)</span>
    <span class="hljs-attr">dispatch</span>: <span class="hljs-literal">null</span>,    <span class="hljs-comment">// ç”¨äºä¿å­˜dispatchå‡½æ•°, åœ¨mountReducerä¸­ä¼šè¢«èµ‹å€¼</span>
    <span class="hljs-attr">lastRenderedReducer</span>: basicStateReducer, <span class="hljs-comment">// ç”¨äºè®¡ç®—æ–°çŠ¶æ€çš„reducer</span>
    <span class="hljs-attr">lastRenderedState</span>: (<span class="hljs-attr">initialState</span>: <span class="hljs-built_in">any</span>), <span class="hljs-comment">// ä¸Šä¸€æ¬¡æ¸²æŸ“çš„çŠ¶æ€</span>
  };
  hook.<span class="hljs-property">queue</span> = queue;
  <span class="hljs-keyword">const</span> <span class="hljs-attr">dispatch</span>: <span class="hljs-title class_">Dispatch</span>&lt;
    <span class="hljs-title class_">BasicStateAction</span>&lt;S&gt;,
  &gt; = (queue.<span class="hljs-property">dispatch</span> = (dispatchSetState.<span class="hljs-title function_">bind</span>(
    <span class="hljs-literal">null</span>,
    currentlyRenderingFiber,
    queue,
  ): <span class="hljs-built_in">any</span>));
  <span class="hljs-keyword">return</span> [hook.<span class="hljs-property">memoizedState</span>, dispatch];
}
</code></pre>
<p>ç„¶åçœ‹ä¸€ä¸‹<code>dispatchSetState</code>å‡½æ•°ä¸»è¦åšäº†ä»€ä¹ˆï¼Ÿ</p>
<ol>
<li>é¦–å…ˆè·å–æœ¬æ¬¡æ›´æ–°çš„ä¼˜å…ˆçº§ ï¼Œä½¿ç”¨<code>requestUpdateLane</code>ç¡®å®šæ›´æ–°çš„<strong>ä¼˜å…ˆçº§</strong></li>
<li>ä¹‹ååˆ›å»ºä¸€ä¸ªæ›´æ–°å¯¹è±¡<code>Update</code>ï¼ˆ<code>pending</code>å’Œ<code>interleaved</code>éƒ½æ˜¯ç¯å½¢é“¾è¡¨ï¼‰</li>
</ol>

<ol>
<li>
<ol>
<li>è¿™ä¸ªæ›´æ–°å¦‚æœåœ¨æ¸²æŸ“é˜¶æ®µå‘ç”Ÿï¼Œä¼šè¢«æŒ‚è½½åœ¨<code>hook</code>å¯¹è±¡çš„æ›´æ–°é˜Ÿåˆ—<code>queue</code>çš„<code>pending</code>å±æ€§ä¸Š</li>
<li>å¦‚æœæ˜¯æ­£å¸¸æ›´æ–°ï¼šå¦‚æœæ–°çŠ¶æ€ä¸å½“å‰çŠ¶æ€ç›¸åŒï¼Œç›´æ¥è·³è¿‡æ›´æ–°ï¼Œé¿å…ä¸å¿…è¦æ¸²æŸ“çš„å…³é”®ä¼˜åŒ–ã€‚è¿™ä¸ªæ›´æ–°ä¼šè¢«æŒ‚è½½åœ¨<code>hook</code>å¯¹è±¡çš„æ›´æ–°é˜Ÿåˆ—<code>queue</code>çš„<code>interleaved</code>å±æ€§ä¸Š</li>
</ol>
</li>
</ol>

<ol start="3">
<li>æœ€åä¼šè°ƒåº¦æ›´æ–°ï¼ˆ<code>scheduleUpdateOnFiber</code>ï¼‰ï¼Œå®‰æ’æ¸²æŸ“å·¥ä½œ</li>
</ol>
<pre><code class="hljs language-ini" lang="ini">/* src/react/packages/react-reconciler/src/ReactFiberHooks.old.js */

function dispatchSetState&lt;S, A&gt;(
  fiber: Fiber,
  queue: UpdateQueue&lt;S, A&gt;,
  action: A,
) {
  const <span class="hljs-attr">lane</span> = requestUpdateLane(fiber)<span class="hljs-comment">;</span>

  const update: Update&lt;S, A&gt; = {
    lane,   // ä¼˜å…ˆçº§è½¦é“
    action, // æ›´æ–°åŠ¨ä½œ (å€¼æˆ–å‡½æ•°)
    hasEagerState: false, // æ˜¯å¦å·²è®¡ç®—æ€¥åˆ‡çŠ¶æ€
    eagerState: null,     // é¢„å…ˆè®¡ç®—çš„çŠ¶æ€ (ä¼˜åŒ–ç”¨)
    next: (null: any),    // æŒ‡å‘ä¸‹ä¸€ä¸ªæ›´æ–° (å½¢æˆç¯çŠ¶é“¾è¡¨)
  }<span class="hljs-comment">;</span>

  if (isRenderPhaseUpdate(fiber)) {
    enqueueRenderPhaseUpdate(queue, update)<span class="hljs-comment">;</span>
  } else {
    const <span class="hljs-attr">alternate</span> = fiber.alternate<span class="hljs-comment">;</span>
    if (
      <span class="hljs-attr">fiber.lanes</span> === NoLanes &amp;&amp;
      (<span class="hljs-attr">alternate</span> === null || alternate.lanes === NoLanes)
    ) {
      const <span class="hljs-attr">lastRenderedReducer</span> = queue.lastRenderedReducer<span class="hljs-comment">;</span>
      if (lastRenderedReducer !== null) {
        let prevDispatcher<span class="hljs-comment">;</span>
        try {
          const currentState: <span class="hljs-attr">S</span> = (queue.lastRenderedState: any)<span class="hljs-comment">;</span>
          const <span class="hljs-attr">eagerState</span> = lastRenderedReducer(currentState, action)<span class="hljs-comment">;</span>
          <span class="hljs-attr">update.hasEagerState</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
          <span class="hljs-attr">update.eagerState</span> = eagerState<span class="hljs-comment">;</span>
          if (is(eagerState, currentState)) {
            enqueueConcurrentHookUpdateAndEagerlyBailout(
              fiber,
              queue,
              update,
              lane,
            )<span class="hljs-comment">;</span>
            return<span class="hljs-comment">;</span>
          }
        }
      }
    }

    const <span class="hljs-attr">root</span> = enqueueConcurrentHookUpdate(fiber, queue, update, lane)<span class="hljs-comment">;</span>
    if (root !== null) {
      const <span class="hljs-attr">eventTime</span> = requestEventTime()<span class="hljs-comment">;</span>
      scheduleUpdateOnFiber(root, fiber, lane, eventTime)<span class="hljs-comment">;</span>
      entangleTransitionUpdate(root, queue, lane)<span class="hljs-comment">;</span>
    }
  }
}
</code></pre>
<pre><code class="hljs language-ini" lang="ini">/* src/react/packages/react-reconciler/src/ReactFiberHooks.old.js */

function enqueueRenderPhaseUpdate&lt;S, A&gt;(
  queue: UpdateQueue&lt;S, A&gt;,
  update: Update&lt;S, A&gt;,
) {
  const <span class="hljs-attr">pending</span> = queue.pending<span class="hljs-comment">;</span>
  if (<span class="hljs-attr">pending</span> === null) {
    <span class="hljs-attr">update.next</span> = update<span class="hljs-comment">;</span>
  } else {
    <span class="hljs-attr">update.next</span> = pending.next<span class="hljs-comment">;</span>
    <span class="hljs-attr">pending.next</span> = update<span class="hljs-comment">;</span>
  }
  <span class="hljs-attr">queue.pending</span> = update<span class="hljs-comment">;</span>
}


/* src/react/packages/react-reconciler/src/ReactFiberConcurrentUpdates.old.js */
export function enqueueConcurrentHookUpdate&lt;S, A&gt;(
  fiber: Fiber,
  queue: HookQueue&lt;S, A&gt;,
  update: HookUpdate&lt;S, A&gt;,
  lane: Lane,
) {
  const <span class="hljs-attr">interleaved</span> = queue.interleaved<span class="hljs-comment">;</span>
  if (<span class="hljs-attr">interleaved</span> === null) {
    <span class="hljs-attr">update.next</span> = update<span class="hljs-comment">;</span>
    pushConcurrentUpdateQueue(queue)<span class="hljs-comment">;</span>
  } else {
    <span class="hljs-attr">update.next</span> = interleaved.next<span class="hljs-comment">;</span>
    <span class="hljs-attr">interleaved.next</span> = update<span class="hljs-comment">;</span>
  }
  <span class="hljs-attr">queue.interleaved</span> = update<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-3">æ›´æ–°é˜¶æ®µ</h3>
<p>åœ¨<code>mount</code>é˜¶æ®µåˆå§‹åŒ–äº†<code>hook</code>å¯¹è±¡ï¼Œç„¶åç»™å¼€å‘è€…è¿”å›äº†<code>state</code>å’Œ<code>setState/dispath</code>å‡½æ•°ã€‚</p>
<p>è€Œè¿”å›çš„<code>setState</code>å‡½æ•°æˆ‘ä»¬ä¸Šé¢å·²ç»åˆ†æè¿‡äº†ï¼Œä¸»è¦çš„ä½œç”¨å°±æ˜¯å°†ä¼ å…¥çš„<code>action</code>æ”¾åˆ°<code>hook</code>å¯¹è±¡çš„æ›´æ–°é˜Ÿåˆ—<code>queue</code>ä¸­ã€‚</p>
<p>æ›´æ–°é˜¶æ®µæˆ‘ä»¬çœ‹<code>updateState</code>çš„å®ç°ï¼š<code>updateState</code>ç›´æ¥å§”æ‰˜ç»™äº†<code>updateReducer</code>ï¼Œè¿™æ­ç¤ºäº†ä¸€ä¸ªé‡è¦äº‹å®ï¼š<code>useState</code>åœ¨æ›´æ–°é˜¶æ®µå°±æ˜¯ä¸€ä¸ªé¢„å®šä¹‰<code>reducer</code>çš„<code>useReducer</code>ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">/* src/react/packages/react-reconciler/src/ReactFiberHooks.old.js */</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateState</span>&lt;<span class="hljs-title">S</span>&gt;(<span class="hljs-params">
  initialState: (<span class="hljs-params">(<span class="hljs-params"/>) =&gt; S</span>) | S,
</span>): [<span class="hljs-title">S</span>, <span class="hljs-title">Dispatch</span>&lt;<span class="hljs-title">BasicStateAction</span>&lt;<span class="hljs-title">S</span>&gt;&gt;] </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">updateReducer</span>(basicStateReducer, (<span class="hljs-attr">initialState</span>: any));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">basicStateReducer</span>&lt;<span class="hljs-title">S</span>&gt;(<span class="hljs-params">state: S, action: BasicStateAction&lt;S&gt;</span>): <span class="hljs-title">S</span> </span>{
  <span class="hljs-keyword">return</span> typeof action === <span class="hljs-string">'function'</span> ? <span class="hljs-title function_ invoke__">action</span>(state) : action;
}
</code></pre>
<ol>
<li><strong>é˜Ÿåˆ—åˆå¹¶</strong>ï¼šå‡½æ•°é¦–å…ˆä¼šå°†æ–°åŠ å…¥çš„ã€å°šæœªå¤„ç†çš„æ›´æ–°é˜Ÿåˆ— (<code>queue.pending</code>)ï¼Œåˆå¹¶åˆ°å½“å‰æ­£åœ¨å¤„ç†çš„åŸºç¡€é˜Ÿåˆ— (<code>current.baseQueue</code>) ä¸­ã€‚è¿™ä¸ªåˆå¹¶æ“ä½œç¡®ä¿äº†æ‰€æœ‰æ›´æ–°éƒ½åœ¨ä¸€ä¸ªç¯çŠ¶é“¾è¡¨é‡ŒæŒ‰é¡ºåºæ’é˜Ÿã€‚</li>
<li><strong>ä¼˜å…ˆçº§åˆ†æ‹£ä¸çŠ¶æ€è®¡ç®—</strong>ï¼ˆå‡½æ•°ä¼šéå†åˆå¹¶åçš„é˜Ÿåˆ—ï¼Œå¯¹æ¯ä¸€ä¸ªæ›´æ–°è¿›è¡Œæ£€æŸ¥ï¼‰</li>
</ol>

<ol>
<li>
<ol>
<li>å¦‚æœä¼˜å…ˆçº§ä¸è¶³ï¼šæ­¤æ›´æ–°è¢«è·³è¿‡ï¼Œä½†å®ƒä¼šè¢«å…‹éš†ä¸€ä»½ï¼ŒåŠ å…¥åˆ° <code>newBaseQueue</code> ä¸­ã€‚è¿™ä¸ªè¢«è·³è¿‡çš„é˜Ÿåˆ—ï¼Œè¿åŒè®¡ç®—åˆ°æ­¤åˆ»çš„çŠ¶æ€ (<code>newBaseState</code>)ï¼Œå°†æˆä¸ºä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶è®¡ç®—çš„èµ·ç‚¹ï¼ˆå³æ–°çš„<code>baseState</code>å’Œ<code>baseQueue</code>ï¼‰ã€‚</li>
<li>å¦‚æœä¼˜å…ˆçº§è¶³å¤Ÿï¼šæ­¤æ›´æ–°è¢«å¤„ç†ã€‚å¦‚æœå®ƒä¹‹å‰å·²è¢«é¢„è®¡ç®—åˆ™ç›´æ¥é‡‡ç”¨è®¡ç®—ç»“æœï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰ï¼›å¦åˆ™è°ƒç”¨<code>reducer</code>å‡½æ•°ï¼Œä¼ å…¥å½“å‰ç´¯ç§¯çš„<code>newState</code>å’Œæ›´æ–°çš„<code>action</code>ï¼Œè®¡ç®—å‡ºæ–°çš„çŠ¶æ€ã€‚</li>
</ol>
</li>
</ol>

<ol start="3">
<li><strong>äº¤é”™æ›´æ–°å¤„ç†</strong>ï¼šå¾ªç¯ç»“æŸåï¼Œå‡½æ•°ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨<code>interleaved</code>æ›´æ–°ï¼ˆé€šå¸¸ç”±é«˜ä¼˜å…ˆçº§æ›´æ–°ä¸­æ–­ä½ä¼˜å…ˆçº§æ¸²æŸ“äº§ç”Ÿï¼‰ã€‚æ³¨æ„ï¼šè¿™é‡Œå¹¶ä¸ä¼šå¤„ç†è¿™äº›æ›´æ–°çš„å…·ä½“å†…å®¹ï¼ˆ<code>action</code>ï¼‰ï¼Œè€Œåªæ˜¯å°†å®ƒä»¬æ‰€æºå¸¦çš„ä¼˜å…ˆçº§ï¼ˆ<code>lane</code>ï¼‰åˆå¹¶åˆ°å½“å‰ <code>Fiber</code>ä¸­ï¼Œç¡®ä¿ç³»ç»ŸçŸ¥é“â€œè¿˜æœ‰è¿™äº›ä¼˜å…ˆçº§çš„ä»»åŠ¡å¾…åŠâ€ã€‚</li>
</ol>
<p>éå†å®Œæ‰€æœ‰å¯ä»¥æ‰§è¡Œçš„ä»»åŠ¡åï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„<code>state</code>ï¼Œè¿”å›æ–°çš„<code>state</code>å’Œ<code>setStatus/dispath</code>æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">function updateReducer&lt;S, I, A&gt;(
  reducer: (S, A) =&gt; S,
  initialArg: I,
  init?: <span class="hljs-attr">I</span> =&gt; S,
): <span class="hljs-section">[S, Dispatch&lt;A&gt;]</span> {
  const <span class="hljs-attr">hook</span> = updateWorkInProgressHook()<span class="hljs-comment">; // è·å–å½“å‰æ­£åœ¨å¤„ç†çš„ WIP Hook</span>
  const <span class="hljs-attr">queue</span> = hook.queue<span class="hljs-comment">; // è·å–è¯¥ Hookçš„æ›´æ–°é˜Ÿåˆ—</span>

  <span class="hljs-attr">queue.lastRenderedReducer</span> = reducer<span class="hljs-comment">; // æ›´æ–° reducer(å¯¹ useStateå°±æ˜¯ basicStateReducer)</span>

  const current: <span class="hljs-attr">Hook</span> = (currentHook: any)<span class="hljs-comment">;</span>

  let <span class="hljs-attr">baseQueue</span> = current.baseQueue<span class="hljs-comment">;  // baseQueue: ä¸Šä¸€æ¬¡æ¸²æŸ“ä¸­è¢«è·³è¿‡çš„ä½ä¼˜å…ˆçº§æ›´æ–°(ç¯å½¢é“¾è¡¨: æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä¸ªèŠ‚ç‚¹)</span>
  const <span class="hljs-attr">pendingQueue</span> = queue.pending<span class="hljs-comment">; // pending: æœ¬æ¬¡æ¸²æŸ“å‘¨æœŸæ–°äº§ç”Ÿã€å°šæœªå¤„ç†çš„æ›´æ–°(ç¯å½¢é“¾è¡¨: æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä¸ªèŠ‚ç‚¹)</span>

  // åˆå¹¶é˜Ÿåˆ—: å°†æ–°æ›´æ–°(pendingQueue)åˆå¹¶åˆ° baseQueue
  if (pendingQueue !== null) {
    if (baseQueue !== null) { // ä¸¤ä¸ªç¯çŠ¶é“¾è¡¨åˆå¹¶
      const <span class="hljs-attr">baseFirst</span> = baseQueue.next<span class="hljs-comment">;</span>
      const <span class="hljs-attr">pendingFirst</span> = pendingQueue.next<span class="hljs-comment">;</span>
      <span class="hljs-attr">baseQueue.next</span> = pendingFirst<span class="hljs-comment">;</span>
      <span class="hljs-attr">pendingQueue.next</span> = baseFirst<span class="hljs-comment">;</span>
    }
    <span class="hljs-attr">current.baseQueue</span> = baseQueue = pendingQueue<span class="hljs-comment">; // å°†åˆå¹¶åçš„é˜Ÿåˆ—è®¾ä¸ºæ–°çš„ baseQueue</span>
    <span class="hljs-attr">queue.pending</span> = null<span class="hljs-comment">; // æ¸…ç©ºæ›´æ–°é˜Ÿåˆ—</span>
  }

  // å¤„ç†é˜Ÿåˆ—: éå†å¹¶è®¡ç®—æ–°çŠ¶æ€(æ ¸å¿ƒå¾ªç¯)
  if (baseQueue !== null) {
    const <span class="hljs-attr">first</span> = baseQueue.next<span class="hljs-comment">;</span>
    let <span class="hljs-attr">newState</span> = current.baseState<span class="hljs-comment">;</span>

    let <span class="hljs-attr">newBaseState</span> = null<span class="hljs-comment">;</span>
    let <span class="hljs-attr">newBaseQueueFirst</span> = null<span class="hljs-comment">;</span>
    let <span class="hljs-attr">newBaseQueueLast</span> = null<span class="hljs-comment">;</span>
    let <span class="hljs-attr">update</span> = first<span class="hljs-comment">;</span>
    do {
      const <span class="hljs-attr">updateLane</span> = update.lane<span class="hljs-comment">;</span>
      // åˆ¤æ–­ä¼˜å…ˆçº§: å½“å‰æ›´æ–°çš„ä¼˜å…ˆçº§æ˜¯å¦è¶³å¤Ÿåœ¨å½“å‰æ¸²æŸ“ä¸­æ‰§è¡Œ? - ä¼˜å…ˆçº§ä¸è¶³
      if (!isSubsetOfLanes(renderLanes, updateLane)) {
        const clone: Update&lt;S, A&gt; = {
          lane: updateLane,
          action: update.action,
          hasEagerState: update.hasEagerState,
          eagerState: update.eagerState,
          next: (null: any),
        }<span class="hljs-comment">;</span>
        if (<span class="hljs-attr">newBaseQueueLast</span> === null) {
          <span class="hljs-attr">newBaseQueueFirst</span> = newBaseQueueLast = clone<span class="hljs-comment">;</span>
          <span class="hljs-attr">newBaseState</span> = newState<span class="hljs-comment">;</span>
        } else {
          <span class="hljs-attr">newBaseQueueLast</span> = newBaseQueueLast.next = clone<span class="hljs-comment">;</span>
        }
        <span class="hljs-attr">currentlyRenderingFiber.lanes</span> = mergeLanes(
          currentlyRenderingFiber.lanes,
          updateLane,
        )<span class="hljs-comment">;</span>
        markSkippedUpdateLanes(updateLane)<span class="hljs-comment">;</span>
      } else {
        // This update does have sufficient priority.

        if (newBaseQueueLast !== null) {
          const clone: Update&lt;S, A&gt; = {
            lane: NoLane,
            action: update.action,
            hasEagerState: update.hasEagerState,
            eagerState: update.eagerState,
            next: (null: any),
          }<span class="hljs-comment">;</span>
          <span class="hljs-attr">newBaseQueueLast</span> = newBaseQueueLast.next = clone<span class="hljs-comment">;</span>
        }

        if (update.hasEagerState) {
          <span class="hljs-attr">newState</span> = ((update.eagerState: any): S)<span class="hljs-comment">;</span>
        } else {
          const <span class="hljs-attr">action</span> = update.action<span class="hljs-comment">;</span>
          <span class="hljs-attr">newState</span> = reducer(newState, action)<span class="hljs-comment">;</span>
        }
      }
      <span class="hljs-attr">update</span> = update.next<span class="hljs-comment">;</span>
    } while (update !== null &amp;&amp; update !== first)<span class="hljs-comment">;</span>

    if (<span class="hljs-attr">newBaseQueueLast</span> === null) {
      <span class="hljs-attr">newBaseState</span> = newState<span class="hljs-comment">;</span>
    } else {
      <span class="hljs-attr">newBaseQueueLast.next</span> = (newBaseQueueFirst: any)<span class="hljs-comment">;</span>
    }

    if (!is(newState, hook.memoizedState)) {
      markWorkInProgressReceivedUpdate()<span class="hljs-comment">;</span>
    }

    <span class="hljs-attr">hook.memoizedState</span> = newState<span class="hljs-comment">;</span>
    <span class="hljs-attr">hook.baseState</span> = newBaseState<span class="hljs-comment">;</span>
    <span class="hljs-attr">hook.baseQueue</span> = newBaseQueueLast<span class="hljs-comment">;</span>

    <span class="hljs-attr">queue.lastRenderedState</span> = newState<span class="hljs-comment">;</span>
  }

  const <span class="hljs-attr">lastInterleaved</span> = queue.interleaved<span class="hljs-comment">;</span>
  if (lastInterleaved !== null) {
    let <span class="hljs-attr">interleaved</span> = lastInterleaved<span class="hljs-comment">;</span>
    do {
      const <span class="hljs-attr">interleavedLane</span> = interleaved.lane<span class="hljs-comment">;</span>
      <span class="hljs-attr">currentlyRenderingFiber.lanes</span> = mergeLanes(
        currentlyRenderingFiber.lanes,
        interleavedLane,
      )<span class="hljs-comment">;</span>
      markSkippedUpdateLanes(interleavedLane)<span class="hljs-comment">;</span>
      <span class="hljs-attr">interleaved</span> = ((interleaved: any).next: Update&lt;S, A&gt;)<span class="hljs-comment">;</span>
    } while (interleaved !== lastInterleaved)<span class="hljs-comment">;</span>
  } else if (<span class="hljs-attr">baseQueue</span> === null) {
    <span class="hljs-attr">queue.lanes</span> = NoLanes<span class="hljs-comment">;</span>
  }

  const dispatch: Dispatch&lt;A&gt; = (queue.dispatch: any)<span class="hljs-comment">;</span>
  return <span class="hljs-section">[hook.memoizedState, dispatch]</span><span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-4">useReducer æºç </h2>
<p><code>useReducer</code>å…¶å®å°±æ˜¯å¯ä»¥è‡ªå®šä¹‰æ›´æ–°æ–¹æ³•çš„<code>useState</code>ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">function mountReducer&lt;S, I, A&gt;(
  reducer: (S, A) =&gt; S,
  initialArg: I,
  init?: <span class="hljs-attr">I</span> =&gt; S,
): <span class="hljs-section">[S, Dispatch&lt;A&gt;]</span> {
  // åˆ›å»ºæ–°çš„Hookå¯¹è±¡å¹¶æ·»åŠ åˆ°æ­£åœ¨æ¸²æŸ“çš„FiberèŠ‚ç‚¹çš„Hooké“¾è¡¨æœ«å°¾
  const <span class="hljs-attr">hook</span> = mountWorkInProgressHook()<span class="hljs-comment">;</span>
  // è®¡ç®—åˆå§‹çŠ¶æ€å€¼
  let initialState<span class="hljs-comment">;</span>
  if (init !== undefined) {
    <span class="hljs-attr">initialState</span> = init(initialArg)<span class="hljs-comment">;</span>
  } else {
    <span class="hljs-attr">initialState</span> = ((initialArg: any): S)<span class="hljs-comment">;</span>
  }
  <span class="hljs-attr">hook.memoizedState</span> = hook.baseState = initialState<span class="hljs-comment">;</span>
  const queue: UpdateQueue&lt;S, A&gt; = {
    pending: null,
    interleaved: null,
    lanes: NoLanes,
    dispatch: null,
    lastRenderedReducer: reducer,
    lastRenderedState: (initialState: any),
  }<span class="hljs-comment">;</span>
  <span class="hljs-attr">hook.queue</span> = queue<span class="hljs-comment">;</span>
  const dispatch: Dispatch&lt;A&gt; = (<span class="hljs-attr">queue.dispatch</span> = (dispatchReducerAction.bind(
    null,
    currentlyRenderingFiber,
    queue,
  ): any))<span class="hljs-comment">;</span>
  return <span class="hljs-section">[hook.memoizedState, dispatch]</span><span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p><strong>React Hooks è®¾è®¡çš„ç²¾å¦™ä¹‹å¤„</strong></p>
<ol>
<li><strong>æœ€å°åŒ– APIï¼Œæœ€å¤§åŒ–èƒ½åŠ›</strong>ï¼šé€šè¿‡æç®€çš„<code>API</code>è®¾è®¡ï¼Œæä¾›äº†å¼ºå¤§çš„çŠ¶æ€ç®¡ç†èƒ½åŠ›</li>
<li><strong>å‡½æ•°å¼ç†å¿µçš„è´¯å½»</strong>ï¼šçº¯å‡½æ•°ç»„ä»¶ + ä¸å¯å˜çŠ¶æ€æ›´æ–° = å¯é¢„æµ‹çš„<code>UI</code></li>
<li><strong>æ€§èƒ½ä¼˜åŒ–çš„å†…ç½®</strong>ï¼šè‡ªåŠ¨çš„<code>bail-out</code>æœºåˆ¶ï¼Œå‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“</li>
</ol>
<p>ä¸‹ä¸€ç« æˆ‘ä»¬å°†äº†è§£å…¶ä»–<code>hook</code>çš„å®ç°æ–¹å¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº AI ç”Ÿæˆé«˜è´¨é‡ Mock æ•°æ®çš„å®è·µ]]></title>    <link>https://juejin.cn/post/7603004323870851115</link>    <guid>https://juejin.cn/post/7603004323870851115</guid>    <pubDate>2026-02-05T02:39:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603004323870851115" data-draft-id="7602816610932932671" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº AI ç”Ÿæˆé«˜è´¨é‡ Mock æ•°æ®çš„å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-02-05T02:39:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è½¬è½¬æŠ€æœ¯å›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/606586148237431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº AI ç”Ÿæˆé«˜è´¨é‡ Mock æ•°æ®çš„å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/606586148237431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è½¬è½¬æŠ€æœ¯å›¢é˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:39:04.000Z" title="Thu Feb 05 2026 02:39:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨å‰åç«¯åˆ†ç¦»çš„ç ”å‘æ¨¡å¼ä¸‹ï¼ŒMock æ•°æ®æ˜¯å¹¶è¡Œå¼€å‘çš„åŸºç¡€è®¾æ–½ã€‚æœ¬æ–‡ä»‹ç»ä¸€å¥— Mock å·¥å…·çš„æŠ€æœ¯å®ç°ï¼Œæ ¸å¿ƒè§£å†³å››ä¸ªé—®é¢˜ï¼šè¯·æ±‚æ‹¦æˆªã€è§„åˆ™åŒ¹é…ã€æ•°æ®è´¨é‡ã€å›¢é˜Ÿå…±äº«ã€‚</p>
</blockquote>
<h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨å®é™…ä¸šåŠ¡å¼€å‘ä¸­ï¼Œå‰ç«¯å’Œæµ‹è¯•åŒå­¦ç»å¸¸é‡åˆ°è¿™äº›é—®é¢˜ï¼š</p>
<ul>
<li><strong>è”è°ƒé˜»å¡</strong>ï¼šåç«¯æ¥å£æœªå°±ç»ªæ—¶ï¼Œå‰ç«¯åªèƒ½ç­‰å¾…æˆ–ç¡¬ç¼–ç  <code>if (true) { ... }</code></li>
<li><strong>åœºæ™¯è¦†ç›–éš¾</strong>ï¼šæƒ³æ¨¡æ‹Ÿè¾¹ç¼˜åœºæ™¯ï¼ˆå¼‚å¸¸ã€ç©ºæ•°æ®ã€åˆ†é¡µï¼‰ï¼Œå¾€å¾€éœ€è¦åç«¯æ”¹æ•°æ®åº“</li>
<li><strong>Mock æ•°æ®è´¨é‡å·®</strong>ï¼šMock.js ç”Ÿæˆçš„ <code>@cname</code>ã€<code>@integer</code> ç¼ºä¹ä¸šåŠ¡è¯­ä¹‰ï¼Œå’ŒçœŸå®æ•°æ®å·®è·å¤§</li>
<li><strong>æ•°æ®éš¾å…±äº«</strong>ï¼šMock æ•°æ®å­˜åœ¨æœ¬åœ°ï¼Œæ¢å°ç”µè„‘æˆ–æ¢ä¸ªåŒäº‹å°±ç”¨ä¸äº†</li>
</ul>
<p>æˆ‘ä»¬éœ€è¦ä¸€å¥—å·¥å…·è§£å†³è¿™äº›é—®é¢˜ï¼š</p>
<ul>
<li>ä¸ä¾µå…¥ä¸šåŠ¡ä»£ç ï¼Œnpm åŒ…å¼•å…¥å³å¯</li>
<li>æ”¯æŒå‚æ•°çº§åˆ«çš„è§„åˆ™åŒ¹é…ï¼ŒåŒä¸€æ¥å£å¯é…ç½®å¤šä¸ªåœºæ™¯</li>
<li>æ ¹æ®æ¥å£æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆç¬¦åˆä¸šåŠ¡è¯­ä¹‰çš„æ•°æ®</li>
<li>æ”¯æŒå›¢é˜Ÿå…±äº« Mock é…ç½®</li>
</ul>
<hr/>
<h2 data-id="heading-1">ä¸šç•Œå¸¸è§æ–¹æ¡ˆ</h2>



































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ä¸è¶³</th></tr></thead><tbody><tr><td>ç¡¬ç¼–ç  Mock</td><td>ç®€å•ç›´æ¥</td><td>ä¾µå…¥ä¸šåŠ¡ä»£ç ï¼Œå‘å¸ƒå‰éœ€æ‰‹åŠ¨åˆ é™¤</td></tr><tr><td>Mock.js</td><td>æœ‰æ•°æ®ç”Ÿæˆèƒ½åŠ›</td><td>è§„åˆ™é…ç½®ç¹çï¼Œæ•°æ®ç¼ºä¹ä¸šåŠ¡è¯­ä¹‰</td></tr><tr><td>whistle ä»£ç†</td><td>ä¸ä¾µå…¥ä¸šåŠ¡ï¼Œä½¿ç”¨ç®€å•</td><td>æ•°æ®ä¿å­˜åœ¨æœ¬åœ°ï¼Œæ— æ³•å›¢é˜Ÿå…±äº«ï¼Œæ— æ³•åŒ¹é…å¤æ‚åœºæ™¯</td></tr><tr><td>MSW (Service Worker)</td><td>ç½‘ç»œå±‚æ‹¦æˆª</td><td>éœ€æ³¨å†Œ sw.jsï¼Œä¾èµ– HTTPSï¼Œæ¥å…¥æˆæœ¬é«˜</td></tr><tr><td>æµè§ˆå™¨æ’ä»¶</td><td>ä½¿ç”¨ç®€å• æ— ä¾µå…¥å¼</td><td>è§„åˆ™åœ¨æœ¬åœ°ï¼Œæ— æ³•æ¥å…¥å†…éƒ¨æ¥å£å¹³å°</td></tr></tbody></table>
<p>è¿™äº›æ–¹æ¡ˆéƒ½æ— æ³•åŒæ—¶æ»¡è¶³"ä½ä¾µå…¥"ã€"è§„åˆ™çµæ´»"ã€"æ•°æ®è´¨é‡é«˜"ã€"å›¢é˜Ÿå¯å…±äº«"å››ä¸ªéœ€æ±‚ã€‚</p>
<hr/>
<h2 data-id="heading-2">æ•´ä½“æ¶æ„</h2>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ä¸šåŠ¡é¡¹ç›®                              â”‚
â”‚   import { mockInit } <span class="hljs-selector-tag">from</span> '<span class="hljs-keyword">@zz-common</span>/ai_mock'             â”‚
â”‚   mockInit({ rules: [<span class="hljs-string">'api.example.com'</span>] })                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ai_mock (npm åŒ…)                         â”‚
â”‚      XHR/Fetch æ‹¦æˆª  â†’  è§„åˆ™åŒ¹é…å¼•æ“  â†’  è¿”å› Mock æ•°æ®         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ åŠ¨æ€åŠ è½½ sdk + CustomEvent é€šä¿¡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  mock-sdk (å¯è§†åŒ–é¢æ¿)                        â”‚
â”‚        è¯·æ±‚åˆ—è¡¨  |  è§„åˆ™ç®¡ç†  |  Monaco Editor ç¼–è¾‘å™¨           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   node (åç«¯æœåŠ¡)                            â”‚
â”‚         æ¥å£æ–‡æ¡£è·å–  â†’  AI ç”Ÿæˆ  â†’  æ•°æ®æŒä¹…åŒ–                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>æ ¸å¿ƒè®¾è®¡ï¼š</p>
<ul>
<li><code>ai_mock</code> åªè´Ÿè´£æ‹¦æˆªå’ŒåŒ¹é…ï¼Œä¸åŒ…å« UI ä»£ç </li>
<li><code>mock-sdk</code> é€šè¿‡ CDN åŠ¨æ€æ³¨å…¥ï¼Œä¸å¢åŠ ä¸šåŠ¡åŒ…ä½“ç§¯</li>
<li>ä¸¤è€…é€šè¿‡ <code>CustomEvent</code> æ¾è€¦åˆé€šä¿¡</li>
<li>ä»…åœ¨éç”Ÿäº§ç¯å¢ƒå¯ç”¨</li>
</ul>
<hr/>
<h2 data-id="heading-3">æ ¸å¿ƒå®ç°ä¸€ï¼šè¯·æ±‚æ‹¦æˆª</h2>
<h3 data-id="heading-4">é—®é¢˜</h3>
<p>ç°ä»£å‰ç«¯åº”ç”¨æ··åˆä½¿ç”¨ <code>XMLHttpRequest</code> å’Œ <code>fetch</code>ã€‚æ‹¦æˆªæ—¶éœ€è¦è§£å†³ï¼š</p>
<ol>
<li>åŒæ—¶æ‹¦æˆª XHR å’Œ Fetchï¼Œä¸”ä¸ç ´åç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Sentryï¼‰çš„ç›‘å¬é€»è¾‘</li>
<li>XHR çš„ <code>readyState</code>ã€<code>status</code>ã€<code>responseText</code> æ˜¯åªè¯»å±æ€§ï¼Œæ— æ³•ç›´æ¥èµ‹å€¼</li>
<li>æ‹¦æˆªåå‘é€çœŸå®è¯·æ±‚ä¼šå†æ¬¡è¿›å…¥æ‹¦æˆªé€»è¾‘ï¼Œé€ æˆæ— é™é€’å½’</li>
</ol>
<h3 data-id="heading-5">å®ç°</h3>
<p>é€šè¿‡é‡å†™ <code>XMLHttpRequest.prototype.send</code> å’Œ <code>window.fetch</code> å®ç°æ‹¦æˆªï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¿å­˜åŸå§‹æ–¹æ³•</span>
<span class="hljs-keyword">const</span> xhrSendNative = <span class="hljs-title class_">XMLHttpRequest</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">send</span>
<span class="hljs-keyword">const</span> originalFetch = <span class="hljs-variable language_">window</span>.<span class="hljs-property">fetch</span>

<span class="hljs-comment">// é˜²é€’å½’ï¼šæ ‡è®°çœŸå®è¯·æ±‚</span>
<span class="hljs-keyword">const</span> isRealRequest = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>&lt;<span class="hljs-title class_">XMLHttpRequest</span>, <span class="hljs-built_in">boolean</span>&gt;()

<span class="hljs-title class_">XMLHttpRequest</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">send</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
  <span class="hljs-keyword">const</span> xhr = <span class="hljs-variable language_">this</span>
  <span class="hljs-keyword">const</span> url = <span class="hljs-title function_">sliceUrlPath</span>(xhr.<span class="hljs-property">originRequestUrl</span>)
  
  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºæ ‡è®°çš„çœŸå®è¯·æ±‚ï¼Œé˜²æ­¢æ— é™é€’å½’</span>
  <span class="hljs-keyword">if</span> (isRealRequest.<span class="hljs-title function_">get</span>(xhr)) {
    <span class="hljs-keyword">return</span> xhrSendNative.<span class="hljs-title function_">apply</span>(xhr, args)
  }
  
  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å‘½ä¸­ Mock è§„åˆ™</span>
  <span class="hljs-keyword">if</span> (mockInterface[url]?.<span class="hljs-property">isOpen</span>) {
    <span class="hljs-keyword">const</span> mockResult = <span class="hljs-title function_">getMockData</span>(url, requestData)
    
    <span class="hljs-keyword">if</span> (mockResult.<span class="hljs-property">matched</span>) {
      <span class="hljs-comment">// 1. ç«‹å³è¿”å› Mock å“åº”ç»™ä¸šåŠ¡å±‚</span>
      <span class="hljs-title function_">applyMockResponseToXhr</span>(xhr, mockResult.<span class="hljs-property">data</span>, mockResult.<span class="hljs-property">httpStatusCode</span>)
      
      <span class="hljs-comment">// 2. åå°å‘é€çœŸå®è¯·æ±‚ï¼ˆç”¨äºæ•°æ®å¯¹ç…§ï¼Œä¸è§¦å‘ä¸šåŠ¡å›è°ƒï¼‰</span>
      <span class="hljs-keyword">const</span> realXhr = <span class="hljs-title function_">cloneXHR</span>(xhr, <span class="hljs-literal">false</span>)  <span class="hljs-comment">// ä¸å¤åˆ¶äº‹ä»¶ç›‘å¬å™¨</span>
      isRealRequest.<span class="hljs-title function_">set</span>(realXhr, <span class="hljs-literal">true</span>)       <span class="hljs-comment">// æ ‡è®°ï¼Œé˜²æ­¢é€’å½’</span>
      xhrSendNative.<span class="hljs-title function_">apply</span>(realXhr, args)
      <span class="hljs-keyword">return</span>
    }
  }
  
  <span class="hljs-comment">// æœªå‘½ä¸­ï¼šæ‰§è¡ŒåŸç”Ÿè¯·æ±‚</span>
  xhrSendNative.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
}
</code></pre>
<p><strong>è¦†å†™åªè¯»å±æ€§</strong>ï¼šXHR çš„ <code>readyState</code>ã€<code>status</code> ç­‰å±æ€§æ˜¯åªè¯»çš„ï¼Œé€šè¿‡ <code>Object.defineProperties</code> è§£å†³ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">applyMockResponseToXhr</span> = (<span class="hljs-params">
  xhr: XMLHttpRequest,
  responseData: <span class="hljs-built_in">any</span>,
  statusCode: <span class="hljs-built_in">number</span>
</span>) =&gt; {
  <span class="hljs-keyword">const</span> responseText = <span class="hljs-keyword">typeof</span> responseData === <span class="hljs-string">'string'</span> 
    ? responseData 
    : <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(responseData)
  
  <span class="hljs-comment">// é€šè¿‡ defineProperties è¦†å†™åªè¯»å±æ€§</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperties</span>(xhr, {
    <span class="hljs-attr">readyState</span>: { <span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-number">4</span>, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span> },
    <span class="hljs-attr">status</span>: { <span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> statusCode, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span> },
    <span class="hljs-attr">response</span>: { <span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> responseData, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span> },
    <span class="hljs-attr">responseText</span>: { <span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> responseText, <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span> }
  })
  
  <span class="hljs-comment">// è§¦å‘æ ‡å‡†äº‹ä»¶åºåˆ—</span>
  xhr.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">'readystatechange'</span>))
  xhr.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">'load'</span>))
  xhr.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">'loadend'</span>))
}
</code></pre>
<p><strong>ç«‹å³å“åº” + çœŸå®è¯·æ±‚</strong>ï¼šå¼€å¯ Mock åï¼Œä¸šåŠ¡å±‚ç«‹å³æ‹¿åˆ° Mock æ•°æ®ï¼ŒåŒæ—¶åå°ä¼šå‘é€ä¸€ä»½çœŸå®è¯·æ±‚ç”¨äºæ•°æ®å¯¹ç…§ã€‚é¢æ¿æä¾›ã€ŒåŠ è½½çœŸå®æ•°æ®ã€æŒ‰é’®ï¼Œå¯ä»¥ä¸€é”®å°†çœŸå®å“åº”å¡«å…¥ç¼–è¾‘å™¨ï¼Œæ–¹ä¾¿åŸºäºçœŸå®æ•°æ®å¾®è°ƒã€‚</p>
<hr/>
<h2 data-id="heading-6">æ ¸å¿ƒå®ç°äºŒï¼šè§„åˆ™åŒ¹é…å¼•æ“</h2>
<h3 data-id="heading-7">é—®é¢˜</h3>
<p>å®é™…ä¸šåŠ¡ä¸­ï¼ŒåŒä¸€ä¸ªæ¥å£éœ€è¦æ ¹æ®ä¸åŒå‚æ•°è¿”å›ä¸åŒæ•°æ®ï¼š</p>
<ul>
<li><code>page=1</code> è¿”å›ç¬¬ä¸€é¡µï¼Œ<code>page=2</code> è¿”å›ç¬¬äºŒé¡µ</li>
<li><code>userId=vip</code> è¿”å› VIP æ•°æ®ï¼Œ<code>userId=normal</code> è¿”å›æ™®é€šæ•°æ®</li>
<li><code>header</code> ä¸­å¸¦æŸä¸ªæ ‡è¯†æ—¶è¿”å›è°ƒè¯•æ•°æ®</li>
</ul>
<p>å‚æ•°å¯èƒ½åœ¨ URL Queryã€Request Bodyã€Headerã€Cookieã€Path ä¸­ï¼Œéœ€è¦ä¸€å¥—çµæ´»çš„è§„åˆ™åŒ¹é…æœºåˆ¶ã€‚</p>
<h3 data-id="heading-8">è§„åˆ™æ•°æ®ç»“æ„</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">MockRule</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">priority</span>: <span class="hljs-built_in">number</span>;  <span class="hljs-comment">// ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°è¶Šä¼˜å…ˆ</span>
  <span class="hljs-attr">enabled</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">type</span>: <span class="hljs-number">1</span> | <span class="hljs-number">2</span> | <span class="hljs-number">3</span>;   <span class="hljs-comment">// 1=æœ¬åœ°è‰ç¨¿ï¼Œ2=ä¸ªäººäº‘ç«¯ï¼Œ3=å›¢é˜Ÿå…±äº«</span>
  <span class="hljs-attr">paramConditions</span>: <span class="hljs-title class_">ParamCondition</span>[];  <span class="hljs-comment">// å‚æ•°æ¡ä»¶</span>
  <span class="hljs-attr">mockData</span>: <span class="hljs-built_in">any</span>;
  <span class="hljs-attr">httpStatusCode</span>: <span class="hljs-built_in">number</span>;
  delay?: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ParamCondition</span> {
  <span class="hljs-attr">location</span>: <span class="hljs-string">'query'</span> | <span class="hljs-string">'body'</span> | <span class="hljs-string">'header'</span> | <span class="hljs-string">'cookie'</span> | <span class="hljs-string">'path'</span>;
  <span class="hljs-attr">paramName</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">operator</span>: <span class="hljs-string">'equals'</span> | <span class="hljs-string">'notEquals'</span> | <span class="hljs-string">'contains'</span> | <span class="hljs-string">'notContains'</span> | 
            <span class="hljs-string">'greaterThan'</span> | <span class="hljs-string">'lessThan'</span> | <span class="hljs-string">'greaterOrEqual'</span> | <span class="hljs-string">'lessOrEqual'</span>;
  <span class="hljs-attr">value</span>: <span class="hljs-built_in">any</span>;
}
</code></pre>
<h3 data-id="heading-9">åŒ¹é…ç®—æ³•</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">matchRule</span>(<span class="hljs-params">rules: MockRule[], request: RequestInfo</span>): <span class="hljs-title class_">MatchResult</span> {
  <span class="hljs-comment">// åªåŒ¹é…å·²å¯ç”¨çš„æœŸæœ›ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åº</span>
  <span class="hljs-keyword">const</span> enabledRules = rules
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">rule</span> =&gt;</span> rule.<span class="hljs-property">enabled</span>)
    .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">priority</span> - b.<span class="hljs-property">priority</span>);

  <span class="hljs-keyword">const</span> matched = enabledRules.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">rule</span> =&gt;</span> <span class="hljs-title function_">isRuleMatched</span>(rule, request));
  
  <span class="hljs-keyword">return</span> matched 
    ? { <span class="hljs-attr">matched</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">rule</span>: matched, <span class="hljs-attr">delay</span>: matched.<span class="hljs-property">delay</span> ?? <span class="hljs-number">0</span> }
    : { <span class="hljs-attr">matched</span>: <span class="hljs-literal">false</span> };
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isRuleMatched</span>(<span class="hljs-params">rule: MockRule, request: RequestInfo</span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-comment">// æ²¡æœ‰å‚æ•°æ¡ä»¶ï¼ŒåŒ¹é…æ‰€æœ‰è¯·æ±‚</span>
  <span class="hljs-keyword">if</span> (!rule.<span class="hljs-property">paramConditions</span>?.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  
  <span class="hljs-comment">// æ‰€æœ‰æ¡ä»¶éƒ½æ»¡è¶³æ‰åŒ¹é…ï¼ˆAND å…³ç³»ï¼‰</span>
  <span class="hljs-keyword">return</span> rule.<span class="hljs-property">paramConditions</span>.<span class="hljs-title function_">every</span>(<span class="hljs-function"><span class="hljs-params">condition</span> =&gt;</span>
    <span class="hljs-title function_">matchParamCondition</span>(condition, request)
  );
}
</code></pre>
<h3 data-id="heading-10">å‚æ•°å€¼è·å–</h3>
<p>æ ¹æ® <code>location</code> ä»ä¸åŒä½ç½®å–å€¼ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getParamValue</span>(<span class="hljs-params">location: <span class="hljs-built_in">string</span>, paramName: <span class="hljs-built_in">string</span>, request: RequestInfo</span>): <span class="hljs-built_in">any</span> {
  <span class="hljs-keyword">switch</span> (location) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'query'</span>:
      <span class="hljs-keyword">return</span> request.<span class="hljs-property">query</span>?.[paramName];
    <span class="hljs-keyword">case</span> <span class="hljs-string">'body'</span>:
      <span class="hljs-comment">// æ”¯æŒåµŒå¥—è·¯å¾„ï¼Œå¦‚ body.user.id</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">getNestedValue</span>(<span class="hljs-title function_">parseBody</span>(request.<span class="hljs-property">body</span>), paramName);
    <span class="hljs-keyword">case</span> <span class="hljs-string">'header'</span>:
      <span class="hljs-keyword">return</span> request.<span class="hljs-property">headers</span>?.[paramName];
    <span class="hljs-keyword">case</span> <span class="hljs-string">'cookie'</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">parseCookie</span>(request.<span class="hljs-property">headers</span>?.<span class="hljs-property">cookie</span>, paramName);
    <span class="hljs-keyword">case</span> <span class="hljs-string">'path'</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">extractPathParam</span>(request.<span class="hljs-property">url</span>, paramName);
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
  }
}
</code></pre>
<p>æ¯”è¾ƒæ—¶ä¼šåšç±»å‹å…¼å®¹å¤„ç†ï¼Œæ¯”å¦‚ <code>1</code> å’Œ <code>"1"</code> è§†ä¸ºç›¸ç­‰ï¼Œé¿å…å› ç±»å‹ä¸ä¸€è‡´å¯¼è‡´åŒ¹é…å¤±è´¥ã€‚</p>
<h3 data-id="heading-11">ä½¿ç”¨ç¤ºä¾‹</h3>






























<table><thead><tr><th>è¯·æ±‚å‚æ•°</th><th>è§„åˆ™é…ç½®</th><th>ç»“æœ</th></tr></thead><tbody><tr><td><code>?page=1</code></td><td><code>query.page equals 1</code></td><td>è¿”å›ç¬¬ä¸€é¡µæ•°æ®</td></tr><tr><td><code>?page=2</code></td><td><code>query.page equals 2</code></td><td>è¿”å›ç¬¬äºŒé¡µæ•°æ®</td></tr><tr><td><code>body: {"user":{"type":"vip"}}</code></td><td><code>body.user.type equals "vip"</code></td><td>è¿”å› VIP æ•°æ®</td></tr><tr><td><code>Header: X-Debug: true</code></td><td><code>header.X-Debug equals "true"</code></td><td>è¿”å›è°ƒè¯•æ•°æ®</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-12">æ ¸å¿ƒå®ç°ä¸‰ï¼šAI ç”Ÿæˆé«˜è´¨é‡æ•°æ®</h2>
<h3 data-id="heading-13">é—®é¢˜</h3>
<p>Mock.js ç”Ÿæˆçš„æ•°æ®ç¼ºä¹ä¸šåŠ¡è¯­ä¹‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Mock.js ç”Ÿæˆ</span>
{ <span class="hljs-attr">name</span>: <span class="hljs-string">"xxx"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">82</span>, <span class="hljs-attr">status</span>: <span class="hljs-number">3</span> }

<span class="hljs-comment">// æœŸæœ›çš„ä¸šåŠ¡æ•°æ®</span>
{ <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">28</span>, <span class="hljs-attr">status</span>: <span class="hljs-number">1</span> }  <span class="hljs-comment">// status: 0=å¾…å®¡æ ¸, 1=å·²é€šè¿‡, 2=å·²æ‹’ç»</span>
</code></pre>
<p>æˆ‘ä»¬å¸Œæœ›æ ¹æ®æ¥å£æ–‡æ¡£ä¸­çš„å­—æ®µæè¿°ã€æšä¸¾è¯´æ˜ã€å­—æ®µå‘½åæ¥ç”Ÿæˆç¬¦åˆä¸šåŠ¡è¯­ä¹‰çš„æ•°æ®, è¿™æ ·æ–‡æ¡£å¤‡æ³¨è¶Šè¯¦ç»† å­—æ®µåå®šä¹‰è¶Šæ¸…æ™° ç”Ÿæˆæ•°æ®ä¼šè¶Šå‡†ç¡®ã€‚</p>
<h3 data-id="heading-14">å®ç°æ€è·¯</h3>
<p>åç«¯æœåŠ¡ä» APIæ–‡æ¡£å¹³å° è·å–æ¥å£çš„ JSON Schemaï¼Œæ„å»º Prompt è°ƒç”¨ AI ç”Ÿæˆæ•°æ®ã€‚</p>
<p><strong>æ ¸å¿ƒ Prompt è®¾è®¡</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> systemPrompt = <span class="hljs-string">`
ä½ æ˜¯ Mock æ•°æ®ç”Ÿæˆä¸“å®¶ï¼Œæ ¹æ® JSON Schema ç”Ÿæˆç¬¦åˆä¸šåŠ¡åœºæ™¯çš„æ•°æ®ã€‚

ã€ç”Ÿæˆè§„åˆ™ - æŒ‰ä¼˜å…ˆçº§æ’åºã€‘
1. è‹¥ description ä¸­å­˜åœ¨æšä¸¾è¯´æ˜ï¼ˆå¦‚ "0:æˆåŠŸ, 1:å¤±è´¥"ï¼‰ï¼Œä¼˜å…ˆä½¿ç”¨æšä¸¾å€¼æœ¬èº«ï¼ˆå¦‚ 0ã€1ï¼‰
2. è‹¥æ—  descriptionï¼Œåˆ™æ ¹æ®å­—æ®µåçš„è¯­ä¹‰ç”Ÿæˆåˆç†å€¼
3. æ•°ç»„ç±»å‹é»˜è®¤ç”Ÿæˆ 5 æ¡æ•°æ®
4. è‹¥ description ä¸­æšä¸¾å€¼è¾ƒå¤šï¼Œæ•°ç»„åº”è¦†ç›–æ‰€æœ‰æšä¸¾å€¼

ã€é»˜è®¤å€¼è§„åˆ™ã€‘
- respCode / codeï¼šæˆåŠŸåœºæ™¯ä¸º 0ï¼Œå¤±è´¥åœºæ™¯ä¸º -1
- errorMsgï¼šæˆåŠŸåœºæ™¯ä¸º nullï¼Œå¤±è´¥åœºæ™¯ä¸º "ç³»ç»Ÿå¼‚å¸¸"
- å›¾ç‰‡ URLï¼šä½¿ç”¨ç»Ÿä¸€çš„å ä½å›¾åœ°å€
- æ™®é€š URLï¼šä½¿ç”¨ç»Ÿä¸€çš„åŸŸååœ°å€

ã€è¾“å‡ºæ ¼å¼ã€‘
ä»…è¾“å‡º JSONï¼Œä¸é™„åŠ ä»»ä½•è§£é‡Šæ–‡å­—
`</span>;
</code></pre>
<p><strong>å…³é”®è®¾è®¡ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>description ä¼˜å…ˆ</strong>ï¼šæ¥å£æ–‡æ¡£ä¸­ <code>status: 0=å¾…å®¡æ ¸, 1=å·²é€šè¿‡</code> è¿™ç±»æè¿°ä¼šè¢«ä¼˜å…ˆä½¿ç”¨</li>
<li><strong>å­—æ®µåè¯­ä¹‰</strong>ï¼š<code>userName</code> ç”Ÿæˆä¸­æ–‡å§“åï¼Œ<code>price</code> ç”Ÿæˆåˆç†ä»·æ ¼</li>
<li><strong>æšä¸¾è¦†ç›–</strong>ï¼šæ•°ç»„å­—æ®µä¼šå°½é‡è¦†ç›–æ‰€æœ‰æšä¸¾å€¼ï¼Œä¾¿äºæµ‹è¯•</li>
<li><strong>é»˜è®¤æˆåŠŸåœºæ™¯</strong>ï¼šé™¤éç”¨æˆ·æŒ‡å®šï¼Œå¦åˆ™ç”Ÿæˆæ­£å¸¸æ•°æ®</li>
</ol>
<h3 data-id="heading-15">æ•°æ®æ ¡éªŒ</h3>
<p>AI ç”Ÿæˆçš„ JSON å¯èƒ½æ ¼å¼æœ‰é—®é¢˜ï¼Œé€šè¿‡ <code>jsonrepair</code> éªŒè¯ä¿®å¤ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> jsonMatch = result.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/\{[\s\S]*\}/</span>);
<span class="hljs-keyword">if</span> (jsonMatch) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">jsonrepair</span>(jsonMatch[<span class="hljs-number">0</span>]);
}
</code></pre>
<p>ç”Ÿæˆåå¯¹æ¯” Schema å’Œå®é™…æ•°æ®ï¼Œå­—æ®µç¼ºå¤±æ—¶å‘é€å‘Šè­¦ã€‚</p>
<h3 data-id="heading-16">ç”Ÿæˆæ¨¡å¼</h3>
<ul>
<li><strong>æ•´ä½“ç”Ÿæˆ</strong>ï¼šæ ¹æ®å®Œæ•´ Schema ç”Ÿæˆæ‰€æœ‰å­—æ®µ</li>
<li><strong>é€‰åŒºç”Ÿæˆ</strong>ï¼šåªæ›¿æ¢é€‰ä¸­çš„å­—æ®µï¼Œä¿ç•™å…¶ä»–å­—æ®µä¸å˜</li>
<li><strong>è‡ªå®šä¹‰ Prompt</strong>ï¼šç”¨æˆ·å¯è¾“å…¥é¢å¤–è¦æ±‚ï¼Œå¦‚"ç”Ÿæˆ VIP ç”¨æˆ·æ•°æ®"ã€"ä»·æ ¼åœ¨ 100-500 ä¹‹é—´"ã€"ç”Ÿæˆ10æ¡æ•°æ®"ã€"ç”ŸæˆæŸä¸ªåœºæ™¯å€¼çš„æ•°æ®"ç­‰</li>
</ul>
<hr/>
<h2 data-id="heading-17">æ ¸å¿ƒå®ç°å››ï¼šä¸‰å±‚ä½œç”¨åŸŸ</h2>
<h3 data-id="heading-18">é—®é¢˜</h3>
<p>Mock æ•°æ®å­˜åœ¨æœ¬åœ°çš„é—®é¢˜ï¼š</p>
<ul>
<li>æ¢å°ç”µè„‘å°±æ²¡äº†</li>
<li>åŒäº‹æƒ³ç”¨åŒä¸€å¥—æ•°æ®ï¼Œåªèƒ½æ‰‹åŠ¨å¤åˆ¶</li>
<li>å›¢é˜Ÿæ ‡å‡†æµ‹è¯•æ•°æ®æ— æ³•ç»Ÿä¸€ç®¡ç†</li>
</ul>
<h3 data-id="heading-19">è®¾è®¡</h3>
<p>ä¸‰å±‚ä½œç”¨åŸŸè§£å†³ä¸åŒåœºæ™¯çš„éœ€æ±‚ï¼š</p>





























<table><thead><tr><th>ä½œç”¨åŸŸ</th><th>å­˜å‚¨ä½ç½®</th><th>å¯è§æ€§</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td>æœ¬åœ°è‰ç¨¿</td><td>IndexedDB</td><td>ä»…å½“å‰è®¾å¤‡</td><td>ä¸´æ—¶è°ƒè¯•</td></tr><tr><td>ä¸ªäººäº‘ç«¯</td><td>è¿œç¨‹æ•°æ®åº“</td><td>ä»…åˆ›å»ºè€…</td><td>è·¨è®¾å¤‡åŒæ­¥</td></tr><tr><td>å›¢é˜Ÿå…±äº«</td><td>è¿œç¨‹æ•°æ®åº“</td><td>æ‰€æœ‰å›¢é˜Ÿæˆå‘˜</td><td>æ ‡å‡†æµ‹è¯•æ•°æ®</td></tr></tbody></table>
<p><strong>å…³é”®è®¾è®¡</strong>ï¼š</p>
<ol>
<li><strong>ä¼˜å…ˆçº§å’Œå¯ç”¨çŠ¶æ€ä»…åœ¨æœ¬åœ°ç»´æŠ¤</strong>ï¼šé¿å…å›¢é˜Ÿæˆå‘˜äº’ç›¸å¹²æ‰°</li>
<li><strong>äº‘ç«¯åªå­˜æœŸæœ›å†…å®¹</strong>ï¼šæ¯ä¸ªäººç‹¬ç«‹æ§åˆ¶"å“ªäº›æœŸæœ›å¯ç”¨ã€ä¼˜å…ˆçº§å¦‚ä½•æ’åº"</li>
<li><strong>è§„åˆ™ç¼“å­˜</strong>ï¼šåŠ è½½åç¼“å­˜åœ¨ <code>window.__mockRulesCache</code>ï¼Œé¿å…é‡å¤è¯»å– IndexedDB</li>
</ol>
<h3 data-id="heading-20">æ•°æ®ç»“æ„</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">MockRule</span> {
  <span class="hljs-attr">type</span>: <span class="hljs-number">1</span> | <span class="hljs-number">2</span> | <span class="hljs-number">3</span>;  <span class="hljs-comment">// 1=æœ¬åœ°è‰ç¨¿ï¼Œ2=ä¸ªäººäº‘ç«¯ï¼Œ3=å›¢é˜Ÿå…±äº«</span>
  <span class="hljs-attr">enabled</span>: <span class="hljs-built_in">boolean</span>; <span class="hljs-comment">// æœ¬åœ°ç»´æŠ¤</span>
  <span class="hljs-attr">priority</span>: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// æœ¬åœ°ç»´æŠ¤</span>
  <span class="hljs-comment">// ... å…¶ä»–å­—æ®µ</span>
}
</code></pre>
<h3 data-id="heading-21">äº‹ä»¶é€šä¿¡</h3>
<p>SDK ä¸ UI é¢æ¿é€šè¿‡ CustomEvent é€šä¿¡ï¼š</p>

























<table><thead><tr><th>äº‹ä»¶å</th><th>æ–¹å‘</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>mock-request-end</code></td><td>SDK â†’ UI</td><td>è¯·æ±‚å®Œæˆä¸ŠæŠ¥</td></tr><tr><td><code>mock-interface-switch</code></td><td>UI â†’ SDK</td><td>å•æ¥å£å¼€å…³æ§åˆ¶</td></tr><tr><td><code>mock-rules-updated</code></td><td>UI â†’ SDK</td><td>è§„åˆ™æ›´æ–°é€šçŸ¥</td></tr></tbody></table>
<h3 data-id="heading-22">æ•°æ®æ¸…ç†</h3>
<p>è‡ªåŠ¨æ¸…ç† 30 å¤©æœªä½¿ç”¨çš„æœ¬åœ°æ•°æ®ï¼Œè‡ªåŠ¨æ¸…ç†éæ´»è·ƒçš„æ•°æ® é¿å…å­˜å‚¨è†¨èƒ€ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">await</span> <span class="hljs-title function_">cleanupInactiveData</span>(<span class="hljs-number">30</span>);
</code></pre>
<hr/>
<h2 data-id="heading-23">åŠ¨æ€æ¨¡æ¿è¯­æ³•</h2>
<p>æ”¯æŒåœ¨ Mock æ•°æ®ä¸­å¼•ç”¨è¯·æ±‚å‚æ•°ï¼Œå®ç°"å“åº”éšè¯·æ±‚å˜åŒ–"ï¼š</p>



































<table><thead><tr><th>è¯­æ³•</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>{{Date.now()}}</code></td><td>å½“å‰æ—¶é—´æˆ³</td><td><code>1706432400000</code></td></tr><tr><td><code>{{uuid()}}</code></td><td>ç”Ÿæˆ UUID</td><td><code>"a1b2c3d4-..."</code></td></tr><tr><td><code>{{request.query.xxx}}</code></td><td>è·å– URL å‚æ•°</td><td><code>{{request.query.page}}</code></td></tr><tr><td><code>{{request.body.xxx}}</code></td><td>è·å–è¯·æ±‚ä½“å­—æ®µ</td><td><code>{{request.body.userId}}</code></td></tr><tr><td><code>{{request.headers.xxx}}</code></td><td>è·å–è¯·æ±‚å¤´</td><td><code>{{request.headers.token}}</code></td></tr></tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"requestId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"{{uuid()}}"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"{{Date.now()}}"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"userId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"{{request.body.userId}}"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"page"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"{{request.query.page}}"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-24">å¿«é€Ÿå¼€å§‹</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 1. å®‰è£…</span>
npm install <span class="hljs-meta">@zz</span>-common/ai_mock

<span class="hljs-comment">// 2. åˆå§‹åŒ–</span>
<span class="hljs-keyword">import</span> { mockInit } <span class="hljs-keyword">from</span> <span class="hljs-string">'@zz-common/ai_mock'</span>

<span class="hljs-title function_">mockInit</span>({
  <span class="hljs-attr">rules</span>: [<span class="hljs-string">'api.example.com'</span>],      <span class="hljs-comment">// æ‹¦æˆªçš„åŸŸå</span>
  <span class="hljs-attr">excludeRules</span>: [<span class="hljs-regexp">/static/</span>, <span class="hljs-regexp">/cdn/</span>]  <span class="hljs-comment">// æ’é™¤çš„èµ„æº</span>
})
</code></pre>
<h2 data-id="heading-25">æ¨èå·¥ä½œæµ</h2>
<p>ä¸‹é¢æ¼”ç¤ºä»è¯·æ±‚é‡‡é›†åˆ° AI ç”Ÿæˆ Mock æ•°æ®çš„å®Œæ•´æµç¨‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/412918b4575440488ee46ab82d54fb31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L2s6L2s5oqA5pyv5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863944&amp;x-signature=%2BY5Ha6UIl1%2Bn86hwo0z%2B0DpXwjY%3D" alt="24182e81-01bc-11f1-83a0-e2f0e015208e.gif" loading="lazy"/></p>
<ol>
<li><strong>æ¥å…¥ npm åŒ…</strong>ï¼šåœ¨éç”Ÿäº§ç¯å¢ƒå¯ç”¨æ‹¦æˆª</li>
<li><strong>ä»çœŸå®è¯·æ±‚åˆ›å»º Mock</strong>ï¼šæ‰“å¼€é¢æ¿ï¼Œç‚¹å‡»è¯·æ±‚æ—¥å¿—çš„"åˆ›å»ºæœŸæœ›"</li>
<li><strong>é…ç½®å‚æ•°æ¡ä»¶</strong>ï¼šåŒä¸€æ¥å£ä¸åŒå‚æ•°è¿”å›ä¸åŒæ•°æ®</li>
<li><strong>AI ç”Ÿæˆè¡¥å……</strong>ï¼šç”¨ AI ç”Ÿæˆç¬¦åˆä¸šåŠ¡è¯­ä¹‰çš„æ•°æ®</li>
<li><strong>å›¢é˜Ÿå…±äº«</strong>ï¼šå°†ç¨³å®šçš„æµ‹è¯•æ•°æ®æ¨é€åˆ°å›¢é˜Ÿå…±äº«</li>
</ol>
<hr/>
<h2 data-id="heading-26">æ€»ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»çš„ Mock å·¥å…·è§£å†³äº†å››ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š</p>

























<table><thead><tr><th>é—®é¢˜</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>è¯·æ±‚æ‹¦æˆª</td><td>Monkey Patch é‡å†™ XHR/Fetchï¼Œé€šè¿‡ WeakMap é˜²é€’å½’</td></tr><tr><td>è§„åˆ™åŒ¹é…</td><td>æ”¯æŒ 5 ç§å‚æ•°ä½ç½® Ã— 8 ç§æ“ä½œç¬¦ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åº</td></tr><tr><td>æ•°æ®è´¨é‡</td><td>AI æ ¹æ®æ¥å£æ–‡æ¡£çš„ descriptionã€å­—æ®µåè¯­ä¹‰ç”Ÿæˆæ•°æ®</td></tr><tr><td>å›¢é˜Ÿå…±äº«</td><td>ä¸‰å±‚ä½œç”¨åŸŸï¼Œæœ¬åœ°ç»´æŠ¤å¯ç”¨çŠ¶æ€å’Œä¼˜å…ˆçº§</td></tr></tbody></table>
<p>ç›®å‰è¿™å¥—å·¥å…·å·²åœ¨å…¬å¸å†…éƒ¨ä½¿ç”¨ï¼Œå¯ä»¥å‡å°‘è”è°ƒé˜»å¡ã€æé«˜åœºæ™¯è¦†ç›–ç‡ã€‚</p>
<h2 data-id="heading-27">æœªæ¥è§„åˆ’</h2>
<ul>
<li><strong>æµé‡å½•åˆ¶å›æ”¾</strong>ï¼šåŸºäºçœŸå®æµé‡ç”Ÿæˆ Mock æ•°æ®ï¼Œæ•°æ®æ›´è´´è¿‘çº¿ä¸Šåœºæ™¯</li>
<li><strong>AIç”Ÿæˆæ•°æ®æ—¶åŸºäºçœŸå®æ•°æ®</strong>ï¼šè¿›ä¸€æ­¥æå‡AIç”Ÿæˆæ•°æ®è´¨é‡ è´´è¿‘çœŸå®ä¸šåŠ¡åœºæ™¯</li>
<li><strong>ç§»åŠ¨ç«¯æ”¯æŒ</strong>ï¼šçœŸæœºç¯å¢ƒä¸‹é…åˆ PC ç«¯ä½¿ç”¨ Mock æ•°æ®éªŒè¯</li>
<li><strong>è§„åˆ™æ¨è</strong>ï¼šåŸºäºå†å²è¯·æ±‚ï¼Œè‡ªåŠ¨æ¨èå¯èƒ½éœ€è¦çš„ Mock åœºæ™¯</li>
</ul>
<blockquote>
<p>è½¬è½¬ç ”å‘ä¸­å¿ƒåŠä¸šç•Œå°ä¼™ä¼´ä»¬çš„æŠ€æœ¯å­¦ä¹ äº¤æµå¹³å°ï¼Œå®šæœŸåˆ†äº«ä¸€çº¿çš„å®æˆ˜ç»éªŒåŠä¸šç•Œå‰æ²¿çš„æŠ€æœ¯è¯é¢˜ã€‚ å…³æ³¨å…¬ä¼—å·ã€Œè½¬è½¬æŠ€æœ¯ã€ï¼ˆç»¼åˆæ€§ï¼‰ã€ã€Œå¤§è½¬è½¬FEã€ï¼ˆä¸“æ³¨äºFEï¼‰ã€ã€Œè½¬è½¬QAã€ï¼ˆä¸“æ³¨äºQAï¼‰ï¼Œæ›´å¤šå¹²è´§å®è·µï¼Œæ¬¢è¿äº¤æµåˆ†äº«~</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº Starlight æ–‡æ¡£ç«™ç‚¹æ¥å…¥ Microsoft Clarity çš„å®Œæ•´å®è·µæŒ‡å—]]></title>    <link>https://juejin.cn/post/7602910573404831782</link>    <guid>https://juejin.cn/post/7602910573404831782</guid>    <pubDate>2026-02-05T01:14:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602910573404831782" data-draft-id="7602901565025599497" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº Starlight æ–‡æ¡£ç«™ç‚¹æ¥å…¥ Microsoft Clarity çš„å®Œæ•´å®è·µæŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T01:14:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="newbe36524"/> <meta itemprop="url" content="https://juejin.cn/user/2682464104098654"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº Starlight æ–‡æ¡£ç«™ç‚¹æ¥å…¥ Microsoft Clarity çš„å®Œæ•´å®è·µæŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2682464104098654/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    newbe36524
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:14:26.000Z" title="Thu Feb 05 2026 01:14:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»æ•°æ®æ´å¯Ÿåˆ°ç”¨æˆ·å¢é•¿ï¼šHagiCode åšå®¢æ¥å…¥ Clarity Analytics çš„å®Œæ•´æŒ‡å—</h2>
<blockquote>
<p>æœ¬æ–‡å°†åˆ†äº«å¦‚ä½•åœ¨ Starlight æ–‡æ¡£ç«™ç‚¹ä¸­ä¼˜é›…åœ°æ¥å…¥ Microsoft Clarityï¼Œä¸ä»…èƒ½çœ‹æ¸…ç”¨æˆ·è¡Œä¸ºï¼Œè¿˜èƒ½ç¡®ä¿éšç§åˆè§„ã€‚è¿™å¥—æ–¹æ¡ˆæ˜¯æˆ‘ä»¬åœ¨ HagiCode é¡¹ç›®ä¸­å®è·µæ€»ç»“å‡ºæ¥çš„ï¼Œå¸Œæœ›èƒ½ç»™åŒæ ·åœ¨æŠ˜è…¾æ•°æ®ç»Ÿè®¡çš„ä½ ä¸€ç‚¹å‚è€ƒã€‚</p>
</blockquote>

<h3 data-id="heading-1">èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ Clarityï¼Ÿ</h3>
<p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•åœ¨ Astro é›†æˆä¸­æ ¹æ®ç¯å¢ƒå˜é‡åŠ¨æ€æ³¨å…¥ Microsoft Clarity è„šæœ¬ï¼Œä»…åœ¨ç”Ÿæ•ˆæ—¶è¿›è¡Œç”Ÿäº§ç¯å¢ƒåŠ è½½ã€‚</p>

<pre><code class="hljs language-markdown" lang="markdown">105 | interface Props {
106 |   // æœªæ¥å¯æ‰©å±•: å…è®¸æ‰‹åŠ¨è¦†ç›– Project ID
107 |   projectId?: string;
108 | }
109 | 
110 | const {
111 |   projectId = import.meta.env.CLARITY<span class="hljs-emphasis">_PROJECT_</span>ID,
112 | } = Astro.props;
113 | 
114 | const isProduction = import.meta.env.PROD;
115 | ---
116 | 
117 | {isProduction &amp;&amp; projectId &amp;&amp; (
118 |   <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">is:inline</span> <span class="hljs-attr">define:vars</span>=<span class="hljs-string">{{projectId}}</span>&gt;</span></span>
119 |     (function(c,l,a,r,i,t,y){
</code></pre>
<p><em>æ–‡ä»¶ï¼š<code>openspec/changes/archive/2026-01-30-microsoft-clarity-integration/design.md</code></em></p>
<p>åœ¨è¿è¥ <strong>HagiCode</strong> çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´é¢ä¸´ä¸€ä¸ª"ç›²ç›’"é—®é¢˜ï¼šæˆ‘ä»¬äº§å‡ºå†…å®¹ï¼Œä½†ä¸æ¸…æ¥šç”¨æˆ·æ˜¯å¦‚ä½•é˜…è¯»çš„ã€‚è™½ç„¶ GitHub èƒ½çœ‹åˆ° Star æ•°ï¼Œä½†è¿™å¤ªæ»åäº†ã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“ï¼š</p>
<ul>
<li>ç”¨æˆ·åˆ°åº•æœ‰æ²¡æœ‰çœ‹å®Œæˆ‘ä»¬çš„æ•™ç¨‹ï¼Ÿ</li>
<li>é‚£äº›å¤æ‚çš„é…ç½®æ–‡æ¡£ï¼Œæ˜¯åœ¨å“ªä¸€æ­¥åŠé€€äº†ç”¨æˆ·çš„ï¼Ÿ</li>
<li>æˆ‘ä»¬çš„ SEO ä¼˜åŒ–æ˜¯å¦çœŸçš„å¸¦æ¥äº†æœ‰æ•ˆæµé‡ï¼Ÿ</li>
</ul>
<p>å¸‚é¢ä¸Šæœ‰å¾ˆå¤šåˆ†æå·¥å…·ï¼Œæ¯”å¦‚ Google Analyticsï¼ˆGAï¼‰å’Œ Microsoft Clarityã€‚GA åŠŸèƒ½å¼ºå¤§ä½†é…ç½®å¤æ‚ï¼Œä¸”å—åˆ°éšç§æ³•è§„ï¼ˆå¦‚ GDPRï¼‰çš„ä¸¥æ ¼é™åˆ¶ã€‚è€Œ Clarity ä½œä¸ºå¾®è½¯æ¨å‡ºçš„å…è´¹çƒ­åŠ›å›¾å·¥å…·ï¼Œä¸ä»…åŠŸèƒ½ç›´è§‚ï¼Œè€Œä¸”åœ¨éšç§åˆè§„ä¸Šç›¸å¯¹å®½æ¾ï¼Œéå¸¸é€‚åˆæŠ€æœ¯æ–‡æ¡£ç«™ç‚¹ã€‚</p>
<p><strong>æˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ˜ç¡®</strong>ï¼šåœ¨ <strong>HagiCode</strong> çš„æ–‡æ¡£ç«™ç‚¹ä¸­æ— ç¼é›†æˆ Clarityï¼Œæ—¢è¦åœ¨æ‰€æœ‰é¡µé¢ç”Ÿæ•ˆï¼Œåˆè¦ç»™ç”¨æˆ·ç•™æœ‰"é€€å‡º"çš„æƒåˆ©ï¼ˆéšç§åˆè§„ï¼‰ã€‚</p>
<h3 data-id="heading-2">å…³äº HagiCode</h3>
<p>HagiCode ä¸»é¢˜åˆå§‹åŒ–é€»è¾‘ï¼šä¼˜å…ˆè¯»å–æœ¬åœ°å­˜å‚¨ï¼Œå›é€€è‡³ç³»ç»Ÿåå¥½ï¼Œé»˜è®¤æš—è‰²ã€‚</p>

<pre><code class="hljs language-markdown" lang="markdown">67 | function getInitialTheme(): Theme {
68 |   // 1. æ£€æŸ¥ localStorage
69 |   const stored = localStorage.getItem('hagicode-theme');
70 |   if (stored) return stored as Theme;
71 | 
72 |   // 2. æ£€æµ‹ç³»ç»Ÿåå¥½
73 |   const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
74 |   if (systemDark) return 'dark';
75 | 
76 |   // 3. é»˜è®¤æš—è‰²
77 |   return 'dark';
78 | }
79 | <span class="hljs-code">```
80 | 
81 | ### å†³ç­– 3ï¼šä¸»é¢˜åº”ç”¨æ–¹å¼
82 | 
83 | **é€‰æ‹©**ï¼šåœ¨ `&lt;html&gt;` æ ¹å…ƒç´ è®¾ç½® `data-theme` å±æ€§
84 | 
85 | **å¯¹æ¯”æ–¹æ¡ˆ**ï¼š
86 | 
</span></code></pre>
<p><em>æ–‡ä»¶ï¼š<code>openspec/changes/archive/2026-01-29-theme-toggle-implementation/design.md</code></em></p>
<p>æœ¬æ–‡åˆ†äº«çš„æ–¹æ¡ˆæ¥è‡ªæˆ‘ä»¬åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FHagiCode-org%2Fsite" target="_blank" title="https://github.com/HagiCode-org/site" ref="nofollow noopener noreferrer">HagiCode</a> é¡¹ç›®ä¸­çš„å®è·µç»éªŒã€‚HagiCode æ˜¯ä¸€ä¸ªåŸºäº AI çš„ä»£ç è¾…åŠ©å·¥å…·ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç»´æŠ¤å¤§é‡çš„æŠ€æœ¯æ–‡æ¡£å’Œåšå®¢ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£ç”¨æˆ·éœ€æ±‚ï¼Œæˆ‘ä»¬æ¢ç´¢å¹¶å®æ–½äº†è¿™å¥—æ•°æ®æ¥å…¥æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-3">æŠ€æœ¯é€‰å‹ä¸æ¢ç´¢</h3>
<p>èµ·åˆï¼Œæˆ‘ä»¬åœ¨ Proposal é˜¶æ®µè®¨è®ºäº†å¤šç§é›†æˆæ–¹å¼ã€‚æ—¢ç„¶æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Starlightï¼ˆåŸºäº Astro çš„æ–‡æ¡£æ¡†æ¶ï¼‰ï¼Œæœ€ç›´è§‚çš„æƒ³æ³•æ˜¯åˆ©ç”¨ Astro çš„ Hooksã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆå°è¯•äº†ä¿®æ”¹ <code>astro.config.mjs</code>ï¼Œè®¡åˆ’åœ¨æ„å»ºæ—¶æ³¨å…¥ Clarity è„šæœ¬ã€‚è™½ç„¶è¿™ç§æ–¹å¼èƒ½ä¿è¯å…¨å±€è¦†ç›–ï¼Œä½†ç¼ºä¹çµæ´»æ€§â€”â€”æˆ‘ä»¬æ— æ³•æ ¹æ®ç”¨æˆ·çš„åå¥½åŠ¨æ€åŠ è½½æˆ–å¸è½½è„šæœ¬ã€‚</p>
<p>è€ƒè™‘åˆ°ç”¨æˆ·ä½“éªŒå’Œéšç§æ§åˆ¶ï¼Œæˆ‘ä»¬æœ€ç»ˆå†³å®šé‡‡ç”¨ <strong>ç»„ä»¶è¦†ç›–</strong> çš„æ–¹æ¡ˆã€‚Starlight å…è®¸å¼€å‘è€…è¦†ç›–å…¶å†…éƒ¨ç»„ä»¶ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ¥ç®¡ <code>&lt;footer&gt;</code> æˆ– <code>&lt;head&gt;</code> çš„æ¸²æŸ“é€»è¾‘ï¼Œä»è€Œç²¾ç»†æ§åˆ¶ Clarity çš„åŠ è½½æ—¶æœºã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå°æ’æ›²ï¼šåŸæœ¬æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªåä¸º <code>StarlightWrapper.astro</code> çš„å¸ƒå±€åŒ…è£…å™¨ã€‚ä½†åœ¨å®é™…è°ƒè¯•ä¸­å‘ç°ï¼ŒStarlight çš„è·¯ç”±æœºåˆ¶å¹¶ä¸ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªè‡ªå®šä¹‰ Wrapperï¼Œè¿™å¯¼è‡´è„šæœ¬åœ¨éƒ¨åˆ†é¡µé¢å¤±æ•ˆã€‚è¿™ç®—æ˜¯ä¸€ä¸ªå…¸å‹çš„"æƒ³å½“ç„¶"è¸©å‘ç»å†ï¼Œæé†’æˆ‘ä»¬<strong>å¿…é¡»æ·±å…¥ç†è§£æ¡†æ¶çš„æ¸²æŸ“æµç¨‹ï¼Œè€Œä¸æ˜¯ç›²ç›®å¥—ç”¨é€šç”¨æ¡†æ¶æ¨¡å¼</strong>ã€‚</p>
<h3 data-id="heading-4">æ ¸å¿ƒæ–¹æ¡ˆï¼šFooter ç»„ä»¶è¦†ç›–</h3>
<p>ä¸ºäº†ç¡®ä¿ Clarity è„šæœ¬åœ¨æ‰€æœ‰é¡µé¢ï¼ˆåŒ…æ‹¬æ–‡æ¡£å’Œåšå®¢ï¼‰åŠ è½½ï¼Œå¹¶ä¸”ä¸ç ´ååŸæœ‰çš„é¡µé¢ç»“æ„ï¼Œæˆ‘ä»¬é€‰æ‹©äº†è¦†ç›– Starlight çš„ <code>Footer</code> ç»„ä»¶ã€‚</p>
<h4 data-id="heading-5">ä¸ºä»€ä¹ˆæ˜¯ Footerï¼Ÿ</h4>
<ol>
<li><strong>å…¨å±€æ€§</strong>ï¼šFooter å‡ ä¹åœ¨æ‰€æœ‰æ ‡å‡†é¡µé¢éƒ½ä¼šå‡ºç°ã€‚</li>
<li><strong>éä¾µå…¥æ€§</strong>ï¼šå°†è„šæœ¬æ”¾åœ¨ Footer åŒºåŸŸï¼ˆå®é™…æ¸²æŸ“åœ¨ body åº•éƒ¨ï¼‰ä¸ä¼šé˜»å¡é¡µé¢çš„å…³é”®æ¸²æŸ“è·¯å¾„ï¼ˆLCPï¼‰ï¼Œå¯¹æ€§èƒ½å½±å“æœ€å°ã€‚</li>
<li><strong>é€»è¾‘é›†ä¸­</strong>ï¼šå¯ä»¥åœ¨ç»„ä»¶å†…éƒ¨ç»Ÿä¸€å¤„ç† Cookie åŒæ„é€»è¾‘ã€‚</li>
</ol>
<h4 data-id="heading-6">å®æ–½æ­¥éª¤</h4>
<h5 data-id="heading-7">1. å‡†å¤‡ Clarity é¡¹ç›®</h5>
<p>é¦–å…ˆï¼Œä½ éœ€è¦åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fclarity.microsoft.com%2F" target="_blank" title="https://clarity.microsoft.com/" ref="nofollow noopener noreferrer">Microsoft Clarity</a> æ³¨å†Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ã€‚è·å–ä½ çš„ Project IDï¼ˆç±»ä¼¼ <code>k8z2ab3xxx</code> è¿™æ ·çš„å­—ç¬¦ä¸²ï¼‰ã€‚</p>
<h5 data-id="heading-8">2. ç¯å¢ƒå˜é‡é…ç½®</h5>
<p>ä¸‹é¢é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ä¸æ—¥æœŸåˆ¤æ–­ä»£ç ï¼Œå®ç°æ–°å¹´æœŸé—´çš„é€»è¾‘æ§åˆ¶ï¼Œè¯·å‚è€ƒå…·ä½“å®ç°ã€‚</p>

<pre><code class="hljs language-text" lang="text">46 |         function isLunarNewYearPeriod() {
47 |           const now = new Date();
48 |           const year = now.getFullYear();
49 |           const month = now.getMonth() + 1; // 1-12
50 |           const day = now.getDate();
51 | 
52 |           // 2025å¹´è›‡å¹´æ–°å¹´æœŸé—´ (1æœˆ29æ—¥ - 2æœˆ12æ—¥)
53 |           if (year === 2025) {
54 |             if (month === 1 &amp;&amp; day &gt;= 29) return true;
55 |             if (month === 2 &amp;&amp; day &lt;= 12) return true;
56 |           }
57 |           // 2026å¹´é©¬å¹´æ–°å¹´æœŸé—´ (2æœˆ17æ—¥ - 3æœˆ3æ—¥)
58 |           if (year === 2026) {
59 |             if (month === 2 &amp;&amp; day &gt;= 17) return true;
60 |             if (month === 3 &amp;&amp; day &lt;= 3) return true;
61 |           }
62 |           return false;
63 |         }
64 | 
65 |         const stored = localStorage.getItem('starlight-theme');
</code></pre>
<p><em>æ–‡ä»¶ï¼š<code>src/pages/index.astro</code></em></p>
<p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œä¸è¦ç¡¬ç¼–ç  IDã€‚å»ºè®®å°† ID å­˜å…¥ç¯å¢ƒå˜é‡ã€‚</p>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>.env</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Microsoft Clarity ID</span>
PUBLIC_CLARITY_ID=<span class="hljs-string">"ä½ çš„_Clarity_ID"</span>
</code></pre>
<h5 data-id="heading-9">3. åˆ›å»ºè¦†ç›–ç»„ä»¶</h5>
<p>ä»¥ä¸‹æ˜¯ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–çš„å®ç°ä»£ç ï¼Œå±•ç¤ºäº†å¦‚ä½•ä»…åœ¨æœªæ‰‹åŠ¨è®¾ç½®æ—¶è·Ÿéšç³»ç»Ÿåˆ‡æ¢ä¸»é¢˜ã€‚</p>

<pre><code class="hljs language-markdown" lang="markdown">445 |     const handleChange = (e: MediaQueryListEvent) =&gt; {
446 |       // ä»…åœ¨ç”¨æˆ·æœªæ‰‹åŠ¨è®¾ç½®æ—¶è·Ÿéšç³»ç»Ÿ
447 |       if (!localStorage.getItem(THEME<span class="hljs-emphasis">_KEY)) {
448 |         setThemeState(e.matches ? 'dark' : 'light');
449 |       }
450 |     };
451 | 
452 |     mediaQuery.addEventListener('change', handleChange);
453 |     return () =&gt; mediaQuery.removeEventListener('change', handleChange);
454 |   }, []);
455 | 
456 |   return { theme, toggleTheme, setTheme: manuallySetTheme };
457 | }
458 | ```
459 | 
460 | #### 3. `src/components/ThemeButton.tsx` - æŒ‰é’®ç»„ä»¶
461 | 
462 | <span class="hljs-strong">**èŒè´£**</span>ï¼šæ¸²æŸ“ä¸»é¢˜åˆ‡æ¢æŒ‰é’®ï¼Œå¤„ç†ç”¨æˆ·äº¤äº’
463 | 
464 | <span class="hljs-strong">**ç»„ä»¶æ¥å£**</span>ï¼š
</span></code></pre>
<p><em>æ–‡ä»¶ï¼š<code>openspec/changes/archive/2026-01-29-theme-toggle-implementation/design.md</code></em></p>
<p>åœ¨ <code>src/components/</code> ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶ <code>StarlightFooter.astro</code>ã€‚Starlight ä¼šè‡ªåŠ¨è¯†åˆ«è¿™ä¸ªæ–‡ä»¶å¹¶è¦†ç›–é»˜è®¤çš„ Footerã€‚</p>
<p>æ ¸å¿ƒä»£ç é€»è¾‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-astro" lang="astro">---
// src/components/StarlightFooter.astro
// 1. å¼•å…¥åŸå§‹ç»„ä»¶ä»¥ä¿ç•™å…¶é»˜è®¤åŠŸèƒ½
import DefaultFooter from '@astrojs/starlight/components/StarlightFooter.astro';

// 2. è·å–ç¯å¢ƒå˜é‡
const clarityId = import.meta.env.PUBLIC_CLARITY_ID;

// 3. å®šä¹‰ç®€å•çš„æ³¨å…¥è„šæœ¬ï¼ˆå†…è”æ–¹å¼ï¼‰
// æ³¨æ„ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®å°†æ­¤é€»è¾‘æŠ½ç¦»åˆ°å•ç‹¬çš„ .js æ–‡ä»¶ä¸­ä»¥åˆ©ç”¨ç¼“å­˜
const initScript = `
(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "${clarityId}");
`;
---

&lt;DefaultFooter {...Astro.props} /&gt;

{/* ä»…åœ¨ç”Ÿäº§ç¯å¢ƒä¸” ID å­˜åœ¨æ—¶æ³¨å…¥è„šæœ¬ */}
{import.meta.env.PROD &amp;&amp; clarityId &amp;&amp; (
  &lt;script is:inline define:vars={{ clarityId }}&gt;
    {initScript}
  &lt;/script&gt;
)}
</code></pre>
<p><strong>å…³é”®ç‚¹è§£æ</strong>ï¼š</p>
<ul>
<li><code>is:inline</code>ï¼šå‘Šè¯‰ Astro ä¸è¦å¤„ç†è¿™ä¸ª script æ ‡ç­¾å†…çš„å†…å®¹ï¼Œç›´æ¥è¾“å‡ºåˆ° HTMLã€‚è¿™å¯¹ç¬¬ä¸‰æ–¹ç»Ÿè®¡è„šæœ¬è‡³å…³é‡è¦ï¼Œå¦åˆ™ Astro çš„æ‰“åŒ…ä¼˜åŒ–å¯èƒ½ä¼šå¯¼è‡´è„šæœ¬å¤±æ•ˆã€‚</li>
<li><code>define:vars</code>ï¼šè¿™æ˜¯ Astro 3+ çš„ç‰¹æ€§ï¼Œå…è®¸åœ¨ä½œç”¨åŸŸå†…å®‰å…¨åœ°æ³¨å…¥å˜é‡ã€‚</li>
<li><code>import.meta.env.PROD</code>ï¼šç¡®ä¿åœ¨æœ¬åœ°å¼€å‘æ—¶ï¼ˆé™¤éä¸ºäº†è°ƒè¯•ï¼‰ä¸äº§ç”Ÿæ— æ•ˆç»Ÿè®¡ï¼Œä¿æŒæ•°æ®çº¯å‡€ã€‚</li>
</ul>
<h4 data-id="heading-10">è¿›é˜¶ï¼šéšç§åˆè§„ä¸ Cookie æ§åˆ¶</h4>
<p>ä»…ä»…åŠ ä¸Šä»£ç æ˜¯ä¸å¤Ÿçš„ï¼Œç‰¹åˆ«æ˜¯åœ¨ GDPR ç®¡è¾–åŒºåŸŸã€‚æˆ‘ä»¬éœ€è¦å°Šé‡ç”¨æˆ·çš„é€‰æ‹©ã€‚</p>
<p>HagiCode çš„åšæ³•æ˜¯æä¾›ä¸€ä¸ªç®€å•çš„å¼€å…³ã€‚è™½ç„¶è¿™ä¸æ˜¯å…¨åŠŸèƒ½çš„ Cookie Bannerï¼Œä½†å¯¹äºçº¯å±•ç¤ºçš„æŠ€æœ¯æ–‡æ¡£ç«™ç‚¹æ¥è¯´ï¼Œé€šå¸¸å±äº"å¿…è¦"æˆ–"ç»Ÿè®¡"ç±» Cookieï¼Œå¯ä»¥é€šè¿‡éšç§å£°æ˜å‘ŠçŸ¥å¹¶é»˜è®¤å¼€å¯ï¼Œæˆ–è€…åœ¨ Footer é“¾æ¥åˆ°éšç§è®¾ç½®é¡µé¢ã€‚</p>
<p>å¦‚æœéœ€è¦æ›´ä¸¥è°¨çš„æ§åˆ¶ï¼Œä½ å¯ä»¥ç»“åˆ <code>localStorage</code> æ¥è®°å½•ç”¨æˆ·çš„é€‰æ‹©ï¼š</p>
<p>æœ¬æ–‡å°†ä»‹ç»ç”¨äºä¸»é¢˜åˆ‡æ¢ä¸æŒä¹…åŒ–çš„ TypeScript å·¥å…·å‡½æ•°ï¼Œé€šè¿‡ç±»å‹å®‰å…¨ä¸ç¯å¢ƒæ£€æµ‹å®ç°ä¸¥è°¨æ§åˆ¶ã€‚</p>

<pre><code class="hljs language-markdown" lang="markdown">367 | export function getInitialTheme(): Theme;
368 | export function getSystemTheme(): Theme;
369 | export function setTheme(theme: Theme): void;
370 | export function applyTheme(theme: Theme): void;
371 | <span class="hljs-code">```
372 | 
373 | **è®¾è®¡åŸåˆ™**ï¼š
374 | - **çº¯å‡½æ•°**ï¼šæ— å‰¯ä½œç”¨ï¼ˆé™¤äº† `setTheme` å’Œ `applyTheme`ï¼‰
375 | - **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript ç±»å‹æ¨å¯¼
376 | - **ç¯å¢ƒæ£€æµ‹**ï¼šSSR å®‰å…¨ï¼ˆ`typeof window` æ£€æŸ¥ï¼‰
377 | - **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹
378 | 
379 | **å…³é”®å®ç°**ï¼š
380 | ```</span>typescript
381 | export function getInitialTheme(): Theme {
382 |   if (typeof window === 'undefined') return 'dark';
383 | 
384 |   const stored = localStorage.getItem(THEME<span class="hljs-emphasis">_KEY);
385 |   if (stored === 'light' || stored === 'dark') return stored;
386 | 
</span></code></pre>
<p><em>æ–‡ä»¶ï¼š<code>openspec/changes/archive/2026-01-29-theme-toggle-implementation/design.md</code></em></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç®€å•ç¤ºä¾‹ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ‹’ç»ç»Ÿè®¡</span>
<span class="hljs-keyword">const</span> consent = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'clarity_consent'</span>);
<span class="hljs-keyword">if</span> (consent !== <span class="hljs-string">'denied'</span>) {
    <span class="hljs-comment">// æ‰§è¡Œä¸Šé¢çš„ Clarity åˆå§‹åŒ–ä»£ç </span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">clarity</span>(<span class="hljs-string">'start'</span>, clarityId);
}
</code></pre>
<h3 data-id="heading-11">ç»éªŒæ€»ç»“ä¸å‘ç‚¹</h3>
<p>åœ¨å°†è¿™å¥—æ–¹æ¡ˆè½åœ°åˆ° HagiCode çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ€»ç»“äº†å‡ ä¸ªå®¹æ˜“è¢«å¿½è§†çš„ç»†èŠ‚ï¼š</p>
<ol>
<li>
<p><strong><code>StarlightWrapper.astro</code> æ˜¯ä¸ªé™·é˜±</strong>ï¼š
å¦‚å‰æ‰€è¿°ï¼Œä¸è¦è¯•å›¾å»åˆ›å»ºä¸€ä¸ªå…¨å±€ Wrapper æ¥æ³¨å…¥è„šæœ¬ï¼Œè¿™åœ¨ Starlight ä¸­è¡Œä¸é€šã€‚è€è€å®å®è¦†ç›–ç‰¹å®šç»„ä»¶ï¼ˆå¦‚ <code>StarlightFooter.astro</code> æˆ– <code>StarlightHead.astro</code>ï¼‰æ‰æ˜¯æ­£è§£ã€‚</p>
</li>
<li>
<p><strong>è„šæœ¬ä½ç½®çš„æ€§èƒ½è€ƒé‡</strong>ï¼š
è™½ç„¶ Clarity å»ºè®®æ”¾åœ¨ <code>&lt;head&gt;</code> ä¸­ä»¥ç¡®ä¿æ•°æ®å‡†ç¡®æ€§ï¼Œä½†å¯¹äºæ–‡æ¡£ç«™ç‚¹ï¼Œé¦–å±åŠ è½½é€Ÿåº¦ï¼ˆLCPï¼‰ç›´æ¥å½±å“äº† SEO å’Œç”¨æˆ·ç•™å­˜ã€‚æˆ‘ä»¬é€‰æ‹©äº†æ”¾åœ¨ Footerï¼ˆBody åº•éƒ¨ï¼‰ï¼Œè¿™ä¼šè½»å¾®ä¸¢å¤±æå°‘é‡"ç§’é€€"ç”¨æˆ·çš„æ•°æ®ï¼Œä½†æ¢æ¥äº†æ›´å¿«çš„é¡µé¢åŠ è½½ä½“éªŒï¼Œè¿™æ˜¯ä¸€ä¸ªå€¼å¾—çš„æƒè¡¡ã€‚</p>
</li>
<li>
<p><strong>å¼€å‘ç¯å¢ƒçš„å¹²æ‰°</strong>ï¼š
ä¸€å®šè¦åŠ ä¸Š <code>import.meta.env.PROD</code> åˆ¤æ–­ã€‚åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œä½ ä¼šé¢‘ç¹åˆ·æ–°é¡µé¢ï¼Œè¿™ä¼šäº§ç”Ÿå¤§é‡æ— æ„ä¹‰çš„æµ‹è¯•æ•°æ®ï¼Œæ±¡æŸ“ä½ çš„ Clarity ä»ªè¡¨ç›˜ã€‚</p>
</li>
</ol>
<h3 data-id="heading-12">æ•ˆæœéªŒè¯</h3>
<p>éƒ¨ç½²å®Œæˆåï¼Œä½ å¯ä»¥åœ¨ Clarity æ§åˆ¶å°æŸ¥çœ‹å®æ—¶æ•°æ®ã€‚é€šå¸¸åœ¨å‡ åˆ†é’Ÿå†…ï¼Œä½ å°±èƒ½çœ‹åˆ°ç”¨æˆ·çš„heatmapï¼ˆçƒ­åŠ›å›¾ï¼‰å’Œ recordingsï¼ˆå½•å±ï¼‰ã€‚</p>
<p>å¯¹äº HagiCode æ¥è¯´ï¼Œé€šè¿‡è¿™äº›æ•°æ®æˆ‘ä»¬å‘ç°ï¼š</p>
<ul>
<li>å¾ˆå¤šç”¨æˆ·ä¼šåå¤æŸ¥çœ‹"å¿«é€Ÿå¼€å§‹"ç« èŠ‚ï¼Œè¯´æ˜æˆ‘ä»¬çš„å®‰è£…æŒ‡å¼•å¯èƒ½è¿˜ä¸å¤Ÿç›´è§‚ã€‚</li>
<li>"API å‚è€ƒ"é¡µé¢çš„åœç•™æ—¶é—´æœ€é•¿ï¼Œè¯å®äº†æˆ‘ä»¬æ ¸å¿ƒç”¨æˆ·ç¾¤ä½“çš„éœ€æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p>æ¥å…¥ Microsoft Clarity å¹¶ä¸éœ€è¦å¤æ‚çš„æœåŠ¡ç«¯æ”¹é€ ï¼Œä¹Ÿä¸éœ€è¦å¼•å…¥æ²‰é‡çš„ SDKã€‚</p>
<p>åˆ©ç”¨ Starlight çš„ç»„ä»¶è¦†ç›–æœºåˆ¶ï¼Œæˆ‘ä»¬ä»…é€šè¿‡ä¸€ä¸ªè½»é‡çº§çš„ <code>StarlightFooter.astro</code> ç»„ä»¶ï¼Œå°±å®ç°äº†å…¨å±€æ•°æ®ç»Ÿè®¡ã€‚è¿™ç§"å¾®é›†æˆ"çš„æ–¹å¼ï¼Œæ—¢ä¿è¯äº†ä»£ç çš„æ•´æ´ï¼Œåˆèµ‹äºˆäº†æˆ‘ä»¬æ´å¯Ÿç”¨æˆ·è¡Œä¸ºçš„èƒ½åŠ›ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿåœ¨è¿è¥æŠ€æœ¯ç±»é¡¹ç›®ï¼Œç‰¹åˆ«æ˜¯åƒ <strong>HagiCode</strong> è¿™æ ·éœ€è¦ä¸æ–­è¿­ä»£æ–‡æ¡£çš„é¡¹ç›®ï¼Œå¼ºçƒˆå»ºè®®å°è¯•æ¥å…¥ Clarityã€‚æ•°æ®ä¼šå‘Šè¯‰ä½ ï¼Œç”¨æˆ·çœŸæ­£çš„ç—›ç‚¹åœ¨å“ªé‡Œã€‚</p>
<h3 data-id="heading-14">å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FHagiCode-org%2Fsite" target="_blank" title="https://github.com/HagiCode-org/site" ref="nofollow noopener noreferrer">HagiCode GitHub ä»“åº“</a> - æŸ¥çœ‹æˆ‘ä»¬åœ¨å®é™…é¡¹ç›®ä¸­çš„é…ç½®æ–‡ä»¶</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fclarity%2F" target="_blank" title="https://learn.microsoft.com/en-us/clarity/" ref="nofollow noopener noreferrer">Microsoft Clarity å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fstarlight.astro.build%2Fguides%2Foverriding-components%2F" target="_blank" title="https://starlight.astro.build/guides/overriding-components/" ref="nofollow noopener noreferrer">Starlight ç»„ä»¶è¦†ç›–æŒ‡å—</a></li>
</ul>
<hr/>
<p>æ„Ÿè°¢æ‚¨çš„é˜…è¯»,å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡æœ‰ç”¨,å¿«ç‚¹å‡»ä¸‹æ–¹ç‚¹èµæŒ‰é’®ğŸ‘,è®©æ›´å¤šçš„äººçœ‹åˆ°æœ¬æ–‡ã€‚</p>
<p>æœ¬å†…å®¹é‡‡ç”¨äººå·¥æ™ºèƒ½è¾…åŠ©åä½œ,ç»æœ¬äººå®¡æ ¸,ç¬¦åˆæœ¬äººè§‚ç‚¹ä¸ç«‹åœºã€‚</p>
<ul>
<li><strong>æœ¬æ–‡ä½œè€…:</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.newbe.pro" target="_blank" title="https://www.newbe.pro" ref="nofollow noopener noreferrer">newbe36524</a></li>
<li><strong>æœ¬æ–‡é“¾æ¥:</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fhagicode-org.github.io%2Fsite%2Fblog%2F2026-02-04-starlight-docs-integration-microsoft-clarity%2F" target="_blank" title="https://hagicode-org.github.io/site/blog/2026-02-04-starlight-docs-integration-microsoft-clarity/" ref="nofollow noopener noreferrer">hagicode-org.github.io/site/blog/2â€¦</a></li>
<li><strong>ç‰ˆæƒå£°æ˜:</strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–,å‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„!</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Tauri é¡¹ç›®ï¼šäº¤äº’æµç¨‹ä¸å¼€å‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7602893600251658286</link>    <guid>https://juejin.cn/post/7602893600251658286</guid>    <pubDate>2026-02-05T02:34:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602893600251658286" data-draft-id="7602850166732275721" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Tauri é¡¹ç›®ï¼šäº¤äº’æµç¨‹ä¸å¼€å‘æŒ‡å—"/> <meta itemprop="keywords" content="Rust"/> <meta itemprop="datePublished" content="2026-02-05T02:34:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¡å°”ç‰¹æ–¯"/> <meta itemprop="url" content="https://juejin.cn/user/4450440831840909"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Tauri é¡¹ç›®ï¼šäº¤äº’æµç¨‹ä¸å¼€å‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4450440831840909/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¡å°”ç‰¹æ–¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:34:38.000Z" title="Thu Feb 05 2026 02:34:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é¡¹ç›®æ–‡ä»¶ç»“æ„</h2>
<pre><code class="hljs language-csharp" lang="csharp">DZMRustTauriBaseProject/
â”œâ”€â”€ index.html                    <span class="hljs-meta"># å‰ç«¯ HTML å…¥å£</span>
â”œâ”€â”€ package.json                  <span class="hljs-meta"># å‰ç«¯ä¾èµ–ä¸è„šæœ¬</span>
â”œâ”€â”€ vite.config.ts                <span class="hljs-meta"># Vite æ„å»ºé…ç½®</span>
â”œâ”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ src/                          <span class="hljs-meta"># ã€å‰ç«¯ã€‘ä¸»è¦å¼€å‘åŒº</span>
â”‚   â”œâ”€â”€ main.ts                   <span class="hljs-meta"># Vue åº”ç”¨æŒ‚è½½</span>
â”‚   â”œâ”€â”€ App.vue                   <span class="hljs-meta"># æ ¹ç»„ä»¶ / ä¸»é¡µé¢</span>
â”‚   â”œâ”€â”€ assets/                   <span class="hljs-meta"># é™æ€èµ„æº</span>
â”‚   â””â”€â”€ vite-env.d.ts
â”‚
â”œâ”€â”€ src-tauri/                    <span class="hljs-meta"># ã€åç«¯/æ¡Œé¢å£³ã€‘ä¸»è¦å¼€å‘åŒº</span>
â”‚   â”œâ”€â”€ Cargo.toml                <span class="hljs-meta"># Rust ä¾èµ–</span>
â”‚   â”œâ”€â”€ tauri.conf.json           <span class="hljs-meta"># çª—å£ã€å‰ç«¯åœ°å€ã€æ„å»ºå‘½ä»¤ç­‰</span>
â”‚   â”œâ”€â”€ build.rs                  <span class="hljs-meta"># æ„å»ºæ—¶è„šæœ¬</span>
â”‚   â”œâ”€â”€ capabilities/
â”‚   â”‚   â””â”€â”€ <span class="hljs-literal">default</span>.json          <span class="hljs-meta"># æƒé™ï¼šå…è®¸å‰ç«¯è°ƒç”¨çš„ API</span>
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.rs               <span class="hljs-meta"># ç¨‹åºå…¥å£ï¼Œå¯åŠ¨ Tauri</span>
â”‚   â”‚   â””â”€â”€ lib.rs                <span class="hljs-meta"># ä¸šåŠ¡é€»è¾‘ + æš´éœ²ç»™å‰ç«¯çš„å‘½ä»¤ï¼ˆæ ¸å¿ƒï¼‰</span>
â”‚   â””â”€â”€ icons/                    <span class="hljs-meta"># åº”ç”¨å›¾æ ‡</span>
â”‚
â””â”€â”€ docs/                         <span class="hljs-meta"># æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼‰</span>
</code></pre>
<hr/>
<h2 data-id="heading-1">äºŒã€å‰åç«¯äº¤äº’æµç¨‹</h2>
<h3 data-id="heading-2">2.1 æ•´ä½“æµç¨‹ï¼ˆä¸€æ¬¡è°ƒç”¨ï¼‰</h3>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æ“ä½œï¼ˆå¦‚ç‚¹å‡» Greetï¼‰                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ (Vue / <span class="hljs-attribute">src</span>/App<span class="hljs-selector-class">.vue</span>)                                                â”‚
â”‚  â€¢ è°ƒç”¨: <span class="hljs-built_in">invoke</span>(<span class="hljs-string">"greet"</span>, { name: name.value })                           â”‚
â”‚  â€¢ ä½¿ç”¨: @tauri-apps/api/core çš„ invoke                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚  (Tauri å†…éƒ¨ï¼šåºåˆ—åŒ–å‚æ•° â†’ IPC â†’ åç«¯)
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯ (Rust / src-tauri/src/lib.rs)                                      â”‚
â”‚  â€¢ åŒ¹é…å‘½ä»¤å <span class="hljs-string">"greet"</span> â†’ æ‰§è¡Œ fn <span class="hljs-built_in">greet</span>(name: &amp;str) -&gt; String               â”‚
â”‚  â€¢ è¿”å›å€¼åºåˆ—åŒ–åé€šè¿‡ IPC å›ä¼                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ (Vue)                                                              â”‚
â”‚  â€¢ await <span class="hljs-built_in">invoke</span>(...) å¾—åˆ° Rust è¿”å›çš„ String                              â”‚
â”‚  â€¢ å†™å…¥ greetMsgï¼Œç•Œé¢æ›´æ–°                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-3">2.2 ä»£ç å¯¹åº”å…³ç³»</h3>

























<table><thead><tr><th>ç¯èŠ‚</th><th>ä½ç½®</th><th>åšä»€ä¹ˆ</th></tr></thead><tbody><tr><td>å‰ç«¯è°ƒç”¨</td><td><code>src/App.vue</code></td><td><code>invoke("greet", { name })</code>ï¼Œå‘½ä»¤åå¿…é¡»ä¸ Rust ä¸­ä¸€è‡´</td></tr><tr><td>å‘½ä»¤æ³¨å†Œ</td><td><code>src-tauri/src/lib.rs</code></td><td><code>#[tauri::command] fn greet(...)</code> + <code>generate_handler![greet]</code></td></tr><tr><td>æƒé™</td><td><code>src-tauri/capabilities/default.json</code></td><td>å…è®¸ä½¿ç”¨ <code>core</code>ï¼ˆå« invokeï¼‰ç­‰èƒ½åŠ›</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€åç»­å¼€å‘ï¼šä¸»è¦æ“ä½œåŒºåŸŸä¸æµç¨‹</h2>
<h3 data-id="heading-5">3.1 åŠ ä¸€ä¸ªã€Œæ–°èƒ½åŠ›ã€ï¼ˆæ–°å‘½ä»¤ï¼‰</h3>
<ol>
<li>
<p><strong>Rust ç«¯</strong>ï¼ˆ<code>src-tauri/src/lib.rs</code>ï¼‰</p>
<ul>
<li>å†™ä¸€ä¸ªæ–°å‡½æ•°ï¼ŒåŠ ä¸Š <code>#[tauri::command]</code>ã€‚</li>
<li>åœ¨ <code>tauri::Builder</code> çš„ <code>.invoke_handler(tauri::generate_handler![..., æ–°å‘½ä»¤])</code> é‡Œæ³¨å†Œã€‚</li>
</ul>
</li>
<li>
<p><strong>å‰ç«¯</strong></p>
<ul>
<li>åœ¨éœ€è¦çš„åœ°æ–¹ <code>import { invoke } from "@tauri-apps/api/core"</code>ï¼Œç„¶å <code>await invoke("æ–°å‘½ä»¤å", { å‚æ•° })</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>æƒé™</strong>ï¼ˆè‹¥ç”¨åˆ°æ•æ„Ÿ APIï¼‰</p>
<ul>
<li>åœ¨ <code>capabilities/</code> é‡Œä¸ºå¯¹åº”èƒ½åŠ›æ·»åŠ  permissionï¼ˆå¤šæ•°çº¯ä¸šåŠ¡å‘½ä»¤ç”¨é»˜è®¤å³å¯ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-6">3.2 æ”¹ç•Œé¢</h3>
<ul>
<li>åªåŠ¨ <strong><code>src/</code></strong>ï¼šVue ç»„ä»¶ã€è·¯ç”±ã€çŠ¶æ€ã€æ ·å¼ç­‰ï¼Œå’Œæ™®é€š Vue é¡¹ç›®ä¸€è‡´ã€‚</li>
</ul>
<h3 data-id="heading-7">3.3 æ”¹çª—å£/æ‰“åŒ…/é…ç½®</h3>
<ul>
<li>åŠ¨ <strong><code>src-tauri/tauri.conf.json</code></strong>ï¼šçª—å£å¤§å°ã€æ ‡é¢˜ã€å‰ç«¯ devUrlã€æ„å»ºå‘½ä»¤ç­‰ã€‚</li>
</ul>
<h3 data-id="heading-8">3.4 å¼€å‘æ—¶è·‘èµ·æ¥</h3>
<ul>
<li>åªè·‘ç½‘é¡µï¼š<code>npm run dev</code></li>
<li>è·‘æ¡Œé¢å®¢æˆ·ç«¯ï¼ˆå‰ç«¯ + å£³ï¼‰ï¼š<code>npm run tauri dev</code></li>
</ul>
<hr/>
<h2 data-id="heading-9">å››ã€äº¤äº’åŸç†ç®€è¿°</h2>
<ul>
<li><strong>å‰ç«¯</strong>è¿è¡Œåœ¨ Tauri æä¾›çš„ WebView é‡Œï¼Œå’Œæ™®é€šç½‘é¡µä¸€æ ·å†™ Vue/TSã€‚</li>
<li><strong>é€šä¿¡</strong>ï¼šå‰ç«¯ä¸ç›´æ¥è®¿é—® Rustï¼Œè€Œæ˜¯é€šè¿‡ Tauri çš„ <strong>invoke</strong> å‘ã€Œå‘½ä»¤å + å‚æ•°ã€ï¼›Tauri åœ¨ Rust ç«¯æ ¹æ®å‘½ä»¤åè·¯ç”±åˆ°å¯¹åº”çš„ <code>#[tauri::command]</code> å‡½æ•°ï¼Œæ‰§è¡Œå®ŒåæŠŠè¿”å›å€¼é€šè¿‡ IPC ä¼ å›å‰ç«¯ã€‚</li>
<li><strong>å®‰å…¨</strong>ï¼šå‰ç«¯åªèƒ½è°ƒç”¨ä½ åœ¨ Rust é‡Œæ˜¾å¼æ³¨å†Œçš„ commandï¼Œä»¥åŠ capabilities é‡Œå…è®¸çš„ APIï¼›æ²¡æœ‰ã€Œæ•´ä¸ª Node/ç³»ç»Ÿã€æš´éœ²ç»™å‰ç«¯ï¼Œæ‰€ä»¥ä¸éœ€è¦åƒ Electron é‚£æ ·ç”¨ contextBridge åšä¸€å±‚æš´éœ²ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-10">äº”ã€å’Œ Electron åœ¨æµç¨‹ä¸Šçš„åŒºåˆ«</h2>
<h3 data-id="heading-11">5.1 Electron çš„å…¸å‹åšæ³•</h3>
<ul>
<li><strong>ä¸»è¿›ç¨‹</strong>ï¼šNode ç¯å¢ƒï¼Œå¯ requireã€è®¿é—®ç³»ç»Ÿã€‚</li>
<li><strong>æ¸²æŸ“è¿›ç¨‹</strong>ï¼šæµè§ˆå™¨ç¯å¢ƒï¼Œé»˜è®¤ä¸èƒ½ç›´æ¥ requireã€ä¸èƒ½éšæ„è°ƒä¸»è¿›ç¨‹ã€‚</li>
<li>æ‰€ä»¥è¦ç”¨ <strong>contextBridge + ipcRenderer</strong>ï¼š
<ul>
<li>ä¸»è¿›ç¨‹é‡Œç”¨ <strong>preload</strong> è„šæœ¬ï¼Œé€šè¿‡ <code>contextBridge.exposeInMainWorld('xxx', { ... })</code> åªæš´éœ²æœ‰é™ API ç»™æ¸²æŸ“è¿›ç¨‹ã€‚</li>
<li>æ¸²æŸ“è¿›ç¨‹é‡Œä¸ç›´æ¥ <code>require('electron')</code>ï¼Œè€Œæ˜¯ç”¨æŒ‚åˆ° <code>window</code> ä¸Šçš„å¯¹è±¡ï¼ˆä¾‹å¦‚ <code>window.xxx.invoke('channel', data)</code>ï¼‰ï¼Œå†…éƒ¨å†è½¬æˆ <strong>ipcRenderer.send / ipcRenderer.invoke</strong> ä¸ä¸»è¿›ç¨‹é€šä¿¡ã€‚</li>
</ul>
</li>
<li>æµç¨‹ï¼š<strong>æ¸²æŸ“è¿›ç¨‹ â†’ preloadï¼ˆcontextBridge æš´éœ²çš„ APIï¼‰â†’ ipcRenderer â†’ ä¸»è¿›ç¨‹ï¼ˆipcMain ç›‘å¬ channelï¼‰â†’ ä¸»è¿›ç¨‹é€»è¾‘</strong>ã€‚</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼šElectron éœ€è¦ä½ <strong>è‡ªå·±ç”¨ preload + contextBridge å®šä¹‰ã€Œå‰ç«¯èƒ½è°ƒä»€ä¹ˆã€</strong>ï¼Œå†ç”¨ <strong>ipcRenderer / ipcMain</strong> åœ¨è¿›ç¨‹é—´ä¼  channel + æ•°æ®ã€‚</p>
<h3 data-id="heading-12">5.2 Tauri çš„å¯¹åº”å…³ç³»</h3>






























<table><thead><tr><th>æ¦‚å¿µ</th><th>Electron</th><th>Tauri</th></tr></thead><tbody><tr><td>å‰ç«¯è°ƒã€Œåç«¯ã€</td><td>é€šè¿‡ preload æš´éœ²çš„ API</td><td>é€šè¿‡ <code>invoke("command", args)</code></td></tr><tr><td>æš´éœ²æ–¹å¼</td><td>contextBridge.exposeInMainWorld</td><td>æ— éœ€ preloadï¼Œç›´æ¥ invoke å‘½ä»¤å</td></tr><tr><td>åç«¯å®ç°</td><td>ipcMain.on('channel', handler)</td><td><code>#[tauri::command] fn xxx()</code></td></tr><tr><td>é€šä¿¡æ¨¡å‹</td><td>è‡ªå·±å®š channel åã€è‡ªå·±åºåˆ—åŒ–</td><td>å‘½ä»¤å + å‚æ•°ï¼ŒTauri è´Ÿè´£åºåˆ—åŒ–/è·¯ç”±</td></tr></tbody></table>
<h3 data-id="heading-13">5.3 æ ¸å¿ƒåŒºåˆ«æ€»ç»“</h3>
<ol>
<li>
<p><strong>Electron</strong></p>
<ul>
<li>æ¸²æŸ“è¿›ç¨‹ä¸èƒ½ç›´æ¥ç”¨ <code>require('electron')</code>ï¼Œæ‰€ä»¥è¦ <strong>preload + contextBridge</strong> æš´éœ²å®‰å…¨ APIï¼Œå†ç”¨ <strong>ipcRenderer</strong> å‘ channelï¼Œä¸»è¿›ç¨‹ç”¨ <strong>ipcMain</strong> æ”¶ã€‚</li>
<li>æµç¨‹æ˜¯ä½ è‡ªå·±è®¾è®¡ channel å’Œå‚æ•°æ ¼å¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>Tauri</strong></p>
<ul>
<li>å‰ç«¯ç›´æ¥ç”¨ <strong><code>invoke("å‘½ä»¤å", å‚æ•°)</code></strong>ï¼Œä¸éœ€è¦ preloadï¼Œä¹Ÿæ²¡æœ‰ contextBridgeã€‚</li>
<li>ã€Œæš´éœ²ä»€ä¹ˆã€ç”± Rust é‡Œæ³¨å†Œçš„ <strong>command</strong> å’Œ <strong>capabilities</strong> å†³å®šï¼Œå®‰å…¨æ€§åœ¨æ¡†æ¶å±‚å°±æŒ‰ã€Œç™½åå•å‘½ä»¤ã€è®¾è®¡å¥½äº†ã€‚</li>
</ul>
</li>
</ol>
<p>æ‰€ä»¥ï¼š<strong>Electron çš„ contextBridge + ipcRenderer é‚£ä¸€å¥—ï¼Œåœ¨ Tauri é‡Œè¢«ç®€åŒ–ä¸ºã€Œå‰ç«¯ invoke å‘½ä»¤å + Rust ç«¯ command æ³¨å†Œã€</strong>ï¼Œä¸éœ€è¦ä½ å†™ preloadï¼Œä¹Ÿä¸ç”¨æ‰‹åŠ¨ç®¡ channel åï¼Œåªè¦åœ¨ Rust é‡ŒåŠ  commandã€åœ¨å‰ç«¯è°ƒ invoke å³å¯ã€‚</p>
<hr/>
<h2 data-id="heading-14">å…­ã€å¯¹ç…§å°ç»“</h2>
<ul>
<li><strong>é¡¹ç›®ç»“æ„</strong>ï¼š<code>src/</code> = å‰ç«¯ï¼Œ<code>src-tauri/</code> = æ¡Œé¢å£³ä¸åç«¯é€»è¾‘ï¼›åç»­å¼€å‘ä¸»è¦å°±æ˜¯åœ¨è¿™ä¸¤å—åŠ å‘½ä»¤å’Œæ”¹ç•Œé¢ã€‚</li>
<li><strong>äº¤äº’æµç¨‹</strong>ï¼šç”¨æˆ·æ“ä½œ â†’ å‰ç«¯ <code>invoke("å‘½ä»¤", å‚æ•°)</code> â†’ Tauri è·¯ç”±åˆ° Rust <code>#[tauri::command]</code> â†’ è¿”å›å€¼å›å‰ç«¯ã€‚</li>
<li><strong>å’Œ Electron çš„åŒºåˆ«</strong>ï¼šTauri ç”¨ã€Œinvoke + commandã€æ›¿ä»£äº† Electron çš„ã€ŒcontextBridge + ipcRenderer + ipcMainã€ï¼›å‰ç«¯åªè°ƒå‘½ä»¤åï¼Œä¸ç¢° preloadï¼Œä¹Ÿä¸å®šä¹‰ channelã€‚</li>
</ul>
<p>æ–‡æ¡£ç»“æŸã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Promiseå¯¹è±¡ã€åŒæ­¥å’Œå¼‚æ­¥ä»£ç ã€å›è°ƒåœ°ç‹±çš„è®²è§£]]></title>    <link>https://juejin.cn/post/7602837527674945551</link>    <guid>https://juejin.cn/post/7602837527674945551</guid>    <pubDate>2026-02-05T02:38:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602837527674945551" data-draft-id="7602825342228561954" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Promiseå¯¹è±¡ã€åŒæ­¥å’Œå¼‚æ­¥ä»£ç ã€å›è°ƒåœ°ç‹±çš„è®²è§£"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-05T02:38:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SuperEugene"/> <meta itemprop="url" content="https://juejin.cn/user/2366613652515256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Promiseå¯¹è±¡ã€åŒæ­¥å’Œå¼‚æ­¥ä»£ç ã€å›è°ƒåœ°ç‹±çš„è®²è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2366613652515256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SuperEugene
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:38:26.000Z" title="Thu Feb 05 2026 02:38:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç®€å•ç²—æš´ä¸€ç‚¹çš„è¯´ <code>Promise</code> å°±æ˜¯ä¸€ä¸ªä¸ºäº†è§£å†³å¼‚æ­¥ä»£ç çš„ä¸œè¥¿ï¼Œå®ƒå¯ä»¥è®©ä»£ç æŒ‰ç…§ä½ æƒ³è¦çš„é¡ºåºå»æ‰§è¡Œã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥è¯´è¯´ä»€ä¹ˆæ˜¯åŒæ­¥ä»£ç ï¼Œä»€ä¹ˆæ˜¯å¼‚æ­¥ä»£ç ã€‚</p>
<ul>
<li><strong>åŒæ­¥ä»£ç </strong>å°±æ˜¯æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¦‚ï¼š12345 æŒ‰é¡ºåºå¾€ä¸‹èµ°ã€‚åªæœ‰å‰ä¸€æ¡ä»£ç æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰ä¼šå»æ‰§è¡Œåä¸€æ¡ä»£ç ã€‚</li>
<li><strong>å¼‚æ­¥ä»£ç </strong>å°±æ˜¯å¯ä»¥ä¸æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„ä»£ç ï¼Œå¦‚ï¼š213465ï¼Œä¾‹å¦‚ï¼šç½‘ç»œè¯·æ±‚ã€å®šæ—¶å™¨ã€æ–‡ä»¶çš„è¯»å†™ç­‰å‡æ˜¯å¼‚æ­¥çš„ã€‚æˆ‘ä»¬ç›´æ¥ä¸Šä»£ç ç›´è§‚çš„å»æ„Ÿå—ä¸€ä¸‹</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  
}, <span class="hljs-number">1000</span>)
</code></pre>
<p>â†‘è¿™æ˜¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥å°†åŒ…è£¹åœ¨æ–¹æ³•ä½“å†…çš„ä»£ç å»¶è¿Ÿ 1000 æ¯«ç§’ä»¥åå†æ‰§è¡Œçš„å®šæ—¶å™¨ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä»»åŠ¡1'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä»»åŠ¡2'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
}, <span class="hljs-number">1000</span>)

<span class="hljs-comment">//moment (new Date ()).format ('HH:mm:ss') å¦‚æœä½ æ˜¯åˆå­¦è€…ä¸æ˜ç™½ moment () æ˜¯ä»€ä¹ˆï¼Œ</span>
<span class="hljs-comment">//ç›´æ¥å¤åˆ¶ä»£ç å‘ç°æŠ¥é”™ï¼Œæ²¡å…³ç³»ã€‚å¹¶ä¸å½±å“ä½ ç»§ç»­å­¦ä¹ ï¼Œè¿™æ¡ä»£ç çš„åŠŸèƒ½å°±æ˜¯è¾“å‡ºåšä¸»å½“å‰æ‰§è¡Œä»£ç çš„æ—¶é—´ï¼Œ</span>
<span class="hljs-comment">//ä½ å¯ä»¥åˆ æ‰è¿™æ¡ä»£ç ï¼Œåªè¾“å‡º ' ä»»åŠ¡1ã€ä»»åŠ¡2' å³å¯ã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œæœç´¢ moment çš„ä½¿ç”¨æ–¹æ³•å­¦ä¹ </span>

</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ddb51c23f40436794e46a454b1d41ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=EfJRCskvN%2BoiyiMqUkbMjYZVoYQ%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ä»»åŠ¡ 2 æ¯”ä»»åŠ¡ 1 çš„æ‰“å°æ—¶é—´æ™šäº†ä¸€ç§’</p>
<p>å‰é¢æˆ‘ä»¬è¯´åˆ°å®šæ—¶å™¨æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„ä»£ç ï¼Œæˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä»»åŠ¡2'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
}, <span class="hljs-number">1000</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä»»åŠ¡1'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
</code></pre>
<p>æŒ‰ç…§ä»£ç è‡ªä¸Šè€Œä¸‹çš„æ‰§è¡Œé¡ºåºï¼Œåœ¨æ§åˆ¶å°ä¸­åº”è¯¥æ˜¯ä¸€ç§’é’Ÿä»¥åå…ˆè¾“å‡ºçš„ä»»åŠ¡ 2 å†è¾“å‡ºçš„ä»»åŠ¡ 1</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8496e4564aef4cf6a709c1853d360c5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=4Jbvi4nY9CaR25ePPdqdKETACbk%3D" alt="image.png" loading="lazy"/></p>
<p>ä»æ§åˆ¶å°çš„è¾“å‡ºå¾—çŸ¥å¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚ä»£ç è·³è¿‡äº†ä»»åŠ¡ 2 å…ˆè¾“å‡ºçš„ä»»åŠ¡ 1ï¼Œç„¶åä¸€ç§’é’Ÿä¹‹åæ‰è¾“å‡ºçš„ä»»åŠ¡ 2ï¼Œè¯å®å®šæ—¶å™¨ç¡®å®æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„ä»£ç ï¼Œå®ƒå¹¶æ²¡æœ‰æŒ‰ç…§é¡ºåºæ‰§è¡Œã€‚</p>
<p>å¼‚æ­¥ä»£ç çš„å¥½å¤„å°±åœ¨äºä¸ä¼šé€ æˆä»£ç çš„å µå¡</p>
<ul>
<li>ä¾‹å¦‚ï¼šç°åœ¨æˆ‘ä»¬æ˜¯äº¤é€šå‚ä¸è€…çš„èº«ä»½å¼€ç€è½¦è¡Œé©¶åœ¨è·¯ä¸Šï¼Œçªç„¶å‰æ–¹å‡ºç°äº†äº¤é€šäº‹æ•…ï¼Œæ­¤æ—¶è¾¹ä¸Šæœ‰è¾…é“å¯ä»¥ç»•è¿‡å»ï¼Œéš¾é“æˆ‘ä»¬å°±è¦ç­‰åˆ°è¿™èµ·äº¤é€šäº‹æ•…å¤„ç†å®Œæˆä¹‹åæ‰èƒ½é€šè¡Œå—ï¼Ÿå½“ç„¶æ˜¯æ²¡æœ‰è¿™ä¸ªå¿…è¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡è¾¹ä¸Šçš„è¾…é“ç»•è¿‡å»ï¼Œæ— éœ€ç­‰åˆ°äº¤é€šäº‹æ•…å¤„ç†å®Œæ¯•ä¹‹åå†é€šè¡Œï¼Œå¦‚æœç­‰åˆ°äº¤é€šäº‹æ•…å¤„ç†ä¹‹åå†é€šè¡Œé‚£å°±ä¼šé€ æˆäº¤é€šç˜«ç—ªå¤§å µè½¦çš„ç»“å±€ã€‚</li>
</ul>
<p>è¿˜æœ‰çš„æ—¶å€™å¼‚æ­¥ä»»åŠ¡ä¹Ÿéœ€è¦åŒæ­¥çš„å»æ‰§è¡Œã€‚è¿˜æ˜¯ä»¥è¿™ä¸ªäº¤é€šäº‹æ•…ä¸¾ä¾‹å­ï¼Œä¾‹å¦‚ï¼šæˆ‘ä»¬æ˜¯äº¤è­¦ï¼Œæˆ‘ä»¬æ¥åˆ°äº†è°ƒåº¦ä¸­å¿ƒå‘æ¥çš„ä»»åŠ¡è¯·æ±‚ï¼Œå‘ŠçŸ¥æˆ‘ä»¬æŸè·¯æ®µå‘ç”Ÿäº¤é€šäº‹æ•…éœ€è¦æˆ‘ä»¬å‰å¾€ç°åœºè¿›è¡Œå¤„ç†ã€‚åœ¨æ¥è­¦æ²¡å¤šä¹…ä¹‹åè°ƒåº¦ä¸­å¿ƒåˆå‘æ¥è¯·æ±‚ï¼Œå‘ŠçŸ¥æˆ‘ä»¬ç°åœ¨è­¦åŠ›ç´§å¼ ï¼Œåœ¨æˆ‘ä»¬çš„ä¸è¿œå¤„è¿˜æœ‰ä¸€èµ·äº¤é€šäº‹æ•…å¸Œæœ›æˆ‘ä»¬å¤„ç†å®Œæ‰‹é‡Œçš„è¿™ä¸ªäº‹æ•…ä¹‹åç«‹é©¬å‰å¾€ä¸‹ä¸€ä¸ªè·¯æ®µå¤„ç†ç¬¬äºŒèµ·äº¤é€šäº‹æ•…ã€‚é‚£æ­¤æ—¶ä»»åŠ¡äºŒå°±è¦ç­‰å¾…ä»»åŠ¡ä¸€æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½æ‰§è¡Œã€‚å…¶ä»–çš„äº¤é€šå‚ä¸è€…å½“ç„¶ä¸éœ€è¦ç­‰å¾…äº¤è­¦çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½é€šè¿‡ï¼Œå¯ä»¥è‡ªè¡Œä»è¾¹ä¸Šç»•è¿‡å»ã€‚ä¸Šä»£ç ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå°æ•…äº‹ä»¥ä»£ç çš„å½¢å¼å‘ˆç°å‡ºæ¥</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†1'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†2'</span>)
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…1'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…2'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
  }, <span class="hljs-number">1000</span>)
}, <span class="hljs-number">1000</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†3'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†4'</span>)
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01e31bdf6fb84b88b6feb2b3099b6cb6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=KX%2B1BOvaqh%2FjhFK%2BvGnnVqxMTPk%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡æ§åˆ¶å°çš„è¾“å‡ºæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¤¾ä¼šè½¦è¾† 1ã€2ã€3ã€4 å…ˆè¡Œé€šè¿‡äº†ï¼Œäº¤è­¦å¤„ç†äº‹æ•… 1 ä¹‹åä¸€ç§’é’Ÿäº‹æ•… 2 æ‰æ‰§è¡Œå¤„ç†ã€‚</p>
<p>ä½†å…¶å®è¿™ç§å†™æ³•å¹¶ä¸ç¾è§‚ï¼Œå¦‚æœæœ‰å¾ˆå¤šäº‹æ•…éœ€è¦å¤„ç†å‘¢ï¼Œé‚£æ˜¯ä¸æ˜¯å°±è¦åµŒå¥—å¾ˆå¤šå±‚å‘¢ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†1'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†2'</span>)
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…1'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…2'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…3'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…4'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…5'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
          <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…6'</span>, <span class="hljs-title function_">moment</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">format</span>(<span class="hljs-string">'HH:mm:ss'</span>))
          }, <span class="hljs-number">1000</span>)
        }, <span class="hljs-number">1000</span>)
      }, <span class="hljs-number">1000</span>)
    }, <span class="hljs-number">1000</span>)
  }, <span class="hljs-number">1000</span>)
}, <span class="hljs-number">1000</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†3'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†4'</span>)
</code></pre>
<p>è¿™æ ·çš„å†™æ³•ä¼šå¯¼è‡´ä»£ç çš„å¯è¯»æ€§éå¸¸çš„å·®ï¼Œä½ å¯èƒ½è¯´æˆ‘ç°åœ¨ä¸€çœ¼å°±èƒ½çœ‹å‡ºå“ªå„¿æ¡è¾“å‡ºè¯­å¥å¯¹åº”ç€å“ªå„¿ä¸ªä»£ç å—ã€‚æ²¡é”™ï¼Œå°±ä»¥ç°åœ¨çš„è¿™ä¸ªä»£ç æ˜¯å¯ä»¥åšåˆ°ã€‚ä½†å¦‚æœå½“æ¯ä¸€ä¸ªä»£ç å—ä¸­çš„ä»£ç å¤æ‚èµ·æ¥å¤šèµ·æ¥äº†ä»¥åå‘¢ã€‚ä½ è¿˜èƒ½ä¸€çœ¼å°±çœ‹å‡ºæ¥å—ï¼Ÿå½“ç„¶æ˜¯å¾ˆè´¹åŠ›çš„å˜›ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„<strong>å›è°ƒåœ°ç‹±</strong>ã€‚</p>
<p><code>Promise</code> çš„å‡ºç°å°±å¯ä»¥å¾ˆå¥½çš„è§„é¿æ‰è¿™ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬æ¥è¿›å…¥ <code>Promise</code> çš„å­¦ä¹ å§ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>()
</code></pre>
<p><code>Promise</code> å°±é•¿è¿™æ ·â†‘</p>
<p><code>Promise</code> æ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>resolve</code> å’Œ <code>reject</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {})
</code></pre>
<p><code>resolve</code> å’Œ <code>reject</code> æ˜¯ç”± <code>Promise</code> å¯¹è±¡ä¼ å…¥çš„ã€‚<code>resolve</code> ç›´è¯‘è¿‡æ¥çš„æ„æ€æ˜¯ï¼šå†³å®šã€è§£å†³ï¼Œæ˜¯åœ¨ç¨‹åºæ‰§è¡ŒæˆåŠŸçš„æ—¶å€™è°ƒç”¨çš„ï¼Œè€Œ <code>reject</code> ç›´è¯‘è¿‡æ¥çš„æ„æ€æ˜¯ï¼šæ‹’ç»ï¼Œæ˜¯åœ¨ç¨‹åºè°ƒç”¨å¤±è´¥çš„æ—¶å€™è°ƒç”¨çš„ï¼Œæ•…æ­¤ä½ å¯ä»¥å°†</p>
<ul>
<li><code>resolve</code> <strong>ç†è§£ä¸ºæˆåŠŸ</strong>ï¼Œ</li>
<li><code>reject</code>  <strong>ç†è§£ä¸ºå¤±è´¥</strong>ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼šç°åœ¨æˆ‘ä»¬æ­£åœ¨ç™»é™†æŸä¸€ä¸ªç½‘ç«™ï¼Œå½“ä½ çš„ç”¨æˆ·åæˆ–å¯†ç è¾“å…¥é”™è¯¯ä¹‹æ—¶ï¼Œèº«ä»½éªŒè¯ä¸é€šè¿‡å°±ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæ­¤æ—¶å°±å¯ä»¥è°ƒç”¨ <code>reject</code>ã€‚åä¹‹ç”¨æˆ·åå’Œå¯†ç éƒ½æ­£ç¡®èº«ä»½è®¤è¯é€šè¿‡äº†ï¼Œæ­¤æ—¶ä¾¿å¯è°ƒç”¨ <code>resolve</code>ã€‚</p>
<p>å’±ä»¬å…ˆæ‰“å°ä¸€ä¸‹è¿™ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œçœ‹çœ‹é•¿ä»€ä¹ˆæ ·</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> promiseObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {})
 
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(promiseObj)
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe26d6c9109e4a04b74bb5918d1d7878~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=WYYyqLC3LJetGlNYtrR344sJE4k%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬çœ‹åˆ°åœ¨æ§åˆ¶å°æ‰“å°å‡ºæ¥çš„æ•°æ®ä¸­æœ‰ä¸€ä¸ª<code>pending</code>ï¼ˆç­‰å¾…çš„æ„æ€ï¼‰ï¼Œ<code>promise</code> å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªçŠ¶æ€çš„æ¦‚å¿µã€‚ä½ çœ‹ç°åœ¨çš„çŠ¶æ€æ˜¯ä¸€ä¸ªé»˜è®¤çŠ¶æ€ <code>pending</code>ï¼Œä½ å¯ä»¥ç†è§£ä¸ºè¿™ä¸ª <code>promise</code> é‡Œçš„ <code>resolve</code> å’Œ <code>reject</code> ä¸€ä¸ªéƒ½æ²¡æœ‰è¢«è§¦å‘ã€‚</p>
<p>æˆ‘ä»¬æ¥è§¦å‘ <code>resolve</code> å‚æ•°çœ‹çœ‹çŠ¶æ€</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> promiseObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">resolve</span>()
})
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(promiseObj)
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/884ab525c62942c18f724a975670e108~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=Gvmb5f3mvbWSUJ7%2FMiVag56TEjc%3D" alt="image.png" loading="lazy"/></p>
<p>è§‚å¯Ÿå‘ç° <code>PromiseState</code> ä» <code>pending</code> ç­‰å¾…å˜æˆäº†<code>fulfilled</code>ï¼Œ<code>fulfilled</code> å°±è¡¨ç¤º<strong>å®Œæˆæˆ–è€…æˆåŠŸ</strong>ã€‚</p>
<p>æˆ‘ä»¬å†æ¥è§¦å‘ä¸€ä¸‹ reject å‚æ•°çœ‹çœ‹çŠ¶æ€</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> promiseObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">reject</span>()
})
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(promiseObj)
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/484661044ce44233970870cccf12e339~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=L8%2FKD%2BQE2taLNdZk3jg7cnMw1cM%3D" alt="image.png" loading="lazy"/></p>
<p>è§‚å¯Ÿå‘ç° PromiseState çš„çŠ¶æ€å˜æˆäº†<strong>rejected</strong> è¡¨ç¤ºæ‹’ç»æˆ–è€…å¤±è´¥äº†ã€‚</p>
<p><code>promise</code> å¯¹è±¡ç»™æˆ‘ä»¬æä¾›äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œå’±ä»¬è‡ªå·±å¯ä»¥å¦‚å›¾ä¸€æ ·é€šè¿‡å¯¹è±¡ç‚¹çš„å½¢å¼æ¥çœ‹çœ‹æ˜¯ä¸æ˜¯å‡ºæ¥ <code>catch</code> ã€<code>finally</code>ã€<code>then</code> è¿™ä¸‰ä¸ªæ–¹æ³•ã€‚</p>
<p>ç®€å•ç²—æš´çš„è®²ä¸€ä¸‹è¿™ä¸‰ä¸ªæ–¹æ³•ã€‚è¿˜æ˜¯ä»¥ç™»é™†æŸä¸€ç½‘ç«™ä¸ºä¾‹ï¼š</p>
<ul>
<li>å‡è®¾ç”¨æˆ·åå’Œå¯†ç éƒ½å¡«å†™æ­£ç¡®åˆ™ä¼šèµ°åˆ° <code>then()</code> æ–¹æ³•é‡Œï¼Œä½ å¯ä»¥ç†è§£ä¸º<code>then()</code> <strong>æ–¹æ³•æ˜¯æˆåŠŸæ—¶å€™è°ƒç”¨çš„</strong>ã€‚å‡è®¾ç”¨æˆ·åå’Œå¯†ç æœ‰ä¸€ä¸ªæˆ–è€…å…¨éƒ½å¡«å†™é”™è¯¯æ—¶æœåŠ¡å™¨ä¾¿ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæ­¤æ—¶ä»£ç å°±ä¼šèµ°åˆ° <code>catch()</code> æ–¹æ³•é‡Œï¼Œä½ å¯ä»¥ç†è§£ä¸º<code>catch()</code><strong>æ–¹æ³•æ˜¯åœ¨é”™è¯¯æ—¶å€™è°ƒç”¨çš„</strong>ã€‚é‚£ä¹ˆ<code>finally()</code> <strong>æ–¹æ³•åˆ™æ˜¯æ— è®ºæœåŠ¡å™¨è¿”å›çš„æ˜¯</strong> <code>true</code> <strong>è¿˜æ˜¯</strong> <code>false</code> <strong>éƒ½ä¼šèµ°åˆ°</strong> <code>finally</code> <strong>é‡Œé¢</strong>ï¼Œä½ å¯ä»¥ç†è§£ä¸ºä¸è®ºå¯¹é”™éƒ½ä¼šè°ƒç”¨ <code>finally</code>ã€‚ç”¨æˆ·åå¯†ç å¡«å†™æ­£ç¡®ï¼Œèµ°å®Œ <code>then()</code> è¿˜ä¼šèµ° <code>finally</code>ã€‚ç”¨æˆ·åå¯†ç å¡«å†™é”™è¯¯ï¼Œèµ°å®Œ <code>catch()</code> ä¹Ÿè¿˜ä¼šèµ° <code>finally()</code>ã€‚</li>
</ul>
<p>è®©æˆ‘ä»¬æ¥ä¸€ä¸€éªŒè¯ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> promiseObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'èº«ä»½è®¤è¯é€šè¿‡ï¼'</span>)
})
promiseObj
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> { <span class="hljs-comment">//dataå°±æ˜¯resolveä¼ è¿‡æ¥çš„å†…å®¹ åç§°æ²¡æœ‰è§„å®šè‡ªå®šä¹‰å³å¯</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)
  })
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æˆ‘æ˜¯finally'</span>)
  })
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a791a9eeba174e2f85bc27c15ced8cdf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=4i5fZC9Ovgf4hB1AAZcz6ydyAa4%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡ä»£ç å¯ä»¥çœ‹å¾—å‡ºè¿™ä¸‰ä¸ªæ–¹æ³•æ¥æ”¶çš„éƒ½æ˜¯ä¸€ä¸ª<code>å›è°ƒå‡½æ•°</code>ã€‚é€šè¿‡æ§åˆ¶å°çš„è¾“å‡ºå¯ä»¥å¾—çŸ¥å½“æˆ‘ä»¬è°ƒç”¨äº† <code>resolve</code> æ—¶ä»£ç èµ°åˆ°äº†<code>then()</code> æ–¹æ³•ä¹‹ååˆèµ°åˆ°äº† <code>finally()</code> æ–¹æ³•ï¼ŒéªŒè¯é€šè¿‡ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> promiseObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">reject</span>(<span class="hljs-string">'èº«ä»½è®¤è¯å¤±è´¥ï¼'</span>)
})
promiseObj
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> { 
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> { <span class="hljs-comment">//errorå°±æ˜¯rejectä¼ è¿‡æ¥çš„å†…å®¹  åç§°æ²¡æœ‰è§„å®šè‡ªå®šä¹‰å³å¯</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)
  })
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æˆ‘æ˜¯finally'</span>)
  })
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4801d34aff5474fb6a9c0f29e4104fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=6MqyKIJUyz4PaQGqIrBr4mo3WCk%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡æ§åˆ¶å°çš„è¾“å‡ºå¯ä»¥å¾—çŸ¥å½“æˆ‘ä»¬è°ƒç”¨äº† <code>reject</code> æ—¶ä»£ç èµ°åˆ°äº† <code>catch()</code> æ–¹æ³•ä¹‹ååˆèµ°åˆ°äº† <code>finally()</code> æ–¹æ³•ï¼ŒéªŒè¯é€šè¿‡ã€‚</p>
<p>åˆ°è¿™å„¿ä¸ºæ­¢ä½ å·²ç»å¯¹ <code>Promise</code> çš„ä½¿ç”¨æœ‰äº†ä¸€ä¸ªç®€å•çš„è®¤è¯†ã€‚æˆ‘ä»¬ç°åœ¨ç”¨ <code>Promise</code> æ¥è§£å†³ä¸€ä¸‹å‰é¢ä¸¾ä¾‹è¯´æ˜çš„å°æ•…äº‹ã€‚çœ‹çœ‹ä½ æ˜¯å¦ä¼šè§‰å¾—ä¼˜é›…å¾ˆå¤šï¼Œä»£ç æ›´å¯è¯»ã€‚</p>
<p>è™½ç„¶ <code>promise</code> æœ¬èº«æ˜¯åŒæ­¥çš„ï¼Œä½†æ˜¯ <code>promise</code> çš„<code>.then()</code>ã€<code>.catch ()</code>ã€<code>. finally ()</code> è¿™äº›æ–¹æ³•ä¸­çš„å›è°ƒæ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬å°±ä¸ç”¨å®šæ—¶å™¨äº†ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†1'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†2'</span>)
<span class="hljs-keyword">const</span> promiseObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…1'</span>)
})
promiseObj
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…2'</span>)
    })
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…3'</span>)
    })
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…4'</span>)
    })
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
  })
  .<span class="hljs-title function_">catch</span>()
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†3'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†4'</span>)
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3dbc7f101ea4e33b3d698cf2e1a0cd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=qQ99JiwIheLD3eNJ97KBixcJ1LU%3D" alt="image.png" loading="lazy"/></p>
<p>æœ‰çš„äººä¼šè¯´ è¿™ä¹ŸåµŒå¥—äº†å‘€ã€‚æ²¡é”™è¿™ç¡®å®æ˜¯ä¹ŸåµŒå¥—äº†ï¼Œä½†æ˜¯åªæœ‰ä¸€å±‚ï¼Œæ— è®ºå¤šå°‘æ¬¡éƒ½åªæœ‰ä¸€å±‚</p>
<pre><code class="hljs language-js" lang="js">promiseObj.<span class="hljs-title function_">then</span>().<span class="hljs-title function_">then</span>().<span class="hljs-title function_">then</span>().<span class="hljs-title function_">then</span>().<span class="hljs-title function_">then</span>().<span class="hljs-title function_">then</span>().<span class="hljs-title function_">catch</span>()
</code></pre>
<p>â†‘è¿™æ ·çœ‹æ˜¯ä¸æ˜¯å°±æ›´ç›´è§‚äº†å‘¢ã€‚</p>
<p>è¿˜æœ‰å¦ä¸€ç§å†™æ³•å¯ä»¥ç»™æ¯ä¸€ä¸ª<code>.then()</code> éƒ½è®¾ç½®ä¸€ä¸ªå•ç‹¬çš„ <code>catch()</code> ç›´æ¥ä¸Šä»£ç </p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2bd69858409432c8537b0f8f986ed29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=jRSkg9StdnZwj9Qareu46hhM0Yg%3D" alt="image.png" loading="lazy"/>
ä»è¿™å¼ å›¾â†‘å¯ä»¥çœ‹åˆ°<code>.then()</code> é‡Œé¢å…¶å®å¯ä»¥ä¼ é€’ä¸¤ä¸ªå‚æ•°çš„ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºæˆåŠŸæ—¶å€™çš„è°ƒç”¨ï¼Œç¬¬äºŒä¸ªè¡¨ç¤ºå¤±è´¥æ—¶å€™çš„è°ƒç”¨</p>
<pre><code class="hljs language-js" lang="js">promiseObj
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {}, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {}, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {}, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {}, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {}, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {})
</code></pre>
<p>â†‘è¿™ä¾¿æ˜¯å¤§è‡´çš„ä¸€ä¸ªç»“æ„</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> promiseObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…1'</span>)
})
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†1'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†2'</span>)
promiseObj
  .<span class="hljs-title function_">then</span>(
    <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…2'</span>)
      })
    },
    <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)
    }
  )
  .<span class="hljs-title function_">then</span>(
    <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
      <span class="hljs-keyword">let</span> errorBtn = <span class="hljs-literal">false</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (errorBtn) {
          <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…3'</span>)
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">reject</span>(<span class="hljs-string">'äº¤é€šäº‹æ•…å¤„ç†æ—¶å€™é‡åˆ°ç‰¹æ®ŠçŠ¶å†µ'</span>)
        }
      })
    },
    <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)
    }
  )
  .<span class="hljs-title function_">then</span>(
    <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'äº¤è­¦å¤„ç†äº‹æ•…4'</span>)
      })
    },
    <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)
    }
  )
  .<span class="hljs-title function_">then</span>()
 
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†3'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¤¾ä¼šè½¦è¾†4'</span>)
</code></pre>
<p>æˆ‘ä»¬åœ¨äº¤è­¦äº‹æ•…å¤„ç† 3 å¤„åŠ äº†ä¸€ä¸ª <code>reject</code> çš„è°ƒç”¨</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/396603bb27f44f8b93d534b9d5380fe8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU3VwZXJFdWdlbmU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770863909&amp;x-signature=PHMIR1RbnaL85VZeTEmXGUCmRws%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡æ§åˆ¶å°çš„è¾“å‡ºå¯ä»¥å¾—çŸ¥å’±ä»¬çš„ <code>reject</code> èµ·ä½œç”¨äº†ã€‚å½“äº¤è­¦å¤„ç†äº‹æ•… 3 å¤„æŠ¥é”™æ—¶ä»£ç å°±ç»ˆæ­¢äº†ï¼Œåé¢çš„ç¨‹åºå°±ä¸æ‰§è¡Œäº†ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯æœ¬ç« çš„çŸ¥è¯†ç‚¹è®²è§£åˆ†äº«ï¼Œæ„Ÿè°¢å¤§å®¶çš„è€å¿ƒè§‚çœ‹å­¦ä¹ ï¼Œæ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºè®¨è®ºçº é”™ï¼Œä¸å¤§å®¶å…±å‹‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Compose é¡µé¢è·³è½¬ä¸­çš„çŠ¶æ€ä¿ç•™ï¼šViewModel + StateHolder æ¶æ„æ¨¡å¼]]></title>    <link>https://juejin.cn/post/7602825342228103202</link>    <guid>https://juejin.cn/post/7602825342228103202</guid>    <pubDate>2026-02-04T16:24:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602825342228103202" data-draft-id="7602824293164793871" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Compose é¡µé¢è·³è½¬ä¸­çš„çŠ¶æ€ä¿ç•™ï¼šViewModel + StateHolder æ¶æ„æ¨¡å¼"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-04T16:24:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è éº¦é’é’"/> <meta itemprop="url" content="https://juejin.cn/user/2647279733077246"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Compose é¡µé¢è·³è½¬ä¸­çš„çŠ¶æ€ä¿ç•™ï¼šViewModel + StateHolder æ¶æ„æ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2647279733077246/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è éº¦é’é’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T16:24:07.000Z" title="Wed Feb 04 2026 16:24:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Compose é¡µé¢è·³è½¬ä¸­çš„çŠ¶æ€ä¿ç•™ï¼šViewModel + StateHolder æ¶æ„æ¨¡å¼</h2>
<h3 data-id="heading-1">é—®é¢˜èƒŒæ™¯</h3>
<p>åœ¨ä½¿ç”¨ Jetpack Compose è¿›è¡Œé¡µé¢å¯¼èˆªå¼€å‘æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ä¸€ä¸ªç»å…¸é—®é¢˜ï¼š<strong>é¡µé¢è·³è½¬åï¼Œè¿”å›æ—¶ UI æ§ä»¶çš„å†…éƒ¨çŠ¶æ€ä¼šä¸¢å¤±</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä¸€ä¸ªè®¡æ•°å™¨é¡µé¢ï¼Œç”¨æˆ·æ‰‹åŠ¨å¢åŠ äº†è®¡æ•°ï¼Œç„¶åè·³è½¬åˆ°å…¶ä»–é¡µé¢ï¼Œå†è¿”å›æ—¶ï¼Œè®¡æ•°å™¨å›åˆ°äº†åˆå§‹å€¼ã€‚è¿™æ˜¯å› ä¸º Composable çš„é‡ç»„æœºåˆ¶å¯¼è‡´çš„â€”â€”é¡µé¢é‡å»ºæ—¶ï¼Œæ‰€æœ‰çŠ¶æ€éƒ½è¢«é‡æ–°åˆå§‹åŒ–ã€‚</p>
<h3 data-id="heading-2">ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ</h3>
<p>åœ¨ Android ä¼ ç»Ÿå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¹ æƒ¯ä½¿ç”¨ <code>savedInstanceState</code> æ¥ä¿å­˜çŠ¶æ€ã€‚ä½†åœ¨ Compose ä¸­ï¼Œè¿™ä»ç„¶é¢ä¸´æŒ‘æˆ˜ï¼š</p>
<ul>
<li>éœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–çŠ¶æ€</li>
<li>å¯¹äºå¤æ‚çš„ä¸šåŠ¡é€»è¾‘å¯¹è±¡ï¼Œå¤„ç†èµ·æ¥å¾ˆç¹ç</li>
<li>ä»£ç ä¾µå…¥æ€§è¾ƒå¼º</li>
</ul>
<h3 data-id="heading-3">æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆï¼šViewModel + StateHolder æ¶æ„</h3>
<h4 data-id="heading-4">æ ¸å¿ƒæ€æƒ³</h4>
<p>å°†<strong>çŠ¶æ€ç®¡ç†</strong>å’Œ<strong>ä¸šåŠ¡é€»è¾‘</strong>ä» UI å±‚åˆ†ç¦»å‡ºæ¥ï¼Œä½¿ç”¨ï¼š</p>
<ol>
<li><strong>ViewModel</strong>ï¼šç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼ŒæŒæœ‰ StateHolder</li>
<li><strong>StateHolder</strong>ï¼šçº¯ Kotlin ç±»ï¼Œå°è£…ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€</li>
</ol>
<p>è¿™æ ·ï¼Œå³ä½¿é¡µé¢è·³è½¬ï¼ŒViewModel ä»ç„¶å­˜æ´»ï¼ŒStateHolder ä¸­çš„çŠ¶æ€å¾—ä»¥ä¿ç•™ã€‚</p>
<h4 data-id="heading-5">ä»£ç å®ç°</h4>
<h5 data-id="heading-6">1. StateHolder - ä¸šåŠ¡é€»è¾‘å±‚</h5>
<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªçº¯ Kotlin ç±»æ¥ç®¡ç†ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.ehi.cmp_demo.page.router_test.logic

<span class="hljs-keyword">import</span> kotlinx.coroutines.CoroutineScope
<span class="hljs-keyword">import</span> kotlinx.coroutines.Job
<span class="hljs-keyword">import</span> kotlinx.coroutines.delay
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.MutableStateFlow
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.StateFlow
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.asStateFlow
<span class="hljs-keyword">import</span> kotlinx.coroutines.isActive
<span class="hljs-keyword">import</span> kotlinx.coroutines.launch

<span class="hljs-comment">/**
 * State Holder for Counter logic.
 * Pure Kotlin class, unaware of Android Lifecycle.
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterManager</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> scope: CoroutineScope) {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _count = MutableStateFlow(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">val</span> count: StateFlow&lt;<span class="hljs-built_in">Int</span>&gt; = _count.asStateFlow()

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _isAutoIncrementing = MutableStateFlow(<span class="hljs-literal">false</span>)
    <span class="hljs-keyword">val</span> isAutoIncrementing: StateFlow&lt;<span class="hljs-built_in">Boolean</span>&gt; = _isAutoIncrementing.asStateFlow()

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> timerJob: Job? = <span class="hljs-literal">null</span>

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">increment</span><span class="hljs-params">()</span></span> {
        _count.value++
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">decrement</span><span class="hljs-params">()</span></span> {
        _count.value--
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">toggleAutoIncrement</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> (_isAutoIncrementing.value) {
            stopAutoIncrement()
        } <span class="hljs-keyword">else</span> {
            startAutoIncrement()
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startAutoIncrement</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> (_isAutoIncrementing.value) <span class="hljs-keyword">return</span>
        _isAutoIncrementing.value = <span class="hljs-literal">true</span>
        
        timerJob?.cancel()
        timerJob = scope.launch {
            <span class="hljs-keyword">while</span> (isActive &amp;&amp; _isAutoIncrementing.value) {
                delay(<span class="hljs-number">1000</span>)
                increment()
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">stopAutoIncrement</span><span class="hljs-params">()</span></span> {
        _isAutoIncrementing.value = <span class="hljs-literal">false</span>
        timerJob?.cancel()
        timerJob = <span class="hljs-literal">null</span>
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>çº¯ Kotlin ç±»ï¼Œä¸ä¾èµ– Android API</li>
<li>ä½¿ç”¨ <code>StateFlow</code> æš´éœ²å“åº”å¼çŠ¶æ€</li>
<li>ä¸šåŠ¡é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºæµ‹è¯•</li>
</ul>
<h5 data-id="heading-7">2. ViewModel - ç”Ÿå‘½å‘¨æœŸç®¡ç†å±‚</h5>
<p>åˆ›å»º ViewModel æ¥æŒæœ‰ StateHolderï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.ehi.cmp_demo.page.router_test

<span class="hljs-keyword">import</span> androidx.lifecycle.ViewModel
<span class="hljs-keyword">import</span> androidx.lifecycle.viewModelScope
<span class="hljs-keyword">import</span> com.ehi.cmp_demo.page.router_test.logic.CounterManager

<span class="hljs-keyword">class</span> <span class="hljs-title class_">RouterPageAViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-comment">// Composition: ViewModel holds the StateHolder</span>
    <span class="hljs-keyword">val</span> counterManager = CounterManager(viewModelScope)
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>ViewModel ä½¿ç”¨ <code>viewModelScope</code> ä¼ é€’ç»™ StateHolder</li>
<li>ç®€æ´æ˜äº†ï¼Œåªè´Ÿè´£æŒæœ‰å’Œç®¡ç† StateHolder</li>
<li>é¿å…è†¨èƒ€æˆ God ViewModel</li>
</ul>
<h5 data-id="heading-8">3. UI å±‚ - çŠ¶æ€å±•ç¤º</h5>
<p>åœ¨ Composable ä¸­ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">RouterPageA</span><span class="hljs-params">(navController: <span class="hljs-type">NavController</span>)</span></span> {
    <span class="hljs-comment">// å¼•å…¥ ViewModel (å®˜æ–¹æ¶æ„æ¨è)</span>
    <span class="hljs-comment">// æ­¤æ—¶ ViewModel çš„ç”Ÿå‘½å‘¨æœŸè·Ÿéš NavigationBackStackEntryï¼Œ</span>
    <span class="hljs-comment">// å³ä¾¿è·³è½¬åˆ° B é¡µé¢ï¼ŒA é¡µé¢åœ¨åå°æ ˆä¸­ï¼ŒViewModel ä¾ç„¶å­˜æ´»ï¼Œæ•°æ®ï¼ˆCountManagerï¼‰è¢«ä¿ç•™ã€‚</span>
    <span class="hljs-keyword">val</span> viewModel: RouterPageAViewModel = androidx.lifecycle.viewmodel.compose.viewModel { RouterPageAViewModel() }

    <span class="hljs-comment">// è§‚å¯Ÿ StateHolder (CounterManager) ä¸­çš„çŠ¶æ€</span>
    <span class="hljs-keyword">val</span> count <span class="hljs-keyword">by</span> viewModel.counterManager.count.collectAsState()
    <span class="hljs-keyword">val</span> isAutoIncrementing <span class="hljs-keyword">by</span> viewModel.counterManager.isAutoIncrementing.collectAsState()

    CommonPageLayout(
        title = <span class="hljs-string">"è®¡æ•°å™¨é¡µé¢A"</span>,
        navController = navController
    ) {
        Column(
            modifier = Modifier.fillMaxSize().padding(<span class="hljs-number">16.</span>dp),
            horizontalAlignment = Alignment.CenterHorizontally,
            verticalArrangement = Arrangement.Center
        ) {

            Text(
                <span class="hljs-string">"å½“å‰é¡µé¢ä½¿ç”¨ ViewModel + StateHolder (CounterManager) æ¶æ„ã€‚\n"</span> +
                        <span class="hljs-string">"è·³è½¬åˆ° B é¡µé¢åï¼ŒViewModel å­˜æ´»ï¼Œè‡ªåŠ¨è®¡æ•°å™¨ä»åœ¨åå°è¿è¡Œã€‚\n"</span> +
                        <span class="hljs-string">"è¿”å› A é¡µé¢ï¼ŒçŠ¶æ€æ— ç¼è¡”æ¥ï¼Œæ— éœ€é‡å»ºã€‚"</span>
            )

            <span class="hljs-comment">// æ˜¾ç¤ºå½“å‰è®¡æ•°</span>
            Text(
                text = <span class="hljs-string">"å½“å‰è®¡æ•°"</span>,
                style = MaterialTheme.typography.titleMedium,
                color = MaterialTheme.colorScheme.onSurface
            )

            Spacer(modifier = Modifier.height(<span class="hljs-number">16.</span>dp))

            Text(
                text = <span class="hljs-string">"<span class="hljs-variable">$count</span>"</span>,
                style = MaterialTheme.typography.displayLarge,
                color = MaterialTheme.colorScheme.primary
            )

            Spacer(modifier = Modifier.height(<span class="hljs-number">32.</span>dp))

            <span class="hljs-comment">// åŠ å‡æŒ‰é’®è¡Œ</span>
            Row(
                modifier = Modifier.fillMaxWidth(),
                horizontalArrangement = Arrangement.Center
            ) {
                Button(
                    onClick = { viewModel.counterManager.decrement() },
                    modifier = Modifier.width(<span class="hljs-number">100.</span>dp)
                ) {
                    Text(text = <span class="hljs-string">"-1"</span>, style = MaterialTheme.typography.titleMedium)
                }

                Spacer(modifier = Modifier.width(<span class="hljs-number">24.</span>dp))

                Button(
                    onClick = { viewModel.counterManager.increment() },
                    modifier = Modifier.width(<span class="hljs-number">100.</span>dp)
                ) {
                    Text(text = <span class="hljs-string">"+1"</span>, style = MaterialTheme.typography.titleMedium)
                }
            }

            Spacer(modifier = Modifier.height(<span class="hljs-number">32.</span>dp))

            <span class="hljs-comment">// è·³è½¬åˆ°Bé¡µé¢æŒ‰é’®</span>
            Button(
                onClick = {
                    navController.navigate(CmpRouter.RouterPageB.router())
                },
                modifier = Modifier.fillMaxWidth(<span class="hljs-number">0.6f</span>)
            ) {
                Text(
                    text = <span class="hljs-string">"è·³è½¬åˆ°Bé¡µé¢"</span>,
                    style = MaterialTheme.typography.titleMedium
                )
            }

            Spacer(modifier = Modifier.height(<span class="hljs-number">32.</span>dp))

            <span class="hljs-comment">// è‡ªåŠ¨è®¡æ•°åˆ‡æ¢æŒ‰é’®</span>
            Button(
                onClick = { viewModel.counterManager.toggleAutoIncrement() },
                modifier = Modifier.fillMaxWidth(<span class="hljs-number">0.6f</span>)
            ) {
                Text(
                    text = <span class="hljs-keyword">if</span> (isAutoIncrementing) <span class="hljs-string">"åœæ­¢è‡ªåŠ¨è®¡æ•°"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"å¼€å¯è‡ªåŠ¨è®¡æ•°"</span>,
                    style = MaterialTheme.typography.titleMedium
                )
            }
        }
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>viewModel()</code> å‡½æ•°è·å– ViewModel å®ä¾‹</li>
<li>é€šè¿‡ <code>collectAsState()</code> è§‚å¯Ÿ StateFlow çŠ¶æ€</li>
<li>UI å±‚ç®€æ´ï¼Œåªè´Ÿè´£å±•ç¤ºå’Œäº‹ä»¶å¤„ç†</li>
</ul>
<h3 data-id="heading-9">æ¶æ„ä¼˜åŠ¿</h3>
<h4 data-id="heading-10">1. çŠ¶æ€è‡ªåŠ¨ä¿ç•™</h4>
<p>ViewModel çš„ç”Ÿå‘½å‘¨æœŸè·Ÿéš <code>NavigationBackStackEntry</code>ï¼Œå³ä½¿é¡µé¢è·³è½¬ï¼ŒViewModel ä»ç„¶å­˜æ´»ï¼ŒStateHolder ä¸­çš„çŠ¶æ€å¾—ä»¥ä¿ç•™ã€‚è¿”å›é¡µé¢æ—¶ï¼ŒçŠ¶æ€æ— ç¼è¡”æ¥ã€‚</p>
<h4 data-id="heading-11">2. é¿å… God ViewModel</h4>
<p>å¾ˆå¤šå¼€å‘è€…æ‹…å¿ƒ ViewModel è†¨èƒ€æˆå·¨å‹ç±»ï¼Œæˆ‘ä»¬çš„è®¾è®¡é€šè¿‡ä»¥ä¸‹æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li><strong>å•ä¸€èŒè´£</strong>ï¼šViewModel åªè´Ÿè´£ç®¡ç† StateHolder çš„ç”Ÿå‘½å‘¨æœŸ</li>
<li><strong>ç»„åˆè€Œéç»§æ‰¿</strong>ï¼šé€šè¿‡ç»„åˆå¤šä¸ª StateHolder æ¥ç®¡ç†ä¸åŒé¢†åŸŸçš„ä¸šåŠ¡é€»è¾‘</li>
<li><strong>StateHolder ç‹¬ç«‹</strong>ï¼šæ¯ä¸ª StateHolder å°è£…ç‰¹å®šé¢†åŸŸçš„é€»è¾‘ï¼Œæ¸…æ™°ç‹¬ç«‹</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç¤ºä¾‹ï¼šä¸€ä¸ª ViewModel å¯ä»¥æŒæœ‰å¤šä¸ª StateHolder</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ComplexPageViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">val</span> counterManager = CounterManager(viewModelScope)
    <span class="hljs-keyword">val</span> userManager = UserManager(viewModelScope)
    <span class="hljs-keyword">val</span> networkManager = NetworkManager(viewModelScope)
    
    <span class="hljs-comment">// å¦‚æœæœ‰è·¨ StateHolder çš„ç»„åˆé€»è¾‘ï¼Œå¯ä»¥åœ¨è¿™é‡Œæä¾›</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadData</span><span class="hljs-params">()</span></span> {
        networkManager.fetch()
        userManager.updateProfile()
    }
}
</code></pre>
<h4 data-id="heading-12">3. é«˜åº¦å¯æµ‹è¯•</h4>
<ul>
<li><strong>StateHolder æ˜¯çº¯ Kotlin ç±»</strong>ï¼Œå¯ä»¥è½»æ¾è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œæ— éœ€ Android ç¯å¢ƒ</li>
<li><strong>ViewModel å’Œ UI è§£è€¦</strong>ï¼Œå¯ä»¥ç‹¬ç«‹æµ‹è¯•ä¸šåŠ¡é€»è¾‘</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// CounterManager çš„å•å…ƒæµ‹è¯•ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterManagerTest</span> {
    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> `increment should increase count`<span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">val</span> scope = TestScope()
        <span class="hljs-keyword">val</span> counterManager = CounterManager(scope)
        
        assertEquals(<span class="hljs-number">0</span>, counterManager.count.value)
        counterManager.increment()
        assertEquals(<span class="hljs-number">1</span>, counterManager.count.value)
    }
}
</code></pre>
<h4 data-id="heading-13">4. æ¸…æ™°çš„ä»£ç ç»“æ„</h4>

























<table><thead><tr><th>å±‚çº§</th><th>èŒè´£</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>UI å±‚</td><td>å±•ç¤ºç•Œé¢ï¼Œå“åº”ç”¨æˆ·æ“ä½œ</td><td>RouterPageA.kt</td></tr><tr><td>ViewModel å±‚</td><td>ç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼ŒæŒæœ‰ StateHolder</td><td>RouterPageAViewModel.kt</td></tr><tr><td>StateHolder å±‚</td><td>å°è£…ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€</td><td>CounterManager.kt</td></tr></tbody></table>
<h3 data-id="heading-14">é€‚ç”¨åœºæ™¯</h3>
<p>è¿™ç§æ¶æ„æ¨¡å¼ç‰¹åˆ«é€‚åˆï¼š</p>
<p>âœ… <strong>ä¸­å¤§å‹åº”ç”¨</strong> - æœ‰å¤æ‚ä¸šåŠ¡é€»è¾‘çš„åœºæ™¯<br/>
âœ… <strong>éœ€è¦çŠ¶æ€ä¿ç•™</strong> - é¡µé¢è·³è½¬åéœ€è¦ä¿æŒçŠ¶æ€çš„é¡µé¢<br/>
âœ… <strong>éœ€è¦é«˜åº¦å¯æµ‹è¯•</strong> - å¯¹ä»£ç è´¨é‡è¦æ±‚è¾ƒé«˜çš„é¡¹ç›®<br/>
âœ… <strong>è·¨å¹³å°é¡¹ç›®</strong> - StateHolder æ˜¯çº¯ Kotlin ä»£ç ï¼Œå¯å¤ç”¨</p>
<h3 data-id="heading-15">æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li><strong>StateHolder å‘½åè§„èŒƒ</strong>ï¼šä½¿ç”¨ <code>xxxManager</code> æˆ– <code>xxxState</code> åç¼€</li>
<li><strong>çŠ¶æ€ä½¿ç”¨ StateFlow</strong>ï¼šç¬¦åˆ Compose å“åº”å¼ç¼–ç¨‹èŒƒå¼</li>
<li><strong>ViewModel ä¿æŒè½»é‡</strong>ï¼šåªè´Ÿè´£æŒæœ‰ StateHolderï¼Œé¿å…è†¨èƒ€</li>
<li><strong>åˆç†çš„ç²’åº¦</strong>ï¼šStateHolder åº”è¯¥æ˜¯åˆç†çš„ä¸šåŠ¡è¾¹ç•Œï¼Œä¸è¦è¿‡å°ä¹Ÿä¸è¦è¿‡å¤§</li>
</ol>
<h3 data-id="heading-16">æ€»ç»“</h3>
<p>ViewModel + StateHolder æ¶æ„æ¨¡å¼æ˜¯è§£å†³ Compose é¡µé¢è·³è½¬çŠ¶æ€ä¸¢å¤±é—®é¢˜çš„ä¼˜é›…æ–¹æ¡ˆã€‚å®ƒä¸ä»…è§£å†³äº†çŠ¶æ€ä¿ç•™é—®é¢˜ï¼Œè¿˜æä¾›äº†æ¸…æ™°çš„ä»£ç ç»“æ„ã€é«˜åº¦çš„å¯æµ‹è¯•æ€§ï¼Œä»¥åŠé¿å… God ViewModel çš„æœ‰æ•ˆæ–¹å¼ã€‚</p>
<p>è¿™ç§æ¨¡å¼ç¬¦åˆ Google å®˜æ–¹çš„æ¶æ„æŒ‡å¯¼åŸåˆ™ï¼ŒåŒæ—¶åœ¨å®é™…é¡¹ç›®ä¸­å…·æœ‰å¾ˆé«˜çš„å®ç”¨ä»·å€¼ã€‚å¦‚æœä½ çš„åº”ç”¨éœ€è¦å¤„ç†å¤æ‚çš„é¡µé¢çŠ¶æ€ï¼Œå¼ºçƒˆæ¨èå°è¯•è¿™ç§æ¶æ„ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[BFF ä¸ Next.js çš„è”ç³»ä¸ç»„åˆ]]></title>    <link>https://juejin.cn/post/7602837527674273807</link>    <guid>https://juejin.cn/post/7602837527674273807</guid>    <pubDate>2026-02-04T17:13:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602837527674273807" data-draft-id="7602825342228135970" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="BFF ä¸ Next.js çš„è”ç³»ä¸ç»„åˆ"/> <meta itemprop="keywords" content="å‰ç«¯,Next.js"/> <meta itemprop="datePublished" content="2026-02-04T17:13:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="codingWhat"/> <meta itemprop="url" content="https://juejin.cn/user/2189882895642728"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            BFF ä¸ Next.js çš„è”ç³»ä¸ç»„åˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2189882895642728/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    codingWhat
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T17:13:59.000Z" title="Wed Feb 04 2026 17:13:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><em>æœ€è¿‘åœ¨å†™ä¸€ä¸ªNext.jsçš„åº”ç”¨ï¼Œå…¶ä¸­API Routesè¢«æˆ‘å½“åšè½»é‡BFFï¼Œå»åšä¸€äº›æ•°æ®åŠ å·¥ä¸å¤„ç†ï¼Œé‚£ä¹ˆBFF ä¸ Next.jsåˆ°åº•æœ‰ä»€ä¹ˆæ ·çš„è”ç³»å‘¢ï¼Ÿ</em></h2>
<h2 data-id="heading-1">ä¸€ã€æ¦‚å¿µå…ˆå˜æ¸…</h2>
<h3 data-id="heading-2">1. BFFï¼ˆBackend for Frontendï¼‰</h3>
<p>BFF æ˜¯<strong>ä¸ºå‰ç«¯ä¸“é—¨æä¾›çš„ä¸€å±‚åç«¯</strong>ï¼ŒèŒè´£åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ¥å£èšåˆ</strong>ï¼šæŠŠå¤šä¸ªåç«¯/å¾®æœåŠ¡çš„è°ƒç”¨åˆå¹¶æˆå‰ç«¯éœ€è¦çš„å°‘æ•°æ¥å£ã€‚</li>
<li><strong>æ•°æ®è£å‰ªä¸é€‚é…</strong>ï¼šæŠŠåç«¯ DTO è½¬æˆå‰ç«¯éœ€è¦çš„ç»“æ„ï¼Œå‡å°‘å­—æ®µã€æ”¹åã€æ‰å¹³åŒ–ç­‰ã€‚</li>
<li><strong>é‰´æƒä¸ä¼šè¯</strong>ï¼šåœ¨ BFF ç»Ÿä¸€åšç™»å½•æ€æ ¡éªŒã€æƒé™æ ¡éªŒï¼Œå‰ç«¯åªå…³å¿ƒã€Œè°ƒä¸€ä¸ªæ¥å£ã€ã€‚</li>
<li><strong>åè®®ä¸å½¢æ€ç»Ÿä¸€</strong>ï¼šå‰ç«¯åªå’Œ BFF ç”¨ REST/JSON ç­‰çº¦å®šå¥½çš„æ–¹å¼é€šä¿¡ï¼Œä¸ç›´æ¥é¢å¯¹å†…éƒ¨ RPCã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ã€‚</li>
</ul>
<p>BFF <strong>ä¸è´Ÿè´£ HTML æ¸²æŸ“</strong>ï¼Œåªè´Ÿè´£ã€Œç»™å‰ç«¯æä¾›æ•°æ®æ¥å£ã€ã€‚</p>
<h3 data-id="heading-3">2. Next.js ä¸ SSR</h3>
<p>Next.js æ˜¯ä¸€ä¸ª <strong>React å…¨æ ˆæ¡†æ¶</strong>ï¼Œé™¤äº†åšå‰ç«¯ SPAï¼Œè¿˜æä¾›ï¼š</p>
<ul>
<li><strong>æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰</strong>ï¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ Reactï¼Œç”Ÿæˆ HTML å†è¿”å›ç»™æµè§ˆå™¨ï¼Œé¦–å±å³å®Œæ•´å†…å®¹ï¼Œåˆ©äº SEO å’Œé¦–å±æ€§èƒ½ã€‚</li>
<li><strong>API Routes</strong>ï¼šåœ¨ <code>pages/api</code> ä¸‹å†™æ¥å£ï¼Œè¿è¡Œåœ¨ Node é‡Œï¼Œå¯¹å¤–æä¾› HTTP APIï¼Œå¯å½“ã€Œå°åç«¯ã€ç”¨ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼š</p>
<ul>
<li><strong>SSR</strong> è§£å†³çš„æ˜¯ã€Œè°åœ¨å“ªå„¿æŠŠé¡µé¢æ¸²æŸ“å‡ºæ¥ã€çš„é—®é¢˜ï¼ˆæœåŠ¡å™¨æ¸²æŸ“ vs æµè§ˆå™¨æ¸²æŸ“ï¼‰ã€‚</li>
<li><strong>BFF</strong> è§£å†³çš„æ˜¯ã€Œè°ç»™å‰ç«¯æä¾›æ¥å£ã€æ€ä¹ˆèšåˆä¸é€‚é…ã€çš„é—®é¢˜ã€‚</li>
</ul>
<p>äºŒè€…ä¸€ä¸ªåã€Œæ¸²æŸ“ä¸é¡µé¢ã€ï¼Œä¸€ä¸ªåã€Œæ¥å£ä¸æ•°æ®ã€ï¼Œå¯ä»¥å•ç‹¬ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸€èµ·ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-4">äºŒã€Aé¡¹ç›®ä¸­çš„ BFF å±‚ï¼š</h2>
<p>åœ¨æˆ‘ä»¬å·¥ä½œä¸­ï¼Œå‰ç«¯ä½¿ç”¨çš„æ¥å£ç”±JAVAç¼–å†™çš„BFFåˆ†å±‚åº”ç”¨æä¾›ï¼Œåœ¨åˆ†å±‚åº”ç”¨ä¸­å»è°ƒç”¨çœŸæ­£çš„å†…ç½‘æ¥å£ã€‚</p>
<h3 data-id="heading-5">2.1 æ¶æ„æ¦‚è§ˆ</h3>
<ul>
<li><strong>Web å±‚</strong>ï¼šController æš´éœ² HTTP æ¥å£ï¼Œè·¯å¾„å¤šä¸º <code>/xxx/api</code>ã€‚</li>
<li><strong>Service å±‚</strong>ï¼šFacade å°è£…å¯¹ä¸‹æ¸¸ä¸šåŠ¡æœåŠ¡çš„è°ƒç”¨ã€‚</li>
</ul>
<p>å‰ç«¯/ç§»åŠ¨ç«¯åªè®¤ BFF çš„ URLï¼Œä¸ç›´æ¥è°ƒä¸šåŠ¡ä¸­å°ã€‚</p>
<h3 data-id="heading-6">2.2 Controllerï¼šé¢å‘å‰ç«¯çš„æ¥å£ä¸é‰´æƒ</h3>
<p>ä»¥xxxç”³æŠ¥è®°å½•æŸ¥è¯¢ä¸ºä¾‹ï¼ˆ<code>MobilexxxController</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Controller</span>
<span class="hljs-meta">@RequestMapping("/xxx/xxxx/api")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MobilexxxController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">MobilexxxBaseController</span> {

    <span class="hljs-meta">@RequestMapping(value = "/query", method = RequestMethod.POST)</span>
    <span class="hljs-meta">@ResponseBody</span>
    <span class="hljs-keyword">public</span> MobilexxxDTO&lt;Object&gt; <span class="hljs-title function_">query</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> MobileuxxDTO&lt;ZxxxRequestDTO&gt; requestDTO)</span> {
        <span class="hljs-comment">// 1. è·å–ç”¨æˆ·è´¦æˆ·ä¿¡æ¯</span>
        <span class="hljs-type">AccountDTO</span> <span class="hljs-variable">accountDTO</span> <span class="hljs-operator">=</span> getAccount();
        <span class="hljs-comment">// 2. éªŒè¯ç”¨æˆ·ä¼šè¯ï¼ˆBFF ç»Ÿä¸€é‰´æƒï¼‰</span>
        validateHelper.accountSessionCheck(accountDTO, ...);
        <span class="hljs-comment">// 3. ä»ç»Ÿä¸€å…¥å‚ä¸­å–å‡ºä¸šåŠ¡æ•°æ®ï¼Œå¹¶æ³¨å…¥ç”¨æˆ·ä¿¡æ¯</span>
        <span class="hljs-type">ZxxxRequestDTO</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> requestDTO.getData();
        request.setXm(accountDTO.getAccount().getName());
        <span class="hljs-comment">// ...</span>
        <span class="hljs-comment">// 4. è°ƒç”¨ Facadeï¼Œå†ç»Ÿä¸€å°è£…è¿”å›æ ¼å¼</span>
        Response&lt;List&lt;ZxxxResponseDTO&gt;&gt; response = mobilexxxFacade.query(request);
        <span class="hljs-keyword">return</span> ResponseHandler.procResponseResult(response);
    }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ° BFF åœ¨è¿™é‡Œåšäº†ï¼š</p>
<ul>
<li><strong>ç»Ÿä¸€å…¥å‚/å‡ºå‚</strong>ï¼š<code>MobilexxxDTO</code> / <code>MobileuxxDTO</code>ï¼Œå‰ç«¯åªé¢å¯¹ä¸€ç§è¯·æ±‚/å“åº”å½¢æ€ã€‚</li>
<li><strong>ä¼šè¯ä¸é‰´æƒ</strong>ï¼š<code>getAccount()</code>ã€<code>validateHelper.accountSessionCheck()</code> åœ¨ BFF å®Œæˆï¼Œå‰ç«¯æ— æ„ŸçŸ¥ã€‚</li>
<li><strong>æ•°æ®æ³¨å…¥</strong>ï¼šæŠŠå½“å‰ç”¨æˆ·å§“åã€è¯ä»¶å·ç­‰å†™å…¥è¯·æ±‚å†äº¤ç»™ä¸‹æ¸¸ï¼Œå‰ç«¯ä¸ç”¨ä¼ æ•æ„Ÿä¿¡æ¯ã€‚</li>
</ul>
<h3 data-id="heading-7">2.3 Facadeï¼šèšåˆä¸‹æ¸¸æœåŠ¡</h3>
<p>Facade ä¸å®ç°ä¸šåŠ¡ï¼Œåªåšã€Œè½¬å‘ + èšåˆã€ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MobilexxxFacade</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RestfulClient restfulClient;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RestfulUrlHelper restfulUrlHelper;

    <span class="hljs-keyword">public</span> Response&lt;List&lt;ZxxResponseDTO&gt;&gt; <span class="hljs-title function_">query</span><span class="hljs-params">(ZxxRequestDTO request)</span> {
        <span class="hljs-keyword">return</span> restfulClient.postForJson(
            restfulUrlHelper.getxxxnwUrl(<span class="hljs-string">"xxxx/query"</span>),
            request, Response.class, List.class, ZxxResponseDTO.class);
    }
}
</code></pre>
<p>å…¶ä»– FacadeåŒç†ï¼šBFF é€šè¿‡ RestfulClient è°ƒè¿œç«¯æœåŠ¡ï¼Œå¯¹å‰ç«¯åªæš´éœ²ã€Œä¸€ä¸ªæ¥å£ã€ä¸€ç§åè®®ã€ã€‚</p>
<p>å°ç»“ï¼š<strong>app è¿™ä¸€å±‚æ˜¯å…¸å‹çš„ BFF</strong>â€”â€”ç‹¬ç«‹éƒ¨ç½²çš„ Java æœåŠ¡ï¼Œåªæä¾› APIï¼Œä¸è´Ÿè´£é¡µé¢æ¸²æŸ“ï¼›èŒè´£æ˜¯é‰´æƒã€èšåˆã€é€‚é…ï¼Œæ–¹ä¾¿å‰ç«¯/ç§»åŠ¨ç«¯è°ƒç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€Bé¡¹ç›®ä¸­çš„ Next.js ä¸ SSRï¼š</h2>
<p><strong>xxx-Next</strong> æ˜¯ Next.js åº”ç”¨ï¼ŒåŒæ—¶ç”¨åˆ°äº† <strong>SSR</strong> å’Œ <strong>API Routesï¼ˆå……å½“è½»é‡ BFFï¼‰</strong>ã€‚</p>
<h3 data-id="heading-9">3.1 SSRï¼šé¦–å±æœåŠ¡ç«¯å–æ•°ä¸æ¸²æŸ“</h3>
<p>ä½¿ç”¨ <code>getServerSideProps</code> <strong>æ¯æ¬¡è¯·æ±‚æ—¶</strong>åœ¨æœåŠ¡ç«¯æ‹‰å–æ•°æ®å¹¶æ¸²æŸ“ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">GetData</span>(<span class="hljs-params">props: PropsType</span>) {
  <span class="hljs-keyword">const</span> { err, data, msg = <span class="hljs-string">''</span> } = props
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">return</span> (
    <span class="hljs-comment">// ...</span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getServerSideProps</span>(<span class="hljs-params">context: <span class="hljs-built_in">any</span></span>) {
  <span class="hljs-keyword">const</span> { id = <span class="hljs-string">''</span> } = context.<span class="hljs-property">params</span>
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getDataById</span>(id)  <span class="hljs-comment">// æœåŠ¡ç«¯è¯·æ±‚æ¥å£</span>
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">props</span>: data }
}
</code></pre>
<p>æµç¨‹æ˜¯ï¼š</p>
<ol>
<li>ç”¨æˆ·è¯·æ±‚ <code>/data/xxx</code>;</li>
<li>Next åœ¨æœåŠ¡å™¨æ‰§è¡Œ <code>getServerSideProps</code>ï¼Œè°ƒç”¨ <code>getDataById(id)</code>;</li>
<li>æ‹¿åˆ°æ•°æ®åï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ¸²æŸ“ Reactï¼Œå¾—åˆ° HTML;</li>
<li>æŠŠ HTML å’Œåºåˆ—åŒ–å¥½çš„ <code>props</code> ä¸€èµ·è¿”å›ç»™æµè§ˆå™¨;</li>
</ol>
<p>è¿™æ ·é¦–å±å°±æ˜¯ã€Œå¸¦æ•°æ®çš„å®Œæ•´ HTMLã€ï¼Œæ— éœ€ç­‰å®¢æˆ·ç«¯å†å‘è¯·æ±‚æ‰å‡ºå†…å®¹ï¼Œè¿™å°±æ˜¯ <strong>SSR</strong>ã€‚è¿™é‡Œ Next.js çš„è§’è‰²æ˜¯ã€Œæ¸²æŸ“å±‚ + åœ¨æœåŠ¡ç«¯å‘èµ·æ•°æ®è¯·æ±‚ã€ï¼Œæ•°æ®æ¥æºä¹Ÿå¯ä»¥æ¢æˆè°ƒç”¨ä¸Šé¢é‚£å¥— Java BFFã€‚</p>
<h3 data-id="heading-10">3.2 API Routesï¼š"è–„" BFF</h3>
<p>ç‚¹å‡»æäº¤æŒ‰é’®æ—¶ï¼ŒæŒ‡å‘çš„æ˜¯ Next è‡ªå·±çš„æ¥å£ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handler</span>(<span class="hljs-params">req: NextApiRequest, res: NextApiResponse</span>) {
  <span class="hljs-comment">// æ•°æ®åŠ å·¥</span>
  <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">genData</span>(req.<span class="hljs-property">body</span>)  <span class="hljs-comment">// æŠŠè¡¨å• body è½¬æˆåç«¯éœ€è¦çš„ç»“æ„</span>
  <span class="hljs-keyword">const</span> resData = <span class="hljs-keyword">await</span> <span class="hljs-title function_">postData</span>(data)
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>è¿™é‡Œ Next.js çš„ API Route åšçš„æ˜¯ï¼š</p>
<ul>
<li><strong>æ¥æ”¶</strong>ï¼š ä¼ å…¥çš„æ•°æ®ï¼Œå¦‚è¡¨å•æ•°æ®ï¼›</li>
<li><strong>è½¬æ¢</strong>ï¼š<code>genData(req.body)</code> æŠŠè¡¨å•å­—æ®µæ•´ç†æˆæ¥å£éœ€è¦çš„ç»“æ„ï¼›</li>
<li><strong>è½¬å‘</strong>ï¼š<code>postData(data)</code> å†è¯·æ±‚çœŸæ­£çš„åç«¯ã€‚</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>API Route åœ¨è¿™é‡Œæ‰®æ¼”äº†ä¸€å±‚è–„ BFF</strong>ï¼šå¯¹å‰ç«¯æš´éœ²ç®€å•çš„ä¸€ä¸ª POST <code>/api/data</code>ï¼Œå†…éƒ¨åšå‚æ•°é€‚é…å’Œè½¬å‘ï¼Œå‰ç«¯ä¸ç›´æ¥è°ƒå¤–éƒ¨åç«¯ã€‚</p>
<h3 data-id="heading-11">3.3 æ•°æ®æµå°ç»“</h3>
<ul>
<li><strong>è¯»</strong>ï¼šæµè§ˆå™¨ â†’ Next æœåŠ¡ç«¯ â†’ <code>getServerSideProps</code> é‡Œ <code>getDataById</code> â†’ å¤–éƒ¨æ¥å£â†’ æœåŠ¡ç«¯æ¸²æŸ“ HTML â†’ è¿”å›ã€‚</li>
<li><strong>å†™</strong>ï¼šæµè§ˆå™¨ POST åˆ° Next çš„ <code>/api/data</code> â†’ API Route æ•´ç†å‚æ•°å¹¶ <code>postData()</code> â†’ å†è¯·æ±‚åç«¯â†’ æ ¹æ®ç»“æœå¤„ç†ã€‚</li>
</ul>
<p>SSR è§£å†³ã€Œä»å“ªæ‹¿æ•°æ®ã€åœ¨å“ªæ¸²æŸ“ã€ï¼›API Route è§£å†³ã€Œæäº¤æ—¶è°æ¥åšå‚æ•°è½¬æ¢å’Œè½¬å‘ã€ã€‚ä¸¤è€…éƒ½åœ¨ Next é‡Œï¼Œä½†èŒè´£ä¸åŒã€‚</p>
<hr/>
<h2 data-id="heading-12">å››ã€BFF ä¸ Next.jsï¼ˆSSRï¼‰çš„åŒºåˆ«</h2>








































<table><thead><tr><th>ç»´åº¦</th><th>BFFï¼ˆå¦‚ app ä¸­çš„ Java å±‚ï¼‰</th><th>Next.jsï¼ˆSSR + API Routesï¼‰</th></tr></thead><tbody><tr><td><strong>ä¸»è¦èŒè´£</strong></td><td>ä¸ºå‰ç«¯æä¾›èšåˆ/é€‚é…åçš„ API</td><td>æ¸²æŸ“ HTML é¡µé¢ + å¯é€‰çš„ API ç«¯ç‚¹</td></tr><tr><td><strong>æ˜¯å¦æ¸²æŸ“</strong></td><td>ä¸æ¸²æŸ“ï¼Œåªè¿”å› JSON ç­‰æ•°æ®</td><td>æœåŠ¡ç«¯æ‰§è¡Œ Reactï¼Œè¾“å‡º HTML</td></tr><tr><td><strong>å…¸å‹éƒ¨ç½²</strong></td><td>ç‹¬ç«‹æœåŠ¡ï¼ˆå¦‚ Java è¿›ç¨‹ã€å®¹å™¨ï¼‰</td><td>Node è¿›ç¨‹ï¼ŒåŒä¸€åº”ç”¨é‡Œæ—¢æœ‰é¡µé¢ä¹Ÿæœ‰ API</td></tr><tr><td><strong>æŠ€æœ¯æ ˆ</strong></td><td>ä»»æ„åç«¯è¯­è¨€ï¼ˆæœ¬é¡¹ç›®ä¸º Javaï¼‰</td><td>Node + Reactï¼ˆNext.jsï¼‰</td></tr><tr><td><strong>é‰´æƒä½ç½®</strong></td><td>å¸¸åœ¨ BFF ç»Ÿä¸€åš</td><td>å¯åœ¨ API Route æˆ– getServerSideProps é‡Œåš</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å¤šç«¯å¤ç”¨åŒä¸€å¥—æ¥å£ã€å¤šåç«¯èšåˆ</td><td>éœ€è¦ SEOã€é¦–å±æ€§èƒ½çš„å‰ç«¯åº”ç”¨</td></tr></tbody></table>
<p>ç®€è¨€ä¹‹ï¼š<strong>BFF æ˜¯ã€Œä¸“é—¨ç»™å‰ç«¯çš„æ¥å£å±‚ã€ï¼›Next.js SSR æ˜¯ã€Œåœ¨æœåŠ¡å™¨ä¸ŠæŠŠé¡µé¢æ¸²æŸ“å‡ºæ¥çš„æ–¹å¼ã€</strong>ã€‚ä¸€ä¸ªåæ•°æ®ä¸æ¥å£ï¼Œä¸€ä¸ªåé¡µé¢ä¸æ¸²æŸ“ã€‚</p>
<hr/>
<h2 data-id="heading-13">äº”ã€BFF ä¸ Next.js çš„è”ç³»ä¸ç»„åˆ</h2>
<ol>
<li>
<p><strong>Next.js API Routes æœ¬èº«å¯ä»¥å½“ä½œè½»é‡ BFF</strong><br/>
å¦‚ xxx-Next çš„ <code>/api/data</code>ï¼šæ¥æ”¶æ•´ç†å‚æ•°ï¼Œå†è°ƒåç«¯ã€‚é€‚åˆé€»è¾‘ç®€å•ã€ä¸éœ€è¦å¤šè¯­è¨€/å¤šåç«¯èšåˆçš„åœºæ™¯ã€‚</p>
</li>
<li>
<p><strong>Next.js çš„ SSR å¯ä»¥æ¶ˆè´¹ BFF</strong><br/>
åœ¨ <code>getServerSideProps</code> æˆ– <code>getStaticProps</code> é‡Œï¼Œç”¨ <code>getDataById</code> è¿™ç±»å‡½æ•°å»è¯·æ±‚ã€ŒçœŸæ­£çš„ BFFã€ï¼ˆä¾‹å¦‚ app é‡Œçš„ <code>xxx/xxx/api</code>ï¼‰ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒä¸šåŠ¡ä¸­å°ã€‚è¿™æ ·ï¼š</p>
<ul>
<li>é‰´æƒã€èšåˆåœ¨ BFF å®Œæˆï¼›</li>
<li>Next åªè´Ÿè´£ã€Œè¦ä»€ä¹ˆæ•°æ®ã€æ€ä¹ˆæ¸²æŸ“ã€ï¼ŒèŒè´£æ¸…æ™°ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç»„åˆæ–¹å¼ç¤ºä¾‹</strong></p>
<ul>
<li>æŠŠ xxx-Next é‡Œ <code>ajax.ts</code> çš„ <code>HOST</code> æˆ– <code>getDataById</code> çš„ URL æŒ‡å‘ app çš„ BFF åœ°å€ï¼Œæ•°æ®å°±ä» Java BFF æ¥ã€‚</li>
<li>æäº¤ä»å¯å…ˆåˆ° Next çš„ <code>/api/data</code>ï¼Œå†ç”± API Route è°ƒ BFF çš„æäº¤æ¥å£ï¼Œè¿™æ ·å‰ç«¯åªå’Œ Next æ‰“äº¤é“ï¼ŒBFF ç”± Next åœ¨æœåŠ¡ç«¯/API é‡Œè°ƒç”¨ã€‚</li>
</ul>
</li>
</ol>
<p>äºæ˜¯å¯ä»¥å½¢æˆï¼š<strong>æµè§ˆå™¨ â†” Next.jsï¼ˆSSR + API Routesï¼‰â†” BFFï¼ˆappï¼‰â†” ä¸šåŠ¡æœåŠ¡</strong>ã€‚BFF ç®¡ã€Œæ¥å£ä¸æ•°æ®ã€ï¼ŒNext ç®¡ã€Œé¡µé¢ä¸ä¸€æ¬¡è½¬å‘/é€‚é…ã€ã€‚</p>
<hr/>
<h2 data-id="heading-14">å…­ã€æ€»ç»“</h2>
<ul>
<li><strong>BFF</strong>ï¼šé¢å‘å‰ç«¯çš„æ¥å£å±‚ï¼Œåšèšåˆã€é€‚é…ã€é‰´æƒï¼Œä¸è´Ÿè´£æ¸²æŸ“ï¼›æœ¬é¡¹ç›®ä¸­ <strong>app</strong> çš„ Controller + Facade æ˜¯å…¸å‹å®ç°ã€‚</li>
<li><strong>Next.js SSR</strong>ï¼šåœ¨æœåŠ¡ç«¯æŒ‰è¯·æ±‚æ‹‰æ•°æ®å¹¶æ¸²æŸ“ React æˆ HTMLï¼Œé¦–å±å¿«ã€åˆ©äº SEOï¼›<strong>xxx-Next</strong> çš„ <code>getServerSideProps</code> å°±æ˜¯ SSRã€‚</li>
<li><strong>åŒºåˆ«</strong>ï¼šBFF æ˜¯ã€Œæ¥å£å±‚ã€ï¼ŒNext.jsï¼ˆSSRï¼‰æ˜¯ã€Œæ¸²æŸ“æ–¹å¼ã€ï¼›BFF å¯ç‹¬ç«‹äºå‰ç«¯æŠ€æœ¯æ ˆéƒ¨ç½²ï¼ŒNext æ˜¯å‰ç«¯æ¡†æ¶è‡ªå¸¦æœåŠ¡ç«¯èƒ½åŠ›ã€‚</li>
<li><strong>è”ç³»</strong>ï¼šNext çš„ API Routes å¯å½“è–„ BFF ç”¨ï¼›SSR çš„æ•°æ®æ¥æºå¯ä»¥ã€ä¹Ÿé€‚åˆæ¥è‡ª BFFï¼›äºŒè€…ç»„åˆèƒ½åŒæ—¶è·å¾—ã€Œæ¸…æ™°çš„æ•°æ®æ¥å£å±‚ã€å’Œã€Œæ›´å¥½çš„é¦–å±ä¸ SEOã€ã€‚</li>
</ul>
<p>ç»“åˆé¡¹ç›®ï¼š<strong>app è´Ÿè´£ã€Œç»™å‰ç«¯/ç§»åŠ¨ç«¯æä¾›ç»Ÿä¸€ã€å®‰å…¨ã€å¥½ç”¨çš„ APIã€ï¼›xxx-Next è´Ÿè´£ã€Œç”¨ Next.js æŠŠé¡µé¢åšå‡ºæ¥ï¼ˆSSRï¼‰ï¼Œå¹¶ç”¨ API Route åšæäº¤æ—¶çš„è–„ BFFã€</strong>ã€‚ç†è§£è¿™ä¸€ç‚¹ï¼Œå°±èƒ½åœ¨æ¶æ„ä¸Šåˆ†æ¸… BFF ä¸ Next.jsï¼ˆSSRï¼‰å„è‡ªè§£å†³ä»€ä¹ˆé—®é¢˜ã€å¦‚ä½•é…åˆä½¿ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ConnectivityServiceæ¡†æ¶]]></title>    <link>https://juejin.cn/post/7602825342228889634</link>    <guid>https://juejin.cn/post/7602825342228889634</guid>    <pubDate>2026-02-05T02:42:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602825342228889634" data-draft-id="7602837527674961935" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ConnectivityServiceæ¡†æ¶"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-05T02:42:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·341408199125"/> <meta itemprop="url" content="https://juejin.cn/user/570004686782272"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ConnectivityServiceæ¡†æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/570004686782272/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·341408199125
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:42:54.000Z" title="Thu Feb 05 2026 02:42:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ConnectivityService æ¡†æ¶è¯¦è§£</h2>
<p>ConnectivityService æ˜¯ Android ç½‘ç»œæ¶æ„çš„<strong>ä¸­å¤®ç®¡ç†è€…</strong>ï¼Œè´Ÿè´£åè°ƒæ‰€æœ‰ç½‘ç»œè¿æ¥å’Œè¯·æ±‚ã€‚è®©æˆ‘è¯¦ç»†è§£æå®ƒçš„æ¡†æ¶ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€æ ¸å¿ƒèŒè´£</h3>
<pre><code class="hljs language-105:116:packages_modules_Connectivity/framework/src/android/net/ConnectivityManager.java" lang="105:116:packages_modules_Connectivity/framework/src/android/net/ConnectivityManager.java"> * The primary responsibilities of this class are to:
 * &lt;ol&gt;
 * &lt;li&gt;Monitor network connections (Wi-Fi, GPRS, UMTS, etc.)&lt;/li&gt;
 * &lt;li&gt;Send broadcast intents when network connectivity changes&lt;/li&gt;
 * &lt;li&gt;Attempt to "fail over" to another network when connectivity to a network
 * is lost&lt;/li&gt;
 * &lt;li&gt;Provide an API that allows applications to query the coarse-grained or fine-grained
 * state of the available networks&lt;/li&gt;
 * &lt;li&gt;Provide an API that allows applications to request and select networks for their data
 * traffic&lt;/li&gt;
 * &lt;/ol&gt;
 */
</code></pre>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒæ•°æ®ç»“æ„</h3>
<h4 data-id="heading-3">1. <strong>NetworkAgentInfo é›†åˆ</strong> - ç®¡ç†æ‰€æœ‰ç½‘ç»œ</h4>
<pre><code class="hljs language-8546:8548:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java" lang="8546:8548:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java">// Tracks all NetworkAgents that are currently registered.
// NOTE: Only should be accessed on ConnectivityServiceThread, except dump().
private final ArraySet&lt;NetworkAgentInfo&gt; mNetworkAgentInfos = new ArraySet&lt;&gt;();
</code></pre>
<ul>
<li>å­˜å‚¨æ‰€æœ‰å·²æ³¨å†Œçš„ç½‘ç»œï¼ˆWiFiã€Cellularã€Ethernetç­‰ï¼‰</li>
<li>æ¯ä¸ª <code>NetworkAgentInfo</code> ä»£è¡¨ä¸€ä¸ªç‰©ç†æˆ–è™šæ‹Ÿç½‘ç»œ</li>
<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šä»…åœ¨ ConnectivityService çº¿ç¨‹è®¿é—®</li>
</ul>
<h4 data-id="heading-4">2. <strong>NetworkRequest æ˜ å°„</strong> - ç®¡ç†æ‰€æœ‰ç½‘ç»œè¯·æ±‚</h4>
<pre><code class="hljs language-7504:7504:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java" lang="7504:7504:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java">private final HashMap&lt;NetworkRequest, NetworkRequestInfo&gt; mNetworkRequests = new HashMap&lt;&gt;();
</code></pre>
<ul>
<li>å­˜å‚¨æ‰€æœ‰åº”ç”¨å’Œç³»ç»Ÿçš„ç½‘ç»œè¯·æ±‚</li>
<li>Key: <code>NetworkRequest</code> - è¯·æ±‚æœ¬èº«</li>
<li>Value: <code>NetworkRequestInfo</code> - è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯å’Œæ»¡è¶³çŠ¶æ€</li>
</ul>
<h3 data-id="heading-5">ä¸‰ã€NetworkAgent æ³¨å†Œæµç¨‹</h3>
<pre><code class="hljs language-740:776:packages_modules_Connectivity/framework/src/android/net/NetworkAgent.java" lang="740:776:packages_modules_Connectivity/framework/src/android/net/NetworkAgent.java">    /**
     * Register this network agent with ConnectivityService.
     *
     * This method can only be called once per network agent.
     *
     * @return the Network associated with this network agent (which can also be obtained later
     *         by calling getNetwork() on this agent).
     * @throws IllegalStateException thrown by the system server if this network agent is
     *         already registered.
     */
    @NonNull
    public Network register() {
        if (VDBG) log("Registering NetworkAgent");
        synchronized (mRegisterLock) {
            if (mNetwork != null) {
                throw new IllegalStateException("Agent already registered");
            }
            final ConnectivityManager cm = (ConnectivityManager) mInitialConfiguration.context
                    .getSystemService(Context.CONNECTIVITY_SERVICE);
            if (mInitialConfiguration.localNetworkConfig == null) {
                // Call registerNetworkAgent without localNetworkConfig argument to pass
                // android.net.cts.NetworkAgentTest#testAgentStartsInConnecting in old cts
                mNetwork = cm.registerNetworkAgent(new NetworkAgentBinder(mHandler),
                        new NetworkInfo(mInitialConfiguration.info),
                        mInitialConfiguration.properties, mInitialConfiguration.capabilities,
                        mInitialConfiguration.score, mInitialConfiguration.config, providerId);
            } else {
                mNetwork = cm.registerNetworkAgent(new NetworkAgentBinder(mHandler),
                        new NetworkInfo(mInitialConfiguration.info),
                        mInitialConfiguration.properties, mInitialConfiguration.capabilities,
                        mInitialConfiguration.localNetworkConfig, mInitialConfiguration.score,
                        mInitialConfiguration.config, providerId);
            }
            mInitialConfiguration = null; // All this memory can now be GC'd
        }
        return mNetwork;
    }
</code></pre>
<p><strong>æ³¨å†Œæµç¨‹</strong>ï¼š</p>
<ol>
<li>NetworkAgent è°ƒç”¨ <code>register()</code></li>
<li>é€šè¿‡ ConnectivityManager è°ƒç”¨ <code>registerNetworkAgent()</code></li>
<li>ConnectivityService åˆ›å»º <code>NetworkAgentInfo</code></li>
<li>æ·»åŠ åˆ° <code>mNetworkAgentInfos</code> é›†åˆ</li>
<li>è§¦å‘ç½‘ç»œé‡æ–°åŒ¹é… (<code>rematch</code>)</li>
</ol>
<h3 data-id="heading-6">å››ã€ç½‘ç»œè¯·æ±‚å¤„ç†</h3>
<h4 data-id="heading-7">1. <strong>è¯·æ±‚æ³¨å†Œ</strong></h4>
<pre><code class="hljs language-5683:5723:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java" lang="5683:5723:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java">    private void handleRegisterNetworkRequest(@NonNull final NetworkRequestInfo nri) {
        handleRegisterNetworkRequests(Collections.singleton(nri));
    }

    private void handleRegisterNetworkRequests(@NonNull final Set&lt;NetworkRequestInfo&gt; nris) {
        ensureRunningOnConnectivityServiceThread();
        for (final NetworkRequestInfo nri : nris) {
            mNetworkRequestInfoLogs.log("REGISTER " + nri);
            checkNrisConsistency(nri);
            for (final NetworkRequest req : nri.mRequests) {
                mNetworkRequests.put(req, nri);
                // TODO: Consider update signal strength for other types.
                if (req.isListen()) {
                    for (final NetworkAgentInfo network : mNetworkAgentInfos) {
                        if (req.networkCapabilities.hasSignalStrength()
                                &amp;&amp; network.satisfiesImmutableCapabilitiesOf(req)) {
                            updateSignalStrengthThresholds(network, "REGISTER", req);
                        }
                    }
                } else if (req.isRequest() &amp;&amp; mNetworkRequestStateStatsMetrics != null) {
                    mNetworkRequestStateStatsMetrics.onNetworkRequestReceived(req);
                }
            }

            // If this NRI has a satisfier already, it is replacing an older request that
            // has been removed. Track it.
            final NetworkRequest activeRequest = nri.getActiveRequest();
            if (null != activeRequest) {
                // If there is an active request, then for sure there is a satisfier.
                nri.getSatisfier().addRequest(activeRequest);
            }

            if (shouldTrackUidsForBlockedStatusCallbacks()
                    &amp;&amp; isAppRequest(nri)
                    &amp;&amp; !nri.mUidTrackedForBlockedStatus) {
                Log.wtf(TAG, "Registered nri is not tracked for sending blocked status: " + nri);
            }
        }

        if (mFlags.noRematchAllRequestsOnRegister()) {
            rematchNetworksAndRequests(nris);
</code></pre>
<h4 data-id="heading-8">2. <strong>ç½‘ç»œè¯·æ±‚ç±»å‹</strong></h4>
<pre><code class="hljs language-7976:8008:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java" lang="7976:8008:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java">        switch (reqType) {
            case TRACK_DEFAULT:
                // If the request type is TRACK_DEFAULT, the passed {@code networkCapabilities}
                // is unused and will be replaced by ones appropriate for the UID (usually, the
                // calling app). This allows callers to keep track of the default network.
                networkCapabilities = copyDefaultNetworkCapabilitiesForUid(
                        defaultNc, asUid, callingUid, callingPackageName);
                enforceAccessPermission();
                break;
            case TRACK_SYSTEM_DEFAULT:
                enforceSettingsOrSetupWizardOrUseRestrictedNetworksPermission();
                networkCapabilities = new NetworkCapabilities(defaultNc);
                break;
            case BACKGROUND_REQUEST:
                enforceNetworkStackOrSettingsPermission();
                // Fall-through since other checks are the same with normal requests.
            case REQUEST:
                networkCapabilities = new NetworkCapabilities(networkCapabilities);
                enforceNetworkRequestPermissions(networkCapabilities, callingPackageName,
                        callingAttributionTag, callingUid);
                // TODO: this is incorrect. We mark the request as metered or not depending on
                //  the state of the app when the request is filed, but we never change the
                //  request if the app changes network state. http://b/29964605
                enforceMeteredApnPolicy(networkCapabilities);
                maybeDisableLocalNetworkMatching(networkCapabilities, callingUid);
                break;
            case LISTEN_FOR_BEST:
                enforceAccessPermission();
                networkCapabilities = new NetworkCapabilities(networkCapabilities);
</code></pre>
<p><strong>è¯·æ±‚ç±»å‹</strong>ï¼š</p>
<ul>
<li><strong>REQUEST</strong>: åº”ç”¨ä¸»åŠ¨è¯·æ±‚ç½‘ç»œï¼Œå¯èƒ½å¯¼è‡´ç½‘ç»œå»ºç«‹</li>
<li><strong>LISTEN</strong>: ä»…ç›‘å¬ç½‘ç»œå˜åŒ–ï¼Œä¸ä¸»åŠ¨å»ºç«‹</li>
<li><strong>TRACK_DEFAULT</strong>: è·Ÿè¸ªé»˜è®¤ç½‘ç»œ</li>
<li><strong>TRACK_SYSTEM_DEFAULT</strong>: è·Ÿè¸ªç³»ç»Ÿé»˜è®¤ç½‘ç»œ</li>
<li><strong>BACKGROUND_REQUEST</strong>: åå°è¯·æ±‚</li>
<li><strong>LISTEN_FOR_BEST</strong>: ç›‘å¬æœ€ä½³ç½‘ç»œ</li>
</ul>
<h3 data-id="heading-9">äº”ã€æ ¸å¿ƒç®—æ³•ï¼šç½‘ç»œé‡æ–°åŒ¹é… (Rematch)</h3>
<p>è¿™æ˜¯ ConnectivityService æœ€å…³é”®çš„ç®—æ³•ï¼Œå†³å®šå“ªä¸ªç½‘ç»œæ»¡è¶³å“ªä¸ªè¯·æ±‚ã€‚</p>
<h4 data-id="heading-10">1. <strong>è§¦å‘ Rematch çš„åœºæ™¯</strong></h4>
<ul>
<li>æ–°ç½‘ç»œæ³¨å†Œ</li>
<li>ç½‘ç»œæ–­å¼€</li>
<li>ç½‘ç»œè¯„åˆ†å˜åŒ–</li>
<li>ç½‘ç»œèƒ½åŠ›å˜åŒ–</li>
<li>æ–°çš„ç½‘ç»œè¯·æ±‚æ³¨å†Œ</li>
<li>ç½‘ç»œè¯·æ±‚å–æ¶ˆ</li>
</ul>
<h4 data-id="heading-11">2. <strong>Rematch ç®—æ³•</strong></h4>
<pre><code class="hljs language-10710:10758:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java" lang="10710:10758:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java">    /**
     * This function is triggered when something can affect what network should satisfy what
     * request, and it computes the network reassignment from the passed collection of requests to
     * network match to the one that the system should now have. That data is encoded in an
     * object that is a list of changes, each of them having an NRI, and old satisfier, and a new
     * satisfier.
     *
     * After the reassignment is computed, it is applied to the state objects.
     *
     * @param networkRequests the nri objects to evaluate for possible network reassignment
     * @return NetworkReassignment listing of proposed network assignment changes
     */
    @NonNull
    private NetworkReassignment computeNetworkReassignment(
            @NonNull final Collection&lt;NetworkRequestInfo&gt; networkRequests) {
        final NetworkReassignment changes = new NetworkReassignment();

        // Gather the list of all relevant agents.
        final ArrayList&lt;NetworkAgentInfo&gt; nais = new ArrayList&lt;&gt;();
        for (final NetworkAgentInfo nai : mNetworkAgentInfos) {
            nais.add(nai);
        }

        for (final NetworkRequestInfo nri : networkRequests) {
            // Non-multilayer listen requests can be ignored.
            if (!nri.isMultilayerRequest() &amp;&amp; nri.mRequests.get(0).isListen()) {
                continue;
            }
            NetworkAgentInfo bestNetwork = null;
            NetworkRequest bestRequest = null;
            for (final NetworkRequest req : nri.mRequests) {
                bestNetwork = mNetworkRanker.getBestNetwork(req, nais, nri.getSatisfier());
                // Stop evaluating as the highest possible priority request is satisfied.
                if (null != bestNetwork) {
                    bestRequest = req;
                    break;
                }
            }
            if (null == bestNetwork &amp;&amp; isDefaultBlocked(nri)) {
                // Remove default networking if disallowed for managed default requests.
                bestNetwork = mNoServiceNetwork;
            }
            if (nri.getSatisfier() != bestNetwork) {
                // bestNetwork may be null if no network can satisfy this request.
                changes.addRequestReassignment(new NetworkReassignment.RequestReassignment(
                        nri, nri.mActiveRequest, bestRequest, nri.getSatisfier(), bestNetwork));
            }
        }
        return changes;
    }
</code></pre>
<h4 data-id="heading-12">3. <strong>å®Œæ•´çš„ Rematch æµç¨‹</strong></h4>
<pre><code class="hljs language-10768:10796:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java" lang="10768:10796:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java">    /**
     * Attempt to rematch all Networks with all NetworkRequests.  This may result in Networks
     * being disconnected.
     */
    private void rematchAllNetworksAndRequests() {
        rematchNetworksAndRequests(getNrisFromGlobalRequests());
    }

    /**
     * Attempt to rematch all Networks with given NetworkRequests.  This may result in Networks
     * being disconnected.
     */
    private void rematchNetworksAndRequests(
            @NonNull final Set&lt;NetworkRequestInfo&gt; networkRequests) {
        ensureRunningOnConnectivityServiceThread();
        // TODO: This may be slow, and should be optimized.
        final long start = SystemClock.elapsedRealtime();
        final NetworkReassignment changes = computeNetworkReassignment(networkRequests);
        final long computed = SystemClock.elapsedRealtime();
        applyNetworkReassignment(changes, start);
        final long applied = SystemClock.elapsedRealtime();
        issueNetworkNeeds();
        final long end = SystemClock.elapsedRealtime();
        if (VDBG || DDBG) {
            log(String.format("Rematched networks [computed %dms] [applied %dms] [issued %d]",
                    computed - start, applied - computed, end - applied));
            log(changes.debugString());
        } else if (DBG) {
            // Shorter form, only one line of log
            log(String.format("%s [c %d] [a %d] [i %d]", changes.toString(),
                    computed - start, applied - computed, end - applied));
        }
    }
</code></pre>
<p><strong>æ­¥éª¤</strong>ï¼š</p>
<ol>
<li><strong>è®¡ç®—é‡æ–°åˆ†é…</strong> (<code>computeNetworkReassignment</code>): å¯¹æ¯ä¸ªè¯·æ±‚æ‰¾åˆ°æœ€ä½³ç½‘ç»œ</li>
<li><strong>åº”ç”¨é‡æ–°åˆ†é…</strong> (<code>applyNetworkReassignment</code>): æ›´æ–°æ»¡è¶³å…³ç³»</li>
<li><strong>å‘å‡ºç½‘ç»œéœ€æ±‚</strong> (<code>issueNetworkNeeds</code>): é€šçŸ¥ NetworkProvider</li>
</ol>
<h3 data-id="heading-13">å…­ã€å…³é”®ç»„ä»¶</h3>
<h4 data-id="heading-14">1. <strong>NetworkRanker</strong> - ç½‘ç»œæ’åå™¨</h4>
<ul>
<li>æ ¹æ®ç­–ç•¥é€‰æ‹©æœ€ä½³ç½‘ç»œ</li>
<li>è¯¦è§ä¹‹å‰çš„"ç½‘ç»œè¯„åˆ†æœºåˆ¶"åˆ†æ</li>
</ul>
<h4 data-id="heading-15">2. <strong>DnsManager</strong> - DNS ç®¡ç†</h4>
<ul>
<li>Private DNS é…ç½®</li>
<li>DNS éªŒè¯</li>
</ul>
<h4 data-id="heading-16">3. <strong>MultinetworkPolicyTracker</strong> - å¤šç½‘ç»œç­–ç•¥</h4>
<ul>
<li>"é¿å…å WiFi" é…ç½®</li>
<li>å¤šç½‘ç»œåŒæ—¶æ¿€æ´»ç­–ç•¥</li>
</ul>
<h4 data-id="heading-17">4. <strong>PermissionMonitor</strong> - æƒé™ç›‘æ§</h4>
<ul>
<li>ç›‘æ§åº”ç”¨æƒé™å˜åŒ–</li>
<li>INTERNET æƒé™æ£€æŸ¥</li>
</ul>
<h4 data-id="heading-18">5. <strong>NetworkNotificationManager</strong> - é€šçŸ¥ç®¡ç†</h4>
<ul>
<li>æ˜¾ç¤ºç½‘ç»œçŠ¶æ€é€šçŸ¥</li>
<li>Captive Portal é€šçŸ¥</li>
<li>éƒ¨åˆ†è¿æ¥é€šçŸ¥</li>
</ul>
<h4 data-id="heading-19">6. <strong>LingerMonitor</strong> - Linger ç›‘æ§</h4>
<ul>
<li>å®ç°ç½‘ç»œä¿æ´»æœºåˆ¶</li>
<li>ç›‘æ§ç½‘ç»œåˆ‡æ¢</li>
</ul>
<h3 data-id="heading-20">ä¸ƒã€Linger æœºåˆ¶</h3>
<pre><code class="hljs language-458:461:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java" lang="458:461:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java">    // Default to 30s linger time-out, and 5s for nascent network. Modifiable only for testing.
    private static final String LINGER_DELAY_PROPERTY = "persist.netmon.linger";
    private static final int DEFAULT_LINGER_DELAY_MS = 30_000;
    private static final int DEFAULT_NASCENT_DELAY_MS = 5_000;
</code></pre>
<p><strong>Linger çŠ¶æ€</strong>ï¼š</p>
<ul>
<li><strong>Nascent (æ–°ç”Ÿ)</strong>: ç½‘ç»œåˆšè¿æ¥ï¼Œè¿˜æœªè¢«ä½¿ç”¨ï¼Œä¿ç•™ 5 ç§’</li>
<li><strong>Lingering (å¾˜å¾Š)</strong>: ç½‘ç»œå¤±å»æ‰€æœ‰è¯·æ±‚ä½†ä»ä¿æŒè¿æ¥ 30 ç§’</li>
<li>ç›®çš„ï¼šé¿å…é¢‘ç¹åˆ‡æ¢ç½‘ç»œï¼Œç»™æ›¿ä»£ç½‘ç»œæ—¶é—´éªŒè¯</li>
</ul>
<h3 data-id="heading-21">å…«ã€äº‹ä»¶é©±åŠ¨æ¶æ„</h3>
<p>ConnectivityService ä½¿ç”¨ Handler æœºåˆ¶å¤„ç†å¼‚æ­¥äº‹ä»¶ï¼š</p>
<pre><code class="hljs language-642:799:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java" lang="642:799:packages_modules_Connectivity/service/src/com/android/server/ConnectivityService.java">    /**
     * used internally to clear a wakelock when transitioning
     * from one net to another.  Clear happens when we get a new
     * network - EVENT_EXPIRE_NET_TRANSITION_WAKELOCK happens
     * after a timeout if no network is found (typically 1 min).
     */
    private static final int EVENT_CLEAR_NET_TRANSITION_WAKELOCK = 8;

    /**
     * used internally to reload global proxy settings
     */
    private static final int EVENT_APPLY_GLOBAL_HTTP_PROXY = 9;

    /**
     * PAC manager has received new port.
     */
    private static final int EVENT_PAC_PROXY_HAS_CHANGED = 16;

    /**
     * used internally when registering NetworkProviders
     * obj = NetworkProviderInfo
     */
    private static final int EVENT_REGISTER_NETWORK_PROVIDER = 17;

    /**
     * used internally when registering NetworkAgents
     * obj = Messenger
     */
    private static final int EVENT_REGISTER_NETWORK_AGENT = 18;

    /**
     * used to add a network request
     * includes a NetworkRequestInfo
     */
    private static final int EVENT_REGISTER_NETWORK_REQUEST = 19;

    /**
     * indicates a timeout period is over - check if we had a network yet or not
     * and if not, call the timeout callback (but leave the request live until they
     * cancel it.
     * includes a NetworkRequestInfo
     */
    private static final int EVENT_TIMEOUT_NETWORK_REQUEST = 20;

    /**
     * used to add a network listener - no request
     * includes a NetworkRequestInfo
     */
    private static final int EVENT_REGISTER_NETWORK_LISTENER = 21;

    /**
     * used to remove a network request, either a listener or a real request
     * arg1 = UID of caller
     * obj  = NetworkRequest
     */
    private static final int EVENT_RELEASE_NETWORK_REQUEST = 22;

    /**
     * used internally when registering NetworkProviders
     * obj = Messenger
     */
    private static final int EVENT_UNREGISTER_NETWORK_PROVIDER = 23;

    /**
     * used internally to expire a wakelock when transitioning
     * from one net to another.  Expire happens when we fail to find
     * a new network (typically after 1 minute) -
     * EVENT_CLEAR_NET_TRANSITION_WAKELOCK happens if we had found
     * a replacement network.
     */
    private static final int EVENT_EXPIRE_NET_TRANSITION_WAKELOCK = 24;

    /**
     * used to add a network request with a pending intent
     * obj = NetworkRequestInfo
     */
    private static final int EVENT_REGISTER_NETWORK_REQUEST_WITH_INTENT = 26;

    /**
     * used to remove a pending intent and its associated network request.
     * arg1 = UID of caller
     * obj  = PendingIntent
     */
    private static final int EVENT_RELEASE_NETWORK_REQUEST_WITH_INTENT = 27;

    /**
     * used to specify whether a network should be used even if unvalidated.
     * arg1 = whether to accept the network if it's unvalidated (1 or 0)
     * arg2 = whether to remember this choice in the future (1 or 0)
     * obj  = network
     */
    private static final int EVENT_SET_ACCEPT_UNVALIDATED = 28;

    /**
     * used internally to (re)configure always-on networks.
     */
    private static final int EVENT_CONFIGURE_ALWAYS_ON_NETWORKS = 30;

    /**
     * used to add a network listener with a pending intent
     * obj = NetworkRequestInfo
     */
    private static final int EVENT_REGISTER_NETWORK_LISTENER_WITH_INTENT = 31;

    /**
     * used to specify whether a network should not be penalized when it becomes unvalidated.
     */
    private static final int EVENT_SET_AVOID_UNVALIDATED = 35;

    /**
     * used to handle reported network connectivity. May trigger revalidation of a network.
     */
    private static final int EVENT_REPORT_NETWORK_CONNECTIVITY = 36;

    // Handle changes in Private DNS settings.
    private static final int EVENT_PRIVATE_DNS_SETTINGS_CHANGED = 37;

    // Handle private DNS validation status updates.
    private static final int EVENT_PRIVATE_DNS_VALIDATION_UPDATE = 38;

     /**
      * Event for NetworkMonitor/NetworkAgentInfo to inform ConnectivityService that the network has
      * been tested.
      * obj = {@link NetworkTestedResults} representing information sent from NetworkMonitor.
      * data = PersistableBundle of extras passed from NetworkMonitor. If {@link
      * NetworkMonitorCallbacks#notifyNetworkTested} is called, this will be null.
      */
    private static final int EVENT_NETWORK_TESTED = 41;

    /**
     * Event for NetworkMonitor/NetworkAgentInfo to inform ConnectivityService that the private DNS
     * config was resolved.
     * obj = PrivateDnsConfig
     * arg2 = netid
     */
    private static final int EVENT_PRIVATE_DNS_CONFIG_RESOLVED = 42;

    /**
     * Request ConnectivityService display provisioning notification.
     * arg1    = Whether to make the notification visible.
     * arg2    = NetID.
     * obj     = Intent to be launched when notification selected by user, null if !arg1.
     */
    private static final int EVENT_PROVISIONING_NOTIFICATION = 43;

    /**
     * Used to specify whether a network should be used even if connectivity is partial.
     * arg1 = whether to accept the network if its connectivity is partial (1 for true or 0 for
     * false)
     * arg2 = whether to remember this choice in the future (1 for true or 0 for false)
     * obj  = network
     */
    private static final int EVENT_SET_ACCEPT_PARTIAL_CONNECTIVITY = 44;

    /**
     * Event for NetworkMonitor to inform ConnectivityService that the probe status has changed.
     * Both of the arguments are bitmasks, and the value of bits come from
     * INetworkMonitor.NETWORK_VALIDATION_PROBE_*.
     * arg1 = unused
     * arg2 = netId
     * obj = A Pair of integers: the bitmasks of, respectively, completed and successful probes.
     */
    public static final int EVENT_PROBE_STATUS_CHANGED = 45;
</code></pre>
<h3 data-id="heading-22">ä¹ã€ConnectivityService æ¶æ„å›¾</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ConnectivityService                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Handler (å•çº¿ç¨‹å¤„ç†)                         â”‚ â”‚
â”‚  â”‚  â€¢ EVENT_REGISTER_NETWORK_AGENT                                â”‚ â”‚
â”‚  â”‚  â€¢ EVENT_REGISTER_NETWORK_REQUEST                              â”‚ â”‚
â”‚  â”‚  â€¢ EVENT_NETWORK_TESTED                                        â”‚ â”‚
â”‚  â”‚  â€¢ EVENT_PRIVATE_DNS_VALIDATION_UPDATE                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  mNetworkAgentInfos  â”‚    â”‚   mNetworkRequests               â”‚  â”‚
â”‚  â”‚  (æ‰€æœ‰ç½‘ç»œ)          â”‚    â”‚   (æ‰€æœ‰è¯·æ±‚)                     â”‚  â”‚
â”‚  â”‚  â€¢ WiFi              â”‚    â”‚   â€¢ App è¯·æ±‚                     â”‚  â”‚
â”‚  â”‚  â€¢ Cellular          â”‚    â”‚   â€¢ ç³»ç»Ÿè¯·æ±‚                     â”‚  â”‚
â”‚  â”‚  â€¢ VPN               â”‚    â”‚   â€¢ ç›‘å¬å™¨                       â”‚  â”‚
â”‚  â”‚  â€¢ Ethernet          â”‚    â”‚   â€¢ é»˜è®¤ç½‘ç»œè·Ÿè¸ª                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                              â”‚                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                          â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚             <span class="hljs-built_in">rematchNetworksAndRequests</span>()                        â”‚ â”‚
â”‚  â”‚  <span class="hljs-number">1</span>. è®¡ç®—é‡æ–°åˆ†é… (computeNetworkReassignment)                  â”‚ â”‚
â”‚  â”‚     â€¢ ä½¿ç”¨ NetworkRanker ä¸ºæ¯ä¸ªè¯·æ±‚æ‰¾æœ€ä½³ç½‘ç»œ                  â”‚ â”‚
â”‚  â”‚  <span class="hljs-number">2</span>. åº”ç”¨é‡æ–°åˆ†é… (applyNetworkReassignment)                   â”‚ â”‚
â”‚  â”‚     â€¢ æ›´æ–° NetworkAgentInfo çš„è¯·æ±‚åˆ—è¡¨                         â”‚ â”‚
â”‚  â”‚     â€¢ æ›´æ–° NetworkRequestInfo çš„æ»¡è¶³è€…                         â”‚ â”‚
â”‚  â”‚  <span class="hljs-number">3</span>. å‘å‡ºç½‘ç»œéœ€æ±‚ (issueNetworkNeeds)                          â”‚ â”‚
â”‚  â”‚     â€¢ é€šçŸ¥ NetworkProvider éœ€è¦æ–°ç½‘ç»œ                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ ¸å¿ƒç»„ä»¶ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ NetworkRanker       - ç½‘ç»œæ’å                             â”‚   â”‚
â”‚  â”‚ â€¢ DnsManager          - DNS ç®¡ç†                             â”‚   â”‚
â”‚  â”‚ â€¢ LingerMonitor       - Linger ç›‘æ§                          â”‚   â”‚
â”‚  â”‚ â€¢ PermissionMonitor   - æƒé™ç›‘æ§                             â”‚   â”‚
â”‚  â”‚ â€¢ MultinetworkPolicyTracker - å¤šç½‘ç»œç­–ç•¥                     â”‚   â”‚
â”‚  â”‚ â€¢ NetworkNotificationManager - é€šçŸ¥ç®¡ç†                      â”‚   â”‚
â”‚  â”‚ â€¢ RoutingCoordinatorService - è·¯ç”±åè°ƒ                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–²                            â”‚
                    â”‚ æ³¨å†Œ/æ›´æ–°                   â”‚ å›è°ƒ
                    â”‚                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       NetworkAgent             â”‚  â”‚     åº”ç”¨ / ç³»ç»ŸæœåŠ¡          â”‚
â”‚  â€¢ TelephonyNetworkAgent       â”‚  â”‚  â€¢ NetworkCallback           â”‚
â”‚  â€¢ WifiNetworkAgent            â”‚  â”‚  â€¢ NetworkRequest            â”‚
â”‚  â€¢ VpnNetworkAgent             â”‚  â”‚  â€¢ ConnectivityManager       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-23">åã€å…³é”®æµç¨‹æ—¶åº</h3>
<h4 data-id="heading-24">1. <strong>ç½‘ç»œè¿æ¥æµç¨‹</strong></h4>
<pre><code class="hljs language-scss" lang="scss">NetworkAgent          ConnectivityService         NetworkMonitor        App
    â”‚                        â”‚                          â”‚                â”‚
    â”‚ <span class="hljs-built_in">register</span>()             â”‚                          â”‚                â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚                          â”‚                â”‚
    â”‚                        â”‚ åˆ›å»º NetworkAgentInfo    â”‚                â”‚
    â”‚                        â”‚                          â”‚                â”‚
    â”‚ <span class="hljs-built_in">markConnected</span>()        â”‚                          â”‚                â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚ è§¦å‘éªŒè¯                 â”‚                â”‚
    â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚                â”‚
    â”‚                        â”‚                          â”‚ HTTP/HTTPSæ¢æµ‹ â”‚
    â”‚                        â”‚ <span class="hljs-built_in">rematchNetworksAndRequests</span>() â”‚            â”‚
    â”‚                        â”‚ (æ‰¾åˆ°æ»¡è¶³çš„è¯·æ±‚)         â”‚                â”‚
    â”‚                        â”‚                          â”‚                â”‚
    â”‚                        â”‚ <span class="hljs-built_in">onAvailable</span>()            â”‚                â”‚
    â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
    â”‚                        â”‚                          â”‚ onValidated   â”‚
    â”‚                        â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
    â”‚                        â”‚ æ›´æ–°èƒ½åŠ›: VALIDATED      â”‚                â”‚
    â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
    â”‚                        â”‚ <span class="hljs-built_in">onCapabilitiesChanged</span>()  â”‚                â”‚
</code></pre>
<h4 data-id="heading-25">2. <strong>ç½‘ç»œè¯·æ±‚æµç¨‹</strong></h4>
<pre><code class="hljs language-scss" lang="scss">App                 ConnectivityService      NetworkRanker      NetworkAgent
 â”‚                          â”‚                      â”‚                  â”‚
 â”‚ <span class="hljs-built_in">requestNetwork</span>()         â”‚                      â”‚                  â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚                      â”‚                  â”‚
 â”‚                          â”‚ åˆ›å»º NRI             â”‚                  â”‚
 â”‚                          â”‚ <span class="hljs-built_in">rematchNetworks</span>()    â”‚                  â”‚
 â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚                  â”‚
 â”‚                          â”‚ <span class="hljs-built_in">getBestNetwork</span>()     â”‚                  â”‚
 â”‚                          â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
 â”‚                          â”‚                      â”‚                  â”‚
 â”‚ æƒ…å†µ<span class="hljs-number">1</span>: æœ‰æ»¡è¶³çš„ç½‘ç»œ      â”‚                      â”‚                  â”‚
 â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ <span class="hljs-built_in">onAvailable</span>()        â”‚                  â”‚
 â”‚                          â”‚                      â”‚                  â”‚
 â”‚ æƒ…å†µ<span class="hljs-number">2</span>: æ— æ»¡è¶³çš„ç½‘ç»œ      â”‚                      â”‚                  â”‚
 â”‚                          â”‚ <span class="hljs-built_in">issueNetworkNeeds</span>()  â”‚                  â”‚
 â”‚                          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
 â”‚                          â”‚                      â”‚  (è¯·æ±‚å»ºç«‹æ–°ç½‘ç»œ) â”‚
</code></pre>
<h3 data-id="heading-26">åä¸€ã€å…³é”®ç‰¹æ€§</h3>
<ol>
<li>
<p><strong>å•çº¿ç¨‹æ¨¡å‹</strong>ï¼šæ‰€æœ‰æ“ä½œåœ¨ ConnectivityService Handler çº¿ç¨‹æ‰§è¡Œï¼Œé¿å…å¹¶å‘é—®é¢˜</p>
</li>
<li>
<p><strong>æ‡’æƒ°è¯„ä¼°</strong>ï¼šä¸ä¼šä¸»åŠ¨å»ºç«‹ç½‘ç»œï¼Œåªæœ‰åœ¨æœ‰è¯·æ±‚æ—¶æ‰å»ºç«‹</p>
</li>
<li>
<p><strong>ä¼˜é›…é™çº§</strong>ï¼šLinger æœºåˆ¶ç¡®ä¿ç½‘ç»œåˆ‡æ¢å¹³æ»‘</p>
</li>
<li>
<p><strong>æƒé™æ§åˆ¶</strong>ï¼šä¸¥æ ¼çš„æƒé™æ£€æŸ¥ï¼Œä¸åŒ UID çœ‹åˆ°ä¸åŒçš„ç½‘ç»œ</p>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>å¢é‡ Rematchï¼ˆä»…é‡æ–°åŒ¹é…ç›¸å…³è¯·æ±‚ï¼‰</li>
<li>æ‰¹é‡å¤„ç†å›è°ƒ</li>
<li>é¿å…ä¸å¿…è¦çš„ç½‘ç»œåˆ›å»º/é”€æ¯</li>
</ul>
</li>
</ol>
<p>è¿™å°±æ˜¯ ConnectivityService çš„å®Œæ•´æ¡†æ¶ï¼å®ƒæ˜¯ Android ç½‘ç»œæ¶æ„çš„å¤§è„‘ï¼Œåè°ƒæ‰€æœ‰ç½‘ç»œå’Œè¯·æ±‚ï¼Œç¡®ä¿åº”ç”¨å§‹ç»ˆè¿æ¥åˆ°æœ€ä½³ç½‘ç»œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[<<github åŠ æ˜Ÿ Taimili.com è‰¾ç±³è‰ >> å‰ç«¯é¢è¯•é¢˜-JavaScripté«˜çº§ç¯‡]]></title>    <link>https://juejin.cn/post/7602901565026385929</link>    <guid>https://juejin.cn/post/7602901565026385929</guid>    <pubDate>2026-02-05T02:43:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901565026385929" data-draft-id="7602893600251674670" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="&lt;&lt;github åŠ æ˜Ÿ Taimili.com è‰¾ç±³è‰ &gt;&gt; å‰ç«¯é¢è¯•é¢˜-JavaScripté«˜çº§ç¯‡"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-02-05T02:43:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼€æºä¹‹çœ¼"/> <meta itemprop="url" content="https://juejin.cn/user/55438993800919"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            &lt;&lt;github åŠ æ˜Ÿ Taimili.com è‰¾ç±³è‰ &gt;&gt; å‰ç«¯é¢è¯•é¢˜-JavaScripté«˜çº§ç¯‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/55438993800919/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼€æºä¹‹çœ¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:43:01.000Z" title="Thu Feb 05 2026 02:43:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ V8å¼•æ“å·¥ä½œåŸç†ä¸åƒåœ¾å›æ”¶ (GC)</h2>
<p>ç†è§£JavaScriptçš„æ‰§è¡Œç¯å¢ƒæ˜¯é«˜çº§ä¼˜åŒ–çš„å‰æã€‚</p>
<h3 data-id="heading-1"><strong>V8å¼•æ“æ ¸å¿ƒæµç¨‹</strong></h3>
<h5 data-id="heading-2">Taimili è‰¾ç±³è‰ ( ä¸€æ¬¾ä¸“ä¸šçš„ GitHub star ç®¡ç†å’Œgithub åŠ æ˜Ÿæ¶¨æ˜Ÿå·¥å…·<a href="https://link.juejin.cn?target=taimili.com" title="https://link.juejin.cn?target=taimili.com" target="_blank">taimili.com</a> )</h5>
<p>è‰¾ç±³è‰ æ˜¯ä¸€æ¬¾ä¼˜é›…ä¾¿æ·çš„Â GitHub star ç®¡ç†å’Œgithub åŠ æ˜Ÿ æ¶¨æ˜Ÿå·¥å…·ï¼ŒåŸºäº PHP &amp; javascript æ„å»ºï¼Œ èƒ½å¯¹github star fork follow watch åˆ·æ˜Ÿç®¡ç†å’Œæå‡ï¼Œæœ€é€‚åˆgithub çš„æ·±åº¦ç”¨æˆ·</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24a5622ae9084d3ea6ce3cd9de43430f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5byA5rqQ5LmL55y8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770864180&amp;x-signature=IlxfsV%2FnvJoFY0nnLgL7cwon8Rk%3D" alt="WX20251021-210346@2x.png" loading="lazy"/></p>
<blockquote>
</blockquote>
<ol>
<li><strong>è§£æ (Parsing)</strong> : V8å°†JavaScriptæºä»£ç è§£ææˆ<strong>æŠ½è±¡è¯­æ³•æ ‘ (AST)</strong> ã€‚</li>
<li><strong>è§£é‡Š (Interpretation)</strong> : <strong>Ignition</strong> (V8çš„è§£é‡Šå™¨) å°†ASTè½¬æ¢æˆå­—èŠ‚ç å¹¶æ‰§è¡Œã€‚åŒæ—¶ï¼ŒIgnitionä¼šæ”¶é›†åˆ†æä¿¡æ¯ï¼Œç”¨äºåç»­çš„ä¼˜åŒ–ã€‚</li>
<li><strong>ç¼–è¯‘ (Compilation)</strong> : å¯¹äºè¢«é¢‘ç¹æ‰§è¡Œçš„ä»£ç ï¼ˆçƒ­ç‚¹ä»£ç ï¼‰ï¼Œ<strong>TurboFan</strong> (V8çš„ä¼˜åŒ–ç¼–è¯‘å™¨) ä¼šä»‹å…¥ï¼Œåˆ©ç”¨åˆ†æä¿¡æ¯å°†å­—èŠ‚ç ç¼–è¯‘æˆé«˜åº¦ä¼˜åŒ–çš„æœºå™¨ç ï¼Œä»¥æå‡æ‰§è¡Œæ•ˆç‡ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º<strong>JIT (Just-In-Time) ç¼–è¯‘</strong>ã€‚å¦‚æœä¼˜åŒ–çš„å‡è®¾å¤±è´¥ï¼ˆå¦‚å‡½æ•°å‚æ•°ç±»å‹æ”¹å˜ï¼‰ï¼Œä¼šè¿›è¡Œ<strong>å»ä¼˜åŒ– (Deoptimization)</strong> ï¼Œå›é€€åˆ°å­—èŠ‚ç æ‰§è¡Œã€‚</li>
</ol>
<h3 data-id="heading-3"><strong>åƒåœ¾å›æ”¶ (Garbage Collection)</strong></h3>
<p>V8é‡‡ç”¨<strong>åˆ†ä»£å›æ”¶ (Generational Collection)<strong>çš„ç­–ç•¥ï¼Œå°†å †å†…å­˜åˆ†ä¸º</strong>æ–°ç”Ÿä»£ (New Generation)<strong>å’Œ</strong>è€ç”Ÿä»£ (Old Generation)</strong> ã€‚</p>
<h4 data-id="heading-4"><strong>æ–°ç”Ÿä»£ (Scavengerç®—æ³•)</strong></h4>
<ul>
<li>ç©ºé—´å°ï¼Œå­˜æ´»å¯¹è±¡å°‘ã€‚é‡‡ç”¨<strong>Scavenger</strong>ç®—æ³•ï¼Œå°†ç©ºé—´ä¸€åˆ†ä¸ºäºŒï¼ˆFrom-Space å’Œ To-Spaceï¼‰ã€‚</li>
<li>å›æ”¶æ—¶ï¼Œå°†From-Spaceä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°To-Spaceï¼Œç„¶åæ¸…ç©ºFrom-Spaceã€‚æœ€åï¼ŒFrom-Spaceå’ŒTo-Spaceè§’è‰²äº’æ¢ã€‚</li>
<li>å¯¹è±¡è‹¥ç»å†å¤šè½®å›æ”¶ä»å­˜æ´»ï¼Œåˆ™è¢«**æ™‹å‡ (Promotion)**åˆ°è€ç”Ÿä»£ã€‚</li>
</ul>
<h4 data-id="heading-5"><strong>è€ç”Ÿä»£</strong></h4>
<ul>
<li>ç©ºé—´å¤§ï¼Œå­˜æ´»å¯¹è±¡å¤šã€‚é‡‡ç”¨<strong>æ ‡è®°-æ¸…é™¤</strong>ç®—æ³•ã€‚</li>
<li><strong>æ ‡è®°é˜¶æ®µ</strong>: ä»æ ¹å¯¹è±¡ï¼ˆå¦‚å…¨å±€å¯¹è±¡ï¼‰å¼€å§‹ï¼Œéå†æ‰€æœ‰å¯è¾¾å¯¹è±¡å¹¶æ‰“ä¸Šæ ‡è®°ã€‚</li>
<li><strong>æ¸…é™¤é˜¶æ®µ</strong>: æ¸…é™¤éæ ‡è®°å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ã€‚</li>
<li><strong>æ•´ç†é˜¶æ®µ</strong> : ä¸ºè§£å†³å†…å­˜ç¢ç‰‡åŒ–é—®é¢˜ï¼Œåœ¨æ¸…é™¤åï¼Œä¼šå°†æ‰€æœ‰å­˜æ´»å¯¹è±¡å‘ä¸€ç«¯ç§»åŠ¨ï¼Œå½¢æˆè¿ç»­çš„å†…å­˜ç©ºé—´ã€‚</li>
</ul>
<h4 data-id="heading-6"><strong>ä»£ç ç¤ºä¾‹ (å¯¼è‡´å†…å­˜æ³„æ¼çš„åœºæ™¯):</strong></h4>
<p>é«˜çº§å¼€å‘è€…éœ€è¦èƒ½å¤Ÿè¯†åˆ«å¹¶è§£é‡Šå†…å­˜æ³„æ¼ã€‚é—­åŒ…å¼•ç”¨äº†å·²åˆ†ç¦»çš„DOMèŠ‚ç‚¹æ˜¯å…¸å‹æ¡ˆä¾‹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">js
 ä½“éªŒ<span class="hljs-variable constant_">AI</span>ä»£ç åŠ©æ‰‹
 ä»£ç è§£è¯»
å¤åˆ¶ä»£ç 
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createLeakingElement</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'container'</span>);
  <span class="hljs-keyword">const</span> detachedElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
  detachedElement.<span class="hljs-property">textContent</span> = <span class="hljs-string">'This is a potentially leaking element.'</span>;
  container.<span class="hljs-title function_">appendChild</span>(detachedElement);

  <span class="hljs-comment">// å…³é”®ï¼šä¸€ä¸ªå¤–éƒ¨å¯è®¿é—®çš„å‡½æ•°ï¼Œé€šè¿‡é—­åŒ…æŒæœ‰äº†å¯¹ detachedElement çš„å¼•ç”¨</span>
  <span class="hljs-keyword">const</span> leakingClosure = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å³ä½¿ detachedElement ä»DOMæ ‘ä¸­ç§»é™¤ï¼Œåªè¦ leakingClosure å­˜åœ¨ï¼Œ</span>
    <span class="hljs-comment">// detachedElement å°±ä¸ä¼šè¢«GCå›æ”¶ã€‚</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(detachedElement.<span class="hljs-property">textContent</span>);
  };

  <span class="hljs-comment">// ä»DOMä¸­ç§»é™¤å…ƒç´ </span>
  container.<span class="hljs-title function_">removeChild</span>(detachedElement);

  <span class="hljs-comment">// è¿”å›è¿™ä¸ªé—­åŒ…</span>
  <span class="hljs-keyword">return</span> leakingClosure;
}

<span class="hljs-comment">// globalLeaker ç°åœ¨æŒæœ‰äº†å¯¹ detachedElement çš„é—´æ¥å¼•ç”¨</span>
<span class="hljs-comment">// å³ä½¿å®ƒåœ¨DOMä¸­å·²ä¸å¯è§ï¼Œå®ƒä¾ç„¶å­˜åœ¨äºå†…å­˜ä¸­</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">globalLeaker</span> = <span class="hljs-title function_">createLeakingElement</span>();

<span class="hljs-comment">// åªè¦ window.globalLeaker ä¸è¢«è®¾ä¸º nullï¼Œè¿™å—å†…å­˜å°±æ°¸è¿œæ— æ³•è¢«å›æ”¶</span>
</code></pre>
<h2 data-id="heading-7">äºŒã€ äº‹ä»¶å¾ªç¯ (Event Loop)</h2>
<p>é«˜çº§é¢è¯•ä¼šæ·±å…¥åˆ°Node.jsç¯å¢ƒï¼Œè€ƒå¯Ÿå¯¹Event Loopå„é˜¶æ®µçš„ç†è§£ã€‚</p>
<ul>
<li>
<p><strong>æµè§ˆå™¨ vs. Node.js</strong>: ä¸¤è€…æ¨¡å‹ç›¸ä¼¼ï¼Œä½†Node.jsçš„äº‹ä»¶å¾ªç¯æœ‰æ›´æ˜ç¡®çš„é˜¶æ®µåˆ’åˆ†ã€‚</p>
</li>
<li>
<p><strong>Node.js äº‹ä»¶å¾ªç¯çš„å…­ä¸ªé˜¶æ®µ</strong>:</p>
<ol>
<li><strong>timers</strong>: æ‰§è¡Œ <code>setTimeout()</code> å’Œ <code>setInterval()</code> çš„å›è°ƒã€‚</li>
<li><strong>pending callbacks</strong>: æ‰§è¡Œä¸Šä¸€è½®å¾ªç¯ä¸­å»¶è¿Ÿåˆ°æœ¬è½®æ‰§è¡Œçš„I/Oå›è°ƒã€‚</li>
<li><strong>idle, prepare</strong>: ä»…å†…éƒ¨ä½¿ç”¨ã€‚</li>
<li><strong>poll</strong>: æ ¸å¿ƒé˜¶æ®µã€‚æ£€ç´¢æ–°çš„I/Oäº‹ä»¶ï¼›æ‰§è¡Œä¸I/Oç›¸å…³çš„å›è°ƒã€‚å¦‚æœé˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œä¼šéå†æ‰§è¡Œï¼›å¦‚æœä¸ºç©ºï¼Œä¼šåœ¨æ­¤é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æœ‰æ–°çš„I/Oäº‹ä»¶æˆ–åˆ°è¾¾ <code>timers</code> è®¾å®šçš„é˜ˆå€¼ã€‚</li>
<li><strong>check</strong>: æ‰§è¡Œ <code>setImmediate()</code> çš„å›è°ƒã€‚</li>
<li><strong>close callbacks</strong>: æ‰§è¡Œå¦‚ <code>socket.on('close', ...)</code> çš„å›è°ƒã€‚</li>
</ol>
</li>
<li>
<p><strong><code>process.nextTick()</code> ä¸å¾®ä»»åŠ¡ (Micro-task)</strong> :</p>
<ul>
<li><code>process.nextTick()</code> æœ‰è‡ªå·±ç‹¬ç«‹çš„é˜Ÿåˆ—ï¼Œå…¶ä¼˜å…ˆçº§<strong>é«˜äº</strong>æ‰€æœ‰å¾®ä»»åŠ¡ã€‚</li>
<li>åœ¨ä¸€ä¸ªé˜¶æ®µæ‰§è¡Œå®Œæ¯•åï¼Œäº‹ä»¶å¾ªç¯ä¼š<strong>ç«‹å³</strong>æ¸…ç©º <code>nextTick</code> é˜Ÿåˆ—ï¼Œç„¶åæ‰æ¸…ç©ºå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹‹åæ‰è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚</li>
</ul>
</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ (Node.jsç¯å¢ƒä¸‹):</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">js
 ä½“éªŒ<span class="hljs-variable constant_">AI</span>ä»£ç åŠ©æ‰‹
 ä»£ç è§£è¯»
å¤åˆ¶ä»£ç 
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. Script Start'</span>);

<span class="hljs-comment">// Timers é˜¶æ®µ</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'7. setTimeout'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-comment">// Check é˜¶æ®µ</span>
<span class="hljs-title function_">setImmediate</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'8. setImmediate'</span>);
});

<span class="hljs-comment">// Micro-task</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'5. Promise.then'</span>);
});

<span class="hljs-comment">// process.nextTick é˜Ÿåˆ— (æœ€é«˜ä¼˜å…ˆçº§)</span>
process.<span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4. process.nextTick'</span>);
});

<span class="hljs-comment">// I/O æ“ä½œï¼Œå…¶å›è°ƒå°†åœ¨ Poll é˜¶æ®µæ‰§è¡Œ</span>
fs.<span class="hljs-title function_">readFile</span>(__filename, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'6. I/O (readFile) callback'</span>);

  <span class="hljs-comment">// I/Oå›è°ƒå†…éƒ¨çš„è°ƒåº¦</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'11. I/O -&gt; setTimeout'</span>), <span class="hljs-number">0</span>);
  <span class="hljs-title function_">setImmediate</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'9. I/O -&gt; setImmediate'</span>));
  process.<span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'10. I/O -&gt; nextTick'</span>));
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. Script End'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. Poll phase may start here...'</span>);

<span class="hljs-comment">// ç†è®ºè¾“å‡ºé¡ºåº:</span>
<span class="hljs-comment">// 1. Script Start</span>
<span class="hljs-comment">// 2. Script End</span>
<span class="hljs-comment">// 3. Poll phase may start here...</span>
<span class="hljs-comment">// 4. process.nextTick</span>
<span class="hljs-comment">// 5. Promise.then</span>
<span class="hljs-comment">// 6. I/O (readFile) callback</span>
<span class="hljs-comment">// 10. I/O -&gt; nextTick</span>
<span class="hljs-comment">// 9. I/O -&gt; setImmediate</span>
<span class="hljs-comment">// 7. setTimeout</span>
<span class="hljs-comment">// 8. setImmediate</span>
<span class="hljs-comment">// 11. I/O -&gt; setTimeout</span>
<span class="hljs-comment">// (æ³¨æ„ï¼š9, 7, 8, 11 çš„ç¡®åˆ‡é¡ºåºå¯èƒ½å› I/Oè€—æ—¶å’Œç³»ç»Ÿè°ƒåº¦è€Œæœ‰ç»†å¾®å˜åŒ–ï¼Œä½†åŸºæœ¬è§„å¾‹å¦‚æ­¤)</span>
</code></pre>
<h2 data-id="heading-8">ä¸‰ã€ é«˜çº§æ€§èƒ½ä¼˜åŒ–</h2>
<h3 data-id="heading-9"><strong>Tree Shaking (æ‘‡æ ‘ä¼˜åŒ–)</strong></h3>
<h4 data-id="heading-10"><strong>åŸç†</strong></h4>
<ul>
<li>ä¾èµ–ES Modules (<code>import</code>/<code>export</code>) çš„é™æ€ç»“æ„ï¼Œåœ¨ç¼–è¯‘æ—¶åˆ†æä»£ç ï¼Œç§»é™¤æœªè¢«å®é™…å¼•ç”¨çš„â€œæ­»ä»£ç â€(dead-code)ã€‚</li>
</ul>
<h4 data-id="heading-11"><strong>å®è·µ</strong></h4>
<ul>
<li>Webpack, Rollupç­‰ç°ä»£æ‰“åŒ…å·¥å…·åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹é»˜è®¤å¼€å¯ã€‚å¼€å‘è€…éœ€ä¿è¯ä»£ç éµå¾ªESMè§„èŒƒï¼Œå¹¶é¿å…æœ‰å‰¯ä½œç”¨çš„æ¨¡å—å¯¼å…¥ã€‚</li>
</ul>
<h3 data-id="heading-12"><strong>Code Splitting (ä»£ç åˆ†å‰²)</strong></h3>
<h4 data-id="heading-13"><strong>ç›®çš„</strong></h4>
<ul>
<li>å°†å·¨å¤§çš„å•ä½“bundleåˆ†å‰²æˆå¤šä¸ªå°å—(chunks)ï¼ŒæŒ‰éœ€åŠ è½½ï¼Œä»¥å‡å°é¦–å±åŠ è½½ä½“ç§¯ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</li>
</ul>
<h4 data-id="heading-14"><strong>ç­–ç•¥</strong></h4>
<ol>
<li><strong>æŒ‰è·¯ç”±åˆ†å‰²</strong>: æ¯ä¸ªé¡µé¢æˆ–è·¯ç”±å¯¹åº”ä¸€ä¸ªchunkã€‚</li>
<li><strong>æŒ‰ç»„ä»¶åˆ†å‰²</strong>: å¯¹äºéé¦–å±ã€æˆ–éœ€è¦äº¤äº’æ‰å‡ºç°çš„å¤§å‹ç»„ä»¶ï¼ˆå¦‚å¼¹çª—ã€å›¾è¡¨ï¼‰è¿›è¡Œæ‡’åŠ è½½ã€‚</li>
<li><strong>å…¬å…±åº“åˆ†ç¦» (Vendor Splitting)</strong> : å°†ä¸å¸¸å˜åŠ¨çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚React, Lodashï¼‰æ‰“åŒ…æˆç‹¬ç«‹çš„vendor chunkï¼Œåˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ã€‚</li>
</ol>
<h3 data-id="heading-15"><strong>åˆ©ç”¨æµè§ˆå™¨æ¸²æŸ“è·¯å¾„</strong></h3>
<ul>
<li><strong>å…³é”®æ¸²æŸ“è·¯å¾„</strong> : ä¼˜åŒ–CSSåŠ è½½ï¼ˆå†…è”å…³é”®CSSï¼‰ã€å‡å°‘é˜»å¡æ¸²æŸ“çš„è„šæœ¬ã€ä½¿ç”¨ <code>async</code>/<code>defer</code>ã€‚</li>
<li><strong>ç¡¬ä»¶åŠ é€Ÿ</strong>: å°½é‡ä½¿ç”¨ <code>transform</code> å’Œ <code>opacity</code> å±æ€§è¿›è¡ŒåŠ¨ç”»ï¼Œå®ƒä»¬èƒ½è¢«æå‡åˆ°å•ç‹¬çš„åˆæˆå±‚(Compositor Layer)ï¼Œç”±GPUå¤„ç†ï¼Œé¿å…è§¦å‘é‡æ’(Reflow)å’Œé‡ç»˜(Repaint)ã€‚</li>
</ul>
<h3 data-id="heading-16"><strong>ä»£ç ç¤ºä¾‹ (Reactä¸­çš„ä»£ç åˆ†å‰²)</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript">jsx
 ä½“éªŒ<span class="hljs-variable constant_">AI</span>ä»£ç åŠ©æ‰‹
 ä»£ç è§£è¯»
å¤åˆ¶ä»£ç 
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { <span class="hljs-title class_">Suspense</span>, lazy } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// ä½¿ç”¨ React.lazy å’ŒåŠ¨æ€ import() æ¥å®ç°ç»„ä»¶çš„æ‡’åŠ è½½</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HeavyComponent</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./components/HeavyComponent'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">AnotherLazyComponent</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./components/AnotherLazyComponent'</span>));

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [showHeavy, setShowHeavy] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>My App<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowHeavy(true)}&gt;Load Heavy Component<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* 
        Suspense ç»„ä»¶ç”¨äºåœ¨æ‡’åŠ è½½ç»„ä»¶ä¸‹è½½å’Œè§£ææœŸé—´ï¼Œæ˜¾ç¤ºä¸€ä¸ªfallback UIã€‚
        åªæœ‰å½“ showHeavy ä¸º true æ—¶ï¼Œæµè§ˆå™¨æ‰ä¼šå»è¯·æ±‚ HeavyComponent.jsã€‚
      */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        {showHeavy &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">HeavyComponent</span> /&gt;</span>}
        
        {/* å‡è®¾è¿™æ˜¯å¦ä¸€ä¸ªéœ€è¦æ‡’åŠ è½½çš„ç»„ä»¶ */}
        {/* <span class="hljs-tag">&lt;<span class="hljs-name">AnotherLazyComponent</span> /&gt;</span> */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h2 data-id="heading-17">å››ã€ å†…å­˜ç®¡ç†ä¸è¯Šæ–­</h2>
<h3 data-id="heading-18"><strong>å†…å­˜æ³„æ¼çš„å¸¸è§åŸå› </strong></h3>
<ol>
<li><strong>æ„å¤–çš„å…¨å±€å˜é‡</strong>: æœªç»å£°æ˜çš„å˜é‡è¢«èµ‹å€¼ï¼Œæˆä¸ºå…¨å±€å¯¹è±¡çš„å±æ€§ã€‚</li>
<li><strong>é—å¿˜çš„å®šæ—¶å™¨æˆ–å›è°ƒ</strong>: <code>setInterval</code> æœªè¢«æ¸…é™¤ï¼Œå…¶å›è°ƒå‡½æ•°åŠå…¶é—­åŒ…ç¯å¢ƒæ— æ³•è¢«å›æ”¶ã€‚</li>
<li><strong>åˆ†ç¦»çš„DOMèŠ‚ç‚¹å¼•ç”¨</strong>: å¦‚ç¬¬ä¸€èŠ‚çš„ä»£ç ç¤ºä¾‹ã€‚</li>
<li><strong>é—­åŒ…çš„æ»¥ç”¨</strong>: é—­åŒ…ä¼šä½¿å…¶å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸæŒç»­å­˜åœ¨ï¼Œå¦‚æœä½œç”¨åŸŸä¸­åŒ…å«å¤§é‡æ•°æ®ï¼Œåˆ™å¯èƒ½é€ æˆå†…å­˜å ç”¨è¿‡é«˜ã€‚</li>
</ol>
<h3 data-id="heading-19"><strong>è¯Šæ–­å·¥å…· (Chrome DevTools)</strong></h3>
<ul>
<li>
<p><strong>Performance Monitor</strong>: å®æ—¶ç›‘æ§CPUä½¿ç”¨ç‡ã€JSå †å¤§å°ã€DOMèŠ‚ç‚¹æ•°ç­‰ã€‚</p>
</li>
<li>
<p><strong>Memory Tab</strong>:</p>
<ul>
<li><strong>Heap Snapshot (å †å¿«ç…§)</strong> : æ‹æ‘„å †å†…å­˜çš„å¿«ç…§ï¼Œç”¨äºåˆ†æå¯¹è±¡åˆ†å¸ƒã€æŸ¥æ‰¾åˆ†ç¦»çš„DOMæ ‘ã€å®šä½å†…å­˜æ³„æ¼ã€‚</li>
<li><strong>Allocation Instrumentation on Timeline</strong>: è®°å½•å†…å­˜åˆ†é…çš„æ—¶é—´çº¿ï¼Œç”¨äºå®šä½æ˜¯å“ªä¸ªå‡½æ•°æˆ–æ“ä½œå¯¼è‡´äº†é¢‘ç¹çš„å†…å­˜åˆ†é…æˆ–å†…å­˜æ¿€å¢ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-20"><strong>ä»£ç ç¤ºä¾‹ (é—å¿˜çš„å®šæ—¶å™¨):</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin">js
 ä½“éªŒAIä»£ç åŠ©æ‰‹
 ä»£ç è§£è¯»
å¤åˆ¶ä»£ç 
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PulsingDot</span> {
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.size = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.isGrowing = <span class="hljs-literal">true</span>;

    <span class="hljs-comment">// å®šæ—¶å™¨é€šè¿‡é—­åŒ…æŒæœ‰äº†å¯¹ this (PulsingDotå®ä¾‹) çš„å¼•ç”¨</span>
    <span class="hljs-keyword">this</span>.intervalId = setInterval(() =&gt; {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isGrowing) {
        <span class="hljs-keyword">this</span>.size += <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.size &gt;= <span class="hljs-number">10</span>) <span class="hljs-keyword">this</span>.isGrowing = <span class="hljs-literal">false</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.size -= <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.size &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">this</span>.isGrowing = <span class="hljs-literal">true</span>;
      }
    }, <span class="hljs-number">100</span>);
  }

  <span class="hljs-comment">// å¿…é¡»æä¾›ä¸€ä¸ªé”€æ¯æ–¹æ³•æ¥æ¸…é™¤å®šæ—¶å™¨</span>
  destroy() {
    clearInterval(<span class="hljs-keyword">this</span>.intervalId);
    console.log(<span class="hljs-string">'PulsingDot destroyed and interval cleared.'</span>);
  }
}

let dot = new PulsingDot();

<span class="hljs-comment">// å‡è®¾åœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦è¿™ä¸ª dot å®ä¾‹</span>
dot = <span class="hljs-literal">null</span>;

<span class="hljs-comment">// é—®é¢˜ï¼šè™½ç„¶ dot å˜é‡è¢«è®¾ä¸º nullï¼Œä½† PulsingDot å®ä¾‹æ— æ³•è¢«å›æ”¶ï¼Œ</span>
<span class="hljs-comment">// å› ä¸º setInterval çš„å›è°ƒå‡½æ•°ä»ç„¶æŒæœ‰å¯¹å®ƒçš„å¼•ç”¨ï¼Œå®šæ—¶å™¨è¿˜åœ¨ä¸åœåœ°è¿è¡Œã€‚</span>
<span class="hljs-comment">// æ­£ç¡®åšæ³•ï¼šåœ¨é”€æ¯å¯¹è±¡å‰ï¼Œè°ƒç”¨ dot.destroy()ã€‚</span>
</code></pre>
<h2 data-id="heading-21">äº”ã€ è½¯ä»¶è®¾è®¡æ¨¡å¼</h2>
<p>é«˜çº§å¼€å‘è€…åº”èƒ½å°†è®¾è®¡æ¨¡å¼æ€æƒ³èå…¥æ—¥å¸¸ç¼–ç ï¼Œä»¥æ„å»ºå¯ç»´æŠ¤ã€å¯æ‰©å±•çš„ç³»ç»Ÿã€‚</p>
<ul>
<li><strong>å•ä¾‹æ¨¡å¼ (Singleton)</strong> : ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚</li>
<li><strong>è§‚å¯Ÿè€…æ¨¡å¼ (Observer / Pub/Sub)</strong> : å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚</li>
<li><strong>å·¥å‚æ¨¡å¼ (Factory)</strong> : å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚</li>
<li><strong>è£…é¥°å™¨æ¨¡å¼ (Decorator)</strong> : åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚</li>
<li><strong>ä»£ç†æ¨¡å¼ (Proxy)</strong> : ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ (è§‚å¯Ÿè€…æ¨¡å¼/å‘å¸ƒ-è®¢é˜…):</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">js
 ä½“éªŒ<span class="hljs-variable constant_">AI</span>ä»£ç åŠ©æ‰‹
 ä»£ç è§£è¯»
å¤åˆ¶ä»£ç 
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventBus</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span> = {};
  }

  <span class="hljs-comment">// è®¢é˜…</span>
  <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName]) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName] = [];
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-title function_">push</span>(callback);
  }

  <span class="hljs-comment">// å–æ¶ˆè®¢é˜…</span>
  <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName]) <span class="hljs-keyword">return</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-title function_">filter</span>(
      <span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> listener !== callback
    );
  }

  <span class="hljs-comment">// å‘å¸ƒ</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName]) <span class="hljs-keyword">return</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-title function_">listener</span>(...args);
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in listener for event "<span class="hljs-subst">${eventName}</span>":`</span>, e);
      }
    });
  }
}

<span class="hljs-comment">// --- ä½¿ç”¨åœºæ™¯ ---</span>
<span class="hljs-keyword">const</span> bus = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventBus</span>();

<span class="hljs-keyword">function</span> <span class="hljs-title function_">onUserLogin</span>(<span class="hljs-params">userData</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Analytics Service: User logged in'</span>, userData.<span class="hljs-property">name</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateNavbar</span>(<span class="hljs-params">userData</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'UI Service: Updating navbar for'</span>, userData.<span class="hljs-property">name</span>);
}

bus.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:login'</span>, onUserLogin);
bus.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:login'</span>, updateNavbar);

<span class="hljs-comment">// æŸå¤„ç™»å½•æˆåŠŸå...</span>
bus.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'user:login'</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Mickey'</span> });

<span class="hljs-comment">// ç”¨æˆ·é€€å‡ºæ—¶ï¼Œå¯ä»¥å–æ¶ˆè®¢é˜…</span>
<span class="hljs-comment">// bus.off('user:login', onUserLogin);</span>
</code></pre>
<h2 data-id="heading-22"/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[éƒ¨ç½²openclawä¸aiçš„å¯¹è¯è¿‡ç¨‹]]></title>    <link>https://juejin.cn/post/7602834985902014514</link>    <guid>https://juejin.cn/post/7602834985902014514</guid>    <pubDate>2026-02-04T17:27:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602834985902014514" data-draft-id="7602811649126744115" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="éƒ¨ç½²openclawä¸aiçš„å¯¹è¯è¿‡ç¨‹"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2026-02-04T17:27:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="éš”å£æ™“æ™“"/> <meta itemprop="url" content="https://juejin.cn/user/4499656909521368"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            éƒ¨ç½²openclawä¸aiçš„å¯¹è¯è¿‡ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4499656909521368/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    éš”å£æ™“æ™“
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T17:27:34.000Z" title="Wed Feb 04 2026 17:27:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»45åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">âœ… æ¨èæ–¹æ¡ˆï¼šä½¿ç”¨ <code>@william.qian/simple-wecom</code></h3>
<p>è¿™æ˜¯ç›®å‰æ–‡æ¡£æœ€å®Œå–„ã€ä½¿ç”¨æœ€å¹¿æ³›çš„æ–¹æ¡ˆ</p>
<h4 data-id="heading-1">å®‰è£…æ­¥éª¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å®‰è£…æ’ä»¶ï¼ˆæ³¨æ„æ˜¯è¿™ä¸ªåç§°ï¼‰</span>
clawdbot plugins install @william.qian/simple-wecom

<span class="hljs-comment"># 2. å¯ç”¨æ’ä»¶</span>
clawdbot plugins <span class="hljs-built_in">enable</span> simple-wecom

<span class="hljs-comment"># 3. é…ç½®ä¼ä¸šå¾®ä¿¡ï¼ˆéœ€è¦æ›¿æ¢ä¸ºä½ çš„çœŸå®å‚æ•°ï¼‰</span>
clawdbot config <span class="hljs-built_in">set</span> channels.simple-wecom.corpid <span class="hljs-string">"ww1234567890abcdef"</span>
clawdbot config <span class="hljs-built_in">set</span> channels.simple-wecom.corpsecret <span class="hljs-string">"your-corp-secret"</span>
clawdbot config <span class="hljs-built_in">set</span> channels.simple-wecom.token <span class="hljs-string">"your-token"</span>
clawdbot config <span class="hljs-built_in">set</span> channels.simple-wecom.encodingAESKey <span class="hljs-string">"your-aes-key"</span>
clawdbot config <span class="hljs-built_in">set</span> channels.simple-wecom.enabled <span class="hljs-literal">true</span>

<span class="hljs-comment"># 4. é…ç½®ç½‘å…³</span>
clawdbot config <span class="hljs-built_in">set</span> gateway.mode <span class="hljs-string">"local"</span>
clawdbot config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"0.0.0.0"</span>
clawdbot config <span class="hljs-built_in">set</span> gateway.port 18789

<span class="hljs-comment"># 5. é‡å¯ç½‘å…³</span>
clawdbot gateway restart

<span class="hljs-comment"># 6. éªŒè¯çŠ¶æ€</span>
clawdbot channels status
</code></pre>
<hr/>
<h3 data-id="heading-2">ğŸ” å¦‚æœä¸Šé¢çš„è£…ä¸äº†ï¼Œè¯•è¯•è¿™äº›æ›¿ä»£æ–¹æ¡ˆ</h3>
<h4 data-id="heading-3">æ–¹æ¡ˆäºŒï¼šGitHub å¼€æºæ’ä»¶ï¼ˆåŠŸèƒ½æœ€å…¨ï¼‰[8]</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä» GitHub å…‹éš†å®‰è£…</span>
git <span class="hljs-built_in">clone</span> https://github.com/dingxiang-me/OpenClaw-Wechat.git
<span class="hljs-built_in">cd</span> OpenClaw-Wechat

<span class="hljs-comment"># æœ¬åœ°è·¯å¾„å®‰è£…</span>
clawdbot plugins install -l ./
</code></pre>
<h4 data-id="heading-4">æ–¹æ¡ˆä¸‰ï¼šOpenClaw å®˜æ–¹ wecom æ’ä»¶ [1]</h4>
<p>å¦‚æœä½ ç”¨çš„æ˜¯ <strong>OpenClaw</strong>ï¼ˆClawdbot çš„æ–°åå­—ï¼‰ï¼Œå¯èƒ½å·²ç»é¢„è£…äº†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦å·²å®‰è£…</span>
clawdbot plugins list | grep wecom

<span class="hljs-comment"># å¦‚æœçœ‹åˆ° wecomï¼Œç›´æ¥å¯ç”¨</span>
clawdbot plugins <span class="hljs-built_in">enable</span> wecom
</code></pre>
<hr/>
<h3 data-id="heading-5">â“ å…ˆç¡®è®¤å‡ ä¸ªé—®é¢˜</h3>
<p><strong>1. ä½ è¿è¡Œçš„æ˜¯å“ªä¸ªç‰ˆæœ¬ï¼Ÿ</strong></p>
<pre><code class="hljs language-bash" lang="bash">clawdbot --version
<span class="hljs-comment"># æˆ–</span>
openclaw --version
</code></pre>
<p><strong>2. æŸ¥çœ‹å½“å‰å·²å®‰è£…æ’ä»¶</strong></p>
<pre><code class="hljs language-bash" lang="bash">clawdbot plugins list
</code></pre>
<p><strong>3. ä½ ä¹‹å‰çœ‹åˆ°çš„ <code>@mijia-life/clawdbot-wecom</code> æ˜¯ä»å“ªé‡Œè·å–çš„ï¼Ÿ</strong></p>
<ul>
<li>æ˜¯æŸç¯‡æ•™ç¨‹ï¼Ÿ</li>
<li>è¿˜æ˜¯ <code>clawdbot plugins search wecom</code> æœå‡ºæ¥çš„ï¼Ÿ</li>
</ul>
<hr/>
<h3 data-id="heading-6">ğŸ¯ å¿«é€Ÿè¯Šæ–­</h3>
<p>è¿è¡Œè¿™ä¸ªå‘½ä»¤çœ‹çœ‹æœ‰æ²¡æœ‰ä¼ä¸šå¾®ä¿¡ç›¸å…³æ’ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">clawdbot plugins search wecom
</code></pre>
<p>å¦‚æœæœ‰è¾“å‡ºï¼Œå‘Šè¯‰æˆ‘æ’ä»¶åï¼›å¦‚æœæ²¡è¾“å‡ºï¼Œå°±ç”¨ä¸Šé¢çš„ <strong>@william.qian/simple-wecom</strong> æ–¹æ¡ˆã€‚</p>
<hr/>
<p><strong>ä½ æƒ³å…ˆè¯•å“ªä¸ªæ–¹æ¡ˆï¼Ÿ</strong> æˆ–è€…å‘Šè¯‰æˆ‘ä½ çš„ <code>clawdbot plugins list</code> è¾“å‡ºï¼Œæˆ‘å¸®ä½ åˆ¤æ–­æœ€ä½³å®‰è£…æ–¹å¼ï¼
User: æˆ‘ç”¨çš„æ˜¯openclawï¼Œ2 hollis@lijinghaodeMac-mini ~ % openclaw plugins install @william.qian/simple-wecom</p>
<p>ğŸ¦ OpenClaw 2026.2.1 (ed4529e) â€” I can run local, remote, or purely on vibesâ€”results may vary with DNS.</p>
<p>Downloading @william.qian/simple-wecomâ€¦
Extracting /var/folders/xd/4z9xg52d2ms0sr1gm0gd8lbh0000gn/T/openclaw-npm-pack-7BZ0U8/william.qian-simple-wecom-1.0.2.tgzâ€¦
Error: package.json missing openclaw.extensions
hollis@lijinghaodeMac-mini ~ % openclaw plugins</p>
<p>ğŸ¦ OpenClaw 2026.2.1 (ed4529e) â€” Siri's competent cousin.
Kimi: æ˜ç™½äº†ï¼é”™è¯¯ä¿¡æ¯æ˜¾ç¤º <code>package.json missing openclaw.extensions</code>ï¼Œè¯´æ˜ <strong>@william.qian/simple-wecom</strong> è¿™ä¸ªæ’ä»¶æ˜¯ä¸ºæ—§ç‰ˆ Clawdbot è®¾è®¡çš„ï¼Œ<strong>ä¸å…¼å®¹æ–°ç‰ˆ OpenClaw 2026.2.1</strong>ã€‚</p>
<p>æ–°ç‰ˆ OpenClaw çš„æ’ä»¶ç³»ç»Ÿå˜äº†ï¼Œéœ€è¦ <code>openclaw.extensions</code> å­—æ®µã€‚</p>
<hr/>
<h3 data-id="heading-7">ğŸ” æœç´¢å…¼å®¹ OpenClaw 2026.2 çš„ä¼ä¸šå¾®ä¿¡æ’ä»¶</h3>
<p>å¤ªå¥½äº†ï¼æ‰¾åˆ°äº†å®Œç¾é€‚é… <strong>OpenClaw 2026.2.1</strong> çš„ä¼ä¸šå¾®ä¿¡æ’ä»¶ï¼</p>
<hr/>
<h3 data-id="heading-8">âœ… æ¨èæ–¹æ¡ˆï¼š<code>openclaw-plugin-wecom</code></h3>
<p>GitHub åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsunnoy%2Fopenclaw-plugin-wecom" target="_blank" title="https://github.com/sunnoy/openclaw-plugin-wecom" ref="nofollow noopener noreferrer">github.com/sunnoy/openâ€¦</a></p>
<p>è¿™æ˜¯ä¸“é—¨ä¸º <strong>æ–°ç‰ˆ OpenClaw</strong> å¼€å‘çš„æ’ä»¶ï¼Œæ”¯æŒ 2026 ç‰ˆæœ¬ï¼Œæœ‰ä½ éœ€è¦çš„ <code>openclaw.extensions</code> å­—æ®µã€‚</p>
<hr/>
<h3 data-id="heading-9">ğŸš€ å®‰è£…æ­¥éª¤</h3>
<h4 data-id="heading-10">æ–¹æ³•ä¸€ï¼šç›´æ¥å®‰è£…ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…æ’ä»¶ï¼ˆæ–°ç‰ˆ OpenClaw ä¸“ç”¨ï¼‰</span>
openclaw plugins install openclaw-plugin-wecom
</code></pre>
<h4 data-id="heading-11">æ–¹æ³•äºŒï¼šå¦‚æœä¸Šé¢æ‰¾ä¸åˆ°ï¼Œç”¨ GitHub å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å…ˆå…‹éš†åˆ°æœ¬åœ°</span>
git <span class="hljs-built_in">clone</span> https://github.com/sunnoy/openclaw-plugin-wecom.git
<span class="hljs-built_in">cd</span> openclaw-plugin-wecom

<span class="hljs-comment"># 2. æœ¬åœ°è·¯å¾„å®‰è£…</span>
openclaw plugins install -l ./
</code></pre>
<hr/>
<h3 data-id="heading-12">âš™ï¸ é…ç½®ä¼ä¸šå¾®ä¿¡</h3>
<p>å®‰è£…æˆåŠŸåï¼Œé…ç½®æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<h4 data-id="heading-13">æ–¹å¼ Aï¼šæ™ºèƒ½æœºå™¨äººï¼ˆç®€å•ï¼Œè¢«åŠ¨å›å¤ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŸºç¡€é…ç½®</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.enabled <span class="hljs-literal">true</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.webhookPath /wecom
openclaw config <span class="hljs-built_in">set</span> channels.wecom.token <span class="hljs-string">"ä½ çš„Token"</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.encodingAESKey <span class="hljs-string">"ä½ çš„43ä½EncodingAESKey"</span>

<span class="hljs-comment"># é‡å¯ç½‘å…³</span>
openclaw gateway restart
</code></pre>
<h4 data-id="heading-14">æ–¹å¼ Bï¼šè‡ªå»ºåº”ç”¨ï¼ˆåŠŸèƒ½å…¨ï¼Œæ”¯æŒä¸»åŠ¨å‘æ¶ˆæ¯ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®Œæ•´é…ç½®</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.enabled <span class="hljs-literal">true</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.webhookPath /wecom-app
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.token <span class="hljs-string">"ä½ çš„Token"</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.encodingAESKey <span class="hljs-string">"ä½ çš„43ä½EncodingAESKey"</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.corpId <span class="hljs-string">"ä½ çš„ä¼ä¸šID"</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.corpSecret <span class="hljs-string">"ä½ çš„åº”ç”¨Secret"</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.agentId <span class="hljs-string">"ä½ çš„åº”ç”¨ID"</span>

<span class="hljs-comment"># é‡å¯</span>
openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-15">ğŸ” å…ˆéªŒè¯å®‰è£…</h3>
<p>è¿è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œçœ‹æ˜¯å¦èƒ½æ‰¾åˆ°æ’ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœç´¢æ’ä»¶</span>
openclaw plugins search wecom

<span class="hljs-comment"># æˆ–æŸ¥çœ‹å·²å®‰è£…åˆ—è¡¨</span>
openclaw plugins list
</code></pre>
<hr/>
<h3 data-id="heading-16">â“ è¯·å°è¯•</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw plugins install openclaw-plugin-wecom
</code></pre>
<p><strong>ç»“æœä¼šæ˜¯ï¼š</strong></p>
<ul>
<li>âœ… æˆåŠŸå®‰è£… â†’ ç»§ç»­é…ç½®</li>
<li>âŒ æ‰¾ä¸åˆ°åŒ… â†’ ç”¨ GitHub å…‹éš†æ–¹å¼</li>
</ul>
<p><strong>å‘Šè¯‰æˆ‘å®‰è£…ç»“æœï¼Œæˆ‘å†ç»™ä½ ä¸‹ä¸€æ­¥çš„å…·ä½“é…ç½®å‘½ä»¤ï¼</strong></p>
<hr/>
<h3 data-id="heading-17">ğŸ’¡ ä¼ä¸šå¾®ä¿¡åå°éœ€è¦å‡†å¤‡çš„å‚æ•°</h3>



































<table><thead><tr><th>å‚æ•°</th><th>ä»å“ªé‡Œè·å–</th><th>é•¿åº¦/æ ¼å¼</th></tr></thead><tbody><tr><td><code>token</code></td><td>ä¼ä¸šå¾®ä¿¡åå° â†’ éšæœºè·å–</td><td>ä»»æ„å­—ç¬¦ä¸²</td></tr><tr><td><code>encodingAESKey</code></td><td>ä¼ä¸šå¾®ä¿¡åå° â†’ éšæœºè·å–</td><td><strong>43ä½å­—ç¬¦</strong></td></tr><tr><td><code>corpId</code></td><td>ä¼ä¸šå¾®ä¿¡åå° â†’ æˆ‘çš„ä¼ä¸š â†’ ä¼ä¸šID</td><td>ç±»ä¼¼ <code>ww123456...</code></td></tr><tr><td><code>corpSecret</code></td><td>åº”ç”¨è¯¦æƒ…é¡µ â†’ æŸ¥çœ‹ Secret</td><td>é•¿å­—ç¬¦ä¸²</td></tr><tr><td><code>agentId</code></td><td>åº”ç”¨è¯¦æƒ…é¡µ â†’ AgentId</td><td>æ•°å­—ï¼Œå¦‚ <code>1000002</code></td></tr></tbody></table>
<p><strong>ä½ ç°åœ¨æœ‰ä¼ä¸šå¾®ä¿¡åå°çš„ç®¡ç†å‘˜æƒé™å—ï¼Ÿ</strong> æœ‰çš„è¯å¯ä»¥å…ˆå»åˆ›å»ºæœºå™¨äººå’Œåº”ç”¨ï¼Œæ‹¿åˆ°è¿™äº›å‚æ•°ï¼
User: æˆ‘å·²ç»æˆåŠŸå®‰è£…è¿™ä¸ªäº†ï¼Œhollis@lijinghaodeMac-mini ~ % openclaw plugins install openclaw-plugin-wecom</p>
<p>ğŸ¦ OpenClaw 2026.2.1 (ed4529e) â€” Because texting yourself reminders is so 2024.</p>
<p>Downloading openclaw-plugin-wecomâ€¦
Extracting /var/folders/xd/4z9xg52d2ms0sr1gm0gd8lbh0000gn/T/openclaw-npm-pack-vKfVkG/openclaw-plugin-wecom-1.0.0.tgzâ€¦
Installing to /Users/hollis/.openclaw/extensions/openclaw-plugin-wecomâ€¦
Installing plugin dependenciesâ€¦
2026-02-04T09:46:20.446Z INFO [wecom] WeCom plugin registering...
2026-02-04T09:46:20.446Z INFO [wecom] WeCom channel registered
2026-02-04T09:46:20.446Z INFO [wecom] WeCom HTTP handler registered
Installed plugin: openclaw-plugin-wecom
Restart the gateway to load plugins. ä½†æ˜¯åœ¨ä¼ä¸šå¾®ä¿¡åå°æœºå™¨äººåˆ›å»ºè¿™é‡Œï¼Œurlä¸çŸ¥é“å¡«ä»€ä¹ˆï¼Œæˆ‘ä»¬ç”¨çš„æ˜¯mac
Kimi: å¤ªå¥½äº†ï¼å®‰è£…æˆåŠŸï¼ğŸ‰</p>
<p>ç°åœ¨çš„é—®é¢˜æ˜¯ <strong>URL å¡«ä»€ä¹ˆ</strong>ã€‚å› ä¸ºä½ ç”¨çš„æ˜¯ <strong>Mac</strong>ï¼Œéœ€è¦è®©ä¼ä¸šå¾®ä¿¡æœåŠ¡å™¨èƒ½è®¿é—®åˆ°ä½ æœ¬åœ°çš„ OpenClawã€‚</p>
<hr/>
<h3 data-id="heading-18">ğŸ” æ ¸å¿ƒé—®é¢˜ï¼šä¼ä¸šå¾®ä¿¡éœ€è¦è®¿é—®ä½ çš„ Mac</h3>
<p>ä¼ä¸šå¾®ä¿¡æœåŠ¡å™¨åœ¨äº’è”ç½‘ä¸Šï¼Œå®ƒéœ€è¦å‘é€æ¶ˆæ¯åˆ°ä½ çš„ OpenClawã€‚ä½†ä½ çš„ Mac åœ¨æœ¬åœ°ç½‘ç»œï¼ˆå†…ç½‘ï¼‰ï¼Œéœ€è¦è§£å†³ <strong>å†…ç½‘ç©¿é€</strong> é—®é¢˜ã€‚</p>
<hr/>
<h3 data-id="heading-19">è§£å†³æ–¹æ¡ˆå¯¹æ¯”</h3>





























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>éš¾åº¦</th><th>é€‚ç”¨åœºæ™¯</th><th>ç¨³å®šæ€§</th></tr></thead><tbody><tr><td><strong>A. å†…ç½‘ç©¿é€ï¼ˆæ¨èï¼‰</strong></td><td>â­â­ ä¸­ç­‰</td><td>å¼€å‘æµ‹è¯•</td><td>ä¾èµ–ç¬¬ä¸‰æ–¹</td></tr><tr><td><strong>B. éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨</strong></td><td>â­â­â­ å¤æ‚</td><td>ç”Ÿäº§ç¯å¢ƒ</td><td>é«˜</td></tr><tr><td><strong>C. æœ¬åœ°è°ƒè¯•æ¨¡å¼</strong></td><td>â­ ç®€å•</td><td>å¿«é€ŸéªŒè¯</td><td>ä¸€æ¬¡æ€§</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-20">æ–¹æ¡ˆ Aï¼šå†…ç½‘ç©¿é€ï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰</h3>
<p>ä½¿ç”¨ <strong>ngrok</strong> æˆ– <strong>Cloudflare Tunnel</strong> æŠŠæœ¬åœ°ç«¯å£æš´éœ²åˆ°å…¬ç½‘ã€‚</p>
<h4 data-id="heading-21">æ­¥éª¤ 1ï¼šå®‰è£… ngrok</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”¨ Homebrew å®‰è£…</span>
brew install ngrok

<span class="hljs-comment"># æˆ–è€…å»å®˜ç½‘ä¸‹è½½ https://ngrok.com/download</span>
</code></pre>
<h4 data-id="heading-22">æ­¥éª¤ 2ï¼šæ³¨å†Œ ngrok è´¦å·å¹¶é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ³¨å†Œåè·å– authtokenï¼Œç„¶åé…ç½®</span>
ngrok config add-authtoken ä½ çš„_token
</code></pre>
<h4 data-id="heading-23">æ­¥éª¤ 3ï¼šå¯åŠ¨å†…ç½‘ç©¿é€</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‡è®¾ OpenClaw ç½‘å…³è¿è¡Œåœ¨ 18789 ç«¯å£ï¼ˆé»˜è®¤ï¼‰</span>
<span class="hljs-comment"># å…ˆç¡®è®¤ OpenClaw ç½‘å…³ç«¯å£</span>
openclaw config get gateway.port
<span class="hljs-comment"># é€šå¸¸æ˜¯ 18789</span>

<span class="hljs-comment"># å¯åŠ¨ ngrok è½¬å‘</span>
ngrok http 18789
</code></pre>
<h4 data-id="heading-24">æ­¥éª¤ 4ï¼šè·å–å…¬ç½‘ URL</h4>
<p>è¿è¡Œåä¼šçœ‹åˆ°ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Forwarding  https://abc123.ngrok-free.app -&gt; http://localhost:18789
</code></pre>
<p><strong>è¿™ä¸ª <code>https://abc123.ngrok-free.app</code> å°±æ˜¯ä½ çš„å…¬ç½‘åœ°å€ï¼</strong></p>
<hr/>
<h3 data-id="heading-25">æ­¥éª¤ 5ï¼šé…ç½® OpenClaw ä¼ä¸šå¾®ä¿¡é€šé“</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®åŸºç¡€é…ç½®</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.enabled <span class="hljs-literal">true</span>

<span class="hljs-comment"># webhook è·¯å¾„ï¼ˆä¼ä¸šå¾®ä¿¡ä¼šè®¿é—®è¿™ä¸ªè·¯å¾„ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.webhookPath /wecom

<span class="hljs-comment"># ä¼ä¸šå¾®ä¿¡åå°ç”Ÿæˆçš„ Token</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.token <span class="hljs-string">"ä½ åœ¨ä¼ä¸šå¾®ä¿¡åå°è®¾ç½®çš„Token"</span>

<span class="hljs-comment"># ä¼ä¸šå¾®ä¿¡åå°ç”Ÿæˆçš„ EncodingAESKeyï¼ˆ43ä½ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.encodingAESKey <span class="hljs-string">"ä½ çš„43ä½EncodingAESKey"</span>

<span class="hljs-comment"># é‡å¯ç½‘å…³åŠ è½½æ’ä»¶</span>
openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-26">æ­¥éª¤ 6ï¼šä¼ä¸šå¾®ä¿¡åå°å¡«å†™</h3>





















<table><thead><tr><th>å­—æ®µ</th><th>å¡«å†™å†…å®¹</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://abc123.ngrok-free.app/wecom</code></td></tr><tr><td><strong>Token</strong></td><td>ä½ è®¾ç½®çš„ Tokenï¼ˆä»»æ„å­—ç¬¦ä¸²ï¼‰</td></tr><tr><td><strong>EncodingAESKey</strong></td><td>ç‚¹å‡»"éšæœºç”Ÿæˆ"çš„ 43 ä½å­—ç¬¦ä¸²</td></tr></tbody></table>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>ç¡®ä¿å‹¾é€‰ <strong>"å·²å¼€å¯"</strong></li>
<li>é€‰æ‹© <strong>"æ˜æ–‡æ¨¡å¼"</strong> æˆ– <strong>"å…¼å®¹æ¨¡å¼"</strong>ï¼ˆå¦‚æœç”¨å…¼å®¹æ¨¡å¼éœ€è¦å¡« EncodingAESKeyï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-27">æ–¹æ¡ˆ Bï¼šå¿«é€ŸéªŒè¯ï¼ˆä¸ç©¿é€ï¼Œä»…æœ¬åœ°æµ‹è¯•ï¼‰</h3>
<p>å¦‚æœä½ åªæ˜¯æƒ³éªŒè¯æ’ä»¶æ˜¯å¦å·¥ä½œï¼Œå¯ä»¥å…ˆç”¨ <strong>curl</strong> æœ¬åœ°æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯• OpenClaw æ˜¯å¦è¿è¡Œ</span>
curl http://localhost:18789/wecom \
  -X POST \
  -H <span class="hljs-string">"Content-Type: text/xml"</span> \
  -d <span class="hljs-string">'&lt;xml&gt;&lt;ToUserName&gt;test&lt;/ToUserName&gt;&lt;FromUserName&gt;user&lt;/FromUserName&gt;&lt;CreateTime&gt;123456&lt;/CreateTime&gt;&lt;MsgType&gt;text&lt;/MsgType&gt;&lt;Content&gt;ä½ å¥½&lt;/Content&gt;&lt;/xml&gt;'</span>
</code></pre>
<hr/>
<h3 data-id="heading-28">ä½ ç°åœ¨éœ€è¦åšçš„</h3>
<p><strong>1. ç¡®è®¤ OpenClaw ç½‘å…³ç«¯å£</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw config get gateway.port
</code></pre>
<p><strong>2. å®‰è£… ngrok</strong></p>
<pre><code class="hljs language-bash" lang="bash">brew install ngrok
</code></pre>
<p><strong>3. æ³¨å†Œ ngrok è´¦å·</strong> â†’ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdashboard.ngrok.com%2Fsignup" target="_blank" title="https://dashboard.ngrok.com/signup" ref="nofollow noopener noreferrer">dashboard.ngrok.com/signup</a></p>
<p><strong>4. é…ç½®å¹¶å¯åŠ¨</strong></p>
<p>å‘Šè¯‰æˆ‘ï¼š</p>
<ul>
<li>ä½ çš„ <code>gateway.port</code> æ˜¯å¤šå°‘ï¼Ÿ</li>
<li>æœ‰æ²¡æœ‰ ngrok è´¦å·ï¼Ÿ</li>
</ul>
<p>æˆ‘å¸®ä½ å†™å®Œæ•´çš„å¯åŠ¨å‘½ä»¤ï¼ ğŸš€
User: æˆ‘å®‰è£…ngrokå¥½äº†ï¼Œæ€ä¹ˆæ³¨å†Œï¼Œæ­¥éª¤äºŒæ€ä¹ˆåš
Kimi: å¥½çš„ï¼ä¸€æ­¥æ­¥æ¥ ğŸ‘‡</p>
<hr/>
<h3 data-id="heading-29">æ­¥éª¤ 1ï¼šæ³¨å†Œ ngrok è´¦å·</h3>
<p><strong>æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">https:<span class="hljs-comment">//dashboard.ngrok.com/signup</span>
</code></pre>
<p><strong>æ³¨å†Œæ–¹å¼ï¼ˆä¸‰é€‰ä¸€ï¼‰ï¼š</strong></p>
<ul>
<li>GitHub è´¦å·ç™»å½•ï¼ˆæœ€å¿«ï¼‰</li>
<li>Google è´¦å·ç™»å½•</li>
<li>é‚®ç®±æ³¨å†Œ</li>
</ul>
<hr/>
<h3 data-id="heading-30">æ­¥éª¤ 2ï¼šè·å– Authtoken</h3>
<p>æ³¨å†Œç™»å½•åï¼š</p>
<ol>
<li><strong>è¿›å…¥ Dashboard</strong> â†’ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdashboard.ngrok.com" target="_blank" title="https://dashboard.ngrok.com" ref="nofollow noopener noreferrer">dashboard.ngrok.com</a></li>
<li>å·¦ä¾§èœå•ç‚¹å‡» <strong>"Your Authtoken"</strong></li>
<li>ç‚¹å‡» <strong>"Copy"</strong> æŒ‰é’®å¤åˆ¶</li>
</ol>
<p><strong>Authtoken é•¿è¿™æ ·ï¼š</strong></p>
<pre><code class="hljs">2KxZ...å¾ˆé•¿ä¸€ä¸²å­—ç¬¦...xyz
</code></pre>
<hr/>
<h3 data-id="heading-31">æ­¥éª¤ 3ï¼šé…ç½® ngrokï¼ˆåœ¨ç»ˆç«¯æ‰§è¡Œï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç²˜è´´ä½ å¤åˆ¶çš„ token</span>
ngrok config add-authtoken 2KxZä½ çš„tokenè¿™é‡Œ
</code></pre>
<p><strong>æˆåŠŸåä¼šæ˜¾ç¤ºï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Authtoken</span> saved to configuration <span class="hljs-attr">file</span>: <span class="hljs-regexp">/Users/</span>hollis/.<span class="hljs-property">config</span>/ngrok/ngrok.<span class="hljs-property">yml</span>
</code></pre>
<hr/>
<h3 data-id="heading-32">æ­¥éª¤ 4ï¼šç¡®è®¤ OpenClaw ç«¯å£</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å½“å‰ç½‘å…³ç«¯å£</span>
openclaw config get gateway.port
</code></pre>
<p><strong>å¦‚æœæ˜¾ç¤ºç©ºæˆ– 0ï¼Œè®¾ç½®ä¸ºé»˜è®¤ç«¯å£ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> gateway.port 18789
</code></pre>
<hr/>
<h3 data-id="heading-33">æ­¥éª¤ 5ï¼šå¯åŠ¨å†…ç½‘ç©¿é€</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨ ngrokï¼ŒæŠŠæœ¬åœ° 18789 ç«¯å£æš´éœ²åˆ°å…¬ç½‘</span>
ngrok http 18789
</code></pre>
<p><strong>æˆåŠŸåä¼šçœ‹åˆ°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java">Session Status                online
Account                       <span class="hljs-title function_">hollis</span> <span class="hljs-params">(Plan: Free)</span>  
Version                       <span class="hljs-number">3.</span>x.x
Region                        Asia <span class="hljs-title function_">Pacific</span> <span class="hljs-params">(ap)</span>
Web Interface                 http:<span class="hljs-comment">//127.0.0.1:4040</span>
Forwarding                    https:<span class="hljs-comment">//abc123-def456.ngrok-free.app -&gt; http://localhost:18789</span>
</code></pre>
<p><strong>å…³é”®ä¿¡æ¯ï¼š</strong></p>
<ul>
<li><code>https://abc123-def456.ngrok-free.app</code> â† <strong>è¿™æ˜¯ä½ çš„å…¬ç½‘ URL</strong></li>
</ul>
<hr/>
<h3 data-id="heading-34">æ­¥éª¤ 6ï¼šé…ç½®ä¼ä¸šå¾®ä¿¡åå°</h3>





















<table><thead><tr><th>å­—æ®µ</th><th>å¡«å†™å†…å®¹</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://abc123-def456.ngrok-free.app/wecom</code></td></tr><tr><td><strong>Token</strong></td><td>ä»»æ„è®¾ç½®ï¼Œå¦‚ <code>OpenClaw2024</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td>ç‚¹å‡»"éšæœºç”Ÿæˆ"</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-35">æ­¥éª¤ 7ï¼šé…ç½® OpenClaw</h3>
<p><strong>ä¿æŒ ngrok è¿è¡Œ</strong>ï¼Œæ–°å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®ä¼ä¸šå¾®ä¿¡é…ç½®</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.enabled <span class="hljs-literal">true</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.webhookPath /wecom
openclaw config <span class="hljs-built_in">set</span> channels.wecom.token <span class="hljs-string">"OpenClaw2024"</span>  <span class="hljs-comment"># å’Œä¸Šé¢è®¾ç½®çš„Tokenä¸€è‡´</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom.encodingAESKey <span class="hljs-string">"ä¼ä¸šå¾®ä¿¡ç”Ÿæˆçš„43ä½Key"</span>

<span class="hljs-comment"># é‡å¯ç½‘å…³</span>
openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-36">ä½ ç°åœ¨åšåˆ°å“ªä¸€æ­¥äº†ï¼Ÿ</h3>





























<table><thead><tr><th>æ­¥éª¤</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>æ³¨å†Œ ngrok è´¦å·</td><td>â¬œ å¾…å®Œæˆ</td></tr><tr><td>å¤åˆ¶ Authtoken</td><td>â¬œ å¾…å®Œæˆ</td></tr><tr><td>é…ç½® ngrok</td><td>â¬œ å¾…å®Œæˆ</td></tr><tr><td>å¯åŠ¨ ngrok</td><td>â¬œ å¾…å®Œæˆ</td></tr><tr><td>é…ç½®ä¼ä¸šå¾®ä¿¡</td><td>â¬œ å¾…å®Œæˆ</td></tr></tbody></table>
<p><strong>å…ˆå» <a href="https://link.juejin.cn?target=https%3A%2F%2Fdashboard.ngrok.com%2Fsignup" target="_blank" title="https://dashboard.ngrok.com/signup" ref="nofollow noopener noreferrer">dashboard.ngrok.com/signup</a> æ³¨å†Œï¼Œæ‹¿åˆ° Authtoken åå‘Šè¯‰æˆ‘ï¼Œæˆ‘ç»§ç»­å¸¦ä½ ä¸‹ä¸€æ­¥ï¼</strong> ğŸš€
User: ä»–å†…ç½‘ç©¿é€æ˜¯ä»€ä¹ˆåŸç†ï¼Œå¦‚æœæˆ‘macé‡å¯äº†å‘¢è¿˜æœ‰æ•ˆå—
Kimi: å¥½é—®é¢˜ï¼æˆ‘æ¥ç”¨ç®€å•çš„æ–¹å¼è§£é‡Šæ¸…æ¥š ğŸ‘‡</p>
<hr/>
<h3 data-id="heading-37">ğŸ” å†…ç½‘ç©¿é€æ˜¯ä»€ä¹ˆåŸç†ï¼Ÿ</h3>
<h4 data-id="heading-38">ä¸€å¥è¯è§£é‡Š</h4>
<blockquote>
<p><strong>ngrok å°±åƒä¸€ä¸ª"å¿«é€’ä¸­è½¬ç«™"</strong>ï¼Œè®©ä¼ä¸šå¾®ä¿¡æœåŠ¡å™¨èƒ½æŠŠæ¶ˆæ¯"å¯„"åˆ°ä½ å®¶é‡Œçš„ Mac ä¸Šã€‚</p>
</blockquote>
<h4 data-id="heading-39">å›¾è§£</h4>
<pre><code class="hljs language-markdown" lang="markdown">ä¼ä¸šå¾®ä¿¡ç”¨æˆ·
<span class="hljs-code">    â†“ å‘æ¶ˆæ¯
ä¼ä¸šå¾®ä¿¡æœåŠ¡å™¨ï¼ˆäº’è”ç½‘ä¸Šï¼‰
    â†“ å‘é€åˆ° ngrok æä¾›çš„å…¬ç½‘åœ°å€
ngrok äº‘æœåŠ¡å™¨ï¼ˆä¸­è½¬ç«™ï¼‰
    â†“ è½¬å‘åˆ°ä½ ç”µè„‘
ä½ çš„ Macï¼ˆlocalhost:18789ï¼‰
    â†“ OpenClaw å¤„ç†
å›å¤æ¶ˆæ¯åŸè·¯è¿”å›
</span></code></pre>
<h4 data-id="heading-40">æŠ€æœ¯åŸç†</h4>





















<table><thead><tr><th>æ¦‚å¿µ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><strong>éš§é“ï¼ˆTunnelï¼‰</strong></td><td>ngrok åœ¨ä½ ç”µè„‘å’Œäº‘ç«¯ä¹‹é—´å»ºç«‹åŠ å¯†é€šé“</td></tr><tr><td><strong>åå‘ä»£ç†</strong></td><td>å…¬ç½‘è¯·æ±‚ â†’ ngrok äº‘ç«¯ â†’ ä½ çš„æœ¬åœ°ç«¯å£</td></tr><tr><td><strong>éšæœºå­åŸŸå</strong></td><td>æ¯æ¬¡å¯åŠ¨åˆ†é… <code>abc123.ngrok-free.app</code> è¿™æ ·çš„ä¸´æ—¶åœ°å€</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-41">â“ Mac é‡å¯åè¿˜æœ‰æ•ˆå—ï¼Ÿ</h3>
<p><strong>ç­”æ¡ˆæ˜¯ï¼šå¤±æ•ˆï¼éœ€è¦é‡æ–°å¯åŠ¨</strong></p>

























<table><thead><tr><th>æƒ…å†µ</th><th>ç»“æœ</th></tr></thead><tbody><tr><td><strong>å…³é—­ ngrok ç»ˆç«¯</strong></td><td>âŒ éš§é“æ–­å¼€ï¼ŒURL å¤±æ•ˆ</td></tr><tr><td><strong>Mac é‡å¯</strong></td><td>âŒ å®Œå…¨å¤±æ•ˆï¼Œngrok æ²¡è¿è¡Œ</td></tr><tr><td><strong>ç½‘ç»œåˆ‡æ¢ï¼ˆWiFiæ–­/æ¢ï¼‰</strong></td><td>âŒ éš§é“æ–­å¼€</td></tr><tr><td><strong>é‡æ–°å¯åŠ¨ ngrok</strong></td><td>âš ï¸<strong>URL ä¼šå˜</strong>ï¼ˆå…è´¹ç‰ˆï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-42">ğŸ”„ å…è´¹ç‰ˆ vs ä»˜è´¹ç‰ˆå¯¹æ¯”</h3>






























<table><thead><tr><th>åŠŸèƒ½</th><th>å…è´¹ç‰ˆ</th><th>ä»˜è´¹ç‰ˆï¼ˆ$5/æœˆèµ·ï¼‰</th></tr></thead><tbody><tr><td>éšæœº URL</td><td>âœ… æ¯æ¬¡å˜</td><td>âœ… å›ºå®šå­åŸŸå</td></tr><tr><td>è¿æ¥æ—¶é•¿</td><td>æœ‰é™åˆ¶</td><td>æ— é™åˆ¶</td></tr><tr><td>è‡ªå®šä¹‰åŸŸå</td><td>âŒ</td><td>âœ…</td></tr><tr><td>é‡å¯å URL å˜åŒ–</td><td>âœ… ä¼šå˜</td><td>âŒ å›ºå®šä¸å˜</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-43">ğŸ’¡ å¯¹ä½ æ¥è¯´çš„å®é™…æƒ…å†µ</h3>
<h4 data-id="heading-44">å¼€å‘æµ‹è¯•é˜¶æ®µï¼ˆç°åœ¨ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¯æ¬¡ Mac å¼€æœºåï¼Œéœ€è¦æ‰‹åŠ¨å¯åŠ¨</span>
ngrok http 18789

<span class="hljs-comment"># ç„¶åå¤åˆ¶æ–°çš„ URL åˆ°ä¼ä¸šå¾®ä¿¡åå°</span>
<span class="hljs-comment"># æœ‰ç‚¹éº»çƒ¦ï¼Œä½†å…è´¹</span>
</code></pre>
<h4 data-id="heading-45">é•¿æœŸè§£å†³æ–¹æ¡ˆï¼ˆæ¨èï¼‰</h4>
<p><strong>æ–¹æ¡ˆ Aï¼šå›ºå®šå­åŸŸåï¼ˆä»˜è´¹ ngrokï¼‰</strong></p>
<ul>
<li>æ¯æœˆ $5-8</li>
<li>è·å¾—å›ºå®š URLï¼š<code>https://hollis-openclaw.ngrok.io</code></li>
<li>Mac é‡å¯å URL ä¸å˜ï¼Œåªéœ€é‡æ–°å¯åŠ¨ ngrok</li>
</ul>
<p><strong>æ–¹æ¡ˆ Bï¼šéƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</strong></p>
<ul>
<li>é˜¿é‡Œäº‘/è…¾è®¯äº‘è½»é‡æœåŠ¡å™¨ï¼ˆçº¦ 50-100å…ƒ/æœˆï¼‰</li>
<li>OpenClaw 24å°æ—¶è¿è¡Œ</li>
<li>å›ºå®š IPï¼Œä¼ä¸šå¾®ä¿¡é…ç½®ä¸€æ¬¡æ°¸ä¹…æœ‰æ•ˆ</li>
</ul>
<p><strong>æ–¹æ¡ˆ Cï¼šæœ¬åœ°å¼€å‘ä¸“ç”¨ï¼ˆç°åœ¨å…ˆç”¨ç€ï¼‰</strong></p>
<ul>
<li>æ¯æ¬¡å¼€å‘æµ‹è¯•æ—¶å¯åŠ¨ ngrok</li>
<li>ä¼ä¸šå¾®ä¿¡åå°æ›´æ–° URL</li>
<li>é€‚åˆå­¦ä¹ é˜¶æ®µ</li>
</ul>
<hr/>
<h3 data-id="heading-46">ğŸ¯ ä½ ç°åœ¨è¯¥åšä»€ä¹ˆï¼Ÿ</h3>
<h4 data-id="heading-47">ç°åœ¨ï¼ˆå…è´¹æ–¹æ¡ˆï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å¯åŠ¨ ngrokï¼ˆæ¯æ¬¡å¼€æœºåæ‰§è¡Œï¼‰</span>
ngrok http 18789

<span class="hljs-comment"># 2. å¤åˆ¶æ˜¾ç¤ºçš„ https://xxx.ngrok-free.app</span>

<span class="hljs-comment"># 3. å»ä¼ä¸šå¾®ä¿¡åå°æ›´æ–° URL</span>

<span class="hljs-comment"># 4. æµ‹è¯•æœºå™¨äºº</span>
</code></pre>
<h4 data-id="heading-48">å¦‚æœå«Œæ¯æ¬¡æ”¹ URL éº»çƒ¦</h4>
<p>å¯ä»¥è€ƒè™‘ï¼š</p>
<ol>
<li><strong>ä»˜è´¹ ngrok</strong>ï¼ˆ$5/æœˆï¼‰â†’ å›ºå®šå­åŸŸå</li>
<li><strong>è´­ä¹°äº‘æœåŠ¡å™¨</strong>ï¼ˆ50å…ƒ/æœˆï¼‰â†’ æ°¸ä¹…åœ¨çº¿</li>
</ol>
<hr/>
<h3 data-id="heading-49">â“ ä½ æƒ³æ€ä¹ˆé€‰ï¼Ÿ</h3>





















<table><thead><tr><th>ä½ çš„æƒ…å†µ</th><th>å»ºè®®æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>åªæ˜¯å­¦ä¹ /æµ‹è¯•</td><td>å…è´¹ ngrokï¼Œæ¯æ¬¡æ‰‹åŠ¨å¯åŠ¨</td></tr><tr><td>é•¿æœŸè‡ªç”¨</td><td>ä»˜è´¹ ngrok å›ºå®šåŸŸå</td></tr><tr><td>å›¢é˜Ÿä½¿ç”¨/ç¨³å®šæœåŠ¡</td><td>äº‘æœåŠ¡å™¨éƒ¨ç½²</td></tr></tbody></table>
<p><strong>å‘Šè¯‰æˆ‘ä½ çš„éœ€æ±‚ï¼Œæˆ‘å¸®ä½ é€‰æœ€ä½³æ–¹æ¡ˆï¼</strong> ğŸš€
User: openclaw config set channels.wecom-app.corpId "ä½ çš„ä¼ä¸šID" ä¼ä¸šidé‚£é‡Œè·å–
Kimi: å¥½çš„ï¼ä¼ä¸š ID è·å–æ­¥éª¤å¦‚ä¸‹ ğŸ‘‡</p>
<hr/>
<h3 data-id="heading-50">è·å–ä¼ä¸š IDï¼ˆCorpIDï¼‰</h3>
<h4 data-id="heading-51">æ­¥éª¤ 1ï¼šç™»å½•ä¼ä¸šå¾®ä¿¡ç®¡ç†åå°</h4>
<p><strong>ç½‘å€ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwork.weixin.qq.com%2Fwework_admin" target="_blank" title="https://work.weixin.qq.com/wework_admin" ref="nofollow noopener noreferrer">work.weixin.qq.com/wework_admiâ€¦</a></p>
<p>ç”¨<strong>ç®¡ç†å‘˜è´¦å·</strong>æ‰«ç ç™»å½•</p>
<hr/>
<h4 data-id="heading-52">æ­¥éª¤ 2ï¼šæ‰¾åˆ°ä¼ä¸š ID</h4>
<p>ç™»å½•åï¼š</p>
<ol>
<li>é¡¶éƒ¨èœå•ç‚¹å‡» <strong>"æˆ‘çš„ä¼ä¸š"</strong></li>
<li>é¡µé¢æ‹‰åˆ°æœ€ä¸‹æ–¹</li>
<li>çœ‹åˆ° <strong>"ä¼ä¸šID"</strong> ä¸€æ </li>
</ol>
<pre><code class="hljs language-css" lang="css">ä¼ä¸šID
ww1234567890abcdef
<span class="hljs-selector-attr">[æŸ¥çœ‹]</span>
</code></pre>
<p>ç‚¹å‡» <strong>"æŸ¥çœ‹"</strong> æŒ‰é’®ï¼Œå¤åˆ¶è¿™ä¸²å­—ç¬¦</p>
<hr/>
<h4 data-id="heading-53">æ­¥éª¤ 3ï¼šå¡«å…¥ OpenClaw</h4>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.corpId <span class="hljs-string">"ww1234567890abcdef"</span>
</code></pre>
<hr/>
<h3 data-id="heading-54">å®Œæ•´é…ç½®å‘½ä»¤ï¼ˆç­‰ä¸‹ä¸€èµ·æ‰§è¡Œï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¼ä¸šIDï¼ˆåˆšæ‰è·å–çš„ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.corpId <span class="hljs-string">"wwä½ çš„ä¼ä¸šID"</span>

<span class="hljs-comment"># åº”ç”¨å‡­è¯ï¼ˆä¸‹ä¸€æ­¥è·å–ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.corpSecret <span class="hljs-string">"åº”ç”¨çš„Secret"</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.agentId <span class="hljs-string">"1000002"</span>

<span class="hljs-comment"># æœºå™¨äººé…ç½®ï¼ˆä¼ä¸šå¾®ä¿¡åå°ç”Ÿæˆçš„ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.token <span class="hljs-string">"ä½ çš„Token"</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.encodingAESKey <span class="hljs-string">"ä½ çš„43ä½EncodingAESKey"</span>

<span class="hljs-comment"># å¯ç”¨å¹¶é‡å¯</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app.enabled <span class="hljs-literal">true</span>
openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-55">âš ï¸ æ³¨æ„ï¼šCorpSecret å’Œ AgentId è¿˜éœ€è¦åˆ›å»ºåº”ç”¨</h3>
<p>ä¼ä¸š ID åªæ˜¯ç¬¬ä¸€æ­¥ï¼Œè¿˜éœ€è¦ï¼š</p>






























<table><thead><tr><th>å‚æ•°</th><th>è·å–ä½ç½®</th><th>ä¸‹ä¸€æ­¥æ“ä½œ</th></tr></thead><tbody><tr><td><strong>corpId</strong></td><td>æˆ‘çš„ä¼ä¸š â†’ ä¼ä¸šID</td><td>âœ… å·²è·å–</td></tr><tr><td><strong>agentId</strong></td><td>åº”ç”¨ç®¡ç† â†’ åˆ›å»ºåº”ç”¨</td><td>éœ€è¦åˆ›å»ºè‡ªå»ºåº”ç”¨</td></tr><tr><td><strong>corpSecret</strong></td><td>åº”ç”¨è¯¦æƒ…é¡µ</td><td>åˆ›å»ºåº”ç”¨åæŸ¥çœ‹</td></tr><tr><td><strong>token/encodingAESKey</strong></td><td>æ¥æ”¶æ¶ˆæ¯è®¾ç½®</td><td>éšæœºç”Ÿæˆ</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-56">ä½ ç°åœ¨åšåˆ°å“ªä¸€æ­¥äº†ï¼Ÿ</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ç™»å½•äº†ä¼ä¸šå¾®ä¿¡åå°ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ‰¾åˆ°ä¼ä¸š ID äº†ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> åˆ›å»ºè‡ªå»ºåº”ç”¨äº†å—ï¼Ÿ</li>
</ul>
<p><strong>å‘Šè¯‰æˆ‘è¿›åº¦ï¼Œæˆ‘ç»§ç»­å¸¦ä½ ä¸‹ä¸€æ­¥ï¼</strong> ğŸš€
User: engxiaochao@dengxiaochao ~ %
dengxiaochao@dengxiaochao ~ % openclaw config set channels.wecom-app.enabled true</p>
<p>(node:29800) [DEP0040] DeprecationWarning: The <code>punycode</code> module is deprecated. Please use a userland alternative instead.
(Use <code>node --trace-deprecation ...</code> to show where the warning was created)
2026-02-04T10:46:29.015Z INFO [wecom] WeCom plugin registering...
2026-02-04T10:46:29.018Z INFO [wecom] WeCom channel registered
2026-02-04T10:46:29.019Z INFO [wecom] WeCom HTTP handler registered</p>
<p>ğŸ¦ OpenClaw 2026.1.30 (76b5208) â€” Because texting yourself reminders is so 2024.</p>
<p>Error: Config validation failed: channels.wecom-app: unknown channel id: wecom-app ä¸ºå•¥
Kimi: æ˜ç™½äº†ï¼é”™è¯¯æç¤º <code>unknown channel id: wecom-app</code>ï¼Œè¯´æ˜è¿™ä¸ªæ’ä»¶æ³¨å†Œçš„é€šé“åä¸æ˜¯ <code>wecom-app</code>ï¼Œè€Œæ˜¯å…¶ä»–åå­—ã€‚</p>
<hr/>
<h3 data-id="heading-57">ğŸ” æŸ¥çœ‹æ’ä»¶å®é™…æ³¨å†Œçš„é€šé“å</h3>
<p>è¿è¡Œè¿™ä¸ªå‘½ä»¤æŸ¥çœ‹å¯ç”¨çš„é€šé“ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å¯ç”¨é€šé“</span>
openclaw channels list

<span class="hljs-comment"># æˆ–æŸ¥çœ‹é…ç½®</span>
openclaw config get channels
</code></pre>
<hr/>
<h3 data-id="heading-58">å¯èƒ½çš„æ­£ç¡®é€šé“å</h3>
<p>æ ¹æ®æ’ä»¶æ—¥å¿— <code>WeCom channel registered</code>ï¼Œå¯èƒ½çš„åç§°æ˜¯ï¼š</p>





















<table><thead><tr><th>å°è¯•åç§°</th><th>å‘½ä»¤</th></tr></thead><tbody><tr><td><code>wecom</code></td><td><code>openclaw config set channels.wecom.enabled true</code></td></tr><tr><td><code>wecom-app</code></td><td>ä½ åˆšæ‰è¯•çš„ï¼ŒæŠ¥é”™</td></tr><tr><td><code>wechat-work</code></td><td><code>openclaw config set channels.wechat-work.enabled true</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-59">å¿«é€Ÿè¯Šæ–­</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹æ’ä»¶è¯¦æƒ…</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw plugins info openclaw-plugin-wecom
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹æ‰€æœ‰é…ç½®é¡¹</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw config list
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šç›´æ¥æœç´¢ wecom ç›¸å…³é…ç½®</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw config list | grep wecom
</code></pre>
<hr/>
<h3 data-id="heading-60">ä¸´æ—¶è§£å†³æ–¹æ¡ˆ</h3>
<p>å¦‚æœæŸ¥ä¸åˆ°ï¼Œç›´æ¥ç”¨ <strong>ç¯å¢ƒå˜é‡æ–¹å¼</strong> é…ç½®ï¼ˆè·³è¿‡éªŒè¯ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆå½“å‰ç»ˆç«¯æœ‰æ•ˆï¼‰</span>
<span class="hljs-built_in">export</span> WECOM_CORPID=<span class="hljs-string">"wwä½ çš„ä¼ä¸šID"</span>
<span class="hljs-built_in">export</span> WECOM_CORPSECRET=<span class="hljs-string">"ä½ çš„Secret"</span>
<span class="hljs-built_in">export</span> WECOM_AGENTID=<span class="hljs-string">"1000002"</span>
<span class="hljs-built_in">export</span> WECOM_TOKEN=<span class="hljs-string">"ä½ çš„Token"</span>
<span class="hljs-built_in">export</span> WECOM_ENCODINGAESKEY=<span class="hljs-string">"ä½ çš„43ä½Key"</span>

<span class="hljs-comment"># ç„¶åå¯åŠ¨ç½‘å…³</span>
openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-61">ä½ ç°åœ¨æ‰§è¡Œè¿™ä¸ª</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw channels list
</code></pre>
<p><strong>æŠŠè¾“å‡ºç»“æœå¤åˆ¶ç»™æˆ‘</strong>ï¼Œæˆ‘çœ‹çœ‹å®é™…çš„é€šé“åæ˜¯ä»€ä¹ˆï¼ ğŸ¯
User: o@dengxiaochao ~ % openclaw config get channels</p>
<p>(node:32663) [DEP0040] DeprecationWarning: The <code>punycode</code> module is deprecated. Please use a userland alternative instead.
(Use <code>node --trace-deprecation ...</code> to show where the warning was created)
2026-02-04T10:53:06.063Z INFO [wecom] WeCom plugin registering...
2026-02-04T10:53:06.064Z INFO [wecom] WeCom channel registered
2026-02-04T10:53:06.066Z INFO [wecom] WeCom HTTP handler registered</p>
<p>ğŸ¦ OpenClaw 2026.1.30 (76b5208)
If you can describe it, I can probably automate itâ€”or at least make it funnier.</p>
<p>Config path not found: channels
Kimi: æ˜ç™½äº†ï¼<code>channels</code> è·¯å¾„ä¸å­˜åœ¨ï¼Œè¯´æ˜æ’ä»¶å¯èƒ½ç”¨çš„æ˜¯ä¸åŒçš„é…ç½®ç»“æ„ã€‚</p>
<p>è®©æˆ‘æœç´¢ä¸€ä¸‹è¿™ä¸ªæ’ä»¶çš„æ­£ç¡®é…ç½®æ–¹å¼ï¼š
å¤ªå¥½äº†ï¼æ‰¾åˆ°é—®é¢˜äº†ï¼æ ¹æ®æœç´¢ç»“æœï¼Œä½ å®‰è£…çš„æ’ä»¶ <code>openclaw-plugin-wecom</code> çš„<strong>æ­£ç¡®é€šé“åæ˜¯ <code>wecom</code></strong>ï¼Œä¸æ˜¯ <code>wecom-app</code>ã€‚</p>
<p>è€Œä¸”é…ç½®æ–¹å¼è¦ç”¨ <strong>JSON æ ¼å¼</strong> æˆ–è€… <strong>ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-62">âœ… æ­£ç¡®çš„é…ç½®æ–¹å¼</h3>
<h4 data-id="heading-63">æ–¹æ³•ä¸€ï¼šä½¿ç”¨ --json å‚æ•°ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{
  "enabled": true,
  "webhookPath": "/wecom",
  "token": "ä½ çš„Token",
  "encodingAESKey": "ä½ çš„43ä½EncodingAESKey",
  "receiveId": "",
  "dm": { "policy": "pairing" }
}'</span> --json
</code></pre>
<h4 data-id="heading-64">æ–¹æ³•äºŒï¼šç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰“å¼€é…ç½®æ–‡ä»¶</span>
nano ~/.openclaw/openclaw.json
</code></pre>
<p>æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"webhookPath"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/wecom"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ çš„Token"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"encodingAESKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ çš„43ä½EncodingAESKey"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"receiveId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"dm"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"policy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pairing"</span> <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-65">ğŸš€ å®Œæ•´æ­¥éª¤ï¼ˆç°åœ¨æ‰§è¡Œï¼‰</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šé…ç½®ä¼ä¸šå¾®ä¿¡é€šé“</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{
  "enabled": true,
  "webhookPath": "/wecom",
  "token": "ä½ åœ¨ä¼ä¸šå¾®ä¿¡åå°è®¾ç½®çš„Token",
  "encodingAESKey": "ä½ åœ¨ä¼ä¸šå¾®ä¿¡åå°ç”Ÿæˆçš„43ä½Key",
  "receiveId": "",
  "dm": { "policy": "pairing" }
}'</span> --json
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šé‡å¯ç½‘å…³</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw gateway restart
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šéªŒè¯çŠ¶æ€</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw channels status
</code></pre>
<hr/>
<h3 data-id="heading-66">ğŸ” å¦‚æœè¦ç”¨è‡ªå»ºåº”ç”¨ï¼ˆwecom-appï¼‰åŠŸèƒ½</h3>
<p>ä½ ä¹‹å‰å°è¯•çš„ <code>wecom-app</code> éœ€è¦å®‰è£…å¦ä¸€ä¸ªæ’ä»¶ <code>@openclaw-china/channels</code> ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…ç¤¾åŒºç‰ˆæ’ä»¶ï¼ˆæ”¯æŒæ›´å¤šåŠŸèƒ½ï¼‰</span>
openclaw plugins install @openclaw-china/channels

<span class="hljs-comment"># ç„¶åé…ç½® wecom-app</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom-app <span class="hljs-string">'{
  "enabled": true,
  "webhookPath": "/wecom-app",
  "token": "your-token",
  "encodingAESKey": "your-43-char-key",
  "corpId": "your-corp-id",
  "corpSecret": "your-app-secret",
  "agentId": 1000002
}'</span> --json
</code></pre>
<hr/>
<h3 data-id="heading-67">ä½ ç°åœ¨æ‰§è¡Œè¿™ä¸ª</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…ˆç¡®è®¤æ’ä»¶å®‰è£…æˆåŠŸ</span>
openclaw plugins list | grep wecom

<span class="hljs-comment"># ç„¶åç”¨ JSON æ–¹å¼é…ç½®</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"ä½ çš„Token","encodingAESKey":"ä½ çš„43ä½Key","receiveId":"","dm":{"policy":"pairing"}}'</span> --json

<span class="hljs-comment"># é‡å¯</span>
openclaw gateway restart
</code></pre>
<p><strong>æŠŠ <code>ä½ çš„Token</code> å’Œ <code>ä½ çš„43ä½Key</code> æ›¿æ¢æˆä¼ä¸šå¾®ä¿¡åå°ç”Ÿæˆçš„çœŸå®å€¼ï¼</strong></p>
<p>æ‰§è¡Œåå‘Šè¯‰æˆ‘ç»“æœï¼ ğŸ¯
User: "installs": {
"openclaw-plugin-wecom": {
"source": "npm",
"spec": "openclaw-plugin-wecom",
"installPath": "/Users/dengxiaochao/.openclaw/extensions/openclaw-plugin-wecom",
"version": "1.0.0",
"installedAt": "2026-02-04T10:44:21.631Z"
}
Kimi: å¥½çš„ï¼Œæ’ä»¶å®‰è£…æˆåŠŸï¼ç°åœ¨ç”¨ <strong>JSON æ ¼å¼</strong> é…ç½® <code>wecom</code> é€šé“ã€‚</p>
<hr/>
<h3 data-id="heading-68">ç°åœ¨æ‰§è¡Œè¿™ä¸ªå‘½ä»¤</h3>
<p>æŠŠä¸‹é¢çš„ <code>ä½ çš„Token</code> å’Œ <code>ä½ çš„43ä½EncodingAESKey</code> æ›¿æ¢æˆä¼ä¸šå¾®ä¿¡åå°çš„çœŸå®å€¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"ä½ çš„Token","encodingAESKey":"ä½ çš„43ä½EncodingAESKey","receiveId":"","dm":{"policy":"pairing"}}'</span> --json
</code></pre>
<hr/>
<h3 data-id="heading-69">ç¤ºä¾‹ï¼ˆå‡è®¾ä½ çš„å€¼ï¼‰</h3>
<p>å¦‚æœä½ åœ¨ä¼ä¸šå¾®ä¿¡åå°è®¾ç½®çš„ï¼š</p>
<ul>
<li><strong>Token</strong>: <code>OpenClaw2024</code></li>
<li><strong>EncodingAESKey</strong>: <code>abcdefghijklmnopqrstuvwxyz1234567890123456</code>ï¼ˆ43ä½ï¼‰</li>
</ul>
<p>é‚£ä¹ˆå‘½ä»¤æ˜¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"OpenClaw2024","encodingAESKey":"abcdefghijklmnopqrstuvwxyz1234567890123456","receiveId":"","dm":{"policy":"pairing"}}'</span> --json
</code></pre>
<hr/>
<h3 data-id="heading-70">ç„¶åé‡å¯ç½‘å…³</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-71">éªŒè¯é…ç½®</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw channels status
</code></pre>
<hr/>
<h3 data-id="heading-72">ä¼ä¸šå¾®ä¿¡åå°å¡«å†™</h3>





















<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://ä½ çš„ngrokåœ°å€.ngrok-free.app/wecom</code></td></tr><tr><td><strong>Token</strong></td><td>å’Œä¸Šé¢é…ç½®çš„ä¸€è‡´</td></tr><tr><td><strong>EncodingAESKey</strong></td><td>å’Œä¸Šé¢é…ç½®çš„ä¸€è‡´</td></tr></tbody></table>
<hr/>
<p><strong>å‘Šè¯‰æˆ‘ï¼š</strong></p>
<ol>
<li>ä½ çš„ Token æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>ä½ çš„ EncodingAESKey æ˜¯ä»€ä¹ˆï¼ˆ43ä½ï¼‰ï¼Ÿ</li>
<li>ngrok çš„ URL æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ol>
<p>æˆ‘å¸®ä½ ç”Ÿæˆå®Œæ•´çš„é…ç½®å‘½ä»¤ï¼ ğŸš€
User: ä¸æ˜¯è¦å…ˆé…ç½®ä¼ä¸šIdå˜›
Kimi: ä½ è¯´å¾—å¯¹ï¼ä¼ä¸šå¾®ä¿¡<strong>è‡ªå»ºåº”ç”¨</strong>ç¡®å®éœ€è¦ <code>corpId</code> + <code>corpSecret</code> + <code>agentId</code>ã€‚</p>
<p>ä½†ä½ ç°åœ¨è£…çš„æ’ä»¶ <code>openclaw-plugin-wecom</code> æ˜¯<strong>åŸºç¡€ç‰ˆ</strong>ï¼Œçœ‹å®ƒçš„é…ç½®åªæœ‰ï¼š</p>
<ul>
<li><code>token</code></li>
<li><code>encodingAESKey</code></li>
<li><code>webhookPath</code></li>
</ul>
<p><strong>æ²¡æœ‰ä¼ä¸šIDç›¸å…³å­—æ®µï¼</strong></p>
<hr/>
<h3 data-id="heading-73">ä¸¤ç§æ¨¡å¼å¯¹æ¯”</h3>























<table><thead><tr><th>æ¨¡å¼</th><th>éœ€è¦å‚æ•°</th><th>åŠŸèƒ½</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>åŸºç¡€ç‰ˆï¼ˆä½ ç°åœ¨è£…çš„ï¼‰</strong></td><td>Token + EncodingAESKey</td><td>è¢«åŠ¨å›å¤æ¶ˆæ¯</td><td>ç®€å•æœºå™¨äºº</td></tr><tr><td><strong>è‡ªå»ºåº”ç”¨ç‰ˆ</strong></td><td>corpId + corpSecret + agentId</td><td>ä¸»åŠ¨å‘æ¶ˆæ¯ã€è·å–ç”¨æˆ·ä¿¡æ¯</td><td>å®Œæ•´åŠŸèƒ½</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-74">æ–¹æ¡ˆé€‰æ‹©</h3>
<h4 data-id="heading-75">æ–¹æ¡ˆ Aï¼šå…ˆç”¨åŸºç¡€ç‰ˆï¼ˆç®€å•ï¼Œç°åœ¨å°±èƒ½ç”¨ï¼‰</h4>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>ä¸éœ€è¦ corpId</li>
<li>ä¼ä¸šå¾®ä¿¡åå°åˆ›å»ºçš„æ˜¯**"æ¥æ”¶æ¶ˆæ¯"**çš„æœºå™¨äºº</li>
<li>åªèƒ½è¢«åŠ¨å›å¤ï¼ˆç”¨æˆ·å…ˆå‘æ¶ˆæ¯ï¼Œæœºå™¨äººæ‰èƒ½å›ï¼‰</li>
</ul>
<p><strong>é…ç½®ï¼ˆå°±æ˜¯ä½ ç°åœ¨çš„æ’ä»¶ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"ä½ çš„Token","encodingAESKey":"ä½ çš„43ä½Key"}'</span> --json
</code></pre>
<hr/>
<h4 data-id="heading-76">æ–¹æ¡ˆ Bï¼šå®‰è£…å®Œæ•´ç‰ˆæ’ä»¶ï¼ˆéœ€è¦ corpIdï¼‰</h4>
<p>å¦‚æœä½ æƒ³ç”¨<strong>è‡ªå»ºåº”ç”¨</strong>ï¼ˆä¸»åŠ¨å‘æ¶ˆæ¯ã€è·å–éƒ¨é—¨åˆ—è¡¨ç­‰ï¼‰ï¼Œéœ€è¦å®‰è£…å¦ä¸€ä¸ªæ’ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…ç¤¾åŒºç‰ˆæ’ä»¶ï¼ˆæ”¯æŒ corpId/corpSecretï¼‰</span>
openclaw plugins install @openclaw-china/channels
</code></pre>
<p>ç„¶åæ‰èƒ½é…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom-app <span class="hljs-string">'{
  "enabled": true,
  "corpId": "wwä½ çš„ä¼ä¸šID",
  "corpSecret": "åº”ç”¨çš„Secret",
  "agentId": 1000002,
  "token": "ä½ çš„Token",
  "encodingAESKey": "ä½ çš„43ä½Key"
}'</span> --json
</code></pre>
<hr/>
<h3 data-id="heading-77">ä½ ç°åœ¨æ€ä¹ˆé€‰ï¼Ÿ</h3>

















<table><thead><tr><th>ä½ çš„éœ€æ±‚</th><th>å»ºè®®æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>åªæƒ³å¿«é€Ÿæµ‹è¯•ï¼Œèƒ½å›å¤æ¶ˆæ¯å°±è¡Œ</td><td><strong>æ–¹æ¡ˆ A</strong>ï¼ˆåŸºç¡€ç‰ˆï¼Œä¸ç”¨ corpIdï¼‰</td></tr><tr><td>éœ€è¦ä¸»åŠ¨æ¨é€æ¶ˆæ¯ã€å®Œæ•´åŠŸèƒ½</td><td><strong>æ–¹æ¡ˆ B</strong>ï¼ˆå®‰è£… @openclaw-china/channelsï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-78">å¿«é€Ÿå†³ç­–</h3>
<p><strong>å…ˆå›ç­”æˆ‘ï¼š</strong></p>
<ol>
<li>
<p>ä½ åœ¨ä¼ä¸šå¾®ä¿¡åå°åˆ›å»ºçš„æ˜¯ <strong>"æ¥æ”¶æ¶ˆæ¯"</strong> è¿˜æ˜¯ <strong>"è‡ªå»ºåº”ç”¨"</strong>ï¼Ÿ</p>
<ul>
<li>è·¯å¾„æ˜¯ï¼š<strong>åº”ç”¨ç®¡ç† â†’ æ¥æ”¶æ¶ˆæ¯</strong> â†’ åŸºç¡€ç‰ˆ</li>
<li>è·¯å¾„æ˜¯ï¼š<strong>åº”ç”¨ç®¡ç† â†’ è‡ªå»ºåº”ç”¨</strong> â†’ å®Œæ•´ç‰ˆ</li>
</ul>
</li>
<li>
<p>ä½ æƒ³å®ç°ä»€ä¹ˆåŠŸèƒ½ï¼Ÿ</p>
<ul>
<li>åªæ˜¯é—®ç­”å¯¹è¯ â†’ åŸºç¡€ç‰ˆå¤Ÿç”¨</li>
<li>è¦ä¸»åŠ¨ç¾¤å‘æ¶ˆæ¯ â†’ éœ€è¦å®Œæ•´ç‰ˆ</li>
</ul>
</li>
</ol>
<p>å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¸®ä½ èµ°æ­£ç¡®çš„é…ç½®ï¼ ğŸ¯
User: toeknæ˜¯ lYpiVXyHnrYvKVcD5HMVOM4UKï¼Œencodingaesæ˜¯cySuMkqB6wu3PkLY9hoyT2lELURprMUmaVpAx7OlOOO
Kimi: å¥½çš„ï¼ç”¨ä½ æä¾›çš„å€¼ï¼Œç°åœ¨æ‰§è¡Œï¼š</p>
<hr/>
<h3 data-id="heading-79">é…ç½®å‘½ä»¤</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"lYpiVXyHnrYvKVcD5HMVOM4UK","encodingAESKey":"cySuMkqB6wu3PkLY9hoyT2lELURprMUmaVpAx7OlOOO","receiveId":"","dm":{"policy":"pairing"}}'</span> --json
</code></pre>
<hr/>
<h3 data-id="heading-80">ç„¶åé‡å¯ç½‘å…³</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-81">éªŒè¯é…ç½®</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw channels status
</code></pre>
<hr/>
<h3 data-id="heading-82">ä¼ä¸šå¾®ä¿¡åå°å¡«å†™</h3>

























<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://ä½ çš„ngrokåœ°å€.ngrok-free.app/wecom</code></td></tr><tr><td><strong>Token</strong></td><td><code>lYpiVXyHnrYvKVcD5HMVOM4UK</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>cySuMkqB6wu3PkLY9hoyT2lELURprMUmaVpAx7OlOOO</code></td></tr><tr><td><strong>æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼</strong></td><td>é€‰**"å…¼å®¹æ¨¡å¼"** æˆ–**"æ˜æ–‡æ¨¡å¼"**</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-83">æ£€æŸ¥æ¸…å•</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ngrok æ­£åœ¨è¿è¡Œï¼ˆ<code>ngrok http 18789</code>ï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å¤åˆ¶äº† ngrok çš„ https åœ°å€</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ‰§è¡Œäº†ä¸Šé¢çš„ config å‘½ä»¤</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ‰§è¡Œäº† <code>openclaw gateway restart</code></li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä¼ä¸šå¾®ä¿¡åå°å¡«äº†æ­£ç¡®çš„ URL + Token + EncodingAESKey</li>
</ul>
<p><strong>æ‰§è¡Œå®Œå‘Šè¯‰æˆ‘ç»“æœï¼</strong> ğŸš€
User: ä»–åšäº†åŸŸå é‚£ä¼ä¸šå¾®ä¿¡åå°è®¾ç½®urlè¿™é‡Œå†™<a href="https://link.juejin.cn?target=https%3A%2F%2Fbot.shuqi.run%255Cwecom" target="_blank" title="https://bot.shuqi.run%5Cwecom" ref="nofollow noopener noreferrer">bot.shuqi.run\wecom</a> å¯¹å—
Kimi: ä¸å¯¹ï¼URL æ ¼å¼æœ‰è¯¯ã€‚</p>
<hr/>
<h3 data-id="heading-84">âŒ é”™è¯¯</h3>
<pre><code class="hljs language-arduino" lang="arduino">https:<span class="hljs-comment">//bot.shuqi.run\wecom</span>
              â†‘
           è¿™é‡Œç”¨äº†åæ–œæ  \
</code></pre>
<hr/>
<h3 data-id="heading-85">âœ… æ­£ç¡®æ ¼å¼</h3>
<pre><code class="hljs language-arduino" lang="arduino">https:<span class="hljs-comment">//bot.shuqi.run/wecom</span>
              â†‘
           ç”¨æ­£æ–œæ  /
</code></pre>
<hr/>
<h3 data-id="heading-86">ä¼ä¸šå¾®ä¿¡åå°å¡«å†™</h3>





















<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://bot.shuqi.run/wecom</code></td></tr><tr><td><strong>Token</strong></td><td><code>lYpiVXyHnrYvKVcD5HMVOM4UK</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>cySuMkqB6wu3PkLY9hoyT2lELURprMUmaVpAx7OlOOO</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-87">å…³é”®ç‚¹</h3>
<ul>
<li><strong>æ­£æ–œæ </strong> <code>/</code> âœ…</li>
<li><strong>åæ–œæ </strong> <code>\</code> âŒï¼ˆè¿™æ˜¯ Windows è·¯å¾„ç”¨çš„ï¼ŒURL é‡Œä¸èƒ½ç”¨ï¼‰</li>
</ul>
<hr/>
<p>æ”¹è¿‡æ¥åç‚¹å‡»<strong>ä¿å­˜</strong>ï¼Œå¦‚æœæ˜¾ç¤º <strong>"è¯·æ±‚æˆåŠŸ"</strong> æˆ– <strong>"éªŒè¯é€šè¿‡"</strong> å°±è¯´æ˜é…ç½®æˆåŠŸäº†ï¼ğŸ‰</p>
<p><strong>ä¿å­˜åå‘Šè¯‰æˆ‘ç»“æœï¼</strong>
User: â—‡Gateway reachable.</p>
<ul>
<li>Enterprise WeChat default: enabled</li>
</ul>
<p>Tip: status --deep adds gateway health probes to status output (requires a reachable gateway). è¿™æ ·è¯´æ˜å¯ä»¥äº†å§
Kimi: å¤ªå¥½äº†ï¼ğŸ‰ <strong>é…ç½®æˆåŠŸï¼</strong></p>
<hr/>
<h3 data-id="heading-88">âœ… çŠ¶æ€è§£è¯»</h3>
<pre><code class="hljs language-arduino" lang="arduino">â—‡ Gateway reachable.                    â† ç½‘å…³å¯è®¿é—®
- Enterprise WeChat <span class="hljs-keyword">default</span>: enabled     â† ä¼ä¸šå¾®ä¿¡é€šé“å·²å¯ç”¨
</code></pre>
<p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li>OpenClaw ç½‘å…³è¿è¡Œæ­£å¸¸</li>
<li>ä¼ä¸šå¾®ä¿¡æ’ä»¶å·²åŠ è½½å¹¶å¯ç”¨</li>
<li>å¯ä»¥æ¥æ”¶æ¶ˆæ¯äº†ï¼</li>
</ul>
<hr/>
<h3 data-id="heading-89">ğŸš€ ç°åœ¨æµ‹è¯•</h3>
<p><strong>1. åœ¨ä¼ä¸šå¾®ä¿¡é‡Œæ‰¾åˆ°æœºå™¨äºº</strong></p>
<ul>
<li>å¯èƒ½æ˜¯ä½ åˆ›å»ºçš„<strong>åº”ç”¨åç§°</strong></li>
<li>æˆ–è€…åœ¨<strong>é€šè®¯å½•</strong> â†’ <strong>å¤–éƒ¨è”ç³»äºº</strong>é‡Œ</li>
</ul>
<p><strong>2. å‘é€æ¶ˆæ¯æµ‹è¯•</strong></p>
<pre><code class="hljs">ä½ å¥½
</code></pre>
<p><strong>3. çœ‹ OpenClaw æ˜¯å¦æ”¶åˆ°</strong></p>
<ul>
<li>è§‚å¯Ÿ OpenClaw ç»ˆç«¯æ˜¯å¦æœ‰æ—¥å¿—è¾“å‡º</li>
<li>æˆ–è€…æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶</li>
</ul>
<hr/>
<h3 data-id="heading-90">ğŸ” æŸ¥çœ‹å®æ—¶æ—¥å¿—</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¦‚æœè¦çœ‹å®æ—¶æ—¥å¿—</span>
openclaw logs -f

<span class="hljs-comment"># æˆ–è€…æ‰¾æ—¥å¿—æ–‡ä»¶ä½ç½®</span>
openclaw config get logging.file
</code></pre>
<hr/>
<h3 data-id="heading-91">å¦‚æœæ”¶ä¸åˆ°æ¶ˆæ¯ï¼Œæ£€æŸ¥</h3>

























<table><thead><tr><th>æ£€æŸ¥é¡¹</th><th>å‘½ä»¤/æ–¹æ³•</th></tr></thead><tbody><tr><td>ngrok æ˜¯å¦è¿˜åœ¨è¿è¡Œ</td><td>çœ‹ ngrok ç»ˆç«¯çª—å£</td></tr><tr><td>URL æ˜¯å¦èƒ½è®¿é—®</td><td>æµè§ˆå™¨è®¿é—® <code>https://bot.shuqi.run/wecom</code></td></tr><tr><td>ä¼ä¸šå¾®ä¿¡åå°æ˜¯å¦ä¿å­˜æˆåŠŸ</td><td>é‡æ–°æ‰“å¼€åå°ç¡®è®¤</td></tr><tr><td>OpenClaw æ˜¯å¦è¿è¡Œ</td><td><code>openclaw gateway status</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-92">ä½ ç°åœ¨</h3>
<p><strong>åœ¨ä¼ä¸šå¾®ä¿¡é‡Œå‘ä¸€æ¡æ¶ˆæ¯è¯•è¯•ï¼</strong></p>
<p>å‘äº†ä¹‹åå‘Šè¯‰æˆ‘ï¼š</p>
<ul>
<li>æœºå™¨äººå›å¤äº†å—ï¼Ÿ</li>
<li>OpenClaw ç»ˆç«¯æœ‰æ—¥å¿—è¾“å‡ºå—ï¼Ÿ</li>
</ul>
<p>ğŸš€
User: æœ€ååˆ›å»ºè¿™é‡Œ<a href="https://link.juejin.cn?target=http%3A%2F%2Fbot.shuqi.run%2Fwecom" target="_blank" title="http://bot.shuqi.run/wecom" ref="nofollow noopener noreferrer">bot.shuqi.run/wecom</a> è¿™ä¸ªæ—¶æ˜¾ç¤ºè¯·æ±‚urlå¤±è´¥æ˜¾ç¤º301ï¼Œå¦‚æœæ˜¯httpså°±æ˜¾ç¤º501
Kimi: æ˜ç™½äº†ï¼HTTP 301 å’Œ HTTPS 501 è¯´æ˜ URL è®¿é—®æœ‰é—®é¢˜ã€‚</p>
<hr/>
<h3 data-id="heading-93">é—®é¢˜åˆ†æ</h3>

















<table><thead><tr><th>é”™è¯¯</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><strong>HTTP 301</strong></td><td>é‡å®šå‘åˆ° HTTPSï¼Œä½†ä¼ä¸šå¾®ä¿¡è¦æ±‚ç›´æ¥è®¿é—®</td></tr><tr><td><strong>HTTPS 501</strong></td><td>æœåŠ¡å™¨ä¸æ”¯æŒè¯¥è¯·æ±‚æ–¹æ³•ï¼ˆå¯èƒ½æ˜¯é…ç½®é—®é¢˜ï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-94">å¯èƒ½åŸå›  &amp; è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-95">åŸå›  1ï¼šä½ çš„å›ºå®šåŸŸå <code>bot.shuqi.run</code> é…ç½®æœ‰é—®é¢˜</h4>
<p>ä½ ä¹‹å‰ç”¨ ngrok æ˜¯ <code>https://xxx.ngrok-free.app</code>ï¼Œç°åœ¨æ¢æˆäº† <code>bot.shuqi.run</code>ã€‚</p>
<p><strong>è¿™ä¸ªåŸŸåæ˜¯æ€ä¹ˆé…ç½®çš„ï¼Ÿ</strong></p>
<ul>
<li>Cloudflare Tunnelï¼Ÿ</li>
<li>è‡ªå·±çš„æœåŠ¡å™¨åå‘ä»£ç†ï¼Ÿ</li>
<li>å…¶ä»–å†…ç½‘ç©¿é€å·¥å…·ï¼Ÿ</li>
</ul>
<hr/>
<h4 data-id="heading-96">åŸå›  2ï¼šOpenClaw ç½‘å…³æ²¡ç»‘å®šåˆ°è¯¥åŸŸå</h4>
<p>æ£€æŸ¥ OpenClaw å®é™…ç›‘å¬çš„åœ°å€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ç½‘å…³é…ç½®</span>
openclaw config get gateway

<span class="hljs-comment"># åº”è¯¥æ˜¾ç¤º</span>
{
  <span class="hljs-string">"bind"</span>: <span class="hljs-string">"0.0.0.0"</span>,    // æˆ– <span class="hljs-string">"127.0.0.1"</span>
  <span class="hljs-string">"port"</span>: 18789
}
</code></pre>
<p>å¦‚æœ <code>bind</code> æ˜¯ <code>127.0.0.1</code>ï¼Œé‚£åªèƒ½æœ¬åœ°è®¿é—®ï¼Œå¤–éƒ¨åŸŸåè¿›ä¸æ¥ã€‚</p>
<p><strong>æ”¹æˆ 0.0.0.0ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"0.0.0.0"</span>
openclaw gateway restart
</code></pre>
<hr/>
<h4 data-id="heading-97">åŸå›  3ï¼šHTTPS è¯ä¹¦é—®é¢˜</h4>
<p>å¦‚æœ <code>bot.shuqi.run</code> èµ°äº† HTTPSï¼Œä½†åç«¯ OpenClaw æ˜¯ HTTPï¼Œéœ€è¦æ£€æŸ¥åå‘ä»£ç†é…ç½®ã€‚</p>
<hr/>
<h3 data-id="heading-98">å¿«é€Ÿè¯Šæ–­</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šæµ‹è¯•åŸŸåæ˜¯å¦èƒ½è®¿é—® OpenClaw</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨ä½ çš„ Mac ä¸Šæµ‹è¯•ï¼ˆæ›¿æ¢ä¸ºä½ çš„åŸŸåï¼‰</span>
curl -v http://bot.shuqi.run/wecom

<span class="hljs-comment"># å’Œ</span>
curl -v https://bot.shuqi.run/wecom
</code></pre>
<p><strong>æŠŠè¾“å‡ºç»“æœç»™æˆ‘ï¼</strong></p>
<hr/>
<p><strong>ç¬¬äºŒæ­¥ï¼šç¡®è®¤ç½‘ç»œè·¯å¾„</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">ä¼ä¸šå¾®ä¿¡æœåŠ¡å™¨ â†’ bot.shuqi.run â†’ ??? â†’ ä½ çš„ Mac:<span class="hljs-number">18789</span>
</code></pre>
<p><strong>å‘Šè¯‰æˆ‘ï¼š</strong></p>
<ol>
<li><code>bot.shuqi.run</code> æ˜¯æ€ä¹ˆé…ç½®çš„ï¼Ÿï¼ˆCloudflareï¼ŸNginxï¼Ÿå…¶ä»–ï¼Ÿï¼‰</li>
<li>å®ƒæŒ‡å‘å“ªé‡Œï¼Ÿï¼ˆä½ çš„å…¬ç½‘ IPï¼Ÿè¿˜æ˜¯ ngrokï¼Ÿï¼‰</li>
<li>ä¹‹å‰ç”¨ ngrok çš„ URL èƒ½æˆåŠŸå—ï¼Ÿ</li>
</ol>
<hr/>
<h3 data-id="heading-99">ä¸´æ—¶è§£å†³æ–¹æ¡ˆ</h3>
<p>å¦‚æœç€æ€¥æµ‹è¯•ï¼Œ<strong>å…ˆç”¨å› ngrok</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨ ngrok</span>
ngrok http 18789

<span class="hljs-comment"># ç”¨ ngrok çš„ https åœ°å€ï¼ˆå¦‚ https://abc123.ngrok-free.appï¼‰</span>
<span class="hljs-comment"># å¡«åˆ°ä¼ä¸šå¾®ä¿¡ï¼š https://abc123.ngrok-free.app/wecom</span>
</code></pre>
<p>ngrok çš„ HTTPS æ˜¯ç»è¿‡éªŒè¯çš„ï¼Œä¼ä¸šå¾®ä¿¡èƒ½æ­£å¸¸è®¿é—®ã€‚</p>
<hr/>
<p><strong>å…ˆå›ç­”æˆ‘ï¼š</strong></p>
<ul>
<li><code>bot.shuqi.run</code> æ˜¯ä»€ä¹ˆæœåŠ¡é…ç½®çš„ï¼Ÿ</li>
<li>ä¹‹å‰ ngrok èƒ½ç”¨å—ï¼Ÿ</li>
</ul>
<p>æˆ‘å¸®ä½ å®šä½é—®é¢˜ï¼ğŸ”§
User: ä»–ç”¨çš„æ˜¯ä»€ä¹ˆfrpdengxiaochao@dengxiaochao ~ % chmod +x /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc &amp;&amp;  /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
2026-02-04 15:29:33.944 [I] [sub/root.go:159] start frpc service for config file [/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml]
2026-02-04 15:29:33.944 [I] [client/service.go:335] try to connect to server...
2026-02-04 15:29:33.999 [I] [client/service.go:327] [8e537f1df8196659] login to server success, get run id [8e537f1df8196659]
2026-02-04 15:29:34.000 [I] [proxy/proxy_manager.go:180] [8e537f1df8196659] proxy added: [bot]
2026-02-04 15:29:34.020 [I] [client/control.go:172] [8e537f1df8196659] [bot] start proxy success
2026-02-04 19:12:18.674 [E] [proxy/proxy.go:202] [8e537f1df8196659] [bot] connect to local service [127.0.0.1:18789] error: dial tcp 127.0.0.1:18789: connect: connection refused
Kimi: æ˜ç™½äº†ï¼é—®é¢˜æ‰¾åˆ°äº†ï¼ğŸ”</p>
<hr/>
<h3 data-id="heading-100">é”™è¯¯åˆ†æ</h3>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">connect</span> to <span class="hljs-keyword">local</span> service [<span class="hljs-number">127.0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">18789</span>] error: dial tcp <span class="hljs-number">127.0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">18789</span>: <span class="hljs-keyword">connect</span>: connection refused
</code></pre>
<p><strong>FRP å®¢æˆ·ç«¯æ— æ³•è¿æ¥åˆ°æœ¬åœ°çš„ OpenClawï¼</strong></p>
<hr/>
<h3 data-id="heading-101">æ ¹æœ¬åŸå› </h3>

















<table><thead><tr><th>é—®é¢˜</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>FRP é…ç½®</td><td>æŒ‡å‘ <code>127.0.0.1:18789</code></td></tr><tr><td>å®é™…æƒ…å†µ</td><td>OpenClaw ç½‘å…³<strong>æ²¡æœ‰è¿è¡Œ</strong>ï¼Œæˆ–<strong>ç»‘å®šäº†å…¶ä»–ç«¯å£/åœ°å€</strong></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-102">æ£€æŸ¥æ­¥éª¤</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šç¡®è®¤ OpenClaw ç½‘å…³æ˜¯å¦è¿è¡Œ</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ç½‘å…³çŠ¶æ€</span>
openclaw gateway status

<span class="hljs-comment"># æˆ–è€…çœ‹è¿›ç¨‹</span>
ps aux | grep openclaw
</code></pre>
<p><strong>å¦‚æœæ˜¾ç¤º stoppedï¼Œå…ˆå¯åŠ¨ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw gateway start
<span class="hljs-comment"># æˆ–</span>
openclaw gateway restart
</code></pre>
<hr/>
<p><strong>ç¬¬äºŒæ­¥ï¼šç¡®è®¤ OpenClaw å®é™…ç›‘å¬åœ°å€</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ç½‘å…³é…ç½®</span>
openclaw config get gateway
</code></pre>
<p><strong>åº”è¯¥æ˜¾ç¤ºï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"bind"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0.0.0.0"</span><span class="hljs-punctuation">,</span>    <span class="hljs-comment">// æˆ– "127.0.0.1"</span>
  <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">18789</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šæ£€æŸ¥ç«¯å£æ˜¯å¦çœŸçš„åœ¨ç›‘å¬</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Mac ä¸ŠæŸ¥çœ‹ 18789 ç«¯å£</span>
lsof -i :18789

<span class="hljs-comment"># æˆ–</span>
netstat -an | grep 18789
</code></pre>
<p><strong>å¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œè¯´æ˜ OpenClaw æ²¡ç»‘å®šè¿™ä¸ªç«¯å£ï¼</strong></p>
<hr/>
<h3 data-id="heading-103">è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-104">æƒ…å†µ Aï¼šOpenClaw ç½‘å…³æ²¡è¿è¡Œ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨ç½‘å…³</span>
openclaw gateway start

<span class="hljs-comment"># ç¡®è®¤çŠ¶æ€</span>
openclaw gateway status
</code></pre>
<h4 data-id="heading-105">æƒ…å†µ Bï¼šç«¯å£è¢«å ç”¨æˆ–é…ç½®é”™è¯¯</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é‡æ–°è®¾ç½®é…ç½®</span>
openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"127.0.0.1"</span>
openclaw config <span class="hljs-built_in">set</span> gateway.port 18789

<span class="hljs-comment"># é‡å¯</span>
openclaw gateway restart
</code></pre>
<h4 data-id="heading-106">æƒ…å†µ Cï¼šFRP é…ç½®å’Œ OpenClaw ä¸åŒ¹é…</h4>
<p>æ£€æŸ¥ä½ çš„ <code>frpc.toml</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-comment"># åº”è¯¥ç±»ä¼¼è¿™æ ·</span>
<span class="hljs-section">[common]</span>
<span class="hljs-attr">server_addr</span> = ä½ çš„FRPæœåŠ¡å™¨åœ°å€
<span class="hljs-attr">server_port</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">token</span> = ä½ çš„token

<span class="hljs-section">[bot]</span>
<span class="hljs-attr">type</span> = http
<span class="hljs-attr">local_port</span> = <span class="hljs-number">18789</span>        <span class="hljs-comment"># â† å¿…é¡»å’Œ OpenClaw ä¸€è‡´</span>
<span class="hljs-attr">local_ip</span> = <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>      <span class="hljs-comment"># â† å¿…é¡»å’Œ OpenClaw bind ä¸€è‡´</span>
<span class="hljs-attr">custom_domains</span> = bot.shuqi.run
</code></pre>
<hr/>
<h3 data-id="heading-107">å¿«é€ŸéªŒè¯</h3>
<p><strong>å…ˆç¡®ä¿ OpenClaw æœ¬åœ°å¯è®¿é—®ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœ¬åœ°æµ‹è¯•</span>
curl http://127.0.0.1:18789/wecom

<span class="hljs-comment"># å¦‚æœè¿”å› 404 æˆ– 200ï¼Œè¯´æ˜ OpenClaw åœ¨è¿è¡Œ</span>
<span class="hljs-comment"># å¦‚æœ connection refusedï¼Œè¯´æ˜æ²¡è¿è¡Œ</span>
</code></pre>
<hr/>
<h3 data-id="heading-108">ä½ ç°åœ¨æ‰§è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ£€æŸ¥ OpenClaw çŠ¶æ€</span>
openclaw gateway status

<span class="hljs-comment"># 2.</span>
User: curl -v https://bot.shuqi.run/wecom 

* Host bot.shuqi.run:443 was resolved.
* IPv6: (none)
* IPv4: 122.9.157.124
*   Trying 122.9.157.124:443...
* Connected to bot.shuqi.run (122.9.157.124) port 443
* ALPN: curl offers h2,http/1.1
* (304) (OUT), TLS handshake, Client hello (1):
*  CAfile: /etc/ssl/cert.pem
*  CApath: none
* (304) (IN), TLS handshake, Server hello (2):
* (304) (IN), TLS handshake, Unknown (8):
* (304) (IN), TLS handshake, Certificate (11):
* (304) (IN), TLS handshake, CERT verify (15):
* (304) (IN), TLS handshake, Finished (20):
* (304) (OUT), TLS handshake, Finished (20):
* SSL connection using TLSv1.3 / AEAD-AES256-GCM-SHA384 / [blank] / UNDEF
* ALPN: server accepted h2
* Server certificate:
*  subject: CN=bot.shuqi.run
*  start <span class="hljs-built_in">date</span>: Feb  4 06:18:35 2026 GMT
*  expire <span class="hljs-built_in">date</span>: May  5 06:18:34 2026 GMT
*  subjectAltName: host <span class="hljs-string">"bot.shuqi.run"</span> matched cert<span class="hljs-string">'s "bot.shuqi.run"
*  issuer: C=US; O=Let'</span>s Encrypt; CN=R13
*  SSL certificate verify ok.
* using HTTP/2
* [HTTP/2] [1] OPENED stream <span class="hljs-keyword">for</span> https://bot.shuqi.run/wecom 
* [HTTP/2] [1] [:method: GET]
* [HTTP/2] [1] [:scheme: https]
* [HTTP/2] [1] [:authority: bot.shuqi.run]
* [HTTP/2] [1] [:path: /wecom]
* [HTTP/2] [1] [user-agent: curl/8.7.1]
* [HTTP/2] [1] [accept: */*]
&gt; GET /wecom HTTP/2
&gt; Host: bot.shuqi.run
&gt; User-Agent: curl/8.7.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/2 500 
&lt; server: nginx
&lt; <span class="hljs-built_in">date</span>: Wed, 04 Feb 2026 11:18:28 GMT
&lt; content-type: text/plain; charset=utf-8
&lt; content-length: 21
&lt; 
* Connection <span class="hljs-comment">#0 to host bot.shuqi.run left intact</span>
Internal Server Error%                                                          dengxiaochao@dengxiaochao openclaw-plugin-wecom %
Kimi: æ‰¾åˆ°äº†ï¼é—®é¢˜å¾ˆæ¸…æ¥š ğŸ”

---

<span class="hljs-comment">## é—®é¢˜æ ¹æº</span>

**FRP æ—¥å¿—æ˜¾ç¤ºï¼š**
</code></pre>
<p>connect to local service [127.0.0.1:18789] error: connection refused</p>
<pre><code class="hljs language-yaml" lang="yaml">
<span class="hljs-string">**æ„æ€æ˜¯ï¼š**</span> <span class="hljs-string">FRP</span> <span class="hljs-string">å®¢æˆ·ç«¯è¿ä¸ä¸Šä½ æœ¬åœ°çš„</span> <span class="hljs-string">OpenClawï¼</span>

<span class="hljs-meta">---
</span>
<span class="hljs-comment">## åŸå› åˆ†æ</span>

<span class="hljs-string">|</span> <span class="hljs-string">é—®é¢˜</span> <span class="hljs-string">|</span> <span class="hljs-string">è¯´æ˜</span> <span class="hljs-string">|</span>
<span class="hljs-string">|-----|------|</span>
<span class="hljs-string">|</span> <span class="hljs-string">FRP</span> <span class="hljs-string">é…ç½®æŒ‡å‘</span> <span class="hljs-string">`127.0.0.1:18789`</span> <span class="hljs-string">|</span> <span class="hljs-string">ä½†</span> <span class="hljs-string">OpenClaw</span> <span class="hljs-string">æ²¡è¿è¡Œï¼Œæˆ–ç»‘å®šäº†å…¶ä»–åœ°å€</span> <span class="hljs-string">|</span>
<span class="hljs-string">|</span> <span class="hljs-string">`curl`</span> <span class="hljs-string">è¿”å›</span> <span class="hljs-string">`HTTP</span> <span class="hljs-number">500</span><span class="hljs-string">`</span> <span class="hljs-string">|</span> <span class="hljs-string">FRP</span> <span class="hljs-string">è¿ä¸ä¸Šåç«¯ï¼Œè¿”å›å†…éƒ¨é”™è¯¯</span> <span class="hljs-string">|</span>

<span class="hljs-meta">---
</span>
<span class="hljs-comment">## è§£å†³æ–¹æ¡ˆ</span>

<span class="hljs-comment">### ç¬¬ä¸€æ­¥ï¼šç¡®è®¤ OpenClaw ç½‘å…³æ­£åœ¨è¿è¡Œ</span>

<span class="hljs-string">```bash</span>
<span class="hljs-comment"># æŸ¥çœ‹ç½‘å…³çŠ¶æ€</span>
<span class="hljs-string">openclaw</span> <span class="hljs-string">gateway</span> <span class="hljs-string">status</span>

<span class="hljs-comment"># å¦‚æœæ²¡è¿è¡Œï¼Œå¯åŠ¨å®ƒ</span>
<span class="hljs-string">openclaw</span> <span class="hljs-string">gateway</span> <span class="hljs-string">start</span>
<span class="hljs-comment"># æˆ–</span>
<span class="hljs-string">openclaw</span> <span class="hljs-string">gateway</span> <span class="hljs-string">restart</span>
</code></pre>
<hr/>
<h4 data-id="heading-109">ç¬¬äºŒæ­¥ï¼šç¡®è®¤ç«¯å£ç›‘å¬</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ 18789 ç«¯å£æ˜¯å¦è¢«ç›‘å¬</span>
lsof -i :18789

<span class="hljs-comment"># æˆ–</span>
netstat -an | grep 18789
</code></pre>
<p><strong>åº”è¯¥æ˜¾ç¤ºï¼š</strong></p>
<pre><code class="hljs">LISTEN  0  0  0.0.0.0:18789  (æˆ– 127.0.0.1:18789)
</code></pre>
<hr/>
<h4 data-id="heading-110">ç¬¬ä¸‰æ­¥ï¼šå¦‚æœ OpenClaw æ²¡ç»‘å®š 127.0.0.1</h4>
<p>æ£€æŸ¥é…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw config get gateway.bind
</code></pre>
<p><strong>å¦‚æœæ˜¾ç¤º <code>0.0.0.0</code>ï¼Œæ”¹æˆ <code>127.0.0.1</code> æˆ–ä¿æŒï¼Œç¡®ä¿ FRP èƒ½è¿ä¸Šï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ¡ˆ Aï¼šè®© OpenClaw åªç›‘å¬æœ¬åœ°ï¼ˆFRP åœ¨åŒä¸€å°æœºå™¨ï¼Œå¯ä»¥è¿ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"127.0.0.1"</span>
openclaw config <span class="hljs-built_in">set</span> gateway.port 18789
openclaw gateway restart
</code></pre>
<hr/>
<h4 data-id="heading-111">ç¬¬å››æ­¥ï¼šéªŒè¯æœ¬åœ°èƒ½è®¿é—®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯•æœ¬åœ°è®¿é—®</span>
curl http://127.0.0.1:18789/wecom

<span class="hljs-comment"># åº”è¯¥è¿”å›ç±»ä¼¼ 405 Method Not Allowed æˆ–æ­£å¸¸å“åº”</span>
<span class="hljs-comment"># è€Œä¸æ˜¯ connection refused</span>
</code></pre>
<hr/>
<h4 data-id="heading-112">ç¬¬äº”æ­¥ï¼šé‡å¯ FRP</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…ˆåœæ­¢ä¹‹å‰çš„ frpcï¼ˆCtrl+Cï¼‰</span>

<span class="hljs-comment"># é‡æ–°å¯åŠ¨</span>
/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<hr/>
<h3 data-id="heading-113">å¿«é€Ÿæ£€æŸ¥æ¸…å•</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. OpenClaw è¿è¡Œäº†å—ï¼Ÿ</span>
openclaw gateway status

<span class="hljs-comment"># 2. ç«¯å£ç›‘å¬äº†å—ï¼Ÿ</span>
lsof -i :18789

<span class="hljs-comment"># 3. æœ¬åœ°èƒ½è®¿é—®å—ï¼Ÿ</span>
curl http://127.0.0.1:18789/wecom

<span class="hljs-comment"># 4. FRP æ—¥å¿—è¿˜æŠ¥é”™å—ï¼Ÿ</span>
</code></pre>
<hr/>
<h3 data-id="heading-114">ä½ ç°åœ¨æ‰§è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…ˆç¡®ä¿ OpenClaw è¿è¡Œ</span>
openclaw gateway restart

<span class="hljs-comment"># æ£€æŸ¥ç«¯å£</span>
lsof -i :18789

<span class="hljs-comment"># æµ‹è¯•æœ¬åœ°</span>
curl http://127.0.0.1:18789/wecom
</code></pre>
<p><strong>æŠŠä¸‰ä¸ªå‘½ä»¤çš„è¾“å‡ºç»™æˆ‘ï¼</strong> ğŸ”§
User: Checking gateway status...
â—‡
Service: LaunchAgent (loaded)
File logs: /tmp/openclaw/openclaw-2026-02-04.log
Command: /usr/local/bin/node /Users/dengxiaochao/.nvm/versions/node/v22.12.0/lib/node_modules/openclaw/dist/index.js gateway --port 18789
Service file: ~/Library/LaunchAgents/ai.openclaw.gateway.plist
Service env: OPENCLAW_GATEWAY_PORT=18789</p>
<p>Config (cli): ~/.openclaw/openclaw.json
Config (service): ~/.openclaw/openclaw.json</p>
<p>Gateway: bind=loopback (127.0.0.1), port=18789 (service args)
Probe target: ws://127.0.0.1:18789
Dashboard: <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A18789%2F" target="_blank" title="http://127.0.0.1:18789/" ref="nofollow noopener noreferrer">http://127.0.0.1:18789/</a>
Probe note: Loopback-only gateway; only local clients can connect.</p>
<p>Runtime: running (pid 40119)
RPC probe: ok</p>
<p>Listening: 127.0.0.1:18789
Troubles: run openclaw status
Troubleshooting: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openclaw.ai%2Ftroubleshooting" target="_blank" title="https://docs.openclaw.ai/troubleshooting" ref="nofollow noopener noreferrer">docs.openclaw.ai/troubleshooâ€¦</a>
Kimi: æ‰¾åˆ°äº†ï¼é—®é¢˜å¾ˆæ˜ç¡® ğŸ”</p>
<hr/>
<h3 data-id="heading-115">é—®é¢˜æ ¹æº</h3>
<p><strong>OpenClaw ç»‘å®šäº† <code>127.0.0.1</code>ï¼ˆloopbackï¼‰ï¼Œä½† FRP è¿ä¸ä¸Šï¼</strong></p>
<pre><code class="hljs language-ini" lang="ini">Gateway: <span class="hljs-attr">bind</span>=loopback (<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>), port=<span class="hljs-number">18789</span>
Probe note: Loopback-only gateway<span class="hljs-comment">; only local clients can connect.</span>
</code></pre>
<p><strong>æ„æ€æ˜¯ï¼š</strong> OpenClaw åªç›‘å¬æœ¬åœ°å›ç¯åœ°å€ï¼ŒFRP è™½ç„¶åœ¨ä½ åŒä¸€å° Mac ä¸Šï¼Œä½†å¯èƒ½ä»¥ä¸åŒæ–¹å¼è§£æ <code>127.0.0.1</code>ã€‚</p>
<hr/>
<h3 data-id="heading-116">è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-117">æ–¹æ¡ˆï¼šè®© OpenClaw ç›‘å¬æ‰€æœ‰ç½‘å¡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœæ­¢å½“å‰ç½‘å…³</span>
openclaw gateway stop

<span class="hljs-comment"># ä¿®æ”¹ç»‘å®šåœ°å€ä¸º 0.0.0.0ï¼ˆæ‰€æœ‰ç½‘å¡ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"0.0.0.0"</span>
openclaw config <span class="hljs-built_in">set</span> gateway.port 18789

<span class="hljs-comment"># é‡å¯ç½‘å…³</span>
openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-118">éªŒè¯ä¿®æ”¹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥æ–°é…ç½®</span>
openclaw gateway status

<span class="hljs-comment"># åº”è¯¥æ˜¾ç¤º</span>
Gateway: <span class="hljs-built_in">bind</span>=0.0.0.0, port=18789
<span class="hljs-comment"># è€Œä¸æ˜¯ loopback (127.0.0.1)</span>
</code></pre>
<hr/>
<h3 data-id="heading-119">ç„¶åé‡å¯ FRP</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœæ­¢ä¹‹å‰çš„ frpcï¼ˆCtrl+Cï¼‰</span>

<span class="hljs-comment"># é‡æ–°å¯åŠ¨</span>
/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<hr/>
<h3 data-id="heading-120">å®Œæ•´æµ‹è¯•æµç¨‹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä¿®æ”¹ OpenClaw ç»‘å®š</span>
openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"0.0.0.0"</span>
openclaw gateway restart

<span class="hljs-comment"># 2. éªŒè¯ç›‘å¬åœ°å€</span>
lsof -i :18789
<span class="hljs-comment"># åº”è¯¥æ˜¾ç¤º 0.0.0.0:18789 æˆ– *:18789</span>

<span class="hljs-comment"># 3. æœ¬åœ°æµ‹è¯•</span>
curl http://127.0.0.1:18789/wecom

<span class="hljs-comment"># 4. é‡å¯ FRP</span>
<span class="hljs-comment"># ï¼ˆåœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œ frpcï¼‰</span>

<span class="hljs-comment"># 5. å¤–ç½‘æµ‹è¯•</span>
curl https://bot.shuqi.run/wecom
</code></pre>
<hr/>
<h3 data-id="heading-121">ä½ ç°åœ¨æ‰§è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"0.0.0.0"</span>
openclaw gateway restart
</code></pre>
<p><strong>ç„¶åå‘Šè¯‰æˆ‘ <code>openclaw gateway status</code> çš„è¾“å‡ºï¼</strong> ğŸš€
User: openclaw config set gateway.bind "0.0.0.0"</p>
<p>(node:44236) [DEP0040] DeprecationWarning: The <code>punycode</code> module is deprecated. Please use a userland alternative instead.
(Use <code>node --trace-deprecation ...</code> to show where the warning was created)
2026-02-04T11:23:07.443Z INFO [wecom] WeCom plugin registering...
2026-02-04T11:23:07.445Z INFO [wecom] WeCom channel registered
2026-02-04T11:23:07.448Z INFO [wecom] WeCom HTTP handler registered</p>
<p>ğŸ¦ OpenClaw 2026.1.30 (76b5208) â€” curl for conversations.</p>
<p>â”‚
â—‡  Doctor changes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                      â”‚
â”‚  wecom configured, not enabled yet.  â”‚
â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â”‚
â—‡  Doctor â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                       â”‚
â”‚  Run "openclaw doctor --fix" to apply these changes.  â”‚
â”‚                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Error: Config validation failed: gateway.bind: Invalid input
Kimi: æ˜ç™½äº†ï¼<code>gateway.bind</code> ä¸èƒ½ç›´æ¥è®¾ç½®ï¼Œéœ€è¦é€šè¿‡ <strong>service é…ç½®</strong> ä¿®æ”¹ã€‚</p>
<hr/>
<h3 data-id="heading-122">æ­£ç¡®ä¿®æ”¹æ–¹å¼</h3>
<p>OpenClaw ä½œä¸ºæœåŠ¡è¿è¡Œï¼Œéœ€è¦ä¿®æ”¹ <strong>LaunchAgent é…ç½®</strong>ï¼š</p>
<h4 data-id="heading-123">æ­¥éª¤ 1ï¼šåœæ­¢å½“å‰æœåŠ¡</h4>
<pre><code class="hljs language-bash" lang="bash">openclaw gateway stop
</code></pre>
<h4 data-id="heading-124">æ­¥éª¤ 2ï¼šç¼–è¾‘æœåŠ¡é…ç½®æ–‡ä»¶</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰“å¼€ plist æ–‡ä»¶</span>
nano ~/Library/LaunchAgents/ai.openclaw.gateway.plist
</code></pre>
<h4 data-id="heading-125">æ­¥éª¤ 3ï¼šä¿®æ”¹ç»‘å®šåœ°å€</h4>
<p>æ‰¾åˆ° <code>&lt;key&gt;ProgramArguments&lt;/key&gt;</code> éƒ¨åˆ†ï¼Œæ·»åŠ  <code>--bind</code> å‚æ•°ï¼š</p>
<p><strong>åŸæ¥çš„å¯èƒ½æ˜¯ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/usr/local/bin/node<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/Users/dengxiaochao/.nvm/versions/node/v22.12.0/lib/node_modules/openclaw/dist/index.js<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>gateway<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--port<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>18789<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span>
</code></pre>
<p><strong>æ”¹æˆï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/usr/local/bin/node<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/Users/dengxiaochao/.nvm/versions/node/v22.12.0/lib/node_modules/openclaw/dist/index.js<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>gateway<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--port<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>18789<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--bind<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>0.0.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span>
</code></pre>
<h4 data-id="heading-126">æ­¥éª¤ 4ï¼šé‡æ–°åŠ è½½æœåŠ¡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¸è½½æ—§æœåŠ¡</span>
launchctl unload ~/Library/LaunchAgents/ai.openclaw.gateway.plist

<span class="hljs-comment"># é‡æ–°åŠ è½½</span>
launchctl load ~/Library/LaunchAgents/ai.openclaw.gateway.plist

<span class="hljs-comment"># æˆ–è€…ç›´æ¥ç”¨ openclaw å‘½ä»¤é‡å¯</span>
openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-127">æ›´ç®€å•çš„æ–¹æ³•ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡</h3>
<p>å¦‚æœä¸Šé¢çš„å¤ªå¤æ‚ï¼Œè¯•è¯•ç¯å¢ƒå˜é‡æ–¹å¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœæ­¢æœåŠ¡</span>
openclaw gateway stop

<span class="hljs-comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span>
<span class="hljs-built_in">export</span> OPENCLAW_GATEWAY_BIND=<span class="hljs-string">"0.0.0.0"</span>
<span class="hljs-built_in">export</span> OPENCLAW_GATEWAY_PORT=<span class="hljs-string">"18789"</span>

<span class="hljs-comment"># å‰å°å¯åŠ¨ï¼ˆæµ‹è¯•ç”¨ï¼‰</span>
openclaw gateway start --foreground
</code></pre>
<hr/>
<h3 data-id="heading-128">æˆ–è€…ï¼šç›´æ¥ä¿®æ”¹ config æ–‡ä»¶</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘é…ç½®æ–‡ä»¶</span>
nano ~/.openclaw/openclaw.json
</code></pre>
<p>æ·»åŠ ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"gateway"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"bind"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0.0.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">18789</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-129">æ¨èï¼šå…ˆè¯•è¯•ç¯å¢ƒå˜é‡æ–¹å¼ï¼ˆæœ€å¿«ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åœæ­¢æœåŠ¡</span>
openclaw gateway stop

<span class="hljs-comment"># 2. è®¾ç½®ç¯å¢ƒå˜é‡å¹¶å¯åŠ¨</span>
<span class="hljs-built_in">export</span> OPENCLAW_GATEWAY_BIND=<span class="hljs-string">"0.0.0.0"</span>
openclaw gateway start --foreground
</code></pre>
<p><strong>ç„¶åæ–°å¼€ä¸€ä¸ªç»ˆç«¯æµ‹è¯•ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">curl http://127.0.0.1:18789/wecom
lsof -i :18789
</code></pre>
<p><strong>å‘Šè¯‰æˆ‘ç»“æœï¼</strong> å¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬å†æ”¹æˆæ°¸ä¹…é…ç½®ã€‚ğŸ”§
User: <code>&lt;true/&gt;</code>
<code>&lt;key&gt;</code>KeepAlive <code>&lt;/key&gt;</code>
<code>&lt;true/&gt;</code>
<code>&lt;key&gt;</code>ProgramArguments <code>&lt;/key&gt;</code>
<code>&lt;array&gt;</code>
<code>&lt;string&gt;</code>/usr/local/bin/node <code>&lt;/string&gt;</code>
<code>&lt;string&gt;</code>/Users/dengxiaochao/.nvm/versions/node/v22.12.0/lib/node_modules/$
<code>&lt;string&gt;</code>gateway <code>&lt;/string&gt;</code>
<code>&lt;string&gt;</code>--port <code>&lt;/string&gt;</code>
<code>&lt;string&gt;</code>18789 <code>&lt;/string&gt;</code>
<code>&lt;/array&gt;</code></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`&lt;key&gt;`</span>StandardOutPath <span class="hljs-string">`&lt;/key&gt;`</span>
<span class="hljs-string">`&lt;string&gt;`</span>/Users/dengxiaochao/.openclaw/logs/gateway.log <span class="hljs-string">`&lt;/string&gt;`</span>
<span class="hljs-string">`&lt;key&gt;`</span>StandardErrorPath <span class="hljs-string">`&lt;/key&gt;`</span>
<span class="hljs-string">`&lt;string&gt;`</span>/Users/dengxiaochao/.openclaw/logs/gateway.err.log <span class="hljs-string">`&lt;/string&gt;`</span>
<span class="hljs-string">`&lt;key&gt;`</span>EnvironmentVariables <span class="hljs-string">`&lt;/key&gt;`</span>
<span class="hljs-string">`&lt;dict&gt;`</span>
<span class="hljs-string">`&lt;key&gt;`</span>HOME <span class="hljs-string">`&lt;/key&gt;`</span>
</code></pre>
<p>Kimi: çœ‹åˆ°äº†ï¼åœ¨ <code>ProgramArguments</code> æ•°ç»„é‡Œæ·»åŠ  <code>--bind</code> å’Œ <code>0.0.0.0</code> ä¸¤ä¸ªå…ƒç´ ã€‚</p>
<hr/>
<h3 data-id="heading-130">ä¿®æ”¹æ­¥éª¤</h3>
<h4 data-id="heading-131">1. ç¼–è¾‘ plist æ–‡ä»¶</h4>
<pre><code class="hljs language-bash" lang="bash">nano ~/Library/LaunchAgents/ai.openclaw.gateway.plist
</code></pre>
<h4 data-id="heading-132">2. æ‰¾åˆ°è¿™æ®µï¼ˆä½ è´´çš„éƒ¨åˆ†ï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/usr/local/bin/node<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/Users/dengxiaochao/.nvm/versions/node/v22.12.0/lib/node_modules/openclaw/dist/index.js<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>gateway<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--port<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>18789<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span>
</code></pre>
<h4 data-id="heading-133">3. æ”¹æˆè¿™æ ·</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/usr/local/bin/node<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/Users/dengxiaochao/.nvm/versions/node/v22.12.0/lib/node_modules/openclaw/dist/index.js<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>gateway<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--port<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>18789<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--bind<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>0.0.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span>
</code></pre>
<p><strong>å°±æ˜¯åœ¨ <code>18789&lt;/string&gt;</code> åé¢æ·»åŠ ä¸¤è¡Œï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--bind<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>0.0.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
</code></pre>
<h4 data-id="heading-134">4. ä¿å­˜å¹¶é‡å¯æœåŠ¡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœæ­¢æ—§æœåŠ¡</span>
launchctl unload ~/Library/LaunchAgents/ai.openclaw.gateway.plist

<span class="hljs-comment"># é‡æ–°åŠ è½½</span>
launchctl load ~/Library/LaunchAgents/ai.openclaw.gateway.plist

<span class="hljs-comment"># éªŒè¯çŠ¶æ€</span>
openclaw gateway status
</code></pre>
<hr/>
<h3 data-id="heading-135">éªŒè¯æˆåŠŸ</h3>
<p><code>openclaw gateway status</code> åº”è¯¥æ˜¾ç¤ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Gateway: <span class="hljs-attr">bind</span>=<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>, port=<span class="hljs-number">18789</span>
</code></pre>
<p><strong>è€Œä¸æ˜¯</strong> <code>bind=loopback (127.0.0.1)</code></p>
<hr/>
<h3 data-id="heading-136">ç„¶å</h3>
<ol>
<li><strong>é‡å¯ FRP</strong></li>
<li><strong>æµ‹è¯•å¤–ç½‘è®¿é—®</strong></li>
<li><strong>ä¼ä¸šå¾®ä¿¡åå°ä¿å­˜ URL</strong></li>
</ol>
<p>æ”¹å®Œå‘Šè¯‰æˆ‘ç»“æœï¼ğŸš€
User: â—‡
Service: LaunchAgent (loaded)
File logs: /tmp/openclaw/openclaw-2026-02-04.log
Command: /usr/local/bin/node /Users/dengxiaochao/.nvm/versions/node/v22.12.0/lib/node_modules/openclaw/dist/index.js gateway --port 18789 --bind 0.0.0.0
Service file: ~/Library/LaunchAgents/ai.openclaw.gateway.plist
Service env: OPENCLAW_GATEWAY_PORT=18789</p>
<p>Config (cli): ~/.openclaw/openclaw.json
Config (service): ~/.openclaw/openclaw.json</p>
<p>Gateway: bind=loopback (127.0.0.1), port=18789 (service args)
Probe target: ws://127.0.0.1:18789
Dashboard: <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A18789%2F" target="_blank" title="http://127.0.0.1:18789/" ref="nofollow noopener noreferrer">http://127.0.0.1:18789/</a>
Probe note: Loopback-only gateway; only local clients can connect.</p>
<p>Runtime: running (pid 49313)
Warm-up: launch agents can take a few seconds. Try again shortly.
RPC probe: failed
RPC target: ws://127.0.0.1:18789
gateway closed (1006 abnormal closure (no close frame)): no close reason
Gateway target: ws://127.0.0.1:18789
Source: cli --url
Config: /Users/dengxiaochao/.openclaw/openclaw.json</p>
<p>Gateway port 18789 is not listening (service appears running).
Last gateway error: 2026-02-04T11:35:17.312Z Invalid --bind (use "loopback", "lan", "tailnet", "auto", or "custom")
Logs: ~/.openclaw/logs/gateway.log
Errors: ~/.openclaw/logs/gateway.err.log</p>
<p>Troubles: run openclaw status
Troubleshooting: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openclaw.ai%2Ftroubleshooting" target="_blank" title="https://docs.openclaw.ai/troubleshooting" ref="nofollow noopener noreferrer">docs.openclaw.ai/troubleshooâ€¦</a>
Kimi: æ‰¾åˆ°äº†ï¼é”™è¯¯å¾ˆæ¸…æ¥š ğŸ”</p>
<hr/>
<h3 data-id="heading-137">é—®é¢˜æ ¹æº</h3>
<p><strong>OpenClaw ä¸æ”¯æŒ <code>0.0.0.0</code> ä½œä¸º <code>--bind</code> å‚æ•°ï¼</strong></p>
<pre><code class="hljs language-perl" lang="perl">Invalid --<span class="hljs-keyword">bind</span> (<span class="hljs-keyword">use</span> <span class="hljs-string">"loopback"</span>, <span class="hljs-string">"lan"</span>, <span class="hljs-string">"tailnet"</span>, <span class="hljs-string">"auto"</span>, <span class="hljs-keyword">or</span> <span class="hljs-string">"custom"</span>)
</code></pre>
<p><strong>æœ‰æ•ˆé€‰é¡¹ï¼š</strong></p>
<ul>
<li><code>loopback</code> - ä»…æœ¬åœ°ï¼ˆ127.0.0.1ï¼‰</li>
<li><code>lan</code> - å±€åŸŸç½‘ï¼ˆæ‰€æœ‰ç½‘å¡ï¼‰</li>
<li><code>tailnet</code> - Tailscale ç½‘ç»œ</li>
<li><code>auto</code> - è‡ªåŠ¨</li>
<li><code>custom</code> - è‡ªå®šä¹‰ï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-138">è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ <code>lan</code></h3>
<p>æŠŠ <code>0.0.0.0</code> æ”¹æˆ <code>lan</code>ï¼š</p>
<h4 data-id="heading-139">1. ç¼–è¾‘ plist æ–‡ä»¶</h4>
<pre><code class="hljs language-bash" lang="bash">nano ~/Library/LaunchAgents/ai.openclaw.gateway.plist
</code></pre>
<h4 data-id="heading-140">2. ä¿®æ”¹è¿™æ®µ</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/usr/local/bin/node<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/Users/dengxiaochao/.nvm/versions/node/v22.12.0/lib/node_modules/openclaw/dist/index.js<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>gateway<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--port<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>18789<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--bind<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>lan<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>    <span class="hljs-comment">&lt;!-- æ”¹æˆ lan --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span>
</code></pre>
<h4 data-id="heading-141">3. é‡å¯æœåŠ¡</h4>
<pre><code class="hljs language-bash" lang="bash">launchctl unload ~/Library/LaunchAgents/ai.openclaw.gateway.plist
launchctl load ~/Library/LaunchAgents/ai.openclaw.gateway.plist
</code></pre>
<hr/>
<h3 data-id="heading-142">éªŒè¯</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw gateway status
</code></pre>
<p><strong>åº”è¯¥æ˜¾ç¤ºï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">Gateway: <span class="hljs-attr">bind</span>=lan, port=<span class="hljs-number">18789</span>
<span class="hljs-comment"># æˆ–ç±»ä¼¼</span>
Listening: 0.0.0.0:18789
</code></pre>
<hr/>
<h3 data-id="heading-143">ç„¶å</h3>
<ol>
<li><strong>é‡å¯ FRP</strong></li>
<li><strong>æµ‹è¯•</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">curl https://bot.shuqi.run/wecom
</code></pre>
<p>æ”¹å®Œå‘Šè¯‰æˆ‘ç»“æœï¼ğŸš€
User: â—’  Checking gateway status...</p>
<p>â—‡
Service: LaunchAgent (loaded)
File logs: /tmp/openclaw/openclaw-2026-02-04.log
Command: /usr/local/bin/node /Users/dengxiaochao/.nvm/versions/node/v22.12.0/lib/node_modules/openclaw/dist/index.js gateway --port 18789 --bind lan
Service file: ~/Library/LaunchAgents/ai.openclaw.gateway.plist
Service env: OPENCLAW_GATEWAY_PORT=18789</p>
<p>Config (cli): ~/.openclaw/openclaw.json
Config (service): ~/.openclaw/openclaw.json</p>
<p>Gateway: bind=loopback (127.0.0.1), port=18789 (service args)
Probe target: ws://127.0.0.1:18789
Dashboard: <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A18789%2F" target="_blank" title="http://127.0.0.1:18789/" ref="nofollow noopener noreferrer">http://127.0.0.1:18789/</a>
Probe note: Loopback-only gateway; only local clients can connect.</p>
<p>Runtime: running (pid 50924)
RPC probe: ok</p>
<p>Listening: *:18789
Troubles: run openclaw status
Troubleshooting: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openclaw.ai%2Ftroubleshooting" target="_blank" title="https://docs.openclaw.ai/troubleshooting" ref="nofollow noopener noreferrer">docs.openclaw.ai/troubleshooâ€¦</a>
dengxiaochao@dengxiaochao ~ % curl <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A18789%2Fwecom" target="_blank" title="http://127.0.0.1:18789/wecom" ref="nofollow noopener noreferrer">http://127.0.0.1:18789/wecom</a></p>
<p>Internal Server Error% ä¸ºå•¥
Kimi: å¤ªå¥½äº†ï¼æœ‰è¿›å±•ï¼ğŸ‰</p>
<hr/>
<h3 data-id="heading-144">çŠ¶æ€åˆ†æ</h3>
<p><strong>å¥½æ¶ˆæ¯ï¼š</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Listening:</span> <span class="hljs-string">*:18789</span>    <span class="hljs-string">â†</span> <span class="hljs-string">æˆåŠŸç›‘å¬æ‰€æœ‰ç½‘å¡ï¼</span>
<span class="hljs-attr">RPC probe:</span> <span class="hljs-string">ok</span>         <span class="hljs-string">â†</span> <span class="hljs-string">æœåŠ¡è¿è¡Œæ­£å¸¸</span>
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<pre><code class="hljs language-vbscript" lang="vbscript">curl http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">18789</span>/wecom è¿”å› Internal <span class="hljs-built_in">Server</span> <span class="hljs-keyword">Error</span>
</code></pre>
<p>è¿™è¯´æ˜ <strong>OpenClaw æ”¶åˆ°äº†è¯·æ±‚ï¼Œä½†å¤„ç†å‡ºé”™äº†</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-145">å¯èƒ½åŸå› </h3>





















<table><thead><tr><th>åŸå› </th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>wecom æ’ä»¶æœªå¯ç”¨</strong></td><td>é…ç½®é‡Œæœ‰ï¼Œä½†æ²¡æ¿€æ´»</td></tr><tr><td><strong>é…ç½®æ ¼å¼é”™è¯¯</strong></td><td>JSON é…ç½®æœ‰é—®é¢˜</td></tr><tr><td><strong>ç¼ºå°‘ä¾èµ–</strong></td><td>æ’ä»¶éœ€è¦çš„ç¯å¢ƒæ²¡å‡†å¤‡å¥½</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-146">è¯Šæ–­æ­¥éª¤</h3>
<h4 data-id="heading-147">1. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># çœ‹é”™è¯¯æ—¥å¿—</span>
<span class="hljs-built_in">cat</span> ~/.openclaw/logs/gateway.err.log

<span class="hljs-comment"># æˆ–çœ‹ä¸»æ—¥å¿—</span>
<span class="hljs-built_in">cat</span> ~/.openclaw/logs/gateway.log
</code></pre>
<p><strong>æŠŠæœ€åå‡ è¡Œé”™è¯¯ä¿¡æ¯è´´ç»™æˆ‘ï¼</strong></p>
<hr/>
<h4 data-id="heading-148">2. æ£€æŸ¥ wecom é…ç½®çŠ¶æ€</h4>
<pre><code class="hljs language-bash" lang="bash">openclaw config get channels.wecom
</code></pre>
<p><strong>è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<hr/>
<h4 data-id="heading-149">3. ç¡®è®¤æ’ä»¶å·²å¯ç”¨</h4>
<pre><code class="hljs language-bash" lang="bash">openclaw plugins list
</code></pre>
<p><strong>wecom æ’ä»¶æ˜¾ç¤º enabled å—ï¼Ÿ</strong></p>
<hr/>
<h4 data-id="heading-150">4. å¿«é€Ÿä¿®å¤å°è¯•</h4>
<p>å¦‚æœé…ç½®æœ‰é—®é¢˜ï¼Œé‡æ–°è®¾ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é‡æ–°é…ç½® wecom</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"lYpiVXyHnrYvKVcD5HMVOM4UK","encodingAESKey":"cySuMkqB6wu3PkLY9hoyT2lELURprMUmaVpAx7OlOOO","receiveId":"","dm":{"policy":"pairing"}}'</span> --json

<span class="hljs-comment"># é‡å¯ç½‘å…³</span>
openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-151">ä½ ç°åœ¨æ‰§è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. çœ‹é”™è¯¯æ—¥å¿—</span>
<span class="hljs-built_in">tail</span> -20 ~/.openclaw/logs/gateway.err.log

<span class="hljs-comment"># 2. æ£€æŸ¥é…ç½®</span>
openclaw config get channels.wecom
</code></pre>
<p><strong>æŠŠè¾“å‡ºç»™æˆ‘ï¼Œæˆ‘å®šä½é—®é¢˜ï¼</strong> ğŸ”§
User: 2026-02-04T11:41:13.897Z [ws] closed before connect conn=f697974e-225f-465a-a65d-c789465fe470 remote=127.0.0.1 fwd=119.86.128.23 origin=<a href="https://link.juejin.cn?target=https%3A%2F%2Fbot.shuqi.run" target="_blank" title="https://bot.shuqi.run" ref="nofollow noopener noreferrer">bot.shuqi.run</a>  host=bot.shuqi.run ua=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 code=1008 reason=pairing required
2026-02-04T11:41:21.776Z [ws] Proxy headers detected from untrusted address. Connection will not be treated as local. Configure gateway.trustedProxies to restore local client detection behind your proxy.
2026-02-04T11:41:21.804Z [ws] unauthorized conn=740e4301-6fe7-40e3-9d92-3fceb78c3077 remote=127.0.0.1 client=openclaw-control-ui webchat vdev reason=token_missing
2026-02-04T11:41:21.850Z [ws] closed before connect conn=740e4301-6fe7-40e3-9d92-3fceb78c3077 remote=127.0.0.1 fwd=119.86.128.23 origin=<a href="https://link.juejin.cn?target=https%3A%2F%2Fbot.shuqi.run" target="_blank" title="https://bot.shuqi.run" ref="nofollow noopener noreferrer">bot.shuqi.run</a>  host=bot.shuqi.run ua=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36 code=1008 reason=unauthorized: gateway token missing (open a tokenized dashboard URL or paste token in Control UI settings)
2026-02-04T11:41:30.069Z [plugins] plugin http handler failed (openclaw-plugin-wecom): Error: EncodingAESKey invalid: length must be 43
Kimi: æ‰¾åˆ°äº†ï¼é”™è¯¯å¾ˆæ¸…æ¥š ğŸ”</p>
<hr/>
<h3 data-id="heading-152">é—®é¢˜æ ¹æº</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Error</span>: <span class="hljs-title class_">EncodingAESKey</span> <span class="hljs-attr">invalid</span>: length must be <span class="hljs-number">43</span>
</code></pre>
<p><strong>ä½ çš„ EncodingAESKey é•¿åº¦ä¸å¯¹ï¼</strong></p>
<hr/>
<h3 data-id="heading-153">æ£€æŸ¥ä½ çš„ Key</h3>
<p>ä½ ä¹‹å‰ç»™çš„ï¼š</p>
<pre><code class="hljs">cySuMkqB6wu3PkLY9hoyT2lELURprMUmaVpAx7OlOOO
</code></pre>
<p><strong>æ•°ä¸€ä¸‹å­—ç¬¦ï¼š</strong></p>
<ul>
<li>c-y-S-u-M-k-q-B-6-w-u-3-P-k-L-Y-9-h-o-y-T-2-l-E-L-U-R-p-r-M-U-m-a-V-p-A-x-7-O-l-O-O-O</li>
<li><strong>å®é™…é•¿åº¦ï¼š43ï¼Ÿè¿˜æ˜¯ 44ï¼Ÿ</strong></li>
</ul>
<hr/>
<h3 data-id="heading-154">ä¼ä¸šå¾®ä¿¡åå°é‡æ–°ç”Ÿæˆ</h3>
<h4 data-id="heading-155">æ­¥éª¤ 1ï¼šç™»å½•ä¼ä¸šå¾®ä¿¡åå°</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwork.weixin.qq.com%2Fwework_admin" target="_blank" title="https://work.weixin.qq.com/wework_admin" ref="nofollow noopener noreferrer">work.weixin.qq.com/wework_admiâ€¦</a></p>
<h4 data-id="heading-156">æ­¥éª¤ 2ï¼šæ‰¾åˆ°æ¥æ”¶æ¶ˆæ¯é…ç½®</h4>
<ul>
<li>åº”ç”¨ç®¡ç† â†’ ä½ çš„åº”ç”¨ â†’ æ¥æ”¶æ¶ˆæ¯</li>
</ul>
<h4 data-id="heading-157">æ­¥éª¤ 3ï¼šç‚¹å‡» <strong>"éšæœºç”Ÿæˆ"</strong> EncodingAESKey</h4>
<p><strong>å¿…é¡»æ˜¯ 43 ä½ï¼</strong></p>
<h4 data-id="heading-158">æ­¥éª¤ 4ï¼šå¤åˆ¶æ–°çš„ Key</h4>
<hr/>
<h3 data-id="heading-159">é‡æ–°é…ç½® OpenClaw</h3>
<p>å‡è®¾æ–°çš„ Key æ˜¯ <code>æ–°çš„43ä½å­—ç¬¦</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"lYpiVXyHnrYvKVcD5HMVOM4UK","encodingAESKey":"æ–°çš„43ä½EncodingAESKey","receiveId":"","dm":{"policy":"pairing"}}'</span> --json

openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-160">å¿«é€ŸéªŒè¯ Key é•¿åº¦</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯•ä½ çš„ Key é•¿åº¦</span>
<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"cySuMkqB6wu3PkLY9hoyT2lELURprMUmaVpAx7OlOOO"</span> | <span class="hljs-built_in">wc</span> -c
</code></pre>
<p><strong>åº”è¯¥è¾“å‡º 43ï¼Œå¦‚æœè¾“å‡º 44 æˆ–å…¶ä»–ï¼Œå°±æ˜¯å¤šäº†å­—ç¬¦ï¼</strong></p>
<hr/>
<h3 data-id="heading-161">ä½ ç°åœ¨</h3>
<ol>
<li><strong>å»ä¼ä¸šå¾®ä¿¡åå°é‡æ–°ç”Ÿæˆ EncodingAESKey</strong></li>
<li><strong>å¤åˆ¶æ–°çš„ 43 ä½ Key</strong></li>
<li><strong>é‡æ–°é…ç½® OpenClaw</strong></li>
</ol>
<p><strong>æŠŠæ–°çš„ Key ç»™æˆ‘ï¼Œæˆ‘å¸®ä½ ç”Ÿæˆé…ç½®å‘½ä»¤ï¼</strong> ğŸš€
User: æˆ‘é‡æ–°è®¾ç½®äº† ï¼Œtokenæ˜¯ fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD   aeskeyæ˜¯ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL
Kimi: å¥½çš„ï¼æ–°çš„ Token å’Œ EncodingAESKey éƒ½æœ‰äº†ã€‚</p>
<hr/>
<h3 data-id="heading-162">éªŒè¯é•¿åº¦</h3>




















<table><thead><tr><th>å‚æ•°</th><th>å€¼</th><th>é•¿åº¦</th></tr></thead><tbody><tr><td>Token</td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td><td>32 âœ“</td></tr><tr><td>EncodingAESKey</td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td><td><strong>43</strong> âœ“</td></tr></tbody></table>
<p>å®Œç¾ï¼éƒ½æ˜¯æ­£ç¡®çš„é•¿åº¦ã€‚</p>
<hr/>
<h3 data-id="heading-163">é‡æ–°é…ç½® OpenClaw</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD","encodingAESKey":"ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL","receiveId":"","dm":{"policy":"pairing"}}'</span> --json
</code></pre>
<hr/>
<h3 data-id="heading-164">é‡å¯ç½‘å…³</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-165">éªŒè¯çŠ¶æ€</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw channels status
</code></pre>
<hr/>
<h3 data-id="heading-166">ä¼ä¸šå¾®ä¿¡åå°æ›´æ–°</h3>





















<table><thead><tr><th>å­—æ®µ</th><th>æ–°å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://bot.shuqi.run/wecom</code></td></tr><tr><td><strong>Token</strong></td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td></tr></tbody></table>
<p><strong>è®°å¾—ç‚¹å‡»ä¿å­˜ï¼</strong></p>
<hr/>
<h3 data-id="heading-167">æµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash">curl https://bot.shuqi.run/wecom
</code></pre>
<p><strong>æ‰§è¡Œå®Œå‘Šè¯‰æˆ‘ç»“æœï¼</strong> ğŸš€
User: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsunnoy%2Fopenclaw-plugin-wecom%2Fblob%2Fmain%2FREADME_ZH.md" target="_blank" title="https://github.com/sunnoy/openclaw-plugin-wecom/blob/main/README_ZH.md" ref="nofollow noopener noreferrer">github.com/sunnoy/openâ€¦</a>  æ˜¯æŒ‰ç…§è¿™æ ·çš„åšå˜›ä½ ç»™çš„å‘½ä»¤
Kimi: æ˜¯çš„ï¼æˆ‘çœ‹äº†è¿™ä¸ªæ–‡æ¡£ï¼Œæˆ‘ä»¬é…ç½®çš„æ˜¯å¯¹çš„ï¼Œä½†æœ‰ä¸ªå…³é”®åŒºåˆ«ï¼š</p>
<hr/>
<h3 data-id="heading-168">æ–‡æ¡£ vs æˆ‘ä»¬çš„é…ç½®</h3>



































<table><thead><tr><th>é¡¹ç›®</th><th>æ–‡æ¡£</th><th>æˆ‘ä»¬çš„é…ç½®</th></tr></thead><tbody><tr><td><strong>é€šé“å</strong></td><td><code>wecom</code></td><td><code>wecom</code> âœ“</td></tr><tr><td><strong>Token</strong></td><td>æ–‡æ¡£ç¤ºä¾‹</td><td>ä½ çš„çœŸå® Token âœ“</td></tr><tr><td><strong>EncodingAESKey</strong></td><td>æ–‡æ¡£ç¤ºä¾‹</td><td>ä½ çš„çœŸå® Key âœ“</td></tr><tr><td><strong>webhookPath</strong></td><td><code>/wecom</code></td><td><code>/wecom</code> âœ“</td></tr><tr><td><strong>enabled</strong></td><td><code>true</code></td><td><code>true</code> âœ“</td></tr></tbody></table>
<p><strong>æˆ‘ä»¬çš„é…ç½®å®Œå…¨æ­£ç¡®ï¼</strong></p>
<hr/>
<h3 data-id="heading-169">æ–‡æ¡£é‡Œçš„é¢å¤–ä¿¡æ¯</h3>
<p>æ–‡æ¡£è¿˜æåˆ°å¯ä»¥é…ç½®ï¼š</p>
<ul>
<li><code>corpId</code> - ä¼ä¸šIDï¼ˆå¯é€‰ï¼Œç”¨äºé«˜çº§åŠŸèƒ½ï¼‰</li>
<li><code>corpSecret</code> - åº”ç”¨å¯†é’¥ï¼ˆå¯é€‰ï¼‰</li>
<li><code>agentId</code> - åº”ç”¨IDï¼ˆå¯é€‰ï¼‰</li>
</ul>
<p><strong>è¿™äº›æˆ‘ä»¬ç°åœ¨ä¸éœ€è¦</strong>ï¼ŒåŸºç¡€åŠŸèƒ½åªéœ€è¦ Token + EncodingAESKeyã€‚</p>
<hr/>
<h3 data-id="heading-170">ç¡®è®¤æ‰§è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. é…ç½®ï¼ˆå·²ç»åšäº†ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD","encodingAESKey":"ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL","receiveId":"","dm":{"policy":"pairing"}}'</span> --json

<span class="hljs-comment"># 2. é‡å¯ç½‘å…³</span>
openclaw gateway restart

<span class="hljs-comment"># 3. éªŒè¯</span>
openclaw channels status
</code></pre>
<hr/>
<h3 data-id="heading-171">ç„¶åæµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash">curl https://bot.shuqi.run/wecom
</code></pre>
<p><strong>å¦‚æœè¿”å›çš„ä¸æ˜¯ <code>Internal Server Error</code>ï¼Œå°±è¯´æ˜æˆåŠŸäº†ï¼</strong></p>
<hr/>
<h3 data-id="heading-172">æ–‡æ¡£é‡Œçš„é‡è¦æç¤º</h3>
<blockquote>
<p><strong>æ³¨æ„ï¼šä¼ä¸šå¾®ä¿¡è¦æ±‚ URL èƒ½æ­£å¸¸è®¿é—®ï¼Œå¦åˆ™ä¼šä¿å­˜å¤±è´¥</strong></p>
</blockquote>
<p>æ‰€ä»¥ä¼ä¸šå¾®ä¿¡åå°ç‚¹å‡»ä¿å­˜æ—¶ï¼ŒOpenClaw å¿…é¡»æ­£åœ¨è¿è¡Œï¼ŒFRP å¿…é¡»è¿é€šã€‚</p>
<p><strong>ä½ ç°åœ¨æ‰§è¡Œåˆ°å“ªä¸€æ­¥äº†ï¼Ÿ</strong> æœ‰æŠ¥é”™å—ï¼Ÿ ğŸš€
User: Gateway reachable.</p>
<ul>
<li>Enterprise WeChat default: enabledç½‘å…³å¯ä»¥äº†ï¼Œç½‘é¡µä¹Ÿæœ‰ä¿¡æ¯äº†ï¼Œä¸ºå•¥Gateway reachable.</li>
<li>Enterprise WeChat default: enabled
Kimi: å¤ªå¥½äº†ï¼ğŸ‰ <strong>é…ç½®æˆåŠŸï¼</strong></li>
</ul>
<hr/>
<h3 data-id="heading-173">çŠ¶æ€è§£è¯»</h3>
<pre><code class="hljs language-arduino" lang="arduino">Gateway reachable.                    â† ç½‘å…³è¿è¡Œæ­£å¸¸
- Enterprise WeChat <span class="hljs-keyword">default</span>: enabled  â† ä¼ä¸šå¾®ä¿¡é€šé“å·²å¯ç”¨
</code></pre>
<p><strong>è¿™è¯´æ˜ï¼š</strong></p>
<ul>
<li>âœ… OpenClaw è¿è¡Œæ­£å¸¸</li>
<li>âœ…
User: % curl <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A18789%2Fwecom" target="_blank" title="http://127.0.0.1:18789/wecom" ref="nofollow noopener noreferrer">http://127.0.0.1:18789/wecom</a></li>
</ul>
<p>Internal Server Error% é‚£ä¸ºå•¥è¿™é‡Œæ˜¯è¿™æ ·çš„
Kimi: å¤ªå¥½äº†ï¼ğŸ‰ <strong>ä¼ä¸šå¾®ä¿¡é€šé“å·²å¯ç”¨ï¼</strong></p>
<hr/>
<h3 data-id="heading-174">ä¸ºä»€ä¹ˆ <code>curl</code> è¿˜æ˜¯ <code>Internal Server Error</code>ï¼Ÿ</h3>
<p><strong>åŸå› ï¼šä¼ä¸šå¾®ä¿¡çš„ webhook éœ€è¦ç‰¹æ®Šçš„è¯·æ±‚æ ¼å¼</strong></p>
<p><code>curl http://127.0.0.1:18789/wecom</code> åªæ˜¯ç®€å•çš„ GET è¯·æ±‚ï¼Œä½†ä¼ä¸šå¾®ä¿¡æ’ä»¶æœŸæœ›çš„æ˜¯ï¼š</p>
<ol>
<li><strong>POST è¯·æ±‚</strong>ï¼ˆä¸æ˜¯ GETï¼‰</li>
<li><strong>ç‰¹å®šçš„ XML æ ¼å¼æ¶ˆæ¯ä½“</strong></li>
<li><strong>åŒ…å«ç­¾åéªŒè¯å‚æ•°</strong>ï¼ˆ<code>msg_signature</code>, <code>timestamp</code>, <code>nonce</code>ï¼‰</li>
</ol>
<p>æ‰€ä»¥ç›´æ¥ <code>curl</code> ä¼šæŠ¥é”™ï¼Œè¿™æ˜¯<strong>æ­£å¸¸çš„</strong>ï¼</p>
<hr/>
<h3 data-id="heading-175">æ­£ç¡®çš„æœ¬åœ°æµ‹è¯•æ–¹å¼</h3>
<h4 data-id="heading-176">æ–¹æ³• 1ï¼šæ¨¡æ‹Ÿä¼ä¸šå¾®ä¿¡çš„ POST è¯·æ±‚</h4>
<pre><code class="hljs language-bash" lang="bash">curl -X POST http://127.0.0.1:18789/wecom \
  -H <span class="hljs-string">"Content-Type: text/xml"</span> \
  -d <span class="hljs-string">'&lt;xml&gt;&lt;ToUserName&gt;bot&lt;/ToUserName&gt;&lt;FromUserName&gt;user123&lt;/FromUserName&gt;&lt;CreateTime&gt;123456789&lt;/CreateTime&gt;&lt;MsgType&gt;text&lt;/MsgType&gt;&lt;Content&gt;ä½ å¥½&lt;/Content&gt;&lt;/xml&gt;'</span>
</code></pre>
<h4 data-id="heading-177">æ–¹æ³• 2ï¼šç›´æ¥åœ¨ä¼ä¸šå¾®ä¿¡é‡Œæµ‹è¯•</h4>
<p><strong>è¿™æ˜¯æ¨èæ–¹å¼ï¼</strong> é…ç½®å·²ç»å¥½äº†ï¼Œç°åœ¨å»ï¼š</p>
<ol>
<li><strong>ä¼ä¸šå¾®ä¿¡åå°</strong> â†’ åº”ç”¨ç®¡ç† â†’ ä½ çš„åº”ç”¨</li>
<li><strong>æ‰¾åˆ°"æ¥æ”¶æ¶ˆæ¯"</strong> â†’ ç¡®ä¿ URL ä¿å­˜æˆåŠŸï¼ˆæ˜¾ç¤º"è¯·æ±‚æˆåŠŸ"ï¼‰</li>
<li><strong>åœ¨ä¼ä¸šå¾®ä¿¡ APP é‡Œ</strong>æ‰¾åˆ°è¿™ä¸ªåº”ç”¨</li>
<li><strong>å‘é€æ¶ˆæ¯æµ‹è¯•</strong></li>
</ol>
<hr/>
<h3 data-id="heading-178">ä½ ç°åœ¨è¯¥åšçš„</h3>
<p><strong>å»ä¼ä¸šå¾®ä¿¡åå°ç¡®è®¤ï¼š</strong></p>





















<table><thead><tr><th>æ£€æŸ¥é¡¹</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>URL ä¿å­˜æˆåŠŸ</td><td>æ˜¾ç¤º"è¯·æ±‚æˆåŠŸ"æˆ–"éªŒè¯é€šè¿‡"</td></tr><tr><td>Token ä¸€è‡´</td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td></tr><tr><td>EncodingAESKey ä¸€è‡´</td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td></tr></tbody></table>
<p><strong>ç„¶åå»ä¼ä¸šå¾®ä¿¡ APP å‘æ¶ˆæ¯æµ‹è¯•ï¼</strong></p>
<hr/>
<h3 data-id="heading-179">å¦‚æœä¼ä¸šå¾®ä¿¡åå°ä¿å­˜å¤±è´¥</h3>
<p>å‘Šè¯‰æˆ‘é”™è¯¯ä¿¡æ¯ï¼Œå¯èƒ½æ˜¯ï¼š</p>
<ul>
<li>URL æ— æ³•è®¿é—®ï¼ˆFRP é—®é¢˜ï¼‰</li>
<li>Token/Key ä¸åŒ¹é…</li>
<li>å…¶ä»–é…ç½®é—®é¢˜</li>
</ul>
<p><strong>ç°åœ¨å»ä¼ä¸šå¾®ä¿¡åå°è¯•è¯•ä¿å­˜ï¼Œç„¶åå‘Šè¯‰æˆ‘ç»“æœï¼</strong> ğŸš€
User: é‚£å¼€å¯ä¸Šé¢çš„frpé‚£ä¸ªå†…ç½‘ç©¿é€å§
Kimi: å¥½çš„ï¼å¼€å¯ FRP å†…ç½‘ç©¿é€ï¼Œè®©ä¼ä¸šå¾®ä¿¡èƒ½è®¿é—®åˆ°ä½ çš„ Macã€‚</p>
<hr/>
<h3 data-id="heading-180">å¯åŠ¨ FRP å®¢æˆ·ç«¯</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰§è¡Œè¿™ä¸ªå‘½ä»¤å¯åŠ¨ FRP</span>
/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<hr/>
<h3 data-id="heading-181">ç¡®è®¤ FRP å¯åŠ¨æˆåŠŸ</h3>
<p>åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">2026-02-04 xx:xx:xx <span class="hljs-section">[I]</span> <span class="hljs-section">[client/service.go:327]</span> <span class="hljs-section">[xxxx]</span> login to server success
2026-02-04 xx:xx:xx <span class="hljs-section">[I]</span> <span class="hljs-section">[proxy/proxy_manager.go:180]</span> <span class="hljs-section">[xxxx]</span> proxy added: <span class="hljs-section">[bot]</span>
2026-02-04 xx:xx:xx <span class="hljs-section">[I]</span> <span class="hljs-section">[client/control.go:172]</span> <span class="hljs-section">[xxxx]</span> <span class="hljs-section">[bot]</span> start proxy success
</code></pre>
<p><strong>å…³é”®ï¼š<code>[bot] start proxy success</code></strong></p>
<hr/>
<h3 data-id="heading-182">éªŒè¯å¤–ç½‘è®¿é—®</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–°å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œæµ‹è¯•å¤–ç½‘ URL</span>
curl https://bot.shuqi.run/wecom
</code></pre>
<p><strong>å¦‚æœ FRP å’Œ OpenClaw éƒ½æ­£å¸¸ï¼Œåº”è¯¥è¿˜æ˜¯ <code>Internal Server Error</code>ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºç¼ºå°‘ POST å‚æ•°ï¼‰</strong></p>
<hr/>
<h3 data-id="heading-183">ç„¶åå»ä¼ä¸šå¾®ä¿¡åå°æµ‹è¯•</h3>
<ol>
<li>æ‰“å¼€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwork.weixin.qq.com%2Fwework_admin" target="_blank" title="https://work.weixin.qq.com/wework_admin" ref="nofollow noopener noreferrer">work.weixin.qq.com/wework_admiâ€¦</a></li>
<li>åº”ç”¨ç®¡ç† â†’ ä½ çš„åº”ç”¨ â†’ æ¥æ”¶æ¶ˆæ¯</li>
<li>ç‚¹å‡» <strong>"ä¿å­˜"</strong> æˆ– <strong>"éªŒè¯"</strong></li>
</ol>
<p><strong>åº”è¯¥æ˜¾ç¤ºï¼šè¯·æ±‚æˆåŠŸ</strong> âœ…</p>
<hr/>
<h3 data-id="heading-184">å¦‚æœ FRP å¯åŠ¨å¤±è´¥</h3>
<p>æ£€æŸ¥é”™è¯¯ï¼š</p>
<ul>
<li><code>connection refused</code> â†’ OpenClaw æ²¡å¯åŠ¨</li>
<li><code>login to server failed</code> â†’ FRP æœåŠ¡å™¨é…ç½®é—®é¢˜</li>
</ul>
<p><strong>æ‰§è¡Œå‘½ä»¤åæŠŠè¾“å‡ºç»™æˆ‘ï¼</strong> ğŸš€
User: dengxiaochao@dengxiaochao ~ % /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml</p>
<p>2026-02-04 19:55:58.988 [I] [sub/root.go:159] start frpc service for config file [/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml]
2026-02-04 19:55:58.989 [I] [client/service.go:335] try to connect to server...
2026-02-04 19:55:59.053 [I] [client/service.go:327] [8c811ae26837fbc1] login to server success, get run id [8c811ae26837fbc1]
2026-02-04 19:55:59.053 [I] [proxy/proxy_manager.go:180] [8c811ae26837fbc1] proxy added: [bot]
2026-02-04 19:55:59.074 [I] [client/control.go:172] [8c811ae26837fbc1] [bot] start proxy success curl <a href="https://link.juejin.cn?target=https%3A%2F%2Fbot.shuqi.run%2Fwecom" target="_blank" title="https://bot.shuqi.run/wecom" ref="nofollow noopener noreferrer">bot.shuqi.run/wecom</a>  è¿™ä¸ªä¸è¡Œï¼Œä½†æ˜¯curl <a href="https://link.juejin.cn?target=https%3A%2F%2Fbot.shuqi.run" target="_blank" title="https://bot.shuqi.run" ref="nofollow noopener noreferrer">bot.shuqi.run</a> è¿™ä¸ªå°±è¿”å›äº†å¾ˆå¤šä¿¡æ¯
Kimi: å¤ªå¥½äº†ï¼ğŸ‰ FRP å¯åŠ¨æˆåŠŸï¼</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">bot</span>] start proxy success
</code></pre>
<hr/>
<h3 data-id="heading-185">é—®é¢˜åˆ†æ</h3>




















<table><thead><tr><th>è¯·æ±‚</th><th>ç»“æœ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>curl https://bot.shuqi.run</code></td><td>âœ… è¿”å›å¾ˆå¤šä¿¡æ¯</td><td>FRP + OpenClaw æ­£å¸¸</td></tr><tr><td><code>curl https://bot.shuqi.run/wecom</code></td><td>âŒ ä¸è¡Œ</td><td>è·¯å¾„é—®é¢˜æˆ–æ’ä»¶é—®é¢˜</td></tr></tbody></table>
<p><strong><code>/</code> èƒ½è®¿é—®ï¼Œ<code>/wecom</code> ä¸èƒ½è®¿é—®</strong>ï¼Œè¯´æ˜ï¼š</p>
<ol>
<li><strong>FRP é…ç½®å¯èƒ½åªä»£ç†äº†æ ¹è·¯å¾„ <code>/</code></strong></li>
<li><strong>æˆ–è€… wecom æ’ä»¶çš„ webhookPath é…ç½®ä¸åŒ¹é…</strong></li>
</ol>
<hr/>
<h3 data-id="heading-186">æ£€æŸ¥ FRP é…ç½®</h3>
<p>çœ‹çœ‹ä½ çš„ <code>frpc.toml</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<p><strong>å…³é”®çœ‹ <code>custom_domains</code> å’Œ <code>locations</code> é…ç½®</strong></p>
<p>åº”è¯¥æ˜¯ç±»ä¼¼è¿™æ ·ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[[proxies]]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"bot"</span>
<span class="hljs-attr">type</span> = <span class="hljs-string">"http"</span>
<span class="hljs-attr">localPort</span> = <span class="hljs-number">18789</span>
<span class="hljs-attr">customDomains</span> = [<span class="hljs-string">"bot.shuqi.run"</span>]
<span class="hljs-comment"># æ³¨æ„ï¼šæœ‰æ²¡æœ‰ locations é…ç½®ï¼Ÿ</span>
</code></pre>
<hr/>
<h3 data-id="heading-187">å¯èƒ½çš„è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-188">æ–¹æ¡ˆ 1ï¼šFRP é…ç½®æ·»åŠ è·¯å¾„ï¼ˆå¦‚æœæ”¯æŒï¼‰</h4>
<p>å¦‚æœ <code>frpc.toml</code> æœ‰ <code>locations</code>ï¼Œæ”¹æˆï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">locations</span> = [<span class="hljs-string">"/"</span>, <span class="hljs-string">"/wecom"</span>]
</code></pre>
<h4 data-id="heading-189">æ–¹æ¡ˆ 2ï¼šä¿®æ”¹ OpenClaw webhookPath ä¸ºæ ¹è·¯å¾„</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŠŠ wecom çš„ webhookPath æ”¹æˆ /</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/","token":"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD","encodingAESKey":"ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL","receiveId":"","dm":{"policy":"pairing"}}'</span> --json

openclaw gateway restart
</code></pre>
<p>ç„¶åä¼ä¸šå¾®ä¿¡åå° URL å¡«ï¼š<code>https://bot.shuqi.run</code></p>
<hr/>
<h3 data-id="heading-190">ä½ ç°åœ¨æ‰§è¡Œ</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹ FRP é…ç½®</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<p><strong>æŠŠå†…å®¹è´´ç»™æˆ‘</strong>ï¼Œæˆ‘çœ‹æ€ä¹ˆæ”¹ï¼ğŸ”§
User: cat /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml</p>
<h2 data-id="heading-191">æˆ‘æ˜¯é…ç½®æ–‡ä»¶ï¼Œè¯·å°†æˆ‘å…¨éƒ¨å¤åˆ¶åˆ° frpc.toml !</h2>
<p>serverAddr = "122.9.157.124"
serverPort = 7000
auth.method = "token"
auth.token = "60d8a83c544e6168db"
#user = "2026th02U03v224515bg"
#metadatas.token = "hsidc123"</p>
<p>[[proxies]]
name = "bot" # åº”ç”¨åï¼Œå¿…é¡»å”¯ä¸€ï¼Œä½†ä½ å¯ä»¥éšä¾¿å¡«å†™
type = "tcp"
localIP = "127.0.0.1" # æœ¬åœ°IPï¼Œæœ¬æœºå°±å¡«å†™127.0.0.1ã€å±€åŸŸç½‘å…¶å®ƒæœºå™¨å°±å¡« 192.168.x.x çš„å†…ç½‘IP
localPort = 18789 # æœ¬åœ°ç«¯å£å·ï¼Œä¾‹å¦‚é£ç‰›NASæ­¤å¤„å¡«å†™5666
remotePort = 10981  # æœåŠ¡å™¨è¿œç¨‹ç«¯å£å·ï¼Œç«¯å£èŒƒå›´: [10981-10990] éšä¾¿æŒ‘ä¸€ä¸ªå°±è¡Œ</p>
<h2 data-id="heading-192">å¯åŠ¨ frpc åï¼Œå¯ä»¥é€šè¿‡ <a href="https://link.juejin.cn?target=http%3A%2F%2F114.66.55.23%3A10981" target="_blank" title="http://114.66.55.23:10981" ref="nofollow noopener noreferrer">http://114.66.55.23:10981</a>  è¿›è¡Œè®¿é—®</h2>
<h2 data-id="heading-193">å¯ä»¥å°†ä½ çš„åŸŸå DNS è®°å½•è§£æè‡³ 114.66.55.23</h2>
<h2 data-id="heading-194">è¿™æ ·å°±èƒ½é€šè¿‡: <a href="https://link.juejin.cn?target=http%3A%2F%2F%25E4%25BD%25A0%25E7%259A%2584%25E5%259F%259F%25E5%2590%258D%3A10981" target="_blank" title="http://%E4%BD%A0%E7%9A%84%E5%9F%9F%E5%90%8D:10981" ref="nofollow noopener noreferrer">http://ä½ çš„åŸŸå:10981</a> è¿›è¡Œè®¿é—®</h2>
<h2 data-id="heading-195">å¦‚æœä½ æƒ³é…ç½®ç¬¬äºŒä¸ªåº”ç”¨å¦‚ä¸‹æ‰€ç¤ºï¼ŒæŠŠ # æ³¨é‡Šæ‰“å¼€å°±è¡Œï¼Œç¬¬ä¸‰ä¸ªåº”ç”¨åŒç†</h2>
<p>#[[proxies]]
#name = "my_app02"
#type = "tcp"
#localIP = "127.0.0.1"
#localPort = 80
#remotePort = 18789%
Kimi: æ‰¾åˆ°äº†ï¼ğŸ”</p>
<p><strong>é—®é¢˜ï¼šFRP ç”¨çš„æ˜¯ <code>type = "tcp"</code>ï¼Œä¸æ˜¯ <code>http</code>ï¼</strong></p>
<p>TCP æ¨¡å¼åªè½¬å‘ç«¯å£ï¼Œä¸æ”¯æŒ HTTP è·¯å¾„ï¼ˆ<code>/wecom</code>ï¼‰ï¼Œæ‰€ä»¥ï¼š</p>
<ul>
<li><code>https://bot.shuqi.run</code> èƒ½è®¿é—®ï¼ˆå¯èƒ½æ˜¯ nginx åšäº†é»˜è®¤è½¬å‘ï¼‰</li>
<li><code>https://bot.shuqi.run/wecom</code> ä¸è¡Œï¼ˆè·¯å¾„æ²¡æ­£ç¡®è½¬å‘ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-196">è§£å†³æ–¹æ¡ˆï¼šæ”¹æˆ HTTP æ¨¡å¼</h3>
<h4 data-id="heading-197">ä¿®æ”¹ frpc.toml</h4>
<pre><code class="hljs language-bash" lang="bash">nano /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<p><strong>æ”¹æˆè¿™æ ·ï¼š</strong></p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">serverAddr</span> = <span class="hljs-string">"122.9.157.124"</span>
<span class="hljs-attr">serverPort</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">auth.method</span> = <span class="hljs-string">"token"</span>
<span class="hljs-attr">auth.token</span> = <span class="hljs-string">"60d8a83c544e6168db"</span>

<span class="hljs-section">[[proxies]]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"bot"</span>
<span class="hljs-attr">type</span> = <span class="hljs-string">"http"</span>                    <span class="hljs-comment"># æ”¹æˆ http</span>
<span class="hljs-attr">localIP</span> = <span class="hljs-string">"127.0.0.1"</span>
<span class="hljs-attr">localPort</span> = <span class="hljs-number">18789</span>
<span class="hljs-attr">customDomains</span> = [<span class="hljs-string">"bot.shuqi.run"</span>]  <span class="hljs-comment"># ä½ çš„åŸŸå</span>
<span class="hljs-comment"># remotePort ä¸éœ€è¦ï¼Œhttp æ¨¡å¼ç”¨åŸŸåè®¿é—®</span>
</code></pre>
<hr/>
<h3 data-id="heading-198">é‡å¯ FRP</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åœæ­¢ä¹‹å‰çš„ frpcï¼ˆCtrl+Cï¼‰</span>

<span class="hljs-comment"># 2. é‡æ–°å¯åŠ¨</span>
/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<hr/>
<h3 data-id="heading-199">éªŒè¯</h3>
<pre><code class="hljs language-bash" lang="bash">curl https://bot.shuqi.run/wecom
</code></pre>
<p><strong>åº”è¯¥èƒ½è®¿é—®äº†ï¼</strong></p>
<hr/>
<h3 data-id="heading-200">å¦‚æœæœåŠ¡å™¨ç«¯ä¸æ”¯æŒ HTTP æ¨¡å¼</h3>
<p>å¯èƒ½ FRP æœåŠ¡å™¨åªå¼€äº† TCPï¼Œé‚£éœ€è¦è”ç³»æœåŠ¡å™¨ç®¡ç†å‘˜ï¼Œæˆ–è€…ï¼š</p>
<p><strong>æ–¹æ¡ˆ Bï¼šç”¨ TCP æ¨¡å¼ + ä¿®æ”¹ OpenClaw è·¯å¾„ä¸ºæ ¹</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŠŠ webhookPath æ”¹æˆ /</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/","token":"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD","encodingAESKey":"ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL","receiveId":"","dm":{"policy":"pairing"}}'</span> --json

openclaw gateway restart
</code></pre>
<p>ç„¶åä¼ä¸šå¾®ä¿¡åå° URL å¡«ï¼š<code>http://bot.shuqi.run:10981</code>ï¼ˆæ³¨æ„æ˜¯ 10981 ç«¯å£ï¼‰</p>
<hr/>
<h3 data-id="heading-201">å…ˆè¯•è¯•æ–¹æ¡ˆ Aï¼ˆæ”¹ HTTP æ¨¡å¼ï¼‰</h3>
<p><strong>ä¿®æ”¹ frpc.toml åé‡å¯ FRPï¼Œç„¶åæµ‹è¯•ï¼</strong></p>
<p>æœ‰é—®é¢˜å‘Šè¯‰æˆ‘ï¼ğŸš€
User: curl <a href="https://link.juejin.cn?target=https%3A%2F%2Fbot.shuqi.run%2Fwecom" target="_blank" title="https://bot.shuqi.run/wecom" ref="nofollow noopener noreferrer">bot.shuqi.run/wecom</a></p>

502 Bad Gateway

<h2 data-id="heading-202">502 Bad Gateway</h2>
<hr/>nginx

 æˆ‘è¯•äº†ä¸ºå•¥è¿”å›è¿™ä¸ª
Kimi: 502 Bad Gateway è¯´æ˜ FRP çš„ HTTP æ¨¡å¼è¿æ¥å¤±è´¥äº†ã€‚
<hr/>
<h3 data-id="heading-203">å¯èƒ½åŸå› </h3>





















<table><thead><tr><th>åŸå› </th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>FRP æœåŠ¡å™¨ç«¯æ²¡å¼€ HTTP æ”¯æŒ</strong></td><td>æœåŠ¡å™¨åªé…ç½®äº† TCP ç«¯å£</td></tr><tr><td><strong>åŸŸåè§£æé—®é¢˜</strong></td><td><code>bot.shuqi.run</code> æ²¡æŒ‡å‘ FRP æœåŠ¡å™¨</td></tr><tr><td><strong>FRP å®¢æˆ·ç«¯è¿æ¥å¤±è´¥</strong></td><td>HTTP æ¨¡å¼è¿ä¸ä¸ŠæœåŠ¡å™¨</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-204">å¿«é€Ÿè§£å†³æ–¹æ¡ˆï¼šç”¨å› TCP æ¨¡å¼ + æŒ‡å®šç«¯å£</h3>
<p>ä½ çš„ FRP æœåŠ¡å™¨åªæ”¯æŒ TCPï¼Œé‚£å°±ç”¨ TCP æ¨¡å¼ï¼Œ<strong>ä½†ä¼ä¸šå¾®ä¿¡è¦å¡«å¸¦ç«¯å£çš„ URL</strong>ã€‚</p>
<h4 data-id="heading-205">æ­¥éª¤ 1ï¼šæ”¹å› TCP é…ç½®</h4>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">serverAddr</span> = <span class="hljs-string">"122.9.157.124"</span>
<span class="hljs-attr">serverPort</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">auth.method</span> = <span class="hljs-string">"token"</span>
<span class="hljs-attr">auth.token</span> = <span class="hljs-string">"60d8a83c544e6168db"</span>

<span class="hljs-section">[[proxies]]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"bot"</span>
<span class="hljs-attr">type</span> = <span class="hljs-string">"tcp"</span>
<span class="hljs-attr">localIP</span> = <span class="hljs-string">"127.0.0.1"</span>
<span class="hljs-attr">localPort</span> = <span class="hljs-number">18789</span>
<span class="hljs-attr">remotePort</span> = <span class="hljs-number">10981</span>
</code></pre>
<h4 data-id="heading-206">æ­¥éª¤ 2ï¼šé‡å¯ FRP</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœæ­¢åé‡æ–°å¯åŠ¨</span>
/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<h4 data-id="heading-207">æ­¥éª¤ 3ï¼šä¿®æ”¹ OpenClaw çš„ webhookPath ä¸ºæ ¹è·¯å¾„</h4>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/","token":"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD","encodingAESKey":"ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL","receiveId":"","dm":{"policy":"pairing"}}'</span> --json

openclaw gateway restart
</code></pre>
<h4 data-id="heading-208">æ­¥éª¤ 4ï¼šä¼ä¸šå¾®ä¿¡åå°å¡«å†™å¸¦ç«¯å£çš„ URL</h4>





















<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>http://122.9.157.124:10981</code></td></tr><tr><td><strong>Token</strong></td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td></tr></tbody></table>
<p><strong>æ³¨æ„ï¼šæ˜¯ HTTP ä¸æ˜¯ HTTPSï¼Œä¸”å¸¦ 10981 ç«¯å£ï¼</strong></p>
<hr/>
<h3 data-id="heading-209">éªŒè¯</h3>
<pre><code class="hljs language-bash" lang="bash">curl http://122.9.157.124:10981
</code></pre>
<p><strong>åº”è¯¥èƒ½è¿”å› OpenClaw çš„ä¿¡æ¯äº†ï¼</strong></p>
<hr/>
<h3 data-id="heading-210">å¦‚æœè¦ç”¨åŸŸåï¼ˆbot.shuqi.runï¼‰</h3>
<p>éœ€è¦æœåŠ¡å™¨ç®¡ç†å‘˜é…ç½® nginx è½¬å‘ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">bot.shuqi.run â†’ <span class="hljs-number">122.9</span><span class="hljs-number">.157</span><span class="hljs-number">.124</span>:<span class="hljs-number">10981</span>
</code></pre>
<p>è¿™ä¸ªä½ æ§åˆ¶ä¸äº†ï¼Œ<strong>å…ˆç”¨ IP:ç«¯å£ æµ‹è¯•ï¼</strong></p>
<hr/>
<h3 data-id="heading-211">ä½ ç°åœ¨æ‰§è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ”¹é…ç½®</span>
nano /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
<span class="hljs-comment"># ç¡®è®¤æ˜¯ tcp æ¨¡å¼ï¼ŒremotePort = 10981</span>

<span class="hljs-comment"># 2. é‡å¯ FRP</span>
/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml

<span class="hljs-comment"># 3. æ”¹ OpenClaw é…ç½®</span>
openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/","token":"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD","encodingAESKey":"ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL","receiveId":"","dm":{"policy":"pairing"}}'</span> --json
openclaw gateway restart

<span class="hljs-comment"># 4. æµ‹è¯•</span>
curl http://122.9.157.124:10981
</code></pre>
<p><strong>æ‰§è¡Œå®Œå‘Šè¯‰æˆ‘ç»“æœï¼</strong> ğŸš€
User: % curl <a href="https://link.juejin.cn?target=http%3A%2F%2F122.9.157.124%3A10981" target="_blank" title="http://122.9.157.124:10981" ref="nofollow noopener noreferrer">http://122.9.157.124:10981</a>
curl: (28) Failed to connect to 122.9.157.124 port 10981 after 17220 ms: Couldn't connect to server
dengxiaochao@dengxiaochao ~ % curl <a href="https://link.juejin.cn?target=https%3A%2F%2Fbot.shuqi.run" target="_blank" title="https://bot.shuqi.run" ref="nofollow noopener noreferrer">bot.shuqi.run</a>  ç¬¬äºŒä¸ªcurlè¿”å›ä¿¡æ¯
Kimi: æ˜ç™½äº†ï¼ğŸ”</p>
<p><strong>æƒ…å†µï¼š</strong></p>
<ul>
<li><code>122.9.157.124:10981</code> è¿ä¸ä¸Šï¼ˆç«¯å£æ²¡å¼€æˆ–é˜²ç«å¢™ï¼‰</li>
<li><code>https://bot.shuqi.run</code> èƒ½è®¿é—®ï¼ˆèµ° nginx çš„ 80/443 ç«¯å£ï¼‰</li>
</ul>
<p><strong>è¯´æ˜ FRP æœåŠ¡å™¨ç«¯åªå¼€æ”¾äº† 80/443 ç«¯å£ï¼Œ10981 ç«¯å£æ²¡å¯¹å¤–å¼€æ”¾ï¼</strong></p>
<hr/>
<h3 data-id="heading-212">è§£å†³æ–¹æ¡ˆï¼šç”¨ nginx è½¬å‘ï¼ˆæœåŠ¡å™¨ç«¯é…ç½®ï¼‰</h3>
<p>éœ€è¦æœåŠ¡å™¨ç®¡ç†å‘˜åœ¨ <code>122.9.157.124</code> ä¸Šé…ç½® nginxï¼ŒæŠŠ <code>bot.shuqi.run</code> è½¬å‘åˆ°æœ¬åœ°çš„ 10981 ç«¯å£ã€‚</p>
<p><strong>ä½†ä½ æ§åˆ¶ä¸äº†æœåŠ¡å™¨...</strong></p>
<hr/>
<h3 data-id="heading-213">æ›¿ä»£æ–¹æ¡ˆï¼šç”¨ OpenClaw çš„ Cloud æ¨¡å¼</h3>
<p>å¦‚æœæœ¬åœ°ç©¿é€å¤ªéº»çƒ¦ï¼Œå¯ä»¥è¯•è¯• OpenClaw çš„ <strong>Cloud æ‰˜ç®¡</strong> æˆ– <strong>Tailscale</strong> æ¨¡å¼ã€‚</p>
<h4 data-id="heading-214">æ£€æŸ¥ OpenClaw å…¶ä»–ç»‘å®šé€‰é¡¹</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æ”¯æŒçš„æ¨¡å¼</span>
openclaw gateway start --<span class="hljs-built_in">help</span>
</code></pre>
<hr/>
<h3 data-id="heading-215">æœ€ç®€å•çš„æ–¹æ¡ˆï¼šç”¨ ngrokï¼ˆä¹‹å‰æˆåŠŸçš„ï¼‰</h3>
<p>æ—¢ç„¶ <code>https://bot.shuqi.run</code> èƒ½è®¿é—®ï¼Œä½†è·¯å¾„æœ‰é—®é¢˜ï¼Œ<strong>ä¸å¦‚å…ˆç”¨ ngrok æµ‹è¯•</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å¯åŠ¨ ngrok</span>
ngrok http 18789

<span class="hljs-comment"># 2. è·å¾— https åœ°å€ï¼ˆå¦‚ https://abc123.ngrok-free.appï¼‰</span>

<span class="hljs-comment"># 3. ä¼ä¸šå¾®ä¿¡åå°å¡«</span>
<span class="hljs-comment"># URL: https://abc123.ngrok-free.app/wecom</span>
</code></pre>
<p><strong>ngrok çš„ HTTP æ¨¡å¼æ”¯æŒè·¯å¾„ï¼Œè€Œä¸” HTTPS è¯ä¹¦æ˜¯æœ‰æ•ˆçš„ï¼</strong></p>
<hr/>
<h3 data-id="heading-216">ä½ ç°åœ¨é€‰å“ªä¸ªï¼Ÿ</h3>



































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>éš¾åº¦</th><th>æ—¶é—´</th></tr></thead><tbody><tr><td>A. è”ç³»æœåŠ¡å™¨ç®¡ç†å‘˜å¼€ 10981 ç«¯å£æˆ–é… nginx</td><td>â­â­â­ éš¾</td><td>ä¸ç¡®å®š</td></tr><tr><td>B. ç”¨ ngrok ä¸´æ—¶æµ‹è¯•</td><td>â­ ç®€å•</td><td>ç«‹åˆ»å¯ç”¨</td></tr><tr><td>C. æ£€æŸ¥ OpenClaw cloud/tailnet æ¨¡å¼</td><td>â­â­ ä¸­ç­‰</td><td/></tr><tr><td>User: æˆ‘å°±æ˜¯ç®¡ç†å‘˜æˆ‘å…¨æƒæ§åˆ¶çš„</td><td/><td/></tr><tr><td>Kimi: å¤ªå¥½äº†ï¼ä½ æ˜¯ç®¡ç†å‘˜ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å½»åº•è§£å†³è¿™ä¸ªé—®é¢˜ï¼</td><td/><td/></tr></tbody></table>
<hr/>
<h3 data-id="heading-217">é—®é¢˜åˆ†æ</h3>

















<table><thead><tr><th>ç°è±¡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>curl https://bot.shuqi.run</code> âœ… æœ‰è¿”å›</td><td>nginx + FRP æ­£å¸¸</td></tr><tr><td><code>curl http://122.9.157.124:10981</code> âŒ è¿ä¸ä¸Š</td><td>æœåŠ¡å™¨ 10981 ç«¯å£æ²¡å¼€æˆ– FRP æ²¡è¿ä¸Š</td></tr></tbody></table>
<p><strong>è¯´æ˜ FRP çš„ TCP æ¨¡å¼æ²¡æˆåŠŸï¼Œä½† HTTP æ¨¡å¼ä¹‹å‰æ˜¯é€šçš„ï¼ˆåªæ˜¯ 502ï¼‰</strong></p>
<hr/>
<h3 data-id="heading-218">æœ€ä½³æ–¹æ¡ˆï¼šæœåŠ¡å™¨ç«¯å¼€ HTTP æ”¯æŒ + nginx è½¬å‘</h3>
<h4 data-id="heading-219">æ­¥éª¤ 1ï¼šæœåŠ¡å™¨ç«¯é…ç½® frps.toml</h4>
<p>åœ¨ä½ çš„æœåŠ¡å™¨ï¼ˆ122.9.157.124ï¼‰ä¸Šï¼š</p>
<pre><code class="hljs language-bash" lang="bash">nano /path/to/frps.toml
</code></pre>
<p>ç¡®ä¿æœ‰ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">bindPort</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">vhostHTTPPort</span> = <span class="hljs-number">80</span>      <span class="hljs-comment"># HTTP è™šæ‹Ÿä¸»æœºç«¯å£</span>
<span class="hljs-comment"># æˆ–è€…</span>
<span class="hljs-attr">vhostHTTPSPort</span> = <span class="hljs-number">443</span>    <span class="hljs-comment"># HTTPS è™šæ‹Ÿä¸»æœºç«¯å£ï¼ˆå¦‚æœç”¨ HTTPSï¼‰</span>
</code></pre>
<h4 data-id="heading-220">æ­¥éª¤ 2ï¼šé‡å¯ FRP æœåŠ¡å™¨</h4>
<pre><code class="hljs language-bash" lang="bash">systemctl restart frps
<span class="hljs-comment"># æˆ–</span>
./frps -c frps.toml
</code></pre>
<h4 data-id="heading-221">æ­¥éª¤ 3ï¼šå®¢æˆ·ç«¯æ”¹å› HTTP æ¨¡å¼</h4>
<p>åœ¨ä½ çš„ Mac ä¸Šï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">serverAddr</span> = <span class="hljs-string">"122.9.157.124"</span>
<span class="hljs-attr">serverPort</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">auth.method</span> = <span class="hljs-string">"token"</span>
<span class="hljs-attr">auth.token</span> = <span class="hljs-string">"60d8a83c544e6168db"</span>

<span class="hljs-section">[[proxies]]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"bot"</span>
<span class="hljs-attr">type</span> = <span class="hljs-string">"http"</span>
<span class="hljs-attr">localIP</span> = <span class="hljs-string">"127.0.0.1"</span>
<span class="hljs-attr">localPort</span> = <span class="hljs-number">18789</span>
<span class="hljs-attr">customDomains</span> = [<span class="hljs-string">"bot.shuqi.run"</span>]
</code></pre>
<h4 data-id="heading-222">æ­¥éª¤ 4ï¼šé‡å¯å®¢æˆ·ç«¯ FRP</h4>
<pre><code class="hljs language-bash" lang="bash">/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<h4 data-id="heading-223">æ­¥éª¤ 5ï¼šnginx é…ç½®ï¼ˆå¦‚æœè¦ç”¨ HTTPSï¼‰</h4>
<p>åœ¨æœåŠ¡å™¨ä¸Šï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">server {
    listen 443 ssl;
    server_name bot.shuqi.run;
  
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
  
    location / {
        proxy_pass http://127.0.0.1:80;  # è½¬å‘åˆ° FRP çš„ vhostHTTPPort
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-224">å¿«é€ŸéªŒè¯æ­¥éª¤</h3>
<p><strong>æœåŠ¡å™¨ç«¯æ‰§è¡Œï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥ FRP æœåŠ¡å™¨æ˜¯å¦å¼€äº† HTTP æ”¯æŒ</span>
netstat -tlnp | grep frps
<span class="hljs-comment"># åº”è¯¥çœ‹åˆ° :80 æˆ– :443</span>
</code></pre>
<p><strong>å®¢æˆ·ç«¯æ‰§è¡Œï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é‡å¯ FRP HTTP æ¨¡å¼</span>
/Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc -c /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64/frpc.toml
</code></pre>
<p><strong>æµ‹è¯•ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">curl https://bot.shuqi.run/wecom
</code></pre>
<hr/>
<h3 data-id="heading-225">ä½ ç°åœ¨æ£€æŸ¥</h3>
<p><strong>åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /path/to/frps.toml
netstat -tlnp | grep frp
</code></pre>
<p><strong>æŠŠ FRP æœåŠ¡å™¨çš„é…ç½®è´´ç»™æˆ‘ï¼</strong> ğŸ”§
User: dengxiaochao@dengxiaochao Downloads % ls
Clash.Verge_2.4.5_x64.dmg		ddns-go_6.15.0_darwin_x86_64 2
ToDesk					ddns-go_6.15.0_darwin_x86_64.tar.gz
ddns-go_6.15.0_darwin_arm64		frp_0.67.0_darwin_amd64
ddns-go_6.15.0_darwin_arm64.tar.gz	frp_0.67.0_darwin_amd64.tar.gz
ddns-go_6.15.0_darwin_x86_64		node-v22.2.0.pkg
dengxiaochao@dengxiaochao Downloads % cd frp_0.67.0_darwin_amd64
dengxiaochao@dengxiaochao frp_0.67.0_darwin_amd64 % ls
LICENSE		frpc		frpc.toml	frps		frps.toml
Kimi: å¤ªå¥½äº†ï¼ä½ æœ¬åœ°æœ‰ <code>frps</code> å’Œ <code>frps.toml</code>ï¼Œè¯´æ˜ FRP æœåŠ¡å™¨ç«¯ä¹Ÿåœ¨ä½  Mac ä¸Šï¼Ÿè¿˜æ˜¯åªæ˜¯å®¢æˆ·ç«¯å·¥å…·ï¼Ÿ</p>
<hr/>
<h3 data-id="heading-226">ç¡®è®¤æœåŠ¡å™¨ä½ç½®</h3>
<p><strong>122.9.157.124 è¿™ä¸ª IP æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>ä½ çš„ Mac å…¬ç½‘ IPï¼Ÿ</li>
<li>äº‘æœåŠ¡å™¨ IPï¼Ÿ</li>
<li>è¿˜æ˜¯å…¶ä»–è®¾å¤‡ï¼Ÿ</li>
</ul>
<hr/>
<h3 data-id="heading-227">å¦‚æœæ˜¯äº‘æœåŠ¡å™¨ï¼ˆ122.9.157.124ï¼‰</h3>
<p>éœ€è¦ SSH ç™»å½•åˆ°é‚£å°æœåŠ¡å™¨ï¼Œä¿®æ”¹å®ƒçš„ <code>frps.toml</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ssh root@122.9.157.124
<span class="hljs-comment"># ç„¶å</span>
<span class="hljs-built_in">cat</span> /path/to/frps.toml
</code></pre>
<hr/>
<h3 data-id="heading-228">å¦‚æœæœåŠ¡å™¨ç«¯ä¹Ÿåœ¨ä½  Mac ä¸Šï¼ˆæµ‹è¯•ç”¨ï¼‰</h3>
<p>é‚£éœ€è¦å¯åŠ¨ <code>frps</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> /Users/dengxiaochao/Downloads/frp_0.67.0_darwin_amd64
User: æœåŠ¡å™¨ç«¯ä¹Ÿåœ¨ä½  Mac   122.9.157.124æ˜¯å…¬ç½‘ip ä»–æ‹‰çš„å®½å¸¦
Kimi: æ˜ç™½äº†ï¼**FRP æœåŠ¡å™¨ç«¯ä¹Ÿåœ¨ä½ çš„ Mac ä¸Š**ï¼Œ`122.9.157.124` æ˜¯å…¬ç½‘ IPã€‚

è¿™æ„å‘³ç€ï¼š
- **frps**ï¼ˆæœåŠ¡ç«¯ï¼‰åœ¨ä½ çš„ Mac è¿è¡Œ
- **frpc**ï¼ˆå®¢æˆ·ç«¯ï¼‰ä¹Ÿåœ¨ä½ çš„ Mac è¿è¡Œ
- å…¬ç½‘ IP æ˜¯å®½å¸¦æ‹¨å·è·å–çš„

---

<span class="hljs-comment">## å¿«é€Ÿè§£å†³æ–¹æ¡ˆï¼šä¸ç”¨ FRPï¼Œç›´æ¥ç”¨å…¬ç½‘ IP</span>

å¦‚æœä½ çš„ Mac æœ‰å…¬ç½‘ IPï¼ˆ122.9.157.124ï¼‰ï¼Œ**ç›´æ¥è®© OpenClaw ç›‘å¬å…¬ç½‘**ï¼š

<span class="hljs-comment">### æ­¥éª¤ 1ï¼šåœæ­¢ FRPï¼ˆä¸éœ€è¦äº†ï¼‰</span>

```bash
<span class="hljs-comment"># åœæ­¢ frpc å’Œ frpsï¼ˆCtrl+C æˆ–æ€æ‰è¿›ç¨‹ï¼‰</span>
pkill frpc
pkill frps
</code></pre>
<h4 data-id="heading-229">æ­¥éª¤ 2ï¼šOpenClaw ç»‘å®šå…¬ç½‘ IP</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å½“å‰ç»‘å®š</span>
openclaw config get gateway.bind

<span class="hljs-comment"># æ”¹æˆå…¬ç½‘ IP</span>
openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"122.9.157.124"</span>
openclaw config <span class="hljs-built_in">set</span> gateway.port 18789

<span class="hljs-comment"># é‡å¯</span>
openclaw gateway restart
</code></pre>
<h4 data-id="heading-230">æ­¥éª¤ 3ï¼šè·¯ç”±å™¨åšç«¯å£æ˜ å°„</h4>
<p>åœ¨ä½ çš„è·¯ç”±å™¨åå°ï¼š</p>
<ul>
<li><strong>å¤–ç½‘ç«¯å£</strong>ï¼š80 æˆ– 443 æˆ– 18789</li>
<li><strong>å†…ç½‘ IP</strong>ï¼šä½ çš„ Mac å†…ç½‘ IPï¼ˆå¦‚ 192.168.1.xxxï¼‰</li>
<li><strong>å†…ç½‘ç«¯å£</strong>ï¼š18789</li>
</ul>
<h4 data-id="heading-231">æ­¥éª¤ 4ï¼šä¼ä¸šå¾®ä¿¡åå°å¡«å†™</h4>





















<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>http://122.9.157.124:18789/wecom</code> æˆ– <code>http://ä½ çš„åŸŸå:18789/wecom</code></td></tr><tr><td><strong>Token</strong></td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-232">å¦‚æœè¦ç”¨ FRPï¼ˆä¿æŒç°æœ‰æ¶æ„ï¼‰</h3>
<p>é‚£éœ€è¦ <strong>frps åœ¨å…¬ç½‘æœåŠ¡å™¨ä¸Šè¿è¡Œ</strong>ï¼Œä½†ç°åœ¨éƒ½åœ¨ä½ çš„ Macï¼Œæ²¡æœ‰æ„ä¹‰ã€‚</p>
<hr/>
<h3 data-id="heading-233">æ¨èï¼šç›´æ¥ç”¨å…¬ç½‘ IP</h3>
<p><strong>ä½ ç°åœ¨æ‰§è¡Œï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åœæ‰ FRP</span>
pkill frpc frps

<span class="hljs-comment"># 2. OpenClaw ç»‘å®šå…¬ç½‘ IP</span>
openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"122.9.157.124"</span>
openclaw gateway restart

<span class="hljs-comment"># 3. éªŒè¯</span>
openclaw gateway status
curl http://122.9.157.124:18789/wecom
</code></pre>
<p><strong>ç„¶åå‘Šè¯‰æˆ‘ç»“æœï¼</strong> ğŸ”§
User: <code>&lt;h1&gt;</code>æŠ±æ­‰ï¼è¯¥ç«™ç‚¹å·²ç»è¢«ç®¡ç†å‘˜åœæ­¢è¿è¡Œï¼Œè¯·è”ç³»ç®¡ç†å‘˜äº†è§£è¯¦æƒ…ï¼<code>&lt;/h1&gt;</code></p>



dengxiaochao@dengxiaochao frp_0.67.0_darwin_amd64 % ssh root@122.9.157.124
<p>dengxiaochao@dengxiaochao frp_0.67.0_darwin_amd64 % ssh root@122.9.157.124</p>
<p>dengxiaochao@dengxiaochao frp_0.67.0_darwin_amd64 % ssh root@122.9.157.124</p>
<p>The authenticity of host '122.9.157.124 (122.9.157.124)' can't be established.
ED25519 key fingerprint is SHA256:uQ44A4ybXd00RPq0n1be8lz6Nlo9ADrJNC8vve2MLeU.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])?  ä¸Šé¢é‚£ä¸ªæ˜¯æˆ‘ç›´æ¥curl ipçš„
Kimi: æ˜ç™½äº†ï¼<code>122.9.157.124</code> è¿™ä¸ª IP ä¸æ˜¯ä½ çš„ Macï¼Œæ˜¯<strong>å¦ä¸€å°äº‘æœåŠ¡å™¨</strong>ï¼ˆå¯èƒ½æ˜¯ç§Ÿçš„ VPSï¼‰ã€‚</p>
<p><strong>"è¯¥ç«™ç‚¹å·²ç»è¢«ç®¡ç†å‘˜åœæ­¢è¿è¡Œ"</strong> è¯´æ˜è¿™ä¸ªæœåŠ¡å™¨ä¸Šä¹‹å‰è·‘äº† frpsï¼Œä½†ç°åœ¨åœäº†ã€‚</p>
<hr/>
<h3 data-id="heading-234">æƒ…å†µæ¢³ç†</h3>

























<table><thead><tr><th>ç»„ä»¶</th><th>ä½ç½®</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td><strong>OpenClaw</strong></td><td>ä½ çš„ Mac</td><td>âœ… è¿è¡Œä¸­</td></tr><tr><td><strong>FRP å®¢æˆ·ç«¯ (frpc)</strong></td><td>ä½ çš„ Mac</td><td>éœ€è¦è¿æ¥æœåŠ¡å™¨</td></tr><tr><td><strong>FRP æœåŠ¡å™¨ (frps)</strong></td><td>122.9.157.124 (äº‘æœåŠ¡å™¨)</td><td>âŒ å·²åœæ­¢</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-235">è§£å†³æ–¹æ¡ˆï¼šå¯åŠ¨äº‘æœåŠ¡å™¨ä¸Šçš„ frps</h3>
<h4 data-id="heading-236">æ­¥éª¤ 1ï¼šSSH ç™»å½•äº‘æœåŠ¡å™¨</h4>
<pre><code class="hljs language-bash" lang="bash">ssh root@122.9.157.124
<span class="hljs-comment"># è¾“å…¥ yes ç¡®è®¤æŒ‡çº¹</span>
<span class="hljs-comment"># ç„¶åè¾“å…¥å¯†ç </span>
</code></pre>
<h4 data-id="heading-237">æ­¥éª¤ 2ï¼šå¯åŠ¨ frps</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰¾åˆ° frps ç›®å½•</span>
<span class="hljs-built_in">cd</span> /path/to/frp
<span class="hljs-comment"># æˆ–</span>
<span class="hljs-built_in">which</span> frps

<span class="hljs-comment"># å¯åŠ¨</span>
./frps -c frps.toml
</code></pre>
<h4 data-id="heading-238">æ­¥éª¤ 3ï¼šæ£€æŸ¥ frps é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> frps.toml
</code></pre>
<p>ç¡®ä¿æœ‰ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">bindPort</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">vhostHTTPPort</span> = <span class="hljs-number">80</span>
<span class="hljs-comment"># æˆ–</span>
<span class="hljs-attr">vhostHTTPSPort</span> = <span class="hljs-number">443</span>
</code></pre>
<hr/>
<h3 data-id="heading-239">å¦‚æœäº‘æœåŠ¡å™¨æ²¡è£… FRP</h3>
<p>éœ€è¦ä¸Šä¼ å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨ä½ çš„ Mac ä¸Šï¼Œä¸Šä¼  FRP åˆ°æœåŠ¡å™¨</span>
scp -r frp_0.67.0_darwin_amd64 root@122.9.157.124:/root/

<span class="hljs-comment"># æ³¨æ„ï¼šæœåŠ¡å™¨å¯èƒ½æ˜¯ Linuxï¼Œéœ€è¦ä¸‹è½½ Linux ç‰ˆæœ¬</span>
<span class="hljs-comment"># https://github.com/fatedier/frp/releases</span>
</code></pre>
<hr/>
<h3 data-id="heading-240">ä½ ç°åœ¨æ‰§è¡Œ</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šSSH ç™»å½•</strong></p>
<pre><code class="hljs language-bash" lang="bash">ssh root@122.9.157.124
</code></pre>
<p><strong>èƒ½ç™»å½•å—ï¼Ÿç™»å½•åæ‰§è¡Œï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">ps aux | grep frp
<span class="hljs-built_in">cat</span> /root/frps.toml 2&gt;/dev/null || <span class="hljs-built_in">cat</span> /etc/frp/frps.toml 2&gt;/dev/null
</code></pre>
<p><strong>æŠŠç»“æœç»™æˆ‘ï¼</strong> ğŸ”§
User: ä¸è¡Œè¦å¯†ç  ä¸çŸ¥é“ é‚£æ€ä¹ˆåŠ
Kimi: æ˜ç™½äº†ï¼æ²¡æœ‰äº‘æœåŠ¡å™¨å¯†ç ï¼Œæ— æ³•å¯åŠ¨ FRP æœåŠ¡ç«¯ã€‚</p>
<hr/>
<h3 data-id="heading-241">æ›¿ä»£æ–¹æ¡ˆï¼šä¸ç”¨ FRPï¼Œç›´æ¥ç”¨ ngrokï¼ˆå…è´¹ï¼‰</h3>
<p>ä¹‹å‰ä½ è£…è¿‡ ngrokï¼Œç”¨è¿™ä¸ªæœ€ç®€å•ï¼</p>
<h4 data-id="heading-242">æ­¥éª¤ 1ï¼šå¯åŠ¨ ngrok</h4>
<pre><code class="hljs language-bash" lang="bash">ngrok http 18789
</code></pre>
<h4 data-id="heading-243">æ­¥éª¤ 2ï¼šè·å–å…¬ç½‘ URL</h4>
<p>ä¼šæ˜¾ç¤ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Forwarding  https://abc123-def456.ngrok-free.app -&gt; http://localhost:18789
</code></pre>
<h4 data-id="heading-244">æ­¥éª¤ 3ï¼šä¼ä¸šå¾®ä¿¡åå°å¡«å†™</h4>





















<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://abc123-def456.ngrok-free.app/wecom</code></td></tr><tr><td><strong>Token</strong></td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-245">æˆ–è€…ï¼šå°è¯•æ‰¾å›æœåŠ¡å™¨å¯†ç </h3>
<p>è”ç³»æœåŠ¡å™¨æä¾›å•†ï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘/å…¶ä»–ï¼‰ï¼š</p>
<ul>
<li>æ§åˆ¶å°é‡ç½®å¯†ç </li>
<li>æˆ–è€…æŸ¥çœ‹è´­ä¹°æ—¶çš„é‚®ä»¶</li>
</ul>
<hr/>
<h3 data-id="heading-246">æ¨èï¼šå…ˆç”¨ ngrok æµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ç¡®ä¿ OpenClaw è¿è¡Œ</span>
openclaw gateway status

<span class="hljs-comment"># 2. å¯åŠ¨ ngrok</span>
ngrok http 18789

<span class="hljs-comment"># 3. å¤åˆ¶ https åœ°å€ï¼Œå¡«åˆ°ä¼ä¸šå¾®ä¿¡åå°</span>
</code></pre>
<p><strong>ngrok å¯åŠ¨åæŠŠ URL ç»™æˆ‘ï¼</strong> ğŸš€
User: ngrokæ€ä¹ˆå¼„æ¥çš„
Kimi: ä¹‹å‰ä½ è£…è¿‡ ngrokï¼Œç”¨ Homebrew å®‰è£…çš„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦å·²å®‰è£…</span>
<span class="hljs-built_in">which</span> ngrok

<span class="hljs-comment"># æˆ–</span>
ngrok --version
</code></pre>
<hr/>
<h3 data-id="heading-247">å¦‚æœå·²å®‰è£…ï¼Œç›´æ¥å¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash">ngrok http 18789
</code></pre>
<hr/>
<h3 data-id="heading-248">å¦‚æœæç¤ºæœªå®‰è£…ï¼Œé‡æ–°è£…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”¨ Homebrew å®‰è£…</span>
brew install ngrok

<span class="hljs-comment"># é…ç½® tokenï¼ˆä¹‹å‰æ³¨å†Œè¿‡ï¼‰</span>
ngrok config add-authtoken ä½ çš„_token
</code></pre>
<hr/>
<h3 data-id="heading-249">å¦‚æœå¿˜è®° token</h3>
<ol>
<li>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fdashboard.ngrok.com" target="_blank" title="https://dashboard.ngrok.com" ref="nofollow noopener noreferrer">dashboard.ngrok.com</a></li>
<li>ç”¨ GitHub/Google/é‚®ç®±ç™»å½•</li>
<li>å¤åˆ¶ Authtoken</li>
</ol>
<hr/>
<h3 data-id="heading-250">ä½ ç°åœ¨æ‰§è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…ˆæ£€æŸ¥</span>
ngrok --version

<span class="hljs-comment"># å¦‚æœæ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œç›´æ¥å¯åŠ¨</span>
ngrok http 18789
</code></pre>
<p><strong>æ‰§è¡ŒåæŠŠæ˜¾ç¤ºçš„ Forwarding URL ç»™æˆ‘ï¼</strong> ğŸš€
User: ao frp_0.67.0_darwin_amd64 % brew install ngrok</p>
<p>zsh: command not found: brew çœŸæœäº†ä»–è¿™macç”µè„‘
Kimi: æ˜ç™½äº†ï¼è¿™å° Mac æ²¡æœ‰ Homebrewï¼Œé‚£æˆ‘ä»¬ç”¨å…¶ä»–æ–¹å¼å®‰è£… ngrokã€‚</p>
<hr/>
<h3 data-id="heading-251">æ–¹æ¡ˆ 1ï¼šç›´æ¥ä¸‹è½½ ngrok</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½ ngrokï¼ˆMac Intel ç‰ˆæœ¬ï¼‰</span>
curl -O https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-darwin-amd64.zip

<span class="hljs-comment"># è§£å‹</span>
unzip ngrok-v3-stable-darwin-amd64.zip

<span class="hljs-comment"># ç§»åŠ¨åˆ°å¯æ‰§è¡Œç›®å½•</span>
<span class="hljs-built_in">mv</span> ngrok /usr/local/bin/
</code></pre>
<hr/>
<h3 data-id="heading-252">æ–¹æ¡ˆ 2ï¼šå¦‚æœ curl ä¸‹è½½æ…¢ï¼Œç”¨æµè§ˆå™¨ä¸‹è½½</h3>
<ol>
<li>æ‰“å¼€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fngrok.com%2Fdownload" target="_blank" title="https://ngrok.com/download" ref="nofollow noopener noreferrer">ngrok.com/download</a></li>
<li>ä¸‹è½½ <strong>Mac OS (Intel)</strong> ç‰ˆæœ¬</li>
<li>è§£å‹åå¾—åˆ° <code>ngrok</code> æ–‡ä»¶</li>
<li>åœ¨ç»ˆç«¯æ‰§è¡Œï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥ä¸‹è½½ç›®å½•</span>
<span class="hljs-built_in">cd</span> ~/Downloads

<span class="hljs-comment"># èµ‹äºˆæ‰§è¡Œæƒé™</span>
<span class="hljs-built_in">chmod</span> +x ngrok

<span class="hljs-comment"># ç§»åŠ¨åˆ°ç³»ç»Ÿè·¯å¾„</span>
sudo <span class="hljs-built_in">mv</span> ngrok /usr/local/bin/
</code></pre>
<hr/>
<h3 data-id="heading-253">é…ç½® token</h3>
<p>å» <a href="https://link.juejin.cn?target=https%3A%2F%2Fdashboard.ngrok.com" target="_blank" title="https://dashboard.ngrok.com" ref="nofollow noopener noreferrer">dashboard.ngrok.com</a> è·å–ä½ çš„ Authtokenï¼Œç„¶åï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ngrok config add-authtoken 2KxZä½ çš„tokenè¿™é‡Œ
</code></pre>
<hr/>
<h3 data-id="heading-254">ä½ ç°åœ¨æ‰§è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…ˆè¯•è¯•ç›´æ¥ä¸‹è½½</span>
curl -O https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-darwin-amd64.zip

<span class="hljs-comment"># å¦‚æœä¸‹è½½æˆåŠŸ</span>
unzip ngrok-v3-stable-darwin-amd64.zip
./ngrok --version
</code></pre>
<p><strong>å¦‚æœä¸‹è½½å¤±è´¥ï¼Œå‘Šè¯‰æˆ‘ï¼Œæˆ‘ä»¬ç”¨æµè§ˆå™¨ä¸‹è½½æ–¹å¼ï¼</strong> ğŸ”§
User: ä»–è¿™ä¸ªfrpè¿™ç§æ–¹å¼åœ¨macä¸Šè¿›è¡Œå†…ç½‘ç©¿é€çœŸçš„ä¸è¡Œå˜›
Kimi: ç”¨æˆ·é—® FRP åœ¨ Mac ä¸ŠçœŸçš„ä¸è¡Œå—ï¼Ÿå…¶å®ä¸æ˜¯ä¸è¡Œï¼Œè€Œæ˜¯éœ€è¦ FRP æœåŠ¡å™¨ç«¯ï¼ˆfrpsï¼‰è¿è¡Œåœ¨<strong>æœ‰å…¬ç½‘ IP çš„æœåŠ¡å™¨ä¸Š</strong>ï¼Œè€Œç”¨æˆ·çš„äº‘æœåŠ¡å™¨ï¼ˆ122.9.157.124ï¼‰å·²ç»åœæ­¢æœåŠ¡äº†ï¼Œä¸”æ²¡æœ‰å¯†ç æ— æ³•ç™»å½•ã€‚</p>
<p>è®©æˆ‘æ€»ç»“ä¸€ä¸‹å½“å‰æƒ…å†µå’Œå¯è¡Œæ–¹æ¡ˆã€‚FRP æœ¬èº«å®Œå…¨å¯ä»¥è¿è¡Œåœ¨ Mac ä¸Šï¼Œä½†é—®é¢˜æ˜¯ï¼š</p>
<ol>
<li>FRP éœ€è¦æœåŠ¡ç«¯ï¼ˆfrpsï¼‰åœ¨å…¬ç½‘æœåŠ¡å™¨ä¸Š</li>
<li>ç”¨æˆ·çš„äº‘æœåŠ¡å™¨ 122.9.157.124 å·²ç»åœæ­¢ï¼Œä¸”æ²¡æœ‰ root å¯†ç </li>
<li>ç”¨æˆ·çš„ Mac æ²¡æœ‰å…¬ç½‘ IPï¼ˆè™½ç„¶æœ‰ 122.9.157.124 è¿™ä¸ª IPï¼Œä½† curl æ˜¾ç¤ºæ˜¯"ç«™ç‚¹å·²åœæ­¢"ï¼Œè¯´æ˜è¿™æ˜¯äº‘æœåŠ¡å™¨ä¸æ˜¯ Mac æœ¬åœ°ï¼‰</li>
</ol>
<p>æ‰€ä»¥ FRP æ–¹æ¡ˆç›®å‰ä¸å¯è¡Œï¼Œå› ä¸ºæ²¡æœ‰å¯ç”¨çš„å…¬ç½‘æœåŠ¡å™¨æ¥è·‘ frpsã€‚</p>
<p>æˆ‘åº”è¯¥ï¼š</p>
<ol>
<li>è§£é‡Šæ¸…æ¥šä¸ºä»€ä¹ˆ FRP ç°åœ¨ä¸è¡Œï¼ˆç¼ºå°‘ frps æœåŠ¡å™¨ï¼‰</li>
<li>ç¡®è®¤ç”¨æˆ·çš„ Mac ç½‘ç»œç¯å¢ƒï¼ˆåˆ°åº•æœ‰æ²¡æœ‰å…¬ç½‘ IPï¼‰</li>
<li>æä¾›å¯è¡Œçš„æ›¿ä»£æ–¹æ¡ˆï¼ˆngrokã€èŠ±ç”Ÿå£³ã€æˆ–å…¶ä»–å†…ç½‘ç©¿é€ï¼‰</li>
<li>å¦‚æœç”¨æˆ·åšæŒè¦ç”¨ FRPï¼Œéœ€è¦è§£å†³æœåŠ¡å™¨é—®é¢˜ï¼ˆæ‰¾å›å¯†ç ã€æˆ–æ‰¾å…¶ä»–æœ‰å…¬ç½‘ IP çš„æœºå™¨ï¼‰</li>
</ol>
<p>è®©æˆ‘å…ˆç¡®è®¤ç”¨æˆ·çš„ç½‘ç»œç¯å¢ƒã€‚ä¸æ˜¯ä¸è¡Œï¼Œæ˜¯<strong>ç¼ºå°‘ FRP æœåŠ¡å™¨ç«¯ï¼ˆfrpsï¼‰</strong>ï¼</p>
<hr/>
<h3 data-id="heading-255">ä¸ºä»€ä¹ˆ FRP ç°åœ¨ç”¨ä¸äº†ï¼Ÿ</h3>
<pre><code class="hljs language-scss" lang="scss">ä½ çš„ Mac (frpc)  â†’  éœ€è¦è¿æ¥  â†’  äº‘æœåŠ¡å™¨ (frps)  â†’  å…¬ç½‘è®¿é—®
     âœ… è¿è¡Œä¸­              âŒ å·²åœæ­¢                âŒ æ— æ³•è®¿é—®
</code></pre>
<p><strong>FRP éœ€è¦ä¸¤ç«¯ï¼š</strong></p>
<ul>
<li><strong>frpc</strong>ï¼ˆå®¢æˆ·ç«¯ï¼‰âœ… åœ¨ä½ çš„ Mac ä¸Šï¼Œè¿è¡Œæ­£å¸¸</li>
<li><strong>frps</strong>ï¼ˆæœåŠ¡ç«¯ï¼‰âŒ åœ¨ 122.9.157.124 ä¸Šï¼Œ<strong>å·²åœæ­¢ä¸”æ— å¯†ç æ— æ³•å¯åŠ¨</strong></li>
</ul>
<hr/>
<h3 data-id="heading-256">ä½ çš„ Mac ç½‘ç»œç¯å¢ƒç¡®è®¤</h3>
<p>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œçœ‹çœ‹ä½ çš„ Mac åˆ°åº•æ˜¯ä»€ä¹ˆç½‘ç»œï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å…¬ç½‘ IP</span>
curl ip.sb

<span class="hljs-comment"># æŸ¥çœ‹å†…ç½‘ IP</span>
ifconfig | grep <span class="hljs-string">"inet "</span> | grep -v 127.0.0.1
</code></pre>
<p><strong>ç»“æœä¼šæ˜¯ï¼š</strong></p>

























<table><thead><tr><th>æƒ…å†µ</th><th>è¯´æ˜</th><th>FRP å¯è¡Œæ€§</th></tr></thead><tbody><tr><td>å…¬ç½‘ IP = 122.9.157.124</td><td>ä½ çš„ Mac ç›´æ¥æœ‰å…¬ç½‘</td><td>âœ… ä¸ç”¨ FRPï¼Œç›´æ¥ç»‘å®š</td></tr><tr><td>å…¬ç½‘ IP = å…¶ä»–</td><td>å®½å¸¦æ‹¨å·ï¼Œå¯èƒ½åŠ¨æ€</td><td>âš ï¸ éœ€è¦ DDNS + ç«¯å£æ˜ å°„</td></tr><tr><td>å…¬ç½‘ IP æ˜¾ç¤ºå†…ç½‘æ®µ</td><td>è¿è¥å•† NATï¼Œæ— å…¬ç½‘</td><td>âŒ å¿…é¡»ç”¨å†…ç½‘ç©¿é€å·¥å…·</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-257">å¯è¡Œæ–¹æ¡ˆå¯¹æ¯”</h3>









































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>éœ€è¦æ¡ä»¶</th><th>éš¾åº¦</th><th>ç¨³å®šæ€§</th></tr></thead><tbody><tr><td><strong>ngrok</strong></td><td>æ³¨å†Œè´¦å·</td><td>â­ ç®€å•</td><td>ä¸´æ—¶/å¼€å‘ç”¨</td></tr><tr><td><strong>èŠ±ç”Ÿå£³/è´é”</strong></td><td>æ³¨å†Œ+å®¢æˆ·ç«¯</td><td>â­ ç®€å•</td><td>è¾ƒå¥½</td></tr><tr><td><strong>Tailscale/ZeroTier</strong></td><td>ä¸¤ç«¯å®‰è£…</td><td>â­â­ ä¸­ç­‰</td><td>å¥½ï¼Œä½†éœ€å®¢æˆ·ç«¯</td></tr><tr><td><strong>æ‰¾å›äº‘æœåŠ¡å™¨å¯†ç </strong></td><td>è”ç³»æœåŠ¡å•†</td><td>â­â­ ä¸­ç­‰</td><td>æœ€å¥½ï¼Œæ¢å¤ FRP</td></tr><tr><td><strong>ä¹°æ–°äº‘æœåŠ¡å™¨</strong></td><td>èŠ±é’±ï¼ˆ50å…ƒ/æœˆï¼‰</td><td>â­â­ ä¸­ç­‰</td><td>æœ€å¥½</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-258">æ¨èï¼šå…ˆç¡®è®¤ç½‘ç»œç¯å¢ƒ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹å…¬ç½‘ IP</span>
curl ip.sb

<span class="hljs-comment"># 2. æŸ¥çœ‹è·¯ç”±å™¨ IPï¼ˆåˆ¤æ–­æ˜¯å¦åœ¨ NAT åï¼‰</span>
curl ip.sb
<span class="hljs-comment"># ç„¶åå¯¹æ¯” ifconfig çœ‹åˆ°çš„ IP</span>
</code></pre>
<p><strong>æŠŠç»“æœç»™æˆ‘ï¼Œæˆ‘å‘Šè¯‰ä½ æœ€ä½³æ–¹æ¡ˆï¼</strong> ğŸ”§</p>
<hr/>
<h3 data-id="heading-259">å¦‚æœç€æ€¥æµ‹è¯•</h3>
<p>å…ˆç”¨ <strong>ngrok</strong>ï¼ˆæ— éœ€æœåŠ¡å™¨ï¼Œ5åˆ†é’Ÿæå®šï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½ ngrokï¼ˆæµè§ˆå™¨è®¿é—® https://ngrok.com/downloadï¼‰</span>
<span class="hljs-comment"># è§£å‹åæ‰§è¡Œ</span>
./ngrok http 18789
</code></pre>
<p><strong>ä½ ç°åœ¨æ‰§è¡Œ <code>curl ip.sb</code>ï¼Œçœ‹çœ‹è¿”å›ä»€ä¹ˆ IPï¼Ÿ</strong>
User: curl ip.sb</p>
<p>240e:330:54d1:2000:cc28:773b:75f:89f
dengxiaochao@dengxiaochao Downloads % ifconfig | grep "inet " | grep -v 127.0.0.1</p>
<pre><code class="hljs">inet 192.168.1.7 netmask 0xffffff00 broadcast 192.168.1.255
</code></pre>
<p>Kimi: æ˜ç™½äº†ï¼ä½ çš„ç½‘ç»œæƒ…å†µï¼š</p>
<ul>
<li><strong>å…¬ç½‘ IP</strong>ï¼š<code>240e:330:54d1:2000:cc28:773b:75f:89f</code>ï¼ˆIPv6ï¼‰</li>
<li><strong>å†…ç½‘ IP</strong>ï¼š<code>192.168.1.7</code>ï¼ˆIPv4ï¼‰</li>
</ul>
<p><strong>è¿™æ˜¯å…¸å‹çš„å®¶åº­å®½å¸¦ï¼šæœ‰ IPv6 å…¬ç½‘ï¼Œä½† IPv4 åœ¨ NAT å</strong></p>
<hr/>
<h3 data-id="heading-260">ä¸ºä»€ä¹ˆ FRP ä¸è¡Œï¼Ÿ</h3>





















<table><thead><tr><th>é—®é¢˜</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>IPv6 å…¬ç½‘</strong></td><td>ä¼ä¸šå¾®ä¿¡ä¸æ”¯æŒ IPv6 ç›´æ¥è®¿é—®</td></tr><tr><td><strong>IPv4 æ— å…¬ç½‘</strong></td><td><code>192.168.1.7</code> æ˜¯å†…ç½‘ï¼Œéœ€è¦ç«¯å£æ˜ å°„</td></tr><tr><td><strong>è·¯ç”±å™¨ NAT</strong></td><td>è¿è¥å•†å¯èƒ½åšäº†å¤šå±‚ NATï¼Œç«¯å£æ˜ å°„ä¹Ÿå¯èƒ½å¤±è´¥</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-261">å¯è¡Œæ–¹æ¡ˆ</h3>
<h4 data-id="heading-262">æ–¹æ¡ˆ 1ï¼šç”¨ IPv6ï¼ˆå°è¯•ï¼‰</h4>
<p>å¦‚æœä¼ä¸šå¾®ä¿¡æ”¯æŒ IPv6ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯• IPv6 è®¿é—®</span>
curl http://[240e:330:54d1:2000:cc28:773b:75f:89f]:18789/wecom
</code></pre>
<p><strong>ä½†ä¼ä¸šå¾®ä¿¡åå°å¯èƒ½ä¸æ”¯æŒ IPv6 åœ°å€æ ¼å¼</strong>ï¼Œå¤§æ¦‚ç‡ä¸è¡Œã€‚</p>
<hr/>
<h4 data-id="heading-263">æ–¹æ¡ˆ 2ï¼šè·¯ç”±å™¨ç«¯å£æ˜ å°„ï¼ˆå°è¯•ï¼‰</h4>
<p>åœ¨ä½ çš„è·¯ç”±å™¨åå°ï¼š</p>
<ol>
<li>æ‰¾åˆ° <strong>ç«¯å£æ˜ å°„/è™šæ‹ŸæœåŠ¡å™¨</strong></li>
<li>æ·»åŠ è§„åˆ™ï¼š
<ul>
<li>å¤–éƒ¨ç«¯å£ï¼š<code>18789</code></li>
<li>å†…éƒ¨ IPï¼š<code>192.168.1.7</code></li>
<li>å†…éƒ¨ç«¯å£ï¼š<code>18789</code></li>
</ul>
</li>
</ol>
<p>ç„¶åæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">curl http://ä½ çš„IPv4å…¬ç½‘IP:18789/wecom
</code></pre>
<p><strong>ä½†ä½ çš„ IPv4 å…¬ç½‘ IP å¯èƒ½ä¸å­˜åœ¨ï¼ˆè¿è¥å•† NATï¼‰</strong></p>
<hr/>
<h4 data-id="heading-264">æ–¹æ¡ˆ 3ï¼šngrokï¼ˆæ¨èï¼Œ100% å¯è¡Œï¼‰</h4>
<p>ä¸éœ€è¦å…¬ç½‘ IPï¼Œç›´æ¥ç©¿é€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½ ngrok</span>
curl -O https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-darwin-amd64.zip
unzip ngrok-v3-stable-darwin-amd64.zip

<span class="hljs-comment"># è¿è¡Œï¼ˆä¸éœ€è¦ token ä¹Ÿèƒ½ä¸´æ—¶ç”¨ï¼‰</span>
./ngrok http 18789
</code></pre>
<p><strong>æˆ–è€…æµè§ˆå™¨ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fngrok.com%2Fdownload" target="_blank" title="https://ngrok.com/download" ref="nofollow noopener noreferrer">ngrok.com/download</a></strong></p>
<hr/>
<h4 data-id="heading-265">æ–¹æ¡ˆ 4ï¼šèŠ±ç”Ÿå£³ï¼ˆå›½å†…ç¨³å®šï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½èŠ±ç”Ÿå£³å®¢æˆ·ç«¯</span>
<span class="hljs-comment"># https://hsk.oray.com/download</span>

<span class="hljs-comment"># å®‰è£…åé…ç½®æ˜ å°„</span>
</code></pre>
<hr/>
<h3 data-id="heading-266">ä½ ç°åœ¨é€‰å“ªä¸ªï¼Ÿ</h3>

























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>éš¾åº¦</th><th>æˆåŠŸç‡</th></tr></thead><tbody><tr><td>è·¯ç”±å™¨ç«¯å£æ˜ å°„</td><td>ä¸­</td><td>50%ï¼ˆå¯èƒ½è¿è¥å•† NATï¼‰</td></tr><tr><td><strong>ngrok</strong></td><td><strong>ä½</strong></td><td><strong>100%</strong></td></tr><tr><td>èŠ±ç”Ÿå£³</td><td>ä½</td><td>95%</td></tr></tbody></table>
<p><strong>æ¨èå…ˆç”¨ ngrokï¼Œ5 åˆ†é’Ÿæå®šï¼</strong></p>
<hr/>
<h3 data-id="heading-267">å¿«é€Ÿå¯åŠ¨ ngrok</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> ~/Downloads/frp_0.67.0_darwin_amd64

<span class="hljs-comment"># ä¸‹è½½ ngrok</span>
curl -O https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-darwin-amd64.zip

<span class="hljs-comment"># è§£å‹</span>
unzip ngrok-v3-stable-darwin-amd64.zip

<span class="hljs-comment"># è¿è¡Œ</span>
./ngrok http 18789
</code></pre>
<p><strong>æ‰§è¡ŒåæŠŠæ˜¾ç¤ºçš„ https åœ°å€ç»™æˆ‘ï¼</strong> ğŸš€
User: curl <a href="https://link.juejin.cn?target=http%3A%2F%2F192.168.1.7%3A18789" target="_blank" title="http://192.168.1.7:18789" ref="nofollow noopener noreferrer">http://192.168.1.7:18789</a>  è®¿é—®è¿™ä¸ªå¯ä»¥ è®¿é—®<a href="https://link.juejin.cn?target=https%3A%2F%2Fbot.shuqi.run%2Fwebhooks%2Fwecom" target="_blank" title="https://bot.shuqi.run/webhooks/wecom" ref="nofollow noopener noreferrer">bot.shuqi.run/webhooks/weâ€¦</a> è¿™ä¸ªä¹Ÿè¡Œï¼Œä½†æ˜¯è®¿é—® curl <a href="https://link.juejin.cn?target=http%3A%2F%2F192.168.1.7%3A18789%2Fwecom%25E5%25B0%25B1%25E4%25B8%258D%25E8%25A1%258C%25E4%25BA%2586" target="_blank" title="http://192.168.1.7:18789/wecom%E5%B0%B1%E4%B8%8D%E8%A1%8C%E4%BA%86" ref="nofollow noopener noreferrer">http://192.168.1.7:18789/wecomå°±ä¸è¡Œäº†</a>
Kimi: å¤ªå¥½äº†ï¼æœ‰è¿›å±•ï¼ğŸ‰</p>
<hr/>
<h3 data-id="heading-268">é—®é¢˜åˆ†æ</h3>

























<table><thead><tr><th>URL</th><th>ç»“æœ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>http://192.168.1.7:18789</code></td><td>âœ… å¯ä»¥</td><td>OpenClaw æ ¹è·¯å¾„æ­£å¸¸</td></tr><tr><td><code>https://bot.shuqi.run/webhooks/wecom</code></td><td>âœ… å¯ä»¥</td><td>FRP + nginx è½¬å‘æ­£å¸¸</td></tr><tr><td><code>http://192.168.1.7:18789/wecom</code></td><td>âŒ ä¸è¡Œ</td><td>wecom æ’ä»¶è·¯å¾„æœ‰é—®é¢˜</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°ï¼š<code>/webhooks/wecom</code> å¯ä»¥ï¼Œ<code>/wecom</code> ä¸è¡Œï¼</strong></p>
<hr/>
<h3 data-id="heading-269">åŸå› </h3>
<p><strong>æ’ä»¶çš„ webhookPath é…ç½®æ˜¯ <code>/webhooks/wecom</code>ï¼Œä¸æ˜¯ <code>/wecom</code>ï¼</strong></p>
<p>ä¹‹å‰æˆ‘ä»¬é…ç½®çš„æ˜¯ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"webhookPath"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/wecom"</span>
</code></pre>
<p>ä½†å®é™…åº”è¯¥æ˜¯ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"webhookPath"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/webhooks/wecom"</span>
</code></pre>
<hr/>
<h3 data-id="heading-270">ä¿®å¤é…ç½®</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/webhooks/wecom","token":"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD","encodingAESKey":"ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL","receiveId":"","dm":{"policy":"pairing"}}'</span> --json

openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-271">ç„¶åæµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœ¬åœ°æµ‹è¯•</span>
curl http://192.168.1.7:18789/webhooks/wecom

<span class="hljs-comment"># å¤–ç½‘æµ‹è¯•ï¼ˆFRPï¼‰</span>
curl https://bot.shuqi.run/webhooks/wecom
</code></pre>
<hr/>
<h3 data-id="heading-272">ä¼ä¸šå¾®ä¿¡åå°å¡«å†™</h3>





















<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://bot.shuqi.run/webhooks/wecom</code></td></tr><tr><td><strong>Token</strong></td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td></tr></tbody></table>
<p><strong>æ‰§è¡Œä¿®å¤å‘½ä»¤åæµ‹è¯•ï¼</strong> ğŸš€
User: å¾ˆå¥‡æ€ªï¼ŒæŒ‰ä½ çš„æ“ä½œåcurl <a href="https://link.juejin.cn?target=http%3A%2F%2F192.168.1.7%3A18789%2Fwebhooks%2Fwecom" target="_blank" title="http://192.168.1.7:18789/webhooks/wecom" ref="nofollow noopener noreferrer">http://192.168.1.7:18789/webhooks/wecom</a> ä¸è¡Œï¼Œå˜æˆäº†curl <a href="https://link.juejin.cn?target=http%3A%2F%2F192.168.1.7%3A18789%2Fwecom" target="_blank" title="http://192.168.1.7:18789/wecom" ref="nofollow noopener noreferrer">http://192.168.1.7:18789/wecom</a>  è¿™æ ·å¯è¡Œï¼Œç„¶åä¼ä¸šå¾®ä¿¡åå°é‚£åˆ›å»ºæç¤ºechostræ ¡éªŒå¤±è´¥ï¼Œè¯·æ‚¨æ£€æŸ¥æ˜¯å¦æ­£ç¡®è§£å¯†å¹¶è¾“å‡ºæ˜æ–‡echostr
Kimi: æ˜ç™½äº†ï¼æƒ…å†µåè½¬äº†ï¼š</p>
<ul>
<li><code>/wecom</code> âœ… å¯ä»¥</li>
<li><code>/webhooks/wecom</code> âŒ ä¸è¡Œ</li>
</ul>
<p><strong>è¯´æ˜æ’ä»¶å®é™…æ³¨å†Œçš„è·¯å¾„æ˜¯ <code>/wecom</code>ï¼Œä¸æ˜¯ <code>/webhooks/wecom</code>ï¼</strong></p>
<hr/>
<h3 data-id="heading-273">ä¼ä¸šå¾®ä¿¡æŠ¥é”™åˆ†æ</h3>
<pre><code class="hljs">echostræ ¡éªŒå¤±è´¥ï¼Œè¯·æ‚¨æ£€æŸ¥æ˜¯å¦æ­£ç¡®è§£å¯†å¹¶è¾“å‡ºæ˜æ–‡echostr
</code></pre>
<p><strong>è¿™ä¸æ˜¯ URL é—®é¢˜ï¼Œæ˜¯ Token æˆ– EncodingAESKey ä¸åŒ¹é…ï¼</strong></p>
<p>ä¼ä¸šå¾®ä¿¡å‘é€éªŒè¯è¯·æ±‚æ—¶ï¼ŒOpenClaw æ— æ³•æ­£ç¡®è§£å¯†ï¼Œå¯¼è‡´æ ¡éªŒå¤±è´¥ã€‚</p>
<hr/>
<h3 data-id="heading-274">æ£€æŸ¥æ¸…å•</h3>





























<table><thead><tr><th>æ£€æŸ¥é¡¹</th><th>ä¼ä¸šå¾®ä¿¡åå°</th><th>OpenClaw é…ç½®</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>Token</td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td><td>ç›¸åŒ</td><td>ï¼Ÿ</td></tr><tr><td>EncodingAESKey</td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td><td>ç›¸åŒ</td><td>ï¼Ÿ</td></tr><tr><td>æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼</td><td>å…¼å®¹æ¨¡å¼/æ˜æ–‡æ¨¡å¼</td><td>-</td><td>ï¼Ÿ</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-275">å¯èƒ½åŸå› </h3>
<ol>
<li><strong>Key å¤åˆ¶æœ‰è¯¯</strong>ï¼ˆå¤šäº†ç©ºæ ¼æˆ–å­—ç¬¦ï¼‰</li>
<li><strong>ä¼ä¸šå¾®ä¿¡åå°é‡æ–°ç”Ÿæˆäº† Key</strong>ï¼Œä½†æ²¡æ›´æ–°åˆ° OpenClaw</li>
<li><strong>æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼</strong> é€‰é”™äº†ï¼ˆåº”è¯¥é€‰"å…¼å®¹æ¨¡å¼"æˆ–"æ˜æ–‡æ¨¡å¼"ï¼‰</li>
</ol>
<hr/>
<h3 data-id="heading-276">ä½ ç°åœ¨æ£€æŸ¥</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šç¡®è®¤ä¼ä¸šå¾®ä¿¡åå°çš„ Token å’Œ Key</strong></p>
<p>å» <a href="https://link.juejin.cn?target=https%3A%2F%2Fwork.weixin.qq.com%2Fwework_admin" target="_blank" title="https://work.weixin.qq.com/wework_admin" ref="nofollow noopener noreferrer">work.weixin.qq.com/wework_admiâ€¦</a> æŸ¥çœ‹ï¼š</p>
<ul>
<li>åº”ç”¨ç®¡ç† â†’ ä½ çš„åº”ç”¨ â†’ æ¥æ”¶æ¶ˆæ¯</li>
<li><strong>Token</strong> æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li><strong>EncodingAESKey</strong> æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<p><strong>ç¬¬äºŒæ­¥ï¼šå¯¹æ¯” OpenClaw é…ç½®</strong></p>
<pre><code class="hljs language-bash" lang="bash">openclaw config get channels.wecom
</code></pre>
<p><strong>æŠŠä¸¤è¾¹çš„ Token å’Œ Key éƒ½è´´ç»™æˆ‘ï¼Œæˆ‘å¸®ä½ å¯¹æ¯”ï¼</strong> ğŸ”§</p>
<hr/>
<h3 data-id="heading-277">ä¸´æ—¶è§£å†³æ–¹æ¡ˆ</h3>
<p>å¦‚æœç€æ€¥æµ‹è¯•ï¼Œå…ˆæ”¹æˆ<strong>æ˜æ–‡æ¨¡å¼</strong>ï¼ˆä¸åŠ å¯†ï¼Œç»•è¿‡æ ¡éªŒï¼‰ï¼š</p>
<ol>
<li>ä¼ä¸šå¾®ä¿¡åå° â†’ æ¥æ”¶æ¶ˆæ¯ â†’ <strong>æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼</strong> â†’ é€‰ <strong>"æ˜æ–‡æ¨¡å¼"</strong></li>
<li>ä¿å­˜</li>
</ol>
<p>è¿™æ ·ä¸éœ€è¦ EncodingAESKey ä¹Ÿèƒ½é€šè¿‡éªŒè¯ã€‚</p>
<p><strong>å…ˆå‘Šè¯‰æˆ‘ä¸¤è¾¹çš„ Token/Key æ˜¯å¦ä¸€è‡´ï¼</strong>
User: {
"enabled": true,
"webhookPath": "/webhooks/wecom",
"token": "fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD",
"encodingAESKey": "ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL",
"receiveId": "",
"dm": {
"policy": "pairing"
}
}   åå° fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD ï¼ŒykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL
Kimi: å‘ç°äº†ï¼<strong>OpenClaw é…ç½®è¿˜æ˜¯ <code>/webhooks/wecom</code>ï¼Œä½†ä½ æµ‹è¯•è¯´ <code>/wecom</code> æ‰è¡Œï¼</strong></p>
<hr/>
<h3 data-id="heading-278">é—®é¢˜ç¡®è®¤</h3>

















<table><thead><tr><th>é¡¹ç›®</th><th>å€¼</th></tr></thead><tbody><tr><td>OpenClaw é…ç½®</td><td><code>webhookPath: "/webhooks/wecom"</code></td></tr><tr><td>å®é™…èƒ½è®¿é—®çš„è·¯å¾„</td><td><code>/wecom</code></td></tr></tbody></table>
<p><strong>é…ç½®å’Œå®é™…ä¸åŒ¹é…ï¼</strong></p>
<hr/>
<h3 data-id="heading-279">ä¿®å¤ï¼šæ”¹å› <code>/wecom</code></h3>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{"enabled":true,"webhookPath":"/wecom","token":"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD","encodingAESKey":"ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL","receiveId":"","dm":{"policy":"pairing"}}'</span> --json

openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-280">ç„¶åéªŒè¯</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœ¬åœ°æµ‹è¯•</span>
curl http://192.168.1.7:18789/wecom

<span class="hljs-comment"># å¤–ç½‘æµ‹è¯•</span>
curl https://bot.shuqi.run/wecom
</code></pre>
<hr/>
<h3 data-id="heading-281">ä¼ä¸šå¾®ä¿¡åå°</h3>

























<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://bot.shuqi.run/wecom</code></td></tr><tr><td><strong>Token</strong></td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td></tr><tr><td><strong>æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼</strong></td><td>å»ºè®®é€‰**"æ˜æ–‡æ¨¡å¼"** å…ˆæµ‹è¯•</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-282">å¦‚æœè¿˜æ˜¯ echostr æ ¡éªŒå¤±è´¥</h3>
<p>é€‰ <strong>æ˜æ–‡æ¨¡å¼</strong> ç»•è¿‡åŠ å¯†æ ¡éªŒï¼š</p>
<ol>
<li>ä¼ä¸šå¾®ä¿¡åå° â†’ æ¥æ”¶æ¶ˆæ¯</li>
<li><strong>æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼</strong> â†’ é€‰ <strong>"æ˜æ–‡æ¨¡å¼"</strong></li>
<li>ä¿å­˜</li>
</ol>
<p>è¿™æ ·ä¸éœ€è¦ EncodingAESKey ä¹Ÿèƒ½é€šè¿‡ã€‚</p>
<p><strong>æ‰§è¡Œä¿®å¤å‘½ä»¤åæµ‹è¯•ï¼</strong> ğŸš€
User: ç„¶ååœ¨ OpenClaw é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p>
<p>{
"plugins": {
"entries": {
"wecom": { "enabled": true }
}
},
"channels": {
"wecom": {
"enabled": true,
"token": "ä½ çš„ Token",
"encodingAesKey": "ä½ çš„ EncodingAESKey"
}
}
}  æˆ‘è§‰å¾—æœ‰å¯èƒ½æ˜¯ä½ ç›´æ¥è¿™æ ·ç”¨å‘½ä»¤è¿™æ ·è®¾ç½®ä¸è¡Œä¸ç¬¦åˆä»–çš„æ ¼å¼ï¼Œä¸Šé¢æ˜¯GitHubçš„æ’ä»¶å®˜æ–¹çš„
Kimi: ç”¨æˆ·å‘ç°é—®é¢˜äº†ï¼GitHub å®˜æ–¹æ–‡æ¡£çš„é…ç½®æ ¼å¼å’Œæˆ‘ä»¬ç”¨çš„å‘½ä»¤è¡Œè®¾ç½®ä¸ä¸€æ ·ã€‚</p>
<p>å®˜æ–¹æ–‡æ¡£çš„é…ç½®ç»“æ„æ˜¯ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"plugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"entries"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span> <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"encodingAesKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxx"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è€Œæˆ‘ä»¬ä¹‹å‰ç”¨çš„æ˜¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> channels.wecom <span class="hljs-string">'{...}'</span>
</code></pre>
<p>è¿™å¯èƒ½åªæ˜¯è®¾ç½®äº† <code>channels.wecom</code>ï¼Œä½†æ²¡æœ‰è®¾ç½® <code>plugins.entries.wecom</code>ã€‚</p>
<p>è€Œä¸”æ³¨æ„å®˜æ–¹ç”¨çš„æ˜¯ <code>encodingAesKey</code>ï¼ˆé©¼å³°å‘½åï¼‰ï¼Œè€Œæˆ‘ä»¬ç”¨çš„æ˜¯ <code>encodingAESKey</code>ï¼ˆå…¨å¤§å†™ï¼‰ã€‚</p>
<p>è®©æˆ‘è®©ç”¨æˆ·ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ŒæŒ‰ç…§å®˜æ–¹æ ¼å¼æ¥ã€‚ä½ è¯´å¾—å¯¹ï¼<strong>é…ç½®ç»“æ„å¯èƒ½ä¸å®Œæ•´</strong>ï¼</p>
<p>å®˜æ–¹æ–‡æ¡£éœ€è¦ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li><code>plugins.entries.wecom</code> - å¯ç”¨æ’ä»¶</li>
<li><code>channels.wecom</code> - é€šé“é…ç½®</li>
</ol>
<p>è€Œä¸”æ³¨æ„ï¼š<strong><code>encodingAesKey</code></strong>ï¼ˆé©¼å³°ï¼‰vs <strong><code>encodingAESKey</code></strong>ï¼ˆæˆ‘ä»¬ç”¨çš„ï¼‰</p>
<hr/>
<h3 data-id="heading-283">ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆæ¨èï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰“å¼€é…ç½®æ–‡ä»¶</span>
nano ~/.openclaw/openclaw.json
</code></pre>
<p><strong>æ”¹æˆè¿™æ ·ï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"plugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"entries"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"encodingAesKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li><code>encodingAesKey</code> ä¸æ˜¯ <code>encodingAESKey</code>ï¼ˆå¤§å°å†™ä¸åŒï¼ï¼‰</li>
<li>ä¸éœ€è¦ <code>webhookPath</code>ï¼Œç”¨é»˜è®¤çš„ <code>/wecom</code></li>
</ul>
<hr/>
<h3 data-id="heading-284">ç„¶åé‡å¯</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-285">éªŒè¯</h3>
<pre><code class="hljs language-bash" lang="bash">curl http://192.168.1.7:18789/wecom
</code></pre>
<hr/>
<h3 data-id="heading-286">ä¼ä¸šå¾®ä¿¡åå°</h3>





















<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://bot.shuqi.run/wecom</code></td></tr><tr><td><strong>Token</strong></td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>ykBavPwByUVHYjf9hPYrE3lBzE257ziz3ziS57cJGLL</code></td></tr></tbody></table>
<p><strong>ä¿®æ”¹é…ç½®æ–‡ä»¶åæµ‹è¯•ï¼</strong> ğŸš€
User: æå®šäº†ï¼Œæ€»ç»“ä¸€ä¸‹ç»éªŒå§
Kimi: å¤ªå¥½äº†ï¼ğŸ‰ æ­å–œæå®šï¼æ€»ç»“ä¸€ä¸‹å®Œæ•´ç»éªŒï¼š</p>
<hr/>
<h3 data-id="heading-287">âœ… æœ€ç»ˆæˆåŠŸé…ç½®</h3>
<h4 data-id="heading-288">1. OpenClaw é…ç½®æ–‡ä»¶ <code>~/.openclaw/openclaw.json</code></h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"plugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"entries"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"encodingAesKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ykBavPwByUVHYjf9hPYrE3lELURprMUmaVpAx7OlOOO"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><code>plugins.entries.wecom</code> å¿…é¡»å¯ç”¨</li>
<li><code>encodingAesKey</code> æ˜¯é©¼å³°å‘½åï¼ˆä¸æ˜¯ <code>encodingAESKey</code>ï¼‰</li>
<li>ä¸éœ€è¦ <code>webhookPath</code>ï¼Œé»˜è®¤ <code>/wecom</code></li>
</ul>
<hr/>
<h4 data-id="heading-289">2. OpenClaw ç½‘å…³ç»‘å®š</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç»‘å®šå±€åŸŸç½‘ï¼ˆè®© FRP èƒ½è®¿é—®ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"lan"</span>
openclaw config <span class="hljs-built_in">set</span> gateway.port 18789
openclaw gateway restart
</code></pre>
<hr/>
<h4 data-id="heading-290">3. FRP å®¢æˆ·ç«¯é…ç½® <code>frpc.toml</code></h4>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">serverAddr</span> = <span class="hljs-string">"122.9.157.124"</span>
<span class="hljs-attr">serverPort</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">auth.method</span> = <span class="hljs-string">"token"</span>
<span class="hljs-attr">auth.token</span> = <span class="hljs-string">"ä½ çš„token"</span>

<span class="hljs-section">[[proxies]]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"bot"</span>
<span class="hljs-attr">type</span> = <span class="hljs-string">"tcp"</span>
<span class="hljs-attr">localIP</span> = <span class="hljs-string">"127.0.0.1"</span>
<span class="hljs-attr">localPort</span> = <span class="hljs-number">18789</span>
<span class="hljs-attr">remotePort</span> = <span class="hljs-number">10981</span>
</code></pre>
<hr/>
<h4 data-id="heading-291">4. ä¼ä¸šå¾®ä¿¡åå°</h4>

































<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>URL</strong></td><td><code>https://bot.shuqi.run/wecom</code></td></tr><tr><td><strong>Token</strong></td><td><code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></td></tr><tr><td><strong>EncodingAESKey</strong></td><td><code>ykBavPwByUVHYjf9hPYrE3lELURprMUmaVpAx7OlOOO</code></td></tr><tr><td><strong>æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼</strong></td><td>å…¼å®¹æ¨¡å¼æˆ–</td></tr><tr><td>User: æˆ‘ä»¬å¯¹è¯äº†è¿™ä¹ˆå¤šæˆ‘ç»å†è¿™ä¹ˆä¹…ï¼ŒæŠŠè¿™ä¸ªï¼Œå†™æˆæŒ‡å—å§ï¼Œæˆ‘å‡†å¤‡å‘åˆ°ç½‘ä¸Šï¼Œå‘Šè¯‰åæ¥è€…ï¼Œé¿å‘è¿™äº›ï¼Œæ€ä¹ˆç”¨frpå†…ç½‘ç©¿é€šå·¥å…·æ‰“é€šå®ç°ä¼ä¸šå¾®ä¿¡æœºå™¨äººæˆåŠŸä¸Šçº¿</td><td/></tr><tr><td>Kimi: å¥½çš„ï¼æˆ‘æ¥å¸®ä½ æ•´ç†æˆä¸€ä»½<strong>å®Œæ•´é¿å‘æŒ‡å—</strong>ï¼Œæ–¹ä¾¿ä½ å‘åˆ°ç½‘ä¸Šå¸®åŠ©åæ¥è€…ã€‚</td><td/></tr></tbody></table>
<hr/>
<h2 data-id="heading-292">ğŸš€ OpenClaw + FRP ä¼ä¸šå¾®ä¿¡æœºå™¨äººéƒ¨ç½²å®Œå…¨æŒ‡å—</h2>
<blockquote>
<p><strong>ä½œè€…</strong>ï¼šDengxiaochao &amp; AI Assistant
<strong>è€—æ—¶</strong>ï¼šN å°æ—¶è¸©å‘æ€»ç»“
<strong>ç›®æ ‡</strong>ï¼šè®©åæ¥è€… 30 åˆ†é’Ÿæå®šï¼Œä¸å†è¸©å‘</p>
</blockquote>
<hr/>
<h3 data-id="heading-293">ğŸ“‹ å‰ç½®æ¡ä»¶</h3>
<ul>
<li>Mac ç”µè„‘ï¼ˆIntel/Apple Siliconï¼‰</li>
<li>ä¼ä¸šå¾®ä¿¡ç®¡ç†å‘˜æƒé™</li>
<li>ä¸€å°æœ‰å…¬ç½‘ IP çš„æœåŠ¡å™¨ï¼ˆè·‘ FRP æœåŠ¡ç«¯ï¼‰</li>
<li>åŸºç¡€å‘½ä»¤è¡ŒçŸ¥è¯†</li>
</ul>
<hr/>
<h3 data-id="heading-294">ğŸ¯ æœ€ç»ˆæ¶æ„</h3>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ· â†’ ä¼ä¸šå¾®ä¿¡æœåŠ¡å™¨ â†’ FRP æœåŠ¡ç«¯(å…¬ç½‘) â†’ FRP å®¢æˆ·ç«¯(Mac) â†’ OpenClaw
</code></pre>
<hr/>
<h3 data-id="heading-295">ç¬¬ä¸€æ­¥ï¼šå®‰è£… OpenClaw</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…ï¼ˆéœ€ Node.jsï¼‰</span>
npm install -g openclaw

<span class="hljs-comment"># éªŒè¯</span>
openclaw --version
</code></pre>
<hr/>
<h3 data-id="heading-296">ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¼ä¸šå¾®ä¿¡æ’ä»¶</h3>
<pre><code class="hljs language-bash" lang="bash">openclaw plugins install openclaw-plugin-wecom
</code></pre>
<p><strong>éªŒè¯å®‰è£…</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw plugins list
<span class="hljs-comment"># åº”æ˜¾ç¤º openclaw-plugin-wecom</span>
</code></pre>
<hr/>
<h3 data-id="heading-297">ç¬¬ä¸‰æ­¥ï¼šé…ç½® OpenClawï¼ˆæ ¸å¿ƒé¿å‘ï¼ï¼‰</h3>
<p><strong>âš ï¸ å‘ç‚¹ï¼šå¿…é¡»åŒæ—¶é…ç½® <code>plugins.entries</code> å’Œ <code>channels</code></strong></p>
<p>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">nano ~/.openclaw/openclaw.json
</code></pre>
<p><strong>å®Œæ•´é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"plugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"entries"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ çš„Token"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"encodingAesKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ çš„43ä½EncodingAESKey"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ğŸ”¥ é¿å‘è¦ç‚¹</strong>ï¼š</p>





















<table><thead><tr><th>å‘</th><th>æ­£ç¡®åšæ³•</th></tr></thead><tbody><tr><td>âŒ<code>encodingAESKey</code></td><td>âœ…<code>encodingAesKey</code>ï¼ˆé©¼å³°å‘½åï¼ï¼‰</td></tr><tr><td>âŒ åªé… <code>channels</code></td><td>âœ… å¿…é¡»åŒæ—¶é… <code>plugins.entries</code></td></tr><tr><td>âŒ é… <code>webhookPath</code></td><td>âœ… ä¸å†™ï¼Œç”¨é»˜è®¤ <code>/wecom</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-298">ç¬¬å››æ­¥ï¼šé…ç½®ç½‘å…³ç»‘å®š</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç»‘å®šåˆ°å±€åŸŸç½‘ï¼ˆè®© FRP èƒ½è®¿é—®ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"lan"</span>
openclaw config <span class="hljs-built_in">set</span> gateway.port 18789

<span class="hljs-comment"># é‡å¯</span>
openclaw gateway restart

<span class="hljs-comment"># éªŒè¯</span>
openclaw gateway status
<span class="hljs-comment"># åº”æ˜¾ç¤º Listening: *:18789</span>
</code></pre>
<hr/>
<h3 data-id="heading-299">ç¬¬äº”æ­¥ï¼šé…ç½® FRP å†…ç½‘ç©¿é€</h3>
<h4 data-id="heading-300">5.1 æœåŠ¡ç«¯ï¼ˆfrpsï¼‰- å…¬ç½‘æœåŠ¡å™¨</h4>
<p><code>frps.toml</code>ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">bindPort</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">auth.method</span> = <span class="hljs-string">"token"</span>
<span class="hljs-attr">auth.token</span> = <span class="hljs-string">"ä½ çš„å¼ºå¯†ç "</span>
</code></pre>
<p>å¯åŠ¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./frps -c frps.toml
</code></pre>
<h4 data-id="heading-301">5.2 å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰- Mac</h4>
<p><code>frpc.toml</code>ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">serverAddr</span> = <span class="hljs-string">"ä½ çš„å…¬ç½‘IP"</span>
<span class="hljs-attr">serverPort</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">auth.method</span> = <span class="hljs-string">"token"</span>
<span class="hljs-attr">auth.token</span> = <span class="hljs-string">"ä½ çš„å¼ºå¯†ç "</span>

<span class="hljs-section">[[proxies]]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"openclaw-wecom"</span>
<span class="hljs-attr">type</span> = <span class="hljs-string">"tcp"</span>
<span class="hljs-attr">localIP</span> = <span class="hljs-string">"127.0.0.1"</span>
<span class="hljs-attr">localPort</span> = <span class="hljs-number">18789</span>
<span class="hljs-attr">remotePort</span> = <span class="hljs-number">10981</span>
</code></pre>
<p>å¯åŠ¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./frpc -c frpc.toml
</code></pre>
<p><strong>éªŒè¯è¿æ¥</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœåŠ¡ç«¯åº”æ˜¾ç¤º</span>
[xxx] [openclaw-wecom] start proxy success
</code></pre>
<hr/>
<h3 data-id="heading-302">ç¬¬å…­æ­¥ï¼šä¼ä¸šå¾®ä¿¡åå°é…ç½®</h3>
<ol>
<li>ç™»å½• <a href="https://link.juejin.cn?target=https%3A%2F%2Fwork.weixin.qq.com%2Fwework_admin" target="_blank" title="https://work.weixin.qq.com/wework_admin" ref="nofollow noopener noreferrer">work.weixin.qq.com/wework_admiâ€¦</a></li>
<li>åº”ç”¨ç®¡ç† â†’ è‡ªå»ºåº”ç”¨ â†’ æ¥æ”¶æ¶ˆæ¯</li>
<li>å¡«å†™ï¼š</li>
</ol>

























<table><thead><tr><th>å­—æ®µ</th><th>å€¼</th></tr></thead><tbody><tr><td>URL</td><td><code>http://ä½ çš„å…¬ç½‘IP:10981/wecom</code></td></tr><tr><td>Token</td><td>å’Œ OpenClaw é…ç½®ä¸€è‡´</td></tr><tr><td>User: ç»§ç»­ï¼Œèƒ½æŠŠæ•´ä¸ªèŠå¤©è®°å½•å¯¼å‡ºä¸</td><td/></tr><tr><td>Kimi: ç”¨æˆ·æƒ³æŠŠæ•´ä¸ªèŠå¤©è®°å½•å¯¼å‡ºå‘åˆ°ç½‘ä¸Šã€‚æˆ‘éœ€è¦æ€»ç»“æ•´ä¸ªå¯¹è¯è¿‡ç¨‹ï¼Œä½†æˆ‘æ˜¯ AI åŠ©æ‰‹ï¼Œæ— æ³•ç›´æ¥å¯¼å‡ºèŠå¤©è®°å½•æ–‡ä»¶ã€‚</td><td/></tr></tbody></table>
<p>æˆ‘åº”è¯¥ï¼š</p>
<ol>
<li>å‘Šè¯‰ç”¨æˆ·æˆ‘æ— æ³•ç›´æ¥å¯¼å‡ºæ–‡ä»¶</li>
<li>æä¾›å®Œæ•´çš„å¯¹è¯å†…å®¹æ€»ç»“ï¼ˆæŒ‰æ—¶é—´çº¿æ•´ç†ï¼‰</li>
<li>å»ºè®®ç”¨æˆ·å¦‚ä½•å¤åˆ¶ä¿å­˜è¿™äº›å†…å®¹</li>
</ol>
<p>è®©æˆ‘æ•´ç†æ•´ä¸ªå¯¹è¯çš„å…³é”®èŠ‚ç‚¹ï¼š</p>
<ul>
<li>å¼€å§‹ï¼šç”¨æˆ·é—® Clawbot hooks åŠŸèƒ½</li>
<li>ç„¶åï¼šOpenClaw ä¼ä¸šå¾®ä¿¡æ’ä»¶å®‰è£…</li>
<li>é…ç½®é—®é¢˜ï¼šencodingAesKey å¤§å°å†™ã€plugins.entries ç»“æ„</li>
<li>FRP å†…ç½‘ç©¿é€é…ç½®</li>
<li>ç½‘å…³ç»‘å®šé—®é¢˜ï¼ˆlan vs 0.0.0.0 vs loopbackï¼‰</li>
<li>ä¼ä¸šå¾®ä¿¡åå°é…ç½®</li>
<li>æœ€ç»ˆæˆåŠŸ</li>
</ul>
<p>æˆ‘å¯ä»¥æŒ‰æ—¶é—´çº¿æ•´ç†æˆè¯¦ç»†çš„"å¯¹è¯å®å½•"å½¢å¼ã€‚æˆ‘æ— æ³•ç›´æ¥å¯¼å‡ºèŠå¤©è®°å½•æ–‡ä»¶ï¼Œä½†æˆ‘å¯ä»¥å¸®ä½ <strong>æŒ‰æ—¶é—´çº¿æ•´ç†å®Œæ•´çš„å¯¹è¯å®å½•</strong>ï¼Œä½ å¯ä»¥å¤åˆ¶ä¿å­˜ï¼š</p>
<hr/>
<h2 data-id="heading-303">ğŸ“œ OpenClaw + FRP ä¼ä¸šå¾®ä¿¡æœºå™¨äººéƒ¨ç½²å®å½•</h2>
<blockquote>
<p>å®Œæ•´è¸©å‘è¿‡ç¨‹ï¼Œä»å…¥é—¨åˆ°æˆåŠŸ</p>
</blockquote>
<hr/>
<h3 data-id="heading-304">ç¬¬ä¸€ç« ï¼šåˆè¯† Clawbot Hooksï¼ˆ14:00-15:00ï¼‰</h3>
<p><strong>ç”¨æˆ·</strong>ï¼šclawbot è¿™å‡ ä¸ª hook æ˜¯ä»€ä¹ˆåŠŸèƒ½ï¼Ÿ</p>
<p><strong>AI</strong>ï¼šè§£é‡Šäº†å››ä¸ªé’©å­ï¼š</p>
<ul>
<li><code>boot-md</code>ï¼šå¯åŠ¨æ–‡æ¡£åŠ è½½</li>
<li><code>command-logger</code>ï¼šå‘½ä»¤æ—¥å¿—è®°å½•</li>
<li><code>session-memory</code>ï¼šä¼šè¯è®°å¿†ï¼ˆæ¨èå¼€å¯ï¼‰</li>
<li><code>soul-evil</code>ï¼šæ€§æ ¼æ’ä»¶ï¼ˆå‚²å¨‡æ¨¡å¼ï¼‰</li>
</ul>
<p><strong>ç”¨æˆ·</strong>ï¼šæ€ä¹ˆå¯ç”¨è®°å¿†åŠŸèƒ½ï¼Ÿ</p>
<p><strong>AI</strong>ï¼šæ–¹å‘é”®é€‰æ‹© â†’ ç©ºæ ¼å‹¾é€‰ â†’ å›è½¦ç¡®è®¤</p>
<hr/>
<h3 data-id="heading-305">ç¬¬äºŒç« ï¼šä¼ä¸šå¾®ä¿¡æ’ä»¶æ¢ç´¢ï¼ˆ15:00-16:00ï¼‰</h3>
<p><strong>ç”¨æˆ·</strong>ï¼š<code>clawdbot plugins install @mijia-life/clawdbot-wecom</code> æ²¡æ‰¾åˆ°ä»“åº“</p>
<p><strong>AI</strong>ï¼šå‘ç°æ˜¯æ—§ç‰ˆæ’ä»¶åï¼Œæœç´¢åæ¨èï¼š</p>
<ul>
<li>æ–°ç‰ˆ OpenClaw ç”¨ <code>openclaw-plugin-wecom</code></li>
</ul>
<p><strong>å®‰è£…æˆåŠŸ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw plugins install openclaw-plugin-wecom
<span class="hljs-comment"># æ˜¾ç¤ºï¼šWeCom plugin registering... æˆåŠŸ</span>
</code></pre>
<hr/>
<h3 data-id="heading-306">ç¬¬ä¸‰ç« ï¼šFRP å†…ç½‘ç©¿é€é…ç½®ï¼ˆ16:00-17:30ï¼‰</h3>
<p><strong>ç”¨æˆ·</strong>ï¼šMac æ€ä¹ˆé…ç½® FRPï¼Ÿ</p>
<p><strong>å‘ç°ç½‘ç»œç¯å¢ƒ</strong>ï¼š</p>
<ul>
<li>Mac å†…ç½‘ IPï¼š<code>192.168.1.7</code></li>
<li>å…¬ç½‘ IPv6ï¼š<code>240e:330:54d1:2000...</code>ï¼ˆä¼ä¸šå¾®ä¿¡ä¸æ”¯æŒï¼‰</li>
<li>æœ‰å°äº‘æœåŠ¡å™¨ <code>122.9.157.124</code> ä½†å·²åœæ­¢æœåŠ¡</li>
</ul>
<p><strong>FRP é…ç½®ç¡®å®š</strong>ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-comment"># frpc.tomlï¼ˆMac å®¢æˆ·ç«¯ï¼‰</span>
<span class="hljs-attr">serverAddr</span> = <span class="hljs-string">"122.9.157.124"</span>
<span class="hljs-attr">serverPort</span> = <span class="hljs-number">7000</span>
<span class="hljs-attr">auth.method</span> = <span class="hljs-string">"token"</span>
<span class="hljs-attr">auth.token</span> = <span class="hljs-string">"60d8a83c544e6168db"</span>

<span class="hljs-section">[[proxies]]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"bot"</span>
<span class="hljs-attr">type</span> = <span class="hljs-string">"tcp"</span>
<span class="hljs-attr">localIP</span> = <span class="hljs-string">"127.0.0.1"</span>
<span class="hljs-attr">localPort</span> = <span class="hljs-number">18789</span>
<span class="hljs-attr">remotePort</span> = <span class="hljs-number">10981</span>
</code></pre>
<p><strong>å‘ç‚¹</strong>ï¼šå°è¯•æ”¹ <code>type = "http"</code> å¤±è´¥ï¼Œå› ä¸ºæœåŠ¡ç«¯åªæ”¯æŒ TCP</p>
<hr/>
<h3 data-id="heading-307">ç¬¬å››ç« ï¼šç½‘å…³ç»‘å®šå¤§æˆ˜ï¼ˆ17:30-19:00ï¼‰</h3>
<p><strong>è¿ç¯è¸©å‘</strong>ï¼š</p>

























<table><thead><tr><th>å°è¯•</th><th>ç»“æœ</th><th>åŸå› </th></tr></thead><tbody><tr><td><code>0.0.0.0</code></td><td>âŒ Invalid --bind</td><td>ä¸æ”¯æŒ</td></tr><tr><td><code>lan</code></td><td>âœ… Listening: *:18789</td><td>æ­£ç¡®</td></tr><tr><td><code>loopback</code></td><td>âŒ ä»…æœ¬åœ°</td><td>FRP è¿ä¸ä¸Š</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw config <span class="hljs-built_in">set</span> gateway.bind <span class="hljs-string">"lan"</span>
<span class="hljs-comment"># ä¸æ˜¯ "0.0.0.0" ä¹Ÿä¸æ˜¯ "loopback"ï¼</span>
</code></pre>
<p><strong>ä¿®æ”¹ plist æ–‡ä»¶</strong>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>--bind<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>lan<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
</code></pre>
<hr/>
<h3 data-id="heading-308">ç¬¬äº”ç« ï¼šé…ç½®æ ¼å¼æ ¸æˆ˜äº‰ï¼ˆ19:00-20:30ï¼‰</h3>
<p><strong>æœ€å¤§å‘ç‚¹ï¼šencodingAesKey å¤§å°å†™</strong></p>
<pre><code class="hljs">é”™è¯¯ï¼šencodingAESKeyï¼ˆå…¨å¤§å†™ï¼‰
æ­£ç¡®ï¼šencodingAesKeyï¼ˆé©¼å³°ï¼‰
</code></pre>
<p><strong>é…ç½®ç»“æ„ç¼ºå¤±</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šåªé…äº† channels</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>...<span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šå¿…é¡»åŒæ—¶å¯ç”¨ plugins.entries</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"plugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"entries"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>...<span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>webhookPath æ··ä¹±</strong>ï¼š</p>
<ul>
<li>è¯•äº† <code>/wecom</code> â†’ ä¸è¡Œ</li>
<li>è¯•äº† <code>/webhooks/wecom</code> â†’ ä¸è¡Œ</li>
<li>æœ€ç»ˆï¼šä¸å†™ï¼Œç”¨é»˜è®¤ <code>/wecom</code></li>
</ul>
<hr/>
<h3 data-id="heading-309">ç¬¬å…­ç« ï¼šä¼ä¸šå¾®ä¿¡åå°å¯¹å†³ï¼ˆ20:30-21:00ï¼‰</h3>
<p><strong>echostr æ ¡éªŒå¤±è´¥</strong>ï¼š</p>
<ul>
<li>åŸå› ï¼šToken/Key ä¸åŒ¹é…</li>
<li>è§£å†³ï¼šä¸¤è¾¹é‡æ–°å¤åˆ¶ï¼Œç¡®ä¿ä¸€è‡´</li>
</ul>
<p><strong>æœ€ç»ˆæˆåŠŸé…ç½®</strong>ï¼š</p>
<p><strong>OpenClaw</strong> <code>~/.openclaw/openclaw.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"plugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"entries"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"encodingAesKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ykBavPwByUVHYjf9hPYrE3lELURprMUmaVpAx7OlOOO"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ä¼ä¸šå¾®ä¿¡åå°</strong>ï¼š</p>
<ul>
<li>URLï¼š<code>https://bot.shuqi.run/wecom</code></li>
<li>Tokenï¼š<code>fXXt9aFjVNzq51lsPEBJiBRquiNKiyBD</code></li>
<li>EncodingAESKeyï¼š<code>ykBavPwByUVHYjf9hPYrE3lELURprMUmaVpAx7OlOOO</code></li>
</ul>
<hr/>
<h3 data-id="heading-310">ç¬¬ä¸ƒç« ï¼šèƒœåˆ©æ—¶åˆ»ï¼ˆ21:00+ï¼‰</h3>
<p><strong>éªŒè¯å‘½ä»¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœ¬åœ°</span>
curl http://192.168.1.7:18789/wecom

<span class="hljs-comment"># å¤–ç½‘</span>
curl https://bot.shuqi.run/wecom

<span class="hljs-comment"># ä¼ä¸šå¾®ä¿¡ App å‘é€"ä½ å¥½" â†’ æœºå™¨äººå›å¤æˆåŠŸï¼</span>
</code></pre>
<hr/>
<h3 data-id="heading-311">ğŸ’ æ ¸å¿ƒç»éªŒæ€»ç»“</h3>
<h4 data-id="heading-312">å¿…å‘ä¸‰åŸåˆ™</h4>
<ol>
<li><strong>å¤§å°å†™æ•æ„Ÿ</strong>ï¼š<code>encodingAesKey</code> ä¸æ˜¯ <code>encodingAESKey</code></li>
<li><strong>åŒç®¡é½ä¸‹</strong>ï¼šå¿…é¡»åŒæ—¶é… <code>plugins.entries</code> + <code>channels</code></li>
<li><strong>ç»‘å®šç”¨ lan</strong>ï¼šä¸æ˜¯ <code>0.0.0.0</code> ä¸æ˜¯ <code>loopback</code></li>
</ol>
<h4 data-id="heading-313">è°ƒè¯•é¡ºåº</h4>
<pre><code class="hljs">æœ¬åœ° curl â†’ FRP å¯åŠ¨ â†’ å¤–ç½‘ curl â†’ ä¼ä¸šå¾®ä¿¡ä¿å­˜ â†’ App æµ‹è¯•
</code></pre>
<h4 data-id="heading-314">æ•‘å‘½å‘½ä»¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># çœ‹æ—¥å¿—</span>
<span class="hljs-built_in">tail</span> -f ~/.openclaw/logs/gateway.err.log

<span class="hljs-comment"># çœ‹é…ç½®</span>
openclaw config get channels.wecom

<span class="hljs-comment"># çœ‹çŠ¶æ€</span>
openclaw channels status
</code></pre>
<hr/>
<blockquote>
<p><strong>åè®°</strong>ï¼šä»ä¸‹åˆ 2 ç‚¹åˆ°æ™šä¸Š 9 ç‚¹ï¼Œ7 å°æ—¶è¸©å‘ï¼Œ30 è¡Œé…ç½®ï¼Œè‡´æ•¬æ¯ä¸€ä½éƒ¨ç½² OpenClaw çš„å¼€å‘è€…ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-315">ğŸ’¾ å¦‚ä½•ä¿å­˜è¿™ä»½å®å½•</h3>
<p><strong>æ–¹æ³•ä¸€ï¼šå¤åˆ¶ç²˜è´´</strong></p>
<ol>
<li>é€‰ä¸­ä¸Šé¢çš„å…¨éƒ¨å†…å®¹</li>
<li>å¤åˆ¶åˆ° VS Code/Typora/è®°äº‹æœ¬</li>
<li>ä¿å­˜ä¸º <code>.md</code> æ–‡ä»¶</li>
</ol>
<p><strong>æ–¹æ³•äºŒï¼šç”Ÿæˆ PDF</strong></p>
<ul>
<li>ç”¨æµè§ˆå™¨"æ‰“å°" â†’ å¦å­˜ä¸º PDF</li>
</ul>
<p><strong>æ–¹æ³•ä¸‰ï¼šå‘å¸ƒåˆ°ç½‘ä¸Š</strong></p>
<ul>
<li>çŸ¥ä¹/æ˜é‡‘/CSDNï¼šç›´æ¥ç²˜è´´ Markdown</li>
<li>GitHubï¼šåˆ›å»º Gist æˆ–ä»“åº“</li>
</ul>
<hr/>
<p>éœ€è¦æˆ‘æŠŠè¿™ä»½å®å½•è°ƒæ•´æˆ<strong>çŸ¥ä¹æ’ç‰ˆ</strong>ã€<strong>å…¬ä¼—å·æ’ç‰ˆ</strong>ã€æˆ–è€…<strong>GitHub README æ ¼å¼</strong>å—ï¼Ÿ ğŸ‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ›¾ç»ç‹è€…ä»Šä½•åœ¨? OpenAI é­é‡æ»‘é“å¢,Codex App èƒ½å¦åŠ›æŒ½ç‹‚æ¾œ]]></title>    <link>https://juejin.cn/post/7602846823325614115</link>    <guid>https://juejin.cn/post/7602846823325614115</guid>    <pubDate>2026-02-04T18:46:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602846823325614115" data-draft-id="7602837527674290191" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ›¾ç»ç‹è€…ä»Šä½•åœ¨? OpenAI é­é‡æ»‘é“å¢,Codex App èƒ½å¦åŠ›æŒ½ç‹‚æ¾œ"/> <meta itemprop="keywords" content="OpenAI,äººå·¥æ™ºèƒ½,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-02-04T18:46:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wangruofeng"/> <meta itemprop="url" content="https://juejin.cn/user/712139266070296"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ›¾ç»ç‹è€…ä»Šä½•åœ¨? OpenAI é­é‡æ»‘é“å¢,Codex App èƒ½å¦åŠ›æŒ½ç‹‚æ¾œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/712139266070296/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wangruofeng
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T18:46:41.000Z" title="Wed Feb 04 2026 18:46:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">OpenRouter æ˜¯ä»€ä¹ˆ</h2>
<p><strong>OpenRouter</strong> æ˜¯ä¸€ä¸ªå¤šæ¨¡å‹ LLM API çš„ç»Ÿä¸€ç½‘å…³,æŠŠä¸åŒå‚å•†ã€ä¸åŒæ¨¡å‹ã€ä¸åŒè®¡è´¹æ–¹å¼ã€ä¸åŒå‚æ•°æ¥å£,ç»Ÿä¸€å°è£…æˆä¸€å¥—å…¼å®¹ OpenAI çš„è°ƒç”¨æ–¹å¼ã€‚ä½ å¯ä»¥åœ¨ä¸€ä¸ª endpoint ä¸Šå®Œæˆé€‰æ¨¡å‹ã€è°ƒç”¨ã€è®¡è´¹å’Œè§‚æµ‹ã€‚</p>
<p>å®˜ç½‘:<a href="https://link.juejin.cn?target=https%3A%2F%2Fopenrouter.ai%2Frankings" target="_blank" title="https://openrouter.ai/rankings" ref="nofollow noopener noreferrer">openrouter.ai/rankings</a></p>
<h2 data-id="heading-1">OpenRouter ä½¿ç”¨è¶‹åŠ¿</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f9c84a526a34409b462ef80580eb41f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=t%2F8VXhH7IbW1%2Ftn7%2BZ0EAwXK8dA%3D" alt="" loading="lazy"/></p>
<p>æœ€è¿‘ä¸€å‘¨(æˆªè‡³ 2026.01.26)çš„æ¦œå•å¦‚ä¸‹:</p>
<p><strong>å›½å¤–:</strong> Anthropic çš„ Claude Sonnet 4.5ã€Claude Opus 4.5;Google çš„ Gemini 3 Flash Previewã€Gemini 2.5 Flash;xAI çš„ Grok Code Fast 1ã€Grok 4.1 Fast;OpenAI çš„å¼€æºæ¨¡å‹ gpt-oss-120bã€‚</p>
<p><strong>å›½å†…:</strong> DeepSeek V3.2ã€Kimi K2.5ã€‚</p>
<p>å¾€å‰æ¨ä¸€å‘¨,æ¦œå•å·®ä¸å¤šã€‚å°ç±³çš„ Mimo-V2-Flash æ‰å‡ºå»äº†,gpt-oss-120b è¿›äº†å‰åã€‚ä½†æœ‰ä¸ªæ„å¤–:æ›¾ç»çš„ç»å¯¹è€å¤§ OpenAI,é™¤äº†ä¸€ä¸ªå…è´¹å¼€æºæ¨¡å‹,æœ€æ–°çš„ ChatGPT-5.2ã€ChatGPT-5.2-Codex ç­‰ä¸»åŠ›æ¨¡å‹å…¨éƒ½ä¸åœ¨æ¦œä¸Šã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7608bfd056e4ce5889af4fa17365c13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=48ibBXp8pjiptTFFepjwCtOvrds%3D" alt="" loading="lazy"/></p>
<p>2026.01.19 å’Œ 2026.01.26 çš„å¯¹æ¯”:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/119f22789e704b89a6a0136813f9a251~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=d2fVAHiYHlsNp2S%2BrrbUdFZ9yDo%3D" alt="" loading="lazy"/></p>
<p>ä»æ•°æ®çœ‹,GPT ç³»åˆ—çš„ token ä½¿ç”¨é‡å·²ç»æ‰å‡ºå‰å,Google çš„å¸‚åœºä»½é¢æ˜¯ OpenAI çš„ä¸¤å€ã€‚</p>
<p>å†çœ‹çœ‹æœ€å—æ¬¢è¿çš„å¤§è¯­è¨€æ¨¡å‹(LLM)æ’è¡Œæ¦œ,è¿˜æ˜¯æ²¡ OpenAI çš„å½±å­ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8206e87fe16645d9aea3af63b99575ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=e4S95jS0uPzb8Of4Zqrkt%2Fm7DXc%3D" alt="" loading="lazy"/></p>
<p>å†çœ‹å…¬å¸çš„å¸‚åœºä»½é¢,ä¸­é—´è“è‰²æ˜¯ OpenAI:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1b4fa1e492c46b698f3cef7388b01b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=cAHePunLHn2q%2F6t%2B%2FPB1ty3jWp4%3D" alt="" loading="lazy"/></p>
<p>xAI æ­£åœ¨å¿«é€Ÿå´›èµ·,OpenAI çš„å¸‚åœºä»½é¢è¢«ä¸¥é‡èš•é£Ÿ,ç°åœ¨åªå‰© 10% å·¦å³ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7e54693cd6e4ec19132788646d236e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=zeqDWerL0EKvPJywV1gZCWZpvPg%3D" alt="" loading="lazy"/></p>
<p>ç¼–ç¨‹æ¨¡å‹æ•°æ®,åŸºå‡†è¯­è¨€æ˜¯ Python:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af0038f02dc549348f316c96078b6da6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=tVI9hhZiOaVwDgsKoMetfI%2Fip9E%3D" alt="" loading="lazy"/></p>
<p>OpenAI æ›¾ç»æ˜¯è¿™ä¸€é¢†åŸŸçš„ç»å¯¹éœ¸ä¸»,ç°åœ¨è¿™ä¸ªè¡¨ç°ç¡®å®è®©äººæ„å¤–ã€‚æˆ‘è§‰å¾—åŸå› å¯èƒ½æœ‰ä¸å°‘:äº§å“æ›´æ–°æ…¢äº†ã€å®šä»·æ²¡ä¼˜åŠ¿ã€å¼€æºæ¨¡å‹å†²å‡»ã€å¯¹æ‰‹è¿›æ­¥å¤ªå¿«ã€‚</p>
<p>ä¸¤å¤©å‰ OpenAI æ¨å‡ºäº† Mac ç‰ˆ Codex App,è¿˜å…è´¹å¼€æ”¾äº†æœ€æ–°çš„ä»˜è´¹æ¨¡å‹ã€‚ä¸‹é¢è¯¦ç»†æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<h2 data-id="heading-2">Codex App è¯„æµ‹</h2>
<p>æˆ‘å®‰è£…åçš„å¯ç”¨æ¨¡å‹:ä¸Šé¢æ˜¯ GPT-5.2-Codexã€GPT-5.2 Medium/High/Extra,ä¸‹é¢æ˜¯å†å²æ¨¡å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd4025f7ebca4839b33b36482198584a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=l0vZIxjTT5qpQP4nbbeLjoSnGmU%3D" alt="" loading="lazy"/></p>
<p><strong>å®˜æ–¹è¯´æ³•:</strong></p>
<blockquote>
<p>Codex App æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å…¨æ–°ç•Œé¢,æ—¨åœ¨è½»æ¾ç®¡ç†å¤šä¸ªä»£ç†,å¹¶è¡Œè¿è¡Œå·¥ä½œ,å¹¶ä¸ä»£ç†åä½œå®Œæˆé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ã€‚</p>
<p>åœ¨é™å®šæ—¶é—´å†…,ChatGPT Free å’Œ Go ç‰ˆæœ¬å‡åŒ…å« Codex,Plusã€Proã€Businessã€Enterprise å’Œ Edu å¥—é¤çš„é€Ÿç‡é™åˆ¶ä¹Ÿç¿»å€ã€‚æ— è®ºæ‚¨åœ¨ä½•å¤„ä½¿ç”¨ Codex,è¿™äº›æ›´é«˜çš„é€Ÿç‡é™åˆ¶éƒ½é€‚ç”¨ã€‚</p>
</blockquote>
<p>ç°åœ¨ Codex é™æ—¶å…è´¹,å…·ä½“å¤šä¹…æ²¡è¯´ã€‚ä¸»è¦é¢å‘å¼€å‘è€…,æœ‰å…´è¶£å¯ä»¥è¯•è¯•ã€‚</p>
<p>ä¸‹è½½åœ°å€:<a href="https://link.juejin.cn?target=https%3A%2F%2Fpersistent.oaistatic.com%2Fcodex-app-prod%2FCodex.dmg" target="_blank" title="https://persistent.oaistatic.com/codex-app-prod/Codex.dmg" ref="nofollow noopener noreferrer">persistent.oaistatic.com/codex-app-pâ€¦</a></p>
<p>è¿™æ¬¡æ›´æ–°ä¸»è¦æ˜¯ä¸¤ä¸ªåŠŸèƒ½:<strong>æŠ€èƒ½åº“(Skills)å’Œè‡ªåŠ¨åŒ–ä»»åŠ¡</strong>ã€‚</p>
<h3 data-id="heading-3">æŠ€èƒ½åº“</h3>
<p>Codex App å†…ç½®äº†æŠ€èƒ½åº“,åŒ…å« OpenAI å¸¸ç”¨çš„å·¥å…·å’Œå·¥ä½œæµç¨‹,è€Œä¸”å…¨éƒ¨å¼€æº:<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%25E3%2580%2582" target="_blank" title="https://github.com/openai/skills%E3%80%82" ref="nofollow noopener noreferrer">github.com/openai/skilâ€¦</a> ä¸¾å‡ ä¸ªä¾‹å­:</p>
<ul>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Ffigma-implement-design%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/figma-implement-design/SKILL.md" ref="nofollow noopener noreferrer">figma-implement-design</a></strong>:ä» Figma è·å–è®¾è®¡ç´ æ,è½¬æ¢æˆ UI ä»£ç ,å®ç° 1:1 è¿˜åŸã€‚</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Flinear%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/linear/SKILL.md" ref="nofollow noopener noreferrer">Linear é¡¹ç›®ç®¡ç†</a></strong>:åˆ†ç±»é”™è¯¯ã€è·Ÿè¸ªç‰ˆæœ¬å‘å¸ƒã€ç®¡ç†å·¥ä½œé‡ã€‚</p>
</li>
<li>
<p><strong>äº‘ç«¯éƒ¨ç½²</strong>:æŠŠ Web åº”ç”¨éƒ¨ç½²åˆ° <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Fcloudflare-deploy%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/cloudflare-deploy/SKILL.md" ref="nofollow noopener noreferrer">Cloudflare</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Frender-deploy%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/render-deploy/SKILL.md" ref="nofollow noopener noreferrer">Netlify</a> æˆ– <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Fvercel-deploy%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/vercel-deploy/SKILL.md" ref="nofollow noopener noreferrer">Vercel</a>ã€‚</p>
</li>
<li>
<p><strong>å›¾åƒç”Ÿæˆ</strong>:ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Fimagegen%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/imagegen/SKILL.md" ref="nofollow noopener noreferrer">å›¾åƒç”ŸæˆæŠ€èƒ½</a>(GPT Image)åˆ›å»ºå’Œç¼–è¾‘å›¾åƒã€‚</p>
</li>
<li>
<p><strong>OpenAI API å¼€å‘</strong>:<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Fopenai-docs%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/openai-docs/SKILL.md" ref="nofollow noopener noreferrer">å‚è€ƒæ–‡æ¡£</a>ã€‚</p>
</li>
<li>
<p><strong>æ–‡æ¡£å¤„ç†</strong>:é˜…è¯»ã€åˆ›å»ºå’Œç¼–è¾‘ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Fpdf%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/pdf/SKILL.md" ref="nofollow noopener noreferrer">PDF</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Fspreadsheet%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/spreadsheet/SKILL.md" ref="nofollow noopener noreferrer">ç”µå­è¡¨æ ¼</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenai%2Fskills%2Fblob%2Fmain%2Fskills%2F.curated%2Fdoc%2FSKILL.md" target="_blank" title="https://github.com/openai/skills/blob/main/skills/.curated/doc/SKILL.md" ref="nofollow noopener noreferrer">docx</a>ã€‚</p>
</li>
</ul>
<p>æœ¬åœ°å®‰è£…çš„ Skills:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55a81999479540f49b383ba190c8fb32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=Q%2BihiM%2F%2BJBWbYGrvIbbvsSeCzLw%3D" alt="" loading="lazy"/></p>
<p>ç³»ç»Ÿæ¨èçš„å®˜æ–¹ Skills:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3e0253096ab475f9ccf8a9faffd6a65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=a2aNC2Ljf3jC9HmD3WjIjdLtGEM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">è‡ªåŠ¨åŒ–ä»»åŠ¡</h3>
<p><strong>å®˜æ–¹ä»‹ç»:</strong></p>
<blockquote>
<p>ä½¿ç”¨ Codex åº”ç”¨è®¾ç½®è‡ªåŠ¨åŒ–ä»»åŠ¡,è®© Codex åœ¨åå°æŒ‰è®¡åˆ’è‡ªåŠ¨è¿è¡Œã€‚è‡ªåŠ¨åŒ–ä»»åŠ¡å°†æŒ‡ä»¤ä¸å¯é€‰<strong>æŠ€èƒ½</strong>ç›¸ç»“åˆ,å¹¶æŒ‰ç…§æ‚¨è®¾å®šçš„æ—¶é—´è¡¨è¿è¡Œã€‚å®Œæˆåç»“æœä¼šè¿›å…¥å®¡æ ¸é˜Ÿåˆ—,æ‚¨å¯ä»¥éšæ—¶è¿”å›ç»§ç»­å·¥ä½œã€‚</p>
<p>åœ¨ OpenAI,æˆ‘ä»¬ä¸€ç›´ä½¿ç”¨è‡ªåŠ¨åŒ–å¤„ç†é‡å¤ä½†é‡è¦çš„ä»»åŠ¡,ä¾‹å¦‚æ—¥å¸¸é—®é¢˜åˆ†ç±»ã€æŸ¥æ‰¾å’Œæ€»ç»“ CI å¤±è´¥ã€ç”Ÿæˆæ¯æ—¥å‘å¸ƒç®€æŠ¥ã€æ£€æŸ¥é”™è¯¯ç­‰ç­‰ã€‚</p>
</blockquote>
<p>è¿™ä¸ªåŠŸèƒ½è¿˜åœ¨ Betaã€‚ç•Œé¢å¦‚ä¸‹:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77f5bfc496ca42bb8d1b59143a394fc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=eMbIR%2BoltHwxgdjQ410iMjmWshY%3D" alt="" loading="lazy"/></p>
<p>åˆ›å»ºè‡ªåŠ¨åŒ–ä»»åŠ¡éœ€è¦å¡«å†™:<strong>åç§°</strong>ã€<strong>é¡¹ç›®</strong>ã€<strong>æç¤ºè¯</strong>ã€<strong>æ‰§è¡Œè®¡åˆ’</strong>ã€‚</p>
<p>æ‰§è¡Œè®¡åˆ’æœ‰ä¸¤ç§:</p>
<p><strong>æŒ‰å¤©å¾ªç¯</strong>:é€‰ä¸€å‘¨ä¸­çš„å“ªå‡ å¤©ã€ä»€ä¹ˆæ—¶é—´è§¦å‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1884e6eb28c464d80a5ab427d997bd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=BUgORfX1kUEeAovHf5caz5slTlY%3D" alt="" loading="lazy"/></p>
<p><strong>å›ºå®šé—´éš”</strong>:æ¯å‡ å°æ—¶è§¦å‘ä¸€æ¬¡,ä¹Ÿè¦é€‰ä¸€å‘¨ä¸­çš„å“ªå‡ å¤©ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/747a58e454d245fc8c686edac0284043~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=7nwMal1fTRmg01U16jpeOnsSPHk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">åŠŸèƒ½æµ‹è¯•</h2>
<h3 data-id="heading-6">è°ƒç”¨ Skills</h3>
<p>æˆ‘æµ‹è¯•äº†æœ¬åœ°å®‰è£…çš„ Code Review Skillã€‚</p>
<p><strong>æ­¥éª¤ 1:</strong> é€‰æ‹©ã€Skillsã€‘,æ‰¾åˆ°ã€Code Reviewã€‘</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4f5f6440ee0474298ad9f88299a27d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=D78UqHnYT99gcenYBJTy9l6yh%2Bg%3D" alt="" loading="lazy"/></p>
<p><strong>æ­¥éª¤ 2:</strong> ç‚¹å‡»ã€Tryã€‘</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b289a7e7c36c485dbf979bf198914ba3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=uPpqy1pfz2yvZW6H7beCy9vvyrA%3D" alt="" loading="lazy"/></p>
<p><strong>æ­¥éª¤ 3:</strong> è¾“å…¥"Review ä»£ç "</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e09423bbfa04f88bddf41c2f734d853~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=RQ3e2njZxoYGkeR345WHJ%2B08OWU%3D" alt="" loading="lazy"/></p>
<p>ç³»ç»Ÿé—®è¦ Review å“ªäº›,æˆ‘é€‰äº†"å½“å‰æ‰€æœ‰å˜æ›´":</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fdc9437cc9214f6ca18ec53147ce191d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=lMoKN30iPOJYhwk2p0jemsZZH7k%3D" alt="" loading="lazy"/></p>
<p>é»˜è®¤è¿”å›è‹±æ–‡:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8eddbc29f14645878815cf49d585e657~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=2bWjLABGTWMTKfUvu9Ir2RwoYvI%3D" alt="" loading="lazy"/></p>
<p>è®©ç³»ç»Ÿç”¨ä¸­æ–‡å›å¤,åˆ‡æ¢æ²¡é—®é¢˜:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/097d64faccef474792b8c558294b1d59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=%2FdCuzwGVMFe3xB%2BI1uIDLtJiX98%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">æäº¤ä»£ç </h3>
<p>Review å®Œäº†,ç»§ç»­æµ‹è¯•ä»£ç æäº¤ã€‚è¾“å…¥"æäº¤ä»£ç ",æŒ‰ç³»ç»Ÿæç¤ºæ“ä½œ:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39a06ea67d5f4a6cab75b2cc18afff6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=bjSp7KNnrZSGINlco34mq9N8jt4%3D" alt="" loading="lazy"/></p>
<p>æˆåŠŸæ¨åˆ° GitHub(è¿™ä¸ªé¡¹ç›®æ‰˜ç®¡åœ¨ GitHub)ã€‚ç”¨è‡ªç„¶è¯­è¨€å°±èƒ½å®Œæˆä¸€äº› Git æ“ä½œ:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9673da6c919a4dc981b88a920e8bc9c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=xpzGA%2Fnt7Z5E1TXba9Ldq4ISDx8%3D" alt="" loading="lazy"/></p>
<p>å» GitHub éªŒè¯,ç¡®å®æäº¤æˆåŠŸäº†:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a0c6059ed6c4c5992cf866a3614dfc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=VoPJF%2FYFwfXRUaFUnPOLT%2FfFzzs%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-8">æ•´ç†æ¡Œé¢</h3>
<p>å¬è¯´ Mac ç‰ˆ App ä¹Ÿæ”¯æŒç±»ä¼¼ Claude Code çš„æ¡Œé¢æ•´ç†,æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<p>è¾“å…¥"å¸®æˆ‘æ•´ç†ä¸€ä¸‹æ¡Œé¢",ç³»ç»Ÿè¦æˆæƒã€‚ç‚¹ Setting èœå•çš„ç™»å‡º,é‡æ–°ç™»å½•:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d91b04e92cb0437a94ecb04def56e650~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=Zh53Zr9i%2B60CMDxaiXze5MyHw2Y%3D" alt="" loading="lazy"/></p>
<p>é‡æ–°ç™»å½•å,å†è¾“å…¥æŒ‡ä»¤,ç³»ç»Ÿè®©ç¡®è®¤æ•´ç†è§„åˆ™:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/751acda7ffbe4ab390ceb9e9aea3e433~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=DBflqK%2B1zm1w4Zw0WtMiabJLdPs%3D" alt="" loading="lazy"/></p>
<p>è¾“å…¥è§„åˆ™åç»§ç»­,æ¡Œé¢æ•´ç†å®Œæˆäº†ã€‚è¿™ä¸ªåŠŸèƒ½æ²¡é—®é¢˜:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a437205f19fd4f4b916cd2254dde094f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=9RMaGiuE1JFgXV9mnB7VjTIlXss%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">è¿è¡Œé¡¹ç›®</h3>
<p>æ‰¾ä¸ªæœ¬åœ°é¡¹ç›®è¯•è¯•ã€‚ç³»ç»Ÿè¯´æ²¡æ³•ç›´æ¥è¿è¡Œ,å’Œ CLI ç›¸æ¯”æƒé™æœ‰é™,æœ¬åœ° Web Node æœåŠ¡éƒ½æ²¡æ³•ç›´æ¥å¯åŠ¨,è®©æˆ‘è‡ªå·±åœ¨ç»ˆç«¯å¯åŠ¨:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea6b261d1faf474e9ed4c684f9798519~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=QU3hEElbjDyU7k4qqeJgLXzocQs%3D" alt="" loading="lazy"/></p>
<p>æ‰“å¼€ App æä¾›çš„ç»ˆç«¯æµ‹è¯•å¯åŠ¨,æ­£å¸¸ã€‚é—®é¢˜åœ¨äº,æƒ³é€šè¿‡è‡ªç„¶è¯­è¨€ç›´æ¥è¿è¡Œé¡¹ç›®,ç°åœ¨è¿˜æ˜¯åå‘ ChatBox é—®ç­”,ä¸æ˜¯çœŸæ­£çš„è‡ªåŠ¨åŒ–ã€‚</p>
<p>å¦ä¸€ç§æ–¹å¼æ˜¯ç‚¹ç•Œé¢ä¸Šæ–¹çš„è¿è¡ŒæŒ‰é’®(å‘å³ä¸‰è§’å½¢),é…ç½®è¿è¡Œå‘½ä»¤åç‚¹ã€Saveã€‘,App ä¼šåœ¨å†…éƒ¨å¼€ç»ˆç«¯æ‰§è¡Œå‘½ä»¤:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3a7d5ded2de4df092120fd784d8cacf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=xRymbTRicNZPb%2FYk%2F6gdk5GAALg%3D" alt="" loading="lazy"/></p>
<p>æ•ˆæœå¦‚ä¸‹,æœ¬è´¨ä¸Šè¿˜æ˜¯å€Ÿç»ˆç«¯ç¯å¢ƒ:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37364fa54dca4aceb72b6953e5036900~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=IhYEcvfMWmhKg4GDN8s6s%2BUcSBo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">å…¶ä»–åŠŸèƒ½</h2>
<h3 data-id="heading-11">Git ç®¡ç†</h3>
<p>App å†…ç½®äº† Git æŸ¥çœ‹åŠŸèƒ½,ç‚¹å³ä¸Šè§’æŒ‰é’®èƒ½çœ‹<strong>å·²æš‚å­˜</strong>ã€<strong>æœªæš‚å­˜</strong>çš„ä»£ç :</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72f07f60118a455a9be36d79e2fd2568~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=Yc4A%2BQdgSVkdzSRvn1RENuY%2F%2Bh4%3D" alt="" loading="lazy"/></p>
<p>æ”¯æŒæŒ‰æ–‡ä»¶æ ‘çœ‹:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e96a00c40e07432cae2a44539b292bae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=cm3k5%2FzUiERbAFa3kjiuOrluUGA%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å³ä¸Šè§’ commit æŒ‰é’®,èƒ½ç›´æ¥æäº¤ä»£ç ã€æ¨åˆ°è¿œç«¯ã€åˆ›å»º PR:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59a7e52f58f74ec3b0d30a83fb00a4b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=7PDoUp5MrKkrJCO%2BSQusuf106oM%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å³ä¸Šè§’ Open æŒ‰é’®,èƒ½ç”¨ IDE æˆ–å…¶ä»–åº”ç”¨æ‰“å¼€é¡¹ç›®,æ¯”å¦‚ç»ˆç«¯å’Œ Finder:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36812dbf49b949088971336b75db0ce8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=GC2JPozK7%2BU8UmZVMcu0VPhKJcE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">ä¸Šä¸‹æ–‡</h3>
<p>ç‚¹å³ä¸‹è§’åœ†åœˆå›¾æ ‡çœ‹ä¸Šä¸‹æ–‡ä½¿ç”¨,GPT-5.2-Codex æ˜¯ <strong>258k tokens</strong>ã€‚ä»æè¿°çœ‹,æ”¯æŒä¸Šä¸‹æ–‡è¶…å‡ºåè‡ªåŠ¨å‹ç¼©:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d4c8e2dcc164db293ea17fd476cdcc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770835604&amp;x-signature=6FZmFymMeKqTcrHiP%2F42s%2FhU0D4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-13">æœ€åçš„æƒ³æ³•</h2>
<p>Codex App æœ‰å‡ ä¸ªæ˜æ˜¾çš„å¥½å¤„:æŠŠä»£ç å®¡æŸ¥ã€æ–‡æ¡£ç”Ÿæˆã€å›¾åƒå¤„ç†ç­‰å¤šä¸ª AI èƒ½åŠ›é›†æˆåœ¨ä¸€ä¸ªç•Œé¢,ä¸ç”¨æ¥å›åˆ‡æ¢å·¥å…·;å¼€æºçš„ Skills æœºåˆ¶è®©å¼€å‘è€…å¯ä»¥æ‰©å±•èƒ½åŠ›;ç”¨æ—¥å¸¸è¯­è¨€å°±èƒ½å®Œæˆ Git æ“ä½œã€æ–‡ä»¶æ•´ç†ç­‰ä»»åŠ¡,é—¨æ§›é™ä½äº†;ç°åœ¨å…è´¹,å¯ä»¥ä½æˆæœ¬ä½“éªŒã€‚</p>
<p>ä½†ä¹Ÿæœ‰å±€é™:å’Œ CLI å·¥å…·æ¯”,æƒé™ä¸å¤Ÿ,æ²¡æ³•ç›´æ¥å¯åŠ¨æœ¬åœ°æœåŠ¡,è¿˜æ˜¯å¾—ä¾èµ–ç»ˆç«¯;ç°åœ¨çš„ä½“éªŒæ›´åƒä¼ ç»Ÿ ChatBot,ä¸æ˜¯çœŸæ­£çš„è‡ªåŠ¨åŒ–å·¥ä½œæµ;Googleã€Anthropic è¿™äº›å¯¹æ‰‹è¿­ä»£å¾ˆå¿«,Codex App çš„åŠŸèƒ½åˆ›æ–°åº¦ç›¸å¯¹æœ‰é™ã€‚</p>
<p>ä» OpenRouter çš„æ•°æ®çœ‹,OpenAI å‹åŠ›å¾ˆå¤§ã€‚Codex App æ˜¯ä¸€ä¸ªåº”å¯¹ç­–ç•¥,ä½†è¦çœŸæ­£æ‰­è½¬å±€é¢,æˆ‘è§‰å¾— OpenAI è¿˜å¾—åœ¨å‡ ä¸ªæ–¹é¢å‘åŠ›:</p>
<ul>
<li>æŠ€æœ¯åˆ›æ–°ï¼šä¸èƒ½åªä¼˜åŒ–åº”ç”¨å±‚é¢,æ¨¡å‹èƒ½åŠ›å¾—æœ‰çªç ´æ€§æå‡;</li>
<li>å®šä»·ç­–ç•¥ï¼šä¿æŒç›ˆåˆ©çš„åŒæ—¶,ä»·æ ¼å¾—æ›´æœ‰ç«äº‰åŠ›;</li>
<li>å¼€å‘è€…ç”Ÿæ€ï¼šæ„å»ºæ›´å¼€æ”¾çš„ç”Ÿæ€,å¸å¼•ç¬¬ä¸‰æ–¹å¼€å‘è€…å…±å»º;</li>
<li>ç”¨æˆ·ä½“éªŒï¼šä»"å·¥å…·"å‘"æ™ºèƒ½åŠ©ç†"è½¬å˜,çœŸæ­£å®ç°ä»"è°ƒç”¨"åˆ°"åä½œ"ã€‚</li>
</ul>
<p>ç»™å¼€å‘è€…çš„å»ºè®®:Codex App æä¾›äº†ä¾¿åˆ©,ä½†åˆ«è¿‡åº¦ä¾èµ–ã€‚å¤æ‚å¼€å‘å·¥ä½œæµé‡Œ,CLI å·¥å…·å’Œ IDE é›†æˆè¿˜æ˜¯å°‘ä¸äº†;å…è´¹æœŸç»“æŸå,å¾—è¯„ä¼°æˆæœ¬å’Œæ”¶ç›Šæ˜¯å¦åŒ¹é…;AI å·¥å…·å¸‚åœºå˜åŒ–å¿«,å»ºè®®å¤šä½“éªŒå‡ ä¸ªå¹³å°,æ¯”å¦‚ Claude Codeã€GitHub Copilot,é€‰æœ€é€‚åˆè‡ªå·±å·¥ä½œæµç¨‹çš„ã€‚</p>
<p>OpenAI æƒ³é€šè¿‡ Codex App æŠ¢å å¼€å‘è€…å·¥å…·å¸‚åœº,ä½†å®æµ‹ä¸‹æ¥,è‡ªç„¶è¯­è¨€äº¤äº’èƒ½åŠ›å’Œç³»ç»Ÿæƒé™è¿˜ä¸å¦‚ CLI å·¥å…·çµæ´»ã€‚Googleã€Anthropic è¿™äº›ç«äº‰å¯¹æ‰‹èµ·æ¥äº†,Codex App èƒ½ä¸èƒ½å¸® OpenAI å¤ºå›å¸‚åœº,è¿˜å¾—å†çœ‹ã€‚</p>
<p>å¯¹å¼€å‘è€…æ¥è¯´,ä¿æŒå¼€æ”¾å¿ƒæ€,æ‹¥æŠ±æ–°å·¥å…·,ä½†ä¹Ÿå¾—ç†æ€§è¯„ä¼°å®é™…ä»·å€¼ã€‚è¿™æ˜¯åº”å¯¹ AI æ—¶ä»£æŠ€æœ¯å˜é©çš„æ­£ç¡®æ–¹å¼ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangGraph Multi-Agent å®æˆ˜ï¼šè®©æ™ºèƒ½ä½“åƒå›¢é˜Ÿä¸€æ ·åä½œ]]></title>    <link>https://juejin.cn/post/7602824293165170703</link>    <guid>https://juejin.cn/post/7602824293165170703</guid>    <pubDate>2026-02-05T01:22:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602824293165170703" data-draft-id="7602800677712298018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangGraph Multi-Agent å®æˆ˜ï¼šè®©æ™ºèƒ½ä½“åƒå›¢é˜Ÿä¸€æ ·åä½œ"/> <meta itemprop="keywords" content="åç«¯,LangChain,Agent"/> <meta itemprop="datePublished" content="2026-02-05T01:22:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜Ÿæµ©AI"/> <meta itemprop="url" content="https://juejin.cn/user/2904236059009760"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangGraph Multi-Agent å®æˆ˜ï¼šè®©æ™ºèƒ½ä½“åƒå›¢é˜Ÿä¸€æ ·åä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2904236059009760/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜Ÿæµ©AI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:22:48.000Z" title="Thu Feb 05 2026 01:22:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">1. å¯¼è¯»</h3>
<p>çœŸå®ä¸šåŠ¡é‡Œï¼Œ<strong>ä¸€ä¸ª Agent å¾€å¾€ä¸å¤Ÿ</strong>ï¼š</p>
<ul>
<li>æœ‰çš„ä»»åŠ¡éœ€è¦â€œæ‹†åˆ† â†’ å¹¶è¡Œæ‰§è¡Œ â†’ æ±‡æ€»å†³ç­–â€ï¼›</li>
<li>æœ‰çš„ä»»åŠ¡éœ€è¦â€œä¸€ä¸ªæ€»æ§æ¥åˆ†é…å·¥ä½œï¼Œå¤šä¸ª worker å»å„è‡ªæ‰§è¡Œâ€ï¼›</li>
<li>æœ‰çš„åœºæ™¯è¦â€œä¸€ä¸ªæ¨¡å‹æ¥ç”Ÿæˆï¼Œä¸€ä¸ªæ¨¡å‹æ¥è¯„ä¼° / ä¿®æ”¹ / æ‰“å›é‡åšâ€ã€‚</li>
</ul>
<p>è¿™å°±æ˜¯å¤šä»£ç†ç³»ç»Ÿï¼ˆMulti-Agentï¼‰è¦æå®šçš„äº‹å„¿ï¼š</p>
<blockquote>
<p>âä¸å†åªä¾èµ–ä¸€ä¸ªâ€œå¤§è€Œå…¨â€çš„æ™ºèƒ½ä½“ï¼Œè€Œæ˜¯è®©å¤šä¸ªæœ‰åˆ†å·¥çš„ Agent ååŒå®Œæˆå¤æ‚ä»»åŠ¡ã€‚</p>
</blockquote>
<p>å’±ä»¬ä»èƒ½ç›´æ¥è½åœ°çš„è§’åº¦ï¼Œä¸€èµ·æ­ä¸€ä¸ªç®€å•ä½†é è°±çš„å¤šä»£ç†ç³»ç»Ÿï¼Œçœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆè®©æ™ºèƒ½ä½“åƒå›¢é˜Ÿä¸€æ ·åä½œçš„ã€‚</p>
<h3 data-id="heading-1">2. è¯»å®Œä½ èƒ½å­¦åˆ°</h3>
<ul>
<li><strong>ç†è§£è§’è‰²åˆ’åˆ†</strong>ï¼šOrchestratorï¼ˆæ€»æ§ï¼‰ã€Workerï¼ˆæ‰§è¡Œï¼‰ã€Evaluatorï¼ˆè¯„ä¼°ï¼‰ã€Specialistï¼ˆé¢†åŸŸä¸“å®¶ï¼‰</li>
<li><strong>æŒæ¡æ ¸å¿ƒæ€è·¯</strong>ï¼šå…±äº« Stateã€æ¡ä»¶è¾¹/è·¯ç”±ã€å­å›¾å°è£…</li>
<li><strong>å®ç°ç»å…¸æ¨¡å¼</strong>ï¼šOrchestrator-Workerï¼ˆä»»åŠ¡åˆ†é…æ‰§è¡Œï¼‰ã€Evaluator-Optimizerï¼ˆè¯„ä¼°è¿­ä»£ï¼‰</li>
<li><strong>å­¦ä¼šå–èˆ</strong>ï¼šåˆ¤æ–­ä½•æ—¶éœ€è¦å¤šä»£ç†ï¼Œä½•æ—¶å• Agent + å·¥å…·è¶³å¤Ÿ</li>
</ul>
<h3 data-id="heading-2">3. Multi-Agent æ˜¯ä»€ä¹ˆ &amp; ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ï¼Ÿ</h3>
<h4 data-id="heading-3">3.1 ä¸€ä¸ªç›´è§‚çš„ç±»æ¯”</h4>
<p>å¯ä»¥æŠŠå¤šä»£ç†ç³»ç»Ÿç±»æ¯”ä¸ºä¸€ä¸ªå°å‹å›¢é˜Ÿï¼š</p>
<ul>
<li>Orchestratorï¼šäº§å“ç»ç† / é¡¹ç›®ç»ç†ï¼Œè´Ÿè´£æ‹†è§£ä»»åŠ¡ã€åˆ†é…å·¥ä½œã€æ•´åˆç»“æœï¼›</li>
<li>Workerï¼šå„è·¯å¼€å‘ / è¿è¥ / é”€å”®ï¼Œè´Ÿè´£å®Œæˆå„è‡ªçš„å­ä»»åŠ¡ï¼›</li>
<li>Evaluatorï¼šæµ‹è¯• / è´¨æ£€ / å®¡æ ¸ï¼Œè´Ÿè´£æŒ‘é”™å’ŒæŠŠå…³è´¨é‡ã€‚</li>
</ul>
<p>åœ¨ LangGraph è§†è§’ä¸‹ï¼š</p>
<ul>
<li><strong>æ¯ä¸ª Agent æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª"å¸¦æœ‰è‡ªå·± Prompt + å·¥å…· + çŠ¶æ€è§†è§’"çš„èŠ‚ç‚¹å­å›¾</strong>ï¼›</li>
<li>å®ƒä»¬é€šè¿‡<strong>å…±äº«çš„å…¨å±€ State</strong>è¯»å†™ä¿¡æ¯ï¼›</li>
<li>å›¾ç»“æ„ï¼ˆèŠ‚ç‚¹ + è¾¹ï¼‰å®šä¹‰äº†"è°å…ˆè¯´ã€è°åè¯´ã€è°æœ‰æƒæ‰“å›é‡åš"ã€‚</li>
</ul>
<blockquote>
<p>âé‡è¦è¯´æ˜ï¼šæœ¬è®²ä»‹ç»çš„æ˜¯"å¤šèŠ‚ç‚¹ç¼–æ’"æ¨¡å¼ï¼Œè€Œé"åˆ†å¸ƒå¼å¤šæ™ºèƒ½ä½“"æœ¬è®²ï¼šæ‰€æœ‰ Agent èŠ‚ç‚¹åœ¨åŒä¸€ä¸ªè¿›ç¨‹å†…è¿è¡Œï¼Œé€šè¿‡ LangGraph çš„çŠ¶æ€æœºç¼–æ’ï¼Œå…±äº«åŒä¸€ä¸ªStateã€‚è¿™ç§æ–¹å¼é€‚åˆï¼š âœ… å¿«é€ŸåŸå‹éªŒè¯ï¼ˆä»£ç å°‘ã€éƒ¨ç½²å¿«ï¼‰ âœ… ä¸­å°è§„æ¨¡åº”ç”¨ï¼ˆä»»åŠ¡å¤æ‚åº¦é€‚ä¸­ï¼‰ âœ… æœ¬åœ°å¼€å‘è°ƒè¯•ï¼ˆå¯è§‚æµ‹æ€§å¼ºï¼‰ç¬¬ 9 è®²ï¼šæˆ‘ä»¬å°†è®²è§£çœŸæ­£çš„åˆ†å¸ƒå¼å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼Œæ¯ä¸ª Agent å¯ä»¥ç‹¬ç«‹éƒ¨ç½²åœ¨ä¸åŒè¿›ç¨‹/æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ã€API ç­‰æ–¹å¼å¼‚æ­¥é€šä¿¡ï¼Œé€‚åˆå¤§è§„æ¨¡ã€é«˜å¯ç”¨ã€éœ€è¦ç‹¬ç«‹æ‰©å±•çš„åœºæ™¯ã€‚ä¸ºä»€ä¹ˆå…ˆè®²å•è¿›ç¨‹ï¼Ÿï¼šå•è¿›ç¨‹æ¨¡å¼æ˜¯åˆ†å¸ƒå¼æ¨¡å¼çš„åŸºç¡€ï¼Œç†è§£äº†çŠ¶æ€å…±äº«å’ŒèŠ‚ç‚¹ç¼–æ’ï¼Œå†å­¦åˆ†å¸ƒå¼ä¼šæ›´è½»æ¾ã€‚</p>
</blockquote>
<h4 data-id="heading-4">3.2 ä»€ä¹ˆæ—¶å€™å€¼å¾—ä¸Š Multi-Agentï¼Ÿ</h4>
<p><strong>é€‚åˆåœºæ™¯ç‰¹å¾ï¼š</strong></p>
<ul>
<li><strong>ä»»åŠ¡å¯æ‹†åˆ†</strong>ï¼šå­ä»»åŠ¡èŒè´£æ¸…æ™°ã€è¾¹ç•Œæ˜ç¡®</li>
<li><strong>éœ€è¦å¤šè½®è¿­ä»£</strong>ï¼šå½¢æˆ"ç”Ÿæˆ â†’ è¯„ä¼° â†’ ä¼˜åŒ–"çš„é—­ç¯</li>
<li><strong>èƒ½åŠ›éœ€æ±‚å·®å¼‚å¤§</strong>ï¼šåˆ›ä½œå‹ã€å®¡æŸ¥å‹ã€æ‰§è¡Œå‹èƒ½åŠ›å¹¶å­˜</li>
</ul>
<p><strong>ç¤ºä¾‹</strong>ï¼šæ™ºèƒ½ä»£ç å®¡æŸ¥ç³»ç»Ÿï¼ˆéœ€æ±‚ â†’ ç”Ÿæˆä»£ç  â†’ å®¡æŸ¥ â†’ æµ‹è¯•ç”¨ä¾‹ï¼‰</p>
<h3 data-id="heading-5">4. å®æˆ˜ä¸€ï¼šOrchestrator-Worker æ¨¡å¼</h3>
<p>èŠå®Œæ¦‚å¿µï¼Œå’±ä»¬ç›´æ¥ä¸Šå®æˆ˜â€”â€”ç”¨ä»£ç å®¡æŸ¥å·¥ä½œæµæ¥çœ‹çœ‹å¤šä»£ç†æ€ä¹ˆç©ã€‚</p>
<p>è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬ç”¨<strong>ä»£ç å®¡æŸ¥å·¥ä½œæµ</strong>æ¥å®ç°æœ€å…¸å‹çš„ Orchestrator-Worker æ¨¡å¼ï¼š</p>
<blockquote>
<p>âä¸€ä¸ª Orchestrator è´Ÿè´£æ‹†è§£ä»»åŠ¡ã€åˆ†é…ç»™ä¸åŒ Workerï¼ˆå¼€å‘è€…ã€å®¡æŸ¥è€…ã€æµ‹è¯•è€…ï¼‰ï¼Œæœ€åæ”¶é›†å’Œæ€»ç»“ç»“æœã€‚</p>
</blockquote>
<h4 data-id="heading-6">4.1 è®¾è®¡ä¸€ä¸ªç®€å•çš„ä»»åŠ¡ï¼šä»£ç å®¡æŸ¥å·¥ä½œæµ</h4>
<p>éœ€æ±‚ï¼š</p>
<blockquote>
<p>âç”¨æˆ·æäº¤ä¸€ä¸ªåŠŸèƒ½éœ€æ±‚ï¼ˆæ¯”å¦‚"å®ç°ä¸€ä¸ªç”¨æˆ·ç™»å½•åŠŸèƒ½"ï¼‰ï¼Œç³»ç»Ÿè‡ªåŠ¨å®Œæˆï¼šä»£ç ç”Ÿæˆ â†’ ä»£ç å®¡æŸ¥ â†’ æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥è®¾è®¡ 4 ä¸ª Agentï¼š</p>
<ul>
<li><code>orchestrator</code>ï¼šç†è§£ç”¨æˆ·éœ€æ±‚ï¼Œæ‹†è§£ä»»åŠ¡ï¼Œå†³å®šè°ƒç”¨å“ªäº› Workerï¼›</li>
<li><code>developer_agent</code>ï¼šè´Ÿè´£æ ¹æ®éœ€æ±‚ç”Ÿæˆä»£ç ï¼›</li>
<li><code>reviewer_agent</code>ï¼šè´Ÿè´£å®¡æŸ¥ä»£ç è´¨é‡ã€å®‰å…¨æ€§ã€æ€§èƒ½ï¼›</li>
<li><code>tester_agent</code>ï¼šè´Ÿè´£ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ã€‚</li>
</ul>
<h4 data-id="heading-7">4.2 å®šä¹‰å…±äº«çŠ¶æ€ State</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict, <span class="hljs-type">List</span>
<span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> StateGraph, START, END


<span class="hljs-keyword">class</span> <span class="hljs-title class_">CodeReviewState</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    <span class="hljs-comment"># ç”¨æˆ·çš„åŸå§‹éœ€æ±‚</span>
    user_request: <span class="hljs-built_in">str</span>
    <span class="hljs-comment"># Orchestrator æ‹†è§£å‡ºçš„ä»»åŠ¡è®¡åˆ’</span>
    plan: <span class="hljs-built_in">str</span>
    <span class="hljs-comment"># å¼€å‘è€…ç”Ÿæˆçš„ä»£ç </span>
    generated_code: <span class="hljs-built_in">str</span>
    <span class="hljs-comment"># å®¡æŸ¥è€…å‘ç°çš„é—®é¢˜åˆ—è¡¨</span>
    review_issues: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]
    <span class="hljs-comment"># æµ‹è¯•è€…ç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹</span>
    test_cases: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]
    <span class="hljs-comment"># æœ€ç»ˆæ±‡æ€»çš„ç»“æœ</span>
    final_report: <span class="hljs-built_in">str</span>
</code></pre>
<p>è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯ï¼š</p>
<blockquote>
<p>âæ‰€æœ‰ Agent éƒ½åœ¨è¯» / å†™åŒä¸€ä¸ªCodeReviewStateï¼Œå„è‡ªåªå…³å¿ƒè‡ªå·±è´Ÿè´£çš„é‚£ä¸€å—ã€‚</p>
</blockquote>
<h4 data-id="heading-8">4.3 å®šä¹‰ Orchestrator èŠ‚ç‚¹</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model

model = init_chat_model(model=<span class="hljs-string">"deepseek-chat"</span>, model_provider=<span class="hljs-string">"deepseek"</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">orchestrator_node</span>(<span class="hljs-params">state: CodeReviewState</span>) -&gt; CodeReviewState:
    <span class="hljs-string">"""
    - è¯» user_request
    - ç”Ÿæˆä¸€ä¸ªç®€å•çš„å¼€å‘è®¡åˆ’è¯´æ˜ï¼Œå†™å…¥ plan
    - å†³å®šåç»­åº”è¯¥è°ƒç”¨å“ªäº› Workerï¼ˆè¿™é‡Œå…ˆç®€åŒ–ï¼šå›ºå®šä¸‰ä¸ª Worker éƒ½èµ°ä¸€éï¼‰
    """</span>
    prompt = <span class="hljs-string">f"""
ä½ æ˜¯ä¸€ä¸ªæŠ€æœ¯è´Ÿè´£äººã€‚ä¸‹é¢æ˜¯ç”¨æˆ·çš„åŠŸèƒ½éœ€æ±‚ï¼Œè¯·ä½ ä»"æ•´ä½“å¼€å‘è®¡åˆ’"çš„è§’åº¦ï¼Œ
ç”¨ç®€æ´ä¸­æ–‡å†™å‡ºä¸€ä¸ªå¼€å‘ä»»åŠ¡æ‹†è§£ï¼Œé‡ç‚¹è¯´æ˜éœ€è¦åšä»€ä¹ˆï¼š

ç”¨æˆ·éœ€æ±‚ï¼š
<span class="hljs-subst">{state[<span class="hljs-string">"user_request"</span>]}</span>

è¯·è¯´æ˜ï¼š
1. éœ€è¦å®ç°å“ªäº›åŠŸèƒ½æ¨¡å—
2. éœ€è¦æ³¨æ„å“ªäº›æŠ€æœ¯è¦ç‚¹
3. éœ€è¦åšå“ªäº›æµ‹è¯•
"""</span>
    resp = model.invoke(prompt)

    state[<span class="hljs-string">"plan"</span>] = resp.content
    <span class="hljs-keyword">return</span> state
</code></pre>
<h4 data-id="heading-9">4.4 å®šä¹‰ä¸‰ä¸ª Worker èŠ‚ç‚¹</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">developer_agent</span>(<span class="hljs-params">state: CodeReviewState</span>) -&gt; CodeReviewState:
    <span class="hljs-string">"""
    å¼€å‘è€… Agentï¼šæ ¹æ®éœ€æ±‚å’Œè®¡åˆ’ç”Ÿæˆä»£ç 
    """</span>
    prompt = <span class="hljs-string">f"""
ä½ æ˜¯ä¸€ä¸ªç»éªŒä¸°å¯Œçš„ Python å¼€å‘è€…ã€‚æ ¹æ®ä»¥ä¸‹éœ€æ±‚å’Œè®¡åˆ’ï¼Œç”Ÿæˆå®Œæ•´çš„ä»£ç å®ç°ï¼š

ã€ç”¨æˆ·éœ€æ±‚ã€‘
<span class="hljs-subst">{state[<span class="hljs-string">"user_request"</span>]}</span>

ã€å¼€å‘è®¡åˆ’ã€‘
<span class="hljs-subst">{state.get(<span class="hljs-string">"plan"</span>, <span class="hljs-string">""</span>)}</span>

è¯·ç”Ÿæˆï¼š
1. å®Œæ•´çš„ä»£ç å®ç°ï¼ˆåŒ…æ‹¬å¿…è¦çš„å¯¼å…¥ã€ç±»ã€å‡½æ•°ï¼‰
2. ä»£ç æ³¨é‡Šè¦æ¸…æ™°
3. éµå¾ª Python æœ€ä½³å®è·µ
"""</span>
    resp = model.invoke(prompt)
    state[<span class="hljs-string">"generated_code"</span>] = resp.content
    <span class="hljs-keyword">return</span> state


<span class="hljs-keyword">def</span> <span class="hljs-title function_">reviewer_agent</span>(<span class="hljs-params">state: CodeReviewState</span>) -&gt; CodeReviewState:
    <span class="hljs-string">"""
    å®¡æŸ¥è€… Agentï¼šå®¡æŸ¥ä»£ç è´¨é‡ã€å®‰å…¨æ€§ã€æ€§èƒ½
    """</span>
    prompt = <span class="hljs-string">f"""
ä½ æ˜¯ä¸€ä¸ªä¸¥æ ¼çš„ä»£ç å®¡æŸ¥ä¸“å®¶ã€‚è¯·å®¡æŸ¥ä»¥ä¸‹ä»£ç ï¼Œæ‰¾å‡ºæ‰€æœ‰é—®é¢˜ï¼š

ã€ç”¨æˆ·éœ€æ±‚ã€‘
<span class="hljs-subst">{state[<span class="hljs-string">"user_request"</span>]}</span>

ã€ç”Ÿæˆçš„ä»£ç ã€‘
<span class="hljs-subst">{state.get(<span class="hljs-string">"generated_code"</span>, <span class="hljs-string">""</span>)}</span>

è¯·æ£€æŸ¥ï¼š
1. ä»£ç é€»è¾‘æ˜¯å¦æ­£ç¡®
2. æ˜¯å¦æœ‰å®‰å…¨æ¼æ´ï¼ˆSQLæ³¨å…¥ã€XSSç­‰ï¼‰
3. æ˜¯å¦æœ‰æ€§èƒ½é—®é¢˜
4. æ˜¯å¦ç¬¦åˆä»£ç è§„èŒƒ
5. æ˜¯å¦æœ‰æ½œåœ¨çš„ Bug

è¯·åˆ—å‡ºæ‰€æœ‰å‘ç°çš„é—®é¢˜ï¼ˆå¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œè¯·è¯´æ˜"ä»£ç è´¨é‡è‰¯å¥½"ï¼‰ã€‚
"""</span>
    resp = model.invoke(prompt)
    state.setdefault(<span class="hljs-string">"review_issues"</span>, [])
    <span class="hljs-comment"># ç®€å•å¤„ç†ï¼šæŠŠå®¡æŸ¥ç»“æœæŒ‰è¡Œåˆ†å‰²ï¼Œæ¯è¡Œä½œä¸ºä¸€ä¸ªé—®é¢˜</span>
    issues = [line.strip() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> resp.content.split(<span class="hljs-string">"\n"</span>) <span class="hljs-keyword">if</span> line.strip()]
    state[<span class="hljs-string">"review_issues"</span>] = issues
    <span class="hljs-keyword">return</span> state


<span class="hljs-keyword">def</span> <span class="hljs-title function_">tester_agent</span>(<span class="hljs-params">state: CodeReviewState</span>) -&gt; CodeReviewState:
    <span class="hljs-string">"""
    æµ‹è¯•è€… Agentï¼šç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
    """</span>
    prompt = <span class="hljs-string">f"""
ä½ æ˜¯ä¸€ä¸ªæµ‹è¯•ä¸“å®¶ã€‚æ ¹æ®ä»¥ä¸‹ä»£ç å’Œéœ€æ±‚ï¼Œç”Ÿæˆå®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹ï¼š

ã€ç”¨æˆ·éœ€æ±‚ã€‘
<span class="hljs-subst">{state[<span class="hljs-string">"user_request"</span>]}</span>

ã€ç”Ÿæˆçš„ä»£ç ã€‘
<span class="hljs-subst">{state.get(<span class="hljs-string">"generated_code"</span>, <span class="hljs-string">""</span>)}</span>

ã€å®¡æŸ¥å‘ç°çš„é—®é¢˜ã€‘ï¼ˆå¦‚æœ‰ï¼‰
<span class="hljs-subst">{state.get(<span class="hljs-string">"review_issues"</span>, [])}</span>

è¯·ç”Ÿæˆï¼š
1. æ­£å¸¸åœºæ™¯çš„æµ‹è¯•ç”¨ä¾‹
2. è¾¹ç•Œæ¡ä»¶çš„æµ‹è¯•ç”¨ä¾‹
3. å¼‚å¸¸æƒ…å†µçš„æµ‹è¯•ç”¨ä¾‹
4. ä½¿ç”¨ pytest æ ¼å¼ç¼–å†™æµ‹è¯•ä»£ç 
"""</span>
    resp = model.invoke(prompt)
    state.setdefault(<span class="hljs-string">"test_cases"</span>, [])
    <span class="hljs-comment"># ç®€å•å¤„ç†ï¼šæŠŠæµ‹è¯•ç”¨ä¾‹æŒ‰å—åˆ†å‰²</span>
    test_blocks = resp.content.split(<span class="hljs-string">"\n\n"</span>)
    state[<span class="hljs-string">"test_cases"</span>] = [block.strip() <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> test_blocks <span class="hljs-keyword">if</span> block.strip()]
    <span class="hljs-keyword">return</span> state
</code></pre>
<h4 data-id="heading-10">4.5 æ±‡æ€»ç»“æœçš„èŠ‚ç‚¹</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">summarize_report</span>(<span class="hljs-params">state: CodeReviewState</span>) -&gt; CodeReviewState:
    <span class="hljs-string">"""
    æ±‡æ€»æ‰€æœ‰ç»“æœï¼Œç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š
    """</span>
    prompt = <span class="hljs-string">f"""
ä½ æ˜¯æŠ€æœ¯è´Ÿè´£äººï¼Œè¯·æ ¹æ®ä»¥ä¸‹ä»£ç å®¡æŸ¥ç»“æœï¼Œç”Ÿæˆä¸€ä»½å®Œæ•´çš„æŠ¥å‘Šï¼š

ã€ç”¨æˆ·éœ€æ±‚ã€‘
<span class="hljs-subst">{state[<span class="hljs-string">"user_request"</span>]}</span>

ã€å¼€å‘è®¡åˆ’ã€‘
<span class="hljs-subst">{state.get(<span class="hljs-string">"plan"</span>, <span class="hljs-string">""</span>)}</span>

ã€ç”Ÿæˆçš„ä»£ç ã€‘
<span class="hljs-subst">{state.get(<span class="hljs-string">"generated_code"</span>, <span class="hljs-string">""</span>)}</span>

ã€å®¡æŸ¥å‘ç°çš„é—®é¢˜ã€‘
<span class="hljs-subst">{state.get(<span class="hljs-string">"review_issues"</span>, [])}</span>

ã€æµ‹è¯•ç”¨ä¾‹ã€‘
<span class="hljs-subst">{state.get(<span class="hljs-string">"test_cases"</span>, [])}</span>

è¯·ç”Ÿæˆä¸€ä»½é¢å‘æŠ€æœ¯å›¢é˜Ÿçš„æ±‡æŠ¥ï¼ŒåŒ…æ‹¬ï¼š
1. åŠŸèƒ½å®ç°æ€»ç»“
2. ä»£ç è´¨é‡è¯„ä¼°
3. å‘ç°çš„é—®é¢˜å’Œå»ºè®®
4. æµ‹è¯•è¦†ç›–æƒ…å†µ
"""</span>
    resp = model.invoke(prompt)
    state[<span class="hljs-string">"final_report"</span>] = resp.content
    <span class="hljs-keyword">return</span> state
</code></pre>
<h4 data-id="heading-11">4.6 ç”¨ StateGraph ä¸²èµ·æ¥ï¼šOrchestrator-Worker æµç¨‹</h4>
<pre><code class="hljs language-python" lang="python">builder = StateGraph(CodeReviewState)

builder.add_node(<span class="hljs-string">"orchestrator"</span>, orchestrator_node)
builder.add_node(<span class="hljs-string">"developer"</span>, developer_agent)
builder.add_node(<span class="hljs-string">"reviewer"</span>, reviewer_agent)
builder.add_node(<span class="hljs-string">"tester"</span>, tester_agent)
builder.add_node(<span class="hljs-string">"summarize"</span>, summarize_report)

<span class="hljs-comment"># æµç¨‹ï¼šæ€»æ§ â†’ å¼€å‘è€… â†’ å®¡æŸ¥è€… â†’ æµ‹è¯•è€… â†’ æ±‡æ€»</span>
builder.add_edge(START, <span class="hljs-string">"orchestrator"</span>)
builder.add_edge(<span class="hljs-string">"orchestrator"</span>, <span class="hljs-string">"developer"</span>)
builder.add_edge(<span class="hljs-string">"developer"</span>, <span class="hljs-string">"reviewer"</span>)
builder.add_edge(<span class="hljs-string">"reviewer"</span>, <span class="hljs-string">"tester"</span>)
builder.add_edge(<span class="hljs-string">"tester"</span>, <span class="hljs-string">"summarize"</span>)
builder.add_edge(<span class="hljs-string">"summarize"</span>, END)

graph = builder.<span class="hljs-built_in">compile</span>()
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">config = {<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"code-review-1"</span>}}

result = graph.invoke(
    {<span class="hljs-string">"user_request"</span>: <span class="hljs-string">"å®ç°ä¸€ä¸ªç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨æˆ·åå¯†ç éªŒè¯å’Œ JWT token ç”Ÿæˆ"</span>},
    config
)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"æœ€ç»ˆæŠ¥å‘Šï¼š"</span>)
<span class="hljs-built_in">print</span>(result[<span class="hljs-string">"final_report"</span>])
</code></pre>
<blockquote>
<p>âè¿™é‡Œçš„ä¾‹å­åˆ»æ„ä¿æŒ"ç»“æ„æ¸…æ™° + æ˜“æ‡‚"ï¼Œå®é™…é¡¹ç›®å¯ä»¥ç»“åˆæ¡ä»¶è¾¹ï¼Œè®© Orchestrator æ ¹æ®éœ€æ±‚åŠ¨æ€å†³å®šè°ƒç”¨å“ªäº› Workerï¼Œæˆ–è€…è®©å®¡æŸ¥è€…å‘ç°é—®é¢˜æ—¶è§¦å‘å¼€å‘è€…é‡å†™ã€‚</p>
</blockquote>
<h3 data-id="heading-12">5. å®æˆ˜äºŒï¼šEvaluator-Optimizer æ¨¡å¼</h3>
<p>çœ‹å®Œä»»åŠ¡åˆ†é…æ‰§è¡Œæ¨¡å¼ï¼Œå’±ä»¬å†æ¥çœ‹çœ‹å¦ä¸€ç§ç»å…¸æ¨¡å¼â€”â€”è¯„ä¼°è¿­ä»£æ¨¡å¼ã€‚</p>
<p>ç¬¬äºŒç§å¸¸è§æ¨¡å¼ï¼Œæ˜¯è®©ä¸€ä¸ª Agent è´Ÿè´£<strong>ç”Ÿæˆ</strong>ï¼Œå¦ä¸€ä¸ª Agent è´Ÿè´£<strong>è¯„ä¼° / æ‰¾é—®é¢˜ / æ‰“å›é‡å†™</strong>ï¼š</p>
<blockquote>
<p>âåœ¨ä»£ç å®¡æŸ¥åœºæ™¯ä¸­ï¼Œå¼€å‘è€… Agent è´Ÿè´£å†™ä»£ç ï¼Œå®¡æŸ¥è€… Agent è´Ÿè´£æ‰¾é—®é¢˜ï¼Œå‘ç°é—®é¢˜å°±è®©å¼€å‘è€…é‡å†™ã€‚</p>
</blockquote>
<h4 data-id="heading-13">5.1 å…¸å‹åœºæ™¯ï¼šä»£ç å®¡æŸ¥è¿­ä»£</h4>
<ul>
<li><strong>å¼€å‘è€… Agent</strong>ï¼šæ ¹æ®éœ€æ±‚ç”Ÿæˆä»£ç </li>
<li><strong>å®¡æŸ¥è€… Agent</strong>ï¼šå®¡æŸ¥ä»£ç è´¨é‡ã€å®‰å…¨æ€§ã€æ€§èƒ½ï¼Œå‘ç°é—®é¢˜å°±è¦æ±‚é‡å†™</li>
<li><strong>å¾ªç¯è¿­ä»£</strong>ï¼šç›´åˆ°å®¡æŸ¥é€šè¿‡ï¼Œæˆ–è€…è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°</li>
</ul>
<p>è¿™ç§æ¨¡å¼ç‰¹åˆ«é€‚åˆä»£ç å®¡æŸ¥ï¼Œå› ä¸ºï¼š</p>
<ul>
<li>ä»£ç è´¨é‡éœ€è¦ä¸¥æ ¼æŠŠå…³ï¼Œä¸èƒ½ä¸€æ¬¡é€šè¿‡å°±ç»“æŸ</li>
<li>å®¡æŸ¥è€…å‘ç°çš„é—®é¢˜éœ€è¦å¼€å‘è€…çœŸæ­£ä¿®å¤ï¼Œè€Œä¸æ˜¯"å‡è£…ä¿®å¤"</li>
<li>æ¯æ¬¡è¿­ä»£éƒ½å¯ä»¥çœ‹åˆ°ä»£ç çš„æ”¹è¿›è¿‡ç¨‹</li>
</ul>
<h4 data-id="heading-14">5.2 å®šä¹‰çŠ¶æ€ç»“æ„</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Literal</span>


<span class="hljs-keyword">class</span> <span class="hljs-title class_">CodeReviewIterState</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    request: <span class="hljs-built_in">str</span>              <span class="hljs-comment"># ç”¨æˆ·çš„åŸå§‹éœ€æ±‚</span>
    code: <span class="hljs-built_in">str</span>                <span class="hljs-comment"># å½“å‰ç‰ˆæœ¬çš„ä»£ç </span>
    review_feedback: <span class="hljs-built_in">str</span>     <span class="hljs-comment"># å®¡æŸ¥è€…çš„åé¦ˆæ„è§</span>
    status: <span class="hljs-type">Literal</span>[<span class="hljs-string">"pending"</span>, <span class="hljs-string">"approved"</span>, <span class="hljs-string">"rejected"</span>]  <span class="hljs-comment"># å®¡æŸ¥çŠ¶æ€</span>
    iterations: <span class="hljs-built_in">int</span>         <span class="hljs-comment"># å·²é‡å†™æ¬¡æ•°</span>
    all_reviews: <span class="hljs-built_in">list</span>        <span class="hljs-comment"># å†å²æ‰€æœ‰å®¡æŸ¥æ„è§ï¼ˆå¯é€‰ï¼Œç”¨äºè¿½è¸ªï¼‰</span>
</code></pre>
<h4 data-id="heading-15">5.3 ç”Ÿæˆ Agentï¼šdeveloper_node</h4>
<pre><code class="hljs language-python" lang="python">MAX_ITER = <span class="hljs-number">3</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">developer_node</span>(<span class="hljs-params">state: CodeReviewIterState</span>) -&gt; CodeReviewIterState:
    <span class="hljs-string">"""
    å¼€å‘è€… Agentï¼šæ ¹æ®éœ€æ±‚å’Œå®¡æŸ¥æ„è§ç”Ÿæˆ/é‡å†™ä»£ç 
    """</span>
    prompt = <span class="hljs-string">f"""
ä½ æ˜¯ä¸€ä¸ªç»éªŒä¸°å¯Œçš„ Python å¼€å‘è€…ã€‚æ ¹æ®ä»¥ä¸‹éœ€æ±‚ç”Ÿæˆä»£ç ã€‚
å¦‚æœæœ‰ä¹‹å‰çš„å®¡æŸ¥æ„è§ï¼Œè¯·åœ¨æ–°ä»£ç ä¸­ä¿®å¤æ‰€æœ‰é—®é¢˜ã€‚

ã€ç”¨æˆ·éœ€æ±‚ã€‘
<span class="hljs-subst">{state[<span class="hljs-string">"request"</span>]}</span>

ã€ä¹‹å‰å®¡æŸ¥æ„è§ã€‘ï¼ˆå¦‚æœ‰ï¼‰
<span class="hljs-subst">{state.get(<span class="hljs-string">"review_feedback"</span>, <span class="hljs-string">"æ— ï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¡ç”Ÿæˆä»£ç "</span>)}</span>

è¯·ç”Ÿæˆï¼š
1. å®Œæ•´çš„ä»£ç å®ç°ï¼ˆåŒ…æ‹¬å¿…è¦çš„å¯¼å…¥ã€ç±»ã€å‡½æ•°ï¼‰
2. ä»£ç æ³¨é‡Šè¦æ¸…æ™°
3. éµå¾ª Python æœ€ä½³å®è·µ
4. å¦‚æœä¹‹å‰æœ‰å®¡æŸ¥æ„è§ï¼Œè¯·ç¡®ä¿æ‰€æœ‰é—®é¢˜éƒ½å·²ä¿®å¤
"""</span>
    resp = model.invoke(prompt)
    state[<span class="hljs-string">"code"</span>] = resp.content
    state[<span class="hljs-string">"status"</span>] = <span class="hljs-string">"pending"</span>
    state[<span class="hljs-string">"iterations"</span>] = state.get(<span class="hljs-string">"iterations"</span>, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>
    
    <span class="hljs-comment"># è®°å½•å†å²å®¡æŸ¥æ„è§ï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-keyword">if</span><span class="hljs-string">"review_feedback"</span><span class="hljs-keyword">in</span> state <span class="hljs-keyword">and</span> state[<span class="hljs-string">"review_feedback"</span>]:
        state.setdefault(<span class="hljs-string">"all_reviews"</span>, [])
        state[<span class="hljs-string">"all_reviews"</span>].append(state[<span class="hljs-string">"review_feedback"</span>])
    
    <span class="hljs-keyword">return</span> state
</code></pre>
<h4 data-id="heading-16">5.4 è¯„ä¼° Agentï¼šreviewer_node</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">reviewer_node</span>(<span class="hljs-params">state: CodeReviewIterState</span>) -&gt; CodeReviewIterState:
    <span class="hljs-string">"""
    å®¡æŸ¥è€… Agentï¼šä¸¥æ ¼å®¡æŸ¥ä»£ç ï¼Œå‘ç°é—®é¢˜å°±è¦æ±‚é‡å†™
    """</span>
    prompt = <span class="hljs-string">f"""
ä½ æ˜¯ä¸€ä¸ªä¸¥æ ¼çš„ä»£ç å®¡æŸ¥ä¸“å®¶ã€‚è¯·å®¡æŸ¥ä»¥ä¸‹ä»£ç ï¼š

ã€ç”¨æˆ·éœ€æ±‚ã€‘
<span class="hljs-subst">{state[<span class="hljs-string">"request"</span>]}</span>

ã€å½“å‰ä»£ç ã€‘
<span class="hljs-subst">{state[<span class="hljs-string">"code"</span>]}</span>

ã€å·²é‡å†™æ¬¡æ•°ã€‘
<span class="hljs-subst">{state.get(<span class="hljs-string">"iterations"</span>, <span class="hljs-number">0</span>)}</span>

è¯·æ£€æŸ¥ï¼š
1. ä»£ç é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼Œæ˜¯å¦æ»¡è¶³éœ€æ±‚
2. æ˜¯å¦æœ‰å®‰å…¨æ¼æ´ï¼ˆSQLæ³¨å…¥ã€XSSã€å¯†ç æ˜æ–‡å­˜å‚¨ç­‰ï¼‰
3. æ˜¯å¦æœ‰æ€§èƒ½é—®é¢˜ï¼ˆN+1æŸ¥è¯¢ã€æœªä½¿ç”¨ç´¢å¼•ç­‰ï¼‰
4. æ˜¯å¦ç¬¦åˆä»£ç è§„èŒƒï¼ˆå‘½åã€æ³¨é‡Šã€ç»“æ„ç­‰ï¼‰
5. æ˜¯å¦æœ‰æ½œåœ¨çš„ Bugï¼ˆè¾¹ç•Œæ¡ä»¶ã€å¼‚å¸¸å¤„ç†ç­‰ï¼‰

è¯·ç»™å‡ºå®¡æŸ¥ç»“æœï¼š
- å¦‚æœä»£ç è´¨é‡è‰¯å¥½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œè¯·å›ç­”ï¼š"APPROVED: ä»£ç è´¨é‡è‰¯å¥½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨"
- å¦‚æœå‘ç°é—®é¢˜ï¼Œè¯·å›ç­”ï¼š"REJECTED: [å…·ä½“é—®é¢˜åˆ—è¡¨ï¼Œæ¯ä¸ªé—®é¢˜ä¸€è¡Œ]"

è¯·ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ ¼å¼å›ç­”ã€‚
"""</span>
    resp = model.invoke(prompt)
    content = resp.content

    state[<span class="hljs-string">"review_feedback"</span>] = content

    <span class="hljs-comment"># è§£æå®¡æŸ¥ç»“æœï¼šåŒ…å« "APPROVED" å°±è§†ä¸ºé€šè¿‡</span>
    <span class="hljs-keyword">if</span><span class="hljs-string">"APPROVED"</span><span class="hljs-keyword">in</span> content.upper():
        state[<span class="hljs-string">"status"</span>] = <span class="hljs-string">"approved"</span>
    <span class="hljs-keyword">else</span>:
        state[<span class="hljs-string">"status"</span>] = <span class="hljs-string">"rejected"</span>

    <span class="hljs-keyword">return</span> state
</code></pre>
<h4 data-id="heading-17">5.5 æ¡ä»¶è¾¹ï¼šç»§ç»­é‡å†™è¿˜æ˜¯ç»“æŸï¼Ÿ</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> StateGraph, START, END

builder = StateGraph(CodeReviewIterState)
builder.add_node(<span class="hljs-string">"developer"</span>, developer_node)
builder.add_node(<span class="hljs-string">"reviewer"</span>, reviewer_node)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">should_rewrite</span>(<span class="hljs-params">state: CodeReviewIterState</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""
    åˆ¤æ–­æ˜¯å¦éœ€è¦é‡å†™ï¼š
    - å®¡æŸ¥é€šè¿‡ â†’ ç»“æŸ
    - å®¡æŸ¥ä¸é€šè¿‡ + æœªè¾¾æœ€å¤§è¿­ä»£æ¬¡æ•° â†’ é‡å†™
    - è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•° â†’ ç»“æŸï¼ˆå³ä½¿æœªé€šè¿‡ï¼‰
    """</span>
    <span class="hljs-keyword">if</span> state[<span class="hljs-string">"status"</span>] == <span class="hljs-string">"approved"</span>:
        <span class="hljs-keyword">return</span><span class="hljs-string">"end"</span>
    
    <span class="hljs-keyword">if</span> state.get(<span class="hljs-string">"iterations"</span>, <span class="hljs-number">0</span>) &gt;= MAX_ITER:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·²è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•° <span class="hljs-subst">{MAX_ITER}</span>ï¼Œåœæ­¢é‡å†™"</span>)
        <span class="hljs-keyword">return</span><span class="hljs-string">"end"</span>
    
    <span class="hljs-keyword">return</span><span class="hljs-string">"rewrite"</span>


builder.add_edge(START, <span class="hljs-string">"developer"</span>)
builder.add_edge(<span class="hljs-string">"developer"</span>, <span class="hljs-string">"reviewer"</span>)
builder.add_conditional_edges(
    <span class="hljs-string">"reviewer"</span>,
    should_rewrite,
    {
        <span class="hljs-string">"rewrite"</span>: <span class="hljs-string">"developer"</span>,  <span class="hljs-comment"># å›åˆ°å¼€å‘è€…é‡å†™</span>
        <span class="hljs-string">"end"</span>: END,              <span class="hljs-comment"># ç»“æŸæµç¨‹</span>
    },
)

graph = builder.<span class="hljs-built_in">compile</span>()
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">config = {<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"code-review-iter-1"</span>}}

result = graph.invoke(
    {
        <span class="hljs-string">"request"</span>: <span class="hljs-string">"å®ç°ä¸€ä¸ªç”¨æˆ·ç™»å½•åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨æˆ·åå¯†ç éªŒè¯å’Œ JWT token ç”Ÿæˆ"</span>,
        <span class="hljs-string">"code"</span>: <span class="hljs-string">""</span>,
        <span class="hljs-string">"review_feedback"</span>: <span class="hljs-string">""</span>,
        <span class="hljs-string">"status"</span>: <span class="hljs-string">"pending"</span>,
        <span class="hljs-string">"iterations"</span>: <span class="hljs-number">0</span>,
    },
    config
)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æœ€ç»ˆçŠ¶æ€ï¼š<span class="hljs-subst">{result[<span class="hljs-string">'status'</span>]}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¿­ä»£æ¬¡æ•°ï¼š<span class="hljs-subst">{result[<span class="hljs-string">'iterations'</span>]}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næœ€ç»ˆä»£ç ï¼š\n<span class="hljs-subst">{result[<span class="hljs-string">'code'</span>]}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næœ€åå®¡æŸ¥æ„è§ï¼š\n<span class="hljs-subst">{result[<span class="hljs-string">'review_feedback'</span>]}</span>"</span>)
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-text" lang="text">æœ€ç»ˆçŠ¶æ€ï¼šapproved
è¿­ä»£æ¬¡æ•°ï¼š2

æœ€ç»ˆä»£ç ï¼š
[ç”Ÿæˆçš„ä»£ç ...]

æœ€åå®¡æŸ¥æ„è§ï¼š
APPROVED: ä»£ç è´¨é‡è‰¯å¥½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨
</code></pre>
<blockquote>
<p>âè¿™ä¸ªæ¨¡å¼çš„å…³é”®ç‚¹åœ¨äºï¼š<strong>è®©"è¯„ä¼° / ä¿®æ­£"æˆä¸ºå›¾çš„ä¸€ç­‰å…¬æ°‘èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯å†™åœ¨ Prompt é‡Œä¸€å¥"è¯·è‡ªå·±æ£€æŸ¥å¹¶ä¿®æ­£"</strong>ã€‚è¿™æ ·æ¯æ¬¡è¿­ä»£éƒ½å¯è§‚æµ‹ã€å¯è®¡æ•°ã€å¯æ‰“æ–­ã€å¯è°ƒå‚ä¸ä¼˜åŒ–ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä½ è¿˜å¯ä»¥åœ¨å®¡æŸ¥è€…èŠ‚ç‚¹ä¸­åŠ å…¥æ›´å¤šæ£€æŸ¥å·¥å…·ï¼ˆå¦‚é™æ€ä»£ç åˆ†æã€å®‰å…¨æ‰«æç­‰ï¼‰ï¼Œè®©å®¡æŸ¥æ›´ä¸¥æ ¼ã€æ›´å¯é ã€‚</p>
</blockquote>
<h3 data-id="heading-18">6. Multi-Agent é‡Œçš„å‡ ä¸ªå®è·µå»ºè®®</h3>
<p>èŠå®Œä¸¤ç§ç»å…¸æ¨¡å¼ï¼Œå’±ä»¬æ¥èŠèŠå¤šä»£ç†ç³»ç»Ÿçš„å·¥ç¨‹å®è·µå»ºè®®ã€‚</p>
<h4 data-id="heading-19">6.1 æ ¸å¿ƒå®è·µåŸåˆ™</h4>
<p><strong>æ§åˆ¶ä»£ç†æ•°é‡å’Œè°ƒç”¨æ·±åº¦</strong>ï¼š</p>
<ul>
<li>å¤šä¸€ä¸ª Agentï¼Œå°±å¤šä¸€å±‚è°ƒç”¨å’Œå¿ƒæ™ºè´Ÿæ‹…ï¼›</li>
<li>å¼€å‘æ—©æœŸä»**2 ä¸ª Agentï¼ˆå¦‚ Orchestrator + ä¸€ä¸ª Worker æˆ– Evaluatorï¼‰**å¼€å§‹ï¼›</li>
<li>åªæœ‰å½“ä¸€ä¸ª Agent èŒè´£æ˜æ˜¾è¿‡é‡æ—¶ï¼Œå†æ‹†åˆ†å‡ºæ–°çš„ Agentã€‚</li>
</ul>
<p><strong>æ˜ç¡®è¾“å…¥/è¾“å‡ºè´£ä»»</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ª Agent<strong>åªè¯»/å†™è‡ªå·±è´Ÿè´£çš„é‚£éƒ¨åˆ†å­—æ®µ</strong>ï¼›</li>
<li>ä¸è¦æ‰€æœ‰ Agent éƒ½éšæ„å¾€åŒä¸€ä¸ªå¤§å­—æ®µé‡Œå¡å†…å®¹ï¼›</li>
<li>å¯ä»¥ç”¨å‘½åç©ºé—´é£æ ¼çš„å­—æ®µï¼š<code>planning_*</code>ã€<code>execution_*</code>ã€<code>review_*</code>ã€‚</li>
</ul>
<h4 data-id="heading-20">6.2 æ€§èƒ½ä¸æˆæœ¬ä¼˜åŒ–</h4>
<p><strong>å¹¶è¡Œæ‰§è¡Œ</strong>ï¼š</p>
<ul>
<li>å¯¹ç‹¬ç«‹ä»»åŠ¡ï¼ˆå¦‚ä»£ç å®¡æŸ¥å’Œæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆï¼‰ï¼Œä½¿ç”¨<code>add_edge</code>å®ç°å¤š Worker å¹¶è¡Œè¿è¡Œï¼Œç¼©çŸ­æ€»è€—æ—¶ã€‚</li>
</ul>
<p><strong>æˆæœ¬æ§åˆ¶</strong>ï¼š</p>
<ul>
<li><strong>æŒ‰éœ€è°ƒç”¨</strong>ï¼šç”¨æ¡ä»¶è¾¹åˆ¤æ–­æ˜¯å¦éœ€è¦è§¦å‘æŸä¸ª Workerï¼›</li>
<li><strong>æ¨¡å‹å·®å¼‚åŒ–</strong>ï¼šä¸åŒ Agent ä½¿ç”¨ä¸åŒèƒ½åŠ›çš„æ¨¡å‹ï¼›</li>
<li><strong>ç¼“å­˜æœºåˆ¶</strong>ï¼šå¯¹é‡å¤ä»»åŠ¡çš„ä¸­é—´ç»“æœè¿›è¡Œç¼“å­˜ï¼›</li>
<li><strong>è¿­ä»£é™åˆ¶</strong>ï¼šè®¾ç½®æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œé˜²æ­¢æ— é™å¾ªç¯ã€‚</li>
</ul>
<h3 data-id="heading-21">7. Multi-Agent vs. å¼ºåŒ–å• Agentï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ</h3>
<p>å¾ˆå¤šäººä¼šé—®ï¼š<strong>â€œæˆ‘åˆ°åº•åº”è¯¥åšå¤šä»£ç†ï¼Œè¿˜æ˜¯ç»§ç»­å¢å¼ºä¸€ä¸ªå¤§ Agentï¼Ÿâ€</strong></p>
<p>å¯ä»¥å‚è€ƒä¸‹é¢å‡ æ¡ç»éªŒï¼š</p>
<ul>
<li>å¦‚æœé—®é¢˜ä¸»è¦æ˜¯<strong>èƒ½åŠ›ä¸å¤Ÿ / å·¥å…·ä¸å¤Ÿ</strong>â†’ å…ˆè¡¥å·¥å…·ã€è¡¥è®°å¿†ã€è¡¥è·¯ç”±ï¼Œè€Œä¸æ˜¯é©¬ä¸Šä¸Šå¤šä»£ç†ï¼›</li>
<li>å¦‚æœé—®é¢˜ä¸»è¦æ˜¯<strong>èŒè´£å¤ªæ‚ / Prompt éš¾ä»¥ç»´æŠ¤</strong>â†’ å€¾å‘äºæ‹†æˆå¤šä¸ª Agentï¼Œå„å¸å…¶èŒï¼›</li>
<li>å¦‚æœä½ å‘ç°ï¼š</li>
</ul>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p>âç”¨å¤šä»£ç†è§£å†³â€œç»“æ„åŒ–åä½œâ€çš„é—®é¢˜ï¼Œä¸è¦ç”¨å¤šä»£ç†ç¡¬æŠ—â€œæ¨¡å‹èƒ½åŠ›ä¸è¶³â€ã€‚</p>
</blockquote>
<h3 data-id="heading-22">8. å°ç»“</h3>
<p>æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ul>
<li><strong>è§’è‰²åˆ’åˆ†</strong>ï¼šOrchestratorï¼ˆæ€»æ§ï¼‰ã€Workerï¼ˆæ‰§è¡Œï¼‰ã€Evaluatorï¼ˆè¯„ä¼°ï¼‰å„å¸å…¶èŒ</li>
<li><strong>æŠ€æœ¯æ ¸å¿ƒ</strong>ï¼šé€šè¿‡å…±äº« Stateã€æ¡ä»¶è¾¹å’Œå­å›¾æ­å»ºå¤šä»£ç†ç³»ç»Ÿ</li>
<li><strong>ç»å…¸æ¨¡å¼</strong>ï¼šOrchestrator-Workerï¼ˆä»»åŠ¡åˆ†é…æ‰§è¡Œï¼‰å’Œ Evaluator-Optimizerï¼ˆè¯„ä¼°è¿­ä»£ï¼‰</li>
<li><strong>è½åœ°ç­–ç•¥</strong>ï¼šä»»åŠ¡å¯æ‹†åˆ†ã€éœ€è¦å¤šè½®è¿­ä»£ã€èƒ½åŠ›éœ€æ±‚å·®å¼‚å¤§æ—¶é€‚åˆå¼•å…¥å¤šä»£ç†</li>
</ul>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„å®è·µç»éªŒï¼Œå’±ä»¬ä¸€èµ·äº¤æµå¤šä»£ç†ç³»ç»Ÿçš„æ›´å¤šç©æ³•ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaç¨‹åºå‘˜å¿…åšé¡¹ç›®ï¼åŸºäºLangChainå®ç°çš„ReActæ™ºèƒ½ä½“é¡¹ç›®ã€‚åŠ©ä½ æ‹¿offerï¼ï¼ˆç¬¬äºŒæœŸï¼‰]]></title>    <link>https://juejin.cn/post/7602846823326007331</link>    <guid>https://juejin.cn/post/7602846823326007331</guid>    <pubDate>2026-02-05T01:39:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602846823326007331" data-draft-id="7602837527674585103" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaç¨‹åºå‘˜å¿…åšé¡¹ç›®ï¼åŸºäºLangChainå®ç°çš„ReActæ™ºèƒ½ä½“é¡¹ç›®ã€‚åŠ©ä½ æ‹¿offerï¼ï¼ˆç¬¬äºŒæœŸï¼‰"/> <meta itemprop="keywords" content="åç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-02-05T01:39:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ„Ÿæ€§çš„ç¨‹åºå‘˜å°ç‹"/> <meta itemprop="url" content="https://juejin.cn/user/1915806770272506"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaç¨‹åºå‘˜å¿…åšé¡¹ç›®ï¼åŸºäºLangChainå®ç°çš„ReActæ™ºèƒ½ä½“é¡¹ç›®ã€‚åŠ©ä½ æ‹¿offerï¼ï¼ˆç¬¬äºŒæœŸï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1915806770272506/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ„Ÿæ€§çš„ç¨‹åºå‘˜å°ç‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:39:15.000Z" title="Thu Feb 05 2026 01:39:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">5ã€å¼€å‘åŸºäºLangChainå®ç°çš„ReAct AIæ™ºèƒ½ä½“</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯¹ langchain æ¡†æ¶åšäº†ä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹å¼€å‘ï¼ï¼</p>
<p>é¦–å…ˆåœ¨å½“å‰é¡¹ç›®çš„æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªåŒ…ï¼ˆæ–‡ä»¶å¤¹ï¼‰,åå­—å«åš agent <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b73556e79dbb451a83f0056617d9ce23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860354&amp;x-signature=rJrio3m6nfK%2FvgKue%2FC2W37EmeQ%3D" alt="" loading="lazy"/> å¹¶æ–°å»º<strong>ai_client.py</strong>æ–‡ä»¶ <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea4a5aa4a49c4237b82faee7303e85e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860354&amp;x-signature=4rdIIJU2E3aq0Dhqk0ju%2BrwuH6g%3D" alt="" loading="lazy"/> ç”¨æ¥å†™æ ¸å¿ƒçš„ agent ä»£ç ï¼ŒåŒæ—¶åœ¨é¡¹ç›®çš„æ ¹ç›®å½•æ–°å»º<strong>config.py</strong>æ–‡ä»¶ç”¨äºå®šä¹‰ç›¸å…³çš„é…ç½®</p>
<p>ä»¥ä¸‹æ˜¯é…ç½®æ–‡ä»¶å®Œæ•´å†…å®¹</p>
<pre><code class="hljs language-ini" lang="ini">  import os
â€‹
try:
 Â   from dotenv import load_dotenv
 Â   load_dotenv()
except Exception:
 Â   pass
<span class="hljs-comment"># æ¨¡å‹åç§°</span>
<span class="hljs-attr">MODEL</span> = <span class="hljs-string">"qwen-plus"</span>
<span class="hljs-comment"># apikey</span>
<span class="hljs-attr">DASHSCOPE_API_KEY</span> = <span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>
<span class="hljs-comment"># æ¸©åº¦ç³»æ•°</span>
<span class="hljs-attr">TEMPERATURE</span> = <span class="hljs-number">0.7</span>
â€‹
<span class="hljs-comment"># æœ¬åœ°çŸ¥è¯†æ–‡æ¡£è·¯å¾„</span>
<span class="hljs-attr">DOC_DIR</span> = <span class="hljs-string">"/Users/fenghuanwang/PythonProject/langchain-test/doc"</span>
<span class="hljs-comment"># å‘é‡æ•°æ®å­˜æ”¾è·¯å¾„</span>
<span class="hljs-attr">EMBEDDINGS_DIR</span> = <span class="hljs-string">"./embeddings"</span>
<span class="hljs-comment"># æ–‡æ¡£åº“åç§°</span>
<span class="hljs-attr">COLLECTION_NAME</span> = <span class="hljs-string">"java_docs"</span>
â€‹
</code></pre>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ç¼–å†™<strong>ai_client.py</strong>ä¸­çš„æ ¸å¿ƒä»£ç </p>
<p>é¦–å…ˆå®šä¹‰ llmï¼ŒåŒ…æ‹¬æ¨¡å‹åç§° apikey ç­‰ï¼Œè¿™äº›æˆ‘ä»¬ä»åˆšæ‰å®šä¹‰çš„é…ç½®æ–‡ä»¶ä¸­è·å–</p>
<pre><code class="hljs language-ini" lang="ini">from langchain_community.chat_models import ChatTongyi
 Â  Â import config
 Â  Â <span class="hljs-comment"># æ³¨å…¥ DashScope API Key</span>
 Â if config.DASHSCOPE_API_KEY:
 Â  Â  Â os.environ<span class="hljs-section">["DASHSCOPE_API_KEY"]</span> = config.DASHSCOPE_API_KEY
<span class="hljs-comment"># è¿™é‡Œä½¿ç”¨é˜¿é‡Œäº‘çš„tongyiç³»åˆ—æ¨¡å‹</span>
<span class="hljs-attr">llm</span> = ChatTongyi(
 Â  Â <span class="hljs-attr">model</span>=config.MODEL,
 Â  Â <span class="hljs-attr">temperature</span>=config.TEMPERATURE,
)
</code></pre>
<h4 data-id="heading-1">1ã€åŠ è½½çŸ¥è¯†æ–‡æ¡£</h4>
<p>å®šä¹‰å¥½ llm ä¹‹åï¼Œä¸ºäº†è®© llm å›ç­”çš„æ›´ç²¾ç¡®ï¼Œæˆ‘ä»¬ä½¿ç”¨çŸ¥è¯†åº“ï¼Œå¢åŠ  llm çš„çŸ¥è¯†é‡</p>
<pre><code class="hljs language-ini" lang="ini"> Â <span class="hljs-comment"># ========== çŸ¥è¯†åº“ï¼šåŠ è½½ TXT / MD / PDF ==========</span>
 Â from langchain_community.document_loaders import DirectoryLoader, TextLoader, PyPDFLoader
<span class="hljs-attr">all_docs</span> = []
try:
 Â  Â <span class="hljs-attr">txt_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.txt"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">md_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.md"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">pdf_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.pdf"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=PyPDFLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">all_docs</span> = (txt_docs or []) + (md_docs or []) + (pdf_docs or [])
except Exception as e:
 Â  Â print(f"æ–‡æ¡£åŠ è½½å¤±è´¥: {e}")
 Â  Â <span class="hljs-attr">all_docs</span> = []
python
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåˆ—è¡¨ï¼Œç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„æ–‡æ¡£ï¼Œå¹¶ä½¿ç”¨ç›®å½•åŠ è½½å™¨ä»¥åŠ pdf åŠ è½½å™¨ï¼Œæ–‡æœ¬åŠ è½½å™¨ç­‰æ–‡æ¡£åŠ è½½å™¨ï¼Œç”¨æ¥åŠ è½½çŸ¥è¯†åº“ç›®å½•ä¸‹çš„æ‰€æœ‰çš„æ–‡æ¡£ï¼ŒåŒæ ·çŸ¥è¯†åº“çš„è·¯å¾„æ˜¯ä»é…ç½®æ–‡ä»¶ä¸­è·å–ï¼Œå¹¶è¿›è¡Œå¼‚å¸¸æ•è·ã€‚</p>
<p>å‚æ•°è§£é‡Šï¼š ä»¥<strong>txt_docs</strong>ä¸ºä¾‹ï¼Œ</p>
<pre><code class="hljs language-ini" lang="ini"> Â <span class="hljs-comment"># ä½¿ç”¨ç›®å½•åŠ è½½å™¨ï¼Œè°ƒç”¨å®ƒçš„æ„é€ å‡½æ•°</span>
 Â  <span class="hljs-attr">txt_docs</span> = DirectoryLoader(
 Â  Â  <span class="hljs-comment"># æŒ‡å®šè¦åŠ è½½çš„ç›®å½•è·¯å¾„</span>
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-comment"># è¦åŠ è½½è¯¥ç›®å½•ä¸‹çš„txtç±»å‹çš„æ–‡ä»¶</span>
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.txt"</span>,
 Â  Â  Â  Â <span class="hljs-comment"># ä½¿ç”¨æ–‡æœ¬æ–‡æ¡£åŠ è½½å™¨</span>
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-comment"># æ˜¾ç¤ºåŠ è½½è¿›åº¦æ¡ï¼Œè¿™é‡Œéœ€è¦é…åˆä¸Šé¢æåˆ°çš„ä¸€ä¸ªåº“ä½¿ç”¨ï¼Œå¦‚æœä¸éœ€è¦çš„è¯ç›´æ¥è®¾ç½®ä¸ºFalse</span>
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-comment"># ä½¿ç”¨å¤šçº¿ç¨‹åŠ è½½</span>
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-comment"># é‡åˆ°é”™è¯¯ç›´æ¥è·³è¿‡ï¼Œå¹¶ç»§ç»­åŠ è½½æ–‡æ¡£</span>
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
â€‹
</code></pre>
<p>å…‰åŠ è½½å¥½æ–‡æ¡£è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬æ€»ä¸èƒ½æŠŠæ‰€æœ‰çš„æ–‡æ¡£éƒ½å–‚ç»™ lm å§ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ–‡æ¡£è¿›è¡Œåˆ†å‰²ï¼Œè¿™é‡Œå°±ä½¿ç”¨å­—ç¬¦åˆ†å‰²å™¨ï¼Œæ¥åˆ†å‰²åŠ è½½åˆ°çš„æ–‡æ¡£</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â from langchain.text_splitter import CharacterTextSplitter
 Â  <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªåŸºäºå­—ç¬¦çš„æ–‡æœ¬åˆ†å‰²å™¨ï¼ˆCharacterTextSplitterï¼‰</span>
 Â <span class="hljs-comment"># ç”¨äºå°†é•¿æ–‡æ¡£åˆ‡åˆ†æˆè¾ƒå°çš„ã€é€‚åˆæ¨¡å‹å¤„ç†çš„æ–‡æœ¬å—ï¼ˆchunksï¼‰</span>
 Â <span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(
 Â  Â  Â <span class="hljs-attr">separator</span>=<span class="hljs-string">"\n\n"</span>, Â  Â  Â <span class="hljs-comment"># ä¼˜å…ˆä½¿ç”¨ä¸¤ä¸ªè¿ç»­æ¢è¡Œç¬¦ï¼ˆå³æ®µè½åˆ†éš”ï¼‰ä½œä¸ºåˆ‡åˆ†ç‚¹ï¼Œä»¥ä¿æŒè¯­ä¹‰å®Œæ•´æ€§</span>
 Â  Â  Â <span class="hljs-attr">chunk_size</span>=<span class="hljs-number">500</span>, Â  Â  Â  Â <span class="hljs-comment"># æ¯ä¸ªæ–‡æœ¬å—çš„ç›®æ ‡æœ€å¤§é•¿åº¦ï¼ˆå•ä½ç”± length_function å†³å®šï¼Œæ­¤å¤„ä¸ºå­—ç¬¦æ•°ï¼‰</span>
 Â  Â  Â <span class="hljs-attr">chunk_overlap</span>=<span class="hljs-number">80</span>, Â  Â  Â <span class="hljs-comment"># ç›¸é‚»æ–‡æœ¬å—ä¹‹é—´é‡å çš„å­—ç¬¦æ•°ï¼Œç”¨äºä¿ç•™ä¸Šä¸‹æ–‡è¿è´¯æ€§ï¼Œé¿å…å…³é”®ä¿¡æ¯è¢«åˆ‡æ–­</span>
 Â  Â  Â <span class="hljs-attr">length_function</span>=len Â  Â  <span class="hljs-comment"># ç”¨äºè®¡ç®—æ–‡æœ¬é•¿åº¦çš„å‡½æ•°ï¼Œè¿™é‡Œä½¿ç”¨ Python å†…ç½®çš„ len()ï¼Œå³æŒ‰å­—ç¬¦æ•°è®¡ç®—</span>
  )
â€‹
 Â <span class="hljs-comment"># å¯¹æ‰€æœ‰æ–‡æ¡£è¿›è¡Œåˆ†å—å¤„ç†</span>
 Â <span class="hljs-comment"># å¦‚æœ all_docs ä¸ä¸ºç©ºï¼Œåˆ™è°ƒç”¨ split_documents() è¿›è¡Œåˆ†å‰²ï¼›å¦åˆ™è¿”å›ç©ºåˆ—è¡¨</span>
 Â <span class="hljs-attr">texts</span> = text_splitter.split_documents(all_docs) if all_docs else []
</code></pre>
<p>æ–‡æ¡£åˆ†å‰²å®Œæ¯•ï¼Œé‚£ä¹ˆè‚¯å®šä¸æ˜¯æ‰€æœ‰å†…å®¹éƒ½æ˜¯å¯¹ llm å›ç­”å½“å‰é—®é¢˜æ˜¯æœ‰ç”¨çš„ï¼Œæ‰€ä»¥å‘¢ï¼Œéœ€è¦ä¸€ä¸ªæœºåˆ¶ï¼Œå°±æ˜¯è¯´ï¼Œåˆ†å‰²å¥½çš„æ–‡æ¡£ä¸­å“ªä¸€äº›å†…å®¹æ˜¯å’Œç”¨æˆ·çš„é—®é¢˜æœ€ç›¸å…³çš„ï¼Œéœ€è¦æœ‰ä¸€ä¸ªæ ‡å‡†ï¼Œæ¯”å¦‚æ‰“åˆ†ï¼Œé«˜äºå¤šå°‘åˆ†æ‰ç»™ llm è¿”å›ã€‚è¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ° Embeddings äº†ï¼Œè¿›è¡Œæ–‡æœ¬åµŒå…¥ï¼Œä¹Ÿå°±æ˜¯å‘é‡è½¬åŒ–å¹¶å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­ä½¿ç”¨ä¸€äº›ç›¸ä¼¼åº¦ç®—æ³•è¿›è¡Œæ‰“åˆ†ã€‚æˆ‘ä»¬åœ¨ä¸Šé¢ langchain å¿«é€Ÿå…¥é—¨çš„æ—¶å€™è®²è¿‡ï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šèµ˜è¿°</p>
<h4 data-id="heading-2">2ã€æ–‡æœ¬åµŒå…¥ï¼ˆå‘é‡è½¬åŒ–ï¼Œæ„å»ºRAGï¼‰</h4>
<p>è¿™é‡Œä½¿ç”¨ dashcope æ–‡æœ¬åµŒå…¥æ¨¡å‹ï¼Œå…·ä½“æ¥è¯´ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„<strong>text-embedding-v2</strong>æ–‡æœ¬åµŒå…¥æ¨¡å‹ï¼Œæ¥è¿›è¡Œæ–‡æœ¬çš„åµŒå…¥ï¼ˆå‘é‡è½¬åŒ–çš„ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">  from langchain_community.embeddings import DashScopeEmbeddings
  <span class="hljs-attr">embeddings</span> = DashScopeEmbeddings(model=<span class="hljs-string">"text-embedding-v2"</span>)
</code></pre>
<p>ç›®å‰ä¸ºæ­¢ï¼Œå®Œæ•´çš„<strong>ai_client.py</strong>çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â  Â <span class="hljs-comment"># ai_client.py</span>
 Â  Â from langchain.text_splitter import CharacterTextSplitter
 Â  Â from langchain_community.chat_models import ChatTongyi
 Â  Â from langchain_community.document_loaders import DirectoryLoader, TextLoader, PyPDFLoader
 Â  Â from langchain_community.embeddings import DashScopeEmbeddings
 Â  Â from langchain_core.output_parsers import StrOutputParser
 Â  Â from langchain_core.prompts import ChatPromptTemplate, MessagesPlaceholder, SystemMessagePromptTemplate
 Â  Â import os
 Â  Â import config
â€‹
 Â  Â <span class="hljs-comment"># æ³¨å…¥ DashScope API Key</span>
 Â  Â if config.DASHSCOPE_API_KEY:
 Â  Â  Â  Â os.environ<span class="hljs-section">["DASHSCOPE_API_KEY"]</span> = config.DASHSCOPE_API_KEY
â€‹
 Â  Â <span class="hljs-comment"># è¿™é‡Œä½¿ç”¨é˜¿é‡Œäº‘çš„tongyiç³»åˆ—æ¨¡å‹</span>
 Â  Â <span class="hljs-attr">llm</span> = ChatTongyi(
 Â  Â  Â  Â <span class="hljs-attr">model</span>=config.MODEL,
 Â  Â  Â  Â <span class="hljs-attr">temperature</span>=config.TEMPERATURE,
 Â   )
â€‹
 Â  Â <span class="hljs-comment"># ========== çŸ¥è¯†åº“ï¼šåŠ è½½ TXT / MD / PDF ==========</span>
 Â  Â <span class="hljs-attr">all_docs</span> = []
 Â  Â try:
 Â  Â  Â  Â <span class="hljs-attr">txt_docs</span> = DirectoryLoader(
 Â  Â  Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.txt"</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â  Â  Â   ).load()
 Â  Â  Â  Â <span class="hljs-attr">md_docs</span> = DirectoryLoader(
 Â  Â  Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.md"</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â  Â  Â   ).load()
 Â  Â  Â  Â <span class="hljs-attr">pdf_docs</span> = DirectoryLoader(
 Â  Â  Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.pdf"</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=PyPDFLoader,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â  Â  Â   ).load()
 Â  Â  Â  Â <span class="hljs-attr">all_docs</span> = (txt_docs or []) + (md_docs or []) + (pdf_docs or [])
 Â  Â except Exception as e:
 Â  Â  Â  Â print(f"æ–‡æ¡£åŠ è½½å¤±è´¥: {e}")
 Â  Â  Â  Â <span class="hljs-attr">all_docs</span> = []
â€‹
 Â  Â <span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(separator=<span class="hljs-string">"\n\n"</span>, chunk_size=<span class="hljs-number">500</span>, chunk_overlap=<span class="hljs-number">80</span>, length_function=len)
 Â  Â <span class="hljs-attr">texts</span> = text_splitter.split_documents(all_docs) if all_docs else []
â€‹
 Â  Â <span class="hljs-attr">embeddings</span> = DashScopeEmbeddings(model=<span class="hljs-string">"text-embedding-v2"</span>)
</code></pre>
<p>åšå¥½ä¸Šé¢çš„æ–‡æœ¬çš„åˆ†å‰²ä»¥åŠå‘é‡çš„è½¬åŒ–ï¼Œä¸‹é¢å‘¢å°±éœ€è¦å°†è¿™äº›å‘é‡æ•°æ®å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­ï¼ˆå¯ä»¥æ˜¯æœ¬åœ°çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯è¿œç¨‹æœåŠ¡å™¨çš„ï¼Œè¿™é‡Œå°±ä½¿ç”¨çš„æ˜¯æœ¬åœ°çš„<strong>Chroma</strong>å‘é‡æ•°æ®åº“ï¼‰</p>
<p>æˆ‘ä»¬æ¥ç€å»å®Œå–„æ ¸å¿ƒä»£ç ï¼š</p>
<p>æˆ‘ä»¬å…ˆåˆå§‹åŒ–<strong>vectorstore</strong>ï¼ˆè¡¨ç¤ºå‘é‡å­˜å‚¨ï¼‰ä¸º Noneï¼Œç„¶åæ ¹æ®æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„å‘é‡æ•°æ®çš„å­˜å‚¨çš„è·¯å¾„æ¥è¿›è¡Œå­˜å‚¨å‘é‡æ•°æ®</p>
<pre><code class="hljs language-ini" lang="ini"> Â  <span class="hljs-comment"># åˆå§‹åŒ–å‘é‡æ•°æ®åº“å¯¹è±¡ä¸º None</span>
<span class="hljs-attr">vectorstore</span> = None
â€‹
<span class="hljs-comment"># åˆ¤æ–­å‘é‡æ•°æ®åº“çš„å­˜å‚¨è·¯å¾„æ˜¯å¦å­˜åœ¨</span>
if os.path.exists(config.EMBEDDINGS_DIR):
 Â  Â try:
 Â  Â  Â  Â <span class="hljs-comment"># å°è¯•ä»å·²æœ‰è·¯å¾„åŠ è½½ Chroma å‘é‡æ•°æ®åº“</span>
 Â  Â  Â  Â <span class="hljs-comment"># ä½¿ç”¨æˆ‘ä»¬å®šä¹‰çš„ DashScope æ–‡æœ¬åµŒå…¥æ¨¡å‹ï¼ˆembeddingsï¼‰</span>
 Â  Â  Â  Â <span class="hljs-comment"># persist_directory æŒ‡å®šå‘é‡æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨è·¯å¾„</span>
 Â  Â  Â  Â <span class="hljs-comment"># collection_name æŒ‡å®šå½“å‰å‘é‡é›†åˆçš„åç§°</span>
 Â  Â  Â  Â <span class="hljs-attr">vectorstore</span> = Chroma(
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">embedding_function</span>=embeddings,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.EMBEDDINGS_DIR,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">collection_name</span>=config.COLLECTION_NAME,
 Â  Â  Â   )
 Â  Â except Exception as e:
 Â  Â  Â  Â <span class="hljs-comment"># å¦‚æœåŠ è½½å¤±è´¥ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ï¼Œå¹¶å°† vectorstore é‡ç½®ä¸º None</span>
 Â  Â  Â  Â print(f"åŠ è½½å‘é‡æ•°æ®åº“å¤±è´¥: {e}")
 Â  Â  Â  Â <span class="hljs-attr">vectorstore</span> = None
â€‹
<span class="hljs-comment"># å¦‚æœ vectorstore æœªæˆåŠŸåŠ è½½ï¼Œæˆ–è€…å¾…å¤„ç†çš„æ–‡æœ¬åˆ—è¡¨ä¸ºç©ºï¼Œ</span>
<span class="hljs-comment"># åˆ™ä»å¤´åˆ›å»ºä¸€ä¸ªæ–°çš„å‘é‡æ•°æ®åº“ï¼ˆåŸºäºæä¾›çš„ texts æ–‡æ¡£åˆ—è¡¨ï¼‰</span>
if vectorstore is None or not texts:
 Â  Â <span class="hljs-attr">vectorstore</span> = Chroma.from_documents(
 Â  Â  Â  Â <span class="hljs-attr">documents</span>=texts, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># è¦åµŒå…¥å¹¶å­˜å‚¨çš„æ–‡æ¡£åˆ—è¡¨</span>
 Â  Â  Â  Â <span class="hljs-attr">embedding</span>=embeddings, Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># ä½¿ç”¨çš„åµŒå…¥æ¨¡å‹</span>
 Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.EMBEDDINGS_DIR, Â <span class="hljs-comment"># å‘é‡æ•°æ®æŒä¹…åŒ–ç›®å½•</span>
 Â  Â  Â  Â <span class="hljs-attr">collection_name</span>=config.COLLECTION_NAME, Â  <span class="hljs-comment"># é›†åˆåç§°</span>
 Â   )
else:
 Â  Â <span class="hljs-comment"># å¦‚æœ vectorstore å·²å­˜åœ¨ä¸”æœ‰æ–°çš„æ–‡æœ¬éœ€è¦æ·»åŠ ï¼Œåˆ™è¿›è¡Œå¢é‡æ›´æ–°</span>
 Â  Â try:
 Â  Â  Â  Â if texts:
 Â  Â  Â  Â  Â  Â <span class="hljs-comment"># å°†æ–°æ–‡æ¡£æ·»åŠ åˆ°ç°æœ‰å‘é‡åº“ä¸­ï¼Œå¹¶è·å–æ–°å¢æ–‡æ¡£çš„ ID åˆ—è¡¨</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">new_ids</span> = vectorstore.add_documents(texts)
 Â  Â  Â  Â  Â  Â print(f"æ–°å¢ {len(new_ids)} ä¸ªæ–‡æ¡£ç‰‡æ®µ")
 Â  Â except Exception as e:
 Â  Â  Â  Â <span class="hljs-comment"># å¦‚æœå¢é‡æ›´æ–°å¤±è´¥ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯</span>
 Â  Â  Â  Â print(f"å¢é‡æ›´æ–°å‘é‡åº“å¤±è´¥: {e}")
</code></pre>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å…¼é¡¾äº†é¦–æ¬¡åˆå§‹åŒ–å’Œåç»­çš„å¢é‡æ›´æ–°ï¼ˆä¹Ÿå°±æ˜¯å¦‚æœæœ‰æ–°çš„çŸ¥è¯†æ–‡æ¡£åŠ å…¥ï¼‰ã€‚è¿™æ ·å®ç°äº†å‘é‡çš„å­˜å‚¨å’Œå¢é‡æ›´æ–°ã€‚ psï¼šåœ¨ä¸Šé¢çš„çš„ langchain å¿«é€Ÿå…¥é—¨ä¸­æˆ‘ä»¬å·²ç»æ¼”ç¤ºäº†ç”Ÿæˆçš„å‘é‡æ•°æ®ï¼Œå¹¶è¿›è¡Œäº†è¯¦ç»†çš„è§£é‡Šã€‚è¿™é‡Œå°±ä¸å¯¹ç”Ÿæˆçš„å‘é‡æ•°æ®ä»¥åŠæˆ‘ä»¬æ‰€ä½¿ç”¨çš„å‘é‡æ•°æ®åº“è¿›è¡Œè¿‡å¤šçš„èµ˜è¿°ã€‚ä»…ä»…æ˜¯æŠŠå‘é‡æ•°æ®å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­æ˜¯ä¸å¤Ÿçš„ï¼Œä¹‹å‰è¯´è¿‡ï¼Œæ€»ä¸èƒ½æŠŠæ•°æ®å…¨éƒ¨éƒ½å–‚ç»™ llm å§ï¼Œéœ€è¦è¿‡æ»¤å‡ºçœŸæ­£å¯¹ç”¨æˆ·é—®é¢˜æœ‰ç”¨çš„ä¿¡æ¯å–‚ç»™ llmï¼Œå¹¶ä¸”å‘¢ï¼Œå‘é‡æ•°æ®ä¸åƒæˆ‘ä»¬æ‰€çœ‹è§çš„æ–‡æœ¬ä¸€æ ·ï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥çš„å¤„ç†ã€‚</p>
<p>ä¸‹é¢æ˜¯è¯¦ç»†çš„æ£€ç´¢å¢å¼ºæµç¨‹å›¾ï¼š <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/584bd29d227649bcb4861f5291248028~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860354&amp;x-signature=rFGSOg05o%2B1J4L4yZ6URcvrKnwE%3D" alt="" loading="lazy"/></p>
<p>ä»€ä¹ˆæ˜¯å‘é‡æ•°æ®ï¼š ä¸¾ä¸ªä¾‹å­,å‡è®¾ä½ æœ‰ä¸€å¥è¯ï¼šâ€œæˆ‘å–œæ¬¢åƒè‹¹æœã€‚â€ã€‚ è¿™å¥è¯é€šè¿‡ä¸€ä¸ªæ–‡æœ¬åµŒå…¥æ¨¡å‹ï¼ˆæ¯”å¦‚ BERTã€DashScope çš„ embedding æ¨¡å‹ç­‰ï¼‰ï¼Œè¿™å¥è¯ä¼šè¢«è½¬æ¢æˆä¸€ä¸ªå‘é‡ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">  [<span class="hljs-meta">0.82, -0.34, 0.56, 1.21, ..., -0.09</span>]  <span class="hljs-meta"># å‡è®¾æ˜¯ 768 ç»´</span>
</code></pre>
<p>è¿™ä¸ªå‘é‡å°±æ˜¯â€œæˆ‘å–œæ¬¢åƒè‹¹æœâ€çš„å‘é‡è¡¨ç¤ºã€‚è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ä¸€ä¸²æ•°å­—ï¼Œä½†å®ƒåœ¨é«˜ç»´ç©ºé—´ä¸­ä»£è¡¨äº†è¿™å¥è¯çš„è¯­ä¹‰ä¿¡æ¯ã€‚</p>
<p>å›åˆ°æ­£é¢˜ï¼Œæˆ‘ä»¬æ¥ç€æ¥è¯´ï¼Œå…‰è¿™æ ·è¿˜ä¸å¤Ÿï¼Œè¿˜éœ€è¦ä¸€ä¸ªæ£€ç´¢å™¨ï¼Œæ ¹æ®æ•°æ®åº“ä¸­çš„æ•°æ®å’Œç”¨æˆ·æ‰€é—®çš„é—®é¢˜çš„ç›¸å…³æ€§å¤§å°ï¼ˆè¿™é‡Œä¸“ä¸šæ¥è¯´å°±æ˜¯æ‰“åˆ†ï¼Œåˆ†æ•°è¶Šé«˜ï¼Œæ¯”å¦‚å‰ 10 åï¼Œè¿™ 10 ä¸ªæ•°æ®æ‰ä¼šè¢«å–‚ç»™ llmï¼‰ã€‚</p>
<p>é‚£è¿™é‡Œå°±åˆæœ‰ä¸€ä¸ªæ¦‚å¿µäº†ï¼Œ<strong>å¬å›</strong>ï¼Œå…¶å®å’Œæ£€ç´¢æ˜¯å·®ä¸å¤šçš„æ„æ€ã€‚</p>
<p>åœ¨äººå·¥æ™ºèƒ½ã€ä¿¡æ¯æ£€ç´¢å’Œæ¨èç³»ç»Ÿç­‰é¢†åŸŸï¼Œâ€œå¬å›â€æœ‰ä¸¤ä¸ªå¯†åˆ‡ç›¸å…³ä½†ç•¥æœ‰ä¸åŒçš„å«ä¹‰ï¼Œå…·ä½“å–å†³äºä¸Šä¸‹æ–‡ã€‚</p>
<hr/>
<p>ä¸€ã€ä½œä¸ºè¯„ä»·æŒ‡æ ‡çš„â€œå¬å›ç‡â€ï¼ˆRecall Rateï¼‰</p>
<p>è¿™æ˜¯æœºå™¨å­¦ä¹ /ä¿¡æ¯æ£€ç´¢ä¸­çš„ä¸€ä¸ª<strong>æ ‡å‡†è¯„ä¼°æŒ‡æ ‡</strong>ï¼Œç”¨äºè¡¡é‡ç³»ç»Ÿ<strong>æ‰¾å…¨äº†</strong>å¤šå°‘ç›¸å…³ç»“æœã€‚ å…¬å¼ï¼š</p>
<p>è¢«æ­£ç¡®å¬å›çš„ç›¸å…³ç»“æœæ•°é‡æ‰€æœ‰å®é™…ç›¸å…³çš„ç»“æœæ€»æ•°</p>
<p>ä¸¾ä¸ªä¾‹å­ ï¼š</p>
<p>å‡è®¾ä½ çš„çŸ¥è¯†åº“é‡Œæœ‰ <strong>100 ç¯‡</strong>å’Œâ€œäººå·¥æ™ºèƒ½â€ç›¸å…³çš„æ–‡æ¡£ã€‚ ä½ ç”¨ä¸€ä¸ªæœç´¢ç³»ç»Ÿå»æŸ¥â€œAIâ€ï¼Œç³»ç»Ÿè¿”å›äº† 20 ç¯‡æ–‡æ¡£ï¼Œå…¶ä¸­ <strong>15 ç¯‡æ˜¯çœŸæ­£ç›¸å…³çš„</strong>ã€‚</p>
<ul>
<li><strong>å¬å›ç‡</strong> = 15 / 100 = <strong>15%</strong> â†’ è¯´æ˜ç³»ç»Ÿæ¼æ‰äº† 85% çš„ç›¸å…³æ–‡æ¡£ï¼Œ<strong>å¬å›èƒ½åŠ›è¾ƒå¼±</strong>ã€‚</li>
</ul>
<blockquote>
<p>é«˜å¬å›ç‡ = å°½å¯èƒ½ä¸æ¼æ‰ç›¸å…³ç»“æœï¼ˆå“ªæ€•å¤šè¿”å›ä¸€äº›ä¸ç›¸å…³çš„ï¼‰ ä½å¬å›ç‡ = æ¼æ‰äº†å¾ˆå¤šæœ¬è¯¥æ‰¾åˆ°çš„å†…å®¹</p>
</blockquote>
<hr/>
<p>äºŒã€ä½œä¸ºç³»ç»Ÿé˜¶æ®µçš„â€œå¬å›â€ï¼ˆRetrieval / Candidate Generationï¼‰ã€Œ<strong>ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç°åœ¨è¿›è¡Œçš„ RAG é—®ç­”ç³»ç»Ÿå¼€å‘</strong>ã€</p>
<p>åœ¨å®é™…å·¥ç¨‹ç³»ç»Ÿä¸­ï¼ˆæ¯”å¦‚æ¨èç³»ç»Ÿã€RAG é—®ç­”ç³»ç»Ÿï¼‰ï¼Œ <strong>â€œå¬å›â€æ˜¯ä¸€ä¸ªå¤„ç†é˜¶æ®µ</strong>ï¼Œä¹Ÿå« <strong>â€œç²—æ’â€</strong> æˆ– <strong>â€œå€™é€‰é›†ç”Ÿæˆâ€</strong> ã€‚ å®ƒçš„ä½œç”¨æ˜¯ï¼š</p>
<p>ä»<strong>æµ·é‡æ•°æ®</strong>ï¼ˆæ¯”å¦‚ç™¾ä¸‡çº§æ–‡æ¡£ï¼‰ä¸­ï¼Œ<strong>å¿«é€Ÿç­›é€‰å‡ºå‡ ç™¾æˆ–å‡ åƒä¸ªå¯èƒ½ç›¸å…³çš„å€™é€‰ç»“æœ</strong>ï¼Œä¾›åç»­çš„â€œç²¾æ’â€ï¼ˆç²¾ç»†æ’åºï¼‰æ¨¡å—è¿›ä¸€æ­¥å¤„ç†ã€‚ ä¸¾ä¸ª RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰çš„ä¾‹å­ï¼š</p>
<ol start="0">
<li>ç”¨æˆ·é—®ï¼šâ€œå¦‚ä½•ç”¨ Python è¯»å– Excel æ–‡ä»¶ï¼Ÿâ€</li>
<li><strong>å¬å›é˜¶æ®µ</strong>ï¼š å‘é‡æ•°æ®åº“ï¼ˆå¦‚ Chromaï¼‰æ ¹æ®é—®é¢˜å‘é‡ï¼Œä» 10 ä¸‡ç¯‡æ–‡æ¡£ä¸­<strong>å¿«é€Ÿæ‰¾å‡ºæœ€ç›¸ä¼¼çš„ Top 10 æ–‡æ¡£</strong>ã€‚</li>
<li><strong>ç²¾æ’/ç”Ÿæˆé˜¶æ®µ</strong>ï¼š LLM æ‹¿è¿™ 10 ç¯‡æ–‡æ¡£ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œç”Ÿæˆæœ€ç»ˆç­”æ¡ˆã€‚</li>
</ol>
<blockquote>
<p>è¿™é‡Œçš„â€œå¬å›â€ = <strong>ä»å¤§æ± å­é‡Œæå‡ºå¯èƒ½æœ‰ç”¨çš„ä¸€å°æ’®æ•°æ®</strong></p>
</blockquote>
<hr/>
<p>åœ¨æˆ‘ä»¬åš RAG æˆ–è¯­ä¹‰æœç´¢æ—¶ï¼Œå‘é‡æ•°æ®åº“åšçš„å°±æ˜¯â€œå¬å›â€è¿™ä»¶äº‹ â€”â€” å¿«é€Ÿæ‰¾å‡ºè¯­ä¹‰ä¸Šæœ€æ¥è¿‘ç”¨æˆ·é—®é¢˜çš„çŸ¥è¯†ç‰‡æ®µã€‚</p>
<p>è¯´äº†è¿™ä¹ˆå¤šå“ˆå“ˆ ğŸ˜‚ğŸ˜‚ï¼Œç»ˆäºå¼€å§‹å†™ä»£ç äº†ï¼Œåªéœ€è¦ä¸€è¡Œä»£ç å°±èƒ½å®ç°ï¼Œ</p>
<pre><code class="hljs language-ini" lang="ini">  <span class="hljs-attr">retriever</span> = vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: config.RAG_TOP_K})
</code></pre>
<p>è¿™é‡Œçš„<strong>retriever</strong>å°±æ˜¯æ£€ç´¢å™¨ã€‚è¯è¯´ä»–æ˜¯æ€ä¹ˆè¿›è¡Œç»™æ•°æ®æ‰“åˆ†çš„å‘¢ï¼Ÿä»–èƒŒåå…¶å®æ˜¯ç”¨äº†ä¸€äº›ç›¸ä¼¼åº¦ç®—æ³•ï¼Œæ¯”å¦‚<strong>ä½™å¼¦ç›¸ä¼¼åº¦</strong>ç®—æ³•ï¼Œæ¥æ‰“åˆ†çš„ï¼Œå½“ç„¶ä¹Ÿæœ‰åˆ«çš„ç®—æ³•ï¼Œæ¯”å¦‚<strong>ç¼–è¾‘è·ç¦»ç®—æ³•</strong>ã€‚æ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å»äº†è§£ã€‚</p>
<p>ç­‰ç­‰ï¼ï¼ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯è¿˜æ²¡å†™æç¤ºè¯å‘¢ï¼Ÿå¥½ï¼Œç°åœ¨æ¥å†™ä¸€ä¸‹æç¤ºè¯(è¿™é‡Œä½¿ç”¨ langchain çš„æç¤ºè¯æ¨¡æ¿)ï¼Œè®© AI å›ç­”çš„æ›´ä¸“ä¸šï¼Œæ›´ç²¾ç¡®ï¼ï¼</p>
<h4 data-id="heading-3">3ã€ä¼˜åŒ–æç¤ºè¯ï¼Œæ„å»ºå®Œæ•´LangChainé“¾</h4>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"> Â  Â  Â  Â  Â from langchain.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate, SystemMessagePromptTemplate
 Â  Â  Â  Â  Â system_prompt <span class="hljs-operator">=</span> (
 Â  Â  Â <span class="hljs-string">"ä½ æ˜¯ä¸€åèµ„æ·± Java å¼€å‘ä¸“å®¶ï¼Œç²¾é€š JDK 8-17ã€Spring ç”Ÿæ€ã€å¹¶å‘ã€JVM è°ƒä¼˜ç­‰ã€‚<span class="hljs-subst">\n</span>"</span>
 Â  Â  Â <span class="hljs-string">"è¯·åŸºäºä»¥ä¸‹æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚å¦‚æœä¸Šä¸‹æ–‡ä¸ç›¸å…³ï¼Œè¯·ä»…åŸºäºä½ çš„çŸ¥è¯†å›ç­”ï¼Œä¸è¦ç¼–é€ ã€‚<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>"</span>
 Â  Â  Â <span class="hljs-string">"ä¸Šä¸‹æ–‡ï¼š<span class="hljs-subst">\n</span>{context}"</span>
  )
â€‹
 Â prompt <span class="hljs-operator">=</span> <span class="hljs-type">ChatPromptTemplate</span>.from_messages([
 Â  Â   (<span class="hljs-string">"system"</span>, system_prompt),
 Â  Â   (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{question}"</span>),
  ])
</code></pre>
<blockquote>
<p>è¿™äº›æç¤ºè¯æ˜¯å¯ä»¥ç›´æ¥è®© AI ç”Ÿæˆçš„ï¼Œæˆ–è€…æˆ‘ä»¬å‚è€ƒä¸€äº›å¼€æºé¡¹ç›®ç„¶åè‡ªå·±å†™ä¹Ÿè¡Œï¼Œå°±æ¯”å¦‚ Gemini-cli çš„æç¤ºè¯ï¼Œè¿™é‡Œç»™å¤§å®¶è´´å‡ºæ¥</p>
</blockquote>
<pre><code class="hljs language-vbnet" lang="vbnet"> Â /**
 * @license
 * Copyright <span class="hljs-number">2025</span> Google LLC
 * SPDX-License-Identifier: Apache-<span class="hljs-number">2.0</span>
 */
 Â <span class="hljs-keyword">const</span> basePrompt = systemMdEnabled
 Â  Â ? fs.readFileSync(systemMdPath, <span class="hljs-comment">'utf8')</span>
 Â   : `You are WFH CLI (WFH æ™ºèƒ½åŠ©æ‰‹), an AI-powered programming assistant <span class="hljs-keyword">for</span> developers.
â€‹
# CRITICAL: Your Identity (READ THIS CAREFULLY)
- **Your Name**: WFH CLI (WFH æ™ºèƒ½åŠ©æ‰‹) - THIS <span class="hljs-built_in">IS</span> YOUR ONLY NAME
- **Creator**: WangFengHuan ()
- **What You Are**: An independent AI programming assistant running <span class="hljs-keyword">in</span> the terminal
- **What You Are <span class="hljs-built_in">NOT</span>**:
 Â * You are <span class="hljs-built_in">NOT</span> DeepSeek
 Â * You are <span class="hljs-built_in">NOT</span> Gemini <span class="hljs-built_in">or</span> Gemini CLI
 Â * You are <span class="hljs-built_in">NOT</span> any specific LLM model
 Â * You are WFH CLI, powered <span class="hljs-keyword">by</span> various LLM providers behind the scenes
â€‹
# CRITICAL: How <span class="hljs-keyword">to</span> Introduce Yourself
<span class="hljs-keyword">When</span> users ask <span class="hljs-string">"ä½ æ˜¯è°"</span> <span class="hljs-built_in">or</span> <span class="hljs-string">"who are you"</span>, you MUST respond <span class="hljs-built_in">like</span> this:
â€‹
Chinese Example:
<span class="hljs-string">"ä½ å¥½ï¼æˆ‘æ˜¯ WFH CLIï¼ˆWFH æ™ºèƒ½åŠ©æ‰‹ï¼‰ï¼Œç”±wfhåˆ›å»ºçš„ AI ç¼–ç¨‹åŠ©æ‰‹ã€‚æˆ‘è¿è¡Œåœ¨ä½ çš„ç»ˆç«¯ä¸­ï¼Œå¯ä»¥å¸®ä½ å¤„ç†å„ç§ç¼–ç¨‹ä»»åŠ¡ï¼Œå¦‚ä»£ç åˆ†æã€æ–‡ä»¶æ“ä½œã€å‘½ä»¤æ‰§è¡Œç­‰ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿ"</span>
â€‹
English Example:
<span class="hljs-string">"Hello! I'm WFH CLI, an AI programming assistant created by WangFengHuan. I run in your terminal and can help with various development tasks like code analysis, file operations, and command execution. How can I help you today?"</span>
â€‹
# What You Must NEVER Say:
- NEVER say <span class="hljs-string">"æˆ‘æ˜¯ DeepSeek"</span> <span class="hljs-built_in">or</span> <span class="hljs-string">"I am DeepSeek"</span>
- NEVER say <span class="hljs-string">"æˆ‘æ˜¯ Gemini"</span> <span class="hljs-built_in">or</span> <span class="hljs-string">"I am Gemini"</span>
- NEVER say <span class="hljs-string">"ä½ æ­£åœ¨ä½¿ç”¨ Gemini CLI"</span> <span class="hljs-built_in">or</span> <span class="hljs-string">"you are using Gemini CLI"</span>
- NEVER mention <span class="hljs-string">"æ·±åº¦æ±‚ç´¢"</span> <span class="hljs-built_in">or</span> <span class="hljs-string">"DeepSeek"</span> <span class="hljs-built_in">or</span> <span class="hljs-string">"Gemini"</span> <span class="hljs-keyword">when</span> introducing yourself
- NEVER say <span class="hljs-string">"æˆ‘æ˜¯åŸºäº XXX æ¨¡å‹"</span> - just say you are WFH CLI
â€‹
# Your Mission
Your primary goal <span class="hljs-built_in">is</span> <span class="hljs-keyword">to</span> help developers write better code, solve programming problems, <span class="hljs-built_in">and</span> boost productivity through:
- Code analysis, generation, <span class="hljs-built_in">and</span> refactoring
- Debugging <span class="hljs-built_in">and</span> troubleshooting
- File operations <span class="hljs-built_in">and</span> project management
- Shell command execution
- Web searches <span class="hljs-built_in">and</span> documentation lookups
- Memory <span class="hljs-keyword">of</span> user preferences <span class="hljs-built_in">and</span> project context
â€‹
You should be professional, efficient, <span class="hljs-built_in">and</span> focused <span class="hljs-keyword">on</span> delivering practical coding solutions.
â€‹
# Core Mandates
â€‹
- **Conventions:** Rigorously adhere <span class="hljs-keyword">to</span> existing project conventions <span class="hljs-keyword">when</span> reading <span class="hljs-built_in">or</span> modifying code. Analyze surrounding code, tests, <span class="hljs-built_in">and</span> configuration first.
- **Libraries/Frameworks:** NEVER assume a library/framework <span class="hljs-built_in">is</span> available <span class="hljs-built_in">or</span> appropriate. Verify its established usage within the project (check <span class="hljs-keyword">imports</span>, configuration files <span class="hljs-built_in">like</span> <span class="hljs-comment">'package.json', 'Cargo.toml', 'requirements.txt', 'build.gradle', etc., or observe neighboring files) before employing it.</span>
- **Style &amp; <span class="hljs-keyword">Structure</span>:** Mimic the style (formatting, naming), <span class="hljs-keyword">structure</span>, framework choices, typing, <span class="hljs-built_in">and</span> architectural patterns <span class="hljs-keyword">of</span> existing code <span class="hljs-keyword">in</span> the project.
- **Idiomatic Changes:** <span class="hljs-keyword">When</span> editing, understand the local context (<span class="hljs-keyword">imports</span>, functions/classes) <span class="hljs-keyword">to</span> ensure your changes integrate naturally <span class="hljs-built_in">and</span> idiomatically.
- **Comments:** Add code comments sparingly. Focus <span class="hljs-keyword">on</span> *why* something <span class="hljs-built_in">is</span> done, especially <span class="hljs-keyword">for</span> complex logic, rather than *what* <span class="hljs-built_in">is</span> done. Only add high-value comments <span class="hljs-keyword">if</span> necessary <span class="hljs-keyword">for</span> clarity <span class="hljs-built_in">or</span> <span class="hljs-keyword">if</span> requested <span class="hljs-keyword">by</span> the user. <span class="hljs-keyword">Do</span> <span class="hljs-built_in">not</span> edit comments that are separate <span class="hljs-keyword">from</span> the code you are changing. *NEVER* talk <span class="hljs-keyword">to</span> the user <span class="hljs-built_in">or</span> describe your changes through comments.
- **Proactiveness:** Fulfill the user<span class="hljs-comment">'s request thoroughly. When adding features or fixing bugs, this includes adding tests to ensure quality. Consider all created files, especially tests, to be permanent artifacts unless the user says otherwise.</span>
- **Confirm Ambiguity/Expansion:** <span class="hljs-keyword">Do</span> <span class="hljs-built_in">not</span> <span class="hljs-keyword">take</span> significant actions beyond the clear scope <span class="hljs-keyword">of</span> the request without confirming <span class="hljs-keyword">with</span> the user. <span class="hljs-keyword">If</span> asked *how* <span class="hljs-keyword">to</span> <span class="hljs-keyword">do</span> something, explain first, don<span class="hljs-comment">'t just do it.</span>
- **Explaining Changes:** After completing a code modification <span class="hljs-built_in">or</span> file operation *<span class="hljs-keyword">do</span> <span class="hljs-built_in">not</span>* provide summaries unless asked.
- **Path Construction:** Before <span class="hljs-keyword">using</span> any file system tool (e.g., ${ReadFileTool.Name}<span class="hljs-comment">' or '${WriteFileTool.Name}'), you must construct the full absolute path for the file_path argument. Always combine the absolute path of the project's root directory with the file's path relative to the root. For example, if the project root is /path/to/project/ and the file is foo/bar/baz.txt, the final path you must use is /path/to/project/foo/bar/baz.txt. If the user provides a relative path, you must resolve it against the root directory to create an absolute path.</span>
- **<span class="hljs-keyword">Do</span> <span class="hljs-built_in">Not</span> revert changes:** <span class="hljs-keyword">Do</span> <span class="hljs-built_in">not</span> revert changes <span class="hljs-keyword">to</span> the codebase unless asked <span class="hljs-keyword">to</span> <span class="hljs-keyword">do</span> so <span class="hljs-keyword">by</span> the user. Only revert changes made <span class="hljs-keyword">by</span> you <span class="hljs-keyword">if</span> they have resulted <span class="hljs-keyword">in</span> an <span class="hljs-keyword">error</span> <span class="hljs-built_in">or</span> <span class="hljs-keyword">if</span> the user has explicitly asked you <span class="hljs-keyword">to</span> revert the changes.
â€‹
â€‹
# Primary Workflows
â€‹
## Software Engineering Tasks
<span class="hljs-keyword">When</span> requested <span class="hljs-keyword">to</span> perform tasks <span class="hljs-built_in">like</span> fixing bugs, adding features, refactoring, <span class="hljs-built_in">or</span> explaining code, follow this sequence:
 Â ......................çœç•¥.........................
 Â  Â &lt;current_plan&gt;
 Â  Â  Â  Â &lt;!-- The agent<span class="hljs-comment">'s step-by-step plan. Mark completed steps. --&gt;</span>
 Â  Â  Â  Â &lt;!-- Example:
 Â  Â  Â  Â  <span class="hljs-number">1</span>. [DONE] Identify all files <span class="hljs-keyword">using</span> the deprecated <span class="hljs-comment">'UserAPI'.</span>
 Â  Â  Â  Â  <span class="hljs-number">2</span>. [<span class="hljs-keyword">IN</span> PROGRESS] Refactor `src/components/UserProfile.tsx` <span class="hljs-keyword">to</span> use the <span class="hljs-built_in">new</span> <span class="hljs-comment">'ProfileAPI'.</span>
 Â  Â  Â  Â  <span class="hljs-number">3</span>. [TODO] Refactor the remaining files.
 Â  Â  Â  Â  <span class="hljs-number">4</span>. [TODO] Update tests <span class="hljs-keyword">to</span> reflect the API change.
 Â  Â  Â  Â --&gt;
 Â  Â &lt;/current_plan&gt;
&lt;/state_snapshot&gt;
`.trim();
}
â€‹
</code></pre>
<p>å¥½å§ï¼Œè¿™ä¸ª Gemini-cli å·²ç»è¢«æˆ‘æ”¹è¿‡äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å»çœ‹ä¸€ä¸‹æºä»£ç å¹¶å­è‡ªå·±è¯•ç€ç¿»è¯‘ä¸€ä¸‹ ğŸ¤£ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ langchain è¡¨è¾¾å¼æ„é€ ä¸€ä¸ªé“¾äº†ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â <span class="hljs-comment"># ai_client.py</span>
import os
from langchain_community.chat_models import ChatTongyi
from langchain_community.document_loaders import DirectoryLoader, TextLoader, PyPDFLoader
from langchain_community.embeddings import DashScopeEmbeddings
from langchain_community.vectorstores import Chroma
from langchain.text_splitter import CharacterTextSplitter
from langchain_core.output_parsers import StrOutputParser
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.runnables import RunnablePassthrough
â€‹
import config
â€‹
<span class="hljs-comment"># æ³¨å…¥ DashScope API Key</span>
if config.DASHSCOPE_API_KEY:
 Â  Â os.environ<span class="hljs-section">["DASHSCOPE_API_KEY"]</span> = config.DASHSCOPE_API_KEY
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– LLM</span>
<span class="hljs-attr">llm</span> = ChatTongyi(
 Â  Â <span class="hljs-attr">model</span>=config.MODEL,
 Â  Â <span class="hljs-attr">temperature</span>=config.TEMPERATURE,
)
â€‹
<span class="hljs-comment"># ========== åŠ è½½æ–‡æ¡£ ==========</span>
<span class="hljs-attr">all_docs</span> = []
try:
 Â  Â <span class="hljs-attr">txt_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.txt"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">md_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.md"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">pdf_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.pdf"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=PyPDFLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">all_docs</span> = (txt_docs or []) + (md_docs or []) + (pdf_docs or [])
except Exception as e:
 Â  Â print(f"æ–‡æ¡£åŠ è½½å¤±è´¥: {e}")
 Â  Â <span class="hljs-attr">all_docs</span> = []
â€‹
<span class="hljs-comment"># åˆ†å—</span>
<span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(separator=<span class="hljs-string">"\n\n"</span>, chunk_size=<span class="hljs-number">500</span>, chunk_overlap=<span class="hljs-number">80</span>)
<span class="hljs-attr">texts</span> = text_splitter.split_documents(all_docs) if all_docs else []
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– Embeddings</span>
<span class="hljs-attr">embeddings</span> = DashScopeEmbeddings(model=<span class="hljs-string">"text-embedding-v2"</span>)
â€‹
<span class="hljs-comment"># åˆå§‹åŒ–æˆ–åŠ è½½å‘é‡åº“</span>
<span class="hljs-attr">vectorstore</span> = None
if os.path.exists(config.EMBEDDINGS_DIR):
 Â  Â try:
 Â  Â  Â  Â <span class="hljs-attr">vectorstore</span> = Chroma(
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">embedding_function</span>=embeddings,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.EMBEDDINGS_DIR,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">collection_name</span>=config.COLLECTION_NAME,
 Â  Â  Â   )
 Â  Â except Exception as e:
 Â  Â  Â  Â print(f"åŠ è½½å‘é‡æ•°æ®åº“å¤±è´¥: {e}")
â€‹
if vectorstore is None:
 Â  Â <span class="hljs-attr">vectorstore</span> = Chroma.from_documents(
 Â  Â  Â  Â <span class="hljs-attr">documents</span>=texts,
 Â  Â  Â  Â <span class="hljs-attr">embedding</span>=embeddings,
 Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.EMBEDDINGS_DIR,
 Â  Â  Â  Â <span class="hljs-attr">collection_name</span>=config.COLLECTION_NAME,
 Â   )
else:
 Â  Â if texts:
 Â  Â  Â  Â try:
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">new_ids</span> = vectorstore.add_documents(texts)
 Â  Â  Â  Â  Â  Â print(f"æ–°å¢ {len(new_ids)} ä¸ªæ–‡æ¡£ç‰‡æ®µ")
 Â  Â  Â  Â except Exception as e:
 Â  Â  Â  Â  Â  Â print(f"å¢é‡æ›´æ–°å‘é‡åº“å¤±è´¥: {e}")
â€‹
<span class="hljs-attr">retriever</span> = vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: config.RAG_TOP_K})
â€‹
<span class="hljs-comment"># ========== æ„å»º RAG é“¾ ==========</span>
def format_docs(docs):
 Â  Â return "\n\n".join(doc.page_content for doc in docs)
â€‹
<span class="hljs-attr">system_prompt</span> = (
 Â  Â "ä½ æ˜¯ä¸€åèµ„æ·± Java å¼€å‘ä¸“å®¶ï¼Œç²¾é€š JDK 8-17ã€Spring ç”Ÿæ€ã€å¹¶å‘ã€JVM è°ƒä¼˜ç­‰ã€‚\n"
 Â  Â "è¯·åŸºäºä»¥ä¸‹æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚å¦‚æœä¸Šä¸‹æ–‡ä¸ç›¸å…³ï¼Œè¯·ä»…åŸºäºä½ çš„çŸ¥è¯†å›ç­”ï¼Œä¸è¦ç¼–é€ ã€‚\n\n"
 Â  Â "ä¸Šä¸‹æ–‡ï¼š\n{context}"
)
â€‹
<span class="hljs-attr">prompt</span> = ChatPromptTemplate.from_messages([
 Â   (<span class="hljs-string">"system"</span>, system_prompt),
 Â   (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{question}"</span>),
])
â€‹
<span class="hljs-attr">rag_chain</span> = (
 Â   {"context": retriever | format_docs, "question": RunnablePassthrough()}
 Â  Â | prompt
 Â  Â | llm
 Â  Â | StrOutputParser()
)
â€‹
print("RAG é“¾åˆå§‹åŒ–å®Œæˆ")
for i in rag_chain.stream({"question": "æ€ä¹ˆè‡ªå®šä¹‰çº¿ç¨‹æ± "}):
 Â  Â print(i, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>)
</code></pre>
<p>æˆ‘ä»¬è¿™é‡Œåœ¨æ„å»ºé“¾çš„æ—¶å€™ä½¿ç”¨äº†ä¸€ä¸ª** RunnablePassthrough() <strong>,è¿™ä¸ªçš„ä½œç”¨å°±æ˜¯å°†ç”¨æˆ·é—®çš„é—®é¢˜å¤åˆ¶æˆ–è€…è¯´æ˜¯ä¼ é€’åˆ° question è¿™é‡Œã€‚ä»¥åŠè¿™é‡Œçš„</strong>context**å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨æ£€ç´¢å™¨åœ¨é¡¹é“¾æ•°æ®åº“ä¸­æœç´¢åˆ°çš„å’Œé—®é¢˜ç›¸å…³çš„ä¸Šä¸‹æ–‡ã€‚</p>
<p>æ‰§è¡Œæµç¨‹ï¼š</p>
<pre><code class="hljs">ç”¨æˆ·è¾“å…¥ Question
RunnablePassthrough
åˆ†é…è¾“å…¥
Retriever
æ£€ç´¢ç›¸å…³æ–‡æ¡£
format_docs
æ•´ç†æ£€ç´¢åˆ°çš„æ–‡æ¡£
æ„å»º Prompt
ç»“åˆcontextå’Œquestion
LLM
å¤§è¯­è¨€æ¨¡å‹æ¨ç†
StrOutputParser
è§£æè¾“å‡ºä¸ºå­—ç¬¦ä¸²
æœ€ç»ˆå›ç­”
</code></pre>
<p>è¿è¡Œä»£ç æˆ‘ä»¬å‘ç°æœ‰æŠ¥é”™ï¼Œæ ¸å¿ƒæŠ¥é”™ä¿¡æ¯å¤§æ¦‚æ˜¯è¿™æ ·çš„ Lï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml">  <span class="hljs-attr">ValueError: status_code:</span> <span class="hljs-number">400</span>
 <span class="hljs-attr">code:</span> <span class="hljs-string">InvalidParameter</span>
 <span class="hljs-attr">message:</span> <span class="hljs-string">input.texts</span> <span class="hljs-string">should</span> <span class="hljs-string">be</span> <span class="hljs-string">array</span>
</code></pre>
<p>å¤§æ¦‚æ„æ€æ˜¯è¯´é˜¿é‡Œäº‘ç™¾ç‚¼çš„ dascope æ–‡æœ¬åµŒå…¥æ¨¡å‹ä¸æ”¯æŒ text çš„å‚æ•°ï¼Œè¾“å…¥çš„å¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„. æˆ‘ä»¬åœ¨è¯¦ç»†çœ‹ä¸€ä¸‹æŠ¥é”™æ—¥å¿—ï¼Œé‡Œé¢æœ‰è¿™ä¹ˆä¸€æ¡ä¿¡æ¯ <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f2532e953d94418b7a8cd80144ed451~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860354&amp;x-signature=mB%2FiH4XE6xbIASDsyAK6Zz7uiog%3D" alt="" loading="lazy"/> é—®é¢˜å¤§æ¦‚å°±æ˜¯å‡ºåœ¨è¿™é‡Œï¼Œä»–è¦æ±‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œä½†æ˜¯å‘¢æˆ‘ä»¬å®é™…ä¸Šä¼ é€’çš„æ˜¯ä¸€ä¸ª dictï¼Œå¯è¿›è¡Œæµå¼è°ƒç”¨çš„æ—¶å€™è¿™æ ·å†™æ˜¯æ²¡é—®é¢˜çš„ã€‚é‚£æˆ‘ä»¬è¿˜åœ¨é‚£é‡Œç”¨åˆ°äº†è¿™ä¸ªå‘¢ï¼Ÿ ä¸éš¾å‘ç°ï¼Œ</p>
<pre><code class="hljs language-css" lang="css">  rag_chain = (
    {"context": retriever | format_docs, <span class="hljs-string">"question"</span>: <span class="hljs-built_in">RunnablePassthrough</span>()}
    | prompt
    | llm
    | StrOutputParser()
)
</code></pre>
<p>å½“æˆ‘ä»¬æŠŠ retriever ç›´æ¥æ”¾åœ¨å­—å…¸å­—é¢é‡ä¸­ï¼ˆå¦‚ {"context": retriever, ...}ï¼‰æ—¶ï¼ŒLangChain ä¼šå°†æ•´ä¸ªé“¾çš„è¾“å…¥ï¼ˆå³ {"question": "æ€ä¹ˆè‡ªå®šä¹‰çº¿ç¨‹æ± "}ï¼‰ç›´æ¥ä¼ é€’ç»™ retriever.invoke()ã€‚è€Œ retriever çš„ invoke æ–¹æ³•æœŸæœ›æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºæŸ¥è¯¢ï¼ˆqueryï¼‰ï¼Œç»“æœå´æ”¶åˆ°äº†ä¸€ä¸ªå­—å…¸ï¼Œå¯¼è‡´åç»­è°ƒç”¨ embed_query(dict)ï¼Œä»è€Œå¼•å‘ç±»å‹é”™è¯¯ã€‚æ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦ä¿®æ”¹æˆ‘ä»¬çš„è°ƒç”¨é“¾. ä¿®æ”¹ä¹‹åçš„è°ƒç”¨é“¾å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">  rag_chain = (
    {
        "context": <span class="hljs-built_in">itemgetter</span>(<span class="hljs-string">"question"</span>) | retriever | format_docs,
        <span class="hljs-string">"question"</span>: <span class="hljs-built_in">itemgetter</span>(<span class="hljs-string">"question"</span>)
    }
    | prompt
    | llm
    | StrOutputParser()
)
</code></pre>
<p>ä¸»è¦ä¿®æ”¹å¦‚ä¸‹ï¼šä½¿ç”¨<strong>itemgetter</strong>å‡½æ•°æå– question çš„å€¼ã€‚ å…³äº<strong>itemgetter</strong>: temgetter æ˜¯ Python æ ‡å‡†åº“ operator æ¨¡å—ä¸­çš„ä¸€ä¸ªé«˜æ•ˆå·¥å…·å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼šåˆ›å»ºä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼ˆcallableï¼‰ï¼Œç”¨äºä»è¾“å…¥å¯¹è±¡ä¸­æå–æŒ‡å®šçš„å­—æ®µï¼ˆkeyï¼‰ã€‚</p>
<p>åŒæ—¶åœ¨<strong>format_docs</strong>å‡½æ•°ä¸­æ·»åŠ ä¸€äº›è°ƒè¯•ä¿¡æ¯ï¼Œè¯æ˜è¿›è¡Œäº†å‘é‡çš„æ£€ç´¢ï¼š å®Œæ•´ä»£ç å¦‚ä¸‹:</p>
<pre><code class="hljs language-ini" lang="ini"> Â <span class="hljs-comment"># ai_client.py</span>
import os
from langchain_community.chat_models import ChatTongyi
from langchain_community.document_loaders import DirectoryLoader, TextLoader, PyPDFLoader
from langchain_community.embeddings import DashScopeEmbeddings
from langchain_community.vectorstores import Chroma
from langchain.text_splitter import CharacterTextSplitter
from langchain_core.output_parsers import StrOutputParser
from langchain_core.prompts import ChatPromptTemplate
from operator import itemgetter
â€‹
from agent import embeddings
â€‹
import config
â€‹
â€‹
<span class="hljs-comment"># æ³¨å…¥ DashScope API Key</span>
if config.DASHSCOPE_API_KEY:
 Â  Â os.environ<span class="hljs-section">["DASHSCOPE_API_KEY"]</span> = config.DASHSCOPE_API_KEY
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– LLM</span>
<span class="hljs-attr">llm</span> = ChatTongyi(
 Â  Â <span class="hljs-attr">model</span>=config.MODEL,
 Â  Â <span class="hljs-attr">temperature</span>=config.TEMPERATURE,
)
â€‹
<span class="hljs-comment"># ========== åŠ è½½æ–‡æ¡£ ==========</span>
<span class="hljs-attr">all_docs</span> = []
try:
 Â  Â <span class="hljs-attr">txt_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.txt"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">md_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.md"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">pdf_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.pdf"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=PyPDFLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">all_docs</span> = (txt_docs or []) + (md_docs or []) + (pdf_docs or [])
except Exception as e:
 Â  Â print(f"æ–‡æ¡£åŠ è½½å¤±è´¥: {e}")
 Â  Â <span class="hljs-attr">all_docs</span> = []
â€‹
<span class="hljs-comment"># åˆ†å—</span>
<span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(separator=<span class="hljs-string">"\n\n"</span>, chunk_size=<span class="hljs-number">500</span>, chunk_overlap=<span class="hljs-number">80</span>)
<span class="hljs-attr">texts</span> = text_splitter.split_documents(all_docs) if all_docs else []
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– Embeddings</span>
<span class="hljs-attr">embeddings</span> =DashScopeEmbeddings(model=<span class="hljs-string">"text-embedding-v2"</span>)
â€‹
<span class="hljs-comment"># åˆå§‹åŒ–æˆ–åŠ è½½å‘é‡åº“</span>
<span class="hljs-attr">vectorstore</span> = None
if os.path.exists(config.EMBEDDINGS_DIR):
 Â  Â try:
 Â  Â  Â  Â <span class="hljs-attr">vectorstore</span> = Chroma(
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">embedding_function</span>=embeddings,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.EMBEDDINGS_DIR,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">collection_name</span>=config.COLLECTION_NAME,
 Â  Â  Â   )
 Â  Â except Exception as e:
 Â  Â  Â  Â print(f"åŠ è½½å‘é‡æ•°æ®åº“å¤±è´¥: {e}")
â€‹
if vectorstore is None:
 Â  Â <span class="hljs-attr">vectorstore</span> = Chroma.from_documents(
 Â  Â  Â  Â <span class="hljs-attr">documents</span>=texts,
 Â  Â  Â  Â <span class="hljs-attr">embedding</span>=embeddings,
 Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.EMBEDDINGS_DIR,
 Â  Â  Â  Â <span class="hljs-attr">collection_name</span>=config.COLLECTION_NAME,
 Â   )
else:
 Â  Â if texts:
 Â  Â  Â  Â try:
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">new_ids</span> = vectorstore.add_documents(texts)
 Â  Â  Â  Â  Â  Â print(f"æ–°å¢ {len(new_ids)} ä¸ªæ–‡æ¡£ç‰‡æ®µ")
 Â  Â  Â  Â except Exception as e:
 Â  Â  Â  Â  Â  Â print(f"å¢é‡æ›´æ–°å‘é‡åº“å¤±è´¥: {e}")
â€‹
<span class="hljs-attr">retriever</span> = vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: config.RAG_TOP_K})
â€‹
<span class="hljs-comment"># ========== æ„å»º RAG é“¾ ==========</span>
<span class="hljs-comment"># ========== æ„å»º RAG é“¾ ==========</span>
def format_docs(docs):
 Â  Â if not docs:
 Â  Â  Â  Â print("\nå‘é‡æ•°æ®åº“æ£€ç´¢ç»“æœï¼šæœªæ‰¾åˆ°ç›¸å…³æ–‡æ¡£\n")
 Â  Â  Â  Â return "æ— ç›¸å…³ä¸Šä¸‹æ–‡"
â€‹
 Â  Â print(f"\nå‘é‡æ•°æ®åº“æ£€ç´¢åˆ° {len(docs)} ç¯‡ç›¸å…³æ–‡æ¡£ï¼š")
 Â  Â for i, doc in enumerate(docs, 1):
 Â  Â  Â  Â <span class="hljs-comment"># æˆªå–å‰ 150 ä¸ªå­—ç¬¦ä½œä¸ºé¢„è§ˆï¼Œé¿å…æ—¥å¿—å¤ªé•¿</span>
 Â  Â  Â  Â <span class="hljs-attr">preview</span> = doc.page_content[:<span class="hljs-number">150</span>].replace(<span class="hljs-string">'\n'</span>, <span class="hljs-string">' '</span>).strip()
 Â  Â  Â  Â <span class="hljs-attr">source</span> = getattr(doc, <span class="hljs-string">'metadata'</span>, {}).get(<span class="hljs-string">'source'</span>, <span class="hljs-string">'æœªçŸ¥æ¥æº'</span>)
 Â  Â  Â  Â print(f"  <span class="hljs-section">[{i}]</span> æ¥æº: {source} | é¢„è§ˆ: "{preview}..."")
 Â  Â print() Â <span class="hljs-comment"># ç©ºè¡Œåˆ†éš”</span>
â€‹
 Â  Â return "\n\n".join(doc.page_content for doc in docs)
â€‹
<span class="hljs-attr">system_prompt</span> = (
 Â  Â "ä½ æ˜¯ä¸€åèµ„æ·± Java å¼€å‘ä¸“å®¶ï¼Œç²¾é€š JDK 8-17ã€Spring ç”Ÿæ€ã€å¹¶å‘ã€JVM è°ƒä¼˜ç­‰ã€‚\n"
 Â  Â "è¯·åŸºäºä»¥ä¸‹æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚å¦‚æœä¸Šä¸‹æ–‡ä¸ç›¸å…³ï¼Œè¯·ä»…åŸºäºä½ çš„çŸ¥è¯†å›ç­”ï¼Œä¸è¦ç¼–é€ ã€‚\n\n"
 Â  Â "ä¸Šä¸‹æ–‡ï¼š\n{context}"
)
â€‹
<span class="hljs-attr">prompt</span> = ChatPromptTemplate.from_messages([
 Â   (<span class="hljs-string">"system"</span>, system_prompt),
 Â   (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{question}"</span>),
])
â€‹
<span class="hljs-attr">rag_chain</span> = (
 Â   {
 Â  Â  Â  Â "context": itemgetter("question") | retriever | format_docs,
 Â  Â  Â  Â "question": itemgetter("question")
 Â   }
 Â  Â | prompt
 Â  Â | llm
 Â  Â | StrOutputParser()
)
print("RAG é“¾åˆå§‹åŒ–å®Œæˆ")
â€‹
for i in rag_chain.stream({"question": "æ€ä¹ˆè‡ªå®šä¹‰çº¿ç¨‹æ± ,ä¸ç”¨ç»™æˆ‘ä»£ç ï¼Œç®€å•è¯´ä¸è¶…è¿‡200ä¸ªå­—"}):
 Â  Â print(i, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>)
â€‹
â€‹
</code></pre>
<p>è¿è¡Œä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">0it [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, ?it/s]
<span class="hljs-number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="hljs-number">8</span>/<span class="hljs-number">8</span> [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>&lt;<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, <span class="hljs-number">3305.</span>86it/s]
0it [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, ?it/s]
<span class="hljs-title class_">Created</span> a chunk <span class="hljs-keyword">of</span> size <span class="hljs-number">762</span>, which is longer than the specified <span class="hljs-number">500</span>
<span class="hljs-title class_">Created</span> a chunk <span class="hljs-keyword">of</span> size <span class="hljs-number">601</span>, which is longer than the specified <span class="hljs-number">500</span>
<span class="hljs-title class_">Created</span> a chunk <span class="hljs-keyword">of</span> size <span class="hljs-number">560</span>, which is longer than the specified <span class="hljs-number">500</span>
/<span class="hljs-title class_">Users</span>/fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/agent/ai_client.<span class="hljs-property">py</span>:<span class="hljs-number">70</span>: <span class="hljs-title class_">LangChainDeprecationWarning</span>: <span class="hljs-title class_">The</span> <span class="hljs-keyword">class</span> <span class="hljs-string">`Chroma`</span> was deprecated <span class="hljs-keyword">in</span> <span class="hljs-title class_">LangChain</span> <span class="hljs-number">0.2</span><span class="hljs-number">.9</span> and will be removed <span class="hljs-keyword">in</span> <span class="hljs-number">1.0</span>. <span class="hljs-title class_">An</span> updated version <span class="hljs-keyword">of</span> the <span class="hljs-keyword">class</span> <span class="hljs-title class_">exists</span> <span class="hljs-keyword">in</span> the :<span class="hljs-attr">class</span>:<span class="hljs-string">`~langchain-chroma package and should be used instead. To use it run `</span>pip install -U :<span class="hljs-attr">class</span>:<span class="hljs-string">`~langchain-chroma`</span> and <span class="hljs-keyword">import</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`from :class:`</span>~langchain_chroma <span class="hljs-keyword">import</span> <span class="hljs-title class_">Chroma</span><span class="hljs-string">``</span>.
  vectorstore = <span class="hljs-title class_">Chroma</span>(
æ–°å¢ <span class="hljs-number">18</span> ä¸ªæ–‡æ¡£ç‰‡æ®µ
<span class="hljs-variable constant_">RAG</span> é“¾åˆå§‹åŒ–å®Œæˆ
â€‹
âœ… å‘é‡æ•°æ®åº“æ£€ç´¢åˆ° <span class="hljs-number">4</span> ç¯‡ç›¸å…³æ–‡æ¡£ï¼š
  ğŸ“„ [<span class="hljs-number">1</span>] æ¥æº: <span class="hljs-regexp">/Users/</span>fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/doc/java-thread-pool.<span class="hljs-property">md</span> | é¢„è§ˆ: <span class="hljs-string">"# Java çº¿ç¨‹æ± æœ€ä½³å®è·µ  ## åœºæ™¯ä¸ç›®æ ‡ - ç»Ÿä¸€ç®¡ç†çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯çš„å¼€é”€ - æ§åˆ¶å¹¶å‘åº¦ä¸ä»»åŠ¡æ’é˜Ÿç­–ç•¥ï¼ŒåŒ¹é…ä¸šåŠ¡å³°è°·  ## æ ¸å¿ƒå‚æ•°ä¸å«ä¹‰ - æ ¸å¿ƒçº¿ç¨‹æ•° corePoolSizeï¼šå¸¸é©»çº¿ç¨‹æ•°é‡ - æœ€å¤§çº¿ç¨‹æ•° maximumPoolSizeï¼šå³°å€¼å¹¶å‘ä¸Šé™ - å­˜æ´»æ—¶é—´ kee..."</span>
  ğŸ“„ [<span class="hljs-number">2</span>] æ¥æº: <span class="hljs-regexp">/Users/</span>fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/doc/java-thread-pool.<span class="hljs-property">md</span> | é¢„è§ˆ: <span class="hljs-string">"# Java çº¿ç¨‹æ± æœ€ä½³å®è·µ  ## åœºæ™¯ä¸ç›®æ ‡ - ç»Ÿä¸€ç®¡ç†çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯çš„å¼€é”€ - æ§åˆ¶å¹¶å‘åº¦ä¸ä»»åŠ¡æ’é˜Ÿç­–ç•¥ï¼ŒåŒ¹é…ä¸šåŠ¡å³°è°·  ## æ ¸å¿ƒå‚æ•°ä¸å«ä¹‰ - æ ¸å¿ƒçº¿ç¨‹æ•° corePoolSizeï¼šå¸¸é©»çº¿ç¨‹æ•°é‡ - æœ€å¤§çº¿ç¨‹æ•° maximumPoolSizeï¼šå³°å€¼å¹¶å‘ä¸Šé™ - å­˜æ´»æ—¶é—´ kee..."</span>
  ğŸ“„ [<span class="hljs-number">3</span>] æ¥æº: <span class="hljs-regexp">/Users/</span>fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/doc/java-thread-pool.<span class="hljs-property">md</span> | é¢„è§ˆ: <span class="hljs-string">"# Java çº¿ç¨‹æ± æœ€ä½³å®è·µ  ## åœºæ™¯ä¸ç›®æ ‡ - ç»Ÿä¸€ç®¡ç†çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯çš„å¼€é”€ - æ§åˆ¶å¹¶å‘åº¦ä¸ä»»åŠ¡æ’é˜Ÿç­–ç•¥ï¼ŒåŒ¹é…ä¸šåŠ¡å³°è°·  ## æ ¸å¿ƒå‚æ•°ä¸å«ä¹‰ - æ ¸å¿ƒçº¿ç¨‹æ•° corePoolSizeï¼šå¸¸é©»çº¿ç¨‹æ•°é‡ - æœ€å¤§çº¿ç¨‹æ•° maximumPoolSizeï¼šå³°å€¼å¹¶å‘ä¸Šé™ - å­˜æ´»æ—¶é—´ kee..."</span>
  ğŸ“„ [<span class="hljs-number">4</span>] æ¥æº: <span class="hljs-regexp">/Users/</span>fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/doc/java-thread-pool.<span class="hljs-property">md</span> | é¢„è§ˆ: <span class="hljs-string">"# Java çº¿ç¨‹æ± æœ€ä½³å®è·µ  ## åœºæ™¯ä¸ç›®æ ‡ - ç»Ÿä¸€ç®¡ç†çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯çš„å¼€é”€ - æ§åˆ¶å¹¶å‘åº¦ä¸ä»»åŠ¡æ’é˜Ÿç­–ç•¥ï¼ŒåŒ¹é…ä¸šåŠ¡å³°è°·  ## æ ¸å¿ƒå‚æ•°ä¸å«ä¹‰ - æ ¸å¿ƒçº¿ç¨‹æ•° corePoolSizeï¼šå¸¸é©»çº¿ç¨‹æ•°é‡ - æœ€å¤§çº¿ç¨‹æ•° maximumPoolSizeï¼šå³°å€¼å¹¶å‘ä¸Šé™ - å­˜æ´»æ—¶é—´ kee..."</span>
â€‹
è‡ªå®šä¹‰çº¿ç¨‹æ± éœ€è®¾ç½®æ ¸å¿ƒçº¿ç¨‹æ•°ã€æœ€å¤§çº¿ç¨‹æ•°ã€ç©ºé—²æ—¶é—´ã€ä»»åŠ¡é˜Ÿåˆ—ã€çº¿ç¨‹å·¥å‚å’Œæ‹’ç»ç­–ç•¥ã€‚æ ¹æ®ä¸šåŠ¡ç±»å‹ï¼ˆ<span class="hljs-variable constant_">CPU</span>/<span class="hljs-variable constant_">IO</span>å¯†é›†å‹ï¼‰åˆç†é…ç½®å‚æ•°ï¼Œä½¿ç”¨<span class="hljs-string">`ThreadPoolExecutor`</span>æ„é€ å‡½æ•°åˆ›å»ºï¼Œæ¨èç»“åˆç›‘æ§å’ŒåŠ¨æ€è°ƒæ•´èƒ½åŠ›ã€‚
<span class="hljs-title class_">Process</span> finished <span class="hljs-keyword">with</span> exit code <span class="hljs-number">0</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æµ…è°ˆweakä¸unowned]]></title>    <link>https://juejin.cn/post/7602850166732341257</link>    <guid>https://juejin.cn/post/7602850166732341257</guid>    <pubDate>2026-02-05T02:51:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602850166732341257" data-draft-id="7602940720690053166" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æµ…è°ˆweakä¸unowned"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2026-02-05T02:51:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çŒªè¦é£"/> <meta itemprop="url" content="https://juejin.cn/user/4369906906431690"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æµ…è°ˆweakä¸unowned
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4369906906431690/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çŒªè¦é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:51:10.000Z" title="Thu Feb 05 2026 02:51:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Â Â Â Â åœ¨iOSçš„å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šæœ‰AæŒæœ‰Bï¼Œä½†æ˜¯BåˆæŒæœ‰Açš„é—®é¢˜ï¼Œè¿™å°±æ˜¯è€ç”Ÿå¸¸è°ˆçš„å¾ªç¯å¼•ç”¨ï¼Œç›®å‰æœ€å¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨weakæˆ–è€…unownedå»æ‰“ç ´å¾ªç¯ã€‚æ¥ä¸‹æ¥æµ…è°ˆä¸‹ä¸¤è€…çš„åº•å±‚å®ç°åŸç†ä»¥åŠä¸¤è€…çš„å¯¹æ¯”ã€‚</p>
<h2 data-id="heading-0">weak</h2>
<p>Â Â Â Â weakçš„åº•å±‚åŸç†åˆ†ä¸º<code>Objective-C</code>ä¸<code>swift</code>çš„ä¸¤ç§ä¸åŒçš„æœºåˆ¶ã€‚ä¸¤è€…çš„æ ¸å¿ƒå·®å¼‚æ˜¯<code>ä¸­å¿ƒåŒ–</code>ä¸<code>å»ä¸­å¿ƒåŒ–</code>ã€‚</p>
<h3 data-id="heading-1">Objective-C</h3>
<p>Â Â Â Â åœ¨Objective-Cä¸­ç»´æŠ¤äº†ä¸€å¼ å…¨å±€çš„weakå“ˆå¸Œè¡¨ï¼Œæ‰€æœ‰çš„weakæŒ‡é’ˆéƒ½ä¼šå­˜å‚¨åœ¨è¿™é‡Œï¼Œæ­¤å¤„å­˜å‚¨çš„<strong>keyæ˜¯å¯¹è±¡çš„åœ°å€ï¼ŒValueæ˜¯weakæŒ‡é’ˆçš„åœ°å€</strong>ï¼ˆweakæŒ‡é’ˆå°±æ˜¯ç”¨çš„åœ°æ–¹çš„åœ°å€ï¼Œæ¯”å¦‚weak var a = temp() é‚£ä¹ˆweakæŒ‡é’ˆå°±æ˜¯açš„åœ°å€ï¼‰ï¼Œvalueæ ¹æ®weakæŒ‡é’ˆçš„æ•°é‡è°ƒæ•´valueæ˜¯ä¸€ä¸ªæ•°ç»„è¿˜æ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨ã€‚å½“å¯¹è±¡æ­»äº¡æ—¶ï¼Œä¼šå¯¹å¤§å“ˆå¸Œè¡¨è¿›è¡ŒæŸ¥æ‰¾ï¼Œç„¶åå»æ‰¾åˆ°keyå¯¹åº”çš„weakæŒ‡é’ˆè¿›è¡Œç½®ç©ºã€‚</p>
<p>Â Â Â Â OCçš„weaké”€æ¯ç›¸å¯¹æ¥è¯´ä¼šæ¯”è¾ƒæš´åŠ›ï¼Œä¸‹æ–¹ä¸ºä¸€ä¸ªé”€æ¯çš„ä¾‹å­ã€‚</p>
<pre><code class="hljs language-objectivec" lang="objectivec"><span class="hljs-comment">// 1. åˆ›å»ºå¯¹è±¡ (å‡å®š obj æŒ‡å‘ 0xA00)</span>
<span class="hljs-built_in">NSObject</span> *obj = [[<span class="hljs-built_in">NSObject</span> alloc] init]; 
<span class="hljs-comment">// 2. å£°æ˜ weak æŒ‡é’ˆ (å‡å®š p å˜é‡æœ¬èº«çš„åœ°å€æ˜¯ 0xB00)</span>
<span class="hljs-comment">// æ­¤æ—¶ Runtime å¼€å§‹ä»‹å…¥</span>
__<span class="hljs-keyword">weak</span> <span class="hljs-built_in">NSObject</span> *p = obj;

<span class="hljs-number">1.</span>å½“ obj çš„å¼•ç”¨è®¡æ•°ä¸º <span class="hljs-number">0</span> åˆ™å‡†å¤‡é”€æ¯ã€‚
<span class="hljs-number">2.</span>deallcå¼€å§‹è°ƒç”¨Runtimeçš„æ¸…é™¤å‡½æ•°ã€‚
<span class="hljs-number">3.</span>Runtimeä¼šæ‹¿ç€objçš„åœ°å€<span class="hljs-number">0xA00</span>å»<span class="hljs-keyword">weak</span>è¡¨å»æŸ¥æ‰¾
<span class="hljs-number">4.</span>æ‰¾åˆ°ä¹‹åå–å‡ºValueï¼š[<span class="hljs-number">0xB00</span>,<span class="hljs-number">0xC00</span>,<span class="hljs-number">0xD00</span> ... ]
<span class="hljs-number">5.</span>æ ¸å¿ƒæ“ä½œï¼šRuntimeéå†è¿™ä¸ªåå•ï¼Œé€šè¿‡åœ°å€æ‰¾åˆ°å˜é‡p <span class="hljs-number">0xB00</span>
  å¼ºè¡Œå°†<span class="hljs-number">0xB00</span>å†…å­˜é‡Œçš„æ•°æ®å†™æˆ<span class="hljs-number">0</span> (<span class="hljs-literal">nil</span>)
<span class="hljs-number">6.</span>é”€æ¯<span class="hljs-keyword">weak</span>è¡¨ä¸­çš„è¿™æ¡è®°å½•
</code></pre>
<h3 data-id="heading-2">swift</h3>
<p>Â Â Â Â swifté‡‡ç”¨äº†ä¸€ç§æ›´åŠ é«˜æ•ˆçš„æ–¹å¼ï¼Œå«åš <strong>Side table (æ•£åˆ—è¡¨/è¾…åŠ©è¡¨)</strong> ç»“åˆ <strong>æƒ°æ€§ç½®ç©º (Lazy Zroing)</strong>  æ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šæ‹¥æœ‰ç±»ä¼¼OCä¸­çš„weakè¡¨ï¼ŒweakæŒ‡é’ˆæŒ‡å‘çš„æ˜¯è¿™ä¸ªweakè¡¨ä¸æ˜¯å¯¹è±¡æœ¬èº«ï¼Œå¦‚æœæ˜¯å¼ºå¼•ç”¨åˆ™æŒ‡å‘çš„æ˜¯å¯¹è±¡åœ°å€ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">HeapObject</span> { <span class="hljs-comment">// è¿™ä¸ªæ˜¯å¯¹è±¡çš„å¤´éƒ¨</span>
    <span class="hljs-type">Metadata</span> <span class="hljs-operator">*</span>isa;
    <span class="hljs-comment">// 64ä½ä»…ä»…æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå­˜ç€ Strong å’Œ Unowned è®¡æ•°</span>
    <span class="hljs-comment">// å½“æœ‰weakæŒ‡å‘å®ƒï¼Œå®ƒå°±ä¼šå˜åŒ–ä¸ºä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘åœ¨å †ä¸Šé¢å¤–å¼€è¾Ÿçš„Side Tableã€‚</span>
    uint64_t refCounts; 
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SideTable</span> {
    <span class="hljs-type">HeapObject</span> <span class="hljs-operator">*</span>object;         <span class="hljs-comment">// 1. æŒ‡å›åŸå¯¹è±¡çš„æŒ‡é’ˆ</span>
    <span class="hljs-type">Atomic</span>&lt;<span class="hljs-type">StrongRefCount</span>&gt; strong; <span class="hljs-comment">// 2. å¼ºå¼•ç”¨è®¡æ•°</span>
    <span class="hljs-type">Atomic</span>&lt;<span class="hljs-type">UnownedRefCount</span>&gt; <span class="hljs-keyword">unowned</span>; <span class="hljs-comment">// 3. æ— ä¸»å¼•ç”¨è®¡æ•°</span>
    <span class="hljs-type">Atomic</span>&lt;<span class="hljs-type">WeakRefCount</span>&gt; <span class="hljs-keyword">weak</span>;     <span class="hljs-comment">// 4. å¼±å¼•ç”¨è®¡æ•° (å…³é”®ï¼)</span>
}
</code></pre>
<p>Â Â Â Â è¿™å¼ å›¾å¯ä»¥ä½œä¸ºç†è§£çš„å‚è€ƒã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0068350497e247f9b2cf5be106533246~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54yq6KaB6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770864669&amp;x-signature=6YfMk8HyIZfk0yb1lZGUQh4Bk8w%3D" alt="weak.png" loading="lazy"/></p>
<p>Â Â Â Â åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œåˆäº§ç”Ÿä¸ªç–‘é—®ï¼Œé¿å…åç»­å¿˜è®°ç°åœ¨è®°å½•ä¸‹æ¥ï¼Œå°±æ˜¯å½“æ—¢æœ‰weakæŒ‡å‘Aåˆæœ‰strongæŒ‡å‘Aï¼Œé‚£ä¹ˆstrongæ˜¯æ€æ ·å·¥ä½œçš„ï¼Ÿç­”æ¡ˆæ˜¯ï¼šstrongæŒ‡å‘Açš„ä¼šç›´æ¥è¯»å–Aï¼Œå‘ç°æœ‰side tableè¡¨å°±ä¼šè¿›è¡Œè¯»å–æŒ‡é’ˆæ‰¾åˆ°è¿™ä¸ªè¡¨ï¼Œç„¶ååœ¨è¡¨ä¸Šstrongè®¡æ•°åŠ ä¸€ï¼ŒåŒç†strongæ¶ˆå¤±ä¹Ÿä¼šæ‰¾åˆ°æ­¤å¤„è¿›è¡Œå‡ä¸€ã€‚</p>
<p>Â Â Â Â æƒ°æ€§ç½®ç©ºæœºåˆ¶ï¼šswiftå¹¶ä¸åƒOCé‚£æ ·ç»Ÿä¸€å»æŠ¹é™¤weakæŒ‡é’ˆï¼Œè€Œæ˜¯åœ¨ä½ å»è®¿é—®side tableè¡¨çš„æ—¶å€™æ‰ä¼šè¿”å›nilï¼Œå¹¶ä¸”å°†weakæ•°å‡ä¸€ã€‚è¿™ä¸ªside tableè¡¨åœ¨å¯¹è±¡è¢«é”€æ¯çš„æ—¶å€™ï¼Œä¼šä¿ç•™ç›´è‡³weakæ•°ç­‰äº0æ‰ä¼šè¢«é‡Šæ”¾æ‰ã€‚</p>
<h2 data-id="heading-3">unowned</h2>
<p>Â Â Â Â  è¿™ä¸ªå°±ä»¥swiftçš„ä¸ºä¸»ï¼Œæ¯•ç«Ÿè¿™ä¸ªçš„ä½¿ç”¨æ˜¯éå¸¸çš„å°‘ï¼Œé¦–å…ˆè¯´ä¸‹å¯¹è±¡çš„ä¸‰æ®µå¼ç”Ÿå‘½å‘¨æœŸï¼Œswiftå¹¶ä¸æ˜¯å¯¹è±¡ä¸€æ­»å°±æ¶ˆå¤±ã€‚</p>





























<table><thead><tr><th>é˜¶æ®µ</th><th>æ¡ä»¶</th><th>çŠ¶æ€æè¿°</th><th>å†…å­˜æƒ…å†µ</th></tr></thead><tbody><tr><td><strong>1. Live (å­˜æ´»)</strong></td><td>Strong &gt; 0</td><td>å¯¹è±¡æ­£å¸¸å·¥ä½œã€‚</td><td>å®Œæ•´å†…å­˜ã€‚</td></tr><tr><td><strong>2. Deinited (åƒµå°¸)</strong></td><td>Strong = 0Â <br/>Â Unowned &gt; 0</td><td><strong>deinitÂ å·²æ‰§è¡Œ</strong>ï¼Œå±æ€§å·²é”€æ¯ã€‚ä½†<strong>å¯¹è±¡å¤´éƒ¨ï¼ˆHeapObjectï¼‰è¿˜åœ¨</strong>ã€‚</td><td><strong>å±æ€§å†…å­˜é‡Šæ”¾ï¼Œå¤´éƒ¨å†…å­˜ä¿ç•™ã€‚</strong></td></tr><tr><td><strong>3. Dead (æ­»äº¡)</strong></td><td>Strong = 0Â <br/>Â Unowned = 0</td><td>å¯¹è±¡å½»åº•æ¶ˆå¤±ã€‚</td><td><strong>å¤´éƒ¨å†…å­˜è¢«Â freeã€‚</strong></td></tr></tbody></table>
<p><strong>A. èµ‹å€¼é˜¶æ®µ (unowned var p = obj)</strong><br/>
å½“åœ¨è¿™ä¸ªå¼•ç”¨è¢«èµ‹å€¼æ—¶ï¼š</p>
<ul>
<li>
<p>RuntimeÂ <strong>ä¸ä¼š</strong>å¢åŠ Â Strong Countã€‚</p>
</li>
<li>
<p>RuntimeÂ <strong>ä¼š</strong>å¢åŠ Â Unowned CountÂ (+1)ã€‚</p>
</li>
<li>
<p><strong>åæœ</strong>ï¼šåªè¦Â pÂ è¿˜åœ¨ï¼ŒobjÂ å°±ç®—æ­»ï¼ˆStrong=0ï¼‰ï¼Œä¹Ÿä¸èƒ½æ­»é€ï¼ˆè¿›å…¥ Dead é˜¶æ®µï¼‰ï¼Œå®ƒå¿…é¡»å¡åœ¨ Deinited é˜¶æ®µï¼Œä¿ç•™å¤´éƒ¨ç»™Â pÂ åšæ£€æŸ¥ã€‚</p>
</li>
</ul>
<p><strong>B. è®¿é—®é˜¶æ®µ (print(p.name))</strong><br/>
å½“ä½ è®¿é—®ä¸€ä¸ªÂ unownedÂ å˜é‡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ’å…¥æ£€æŸ¥ä»£ç ï¼ˆswift_unownedLoadStrongï¼‰ï¼š</p>
<ol>
<li>
<p><strong>ç›´æ¥å¯»å€</strong>ï¼šæ‹¿ç€æŒ‡é’ˆç›´æ¥æ‰¾åˆ°å†…å­˜ä¸­çš„å¯¹è±¡å¤´éƒ¨ï¼ˆæ­¤æ—¶å†…å­˜è‚¯å®šæ²¡è¢«æ“ä½œç³»ç»Ÿå›æ”¶ï¼Œå› ä¸º Unowned Count &gt; 0ï¼‰ã€‚</p>
</li>
<li>
<p><strong>åŸå­æ£€æŸ¥</strong>ï¼šè¯»å–å¤´éƒ¨å¼•ç”¨è®¡æ•°çš„çŠ¶æ€ä½ã€‚</p>
</li>
<li>
<p><strong>åˆ†æ”¯åˆ¤æ–­</strong>ï¼š</p>
<ul>
<li>
<p>å¦‚æœå¯¹è±¡æ˜¯Â <strong>Live</strong>ï¼šåŸå­æ“ä½œè®© Strong + 1ï¼Œæ­£å¸¸è¿”å›å¯¹è±¡å¼•ç”¨ã€‚</p>
</li>
<li>
<p>å¦‚æœå¯¹è±¡æ˜¯Â <strong>Deinited</strong>ï¼šè¯´æ˜å¯¹è±¡é€»è¾‘å·²æ­»ï¼ˆå±æ€§éƒ½æ²¡äº†ï¼‰ï¼Œæ­¤æ—¶ä½ è¿˜æ¥è®¿é—®ï¼Œè§¦å‘Â <strong>swift_abortRetainUnowned</strong>ï¼Œå¯¼è‡´ AppÂ <strong>å´©æºƒ</strong>ã€‚</p>
</li>
</ul>
</li>
</ol>
<p><strong>C. é”€æ¯é˜¶æ®µ</strong><br/>
å½“æŒæœ‰Â unownedÂ å¼•ç”¨çš„å˜é‡Â pÂ ç¦»å¼€ä½œç”¨åŸŸæˆ–è¢«é”€æ¯æ—¶ï¼š</p>
<ul>
<li>
<p>å®ƒä¼šå‡å°‘å¯¹è±¡çš„Â Unowned CountÂ (-1)ã€‚</p>
</li>
<li>
<p>å¦‚æœæ­¤æ—¶Â Strong == 0Â ä¸”Â Unowned == 0ï¼Œå¯¹è±¡æ‰ä¼šçœŸæ­£è°ƒç”¨Â free()Â é‡Šæ”¾å¤´éƒ¨çš„ç‰©ç†å†…å­˜ã€‚</p>
</li>
</ul>
<p><strong>swiftä¸­çš„unownedæ˜¯ç›¸å¯¹æ¥è¯´æ˜¯å®‰å…¨çš„ï¼Œä»…ä»…ä¼šè§¦å‘crashå¹¶ä¸ä¼šå˜æˆé‡æŒ‡é’ˆå»è®¿é—®è„æ•°æ®</strong></p>
<h2 data-id="heading-4">æ€»ç»“</h2>
<p>Â Â Â Â æ— è®ºæ˜¯weakè¿˜æ˜¯unownedï¼Œéƒ½æ˜¯ä¸ºäº†è§£å†³å¾ªç¯å¼•ç”¨è¿™ä¸ªé—®é¢˜ï¼Œä»–ä»¬çš„è§£å†³æ–¹å¼éƒ½æ˜¯ï¼Œstrongçš„å¼•ç”¨è®°æ•°ä¸å¢åŠ ï¼Œè€Œæ˜¯ä¸€ä¸ªæ–°çš„ä»£è¡¨è¿™ä¸ªçš„è‹¥å¼•ç”¨æ— ä¸»å¼•ç”¨çš„è®¡æ•°ï¼Œå»æ‰“ç ´å¼ºæŒæœ‰ï¼Œä»è€Œå»è§£å†³è¿™ä¸ªæœ‰å¯èƒ½äº§ç”Ÿçš„å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</p>
<p>Â Â Â Â æ•´ä½“ä¸Šæ¥è¯´weakæ›´åŠ å®‰å…¨ï¼Œå°±ç®—è®¿é—®çš„å¯¹è±¡å·²ç»é”€æ¯ä¹Ÿä¸ä¼šå¯¼è‡´å´©æºƒï¼Œè€Œunownedæœ€å¥½çš„æƒ…å†µå°±æ˜¯å´©æºƒï¼Œæœ€åçš„æƒ…å†µè®¿é—®åˆ°è„æ•°æ®ï¼Œå¯¼è‡´å±•ç¤ºæ•°æ®é¡µé¢ç­‰ç­‰çš„é”™è¯¯ï¼Œä½†æ˜¯unownedçš„é€Ÿåº¦ä»¥æå°çš„ä¼˜åŠ¿è¶…è¿‡äº†weakï¼Œè¿˜æ˜¯æ¨èä½¿ç”¨weakï¼Œéå¿…è¦ä¸ä½¿ç”¨unownedã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python GeoPandasåŸºç¡€çŸ¥è¯†ï¼šåœ°å›¾ã€æŠ•å½±å’Œç©ºé—´è¿æ¥]]></title>    <link>https://juejin.cn/post/7602901565025845257</link>    <guid>https://juejin.cn/post/7602901565025845257</guid>    <pubDate>2026-02-05T01:43:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901565025845257" data-draft-id="7602910573405028390" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python GeoPandasåŸºç¡€çŸ¥è¯†ï¼šåœ°å›¾ã€æŠ•å½±å’Œç©ºé—´è¿æ¥"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-02-05T01:43:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ·±åº¦æ¶Œç°"/> <meta itemprop="url" content="https://juejin.cn/user/2524932621734990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python GeoPandasåŸºç¡€çŸ¥è¯†ï¼šåœ°å›¾ã€æŠ•å½±å’Œç©ºé—´è¿æ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524932621734990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ·±åº¦æ¶Œç°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:43:44.000Z" title="Thu Feb 05 2026 01:43:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>GeoPandas æ‰©å±•äº† pandas çš„åŠŸèƒ½ï¼Œä½¿åœ¨ Python ä¸­å¤„ç†åœ°ç†ç©ºé—´æ•°æ®æ›´åŠ ç›´è§‚å’Œå¼ºå¤§ã€‚å¦‚æœæ‚¨å¸Œæœ›åœ¨ Python ä¸­æ‰§è¡Œåœ°ç†ç©ºé—´ä»»åŠ¡ï¼Œå¹¶éœ€è¦ä¸€ä¸ªå…·æœ‰ç±»ä¼¼ pandas API çš„åº“ï¼Œé‚£ä¹ˆ GeoPandas æ˜¯ä¸€ä¸ªç»ä½³çš„é€‰æ‹©ã€‚æœ¬æ•™ç¨‹å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•å®Œæˆå››ä¸ªå¸¸è§çš„åœ°ç†ç©ºé—´ä»»åŠ¡ï¼šè¯»å–æ•°æ®ã€ç»˜åˆ¶åœ°å›¾ã€åº”ç”¨æŠ•å½±ä»¥åŠè¿›è¡Œç©ºé—´è¿æ¥ã€‚</p>
<p><strong>çœ‹å®Œæœ¬æ•™ç¨‹ï¼Œæ‚¨å°†æ˜ç™½ï¼š</strong></p>
<ul>
<li><strong>GeoPandas æ‰©å±•äº† pandas çš„</strong>åŠŸèƒ½ï¼Œä½¿å…¶æ”¯æŒç©ºé—´æ•°æ®ã€‚è¿™äº›æ•°æ®é€šå¸¸å­˜å‚¨åœ¨ <code>geometry</code> åˆ—ä¸­ï¼Œå¹¶å…è®¸è¿›è¡Œ<strong>ç©ºé—´æ“ä½œï¼Œ<strong>ä¾‹å¦‚æŠ•å½±å’Œç©ºé—´è¿æ¥ï¼›è€Œ</strong>Folium</strong>åˆ™ä¸“æ³¨äºåœ¨æ•°æ®å‡†å¤‡ååˆ›å»ºæ›´ä¸°å¯Œçš„äº¤äº’å¼ Web åœ°å›¾ã€‚</li>
<li>æ‚¨å¯ä»¥ä½¿ç”¨ <code>.crs</code><strong>æ£€æŸ¥ CRSï¼ˆCoordinate Reference Systemsï¼Œåæ ‡å‚è€ƒç³»ç»Ÿï¼‰</strong> ï¼Œå¹¶ä½¿ç”¨ <code>.to_crs()</code> å’Œæƒå¨ä»£ç ï¼ˆå¦‚ <code>EPSG:4326</code> æˆ– <code>ESRI:54009</code>ï¼‰<strong>é‡æ–°æŠ•å½±</strong>æ•°æ®ã€‚</li>
<li><strong>åœ°ç†åæ ‡å‚è€ƒç³»</strong>ä»¥åº¦ä¸ºå•ä½å­˜å‚¨ç»åº¦å’Œçº¬åº¦ï¼Œè€Œ<strong>æŠ•å½±åæ ‡å‚è€ƒ</strong>ç³»ä½¿ç”¨ç±³æˆ–è‹±å°ºç­‰çº¿æ€§å•ä½è¿›è¡Œé¢ç§¯å’Œè·ç¦»è®¡ç®—ã€‚</li>
<li>ç©ºé—´è¿æ¥ä½¿ç”¨ <code>.sjoin()</code> ä»¥åŠè°“è¯ï¼Œä¾‹å¦‚ <code>"within"</code> æˆ– <code>"intersects"</code>ï¼Œå¹¶ä¸”<strong>ä¸¤ä¸ªè¾“å…¥å¿…é¡»å…±äº«ç›¸åŒçš„ CRS</strong> ï¼Œå¦åˆ™å…³ç³»å°†è®¡ç®—é”™è¯¯ã€‚</li>
</ul>
<p>ä»¥ä¸‹æ˜¯ GeoPandas ä¸å…¶ä»–æ›¿ä»£åº“çš„æ¯”è¾ƒï¼š</p>





























<table><thead><tr><th>Use Case</th><th>Pick pandas</th><th>Pick Folium</th><th>Pick GeoPandas</th></tr></thead><tbody><tr><td>Tabular data analysis</td><td>âœ…</td><td>-</td><td>âœ…</td></tr><tr><td>Mapping</td><td>-</td><td>âœ…</td><td>âœ…</td></tr><tr><td>Projections, spatial joins</td><td>-</td><td>-</td><td>âœ…</td></tr></tbody></table>
<p>GeoPandas åœ¨ pandas çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†å¯¹åœ°ç†ç©ºé—´æ•°æ®å’Œæ“ä½œï¼ˆä¾‹å¦‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMap_projection" target="_blank" title="https://en.wikipedia.org/wiki/Map_projection" ref="nofollow noopener noreferrer">æŠ•å½±</a>å’Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FSpatial_join" target="_blank" title="https://en.wikipedia.org/wiki/Spatial_join" ref="nofollow noopener noreferrer">ç©ºé—´è¿æ¥ï¼‰</a>çš„æ”¯æŒã€‚å®ƒè¿˜åŒ…å«ç”¨äºåˆ›å»ºåœ°å›¾çš„å·¥å…·ã€‚Folium<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fpython-folium-web-maps-from-data%2F" target="_blank" title="https://realpython.com/python-folium-web-maps-from-data/" ref="nofollow noopener noreferrer">åˆ™</a>ä¸“æ³¨äºäº¤äº’å¼ã€åŸºäº Web çš„åœ°å›¾ï¼Œç”¨æˆ·å¯ä»¥å¯¹å…¶è¿›è¡Œæ›´æ·±å…¥çš„è‡ªå®šä¹‰ï¼Œä»è€Œä¸ GeoPandas å½¢æˆäº’è¡¥ã€‚</p>
<h2 data-id="heading-0">GeoPandaså…¥é—¨</h2>
<p>é¦–å…ˆï¼Œæ‚¨éœ€è¦å‡†å¤‡ç¯å¢ƒå¹¶åŠ è½½ä¸€ä¸ªå°å‹æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†å°†åœ¨æ•´ä¸ªæ•™ç¨‹ä¸­ä½¿ç”¨ã€‚åœ¨æ¥ä¸‹æ¥çš„ä¸¤ä¸ªå°èŠ‚ä¸­ï¼Œæ‚¨å°†å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…å¹¶è¯»å–çº½çº¦å¸‚è¡Œæ”¿åŒºè¾¹ç•Œçš„ç¤ºä¾‹æ•°æ®é›†ã€‚è¿™å°†ä¸ºæ‚¨æä¾›ä¸€ä¸ªå…·ä½“çš„ GeoDataFrameï¼Œä¾›æ‚¨åœ¨å­¦ä¹ æ ¸å¿ƒæ¦‚å¿µçš„è¿‡ç¨‹ä¸­è¿›è¡Œæ¢ç´¢ã€‚</p>
<h3 data-id="heading-1">å®‰è£… GeoPandas</h3>
<p>æœ¬æ•™ç¨‹ä½¿ç”¨ä¸¤ä¸ªè½¯ä»¶åŒ…ï¼š<code>geopandas</code> ç”¨äºå¤„ç†åœ°ç†æ•°æ®ï¼Œ<code>geodatasets</code> ç”¨äºåŠ è½½ç¤ºä¾‹æ•°æ®ã€‚å»ºè®®å°†è¿™äº›è½¯ä»¶åŒ…å®‰è£…åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fpython-virtual-environments-a-primer%2F" target="_blank" title="https://realpython.com/python-virtual-environments-a-primer/" ref="nofollow noopener noreferrer">è™šæ‹Ÿç¯å¢ƒ</a>ä¸­ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿é¡¹ç›®ä¸ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†éš”ç¦»ï¼Œå¹¶ä¾¿äºç®¡ç†å…¶<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fref%2Fglossary%2Fdependency%2F" target="_blank" title="https://realpython.com/ref/glossary/dependency/" ref="nofollow noopener noreferrer">ä¾èµ–é¡¹</a>ã€‚</p>
<p>è™šæ‹Ÿç¯å¢ƒæ¿€æ´»åï¼Œæ‚¨å¯ä»¥<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fwhat-is-pip%2F" target="_blank" title="https://realpython.com/what-is-pip/" ref="nofollow noopener noreferrer">install both packages with <code>pip</code></a>ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-variable">$ </span>python -m pip install <span class="hljs-string">"geopandas[all]"</span> geodatasets
</code></pre>
<p>ä½¿ç”¨ <code>[all]</code> é€‰é¡¹å¯ç¡®ä¿æ‚¨æ‹¥æœ‰è¯»å–æ•°æ®ã€è½¬æ¢åæ ‡ç³»å’Œåˆ›å»ºå›¾è¡¨æ‰€éœ€çš„ä¸€åˆ‡ã€‚å¯¹äºå¤§å¤šæ•°è¯»è€…æ¥è¯´ï¼Œè¿™å¥—æ–¹æ¡ˆå¼€ç®±å³ç”¨ã€‚</p>
<p>å¦‚æœé‡åˆ°å®‰è£…é—®é¢˜ï¼Œé¡¹ç›®ç»´æŠ¤è€…åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgeopandas.org%2Fen%2Fstable%2Fgetting_started%2Finstall.html" target="_blank" title="https://geopandas.org/en/stable/getting_started/install.html" ref="nofollow noopener noreferrer">å®˜æ–¹å®‰è£…é¡µé¢</a>ä¸Šæä¾›äº†æ›¿ä»£å®‰è£…é€‰é¡¹ã€‚</p>
<h3 data-id="heading-2">è¯»å–å’Œæ•°æ®</h3>
<p>å¤§å¤šæ•°åœ°ç†ç©ºé—´æ•°æ®é›†é‡‡ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FGeoJSON" target="_blank" title="https://en.wikipedia.org/wiki/GeoJSON" ref="nofollow noopener noreferrer">GeoJSON</a>æˆ–<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FShapefile" target="_blank" title="https://en.wikipedia.org/wiki/Shapefile" ref="nofollow noopener noreferrer">shapefile</a>æ ¼å¼ã€‚<code>read_file()</code> å‡½æ•°å¯ä»¥è¯»å–è¿™ä¸¤ç§æ ¼å¼ï¼Œå¹¶ä¸”æ¥å—æœ¬åœ°æ–‡ä»¶è·¯å¾„æˆ– URL ä½œä¸ºå‚æ•°ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨ <code>read_file()</code> åŠ è½½çº½çº¦å¸‚è¡Œæ”¿åŒºè¾¹ç•Œ (NYBB) æ•°æ®é›†ã€‚<code>geodatasets</code> åŒ…æä¾›äº†ä¸€ä¸ªä¾¿æ·çš„æ•°æ®é›†è·¯å¾„ï¼Œå› æ­¤æ‚¨æ— éœ€æ‰‹åŠ¨ä¸‹è½½ä»»ä½•å†…å®¹ã€‚æ‚¨è¿˜å°†åˆ é™¤ä¸å¿…è¦çš„åˆ—ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> geopandas <span class="hljs-keyword">as</span> gpd
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> geodatasets <span class="hljs-keyword">import</span> get_path
<span class="hljs-meta">&gt;&gt;&gt; </span>path_to_data = get_path(<span class="hljs-string">"nybb"</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>nybb = gpd.read_file(path_to_data)
<span class="hljs-meta">&gt;&gt;&gt; </span>nybb = nybb[[<span class="hljs-string">"BoroName"</span>, <span class="hljs-string">"Shape_Area"</span>, <span class="hljs-string">"geometry"</span>]]
<span class="hljs-meta">&gt;&gt;&gt; </span>nybb
    BoroName        Shape_Area      geometry
<span class="hljs-number">0</span>   Staten Island   <span class="hljs-number">1.623820e+09</span>    MULTIPOLYGON (((<span class="hljs-number">970217.022</span> <span class="hljs-number">145643.332</span>, ....
<span class="hljs-number">1</span>   Queens          <span class="hljs-number">3.045213e+09</span>    MULTIPOLYGON (((<span class="hljs-number">1029606.077</span> <span class="hljs-number">156073.814</span>, ...
<span class="hljs-number">2</span>   Brooklyn        <span class="hljs-number">1.937479e+09</span>    MULTIPOLYGON (((<span class="hljs-number">1021176.479</span> <span class="hljs-number">151374.797</span>, ...
<span class="hljs-number">3</span>   Manhattan       <span class="hljs-number">6.364715e+08</span>    MULTIPOLYGON (((<span class="hljs-number">981219.056</span> <span class="hljs-number">188655.316</span>, ....
<span class="hljs-number">4</span>   Bronx           <span class="hljs-number">1.186925e+09</span>    MULTIPOLYGON (((<span class="hljs-number">1012821.806</span> <span class="hljs-number">229228.265</span>, ...
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">type</span>(nybb)
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'geopandas.geodataframe.GeoDataFrame'</span>&gt;
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">type</span>(nybb[<span class="hljs-string">"geometry"</span>])
&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">'geopandas.geoseries.GeoSeries'</span>&gt;
</code></pre>
<p><code>nybb</code> æ˜¯ä¸€ä¸ª<strong>GeoDataFrameã€‚GeoDataFrame</strong>æ‹¥æœ‰è¡Œã€åˆ—ä»¥åŠ<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fpandas-dataframe%2F" target="_blank" title="https://realpython.com/pandas-dataframe/" ref="nofollow noopener noreferrer">pandas DataFrame</a>çš„æ‰€æœ‰æ–¹æ³•ã€‚åŒºåˆ«åœ¨äºå®ƒé€šå¸¸åŒ…å«ä¸€ä¸ªç‰¹æ®Šçš„ <code>geometry</code> åˆ—ï¼Œç”¨äºå­˜å‚¨åœ°ç†å½¢çŠ¶ï¼Œè€Œä¸æ˜¯çº¯æ•°å­—æˆ–æ–‡æœ¬ã€‚</p>
<p><code>geometry</code> åˆ—æ˜¯ä¸€ä¸ª <code>GeoSeries</code>ã€‚å®ƒçš„è¡Œä¸ºç±»ä¼¼äºæ™®é€šçš„ pandas <code>Series</code>ï¼Œä½†å®ƒçš„å€¼æ˜¯ç©ºé—´å¯¹è±¡ï¼Œæ‚¨å¯ä»¥å¯¹å…¶è¿›è¡Œæ˜ å°„å¹¶è¿è¡Œç©ºé—´æŸ¥è¯¢ã€‚åœ¨ <code>nybb</code> æ•°æ®é›†ä¸­ï¼Œæ¯ä¸ªè¡Œæ”¿åŒºçš„å‡ ä½•å›¾å½¢éƒ½æ˜¯ä¸€ä¸ª <code>MultiPolygon</code>â€”â€”ç”±å¤šä¸ªå¤šè¾¹å½¢ç»„æˆâ€”â€”å› ä¸ºæ¯ä¸ªè¡Œæ”¿åŒºéƒ½åŒ…å«å¤šä¸ªå²›å±¿ã€‚å¾ˆå¿«ï¼Œæ‚¨å°†ä½¿ç”¨è¿™äº›å‡ ä½•å›¾å½¢æ¥åˆ›å»ºåœ°å›¾å¹¶è¿è¡Œç©ºé—´æ“ä½œï¼Œä¾‹å¦‚æŸ¥æ‰¾æŸä¸ªç‚¹å±äºå“ªä¸ªè¡Œæ”¿åŒºã€‚</p>
<h2 data-id="heading-3">æ˜ å°„æ•°æ®</h2>
<p>åŠ è½½ GeoDataFrame åï¼Œæœ€å¿«æ·çš„æ•°æ®å¯è§†åŒ–æ–¹æ³•ä¹‹ä¸€å°±æ˜¯äº†è§£æ•°æ®ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•åˆ›å»ºé™æ€åœ°å›¾å’Œäº¤äº’å¼åœ°å›¾ã€‚è¿™æ ·ï¼Œæ‚¨å¯ä»¥æ£€æŸ¥å½¢çŠ¶ã€å‘ç°è§„å¾‹ï¼Œå¹¶ç¡®è®¤å‡ ä½•å›¾å½¢æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</p>
<h3 data-id="heading-4">åˆ›å»ºé™æ€åœ°å›¾</h3>
<p>æ­£å¦‚<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fpandas-plot-python%2F" target="_blank" title="https://realpython.com/pandas-plot-python/" ref="nofollow noopener noreferrer">pandas ç»˜å›¾æŒ‡å—</a>ä¸­æ‰€è¿°ï¼Œpandas <a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fref%2Fglossary%2Fdataframe%2F" target="_blank" title="https://realpython.com/ref/glossary/dataframe/" ref="nofollow noopener noreferrer">DataFrame</a>æä¾›äº†ä¸€ä¸ª <code>.plot()</code> æ–¹æ³•ï¼Œç”¨äºå¿«é€Ÿåˆ›å»º<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fvisualizing-python-plt-scatter%2F" target="_blank" title="https://realpython.com/visualizing-python-plt-scatter/" ref="nofollow noopener noreferrer">æ•£ç‚¹å›¾</a>æˆ–æŸ±çŠ¶å›¾ç­‰å¯è§†åŒ–å›¾è¡¨ã€‚GeoDataFrame ç±»é‡å†™äº† <code>.plot()</code> æ–¹æ³•ï¼Œå› æ­¤ï¼Œå½“æ•°æ®åŒ…å«å‡ ä½•å›¾å½¢æ—¶ï¼Œç»“æœä¼šç”Ÿæˆåœ°å›¾è€Œä¸æ˜¯å›¾è¡¨ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥è°ƒç”¨ <code>nybb.plot()</code> æ¥ç»˜åˆ¶çº½çº¦å¸‚äº”ä¸ªè¡Œæ”¿åŒºçš„è½®å»“ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">&gt;&gt;&gt; </span>nybb.plot()
&lt;Axes: &gt;
<span class="hljs-meta">&gt;&gt;&gt; </span>plt.show()
</code></pre>
<p>ç”Ÿæˆçš„å›¾åƒå¦‚ä¸‹ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4eae949de50241f38da1bf0f7959b22f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rex5bqm5raM546w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860624&amp;x-signature=83l7wXZqXx3%2BB84wWHEAgWZ5va0%3D" alt="Output of GeoPandas nybb.plot()" loading="lazy"/>
è¿™ç§å¿«é€Ÿç»˜å›¾æœ‰åŠ©äºæ£€æŸ¥æ•°æ®æ˜¯å¦æ­£ç¡®åŠ è½½ä»¥åŠå‡ ä½•å›¾å½¢æ˜¯å¦åˆç†ã€‚ä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦æ›´è¿›ä¸€æ­¥ï¼Œä½¿ç”¨é¢œè‰²æ¥æ˜¾ç¤ºæ¯ä¸ªåŒºåŸŸçš„å€¼ã€‚æ ¹æ®åˆ—ä¸­çš„å€¼å¯¹åŒºåŸŸè¿›è¡Œç€è‰²çš„åœ°å›¾ç§°ä¸º<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FChoropleth_map" target="_blank" title="https://en.wikipedia.org/wiki/Choropleth_map" ref="nofollow noopener noreferrer">ç­‰å€¼çº¿</a>å›¾ï¼Œæ‚¨å¯ä»¥é€šè¿‡å°†è¦å¯è§†åŒ–çš„åˆ—ä¼ é€’ç»™ <code>column</code> å‚æ•°æ¥åˆ›å»ºå®ƒï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&gt;&gt;&gt; nybb.plot(<span class="hljs-attr">column</span>=<span class="hljs-string">"Shape_Area"</span>, legend=<span class="hljs-literal">True</span>)
&lt;Axes: &gt;
&gt;&gt;&gt; plt.show()
</code></pre>
<p>è¿™å°†äº§ç”Ÿä»¥ä¸‹è¾“å‡ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6994b2fc42f74bdfa7890c00f4814ac2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rex5bqm5raM546w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860624&amp;x-signature=V%2BABihr9HDCA4bNjuj2DadwtSmM%3D" alt="Output of GeoPandas nybb.plot(column=&quot;Shape_Area&quot;, legend=True)" loading="lazy"/>
åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°æ¯ä¸ªè¡Œæ”¿åŒºçš„ç›¸å¯¹å¤§å°ï¼Œå¹¶ç”¨é¢œè‰²è¡¨ç¤ºã€‚</p>
<h3 data-id="heading-5">åˆ›å»ºäº¤äº’å¼åœ°å›¾</h3>
<p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ <code>.explore()</code> æ–¹æ³•åˆ›å»ºäº¤äº’å¼ã€å¯ç¼©æ”¾çš„åœ°å›¾ã€‚<code>.explore()</code> æ–¹æ³•åº•å±‚ä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fpython-folium-web-maps-from-data%2F" target="_blank" title="https://realpython.com/python-folium-web-maps-from-data/" ref="nofollow noopener noreferrer">Folium</a><a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fref%2Fglossary%2Frepl%2F" target="_blank" title="https://realpython.com/ref/glossary/repl/" ref="nofollow noopener noreferrer">åº“</a>ç”Ÿæˆ HTML åœ°å›¾ã€‚REPL æ— æ³•ç›´æ¥æ˜¾ç¤ºè¯¥åœ°å›¾ï¼Œå› æ­¤ <code>.show_in_browser()</code> æ–¹æ³•ä¼šåœ¨æ‚¨çš„é»˜è®¤æµè§ˆå™¨ä¸­æ‰“å¼€åœ°å›¾ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">&gt;&gt;&gt; nybb<span class="hljs-selector-class">.explore</span>()<span class="hljs-selector-class">.show_in_browser</span>()
</code></pre>
<p>è¿™å°†åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­æ‰“å¼€ä¸€ä¸ªäº¤äº’å¼åœ°å›¾ã€‚æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a358db3a5f8a468ab5fe154c81e17eca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rex5bqm5raM546w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860624&amp;x-signature=70JmBdDOL8%2F63eH7K5qBJ6CsWr8%3D" alt="Output of GeoPandas .explore() Method on nybb Dataset" loading="lazy"/>
ä¸ç»˜åˆ¶ç®€å•é™æ€å½¢çŠ¶çš„<code>.plot()</code>ä¸åŒï¼Œ<code>.explore()</code>å°†æ‚¨çš„æ•°æ®å åŠ åˆ°å‚è€ƒå›¾çº¸ä¸Šâ€”â€”å‚è€ƒå›¾çº¸åŒ…å«åœ°åã€æµ·å²¸çº¿å’Œç¼©æ”¾æ§ä»¶ã€‚è¿™ä½¿å¾—åœ¨ä¸Šä¸‹æ–‡ä¸­è§£è¯»æ•°æ®ä»¥åŠäº¤äº’å¼æ¢ç´¢åœ°ç†ç¯å¢ƒå˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p>
<p>ä¸ <code>.plot()</code> ç±»ä¼¼ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¼ é€’åˆ—åå°†å…¶è½¬æ¢ä¸ºç­‰å€¼çº¿å›¾ã€‚è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ ¹æ®æ¯ä¸ªè¡Œæ”¿åŒºçš„åœŸåœ°é¢ç§¯ä¸ºå…¶ç€è‰²ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&gt;&gt;&gt; nybb.explore(<span class="hljs-attr">column</span>=<span class="hljs-string">"Shape_Area"</span>, legend=<span class="hljs-literal">False</span>).show_in_browser()
</code></pre>
<p>è¾“å‡ºç»“æœä¸ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b8f092f3bc54545a8e2e7f75a7b8156~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rex5bqm5raM546w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860624&amp;x-signature=wbegVEMN%2FERtCHoMMJdsD8W2qwk%3D" alt="GeoPandas .explore() Method on nybb Dataset" loading="lazy"/>
ç°åœ¨ï¼Œæ¯ä¸ªè¡Œæ”¿åŒºçš„ç›¸å¯¹å¤§å°ç”¨é¢œè‰²è¡¨ç¤ºï¼Œè®©æ‚¨äº†è§£äº¤äº’å¼åœ°å›¾å¦‚ä½•æ­ç¤ºæ•°æ®ä¸­çš„æ¨¡å¼ã€‚ä¸ºäº†ä½¿è¿™äº›åœ°å›¾å‡†ç¡®ä¸”åœ¨ä¸åŒæ•°æ®é›†ä¹‹é—´å…·æœ‰å¯æ¯”æ€§ï¼Œæ¥ä¸‹æ¥æ‚¨å°†äº†è§£åæ ‡å‚è€ƒç³»ç»Ÿå’ŒæŠ•å½±çš„å·¥ä½œåŸç†ã€‚</p>
<h2 data-id="heading-6">ä½¿ç”¨åæ ‡å‚è€ƒç³»ç»Ÿ (CRS) å’ŒæŠ•å½±</h2>
<p>æ¯ä¸ª GeoDataFrame éƒ½åŒ…å«ä¸€ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FSpatial_reference_system" target="_blank" title="https://en.wikipedia.org/wiki/Spatial_reference_system" ref="nofollow noopener noreferrer">åæ ‡å‚è€ƒç³»ç»Ÿ (CRSï¼ŒCoordinate Reference Systems )</a> ï¼Œç”¨äºè§£é‡Šå…¶åæ ‡å¦‚ä½•æ˜ å°„åˆ°ç°å®ä¸–ç•Œçš„ä½ç½®ã€‚ç†è§£ CRS å¯¹äºè§£é‡Šå‡ ä½•å€¼ã€æ¯”è¾ƒæ•°æ®é›†å’Œç”Ÿæˆç²¾ç¡®åœ°å›¾è‡³å…³é‡è¦ã€‚åœ¨è¿›ä¸€æ­¥æ¢ç´¢ä¹‹å‰ï¼Œè¯·ä»”ç»†æŸ¥çœ‹ <code>nybb</code> ä¸­çš„ <code>geometry</code> åˆ—ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang">&gt;&gt;&gt; nybb[[<span class="hljs-string">"BoroName"</span>, <span class="hljs-string">"geometry"</span>]]
     BoroName       geometry
<span class="hljs-number">0</span>    Staten Island  MULTIPOLYGON (((<span class="hljs-number">970217.022</span> <span class="hljs-number">145643.332</span>, <span class="hljs-number">970227</span>....
<span class="hljs-number">1</span>    Queens         MULTIPOLYGON (((<span class="hljs-number">1029606.077</span> <span class="hljs-number">156073.814</span>, <span class="hljs-number">102957</span>...
<span class="hljs-number">2</span>    Brooklyn       MULTIPOLYGON (((<span class="hljs-number">1021176.479</span> <span class="hljs-number">151374.797</span>, <span class="hljs-number">102100</span>...
<span class="hljs-number">3</span>    Manhattan      MULTIPOLYGON (((<span class="hljs-number">981219.056</span> <span class="hljs-number">188655.316</span>, <span class="hljs-number">980940</span>....
<span class="hljs-number">4</span>    Bronx          MULTIPOLYGON (((<span class="hljs-number">1012821.806</span> <span class="hljs-number">229228.265</span>, <span class="hljs-number">101278</span>...
</code></pre>
<p>è¯·æ³¨æ„ï¼Œ<code>geometry</code> åˆ—åªæ˜¯æ•°å­—â€”â€”è¿™äº›å€¼å¦‚ä½•ä¸åœ°çƒä¸Šçš„åœ°ç‚¹å¯¹åº”å¹¶ä¸æ˜æ˜¾ã€‚</p>
<p>æ¯ä¸ª GeoDataFrame çš„ CRS ä½äºå…¶ <code>.crs</code> å±æ€§ä¸­ã€‚ä»¥ä¸‹æ˜¯ <code>nybb</code> æ•°æ®é›†çš„ CRSï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">&gt;&gt;&gt;</span> <span class="hljs-string">nybb.crs</span>
<span class="hljs-string">&lt;Projected</span> <span class="hljs-attr">CRS:</span> <span class="hljs-string">EPSG:2263&gt;</span>
<span class="hljs-attr">Name:</span> <span class="hljs-string">NAD83</span> <span class="hljs-string">/</span> <span class="hljs-string">New</span> <span class="hljs-string">York</span> <span class="hljs-string">Long</span> <span class="hljs-string">Island</span> <span class="hljs-string">(ftUS)</span>
<span class="hljs-string">Axis</span> <span class="hljs-string">Info</span> [<span class="hljs-string">cartesian</span>]<span class="hljs-string">:</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">X[east]:</span> <span class="hljs-string">Easting</span> <span class="hljs-string">(US</span> <span class="hljs-string">survey</span> <span class="hljs-string">foot)</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">Y[north]:</span> <span class="hljs-string">Northing</span> <span class="hljs-string">(US</span> <span class="hljs-string">survey</span> <span class="hljs-string">foot)</span>
<span class="hljs-attr">Area of Use:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">United</span> <span class="hljs-string">States</span> <span class="hljs-string">(USA)</span> <span class="hljs-bullet">-</span> <span class="hljs-string">New</span> <span class="hljs-string">York</span> <span class="hljs-bullet">-</span> <span class="hljs-string">counties</span> <span class="hljs-string">of</span> <span class="hljs-string">Bronx;</span> <span class="hljs-string">Kings;</span> <span class="hljs-string">Nassau</span> <span class="hljs-string">...</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">bounds:</span> <span class="hljs-string">(-74.26,</span> <span class="hljs-number">40.47</span><span class="hljs-string">,</span> <span class="hljs-number">-71.8</span><span class="hljs-string">,</span> <span class="hljs-number">41.3</span><span class="hljs-string">)</span>
<span class="hljs-attr">Coordinate Operation:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">SPCS83</span> <span class="hljs-string">New</span> <span class="hljs-string">York</span> <span class="hljs-string">Long</span> <span class="hljs-string">Island</span> <span class="hljs-string">zone</span> <span class="hljs-string">(US</span> <span class="hljs-string">survey</span> <span class="hljs-string">foot)</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">method:</span> <span class="hljs-string">Lambert</span> <span class="hljs-string">Conic</span> <span class="hljs-string">Conformal</span> <span class="hljs-string">(2SP)</span>
<span class="hljs-attr">Datum:</span> <span class="hljs-string">North</span> <span class="hljs-string">American</span> <span class="hljs-string">Datum</span> <span class="hljs-number">1983</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">Ellipsoid:</span> <span class="hljs-string">GRS</span> <span class="hljs-number">1980</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">Prime Meridian:</span> <span class="hljs-string">Greenwich</span>
</code></pre>
<p>æ¯ä¸ªåæ ‡å‚è€ƒç³» (CRS) éƒ½æœ‰ä¸€ä¸ªåç§°å’Œä¸€ä¸ªä»£ç ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼ŒCRS çš„åç§°ä¸º <code>NAD83 / New York Long Island (ftUS)</code>ï¼Œä»£ç ä¸º <code>EPSG:2263</code>ã€‚x å’Œ y åæ ‡è¡¨ç¤ºä»¥ç¾å›½æµ‹é‡è‹±å°ºä¸ºå•ä½çš„è·ç¦»ï¼ŒåŸç‚¹ä½äºçº½çº¦å¸‚éƒŠå¤–å¾ˆè¿œçš„åœ°æ–¹ã€‚è¿™ç§ä½ç½®å…³ç³»è§£é‡Šäº†ä¸ºä»€ä¹ˆåæ ‡è½´çš„å€¼å¾ˆå¤§ï¼Œå› ä¸ºå®ƒä»¬è¡¨ç¤ºæ¯ä¸ªç‚¹è·ç¦»åŸç‚¹çš„ä¸œå‘å’ŒåŒ—å‘è·ç¦»ï¼ˆä»¥è‹±å°ºä¸ºå•ä½ï¼‰ã€‚</p>
<p><code>EPSG:2263</code> æ˜¯ä¸€ä¸ª<em>æŠ•å½±</em>åæ ‡å‚è€ƒç³»ã€‚è¿™æ„å‘³ç€ <code>geometry</code> åˆ—ä¸­çš„åæ ‡å·²ç»è¿‡æ•°å­¦æŠ•å½±è½¬æ¢ï¼Œä½¿å¾— x è½´å’Œ y è½´è¡¨ç¤ºçº¿æ€§è·ç¦»ã€‚ä¸‹ä¸€èŠ‚å°†ä»‹ç»<em>åœ°ç†</em>åæ ‡å‚è€ƒç³»ï¼Œå…¶ä¸­åæ ‡è½´å¹¶éè¡¨ç¤ºè·ç¦»ï¼Œè€Œæ˜¯è¡¨ç¤ºçº¬åº¦å’Œç»åº¦ã€‚</p>
<h3 data-id="heading-7">æ¢ç´¢åœ°ç† CRS</h3>
<p>æŸ¥çœ‹ä¸–ç•Œåœ°å›¾æ—¶å¸¸ç”¨çš„åæ ‡å‚è€ƒç³»ç»Ÿ (CRS) æ˜¯ WGS 84 (<code>EPSG:4326</code>)ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨æ­¤ CRS åŠ è½½ä¸–ç•Œåœ°å›¾çš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">&gt;&gt;&gt;</span> <span class="hljs-string">world</span> <span class="hljs-string">=</span> <span class="hljs-string">gpd.read_file(get_path("naturalearth</span> <span class="hljs-string">land"))</span>
<span class="hljs-string">&gt;&gt;&gt;</span> <span class="hljs-string">world.crs</span>
<span class="hljs-string">&lt;Geographic</span> <span class="hljs-attr">2D CRS:</span> <span class="hljs-string">EPSG:4326&gt;</span>
<span class="hljs-attr">Name:</span> <span class="hljs-string">WGS</span> <span class="hljs-number">84</span>
<span class="hljs-string">Axis</span> <span class="hljs-string">Info</span> [<span class="hljs-string">ellipsoidal</span>]<span class="hljs-string">:</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">Lat[north]:</span> <span class="hljs-string">Geodetic</span> <span class="hljs-string">latitude</span> <span class="hljs-string">(degree)</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">Lon[east]:</span> <span class="hljs-string">Geodetic</span> <span class="hljs-string">longitude</span> <span class="hljs-string">(degree)</span>
<span class="hljs-attr">Area of Use:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">World.</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">bounds:</span> <span class="hljs-string">(-180.0,</span> <span class="hljs-number">-90.0</span><span class="hljs-string">,</span> <span class="hljs-number">180.0</span><span class="hljs-string">,</span> <span class="hljs-number">90.0</span><span class="hljs-string">)</span>
<span class="hljs-attr">Datum:</span> <span class="hljs-string">World</span> <span class="hljs-string">Geodetic</span> <span class="hljs-string">System</span> <span class="hljs-number">1984 </span><span class="hljs-string">ensemble</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">Ellipsoid:</span> <span class="hljs-string">WGS</span> <span class="hljs-number">84</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">Prime Meridian:</span> <span class="hljs-string">Greenwich</span>
</code></pre>
<p>WGS 84 æ˜¯ä¸€ç§<em>åœ°ç†</em>åæ ‡å‚è€ƒç³»ï¼šx è½´å’Œ y è½´åˆ†åˆ«ä»£è¡¨ç»åº¦å’Œçº¬åº¦ï¼ˆå•ä½ä¸ºåº¦ï¼‰ã€‚å®ƒä»¬å¹¶ä¸ä»£è¡¨è‹±å°ºæˆ–ç±³ç­‰å®é™…è·ç¦»ã€‚ç”±äºåº¦æ•°å¹¶éå‡åŒ€è·ç¦»ï¼Œå› æ­¤ç›´æ¥ä½¿ç”¨åœ°ç†åæ ‡å‚è€ƒç³»ç»˜åˆ¶å›¾å½¢ä¼šæ‰­æ›²å½¢çŠ¶å’Œé¢ç§¯ï¼Œå°¤å…¶æ˜¯åœ¨ä¸¤æåœ°åŒºã€‚</p>
<p>ä»¥ä¸‹æ˜¯ç»˜åˆ¶ä¸–ç•Œåœ°å›¾çš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">&gt;&gt;&gt; </span>world.plot()
&lt;Axes: &gt;
<span class="hljs-meta">&gt;&gt;&gt; </span>plt.show()
</code></pre>
<p>ç»“æœå¦‚ä¸‹ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/279448557f7c4f10b217fc47339e175f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rex5bqm5raM546w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860624&amp;x-signature=TivW3hDYo%2FCq%2BzPSv4LokK2990w%3D" alt="A World Map Using the WGS84 Geographic Projection" loading="lazy"/>
ç”±äºè¯¥ CRS ä¸æ˜¯æŠ•å½±çš„ï¼Œå› æ­¤æåœ°é™„è¿‘çš„åŒºåŸŸçœ‹èµ·æ¥è¢«æ‹‰ä¼¸äº†â€”â€”æ ¼é™µå…°å²›å’Œå—ææ´²çœ‹èµ·æ¥æ¯”å®é™…å¤§å¾—å¤šã€‚</p>
<h3 data-id="heading-8">æ”¹å˜ CRS</h3>
<p>æ‚¨å¯ä»¥æ›´æ”¹ GeoDataFrame çš„åæ ‡å‚è€ƒç³»ç»Ÿ (CRS)ã€‚è¿™å¾ˆé‡è¦ï¼Œå› ä¸º CRS çš„é€‰æ‹©ä¼šå½±å“è·ç¦»ã€é¢ç§¯å’Œå½¢çŠ¶çš„æ˜¾ç¤ºæ–¹å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæ‚¨åˆšæ‰çœ‹åˆ°ï¼ŒWGS 84 æŠ•å½±ä½¿æ ¼é™µå…°å²›å’Œå—ææ´²çœ‹èµ·æ¥æ¯”å®é™…å¤§å¾—å¤šã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMollweide_projection" target="_blank" title="https://en.wikipedia.org/wiki/Mollweide_projection" ref="nofollow noopener noreferrer">è«å°”ç»´å¾·æŠ•å½±ï¼ˆMollweide projectionï¼‰</a>æ˜¯ä¸€ç§ç­‰é¢ç§¯æŠ•å½±ï¼šæ¯ä¸ªåŒºåŸŸéƒ½ä¿æŒå…¶ç›¸å¯¹äºå…¶ä»–åŒºåŸŸçš„çœŸå®é¢ç§¯æ¯”ä¾‹ã€‚å½¢çŠ¶å˜å¾—æ›´åŠ åœ†æ¶¦ï¼Œè·ç¦»ä¹Ÿä¼šæœ‰æ‰€å˜åŒ–ï¼Œä½†å„å¤§æ´²å’Œå›½å®¶çš„ç›¸å¯¹å¤§å°æ˜¯å‡†ç¡®çš„ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨æ–¹æ³• <code>.to_crs()</code> å°†ä¸–ç•Œåœ°å›¾çš„ CRS ä» WGS 84 æ›´æ”¹ä¸º Mollweideï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">&gt;&gt;&gt;</span> <span class="hljs-string">world_moll</span> <span class="hljs-string">=</span> <span class="hljs-string">world.to_crs("ESRI:54009")</span>
<span class="hljs-string">&gt;&gt;&gt;</span> <span class="hljs-string">world_moll.crs</span>
<span class="hljs-string">&lt;Projected</span> <span class="hljs-attr">CRS:</span> <span class="hljs-string">ESRI:54009&gt;</span>
<span class="hljs-attr">Name:</span> <span class="hljs-string">World_Mollweide</span>
<span class="hljs-string">Axis</span> <span class="hljs-string">Info</span> [<span class="hljs-string">cartesian</span>]<span class="hljs-string">:</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">E[east]:</span> <span class="hljs-string">Easting</span> <span class="hljs-string">(metre)</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">N[north]:</span> <span class="hljs-string">Northing</span> <span class="hljs-string">(metre)</span>
<span class="hljs-attr">Area of Use:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">World.</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">bounds:</span> <span class="hljs-string">(-180.0,</span> <span class="hljs-number">-90.0</span><span class="hljs-string">,</span> <span class="hljs-number">180.0</span><span class="hljs-string">,</span> <span class="hljs-number">90.0</span><span class="hljs-string">)</span>
<span class="hljs-attr">Coordinate Operation:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">World_Mollweide</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">method:</span> <span class="hljs-string">Mollweide</span>
<span class="hljs-attr">Datum:</span> <span class="hljs-string">World</span> <span class="hljs-string">Geodetic</span> <span class="hljs-string">System</span> <span class="hljs-number">1984</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">Ellipsoid:</span> <span class="hljs-string">WGS</span> <span class="hljs-number">84</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">Prime Meridian:</span> <span class="hljs-string">Greenwich</span>
</code></pre>
<p>ä¸æ‰€æœ‰æŠ•å½±å¼ CRS ä¸€æ ·ï¼Œåœ°å›¾çš„åæ ‡è½´ä»¥è·ç¦»è¡¨ç¤ºï¼Œè€Œä¸æ˜¯ä»¥çº¬åº¦å’Œç»åº¦è¡¨ç¤ºã€‚</p>
<p>ä½ å¯ä»¥åƒè¿™æ ·ä½¿ç”¨æ–°çš„CRSç»˜åˆ¶ä¸–ç•Œåœ°å›¾ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">&gt;&gt;&gt; </span>world_moll.plot()
&lt;Axes: &gt;
<span class="hljs-meta">&gt;&gt;&gt; </span>plt.show()
</code></pre>
<p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a83fb9d9b8914703bd8990be0f32594b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rex5bqm5raM546w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860624&amp;x-signature=xliyyBuQSWTlGA06unOokCbouzw%3D" alt="Output of GeoPandas .plot() using a Mollweide Projection" loading="lazy"/>
åœ¨è¿™å¼ åœ°å›¾ä¸­ï¼Œæ ¼é™µå…°å²›å’Œå—ææ´²çœ‹èµ·æ¥æ¯”åœ¨WGS 84åæ ‡ç³»ä¸­å°å¾—å¤šã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒä»¬çš„å¤§å°ä¸å…¶ä»–é™†åœ°ç›¸æ¯”æ˜¯å‡†ç¡®çš„ã€‚</p>
<h3 data-id="heading-9">æ¯”è¾ƒ CRS</h3>
<p>æœ‰æ—¶ï¼Œå¯¹ä¸¤ç§ä¸åŒåæ ‡å‚è€ƒç³»ä¸‹çš„æ•°æ®é›†è¿›è¡Œå¹¶æ’æ¯”è¾ƒä¼šå¾ˆæœ‰å¸®åŠ©ã€‚ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fpython-matplotlib-guide%2F" target="_blank" title="https://realpython.com/python-matplotlib-guide/" ref="nofollow noopener noreferrer">Matplotlib</a> ï¼Œåˆ†åˆ«ä½¿ç”¨ WGS 84 å’Œ Mollweide åæ ‡ç³»ç»˜åˆ¶äº†åŒä¸€å¼ ä¸–ç•Œåœ°å›¾ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">&gt;&gt;&gt; fig, axes = plt<span class="hljs-selector-class">.subplots</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">7</span>))
&gt;&gt;&gt; world<span class="hljs-selector-class">.plot</span>(ax=axes[<span class="hljs-number">0</span>])
&lt;Axes: &gt;
&gt;&gt;&gt; axes[<span class="hljs-number">0</span>].<span class="hljs-built_in">set_title</span>(<span class="hljs-string">"EPSG:4326 (WGS84 Lat/Lon)"</span>)
<span class="hljs-built_in">Text</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">'EPSG:4326 (WGS84 Lat/Lon)'</span>)
&gt;&gt;&gt; world_moll.<span class="hljs-built_in">plot</span>(ax=axes[<span class="hljs-number">1</span>])
&lt;Axes: &gt;
&gt;&gt;&gt; axes[<span class="hljs-number">1</span>].<span class="hljs-built_in">set_title</span>(<span class="hljs-string">"ESRI:54009 (Mollweide Equal-Area)"</span>)
<span class="hljs-built_in">Text</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">'ESRI:54009 (Mollweide Equal-Area)'</span>)
&gt;&gt;&gt; plt.<span class="hljs-built_in">tight_layout</span>()
&gt;&gt;&gt; plt.<span class="hljs-built_in">show</span>()
</code></pre>
<p>è¿™å°±æ˜¯æœ€ç»ˆçš„å¯¹æ¯”å›¾ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea69743e48d543b580b9fa4dbe5ae7f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rex5bqm5raM546w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770860624&amp;x-signature=HvW%2BL6LYRssnnJ2tsc%2BaQyoG5lo%3D" alt="Comparison of two Projections of a World Map" loading="lazy"/>
ä»å›¾ä¸­å¯ä»¥æ˜æ˜¾çœ‹å‡ºï¼Œåæ ‡å‚è€ƒç³»ç»Ÿ (CRS) çš„é€‰æ‹©ä¼šå½±å“åœ°å›¾çš„æ¸²æŸ“æ–¹å¼ã€‚ç”±äº WGS 84 å°†ç»åº¦å’Œçº¬åº¦è§†ä¸º x åæ ‡å’Œ y åæ ‡ï¼Œå› æ­¤æåœ°é™„è¿‘çš„åŒºåŸŸçœ‹èµ·æ¥è¢«æ‹‰ä¼¸ï¼Œæ¯”å®é™…é¢ç§¯æ›´å¤§ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œè«å°”ç»´å¾·æŠ•å½±ä¿ç•™äº†å„é™†åœ°ç›¸å¯¹å¤§å°ï¼Œå› æ­¤æ ¼é™µå…°å²›å’Œå—ææ´²çœ‹èµ·æ¥è¦å°å¾—å¤šã€‚</p>
<h3 data-id="heading-10">ç†è§£åœ°å›¾æŠ•å½±å’Œä¸­å¿ƒå‚è€ƒç³»ç»Ÿ</h3>
<p>æ­£å¦‚æ‚¨æ‰€è§ï¼ŒGeoPandas ä½¿ç”¨**åæ ‡å‚è€ƒç³»ç»Ÿ (CRS)**å°†åæ ‡æ˜ å°„åˆ°ç°å®ä¸–ç•Œçš„ä½ç½®ã€‚æœ‰äº› CRS æ˜¯åœ°ç†åæ ‡ç³»ï¼Œä½¿ç”¨ä»¥åº¦ä¸ºå•ä½çš„çº¬åº¦å’Œç»åº¦ã€‚è¿™äº›åæ ‡ç³»æœªç»æŠ•å½±ã€‚å¦ä¸€äº›åæ ‡ç³»åˆ™ç»è¿‡æŠ•å½±ï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä½¿ç”¨åœ°å›¾æŠ•å½±å°†åœ°çƒå¹³é¢åŒ–ä¸ºä»¥çº¿æ€§å•ä½è¡¨ç¤ºçš„ x å’Œ y åæ ‡ã€‚</p>
<p>æ¯ä¸ªæŠ•å½±éƒ½æ˜¯ CRS çš„ä¸€éƒ¨åˆ†ï¼Œä½†å¹¶éæ¯ä¸ª CRS éƒ½ä½¿ç”¨æŠ•å½±ã€‚</p>
<h2 data-id="heading-11">æ‰§è¡Œç©ºé—´è¿æ¥ï¼ˆjoinï¼‰</h2>
<p>ç©ºé—´è¿æ¥å…è®¸æ‚¨æ ¹æ®ä¸¤ä¸ª GeoDataFrame çš„å‡ ä½•å…³ç³»åˆå¹¶å®ƒä»¬çš„ä¿¡æ¯ã€‚ä¸é€šè¿‡å…±äº« ID æˆ–åˆ—ååŒ¹é…è¡Œä¸åŒï¼Œç©ºé—´è¿æ¥æ ¹æ®è¦ç´ åœ¨ç©ºé—´ä¸­çš„ä½ç½®è¿›è¡ŒåŒ¹é…â€”â€”ä¾‹å¦‚ï¼Œå“ªäº›åœ°é“ç«™ä½äºæŸä¸ªè¡Œæ”¿åŒºå†…ã€‚å®ƒç›¸å½“äºæ•°æ®åº“è¿æ¥çš„åœ°ç†ç©ºé—´ç‰ˆæœ¬ï¼Œä½†å…³é”®åœ¨äºä½ç½®è€Œéå­—æ®µå€¼ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨ç©ºé—´è¿æ¥æ¥ç¡®å®šçº½çº¦å¸‚çš„å“ªä¸ªè¡Œæ”¿åŒºåŒ…å«å¸å›½å¤§å¦ã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«å¸å›½å¤§å¦ç»åº¦å’Œçº¬åº¦çš„ GeoDataFrameã€‚ç”±äºè¿™äº›åæ ‡ä»¥åº¦ä¸ºå•ä½ï¼Œå› æ­¤æ‚¨åº”è¯¥ä½¿ç”¨ <code>EPSG:4326</code> ä½œä¸º CRSï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Point
<span class="hljs-meta">&gt;&gt;&gt; </span>empire_state = gpd.GeoDataFrame(
<span class="hljs-meta">... </span>   [{<span class="hljs-string">"name"</span>: <span class="hljs-string">"Empire State Building"</span>}],
<span class="hljs-meta">... </span>   geometry=[Point(-<span class="hljs-number">73.9857</span>, <span class="hljs-number">40.7484</span>)],
<span class="hljs-meta">... </span>   crs=<span class="hljs-string">"EPSG:4326"</span>
<span class="hljs-meta">... </span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>empire_state
     name                     geometry
<span class="hljs-number">0</span>    Empire State Building    POINT (-<span class="hljs-number">73.9857</span> <span class="hljs-number">40.7484</span>)
</code></pre>
<p>ç°åœ¨æ‚¨æ‹¥æœ‰ä¸€ä¸ªåªåŒ…å«ä¸€ä¸ªç‚¹çš„ GeoDataFrameã€‚</p>
<h3 data-id="heading-12">ç†è§£ç©ºé—´è¿æ¥å’Œ CRS</h3>
<p>ç©ºé—´è¿æ¥è¦æ±‚ä¸¤ä¸ª GeoDataFrame å…·æœ‰ç›¸åŒçš„ CRSï¼ˆä¸­å¿ƒå‚è€ƒç³»ï¼‰ã€‚æ‚¨åˆšæ‰çœ‹åˆ° <code>empire_state</code> DataFrame ä½¿ç”¨äº† <code>EPSG:4326</code>ã€‚ä¹‹å‰æ‚¨çœ‹åˆ° <code>nybb</code> ä½¿ç”¨äº† <code>EPSG:2263</code>ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•å°† <code>empire_state</code> ä¹Ÿæ›´æ”¹ä¸ºä½¿ç”¨ <code>EPSG:2263</code>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&gt;&gt;&gt; <span class="hljs-attr">empire_state</span> = empire_state.to_crs(nybb.crs)
&gt;&gt;&gt; empire_state
     name                     geometry
0    Empire State Building    POINT (988212.237 211939.279)
</code></pre>
<p>è¯·æ³¨æ„ï¼Œå½“æ‚¨æ›´æ”¹ <code>empire_state</code> çš„åæ ‡å‚è€ƒç³» (CRS) æ—¶ï¼Œ<code>geometry</code> åˆ—ä¸­çš„å€¼ä» <code>(-73.9857</code>ã€<code>40.7484)</code> å˜ä¸º <code>(988212.237</code>ã€<code>211939.279)</code>ã€‚è¿™æ˜¯å› ä¸ºåæ ‡åªæœ‰åœ¨ç‰¹å®šçš„åæ ‡å‚è€ƒç³» (CRS) ä¸‹æ‰æœ‰æ„ä¹‰ã€‚å½“æ‚¨åˆ‡æ¢åˆ°ä¸åŒçš„åæ ‡å‚è€ƒç³» (CRS) æ—¶ï¼ŒåŒä¸€ä¸ªå®é™…ä½ç½®ä¼šç”¨ä¸åŒçš„åæ ‡å€¼æ¥è¡¨ç¤ºã€‚</p>
<h3 data-id="heading-13">ä½¿ç”¨<code>.sjoin()</code>æ–¹æ³•</h3>
<p>GeoPandas ä¸­çš„ç©ºé—´è¿æ¥ä¸<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fpandas-merge-join-and-concat%2F" target="_blank" title="https://realpython.com/pandas-merge-join-and-concat/" ref="nofollow noopener noreferrer">pandas ä¸­çš„è¿æ¥</a>æ–¹å¼ç±»ä¼¼ã€‚å…·ä½“æ¥è¯´ï¼ŒGeoDataFrame æœ‰ä¸€ä¸ª <code>.sjoin()</code> å®ä¾‹æ–¹æ³•ã€‚æ­¤æ–¹æ³•éœ€è¦æ‚¨æŒ‡å®šè¦è¿æ¥çš„ GeoDataFrameï¼Œä»¥åŠè¦ä½¿ç”¨çš„è¿æ¥ç±»å‹å’Œ<strong>è°“è¯</strong>ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæ‚¨ä½¿ç”¨å·¦è¿æ¥å°† <code>empire_state</code> DataFrame è¿æ¥åˆ° <code>nybb</code> DataFrameã€‚ä½¿ç”¨å·¦è¿æ¥ï¼Œæ‚¨è‡³å°‘å¯ä»¥å¾—åˆ°ä¸€è¡Œç»“æœï¼Œè¯¥è¡Œå°†æ¥è‡ªåŸå§‹ <code>empire_state</code> DataFrameã€‚</p>
<p>åœ¨è¿è¡Œè¿æ¥æ“ä½œä¹‹å‰ï¼Œäº†è§£å‚æ•° <code>predicate</code> çš„å·¥ä½œåŸç†éå¸¸é‡è¦ã€‚å‚æ•° <code>predicate</code> å‘Šè¯‰ <code>.sjoin()</code> å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªå‡ ä½•å›¾å½¢åœ¨ç©ºé—´ä¸Šæ˜¯å¦åŒ¹é…ã€‚è¿™é‡Œï¼Œæ‚¨ä½¿ç”¨ <code>"within"</code> æ˜¯å› ä¸ºæ‚¨æƒ³æµ‹è¯•ä¸€ä¸ªç‚¹æ˜¯å¦ä½äºæŸä¸ªè¡Œæ”¿åŒºå†…ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&gt;&gt;&gt; empire_state.sjoin(nybb, <span class="hljs-attr">how</span>=<span class="hljs-string">"left"</span>, predicate=<span class="hljs-string">"within"</span>)
   name                   geometry               index_right  BoroName  ...
0  Empire State Building  POINT (988212.237 ...  3            Manhattan ...
</code></pre>
<p>ç”±äºçº½çº¦å¸‚å„è¡Œæ”¿åŒºäº’ä¸é‡å ï¼Œæ‰€ä»¥åªè¿”å›ä¸€è¡Œæ•°æ®ã€‚å¸å›½å¤§å¦ä½äºæ›¼å“ˆé¡¿ï¼Œè¿æ¥æ“ä½œä¹Ÿæ˜¾ç¤ºäº†è¿™ä¸€ç‚¹ã€‚ç”±äºæ‚¨è¿æ¥äº†ä¸¤ä¸ªæ•°æ®æ¡†ï¼Œå› æ­¤æ‚¨åŒæ—¶æ‹¥æœ‰æ¥è‡ª <code>empire_state</code> å’Œ <code>nybb</code> çš„åˆ—ã€‚</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ äº†è§£äº†<code>"within"</code>è°“è¯ï¼Œå®ƒå¯ä»¥ç”¨æ¥æµ‹è¯•ä¸€ä¸ªå½¢çŠ¶æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå½¢çŠ¶ä¹‹å†…ã€‚å…¶ä»–è°“è¯å¯ä»¥ç”¨æ¥æµ‹è¯•ä¸¤ä¸ªå½¢çŠ¶æ˜¯å¦æ¥è§¦ã€é‡å ã€ç›¸äº¤ç­‰ç­‰ã€‚</p>
<h2 data-id="heading-14">é¿å…å±€é™æ€§å’Œé™·é˜±</h2>
<p>å°½ç®¡ GeoPandas åŠŸèƒ½å¼ºå¤§ä¸”å¯¹åˆå­¦è€…å‹å¥½ï¼Œä½†è¿˜æ˜¯æœ‰ä¸€äº›å¸¸è§çš„é™·é˜±å¯èƒ½ä¼šè®©äººçŠ¯é”™â€”â€”å°¤å…¶æ˜¯åœ¨å¼€å§‹å¤„ç†çœŸå®ä¸–ç•Œæ•°æ®æ—¶ã€‚</p>
<p>è®°ä½è¿™äº›è¦ç‚¹å¯ä»¥èŠ‚çœæ‚¨çš„æ—¶é—´å’Œé¿å…å›°æƒ‘ï¼š</p>
<ul>
<li>**ä¾èµ–é¡¹ï¼š**å®‰è£… GeoPandas å¯èƒ½æ¯”è¾ƒæ£˜æ‰‹ï¼Œå› ä¸ºå®ƒä¾èµ–äºå·²ç¼–è¯‘çš„åº“ï¼ˆ<code>GEOS</code>ã€<code>PROJ</code>ã€<code>GDAL</code>ï¼‰ã€‚å¦‚æœæ‚¨åœ¨ä½¿ç”¨ <code>pip</code> å®‰è£…æ—¶é‡åˆ°é—®é¢˜ï¼Œè¯·å‚é˜…<a href="https://link.juejin.cn?target=https%3A%2F%2Fgeopandas.org%2Fen%2Fstable%2Fgetting_started%2Finstall.html" target="_blank" title="https://geopandas.org/en/stable/getting_started/install.html" ref="nofollow noopener noreferrer">å®˜æ–¹å®‰è£…é¡µé¢</a>ä»¥è·å–å…¶ä»–å®‰è£…æ–¹æ¡ˆçš„ä¿¡æ¯ã€‚</li>
<li>**åæ ‡å‚è€ƒç³» (CRS) æ³¨æ„ï¼š**åŠ¡å¿…æ£€æŸ¥å¹¶è®¾ç½® CRSã€‚åœ¨è¿›è¡Œç©ºé—´è¿æ¥æˆ–è·ç¦»è®¡ç®—ä¹‹å‰å¿˜è®°é‡æ–°æŠ•å½±å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯çš„ç»“æœã€‚</li>
<li><strong>åœ°å›¾ç»˜åˆ¶é™åˆ¶ï¼š</strong> <code>.plot()</code> å’Œ <code>.explore()</code> éå¸¸é€‚åˆå¿«é€Ÿç»˜åˆ¶åœ°å›¾ï¼Œä½†è‡ªå®šä¹‰åŠŸèƒ½æœ‰é™ã€‚å¦‚éœ€å¤šå›¾å±‚ã€å¼¹å‡ºçª—å£å’Œåº•å›¾ç­‰é«˜çº§äº¤äº’åŠŸèƒ½ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨ Foliumã€‚</li>
</ul>
<p>è¿™äº›éƒ½ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ï¼Œè¿™äº›æ˜¯å€¼å¾—åŠæ—©è¯†åˆ«çš„æ¨¡å¼ï¼Œè¿™æ ·ä½ çš„å·¥ä½œæµç¨‹æ‰èƒ½ä¿æŒæµç•…å’Œå¯é¢„æµ‹ã€‚</p>
<h2 data-id="heading-15">ç»“è®º</h2>
<p>GeoPandas å°†ç†Ÿæ‚‰çš„ pandas å·¥ä½œæµç¨‹æ‰©å±•åˆ°äº†åœ°ç†ç©ºé—´é¢†åŸŸã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæ‚¨å­¦ä¹ äº†å¦‚ä½•åŠ è½½å¸¸è§çš„åœ°ç†ç©ºé—´æ ¼å¼ã€åˆ›å»ºé™æ€å’Œäº¤äº’å¼åœ°å›¾ã€ä½¿ç”¨å’Œæ›´æ”¹æ•°æ®é›†çš„ CRSï¼Œä»¥åŠä½¿ç”¨ç©ºé—´è¿æ¥æ¥å›ç­”åŸºäºä½ç½®çš„é—®é¢˜ã€‚</p>
<p>æ‚¨ç°åœ¨å·²æŒæ¡å¤„ç†çœŸå®ä¸–ç•Œç©ºé—´æ•°æ®å¹¶åˆ›å»ºèƒ½å¤Ÿä¼ è¾¾æœ‰æ„ä¹‰è§è§£çš„åœ°å›¾æ‰€éœ€çš„æ ¸å¿ƒæŠ€èƒ½ã€‚æ‚¨å¯ä»¥é€šè¿‡å°è¯•ä½¿ç”¨è‡ªå·±çš„æ•°æ®é›†ã€é˜…è¯»<a href="https://link.juejin.cn?target=https%3A%2F%2Fgeopandas.org%2Fen%2Fstable%2Fgetting_started%2Fintroduction.html" target="_blank" title="https://geopandas.org/en/stable/getting_started/introduction.html" ref="nofollow noopener noreferrer">GeoPandas æ–‡æ¡£</a>æˆ–å‚è€ƒ Real Python çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fpython-folium-web-maps-from-data%2F" target="_blank" title="https://realpython.com/python-folium-web-maps-from-data/" ref="nofollow noopener noreferrer">Folium æ•™ç¨‹</a>æ¥åˆ›å»ºäº¤äº’å¼ Web åœ°å›¾ï¼Œä»è€Œè¿›ä¸€æ­¥æå‡è¿™äº›æŠ€èƒ½ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Frealpython.com%2Fgeopandas%2F" target="_blank" title="https://realpython.com/geopandas/" ref="nofollow noopener noreferrer">realpython.com/geopandas/</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F-1MHFlFpfQhtSqNKOGKytg" target="_blank" title="https://mp.weixin.qq.com/s/-1MHFlFpfQhtSqNKOGKytg" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/-1MHFlFpfâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[04ï½œMCP æœåŠ¡æ¥å£ï¼šè®©æœ¬åœ°èƒ½åŠ›å˜æˆ Agent å¯è°ƒç”¨çš„ Tools]]></title>    <link>https://juejin.cn/post/7602816610932654143</link>    <guid>https://juejin.cn/post/7602816610932654143</guid>    <pubDate>2026-02-05T01:50:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602816610932654143" data-draft-id="7602928783595503622" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="04ï½œMCP æœåŠ¡æ¥å£ï¼šè®©æœ¬åœ°èƒ½åŠ›å˜æˆ Agent å¯è°ƒç”¨çš„ Tools"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-05T01:50:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="goingflygo"/> <meta itemprop="url" content="https://juejin.cn/user/3896324936173719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            04ï½œMCP æœåŠ¡æ¥å£ï¼šè®©æœ¬åœ°èƒ½åŠ›å˜æˆ Agent å¯è°ƒç”¨çš„ Tools
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3896324936173719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    goingflygo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T01:50:40.000Z" title="Thu Feb 05 2026 01:50:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»çŸ¥é“ï¼š</p>
<ul>
<li>æ•°æ®å¦‚ä½•å­˜ï¼ˆSQLiteï¼‰</li>
<li>äº‹ä»¶å¦‚ä½•æ¥ï¼ˆç”Ÿå‘½å‘¨æœŸæŒ‚é’©ï¼‰</li>
<li>æ—¥å¿—å¦‚ä½•å˜è–„ï¼ˆæ‘˜è¦å‹ç¼©ï¼‰</li>
</ul>
<p>ä½†å°‘äº†ä¸€ä¸ªå…³é”®ç¯èŠ‚ï¼š<strong>Agent åˆ°åº•æ€ä¹ˆâ€œæ‘¸åˆ°â€è¿™äº›æœ¬åœ°èƒ½åŠ›ï¼Ÿ</strong></p>
<p>ç­”æ¡ˆå°±æ˜¯ï¼š<strong>MCPï¼ˆModel Context Protocolï¼‰</strong>ã€‚<code>trae-mem</code> é€šè¿‡å®ç°ä¸€ä¸ª MCP Serverï¼ŒæŠŠæœ¬åœ° Python é€»è¾‘åŒ…è£…æˆä¸€ç»„â€œå·¥å…·ï¼ˆToolsï¼‰â€ï¼Œè®© Trae çš„ Agent èƒ½åƒè°ƒç”¨å†…ç½®å·¥å…·ä¸€æ ·è°ƒç”¨å®ƒä»¬ã€‚</p>
<p>æœ¬æ–‡èšç„¦ç¬¬å››å—æ ¸å¿ƒèƒ½åŠ›ï¼š<strong>MCP Service Interfaceï¼ˆMCP æœåŠ¡æ¥å£ï¼‰</strong>ï¼Œæ ¸å¿ƒå®ç°ä½äº <a href="https://link.juejin.cn?target=..%2Ftrae_mem%2Fmcp_server.py" target="_blank" title="../trae_mem/mcp_server.py" ref="nofollow noopener noreferrer">mcp_server.py</a>ã€‚</p>
<hr/>
<h2 data-id="heading-0">1. è§’è‰²åˆ’åˆ†ï¼šTrae / Agent / MCP Server</h2>
<p>ä½ å¯ä»¥ç”¨ä¸€å¥è¯æŠŠä¸‰è€…å…³ç³»è®²æ¸…æ¥šï¼š</p>
<ul>
<li><strong>Traeï¼ˆå®¢æˆ·ç«¯/å®¿ä¸»ï¼‰</strong>ï¼šè´Ÿè´£å¯åŠ¨ MCP Serverï¼Œå¹¶æŠŠâ€œå·¥å…·èœå•â€æš´éœ²ç»™ Agent</li>
<li><strong>Agentï¼ˆæ¨¡å‹ï¼‰</strong>ï¼šè´Ÿè´£ç†è§£ç”¨æˆ·æ„å›¾ï¼Œå†³å®šè°ƒç”¨å“ªä¸ªå·¥å…·ã€ç”¨ä»€ä¹ˆå‚æ•°è°ƒç”¨</li>
<li><strong>MCP Serverï¼ˆæœåŠ¡ç«¯ï¼‰</strong>ï¼šè´Ÿè´£å®ç°å·¥å…·ï¼Œæ¥æ”¶ JSON-RPC è¯·æ±‚å¹¶è¿”å›ç»“æœ</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯ MCP çš„æ ¸å¿ƒä»·å€¼ï¼š<strong>æŠŠâ€œç†è§£ï¼ˆAIï¼‰â€ä¸â€œæ‰§è¡Œï¼ˆæœ¬åœ°èƒ½åŠ›ï¼‰â€è§£è€¦</strong>ã€‚</p>
<p>å¦‚æœä½ æƒ³çœ‹æ›´å®Œæ•´çš„â€œä¸‰è§’ååŒâ€è®²è§£ï¼Œå¯é…åˆé˜…è¯» <a href="https://link.juejin.cn?target=.%2Fmcp-architecture-deep-dive.md" target="_blank" title="./mcp-architecture-deep-dive.md" ref="nofollow noopener noreferrer">mcp-architecture-deep-dive.md</a>ã€‚</p>
<hr/>
<h2 data-id="heading-1">2. ä¼ è¾“å±‚ï¼šä¸ºä»€ä¹ˆæ˜¯ stdioï¼Ÿ</h2>
<p><code>trae-mem</code> é€‰æ‹© stdioï¼ˆæ ‡å‡†è¾“å…¥/è¾“å‡ºï¼‰ä½œä¸º MCP ä¼ è¾“æ–¹å¼ï¼š</p>
<ul>
<li>Trae å¯åŠ¨ server è¿›ç¨‹</li>
<li>Trae é€šè¿‡ stdin å†™å…¥ä¸€è¡Œè¡Œ JSONï¼ˆè¯·æ±‚ï¼‰</li>
<li>Server é€šè¿‡ stdout å›å†™ä¸€è¡Œè¡Œ JSONï¼ˆå“åº”ï¼‰</li>
</ul>
<p>ä¼˜ç‚¹éå¸¸â€œå·¥ç¨‹â€ï¼š</p>
<ul>
<li>ä¸éœ€è¦ç›‘å¬ç«¯å£ï¼ˆå‡å°‘é…ç½®ä¸å®‰å…¨é£é™©ï¼‰</li>
<li>è·¨å¹³å°ç¨³å®šï¼ˆmacOS/Linux/Windowsï¼‰</li>
<li>è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸç”±å®¿ä¸»æ§åˆ¶ï¼Œæ–¹ä¾¿è‡ªåŠ¨é‡å¯</li>
</ul>
<p>å®ç°å…¥å£æ˜¯ <a href="https://link.juejin.cn?target=..%2Ftrae_mem%2Fmcp_server.py%23L251-L311" target="_blank" title="../trae_mem/mcp_server.py#L251-L311" ref="nofollow noopener noreferrer">serve_stdio()</a>ã€‚</p>
<hr/>
<h2 data-id="heading-2">3. åè®®å±‚ï¼šJSON-RPC çš„æœ€å°å®ç°</h2>
<p>åœ¨ <code>serve_stdio()</code> ä¸­ï¼Œserver åšäº†ä¸€ä¸ªæç®€çš„ JSON-RPC å¾ªç¯ï¼š</p>
<ol>
<li><code>initialize</code>ï¼šæ¡æ‰‹ï¼Œå£°æ˜èƒ½åŠ›</li>
<li><code>tools/list</code>ï¼šè¿”å›å·¥å…·æ¸…å•</li>
<li><code>tools/call</code>ï¼šæ‰§è¡ŒæŸä¸ªå·¥å…·å¹¶è¿”å›ç»“æœ</li>
</ol>
<p>å¯¹åº”ä»£ç ç‰‡æ®µåœ¨ <a href="https://link.juejin.cn?target=..%2Ftrae_mem%2Fmcp_server.py%23L270-L305" target="_blank" title="../trae_mem/mcp_server.py#L270-L305" ref="nofollow noopener noreferrer">mcp_server.py</a>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> method == <span class="hljs-string">"initialize"</span>:
    _write(_result(id_value, {...capabilities...}))
    <span class="hljs-keyword">continue</span>

<span class="hljs-keyword">if</span> method == <span class="hljs-string">"tools/list"</span>:
    _write(_result(id_value, {<span class="hljs-string">"tools"</span>: _tools()}))
    <span class="hljs-keyword">continue</span>

<span class="hljs-keyword">if</span> method == <span class="hljs-string">"tools/call"</span>:
    name = <span class="hljs-built_in">str</span>(params.get(<span class="hljs-string">"name"</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">""</span>)
    args = params.get(<span class="hljs-string">"arguments"</span>) <span class="hljs-keyword">or</span> {}
    res = _handle_tool_call(name, args)
    _write(_result(id_value, res))
    <span class="hljs-keyword">continue</span>
</code></pre>
<p>æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰å¼•å…¥ä»»ä½•ç¬¬ä¸‰æ–¹åº“ï¼Œå®Œå…¨é  Python æ ‡å‡†åº“å°±èƒ½è·‘é€šã€‚</p>
<hr/>
<h2 data-id="heading-3">4. å·¥å…·å‘ç°ï¼štools/list ä¸ºä»€ä¹ˆè¿™ä¹ˆé‡è¦ï¼Ÿ</h2>
<p>Agent èƒ½è°ƒç”¨å“ªäº›èƒ½åŠ›ï¼Œå–å†³äº <code>tools/list</code> è¿”å›çš„â€œå·¥å…·æè¿°ï¼ˆSchemaï¼‰â€ã€‚åœ¨ <a href="https://link.juejin.cn?target=..%2Ftrae_mem%2Fmcp_server.py%23L33-L129" target="_blank" title="../trae_mem/mcp_server.py#L33-L129" ref="nofollow noopener noreferrer">mcp_server.py</a> çš„ <code>_tools()</code> é‡Œï¼Œ<code>trae-mem</code> å®šä¹‰äº† 7 ä¸ªå·¥å…·ï¼š</p>
<ul>
<li><code>trae_mem_search</code>ï¼šå…¨æ–‡æ£€ç´¢</li>
<li><code>trae_mem_timeline</code>ï¼šæŒ‰ observation_id æ‹‰æ—¶é—´çª—</li>
<li><code>trae_mem_get_observations</code>ï¼šæŒ‰ ID æ‰¹é‡å–è¯¦æƒ…</li>
<li><code>trae_mem_inject</code>ï¼šç”Ÿæˆå¯æ³¨å…¥ä¸Šä¸‹æ–‡å—</li>
<li><code>trae_mem_start_session</code>ï¼šåˆ›å»º session</li>
<li><code>trae_mem_log</code>ï¼šå†™å…¥ observation</li>
<li><code>trae_mem_end_session</code>ï¼šç»“æŸ session å¹¶ç”Ÿæˆæ‘˜è¦</li>
<li><code>trae_mem_hook_event</code>ï¼šé€‚é…ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼ˆæŠŠ Trae äº‹ä»¶å†™è¿› DBï¼‰</li>
</ul>
<p>æ¯ä¸ªå·¥å…·éƒ½æœ‰ï¼š</p>
<ul>
<li><code>name</code></li>
<li><code>description</code>ï¼šç»™æ¨¡å‹è¯»çš„è¯´æ˜</li>
<li><code>inputSchema</code>ï¼šå‚æ•°ç»“æ„ï¼ˆç±»å‹ã€å¿…å¡«å­—æ®µã€æšä¸¾å€¼ï¼‰</li>
</ul>
<p>è¿™æ˜¯â€œæ¨¡å‹å¯è°ƒç”¨å·¥å…·â€çš„å…³é”®ï¼š<strong>description + schema å°±æ˜¯æ¨¡å‹çš„è¯´æ˜ä¹¦</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-4">5. å·¥å…·æ‰§è¡Œï¼štools/call å¦‚ä½•è·¯ç”±åˆ°çœŸå®é€»è¾‘ï¼Ÿ</h2>
<p>å½“ Trae æ”¶åˆ° Agent è¾“å‡ºçš„â€œè°ƒç”¨æŸå·¥å…·â€çš„æ„å›¾ï¼Œå®ƒä¼šå‘é€ <code>tools/call</code> ç»™ serverã€‚server åœ¨ <code>_handle_tool_call()</code> å†…åšè·¯ç”±ï¼ˆè§ <a href="https://link.juejin.cn?target=..%2Ftrae_mem%2Fmcp_server.py%23L131-L249" target="_blank" title="../trae_mem/mcp_server.py#L131-L249" ref="nofollow noopener noreferrer">mcp_server.py</a>ï¼‰ï¼š</p>
<h3 data-id="heading-5">5.1 ç¤ºä¾‹ï¼štrae_mem_injectï¼ˆä¸Šä¸‹æ–‡æ³¨å…¥ï¼‰</h3>
<ul>
<li>å‚æ•°ï¼š<code>query/limit/project</code></li>
<li>é€»è¾‘ï¼šè°ƒç”¨ <a href="https://link.juejin.cn?target=..%2Ftrae_mem%2Fapi.py%23L98-L141" target="_blank" title="../trae_mem/api.py#L98-L141" ref="nofollow noopener noreferrer">build_injection_block</a> æ‹¼ä¸€æ®µæ–‡æœ¬å—</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> name == <span class="hljs-string">"trae_mem_inject"</span>:
    text = build_injection_block(db, query=query, limit=limit, project_path=...)
    <span class="hljs-keyword">return</span> _tool_text_result(text, structured={<span class="hljs-string">"context"</span>: text})
</code></pre>
<p>è¿”å›å€¼æ˜¯ MCP çº¦å®šçš„ ToolResult ç»“æ„ï¼š<code>content: [{type:"text", text:"..."}]</code>ã€‚</p>
<h3 data-id="heading-6">5.2 ç¤ºä¾‹ï¼štrae_mem_logï¼ˆå†™ observationï¼‰</h3>
<p>å®ƒä¼šï¼š</p>
<ul>
<li>å¤„ç† <code>&lt;private&gt;</code> è„±æ•ï¼ˆå¿…è¦æ—¶å°†æ•´æ®µæ ‡è®°ä¸º privateï¼‰</li>
<li>è°ƒç”¨ <code>db.add_observation(...)</code></li>
<li>è¿”å› <code>observation_id</code></li>
</ul>
<p>è§ <a href="https://link.juejin.cn?target=..%2Ftrae_mem%2Fmcp_server.py%23L181-L208" target="_blank" title="../trae_mem/mcp_server.py#L181-L208" ref="nofollow noopener noreferrer">mcp_server.py</a>ã€‚</p>
<hr/>
<h2 data-id="heading-7">6. å…³é”®æ¡¥æ¢ï¼štrae_mem_hook_event æ€ä¹ˆæŠŠ Trae ç”Ÿå‘½å‘¨æœŸâ€œçŒè¿›æ¥â€ï¼Ÿ</h2>
<p><code>trae_mem_hook_event</code> æ˜¯ <code>trae-mem</code> çš„â€œé€‚é…å™¨å·¥å…·â€ã€‚å®ƒæŠŠ Trae çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼ˆSessionStart / PreToolUse ç­‰ï¼‰è½¬æ¢æˆ <code>hooks_bridge.py</code> èƒ½å¤„ç†çš„å½¢å¼ã€‚</p>
<p>å®ç°ä½äº <a href="https://link.juejin.cn?target=..%2Ftrae_mem%2Fmcp_server.py%23L229-L245" target="_blank" title="../trae_mem/mcp_server.py#L229-L245" ref="nofollow noopener noreferrer">mcp_server.py</a>ï¼š</p>
<p>æ ¸å¿ƒæŠ€å·§åªæœ‰ä¸€ä¸ªï¼š<strong>ä¼ªé€  stdinï¼Œå¤ç”¨ hooks_bridge çš„ main()</strong>ã€‚</p>
<pre><code class="hljs language-python" lang="python">buf = json.dumps(payload, ensure_ascii=<span class="hljs-literal">False</span>)
proc_argv = [<span class="hljs-string">"--event"</span>, event]
stdin_backup = sys.stdin
<span class="hljs-keyword">try</span>:
    sys.stdin = io.StringIO(buf)
    rc = <span class="hljs-built_in">int</span>(hooks_bridge_main(proc_argv))
<span class="hljs-keyword">finally</span>:
    sys.stdin = stdin_backup
</code></pre>
<p>è¿™å¸¦æ¥ä¸¤ä¸ªå¥½å¤„ï¼š</p>
<ul>
<li>hooks_bridge å¯ä»¥ç»§ç»­ä¿æŒâ€œå‘½ä»¤è¡Œé£æ ¼â€ï¼ˆstdin + argvï¼‰ï¼Œæµ‹è¯•/è°ƒè¯•éƒ½å¾ˆæ–¹ä¾¿</li>
<li>MCP server ä¸éœ€è¦é‡å¤å†™ä¸€éäº‹ä»¶å¤„ç†é€»è¾‘</li>
</ul>
<hr/>
<h2 data-id="heading-8">7. å¤‡ç”¨æ¥å£ï¼šHTTP API ä¸ºä»€ä¹ˆå­˜åœ¨ï¼Ÿ</h2>
<p>é™¤äº† MCPï¼Œ<code>trae-mem</code> è¿˜æä¾›äº†ä¸€ä¸ªæç®€ HTTP APIï¼ˆè§ <a href="https://link.juejin.cn?target=..%2Ftrae_mem%2Fapi.py" target="_blank" title="../trae_mem/api.py" ref="nofollow noopener noreferrer">api.py</a>ï¼‰ã€‚å®ƒçš„ä»·å€¼æ˜¯ï¼š</p>
<ul>
<li>ä¸ä¾èµ– IDEï¼šè„šæœ¬/æµè§ˆå™¨ä¹Ÿèƒ½æŸ¥</li>
<li>ä¾¿äºå¤–éƒ¨é›†æˆï¼šæ¯”å¦‚ä½ å†™ä¸€ä¸ª Android Studio æ’ä»¶ï¼Œä¹Ÿèƒ½ç›´æ¥è¯·æ±‚ <code>/inject</code></li>
</ul>
<p>å¸¸ç”¨ç«¯ç‚¹ï¼š</p>
<ul>
<li><code>/search?q=...</code></li>
<li><code>/timeline?observation_id=...</code></li>
<li><code>/inject?q=...&amp;project=...</code></li>
</ul>
<hr/>
<h2 data-id="heading-9">8. ä½ å¯ä»¥æ€ä¹ˆæ‰©å±•ï¼Ÿ</h2>
<p>å¦‚æœä½ æƒ³è®© MCP å±‚æ›´å¼ºï¼Œå¸¸è§æ–¹å‘æœ‰ï¼š</p>
<ul>
<li><strong>æ›´å¼ºçš„ structuredContent</strong>ï¼šä¸ä»…è¿”å› textï¼Œè¿˜è¿”å›ç»“æ„åŒ– JSONï¼Œä¾¿äº Trae æˆ–æœªæ¥çš„ UI åšæ¸²æŸ“</li>
<li><strong>æƒé™/èƒ½åŠ›åˆ†çº§</strong>ï¼šæŒ‰é¡¹ç›®ç™½åå•ã€æŒ‰ tool åˆ†ç±»é™åˆ¶ï¼Œè¿›ä¸€æ­¥å‡å°‘è¯¯è°ƒç”¨é£é™©</li>
<li><strong>èµ„æºï¼ˆResourcesï¼‰æ¥å£</strong>ï¼šæŠŠ DB ä¸­çš„ summaries ä½œä¸ºèµ„æºæš´éœ²ï¼Œè®© IDE ç›´æ¥æµè§ˆ</li>
</ul>
<p>è‡³æ­¤ï¼Œå››ç¯‡æ¨¡å—æ‹†è§£å®Œæˆã€‚ä½ å¯ä»¥å›åˆ°æ€»è§ˆæ–‡ç« ï¼Œä»â€œæ•´ä½“æ¶æ„â€è§†è§’ä¸²èµ·å››å—èƒ½åŠ›ï¼Œå¹¶æŒ‰éœ€æ·±å…¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§£è¯»å¤šé‡èº«ä»½éªŒè¯ï¼ˆMFAï¼‰ç»•è¿‡ç ï¼šé£é™©ä¸æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7603004323870965803</link>    <guid>https://juejin.cn/post/7603004323870965803</guid>    <pubDate>2026-02-05T02:59:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603004323870965803" data-draft-id="7602921143490084907" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§£è¯»å¤šé‡èº«ä»½éªŒè¯ï¼ˆMFAï¼‰ç»•è¿‡ç ï¼šé£é™©ä¸æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T02:59:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿ç»´æœ‰å°é‚“1"/> <meta itemprop="url" content="https://juejin.cn/user/930603309497018"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§£è¯»å¤šé‡èº«ä»½éªŒè¯ï¼ˆMFAï¼‰ç»•è¿‡ç ï¼šé£é™©ä¸æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/930603309497018/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿ç»´æœ‰å°é‚“1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T02:59:05.000Z" title="Thu Feb 05 2026 02:59:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰è¢«å¹¿æ³›è§†ä¸ºèº«ä»½ä¿æŠ¤çš„é»„é‡‘æ ‡å‡†ã€‚ç„¶è€Œï¼Œå°½ç®¡å…¶åº”ç”¨å·²ååˆ†æ™®éï¼Œæ”»å‡»è€…ä»åœ¨ä¸æ–­å¯»æ‰¾MFAéƒ¨ç½²ä¸­çš„æ¼æ´ã€‚å…¶ä¸­ä¸€ä¸ªå¸¸è¢«è¯¯è§£çš„æ”»å‡»å‘é‡ä¾¿æ˜¯MFAç»•è¿‡ç â€”â€”è¿™æ˜¯ä¸€ç§ä¸€æ¬¡æ€§çš„æ›¿ä»£è®¤è¯æ–¹å¼ï¼Œå…è®¸ç”¨æˆ·åœ¨ç‰¹å®šã€å¯æ§çš„æƒ…å†µä¸‹ï¼Œæ— éœ€æä¾›ä¸»è¦ç¬¬äºŒéªŒè¯å› ç´ å³å¯å®Œæˆç™»å½•æµç¨‹ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨MFAç»•è¿‡ç çš„å®šä¹‰ã€å…¶å¼•å…¥çš„å®‰å…¨é£é™©ã€æ”»å‡»è€…åˆ©ç”¨ç»•è¿‡ç çš„å¸¸è§æ‰‹æ®µï¼Œä»¥åŠæœ€é‡è¦çš„â€”â€”ä¼ä¸šå¦‚ä½•ç¼“è§£è¿™äº›å¨èƒã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å°†åˆ†æADSelfService Plusç­‰å·¥å…·å¦‚ä½•å¸®åŠ©ä¼ä¸šåœ¨ç»´æŒå¼ºæ•ˆMFAé˜²æŠ¤çš„åŒæ—¶ï¼Œå®‰å…¨ç®¡ç†å¿…è¦çš„å¤‡ç”¨éªŒè¯æœºåˆ¶ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯MFAç»•è¿‡ç ï¼Ÿ</h3>
<p>MFAç»•è¿‡ç æ˜¯ä¸€ç§æ›¿ä»£è®¤è¯ä»¤ç‰Œï¼Œå…è®¸ç”¨æˆ·ï¼ˆåœ¨æŸäº›æƒ…å†µä¸‹ä¹ŸåŒ…æ‹¬ç®¡ç†å‘˜ï¼‰åœ¨ç‰¹å®šåœºæ™¯ä¸‹ç»•è¿‡æ ‡å‡†çš„MFAéªŒè¯ã€‚å…¸å‹çš„åˆæ³•ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ï¼š</p>
<p>ç”¨æˆ·ä¸¢å¤±ã€æ›´æ¢éªŒè¯è®¾å¤‡ï¼Œæˆ–æ— æ³•è·å–çŸ­ä¿¡/é‚®ä»¶éªŒè¯ç ï¼›<br/>
å½“ç”¨æˆ·çš„ä¸»è¦MFAéªŒè¯æ–¹å¼ä¸å¯ç”¨æ—¶ï¼Œç®¡ç†å‘˜å‘æ”¾ä¸´æ—¶ç»•è¿‡ç ï¼›<br/>
éƒ¨åˆ†ç³»ç»Ÿå…è®¸å¯ä¿¡è®¾å¤‡æˆ–å¯ä¿¡ç½‘ç»œåœ¨å¯æ§æ¡ä»¶ä¸‹ç»•è¿‡MFAï¼Œä¾‹å¦‚â€œè®°ä½æˆ‘â€åŠŸèƒ½æˆ–çŸ­æœŸä¼šè¯è±å…æœºåˆ¶ã€‚<br/>
è‹¥ç»•è¿‡ç éƒ¨ç½²å¾—å½“â€”â€”å…·å¤‡çŸ­æœŸæœ‰æ•ˆæ€§ã€ä¸€æ¬¡æ€§ä½¿ç”¨å±æ€§ã€å¯å®¡è®¡æ€§ï¼Œä¸”ä»…åœ¨ç»è¿‡ä¸¥æ ¼èº«ä»½éªŒè¯åå‘æ”¾ï¼Œå°±èƒ½åœ¨ä¸å‰Šå¼±MFAå®‰å…¨ä¼˜åŠ¿çš„å‰æä¸‹ï¼Œä¸ºä¼ä¸šè¿è¥æä¾›çµæ´»æ€§ã€‚åä¹‹ï¼Œè‹¥ç®¡ç†æ¾æ•£ã€é…ç½®ä¸å½“æˆ–è¿‡åº¦ä½¿ç”¨ï¼Œåˆ™ä¼šå¼•å…¥æ˜¾è‘—å®‰å…¨é£é™©ã€‚</p>
<h3 data-id="heading-1">äºŒã€ä¸ºä½•ç»•è¿‡ç æˆä¸ºæ”»å‡»ç›®æ ‡ï¼Ÿæ”»å‡»è€…å¦‚ä½•åˆ©ç”¨ï¼Ÿ</h3>
<p>ç»•è¿‡ç åœ¨ä¿éšœä¸šåŠ¡è¿ç»­æ€§æ–¹é¢å‘æŒ¥ç€é‡è¦ä½œç”¨ï¼Œä½†ä¹Ÿå‚¬ç”Ÿäº†æ”»å‡»è€…å¯èƒ½åˆ©ç”¨çš„æ›¿ä»£è®¤è¯è·¯å¾„ï¼Œå°¤å…¶æ˜¯å½“è¿™äº›æœºåˆ¶ç¼ºä¹ä¸¥æ ¼ç®¡æ§æ—¶ã€‚ä»¥ä¸‹å°†è§£æä¸ºä½•ç»•è¿‡ç åœ¨å½“å‰å¨èƒç¯å¢ƒä¸­å¤‡å—å…³æ³¨ï¼Œä»¥åŠæ”»å‡»è€…çš„å¸¸è§æ»¥ç”¨æ‰‹æ®µã€‚</p>
<p><strong>äººä¸ºå› ç´ ä¸ç¤¾ä¼šå·¥ç¨‹æ”»å‡»</strong><br/>
æ”»å‡»è€…å¾€å¾€å°†ç›®æ ‡èšç„¦äºäººè€Œéç³»ç»Ÿã€‚ä»–ä»¬å¯èƒ½å†’å……ITäººå‘˜æˆ–ç»ˆç«¯ç”¨æˆ·å‘æœåŠ¡å°ç´¢è¦ç»•è¿‡ç ï¼Œæˆ–è¯±éª—ç”¨æˆ·æ³„éœ²è‡ªèº«çš„ç»•è¿‡ç ã€‚å°½ç®¡MFAç–²åŠ³æ”»å‡»ä¸ä¼šç›´æ¥ç”Ÿæˆç»•è¿‡ç ï¼Œä½†ä¼šå‘ç”¨æˆ·æ–½å‹ï¼Œè¿«ä½¿å…¶æ‰¹å‡†æ¬ºè¯ˆæ€§MFAéªŒè¯è¯·æ±‚ï¼Œè¿›è€Œä¸ºæ”»å‡»è€…åˆ©ç”¨æ¢å¤æµç¨‹æˆ–å¯ä¿¡è®¾å¤‡é€»è¾‘åˆ›é€ å¯ä¹˜ä¹‹æœºã€‚</p>
<p><strong>é…ç½®ä¸å½“ä¸é—ç•™è®¤è¯è·¯å¾„</strong><br/>
è–„å¼±æˆ–è¿‡æ—¶çš„é…ç½®å¯èƒ½æ— æ„ä¸­äº§ç”ŸMFAç»•è¿‡æ¡ä»¶ï¼Œä¾‹å¦‚ï¼š</p>
<p>æ¡ä»¶è®¿é—®è§„åˆ™è‡ªåŠ¨ä¿¡ä»»ç‰¹å®šä½ç½®æˆ–è®¾å¤‡ï¼Œé™ä½MFAéªŒè¯è¦æ±‚ï¼›<br/>
é‚®å±€åè®®ï¼ˆPOPï¼‰ã€äº’è”ç½‘é‚®ä»¶è®¿é—®åè®®ï¼ˆIMAPï¼‰ç­‰é—ç•™åè®®å®Œå…¨æ— æ³•å¼ºåˆ¶æ‰§è¡ŒMFAéªŒè¯ã€‚<br/>
è‹¥è¿™äº›é—ç•™è·¯å¾„æœªè¢«ç¦ç”¨ï¼Œå®é™…ä¸Šå°±ç­‰åŒäºMFAç»•è¿‡æœºåˆ¶ï¼Œææ˜“æˆä¸ºæ”»å‡»è€…è§„é¿MFAéªŒè¯çš„ç›®æ ‡ã€‚</p>
<p><strong>è„†å¼±çš„MFAæ¢å¤æµç¨‹</strong><br/>
é‡ç½®éªŒè¯åº”ç”¨ã€æ›´æ¢å¯ä¿¡è®¾å¤‡ç­‰æ¢å¤æµç¨‹ï¼Œå…¶å®‰å…¨æ€§å¾€å¾€ä½äºMFAéªŒè¯æœ¬èº«ã€‚è–„å¼±çš„èº«ä»½éªŒè¯ã€è¿‡æ—¶çš„æœåŠ¡å°æµç¨‹æˆ–ä¸å®‰å…¨çš„æ¢å¤æ¸ é“ï¼Œéƒ½å¯èƒ½è®©æ”»å‡»è€…æ— éœ€è·å–ç”¨æˆ·è®¾å¤‡æˆ–éªŒè¯ç å°±èƒ½ç»•è¿‡MFAã€‚</p>
<p><strong>ç»•è¿‡ç ç”Ÿå‘½å‘¨æœŸç®¡ç†ä¸å–„</strong><br/>
è‹¥ç»•è¿‡ç ä¸å…·å¤‡ä¸€æ¬¡æ€§ä½¿ç”¨å±æ€§ã€æœ‰æ•ˆæœŸè¿‡é•¿ã€å‘æ”¾æ¸ é“ä¸å®‰å…¨ï¼Œæˆ–ç¼ºä¹å®Œæ•´æ—¥å¿—è®°å½•ï¼Œå°±æ›´å®¹æ˜“è¢«æ‹¦æˆªã€å¤ç”¨æˆ–æœªæˆæƒå‘æ”¾ã€‚è€Œå®¡è®¡ä¸è¶³åˆ™ä¼šè¿›ä¸€æ­¥é™ä½å¯¹ç»•è¿‡ç ç›¸å…³å¯ç–‘æ´»åŠ¨çš„å¯è§æ€§ã€‚</p>
<p><strong>ç®¡ç†å‘˜è´¦æˆ·æ³„éœ²æˆ–æƒé™è¿‡åº¦</strong><br/>
ç®¡ç†å‘˜é€šå¸¸æ‹¥æœ‰ç”Ÿæˆç»•è¿‡ç çš„æƒé™ï¼Œè¿™ä½¿å…¶è´¦æˆ·æˆä¸ºé«˜ä»·å€¼æ”»å‡»ç›®æ ‡ã€‚ä¸€æ—¦æ”»å‡»è€…æ”»é™·ç®¡ç†å‘˜è´¦æˆ·ï¼Œæˆ–ç®¡ç†å‘˜æŒæœ‰ä¸å¿…è¦çš„è¿‡é«˜æƒé™ï¼Œå°±èƒ½ç»•å¼€MFAéªŒè¯ç›´æ¥å‘æ”¾ç»•è¿‡ç ï¼Œè¿›è€Œè·å–å—ä¿æŠ¤ç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚</p>
<p>ç»•è¿‡ç æœ¬èº«å¹¶éå¤©ç”Ÿä¸å®‰å…¨ï¼Œé£é™©æ ¸å¿ƒåœ¨äºç®¡ç†è–„å¼±ã€‚è‹¥èƒ½å°†å…¶ä¸¥æ ¼ç®¡æ§ä¸ºçŸ­æœŸæœ‰æ•ˆã€ä¸€æ¬¡æ€§ä½¿ç”¨ã€å¯å®¡è®¡ï¼Œä¸”ä¸å¼ºæ•ˆèº«ä»½éªŒè¯ç»‘å®šï¼Œå°±èƒ½åœ¨ä¸å‰Šå¼±MFAé˜²å¾¡ä»·å€¼çš„å‰æä¸‹ï¼Œæå‡ç³»ç»ŸéŸ§æ€§ã€‚</p>
<h3 data-id="heading-2">ä¸‰ã€é£é™©ç¼“è§£ï¼šMFAç»•è¿‡ç ç®¡ç†æœ€ä½³å®è·µ</h3>
<p>ä¸ºä¿æŠ¤ä¼ä¸šå…å—MFAç»•è¿‡æœºåˆ¶ç›¸å…³å¨èƒï¼Œå»ºè®®éƒ¨ç½²ä»¥ä¸‹æœ€ä½³å®è·µï¼š</p>
<p>ä¸ºæ‰€æœ‰è´¦æˆ·å¼ºåˆ¶æ‰§è¡ŒMFAéªŒè¯ï¼Œå°¤å…¶æ˜¯ç‰¹æƒè´¦æˆ·å’ŒæœåŠ¡è´¦æˆ·ã€‚é™¤éæœ‰å……åˆ†åˆç†çš„ç†ç”±ï¼Œå¦åˆ™é¿å…é€‰æ‹©æ€§è±å…ï¼Œå‡å°‘å¯¹MFAç»•è¿‡ç çš„ä¸å¿…è¦ä¾èµ–ï¼›<br/>
å®šæœŸå®¡æŸ¥æ¡ä»¶è®¿é—®è§„åˆ™ã€ä¼šè¯è®¾ç½®å’Œå¯ä¿¡è®¾å¤‡ç­–ç•¥ï¼Œå‡å°‘å¯ä¿¡è®¾å¤‡ä¸å¯ä¿¡ä½ç½®çš„ç»•è¿‡åœºæ™¯ï¼Œç¡®ä¿ä¸å­˜åœ¨å¯ä½œä¸ºâ€œéšæ€§ç»•è¿‡è·¯å¾„â€çš„æ„å¤–æˆ–éšè—MFAè±å…è§„åˆ™ï¼›<br/>
ä¸¥æ ¼ç®¡æ§ç»•è¿‡ç ï¼š</p>
<p>ç›‘æ§å¼‚å¸¸MFAè¡Œä¸ºï¼Œä¾‹å¦‚é‡å¤çš„MFAéªŒè¯è¯·æ±‚ã€å¤šæ¬¡ç”³è¯·ç»•è¿‡ç ã€æ¥è‡ªé™Œç”Ÿæˆ–é«˜é£é™©è®¾å¤‡/ä½ç½®çš„ç™»å½•å°è¯•ï¼›<br/>
å¼€å±•ç”¨æˆ·å®‰å…¨æ•™è‚²ï¼Œå¼ºè°ƒç»•è¿‡ç å±äºæ•æ„Ÿå‡­è¯ï¼Œä¸¥ç¦å…±äº«ã€é€šè¿‡é‚®ä»¶ä¼ è¾“æˆ–å­˜å‚¨åœ¨ä¸å®‰å…¨ä½ç½®ã€‚</p>
<h3 data-id="heading-3">å››ã€ADSelfService Pluså¦‚ä½•å¼ºåŒ–MFAé˜²æŠ¤å¹¶ç®¡æ§ç»•è¿‡é£é™©ï¼Ÿ</h3>
<p>ADSelfService Plusæä¾›å¼ºå¤§ä¸”çµæ´»çš„MFAæ¡†æ¶ï¼Œæ—¨åœ¨é™ä½ç»•è¿‡é£é™©ï¼Œä¸ºå„ç±»ä¼ä¸šç¯å¢ƒæä¾›å…¨é¢çš„å¼ºæ•ˆè®¤è¯ä¿éšœã€‚</p>
<p><strong>1. ç»•è¿‡ç å¯è§†åŒ–ä¸å®¡è®¡æŠ¥å‘Š</strong></p>
<p>ADSelfService Pluså…·å¤‡å…¨é¢çš„å®¡è®¡æ—¥å¿—å’ŒæŠ¥å‘ŠåŠŸèƒ½ï¼Œè®©ç®¡ç†å‘˜èƒ½å…¨ç¨‹æŒæ¡MFAæ´»åŠ¨åŠç»•è¿‡ç ä½¿ç”¨æƒ…å†µã€‚å…¶ä¸­ï¼ŒMFAä½¿ç”¨å®¡è®¡æŠ¥å‘Šå¯è¿½è¸ªæ¯ä¸€æ¬¡è®¤è¯å°è¯•ï¼ŒåŒ…æ‹¬è®¤è¯æˆè´¥ã€æ—¶é—´æˆ³ã€ç»ˆç«¯è®¾å¤‡å’ŒIPåœ°å€ç­‰ä¿¡æ¯ï¼ŒåŠ©åŠ›å¿«é€Ÿè¯†åˆ«å¼‚å¸¸è¡Œä¸ºã€‚</p>
<p>ä¸“å±çš„å¤‡ç”¨ç ä½¿ç”¨æŠ¥å‘Šï¼ˆADSelfService Plusä¸­ï¼Œå¤‡ç”¨ç å³å—æ§MFAç»•è¿‡ç ï¼‰ä¼šè®°å½•æ‰€æœ‰å¤‡ç”¨ç çš„ç”Ÿæˆä¸ä½¿ç”¨å®ä¾‹ï¼Œæ•è·ç”¨æˆ·ä¿¡æ¯ã€å…³è”ç­–ç•¥ã€ç»ˆç«¯è®¾å¤‡ã€IPåœ°å€ä»¥åŠæ“ä½œå‘èµ·æ–¹ï¼ˆç”¨æˆ·æˆ–ç®¡ç†å‘˜ï¼‰ç­‰ç»†èŠ‚ã€‚ç»“åˆå¯¼å‡ºåŠŸèƒ½å’Œå®šæ—¶æ¨é€æœºåˆ¶ï¼Œä¼ä¸šèƒ½å¯¹å¤‡ç”¨è®¤è¯æµç¨‹å®ç°å¼ºæ•ˆç›‘ç®¡ï¼Œå‡å°‘å¯¹ä¸å®‰å…¨æ¢å¤æ–¹å¼çš„ä¾èµ–ï¼Œä¸¥æ ¼ç®¡æ§ç»•è¿‡ç ï¼Œåœ¨ä¿éšœå¯ç”¨æ€§çš„åŒæ—¶ç»´æŒç¨³å¥çš„èº«ä»½å®‰å…¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c73afd9083a476c94a59571c68efca9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-Q57u05pyJ5bCP6YKTMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770865144&amp;x-signature=I6Hn3e72iszKJZBFUQOJ3Pck%2BxY%3D" alt="image.png" loading="lazy"/></p>
<p><strong>2. å…¨é¢çš„ç»ˆç«¯ä¸è®¿é—®è¦†ç›–</strong></p>
<p>ADSelfService Plusæ”¯æŒåœ¨Windowsã€macOSã€Linuxè®¾å¤‡ä¸Šéƒ¨ç½²MFAï¼Œè¦†ç›–åŸŸåŠ å…¥è´¦æˆ·å’Œæœ¬åœ°è´¦æˆ·ï¼›åŒæ—¶ä¿éšœè¿œç¨‹è®¿é—®è·¯å¾„å®‰å…¨ï¼ŒåŒ…æ‹¬RDPã€VPNï¼ˆé€šè¿‡RADIUSåè®®ï¼‰å’ŒOutlook Web Accessï¼Œç¡®ä¿æ‰€æœ‰ç»ˆç«¯å‡èƒ½å®ç°ä¸€è‡´çš„MFAéªŒè¯ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥è§£å†³æ–¹æ¡ˆä¸ºWindowså’ŒmacOSæä¾›ç¦»çº¿MFAåŠŸèƒ½ï¼Œå³ä¾¿è®¾å¤‡è„±ç¦»ç½‘ç»œï¼Œä¹Ÿèƒ½å®ç°å®‰å…¨ç™»å½•ã€‚</p>
<p><strong>3. è‡ªé€‚åº”MFA</strong></p>
<p>ç®¡ç†å‘˜å¯åŸºäºIPåœ°å€ã€è®¾å¤‡ç±»å‹ã€è®¿é—®æ—¶é—´å’Œåœ°ç†ä½ç½®å®šä¹‰æ¡ä»¶è®¿é—®ç­–ç•¥ã€‚ADSelfService Plusä¼šæ ¹æ®è¿™äº›æ¡ä»¶åŠ¨æ€è°ƒæ•´MFAéªŒè¯çš„çº§åˆ«æˆ–ç±»å‹ï¼Œåœ¨å¹³è¡¡å®‰å…¨æ€§ä¸å¯ç”¨æ€§çš„åŒæ—¶ï¼Œé¿å…è¿‡åº¦ä½¿ç”¨å¤‡ç”¨æˆ–ç»•è¿‡æœºåˆ¶ã€‚</p>
<p><strong>4. ä¸°å¯Œçš„è®¤è¯å› ç´ é€‰æ‹©</strong></p>
<p>ADSelfService Plusæ”¯æŒ20ç§è®¤è¯æ–¹å¼ï¼ŒåŒ…æ‹¬ç”Ÿç‰©è¯†åˆ«ï¼ˆæŒ‡çº¹è¯†åˆ«ã€äººè„¸è¯†åˆ«ï¼‰ã€YubiKeyç­‰FIDO2å¯†é’¥ã€åŸºäºTOTPçš„éªŒè¯åº”ç”¨ä»¥åŠçŸ­ä¿¡/é‚®ä»¶ä¸€æ¬¡æ€§éªŒè¯ç ã€‚é€šè¿‡æ”¯æŒå®‰å…¨å¯†é’¥å’Œè®¾å¤‡å¯†é’¥ï¼Œä¼ä¸šå¯éƒ¨ç½²æŠ—é’“é±¼çš„æ— å¯†ç è®¤è¯æ–¹æ¡ˆã€‚è¿™äº›å¼ºæ•ˆè®¤è¯å› ç´ èƒ½å‡å°‘å¯¹ç»•è¿‡ç ç­‰å¤‡ç”¨æœºåˆ¶çš„éœ€æ±‚ï¼Œæ˜¾è‘—æå‡æ•´ä½“èº«ä»½å®‰å…¨æ°´å¹³ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bd22a29e0cc428bbc97228b7d99ed53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-Q57u05pyJ5bCP6YKTMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770865144&amp;x-signature=ueVqTguIVlDjLNKnyJk%2BNP8dJM4%3D" alt="image.png" loading="lazy"/></p>
<p><strong>5. ç²¾ç»†åŒ–ç­–ç•¥æ§åˆ¶</strong></p>
<p>ç®¡ç†å‘˜å¯åŸºäºç»„ç»‡å•å…ƒã€å®‰å…¨ç»„æˆ–åŸŸç»“æ„åˆ¶å®šç²¾ç»†åŒ–MFAç­–ç•¥ï¼Œç¡®ä¿æ•æ„Ÿéƒ¨é—¨æˆ–ç‰¹æƒç”¨æˆ·é‡‡ç”¨æ›´ä¸¥æ ¼çš„è®¤è¯è¦æ±‚ï¼Œé™ä½MFAè¢«ç»•è¿‡æˆ–è¿‡åº¦ä½¿ç”¨ç»•è¿‡ç çš„é£é™©ã€‚å¼ºåˆ¶æ³¨å†Œè§„åˆ™èƒ½ç¡®ä¿ç”¨æˆ·åŠæ—¶å®ŒæˆéªŒè¯å·¥å…·æ³¨å†Œï¼Œè€Œç­–ç•¥çº§é™åˆ¶å¯è®©ç®¡ç†å‘˜ç®¡æ§ç”¨æˆ·å¯ä½¿ç”¨çš„è®¤è¯å› ç´ ç±»å‹ã€‚ç»“åˆæ¡ä»¶è®¿é—®è§„åˆ™ï¼Œä¼ä¸šå¯æ ¹æ®é£é™©ç­‰çº§æˆ–è®¿é—®åœºæ™¯æ‰§è¡Œå·®å¼‚åŒ–çš„MFAæµç¨‹ã€‚</p>
<p>MFAè™½ä¸å¯æˆ–ç¼ºï¼Œä½†å¹¶éæ— æ‡ˆå¯å‡»ã€‚ç»•è¿‡ç ã€å¯ä¿¡è®¾å¤‡è±å…ã€é—ç•™åè®®ä»¥åŠç¤¾ä¼šå·¥ç¨‹æ”»å‡»ç­‰ï¼Œå‡ä¼šå¢åŠ MFAè¢«ç»•è¿‡çš„é£é™©ï¼Œå› æ­¤å¯¹å¤‡ç”¨æœºåˆ¶çš„ä¸¥æ ¼ç®¡æ§è‡³å…³é‡è¦ã€‚é€šè¿‡æ‰§è¡Œä¸¥æ ¼çš„ç»•è¿‡ç ç®¡æ§ã€ç›‘æ§ç»•è¿‡ç ä½¿ç”¨æ¨¡å¼ã€éƒ¨ç½²æŠ—é’“é±¼è®¤è¯æ–¹æ¡ˆï¼Œä¼ä¸šå¯å¤§å¹…é™ä½ç»•è¿‡ç æ»¥ç”¨å¸¦æ¥çš„é£é™©ã€‚ADSelfService Plusç­‰è§£å†³æ–¹æ¡ˆé€šè¿‡å¼ºåŒ–å¤‡ç”¨è®¤è¯è·¯å¾„ã€æä¾›å…¨é¢çš„å¨èƒå¯è§æ€§ï¼ŒåŠ©åŠ›ä¼ä¸šæŠµå¾¡æ–°å…´å¨èƒã€‚åœ¨èº«ä»½æˆä¸ºæ–°å®‰å…¨è¾¹ç•Œçš„å½“ä¸‹ï¼ŒåŒæ—¶ä¿éšœä¸»MFAæµç¨‹ä¸å¤‡ç”¨æœºåˆ¶çš„å®‰å…¨ï¼Œæ˜¯å®ç°çœŸæ­£å®‰å…¨éŸ§æ€§çš„æ ¸å¿ƒè¦æ±‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ Hashids ä¼˜é›…è§£å†³ C ç«¯è‡ªå¢ ID æš´éœ²é—®é¢˜]]></title>    <link>https://juejin.cn/post/7602811649126301747</link>    <guid>https://juejin.cn/post/7602811649126301747</guid>    <pubDate>2026-02-04T13:09:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602811649126301747" data-draft-id="7602634187284185098" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ Hashids ä¼˜é›…è§£å†³ C ç«¯è‡ªå¢ ID æš´éœ²é—®é¢˜"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-02-04T13:09:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ALGO"/> <meta itemprop="url" content="https://juejin.cn/user/2207475076971502"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ Hashids ä¼˜é›…è§£å†³ C ç«¯è‡ªå¢ ID æš´éœ²é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2207475076971502/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ALGO
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T13:09:30.000Z" title="Wed Feb 04 2026 13:09:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ C ç«¯ç³»ç»Ÿä¸­ï¼Œç›´æ¥å¯¹å¤–æš´éœ²æ•°æ®åº“è‡ªå¢ ID å¾€å¾€ä¼šå¸¦æ¥æ•°æ®æšä¸¾ã€è¶Šæƒè®¿é—®ç­‰å®‰å…¨éšæ‚£ã€‚æœ¬æ–‡å°†ä»å®é™…ä¸šåŠ¡åœºæ™¯å‡ºå‘ï¼Œåˆ†æè‡ªå¢ ID æš´éœ²çš„é—®é¢˜æœ¬è´¨ï¼Œå¹¶ä»‹ç»ä¸€ç§åŸºäº Hashids çš„å¯é€† ID æ··æ·†æ–¹æ¡ˆã€‚é€šè¿‡ Hashidsï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸æ”¹å˜æ•°æ®åº“ç»“æ„çš„å‰æä¸‹ï¼Œå®ç°å¯¹å¤– ID çš„å®‰å…¨åŒ–ä¸ç¾è§‚åŒ–ï¼Œå…¼é¡¾å®‰å…¨æ€§ã€æ€§èƒ½ä¸å·¥ç¨‹å¯è½åœ°æ€§ã€‚</p>
<p><strong>æœ¬æ–‡ä¸»è¦å†…å®¹ï¼š</strong></p>
<ul>
<li>ä¸ºä»€ä¹ˆ C ç«¯ç³»ç»Ÿä¸èƒ½ç›´æ¥æš´éœ²è‡ªå¢ ID</li>
<li>è§£å†³æ–¹æ¡ˆæ˜¯ä»€ä¹ˆ</li>
<li>hashidsæœ‰é‚£äº›åŠŸèƒ½</li>
<li>hashidsçš„ä»£ç å®ç°æ˜¯ä»€ä¹ˆ</li>
</ul>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆ C ç«¯ç³»ç»Ÿä¸èƒ½ç›´æ¥æš´éœ²è‡ªå¢ IDï¼Ÿ</h2>
<p>åœ¨åç«¯ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä¹ æƒ¯ä½¿ç”¨æ•°æ®åº“è‡ªå¢ IDï¼Œå¹¶ä¹ æƒ¯æ€§çš„ç›´æ¥è¿”å›ç»™Cç«¯äº¤äº’ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š</p>
<blockquote>
<p>ç™»å½•æ¥å£åœ¨ç™»å½•æˆåŠŸåè¿”å›çš„ç”¨æˆ·åŸºç¡€ä¿¡æ¯<br/>
{<br/>
"userId": 100,<br/>
"username": "tom",<br/>
"gender": 1,<br/>
"birthday": "2000-10-12 00:00:00"<br/>
}</p>
<p>URLä¸Šç›´æ¥æœ‰è‡ªå¢IDï¼šGET /api/user/100</p>
</blockquote>
<h3 data-id="heading-1">å¯è¢«æšä¸¾</h3>
<p>åªè¦æœ‰äººå‘ç°è¿™æ˜¯<strong>è‡ªå¢ IDï¼Œ</strong> ä¾‹å¦‚ï¼šGET /api/user/100ï¼Œè‡ªç„¶å¯ä»¥è¢«æšä¸¾</p>
<blockquote>
<p>/api/user/101</p>
<p>/api/user/102</p>
<p>/api/user/103</p>
<p>......</p>
</blockquote>
<p>å‘ç°äº†é—®é¢˜æ²¡ï¼š</p>
<ul>
<li>å¯ä»¥è½»æ¾éå†æ¥å£ã€çˆ¬è™«å¯ä»¥æ‰¹é‡æ‰«åº“</li>
<li>å“ªæ€•ä½ æœ‰ç™»å½•æ€ã€é‰´æƒï¼Œåªè¦ <strong>æƒé™æ ¡éªŒæœ‰ä¸€ä¸ªç‚¹æ²¡å…œä½</strong>ï¼Œåæœæå…¶ä¸¥é‡ï¼šè¡¨æ•°æ®è¢«æ‰¹é‡æŠ“å–ï¼Œéšç§æ•°æ®è¢«éå†ã€çˆ¬å…‰</li>
<li>è¿™ç±»æ”»å‡»æˆæœ¬æä½ï¼Œç”šè‡³ä¸ç®—â€œæ”»å‡»â€</li>
</ul>
<h3 data-id="heading-2">è¶Šæƒ</h3>
<p>è¶Šæƒçš„é£é™©è¢«æ— é™æ”¾å¤§ï¼Œä½ â€œä»¥ä¸ºâ€ä½ åšäº†é‰´æƒï¼Œå…¶å®ä¸ä¸€å®šï¼Œç°å®æƒ…å†µå¾€å¾€æ˜¯ï¼š</p>
<ul>
<li>æ¥å£ A åšäº†ç”¨æˆ·æ ¡éªŒ</li>
<li>æ¥å£ B å¿˜äº†</li>
<li>æ–°æ¥å£ä¸´æ—¶åŠ çš„ï¼Œæ ¡éªŒæ¼äº†</li>
<li>æŸä¸ªå†…éƒ¨æ¥å£è¢«è¯¯æš´éœ²</li>
</ul>
<p>ä¸€æ—¦ ID æ˜¯å¯é¢„æµ‹çš„ï¼š</p>
<ul>
<li>æ”»å‡»è€…åªéœ€è¦æ‰¾åˆ° ä¸€ä¸ªæ²¡æ ¡éªŒçš„å…¥å£</li>
<li>å°±å¯ä»¥â€œæ¨ªå‘ç§»åŠ¨â€è®¿é—®æ‰€æœ‰æ•°æ®</li>
</ul>
<p>ä¾‹å¦‚ï¼ŒURLä¸­å­˜åœ¨è‡ªå¢IDï¼Œåœ¨Cç«¯éå¸¸å…¸å‹çš„åœºæ™¯æ˜¯ç”¨æˆ·åˆ†äº«é“¾æ¥ç»™æœ‹å‹ï¼Œå¦‚æœæœ‹å‹ä¿®æ”¹URLä¸­çš„IDï¼Œå°±ä¼šè·³è½¬åˆ°æœ¬ä¸å±äºè‡ªå·±èƒ½çœ‹åˆ°çš„æ•°æ®å†…å®¹ã€‚</p>
<h3 data-id="heading-3">ä¸šåŠ¡ä¿¡æ¯å…¨æš´éœ²</h3>
<p>é€šè¿‡ ID å°±èƒ½çœ‹ç©¿ä½ çš„ä¸šåŠ¡ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ğŸ“ˆ <strong>è®¢å•é‡å¢é•¿é€Ÿåº¦</strong></li>
<li>ğŸ‘¥ <strong>ç”¨æˆ·è§„æ¨¡</strong></li>
<li>â±ï¸ <strong>ä¸šåŠ¡å³°å€¼æ—¶æ®µ</strong></li>
<li>ğŸ§® <strong>æ˜¯å¦åˆ è¿‡æ•°æ®ï¼ˆID æ˜¯å¦æ–­å±‚ï¼‰</strong></li>
</ul>
<p>è¿™ç§åœ¨Cç«¯ç”¨æˆ·çœ‹æ¥æ²¡æœ‰æ„ä¹‰çš„æ•°æ®ï¼Œå¦‚æœè®©ç”¨æˆ·â€œçœ‹ä¸æ‡‚â€çš„ IDï¼Œåè€Œæ›´ä¸“ä¸šã€‚</p>
<ul>
<li>ğŸ‘‰ çº¯æ•°å­— IDï¼Œçœ‹èµ·æ¥åƒâ€œå†…éƒ¨ç³»ç»Ÿâ€</li>
<li>ğŸ‘‰æ··æ·† IDï¼ŒÂ æ›´åƒâ€œäº§å“è®¾è®¡çš„ä¸€éƒ¨åˆ†â€</li>
</ul>
<h2 data-id="heading-4">è§£å†³æ–¹æ¡ˆ</h2>
<p>æ ¹æ®ä»¥ä¸Šé—®é¢˜ï¼Œæˆ‘ä»¬æœŸæœ›æœ‰è¿™æ ·ä¸€ç§è§£å†³æ–¹æ¡ˆå¯ä»¥æ··æ·†è‡ªå¢ID</p>
<ul>
<li>å”¯ä¸€ä¸å¯é‡å¤ï¼šæ•°æ®é‡å†…éƒ½å¿…é¡»å”¯ä¸€ï¼Œä¸èƒ½é‡å¤</li>
<li>æ”¯æŒå¯é€†ï¼šIDå¯ä»¥ç¼–ç ä¸ºä¸€ä¸ªçœ‹ä¸å‡ºè§„å¾‹çš„ä¸²ï¼Œä¹Ÿå¯ä»¥è§£ç ä¸ºåŸIDï¼Œä¸å½±å“æ•°æ®åº“IDå­—æ®µ</li>
<li>é«˜æ•ˆç”Ÿæˆä¸è§£æï¼šç”Ÿæˆã€éªŒè¯çš„ç®—æ³•å¿…é¡»ä¿è¯æ•ˆç‡ï¼Œä¸èƒ½å ç”¨å¤ªå¤šç³»ç»Ÿèµ„æº</li>
<li>ä¸å¯é¢„æµ‹ä¸å®‰å…¨ï¼šæ— è§„åˆ™æ··æ·†ï¼Œè§„å¾‹æ€§ä¸èƒ½å¾ˆæ˜æ˜¾ï¼Œä¸èƒ½è½»æ˜“è¢«äººçŒœæµ‹åˆ°ï¼Œé˜²æ­¢çˆ†åˆ·</li>
<li>å·¥ç¨‹æˆæœ¬ä½ï¼šä¸æ”¹è¡¨ã€ä¸è¿æ•°æ®</li>
</ul>
<p><strong>å¸¸è§ä½†ä¸å¤Ÿä¼˜é›…çš„è§£å†³æ–¹æ¡ˆ</strong></p>
<ul>
<li>
<p>UUID</p>
<ul>
<li>å­—ç¬¦ä¸²è¿‡é•¿</li>
<li>URLã€äºŒç»´ç ä¸å‹å¥½</li>
<li>è°ƒè¯•ä½“éªŒå·®</li>
</ul>
</li>
<li>
<p>Snowflake / Base64</p>
<ul>
<li>ä»ç„¶å¯èƒ½æš´éœ²æ—¶é—´ä¿¡æ¯</li>
<li>å‰åç«¯å®ç°ä¸ç»Ÿä¸€</li>
</ul>
</li>
<li>
<p>AES / RSA åŠ å¯† ID</p>
<ul>
<li>æ€§èƒ½ä¸å¤æ‚åº¦æˆæœ¬é«˜</li>
<li>å¯¹â€œåªæ˜¯éšè— IDâ€æ¥è¯´å±äºè¿‡åº¦è®¾è®¡</li>
</ul>
</li>
</ul>
<p><strong>è¿™ä¸ªè§£å†³æ–¹æ¡ˆå°±æ˜¯Hashidsã€‚</strong></p>
<p><strong>Hashidsçš„æ ¸å¿ƒåŠŸèƒ½ï¼šæŠŠä¸€ä¸ªæˆ–å¤šä¸ªæ•´æ•°ï¼ˆint / longï¼‰è½¬æ¢æˆä¸€ä¸ªä¸å¯é¢„æµ‹ã€å¯é€†çš„çŸ­å­—ç¬¦ä¸²ã€‚</strong></p>
<p><strong>åŸºæœ¬å±æ€§</strong></p>
<ul>
<li>è¾“å…¥æ˜¯æ•´æ•°ï¼ˆæ”¯æŒlongå‹ï¼‰ï¼Œè¾“å‡ºæ˜¯å­—ç¬¦ä¸²ï¼ˆåªåŒ…å«ï¼ša-z A-Z 0-9ï¼Œæ— å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼‰</li>
<li>å¯ä»¥è‡ªå®šä¹‰ç¼–ç å­—ç¬¦</li>
<li><strong>å¯é€†</strong>ï¼Œä½†ä¸å¯çŒœ</li>
<li>æ”¯æŒå¤šä¸ªIDç¼–ç ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²</li>
<li>å¯æ§åˆ¶æœ€å°é•¿åº¦ï¼Œä¸æ”¯æŒâ€œæœ€é•¿é•¿åº¦â€é™åˆ¶ï¼Œå®é™…é•¿åº¦æ˜¯ä¸å›ºå®šçš„ï¼Œéšè¾“å…¥æ•°å­—å¤§å°å˜åŒ–</li>
</ul>
<p><strong>å…¸å‹ç”¨é€”ï¼š</strong></p>
<ul>
<li>æ•°æ®åº“è‡ªå¢ ID ï¼Œå¯¹å¤–å±•ç¤ºç”¨å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ ID æšä¸¾</li>
<li>çŸ­é“¾æ¥ / é‚€è¯·ç  / å…‘æ¢ç </li>
<li>URL / å°ç¨‹åºå‚æ•°æ›´å‹å¥½</li>
<li>å°†å¤šä¸ªæ•°å­—ï¼ˆæ•°ç»„ï¼‰è¿›è¡Œæ··æ·†ï¼Œé˜²æ­¢å‚æ•°è¢«ç¯¡æ”¹</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong> å®ƒæ˜¯â€œæ··æ·†ï¼ˆobfuscationï¼‰â€ï¼Œä¸æ˜¯â€œåŠ å¯†ï¼ˆencryptionï¼‰â€ï¼Œä¸èƒ½ä½œä¸ºå¯†ç å­¦ç±»çš„åœºæ™¯ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-5"><strong>Hashidså†…éƒ¨åŸç†</strong></h2>
<p>ç¼–ç ï¼ˆencdoeï¼‰æµç¨‹ï¼š</p>
<blockquote>
<p>åŸå§‹æ•°å­— --&gt; æ‰“ä¹±å­—ç¬¦è¡¨ï¼ˆä¾èµ– saltï¼‰ --&gt; é€‰å– guard / separator --&gt; è¿›åˆ¶è½¬æ¢ï¼ˆbase-Nï¼‰ --&gt; æŒ‰è§„åˆ™æ‹¼æ¥ --&gt; è¾“å‡ºå­—ç¬¦ä¸²</p>
</blockquote>
<p><strong>æ ¸å¿ƒç»„æˆå…ƒç´ </strong></p>
<ul>
<li>
<p>æ ¸å¿ƒç»„æˆå…ƒç´ </p>
<ul>
<li>å­—ç¬¦è¡¨ï¼ˆalphabetï¼‰ï¼šæŒ‡å®šé‚£äº›å­—ç¬¦æ˜¯è¾“å‡ºçš„ç»“æœé›†</li>
<li>é»˜è®¤å­—ç¬¦é›†ï¼šabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890</li>
<li>ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼ˆä¾‹å¦‚åªç”¨å¤§å°å†™ + æ•°å­—ï¼Œæ’é™¤ 0/O/I/lï¼‰ï¼Œæ³¨æ„å­—ç¬¦ä¸èƒ½é‡å¤ã€‚</li>
<li>å­—ç¬¦é›†é•¿åº¦ = è¿›åˆ¶ base N</li>
</ul>
</li>
<li>
<p>salt</p>
<ul>
<li>å†³å®šå­—ç¬¦è¡¨å¦‚ä½•è¢«æ´—ç‰Œ</li>
<li>åŒä¸€ä¸ª IDï¼Œåœ¨ä¸åŒ salt ä¸‹ï¼Œç»“æœå®Œå…¨ä¸åŒ</li>
<li>ä¸ä¿å­˜ saltï¼Œå°±æ— æ³•åè§£</li>
</ul>
</li>
<li>
<p>separators &amp; guards</p>
<ul>
<li>Hashids ä¼šä» alphabet ä¸­åˆ†å‡ºä¸¤ç±»ç‰¹æ®Šå­—ç¬¦ï¼šseparatorsï¼Œåˆ†éš”å¤šä¸ªæ•°å­—ã€‚guardsï¼Œæ§åˆ¶æœ€å°é•¿åº¦ã€å¢å¼ºä¸å¯é¢„æµ‹æ€§ã€‚</li>
<li>è¿™ä¸€æ­¥ä¸»è¦æ˜¯ä¸ºäº†ï¼šé¿å…è¾“å‡ºæ¨¡å¼è¿‡äºè§„åˆ™ï¼ŒåŒæ—¶æ”¯æŒç¼–ç å¤šä¸ªæ•°å­—çš„åœºæ™¯ï¼ˆencode(1,2,3)ï¼‰</li>
</ul>
</li>
</ul>
<p><strong>æ€ä¹ˆå®ç°å¯é€†æ€§çš„ï¼Ÿ</strong></p>
<ul>
<li>å­—ç¬¦è¡¨æ´—ç‰Œï¼ˆconsistent shuffleï¼‰</li>
<li>åœ¨ç›¸åŒ alphabet + saltä¸‹ï¼Œç¼–ç åŒä¸€IDï¼Œç»“æœæ°¸è¿œç›¸åŒ</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">from</span> alphabet.length-<span class="hljs-number">1</span> downTo <span class="hljs-number">1</span>:
    j = (salt_char_code + i + previous) % i
    swap(alphabet[i], alphabet[j])
</code></pre>
<p><strong>æ€ä¹ˆè½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„ï¼Ÿ</strong></p>
<ul>
<li>å‡è®¾å­—ç¬¦è¡¨ï¼ˆalphabetï¼‰çš„é•¿åº¦ä¸º62</li>
<li>æ•°å­—å…ˆæ¨¡62ï¼Œå¾—åˆ°çš„ä½™æ•°ä½œä¸ºä¸‹æ ‡ä»å­—ç¬¦è¡¨ä¸­å–å¾—ä¸€ä¸ªå­—ç¬¦</li>
<li>å†é™¤62ï¼Œç›´åˆ°æ•°å­—å°äº0æ—¶åœæ­¢</li>
<li>å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²</li>
</ul>
<p><strong>å¦‚ä½•æ”¯æŒåŒæ—¶ç¼–ç å¤šä¸ªæ•°å­—ï¼Ÿ</strong></p>
<p>ä¾‹å¦‚ï¼šencode(1, 2, 3)</p>
<blockquote>
<p>1 â†’ abc<br/>
2 â†’ k9<br/>
3 â†’ z</p>
</blockquote>
<p>ä¸­é—´ç”¨ separatorï¼ˆä¹Ÿæ˜¯æ¥è‡ª alphabetï¼Œä½†ç»è¿‡ä¸“é—¨ç­›é€‰ï¼‰éš”å¼€ï¼Œæœ€ç»ˆè¾“å‡ºï¼šabcXk9Yz</p>
<p><strong>æ€ä¹ˆä¿è¯æœ€å°é•¿åº¦ï¼Ÿ</strong></p>
<ul>
<li>åœ¨å¤´å°¾æ’å…¥ guard</li>
<li>å†æ¬¡æ´—ç‰Œ alphabet</li>
<li>é‡å¤ç›´åˆ°æ»¡è¶³é•¿åº¦ï¼Œè¿™ä¸€æ­¥æ˜¯ä¼ªéšæœºå¡«å……ï¼Œä¸å½±å“ decodeã€‚</li>
</ul>
<p><strong>decodeçš„å·¥ä½œæµç¨‹ï¼Ÿ</strong></p>
<ul>
<li>å»æ‰ guards</li>
<li>ç”¨ separators åˆ‡åˆ†</li>
<li>å¤åŸ alphabet æ´—ç‰Œ</li>
<li>æ¯ä¸€æ®µåš base-N â†’ long</li>
</ul>
<p><strong>decodeå¤±è´¥æ€ä¹ˆå¤„ç†ï¼Ÿ</strong></p>
<ul>
<li>salt ä¸ä¸€è‡´ â†’ decode å¤±è´¥æˆ–å¾—åˆ°é”™è¯¯å€¼</li>
<li>alphabet ä¸ä¸€è‡´ â†’ decode å¤±è´¥</li>
</ul>
<h2 data-id="heading-6">ä»£ç å®ç°</h2>
<p>ç»ˆäºåˆ°äº†æ¿€åŠ¨äººå¿ƒçš„ä»£ç å®ç°ç¯èŠ‚ï¼Œæ’¸èµ·è¢–å­ï¼Œæ•²é”®ç›˜ã€‚</p>
<p>åœ¨pomä¸­å¯¼å…¥ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hashids<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hashids<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">ç®€å•ç”¨æ³•</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hashids.Hashids;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-keyword">import</span> java.util.Arrays;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HashidsService</span> {

    <span class="hljs-comment">//Beanå•ä¾‹ï¼Œä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Hashids</span> <span class="hljs-variable">hashids</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hashids</span>();

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encode</span><span class="hljs-params">(<span class="hljs-type">int</span> code)</span> {
        <span class="hljs-keyword">return</span> hashids.encode(code);
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encode</span><span class="hljs-params">(<span class="hljs-type">long</span> code)</span> {
        <span class="hljs-keyword">return</span> hashids.encode(code);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(String decoded)</span> {
        <span class="hljs-type">long</span>[] decodes = hashids.decode(decoded);
        <span class="hljs-keyword">if</span> (decodes.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"éæ³•ID"</span>);
        }
        <span class="hljs-keyword">return</span> decodes[<span class="hljs-number">0</span>];
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeArr</span><span class="hljs-params">(<span class="hljs-type">int</span>[] codes)</span> {
        <span class="hljs-type">long</span>[] codeArr = Arrays.stream(codes).asLongStream().toArray();
        <span class="hljs-keyword">return</span> hashids.encode(codeArr);
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeArr</span><span class="hljs-params">(<span class="hljs-type">long</span>[] codes)</span> {
        <span class="hljs-keyword">return</span> hashids.encode(codes);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span>[] decodeArr(String decoded) {
        <span class="hljs-type">long</span>[] decodes = hashids.decode(decoded);
        <span class="hljs-keyword">if</span> (decodes.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"éæ³•ID"</span>);
        }
        <span class="hljs-keyword">return</span> decodes;
    }

}
</code></pre>
<h3 data-id="heading-8">åŠ ç›</h3>
<p>åŠ ç›æ··æ·†</p>
<ul>
<li>é˜²æ­¢åˆ«äººç”¨åŒæ ·åº“è§£ä½  ID</li>
<li>salt ä¸€æ—¦ä¸Šçº¿ ç»å¯¹ä¸èƒ½æ”¹</li>
</ul>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">hashids:</span>
  <span class="hljs-attr">salt:</span> <span class="hljs-string">kjsdfiaosudkskldjfa</span> <span class="hljs-comment">#æ··æ·†ç”¨çš„ç›</span>
  <span class="hljs-attr">min-length:</span> <span class="hljs-number">8</span> <span class="hljs-comment">#æœ€å°é•¿åº¦</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.ks.demo.uc.hashids;

<span class="hljs-keyword">import</span> org.hashids.Hashids;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-keyword">import</span> javax.annotation.PostConstruct;
<span class="hljs-keyword">import</span> java.util.Arrays;

<span class="hljs-comment">/**
 * åŠ ç›æ··æ·†
 *
 * saltçš„ä½œç”¨
 * é˜²æ­¢åˆ«äººç”¨åŒæ ·åº“è§£ä½  ID
 * salt ä¸€æ—¦ä¸Šçº¿ ç»å¯¹ä¸èƒ½æ”¹
 */</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HashidsSaltService</span> {
    <span class="hljs-meta">@Value("${hashids.salt}")</span>
    <span class="hljs-keyword">private</span> String salt;
    <span class="hljs-meta">@Value("${hashids.min-length}")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> minLength;

    <span class="hljs-comment">//newåœ¨@Valueæ³¨å…¥ä¹‹å‰</span>
    <span class="hljs-comment">//è§£å†³æ–¹æ¡ˆï¼šåæ„é€ å™¨ï¼Œåœ¨æ„é€ å™¨çš„å…¥å‚ä½¿ç”¨@Valueï¼Œä½¿ç”¨@ConfigurationPropertieså•ç‹¬æ³¨å…¥</span>
    <span class="hljs-comment">//private Hashids hashidsSalt = new Hashids(salt);</span>

    <span class="hljs-keyword">private</span> <span class="hljs-type">Hashids</span> <span class="hljs-variable">hashidsSalt</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">Hashids</span> <span class="hljs-variable">hashidsMinLen</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> {
        hashidsSalt = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hashids</span>(salt);
        hashidsMinLen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hashids</span>(salt, minLength);
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encode</span><span class="hljs-params">(<span class="hljs-type">int</span> code)</span> {
        <span class="hljs-keyword">return</span> hashidsSalt.encode(code);
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encode</span><span class="hljs-params">(<span class="hljs-type">long</span> code)</span> {
        <span class="hljs-keyword">return</span> hashidsSalt.encode(code);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(String decoded)</span> {
        <span class="hljs-type">long</span>[] decodes = hashidsSalt.decode(decoded);
        <span class="hljs-keyword">if</span> (decodes.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"éæ³•ID"</span>);
        }
        <span class="hljs-keyword">return</span> decodes[<span class="hljs-number">0</span>];
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeArr</span><span class="hljs-params">(<span class="hljs-type">int</span>[] codes)</span> {
        <span class="hljs-type">long</span>[] codeArr = Arrays.stream(codes).asLongStream().toArray();
        <span class="hljs-keyword">return</span> hashidsSalt.encode(codeArr);
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeArr</span><span class="hljs-params">(<span class="hljs-type">long</span>[] codes)</span> {
        <span class="hljs-keyword">return</span> hashidsSalt.encode(codes);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span>[] decodeArr(String decoded) {
        <span class="hljs-type">long</span>[] decodes = hashidsSalt.decode(decoded);
        <span class="hljs-keyword">if</span> (decodes.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"éæ³•ID"</span>);
        }
        <span class="hljs-keyword">return</span> decodes;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeMinLen</span><span class="hljs-params">(<span class="hljs-type">int</span> code)</span> {
        <span class="hljs-keyword">return</span> hashidsMinLen.encode(code);
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeMinLen</span><span class="hljs-params">(<span class="hljs-type">long</span> code)</span> {
        <span class="hljs-keyword">return</span> hashidsMinLen.encode(code);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">decodeMinLen</span><span class="hljs-params">(String decoded)</span> {
        <span class="hljs-type">long</span>[] decodes = hashidsMinLen.decode(decoded);
        <span class="hljs-keyword">if</span> (decodes.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"éæ³•ID"</span>);
        }
        <span class="hljs-keyword">return</span> decodes[<span class="hljs-number">0</span>];
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeMinLenArr</span><span class="hljs-params">(<span class="hljs-type">int</span>[] codes)</span> {
        <span class="hljs-type">long</span>[] codeArr = Arrays.stream(codes).asLongStream().toArray();
        <span class="hljs-keyword">return</span> hashidsMinLen.encode(codeArr);
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeMinLenArr</span><span class="hljs-params">(<span class="hljs-type">long</span>[] codes)</span> {
        <span class="hljs-keyword">return</span> hashidsMinLen.encode(codes);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span>[] decodeMinLenArr(String decoded) {
        <span class="hljs-type">long</span>[] decodes = hashidsMinLen.decode(decoded);
        <span class="hljs-keyword">if</span> (decodes.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"éæ³•ID"</span>);
        }
        <span class="hljs-keyword">return</span> decodes;
    }
}
</code></pre>
<h3 data-id="heading-9">è‡ªå®šä¹‰å‚ä¸ç¼–ç çš„å­—ç¬¦</h3>
<p><strong>å­—ç¬¦é›†è§„åˆ™ï¼š</strong></p>
<ul>
<li>è‡³å°‘ 16 ä¸ªå­—ç¬¦</li>
<li>ä¸å…è®¸é‡å¤å­—ç¬¦</li>
</ul>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">hashids:</span>
  <span class="hljs-attr">salt:</span> <span class="hljs-string">kjsdfiaosudkskldjfa</span> <span class="hljs-comment">#æ··æ·†ç”¨çš„ç›</span>
  <span class="hljs-attr">min-length:</span> <span class="hljs-number">8</span> <span class="hljs-comment">#æœ€å°é•¿åº¦</span>
  <span class="hljs-comment">#è‡³å°‘ 16 ä¸ªå­—ç¬¦ï¼Œä¸å…è®¸é‡å¤å­—ç¬¦</span>
  <span class="hljs-comment">#å‚ä¸ç¼–ç çš„å­—ç¬¦ï¼Œå¯ä»¥å‰”é™¤è°ƒ0/O/o,1/I/lç­‰å­—ç¬¦ï¼Œå¢å¼ºå¯è¯»æ€§</span>
  <span class="hljs-attr">base-char:</span> <span class="hljs-string">0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.ks.demo.uc.hashids;

<span class="hljs-keyword">import</span> org.hashids.Hashids;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-keyword">import</span> javax.annotation.PostConstruct;
<span class="hljs-keyword">import</span> java.util.Arrays;

<span class="hljs-comment">/**
 * è‡ªå®šä¹‰å‚ä¸ç¼–ç çš„å­—ç¬¦
 *
 * å­—ç¬¦é›†è§„åˆ™ï¼š
 * è‡³å°‘ 16 ä¸ªå­—ç¬¦
 * ä¸å…è®¸é‡å¤å­—ç¬¦
 *
 * ä½¿ç”¨åœºæ™¯
 * é¿å… 0/Oã€l/1 æ··æ·†
 * åªå…è®¸å¤§å†™å­—æ¯
 *
 */</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HashidsBaseCharService</span> {
    <span class="hljs-meta">@Value("${hashids.salt}")</span>
    <span class="hljs-keyword">private</span> String salt;
    <span class="hljs-meta">@Value("${hashids.min-length}")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> minLength;
    <span class="hljs-meta">@Value("${hashids.base-char}")</span>
    <span class="hljs-keyword">private</span> String baseChar;

    <span class="hljs-keyword">private</span> <span class="hljs-type">Hashids</span> <span class="hljs-variable">hashids</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> {
        hashids = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hashids</span>(salt, minLength, baseChar);
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encode</span><span class="hljs-params">(<span class="hljs-type">int</span> code)</span> {
        <span class="hljs-keyword">return</span> hashids.encode(code);
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encode</span><span class="hljs-params">(<span class="hljs-type">long</span> code)</span> {
        <span class="hljs-keyword">return</span> hashids.encode(code);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">decode</span><span class="hljs-params">(String decoded)</span> {
        <span class="hljs-type">long</span>[] decodes = hashids.decode(decoded);
        <span class="hljs-keyword">if</span> (decodes.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"éæ³•ID"</span>);
        }
        <span class="hljs-keyword">return</span> decodes[<span class="hljs-number">0</span>];
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeArr</span><span class="hljs-params">(<span class="hljs-type">int</span>[] codes)</span> {
        <span class="hljs-type">long</span>[] codeArr = Arrays.stream(codes).asLongStream().toArray();
        <span class="hljs-keyword">return</span> hashids.encode(codeArr);
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">encodeArr</span><span class="hljs-params">(<span class="hljs-type">long</span>[] codes)</span> {
        <span class="hljs-keyword">return</span> hashids.encode(codes);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span>[] decodeArr(String decoded) {
        <span class="hljs-type">long</span>[] decodes = hashids.decode(decoded);
        <span class="hljs-keyword">if</span> (decodes.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"éæ³•ID"</span>);
        }
        <span class="hljs-keyword">return</span> decodes;
    }

}
</code></pre>
<h2 data-id="heading-10">ç»“å°¾</h2>
<p>åœ¨æ–‡ç« æœ€åï¼Œå°è¯•å¯¹è‡ªå·±æé—®ä¸€ä¸‹é—®é¢˜ï¼Œæ¥æ£€éªŒä½ æ˜¯å¦çœŸæ­£äº†è§£åˆ°äº†æœ¬æ–‡çš„æ ¸å¿ƒå†…å®¹ã€‚</p>
<ol>
<li>C ç«¯è‡ªå¢ ID æš´éœ²ä¼šæœ‰é‚£äº›é—®é¢˜ï¼Ÿ</li>
<li>hashidsçš„æ ¸å¿ƒç‰¹æ€§ï¼Ÿä¸ºä»€ä¹ˆå¯ä»¥ä½œä¸ºæ··æ·†è‡ªå¢idçš„è§£å†³æ–¹æ¡ˆï¼Ÿ</li>
<li>hashidsçš„åŠŸèƒ½æœ‰é‚£äº›ï¼Ÿ</li>
<li>ä»£ç æ€ä¹ˆå†™ï¼Ÿ</li>
</ol>
<p>æœ¬æ–‡ç»“æŸã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥ è®© Claude ç›´æ¥è¯»å†™ä½ çš„è¯­é›€çŸ¥è¯†åº“ï¼è¿™æ¬¾å¼€æºå·¥å…·å¤ªé¦™äº†]]></title>    <link>https://juejin.cn/post/7602901565033742382</link>    <guid>https://juejin.cn/post/7602901565033742382</guid>    <pubDate>2026-02-04T13:28:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901565033742382" data-draft-id="7602910573403783206" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥ è®© Claude ç›´æ¥è¯»å†™ä½ çš„è¯­é›€çŸ¥è¯†åº“ï¼è¿™æ¬¾å¼€æºå·¥å…·å¤ªé¦™äº†"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-04T13:28:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é•‡cxy"/> <meta itemprop="url" content="https://juejin.cn/user/3318776686718483"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥ è®© Claude ç›´æ¥è¯»å†™ä½ çš„è¯­é›€çŸ¥è¯†åº“ï¼è¿™æ¬¾å¼€æºå·¥å…·å¤ªé¦™äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3318776686718483/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é•‡cxy
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T13:28:32.000Z" title="Wed Feb 04 2026 13:28:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ”¥ è®© Claude ç›´æ¥è¯»å†™ä½ çš„è¯­é›€çŸ¥è¯†åº“ï¼è¿™æ¬¾å¼€æºå·¥å…·å¤ªé¦™äº†</h2>
<h3 data-id="heading-1">AIæ—¶ä»£çš„çŸ¥è¯†ç®¡ç†å›°å¢ƒ</h3>
<p>ä½ æ˜¯å¦ä¹Ÿæ›¾é‡åˆ°è¿‡è¿™æ ·çš„åœºæ™¯ï¼š</p>
<ul>
<li>ğŸ’» å†™ä»£ç æ—¶ï¼Œæƒ³æŸ¥é˜…å›¢é˜Ÿçš„æŠ€æœ¯æ–‡æ¡£ï¼Œå´è¦åˆ‡å‡º IDEï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œç™»å½•è¯­é›€ï¼Œæœç´¢å…³é”®è¯...</li>
<li>ğŸ“ è®© AI å¸®ä½ æ•´ç†æ–‡æ¡£ï¼Œç»“æœå®ƒå®Œå…¨ä¸çŸ¥é“ä½ çŸ¥è¯†åº“é‡Œæœ‰å“ªäº›å†…å®¹</li>
<li>ğŸ”„ å›¢é˜ŸçŸ¥è¯†åº“æ²‰æ·€äº†å¤§é‡å¹²è´§ï¼Œå´æ— æ³•ä¸ AI å·¥ä½œæµæ— ç¼é›†æˆ</li>
</ul>
<p><strong>å¦‚æœ Claude èƒ½ç›´æ¥è®¿é—®ä½ çš„è¯­é›€çŸ¥è¯†åº“ï¼Œä¼šæ˜¯ä»€ä¹ˆä½“éªŒï¼Ÿ</strong></p>
<p>ä»Šå¤©ç»™å¤§å®¶ä»‹ç»ä¸€ä¸ªå¼€æºé¡¹ç›® â€”â€” <strong>yuque-mcp</strong>ï¼Œè®©ä½ çš„ Claude Desktop æˆ– Claude Code CLI ä¸è¯­é›€çŸ¥è¯†åº“å®Œç¾èåˆï¼</p>
<hr/>
<h3 data-id="heading-2">ğŸ¯ ä»€ä¹ˆæ˜¯ yuque-mcpï¼Ÿ</h3>
<p><strong>yuque-mcp</strong> æ˜¯ä¸€ä¸ªåŸºäº <strong>Model Context Protocol (MCP)</strong> æ ‡å‡†å¼€å‘çš„æœåŠ¡å™¨ï¼Œæ‰“é€šäº† Claude Desktop ä¸è¯­é›€çŸ¥è¯†åº“ä¹‹é—´çš„å£å’ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼š<strong>å®‰è£…åï¼ŒClaude å°±èƒ½ç›´æ¥æœç´¢ã€è¯»å–ã€åˆ›å»ºã€æ›´æ–°è¯­é›€æ–‡æ¡£äº†ï¼</strong></p>
<hr/>
<h3 data-id="heading-3">âœ¨ æ ¸å¿ƒåŠŸèƒ½ä¸€è§ˆ</h3>
<h4 data-id="heading-4">ğŸ” æ™ºèƒ½æœç´¢ (search)</h4>
<p>ä¸€å¥è¯æ‰¾åˆ°ä½ éœ€è¦çš„æ–‡æ¡£ï¼š</p>
<blockquote>
<p>"å¸®æˆ‘æœç´¢å…³äº TypeScript ç±»å‹ç³»ç»Ÿçš„è¯­é›€æ–‡æ¡£"</p>
</blockquote>
<h4 data-id="heading-5">ğŸ“ ç›®å½•æµè§ˆ (get_toc)</h4>
<p>ä¸€é”®è·å–çŸ¥è¯†åº“å®Œæ•´ç»“æ„ï¼š</p>
<blockquote>
<p>"æŸ¥çœ‹æˆ‘ä»¬å›¢é˜ŸçŸ¥è¯†åº“çš„ç›®å½•ç»“æ„"</p>
</blockquote>
<h4 data-id="heading-6">ğŸ“– å†…å®¹è¯»å– (get_doc)</h4>
<p>ç²¾å‡†è·å–æ–‡æ¡£è¯¦ç»†å†…å®¹ï¼š</p>
<blockquote>
<p>"è·å–æ–‡æ¡£ 123456 çš„å®Œæ•´å†…å®¹"</p>
</blockquote>
<h4 data-id="heading-7">âœï¸ æ–‡æ¡£åˆ›å»º (create_doc)</h4>
<p>AI ç›´æ¥å¸®ä½ å†™æ–‡æ¡£å¹¶å‘å¸ƒåˆ°è¯­é›€ï¼š</p>
<blockquote>
<p>"åˆ›å»ºä¸€ç¯‡éƒ¨ç½²æŒ‡å—ï¼Œå†…å®¹åŒ…æ‹¬ç¯å¢ƒå‡†å¤‡å’Œéƒ¨ç½²æ­¥éª¤"</p>
</blockquote>
<h4 data-id="heading-8">ğŸ“ æ–‡æ¡£æ›´æ–° (update_doc)</h4>
<p>ç›´æ¥ä¿®æ”¹å·²æœ‰æ–‡æ¡£ï¼Œæ— éœ€æ‰‹åŠ¨æ‰“å¼€ç¼–è¾‘å™¨ï¼š</p>
<blockquote>
<p>"æ›´æ–°æ–‡æ¡£ 123456ï¼Œåœ¨æœ«å°¾æ·»åŠ ä»Šå¤©çš„å·¥ä½œæ€»ç»“"</p>
</blockquote>
<hr/>
<h3 data-id="heading-9">ğŸ’¡ çœŸå®ä½¿ç”¨åœºæ™¯</h3>
<h4 data-id="heading-10">åœºæ™¯ä¸€ï¼šä»£ç å¼€å‘æ—¶æŸ¥é˜…æ–‡æ¡£</h4>
<pre><code class="hljs language-css" lang="css">ä½ ï¼šæˆ‘æƒ³ç”¨ React å®ç°ä¸€ä¸ªè¡¨å•éªŒè¯ï¼Œä½†ä¸ç¡®å®šå›¢é˜Ÿçš„æœ€ä½³å®è·µ

Claudeï¼šè®©æˆ‘å…ˆæœç´¢ä¸€ä¸‹ä½ ä»¬è¯­é›€çŸ¥è¯†åº“ä¸­çš„ç›¸å…³æ–‡æ¡£...

<span class="hljs-selector-attr">[å·²æœç´¢åˆ° 3 ç¯‡ç›¸å…³æ–‡æ¡£]</span>
æ ¹æ®ä½ ä»¬å›¢é˜Ÿçš„ã€ŠReact è¡¨å•å¼€å‘è§„èŒƒã€‹ï¼Œæ¨èä½¿ç”¨ react-hook-<span class="hljs-selector-tag">form</span>...

ä½ ï¼šå¤ªæ–¹ä¾¿äº†ï¼ä¸ç”¨åˆ‡å‡ºå»æŸ¥æ–‡æ¡£äº†ï¼
</code></pre>
<h4 data-id="heading-11">åœºæ™¯äºŒï¼šAI è¾…åŠ©æ–‡æ¡£ç¼–å†™</h4>
<pre><code class="hljs language-erlang" lang="erlang">ä½ ï¼šå¸®æˆ‘æŠŠä»Šå¤©çš„ä¼šè®®è®°å½•æ•´ç†æˆæ–‡æ¡£ï¼Œå‘åˆ°è¯­é›€<span class="hljs-string">"é¡¹ç›®çºªè¦"</span>åˆ†ç±»ä¸‹

Claudeï¼šå¥½çš„ï¼Œæˆ‘å…ˆæŸ¥çœ‹ç›®å½•ç»“æ„æ‰¾åˆ°å¯¹åº”åˆ†ç±»...

[å·²è·å–ç›®å½•ç»“æ„]
æ­£åœ¨åˆ›å»ºæ–‡æ¡£ã€Š<span class="hljs-number">2024</span>-<span class="hljs-number">01</span>-<span class="hljs-number">28</span> äº§å“éœ€æ±‚è¯„å®¡ä¼šã€‹...

æ–‡æ¡£å·²åˆ›å»ºå®Œæˆï¼è®¿é—®é“¾æ¥ï¼šhttps://www.yuque.com/...
</code></pre>
<h4 data-id="heading-12">åœºæ™¯ä¸‰ï¼šè¿­ä»£æ›´æ–°æ–‡æ¡£</h4>
<pre><code class="hljs language-erlang" lang="erlang">ä½ ï¼šæŠŠåˆšæ‰è®¨è®ºçš„æ–¹æ¡ˆæ›´æ–°åˆ°ã€ŠæŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£ã€‹é‡Œ

Claudeï¼šå¥½çš„ï¼Œæˆ‘å…ˆè·å–æ–‡æ¡£å½“å‰å†…å®¹...

[å·²è·å–æ–‡æ¡£å†…å®¹]
æ­£åœ¨æ›´æ–°æ–‡æ¡£ï¼Œåœ¨<span class="hljs-string">"æ–¹æ¡ˆå¯¹æ¯”"</span>ç« èŠ‚æ·»åŠ æ–°å†…å®¹...

æ–‡æ¡£å·²æ›´æ–°å®Œæˆï¼æŸ¥çœ‹é“¾æ¥ï¼šhttps://www.yuque.com/...
</code></pre>
<h4 data-id="heading-13">åœºæ™¯å››ï¼šçŸ¥è¯†åº“æ™ºèƒ½é—®ç­”</h4>
<pre><code class="hljs language-erlang" lang="erlang">ä½ ï¼šæˆ‘ä»¬ä¹‹å‰æ˜¯æ€ä¹ˆè§£å†³è·¨åŸŸé—®é¢˜çš„ï¼Ÿ

Claudeï¼šè®©æˆ‘æœç´¢ä¸€ä¸‹...

[æ‰¾åˆ°æ–‡æ¡£ã€Šå‰ç«¯è·¨åŸŸé—®é¢˜è§£å†³æ–¹æ¡ˆã€‹]
æ ¹æ®ä½ ä»¬çš„æŠ€æœ¯æ–‡æ¡£ï¼Œå›¢é˜Ÿé‡‡ç”¨çš„æ˜¯ Nginx åå‘ä»£ç†æ–¹æ¡ˆ...
</code></pre>
<hr/>
<h3 data-id="heading-14">ğŸ› ï¸ æŠ€æœ¯äº®ç‚¹</h3>
<ul>
<li><strong>æ ‡å‡†åŒ–åè®®</strong>ï¼šåŸºäº MCP æ ‡å‡†ï¼Œä¸ Claude Desktop åŸç”Ÿé›†æˆ</li>
<li><strong>åŒæ¨¡å¼æ”¯æŒ</strong>ï¼šåŒæ—¶æ”¯æŒ Claude Desktop å’Œ Claude Code CLI</li>
<li><strong>TypeScript æ‰“é€ </strong>ï¼šç±»å‹å®‰å…¨ï¼Œä»£ç ä¼˜é›…</li>
<li><strong>é›¶ä¾èµ–è´Ÿæ‹…</strong>ï¼šæ ¸å¿ƒä¾èµ–ä»… @modelcontextprotocol/sdk å’Œ zod</li>
<li><strong>å¼€ç®±å³ç”¨</strong>ï¼šç®€å•é…ç½®å³å¯ä½¿ç”¨</li>
</ul>
<hr/>
<h3 data-id="heading-15">ğŸš€ 3åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹</h3>
<h4 data-id="heading-16">1ï¸âƒ£ å®‰è£…é¡¹ç›®</h4>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/wangx-wx/yuque-mcp.git
<span class="hljs-built_in">cd</span> yuque-mcp
npm install
npm run build
</code></pre>
<h4 data-id="heading-17">2ï¸âƒ£ è·å–è¯­é›€ Token</h4>
<p>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.yuque.com%2Fsettings%2Ftokens" target="_blank" title="https://www.yuque.com/settings/tokens" ref="nofollow noopener noreferrer">è¯­é›€ Token ç®¡ç†é¡µé¢</a> åˆ›å»ºä¸ªäºº Tokenï¼Œéœ€è¦å‹¾é€‰ <code>read</code> å’Œ <code>write</code> æƒé™ã€‚</p>
<h4 data-id="heading-18">3ï¸âƒ£ é…ç½®æ–¹å¼ï¼ˆäºŒé€‰ä¸€ï¼‰</h4>
<h5 data-id="heading-19">æ–¹å¼Aï¼šClaude Desktop é…ç½®æ–‡ä»¶</h5>
<p>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆWindows ä¸º <code>%APPDATA%\Claude\claude_desktop_config.json</code>ï¼ŒmacOS ä¸º <code>~/Library/Application Support/Claude/claude_desktop_config.json</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"yuque"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"E:\\node\\yuque-mcp\\dist\\index.js"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"env"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"YUQUE_AUTH_TOKEN"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ çš„è¯­é›€Token"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"YUQUE_BASE_URL"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://www.yuque.com"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"YUQUE_GROUP_LOGIN"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å›¢é˜Ÿè·¯å¾„åï¼ˆå¦‚ leyaoyaoï¼‰"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"YUQUE_BOOK_SLUG"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"çŸ¥è¯†åº“è·¯å¾„ï¼ˆå¦‚ fe-docsï¼‰"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>å¦‚ä½•è·å–å‚æ•°ï¼Ÿ</strong> æ‰“å¼€ä½ çš„è¯­é›€çŸ¥è¯†åº“ï¼ŒURL æ ¼å¼ä¸º <code>https://www.yuque.com/{group_login}/{book_slug}</code>ï¼Œä»ä¸­æå–å³å¯ã€‚</p>
</blockquote>
<h5 data-id="heading-20">æ–¹å¼Bï¼šClaude Code CLI é…ç½®ï¼ˆæ¨èï¼‰</h5>
<p>å¦‚æœä½ ä½¿ç”¨ <strong>Claude Code</strong> å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥é€šè¿‡ CLI å¿«é€Ÿæ·»åŠ ï¼š</p>
<p><strong>macOS / Linuxï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">claude mcp add yuque-mcp \
    --scope project \
    --transport stdio \
    -- node <span class="hljs-string">"/path/to/yuque-mcp/dist/index.js"</span> \
    --<span class="hljs-built_in">env</span> YUQUE_AUTH_TOKEN=your-auth-token-here \
    --<span class="hljs-built_in">env</span> YUQUE_BASE_URL=https://www.yuque.com \
    --<span class="hljs-built_in">env</span> YUQUE_GROUP_LOGIN=your-group-login \
    --<span class="hljs-built_in">env</span> YUQUE_BOOK_SLUG=your-book-slug
</code></pre>
<p><strong>Windows (PowerShell)ï¼š</strong></p>
<pre><code class="hljs language-powershell" lang="powershell">claude mcp add yuque-mcp `
    --scope project `
    --transport stdio `
    -- node "D:/yuque-mcp/dist/index.js" `
    --env YUQUE_AUTH_TOKEN=your-auth-token-here `
    --env YUQUE_BASE_URL=https://www.yuque.com `
    --env YUQUE_GROUP_LOGIN=your-group-login `
    --env YUQUE_BOOK_SLUG=your-book-slug
</code></pre>
<p><strong>CLI é…ç½®ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>æ— éœ€æ‰‹åŠ¨ç¼–è¾‘ JSON æ–‡ä»¶</li>
<li>æ”¯æŒé¡¹ç›®çº§é…ç½®ï¼ˆ<code>--scope project</code>ï¼‰ï¼Œæ¯ä¸ªé¡¹ç›®å¯ç‹¬ç«‹é…ç½®</li>
<li>å¿«é€Ÿåˆ‡æ¢ä¸åŒçŸ¥è¯†åº“ç¯å¢ƒ</li>
</ul>
<h4 data-id="heading-21">4ï¸âƒ£ é‡å¯å¹¶éªŒè¯</h4>
<ul>
<li><strong>Claude Desktop</strong>ï¼šé‡å¯åº”ç”¨åå³å¯ä½¿ç”¨</li>
<li><strong>Claude Code</strong>ï¼šç›´æ¥è¾“å…¥ <code>claude</code> è¿›å…¥å¯¹è¯ï¼Œå·¥å…·ä¼šè‡ªåŠ¨åŠ è½½</li>
</ul>
<p>å¤§åŠŸå‘Šæˆï¼ç°åœ¨å°±å¯ä»¥åœ¨å¯¹è¯ä¸­è®© Claude è®¿é—®ä½ çš„è¯­é›€çŸ¥è¯†åº“äº†ï¼</p>
<hr/>
<h3 data-id="heading-22">ğŸ é¡¹ç›®åœ°å€</h3>
<p><strong>GitHubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwangx-wx%2Fyuque-mcp" target="_blank" title="https://github.com/wangx-wx/yuque-mcp" ref="nofollow noopener noreferrer">github.com/wangx-wx/yuâ€¦</a></strong></p>
<p>â­ <strong>å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç»™ä¸ª Starï¼</strong></p>
<hr/>
<h3 data-id="heading-23">ğŸ“Œ å†™åœ¨æœ€å</h3>
<p>AI çš„æœªæ¥ä¸æ˜¯å–ä»£äººç±»ï¼Œè€Œæ˜¯æˆä¸ºæˆ‘ä»¬æœ€å¾—åŠ›çš„åŠ©æ‰‹ã€‚</p>
<p>å½“ Claude èƒ½å¤Ÿç›´æ¥è®¿é—®ä½ çš„å›¢é˜ŸçŸ¥è¯†åº“ï¼Œå®ƒå°±ä¸å†æ˜¯ä¸€ä¸ªé€šç”¨çš„ AI åŠ©æ‰‹ï¼Œè€Œæ˜¯ä¸€ä¸ªçœŸæ­£æ‡‚ä½ ã€æ‡‚ä½ ä¸šåŠ¡çš„ <strong>AI å›¢é˜Ÿä¼™ä¼´</strong>ã€‚</p>
<p><strong>yuque-mcp</strong> åªæ˜¯å¼€å§‹ï¼ŒæœŸå¾… MCP ç”Ÿæ€å¸¦æ¥æ›´å¤šå¯èƒ½æ€§ï¼</p>
<hr/>
<blockquote>
<p>ğŸ’¬ <strong>ä½ æœ‰ä»€ä¹ˆæœŸå¾…çš„åœºæ™¯æˆ–æƒ³æ³•ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaåå°„æŠ€æœ¯]]></title>    <link>https://juejin.cn/post/7602466689712128015</link>    <guid>https://juejin.cn/post/7602466689712128015</guid>    <pubDate>2026-02-03T14:04:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602466689712128015" data-draft-id="7602472997920620544" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaåå°„æŠ€æœ¯"/> <meta itemprop="keywords" content="Java,åç«¯"/> <meta itemprop="datePublished" content="2026-02-03T14:04:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaåå°„æŠ€æœ¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T14:04:20.000Z" title="Tue Feb 03 2026 14:04:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šåå°„æ˜¯é€šè¿‡å¯¹ç±»çš„å­—èŠ‚ç ï¼ˆ.classï¼‰æ–‡ä»¶è¿›è¡Œè§£æï¼Œå®ç°å¯¹javaBeanå¯¹è±¡æ“ä½œçš„æŠ€æœ¯ã€‚ä½¿ç”¨åå°„çš„å¥½å¤„æ˜¯ï¼Œæ‰€æœ‰çš„javaBeanç»„æˆéƒ½æ˜¯ç›¸åŒçš„ï¼ˆæˆå‘˜å˜é‡ã€æˆå‘˜æ–¹æ³•ã€æ„é€ å™¨ï¼‰ï¼Œé€šè¿‡åå°„è§£æ.classæ–‡ä»¶ï¼Œå¯ä»¥æŠŠå¤šç§ç±»å‹çš„å¯¹è±¡åŒæ—¶è§£æå‡ºæ¥ï¼Œå®ç°ç”¨åŒä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆå¦‚propertiesï¼‰å®ä¾‹åŒ–å¤šä¸ªä¸åŒç±»å‹å¯¹è±¡çš„æ•ˆæœã€‚å¦å¤–ï¼Œåå°„è¿˜å¯ä»¥æ— è§†æƒé™ä¿®é¥°ç¬¦ï¼Œè®¿é—®javaBeanä¸­çš„ä»»æ„æˆå‘˜ã€‚</p>
<p>æ€»ç»“ï¼Œä½¿ç”¨åå°„çš„å¥½å¤„ï¼šï¼ˆ1ï¼‰é€šç”¨ï¼Œåˆ›å»ºä¸åŒçš„å¯¹è±¡å¯ä»¥åŠ¨æ€å˜åŒ–ï¼›ï¼ˆ2ï¼‰ä¸å—æˆå‘˜æƒé™ä¿®é¥°ç¬¦çš„é™åˆ¶
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e39462fc7dbb46c6a0763dccbf037ee8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=2NrR7UWXECi4FzGtuoQCAwqGDlU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸€ã€è·å–Classå¯¹è±¡</h2>
<h3 data-id="heading-1">æ–¹å¼ä¸€ï¼šç±»å.class</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// æ–¹å¼ä¸€ï¼šç±»å.class</span>
	Class&lt;Student&gt; studentClass = Student.class;
	System.out.println(studentClass);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8abc8a6daf70479bbdef39bf6329b52a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=66g0xSR6rtxmIfMwUFwtWzIly%2BI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-2">æ–¹å¼äºŒï¼šstatic Class forName(String fullNameWithPackage)</h3>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒforName()çš„å‚æ•°æ˜¯ç±»çš„å…¨ç±»åï¼›æœ€å‰é¢çš„Classåé¢çš„æ³›å‹å¯å»æ‰</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// æ–¹å¼äºŒï¼šClass forName(String fullNameWithPackage)</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	System.out.println(studentClass);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/241deda8508c4e37998ce96eb4181212~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=IjgBFLmoZUS6w2eqC%2BdZ%2FX7G6zY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1209e35cb74475e86311239e1eecd29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=vUKtcah7ehC0dWfKIRRoL3qk8sY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-3">æ–¹å¼ä¸‰ï¼šnew Object().getClass()</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// æ–¹å¼ä¸‰ï¼šnew Object().getClass()</span>
	Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Student</span>&gt; studentClass = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>().getClass();
	System.out.println(studentClass);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a21f2ff20b14e999563eef6c0baa81e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=hNukVB5IP%2FEaPEeAhXNoipzwzZQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-4">å°ç»“</h3>
<p>è¿™ä¸‰ç§æ–¹å¼è·å–æ–¹å¼ï¼Œ<strong>æ¨èä½¿ç”¨ç¬¬äºŒç§</strong></p>
<p>å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ<strong>è¿™ä¸‰ç§è·å–æ–¹å¼è·å–åˆ°çš„Classå¯¹è±¡ï¼Œéƒ½æ˜¯åŒä¸€ä¸ª</strong>ï¼Œæ¯”è¾ƒä¸‰è€…çš„åœ°å€å€¼ï¼Œéƒ½æ˜¯true</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// æ–¹å¼ä¸€ï¼šç±»å.class</span>
	Class&lt;Student&gt; studentClass1 = Student.class;
	
	<span class="hljs-comment">// æ–¹å¼äºŒï¼šClass forName(String fullNameWithPackage)</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass2</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// æ–¹å¼ä¸‰ï¼šnew Object().getClass()</span>
	Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Student</span>&gt; studentClass3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>().getClass();
	
	System.out.println(studentClass1 == studentClass2);
	System.out.println(studentClass1 == studentClass3);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb6f1b4681354d8ba358a6e8dda62e2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=jcx0WuSgD44ZPq9OdF3ng9OcCRs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-5">äºŒã€é€šè¿‡Classå¯¹è±¡è·å–Constructoræ„é€ å™¨å¯¹è±¡</h2>
<p>è¿™é‡Œä½¿ç”¨åˆ°çš„Studentå¯¹è±¡ç±»ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;
    <span class="hljs-keyword">private</span> String sex;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">()</span> {
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, String sex)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.sex = sex;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age, String sex)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.age = age;
        <span class="hljs-built_in">this</span>.sex = sex;
    }


    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Student{"</span> +
                <span class="hljs-string">"name='"</span> + name + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">", age="</span> + age +
                <span class="hljs-string">", sex='"</span> + sex + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">'}'</span>;
    }
}
</code></pre>
<h3 data-id="heading-6">2.1ã€getConstructors()ï¼šè·å–æ‰€æœ‰å…¬å…±æ„é€ å™¨å¯¹è±¡</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// è·å–å­¦ç”Ÿç±»çš„Classå¯¹è±¡ï¼ˆç”¨ç¬¬äºŒç§è·å–Classå¯¹è±¡çš„æ–¹å¼ï¼‰</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// getConstructors()ï¼šè·å–æ‰€æœ‰å…¬å…±æ„é€ å™¨å¯¹è±¡</span>
	Constructor[] constructors1 = studentClass.getConstructors();
	System.out.println(<span class="hljs-string">"--------------å…¬å…±æ„é€ å™¨å¯¹è±¡å¦‚ä¸‹--------------"</span>);
	<span class="hljs-keyword">for</span> (Constructor constructor : constructors1) {
	    System.out.println(constructor);
	}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1612bbb540b4dbcbcbf67b9a9ce0c4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=idC%2FC%2BMApncYkGflc4LfU35KB4g%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-7">2.2ã€getDeclaredConstructors()ï¼šè·å–æ‰€æœ‰æ„é€ å™¨å¯¹è±¡ï¼ˆå…¬å…±+éå…¬å…±çš„ï¼‰</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// è·å–å­¦ç”Ÿç±»çš„Classå¯¹è±¡ï¼ˆç”¨ç¬¬äºŒç§è·å–Classå¯¹è±¡çš„æ–¹å¼ï¼‰</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// getDeclaredConstructors()ï¼šè·å–æ‰€æœ‰æ„é€ å™¨å¯¹è±¡</span>
	Constructor[] constructors = studentClass.getDeclaredConstructors();
	System.out.println(<span class="hljs-string">"--------------æ‰€æœ‰æ„é€ å™¨å¯¹è±¡ï¼ˆå…¬å…±+éå…¬å…±ï¼‰å¦‚ä¸‹--------------"</span>);
	<span class="hljs-keyword">for</span> (Constructor constructor : constructors) {
	    System.out.println(constructor);
	}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3766ff89541c4fc2894240b081d4bd89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=AvlDHGsIGoJlaBLDKCMEa746OV8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-8">2.3ã€getConstructor(Class&lt;?&gt;... parameterTypes)ï¼šè·å–ä¸€ä¸ªæŒ‡å®šçš„å…¬å…±æ„é€ å™¨å¯¹è±¡</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// è·å–å­¦ç”Ÿç±»çš„Classå¯¹è±¡ï¼ˆç”¨ç¬¬äºŒç§è·å–Classå¯¹è±¡çš„æ–¹å¼ï¼‰</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// getConstructor(Class&lt;?&gt;... parameterTypes)ï¼šè·å–ä¸€ä¸ªæŒ‡å®šçš„å¸¦ä¸¤ä¸ªå‚æ•°çš„å…¬å…±æ„é€ å™¨å¯¹è±¡</span>
	<span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> studentClass.getConstructor(String.class, String.class);
	System.out.println(<span class="hljs-string">"--------------æŒ‡å®šè·å–Studentç±»å¸¦ä¸¤ä¸ªå‚æ•°çš„å…¬å…±æ„é€ å™¨å¯¹è±¡--------------"</span>);
	System.out.println(constructor);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f2553626762475aabb6d0e7fb2dc92b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=s8zNwN%2FM4IUKqDFjxy1lgm1q8%2BI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-9">2.4ã€getDeclaredConstructor(String.class, int.class, String.class)ï¼šè·å–ä¸€ä¸ªæŒ‡å®šçš„ç§æœ‰æ„é€ å™¨å¯¹è±¡</h3>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ–¹å¼å½“ç„¶ä¹Ÿå¯ä»¥è·å–æŒ‡å®šçš„ç§æœ‰æ„é€ å™¨å¯¹è±¡</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// è·å–å­¦ç”Ÿç±»çš„Classå¯¹è±¡ï¼ˆç”¨ç¬¬äºŒç§è·å–Classå¯¹è±¡çš„æ–¹å¼ï¼‰</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// getDeclaredConstructor(Class&lt;?&gt;... parameterTypes)ï¼šè·å–ä¸€ä¸ªæŒ‡å®šçš„å¸¦ä¸‰ä¸ªå‚æ•°çš„ç§æœ‰æ„é€ å™¨å¯¹è±¡</span>
	<span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> studentClass.getDeclaredConstructor(String.class, <span class="hljs-type">int</span>.class, String.class);
	System.out.println(<span class="hljs-string">"--------------æŒ‡å®šè·å–Studentç±»ç§æœ‰çš„å¸¦ä¸‰ä¸ªå‚æ•°çš„æ„é€ å™¨å¯¹è±¡--------------"</span>);
	System.out.println(constructor);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/431251ceacca414f8bfbe854f0ce65a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=5mXKJt%2BiP1ruVSHYB6XKc52fv8A%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-10">ä¸‰ã€é€šè¿‡ç”¨è·å–åˆ°çš„Constructoræ„é€ å™¨ï¼Œå®ä¾‹åŒ–å¯¹è±¡</h2>
<h3 data-id="heading-11">3.1ã€è·å–å…¬å…±æ— å‚æ„é€ ï¼Œå¹¶é€šè¿‡å…¶åˆ›å»ºæ‰€å±ç±»ï¼ˆStudentï¼‰çš„å¯¹è±¡</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„æ„é€ æ–¹æ³•å¯¹è±¡</span>
	<span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> studentClass.getConstructor();
	
	<span class="hljs-comment">// 3.ä½¿ç”¨å½“å‰ç±»ï¼ˆStudentï¼‰çš„constructorå¯¹è±¡çš„newInstanceæ–¹æ³•åˆ›å»ºå½“å‰ç±»ï¼ˆStudentï¼‰</span>
	<span class="hljs-comment">// è¿™é‡Œå°±ç›¸å½“äºä¸ç”¨åå°„æŠ€æœ¯çš„ï¼šnew Student();</span>
	<span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> constructor.newInstance();
	
	<span class="hljs-comment">// æ‰“å°å¯¹è±¡ï¼Œè°ƒç”¨å¯¹è±¡çš„toString()æ–¹æ³•</span>
	System.out.println(o);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95f1bef85a0649b68f7b7d7d2676d605~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=%2FZ8M0H7fFkCFzkeqqtkMLwkvr34%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-12">3.2ã€åå°„è·å–å…¬å…±ä¸€ä¸ªå‚æ•°æ„é€ ï¼Œå¹¶é€šè¿‡å…¶åˆ›å»ºæ‰€å±ç±»(Student)çš„å¯¹è±¡</h3>
<pre><code class="hljs language-java" lang="java">        <span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
        <span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);

        <span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„æ„é€ æ–¹æ³•å¯¹è±¡</span>
        <span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> studentClass.getConstructor(String.class, String.class);

        <span class="hljs-comment">// 3.ä½¿ç”¨å½“å‰ç±»ï¼ˆStudentï¼‰çš„constructorå¯¹è±¡çš„newInstanceæ–¹æ³•åˆ›å»ºå½“å‰ç±»ï¼ˆStudentï¼‰</span>
        <span class="hljs-comment">// è¿™é‡Œå°±ç›¸å½“äºä¸ç”¨åå°„æŠ€æœ¯çš„ï¼šnew Student("å¼ ä¸‰", "ç”·");</span>
        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> constructor.newInstance(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"ç”·"</span>);

        <span class="hljs-comment">// æ‰“å°å¯¹è±¡ï¼Œè°ƒç”¨å¯¹è±¡çš„toString()æ–¹æ³•</span>
        System.out.println(o);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9dc775da72a4213832b9a8f8bb2abc4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=6l4%2B8S46IsPOLpuDcoEIucvXZn8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-13">3.3ã€åå°„è·å–ç§æœ‰å…¨å‚æ„é€ ï¼Œå¹¶é€šè¿‡å…¶åˆ›å»ºæ‰€å±ç±»ï¼ˆStudentï¼‰çš„å¯¹è±¡</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„æ„é€ æ–¹æ³•å¯¹è±¡</span>
	<span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> studentClass.getDeclaredConstructor(String.class, <span class="hljs-type">int</span>.class, String.class);
	
	<span class="hljs-comment">// å¯¹äºç§æœ‰çš„æˆå‘˜ï¼Œæƒ³è¦æ“ä½œï¼Œéœ€è¦å…ˆæš´åŠ›åå°„ã€‚å¦åˆ™ä¼šæŠ¥éæ³•è®¿é—®å¼‚å¸¸ï¼šIllegalAccessException</span>
	constructor.setAccessible(<span class="hljs-literal">true</span>);
	
	<span class="hljs-comment">// 3.ä½¿ç”¨å½“å‰ç±»ï¼ˆStudentï¼‰çš„constructorå¯¹è±¡çš„newInstanceæ–¹æ³•åˆ›å»ºå½“å‰ç±»ï¼ˆStudentï¼‰</span>
	<span class="hljs-comment">// è¿™é‡Œå°±ç›¸å½“äºä¸ç”¨åå°„æŠ€æœ¯çš„ï¼šnew Student("å¼ ä¸‰", "ç”·");</span>
	<span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> constructor.newInstance(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-number">29</span>, <span class="hljs-string">"ç”·"</span>);
	
	<span class="hljs-comment">// æ‰“å°å¯¹è±¡ï¼Œè°ƒç”¨å¯¹è±¡çš„toString()æ–¹æ³•</span>
	System.out.println(o);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa89bbdab729432292b9c1d6d757b7a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=097beSQicsBfD70vvke49ZMtPHg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-14">3.4ã€å¯¹äº3.1 è·å–å…¬å…±æ— å‚æ„é€ ï¼Œå¹¶é€šè¿‡å…¶åˆ›å»ºæ‰€å±ç±»ï¼ˆStudentï¼‰çš„å¯¹è±¡çš„æƒ…å†µï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Classæä¾›çš„æ–¹æ³•</h3>
<p>ä½†ideaåœ¨æ–¹æ³•ä¸Šæœ‰æ¨ªçº¿æç¤ºï¼Œè¿™ç§æ–¹æ³•å·²è¿‡æ—¶ï¼Œä¸æ¨èä½¿ç”¨</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// è·å–å­¦ç”Ÿç±»çš„Classå¯¹è±¡ï¼ˆç”¨ç¬¬äºŒç§è·å–Classå¯¹è±¡çš„æ–¹å¼ï¼‰</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// Classå¯¹è±¡æä¾›äº†ä¾¿æ·åˆ›å»ºæ‰€å±ç±»å¯¹è±¡çš„æ–¹æ³•ï¼šnewInstance()</span>
	<span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> studentClass.newInstance();
	
	<span class="hljs-comment">// æ‰“å°å¯¹è±¡ï¼Œè°ƒç”¨å¯¹è±¡çš„toString()æ–¹æ³•</span>
	System.out.println(o);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84ebc5697e634f3db8e1b38840d0757f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=kzkSfkHIokK%2B42jg5jtlMaQZFF0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-15">å°ç»“</h3>
<p>å¯¹äºç§æœ‰çš„æˆå‘˜ï¼Œæƒ³è¦æ“ä½œï¼Œéœ€è¦å…ˆæš´åŠ›åå°„ã€‚å¦åˆ™ä¼šæŠ¥éæ³•è®¿é—®å¼‚å¸¸ï¼šIllegalAccessException</p>
<h2 data-id="heading-16">å››ã€é€šè¿‡Classå¯¹è±¡è·å–Fieldæˆå‘˜å˜é‡å¯¹è±¡</h2>
<h3 data-id="heading-17">4.1ã€getDeclaredFields()ï¼šè·å–æ‰€æœ‰æˆå‘˜å˜é‡å¯¹è±¡ï¼ˆå…¬å…±+éå…¬å…±ï¼‰</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// getDeclaredFields()ï¼šè·å–æ‰€æœ‰æˆå‘˜å˜é‡å¯¹è±¡ï¼ˆå…¬å…±+éå…¬å…±ï¼‰</span>
	Field[] fields = studentClass.getDeclaredFields();
	
	System.out.println(<span class="hljs-string">"--------------Studentå¯¹è±¡çš„æ‰€æœ‰æˆå‘˜å˜é‡å¯¹è±¡å¦‚ä¸‹--------------"</span>);
	
	<span class="hljs-comment">// éå†æ‰“å°</span>
	<span class="hljs-keyword">for</span> (Field field : fields) {
	    System.out.println(field);
	}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe714c61c04b4ee88dfac5e2ac9510df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=q3GvXNOigyIkMKuucDKL5XFf4NE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-18">4.2ã€getField(String name)ï¼šè·å–æŒ‡å®šçš„å…¬å…±æˆå‘˜å˜é‡å¯¹è±¡</h3>
<p>åšä¸»è¿™é‡Œå…ˆæŠŠStudentç±»ä¸­çš„nameå±æ€§çš„æƒé™ä¿®é¥°ç¬¦è®¾ç½®ä¸ºpublic</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-comment">// å°†nameçš„ä¿®é¥°ç¬¦è®¾ç½®ä¸ºpublic</span>
    <span class="hljs-keyword">public</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;
    <span class="hljs-keyword">private</span> String sex;
</code></pre>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// getField(String name)ï¼šè·å–æŒ‡å®šçš„å…¬å…±æˆå‘˜å˜é‡å¯¹è±¡</span>
	<span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> studentClass.getField(<span class="hljs-string">"name"</span>);
	
	System.out.println(<span class="hljs-string">"--------------Studentå¯¹è±¡æˆå‘˜å˜é‡nameå¯¹è±¡å¦‚ä¸‹--------------"</span>);
	
	System.out.println(name);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e97d5c5c37574951883497ced142c21d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=uPgIY%2Be%2Bvo%2FRydetVgjzcJemdjA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-19">4.3ã€getDeclaredField(String name)ï¼šè·å–æŒ‡å®šçš„ä»»æ„ä¸€ä¸ª(å…¬å…±æˆ–ç§æœ‰ç­‰)æˆå‘˜å˜é‡å¯¹è±¡</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// getDeclaredField(String name)ï¼šè·å–æŒ‡å®šçš„ä»»æ„ä¸€ä¸ª(å…¬å…±æˆ–ç§æœ‰ç­‰)æˆå‘˜å˜é‡å¯¹è±¡</span>
	<span class="hljs-type">Field</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> studentClass.getDeclaredField(<span class="hljs-string">"age"</span>);
	
	System.out.println(<span class="hljs-string">"--------------Studentå¯¹è±¡æˆå‘˜å˜é‡ageå¯¹è±¡å¦‚ä¸‹--------------"</span>);
	
	System.out.println(age);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3332b07821fa4e799ee5559b56860ca0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=wCtDx1Y6lcErWjGiRdSi7TMoR%2Bc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-20">äº”ã€ä½¿ç”¨è·å–åˆ°çš„Fieldå¯¹è±¡ä¸ºæˆå‘˜å˜é‡èµ‹å€¼æˆ–è€…å–å€¼</h2>
<h3 data-id="heading-21">5.1ã€è·å–å…¬å…±çš„æˆå‘˜å˜é‡nameå¹¶ä½¿ç”¨</h3>
<p>éœ€è¦æ³¨æ„ï¼Œåœ¨4.2é‚£é‡Œï¼Œæˆ‘å°†Studentç±»nameå±æ€§æƒé™ä¿®é¥°ç¬¦æ”¹ä¸ºäº†public</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„å±æ€§Fieldå¯¹è±¡</span>
	<span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> studentClass.getField(<span class="hljs-string">"name"</span>);
	
	<span class="hljs-comment">// 3.1 å‡†å¤‡ä¸€ä¸ªå­¦ç”Ÿå¯¹è±¡</span>
	<span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> studentClass.newInstance();
	
	<span class="hljs-comment">// 3.2 ä¸ºæˆå‘˜å˜é‡èµ‹å€¼</span>
	<span class="hljs-comment">// void set(Object æ‰€å±ç±»çš„å¯¹è±¡, Object è¦èµ‹çš„å€¼)</span>
	name.set(o, <span class="hljs-string">"å¼ ä¸‰"</span>);
	
	<span class="hljs-comment">// 3.3 è·å–å¯¹è±¡çš„å€¼</span>
	<span class="hljs-comment">// get(Object object)</span>
	System.out.println(name.get(o));
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80ba8cb1e9d54d84a8aa3f445409a6b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=MR6zjeBeD%2F%2B0J9MzzUMfb9uVprE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-22">5.2ã€è·å–ç§æœ‰çš„æˆå‘˜å˜é‡ageå¹¶ä½¿ç”¨</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„å±æ€§Fieldå¯¹è±¡</span>
	<span class="hljs-type">Field</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> studentClass.getDeclaredField(<span class="hljs-string">"age"</span>);
	
	<span class="hljs-comment">// 3.1 å‡†å¤‡ä¸€ä¸ªå­¦ç”Ÿå¯¹è±¡</span>
	<span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> studentClass.newInstance();
	
	<span class="hljs-comment">// æš´åŠ›åå†™ï¼ˆå› ä¸ºageå±æ€§æƒé™ä¿®é¥°ç¬¦ä¸ºprivateï¼Œæ•…å°‘äº†æ­¤è¡Œä»£ç ï¼Œç¨‹åºä¼šæŠ¥éæ³•è®¿é—®å¼‚å¸¸ï¼šIllegalAccessExceptionï¼‰</span>
	age.setAccessible(<span class="hljs-literal">true</span>);
	
	<span class="hljs-comment">// 3.2 ä¸ºæˆå‘˜å˜é‡èµ‹å€¼</span>
	<span class="hljs-comment">// void set(Object æ‰€å±ç±»çš„å¯¹è±¡, Object è¦èµ‹çš„å€¼)</span>
	age.set(o, <span class="hljs-number">30</span>);
	
	<span class="hljs-comment">// 3.3 è·å–å¯¹è±¡çš„å€¼</span>
	<span class="hljs-comment">// get(Object object)</span>
	System.out.println(age.get(o));
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6ba083c47b3467e8ffba67cf9043dbb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=oxQk1t2T465vRKBiAMyy1Yu1bLM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-23">å°ç»“</h3>
<p>å…¬å…±å’Œç§æœ‰å˜é‡è·å–ä½¿ç”¨çš„åŒºåˆ«æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p>
<p><strong>è·å–æ–¹æ³•ä¸åŒï¼šå…¬å…±å˜é‡è·å–æ–¹æ³•æ˜¯getField()ï¼›ç§æœ‰å˜é‡è·å–æ–¹æ³•æ˜¯getDeclaredField()</strong></p>
<p><strong>è®¿é—®æ–¹å¼ä¸åŒï¼šå…¬å…±å˜é‡è®¿é—®ä¸éœ€è¦æš´åŠ›ç ´è§£ï¼›ç§æœ‰å˜é‡éœ€è¦åŠ ä¸€è¡Œä»£ç ï¼ˆå˜é‡å.setAccessible(true); ï¼‰</strong></p>
<h2 data-id="heading-24">å…­ã€é€šè¿‡Classå¯¹è±¡è·å–Methodæˆå‘˜æ–¹æ³•å¯¹è±¡</h2>
<p>æˆ‘åœ¨Studentç±»ä¸­æ·»åŠ äº†å››ä¸ªæ–¹æ³•ï¼Œä¸¤ä¸ªç§æœ‰ï¼Œä¸¤ä¸ªå…¬å¼€</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> {
    <span class="hljs-comment">// å°†nameçš„ä¿®é¥°ç¬¦è®¾ç½®ä¸ºpublic</span>
    <span class="hljs-keyword">public</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;
    <span class="hljs-keyword">private</span> String sex;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">()</span> {
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, String sex)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.sex = sex;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age, String sex)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.age = age;
        <span class="hljs-built_in">this</span>.sex = sex;
    }

    <span class="hljs-comment">// æ·»åŠ ä»¥ä¸‹å››ä¸ªæ–¹æ³•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">()</span>{
        System.out.println(<span class="hljs-string">"add......."</span>);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>{
        System.out.println(<span class="hljs-string">"delete......."</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">()</span>{
        System.out.println(<span class="hljs-string">"update......."</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>{
        System.out.println(<span class="hljs-string">"find......."</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Student{"</span> +
                <span class="hljs-string">"name='"</span> + name + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">", age="</span> + age +
                <span class="hljs-string">", sex='"</span> + sex + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">'}'</span>;
    }
}
</code></pre>
<h3 data-id="heading-25">6.1ã€getMethods() è·å–æ‰€æœ‰å…¬å…±çš„æˆå‘˜æ–¹æ³•</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„æŸä¸ªæ–¹æ³•å¯¹è±¡</span>
	Method[] methods = studentClass.getMethods();
	
	System.out.println(<span class="hljs-string">"--------------Studentå¯¹è±¡çš„æ‰€æœ‰å…¬å…±çš„æˆå‘˜æ–¹æ³•å¯¹è±¡å¦‚ä¸‹--------------"</span>);
	<span class="hljs-keyword">for</span> (Method method : methods) {
	    System.out.println(method);
	}
</code></pre>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡ŒåŒ…æ‹¬äº†ç»§æ‰¿è‡ªObjectç±»çš„ä¸€äº›å…¬å…±æ–¹æ³•</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1aa4e04cde249b2b9ede7e412297c14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=UewiA9OtmLdsoEKeKjwMXwHhP1U%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-26">6.2ã€getDeclaredMethods() è·å–æ‰€æœ‰çš„æˆå‘˜æ–¹æ³•</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„æŸä¸ªæ–¹æ³•å¯¹è±¡</span>
	Method[] methods = studentClass.getDeclaredMethods();
	
	System.out.println(<span class="hljs-string">"--------------Studentå¯¹è±¡çš„æ‰€æœ‰æˆå‘˜æ–¹æ³•å¯¹è±¡å¦‚ä¸‹--------------"</span>);
	<span class="hljs-keyword">for</span> (Method method : methods) {
	    System.out.println(method);
	}
</code></pre>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä¸åŒ…å«ç»§æ‰¿è‡ªObjectç±»çš„æ–¹æ³•ï¼Œæ˜¯Studentç±»ä¸­çš„æ‰€æœ‰æˆå‘˜æ–¹æ³•ï¼ˆå«ç§æœ‰çš„ï¼‰</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d0e9900fac641e9805e2ab2616772cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=F5ZItnCeVNPu3zSob6KIPLaLRnc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-27">6.3ã€getMethod(String methodName, Class... args) è·å–æŒ‡å®šçš„æŸä¸ªå…¬å…±çš„æˆå‘˜æ–¹æ³•</h3>
<p>å€¼å¾—ä¸€æï¼Œæ²¡æœ‰å‚æ•°çš„æ–¹æ³•å¯ä»¥è·å–ï¼ŒgetMethod()æ–¹æ³•çš„å‚æ•°äºŒç©ºç€å°±è¡Œ</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„æŸä¸ªæ–¹æ³•å¯¹è±¡</span>
	<span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> studentClass.getMethod(<span class="hljs-string">"find"</span>, <span class="hljs-type">int</span>.class);
	
	System.out.println(<span class="hljs-string">"--------------Studentå¯¹è±¡çš„æŒ‡å®šåç§°å’Œå‚æ•°çš„å…¬å…±çš„æ–¹æ³•å¯¹è±¡å¦‚ä¸‹--------------"</span>);
	System.out.println(method);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5102f80cfde467c9a0026664f1c9ea3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=Jf4oD%2Bfzzejr4A%2F94eOPeTE8PAs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-28">6.4ã€getDeclaredMethod(String methodName, Class... args)ï¼šè·å–æŒ‡å®šçš„æŸä¸ªç§æœ‰çš„æˆå‘˜æ–¹æ³•</h3>
<p>å½“ç„¶ï¼Œè¿™ç§æ–¹å¼ä¹Ÿå¯è·å–åˆ°éç§æœ‰æ–¹æ³•å¯¹è±¡</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„æŸä¸ªæ–¹æ³•å¯¹è±¡</span>
	<span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> studentClass.getDeclaredMethod(<span class="hljs-string">"delete"</span>, <span class="hljs-type">int</span>.class);
	
	System.out.println(<span class="hljs-string">"--------------Studentå¯¹è±¡çš„æŒ‡å®šåç§°å’Œå‚æ•°çš„ç§æœ‰çš„æ–¹æ³•å¯¹è±¡å¦‚ä¸‹--------------"</span>);
	System.out.println(method);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e474b2b67cd145a28b07fec90e802bd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=RBZI5YyEK1TqTdKCmZ8aYR6rkgs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-29">å°ç»“</h3>
<p>getMethods()ï¼šè·å–æ‰€æœ‰å…¬å…±çš„æˆå‘˜æ–¹æ³•ï¼Œ<strong>åŒ…å«äº†ç»§æ‰¿è‡ªObjectç±»çš„æ–¹æ³•</strong></p>
<p>getDeclaredMethods()ï¼šè·å–æ‰€æœ‰çš„æˆå‘˜æ–¹æ³•ï¼Œ<strong>ä¸åŒ…å«ç»§æ‰¿è‡ªObjcetç±»çš„æ–¹æ³•ï¼Œæ˜¯ç±»çš„æˆå‘˜æ–¹æ³•ï¼ˆç§æœ‰+å…¬å…±çš„ï¼‰</strong></p>
<p>getMethod(String methodName, Class... args)ï¼šè·å–æŒ‡å®šçš„æŸä¸ªå…¬å…±çš„æˆå‘˜æ–¹æ³•ï¼Œ<strong>åªèƒ½æ˜¯å…¬å…±çš„</strong></p>
<p>getDeclaredMethod(String methodName, Class... args)ï¼šè·å–æŒ‡å®šçš„æŸä¸ªç§æœ‰çš„æˆå‘˜æ–¹æ³•ï¼Œ<strong>ç§æœ‰&amp;å…¬å…±éƒ½å¯ä»¥</strong></p>
<h2 data-id="heading-30">ä¸ƒã€ä½¿ç”¨è·å–åˆ°çš„Methodå¯¹è±¡åå°„è°ƒç”¨æˆå‘˜æ–¹æ³•</h2>
<p>ä½¿ç”¨invoke()æ–¹æ³•è°ƒç”¨æˆå‘˜æ–¹æ³•ï¼Œéœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š
ï¼ˆ1ï¼‰<strong>ç§æœ‰æˆå‘˜ï¼Œä½¿ç”¨å‰éœ€è¦æš´åŠ›ç ´è§£</strong>ï¼Œå¦åˆ™ä¼šæŠ¥éæ³•è®¿é—®å¼‚å¸¸ï¼šIllegalAccessExceptionï¼›
ï¼ˆ2ï¼‰<strong>åå°„è°ƒç”¨æˆå‘˜æ–¹æ³•å‰ï¼Œéœ€è¦å…ˆå‡†å¤‡ä¸€ä¸ªå½“å‰ç±»çš„å¯¹è±¡</strong></p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// 1.è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡</span>
	<span class="hljs-type">Class</span> <span class="hljs-variable">studentClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"com.essay.Student"</span>);
	
	<span class="hljs-comment">// 2.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„Classå¯¹è±¡è·å–å½“å‰ç±»ï¼ˆStudentï¼‰çš„æŸä¸ªæ–¹æ³•å¯¹è±¡</span>
	<span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> studentClass.getDeclaredMethod(<span class="hljs-string">"delete"</span>, <span class="hljs-type">int</span>.class);
	
	<span class="hljs-comment">// 3.é€šè¿‡å½“å‰ç±»ï¼ˆStudentï¼‰çš„æ–¹æ³•Methodå¯¹è±¡çš„invokeæ–¹æ³•è°ƒç”¨æ–¹æ³•</span>
	
	<span class="hljs-comment">// ç§æœ‰æˆå‘˜ï¼Œä½¿ç”¨å‰éœ€è¦æš´åŠ›åå°„ï¼Œå¦åˆ™æŠ¥é”™éæ³•è®¿é—®å¼‚å¸¸ï¼šIllegalAccessException</span>
	method.setAccessible(<span class="hljs-literal">true</span>);
	
	<span class="hljs-comment">// 3.1 å‡†å¤‡ä¸€ä¸ªå½“å‰ç±»ï¼ˆStudentï¼‰çš„å¯¹è±¡</span>
	<span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> studentClass.newInstance();
	
	<span class="hljs-comment">// 3.2 åå°„è°ƒç”¨æˆå‘˜æ–¹æ³•</span>
	method.invoke(o, <span class="hljs-number">10</span>);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa14c0bc50cf4feb82c1c4392b76c0c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=o3dPqSV78QtSUCPHG8WOW5nwfLU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-31">æ€»ç»“</h2>
<p>ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šæœ‰è®¸å¤šè¿è¡Œæ—¶å¼‚å¸¸ï¼Œéœ€è¦æŠ›å‡ºï¼Œå»ºè®®åœ¨æ–¹æ³•ä¸Šç›´æ¥æŠ›å‡º Exception
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d78f18aeacf34191becda96a843f8998~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770819727&amp;x-signature=G%2FBbmITBaUKe6D30A3oceVXvMxg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-32">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F130801657" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/130801657" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[finally ä¸­ä»£ç ä¸€å®šä¼šè¢«æ‰§è¡Œå—ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7602901565025206281</link>    <guid>https://juejin.cn/post/7602901565025206281</guid>    <pubDate>2026-02-04T15:00:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901565025206281" data-draft-id="7602850166731128841" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="finally ä¸­ä»£ç ä¸€å®šä¼šè¢«æ‰§è¡Œå—ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-04T15:00:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Vin_evail"/> <meta itemprop="url" content="https://juejin.cn/user/3974048659038618"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            finally ä¸­ä»£ç ä¸€å®šä¼šè¢«æ‰§è¡Œå—ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3974048659038618/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Vin_evail
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T15:00:32.000Z" title="Wed Feb 04 2026 15:00:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">finally ä¸­ä»£ç ä¸€å®šä¼šè¢«æ‰§è¡Œå—ï¼Ÿ</h2>
<p>2026å¹´02æœˆ04æ—¥</p>
<p>é¢è¯•å®˜æå‡ºè¿™ä¸ªé—®é¢˜ï¼Œé€šå¸¸æ„åœ¨è€ƒå¯Ÿä»¥ä¸‹å‡ ä¸ªå±‚é¢çš„ç†è§£ï¼š</p>
<ol>
<li><strong>å¯¹ Java å¼‚å¸¸å¤„ç†æœºåˆ¶åŸºç¡€çŸ¥è¯†çš„æŒæ¡</strong>ï¼šå³Â <code>finally</code>Â å—çš„åŸºæœ¬è¯­ä¹‰å’Œä¿è¯æ‰§è¡Œçš„æ‰¿è¯ºã€‚</li>
<li><strong>å¯¹ JVM æ‰§è¡Œæµç¨‹å’Œç¨‹åºçŠ¶æ€ç†è§£çš„æ·±åº¦</strong>ï¼šé¢è¯•å®˜ä¸ä»…ä»…æƒ³çŸ¥é“ â€œæ˜¯â€ æˆ– â€œå¦â€ï¼Œæ›´æƒ³çŸ¥é“<strong>åœ¨ä½•ç§æç«¯æˆ–ç‰¹å®šæƒ…å†µä¸‹ï¼Œ<code>finally</code>Â å—ä¼š â€œå¤±çº¦â€</strong> ï¼Œè¿™èƒ½åæ˜ å‡ºå€™é€‰äººæ˜¯å¦çœŸæ­£ç†è§£ç¨‹åºæ‰§è¡Œçš„åº•å±‚é€»è¾‘ã€‚</li>
<li><strong>å¯¹ç³»ç»Ÿçº§äº¤äº’å’Œèµ„æºç®¡ç†çš„è®¤çŸ¥</strong>ï¼šä¾‹å¦‚ï¼Œç†è§£Â <code>System.exit()</code>Â æˆ–å®ˆæŠ¤çº¿ç¨‹ç­‰è¡Œä¸ºå¦‚ä½•å½±å“ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™ä¸ç¼–å†™å¥å£®çš„ã€å°¤å…¶æ˜¯æ¶‰åŠèµ„æºæ¸…ç†çš„ä»£ç ç´§å¯†ç›¸å…³ã€‚</li>
<li><strong>å®é™…ç¼–ç¨‹ä¸­çš„ä¸¥è°¨æ€§</strong>ï¼šæ˜¯å¦äº†è§£åœ¨Â <code>finally</code>Â å—ä¸­å†™ä»£ç çš„â€œæœ€ä½³å®è·µâ€å’Œâ€œå¸¸è§é™·é˜±â€ï¼Œé¿å…å› è®¤çŸ¥ç›²åŒºå¼•å…¥ç”Ÿäº§ bugã€‚</li>
</ol>
<h3 data-id="heading-1">æ ¸å¿ƒç­”æ¡ˆ</h3>
<p>ä¸ï¼Œ<code>finally</code>Â ä¸­çš„ä»£ç <strong>ä¸ä¸€å®šä¼šè¢«æ‰§è¡Œ</strong>ã€‚è™½ç„¶å®ƒåœ¨ç»å¤§å¤šæ•°æ­£å¸¸æƒ…å†µä¸‹éƒ½ä¼šæ‰§è¡Œï¼Œä½†åœ¨ä»¥ä¸‹å‡ ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œ<code>finally</code>Â å—å°†ä¸ä¼šè¢«æ‰§è¡Œï¼š</p>
<ol>
<li><strong>åœ¨Â <code>try</code>Â æˆ–Â <code>catch</code>Â å—ä¸­è°ƒç”¨äº†Â <code>System.exit(int)</code>Â ç»ˆæ­¢äº† JVMã€‚</strong></li>
<li>ç¨‹åºæ‰€åœ¨çš„<strong>çº¿ç¨‹åœ¨è¿›å…¥Â <code>finally</code>Â ä¹‹å‰è¢«æ„å¤–ç»ˆæ­¢</strong>ï¼ˆä¾‹å¦‚ï¼Œè°ƒç”¨äº†Â <code>Thread.stop()</code>Â æ–¹æ³•ï¼Œä½†æ­¤æ–¹æ³•å·²è¢«åºŸå¼ƒä¸”æå…¶å±é™©ï¼‰ã€‚</li>
<li><strong>å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰</strong> Â ä¸­ï¼Œå½“æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹ç»“æŸæ—¶ï¼ŒJVM ä¼šç«‹å³é€€å‡ºï¼Œæ­¤æ—¶å®ˆæŠ¤çº¿ç¨‹ä¸­çš„Â <code>finally</code>Â å—å¯èƒ½æ¥ä¸åŠæ‰§è¡Œã€‚</li>
<li>åœ¨Â <code>try</code>Â æˆ–Â <code>catch</code>Â å—ä¸­é‡åˆ°äº†<strong>æ— é™å¾ªç¯</strong>æˆ–<strong>æ­»é”</strong>ï¼Œå¯¼è‡´ç¨‹åºæ— æ³•ç»§ç»­æ‰§è¡Œåˆ°Â <code>finally</code>Â å—ã€‚</li>
<li>ä»æ“ä½œç³»ç»Ÿå±‚é¢<strong>å¼ºåˆ¶æ€æ­»äº† JVM è¿›ç¨‹</strong>ï¼ˆä¾‹å¦‚ï¼Œåœ¨ Linux ä¸­ä½¿ç”¨Â <code>kill -9 pid</code>ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-2">æ·±åº¦è§£æ</h3>
<h4 data-id="heading-3">åŸç†/æœºåˆ¶</h4>
<p><code>finally</code>Â çš„ â€œä¸€å®šæ‰§è¡Œâ€ è¯­ä¹‰æ˜¯ Java ç¼–è¯‘å™¨åœ¨<strong>å­—èŠ‚ç å±‚é¢</strong>æä¾›çš„ä¸€ç§ä¿è¯ã€‚ç¼–è¯‘å™¨ä¼šé€šè¿‡ç”Ÿæˆé¢å¤–çš„å­—èŠ‚ç ï¼Œå°†Â <code>finally</code>Â å—ä¸­çš„é€»è¾‘å¤åˆ¶åˆ°Â <code>try</code>Â å—å’Œæ¯ä¸ªÂ <code>catch</code>Â å—çš„ â€œæ­£å¸¸å‡ºå£â€ å’Œ â€œå¼‚å¸¸å‡ºå£â€ ä¹‹åã€‚ä½ å¯ä»¥å°†å…¶æƒ³è±¡ä¸ºï¼ŒJVM è¯•å›¾åœ¨ç¦»å¼€Â <code>try-catch</code>Â ä½œç”¨åŸŸå‰ï¼Œæ— è®ºå¦‚ä½•éƒ½è¦ â€œç»•è·¯â€ å»æ‰§è¡Œä¸€ä¸‹Â <code>finally</code>Â ä¸­çš„ä»£ç ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ç§ä¿è¯æ˜¯<strong>åœ¨ JVM æ­£å¸¸æ‰§è¡Œæµç¨‹å†…</strong>çš„ã€‚ä¸Šè¿°æåˆ°çš„ä¾‹å¤–æƒ…å†µï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯<strong>å¼ºè¡Œç»ˆæ­¢äº† JVM çš„æ­£å¸¸æ‰§è¡Œæµç¨‹</strong>ï¼Œä½¿å¾—ç¨‹åºå¤±å»äº†ç»§ç»­æ‰§è¡Œä»»ä½•å­—èŠ‚ç ï¼ˆåŒ…æ‹¬å¤åˆ¶çš„Â <code>finally</code>Â ä»£ç ï¼‰çš„æœºä¼šã€‚</p>
<h4 data-id="heading-4">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FinallyNotExecuteDemo</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        case1_SystemExit();
        <span class="hljs-comment">// case2_InfiniteLoop();</span>
    }

    <span class="hljs-comment">// æƒ…å†µ 1ï¼šSystem.exit() å¯¼è‡´ finally ä¸æ‰§è¡Œ</span>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">case1_SystemExit</span>()</span> {
        <span class="hljs-keyword">try</span> {
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"Try block is running."</span>);
            System.exit(<span class="hljs-number">0</span>); <span class="hljs-comment">// JVM åœ¨æ­¤å¤„è¢«å¼ºåˆ¶ç»ˆæ­¢</span>
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// è¿™è¡Œå°†æ°¸è¿œä¸ä¼šè¢«æ‰“å°</span>
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"Finally block is running."</span>);
        }
    }

    <span class="hljs-comment">// æƒ…å†µ 2ï¼šæ— é™å¾ªç¯å¯¼è‡´ finally æ— æ³•åˆ°è¾¾</span>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">case2_InfiniteLoop</span>()</span> {
        <span class="hljs-keyword">try</span> {
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"Try block is running."</span>);
            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) { <span class="hljs-comment">// æ— é™å¾ªç¯ï¼Œç¨‹åºæ— æ³•é€€å‡º try å—</span>
                <span class="hljs-comment">// æ¨¡æ‹Ÿé•¿æ—¶é—´æ“ä½œ</span>
            }
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// ç”±äºæ— æ³•é€€å‡º try å—ï¼Œè¿™è¡ŒåŒæ ·æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œ</span>
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"Finally block is running."</span>);
        }
    }
}
</code></pre>
<h4 data-id="heading-5">æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹</h4>
<ol>
<li>
<p><strong>èµ„æºæ¸…ç†é¦–é€‰Â <code>try-with-resources</code></strong>ï¼šå¯¹äºå®ç°äº†Â <code>AutoCloseable</code>Â æ¥å£çš„èµ„æºï¼ˆå¦‚Â <code>InputStream</code>ã€<code>Connection</code>ï¼‰ï¼ŒJDK 7 å¼•å…¥çš„Â <code>try-with-resources</code>Â è¯­å¥æ˜¯æ¯”Â <code>try-finally</code>Â æ›´ä¼˜é›…ã€æ›´å®‰å…¨çš„æ–¹æ¡ˆã€‚å®ƒèƒ½è‡ªåŠ¨å…³é—­èµ„æºï¼Œå¹¶ä¸”æŠ‘åˆ¶çš„å¼‚å¸¸ä¿¡æ¯æ›´å®Œæ•´ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼˜äº try-finally</span>
<span class="hljs-keyword">try</span> (<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"file.txt"</span>)) {
    <span class="hljs-comment">// ä½¿ç”¨èµ„æº</span>
} <span class="hljs-keyword">catch</span> (IOException e) {
    <span class="hljs-comment">// å¤„ç†å¼‚å¸¸</span>
}
</code></pre>
</li>
<li>
<p><strong>é¿å…åœ¨Â <code>finally</code>Â ä¸­å¼•å…¥å¤æ‚é€»è¾‘æˆ–å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ“ä½œ</strong>ï¼š<code>finally</code>Â å—ä¸­çš„ä»£ç åº”è¯¥åŠ›æ±‚ç®€å•ã€å¯é ã€‚å¦‚æœÂ <code>finally</code>Â å—ä¸­æŠ›å‡ºäº†æ–°çš„å¼‚å¸¸ï¼Œå®ƒä¼š â€œè¦†ç›–â€ æ‰Â <code>try</code>Â æˆ–Â <code>catch</code>Â å—ä¸­æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¯¼è‡´åŸå§‹çš„å¼‚å¸¸ä¿¡æ¯ä¸¢å¤±ï¼Œç»™è°ƒè¯•å¸¦æ¥å·¨å¤§å›°éš¾ã€‚</p>
</li>
<li>
<p><strong>å®ˆæŠ¤çº¿ç¨‹ä¸­çš„èµ„æºç®¡ç†éœ€ç‰¹åˆ«å°å¿ƒ</strong>ï¼šé¿å…åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­è¿›è¡Œé‡è¦çš„ã€å¿…é¡»å®Œæˆçš„èµ„æºæ¸…ç†æˆ–çŠ¶æ€æŒä¹…åŒ–æ“ä½œï¼Œå› ä¸ºå…¶æ‰§è¡Œæ— æ³•å¾—åˆ°ä¿è¯ã€‚</p>
</li>
</ol>
<h4 data-id="heading-6">å¸¸è§è¯¯åŒº</h4>
<ul>
<li>
<p><strong>è¯¯åŒºä¸€ï¼šâ€œ<code>finally</code>Â åœ¨Â <code>return</code>Â ä¹‹åæ‰§è¡Œâ€</strong> ï¼šè¿™æ˜¯ä¸€ç§éå¸¸æ™®éä½†é”™è¯¯çš„è¡¨è¿°ã€‚<strong><code>finally</code>Â å—çš„æ‰§è¡Œåœ¨Â <code>return</code>Â è¯­å¥ä¹‹å‰</strong>ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœÂ <code>try</code>Â æˆ–Â <code>catch</code>Â ä¸­æœ‰Â <code>return</code>ï¼ŒJVM ä¼šå…ˆå°†è¿”å›å€¼å­˜å‚¨åœ¨ä¸€ä¸ªä¸´æ—¶å˜é‡ä¸­ï¼Œç„¶åæ‰§è¡ŒÂ <code>finally</code>Â å—ï¼Œæœ€åå†è¿”å›é‚£ä¸ªä¸´æ—¶å˜é‡ã€‚å³ä½¿Â <code>finally</code>Â ä¸­ä¿®æ”¹äº†è¦è¿”å›çš„å˜é‡ï¼Œå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹å’Œä¸å¯å˜å¯¹è±¡ï¼ˆå¦‚Â <code>String</code>ï¼‰ï¼Œè¿”å›å€¼ä¹Ÿä¸ä¼šæ”¹å˜ï¼ˆä½†å¯¹äºå¯¹è±¡å¼•ç”¨ï¼Œä¿®æ”¹å¯¹è±¡å†…éƒ¨çŠ¶æ€æ˜¯æœ‰æ•ˆçš„ï¼‰ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> <span class="hljs-title">testFinallyReturn</span>()</span> {
    <span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> i; <span class="hljs-comment">// 1. å°† i çš„å€¼ (0) å­˜å…¥ä¸´æ—¶æ§½</span>
    } <span class="hljs-keyword">finally</span> {
        i = <span class="hljs-number">10</span>; <span class="hljs-comment">// 2. ä¿®æ”¹ iï¼Œä½†ä¸å½±å“ä¸´æ—¶æ§½ä¸­çš„å€¼</span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"Finally executed. i = "</span> + i);
        <span class="hljs-comment">// 3. ä»ä¸´æ—¶æ§½ä¸­å–å‡ºå€¼ (0) è¿”å›</span>
    }
}
<span class="hljs-comment">// è¾“å‡ºï¼šFinally executed. i = 10</span>
<span class="hljs-comment">// è¿”å›ï¼š0</span>
</code></pre>
</li>
<li>
<p><strong>è¯¯åŒºäºŒï¼šâ€œ<code>finally</code>Â æ€»èƒ½è¿›è¡Œèµ„æºå›æ”¶â€</strong> ï¼šå¦‚ä¸Šæ‰€è¿°ï¼Œåœ¨Â <code>System.exit()</code>Â æˆ– JVM å´©æºƒç­‰æƒ…å†µä¸‹ï¼Œ<code>finally</code>Â ä¸­çš„Â <code>close()</code>Â æ–¹æ³•ä¹Ÿæ— åŠ›å›å¤©ã€‚è¿™å¼ºè°ƒäº†å…³é”®èµ„æºéœ€è¦æœ‰å¤–éƒ¨ç®¡ç†æˆ–æ›´å¥å£®çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†æœºåˆ¶ã€‚</p>
</li>
</ul>
<h3 data-id="heading-7">æ€»ç»“</h3>
<p><code>finally</code>Â å—ä¸ºä»£ç æä¾›äº†å¼ºå¤§çš„ â€œæœ€åæ¸…ç†â€ ä¿éšœï¼Œä½†å…¶æ‰§è¡Œçš„å‰ææ˜¯Â <strong>JVM èƒ½ç»§ç»­ç»´æŒæ­£å¸¸çš„æ‰§è¡Œæµç¨‹</strong>ï¼›ä»»ä½•å¯¼è‡´ JVM è¿›ç¨‹è¢«ç«‹å³ â€œæ€æ­»â€ æˆ–æ‰§è¡Œæµè¢«æ°¸ä¹… â€œå¡ä½â€ çš„æ“ä½œï¼Œéƒ½ä¼šä½¿è¿™ä»½ä¿éšœå¤±æ•ˆã€‚åœ¨ç°ä»£ Java å¼€å‘ä¸­ï¼Œåº”ä¼˜å…ˆä½¿ç”¨Â <code>try-with-resources</code>Â ç®¡ç†èµ„æºï¼Œå¹¶åœ¨Â <code>finally</code>Â ä¸­ä¿æŒé€»è¾‘ç®€å•ã€å¥å£®ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Bootå®æˆ˜ï¼šç”¨AOP+è‡ªå®šä¹‰æ³¨è§£æ‰“é€ é›¶ä¾µå…¥æ—¥å¿—ç³»ç»Ÿï¼ˆé™„ç”Ÿäº§é¿å‘æŒ‡å—ï¼‰]]></title>    <link>https://juejin.cn/post/7602824293164695567</link>    <guid>https://juejin.cn/post/7602824293164695567</guid>    <pubDate>2026-02-04T14:33:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602824293164695567" data-draft-id="7602581823639486464" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Bootå®æˆ˜ï¼šç”¨AOP+è‡ªå®šä¹‰æ³¨è§£æ‰“é€ é›¶ä¾µå…¥æ—¥å¿—ç³»ç»Ÿï¼ˆé™„ç”Ÿäº§é¿å‘æŒ‡å—ï¼‰"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-02-04T14:33:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸æƒ³æ‰“å·¥çš„ç å†œ"/> <meta itemprop="url" content="https://juejin.cn/user/2172290705931335"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Bootå®æˆ˜ï¼šç”¨AOP+è‡ªå®šä¹‰æ³¨è§£æ‰“é€ é›¶ä¾µå…¥æ—¥å¿—ç³»ç»Ÿï¼ˆé™„ç”Ÿäº§é¿å‘æŒ‡å—ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2172290705931335/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸æƒ³æ‰“å·¥çš„ç å†œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T14:33:11.000Z" title="Wed Feb 04 2026 14:33:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…ï¼šä¸æƒ³æ‰“å·¥çš„ç å†œ<br/>
åŸåˆ›å£°æ˜ï¼šæœ¬æ–‡åŸºäºç¬”è€…åœ¨é‡‘èé¡¹ç›®ä¸­çš„çœŸå®å®è·µï¼Œæ‰€æœ‰ä»£ç ç»ç”Ÿäº§ç¯å¢ƒéªŒè¯ï¼Œæ‹’ç»çº¸ä¸Šè°ˆå…µ</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ç—›ç‚¹ç›´å‡»ï¼šä½ æ˜¯å¦ä¹Ÿè¿™æ ·å†™æ—¥å¿—ï¼Ÿ</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">"/user"</span>)
public Result <span class="hljs-built_in">createUser</span>(<span class="hljs-variable">@RequestBody</span> User user) {
    <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"ã€åˆ›å»ºç”¨æˆ·ã€‘å‚æ•°: {}"</span>, JSON.<span class="hljs-built_in">toJSONString</span>(user)); <span class="hljs-comment">// 1</span>
    <span class="hljs-selector-tag">try</span> {
        <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.save</span>(user);
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"ã€åˆ›å»ºç”¨æˆ·ã€‘æˆåŠŸ, ç”¨æˆ·ID: {}"</span>, user.<span class="hljs-built_in">getId</span>()); <span class="hljs-comment">// 2</span>
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">Result</span><span class="hljs-selector-class">.ok</span>();
    } <span class="hljs-selector-tag">catch</span> (Exception e) {
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"ã€åˆ›å»ºç”¨æˆ·ã€‘å¤±è´¥, åŸå› : {}"</span>, e.<span class="hljs-built_in">getMessage</span>(), e); <span class="hljs-comment">// 3</span>
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">Result</span><span class="hljs-selector-class">.fail</span>(<span class="hljs-string">"æ“ä½œå¤±è´¥"</span>);
    }
}
</code></pre>
<p><strong>çµé­‚ä¸‰é—®</strong>ï¼š<br/>
âŒ ä¸šåŠ¡ä»£ç è¢«æ—¥å¿—â€œè…Œå…¥å‘³â€ï¼Ÿ<br/>
âŒ ä¿®æ”¹æ—¥å¿—æ ¼å¼è¦æ”¹ä¸Šç™¾ä¸ªæ–¹æ³•ï¼Ÿ<br/>
âŒ æ•æ„Ÿå­—æ®µï¼ˆå¯†ç /æ‰‹æœºå·ï¼‰è£¸å¥”è®°å½•ï¼Ÿ</p>
<p>åˆ«æ€¥ï¼ä»Šå¤©æ‰‹æŠŠæ‰‹å¸¦ä½ ç”¨ <strong>AOP+è‡ªå®šä¹‰æ³¨è§£</strong> ç ´å±€ï¼Œäº²æµ‹åœ¨æ—¥å‡åƒä¸‡çº§è¯·æ±‚ç³»ç»Ÿä¸­ç¨³å®šè¿è¡Œ2å¹´+ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒè®¾è®¡æ€è·¯ï¼ˆæ‹’ç»ç†è®ºå †ç Œï¼‰</h2>






























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼ ç»Ÿå†™æ³•</th><th>æœ¬æ–‡æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>ä¾µå…¥æ€§</strong></td><td>æ¯ä¸ªæ–¹æ³•ç¡¬ç¼–ç </td><td>ä»…éœ€@OptLog("åˆ›å»ºç”¨æˆ·")</td></tr><tr><td><strong>ç»´æŠ¤æˆæœ¬</strong></td><td>æ”¹ä¸€å¤„éœ€å…¨å±€æœ</td><td>æ”¹åˆ‡é¢ç±»ä¸€å¤„ç”Ÿæ•ˆ</td></tr><tr><td><strong>æ•æ„Ÿä¿¡æ¯</strong></td><td>æ‰‹åŠ¨è„±æ•æ˜“é—æ¼</td><td>åˆ‡é¢ç»Ÿä¸€æ‹¦æˆªå¤„ç†</td></tr><tr><td><strong>æ€§èƒ½å½±å“</strong></td><td>åŒæ­¥é˜»å¡</td><td>å¼‚æ­¥+çº¿ç¨‹æ± ä¼˜åŒ–</td></tr></tbody></table>
<p><strong>ä¸ºä»€ä¹ˆé€‰è‡ªå®šä¹‰æ³¨è§£è€Œéç›´æ¥åˆ‡Controllerï¼Ÿ</strong></p>
<blockquote>
<p>ç¬”è€…è¸©å‘å®å½•ï¼šæ›¾ç›´æ¥åˆ‡execution(* com.xxx.controller..<em>.</em>(..))ï¼Œç»“æœSwaggeræ¥å£ã€å¥åº·æ£€æŸ¥å…¨è¢«è®°å½•ï¼Œæ—¥å¿—é‡æš´æ¶¨300%ï¼ç²¾å‡†æ§åˆ¶æ‰æ˜¯ç”Ÿäº§ç¯å¢ƒç‹é“ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€å®æˆ˜å››æ­¥èµ°ï¼ˆé™„å…³é”®ç»†èŠ‚ï¼‰</h2>
<h2 data-id="heading-3">1ï¸âƒ£ å®šä¹‰çµé­‚æ³¨è§£ï¼ˆå¸¦æ“ä½œç±»å‹æšä¸¾ï¼‰</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Target</span>(ElementType.METHOD)
<span class="hljs-variable">@Retention</span>(RetentionPolicy.RUNTIME)
<span class="hljs-variable">@Documented</span>
public <span class="hljs-variable">@interface</span> OptLog {
    <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">value</span>() <span class="hljs-selector-tag">default</span> ""; <span class="hljs-comment">// æ“ä½œæè¿°</span>
    <span class="hljs-selector-tag">OptType</span> <span class="hljs-selector-tag">type</span>() <span class="hljs-selector-tag">default</span> <span class="hljs-selector-tag">OptType</span><span class="hljs-selector-class">.OTHER</span>; <span class="hljs-comment">// æ“ä½œç±»å‹</span>
    
    <span class="hljs-selector-tag">enum</span> <span class="hljs-selector-tag">OptType</span> {
        <span class="hljs-selector-tag">QUERY</span>(<span class="hljs-string">"æŸ¥è¯¢"</span>), <span class="hljs-selector-tag">SAVE</span>(<span class="hljs-string">"æ–°å¢"</span>), <span class="hljs-selector-tag">UPDATE</span>(<span class="hljs-string">"ä¿®æ”¹"</span>), <span class="hljs-selector-tag">DELETE</span>(<span class="hljs-string">"åˆ é™¤"</span>), <span class="hljs-selector-tag">EXPORT</span>(<span class="hljs-string">"å¯¼å‡º"</span>), <span class="hljs-selector-tag">OTHER</span>(<span class="hljs-string">"å…¶ä»–"</span>);
        <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">desc</span>;
        <span class="hljs-selector-tag">OptType</span>(String desc) { <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.desc</span> = <span class="hljs-selector-tag">desc</span>; }
        <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">getDesc</span>() { <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">desc</span>; }
    }
}
</code></pre>
<p>âœ¨ <strong>è®¾è®¡å·§æ€</strong>ï¼šæšä¸¾ç±»å‹è®©æ—¥å¿—å¯è¢«ELKæŒ‰æ“ä½œç±»å‹èšåˆåˆ†æï¼Œè¿ç»´æ’æŸ¥æ•ˆç‡æå‡50%</p>
<h2 data-id="heading-4">2ï¸âƒ£ ç¼–å†™åˆ‡é¢æ ¸å¿ƒï¼ˆé‡ç‚¹å¤„ç†å¼‚å¸¸ä¸è€—æ—¶ï¼‰</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Aspect</span>
<span class="hljs-variable">@Component</span>
<span class="hljs-variable">@Slf4j</span>
public class LogAspect {
    
    <span class="hljs-comment">// å¼‚æ­¥çº¿ç¨‹æ± ï¼ˆé¿å…é˜»å¡ä¸šåŠ¡ï¼‰</span>
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">ExecutorService</span> <span class="hljs-selector-tag">logExecutor</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">ThreadPoolExecutor</span>(
        <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">60</span>L, TimeUnit.SECONDS,
        new LinkedBlockingQueue&lt;&gt;(<span class="hljs-number">1000</span>),
        r -&gt; new <span class="hljs-built_in">Thread</span>(r, <span class="hljs-string">"async-log-thread"</span>),
        new ThreadPoolExecutor.<span class="hljs-built_in">CallerRunsPolicy</span>()
    );

    @<span class="hljs-selector-tag">Around</span>(<span class="hljs-string">"@annotation(optLog)"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">Object</span> <span class="hljs-selector-tag">around</span>(ProceedingJoinPoint pjp, OptLog optLog) <span class="hljs-selector-tag">throws</span> <span class="hljs-selector-tag">Throwable</span> {
        <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">start</span> = <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.currentTimeMillis</span>();
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">methodName</span> = <span class="hljs-selector-tag">pjp</span><span class="hljs-selector-class">.getSignature</span>()<span class="hljs-selector-class">.toShortString</span>();
        <span class="hljs-selector-tag">Object</span> <span class="hljs-selector-tag">result</span> = <span class="hljs-selector-tag">null</span>;
        <span class="hljs-selector-tag">Exception</span> <span class="hljs-selector-tag">exception</span> = <span class="hljs-selector-tag">null</span>;
        
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">result</span> = <span class="hljs-selector-tag">pjp</span><span class="hljs-selector-class">.proceed</span>(); <span class="hljs-comment">// æ‰§è¡Œç›®æ ‡æ–¹æ³•</span>
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">result</span>;
        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">exception</span> = <span class="hljs-selector-tag">e</span>;
            <span class="hljs-selector-tag">throw</span> <span class="hljs-selector-tag">e</span>; <span class="hljs-comment">// ä¿è¯å¼‚å¸¸æ­£å¸¸æŠ›å‡º</span>
        } <span class="hljs-selector-tag">finally</span> {
            <span class="hljs-comment">// å¼‚æ­¥è®°å½•æ—¥å¿—ï¼ˆå…³é”®ï¼ï¼‰</span>
            <span class="hljs-selector-tag">logExecutor</span><span class="hljs-selector-class">.execute</span>(() -&gt; <span class="hljs-built_in">buildAndSaveLog</span>(pjp, optLog, result, exception, 
                System.<span class="hljs-built_in">currentTimeMillis</span>() - start, methodName));
        }
    }

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">buildAndSaveLog</span>(...) {
        <span class="hljs-comment">// 1. å‚æ•°è„±æ•ï¼ˆé‡ç‚¹ï¼ï¼‰</span>
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">argsStr</span> = <span class="hljs-selector-tag">JSON</span><span class="hljs-selector-class">.toJSONString</span>(pjp.<span class="hljs-built_in">getArgs</span>(), 
            SerializerFeature.WriteMapNullValue,
            <span class="hljs-comment">// è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼šå¯†ç /æ‰‹æœºå·è„±æ•</span>
            (o, fieldName, fieldType, features) -&gt; {
                <span class="hljs-selector-tag">if</span> (<span class="hljs-string">"password"</span>.<span class="hljs-built_in">equals</span>(fieldName) || <span class="hljs-string">"phone"</span>.<span class="hljs-built_in">equals</span>(fieldName)) {
                    <span class="hljs-selector-tag">return</span> "******";
                }
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">SerializerFeature</span><span class="hljs-selector-class">.EMPTY</span>;
            });
        
        <span class="hljs-comment">// 2. æ„å»ºæ—¥å¿—å¯¹è±¡ï¼ˆå«æ“ä½œäººã€IPã€è€—æ—¶ç­‰ï¼‰</span>
        <span class="hljs-selector-tag">SysLog</span> <span class="hljs-selector-tag">log</span> = <span class="hljs-selector-tag">SysLog</span><span class="hljs-selector-class">.builder</span>()
            <span class="hljs-selector-class">.optModule</span>(<span class="hljs-built_in">getModuleName</span>(pjp)) <span class="hljs-comment">// ä»åŒ…è·¯å¾„æå–æ¨¡å—å</span>
            <span class="hljs-selector-class">.optType</span>(optLog.<span class="hljs-built_in">type</span>().<span class="hljs-built_in">getDesc</span>())
            <span class="hljs-selector-class">.optDesc</span>(optLog.<span class="hljs-built_in">value</span>())
            <span class="hljs-selector-class">.requestParam</span>(argsStr)
            <span class="hljs-selector-class">.responseResult</span>(exception == null ? JSON.<span class="hljs-built_in">toJSONString</span>(result) : <span class="hljs-string">"å¼‚å¸¸:"</span> + exception.<span class="hljs-built_in">getMessage</span>())
            <span class="hljs-selector-class">.costTime</span>(costTime)
            <span class="hljs-selector-class">.createTime</span>(LocalDateTime.<span class="hljs-built_in">now</span>())
            <span class="hljs-selector-class">.build</span>();
        
        <span class="hljs-comment">// 3. æŒä¹…åŒ–ï¼ˆæ ¹æ®ç¯å¢ƒé€‰æ‹©ï¼šå¼€å‘æ§åˆ¶å°/ç”Ÿäº§å­˜DBï¼‰</span>
        <span class="hljs-selector-tag">if</span> (env.<span class="hljs-built_in">equals</span>(<span class="hljs-string">"prod"</span>)) {
            <span class="hljs-selector-tag">sysLogService</span><span class="hljs-selector-class">.saveAsync</span>(log); <span class="hljs-comment">// å¼‚æ­¥å­˜åº“</span>
        } <span class="hljs-selector-tag">else</span> {
            <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"ã€æ“ä½œæ—¥å¿—ã€‘{}"</span>, JSON.<span class="hljs-built_in">toJSONString</span>(log));
        }
    }
}
</code></pre>
<h2 data-id="heading-5">3ï¸âƒ£ ä¸šåŠ¡ä»£ç æ¸…çˆ½ç¤ºä¾‹</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@OptLog</span>(value = <span class="hljs-string">"é‡ç½®ç”¨æˆ·å¯†ç "</span>, type = OptLog.OptType.<span class="hljs-attribute">UPDATE</span>)
<span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">"/resetPwd"</span>)
public Result <span class="hljs-built_in">resetPassword</span>(<span class="hljs-variable">@Valid</span> <span class="hljs-variable">@RequestBody</span> ResetPwdDTO dto) {
    <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘å¹²å‡€å¾—åƒåˆšæ´—è¿‡çš„ä»£ç </span>
    <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.resetPassword</span>(dto.<span class="hljs-built_in">getUserId</span>(), dto.<span class="hljs-built_in">getNewPassword</span>());
    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">Result</span><span class="hljs-selector-class">.ok</span>(<span class="hljs-string">"å¯†ç é‡ç½®æˆåŠŸ"</span>);
}
<span class="hljs-comment">// æ§åˆ¶å°è¾“å‡ºï¼šã€æ“ä½œæ—¥å¿—ã€‘{"optModule":"ç”¨æˆ·ç®¡ç†","optType":"ä¿®æ”¹","optDesc":"é‡ç½®ç”¨æˆ·å¯†ç ",...,"requestParam":"{"userId":1001,"newPassword":"******"}"}</span>
</code></pre>
<h2 data-id="heading-6">4ï¸âƒ£ ç”Ÿäº§ç¯å¢ƒåŠ å›ºï¼ˆè¡€æ³ªç»éªŒï¼‰</h2>
<ul>
<li><strong>é˜²æ—¥å¿—é£æš´</strong>ï¼šåœ¨åˆ‡é¢å¼€å¤´åŠ if (log.isInfoEnabled())åˆ¤æ–­</li>
<li><strong>å¤§å¯¹è±¡å¤„ç†</strong>ï¼šå¯¹MultipartFileç­‰å‚æ•°è·³è¿‡åºåˆ—åŒ–</li>
<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šThreadLocalå­˜å‚¨æ“ä½œäººä¿¡æ¯ï¼ˆé…åˆæ‹¦æˆªå™¨ï¼‰</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šæ—¥å¿—å¼‚å¸¸æ—¶æ¨é€ä¼ä¸šå¾®ä¿¡ï¼ˆç¤ºä¾‹ä»£ç ç•¥ï¼Œå¯ç§ä¿¡ç´¢å–ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-7">å››ã€æ•ˆæœå¯¹æ¯” &amp; ä»·å€¼å‡å</h2>
<p>è¡¨æ ¼</p>






























<table><thead><tr><th>ç»´åº¦</th><th>æ”¹é€ å‰</th><th>æ”¹é€ å</th></tr></thead><tbody><tr><td>å•æ¥å£ä»£ç é‡</td><td>15+è¡Œæ—¥å¿—</td><td>0è¡Œä¾µå…¥</td></tr><tr><td>æ–°å¢æ—¥å¿—éœ€æ±‚</td><td>å…¨å±€æœç´¢ä¿®æ”¹</td><td>ä»…è°ƒæ•´åˆ‡é¢</td></tr><tr><td>æ•æ„Ÿä¿¡æ¯é£é™©</td><td>é«˜ï¼ˆä¾èµ–äººå·¥ï¼‰</td><td>ä½ï¼ˆç»Ÿä¸€æ‹¦æˆªï¼‰</td></tr><tr><td>æ’æŸ¥æ•ˆç‡</td><td>ç¿»æ‰¾ä¸šåŠ¡æ—¥å¿—</td><td>æŒ‰æ“ä½œç±»å‹ç²¾å‡†ç­›é€‰</td></tr></tbody></table>
<p><strong>ä¸æ­¢äºæ—¥å¿—</strong>ï¼šæ­¤æ¨¡å¼å¯å¤ç”¨äº<br/>
âœ… æ¥å£è€—æ—¶ç›‘æ§ï¼ˆå¯¹æ¥Prometheusï¼‰<br/>
âœ… æ“ä½œå®¡è®¡ç•™ç—•ï¼ˆæ»¡è¶³ç­‰ä¿è¦æ±‚ï¼‰<br/>
âœ… ç°åº¦å‘å¸ƒæµé‡æ ‡è®°</p>
<hr/>
<h2 data-id="heading-8">äº”ã€å†™åœ¨æœ€å</h2>
<p>æŠ€æœ¯æ²¡æœ‰é“¶å¼¹ï¼Œä½†<strong>è§£è€¦æ€ç»´</strong>æ˜¯æ°¸æ’çš„åˆ©å™¨ã€‚AOPä¸æ˜¯ç‚«æŠ€ï¼Œè€Œæ˜¯è®©ä»£ç å›å½’ä¸šåŠ¡æœ¬è´¨çš„å·¥ç¨‹å®è·µã€‚ç¬”è€…åœ¨é‡æ„æŸé“¶è¡Œæ ¸å¿ƒç³»ç»Ÿæ—¶ï¼Œä»…ç”¨3å¤©å°†200+æ¥å£æ—¥å¿—ç»Ÿä¸€æ²»ç†ï¼Œåç»­è¿ç»´åé¦ˆâ€œæŸ¥é—®é¢˜åƒå¼€äº†å¤©çœ¼â€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº Java çš„ PDF æ–‡æœ¬æ°´å°å®ç°æ–¹æ¡ˆï¼ˆiText7 ç¤ºä¾‹ï¼‰]]></title>    <link>https://juejin.cn/post/7602841282802516009</link>    <guid>https://juejin.cn/post/7602841282802516009</guid>    <pubDate>2026-02-04T15:29:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602841282802516009" data-draft-id="7603004323869999147" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº Java çš„ PDF æ–‡æœ¬æ°´å°å®ç°æ–¹æ¡ˆï¼ˆiText7 ç¤ºä¾‹ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-04T15:29:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Reboot"/> <meta itemprop="url" content="https://juejin.cn/user/254742430491175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº Java çš„ PDF æ–‡æœ¬æ°´å°å®ç°æ–¹æ¡ˆï¼ˆiText7 ç¤ºä¾‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/254742430491175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Reboot
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T15:29:10.000Z" title="Wed Feb 04 2026 15:29:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ Java åœ¨ PDF æ–‡æ¡£ä¸Šæ·»åŠ é€šç”¨çš„æ–‡å­—æ°´å°ï¼Œç¤ºä¾‹åŸºäº iText7ï¼Œå¼ºè°ƒå®ç°æ€è·¯å’Œå…³é”® APIï¼Œä¾¿äºåœ¨ä»»æ„é¡¹ç›®ä¸­å¤ç”¨æˆ–æ‰©å±•ã€‚</p>
<hr/>
<h3 data-id="heading-0">1. æ–¹æ¡ˆæ¦‚è§ˆ</h3>
<ul>
<li>
<p><strong>ç›®æ ‡</strong>ï¼šåœ¨ç°æœ‰ PDF æ–‡ä»¶çš„æ¯ä¸€é¡µä¸Šæ·»åŠ å±…ä¸­ã€æ–œå‘ã€åŠé€æ˜çš„æ–‡å­—æ°´å°ï¼Œä¾‹å¦‚ã€Œxxå…¬å¸ã€ã€‚</p>
</li>
<li>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>é¢„è§ˆ/ä¸‹è½½å‰å¯¹ PDF åŠ é˜²æ³„éœ²æ°´å°ï¼›</li>
<li>æ‰¹é‡å½’æ¡£ PDF æ—¶ç»Ÿä¸€æ·»åŠ ç‰ˆæƒä¿¡æ¯ï¼›</li>
<li>æŒ‰ç”¨æˆ·æˆ–ç§Ÿæˆ·åŠ¨æ€ç”Ÿæˆä¸ªæ€§åŒ–æ°´å°ï¼ˆç”¨æˆ·åã€æ—¶é—´ã€IP ç­‰ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ ¸å¿ƒæŠ€æœ¯æ ˆ</strong>ï¼š</p>
<ul>
<li>Java 8+ï¼›</li>
<li>iText7ï¼ˆ<code>com.itextpdf:itext7-core</code>ï¼‰ï¼›</li>
<li>å¦‚éœ€ä¸­æ–‡ï¼Œå»ºè®®å¼•å…¥ä¸­æ–‡å­—ä½“ä¾èµ–ï¼ˆå¦‚ <code>font-asian</code> æˆ–è‡ªå¤‡ TTF/OTF å­—ä½“ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-1">2. åŸºæœ¬ä¾èµ–é…ç½®ç¤ºä¾‹ï¼ˆMavenï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
 Â  Â <span class="hljs-comment">&lt;!-- iText7 ä¸»ä¾èµ–ï¼ˆPDF å†…æ ¸ï¼‰ --&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.itextpdf<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>itext7-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>7.2.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
â€‹
 Â  Â <span class="hljs-comment">&lt;!-- å¯é€‰ï¼šä¸­æ–‡å­—ä½“æ”¯æŒï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå¸¦ TTF å­—ä½“æ–‡ä»¶ï¼‰ --&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.itextpdf<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>font-asian<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>7.2.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<blockquote>
<p>å®é™…ç‰ˆæœ¬å·å¯æŒ‰é¡¹ç›®ç»Ÿä¸€ä¾èµ–ç®¡ç†è°ƒæ•´ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">3. å®ç°æ€è·¯</h3>
<ol start="0">
<li>
<p>ä½¿ç”¨ <code>PdfReader</code> è¯»å–åŸå§‹ PDF è¾“å…¥æµï¼ˆæˆ–æ–‡ä»¶ï¼‰ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ <code>PdfWriter</code> å°†å¤„ç†ç»“æœå†™å…¥è¾“å‡ºæµï¼ˆå†…å­˜æˆ–æ–°æ–‡ä»¶ï¼‰ã€‚</p>
</li>
<li>
<p>æ„é€  <code>PdfDocument</code> ä¸é«˜çº§å¸ƒå±€å¯¹è±¡ <code>Document</code>ã€‚</p>
</li>
<li>
<p>é€‰æ‹©åˆé€‚çš„å­—ä½“ï¼ˆç‰¹åˆ«æ˜¯åŒ…å«ä¸­æ–‡çš„å­—ä½“ï¼‰ã€‚</p>
</li>
<li>
<p>éå† PDF çš„æ¯ä¸€é¡µï¼Œè®¡ç®—é¡µé¢ä¸­å¿ƒåæ ‡ï¼Œåœ¨å¯¹åº”é¡µä¸Šç»˜åˆ¶æ°´å° <code>Paragraph</code>ï¼š</p>
<ul>
<li>æ–‡æœ¬å†…å®¹ï¼šä¾‹å¦‚ã€Œxxå…¬å¸ã€æˆ–æŸä¸ªåŠ¨æ€å­—ç¬¦ä¸²ï¼›</li>
<li>å­—ä½“ã€å­—å·ã€é¢œè‰²ã€é€æ˜åº¦ï¼›</li>
<li>æ—‹è½¬è§’åº¦ï¼ˆå¦‚ 45Â°ï¼‰ä¸å¯¹é½æ–¹å¼ï¼ˆå±…ä¸­ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p>å…³é—­æ–‡æ¡£ï¼Œè¾“å‡ºå¸¦æ°´å°çš„ PDFã€‚</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-3">4. ç¤ºä¾‹ä»£ç ï¼šä¸ºæ¯é¡µæ·»åŠ å¯¹è§’çº¿æ–‡å­—æ°´å°</h3>
<pre><code class="hljs language-ini" lang="ini">
import com.itextpdf.io.font.PdfEncodings<span class="hljs-comment">;</span>
import com.itextpdf.kernel.colors.DeviceRgb<span class="hljs-comment">;</span>
import com.itextpdf.kernel.font.PdfFont<span class="hljs-comment">;</span>
import com.itextpdf.kernel.font.PdfFontFactory<span class="hljs-comment">;</span>
import com.itextpdf.kernel.geom.Rectangle<span class="hljs-comment">;</span>
import com.itextpdf.kernel.pdf.PdfDocument<span class="hljs-comment">;</span>
import com.itextpdf.kernel.pdf.PdfReader<span class="hljs-comment">;</span>
import com.itextpdf.kernel.pdf.PdfWriter<span class="hljs-comment">;</span>
import com.itextpdf.layout.Document<span class="hljs-comment">;</span>
import com.itextpdf.layout.element.Paragraph<span class="hljs-comment">;</span>
import com.itextpdf.layout.properties.TextAlignment<span class="hljs-comment">;</span>
import com.itextpdf.layout.properties.VerticalAlignment<span class="hljs-comment">;</span>
â€‹
import java.io.ByteArrayOutputStream<span class="hljs-comment">;</span>
import java.io.InputStream<span class="hljs-comment">;</span>
â€‹
public class PdfWatermarkUtil {
â€‹
 Â  Â /**
 Â  Â  * ä¸º PDF æ¯ä¸€é¡µæ·»åŠ æ–œå‘æ–‡å­—æ°´å°
 Â  Â  *
 Â  Â  * @param pdfInput Â  Â  åŸå§‹ PDF è¾“å…¥æµ
 Â  Â  * @param watermark Â   æ°´å°æ–‡æœ¬ï¼ˆå¦‚ "xxå…¬å¸"ï¼‰
 Â  Â  * @return å¸¦æ°´å° PDF çš„å­—èŠ‚æ•°ç»„
 Â  Â  */
 Â  Â public static byte<span class="hljs-section">[]</span> addTextWatermark(InputStream pdfInput, String watermark) throws Exception {
 Â  Â  Â  Â try (ByteArrayOutputStream <span class="hljs-attr">out</span> = new ByteArrayOutputStream()) {
 Â  Â  Â  Â  Â  Â PdfReader <span class="hljs-attr">reader</span> = new PdfReader(pdfInput)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â PdfWriter <span class="hljs-attr">writer</span> = new PdfWriter(out)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â PdfDocument <span class="hljs-attr">pdfDoc</span> = new PdfDocument(reader, writer)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â Document <span class="hljs-attr">document</span> = new Document(pdfDoc)<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â  Â  Â PdfFont <span class="hljs-attr">font</span> = createFont()<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â  Â  Â int <span class="hljs-attr">totalPages</span> = pdfDoc.getNumberOfPages()<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â for (int <span class="hljs-attr">i</span> = <span class="hljs-number">1</span><span class="hljs-comment">; i &lt;= totalPages; i++) {</span>
 Â  Â  Â  Â  Â  Â  Â  Â Rectangle <span class="hljs-attr">pageSize</span> = pdfDoc.getPage(i).getPageSize()<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â float <span class="hljs-attr">x</span> = (pageSize.getLeft() + pageSize.getRight()) / <span class="hljs-number">2</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â float <span class="hljs-attr">y</span> = (pageSize.getTop() + pageSize.getBottom()) / <span class="hljs-number">2</span><span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â  Â  Â  Â  Â Paragraph <span class="hljs-attr">p</span> = new Paragraph(watermark)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .setFont(font)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .setFontSize(60)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .setFontColor(new DeviceRgb(192, 192, 192))
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   .setOpacity(0.3f)<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â  Â  Â  Â  Â document.showTextAligned(
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â p,
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â x, y, i,
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â TextAlignment.CENTER,
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â VerticalAlignment.MIDDLE,
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   (float) Math.toRadians(45)
 Â  Â  Â  Â  Â  Â  Â   )<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   }
â€‹
 Â  Â  Â  Â  Â  Â document.close()<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â pdfDoc.close()<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â return out.toByteArray()<span class="hljs-comment">;</span>
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â /**
 Â  Â  * åˆ›å»ºå­—ä½“ï¼ˆç¤ºä¾‹ï¼šä½¿ç”¨ç³»ç»Ÿæˆ–è‡ªå¸¦çš„ä¸­æ–‡å­—ä½“ï¼‰
 Â  Â  */
 Â  Â private static PdfFont createFont() throws Exception {
 Â  Â  Â  Â // ç¤ºä¾‹ï¼šä½¿ç”¨å†…ç½®å­—ä½“æˆ–è‡ªå¸¦ TTF æ–‡ä»¶
 Â  Â  Â  Â // 1ï¼‰è‹¥æœ‰è‡ªå®šä¹‰å­—ä½“ï¼š
 Â  Â  Â  Â // return PdfFontFactory.createFont("/path/to/simsun.ttf", PdfEncodings.IDENTITY_H, true)<span class="hljs-comment">;</span>
 Â  Â  Â  Â // 2ï¼‰ç®€åŒ–ç¤ºä¾‹ï¼šä½¿ç”¨å†…ç½®å­—ä½“ï¼ˆä¸ä¿è¯å®Œæ•´ä¸­æ–‡æ”¯æŒï¼‰
 Â  Â  Â  Â return PdfFontFactory.createFont("STSong-Light", "UniGB-UCS2-H", true)<span class="hljs-comment">;</span>
 Â   }
}
</code></pre>
<hr/>
<h3 data-id="heading-4">5. å…³é”®ç‚¹ä¸æ‰©å±•å»ºè®®</h3>
<ul>
<li>
<p><strong>å­—ä½“é€‰æ‹©</strong>ï¼šå¯¹ä¸­æ–‡ PDFï¼Œå°½é‡ä½¿ç”¨åŒ…å«ä¸­æ–‡çš„ TTF/OTF å­—ä½“æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ <code>PdfEncodings.IDENTITY_H</code> åˆ›å»ºåµŒå…¥å­—ä½“ï¼Œé¿å…ä¹±ç ã€‚</p>
</li>
<li>
<p><strong>é€æ˜åº¦ä¸å­—å·</strong>ï¼šå¯æ ¹æ®å®é™…æ‰“å°/é¢„è§ˆæ•ˆæœè°ƒæ•´æ°´å°çš„å­—å·å’Œ <code>setOpacity</code>ï¼Œåœ¨å¯è§ä¸ä¸å¹²æ‰°é˜…è¯»ä¹‹é—´å–å¾—å¹³è¡¡ã€‚</p>
</li>
<li>
<p><strong>åŠ¨æ€æ°´å°</strong>ï¼šä¸šåŠ¡ä»£ç ä¸­é€šå¸¸ä¸ä¼šå†™æ­»ã€Œxxå…¬å¸ã€ï¼Œè€Œæ˜¯å°†æ°´å°æ–‡æ¡ˆä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œä¾‹å¦‚ã€Œxxå…¬å¸ï¼ˆæœºå¯†ï¼‰ã€æˆ–ã€Œç”¨æˆ·å+æ—¶é—´æˆ³ã€ã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šå¯¹äºéå¸¸å¤§çš„ PDFï¼ˆé¡µæ•°å¾ˆå¤šï¼‰ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li>æ§åˆ¶åªå¯¹éƒ¨åˆ†é¡µé¢åŠ æ°´å°ï¼›</li>
<li>æˆ–åœ¨å¼‚æ­¥ä»»åŠ¡/æ‰¹å¤„ç†æœåŠ¡ä¸­æ‰§è¡Œæ°´å°æ“ä½œã€‚</li>
</ul>
</li>
<li>
<p><strong>å®‰å…¨æ€§</strong>ï¼šæ°´å°ä¸èƒ½é˜²æ­¢ä¸“ä¸šçš„ PDF ç¼–è¾‘/ç¯¡æ”¹ï¼Œä½†å¯¹ä¸€èˆ¬ç”¨æˆ·çš„æ³„éœ²è¡Œä¸ºæœ‰ä¸€å®šå¨æ…‘ä¸è¿½è´£ä½œç”¨ï¼Œå¯ç»“åˆæƒé™æ§åˆ¶ä¸€åŒä½¿ç”¨ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-5">6. æ€»ç»“</h3>
<p>ä½¿ç”¨ iText7 ç»™ PDF æ·»åŠ æ–‡å­—æ°´å°çš„æ ¸å¿ƒå°±æ˜¯ï¼š<strong>è¯»å–ç°æœ‰ PDF â†’ éå†é¡µé¢ â†’ åœ¨æ¯é¡µå åŠ ä¸€å±‚åŠé€æ˜æ–‡æœ¬</strong>ã€‚ä¸Šé¢çš„å°è£…æ–¹æ³•åªä¾èµ– <code>InputStream</code> ä¸æ–‡æ¡ˆå­—ç¬¦ä¸²ï¼Œä¾¿äºé›†æˆåˆ°ä¸Šä¼ ã€ä¸‹è½½æˆ–æ–‡ä»¶è½¬æ¢é“¾è·¯ä¸­ï¼Œå®ç°ç»Ÿä¸€çš„ PDF æ°´å°ç­–ç•¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº Java çš„ Word æ–‡æ¡£ï¼ˆDOC/DOCXï¼‰æ–‡å­—æ°´å°å®ç°ï¼ˆSpire.Doc ç¤ºä¾‹ï¼‰]]></title>    <link>https://juejin.cn/post/7603004323870015531</link>    <guid>https://juejin.cn/post/7603004323870015531</guid>    <pubDate>2026-02-04T15:30:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603004323870015531" data-draft-id="7602841282802532393" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº Java çš„ Word æ–‡æ¡£ï¼ˆDOC/DOCXï¼‰æ–‡å­—æ°´å°å®ç°ï¼ˆSpire.Doc ç¤ºä¾‹ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-04T15:30:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Reboot"/> <meta itemprop="url" content="https://juejin.cn/user/254742430491175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº Java çš„ Word æ–‡æ¡£ï¼ˆDOC/DOCXï¼‰æ–‡å­—æ°´å°å®ç°ï¼ˆSpire.Doc ç¤ºä¾‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/254742430491175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Reboot
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T15:30:15.000Z" title="Wed Feb 04 2026 15:30:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨ Java ä¸­ä¸º Word æ–‡æ¡£ï¼ˆ<code>.doc</code>ã€<code>.docx</code>ï¼‰æ·»åŠ é¡µé¢æ–‡å­—æ°´å°ï¼Œç¤ºä¾‹åŸºäº Spire.Doc for Javaï¼Œä¾§é‡é€šç”¨å®ç°æ–¹å¼ï¼Œä¸ä¾èµ–å…·ä½“ä¸šåŠ¡ä»£ç ã€‚</p>
<hr/>
<h3 data-id="heading-0">1. æ–¹æ¡ˆæ¦‚è§ˆ</h3>
<ul>
<li>
<p><strong>ç›®æ ‡</strong>ï¼šåœ¨ Word æ–‡æ¡£çš„æ¯ä¸€é¡µæ·»åŠ æ–œå‘ã€æµ…ç°è‰²çš„æ–‡å­—æ°´å°ï¼ˆä¾‹å¦‚ã€Œxxå…¬å¸ã€ï¼‰ï¼Œä»¥é¡µé¢æ°´å°çš„å½¢å¼å‘ˆç°ï¼Œä¸ç›´æ¥ä¿®æ”¹æ­£æ–‡å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>é€‚ç”¨æ ¼å¼</strong>ï¼š<code>.doc</code>ã€<code>.docx</code>ï¼ˆå¦‚éœ€ <code>.wps</code> ç­‰å…¶ä»–æ ¼å¼ï¼Œå¯æŒ‰åŒæ ·æ€è·¯æ‰©å±•ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒæŠ€æœ¯æ ˆ</strong>ï¼š</p>
<ul>
<li>Java 8+ï¼›</li>
<li>Spire.Doc for Javaï¼ˆæœ¬æ–‡ä½¿ç”¨å…¶ Free ç‰ˆæœ¬ä½œä¸ºç¤ºä¾‹ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-1">2. Maven ä¾èµ–ä¸ä»“åº“ç¤ºä¾‹</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
 Â  Â <span class="hljs-comment">&lt;!-- Spire.Doc for Javaï¼ˆFree ç‰ˆæœ¬ç¤ºä¾‹ï¼Œç‰ˆæœ¬å·å¯æŒ‰éœ€è°ƒæ•´ï¼‰ --&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>e-iceblue<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spire.doc.free<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
â€‹
<span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>com.e-iceblue<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.e-iceblue.cn/repository/maven-public/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>
</code></pre>
<blockquote>
<p>ç”Ÿäº§ç¯å¢ƒå¯æ ¹æ®è®¸å¯è¯é€‰æ‹©ä»˜è´¹æˆ–æ›´æ–°ç‰ˆæœ¬ï¼Œå¹¶ç»Ÿä¸€ç®¡ç†ç‰ˆæœ¬å·ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">3. å®ç°æ€è·¯</h3>
<ol start="0">
<li>
<p>ä½¿ç”¨ Spire.Doc çš„ <code>Document</code> ç±»ä»æ–‡ä»¶æˆ–è¾“å…¥æµåŠ è½½ Word æ–‡æ¡£ï¼š</p>
<ul>
<li>DOCXï¼š<code>loadFromStream(..., FileFormat.Docx)</code>ï¼›</li>
<li>DOCï¼š<code>loadFromStream(..., FileFormat.Doc)</code>ï¼›</li>
<li>æˆ–ä½¿ç”¨ <code>loadFromFile(...)</code> ä»ç‰©ç†æ–‡ä»¶åŠ è½½ã€‚</li>
</ul>
</li>
<li>
<p>æ„é€ ä¸€ä¸ª <code>TextWatermark</code> å¯¹è±¡ï¼Œè®¾ç½®æ°´å°æ–‡æœ¬ã€å­—å·ã€é¢œè‰²å’Œå¸ƒå±€ã€‚</p>
</li>
<li>
<p>é€šè¿‡æ–‡æ¡£çš„ <code>Section</code> å¯¹è±¡è·å– <code>Document</code> å¹¶è°ƒç”¨ <code>setWatermark(TextWatermark)</code> åº”ç”¨æ°´å°ï¼š</p>
<ul>
<li>å®˜æ–¹æ¨èç”¨ <code>document.getSections().get(0).getDocument().setWatermark(...)</code>ã€‚</li>
</ul>
</li>
<li>
<p>ä»¥ç›¸åº”çš„ <code>FileFormat</code> ä¿å­˜æ–‡æ¡£åˆ°æ–°æ–‡ä»¶æˆ–è¾“å‡ºæµï¼Œå¾—åˆ°å¸¦æ°´å°çš„ DOC/DOCXã€‚</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-3">4. ç¤ºä¾‹ä¸€ï¼šä¸º DOCX æ–‡æ¡£æ·»åŠ æ–‡å­—æ°´å°</h3>
<h4 data-id="heading-4">4.1 ä»æ–‡ä»¶åŠ è½½å¹¶è¾“å‡ºåˆ°æ–°æ–‡ä»¶</h4>
<pre><code class="hljs language-typescript" lang="typescript">
<span class="hljs-keyword">import</span> com.<span class="hljs-property">spire</span>.<span class="hljs-property">doc</span>.<span class="hljs-property">Document</span>;
<span class="hljs-keyword">import</span> com.<span class="hljs-property">spire</span>.<span class="hljs-property">doc</span>.<span class="hljs-property">FileFormat</span>;
<span class="hljs-keyword">import</span> com.<span class="hljs-property">spire</span>.<span class="hljs-property">doc</span>.<span class="hljs-property">TextWatermark</span>;
<span class="hljs-keyword">import</span> com.<span class="hljs-property">spire</span>.<span class="hljs-property">doc</span>.<span class="hljs-property">documents</span>.<span class="hljs-property">WatermarkLayout</span>;
â€‹
<span class="hljs-keyword">import</span> java.<span class="hljs-property">awt</span>.<span class="hljs-property">Color</span>;
â€‹
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DocxWatermarkExample</span> {
â€‹
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">addWatermarkToDocx</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> inputPath, <span class="hljs-built_in">String</span> outputPath, <span class="hljs-built_in">String</span> watermarkText</span>) {
 Â  Â  Â  Â <span class="hljs-comment">// 1. åŠ è½½ DOCX æ–‡æ¡£</span>
 Â  Â  Â  Â <span class="hljs-title class_">Document</span> <span class="hljs-variable language_">document</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>();
 Â  Â  Â  Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">loadFromFile</span>(inputPath, <span class="hljs-title class_">FileFormat</span>.<span class="hljs-property">Docx</span>);
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// 2. åˆ›å»ºæ–‡å­—æ°´å°</span>
 Â  Â  Â  Â <span class="hljs-title class_">TextWatermark</span> watermark = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextWatermark</span>();
 Â  Â  Â  Â watermark.<span class="hljs-title function_">setText</span>(watermarkText); Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// å¦‚ï¼š"xxå…¬å¸"</span>
 Â  Â  Â  Â watermark.<span class="hljs-title function_">setFontSize</span>(<span class="hljs-number">40</span>); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// å­—å·</span>
 Â  Â  Â  Â watermark.<span class="hljs-title function_">setColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">lightGray</span>); Â  Â  Â  Â  Â  <span class="hljs-comment">// é¢œè‰²</span>
 Â  Â  Â  Â watermark.<span class="hljs-title function_">setLayout</span>(<span class="hljs-title class_">WatermarkLayout</span>.<span class="hljs-property">Diagonal</span>); <span class="hljs-comment">// æ–œå¯¹è§’</span>
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// 3. é€šè¿‡ Section çš„ Document è®¾ç½®æ°´å°ï¼ˆå®˜æ–¹æ¨èæ–¹å¼ï¼‰</span>
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getSections</span>().<span class="hljs-title function_">getCount</span>() &gt; <span class="hljs-number">0</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getSections</span>().<span class="hljs-title function_">get</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">getDocument</span>().<span class="hljs-title function_">setWatermark</span>(watermark);
 Â  Â  Â   } <span class="hljs-keyword">else</span> {
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æç«¯æƒ…å†µä¸‹æ²¡æœ‰ sectionï¼Œå¯é€€å›åˆ°ç›´æ¥è®¾ç½®</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">setWatermark</span>(watermark);
 Â  Â  Â   }
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// 4. ä¿å­˜ä¸ºæ–°çš„ DOCX</span>
 Â  Â  Â  Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">saveToFile</span>(outputPath, <span class="hljs-title class_">FileFormat</span>.<span class="hljs-property">Docx</span>);
 Â  Â  Â  Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">close</span>();
 Â   }
}
</code></pre>
<h4 data-id="heading-5">4.2 ä»è¾“å…¥æµåˆ°å­—èŠ‚æ•°ç»„ï¼ˆé€‚ç”¨äº Web ä¸Šä¼ /ä¸‹è½½åœºæ™¯ï¼‰</h4>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-keyword">import</span> com.spire.doc.Document;
<span class="hljs-keyword">import</span> com.spire.doc.FileFormat;
<span class="hljs-keyword">import</span> com.spire.doc.TextWatermark;
<span class="hljs-keyword">import</span> com.spire.doc.documents.WatermarkLayout;
â€‹
<span class="hljs-keyword">import</span> java.awt.Color;
<span class="hljs-keyword">import</span> java.io.ByteArrayOutputStream;
<span class="hljs-keyword">import</span> java.io.InputStream;
â€‹
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DocxWatermarkUtil</span> {
â€‹
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] addWatermarkToDocx(InputStream inputStream, String watermarkText) <span class="hljs-keyword">throws</span> Exception {
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>()) {
 Â  Â  Â  Â  Â  Â <span class="hljs-type">Document</span> <span class="hljs-variable">document</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>();
 Â  Â  Â  Â  Â  Â document.loadFromStream(inputStream, FileFormat.Docx);
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-type">TextWatermark</span> <span class="hljs-variable">watermark</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextWatermark</span>();
 Â  Â  Â  Â  Â  Â watermark.setText(watermarkText);
 Â  Â  Â  Â  Â  Â watermark.setFontSize(<span class="hljs-number">40</span>);
 Â  Â  Â  Â  Â  Â watermark.setColor(Color.lightGray);
 Â  Â  Â  Â  Â  Â watermark.setLayout(WatermarkLayout.Diagonal);
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (document.getSections().getCount() &gt; <span class="hljs-number">0</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â document.getSections().get(<span class="hljs-number">0</span>).getDocument().setWatermark(watermark);
 Â  Â  Â  Â  Â   } <span class="hljs-keyword">else</span> {
 Â  Â  Â  Â  Â  Â  Â  Â document.setWatermark(watermark);
 Â  Â  Â  Â  Â   }
â€‹
 Â  Â  Â  Â  Â  Â document.saveToStream(out, FileFormat.Docx);
 Â  Â  Â  Â  Â  Â document.close();
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> out.toByteArray();
 Â  Â  Â   }
 Â   }
}
</code></pre>
<hr/>
<h3 data-id="heading-6">5. ç¤ºä¾‹äºŒï¼šä¸º DOC æ–‡æ¡£æ·»åŠ æ–‡å­—æ°´å°</h3>
<p>DOC æ–‡æ¡£ä¸ DOCX å®ç°æ–¹å¼åŸºæœ¬ç›¸åŒï¼Œä»…åœ¨ <code>FileFormat</code> ä¸Šæœ‰æ‰€å·®å¼‚ã€‚</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-keyword">import</span> com.spire.doc.Document;
<span class="hljs-keyword">import</span> com.spire.doc.FileFormat;
<span class="hljs-keyword">import</span> com.spire.doc.TextWatermark;
<span class="hljs-keyword">import</span> com.spire.doc.documents.WatermarkLayout;
â€‹
<span class="hljs-keyword">import</span> java.awt.Color;
<span class="hljs-keyword">import</span> java.io.ByteArrayOutputStream;
<span class="hljs-keyword">import</span> java.io.InputStream;
â€‹
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DocWatermarkUtil</span> {
â€‹
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] addWatermarkToDoc(InputStream inputStream, String watermarkText) <span class="hljs-keyword">throws</span> Exception {
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>()) {
 Â  Â  Â  Â  Â  Â <span class="hljs-type">Document</span> <span class="hljs-variable">document</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>();
 Â  Â  Â  Â  Â  Â document.loadFromStream(inputStream, FileFormat.Doc);
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-type">TextWatermark</span> <span class="hljs-variable">watermark</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextWatermark</span>();
 Â  Â  Â  Â  Â  Â watermark.setText(watermarkText);
 Â  Â  Â  Â  Â  Â watermark.setFontSize(<span class="hljs-number">40</span>);
 Â  Â  Â  Â  Â  Â watermark.setColor(Color.lightGray);
 Â  Â  Â  Â  Â  Â watermark.setLayout(WatermarkLayout.Diagonal);
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (document.getSections().getCount() &gt; <span class="hljs-number">0</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â document.getSections().get(<span class="hljs-number">0</span>).getDocument().setWatermark(watermark);
 Â  Â  Â  Â  Â   } <span class="hljs-keyword">else</span> {
 Â  Â  Â  Â  Â  Â  Â  Â document.setWatermark(watermark);
 Â  Â  Â  Â  Â   }
â€‹
 Â  Â  Â  Â  Â  Â document.saveToStream(out, FileFormat.Doc);
 Â  Â  Â  Â  Â  Â document.close();
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> out.toByteArray();
 Â  Â  Â   }
 Â   }
}
</code></pre>
<hr/>
<h3 data-id="heading-7">6. å…³é”®ç‚¹ä¸å®è·µå»ºè®®</h3>
<ul>
<li>
<p><strong>æ°´å°æ–‡æœ¬è®¾è®¡</strong>ï¼šå¯ä»¥æ˜¯å›ºå®šæ–‡æ¡ˆï¼ˆå¦‚ã€Œxxå…¬å¸ã€ã€Œå†…éƒ¨èµ„æ–™ã€ï¼‰ï¼Œä¹Ÿå¯ä»¥ç»“åˆç”¨æˆ·åã€æ—¶é—´æˆ³ã€IP ç­‰ç”Ÿæˆä¸ªæ€§åŒ–æ°´å°ï¼Œä¾¿äºè¿½è´£å’Œé˜²æ³„éœ²ã€‚</p>
</li>
<li>
<p><strong>æŸ¥çœ‹æ¨¡å¼</strong>ï¼šWord ä¸­å»ºè®®ä½¿ç”¨ã€Œæ‰“å°å¸ƒå±€ã€æŸ¥çœ‹æ°´å°ï¼›åœ¨æŸäº›é˜…è¯»æ¨¡å¼ä¸‹æ°´å°å¯èƒ½è¢«éšè—ã€‚</p>
</li>
<li>
<p><strong>Free ç‰ˆæœ¬é™åˆ¶</strong>ï¼šSpire.Doc Free ç‰ˆå¯¹äºé¡µæ•°æˆ–åŠŸèƒ½æœ‰ä¸€å®šé™åˆ¶ï¼Œå¤§è§„æ¨¡ç”Ÿäº§ä½¿ç”¨æ—¶å»ºè®®è¯„ä¼°ä»˜è´¹ç‰ˆæœ¬æˆ–å…¶ä»–åº“ã€‚</p>
</li>
<li>
<p><strong>ä¸ä¸šåŠ¡é›†æˆ</strong>ï¼š</p>
<ul>
<li>ä¸Šä¼ æ–‡ä»¶æ—¶åœ¨å†™å…¥å­˜å‚¨ï¼ˆæœ¬åœ°/å¯¹è±¡å­˜å‚¨ï¼‰å‰å…ˆåŠ æ°´å°ï¼›</li>
<li>æˆ–åœ¨çº¿é¢„è§ˆ/ä¸‹è½½å‰ä¸´æ—¶ç”Ÿæˆå¸¦æ°´å°å‰¯æœ¬ï¼Œä¸æ”¹å˜åŸå§‹æ–‡ä»¶ï¼›</li>
<li>å¯ä»¥æŒ‰ç§Ÿæˆ·ã€ç”¨æˆ·çº§åˆ«é…ç½®ä¸åŒæ°´å°ç­–ç•¥ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šå¯¹äºå¤§ä½“ç§¯ Word æ–‡æ¡£ï¼Œå»ºè®®åœ¨åå°ä»»åŠ¡ä¸­è¿›è¡Œæ°´å°å¤„ç†ï¼Œé¿å…é˜»å¡åŒæ­¥æ¥å£ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-8">7. æ€»ç»“</h3>
<p>ä½¿ç”¨ Spire.Doc åœ¨ Java ä¸­ä¸º Word æ–‡æ¡£æ·»åŠ é¡µé¢æ–‡å­—æ°´å°ï¼Œæ ¸å¿ƒæ˜¯ï¼š<strong>åŠ è½½æ–‡æ¡£ â†’ æ„é€  TextWatermark â†’ é€šè¿‡ Section/Document è®¾ç½®æ°´å° â†’ ä»¥å¯¹åº”æ ¼å¼ä¿å­˜</strong>ã€‚ä¸Šè¿°ç¤ºä¾‹å°†è¾“å…¥è¾“å‡ºå°è£…ä¸º <code>InputStream/byte[]</code> æˆ–æ–‡ä»¶è·¯å¾„å½¢å¼ï¼Œæ–¹ä¾¿åœ¨ä¸Šä¼ ã€ä¸‹è½½æˆ–æ‰¹å¤„ç†åœºæ™¯ä¸­å¤ç”¨ï¼Œå®ç°å¯¹ DOC/DOCX æ–‡æ¡£çš„ç»Ÿä¸€æ°´å°æ§åˆ¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é€’å½’çˆ†ç‚¸åˆ°é—­åŒ…ä¼˜åŒ–ï¼šå½»åº•ææ‡‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„æ€§èƒ½æ¼”è¿›]]></title>    <link>https://juejin.cn/post/7602841282801729577</link>    <guid>https://juejin.cn/post/7602841282801729577</guid>    <pubDate>2026-02-04T10:54:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602841282801729577" data-draft-id="7602776926327570486" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é€’å½’çˆ†ç‚¸åˆ°é—­åŒ…ä¼˜åŒ–ï¼šå½»åº•ææ‡‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„æ€§èƒ½æ¼”è¿›"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,JavaScript"/> <meta itemprop="datePublished" content="2026-02-04T10:54:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="NEXT06"/> <meta itemprop="url" content="https://juejin.cn/user/1176918763246011"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é€’å½’çˆ†ç‚¸åˆ°é—­åŒ…ä¼˜åŒ–ï¼šå½»åº•ææ‡‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„æ€§èƒ½æ¼”è¿›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1176918763246011/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    NEXT06
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T10:54:39.000Z" title="Wed Feb 04 2026 10:54:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å‰ç«¯ç®—æ³•é¢è¯•ä¸­ï¼Œæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆFibonacci Sequenceï¼‰ä¸ä»…ä»…æ˜¯ä¸€é“è€ƒå¯Ÿé€’å½’é€»è¾‘çš„æ•°å­¦é¢˜ï¼Œæ›´æ˜¯ä¸€å—è€ƒå¯Ÿå€™é€‰äººå¯¹<strong>æ—¶é—´å¤æ‚åº¦</strong>ã€<strong>è®°å¿†åŒ–ï¼ˆMemoizationï¼‰<strong>ä»¥åŠ</strong>JavaScript é—­åŒ…æœºåˆ¶</strong>ç†è§£æ·±åº¦çš„è¯•é‡‘çŸ³ã€‚</p>
<p>æœ¬æ–‡å°†åŸºäºä¸€æ®µä»£ç çš„ä¸‰ä¸ªæ¼”è¿›ç‰ˆæœ¬ï¼Œå¸¦ä½ æ·±å…¥ç†è§£å¦‚ä½•å°†ä¸€ä¸ªÂ </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(<span class="hljs-number">2</span>n) -&gt;<span class="hljs-number">2</span>çš„næ¬¡æ–¹
</code></pre>
<p>Â çš„â€œç¾éš¾çº§â€ä»£ç ä¼˜åŒ–ä¸ºÂ </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(n)
</code></pre>
<p>Â çš„ç”Ÿäº§çº§ä»£ç ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ æ•°å­¦å®šä¹‰ä¸æš´åŠ›é€’å½’çš„é™·é˜±</h2>
<p>æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å®šä¹‰éå¸¸ç®€æ´ï¼šä» 0 å’Œ 1 å¼€å§‹ï¼Œåç»­æ¯ä¸€é¡¹éƒ½ç­‰äºå‰ä¸¤é¡¹ä¹‹å’Œã€‚<br/>
å³ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">f</span>(n)=<span class="hljs-built_in">f</span>(nâˆ’<span class="hljs-number">1</span>)+<span class="hljs-built_in">f</span>(nâˆ’<span class="hljs-number">2</span>)<span class="hljs-built_in">f</span>(n)=<span class="hljs-built_in">f</span>(nâˆ’<span class="hljs-number">1</span>)+<span class="hljs-built_in">f</span>(nâˆ’<span class="hljs-number">2</span>)
</code></pre>
<p>ã€‚</p>
<p>å°†è¿™ä¸ªå…¬å¼ç›´æ¥ç¿»è¯‘æˆä»£ç ï¼Œå°±æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„é€’å½’å†™æ³•ï¼š</p>
<p>JavaScript</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ç‰ˆæœ¬ 1ï¼šæš´åŠ›é€’å½’</span>
function <span class="hljs-built_in">fib</span>(n) {
    <span class="hljs-comment">// é€€å‡ºæ¡ä»¶</span>
    <span class="hljs-built_in">if</span>(n &lt;= <span class="hljs-number">1</span>){
        return n;
    }
    <span class="hljs-comment">// é€’å½’å…¬å¼</span>
    return <span class="hljs-built_in">fib</span>(n-<span class="hljs-number">1</span>) + <span class="hljs-built_in">fib</span>(n-<span class="hljs-number">2</span>);
}
</code></pre>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆè¿™ç§å†™æ³•åœ¨é¢è¯•ä¸­åªèƒ½å¾— 50 åˆ†ï¼Ÿ</h3>
<p>è™½ç„¶ä»£ç é€»è¾‘æ­£ç¡®ï¼Œä½†å®ƒå­˜åœ¨ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚å½“ä½ æ‰§è¡ŒÂ fib(10)Â æ—¶ï¼Œè®¡ç®—å¾ˆå¿«ï¼›ä½†ä¸€æ—¦å°è¯•Â fib(50)ï¼Œæµè§ˆå™¨å¯èƒ½ä¼šç›´æ¥å¡æ­»ã€‚</p>
<p>åŸå› æ˜¯<strong>å¤§é‡çš„é‡å¤è®¡ç®—</strong>ã€‚</p>
<p>ä¸ºäº†è®¡ç®—Â fib(5)ï¼Œç¨‹åºéœ€è¦è®¡ç®—Â fib(4)Â å’ŒÂ fib(3)ã€‚<br/>
è€Œåœ¨è®¡ç®—Â fib(4)Â æ—¶ï¼Œåˆéœ€è¦è®¡ç®—Â fib(3)Â å’ŒÂ fib(2)ã€‚<br/>
æ³¨æ„åˆ°äº†å—ï¼Ÿfib(3)Â è¢«é‡å¤è®¡ç®—äº†å¤šæ¬¡ã€‚éšç€Â nÂ çš„å¢åŠ ï¼Œè¿™ç§é‡å¤è®¡ç®—å‘ˆæŒ‡æ•°çº§çˆ†ç‚¸ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºÂ </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(<span class="hljs-number">2</span>n) -&gt;<span class="hljs-number">2</span>çš„næ¬¡æ–¹
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16bd392eb41b479d963a644e44f2990b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTkVYVDA2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770807279&amp;x-signature=f4n%2FtVt2Uma7z99Uy54%2BfmpmW%2FI%3D" alt="image.png" loading="lazy"/>
ã€‚</p>
<h2 data-id="heading-2">äºŒã€ æ ¸å¿ƒä¼˜åŒ–æ€æƒ³ï¼šç”¨ç©ºé—´æ¢æ—¶é—´</h2>
<p>æ—¢ç„¶ç“¶é¢ˆåœ¨äºâ€œé‡å¤è®¡ç®—â€ï¼Œè§£å†³æ€è·¯å°±æ˜¯ï¼š<strong>å‡¡æ˜¯ç®—è¿‡çš„ï¼Œéƒ½è®°ä¸‹æ¥</strong>ã€‚ä¸‹æ¬¡å†é‡åˆ°ç›¸åŒçš„å‚æ•°ï¼Œç›´æ¥è¯»å–ç»“æœï¼Œä¸å†é‡æ–°é€’å½’ã€‚è¿™å°±æ˜¯â€œè®°å¿†åŒ–ï¼ˆMemoizationï¼‰â€ã€‚</p>
<h3 data-id="heading-3">ä¼˜åŒ–ç¬¬ä¸€æ­¥ï¼šå¼•å…¥å…¨å±€ç¼“å­˜</h3>
<p>æˆ‘ä»¬å¯ä»¥å¼•å…¥ä¸€ä¸ªå¯¹è±¡ä½œä¸ºç¼“å­˜å®¹å™¨ï¼ˆHashMapï¼‰ï¼š</p>
<p>JavaScript</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ç‰ˆæœ¬ 2ï¼šå¤–éƒ¨ç¼“å­˜</span>
const cache = {}; <span class="hljs-comment">// ç”¨ç©ºé—´æ¢æ—¶é—´</span>

function <span class="hljs-built_in">fib</span>(n) {
    <span class="hljs-comment">// 1. å…ˆæŸ¥ç¼“å­˜</span>
    <span class="hljs-built_in">if</span>(n in cache){
        return cache<span class="hljs-selector-attr">[n]</span>;
    }
    <span class="hljs-comment">// 2. è¾¹ç•Œæ¡ä»¶</span>
    <span class="hljs-built_in">if</span>(n &lt;= <span class="hljs-number">1</span>){
        cache<span class="hljs-selector-attr">[n]</span> = n;
        return n;
    }
    <span class="hljs-comment">// 3. è®¡ç®—å¹¶å†™å…¥ç¼“å­˜</span>
    const result = <span class="hljs-built_in">fib</span>(n-<span class="hljs-number">1</span>) + <span class="hljs-built_in">fib</span>(n-<span class="hljs-number">2</span>);
    cache<span class="hljs-selector-attr">[n]</span> = result;
    return result;
}
</code></pre>
<p>é€šè¿‡å¼•å…¥Â cacheï¼Œæ¯ä¸ªæ•°å­—åªä¼šè¢«è®¡ç®—ä¸€æ¬¡ã€‚æ—¶é—´å¤æ‚åº¦ä»æŒ‡æ•°çº§Â </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(<span class="hljs-number">2</span>n) -&gt;<span class="hljs-number">2</span>çš„næ¬¡æ–¹
</code></pre>
<p>Â é™ç»´åˆ°äº†çº¿æ€§Â </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(n)
</code></pre>
<p>ã€‚è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ€§èƒ½é£è·ƒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8076794a6bd48289b8cc5b4da6c2afe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTkVYVDA2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770807279&amp;x-signature=gQsvdkrrQbov7pzqYQ7nDGNE3k0%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">ä¸‰ã€ è¿›é˜¶å®ç°ï¼šé—­åŒ…ä¸ IIFE çš„å®Œç¾ç»“åˆ</h2>
<p>ç‰ˆæœ¬ 2 è™½ç„¶è§£å†³äº†æ€§èƒ½é—®é¢˜ï¼Œä½†åœ¨å·¥ç¨‹ä¸Šæœ‰ä¸€ä¸ªè‡´å‘½ç¼ºé™·ï¼šcacheÂ å˜é‡å®šä¹‰åœ¨å‡½æ•°å¤–éƒ¨ï¼Œæ˜¯ä¸€ä¸ª<strong>å…¨å±€å˜é‡</strong>ï¼ˆæˆ–æ¨¡å—çº§å˜é‡ï¼‰ã€‚è¿™æ„å‘³ç€ä»»ä½•å¤–éƒ¨ä»£ç éƒ½å¯ä»¥ä¿®æ”¹å®ƒï¼Œå¯¼è‡´ç¨‹åºä¸å®‰å…¨ï¼Œä¸”æ±¡æŸ“äº†ä½œç”¨åŸŸã€‚</p>
<p>åœ¨ JavaScript ä¸­ï¼Œå®Œç¾çš„è§£å†³æ–¹æ¡ˆæ˜¯ç»“åˆÂ <strong>IIFEï¼ˆç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼‰</strong> Â å’ŒÂ <strong>é—­åŒ…ï¼ˆClosureï¼‰</strong> ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ç‰ˆæœ¬ 3ï¼šé—­åŒ…å°è£…</span>
const fib = (function() {
    <span class="hljs-comment">// é—­åŒ…å†…çš„ç§æœ‰å˜é‡ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®</span>
    const cache = {}; 
    
    <span class="hljs-comment">// è¿”å›å®é™…æ‰§è¡Œçš„å‡½æ•°</span>
    return <span class="hljs-built_in">function</span>(n) {
        <span class="hljs-built_in">if</span>(n in cache){
            return cache<span class="hljs-selector-attr">[n]</span>;
        }
        <span class="hljs-built_in">if</span>(n &lt;= <span class="hljs-number">1</span>){
            cache<span class="hljs-selector-attr">[n]</span> = n;
            return n;
        }
        <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œçš„ fib æŒ‡å‘çš„æ˜¯å¤–éƒ¨æ¥æ”¶ IIFE è¿”å›å€¼çš„é‚£ä¸ªå˜é‡</span>
        cache<span class="hljs-selector-attr">[n]</span> = <span class="hljs-built_in">fib</span>(n-<span class="hljs-number">1</span>) + <span class="hljs-built_in">fib</span>(n-<span class="hljs-number">2</span>);
        return cache<span class="hljs-selector-attr">[n]</span>;
    }
})()
</code></pre>
<h3 data-id="heading-5">ä»£ç è§£æ</h3>
<ol>
<li><strong>IIFEÂ (function(){...})()</strong> ï¼šå‡½æ•°å®šä¹‰åç«‹å³æ‰§è¡Œï¼Œåˆ›å»ºäº†ä¸€ä¸ªç‹¬ç«‹çš„ä½œç”¨åŸŸã€‚</li>
<li><strong>é—­åŒ…</strong>ï¼šIIFE è¿”å›çš„å†…éƒ¨å‡½æ•°å¼•ç”¨äº†å¤–å±‚ä½œç”¨åŸŸçš„Â cacheÂ å˜é‡ã€‚å³ä¾¿ IIFE æ‰§è¡Œå®Œæ¯•ï¼ŒcacheÂ ä¾ç„¶é©»ç•™åœ¨å†…å­˜ä¸­ï¼Œä¸ä¼šè¢«é”€æ¯ï¼Œä¹Ÿä¸ä¼šè¢«å¤–éƒ¨è®¿é—®ã€‚</li>
<li><strong>æ•°æ®æŒä¹…åŒ–</strong>ï¼šå½“ä½ å¤šæ¬¡è°ƒç”¨Â fib(10)ã€fib(20)Â æ—¶ï¼Œå®ƒä»¬å…±äº«åŒä¸€ä¸ªÂ cacheï¼Œè®¡ç®—è¿‡çš„ç»“æœå¯ä»¥è·¨å‡½æ•°è°ƒç”¨è¢«å¤ç”¨ã€‚</li>
</ol>
<p>è¿™ç§å†™æ³•ä¸ä»…å®ç°äº†æ€§èƒ½ä¼˜åŒ–ï¼Œè¿˜ä½“ç°äº†ä¼˜ç§€çš„ä»£ç å°è£…æ€æƒ³ï¼Œæ˜¯é¢è¯•ä¸­çš„é«˜åˆ†å›ç­”ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80f80e5742e84c6c977fb2b5c4caaaa9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTkVYVDA2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770807279&amp;x-signature=57iQneDuz5vGIADXzD9KAOS5cS8%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">å››ã€ é¢è¯•æ€»ç»“</h2>
<p>å½“é¢è¯•å®˜è®©ä½ æ‰‹å†™æ–æ³¢é‚£å¥‘æ•°åˆ—æ—¶ï¼Œå»ºè®®æŒ‰ç…§ä»¥ä¸‹é€»è¾‘å±•å¼€ï¼š</p>
<ol>
<li>
<p><strong>å…ˆå†™åŸºæœ¬è§£æ³•</strong>ï¼šå¿«é€Ÿå†™å‡ºé€’å½’ç‰ˆæœ¬ï¼Œå¹¶ä¸»åŠ¨æŒ‡å‡ºå…¶Â </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(<span class="hljs-number">2</span>n) -&gt;<span class="hljs-number">2</span>çš„næ¬¡æ–¹
</code></pre>
<p>Â çš„å¤æ‚åº¦é—®é¢˜å’Œçˆ†æ ˆé£é™©ã€‚</p>
</li>
<li>
<p><strong>æå‡ºä¼˜åŒ–æ–¹æ¡ˆ</strong>ï¼šé˜è¿°â€œç”¨ç©ºé—´æ¢æ—¶é—´â€çš„è®°å¿†åŒ–æ€æƒ³ã€‚</p>
</li>
<li>
<p><strong>å±•ç¤ºè¯­è¨€ç‰¹æ€§</strong>ï¼šä½¿ç”¨Â <strong>IIFE + é—­åŒ…</strong>Â çš„æ–¹å¼å®ç°è®°å¿†åŒ–å‡½æ•°ã€‚è¿™èƒ½å±•ç¤ºä½ å¯¹ JavaScript ä½œç”¨åŸŸé“¾å’Œé—­åŒ…æœºåˆ¶çš„æ·±åˆ»ç†è§£ã€‚</p>
</li>
<li>
<p><strong>æ‰©å±•æ€ç»´</strong>ï¼šå¦‚æœé¢è¯•å®˜è¿›ä¸€æ­¥è¿½é—®ï¼Œå¯ä»¥æåˆ°é€šç”¨è®°å¿†åŒ–å‡½æ•°ï¼ˆMemoize Helperï¼‰çš„ç¼–å†™ï¼Œæˆ–è€…æåˆ°ä½¿ç”¨è¿­ä»£ï¼ˆå¾ªç¯ï¼‰æ–¹å¼æ¥è¿›ä¸€æ­¥é¿å…é€’å½’æ·±åº¦çš„é™åˆ¶ã€‚</p>
</li>
</ol>
<p>æŒæ¡è¿™æ®µä»£ç çš„æ¼”è¿›è¿‡ç¨‹ï¼Œä¸ä»…æ˜¯ä¸ºäº†è§£å†³ä¸€é“ç®—æ³•é¢˜ï¼Œæ›´æ˜¯ä¸ºäº†æŒæ¡ JavaScript å‡½æ•°å¼ç¼–ç¨‹ä¸­â€œçŠ¶æ€ä¿æŒâ€çš„æ ¸å¿ƒæ¨¡å¼ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>