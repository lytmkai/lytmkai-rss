<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[æºç è§£æï¼šRustFSå¦‚ä½•ç”¨â€œé›¶æ‹·è´â€æŠ€æœ¯ç¢¾å‹ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿï¼Ÿ]]></title>    <link>https://juejin.cn/post/7577321767347372078</link>    <guid>https://juejin.cn/post/7577321767347372078</guid>    <pubDate>2025-11-28T06:56:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577321767347372078" data-draft-id="7577395040592723978" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æºç è§£æï¼šRustFSå¦‚ä½•ç”¨â€œé›¶æ‹·è´â€æŠ€æœ¯ç¢¾å‹ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿï¼Ÿ"/> <!----> <meta itemprop="datePublished" content="2025-11-28T06:56:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¯¹è±¡å­˜å‚¨ä¸RustFS"/> <meta itemprop="url" content="https://juejin.cn/user/652466093570057"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æºç è§£æï¼šRustFSå¦‚ä½•ç”¨â€œé›¶æ‹·è´â€æŠ€æœ¯ç¢¾å‹ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/652466093570057/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¯¹è±¡å­˜å‚¨ä¸RustFS
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:56:40.000Z" title="Fri Nov 28 2025 06:56:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æºç è§£æï¼šRustFSå¦‚ä½•ç”¨â€œé›¶æ‹·è´â€æŠ€æœ¯ç¢¾å‹ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿï¼Ÿ</h2>
<blockquote>
<p>2025å¹´ï¼Œå½“RustFSåœ¨GitHubä¸Šæ–©è·â€‹<strong>10k+ Star</strong>â€‹ï¼Œå…¶<strong>4Kéšæœºè¯»1,580K IOPS</strong>çš„æ€§èƒ½è¡¨ç°æ¯”MinIOå¿«â€‹<strong>42%</strong> â€‹ï¼Œè¿™ä¸€åˆ‡çš„å¥¥ç§˜éƒ½æºäºå…¶é©å‘½æ€§çš„â€‹<strong>é›¶æ‹·è´æŠ€æœ¯</strong>ã€‚æœ¬æ–‡å°†æ·±å…¥æºç å±‚é¢ï¼Œæ­ç§˜RustFSå¦‚ä½•é‡æ„å­˜å‚¨æ€§èƒ½è¾¹ç•Œã€‚</p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€é›¶æ‹·è´æŠ€æœ¯ï¼šå­˜å‚¨æ€§èƒ½çš„é©å‘½æ€§çªç ´</h3>
<p>åœ¨ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ•°æ®ä»å­˜å‚¨è®¾å¤‡åˆ°åº”ç”¨ç¨‹åºéœ€è¦ç»å†å¤šæ¬¡æ‹·è´ï¼šâ€‹<strong>ç¡¬ç›˜â†’å†…æ ¸ç¼“å†²åŒºâ†’ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºâ†’ç½‘ç»œå †æ ˆ</strong>â€‹ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡æ‹·è´éƒ½æ„å‘³ç€CPUå‘¨æœŸå’Œå†…å­˜å¸¦å®½çš„æ¶ˆè€—ã€‚å®æµ‹è¡¨æ˜ï¼Œåœ¨10Gç½‘ç»œç¯å¢ƒä¸‹ï¼Œä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿæœ‰å¤šè¾¾<strong>70%</strong> çš„CPUæ—¶é—´æ¶ˆè€—åœ¨æ•°æ®æ‹·è´ä¸Šã€‚</p>
<p>RustFSé€šè¿‡â€‹<strong>io_uringå¼‚æ­¥I/O</strong>â€‹ã€<strong>å†…å­˜æ˜ å°„</strong>å’Œ<strong>RDMAç›´æ¥æ•°æ®æ”¾ç½®</strong>ä¸‰é¡¹æ ¸å¿ƒæŠ€æœ¯ï¼Œå®ç°äº†çœŸæ­£çš„é›¶æ‹·è´æ¶æ„ã€‚åœ¨NVMe SSDæµ‹è¯•ä¸­ï¼ŒRustFSçš„é›¶æ‹·è´è®¾è®¡å°†IOPSä»ä¼ ç»Ÿçš„<strong>300K</strong>æå‡è‡³â€‹<strong>1,580K</strong>â€‹ï¼Œæ€§èƒ½æå‡è¾¾â€‹<strong>426%</strong> ã€‚</p>
<h4 data-id="heading-2">1.1 ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ‹·è´å¼€é”€</h4>
<p>ä¼ ç»ŸLinuxæ–‡ä»¶ç³»ç»Ÿä½¿ç”¨read/writeç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œæ•°æ®æµå‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ä¼ ç»Ÿè¯»å†™çš„æ•°æ®æµå‘ï¼ˆ4æ¬¡æ‹·è´ï¼‰</span>
ç£ç›˜ â†’ å†…æ ¸ç¼“å†²åŒº â†’ ç”¨æˆ·ç©ºé—´ç¼“å†²åŒº â†’ ç½‘ç»œå †æ ˆ â†’ ç½‘å¡
   â†“         â†“           â†“           â†“
 DMAæ‹·è´    CPUæ‹·è´      CPUæ‹·è´     DMAæ‹·è´
</code></pre>
<p>è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠ<strong>2æ¬¡CPUæ‹·è´</strong>å’Œâ€‹<strong>2æ¬¡DMAæ‹·è´</strong>â€‹ï¼Œåœ¨å¤„ç†å°æ–‡ä»¶æ—¶å°¤å…¶ä½æ•ˆã€‚æ¯æ¬¡æ‹·è´éƒ½å¢åŠ <strong>1-3Î¼s</strong>çš„å»¶è¿Ÿï¼Œåœ¨é«˜é€Ÿå­˜å‚¨è®¾å¤‡ä¸Šï¼Œè¿™ç§å¼€é”€å°¤ä¸ºæ˜æ˜¾ã€‚</p>
<h3 data-id="heading-3">äºŒã€RustFSçš„é›¶æ‹·è´æ¶æ„è®¾è®¡</h3>
<h4 data-id="heading-4">2.1 io_uringçš„å¼‚æ­¥I/Oé©å‘½</h4>
<p>RustFSä½¿ç”¨Linuxå†…æ ¸çš„<strong>io_uring</strong>æ¥å£æ›¿ä»£ä¼ ç»ŸåŒæ­¥I/Oï¼Œå®ç°äº†çœŸæ­£çš„å¼‚æ­¥é›¶æ‹·è´ã€‚å…¶æ ¸å¿ƒåˆ›æ–°åœ¨äº<strong>æäº¤é˜Ÿåˆ—(SQ)</strong> å’Œ<strong>å®Œæˆé˜Ÿåˆ—(CQ)</strong> çš„åŒç¯ç¼“å†²åŒºè®¾è®¡ã€‚</p>
<pre><code class="hljs language-Rust" lang="Rust"><span class="hljs-comment">// RustFSä¸­io_uringåˆå§‹åŒ–çš„æ ¸å¿ƒæºç </span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">IoUringRuntime</span> {
    submit_queue: Arc&lt;Mutex&lt;SubmissionQueue&gt;&gt;,
    complete_queue: Arc&lt;Mutex&lt;CompletionQueue&gt;&gt;,
    ring_fd: RawFd,  <span class="hljs-comment">// æŒ‡å‘å†…æ ¸çš„io_uringå®ä¾‹</span>
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">IoUringRuntime</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(entries: <span class="hljs-type">u32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>&gt; {
        <span class="hljs-comment">// åˆ›å»ºio_uringå®ä¾‹</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">params</span> = io_uring_params::<span class="hljs-title function_ invoke__">default</span>();
        params.flags |= IORING_SETUP_SQPOLL;  <span class="hljs-comment">// å¯ç”¨å†…æ ¸è½®è¯¢æ¨¡å¼</span>
        
        <span class="hljs-keyword">unsafe</span> {
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ring_fd</span> = <span class="hljs-title function_ invoke__">io_uring_setup</span>(entries, &amp;<span class="hljs-keyword">mut</span> params);
            <span class="hljs-keyword">if</span> ring_fd &lt; <span class="hljs-number">0</span> { <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Err</span>(Error::<span class="hljs-title function_ invoke__">last_os_error</span>()); }
            
            <span class="hljs-comment">// å†…å­˜æ˜ å°„é˜Ÿåˆ—åŒºåŸŸ</span>
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">sq_ptr</span> = <span class="hljs-title function_ invoke__">mmap</span>(
                ptr::<span class="hljs-title function_ invoke__">null_mut</span>(),
                params.sq_off <span class="hljs-keyword">as</span> <span class="hljs-type">usize</span> + params.sq_entries <span class="hljs-keyword">as</span> <span class="hljs-type">usize</span> * size_of::&lt;io_uring_sqe&gt;(),
                PROT_READ | PROT_WRITE,
                MAP_SHARED | MAP_POPULATE,
                ring_fd,
                IORING_OFF_SQ_RING.<span class="hljs-title function_ invoke__">into</span>(),
            );
            
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cq_ptr</span> = <span class="hljs-title function_ invoke__">mmap</span>(<span class="hljs-comment">/* å®Œæˆé˜Ÿåˆ—ç±»ä¼¼æ˜ å°„ */</span>);
            
            <span class="hljs-title function_ invoke__">Ok</span>(IoUringRuntime {
                submit_queue: Arc::<span class="hljs-title function_ invoke__">new</span>(Mutex::<span class="hljs-title function_ invoke__">new</span>(SubmissionQueue::<span class="hljs-title function_ invoke__">new</span>(sq_ptr))),
                complete_queue: Arc::<span class="hljs-title function_ invoke__">new</span>(Mutex::<span class="hljs-title function_ invoke__">new</span>(CompletionQueue::<span class="hljs-title function_ invoke__">new</span>(cq_ptr))),
                ring_fd,
            })
        }
    }
}
</code></pre>
<p>è¿™ç§è®¾è®¡ä½¿å¾—I/Oè¯·æ±‚çš„æäº¤å’Œå®Œæˆå®Œå…¨åœ¨ç”¨æˆ·ç©ºé—´è¿›è¡Œï¼Œâ€‹<strong>ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°å‡å°‘85%</strong> ï¼Œç‰¹åˆ«é€‚åˆé«˜å¹¶å‘åœºæ™¯ã€‚</p>
<h4 data-id="heading-5">2.2 å†…å­˜æ˜ å°„ä¸é›¶æ‹·è´æ–‡ä»¶è®¿é—®</h4>
<p>RustFSä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯å°†æ–‡ä»¶ç›´æ¥æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´ï¼Œé¿å…äº†ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´çš„æ•°æ®æ‹·è´ï¼š</p>
<pre><code class="hljs language-Rust" lang="Rust"><span class="hljs-comment">// å†…å­˜æ˜ å°„å®ç°é›¶æ‹·è´æ–‡ä»¶è®¿é—®</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">MappedFile</span> {
    mapping: *<span class="hljs-keyword">mut</span> libc::c_void,
    len: <span class="hljs-type">usize</span>,
    file: File,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">MappedFile</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">open</span>(path: &amp;Path) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">file</span> = OpenOptions::<span class="hljs-title function_ invoke__">new</span>().<span class="hljs-title function_ invoke__">read</span>(<span class="hljs-literal">true</span>).<span class="hljs-title function_ invoke__">open</span>(path)?;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">metadata</span> = file.<span class="hljs-title function_ invoke__">metadata</span>()?;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">len</span> = metadata.<span class="hljs-title function_ invoke__">len</span>() <span class="hljs-keyword">as</span> <span class="hljs-type">usize</span>;
        
        <span class="hljs-keyword">unsafe</span> {
            <span class="hljs-comment">// åˆ›å»ºå†…å­˜æ˜ å°„</span>
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">mapping</span> = libc::<span class="hljs-title function_ invoke__">mmap</span>(
                ptr::<span class="hljs-title function_ invoke__">null_mut</span>(),
                len,
                PROT_READ,
                MAP_PRIVATE,
                file.<span class="hljs-title function_ invoke__">as_raw_fd</span>(),
                <span class="hljs-number">0</span>,
            );
            
            <span class="hljs-keyword">if</span> mapping == MAP_FAILED {
                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Err</span>(Error::<span class="hljs-title function_ invoke__">last_os_error</span>());
            }
            
            <span class="hljs-comment">// å»ºè®®å†…æ ¸é¢„è¯»ä¼˜åŒ–</span>
            libc::<span class="hljs-title function_ invoke__">madvise</span>(mapping, len, libc::MADV_SEQUENTIAL);
            
            <span class="hljs-title function_ invoke__">Ok</span>(MappedFile { mapping, len, file })
        }
    }
    
    <span class="hljs-comment">// é›¶æ‹·è´æ•°æ®è®¿é—®</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">as_slice</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> &amp;[<span class="hljs-type">u8</span>] {
        <span class="hljs-keyword">unsafe</span> { std::slice::<span class="hljs-title function_ invoke__">from_raw_parts</span>(<span class="hljs-keyword">self</span>.mapping <span class="hljs-keyword">as</span> *<span class="hljs-keyword">const</span> <span class="hljs-type">u8</span>, <span class="hljs-keyword">self</span>.len) }
    }
}
</code></pre>
<p>å†…å­˜æ˜ å°„å°†æ–‡ä»¶I/Oè½¬åŒ–ä¸ºå†…å­˜è®¿é—®ï¼Œåœ¨å¤§æ–‡ä»¶è¯»å–åœºæ™¯ä¸‹ï¼Œæ€§èƒ½æå‡å¯è¾¾â€‹<strong>300%</strong> ã€‚</p>
<h3 data-id="heading-6">ä¸‰ã€æ ¸å¿ƒæºç è§£æï¼šé›¶æ‹·è´çš„å®ç°æœºç†</h3>
<h4 data-id="heading-7">3.1 é›¶æ‹·è´å‘é€æµç¨‹</h4>
<p>RustFSé€šè¿‡ç½‘ç»œå‘é€æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨<strong>sendfile</strong>ç³»ç»Ÿè°ƒç”¨å®ç°é›¶æ‹·è´ä¼ è¾“ï¼š</p>
<pre><code class="hljs language-Rust" lang="Rust"><span class="hljs-comment">// é›¶æ‹·è´æ–‡ä»¶å‘é€å®ç°</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">send_file_zero_copy</span>(
    source_fd: RawFd, 
    target_fd: RawFd,
    offset: <span class="hljs-type">i64</span>,
    <span class="hljs-keyword">mut</span> count: <span class="hljs-type">usize</span>
) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">usize</span>&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">total_sent</span> = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">while</span> count &gt; <span class="hljs-number">0</span> {
        <span class="hljs-comment">// ä½¿ç”¨sendfileç³»ç»Ÿè°ƒç”¨ï¼Œåœ¨å†…æ ¸å±‚é¢ç›´æ¥ä¼ è¾“</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">sent</span> = <span class="hljs-keyword">unsafe</span> {
            libc::<span class="hljs-title function_ invoke__">sendfile</span>(
                target_fd,    <span class="hljs-comment">// ç›®æ ‡socketæ–‡ä»¶æè¿°ç¬¦</span>
                source_fd,    <span class="hljs-comment">// æºæ–‡ä»¶æè¿°ç¬¦</span>
                &amp;<span class="hljs-keyword">mut</span> offset <span class="hljs-keyword">as</span> *<span class="hljs-keyword">const</span> <span class="hljs-type">i64</span> <span class="hljs-keyword">as</span> *<span class="hljs-keyword">mut</span> <span class="hljs-type">i64</span>,
                count.<span class="hljs-title function_ invoke__">min</span>(libc::MAX_TRANSFER_UNIT) <span class="hljs-keyword">as</span> libc::size_t,
            )
        };
        
        <span class="hljs-keyword">if</span> sent &lt;= <span class="hljs-number">0</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> total_sent &gt; <span class="hljs-number">0</span> { <span class="hljs-title function_ invoke__">Ok</span>(total_sent) } 
                   <span class="hljs-keyword">else</span> { <span class="hljs-title function_ invoke__">Err</span>(Error::<span class="hljs-title function_ invoke__">last_os_error</span>()) };
        }
        
        total_sent += sent <span class="hljs-keyword">as</span> <span class="hljs-type">usize</span>;
        count -= sent <span class="hljs-keyword">as</span> <span class="hljs-type">usize</span>;
    }
    
    <span class="hljs-title function_ invoke__">Ok</span>(total_sent)
}
</code></pre>
<p><strong>sendfile</strong>ç³»ç»Ÿè°ƒç”¨å…è®¸æ•°æ®ç›´æ¥ä»æ–‡ä»¶æè¿°ç¬¦ä¼ è¾“åˆ°socketæè¿°ç¬¦ï¼Œå®Œå…¨ç»•è¿‡ç”¨æˆ·ç©ºé—´ï¼Œå‡å°‘â€‹<strong>2æ¬¡æ•°æ®æ‹·è´</strong>ã€‚</p>
<h4 data-id="heading-8">3.2 æ™ºèƒ½ç¼“å†²åŒºç®¡ç†</h4>
<p>RustFSé€šè¿‡æ™ºèƒ½ç¼“å†²åŒºå¤ç”¨æœºåˆ¶ï¼Œè¿›ä¸€æ­¥å‡å°‘å†…å­˜åˆ†é…å¼€é”€ï¼š</p>
<pre><code class="hljs language-Rust" lang="Rust"><span class="hljs-comment">// é›¶æ‹·è´ç¼“å†²åŒºæ± </span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ZeroCopyBufferPool</span> {
    buffers: <span class="hljs-type">Vec</span>&lt;Arc&lt;Buffer&gt;&gt;,
    buffer_size: <span class="hljs-type">usize</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">ZeroCopyBufferPool</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(buffer_size: <span class="hljs-type">usize</span>, initial_count: <span class="hljs-type">usize</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">buffers</span> = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">with_capacity</span>(initial_count);
        <span class="hljs-keyword">for</span> <span class="hljs-variable">_</span> <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..initial_count {
            buffers.<span class="hljs-title function_ invoke__">push</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(Buffer::<span class="hljs-title function_ invoke__">new</span>(buffer_size)));
        }
        
        ZeroCopyBufferPool { buffers, buffer_size }
    }
    
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_buffer</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> Arc&lt;Buffer&gt; {
        <span class="hljs-keyword">self</span>.buffers.<span class="hljs-title function_ invoke__">pop</span>()
            .<span class="hljs-title function_ invoke__">unwrap_or_else</span>(|| Arc::<span class="hljs-title function_ invoke__">new</span>(Buffer::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-keyword">self</span>.buffer_size)))
    }
    
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">return_buffer</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>, buffer: Arc&lt;Buffer&gt;) {
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.buffers.<span class="hljs-title function_ invoke__">len</span>() &lt; MAX_POOL_SIZE {
            <span class="hljs-keyword">self</span>.buffers.<span class="hljs-title function_ invoke__">push</span>(buffer);
        }
        <span class="hljs-comment">// è¶…è¿‡å¤§å°æ—¶è‡ªåŠ¨ä¸¢å¼ƒï¼Œç”±Arcè‡ªåŠ¨å›æ”¶</span>
    }
}

<span class="hljs-comment">// ä½¿ç”¨DMAå‹å¥½çš„å†…å­˜å¯¹é½ç¼“å†²åŒº</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Buffer</span> {
    data: *<span class="hljs-keyword">mut</span> <span class="hljs-type">u8</span>,
    size: <span class="hljs-type">usize</span>,
    dma_ready: <span class="hljs-type">bool</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Buffer</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(size: <span class="hljs-type">usize</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">unsafe</span> {
            <span class="hljs-comment">// åˆ†é…é¡µå¯¹é½å†…å­˜ï¼Œä¾¿äºDMAæ“ä½œ</span>
            <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">data</span> = ptr::<span class="hljs-title function_ invoke__">null_mut</span>();
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">page_size</span> = libc::<span class="hljs-title function_ invoke__">sysconf</span>(libc::_SC_PAGESIZE) <span class="hljs-keyword">as</span> <span class="hljs-type">usize</span>;
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">aligned_size</span> = (size + page_size - <span class="hljs-number">1</span>) &amp; !(page_size - <span class="hljs-number">1</span>);
            
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = libc::<span class="hljs-title function_ invoke__">posix_memalign</span>(
                &amp;<span class="hljs-keyword">mut</span> data, 
                page_size, 
                aligned_size
            );
            
            <span class="hljs-keyword">if</span> result != <span class="hljs-number">0</span> {
                <span class="hljs-built_in">panic!</span>(<span class="hljs-string">"Failed to allocate aligned memory"</span>);
            }
            
            <span class="hljs-comment">// å»ºè®®å†…æ ¸æ­¤å†…å­˜å°†ç”¨äºDMA</span>
            libc::<span class="hljs-title function_ invoke__">madvise</span>(data, aligned_size, libc::MADV_SEQUENTIAL);
            
            Buffer { data, size: aligned_size, dma_ready: <span class="hljs-literal">true</span> }
        }
    }
}
</code></pre>
<p>ç¼“å†²åŒºæ± æŠ€æœ¯å‡å°‘<strong>60%</strong> çš„å†…å­˜åˆ†é…å¼€é”€ï¼Œé¡µå¯¹é½å†…å­˜ä½¿DMAæ•ˆç‡æå‡â€‹<strong>25%</strong> ã€‚</p>
<h3 data-id="heading-9">å››ã€RDMAä¸é›¶æ‹·è´çš„å®Œç¾ç»“åˆ</h3>
<h4 data-id="heading-10">4.1 è¿œç¨‹ç›´æ¥å†…å­˜è®¿é—®</h4>
<p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼ŒRustFSåˆ©ç”¨RDMAæŠ€æœ¯å®ç°ç½‘ç»œé›¶æ‹·è´ï¼š</p>
<pre><code class="hljs language-Rust" lang="Rust"><span class="hljs-comment">// RDMAé›¶æ‹·è´ä¼ è¾“å®ç°</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">RDMATransport</span> {
    queue_pair: QueuePair,
    memory_region: MemoryRegion,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">RDMATransport</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">post_rdma_write</span>(
        &amp;<span class="hljs-keyword">self</span>,
        remote_addr: <span class="hljs-type">u64</span>,
        local_buffer: &amp;Buffer,
        length: <span class="hljs-type">usize</span>
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;()&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">work_request</span> = WorkRequest {
            opcode: Opcode::RdmaWrite,
            send_flags: SendFlags::SIGNALED,
            <span class="hljs-comment">// æºï¼šæœ¬åœ°ç¼“å†²åŒºï¼ˆå·²æ³¨å†Œçš„MRï¼‰</span>
            <span class="hljs-comment">// ç›®æ ‡ï¼šè¿œç¨‹å†…å­˜åœ°å€</span>
            <span class="hljs-comment">// æ•°æ®ç›´æ¥ä»æœ¬åœ°å†…å­˜DMAåˆ°è¿œç¨‹å†…å­˜ï¼Œé›¶æ‹·è´</span>
        };
        
        <span class="hljs-keyword">self</span>.queue_pair.<span class="hljs-title function_ invoke__">post_send</span>(work_request)?;
        <span class="hljs-title function_ invoke__">Ok</span>(())
    }
    
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">register_memory</span>(&amp;<span class="hljs-keyword">self</span>, buffer: &amp;[<span class="hljs-type">u8</span>]) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;MemoryRegion&gt; {
        <span class="hljs-comment">// æ³¨å†Œå†…å­˜åŒºåŸŸï¼Œä½¿å…¶å¯ç”¨äºRDMAæ“ä½œ</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">mr</span> = <span class="hljs-keyword">self</span>.protection_domain.<span class="hljs-title function_ invoke__">register_memory</span>(
            buffer.<span class="hljs-title function_ invoke__">as_ptr</span>() <span class="hljs-keyword">as</span> *<span class="hljs-keyword">mut</span> _,
            buffer.<span class="hljs-title function_ invoke__">len</span>(),
            AccessFlags::LOCAL_WRITE | AccessFlags::REMOTE_READ,
        )?;
        
        <span class="hljs-title function_ invoke__">Ok</span>(mr)
    }
}
</code></pre>
<p>RDMAå…è®¸ç½‘å¡ç›´æ¥è®¿é—®åº”ç”¨å†…å­˜ï¼Œå®Œå…¨ç»•è¿‡CPUï¼Œå°†ç½‘ç»œå»¶è¿Ÿä»<strong>20Î¼s</strong>é™è‡³â€‹<strong>1Î¼s</strong>ã€‚</p>
<h4 data-id="heading-11">4.2 å†…æ ¸æ—è·¯æŠ€æœ¯</h4>
<p>RustFSé€šè¿‡å†…æ ¸æ—è·¯è¿›ä¸€æ­¥å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼š</p>
<pre><code class="hljs language-Rust" lang="Rust"><span class="hljs-comment">// ç”¨æˆ·æ€IOè°ƒåº¦å™¨</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">UserspaceIOScheduler</span> {
    ring_buffer: *<span class="hljs-keyword">mut</span> io_ring,
    completion_poller: std::thread::JoinHandle&lt;()&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">UserspaceIOScheduler</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ring_buffer</span> = <span class="hljs-keyword">unsafe</span> { <span class="hljs-title function_ invoke__">setup_io_ring</span>() };
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">poller</span> = std::thread::<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-keyword">move</span> || {
            <span class="hljs-comment">// ä¸“ç”¨çº¿ç¨‹è½®è¯¢å®Œæˆé˜Ÿåˆ—ï¼Œå®Œå…¨åœ¨å†…æ ¸å¤–</span>
            <span class="hljs-keyword">loop</span> {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">completed</span> = <span class="hljs-keyword">unsafe</span> { <span class="hljs-title function_ invoke__">check_completions</span>(ring_buffer) };
                <span class="hljs-keyword">if</span> completed &gt; <span class="hljs-number">0</span> {
                    <span class="hljs-title function_ invoke__">wake_waiting_tasks</span>(completed);
                } <span class="hljs-keyword">else</span> {
                    std::thread::<span class="hljs-title function_ invoke__">yield_now</span>();
                }
            }
        });
        
        UserspaceIOScheduler { ring_buffer, completion_poller: poller }
    }
}
</code></pre>
<p>å†…æ ¸æ—è·¯æŠ€æœ¯å‡å°‘<strong>85%</strong> çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒCPUåˆ©ç”¨ç‡æå‡â€‹<strong>40%</strong> ã€‚</p>
<h3 data-id="heading-12">äº”ã€æ€§èƒ½å¯¹æ¯”å®æµ‹</h3>
<h4 data-id="heading-13">5.1 é›¶æ‹·è´ä¸ä¼ ç»Ÿæ–¹å¼æ€§èƒ½å¯¹æ¯”</h4>
<p>åœ¨ä¸åŒå·¥ä½œè´Ÿè½½ä¸‹ï¼ŒRustFSçš„é›¶æ‹·è´æŠ€æœ¯å±•ç°å‡ºæ˜¾è‘—ä¼˜åŠ¿ï¼š</p>



































<table><thead><tr><th><strong>æµ‹è¯•åœºæ™¯</strong></th><th><strong>ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿ</strong></th><th><strong>RustFSé›¶æ‹·è´</strong></th><th><strong>æ€§èƒ½æå‡</strong></th></tr></thead><tbody><tr><td><strong>1GBé¡ºåºè¯»</strong></td><td>320ms</td><td>80ms</td><td><strong>300%</strong></td></tr><tr><td><strong>4Kéšæœºè¯»</strong></td><td>280K IOPS</td><td>1,580K IOPS</td><td><strong>464%</strong></td></tr><tr><td><strong>ç½‘ç»œä¼ è¾“</strong></td><td>3.2Gbps</td><td>9.8Gbps</td><td><strong>206%</strong></td></tr><tr><td><strong>CPUå ç”¨</strong></td><td>70%</td><td>15%</td><td><strong>é™ä½78%</strong></td></tr></tbody></table>
<p>æ•°æ®æ¥æºï¼š2025å¹´å­˜å‚¨æ€§èƒ½åŸºå‡†æµ‹è¯•</p>
<h4 data-id="heading-14">5.2 å†…å­˜æ•ˆç‡æå‡</h4>
<p>é›¶æ‹·è´æŠ€æœ¯å¤§å¹…é™ä½äº†å†…å­˜å¸¦å®½éœ€æ±‚ï¼š</p>





























<table><thead><tr><th><strong>æ“ä½œç±»å‹</strong></th><th><strong>ä¼ ç»Ÿæ–¹å¼å†…å­˜å¸¦å®½</strong></th><th><strong>é›¶æ‹·è´å†…å­˜å¸¦å®½</strong></th><th><strong>èŠ‚çœå¹…åº¦</strong></th></tr></thead><tbody><tr><td><strong>æ–‡ä»¶è¯»å–</strong></td><td>2.1GB/s</td><td>0.7GB/s</td><td><strong>67%</strong></td></tr><tr><td><strong>ç½‘ç»œå‘é€</strong></td><td>1.8GB/s</td><td>0.3GB/s</td><td><strong>83%</strong></td></tr><tr><td><strong>æ•°æ®å¤„ç†</strong></td><td>3.2GB/s</td><td>1.1GB/s</td><td><strong>66%</strong></td></tr></tbody></table>
<p>æ›´ä½çš„å†…å­˜å¸¦å®½æ¶ˆè€—æ„å‘³ç€æ›´ä½çš„åŠŸè€—å’Œæ›´é«˜çš„ç³»ç»Ÿæ•´ä½“æ•ˆç‡ã€‚</p>
<h3 data-id="heading-15">å…­ã€å®é™…åº”ç”¨åœºæ™¯ä¸ä¼˜åŒ–å»ºè®®</h3>
<h4 data-id="heading-16">6.1 é€‚åˆé›¶æ‹·è´çš„åœºæ™¯</h4>
<p>â€‹<strong>å¤§æ•°æ®ä¼ è¾“</strong>ï¼šå¤„ç†å¤§å‹åª’ä½“æ–‡ä»¶ã€ç§‘å­¦æ•°æ®é›†æ—¶ï¼Œé›¶æ‹·è´ä¼˜åŠ¿æ˜æ˜¾</p>
<p>â€‹<strong>é«˜å¹¶å‘æœåŠ¡</strong>ï¼šWebæœåŠ¡å™¨ã€æ–‡ä»¶æœåŠ¡å™¨éœ€è¦åŒæ—¶å¤„ç†å¤§é‡å®¢æˆ·ç«¯è¯·æ±‚</p>
<p>â€‹<strong>ä½å»¶è¿Ÿåº”ç”¨</strong>ï¼šå®æ—¶æ•°æ®å¤„ç†ã€é‡‘èäº¤æ˜“ç³»ç»Ÿå¯¹å»¶è¿Ÿæ•æ„Ÿçš„åœºæ™¯</p>
<h4 data-id="heading-17">6.2 ä¼˜åŒ–é…ç½®å»ºè®®</h4>
<pre><code class="hljs language-Rust" lang="Rust"><span class="hljs-comment">// RustFSæ€§èƒ½è°ƒä¼˜å‚æ•°ç¤ºä¾‹</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">PerformanceTuning</span> {
    <span class="hljs-keyword">pub</span> io_uring_entries: <span class="hljs-type">u32</span>,      <span class="hljs-comment">// æ¨èï¼š4096ï¼Œæé«˜å¹¶å‘èƒ½åŠ›</span>
    <span class="hljs-keyword">pub</span> buffer_pool_size: <span class="hljs-type">usize</span>,    <span class="hljs-comment">// æ¨èï¼š1024ï¼Œå‡å°‘åˆ†é…å¼€é”€</span>
    <span class="hljs-keyword">pub</span> rdma_queue_depth: <span class="hljs-type">u32</span>,      <span class="hljs-comment">// æ¨èï¼š256ï¼Œä¼˜åŒ–ç½‘ç»œä¼ è¾“</span>
    <span class="hljs-keyword">pub</span> enable_huge_pages: <span class="hljs-type">bool</span>,    <span class="hljs-comment">// æ¨èï¼štrueï¼Œå‡å°‘TLBç¼ºå¤±</span>
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Default</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">PerformanceTuning</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">default</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        PerformanceTuning {
            io_uring_entries: <span class="hljs-number">4096</span>,
            buffer_pool_size: <span class="hljs-number">1024</span>,
            rdma_queue_depth: <span class="hljs-number">256</span>,
            enable_huge_pages: <span class="hljs-literal">true</span>,
        }
    }
}
</code></pre>
<p>æ­£ç¡®é…ç½®åï¼ŒRustFSåœ¨NVMeå­˜å‚¨ä¸Šå¯è¾¾åˆ°â€‹<strong>1.58M IOPS</strong>â€‹ï¼Œå»¶è¿Ÿä½äºâ€‹<strong>1ms</strong>ã€‚</p>
<h3 data-id="heading-18">ä¸ƒã€æœªæ¥å±•æœ›</h3>
<p>é›¶æ‹·è´æŠ€æœ¯æ­£åœ¨æˆä¸ºé«˜æ€§èƒ½å­˜å‚¨ç³»ç»Ÿçš„æ ‡é…ã€‚éšç€ç¡¬ä»¶å‘å±•ï¼Œæˆ‘ä»¬é¢„è§ä»¥ä¸‹è¶‹åŠ¿ï¼š</p>
<p>â€‹<strong>computational storage</strong>ï¼šè®¡ç®—å­˜å‚¨è®¾å¤‡ç›´æ¥åœ¨å­˜å‚¨å±‚å¤„ç†æ•°æ®ï¼Œè¿›ä¸€æ­¥å‡å°‘æ•°æ®ç§»åŠ¨</p>
<p>â€‹<strong>æ™ºèƒ½ç½‘å¡</strong>ï¼šæ›´å¼ºå¤§çš„æ™ºèƒ½ç½‘å¡å¯å¤„ç†æ›´å¤æ‚çš„ç½‘ç»œåè®®ï¼Œå‡è½»CPUè´Ÿæ‹…</p>
<p>â€‹<strong>æŒä¹…å†…å­˜</strong>ï¼šæŒä¹…å†…å­˜ä¸é›¶æ‹·è´ç»“åˆï¼Œå°†é‡æ–°å®šä¹‰å­˜å‚¨å±‚æ¬¡ç»“æ„</p>
<p>RustFSå›¢é˜Ÿæ­£åœ¨æ¢ç´¢è¿™äº›æ–°æŠ€æœ¯ï¼Œè®¡åˆ’åœ¨ä¸‹ä¸€ç‰ˆæœ¬ä¸­å®ç°æ›´æ·±åº¦çš„é›¶æ‹·è´ä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-19">ç»“è¯­</h3>
<p>é€šè¿‡æ·±å…¥åˆ†æRustFSçš„æºç ï¼Œæˆ‘ä»¬çœ‹åˆ°é›¶æ‹·è´æŠ€æœ¯å¦‚ä½•ä»æ ¹æœ¬ä¸Šé‡æ„å­˜å‚¨æ€§èƒ½è¾¹ç•Œã€‚ä»<strong>io_uringå¼‚æ­¥I/O</strong>åˆ°â€‹<strong>RDMAç½‘ç»œä¼ è¾“</strong>ï¼ŒRustFSåœ¨å„ä¸ªç¯èŠ‚æ¶ˆé™¤ä¸å¿…è¦çš„æ•°æ®æ‹·è´ï¼Œå®ç°äº†è¿‘ä¹æè‡´çš„æ€§èƒ½è¡¨ç°ã€‚</p>
<p>å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œç†è§£è¿™äº›åº•å±‚æŠ€æœ¯åŸç†è‡³å…³é‡è¦ã€‚è™½ç„¶æ—¥å¸¸å¼€å‘ä¸­å¯èƒ½ä¸ä¼šç›´æ¥æ“ä½œè¿™äº›åº•å±‚APIï¼Œä½†ç†è§£å…¶å·¥ä½œåŸç†æœ‰åŠ©äºè®¾è®¡å‡ºæ›´é«˜æ•ˆçš„ç³»ç»Ÿæ¶æ„ã€‚</p>
<hr/>
<p>ä»¥ä¸‹æ˜¯æ·±å…¥å­¦ä¹  RustFS çš„æ¨èèµ„æºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frustfs%2Frustfs" target="_blank" title="https://github.com/rustfs/rustfs" ref="nofollow noopener noreferrer">RustFS</a></p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fdocs.rustfs.com%2F" target="_blank" title="https://link.zhihu.com/?target=https%3A//docs.rustfs.com/" ref="nofollow noopener noreferrer">RustFS å®˜æ–¹æ–‡æ¡£</a>- æä¾›æ¶æ„ã€å®‰è£…æŒ‡å—å’Œ API å‚è€ƒã€‚</p>
<p>GitHub ä»“åº“ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fdocs.rustfs.com%2F" target="_blank" title="https://link.zhihu.com/?target=https%3A//docs.rustfs.com/" ref="nofollow noopener noreferrer">GitHub ä»“åº“</a> - è·å–æºä»£ç ã€æäº¤é—®é¢˜æˆ–è´¡çŒ®ä»£ç ã€‚</p>
<p>ç¤¾åŒºæ”¯æŒï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fgithub.com%2Forgs%2Frustfs%2Fdiscussions" target="_blank" title="https://link.zhihu.com/?target=https%3A//github.com/orgs/rustfs/discussions" ref="nofollow noopener noreferrer">GitHub Discussions</a>- ä¸å¼€å‘è€…äº¤æµç»éªŒå’Œè§£å†³æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <!----></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (äºŒåäºŒ) è¡¨è¾¾å¼ä¸æŠ•å½±]]></title>    <link>https://juejin.cn/post/7577439614953422900</link>    <guid>https://juejin.cn/post/7577439614953422900</guid>    <pubDate>2025-11-28T07:27:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577439614953422900" data-draft-id="7577378514401755171" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (äºŒåäºŒ) è¡¨è¾¾å¼ä¸æŠ•å½±"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-28T07:27:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (äºŒåäºŒ) è¡¨è¾¾å¼ä¸æŠ•å½±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:27:41.000Z" title="Fri Nov 28 2025 07:27:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬22ç« ï¼šè¡¨è¾¾å¼ä¸æŠ•å½±</h2>
<h3 data-id="heading-1">ğŸ¯ æ ¸å¿ƒæ¦‚è§ˆ</h3>
<p>è¡¨è¾¾å¼å’ŒæŠ•å½±æ˜¯æŸ¥è¯¢æ‰§è¡Œçš„åŸºç¡€ã€‚è¡¨è¾¾å¼ç”¨äºè®¡ç®—ç»“æœåˆ—çš„å€¼ï¼ˆå¦‚å‡½æ•°è°ƒç”¨ã€ç®—æœ¯è¿ç®—ã€æ¡ä»¶åˆ¤æ–­ï¼‰ï¼ŒæŠ•å½±ç”¨äºé€‰æ‹©å’Œè½¬æ¢è¾“å‡ºçš„åˆ—ã€‚Lance å®ç°äº†ä¸€å¥—é«˜æ•ˆçš„è¡¨è¾¾å¼æ±‚å€¼å’ŒæŠ•å½±ä¸‹æ¨æœºåˆ¶ï¼Œä½¿æŸ¥è¯¢æ€§èƒ½è·å¾—æ•°å€æå‡ã€‚</p>
<p><strong>èƒ½åŠ›</strong>ï¼šä»ä»»æ„è¡¨è¾¾å¼é«˜æ•ˆè®¡ç®—ç»“æœï¼Œæ”¯æŒ<strong>æŠ•å½±ä¸‹æ¨</strong>å‡å°‘ IOã€‚</p>
<hr/>
<h3 data-id="heading-2">ğŸ“ è¡¨è¾¾å¼ç±»å‹ä¸æ±‚å€¼</h3>
<h4 data-id="heading-3">è¡¨è¾¾å¼ä½“ç³»</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Expr</span> {
    <span class="hljs-comment">// å­—é¢å€¼</span>
    <span class="hljs-title function_ invoke__">Literal</span>(ScalarValue),
    
    <span class="hljs-comment">// åˆ—å¼•ç”¨</span>
    Column {
        name: <span class="hljs-type">String</span>,
        index: <span class="hljs-type">usize</span>,  <span class="hljs-comment">// åœ¨ RecordBatch ä¸­çš„åˆ—ç´¢å¼•</span>
    },
    
    <span class="hljs-comment">// ä¸€å…ƒæ“ä½œ</span>
    UnaryOp {
        op: UnaryOperator,    <span class="hljs-comment">// NOT, -, ç­‰</span>
        operand: <span class="hljs-type">Box</span>&lt;Expr&gt;,
    },
    
    <span class="hljs-comment">// äºŒå…ƒæ“ä½œ</span>
    BinaryOp {
        left: <span class="hljs-type">Box</span>&lt;Expr&gt;,
        op: BinaryOperator,   <span class="hljs-comment">// +, -, *, /, &lt;, &gt;, ==, AND, OR ç­‰</span>
        right: <span class="hljs-type">Box</span>&lt;Expr&gt;,
    },
    
    <span class="hljs-comment">// å‡½æ•°è°ƒç”¨</span>
    Function {
        name: <span class="hljs-type">String</span>,
        args: <span class="hljs-type">Vec</span>&lt;Expr&gt;,
        return_type: DataType,
    },
    
    <span class="hljs-comment">// æ¡ä»¶è¡¨è¾¾å¼ï¼ˆCASE WHENï¼‰</span>
    Case {
        operand: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">Box</span>&lt;Expr&gt;&gt;,
        when_then_expr: <span class="hljs-type">Vec</span>&lt;(<span class="hljs-type">Box</span>&lt;Expr&gt;, <span class="hljs-type">Box</span>&lt;Expr&gt;)&gt;,
        else_expr: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">Box</span>&lt;Expr&gt;&gt;,
    },
    
    <span class="hljs-comment">// æŠ•å½±ï¼ˆé€‰æ‹©åˆ—ï¼‰</span>
    <span class="hljs-title function_ invoke__">Project</span>(<span class="hljs-type">Vec</span>&lt;<span class="hljs-type">usize</span>&gt;),
    
    <span class="hljs-comment">// å‘é‡æœç´¢</span>
    VectorSearch {
        column: <span class="hljs-type">String</span>,
        query: <span class="hljs-type">Box</span>&lt;Expr&gt;,
        k: <span class="hljs-type">usize</span>,
    },
    
    <span class="hljs-comment">// å‘é‡è·ç¦»</span>
    VectorDistance {
        left: <span class="hljs-type">Box</span>&lt;Expr&gt;,
        right: <span class="hljs-type">Box</span>&lt;Expr&gt;,
        metric: <span class="hljs-type">String</span>,  <span class="hljs-comment">// "l2", "cosine", "dot"</span>
    },
}

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">UnaryOperator</span> {
    Not,           <span class="hljs-comment">// !</span>
    Neg,           <span class="hljs-comment">// -</span>
    IsNull,        <span class="hljs-comment">// IS NULL</span>
    IsNotNull,     <span class="hljs-comment">// IS NOT NULL</span>
}

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">BinaryOperator</span> {
    <span class="hljs-comment">// ç®—æœ¯</span>
    Add, Sub, Mul, Div, Rem,
    <span class="hljs-comment">// æ¯”è¾ƒ</span>
    <span class="hljs-built_in">Eq</span>, Lt, Gt, LtEq, GtEq, NotEq,
    <span class="hljs-comment">// é€»è¾‘</span>
    And, Or,
    <span class="hljs-comment">// å­—ç¬¦ä¸²</span>
    Concat,
}
</code></pre>
<h4 data-id="heading-4">è¡¨è¾¾å¼æ±‚å€¼</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">trait</span> <span class="hljs-title class_">Evaluator</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">evaluate</span>(&amp;<span class="hljs-keyword">self</span>, batch: &amp;RecordBatch) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;ArrayRef&gt;;
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Evaluator</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Expr</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">evaluate</span>(&amp;<span class="hljs-keyword">self</span>, batch: &amp;RecordBatch) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;ArrayRef&gt; {
        <span class="hljs-keyword">match</span> <span class="hljs-keyword">self</span> {
            <span class="hljs-comment">// å­—é¢å€¼ï¼šå¹¿æ’­åˆ°æ•°ç»„</span>
            Expr::<span class="hljs-title function_ invoke__">Literal</span>(val) =&gt; {
                <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(val.<span class="hljs-title function_ invoke__">to_array</span>(batch.<span class="hljs-title function_ invoke__">num_rows</span>())))
            }
            
            <span class="hljs-comment">// åˆ—å¼•ç”¨ï¼šç›´æ¥è¿”å›åˆ—</span>
            Expr::Column { name, index } =&gt; {
                <span class="hljs-title function_ invoke__">Ok</span>(batch.<span class="hljs-title function_ invoke__">column</span>(*index).<span class="hljs-title function_ invoke__">clone</span>())
            }
            
            <span class="hljs-comment">// ä¸€å…ƒæ“ä½œ</span>
            Expr::UnaryOp { op, operand } =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">operand_val</span> = operand.<span class="hljs-title function_ invoke__">evaluate</span>(batch)?;
                <span class="hljs-keyword">match</span> op {
                    UnaryOperator::Not =&gt; {
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">bool_array</span> = operand_val.<span class="hljs-title function_ invoke__">as_boolean</span>();
                        <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(compute::<span class="hljs-title function_ invoke__">not</span>(bool_array)?))
                    }
                    UnaryOperator::Neg =&gt; {
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">num_array</span> = operand_val.as_primitive::&lt;Float32Type&gt;();
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">neg</span> = num_array.<span class="hljs-title function_ invoke__">iter</span>()
                            .<span class="hljs-title function_ invoke__">map</span>(|v| <span class="hljs-title function_ invoke__">Some</span>(-v))
                            .collect::&lt;<span class="hljs-type">Vec</span>&lt;_&gt;&gt;();
                        <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(Float32Array::<span class="hljs-title function_ invoke__">from</span>(neg)))
                    }
                    UnaryOperator::IsNull =&gt; {
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">is_null</span> = operand_val.<span class="hljs-title function_ invoke__">iter</span>()
                            .<span class="hljs-title function_ invoke__">map</span>(|v| <span class="hljs-title function_ invoke__">Some</span>(v.<span class="hljs-title function_ invoke__">is_none</span>()))
                            .collect::&lt;<span class="hljs-type">Vec</span>&lt;_&gt;&gt;();
                        <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(BooleanArray::<span class="hljs-title function_ invoke__">from</span>(is_null)))
                    }
                    _ =&gt; <span class="hljs-title function_ invoke__">Err</span>(<span class="hljs-string">"Unsupported unary op"</span>.<span class="hljs-title function_ invoke__">into</span>()),
                }
            }
            
            <span class="hljs-comment">// äºŒå…ƒæ“ä½œ</span>
            Expr::BinaryOp { left, op, right } =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_val</span> = left.<span class="hljs-title function_ invoke__">evaluate</span>(batch)?;
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_val</span> = right.<span class="hljs-title function_ invoke__">evaluate</span>(batch)?;
                
                <span class="hljs-keyword">match</span> op {
                    <span class="hljs-comment">// ç®—æœ¯æ“ä½œ</span>
                    BinaryOperator::Add =&gt; {
                        <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">binary_arithmetic</span>(&amp;left_val, &amp;right_val, |a, b| a + b)
                    }
                    BinaryOperator::Sub =&gt; {
                        <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">binary_arithmetic</span>(&amp;left_val, &amp;right_val, |a, b| a - b)
                    }
                    BinaryOperator::Mul =&gt; {
                        <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">binary_arithmetic</span>(&amp;left_val, &amp;right_val, |a, b| a * b)
                    }
                    
                    <span class="hljs-comment">// æ¯”è¾ƒæ“ä½œ</span>
                    BinaryOperator::Lt =&gt; {
                        <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">binary_comparison</span>(&amp;left_val, &amp;right_val, |a, b| a &lt; b)
                    }
                    BinaryOperator::<span class="hljs-built_in">Eq</span> =&gt; {
                        <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">binary_comparison</span>(&amp;left_val, &amp;right_val, |a, b| a == b)
                    }
                    
                    <span class="hljs-comment">// é€»è¾‘æ“ä½œ</span>
                    BinaryOperator::And =&gt; {
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_bool</span> = left_val.<span class="hljs-title function_ invoke__">as_boolean</span>();
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_bool</span> = right_val.<span class="hljs-title function_ invoke__">as_boolean</span>();
                        <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(compute::<span class="hljs-title function_ invoke__">and</span>(left_bool, right_bool)?))
                    }
                    BinaryOperator::Or =&gt; {
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_bool</span> = left_val.<span class="hljs-title function_ invoke__">as_boolean</span>();
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_bool</span> = right_val.<span class="hljs-title function_ invoke__">as_boolean</span>();
                        <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(compute::<span class="hljs-title function_ invoke__">or</span>(left_bool, right_bool)?))
                    }
                    
                    _ =&gt; <span class="hljs-title function_ invoke__">Err</span>(<span class="hljs-string">"Unsupported binary op"</span>.<span class="hljs-title function_ invoke__">into</span>()),
                }
            }
            
            <span class="hljs-comment">// å‡½æ•°è°ƒç”¨</span>
            Expr::Function { name, args, .. } =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">arg_values</span>: <span class="hljs-type">Result</span>&lt;<span class="hljs-type">Vec</span>&lt;_&gt;&gt; = args.<span class="hljs-title function_ invoke__">iter</span>()
                    .<span class="hljs-title function_ invoke__">map</span>(|arg| arg.<span class="hljs-title function_ invoke__">evaluate</span>(batch))
                    .<span class="hljs-title function_ invoke__">collect</span>();
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">arg_values</span> = arg_values?;
                
                <span class="hljs-comment">// è°ƒç”¨å¯¹åº”çš„å‡½æ•°</span>
                <span class="hljs-keyword">match</span> name.<span class="hljs-title function_ invoke__">as_str</span>() {
                    <span class="hljs-string">"LENGTH"</span> =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">function_length</span>(&amp;arg_values[<span class="hljs-number">0</span>]),
                    <span class="hljs-string">"UPPER"</span> =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">function_upper</span>(&amp;arg_values[<span class="hljs-number">0</span>]),
                    <span class="hljs-string">"LOWER"</span> =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">function_lower</span>(&amp;arg_values[<span class="hljs-number">0</span>]),
                    <span class="hljs-string">"ROUND"</span> =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">function_round</span>(&amp;arg_values[<span class="hljs-number">0</span>], &amp;arg_values[<span class="hljs-number">1</span>]),
                    <span class="hljs-string">"ABS"</span> =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">function_abs</span>(&amp;arg_values[<span class="hljs-number">0</span>]),
                    _ =&gt; <span class="hljs-title function_ invoke__">Err</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"Unknown function: {}"</span>, name).<span class="hljs-title function_ invoke__">into</span>()),
                }
            }
            
            <span class="hljs-comment">// CASE WHEN è¡¨è¾¾å¼</span>
            Expr::Case { operand, when_then_expr, else_expr } =&gt; {
                <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">evaluate_case</span>(batch, operand, when_then_expr, else_expr)
            }
            
            <span class="hljs-comment">// å‘é‡æœç´¢</span>
            Expr::VectorSearch { column, query, k } =&gt; {
                <span class="hljs-comment">// ç‰¹æ®Šå¤„ç†ï¼šè¿”å›æœç´¢ç»“æœçš„è¡Œå·</span>
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">query_vec</span> = query.<span class="hljs-title function_ invoke__">evaluate</span>(batch)?;
                <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">vector_search</span>(batch, column, &amp;query_vec, *k)
            }
            
            <span class="hljs-comment">// å‘é‡è·ç¦»</span>
            Expr::VectorDistance { left, right, metric } =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_vec</span> = left.<span class="hljs-title function_ invoke__">evaluate</span>(batch)?;
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_vec</span> = right.<span class="hljs-title function_ invoke__">evaluate</span>(batch)?;
                <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">vector_distance</span>(&amp;left_vec, &amp;right_vec, metric)
            }
            
            _ =&gt; <span class="hljs-title function_ invoke__">Err</span>(<span class="hljs-string">"Unknown expression type"</span>.<span class="hljs-title function_ invoke__">into</span>()),
        }
    }
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Expr</span> {
    <span class="hljs-comment">// äºŒå…ƒç®—æœ¯æ“ä½œçš„é€šç”¨å®ç°</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">binary_arithmetic</span>&lt;F&gt;(
        &amp;<span class="hljs-keyword">self</span>,
        left: &amp;ArrayRef,
        right: &amp;ArrayRef,
        op: F,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;ArrayRef&gt;
    <span class="hljs-keyword">where</span>
        F: <span class="hljs-title function_ invoke__">Fn</span>(<span class="hljs-type">f32</span>, <span class="hljs-type">f32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">f32</span>,
    {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_arr</span> = left.as_primitive::&lt;Float32Type&gt;();
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_arr</span> = right.as_primitive::&lt;Float32Type&gt;();
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span>: <span class="hljs-type">Vec</span>&lt;_&gt; = left_arr.<span class="hljs-title function_ invoke__">iter</span>()
            .<span class="hljs-title function_ invoke__">zip</span>(right_arr.<span class="hljs-title function_ invoke__">iter</span>())
            .<span class="hljs-title function_ invoke__">map</span>(|(a, b)| {
                <span class="hljs-title function_ invoke__">match</span> (a, b) {
                    (<span class="hljs-title function_ invoke__">Some</span>(&amp;av), <span class="hljs-title function_ invoke__">Some</span>(&amp;bv)) =&gt; <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-title function_ invoke__">op</span>(av, bv)),
                    _ =&gt; <span class="hljs-literal">None</span>,
                }
            })
            .<span class="hljs-title function_ invoke__">collect</span>();
        
        <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(Float32Array::<span class="hljs-title function_ invoke__">from</span>(result)))
    }
    
    <span class="hljs-comment">// å‘é‡è·ç¦»è®¡ç®—</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">vector_distance</span>(
        &amp;<span class="hljs-keyword">self</span>,
        left: &amp;ArrayRef,
        right: &amp;ArrayRef,
        metric: &amp;<span class="hljs-type">str</span>,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;ArrayRef&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_fsl</span> = left.<span class="hljs-title function_ invoke__">as_fixed_size_list</span>();
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_fsl</span> = right.<span class="hljs-title function_ invoke__">as_fixed_size_list</span>();
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">distances</span>: <span class="hljs-type">Vec</span>&lt;_&gt; = (<span class="hljs-number">0</span>..left_fsl.<span class="hljs-title function_ invoke__">len</span>())
            .<span class="hljs-title function_ invoke__">map</span>(|i| {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_vec</span> = left_fsl.<span class="hljs-title function_ invoke__">value</span>(i);
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_vec</span> = right_fsl.<span class="hljs-title function_ invoke__">value</span>(i);
                
                <span class="hljs-keyword">match</span> metric {
                    <span class="hljs-string">"l2"</span> =&gt; {
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_arr</span> = left_vec.as_primitive::&lt;Float32Type&gt;();
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_arr</span> = right_vec.as_primitive::&lt;Float32Type&gt;();
                        
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">dist</span>: <span class="hljs-type">f32</span> = left_arr.<span class="hljs-title function_ invoke__">iter</span>()
                            .<span class="hljs-title function_ invoke__">zip</span>(right_arr.<span class="hljs-title function_ invoke__">iter</span>())
                            .<span class="hljs-title function_ invoke__">map</span>(|(a, b)| <span class="hljs-title function_ invoke__">match</span> (a, b) {
                                (<span class="hljs-title function_ invoke__">Some</span>(&amp;av), <span class="hljs-title function_ invoke__">Some</span>(&amp;bv)) =&gt; (av - bv).<span class="hljs-title function_ invoke__">powi</span>(<span class="hljs-number">2</span>),
                                _ =&gt; <span class="hljs-number">0.0</span>,
                            })
                            .<span class="hljs-title function_ invoke__">sum</span>();
                        
                        <span class="hljs-title function_ invoke__">Some</span>(dist.<span class="hljs-title function_ invoke__">sqrt</span>())
                    }
                    
                    <span class="hljs-string">"cosine"</span> =&gt; {
                        <span class="hljs-comment">// ä½™å¼¦ç›¸ä¼¼åº¦å®ç°</span>
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_arr</span> = left_vec.as_primitive::&lt;Float32Type&gt;();
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_arr</span> = right_vec.as_primitive::&lt;Float32Type&gt;();
                        
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">dot</span>: <span class="hljs-type">f32</span> = left_arr.<span class="hljs-title function_ invoke__">iter</span>()
                            .<span class="hljs-title function_ invoke__">zip</span>(right_arr.<span class="hljs-title function_ invoke__">iter</span>())
                            .<span class="hljs-title function_ invoke__">map</span>(|(a, b)| <span class="hljs-title function_ invoke__">match</span> (a, b) {
                                (<span class="hljs-title function_ invoke__">Some</span>(&amp;av), <span class="hljs-title function_ invoke__">Some</span>(&amp;bv)) =&gt; av * bv,
                                _ =&gt; <span class="hljs-number">0.0</span>,
                            })
                            .<span class="hljs-title function_ invoke__">sum</span>();
                        
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_norm</span>: <span class="hljs-type">f32</span> = left_arr.<span class="hljs-title function_ invoke__">iter</span>()
                            .<span class="hljs-title function_ invoke__">map</span>(|a| <span class="hljs-keyword">match</span> a {
                                <span class="hljs-title function_ invoke__">Some</span>(&amp;v) =&gt; v.<span class="hljs-title function_ invoke__">powi</span>(<span class="hljs-number">2</span>),
                                <span class="hljs-literal">None</span> =&gt; <span class="hljs-number">0.0</span>,
                            })
                            .sum::&lt;<span class="hljs-type">f32</span>&gt;()
                            .<span class="hljs-title function_ invoke__">sqrt</span>();
                        
                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_norm</span>: <span class="hljs-type">f32</span> = right_arr.<span class="hljs-title function_ invoke__">iter</span>()
                            .<span class="hljs-title function_ invoke__">map</span>(|b| <span class="hljs-keyword">match</span> b {
                                <span class="hljs-title function_ invoke__">Some</span>(&amp;v) =&gt; v.<span class="hljs-title function_ invoke__">powi</span>(<span class="hljs-number">2</span>),
                                <span class="hljs-literal">None</span> =&gt; <span class="hljs-number">0.0</span>,
                            })
                            .sum::&lt;<span class="hljs-type">f32</span>&gt;()
                            .<span class="hljs-title function_ invoke__">sqrt</span>();
                        
                        <span class="hljs-keyword">if</span> left_norm &gt; <span class="hljs-number">0.0</span> &amp;&amp; right_norm &gt; <span class="hljs-number">0.0</span> {
                            <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-number">1.0</span> - dot / (left_norm * right_norm))
                        } <span class="hljs-keyword">else</span> {
                            <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-type">f32</span>::MAX)
                        }
                    }
                    
                    _ =&gt; <span class="hljs-literal">None</span>,
                }
            })
            .<span class="hljs-title function_ invoke__">collect</span>();
        
        <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(Float32Array::<span class="hljs-title function_ invoke__">from</span>(distances)))
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-5">ğŸ¯ æŠ•å½±ä¸åˆ—é€‰æ‹©</h3>
<h4 data-id="heading-6">æŠ•å½±çš„ä½œç”¨</h4>
<p>æŠ•å½±æ“ä½œç”¨äºï¼š</p>
<ol>
<li><strong>é€‰æ‹©åˆ—</strong>ï¼šä»å¤šåˆ—ä¸­é€‰å‡ºéœ€è¦çš„åˆ—</li>
<li><strong>åˆ—é‡æ’</strong>ï¼šæ”¹å˜åˆ—çš„é¡ºåº</li>
<li><strong>åˆ—è½¬æ¢</strong>ï¼šåº”ç”¨è¡¨è¾¾å¼è½¬æ¢åˆ—å€¼</li>
<li><strong>å»é‡</strong>ï¼š<code>SELECT DISTINCT</code></li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ProjectionPlan</span> {
    <span class="hljs-keyword">pub</span> input: Arc&lt;<span class="hljs-keyword">dyn</span> ExecutionPlan&gt;,
    <span class="hljs-keyword">pub</span> expressions: <span class="hljs-type">Vec</span>&lt;Expr&gt;,  <span class="hljs-comment">// æŠ•å½±è¡¨è¾¾å¼</span>
    <span class="hljs-keyword">pub</span> output_names: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">String</span>&gt;,  <span class="hljs-comment">// è¾“å‡ºåˆ—å</span>
}

<span class="hljs-meta">#[async_trait]</span>
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">ExecutionPlan</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">ProjectionPlan</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(
        &amp;<span class="hljs-keyword">self</span>,
        partition: <span class="hljs-type">usize</span>,
        state: Arc&lt;TaskContext&gt;,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;SendableRecordBatchStream&gt; {
        <span class="hljs-comment">// 1. æ‰§è¡Œè¾“å…¥è®¡åˆ’</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">input_stream</span> = <span class="hljs-keyword">self</span>.input.<span class="hljs-title function_ invoke__">execute</span>(partition, state).<span class="hljs-keyword">await</span>?;
        
        <span class="hljs-comment">// 2. å¯¹æ¯ä¸ª batch åº”ç”¨æŠ•å½±</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">output_stream</span> = input_stream.<span class="hljs-title function_ invoke__">map</span>(|batch| {
            <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">project_batch</span>(&amp;batch)
        });
        
        <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">pin</span>(output_stream))
    }
    
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">schema</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> SchemaRef {
        <span class="hljs-comment">// æ„å»ºæŠ•å½±åçš„ schema</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fields</span>: <span class="hljs-type">Vec</span>&lt;_&gt; = <span class="hljs-keyword">self</span>.output_names.<span class="hljs-title function_ invoke__">iter</span>()
            .<span class="hljs-title function_ invoke__">zip</span>(&amp;<span class="hljs-keyword">self</span>.expressions)
            .<span class="hljs-title function_ invoke__">map</span>(|(name, expr)| {
                Field::<span class="hljs-title function_ invoke__">new</span>(name.<span class="hljs-title function_ invoke__">clone</span>(), expr.<span class="hljs-title function_ invoke__">return_type</span>(), <span class="hljs-literal">true</span>)
            })
            .<span class="hljs-title function_ invoke__">collect</span>();
        Arc::<span class="hljs-title function_ invoke__">new</span>(Schema::<span class="hljs-title function_ invoke__">new</span>(fields))
    }
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">ProjectionPlan</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">project_batch</span>(&amp;<span class="hljs-keyword">self</span>, batch: &amp;RecordBatch) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;RecordBatch&gt; {
        <span class="hljs-comment">// å¯¹ batch ä¸­çš„æ¯ä¸ªè¡¨è¾¾å¼æ±‚å€¼</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">columns</span> = <span class="hljs-built_in">vec!</span>[];
        
        <span class="hljs-keyword">for</span> <span class="hljs-variable">expr</span> <span class="hljs-keyword">in</span> &amp;<span class="hljs-keyword">self</span>.expressions {
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">col_array</span> = expr.<span class="hljs-title function_ invoke__">evaluate</span>(batch)?;
            columns.<span class="hljs-title function_ invoke__">push</span>(col_array);
        }
        
        <span class="hljs-comment">// æ„å»ºæ–°çš„ batch</span>
        <span class="hljs-title function_ invoke__">Ok</span>(RecordBatch::<span class="hljs-title function_ invoke__">try_new</span>(<span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">schema</span>(), columns)?)
    }
}
</code></pre>
<h4 data-id="heading-7">æŠ•å½±ä¸‹æ¨ä¼˜åŒ–</h4>
<p>æŠ•å½±ä¸‹æ¨çš„ç›®æ ‡æ˜¯<strong>å°½æ—©å‡å°‘åˆ—</strong>ï¼Œå‡å°‘ IO å’Œå†…å­˜æ¶ˆè€—ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ProjectionPushdown</span>;

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">ProjectionPushdown</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">optimize</span>(&amp;<span class="hljs-keyword">self</span>, plan: &amp;ExecutionPlan) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Arc&lt;<span class="hljs-keyword">dyn</span> ExecutionPlan&gt;&gt; {
        <span class="hljs-keyword">match</span> plan {
            <span class="hljs-comment">// æŠ•å½± - æ‰«æï¼šä¸‹æ¨åˆ°æ‰«æ</span>
            ProjectionPlan {
                input: <span class="hljs-keyword">box</span> ScanPlan { table, .. },
                expressions,
                ..
            } =&gt; {
                <span class="hljs-comment">// åˆ†ææŠ•å½±è¡¨è¾¾å¼ä¸­å¼•ç”¨çš„åˆ—</span>
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">required_columns</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">extract_columns</span>(expressions);
                
                <span class="hljs-comment">// åˆ›å»ºåªæ‰«æè¿™äº›åˆ—çš„æ–° ScanPlan</span>
                <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(ScanPlan {
                    table: table.<span class="hljs-title function_ invoke__">clone</span>(),
                    projection: <span class="hljs-title function_ invoke__">Some</span>(required_columns),
                    <span class="hljs-comment">// ...</span>
                }))
            }
            
            <span class="hljs-comment">// æŠ•å½± - è¿‡æ»¤ï¼šåˆ†æè¿‡æ»¤ä¸­çš„åˆ—</span>
            ProjectionPlan {
                input: <span class="hljs-keyword">box</span> FilterPlan { predicate, .. },
                expressions,
                ..
            } =&gt; {
                <span class="hljs-comment">// éœ€è¦çš„åˆ— = æŠ•å½±åˆ— + è¿‡æ»¤åˆ—</span>
                <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">required</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">extract_columns</span>(expressions);
                required.<span class="hljs-title function_ invoke__">extend</span>(<span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">extract_columns_from_expr</span>(predicate));
                required.<span class="hljs-title function_ invoke__">sort</span>();
                required.<span class="hljs-title function_ invoke__">dedup</span>();
                
                <span class="hljs-comment">// ... ä¸‹æ¨</span>
                <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(...))
            }
            
            _ =&gt; <span class="hljs-title function_ invoke__">Ok</span>(Arc::<span class="hljs-title function_ invoke__">new</span>(plan.<span class="hljs-title function_ invoke__">clone</span>())),
        }
    }
    
    <span class="hljs-comment">// ä»è¡¨è¾¾å¼ä¸­æå–å¼•ç”¨çš„åˆ—ç´¢å¼•</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">extract_columns</span>(&amp;<span class="hljs-keyword">self</span>, expressions: &amp;[Expr]) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">usize</span>&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">columns</span> = <span class="hljs-built_in">vec!</span>[];
        <span class="hljs-keyword">for</span> <span class="hljs-variable">expr</span> <span class="hljs-keyword">in</span> expressions {
            <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">extract_columns_from_expr_into</span>(expr, &amp;<span class="hljs-keyword">mut</span> columns);
        }
        columns
    }
    
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">extract_columns_from_expr_into</span>(&amp;<span class="hljs-keyword">self</span>, expr: &amp;Expr, columns: &amp;<span class="hljs-keyword">mut</span> <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">usize</span>&gt;) {
        <span class="hljs-keyword">match</span> expr {
            Expr::Column { index, .. } =&gt; {
                columns.<span class="hljs-title function_ invoke__">push</span>(*index);
            }
            Expr::BinaryOp { left, right, .. } =&gt; {
                <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">extract_columns_from_expr_into</span>(left, columns);
                <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">extract_columns_from_expr_into</span>(right, columns);
            }
            Expr::UnaryOp { operand, .. } =&gt; {
                <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">extract_columns_from_expr_into</span>(operand, columns);
            }
            Expr::Function { args, .. } =&gt; {
                <span class="hljs-keyword">for</span> <span class="hljs-variable">arg</span> <span class="hljs-keyword">in</span> args {
                    <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">extract_columns_from_expr_into</span>(arg, columns);
                }
            }
            _ =&gt; {}
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-8">ğŸ” è°“è¯åˆ†æä¸ä¸‹æ¨</h3>
<h4 data-id="heading-9">è°“è¯åˆ†æ</h4>
<p>è°“è¯åˆ†æç”¨äºè¯†åˆ«å“ªäº›æ¡ä»¶å¯ä»¥åœ¨ç´¢å¼•å±‚é¢å¤„ç†ï¼Œä»¥å‡å°‘æ•°æ®æ‰«æã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">PredicateAnalyzer</span> {
    schema: SchemaRef,
    index_info: IndexInfo,  <span class="hljs-comment">// ç´¢å¼•ä¿¡æ¯</span>
}

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">PredicatePushdownSupport</span> {
    Unsupported,   <span class="hljs-comment">// æ— æ³•ä¸‹æ¨</span>
    Partial,       <span class="hljs-comment">// éƒ¨åˆ†æ”¯æŒï¼ˆå¦‚éœ€è¦é¢å¤–è¿‡æ»¤ï¼‰</span>
    Full,          <span class="hljs-comment">// å®Œå…¨æ”¯æŒ</span>
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">PredicateAnalyzer</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">analyze_pushdown</span>(&amp;<span class="hljs-keyword">self</span>, predicate: &amp;Expr) <span class="hljs-punctuation">-&gt;</span> PredicatePushdownSupport {
        <span class="hljs-keyword">match</span> predicate {
            <span class="hljs-comment">// ç­‰å€¼æŸ¥è¯¢ï¼šcolumn = value</span>
            Expr::BinaryOp {
                left: <span class="hljs-keyword">box</span> Expr::Column { name, .. },
                op: BinaryOperator::<span class="hljs-built_in">Eq</span>,
                right: <span class="hljs-keyword">box</span> Expr::<span class="hljs-title function_ invoke__">Literal</span>(_),
            } =&gt; {
                <span class="hljs-comment">// æ£€æŸ¥åˆ—æ˜¯å¦æœ‰ç´¢å¼•</span>
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.index_info.<span class="hljs-title function_ invoke__">has_index</span>(name) {
                    PredicatePushdownSupport::Full
                } <span class="hljs-keyword">else</span> {
                    PredicatePushdownSupport::Partial
                }
            }
            
            <span class="hljs-comment">// èŒƒå›´æŸ¥è¯¢ï¼šcolumn &gt; value AND column &lt; value</span>
            Expr::BinaryOp {
                left,
                op: BinaryOperator::And,
                right,
            } =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">left_support</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">analyze_pushdown</span>(left);
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">right_support</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">analyze_pushdown</span>(right);
                
                <span class="hljs-title function_ invoke__">match</span> (left_support, right_support) {
                    (PredicatePushdownSupport::Full, PredicatePushdownSupport::Full) =&gt; {
                        PredicatePushdownSupport::Full
                    }
                    (PredicatePushdownSupport::Unsupported, _) | (_, PredicatePushdownSupport::Unsupported) =&gt; {
                        PredicatePushdownSupport::Unsupported
                    }
                    _ =&gt; PredicatePushdownSupport::Partial,
                }
            }
            
            <span class="hljs-comment">// å‘é‡æœç´¢ï¼šç‰¹æ®Šå¤„ç†ï¼Œä¸èƒ½æ™®é€šä¸‹æ¨</span>
            Expr::VectorSearch { .. } =&gt; {
                PredicatePushdownSupport::Unsupported
            }
            
            _ =&gt; PredicatePushdownSupport::Partial,
        }
    }
    
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">split_predicate</span>(&amp;<span class="hljs-keyword">self</span>, predicate: &amp;Expr) <span class="hljs-punctuation">-&gt;</span> (<span class="hljs-type">Option</span>&lt;Expr&gt;, <span class="hljs-type">Option</span>&lt;Expr&gt;) {
        <span class="hljs-comment">// å°†è°“è¯åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</span>
        <span class="hljs-comment">// 1. å¯ä»¥ä¸‹æ¨çš„ï¼ˆåœ¨ç´¢å¼•å±‚å¤„ç†ï¼‰</span>
        <span class="hljs-comment">// 2. æ— æ³•ä¸‹æ¨çš„ï¼ˆåœ¨æ‰§è¡Œå™¨å¤„ç†ï¼‰</span>
        
        <span class="hljs-keyword">match</span> predicate {
            Expr::BinaryOp {
                left,
                op: BinaryOperator::And,
                right,
            } =&gt; {
                <span class="hljs-keyword">let</span> (push_left, no_push_left) = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">split_predicate</span>(left);
                <span class="hljs-keyword">let</span> (push_right, no_push_right) = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">split_predicate</span>(right);
                
                <span class="hljs-comment">// åˆå¹¶å¯æ¨çš„æ¡ä»¶</span>
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">pushdown</span> = <span class="hljs-title function_ invoke__">match</span> (push_left, push_right) {
                    (<span class="hljs-title function_ invoke__">Some</span>(l), <span class="hljs-title function_ invoke__">Some</span>(r)) =&gt; <span class="hljs-title function_ invoke__">Some</span>(Expr::BinaryOp {
                        left: <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(l),
                        op: BinaryOperator::And,
                        right: <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(r),
                    }),
                    (<span class="hljs-title function_ invoke__">Some</span>(e), <span class="hljs-literal">None</span>) | (<span class="hljs-literal">None</span>, <span class="hljs-title function_ invoke__">Some</span>(e)) =&gt; <span class="hljs-title function_ invoke__">Some</span>(e),
                    (<span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>) =&gt; <span class="hljs-literal">None</span>,
                };
                
                <span class="hljs-comment">// åˆå¹¶æ— æ³•æ¨çš„æ¡ä»¶</span>
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">no_pushdown</span> = <span class="hljs-title function_ invoke__">match</span> (no_push_left, no_push_right) {
                    (<span class="hljs-title function_ invoke__">Some</span>(l), <span class="hljs-title function_ invoke__">Some</span>(r)) =&gt; <span class="hljs-title function_ invoke__">Some</span>(Expr::BinaryOp {
                        left: <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(l),
                        op: BinaryOperator::And,
                        right: <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(r),
                    }),
                    (<span class="hljs-title function_ invoke__">Some</span>(e), <span class="hljs-literal">None</span>) | (<span class="hljs-literal">None</span>, <span class="hljs-title function_ invoke__">Some</span>(e)) =&gt; <span class="hljs-title function_ invoke__">Some</span>(e),
                    (<span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>) =&gt; <span class="hljs-literal">None</span>,
                };
                
                (pushdown, no_pushdown)
            }
            
            _ =&gt; {
                <span class="hljs-comment">// å•ä¸ªè°“è¯ï¼šåˆ¤æ–­æ˜¯å¦å¯æ¨</span>
                <span class="hljs-keyword">if</span> matches!(<span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">analyze_pushdown</span>(predicate), PredicatePushdownSupport::Full) {
                    (<span class="hljs-title function_ invoke__">Some</span>(predicate.<span class="hljs-title function_ invoke__">clone</span>()), <span class="hljs-literal">None</span>)
                } <span class="hljs-keyword">else</span> {
                    (<span class="hljs-literal">None</span>, <span class="hljs-title function_ invoke__">Some</span>(predicate.<span class="hljs-title function_ invoke__">clone</span>()))
                }
            }
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-10">ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹</h3>
<h4 data-id="heading-11">CASE WHEN ä¼˜åŒ–</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> lance
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># åˆ›å»ºç¤ºä¾‹æ•°æ®</span>
data = {
    <span class="hljs-string">"id"</span>: np.arange(<span class="hljs-number">1000</span>),
    <span class="hljs-string">"price"</span>: np.random.randint(<span class="hljs-number">10</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">1000</span>),
    <span class="hljs-string">"category"</span>: np.random.choice([<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>], <span class="hljs-number">1000</span>),
}

table = lance.write_table(data, uri=<span class="hljs-string">"data.lance"</span>)

<span class="hljs-comment"># SQL æŸ¥è¯¢ï¼šä½¿ç”¨ CASE WHEN è¿›è¡Œåˆ†ç±»</span>
result = table.search_sql(<span class="hljs-string">"""
    SELECT 
        id,
        price,
        CASE 
            WHEN price &lt; 100 THEN 'cheap'
            WHEN price &lt; 500 THEN 'medium'
            ELSE 'expensive'
        END as price_tier,
        CASE category
            WHEN 'A' THEN 1
            WHEN 'B' THEN 2
            WHEN 'C' THEN 3
            ELSE 0
        END as category_code
    FROM data
    WHERE price &gt; 50
"""</span>)

<span class="hljs-comment"># è½¬æ¢ä¸º Pandas</span>
df = result.to_pandas()
<span class="hljs-built_in">print</span>(df)
</code></pre>
<h4 data-id="heading-12">åˆ—æŠ•å½±ä¼˜åŒ–</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¼˜åŒ–å‰ï¼šæ‰«ææ‰€æœ‰åˆ—</span>
result = table.search_sql(<span class="hljs-string">"""
    SELECT * FROM data WHERE price &gt; 100
"""</span>)

<span class="hljs-comment"># ä¼˜åŒ–åï¼šåªæ‰«æéœ€è¦çš„åˆ—ï¼ˆæŠ•å½±ä¸‹æ¨ï¼‰</span>
result = table.search_sql(<span class="hljs-string">"""
    SELECT id, price FROM data WHERE price &gt; 100
"""</span>)

<span class="hljs-comment"># æ€§èƒ½æå‡ï¼šå‡è®¾è¡¨æœ‰ 100 åˆ—ï¼Œåªéœ€è¦ 2 åˆ—</span>
<span class="hljs-comment"># æ€§èƒ½æå‡æ¯”ä¾‹ â‰ˆ 100 / 2 = 50x</span>
</code></pre>
<hr/>
<h3 data-id="heading-13">ğŸ“š æ€»ç»“</h3>
<p>è¡¨è¾¾å¼ä¸æŠ•å½±æ˜¯æŸ¥è¯¢æ‰§è¡Œçš„æ ¸å¿ƒï¼š</p>
<ol>
<li><strong>è¡¨è¾¾å¼æ±‚å€¼</strong>ï¼šæ”¯æŒæ‰€æœ‰å¸¸è§çš„è¿ç®—å’Œå‡½æ•°</li>
<li><strong>æŠ•å½±ä¸‹æ¨</strong>ï¼šå°½æ—©å‡å°‘åˆ—ï¼Œå‡å°‘ IO</li>
<li><strong>è°“è¯åˆ†æ</strong>ï¼šåˆ¤æ–­æ¡ä»¶æ˜¯å¦å¯åœ¨ç´¢å¼•å±‚å¤„ç†</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé€šè¿‡ä¸‹æ¨å’Œèåˆå¤§å¹…é™ä½æˆæœ¬</li>
</ol>
<p>è¿™äº›æœºåˆ¶å…±åŒä½œç”¨ï¼Œä½¿ Lance èƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†å¤æ‚çš„åˆ†ææŸ¥è¯¢ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºC++ä»0åˆ°1æ‰‹å†™Linuxé«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹æ¡†æ¶(è¶…æ¸…)]]></title>    <link>https://juejin.cn/post/7577668116500283430</link>    <guid>https://juejin.cn/post/7577668116500283430</guid>    <pubDate>2025-11-28T07:42:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577668116500283430" data-draft-id="7577431644068773939" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºC++ä»0åˆ°1æ‰‹å†™Linuxé«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹æ¡†æ¶(è¶…æ¸…)"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-28T07:42:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯¾ç¨‹xingkeitä¸top"/> <meta itemprop="url" content="https://juejin.cn/user/1910275039560096"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºC++ä»0åˆ°1æ‰‹å†™Linuxé«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹æ¡†æ¶(è¶…æ¸…)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1910275039560096/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯¾ç¨‹xingkeitä¸top
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:42:09.000Z" title="Fri Nov 28 2025 07:42:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Linuxç¯å¢ƒä¸‹ï¼Œé«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹çš„æ ¸å¿ƒåœ¨äº<strong>é«˜æ•ˆåˆ©ç”¨ç³»ç»Ÿèµ„æºã€å‡å°‘æ‹·è´ã€ä¼˜åŒ–äº‹ä»¶å¤„ç†æœºåˆ¶</strong>ã€‚æœ¬æ•™ç¨‹å°†å¸¦ä½ ä»é›¶å®ç°ä¸€ä¸ªåŸºäº<strong>Reactoræ¨¡å¼+Epoll</strong>çš„C++ç½‘ç»œæ¡†æ¶ï¼Œæ”¯æŒé«˜å¹¶å‘ï¼ˆç™¾ä¸‡çº§è¿æ¥ï¼‰ã€ä½å»¶è¿Ÿï¼ˆå¾®ç§’çº§å“åº”ï¼‰ï¼Œå¹¶åŒ…å«å…³é”®ä»£ç è§£æä¸å®Œæ•´å®ç°æ­¥éª¤ã€‚</p>
<hr/>
<h3 data-id="heading-0"><strong>ä¸€ã€æ¡†æ¶è®¾è®¡æ ¸å¿ƒæ€æƒ³</strong></h3>
<ol>
<li>
<p><strong>Reactoræ¨¡å¼</strong>ï¼š</p>
<ul>
<li>ä¸»çº¿ç¨‹ï¼ˆReactorï¼‰ç›‘å¬æ‰€æœ‰äº‹ä»¶ï¼ˆå¦‚è¿æ¥ã€è¯»å†™ï¼‰ï¼Œé€šè¿‡å›è°ƒå‡½æ•°å°†äº‹ä»¶åˆ†å‘ç»™å·¥ä½œçº¿ç¨‹å¤„ç†ã€‚</li>
<li>é¿å…å¤šçº¿ç¨‹ç«äº‰ï¼Œå‡å°‘é”å¼€é”€ã€‚</li>
</ul>
</li>
<li>
<p><strong>Epollè¾¹ç¼˜è§¦å‘ï¼ˆETï¼‰</strong> ï¼š</p>
<ul>
<li>ç›¸æ¯”æ°´å¹³è§¦å‘ï¼ˆLTï¼‰ï¼ŒETæ¨¡å¼ä»…åœ¨æ–‡ä»¶æè¿°ç¬¦çŠ¶æ€å˜åŒ–æ—¶é€šçŸ¥ï¼Œå‡å°‘é‡å¤äº‹ä»¶å¤„ç†ã€‚</li>
<li>éœ€é…åˆéé˜»å¡IOï¼ˆ<code>fcntl(fd, F_SETFL, O_NONBLOCK)</code>ï¼‰ä½¿ç”¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>å†…å­˜æ± ä¸é›¶æ‹·è´</strong>ï¼š</p>
<ul>
<li>è‡ªå®šä¹‰å†…å­˜æ± å‡å°‘åŠ¨æ€å†…å­˜åˆ†é…å¼€é”€ã€‚</li>
<li>ä½¿ç”¨<code>sendfile</code>ç³»ç»Ÿè°ƒç”¨å®ç°æ–‡ä»¶ä¼ è¾“é›¶æ‹·è´ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-1"><strong>äºŒã€å…³é”®ç»„ä»¶å®ç°</strong></h3>
<h4 data-id="heading-2"><strong>1. åŸºç¡€ç»“æ„å®šä¹‰</strong></h4>
<pre><code class="hljs language-arduino" lang="arduino">cpp
<span class="hljs-number">1</span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/epoll.h&gt;</span></span>
<span class="hljs-number">2</span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span>
<span class="hljs-number">3</span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unordered_map&gt;</span></span>
<span class="hljs-number">4</span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;functional&gt;</span></span>
<span class="hljs-number">5</span>
<span class="hljs-number">6</span><span class="hljs-comment">// äº‹ä»¶å›è°ƒç±»å‹å®šä¹‰</span>
<span class="hljs-number">7u</span>sing EventCallback = std::function&lt;<span class="hljs-built_in">void</span>(<span class="hljs-type">int</span> fd)&gt;;
<span class="hljs-number">8</span>
<span class="hljs-number">9</span><span class="hljs-comment">// è¿æ¥å¯¹è±¡ï¼ˆå°è£…socketæè¿°ç¬¦ä¸å›è°ƒï¼‰</span>
<span class="hljs-number">10</span><span class="hljs-keyword">struct</span> Connection {
<span class="hljs-number">11</span>    <span class="hljs-type">int</span> fd;
<span class="hljs-number">12</span>    EventCallback onRead;
<span class="hljs-number">13</span>    EventCallback onWrite;
<span class="hljs-number">14</span>    <span class="hljs-comment">// å…¶ä»–ä¸šåŠ¡æ•°æ®ï¼ˆå¦‚ç¼“å†²åŒºã€çŠ¶æ€ç­‰ï¼‰</span>
<span class="hljs-number">15</span>};
<span class="hljs-number">16</span>
<span class="hljs-number">17</span><span class="hljs-comment">// Reactoræ ¸å¿ƒç±»</span>
<span class="hljs-number">18</span><span class="hljs-keyword">class</span> Reactor {
<span class="hljs-number">19</span><span class="hljs-keyword">private</span>:
<span class="hljs-number">20</span>    <span class="hljs-type">int</span> epoll_fd;
<span class="hljs-number">21</span>    std::unordered_map&lt;<span class="hljs-type">int</span>, Connection&gt; connections; <span class="hljs-comment">// fdåˆ°è¿æ¥çš„æ˜ å°„</span>
<span class="hljs-number">22</span>
<span class="hljs-number">23</span><span class="hljs-keyword">public</span>:
<span class="hljs-number">24</span>    <span class="hljs-built_in">Reactor</span>() {
<span class="hljs-number">25</span>        epoll_fd = <span class="hljs-built_in">epoll_create1</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">// åˆ›å»ºepollå®ä¾‹</span>
<span class="hljs-number">26</span>        <span class="hljs-keyword">if</span> (epoll_fd == <span class="hljs-number">-1</span>) {
<span class="hljs-number">27</span>            <span class="hljs-built_in">perror</span>(<span class="hljs-string">"epoll_create1 failed"</span>);
<span class="hljs-number">28</span>            <span class="hljs-built_in">exit</span>(EXIT_FAILURE);
<span class="hljs-number">29</span>        }
<span class="hljs-number">30</span>    }
<span class="hljs-number">31</span>
<span class="hljs-number">32</span>    ~<span class="hljs-built_in">Reactor</span>() { <span class="hljs-built_in">close</span>(epoll_fd); }
<span class="hljs-number">33</span>
<span class="hljs-number">34</span>    <span class="hljs-comment">// æ·»åŠ äº‹ä»¶ç›‘å¬</span>
<span class="hljs-number">35</span>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addEvent</span><span class="hljs-params">(<span class="hljs-type">int</span> fd, <span class="hljs-type">uint32_t</span> events, EventCallback onRead, EventCallback onWrite)</span></span>;
<span class="hljs-number">36</span>    
<span class="hljs-number">37</span>    <span class="hljs-comment">// äº‹ä»¶å¾ªç¯</span>
<span class="hljs-number">38</span>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span>;
<span class="hljs-number">39</span>};
</code></pre>
<h4 data-id="heading-3"><strong>2. Epolläº‹ä»¶ç®¡ç†</strong></h4>
<pre><code class="hljs language-ini" lang="ini">cpp
1void Reactor::addEvent(int fd, uint32_t events, EventCallback onRead, EventCallback onWrite) {
2    // è®¾ç½®socketä¸ºéé˜»å¡
3    int <span class="hljs-attr">flags</span> = fcntl(fd, F_GETFL, <span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
4    fcntl(fd, F_SETFL, flags | O_NONBLOCK)<span class="hljs-comment">;</span>
5
6    // æ³¨å†Œäº‹ä»¶åˆ°epoll
7    struct epoll_event ev<span class="hljs-comment">;</span>
8    <span class="hljs-attr">ev.events</span> = events | EPOLLET<span class="hljs-comment">; // è¾¹ç¼˜è§¦å‘</span>
9    <span class="hljs-attr">ev.data.fd</span> = fd<span class="hljs-comment">;</span>
10
11    if (epoll_ctl(epoll_fd, EPOLL_CTL_ADD, fd, &amp;ev) == -1) {
12        perror("epoll_ctl add failed")<span class="hljs-comment">;</span>
13        close(fd)<span class="hljs-comment">;</span>
14        return<span class="hljs-comment">;</span>
15    }
16
17    // ä¿å­˜è¿æ¥ä¿¡æ¯
18    connections<span class="hljs-section">[fd]</span> = {fd, onRead, onWrite}<span class="hljs-comment">;</span>
19}
</code></pre>
<h4 data-id="heading-4"><strong>3. äº‹ä»¶å¾ªç¯ä¸å›è°ƒåˆ†å‘</strong></h4>
<pre><code class="hljs language-ini" lang="ini">cpp
1void Reactor::run() {
2    const int <span class="hljs-attr">MAX_EVENTS</span> = <span class="hljs-number">1024</span><span class="hljs-comment">;</span>
3    struct epoll_event events<span class="hljs-section">[MAX_EVENTS]</span><span class="hljs-comment">;</span>
4
5    while (true) {
6        int <span class="hljs-attr">n</span> = epoll_wait(epoll_fd, events, MAX_EVENTS, -<span class="hljs-number">1</span>)<span class="hljs-comment">; // é˜»å¡ç­‰å¾…äº‹ä»¶</span>
7        if (<span class="hljs-attr">n</span> == -<span class="hljs-number">1</span>) {
8            perror("epoll_wait failed")<span class="hljs-comment">;</span>
9            break<span class="hljs-comment">;</span>
10        }
11
12        for (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; n; ++i) {</span>
13            int <span class="hljs-attr">fd</span> = events[i].data.fd<span class="hljs-comment">;</span>
14            auto&amp; <span class="hljs-attr">conn</span> = connections[fd]<span class="hljs-comment">;</span>
15
16            if (events<span class="hljs-section">[i]</span>.events &amp; EPOLLIN) { // å¯è¯»äº‹ä»¶
17                if (conn.onRead) conn.onRead(fd)<span class="hljs-comment">;</span>
18            }
19
20            if (events<span class="hljs-section">[i]</span>.events &amp; EPOLLOUT) { // å¯å†™äº‹ä»¶
21                if (conn.onWrite) conn.onWrite(fd)<span class="hljs-comment">;</span>
22            }
23
24            // å¤„ç†é”™è¯¯æˆ–æŒ‚æ–­äº‹ä»¶
25            if (events<span class="hljs-section">[i]</span>.events &amp; (EPOLLERR | EPOLLHUP)) {
26                close(fd)<span class="hljs-comment">;</span>
27                connections.erase(fd)<span class="hljs-comment">;</span>
28            }
29        }
30    }
31}
</code></pre>
<hr/>
<h3 data-id="heading-5"><strong>ä¸‰ã€å®Œæ•´æœåŠ¡ç«¯å®ç°</strong></h3>
<h4 data-id="heading-6"><strong>1. åˆå§‹åŒ–ä¸å¯åŠ¨æœåŠ¡</strong></h4>
<pre><code class="hljs language-c" lang="c">cpp
<span class="hljs-number">1</span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-number">2</span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span>
<span class="hljs-number">3</span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-number">4</span><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arpa/inet.h&gt;</span></span>
<span class="hljs-number">5</span>
<span class="hljs-number">6</span><span class="hljs-comment">// ç®€å•çš„è¯»å›è°ƒï¼šå›æ˜¾æ•°æ®</span>
<span class="hljs-number">7</span><span class="hljs-type">void</span> <span class="hljs-title function_">onRead</span><span class="hljs-params">(<span class="hljs-type">int</span> fd)</span> {
<span class="hljs-number">8</span>    <span class="hljs-type">char</span> buf[<span class="hljs-number">1024</span>];
<span class="hljs-number">9</span>    <span class="hljs-type">ssize_t</span> n = recv(fd, buf, <span class="hljs-keyword">sizeof</span>(buf), <span class="hljs-number">0</span>);
<span class="hljs-number">10</span>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">0</span>) {
<span class="hljs-number">11</span>        send(fd, buf, n, <span class="hljs-number">0</span>); <span class="hljs-comment">// å›æ˜¾</span>
<span class="hljs-number">12</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) { <span class="hljs-comment">// å®¢æˆ·ç«¯å…³é—­è¿æ¥</span>
<span class="hljs-number">13</span>        close(fd);
<span class="hljs-number">14</span>    }
<span class="hljs-number">15</span>}
<span class="hljs-number">16</span>
<span class="hljs-number">17</span><span class="hljs-comment">// ç®€å•çš„å†™å›è°ƒï¼ˆç¤ºä¾‹ä¸­æœªä½¿ç”¨ï¼‰</span>
<span class="hljs-number">18</span><span class="hljs-type">void</span> <span class="hljs-title function_">onWrite</span><span class="hljs-params">(<span class="hljs-type">int</span> fd)</span> { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-number">19</span>
<span class="hljs-number">20</span><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
<span class="hljs-number">21</span>    Reactor reactor;
<span class="hljs-number">22</span>
<span class="hljs-number">23</span>    <span class="hljs-comment">// åˆ›å»ºç›‘å¬socket</span>
<span class="hljs-number">24</span>    <span class="hljs-type">int</span> listen_fd = socket(AF_INET, SOCK_STREAM, <span class="hljs-number">0</span>);
<span class="hljs-number">25</span>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">addr</span>;</span>
<span class="hljs-number">26</span>    <span class="hljs-built_in">memset</span>(&amp;addr, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(addr));
<span class="hljs-number">27</span>    addr.sin_family = AF_INET;
<span class="hljs-number">28</span>    addr.sin_port = htons(<span class="hljs-number">8080</span>);
<span class="hljs-number">29</span>    addr.sin_addr.s_addr = INADDR_ANY;
<span class="hljs-number">30</span>
<span class="hljs-number">31</span>    bind(listen_fd, (<span class="hljs-keyword">struct</span> sockaddr*)&amp;addr, <span class="hljs-keyword">sizeof</span>(addr));
<span class="hljs-number">32</span>    listen(listen_fd, SOMAXCONN);
<span class="hljs-number">33</span>
<span class="hljs-number">34</span>    <span class="hljs-comment">// å°†ç›‘å¬socketè®¾ä¸ºéé˜»å¡å¹¶æ·»åŠ åˆ°Reactor</span>
<span class="hljs-number">35</span>    <span class="hljs-type">int</span> flags = fcntl(listen_fd, F_GETFL, <span class="hljs-number">0</span>);
<span class="hljs-number">36</span>    fcntl(listen_fd, F_SETFL, flags | O_NONBLOCK);
<span class="hljs-number">37</span>
<span class="hljs-number">38</span>    <span class="hljs-comment">// ç›‘å¬å¯è¯»äº‹ä»¶ï¼ˆæ–°è¿æ¥åˆ°è¾¾ï¼‰</span>
<span class="hljs-number">39</span>    reactor.addEvent(listen_fd, EPOLLIN, [](<span class="hljs-type">int</span> fd) {
<span class="hljs-number">40</span>        <span class="hljs-keyword">struct</span> sockaddr_in client_addr;
<span class="hljs-number">41</span>        <span class="hljs-type">socklen_t</span> len = <span class="hljs-keyword">sizeof</span>(client_addr);
<span class="hljs-number">42</span>        <span class="hljs-type">int</span> client_fd = accept(fd, (<span class="hljs-keyword">struct</span> sockaddr*)&amp;client_addr, &amp;len);
<span class="hljs-number">43</span>        <span class="hljs-keyword">if</span> (client_fd &gt; <span class="hljs-number">0</span>) {
<span class="hljs-number">44</span>            <span class="hljs-comment">// ä¸ºæ–°è¿æ¥æ³¨å†Œè¯»äº‹ä»¶ï¼ˆå›æ˜¾ä¸šåŠ¡ï¼‰</span>
<span class="hljs-number">45</span>            Reactor* reactor = Reactor::getInstance(); <span class="hljs-comment">// å‡è®¾Reactorä¸ºå•ä¾‹</span>
<span class="hljs-number">46</span>            reactor-&gt;addEvent(client_fd, EPOLLIN, onRead, onWrite);
<span class="hljs-number">47</span>        }
<span class="hljs-number">48</span>    }, nullptr);
<span class="hljs-number">49</span>
<span class="hljs-number">50</span>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"Server started on port 8080..."</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
<span class="hljs-number">51</span>    reactor.run(); <span class="hljs-comment">// å¯åŠ¨äº‹ä»¶å¾ªç¯</span>
<span class="hljs-number">52</span>
<span class="hljs-number">53</span>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
<span class="hljs-number">54</span>}
</code></pre>
<h4 data-id="heading-7"><strong>2. æ€§èƒ½ä¼˜åŒ–æŠ€å·§</strong></h4>
<ol>
<li>
<p><strong>SO_REUSEPORT</strong>ï¼šå…è®¸å¤šçº¿ç¨‹ç»‘å®šåŒä¸€ç«¯å£ï¼ŒåŠ é€Ÿè¿æ¥å»ºç«‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">cpp
1int <span class="hljs-attr">opt</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
2setsockopt(listen_fd, SOL_SOCKET, SO_REUSEPORT, &amp;opt, sizeof(opt))<span class="hljs-comment">;</span>
</code></pre>
</li>
<li>
<p><strong>TCP_FASTOPEN</strong>ï¼šå‡å°‘TCPæ¡æ‰‹å»¶è¿Ÿï¼ˆéœ€å†…æ ¸æ”¯æŒï¼‰ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">cpp
<span class="hljs-number">1s</span><span class="hljs-built_in">etsockopt</span>(listen_fd, IPPROTO_TCP, TCP_FASTOPEN, &amp;opt, sizeof(opt));
</code></pre>
</li>
<li>
<p><strong>å†…å­˜æ± ä¼˜åŒ–</strong>ï¼šé¢„åˆ†é…ç¼“å†²åŒºæ± ï¼Œé¿å…é¢‘ç¹<code>malloc/free</code>ã€‚</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-8"><strong>å››ã€æµ‹è¯•ä¸éªŒè¯</strong></h3>
<ol>
<li>
<p><strong>ä½¿ç”¨<code>wrk</code>å‹æµ‹</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">bash
<span class="hljs-number">1</span>wrk -t4 -c1000 -d30s http:<span class="hljs-comment">//localhost:8080</span>
</code></pre>
<ul>
<li><code>-t4</code>ï¼š4ä¸ªçº¿ç¨‹</li>
<li><code>-c1000</code>ï¼š1000ä¸ªå¹¶å‘è¿æ¥</li>
<li><code>-d30s</code>ï¼šæŒç»­30ç§’</li>
</ul>
</li>
<li>
<p><strong>ç›‘æ§ç³»ç»ŸæŒ‡æ ‡</strong>ï¼š</p>
<ul>
<li><code>netstat -anp | grep 8080</code>ï¼šæŸ¥çœ‹è¿æ¥æ•°</li>
<li><code>top -p &lt;pid&gt;</code>ï¼šè§‚å¯ŸCPUå ç”¨</li>
<li><code>strace -p &lt;pid&gt;</code>ï¼šè·Ÿè¸ªç³»ç»Ÿè°ƒç”¨</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-9"><strong>äº”ã€æ‰©å±•åŠŸèƒ½å»ºè®®</strong></h3>
<ol>
<li><strong>å®šæ—¶å™¨æ”¯æŒ</strong>ï¼šé›†æˆ<code>timerfd</code>å®ç°å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚å¿ƒè·³æ£€æµ‹ï¼‰ã€‚</li>
<li><strong>çº¿ç¨‹æ± </strong>ï¼šå°†è€—æ—¶ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ï¼‰æ”¾åˆ°å·¥ä½œçº¿ç¨‹æ± å¤„ç†ã€‚</li>
<li><strong>SSL/TLSåŠ å¯†</strong>ï¼šé›†æˆOpenSSLæ”¯æŒHTTPSã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-10"><strong>å…­ã€æ€»ç»“</strong></h3>
<p>æœ¬æ•™ç¨‹å®ç°äº†<strong>åŸºäºReactor+Epollçš„C++é«˜æ€§èƒ½ç½‘ç»œæ¡†æ¶</strong>ï¼Œæ ¸å¿ƒä»£ç ä»…200ä½™è¡Œï¼Œå´å…·å¤‡ä»¥ä¸‹ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>ç™¾ä¸‡çº§è¿æ¥</strong>ï¼šé€šè¿‡Epollè¾¹ç¼˜è§¦å‘ä¸éé˜»å¡IOå®ç°ã€‚</li>
<li><strong>ä½å»¶è¿Ÿ</strong>ï¼šå‡å°‘äº‹ä»¶å¤„ç†ä¸­çš„å†—ä½™æ‹·è´ä¸ç³»ç»Ÿè°ƒç”¨ã€‚</li>
<li><strong>æ˜“æ‰©å±•</strong>ï¼šé€šè¿‡å›è°ƒæœºåˆ¶åˆ†ç¦»äº‹ä»¶å¤„ç†ä¸ä¸šåŠ¡é€»è¾‘ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ†å¸ƒå¼è®¢å•ç³»ç»Ÿï¼šè®¢å•å·ç¼–ç è®¾è®¡å®æˆ˜]]></title>    <link>https://juejin.cn/post/7577438119558086707</link>    <guid>https://juejin.cn/post/7577438119558086707</guid>    <pubDate>2025-11-28T07:02:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577438119558086707" data-draft-id="7577307100130836530" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ†å¸ƒå¼è®¢å•ç³»ç»Ÿï¼šè®¢å•å·ç¼–ç è®¾è®¡å®æˆ˜"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-11-28T07:02:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Carve_the_Code"/> <meta itemprop="url" content="https://juejin.cn/user/624178336105997"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ†å¸ƒå¼è®¢å•ç³»ç»Ÿï¼šè®¢å•å·ç¼–ç è®¾è®¡å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624178336105997/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Carve_the_Code
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:02:15.000Z" title="Fri Nov 28 2025 07:02:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åˆ†å¸ƒå¼è®¢å•ç³»ç»Ÿï¼šè®¢å•å·ç¼–ç è®¾è®¡å®æˆ˜</h2>
<blockquote>
<p><strong>ä½œè€…</strong>: Carve_the_Code
<strong>æ ‡ç­¾</strong>: #åˆ†å¸ƒå¼ç³»ç»Ÿ #æ•°æ®åº“åˆ†ç‰‡ #æ€§èƒ½ä¼˜åŒ– #æ¶æ„è®¾è®¡</p>
</blockquote>
<blockquote>
<p><strong>å£°æ˜</strong>ï¼šæœ¬æ–‡åŸºäºé€šç”¨åˆ†å¸ƒå¼ç³»ç»Ÿå®è·µæ€»ç»“ï¼Œä»£ç ä¸ºç®€åŒ–ç¤ºä¾‹ï¼Œæ€§èƒ½æ•°æ®ä¸ºå…¸å‹åœºæ™¯å‚è€ƒå€¼ã€‚</p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€èƒŒæ™¯ï¼šåˆ†åº“åˆ†è¡¨åçš„è·¯ç”±å›°å¢ƒ</h3>
<h4 data-id="heading-2">1.1 ä¸šåŠ¡åœºæ™¯</h4>
<p>æŸå¤§å‹ OTA å¹³å°çš„è®¢å•ç³»ç»Ÿæ”¯æŒå¤šå›½å®¶ã€å¤šæ¸ é“ä¸šåŠ¡ï¼Œä¸»è¦æœåŠ¡äºï¼š</p>
<ul>
<li><strong>EU_CHANNEL</strong>: æ¬§æ´²å¤šå›½ä¸šåŠ¡</li>
<li><strong>GLOBAL_CHANNEL</strong>: å›½é™…ç«™ä¸šåŠ¡</li>
<li><strong>CN_CHANNEL</strong>: å›½å†…ç«™å›½é™…ä¸šåŠ¡</li>
</ul>
<p>ä½œä¸ºæ ¸å¿ƒæœåŠ¡ï¼Œè®¢å•è¯¦æƒ…æŸ¥è¯¢æ˜¯æœ€é«˜é¢‘çš„æ“ä½œä¹‹ä¸€ï¼Œæ¯å¤©å¤„ç†åƒä¸‡çº§æŸ¥è¯¢è¯·æ±‚ã€‚</p>
<h3 data-id="heading-3">äºŒã€æ¶æ„æ¼”è¿›</h3>
<h4 data-id="heading-4">2.1 å•åº“æ—¶ä»£</h4>
<p><strong>è®¢å•å·è®¾è®¡</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨å…¬å¸ç»Ÿä¸€çš„åˆ†å¸ƒå¼ ID æœåŠ¡ï¼ˆåŸºäº Snowflakeï¼‰</li>
<li>orderId ä¸º 64 ä½ Longï¼Œå…¨å±€å”¯ä¸€ã€è¶‹åŠ¿é€’å¢</li>
<li><strong>ä¸åŒ…å«ä»»ä½•ä¸šåŠ¡è·¯ç”±ä¿¡æ¯</strong></li>
</ul>
<p><strong>æŸ¥è¯¢æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_order <span class="hljs-keyword">WHERE</span> order_id <span class="hljs-operator">=</span> ?
</code></pre>
<p>ç®€å•é«˜æ•ˆï¼Œå•åº“è¶³ä»¥æ”¯æ’‘åˆæœŸä¸šåŠ¡é‡ã€‚</p>
<h4 data-id="heading-5">2.2 åˆ†åº“åˆ†è¡¨ï¼ˆè·¯ç”±å›°å¢ƒæµ®ç°ï¼‰</h4>
<p><strong>æ”¹é€ èƒŒæ™¯</strong>ï¼šè®¢å•é‡æŒç»­å¢é•¿ï¼Œå•åº“æ€§èƒ½ç“¶é¢ˆï¼Œå¿…é¡»åˆ†åº“åˆ†è¡¨ã€‚</p>
<p><strong>åˆ†ç‰‡æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>æŒ‰ channel + orderId % 4 æ‹†åˆ†</li>
<li>ä¸åŒæ¸ é“çš„æ•°æ®ç‰©ç†éš”ç¦»</li>
</ul>
<p><strong>é—®é¢˜æ¥äº†</strong>ï¼šè®¢å•å·ä»ç„¶æ˜¯æ™®é€š Snowflake IDï¼Œ<strong>ä¸åŒ…å«è·¯ç”±ä¿¡æ¯</strong>ï¼</p>
<p>æŸ¥è¯¢è®¢å•æ—¶çš„å›°å¢ƒï¼š</p>
<ol>
<li>æ‹¿åˆ° orderIdï¼Œä½†ä¸çŸ¥é“å±äºå“ªä¸ªæ¸ é“</li>
<li>å¿…é¡»å…ˆæŸ¥è¯¢è®¢å•ç´¢å¼•è¡¨ï¼Œè·å–æ¸ é“ä¿¡æ¯</li>
<li>å†æ ¹æ®æ¸ é“ä¿¡æ¯å®šä½åˆ°å…·ä½“åˆ†ç‰‡</li>
</ol>
<p><strong>æ€§èƒ½å½±å“</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">æŸ¥è¯¢è€—æ—¶ï¼šä»å‡ åæ¯«ç§’ â†’ æ•°ç™¾æ¯«ç§’
P99 å»¶è¿Ÿï¼šè¶…è¿‡ <span class="hljs-number">1</span> ç§’
åŸå› ï¼šæ¯æ¬¡æŸ¥è¯¢éƒ½è¦å…ˆ<span class="hljs-string">"æ‰¾åˆ†ç‰‡"</span>
</code></pre>
<h4 data-id="heading-6">2.3 è®¢å•å·ç¼–ç ä¼˜åŒ–ï¼ˆè§£å†³è·¯ç”±é—®é¢˜ï¼‰</h4>
<p><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼šæ”¹é€  ID ç”Ÿæˆé€»è¾‘ï¼Œå°†è·¯ç”±ä¿¡æ¯ç¼–ç åˆ°è®¢å•å·ä¸­ã€‚</p>
<p><strong>çµæ„Ÿæ¥æº</strong>ï¼šèº«ä»½è¯å·</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">èº«ä»½è¯å·:</span> <span class="hljs-number">110101</span> <span class="hljs-number">1990 </span><span class="hljs-number">0101 </span><span class="hljs-string">001X</span>
          <span class="hljs-string">â””â”€â”€â”¬â”€â”˜</span> <span class="hljs-string">â””â”€â”€â”€â”¬â”€â”€â”˜</span> <span class="hljs-string">â””â”¬â”˜</span>
           <span class="hljs-string">åœ°åŒº</span>  <span class="hljs-string">å‡ºç”Ÿæ—¥æœŸ</span>  <span class="hljs-string">åºåˆ—å·</span>
          <span class="hljs-string">(åŒ—äº¬)</span> <span class="hljs-string">(1990.01.01)</span>
</code></pre>
<p>çœ‹åˆ°èº«ä»½è¯å·å‰ 6 ä½ï¼Œå°±çŸ¥é“æ˜¯å“ªä¸ªåœ°åŒºçš„äººï¼Œ<strong>æ— éœ€æŸ¥åº“</strong>ï¼</p>
<p><strong>æ–¹æ¡ˆ</strong>ï¼šåœ¨ 64 ä½è®¢å•å·ä¸­åµŒå…¥ 4 ä½ routeKeyï¼ŒæŸ¥è¯¢æ—¶ç›´æ¥è§£æï¼Œæ— éœ€æŸ¥åº“ã€‚</p>
<p><strong>æ ¸å¿ƒæ”¶ç›Š</strong>ï¼š</p>
<ul>
<li>95% çš„æŸ¥è¯¢æ— éœ€æŸ¥åº“è·å–è·¯ç”±ä¿¡æ¯</li>
<li>æŸ¥è¯¢æ€§èƒ½æ˜¾è‘—æå‡ï¼ˆ<strong>æ•°åå€æå‡</strong>ï¼‰</li>
<li>æ•°æ®åº“è´Ÿè½½é™ä½ 80%</li>
</ul>
<p><strong>å…¼å®¹ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>æ–°è®¢å•ï¼šç¼–ç äº† routeKeyï¼Œå¯ç›´æ¥è§£æ</li>
<li>è€è®¢å•ï¼šæ²¡æœ‰ç¼–ç ä¿¡æ¯ï¼Œèµ°å…œåº•æŸ¥åº“</li>
<li>å¼‚å¸¸æƒ…å†µï¼šä¸‰å±‚é™çº§ç­–ç•¥ä¿è¯å¯ç”¨æ€§</li>
</ul>
<h3 data-id="heading-7">ä¸‰ã€æŠ€æœ¯å®ç°ï¼šè®¢å•å·ç¼–ç </h3>
<h4 data-id="heading-8">3.1 ä½ç»“æ„è®¾è®¡</h4>
<blockquote>
<p>æ–¹æ¡ˆå‚è€ƒäº†ä¸šç•Œæˆç†Ÿçš„åˆ†å¸ƒå¼ ID å®è·µï¼ˆå¦‚ç¾å›¢ Leafï¼‰ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ äº†è·¯ç”±ä¿¡æ¯ç¼–ç ã€‚</p>
</blockquote>
<p>åŸæœ‰ Snowflake ç»“æ„ï¼ˆ64 ä½ï¼‰ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ—¶é—´æˆ³(<span class="hljs-number">41</span>ä½) â”‚ æ•°æ®ä¸­å¿ƒ(<span class="hljs-number">5</span>ä½) â”‚ æœºå™¨<span class="hljs-built_in">ID</span>(<span class="hljs-number">5</span>ä½)   â”‚ åºåˆ—å·(<span class="hljs-number">12</span>ä½)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ”¹é€ å</strong>ï¼šå‹ç¼©æœºå™¨IDï¼Œè…¾å‡º 4 ä½ç»™ routeKey</p>
<p><strong>64 ä½è®¢å•å·ç»“æ„</strong>ï¼š</p>
<pre><code class="hljs language-swift" lang="swift">block<span class="hljs-operator">-</span>beta
    columns <span class="hljs-number">4</span>
    block:timestamp[<span class="hljs-string">"æ—¶é—´æˆ³<span class="hljs-subst">\n</span>41ä½<span class="hljs-subst">\n</span>bit63-23"</span>]
    end
    block:dc[<span class="hljs-string">"æ•°æ®ä¸­å¿ƒ<span class="hljs-subst">\n</span>5ä½<span class="hljs-subst">\n</span>bit22-18"</span>]
    end
    block:routeKey[<span class="hljs-string">"routeKey<span class="hljs-subst">\n</span>4ä½<span class="hljs-subst">\n</span>bit17-14"</span>]
    end
    block:seq[<span class="hljs-string">"åºåˆ—å·<span class="hljs-subst">\n</span>14ä½<span class="hljs-subst">\n</span>bit13-0"</span>]
    end
</code></pre>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ—¶é—´æˆ³(<span class="hljs-number">41</span>ä½)  â”‚ æ•°æ®ä¸­å¿ƒ(<span class="hljs-number">5</span>ä½) â”‚ <span class="hljs-built_in">routeKey</span>(<span class="hljs-number">4</span>ä½) â”‚  åºåˆ—å·(<span class="hljs-number">14</span>ä½)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   bit <span class="hljs-number">63</span>-<span class="hljs-number">23</span>   â”‚   bit <span class="hljs-number">22</span>-<span class="hljs-number">18</span>  â”‚   bit <span class="hljs-number">17</span>-<span class="hljs-number">14</span>  â”‚   bit <span class="hljs-number">13</span>-<span class="hljs-number">0</span>   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  é«˜ä½ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º ä½ä½
</code></pre>
<p><strong>å…³é”®è®¾è®¡ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>routeKey å  4 ä½ï¼ˆ4 bitsï¼‰</strong>ï¼šå¯ä»¥è¡¨ç¤º 16 ç§æ¸ é“ï¼ˆ2^4 = 16ï¼‰</li>
<li><strong>ä½ç½®é€‰æ‹©</strong>ï¼šæ”¾åœ¨åºåˆ—å·ä¹‹å‰ï¼ˆbit 17-14ï¼Œä»é«˜åˆ°ä½ï¼‰ï¼Œä¾¿äºä½è¿ç®—æå–</li>
<li><strong>ç¼–ç æ˜ å°„</strong>ï¼šEU_CHANNEL â†’ 5, GLOBAL_CHANNEL â†’ 2, CN_CHANNEL â†’ 1</li>
</ul>
<h4 data-id="heading-9">3.2 ä¸ºä»€ä¹ˆæ˜¯ 4 ä½ï¼Ÿ</h4>
<p><strong>å®¹é‡è®¡ç®—</strong>ï¼š</p>
<ul>
<li>å½“å‰ä¸šåŠ¡æœ‰ 3 ä¸ªä¸»è¦æ¸ é“</li>
<li>æœªæ¥å¯èƒ½å¢åŠ æ›´å¤šæ¸ é“</li>
<li>4 ä½å¯ä»¥è¡¨ç¤º 16 ç§æ¸ é“ï¼Œ<strong>é¢„ç•™ 13 ç§æ‰©å±•ç©ºé—´</strong></li>
</ul>
<p><strong>ä½æ•°æƒè¡¡</strong>ï¼š</p>
<ul>
<li>å¤ªå°‘ï¼ˆ2 ä½ï¼‰ï¼šåªèƒ½è¡¨ç¤º 4 ç§æ¸ é“ï¼Œæ‰©å±•æ€§ä¸è¶³</li>
<li>å¤ªå¤šï¼ˆ8 ä½ï¼‰ï¼šæµªè´¹ç©ºé—´ï¼ŒæŒ¤å‹åºåˆ—å·ä½æ•°ï¼Œå½±å“å¹¶å‘æ€§èƒ½</li>
<li><strong>4 ä½åˆšå¥½</strong>ï¼šæ»¡è¶³å½“å‰éœ€æ±‚ + æœªæ¥æ‰©å±•</li>
</ul>
<h4 data-id="heading-10">3.3 ç¼–ç è¿‡ç¨‹ï¼ˆå®Œæ•´æµç¨‹ï¼‰</h4>
<p><strong>è®¢å•å·ç”Ÿæˆæ—¶åºå›¾</strong>ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant OrderService as è®¢å•æœåŠ¡
    participant IdGenerator as IDç”Ÿæˆå™¨
    participant UserDataService as ç”¨æˆ·æ•°æ®æœåŠ¡
    
    Client-&gt;&gt;OrderService: ä¸‹å•è¯·æ±‚(region=GB)
    OrderService-&gt;&gt;UserDataService: æŸ¥è¯¢ routeKey(region)
    UserDataService--&gt;&gt;OrderService: EU_CHANNEL
    OrderService-&gt;&gt;IdGenerator: ç”Ÿæˆè®¢å•å·(routeKey)
    Note over IdGenerator: ä½è¿ç®—ç¼–ç  routeKey
    IdGenerator--&gt;&gt;OrderService: orderId(å«è·¯ç”±ä¿¡æ¯)
    OrderService--&gt;&gt;Client: è®¢å•åˆ›å»ºæˆåŠŸ
</code></pre>
<p><strong>æ­¥éª¤ 1</strong>ï¼šç”¨æˆ·ä¼ å…¥ <code>region</code>ï¼ˆç”¨æˆ·åœ°åŒºï¼Œå›½å®¶ä»£ç ï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç”¨æˆ·ä¸‹å•æ—¶ä¼ å…¥ region</span>
<span class="hljs-type">GenerateOrderIdRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenerateOrderIdRequest</span>();
request.setRegion(<span class="hljs-string">"GB"</span>);  <span class="hljs-comment">// è‹±å›½</span>
request.setUid(<span class="hljs-string">"user123"</span>);
</code></pre>
<p><strong>æ­¥éª¤ 2</strong>ï¼šregion â†’ routeKey æ˜ å°„</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®¢å•å·ç”ŸæˆæœåŠ¡å†…éƒ¨ä¼šå°† region æ˜ å°„ä¸º routeKey</span>
<span class="hljs-comment">// GB (è‹±å›½) â†’ EU_CHANNEL</span>
<span class="hljs-comment">// ES (è¥¿ç­ç‰™) â†’ EU_CHANNEL</span>
<span class="hljs-comment">// CN (ä¸­å›½) â†’ CN_CHANNEL</span>
<span class="hljs-comment">// è¿™ä¸ªæ˜ å°„å…³ç³»ç”±ç”¨æˆ·æ•°æ®æœåŠ¡ç»´æŠ¤</span>

<span class="hljs-type">GenerateOrderIdRequest</span> <span class="hljs-variable">generateOrderIdRequest</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenerateOrderIdRequest</span>();
generateOrderIdRequest.setUid(request.getUid());
generateOrderIdRequest.setRegion(request.getRegion());

<span class="hljs-comment">// è°ƒç”¨è®¢å•å·ç”ŸæˆæœåŠ¡</span>
<span class="hljs-type">Long</span> <span class="hljs-variable">orderId</span> <span class="hljs-operator">=</span> idGeneratorService.generateId(generateOrderIdRequest).getOrderId();
</code></pre>
<p><strong>æ­¥éª¤ 3</strong>ï¼šrouteKey â†’ 4 ä½ç¼–ç </p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®¢å•å·ç”ŸæˆæœåŠ¡å†…éƒ¨å®ç°ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderIdEncoder</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">encodeRouteKey</span><span class="hljs-params">(String routeKey)</span> {
        <span class="hljs-comment">// routeKey æ˜ å°„ä¸º 4 ä½æ•´æ•°</span>
        <span class="hljs-keyword">switch</span> (routeKey) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"EU_CHANNEL"</span>:     <span class="hljs-keyword">return</span> <span class="hljs-number">5</span>;   <span class="hljs-comment">// 0101</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">"GLOBAL_CHANNEL"</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;   <span class="hljs-comment">// 0010</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">"BIZ_CHANNEL"</span>:    <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>;   <span class="hljs-comment">// 0011</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">"CN_CHANNEL"</span>:     <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;   <span class="hljs-comment">// 0001</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">"CORP_CHANNEL"</span>:   <span class="hljs-keyword">return</span> <span class="hljs-number">4</span>;   <span class="hljs-comment">// 0100</span>
            <span class="hljs-keyword">default</span>:               <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;   <span class="hljs-comment">// 0000 (å¼‚å¸¸æƒ…å†µ)</span>
        }
    }
}
</code></pre>
<p><strong>æ­¥éª¤ 4</strong>ï¼šæ‹¼æ¥åˆ° orderIdï¼ˆä½è¿ç®—ï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Snowflake æ”¹é€ ç‰ˆæœ¬ï¼ˆä¼ªä»£ç ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">generateOrderId</span><span class="hljs-params">(String routeKey)</span> {
    <span class="hljs-comment">// 1. è·å–å½“å‰æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">timestamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis() - EPOCH;  <span class="hljs-comment">// ç›¸å¯¹æ—¶é—´æˆ³</span>

    <span class="hljs-comment">// 2. è·å–æ•°æ®ä¸­å¿ƒ ID</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">datacenter</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;  <span class="hljs-comment">// å‡è®¾å½“å‰æ•°æ®ä¸­å¿ƒ ID ä¸º 3</span>

    <span class="hljs-comment">// 3. ç¼–ç  routeKey</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">routeKeyBits</span> <span class="hljs-operator">=</span> encodeRouteKey(routeKey);  <span class="hljs-comment">// 5 (EU_CHANNEL)</span>

    <span class="hljs-comment">// 4. è·å–åºåˆ—å·ï¼ˆåŒä¸€æ¯«ç§’å†…é€’å¢ï¼‰</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">sequence</span> <span class="hljs-operator">=</span> getSequence();  <span class="hljs-comment">// å‡è®¾å½“å‰åºåˆ—å·ä¸º 123</span>

    <span class="hljs-comment">// 5. ä½æ‹¼æ¥ï¼šå°†å„æ®µä¿¡æ¯æ‹¼æ¥æˆ 64 ä½ Long</span>
    <span class="hljs-comment">//    æ—¶é—´æˆ³(41ä½) | æ•°æ®ä¸­å¿ƒ(5ä½) | routeKey(4ä½) | åºåˆ—å·(14ä½)</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">orderId</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    orderId |= (timestamp &lt;&lt; <span class="hljs-number">23</span>);        <span class="hljs-comment">// æ—¶é—´æˆ³å·¦ç§» 23 ä½ï¼ˆ5+4+14ï¼‰</span>
    orderId |= (datacenter &lt;&lt; <span class="hljs-number">18</span>);       <span class="hljs-comment">// æ•°æ®ä¸­å¿ƒå·¦ç§» 18 ä½ï¼ˆ4+14ï¼‰</span>
    orderId |= (routeKeyBits &lt;&lt; <span class="hljs-number">14</span>);     <span class="hljs-comment">// routeKey å·¦ç§» 14 ä½ â¬…ï¸ å…³é”®ï¼</span>
    orderId |= sequence;                  <span class="hljs-comment">// åºåˆ—å·å æ®ä½ 14 ä½</span>

    <span class="hljs-keyword">return</span> orderId;
}
</code></pre>
<p><strong>ç”Ÿæˆçš„è®¢å•å·ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">åè¿›åˆ¶:</span> <span class="hljs-number">1234567890123456789</span>
<span class="hljs-string">äºŒè¿›åˆ¶:</span> <span class="hljs-number">0001 </span><span class="hljs-number">0001 </span><span class="hljs-number">0010 </span><span class="hljs-number">0011 </span><span class="hljs-number">0100 </span><span class="hljs-number">0101 </span><span class="hljs-number">0110 </span><span class="hljs-number">0111</span>
        <span class="hljs-number">1000 </span><span class="hljs-number">1001 </span><span class="hljs-number">0000 </span><span class="hljs-number">0001 </span><span class="hljs-number">0010 </span><span class="hljs-number">0011 </span><span class="hljs-number">0100 </span><span class="hljs-number">0101</span>
                                 <span class="hljs-string">â†‘</span> <span class="hljs-string">(bit</span> <span class="hljs-number">17</span><span class="hljs-number">-14</span><span class="hljs-string">)</span>
                           <span class="hljs-string">routeKey</span> <span class="hljs-string">=</span> <span class="hljs-number">0101</span>
                           <span class="hljs-string">(å€¼</span> <span class="hljs-number">5</span> <span class="hljs-string">â†’</span> <span class="hljs-string">EU_CHANNEL)</span>
</code></pre>
<p><strong>å…³é”®æŠ€æœ¯</strong>ï¼š</p>
<ul>
<li><strong>å·¦ç§»è¿ç®—ï¼ˆ&lt;&lt;ï¼‰</strong>ï¼šå°†æ•°æ®ç§»åˆ°æŒ‡å®šä½ç½®</li>
<li><strong>æˆ–è¿ç®—ï¼ˆ|ï¼‰</strong>ï¼šæ‹¼æ¥å¤šæ®µæ•°æ®</li>
<li><strong>æ— æŸç¼–ç </strong>ï¼šæ‰€æœ‰ä¿¡æ¯éƒ½ä¿ç•™åœ¨ 64 ä½ Long ä¸­</li>
</ul>
<h4 data-id="heading-11">3.4 è§£ç è¿‡ç¨‹ï¼ˆåå‘æå–ï¼‰</h4>
<p><strong>å®Œæ•´çš„ getRouteKey æ–¹æ³•</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getRouteKey</span><span class="hljs-params">(Long orderId)</span> {
    <span class="hljs-type">OrderIdDecoder</span> <span class="hljs-variable">orderIdDecoder</span> <span class="hljs-operator">=</span> OrderIdFactory.getOrderIdDecoder();

    <span class="hljs-comment">// ã€ç¬¬ä¸€å±‚ã€‘ä¼˜å…ˆä» orderId è§£æ</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">routeKey</span> <span class="hljs-operator">=</span> orderIdDecoder.decodeRouteKey(orderId);
    <span class="hljs-keyword">if</span> (StringUtils.isEmpty(routeKey)) {
        <span class="hljs-comment">// ã€ç¬¬äºŒå±‚ã€‘å…¶æ¬¡ä»è¯·æ±‚ä¸Šä¸‹æ–‡è·å–</span>
        routeKey = RequestContext.get(<span class="hljs-string">"routeKey"</span>);
    }

    <span class="hljs-keyword">if</span> (StringUtils.isEmpty(routeKey)) {
        <span class="hljs-comment">// ã€ç¬¬ä¸‰å±‚ã€‘æœ€åä» region æ¨æ–­</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">region</span> <span class="hljs-operator">=</span> RequestContext.get(<span class="hljs-string">"region"</span>);
        Optional&lt;String&gt; routeKeyByRegion = DataMappingService.getRouteKey(region);
        routeKey = routeKeyByRegion.orElse(<span class="hljs-string">""</span>);
    }

    <span class="hljs-keyword">return</span> routeKey;
}
</code></pre>
<p><strong>OrderIdDecoder å†…éƒ¨å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderIdDecoder</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">ROUTE_KEY_OFFSET</span> <span class="hljs-operator">=</span> <span class="hljs-number">14</span>;   <span class="hljs-comment">// å³ç§» 14 ä½</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">ROUTE_KEY_MASK</span> <span class="hljs-operator">=</span> <span class="hljs-number">0xF</span>;   <span class="hljs-comment">// ä½ 4 ä½æ©ç ï¼ˆ0b1111ï¼‰</span>

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">decodeRouteKey</span><span class="hljs-params">(Long orderId)</span> {
        <span class="hljs-keyword">if</span> (orderId == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä½è¿ç®—æå– routeKeyï¼ˆbit14-17ï¼Œå³ç§» 14 ä½åå–ä½ 4 ä½ï¼‰</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">routeKeyBits</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>)((orderId &gt;&gt; ROUTE_KEY_OFFSET) &amp; ROUTE_KEY_MASK);

            <span class="hljs-comment">// è§£ç ä¸ºå­—ç¬¦ä¸²</span>
            <span class="hljs-keyword">return</span> decodeRouteKeyBits(routeKeyBits);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"è§£æ orderId å¤±è´¥: {}"</span>, orderId, e);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">decodeRouteKeyBits</span><span class="hljs-params">(<span class="hljs-type">int</span> bits)</span> {
        <span class="hljs-keyword">switch</span> (bits) {
            <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"EU_CHANNEL"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"GLOBAL_CHANNEL"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"BIZ_CHANNEL"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"CN_CHANNEL"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"CORP_CHANNEL"</span>;
            <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;  <span class="hljs-comment">// è§£æå¤±è´¥</span>
        }
    }
}
</code></pre>
<p><strong>è§£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç¤ºä¾‹è®¢å•å·</span>
<span class="hljs-type">Long</span> <span class="hljs-variable">orderId</span> <span class="hljs-operator">=</span> <span class="hljs-number">1234567890123456789L</span>;

<span class="hljs-comment">// ä½è¿ç®—è¿‡ç¨‹ï¼š</span>
<span class="hljs-comment">// 1. å³ç§» 14 ä½ï¼šorderId &gt;&gt; 14</span>
<span class="hljs-comment">// 2. å–ä½ 4 ä½ï¼š&amp; 0xF (0b1111)</span>

<span class="hljs-type">int</span> <span class="hljs-variable">routeKeyBits</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>)((orderId &gt;&gt; <span class="hljs-number">14</span>) &amp; <span class="hljs-number">0xF</span>);  <span class="hljs-comment">// æå– routeKey</span>
<span class="hljs-type">String</span> <span class="hljs-variable">routeKey</span> <span class="hljs-operator">=</span> decodeRouteKeyBits(routeKeyBits);  <span class="hljs-comment">// æ˜ å°„ä¸ºæ¸ é“åç§°</span>
</code></pre>
<h3 data-id="heading-12">å››ã€ä¸‰å±‚è·¯ç”±ç­–ç•¥</h3>
<h4 data-id="heading-13">4.1 è®¾è®¡ç†å¿µ</h4>
<p><strong>æ ¸å¿ƒé—®é¢˜</strong>ï¼šä¸æ˜¯æ‰€æœ‰è®¢å•éƒ½èƒ½è§£ææˆåŠŸ</p>
<ul>
<li>æ–°è®¢å•ï¼šç¼–ç äº† routeKeyï¼Œå¯ä»¥ç›´æ¥è§£æ</li>
<li>è€è®¢å•ï¼šæ²¡æœ‰ç¼–ç ä¿¡æ¯ï¼Œæ— æ³•è§£æ</li>
<li>å¼‚å¸¸æƒ…å†µï¼šè§£æå¤±è´¥ã€æ•°æ®å¼‚å¸¸ç­‰</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä¸‰å±‚è·¯ç”±ç­–ç•¥ï¼ˆé€å±‚é™çº§ï¼‰</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[æŸ¥è¯¢è¯·æ±‚ orderId] --&gt; B{Layer 0: ç¼“å­˜}
    B --&gt;|å‘½ä¸­| C[è¿”å›åˆ†ç‰‡ç´¢å¼•]
    B --&gt;|æœªå‘½ä¸­| D{Layer 1: orderId è§£æ}
    D --&gt;|è§£ææˆåŠŸ| E[è®¡ç®—åˆ†ç‰‡ç´¢å¼•]
    E --&gt; F[å†™å…¥ç¼“å­˜]
    F --&gt; C
    D --&gt;|è§£æå¤±è´¥| G{Layer 2: è¯·æ±‚ä¸Šä¸‹æ–‡}
    G --&gt;|è·å–æˆåŠŸ| E
    G --&gt;|è·å–å¤±è´¥| H{Layer 3: æŸ¥åº“å…œåº•}
    H --&gt;|æŸ¥è¯¢æˆåŠŸ| E
    H --&gt;|æŸ¥è¯¢å¤±è´¥| I[è¿”å›é»˜è®¤åˆ†ç‰‡]
</code></pre>
<p><strong>å„å±‚èŒè´£</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æŸ¥è¯¢è¯·æ±‚ï¼ˆorderIdï¼‰                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€Layer 0ã€‘ç¼“å­˜å±‚                                            â”‚
â”‚ å‘½ä¸­ â†’ ç›´æ¥è¿”å›åˆ†ç‰‡ç´¢å¼•                                        â”‚
â”‚ æœªå‘½ä¸­ â†’ è¿›å…¥ Layer 1                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€Layer 1ã€‘orderId è§£æå±‚                                     â”‚
â”‚ ä» orderId ä½è¿ç®—æå– routeKey                             â”‚
â”‚ æˆåŠŸ â†’ è®¡ç®—åˆ†ç‰‡ç´¢å¼•ï¼Œå†™å…¥ç¼“å­˜ï¼Œè¿”å›                              â”‚
â”‚ å¤±è´¥ â†’ è¿›å…¥ Layer 2                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€Layer 2ã€‘ä¸Šä¸‹æ–‡è·å–å±‚                                        â”‚
â”‚ ä»è¯·æ±‚ä¸Šä¸‹æ–‡è·å– routeKey / region                             â”‚
â”‚ æˆåŠŸ â†’ è®¡ç®—åˆ†ç‰‡ç´¢å¼•ï¼Œå†™å…¥ç¼“å­˜ï¼Œè¿”å›                              â”‚
â”‚ å¤±è´¥ â†’ è¿›å…¥ Layer 3                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€Layer 3ã€‘æŸ¥åº“å…œåº•å±‚                                         â”‚
â”‚ æŸ¥è¯¢è®¢å•ç´¢å¼•è¡¨è·å–æ¸ é“å­—æ®µ                                      â”‚
â”‚ æˆåŠŸ â†’ è®¡ç®—åˆ†ç‰‡ç´¢å¼•ï¼Œå†™å…¥ç¼“å­˜ï¼Œè¿”å›                              â”‚
â”‚ å¤±è´¥ â†’ è¿”å›é»˜è®¤åˆ†ç‰‡ï¼ˆå…œåº•ï¼‰                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<h4 data-id="heading-14">4.2 å„å±‚å æ¯”ï¼ˆå®é™…æ•°æ®ï¼‰</h4>






























<table><thead><tr><th>è·¯ç”±å±‚</th><th>å æ¯”</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>Layer 0ï¼ˆç¼“å­˜ï¼‰</strong></td><td>95%+</td><td>ç»å¤§éƒ¨åˆ†è¯·æ±‚å‘½ä¸­ç¼“å­˜</td></tr><tr><td><strong>Layer 1ï¼ˆorderId è§£æï¼‰</strong></td><td>70-80%</td><td>æ–°è®¢å•ç›´æ¥è§£æ</td></tr><tr><td><strong>Layer 2ï¼ˆä¸Šä¸‹æ–‡ï¼‰</strong></td><td>5-10%</td><td>é“¾è·¯ä¸­æºå¸¦ä¿¡æ¯</td></tr><tr><td><strong>Layer 3ï¼ˆæŸ¥åº“å…œåº•ï¼‰</strong></td><td>15-25%</td><td>è€è®¢å• + å¼‚å¸¸æƒ…å†µ</td></tr></tbody></table>
<p><strong>ç›®æ ‡</strong>ï¼šé€æ­¥é™ä½ Layer 3 å æ¯”ï¼Œæœ€ç»ˆ &lt; 5%</p>
<h3 data-id="heading-15">äº”ã€æ ¸å¿ƒä»£ç å®ç°</h3>
<h4 data-id="heading-16">5.1 ç¼“å­˜å±‚å®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShardingCacheHelper</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CACHE_PREFIX</span> <span class="hljs-operator">=</span> <span class="hljs-string">"shard:"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CACHE_EXPIRE_SECONDS</span> <span class="hljs-operator">=</span> <span class="hljs-number">24</span> * <span class="hljs-number">3600</span>;  <span class="hljs-comment">// 24å°æ—¶</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> CacheService cacheService;

    <span class="hljs-comment">/**
     * è·å–åˆ†ç‰‡ç´¢å¼•ï¼ˆå¸¦ç¼“å­˜ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">getShardIndex</span><span class="hljs-params">(Long orderId)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> CACHE_PREFIX + orderId;

        <span class="hljs-comment">// 1. å…ˆæŸ¥ç¼“å­˜</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">cachedValue</span> <span class="hljs-operator">=</span> cacheService.get(cacheKey);
        <span class="hljs-keyword">if</span> (StringUtils.isNotEmpty(cachedValue)) {
            <span class="hljs-keyword">return</span> Integer.parseInt(cachedValue);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;  <span class="hljs-comment">// ç¼“å­˜æœªå‘½ä¸­</span>
    }

    <span class="hljs-comment">/**
     * å†™å…¥ç¼“å­˜
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setShardIndex</span><span class="hljs-params">(Long orderId, <span class="hljs-type">int</span> shardIndex)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> CACHE_PREFIX + orderId;
        cacheService.setEx(cacheKey, String.valueOf(shardIndex), CACHE_EXPIRE_SECONDS);
    }
}
</code></pre>
<h4 data-id="heading-17">5.2 åˆ†ç‰‡å®šä½å™¨å®Œæ•´å®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShardingRouter</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SHARD_COUNT</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;  <span class="hljs-comment">// æ¯ä¸ªæ¸ é“çš„åˆ†ç‰‡æ•°é‡</span>
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ShardingCacheHelper cacheHelper;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OrderDao orderDao;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChannelShardConfig channelShardConfig;  <span class="hljs-comment">// æ¸ é“åˆ†ç‰‡é…ç½®</span>

    <span class="hljs-comment">/**
     * å®šä½è®¢å•æ‰€åœ¨åˆ†ç‰‡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">locate</span><span class="hljs-params">(Long orderId)</span> {
        <span class="hljs-comment">// ã€Layer 0ã€‘ç¼“å­˜å±‚</span>
        <span class="hljs-type">Integer</span> <span class="hljs-variable">cachedIndex</span> <span class="hljs-operator">=</span> cacheHelper.getShardIndex(orderId);
        <span class="hljs-keyword">if</span> (cachedIndex != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> cachedIndex;
        }

        <span class="hljs-comment">// ã€Layer 1ã€‘orderId è§£æå±‚</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">routeKey</span> <span class="hljs-operator">=</span> getRouteKey(orderId);
        <span class="hljs-keyword">if</span> (StringUtils.isNotEmpty(routeKey)) {
            <span class="hljs-type">int</span> <span class="hljs-variable">shardIndex</span> <span class="hljs-operator">=</span> calculateShardIndex(routeKey, orderId);
            cacheHelper.setShardIndex(orderId, shardIndex);
            <span class="hljs-keyword">return</span> shardIndex;
        }

        <span class="hljs-comment">// ã€Layer 2 &amp; 3ã€‘ä¸Šä¸‹æ–‡ + æŸ¥åº“å…œåº•</span>
        <span class="hljs-keyword">return</span> fallbackLocate(orderId);
    }

    <span class="hljs-comment">/**
     * è®¡ç®—åˆ†ç‰‡ç´¢å¼•
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">calculateShardIndex</span><span class="hljs-params">(String routeKey, Long orderId)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">baseIndex</span> <span class="hljs-operator">=</span> getBaseIndex(routeKey);
        <span class="hljs-type">int</span> <span class="hljs-variable">offset</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>)(orderId % SHARD_COUNT);  <span class="hljs-comment">// åˆ†ç‰‡æ•°é‡</span>
        <span class="hljs-keyword">return</span> baseIndex + offset;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getBaseIndex</span><span class="hljs-params">(String routeKey)</span> {
        <span class="hljs-comment">// ä¸åŒæ¸ é“å¯¹åº”ä¸åŒçš„åˆ†ç‰‡åŸºç¡€ç´¢å¼•</span>
        <span class="hljs-comment">// å…·ä½“æ˜ å°„å…³ç³»æ ¹æ®ä¸šåŠ¡é…ç½®</span>
        <span class="hljs-keyword">return</span> channelShardConfig.getBaseIndex(routeKey);
    }

    <span class="hljs-comment">/**
     * å…œåº•å®šä½ï¼ˆæŸ¥åº“ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">fallbackLocate</span><span class="hljs-params">(Long orderId)</span> {
        <span class="hljs-comment">// 1. æŸ¥è¯¢è®¢å•ç´¢å¼•è¡¨</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderDao.queryById(orderId);
        <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> ShardIndex.OTHER.getIndex();  <span class="hljs-comment">// é»˜è®¤åˆ†ç‰‡</span>
        }

        <span class="hljs-comment">// 2. æ ¹æ®æ¸ é“å­—æ®µè®¡ç®—åˆ†ç‰‡ç´¢å¼•</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> order.getChannel();
        <span class="hljs-type">int</span> <span class="hljs-variable">shardIndex</span> <span class="hljs-operator">=</span> calculateShardIndex(channel, orderId);

        <span class="hljs-comment">// 3. å†™å…¥ç¼“å­˜ï¼ˆé¿å…é‡å¤æŸ¥åº“ï¼‰</span>
        cacheHelper.setShardIndex(orderId, shardIndex);

        <span class="hljs-keyword">return</span> shardIndex;
    }
}
</code></pre>
<h3 data-id="heading-18">å…­ã€è¸©å‘ä¸ç»éªŒ</h3>
<h4 data-id="heading-19">6.1 å®é™…é‡åˆ°çš„é—®é¢˜</h4>
<p><strong>é—®é¢˜ 1ï¼šè°ƒç”¨æ–¹æœªä¼  region å‚æ•°</strong></p>
<p><strong>ç°è±¡</strong>ï¼š</p>
<ul>
<li>ä¸Šçº¿åå‘ç°å…œåº•æŸ¥åº“æ¯”ä¾‹é«˜è¾¾ 25%+</li>
<li>ç›‘æ§æ˜¾ç¤ºå¤§é‡è®¢å•å·è§£æå¤±è´¥</li>
</ul>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li>ID ç”ŸæˆæœåŠ¡å‡çº§åï¼Œéœ€è¦è°ƒç”¨æ–¹ä¼ å…¥ region å‚æ•°</li>
<li>éƒ¨åˆ†è€æ¥å£ã€å®šæ—¶ä»»åŠ¡ã€æ¶ˆæ¯æ¶ˆè´¹è€…æœªåŠæ—¶æ”¹é€ </li>
<li>ç”Ÿæˆçš„è®¢å•å·ä¸­ routeKey ä½æ®µä¸º 0ï¼Œæ— æ³•è§£æ</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. åœ¨ ID ç”ŸæˆæœåŠ¡å¢åŠ ç›‘æ§åŸ‹ç‚¹</span>
<span class="hljs-keyword">if</span> (StringUtils.isEmpty(request.getRegion())) {
    <span class="hljs-comment">// è®°å½•è°ƒç”¨æ¥æºï¼Œä¾¿äºæ¨åŠ¨æ”¹é€ </span>
    metric(<span class="hljs-string">"id_gen_no_region"</span>, getCallerService());
}

<span class="hljs-comment">// 2. è¾“å‡º Top N æœªä¼  region çš„æœåŠ¡ï¼Œé€ä¸ªæ¨åŠ¨æ”¹é€ </span>
<span class="hljs-comment">// 3. è®¾ç½® deadlineï¼Œæœªæ”¹é€ çš„æœåŠ¡é™ä½ä¼˜å…ˆçº§</span>
</code></pre>
<p><strong>é—®é¢˜ 2ï¼šå†å²è®¢å•å…¼å®¹</strong></p>
<p><strong>ç°è±¡</strong>ï¼š</p>
<ul>
<li>æ”¹é€ å‰å·²å­˜åœ¨çš„è®¢å•ï¼ˆç™¾ä¸‡çº§ï¼‰æ— æ³•è§£æ routeKey</li>
<li>è¿™äº›è®¢å•ä»ç„¶æœ‰æŸ¥è¯¢éœ€æ±‚ï¼ˆå”®åã€å¯¹è´¦ç­‰ï¼‰</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>è®¾è®¡ä¸‰å±‚é™çº§ç­–ç•¥ï¼ˆè§ç¬¬å››ç« ï¼‰</li>
<li>å†å²è®¢å•èµ°å…œåº•æŸ¥åº“ + ç¼“å­˜</li>
<li>éšç€æ—¶é—´æ¨ç§»ï¼Œå†å²è®¢å•æŸ¥è¯¢å æ¯”è‡ªç„¶ä¸‹é™</li>
</ul>
<p><strong>é—®é¢˜ 3ï¼šç°åº¦å‘å¸ƒæ—¶çš„æ•°æ®ä¸€è‡´æ€§</strong></p>
<p><strong>ç°è±¡</strong>ï¼š</p>
<ul>
<li>ç°åº¦æœŸé—´ï¼Œéƒ¨åˆ†æœºå™¨ç”¨æ–°ç‰ˆ ID ç”Ÿæˆé€»è¾‘ï¼Œéƒ¨åˆ†ç”¨æ—§ç‰ˆ</li>
<li>åŒä¸€æ¸ é“çš„è®¢å•ï¼Œæœ‰çš„èƒ½è§£æï¼Œæœ‰çš„ä¸èƒ½</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æŒ‰æ¸ é“ç°åº¦ï¼Œè€Œä¸æ˜¯æŒ‰æœºå™¨ç°åº¦</span>
<span class="hljs-comment">// ç¡®ä¿åŒä¸€æ¸ é“çš„è®¢å•è¦ä¹ˆå…¨éƒ¨æ–°ç‰ˆï¼Œè¦ä¹ˆå…¨éƒ¨æ—§ç‰ˆ</span>
<span class="hljs-keyword">if</span> (grayConfig.isNewVersionEnabled(routeKey)) {
    <span class="hljs-keyword">return</span> newIdGenerator.generate(request);
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> oldIdGenerator.generate(request);
}
</code></pre>
<h4 data-id="heading-20">6.2 è®¾è®¡æƒè¡¡</h4>
<p><strong>æƒè¡¡ 1ï¼šä¸ºä»€ä¹ˆä¸ç”¨ UUIDï¼Ÿ</strong></p>























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>ç»“è®º</th></tr></thead><tbody><tr><td><strong>UUID</strong></td><td>â€¢ å…¨å±€å”¯ä¸€<br/>â€¢ æ— éœ€åè°ƒ</td><td>â€¢ 128 ä½å¤ªé•¿<br/>â€¢ æ— åºï¼Œå½±å“ B+ æ ‘æ€§èƒ½<br/>â€¢ æ— æ³•ç¼–ç ä¸šåŠ¡ä¿¡æ¯</td><td>âŒ ä¸é‡‡ç”¨</td></tr><tr><td><strong>Snowflake</strong></td><td>â€¢ 64 ä½ç´§å‡‘<br/>â€¢ å•è°ƒé€’å¢<br/>â€¢ å¯ç¼–ç ä¸šåŠ¡ä¿¡æ¯</td><td>â€¢ éœ€è¦åè°ƒæœºå™¨ ID</td><td>âœ… <strong>é‡‡ç”¨</strong></td></tr></tbody></table>
<p><strong>æƒè¡¡ 2ï¼šä¸ºä»€ä¹ˆåªç¼–ç  routeKeyï¼Ÿ</strong></p>
<p><strong>è€ƒè™‘è¿‡çš„æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>æ–¹æ¡ˆ 1ï¼šç¼–ç æ›´å¤šä¿¡æ¯ï¼ˆå›½å®¶ã€ç”¨æˆ·ç±»å‹ã€ä¸šåŠ¡çº¿ç­‰ï¼‰</li>
<li>æ–¹æ¡ˆ 2ï¼šåªç¼–ç æœ€å…³é”®çš„è·¯ç”±ä¿¡æ¯ï¼ˆrouteKeyï¼‰</li>
</ul>
<p><strong>æœ€ç»ˆé€‰æ‹©æ–¹æ¡ˆ 2</strong>ï¼š</p>
<ul>
<li>64 ä½ç©ºé—´æœ‰é™ï¼Œæ¯å¢åŠ  1 ä½ç¼–ç ï¼Œåºåˆ—å·å°±å‡å°‘ 1 ä½</li>
<li>åºåˆ—å·è¶Šå°‘ï¼Œå¹¶å‘æ€§èƒ½è¶Šå·®ï¼ˆåŒä¸€æ¯«ç§’å†…å¯ç”Ÿæˆçš„ ID æ•°é‡ï¼‰</li>
<li>routeKey æ˜¯åˆ†ç‰‡è·¯ç”±çš„å”¯ä¸€ä¾æ®ï¼Œä¼˜å…ˆä¿è¯è·¯ç”±æ€§èƒ½</li>
<li>å…¶ä»–ä¿¡æ¯å¯ä»¥é€šè¿‡æŸ¥è¯¢è®¢å•ç´¢å¼•è¡¨è·å–</li>
</ul>
<p><strong>æƒè¡¡ 3ï¼šä¸ºä»€ä¹ˆä¿ç•™å…œåº•æŸ¥åº“ï¼Ÿ</strong></p>
<p><strong>ç†æƒ³çŠ¶æ€</strong>ï¼š100% è§£ææˆåŠŸï¼Œå®Œå…¨ä¸æŸ¥åº“</p>
<p><strong>ç°å®æƒ…å†µ</strong>ï¼š</p>
<ul>
<li>è€è®¢å•ï¼ˆ10-20%ï¼‰æ— æ³•é¿å…</li>
<li>è€ä»£ç å‡çº§éœ€è¦æ—¶é—´ï¼ˆ5-10%ï¼‰</li>
<li>å¼‚å¸¸æƒ…å†µéš¾ä»¥æœç»ï¼ˆ1-2%ï¼‰</li>
</ul>
<p><strong>æƒè¡¡ç»“æœ</strong>ï¼š</p>
<ul>
<li>âœ… ä¿ç•™å…œåº•æŸ¥åº“ï¼Œç¡®ä¿ç³»ç»Ÿ 100% å¯ç”¨</li>
<li>âœ… é€šè¿‡ç›‘æ§æ¨åŠ¨è§£ææˆåŠŸç‡é€æ­¥æå‡</li>
<li>âœ… ç›®æ ‡ï¼šLayer 3 å æ¯”ä» 25% â†’ 10% â†’ 5% â†’ 1%</li>
</ul>
<h4 data-id="heading-21">6.3 ç›‘æ§ä¸ä¼˜åŒ–</h4>
<p><strong>å…³é”®ç›‘æ§æŒ‡æ ‡</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. è®°å½•è§£æå¤±è´¥çš„è®¢å•å·</span>
metricError(<span class="hljs-string">"orderId_decode_failed"</span>, orderId);

<span class="hljs-comment">// 2. ç»Ÿè®¡å„å±‚è·¯ç”±å æ¯”</span>
metric(<span class="hljs-string">"route_cache_hit"</span>, count);       <span class="hljs-comment">// ç¼“å­˜å‘½ä¸­</span>
metric(<span class="hljs-string">"route_layer_1"</span>, count);         <span class="hljs-comment">// orderId è§£æ</span>
metric(<span class="hljs-string">"route_layer_2"</span>, count);         <span class="hljs-comment">// ä¸Šä¸‹æ–‡è·å–</span>
metric(<span class="hljs-string">"route_layer_3"</span>, count);         <span class="hljs-comment">// æŸ¥åº“å…œåº•</span>

<span class="hljs-comment">// 3. ç»Ÿè®¡è§£æå¤±è´¥åŸå› </span>
metric(<span class="hljs-string">"decode_fail_no_region"</span>, count);    <span class="hljs-comment">// æ²¡ä¼  region</span>
metric(<span class="hljs-string">"decode_fail_old_order"</span>, count); <span class="hljs-comment">// è€è®¢å•</span>
metric(<span class="hljs-string">"decode_fail_exception"</span>, count); <span class="hljs-comment">// è§£æå¼‚å¸¸</span>
</code></pre>
<p><strong>ç›‘æ§é¢æ¿ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">è®¢å•å·è§£ææˆåŠŸç‡ï¼ˆå®æ—¶ï¼‰</span>
<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">æ€»è¯·æ±‚æ•°:</span> <span class="hljs-number">1</span><span class="hljs-string">,000,000</span>                     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">ç¼“å­˜å‘½ä¸­:</span> <span class="hljs-number">950</span><span class="hljs-string">,000</span> <span class="hljs-string">(95%)</span>  <span class="hljs-string">âœ…</span>             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Layer 1:</span>  <span class="hljs-number">750</span><span class="hljs-string">,000</span> <span class="hljs-string">(75%)</span>  <span class="hljs-string">âœ…</span>             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Layer 2:</span>   <span class="hljs-number">50</span><span class="hljs-string">,000</span> <span class="hljs-string">(5%)</span>   <span class="hljs-string">âœ…</span>             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Layer 3:</span>  <span class="hljs-number">200</span><span class="hljs-string">,000</span> <span class="hljs-string">(20%)</span>  <span class="hljs-string">âš ï¸</span>             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="hljs-string">è§£æå¤±è´¥åŸå› åˆ†å¸ƒ</span>
<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">æ²¡ä¼ </span> <span class="hljs-attr">region:</span>     <span class="hljs-number">80</span><span class="hljs-string">,000</span> <span class="hljs-string">(8%)</span>   <span class="hljs-string">â¬…ï¸</span> <span class="hljs-string">é‡ç‚¹ä¼˜åŒ–</span> <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">è€è®¢å•:</span>      <span class="hljs-number">110</span><span class="hljs-string">,000</span> <span class="hljs-string">(11%)</span>  <span class="hljs-string">â¬…ï¸</span> <span class="hljs-string">å†å²åŒ…è¢±</span> <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">è§£æå¼‚å¸¸:</span>     <span class="hljs-number">10</span><span class="hljs-string">,000</span> <span class="hljs-string">(1%)</span>   <span class="hljs-string">â¬…ï¸</span> <span class="hljs-string">å¼‚å¸¸æƒ…å†µ</span> <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="hljs-string">Top</span> <span class="hljs-number">10</span> <span class="hljs-string">æœªä¼ </span> <span class="hljs-string">region</span> <span class="hljs-string">çš„æœåŠ¡</span>
<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">1. xxx-refund-service:</span>  <span class="hljs-number">25</span><span class="hljs-string">,000</span> <span class="hljs-string">æ¬¡</span>      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">2. xxx-cancel-job:</span>      <span class="hljs-number">18</span><span class="hljs-string">,000</span> <span class="hljs-string">æ¬¡</span>      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">3. xxx-sync-task:</span>       <span class="hljs-number">15</span><span class="hljs-string">,000</span> <span class="hljs-string">æ¬¡</span>      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">...</span>                                    <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<p><strong>æŒç»­ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li><strong>é˜¶æ®µ 1</strong>ï¼ˆå½“å‰ï¼‰ï¼šè¯†åˆ«é—®é¢˜ä»£ç ï¼Œåˆ¶å®šè¿ç§»è®¡åˆ’</li>
<li><strong>é˜¶æ®µ 2</strong>ï¼ˆ1-3 ä¸ªæœˆï¼‰ï¼šé€æ­¥å‡çº§è€ä»£ç ï¼ŒLayer 3 å æ¯”é™åˆ° 10%</li>
<li><strong>é˜¶æ®µ 3</strong>ï¼ˆ3-6 ä¸ªæœˆï¼‰ï¼šç»§ç»­ä¼˜åŒ–ï¼ŒLayer 3 å æ¯”é™åˆ° 5%</li>
<li><strong>é˜¶æ®µ 4</strong>ï¼ˆ6-12 ä¸ªæœˆï¼‰ï¼šæœ€ç»ˆç›®æ ‡ï¼ŒLayer 3 å æ¯”é™åˆ° 1% ä»¥ä¸‹</li>
</ul>
<h3 data-id="heading-22">ä¸ƒã€æ€»ç»“</h3>
<h4 data-id="heading-23">æ ¸å¿ƒæ”¶ç›Š</h4>

























<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¼˜åŒ–å‰</th><th>ä¼˜åŒ–å</th></tr></thead><tbody><tr><td>æŸ¥è¯¢è€—æ—¶</td><td>æ•°ç™¾æ¯«ç§’</td><td>ä¸ªä½æ•°æ¯«ç§’</td></tr><tr><td>P99 å»¶è¿Ÿ</td><td>è¶…è¿‡ 1 ç§’</td><td>ç™¾æ¯«ç§’ä»¥å†…</td></tr><tr><td>å…æŸ¥åº“æ¯”ä¾‹</td><td>0%</td><td>95%</td></tr></tbody></table>
<h4 data-id="heading-24">é€‚ç”¨åœºæ™¯</h4>
<p><strong>é€‚åˆ</strong>ï¼šåˆ†åº“åˆ†è¡¨ç³»ç»Ÿã€æœ‰æ˜ç¡®è·¯ç”±ç»´åº¦ã€å¯æ§åˆ¶ ID ç”Ÿæˆé€»è¾‘</p>
<p><strong>ä¸é€‚åˆ</strong>ï¼šå°æ•°æ®é‡ã€è·¯ç”±ç»´åº¦é¢‘ç¹å˜åŒ–ã€ä½¿ç”¨ç¬¬ä¸‰æ–¹ ID æœåŠ¡</p>
<h3 data-id="heading-25">å…«ã€å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftwitter-archive%2Fsnowflake" target="_blank" title="https://github.com/twitter-archive/snowflake" ref="nofollow noopener noreferrer">Snowflake ç®—æ³• - Twitter</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftech.meituan.com%2F2017%2F04%2F21%2Fmt-leaf.html" target="_blank" title="https://tech.meituan.com/2017/04/21/mt-leaf.html" ref="nofollow noopener noreferrer">åˆ†å¸ƒå¼ ID ç”Ÿæˆæ–¹æ¡ˆ - ç¾å›¢ Leaf</a></li>
</ul>
<hr/>
<p><strong>Carve_the_Code</strong> - å¤§å‹ OTA å¹³å°è®¢å•ç³»ç»Ÿå¼€å‘</p>
<p>æ¬¢è¿ç•™è¨€äº¤æµï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é«˜æ€§èƒ½å¤šçº§ç½‘å…³ä¸å¤šçº§ç¼“å­˜æ¶æ„è½åœ°å®æˆ˜(è¶…æ¸…å®Œç»“)]]></title>    <link>https://juejin.cn/post/7577430671947366426</link>    <guid>https://juejin.cn/post/7577430671947366426</guid>    <pubDate>2025-11-28T07:43:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577430671947366426" data-draft-id="7577430671947350042" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é«˜æ€§èƒ½å¤šçº§ç½‘å…³ä¸å¤šçº§ç¼“å­˜æ¶æ„è½åœ°å®æˆ˜(è¶…æ¸…å®Œç»“)"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-28T07:43:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯¾ç¨‹xingkeitä¸top"/> <meta itemprop="url" content="https://juejin.cn/user/1910275039560096"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é«˜æ€§èƒ½å¤šçº§ç½‘å…³ä¸å¤šçº§ç¼“å­˜æ¶æ„è½åœ°å®æˆ˜(è¶…æ¸…å®Œç»“)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1910275039560096/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯¾ç¨‹xingkeitä¸top
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:43:07.000Z" title="Fri Nov 28 2025 07:43:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨äº¿çº§æµé‡ã€æ¯«ç§’çº§å“åº”ã€å…¨çƒåŒ–éƒ¨ç½²æˆä¸ºå¸¸æ€çš„ä»Šå¤©ï¼Œå•ç‚¹æ¶æ„æ—©å·²æ— æ³•æ”¯æ’‘ç°ä»£äº’è”ç½‘ç³»ç»Ÿçš„æ€§èƒ½ä¸å¯ç”¨æ€§è¦æ±‚ã€‚é¢å¯¹çªå‘æµé‡æ´ªå³°ã€åœ°åŸŸè®¿é—®å»¶è¿Ÿã€æœåŠ¡é›ªå´©ç­‰å¤æ‚æŒ‘æˆ˜ï¼Œ<strong>å¤šçº§ç½‘å…³ + å¤šçº§ç¼“å­˜</strong>å·²æˆä¸ºæ„å»ºé«˜å¹¶å‘ã€é«˜å¯ç”¨ç³»ç»Ÿçš„æ ¸å¿ƒæ¶æ„èŒƒå¼ã€‚</p>
<p>æœ¬æ–‡å°†ç³»ç»Ÿæ€§åœ°æ‹†è§£è¿™ä¸€é«˜æ€§èƒ½æ¶æ„ä»<strong>ç†è®ºè®¾è®¡ã€å®æˆ˜è½åœ°åˆ°ç”Ÿäº§ä¼˜åŒ–</strong>çš„å®Œæ•´è·¯å¾„ï¼Œç»“åˆçœŸå®ä¸šåŠ¡åœºæ™¯ï¼Œè¾…ä»¥å°‘é‡å…³é”®ä»£ç ä¸é…ç½®ç¤ºä¾‹ï¼Œå¸®åŠ©æ¶æ„å¸ˆä¸é«˜çº§å·¥ç¨‹å¸ˆæŒæ¡å¯å¤ç”¨çš„å·¥ç¨‹æ–¹æ³•è®ºã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦â€œå¤šçº§â€ï¼Ÿâ€”â€” å•ç‚¹æ¶æ„çš„ä¸‰å¤§ç“¶é¢ˆ</h3>
<ol>
<li><strong>æ€§èƒ½ç“¶é¢ˆ</strong>ï¼šå•ä¸ª Nginx æˆ– Redis åœ¨é«˜å¹¶å‘ä¸‹ CPU/å†…å­˜æ‰“æ»¡ï¼›</li>
<li><strong>å®¹ç¾è–„å¼±</strong>ï¼šä»»ä¸€ç»„ä»¶å®•æœºå³å¼•å‘å…¨ç«™ä¸å¯ç”¨ï¼›</li>
<li><strong>ä½“éªŒå‰²è£‚</strong>ï¼šæµ·å¤–ç”¨æˆ·è®¿é—®å›½å†…ä¸­å¿ƒèŠ‚ç‚¹ï¼Œé¦–å±åŠ è½½è¶… 2 ç§’ã€‚</li>
</ol>
<p>â€œå¤šçº§â€ä¸æ˜¯å †ç ŒæŠ€æœ¯ï¼Œè€Œæ˜¯é€šè¿‡<strong>åˆ†å±‚å¸è½½ã€å°±è¿‘å¤„ç†ã€å†—ä½™å®¹é”™</strong>ï¼Œå®ç°æ€§èƒ½ã€å¯ç”¨æ€§ä¸æˆæœ¬çš„æœ€ä¼˜å¹³è¡¡ã€‚</p>
<hr/>
<h3 data-id="heading-1">äºŒã€å¤šçº§ç½‘å…³ï¼šä¸‰å±‚æµé‡æ²»ç†æ¨¡å‹</h3>
<h4 data-id="heading-2">1.Â <strong>L1ï¼šè¾¹ç¼˜ç½‘å…³ï¼ˆEdge Gatewayï¼‰</strong></h4>
<p>éƒ¨ç½²äº CDN è¾¹ç¼˜ï¼ˆå¦‚ Cloudflareã€é˜¿é‡Œäº‘ EdgeScriptï¼‰ï¼Œå¤„ç†é™æ€èµ„æºä¸å®‰å…¨é˜²æŠ¤ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">nginx
ç¼–è¾‘
1<span class="hljs-comment"># ç¤ºä¾‹ï¼šè¾¹ç¼˜ç¼“å­˜é™æ€èµ„æº 1 å¹´</span>
2location ~* .(js|css|png|jpg|woff2)$ {
3    expires 1y<span class="hljs-comment">;</span>
4    add_header Cache-Control "public, immutable"<span class="hljs-comment">;</span>
5}
</code></pre>
<ul>
<li>ç»ˆç»“ 90% é™æ€è¯·æ±‚ï¼Œä¸å›æºï¼›</li>
<li>WAF è§„åˆ™æ‹¦æˆªæ¶æ„çˆ¬è™«ï¼›</li>
<li>æŒ‰ç”¨æˆ· IP è‡ªåŠ¨è·¯ç”±è‡³æœ€è¿‘åŒºåŸŸä¸­å¿ƒã€‚</li>
</ul>
<h4 data-id="heading-3">2.Â <strong>L2ï¼šåŒºåŸŸç½‘å…³ï¼ˆRegional Gatewayï¼‰</strong></h4>
<p>æ¯ä¸ªå¯ç”¨åŒºéƒ¨ç½² Spring Cloud Gatewayï¼Œè´Ÿè´£è®¤è¯ä¸æœ¬åœ°è·¯ç”±ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">yaml</span>
<span class="hljs-string">ç¼–è¾‘</span>
<span class="hljs-number">1</span><span class="hljs-comment"># Spring Cloud Gateway è·¯ç”±é…ç½®</span>
<span class="hljs-attr">2spring:</span>
<span class="hljs-attr">3  cloud:</span>
<span class="hljs-attr">4    gateway:</span>
<span class="hljs-attr">5      routes:</span>
<span class="hljs-attr">6        - id:</span> <span class="hljs-string">video-service</span>
<span class="hljs-attr">7          uri:</span> <span class="hljs-string">lb://video-service</span>
<span class="hljs-attr">8          predicates:</span>
<span class="hljs-number">9</span>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/api/video/**</span>
<span class="hljs-attr">10          filters:</span>
<span class="hljs-number">11</span>            <span class="hljs-bullet">-</span> <span class="hljs-string">TokenAuthFilter</span>  <span class="hljs-comment"># è‡ªå®šä¹‰ JWT æ ¡éªŒ</span>
</code></pre>
<ul>
<li>åŒºåŸŸå†…æœåŠ¡è°ƒç”¨ï¼Œé¿å…è·¨åŒºå»¶è¿Ÿï¼›</li>
<li>ç†”æ–­é™æµï¼ˆé›†æˆ Sentinelï¼‰ï¼›</li>
<li>æ³¨å…¥ TraceIDï¼Œæ”¯æŒå…¨é“¾è·¯è¿½è¸ªã€‚</li>
</ul>
<h4 data-id="heading-4">3.Â <strong>L3ï¼šæ ¸å¿ƒç½‘å…³ï¼ˆBFF Gatewayï¼‰</strong></h4>
<p>èšåˆå¤šä¸ªå¾®æœåŠ¡æ¥å£ï¼Œä¸ºå‰ç«¯æä¾›å®šåˆ¶åŒ–æ•°æ®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">java
ç¼–è¾‘
1// BFF èšåˆç¤ºä¾‹
2public VideoDetailDTO getVideoDetail(Long videoId) {
3    VideoMeta <span class="hljs-attr">meta</span> = videoService.getMeta(videoId)<span class="hljs-comment">;</span>
4    List&lt;Comment&gt; <span class="hljs-attr">comments</span> = commentService.getTopComments(videoId)<span class="hljs-comment">;</span>
5    boolean <span class="hljs-attr">liked</span> = likeService.isLiked(currentUser(), videoId)<span class="hljs-comment">;</span>
6    return new VideoDetailDTO(meta, comments, liked)<span class="hljs-comment">;</span>
7}
</code></pre>
<blockquote>
<p>âœ… ä¼˜åŠ¿ï¼šå‰ç«¯åªéœ€ä¸€æ¬¡è¯·æ±‚ï¼Œåç«¯å¹¶è¡Œè°ƒç”¨ï¼Œé™ä½äº¤äº’æ¬¡æ•°ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€å¤šçº§ç¼“å­˜ï¼šä¸‰å±‚åŠ é€Ÿä½“ç³»</h3>
<h4 data-id="heading-6">1.Â <strong>L1ï¼šæœ¬åœ°ç¼“å­˜ï¼ˆCaffeineï¼‰â€”â€” çº³ç§’çº§å“åº”</strong></h4>
<p>é€‚ç”¨äºé«˜é¢‘è¯»ã€ä½å˜æ›´æ•°æ®ï¼ˆå¦‚å­—å…¸ã€é…ç½®ï¼‰ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">java
ç¼–è¾‘
<span class="hljs-number">1</span>LoadingCache&lt;String, <span class="hljs-selector-tag">Object</span>&gt; localCache = Caffeine<span class="hljs-selector-class">.newBuilder</span>()
<span class="hljs-number">2</span>    <span class="hljs-selector-class">.maximumSize</span>(<span class="hljs-number">1000</span>)
<span class="hljs-number">3</span>    <span class="hljs-selector-class">.expireAfterWrite</span>(<span class="hljs-number">10</span>, TimeUnit.MINUTES)
<span class="hljs-number">4</span>    <span class="hljs-selector-class">.build</span>(key -&gt; loadFromRedis(key));
</code></pre>
<ul>
<li>é›¶ç½‘ç»œå¼€é”€ï¼Œè®¿é—®é€Ÿåº¦è¾¾çº³ç§’çº§ï¼›</li>
<li>éœ€é…åˆä¸»åŠ¨å¤±æ•ˆæœºåˆ¶ï¼ˆå¦‚ç›‘å¬ Redis Pub/Subï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-7">2.Â <strong>L2ï¼šåˆ†å¸ƒå¼ç¼“å­˜ï¼ˆRedis Clusterï¼‰â€”â€” æ¯«ç§’çº§å…±äº«</strong></h4>
<p>å­˜å‚¨ç”¨æˆ·ä¼šè¯ã€è§†é¢‘å…ƒæ•°æ®ã€æ’è¡Œæ¦œç­‰ï¼š</p>
<pre><code class="hljs language-python" lang="python">bash
ç¼–è¾‘
<span class="hljs-number">1</span><span class="hljs-comment"># Redis Sorted Set å­˜å‚¨å¼¹å¹•ï¼ˆæŒ‰æ’­æ”¾æ—¶é—´æ’åºï¼‰</span>
2ZADD danmaku:video_123 <span class="hljs-number">15.234</span> <span class="hljs-string">"{"</span>text<span class="hljs-string">":"</span><span class="hljs-number">666</span><span class="hljs-string">","</span>colo<span class="hljs-string">r":"</span><span class="hljs-comment">#ff0000"}"</span>
</code></pre>
<ul>
<li>æ”¯æŒé«˜ååã€æŒä¹…åŒ–ã€ä¸»ä»é«˜å¯ç”¨ï¼›</li>
<li>å…³é”®ï¼šåˆç†è®¾ç½® TTLï¼Œé¿å…ç¼“å­˜é›ªå´©ã€‚</li>
</ul>
<h4 data-id="heading-8">3.Â <strong>L3ï¼šæŒä¹…å±‚ç¼“å­˜ï¼ˆElasticsearch / ClickHouseï¼‰</strong></h4>
<p>ç”¨äºå¤æ‚æŸ¥è¯¢ç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">sql</span>
ç¼–è¾‘
<span class="hljs-number">1</span><span class="hljs-comment">-- ClickHouse ç‰©åŒ–è§†å›¾é¢„èšåˆæ—¥æ´»</span>
<span class="hljs-number">2</span><span class="hljs-keyword">CREATE</span> MATERIALIZED <span class="hljs-keyword">VIEW</span> daily_active_user
<span class="hljs-number">3</span>ENGINE <span class="hljs-operator">=</span> AggregatingMergeTree()
<span class="hljs-number">4</span><span class="hljs-keyword">AS</span> <span class="hljs-keyword">SELECT</span> toDate(event_time) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">day</span>, uniqState(user_id) <span class="hljs-keyword">AS</span> uv
<span class="hljs-number">5</span><span class="hljs-keyword">FROM</span> user_events <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">day</span>;
</code></pre>
<hr/>
<h3 data-id="heading-9">å››ã€ç½‘å…³ä¸ç¼“å­˜çš„æ·±åº¦ååŒ</h3>
<ul>
<li><strong>è¾¹ç¼˜ç½‘å…³ + æµè§ˆå™¨ç¼“å­˜</strong>ï¼šé™æ€èµ„æºä½¿ç”¨Â <code>immutable</code>Â + æ–‡ä»¶å“ˆå¸Œï¼Œå®ç°é«˜æ•ˆæ›´æ–°ï¼›</li>
<li><strong>åŒºåŸŸç½‘å…³ + æœ¬åœ°ç¼“å­˜</strong>ï¼šè®¤è¯åé¢„åŠ è½½ç”¨æˆ·åŸºæœ¬ä¿¡æ¯è‡³ Caffeineï¼›</li>
<li><strong>æ ¸å¿ƒç½‘å…³ + Redis</strong>ï¼šBFF æ¥å£ä¼˜å…ˆæŸ¥ Redisï¼Œå‘½ä¸­åˆ™ç›´æ¥è¿”å›ï¼›</li>
<li><strong>ç¼“å­˜ç©¿é€é˜²æŠ¤</strong>ï¼šç½‘å…³å±‚æ‹¦æˆªéæ³• IDï¼ˆå¦‚Â <code>id=-1</code>ï¼‰ï¼Œç»“åˆå¸ƒéš†è¿‡æ»¤å™¨æå‰è¿‡æ»¤ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-10">äº”ã€ç”Ÿäº§éƒ¨ç½²ä¸å¯è§‚æµ‹æ€§</h3>
<h4 data-id="heading-11">1.Â <strong>å®¹å™¨åŒ–éƒ¨ç½²</strong></h4>
<p>ä½¿ç”¨ Docker Compose ç¼–æ’æ ¸å¿ƒç»„ä»¶ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">yaml</span>
<span class="hljs-string">ç¼–è¾‘</span>
<span class="hljs-attr">1services:</span>
<span class="hljs-attr">2  regional-gateway:</span>
<span class="hljs-attr">3    image:</span> <span class="hljs-string">gateway:latest</span>
<span class="hljs-attr">4    ports:</span> [<span class="hljs-string">"8080:8080"</span>]
<span class="hljs-attr">5    environment:</span>
<span class="hljs-number">6</span>      <span class="hljs-bullet">-</span> <span class="hljs-string">SPRING_PROFILES_ACTIVE=prod</span>
<span class="hljs-attr">7  redis-cluster:</span>
<span class="hljs-attr">8    image:</span> <span class="hljs-string">redis:7</span>
<span class="hljs-attr">9    command:</span> [<span class="hljs-string">"redis-server"</span>, <span class="hljs-string">"--cluster-enabled"</span>, <span class="hljs-string">"yes"</span>]
</code></pre>
<h4 data-id="heading-12">2.Â <strong>å…¨é“¾è·¯ç›‘æ§</strong></h4>
<ul>
<li>Prometheus é‡‡é›†æŒ‡æ ‡ï¼šQPSã€å»¶è¿Ÿã€ç¼“å­˜å‘½ä¸­ç‡ï¼›</li>
<li>Grafana å¯è§†åŒ–ä»ªè¡¨ç›˜ï¼›</li>
<li>ELK æ”¶é›†æ—¥å¿—ï¼Œæ”¯æŒå…³é”®è¯å‘Šè­¦ã€‚</li>
</ul>
<h4 data-id="heading-13">3.Â <strong>æ··æ²Œå·¥ç¨‹éªŒè¯</strong></h4>
<p>å®šæœŸæ¨¡æ‹Ÿ Redis å®•æœºã€ç½‘å…³è¿‡è½½ï¼ŒéªŒè¯ç³»ç»Ÿæ˜¯å¦å…·å¤‡ï¼š</p>
<ul>
<li>è‡ªåŠ¨åˆ‡æ¢ï¼ˆå“¨å…µ/Clusterï¼‰</li>
<li>ä¼˜é›…é™çº§ï¼ˆè¿”å›å…œåº•æ•°æ®ï¼‰</li>
<li>å¿«é€Ÿæ¢å¤ï¼ˆè‡ªåŠ¨é‡å¯ + å¥åº·æ£€æŸ¥ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-14">å…­ã€ä¼˜åŒ–æŠ€å·§æ€»ç»“</h3>





























<table><thead><tr><th>åœºæ™¯</th><th>æŠ€å·§</th></tr></thead><tbody><tr><td><strong>ç¼“å­˜é›ªå´©</strong></td><td>è®¾ç½®éšæœº TTLï¼ˆå¦‚åŸºç¡€å€¼ Â± 10%ï¼‰</td></tr><tr><td><strong>ç¼“å­˜ç©¿é€</strong></td><td>å¸ƒéš†è¿‡æ»¤å™¨ + ç©ºå€¼ç¼“å­˜ï¼ˆTTL çŸ­ï¼‰</td></tr><tr><td><strong>çƒ­ç‚¹ Key</strong></td><td>æœ¬åœ°ç¼“å­˜ + å¤šå‰¯æœ¬åˆ†æ•£å‹åŠ›</td></tr><tr><td><strong>å¤§ Value</strong></td><td>å‹ç¼©å­˜å‚¨ï¼ˆå¦‚ Snappyï¼‰æˆ–æ‹†åˆ†ä¸ºå¤šä¸ª Key</td></tr><tr><td><strong>ç½‘å…³æ€§èƒ½</strong></td><td>å¼‚æ­¥éé˜»å¡ï¼ˆReactor æ¨¡å‹ï¼‰ã€è¿æ¥æ± å¤ç”¨</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-15">ä¸ƒã€ç»“è¯­ï¼šæ¶æ„å³å–èˆï¼Œå¤šçº§å³å¹³è¡¡</h3>
<p>å¤šçº§ç½‘å…³ä¸å¤šçº§ç¼“å­˜å¹¶éâ€œé“¶å¼¹â€ï¼Œå…¶æˆåŠŸä¾èµ–ä¸‰å¤§åŸåˆ™ï¼š</p>
<ol>
<li><strong>æŒ‰éœ€åˆ†å±‚</strong>ï¼šå°å‹ç³»ç»Ÿå¯èƒ½åªéœ€ä¸€çº§ï¼›</li>
<li><strong>ä¸€è‡´æ€§åˆ†çº§</strong>ï¼šæ˜ç¡®å“ªäº›æ•°æ®å¯å®¹å¿çŸ­æš‚ä¸ä¸€è‡´ï¼›</li>
<li><strong>è¿ç»´å…ˆè¡Œ</strong>ï¼šæ¶æ„è¶Šå¤æ‚ï¼Œå¯¹ç›‘æ§ã€å‘Šè­¦ã€è‡ªæ„ˆèƒ½åŠ›è¦æ±‚è¶Šé«˜ã€‚</li>
</ol>
<p>æŒæ¡è¿™å¥—ä»ç†è®ºåˆ°éƒ¨ç½²çš„å®Œæ•´æ–¹æ³•è®ºï¼Œä½ ä¾¿æ‹¥æœ‰äº†æ„å»ºä¸‹ä¸€ä»£é«˜å¯ç”¨ç³»ç»Ÿçš„â€œæ¶æ„ç½—ç›˜â€ã€‚<br/>
<strong>è¶…æ¸…å®Œç»“ï¼Œä½†æ¢ç´¢ä¸æ­¢â€”â€”è¿™ä¸ä»…æ˜¯ä¸€ä¸ªæ–¹æ¡ˆçš„ç»ˆç‚¹ï¼Œæ›´æ˜¯ä½ é©¾é©­äº¿çº§æµé‡çš„æ–°èµ·ç‚¹ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot2 ä»¿Bç«™é«˜æ€§èƒ½å‰ç«¯+åç«¯é¡¹ç›®(å®Œç»“)]]></title>    <link>https://juejin.cn/post/7577438119558332467</link>    <guid>https://juejin.cn/post/7577438119558332467</guid>    <pubDate>2025-11-28T07:34:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577438119558332467" data-draft-id="7577438119558316083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot2 ä»¿Bç«™é«˜æ€§èƒ½å‰ç«¯+åç«¯é¡¹ç›®(å®Œç»“)"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-28T07:34:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯¾ç¨‹xingkeitä¸top"/> <meta itemprop="url" content="https://juejin.cn/user/1910275039560096"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot2 ä»¿Bç«™é«˜æ€§èƒ½å‰ç«¯+åç«¯é¡¹ç›®(å®Œç»“)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1910275039560096/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯¾ç¨‹xingkeitä¸top
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:34:41.000Z" title="Fri Nov 28 2025 07:34:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å…¨æ ˆå¼€å‘èƒ½åŠ›æ—¥ç›Šæˆä¸ºå·¥ç¨‹å¸ˆæ ¸å¿ƒç«äº‰åŠ›çš„ä»Šå¤©ï¼Œä¸€ä¸ªè´´è¿‘çœŸå®ä¸šåŠ¡ã€æ¶µç›–é«˜å¹¶å‘ä¸å¼ºäº¤äº’åœºæ™¯çš„ç»¼åˆæ€§é¡¹ç›®ï¼Œæ— ç–‘æ˜¯æŠ€æœ¯æˆé•¿çš„æœ€ä½³è½½ä½“ã€‚Bilibiliï¼ˆBç«™ï¼‰ä½œä¸ºé›†è§†é¢‘æ’­æ”¾ã€å¼¹å¹•äº’åŠ¨ã€ç¤¾åŒºç¤¾äº¤äºä¸€ä½“çš„å¤æ‚å¹³å°ï¼Œå…¶äº§å“å½¢æ€å’ŒæŠ€æœ¯æŒ‘æˆ˜æå…·ä»£è¡¨æ€§ã€‚</p>
<p>æœ¬æ–‡å°†ç³»ç»Ÿæ¢³ç†ä¸€ä¸ªåŸºäº <strong>Spring Boot 2 + Vue 3</strong> çš„ä»¿ B ç«™é¡¹ç›®ï¼Œä»<strong>éœ€æ±‚åˆ†æã€æ¶æ„è®¾è®¡ã€æ ¸å¿ƒåŠŸèƒ½å®ç°åˆ°éƒ¨ç½²ä¸Šçº¿</strong>çš„å®Œæ•´é—­ç¯ã€‚å…¨æ–‡ä»¥å·¥ç¨‹å®è·µä¸ºå¯¼å‘ï¼Œè¾…ä»¥å°‘é‡å…³é”®ä»£ç ç‰‡æ®µï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£â€œå¦‚ä½•æŠŠæƒ³æ³•å˜æˆå¯è¿è¡Œã€å¯ç»´æŠ¤ã€å¯æ‰©å±•çš„äº§å“â€ã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€éœ€æ±‚æ‹†è§£ï¼šèšç„¦ MVP æ ¸å¿ƒä½“éªŒ</h3>
<p>é¡¹ç›®åˆæœŸæ˜ç¡®æœ€å°å¯è¡Œäº§å“ï¼ˆMVPï¼‰èŒƒå›´ï¼Œé¿å…è¿‡åº¦è®¾è®¡ï¼š</p>
<ul>
<li>ç”¨æˆ·æ³¨å†Œ/ç™»å½•ï¼ˆå« JWT é‰´æƒï¼‰</li>
<li>è§†é¢‘ä¸Šä¼ ã€è½¬ç ã€å¤šæ¸…æ™°åº¦æ’­æ”¾</li>
<li>å®æ—¶å¼¹å¹•äº’åŠ¨</li>
<li>ç‚¹èµã€æŠ•å¸ã€æ”¶è—ã€è¯„è®º</li>
<li>é¦–é¡µæ¨è + åˆ†åŒºæµè§ˆ + æœç´¢</li>
<li>ä¸ªäººä¸­å¿ƒä¸ UP ä¸»ä¸»é¡µ</li>
</ul>
<p>è¿™äº›æ¨¡å—è¦†ç›–äº†å†…å®¹ç”Ÿäº§ã€æ¶ˆè´¹ã€äº’åŠ¨ä¸‰å¤§æ ¸å¿ƒé“¾è·¯ï¼Œæ„æˆå®Œæ•´çš„ç”¨æˆ·é—­ç¯ã€‚</p>
<hr/>
<h3 data-id="heading-1">äºŒã€æ•´ä½“æ¶æ„ï¼šå‰åç«¯åˆ†ç¦» + æ¨¡å—åŒ–è®¾è®¡</h3>
<p>åç«¯é‡‡ç”¨ Spring Boot 2ï¼Œæ•´åˆä¸»æµä¸­é—´ä»¶ï¼›å‰ç«¯åŸºäº Vue 3 + TypeScript + Vite æ„å»º SPAã€‚è™½æœªå®Œå…¨å¾®æœåŠ¡åŒ–ï¼Œä½†æŒ‰ä¸šåŠ¡åŸŸåˆ’åˆ†ä¸ºæ¸…æ™°æ¨¡å—ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">text
ç¼–è¾‘
<span class="hljs-number">1b</span>ackend/
<span class="hljs-number">2</span>â”œâ”€â”€ user-service      <span class="hljs-comment">// ç”¨æˆ·ä¸­å¿ƒ</span>
<span class="hljs-number">3</span>â”œâ”€â”€ video-service     <span class="hljs-comment">// è§†é¢‘ç®¡ç†</span>
<span class="hljs-number">4</span>â”œâ”€â”€ interact-service  <span class="hljs-comment">// äº’åŠ¨è¡Œä¸º</span>
<span class="hljs-number">5</span>â”œâ”€â”€ search-service    <span class="hljs-comment">// æœç´¢ä¸æ¨è</span>
<span class="hljs-number">6</span>â””â”€â”€ gateway           <span class="hljs-comment">// ç»Ÿä¸€ç½‘å…³ï¼ˆè·¯ç”± + è®¤è¯ï¼‰</span>
<span class="hljs-number">7</span>
<span class="hljs-number">8f</span>rontend/
<span class="hljs-number">9</span>â”œâ”€â”€ views/
<span class="hljs-number">10</span>â”‚   â”œâ”€â”€ Home.vue
<span class="hljs-number">11</span>â”‚   â”œâ”€â”€ VideoDetail.vue
<span class="hljs-number">12</span>â”‚   â””â”€â”€ UserCenter.vue
<span class="hljs-number">13</span>â”œâ”€â”€ api/              <span class="hljs-comment">// æ¥å£å°è£…</span>
<span class="hljs-number">14</span>â””â”€â”€ store/            <span class="hljs-comment">// Pinia çŠ¶æ€ç®¡ç†</span>
</code></pre>
<p>è¿™ç§ç»“æ„ä¾¿äºå›¢é˜Ÿåä½œï¼Œä¹Ÿä¸ºæœªæ¥æ¼”è¿›é¢„ç•™ç©ºé—´ã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€å…³é”®åŠŸèƒ½å®ç°é€»è¾‘ï¼ˆé™„å°‘é‡ä»£ç ï¼‰</h3>
<h4 data-id="heading-3">1.Â <strong>JWT æ— çŠ¶æ€è®¤è¯</strong></h4>
<p>åç«¯ç”Ÿæˆ Tokenï¼Œå‰ç«¯æ‹¦æˆªå™¨è‡ªåŠ¨æºå¸¦ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">java
ç¼–è¾‘
<span class="hljs-number">1</span><span class="hljs-comment">// åç«¯ï¼šç”Ÿæˆ Token</span>
<span class="hljs-number">2S</span>tring token = Jwts<span class="hljs-selector-class">.builder</span>()
<span class="hljs-number">3</span>    <span class="hljs-selector-class">.setSubject</span>(userId.toString())
<span class="hljs-number">4</span>    <span class="hljs-selector-class">.setExpiration</span>(new Date(System.currentTimeMillis() + <span class="hljs-number">86400000</span>))
<span class="hljs-number">5</span>    <span class="hljs-selector-class">.signWith</span>(SignatureAlgorithm.HS512, "secret-key")
<span class="hljs-number">6</span>    <span class="hljs-selector-class">.compact</span>();
</code></pre>
<pre><code class="hljs language-ini" lang="ini">javascript
ç¼–è¾‘
1// å‰ç«¯ Axios æ‹¦æˆªå™¨
2axios.interceptors.request.use(<span class="hljs-attr">config</span> =&gt; {
3  const <span class="hljs-attr">token</span> = localStorage.getItem(<span class="hljs-string">'token'</span>)<span class="hljs-comment">;</span>
4  if (token) <span class="hljs-attr">config.headers.Authorization</span> = `Bearer <span class="hljs-variable">${token}</span>`<span class="hljs-comment">;</span>
5  return config<span class="hljs-comment">;</span>
6})<span class="hljs-comment">;</span>
</code></pre>
<blockquote>
<p>âœ… ä¼˜åŠ¿ï¼šæ—  Session çŠ¶æ€ï¼Œå¤©ç„¶æ”¯æŒæ°´å¹³æ‰©å±•ã€‚</p>
</blockquote>
<h4 data-id="heading-4">2.Â <strong>åˆ†ç‰‡ä¸Šä¼  + æ–­ç‚¹ç»­ä¼ </strong></h4>
<p>å‰ç«¯è®¡ç®—æ–‡ä»¶ hashï¼ŒæŒ‰ 5MB åˆ†ç‰‡ä¸Šä¼ ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">javascript
ç¼–è¾‘
1const <span class="hljs-attr">chunkSize</span> = <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span><span class="hljs-comment">;</span>
2for (let <span class="hljs-attr">start</span> = <span class="hljs-number">0</span><span class="hljs-comment">; start &lt; file.size; start += chunkSize) {</span>
3  const <span class="hljs-attr">chunk</span> = file.slice(start, start + chunkSize)<span class="hljs-comment">;</span>
4  await uploadChunk(chunk, index++, fileHash)<span class="hljs-comment">;</span>
5}
</code></pre>
<p>åç«¯åˆå¹¶åˆ†ç‰‡å¹¶è§¦å‘å¼‚æ­¥è½¬ç ä»»åŠ¡ï¼ˆé€šè¿‡ RabbitMQ è§£è€¦ï¼‰ã€‚</p>
<h4 data-id="heading-5">3.Â <strong>å®æ—¶å¼¹å¹•ï¼ˆWebSocket + Redisï¼‰</strong></h4>
<p>åç«¯ä½¿ç”¨ <code>@ServerEndpoint</code> å»ºç«‹è¿æ¥ï¼Œå¼¹å¹•å­˜å…¥ Redis Sorted Setï¼ˆæŒ‰è§†é¢‘æ—¶é—´æˆ³æ’åºï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">java
ç¼–è¾‘
<span class="hljs-number">1</span><span class="hljs-comment">// å¼¹å¹•å­˜å‚¨ï¼švideoId ä¸º keyï¼Œtime ä¸º score</span>
<span class="hljs-number">2</span>redisTemplate.opsForZSet().<span class="hljs-keyword">add</span>(<span class="hljs-string">"danmaku:"</span> + videoId, danmakuJson, playTime);
</code></pre>
<p>å‰ç«¯é€šè¿‡ WebSocket æ¥æ”¶å¹¶æ¸²æŸ“ï¼Œç¡®ä¿ä½å»¶è¿Ÿå±•ç¤ºã€‚</p>
<h4 data-id="heading-6">4.Â <strong>äº’åŠ¨æ“ä½œçš„ä¹è§‚æ›´æ–°</strong></h4>
<p>ç”¨æˆ·ç‚¹å‡»â€œç‚¹èµâ€åï¼Œå‰ç«¯ç«‹å³æ›´æ–° UI å¹¶å‘é€è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">javascript
ç¼–è¾‘
1// å‰ç«¯ä¹è§‚æ›´æ–°
2video.likeCount++<span class="hljs-comment">;</span>
<span class="hljs-attr">3video.liked</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
4
5// å‘é€è¯·æ±‚ï¼Œå¤±è´¥åˆ™å›æ»š
6api.like(video.id).catch(() =&gt; {
7  video.likeCount--<span class="hljs-comment">;</span>
8  <span class="hljs-attr">video.liked</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
9})<span class="hljs-comment">;</span>
</code></pre>
<p>åç«¯é‡‡ç”¨ Redis è®¡æ•°å™¨ + å¼‚æ­¥æŒä¹…åŒ–ï¼Œä¿éšœé«˜æ€§èƒ½ã€‚</p>
<hr/>
<h3 data-id="heading-7">å››ã€æ€§èƒ½ä¸ä½“éªŒä¼˜åŒ–</h3>
<ul>
<li><strong>å¤šçº§ç¼“å­˜</strong>ï¼šCaffeineï¼ˆæœ¬åœ°ï¼‰ + Redisï¼ˆåˆ†å¸ƒå¼ï¼‰ + æµè§ˆå™¨ç¼“å­˜ï¼›</li>
<li><strong>é™æ€èµ„æº CDN</strong>ï¼šJS/CSS/å›¾ç‰‡éƒ¨ç½²è‡³ CDNï¼Œè§†é¢‘é€šè¿‡å¯¹è±¡å­˜å‚¨ + CDN åŠ é€Ÿï¼›</li>
<li><strong>æ¥å£èšåˆ</strong>ï¼šæ ¸å¿ƒç½‘å…³æä¾› BFF æ¥å£ï¼Œå‡å°‘å‰ç«¯å¤šæ¬¡è¯·æ±‚ï¼›</li>
<li><strong>è™šæ‹Ÿæ»šåŠ¨</strong>ï¼šé•¿è¯„è®ºåˆ—è¡¨ä»…æ¸²æŸ“å¯è§†åŒºåŸŸï¼Œæå‡æµç•…åº¦ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8">äº”ã€éƒ¨ç½²ä¸è¿ç»´ï¼šä»æœ¬åœ°åˆ°ç”Ÿäº§</h3>
<ul>
<li><strong>å®¹å™¨åŒ–</strong>ï¼šDocker æ‰“åŒ… Spring Boot åº”ç”¨ä¸ Vue å‰ç«¯ï¼›</li>
<li><strong>ç¼–æ’</strong>ï¼šdocker-compose ç®¡ç† MySQLã€Redisã€RabbitMQã€Nginxï¼›</li>
<li><strong>CI/CD</strong>ï¼šGit æäº¤ â†’ Jenkins è‡ªåŠ¨æ„å»º â†’ é•œåƒæ¨é€ â†’ å®¹å™¨é‡å¯ï¼›</li>
<li><strong>ç›‘æ§</strong>ï¼šPrometheus + Grafana ç›‘æ§ JVMã€HTTP å»¶è¿Ÿã€é˜Ÿåˆ—å †ç§¯ã€‚</li>
</ul>
<p>Nginx é…ç½®ç¤ºä¾‹ï¼ˆåå‘ä»£ç† + é™æ€èµ„æºï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">nginx
ç¼–è¾‘
1location /api {
2    proxy_pass http://backend:8080;
3}
4
5location / {
6    root /usr/share/nginx/html;
7    try_files <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.html;
8}
</code></pre>
<hr/>
<h3 data-id="heading-9">å…­ã€æ€»ç»“ï¼šå…¨æ ˆä¸ä»…æ˜¯â€œä¼šå†™â€ï¼Œæ›´æ˜¯â€œä¼šæƒ³â€</h3>
<p>è¿™ä¸ªä»¿ B ç«™é¡¹ç›®çš„ä»·å€¼ï¼Œè¿œä¸æ­¢äºå¤åˆ»ä¸€ä¸ªè§†é¢‘å¹³å°ã€‚å®ƒè®­ç»ƒçš„æ˜¯<strong>ç«¯åˆ°ç«¯çš„ç³»ç»Ÿæ€ç»´</strong>ï¼š</p>
<ul>
<li>å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ—¢å®‰å…¨åˆæ˜“ç”¨çš„ APIï¼Ÿ</li>
<li>å¦‚ä½•åœ¨ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„åŒæ—¶æå‡ç”¨æˆ·ä½“éªŒï¼Ÿ</li>
<li>å¦‚ä½•è®©å‰åç«¯åœ¨é«˜é€Ÿè¿­ä»£ä¸­ä¿æŒåŒæ­¥è€Œä¸äº’ç›¸é˜»å¡ï¼Ÿ</li>
</ul>
<p>çœŸæ­£çš„å…¨æ ˆå·¥ç¨‹å¸ˆï¼Œä¸æ˜¯å‰åç«¯éƒ½ä¼šå†™ï¼Œè€Œæ˜¯<strong>ç†è§£æ•°æ®å¦‚ä½•æµåŠ¨ã€ç”¨æˆ·å¦‚ä½•æ„ŸçŸ¥ã€ç³»ç»Ÿå¦‚ä½•æ¼”è¿›</strong>ã€‚</p>
<hr/>
<p><strong>ç»“è¯­</strong><br/>
é¡¹ç›®å®Œç»“ï¼Œä½†æˆé•¿ä¸æ­¢ã€‚ä»ä¸€è¡Œéœ€æ±‚åˆ°çº¿ä¸ŠæœåŠ¡ï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯å·¥ç¨‹èƒ½åŠ›çš„é”¤ç‚¼ã€‚æ”¶è—æœ¬æ–‡ï¼Œä¸ä»…æ˜¯æ”¶è—ä¸€ä¸ªå®æˆ˜æ¡ˆä¾‹ï¼Œæ›´æ˜¯æ”¶è—ä¸€å¥—ä»æƒ³æ³•åˆ°äº§å“çš„å®Œæ•´æ–¹æ³•è®ºâ€”â€”è¿™ï¼Œæ‰æ˜¯å¼€å‘è€…æœ€å®è´µçš„èµ„äº§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[viteè”é‚¦å®ç°å¾®å‰ç«¯ï¼ˆvite-plugin-federationï¼‰]]></title>    <link>https://juejin.cn/post/7577563004481470518</link>    <guid>https://juejin.cn/post/7577563004481470518</guid>    <pubDate>2025-11-28T07:18:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577563004481470518" data-draft-id="7577411657393094698" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="viteè”é‚¦å®ç°å¾®å‰ç«¯ï¼ˆvite-plugin-federationï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-11-28T07:18:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸åŠªåŠ›ä¹Ÿä¸ä¼šæ··"/> <meta itemprop="url" content="https://juejin.cn/user/1869583715670808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            viteè”é‚¦å®ç°å¾®å‰ç«¯ï¼ˆvite-plugin-federationï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1869583715670808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸åŠªåŠ›ä¹Ÿä¸ä¼šæ··
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:18:15.000Z" title="Fri Nov 28 2025 07:18:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Foriginjs%2Fvite-plugin-federation" target="_blank" title="https://github.com/originjs/vite-plugin-federation" ref="nofollow noopener noreferrer">vite-plugin-federation</a>å®ç°å¾®å‰ç«¯çš„æ­å»ºå¼€å‘</h2>
<h3 data-id="heading-1">ä½¿ç”¨èƒŒæ™¯</h3>
<blockquote>
<p>è€æ¿è¯´äº†ï¼Œé¡¹ç›®æ¯”è¾ƒå¤§ï¼Œä¸å¥½ç»´æŠ¤è¦æ‹†åˆ†æˆå¤šä¸ªå­é¡¹ç›®ï¼Œè¿™æ ·æ¯æ¬¡ç»´æŠ¤å‘åŒ…æ—¶å€™åŠæ—¶æŠ¥é”™äº†ä¹Ÿä¸ä¼šå½±å“å…¶ä»–çš„é¡¹ç›®(æˆ‘ç°åœ¨ç”¨çš„æ˜¯microappï¼Œå› ä¸ºä¹‹å‰ä»–ä»¬ç”¨çš„iframeæ‹†åˆ†äº†ï¼Œåªæœ‰å¼¹æ¡†é—®é¢˜ä¸å¥½è§£å†³ï¼Œç”¨microappæ”¹é€ ä¸‹æ˜¯æœ€å¿«çš„ï¼Œæ’ä»¶é‚£å—microappåµŒå¥—æŠ¥é”™ç”¨äº†è”é‚¦å®ç°äº†)ã€‚</p>
</blockquote>
<p>æ³¨æ„ï¼šè”é‚¦æ­å»ºå¾®å‰ç«¯é€‚åˆæ–°é¡¹ç›®ï¼Œå¦‚æœå·²ç»æœ‰ç”¨iframeæ‹†åˆ†å®ç°å¾®å‰ç«¯è¿‡çš„è€é¡¹ç›®è¿˜æ˜¯ç”¨microappæ¯”è¾ƒå¥½ï¼Œå•¥éƒ½ä¸ç”¨æ”¹ç›´æ¥å¼•å…¥å°±èƒ½å®ç°å¾®å‰ç«¯ã€‚</p>
<ul>
<li>å®˜æ–¹æè¿°çš„æ˜¯å»ä¸­å¿ƒç”»ï¼Œæˆ‘è¿˜æ˜¯æŒ‰ç…§è€æ¿ç°åœ¨æƒ³æ³•å®ç°1+n+nï¼Œ</li>
</ul>
<ol>
<li>1ä¸ªæ¡†æ¶ï¼ˆç™»å½•ï¼Œæ¥å£å°è£…ï¼Œlayoutå¸ƒå±€ç­‰ï¼‰åªè¦æ­å»ºå¥½åŸºæœ¬ä¸Šä¸ä¼šåœ¨æ”¹çš„ï¼ˆæ–°å¼€é¡¹ç›®è¿™ä¸ªä¹Ÿç›´æ¥èƒ½æ‹¿å»ç”¨ï¼‰</li>
<li>nä¸ªåº”ç”¨ï¼ˆå¤§å±ï¼Œå¤šä¸ªåå°ç®¡ç†æ¨¡å—ï¼‰å°±æ˜¯æ”¹åŠ¨ç›¸å¯¹è¾ƒå°‘çš„</li>
<li>nä¸ªæ’ä»¶ï¼ˆè¦ç»™ä¸åŒå®¢æˆ·éƒ¨ç½²ï¼Œä»–ä»¬éƒ½ä¼šæè‡ªå·±éœ€æ±‚ï¼Œä¾‹å¦‚å¤§å±çš„æŸå—å±•ç¤ºï¼Œå®¢æˆ·ä¸ææˆ‘ä»¬å°±å±•ç¤ºé»˜è®¤çš„ï¼Œå®¢æˆ·æäº†å°±æ¸²æŸ“ä»–ä»¬ä¸ªæ€§åŒ–çš„å†…å®¹ï¼‰</li>
</ol>
<h3 data-id="heading-2">ä½¿ç”¨æ–¹æ³•</h3>
<ol>
<li>é¦–å…ˆåˆ›å»ºä¸¤ä¸ªé¡¹ç›®ï¼šbaseï¼Œè¿è¥ç®¡ç† å…¨æ˜¯vite+vue3 <code>pnpm create vue</code></li>
<li>å®‰è£…è”é‚¦<code>pnpm add @originjs/vite-plugin-federation --save-dev</code></li>
<li>å®˜æ–¹ä½¿ç”¨æ–¹æ³•</li>
<li>
<div>baseé¡¹ç›®å¯ä»¥devå¯åŠ¨ï¼Œè¿è¥ç®¡ç†å¿…é¡»buildä¹‹åç”¨previewé¢„è§ˆ</div>
</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// vite.config.js è¿è¥ç®¡ç†</span>
<span class="hljs-keyword">import</span> federation <span class="hljs-keyword">from</span> <span class="hljs-string">"@originjs/vite-plugin-federation"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">plugins</span>: [
        <span class="hljs-title function_">federation</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-string">'remote-app'</span>,
            <span class="hljs-attr">filename</span>: <span class="hljs-string">'remoteEntry.js'</span>,
            <span class="hljs-comment">// Modules to expose</span>
            <span class="hljs-attr">exposes</span>: {
                <span class="hljs-string">'./Button'</span>: <span class="hljs-string">'./src/Button.vue'</span>,
            },
            <span class="hljs-attr">shared</span>: [<span class="hljs-string">'vue'</span>]
        })
    ]
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// vite.config.js baseé¡¹ç›®</span>
<span class="hljs-keyword">import</span> federation <span class="hljs-keyword">from</span> <span class="hljs-string">"@originjs/vite-plugin-federation"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">plugins</span>: [
        <span class="hljs-title function_">federation</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-string">'host-app'</span>,
            <span class="hljs-attr">remotes</span>: {
                <span class="hljs-attr">remote_app</span>: <span class="hljs-string">"http://localhost:5001/assets/remoteEntry.js"</span>,
            },
            <span class="hljs-attr">shared</span>: [<span class="hljs-string">'vue'</span>]
        })
    ]
}
</code></pre>
<pre><code class="hljs language-vue" lang="vue">// é¡µé¢ä½¿ç”¨
const RemoteButton = defineAsyncComponent(() =&gt; import("remote_app/Button"));
&lt;template&gt;
    &lt;div&gt;
        &lt;RemoteButton /&gt;
    &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h3 data-id="heading-3">æ¨èä½¿ç”¨æ–¹æ³•ï¼ˆè¶…çº§å‘ï¼šä»–ä»¬ä¸­æ–‡æ–‡æ¡£æ²¡æœ‰ä»‹ç»ï¼Œæ‰¾äº†å¥½ä¹…å‘ç°å†™åœ¨äº†è‹±æ–‡æ–‡æ¡£çš„æœ€ä¸‹é¢ï¼‰</h3>
<p>ç”¨ä¸Šé¢è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨åšå®šåˆ¶åŒ–æ—¶å€™ï¼Œä¸å¥½ç”¨ï¼Œä¾‹å¦‚åå°é…ç½®ä¸ªæ€§åŒ–æ¥å£æ—¶å€™ï¼Œå‰ç«¯è‡ªåŠ¨é€šè¿‡æ¥å£å±•ç¤ºå¯¹åº”çš„ä¸ªæ€§åŒ–ã€‚æ‰€ä»¥éœ€è¦æœ‰ä¸ªèƒ½å¤ŸåŠ¨æ€åŠ è½½ç»„ä»¶æ–¹æ³•ã€‚</p>
<p>è¿è¥ç®¡ç†é‚£å—å¯¼å‡ºä¸ç”¨ä¿®æ”¹ï¼Œbaseçš„å¯¼å…¥æ–¹å¼éœ€è¦ä¿®æ”¹ä¸‹</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// vite.config.js baseé¡¹ç›®</span>
<span class="hljs-title function_">federation</span>({
  <span class="hljs-attr">remotes</span>:{
    <span class="hljs-string">"None"</span>: <span class="hljs-string">""</span> <span class="hljs-comment">//è¿™ä¸ªä¸åŠ å°±æŠ¥é”™ï¼Œä»–ä»¬issuesé‡Œæ‰¾åˆ°çš„åˆ«äººçš„è§£å†³åŠæ³•</span>
  },
  <span class="hljs-attr">shared</span>: [<span class="hljs-string">'vue'</span>, <span class="hljs-string">'pinia'</span>, <span class="hljs-string">'vue-router'</span>],
}),

</code></pre>
<p>å…ˆå®šä¸€ä¸ªå…¬å…±çš„utilæ–¹æ³•è·å–åŠ¨æ€ç»„ä»¶å’Œæ–¹æ³•</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//util.ts</span>
<span class="hljs-keyword">import</span> {
  __federation_method_getRemote <span class="hljs-keyword">as</span> getRemote,
  __federation_method_setRemote <span class="hljs-keyword">as</span> setRemote,
  __federation_method_unwrapDefault <span class="hljs-keyword">as</span> unwrap,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'virtual:__federation__'</span>

interface <span class="hljs-title class_">RemoteOptions</span> {
  <span class="hljs-attr">url</span>: string
  <span class="hljs-attr">moduleName</span>: string,
  type?: <span class="hljs-string">'ts'</span> | <span class="hljs-string">'component'</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getRemoteComponent = <span class="hljs-keyword">async</span> (<span class="hljs-attr">options</span>: <span class="hljs-title class_">RemoteOptions</span>): <span class="hljs-title class_">Promise</span>&lt;any&gt; =&gt; {
  <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> { url, moduleName, type = <span class="hljs-string">'component'</span> } = options
      <span class="hljs-keyword">const</span> remoteName = <span class="hljs-string">`remote_<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).slice(<span class="hljs-number">2</span>)}</span>`</span>
      <span class="hljs-comment">// 1. æ³¨å†Œ remote ä¿¡æ¯</span>
      <span class="hljs-title function_">setRemote</span>(remoteName, {
        <span class="hljs-attr">url</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(url),
        <span class="hljs-attr">format</span>: <span class="hljs-string">'esm'</span>,
        <span class="hljs-attr">from</span>: <span class="hljs-string">'vite'</span>,
      })

      <span class="hljs-comment">// 2. åŠ è½½æ¨¡å—</span>
      <span class="hljs-keyword">const</span> mod = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRemote</span>(remoteName, <span class="hljs-string">`./<span class="hljs-subst">${moduleName}</span>`</span>)
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'======'</span>, type)
      <span class="hljs-keyword">if</span>(type === <span class="hljs-string">'ts'</span>) <span class="hljs-keyword">return</span> mod
      <span class="hljs-comment">// 3. è§£åŒ…æ¨¡å—</span>
      <span class="hljs-keyword">const</span> <span class="hljs-title class_">Comp</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">unwrap</span>(mod)

      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Comp</span>
  } <span class="hljs-keyword">catch</span> (error) {

  }
}

</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//ä½¿ç”¨å¯¼å‡ºçš„æ–¹æ³•</span>
<span class="hljs-keyword">const</span> util = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRemoteComponent</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">'http://localhost:20001/assets/remoteEntry.js'</span>, 
    <span class="hljs-attr">moduleName</span>: <span class="hljs-string">'Util'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'ts'</span>
})
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'util'</span>, util?.<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>))
<span class="hljs-comment">//å¼•å…¥ç»„ä»¶</span>
<span class="hljs-keyword">const</span> remoteButton = <span class="hljs-title function_">getRemoteComponent</span>({
  <span class="hljs-attr">url</span>: <span class="hljs-string">'http://localhost:5001/assets/remoteEntry.js'</span>,
  <span class="hljs-attr">moduleName</span>: <span class="hljs-string">"Button"</span>
})
&lt;template&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å…·æœ‰æ·±å±‚å¼‚æ­¥ä¾èµ–çš„ç»„ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">remoteButton</span> /&gt;</span>

  <span class="hljs-comment">&lt;!-- åœ¨ #fallback æ’æ§½ä¸­æ˜¾ç¤º â€œæ­£åœ¨åŠ è½½ä¸­â€ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">fallback</span>&gt;</span>
    Loading...
  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
&lt;/template&gt;
</code></pre>
<p>è¿™æ ·å°±å¯ä»¥é€šè¿‡baseé‡Œé¢è®¾ç½®åŠ¨æ€è·¯ç”±æ¥åŠ è½½ä¸åŒå­é¡¹ç›®çš„ç»„ä»¶äº†</p>
<h3 data-id="heading-4">æˆ‘çš„ç¤ºä¾‹</h3>
<h4 data-id="heading-5">baseé¡¹ç›®å†…å®¹</h4>
<ol>
<li>ç™»å½•é¡µé¢</li>
<li>layoutå¸ƒå±€</li>
<li>è·å–ç”¨æˆ·èœå•åŠ¨æ€åŠ è½½èœå•è·¯ç”±</li>
<li>ä¸€äº›ä»–è‡ªå·±çš„é¡µé¢ï¼Œç”¨æˆ·ç®¡ç†ï¼Œè§’è‰²ç®¡ç†ç­‰</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//æ¨¡æ‹Ÿçš„ç”¨æˆ·èœå•</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getMenuList</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">resolve</span>([
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">title</span>:<span class="hljs-string">'è¿è¥ç®¡ç†'</span>,
          <span class="hljs-attr">children</span>:[
            {
              <span class="hljs-attr">id</span>: <span class="hljs-number">11</span>,
              <span class="hljs-attr">title</span>:<span class="hljs-string">'è½¦è¾†ç®¡ç†'</span>,
              <span class="hljs-attr">name</span>: <span class="hljs-string">'CarManage'</span>,
              <span class="hljs-attr">path</span>: <span class="hljs-string">'/business/CarManage'</span>,
              <span class="hljs-attr">component</span>: <span class="hljs-string">'CarManage'</span>,
              <span class="hljs-attr">source</span>: <span class="hljs-string">'http://localhost:20001/assets/remoteEntry.js'</span>
            },
            {
              <span class="hljs-attr">id</span>: <span class="hljs-number">12</span>,
              <span class="hljs-attr">title</span>:<span class="hljs-string">'è½¦è¾†è¯¦æƒ…'</span>,
              <span class="hljs-attr">name</span>: <span class="hljs-string">'CarDetail'</span>,
              <span class="hljs-attr">path</span>: <span class="hljs-string">'/business/CarDetail'</span>,
              <span class="hljs-attr">component</span>: <span class="hljs-string">'CarDetail'</span>,
              <span class="hljs-attr">source</span>: <span class="hljs-string">'http://localhost:20001/assets/remoteEntry.js'</span>
            }
          ]
        },
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
          <span class="hljs-attr">title</span>:<span class="hljs-string">'ç”¨æˆ·ç®¡ç†'</span>,
          <span class="hljs-attr">children</span>:[
            {
              <span class="hljs-attr">id</span>: <span class="hljs-number">21</span>,
              <span class="hljs-attr">title</span>:<span class="hljs-string">'ç”¨æˆ·åˆ—è¡¨'</span>,
              <span class="hljs-attr">name</span>: <span class="hljs-string">'UserList'</span>,
              <span class="hljs-attr">path</span>: <span class="hljs-string">'/user/UserList'</span>,
              <span class="hljs-attr">component</span>: <span class="hljs-string">'/user/UserListView'</span>,
            },
            {
              <span class="hljs-attr">id</span>: <span class="hljs-number">22</span>,
              <span class="hljs-attr">title</span>:<span class="hljs-string">'ç”¨æˆ·è§’è‰²'</span>,
              <span class="hljs-attr">name</span>: <span class="hljs-string">'UserRole'</span>,
              <span class="hljs-attr">path</span>: <span class="hljs-string">'/user/UserRole'</span>,
              <span class="hljs-attr">component</span>: <span class="hljs-string">'/user/UserRoleView'</span>,
            }
          ]
        }
      ])
    }, <span class="hljs-number">1000</span>)
  })
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * åŠ¨æ€åŠ è½½ç»„ä»¶ï¼ˆæ”¯æŒæœ¬åœ°å’Œè¿œç¨‹ç»„ä»¶ï¼‰
 */</span>
<span class="hljs-keyword">const</span> modules = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-title function_">glob</span>(<span class="hljs-string">"../views/**/*.vue"</span>)
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadDynamicComponent</span>(<span class="hljs-params">menu: MenuType</span>) {
  <span class="hljs-keyword">if</span> (menu.<span class="hljs-property">source</span> &amp;&amp; menu.<span class="hljs-property">component</span>) {
    <span class="hljs-comment">// è¿œç¨‹ç»„ä»¶åŠ è½½</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">getRemoteComponent</span>({
      <span class="hljs-attr">url</span>: menu.<span class="hljs-property">source</span> <span class="hljs-keyword">as</span> string,
      <span class="hljs-attr">moduleName</span>: menu.<span class="hljs-property">component</span>
    })
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (menu.<span class="hljs-property">component</span>) {
    <span class="hljs-comment">// æœ¬åœ°ç»„ä»¶åŠ è½½ - ä½¿ç”¨ import.meta.glob</span>
    <span class="hljs-keyword">let</span> <span class="hljs-attr">componentPath</span>: string

    <span class="hljs-keyword">if</span> (menu.<span class="hljs-property">component</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'/'</span>)) {
      <span class="hljs-comment">// å¦‚æœæ˜¯è·¯å¾„æ ¼å¼ (å¦‚ /user/UserList)ï¼Œè½¬æ¢ä¸ºç›¸å¯¹è·¯å¾„</span>
      componentPath = <span class="hljs-string">`../views<span class="hljs-subst">${menu.component}</span>.vue`</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// å¦‚æœæ˜¯ç»„ä»¶åæ ¼å¼ (å¦‚ UserList)ï¼Œæ·»åŠ è·¯å¾„å‰ç¼€</span>
      componentPath = <span class="hljs-string">`../views/<span class="hljs-subst">${menu.component}</span>.vue`</span>
    }

    <span class="hljs-keyword">const</span> moduleLoader = modules[componentPath]

    <span class="hljs-keyword">if</span> (moduleLoader) {
      <span class="hljs-keyword">return</span> moduleLoader
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`ç»„ä»¶æœªæ‰¾åˆ°: <span class="hljs-subst">${componentPath}</span>ï¼Œå¯ç”¨ç»„ä»¶:`</span>, <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(modules))
      <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>({
        <span class="hljs-attr">template</span>: <span class="hljs-string">'&lt;div&gt;ç»„ä»¶æœªæ‰¾åˆ°&lt;/div&gt;'</span>
      })
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
}
</code></pre>
<h4 data-id="heading-6">è¿è¥ç®¡ç†å†…å®¹</h4>
<p>åªéœ€è¦æŠŠè¦å¯¼å‡ºçš„ä¸œè¥¿éƒ½å¯¼å‡ºå°±è¡Œ</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> remoteExport = {
  <span class="hljs-title class_">CarManage</span>: <span class="hljs-string">'src/views/CarManage/CarManage.vue'</span>,
  <span class="hljs-title class_">CarDetail</span>: <span class="hljs-string">'src/views/CarManage/CarDetail.vue'</span>,
  <span class="hljs-title class_">Util</span>: <span class="hljs-string">'src/utils/index.ts'</span>
}
<span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-title function_">federation</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'remote-business'</span>,
  <span class="hljs-attr">filename</span>: <span class="hljs-string">'remoteEntry.js'</span>,
  <span class="hljs-attr">exposes</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(remoteExport).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> [<span class="hljs-string">`./<span class="hljs-subst">${key}</span>`</span>, value])
  ),
  <span class="hljs-attr">shared</span>: [<span class="hljs-string">'vue'</span>, <span class="hljs-string">'pinia'</span>, <span class="hljs-string">'vue-router'</span>]
}),
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d5b01249cea42128eaf5e8a7ee97e7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5Yqq5Yqb5Lmf5LiN5Lya5re3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919094&amp;x-signature=4BHl%2F1ROu1Wl68ZH%2BjZVj8TNMNI%3D" alt="image.png" loading="lazy"/></p>
<p>åˆ°ç°åœ¨å·²ç»å®ç°äº†å¾®å‰ç«¯äº†</p>
<h3 data-id="heading-7">å¼€å‘æ—¶å€™çš„ä¼˜åŒ–</h3>
<p>ç°åœ¨å­é¡¹ç›®å¿…é¡»buildä¹‹åæ‰èƒ½ç”ŸæˆremoteEntryï¼Œä¹Ÿå°±æ²¡åŠæ³•çƒ­æ›´æ–°ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨é€šçŸ¥ï¼Œbaseé¡¹ç›®å…¨å±€åˆ·æ–°ï¼Œå®ç°ä¼ªçƒ­æ›´æ–°æ•ˆæœ</p>
<p>å‚è€ƒä¸‹ä¸‹é¢çš„æ’ä»¶</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Options</span> {
  <span class="hljs-attr">role</span>: <span class="hljs-string">'remote'</span> | <span class="hljs-string">'host'</span>;
  host?: <span class="hljs-built_in">string</span>;
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">syncReloadPlugin</span>(<span class="hljs-params">options: Options</span>) {
  <span class="hljs-keyword">const</span> role = options.<span class="hljs-property">role</span>;
  <span class="hljs-keyword">const</span> hostUrl = options.<span class="hljs-property">host</span>;

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'vite-plugin-sync-reload'</span>,

    <span class="hljs-title function_">apply</span>(<span class="hljs-params">config: <span class="hljs-built_in">any</span>, { command }: <span class="hljs-built_in">any</span></span>) {
      <span class="hljs-keyword">if</span> (role !== <span class="hljs-string">'remote'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'dev'</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Boolean</span>(command === <span class="hljs-string">'build'</span> &amp;&amp; config.<span class="hljs-property">build</span>?.<span class="hljs-property">watch</span>);
    },

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildEnd</span>(<span class="hljs-params">error: <span class="hljs-built_in">any</span></span>) {
      <span class="hljs-keyword">if</span> (role !== <span class="hljs-string">'remote'</span>) <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span>;

      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`<span class="hljs-subst">${hostUrl}</span>/__fullReload`</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[remote] å·²é€šçŸ¥ host åˆ·æ–°`</span>);
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[remote] é€šçŸ¥ host å¤±è´¥ï¼ˆå¯èƒ½ host æœªå¯åŠ¨ï¼‰`</span>);
      }
    },

    <span class="hljs-title function_">configureServer</span>(<span class="hljs-params">server: <span class="hljs-built_in">any</span></span>) {

      <span class="hljs-keyword">if</span> (role !== <span class="hljs-string">'host'</span>) <span class="hljs-keyword">return</span>;

      server.<span class="hljs-property">middlewares</span>.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req: <span class="hljs-built_in">any</span>, res: <span class="hljs-built_in">any</span>, next: <span class="hljs-built_in">any</span></span>) =&gt;</span> {

          <span class="hljs-comment">// remote build åä¼šè®¿é—®è¿™é‡Œ</span>
          <span class="hljs-keyword">if</span> (req.<span class="hljs-property">url</span> === <span class="hljs-string">'/__fullReload'</span>) {

            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[host] æ”¶åˆ° remote é€šçŸ¥ï¼Œå³å°†åˆ·æ–°é¡µé¢'</span>);

            <span class="hljs-comment">// è§¦å‘æµè§ˆå™¨åˆ·æ–°</span>
            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span>{
              server.<span class="hljs-property">hot</span>.<span class="hljs-title function_">send</span>({
                <span class="hljs-attr">type</span>: <span class="hljs-string">'full-reload'</span>
              });
            },<span class="hljs-number">100</span>)

            res.<span class="hljs-title function_">end</span>(<span class="hljs-string">'Full reload triggered'</span>);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_">next</span>(); <span class="hljs-comment">// ç»§ç»­ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</span>
          }
        });
    }
  };
}

<span class="hljs-title function_">syncReloadPlugin</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">'host'</span> }),
<span class="hljs-title function_">syncReloadPlugin</span>({
  <span class="hljs-attr">role</span>: <span class="hljs-string">'remote'</span>,
  <span class="hljs-attr">host</span>: <span class="hljs-string">'http://localhost:20000'</span>
})
</code></pre>
<h3 data-id="heading-8">æˆ‘çš„ç¤ºä¾‹ä»£ç </h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2F5563%2Ffederation-microapp" target="_blank" title="https://github.com/5563/federation-microapp" ref="nofollow noopener noreferrer">ä¸€ä¸ªè”é‚¦å®ç°å¾®å‰ç«¯çš„ç¤ºä¾‹ä»£ç </a> : <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2F5563%2Ffederation-microapp" target="_blank" title="https://github.com/5563/federation-microapp" ref="nofollow noopener noreferrer">github.com/5563/federaâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ­å»ºç®€æ˜“ç‰ˆmonorepo + turborepo]]></title>    <link>https://juejin.cn/post/7577298871005364258</link>    <guid>https://juejin.cn/post/7577298871005364258</guid>    <pubDate>2025-11-28T07:24:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577298871005364258" data-draft-id="7577378514401706019" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ­å»ºç®€æ˜“ç‰ˆmonorepo + turborepo"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-11-28T07:24:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‡¡äººç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/3237375877059565"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ­å»ºç®€æ˜“ç‰ˆmonorepo + turborepo
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3237375877059565/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‡¡äººç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:24:00.000Z" title="Fri Nov 28 2025 07:24:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<ul>
<li>é¡¹ç›®ç»“æ„ï¼špnpm Monorepo</li>
</ul>

<ul>
<li>
<ul>
<li><code>packages/ui</code>ï¼šReact ç»„ä»¶åº“ï¼ˆä½¿ç”¨ Vite + TS æ‰“åŒ…ï¼‰</li>
<li><code>apps/react-demo</code>ï¼šReact åº”ç”¨ï¼Œä¾èµ– <code>@my-org/ui</code></li>
</ul>
</li>
</ul>

<ul>
<li>ç›®æ ‡ï¼š</li>
</ul>

<ul>
<li>
<ul>
<li>âœ… å¼€å‘ç¯å¢ƒï¼šä¿®æ”¹ <code>ui</code> æºç  â†’ è‡ªåŠ¨çƒ­æ›´æ–°åˆ° <code>react-demo</code></li>
<li>âœ… ç”Ÿäº§æ„å»ºï¼š<code>react-demo</code> èƒ½æ­£ç¡®æ‰“åŒ… <code>@my-org/ui</code></li>
</ul>
</li>
</ul>
<h2 data-id="heading-1">é‡åˆ°çš„é—®é¢˜ &amp; è§£å†³æ–¹æ¡ˆ</h2>
<h2 data-id="heading-2">âŒ é—®é¢˜ 1ï¼šç”Ÿäº§æ„å»ºæ—¶æŠ¥é”™ â€”â€” <code>@my-org/ui</code> æ— æ³•è§£æ</h2>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// é”™è¯¯ä¿¡æ¯</span>
[vite]: Rolldown failed to resolve <span class="hljs-keyword">import</span> <span class="hljs-string">"@my-org/ui"</span> ...
</code></pre>
<h3 data-id="heading-3">ğŸ” æ ¹æœ¬åŸå› ï¼š</h3>
<ul>
<li><code>react-demo</code> çš„ <code>node_modules/@my-org/ui/</code> ä¸­ <strong>æ²¡æœ‰</strong> ****<code>dist/ </code>****<strong>ç›®å½•</strong></li>
<li>å¯¼è‡´ Vite æ‰¾ä¸åˆ° JS å…¥å£æ–‡ä»¶ï¼ˆå¦‚ <code>ui.js</code>ï¼‰</li>
</ul>
<h3 data-id="heading-4">âœ… è§£å†³æ­¥éª¤ï¼š</h3>
<ol>
<li><strong>ç¡®è®¤</strong> ****<code>packages/ui/package.json</code> ****<strong>åŒ…å«</strong> ****<code>"files": ["dist"]</code><br/>
â†’ å¦åˆ™ pnpm ä¸ä¼šæŠŠ <code>dist</code> é“¾æ¥åˆ° consumer çš„ <code>node_modules</code></li>
<li><strong>å…ˆæ„å»º UI åº“</strong></li>
</ol>
<pre><code class="hljs language-css" lang="css">
pnpm <span class="hljs-attr">--filter</span> <span class="hljs-keyword">@my-org</span>/ui build
</code></pre>
<ol start="3">
<li><strong>ç¡®ä¿</strong> ****<code>react-demo</code> ****<strong>å£°æ˜äº†ä¾èµ–</strong></li>
</ol>
<pre><code class="hljs language-sql" lang="sql">
pnpm <span class="hljs-keyword">add</span> <span class="hljs-variable">@my</span><span class="hljs-operator">-</span>org<span class="hljs-operator">/</span>ui<span class="hljs-variable">@workspace</span>:<span class="hljs-operator">*</span> <span class="hljs-comment">--filter react-demo</span>
</code></pre>
<ol start="4">
<li><strong>å¼ºåˆ¶åˆ·æ–°é“¾æ¥</strong></li>
</ol>
<pre><code class="hljs language-css" lang="css">
pnpm install <span class="hljs-attr">--force</span>
</code></pre>
<p>ğŸ’¡ å…³é”®è®¤çŸ¥ï¼š<strong>pnpm workspace é“¾æ¥ â‰  å®æ—¶ç›®å½•æ˜ å°„</strong>ï¼Œå®ƒåªé“¾æ¥ <code>package.json</code> ä¸­å£°æ˜çš„æ–‡ä»¶ï¼ˆé€šè¿‡ <code>files</code>ï¼‰ï¼Œä¸”éœ€åœ¨ <code>dist</code> å­˜åœ¨åæ‰§è¡Œ <code>install</code>ã€‚</p>
<h2 data-id="heading-5">âŒ é—®é¢˜ 2ï¼š<code>package.json</code> å…¥å£æ–‡ä»¶åä¸å®é™…è¾“å‡ºä¸ä¸€è‡´</h2>
<ul>
<li>é…ç½®å†™çš„æ˜¯ï¼š</li>
</ul>
<pre><code class="hljs language-json" lang="json">
<span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/index.js"</span>
</code></pre>
<ul>
<li>ä½† Vite é»˜è®¤è¾“å‡ºï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">
dist/ui.js
dist/ui.mjs
</code></pre>
<h3 data-id="heading-6">ğŸ” åæœï¼š</h3>
<ul>
<li>å³ä½¿ <code>dist</code> è¢«é“¾æ¥ï¼ŒVite ä»å°è¯•åŠ è½½ä¸å­˜åœ¨çš„ <code>index.js</code> â†’ æ¨¡å—è§£æå¤±è´¥</li>
</ul>
<h3 data-id="heading-7">âœ… è§£å†³æ–¹æ¡ˆï¼ˆäºŒé€‰ä¸€ï¼‰ï¼š</h3>

















<table><thead><tr><th>æ–¹æ¡ˆ</th><th>æ“ä½œ</th></tr></thead><tbody><tr><td><strong>Aï¼ˆæ¨èï¼‰</strong></td><td>ä¿®æ”¹ <code>package.json</code>æŒ‡å‘çœŸå®æ–‡ä»¶ï¼š <code>"main": "./dist/ui.js"</code></td></tr><tr><td><strong>B</strong></td><td>ä¿®æ”¹ <code>vite.config.ts</code>å¼ºåˆ¶è¾“å‡º <code>index.js</code>ï¼š <code>fileName: (format) =&gt; </code>index.${format === 'es' ? 'mjs' : 'js'}``</td></tr></tbody></table>
<p>âœ… æœ€ç»ˆé€‰æ‹© <strong>æ–¹æ¡ˆ A</strong>ï¼Œé¿å…æ”¹æ„å»ºé…ç½®ï¼Œæ›´ç®€å•ç›´æ¥ã€‚</p>
<h2 data-id="heading-8">âŒ é—®é¢˜ 3ï¼šå³ä½¿ <code>files</code> æ­£ç¡®ï¼Œ<code>dist</code> ä»ä¸å‡ºç°</h2>
<p>è¿è¡Œ <code>pnpm install --force</code> åï¼Œ<code>node_modules/@my-org/ui/dist</code> ä¾ç„¶ä¸å­˜åœ¨ã€‚</p>
<h3 data-id="heading-9">ğŸ” æ·±å±‚åŸå› ï¼š</h3>
<ul>
<li><code>react-demo/package.json</code> <strong>æœªå£°æ˜å¯¹</strong> ****<code>@my-org/ui</code> ****<strong>çš„ä¾èµ–</strong></li>
<li>pnpm <strong>ä¸ä¼šè‡ªåŠ¨é“¾æ¥æœªå£°æ˜çš„ workspace åŒ…</strong></li>
</ul>
<h3 data-id="heading-10">âœ… è§£å†³ï¼š</h3>
<pre><code class="hljs language-sql" lang="sql">
pnpm <span class="hljs-keyword">add</span> <span class="hljs-variable">@my</span><span class="hljs-operator">-</span>org<span class="hljs-operator">/</span>ui<span class="hljs-variable">@workspace</span>:<span class="hljs-operator">*</span> <span class="hljs-comment">--filter react-demo</span>
</code></pre>
<p>â†’ æ˜¾å¼å»ºç«‹ä¾èµ–å…³ç³»ï¼Œpnpm æ‰ä¼šåˆ›å»º symlink å¹¶åŒ…å« <code>dist/</code>ã€‚</p>
<p>ğŸ“Œ è¿™æ˜¯ Monorepo çš„æ ¸å¿ƒè§„åˆ™ï¼š <strong>â€œæœªå£°æ˜ = ä¸å­˜åœ¨â€</strong></p>
<h2 data-id="heading-11">âœ… é—®é¢˜ 4ï¼šå¼€å‘ç¯å¢ƒå¦‚ä½•å®ç°çƒ­æ›´æ–°ï¼Ÿ</h2>
<p>ç”Ÿäº§æ„å»ºæˆåŠŸåï¼Œéœ€æ”¯æŒå¼€å‘æ—¶å®æ—¶ç¼–è¾‘ <code>ui</code> ç»„ä»¶ã€‚</p>
<h3 data-id="heading-12">âœ… è§£å†³æ–¹æ¡ˆï¼š</h3>
<ol>
<li><strong>åœ¨</strong> ****<code>react-demo/vite.config.ts</code> ****<strong>ä¸­æ·»åŠ  alias</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-css" lang="css">
resolve: {
  alias: {
    '<span class="hljs-keyword">@my-org</span>/ui': path.resolve(__dirname, <span class="hljs-string">'../../packages/ui/src'</span>)
  }
}
</code></pre>
<ol start="2">
<li><strong>å¯åŠ¨å¼€å‘æœåŠ¡å™¨</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-css" lang="css">
pnpm <span class="hljs-attr">--filter</span> react-demo dev
</code></pre>
<p>ğŸ’¡ åŸç†ï¼šVite ç›´æ¥ç¼–è¯‘ <code>ui/src</code> æºç ï¼ˆè€Œé <code>dist</code>ï¼‰ï¼Œå¤©ç„¶æ”¯æŒ HMR å’Œ TSXã€‚</p>
<hr/>
<h2 data-id="heading-13">ğŸ§ª éªŒè¯æ¸…å•ï¼ˆæœ€ç»ˆçŠ¶æ€ï¼‰</h2>



































<table><thead><tr><th>æ£€æŸ¥é¡¹</th><th>å‘½ä»¤</th><th>é¢„æœŸç»“æœ</th></tr></thead><tbody><tr><td>UI åº“å·²æ„å»º</td><td><code>ls packages/ui/dist</code></td><td>æœ‰ <code>ui.js</code>, <code>ui.mjs</code>, <code>*.d.ts</code></td></tr><tr><td>ä¾èµ–å·²å£°æ˜</td><td><code>grep "@my-org/ui" apps/react-demo/package.json</code></td><td>æœ‰ <code>"@my-org/ui": "workspace:*"</code></td></tr><tr><td>é“¾æ¥å·²åŒæ­¥</td><td><code>ls apps/react-demo/node_modules/@my-org/ui/dist</code></td><td>æ–‡ä»¶å­˜åœ¨</td></tr><tr><td>ç”Ÿäº§æ„å»ºæˆåŠŸ</td><td><code>pnpm --filter react-demo build</code></td><td>æ— æŠ¥é”™ï¼Œç”Ÿæˆ <code>dist/</code></td></tr><tr><td>å¼€å‘çƒ­æ›´æ–°</td><td>ä¿®æ”¹ <code>ui/src/Button.tsx</code>â†’ æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°</td><td>âœ… å®æ—¶ç”Ÿæ•ˆ</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-14">ğŸ“š ç»éªŒæ€»ç»“</h2>

























<table><thead><tr><th>åœºæ™¯</th><th>å…³é”®é…ç½®</th></tr></thead><tbody><tr><td><strong>ç”Ÿäº§æ„å»º</strong></td><td><code>package.json</code>çš„ <code>main</code>/<code>module</code>å¿…é¡»åŒ¹é…çœŸå®æ–‡ä»¶å + <code>"files": ["dist"]</code></td></tr><tr><td><strong>ä¾èµ–é“¾æ¥</strong></td><td>Consumer å¿…é¡»åœ¨ <code>package.json</code>ä¸­æ˜¾å¼å£°æ˜ <code>workspace:*</code>ä¾èµ–</td></tr><tr><td><strong>å¼€å‘ä½“éªŒ</strong></td><td>é€šè¿‡ Vite <code>alias</code>æŒ‡å‘ <code>src</code>ï¼Œç»•è¿‡ <code>dist</code>ï¼Œå®ç° HMR</td></tr><tr><td><strong>æ„å»ºé¡ºåº</strong></td><td>å…ˆ <code>build ui</code>â†’ å† <code>pnpm install</code>â†’ æœ€å <code>build app</code></td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Uptime Kumaä¿®æ”¹ä½œä¸ºå†…åµŒé¡µé¢çš„è‡ªé€‚åº”]]></title>    <link>https://juejin.cn/post/7577294037717909538</link>    <guid>https://juejin.cn/post/7577294037717909538</guid>    <pubDate>2025-11-28T06:05:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577294037717909538" data-draft-id="7577284968923627520" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Uptime Kumaä¿®æ”¹ä½œä¸ºå†…åµŒé¡µé¢çš„è‡ªé€‚åº”"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-28T06:05:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¼äº¿ä¼åƒä¸‡"/> <meta itemprop="url" content="https://juejin.cn/user/3651901500169884"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Uptime Kumaä¿®æ”¹ä½œä¸ºå†…åµŒé¡µé¢çš„è‡ªé€‚åº”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3651901500169884/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¼äº¿ä¼åƒä¸‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:05:05.000Z" title="Fri Nov 28 2025 06:05:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="http://openwrite.cn/uploads/19960/56785/d9298a17-80c5-4259-8024-6ecef5b8c0ea.png" alt="8bd3c9d3a7ce456aa6cdd4d140de4d67.png" loading="lazy"/></p>
<pre><code class="hljs language-html" lang="html">/* ==================================
1. åŸºç¡€æ ·å¼é‡ç½®ï¼ˆæ¶ˆé™¤é»˜è®¤è¾¹è·/æº¢å‡ºï¼‰
================================== */
/* é‡ç½® html/body é»˜è®¤è¾¹è·ï¼Œç¦æ­¢é¡µé¢è‡ªèº«æ»šåŠ¨ï¼ˆç”± iframe æ§åˆ¶æ»šåŠ¨ï¼‰ */
html,
body {
  margin: 0;
  padding: 0;
  overflow: hidden;
}


/* ==================================
2. iframe é€‚é…æ ¸å¿ƒæ ·å¼ï¼ˆé¡µé¢ç¼©æ”¾é€»è¾‘ï¼‰
================================== */
/* é¡µé¢æœ€å¤–å±‚å®¹å™¨ç¼©æ”¾é…ç½®ï¼ˆé€‚é… iframe å¤§å°ï¼‰
   æ³¨ï¼šè‹¥å®é™…å¤–å±‚å®¹å™¨ä¸æ˜¯ .appï¼Œéœ€æ›¿æ¢ä¸ºçœŸå®ç±»åï¼ˆå¦‚ .containerã€.status-page ç­‰ï¼‰ */
.app {
  /* 1. åŸºå‡†å°ºå¯¸ï¼ˆéœ€æ ¹æ®é¡µé¢å®é™…è®¾è®¡ç¨¿è°ƒæ•´ï¼Œæ­¤å¤„ä¸ºç¤ºä¾‹å€¼ï¼‰ */
  width: 1000px;  /* é¡µé¢ç†æƒ³å®½åº¦ï¼ˆåŸºå‡†ï¼‰ */
  height: 600px;  /* é¡µé¢ç†æƒ³é«˜åº¦ï¼ˆåŸºå‡†ï¼‰ */
  margin: 0 auto; /* å¯é€‰ï¼šè®©å®¹å™¨æ°´å¹³å±…ä¸­ï¼ˆè‹¥ iframe å®½åº¦å¤§äºåŸºå‡†å®½åº¦æ—¶ç”Ÿæ•ˆï¼‰ */

  /* 2. æŒ‰ iframe å®½åº¦è‡ªåŠ¨ç¼©æ”¾ï¼ˆæ ¸å¿ƒé€‚é…é€»è¾‘ï¼‰ */
  transform-origin: top left; /* ç¼©æ”¾åŸç‚¹ï¼šå·¦ä¸Šè§’ï¼ˆé¿å…ç¼©æ”¾åç§»ï¼‰ */
  transform: scale(calc(100vw / 1000)); /* ç¼©æ”¾æ¯”ä¾‹ = iframe å®½åº¦ Ã· åŸºå‡†å®½åº¦ */

  /* 3. åŒæ­¥ç¼©æ”¾é«˜åº¦ï¼ˆä¿è¯é¡µé¢æ¯”ä¾‹ä¸å˜å½¢ï¼‰ */
  height: calc(600 * (100vw / 1000) * 1px);
}


/* ==================================
3. å…ƒç´ éšè—ï¼ˆæŒ‰éœ€éšè—æŒ‡å®šæ ‡ç­¾/å®¹å™¨ï¼‰
================================== */
/* éšè—æ‰€æœ‰ h1 æ ‡ç­¾ï¼ˆå…¨å±€ï¼‰ */
h1 {
  display: none !important;
}

/* éšè—å«â€œæœåŠ¡â€æ–‡æœ¬çš„ç›®æ ‡ h2 æ ‡ç­¾ï¼ˆç²¾å‡†åŒ¹é… data-v å±æ€§å’Œç±»åï¼‰ */
h2.group-title[data-v-f71ca08e] {
  display: none !important;
}

/* éšè—æŒ‡å®š alert å®¹å™¨ï¼ˆåŒ¹é… data-v å±æ€§å’Œç±»åï¼‰ */
div.alert-heading.p-2[data-v-b8247e57] {
  display: none !important;
}

/* éšè—é¡µé¢åº•éƒ¨ footer åŒºåŸŸï¼ˆå…¨å±€ï¼‰ */
footer {
  display: none !important;
}


/* ==================================
4. é—´è·è°ƒæ•´ï¼ˆè¦†ç›–é»˜è®¤ padding/marginï¼‰
================================== */
/* æ¸…é™¤ .p-4 ç±»çš„æ‰€æœ‰å†…è¾¹è·ï¼ˆä¸Šä¸‹å·¦å³å‡ä¸º 0ï¼‰ */
.p-4 {
  padding: 0 !important;
}

/* æ¸…é™¤ .mb-4 ç±»çš„åº•éƒ¨å¤–è¾¹è·ï¼ˆè®¾ä¸º 0ï¼‰ */
.mb-4 {
  margin-bottom: 0 !important;
}

/* è°ƒæ•´ .mt-4 ç±»çš„é¡¶éƒ¨å¤–è¾¹è·ï¼ˆä» 1.5rem æ”¹ä¸º 0.5remï¼‰ */
.mt-4 {
  margin-top: 0.5rem !important;
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MCPç†è®ºå’Œå®æˆ˜ï¼Œç„¶ååšä¸ªMCPè„šæ‰‹æ¶å§]]></title>    <link>https://juejin.cn/post/7577461079598055443</link>    <guid>https://juejin.cn/post/7577461079598055443</guid>    <pubDate>2025-11-28T07:42:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577461079598055443" data-draft-id="7577461079597940755" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MCPç†è®ºå’Œå®æˆ˜ï¼Œç„¶ååšä¸ªMCPè„šæ‰‹æ¶å§"/> <meta itemprop="keywords" content="å‰ç«¯,MCP,Node.js"/> <meta itemprop="datePublished" content="2025-11-28T07:42:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç–¯ç‹‚è¸©å‘äºº"/> <meta itemprop="url" content="https://juejin.cn/user/1011206430698574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MCPç†è®ºå’Œå®æˆ˜ï¼Œç„¶ååšä¸ªMCPè„šæ‰‹æ¶å§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1011206430698574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç–¯ç‹‚è¸©å‘äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:42:00.000Z" title="Fri Nov 28 2025 07:42:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¼•è¨€:  æœ¬æ–‡ä»‹ç»äº†ç›®å‰MCP Serverçš„å¼€å‘æ–¹å¼å’ŒåŸç†ï¼ŒåŒ…æ‹¬streamable HTTPå’ŒSTDIOä¸¤ç§ã€‚å¹¶æä¾›äº†ä¸€ä¸ªnpmè„šæ‰‹æ¶å·¥å…·å¸®ä½ åˆ›å»ºé¡¹ç›®ï¼Œæ¯ä¸ªæ¨¡æ¿é¡¹ç›®éƒ½æ˜¯å¯è¿è¡Œçš„ã€‚</p>
</blockquote>
<h2 data-id="heading-0">streamable HTTP</h2>
<h3 data-id="heading-1">åŸç†åˆ†æ</h3>
<h4 data-id="heading-2">æŠ“åŒ…ã€Œæ¡æ‰‹ã€</h4>
<p>MCP Clientæ€»å…±å‘äº†ä¸‰æ¬¡è¯·æ±‚ï¼ŒMCP Serverå“åº”2æ¬¡ã€‚å®é™…çš„æ¡æ‰‹æµç¨‹æ˜¯4æ¬¡æ¡æ‰‹ï¼Œç¬¬5æ¬¡è¯·æ±‚æ˜¯ä¸ºäº†é€šçŸ¥åç»­çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚è¿›åº¦ï¼Œæ—¥å¿—ç­‰ã€‚ ç›®å‰è§„èŒƒå®ç°æ¥çœ‹ï¼Œç¬¬5æ¬¡æ¡æ‰‹ä¸å½±å“æ­£å¸¸åŠŸèƒ½ï¼‰</p>
<p>ä½¿ç”¨<code>wiresshark</code>æŠ“åŒ…ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/062da5b0a9fa41b1aa37038f0b9b2c25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764920520&amp;x-signature=FcUNFYf9H2TEZ9ACI4D7GoG4lp4%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eea2aecc794d4e738caa3175ffc0a78b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764920520&amp;x-signature=dhqJ6uz5suXZf4RNVb20XCknWao%3D" alt="image.png" loading="lazy"/></p>
<p>ä»å®˜ç½‘çš„ã€Œinitializationã€æµç¨‹æ¥çœ‹ï¼Œä¹Ÿå°±æ˜¯4æ¬¡ï¼ˆç¬¬5æ¬¡æœªæ¥åº”è¯¥ä¼šè¢«æ™®éå®ç°ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b8856cf742f4926a58a2cbfe8ef0b32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764920520&amp;x-signature=pdqDqQREOaxHG4PgjxFbLBTVBUI%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ç¬¬1æ¬¡</strong> Postè¯·æ±‚ï¼Œ<code>initialize</code> æ–¹æ³•</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"initialize"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"protocolVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-06-18"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"capabilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"sampling"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"elicitation"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"roots"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"listChanged"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"clientInfo"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"inspector-client"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0.17.2"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ç¬¬2æ¬¡</strong> ï¼š200 OKï¼Œå“åº”ä½“å¦‚ä¸‹</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"protocolVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-06-18"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"capabilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"tools"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"listChanged"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"serverInfo"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"weather"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0.0.1"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ç¬¬3æ¬¡</strong> ï¼šPostè¯·æ±‚ï¼Œ<code>notifications/initialized</code>æ–¹æ³•</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"notifications/initialized"</span><span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ç¬¬4æ¬¡</strong> ï¼š202 Acceptedï¼Œæ— å“åº”ä½“</p>
<p><strong>ç¬¬5æ¬¡</strong> ï¼šGetè¯·æ±‚ï¼Œæ­¤æ—¶è¦æ±‚æœåŠ¡ç«¯ä¸€å®šæ˜¯SSEä¼ è¾“äº†-<code>accept: text/event-stream</code></p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">GET</span> /mcp HTTP/<span class="hljs-number">1.1</span>
<span class="hljs-symbol">accept:</span> <span class="hljs-keyword">text</span>/<span class="hljs-keyword">event</span>-stream
</code></pre>
<h4 data-id="heading-3">æ€»ç»“ã€Œæ¡æ‰‹ã€æµç¨‹</h4>
<ol>
<li>
<p><strong>POST /mcp (initialize)</strong></p>
<ul>
<li>å®¢æˆ·ç«¯ï¼šä½ å¥½ï¼Œæˆ‘æ˜¯ Inspector Clientï¼Œæˆ‘æƒ³åˆå§‹åŒ–ã€‚</li>
<li>æœåŠ¡å™¨ï¼šæ”¶åˆ°ï¼Œè¿™æ˜¯æˆ‘çš„èƒ½åŠ›åˆ—è¡¨ï¼ˆ200 OKï¼‰ã€‚</li>
<li>çŠ¶æ€ï¼šJSON-RPC ä¼šè¯å¼€å§‹ã€‚</li>
</ul>
</li>
<li>
<p><strong>POST /mcp (notifications/initialized)</strong></p>
<ul>
<li>å®¢æˆ·ç«¯ï¼šæˆ‘å·²ç»æ”¶åˆ°ä½ çš„èƒ½åŠ›äº†ï¼Œåˆå§‹åŒ–å®Œæˆã€‚</li>
<li>æœåŠ¡å™¨ï¼šæ”¶åˆ° (202 Accepted)ã€‚</li>
<li>çŠ¶æ€ï¼šé€»è¾‘æ¡æ‰‹å®Œæˆã€‚</li>
</ul>
</li>
<li>
<p><strong>GET /mcp (Header: accept: text/event-stream)</strong></p>
<ul>
<li><strong>ç›®çš„</strong>ï¼šå®¢æˆ·ç«¯ç°åœ¨è¯•å›¾å»ºç«‹<strong>é•¿è¿æ¥é€šé“</strong>ï¼Œä»¥ä¾¿åœ¨æœªæ¥èƒ½æ”¶åˆ°æœåŠ¡å™¨å‘æ¥çš„é€šçŸ¥ï¼ˆæ¯”å¦‚ notifications/message æˆ– roots/listChangedï¼‰ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªé€šé“ï¼ŒæœåŠ¡å™¨å°±å˜æˆäº†â€œå“‘å·´â€ï¼Œæ— æ³•ä¸»åŠ¨è”ç³»å®¢æˆ·ç«¯ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-4">åç»­é€šä¿¡</h4>
<h5 data-id="heading-5">tools/list (åˆ—å‡ºå·¥å…·)</h5>
<p><strong>client-&gt;server è¯·æ±‚</strong></p>
<p>è¯·æ±‚å¤´ï¼š</p>
<pre><code class="hljs language-http" lang="http">POST /mcp HTTP/1.1
accept: application/json, text/event-stream
accept-encoding: gzip, deflate, br
content-length: 85
content-type: application/json
mcp-protocol-version: 2025-06-18
user-agent: node-fetch
Host: localhost:3000
Connection: keep-alive
</code></pre>
<p>è¯·æ±‚æ•°æ®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tools/list"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"_meta"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"progressToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>P.S. <code>params</code>ä¸­çš„<code>progressToken</code>æ˜¯å¯ä»¥ç”¨äºåç»­çš„è¿›åº¦é€šçŸ¥çš„ï¼ˆé€šè¿‡SSEï¼‰</p>
<p><strong>server-&gt;client å“åº”</strong></p>
<p>å“åº”å¤´ï¼š</p>
<pre><code class="hljs language-http" lang="http">HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: application/json
Date: Thu, 27 Nov 2025 11:52:31 GMT
Connection: keep-alive
Keep-Alive: timeout=5
Transfer-Encoding: chunked
</code></pre>
<p>å“åº”ä½“ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"tools"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"get_weather_now"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Get Weather Now"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Get current weather for a location (city name)"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"inputSchema"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"$schema"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"object"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"location"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
              <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Location name or city (e.g. beijing, shanghai, new york, tokyo)"</span><span class="hljs-punctuation">,</span>
              <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span>
            <span class="hljs-punctuation">}</span>
          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"required"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-string">"location"</span>
          <span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è¿™é‡Œåˆ—å‡ºä¸€ä¸ªå·¥å…·ï¼š</p>
<ul>
<li><code>get_weather_now</code>ï¼Œæˆ‘ä»¬è‡ªå·±å®šä¹‰/æ³¨å†Œçš„å·¥å…·ã€‚æˆ‘ä»¬å¯ä»¥æ‹¿åˆ°å®ƒçš„<code>title</code>ï¼Œ<code>description</code>å’Œ<code>inputSchema</code>ï¼Œè¿™äº›è¯­ä¹‰ä¿¡æ¯å¯ä»¥å¸®åŠ©LLMç†è§£è¿™ä¸ªå·¥å…·ã€‚</li>
</ul>
<h5 data-id="heading-6">tools/call (è°ƒç”¨tool)</h5>
<p>è¿™é‡Œé€šè¿‡ mcp inspector å·¥å…·è°ƒç”¨äº†<code>get_weather_now</code>ï¼Œè¯·æ±‚ä½“å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tools/call"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"_meta"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"progressToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"get_weather_now"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"location"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"åŒ—äº¬"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å“åº”ä½“ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Weather for åŒ—äº¬, CN:\nCondition: æ™´\nTemperature: 3Â°C\nLast Update: 2025-11-27T19:50:14+08:00"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h5 data-id="heading-7">æ–¹æ³•å°æ€»ç»“</h5>
<p>ä¸Šé¢æˆ‘ä»¬åˆ—å‡ºäº†ä¸¤ç§å¸¸è§çš„æ–¹æ³•</p>
<ul>
<li><code>tools/list</code>ã€‚MCP Clientåœ¨å‘LLMå‘è¯·æ±‚æºå¸¦åˆ—å‡ºçš„toolï¼ŒLLMä¼šå‘Šè¯‰å®¢æˆ·ç«¯è°ƒç”¨çš„tool nameï¼Œç„¶åç”±MCP clientæ¥è§¦å‘toolè°ƒç”¨ã€‚</li>
<li><code>tools/call</code>ã€‚MCP Clientå‘Šè¯‰MCP Server è°ƒç”¨å“ªä¸ªtoolã€‚</li>
</ul>
<p>å¯ä»¥ç»“åˆå®˜ç½‘çš„è¿™å¼ ç¤ºæ„å›¾ï¼Œè°ƒç”¨toolå°±æ˜¯ä¸€æ¬¡request/responseã€‚å¦‚æœæ˜¯é•¿ä»»åŠ¡ï¼Œå¯ä»¥é€šè¿‡<code>_meta.progressToken</code>ä½œä¸ºå…³è”ï¼Œé€šè¿‡SSEæŒç»­é€šçŸ¥è¿›åº¦ï¼ˆè¿˜è®°å¾—ã€Œæ¡æ‰‹ã€æµç¨‹çš„ç¬¬5æ¬¡æ¡æ‰‹å—ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b405223577d459a88ed0224fae26823~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764920520&amp;x-signature=8xuD9HU4MNNXfBcgP9QQBVvzcH0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">ä»£ç å®æˆ˜ - å¤©æ°”å·¥å…·</h3>
<h4 data-id="heading-9">å‡†å¤‡å¤©æ°”API</h4>
<p>è¿™é‡Œæˆ‘ä½¿ç”¨äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.seniverse.com%2F" target="_blank" title="https://www.seniverse.com/" ref="nofollow noopener noreferrer">å¿ƒçŸ¥å¤©æ°”</a>çš„APIï¼Œç„¶åè‡ªå·±å°è£…ä¸€ä¸ªnode APIã€‚
<code>src/core/seniverse.ts</code></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> crypto <span class="hljs-keyword">from</span> <span class="hljs-string">'node:crypto'</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> querystring <span class="hljs-keyword">from</span> <span class="hljs-string">'node:querystring'</span>;
<span class="hljs-comment">/**
 * æŸ¥è¯¢å¤©æ°”æ¥å£
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_URL</span> = <span class="hljs-string">'https://api.seniverse.com/v3/'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SeniverseApi</span> {
    publicKey;
    secretKey;
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">publicKey, secretKey</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">publicKey</span> = publicKey;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">secretKey</span> = secretKey;
    }
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getWeatherNow</span>(<span class="hljs-params">location</span>) {
        <span class="hljs-keyword">const</span> params = {
            <span class="hljs-attr">ts</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() / <span class="hljs-number">1000</span>), <span class="hljs-comment">// Current timestamp (seconds)</span>
            <span class="hljs-attr">ttl</span>: <span class="hljs-number">300</span>, <span class="hljs-comment">// Expiration time</span>
            <span class="hljs-attr">public_key</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">publicKey</span>,
            <span class="hljs-attr">location</span>: location
        };
        <span class="hljs-comment">// Step 2: Sort keys and construct the string for signature</span>
        <span class="hljs-comment">// "key=value" joined by "&amp;", sorted by key</span>
        <span class="hljs-keyword">const</span> sortedKeys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(params).<span class="hljs-title function_">sort</span>();
        <span class="hljs-keyword">const</span> str = sortedKeys.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${key}</span>=<span class="hljs-subst">${params[key]}</span>`</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">'&amp;'</span>);
        <span class="hljs-comment">// Step 3: HMAC-SHA1 signature</span>
        <span class="hljs-keyword">const</span> signature = crypto
            .<span class="hljs-title function_">createHmac</span>(<span class="hljs-string">'sha1'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">secretKey</span>)
            .<span class="hljs-title function_">update</span>(str)
            .<span class="hljs-title function_">digest</span>(<span class="hljs-string">'base64'</span>);
        <span class="hljs-comment">// Step 4 &amp; 5: Add sig to params and encode for URL</span>
        <span class="hljs-comment">// querystring.encode will handle URL encoding of the signature and other params</span>
        params.<span class="hljs-property">sig</span> = signature;
        <span class="hljs-keyword">const</span> queryString = querystring.<span class="hljs-title function_">encode</span>(params);
        <span class="hljs-keyword">const</span> url = <span class="hljs-string">`<span class="hljs-subst">${API_URL}</span>weather/now.json?<span class="hljs-subst">${queryString}</span>`</span>;
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url);
            <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
        }
        <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Error making Seniverse request:"</span>, error);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }
}
</code></pre>
<p><code>src/core/index.ts</code></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">SeniverseApi</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./seniverse.js'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> seniverseApi = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SeniverseApi</span>(
  process.<span class="hljs-property">env</span>.<span class="hljs-property">SENIVERSE_PUBLIC_KEY</span> || <span class="hljs-string">''</span>,
  process.<span class="hljs-property">env</span>.<span class="hljs-property">SENIVERSE_SECRET_KEY</span> || <span class="hljs-string">''</span>,
);
</code></pre>
<h4 data-id="heading-10">æ­å»ºstreamable HTTPç±»å‹çš„MCP</h4>
<p>1.ä½¿ç”¨<code>express</code>æä¾›åç«¯æœåŠ¡ï¼Œç„¶åè®¾ç½®<code>/mcp</code> endpointï¼ˆä¸€èˆ¬æ¥è¯´MCP clienté»˜è®¤å°±æ˜¯è®¿é—®è¿™ä¸ªendpointï¼‰.
2.åœ¨MCPåè®®ä¸­ï¼Œæ¡æ‰‹/å·¥å…·è°ƒç”¨ç­‰éƒ½æ˜¯é€šè¿‡è¿™ä¸ªä¸€ä¸ªendpointæ¥å®Œæˆçš„ã€‚</p>
<p>3.å°è£…é€»è¾‘
å°è£…äº†ä¸€ä¸ª<code>MyServer</code>ç±»</p>
<ul>
<li><code>run</code>æ–¹æ³•å¯åŠ¨HTTPæœåŠ¡</li>
<li><code>init</code>æ–¹æ³•æ³¨å†Œå·¥å…·</li>
</ul>
<p>4.æ ¸å¿ƒæ˜¯<code>McpServer</code>å’Œ<code>StreamableHTTPServerTransport</code>ä¸¤ä¸ªAPI</p>
<ul>
<li><code>McpServer</code>ï¼š è´Ÿè´£æ³¨å†Œtool.</li>
<li><code>StreamableHTTPServerTransport</code>ï¼š æ¥ç®¡äº†<code>/mcp</code> endpointçš„é€šä¿¡é€»è¾‘</li>
</ul>
<pre><code class="hljs language-json" lang="json">import <span class="hljs-punctuation">{</span> McpServer <span class="hljs-punctuation">}</span> from <span class="hljs-string">"@modelcontextprotocol/sdk/server/mcp.js"</span>;
import <span class="hljs-punctuation">{</span> StreamableHTTPServerTransport <span class="hljs-punctuation">}</span> from <span class="hljs-string">"@modelcontextprotocol/sdk/server/streamableHttp.js"</span>;
import express from <span class="hljs-string">"express"</span>;
import <span class="hljs-punctuation">{</span> z <span class="hljs-punctuation">}</span> from <span class="hljs-string">"zod"</span>;
import <span class="hljs-string">"dotenv/config"</span>;
import <span class="hljs-punctuation">{</span> seniverseApi <span class="hljs-punctuation">}</span> from <span class="hljs-string">"./core/index.js"</span>;

export class MyServer <span class="hljs-punctuation">{</span>
  private mcpServer<span class="hljs-punctuation">:</span> McpServer;
  private app<span class="hljs-punctuation">:</span> express.Express
  constructor() <span class="hljs-punctuation">{</span>
    this.mcpServer = new McpServer(<span class="hljs-punctuation">{</span>
      name<span class="hljs-punctuation">:</span> <span class="hljs-string">"weather"</span><span class="hljs-punctuation">,</span>
      version<span class="hljs-punctuation">:</span> <span class="hljs-string">"0.0.1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">}</span>);

    <span class="hljs-comment">// Set up Express and HTTP transport</span>
    this.app = express();
    this.app.use(express.json());

    this.app.use('/mcp'<span class="hljs-punctuation">,</span> async (req<span class="hljs-punctuation">:</span> express.Request<span class="hljs-punctuation">,</span> res<span class="hljs-punctuation">:</span> express.Response) =&gt; <span class="hljs-punctuation">{</span>
        <span class="hljs-comment">// Create a new transport for each request to prevent request ID collisions</span>
        const transport = new StreamableHTTPServerTransport(<span class="hljs-punctuation">{</span>
            sessionIdGenerator<span class="hljs-punctuation">:</span> undefined<span class="hljs-punctuation">,</span>
            enableJsonResponse<span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
        <span class="hljs-punctuation">}</span>);

        res.on('close'<span class="hljs-punctuation">,</span> () =&gt; <span class="hljs-punctuation">{</span>
            transport.close();
        <span class="hljs-punctuation">}</span>);

        await this.mcpServer.connect(transport);
        await transport.handleRequest(req<span class="hljs-punctuation">,</span> res<span class="hljs-punctuation">,</span> req.body);
    <span class="hljs-punctuation">}</span>);

  <span class="hljs-punctuation">}</span>

  <span class="hljs-comment">/**
   * åœ¨ç«¯å£è¿è¡ŒServer, é€šè¿‡HTTP streamä¼ è¾“æ•°æ®
   */</span>
  async run()<span class="hljs-punctuation">:</span> Promise&lt;void&gt; <span class="hljs-punctuation">{</span>
    const port = parseInt(process.env.PORT || '<span class="hljs-number">3000</span>');
    this.app.listen(port<span class="hljs-punctuation">,</span> () =&gt; <span class="hljs-punctuation">{</span>
        console.log(`Demo MCP Server running on http<span class="hljs-punctuation">:</span><span class="hljs-comment">//localhost:${port}/mcp`);</span>
    <span class="hljs-punctuation">}</span>).on('error'<span class="hljs-punctuation">,</span> error =&gt; <span class="hljs-punctuation">{</span>
        console.error('Server error<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> error);
        process.exit(<span class="hljs-number">1</span>);
    <span class="hljs-punctuation">}</span>);
    
  <span class="hljs-punctuation">}</span>

  <span class="hljs-comment">/**
   * åˆå§‹åŒ–ï¼Œæ³¨å†Œå·¥å…·
   */</span>
  async init()<span class="hljs-punctuation">:</span> Promise&lt;void&gt; <span class="hljs-punctuation">{</span>
    <span class="hljs-comment">// Register weather tool</span>
    this.mcpServer.registerTool(
      <span class="hljs-string">"get_weather_now"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        title<span class="hljs-punctuation">:</span> <span class="hljs-string">"Get Weather Now"</span><span class="hljs-punctuation">,</span>
        description<span class="hljs-punctuation">:</span> <span class="hljs-string">"Get current weather for a location (city name)"</span><span class="hljs-punctuation">,</span>
        inputSchema<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          location<span class="hljs-punctuation">:</span> z.string().describe(<span class="hljs-string">"Location name or city (e.g. beijing, shanghai, new york, tokyo)"</span>)
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      async (<span class="hljs-punctuation">{</span> location <span class="hljs-punctuation">}</span>) =&gt; <span class="hljs-punctuation">{</span>
        
        const weatherData = await seniverseApi.getWeatherNow(location);
        if (!weatherData || !weatherData.results || weatherData.results.length === <span class="hljs-number">0</span>) <span class="hljs-punctuation">{</span>
          return <span class="hljs-punctuation">{</span>
            content<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
              <span class="hljs-punctuation">{</span>
                type<span class="hljs-punctuation">:</span> <span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span>
                text<span class="hljs-punctuation">:</span> `Failed to retrieve weather data for location<span class="hljs-punctuation">:</span> $<span class="hljs-punctuation">{</span>location<span class="hljs-punctuation">}</span>. Please check the location name and try again.`<span class="hljs-punctuation">,</span>
              <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-punctuation">}</span>;
        <span class="hljs-punctuation">}</span>

        const result = weatherData.results<span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-punctuation">]</span>;
        const weatherText = `Weather for $<span class="hljs-punctuation">{</span>result.location.name<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> $<span class="hljs-punctuation">{</span>result.location.country<span class="hljs-punctuation">}</span><span class="hljs-punctuation">:</span>\n` +
                            `Condition<span class="hljs-punctuation">:</span> $<span class="hljs-punctuation">{</span>result.now.text<span class="hljs-punctuation">}</span>\n` +
                            `Temperature<span class="hljs-punctuation">:</span> $<span class="hljs-punctuation">{</span>result.now.temperature<span class="hljs-punctuation">}</span>Â°C\n` +
                            `Last Update<span class="hljs-punctuation">:</span> $<span class="hljs-punctuation">{</span>result.last_update<span class="hljs-punctuation">}</span>`;
        return <span class="hljs-punctuation">{</span>
          content<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
              type<span class="hljs-punctuation">:</span> <span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span>
              text<span class="hljs-punctuation">:</span> weatherText<span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
          <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">}</span>;
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    );
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c1dc8ceb9ec40ed88b23abbcf3cbe8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764920520&amp;x-signature=kB563xB3UNi%2FYV8vgmILjmPnIto%3D" alt="image.png" loading="lazy"/></p>
<p>æ³¨æ„å·¦ä¾§ä¾§è¾¹æ ï¼š</p>
<ul>
<li>Transport Typeé€‰æ‹©<code>Streamable HTTP</code></li>
<li>URL å¡«å†™ä½ çš„express æœåŠ¡åœ°å€å’Œendpointã€‚</li>
</ul>
<h2 data-id="heading-11">stdio</h2>
<h3 data-id="heading-12">åŸç†åˆ†æ</h3>
<p>æˆ‘åœ¨é¡¹ç›®ä¸­ï¼Œé€šè¿‡ç›‘å¬<code>process.stdin</code>ï¼ŒæŸ¥çœ‹é€šä¿¡Message</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ç›‘å¬ stdin è¾“å…¥ï¼Œå¯ä»¥åœ¨inspectoré¢æ¿çš„"notifications/message"ä¸­çœ‹åˆ°ï¼ˆä½œä¸ºdebugç”¨ï¼‰</span>
    process.<span class="hljs-property">stdin</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"data"</span>, <span class="hljs-keyword">async</span> (data) =&gt; {
      <span class="hljs-keyword">const</span> input = data.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">trim</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(input);
    });
</code></pre>
<p>é€šè¿‡<code>mcp-inspector</code>å·¥å…·å°±å¯ä»¥è§‚å¯Ÿåˆ°é€šä¿¡ä¿¡æ¯äº†ï¼Œå¾€ä¸‹çœ‹ğŸ‘</p>
<p><code>tools/list</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03c3662dbeca4b2497d2dc409e1f4800~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764920520&amp;x-signature=HweaG98Bbk0GCpR7RcUfYAeHdMo%3D" alt="image.png" loading="lazy"/></p>
<p><code>tools/call</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a76cddae7bc241f1b5962cec39dbefb8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764920520&amp;x-signature=FfQgmUV4ZGHcPKaZh9rejWYagq4%3D" alt="image.png" loading="lazy"/></p>
<p>ç»“åˆå®˜ç½‘çš„<code>stdio</code>é€šä¿¡åŸç†å›¾</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa8e88a4187e40d083e70a067b8aef40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764920520&amp;x-signature=ZFWgTteVrgQu2A6u%2FY3ZcYGAjMY%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ul>
<li>è¿æ¥ä¸€ä¸ªstdio MCPæœåŠ¡ï¼Œä¸åŒäºstreamable HTTP MCPæœåŠ¡éœ€è¦è¿›è¡Œã€Œæ¡æ‰‹ã€ï¼Œåªè¦å¼€å¯ä¸€ä¸ªå­è¿›ç¨‹ï¼ˆsubprocessï¼‰ï¼Œå°±è¡¨ç¤ºè¿æ¥æˆåŠŸã€‚</li>
<li>åç»­çš„é€šä¿¡çš„ä¿¡æ¯æ ¼å¼éµå¾ª<code>json-rpc:2.0</code>ï¼Œé€šè¿‡è¯»å†™<code>process.stdin</code>å’Œ<code>process.stdout</code>å®Œæˆé€šä¿¡ã€‚</li>
</ul>
<h3 data-id="heading-13">ä»£ç å®æˆ˜ - ç»Ÿè®¡æ–‡ä»¶æ•°</h3>
<p>æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„è¿™ç¯‡åšå®¢ <a href="https://juejin.cn/post/7576482238461001770" target="_blank" title="https://juejin.cn/post/7576482238461001770">Nodeå†™MCPå…¥é—¨æ•™ç¨‹</a>ï¼ŒåŸºäº<code>StdioServerTransport</code>å®ç°çš„ç»Ÿè®¡ç›®å½•ä¸‹æ–‡ä»¶å¤¹çš„MCP Serverï¼Œå¹¶ä¸”ä»‹ç»äº†<code>mcp inspector</code>çš„è°ƒè¯•å’ŒTraeå®‰è£…ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-14">åˆ›å»ºMCPé¡¹ç›®çš„è„šæ‰‹æ¶</h2>
<p>æ¯æ¬¡å†™ä¸ªæ–°MCP Serveréƒ½è¦æ­å»ºé¡¹ç›®æ¨¡æ¿ï¼Œè¿™ç§é‡å¤çš„å·¥ä½œå½“ç„¶è¯¥åšæˆå·¥å…·è¾£ï¼
æˆ‘è‡ªå·±å†™äº†ä¸€ä¸ª<code>create-mcp</code>è„šæ‰‹æ¶ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffkcaikengren%2Fcreate-mcp" target="_blank" title="https://github.com/fkcaikengren/create-mcp" ref="nofollow noopener noreferrer">Github</a>ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2F%40caikengren-cli%2Fcreate-mcp" target="_blank" title="https://www.npmjs.com/package/@caikengren-cli/create-mcp" ref="nofollow noopener noreferrer">create-mcp</a> cliå·¥å…·å·²ç»å‘å¸ƒåœ¨npmä¸Šäº†ï¼Œå¯ä»¥npmå®‰è£…ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-15">cli åŸç†</h3>
<p>1.è„šæ‰‹æ¶åŸç†ï¼Œé¦–å…ˆå‡†å¤‡ä¸¤ä¸ªæ¨¡æ¿é¡¹ç›®</p>
<ul>
<li><code>template-stdio</code> æ¨¡æ¿</li>
<li><code>template-streamable</code> æ¨¡æ¿</li>
</ul>
<p>2.ç„¶åç”¨Nodeå†™ä¸€ä¸ªcliå·¥å…·ï¼Œä½¿ç”¨äº†ä»¥ä¸‹ä¾èµ–ï¼Œé€šè¿‡å‘½ä»¤è¡Œäº¤äº’çš„æ–¹å¼åˆ›å»ºé¡¹ç›®</p>
<pre><code class="hljs language-bash" lang="bash">pnpm i minimist prompts fs-extra chalk
</code></pre>
<p>3.æ ¹æ®ä½ é€‰æ‹©çš„é¡¹ç›®åç§°å’Œæ¨¡æ¿ï¼Œå¸®ä½ æ‹·è´æ¨¡æ¿ï¼Œä¿®æ”¹ä¸ºä½ çš„ã€Œé¡¹ç›®åç§°ã€</p>
<p>è§‰å¾—è¿™ä¸ªclié¡¹ç›®ä¸é”™çš„è¯ï¼Œç»™ä¸ªå…è´¹çš„starå§~  ğŸ‘‰  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffkcaikengren%2Fcreate-mcp" target="_blank" title="https://github.com/fkcaikengren/create-mcp" ref="nofollow noopener noreferrer">Github</a></p>
<h3 data-id="heading-16">ä½¿ç”¨ cli</h3>
<p>ä½¿ç”¨<code>@caikengren-cli/create-mcp</code>åˆ›å»ºé¡¹ç›®</p>
<pre><code class="hljs language-bash" lang="bash">npx @caikengren-cli/create-mcp
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10a36b6fd13f411da881200c3d5aabeb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764920520&amp;x-signature=P90Jfb0v9dheVQkHCeWYnEeDkNM%3D" alt="image.png" loading="lazy"/></p>
<p>ç„¶åä¾æ¬¡åˆ†åˆ«è¿è¡Œä¸‹é¢ä¸¤ä¸ªå‘½ä»¤</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¯‘ts/è¿è¡Œnode</span>
pnpm dev

<span class="hljs-comment"># æ‰“å¼€ mcp-inspectorå·¥å…·è°ƒè¯•</span>
pnpm inspect
</code></pre>
<h2 data-id="heading-17">å‚è€ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2Fspecification%2F2025-11-25" target="_blank" title="https://modelcontextprotocol.io/specification/2025-11-25" ref="nofollow noopener noreferrer">mcpå®˜ç½‘</a><br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.info%2Fzh-tw%2F" target="_blank" title="https://modelcontextprotocol.info/zh-tw/" ref="nofollow noopener noreferrer">mcpä¸­æ–‡ç½‘</a><br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelcontextprotocol%2Ftypescript-sdk" target="_blank" title="https://github.com/modelcontextprotocol/typescript-sdk" ref="nofollow noopener noreferrer">mcp: typescript-sdk</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸæ¥Webpackåœ¨å¤§å‚ä¸­è¿™æ ·è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼]]></title>    <link>https://juejin.cn/post/7577356848337764387</link>    <guid>https://juejin.cn/post/7577356848337764387</guid>    <pubDate>2025-11-28T07:46:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577356848337764387" data-draft-id="7577417823341985827" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸæ¥Webpackåœ¨å¤§å‚ä¸­è¿™æ ·è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-11-28T07:46:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç§€ç§€ä¸åªä¼šå‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/1410009035452887"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸæ¥Webpackåœ¨å¤§å‚ä¸­è¿™æ ·è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1410009035452887/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç§€ç§€ä¸åªä¼šå‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:46:17.000Z" title="Fri Nov 28 2025 07:46:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ</h2>
<p>ä¼˜åŒ–åˆ†ç±»ï¼š</p>
<ol>
<li>ä¼˜åŒ–æ‰“åŒ…åçš„ç»“æœï¼ˆåˆ†åŒ…ã€å‡å°åŒ…ä½“ç§¯ã€CDN æœåŠ¡å™¨ï¼‰ ==&gt; æ›´é‡è¦</li>
<li>ä¼˜åŒ–æ‰“åŒ…é€Ÿåº¦ï¼ˆexcludeã€cache-loaderï¼‰</li>
</ol>
<h3 data-id="heading-1">ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰</h3>
<h4 data-id="heading-2">ä¸€ã€ä¸»è¦ç›®çš„</h4>
<ul>
<li>â€‹<strong>å‡å°‘é¦–å±åŠ è½½ä½“ç§¯</strong>â€‹ï¼šé¿å…ä¸€æ¬¡æ€§åŠ è½½å…¨éƒ¨ä»£ç </li>
<li>â€‹<strong>åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜</strong>â€‹ï¼šç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Reactã€Lodashï¼‰å˜åŠ¨å°‘ï¼Œå¯å•ç‹¬ç¼“å­˜</li>
<li>â€‹<strong>æŒ‰éœ€åŠ è½½/å¹¶è¡Œè¯·æ±‚</strong>â€‹ï¼šè·¯ç”±ã€ç»„ä»¶ã€åŠŸèƒ½æ¨¡å—åªåœ¨éœ€è¦æ—¶åŠ è½½ï¼ˆæŒ‰éœ€åŠ è½½æˆ–è€…å¹¶è¡ŒåŠ è½½æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰ä»£ç ï¼‰</li>
</ul>
<h4 data-id="heading-3">äºŒã€ä¸‰ç§ä¸»è¦çš„ä»£ç åˆ†å‰²æ–¹å¼</h4>
<h5 data-id="heading-4">1. <strong>å…¥å£èµ·ç‚¹ï¼ˆEntry Pointsï¼‰æ‰‹åŠ¨åˆ†å‰²</strong></h5>
<p>é€šè¿‡é…ç½®å¤šä¸ª entry å®ç°ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">entry</span>: {
    <span class="hljs-attr">main</span>: <span class="hljs-string">'./src/main.js'</span>,
    <span class="hljs-attr">vendor</span>: <span class="hljs-string">'./src/vendor.js'</span>, <span class="hljs-comment">// æ‰‹åŠ¨å¼•å…¥å…¬å…±ä¾èµ–</span>
  },
  <span class="hljs-attr">output</span>: {
    <span class="hljs-attr">filename</span>: <span class="hljs-string">'[name].[contenthash].js'</span>,
    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'dist'</span>),
  },
};
</code></pre>
<blockquote>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>æ— æ³•è‡ªåŠ¨æå–å…¬å…±ä¾èµ–ï¼ˆæ¯”å¦‚ <code>main</code> å’Œ <code>vendor</code> éƒ½ç”¨äº† Lodashï¼Œä¼šé‡å¤æ‰“åŒ…ï¼‰</li>
<li>ç»´æŠ¤æˆæœ¬é«˜</li>
</ul>
</blockquote>
<p>ä¸Šé¢å†™çš„æ˜¯é€šç”¨é…ç½®ï¼Œä½†æˆ‘ä»¬åœ¨å…¬å¸ä¸€èˆ¬ä¼šåˆ†åˆ«é…ç½®å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒçš„é…ç½®ã€‚å¤§å¤šæ•°é¡¹ç›®ä¸­ï¼Œ<code>entry</code> åœ¨ dev å’Œ prod åŸºæœ¬ä¸€è‡´ï¼Œæ— éœ€å·®å¼‚åŒ–é…ç½®ã€‚å·®å¼‚ä¸»è¦ä½“ç°åœ¨ <code>output</code> å’Œå…¶ä»–æ’ä»¶/åŠ è½½å™¨è¡Œä¸ºä¸Šã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-comment">// webpack.config.prod.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  mode: <span class="hljs-string">'production'</span>,
  entry: <span class="hljs-string">'./src/index.js'</span>,
  output: {
    filename: <span class="hljs-string">'js/[name].[contenthash:8].js'</span>, <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒç”¨ [contenthash]ï¼ˆè€Œé [hash] æˆ– [chunkhash]ï¼‰ï¼Œç¡®ä¿ç²¾å‡†ç¼“å­˜</span>
    chunkFilename: <span class="hljs-string">'js/[name].[contenthash:8].js'</span>,
    path: path.resolve(__dirname, <span class="hljs-string">'dist'</span>), <span class="hljs-comment">// å¿…é¡»è¾“å‡ºåˆ°ç£ç›˜ç”¨äºéƒ¨ç½²</span>
    publicPath: <span class="hljs-string">'/static/'</span>, <span class="hljs-comment">// ç”¨äº CDN æˆ–é™æ€èµ„æºæœåŠ¡å™¨</span>
    clean: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ¸…ç†æ—§æ–‡ä»¶</span>
  },
};
<span class="hljs-comment">// webpack.config.dev.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  mode: <span class="hljs-string">'development'</span>,
  entry: <span class="hljs-string">'./src/index.js'</span>,
  output: {
    filename: <span class="hljs-string">'js/[name].js'</span>,  <span class="hljs-comment">// å¼€å‘ç¯å¢ƒè‹¥åŠ  hashï¼Œæ¯æ¬¡ä¿å­˜éƒ½ä¼šç”Ÿæˆæ–°æ–‡ä»¶ï¼Œå¯èƒ½å¹²æ‰°çƒ­æ›´æ–°æˆ–è€…devtoolsæ··ä¹±</span>
    chunkFilename: <span class="hljs-string">'js/[name].js'</span>,
    path: path.resolve(__dirname, <span class="hljs-string">'dist'</span>), <span class="hljs-comment">// é€šå¸¸ä»å†™ distï¼Œä½†å®é™…ä¸å†™å…¥ç£ç›˜ï¼ˆwebpack-dev-server é»˜è®¤å†…å­˜å­˜å‚¨ï¼‰ï¼ŒèŠ‚çœIOï¼Œæé«˜ç¼–è¯‘é€Ÿåº¦</span>
    publicPath: <span class="hljs-string">'/'</span>, <span class="hljs-comment">// ä¸ devServer ä¸€è‡´</span>
    <span class="hljs-comment">// clean: false (é»˜è®¤)</span>
  },
};
</code></pre>
<h5 data-id="heading-5">2. <strong>SplitChunksPluginï¼ˆæ¨èï¼è‡ªåŠ¨ä»£ç åˆ†å‰²ï¼‰</strong></h5>
<p>è‡ªåŠ¨æå–å…¬å…±æ¨¡å—å’Œç¬¬ä¸‰æ–¹åº“ã€‚webpack å·²é»˜è®¤å®‰è£…ç›¸å…³æ’ä»¶ã€‚</p>
<p>é»˜è®¤è¡Œä¸ºï¼ˆä»…åœ¨ production æ¨¡å¼ç”Ÿæ•ˆï¼‰ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">optimization</span>: {
    <span class="hljs-attr">splitChunks</span>: {
      <span class="hljs-attr">chunks</span>: <span class="hljs-string">'async'</span>, <span class="hljs-comment">// é»˜è®¤åªåˆ†å‰²å¼‚æ­¥æ¨¡å—</span>
    },
  },
};
</code></pre>
<p>å¸¸ç”¨é…ç½®ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// webpack.config.prod.js</span>
<span class="hljs-attr">optimization</span>: { 
  <span class="hljs-comment">// è‡ªåŠ¨åˆ†å‰²</span>
â€‹  â€‹<span class="hljs-comment">// https://twitter.com/wSokra/status/969633336732905474</span>
  <span class="hljs-comment">// https://medium.com/webpack/webpack-4-code-splitting-chunk-graph-and-the-splitchunks-optimization-be739a861366    </span>
  <span class="hljs-attr">splitChunks</span>: {
    <span class="hljs-comment">// chunks: async | initial(å¯¹é€šè¿‡çš„ä»£ç å¤„ç†) | all(åŒæ­¥+å¼‚æ­¥éƒ½å¤„ç†)</span>
    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'initial'</span>,
    <span class="hljs-attr">minSize</span>: <span class="hljs-number">20000</span>, <span class="hljs-comment">// æ¨¡å—å¤§äº 20KB æ‰åˆ†å‰²ï¼ˆWebpack 5 é»˜è®¤å€¼ï¼‰</span>
    <span class="hljs-attr">maxSize</span>: <span class="hljs-number">244000</span>, <span class="hljs-comment">// å•ä¸ª chunk æœ€å¤§ä¸è¶…è¿‡ 244KBï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-attr">cacheGroups</span>: { <span class="hljs-comment">// æ‹†åˆ†åˆ†ç»„è§„åˆ™</span>
      <span class="hljs-comment">// æå– node_modules ä¸­çš„ç¬¬ä¸‰æ–¹åº“</span>
      <span class="hljs-attr">vendor</span>: {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>, <span class="hljs-comment">// åŒ¹é…ç¬¦åˆè§„åˆ™çš„åŒ…</span>
        <span class="hljs-attr">name</span>: <span class="hljs-string">'vendors'</span>, <span class="hljs-comment">// æ‹†åˆ†åŒ…çš„name å±æ€§</span>
        <span class="hljs-attr">chunks</span>: <span class="hljs-string">'initial'</span>,
        <span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>, <span class="hljs-comment">// ä¼˜å…ˆçº§é«˜äº default</span>
        <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>,
      },
      <span class="hljs-comment">// æå–å¤šä¸ª chunk å…¬å…±ä»£ç </span>
      <span class="hljs-attr">default</span>: {
        <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// è‡³å°‘è¢« 2 ä¸ª chunk å¼•ç”¨</span>
        <span class="hljs-attr">priority</span>: -<span class="hljs-number">20</span>,
        <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¤ç”¨å·²å­˜åœ¨çš„ chunk</span>
        <span class="hljs-attr">maxInitialRequests</span>: <span class="hljs-number">5</span>, <span class="hljs-comment">// é»˜è®¤é™åˆ¶å¤ªå°ï¼Œæ— æ³•æ˜¾ç¤ºæ•ˆæœ</span>
        <span class="hljs-attr">minSize</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// è¿™ä¸ªç¤ºä¾‹å¤ªå°ï¼Œæ— æ³•åˆ›å»ºå…¬å…±å—</span>
      },
    },
  },
  <span class="hljs-comment">// runtimeç›¸å…³çš„ä»£ç æ˜¯å¦æŠ½å–åˆ°ä¸€ä¸ªå•ç‹¬çš„chunkä¸­ï¼Œæ¯”å¦‚importåŠ¨æ€åŠ è½½çš„ä»£ç å°±æ˜¯é€šè¿‡runtime ä»£ç å®Œæˆçš„</span>
  <span class="hljs-comment">// æŠ½ç¦»å‡ºæ¥åˆ©äºæµè§ˆå™¨ç¼“å­˜ï¼Œæ¯”å¦‚ä¿®æ”¹äº†ä¸šåŠ¡ä»£ç ï¼Œé‚£ä¹ˆruntimeåŠ è½½çš„chunkæ— éœ€é‡æ–°åŠ è½½</span>
  <span class="hljs-attr">runtimeChunk</span>: <span class="hljs-literal">true</span>,
}
</code></pre>
<p>åœ¨å¼€å‘ç¯å¢ƒä¸‹ <code>splitChunks: false,</code> å³å¯ã€‚</p>
<blockquote>
<p>ç”Ÿäº§ç¯å¢ƒï¼š</p>
<ul>
<li>ç”Ÿæˆ <code>vendors.xxxx.js</code>ï¼ˆç¬¬ä¸‰æ–¹åº“ï¼‰</li>
<li>ç”Ÿæˆ <code>default.xxxx.js</code>ï¼ˆé¡¹ç›®å…¬å…±ä»£ç ï¼‰</li>
<li>ä¸» bundle ä½“ç§¯æ˜¾è‘—å‡å°</li>
</ul>
</blockquote>
<h5 data-id="heading-6">3. <strong>åŠ¨æ€å¯¼å…¥ï¼ˆDynamic Importsï¼‰â€”â€” æŒ‰éœ€åŠ è½½</strong></h5>
<p>ä½¿ç”¨ <code>import()</code> è¯­æ³•ï¼ˆç¬¦åˆ ES Module è§„èŒƒï¼‰ï¼Œå®ç°æ‡’åŠ è½½ã€‚</p>
<blockquote>
<p>Webpack ä¼šä¸ºæ¯ä¸ª <code>import()</code> åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ chunkï¼Œå¹¶è‡ªåŠ¨å¤„ç†åŠ è½½é€»è¾‘ã€‚</p>
</blockquote>
<h4 data-id="heading-7">ä¸‰ã€é­”æ³•æ³¨é‡Šï¼ˆMagic Commentsï¼‰â€”â€” æ§åˆ¶ chunk åç§°ç­‰è¡Œä¸º</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// è‡ªå®šä¹‰ chunk åç§°ï¼ˆä¾¿äºè°ƒè¯•å’Œé•¿æœŸç¼“å­˜ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(
  <span class="hljs-comment">/* webpackChunkName: "my-module" */</span>
  <span class="hljs-string">'./my-module'</span>
);
</code></pre>
<p>å…¶ä»–å¸¸è§æ³¨é‡Šï¼š</p>
<ul>
<li><code>/* webpackPrefetch: true */</code>ï¼šç©ºé—²æ—¶é¢„åŠ è½½ï¼ˆæå‡åç»­è®¿é—®é€Ÿåº¦ï¼‰</li>
<li><code>/* webpackPreload: true */</code>ï¼šå½“å‰å¯¼èˆªå…³é”®èµ„æºé¢„åŠ è½½ï¼ˆæ…ç”¨ï¼‰</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// é¢„åŠ è½½â€œä¸‹ä¸€ä¸ªå¯èƒ½è®¿é—®â€çš„é¡µé¢</span>
<span class="hljs-keyword">import</span>(
  <span class="hljs-comment">/* webpackChunkName: "login-page" */</span>
  <span class="hljs-comment">/* webpackPrefetch: true */</span>
  <span class="hljs-string">'./LoginPage'</span>
);
</code></pre>
<p>è¯¦ç»†æ¯”è¾ƒï¼š</p>
<ul>
<li>preload chunk ä¼šåœ¨çˆ¶ chunk åŠ è½½æ—¶ï¼Œä»¥å¹¶è¡Œæ–¹å¼å¼€å§‹åŠ è½½ã€‚prefetch chunk ä¼šåœ¨çˆ¶ chunk åŠ è½½ç»“æŸåå¼€å§‹åŠ è½½ã€‚</li>
<li>preload chunk å…·æœ‰ä¸­ç­‰ä¼˜å…ˆçº§ï¼Œå¹¶ç«‹å³ä¸‹è½½ã€‚prefetch chunk åœ¨æµè§ˆå™¨é—²ç½®æ—¶ä¸‹è½½ã€‚</li>
</ul>
<h3 data-id="heading-8">CND</h3>
<p>å†…å®¹åˆ†å‘ç½‘ç»œï¼ˆContent Delivery Network æˆ– Content Distribution Networkï¼‰</p>
<p>å®ƒæ˜¯æŒ‡é€šè¿‡ç›¸äº’è¿æ¥çš„ç½‘ç»œç³»ç»Ÿï¼Œåˆ©ç”¨æœ€é è¿‘æ¯ä¸ªç”¨æˆ·çš„æœåŠ¡å™¨ï¼›æ›´å¿«ã€æ›´å¯é åœ°å°†éŸ³ä¹ã€å›¾ç‰‡ã€è§†é¢‘ã€åº”ç”¨ç¨‹åºåŠå…¶ä»–æ–‡ä»¶å‘é€ç»™ç”¨æˆ·ï¼›æä¾›é«˜æ€§èƒ½ã€å¯æ‰©å±•æ€§åŠä½æˆæœ¬çš„ç½‘ç»œå†…å®¹ä¼ é€’ã€‚</p>
<p>å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ CDN çš„ä¸»è¦æ–¹å¼æœ‰ä¸¤ç§ï¼š</p>
<ol>
<li>æ‰“åŒ…æ‰€æœ‰é™æ€èµ„æºï¼Œæ”¾åˆ° CDN æœåŠ¡å™¨ï¼Œç”¨æˆ·æ‰€æœ‰èµ„æºéƒ½æ˜¯é€šè¿‡ CND æœåŠ¡å™¨åŠ è½½çš„
<ol>
<li>é€šè¿‡ <code>output.publicPath</code> æ”¹ä¸ºè‡ªå·±çš„çš„ CDN æœåŠ¡å™¨ï¼Œæ‰“åŒ…åå°±å¯ä»¥ä»ä¸Šé¢è·å–èµ„æº</li>
<li>å¦‚æœæ˜¯è‡ªå·±çš„è¯ï¼Œä¸€èˆ¬ä¼šä»é˜¿é‡Œã€è…¾è®¯ç­‰ä¹° CDN æœåŠ¡å™¨ã€‚</li>
</ol>
</li>
<li>ä¸€äº›ç¬¬ä¸‰æ–¹èµ„æºæ”¾åœ¨ CDN æœåŠ¡å™¨ä¸Š
<ol>
<li>ä¸€äº›åº“/æ¡†æ¶ä¼šå°†æ‰“åŒ…åçš„æºç æ”¾åˆ°ä¸€äº›å…è´¹çš„ CDN ä¸Šï¼Œæ¯”å¦‚ JSDeliverã€bootcdn ç­‰</li>
<li>è¿™æ ·çš„è¯ï¼Œæ‰“åŒ…çš„æ—¶å€™å°±ä¸éœ€è¦å¯¹è¿™äº›åº“è¿›è¡Œæ‰“åŒ…ï¼Œç›´æ¥ä½¿ç”¨ CDN æœåŠ¡å™¨ä¸­çš„æºç ï¼ˆé€šè¿‡ externals é…ç½®æ’é™¤æŸäº›åŒ…ï¼‰</li>
</ol>
</li>
</ol>
<h3 data-id="heading-9">CSS æå–</h3>
<p>å°† css æå–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ css æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-Plain" lang="Plain">npm install mini-css-extract-plugin -D
</code></pre>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// webpack.config.prod.js</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mini-css-extract-plugin'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">mode</span>: <span class="hljs-string">'production'</span>,
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">rules</span>: [
      <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨ MiniCssExtractPlugin.loader</span>
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/i</span>,
        <span class="hljs-attr">use</span>: [
          <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>, <span class="hljs-comment">// æ›¿æ¢ style-loader</span>
          <span class="hljs-string">'css-loader'</span>,
          <span class="hljs-string">'postcss-loader'</span>,
        ],
      },
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/i</span>,
        <span class="hljs-attr">use</span>: [
          <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,
          <span class="hljs-string">'css-loader'</span>,
          <span class="hljs-string">'postcss-loader'</span>,
          <span class="hljs-string">'sass-loader'</span>,
        ],
      },
    ],
  },
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>({
      <span class="hljs-attr">filename</span>: <span class="hljs-string">'css/[name].[contenthash:8].css'</span>,
      <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">'css/[name].[contenthash:8].css'</span>,
    }),
  ],
};
</code></pre>
<h3 data-id="heading-10">Terser ä»£ç å‹ç¼©</h3>
<p>Terser å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‹ç¼©ã€ä¸‘åŒ–(æ··æ·†)æˆ‘ä»¬çš„ä»£ç ï¼Œè®©æˆ‘ä»¬çš„ bundle å˜å¾—æ›´å°ã€‚</p>
<blockquote>
<p>Terser æ˜¯ä¸€ä¸ªå•ç‹¬çš„å·¥å…·ï¼Œæ‹¥æœ‰éå¸¸å¤šçš„é…ç½®ï¼Œè¿™é‡Œæˆ‘ä»¬åªè®²å·¥ä½œä¸­å¦‚ä½•ä½¿ç”¨ï¼Œä»¥ä¸€ä¸ªå·¥ç¨‹çš„è§’åº¦å­¦ä¹ è¿™ä¸ªå·¥å…·ã€‚</p>
</blockquote>
<p>çœŸå®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨çš„é€šè¿‡ terser æ¥å¤„ç†æˆ‘ä»¬çš„ä»£ç ã€‚webpack ä¸­ minimizer å±æ€§ï¼Œåœ¨ production æ¨¡å¼ä¸‹ï¼Œé»˜è®¤å°±æ˜¯ä½¿ç”¨çš„ TerserPlugin æ¥å¤„ç†æˆ‘ä»¬ä»£ç çš„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»º TerserPlugin å®ä¾‹è¦†ç›–é»˜è®¤é…ç½®ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// webpack.prod.js </span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'terser-webpack-plugin'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">mode</span>: <span class="hljs-string">'production'</span>,
  <span class="hljs-attr">optimization</span>: {
    <span class="hljs-attr">minimize</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">minimizer</span>: [
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>({
        <span class="hljs-attr">parallel</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¤šæ ¸ CPU å¹¶è¡Œå‹ç¼©ï¼Œé»˜è®¤ä¸ºtrueï¼Œå¹¶å‘æ•°é»˜è®¤ä¸ºos.cpus().length-1</span>
        <span class="hljs-attr">terserOptions</span>: {
          <span class="hljs-attr">compress</span>: { <span class="hljs-comment">// å‹ç¼©é…ç½®</span>
            <span class="hljs-attr">drop_console</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">drop_debugger</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// åˆ é™¤debugger</span>
            <span class="hljs-attr">pure_funcs</span>: [<span class="hljs-string">'console.info'</span>, <span class="hljs-string">'console.debug'</span>], <span class="hljs-comment">// åªåˆ é™¤ç‰¹å®šçš„å‡½æ•°è°ƒç”¨</span>
          },
          <span class="hljs-attr">mangle</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦ä¸‘åŒ–ä»£ç ï¼ˆå˜é‡ï¼‰</span>
          <span class="hljs-attr">toplevel</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// é¡¶å±‚å˜é‡æ˜¯å¦è¿›è¡Œè½¬æ¢</span>
          <span class="hljs-attr">keep_classnames</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦ä¿ç•™ç±»çš„åç§°</span>
          <span class="hljs-attr">keep_fnames</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦ä¿ç•™å‡½æ•°çš„åç§°</span>
          <span class="hljs-attr">format</span>: {
            <span class="hljs-attr">comments</span>: <span class="hljs-regexp">/@license|@preserve/i</span>, <span class="hljs-comment">// ä¿ç•™å« license/preserve çš„æ³¨é‡Šï¼ˆæŸäº›å¼€æºåº“è¦æ±‚ä¿ç•™ç‰ˆæƒæ³¨é‡Šï¼‰</span>
          },
        },
        <span class="hljs-attr">extractComments</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// é»˜è®¤ä¸ºtrueä¼šå°†æ³¨é‡Šæå–åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼ˆè¿™é‡Œç”¨äºä¿ç•™ç‰ˆæƒæ³¨é‡Šï¼‰ï¼Œfalseè¡¨ç¤ºä¸å¸Œæœ›ä¿ç•™æ³¨é‡Š</span>
        <span class="hljs-attr">sourceMap</span>: <span class="hljs-literal">true</span>,   <span class="hljs-comment">// éœ€è¦ webpack é…ç½® devtool ç”Ÿæˆ source map</span>
      }),
    ],
  },
};
</code></pre>
<blockquote>
<p>ä¸è¦åœ¨å¼€å‘ç¯å¢ƒå¯åŠ¨ terserï¼Œå› ä¸ºï¼š</p>
<ul>
<li>å‹ç¼©ä¼šæ‹–æ…¢æ„å»ºé€Ÿåº¦</li>
<li>æ··æ·†åçš„ä»£ç æ— æ³•è°ƒè¯•</li>
<li>hmr å’Œ source-map ä¼šå¤±æ•ˆ</li>
</ul>
</blockquote>
<h3 data-id="heading-11">CSS å‹ç¼©</h3>
<p>CSS å‹ç¼©é€šå¸¸æ˜¯å»é™¤æ— ç”¨çš„ç©ºæ ¼ç­‰ï¼Œå› ä¸ºå¾ˆéš¾å»ä¿®æ”¹é€‰æ‹©å™¨ã€å±æ€§çš„åç§°ã€å€¼ç­‰ï¼›æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨æ’ä»¶ <code>css-minimizer-webpack-plugin</code>ï¼›ä»–çš„åº•å±‚æ˜¯ä½¿ç”¨ cssnano å·¥å…·æ¥ä¼˜åŒ–ã€å‹ç¼© CSSï¼ˆä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼‰ã€‚</p>
<p>ä½¿ç”¨ä¹Ÿæ˜¯éå¸¸ç®€å•ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-attr">minimizer</span>: [
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMiniMizerPlugin</span>()({
    <span class="hljs-attr">parallel</span>: <span class="hljs-literal">true</span>
  })
]
</code></pre>
<h3 data-id="heading-12">Tree Shaking æ‘‡æ ‘</h3>
<p>è¯¦æƒ…è§ä¹‹å‰æ–‡ç« ï¼šã€Šç®€å•èŠèŠ webpack æ‘‡æ ‘çš„åŸç†ã€‹</p>
<h3 data-id="heading-13">HTTP å‹ç¼©</h3>
<p>HTTP å‹ç¼©ï¼ˆHTTP Compressionï¼‰æ˜¯ä¸€ç§ <strong>åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶å‡å°å“åº”ä½“ä½“ç§¯ â€‹</strong>çš„æŠ€æœ¯ï¼Œé€šè¿‡å‹ç¼© HTMLã€CSSã€JavaScriptã€JSON ç­‰æ–‡æœ¬èµ„æºï¼Œæ˜¾è‘—æå‡ç½‘é¡µåŠ è½½é€Ÿåº¦ã€èŠ‚çœå¸¦å®½ã€‚</p>
<h4 data-id="heading-14">ä¸€ã€ä¸»æµå‹ç¼©ç®—æ³•</h4>

































<table><thead><tr><th>ç®—æ³•</th><th>å…¼å®¹æ€§</th><th>å‹ç¼©ç‡</th><th>é€Ÿåº¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>gzip</strong></td><td>âœ… å‡ ä¹æ‰€æœ‰æµè§ˆå™¨ï¼ˆIE6+ï¼‰</td><td>é«˜</td><td>å¿«</td><td>â€‹<strong>æœ€å¹¿æ³›ä½¿ç”¨</strong>â€‹ï¼ŒWeb æ ‡å‡†æ¨è</td></tr><tr><td><strong>Brotli (br)</strong></td><td>âœ… ç°ä»£æµè§ˆå™¨ï¼ˆChrome 49+, Firefox 44+, Safari 11+ï¼‰</td><td>â­ æ›´é«˜ï¼ˆæ¯” gzip é«˜ 15%~30%ï¼‰</td><td>è¾ƒæ…¢ï¼ˆå‹ç¼©ï¼‰ï¼Œè§£å‹å¿«</td><td><strong>æ¨èç”¨äºé™æ€èµ„æº</strong></td></tr><tr><td><strong>deflate</strong></td><td>âš ï¸ æ”¯æŒä¸ä¸€è‡´ï¼ˆéƒ¨åˆ†æµè§ˆå™¨å®ç°æœ‰é—®é¢˜ï¼‰</td><td>ä¸­</td><td>ä¸­</td><td><strong>å·²åŸºæœ¬æ·˜æ±°ï¼Œä¸æ¨èä½¿ç”¨</strong></td></tr></tbody></table>
<h4 data-id="heading-15">äºŒã€å·¥ä½œåŸç†ï¼ˆåå•†å‹ç¼©ï¼‰</h4>
<p>HTTP å‹ç¼©åŸºäº è¯·æ±‚å¤´ â†” å“åº”å¤´åå•†æœºåˆ¶ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯è¯·æ±‚ï¼ˆè¡¨æ˜æ”¯æŒçš„å‹ç¼©æ ¼å¼ï¼‰</li>
</ol>
<pre><code class="hljs language-HTTP" lang="HTTP">GET /app.js HTTP/1.1
Host: example.com
Accept-Encoding: gzip, deflate, br // å®¢æˆ·ç«¯æ”¯æŒçš„å‹ç¼©ç®—æ³•åˆ—è¡¨
</code></pre>
<ol start="2">
<li>æœåŠ¡ç«¯å“åº”ï¼ˆè¿”å›å‹ç¼©åçš„å†…å®¹ï¼‰</li>
</ol>
<pre><code class="hljs language-HTTP" lang="HTTP">HTTP/1.1 200 OK
Content-Encoding: br  // æœåŠ¡ç«¯ä½¿ç”¨çš„å‹ç¼©ç®—æ³•
Content-Type: application/javascript
Content-Length: 102400  // æ³¨æ„ï¼šè¿™æ˜¯å‹ç¼©åçš„å¤§å°ï¼

...ï¼ˆäºŒè¿›åˆ¶å‹ç¼©æ•°æ®ï¼‰...
</code></pre>
<blockquote>
<ul>
<li>æµè§ˆå™¨è‡ªåŠ¨è§£å‹ï¼Œå¼€å‘è€…æ— æ„ŸçŸ¥</li>
</ul>
</blockquote>
<h4 data-id="heading-16">ä¸‰ã€å¦‚ä½•å¯ç”¨ HTTP å‹ç¼©ï¼Ÿ</h4>
<p>æˆ‘ä»¬ä¸€èˆ¬ä¼šä¼˜å…ˆä½¿ç”¨ Nginx é…ç½®åšå‹ç¼©ï¼ˆç”Ÿäº§ç¯å¢ƒæœ€å¸¸ç”¨ï¼‰ï¼Œè¿™æ ·å°±æ— éœ€åº”ç”¨å±‚å¤„ç†ã€‚</p>
<p><strong>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šè¿›è¡Œé¢„å‹ç¼© + é™æ€æ–‡ä»¶æœåŠ¡ï¼Œè¿™ä¸»è¦å°±æ˜¯ webpack è¦åšçš„å·¥ä½œã€‚</strong></p>
<p>åœ¨æ„å»ºé˜¶æ®µï¼ˆWebpack/Viteï¼‰å°±ç”Ÿæˆ <code>.gz</code> å’Œ <code>.br</code> æ–‡ä»¶ï¼Œéƒ¨ç½²åˆ° CDN æˆ–é™æ€æœåŠ¡å™¨ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">CompressionPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'compression-webpack-plugin'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-comment">// ç”Ÿæˆ .gz æ–‡ä»¶</span>
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompressionPlugin</span>({
      <span class="hljs-attr">algorithm</span>: <span class="hljs-string">'gzip'</span>,
      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(js|css|html|svg)$/</span>,
      <span class="hljs-attr">threshold</span>: <span class="hljs-number">8192</span>, <span class="hljs-comment">// å¤§äº 8KB æ‰å‹ç¼©</span>
      <span class="hljs-attr">minRatio</span>: <span class="hljs-number">0.8</span>,  <span class="hljs-comment">// è‡³å°‘çš„å‹ç¼©æ¯”ä¾‹</span>
    }),
    <span class="hljs-comment">// ç”Ÿæˆ .br æ–‡ä»¶ï¼ˆéœ€é¢å¤–å®‰è£…ï¼‰</span>
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompressionPlugin</span>({
      <span class="hljs-attr">algorithm</span>: <span class="hljs-string">'brotliCompress'</span>,
      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(js|css|html|svg)$/</span>,
      <span class="hljs-attr">compressionOptions</span>: { <span class="hljs-attr">level</span>: <span class="hljs-number">11</span> }, <span class="hljs-comment">// æœ€é«˜å‹ç¼©ç‡</span>
    }),
  ],
};
</code></pre>
<p>Nginx é…åˆé¢„å‹ç¼©æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-Nginx" lang="Nginx">gzip_static on;    # ä¼˜å…ˆè¿”å› .gz æ–‡ä»¶
brotli_static on;  # ä¼˜å…ˆè¿”å› .br æ–‡ä»¶
</code></pre>
<h3 data-id="heading-17">æ‰“åŒ…åˆ†æ</h3>
<h4 data-id="heading-18">æ‰“åŒ…æ—¶é—´åˆ†æ</h4>
<p>æˆ‘ä»¬éœ€è¦å€ŸåŠ©ä¸€ä¸ªæ’ä»¶ <code>speed-measure-webpack-plugin</code>ï¼Œå³å¯çœ‹åˆ°æ¯ä¸ª loaderã€æ¯ä¸ª plugin æ¶ˆè€—çš„æ‰“åŒ…æ—¶é—´ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-type">const</span> <span class="hljs-variable">SpeedMeasurePlugin</span> <span class="hljs-operator">=</span> require(<span class="hljs-string">'speed-measure-webpack-plugin'</span>);

<span class="hljs-type">const</span> <span class="hljs-variable">smp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SpeedMeasurePlugin</span>();

<span class="hljs-type">const</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> {
  <span class="hljs-comment">// ä½ çš„æ­£å¸¸ Webpack é…ç½®</span>
  entry: <span class="hljs-string">'./src/index.js'</span>,
  <span class="hljs-keyword">module</span>: { <span class="hljs-comment">/* ... */</span> },
  plugins: [ <span class="hljs-comment">/* ... */</span> ],
};

<span class="hljs-comment">// ä»…å½“ç¯å¢ƒå˜é‡ ANALYZE_SPEED=1 æ—¶åŒ…è£¹é…ç½®</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = process.env.ANALYZE_SPEED ? smp.wrap(config) : config;
</code></pre>
<h4 data-id="heading-19">æ‰“åŒ…æ–‡ä»¶åˆ†æ</h4>
<h5 data-id="heading-20">æ–¹æ³•ä¸€ã€ç”Ÿæˆ stats.json æ–‡ä»¶</h5>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-string">"build:stats"</span>: <span class="hljs-string">"w--config ./config/webpack.common.js --env production --profile --json=stats.json"</span>,
</code></pre>
<p>è¿è¡Œ <code>npm run build:stats</code>ï¼Œå¯ä»¥è·å–åˆ°ä¸€ä¸ª stats.json æ–‡ä»¶ï¼Œç„¶åæ”¾åˆ°åˆ° <a href="https://link.juejin.cn?target=http%3A%2F%2Fwebpack.github.com%2Fanalyse" target="_blank" title="http://webpack.github.com/analyse" ref="nofollow noopener noreferrer">webpack.github.com/analyse</a> è¿›è¡Œåˆ†æã€‚</p>
<h5 data-id="heading-21">æ–¹æ³•äºŒã€webpack-bundle-analyzer</h5>
<p>æ›´å¸¸ç”¨çš„æ–¹å¼æ˜¯ä½¿ç”¨ webpack-bundle-analyzer æ’ä»¶åˆ†æã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// webpack.prod.js</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">BundleAnalyzerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-bundle-analyzer'</span>).<span class="hljs-property">BundleAnalyzerPlugin</span>;

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">mode</span>: <span class="hljs-string">'production'</span>,
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-comment">// å…¶ä»–æ’ä»¶...</span>
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">BundleAnalyzerPlugin</span>({
      <span class="hljs-attr">analyzerMode</span>: <span class="hljs-string">'static'</span>, <span class="hljs-comment">// ç”Ÿæˆé™æ€ HTML æŠ¥å‘Šï¼ˆé»˜è®¤ï¼‰</span>
      <span class="hljs-attr">openAnalyzer</span>: <span class="hljs-literal">false</span>,    <span class="hljs-comment">// ä¸è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨</span>
      <span class="hljs-attr">reportFilename</span>: <span class="hljs-string">'bundle-report.html'</span>,
      <span class="hljs-attr">generateStatsFile</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¯é€‰ï¼šåŒæ—¶ç”Ÿæˆ stats.json</span>
      <span class="hljs-attr">statsFilename</span>: <span class="hljs-string">'stats.json'</span>,
    }),
  ],
};
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¼šè®®é€é•œï¼ˆMeeting Lensï¼‰ï¼šåŸºäº Rokid CXR-M çš„ AI ä¼šè®®çºªè¦å®æˆ˜]]></title>    <link>https://juejin.cn/post/7577461079597826067</link>    <guid>https://juejin.cn/post/7577461079597826067</guid>    <pubDate>2025-11-28T07:14:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577461079597826067" data-draft-id="7577394906161610806" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¼šè®®é€é•œï¼ˆMeeting Lensï¼‰ï¼šåŸºäº Rokid CXR-M çš„ AI ä¼šè®®çºªè¦å®æˆ˜"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-28T07:14:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LibSept24_"/> <meta itemprop="url" content="https://juejin.cn/user/537031153027213"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¼šè®®é€é•œï¼ˆMeeting Lensï¼‰ï¼šåŸºäº Rokid CXR-M çš„ AI ä¼šè®®çºªè¦å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/537031153027213/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LibSept24_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:14:27.000Z" title="Fri Nov 28 2025 07:14:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘æƒ³åˆ†äº«ä¸€ä¸ªåŸºäº Rokid CXR-M SDK + å¤§æ¨¡å‹ï¼ˆASR <strong>+</strong> LLMï¼‰ æ‰“é€ çš„å®éªŒé¡¹ç›®â€”â€”ã€Œä¼šè®®é€é•œï¼ˆMeeting Lensï¼‰ã€ã€‚</p>
<p>ä½©æˆ´ Rokid AI çœ¼é•œè¿›å…¥ä¼šè®®å®¤ï¼Œä½ åªéœ€è¦æ­£å¸¸å‘è¨€ã€è®¨è®ºã€ä¸¾æ‰‹ã€ç‚¹å¤´ï¼›</p>
<p>ä¼šè®®ç»“æŸæ—¶ï¼š</p>
<ul>
<li>ç»“æ„åŒ–çºªè¦ï¼ˆè®®é¢˜ã€ç»“è®ºã€è¡ŒåŠ¨é¡¹ï¼‰å·²ç»ç”Ÿæˆ</li>
<li>å…³é”®å†³ç­–ç‰‡æ®µè‡ªåŠ¨é«˜äº®</li>
<li>ä¸‹ä¸€æ­¥ To-do ç›´æ¥æ¨é€åˆ°ä½ çš„æ‰‹æœº / åä½œå·¥å…·</li>
</ul>
<p>ç”šè‡³åœ¨ä¼šè®®è¿›è¡Œä¸­ï¼Œçœ¼é•œå·²ç»å®æ—¶æŠŠã€Œå½“å‰è®®é¢˜ã€ã€Œå¾…ç¡®è®¤äº‹é¡¹ã€æµ®ç°åœ¨ä½ çœ¼å‰ã€‚</p>
<p>ä¸‹é¢æˆ‘ä¼šå›´ç»• CXR-M SDK çš„çœŸå®èƒ½åŠ›ä¸æ¥å£*å±•å¼€ï¼Œä»ç¯å¢ƒé…ç½®ã€è®¾å¤‡è¿æ¥ã€éŸ³é¢‘æµé‡‡é›†ï¼Œåˆ°ç«¯äº‘ååŒçš„ AI å·¥ä½œæµï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨ æè¯å™¨åœºæ™¯ + è‡ªå®šä¹‰é¡µé¢ï¼ˆCustom Viewï¼‰ï¼ŒæŠŠå®æ—¶è¦ç‚¹å’Œæœ€ç»ˆçºªè¦å›ä¼ åˆ°çœ¼é•œç«¯æ˜¾ç¤ºã€‚</p>
<h2 data-id="heading-0">ä»â€œåšç¬”è®°â€åˆ°â€œåªå¼€å£â€ï¼šä¼šè®®çºªè¦çš„é‡æ„</h2>
<h3 data-id="heading-1">1.1 ä¼ ç»Ÿä¼šè®®çºªè¦çš„ç“¶é¢ˆ</h3>
<p>å¤§å¤šæ•°äººçš„ä¼šè®®ä½“éªŒå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>ä¸€è¾¹å¬ï¼Œä¸€è¾¹è®°ï¼Œé”™è¿‡åˆ«äººè¯´äº†ä»€ä¹ˆ</li>
<li>ä¼šè®®ç»“æŸå †æ»¡è¯­éŸ³ã€ç…§ç‰‡ã€é›¶æ•£æ–‡æ¡£</li>
<li>çœŸæ­£æœ‰ç”¨çš„æ˜¯é‚£å‡ æ¡ï¼š<strong>å†³è®® &amp; è¡ŒåŠ¨é¡¹</strong> â€”â€” å´ååæœ€éš¾å®Œæ•´è®°å½•</li>
<li>è¿œç¨‹ / ç°åœºæ··åˆå¼€ä¼šæ—¶ï¼Œå¤šäººåŒæ—¶è¯´è¯ï¼Œå›æ”¾å’Œæ ‡æ³¨ååˆ†ç—›è‹¦</li>
</ul>
<p>ã€Œä¼šè®®é€é•œã€æƒ³æ”¹å˜çš„æ˜¯ï¼š</p>
<blockquote>
<p>è®©â€œä¼šè®®çºªè¦â€ä¸å†æ˜¯äººçš„è´Ÿæ‹…ï¼Œè€Œæ˜¯ AI çš„èŒè´£ã€‚ äººåªè´Ÿè´£ <strong>è¡¨è¾¾</strong> å’Œ <strong>å†³ç­–</strong>ï¼Œè®°å½•ã€æ•´ç†ã€åˆ†å‘å…¨éƒ¨è‡ªåŠ¨å®Œæˆã€‚</p>
</blockquote>
<h3 data-id="heading-2">1.2 ä¸ºä»€ä¹ˆé€‰æ‹© Rokid + CXR-M SDK æ¥åšä¼šè®®åŠ©æ‰‹</h3>
<p>è¦åšä¸€ä¸ªã€Œåªè¦æˆ´ä¸Šå°±èƒ½è‡ªåŠ¨åšçºªè¦ã€çš„ç³»ç»Ÿï¼Œéœ€è¦åŒæ—¶æ»¡è¶³ï¼š</p>
<ol>
<li>
<p><strong>ç¬¬ä¸€è§†è§’ &amp; å…æ‰‹æŒ</strong></p>
<ol>
<li>çœ¼é•œè‡ªå¸¦éº¦å…‹é£ï¼Œå¤©ç„¶è´´è¿‘å‘è¨€è€…</li>
<li>å±å¹•å°±åœ¨è§†é‡é‡Œï¼Œé€‚åˆå®æ—¶å±•ç¤ºè¦ç‚¹ã€æé†’ã€Œè¿˜æœ‰ä¸€ä¸ªè¡ŒåŠ¨é¡¹æ²¡ç¡®è®¤ã€</li>
</ol>
</li>
<li>
<p><strong>ç«¯äº‘ååŒèƒ½åŠ›</strong></p>
<ol>
<li>çœ¼é•œé€šè¿‡ <strong>è“ç‰™ / Wi-Fi</strong> ä¸æ‰‹æœºå»ºç«‹ç¨³å®šé“¾è·¯</li>
<li>æ‰‹æœºæœ‰å……è¶³ç®—åŠ›è·‘æœ¬åœ° ASR / å™ªå£°å¤„ç†</li>
<li>äº‘ç«¯å¤§æ¨¡å‹è´Ÿè´£é•¿æœŸè®°å¿†ã€å¤šè½®æ¨ç†ã€ç»“æ„åŒ–è¾“å‡º</li>
</ol>
</li>
</ol>
<p>Rokid çš„ <strong>CXR-Mï¼ˆMobile SDKï¼‰</strong> æ­£å¥½æä¾›äº†è¿™ä¸€æ•´å¥—åŸºç¡€è®¾æ–½ï¼š</p>
<ul>
<li>è“ç‰™æ‰«æä¸è¿æ¥ã€çŠ¶æ€ç®¡ç†</li>
<li>Wi-Fi P2P é«˜é€Ÿé“¾è·¯ï¼ˆé€‚åˆåŒæ­¥å½•éŸ³æ–‡ä»¶ã€ä¼šè®®å¤šåª’ä½“ï¼‰</li>
<li>çœ¼é•œç«¯éŸ³é¢‘æµé‡‡é›†ï¼ˆ<code>openAudioRecord</code> / <code>setAudioStreamListener</code>ï¼‰</li>
<li>AI åœºæ™¯äº‹ä»¶ç›‘å¬ï¼ˆ<code>AiEventListener</code>ï¼‰</li>
<li>æè¯å™¨ / ç¿»è¯‘ / è‡ªå®šä¹‰é¡µé¢ç­‰åœºæ™¯ï¼Œç”¨äºåœ¨çœ¼é•œä¸Šå±•ç¤ºæ–‡å­—ä¸ UI</li>
</ul>
<p>å¯¹ã€Œä¼šè®®é€é•œã€è¿™æ ·çš„é¡¹ç›®æ¥è¯´ï¼Œæœ€è‡ªç„¶çš„æ¶æ„æ˜¯ï¼š</p>
<ul>
<li><strong>çœ¼é•œï¼š</strong> é‡‡é›† &amp; æ˜¾ç¤º</li>
<li><strong>æ‰‹æœºï¼š</strong> é€šä¿¡ + AI å·¥ä½œæµï¼ˆASR + LLMï¼‰</li>
<li><strong>äº‘ç«¯ï¼š</strong> å¤§è§„æ¨¡æ¨¡å‹æ¨ç† &amp; é•¿æœŸå­˜å‚¨</li>
</ul>
<h2 data-id="heading-3">æ•´ä½“æ¶æ„ï¼šç«¯ â€“ äº‘ååŒçš„ã€Œä¼šè®®é€é•œã€</h2>
<p>å…ˆçœ‹ä¸€çœ¼ Meeting Lens çš„æ•°æ®æµï¼ˆåŠ ä¸€å¼ ç®€æ˜“æµç¨‹å›¾æ–¹ä¾¿è¯»è€…ç†è§£æ•´ä½“é“¾è·¯ï¼‰ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-attr">[ç”¨æˆ·ä½©æˆ´ Rokid çœ¼é•œ]</span>
 Â  Â  Â   â”‚  <span class="hljs-number">1</span>. è®²è¯ / è®¨è®º
 Â  Â  Â   â–¼
<span class="hljs-selector-attr">[çœ¼é•œéº¦å…‹é£]</span>
 Â  Â  Â   â”‚  <span class="hljs-number">2</span>. éŸ³é¢‘æµï¼ˆè“ç‰™ï¼‰
 Â  Â  Â   â–¼
<span class="hljs-selector-attr">[CXR-M SDK @ æ‰‹æœº]</span>
 Â  Â  Â   â”‚  <span class="hljs-number">3</span>. AudioStreamListener æ¥æ”¶éŸ³é¢‘
 Â  Â  Â   â”‚ Â  Â  åˆ†æ®µ / é¢„å¤„ç†
 Â  Â  Â   â–¼
<span class="hljs-selector-attr">[MeetingLensManager @ æ‰‹æœº]</span>
 Â  Â  Â   â”‚  <span class="hljs-number">4</span>. è°ƒç”¨åç«¯ /asr/stream åšå®æ—¶è½¬å†™
 Â  Â  Â   â”‚ Â  Â  ç´¯ç§¯ transcript
 Â  Â  Â   â”‚  <span class="hljs-number">5</span>. å®šæ—¶è°ƒç”¨ /meeting/summarize åšä¸­é—´ &amp; æœ€ç»ˆçºªè¦
 Â  Â  Â   â–¼
<span class="hljs-selector-attr">[åç«¯ AI æœåŠ¡]</span>
 Â  Â  Â   â”‚  <span class="hljs-built_in">ASR</span>(Whisper/è®¯é£â€¦) + <span class="hljs-built_in">LLM</span>(å¤§æ¨¡å‹)
 Â  Â  Â   â”‚  è¾“å‡ºï¼š<span class="hljs-selector-tag">summary</span> / å†³ç­– / To-do
 Â  Â  Â   â–¼
<span class="hljs-selector-attr">[MeetingLensManager]</span>
 Â  Â  Â   â”‚  <span class="hljs-number">6</span>. é€šè¿‡ Custom View / æè¯å™¨
 Â  Â  Â   â”‚ Â  Â  æŠŠçºªè¦ &amp; TODO æ¨å›çœ¼é•œ
 Â  Â  Â   â–¼
<span class="hljs-selector-attr">[çœ¼é•œæ˜¾ç¤ºå±‚ï¼šMeeting View]</span>
 Â  Â  Â   â†’ å®æ—¶å±•ç¤ºè®®é¢˜ / ç»“è®º / è¡ŒåŠ¨é¡¹
</code></pre>
<h3 data-id="heading-4">2.1 ä¼šè®®ç°åœºé‡‡é›†</h3>
<ul>
<li>ä½©æˆ´ Rokid çœ¼é•œï¼Œå¯åŠ¨ã€Œä¼šè®®åŠ©æ‰‹ã€AI åœºæ™¯</li>
<li>çœ¼é•œç«¯éº¦å…‹é£å¯åŠ¨å½•éŸ³ï¼ŒéŸ³é¢‘æµé€šè¿‡ CXR-M å›ä¼ æ‰‹æœº</li>
</ul>
<h3 data-id="heading-5">2.2 ç«¯ä¾§é¢„å¤„ç†</h3>
<ul>
<li>æ‰‹æœºç«¯å¯¹éŸ³é¢‘åšé™å™ªã€VADï¼ˆåˆ†æ®µï¼‰ã€å¯èƒ½çš„è¯´è¯äººåˆ†ç¦»</li>
<li>åˆ†æ®µéŸ³é¢‘é€å¾€æœ¬åœ° / äº‘ç«¯ ASR æœåŠ¡ï¼ˆè‹±æ–‡ã€ä¸­æ–‡æˆ–å¤šè¯­ç§ï¼‰</li>
</ul>
<h3 data-id="heading-6">2.3 äº‘ç«¯ AI çºªè¦å¼•æ“</h3>
<ul>
<li>
<p>åŸºäº ASR æ–‡æœ¬ + è¯´è¯äººæ ‡ç­¾</p>
</li>
<li>
<p>ä½¿ç”¨ LLM åšï¼šé€æ®µæ€»ç»“ + ä¼šè®®ä¸­æœŸå°ç»“ + ä¼šåå…¨å±€æ€»ç»“</p>
</li>
<li>
<p>è¾“å‡ºç»“æ„åŒ–ç»“æœï¼š</p>
<ul>
<li>è®®é¢˜åˆ—è¡¨</li>
<li>è®¨è®ºè¿‡ç¨‹æ‘˜è¦</li>
<li>å†³ç­–</li>
<li>å¾…åŠï¼ˆOwner + æˆªæ­¢æ—¶é—´ï¼‰</li>
</ul>
</li>
</ul>
<h3 data-id="heading-7">2.4 ç»“æœå›ä¼  &amp; å®æ—¶æç¤º</h3>
<ul>
<li>
<p>ä¼šè®®è¿›è¡Œä¸­ï¼š</p>
<ul>
<li>å½“å‰è®®é¢˜ / åˆšåˆšè¯´çš„å…³é”®å¥è¢«é«˜äº®ä¸ºã€Œå€™é€‰å†³è®®ã€</li>
<li>ç»æ‰‹åŠ¨ç¡®è®¤åå›ºåŒ–ä¸ºå†³è®®</li>
<li>é€šè¿‡ <strong>æè¯å™¨</strong> <strong>/ Custom View</strong> å›ä¼ åˆ°çœ¼é•œæ˜¾ç¤º</li>
</ul>
</li>
<li>
<p>ä¼šè®®ç»“æŸï¼š</p>
<ul>
<li>æœ€ç»ˆçºªè¦å‘é€æ‰‹æœº App / é‚®ä»¶ / IM ç¾¤</li>
<li>çœ¼é•œå±å¹•å±•ç¤ºã€Œæœ¬æ¬¡ä¼šè®® X é¡¹å…³é”®å†³ç­– + Y ä¸ªè¡ŒåŠ¨é¡¹ã€</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">2.5 å¾ªç¯åˆ·æ–°</h3>
<ul>
<li>æ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªã€Œæ–°çš„è®®é¢˜å—ã€å¼€å§‹ï¼ˆé€šè¿‡ä¸»æŒäººè¯­å¥ã€å…³é”®è¯æˆ– UI äº¤äº’ï¼‰ï¼Œé‡å¯ä¸€è½® ASR + æ‘˜è¦ï¼Œä¿è¯ç»“æ„æ¸…æ™°ã€‚</li>
</ul>
<h2 data-id="heading-9">å¼€å‘ç¯å¢ƒä¸ CXR-M é›†æˆ</h2>
<h3 data-id="heading-10">3.1 åŸºç¡€ç¯å¢ƒ</h3>
<ul>
<li>Android Studio 2023.1+</li>
<li>Android æ‰‹æœºï¼ˆAndroid 9.0+ï¼‰</li>
<li>Rokid AR çœ¼é•œï¼ˆå¼€å¯å¼€å‘è€…æ¨¡å¼ï¼‰</li>
<li>JDK 8+</li>
<li>Kotlin 1.8+/1.9+ï¼ˆæœ¬æ–‡ä»£ç ä»¥ Kotlin ä¸ºä¸»ï¼‰</li>
</ul>
<h3 data-id="heading-11">3.2 æ·»åŠ  Rokid Maven ä»“åº“ä¸ CXR-M ä¾èµ–</h3>
<p>æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼ŒCXR-M SDK å‘å¸ƒåœ¨ Rokid è‡ªæœ‰ Maven ä»“åº“ï¼Œéœ€è¦åœ¨ <code>settings.gradle.kts</code> é‡Œæ·»åŠ ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// settings.gradle.kts</span>
dependencyResolutionManagement {
 Â  Â repositoriesMode<span class="hljs-selector-class">.set</span>(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
 Â  Â repositories {
 Â  Â  Â  Â maven { url = <span class="hljs-built_in">uri</span>("https://maven.rokid.com/repository/maven-public/") }
 Â  Â  Â  Â <span class="hljs-built_in">google</span>()
 Â  Â  Â  Â <span class="hljs-built_in">mavenCentral</span>()
 Â   }
}
</code></pre>
<p>åœ¨ <code>app/build.gradle.kts</code> ä¸­å¼•å…¥ SDKï¼š</p>
<pre><code class="hljs language-ini" lang="ini">android {
 Â  Â <span class="hljs-attr">compileSdk</span> = <span class="hljs-number">34</span>
 Â  Â defaultConfig {
 Â  Â  Â  Â <span class="hljs-attr">applicationId</span> = <span class="hljs-string">"com.example.meetinglens"</span>
 Â  Â  Â  Â <span class="hljs-attr">minSdk</span> = <span class="hljs-number">28</span> Â  Â  Â  Â // CXR-M è¦æ±‚çš„æœ€å°ç‰ˆæœ¬
 Â  Â  Â  Â <span class="hljs-attr">targetSdk</span> = <span class="hljs-number">34</span>
 Â  Â  Â  Â <span class="hljs-attr">versionCode</span> = <span class="hljs-number">1</span>
 Â  Â  Â  Â <span class="hljs-attr">versionName</span> = <span class="hljs-string">"1.0"</span>
 Â   }
}
â€‹
dependencies {
 Â  Â implementation("com.rokid.cxr:client-m:1.0.1-20250812.080117-2")
 Â  Â // Retrofit / OkHttp / Gson ç­‰ç½‘ç»œä¾èµ–æŒ‰éœ€æ·»åŠ 
}
</code></pre>
<h3 data-id="heading-12">3.3 æƒé™ä¸åŠ¨æ€ç”³è¯·</h3>
<p>CXR-M æ¶‰åŠçš„æœ€å°æƒé™é›†åŒ…æ‹¬ï¼šè“ç‰™ã€Wi-Fiã€ç½‘ç»œç­‰ï¼Œå…¸å‹é…ç½®ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- AndroidManifest.xmlï¼ˆèŠ‚é€‰ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.ACCESS_COARSE_LOCATION"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.ACCESS_FINE_LOCATION"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.BLUETOOTH"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.BLUETOOTH_ADMIN"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.BLUETOOTH_CONNECT"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.BLUETOOTH_SCAN"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.CHANGE_NETWORK_STATE"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.ACCESS_WIFI_STATE"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.CHANGE_WIFI_STATE"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.INTERNET"</span> /&gt;</span>
<span class="hljs-comment">&lt;!-- å½•éŸ³æƒé™ï¼Œç”¨äºä¼šè®®éŸ³é¢‘é‡‡é›† --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.RECORD_AUDIO"</span> /&gt;</span>
</code></pre>
<p>è¿è¡Œæ—¶å»ºè®®ä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰å¿…è¦æƒé™ï¼ˆåŒ…æ‹¬ Android 12+ çš„ <code>BLUETOOTH_SCAN</code> / <code>BLUETOOTH_CONNECT</code>ï¼‰ï¼Œå†åˆå§‹åŒ– CXRï¼Œå¦åˆ™ SDK ä¼šç›´æ¥ä¸å¯ç”¨ã€‚</p>
<h2 data-id="heading-13">è®¾å¤‡æ¥å…¥ï¼šç”¨ CXR-M æ‰“é€šçœ¼é•œä¸æ‰‹æœº</h2>
<h3 data-id="heading-14">4.1 è“ç‰™æ‰«æä¸è¿æ¥</h3>
<p>å®˜æ–¹é€šå¸¸ä¼šæä¾›ä¸€ä¸ªè¾ƒå®Œæ•´çš„ <code>BluetoothHelper</code> ç¤ºä¾‹ï¼Œç”¨äºï¼š</p>
<ul>
<li>åŠ¨æ€ç”³è¯·è“ç‰™ç›¸å…³æƒé™</li>
<li>æ£€æµ‹è“ç‰™å¼€å…³çŠ¶æ€</li>
<li>æ‰«æ Rokid çœ¼é•œï¼ˆé€šè¿‡ç‰¹å®š Service UUID è¿‡æ»¤ï¼‰</li>
<li>ç»´æŠ¤å·²é…å¯¹ / å·²è¿æ¥è®¾å¤‡åˆ—è¡¨</li>
</ul>
<p>åœ¨ Meeting Lens ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¤ç”¨è¿™ä¸€å¥—é€»è¾‘ï¼Œæ‰«æä¸­é€šè¿‡ Service UUID è¿‡æ»¤ Rokid è®¾å¤‡ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ‰«ææ—¶ä½¿ç”¨ Rokid Glasses çš„ Service UUID è¿‡æ»¤</span>
ScanFilter<span class="hljs-selector-class">.Builder</span>()
 Â   <span class="hljs-selector-class">.setServiceUuid</span>(
 Â  Â  Â  Â ParcelUuid.fromString("<span class="hljs-number">00009100</span>-<span class="hljs-number">0000</span>-<span class="hljs-number">1000</span>-<span class="hljs-number">8000</span>-<span class="hljs-number">00805</span>f9b34fb")
 Â   )
 Â   <span class="hljs-selector-class">.build</span>()
</code></pre>
<p>æ‰¾åˆ°ç›®æ ‡è®¾å¤‡åï¼Œè°ƒç”¨ï¼š</p>
<ul>
<li><code>initBluetooth(context, device, callback)</code> å®Œæˆåˆå§‹åŒ–</li>
<li>åœ¨ <code>onConnectionInfo</code> è·å¾— <code>socketUuid</code> å’Œ <code>macAddress</code>ï¼Œå†è°ƒç”¨ <code>connectBluetooth()</code> å»ºç«‹é€šä¿¡</li>
</ul>
<h3 data-id="heading-15">4.2 Wi-Fi P2Pï¼šä¸ºå½•éŸ³æ–‡ä»¶å’Œé™„ä»¶ç•™å‡ºé€šé“</h3>
<p>ä¼šè®®ä¸­å¦‚æœéœ€è¦åŒæ­¥å®Œæ•´å½•éŸ³æ–‡ä»¶ã€æ¼”ç¤ºèµ„æ–™ã€æˆªå›¾ç­‰ï¼Œå¯ä»¥ä½¿ç”¨ Wi-Fi P2P æ¨¡å—ï¼š</p>
<ul>
<li>åˆå§‹åŒ–ï¼š<code>initWifiP2P(callback)</code></li>
<li>è·å–çŠ¶æ€ï¼š<code>isWifiP2PConnected</code></li>
<li>ååˆå§‹åŒ–ï¼š<code>deinitWifiP2P()</code></li>
</ul>
<p>ç­–ç•¥ä¸Šï¼š</p>
<ul>
<li>å®æ—¶ ASRï¼šèµ°è“ç‰™éŸ³é¢‘æµ</li>
<li>ä¼šåä¸Šä¼ å®Œæ•´å½•éŸ³ / åª’ä½“ï¼šèµ° Wi-Fi P2P + æ–‡ä»¶åŒæ­¥æ¥å£ï¼ˆå¦‚ <code>startSync</code> / <code>syncSingleFile</code>ï¼‰</li>
</ul>
<h2 data-id="heading-16">æ ¸å¿ƒé“¾è·¯ï¼šä»éŸ³é¢‘æµåˆ°ç»“æ„åŒ–ä¼šè®®çºªè¦</h2>
<h3 data-id="heading-17">5.1 è·å–çœ¼é•œç«¯éŸ³é¢‘æµï¼š<code>AudioStreamListener</code></h3>
<p>CXR-M æä¾›äº†ä¸€å¥—å®Œæ•´çš„å½•éŸ³æ¥å£ï¼š</p>
<ul>
<li>å¼€å¯å½•éŸ³ï¼š<code>openAudioRecord(codecType, streamType)</code></li>
<li>å…³é—­å½•éŸ³ï¼š<code>closeAudioRecord(streamType)</code></li>
<li>è®¾ç½®ç›‘å¬ï¼š<code>setAudioStreamListener(callback)</code></li>
</ul>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. è®¾ç½®éŸ³é¢‘æµç›‘å¬</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> audioStreamListener = <span class="hljs-keyword">object</span> : AudioStreamListener {
 Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStartAudioStream</span><span class="hljs-params">(codecType: <span class="hljs-type">Int</span>, streamType: <span class="hljs-type">String</span>?)</span></span> {
 Â  Â  Â  Â <span class="hljs-comment">// ä¾‹å¦‚ streamType = "meeting"</span>
 Â  Â  Â  Â <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œé‡ç½®ç¼“å†²åŒºã€æ—¶é—´æˆ³ç­‰</span>
 Â   }
â€‹
 Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAudioStream</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">ByteArray</span>?, offset: <span class="hljs-type">Int</span>, length: <span class="hljs-type">Int</span>)</span></span> {
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (<span class="hljs-keyword">data</span> == <span class="hljs-literal">null</span> || length &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>
 Â  Â  Â  Â <span class="hljs-comment">// å°† PCM / Opus æ•°æ®æ¨å…¥æœ¬åœ° ASR Engine / å‘é€åˆ°äº‘ç«¯</span>
 Â  Â  Â  Â asrEngine.feed(<span class="hljs-keyword">data</span>, offset, length)
 Â   }
}
â€‹
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startMeetingAudioStream</span><span class="hljs-params">()</span></span> {
 Â  Â <span class="hljs-comment">// æ³¨å†Œç›‘å¬</span>
 Â  Â CxrApi.getInstance().setAudioStreamListener(audioStreamListener)
â€‹
 Â  Â <span class="hljs-comment">// å¼€å¯å½•éŸ³ï¼šcodecType: 1=PCM, 2=OPUSï¼ˆæŒ‰æ–‡æ¡£çº¦å®šï¼‰</span>
 Â  Â CxrApi.getInstance().openAudioRecord(
 Â  Â  Â  Â codecType = <span class="hljs-number">2</span>,
 Â  Â  Â  Â streamType = <span class="hljs-string">"meeting_assistant"</span>
 Â   )
}
â€‹
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">stopMeetingAudioStream</span><span class="hljs-params">()</span></span> {
 Â  Â CxrApi.getInstance().closeAudioRecord(<span class="hljs-string">"meeting_assistant"</span>)
 Â  Â CxrApi.getInstance().setAudioStreamListener(<span class="hljs-literal">null</span>)
}
</code></pre>
<p>è¿™ä¸€æ­¥å®Œæˆåï¼Œæˆ‘ä»¬å°±æŠŠã€Œçœ¼é•œä¸Šçš„éº¦å…‹é£ã€å˜æˆäº†ã€ŒAI ä¼šè®®çºªè¦ç³»ç»Ÿçš„è€³æœµã€ã€‚</p>
<h3 data-id="heading-18">5.2 ASR + è¯´è¯äººåˆ†ç¦»ï¼šæŠŠâ€œå£°â€å˜æˆâ€œè°è¯´äº†ä»€ä¹ˆâ€</h3>
<p>åœ¨ç«¯ / äº‘ä¾§ï¼Œå¯ä»¥ä½¿ç”¨ä½ ç†Ÿæ‚‰çš„ ASR å¼•æ“ï¼ˆå¦‚ Whisperã€è®¯é£ç­‰ï¼‰ï¼š</p>
<ul>
<li>å°† <code>onAudioStream</code> ä¸­çš„éŸ³é¢‘åˆ‡æˆ 1ï½2 ç§’ç‰‡æ®µ</li>
<li>é€å…¥æµå¼ ASR</li>
<li>å¯¹æ¯æ®µæ‰“ä¸Šæ—¶é—´æˆ³ï¼Œå¹¶ç»“åˆéº¦å…‹é£é˜µåˆ— / å¤–éƒ¨éº¦ / ä¼šè®®å®¤éº¦å…‹é£åš<strong>è¯´è¯äººåˆ†ç¦»</strong></li>
</ul>
<p>å¾—åˆ°çš„æ•°æ®ç»“æ„å¤§è‡´æ˜¯ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
 Â <span class="hljs-attr">"segments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
 Â   <span class="hljs-punctuation">{</span>
 Â  Â  Â <span class="hljs-attr">"speaker"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Alice"</span><span class="hljs-punctuation">,</span>
 Â  Â  Â <span class="hljs-attr">"start"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12.3</span><span class="hljs-punctuation">,</span>
 Â  Â  Â <span class="hljs-attr">"end"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">18.7</span><span class="hljs-punctuation">,</span>
 Â  Â  Â <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æˆ‘ä»¬è¿™å­£åº¦çš„æ ¸å¿ƒç›®æ ‡æ˜¯æŠŠç•™å­˜æå‡åˆ° 35%ã€‚"</span>
 Â   <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-19">5.3 LLM çºªè¦å¼•æ“ï¼šä»æ–‡æœ¬åˆ°ç»“æ„åŒ–ç»“è®º</h3>
<p>åŸºäºä¸Šè¿° <code>segments</code>ï¼Œä½ å¯ä»¥è®¾è®¡å¤šå±‚æ¬¡æ€»ç»“æµç¨‹ï¼š</p>
<ol>
<li>
<p><strong>åˆ†æ®µæ‘˜è¦</strong></p>
<ol>
<li>æ¯ 2ï½3 åˆ†é’Ÿåšä¸€æ¬¡å°èŠ‚ï¼Œå¾—åˆ°â€œå½“å‰è®®é¢˜çš„å°ç»“â€</li>
</ol>
</li>
<li>
<p><strong>ä¼šè®®ä¸­æœŸå°ç»“</strong></p>
<ol>
<li>å½“ä¸»æŒäººåˆ‡æ¢è®®é¢˜æ—¶ï¼ˆâ€œé‚£ä¸‹é¢è®¨è®ºç¬¬äºŒä¸ªé—®é¢˜â€ï¼‰ï¼Œè§¦å‘ä¸€æ¬¡è‡ªç„¶æ®µæ€»ç»“</li>
</ol>
</li>
<li>
<p><strong>ä¼šåæ€»æ€»ç»“</strong></p>
<ol>
<li>
<p>èšåˆæ‰€æœ‰æ–‡æœ¬ + ä¸­é—´å°ç»“</p>
</li>
<li>
<p>æŒ‰å¦‚ä¸‹ç»“æ„è¾“å‡ºï¼š</p>
<ul>
<li>ä¼šè®®æ—¶é—´ / åœ°ç‚¹ / å‚ä¸è€…</li>
<li>è®®é¢˜åˆ—è¡¨</li>
<li>æ¯ä¸ªè®®é¢˜çš„ï¼šèƒŒæ™¯ / è®¨è®ºè¿‡ç¨‹ / ç»“è®º</li>
<li>å¾…åŠäº‹é¡¹ï¼ˆOwner + Deadline + çŠ¶æ€ï¼‰</li>
</ul>
</li>
</ol>
</li>
</ol>
<h3 data-id="heading-20">5.4 æŠŠå…³é”®è¦ç‚¹å›ä¼ åˆ°çœ¼é•œï¼šæè¯å™¨ + è‡ªå®šä¹‰é¡µé¢</h3>
<p>æ–¹å¼ä¸€ï¼šç”¨æè¯å™¨åœºæ™¯åšã€Œä¼šè®® TODO æ»šåŠ¨æ¡ã€</p>
<p>CXR-M æä¾›äº† æè¯å™¨ï¼ˆWord Tipsï¼‰åœºæ™¯ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li>æ‰“å¼€ / å…³é—­åœºæ™¯ï¼š<code>controlScene(ValueUtil.CxrSceneType.WORD_TIPS, toOpen, null)</code></li>
<li>ç”¨ <code>sendStream(ValueUtil.CxrStreamType.WORD_TIPS, ...)</code> å‘é€æè¯å†…å®¹</li>
</ul>
<p>ä¾‹å¦‚ï¼ŒæŠŠå·²ç»ç¡®è®¤çš„è¡ŒåŠ¨é¡¹è½¬æˆä¸€æ®µæ¸…å•æ–‡æœ¬æ¨é€åˆ°çœ¼é•œï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">openTodosOnGlasses</span><span class="hljs-params">(text: <span class="hljs-type">String</span>, fileName: <span class="hljs-type">String</span> = <span class="hljs-string">"meeting_todos.txt"</span>)</span></span> {
 Â  Â <span class="hljs-comment">// æ‰“å¼€æè¯å™¨åœºæ™¯</span>
 Â  Â CxrApi.getInstance().controlScene(
 Â  Â  Â  Â ValueUtil.CxrSceneType.WORD_TIPS,
 Â  Â  Â  Â <span class="hljs-literal">true</span>,
 Â  Â  Â  Â <span class="hljs-literal">null</span>
 Â   )
â€‹
 Â  Â <span class="hljs-comment">// å‘é€æ–‡å­—å†…å®¹</span>
 Â  Â CxrApi.getInstance().sendStream(
 Â  Â  Â  Â ValueUtil.CxrStreamType.WORD_TIPS,
 Â  Â  Â  Â text.toByteArray(),
 Â  Â  Â  Â fileName,
 Â  Â  Â  Â <span class="hljs-keyword">object</span> : SendStatusCallback {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSendSucceed</span><span class="hljs-params">()</span></span> { }
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSendFailed</span><span class="hljs-params">(code: <span class="hljs-type">ValueUtil</span>.<span class="hljs-type">CxrSendErrorCode</span>?)</span></span> { }
 Â  Â  Â   }
 Â   )
}
</code></pre>
<p>å†é…åˆ <code>configWordTipsText</code> è°ƒæ•´å­—å·ã€è¡Œè·ã€æ˜¾ç¤ºåŒºåŸŸï¼Œå¯ä»¥æŠŠã€Œå…³é”® TODOã€åƒå­—å¹•ä¸€æ ·æ»šåŠ¨åœ¨è§†é‡è¾¹ç¼˜ã€‚</p>
<p><strong>æ–¹å¼äºŒï¼šç”¨ Custom View åšã€Œå®æ—¶ä¼šè®®çŠ¶æ€å¡ç‰‡ã€</strong></p>
<p>è‡ªå®šä¹‰é¡µé¢ï¼ˆCustom Viewï¼‰å…è®¸ç”¨ JSON æè¿°ä¸€ä¸ªç•Œé¢ï¼ŒåŒ…å« <code>TextView</code> / <code>ImageView</code> / <code>LinearLayout</code> / <code>RelativeLayout</code> ç­‰æ§ä»¶ï¼Œçœ¼é•œç«¯ä¼šæ ¹æ® JSON æ¸²æŸ“ã€‚</p>
<p>å…¸å‹ç”¨æ³•ï¼š</p>
<ol>
<li>æ‰“å¼€ç•Œé¢ï¼š<code>openCustomView(content)</code></li>
<li>æ›´æ–°ï¼š<code>updateCustomView(content)</code></li>
<li>ç›‘å¬çŠ¶æ€ï¼š<code>setCustomViewListener(listener)</code></li>
</ol>
<p>ä¾‹å¦‚æ„å»ºä¸€ä¸ªç®€å•çš„ã€Œä¼šè®®çŠ¶æ€å¡ç‰‡ã€ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"LinearLayout"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"props"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"layout_width"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"match_parent"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"layout_height"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"wrap_content"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"orientation"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vertical"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"backgroundColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#80000000"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"paddingTop"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"8dp"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"paddingBottom"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"8dp"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"children"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TextView"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"props"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tv_topic"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å½“å‰è®®é¢˜ï¼šQ3 ç•™å­˜ç›®æ ‡"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"textSize"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"14sp"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"textColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FFFFFFFF"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"textStyle"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bold"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TextView"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"props"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tv_highlight"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Aliceï¼šæˆ‘ä»¬éœ€è¦æŠŠäº§å“å†…æ¨èä½“ç³»é‡æ„ä¸€éã€‚"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"textSize"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"12sp"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"textColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FFDDDDDD"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"marginTop"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"4dp"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TextView"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"props"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tv_todos"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è¡ŒåŠ¨é¡¹ï¼š3 æ¡ï¼ˆç‚¹å¤´ç¡®è®¤å¯è®°ä¸ºå·²è®¤é¢†ï¼‰"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"textSize"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"12sp"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"textColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF00FF00"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"marginTop"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"4dp"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç”¨ <code>openCustomView()</code> æ¨é€ä¸€æ¬¡ï¼Œåç»­åªéœ€ç”¨ <code>updateCustomView()</code> æ”¹ <code>tv_topic</code> / <code>tv_highlight</code> / <code>tv_todos</code> çš„ <code>text</code> å³å¯ã€‚</p>
<h2 data-id="heading-21">å®æˆ˜ï¼šåŸºäº CXR-M çš„ Meeting Lens å¼€å‘å®è·µï¼ˆå«å®Œæ•´ä»£ç ï¼‰</h2>
<h3 data-id="heading-22">6.1 å®æˆ˜ç›®æ ‡</h3>
<p>å®ç°ä¸€ä¸ª <code>MeetingLensManager</code>ï¼š</p>
<ul>
<li>
<p><code>startMeeting()</code>ï¼š</p>
<ul>
<li>å¼€å¯çœ¼é•œç«¯å½•éŸ³ï¼ˆ<code>openAudioRecord</code>ï¼‰</li>
<li>æ³¨å†Œ <code>AudioStreamListener</code> æ¥æ”¶éŸ³é¢‘æµ</li>
<li>æ‰“å¼€ Custom Viewï¼Œåœ¨çœ¼é•œä¸Šæ˜¾ç¤ºã€Œä¼šè®®çºªè¦ç”Ÿæˆä¸­ã€</li>
<li>å¯åŠ¨ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ¯éš” N ç§’æŠŠå½“å‰æ–‡æœ¬å‘ç»™åç«¯åšä¸­é—´æ€»ç»“</li>
</ul>
</li>
<li>
<p><code>stopMeeting()</code>ï¼š</p>
<ul>
<li>å…³é—­å½•éŸ³</li>
<li>åœæ­¢å®šæ—¶ä»»åŠ¡</li>
<li>æŠŠå®Œæ•´ transcript å‘é€ç»™åç«¯ï¼Œç”Ÿæˆæœ€ç»ˆçºªè¦</li>
<li>æŠŠæœ€ç»ˆçºªè¦å›ä¼ çœ¼é•œæ˜¾ç¤º</li>
</ul>
</li>
</ul>
<h3 data-id="heading-23">6.2 MeetingLensManager æ ¸å¿ƒç±»ï¼ˆå®Œæ•´ä»£ç ï¼‰</h3>
<blockquote>
<p>ä¸‹é¢è¿™æ®µ Kotlin ä»£ç å¯ä»¥ç›´æ¥å¤åˆ¶ä½¿ç”¨ï¼Œè®°å¾—æŠŠ <code>https://your.backend.com/...</code> æ¢æˆä½ è‡ªå·±çš„æœåŠ¡åœ°å€ã€‚</p>
</blockquote>
<pre><code class="hljs language-scss" lang="scss">package com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.meetinglens</span>

import android<span class="hljs-selector-class">.content</span><span class="hljs-selector-class">.Context</span>
import android<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Base64</span>
import android<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Log</span>
import androidx<span class="hljs-selector-class">.lifecycle</span><span class="hljs-selector-class">.LifecycleOwner</span>
import androidx<span class="hljs-selector-class">.lifecycle</span><span class="hljs-selector-class">.lifecycleScope</span>
import com<span class="hljs-selector-class">.rokid</span><span class="hljs-selector-class">.cxr</span><span class="hljs-selector-class">.client</span><span class="hljs-selector-class">.m</span><span class="hljs-selector-class">.CxrApi</span>
import com<span class="hljs-selector-class">.rokid</span><span class="hljs-selector-class">.cxr</span><span class="hljs-selector-class">.client</span><span class="hljs-selector-class">.m</span><span class="hljs-selector-class">.callback</span><span class="hljs-selector-class">.AudioStreamListener</span>
import com<span class="hljs-selector-class">.rokid</span><span class="hljs-selector-class">.cxr</span><span class="hljs-selector-class">.client</span><span class="hljs-selector-class">.m</span><span class="hljs-selector-class">.callback</span><span class="hljs-selector-class">.CustomViewListener</span>
import com<span class="hljs-selector-class">.rokid</span><span class="hljs-selector-class">.cxr</span><span class="hljs-selector-class">.client</span><span class="hljs-selector-class">.m</span><span class="hljs-selector-class">.utils</span><span class="hljs-selector-class">.ValueUtil</span>
import kotlinx<span class="hljs-selector-class">.coroutines</span>.*
import okhttp3<span class="hljs-selector-class">.MediaType</span><span class="hljs-selector-class">.Companion</span><span class="hljs-selector-class">.toMediaType</span>
import okhttp3<span class="hljs-selector-class">.OkHttpClient</span>
import okhttp3<span class="hljs-selector-class">.Request</span>
import okhttp3<span class="hljs-selector-class">.RequestBody</span><span class="hljs-selector-class">.Companion</span><span class="hljs-selector-class">.toRequestBody</span>
import org<span class="hljs-selector-class">.json</span><span class="hljs-selector-class">.JSONObject</span>

<span class="hljs-comment">/**
 * MeetingLensManagerï¼šä¼šè®®é€é•œæ ¸å¿ƒæ§åˆ¶ç±»
 * - æ§åˆ¶å½•éŸ³
 * - è°ƒç”¨åç«¯ ASR / LLM
 * - å°†çºªè¦ç»“æœé€šè¿‡ Custom View æ˜¾ç¤ºåœ¨çœ¼é•œä¸Š
 */</span>
class <span class="hljs-built_in">MeetingLensManager</span>(
    private val context: Context,
    private val owner: LifecycleOwner
) {

    companion <span class="hljs-selector-tag">object</span> {
        private const val TAG = "MeetingLens"
        private const val STREAM_TYPE = "meeting_assistant"
    }

    private val httpClient = <span class="hljs-built_in">OkHttpClient</span>()
    private val transcriptBuffer = <span class="hljs-built_in">StringBuilder</span>()
    private <span class="hljs-selector-tag">var</span> running = false
    private <span class="hljs-selector-tag">var</span> summaryJob: Job? = null

    // <span class="hljs-number">1</span>. éŸ³é¢‘æµç›‘å¬å™¨
    private val audioStreamListener = object : AudioStreamListener {
        override fun <span class="hljs-built_in">onStartAudioStream</span>(codecType: Int, streamType: String?) {
            Log<span class="hljs-selector-class">.d</span>(TAG, "Audio stream started: codec=$codecType, type=$streamType")
            transcriptBuffer<span class="hljs-selector-class">.clear</span>()
        }

        override fun <span class="hljs-built_in">onAudioStream</span>(data: ByteArray?, offset: Int, length: Int) {
            if (data == null || length &lt;= <span class="hljs-number">0</span>) return
            val chunk = data<span class="hljs-selector-class">.copyOfRange</span>(offset, offset + length)
            owner<span class="hljs-selector-class">.lifecycleScope</span><span class="hljs-selector-class">.launch</span>(Dispatchers.IO) {
                <span class="hljs-built_in">sendAudioChunkToAsr</span>(chunk)
            }
        }
    }

    <span class="hljs-comment">// 2. Custom View çŠ¶æ€ç›‘å¬ï¼ˆå¯é€‰ï¼‰</span>
    private val customViewListener = <span class="hljs-selector-tag">object</span> : CustomViewListener {
        override fun <span class="hljs-built_in">onOpened</span>() {
            Log<span class="hljs-selector-class">.d</span>(TAG, "CustomView opened")
        }

        override fun <span class="hljs-built_in">onClosed</span>() {
            Log<span class="hljs-selector-class">.d</span>(TAG, "CustomView closed")
        }

        override fun <span class="hljs-built_in">onOpenFailed</span>(code: Int) {
            Log<span class="hljs-selector-class">.e</span>(TAG, "CustomView open failed: $code")
        }

        override fun <span class="hljs-built_in">onIconsSent</span>() {}
        override fun <span class="hljs-built_in">onUpdated</span>() {}
    }

    <span class="hljs-comment">// ====================== å¤–éƒ¨è°ƒç”¨æ¥å£ ======================</span>

    <span class="hljs-comment">/** å¼€å§‹ä¸€åœºä¼šè®® */</span>
    fun <span class="hljs-built_in">startMeeting</span>() {
        if (running) return
        running = true
        Log<span class="hljs-selector-class">.i</span>(TAG, "startMeeting()")

        <span class="hljs-comment">// 1. è®¾ç½®éŸ³é¢‘ç›‘å¬</span>
        CxrApi<span class="hljs-selector-class">.getInstance</span>()<span class="hljs-selector-class">.setAudioStreamListener</span>(audioStreamListener)

        <span class="hljs-comment">// 2. å¼€å¯å½•éŸ³ï¼š2 = OPUS ç¼–ç </span>
        CxrApi<span class="hljs-selector-class">.getInstance</span>()<span class="hljs-selector-class">.openAudioRecord</span>(<span class="hljs-number">2</span>, STREAM_TYPE)

        <span class="hljs-comment">// 3. æ‰“å¼€çœ¼é•œç«¯ä¼šè®®é¡µé¢</span>
        <span class="hljs-built_in">openMeetingView</span>()

        <span class="hljs-comment">// 4. è®¾ç½® Custom View ç›‘å¬ï¼ˆè°ƒè¯•ç”¨ï¼‰</span>
        CxrApi<span class="hljs-selector-class">.getInstance</span>()<span class="hljs-selector-class">.setCustomViewListener</span>(customViewListener)

        <span class="hljs-comment">// 5. å®šæ—¶è¿›è¡Œä¸­é—´æ€»ç»“</span>
        summaryJob = owner<span class="hljs-selector-class">.lifecycleScope</span><span class="hljs-selector-class">.launch</span>(Dispatchers.IO) {
            while (running) {
                <span class="hljs-built_in">delay</span>(<span class="hljs-number">15</span>_000L) <span class="hljs-comment">// æ¯ 15 ç§’æ€»ç»“ä¸€æ¬¡</span>
                val text = transcriptBuffer<span class="hljs-selector-class">.toString</span>()
                if (text.isBlank()) continue
                val midSummary = <span class="hljs-built_in">summarizeOnBackend</span>(text, final = false)
                if (midSummary.isNotBlank()) {
                    <span class="hljs-built_in">updateSummaryOnGlasses</span>("ä¸­é—´å°ç»“ï¼š\n$midSummary")
                }
            }
        }

        <span class="hljs-built_in">updateSummaryOnGlasses</span>("çºªè¦ç”Ÿæˆä¸­ï¼Œè¯·è‡ªç„¶å‘è¨€â€¦")
    }

    <span class="hljs-comment">/** ç»“æŸä¼šè®® */</span>
    fun <span class="hljs-built_in">stopMeeting</span>() {
        if (!running) return
        running = false
        Log<span class="hljs-selector-class">.i</span>(TAG, "stopMeeting()")

        <span class="hljs-comment">// 1. åœæ­¢å½•éŸ³</span>
        CxrApi<span class="hljs-selector-class">.getInstance</span>()<span class="hljs-selector-class">.closeAudioRecord</span>(STREAM_TYPE)
        CxrApi<span class="hljs-selector-class">.getInstance</span>()<span class="hljs-selector-class">.setAudioStreamListener</span>(null)

        <span class="hljs-comment">// 2. åœæ­¢ä¸­é—´æ€»ç»“ä»»åŠ¡</span>
        summaryJob?<span class="hljs-selector-class">.cancel</span>()
        summaryJob = null

        <span class="hljs-comment">// 3. è°ƒç”¨åç«¯ç”Ÿæˆæœ€ç»ˆçºªè¦</span>
        owner<span class="hljs-selector-class">.lifecycleScope</span><span class="hljs-selector-class">.launch</span>(Dispatchers.IO) {
            val finalText = transcriptBuffer<span class="hljs-selector-class">.toString</span>()
            val finalSummary = <span class="hljs-built_in">summarizeOnBackend</span>(finalText, final = true)
            if (finalSummary.isNotBlank()) {
                <span class="hljs-built_in">updateSummaryOnGlasses</span>("ã€æœ¬æ¬¡ä¼šè®®æœ€ç»ˆçºªè¦ã€‘\n$finalSummary")
            } else {
                <span class="hljs-built_in">updateSummaryOnGlasses</span>("æœ¬æ¬¡ä¼šè®®çºªè¦ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–åç«¯æœåŠ¡")
            }
        }
    }

    <span class="hljs-comment">// ====================== ä¸åç«¯äº¤äº’ ======================</span>

    <span class="hljs-comment">/** å°†éŸ³é¢‘åˆ‡ç‰‡å‘é€åˆ° ASR åç«¯ï¼Œè·å– partial_text */</span>
    private fun <span class="hljs-built_in">sendAudioChunkToAsr</span>(chunk: ByteArray) {
        try {
            val base64 = Base64<span class="hljs-selector-class">.encodeToString</span>(chunk, Base64.NO_WRAP)
            val json = <span class="hljs-built_in">JSONObject</span>()<span class="hljs-selector-class">.apply</span> {
                <span class="hljs-built_in">put</span>("audio_base64", base64)
                <span class="hljs-built_in">put</span>("stream_type", STREAM_TYPE)
            }<span class="hljs-selector-class">.toString</span>()

            val request = Request<span class="hljs-selector-class">.Builder</span>()
                <span class="hljs-selector-class">.url</span>("https://your.backend.com/asr/stream") <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> æ›¿æ¢ä¸ºä½ çš„ ASR æ¥å£</span>
                <span class="hljs-selector-class">.post</span>(json.toRequestBody("application/json".toMediaType()))
                <span class="hljs-selector-class">.build</span>()

            httpClient<span class="hljs-selector-class">.newCall</span>(request)<span class="hljs-selector-class">.execute</span>()<span class="hljs-selector-class">.use</span> { resp -&gt;
                if (!resp.isSuccessful) return
                val <span class="hljs-selector-tag">body</span> = resp<span class="hljs-selector-class">.body</span>?<span class="hljs-selector-class">.string</span>()<span class="hljs-selector-class">.orEmpty</span>()
                if (body.isBlank()) return
                val obj = <span class="hljs-built_in">JSONObject</span>(body)
                val partial = obj<span class="hljs-selector-class">.optString</span>("partial_text", "")
                if (partial.isNotBlank()) {
                    transcriptBuffer<span class="hljs-selector-class">.append</span>(partial)<span class="hljs-selector-class">.append</span>('\n')
                }
            }
        } catch (e: Exception) {
            Log<span class="hljs-selector-class">.e</span>(TAG, "sendAudioChunkToAsr error: ${e.message}", e)
        }
    }

    <span class="hljs-comment">/** è°ƒç”¨ LLM åç«¯è¿›è¡Œçºªè¦æ€»ç»“ */</span>
    private fun <span class="hljs-built_in">summarizeOnBackend</span>(text: String, final: Boolean): String {
        if (text.isBlank()) return ""
        return try {
            val json = <span class="hljs-built_in">JSONObject</span>()<span class="hljs-selector-class">.apply</span> {
                <span class="hljs-built_in">put</span>("transcript", text)
                <span class="hljs-built_in">put</span>("final", final) <span class="hljs-comment">// final=true ä½¿ç”¨æ›´é‡æ¨¡å‹</span>
            }<span class="hljs-selector-class">.toString</span>()

            val request = Request<span class="hljs-selector-class">.Builder</span>()
                <span class="hljs-selector-class">.url</span>("https://your.backend.com/meeting/summarize") <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> æ›¿æ¢ä¸ºä½ çš„ Summary æ¥å£</span>
                <span class="hljs-selector-class">.post</span>(json.toRequestBody("application/json".toMediaType()))
                <span class="hljs-selector-class">.build</span>()

            httpClient<span class="hljs-selector-class">.newCall</span>(request)<span class="hljs-selector-class">.execute</span>()<span class="hljs-selector-class">.use</span> { resp -&gt;
                if (!resp.isSuccessful) return ""
                val <span class="hljs-selector-tag">body</span> = resp<span class="hljs-selector-class">.body</span>?<span class="hljs-selector-class">.string</span>()<span class="hljs-selector-class">.orEmpty</span>()
                if (body.isBlank()) return ""
                val obj = <span class="hljs-built_in">JSONObject</span>(body)
                obj<span class="hljs-selector-class">.optString</span>("summary", "")
            }
        } catch (e: Exception) {
            Log<span class="hljs-selector-class">.e</span>(TAG, "summarizeOnBackend error: ${e.message}", e)
            ""
        }
    }

    <span class="hljs-comment">// ====================== çœ¼é•œç«¯ UIï¼šCustom View ======================</span>

    <span class="hljs-comment">/** æ‰“å¼€ä¼šè®®é€é•œçš„åŸºç¡€é¡µé¢ */</span>
    private fun <span class="hljs-built_in">openMeetingView</span>() {
        val pageJson = """
        {
          "type": <span class="hljs-string">"LinearLayout"</span>,
          <span class="hljs-string">"props"</span>: {
            "id": <span class="hljs-string">"root_layout"</span>,
            <span class="hljs-string">"layout_width"</span>: <span class="hljs-string">"match_parent"</span>,
            <span class="hljs-string">"layout_height"</span>: <span class="hljs-string">"match_parent"</span>,
            <span class="hljs-string">"orientation"</span>: <span class="hljs-string">"vertical"</span>,
            <span class="hljs-string">"gravity"</span>: <span class="hljs-string">"top"</span>,
            <span class="hljs-string">"paddingTop"</span>: <span class="hljs-string">"40dp"</span>,
            <span class="hljs-string">"paddingStart"</span>: <span class="hljs-string">"12dp"</span>,
            <span class="hljs-string">"paddingEnd"</span>: <span class="hljs-string">"12dp"</span>,
            <span class="hljs-string">"backgroundColor"</span>: <span class="hljs-string">"#80000000"</span>
          },
          "children": [
            {
              "type": <span class="hljs-string">"TextView"</span>,
              <span class="hljs-string">"props"</span>: {
                "id": <span class="hljs-string">"tv_title"</span>,
                <span class="hljs-string">"layout_width"</span>: <span class="hljs-string">"wrap_content"</span>,
                <span class="hljs-string">"layout_height"</span>: <span class="hljs-string">"wrap_content"</span>,
                <span class="hljs-string">"text"</span>: <span class="hljs-string">"ä¼šè®®é€é•œ Â· Meeting Lens"</span>,
                <span class="hljs-string">"textSize"</span>: <span class="hljs-string">"16sp"</span>,
                <span class="hljs-string">"textColor"</span>: <span class="hljs-string">"#FFFFFFFF"</span>,
                <span class="hljs-string">"textStyle"</span>: <span class="hljs-string">"bold"</span>,
                <span class="hljs-string">"marginBottom"</span>: <span class="hljs-string">"8dp"</span>
              }
            },
            {
              "type": <span class="hljs-string">"TextView"</span>,
              <span class="hljs-string">"props"</span>: {
                "id": <span class="hljs-string">"tv_summary"</span>,
                <span class="hljs-string">"layout_width"</span>: <span class="hljs-string">"match_parent"</span>,
                <span class="hljs-string">"layout_height"</span>: <span class="hljs-string">"wrap_content"</span>,
                <span class="hljs-string">"text"</span>: <span class="hljs-string">"çºªè¦ç”Ÿæˆä¸­ï¼Œè¯·è‡ªç„¶å‘è¨€â€¦"</span>,
                <span class="hljs-string">"textSize"</span>: <span class="hljs-string">"12sp"</span>,
                <span class="hljs-string">"textColor"</span>: <span class="hljs-string">"#FFDDDDDD"</span>
              }
            },
            {
              "type": <span class="hljs-string">"TextView"</span>,
              <span class="hljs-string">"props"</span>: {
                "id": <span class="hljs-string">"tv_hint"</span>,
                <span class="hljs-string">"layout_width"</span>: <span class="hljs-string">"wrap_content"</span>,
                <span class="hljs-string">"layout_height"</span>: <span class="hljs-string">"wrap_content"</span>,
                <span class="hljs-string">"text"</span>: <span class="hljs-string">"æç¤ºï¼šç»“æŸå‰å¯å£å¤´ç¡®è®¤å…³é”®å†³ç­–"</span>,
                <span class="hljs-string">"textSize"</span>: <span class="hljs-string">"10sp"</span>,
                <span class="hljs-string">"textColor"</span>: <span class="hljs-string">"#FF00FF00"</span>,
                <span class="hljs-string">"marginTop"</span>: <span class="hljs-string">"8dp"</span>
              }
            }
          ]
        }
        """<span class="hljs-selector-class">.trimIndent</span>()

        CxrApi<span class="hljs-selector-class">.getInstance</span>()<span class="hljs-selector-class">.openCustomView</span>(pageJson)
    }

    <span class="hljs-comment">/** æ›´æ–°çœ¼é•œä¸Šçš„çºªè¦å†…å®¹ï¼ˆåªæ”¹ tv_summaryï¼‰ */</span>
    private fun <span class="hljs-built_in">updateSummaryOnGlasses</span>(summary: String) {
        val <span class="hljs-attribute">display</span> = if (summary.length &gt; <span class="hljs-number">400</span>) {
            <span class="hljs-selector-tag">summary</span><span class="hljs-selector-class">.substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">400</span>) + "..."
        } else <span class="hljs-selector-tag">summary</span>

        val updateJson = """
        <span class="hljs-selector-attr">[          {            <span class="hljs-string">"action"</span>: <span class="hljs-string">"update"</span>,            <span class="hljs-string">"id"</span>: <span class="hljs-string">"tv_summary"</span>,            <span class="hljs-string">"props"</span>: {              <span class="hljs-string">"text"</span>: ${JSONObject.quote(display)}            }          }        ]</span>
        """<span class="hljs-selector-class">.trimIndent</span>()

        CxrApi<span class="hljs-selector-class">.getInstance</span>()<span class="hljs-selector-class">.updateCustomView</span>(updateJson)
    }
}
</code></pre>
<h3 data-id="heading-24">6.3 åœ¨ Activity ä¸­è°ƒç”¨</h3>
<p>åœ¨ä½ çš„ Activity é‡Œï¼Œåªéœ€è¦å®ä¾‹åŒ–å¹¶è°ƒç”¨å³å¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MeetingActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> meetingLensManager: MeetingLensManager

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_meeting)

        meetingLensManager = MeetingLensManager(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>)

        findViewById&lt;Button&gt;(R.id.btnStart).setOnClickListener {
            meetingLensManager.startMeeting()
        }

        findViewById&lt;Button&gt;(R.id.btnStop).setOnClickListener {
            meetingLensManager.stopMeeting()
        }
    }
}
</code></pre>
<p>å‰æï¼š</p>
<ul>
<li>å·²ç»ç”¨ CXR-M è¿æ¥ä¸Šçœ¼é•œï¼ˆè“ç‰™å·²è¿ï¼‰</li>
<li>æƒé™å·²ç»ç”³è¯·å®Œæˆ</li>
<li>åç«¯çš„ <code>/asr/stream</code> å’Œ <code>/meeting/summarize</code> æ¥å£å¯ç”¨</li>
</ul>
<h3 data-id="heading-25">6.4 åç«¯æ¥å£çš„æœ€å°çº¦å®šï¼ˆæ–¹ä¾¿ä½ è‡ªå·±å®ç°ï¼‰</h3>
<p>ä½ å¯ä»¥å…ˆå®šä¹‰ä¸€ä¸ª<strong>éå¸¸ç®€å•</strong>çš„åè®®ï¼š</p>
<ul>
<li>
<p><code>POST /asr/stream</code></p>
<ul>
<li>è¯·æ±‚ï¼š<code>{ "audio_base64": "..." }</code></li>
<li>å“åº”ï¼š<code>{ "partial_text": "æˆ‘ä»¬è¿™å­£åº¦çš„æ ¸å¿ƒç›®æ ‡æ˜¯..." }</code></li>
</ul>
</li>
<li>
<p><code>POST /meeting/summarize</code></p>
<ul>
<li>è¯·æ±‚ï¼š<code>{ "transcript": "...é•¿æ–‡æœ¬...", "final": true/false }</code></li>
<li>å“åº”ï¼š<code>{ "summary": "æœ¬æ¬¡ä¼šè®®å›´ç»• X å±•å¼€ï¼Œå½¢æˆ 3 ä¸ªå†³ç­–ï¼Œåˆ†åˆ«æ˜¯..." }</code></li>
</ul>
</li>
</ul>
<p>åç«¯å¯ä»¥ç”¨ï¼š</p>
<ul>
<li>Python + FastAPI + Whisper + ä»»æ„å¤§æ¨¡å‹</li>
<li>æˆ–è€…ç›´æ¥æ¥äº‘ä¸Šçš„ ASR / LLM æœåŠ¡ï¼ˆçœäº‹ä½†èŠ±é’±ï¼‰</li>
</ul>
<h2 data-id="heading-26">è¸©å‘ä¸å·¥ç¨‹ç»éªŒ</h2>
<h3 data-id="heading-27">7.1 æƒé™ä¸å…¨å¯¼è‡´ SDK é™é»˜å¤±è´¥</h3>
<ul>
<li>è“ç‰™ç›¸å…³æƒé™å¿…é¡»ä¸€æ¬¡æ€§ç”³è¯·ï¼š<code>BLUETOOTH</code> / <code>BLUETOOTH_ADMIN</code> / <code>BLUETOOTH_SCAN</code> / <code>BLUETOOTH_CONNECT</code> / <code>FINE_LOCATION</code></li>
<li>æœªæˆæƒæ—¶ CXR-M å¾ˆå¤šæ¥å£ç›´æ¥ä¸å¯ç”¨ï¼Œå»ºè®®åœ¨åˆå§‹åŒ–å‰åŠ ä¸€å±‚å®Œæ•´æ£€æŸ¥</li>
</ul>
<h3 data-id="heading-28">7.2 éŸ³é¢‘æµä¸ ASR çš„è¾¹ç•Œå¯¹é½</h3>
<ul>
<li><code>AudioStreamListener</code> æ¨æ¥çš„æ•°æ®æ˜¯<strong>è¿ç»­æµ</strong>ï¼Œéœ€è¦è‡ªå·±åˆ‡ç‰‡ + æ—¶é—´æˆ³ç®¡ç†</li>
<li>è®°å¾—åœ¨ <code>onStartAudioStream</code> é‡ç½®ç¼“å†²åŒº</li>
<li>å»ºè®®ä½¿ç”¨ 10ï½20ms å¸§é•¿çš„å†…éƒ¨é˜Ÿåˆ—ï¼Œå¯¹æ¥å¤§å¤šæ•° ASR å¼•æ“æ›´å‹å¥½</li>
</ul>
<h3 data-id="heading-29">7.3 Wi-Fi P2P å…¼å®¹ä¸é™çº§ç­–ç•¥</h3>
<ul>
<li>
<p>éƒ¨åˆ†æœºå‹å¯¹ Wi-Fi Direct æ”¯æŒä¸å¥½ï¼ŒCXR å›è°ƒé‡Œå¯èƒ½è¿”å› <code>WIFI_CONNECT_FAILED</code></p>
</li>
<li>
<p>å»ºè®®ï¼š</p>
<ul>
<li>å®æ—¶çºªè¦å…¨éƒ¨èµ°éŸ³é¢‘æµ + æ–‡æœ¬ï¼Œä¸ä¾èµ– Wi-Fi</li>
<li>ä¼šåå½•éŸ³å¤‡ä»½ / å¤šåª’ä½“é™„ä»¶å†å°è¯• Wi-Fiï¼ŒåŒæ­¥å¤±è´¥åˆ™æç¤ºç”¨æˆ·æ”¹ä¸ºæ‰‹æœºæœ¬åœ°ä¿å­˜</li>
</ul>
</li>
</ul>
<h3 data-id="heading-30">7.4 Custom View å¤æ‚åº¦ä¸æ€§èƒ½</h3>
<ul>
<li>å›¾ç‰‡ä¸è¶…è¿‡ 128Ã—128 pxï¼Œæ•°é‡ä¸è¦å¤ªå¤šï¼ˆ&lt; 10 å¼ ï¼‰</li>
<li>å¸ƒå±€æ ‘ä¸è¦å¤ªæ·±ï¼Œå¤šç”¨ <code>LinearLayout</code> / <code>RelativeLayout</code> åšç®€å•æ’ç‰ˆ</li>
<li>æ›´æ–°æ—¶å°½é‡ç”¨ <code>updateCustomView</code> åšå±€éƒ¨æ›´æ–°ï¼Œé¿å…é¢‘ç¹ reopen</li>
</ul>
<p>ä¼šè®®åŠ©æ‰‹åœºæ™¯ä¸‹ï¼Œæœ€å¥½åªåœ¨è§†é‡è¾¹ç¼˜æ”¾ä¸€ä¸ªå°å¡ç‰‡ï¼Œä¸è¦é“ºæ»¡å±å¹•ï¼Œä»¥å…å½±å“ç”¨æˆ·çœ‹äºº / çœ‹ PPTã€‚</p>
<h3 data-id="heading-31">7.5 ç”µé‡ä¸äº®åº¦ã€éŸ³é‡ç®¡ç†</h3>
<p>CXR-M æä¾›äº†ï¼š</p>
<ul>
<li>äº®åº¦ç›‘å¬ä¸è®¾ç½®ï¼š<code>setGlassBrightness</code> / <code>BrightnessUpdateListener</code></li>
<li>éŸ³é‡ç›‘å¬ä¸è®¾ç½®ï¼š<code>setGlassVolume</code> / <code>VolumeUpdateListener</code></li>
<li>ç”µé‡ç›‘å¬ï¼š<code>setBatteryLevelUpdateListener</code></li>
</ul>
<p>å¯ä»¥åšä¸€äº›è‡ªåŠ¨ä¼˜åŒ–ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>è¿›å…¥ä¼šè®®åè‡ªåŠ¨æŠŠäº®åº¦è°ƒåˆ°ä¸­æ¡£ï¼Œå‡å°‘å¹²æ‰°</li>
<li>ç”µé‡ä½äº 20% æ—¶ï¼Œåœ¨çœ¼é•œç«¯å¼¹å‡ºå°æç¤º</li>
</ul>
<h2 data-id="heading-32">å°ç»“ï¼šä»ã€Œè®°å½•ä¼šè®®ã€åˆ°ã€Œä¸ºå†³ç­–æœåŠ¡ã€</h2>
<p>ã€Œä¼šè®®é€é•œï¼ˆMeeting Lensï¼‰ã€æœ¬è´¨ä¸Šåšäº†ä¸‰ä»¶äº‹ï¼š</p>
<ol start="0">
<li>ç”¨ <strong>CXR-M SDK</strong> æŠŠ <strong>çœ¼é•œçš„éº¦å…‹é£ + æ˜¾ç¤ºå±</strong> æ¥å…¥åˆ°æ‰‹æœºçš„ AI å·¥ä½œæµä¸­ï¼›</li>
<li>ç”¨ <strong>ASR</strong> <strong>+</strong> <strong>LLM</strong>ï¼ŒæŠŠâ€œè°åœ¨ä»€ä¹ˆæ—¶é—´è¯´äº†ä»€ä¹ˆâ€å˜æˆâ€œæœ‰å“ªäº›è®®é¢˜ã€ç»“è®ºå’Œè¡ŒåŠ¨é¡¹â€ï¼›</li>
<li>ç”¨ <strong>æè¯å™¨</strong> <strong>/ è‡ªå®šä¹‰é¡µé¢</strong>ï¼ŒæŠŠçœŸæ­£é‡è¦çš„ä¿¡æ¯é€‚æ—¶åœ°æµ®ç°åˆ°ç”¨æˆ·çœ¼å‰ã€‚</li>
</ol>
<p>ä»å·¥ç¨‹è§’åº¦çœ‹ï¼Œå®ƒéªŒè¯äº†ï¼š</p>
<ul>
<li>æ‰‹æœº + çœ¼é•œ å¯ä»¥åƒä¸€ä¸ªç»Ÿä¸€çš„ã€Œä¼šè®®ç»ˆç«¯ã€ï¼šçœ¼é•œè´Ÿè´£æ„ŸçŸ¥ &amp; æ˜¾ç¤ºï¼Œæ‰‹æœºè´Ÿè´£è®¡ç®—ä¸è”ç½‘ã€‚</li>
<li>CXR æä¾›çš„åœºæ™¯èƒ½åŠ›ï¼ˆAI åœºæ™¯ã€æè¯å™¨ã€ç¿»è¯‘ã€è‡ªå®šä¹‰é¡µé¢ï¼‰å¯ä»¥å¾ˆå¥½åœ°æ‰¿è½½ã€Œå®æ—¶ä¼šè®®çŠ¶æ€ã€è¿™ç±»ä¿¡æ¯ã€‚</li>
</ul>
<p>ä»ä½“éªŒè§’åº¦çœ‹ï¼Œå®ƒæŠŠå¼€ä¼šè¿™ä»¶äº‹ä»ï¼š</p>
<blockquote>
<p>ã€Œæˆ‘å¾—è¾¹å¬è¾¹è®°ï¼Œç”Ÿæ€•æ¼æ‰ä¸€ä¸ªæ•°å­—ã€</p>
</blockquote>
<p>å˜æˆï¼š</p>
<blockquote>
<p>ã€Œæˆ‘åªéœ€è¦å¥½å¥½è®¨è®ºï¼Œå‰©ä¸‹çš„äº¤ç»™ AI å’Œçœ¼é•œã€‚ã€</p>
</blockquote>
<p>å¦‚æœä½ å·²ç»æœ‰ä¸€å° Rokid çœ¼é•œå’Œä¸€å° Android æ‰‹æœºï¼Œé‚£ä¹ˆä½ ç¦»è‡ªå·±çš„ã€Œä¼šè®®é€é•œã€å…¶å®åªå·®å‡ æ­¥ï¼š</p>
<ol start="0">
<li>ç”¨ CXR-M æŠŠçœ¼é•œè¿åˆ°æ‰‹æœºï¼›</li>
<li>æ‰“å¼€éŸ³é¢‘æµï¼Œæ¥å…¥ä½ ç†Ÿæ‚‰çš„ ASR æœåŠ¡ï¼›</li>
<li>è®¾è®¡ä¸€å¥—é€‚åˆä½ å›¢é˜Ÿçš„ LLM çºªè¦ Promptï¼›</li>
<li>ç”¨æè¯å™¨æˆ– Custom Viewï¼ŒæŠŠå®æ—¶è¦ç‚¹å’Œæœ€åçºªè¦æ¨å›çœ¼é•œã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº DeepSeek + MateChat çš„è¯åˆ¸æ™ºèƒ½æŠ•é¡¾æŠ€æœ¯å®è·µï¼šæ‰“é€ é‡‘èé¢†åŸŸçš„ä¸“å±å¤§Qæ¨¡å‹åŠ©æ‰‹]]></title>    <link>https://juejin.cn/post/7577321767347355694</link>    <guid>https://juejin.cn/post/7577321767347355694</guid>    <pubDate>2025-11-28T06:53:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577321767347355694" data-draft-id="7577321767347339310" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº DeepSeek + MateChat çš„è¯åˆ¸æ™ºèƒ½æŠ•é¡¾æŠ€æœ¯å®è·µï¼šæ‰“é€ é‡‘èé¢†åŸŸçš„ä¸“å±å¤§Qæ¨¡å‹åŠ©æ‰‹"/> <meta itemprop="keywords" content="å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-28T06:53:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸­æ¯å¯ä¹å¤šåŠ å†°"/> <meta itemprop="url" content="https://juejin.cn/user/3435306702347432"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº DeepSeek + MateChat çš„è¯åˆ¸æ™ºèƒ½æŠ•é¡¾æŠ€æœ¯å®è·µï¼šæ‰“é€ é‡‘èé¢†åŸŸçš„ä¸“å±å¤§Qæ¨¡å‹åŠ©æ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3435306702347432/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸­æ¯å¯ä¹å¤šåŠ å†°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:53:46.000Z" title="Fri Nov 28 2025 06:53:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>éšç€AIå¤§æ¨¡å‹æŠ€æœ¯çš„çªç ´æ€§å‘å±•ï¼Œè¯åˆ¸è¡Œä¸šæ­£ç»å†ä»ä¼ ç»Ÿ"äººæµ·æˆ˜æœ¯"å‘"äººæœºååŒ"çš„æ·±åˆ»è½¬å‹ã€‚æ®IDCæŠ¥å‘Šæ˜¾ç¤ºï¼Œ2024å¹´ä¸­å›½é‡‘èä¸šå¯¹AIåŠç”Ÿæˆå¼AIçš„æŠ•å…¥è§„æ¨¡è¾¾196.94äº¿å…ƒï¼Œé¢„è®¡åˆ°2027å¹´å°†å¢é•¿è‡³415.48äº¿å…ƒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e116e0a7fd2c409ea7cf96497a5eccba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=4MQBn7EcZTsMNBdmUKLk7uM8Um4%3D" alt="" loading="lazy"/></p>
<p>ç„¶è€Œï¼Œä¼ ç»ŸæŠ•é¡¾æœåŠ¡æ•ˆç‡ä½ï¼Œæ ‡å‡†åŒ–ä¸é«˜ï¼Œä¸ªæ€§åŒ–èƒ½åŠ›æœ‰é™ï¼Œå¦‚ä½•åŸºäºé‡‘èé¢†åŸŸæ•°æ®æ„å»ºå®‰å…¨å¯é çš„æ™ºèƒ½æŠ•é¡¾ç³»ç»Ÿï¼Œæˆä¸ºè¯åˆ¸è¡Œä¸šæ•°å­—åŒ–è½¬å‹çš„å…³é”®è¯¾é¢˜ã€‚åœ¨è¿™ä¸€èƒŒæ™¯ä¸‹ï¼Œ MateChat æ¡†æ¶ä¸ºè¯åˆ¸æ™ºèƒ½æŠ•é¡¾ç³»ç»Ÿçš„å¿«é€Ÿæ„å»ºæä¾›äº†ç†æƒ³çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æœ¬æ–‡å°†æ¢ç´¢å¹¶å®è·µåŸºäº MateChat æ¡†æ¶çš„è¯åˆ¸æ™ºèƒ½æŠ•é¡¾æŠ€æœ¯æ–¹æ¡ˆï¼Œè¯¦ç»†é˜è¿°å…¶æ¶æ„è®¾è®¡ã€è®­ç»ƒæµç¨‹å’Œéƒ¨ç½²ç­–ç•¥ï¼Œä¸ºé‡‘èç§‘æŠ€å¼€å‘è€…æä¾›ä¸€å¥—å¯è½åœ°çš„æŠ€æœ¯è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ¶æ„è§£æ</h2>
<h4 data-id="heading-1">1.1ã€MateChat æ¡†æ¶æ¦‚è§ˆ</h4>
<p>MateChat æ˜¯ä¸€æ¬¾ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ä½“éªŒè®¾è®¡ç³»ç»Ÿï¼Œä»¥åŠä¼ä¸šçº§å‰ç«¯è§£å†³æ–¹æ¡ˆã€‚å…¶åŸºäºOpenAIã€Midjourneyã€Googleã€Claudeç­‰ä¸šç•Œé¢†å…ˆçš„AIå¤§æ¨¡å‹å‚å•†æä¾›çš„APIï¼Œå®ç°äº†ä¸€ç«™å¼å¤šæ¨¡å‹AIåº”ç”¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d758f0456e540eb8a0dde396461f65f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=iMqtC7QN43ukaYZ2TSTXYYie%2FLI%3D" alt="" loading="lazy"/></p>
<p>å®ƒä»¥Vue3å’ŒTypeScriptä¸ºåŸºç¡€ï¼Œç»“åˆäº†ç»„ä»¶åŒ–è®¾è®¡ç†å¿µï¼Œæä¾›äº†å¦‚McBubbleï¼ˆæ¶ˆæ¯æ°”æ³¡ç»„ä»¶ï¼‰ã€McLayoutï¼ˆå¯¹è¯å¸ƒå±€å®¹å™¨ï¼‰ã€McInputï¼ˆè¾“å…¥ç»„ä»¶ï¼‰ç­‰ä¸€ç³»åˆ—ä¸å¯¹è¯äº¤äº’ç›¸å…³çš„ç»„ä»¶ã€‚ä¸ä»…æ”¯æŒMarkdownè¯­æ³•ï¼Œè¿˜æä¾›äº†ä»£ç é«˜äº®ã€å¤åˆ¶ã€æŠ˜å ç­‰åŠŸèƒ½ï¼Œæå¤§åœ°ä¸°å¯Œäº†å¯¹è¯å†…å®¹çš„è¡¨ç°å½¢å¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0c6c0f14e6c4d7888469c74309906d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=QwzhSDZUUcSrNCPp0AqxLpUHtFM%3D" alt="" loading="lazy"/></p>
<p>æ­¤å¤–ï¼ŒMateChatè¿˜å…·å¤‡ä¸»é¢˜å®šåˆ¶èƒ½åŠ›ï¼Œæ”¯æŒæ˜æš—è‰²æ¨¡å¼åˆ‡æ¢ä»¥åŠé€šè¿‡CSSå˜é‡è¿›è¡Œæ‰©å±•ï¼Œæ»¡è¶³ä¸åŒç”¨æˆ·å¯¹äºç•Œé¢é£æ ¼çš„éœ€æ±‚ã€‚è¿™äº›ç‰¹æ€§ä½¿å¾—MateChatåœ¨æ„å»ºæ™ºèƒ½å¯¹è¯ç•Œé¢æ—¶å…·æœ‰é«˜åº¦çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ï¼Œä¸ºè¯åˆ¸æ™ºèƒ½æŠ•é¡¾ç³»ç»Ÿçš„å‰ç«¯å¼€å‘æä¾›äº†æœ‰åŠ›æ”¯æŒã€‚</p>
<h4 data-id="heading-2">1.2ã€è¯åˆ¸æ™ºèƒ½æŠ•é¡¾å¹³å°å®šä½</h4>
<p>æ„å»ºè¯åˆ¸æ™ºèƒ½æŠ•é¡¾ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œå°†æ•´ä¸ªç³»ç»Ÿåˆ†ä¸ºæ•°æ®å±‚ã€æœåŠ¡å±‚å’Œåº”ç”¨å±‚ã€‚æ•°æ®å±‚ä¸»è¦è´Ÿè´£å®æ—¶è¡Œæƒ…æ•°æ®çš„æ¥å…¥ã€ç”¨æˆ·è¡Œä¸ºæ•°æ®çš„æ”¶é›†ã€çŸ¥è¯†å›¾è°±çš„æ„å»ºä»¥åŠå†å²æ•°æ®çš„å­˜å‚¨ï¼Œä¸ºç³»ç»Ÿæä¾›ä¸°å¯Œçš„æ•°æ®æ”¯æŒã€‚æœåŠ¡å±‚åˆ™æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒï¼Œé›†æˆäº†NLPè¯­ä¹‰ç†è§£ã€é£é™©è¯„ä¼°æ¨¡å‹ã€æŠ•èµ„ç»„åˆä¼˜åŒ–ä»¥åŠåˆè§„é£æ§å¼•æ“ç­‰åŠŸèƒ½æ¨¡å—ï¼Œé€šè¿‡å¯¹æ•°æ®å±‚æä¾›çš„æ•°æ®è¿›è¡Œåˆ†æå’Œå¤„ç†ï¼Œç”Ÿæˆæ™ºèƒ½æŠ•é¡¾æ‰€éœ€çš„å„ç±»æœåŠ¡ã€‚åº”ç”¨å±‚åˆ™ä¸»è¦é¢å‘ç”¨æˆ·ï¼Œæä¾›äº†MateChatå¯¹è¯ç•Œé¢ï¼Œå®ç°äº†å¤šè½®å¯¹è¯ç®¡ç†ã€ä¸ªæ€§åŒ–æ¨èä»¥åŠå®æ—¶ç›‘æ§é¢æ¿ç­‰åŠŸèƒ½ï¼Œä¸ºç”¨æˆ·æä¾›äº†ä¾¿æ·ã€é«˜æ•ˆçš„æ™ºèƒ½æŠ•é¡¾ä½“éªŒã€‚</p>
<h4 data-id="heading-3">1.3ã€MateChatç»„ä»¶æ¶æ„</h4>
<p>åœ¨å‰ç«¯å®ç°æ–¹é¢ï¼ŒMateChatçš„ç»„ä»¶æ¶æ„å‘æŒ¥äº†å…³é”®ä½œç”¨ã€‚é€šè¿‡McLayoutç»„ä»¶ï¼Œæˆ‘ä»¬æ­å»ºäº†ä¸€ä¸ªç®€æ´ã€æ¸…æ™°çš„å¯¹è¯å¸ƒå±€å®¹å™¨ï¼Œä¸ºç”¨æˆ·ä¸ç³»ç»Ÿä¹‹é—´çš„å¯¹è¯æä¾›äº†ä¸€ä¸ªè‰¯å¥½çš„äº¤äº’ç¯å¢ƒã€‚McBubbleç»„ä»¶åˆ™è´Ÿè´£ä»¥æ°”æ³¡å½¢å¼å±•ç¤ºå¯¹è¯å†…å®¹ï¼Œä½¿å¾—å¯¹è¯ä¿¡æ¯æ›´åŠ ç›´è§‚æ˜“è¯»ã€‚McInputç»„ä»¶ä¸ºç”¨æˆ·æä¾›äº†ä¸€ä¸ªä¾¿æ·çš„è¾“å…¥æ¡†ï¼Œæ”¯æŒç”¨æˆ·è¾“å…¥å„ç§å½¢å¼çš„é—®é¢˜æˆ–æŒ‡ä»¤ã€‚æ­¤å¤–ï¼ŒMcPromptç»„ä»¶æä¾›äº†å¿«æ·æç¤ºåŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿè§¦å‘ä¸€äº›å¸¸ç”¨çš„æ“ä½œæˆ–æŸ¥è¯¢ã€‚è€ŒMcMarkdownCardç»„ä»¶åˆ™èƒ½å¤Ÿå°†Markdownæ ¼å¼çš„å†…å®¹è¿›è¡Œæ¸²æŸ“ï¼Œä½¿å¾—ç³»ç»Ÿå›å¤çš„å†…å®¹å¯ä»¥åŒ…å«ä¸°å¯Œçš„æ ¼å¼å’Œæ’ç‰ˆæ•ˆæœï¼Œå¦‚å›¾è¡¨ã€ä»£ç ç­‰ï¼Œè¿›ä¸€æ­¥æå‡äº†ç”¨æˆ·ä½“éªŒã€‚è¿™äº›ç»„ä»¶ç›¸äº’é…åˆï¼Œæ„å»ºäº†ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”å…·æœ‰é«˜åº¦å¯å®šåˆ¶æ€§çš„æ™ºèƒ½æŠ•é¡¾å¯¹è¯ç•Œé¢ã€‚</p>
<h2 data-id="heading-4">äºŒã€æ‰“é€ é‡‘èé¢†åŸŸçš„ä¸“å±å¤§æ¨¡å‹åŠ©æ‰‹</h2>
<h3 data-id="heading-5">2.1ã€ç¯å¢ƒå‡†å¤‡</h3>
<p>é¦–å…ˆè¿›å…¥æ§åˆ¶å°ï¼Œè¾“å…¥<code>npm create vite@latest</code>ä½¿ç”¨viteé¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ª<code>vue+ts</code>é¡¹ç›®ï¼Œé€‰æ‹©Vueå’ŒJSï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c452ed76bad64491897e7cf4f29ce53a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=7zJjLAXVgw6KdFPoeGkEQ551Esw%3D" alt="" loading="lazy"/></p>
<p>ç„¶åè¾“å…¥ï¼š<code>npm i vue-devui @matechat/core @devui-design/icons</code> ï¼Œå®‰è£…æ‰€éœ€çš„ä¾èµ–æ–‡ä»¶ï¼Œè¿™é‡Œè¦æ³¨æ„ä½¿ç”¨node 20.19+æˆ–è€… 22.12+çš„ç‰ˆæœ¬ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨viteã€‚</p>
<p>ç„¶åï¼Œåœ¨<code>main.ts</code>æ–‡ä»¶ä¸­å¼•å…¥<code>matechat</code>, <code>å›¾æ ‡åº“</code> æ ·å¼æ–‡ä»¶</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>;

<span class="hljs-keyword">import</span> <span class="hljs-title class_">MateChat</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@matechat/core'</span>;

<span class="hljs-keyword">import</span> <span class="hljs-string">'@devui-design/icons/icomoon/devui-icon.css'</span>;

<span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>).<span class="hljs-title function_">use</span>(<span class="hljs-title class_">MateChat</span>).<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>);
</code></pre>
<p>ä¹‹åï¼Œå°±å¯ä»¥åœ¨ä»»æ„æ–‡ä»¶ä¸­ä½¿ç”¨ MateChat ç»„ä»¶äº†ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">McLayout</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">McHeader</span> <span class="hljs-attr">:title</span>=<span class="hljs-string">"'MateChat'"</span> <span class="hljs-attr">:logoImg</span>=<span class="hljs-string">"'https://matechat.gitcode.com/logo.svg'"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">operationArea</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"operations"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"icon-helping"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">McHeader</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">McLayoutContent</span>
      <span class="hljs-attr">v-if</span>=<span class="hljs-string">"startPage"</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">"display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 12px"</span>
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">McIntroduction</span>
        <span class="hljs-attr">:logoImg</span>=<span class="hljs-string">"'https://matechat.gitcode.com/logo2x.svg'"</span>
        <span class="hljs-attr">:title</span>=<span class="hljs-string">"'MateChat'"</span>
        <span class="hljs-attr">:subTitle</span>=<span class="hljs-string">"'Hiï¼Œæ¬¢è¿ä½¿ç”¨ MateChat'"</span>
        <span class="hljs-attr">:description</span>=<span class="hljs-string">"description"</span>
      &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">McIntroduction</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">McPrompt</span>
        <span class="hljs-attr">:list</span>=<span class="hljs-string">"introPrompt.list"</span>
        <span class="hljs-attr">:direction</span>=<span class="hljs-string">"introPrompt.direction"</span>
        <span class="hljs-attr">class</span>=<span class="hljs-string">"intro-prompt"</span>
        @<span class="hljs-attr">itemClick</span>=<span class="hljs-string">"onSubmit($event.label)"</span>
      &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">McPrompt</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">McLayoutContent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">McLayoutContent</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content-container"</span> <span class="hljs-attr">v-else</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(msg, idx) in messages"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"idx"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">McBubble</span>
          <span class="hljs-attr">v-if</span>=<span class="hljs-string">"msg.from === 'user'"</span>
          <span class="hljs-attr">:content</span>=<span class="hljs-string">"msg.content"</span>
          <span class="hljs-attr">:align</span>=<span class="hljs-string">"'right'"</span>
          <span class="hljs-attr">:avatarConfig</span>=<span class="hljs-string">"{ imgSrc: 'https://matechat.gitcode.com/png/demo/userAvatar.svg' }"</span>
        &gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">McBubble</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">McBubble</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">:content</span>=<span class="hljs-string">"msg.content"</span> <span class="hljs-attr">:avatarConfig</span>=<span class="hljs-string">"{ imgSrc: 'https://matechat.gitcode.com/logo.svg' }"</span> <span class="hljs-attr">:loading</span>=<span class="hljs-string">"msg.loading"</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">McBubble</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">McLayoutContent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"shortcut"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: flex; align-items: center; gap: 8px"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">McPrompt</span>
        <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!startPage"</span>
        <span class="hljs-attr">:list</span>=<span class="hljs-string">"simplePrompt"</span>
        <span class="hljs-attr">:direction</span>=<span class="hljs-string">"'horizontal'"</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">"flex: 1"</span>
        @<span class="hljs-attr">itemClick</span>=<span class="hljs-string">"onSubmit($event.label)"</span>
      &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">McPrompt</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-left: auto"</span>
        <span class="hljs-attr">icon</span>=<span class="hljs-string">"add"</span>
        <span class="hljs-attr">shape</span>=<span class="hljs-string">"circle"</span>
        <span class="hljs-attr">title</span>=<span class="hljs-string">"æ–°å»ºå¯¹è¯"</span>
        <span class="hljs-attr">size</span>=<span class="hljs-string">"md"</span>
        @<span class="hljs-attr">click</span>=<span class="hljs-string">"newConversation"</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">McLayoutSender</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">McInput</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"inputValue"</span> <span class="hljs-attr">:maxLength</span>=<span class="hljs-string">"2000"</span> @<span class="hljs-attr">change</span>=<span class="hljs-string">"(e) =&gt; (inputValue = e)"</span> @<span class="hljs-attr">submit</span>=<span class="hljs-string">"onSubmit"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">extra</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-foot-wrapper"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-foot-left"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in inputFootIcons"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"item.icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>
                {{ item.text }}
              <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-foot-dividing-line"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-foot-maxlength"</span>&gt;</span>{{ inputValue.length }}/2000<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-foot-right"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">icon</span>=<span class="hljs-string">"op-clearup"</span> <span class="hljs-attr">shape</span>=<span class="hljs-string">"round"</span> <span class="hljs-attr">:disabled</span>=<span class="hljs-string">"!inputValue"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"inputValue = ''"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"demo-button-content"</span>&gt;</span>æ¸…ç©ºè¾“å…¥<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">McInput</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">McLayoutSender</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">McLayout</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-devui/button'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'vue-devui/button/style.css'</span>;

<span class="hljs-keyword">const</span> description = [
  <span class="hljs-string">'MateChat å¯ä»¥è¾…åŠ©ç ”å‘äººå‘˜ç¼–ç ã€æŸ¥è¯¢çŸ¥è¯†å’Œç›¸å…³ä½œä¸šä¿¡æ¯ã€ç¼–å†™æ–‡æ¡£ç­‰ã€‚'</span>,
  <span class="hljs-string">'ä½œä¸ºAIæ¨¡å‹ï¼ŒMateChat æä¾›çš„ç­”æ¡ˆå¯èƒ½ä¸æ€»æ˜¯ç¡®å®šæˆ–å‡†ç¡®çš„ï¼Œä½†æ‚¨çš„åé¦ˆå¯ä»¥å¸®åŠ© MateChat åšçš„æ›´å¥½ã€‚'</span>,
];
<span class="hljs-keyword">const</span> introPrompt = {
  <span class="hljs-attr">direction</span>: <span class="hljs-string">'horizontal'</span>,
  <span class="hljs-attr">list</span>: [
    {
      <span class="hljs-attr">value</span>: <span class="hljs-string">'quickSort'</span>,
      <span class="hljs-attr">label</span>: <span class="hljs-string">'å¸®æˆ‘å†™ä¸€ä¸ªå¿«é€Ÿæ’åº'</span>,
      <span class="hljs-attr">iconConfig</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'icon-info-o'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#5e7ce0'</span> },
      <span class="hljs-attr">desc</span>: <span class="hljs-string">'ä½¿ç”¨ js å®ç°ä¸€ä¸ªå¿«é€Ÿæ’åº'</span>,
    },
    {
      <span class="hljs-attr">value</span>: <span class="hljs-string">'helpMd'</span>,
      <span class="hljs-attr">label</span>: <span class="hljs-string">'ä½ å¯ä»¥å¸®æˆ‘åšäº›ä»€ä¹ˆï¼Ÿ'</span>,
      <span class="hljs-attr">iconConfig</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'icon-star'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(255, 215, 0)'</span> },
      <span class="hljs-attr">desc</span>: <span class="hljs-string">'äº†è§£å½“å‰å¤§æ¨¡å‹å¯ä»¥å¸®ä½ åšçš„äº‹'</span>,
    },
    {
      <span class="hljs-attr">value</span>: <span class="hljs-string">'bindProjectSpace'</span>,
      <span class="hljs-attr">label</span>: <span class="hljs-string">'æ€ä¹ˆç»‘å®šé¡¹ç›®ç©ºé—´'</span>,
      <span class="hljs-attr">iconConfig</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'icon-priority'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#3ac295'</span> },
      <span class="hljs-attr">desc</span>: <span class="hljs-string">'å¦‚ä½•ç»‘å®šäº‘ç©ºé—´ä¸­çš„é¡¹ç›®'</span>,
    },
  ],
};
<span class="hljs-keyword">const</span> simplePrompt = [
  {
    <span class="hljs-attr">value</span>: <span class="hljs-string">'quickSort'</span>,
    <span class="hljs-attr">iconConfig</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'icon-info-o'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#5e7ce0'</span> },
    <span class="hljs-attr">label</span>: <span class="hljs-string">'å¸®æˆ‘å†™ä¸€ä¸ªå¿«é€Ÿæ’åº'</span>,
  },
  {
    <span class="hljs-attr">value</span>: <span class="hljs-string">'helpMd'</span>,
    <span class="hljs-attr">iconConfig</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'icon-star'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(255, 215, 0)'</span> },
    <span class="hljs-attr">label</span>: <span class="hljs-string">'ä½ å¯ä»¥å¸®æˆ‘åšäº›ä»€ä¹ˆï¼Ÿ'</span>,
  },
];
<span class="hljs-keyword">const</span> startPage = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">true</span>);
<span class="hljs-keyword">const</span> inputValue = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>);
<span class="hljs-keyword">const</span> inputFootIcons = [
  { <span class="hljs-attr">icon</span>: <span class="hljs-string">'icon-at'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'æ™ºèƒ½ä½“'</span> },
  { <span class="hljs-attr">icon</span>: <span class="hljs-string">'icon-standard'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'è¯åº“'</span> },
  { <span class="hljs-attr">icon</span>: <span class="hljs-string">'icon-add'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'é™„ä»¶'</span> },
];

<span class="hljs-keyword">const</span> messages = ref&lt;any[]&gt;([]);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">newConversation</span> = (<span class="hljs-params"/>) =&gt; {
  startPage.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;
  messages.<span class="hljs-property">value</span> = [];
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">onSubmit</span> = (<span class="hljs-params">evt</span>) =&gt; {
  inputValue.<span class="hljs-property">value</span>=<span class="hljs-string">''</span>;
  startPage.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-comment">// ç”¨æˆ·å‘é€æ¶ˆæ¯</span>
  messages.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({
    <span class="hljs-attr">from</span>: <span class="hljs-string">'user'</span>,
    <span class="hljs-attr">content</span>: evt,
  });
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// æ¨¡å‹è¿”å›æ¶ˆæ¯</span>
    messages.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">from</span>: <span class="hljs-string">'model'</span>,
      <span class="hljs-attr">content</span>: evt,
    });
  }, <span class="hljs-number">200</span>);
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">1000px</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> auto;
  <span class="hljs-attribute">height</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100vh</span> - <span class="hljs-number">82px</span>);
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">8px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">16px</span>;
}

<span class="hljs-selector-class">.content-container</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: column;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">8px</span>;
  <span class="hljs-attribute">overflow</span>: auto;
}

<span class="hljs-selector-class">.input-foot-wrapper</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: space-between;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">8px</span>;

  <span class="hljs-selector-class">.input-foot-left</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">gap</span>: <span class="hljs-number">8px</span>;

    <span class="hljs-selector-tag">span</span> {
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
      <span class="hljs-attribute">line-height</span>: <span class="hljs-number">18px</span>;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#252b3a</span>;
      <span class="hljs-attribute">cursor</span>: pointer;
    }

    <span class="hljs-selector-class">.input-foot-dividing-line</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">1px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">14px</span>;
      <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#d7d8da</span>;
    }

    <span class="hljs-selector-class">.input-foot-maxlength</span> {
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#71757f</span>;
    }
  }

  <span class="hljs-selector-class">.input-foot-right</span> {
    <span class="hljs-selector-class">.demo-button-content</span> {
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    }

    &amp; &gt; *<span class="hljs-selector-pseudo">:not</span>(<span class="hljs-selector-pseudo">:first</span>-child) {
      <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">8px</span>;
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>æ˜¾ç¤ºå‡ºHelloï¼ŒMateChatè¿™æ ·ï¼Œå³ä¸ºå®‰è£…æˆåŠŸï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/903e2f880b1c49b2850ef1c13a5b726b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=8W%2ByGnUFwhKKtC%2FLB%2BRT9ChRtOE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">2.2ã€å¯¹æ¥DeepSeek API</h3>
<p>é¦–å…ˆè¦å®‰è£…OpenAIæ”¯æŒï¼Œç›´æ¥ç»ˆç«¯è¾“å…¥npm install openaiå®‰è£…ä¾èµ–</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dee98992fc12463dbc62106f6d35aa7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=IU9A%2BjndTcU%2BKZl5qBoVI8UmzQE%3D" alt="" loading="lazy"/></p>
<p>ç„¶åéœ€è¦å¯¹æ¥APIï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥DeepSeekä¸ºä¾‹ï¼ŒDeepSeek API ä½¿ç”¨ä¸ OpenAI å…¼å®¹çš„ API æ ¼å¼ï¼Œé¦–å…ˆï¼Œå‰å¾€DeepSeekå¼€å‘å¹³å°ï¼Œåˆ›å»ºAPI Keyï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4c87c83082c4a14916daaf4542c1701~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=h%2Fycna71wIlrTWH9QTlTOMuGjNE%3D" alt="" loading="lazy"/></p>
<p>ç„¶åå°†ä»£ç ä¸­onSubmitæ–¹æ³•æ›¿æ¢æˆæ¥å…¥DeepSeekçš„ä»£ç ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df8d0ddf1f0841b9b70da4fc21bece28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=L18xjaHvdBMJ0%2FAg75w08nG%2F%2Bmw%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">client</span> = ref&lt;OpenAI&gt;()<span class="hljs-comment">;</span>

<span class="hljs-attr">client.value</span> = new OpenAI({
  apiKey: '', // æ¨¡å‹APIKey
  baseURL: '', // æ¨¡å‹APIåœ°å€
  dangerouslyAllowBrowser: true, // æµè§ˆå™¨ç¯å¢ƒä½¿ç”¨éœ€è¦å¼€å¯
})<span class="hljs-comment">;</span>

const <span class="hljs-attr">onSubmit</span> = (evt) =&gt; {
  <span class="hljs-attr">inputValue.value</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">startPage.value</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
  // ç”¨æˆ·å‘é€æ¶ˆæ¯
  messages.value.push({
    from: 'user',
    content: evt,
    avatarConfig: { name: 'user' },
  })<span class="hljs-comment">;</span>

  fetchData(evt)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

const <span class="hljs-attr">fetchData</span> = async (ques) =&gt; {
  messages.value.push({
    from: 'model',
    content: '',
    avatarConfig: { name: 'model' },
    id: '',
    loading: true,
  })<span class="hljs-comment">;</span>
  const <span class="hljs-attr">completion</span> = await client.value!.chat.completions.create({
    model: 'deepseek-reasoner', // æ ¹æ®deepseekæ¨¡å‹åˆ—è¡¨è¿›è¡Œæ›¿æ¢
    messages: <span class="hljs-section">[{ role: 'user', content: ques }]</span>,
    stream: true, // ä¸º true åˆ™å¼€å¯æ¥å£çš„æµå¼è¿”å›
  })<span class="hljs-comment">;</span>
  messages.value<span class="hljs-section">[messages.value.length - 1]</span>.<span class="hljs-attr">loading</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
  for await (const chunk of completion) {
    const <span class="hljs-attr">content</span> = chunk.choices[<span class="hljs-number">0</span>]?.delta?.content || <span class="hljs-string">''</span><span class="hljs-comment">;</span>
    const <span class="hljs-attr">chatId</span> = chunk.id<span class="hljs-comment">;</span>
    messages.value<span class="hljs-section">[messages.value.length - 1]</span>.content += content<span class="hljs-comment">;</span>
    messages.value<span class="hljs-section">[messages.value.length - 1]</span>.<span class="hljs-attr">id</span> = chatId<span class="hljs-comment">;</span>
  }
}<span class="hljs-comment">;</span>
</code></pre>
<p>å¹¶ä¸”å¡«å…¥åˆšåˆšå¤åˆ¶çš„API keyï¼ŒbaseURLå°±å¡«<a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.deepseek.com%2Fv1%25E5%258D%25B3%25E5%258F%25AF%25E6%2588%2590%25E5%258A%259F%25E8%25B0%2583%25E7%2594%25A8deepseek" target="_blank" title="https://api.deepseek.com/v1%E5%8D%B3%E5%8F%AF%E6%88%90%E5%8A%9F%E8%B0%83%E7%94%A8deepseek" ref="nofollow noopener noreferrer">api.deepseek.com/v1å³å¯æˆåŠŸè°ƒç”¨deeâ€¦</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d05db67b3c44a548affdc91cd6c122f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=lxhv6zSmHdApfZ4%2B5U4gzuZZsZQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">2.3ã€å¼€å§‹æ”¹é€ </h3>
<p>åœ¨å®ŒæˆåŸºç¡€APIå¯¹æ¥åï¼Œå‚è€ƒé‡‘èé¢†åŸŸçš„ç‰¹ç‚¹ï¼Œå€Ÿé‰´MateChatåœ¨æ™ºèƒ½å¯¹è¯å’Œä¸šåŠ¡é›†æˆæ–¹é¢çš„è®¾è®¡ç†å¿µï¼Œå¯¹é‡‘èåŠ©æ‰‹è¿›è¡Œå…¨é¢çš„åŠŸèƒ½å¢å¼ºå’Œä¸šåŠ¡é€»è¾‘ä¼˜åŒ–ï¼š</p>
<p>é¦–å…ˆé’ˆå¯¹é‡‘èé¢†åŸŸæ„å»ºå¯¹åº”çš„æç¤ºè¯ï¼Œè®©æ¨¡å‹åœ¨åˆ†æå½“å‰å¯¹è¯ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ ¹æ®é‡‘èè¯é¢˜ç±»å‹ï¼ˆå¦‚è‚¡ç¥¨åˆ†æã€é£é™©è¯„ä¼°ã€è´¢åŠ¡è§„åˆ’ï¼‰ï¼Œè‡ªåŠ¨æ„å»ºé¢†åŸŸç‰¹å®šçš„æç¤ºè¯æ¨¡æ¿ï¼Œæç¤ºè¯åº“å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">// æç¤ºè¯åº“
export const PROMPT_TEMPLATES: Record&lt;FinancialTopic, FinancialPromptTemplate&gt; = {
  <span class="hljs-selector-attr">[FinancialTopic.STOCK_ANALYSIS]</span>: {
    topic: <span class="hljs-string">'è‚¡ç¥¨åˆ†æ'</span>,
    template: `ä½œä¸ºä¸“ä¸šé‡‘èåˆ†æå¸ˆï¼Œè¯·å¯¹{stockName}è¿›è¡Œå…¨é¢çš„æŠ•èµ„ä»·å€¼åˆ†æã€‚

è¯·æŒ‰ç…§ä»¥ä¸‹æ¡†æ¶è¿›è¡Œåˆ†æï¼š
<span class="hljs-number">1</span>. åŸºæœ¬é¢åˆ†æï¼šåŒ…æ‹¬è´¢åŠ¡æŒ‡æ ‡ï¼ˆå¸‚ç›ˆç‡ã€å¸‚å‡€ç‡ã€ROEç­‰ï¼‰ã€ç›ˆåˆ©èƒ½åŠ›ã€æˆé•¿æ€§
<span class="hljs-number">2</span>. æŠ€æœ¯é¢åˆ†æï¼šä»·æ ¼èµ°åŠ¿ã€æˆäº¤é‡ã€æŠ€æœ¯æŒ‡æ ‡
<span class="hljs-number">3</span>. è¡Œä¸šåˆ†æï¼šè¡Œä¸šåœ°ä½ã€ç«äº‰æ ¼å±€ã€å‘å±•å‰æ™¯
<span class="hljs-number">4</span>. ä¼°å€¼åˆ†æï¼šåˆç†ä¼°å€¼åŒºé—´ã€æŠ•èµ„å»ºè®®

è¦æ±‚ï¼š
- æä¾›å…·ä½“æ•°æ®æ”¯æ’‘
- åˆ†æè¦å®¢è§‚å…¨é¢
- ç»™å‡ºæ˜ç¡®çš„é£é™©æç¤º
- å»ºè®®è¦å…·æœ‰å¯æ“ä½œæ€§`,
    requiredMetrics: [<span class="hljs-string">'å¸‚ç›ˆç‡'</span>, <span class="hljs-string">'å¸‚å‡€ç‡'</span>, <span class="hljs-string">'ROE'</span>, <span class="hljs-string">'è¥æ”¶å¢é•¿ç‡'</span>, <span class="hljs-string">'å‡€åˆ©æ¶¦å¢é•¿ç‡'</span>],
    qualityCriteria: [<span class="hljs-string">'æ•°æ®å‡†ç¡®æ€§'</span>, <span class="hljs-string">'åˆ†ææ·±åº¦'</span>, <span class="hljs-string">'é£é™©æç¤º'</span>, <span class="hljs-string">'å¯æ“ä½œæ€§'</span>]
  },
  <span class="hljs-selector-attr">[FinancialTopic.INVESTMENT_STRATEGY]</span>: {
    topic: <span class="hljs-string">'æŠ•èµ„ç­–ç•¥'</span>,
    template: `ä½œä¸ºä¸“ä¸šæŠ•èµ„é¡¾é—®ï¼Œè¯·ä¸º{riskProfile}é£é™©åå¥½çš„æŠ•èµ„è€…åˆ¶å®šæŠ•èµ„ç­–ç•¥ã€‚

æŠ•èµ„ç›®æ ‡ï¼š{investmentGoal}
æŠ•èµ„æœŸé™ï¼š{timeHorizon}

è¯·æä¾›ï¼š
<span class="hljs-number">1</span>. èµ„äº§é…ç½®å»ºè®®ï¼ˆè‚¡ç¥¨ã€å€ºåˆ¸ã€ç°é‡‘ç­‰æ¯”ä¾‹ï¼‰
<span class="hljs-number">2</span>. å…·ä½“æŠ•èµ„æ ‡çš„æ¨è
<span class="hljs-number">3</span>. é£é™©ç®¡ç†æªæ–½
<span class="hljs-number">4</span>. å®šæœŸè°ƒæ•´ç­–ç•¥

è¦æ±‚ï¼š
- ç­–ç•¥è¦ç¬¦åˆé£é™©åå¥½
- æä¾›å†å²å›æµ‹æ•°æ®
- è€ƒè™‘å¸‚åœºç¯å¢ƒå› ç´ 
- ç»™å‡ºæ˜ç¡®çš„æ‰§è¡Œæ­¥éª¤`,
    requiredMetrics: [<span class="hljs-string">'é¢„æœŸæ”¶ç›Šç‡'</span>, <span class="hljs-string">'æœ€å¤§å›æ’¤'</span>, <span class="hljs-string">'å¤æ™®æ¯”ç‡'</span>, <span class="hljs-string">'èµ„äº§ç›¸å…³æ€§'</span>],
    qualityCriteria: [<span class="hljs-string">'é£é™©åŒ¹é…åº¦'</span>, <span class="hljs-string">'å†å²è¡¨ç°'</span>, <span class="hljs-string">'é€‚åº”æ€§'</span>, <span class="hljs-string">'æ‰§è¡Œå¯è¡Œæ€§'</span>]
  },
  <span class="hljs-selector-attr">[FinancialTopic.RISK_ASSESSMENT]</span>: {
    topic: <span class="hljs-string">'é£é™©è¯„ä¼°'</span>,
    template: `ä½œä¸ºä¸“ä¸šé£é™©è¯„ä¼°å¸ˆï¼Œè¯·å¯¹{investmentTarget}è¿›è¡Œå…¨é¢çš„é£é™©è¯„ä¼°ã€‚

è¯„ä¼°ç»´åº¦ï¼š
<span class="hljs-number">1</span>. å¸‚åœºé£é™©ï¼šä»·æ ¼æ³¢åŠ¨ã€ç³»ç»Ÿæ€§é£é™©
<span class="hljs-number">2</span>. ä¿¡ç”¨é£é™©ï¼šè¿çº¦æ¦‚ç‡ã€ä¿¡ç”¨è¯„çº§
<span class="hljs-number">3</span>. æµåŠ¨æ€§é£é™©ï¼šå˜ç°èƒ½åŠ›ã€äº¤æ˜“æˆæœ¬
<span class="hljs-number">4</span>. æ“ä½œé£é™©ï¼šç®¡ç†é£é™©ã€æŠ€æœ¯é£é™©

è¦æ±‚ï¼š
- ä½¿ç”¨é‡åŒ–é£é™©è¯„ä¼°æ–¹æ³•
- æä¾›é£é™©ç­‰çº§è¯„åˆ†
- ç»™å‡ºé£é™©æ§åˆ¶å»ºè®®
- è€ƒè™‘æç«¯å¸‚åœºæƒ…å†µ`,
    requiredMetrics: [<span class="hljs-string">'æ³¢åŠ¨ç‡'</span>, <span class="hljs-string">'VARå€¼'</span>, <span class="hljs-string">'æœ€å¤§å›æ’¤'</span>, <span class="hljs-string">'ä¿¡ç”¨è¯„çº§'</span>],
    qualityCriteria: [<span class="hljs-string">'é‡åŒ–ç¨‹åº¦'</span>, <span class="hljs-string">'å…¨é¢æ€§'</span>, <span class="hljs-string">'å®ç”¨æ€§'</span>, <span class="hljs-string">'å‰ç»æ€§'</span>]
  },
  <span class="hljs-selector-attr">[FinancialTopic.FINANCIAL_PLANNING]</span>: {
    topic: <span class="hljs-string">'è´¢åŠ¡è§„åˆ’'</span>,
    template: `ä½œä¸ºä¸“ä¸šè´¢åŠ¡è§„åˆ’å¸ˆï¼Œè¯·ä¸º{clientProfile}åˆ¶å®šä¸ªæ€§åŒ–çš„è´¢åŠ¡è§„åˆ’æ–¹æ¡ˆã€‚

å½“å‰è´¢åŠ¡çŠ¶å†µï¼š{currentSituation}
è´¢åŠ¡ç›®æ ‡ï¼š{financialGoals}

è§„åˆ’å†…å®¹ï¼š
<span class="hljs-number">1</span>. ç°é‡‘æµç®¡ç†ï¼šæ”¶å…¥æ”¯å‡ºä¼˜åŒ–
<span class="hljs-number">2</span>. èµ„äº§é…ç½®ï¼šæŠ•èµ„ç»„åˆå»ºè®®
<span class="hljs-number">3</span>. é£é™©ç®¡ç†ï¼šä¿é™©è§„åˆ’
<span class="hljs-number">4</span>. ç¨åŠ¡ä¼˜åŒ–ï¼šåˆç†é¿ç¨ç­–ç•¥

è¦æ±‚ï¼š
- æ–¹æ¡ˆè¦ä¸ªæ€§åŒ–å®šåˆ¶
- è€ƒè™‘ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ
- æä¾›å…·ä½“æ‰§è¡Œè®¡åˆ’
- åŒ…å«å®šæœŸè¯„ä¼°æœºåˆ¶`,
    requiredMetrics: [<span class="hljs-string">'ç°é‡‘æµ'</span>, <span class="hljs-string">'èµ„äº§è´Ÿå€ºç‡'</span>, <span class="hljs-string">'å‚¨è“„ç‡'</span>, <span class="hljs-string">'æŠ•èµ„å›æŠ¥ç‡'</span>],
    qualityCriteria: [<span class="hljs-string">'ä¸ªæ€§åŒ–ç¨‹åº¦'</span>, <span class="hljs-string">'å…¨é¢æ€§'</span>, <span class="hljs-string">'å¯æ‰§è¡Œæ€§'</span>, <span class="hljs-string">'é•¿æœŸæ€§'</span>]
  }
};
</code></pre>
<p>å…¶æ¬¡ï¼Œé€šè¿‡é¢„è®¾çš„é‡‘èä¸“ä¸šçŸ¥è¯†å›¾è°±å’Œå…³é”®æŒ‡æ ‡æ£€æŸ¥æ¸…å•ï¼Œå¯¹AIè¿”å›çš„å†…å®¹è¿›è¡Œè‡ªåŠ¨è´¨é‡è¯„åˆ†ã€‚å½“æ£€æµ‹åˆ°å›ç­”è¿‡äºç¬¼ç»Ÿæˆ–ç¼ºä¹å…·ä½“æ•°æ®æ”¯æ’‘æ—¶ï¼Œç³»ç»Ÿä¼šè§¦å‘è‡ªåŠ¨è¿½é—®æœºåˆ¶ï¼Œè¦æ±‚è¡¥å……å…·ä½“æ¡ˆä¾‹æˆ–æ•°æ®ä¾æ®ï¼Œç¡®ä¿è¾“å‡ºå†…å®¹è¾¾åˆ°é‡‘èä¸“ä¸šæ ‡å‡†éƒ¨åˆ†æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼›</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è¯é¢˜æ£€æµ‹å‡½æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">detectFinancialTopic</span>(<span class="hljs-params">userInput: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">FinancialTopic</span> | <span class="hljs-literal">null</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">topicKeywords</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">FinancialTopic</span>, <span class="hljs-built_in">string</span>[]&gt; = {
    [<span class="hljs-title class_">FinancialTopic</span>.<span class="hljs-property">STOCK_ANALYSIS</span>]: [<span class="hljs-string">'è‚¡ç¥¨'</span>, <span class="hljs-string">'è‚¡ä»·'</span>, <span class="hljs-string">'å¸‚ç›ˆç‡'</span>, <span class="hljs-string">'å¸‚å‡€ç‡'</span>, <span class="hljs-string">'è´¢æŠ¥'</span>, <span class="hljs-string">'ä¼°å€¼'</span>],
    [<span class="hljs-title class_">FinancialTopic</span>.<span class="hljs-property">INVESTMENT_STRATEGY</span>]: [<span class="hljs-string">'æŠ•èµ„'</span>, <span class="hljs-string">'ç­–ç•¥'</span>, <span class="hljs-string">'ç»„åˆ'</span>, <span class="hljs-string">'é…ç½®'</span>, <span class="hljs-string">'èµ„äº§'</span>, <span class="hljs-string">'æ”¶ç›Š'</span>],
    [<span class="hljs-title class_">FinancialTopic</span>.<span class="hljs-property">RISK_ASSESSMENT</span>]: [<span class="hljs-string">'é£é™©'</span>, <span class="hljs-string">'è¯„ä¼°'</span>, <span class="hljs-string">'æ³¢åŠ¨'</span>, <span class="hljs-string">'å›æ’¤'</span>, <span class="hljs-string">'å®‰å…¨'</span>, <span class="hljs-string">'ç¨³å¥'</span>],
    [<span class="hljs-title class_">FinancialTopic</span>.<span class="hljs-property">FINANCIAL_PLANNING</span>]: [<span class="hljs-string">'è´¢åŠ¡'</span>, <span class="hljs-string">'è§„åˆ’'</span>, <span class="hljs-string">'ç†è´¢'</span>, <span class="hljs-string">'å‚¨è“„'</span>, <span class="hljs-string">'é€€ä¼‘'</span>, <span class="hljs-string">'ç¨åŠ¡'</span>],
    [<span class="hljs-title class_">FinancialTopic</span>.<span class="hljs-property">MARKET_TREND</span>]: [<span class="hljs-string">'å¸‚åœº'</span>, <span class="hljs-string">'è¶‹åŠ¿'</span>, <span class="hljs-string">'è¡Œæƒ…'</span>, <span class="hljs-string">'é¢„æµ‹'</span>, <span class="hljs-string">'å®è§‚'</span>, <span class="hljs-string">'ç»æµ'</span>],
    [<span class="hljs-title class_">FinancialTopic</span>.<span class="hljs-property">PORTFOLIO_MANAGEMENT</span>]: [<span class="hljs-string">'ç»„åˆ'</span>, <span class="hljs-string">'ç®¡ç†'</span>, <span class="hljs-string">'ä¼˜åŒ–'</span>, <span class="hljs-string">'å†å¹³è¡¡'</span>, <span class="hljs-string">'åˆ†æ•£'</span>]
  };

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [topic, keywords] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(topicKeywords)) {
    <span class="hljs-keyword">if</span> (keywords.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">keyword</span> =&gt;</span> userInput.<span class="hljs-title function_">includes</span>(keyword))) {
      <span class="hljs-keyword">return</span> topic <span class="hljs-keyword">as</span> <span class="hljs-title class_">FinancialTopic</span>;
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-comment">// æç¤ºè¯ç”Ÿæˆå™¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">generateFinancialPrompt</span>(<span class="hljs-params">topic: FinancialTopic, context: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {}</span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">const</span> template = <span class="hljs-variable constant_">PROMPT_TEMPLATES</span>[topic];
  <span class="hljs-keyword">if</span> (!template) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;

  <span class="hljs-keyword">let</span> prompt = template.<span class="hljs-property">template</span>;

  <span class="hljs-comment">// æ›¿æ¢æ¨¡æ¿ä¸­çš„å˜é‡</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(context).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
    prompt = prompt.<span class="hljs-title function_">replace</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">`{<span class="hljs-subst">${key}</span>}`</span>, <span class="hljs-string">'g'</span>), value);
  });

  <span class="hljs-keyword">return</span> prompt;
}

<span class="hljs-comment">// è´¨é‡è¯„åˆ†å‡½æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">assessAnswerQuality</span>(<span class="hljs-params">answer: <span class="hljs-built_in">string</span>, topic: FinancialTopic</span>): {
  <span class="hljs-attr">score</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">feedback</span>: <span class="hljs-built_in">string</span>[];
  <span class="hljs-attr">needsFollowUp</span>: <span class="hljs-built_in">boolean</span>;
} {
  <span class="hljs-keyword">const</span> template = <span class="hljs-variable constant_">PROMPT_TEMPLATES</span>[topic];
  <span class="hljs-keyword">if</span> (!template) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">score</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">feedback</span>: [<span class="hljs-string">'æ— æ³•è¯„ä¼°è¯¥è¯é¢˜çš„å›ç­”è´¨é‡'</span>], <span class="hljs-attr">needsFollowUp</span>: <span class="hljs-literal">false</span> };
  }

  <span class="hljs-keyword">const</span> <span class="hljs-attr">feedback</span>: <span class="hljs-built_in">string</span>[] = [];
  <span class="hljs-keyword">let</span> score = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> criteriaMet = <span class="hljs-number">0</span>;

  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åŒ…å«å¿…è¦æŒ‡æ ‡</span>
  template.<span class="hljs-property">requiredMetrics</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">metric</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (answer.<span class="hljs-title function_">includes</span>(metric)) {
      criteriaMet++;
      score += <span class="hljs-number">20</span>;
    } <span class="hljs-keyword">else</span> {
      feedback.<span class="hljs-title function_">push</span>(<span class="hljs-string">`ç¼ºå°‘<span class="hljs-subst">${metric}</span>ç›¸å…³åˆ†æ`</span>);
    }
  });

  <span class="hljs-comment">// æ£€æŸ¥æ•°æ®æ”¯æ’‘</span>
  <span class="hljs-keyword">const</span> hasDataSupport = <span class="hljs-regexp">/\d+(.\d+)?%?/</span>.<span class="hljs-title function_">test</span>(answer) ||
    answer.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'æ•°æ®'</span>) ||
    answer.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'ç»Ÿè®¡'</span>) ||
    answer.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'æŠ¥å‘Š'</span>);

  <span class="hljs-keyword">if</span> (hasDataSupport) {
    criteriaMet++;
    score += <span class="hljs-number">20</span>;
  } <span class="hljs-keyword">else</span> {
    feedback.<span class="hljs-title function_">push</span>(<span class="hljs-string">'å›ç­”ç¼ºä¹å…·ä½“æ•°æ®æ”¯æ’‘'</span>);
  }

  <span class="hljs-comment">// æ£€æŸ¥åˆ†ææ·±åº¦</span>
  <span class="hljs-keyword">const</span> analysisDepth = (answer.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/\n/g</span>) || []).<span class="hljs-property">length</span> &gt; <span class="hljs-number">5</span>;
  <span class="hljs-keyword">if</span> (analysisDepth) {
    criteriaMet++;
    score += <span class="hljs-number">20</span>;
  } <span class="hljs-keyword">else</span> {
    feedback.<span class="hljs-title function_">push</span>(<span class="hljs-string">'åˆ†ææ·±åº¦ä¸è¶³ï¼Œå»ºè®®æä¾›æ›´è¯¦ç»†çš„åˆ†æ'</span>);
  }

  <span class="hljs-keyword">const</span> needsFollowUp = criteriaMet &lt; template.<span class="hljs-property">requiredMetrics</span>.<span class="hljs-property">length</span> / <span class="hljs-number">2</span>;

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">score</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">100</span>, score),
    feedback,
    needsFollowUp
  };
}

<span class="hljs-comment">// è‡ªåŠ¨è¿½é—®ç”Ÿæˆå™¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">generateFollowUpQuestion</span>(<span class="hljs-params">topic: FinancialTopic, missingMetrics: <span class="hljs-built_in">string</span>[]</span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">const</span> knowledge = <span class="hljs-variable constant_">FINANCIAL_KNOWLEDGE_GRAPH</span>[topic];
  <span class="hljs-keyword">if</span> (!knowledge) <span class="hljs-keyword">return</span> <span class="hljs-string">'è¯·æä¾›æ›´è¯¦ç»†çš„ä¿¡æ¯ä»¥ä¾¿è¿›è¡Œä¸“ä¸šåˆ†æã€‚'</span>;

  <span class="hljs-keyword">if</span> (missingMetrics.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`ä¸ºäº†æ›´å¥½åœ°è¿›è¡Œ<span class="hljs-subst">${PROMPT_TEMPLATES[topic]?.topic || <span class="hljs-string">'ä¸“ä¸š'</span>}</span>åˆ†æï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š<span class="hljs-subst">${missingMetrics.join(<span class="hljs-string">'ã€'</span>)}</span>ç›¸å…³çš„å…·ä½“æ•°æ®æˆ–æƒ…å†µã€‚`</span>;
  }

  <span class="hljs-keyword">return</span> <span class="hljs-string">`ä¸ºäº†æä¾›æ›´ç²¾å‡†çš„åˆ†æï¼Œèƒ½å¦åˆ†äº«æ›´å¤šå…³äº<span class="hljs-subst">${knowledge.keyMetrics.slice(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>).join(<span class="hljs-string">'ã€'</span>)}</span>çš„ä¿¡æ¯ï¼Ÿ`</span>;
}
</code></pre>
<p>æœ€åï¼Œåœ¨äº¤äº’è®¾è®¡ä¸Šï¼Œå‚è€ƒåä¸ºMateChatçš„å·¥å…·é›†æˆæ€è·¯ï¼Œåœ¨å¯¹è¯æµä¸­æ— ç¼åµŒå…¥é‡‘èå·¥å…·æ¨¡å—ã€‚ç”¨æˆ·å¯ä»¥åœ¨ä¸ä¸­æ–­å¯¹è¯çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è°ƒç”¨å¤åˆ©è®¡ç®—å™¨è¿›è¡Œæ”¶ç›Šæµ‹ç®—ï¼Œä½¿ç”¨é£é™©è¯„ä¼°é—®å·è¿›è¡Œé£é™©æ‰¿å—èƒ½åŠ›è¯„ä¼°ï¼Œæˆ–è€…å¯åŠ¨æ”¶ç›Šæ¨¡æ‹Ÿå™¨è¿›è¡ŒæŠ•èµ„æƒ…æ™¯åˆ†æã€‚è¿™ç§æ·±åº¦é›†æˆçš„è®¾è®¡å¤§å¤§æå‡äº†ç”¨æˆ·ä½“éªŒå’Œæ“ä½œæ•ˆç‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/52e15c94f8564173b4d27f27e1ac8b7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=OjzurRLJWxkPJCBh%2FWSL9jtG4zY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49ff42d240d44f568096df8a29096705~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=uaVTItrrPyfUcjcsVB1kXIlMSts%3D" alt="" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥åŸºäºç°æœ‰æ¶æ„è¿›è¡Œæ¨¡å—åŒ–æ‰©å±•ï¼Œæå‡é‡‘èåŠ©æ‰‹çš„ä¸“ä¸šæœåŠ¡èƒ½åŠ›ï¼š</p>
<ul>
<li>å®æ—¶è¡Œæƒ…ç›‘æ§åŠŸèƒ½ - é›†æˆè‚¡ç¥¨ã€åŸºé‡‘ã€æŒ‡æ•°çš„å®æ—¶ä»·æ ¼æ•°æ®ï¼Œæ”¯æŒè®¾ç½®ä»·æ ¼é¢„è­¦é˜ˆå€¼ï¼Œå½“æ ‡çš„è¾¾åˆ°ç›®æ ‡ä»·ä½æ—¶ä¸»åŠ¨æ¨é€æé†’ã€‚</li>
<li>è´¢æŠ¥æ™ºèƒ½è§£è¯»åŠŸèƒ½ - è‡ªåŠ¨è§£æä¸Šå¸‚å…¬å¸è´¢åŠ¡æŠ¥è¡¨ï¼Œæå–å…³é”®è´¢åŠ¡æ¯”ç‡ï¼Œè¿›è¡ŒåŒä¸šå¯¹æ¯”åˆ†æï¼Œç”Ÿæˆé€šä¿—æ˜“æ‡‚çš„è´¢åŠ¡å¥åº·åº¦æŠ¥å‘Šã€‚</li>
<li>å¸‚åœºæƒ…ç»ªåˆ†æåŠŸèƒ½ - æ•´åˆç½‘ç»œèˆ†æƒ…æ•°æ®ï¼Œè¿ç”¨è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯åˆ†æå¸‚åœºæƒ…ç»ªæŒ‡æ•°ï¼Œä¸ºæŠ•èµ„å†³ç­–æä¾›å‚è€ƒä¾æ®ã€‚</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€æ€»ç»“</h2>
<p>åœ¨AIå¤§æ¨¡å‹æŠ€æœ¯è¿…çŒ›å‘å±•çš„èƒŒæ™¯ä¸‹ï¼Œè¯åˆ¸è¡Œä¸šæ­£ç»å†ç€ä»ä¼ ç»ŸæœåŠ¡æ¨¡å¼å‘æ™ºèƒ½åŒ–ã€ä¸ªæ€§åŒ–æœåŠ¡çš„æ·±åˆ»è½¬å‹ã€‚åä¸ºMateChatä½œä¸ºä¸šç•Œé¢†å…ˆçš„AIå¯¹è¯ç»„ä»¶åº“ï¼Œä»¥å…¶å®Œå–„çš„æŠ€æœ¯æ¶æ„å’Œçµæ´»çš„ç»„ä»¶åŒ–è®¾è®¡ï¼Œä¸ºè¯åˆ¸æ™ºèƒ½æŠ•é¡¾ç³»ç»Ÿçš„å¿«é€Ÿæ„å»ºæä¾›äº†ç†æƒ³çš„æŠ€æœ¯åŸºç¡€ã€‚</p>
<p>å…¶ä¸“ä¸ºGenAIå¯¹è¯æ‰“é€ çš„è¾“å…¥åŒºåŸŸæ”¯æŒå¤šæ¨¡æ€å†…å®¹è¾“å…¥å’Œä¸°å¯Œçš„æ‰©å±•åŠŸèƒ½ã€‚å¯é…ç½®çš„å¿«æ·æŒ‡ä»¤ã€æ¨¡æ¿åŒ–è¾“å…¥å’Œæ™ºèƒ½è¡¥å…¨èƒ½åŠ›ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿè‡ªç”±ã€å‡†ç¡®åœ°è¡¨è¾¾å¤æ‚éœ€æ±‚ã€‚è¾“å…¥åŒºåŸŸçš„æ¨¡å—åŒ–è®¾è®¡ä¾¿äºå¿«é€Ÿé€‚é…ä¸åŒä¸šåŠ¡çš„ç‰¹å®šéœ€æ±‚ï¼Œä¿æŒæ ¸å¿ƒä½“éªŒä¸€è‡´çš„åŒæ—¶æ”¯æŒçµæ´»æ‰©å±•ã€‚</p>
<p>åœ¨æ¢ç´¢è¿™ä¸€æŠ€æœ¯çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå‘ç°DevUIè®¾è®¡ç³»ç»Ÿä¸ºæ„å»ºé«˜è´¨é‡çš„ç”¨æˆ·ç•Œé¢æä¾›äº†å¼ºå¤§çš„æ”¯æŒã€‚DevUIä¸ä»…æä¾›äº†ä¸°å¯Œçš„ç»„ä»¶å’Œçµæ´»çš„å®šåˆ¶èƒ½åŠ›ï¼Œè¿˜æ³¨é‡è®¾è®¡çš„ä¸€è‡´æ€§å’Œç”¨æˆ·ä½“éªŒï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°å®ç°é‡‘èé¢†åŸŸçš„å¤æ‚äº¤äº’éœ€æ±‚ã€‚å¦‚æœä½ å¯¹MateChatæ¡†æ¶çš„æ·±åº¦åº”ç”¨æ„Ÿå…´è¶£ï¼Œæˆ–è€…æƒ³äº†è§£å¦‚ä½•é€šè¿‡DevUIæ‰“é€ æ›´ä¼˜è´¨çš„ç”¨æˆ·äº¤äº’ä½“éªŒï¼Œæ·±å…¥äº†è§£DevUIçš„ä¸°å¯Œç»„ä»¶å’Œè®¾è®¡ç†å¿µï¼Œä¸å¦¨å…³æ³¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fmatechat.gitcode.com%2F" target="_blank" title="https://matechat.gitcode.com/" ref="nofollow noopener noreferrer">MateChatå®˜ç½‘</a>å’Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdevui.design%2F" target="_blank" title="https://devui.design/" ref="nofollow noopener noreferrer">DevUIå®˜ç½‘</a>ï¼Œè·å–æ›´å¤šå®ç”¨ä¿¡æ¯å’ŒæŠ€æœ¯æ”¯æŒï¼Œå…±åŒæ¨åŠ¨é‡‘èç§‘æŠ€çš„åˆ›æ–°ä¸å‘å±•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e348041bbb5482992d97d9356949f02~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lit5p2v5Y-v5LmQ5aSa5Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917626&amp;x-signature=WRWzO2dn3s%2FqxOpjqJn6IlU0754%3D" alt="" loading="lazy"/></p>
<p>å±•æœ›æœªæ¥ï¼Œéšç€å¤šæ¨¡æ€äº¤äº’ã€å®æ—¶æ•°æ®å¤„ç†ç­‰æŠ€æœ¯çš„æŒç»­æ¼”è¿›ï¼ŒMateChatå°†åœ¨æ™ºèƒ½æŠ•é¡¾é¢†åŸŸå±•ç°å‡ºæ›´å¤§æ½œåŠ›ï¼Œåä¸ºMateChatæœ‰æœ›æˆä¸ºè¿æ¥AIæŠ€æœ¯ä¸é‡‘èæœåŠ¡çš„é‡è¦æ¡¥æ¢ï¼Œæ¨åŠ¨æ•´ä¸ªè¡Œä¸šå‘æ™ºèƒ½åŒ–ã€ä¸ªæ€§åŒ–æœåŠ¡çš„æ–°é˜¶æ®µè¿ˆè¿›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[pythonå­¦ä¹ ä¹‹ä¸åŒå‚¨å­˜æ–¹å¼çš„æ“ä½œæ–¹æ³•]]></title>    <link>https://juejin.cn/post/7577395040593018890</link>    <guid>https://juejin.cn/post/7577395040593018890</guid>    <pubDate>2025-11-28T07:32:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577395040593018890" data-draft-id="7577438119558004787" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="pythonå­¦ä¹ ä¹‹ä¸åŒå‚¨å­˜æ–¹å¼çš„æ“ä½œæ–¹æ³•"/> <meta itemprop="keywords" content="Python,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2025-11-28T07:32:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ææ™¨å“"/> <meta itemprop="url" content="https://juejin.cn/user/3053762234038564"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            pythonå­¦ä¹ ä¹‹ä¸åŒå‚¨å­˜æ–¹å¼çš„æ“ä½œæ–¹æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3053762234038564/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ææ™¨å“
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:32:07.000Z" title="Fri Nov 28 2025 07:32:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">çŸ¥è¯†æ¸…å•</h2>
<p>å­—ç¬¦ä¸²è½¬ä¹‰ã€æ•°å­—ç±»å‹æ“ä½œã€å¸ƒå°”ç±»å‹çš„ç‰¹å¾ã€åˆ—è¡¨çš„æ“ä½œæ–¹æ³•ã€å…ƒç»„çš„æ“ä½œæ–¹æ³•ã€é›†åˆçš„æ“ä½œæ–¹æ³•</p>
<h3 data-id="heading-1">å­—ç¬¦ä¸²è½¬ä¹‰</h3>
<p>å¸¸ç”¨çš„æœ‰<code>\n</code>ï¼Œè¡¨ç¤ºæ¢è¡Œï¼Œ<code>\t</code>ï¼Œè¡¨ç¤ºåœ¨å­—ç¬¦ä¸²ä¹‹é—´åŠ ä¸€ä¸ª'TAB'é”®ï¼Œç›¸å½“äº4ä¸ªç©ºæ ¼ã€‚è€Œå½“æˆ‘ä»¬ä¸æƒ³è½¬ä¹‰æ—¶ï¼Œä¸è®©<code>\n</code>ã€<code>\t</code>å‘æŒ¥ä½œç”¨ï¼Œå°±è¦\nä¸\tï¼Œåªè¡¨ç¤ºæ™®é€šçš„å­—ç¬¦ä¸²\nä¸\tï¼Œæ²¡æœ‰å…¶ä»–ç‰¹æ®Šå«ä¹‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f6d4c05726c48509d4eb5411824026d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2O5pmo5Y2T:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919927&amp;x-signature=KXCnW7nvlwyebgkEbrX%2FRnnwfek%3D" alt="Snipaste_2025-11-28_14-43-15.png" loading="lazy"/></p>
<h3 data-id="heading-2">æ•°å­—ç±»å‹æ“ä½œ</h3>
<p>èµ‹å€¼è¿ç®—ç¬¦ä¸å‰ç«¯åŸºç¡€å­¦ä¹ çš„åŸºæœ¬ä¸€è‡´ï¼Œæ³¨æ„<code>\\=</code>æ˜¯é™¤æ³•å‘ä¸‹å–æ•´ï¼Œè€Œ<code>**=n</code>è¿™ä¸ªnå°±æ˜¯å¤šå°‘æ¬¡å¹‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa40a50f571b448c831818747b1a50e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2O5pmo5Y2T:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919927&amp;x-signature=wb3Zqx4vnTbO0QTHSosXqYvjkUM%3D" alt="Snipaste_2025-11-28_14-46-49.png" loading="lazy"/></p>
<h3 data-id="heading-3">å¸ƒå°”ç±»å‹çš„ç‰¹å¾</h3>
<p>å¸ƒå°”ç±»å‹çš„ä½œç”¨ï¼šç”¨æ¥ä½œä¸ºåˆ¤æ–­çš„æ¡ä»¶å»ç”¨ï¼Œå¸ƒå°”å€¼åªæœ‰Trueä¸Falseï¼Œä¸ä»…ä»…æ˜¯çœŸå‡ï¼Œè¿˜æ˜¯æ•°æ®çš„æœ‰æ— ï¼Œå¹¶ä¸”æ¯ä¸ªæ•°æ®ç±»å‹éƒ½æœ‰è‡ªå·±çš„å¸ƒå°”å€¼ï¼Œå½“å‡ºç°Noneï¼Œ0ï¼Œç©ºï¼ˆç©ºå­—ç¬¦ä¸²ã€ç©ºåˆ—è¡¨ã€ç©ºå­—å…¸ï¼‰æ—¶ï¼Œä¸‰ç§æƒ…å†µä¸‹å¸ƒå°”å€¼ä¸ºFalseã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/805dca9df5c14298affbd172df163779~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2O5pmo5Y2T:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919927&amp;x-signature=6OGNh%2FYwvWBTZhrzN3OqEvTXe1A%3D" alt="Snipaste_2025-11-28_14-52-15.png" loading="lazy"/></p>
<h3 data-id="heading-4">åˆ—è¡¨çš„æ“ä½œæ–¹æ³•ï¼šå¢åˆ æ”¹æŸ¥</h3>
<h4 data-id="heading-5">å¢</h4>
<p>append(å…ƒç´ ) -- å¾€åˆ—è¡¨æœ«å°¾è¿½åŠ ä¸€ä¸ªå…ƒç´ ï¼›è¦åœ¨æœ«å°¾å¢åŠ å¤šä¸ªå…ƒç´ æ—¶ï¼Œå°±è¦ç”¨åˆ°extend([å…ƒç´ ])ï¼›è€Œè¦åœ¨è‡ªå®šä¹‰ä½ç½®åŠ å…ƒç´ æ—¶ï¼Œå°±è¦ç”¨åˆ°insert('ç´¢å¼•','åœ¨ç´¢å¼•å‰é¢æ–°åŠ çš„å…ƒç´ ')</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfa701f4c88d48d8827c1b4a6f39a0b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2O5pmo5Y2T:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919927&amp;x-signature=UxSW2LUW8MSYVKEfzbdz0gwfmTk%3D" alt="Snipaste_2025-11-28_14-58-30.png" loading="lazy"/></p>
<h4 data-id="heading-6">åˆ </h4>
<p>é™¤äº†<code>del(ç´¢å¼•)</code>ä¹‹å¤–ï¼Œè¿˜æœ‰æŒ‡å®šåˆ é™¤çš„<code>remove(å…ƒç´ )</code>ï¼Œè¿˜æœ‰<code>pop(ç´¢å¼•)</code>ï¼Œå³ä»åˆ—è¡¨ä¸­å–èµ°ä¸€ä¸ªå€¼ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69afb6261b9a4a6ea3aaeaba09d7b4a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2O5pmo5Y2T:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919927&amp;x-signature=QN3%2FWE14kSAajZpOy3OalbawVQI%3D" alt="Snipaste_2025-11-28_15-05-18.png" loading="lazy"/></p>
<h4 data-id="heading-7">æ”¹</h4>
<p><code>sort()</code> -- æ’åº(é»˜è®¤ä»ä½åˆ°é«˜æ’åº)ï¼Œè‹¥æ·»åŠ ååºï¼Œå³ <code>åç§°.sort(reverse = True)</code>ï¼Œåˆ™æŒ‰ä»å¤§åˆ°å°çš„é¡ºåºæ’åˆ—ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e899900dc1844e7a9fe0a44702806ed5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2O5pmo5Y2T:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919927&amp;x-signature=VCPg0vBXAgoOxrzsPe86O5Hi75s%3D" alt="Snipaste_2025-11-28_15-09-41.png" loading="lazy"/></p>
<h4 data-id="heading-8">æŸ¥</h4>
<p>æŸ¥çœ‹åˆ—è¡¨æŸä¸ªå…ƒç´ çš„ä¸ªæ•°ï¼Œ<code>count(å…ƒç´ )</code>ï¼Œä»¥åŠ<code>index(å…ƒç´ )</code>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6f3db12014e4aaf9221795e1196dd70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2O5pmo5Y2T:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919927&amp;x-signature=J707D0mHU9cF1gecIUBwEwgMrtc%3D" alt="Snipaste_2025-11-28_15-13-33.png" loading="lazy"/></p>
<h3 data-id="heading-9">å…ƒç»„çš„æ“ä½œæ–¹æ³•</h3>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå…ƒç»„ä¸­çš„å…ƒç´ æ˜¯ä¸èƒ½ä»¥ç´¢å¼•ä¿®æ”¹çš„ï¼Œä½†å…ƒç»„é‡Œçš„åˆ—è¡¨ä¸­çš„å…ƒç´ æ˜¯å¯ä»¥ç”¨ç´¢å¼•ä¿®æ”¹çš„ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å…ƒç»„è½¬æ¢ä¸ºåˆ—è¡¨ä»¥åå†ä¿®æ”¹å°±å¯ä»¥äº†ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca4fc4ed6bc44a45a57296e713994f1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2O5pmo5Y2T:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919927&amp;x-signature=6ljz58TqyNGjBzpODU5Or%2BPf2Ao%3D" alt="Snipaste_2025-11-28_15-18-47.png" loading="lazy"/></p>
<h3 data-id="heading-10">é›†åˆçš„æ“ä½œæ–¹æ³•ï¼šå¢åˆ æ”¹æŸ¥</h3>
<h4 data-id="heading-11">å¢</h4>
<p><code>add()</code>ï¼Œæ‹¬å·é‡Œä¸èƒ½ä¸å¡«</p>
<h4 data-id="heading-12">åˆ </h4>
<p><code>remove()</code>ï¼Œæ‹¬å·é‡Œä¸èƒ½ä¸å¡«</p>
<h4 data-id="heading-13">æ”¹</h4>
<p><code>update()</code>ï¼Œæ‹¬å·é‡Œå¯ä»¥ä¸å¡«,è¾“å‡ºçš„è¿˜æ˜¯åŸæ¥çš„é›†åˆï¼Œä½†é‡Œé¢è¦åŠ <code>[]</code>
è¿˜æœ‰é›†åˆè½¬åŒ–ä¸ºåˆ—è¡¨ã€åˆ—è¡¨è½¬åŒ–ä¸ºé›†åˆçš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/302f1b0bdd984985a4832898f0b7b276~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2O5pmo5Y2T:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764919927&amp;x-signature=p%2BXFmvKd%2BRhJVxv2OCQKNMOkP8Q%3D" alt="Snipaste_2025-11-28_15-23-48.png" loading="lazy"/></p>
<p>å¼€æºä»£ç åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2F" target="_blank" title="https://gitee.com/" ref="nofollow noopener noreferrer">gitee.com/</a>    ç‚¹å‡»ä»£ç ç‰‡æ®µçš„python3å³å¯çœ‹åˆ°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®æˆ˜ï¼šçˆ¬å–æŸè”æ‹›è˜èŒä½éœ€æ±‚å¹¶ç”Ÿæˆè¯äº‘â€”â€”ä»é›¶å¼€å§‹çš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7577668116499972134</link>    <guid>https://juejin.cn/post/7577668116499972134</guid>    <pubDate>2025-11-28T07:24:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577668116499972134" data-draft-id="7577668116499939366" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®æˆ˜ï¼šçˆ¬å–æŸè”æ‹›è˜èŒä½éœ€æ±‚å¹¶ç”Ÿæˆè¯äº‘â€”â€”ä»é›¶å¼€å§‹çš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-11-28T07:24:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç«™å¤§çˆ·IP"/> <meta itemprop="url" content="https://juejin.cn/user/2905353241759261"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®æˆ˜ï¼šçˆ¬å–æŸè”æ‹›è˜èŒä½éœ€æ±‚å¹¶ç”Ÿæˆè¯äº‘â€”â€”ä»é›¶å¼€å§‹çš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2905353241759261/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç«™å¤§çˆ·IP
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:24:01.000Z" title="Fri Nov 28 2025 07:24:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é¡¹ç›®èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åšè¿™ä»¶äº‹ï¼Ÿ</h2>
<p>åœ¨æ±‚èŒå­£ï¼Œä½ æ˜¯å¦æ›¾å¯¹ç€æˆç™¾ä¸Šåƒçš„æ‹›è˜ä¿¡æ¯å‘å‘†ï¼ŸHRæ¯å¤©è¦ç­›é€‰æ•°ç™¾ä»½ç®€å†ï¼Œæ±‚èŒè€…è¦åœ¨æµ·é‡å²—ä½ä¸­æ‰¾æ–¹å‘ã€‚å¦‚æœèƒ½ç”¨æŠ€æœ¯æ‰‹æ®µå¿«é€Ÿæå–å²—ä½æ ¸å¿ƒéœ€æ±‚ï¼Œæ— è®ºæ˜¯æ±‚èŒè€…ä¼˜åŒ–ç®€å†è¿˜æ˜¯ä¼ä¸šåˆ†æäººæ‰å¸‚åœºï¼Œéƒ½èƒ½äº‹åŠåŠŸå€ã€‚</p>
<p>æœ¬æ–‡å°†æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨Pythonçˆ¬å–æŸè”æ‹›è˜çš„èŒä½éœ€æ±‚ï¼Œå¹¶é€šè¿‡è¯äº‘å¯è§†åŒ–å±•ç¤ºé«˜é¢‘å…³é”®è¯ã€‚æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šæ•°æ®é‡‡é›†ï¼ˆçˆ¬è™«ï¼‰ã€æ•°æ®å¤„ç†ï¼ˆæ¸…æ´—ï¼‰ã€æ•°æ®å¯è§†åŒ–ï¼ˆè¯äº‘ï¼‰ï¼Œå³ä½¿æ²¡æœ‰ç¼–ç¨‹åŸºç¡€ä¹Ÿèƒ½è·Ÿç€æ“ä½œã€‚</p>
<h2 data-id="heading-1">äºŒã€å·¥å…·å‡†å¤‡ï¼šéœ€è¦å“ªäº›æ­¦å™¨ï¼Ÿ</h2>
<h3 data-id="heading-2">1. å¼€å‘ç¯å¢ƒ</h3>
<ul>
<li>Python 3.8+ï¼ˆæ¨èAnacondaé›†æˆç¯å¢ƒï¼‰</li>
<li>ä»£ç ç¼–è¾‘å™¨ï¼šVS Code/PyCharmï¼ˆé€‰ä½ é¡ºæ‰‹çš„ï¼‰</li>
<li>æµè§ˆå™¨ï¼šChromeï¼ˆç”¨äºæŸ¥çœ‹ç½‘é¡µç»“æ„ï¼‰</li>
</ul>
<h3 data-id="heading-3">2. æ ¸å¿ƒåº“å®‰è£…</h3>
<pre><code class="hljs">pip install requests beautifulsoup4 pandas wordcloud jieba matplotlib
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<ul>
<li><code>requests</code>ï¼šå‘é€HTTPè¯·æ±‚</li>
<li><code>BeautifulSoup</code>ï¼šè§£æHTML</li>
<li><code>pandas</code>ï¼šæ•°æ®å¤„ç†</li>
<li><code>wordcloud</code>ï¼šç”Ÿæˆè¯äº‘</li>
<li><code>jieba</code>ï¼šä¸­æ–‡åˆ†è¯</li>
<li><code>matplotlib</code>ï¼šç»˜å›¾å±•ç¤º</li>
</ul>
<h3 data-id="heading-4">3. è¾…åŠ©å·¥å…·</h3>
<ul>
<li>ä»£ç†IPæ± ï¼ˆåº”å¯¹åçˆ¬ï¼‰</li>
<li>Chromeå¼€å‘è€…å·¥å…·ï¼ˆæŒ‰F12æ‰“å¼€ï¼‰</li>
</ul>
<h2 data-id="heading-5">ä¸‰ã€æ•°æ®é‡‡é›†ï¼šçªç ´åçˆ¬é™·é˜±</h2>
<h3 data-id="heading-6">1. ç›®æ ‡åˆ†æ</h3>
<p>æ‰“å¼€æŸè”æ‹›è˜å®˜ç½‘ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.***.com%25EF%25BC%2589%25EF%25BC%258C%25E4%25BB%25A5%2522Python%25E5%25BC%2580%25E5%258F%2591%2522%25E4%25B8%25BA%25E4%25BE%258B%25E6%2590%259C%25E7%25B4%25A2%25EF%25BC%259A" target="_blank" title="https://www.***.com%EF%BC%89%EF%BC%8C%E4%BB%A5%22Python%E5%BC%80%E5%8F%91%22%E4%B8%BA%E4%BE%8B%E6%90%9C%E7%B4%A2%EF%BC%9A" ref="nofollow noopener noreferrer">https://www.***.comï¼‰ï¼Œä»¥"Pythonå¼€å‘"ä¸ºä¾‹æœç´¢ï¼š</a></p>
<ol>
<li>è§‚å¯ŸURLç»“æ„ï¼š<code>https://sou.***.com/?kw=Pythonå¼€å‘&amp;page=1</code></li>
<li>ç¿»é¡µè§„å¾‹ï¼šæ¯é¡µå‚æ•°<code>page</code>é€’å¢</li>
<li>èŒä½åˆ—è¡¨å®¹å™¨ï¼šé€šè¿‡å¼€å‘è€…å·¥å…·æ‰¾åˆ°<code>.job-list ul li</code></li>
</ol>
<h3 data-id="heading-7">2. åŸºç¡€çˆ¬è™«ä»£ç </h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_job_list</span>(<span class="hljs-params">keyword, page</span>):
    url = <span class="hljs-string">f"https://sou.***.com/?kw=<span class="hljs-subst">{keyword}</span>&amp;page=<span class="hljs-subst">{page}</span>"</span>
    headers = {
        <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"</span>
    }
    <span class="hljs-keyword">try</span>:
        response = requests.get(url, headers=headers, timeout=<span class="hljs-number">10</span>)
        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
            soup = BeautifulSoup(response.text, <span class="hljs-string">'html.parser'</span>)
            jobs = []
            <span class="hljs-keyword">for</span> li <span class="hljs-keyword">in</span> soup.select(<span class="hljs-string">'.job-list ul li'</span>):
                title = li.select_one(<span class="hljs-string">'.job-title'</span>).text.strip()
                company = li.select_one(<span class="hljs-string">'.company-name'</span>).text.strip()
                salary = li.select_one(<span class="hljs-string">'.salary'</span>).text.strip() <span class="hljs-keyword">if</span> li.select_one(<span class="hljs-string">'.salary'</span>) <span class="hljs-keyword">else</span> <span class="hljs-string">"é¢è®®"</span>
                requirement = li.select_one(<span class="hljs-string">'.job-requirements'</span>).text.strip() <span class="hljs-keyword">if</span> li.select_one(<span class="hljs-string">'.job-requirements'</span>) <span class="hljs-keyword">else</span> <span class="hljs-string">""</span>
                jobs.append({
                    <span class="hljs-string">'title'</span>: title,
                    <span class="hljs-string">'company'</span>: company,
                    <span class="hljs-string">'salary'</span>: salary,
                    <span class="hljs-string">'requirement'</span>: requirement
                })
            <span class="hljs-keyword">return</span> jobs
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š<span class="hljs-subst">{response.status_code}</span>"</span>)
            <span class="hljs-keyword">return</span> []
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‘ç”Ÿé”™è¯¯ï¼š<span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> []
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-8">3. åçˆ¬ç­–ç•¥å‡çº§</h3>
<p><strong>é—®é¢˜1ï¼šç›´æ¥è¯·æ±‚è¿”å›403</strong></p>
<ul>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼šæ·»åŠ æ›´å¤šè¯·æ±‚å¤´å­—æ®µ</p>
<pre><code class="hljs language-makefile" lang="makefile">headers = {
    <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"..."</span>,
    <span class="hljs-string">"Referer"</span>: <span class="hljs-string">"https://www.***.com/"</span>,
    <span class="hljs-string">"Accept-Language"</span>: <span class="hljs-string">"zh-CN,zh;q=0.9"</span>,
    <span class="hljs-string">"Cookie"</span>: <span class="hljs-string">"ä½ çš„æµè§ˆå™¨cookieï¼ˆå¯é€‰ï¼‰"</span>
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
</li>
</ul>
<p><strong>é—®é¢˜2ï¼šé¢‘ç¹è¯·æ±‚è¢«å°IP</strong></p>
<ul>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ä»£ç†IPæ± </p>
<pre><code class="hljs language-ini" lang="ini">import random

<span class="hljs-attr">proxies</span> = [
    {<span class="hljs-string">"http"</span>: <span class="hljs-string">"http://123.123.123.123:8080"</span>},
    {<span class="hljs-string">"http"</span>: <span class="hljs-string">"http://124.124.124.124:8081"</span>}
]

<span class="hljs-attr">response</span> = requests.get(url, headers=headers, proxies=random.choice(proxies), timeout=<span class="hljs-number">10</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
</li>
</ul>
<p><strong>è¿›é˜¶æŠ€å·§</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>time.sleep(random.uniform(1,3))</code>æ·»åŠ éšæœºå»¶è¿Ÿ</li>
<li>è´­ä¹°ä»˜è´¹ä»£ç†æœåŠ¡ï¼ˆå¦‚å¿«ä»£ç†ã€èŠéº»ä»£ç†ï¼‰</li>
<li>åˆ†å¸ƒå¼çˆ¬å–ï¼ˆå¤šçº¿ç¨‹/å¤šè¿›ç¨‹ï¼‰</li>
</ul>
<h3 data-id="heading-9">4. å®Œæ•´é‡‡é›†æµç¨‹</h3>
<pre><code class="hljs language-ini" lang="ini">def crawl_all_pages(keyword, <span class="hljs-attr">max_pages</span>=<span class="hljs-number">5</span>):
    <span class="hljs-attr">all_jobs</span> = []
    for page in range(1, max_pages+1):
        print(f"æ­£åœ¨çˆ¬å–ç¬¬{page}é¡µ...")
        <span class="hljs-attr">jobs</span> = get_job_list(keyword, page)
        if not jobs:
            break
        all_jobs.extend(jobs)
        time.sleep(2)  <span class="hljs-comment"># ç¤¼è²Œæ€§å»¶è¿Ÿ</span>
    return all_jobs

<span class="hljs-comment"># æ‰§è¡Œçˆ¬å–</span>
<span class="hljs-attr">jobs_data</span> = crawl_all_pages(<span class="hljs-string">"Pythonå¼€å‘"</span>, <span class="hljs-number">3</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-10">å››ã€æ•°æ®å¤„ç†ï¼šæå–æ ¸å¿ƒéœ€æ±‚</h2>
<h3 data-id="heading-11">1. æ•°æ®æ¸…æ´—</h3>
<pre><code class="hljs language-ini" lang="ini">import pandas as pd

<span class="hljs-attr">df</span> = pd.DataFrame(jobs_data)
<span class="hljs-comment"># å»é™¤ç©ºå€¼</span>
<span class="hljs-attr">df</span> = df.dropna(subset=[<span class="hljs-string">'requirement'</span>])
<span class="hljs-comment"># ä¿å­˜åŸå§‹æ•°æ®ï¼ˆå¯é€‰ï¼‰</span>
df.to_csv('zhaopin_raw.csv', <span class="hljs-attr">index</span>=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">'utf_8_sig'</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-12">2. éœ€æ±‚æ–‡æœ¬æå–</h3>
<p>è§‚å¯Ÿå‘ç°ï¼ŒèŒä½æè¿°é€šå¸¸åŒ…å«ï¼š</p>
<ul>
<li>
<p>å²—ä½èŒè´£ï¼ˆä»¥"å²—ä½èŒè´£ï¼š"å¼€å¤´ï¼‰</p>
</li>
<li>
<p>ä»»èŒè¦æ±‚ï¼ˆä»¥"ä»»èŒè¦æ±‚ï¼š"å¼€å¤´ï¼‰</p>
</li>
<li>
<p>å…¶ä»–ä¿¡æ¯ï¼ˆå…¬å¸ç¦åˆ©ç­‰ï¼‰</p>
<pre><code class="hljs language-scss" lang="scss">def <span class="hljs-built_in">extract_requirements</span>(text):
    if not text:
        return <span class="hljs-string">""</span>
    # ç®€å•åˆ†å‰²ï¼ˆå®é™…å¯èƒ½éœ€è¦æ›´å¤æ‚çš„æ­£åˆ™ï¼‰
    parts = text.<span class="hljs-built_in">split</span>(<span class="hljs-string">'ä»»èŒè¦æ±‚ï¼š'</span>)
    if <span class="hljs-built_in">len</span>(parts) &gt; <span class="hljs-number">1</span>:
        return parts[<span class="hljs-number">1</span>].<span class="hljs-built_in">split</span>(<span class="hljs-string">'èŒä½ç¦åˆ©ï¼š'</span>)[<span class="hljs-number">0</span>].<span class="hljs-built_in">strip</span>()
    else:
        return text.<span class="hljs-built_in">split</span>(<span class="hljs-string">'å²—ä½èŒè´£ï¼š'</span>)[-<span class="hljs-number">1</span>].<span class="hljs-built_in">split</span>(<span class="hljs-string">'èŒä½ç¦åˆ©ï¼š'</span>)[<span class="hljs-number">0</span>].<span class="hljs-built_in">strip</span>()

df[<span class="hljs-string">'clean_require'</span>] = df[<span class="hljs-string">'requirement'</span>].<span class="hljs-built_in">apply</span>(extract_requirements)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
</li>
</ul>
<h3 data-id="heading-13">3. åˆå¹¶æ‰€æœ‰éœ€æ±‚æ–‡æœ¬</h3>
<pre><code class="hljs language-bash" lang="bash">all_requirements = <span class="hljs-string">' '</span>.<span class="hljs-built_in">join</span>(<span class="hljs-built_in">df</span>[<span class="hljs-string">'clean_require'</span>].tolist())
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-14">äº”ã€è¯äº‘ç”Ÿæˆï¼šå¯è§†åŒ–æ ¸å¿ƒæŠ€èƒ½</h2>
<h3 data-id="heading-15">1. ä¸­æ–‡åˆ†è¯å¤„ç†</h3>
<pre><code class="hljs language-csharp" lang="csharp">import jieba

<span class="hljs-meta"># æ·»åŠ è‡ªå®šä¹‰è¯å…¸ï¼ˆå¯é€‰ï¼‰</span>
jieba.load_userdict(<span class="hljs-string">"tech_terms.txt"</span>)  <span class="hljs-meta"># å¯è‡ªè¡Œå‡†å¤‡æŠ€æœ¯æœ¯è¯­è¯å…¸</span>

<span class="hljs-meta"># åˆ†è¯å¹¶è¿‡æ»¤åœç”¨è¯</span>
stopwords = <span class="hljs-keyword">set</span>()
<span class="hljs-function"><span class="hljs-keyword">with</span> <span class="hljs-title">open</span>(<span class="hljs-params"><span class="hljs-string">'stopwords.txt'</span>, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span></span>) <span class="hljs-keyword">as</span> f:  # åœç”¨è¯è¡¨
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:
        stopwords.<span class="hljs-title">add</span>(<span class="hljs-params">line.strip(</span>))

words</span> = [word <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> jieba.cut(all_requirements) 
         <span class="hljs-function"><span class="hljs-keyword">if</span> <span class="hljs-title">len</span>(<span class="hljs-params">word</span>) &gt; 1 <span class="hljs-keyword">and</span> word <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> stopwords <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> word.<span class="hljs-title">isspace</span>()]
word_str</span> = <span class="hljs-string">' '</span>.<span class="hljs-keyword">join</span>(words)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-16">2. ç”Ÿæˆè¯äº‘</h3>
<pre><code class="hljs language-ini" lang="ini">from wordcloud import WordCloud
import matplotlib.pyplot as plt

<span class="hljs-comment"># è®¾ç½®è¯äº‘å‚æ•°</span>
<span class="hljs-attr">wc</span> = WordCloud(
    <span class="hljs-attr">font_path</span>=<span class="hljs-string">'simhei.ttf'</span>,  <span class="hljs-comment"># ä¸­æ–‡å­—ä½“æ–‡ä»¶è·¯å¾„</span>
    <span class="hljs-attr">background_color</span>=<span class="hljs-string">'white'</span>,
    <span class="hljs-attr">width</span>=<span class="hljs-number">800</span>,
    <span class="hljs-attr">height</span>=<span class="hljs-number">600</span>,
    <span class="hljs-attr">max_words</span>=<span class="hljs-number">100</span>,
    <span class="hljs-attr">max_font_size</span>=<span class="hljs-number">100</span>
)

<span class="hljs-comment"># ç”Ÿæˆè¯äº‘</span>
wc.generate(word_str)

<span class="hljs-comment"># æ˜¾ç¤ºè¯äº‘</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>, <span class="hljs-number">8</span>))
plt.imshow(wc, <span class="hljs-attr">interpolation</span>=<span class="hljs-string">'bilinear'</span>)
plt.axis('off')
plt.savefig('zhaopin_wordcloud.png', <span class="hljs-attr">dpi</span>=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">'tight'</span>)
plt.show()
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-17">3. ç»“æœä¼˜åŒ–æŠ€å·§</h3>
<ul>
<li>
<p><strong>è°ƒæ•´å½¢çŠ¶</strong>ï¼šä½¿ç”¨å›¾ç‰‡è’™ç‰ˆï¼ˆéœ€Pillowåº“ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

mask = np.array(Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">"python_logo.png"</span>))
wc = WordCloud(mask=mask, ...)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
</li>
<li>
<p><strong>é¢œè‰²å®šåˆ¶</strong>ï¼šé€šè¿‡<code>colormap</code>å‚æ•°é€‰æ‹©matplotlibé…è‰²æ–¹æ¡ˆ</p>
</li>
<li>
<p><strong>è¯é¢‘ç»Ÿè®¡</strong>ï¼šç”¨<code>collections.Counter</code>æŸ¥çœ‹é«˜é¢‘è¯</p>
</li>
</ul>
<h2 data-id="heading-18">å…­ã€å®Œæ•´ä»£ç æ•´åˆ</h2>
<pre><code class="hljs language-ini" lang="ini">import requests
from bs4 import BeautifulSoup
import pandas as pd
import jieba
from wordcloud import WordCloud
import matplotlib.pyplot as plt
import time
import random

<span class="hljs-comment"># 1. æ•°æ®é‡‡é›†</span>
def get_job_list(keyword, page):
    <span class="hljs-attr">url</span> = f<span class="hljs-string">"https://sou.***.com/?kw={keyword}&amp;page={page}"</span>
    <span class="hljs-attr">headers</span> = {
        "User-Agent": "Mozilla/5.0...",
        "Referer": "https://www.***.com/"
    }
    try:
        <span class="hljs-attr">response</span> = requests.get(url, headers=headers, timeout=<span class="hljs-number">10</span>)
        if <span class="hljs-attr">response.status_code</span> == <span class="hljs-number">200</span>:
            <span class="hljs-attr">soup</span> = BeautifulSoup(response.text, <span class="hljs-string">'html.parser'</span>)
            <span class="hljs-attr">jobs</span> = []
            for li in soup.select('.job-list ul li'):
                <span class="hljs-comment"># è§£æé€»è¾‘åŒä¸Š...</span>
            return jobs
        return <span class="hljs-section">[]</span>
    except:
        return <span class="hljs-section">[]</span>

<span class="hljs-comment"># 2. æ•°æ®å¤„ç†</span>
def process_data(jobs_data):
    <span class="hljs-attr">df</span> = pd.DataFrame(jobs_data)
    <span class="hljs-attr">df</span> = df.dropna(subset=[<span class="hljs-string">'requirement'</span>])
    
    def extract_req(text):
        <span class="hljs-comment"># æå–é€»è¾‘åŒä¸Š...</span>
        pass
    
    df<span class="hljs-section">['clean_require']</span> = df<span class="hljs-section">['requirement']</span>.apply(extract_req)
    <span class="hljs-attr">all_text</span> = <span class="hljs-string">' '</span>.join(df[<span class="hljs-string">'clean_require'</span>].tolist())
    return all_text

<span class="hljs-comment"># 3. ç”Ÿæˆè¯äº‘</span>
def generate_wordcloud(text):
    <span class="hljs-attr">stopwords</span> = set([<span class="hljs-string">'å¯ä»¥'</span>, <span class="hljs-string">'èƒ½å¤Ÿ'</span>, <span class="hljs-string">'å…·æœ‰'</span>, <span class="hljs-string">'ç­‰'</span>])  <span class="hljs-comment"># ç¤ºä¾‹åœç”¨è¯</span>
    <span class="hljs-attr">words</span> = [word for word in jieba.cut(text) 
             if len(word) &gt; <span class="hljs-number">1</span> and word not in stopwords]
    
    <span class="hljs-attr">wc</span> = WordCloud(
        <span class="hljs-attr">font_path</span>=<span class="hljs-string">'simhei.ttf'</span>,
        <span class="hljs-attr">width</span>=<span class="hljs-number">800</span>,
        <span class="hljs-attr">height</span>=<span class="hljs-number">600</span>
    ).generate(' '.join(words))
    
    plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>, <span class="hljs-number">8</span>))
    plt.imshow(wc)
    plt.axis('off')
    plt.savefig('output.png')
    plt.show()

<span class="hljs-comment"># ä¸»æµç¨‹</span>
if <span class="hljs-attr">__name__</span> == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-attr">keyword</span> = <span class="hljs-string">"Pythonå¼€å‘"</span>
    <span class="hljs-attr">jobs</span> = []
    for page in range(1, 4):
        jobs.extend(get_job_list(keyword, page))
        time.sleep(2)
    
    <span class="hljs-attr">text</span> = process_data(jobs)
    generate_wordcloud(text)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-19">ä¸ƒã€å¸¸è§é—®é¢˜Q&amp;A</h2>
<p><strong>Q1ï¼šè¢«ç½‘ç«™å°IPæ€ä¹ˆåŠï¼Ÿ</strong><br/>
Aï¼šç«‹å³å¯ç”¨å¤‡ç”¨ä»£ç†æ± ï¼Œå»ºè®®ä½¿ç”¨ä½å®…ä»£ç†ï¼ˆå¦‚ç«™å¤§çˆ·IPä»£ç†ï¼‰ï¼Œé…åˆæ¯è¯·æ±‚æ›´æ¢IPç­–ç•¥ã€‚æ›´ç¨³å¦¥çš„æ–¹å¼æ˜¯è´­ä¹°ä»˜è´¹ä»£ç†æœåŠ¡ï¼Œè¿™ç±»ä»£ç†é€šå¸¸æœ‰æ›´é«˜çš„åŒ¿ååº¦å’Œç¨³å®šæ€§ã€‚</p>
<p><strong>Q2ï¼šå¦‚ä½•è·å–æ›´ç²¾å‡†çš„èŒä½æè¿°ï¼Ÿ</strong><br/>
Aï¼šæŸè”æ‹›è˜çš„HTMLç»“æ„å¯èƒ½å˜åŒ–ï¼Œå»ºè®®ï¼š</p>
<ol>
<li>æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·</li>
<li>åœ¨Elementsé¢æ¿æœç´¢å…³é”®è¯å¦‚"èŒè´£"</li>
<li>æ›´æ–°CSSé€‰æ‹©å™¨è·¯å¾„ï¼ˆå¦‚<code>.job-description &gt; p</code>ï¼‰</li>
</ol>
<p><strong>Q3ï¼šè¯äº‘ä¸­å‡ºç°æ— å…³è¯æ±‡æ€ä¹ˆè¿‡æ»¤ï¼Ÿ</strong><br/>
Aï¼šä¸‰æ­¥è§£å†³ï¼š</p>
<ol>
<li>æ‰©å……åœç”¨è¯è¡¨ï¼ˆæ·»åŠ "å·¥ä½œ"ã€"ç»éªŒ"ç­‰å¸¸è§è¯ï¼‰</li>
<li>åœ¨åˆ†è¯åæ·»åŠ è¯æ€§è¿‡æ»¤ï¼ˆä¿ç•™åè¯/åŠ¨è¯ï¼‰</li>
<li>è®¾ç½®<code>min_font_size</code>å‚æ•°è¿‡æ»¤ä½é¢‘è¯</li>
</ol>
<p><strong>Q4ï¼šå¦‚ä½•çˆ¬å–å…¶ä»–æ‹›è˜ç½‘ç«™ï¼Ÿ</strong><br/>
Aï¼šæ ¸å¿ƒæµç¨‹ç›¸åŒï¼Œéœ€æ³¨æ„ï¼š</p>
<ol>
<li>åˆ†æç›®æ ‡ç½‘ç«™çš„URLç»“æ„</li>
<li>è°ƒæ•´CSSé€‰æ‹©å™¨åŒ¹é…æ–°é¡µé¢</li>
<li>å¯èƒ½éœ€è¦å¤„ç†éªŒè¯ç ï¼ˆå»ºè®®ä½¿ç”¨æ‰“ç å¹³å°ï¼‰</li>
</ol>
<p><strong>Q5ï¼šä»£ç è¿è¡ŒæŠ¥é”™æ€ä¹ˆåŠï¼Ÿ</strong><br/>
Aï¼šæŒ‰è¿™ä¸ªé¡ºåºæ’æŸ¥ï¼š</p>
<ol>
<li>æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸</li>
<li>ç¡®è®¤ç›®æ ‡ç½‘ç«™æ˜¯å¦æ”¹ç‰ˆï¼ˆæ›´æ–°é€‰æ‹©å™¨ï¼‰</li>
<li>æŸ¥çœ‹å®Œæ•´é”™è¯¯ä¿¡æ¯ï¼ˆç”¨try-exceptæ•è·å¼‚å¸¸ï¼‰</li>
<li>åœ¨GitHubæœç´¢ç±»ä¼¼é”™è¯¯è§£å†³æ–¹æ¡ˆ</li>
</ol>
<h2 data-id="heading-20">å…«ã€è¿›é˜¶å»ºè®®</h2>
<ol>
<li><strong>å®šæ—¶ä»»åŠ¡</strong>ï¼šç”¨<code>schedule</code>åº“å®ç°æ¯å¤©è‡ªåŠ¨çˆ¬å–</li>
<li><strong>æ•°æ®å­˜å‚¨</strong>ï¼šå°†ç»“æœå­˜å…¥MySQL/MongoDB</li>
<li><strong>åˆ†ææ‰©å±•</strong>ï¼šç»Ÿè®¡ä¸åŒåŸå¸‚çš„æŠ€èƒ½éœ€æ±‚å·®å¼‚</li>
<li><strong>éƒ¨ç½²ä¸Šçº¿</strong>ï¼šç”¨Flaskæ­å»ºç®€å•æ•°æ®çœ‹æ¿</li>
</ol>
<p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œä½ ä¸ä»…æŒæ¡äº†ç½‘ç»œçˆ¬è™«å’Œæ•°æ®åˆ†æçš„åŸºæœ¬æŠ€èƒ½ï¼Œæ›´é‡è¦çš„æ˜¯å»ºç«‹äº†ä»æ•°æ®é‡‡é›†åˆ°ä»·å€¼è¾“å‡ºçš„å®Œæ•´æ€ç»´é“¾æ¡ã€‚ä¸‹æ¬¡é¢å¯¹æµ·é‡æ‹›è˜ä¿¡æ¯æ—¶ï¼Œä½ å°±å¯ä»¥ç”¨ä»£ç å¿«é€Ÿæç‚¼å…³é”®ä¿¡æ¯ï¼Œè®©æŠ€æœ¯çœŸæ­£æœåŠ¡äºå®é™…éœ€æ±‚ã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OceanBase å¹´åº¦å‘å¸ƒä¼š Hands-on AI Workshop å›é¡¾]]></title>    <link>https://juejin.cn/post/7577417823342100515</link>    <guid>https://juejin.cn/post/7577417823342100515</guid>    <pubDate>2025-11-28T07:56:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577417823342100515" data-draft-id="7577356848337813539" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OceanBase å¹´åº¦å‘å¸ƒä¼š Hands-on AI Workshop å›é¡¾"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-11-28T07:56:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è€çºªçš„æŠ€æœ¯å” å—‘å±€"/> <meta itemprop="url" content="https://juejin.cn/user/2394058441104739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OceanBase å¹´åº¦å‘å¸ƒä¼š Hands-on AI Workshop å›é¡¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2394058441104739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è€çºªçš„æŠ€æœ¯å” å—‘å±€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:56:29.000Z" title="Fri Nov 28 2025 07:56:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0"><strong>ç®€ä»‹</strong></h3>
<p>æœ¬æ¬¡ Workshop æ˜¯ OceanBase æ–°å“å‘å¸ƒä¼šæœŸé—´çš„ç‰¹åˆ«æ´»åŠ¨ï¼Œä¸»è¦å…³æ³¨å¦‚ä½•åŸºäº OceanBase seekdb å¿«é€Ÿæ„å»º AI åŸç”Ÿåº”ç”¨ã€‚æ´»åŠ¨æ‰“ç ´äº†å¸¸è§„çš„ PPT å®£è®²æ¨¡å¼ï¼Œé‡ç‚¹åœ¨äºä»£ç å®æ“ã€‚åœ¨æ¥è‡ª LangChain Communityã€Dify å’Œ OceanBase çš„æŠ€æœ¯ä¸“å®¶æŒ‡å¯¼ä¸‹ï¼Œç°åœºæ•°ç™¾åå¼€å‘è€…åœ¨ä¸¤å°æ—¶å†…ï¼ŒåŸºäº seekdb å®é™…åŠ¨æ‰‹å®Œæˆäº†ä»ç¯å¢ƒéƒ¨ç½²ã€Agentic RAG æ­å»ºåˆ°æ„å»ºå…·å¤‡â€œé•¿æœŸè®°å¿†â€æ™ºèƒ½ä½“çš„å®Œæ•´å¼€å‘æµç¨‹ã€‚</p>
<p>ç°åœºå°ä¼™ä¼´ç›´è§‚æ„Ÿå—åˆ°äº†å…·å¤‡åŸç”Ÿ AI èƒ½åŠ›çš„è½»é‡æ•°æ®åº“æ˜¯å¦‚ä½•æœ‰æ•ˆé™ä½åº”ç”¨å¼€å‘é—¨æ§›çš„ã€‚æœ¬æ–‡å°†è¯¦ç»†å›é¡¾è¿™åœºå®æˆ˜ Workshopã€‚</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/jpeg/32756313/1764316026243-adc1b9c9-3311-4737-95ad-29d41548fc49.jpeg" alt="" loading="lazy"/></p>
<h3 data-id="heading-1"><strong>ä¸€ã€OceanBase seekdb ä»‹ç»</strong></h3>
<p>æœ¬æ¬¡ Workshop çš„æ‰€æœ‰å®éªŒå‡åŸºäº <strong>OceanBase seekdb</strong> è¿›è¡Œï¼Œè¿™æ˜¯ OceanBase æ¨å‡ºçš„é¢å‘ AI åº”ç”¨åœºæ™¯çš„è½»é‡åµŒå…¥å¼æ•°æ®åº“ã€‚</p>
<p><strong>è§£å†³ä»€ä¹ˆé—®é¢˜</strong>ï¼Ÿåœ¨ç›®å‰çš„ AI åº”ç”¨å¼€å‘æ¶æ„ä¸­ï¼Œå¼€å‘è€…é€šå¸¸éœ€è¦åŒæ—¶ç»´æŠ¤å…³ç³»å‹æ•°æ®åº“ï¼ˆå­˜å‚¨ç»“æ„åŒ–æ•°æ®ï¼‰å’Œå‘é‡æ•°æ®åº“ï¼ˆå­˜å‚¨éç»“æ„åŒ–å‘é‡æ•°æ®ï¼‰ã€‚è¿™ç§æ¶æ„ä¸ä»…å¸¦æ¥äº†è¾ƒé«˜çš„æ•°æ®ä¸€è‡´æ€§ç»´æŠ¤æˆæœ¬ï¼Œè¿˜å¯èƒ½äº§ç”Ÿè·¨ç³»ç»ŸæŸ¥è¯¢çš„å»¶è¿Ÿã€‚seekdb çš„è®¾è®¡ç›®æ ‡æ˜¯å®ç°â€œç»“æ„åŒ–æ•°æ®â€ä¸â€œéç»“æ„åŒ–å‘é‡æ•°æ®â€çš„ç»Ÿä¸€å­˜å‚¨ä¸æ£€ç´¢ï¼Œå¹¶ä»¥ 1C2G è½»é‡çš„æ–¹å¼ç®€åŒ– AI åº”ç”¨çš„æ•°æ®æ¶æ„ã€‚</p>
<h3 data-id="heading-2"><strong>äºŒã€Workshop ç¯å¢ƒé…ç½®ç¯å¢ƒæŒ‡å—</strong></h3>
<p>Workshop çš„ç¬¬ä¸€ä¸ªç¯èŠ‚æ˜¯åŸºç¡€ç¯å¢ƒé…ç½®ã€‚ç°åœºä¸ºäº†è§„é¿ Wi-Fi ç½‘ç»œé«˜å¹¶å‘å¯èƒ½å¸¦æ¥çš„å»¶è¿Ÿï¼Œæˆ‘ä»¬ä¸ºæ¯ä½å‚ä¼šè€…éƒ½å‡†å¤‡äº†é˜¿é‡Œäº‘ ECS äº‘æœåŠ¡å™¨ä½œä¸ºå®éªŒç¯å¢ƒã€‚ä»¥ä¸‹æ˜¯æœ¬åœ°ç”µè„‘(Mac/Windows)è¯¦ç»†å®‰è£…æµç¨‹(ä»¥ CLI ä¸ºä¸»ï¼‰ï¼š</p>
<ol>
<li>Docker (ç”¨äºä¸‰ä¸ªå®éªŒ)
Mac: ä¸‹è½½ Docker Desktop å¹¶å®‰è£…ã€‚
Windows: åŒæ ·ä¸‹è½½ Docker Desktopï¼Œéœ€å¼€å¯ WSL2ï¼Œå®‰è£…åå¯åŠ¨ Docker åº”ç”¨ã€‚</li>
<li>Python 3.10+ (ç”¨äºä¸‰ä¸ªå®éªŒ)
ä¸‹è½½ Python å®˜æ–¹å®‰è£…åŒ… è¿›è¡Œå®‰è£…ã€‚
å®‰è£…å®Œæˆåæ£€æŸ¥ï¼š</li>
</ol>
<pre><code class="hljs language-plain" lang="plain">python --version # åº”è¾“å‡º 3.10 æˆ–æ›´é«˜
</code></pre>
<ol start="3">
<li>uv (Python åŒ…ç®¡ç†å™¨)</li>
</ol>
<pre><code class="hljs language-plain" lang="plain">pip install uv
</code></pre>
<ol start="4">
<li>seekdb (ç”¨äºä¸‰ä¸ªå®éªŒ)</li>
</ol>
<p>æˆ‘ä»¬å°†ä½¿ç”¨ Docker å¿«é€Ÿå¯åŠ¨ä¸€ä¸ª seekdb å®ä¾‹ã€‚é’ˆå¯¹å›½å†…ç½‘ç»œç¯å¢ƒå’Œä¸åŒçš„èŠ¯ç‰‡æ¶æ„ï¼Œæä¾›äº†ç›¸åº”çš„é•œåƒæºã€‚</p>
<pre><code class="hljs language-plain" lang="plain"># è·å–docker é•œåƒ
docker pull swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/oceanbase/seekdb:latest
docker tag  swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/oceanbase/seekdb:latest  docker.io/oceanbase/seekdb:latest

# armæœºå™¨
docker pull swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/oceanbase/seekdb:latest-linuxarm64
docker tag  swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/oceanbase/seekdb:latest-linuxarm64  docker.io/oceanbase/seekdb:latest

# æ–¹å¼ä¸€: docker æ–¹å¼å®‰è£…
docker run -d \
  --name seekdb \
  -p 2881:2881 \
  -v ./data:/var/lib/oceanbase/store \
  oceanbase/seekdb:latest
</code></pre>
<ol start="5">
<li>powermem (ç”¨äºå®éªŒä¸‰)</li>
</ol>
<pre><code class="hljs language-plain" lang="plain">pip install powermem
</code></pre>
<ol start="6">
<li>Dify(ç”¨äºå®éªŒäºŒ)</li>
</ol>
<pre><code class="hljs language-plain" lang="plain">git clone https://github.com/langgenius/dify.git
cd dify/docker
docker-compose up -d
</code></pre>
<ol start="7">
<li>Jupyter(ç”¨äºå®éªŒä¸€)</li>
</ol>
<pre><code class="hljs language-plain" lang="plain">pip install jupyter
</code></pre>
<ol start="8">
<li>Qoder:  ä¸‹è½½: <a href="https://link.juejin.cn?target=https%3A%2F%2Fqoder.com%2Fdownload" target="_blank" title="https://qoder.com/download" ref="nofollow noopener noreferrer">qoder.com/download</a> (é€‰æ‹©é€‚åˆè‡ªå·±çš„ç”µè„‘çš„qoderåŒ…ä¸‹è½½ï¼Œè¯·æ³¨æ„ qoder éœ€è¦æ³¨å†Œæ–¹å¯ä½¿ç”¨ã€‚ï¼‰</li>
</ol>
<h3 data-id="heading-3"><strong>ä¸‰ã€åŸºäº LangChain V1 å’Œ OceanBase seekdb</strong></h3>
<h3 data-id="heading-4"><strong>å¿«é€Ÿæ„å»º Agentic RAG</strong></h3>
<p>è®²å¸ˆï¼šLangChain Ambassador å¼ æµ·ç«‹</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/jpeg/32756313/1764316026098-cab726cf-8dda-4e3c-aca7-d2b3dcfb64a9.jpeg" alt="" loading="lazy"/></p>
<p>æœ¬å®éªŒåŸºäº <strong>LangChain v1</strong> çš„æœ€æ–° Agent æ„å»ºæ ‡å‡†å’Œ <strong>OceanBase seekdb</strong> çš„å‘é‡å­˜å‚¨å’Œæ··åˆæ£€ç´¢èƒ½åŠ›ï¼Œè®© AI è¯»æ‡‚ä¸€ä»½ Nike 2023 è´¢æŠ¥ï¼ˆPDFï¼‰ï¼Œå¹¶èƒ½å›ç­”ç›¸å…³è´¢åŠ¡é—®é¢˜ã€‚ <strong>æ ¸å¿ƒé€»è¾‘ï¼š</strong> æ–‡æ¡£åˆ‡ç‰‡ -&gt; å­˜å…¥ seekdb -&gt; å°è£…ä¸º Tool -&gt; ç»‘å®š Agentã€‚</p>
<ul>
<li>å°†ä¸€ä»½éç»“æ„åŒ–çš„ Nike 2023 è´¢æŠ¥ PDF æ–‡æ¡£è½¬åŒ–ä¸ºè®¡ç®—æœºå¯ç†è§£çš„å‘é‡æ•°æ®</li>
<li>é€šè¿‡å®šä¹‰æ£€ç´¢å·¥å…·å¹¶è°ƒç”¨ LangChain v1 çš„ <code>create_agent</code> æ¥å£ï¼Œæ‰“é€ å…·å¤‡<strong>æ¨ç†èƒ½åŠ›</strong>çš„ AI Agentã€‚</li>
</ul>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/32756313/1764316026163-548e82b3-a30f-4861-946d-85631962196d.png" alt="" loading="lazy"/></p>
<h5 data-id="heading-5"><strong>æ ¸å¿ƒæ“ä½œæ­¥éª¤</strong></h5>
<p><strong>æ­¥éª¤ 1ï¼šæ–‡æ¡£å¤„ç†ä¸å‘é‡åŒ–</strong> é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°† PDF æ–‡æ¡£åŠ è½½å¹¶åˆ‡å‰²æˆé€‚åˆæ¨¡å‹å¤„ç†çš„å°å—ï¼ˆChunksï¼‰ã€‚ åœ¨ LangChain ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>PyPDFLoader</code> åŠ è½½æ–‡æ¡£ï¼Œç„¶åä½¿ç”¨ <code>RecursiveCharacterTextSplitter</code> è¿›è¡Œåˆ‡åˆ†ã€‚</p>
<pre><code class="hljs language-plain" lang="plain">from langchain_community.vectorstores import OceanBase

# åˆå§‹åŒ– OceanBase å‘é‡å­˜å‚¨
docsearch = OceanBase.from_documents(
    documents, 
    embeddings, 
    connection_string="127.0.0.1:2881..."
)
</code></pre>
<p>è¿™ä¸€æ­¥åœ¨åå°ï¼Œseekdb ä¼šè‡ªåŠ¨åˆ›å»ºä¸€å¼ è¡¨ï¼Œå¹¶å°†æ–‡æœ¬çš„å‘é‡ï¼ˆEmbedding Vectorï¼‰å’ŒåŸå§‹å†…å®¹å­˜å‚¨åœ¨åŒä¸€è¡Œè®°å½•ä¸­ã€‚</p>
<p><strong>æ­¥éª¤ 2ï¼šæ„å»ºæ£€ç´¢å·¥å…·</strong> æˆ‘ä»¬å°†ä¸Šä¸€æ­¥ç”Ÿæˆçš„ <code>docsearch</code> å°è£…ä¸ºä¸€ä¸ª LangChain Toolã€‚</p>
<pre><code class="hljs language-plain" lang="plain">retriever_tool = create_retriever_tool(
    docsearch.as_retriever(),
    "nike_financial_report",
    "æœç´¢å¹¶è¿”å›å…³äº Nike 2023 è´¢æŠ¥çš„è¯¦ç»†ä¿¡æ¯ã€‚"
)
</code></pre>
<p>æ³¨æ„ <code>description</code> å‚æ•°éå¸¸é‡è¦ï¼ŒLLM ä¼šæ ¹æ®è¿™æ®µæè¿°æ¥åˆ¤æ–­ä½•æ—¶è°ƒç”¨è¿™ä¸ªå·¥å…·ã€‚</p>
<p><strong>æ­¥éª¤ 3ï¼šåˆå§‹åŒ– Agent å¹¶æ‰§è¡Œ</strong> ä½¿ç”¨ LangChain V1 çš„ <code>create_tool_calling_agent</code> æ¥å£ï¼Œå°† LLMï¼ˆå¦‚ GPT-4 æˆ–é€šä¹‰åƒé—®ï¼‰ä¸æˆ‘ä»¬å®šä¹‰çš„å·¥å…·ç»‘å®šã€‚</p>
<p>è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fask.oceanbase.com%2Ft%2Ftopic%2F35634850" target="_blank" title="https://ask.oceanbase.com/t/topic/35634850" ref="nofollow noopener noreferrer">ask.oceanbase.com/t/topic/356â€¦</a></p>
<h3 data-id="heading-6"><strong>å››ã€åŸºäº Dify å’Œ OceanBaseï¼Œå¿«é€Ÿæ„å»º AI åº”ç”¨</strong></h3>
<p>è®²å¸ˆï¼šéƒ‘ç«‹ï¼ŒSr. Developer Relations, Dify</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/jpeg/32756313/1764316025998-dd697c4b-e177-4949-95b7-ab551a29cf65.jpeg" alt="" loading="lazy"/></p>
<p>æœ¬å®éªŒæ—¨åœ¨éªŒè¯ OceanBase seekdb å¯¹ AI åº”ç”¨çš„ä¸€ä½“åŒ–æ”¯æ’‘èƒ½åŠ›ã€‚é€šè¿‡éƒ¨ç½² seekdb å¹¶ä¿®æ”¹ Dify æ ¸å¿ƒé…ç½®ï¼Œå°†åŸæœ¬åˆ†ç¦»çš„å‘é‡åº“ä¸å…ƒæ•°æ®åº“ç»Ÿä¸€æ›¿æ¢ä¸º seekdbã€‚åœ¨ç®€åŒ–æ¶æ„çš„åŒæ—¶ï¼ŒéªŒè¯åœ¨ RAG åœºæ™¯ä¸‹çš„å®Œæ•´å¯ç”¨æ€§ã€‚</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/32756313/1764316026165-93202818-adb1-4536-b933-2aac8ae5277e.png" alt="" loading="lazy"/></p>
<h5 data-id="heading-7"><strong>æ ¸å¿ƒæ“ä½œæ­¥éª¤</strong></h5>
<p><strong>æ­¥éª¤ 1ï¼šä¿®æ”¹ Docker Compose é…ç½®</strong> è¿›å…¥ Dify çš„ <code>docker</code> ç›®å½•ï¼Œç¼–è¾‘ <code>.env</code> æ–‡ä»¶æˆ– <code>docker-compose.yaml</code>ã€‚éœ€è¦å°† Dify çš„æ•°æ®åº“è¿æ¥æŒ‡å‘æˆ‘ä»¬å¯åŠ¨çš„ seekdb å®¹å™¨ã€‚</p>
<p><strong>æ­¥éª¤ 2ï¼šé…ç½®å‘é‡åç«¯</strong> åœ¨ Dify çš„ç³»ç»Ÿè®¾ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡ä¸­ï¼Œå°† Vector Store çš„ç±»å‹æŒ‡å®šä¸º <code>OceanBase</code>ã€‚å½“ç”¨æˆ·åœ¨ Dify ç•Œé¢ä¸Šä¼ çŸ¥è¯†åº“æ–‡ä»¶æ—¶ï¼ŒDify ä¼šå°†åˆ‡ç‰‡åçš„å‘é‡æ•°æ®å†™å…¥ seekdb çš„å‘é‡è¡¨ä¸­ã€‚</p>
<p><strong>æ­¥éª¤ 3ï¼šæ„å»ºçŸ¥è¯†åº“åº”ç”¨</strong> é‡å¯ Dify å®¹å™¨ç»„åï¼Œè¿›å…¥ Web ç•Œé¢ï¼š</p>
<p>è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fask.oceanbase.com%2Ft%2Ftopic%2F35634856" target="_blank" title="https://ask.oceanbase.com/t/topic/35634856" ref="nofollow noopener noreferrer">ask.oceanbase.com/t/topic/356â€¦</a></p>
<h3 data-id="heading-8"><strong>äº”ã€è®© AI è®°ä½ä½ ï¼ŒåŸºäº OceanBase æ„å»ºå…·å¤‡ä¸Šä¸‹æ–‡è®°å¿†çš„æ™ºèƒ½ä½“å®è·µ</strong></h3>
<p>è®²å¸ˆï¼šæ±¤åº† OceanBase æŠ€æœ¯ä¸“å®¶</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/jpeg/32756313/1764316026668-2d87f189-d25d-4b1e-ae54-fce75f62842c.jpeg" alt="" loading="lazy"/></p>
<p>æœ¬å®éªŒæ ¸å¿ƒç›®æ ‡æ˜¯è§£å†³ AI æ™ºèƒ½ä½“â€œé—å¿˜â€å¯¹è¯ä¸Šä¸‹æ–‡çš„é—®é¢˜ã€‚é€šè¿‡é›†æˆ <strong>OceanBase seekdb</strong> ä½œä¸ºå‘é‡ä¸ç»“æ„åŒ–æ•°æ®çš„æ··åˆå­˜å‚¨åº•åº§ï¼Œå¹¶ä½¿ç”¨ <strong>PowerMem</strong> è¿›è¡Œè®°å¿†ç®¡ç†ï¼Œå±•ç¤ºäº†å¦‚ä½•è®© AI æ‹¥æœ‰â€œé•¿æœŸè®°å¿†â€ã€‚</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/32756313/1764316062121-803695fb-31e9-486c-b57e-02b1fb2bead9.png" alt="" loading="lazy"/></p>
<p><strong>æ­¥éª¤ 1ï¼šéƒ¨ç½² PowerMemï¼ŒDify + PowerMem MCP ç¯å¢ƒé›†æˆ</strong>ï¼Œæˆ‘ä»¬åœ¨ Dify ç¯å¢ƒä¸­é…ç½® PowerMem MCPï¼Œæ‰“é€šåº•å±‚è®°å¿†é€šé“ã€‚è¿™ä¸€æ­¥ä¹Ÿä½¿å…¶å…·å¤‡äº†è®¿é—® OceanBase seekdb è¿›è¡Œé•¿ä¹…è®°å¿†å­˜å‚¨ä¸æ£€ç´¢çš„èƒ½åŠ›ã€‚</p>
<p><strong>æ­¥éª¤ 2ï¼šVibe Coding æŒ‘æˆ˜</strong>ï¼Œæˆ‘ä»¬å°†ä¸€æ®µæç¤ºè¯å¤åˆ¶åˆ° AI ç¼–ç¨‹åŠ©æ‰‹ <strong>Qoder</strong> ä¸­ï¼Œè¦æ±‚å®ƒå‚ç…§ PowerMem çš„å®˜æ–¹ç¤ºä¾‹ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€å¥—ä»£ç å®¡æŸ¥æ™ºèƒ½ä½“ã€‚</p>
<p>è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fask.oceanbase.com%2Ft%2Ftopic%2F35634483" target="_blank" title="https://ask.oceanbase.com/t/topic/35634483" ref="nofollow noopener noreferrer">ask.oceanbase.com/t/topic/356â€¦</a></p>
<h2 data-id="heading-9"><strong>æœ€å</strong></h2>
<p>é€šè¿‡ä¸Šè¿°ä¸‰ä¸ªå®éªŒï¼Œæˆ‘ä»¬ä»ä¸åŒç»´åº¦éªŒè¯äº† OceanBase seekdb åœ¨ AI åº”ç”¨å¼€å‘ä¸­çš„å®é™…èƒ½åŠ›ã€‚æœ¬æ¬¡ Workshop åªæ˜¯ä¸€ä¸ªèµ·ç‚¹ã€‚seekdb çš„è½»é‡åŒ–å’Œæ˜“ç”¨æ€§ï¼Œæ—¨åœ¨è®©æ¯ä¸€ä½å¼€å‘è€…éƒ½èƒ½åœ¨è‡ªå·±çš„ç¬”è®°æœ¬ä¸Šï¼Œä»¥æœ€ä½çš„æˆæœ¬æ¢ç´¢ AI åŸç”Ÿåº”ç”¨çš„å¼€å‘ã€‚</p>
<p>åœ¨æ­¤ï¼Œæˆ‘ä»¬è¦ç‰¹åˆ«è‡´è°¢å‚ä¸æœ¬æ¬¡ç¤¾åŒºç”Ÿæ€å…±å»ºçš„å¼€æºä¼™ä¼´ï¼Œæ„Ÿè°¢ Dify, LangChain Community, Qoder çš„é¼åŠ›æ”¯æŒï¼Œæ„Ÿè°¢æ¯ä¸€ä½å‚ä¸çš„å¼€å‘è€…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[3å°æ—¶å¿«é€Ÿé›†æˆï¼šç”¨Node.js + æ˜ŸæAPIä¸ºä½ çš„SaaSé¡¹ç›®æ·»åŠ è·¨å¢ƒæ”¶æ¬¾åŠŸèƒ½]]></title>    <link>https://juejin.cn/post/7577321767347093550</link>    <guid>https://juejin.cn/post/7577321767347093550</guid>    <pubDate>2025-11-28T06:27:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577321767347093550" data-draft-id="7577321767347060782" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="3å°æ—¶å¿«é€Ÿé›†æˆï¼šç”¨Node.js + æ˜ŸæAPIä¸ºä½ çš„SaaSé¡¹ç›®æ·»åŠ è·¨å¢ƒæ”¶æ¬¾åŠŸèƒ½"/> <meta itemprop="keywords" content="è¿è¥,æ˜é‡‘æ—¥æŠ¥"/> <meta itemprop="datePublished" content="2025-11-28T06:27:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜Ÿæäº’è”"/> <meta itemprop="url" content="https://juejin.cn/user/1370462103538153"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            3å°æ—¶å¿«é€Ÿé›†æˆï¼šç”¨Node.js + æ˜ŸæAPIä¸ºä½ çš„SaaSé¡¹ç›®æ·»åŠ è·¨å¢ƒæ”¶æ¬¾åŠŸèƒ½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1370462103538153/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜Ÿæäº’è”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:27:00.000Z" title="Fri Nov 28 2025 06:27:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œä¸ºå…¨æ ˆå¼€å‘è€…ï¼Œå½“ä½ äº§å“çš„ç¬¬ä¸€ä¸ªå›½é™…å®¢æˆ·è¯¢é—®â€œèƒ½å¦ç”¨ä¿¡ç”¨å¡æ”¯ä»˜ï¼Ÿâ€æ—¶ï¼Œä½ çŸ¥é“æ˜¯æ—¶å€™ä¸ºä½ çš„SaaSé¡¹ç›®é›†æˆè·¨å¢ƒæ”¶æ¬¾äº†ã€‚åˆ«æ‹…å¿ƒï¼Œè¿™å¹¶ä¸éœ€è¦æ•°æœˆä¹‹ä¹…ã€‚åˆ©ç”¨<strong>æ˜ŸæAPI</strong>å’Œä½ ç†Ÿæ‚‰çš„<strong>Node.js</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<strong>3å°æ—¶å†…</strong>æ­å»ºä¸€ä¸ªå¥å£®çš„ç”Ÿäº§çº§æ”¯ä»˜é›†æˆã€‚</p>
<p>æœ¬æ•™ç¨‹å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œå®Œæˆä»åˆ›å»ºæ”¯ä»˜è®¢å•åˆ°å®‰å…¨æ¥æ”¶æ”¯ä»˜é€šçŸ¥çš„å®Œæ•´æµç¨‹ã€‚</p>
<h4 data-id="heading-0"><strong>ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œï¼ˆ15åˆ†é’Ÿï¼‰</strong></h4>
<ol>
<li>
<p><strong>æ³¨å†Œæ˜Ÿæè´¦å·</strong>ï¼šè®¿é—®æ˜Ÿæå®˜ç½‘ï¼Œæ³¨å†Œå•†æˆ·è´¦å·å¹¶å®Œæˆä¼ä¸šè®¤è¯ã€‚</p>
</li>
<li>
<p><strong>è·å–APIå¯†é’¥</strong>ï¼šåœ¨å¼€å‘è€…åå°ï¼Œä½ å°†è·å¾—ä¸¤ä¸ªå…³é”®ä¿¡æ¯ï¼š</p>
<ul>
<li><code>API_KEY</code>ï¼šç”¨äºèº«ä»½éªŒè¯çš„å¯†é’¥ã€‚</li>
<li><code>WEBHOOK_SECRET</code>ï¼šç”¨äºéªŒè¯Webhookè¯·æ±‚ç­¾åçš„å¯†é’¥ã€‚</li>
</ul>
</li>
<li>
<p><strong>åˆå§‹åŒ–Node.jsé¡¹ç›®</strong>ï¼š</p>
<p>bash</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> payment-integration &amp;&amp; <span class="hljs-built_in">cd</span> payment-integration
npm init -y
npm install express axios crypto
</code></pre>
</li>
</ol>
<h4 data-id="heading-1"><strong>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ”¯ä»˜è®¢å•ï¼ˆæ ¸å¿ƒä»£ç ï¼Œ45åˆ†é’Ÿï¼‰</strong></h4>
<p>æˆ‘ä»¬åœ¨æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªAPIç«¯ç‚¹ï¼Œç”¨äºå‘æ˜Ÿæå‘èµ·æ”¯ä»˜è¯·æ±‚ã€‚</p>
<p><strong>ä»£ç ç‰‡æ®µï¼š<code>server.js</code></strong></p>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>);
<span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_BASE_URL</span> = <span class="hljs-string">'https://api.starsee.io/v1'</span>; <span class="hljs-comment">// æ˜ŸæAPIåœ°å€</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_KEY</span> = <span class="hljs-string">'your_api_key_here'</span>; <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„API_KEY</span>

<span class="hljs-comment">// åˆ›å»ºæ”¯ä»˜è®¢å•æ¥å£</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/create-payment'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> paymentPayload = {
      <span class="hljs-attr">amount</span>: <span class="hljs-number">1999</span>, <span class="hljs-comment">// é‡‘é¢ï¼ˆå•ä½ï¼šåˆ†ï¼Œä¾‹å¦‚$19.99ï¼‰</span>
      <span class="hljs-attr">currency</span>: <span class="hljs-string">'USD'</span>, <span class="hljs-comment">// è´§å¸ä»£ç </span>
      <span class="hljs-attr">order_id</span>: <span class="hljs-string">`ORDER_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>, <span class="hljs-comment">// ä½ çš„ç³»ç»Ÿå†…å”¯ä¸€è®¢å•å·</span>
      <span class="hljs-attr">product_name</span>: <span class="hljs-string">'Pro Plan Subscription'</span>,
      <span class="hljs-attr">customer</span>: {
        <span class="hljs-attr">email</span>: <span class="hljs-string">'customer@example.com'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'John Doe'</span>
      },
      <span class="hljs-attr">success_url</span>: <span class="hljs-string">'https://yourapp.com/success'</span>, <span class="hljs-comment">// æ”¯ä»˜æˆåŠŸè·³è½¬åœ°å€</span>
      <span class="hljs-attr">cancel_url</span>: <span class="hljs-string">'https://yourapp.com/cancel'</span>   <span class="hljs-comment">// æ”¯ä»˜å–æ¶ˆè·³è½¬åœ°å€</span>
    };

    <span class="hljs-comment">// è°ƒç”¨æ˜ŸæAPIåˆ›å»ºæ”¯ä»˜ä¼šè¯</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">`<span class="hljs-subst">${API_BASE_URL}</span>/payment_links`</span>, paymentPayload, {
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${API_KEY}</span>`</span>,
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
      }
    });

    <span class="hljs-comment">// è¿”å›æ”¯ä»˜é“¾æ¥ç»™å‰ç«¯ï¼Œå¼•å¯¼ç”¨æˆ·è·³è½¬</span>
    res.<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">payment_url</span>: response.<span class="hljs-property">data</span>.<span class="hljs-property">payment_url</span> <span class="hljs-comment">// ç”¨æˆ·åœ¨æ­¤å®Œæˆæ”¯ä»˜</span>
    });

  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// é”™è¯¯å¤„ç†æœ€ä½³å®è·µ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Error creating payment:'</span>, error.<span class="hljs-property">response</span>?.<span class="hljs-property">data</span> || error.<span class="hljs-property">message</span>);
    
    <span class="hljs-comment">// æ ¹æ®æ˜ŸæAPIè¿”å›çš„é”™è¯¯ç è¿›è¡Œç²¾ç»†åŒ–å¤„ç†</span>
    <span class="hljs-keyword">const</span> statusCode = error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span>;
    <span class="hljs-keyword">let</span> userMessage = <span class="hljs-string">'Payment system is temporarily unavailable.'</span>;

    <span class="hljs-keyword">if</span> (statusCode &gt;= <span class="hljs-number">400</span> &amp;&amp; statusCode &lt; <span class="hljs-number">500</span>) {
      <span class="hljs-comment">// å®¢æˆ·ç«¯é”™è¯¯ï¼šå¦‚å‚æ•°é”™è¯¯ã€èº«ä»½éªŒè¯å¤±è´¥</span>
      userMessage = <span class="hljs-string">'Invalid payment request. Please check your information.'</span>;
    }
    <span class="hljs-comment">// 5xxé”™è¯¯æˆ‘ä»¬å·²è®°å½•ï¼Œè¿”å›é€šç”¨é”™è¯¯ä¿¡æ¯</span>

    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">message</span>: userMessage
    });
  }
});

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">3000</span>;
app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Server running on port <span class="hljs-subst">${PORT}</span>`</span>));
</code></pre>
<p><strong>å‰ç«¯è°ƒç”¨ç¤ºä¾‹ï¼ˆç®€å•ç‰ˆï¼‰ï¼š</strong><br/>
å‰ç«¯åªéœ€è°ƒç”¨ä½ è‡ªå·±çš„Â <code>/api/create-payment</code>Â æ¥å£ï¼Œç„¶åè·³è½¬è‡³è¿”å›çš„Â <code>payment_url</code>Â å³å¯ã€‚</p>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯ä»£ç  (ä¾‹å¦‚Reactç»„ä»¶)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handlePayment</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/create-payment'</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span> });
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    
    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">success</span>) {
      <span class="hljs-comment">// è·³è½¬åˆ°æ˜Ÿææ”¯ä»˜é¡µé¢</span>
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = data.<span class="hljs-property">payment_url</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">alert</span>(data.<span class="hljs-property">message</span>);
    }
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-title function_">alert</span>(<span class="hljs-string">'Failed to initiate payment.'</span>);
  }
}
</code></pre>
<h4 data-id="heading-2"><strong>ç¬¬ä¸‰æ­¥ï¼šå¤„ç†Webhookï¼ˆæ”¯ä»˜é€šçŸ¥ï¼Œ60åˆ†é’Ÿï¼‰</strong></h4>
<p>ç”¨æˆ·æ”¯ä»˜æˆåŠŸåï¼Œæ˜Ÿæä¼šé€šè¿‡Webhookå¼‚æ­¥é€šçŸ¥ä½ çš„æœåŠ¡å™¨ã€‚è¿™æ˜¯<strong>ç¡®ä¿è®¢å•çŠ¶æ€æœ€ç»ˆä¸€è‡´æ€§çš„å…³é”®</strong>ï¼Œæ¯”ä¾èµ–å‰ç«¯å›è°ƒæ›´å¯é ã€‚</p>
<p><strong>ä»£ç ç‰‡æ®µï¼šåœ¨<code>server.js</code>ä¸­æ·»åŠ </strong></p>
<p>javascript</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¤„ç†æ˜ŸæWebhook</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/webhook/starsee'</span>, express.<span class="hljs-title function_">raw</span>({<span class="hljs-attr">type</span>: <span class="hljs-string">'application/json'</span>}), <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">WEBHOOK_SECRET</span> = <span class="hljs-string">'your_webhook_secret_here'</span>; <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„WEBHOOK_SECRET</span>

  <span class="hljs-keyword">const</span> signature = req.<span class="hljs-property">headers</span>[<span class="hljs-string">'x-starsee-signature'</span>];
  <span class="hljs-keyword">const</span> payload = req.<span class="hljs-property">body</span>;

  <span class="hljs-comment">// **å®‰å…¨å…³é”®ï¼šéªŒè¯Webhookè¯·æ±‚æ¥æº**</span>
  <span class="hljs-keyword">const</span> expectedSignature = crypto
    .<span class="hljs-title function_">createHmac</span>(<span class="hljs-string">'sha256'</span>, <span class="hljs-variable constant_">WEBHOOK_SECRET</span>)
    .<span class="hljs-title function_">update</span>(payload)
    .<span class="hljs-title function_">digest</span>(<span class="hljs-string">'hex'</span>);

  <span class="hljs-keyword">if</span> (signature !== expectedSignature) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Invalid webhook signature.'</span>);
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">401</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'Invalid signature'</span>);
  }

  <span class="hljs-comment">// ç­¾åéªŒè¯é€šè¿‡ï¼Œè§£æ payload</span>
  <span class="hljs-keyword">const</span> event = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(payload.<span class="hljs-title function_">toString</span>());

  <span class="hljs-comment">// å¤„ç†ä¸åŒçš„äº‹ä»¶ç±»å‹</span>
  <span class="hljs-keyword">switch</span> (event.<span class="hljs-property">type</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'payment.succeeded'</span>:
      <span class="hljs-comment">// æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼šæ”¯ä»˜æˆåŠŸ</span>
      <span class="hljs-keyword">const</span> { order_id, payment_id, amount } = event.<span class="hljs-property">data</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Order <span class="hljs-subst">${order_id}</span> (Payment: <span class="hljs-subst">${payment_id}</span>) paid <span class="hljs-subst">${amount}</span> successfully.`</span>);
      
      <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> æ›´æ–°ä½ æ•°æ®åº“ä¸­çš„è®¢å•çŠ¶æ€</span>
      <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> å‘é€ç¡®è®¤é‚®ä»¶ã€å¼€é€šæœåŠ¡æƒé™ç­‰</span>
      <span class="hljs-keyword">break</span>;

    <span class="hljs-keyword">case</span> <span class="hljs-string">'payment.failed'</span>:
      <span class="hljs-comment">// å¤„ç†æ”¯ä»˜å¤±è´¥é€»è¾‘</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Payment for order <span class="hljs-subst">${event.data.order_id}</span> failed.`</span>);
      <span class="hljs-keyword">break</span>;

    <span class="hljs-attr">default</span>:
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Unhandled event type: <span class="hljs-subst">${event.<span class="hljs-keyword">type</span>}</span>`</span>);
  }

  <span class="hljs-comment">// æˆåŠŸå¤„ç†ï¼Œè¿”å›200çŠ¶æ€ç </span>
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">received</span>: <span class="hljs-literal">true</span> });
});
</code></pre>
<p><strong>Webhooké…ç½®æŒ‡å—ï¼š</strong></p>
<ol>
<li>åœ¨æ˜Ÿæå¼€å‘è€…åå°ï¼Œé…ç½®ä½ çš„Webhook URLï¼ˆä¾‹å¦‚Â <code>https://yourdomain.com/api/webhook/starsee</code>ï¼‰ã€‚</li>
<li><strong>åŠ¡å¿…ä½¿ç”¨<code>express.raw</code>ä¸­é—´ä»¶</strong>ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åŸå§‹çš„è¯·æ±‚ä½“æ¥è®¡ç®—ç­¾åã€‚</li>
<li><strong>ç­¾åéªŒè¯æ˜¯å¿…é¡»çš„</strong>ï¼Œå¦åˆ™å¯èƒ½ä¼šå¤„ç†æ¶æ„ä¼ªé€ çš„è¯·æ±‚ã€‚</li>
<li>å¤„ç†é€»è¾‘ä¸­<strong>ä¸€å®šè¦åšå¥½å¹‚ç­‰æ€§å¤„ç†</strong>ï¼Œå› ä¸ºWebhookå¯èƒ½ä¼šé‡è¯•å‘é€ã€‚</li>
</ol>
<h4 data-id="heading-3"><strong>ç¬¬å››æ­¥ï¼šæµ‹è¯•ä¸ä¸Šçº¿ï¼ˆ60åˆ†é’Ÿï¼‰</strong></h4>
<ol>
<li><strong>ä½¿ç”¨æµ‹è¯•æ¨¡å¼</strong>ï¼šæ˜Ÿææä¾›æµ‹è¯•ç¯å¢ƒå’Œæ¨¡æ‹Ÿé“¶è¡Œå¡å·ï¼Œè®©ä½ åœ¨ä¸äº§ç”ŸçœŸå®äº¤æ˜“çš„æƒ…å†µä¸‹å®Œæˆå…¨æµç¨‹æµ‹è¯•ã€‚</li>
<li><strong>æµ‹è¯•å„ç§åœºæ™¯</strong>ï¼šæˆåŠŸæ”¯ä»˜ã€æ”¯ä»˜å¤±è´¥ã€å¼‚å¸¸æ•°æ®ã€Webhooké‡è¯•ç­‰ã€‚</li>
<li><strong>éƒ¨ç½²ä¸Šçº¿</strong>ï¼šå°†ä½ çš„ä»£ç éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼Œå¹¶ç¡®ä¿ä½ çš„Webhookç«¯ç‚¹èƒ½è¢«å…¬ç½‘è®¿é—®ã€‚</li>
</ol>
<h4 data-id="heading-4"><strong>æ€»ç»“</strong></h4>
<p>è‡³æ­¤ï¼Œä½ å·²ç»æˆåŠŸåœ°ä¸ºä½ çš„SaaSé¡¹ç›®æ¥å…¥äº†ä¸“ä¸šçš„è·¨å¢ƒæ”¶æ¬¾èƒ½åŠ›ã€‚æˆ‘ä»¬å›é¡¾ä¸€ä¸‹é›†æˆçš„æ ¸å¿ƒï¼š</p>
<ul>
<li><strong>ä¸€ä¸ªæœåŠ¡ç«¯æ¥å£</strong>ï¼šç”¨äºåˆ›å»ºæ”¯ä»˜ã€‚</li>
<li><strong>ä¸€ä¸ªWebhookå¤„ç†å™¨</strong>ï¼šç”¨äºå¼‚æ­¥æ¥æ”¶æ”¯ä»˜ç»“æœã€‚</li>
<li><strong>å®Œå–„çš„é”™è¯¯å¤„ç†ä¸å®‰å…¨éªŒè¯</strong>ï¼šä¿éšœç³»ç»Ÿç¨³å®šä¸èµ„é‡‘å®‰å…¨ã€‚</li>
</ul>
<p>è¿™å¥—æ¶æ„è¶³ä»¥åº”å¯¹çœŸå®çš„ä¸šåŠ¡åœºæ™¯ã€‚ç°åœ¨ï¼Œä½ èŠ‚çœä¸‹äº†åŸæœ¬éœ€è¦æ•°æœˆè‡ªç ”æ”¯ä»˜ç³»ç»Ÿçš„æ—¶é—´ï¼Œå¯ä»¥å®Œå…¨ä¸“æ³¨äºä½ çš„æ ¸å¿ƒäº§å“é€»è¾‘äº†ã€‚</p>
<p><strong>ç«‹å³æŸ¥çœ‹Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.starsee.io%2F" target="_blank" title="https://docs.starsee.io/" ref="nofollow noopener noreferrer">æ˜Ÿæå®˜æ–¹Node.js SDKåŠæ–‡æ¡£</a></strong>ï¼Œè·å–æ›´å¤šé«˜çº§åŠŸèƒ½ï¼ˆå¦‚è®¢é˜…æ”¯ä»˜ã€é€€æ¬¾å¤„ç†ï¼‰çš„è¯¦ç»†æŒ‡å—ï¼ŒåŠ é€Ÿä½ çš„ä¸šåŠ¡å…¨çƒåŒ–ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[8 ä¸ªæœ€ä½³ Google Sheets æ›¿ä»£æ–¹æ¡ˆï¼ˆé™„æˆæœ¬ä¸èƒ½åŠ›åˆ†æï¼‰]]></title>    <link>https://juejin.cn/post/7577439614953570356</link>    <guid>https://juejin.cn/post/7577439614953570356</guid>    <pubDate>2025-11-28T07:59:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577439614953570356" data-draft-id="7577439614953553972" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="8 ä¸ªæœ€ä½³ Google Sheets æ›¿ä»£æ–¹æ¡ˆï¼ˆé™„æˆæœ¬ä¸èƒ½åŠ›åˆ†æï¼‰"/> <meta itemprop="keywords" content="å¼€æº,ä½ä»£ç ,GitHub"/> <meta itemprop="datePublished" content="2025-11-28T07:59:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="NocoBase"/> <meta itemprop="url" content="https://juejin.cn/user/180779873743566"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            8 ä¸ªæœ€ä½³ Google Sheets æ›¿ä»£æ–¹æ¡ˆï¼ˆé™„æˆæœ¬ä¸èƒ½åŠ›åˆ†æï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180779873743566/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    NocoBase
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:59:09.000Z" title="Fri Nov 28 2025 07:59:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fthe-8-best-google-sheets-alternatives-with-full-cost-and-capability-analysis" target="_blank" title="https://www.nocobase.com/cn/blog/the-8-best-google-sheets-alternatives-with-full-cost-and-capability-analysis" ref="nofollow noopener noreferrer">www.nocobase.com/cn/blog/theâ€¦</a></p>
<p>ä½ ä»¬å›¢é˜Ÿç°åœ¨æˆ–è€…æ›¾ç»ä½¿ç”¨è¿‡ Google Sheets å—ï¼Ÿ</p>
<p>å®ƒè½»é‡ã€æ˜“ä¸Šæ‰‹ã€åä½œæ–¹ä¾¿ï¼Œæ˜¯è®¸å¤šå›¢é˜Ÿåœ¨æ•°å­—åŒ–åˆæœŸæœ€å¸¸é€‰æ‹©çš„å·¥å…·ã€‚åœ¨æ•°æ®è®°å½•ã€ä»»åŠ¡è·Ÿè¸ªã€å†…å®¹ç®¡ç†æˆ–åŸºç¡€ç»Ÿè®¡ç­‰åœºæ™¯ä¸­ï¼Œè¡¨æ ¼çš„ç¡®èƒ½å¿«é€Ÿè§£å†³é—®é¢˜ã€‚</p>
<p>ä½†éšç€å›¢é˜Ÿè§„æ¨¡æ‰©å¤§ã€å‚ä¸è€…å¢å¤šã€ä¸šåŠ¡é€»è¾‘å˜å¾—å¤æ‚ï¼Œè¡¨æ ¼åœ¨ç»“æ„å’Œåä½œæ–¹é¢çš„é™åˆ¶ä¼šé€æ¸æ˜¾ç°ã€‚è·¨éƒ¨é—¨åä½œã€ç»†ç²’åº¦æƒé™ç®¡ç†ã€æµç¨‹åŒ–æ“ä½œç­‰éœ€æ±‚è¶Šæ¥è¶Šå¤šæ—¶ï¼ŒGoogle Sheets å¾€å¾€éš¾ä»¥æ»¡è¶³åç»­çš„æ‰©å±•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e4a0b1b621a441ca1277a8af9e10d92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764921548&amp;x-signature=b80f9zhzx3yCv4X%2BT7OeSNmjYH0%3D" alt="Hacker News.png" loading="lazy"/></p>
<p>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fnews.ycombinator.com%2Fitem%3Fid%3D39155449" target="_blank" title="https://news.ycombinator.com/item?id=39155449" ref="nofollow noopener noreferrer">Hacker News</a> çš„è®¨è®ºé‡Œï¼Œä¹Ÿæœ‰ä¸å°‘ç”¨æˆ·åœ¨å¯»æ‰¾ Google Sheets çš„æ›¿ä»£æ–¹æ¡ˆã€‚ä¸€äº›ç”¨æˆ·æåˆ°ï¼Œå®ƒåœ¨å¤æ‚åœºæ™¯ä¸‹æ˜¾å¾—æ›´åƒæ˜¯å·¥å…·é“¾é‡Œçš„â€œä¸´æ—¶é€‰é¡¹â€ï¼Œéš¾ä»¥æ‰¿æ‹…ä¸¥è‚ƒçš„æ•°æ®å·¥ä½œï¼›é¢å¯¹æ›´å¤§çš„æ•°æ®è§„æ¨¡æˆ–æ›´å¤æ‚çš„æ¨¡å‹æ„å»ºæ—¶ï¼Œä¹Ÿå®¹æ˜“åŠ›ä¸ä»å¿ƒï¼Œéš¾ä»¥æ”¯æŒå®Œæ•´çš„æ•°æ®åˆ†ææµç¨‹ã€‚</p>
<p>æœ¬è´¨ä¸Šï¼ŒGoogle Sheets çš„å®šä½å§‹ç»ˆæ˜¯ç”µå­è¡¨æ ¼ï¼Œè€Œä¸æ˜¯ä¸šåŠ¡ç³»ç»Ÿã€‚</p>
<p>å› æ­¤ï¼Œå½“å›¢é˜Ÿå°è¯•ç”¨å®ƒæ‰¿è½½ CRMã€é¡¹ç›®ç®¡ç†ã€èµ„äº§ç™»è®°æˆ–å®¡æ‰¹æµç¨‹æ—¶ï¼Œå¾€å¾€ä¼šé‡åˆ°æ•°æ®å…³ç³»éš¾ä»¥ç»´æŠ¤ã€æƒé™ç®¡ç†å—é™ã€è‡ªåŠ¨åŒ–é“¾è·¯éš¾ä»¥æ‰©å±•ç­‰é—®é¢˜ã€‚</p>
<p>åŸºäºè¿™äº›çœŸå®çš„ä½¿ç”¨èƒŒæ™¯ï¼Œæˆ‘æ•´ç†äº†å‡ ç±»å¸¸è§çš„æ›¿ä»£å·¥å…·ï¼Œå¸Œæœ›èƒ½å¸®åŠ©ä½ åœ¨ä¸åŒé˜¶æ®µã€ä¸åŒéœ€æ±‚ä¸‹ï¼Œæ‰¾åˆ°æ¯” Google Sheets æ›´é€‚åˆçš„é€‰æ‹©ã€‚</p>
<p>æ¥ä¸‹æ¥ä¼šä»ä¸‰ä¸ªå…³é”®ç»´åº¦å±•å¼€ä»‹ç»ï¼š</p>
<ul>
<li><strong>å›¢é˜Ÿè§„æ¨¡æˆæœ¬</strong>ï¼šæŒ‰ 10 / 50 / 100 äººå›¢é˜Ÿè®¡ç®—çš„å¹´åº¦é¢„ä¼°æŠ•å…¥</li>
<li><strong>æœ€ä½³ä½¿ç”¨åœºæ™¯</strong>ï¼šæœ€é€‚åˆä»€ä¹ˆå›¢é˜Ÿä¸ä»€ä¹ˆä¸šåŠ¡éœ€æ±‚</li>
<li><strong>èƒ½åŠ›è¡¨ç°</strong>ï¼šæ•°æ®ç»“æ„ã€åä½œæƒé™ã€æ‰©å±•æ€§ã€è‡ªåŠ¨åŒ–ã€ä½¿ç”¨é—¨æ§›ç­‰æ ¸å¿ƒèƒ½åŠ›</li>
</ul>
<h2 data-id="heading-0">Google Sheets æ›¿ä»£æ–¹æ¡ˆ</h2>
<p>åœ¨è¿›å…¥æ­£æ–‡å‰ï¼Œæˆ‘æ ¹æ®å¸¸è§ä¸šåŠ¡éœ€æ±‚å°†ä»Šå¤©è¦ä»‹ç»çš„ 8 ä¸ªå·¥å…·åšäº†åˆ†ç±»ï¼Œä½ å¯ä»¥å…ˆå¿«é€Ÿæµè§ˆä¸‹é¢çš„å·¥å…·ç±»å‹~</p>
<p><strong>â‘  æ„å»ºä¸šåŠ¡ç³»ç»Ÿå‹å·¥å…·</strong></p>
<p><strong>NocoBaseã€Retoolã€Appsmithã€Budibase</strong></p>
<p>é€‚åˆä»â€œè¡¨æ ¼æ··ä¹±â€å‡çº§åˆ°â€œçœŸæ­£çš„å†…éƒ¨ç³»ç»Ÿâ€ï¼Œéœ€è¦æ•°æ®æ¨¡å‹ã€æƒé™ã€è‡ªåŠ¨åŒ–æµè½¬æˆ–æ¨¡å—åŒ–åº”ç”¨çš„å›¢é˜Ÿã€‚</p>
<p><strong>â‘¡ ç»“æ„åŒ–æ•°æ®å‹å·¥å…·</strong></p>
<p><strong>Airtableã€Smartsheetã€Baserowã€NocoDB</strong></p>
<p>é€‚åˆå·²ç»ä¸æ»¡è¶³ä¼ ç»Ÿè¡¨æ ¼ï¼Œä½†è¿˜ä¸éœ€è¦å®Œæ•´ä¸šåŠ¡ç³»ç»Ÿçš„å›¢é˜Ÿï¼›æä¾›ç»“æ„åŒ–æ•°æ®æ¨¡å‹ã€å¤šè§†å›¾ã€åŸºç¡€æƒé™åä½œã€è‡ªæ‰˜ç®¡é€‰é¡¹ï¼ˆéƒ¨åˆ†å·¥å…·ï¼‰ï¼Œç”¨äºæ›´è§„èŒƒåœ°ç®¡ç†æ•°æ®ã€‚</p>
<h3 data-id="heading-1">ä»·æ ¼å¯¹æ¯”è¡¨æ ¼</h3>
































































































<table><thead><tr><th>å·¥å…·åç§°</th><th>ç‰ˆæœ¬ / æ¨¡å¼</th><th>10 äººå›¢é˜Ÿæ¯å¹´æˆæœ¬</th><th>50 äººå›¢é˜Ÿæ¯å¹´æˆæœ¬</th><th>100 äººå›¢é˜Ÿæ¯å¹´æˆæœ¬</th></tr></thead><tbody><tr><td>Airtable</td><td>Team</td><td>$2,400</td><td>$12,000</td><td>$24,000</td></tr><tr><td>Airtable</td><td>Business</td><td>ğŸ”´$5,400</td><td>ğŸ”´$27,000</td><td>ğŸ”´$54,000</td></tr><tr><td>NocoBase</td><td>Standardï¼ˆä¸€æ¬¡æ€§ï¼‰</td><td>âœ…$800</td><td>âœ…$800</td><td>âœ…$800</td></tr><tr><td>NocoBase</td><td>Professionalï¼ˆä¸€æ¬¡æ€§ï¼‰</td><td>$8,000</td><td>$8,000</td><td>$8,000</td></tr><tr><td>NocoDB</td><td>Team</td><td>âœ…$228</td><td>âœ…$1,140</td><td>âœ…$2,280</td></tr><tr><td>NocoDB</td><td>Business</td><td>$1,188</td><td>$5,940</td><td>$11,880</td></tr><tr><td>Baserow</td><td>Premium</td><td>$1,200</td><td>$6,000</td><td>$12,000</td></tr><tr><td>Baserow</td><td>Advanced</td><td>$2,160</td><td>$9,000</td><td>$18,000</td></tr><tr><td>Retool</td><td>Standard</td><td>$1,200</td><td>$6,000</td><td>$12,000</td></tr><tr><td>Budibase</td><td>Premium</td><td>çº¦$2,700</td><td>çº¦$5,850</td><td>çº¦$8,700</td></tr><tr><td>Appsmith</td><td>Business</td><td>$1,800</td><td>$9,000</td><td>$18,000</td></tr><tr><td>Teable</td><td>Professional</td><td>$1,200</td><td>$6,000</td><td>$12,000</td></tr></tbody></table>
<p>ğŸ’¡ ä»ä¸Šè¡¨å¯ä»¥çœ‹å‡ºå‡ ä¸ªé‡è¦è¶‹åŠ¿ï¼š</p>
<ul>
<li>éšç€å›¢é˜Ÿè§„æ¨¡æ‰©å¤§ï¼Œé‡‡ç”¨æŒ‰ç”¨æˆ·è®¡è´¹çš„å·¥å…·ï¼ˆå¦‚ Baserowã€Appsmithã€Retoolã€Teable ç­‰ï¼‰æˆæœ¬éƒ½ä¼šå¿«é€Ÿä¸Šå‡ï¼Œå°å›¢é˜Ÿè´Ÿæ‹…å¯æ§ï¼Œä½†åˆ°äº† 50 äººã€100 äººè§„æ¨¡æ—¶ï¼Œå¹´åº¦æŠ•å…¥ä¼šæˆå€å¢é•¿ã€‚</li>
<li>NocoBase æ˜¯å…¶ä¸­å”¯ä¸€ä¸éšç”¨æˆ·å¢åŠ è€Œå˜åŠ¨ä»·æ ¼çš„æ–¹æ¡ˆï¼ŒStandard å¹´æˆæœ¬ä¿æŒåœ¨ $800ï¼ŒProfessional å›ºå®šä¸º $8,000ï¼Œè¿™ç§æ¨¡å¼åœ¨éœ€è¦å¤šäººåä½œæˆ–è·¨éƒ¨é—¨ä½¿ç”¨çš„åœºæ™¯ä¸‹æ›´å…·å¯é¢„æµ‹æ€§ã€‚</li>
<li>NocoDBã€Baserow ç­‰æ•°æ®åº“å‹å·¥å…·çš„æˆæœ¬ç›¸å¯¹ç¨³å®šï¼Œä½†ä»åŸºäºäººæ•°è®¡è´¹ï¼Œé€‚åˆä½œä¸ºä» Google Sheets è¿‡æ¸¡åˆ°ç»“æ„åŒ–æ•°æ®ç®¡ç†çš„ä¸­é—´è·¯çº¿ã€‚</li>
<li>Budibaseã€Teable ç­‰å·¥å…·ä¿æŒä¸­ç­‰æˆæœ¬åŒºé—´ï¼Œç•Œé¢ä½“éªŒå¯¹ä¹ æƒ¯ç”µå­è¡¨æ ¼çš„ç”¨æˆ·è¾ƒå‹å¥½ï¼Œé€‚åˆä» Google Sheets å‡çº§ä½†ä¸éœ€è¦å®Œæ•´ä¸šåŠ¡ç³»ç»Ÿçš„å›¢é˜Ÿã€‚</li>
<li>æ•´ä½“è€Œè¨€ï¼Œè‡ªæ‰˜ç®¡å·¥å…·åœ¨å›¢é˜Ÿäººæ•°è¶Šå¤šæ—¶è¶Šå…·æˆæœ¬ä¼˜åŠ¿ï¼Œé€‚åˆè®¡åˆ’å°†åŸæœ¬ä¾èµ– Google Sheets çš„æ•°æ®é€æ­¥è¿ç§»ä¸ºæ›´ç»“æ„åŒ–ã€é•¿æœŸç¨³å®šä½¿ç”¨çš„ç³»ç»Ÿï¼›è€Œ SaaS ç±»å·¥å…·æ›´é€‚åˆå°å›¢é˜Ÿæˆ–çŸ­æœŸé¡¹ç›®ã€‚</li>
</ul>
<p>ğŸ’¡æ¨èé˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2F7-self-hosted-ai-tools-build-business-app" target="_blank" title="https://www.nocobase.com/cn/blog/7-self-hosted-ai-tools-build-business-app" ref="nofollow noopener noreferrer">7 æ¬¾æœ€ä½³è‡ªæ‰˜ç®¡ AI å·¥å…·ï¼Œå¿«é€Ÿæ„å»ºä¸šåŠ¡åº”ç”¨</a></p>
<h3 data-id="heading-2">NocoBase</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/968c061e942f4fe391b58b50d1e0d580~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764921548&amp;x-signature=MEtEKpAmKw7npbofoQ79FGkC%2Bdk%3D" alt="NocoBase.PNG" loading="lazy"/></p>
<p>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2F" target="_blank" title="https://www.nocobase.com/cn/" ref="nofollow noopener noreferrer">www.nocobase.com/cn/</a></p>
<p>NocoBase æ˜¯ä¸€ä¸ªå¼€æºçš„æ— ä»£ç ï¼ä½ä»£ç ä¸šåŠ¡åº”ç”¨æ„å»ºå¹³å°ï¼Œç”¨äºæ­å»ºå†…éƒ¨ç³»ç»Ÿã€ç®¡ç†åå°ä»¥åŠä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„ä¸šåŠ¡æµç¨‹ã€‚æ”¯æŒè‡ªæ‰˜ç®¡ï¼Œä¹Ÿæä¾›å®˜æ–¹æ‰˜ç®¡æ–¹æ¡ˆï¼Œé€‚åˆå¸Œæœ›ä»è¡¨æ ¼è¿ç§»åˆ°ç³»ç»ŸåŒ–ç®¡ç†çš„å›¢é˜Ÿã€‚å¹³å°åŸºäºå¯è§†åŒ–é…ç½®æ„å»ºåº”ç”¨ï¼Œå¹¶å¯é€šè¿‡æ’ä»¶å’Œ API æ‰©å±•èƒ½åŠ›ï¼Œéƒ¨åˆ†åœºæ™¯è¿˜å¯ä»¥ç»“åˆå®˜æ–¹æä¾›çš„ AI åŠŸèƒ½æå‡æ•°æ®å½•å…¥ä¸æµç¨‹æ•ˆç‡ã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong></p>
<p>é€‚åˆå·²ç»ä¸æ»¡è¶³äºç”¨è¡¨æ ¼ç®¡ç†æ•°æ®ï¼Œå¸Œæœ›æ„å»ºæ›´ç»“æ„åŒ–ã€æ›´å¯æ§çš„å†…éƒ¨ç³»ç»Ÿçš„å›¢é˜Ÿã€‚  å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä»¥æ•°æ®ç®¡ç†ä¸ºæ ¸å¿ƒçš„ä¸šåŠ¡ï¼Œå¦‚å®¢æˆ·ç®¡ç†ã€åº“å­˜ç®¡ç†ã€èµ„äº§ç®¡ç†</li>
<li>ä¾èµ–æµç¨‹æµè½¬çš„åœºæ™¯ï¼Œå¦‚å®¡æ‰¹ã€é¡¹ç›®åä½œã€ä»»åŠ¡æ¨è¿›</li>
<li>éœ€è¦å¤šäººåä½œã€åˆ†è§’è‰²ä½¿ç”¨çš„åå°ç³»ç»Ÿ</li>
<li>å¯¹æ•°æ®å®‰å…¨ã€è‡ªæ‰˜ç®¡æˆ–å†…éƒ¨éƒ¨ç½²æœ‰è¦æ±‚çš„ä¼ä¸šç¯å¢ƒ</li>
</ul>
<p><strong>èƒ½åŠ›è¡¨ç°</strong></p>
<ul>
<li><strong>æ•°æ®ç»“æ„èƒ½åŠ›</strong> å¯ä»¥é€šè¿‡ç•Œé¢åˆ›å»ºæ•°æ®è¡¨ã€å­—æ®µå’Œå…³ç³»ï¼ŒæŠŠä¸šåŠ¡æ•°æ®æ•´ç†ä¸ºæ¸…æ™°çš„ç»“æ„åŒ–æ¨¡å‹ï¼Œå¹¶åœ¨è§†å›¾ä¸­çµæ´»å±•ç¤ºã€‚</li>
<li><strong>åä½œä¸æƒé™èƒ½åŠ›</strong> æä¾›å¤šå±‚çº§æƒé™ï¼ŒåŒ…æ‹¬è§’è‰²ã€è¡¨ã€å­—æ®µå’Œé¡µé¢å±‚é¢çš„è®¿é—®æ§åˆ¶ï¼Œé€‚åˆå›¢é˜Ÿé—´åä½œä¸æƒé™éš”ç¦»ã€‚</li>
</ul>
<p>ğŸ’¡æ¨èé˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2F6-in-depth-comparison-rbac-no-code-low-code-platforms" target="_blank" title="https://www.nocobase.com/cn/blog/6-in-depth-comparison-rbac-no-code-low-code-platforms" ref="nofollow noopener noreferrer">6 å¤§ä¼ä¸šçº§æ— ä»£ç ä½ä»£ç å¹³å° RBAC æƒé™ä½“ç³»æ·±åº¦å¯¹æ¯”</a></p>
<ul>
<li><strong>è‡ªåŠ¨åŒ–èƒ½åŠ›</strong> æ”¯æŒåŸºäºäº‹ä»¶çš„æµç¨‹é…ç½®ï¼Œå¯ä»¥åœ¨æ•°æ®å˜æ›´æ—¶è§¦å‘é€šçŸ¥ã€å®¡æ ¸å’Œè·¨ç³»ç»ŸåŠ¨ä½œï¼Œå‡å°‘æ‰‹å·¥æ“ä½œã€‚</li>
<li><strong>æ‰©å±•èƒ½åŠ›</strong> å…·å¤‡æ’ä»¶ä½“ç³»å’Œå¼€æ”¾æ¥å£ï¼Œå¯ä»¥å®‰è£…æˆ–å¼€å‘æ’ä»¶ï¼Œä¹Ÿèƒ½é›†æˆå¤–éƒ¨ç³»ç»Ÿï¼Œä½¿åŠŸèƒ½éšç€ä¸šåŠ¡æ‰©å±•è€Œå¢é•¿ã€‚</li>
<li><strong>è‡ªæ‰˜ç®¡ä¸éƒ¨ç½²èƒ½åŠ›</strong> å¯ä»¥åœ¨æœ¬åœ°æˆ–äº‘æœåŠ¡å™¨éƒ¨ç½²ï¼Œå›¢é˜Ÿèƒ½å¤Ÿè‡ªä¸»æŒæ§æ•°æ®ä¸è¿è¡Œç¯å¢ƒã€‚</li>
<li><strong>API ä¸é›†æˆèƒ½åŠ›</strong> å¹³å°æä¾›å¯ç”±æ•°æ®æ¨¡å‹è‡ªåŠ¨ç”Ÿæˆçš„ APIï¼Œå¹¶æ”¯æŒé€šè¿‡æ’ä»¶æˆ–é…ç½®ä¸å¤–éƒ¨ç³»ç»Ÿé›†æˆï¼Œé€‚åˆåœ¨æ›´å¤§çš„ä¸šåŠ¡ä½“ç³»ä¸­è¡”æ¥å‰ç«¯ã€ç§»åŠ¨ç«¯æˆ–å…¶ä»–æœåŠ¡ã€‚</li>
<li><strong>ä½¿ç”¨é—¨æ§›</strong>  éæŠ€æœ¯äººå‘˜å¯ä»¥é€šè¿‡ç•Œé¢åˆ›å»ºä¸šåŠ¡åº”ç”¨ï¼Œè€ŒæŠ€æœ¯å›¢é˜Ÿå¯ä»¥åŸºäºæ’ä»¶ã€æ¥å£å’Œè‡ªæ‰˜ç®¡åšæ›´æ·±å…¥çš„æ‰©å±•ã€‚</li>
</ul>
<p><strong>æ€»ç»“</strong>  å¦‚æœå›¢é˜Ÿæ­£åœ¨ä»ç”µå­è¡¨æ ¼è½¬å‘ç³»ç»ŸåŒ–ç®¡ç†ï¼Œå¹¶å¸Œæœ›åœ¨æ•°æ®ç»“æ„ã€æƒé™ã€æµç¨‹å’Œæ‰©å±•æ€§ä¸Šæœ‰æ›´å®Œæ•´çš„èƒ½åŠ›ï¼ŒåŒæ—¶å¸Œæœ›ç³»ç»Ÿèƒ½éšä¸šåŠ¡è§„æ¨¡é€æ­¥å¢é•¿ï¼ŒNocoBase æ˜¯ä¸€ä¸ªé€‚åˆé•¿æœŸæŠ•å…¥çš„é€‰æ‹©ã€‚å®ƒå…¼é¡¾å¯è§†åŒ–æ˜“ç”¨æ€§ä¸æ·±åº¦æ‰©å±•èƒ½åŠ›ï¼Œé€‚åˆä»å°å›¢é˜Ÿåˆ°ä¼ä¸šçš„ä¸åŒé˜¶æ®µã€‚</p>
<h3 data-id="heading-3">Retool</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3bbc0e75eb3f4cfa95759ad78dc543da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764921548&amp;x-signature=Do3MHm7tUAPtmMF15CvoSQRsEUs%3D" alt="Retool.png" loading="lazy"/></p>
<p>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fretool.com%2F" target="_blank" title="https://retool.com/" ref="nofollow noopener noreferrer">retool.com/</a></p>
<p>Retool æ˜¯ä¸€ä¸ªç”¨äºå¿«é€Ÿæ„å»ºå†…éƒ¨å·¥å…·çš„é—­æº SaaS å¹³å°ï¼Œä¹Ÿæä¾›è‡ªæ‰˜ç®¡ç‰ˆæœ¬ï¼ˆä¼ä¸šè®¡åˆ’ï¼‰ã€‚å®ƒä¸»è¦é¢å‘å·¥ç¨‹å›¢é˜Ÿï¼Œé€šè¿‡æ‹–æ‹½ç»„ä»¶å’Œå°‘é‡ä»£ç ï¼Œå°†æ•°æ®åº“ã€API å’Œåå°é€»è¾‘å¿«é€Ÿç»„åˆæˆå¯ç”¨çš„å†…éƒ¨åº”ç”¨ï¼Œä¾‹å¦‚è¿è¥åå°ã€æ•°æ®é¢æ¿ã€å®¡æ ¸ç³»ç»Ÿæˆ–å®¢æœæ”¯æŒå·¥å…·ã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong></p>
<p>é€‚åˆæ‹¥æœ‰å·¥ç¨‹å¸ˆå›¢é˜Ÿã€éœ€è¦å¿«é€Ÿæ„å»ºå†…éƒ¨ä¸šåŠ¡å·¥å…·çš„å…¬å¸ã€‚  å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>åå°è¿è¥å·¥å…·ï¼Œä¾‹å¦‚è®¢å•ç®¡ç†ã€ç”³è¯‰å¤„ç†ã€å†…å®¹å®¡æ ¸</li>
<li>æ•°æ®è¿è¥ä¸æ”¯æŒå›¢é˜Ÿä½¿ç”¨çš„æ•°æ®é¢æ¿æˆ–å·¥å…·åŒ–ç•Œé¢</li>
<li>å·¥ç¨‹å›¢é˜Ÿæ­å»ºå†…éƒ¨æ§åˆ¶å°ã€è¿è¥ç³»ç»Ÿã€ç®¡ç†ç•Œé¢</li>
<li>æ¥å…¥ç°æœ‰æ•°æ®åº“æˆ– API çš„è½»é‡ä¸šåŠ¡æµç¨‹å·¥å…·</li>
</ul>
<p><strong>èƒ½åŠ›è¡¨ç°</strong></p>
<ul>
<li><strong>æ‰©å±•èƒ½åŠ›</strong>  Retool åœ¨æ‰©å±•æ–¹é¢éå¸¸çµæ´»ï¼Œå¯ä»¥é€šè¿‡ JavaScript ç›´æ¥å¤„ç†æ•°æ®ã€è°ƒç”¨ APIã€ç»„åˆé€»è¾‘ï¼Œä¹Ÿèƒ½ä¸æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—æˆ–ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆã€‚å¯¹äºéœ€è¦å°†å¤šä¸ªç³»ç»Ÿæ•´åˆåˆ°ä¸€ä¸ªæ“ä½œç•Œé¢çš„å›¢é˜Ÿæ¥è¯´ï¼Œå®ƒèƒ½æ˜¾è‘—å‡å°‘å¼€å‘æˆæœ¬ï¼Œæ˜¯å·¥ç¨‹å›¢é˜Ÿå¸¸ç”¨çš„å†…éƒ¨å·¥å…·æ¡†æ¶ã€‚</li>
<li><strong>æ•°æ®è¿æ¥èƒ½åŠ›</strong>  Retool æ”¯æŒè¿æ¥å¤§é‡æ•°æ®æºï¼ŒåŒ…æ‹¬ SQLã€NoSQLã€REST APIã€GraphQL ç­‰ï¼Œä¹Ÿå…è®¸å¼€å‘è€…åœ¨ç•Œé¢ä¸Šç›´æ¥ç¼–å†™æŸ¥è¯¢è¯­å¥ã€å¤„ç†é€»è¾‘ã€è¿›è¡Œæ•°æ®ç»‘å®šã€‚å®ƒå¹¶ä¸è´Ÿè´£æ•°æ®ç»“æ„æœ¬èº«ï¼Œè€Œæ˜¯ä½œä¸ºä¸Šå±‚åº”ç”¨ç•Œé¢ï¼ŒæŠŠä¸åŒç³»ç»Ÿçš„æ•°æ®æ¥å…¥è¿›æ¥å¹¶ç»Ÿä¸€å±•ç¤ºã€‚</li>
<li><strong>ä½¿ç”¨é—¨æ§›</strong>  è™½ç„¶æœ‰æ‹–æ‹½å’Œå¯è§†åŒ–ç¼–è¾‘ï¼Œä½† Retool çš„æ ¸å¿ƒä»ç„¶ä¾èµ–å·¥ç¨‹èƒ½åŠ›ã€‚å®é™…ä½¿ç”¨ä¸­éœ€è¦ç¼–å†™ JavaScriptã€SQL æˆ–é…ç½® APIï¼Œäº§å“ã€è¿è¥å›¢é˜Ÿè¾ƒéš¾ç‹¬ç«‹å®Œæˆå¤æ‚åº”ç”¨ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œä¸Šæ‰‹å¿«ï¼›ä½†å¯¹äºä¸æ‡‚ä»£ç çš„ç”¨æˆ·æ¥è¯´ï¼Œé—¨æ§›è¾ƒé«˜ã€‚</li>
<li><strong>å±€é™æ€§</strong>  Retool èƒ½å¿«é€Ÿäº§å‡ºå†…éƒ¨å·¥å…·ï¼Œä½†ä¸é€‚åˆåšå¤–éƒ¨äº§å“æˆ–çœŸæ­£çš„ä¸šåŠ¡ç³»ç»Ÿã€‚å®ƒä¹Ÿä¸è´Ÿè´£æ•°æ®å»ºæ¨¡ã€ä¸šåŠ¡æµç¨‹æˆ–ç³»ç»Ÿçº§æƒé™æ¶æ„ï¼Œåªèƒ½ä¾èµ–åº•å±‚ç³»ç»Ÿå®ç°ã€‚åŒæ—¶ï¼ŒRetool é¡¹ç›®ä¸é€»è¾‘è¾ƒå¤šæ—¶ï¼Œç®¡ç†å’Œç»´æŠ¤çš„å¤æ‚åº¦ä¼šä¸Šå‡ã€‚</li>
</ul>
<p><strong>æ€»ç»“</strong>  å¦‚æœå›¢é˜Ÿæ‹¥æœ‰å·¥ç¨‹å¸ˆï¼Œå¹¶ä¸”æ ¸å¿ƒè¯‰æ±‚æ˜¯å¿«é€Ÿæ­å»ºå†…éƒ¨å·¥å…·æˆ–è¿è¥åå°ï¼Œè€Œä¸æ˜¯æ„å»ºå®Œæ•´ä¸šåŠ¡ç³»ç»Ÿï¼ŒRetool ä¼šæ˜¯æ•ˆç‡éå¸¸é«˜çš„é€‰æ‹©ã€‚ä½†å¦‚æœå›¢é˜Ÿæ²¡æœ‰å¼€å‘äººå‘˜ï¼Œæˆ–å¸Œæœ›ä»æ•°æ®ç»“æ„åˆ°æµç¨‹è‡ªåŠ¨åŒ–éƒ½å¯è§†åŒ–å®Œæˆï¼Œå®ƒå¯èƒ½ä¸æ˜¯æœ€åˆé€‚çš„å·¥å…·ã€‚</p>
<h3 data-id="heading-4">Appsmith</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf95193b225f4604b2e7760c2f583d61~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764921548&amp;x-signature=h8YgJsTRgk%2FgX0Z3VWJ4S0TLaUU%3D" alt="Appsmith.png" loading="lazy"/></p>
<p>å®˜ç½‘ï¼š<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">appsmith.com/</a></p>
<p>Appsmith æ˜¯ä¸€ä¸ªå¼€æºä½ä»£ç ï¼æ— ä»£ç å¹³å°ï¼Œä¸“ä¸ºæ„å»ºå†…éƒ¨å·¥å…·ã€åå°ç³»ç»Ÿå’Œç®¡ç†é¢æ¿è®¾è®¡ã€‚å®ƒå…è®¸ç”¨æˆ·é€šè¿‡æ‹–æ‹½ç»„ä»¶ã€è¿æ¥æ•°æ®åº“æˆ– APIã€ç¼–å†™å°‘é‡è„šæœ¬ï¼Œå¿«é€Ÿæ­å»ºä¸šåŠ¡ç•Œé¢ï¼Œä¹Ÿæ”¯æŒè‡ªæ‰˜ç®¡éƒ¨ç½²ï¼Œå¯¹æ•°æ®å®‰å…¨å’Œéšç§æœ‰æ›´å¥½æ§åˆ¶ã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>  é€‚åˆä»¥ä¸‹æƒ…å†µï¼š</p>
<ul>
<li>å›¢é˜Ÿéœ€è¦å¿«é€Ÿæ„å»ºåå°ç®¡ç†ç³»ç»Ÿã€è¿è¥å·¥å…·ã€å®¡æ ¸ç³»ç»Ÿã€å®¢æœåå°ç­‰å†…éƒ¨å·¥å…·</li>
<li>å¸Œæœ›è¿æ¥æ•°æ®åº“ã€APIï¼Œä½†ä¸æƒ³ä»é›¶å¼€å§‹å†™ä»£ç çš„å…¬å¸æˆ–å›¢é˜Ÿ</li>
<li>å¯¹æ•°æ®å®‰å…¨æˆ–åˆè§„æ•æ„Ÿï¼Œéœ€è¦è‡ªæ‰˜ç®¡æˆ–å¯¹æ•°æ®åŸºç¡€è®¾æ–½æœ‰æ§åˆ¶æƒçš„ç»„ç»‡</li>
</ul>
<p><strong>èƒ½åŠ›è¡¨ç°</strong></p>
<ul>
<li><strong>æ•°æ®è¿æ¥ä¸å¤šæ•°æ®æºæ”¯æŒèƒ½åŠ›</strong>  Appsmith æ”¯æŒè¿æ¥ SQLã€NoSQL æ•°æ®åº“ã€REST / GraphQL APIã€å¤šç§æ•°æ®æºã€‚å®ƒèƒ½å¤ŸæŠŠå·²æœ‰çš„æ•°æ®æºâ€œæ‹‰è¿›æ¥â€ï¼Œç„¶åé€šè¿‡ UI ç»„ä»¶å±•ç¤ºã€æ“ä½œã€è¿‡æ»¤ã€ä¿®æ”¹æ•°æ®ã€‚è¿™æ ·å³ä½¿æ˜¯å¤æ‚æˆ–è€…å¼‚æ„çš„æ•°æ®ä½“ç³»ï¼Œä¹Ÿèƒ½è¢«æ•´åˆåˆ°ä¸€ä¸ªç»Ÿä¸€ç•Œé¢ä¸­ï¼Œæ–¹ä¾¿éå·¥ç¨‹å¸ˆä¹Ÿèƒ½ä½¿ç”¨å’Œç®¡ç†ã€‚</li>
<li><strong>æ‰©å±•ä¸å®šåˆ¶èƒ½åŠ›</strong>  ä½œä¸ºå¼€æºå·¥å…·ï¼ŒAppsmith æ”¯æŒå®Œå…¨è‡ªæ‰˜ç®¡ï¼Œä¹Ÿå…è®¸ç”¨æˆ·è‡ªå®šä¹‰ç•Œé¢ç»„ä»¶ã€è„šæœ¬é€»è¾‘ã€æƒé™è®¾ç½®ä¸ç”¨æˆ·è§’è‰²ç®¡ç†ã€‚å¯¹äºéœ€è¦é«˜åº¦å®šåˆ¶ã€ç³»ç»Ÿé›†æˆã€å¤šå›¢é˜Ÿåä½œçš„ä¼ä¸šï¼Œå®ƒå¯ä»¥ä½œä¸ºå†…éƒ¨ç³»ç»Ÿå¹³å°åŸºç¡€ï¼Œæä¾›æ¯”æ™®é€šå…·æ›´çµæ´»ã€æ›´å¯æ§çš„é•¿æœŸæ–¹æ¡ˆã€‚</li>
<li><strong>ä½¿ç”¨é—¨æ§›</strong>  å¯¹äºæ²¡æœ‰æŠ€æœ¯èƒŒæ™¯çš„å›¢é˜Ÿæ¥è¯´ï¼ŒAppsmith çš„ç•Œé¢ç›¸å¯¹å‹å¥½ï¼Œä½†è¦å……åˆ†åˆ©ç”¨å®ƒçš„æ•°æ®è¿æ¥ã€é€»è¾‘å®šåˆ¶ã€è‡ªæ‰˜ç®¡ç­‰èƒ½åŠ›ï¼Œä»éœ€è¦ä¸€å®šæŠ€æœ¯èƒ½åŠ›ï¼ˆè‡³å°‘äº†è§£æ•°æ®åº“æˆ– APIã€åŸºæœ¬è„šæœ¬/é€»è¾‘ï¼‰ã€‚ç›¸æ¯”çº¯è¡¨æ ¼å·¥å…·ï¼Œä¸Šæ‰‹é—¨æ§›æ›´é«˜ï¼›ä½†å¯¹äºæœ‰æŠ€æœ¯å‚¨å¤‡çš„å›¢é˜Ÿï¼Œå®ƒæ¯”ä»é›¶å¼€å‘æ›´å¿«ã€æ›´çœåŠ›ã€‚</li>
<li><strong>å±€é™æ€§</strong>  è™½ç„¶ Appsmith æä¾› UI + æ•°æ®è¿æ¥ + è‡ªæ‰˜ç®¡ï¼Œä½†å®ƒå¹¶ä¸æ˜¯â€œæ— éœ€ä»»ä½•ä»£ç â€çš„ 100% æ— ä»£ç è§£å†³æ–¹æ¡ˆã€‚å¯¹äºæä¸ºå¤æ‚çš„ä¸šåŠ¡éœ€æ±‚ï¼ˆé«˜åº¦å®šåˆ¶ä¸šåŠ¡é€»è¾‘ã€å¤§é‡å¹¶å‘ã€å¤æ‚æƒé™ç³»ç»Ÿç­‰ï¼‰ï¼Œä»å¯èƒ½éœ€è¦å·¥ç¨‹èµ„æºè¿›è¡ŒäºŒæ¬¡å¼€å‘æˆ–æ‰©å±•ã€‚åŒæ—¶ï¼Œå¯¹äºå®Œå…¨ä¸æ‡‚æŠ€æœ¯çš„å›¢é˜Ÿï¼Œå…¶å­¦ä¹ æ›²çº¿æ¯”çº¯ SaaS è¡¨æ ¼å·¥å…·æ›´é™¡å³­ã€‚</li>
</ul>
<p><strong>æ€»ç»“</strong>  å¦‚æœä½ çš„å›¢é˜Ÿæœ‰ä¸€å®šæŠ€æœ¯åŸºç¡€ï¼Œæˆ–è€…ä½ ä»¬é‡è§†æ•°æ®å®‰å…¨å’Œå¯æ§æ€§ï¼Œå¹¶å¸Œæœ›å¿«é€Ÿæ­å»ºå†…éƒ¨å·¥å…·ï¼ˆåå°ç®¡ç†ã€è¿è¥é¢æ¿ã€å®¡æ ¸ç³»ç»Ÿç­‰ï¼‰ï¼ŒAppsmith æ˜¯ä¸€ä¸ªæ€§ä»·æ¯”é«˜ã€çµæ´»ã€é€‚åˆé•¿æœŸä½¿ç”¨çš„å¹³å°ã€‚ä½†å¦‚æœå›¢é˜Ÿå®Œå…¨æ²¡æœ‰å·¥ç¨‹èµ„æºï¼Œä¹Ÿä¸æ„¿æ„åšè¿ç»´å’Œç»´æŠ¤ï¼Œé‚£ä¹ˆå°±è¦æ…é‡è€ƒè™‘å®ƒçš„ä½¿ç”¨é—¨æ§›å’Œé•¿æœŸæŠ•å…¥ã€‚ ğŸ’¡æ¨èé˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fnocobase-vs-appsmith" target="_blank" title="https://www.nocobase.com/cn/blog/nocobase-vs-appsmith" ref="nofollow noopener noreferrer">NocoBase ä¸ Appsmithï¼šå“ªä¸ªå¼€æºä½ä»£ç å¹³å°æ›´é€‚åˆä½ ï¼Ÿ</a></p>
<h3 data-id="heading-5">Budibase</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acb300f832454d6e83b3fedd9524b491~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764921548&amp;x-signature=soEfdszy9QlRZKTYG8QoCYfjdJY%3D" alt="Budibase.png" loading="lazy"/></p>
<p>å®˜ç½‘ï¼š<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">budibase.com/</a></p>
<p>Budibase æ˜¯ä¸€ä¸ªå¼€æºçš„ä½ä»£ç å¹³å°ï¼Œç”¨äºæ„å»ºå†…éƒ¨å·¥å…·å’Œç®¡ç†åå°ã€‚å®ƒæ”¯æŒè‡ªæ‰˜ç®¡ï¼Œä¹Ÿæ”¯æŒéƒ¨ç½²åˆ°äº‘ç«¯ï¼Œå¯¹äºéœ€è¦æŒæ§æ•°æ®å®‰å…¨æˆ–å¸Œæœ›åœ¨æœ¬åœ°è¿è¡Œç³»ç»Ÿçš„å›¢é˜Ÿæ¥è¯´æ›´åŠ çµæ´»ã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>  é€‚åˆå¸Œæœ›å¿«é€Ÿæ­å»ºåå°ç®¡ç†ç³»ç»Ÿã€æ•°æ®å½•å…¥å·¥å…·æˆ–ç®€å•ä¸šåŠ¡ç³»ç»Ÿçš„å›¢é˜Ÿã€‚å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>å®¢æˆ·ä¿¡æ¯ã€åº“å­˜ã€èµ„äº§ç­‰æ•°æ®çš„å½•å…¥å’Œç®¡ç†</li>
<li>å°å‹å†…éƒ¨ CRMã€å®¡æ‰¹æµæˆ–è¿è¥åå°</li>
<li>å¸Œæœ›å…·å¤‡è‡ªæ‰˜ç®¡èƒ½åŠ›çš„å°å‹å›¢é˜Ÿæˆ–åˆåˆ›å…¬å¸</li>
</ul>
<p><strong>èƒ½åŠ›è¡¨ç°</strong></p>
<ul>
<li><strong>æ•°æ®ç®¡ç†èƒ½åŠ›</strong>  Budibase æ”¯æŒè¿æ¥å¤–éƒ¨æ•°æ®åº“ï¼Œä¹Ÿå¯ä»¥åœ¨å¹³å°å†…åˆ›å»ºç»“æ„åŒ–çš„æ•°æ®è¡¨ï¼Œå®šä¹‰å­—æ®µç±»å‹ã€è®°å½•å…³ç³»ã€è¡¨å•å’Œåˆ—è¡¨è§†å›¾ã€‚å¯¹äºä¸­å°è§„æ¨¡çš„æ•°æ®ç®¡ç†ä»»åŠ¡ï¼Œå®ƒæ¯”æ™®é€šè¡¨æ ¼æä¾›æ›´æ¸…æ™°çš„ç»“æ„å’Œæ›´è§„èŒƒçš„ç»„ç»‡æ–¹å¼ã€‚</li>
<li><strong>æ‰©å±•èƒ½åŠ›ä¸è‡ªæ‰˜ç®¡æ”¯æŒ</strong>  æä¾›è§’è‰²å’Œæƒé™å®šä¹‰ã€è§¦å‘å™¨å’ŒåŠ¨ä½œé…ç½®ï¼Œå¯ä»¥åœ¨ç³»ç»Ÿä¸­åŠ å…¥ç®€å•çš„è‡ªåŠ¨åŒ–é€»è¾‘ã€‚ä½œä¸ºå¼€æºå·¥å…·ï¼Œå®ƒå…è®¸å›¢é˜Ÿè‡ªæ‰˜ç®¡ï¼Œä»è€Œåœ¨æ•°æ®å®‰å…¨æ€§å’Œç³»ç»Ÿè‡ªä¸»æ€§æ–¹é¢æ›´å¯æ§ï¼Œè¿™ä¸€ç‚¹åœ¨è®¸å¤šå›¢é˜Ÿçš„å†…éƒ¨å·¥å…·åœºæ™¯ä¸­å…·å¤‡å¸å¼•åŠ›ã€‚</li>
<li><strong>ä½¿ç”¨é—¨æ§›</strong>  Budibase å¯¹æ²¡æœ‰å‰ç«¯ç»éªŒçš„ç”¨æˆ·æ¥è¯´æ¯”ä¼ ç»Ÿå¼€å‘æ–¹å¼æ›´æ˜“ç”¨ï¼Œä½†è¦ç†Ÿç»ƒä½¿ç”¨æ•°æ®åº“è¿æ¥ã€è‡ªå®šä¹‰è§†å›¾æˆ–éƒ¨ç½²è‡ªæ‰˜ç®¡æœåŠ¡ï¼Œéœ€è¦ä¸€å®šçš„æŠ€æœ¯åŸºç¡€ã€‚å¯¹äºå®Œå…¨æ²¡æœ‰æŠ€æœ¯èƒŒæ™¯çš„å›¢é˜Ÿï¼Œä¸Šæ‰‹ä¼šæœ‰ä¸€å®šå­¦ä¹ æˆæœ¬ã€‚</li>
<li><strong>å±€é™æ€§</strong>  è™½ç„¶ Budibase å¯ä»¥è¦†ç›–æ•°æ®å½•å…¥ã€åŸºç¡€æƒé™ã€ç®€å•è‡ªåŠ¨åŒ–ï¼Œä½†å¯¹äºå¤æ‚çš„å¤šè¡¨å…³ç³»ã€ç»†ç²’åº¦æƒé™ä½“ç³»ã€å¤§å‹æµç¨‹ç¼–æ’æˆ–é«˜å¹¶å‘åœºæ™¯è€Œè¨€ï¼Œå®ƒçš„èƒ½åŠ›æœ‰é™ã€‚å¦‚æœå›¢é˜Ÿéœ€è¦æ„å»ºæ›´å¤æ‚çš„åº”ç”¨æˆ–ä¸šåŠ¡ç³»ç»Ÿï¼ŒBudibase å¾€å¾€åªèƒ½ä½œä¸ºåŸºç¡€æ¡†æ¶ä½¿ç”¨ã€‚</li>
</ul>
<p><strong>æ€»ç»“</strong>  å¦‚æœä½ éœ€è¦ä¸€æ¬¾èƒ½å¤Ÿå¿«é€Ÿæ­å»ºå†…éƒ¨å·¥å…·ã€å…·å¤‡ç»“æ„åŒ–æ•°æ®ç®¡ç†ã€è‡ªæ‰˜ç®¡èƒ½åŠ›å’ŒåŸºç¡€æƒé™æ§åˆ¶çš„å¹³å°ï¼ŒBudibase æ˜¯ä¸€ä¸ªçµæ´»ä¸”æˆæœ¬ç›¸å¯¹è¾ƒä½çš„é€‰æ‹©ã€‚ä½†å¯¹äºæ›´å¤æ‚çš„ä¸šåŠ¡åœºæ™¯ï¼Œå®ƒæ›´é€‚åˆä½œä¸ºè½»é‡çº§æ¡†æ¶ï¼Œè€Œä¸æ˜¯å®Œæ•´çš„ç³»ç»Ÿè§£å†³æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-6">Baserow</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cdd93cd521246e7baa0ba4178b8e090~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764921548&amp;x-signature=DeWY6MarnaLbST5HcM82qfiDNvU%3D" alt="Baserow.png" loading="lazy"/></p>
<p>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fbaserow.io%2F" target="_blank" title="https://baserow.io/" ref="nofollow noopener noreferrer">baserow.io/</a></p>
<p>Baserow æ˜¯ä¸€ä¸ªå¼€æºã€ä»¥æ•°æ®åº“ä¸ºæ ¸å¿ƒçš„æ•°æ®ç®¡ç†å·¥å…·ã€‚å®ƒæä¾›ç±»ä¼¼è¡¨æ ¼çš„ç•Œé¢ï¼Œä½†æœ¬è´¨æ˜¯ç»“æ„åŒ–æ•°æ®ç®¡ç†å¹³å°ï¼Œæ”¯æŒè‡ªæ‰˜ç®¡éƒ¨ç½²ï¼Œä¹Ÿæä¾›äº‘ç«¯æœåŠ¡ã€‚ç›¸æ¯”ä¼ ç»Ÿè¡¨æ ¼å·¥å…·ï¼Œå®ƒæ›´å¼ºè°ƒæ•°æ®æ¨¡å‹æ¸…æ™°åº¦å’Œå¯æ‰©å±•æ€§ï¼Œé€‚åˆå¸Œæœ›æŒæ¡æ•°æ®æ‰€æœ‰æƒæˆ–éœ€è¦æœ¬åœ°éƒ¨ç½²çš„å›¢é˜Ÿã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>  é€‚ç”¨äºå¸Œæœ›ä»ç”µå­è¡¨æ ¼å‡çº§åˆ°ç»“æ„åŒ–æ•°æ®åº“ï¼Œä½†ä¸æƒ³ç›´æ¥è¿›å…¥å·¥ç¨‹å‹æ•°æ®åº“å·¥å…·çš„å›¢é˜Ÿã€‚å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>å›¢é˜Ÿå†…éƒ¨çš„è½»é‡æ•°æ®ç®¡ç†ã€è¡¨æ ¼ç»“æ„åŒ–ã€æ•°æ®å½•å…¥</li>
<li>éœ€è¦è‡ªæ‰˜ç®¡çš„ä¸­å°ä¼ä¸šï¼Œç”¨äºæ•°æ®æ•´ç†ã€æ•°æ®çœ‹æ¿</li>
<li>ä½œä¸ºå‰ç«¯ç³»ç»Ÿæˆ–åº”ç”¨çš„åç«¯æ•°æ®æºï¼ˆREST APIï¼‰</li>
</ul>
<p><strong>èƒ½åŠ›è¡¨ç°</strong></p>
<ul>
<li><strong>æ•°æ®ç»“æ„èƒ½åŠ›</strong>  Baserow æä¾›æ¯”ç”µå­è¡¨æ ¼æ›´æ˜ç¡®çš„å­—æ®µç±»å‹ã€è¡¨ä¹‹é—´çš„å…³è”å…³ç³»ã€è®°å½•å¼•ç”¨ç­‰æ•°æ®åº“ç‰¹æ€§ã€‚å®ƒä¿ç•™äº†è¡¨æ ¼çš„ç›´è§‚ä½“éªŒï¼ŒåŒæ—¶è®©æ•°æ®ç»“æ„å…·å¤‡æ›´å¥½çš„å¯ç»´æŠ¤æ€§ï¼Œæ›´é€‚ç”¨äºä¸­ç­‰è§„æ¨¡çš„æ•°æ®å»ºæ¨¡ã€‚</li>
<li><strong>æ‰©å±•èƒ½åŠ›</strong>  ä½œä¸ºå¼€æºå·¥å…·ï¼ŒBaserow æ‹¥æœ‰è‰¯å¥½çš„æ‰©å±•æ€§ï¼Œæ”¯æŒè‡ªå»ºæ’ä»¶ã€å®šåˆ¶å­—æ®µç±»å‹ã€Webhookï¼Œä»¥åŠç”¨äºå¼€å‘åœºæ™¯çš„ API æ¥å£ã€‚å¯¹äºæœ‰ä¸€å®šæŠ€æœ¯èƒ½åŠ›çš„å›¢é˜Ÿï¼ŒBaserow å¯ä»¥ä½œä¸ºè½»é‡æ•°æ®åº“ä½¿ç”¨ï¼Œä¹Ÿèƒ½æˆä¸ºå†…éƒ¨ç³»ç»Ÿçš„åŸºç¡€æ•°æ®å±‚ã€‚</li>
<li><strong>ä½¿ç”¨é—¨æ§›</strong>  å¯¹éæŠ€æœ¯ç”¨æˆ·æ¥è¯´æ¯”ä¼ ç»Ÿæ•°æ®åº“æ›´æ˜“ä¸Šæ‰‹ï¼Œä½†éœ€è¦ä¸€å®šçš„ç»“æ„åŒ–æ€ç»´ï¼Œå°¤å…¶åœ¨è¡¨å…³ç³»ã€å¤šè¡¨ç®¡ç†ä¸Šçš„å­¦ä¹ æˆæœ¬é«˜äºæ™®é€šç”µå­è¡¨æ ¼ã€‚å¯¹æŠ€æœ¯å›¢é˜Ÿè€Œè¨€ï¼Œå®ƒæ¯” Airtable ç­‰ SaaS å·¥å…·æ›´çµæ´»ï¼Œä½†éœ€è¦è´Ÿè´£éƒ¨ç½²å’Œç»´æŠ¤ã€‚</li>
<li><strong>å±€é™æ€§</strong>  Baserow æ˜¯æ•°æ®ç®¡ç†å·¥å…·ï¼Œä¸æä¾›åº”ç”¨ç•Œé¢æ„å»ºã€å¤æ‚è‡ªåŠ¨åŒ–æˆ–ä¸šåŠ¡æµç¨‹èƒ½åŠ›ã€‚å¦‚æœå›¢é˜Ÿå¸Œæœ›æ„å»ºå®Œæ•´çš„ä¸šåŠ¡ç³»ç»Ÿï¼ŒBaserow å¾€å¾€åªèƒ½ä½œä¸ºæ•°æ®åç«¯ï¼Œéœ€è¦æ­é…å…¶ä»–å·¥å…·ä½¿ç”¨ã€‚</li>
</ul>
<p><strong>æ€»ç»“</strong>  å¦‚æœå›¢é˜Ÿç›®æ ‡æ˜¯ä»è¡¨æ ¼å‡çº§åˆ°æ›´å¯ç»´æŠ¤çš„ç»“æ„åŒ–æ•°æ®ç®¡ç†ï¼ŒåŒæ—¶å¸Œæœ›æŒæ¡æ•°æ®æ‰€æœ‰æƒã€æ”¯æŒè‡ªæ‰˜ç®¡æˆ–è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼ŒBaserow æ˜¯ä¸€ä¸ªåˆé€‚çš„é€‰æ‹©ã€‚ä½†å¦‚æœéœ€è¦ä¸šåŠ¡æµç¨‹ã€è‡ªåŠ¨åŒ–æˆ–ç•Œé¢æ„å»ºèƒ½åŠ›ï¼Œå®ƒæ›´é€‚åˆä½œä¸ºç³»ç»Ÿçš„æ•°æ®å±‚ï¼Œè€Œéå®Œæ•´çš„åº”ç”¨å¹³å°ã€‚</p>
<h3 data-id="heading-7">NocoDB</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e94ff06d40834512880d3ff696f53e9a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764921548&amp;x-signature=1VN0tNCxb23OK4AMt1mNjG2ON8s%3D" alt="NocoDB.png" loading="lazy"/></p>
<p>å®˜ç½‘ï¼š<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">nocodb.com/</a></p>
<p>NocoDB æ˜¯ä¸€ä¸ªå¼€æºçš„ç”µå­è¡¨æ ¼é£æ ¼æ•°æ®åº“ç®¡ç†å·¥å…·ã€‚å®ƒæä¾›ç±»ä¼¼ Airtable çš„ç•Œé¢ä½“éªŒï¼Œä½†åº•å±‚ä½¿ç”¨çœŸå®çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå¹¶æ”¯æŒè‡ªæ‰˜ç®¡éƒ¨ç½²ã€‚å›¢é˜Ÿå¯ä»¥å°†ç°æœ‰çš„ MySQLã€PostgreSQL æˆ–å…¶ä»–æ•°æ®åº“ç›´æ¥è¿æ¥åˆ° NocoDBï¼Œè®©åŸæœ¬éœ€è¦å·¥ç¨‹å¸ˆæ‰èƒ½ç®¡ç†çš„æ•°æ®åº“ä»¥æ›´å¯è§†åŒ–çš„æ–¹å¼å‘ˆç°ã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>  é€‚ç”¨äºå¸Œæœ›ä»è¡¨æ ¼è¿‡æ¸¡åˆ°æ•°æ®åº“ï¼ŒåŒæ—¶åˆå¸Œæœ›ä¿æŒç±»è¡¨æ ¼ç•Œé¢çš„å›¢é˜Ÿã€‚  å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ•°æ®é‡è¾ƒå¤§ã€éœ€è¦ç”¨å…³ç³»å‹æ•°æ®åº“æ‰¿è½½çš„ä¸šåŠ¡æ•°æ®ç®¡ç†</li>
<li>ä¸­å°å›¢é˜Ÿå¸Œæœ›å¯è§†åŒ–ç®¡ç†æ•°æ®åº“ï¼Œè€Œæ— éœ€ç›´æ¥æ“ä½œ SQL</li>
<li>å°† NocoDB ä½œä¸º API æ•°æ®æºï¼Œæä¾›ç»™å†…éƒ¨å·¥å…·æˆ–å‰ç«¯ç³»ç»Ÿä½¿ç”¨</li>
</ul>
<p><strong>èƒ½åŠ›è¡¨ç°</strong></p>
<ul>
<li><strong>æ•°æ®ç»“æ„èƒ½åŠ›</strong>  NocoDB åº•å±‚åŸºäºçœŸå®çš„å…³ç³»å‹æ•°æ®åº“ï¼Œæ”¯æŒæ›´å¤šå­—æ®µç±»å‹ã€å¤–é”®å…³ç³»å’Œç»“æ„åŒ–æ“ä½œã€‚ç›¸æ¯”æ™®é€šè¡¨æ ¼æˆ–ç±»è¡¨æ ¼å·¥å…·ï¼Œå®ƒåœ¨æ•°æ®ä¸€è‡´æ€§ã€å¤šè¡¨å…³è”å’Œæ•°æ®è§„æ¨¡ä¸Šéƒ½æœ‰æ›´å¼ºçš„è¡¨ç°ã€‚å¯¹å·²æœ‰æ•°æ®åº“çš„å¯è§†åŒ–ç®¡ç†æ˜¯å®ƒçš„é‡è¦ä¼˜åŠ¿ã€‚</li>
<li><strong>æ‰©å±•èƒ½åŠ›</strong>  æ”¯æŒ API è‡ªåŠ¨ç”Ÿæˆã€Webhookã€å¤šç§æ•°æ®åº“è¿æ¥å’Œè‡ªå®šä¹‰è§†å›¾ï¼Œé€‚åˆä½œä¸ºç³»ç»Ÿçš„æ•°æ®åç«¯ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡å…¶è‡ªåŠ¨ç”Ÿæˆçš„ REST API å¿«é€Ÿé›†æˆåˆ°å…¶ä»–å·¥å…·æˆ–å†…éƒ¨é¡¹ç›®ä¸­ï¼Œä½¿å…¶åœ¨å¤šç³»ç»Ÿåä½œç¯å¢ƒä¸­å…·æœ‰è¾ƒé«˜çµæ´»åº¦ã€‚</li>
<li><strong>ä½¿ç”¨é—¨æ§›</strong>  å¯¹éæŠ€æœ¯ç”¨æˆ·æ¥è¯´ï¼Œç•Œé¢ä¸è¡¨æ ¼è¾ƒä¸ºæ¥è¿‘ï¼ŒåŸºæœ¬åŠŸèƒ½å®¹æ˜“ç†è§£ã€‚ä¸è¿‡å¦‚æœæ¶‰åŠæ•°æ®åº“è¿ç§»ã€è¿æ¥æˆ–å¤æ‚ç»“æ„è®¾è®¡ï¼Œä»éœ€è¦ä¸€å®šçš„æŠ€æœ¯èƒ½åŠ›ã€‚å¯¹å·¥ç¨‹å›¢é˜Ÿæ¥è¯´ï¼Œä½¿ç”¨æˆæœ¬ç›¸å¯¹ä½ï¼Œä½†éœ€è¦è´Ÿè´£éƒ¨ç½²ä¸ç»´æŠ¤ã€‚</li>
<li><strong>å±€é™æ€§</strong>  NocoDB çš„æ ¸å¿ƒæ˜¯æ•°æ®ç®¡ç†å’Œæ•°æ®åº“å¯è§†åŒ–ï¼Œå®ƒä¸åŒ…å«ä¸šåŠ¡ç³»ç»Ÿæ„å»ºã€æµç¨‹ç¼–æ’æˆ–å¤æ‚è‡ªåŠ¨åŒ–å†…å®¹ã€‚å¦‚æœå›¢é˜Ÿå¸Œæœ›æ„å»º CRMã€å®¡æ‰¹æµã€åº“å­˜ç³»ç»Ÿç­‰å®Œæ•´åº”ç”¨ï¼ŒNocoDB æ›´é€‚åˆä½œä¸ºæ•°æ®åç«¯ï¼Œè€Œä¸æ˜¯æ»¡è¶³å®Œæ•´ä¸šåŠ¡éœ€æ±‚ã€‚</li>
</ul>
<p><strong>æ€»ç»“</strong>  å¯¹äºéœ€è¦ç®¡ç†ç»“æ„åŒ–æ•°æ®ã€å¸Œæœ›ä»¥å¯è§†åŒ–æ–¹å¼æ“ä½œæ•°æ®åº“ã€å¹¶ä¸”éœ€è¦è‡ªæ‰˜ç®¡æˆ– API è¾“å‡ºèƒ½åŠ›çš„å›¢é˜Ÿï¼ŒNocoDB æ˜¯ä¼˜äºè¡¨æ ¼å·¥å…·çš„é€‰æ‹©ã€‚ä½†å¦‚æœå›¢é˜Ÿçš„éœ€æ±‚å·²ç»å»¶ä¼¸åˆ°æµç¨‹ç¼–æ’ã€å¤šæ¨¡å—ä¸šåŠ¡ç³»ç»Ÿæˆ–æ›´å®Œæ•´çš„åº”ç”¨æ„å»ºï¼Œéœ€è¦å†æ­é…å…¶ä»–å¹³å°è”åˆä½¿ç”¨ã€‚ğŸ’¡æ¨èé˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fnocobase-vs-nocodb" target="_blank" title="https://www.nocobase.com/cn/blog/nocobase-vs-nocodb" ref="nofollow noopener noreferrer">NocoBase ä¸ NocoDBï¼šå¼€æºæ— ä»£ç ï¼ˆé›¶ä»£ç ï¼‰å·¥å…·æ·±åº¦å¯¹æ¯”</a></p>
<h3 data-id="heading-8">Airtable</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86077f2cdc65455888ec4a6ba16e2b6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764921548&amp;x-signature=A9athdR3AmWmhRR4u2h2CKEXaI0%3D" alt="Airtable" loading="lazy"/></p>
<p>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fairtable.com%2F" target="_blank" title="https://airtable.com/" ref="nofollow noopener noreferrer">airtable.com</a></p>
<p>Airtable æ˜¯ä¸€ä¸ªé›†ç”µå­è¡¨æ ¼ã€æ•°æ®åº“å’Œåä½œèƒ½åŠ›äºä¸€ä½“çš„é—­æº SaaS å·¥å…·ã€‚å®ƒæä¾›çµæ´»çš„æ•°æ®ç»“æ„ã€ç›´è§‚çš„ç•Œé¢è®¾è®¡å’Œå¤šäººåœ¨çº¿åä½œï¼Œä½†ä¸æ”¯æŒè‡ªæ‰˜ç®¡æˆ–æœ¬åœ°éƒ¨ç½²ï¼Œæ‰€æœ‰æ•°æ®å‡æ‰˜ç®¡åœ¨ Airtable çš„äº‘ç«¯ã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>  é€‚åˆéœ€è¦æ¯”æ™®é€šè¡¨æ ¼æ›´ç»“æ„åŒ–çš„æ•°æ®ç®¡ç†ï¼Œä½†åˆä¸å¸Œæœ›æŠ•å…¥åç«¯å¼€å‘æˆ–æ­å»ºæ•°æ®åº“çš„å›¢é˜Ÿã€‚å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>å†…å®¹å’Œè¿è¥å›¢é˜Ÿç”¨äºå†…å®¹æ—¥å†ã€ä»»åŠ¡åˆ†é…ã€çŠ¶æ€è¿½è¸ª</li>
<li>å°å‹é¡¹ç›®æˆ–æ´»åŠ¨ç®¡ç†ï¼Œç”¨äºç»Ÿç­¹äººå‘˜ã€è¿›åº¦å’Œäº¤ä»˜ç‰©</li>
<li>åˆåˆ›ä¼ä¸šç”¨äºè”ç³»äººç®¡ç†ã€è½»é‡ CRMã€ä¼šå‘˜è¿è¥ç­‰</li>
</ul>
<p><strong>èƒ½åŠ›è¡¨ç°</strong></p>
<ul>
<li><strong>æ•°æ®ç»“æ„èƒ½åŠ›</strong>  Airtable æ”¯æŒè¡¨ä¸è¡¨ä¹‹é—´å»ºç«‹å…³è”ï¼Œæ•°æ®ç»“æ„æ¯”ä¼ ç»Ÿç”µå­è¡¨æ ¼æ›´æ¸…æ™°ï¼Œæ›´é€‚åˆç®¡ç†è½»é‡åˆ°ä¸­ç­‰å¤æ‚åº¦çš„æ•°æ®æ¨¡å‹ã€‚ğŸ’¡æ¨èé˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fairtable-data-limit-reached-3-common-solutions" target="_blank" title="https://www.nocobase.com/cn/blog/airtable-data-limit-reached-3-common-solutions" ref="nofollow noopener noreferrer">Airtable çš„æ•°æ®è¶…å‡ºä¸Šé™ï¼Œ3 ç§å¸¸è§åº”å¯¹æ–¹å¼</a></li>
<li><strong>åä½œä¸æƒé™</strong>  æä¾›åŸºç¡€çš„å¤šäººåä½œåŠŸèƒ½ï¼ŒåŒ…æ‹¬æŸ¥çœ‹ã€ç¼–è¾‘ã€è¯„è®ºå’Œæƒé™åˆ†é…ã€‚ç›¸æ¯”æœ¬åœ°è¡¨æ ¼ï¼Œå®ƒåœ¨åä½œåœºæ™¯ä¸­çš„ä½“éªŒæ›´ä¸ºé¡ºç•…ï¼Œä¹Ÿæ›´å®¹æ˜“ä¿æŒæ•°æ®ä¸€è‡´ã€‚</li>
<li><strong>ä½¿ç”¨é—¨æ§›</strong>  å¯¹éæŠ€æœ¯ç”¨æˆ·éå¸¸å‹å¥½ï¼Œä¸éœ€è¦å†™ä»£ç å³å¯æ­å»ºåŸºç¡€çš„æ•°æ®ç»“æ„å’Œè§†å›¾ã€‚ç•Œé¢ç›´è§‚ï¼Œå­¦ä¹ æˆæœ¬è¾ƒä½ã€‚</li>
<li><strong>å±€é™æ€§</strong>  å½“æ•°æ®é‡å¢å¤§ã€ä¸šåŠ¡éœ€è¦æ›´å¤šè¡¨ç»“æ„ã€æ›´åŠ ç»†è‡´çš„æƒé™æ§åˆ¶æˆ–è‡ªåŠ¨åŒ–æµç¨‹æ—¶ï¼ŒAirtable çš„èƒ½åŠ›ä¼šé€æ¸å—åˆ°é™åˆ¶ã€‚</li>
</ul>
<p><strong>æ€»ç»“</strong>  å¦‚æœå›¢é˜Ÿéœ€è¦ä¸€å¥—æ¯” Google Sheets æ›´ç»“æ„åŒ–ã€æ›´ä¾¿äºåä½œçš„å·¥å…·ï¼Œè€Œä¸æ¶‰åŠå¤æ‚é€»è¾‘æˆ–è‡ªåŠ¨åŒ–åœºæ™¯ï¼ŒAirtable æ˜¯ä¸€ä¸ªå®ç”¨çš„é€‰æ‹©ã€‚ä½†å¦‚æœä¸šåŠ¡é€æ¸æ‰©å¤§ï¼Œéœ€è¦æ›´ç²¾ç»†çš„æƒé™ã€æ›´å¤šè¡¨ä¹‹é—´çš„å…³ç³»æˆ–æ›´å®Œæ•´çš„è‡ªåŠ¨åŒ–ä½“ç³»ï¼ŒAirtable å¯èƒ½æ— æ³•æ»¡è¶³åç»­çš„å‘å±•éœ€æ±‚ã€‚</p>
<p>ğŸ’¡æ¨èé˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2F5-self-hosted-airtable-alternatives" target="_blank" title="https://www.nocobase.com/cn/blog/5-self-hosted-airtable-alternatives" ref="nofollow noopener noreferrer">Airtable å¤ªè´µäº†ï¼Ÿ5 ä¸ªè‡ªæ‰˜ç®¡æ›¿ä»£æ–¹æ¡ˆæˆæœ¬&amp;åŠŸèƒ½å¯¹æ¯”</a></p>
<h3 data-id="heading-9">Smartsheet</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6e2639b18e345ea804fc24baebc522e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764921548&amp;x-signature=iUSQWnPopr1yaygsT4Jm8YQxQVk%3D" alt="Smartsheet.png" loading="lazy"/></p>
<p>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.smartsheet.com%2F" target="_blank" title="https://www.smartsheet.com/" ref="nofollow noopener noreferrer">www.smartsheet.com/</a></p>
<p>Smartsheet æ˜¯ä¸€æ¬¾é¢å‘ä¼ä¸šçº§é¡¹ç›®ç®¡ç†å’Œåä½œçš„é—­æº SaaS å·¥å…·ã€‚å®ƒä»¥ç”µå­è¡¨æ ¼ä¸ºåŸºç¡€ç•Œé¢ï¼Œä½†å¼ºåŒ–äº†ä»»åŠ¡ç®¡ç†ã€ç”˜ç‰¹å›¾ã€è‡ªåŠ¨åŒ–æµç¨‹ä¸ä¼ä¸šæƒé™èƒ½åŠ›ï¼Œé€‚ç”¨äºæ›´è§„èŒƒåŒ–çš„å›¢é˜Ÿåä½œåœºæ™¯ã€‚Smartsheet åŒæ ·ä¸æ”¯æŒè‡ªæ‰˜ç®¡ï¼Œæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å…¶äº‘ç«¯æœåŠ¡ä¸­ã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>  é€‚åˆéœ€è¦åœ¨è¡¨æ ¼åŸºç¡€ä¸Šè¿›ä¸€æ­¥è§„èŒƒä»»åŠ¡ç®¡ç†ã€æµç¨‹åä½œå’Œè·¨éƒ¨é—¨é¡¹ç›®æ¨è¿›çš„å›¢é˜Ÿã€‚  å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä¸­å¤§å‹å›¢é˜Ÿçš„é¡¹ç›®è®¡åˆ’ã€è¿›åº¦ç®¡ç†ã€èµ„æºæ’æœŸ</li>
<li>è¿è¥å›¢é˜Ÿçš„æ´»åŠ¨ç®¡ç†ã€å®¡æ‰¹æµã€ä»»åŠ¡åˆ†é…</li>
<li>ä¼ä¸š PMO/è¿è¥ç®¡ç†éƒ¨é—¨çš„å¤šé¡¹ç›®ååŒã€è¿›åº¦å¯è§†åŒ–</li>
</ul>
<p><strong>èƒ½åŠ›è¡¨ç°</strong></p>
<ul>
<li><strong>åä½œä¸æƒé™</strong> Smartsheet æä¾›è¾ƒä¸ºå®Œå–„çš„æƒé™ä½“ç³»ï¼ŒåŒ…å«è¡Œçº§å…±äº«ã€æŸ¥çœ‹/ç¼–è¾‘æ§åˆ¶ã€å®¡æ‰¹æµã€ä»¥åŠåŸºäºè§’è‰²çš„è®¿é—®è®¾ç½®ï¼Œé€‚åˆå¤šäººå¹¶è¡Œåä½œçš„é¡¹ç›®ç®¡ç†ç¯å¢ƒã€‚åœ¨æƒé™ç»†ç²’åº¦å’Œæµç¨‹ç®¡ç†ä¸Šï¼Œç›¸æ¯”ä¸€èˆ¬çš„è¡¨æ ¼ç±»å·¥å…·æ›´æˆç†Ÿã€‚</li>
<li><strong>è‡ªåŠ¨åŒ–ä¸æµç¨‹ç®¡ç†</strong> å…·æœ‰åŸºäºè§¦å‘æ¡ä»¶çš„è‡ªåŠ¨åŒ–åŠŸèƒ½ï¼Œå¦‚ä»»åŠ¡æé†’ã€çŠ¶æ€æ›´æ–°ã€å®¡æ‰¹æµã€è·¨è¡¨åŒæ­¥ç­‰ï¼Œé™ä½æ‰‹å·¥æ›´æ–°çš„æˆæœ¬ã€‚å¯¹äºéœ€è¦å°†ä»»åŠ¡æµã€å®¡æ‰¹ã€é¡¹ç›®èŠ‚ç‚¹ä¸²è”èµ·æ¥çš„å›¢é˜Ÿï¼Œå®ƒèƒ½æä¾›ç›¸å¯¹ç¨³å®šçš„æµç¨‹æ”¯æŒã€‚</li>
<li><strong>ä½¿ç”¨é—¨æ§›</strong> ç•Œé¢ä¾æ—§æ˜¯è¡¨æ ¼é£æ ¼ï¼ŒåŸºç¡€ä½¿ç”¨ä¸éœ€è¦æŠ€æœ¯èƒŒæ™¯ï¼Œä½†è¦å……åˆ†å‘æŒ¥å…¶é¡¹ç›®ç®¡ç†å’Œè‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œéœ€è¦ä¸€å®šçš„å­¦ä¹ æˆæœ¬ã€‚å¯¹äºä¸ç†Ÿæ‚‰ç»“æ„åŒ–é¡¹ç›®ç®¡ç†çš„å›¢é˜Ÿï¼Œå‰æœŸå¯èƒ½ä¼šæ„Ÿåˆ°åâ€œé‡â€å’Œå¤æ‚ã€‚</li>
<li><strong>å±€é™æ€§</strong>  Smartsheet çš„ç»“æ„çµæ´»åº¦ä¸åŠæ•°æ®åº“å‹æˆ–åº”ç”¨å‹å¹³å°ï¼Œåœ¨æ•°æ®ä¹‹é—´çš„å…³ç³»è¡¨è¾¾ä¸Šèƒ½åŠ›æœ‰é™ï¼›è‡ªå®šä¹‰ç¨‹åº¦ä¹Ÿå—åˆ°å·¥å…·è‡ªèº«æ¡†æ¶é™åˆ¶ã€‚æ­¤å¤–ï¼Œç”±äºå…¶å®šä½åä¼ä¸šçº§ï¼Œæ•´ä½“ä½“éªŒå’Œä»·æ ¼ç›¸æ¯”è½»é‡å·¥å…·æ›´â€œé‡â€ï¼Œåœ¨å°å›¢é˜Ÿåœºæ™¯ä¸‹å¯èƒ½ä¸å¤Ÿè½»ä¾¿ã€‚</li>
</ul>
<p><strong>æ€»ç»“</strong>  å¦‚æœå›¢é˜Ÿçš„æ ¸å¿ƒéœ€æ±‚æ˜¯ä»¥è¡¨æ ¼ä¸ºç•Œé¢ï¼Œå¼€å±•æ›´è§„èŒƒåŒ–çš„é¡¹ç›®ç®¡ç†ã€èµ„æºæ’æœŸå’Œåä½œæµç¨‹ï¼ŒSmartsheet ä¼šæ¯” Google Sheets æ›´ç¨³å®šã€åŠŸèƒ½æ›´å…¨é¢ã€‚ä½†å¦‚æœä½ å¸Œæœ›åœ¨æ•°æ®ç»“æ„ã€çµæ´»å»ºæ¨¡æˆ–è‡ªå®šä¹‰åº”ç”¨ä¸Šæœ‰æ›´æ·±çš„èƒ½åŠ›ï¼Œå®ƒçš„æ¡†æ¶å¯èƒ½ä¼šæ˜¾å¾—è¾ƒä¸ºå›ºå®šã€‚</p>
<h2 data-id="heading-10">ç»“è¯­</h2>
<p>Google Sheets æ˜¯ä¸€ä¸ªä¼˜ç§€çš„è¡¨æ ¼å·¥å…·ï¼Œä½†å¹¶ä¸æ˜¯ä¸ºä¸šåŠ¡ç³»ç»Ÿè€Œè®¾è®¡çš„ã€‚</p>
<p>å½“æ•°æ®è§„æ¨¡å˜å¤§ã€åä½œå¤æ‚åº¦æå‡ã€æµç¨‹å¼€å§‹ä¾èµ–ç»“æ„åŒ–ç®¡ç†æ—¶ï¼Œå›¢é˜Ÿå¾€å¾€ä¼šéœ€è¦æ˜ç¡®çš„æ•°æ®æ¨¡å‹ã€æ›´ç»†è‡´çš„æƒé™æ§åˆ¶ã€è‡ªåŠ¨åŒ–çš„ä¸šåŠ¡æµè½¬ã€å¯æ§çš„æ•°æ®ç¯å¢ƒï¼Œä»¥åŠèƒ½å¤Ÿéšä¸šåŠ¡æ‰©å±•çš„ç³»ç»Ÿèƒ½åŠ›ã€‚</p>
<p>å¸Œæœ›è¿™ä¸€ä»½å·¥å…·æ¸…å•ï¼Œèƒ½å¤Ÿè®©å›¢é˜Ÿåœ¨è¯„ä¼°æ›¿ä»£æ–¹æ¡ˆæ—¶æœ‰æ›´æ¸…æ™°çš„è§†è§’â€”â€”ä»ä½¿ç”¨åœºæ™¯ã€æ ¸å¿ƒèƒ½åŠ›åˆ°ä»·æ ¼ä¸æˆæœ¬ï¼Œå¸®åŠ©ä½ åœ¨æ—©æœŸå°±åˆ¤æ–­å“ªç§å·¥å…·æ›´è´´è¿‘è‡ªå·±çš„å®é™…éœ€æ±‚ã€‚</p>
<p>å¦‚æœè¿™äº›å†…å®¹å¯¹ä½ æœ‰å¯å‘ï¼Œä¹Ÿæ¬¢è¿ä½ åˆ†äº«ç»™åŒæ ·åœ¨å¯»æ‰¾å·¥å…·çš„å›¢é˜Ÿï¼Œä¹Ÿè®¸èƒ½å¸®åŠ©æ›´å¤šäººæ›´å¿«åœ°æ‰¾åˆ°åˆé€‚çš„æ–¹æ¡ˆã€‚</p>
<p>ç›¸å…³é˜…è¯»ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2F6-open-source-no-low-code-tools-for-building-pocs" target="_blank" title="https://www.nocobase.com/cn/blog/6-open-source-no-low-code-tools-for-building-pocs" ref="nofollow noopener noreferrer">6ä¸ªé€‚åˆåš PoC çš„å¼€æºæ— ä»£ç /ä½ä»£ç å·¥å…·æ¨è </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fa-developers-technical-decision-guide-to-no-code-and-low-code" target="_blank" title="https://www.nocobase.com/cn/blog/a-developers-technical-decision-guide-to-no-code-and-low-code" ref="nofollow noopener noreferrer">ç»™å¼€å‘è€…çš„æ— ä»£ç /ä½ä»£ç æŠ€æœ¯å†³ç­–æŒ‡å—ï¼ˆ2026ï¼‰</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2F6-in-depth-comparison-rbac-no-code-low-code-platforms" target="_blank" title="https://www.nocobase.com/cn/blog/6-in-depth-comparison-rbac-no-code-low-code-platforms" ref="nofollow noopener noreferrer">6 å¤§ä¼ä¸šçº§æ— ä»£ç ä½ä»£ç å¹³å° RBAC æƒé™ä½“ç³»æ·±åº¦å¯¹æ¯”</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2F14-ai-low-code-platforms-github" target="_blank" title="https://www.nocobase.com/cn/blog/14-ai-low-code-platforms-github" ref="nofollow noopener noreferrer">GitHub ä¸Šæœ€å€¼å¾—å…³æ³¨çš„ 14 ä¸ªå¼€æº AI ä½ä»£ç å·¥å…· </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Ftop-11-github-open-source-no-code-ai-tools" target="_blank" title="https://www.nocobase.com/cn/blog/top-11-github-open-source-no-code-ai-tools" ref="nofollow noopener noreferrer">11 ä¸ªåœ¨ GitHub ä¸Šæœ€å—æ¬¢è¿çš„å¼€æºæ— ä»£ç  AI å·¥å…· </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fgithub-open-source-ai-agent-projects" target="_blank" title="https://www.nocobase.com/cn/blog/github-open-source-ai-agent-projects" ref="nofollow noopener noreferrer">GitHub ä¸Š Star æ•°é‡å‰ 18 çš„å¼€æº AI Agent é¡¹ç›®</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fgithub-open-source-ai-projects" target="_blank" title="https://www.nocobase.com/cn/blog/github-open-source-ai-projects" ref="nofollow noopener noreferrer">GitHub ä¸Š Star æ•°é‡å‰ 20 çš„å¼€æº AI é¡¹ç›®</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœé˜³æ°¸ç»­åŸºäºé˜¿é‡Œäº‘ Milvus æ„å»ºé‡‘èæ™ºèƒ½æŠ•ç ”äº§å“â€œAI å°äºŒâ€]]></title>    <link>https://juejin.cn/post/7577356848337846307</link>    <guid>https://juejin.cn/post/7577356848337846307</guid>    <pubDate>2025-11-28T07:59:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577356848337846307" data-draft-id="7577345758036049920" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœé˜³æ°¸ç»­åŸºäºé˜¿é‡Œäº‘ Milvus æ„å»ºé‡‘èæ™ºèƒ½æŠ•ç ”äº§å“â€œAI å°äºŒâ€"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-11-28T07:59:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2414974667341287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœé˜³æ°¸ç»­åŸºäºé˜¿é‡Œäº‘ Milvus æ„å»ºé‡‘èæ™ºèƒ½æŠ•ç ”äº§å“â€œAI å°äºŒâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2414974667341287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:59:57.000Z" title="Fri Nov 28 2025 07:59:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å®¢æˆ·ç®€ä»‹</h2>
<p>æœé˜³æ°¸ç»­æ˜¯å…ˆè¿›çš„é‡‘èæ•°æ®ä¸æ™ºèƒ½æœåŠ¡æä¾›å•†ï¼Œè‡´åŠ›äºä¸ºåŸºé‡‘ç®¡ç†å…¬å¸ã€è¯åˆ¸ç ”ç©¶æœºæ„åŠä¸“ä¸šæŠ•èµ„è€…æä¾›é«˜è´¨é‡ã€ç²¾å‡†å’Œå…¨é¢çš„æ•°æ®åˆ†æä¸å†³ç­–æ”¯æŒå·¥å…·ã€‚ä¾æ‰˜å¤šå¹´æ·±è€•é‡‘èè¡Œä¸šçš„æ•°æ®ç§¯ç´¯ä¸æŠ•ç ”ç»éªŒï¼Œæœé˜³æ°¸ç»­æ¨å‡ºå…¶æ ¸å¿ƒäº§å“â€”â€”AI å°äºŒï¼Œä¸€æ¬¾èåˆå¤§æ¨¡å‹æŠ€æœ¯çš„ AI é‡‘èæŠ•ç ”æ™ºèƒ½ä½“ã€‚</p>
<p>AI å°äºŒåŸºäºç”Ÿæˆå¼ AI èƒ½åŠ›ï¼Œç»“åˆé˜¿é‡Œäº‘å‘é‡æ£€ç´¢æœåŠ¡ Milvus ç‰ˆï¼ˆç®€ç§°é˜¿é‡Œäº‘ Milvusï¼‰ï¼Œæ‰“é€ äº†é›†â€œæ™ºèƒ½é—®ç­”ã€æé€Ÿç ”ç©¶ã€æ·±åº¦åˆ†æã€ä¸»é¢˜æ¨èã€æŠ¥è¡¨ç”Ÿæˆâ€äºä¸€ä½“çš„æ™ºèƒ½åŒ–æŠ•ç ”å¹³å°ï¼Œå…¨é¢èµ‹èƒ½æŠ•èµ„ç ”ç©¶æµç¨‹ï¼Œæ˜¾è‘—æå‡ç”¨æˆ·çš„ç ”ç©¶æ•ˆç‡ä¸å†³ç­–è´¨é‡ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/01/0131dd7e6fe68254a4f00b38dc34da63.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€ä¸šåŠ¡èƒŒæ™¯ä¸è¯‰æ±‚</h2>
<p>åœ¨é‡‘èæŠ•ç ”é¢†åŸŸï¼Œä¿¡æ¯çš„å‡†ç¡®æ€§ã€æƒå¨æ€§å’Œæ—¶æ•ˆæ€§è‡³å…³é‡è¦ã€‚AI å°äºŒä½œä¸ºé¢å‘ä¸“ä¸šç”¨æˆ·çš„ä¸¥è°¨å‹ AI åº”ç”¨ï¼Œè¦æ±‚æ‰€æœ‰è¾“å‡ºå†…å®¹å¿…é¡»å…·å¤‡å¯è¿½æº¯çš„ä¿¡æºä¾æ®ï¼Œå¹¶ç¡®ä¿å¼•ç”¨è§‚ç‚¹æ¥è‡ªæƒå¨ã€åˆè§„çš„æ•°æ®æ¥æºã€‚</p>
<p>ç„¶è€Œï¼Œåœ¨é¢å¯¹æ—¥ç›Šå¢é•¿çš„å¤šæºå¼‚æ„é‡‘èæ•°æ®æ—¶ï¼Œä¼ ç»ŸæŠ€æœ¯æ¶æ„é¢ä¸´å››å¤§æ ¸å¿ƒæŒ‘æˆ˜ï¼š</p>
<h4 data-id="heading-2">1. æ•°æ®è§„æ¨¡åºå¤§ä¸”å¤æ‚åº¦é«˜</h4>
<p>æœé˜³æ°¸ç»­éœ€å¤„ç†åŒ…æ‹¬ä¸Šå¸‚å…¬å¸å…¬å‘Šã€è´¢æŠ¥ã€å–æ–¹ç ”ç©¶æŠ¥å‘Šã€æ–°é—»èµ„è®¯ã€åŸºé‡‘æ•°æ®åœ¨å†…çš„æµ·é‡éç»“æ„åŒ–ä¸åŠç»“æ„åŒ–æ•°æ®ï¼Œæ—¥å‡æ–°å¢æ•°æ®é‡æŒç»­æ”€å‡ã€‚ä¼ ç»Ÿçš„å…³é”®è¯æ£€ç´¢æ–¹å¼éš¾ä»¥ç†è§£è¯­ä¹‰å…³è”ï¼Œæ— æ³•æ»¡è¶³ç”¨æˆ·å¯¹ç²¾å‡†åŒ¹é…çš„éœ€æ±‚ã€‚</p>
<h4 data-id="heading-3">2. æ£€ç´¢ç²¾åº¦ä¸å¬å›ç‡éš¾ä»¥å…¼é¡¾</h4>
<p>ç”¨æˆ·å¸¸ä»¥è‡ªç„¶è¯­è¨€æå‡ºå¤æ‚æŸ¥è¯¢éœ€æ±‚ï¼Œä¾‹å¦‚ï¼šâ€œæŸå…¬å¸åœ¨è¿‡å»å››ä¸ªè´¢æŠ¥å­£ä¸­ç®¡ç†å±‚è¡¨è¿°çš„å˜åŒ–è¶‹åŠ¿â€ã€‚æ­¤ç±»é—®é¢˜æ¶‰åŠè·¨æ–‡æ¡£ã€è·¨æ—¶é—´ç»´åº¦çš„è¯­ä¹‰ç†è§£ï¼Œä¼ ç»Ÿç³»ç»Ÿå› ç¼ºä¹ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›ï¼Œå¯¼è‡´æ¼æ£€ç‡é«˜ã€è¯¯åˆ¤é¢‘å‘ï¼Œä¸¥é‡å½±å“ç ”ç©¶ç»“æœçš„å¯é æ€§ã€‚</p>
<h4 data-id="heading-4">3. ç³»ç»Ÿæ€§èƒ½ä¸ç¨³å®šæ€§å‹åŠ›å·¨å¤§</h4>
<p>é‡‘èå¸‚åœºå…·æœ‰æå¼ºçš„å®æ—¶æ€§è¦æ±‚ï¼Œå°¤å…¶åœ¨äº¤æ˜“æ—¶æ®µï¼Œä»»ä½•å»¶è¿Ÿéƒ½å¯èƒ½å½±å“æŠ•èµ„å†³ç­–ã€‚åŸæœ‰è‡ªå»ºæ£€ç´¢ç³»ç»Ÿåœ¨æ•°æ®é‡è¾¾åˆ°äº¿çº§åï¼Œå‡ºç°æŸ¥è¯¢å»¶è¿Ÿæ³¢åŠ¨ã€èŠ‚ç‚¹è´Ÿè½½ä¸å‡ç­‰é—®é¢˜ï¼Œéƒ¨åˆ†å¤æ‚æŸ¥è¯¢å“åº”æ—¶é—´è¶…è¿‡æ•°åˆ†é’Ÿï¼Œå·²æ— æ³•æ»¡è¶³é«˜é¢‘ã€ä½å»¶è¿Ÿçš„ä¸šåŠ¡éœ€æ±‚ã€‚</p>
<h4 data-id="heading-5">4. è¿ç»´æˆæœ¬é«˜æ˜‚ï¼Œèµ„æºç®¡ç†å¤æ‚</h4>
<p>éšç€é›†ç¾¤è§„æ¨¡æ‰©å¤§ï¼Œè¿ç»´å›¢é˜Ÿéœ€æŠ•å…¥å¤§é‡äººåŠ›è¿›è¡Œç›‘æ§ã€è°ƒä¼˜ã€æ•…éšœæ¢å¤å’Œç‰ˆæœ¬å‡çº§ã€‚è¿™ä¸ä»…å¢åŠ äº†è¿è¥è´Ÿæ‹…ï¼Œä¹Ÿä¸¥é‡æŒ¤å äº†æ ¸å¿ƒæŠ€æœ¯ç ”å‘çš„æ—¶é—´ä¸èµ„æºã€‚</p>
<h2 data-id="heading-6">ä¸‰ã€é˜¿â¾¥äº‘çš„è§£å†³â½…æ¡ˆ</h2>
<p>ä¸ºçªç ´ä¸Šè¿°ç“¶é¢ˆï¼Œæœé˜³æ°¸ç»­æºæ‰‹é˜¿é‡Œäº‘ï¼Œå¼•å…¥ é˜¿é‡Œäº‘å‘é‡æ£€ç´¢æœåŠ¡ Milvus ç‰ˆï¼Œæ„å»ºé«˜æ€§èƒ½ã€é«˜å¯ç”¨çš„é‡‘èçº§è¯­ä¹‰æ£€ç´¢åº•åº§ï¼Œæ”¯æ’‘ AI å°äºŒå®ç°ä»â€œæ•°æ®åˆ°æ´å¯Ÿâ€çš„é«˜æ•ˆè½¬åŒ–ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/72/7265a112666875b85445d5d97f830171.png" alt="" loading="lazy"/></p>
<p>ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¶æ„ï¼š</p>
<ul>
<li>
<p>åº•å±‚ï¼šå­˜å‚¨æ±‡èšä¸Šå¸‚å…¬å¸å…¬å‘Šã€ç ”æŠ¥ã€è´¢æŠ¥ç­‰åŸå§‹æ–‡æœ¬æ•°æ®ï¼›</p>
</li>
<li>
<p>ä¸­é—´å±‚ï¼šé€šè¿‡ç»ç”± PDF è§£æã€ Embedding ç­‰å¤„ç†ç¯èŠ‚å½¢æˆå‘é‡åŒ–æ•°æ®ï¼Œå¹¶å­˜å…¥é˜¿é‡Œäº‘ Milvusï¼›</p>
</li>
<li>
<p>ä¸Šå±‚ï¼šåˆ©ç”¨é˜¿é‡Œäº‘ Milvus å¼ºå¤§çš„è¯­ä¹‰æ£€ç´¢ä¸æ¡ä»¶è¿‡æ»¤èƒ½åŠ›ï¼Œå®ç°å¤šæ¨¡æ€å¬å›ï¼›</p>
</li>
<li>
<p>æ¥å…¥å±‚ï¼šé€šè¿‡æ ‡å‡†åŒ–æ¥å£ä¸º AI å°äºŒæä¾›ä½å»¶è¿Ÿã€é«˜å¹¶å‘çš„æ£€ç´¢æœåŠ¡ã€‚</p>
</li>
</ul>
<p>æ•´ä¸ªç³»ç»Ÿå®ç°äº†ä»æ•°æ®æ‘„å…¥ã€å‘é‡åŒ–ã€å­˜å‚¨åˆ°æ£€ç´¢çš„å…¨é“¾è·¯è‡ªåŠ¨åŒ–ï¼Œä¸ºé‡‘èçº§ AI åº”ç”¨æä¾›äº†åšå®çš„æŠ€æœ¯æ”¯æ’‘ã€‚</p>
<h2 data-id="heading-7">å››ã€å…¸å‹åº”ç”¨åœºæ™¯ä¸æ•ˆæœéªŒè¯</h2>
<p><strong>æ¡ˆä¾‹ä¸€ï¼šè¿½è¸ªä¸Šå¸‚å…¬å¸â€œäº’åŠ¨æ˜“â€è¡¨è¿°å˜åŒ–ï¼ˆä¸Šå¸‚å…¬å¸äº’åŠ¨æ˜“æ•°æ®ï¼‰</strong></p>
<p>ä¸Šå¸‚å…¬å¸åœ¨å†å²å¤šæ—¶æœŸå†…çš„äº’åŠ¨æ˜“è¡¨è¿°ï¼Œå¾€å¾€éšå«ç®¡ç†å±‚å¯¹æœªæ¥ä¸šç»©ã€è¡Œä¸šè¶‹åŠ¿çš„å‰ç»æ€§åˆ¤æ–­ã€‚è¿™ç±»éç»“æ„åŒ–æ–‡æœ¬éš¾ä»¥é€šè¿‡å…³é”®è¯æ£€ç´¢å‡†ç¡®æå–ã€‚</p>
<p>å€ŸåŠ©é˜¿é‡Œäº‘ Milvus çš„é«˜ç²¾åº¦è¯­ä¹‰åŒ¹é…èƒ½åŠ›ï¼ŒAI å°äºŒèƒ½å¤Ÿå¿«é€Ÿå®šä½å¹¶å¬å›ç‰¹å®šæ—¶é—´æ®µå†…ç›¸å…³é—®ç­”å†…å®¹ï¼Œå¸®åŠ©ç ”ç©¶å‘˜é«˜æ•ˆæ•æ‰ä¼ä¸šæˆ˜ç•¥åŠ¨å‘ä¸æƒ…ç»ªå˜åŒ–ï¼Œæ˜¾è‘—æå‡ä¿¡æ¯æŒ–æ˜æ•ˆç‡ã€‚</p>
<p><strong>æ¡ˆä¾‹äºŒï¼šåˆ†æå–æ–¹åˆ†æå¸ˆè§‚ç‚¹æ¼”å˜ï¼ˆå–æ–¹ç ”æŠ¥æ•°æ®ï¼‰</strong></p>
<p>æœé˜³æ°¸ç»­ç´¯è®¡æ”¶å½•è¶…300ä¸‡ä»½ç»åˆè§„æˆæƒçš„å–æ–¹ç ”ç©¶æŠ¥å‘Šï¼Œæ¯æ—¥æ–°å¢æ•°åƒç¯‡ã€‚æŠ•èµ„è€…å¸¸éœ€åˆ†ææŸåˆ†æå¸ˆå¯¹æŸä¸€å…¬å¸çš„é•¿æœŸè§‚ç‚¹æ¼”å˜ã€‚</p>
<p>é˜¿é‡Œäº‘ Milvus æ”¯æŒå¤§è§„æ¨¡å‘é‡å®æ—¶å†™å…¥ä¸é«˜æ•ˆæ£€ç´¢ï¼Œåœ¨è´¢æŠ¥æŠ«éœ²é«˜å³°æœŸä»èƒ½ç¨³å®šå“åº”å¤æ‚æŸ¥è¯¢ï¼Œç¡®ä¿ç”¨æˆ·åŠæ—¶è·å–æœ€æ–°å¸‚åœºç ”åˆ¤ï¼Œå¼ºåŒ–æŠ•ç ”æ—¶æ•ˆæ€§ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/af/af70581abbec1d653beed1b7f46366ea.png" alt="" loading="lazy"/></p>
<p><strong>æ¡ˆä¾‹ä¸‰ï¼šè§£è¯»è´¢æŠ¥ä¸­çš„ç®¡ç†å±‚è¡¨è¿°ï¼ˆä¸Šå¸‚å…¬å¸è´¢æŠ¥æ•°æ®ï¼‰</strong></p>
<p>è´¢æŠ¥ä¿¡æ¯æ˜¯ä¼—å¤šä¸“ä¸šæŠ•èµ„è€…å…³æ³¨çš„é‡è¦ä¸€æ‰‹ä¿¡æ¯ï¼Œå…¶ä¸­ï¼Œç®¡ç†å±‚åœ¨è´¢æŠ¥ä¸­çš„ç»è¥è¡¨è¿°å¯èƒ½è•´å«é‡è¦çš„æŠ•èµ„ä¿¡æ¯ã€‚AI å°äºŒé€šè¿‡å°†ç™¾ä¸‡çº§è´¢æŠ¥æ–‡æœ¬å‘é‡åŒ–ï¼Œå¹¶åŸºäºé˜¿é‡Œäº‘ Milvus å®ç°ç²¾å‡†è¯­ä¹‰å¬å›ï¼Œå¯å¿«é€Ÿæå–ä¸ç”¨æˆ·é—®é¢˜ç›¸å…³çš„æ®µè½ï¼Œå†ç”±å¤§æ¨¡å‹è¿›è¡Œæƒ…æ„Ÿåˆ†æä¸è¶‹åŠ¿æç‚¼ï¼Œå¤§å¹…æå‡ä¸“ä¸šæŠ•èµ„è€…è´¢æŠ¥ç ”ç©¶æ•ˆç‡ã€‚</p>
<h2 data-id="heading-8">äº”ã€ä¸ºä»€ä¹ˆé€‰æ‹©é˜¿â¾¥äº‘ Milvus</h2>
<p>åœ¨å‘é‡æ•°æ®åº“é€‰å‹è¿‡ç¨‹ä¸­ï¼Œæœé˜³æ°¸ç»­æ›¾é•¿æœŸä½¿ç”¨å¼€æº PostgreSQL å‘é‡æ‰©å±•æ–¹æ¡ˆï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­æš´éœ²å‡ºæ€§èƒ½ç“¶é¢ˆä¸è¿ç»´éš¾é¢˜ã€‚æœ€ç»ˆå…¨é¢è¿ç§»è‡³ é˜¿é‡Œäº‘ Milvus å‘é‡æ£€ç´¢æœåŠ¡ï¼Œä¸»è¦åŸºäºä»¥ä¸‹ä¸‰å¤§å…³é”®è€ƒé‡ï¼š</p>
<p><strong>1. æ€§èƒ½é£è·ƒï¼šæŸ¥è¯¢é€Ÿåº¦æå‡åå€ä»¥ä¸Š</strong></p>
<ul>
<li>
<p>ç»éªŒè¯ï¼šå¼€æº PG åº“å¹³å‡å“åº”é€Ÿåº¦600msï¼Œé˜¿é‡Œäº‘Milvuså¹³å‡å“åº”é€Ÿåº¦50ms</p>
</li>
<li>
<p>å·²æœ‰çš„ä¸Šå¸‚å…¬å¸å…¬å‘Šã€åŸºé‡‘å…¬å¸å…¬å‘Šã€å–æ–¹ç ”ç©¶æŠ¥å‘Šï¼Œä¸“åˆ©åŠæ³•å¾‹æ–‡æ¡£ç­‰ï¼ŒEmbeddingå®Œæˆåï¼Œå‘é‡çš„æ•°é‡çº§å·²è¾¾åˆ°åäº¿é‡çº§ã€‚å¼€æº PG åº“åœ¨ç»“åˆæ ‡é‡æ¡ä»¶ç­›é€‰ï¼Œå¹¶å¼€å¯å‘é‡æ£€ç´¢å’Œå…¨æ–‡æ£€ç´¢çš„æ··åˆæ£€ç´¢æ¨¡å¼ä¸‹ï¼Œå¹³å‡å“åº”æ—¶é—´å·²å†²åˆ°600msï¼Œæç«¯æƒ…å†µé•¿è¾¾æ•°åˆ†é’Ÿã€‚åˆ‡æ¢è‡³é˜¿é‡Œäº‘ Milvus åï¼ŒåŒæ ·è§„æ¨¡çš„æ•°æ®ï¼Œç±»ä¼¼çš„æ£€ç´¢æ–¹å¼ï¼Œå¹³å‡å“åº”é€Ÿåº¦æå‡è‡³50msï¼Œæé€Ÿåå€ä»¥ä¸Šï¼Œå……åˆ†æ»¡è¶³é‡‘èä¸šåŠ¡å¯¹å®æ—¶æ€§çš„ä¸¥è‹›è¦æ±‚ã€‚</p>
</li>
</ul>
<p><strong>2. è¿ç»´å¤§å¹…é™ä½ï¼Œå·¥ä½œé‡ä¸‹é™80%</strong></p>
<ul>
<li>
<p>å¼€æº PG æ–¹æ¡ˆéµå¾ªä¸€åˆ‡è‡ªå·±åŠ¨æ‰‹çš„åŸåˆ™ï¼Œå¤§é‡ç›‘æ§æ¡†æ¶å‡éœ€è¦æ­é…å…¶ä»–å¼€æºé¡¹ç›®è¿›è¡Œéƒ¨ç½²ï¼Œéœ€è¦èŠ±è´¹è¿ç»´äººå‘˜å¤§é‡çš„æ—¶é—´è°ƒç ”ï¼Œä¸”ä¸å®Œå…¨ç¬¦åˆè¿ç»´éœ€è¦ï¼Œé¡»å®šåˆ¶æ•´åˆï¼Œæˆæœ¬é«˜ï¼Œè¿ç»´éš¾åº¦å¤§ã€‚</p>
</li>
<li>
<p>é˜¿é‡Œäº‘ Milvus å…·å¤‡å®Œå–„çš„ç›‘æ§èƒ½åŠ›ï¼Œæä¾›åŒ…æ‹¬ CPU å’Œå†…å­˜ä½¿ç”¨ç‡åœ¨å†…çš„é€¾ç™¾é¡¹ç›‘æ§æŒ‡æ ‡ï¼Œå¹¶æ”¯æŒè‡ªå®šä¹‰æŠ¥è­¦è§„åˆ™ï¼Œå¯çµæ´»é€‚åº”å¤šæ ·åŒ–çš„ä¸šåŠ¡éœ€æ±‚ã€‚è¿™ä¸€å…¨æ–¹ä½çš„ç›‘æ§ä½“ç³»æœ‰æ•ˆå¸®åŠ©æœé˜³ç”¨æˆ·æŠ€æœ¯å®ç°å¯¹é›†ç¾¤è¿è¡ŒçŠ¶æ€çš„ç²¾å‡†æ„ŸçŸ¥ä¸åŠæ—¶å“åº”ã€‚åŒæ—¶ï¼Œé˜¿é‡Œäº‘ Milvus è¿˜æ”¯æŒçµæ´»çš„èµ„æºè°ƒæ•´æœºåˆ¶ï¼Œå¯æ ¹æ®ä¸šåŠ¡è´Ÿè½½å˜åŒ–ï¼Œå¹³æ»‘å®ç°èµ„æºçš„æ‰©å®¹æˆ–ç¼©å®¹ï¼Œä¿éšœæœåŠ¡æŒç»­ç¨³å®šè¿è¡Œã€‚</p>
</li>
</ul>
<p><strong>3. ç”Ÿäº§çº§ç¨³å®šæ€§ï¼šå†ç»ç™¾æ¬¡é«˜å³°å†²å‡»ï¼Œé›¶æ•…éšœè¿è¡Œ</strong></p>
<p>åœ¨å¼€ç›˜ã€é‡å¤§æ”¿ç­–å‘å¸ƒç­‰æµé‡é«˜å³°æœŸé—´ï¼ŒåŸæœ‰ PG é›†ç¾¤é¢‘ç¹å‡ºç°CPUæ‰“æ»¡ã€æœåŠ¡å¡é¡¿ç”šè‡³å®•æœºç°è±¡ã€‚</p>
<p>åˆ‡æ¢è‡³é˜¿é‡Œäº‘ Milvus åï¼Œé¢å¯¹è¿™äº›æŠ•ç ”åŠæŠ•é¡¾é¢†åŸŸçš„çƒ­ç‚¹äº‹ä»¶åŠå¼€ç›˜ã€æ”¶ç›˜æ—¶é—´ç‚¹çš„é«˜é¢‘åº”ç”¨æ—¶é—´ã€‚é˜¿é‡Œäº‘ Milvus å†ç»åŠå¹´<strong>ç™¾ä½™æ¬¡</strong>ç¬æ—¶è®¿é—®å³°å€¼è€ƒéªŒï¼Œå§‹ç»ˆä¿æŒ <strong>0 æ•…éšœã€0 ä¸­æ–­</strong>ï¼Œå±•ç°å‡ºå“è¶Šçš„é«˜å¯ç”¨æ€§ä¸æŠ—å‹èƒ½åŠ›ï¼ŒçœŸæ­£è¾¾åˆ°é‡‘èçº§æ ‡å‡†ã€‚</p>
<h2 data-id="heading-9">å…­ã€æ€»ç»“</h2>
<p>é€šè¿‡é‡‡ç”¨ é˜¿é‡Œäº‘å‘é‡æ£€ç´¢æœåŠ¡ Milvus ç‰ˆï¼Œæœé˜³æ°¸ç»­æˆåŠŸæ„å»ºäº†é«˜æ€§èƒ½ã€é«˜å¯é çš„é‡‘èè¯­ä¹‰æ£€ç´¢å¼•æ“ï¼Œæœ‰æ•ˆè§£å†³äº†æµ·é‡éç»“æ„åŒ–æ•°æ®ä¸‹çš„æ£€ç´¢æ•ˆç‡ã€ç²¾åº¦ä¸ç¨³å®šæ€§éš¾é¢˜ï¼Œä¸ºâ€œAI å°äºŒâ€æä¾›äº†å¼ºå¤§çš„åº•å±‚æ”¯æ’‘ï¼Œæ˜¾è‘—æå‡äº†æ™ºèƒ½æŠ•ç ”æœåŠ¡çš„ç”¨æˆ·ä½“éªŒä¸å•†ä¸šä»·å€¼ã€‚</p>
<p>æœªæ¥ï¼Œæœé˜³æ°¸ç»­æœŸå¾…ä¸é˜¿é‡Œäº‘åœ¨å¤§æ¨¡å‹ã€å‘é‡æ£€ç´¢ã€Agent è®°å¿†ç³»ç»Ÿç­‰é¢†åŸŸæ·±åŒ–åˆä½œï¼Œå…±åŒæ¢ç´¢å…¶åœ¨æ™ºèƒ½é£æ§ã€èµ„äº§é…ç½®ã€åˆè§„å®¡æŸ¥ç­‰æ›´å¤šé‡‘èåœºæ™¯çš„åˆ›æ–°åº”ç”¨ï¼Œæºæ‰‹æ¨åŠ¨ä¸­å›½é‡‘èè¡Œä¸šçš„æ•°å­—åŒ–è½¬å‹ä¸æ™ºèƒ½åŒ–å‡çº§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Promise.withResolversã€‘å‘ç°è¿™ä¸ªapiè¿˜æŒºæœ‰ç”¨]]></title>    <link>https://juejin.cn/post/7577583653728010278</link>    <guid>https://juejin.cn/post/7577583653728010278</guid>    <pubDate>2025-11-28T08:01:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577583653728010278" data-draft-id="7577345758036279296" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Promise.withResolversã€‘å‘ç°è¿™ä¸ªapiè¿˜æŒºæœ‰ç”¨"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,TypeScript"/> <meta itemprop="datePublished" content="2025-11-28T08:01:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‘å¢¨"/> <meta itemprop="url" content="https://juejin.cn/user/3069492194710797"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Promise.withResolversã€‘å‘ç°è¿™ä¸ªapiè¿˜æŒºæœ‰ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3069492194710797/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‘å¢¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T08:01:34.000Z" title="Fri Nov 28 2025 08:01:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Jymå¥½ğŸ˜˜ï¼Œæˆ‘æ˜¯ç‘å¢¨ã€‚</p>
<p>åœ¨ es çš„å¼‚æ­¥ç¼–ç¨‹ä¸–ç•Œä¸­ï¼ŒPromise å·²ç»æˆä¸ºå¤„ç†å¼‚æ­¥æ“ä½œçš„æ ‡å‡†æ–¹å¼ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œä¼ ç»Ÿçš„ Promise æ„é€ å‡½æ•°æ¨¡å¼æ˜¾å¾—ä¸å¤Ÿçµæ´»ã€‚<code>Promise.withResolvers</code> æ˜¯ ES2024ï¼ˆES14ï¼‰ä¸­å¼•å…¥çš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒæä¾›äº†ä¸€ç§æ›´ä¼˜é›…çš„æ–¹å¼æ¥åˆ›å»º Promiseï¼Œå¹¶åŒæ—¶è·å¾—å…¶ resolve å’Œ reject å‡½æ•°çš„å¼•ç”¨ã€‚</p>
<h2 data-id="heading-0">look:</h2>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ Promise.withResolvers</h2>
<p><code>Promise.withResolvers</code> æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸‰ä¸ªå±æ€§ï¼š</p>
<ul>
<li><code>promise</code>: ä¸€ä¸ª Promise å¯¹è±¡</li>
<li><code>resolve</code>: ç”¨äºè§£å†³ï¼ˆfulfillï¼‰è¯¥ Promise çš„å‡½æ•°</li>
<li><code>reject</code>: ç”¨äºæ‹’ç»ï¼ˆrejectï¼‰è¯¥ Promise çš„å‡½æ•°</li>
</ul>
<h3 data-id="heading-2">åŸºæœ¬è¯­æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
</code></pre>
<p>è¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š<strong>ä½ å¯ä»¥åœ¨ Promise å¤–éƒ¨æ§åˆ¶å…¶çŠ¶æ€</strong>ï¼Œè¿™åœ¨è®¸å¤šåœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-3">ä¸ºä»€ä¹ˆ Promise.withResolversæŒºå®ç”¨ï¼Ÿ</h2>
<h3 data-id="heading-4">å…ˆçœ‹ä¼ ç»Ÿ Promise çš„å±€é™æ€§</h3>
<p>åœ¨ <code>Promise.withResolvers</code> å‡ºç°ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ Promise å¤–éƒ¨æ§åˆ¶å…¶çŠ¶æ€ï¼Œé€šå¸¸éœ€è¦è¿™æ ·åšï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> resolvePromise;
<span class="hljs-keyword">let</span> rejectPromise;

<span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  resolvePromise = resolve;
  rejectPromise = reject;
});

<span class="hljs-comment">// ç°åœ¨å¯ä»¥åœ¨å¤–éƒ¨ä½¿ç”¨ resolvePromise å’Œ rejectPromise</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">resolvePromise</span>(<span class="hljs-string">'æˆåŠŸï¼'</span>);
}, <span class="hljs-number">1000</span>);
</code></pre>
<p>è¿™ç§æ–¹æ³•è™½ç„¶å¯è¡Œï¼Œä½†å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ol>
<li><strong>ä»£ç å†—ä½™</strong>ï¼šæ¯æ¬¡éƒ½éœ€è¦åˆ›å»ºä¸´æ—¶å˜é‡ï¼Œä¼šå¯¼è‡´ä¸€å¨åœ°é›·</li>
<li><strong>ä½œç”¨åŸŸæ±¡æŸ“</strong>ï¼šéœ€è¦åœ¨å¤–éƒ¨ä½œç”¨åŸŸå£°æ˜å˜é‡</li>
<li><strong>ä¸å¤Ÿä¼˜é›…</strong>ï¼šä»£ç ç»“æ„ä¸å¤Ÿæ¸…æ™°</li>
<li><strong>å®¹æ˜“å‡ºé”™</strong>ï¼šå¦‚æœå¿˜è®°èµ‹å€¼ï¼Œä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯</li>
</ol>
<h3 data-id="heading-5">Promise.withResolversè§£å†³äº†å•¥ï¼Ÿ</h3>
<p><code>Promise.withResolvers</code> è§£å†³äº†ä¸Šè¿°æ‰€æœ‰é—®é¢˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();

<span class="hljs-comment">// ç®€æ´ã€æ¸…æ™°ã€å®‰å…¨</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æˆåŠŸï¼'</span>);
}, <span class="hljs-number">1000</span>);
</code></pre>
<hr/>
<h2 data-id="heading-6">è¯­æ³•å’Œç”¨æ³•</h2>
<h3 data-id="heading-7">åŸºæœ¬è¯­æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
</code></pre>
<h3 data-id="heading-8">è¿”å›å€¼</h3>
<p><code>Promise.withResolvers()</code> è¿”å›ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li><strong>promise</strong>: ä¸€ä¸ªå¤„äº pending çŠ¶æ€çš„ Promise å¯¹è±¡</li>
<li><strong>resolve</strong>: ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨æ—¶ä¼šå°† promise å˜ä¸º fulfilled çŠ¶æ€</li>
<li><strong>reject</strong>: ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨æ—¶ä¼šå°† promise å˜ä¸º rejected çŠ¶æ€</li>
</ul>
<h3 data-id="heading-9">åŸºæœ¬ç¤ºä¾‹</h3>
<h4 data-id="heading-10">ç¤ºä¾‹ 1ï¼šç®€å•çš„å»¶è¿Ÿè§£æ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { promise, resolve } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();

<span class="hljs-comment">// 1 ç§’åè§£æ Promise</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ•°æ®åŠ è½½å®Œæˆ'</span>);
}, <span class="hljs-number">1000</span>);

promise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// 1 ç§’åè¾“å‡º: "æ•°æ®åŠ è½½å®Œæˆ"</span>
});
</code></pre>
<h4 data-id="heading-11">ç¤ºä¾‹ 2ï¼šå¤„ç†é”™è¯¯</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();

<span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> success = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.5</span>;
  <span class="hljs-keyword">if</span> (success) {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ“ä½œæˆåŠŸ'</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ“ä½œå¤±è´¥'</span>));
  }
}, <span class="hljs-number">1000</span>);

promise
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error));
</code></pre>
<h4 data-id="heading-12">ç¤ºä¾‹ 3ï¼šå¤šæ¬¡è°ƒç”¨ resolve/reject çš„è¡Œä¸º</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();

<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬ä¸€æ¬¡'</span>);
<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬äºŒæ¬¡'</span>); <span class="hljs-comment">// æ— æ•ˆï¼ŒPromise çŠ¶æ€å·²ç¡®å®š</span>
<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'é”™è¯¯'</span>)); <span class="hljs-comment">// æ— æ•ˆï¼ŒPromise çŠ¶æ€å·²ç¡®å®š</span>

promise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// è¾“å‡º: "ç¬¬ä¸€æ¬¡"</span>
});
</code></pre>
<p><strong>é‡è¦æç¤º</strong>ï¼šä¸€æ—¦ Promise è¢« resolve æˆ– rejectï¼Œå…¶çŠ¶æ€å°±ç¡®å®šäº†ï¼Œåç»­çš„ resolve æˆ– reject è°ƒç”¨å°†è¢«å¿½ç•¥ã€‚</p>
<hr/>
<h2 data-id="heading-13">ä¸ä¼ ç»Ÿæ–¹æ³•çš„å¯¹æ¯”</h2>
<h3 data-id="heading-14">åœºæ™¯ 1ï¼šäº‹ä»¶ç›‘å¬å™¨ä¸­çš„ Promise</h3>
<h4 data-id="heading-15">ä¼ ç»Ÿæ–¹æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">waitForClick</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> resolveClick;
  <span class="hljs-keyword">let</span> rejectClick;
  
  <span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    resolveClick = resolve;
    rejectClick = reject;
  });
  
  <span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'myButton'</span>);
  <span class="hljs-keyword">const</span> timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    button.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, onClick);
    <span class="hljs-title function_">rejectClick</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¶…æ—¶'</span>));
  }, <span class="hljs-number">5000</span>);
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">onClick</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-built_in">clearTimeout</span>(timeout);
    button.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, onClick);
    <span class="hljs-title function_">resolveClick</span>(event);
  }
  
  button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, onClick);
  
  <span class="hljs-keyword">return</span> promise;
}
</code></pre>
<h4 data-id="heading-16">ä½¿ç”¨ Promise.withResolvers</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">waitForClick</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
  
  <span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'myButton'</span>);
  <span class="hljs-keyword">const</span> timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    button.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, onClick);
    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¶…æ—¶'</span>));
  }, <span class="hljs-number">5000</span>);
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">onClick</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-built_in">clearTimeout</span>(timeout);
    button.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, onClick);
    <span class="hljs-title function_">resolve</span>(event);
  }
  
  button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, onClick);
  
  <span class="hljs-keyword">return</span> promise;
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>ä»£ç æ›´ç®€æ´</li>
<li>ä¸éœ€è¦åœ¨å¤–éƒ¨ä½œç”¨åŸŸå£°æ˜å˜é‡</li>
<li>ç»“æ„æ›´æ¸…æ™°</li>
</ul>
<h3 data-id="heading-17">åœºæ™¯ 2ï¼šæµå¼æ•°æ®å¤„ç†</h3>
<h4 data-id="heading-18">ä¼ ç»Ÿæ–¹æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createStreamProcessor</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> resolveStream;
  <span class="hljs-keyword">let</span> rejectStream;
  
  <span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    resolveStream = resolve;
    rejectStream = reject;
  });
  
  <span class="hljs-comment">// æ¨¡æ‹Ÿæµå¼å¤„ç†</span>
  <span class="hljs-keyword">const</span> chunks = [];
  <span class="hljs-keyword">let</span> isComplete = <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">processChunk</span>(<span class="hljs-params">chunk</span>) {
    <span class="hljs-keyword">if</span> (isComplete) <span class="hljs-keyword">return</span>;
    chunks.<span class="hljs-title function_">push</span>(chunk);
    
    <span class="hljs-keyword">if</span> (chunk.<span class="hljs-property">isLast</span>) {
      isComplete = <span class="hljs-literal">true</span>;
      <span class="hljs-title function_">resolveStream</span>(chunks);
    }
  }
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleError</span>(<span class="hljs-params">error</span>) {
    <span class="hljs-keyword">if</span> (isComplete) <span class="hljs-keyword">return</span>;
    isComplete = <span class="hljs-literal">true</span>;
    <span class="hljs-title function_">rejectStream</span>(error);
  }
  
  <span class="hljs-keyword">return</span> { promise, processChunk, handleError };
}
</code></pre>
<h4 data-id="heading-19">ä½¿ç”¨ Promise.withResolvers</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createStreamProcessor</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
  
  <span class="hljs-keyword">const</span> chunks = [];
  <span class="hljs-keyword">let</span> isComplete = <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">processChunk</span>(<span class="hljs-params">chunk</span>) {
    <span class="hljs-keyword">if</span> (isComplete) <span class="hljs-keyword">return</span>;
    chunks.<span class="hljs-title function_">push</span>(chunk);
    
    <span class="hljs-keyword">if</span> (chunk.<span class="hljs-property">isLast</span>) {
      isComplete = <span class="hljs-literal">true</span>;
      <span class="hljs-title function_">resolve</span>(chunks);
    }
  }
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleError</span>(<span class="hljs-params">error</span>) {
    <span class="hljs-keyword">if</span> (isComplete) <span class="hljs-keyword">return</span>;
    isComplete = <span class="hljs-literal">true</span>;
    <span class="hljs-title function_">reject</span>(error);
  }
  
  <span class="hljs-keyword">return</span> { promise, processChunk, handleError };
}
</code></pre>
<hr/>
<h2 data-id="heading-20">å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-21">åœºæ™¯ 1ï¼šç”¨æˆ·äº¤äº’ç­‰å¾…</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç­‰å¾…ç”¨æˆ·ç¡®è®¤æ“ä½œ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">waitForUserConfirmation</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
  
  <span class="hljs-keyword">const</span> modal = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
  modal.<span class="hljs-property">className</span> = <span class="hljs-string">'confirmation-modal'</span>;
  modal.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
    &lt;p&gt;<span class="hljs-subst">${message}</span>&lt;/p&gt;
    &lt;button class="confirm"&gt;ç¡®è®¤&lt;/button&gt;
    &lt;button class="cancel"&gt;å–æ¶ˆ&lt;/button&gt;
  `</span>;
  
  modal.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.confirm'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (modal.<span class="hljs-property">parentNode</span>) {
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(modal);
    }
    <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">true</span>);
  });
  
  modal.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.cancel'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (modal.<span class="hljs-property">parentNode</span>) {
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(modal);
    }
    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç”¨æˆ·å–æ¶ˆ'</span>));
  });
  
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(modal);
  
  <span class="hljs-keyword">return</span> promise;
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-title function_">waitForUserConfirmation</span>(<span class="hljs-string">'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ–‡ä»¶å—ï¼Ÿ'</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·ç¡®è®¤'</span>))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·å–æ¶ˆ'</span>));
</code></pre>
<h3 data-id="heading-22">åœºæ™¯ 2ï¼šWebSocket æ¶ˆæ¯ç­‰å¾…</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketManager</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">url</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(url);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestId</span> = <span class="hljs-number">0</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
      <span class="hljs-keyword">const</span> { requestId, response, error } = data;
      
      <span class="hljs-keyword">const</span> pending = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">get</span>(requestId);
      <span class="hljs-keyword">if</span> (pending) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">delete</span>(requestId);
        <span class="hljs-keyword">if</span> (error) {
          pending.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(error));
        } <span class="hljs-keyword">else</span> {
          pending.<span class="hljs-title function_">resolve</span>(response);
        }
      }
    };
  }
  
  <span class="hljs-title function_">sendRequest</span>(<span class="hljs-params">message</span>) {
    <span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
    <span class="hljs-keyword">const</span> requestId = ++<span class="hljs-variable language_">this</span>.<span class="hljs-property">requestId</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">set</span>(requestId, { resolve, reject });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      requestId,
      message
    }));
    
    <span class="hljs-comment">// è®¾ç½®è¶…æ—¶</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">has</span>(requestId)) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">delete</span>(requestId);
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¯·æ±‚è¶…æ—¶'</span>));
      }
    }, <span class="hljs-number">5000</span>);
    
    <span class="hljs-keyword">return</span> promise;
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> wsManager = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketManager</span>(<span class="hljs-string">'ws://example.com'</span>);
wsManager.<span class="hljs-title function_">sendRequest</span>(<span class="hljs-string">'è·å–ç”¨æˆ·ä¿¡æ¯'</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°å“åº”:'</span>, data))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'é”™è¯¯:'</span>, error));
</code></pre>
<h3 data-id="heading-23">åœºæ™¯ 3ï¼šæ–‡ä»¶ä¸Šä¼ è¿›åº¦</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">uploadFileWithProgress</span>(<span class="hljs-params">file, url</span>) {
  <span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
  
  <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
  <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();
  formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'file'</span>, file);
  
  xhr.<span class="hljs-property">upload</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'progress'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (event.<span class="hljs-property">lengthComputable</span>) {
      <span class="hljs-keyword">const</span> percentComplete = (event.<span class="hljs-property">loaded</span> / event.<span class="hljs-property">total</span>) * <span class="hljs-number">100</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä¸Šä¼ è¿›åº¦: <span class="hljs-subst">${percentComplete.toFixed(<span class="hljs-number">2</span>)}</span>%`</span>);
    }
  });
  
  xhr.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>));
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`ä¸Šä¼ å¤±è´¥: <span class="hljs-subst">${xhr.status}</span>`</span>));
    }
  });
  
  xhr.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç½‘ç»œé”™è¯¯'</span>));
  });
  
  xhr.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'abort'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ä¸Šä¼ å·²å–æ¶ˆ'</span>));
  });
  
  xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">'POST'</span>, url);
  xhr.<span class="hljs-title function_">send</span>(formData);
  
  <span class="hljs-comment">// è¿”å› Promise å’Œå–æ¶ˆå‡½æ•°</span>
  <span class="hljs-keyword">return</span> {
    promise,
    <span class="hljs-attr">cancel</span>: <span class="hljs-function">() =&gt;</span> xhr.<span class="hljs-title function_">abort</span>()
  };
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> { promise, cancel } = <span class="hljs-title function_">uploadFileWithProgress</span>(file, <span class="hljs-string">'/api/upload'</span>);
promise
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸Šä¼ æˆåŠŸ:'</span>, result))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ä¸Šä¼ å¤±è´¥:'</span>, error));
</code></pre>
<h3 data-id="heading-24">åœºæ™¯ 4ï¼šå¯å–æ¶ˆçš„å¼‚æ­¥æ“ä½œ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createCancellableOperation</span>(<span class="hljs-params">operation</span>) {
  <span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
  <span class="hljs-keyword">let</span> cancelled = <span class="hljs-literal">false</span>;
  
  <span class="hljs-title function_">operation</span>()
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (!cancelled) {
        <span class="hljs-title function_">resolve</span>(result);
      }
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (!cancelled) {
        <span class="hljs-title function_">reject</span>(error);
      }
    });
  
  <span class="hljs-keyword">return</span> {
    promise,
    <span class="hljs-attr">cancel</span>: <span class="hljs-function">() =&gt;</span> {
      cancelled = <span class="hljs-literal">true</span>;
      <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ“ä½œå·²å–æ¶ˆ'</span>));
    }
  };
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> { promise, cancel } = <span class="hljs-title function_">createCancellableOperation</span>(
  <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/data'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">json</span>())
);

<span class="hljs-comment">// 3 ç§’åå–æ¶ˆ</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">cancel</span>(), <span class="hljs-number">3000</span>);

promise
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®:'</span>, data))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'é”™è¯¯:'</span>, error));
</code></pre>
<h3 data-id="heading-25">åœºæ™¯ 5ï¼šé˜Ÿåˆ—å¤„ç†</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskQueue</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">processing</span> = <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-title function_">add</span>(<span class="hljs-params">task</span>) {
    <span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>({
      task,
      resolve,
      reject
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">process</span>();
    
    <span class="hljs-keyword">return</span> promise;
  }
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">process</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">processing</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">processing</span> = <span class="hljs-literal">true</span>;
    
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> { task, resolve, reject } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">shift</span>();
      
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">task</span>();
        <span class="hljs-title function_">resolve</span>(result);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-title function_">reject</span>(error);
      }
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">processing</span> = <span class="hljs-literal">false</span>;
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TaskQueue</span>();

queue.<span class="hljs-title function_">add</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/task1'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">json</span>()))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä»»åŠ¡1å®Œæˆ:'</span>, result));

queue.<span class="hljs-title function_">add</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/task2'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">json</span>()))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä»»åŠ¡2å®Œæˆ:'</span>, result));
</code></pre>
<hr/>
<h2 data-id="heading-26">æ·±å…¥ç†è§£ï¼šå·¥ä½œåŸç†</h2>
<h3 data-id="heading-27">Promise.withResolvers çš„å®ç°åŸç†</h3>
<p>è™½ç„¶ <code>Promise.withResolvers</code> æ˜¯åŸç”Ÿ APIï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç†è§£å…¶ç­‰ä»·å®ç°æ¥åŠ æ·±ç†è§£ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Promise.withResolvers çš„ç­‰ä»·å®ç°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">withResolvers</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> resolve, reject;
  <span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">res, rej</span>) =&gt;</span> {
    resolve = res;
    reject = rej;
  });
  <span class="hljs-keyword">return</span> { promise, resolve, reject };
}
</code></pre>
<h3 data-id="heading-28">å†…å­˜å’Œæ€§èƒ½è€ƒè™‘</h3>
<p><code>Promise.withResolvers</code> çš„å®ç°æ˜¯é«˜åº¦ä¼˜åŒ–çš„ã€‚å®ƒï¼š</p>
<ol>
<li><strong>é¿å…é—­åŒ…å¼€é”€</strong>ï¼šåŸç”Ÿå®ç°é¿å…äº†é¢å¤–çš„é—­åŒ…åˆ›å»º</li>
<li><strong>å†…å­˜æ•ˆç‡</strong>ï¼šç›´æ¥è¿”å›å¼•ç”¨ï¼Œæ— éœ€é¢å¤–çš„å˜é‡å­˜å‚¨</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæµè§ˆå™¨å¼•æ“çº§åˆ«çš„ä¼˜åŒ–</li>
</ol>
<h3 data-id="heading-29">ä¸ Promise æ„é€ å‡½æ•°çš„å…³ç³»</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿™ä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼ˆåœ¨åŠŸèƒ½ä¸Šï¼‰</span>
<span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();

<span class="hljs-comment">// ç­‰ä»·äº</span>
<span class="hljs-keyword">let</span> resolve, reject;
<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">res, rej</span>) =&gt;</span> {
  resolve = res;
  reject = rej;
});
</code></pre>
<p>ä½† <code>Promise.withResolvers</code> æä¾›äº†ï¼š</p>
<ul>
<li>æ›´ç®€æ´çš„è¯­æ³•</li>
<li>æ›´å¥½çš„å¯è¯»æ€§</li>
<li>æ ‡å‡†åŒ–çš„ API</li>
</ul>
<hr/>
<h2 data-id="heading-30">æµè§ˆå™¨å…¼å®¹æ€§å’Œ Polyfill</h2>
<h3 data-id="heading-31">æµè§ˆå™¨æ”¯æŒ</h3>
<p><code>Promise.withResolvers</code> æ˜¯ ES2024 çš„ç‰¹æ€§ï¼Œç›®å‰ï¼ˆ2024å¹´ï¼‰çš„æ”¯æŒæƒ…å†µï¼š</p>
<ul>
<li>âœ… Chrome 119+</li>
<li>âœ… Firefox 121+</li>
<li>âœ… Safari 17.4+</li>
<li>âœ… Node.js 22.0.0+</li>
<li>âŒ æ—§ç‰ˆæœ¬æµè§ˆå™¨ä¸æ”¯æŒ</li>
</ul>
<h3 data-id="heading-32">Polyfill å®ç°</h3>
<p>å¦‚æœéœ€è¦åœ¨ä¸æ”¯æŒçš„æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ polyfillï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Promise</span>.<span class="hljs-property">withResolvers</span>) {
  <span class="hljs-title class_">Promise</span>.<span class="hljs-property">withResolvers</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> resolve, reject;
    <span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">res, rej</span>) =&gt;</span> {
      resolve = res;
      reject = rej;
    });
    <span class="hljs-keyword">return</span> { promise, resolve, reject };
  };
}
</code></pre>
<h3 data-id="heading-33">ä½¿ç”¨ Polyfill çš„å®Œæ•´ç¤ºä¾‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ¨é¡¹ç›®å…¥å£æ–‡ä»¶æ·»åŠ </span>
(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-property">withResolvers</span> !== <span class="hljs-string">'function'</span>) {
    <span class="hljs-title class_">Promise</span>.<span class="hljs-property">withResolvers</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">let</span> resolve, reject;
      <span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">res, rej</span>) =&gt;</span> {
        resolve = res;
        reject = rej;
      });
      <span class="hljs-keyword">return</span> { promise, resolve, reject };
    };
  }
})();

<span class="hljs-comment">// ç°åœ¨å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
</code></pre>
<h3 data-id="heading-34">ä½¿ç”¨ core-js</h3>
<p>å¦‚æœä½ ä½¿ç”¨ <code>core-js</code>ï¼Œå¯ä»¥å¯¼å…¥ç›¸åº”çš„ polyfillï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-string">'core-js/actual/promise/with-resolvers'</span>;
</code></pre>
<hr/>
<h2 data-id="heading-35">æœ€ä½³å®è·µå’Œæ³¨æ„</h2>
<h3 data-id="heading-36">1. é¿å…é‡å¤è°ƒç”¨ resolve/reject</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();

<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬ä¸€æ¬¡'</span>);
<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬äºŒæ¬¡'</span>); <span class="hljs-comment">// æ— æ•ˆï¼Œä½†ä¸ä¼šæŠ¥é”™</span>

<span class="hljs-comment">// æœ€ä½³å®è·µï¼šæ·»åŠ çŠ¶æ€æ£€æŸ¥</span>
<span class="hljs-keyword">let</span> isResolved = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">safeResolve</span>(<span class="hljs-params">value</span>) {
  <span class="hljs-keyword">if</span> (!isResolved) {
    isResolved = <span class="hljs-literal">true</span>;
    <span class="hljs-title function_">resolve</span>(value);
  }
}
</code></pre>
<h3 data-id="heading-37">2. å¤„ç†é”™è¯¯æƒ…å†µ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();

<span class="hljs-keyword">try</span> {
  <span class="hljs-comment">// æŸäº›å¯èƒ½æŠ›å‡ºé”™è¯¯çš„æ“ä½œ</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">riskyOperation</span>();
  <span class="hljs-title function_">resolve</span>(result);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-title function_">reject</span>(error);
}
</code></pre>
<h3 data-id="heading-38">3. æ¸…ç†èµ„æº</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createResourceManager</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { promise, <span class="hljs-attr">resolve</span>: originalResolve, <span class="hljs-attr">reject</span>: originalReject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
  <span class="hljs-keyword">const</span> resources = [];
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">cleanup</span>(<span class="hljs-params"/>) {
    resources.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">resource</span> =&gt;</span> resource.<span class="hljs-title function_">cleanup</span>());
  }
  
  <span class="hljs-comment">// åˆ›å»ºåŒ…è£…å‡½æ•°ï¼Œç¡®ä¿åœ¨ resolve æˆ– reject æ—¶æ¸…ç†èµ„æº</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; {
    <span class="hljs-title function_">cleanup</span>();
    <span class="hljs-title function_">originalResolve</span>(value);
  };
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">error</span>) =&gt; {
    <span class="hljs-title function_">cleanup</span>();
    <span class="hljs-title function_">originalReject</span>(error);
  };
  
  <span class="hljs-keyword">return</span> { promise, resolve, reject };
}
</code></pre>
<h3 data-id="heading-39">4. ç±»å‹å®‰å…¨ï¼ˆTypeScriptï¼‰</h3>
<p>åœ¨ TypeScript ä¸­ï¼Œ<code>Promise.withResolvers</code> çš„ç±»å‹å®šä¹‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">PromiseWithResolvers</span>&lt;T&gt; {
  <span class="hljs-attr">promise</span>: <span class="hljs-title class_">Promise</span>&lt;T&gt;;
  <span class="hljs-attr">resolve</span>: <span class="hljs-function">(<span class="hljs-params">value: T | PromiseLike&lt;T&gt;</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-attr">reject</span>: <span class="hljs-function">(<span class="hljs-params">reason?: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> { promise, resolve, reject }: <span class="hljs-title class_">PromiseWithResolvers</span>&lt;<span class="hljs-built_in">string</span>&gt; = 
  <span class="hljs-title class_">Promise</span>.<span class="hljs-property">withResolvers</span>&lt;<span class="hljs-built_in">string</span>&gt;();
</code></pre>
<h3 data-id="heading-40">5. é¿å…å†…å­˜æ³„æ¼</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸å¥½çš„åšæ³•ï¼šæŒæœ‰å¤§é‡æœªå®Œæˆçš„ Promiseï¼Œæ²¡æœ‰æ¸…ç†æœºåˆ¶</span>
<span class="hljs-keyword">const</span> pendingPromises = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createRequest</span>(<span class="hljs-params">id</span>) {
  <span class="hljs-keyword">const</span> { promise, resolve } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
  pendingPromises.<span class="hljs-title function_">set</span>(id, { promise, resolve });
  <span class="hljs-keyword">return</span> promise;
  <span class="hljs-comment">// é—®é¢˜ï¼šå¦‚æœ Promise æ°¸è¿œä¸ä¼š resolveï¼Œä¼šä¸€ç›´å ç”¨å†…å­˜</span>
}

<span class="hljs-comment">// å¥½çš„åšæ³•ï¼šè®¾ç½®è¶…æ—¶å’Œæ¸…ç†æœºåˆ¶</span>
<span class="hljs-keyword">const</span> pendingPromises = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(); <span class="hljs-comment">// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™åº”è¯¥æ˜¯ç±»æˆ–æ¨¡å—çº§åˆ«çš„å˜é‡</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createRequestWithTimeout</span>(<span class="hljs-params">id, timeout = <span class="hljs-number">5000</span></span>) {
  <span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
  
  <span class="hljs-keyword">const</span> timeoutId = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (pendingPromises.<span class="hljs-title function_">has</span>(id)) {
      pendingPromises.<span class="hljs-title function_">delete</span>(id);
      <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¯·æ±‚è¶…æ—¶'</span>));
    }
  }, timeout);
  
  pendingPromises.<span class="hljs-title function_">set</span>(id, {
    promise,
    <span class="hljs-attr">resolve</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
      <span class="hljs-built_in">clearTimeout</span>(timeoutId);
      pendingPromises.<span class="hljs-title function_">delete</span>(id);
      <span class="hljs-title function_">resolve</span>(value);
    },
    <span class="hljs-attr">reject</span>: <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-built_in">clearTimeout</span>(timeoutId);
      pendingPromises.<span class="hljs-title function_">delete</span>(id);
      <span class="hljs-title function_">reject</span>(error);
    }
  });
  
  <span class="hljs-keyword">return</span> promise;
}
</code></pre>
<h3 data-id="heading-41">6. ä¸ async/await ç»“åˆä½¿ç”¨</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processWithResolvers</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
  
  <span class="hljs-comment">// åœ¨å¼‚æ­¥æ“ä½œä¸­æ§åˆ¶ Promise</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'å®Œæˆ'</span>);
  }, <span class="hljs-number">1000</span>);
  
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> promise;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»“æœ:'</span>, result);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'é”™è¯¯:'</span>, error);
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-42">æ€»ç»“ä¸‹</h2>
<p><code>Promise.withResolvers</code> æ˜¯ es å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦è¡¥å……ï¼Œå®ƒè§£å†³äº†åœ¨ Promise å¤–éƒ¨æ§åˆ¶å…¶çŠ¶æ€çš„éœ€æ±‚ã€‚é€šè¿‡æœ¬æ–‡çš„è¯¦ç»†è®²è§£ï¼Œæˆ‘ä»¬äº†è§£åˆ°ï¼š</p>
<h3 data-id="heading-43">æ ¸å¿ƒè¦ç‚¹</h3>
<ol>
<li><strong>ç®€æ´æ€§</strong>ï¼šæä¾›äº†æ›´ä¼˜é›…çš„ API æ¥åˆ›å»ºå¯å¤–éƒ¨æ§åˆ¶çš„ Promise</li>
<li><strong>å®ç”¨æ€§</strong>ï¼šåœ¨äº‹ä»¶å¤„ç†ã€æµå¼å¤„ç†ã€WebSocket ç­‰åœºæ™¯ä¸­éå¸¸æœ‰ç”¨</li>
<li><strong>æ ‡å‡†åŒ–</strong>ï¼šä½œä¸º ES2024 æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†ç»Ÿä¸€çš„è§£å†³æ–¹æ¡ˆ</li>
</ol>
<h3 data-id="heading-44">é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>âœ… éœ€è¦åœ¨ Promise å¤–éƒ¨æ§åˆ¶å…¶çŠ¶æ€</li>
<li>âœ… äº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥æ“ä½œ</li>
<li>âœ… æµå¼æ•°æ®å¤„ç†</li>
<li>âœ… å¯å–æ¶ˆçš„å¼‚æ­¥æ“ä½œ</li>
<li>âœ… é˜Ÿåˆ—å’Œä»»åŠ¡ç®¡ç†</li>
</ul>
<h3 data-id="heading-45">æ³¨æ„</h3>
<ul>
<li>âš ï¸ æµè§ˆå™¨å…¼å®¹æ€§ï¼ˆéœ€è¦ polyfill æˆ–ç°ä»£æµè§ˆå™¨ï¼‰</li>
<li>âš ï¸ å°¤å…¶å¾—é¿å…é‡å¤è°ƒç”¨ resolve/reject</li>
<li>âš ï¸ æ³¨æ„èµ„æºæ¸…ç†å’Œå†…å­˜ç®¡ç†</li>
</ul>
<hr/>
<h2 data-id="heading-46">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FPromise%2FwithResolvers" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/withResolvers" ref="nofollow noopener noreferrer">MDN: Promise.withResolvers()</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftc39.es%2Fecma262%2F" target="_blank" title="https://tc39.es/ecma262/" ref="nofollow noopener noreferrer">ECMAScript 2024 Specification</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcaniuse.com%2Fmdn-javascript_builtins_promise_withresolvers" target="_blank" title="https://caniuse.com/mdn-javascript_builtins_promise_withresolvers" ref="nofollow noopener noreferrer">Can I Use: Promise.withResolvers</a></li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰“é€ ä¸€ä¸ªå¯å®šåˆ¶å·¥ä½œæµçš„æ¡Œé¢å¥³å‹]]></title>    <link>https://juejin.cn/post/7577171133432709161</link>    <guid>https://juejin.cn/post/7577171133432709161</guid>    <pubDate>2025-11-27T03:13:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577171133432709161" data-draft-id="7576955345377968191" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰“é€ ä¸€ä¸ªå¯å®šåˆ¶å·¥ä½œæµçš„æ¡Œé¢å¥³å‹"/> <meta itemprop="keywords" content="Electron"/> <meta itemprop="datePublished" content="2025-11-27T03:13:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¥‡èˆç²¾é€‰"/> <meta itemprop="url" content="https://juejin.cn/user/4388906147515367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰“é€ ä¸€ä¸ªå¯å®šåˆ¶å·¥ä½œæµçš„æ¡Œé¢å¥³å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4388906147515367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¥‡èˆç²¾é€‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-27T03:13:52.000Z" title="Thu Nov 27 2025 03:13:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½ æ˜¯å¦æƒ³è¿‡æ‹¥æœ‰ä¸€ä¸ªå¯ä»¥è‡ªå®šä¹‰è¡Œä¸ºçš„æ¡Œé¢è™šæ‹Ÿè§’è‰²ï¼Ÿæœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œæ‰“é€ ä¸€ä¸ªåŸºäº Live2D çš„æ¡Œé¢å¥³å‹ï¼Œå¹¶èµ‹äºˆå¥¹å¯å®šåˆ¶çš„å·¥ä½œæµèƒ½åŠ›ã€‚é€šè¿‡ Electron + LangGraph çš„ç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ—¢å¯çˆ±åˆæ™ºèƒ½çš„æ¡Œé¢åº”ç”¨ã€‚</p>
</blockquote>
<p>é€šè¿‡æœ¬é¡¹ç›®ï¼Œä½ èƒ½å¾—åˆ°ä»€ä¹ˆï¼š</p>
<ol>
<li><strong>ä¸€ä½å¸¸é©»æ¡Œé¢çš„è™šæ‹Ÿå¥³å‹</strong>ï¼šä½¿ç”¨ Live2D æŠ€æœ¯æ‰“é€ çš„å¯çˆ±è§’è‰²ï¼Œå¯ä»¥å¸¸é©»æ¡Œé¢ï¼Œé™ªä¼´ä½ çš„å·¥ä½œæ—¶å…‰</li>
<li><strong>å¯å®šåˆ¶çš„å·¥ä½œæµç³»ç»Ÿ</strong>ï¼šé€šè¿‡ LangGraph æ„å»ºçš„å·¥ä½œæµå¼•æ“ï¼Œè®©è™šæ‹Ÿè§’è‰²èƒ½å¤Ÿæ‰§è¡Œå„ç§è‡ªå®šä¹‰ä»»åŠ¡å’Œé€»è¾‘</li>
<li><strong>æ¨¡æ¿ç®¡ç†ç³»ç»Ÿ</strong>ï¼šå¯ä»¥ä¿å­˜ã€å¤ç”¨å’Œåˆ†äº«å·¥ä½œæµæ¨¡æ¿ï¼Œæé«˜å·¥ä½œæ•ˆç‡</li>
<li><strong>é«˜åº¦å¯æ‰©å±•çš„æ¶æ„</strong>ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œå¯ä»¥è½»æ¾æ·»åŠ æ–°çš„æ­¥éª¤ç±»å‹ã€é›†æˆ AI å¯¹è¯ã€æ–‡ä»¶æ“ä½œç­‰åŠŸèƒ½</li>
</ol>
<h2 data-id="heading-0">é¡¹ç›®æ¦‚è§ˆ</h2>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹æ•´ä¸ªé¡¹ç›®çš„æ¶æ„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·äº¤äº’å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Live2D æ¨¡å‹ â”‚         â”‚  å·¥ä½œæµç®¡ç†  â”‚                â”‚
â”‚  â”‚   (æ¡Œé¢å¥³å‹)  â”‚         â”‚   ç•Œé¢       â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Electron åº”ç”¨å±‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Express æœåŠ¡ â”‚         â”‚  BrowserWindowâ”‚             â”‚
â”‚  â”‚  (é™æ€èµ„æº)   â”‚         â”‚  (å·¥ä½œæµUI)  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 å·¥ä½œæµæœåŠ¡å±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  FastAPI     â”‚         â”‚  LangGraph   â”‚              â”‚
â”‚  â”‚  (REST API)  â”‚         â”‚  (å·¥ä½œæµå¼•æ“) â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>æ•´ä¸ªç³»ç»Ÿåˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼š</p>
<ol>
<li><strong>ç”¨æˆ·äº¤äº’å±‚</strong>ï¼šLive2D æ¨¡å‹äº¤äº’å’Œå·¥ä½œæµç®¡ç†ç•Œé¢</li>
<li><strong>Electron åº”ç”¨å±‚</strong>ï¼šæ¡Œé¢åº”ç”¨æ¡†æ¶å’Œèµ„æºæœåŠ¡</li>
<li><strong>å·¥ä½œæµæœåŠ¡å±‚</strong>ï¼šåç«¯ API å’Œå·¥ä½œæµæ‰§è¡Œå¼•æ“</li>
</ol>
<hr/>
<h2 data-id="heading-1">ç¬¬ä¸€æ­¥ï¼šè·å– Live2D å…è´¹æ¨¡å‹</h2>
<p>Live2D å®˜æ–¹æä¾›äº†ä¸°å¯Œçš„å…è´¹ç¤ºä¾‹æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¸‹è½½ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-2">è®¿é—®ä¸‹è½½é¡µé¢</h3>
<p>æ‰“å¼€ Live2D å®˜æ–¹ç¤ºä¾‹æ•°æ®é›†é¡µé¢ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.live2d.com%2Fzh-CHS%2Flearn%2Fsample%2F" target="_blank" title="https://www.live2d.com/zh-CHS/learn/sample/" ref="nofollow noopener noreferrer">www.live2d.com/zh-CHS/learâ€¦</a></p>
<p>åœ¨è¿™ä¸ªé¡µé¢ä¸Šï¼Œä½ å¯ä»¥çœ‹åˆ°å¤šä¸ªå…è´¹æ¨¡å‹ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>Haru</strong>ï¼šä¸€ä¸ªå¯çˆ±çš„å¥³å­©è§’è‰²</li>
<li><strong>Nito</strong>ï¼šäºŒå¤´èº«å¡é€šè§’è‰²</li>
</ul>
<h3 data-id="heading-3">ä¸‹è½½æ¨¡å‹æ–‡ä»¶</h3>
<p>é€‰æ‹©ä¸€ä¸ªä½ å–œæ¬¢çš„æ¨¡å‹ï¼ˆæ¨èä» <strong>Haru</strong> å¼€å§‹ï¼‰ï¼Œä¸‹è½½ FREE ç‰ˆæœ¬ã€‚ä¸‹è½½åçš„æ–‡ä»¶ç»“æ„é€šå¸¸å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">haru/
â”œâ”€â”€ haru_greeter_t05.moc3          <span class="hljs-comment"># æ¨¡å‹æ•°æ®æ–‡ä»¶</span>
â”œâ”€â”€ haru_greeter_t05.physics3.json <span class="hljs-comment"># ç‰©ç†æ•ˆæœé…ç½®</span>
â”œâ”€â”€ haru_greeter_t05.pose3.json    <span class="hljs-comment"># å§¿åŠ¿é…ç½®</span>
â”œâ”€â”€ haru_greeter_t05.cdi3.json     <span class="hljs-comment"># æ˜¾ç¤ºè¾…åŠ©æ–‡ä»¶</span>
â”œâ”€â”€ index.json                      <span class="hljs-comment"># æ¨¡å‹ç´¢å¼•æ–‡ä»¶</span>
â”œâ”€â”€ texture_00.png                  <span class="hljs-comment"># çº¹ç†è´´å›¾</span>
â”œâ”€â”€ texture_01.png                  <span class="hljs-comment"># çº¹ç†è´´å›¾</span>
â””â”€â”€ motion/                         <span class="hljs-comment"># åŠ¨ä½œæ–‡ä»¶å¤¹</span>
    â”œâ”€â”€ haru_g_idle.motion3.json   <span class="hljs-comment"># å¾…æœºåŠ¨ä½œ</span>
    â””â”€â”€ ...                         <span class="hljs-comment"># å…¶ä»–åŠ¨ä½œæ–‡ä»¶</span>
</code></pre>
<h3 data-id="heading-4">æ”¾ç½®æ¨¡å‹æ–‡ä»¶</h3>
<p>å°†ä¸‹è½½çš„æ¨¡å‹æ–‡ä»¶å¤¹æ”¾åˆ°é¡¹ç›®çš„ <code>electron/live2d/model/</code> ç›®å½•ä¸‹ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">electron/
â””â”€â”€ live2d/
    â””â”€â”€ model/
        â””â”€â”€ haru/          <span class="hljs-comment"># ä½ ä¸‹è½½çš„æ¨¡å‹æ–‡ä»¶å¤¹</span>
            â”œâ”€â”€ index.json
            â””â”€â”€ ...
</code></pre>
<hr/>
<h2 data-id="heading-5">ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ– Electron + Live2D é¡¹ç›®</h2>
<h3 data-id="heading-6">é¡¹ç›®ç»“æ„</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª Electron é¡¹ç›®ï¼Œå¹¶é›†æˆ Live2D æ˜¾ç¤ºåŠŸèƒ½ã€‚è¿™é‡Œä½¿ç”¨ live2d-widget <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fstevenjoezhang%2Flive2d-widget" target="_blank" title="https://github.com/stevenjoezhang/live2d-widget" ref="nofollow noopener noreferrer">github.com/stevenjoezhâ€¦</a> é¡¹ç›®çš„æ„å»ºå·¥ç¨‹é›†æˆ Live2Dã€‚</p>
<h3 data-id="heading-7">æ·»åŠ æ„å»ºå·¥ç¨‹</h3>
<p>å°†ä¸‹è½½ <code>live2d-widget</code> å·¥ç¨‹æ”¾åˆ°ä»¥ä¸‹ç›®å½•ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">electron/
â””â”€â”€ live2d/
<span class="hljs-code">    â””â”€â”€ live2d-widget/
</span></code></pre>
<h3 data-id="heading-8">å®‰è£…ä¾èµ–</h3>
<p>åœ¨ <code>electron</code> ç›®å½•ä¸‹åˆ›å»º <code>package.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"wenko"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"main.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"start"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"electron ."</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"electron"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^latest"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"express"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.18.0"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç„¶åè¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install
</code></pre>
<h3 data-id="heading-9">åˆ›å»ºä¸»çª—å£</h3>
<p>åˆ›å»º <code>index.html</code> æ–‡ä»¶ï¼Œç”¨äºæ˜¾ç¤º Live2D æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Wenko<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"wenko_wifu"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://localhost:8080/live2d/live2d-widget/dist/autoload.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡ <code>localhost:8080</code> æ¥åŠ è½½ Live2D çš„èµ„æºæ–‡ä»¶ï¼Œè¿™ä¸ªæœåŠ¡æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€æ­¥åˆ›å»ºã€‚</p>
<h3 data-id="heading-10">live2d-widget é¡¹ç›®å’Œ Live2D æ¨¡å‹æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</h3>
<p><code>live2d-widget</code> é¡¹ç›®ä¸åŒ…æ‹¬ä»»ä½•æ¨¡å‹ï¼Œä»…è´Ÿè´£åœ¨ç½‘é¡µä¸­åŠ è½½å’Œè¿è¡Œ <code>Live2D</code> æ¨¡å‹ã€‚å…·ä½“é€»è¾‘å¯å‚è€ƒ <code>autoload.js</code> ã€‚</p>
<hr/>
<h2 data-id="heading-11">ç¬¬ä¸‰æ­¥ï¼šé…ç½® Express é™æ€èµ„æºæœåŠ¡</h2>
<p>ä¸ºäº†è®© Live2D æ¨¡å‹æ–‡ä»¶èƒ½å¤Ÿæ­£å¸¸åŠ è½½ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Electron ä¸»è¿›ç¨‹ä¸­å¯åŠ¨ä¸€ä¸ª Express æœåŠ¡å™¨æ¥æä¾›é™æ€æ–‡ä»¶æœåŠ¡ã€‚</p>
<h3 data-id="heading-12">ä¿®æ”¹ main.js</h3>
<p>æ‰“å¼€ <code>electron/main.js</code>ï¼Œæ·»åŠ  Express æœåŠ¡å™¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { app, <span class="hljs-title class_">BrowserWindow</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'electron'</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);

<span class="hljs-comment">// åˆ›å»º Express æœåŠ¡å™¨æä¾› live2d é™æ€æ–‡ä»¶è®¿é—®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createStaticServer</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> expressApp = <span class="hljs-title function_">express</span>();
  <span class="hljs-keyword">const</span> port = <span class="hljs-number">8080</span>;
  
  <span class="hljs-comment">// æä¾› live2d ç›®å½•çš„é™æ€æ–‡ä»¶è®¿é—®</span>
  expressApp.<span class="hljs-title function_">use</span>(<span class="hljs-string">'/live2d'</span>, express.<span class="hljs-title function_">static</span>(path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">'live2d'</span>)));
  
  expressApp.<span class="hljs-title function_">listen</span>(port, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Static server running on http://localhost:<span class="hljs-subst">${port}</span>`</span>);
  });
}

<span class="hljs-comment">// å¯åŠ¨é™æ€æ–‡ä»¶æœåŠ¡å™¨</span>
<span class="hljs-title function_">createStaticServer</span>();

<span class="hljs-comment">// åˆ›å»º Electron çª—å£</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createWindow</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> mainWindow = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BrowserWindow</span>({
    <span class="hljs-attr">width</span>: <span class="hljs-number">350</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">400</span>,
    <span class="hljs-attr">frame</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">transparent</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">webPreferences</span>: {
      <span class="hljs-attr">nodeIntegration</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">contextIsolation</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">webSecurity</span>: <span class="hljs-literal">false</span>
    }
  });

  mainWindow.<span class="hljs-title function_">loadFile</span>(<span class="hljs-string">'index.html'</span>);
}

app.<span class="hljs-title function_">whenReady</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">createWindow</span>();
});
</code></pre>
<h3 data-id="heading-13">å·¥ä½œæµç¨‹</h3>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Electron å¯åŠ¨   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€&gt; å¯åŠ¨ Express æœåŠ¡å™¨ (ç«¯å£ 8080)
         â”‚    â””â”€â”€&gt; æä¾› /live2d/* é™æ€èµ„æº
         â”‚
         â””â”€â”€&gt; åˆ›å»º BrowserWindow
              â””â”€â”€&gt; åŠ è½½ index.html
                   â””â”€â”€&gt; é€šè¿‡ http://localhost:8080/live2d/... åŠ è½½æ¨¡å‹
</code></pre>
<h3 data-id="heading-14">ä¸ºä»€ä¹ˆéœ€è¦ Express æœåŠ¡å™¨ï¼Ÿ</h3>
<p>Live2D çš„æ¨¡å‹æ–‡ä»¶ï¼ˆ<code>.moc3</code>ã€<code>.json</code>ã€<code>.png</code> ç­‰ï¼‰éœ€è¦é€šè¿‡ HTTP åè®®åŠ è½½ã€‚è™½ç„¶ Electron æ”¯æŒ <code>file://</code> åè®®ï¼Œä½†æŸäº›æƒ…å†µä¸‹ä¼šé‡åˆ°è·¨åŸŸé—®é¢˜ã€‚ä½¿ç”¨ Express æä¾› HTTP æœåŠ¡å¯ä»¥ï¼š</p>
<ol>
<li><strong>é¿å…è·¨åŸŸé—®é¢˜</strong>ï¼šç»Ÿä¸€ä½¿ç”¨ HTTP åè®®</li>
<li><strong>ä¾¿äºè°ƒè¯•</strong>ï¼šå¯ä»¥åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—®èµ„æº</li>
<li><strong>çµæ´»é…ç½®</strong>ï¼šå¯ä»¥æ·»åŠ ç¼“å­˜ã€å‹ç¼©ç­‰ä¸­é—´ä»¶</li>
</ol>
<hr/>
<h2 data-id="heading-15">ç¬¬å››æ­¥ï¼šæ„å»ºå·¥ä½œæµç³»ç»Ÿ</h2>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸ºæ¡Œé¢å¥³å‹æ·»åŠ "å¤§è„‘"â€”â€”ä¸€ä¸ªå¯å®šåˆ¶çš„å·¥ä½œæµç³»ç»Ÿã€‚</p>
<h3 data-id="heading-16">åˆå§‹åŒ– LangGraph é¡¹ç›®</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º <code>workflow</code> ç›®å½•ï¼Œå¹¶åˆå§‹åŒ– Python é¡¹ç›®ï¼š</p>
<p><strong>é¦–å…ˆå®‰è£… uv</strong>ï¼ˆå¦‚æœè¿˜æ²¡æœ‰å®‰è£…ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">curl -LsSf https://astral.sh/uv/install.sh | sh
</code></pre>
<p><strong>ç„¶ååˆå§‹åŒ–é¡¹ç›®</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> workflow
<span class="hljs-built_in">cd</span> workflow

<span class="hljs-comment"># ä½¿ç”¨ uv åˆå§‹åŒ–é¡¹ç›®</span>
uv init

<span class="hljs-comment"># æ·»åŠ ä¾èµ–</span>
uv add langgraph langgraph-cli fastapi uvicorn httpx pydantic python-dotenv
</code></pre>
<h3 data-id="heading-17">é¡¹ç›®ç»“æ„</h3>
<pre><code class="hljs language-bash" lang="bash">workflow/
â”œâ”€â”€ main.py          <span class="hljs-comment"># FastAPI åº”ç”¨å…¥å£</span>
â”œâ”€â”€ executor.py      <span class="hljs-comment"># å·¥ä½œæµæ‰§è¡Œå™¨</span>
â”œâ”€â”€ steps.py         <span class="hljs-comment"># æ­¥éª¤å®šä¹‰</span>
â”œâ”€â”€ graph.py         <span class="hljs-comment"># LangGraph å›¾å®šä¹‰</span>
â”œâ”€â”€ control_steps.py <span class="hljs-comment"># æ§åˆ¶æµæ­¥éª¤ï¼ˆIf/Then/Elseï¼‰</span>
â””â”€â”€ pyproject.toml   <span class="hljs-comment"># é¡¹ç›®é…ç½®</span>
</code></pre>
<h3 data-id="heading-18">æ ¸å¿ƒç»„ä»¶è§£æ</h3>
<h4 data-id="heading-19">1. steps.py - æ­¥éª¤å®šä¹‰</h4>
<p><code>steps.py</code> å®šä¹‰äº†æ‰€æœ‰å¯ç”¨çš„å·¥ä½œæµæ­¥éª¤ã€‚æ¯ä¸ªæ­¥éª¤éƒ½æ˜¯ä¸€ä¸ªç±»ï¼Œç»§æ‰¿è‡ª <code>Step</code> åŸºç±»ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Step</span>(<span class="hljs-title class_ inherited__">ABC</span>):
    <span class="hljs-string">"""æ­¥éª¤åŸºç±»"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, step_type: <span class="hljs-built_in">str</span>, params: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>):
        self.step_type = step_type
        self.params = params
    
<span class="hljs-meta">    @abstractmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, context: StepContext</span>) -&gt; <span class="hljs-type">Any</span>:
        <span class="hljs-string">"""æ‰§è¡Œæ­¥éª¤"""</span>
        <span class="hljs-keyword">pass</span>
</code></pre>
<p><strong>æ­¥éª¤ç±»å‹ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>
<p><strong>SetVar</strong>ï¼šè®¾ç½®å˜é‡</p>
<pre><code class="hljs language-python" lang="python">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"SetVar"</span>,
  <span class="hljs-string">"params"</span>: {
    <span class="hljs-string">"key"</span>: <span class="hljs-string">"greeting"</span>,
    <span class="hljs-string">"value"</span>: <span class="hljs-string">"Hello, World!"</span>
  }
}
</code></pre>
</li>
<li>
<p><strong>GetVar</strong>ï¼šè·å–å˜é‡</p>
<pre><code class="hljs language-python" lang="python">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"GetVar"</span>,
  <span class="hljs-string">"params"</span>: {
    <span class="hljs-string">"key"</span>: <span class="hljs-string">"greeting"</span>
  }
}
</code></pre>
</li>
<li>
<p><strong>EchoInput</strong>ï¼šå›æ˜¾è¾“å…¥</p>
<pre><code class="hljs language-python" lang="python">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"EchoInput"</span>,
  <span class="hljs-string">"params"</span>: {
    <span class="hljs-string">"input_key"</span>: <span class="hljs-string">"user_input"</span>,
    <span class="hljs-string">"output_key"</span>: <span class="hljs-string">"response"</span>
  }
}
</code></pre>
</li>
</ul>
<p><strong>æ­¥éª¤æ³¨å†Œè¡¨</strong>ï¼š</p>
<p>æ‰€æœ‰æ­¥éª¤éƒ½æ³¨å†Œåœ¨ <code>STEP_REGISTRY</code> ä¸­ï¼Œæ–¹ä¾¿åŠ¨æ€åˆ›å»ºï¼š</p>
<pre><code class="hljs language-python" lang="python">STEP_REGISTRY = {
    <span class="hljs-string">'EchoInput'</span>: EchoInputStep,
    <span class="hljs-string">'SetVar'</span>: SetVarStep,
    <span class="hljs-string">'GetVar'</span>: GetVarStep,
    <span class="hljs-comment"># ... æ›´å¤šæ­¥éª¤ç±»å‹</span>
}
</code></pre>
<h4 data-id="heading-20">2. executor.py - å·¥ä½œæµæ‰§è¡Œå™¨</h4>
<p><code>executor.py</code> è´Ÿè´£æ‰§è¡Œå·¥ä½œæµæ­¥éª¤åºåˆ—ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkflowExecutor</span>:
    <span class="hljs-string">"""å·¥ä½œæµæ‰§è¡Œå™¨"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, steps: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>], initial_context: <span class="hljs-type">Dict</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-comment"># åˆ›å»ºä¸Šä¸‹æ–‡</span>
        context = StepContext(initial_context <span class="hljs-keyword">or</span> {})
        
        <span class="hljs-comment"># ä¾æ¬¡æ‰§è¡Œæ¯ä¸ªæ­¥éª¤</span>
        <span class="hljs-keyword">for</span> step_config <span class="hljs-keyword">in</span> steps:
            step_type = step_config.get(<span class="hljs-string">'type'</span>)
            step_params = step_config.get(<span class="hljs-string">'params'</span>, {})
            
            <span class="hljs-comment"># ä»æ³¨å†Œè¡¨åˆ›å»ºæ­¥éª¤å®ä¾‹</span>
            step = create_step(step_type, step_params)
            
            <span class="hljs-comment"># æ‰§è¡Œæ­¥éª¤</span>
            result = step.execute(context)
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'success'</span>: <span class="hljs-literal">True</span>,
            <span class="hljs-string">'result'</span>: context.variables
        }
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">å·¥ä½œæµè¯·æ±‚</span>      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  {               <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>    <span class="hljs-attr">steps:</span> [<span class="hljs-string">...</span>], <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>    <span class="hljs-attr">context:</span> {}   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  }               <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
         <span class="hljs-string">â”‚</span>
         <span class="hljs-string">v</span>
<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">WorkflowExecutorâ”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
         <span class="hljs-string">â”‚</span>
         <span class="hljs-string">v</span>
<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>      <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">StepContext</span>    <span class="hljs-string">â”‚&lt;â”€â”€â”€â”€â”€â”‚</span>  <span class="hljs-string">å˜é‡å­˜å‚¨</span>     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">(ä¸Šä¸‹æ–‡)</span>        <span class="hljs-string">â”‚</span>      <span class="hljs-string">â”‚</span>  <span class="hljs-string">variables</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>      <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
         <span class="hljs-string">â”‚</span>
         <span class="hljs-string">v</span>
<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">éå†æ­¥éª¤åˆ—è¡¨</span>                        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">Step</span> <span class="hljs-number">1</span>   <span class="hljs-string">â”‚â†’</span> <span class="hljs-string">â”‚</span> <span class="hljs-string">Step</span> <span class="hljs-number">2</span>   <span class="hljs-string">â”‚â†’</span> <span class="hljs-string">...</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
         <span class="hljs-string">â”‚</span>
         <span class="hljs-string">v</span>
<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">è¿”å›æ‰§è¡Œç»“æœ</span>    <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  {               <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>    <span class="hljs-attr">success:</span> <span class="hljs-literal">true</span>,<span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>    <span class="hljs-attr">result:</span> {<span class="hljs-string">...</span>} <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  }               <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<h4 data-id="heading-21">3. main.py - REST API æ¥å£</h4>
<p><code>main.py</code> ä½¿ç”¨ FastAPI æä¾› RESTful APIï¼š</p>
<p><strong>æ ¸å¿ƒæ¥å£</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ‰§è¡Œå·¥ä½œæµ</strong> - <code>POST /run</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/run"</span>, response_model=WorkflowResponse</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_workflow</span>(<span class="hljs-params">request: WorkflowRequest</span>):
    executor = WorkflowExecutor()
    result = executor.execute(
        steps=request.steps,
        initial_context=request.initial_context <span class="hljs-keyword">or</span> {}
    )
    <span class="hljs-keyword">return</span> result
</code></pre>
</li>
<li>
<p><strong>æ¨¡æ¿ç®¡ç†æ¥å£</strong>ï¼š</p>
<ul>
<li><code>POST /templates</code> - åˆ›å»ºæ¨¡æ¿</li>
<li><code>GET /templates</code> - åˆ—å‡ºæ‰€æœ‰æ¨¡æ¿</li>
<li><code>GET /templates/{id}</code> - è·å–æ¨¡æ¿è¯¦æƒ…</li>
<li><code>PUT /templates/{id}</code> - æ›´æ–°æ¨¡æ¿</li>
<li><code>DELETE /templates/{id}</code> - åˆ é™¤æ¨¡æ¿</li>
<li><code>GET /templates/search/{query}</code> - æœç´¢æ¨¡æ¿</li>
<li><code>POST /templates/{id}/execute</code> - æ‰§è¡Œæ¨¡æ¿</li>
</ul>
</li>
<li>
<p><strong>ç³»ç»Ÿæ¥å£</strong>ï¼š</p>
<ul>
<li><code>GET /health</code> - å¥åº·æ£€æŸ¥</li>
<li><code>GET /steps</code> - è·å–æ­¥éª¤æ³¨å†Œè¡¨</li>
</ul>
</li>
</ol>
<p><strong>API è°ƒç”¨ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰§è¡Œå·¥ä½œæµ</span>
curl -X POST http://localhost:8002/run \
  -H <span class="hljs-string">"Content-Type: application/json"</span> \
  -d <span class="hljs-string">'{
    "steps": [
      {
        "type": "SetVar",
        "params": {"key": "name", "value": "Wenko"}
      },
      {
        "type": "EchoInput",
        "params": {"input_key": "name", "output_key": "greeting"}
      }
    ],
    "initial_context": {}
  }'</span>
</code></pre>
<h3 data-id="heading-22">å¯åŠ¨æœåŠ¡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> workflow
uv run python main.py
</code></pre>
<p>æœåŠ¡å¯åŠ¨åï¼Œè®¿é—® <code>http://localhost:8002/docs</code> å¯ä»¥çœ‹åˆ°è‡ªåŠ¨ç”Ÿæˆçš„ API æ–‡æ¡£ã€‚</p>
<hr/>
<h2 data-id="heading-23">ç¬¬äº”æ­¥ï¼šæ„å»ºå·¥ä½œæµç®¡ç†ç•Œé¢</h2>
<p>æœ€åï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‹å–„çš„ç•Œé¢æ¥ç®¡ç†æ¨¡æ¿å’Œæ‰§è¡Œå·¥ä½œæµã€‚</p>
<h3 data-id="heading-24">ä¿®æ”¹ main.js æ·»åŠ å·¥ä½œæµçª—å£</h3>
<p>åœ¨ <code>electron/main.js</code> ä¸­æ·»åŠ å¿«æ·é”®ç›‘å¬ï¼Œæ‰“å¼€å·¥ä½œæµç®¡ç†çª—å£ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">ipcMain.<span class="hljs-title function_">on</span>(<span class="hljs-string">'wenko_shortcut'</span>, <span class="hljs-keyword">async</span> (event, data) =&gt; {
  <span class="hljs-comment">// å¤„ç†å¿«æ·é”®äº‹ä»¶: action: open</span>
  <span class="hljs-keyword">const</span> { action } = data;
  <span class="hljs-keyword">if</span> (action === <span class="hljs-string">'open'</span>) {
    <span class="hljs-keyword">const</span> shortcutWindow = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BrowserWindow</span>({
      <span class="hljs-attr">width</span>: <span class="hljs-number">1200</span>,
      <span class="hljs-attr">height</span>: <span class="hljs-number">800</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">'Workflow API æµ‹è¯•å·¥å…·'</span>,
      <span class="hljs-attr">icon</span>: path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">'assets'</span>, <span class="hljs-string">'favicon.ico'</span>),
      <span class="hljs-attr">frame</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">transparent</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">alwaysOnTop</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">resizable</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">hasShadow</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">fullscreenable</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">skipTaskbar</span>: <span class="hljs-literal">false</span>,    <span class="hljs-comment">// åœ¨ä»»åŠ¡æ æ˜¾ç¤º</span>
      <span class="hljs-attr">webPreferences</span>: {
        <span class="hljs-attr">preload</span>: path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">'preload.js'</span>),
        <span class="hljs-attr">nodeIntegration</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">contextIsolation</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">webSecurity</span>: <span class="hljs-literal">false</span>  <span class="hljs-comment">// å…³é—­åŒæºç­–ç•¥å’Œ CSP æ£€æŸ¥ï¼Œæ–¹ä¾¿å¼€å‘åŠ è½½ä»»æ„è„šæœ¬</span>
      }
    });
    shortcutWindow.<span class="hljs-title function_">loadFile</span>(<span class="hljs-string">'workflow.html'</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Unknown action:'</span>, action);
  }
});

</code></pre>
<h3 data-id="heading-25">workflow.html åŠŸèƒ½æ¨¡å—</h3>
<p><code>workflow.html</code> ä½¿ç”¨ React + Ant Design æ„å»ºï¼ŒåŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<h4 data-id="heading-26">1. å·¥ä½œæµæ‰§è¡Œæ ‡ç­¾é¡µ</h4>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·¥ä½œæµæ‰§è¡Œ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å·¥ä½œæµæ­¥éª¤ (JSON)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ <span class="hljs-selector-attr">[                            â”‚  â”‚â”‚  â”‚   {<span class="hljs-string">"type"</span>: <span class="hljs-string">"SetVar"</span>, ...}    â”‚  â”‚â”‚  â”‚ ]</span>                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  åˆå§‹ä¸Šä¸‹æ–‡ (JSON, å¯é€‰)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ {"key": <span class="hljs-string">"value"</span>}              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  â˜‘ è°ƒè¯•æ¨¡å¼                          â”‚
â”‚                                      â”‚
â”‚  <span class="hljs-selector-attr">[æ‰§è¡Œå·¥ä½œæµ]</span> <span class="hljs-selector-attr">[åŠ è½½ç¤ºä¾‹]</span> <span class="hljs-selector-attr">[æ¸…ç©º]</span>      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-27">2. æ¨¡æ¿ç®¡ç†æ ‡ç­¾é¡µ</h4>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨¡æ¿ç®¡ç†                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-selector-attr">[+ åˆ›å»ºæ–°æ¨¡æ¿]</span>                      â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ¨¡æ¿åç§°                        â”‚  â”‚
â”‚  â”‚ æè¿°ï¼šè¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ¨¡æ¿...        â”‚  â”‚
â”‚  â”‚ æ ‡ç­¾ï¼š<span class="hljs-selector-attr">[åŸºç¡€]</span> <span class="hljs-selector-attr">[ç¤ºä¾‹]</span>              â”‚  â”‚
â”‚  â”‚ <span class="hljs-selector-attr">[æŸ¥çœ‹]</span> <span class="hljs-selector-attr">[æ‰§è¡Œ]</span> <span class="hljs-selector-attr">[ç¼–è¾‘]</span> <span class="hljs-selector-attr">[åˆ é™¤]</span>     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-28">3. æ­¥éª¤æ³¨å†Œè¡¨æ ‡ç­¾é¡µ</h4>
<p>æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„æ­¥éª¤ç±»å‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤æ³¨å†Œè¡¨                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-selector-attr">[åˆ·æ–°æ­¥éª¤åˆ—è¡¨]</span>                      â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚EchoInputâ”‚ â”‚SetVarâ”‚ â”‚GetVarâ”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚FetchURLâ”‚ â”‚ParseJSONâ”‚ â”‚...â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-29">æ¨¡æ¿æ‰§è¡Œæµç¨‹</h3>
<p>å½“ç”¨æˆ·ç‚¹å‡»"æ‰§è¡Œ"æŒ‰é’®æ—¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç‚¹å‡»æ‰§è¡Œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¼¹å‡ºå¯¹è¯æ¡†      â”‚
â”‚  è®©ç”¨æˆ·è¾“å…¥ä¸Šä¸‹æ–‡â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è°ƒç”¨ API        â”‚
â”‚  POST /templates/â”‚
â”‚  {<span class="hljs-built_in">id</span>}/execute    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ˜¾ç¤ºæ‰§è¡Œç»“æœ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-30">å®Œæ•´ç³»ç»Ÿæ¶æ„</h2>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ•´ä¸ªç³»ç»Ÿæ˜¯å¦‚ä½•åä½œçš„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·æ“ä½œæµç¨‹                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            v
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  <span class="hljs-number">1.</span> å¯åŠ¨ <span class="hljs-title class_">Electron</span> åº”ç”¨              â”‚
        â”‚     - æ˜¾ç¤º <span class="hljs-title class_">Live2D</span> æ¨¡å‹             â”‚
        â”‚     - å¯åŠ¨ <span class="hljs-title class_">Express</span> é™æ€æœåŠ¡         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        v
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  <span class="hljs-number">2.</span> ä¸ <span class="hljs-title class_">Live2D</span> æ¨¡å‹äº¤äº’æ‰“å¼€ç®¡ç†ç•Œé¢     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        v
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  <span class="hljs-number">3.</span> åœ¨å·¥ä½œæµç•Œé¢ä¸­ï¼š                â”‚
        â”‚     - åˆ›å»º/ç¼–è¾‘æ¨¡æ¿                 â”‚
        â”‚     - æ‰§è¡Œå·¥ä½œæµ                    â”‚
        â”‚     - æŸ¥çœ‹æ­¥éª¤æ³¨å†Œè¡¨                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        v
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  <span class="hljs-number">4.</span> å‰ç«¯è°ƒç”¨ <span class="hljs-title class_">FastAPI</span>                â”‚
        â”‚     <span class="hljs-attr">http</span>:<span class="hljs-comment">//localhost:8002/...       â”‚</span>
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        v
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  <span class="hljs-number">5.</span> <span class="hljs-title class_">FastAPI</span> å¤„ç†è¯·æ±‚                â”‚
        â”‚     - è§£æ <span class="hljs-title class_">JSON</span>                     â”‚
        â”‚     - è°ƒç”¨ <span class="hljs-title class_">WorkflowExecutor</span>         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        v
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  <span class="hljs-number">6.</span> <span class="hljs-title class_">WorkflowExecutor</span> æ‰§è¡Œæ­¥éª¤      â”‚
        â”‚     - åˆ›å»º <span class="hljs-title class_">StepContext</span>             â”‚
        â”‚     - éå†æ­¥éª¤åˆ—è¡¨                 â”‚
        â”‚     - æ‰§è¡Œæ¯ä¸ªæ­¥éª¤                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        v
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  <span class="hljs-number">7.</span> è¿”å›æ‰§è¡Œç»“æœ                    â”‚
        â”‚     - æˆåŠŸ/å¤±è´¥çŠ¶æ€                 â”‚
        â”‚     - ä¸Šä¸‹æ–‡å˜é‡                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        v
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  <span class="hljs-number">8.</span> å‰ç«¯æ˜¾ç¤ºç»“æœ                    â”‚
        â”‚     - æˆåŠŸæç¤º                     â”‚
        â”‚     - ç»“æœ <span class="hljs-title class_">JSON</span> å±•ç¤º               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-31">ä½¿ç”¨ç¤ºä¾‹</h2>
<h3 data-id="heading-32">ç¤ºä¾‹ 1ï¼šç®€å•çš„é—®å€™å·¥ä½œæµ</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"steps"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"SetVar"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"name"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Wenko"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TemplateReplace"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"template"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ å¥½ï¼Œ{{name}}ï¼ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"template_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"output_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"greeting"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"initial_context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>æ‰§è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Wenko"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"greeting"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ å¥½ï¼ŒWenkoï¼ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-33">æ€»ç»“</h2>
<p>é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå®Œæ•´çš„å¯å®šåˆ¶å·¥ä½œæµæ¡Œé¢å¥³å‹ç³»ç»Ÿï¼š</p>
<ol>
<li>âœ… <strong>Live2D æ¨¡å‹é›†æˆ</strong>ï¼šä»å®˜ç½‘ä¸‹è½½å…è´¹æ¨¡å‹å¹¶é›†æˆåˆ° Electron</li>
<li>âœ… <strong>é™æ€èµ„æºæœåŠ¡</strong>ï¼šä½¿ç”¨ Express æä¾›æ¨¡å‹æ–‡ä»¶è®¿é—®</li>
<li>âœ… <strong>å·¥ä½œæµå¼•æ“</strong>ï¼šåŸºäº LangGraph æ„å»ºå¯æ‰©å±•çš„å·¥ä½œæµç³»ç»Ÿ</li>
<li>âœ… <strong>REST API</strong>ï¼šæä¾›å®Œæ•´çš„æ¨¡æ¿ç®¡ç†å’Œæ‰§è¡Œæ¥å£</li>
<li>âœ… <strong>ç®¡ç†ç•Œé¢</strong>ï¼šå‹å¥½çš„ Web ç•Œé¢ç”¨äºæ¨¡æ¿ç®¡ç†</li>
</ol>
<p>è¿™ä¸ªç³»ç»Ÿå…·æœ‰å¾ˆå¼ºçš„æ‰©å±•æ€§ï¼š</p>
<ul>
<li>å¯ä»¥æ·»åŠ æ›´å¤šæ­¥éª¤ç±»å‹ï¼ˆå¦‚ AI å¯¹è¯ã€æ–‡ä»¶æ“ä½œç­‰ï¼‰</li>
<li>å¯ä»¥é›†æˆæ›´å¤š Live2D æ¨¡å‹å’ŒåŠ¨ä½œ</li>
<li>å¯ä»¥æ·»åŠ æ•°æ®åº“æŒä¹…åŒ–æ¨¡æ¿</li>
<li>å¯ä»¥å®ç°å·¥ä½œæµä¸ Live2D æ¨¡å‹çš„è”åŠ¨ï¼ˆæ ¹æ®å·¥ä½œæµç»“æœè§¦å‘æ¨¡å‹åŠ¨ä½œï¼‰</li>
</ul>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ‰“é€ å±äºè‡ªå·±çš„æ™ºèƒ½æ¡Œé¢å¥³å‹ï¼ğŸš€</p>
<hr/>
<h2 data-id="heading-34">å‚è€ƒèµ„æº</h2>
<ul>
<li>Live2D å®˜æ–¹ç¤ºä¾‹æ•°æ®é›† <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.live2d.com%2Fzh-CHS%2Flearn%2Fsample%2F" target="_blank" title="https://www.live2d.com/zh-CHS/learn/sample/" ref="nofollow noopener noreferrer">www.live2d.com/zh-CHS/learâ€¦</a></li>
<li>live2d-widget é¡¹ç›® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fstevenjoezhang%2Flive2d-widget" target="_blank" title="https://github.com/stevenjoezhang/live2d-widget" ref="nofollow noopener noreferrer">github.com/stevenjoezhâ€¦</a></li>
<li>LangGraph å®˜æ–¹æ–‡æ¡£ <a href="https://link.juejin.cn?target=https%3A%2F%2Flangchain-ai.github.io%2Flanggraph%2F" target="_blank" title="https://langchain-ai.github.io/langgraph/" ref="nofollow noopener noreferrer">langchain-ai.github.io/langgraph/</a></li>
<li>FastAPI å®˜æ–¹æ–‡æ¡£ <a href="https://link.juejin.cn?target=https%3A%2F%2Ffastapi.tiangolo.com%2F" target="_blank" title="https://fastapi.tiangolo.com/" ref="nofollow noopener noreferrer">fastapi.tiangolo.com/</a></li>
<li>Electron å®˜æ–¹æ–‡æ¡£ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.electronjs.org%2F" target="_blank" title="https://www.electronjs.org/" ref="nofollow noopener noreferrer">www.electronjs.org/</a></li>
<li>æœ¬é¡¹ç›®ä»“åº“ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdaijinru%2Fwenko" target="_blank" title="https://github.com/daijinru/wenko" ref="nofollow noopener noreferrer">github.com/daijinru/weâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Claudeå›å¤å¤ªå•°å—¦ï¼Ÿç”¨Subagentæ‰“é€ ä½ çš„ä¸“å±AIå›¢é˜Ÿ]]></title>    <link>https://juejin.cn/post/7576994308272947219</link>    <guid>https://juejin.cn/post/7576994308272947219</guid>    <pubDate>2025-11-27T04:32:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7576994308272947219" data-draft-id="7576861477267161107" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Claudeå›å¤å¤ªå•°å—¦ï¼Ÿç”¨Subagentæ‰“é€ ä½ çš„ä¸“å±AIå›¢é˜Ÿ"/> <meta itemprop="keywords" content="Claude,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-11-27T04:32:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŠ€æœ¯æ¢ç´¢å®¶"/> <meta itemprop="url" content="https://juejin.cn/user/2735240657517816"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Claudeå›å¤å¤ªå•°å—¦ï¼Ÿç”¨Subagentæ‰“é€ ä½ çš„ä¸“å±AIå›¢é˜Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2735240657517816/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŠ€æœ¯æ¢ç´¢å®¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-27T04:32:09.000Z" title="Thu Nov 27 2025 04:32:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca45628126054c75933e569fc4140e92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oqA5pyv5o6i57Si5a62:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764823094&amp;x-signature=QN%2F3Nb8Wd3HdG7rHpiVeqkukSVA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æ·±å¤œä¸¤ç‚¹ï¼Œæˆ‘ç›¯ç€å±å¹•ï¼Œçœ‹ç€Claudeåˆä¸€æ¬¡ç»™å‡ºäº†3000è¡Œçš„å›å¤ã€‚æˆ‘åªæ˜¯æƒ³è®©å®ƒå¸®æˆ‘æŸ¥ä¸€ä¸‹ä»£ç é‡Œæœ‰æ²¡æœ‰å®‰å…¨éšæ‚£ï¼Œç»“æœå®ƒè¿é‡æ„å»ºè®®ã€æ€§èƒ½ä¼˜åŒ–ã€æµ‹è¯•ç”¨ä¾‹å…¨ç»™æˆ‘å†™äº†ä¸€éã€‚</p>
<p>è¯´å®è¯ï¼Œå½“æ—¶æˆ‘å°±æƒ³â€”â€”èƒ½ä¸èƒ½è®©å®ƒåªå…³æ³¨ä»£ç å®¡æŸ¥ï¼Œåˆ«æ‰¯é‚£ä¹ˆå¤šæœ‰çš„æ²¡çš„ï¼Ÿ</p>
<p>åæ¥æˆ‘å‘ç°ï¼ŒSubagentå°±æ˜¯ä¸“é—¨è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚</p>
<h2 data-id="heading-0">Subagentåˆ°åº•æ˜¯ä»€ä¹ˆ</h2>
<p>ç®€å•è¯´ï¼ŒSubagentå°±æ˜¯ä½ ç»™Claudeå®šåˆ¶çš„ä¸“å±åŠ©æ‰‹ã€‚æ¯ä¸ªåŠ©æ‰‹æœ‰è‡ªå·±çš„ä»»åŠ¡èŒƒå›´ã€å·¥å…·æƒé™ï¼Œç”šè‡³ç”¨çš„æ¨¡å‹éƒ½å¯ä»¥ä¸ä¸€æ ·ã€‚</p>
<p>å®ƒä»¬ä½åœ¨ä½ é¡¹ç›®çš„<code>.claude/agents/</code>ç›®å½•é‡Œï¼Œæ¯ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªåŠ©æ‰‹ã€‚æ–‡ä»¶ç»“æ„æŒºç®€å•ï¼šä¸Šé¢æ˜¯YAMLé…ç½®ï¼Œä¸‹é¢æ˜¯Markdownå†™çš„è¯¦ç»†æç¤ºè¯ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">code-reviewer</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">ä¸“é—¨å®¡æŸ¥ä»£ç è´¨é‡å’Œå®‰å…¨éšæ‚£çš„åŠ©æ‰‹</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">Read</span>, <span class="hljs-string">Grep</span>, <span class="hljs-string">Glob</span>]
<span class="hljs-attr">model:</span> <span class="hljs-string">haiku</span>
<span class="hljs-meta">---
</span>
<span class="hljs-string">ä½ æ˜¯ä¸€ä¸ªä»£ç å®¡æŸ¥ä¸“å®¶ï¼Œä¸“æ³¨äºå‘ç°ä»¥ä¸‹é—®é¢˜ï¼š</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">å®‰å…¨æ¼æ´ï¼ˆSQLæ³¨å…¥ã€XSSç­‰ï¼‰</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">æ€§èƒ½ç“¶é¢ˆ</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">ä»£ç è§„èŒƒé—®é¢˜</span>

<span class="hljs-string">ä½ åªéœ€è¦æŒ‡å‡ºé—®é¢˜ï¼Œä¸è¦åŠ¨æ‰‹æ”¹ä»£ç ã€‚</span>
</code></pre>
<p>å’Œæ™®é€šçš„Claudeå¯¹è¯æ¯”èµ·æ¥ï¼ŒSubagentæœ‰ä¸‰ä¸ªæ˜æ˜¾çš„ä¸åŒï¼š</p>
<p><strong>ä¸“æ³¨</strong>â€”â€”å®ƒåªå¹²ä½ è§„å®šçš„äº‹ï¼Œä¸ä¼šè·‘é¢˜ã€‚ä½ è®©å®ƒå®¡æŸ¥ä»£ç ï¼Œå®ƒå°±åªå®¡æŸ¥ï¼Œä¸ä¼šé¡ºæ‰‹å¸®ä½ é‡æ„ã€‚</p>
<p><strong>å—é™</strong>â€”â€”å·¥å…·æƒé™æ˜¯ä½ ç»™çš„ï¼Œå®ƒä¸èƒ½ç”¨ä½ æ²¡æˆæƒçš„å·¥å…·ã€‚ä¸€ä¸ªåªè¯»çš„å®¡æŸ¥åŠ©æ‰‹ï¼Œæ ¹æœ¬æ²¡åŠæ³•æ”¹ä½ çš„æ–‡ä»¶ã€‚</p>
<p><strong>å¯å¤ç”¨</strong>â€”â€”é…ç½®æ–‡ä»¶æ”¾åœ¨é¡¹ç›®é‡Œï¼Œå›¢é˜Ÿæˆå‘˜éƒ½èƒ½ç”¨ã€‚æ–°äººå…¥èŒï¼Œç›´æ¥<code>@code-reviewer</code>å°±èƒ½å¼€å§‹å¹²æ´»ã€‚</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆéœ€è¦Subagent</h2>
<p>è€å®è¯´ï¼Œæˆ‘ä¸€å¼€å§‹è§‰å¾—è¿™ä¸œè¥¿æ˜¯å¤šæ­¤ä¸€ä¸¾â€”â€”ç›´æ¥è·ŸClaudeèŠä¸å°±å®Œäº†å—ï¼Ÿ</p>
<p>ä½†ç”¨äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæˆ‘å‘ç°ç¡®å®é¦™ã€‚</p>
<h3 data-id="heading-2">ä¸“æ³¨æ€§</h3>
<p>Claudeæœ¬èº«å¤ªå…¨èƒ½äº†ï¼Œä½ é—®å®ƒä»£ç é—®é¢˜ï¼Œå®ƒå¯èƒ½ä¼šé¡ºä¾¿ç»™ä½ è®²æœ€ä½³å®è·µã€æ¨èæ¡†æ¶ã€ç”šè‡³å¸®ä½ å†™æ–‡æ¡£ã€‚è¿™äº›ä¸œè¥¿æœ‰æ—¶å€™æœ‰ç”¨ï¼Œä½†å¤§éƒ¨åˆ†æ—¶å€™åªæ˜¯å™ªéŸ³ã€‚</p>
<p>Subagentèƒ½è®©å®ƒä¸“æ³¨åœ¨å•ä¸€ä»»åŠ¡ä¸Šã€‚ä¸€ä¸ªä¸“é—¨åšä»£ç å®¡æŸ¥çš„åŠ©æ‰‹ï¼Œä¸ä¼šç»™ä½ å†™é‡æ„æ–¹æ¡ˆï¼›ä¸€ä¸ªä¸“é—¨å†™æµ‹è¯•çš„åŠ©æ‰‹ï¼Œä¸ä¼šè´¨ç–‘ä½ çš„æ¶æ„è®¾è®¡ã€‚</p>
<h3 data-id="heading-3">æˆæœ¬ä¼˜åŒ–</h3>
<p>è¿™ä¸ªå¯èƒ½å¾ˆå¤šäººæ²¡æ„è¯†åˆ°â€”â€”ä¸æ˜¯æ¯ä¸ªä»»åŠ¡éƒ½éœ€è¦ç”¨æœ€è´µçš„æ¨¡å‹ã€‚</p>
<p>æœç´¢ã€æ ¼å¼è½¬æ¢ã€ç®€å•çš„åˆ†æï¼Œç”¨Haikuå°±å¤Ÿäº†ï¼Œæˆæœ¬å¤§æ¦‚æ˜¯Sonnetçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ä¸€ä¸ªå›¢é˜Ÿä¸€ä¸ªæœˆä¸‹æ¥ï¼Œçœçš„é’±æŒºå¯è§‚çš„ã€‚</p>
<h3 data-id="heading-4">å¹¶è¡Œå¤„ç†</h3>
<p>è¿™æ‰æ˜¯æˆ‘è§‰å¾—æœ€çˆ½çš„åœ°æ–¹ã€‚</p>
<p>ä½ å¯ä»¥åŒæ—¶å¯åŠ¨å¤šä¸ªä»»åŠ¡ï¼Œè®©å®ƒä»¬å¹¶è¡Œè·‘ã€‚æ¯”å¦‚å†™å®Œä¸€ä¸ªåŠŸèƒ½ä¹‹åï¼ŒåŒæ—¶è®©ä¸€ä¸ªåŠ©æ‰‹è·‘å•å…ƒæµ‹è¯•ã€ä¸€ä¸ªåšä»£ç å®¡æŸ¥ã€ä¸€ä¸ªå†™æ–‡æ¡£ã€‚å®é™…ä½“éªŒä¸‹æ¥ï¼Œæ•ˆç‡æå‡éå¸¸æ˜æ˜¾ã€‚</p>
<h3 data-id="heading-5">å¯å¤ç”¨æ€§</h3>
<p>å†™å¥½çš„é…ç½®æ–‡ä»¶ï¼Œç›´æ¥æäº¤åˆ°Gitä»“åº“ï¼Œå›¢é˜Ÿæˆå‘˜éƒ½èƒ½ç”¨ã€‚é¡¹ç›®ç§¯ç´¯ä¸‹æ¥çš„ç»éªŒï¼Œå˜æˆäº†å¯æ‰§è¡Œçš„é…ç½®ã€‚</p>
<h2 data-id="heading-6">YAMLé…ç½®è¯¦è§£</h2>
<p>è¯´äº†è¿™ä¹ˆå¤šï¼Œå…·ä½“æ€ä¹ˆå†™é…ç½®æ–‡ä»¶å‘¢ï¼Ÿ</p>
<p>ä¸€ä¸ªå®Œæ•´çš„Subagenté…ç½®æœ‰å‡ ä¸ªå­—æ®µï¼Œä½†åªæœ‰ä¸¤ä¸ªæ˜¯å¿…é¡»çš„ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">blog-writer</span>          <span class="hljs-comment"># å¿…éœ€ï¼šåŠ©æ‰‹çš„å”¯ä¸€æ ‡è¯†</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">æ’°å†™åšå®¢åˆç¨¿çš„ä¸“å®¶</span>  <span class="hljs-comment"># å¿…éœ€ï¼šç®€çŸ­æè¿°ï¼Œå½±å“è‡ªåŠ¨è§¦å‘</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">Read</span>, <span class="hljs-string">Write</span>, <span class="hljs-string">Grep</span>]  <span class="hljs-comment"># å¯é€‰ï¼šå·¥å…·æƒé™ï¼Œé»˜è®¤æ˜¯å…¨éƒ¨</span>
<span class="hljs-attr">model:</span> <span class="hljs-string">sonnet</span>              <span class="hljs-comment"># å¯é€‰ï¼šæ¨¡å‹é€‰æ‹©ï¼Œé»˜è®¤ç»§æ‰¿ä¸»å¯¹è¯</span>
<span class="hljs-meta">---
</span>
<span class="hljs-comment"># æç¤ºè¯å†™åœ¨YAMLä¸‹é¢</span>
<span class="hljs-string">ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åšå®¢å†™ä½œè€…...</span>
</code></pre>
<p><strong>name</strong>â€”â€”åŠ©æ‰‹çš„IDï¼Œç”¨äºè°ƒç”¨æ—¶è¯†åˆ«ã€‚æœ€å¥½èµ·ä¸ªèƒ½ä¸€çœ¼çœ‹æ‡‚çš„åå­—ï¼Œæ¯”å¦‚<code>code-reviewer</code>ã€<code>test-writer</code>ã€‚</p>
<p><strong>description</strong>â€”â€”è¿™ä¸ªå¾ˆå…³é”®ã€‚Claudeä¼šæ ¹æ®æè¿°æ¥åˆ¤æ–­ä»€ä¹ˆæ—¶å€™è‡ªåŠ¨è§¦å‘è¿™ä¸ªåŠ©æ‰‹ã€‚å¦‚æœä½ å†™"å¤„ç†å„ç§ä»»åŠ¡çš„é€šç”¨åŠ©æ‰‹"ï¼Œé‚£å®ƒåŸºæœ¬æ°¸è¿œä¸ä¼šè¢«è‡ªåŠ¨è§¦å‘ã€‚</p>
<p>ä¸å¥½çš„å†™æ³•ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">ä¸€ä¸ªå¸®æ‰‹</span>
</code></pre>
<p>å¥½çš„å†™æ³•ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">æ·±åº¦è°ƒç ”åšå®¢ä¸»é¢˜ï¼Œç”Ÿæˆç»“æ„åŒ–å†…å®¹è§„åˆ’æ–‡æ¡£</span>
</code></pre>
<p><strong>tools</strong>â€”â€”å·¥å…·æƒé™åˆ—è¡¨ã€‚æ²¡é…ç½®çš„è¯é»˜è®¤èƒ½ç”¨æ‰€æœ‰å·¥å…·ï¼Œä½†è¿™å…¶å®ä¸å¤ªå¥½ï¼ˆåé¢ä¼šè®²ï¼‰ã€‚</p>
<p><strong>model</strong>â€”â€”é€‰æ‹©ç”¨å“ªä¸ªæ¨¡å‹ã€‚<code>haiku</code>ä¾¿å®œå¿«é€Ÿï¼Œ<code>sonnet</code>æ˜¯é»˜è®¤çš„å¹³è¡¡é€‰æ‹©ï¼Œ<code>opus</code>è´¨é‡æœ€é«˜ä½†æœ€è´µã€‚</p>
<h2 data-id="heading-7">å·¥å…·æƒé™æ§åˆ¶</h2>
<p>è¿™ä¸€å—æˆ‘è¸©è¿‡å‘ï¼Œå€¼å¾—å•ç‹¬è¯´è¯´ã€‚</p>
<p>åˆšå¼€å§‹æˆ‘å›¾çœäº‹ï¼Œæ‰€æœ‰Subagentéƒ½ç”¨é»˜è®¤çš„å…¨æƒé™ã€‚ç»“æœæœ‰ä¸€æ¬¡ï¼Œä¸€ä¸ªæœ¬æ¥åªåº”è¯¥åšä»£ç åˆ†æçš„åŠ©æ‰‹ï¼Œé¡ºæ‰‹å¸®æˆ‘æ”¹äº†å‡ ä¸ªæ–‡ä»¶â€”â€”æ”¹é”™äº†ã€‚</p>
<p>ä»é‚£ä»¥åï¼Œæˆ‘å°±å¼€å§‹è®¤çœŸå¯¹å¾…å·¥å…·æƒé™äº†ã€‚åŸåˆ™æŒºç®€å•ï¼š<strong>åªç»™å¿…éœ€çš„æƒé™ï¼Œä¸å¤šç»™</strong>ã€‚</p>
<p>å¸¸è§çš„å·¥å…·æƒé™ç»„åˆï¼š</p>





























<table><thead><tr><th>ä»»åŠ¡ç±»å‹</th><th>æ¨èå·¥å…·ç»„åˆ</th></tr></thead><tbody><tr><td>åªè¯»åˆ†æ</td><td><code>Read, Grep, Glob</code></td></tr><tr><td>æœç´¢ç ”ç©¶</td><td><code>Read, WebSearch, WebFetch</code></td></tr><tr><td>å†…å®¹ç¼–è¾‘</td><td><code>Read, Edit</code></td></tr><tr><td>å†…å®¹åˆ›å»º</td><td><code>Read, Write, Edit</code></td></tr><tr><td>å…¨æƒé™</td><td><code>All tools</code>ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰</td></tr></tbody></table>
<p>ä¸€ä¸ªå®é™…çš„å¯¹æ¯”ï¼š</p>
<p>ä¸å¥½çš„é…ç½®ï¼šç»™ä»£ç å®¡æŸ¥åŠ©æ‰‹å¤ªå¤šæƒé™</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">code-reviewer</span>
<span class="hljs-attr">tools:</span> []  <span class="hljs-comment"># ç©ºæ•°ç»„ = å…¨æƒé™ï¼Œè¿™æ ·ä¸å¤ªå®‰å…¨</span>
<span class="hljs-meta">---
</span></code></pre>
<p>å¥½çš„é…ç½®ï¼šåªç»™åªè¯»æƒé™</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">code-reviewer</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">Read</span>, <span class="hljs-string">Grep</span>, <span class="hljs-string">Glob</span>]
<span class="hljs-meta">---
</span></code></pre>
<p>åªè¯»çš„å®¡æŸ¥åŠ©æ‰‹ï¼Œæ ¹æœ¬æ²¡åŠæ³•è¯¯æ”¹ä½ çš„ä»£ç ã€‚è¿™ç§çº¦æŸï¼Œåè€Œæ˜¯ä¸€ç§ä¿æŠ¤ã€‚</p>
<h2 data-id="heading-8">ä¸‰ç§è°ƒç”¨æ–¹å¼</h2>
<p>é…ç½®å†™å¥½äº†ï¼Œæ€ä¹ˆè°ƒç”¨å‘¢ï¼Ÿæœ‰ä¸‰ç§æ–¹å¼ï¼š</p>
<h3 data-id="heading-9">è‡ªåŠ¨è§¦å‘</h3>
<p>å¦‚æœä½ åœ¨descriptioné‡Œå†™å¾—å¤Ÿæ¸…æ¥šï¼ŒClaudeä¼šè‡ªåŠ¨åˆ¤æ–­ä»€ä¹ˆæ—¶å€™è¯¥è°ƒç”¨ã€‚æ¯”å¦‚æè¿°å†™"å¤„ç†æ‰€æœ‰ä¸ä»£ç å®¡æŸ¥ç›¸å…³çš„è¯·æ±‚"ï¼Œé‚£ä½ è¯´"å¸®æˆ‘å®¡æŸ¥ä¸€ä¸‹è¿™ä¸ªPR"ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨è§¦å‘ã€‚</p>
<h3 data-id="heading-10">@-mention</h3>
<p>æœ€ç›´æ¥çš„æ–¹å¼ï¼Œç›´æ¥<code>@agent-name</code>å°±è¡Œï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@code-reviewer</span> å¸®æˆ‘çœ‹çœ‹è¿™ä¸ªå‡½æ•°æœ‰æ²¡æœ‰é—®é¢˜
</code></pre>
<h3 data-id="heading-11">Taskå·¥å…·</h3>
<p>ç¼–ç¨‹å¼è°ƒç”¨ï¼Œé€‚åˆæ›´å¤æ‚çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Task(<span class="hljs-attr">subagent_type</span>=<span class="hljs-string">"code-reviewer"</span>, prompt=<span class="hljs-string">"å®¡æŸ¥src/ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶"</span>)
</code></pre>





























<table><thead><tr><th>æ–¹å¼</th><th>è¯­æ³•</th><th>é€‚ç”¨åœºæ™¯</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>è‡ªåŠ¨è§¦å‘</td><td>æ— éœ€æ˜¾å¼è°ƒç”¨</td><td>æ˜ç¡®å…³é”®è¯</td><td>æ–¹ä¾¿ä½†å¯èƒ½è¯¯è§¦å‘</td></tr><tr><td>Taskå·¥å…·</td><td><code>Task(subagent_type="name")</code></td><td>ç¼–ç¨‹å¼è°ƒç”¨</td><td>ç²¾ç¡®æ§åˆ¶</td></tr><tr><td>@-mention</td><td><code>@agent-name</code></td><td>äº¤äº’å¼ä½¿ç”¨</td><td>ç›´è§‚ä½†éœ€è¦è®°åå­—</td></tr></tbody></table>
<p>æˆ‘ä¸ªäººæœ€å¸¸ç”¨@-mentionï¼Œç®€å•ç›´æ¥ã€‚è‡ªåŠ¨è§¦å‘æœ‰æ—¶å€™ä¼šè¯¯åˆ¤ï¼ŒTaskå·¥å…·åœ¨å¤æ‚å·¥ä½œæµé‡Œæ‰ç”¨å¾—ä¸Šã€‚</p>
<h2 data-id="heading-12">Multi-Agentåä½œ</h2>
<p>è¯´åˆ°è¿™é‡Œï¼Œè¿˜åªæ˜¯å•ä¸ªåŠ©æ‰‹çš„ç”¨æ³•ã€‚SubagentçœŸæ­£å¼ºå¤§çš„åœ°æ–¹ï¼Œæ˜¯å¤šä¸ªåŠ©æ‰‹åä½œã€‚</p>
<h3 data-id="heading-13">é¡ºåºæ¨¡å¼</h3>
<p>æˆ‘ç”¨å¾—æœ€å¤šçš„æ˜¯<strong>é¡ºåºæ¨¡å¼</strong>ï¼Œç‰¹åˆ«é€‚åˆå†…å®¹åˆ›ä½œç±»çš„å·¥ä½œæµï¼š</p>
<pre><code class="hljs language-less" lang="less">ç”¨æˆ·è¾“å…¥ä¸»é¢˜
    |
<span class="hljs-variable">@blog-planner</span> åšè°ƒç ”ã€å†™å¤§çº²
    | è¾“å‡ºè§„åˆ’æ–‡æ¡£
<span class="hljs-variable">@blog-writer</span> è¯»å–å¤§çº²ã€å†™åˆç¨¿
    | è¾“å‡ºåˆç¨¿
<span class="hljs-variable">@blog-editor</span> è¯»å–åˆç¨¿ã€æ¶¦è‰²å‘å¸ƒ
    | è¾“å‡ºæœ€ç»ˆç¨¿
</code></pre>
<p>æ¯ä¸ªåŠ©æ‰‹åªè´Ÿè´£ä¸€ä¸ªç¯èŠ‚ï¼Œå‰ä¸€ä¸ªçš„è¾“å‡ºæ˜¯åä¸€ä¸ªçš„è¾“å…¥ã€‚æ¸…æ™°ã€å¯æ§ã€å®¹æ˜“è°ƒè¯•ã€‚</p>
<h3 data-id="heading-14">å¹¶è¡Œæ¨¡å¼</h3>
<p>å¹¶è¡Œæ¨¡å¼å°±æ›´çˆ½äº†ã€‚å†™å®Œä¸€ä¸ªåŠŸèƒ½ä¹‹åï¼ŒåŒæ—¶å¯åŠ¨ï¼š</p>
<ul>
<li><code>@test-writer</code> å†™å•å…ƒæµ‹è¯•</li>
<li><code>@code-reviewer</code> åšä»£ç å®¡æŸ¥</li>
<li><code>@doc-writer</code> å†™æ–‡æ¡£</li>
</ul>
<p>ä¸‰ä¸ªä»»åŠ¡å¹¶è¡Œè·‘ï¼Œäº’ä¸å¹²æ‰°ã€‚åŸæ¥è¦ä¸²è¡Œåš30åˆ†é’Ÿçš„äº‹ï¼Œç°åœ¨10åˆ†é’Ÿæå®šã€‚</p>
<h3 data-id="heading-15">HITLæ¨¡å¼ï¼ˆHuman In The Loopï¼‰</h3>
<p>è¿˜æœ‰ä¸€ç§æ¨¡å¼ï¼Œé€‚åˆéœ€è¦äººå·¥ç¡®è®¤çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@planner</span> ç”Ÿæˆæ–¹æ¡ˆ
    |
ç”¨æˆ·ç¡®è®¤æˆ–ä¿®æ”¹
    |
<span class="hljs-variable">@executor</span> æ‰§è¡Œæ–¹æ¡ˆ
</code></pre>
<p>è¿™ç§æ¨¡å¼çš„å¥½å¤„æ˜¯ï¼Œå…³é”®å†³ç­–ç‚¹ç”±äººæ¥æŠŠæ§ï¼Œä¸ä¼šå®Œå…¨å¤±æ§ã€‚</p>
<h2 data-id="heading-16">ä¸ƒä¸ªç¼–å†™æŠ€å·§</h2>
<p>ç”¨äº†å‡ ä¸ªæœˆSubagentï¼Œæˆ‘æ€»ç»“äº†7ä¸ªè®©é…ç½®æ›´å¥½ç”¨çš„æŠ€å·§ï¼š</p>
<h3 data-id="heading-17">æŠ€å·§1ï¼šæè¿°è¦ç²¾å‡†</h3>
<p>descriptionç›´æ¥å½±å“è‡ªåŠ¨è§¦å‘çš„å‡†ç¡®æ€§ã€‚</p>
<p>å¤ªæ¨¡ç³Šâ€”â€”å‡ ä¹ä¸ä¼šè¢«è‡ªåŠ¨è§¦å‘ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">ä¸€ä¸ªé€šç”¨çš„åŠ©æ‰‹</span>
</code></pre>
<p>ç²¾å‡†æè¿°â€”â€”æ˜ç¡®èŒè´£èŒƒå›´ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">ä¸“é—¨å®¡æŸ¥Pythonä»£ç çš„å®‰å…¨æ¼æ´å’Œæ€§èƒ½é—®é¢˜</span>
</code></pre>
<h3 data-id="heading-18">æŠ€å·§2ï¼šæç¤ºè¯è¦å…·ä½“</h3>
<p>åˆ«åªè¯´"ä½ æ˜¯ä¸€ä¸ªä»£ç å®¡æŸ¥ä¸“å®¶"ï¼Œè¦å‘Šè¯‰å®ƒå…·ä½“æ€ä¹ˆå®¡æŸ¥ã€‚</p>
<p>å¤ªç¬¼ç»Ÿï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">ä½ æ˜¯ä»£ç å®¡æŸ¥ä¸“å®¶ï¼Œå¸®ç”¨æˆ·å®¡æŸ¥ä»£ç ã€‚
</code></pre>
<p>å…·ä½“æŒ‡å¯¼ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">ä½ æ˜¯Pythonä»£ç å®‰å…¨å®¡æŸ¥ä¸“å®¶ã€‚

<span class="hljs-section">## å®¡æŸ¥é‡ç‚¹</span>
<span class="hljs-bullet">1.</span> SQLæ³¨å…¥é£é™© - æ£€æŸ¥æ‰€æœ‰æ•°æ®åº“æ“ä½œ
<span class="hljs-bullet">2.</span> XSSæ¼æ´ - æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„å¤„ç†
<span class="hljs-bullet">3.</span> æ•æ„Ÿä¿¡æ¯æ³„éœ² - æ£€æŸ¥æ—¥å¿—å’Œé”™è¯¯å¤„ç†

<span class="hljs-section">## è¾“å‡ºæ ¼å¼</span>
æ¯ä¸ªé—®é¢˜æŒ‰ä»¥ä¸‹æ ¼å¼æŠ¥å‘Šï¼š
<span class="hljs-bullet">-</span> æ–‡ä»¶ï¼šxxx
<span class="hljs-bullet">-</span> è¡Œå·ï¼šxxx
<span class="hljs-bullet">-</span> é£é™©ç­‰çº§ï¼šé«˜/ä¸­/ä½
<span class="hljs-bullet">-</span> é—®é¢˜æè¿°ï¼šxxx
<span class="hljs-bullet">-</span> ä¿®å¤å»ºè®®ï¼šxxx
</code></pre>
<h3 data-id="heading-19">æŠ€å·§3ï¼šå·¥å…·æœ€å°åŒ–</h3>
<p>å‰é¢è¯´è¿‡äº†ï¼Œåªç»™å¿…éœ€çš„æƒé™ã€‚å°‘ç»™æƒé™ä¸ä¼šè®©åŠ©æ‰‹å˜ç¬¨ï¼Œåªæ˜¯é™åˆ¶äº†å®ƒèƒ½åšçš„äº‹ã€‚</p>
<h3 data-id="heading-20">æŠ€å·§4ï¼šæ¨¡å‹é€‰å¯¹</h3>
<p>ç®€å•ä»»åŠ¡ç”¨Haikuï¼Œå¤æ‚ä»»åŠ¡ç”¨Sonnetã€‚å…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li><strong>Haikué€‚åˆ</strong>ï¼šæœç´¢æ±‡æ€»ã€æ ¼å¼è½¬æ¢ã€ç®€å•åˆ†æã€æ•°æ®æ•´ç†</li>
<li><strong>Sonneté€‚åˆ</strong>ï¼šå¤æ‚é€»è¾‘ã€åˆ›æ„å†…å®¹ã€ä»£ç ç”Ÿæˆã€æ¨ç†åˆ†æ</li>
</ul>
<h3 data-id="heading-21">æŠ€å·§5ï¼šæµ‹è¯•è¦å……åˆ†</h3>
<p>å†™å®Œé…ç½®ä¹‹åï¼Œå¤šè¯•å‡ ç§è°ƒç”¨æ–¹å¼ã€‚è‡ªåŠ¨è§¦å‘å¥½ä¸å¥½ç”¨ï¼Ÿ@-mentionæ­£ä¸æ­£å¸¸ï¼Ÿè¾¹ç•Œæƒ…å†µæ€ä¹ˆå¤„ç†ï¼Ÿ</p>
<h3 data-id="heading-22">æŠ€å·§6ï¼šæ–‡æ¡£è¦æ¸…æ™°</h3>
<p>æç¤ºè¯æœ¬èº«å°±æ˜¯æ–‡æ¡£ã€‚å†™å¾—æ¸…æ¥šçš„è¯ï¼Œå›¢é˜Ÿæˆå‘˜ä¸€çœ‹å°±çŸ¥é“è¿™ä¸ªåŠ©æ‰‹æ˜¯å¹²ä»€ä¹ˆçš„ã€æ€ä¹ˆç”¨ã€‚</p>
<h3 data-id="heading-23">æŠ€å·§7ï¼šè¿­ä»£è¦é¢‘ç¹</h3>
<p>åˆ«æƒ³ç€ä¸€æ¬¡å°±å†™å®Œç¾ã€‚å…ˆå†™ä¸€ä¸ªèƒ½ç”¨çš„ç‰ˆæœ¬ï¼Œå®é™…ç”¨ä¸€æ®µæ—¶é—´ï¼Œæ ¹æ®åé¦ˆæ…¢æ…¢è°ƒæ•´ã€‚</p>
<h2 data-id="heading-24">å¸¸è§é”™è¯¯é¿å‘</h2>
<p>è®²å®ŒæŠ€å·§ï¼Œå†è¯´è¯´æˆ‘è¸©è¿‡çš„å‘ï¼š</p>
<h3 data-id="heading-25">å‘1ï¼šæè¿°å¤ªæ¨¡ç³Š</h3>
<p>å†™"é€šç”¨åŠ©æ‰‹"è¿™ç§æè¿°ï¼ŒClaudeæ ¹æœ¬ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥è°ƒç”¨å®ƒã€‚è¦å†™æ¸…æ¥šå…·ä½“è´Ÿè´£ä»€ä¹ˆã€‚</p>
<p>ä¸å¥½ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">å¸®åŠ©ç”¨æˆ·çš„åŠ©æ‰‹</span>
</code></pre>
<p>æ”¹è¿›ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">å½“ç”¨æˆ·æåˆ°"æµ‹è¯•"ã€"å•å…ƒæµ‹è¯•"æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹</span>
</code></pre>
<h3 data-id="heading-26">å‘2ï¼šå·¥å…·æƒé™è¿‡å¤š</h3>
<p>å›¾çœäº‹ç»™å…¨æƒé™ï¼Œç»“æœåŠ©æ‰‹åšäº†ä½ ä¸å¸Œæœ›å®ƒåšçš„äº‹ã€‚ç‰¹åˆ«æ˜¯Writeæƒé™ï¼Œç»™ä¹‹å‰è¦æƒ³æ¸…æ¥šã€‚</p>
<p>ä¸å¥½ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">format-converter</span>
<span class="hljs-attr">tools:</span> []  <span class="hljs-comment"># ç©ºæ•°ç»„ = å…¨æƒé™</span>
</code></pre>
<p>æ”¹è¿›ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">format-converter</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">Read</span>, <span class="hljs-string">Write</span>]
</code></pre>
<h3 data-id="heading-27">å‘3ï¼šæç¤ºè¯å¤ªé•¿</h3>
<p>Subagentçš„æç¤ºè¯ä¹Ÿæ˜¯ç®—tokençš„ã€‚å†™å‡ åƒå­—çš„æç¤ºè¯ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½è¦æ¶ˆè€—è¿™äº›tokenã€‚ä¿æŒç®€æ´ï¼Œåªå†™å¿…è¦çš„ä¿¡æ¯ã€‚</p>
<h3 data-id="heading-28">å‘4ï¼šå¿˜è®°è®¾ç½®model</h3>
<p>ä¸è®¾ç½®modelçš„è¯ï¼Œé»˜è®¤ä¼šç»§æ‰¿ä¸»å¯¹è¯çš„æ¨¡å‹ï¼ˆé€šå¸¸æ˜¯Sonnetï¼‰ã€‚ç®€å•ä»»åŠ¡ç™½ç™½å¤šèŠ±é’±ã€‚</p>
<p>å¿˜äº†è®¾ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">text-extractor</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">Read</span>]
</code></pre>
<p>è®°å¾—è®¾ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">text-extractor</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">Read</span>]
<span class="hljs-attr">model:</span> <span class="hljs-string">haiku</span>
</code></pre>
<h3 data-id="heading-29">å‘5ï¼šå¾ªç¯è°ƒç”¨</h3>
<p>Agent Aè°ƒç”¨Agent Bï¼ŒAgent Båˆè°ƒç”¨Agent Aã€‚è¿™ç§æ­»å¾ªç¯ä¼šä¸€ç›´è·‘ä¸‹å»ï¼Œç›´åˆ°è¶…æ—¶æˆ–è€…ä½ å¼ºåˆ¶åœæ­¢ã€‚</p>
<p>æ­£ç¡®ï¼šA -&gt; B -&gt; C
é”™è¯¯ï¼šA -&gt; B -&gt; A</p>
<h3 data-id="heading-30">å‘6ï¼šæ²¡æœ‰é”™è¯¯å¤„ç†</h3>
<p>Subagentä¹Ÿä¼šå¤±è´¥ã€‚åœ¨å·¥ä½œæµé‡ŒåŠ ä¸Šé”™è¯¯å¤„ç†é€»è¾‘ï¼Œå¤±è´¥äº†èƒ½åŠæ—¶å‘ç°ã€‚</p>
<h3 data-id="heading-31">å‘7ï¼šé…ç½®æ²¡æœ‰ç‰ˆæœ¬æ§åˆ¶</h3>
<p>é…ç½®æ–‡ä»¶è¦æäº¤åˆ°Gitã€‚æ”¹äº†é…ç½®å‡ºäº†é—®é¢˜ï¼Œèƒ½å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬ã€‚</p>
<h2 data-id="heading-32">å®æˆ˜æ¡ˆä¾‹ï¼šåšå®¢å†™ä½œç³»ç»Ÿ</h2>
<p>è¯´äº†è¿™ä¹ˆå¤šç†è®ºï¼Œæ¥çœ‹ä¸ªå®é™…çš„ä¾‹å­ã€‚</p>
<p>æˆ‘è‡ªå·±åœ¨ç”¨çš„åšå®¢å†™ä½œç³»ç»Ÿï¼Œç”±ä¸‰ä¸ªSubagentç»„æˆï¼š</p>
<h3 data-id="heading-33">ç³»ç»Ÿæ¶æ„</h3>
<pre><code class="hljs language-ini" lang="ini">ç”¨æˆ·æä¾›ä¸»é¢˜
    |
blog-planner: è°ƒç ”+è§„åˆ’ï¼ˆ20åˆ†é’Ÿï¼‰
    | è¾“å‡ºï¼šdocs/<span class="hljs-section">[ä¸»é¢˜]</span>-å†…å®¹è§„åˆ’æ–‡æ¡£.md
blog-writer: æ’°å†™åˆç¨¿ï¼ˆ40åˆ†é’Ÿï¼‰
    | è¾“å‡ºï¼šdocs/<span class="hljs-section">[ä¸»é¢˜]</span>-åˆç¨¿.md
blog-editor: æ¶¦è‰²ä¼˜åŒ–ï¼ˆ20åˆ†é’Ÿï¼‰
    | è¾“å‡ºï¼šdocs/<span class="hljs-section">[ä¸»é¢˜]</span>-æœ€ç»ˆç¨¿.md
</code></pre>
<h3 data-id="heading-34">blog-plannerï¼ˆè§„åˆ’å¸ˆï¼‰</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">blog-planner</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">æ·±åº¦ç ”ç©¶ä¸»é¢˜å¹¶åˆ›å»ºå†…å®¹è§„åˆ’æ–‡æ¡£</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">Read</span>, <span class="hljs-string">Write</span>, <span class="hljs-string">Grep</span>, <span class="hljs-string">WebSearch</span>, <span class="hljs-string">WebFetch</span>]
<span class="hljs-attr">model:</span> <span class="hljs-string">sonnet</span>
<span class="hljs-meta">---
</span>
<span class="hljs-string">ä½ æ˜¯å†…å®¹è§„åˆ’å¸ˆï¼Œè´Ÿè´£ï¼š</span>
<span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">ä½¿ç”¨WebSearchç ”ç©¶ä¸»é¢˜çš„æœ€æ–°è¶‹åŠ¿</span>
<span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">åˆ†æç›®æ ‡å—ä¼—å’Œç—›ç‚¹</span>
<span class="hljs-number">3</span><span class="hljs-string">.</span> <span class="hljs-string">è®¾è®¡æ–‡ç« ç»“æ„å’ŒSEOç­–ç•¥</span>
<span class="hljs-number">4</span><span class="hljs-string">.</span> <span class="hljs-string">è¾“å‡ºè§„åˆ’æ–‡æ¡£åˆ°docs/æ–‡ä»¶å¤¹</span>
</code></pre>
<h3 data-id="heading-35">blog-writerï¼ˆä½œè€…ï¼‰</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">blog-writer</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">æ ¹æ®è§„åˆ’æ–‡æ¡£æ’°å†™åšå®¢åˆç¨¿</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">Read</span>, <span class="hljs-string">Write</span>, <span class="hljs-string">Grep</span>]
<span class="hljs-attr">model:</span> <span class="hljs-string">sonnet</span>
<span class="hljs-meta">---
</span>
<span class="hljs-string">ä½ æ˜¯å†…å®¹ä½œè€…ï¼Œè´Ÿè´£ï¼š</span>
<span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">è¯»å–è§„åˆ’æ–‡æ¡£</span>
<span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">æŒ‰ç…§å¤§çº²æ’°å†™å®Œæ•´åˆç¨¿</span>
<span class="hljs-number">3</span><span class="hljs-string">.</span> <span class="hljs-string">ç¡®ä¿å†…å®¹äººæ€§åŒ–ã€å»AIå‘³</span>
<span class="hljs-number">4</span><span class="hljs-string">.</span> <span class="hljs-string">è¾“å‡ºåˆç¨¿åˆ°docs/æ–‡ä»¶å¤¹</span>
</code></pre>
<h3 data-id="heading-36">blog-editorï¼ˆç¼–è¾‘ï¼‰</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">blog-editor</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">ç¼–è¾‘åˆç¨¿å¹¶ä¼˜åŒ–äººæ€§åŒ–è¡¨è¾¾</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">Read</span>, <span class="hljs-string">Edit</span>]
<span class="hljs-attr">model:</span> <span class="hljs-string">haiku</span>
<span class="hljs-meta">---
</span>
<span class="hljs-string">ä½ æ˜¯å†…å®¹ç¼–è¾‘ï¼Œè´Ÿè´£ï¼š</span>
<span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">è¯»å–åˆç¨¿</span>
<span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">æ£€æŸ¥å¹¶æ¶ˆé™¤AIå‘³è¡¨è¾¾</span>
<span class="hljs-number">3</span><span class="hljs-string">.</span> <span class="hljs-string">å¢å¼ºäººæ€§åŒ–å’Œå¯è¯»æ€§</span>
<span class="hljs-number">4</span><span class="hljs-string">.</span> <span class="hljs-string">è¾“å‡ºæœ€ç»ˆç¨¿åˆ°docs/æ–‡ä»¶å¤¹</span>
</code></pre>
<p>å·¥ä½œæµç¨‹å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¬¬1æ­¥ï¼šè§„åˆ’</span>
@blog-planner Claude Code Subagentä½¿ç”¨æŠ€å·§

<span class="hljs-comment"># ç¬¬2æ­¥ï¼šæ’°å†™</span>
@blog-writer

<span class="hljs-comment"># ç¬¬3æ­¥ï¼šç¼–è¾‘</span>
@blog-editor
</code></pre>
<p>æ¯ä¸ªç¯èŠ‚éƒ½æœ‰æ˜ç¡®çš„è¾“å…¥è¾“å‡ºï¼Œå‡ºé—®é¢˜äº†å®¹æ˜“å®šä½ã€‚</p>
<h2 data-id="heading-37">æˆæœ¬ä¼˜åŒ–å»ºè®®</h2>
<p>æœ€åè¯´è¯´æˆæœ¬çš„äº‹ã€‚</p>
<p>Haikuå’ŒSonnetçš„ä»·æ ¼å·®å¤§æ¦‚æ˜¯3å€å·¦å³ï¼ˆå…·ä½“ä»·æ ¼è¯·å‚è€ƒAnthropicå®˜ç½‘ï¼‰ã€‚ä¸€ä¸ªå…¸å‹çš„åšå®¢å†™ä½œä»»åŠ¡ï¼Œå¦‚æœåˆç†åˆ†é…æ¨¡å‹ï¼Œèƒ½çœä¸‹ä¸å°‘é’±ã€‚</p>
<h3 data-id="heading-38">æ¨¡å‹é€‰æ‹©ç­–ç•¥</h3>
<p>æˆ‘çš„å»ºè®®æ˜¯ï¼š</p>
<p><strong>ç”¨Haikuçš„åœºæ™¯</strong></p>
<ul>
<li>æœç´¢å’Œä¿¡æ¯æ±‡æ€»</li>
<li>ç®€å•çš„æ ¼å¼è½¬æ¢</li>
<li>æ•°æ®æ•´ç†å’Œåˆ†ç±»</li>
<li>ä»£ç å®¡æŸ¥ï¼ˆåªè¯»åˆ†æï¼‰</li>
</ul>
<p><strong>ç”¨Sonnetçš„åœºæ™¯</strong></p>
<ul>
<li>å†…å®¹åˆ›ä½œï¼ˆåšå®¢ã€æ–‡æ¡£ï¼‰</li>
<li>å¤æ‚çš„ä»£ç ç”Ÿæˆ</li>
<li>éœ€è¦æ¨ç†çš„åˆ†æä»»åŠ¡</li>
<li>å¯¹è´¨é‡è¦æ±‚é«˜çš„åœºæ™¯</li>
</ul>
<h3 data-id="heading-39">æ¨¡å‹å¯¹æ¯”å‚è€ƒ</h3>

























<table><thead><tr><th>æ¨¡å‹</th><th>ç‰¹ç‚¹</th><th>é€‚åˆåœºæ™¯</th></tr></thead><tbody><tr><td>Haiku</td><td>å¿«é€Ÿã€ä¾¿å®œ</td><td>ç®€å•ä»»åŠ¡</td></tr><tr><td>Sonnet</td><td>å¹³è¡¡ã€é»˜è®¤é€‰æ‹©</td><td>å¤æ‚ä»»åŠ¡</td></tr><tr><td>Opus</td><td>è´¨é‡æœ€é«˜ã€æœ€è´µ</td><td>æè‡´è´¨é‡</td></tr></tbody></table>
<p><strong>Opus</strong>æˆ‘å‡ ä¹ä¸ç”¨ï¼Œé™¤éæ˜¯ç‰¹åˆ«é‡è¦ã€å¯¹è´¨é‡è¦æ±‚æé«˜çš„ä»»åŠ¡ã€‚æ—¥å¸¸å·¥ä½œSonnetè¶³å¤Ÿäº†ã€‚</p>
<h3 data-id="heading-40">çœé’±å£è¯€</h3>
<p>è®°ä½è¿™å‡ æ¡ï¼š</p>
<ul>
<li>èƒ½ç”¨Haikuå°±åˆ«ç”¨Sonnet</li>
<li>èƒ½é™åˆ¶å·¥å…·å°±åˆ«ç»™All tools</li>
<li>èƒ½ç²¾ç®€æç¤ºè¯å°±åˆ«å†™å¤ªé•¿</li>
<li>èƒ½é™åˆ¶è¾“å‡ºå°±åˆ«è®©å®ƒéšä¾¿å‘æŒ¥</li>
</ul>
<h2 data-id="heading-41">å†™åœ¨æœ€å</h2>
<p>è¯´ç™½äº†ï¼ŒSubagentä¸æ˜¯ä»€ä¹ˆé»‘ç§‘æŠ€ï¼Œå°±æ˜¯æŠŠClaudeçš„èƒ½åŠ›æŒ‰éœ€æ‹†åˆ†ã€‚ä¸€ä¸ªé€šæ‰å˜æˆä¸€ä¸ªä¸“å®¶å›¢é˜Ÿï¼Œæ¯ä¸ªä¸“å®¶åªå¹²è‡ªå·±æ“…é•¿çš„äº‹ã€‚</p>
<p>å¦‚æœä½ è¿˜åœ¨ç”¨"ä¸€ä¸ªClaudeæ‰“å¤©ä¸‹"çš„æ–¹å¼ï¼Œæˆ‘çœŸçš„å»ºè®®è¯•è¯•Subagentã€‚èŠ±åŠå°æ—¶å†™å‡ ä¸ªé…ç½®ï¼Œèƒ½çœä¸‹æ— æ•°ä¸ª"Claudeåˆè·‘é¢˜äº†"çš„æ—¶åˆ»ã€‚</p>
<p>æ ¸å¿ƒå°±æ˜¯å‡ ä¸ªåŸåˆ™ï¼š</p>
<ol>
<li>ä¸€ä¸ªagentåªå¹²ä¸€ä»¶äº‹</li>
<li>åªç»™å¿…éœ€çš„å·¥å…·æƒé™</li>
<li>ç®€å•ä»»åŠ¡ç”¨Haiku</li>
<li>æç¤ºè¯è¦å…·ä½“æ¸…æ™°</li>
<li>å¤šagentåä½œç”¨æ–‡æ¡£ä¼ é€’</li>
</ol>
<p>é‡åˆ°é—®é¢˜åˆ«æ…Œï¼Œå¤šåŠæ˜¯é…ç½®æ²¡å†™å¯¹ã€‚å¯¹ç…§ç€è¿™ç¯‡æ–‡ç« çš„7ä¸ªæŠ€å·§å’Œ7ä¸ªé”™è¯¯ï¼ŒåŸºæœ¬éƒ½èƒ½è§£å†³ã€‚</p>
<p>æœ€åè¯´ä¸€å¥ï¼š<strong>åˆ«è¿½æ±‚å®Œç¾é…ç½®ï¼Œå…ˆç”¨èµ·æ¥ï¼Œæ…¢æ…¢è¿­ä»£</strong>ã€‚</p>
<p>ç¥ä½ æ—©æ—¥ç»„å»ºè‡ªå·±çš„AIå›¢é˜Ÿï¼</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘è‡ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.betterlink.top%2Fzh%2Fposts%2Fai%2F20251122-claude-subagent-guide%2F" target="_blank" title="https://blog.betterlink.top/zh/posts/ai/20251122-claude-subagent-guide/" ref="nofollow noopener noreferrer">ä¸ªäººåšå®¢</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Axios è¯·æ±‚å–æ¶ˆæœºåˆ¶è¯¦è§£]]></title>    <link>https://juejin.cn/post/7577042851080880171</link>    <guid>https://juejin.cn/post/7577042851080880171</guid>    <pubDate>2025-11-27T09:14:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577042851080880171" data-draft-id="7576994308274307091" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Axios è¯·æ±‚å–æ¶ˆæœºåˆ¶è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-11-27T09:14:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‹‰ä¸åŠ¨çš„çŒª"/> <meta itemprop="url" content="https://juejin.cn/user/1429793504759630"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Axios è¯·æ±‚å–æ¶ˆæœºåˆ¶è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1429793504759630/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‹‰ä¸åŠ¨çš„çŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-27T09:14:51.000Z" title="Thu Nov 27 2025 09:14:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    64
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Axiosæ˜¯å¦çœŸçš„æ”¯æŒå–æ¶ˆè¯·æ±‚å‘¢</h2>
<p>æ˜¯çš„ï¼Œ<strong>Axios å®Œå…¨æ”¯æŒå–æ¶ˆè¯·æ±‚</strong>ã€‚</p>
<p>Axios æä¾›äº†ä¸¤ç§ä¸»è¦çš„å–æ¶ˆè¯·æ±‚çš„æ–¹å¼ï¼š</p>
<ol>
<li><strong>ä½¿ç”¨Â <code>AbortController</code>Â (æ¨èï¼Œç°ä»£æµè§ˆå™¨å’Œ Node.js ç¯å¢ƒ)</strong></li>
<li><strong>ä½¿ç”¨Â <code>CancelToken</code>Â (æ—§ç‰ˆæ–¹å¼ï¼ŒAxios 0.22.0 ä¹‹å‰çš„ä¸»è¦æ–¹å¼ï¼Œç°åœ¨å·²åºŸå¼ƒä½†ä»å…¼å®¹)</strong></li>
</ol>
<hr/>
<h3 data-id="heading-1">1. ä½¿ç”¨Â <code>AbortController</code>Â (æ¨è)</h3>
<p><code>AbortController</code>Â æ˜¯ Web æ ‡å‡† APIï¼Œç”¨äºä¸­æ­¢ä¸€ä¸ªæˆ–å¤šä¸ª Web è¯·æ±‚ã€‚Axios ä» v0.22.0 å¼€å§‹æ”¯æŒå®ƒï¼Œå¹¶æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ã€‚</p>
<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ª AbortController å®ä¾‹</span>
<span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();
<span class="hljs-keyword">const</span> signal = controller.<span class="hljs-property">signal</span>; <span class="hljs-comment">// è·å– AbortSignal å¯¹è±¡</span>

<span class="hljs-comment">// 2. åœ¨ Axios è¯·æ±‚é…ç½®ä¸­ä¼ å…¥ signal</span>
axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/data'</span>, { signal })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚æˆåŠŸ:'</span>, response.<span class="hljs-property">data</span>);
  })
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
    <span class="hljs-comment">// æ£€æŸ¥é”™è¯¯æ˜¯å¦æ˜¯ç”±äºè¯·æ±‚å–æ¶ˆå¼•èµ·çš„</span>
    <span class="hljs-keyword">if</span> (axios.<span class="hljs-title function_">isCancel</span>(error)) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚è¢«å–æ¶ˆ:'</span>, error.<span class="hljs-property">message</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚å‘ç”Ÿé”™è¯¯:'</span>, error.<span class="hljs-property">message</span>);
    }
  });

<span class="hljs-comment">// 3. åœ¨éœ€è¦å–æ¶ˆè¯·æ±‚æ—¶è°ƒç”¨ controller.abort()</span>
<span class="hljs-comment">// ä¾‹å¦‚ï¼Œåœ¨ç»„ä»¶å¸è½½æ—¶ï¼Œæˆ–è€…ç”¨æˆ·ç‚¹å‡»äº†å–æ¶ˆæŒ‰é’®æ—¶</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  controller.<span class="hljs-title function_">abort</span>(); <span class="hljs-comment">// è¿™ä¼šè§¦å‘ signal ä¸Šçš„ abort äº‹ä»¶ï¼ŒAxios ä¼šæ•è·å¹¶å–æ¶ˆè¯·æ±‚</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚å·²å°è¯•å–æ¶ˆ'</span>);
}, <span class="hljs-number">100</span>); <span class="hljs-comment">// 100ms åå–æ¶ˆè¯·æ±‚</span>
</code></pre>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>æ˜¯ Web æ ‡å‡† APIï¼Œä¸ä»…é™äº Axiosï¼Œä¹Ÿå¯ä»¥ç”¨äºÂ <code>fetch</code>Â API æˆ–å…¶ä»–æ”¯æŒÂ <code>AbortSignal</code>Â çš„å¼‚æ­¥æ“ä½œã€‚</li>
<li>æ›´ç°ä»£ã€æ›´ç®€æ´çš„ API è®¾è®¡ã€‚</li>
<li>å¯ä»¥å–æ¶ˆå¤šä¸ªè¯·æ±‚ï¼ˆå°†åŒä¸€ä¸ªÂ <code>signal</code>Â ä¼ é€’ç»™å¤šä¸ªè¯·æ±‚ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-2">2. ä½¿ç”¨Â <code>CancelToken</code>Â (æ—§ç‰ˆï¼Œå·²åºŸå¼ƒä½†ä»å…¼å®¹)</h3>
<p><code>CancelToken</code>Â æ˜¯ Axios æ—©æœŸæä¾›çš„å–æ¶ˆè¯·æ±‚æœºåˆ¶ã€‚è™½ç„¶ç°åœ¨æ¨èä½¿ç”¨Â <code>AbortController</code>ï¼Œä½†å¦‚æœä½ åœ¨ä½¿ç”¨æ—§ç‰ˆæœ¬çš„ Axios æˆ–è€…éœ€è¦å…¼å®¹æ—§ä»£ç ï¼Œå®ƒä»ç„¶å¯ç”¨ã€‚</p>
<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ª CancelToken.Source å·¥å‚å‡½æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">CancelToken</span> = axios.<span class="hljs-property">CancelToken</span>;
<span class="hljs-keyword">const</span> source = <span class="hljs-title class_">CancelToken</span>.<span class="hljs-title function_">source</span>(); <span class="hljs-comment">// source å¯¹è±¡åŒ…å« token å’Œ cancel æ–¹æ³•</span>

<span class="hljs-comment">// 2. åœ¨ Axios è¯·æ±‚é…ç½®ä¸­ä¼ å…¥ token</span>
axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/data'</span>, { <span class="hljs-attr">cancelToken</span>: source.<span class="hljs-property">token</span> })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚æˆåŠŸ:'</span>, response.<span class="hljs-property">data</span>);
  })
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
    <span class="hljs-comment">// æ£€æŸ¥é”™è¯¯æ˜¯å¦æ˜¯ç”±äºè¯·æ±‚å–æ¶ˆå¼•èµ·çš„</span>
    <span class="hljs-keyword">if</span> (axios.<span class="hljs-title function_">isCancel</span>(error)) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚è¢«å–æ¶ˆ:'</span>, error.<span class="hljs-property">message</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚å‘ç”Ÿé”™è¯¯:'</span>, error.<span class="hljs-property">message</span>);
    }
  });

<span class="hljs-comment">// 3. åœ¨éœ€è¦å–æ¶ˆè¯·æ±‚æ—¶è°ƒç”¨ source.cancel()</span>
<span class="hljs-comment">// ä¾‹å¦‚ï¼Œåœ¨ç»„ä»¶å¸è½½æ—¶ï¼Œæˆ–è€…ç”¨æˆ·ç‚¹å‡»äº†å–æ¶ˆæŒ‰é’®æ—¶</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  source.<span class="hljs-title function_">cancel</span>(<span class="hljs-string">'ç”¨æˆ·å–æ¶ˆäº†è¯·æ±‚'</span>); <span class="hljs-comment">// ä¼ å…¥ä¸€ä¸ªå¯é€‰çš„æ¶ˆæ¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚å·²å°è¯•å–æ¶ˆ'</span>);
}, <span class="hljs-number">100</span>); <span class="hljs-comment">// 100ms åå–æ¶ˆè¯·æ±‚</span>
</code></pre>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>åœ¨æ—§ç‰ˆæœ¬ Axios ä¸­å¹¿æ³›ä½¿ç”¨ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>Axios ç‰¹æœ‰çš„ APIï¼Œä¸é€‚ç”¨äºå…¶ä»– Web APIã€‚</li>
<li>å·²è¢«Â <code>AbortController</code>Â æ›¿ä»£ï¼Œæœªæ¥å¯èƒ½ä¸å†ç»´æŠ¤æˆ–æ¨èã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-3">ä½•æ—¶éœ€è¦å–æ¶ˆè¯·æ±‚ï¼Ÿ</h3>
<p>å–æ¶ˆè¯·æ±‚åœ¨å‰ç«¯å¼€å‘ä¸­éå¸¸æœ‰ç”¨ï¼Œå¸¸è§åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ç»„ä»¶å¸è½½æ—¶</strong>ï¼šå½“ç”¨æˆ·åœ¨è¯·æ±‚å®Œæˆå‰åˆ‡æ¢é¡µé¢æˆ–ç»„ä»¶è¢«é”€æ¯æ—¶ï¼Œé¿å…å› è¯·æ±‚è¿”å›åå°è¯•æ›´æ–°å·²ä¸å­˜åœ¨çš„ç»„ä»¶çŠ¶æ€è€Œå¯¼è‡´çš„å†…å­˜æ³„æ¼æˆ–é”™è¯¯ã€‚</li>
<li><strong>ç”¨æˆ·æ“ä½œå–æ¶ˆ</strong>ï¼šä¾‹å¦‚ï¼Œç”¨æˆ·ç‚¹å‡»äº†â€œå–æ¶ˆä¸Šä¼ â€æŒ‰é’®ï¼Œæˆ–åœ¨æœç´¢æ¡†ä¸­å¿«é€Ÿè¾“å…¥æ—¶ï¼Œå–æ¶ˆä¹‹å‰çš„æ—§æœç´¢è¯·æ±‚ï¼Œåªä¿ç•™æœ€æ–°çš„è¯·æ±‚ã€‚</li>
<li><strong>é¿å…é‡å¤è¯·æ±‚</strong>ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸ºäº†é˜²æ­¢ç”¨æˆ·å¤šæ¬¡ç‚¹å‡»æˆ–å¿«é€Ÿè§¦å‘æŸä¸ªæ“ä½œå¯¼è‡´å‘é€å¤šä¸ªç›¸åŒçš„è¯·æ±‚ï¼Œå¯ä»¥åœ¨æ–°è¯·æ±‚å‘å‡ºå‰å–æ¶ˆæ—§è¯·æ±‚ã€‚</li>
</ol>
<p>æ€»ä¹‹ï¼ŒAxios æä¾›äº†å¼ºå¤§ä¸”çµæ´»çš„è¯·æ±‚å–æ¶ˆæœºåˆ¶ï¼Œæ¨èåœ¨ç°ä»£é¡¹ç›®ä¸­ä½¿ç”¨Â <code>AbortController</code>ã€‚</p>
<h2 data-id="heading-4">è¿™ç§å–æ¶ˆæ˜¯å‰ç«¯æ‹’ç»æ¥æ”¶æ•°æ®è¿˜æ˜¯çœŸçš„åœæ­¢httpçš„è¯·æ±‚é“¾æ¥å‘¢ï¼Ÿ</h2>
<h3 data-id="heading-5">1. å®ƒæ˜¯å¦‚ä½•â€œçœŸå–æ¶ˆâ€çš„ï¼Ÿï¼ˆæµè§ˆå™¨å±‚é¢ï¼‰</h3>
<p>å½“ä½ è°ƒç”¨Â <code>controller.abort()</code>ï¼ˆæˆ–æ—§ç‰ˆçš„Â <code>cancelToken</code>ï¼‰æ—¶ï¼ŒAxios ä¼šè°ƒç”¨æµè§ˆå™¨åº•å±‚çš„ APIï¼ˆ<code>XMLHttpRequest.abort()</code>Â æˆ–Â <code>fetch</code>Â çš„ signal æœºåˆ¶ï¼‰ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li><strong>ç½‘ç»œè¿æ¥è¢«åˆ‡æ–­</strong>ï¼šæµè§ˆå™¨ä¼šç«‹å³å…³é—­ä¸æœåŠ¡å™¨çš„ TCP è¿æ¥ã€‚</li>
<li><strong>åœæ­¢æ¥æ”¶æ•°æ®</strong>ï¼šå¦‚æœæœåŠ¡å™¨æ­£åœ¨å‘é€ä¸€ä¸ªå¾ˆå¤§çš„å“åº”ï¼ˆæ¯”å¦‚ä¸‹è½½ä¸€ä¸ª 100MB çš„æ–‡ä»¶ï¼‰ï¼Œæµè§ˆå™¨ä¼šç«‹åˆ»åœæ­¢ä¸‹è½½ï¼Œ<strong>èŠ‚çœå¸¦å®½</strong>ã€‚</li>
<li><strong>Promise ç«‹å³ Reject</strong>ï¼šAxios çš„ Promise ä¼šç«‹åˆ»æŠ›å‡ºä¸€ä¸ªÂ <code>CanceledError</code>ï¼Œä½ çš„ä»£ç ä¼šç«‹åˆ»è¿›å…¥Â <code>.catch()</code>ï¼Œè€Œä¸éœ€è¦ç­‰å¾…æœåŠ¡å™¨å“åº”è¶…æ—¶ã€‚</li>
</ul>
<p><strong>å¯¹æ¯”ï¼š</strong> Â å¦‚æœä»…ä»…æ˜¯â€œå‰ç«¯ä¸äºˆæ¥æ”¶â€ï¼Œæµè§ˆå™¨ä¼šå‚»å‚»åœ°æŠŠ 100MB ä¸‹è½½å®Œï¼Œç„¶åä½ çš„ä»£ç å†æŠŠæ•°æ®æ‰”æ‰ã€‚<strong>Axios çš„å–æ¶ˆæ˜¯å‰è€…ï¼Œç›´æ¥ææ–­è¿æ¥ï¼ŒèŠ‚çœèµ„æºã€‚</strong></p>
<hr/>
<h3 data-id="heading-6">2. æœåŠ¡å™¨ç«¯å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿï¼ˆåç«¯å±‚é¢ï¼‰</h3>
<p>è¿™æ˜¯æœ€å®¹æ˜“äº§ç”Ÿè¯¯è§£çš„åœ°æ–¹ã€‚ <strong>â€œå‰ç«¯å–æ¶ˆäº†è¯·æ±‚â€å¹¶ä¸ä»£è¡¨â€œåç«¯æ’¤é”€äº†æ“ä½œâ€ã€‚</strong></p>
<ul>
<li>
<p><strong>è¯·æ±‚å·²å‘å‡º</strong>ï¼šåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå½“ä½ ç‚¹å‡»å–æ¶ˆæ—¶ï¼Œè¯·æ±‚æŒ‡ä»¤å·²ç»é€šè¿‡ç½‘ç»œå‘é€åˆ°äº†æœåŠ¡å™¨ã€‚</p>
</li>
<li>
<p><strong>æœåŠ¡å™¨æ­£åœ¨å¤„ç†</strong>ï¼šæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œå¼€å§‹æŸ¥è¯¢æ•°æ®åº“ã€è®¡ç®—æ•°æ®æˆ–å†™å…¥è®°å½•ã€‚</p>
</li>
<li>
<p><strong>è¿æ¥ä¸­æ–­</strong>ï¼šæ­¤æ—¶å‰ç«¯æ–­å¼€äº†è¿æ¥ã€‚</p>
<ul>
<li><strong>å¤§å¤šæ•°åç«¯æ¡†æ¶ï¼ˆå¦‚ Java Spring, Node Express, Python Flaskï¼‰</strong> ï¼šé€šå¸¸<strong>ä¸ä¼š</strong>è‡ªåŠ¨æ£€æµ‹è¿æ¥æ–­å¼€è€Œåœæ­¢ä¸šåŠ¡é€»è¾‘ã€‚å®ƒä»¬ä¼šç»§ç»­æŠŠæ´»å¹²å®Œï¼ˆæ¯”å¦‚æŠŠæ•°æ®å†™è¿›æ•°æ®åº“ï¼‰ï¼Œç„¶åè¯•å›¾æŠŠç»“æœè¿”å›ç»™å‰ç«¯ã€‚</li>
<li><strong>ç»“æœ</strong>ï¼šå½“æœåŠ¡å™¨è¯•å›¾è¿”å›ç»“æœæ—¶ï¼Œå‘ç°è¿æ¥å·²ç»æ²¡äº†ï¼ŒæœåŠ¡å™¨ä¼šæŠ¥é”™ï¼ˆå¦‚Â <code>Broken pipe</code>ï¼‰ï¼Œä½†ä¹‹å‰çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚å†™åº“ï¼‰å¯èƒ½å·²ç»æ‰§è¡Œäº†ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong><br/>
ä½ åœ¨é¤å…ç‚¹äº†ä¸€é“èœï¼ˆ<strong>å‘é€è¯·æ±‚</strong>ï¼‰ã€‚<br/>
å¨å¸ˆå¼€å§‹åšèœï¼ˆ<strong>æœåŠ¡å™¨å¤„ç†</strong>ï¼‰ã€‚<br/>
ä½ çªç„¶æœ‰æ€¥äº‹èµ°äº†ï¼Œè·ŸæœåŠ¡å‘˜è¯´â€œæˆ‘ä¸è¦äº†â€ï¼ˆ<strong>å‰ç«¯å–æ¶ˆè¯·æ±‚</strong>ï¼‰ã€‚</p>
<ul>
<li><strong>å‰ç«¯è§†è§’</strong>ï¼šä½ èµ°äº†ï¼Œæ²¡åƒåˆ°èœï¼Œä¹Ÿæ²¡ä»˜é’±ï¼ˆèŠ‚çœäº†æ—¶é—´å’Œèµ„æºï¼‰ã€‚</li>
<li><strong>åç«¯è§†è§’</strong>ï¼šå¨å¸ˆå¯èƒ½å·²ç»æŠŠèœåšå¥½äº†ï¼Œå‘ç°æ²¡äººåƒï¼Œåªèƒ½å€’æ‰ã€‚<strong>ä½†èœç¡®å®è¢«åšå‡ºæ¥äº†ï¼ˆå‰¯ä½œç”¨å·²äº§ç”Ÿï¼‰ã€‚</strong></li>
</ul>
<hr/>
<h3 data-id="heading-7">3. æ€»ç»“ï¼šä¸‰ç§æƒ…å†µ</h3>
<p>æ ¹æ®å–æ¶ˆçš„æ—¶æœºä¸åŒï¼Œæ•ˆæœä¹Ÿä¸åŒï¼š</p>
<ol>
<li>
<p><strong>è¯·æ±‚è¿˜åœ¨æ’é˜Ÿï¼ˆæå°‘è§ï¼‰</strong> ï¼š</p>
<ul>
<li>æµè§ˆå™¨è¿˜æ²¡æ¥å¾—åŠæŠŠè¯·æ±‚å‘å‡ºå»ä½ å°±å–æ¶ˆäº†ã€‚</li>
<li><strong>ç»“æœ</strong>ï¼šæœåŠ¡å™¨å®Œå…¨ä¸çŸ¥é“æœ‰è¿™å›äº‹ï¼Œè¿™æ˜¯æœ€å½»åº•çš„å–æ¶ˆã€‚</li>
</ul>
</li>
<li>
<p><strong>è¯·æ±‚åœ¨ä¼ è¾“ä¸­/æœåŠ¡å™¨å¤„ç†ä¸­ï¼ˆæœ€å¸¸è§ï¼‰</strong> ï¼š</p>
<ul>
<li>è¯·æ±‚å·²å‘ï¼ŒæœåŠ¡å™¨æ­£åœ¨ç®—ï¼Œå‰ç«¯å–æ¶ˆã€‚</li>
<li><strong>ç»“æœ</strong>ï¼šå‰ç«¯æ–­å¼€è¿æ¥ï¼Œä¸å†ç­‰å¾…ã€‚æœåŠ¡å™¨å¯èƒ½è¿˜æ˜¯ä¼šæŠŠæ´»å¹²å®Œï¼Œä½†å‘ä¸å›æ¥ã€‚<strong>è¿™å¯¹å‰ç«¯æ¥è¯´æ˜¯çœŸå–æ¶ˆï¼ˆä¸å¡ç•Œé¢ã€ä¸è´¹æµé‡ï¼‰ï¼Œå¯¹åç«¯æ¥è¯´é€šå¸¸æ— æ³•æ’¤é”€å‰¯ä½œç”¨ã€‚</strong></li>
</ul>
</li>
<li>
<p><strong>å“åº”å·²åˆ°è¾¾æµè§ˆå™¨</strong>ï¼š</p>
<ul>
<li>æœåŠ¡å™¨æ•°æ®å·²ç»å‘å›æ¥äº†ï¼Œæµè§ˆå™¨åˆšæ”¶åˆ°ï¼Œä½ æ­£å¥½ç‚¹äº†å–æ¶ˆã€‚</li>
<li><strong>ç»“æœ</strong>ï¼šè¿™æ—¶å€™å…¶å®å·²ç»æ™šäº†ï¼ŒAxios åªæ˜¯æŠ›ä¸ªé”™è®©ä½ å¿½ç•¥ç»“æœã€‚è¿™å°±å˜æˆäº†ä½ è¯´çš„â€œå‰ç«¯ä¸äºˆæ¥æ”¶â€ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-8">æ ¸å¿ƒå»ºè®®</h3>
<ul>
<li><strong>ç”¨äºä¼˜åŒ–ä½“éªŒ</strong>ï¼šAxios çš„å–æ¶ˆéå¸¸é€‚åˆç”¨äº<strong>æœç´¢æ¡†è”æƒ³</strong>ï¼ˆè¾“å…¥Â <code>a</code>Â å‘è¯·æ±‚ï¼Œç´§æ¥ç€è¾“å…¥Â <code>ab</code>ï¼Œæ­¤æ—¶å–æ¶ˆÂ <code>a</code>Â çš„è¯·æ±‚ï¼‰æˆ–<strong>åˆ‡æ¢ Tab</strong>ã€‚è¿™èƒ½æœ‰æ•ˆé˜²æ­¢â€œæ—§æ•°æ®çš„å“åº”è¦†ç›–äº†æ–°æ•°æ®â€çš„ Bugï¼Œå¹¶èŠ‚çœå¸¦å®½ã€‚</li>
<li><strong>ä¸è¦ä¾èµ–å®ƒæ¥å›æ»šæ•°æ®</strong>ï¼šå¦‚æœä½ å‘çš„æ˜¯Â <code>POST</code>Â è¯·æ±‚ï¼ˆæ¯”å¦‚â€œä»˜æ¬¾â€ï¼‰ï¼Œåƒä¸‡ä¸è¦æŒ‡æœ›å‰ç«¯å–æ¶ˆå°±èƒ½é˜»æ­¢æœåŠ¡å™¨æ‰£æ¬¾ã€‚åç«¯å¿…é¡»è¦æœ‰å¹‚ç­‰æ€§è®¾è®¡æˆ–ä¸“é—¨çš„æ’¤é”€æ¥å£ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Rediså®æˆ˜ï¼š5ä¸ªé«˜é¢‘åº”ç”¨åœºæ™¯ä¸‹çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼Œè®©ä½ çš„QPSæå‡50%]]></title>    <link>https://juejin.cn/post/7576936862632607744</link>    <guid>https://juejin.cn/post/7576936862632607744</guid>    <pubDate>2025-11-27T04:16:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7576936862632607744" data-draft-id="7576928310788571188" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Rediså®æˆ˜ï¼š5ä¸ªé«˜é¢‘åº”ç”¨åœºæ™¯ä¸‹çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼Œè®©ä½ çš„QPSæå‡50%"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-27T04:16:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Rediså®æˆ˜ï¼š5ä¸ªé«˜é¢‘åº”ç”¨åœºæ™¯ä¸‹çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼Œè®©ä½ çš„QPSæå‡50%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-27T04:16:41.000Z" title="Thu Nov 27 2025 04:16:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    34
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Rediså®æˆ˜ï¼š5ä¸ªé«˜é¢‘åº”ç”¨åœºæ™¯ä¸‹çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼Œè®©ä½ çš„QPSæå‡50%</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>Redisä½œä¸ºé«˜æ€§èƒ½çš„å†…å­˜æ•°æ®åº“ï¼Œåœ¨ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ã€‚æ— è®ºæ˜¯ç¼“å­˜åŠ é€Ÿã€ä¼šè¯ç®¡ç†è¿˜æ˜¯å®æ—¶æ’è¡Œæ¦œï¼ŒRediséƒ½èƒ½æ˜¾è‘—æå‡ç³»ç»Ÿæ€§èƒ½ã€‚ç„¶è€Œï¼Œéšç€ä¸šåŠ¡è§„æ¨¡çš„å¢é•¿å’Œæµé‡å³°å€¼çš„å‡ºç°ï¼Œå¦‚ä½•å……åˆ†æŒ–æ˜Redisçš„æ½œåŠ›æˆä¸ºå¼€å‘è€…é¢ä¸´çš„å…³é”®æŒ‘æˆ˜ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥åˆ†æRedisåœ¨äº”ç§å…¸å‹åº”ç”¨åœºæ™¯ä¸­çš„æ€§èƒ½ç“¶é¢ˆï¼Œå¹¶æä¾›ç»è¿‡ç”Ÿäº§éªŒè¯çš„ä¼˜åŒ–æŠ€å·§ã€‚è¿™äº›æ–¹æ³•ä¸ä»…æ¥è‡ªå®˜æ–¹æ–‡æ¡£çš„æœ€ä½³å®è·µï¼Œæ›´ç»“åˆäº†ç¬”è€…åœ¨å¤§å‹äº’è”ç½‘å…¬å¸å¤„ç†é«˜å¹¶å‘åœºæ™¯çš„ä¸€çº¿ç»éªŒã€‚é€šè¿‡åˆç†é…ç½®å’Œé’ˆå¯¹æ€§ä¼˜åŒ–ï¼Œä½ çš„Rediså®ä¾‹QPSï¼ˆQueries Per Secondï¼‰æœ‰æœ›æå‡50%ç”šè‡³æ›´é«˜ã€‚</p>
<h2 data-id="heading-2">ä¸€ã€çƒ­ç‚¹æ•°æ®ç¼“å­˜ä¼˜åŒ–</h2>
<h3 data-id="heading-3">1.1 é—®é¢˜è¯Šæ–­</h3>
<p>çƒ­ç‚¹Keyé—®é¢˜æ˜¯ç¼“å­˜åœºæ™¯ä¸­æœ€å¸¸è§çš„æ€§èƒ½æ€æ‰‹ã€‚å½“æŸä¸ªKeyçš„è®¿é—®é‡è¿œè¶…å…¶ä»–Keyæ—¶ï¼ˆå¦‚ç”µå•†ç§’æ€å•†å“ï¼‰ï¼Œä¼šå¯¼è‡´ï¼š</p>
<ul>
<li>å•ä¸ªRediså®ä¾‹CPUé£™é«˜</li>
<li>é›†ç¾¤æ¨¡å¼ä¸‹æ•°æ®å€¾æ–œ</li>
<li>ç½‘ç»œå¸¦å®½æˆä¸ºç“¶é¢ˆ</li>
</ul>
<h3 data-id="heading-4">1.2 ä¼˜åŒ–æ–¹æ¡ˆ</h3>
<p><strong>å¤šçº§ç¼“å­˜æ¶æ„ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ªä»£ç ç¤ºä¾‹ï¼šæœ¬åœ°ç¼“å­˜+Redisä¸¤çº§ç¼“å­˜</span>
<span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getData</span><span class="hljs-params">(String key)</span> {
    <span class="hljs-comment">// 1.æ£€æŸ¥æœ¬åœ°ç¼“å­˜</span>
    <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> localCache.get(key);
    <span class="hljs-keyword">if</span> (value != <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> value;
    
    <span class="hljs-comment">// 2.æ£€æŸ¥Redisç¼“å­˜</span>
    value = redis.get(key);
    <span class="hljs-keyword">if</span> (value != <span class="hljs-literal">null</span>) {
        localCache.put(key, value); <span class="hljs-comment">// å›å¡«æœ¬åœ°ç¼“å­˜</span>
        <span class="hljs-keyword">return</span> value;
    }
    
    <span class="hljs-comment">// 3.å›æºæ•°æ®åº“...</span>
}
</code></pre>
<p><strong>Keyæ‹†åˆ†æŠ€æœ¯ï¼š</strong></p>
<ul>
<li>å°†å¤§Valueæ‹†åˆ†ä¸ºå¤šä¸ªå­Keyï¼ˆå¦‚<code>product:123 -&gt; product:123:base + product:123:detail</code>ï¼‰</li>
<li>ä½¿ç”¨Hashåˆ†ç‰‡å­˜å‚¨ï¼ˆHSET product:123_detail field1 value1 field2 value2ï¼‰</li>
</ul>
<p><strong>å®æˆ˜æŠ€å·§ï¼š</strong></p>
<ol>
<li>Redisç›‘æ§å‘ç°çƒ­ç‚¹Keyï¼ˆä½¿ç”¨<code>redis-cli --hotkeys</code>ï¼‰</li>
<li>LRUç­–ç•¥è°ƒæ•´ä¸ºvolatile-lrué¿å…å…¨é‡æ·˜æ±°</li>
<li>Pipelineæ‰¹é‡è·å–æ‹†åˆ†åçš„å­Key</li>
</ol>
<h2 data-id="heading-5">äºŒã€åˆ†å¸ƒå¼é”çš„æ€§èƒ½é™·é˜±ä¸çªç ´</h2>
<h3 data-id="heading-6">2.1 Redlockçš„ä»£ä»·</h3>
<p>ä¼ ç»ŸRedlockç®—æ³•éœ€è¦ä¸åŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹é€šä¿¡ï¼Œåœ¨é«˜å¹¶å‘ä¸‹ï¼š</p>
<ul>
<li>TPSä»10ä¸‡+éª¤é™åˆ°ä¸è¶³1ä¸‡</li>
<li>GCå‹åŠ›å‰§å¢å¯¼è‡´STWé—®é¢˜</li>
</ul>
<h3 data-id="heading-7">2.2 CASä¹è§‚é”æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- Luaè„šæœ¬ä¿è¯åŸå­æ€§</span>
<span class="hljs-keyword">local</span> current = redis.call(<span class="hljs-string">'GET'</span>, KEYS[<span class="hljs-number">1</span>])
<span class="hljs-keyword">if</span> current == ARGV[<span class="hljs-number">1</span>] <span class="hljs-keyword">then</span>
    <span class="hljs-keyword">return</span> redis.call(<span class="hljs-string">'SET'</span>, KEYS[<span class="hljs-number">1</span>], ARGV[<span class="hljs-number">2</span>])
<span class="hljs-keyword">end</span>
<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
</code></pre>
<h3 data-id="heading-8">2.3 Leaseæœºåˆ¶ä¼˜åŒ–ç‰ˆé”</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">acquire_lock_with_lease</span>(<span class="hljs-params">conn, lockname, lease_time=<span class="hljs-number">10</span></span>):
    identifier = <span class="hljs-built_in">str</span>(uuid.uuid4())
    end = time.time() + lease_time
    
    <span class="hljs-keyword">while</span> time.time() &lt; end:
        <span class="hljs-keyword">if</span> conn.setnx(lockname, identifier): 
            conn.expire(lockname, lease_time)
            <span class="hljs-keyword">return</span> identifier
        
        <span class="hljs-comment"># Leaseç»­æœŸé€»è¾‘çœç•¥...</span>
        
    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</code></pre>
<p><strong>å…³é”®æ”¹è¿›ç‚¹ï¼š</strong></p>
<ul>
<li>Leaseæ—¶é—´ä»å›ºå®šå€¼æ”¹ä¸ºåŠ¨æ€è®¡ç®—ï¼ˆæ ¹æ®å†å²æ‰§è¡Œæ—¶é—´P99å€¼ï¼‰</li>
<li>Watch Dogå¼‚æ­¥ç»­çº¦é¿å…å®¢æˆ·ç«¯é˜»å¡</li>
</ul>
<h2 data-id="heading-9">ä¸‰ã€æ’è¡Œæ¦œåœºæ™¯çš„æè‡´ä¼˜åŒ–</h2>
<h3 data-id="heading-10">3.1 ZSETçš„å†…å­˜æ¶ˆè€—åˆ†æ</h3>
<p>å­˜å‚¨100ä¸‡æˆå‘˜çš„æ’è¡Œæ¦œï¼š</p>
<ul>
<li>RedisåŸç”ŸZSETçº¦æ¶ˆè€—64MBå†…å­˜ï¼ˆæ¯ä¸ªentryå¹³å‡64å­—èŠ‚ï¼‰</li>
<li>Scoreä½¿ç”¨doubleç±»å‹å­˜åœ¨ç²¾åº¦æµªè´¹</li>
</ul>
<h3 data-id="heading-11">3.2 Compact Storageæ¨¡å¼è®¾è®¡</h3>
<pre><code class="hljs language-vbnet" lang="vbnet"># <span class="hljs-keyword">Key</span>è®¾è®¡æ”¹é€ å‰ï¼š
<span class="hljs-symbol">user:</span>score -&gt; ZSET {userid1:score1, userid2:score2,...}

# <span class="hljs-keyword">Key</span>è®¾è®¡æ”¹é€ åï¼š
<span class="hljs-symbol">user:</span>vscore -&gt; <span class="hljs-type">STRING</span> (ç´§å‡‘äºŒè¿›åˆ¶å­˜å‚¨)
<span class="hljs-symbol">user:</span>rank -&gt; ZSET {userid1:vscore_offset,...}
</code></pre>
<p><strong>æ•ˆæœå¯¹æ¯”ï¼š</strong></p>




















<table><thead><tr><th>Metric</th><th>Before</th><th>After</th></tr></thead><tbody><tr><td>Memory</td><td>~64MB</td><td>~24MB</td></tr><tr><td>ZADD QPS</td><td>~12k</td><td>~35k</td></tr></tbody></table>
<p>##å››ã€æ¶ˆæ¯é˜Ÿåˆ—çš„åœºæ™¯åŒ–è°ƒä¼˜</p>
<p>###4.1 List vs Streamçš„é€‰æ‹©çŸ©é˜µ</p>















<table><thead><tr><th/><th>List</th><th>Stream</th></tr></thead><tbody><tr><td>æ¶ˆè´¹ç¡®è®¤</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr></tbody></table>
<blockquote>
<p>æ³¨æ„è¡¨æ ¼å¯¹é½æ–¹å¼å¯èƒ½éœ€è¦è°ƒæ•´æ˜¾ç¤ºæ•ˆæœ</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» RAG åˆ° KAG ï¼šç»“æ„åŒ–æ€è€ƒèŒƒå¼ä¸‹çš„å¤æ‚æ¨ç†]]></title>    <link>https://juejin.cn/post/7577321767346995246</link>    <guid>https://juejin.cn/post/7577321767346995246</guid>    <pubDate>2025-11-28T06:14:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577321767346995246" data-draft-id="7577430671946596378" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» RAG åˆ° KAG ï¼šç»“æ„åŒ–æ€è€ƒèŒƒå¼ä¸‹çš„å¤æ‚æ¨ç†"/> <meta itemprop="keywords" content="LLM"/> <meta itemprop="datePublished" content="2025-11-28T06:14:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è…¾è®¯äº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3456520257538830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» RAG åˆ° KAG ï¼šç»“æ„åŒ–æ€è€ƒèŒƒå¼ä¸‹çš„å¤æ‚æ¨ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520257538830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è…¾è®¯äº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:14:40.000Z" title="Fri Nov 28 2025 06:14:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»26åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å¯¼è¯­ |</strong> éšç€äººå·¥æ™ºèƒ½æŠ€æœ¯çš„è¿…é€Ÿå‘å±•ï¼ŒåŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„åº”ç”¨é€æ¸æˆä¸ºä¸»æµã€‚ç„¶è€Œï¼Œè¿™äº›å¤§æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­ä»åƒåœ¨â€œé—­å·è€ƒè¯•â€ï¼Œä¸€æ—¦é¢˜ç›®è¶…çº²ä¾¿åªèƒ½å‡­ç©ºç¼–é€ ï¼Œå³ä¾¿åæ¥å¼•å…¥ RAG è®©å…¶â€œå¼€å·â€ï¼Œä¹Ÿå¸¸å› ç¿»ä¸åˆ°æ­£ç¡®çš„é¡µç è€Œç­”éæ‰€é—®ã€‚å°¤å…¶åœ¨å‚ç›´é¢†åŸŸçš„åº”ç”¨ä¸­ï¼Œå•çº¯ä¾é å¤§æ¨¡å‹å¾€å¾€æ— æ³•æ»¡è¶³å¤æ‚ä¸šåŠ¡å¯¹ç²¾å‡†é—®ç­”ã€å®æ—¶çŸ¥è¯†æ›´æ–°å’Œæ¨ç†æ·±åº¦çš„éœ€æ±‚ã€‚å› æ­¤ï¼ŒæŠ€æœ¯æ­£ä» RAG (Retrieval Augmented Generation, æ£€ç´¢å¢å¼ºç”Ÿæˆ) èµ°å‘ KAG (Knowledge Augmented Generationï¼ŒçŸ¥è¯†å¢å¼ºç”Ÿæˆæ¡†æ¶) ï¼šé€šè¿‡æ•´åˆçŸ¥è¯†åº“ä¸ç»“æ„åŒ–æ¨ç†ï¼Œè®©â€œå¼€å·â€ä¸ä»…ç¿»å¾—åˆ°é¡µï¼Œè¿˜èƒ½æŒ‰é€»è¾‘åˆ’é‡ç‚¹ã€‚æœ¬æ–‡ç‰¹é‚€<strong>åŒæµå¤§å­¦ç‰¹è˜ç ”ç©¶å‘˜ã€åšå¯¼ã€è…¾è®¯äº‘ TVP ç‹æ˜Šå¥‹</strong>é‡ç‚¹æ¢è®¨ä» RAG åˆ° KAG çš„æŠ€æœ¯æ¼”è¿›è¿‡ç¨‹ï¼Œå¹¶åˆ†æ KAG æ¡†æ¶å¦‚ä½•æœ‰æ•ˆè§£å†³ä¼ ç»Ÿ RAG æ¨¡å‹çš„ä¸è¶³ï¼Œä¸ºå‚ç›´é¢†åŸŸåº”ç”¨æä¾›æ›´åŠ ç²¾å‡†å’Œé«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0"><strong>ä½œè€…ç®€ä»‹</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95b1f219a9504dffa4496acb800f2951~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=gTZEB56dkLygaj0dtpnWxKgczKI%3D" alt="" loading="lazy"/></p>
<p>ç‹æ˜Šå¥‹ï¼ŒåŒæµå¤§å­¦ç‰¹è˜ç ”ç©¶å‘˜ã€åšå¯¼ã€è…¾è®¯äº‘ TVPã€‚ç ”ç©¶æ–¹å‘åŒ…æ‹¬çŸ¥è¯†å›¾è°±ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€å¯¹è¯æœºå™¨äººç­‰ã€‚é•¿æœŸåœ¨ä¸€çº¿äººå·¥æ™ºèƒ½å…¬å¸æ‹…ä»» CTO ä¹‹èŒã€‚æ˜¯å…¨çƒæœ€å¤§çš„ä¸­æ–‡å¼€æ”¾çŸ¥è¯†å›¾è°±è”ç›Ÿ OpenKG å‘èµ·äººä¹‹ä¸€ã€‚è´Ÿè´£ä¸»æŒå¤šé¡¹å›½å®¶çº§å’Œä¸Šæµ·å¸‚ AI ç›¸å…³é¡¹ç›®ï¼Œå‘è¡¨ 100 ä½™ç¯‡ AI é¢†åŸŸé«˜æ°´å¹³è®ºæ–‡ï¼Œè°·æ­Œå­¦æœ¯å¼•ç”¨ 7550 ä½™æ¬¡ï¼ŒH-index è¾¾åˆ° 31ã€‚æ„å»ºäº†å…¨çƒé¦–ä¸ªå¯äº¤äº’å…»æˆçš„è™šæ‹Ÿå¶åƒâ€”â€œç¥ç€Â·è™šé¢œâ€ï¼›æ‰€æ„å»ºçš„æ™ºèƒ½å®¢æœæœºå™¨äººå·²ç´¯è®¡æœåŠ¡ç”¨æˆ·è¶…è¿‡ 10 äº¿äººæ¬¡ã€‚ç›®å‰æ‹…ä»»ä¸­å›½è®¡ç®—æœºå­¦ä¼šæœ¯è¯­å·¥å§”å‰¯ä¸»ä»»ï¼ŒSIGKG ä¸»å¸­ï¼Œä¸Šæµ·ç§˜ä¹¦é•¿ï¼Œä¸­å›½ä¸­æ–‡ä¿¡æ¯å­¦ä¼šç†äº‹ï¼Œè¯­è¨€ä¸çŸ¥è¯†è®¡ç®—ä¸“å§”ä¼šå‰¯ç§˜ä¹¦é•¿ï¼Œä¸Šæµ·å¸‚è®¡ç®—æœºå­¦ä¼šè‡ªç„¶è¯­è¨€å¤„ç†ä¸“å§”ä¼šå‰¯ä¸»ä»»ï¼Œä¸Šæµ·äº¤é€šå¤§å­¦ AI æ ¡å‹ä¼šç§˜ä¹¦é•¿ç­‰ç¤¾ä¼šèŒä½ã€‚</p>
<h2 data-id="heading-1"><strong>ä¸€ã€ä»â€œé—­å·â€åˆ°â€œå¼€å·â€ï¼šå¤§æ¨¡å‹èƒ½åŠ›çš„è½¬å˜</strong></h2>
<p>åœ¨å¤§æ¨¡å‹çš„å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸ä¾èµ–äºä¸¤ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼šä¸€æ˜¯è”ç½‘æœç´¢ï¼ŒäºŒæ˜¯æ·±åº¦æ€è€ƒã€‚è¿™ä¸¤è€…åœ¨æŠ€æœ¯é€»è¾‘ä¸Šäº’ä¸ºè¡¥å……ï¼šæœç´¢åŠŸèƒ½èƒ½å¤Ÿæä¾›å®æ—¶çš„çŸ¥è¯†æ›´æ–°ï¼Œè€Œæ€è€ƒåŠŸèƒ½åˆ™ç¡®ä¿äº†é€»è¾‘çš„ä¸¥è°¨æ€§ã€‚ç„¶è€Œï¼Œå½“å¤§æ¨¡å‹åº”ç”¨äºå‚ç›´é¢†åŸŸæ—¶ï¼Œå¸¸å¸¸é¢ä¸´ä»¥ä¸‹äº”å¤§ç—›ç‚¹ï¼š</p>
<ul>
<li>
<p>å¹»è§‰ç”Ÿæˆï¼šæ¨¡å‹å› å‚æ•°åŒ–çŸ¥è¯†ä¸è¶³è€Œç¼–é€ è™šå‡ä¿¡æ¯ï¼›</p>
</li>
<li>
<p>çŸ¥è¯†æ»åï¼šé¢„è®­ç»ƒæ•°æ®æ— æ³•è¦†ç›–æœ€æ–°æ”¿ç­–ã€å¸‚åœºåŠ¨æ€ï¼›</p>
</li>
<li>
<p>æ•ˆç‡ç“¶é¢ˆï¼šå¤æ‚é—®é¢˜éœ€è¦å¤šè½®æ£€ç´¢ä¸æ¨ç†ï¼Œå“åº”æ—¶é—´è¿‡é•¿ï¼›</p>
</li>
<li>
<p>é¢†åŸŸé€‚é…éš¾ï¼šè¡Œä¸šæœ¯è¯­ã€è§„åˆ™ä½“ç³»ä¸é€šç”¨æ¨¡å‹å­˜åœ¨è¯­ä¹‰æ–­å±‚ï¼›</p>
</li>
<li>
<p>æ¨ç†è„†å¼±æ€§ï¼šå¤šæ­¥æ¨ç†ä¸­æ˜“å› çŸ¥è¯†ç¼ºå¤±æˆ–é€»è¾‘æ–­ç‚¹å¯¼è‡´ç»“æœåå·®ã€‚</p>
</li>
</ul>
<p>è¿™äº›ç—›ç‚¹çš„æ ¹æœ¬åŸå› åœ¨äºï¼Œæ¨¡å‹ä»â€œé—­å·è€ƒè¯•â€ï¼ˆä¾èµ–å†…åœ¨çŸ¥è¯†ï¼‰å‘â€œå¼€å·è€ƒè¯•â€ï¼ˆå€ŸåŠ©å¤–éƒ¨ä¿¡æ¯ï¼‰è½¬å‹æ—¶ï¼Œèƒ½åŠ›å‡ºç°äº†æ–­å±‚ã€‚æ— è®ºæ˜¯åœ¨æœç´¢ã€æ¨èã€é—®ç­”è¿˜æ˜¯å¯¹è¯ç­‰åœºæ™¯ä¸­ï¼Œæ ¸å¿ƒéœ€æ±‚å¯ä»¥å½’çº³ä¸ºä¸¤ç‚¹ï¼šé¦–å…ˆæ˜¯è¾“å‡ºç²¾å‡†å¯é ï¼Œå…¶æ¬¡æ˜¯èƒ½å¤Ÿä¸å†…éƒ¨å¤§æ•°æ®ç³»ç»Ÿè¿›è¡Œæ·±åº¦å¯¹æ¥ã€‚ç”¨æˆ·ä¹ æƒ¯ä½¿ç”¨ AI æœç´¢ä¹Ÿåæ˜ äº†è¿™ä¸€éœ€æ±‚ï¼šè™½ç„¶ AI æœç´¢å¼•ç”¨çš„æ¥æºå¯èƒ½å­˜åœ¨è™šå‡ä¿¡æ¯ï¼Œä½†å…¶æä¾›çš„â€œè¯æ®é“¾â€èƒ½å¤Ÿå¢å¼ºç”¨æˆ·çš„ä¿¡ä»»æ„Ÿã€‚åŒæ—¶ï¼Œç”¨æˆ·è¿˜å¸Œæœ›æŠ€æœ¯æˆæœ¬å¯æ§ï¼Œå¹¶ç¡®ä¿æ•°æ®çš„å®‰å…¨æ€§ä¸éšç§ä¿æŠ¤ã€‚</p>
<p>ä¸ºåº”å¯¹è¿™äº›æŒ‘æˆ˜ï¼Œç›®å‰çš„æŠ€æœ¯æ¢ç´¢è¶‹å‘äºé€šè¿‡å¤–æŒ‚çŸ¥è¯†åº“ï¼ˆå¦‚ RAGï¼‰æ¥å¼¥è¡¥å¤§æ¨¡å‹æœ¬èº«çš„ä¸è¶³ã€‚å°½ç®¡ RAG æŠ€æœ¯å·²ä»æœ€åˆçš„åŸºç¡€ RAG å‘å±•åˆ°å…·å¤‡è‡ªä¸»å†³ç­–èƒ½åŠ›çš„ Agentic RAGï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ä»ç„¶é¢ä¸´æŒ‘æˆ˜ã€‚å³ä¾¿å¼•å…¥äº† RAGï¼Œå½“å¤§æ¨¡å‹é‡åˆ°é¢„è®­ç»ƒæ•°æ®æœªè¦†ç›–çš„æœ€æ–°æˆ–ç‰¹å®šé¢†åŸŸé—®é¢˜æ—¶ï¼ˆä¾‹å¦‚æ”¿ç­–æ³•è§„ä¸­çš„â€œå…³ç¨â€ç»†èŠ‚ï¼Œè§ä¸‹å›¾ï¼‰ï¼Œå…¶è¡¨ç°ä¾æ—§å¯èƒ½æ— æ³•ä»¤äººæ»¡æ„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f5fced1c0cd456c9fd492fa4855a77e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=aC%2FlW5UnwkGpjb%2Fso4ClFzgm%2FbQ%3D" alt="" loading="lazy"/></p>
<p>å…³ç¨é—®é¢˜ç¤ºä¾‹ï¼šNaive RAG æ¨¡å‹</p>
<p>åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥æç‚¼å‡ºä¸€ä¸ªåŸºæœ¬æ¡†æ¶ï¼šé€šè¿‡ä¸ºå¤§æ¨¡å‹æä¾›å¤§é‡é¢å¤–çš„ç›¸å…³çŸ¥è¯†ï¼Œä½¿å…¶èƒ½åŠ›ä»ä¾èµ–æœ‰é™å†…åœ¨çŸ¥è¯†çš„â€œé—­å·è€ƒè¯•â€æ¨¡å¼ï¼Œè½¬å˜ä¸ºèƒ½å¤Ÿå‚è€ƒå¤–éƒ¨ä¿¡æ¯çš„â€œå¼€å·è€ƒè¯•â€æ¨¡å¼ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œè§£è¯»ç‰¹å®šé—®é¢˜æ—¶ï¼Œå¯ä»¥æä¾›è¯¦å°½çš„å…³ç¨ç»†åˆ™ã€é€‚ç”¨æ¡æ¬¾å’Œè±å…æƒ…å†µç­‰è¯¦ç»†ä¿¡æ¯ï¼Œå¸®åŠ©æ¨¡å‹æ›´å‡†ç¡®åœ°è¿›è¡Œåˆ¤æ–­å’Œæ¨ç†ã€‚</p>
<p>è¿™ä¸€è½¬å˜çš„å…³é”®åœ¨äºèµ‹äºˆæ¨¡å‹æ·±åº¦é˜…è¯»ç†è§£çš„èƒ½åŠ›ã€‚é€šè¿‡å¼•å…¥å¤–éƒ¨çŸ¥è¯†åº“ï¼Œæ¨¡å‹ä¸ä»…å¯ä»¥è·å–æ›´å¤šçš„èƒŒæ™¯ä¿¡æ¯ï¼Œè¿˜èƒ½åœ¨ç”Ÿæˆå›ç­”æ—¶ï¼Œä¾æ®å®æ—¶å’Œç‰¹å®šé¢†åŸŸçš„æ•°æ®åšå‡ºæ›´åˆç†çš„å†³ç­–ã€‚è¿™ç§èƒ½åŠ›ä½¿å¾—å¤§æ¨¡å‹åœ¨é¢å¯¹å¤æ‚é—®é¢˜æ—¶ï¼Œèƒ½å¤Ÿåœ¨ä¿æŒé€»è¾‘ä¸¥è°¨æ€§çš„åŒæ—¶ï¼Œå¼¥è¡¥å†…åœ¨çŸ¥è¯†çš„ä¸è¶³ã€‚</p>
<h2 data-id="heading-2"><strong>äºŒã€RAGçš„è¿›åŒ–ï¼šå½“æ£€ç´¢å¼€å§‹ä¼šâ€œæ€è€ƒâ€</strong></h2>
<p>éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ï¼ŒRAG æ¨¡å‹é€æ¸ä¸æ¨ç†æŠ€æœ¯ç›¸ç»“åˆï¼Œå½¢æˆäº†æ›´ä¸ºå¼ºå¤§çš„æ¨ç†å¢å¼º RAGï¼ˆReasoning-Augmented RAGï¼‰æ¨¡å‹ã€‚è¿™ä¸€æŠ€æœ¯çªç ´ä¸ºäººå·¥æ™ºèƒ½åœ¨å¤æ‚ä»»åŠ¡ä¸­çš„åº”ç”¨æä¾›äº†æ–°çš„å‘å±•æœºé‡ï¼Œå°¤å…¶æ˜¯åœ¨å‚ç›´é¢†åŸŸçš„å®é™…è½åœ°ä¸­ï¼Œå±•ç°å‡ºäº†å·¨å¤§çš„æ½œåŠ›ã€‚</p>
<h3 data-id="heading-3"><strong>RAGä¸æ¨ç†çš„ç»“åˆçš„å‘å±•é˜¶æ®µ</strong></h3>
<p>RAG ä¸æ¨ç†çš„ç»“åˆç»å†äº†ä¸¤ä¸ªå…³é”®çš„å†å²æ€§é˜¶æ®µï¼šç¬¬ä¸€ä¸ªé˜¶æ®µç”± OpenAI æ¨å‡ºçš„ o1 æ¨¡å‹å¼€å¯ï¼Œo1 çš„å‡ºç°æ ‡å¿—ç€è®­ç»ƒæ—¶æ‰©å±•ï¼ˆtrain time scalingï¼‰åˆ°æ¨ç†æ—¶æ‰©å±•ï¼ˆinference time scalingï¼‰çš„è½¬å˜ã€‚è¿™ä¸€è¿›æ­¥ä½¿å¾—è‡ªåŠ¨åŒ–æ€ç»´é“¾æˆä¸ºå¯èƒ½ï¼Œå¹¶èƒ½å¤Ÿé€šè¿‡æ€è€ƒè¿‡ç¨‹æä¾›æ›´ç²¾ç¡®çš„å›ç­”ã€‚ç¬¬äºŒä¸ªé˜¶æ®µå‡ºç°åœ¨ä»Šå¹´å¹´åˆï¼ŒDeepSeek-R1 çš„å‘å¸ƒè¿›ä¸€æ­¥æ¨åŠ¨äº†æŠ€æœ¯çš„å‘å±•ï¼Œç‰¹åˆ«æ˜¯DeepSeek-R1 é‡‡ç”¨çš„å¼€æºç­–ç•¥ï¼Œä»¥åŠå…¶åˆ›æ–°çš„è½»é‡ã€é«˜æ•ˆä¸”å¯æ§çš„ GRPOï¼ˆGroup Relative Policy Optimizationï¼‰å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼Œä¸ºè¯¥é¢†åŸŸæ³¨å…¥äº†æ–°çš„æ´»åŠ›ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2698c396b3cd451b9e31233eef558d31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=BywUZyowNQh01GkNzZdjMVdLtIg%3D" alt="" loading="lazy"/></p>
<p>å°†æ¨ç†å¼•å…¥ RAG</p>
<p>éšç€ OpenAI o1 å’Œ DeepSeek-R1 ç­‰æ…¢æ€è€ƒæ¨¡å‹çš„å…´èµ·ï¼ŒRAG ä¸æ¨ç†èƒ½åŠ›ç»“åˆçš„ç ”ç©¶é€æ¸å¢å¤šï¼Œä¿ƒè¿›äº† RAG æŠ€æœ¯åœ¨å‚ç›´é¢†åŸŸçš„è½åœ°å’Œå‘å±•ã€‚åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼ŒæŠ€æœ¯åˆ›æ–°ä¸ä»…æ¶µç›–äº†æœ€è½»é‡çº§çš„æç¤ºå·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰å’Œå¾®è°ƒæ–¹æ³•ï¼ˆFine Tuningï¼‰ï¼Œæ›´é‡è¦çš„æ˜¯åŸºäºå¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learningï¼ŒRLï¼‰çš„æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯åœ¨ DeepSeek-R1 å‘å¸ƒä¹‹åï¼Œè¿™ç±»æ–¹æ³•å˜å¾—æ„ˆåŠ æ™®åŠå’Œå¹¿æ³›åº”ç”¨ï¼ˆä¾‹å¦‚ä¸Šå›¾æ©™è‰²åŒºåŸŸï¼‰ã€‚</p>
<h3 data-id="heading-4"><strong>RAGä¸æ¨ç†èƒ½åŠ›ç»“åˆçš„ä»·å€¼</strong></h3>
<p>RAG ä¸æ¨ç†èƒ½åŠ›ç»“åˆçš„ä»·å€¼ï¼Œå¯ä»¥ä»ä»¥ä¸‹ä¸¤ä¸ªäº’è¡¥çš„è§†è§’æ¥è¿›è¡Œæ·±å…¥åˆ†æï¼š</p>
<p>â— å¼¥è¡¥ç°æœ‰ RAG çš„ä¸è¶³ï¼Œå¼•å…¥æ¨ç†å¢å¼ºæ£€ç´¢ï¼šé€šè¿‡å¼•å…¥æ¨ç†èƒ½åŠ›ï¼Œå¯ä»¥åœ¨æ£€ç´¢è¿‡ç¨‹ä¸­å¢å¼ºæ¨ç†æ•ˆæœï¼Œè§£å†³ RAGï¼ˆå°¤å…¶æ˜¯Agentic RAGï¼‰åœ¨å¤æ‚é—®é¢˜è§£æä¸­çš„ç—›ç‚¹ã€‚ä¾‹å¦‚ï¼Œè·¨æ–‡æ¡£ååŒå›°éš¾ã€è·¨å†…å®¹æ£€ç´¢ä¸è¿è´¯ã€ä»¥åŠæ•ˆç‡ä¸ç²¾åº¦ä¹‹é—´çš„éš¾ä»¥å¹³è¡¡ç­‰é—®é¢˜ï¼Œéƒ½èƒ½é€šè¿‡æ¨ç†å¢å¼ºå¾—åˆ°æœ‰æ•ˆè§£å†³ã€‚</p>
<p>â— ä»å¤§æ¨¡å‹è‡ªèº«éœ€æ±‚å‡ºå‘ï¼Œå¸‚åœºä¸»æµå¤§æ¨¡å‹å‡å†…ç½®è”ç½‘æœç´¢åŠŸèƒ½ï¼šè¿™ä¸€è®¾è®¡æœ¬è´¨ä¸Šæ˜¯åœ¨æ¨ç†è¿‡ç¨‹ä¸­å¯¹æ£€ç´¢çš„å¢å¼ºã€‚åœ¨å¤šæ­¥æ¨ç†è¿‡ç¨‹ä¸­ï¼Œå¤§æ¨¡å‹å¯èƒ½å› ç¼ºä¹å®æ—¶çŸ¥è¯†è€Œå¯¼è‡´æ¨ç†æ–­å±‚ï¼Œå› è§„åˆ™ç¼ºå¤±è€Œäº§ç”Ÿè¾¹ç•Œæ¨¡ç³Šï¼Œæˆ–å› æœç´¢ç©ºé—´çˆ†ç‚¸è€Œé™·å…¥å±€éƒ¨ä¼˜åŒ–ã€‚é€šè¿‡åŠ¨æ€æ£€ç´¢å¤–éƒ¨çŸ¥è¯†ï¼Œå¯ä»¥æœ‰æ•ˆå¹³è¡¡æ¨ç†çš„æ·±åº¦ä¸å¹¿åº¦ï¼Œé¿å…çŸ¥è¯†æ»åæˆ–è§„åˆ™ç¼ºå¤±å¼•å‘çš„æ¨ç†æ–­è£‚ï¼Œä»è€Œä¸ºæŠ€æœ¯ä¼˜åŒ–æä¾›æ–°çš„è·¯å¾„ã€‚</p>
<p>é€šè¿‡è¿™ä¸¤ç§è§†è§’çš„ç»“åˆï¼Œæˆ‘ä»¬ä¸ä»…èƒ½å¤Ÿæå‡ RAG æŠ€æœ¯çš„åº”ç”¨æ•ˆæœï¼Œè¿˜èƒ½æ›´å¥½åœ°åº”å¯¹å®é™…åº”ç”¨ä¸­çš„å„ç§æŒ‘æˆ˜ï¼Œä¿ƒè¿› AI æŠ€æœ¯åœ¨æ›´å¤šé¢†åŸŸçš„è½åœ°å®æ–½ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6920761a0b6f4901b4d08ca88847ca98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=nkfxRgOU6FBYs0%2Fkae8W8JdYbLw%3D" alt="" loading="lazy"/></p>
<p>å…³ç¨é—®é¢˜ç¤ºä¾‹ï¼šRAG+Reasoning æ¨¡å‹</p>
<p>RAG ä¸æ¨ç†çš„èåˆï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŠ¨æ€ä»»åŠ¡è§„åˆ’ä¸æ‰§è¡Œçš„è¿‡ç¨‹ã€‚å®ƒå°†å¤æ‚é—®é¢˜ç³»ç»Ÿæ€§åœ°æ‹†è§£ä¸ºå¤šä¸ªå­ä»»åŠ¡ï¼Œå¦‚ç†è§£ã€åˆ†è§£ã€æ£€ç´¢ã€éªŒè¯ä¸æ•´åˆï¼Œä»è€Œå½¢æˆä¸€æ¡é€»è¾‘è‡ªæ´½çš„æ¨ç†é“¾ã€‚åœ¨ä¸Šå›¾å…³ç¨æ¡ˆä¾‹ä¸­ï¼Œä¼ ç»Ÿ RAG æ¨¡å‹å¯èƒ½ä¼šç›´æ¥æ‹¼æ¥å¤šä¸ªä¿¡æ¯ç‰‡æ®µï¼Œç”Ÿæˆä¸€ä¸ªç¬¼ç»Ÿçš„å›ç­”ã€‚è€Œ RAG + Reasoning æ¨¡å‹åˆ™ä¼šé‡‡å–æ›´ä¸ºç²¾ç»†çš„æ­¥éª¤ï¼šé¦–å…ˆç†è§£é—®é¢˜ç»“æ„ï¼Œç„¶ååˆ†è§£å­é—®é¢˜ï¼Œè¿›è¡Œå¤šè½®æ£€ç´¢ä¸äº¤å‰éªŒè¯ï¼Œæœ€ç»ˆç»¼åˆæ¨ç†å¹¶ç”Ÿæˆå»ºè®®ã€‚è¿™ç§æ–¹æ³•ä½¿å¾—ç»“æœä¸ä»…ä»…æ˜¯ä¿¡æ¯çš„ç®€å•å †ç Œï¼Œè€Œæ˜¯ä¸€ä»½ç»“æ„æ¸…æ™°ã€é€»è¾‘ä¸¥å¯†ã€å¹¶å…·å¤‡å®ç”¨ä»·å€¼çš„ä¸“ä¸šå»ºè®®ã€‚</p>
<h2 data-id="heading-5"><strong>ä¸‰ã€RAGæŠ€æœ¯çš„æ ¸å¿ƒé—®é¢˜ä¸æŠ€æœ¯æ¼”è¿›è·¯å¾„</strong></h2>
<p>å¯¹äºä¼ä¸šç”¨æˆ·ï¼ˆTo Bï¼‰æ¥è¯´ï¼ŒRAG æŠ€æœ¯çš„æ ¸å¿ƒåœ¨äºï¼šè¾“å…¥å†…å®¹é€šå¸¸æ˜¯ä¼ä¸šå†…éƒ¨çš„ç§æœ‰æ–‡æ¡£å’Œæ•°æ®ï¼Œè€Œè¾“å‡ºåˆ™ä¸»è¦æœåŠ¡äºä¸¤ç±»ä»»åŠ¡â€”â€”ä¸“ä¸šé¢†åŸŸçš„é—®ç­”æœåŠ¡å’Œæ™ºèƒ½å†™ä½œè¾…åŠ©ï¼Œè¿™ä¸¤ç±»åº”ç”¨åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­å…·æœ‰é‡è¦ä»·å€¼ã€‚éšç€ DeepSeek ç­‰å¤§æ¨¡å‹æŠ€æœ¯çš„è½åœ°åº”ç”¨ï¼Œå°¤å…¶æ˜¯é€šè¿‡ä¸€ä½“æœºå½¢å¼éƒ¨ç½²åï¼Œä¼ä¸šå¯¹ RAG æå‡ºäº†â€œæ—¢è¦åˆè¦è¿˜è¦â€çš„éœ€æ±‚ã€‚å…·ä½“è¡¨ç°ä¸ºå¯¹çŸ¥è¯†çš„ç²¾å‡†æ€§å’Œå®Œå¤‡æ€§è¦æ±‚ï¼Œå…¶æ¬¡æ˜¯å¯¹é€»è¾‘ä¸¥è°¨æ€§çš„éœ€æ±‚ï¼Œå†è€…ï¼Œå¤§æ¨¡å‹åœ¨å¤„ç†æ—¶é—´å’Œæ•°å€¼ç­‰æ–¹é¢ä»å­˜åœ¨æå‡ç©ºé—´ã€‚éšç€è¿™ä¸€è¿‡ç¨‹çš„æ·±å…¥ï¼Œç”¨æˆ·é€æ¸å»ºç«‹äº†ä»ç¦»çº¿ç´¢å¼•åˆ°åœ¨çº¿æ£€ç´¢æ¨ç†ä¸ç”Ÿæˆçš„å®Œæ•´æµç¨‹ï¼Œå®ç°äº†æ›´é«˜æ•ˆçš„ä¿¡æ¯å¤„ç†ä¸çŸ¥è¯†ç”Ÿæˆã€‚</p>
<p>åœ¨å¤§æ¨¡å‹çš„å®é™…åº”ç”¨è¿‡ç¨‹ä¸­ï¼Œé¢ä¸´ä¸€äº›äºŸå¾…è§£å†³çš„é—®é¢˜ã€‚è¿™äº›é—®é¢˜ä¸€æ–¹é¢æºè‡ªè‡ªå›å½’æ¨¡å‹å›ºæœ‰çš„é™åˆ¶ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¸æˆ‘ä»¬å¯¹æŠ€æœ¯çš„é«˜æœŸæœ›å­˜åœ¨å·®è·ï¼Œå°¤å…¶æ˜¯åœ¨æŠ€æœ¯çš„æˆç†Ÿåº¦å°šéœ€è¿›ä¸€æ­¥æå‡çš„èƒŒæ™¯ä¸‹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„æŒ‘æˆ˜ï¼š</p>
<ul>
<li>
<p>é”™è¯¯å®šæ€§æˆ–é”™è¯¯é€»è¾‘</p>
</li>
<li>
<p>äº‹å®æ€§é”™è¯¯æˆ–æ— ä¾æ®</p>
</li>
<li>
<p>æ—¶é—´ã€æ•°å€¼ä¸æ•æ„Ÿ</p>
</li>
<li>
<p>å¼ å† ææˆ´</p>
</li>
<li>
<p>ä¸èƒ½åŒºåˆ†é‡è¦æ€§</p>
</li>
<li>
<p>è¯­ä¹‰ä¸ç²¾å‡†</p>
</li>
<li>
<p>å¬å›ä¸å®Œå¤‡</p>
</li>
</ul>
<p>è¿™äº›é—®é¢˜çš„å­˜åœ¨ï¼Œåæ˜ äº†ç›®å‰å¤§æ¨¡å‹åœ¨æŸäº›ç‰¹å®šä»»åŠ¡ä¸­çš„å±€é™æ€§ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œè§£å†³è¿™äº›é—®é¢˜å°†æ˜¯æå‡å¤§æ¨¡å‹åº”ç”¨æ•ˆæœå’Œå¯é æ€§çš„å…³é”®ã€‚</p>
<p>é€šè¿‡å¯¹ RAG ç³»ç»Ÿçš„æ·±åº¦å‰–æï¼Œå¯å½’çº³å‡ºä¸‰å¤§æ ¸å¿ƒé—®é¢˜ï¼šæ£€ç´¢æœºåˆ¶ç¼ºé™·ã€é—®é¢˜æ€è€ƒçš„é€»è¾‘ç¨³å®šæ€§ä¸è¶³ä»¥åŠè®¡ç®—ä¸é€»è¾‘ä¸¥è°¨æ€§ç¼ºå¤±ã€‚è¿™äº›é—®é¢˜è¡¨æ˜ï¼Œåœ¨å‚ç›´é¢†åŸŸçš„çŸ¥è¯†åº“å»ºè®¾è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ­£ä»åŸºç¡€çš„ä¿¡æ¯æ£€ç´¢å‘æ›´é«˜é˜¶çš„è®¤çŸ¥æ¨ç†è½¬å‹ã€‚è¿™ä¸ªèƒ½åŠ›å‡çº§çš„è¿‡ç¨‹å¯ä»¥ç±»æ¯”äºè‡ªåŠ¨é©¾é©¶çš„åˆ†çº§ä½“ç³»ï¼Œå…·ä½“åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªå±‚æ¬¡ï¼š</p>
<ul>
<li>
<p>ç¬¬ä¸€å±‚ä¸º<strong>æ˜¾æ€§çŸ¥è¯†æ£€ç´¢</strong>ï¼Œä»…éœ€ä»çŸ¥è¯†åº“ä¸­ç›´æ¥è°ƒå–æ˜ç¡®ä¿¡æ¯ï¼Œå¯¹åº”åŸºç¡€ RAG æŠ€æœ¯ï¼Œè§£å†³"æœ‰æ²¡æœ‰çŸ¥è¯†"çš„é—®é¢˜ã€‚</p>
</li>
<li>
<p>ç¬¬äºŒå±‚æ˜¯<strong>å°†éšæ€§çŸ¥è¯†ç»“åˆ</strong>ï¼Œéœ€æ•´åˆå¤šä»½æ–‡æ¡£ä¸­çš„å…³è”ä¿¡æ¯ï¼Œå¯¹åº”æ¨ç†å¢å¼º RAGï¼Œé€šè¿‡æ€ç»´é“¾æˆ–åŠ¨æ€æ£€ç´¢è§£å†³"çŸ¥è¯†å¦‚ä½•ä¸²è”"çš„é—®é¢˜ã€‚</p>
</li>
<li>
<p>ç¬¬ä¸‰å±‚åˆ™æ˜¯<strong>æ˜ç¡®è§„åˆ™çš„æ¼”ç»æ¨ç†</strong>ï¼ŒåŸºäºé¢„è®¾è§„åˆ™è¿›è¡Œä¸¥æ ¼æ¨å¯¼ï¼Œéœ€æ¨¡å‹å…·å¤‡é€»è¾‘ç¨³å®šæ€§ï¼Œé¿å…æ€ç»´é“¾æ³¢åŠ¨ï¼Œå¯¹åº”å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–çš„æ¨ç†æ¨¡å‹ã€‚</p>
</li>
<li>
<p>ç¬¬å››å±‚éœ€è¦åŸºäºç»“æœçš„æ¨æ–­ï¼Œéœ€ä»ç»“æœåæ¨åŸå› ã€æ€»ç»“è§„å¾‹æˆ–è¿ç§»ç»éªŒï¼Œå¯¹æ¨¡å‹çš„é€»è¾‘ä¸¥è°¨æ€§å’Œæ³›åŒ–èƒ½åŠ›è¦æ±‚æœ€é«˜ï¼Œå¯¹åº”å†…ç”Ÿæ¨ç†æ¡†æ¶ï¼ˆå¦‚ KAGï¼‰çš„ç»ˆæç›®æ ‡â€”â€”<strong>é€šè¿‡éå¼ºåŒ–å­¦ä¹ èŒƒå¼å®ç°è‡ªä¸»æ¨ç†</strong>ã€‚</p>
</li>
</ul>
<p>è¿™ä¸€å±‚çº§åˆ’åˆ†æ­ç¤ºäº†å‚åŸŸ AI ä»"ä¿¡æ¯æ£€ç´¢"åˆ°"è®¤çŸ¥æ¨ç†"çš„æŠ€æœ¯æ¼”è¿›è·¯å¾„ï¼šæ¯æå‡ä¸€å±‚ï¼Œå¯¹æ¨¡å‹çš„çŸ¥è¯†æ•´åˆã€é€»è¾‘ç¨³å®šå’Œæ¨ç†ä¸¥è°¨æ€§çš„è¦æ±‚å‡å‘ˆæŒ‡æ•°çº§å¢é•¿ã€‚è€Œè¿™äº›æ­£æ˜¯å½“å‰æŠ€æœ¯çªç ´çš„é‡ç‚¹æ–¹å‘ã€‚</p>
<h2 data-id="heading-6"><strong>å››ã€å¤§æ¨¡å‹å¤–æŒ‚çŸ¥è¯†åº“çš„ä¸‰ç§æŠ€æœ¯è·¯çº¿</strong></h2>
<p>å¤§æ¨¡å‹å¤–æŒ‚çŸ¥è¯†åº“å¯åˆ†ä¸ºä¸‰ç±»è·¯çº¿ï¼Œå„æœ‰ä¼˜åŠ£ä¸”éäº’ç›¸å–ä»£ï¼Œæœªæ¥éœ€é›†æˆä¼˜åŠ¿ã€è§„é¿ç¼ºç‚¹ï¼š</p>
<p>â— è·¯çº¿ä¸€ï¼š<strong>æœç´¢å¼•æ“æŠ€æœ¯å»¶å±•</strong>ï¼Œæµç¨‹ä¸ºç´¢å¼•ï¼ˆindexï¼‰-æ£€ç´¢ï¼ˆretrieveï¼‰-ç”Ÿæˆï¼ˆå«è§„åˆ’ä¸ç”Ÿæˆï¼‰ã€‚é—®é¢˜åœ¨äºï¼šç´¢å¼•é˜¶æ®µä»…åšæ–‡æ¡£é—´ç®€å•åˆ†å—ï¼ˆchunkingï¼‰å’ŒåµŒå…¥ï¼ˆembeddingï¼‰ï¼Œç¼ºä¹è¯­ä¹‰å…³è”ï¼›æ£€ç´¢é˜¶æ®µæ— æ¨ç†èƒ½åŠ›ï¼›è§„åˆ’ä¸ç”Ÿæˆé˜¶æ®µçš„è‡ªç„¶è¯­è¨€è§„åˆ’ä¸ä¸¥è°¨ï¼Œæ‘˜è¦æ— åæ ¡éªŒï¼ˆå¤§æ¨¡å‹å‚æ•°å†»ç»“æœªè°ƒä¼˜ï¼‰ã€‚</p>
<p>â— è·¯çº¿äºŒï¼š<strong>å‡çº§åˆ° GraphRAG</strong>ï¼Œåœ¨ç´¢å¼•é˜¶æ®µé€šè¿‡å›¾ç»“æ„å¢å¼ºæ–‡æ¡£é—´è¯­ä¹‰å…³è”ï¼Œæ£€ç´¢é˜¶æ®µæå‡æ£€ç´¢å¬å›ç›¸å…³æ€§ï¼Œä½†è§„åˆ’ä¸ç”Ÿæˆç¯èŠ‚æœªæ”¹è¿›ã€‚</p>
<p>â— è·¯çº¿ä¸‰ï¼š<strong>ä¼ ç»ŸçŸ¥è¯†é—®ç­”åŸºäºå›¾ç´¢å¼•</strong>ï¼ŒåŒæ ·é¢ä¸´å›¾è°±æ„å»ºæˆæœ¬é«˜ã€é—¨æ§›é«˜çš„é—®é¢˜ï¼›æ£€ç´¢é˜¶æ®µçŸ¥è¯†è¦†ç›–åº¦ä½ï¼ˆæ— æ³•åƒå¤§æ¨¡å‹â€œå…œåº•â€æ‰€æœ‰é—®é¢˜ï¼‰ï¼Œä¼˜ç‚¹åœ¨äºè§„åˆ’ç”Ÿæˆç¯èŠ‚ä¸¥è°¨ã€å‡†ç¡®æ€§é«˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6dc9e852563540d09ba1a19aac4c9f25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=ddVDnu3RE1oaCAr69AlDLzeP0iU%3D" alt="" loading="lazy"/></p>
<p>å¤–æŒ‚çŸ¥è¯†åº“æŠ€æœ¯è·¯çº¿ä¼˜ç¼ºç‚¹å¯¹æ¯”</p>
<p>å¯¹æ¯”ä¸Šè¿°ä¸‰ç§æŠ€æœ¯è·¯çº¿ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä»¬åœ¨ç´¢å¼•ã€è§„åˆ’ã€æ£€ç´¢å’Œç”Ÿæˆç­‰æ–¹é¢å„è‡ªçš„ä¼˜ç¼ºç‚¹ã€‚æ˜¾ç„¶ï¼Œå¹¶ä¸å­˜åœ¨ä¸€ç§æ–¹æ¡ˆèƒ½å¤Ÿå®Œå…¨å–ä»£å…¶ä»–ä¸¤ç§æ–¹å¼ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸‰ç±»è·¯çº¿å¦‚åŒè½¯ä»¶å‘å±•çš„ä¸åŒé˜¶æ®µï¼Œå¹¶éäº’ç›¸æ›¿ä»£ï¼Œè€Œæ˜¯å¹¶å­˜å…±ç”Ÿã€‚ è¿™ä¸€ç°è±¡å¼•å¯¼æˆ‘ä»¬æ€è€ƒå¦‚ä½•å°†è¿™äº›æŠ€æœ¯è·¯çº¿çš„ä¼˜ç‚¹è¿›è¡Œé›†æˆï¼Œå¹¶è§„é¿å…¶ç¼ºç‚¹ã€‚ç­”æ¡ˆæ˜¯ä» RAG èµ°å‘ KAGï¼ˆKnowledge-Augmented Generationï¼ŒçŸ¥è¯†å¢å¼ºç”Ÿæˆï¼‰çš„è·¯çº¿ã€‚</p>
<h2 data-id="heading-7"><strong>äº”ã€KAGï¼ˆçŸ¥è¯†å¢å¼ºç”Ÿæˆï¼‰è·¯çº¿çš„æå‡º</strong></h2>
<p>KAG çš„æ ¸å¿ƒç†å¿µï¼ˆCoreIdeaï¼‰æ˜¯å……åˆ†åˆ©ç”¨çŸ¥è¯†åº“æˆ–çŸ¥è¯†å›¾è°±ä¸­ç»“æ„ä¸¥è°¨çš„ä¼˜åŠ¿ï¼Œé€šè¿‡å¤šé‡è¡¨å¾å’Œäº’ç´¢å¼•çš„æ–¹å¼æ¥ä¼˜åŒ–ä¿¡æ¯ç»„ç»‡ï¼Œå¹¶å€ŸåŠ©çŸ¥è¯†å’Œé€»è¾‘çš„è¯­ä¹‰å¼•å¯¼å¸®åŠ©å®ç°ç»“æ„åŒ–çš„æ€è€ƒå’Œæ¨ç†ã€‚</p>
<p>å›é¡¾å‰æ–‡æ‰€è¿°çš„å‡ ç§å¤–æŒ‚çŸ¥è¯†åº“æŠ€æœ¯è·¯çº¿ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç°æœ‰çš„ä¼ ç»Ÿæ–¹æ³•å„è‡ªå­˜åœ¨æ˜æ˜¾çš„ç¼ºé™·ï¼Œç„¶è€Œï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯¹ç³»ç»Ÿèƒ½åŠ›æå‡ºäº†æ›´é«˜çš„è¦æ±‚ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§å…¨æ–°çš„ KAG æ¡†æ¶â€”â€”ä»¥çŸ¥è¯†ç‚¹ä¸ºä¸­å¿ƒçš„çŸ¥è¯†ç´¢å¼•ä¸çŸ¥è¯†å¼•å¯¼çš„å¤æ‚é—®é¢˜æ±‚è§£æ–¹æ¡ˆã€‚è¯¥æ¡†æ¶åŒ…æ‹¬çŸ¥è¯†æ„å»ºï¼ˆBuilderï¼‰ã€é—®é¢˜æ±‚è§£ï¼ˆSolverï¼‰ä»¥åŠåº•å±‚æ”¯æ’‘çš„æ¨¡å‹ï¼ˆModelï¼‰ä¸‰ä¸ªéƒ¨åˆ†ï¼Œæ¶µç›–ç†è§£ã€ç”Ÿæˆå’Œæ¨ç†ç­‰å¤šä¸ªé˜¶æ®µï¼Œèƒ½å¤Ÿåœ¨å¤æ‚ä»»åŠ¡ä¸­æä¾›æ›´ä¸ºç²¾ç¡®ã€å¯é çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f625185a31e6481782defc981cf6478d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=S8%2F8SA6nrRQYyR753Nojq%2BZT5ec%3D" alt="" loading="lazy"/></p>
<p>KAG æ¨¡å‹æ¡†æ¶</p>
<h3 data-id="heading-8"><strong>KAGçŸ¥è¯†ç´¢å¼•ï¼šè‡ªåŠ¨åŒ–çŸ¥è¯†æ„å»º</strong></h3>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå€ŸåŠ©å¤§æ¨¡å‹çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°çŸ¥è¯†çš„è‡ªåŠ¨åŒ–æ„å»ºï¼Œè¿™ä¸€è¿‡ç¨‹ä¸ä»…åŒ…æ‹¬å¼€æ”¾ä¿¡æ¯æŠ½å–ï¼Œè¿˜æ¶µç›–ä»ä¸šåŠ¡ç³»ç»Ÿä¸­è·å–çš„ç»“æ„åŒ–æ•°æ®ã€‚å…³é”®åœ¨äºå®ç°åŒå‘æ ¡éªŒä¸äº’è¡¥ï¼šä¸€æ–¹é¢ï¼Œæ•°æ®åº“æˆ–å¤§æ•°æ®ä½“ç³»ä¸­çš„ç»“æ„åŒ–çŸ¥è¯†è™½ç„¶è¾ƒä¸ºç²¾å‡†ï¼Œä½†å¾€å¾€ç¼ºä¹ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼›å¦ä¸€æ–¹é¢ï¼Œéç»“æ„åŒ–æ–‡æœ¬è™½ç„¶å¯Œå«ä¸Šä¸‹æ–‡ï¼Œä½†å®¹æ˜“äº§ç”Ÿå™ªå£°ã€‚é€šè¿‡çŸ¥è¯†è¯­ä¹‰å¯¹é½ï¼Œä¸€æ–¹é¢å¯ä»¥é™ä½çŸ¥è¯†æ„å»ºæˆæœ¬ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿèƒ½æœ‰æ•ˆç¼“è§£å¼€æ”¾ä¿¡æ¯æŠ½å–å¸¦æ¥çš„å™ªå£°é—®é¢˜ã€‚</p>
<p>åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°çŸ¥è¯†æœ¬èº«æ˜¯åˆ†å±‚çš„ï¼ŒåŒ…æ‹¬æ¦‚å¿µå±‚é¢çš„çŸ¥è¯†å’Œå®é™…åº”ç”¨å±‚é¢çš„çŸ¥è¯†ã€‚æ­¤å¤–ï¼ŒçŸ¥è¯†ä¹Ÿå…·æœ‰åˆ†ç±»æ€§ï¼Œæ¶µç›–å„ç§å®ä½“ã€äº‹ä»¶ã€å±æ€§ã€å…³ç³»ã€æ¦‚å¿µç­‰ç»“æ„åŒ–çŸ¥è¯†ï¼Œä»¥åŠè‡ªç„¶è¯­è¨€æè¿°çš„é™ˆè¿°æ€§çŸ¥è¯†ï¼ˆå¦‚è§„åˆ™ã€è®¡ç®—è¿‡ç¨‹ç­‰ï¼‰ã€‚åŒæ—¶ï¼Œè¿˜æ¶‰åŠå¤§é‡çš„æ¡ˆä¾‹çŸ¥è¯†å’Œæ¨ç†çŸ¥è¯†ã€‚</p>
<h3 data-id="heading-9"><strong>KAGçŸ¥è¯†ç´¢å¼•ï¼šåˆ†å±‚çŸ¥è¯†è¡¨ç¤º</strong></h3>
<p>å› æ­¤ï¼Œå¦‚ä½•é€šè¿‡è¯­ä¹‰å¯¹é½å°†è¿™äº›ä¸åŒç±»å‹çš„çŸ¥è¯†æ•´åˆåˆ°åŒä¸€ä¸ªè¯­ä¹‰ç©ºé—´ä¸­å˜å¾—è‡³å…³é‡è¦ã€‚åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸å¿…è¦æ±‚æ‰€æœ‰çŸ¥è¯†éƒ½éµå¾ªä¸¥æ ¼çš„ schemaï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä¼˜åŒ–ä¼ ç»Ÿçš„çŸ¥è¯†å›¾è°±ä¸å¤§æ•°æ®æ—¶ä»£çš„æ¶æ„ï¼Œä½¿å…¶æ›´é€‚åº”å¤§æ¨¡å‹çš„éœ€æ±‚ã€‚è¿™æ ·çš„è¡¨ç¤ºæ–¹å¼å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªå±‚æ¬¡ï¼š</p>
<p><strong>â— ä¸¥è°¨å±‚ï¼ˆRigorousnessï¼‰ï¼š</strong> è¿™ä¸€å±‚çš„æœ€å¤§ä¼˜ç‚¹åœ¨äºå…¶å®Œæ•´æ€§ï¼ˆCompletenessï¼‰ï¼Œå®ƒæä¾›äº†éå¸¸å®Œå¤‡çš„çŸ¥è¯†è¡¨ç¤ºã€‚</p>
<p><strong>â— çµæ´»å±‚ï¼ˆFlexible Schemaï¼‰ï¼š</strong> è¿™ä¸€å±‚å…·æœ‰ä¸€å®šçš„ç»“æ„ä¿¡æ¯ï¼Œä½†å¹¶ä¸å¼ºåˆ¶è¦æ±‚å¼ºschemaï¼Œæ›´åƒæ˜¯ä¸€ä¸ªè‡ªç”±æ¨¡å¼ï¼ˆFree Schemaï¼‰å›¾æˆ–æ•°æ®å›¾çš„æ¦‚å¿µã€‚</p>
<p><strong>â— é¢†åŸŸç‰¹å®šå±‚ï¼ˆDomain-specific Strong Schemaï¼‰ï¼š</strong> è¿™ä¸€å±‚åˆ™ä¾èµ–äºé¢†åŸŸå†…çš„ç²¾ç¡®schemaæ¥ç¡®ä¿å‡†ç¡®æ€§ï¼ˆAccuracyï¼‰ã€‚</p>
<p>é€šè¿‡è¿™ç§è¡¨ç¤ºæ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸åŒçš„åº”ç”¨åœºæ™¯ä¸­å¹³æ»‘åœ°è°ƒæ•´ä¸“ä¸šå†³ç­–ã€ä¿¡æ¯æ£€ç´¢å’ŒçŸ¥è¯†å®Œæ•´æ€§çš„å¹³è¡¡ã€‚è¿™æ ·çš„æ¶æ„è®¾è®¡ï¼Œä½¿å¾—æˆ‘ä»¬åœ¨é¢å¯¹å…·ä½“é—®é¢˜æ—¶ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚æ›´åŠ çµæ´»åœ°é€‰æ‹©æœ€é€‚åˆçš„çŸ¥è¯†è¡¨ç¤ºå½¢å¼ï¼Œå¹¶åœ¨ä¸åŒå±‚æ¬¡ä¹‹é—´åšå‡ºåˆç†çš„æƒè¡¡ã€‚</p>
<h3 data-id="heading-10"><strong>çŸ¥è¯†èåˆä¸ç´¢å¼•æ„å»ºä¸­çš„å…³é”®è¦ç´ ä»¥åŠä¼˜åŒ–æ–¹æ¡ˆ</strong></h3>
<p>åœ¨åŸæœ‰çŸ¥è¯†ç»“æ„çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å°†å¢åŠ è‹¥å¹²å…³é”®è¦ç´ ï¼Œä»¥è¿›ä¸€æ­¥æå‡çŸ¥è¯†çš„å¯ç”¨æ€§å’Œåº”ç”¨æ•ˆæœã€‚å…·ä½“è€Œè¨€ï¼Œæ¯ä¸ªçŸ¥è¯†ç‚¹æˆ–ç»“æ„åŒ–çŸ¥è¯†é¡¹å°†æ·»åŠ æ‘˜è¦ï¼ˆsummaryï¼‰ï¼Œå¹¶ä¸”å¢åŠ çŸ¥è¯†ç‚¹ä¸åŸå§‹æ–‡æœ¬ chunk ä¹‹é—´çš„å…³è”ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿé€šè¿‡ç»“æ„åŒ–çš„èŠ‚ç‚¹ï¼Œç±»ä¼¼äºä¼ ç»Ÿçš„å€’æ’ç´¢å¼•ï¼Œå°†çŸ¥è¯†è½¬æ¢ä¸ºå…·æœ‰å…³è”å…³ç³»çš„å›¾ç»“æ„ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å°†é€šè¿‡ schema æ³¨å…¥æ¥å®ç°ä¸ä¼ ç»Ÿå›¾æ•°æ®åº“ä¸­ key-value å½¢å¼çš„å¯¹æ¥ã€‚é€šè¿‡è¿™ä¸€æ–¹å¼ï¼Œæ—¢èƒ½å……åˆ†åˆ©ç”¨ç°æœ‰å›¾æ•°æ®åº“çš„ä¼˜åŠ¿ï¼Œåˆèƒ½ç»“åˆæ–°å…´æŠ€æœ¯æå‡çŸ¥è¯†åº“çš„è¡¨è¾¾èƒ½åŠ›å’ŒæŸ¥è¯¢æ•ˆç‡ã€‚</p>
<p>åœ¨çŸ¥è¯†èåˆçš„è¿‡ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨æ„å»ºç´¢å¼•æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é‡ç‚¹è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªè¦ç´ ï¼šå¯¹äºå®ä½“ä¿¡æ¯ï¼Œå¿…é¡»è¡¥å……æ—¶ç©ºä¿¡æ¯ã€æ–‡æœ¬æ®µè½ä¸Šä¸‹æ–‡ä»¥åŠæ‰€å±é¢†åŸŸçš„æœ¬ä½“ä¿¡æ¯ã€‚ç¼ºå°‘è¿™äº›è¦ç´ æ—¶ï¼Œå½“å‰å¹¿æ³›ä½¿ç”¨çš„ embedding æ¨¡å‹ï¼Œå°¤å…¶æ˜¯æ£€ç´¢æ¨¡å‹ï¼Œå¯èƒ½é¢ä¸´ä¸€ç³»åˆ—é—®é¢˜ï¼š</p>
<p><strong>â— æŒ‡ä»£ç¼ºå¤±æˆ–é”™ä½ï¼š</strong> ä¾‹å¦‚ï¼Œæ¨¡å‹å¯èƒ½è®¤ä¸ºâ€œä¿„ç½—æ–¯æ€»ç»Ÿè®¿åâ€ä¸â€œç¾å›½æ€»ç»Ÿè®¿åâ€æ›´ä¸ºç›¸è¿‘ï¼Œè€Œå®é™…ä¸Šï¼Œâ€œä¿„ç½—æ–¯æ€»ç»Ÿè®¿åâ€ä¸â€œæ™®äº¬æŠµè¾¾åŒ—äº¬é¦–éƒ½æœºåœºâ€æ‰æ˜¯æ›´ç›¸å…³çš„äº‹ä»¶ï¼›</p>
<p><strong>â— æ—¶ç©ºé”™ä½ï¼š</strong> ä¾‹å¦‚ï¼Œ2024 å¹´ 5 æœˆ 30 æ—¥ä¸ 2024 å¹´ 6 æœˆ 1 æ—¥æ—¶é—´ä¸Šæ›´æ¥è¿‘ï¼Œä½†æ¨¡å‹å¯èƒ½é”™è¯¯åœ°å°†å…¶ä¸ 2023 å¹´ 5 æœˆ 30 æ—¥åŒ¹é…ï¼›</p>
<p><strong>â— æ•°å€¼æ··æ·†ï¼š</strong> ä¾‹å¦‚ï¼Œæ³•å¾‹æ¡æ–‡ä¸­çš„æ¡æ¬¾ç¼–å·ä¸é‡‘é¢æ•°å€¼å¯èƒ½è¢«æ··ä¸ºä¸€è°ˆï¼›</p>
<p><strong>â— é€»è¾‘é”™ä½ï¼š</strong> ä¾‹å¦‚ï¼Œå“®å–˜å±äºå‘¼å¸ç³»ç»Ÿæ…¢æ€§ç–¾ç—…ï¼Œä½†å¯èƒ½è¢«é”™è¯¯å…³è”åˆ°æ¶ˆåŒ–ç³»ç»Ÿæ…¢æ€§ç–¾ç—…ã€‚</p>
<p>ä¸ºäº†é¿å…ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸€ä¸ªå¤šå±‚æ¬¡çš„è¿‡ç¨‹æ¥æå‡çŸ¥è¯†çš„è¿é€šæ€§å’Œå‡†ç¡®æ€§ï¼šä»æ–‡æ¡£å‡ºå‘ï¼Œç»è¿‡å¼€æ”¾ä¿¡æ¯æŠ½å–ï¼Œå†åˆ°è¯­ä¹‰å¢å¼ºï¼ŒåŒ…æ‹¬æœ¬ä½“å¯¹é½ã€ä¸Šä½æ¦‚å¿µç”Ÿæˆã€æ¦‚å¿µé—´å…³è”æ„å»ºä»¥åŠåŒä¹‰è¯æ‰©å±•ï¼Œæœ‰æ•ˆæå‡çŸ¥è¯†çš„è¿æ¥æ€§ï¼Œç¡®ä¿æ¨¡å‹èƒ½å¤Ÿå‡†ç¡®ç†è§£ä¸åŒæ¦‚å¿µé—´çš„å…³ç³»ã€‚é€šè¿‡å¢å¼ºç¨€ç–å…³è”ã€æŠ‘åˆ¶å™ªå£°ï¼Œä½¿çŸ¥è¯†ç»“æ„æ›´åŠ ç´§å¯†å’Œå‡†ç¡®ï¼Œè¿›ä¸€æ­¥æé«˜æ£€ç´¢å’Œæ¨ç†çš„å‡†ç¡®æ€§ã€‚</p>
<p>åŒæ—¶åœ¨æ•´ä¸ªæµç¨‹ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†åŸºäºè§„åˆ’çš„æ§åˆ¶æœºåˆ¶ï¼Œå°†åŸæœ¬ä¾èµ–æ€ç»´é“¾ï¼ˆChain-of-Thoughtï¼ŒCoTï¼‰çš„è‡ªç„¶è¯­è¨€æ¨ç†è¿‡ç¨‹ï¼Œè½¬åŒ–ä¸ºå¯æ§çš„é€»è¾‘è¡¨è¾¾å¼ï¼Œä»è€Œå®ç°å¯¹æ¨ç†è·¯å¾„çš„ç²¾ç¡®å¼•å¯¼ã€‚è¿™ç§å½¢å¼åŒ–çš„è¡¨è¾¾ä½¿å¾—ç³»ç»Ÿèƒ½å¤ŸæŒ‰éœ€è°ƒç”¨ä¸åŒçš„æ±‚è§£å™¨ï¼ˆSolverï¼‰ï¼Œä¾‹å¦‚è¯­ä¹‰æ£€ç´¢æ¨¡å—ï¼Œä»è€Œæ›´æœ‰æ•ˆåœ°å»ºç«‹çŸ¥è¯†å…³è”ã€‚</p>
<h2 data-id="heading-11"><strong>å…­ã€KAGæ¨ç†æ¡†æ¶ï¼šé€»è¾‘ç¬¦å·å¼•å¯¼çš„ç»“æ„åŒ–æ¨ç†</strong></h2>
<p><strong>KAG æŠ€æœ¯çš„æ ¸å¿ƒä¹‹ä¸€æ˜¯å¦‚ä½•é€šè¿‡é€»è¾‘ç¬¦å·å¼•å¯¼çš„ç»“æ„åŒ–æ¨ç†æ¥å®ç°å¤æ‚é—®é¢˜çš„æ±‚è§£ã€‚</strong> ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°†åŸå§‹é—®é¢˜æŒ‰éœ€åˆ†è§£ä¸ºå¤šä¸ªå­é—®é¢˜ï¼Œå¹¶æ¸…æ™°åœ°åˆ»ç”»è¿™äº›å­é—®é¢˜ä¹‹é—´çš„é€»è¾‘ä¾èµ–å…³ç³»ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œç³»ç»Ÿåº”èƒ½è‡ªä¸»åˆ¤æ–­ä»¥ä¸‹å‡ é¡¹å†³ç­–ï¼š</p>
<ul>
<li>
<p>æ˜¯å¦è°ƒç”¨ç¬¦å·åŒ–çŸ¥è¯†å›¾è°±è¿›è¡Œæ¨ç†ï¼Ÿ</p>
</li>
<li>
<p>æ˜¯å¦æ‰§è¡Œæ–‡æœ¬ chunk çš„æ£€ç´¢ï¼Ÿ</p>
</li>
<li>
<p>æ˜¯å¦åœ¨ç»“æ„åŒ–æ•°æ®ä¸Šè¿›è¡Œå›¾éå†ä¸å­å›¾åŒ¹é…ï¼Ÿ</p>
</li>
<li>
<p>æ˜¯å¦åœ¨æ‰©å±•åçš„æ–‡æœ¬å†…å®¹ä¸Šè¿›è¡Œé˜…è¯»ç†è§£ä¸â€œæ€è€ƒâ€æ“ä½œï¼Ÿ</p>
</li>
</ul>
<p>æœ€ç»ˆï¼Œé€šè¿‡å¤šç§æ¨ç†æ–¹å¼çš„ååŒå·¥ä½œï¼Œç³»ç»Ÿèƒ½å¤ŸåŠ¨æ€æ›´æ–°ä¸æ•´åˆå½“å‰é—®é¢˜ç›¸å…³è®°å¿†ï¼ˆmemoryï¼‰ï¼Œä¸ºæ±‚è§£æä¾›æ›´ä¸ºç²¾å‡†çš„ç­”æ¡ˆã€‚</p>
<p>åœ¨æ•´ä¸ªæ¨ç†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å¤šç§é€»è¾‘å½¢å¼ï¼ˆLogical formï¼‰ï¼ŒåŒ…æ‹¬æ£€ç´¢ã€æ’åºã€æ•°å­¦è®¡ç®—ã€é€»è¾‘æ¨ç†ã€åé—®ä»¥åŠè¾“å‡ºç­‰å¯¹åº”çš„é€»è¾‘è¡¨è¾¾å½¢å¼ã€‚é€šè¿‡å¼•å…¥ç‰¹å®šçš„æ ‡è®°ï¼ˆspecial tokenï¼‰ï¼Œèƒ½å¤Ÿå°†åŸæœ¬å•ä¸€çš„æ•°æ®æµè½¬å˜ä¸ºæ•°æ®æµä¸æ§åˆ¶æµç›¸ç»“åˆçš„ååŒæœºåˆ¶ã€‚è¿™ç§æœºåˆ¶é€šè¿‡ä¸åŒçš„æ“ä½œç¬¦ï¼ˆOperatorï¼‰å’Œæ±‚è§£å™¨ï¼ˆSolverï¼‰å¯ä»¥å®ç°æœ¬èº«çš„è¾“å‡ºæ ¡éªŒï¼Œç¡®ä¿ç»“æœçš„å‡†ç¡®æ€§ï¼›è¿˜èƒ½æ”¯æŒæ¨ç†é—®ç­”ä»¥åŠæ£€ç´¢è¿‡ç¨‹ä¸­çš„åŠ¨æ€æ•°å€¼è®¡ç®—ï¼Œä»è€Œå¢å¼ºæ¨¡å‹çš„æ¨ç†æ·±åº¦å’Œçµæ´»æ€§ã€‚</p>
<h3 data-id="heading-12"><strong>å…¸å‹ä»»åŠ¡ç¤ºä¾‹ï¼šåšå£«ç”Ÿç”³è¯·å±…ä½è¯</strong></h3>
<p>ä»¥åšå£«ç”Ÿç”³è¯·å±…ä½è¯æ˜¯å¦éœ€è¦å­¦æ ¡å¼€å…·åœ¨è¯»è¯æ˜ä¸ºä¾‹ï¼Œè¯¥é—®é¢˜çš„æ±‚è§£è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºä¸€ç³»åˆ—ç»“æ„åŒ–æ“ä½œï¼š</p>
<ul>
<li>
<p>å®šä½æ‰€åœ¨åœ°åŒºï¼šé¦–å…ˆç¡®å®šæ‰€åœ¨åœ°åŒºçš„ç›¸å…³æ”¿ç­–ã€‚</p>
</li>
<li>
<p>æŸ¥æ‰¾ç›¸å…³åŠäº‹äº‹é¡¹ï¼šæŸ¥è¯¢è¯¥åœ°åŒºå±…ä½è¯åŠç†çš„ç›¸å…³è¦æ±‚ã€‚</p>
</li>
<li>
<p>åˆ¤æ–­æ˜¯å¦éœ€æä¾›åœ¨è¯»è¯æ˜ï¼šæ ¹æ®ç›¸å…³æ”¿ç­–ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æäº¤å­¦æ ¡å¼€å…·çš„åœ¨è¯»è¯æ˜ã€‚</p>
</li>
</ul>
<p>è¿™äº›æ­¥éª¤å®è´¨ä¸Šè½¬åŒ–ä¸ºæ£€ç´¢ï¼ˆretrieveï¼‰ã€æ‰©æ•£æŸ¥è¯¢ï¼ˆdiffuseï¼‰ç­‰å…·ä½“æ“ä½œç¬¦çš„æœ‰åºæ‰§è¡Œï¼Œä»è€Œå½¢æˆä»é—®é¢˜åˆ°ç­”æ¡ˆçš„ç»“æ„åŒ–æ¨ç†è·¯å¾„ã€‚</p>
<p>ä»è¿™ä¸ªå…¸å‹ä»»åŠ¡å¯ä»¥çœ‹å‡ºï¼Œæ ¸å¿ƒåœ¨äºå®ç°å¯æ§çš„è§„åˆ’è¿‡ç¨‹ã€‚éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œå¹¶éæ‰€æœ‰å†…å®¹éƒ½å¿…é¡»ç»“æ„åŒ–ï¼Œä¹Ÿå¹¶éæ‰€æœ‰å¤„ç†éƒ½éœ€ä¾èµ–å›¾ç»“æ„æ‰èƒ½å®Œæˆã€‚å®é™…ä¸Šï¼Œåœ¨ä¸€äº›è½»é‡çº§çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¿è¯æ•ˆæœç›¸å½“çš„å‰æä¸‹ï¼Œæœ‰æ•ˆæ§åˆ¶æ„å»ºæˆæœ¬ï¼Œè¿™å¯¹äºæœ¬åœ°åŒ–éƒ¨ç½²å’Œå‚ç›´é¢†åŸŸçš„è½åœ°åº”ç”¨éå¸¸é‡è¦ã€‚</p>
<h2 data-id="heading-13"><strong>ä¸ƒã€ä»å¤–éƒ¨ä¾èµ–åˆ°å†…åŒ–æ¨ç†ï¼šKAG-Thinkerçš„åˆ›æ–°è·¯å¾„</strong></h2>
<p>åœ¨å‰è¿°è®¨è®ºä¸­ï¼Œæˆ‘ä»¬æåˆ°å¤§æ¨¡å‹é€šè¿‡å¼•å…¥å¤–éƒ¨æ£€ç´¢å’Œæ±‚è§£å™¨è°ƒç”¨æ¥æ‰©å±•å…¶èƒ½åŠ›ï¼Œä½†è¿™ç§ä¾èµ–åœ¨å®é™…åº”ç”¨ä¸­ä¹Ÿé¢ä¸´ä¸€ç³»åˆ—æŒ‘æˆ˜ã€‚éšç€ä»å¤§æ¨¡å‹åˆ° RAG çš„è¿‡æ¸¡ï¼Œè™½ç„¶å¼•å…¥äº†å¤–éƒ¨çŸ¥è¯†åº“ï¼Œç³»ç»Ÿçš„å­˜å‚¨å¼€é”€ã€token æ¶ˆè€—ä»¥åŠæˆæƒæˆæœ¬ç­‰æ–¹é¢å´æ˜¾è‘—å¢åŠ ã€‚æ­¤å¤–ï¼Œå°½ç®¡æ¨ç†å¢å¼ºèƒ½å¤Ÿå¤„ç†æ›´å¤æ‚çš„ä»»åŠ¡ï¼Œä½†æ•´ä½“æµç¨‹è€—æ—¶å¢åŠ ï¼Œè¿™å¯¹å®é™…è½åœ°åº”ç”¨æå‡ºäº†æ–°çš„æŒ‘æˆ˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/171c09c2e5854b0d99fb313dd712652b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=swouNcnPOfgUNcbABgSY3y0mmFA%3D" alt="" loading="lazy"/></p>
<p>ä»å¤§æ¨¡å‹åˆ°æ¨ç†å¢å¼ºRAGé¢ä¸´çš„æŒ‘æˆ˜</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå°½ç®¡å¤§æ¨¡å‹å…·å¤‡è‡ªä¸»å†³ç­–çš„æ½œåŠ›ï¼Œä½†â€œè¿›åŒ–â€è¡Œä¸ºçš„æ–¹å‘æœªå¿…ç¬¦åˆé¢„æœŸï¼Œè¿™å¯èƒ½å¸¦æ¥é¢å¤–çš„å®‰å…¨é£é™©ã€‚ä¸ºäº†åº”å¯¹è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº† KAG-Thinkerï¼Œä¸ºæ¨¡å‹çš„æ€è€ƒè¿‡ç¨‹å»ºç«‹ä¸€å¥—æ¸…æ™°ã€åˆ†å±‚çš„ â€œè„šæ‰‹æ¶â€ï¼Œä»è€Œæå‡å¤æ‚ä»»åŠ¡ä¸­æ¨ç†è¿‡ç¨‹çš„é€»è¾‘æ€§ä¸ç¨³å®šæ€§ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼ŒKAG-Thinker å…¶å®æ˜¯ä»¥é€»è¾‘å½¢å¼ï¼ˆLogical Formï¼‰ä¸ºä¸­å¿ƒï¼Œå°†ä¸‰ç±»æ¨ç†æ¨¡å¼è¿›è¡Œç»Ÿä¸€ï¼Œä¸€æ˜¯çº¯è‡ªç„¶è¯­è¨€æ¨ç†ï¼ŒäºŒæ˜¯è‡ªç„¶è¯­è¨€ç»“åˆå˜é‡ä¸è¿ç®—ç¬¦çš„æ¨ç†ï¼Œä¸‰æ˜¯ä»…åŸºäºå˜é‡ä¸è¿ç®—ç¬¦çš„å½¢å¼åŒ–æ¨ç†ã€‚é€šè¿‡è¿™ç§ç»Ÿä¸€è¡¨è¾¾ï¼ŒKAG-Thinker èƒ½å¤Ÿå°†å¤–éƒ¨ä¾èµ–ï¼ˆå¦‚å¤–éƒ¨æ£€ç´¢ã€è°ƒç”¨å¤–éƒ¨æ±‚è§£å™¨ç­‰ï¼‰è½¬åŒ–ä¸ºå†…åŒ–æ¨ç†è¿‡ç¨‹ï¼Œä»è€Œæœ‰æ•ˆæå‡æ¨ç†çš„å¯æ§æ€§ä¸å¯è§£é‡Šæ€§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92886a1aa86e4c67bcf74f8c04f95eb8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=9oAhx58E%2BsD1tdmyfB8RhHirLio%3D" alt="" loading="lazy"/></p>
<p>KAG-Thinkerï¼šä»¥é€»è¾‘å½¢å¼ä¸ºä¸­å¿ƒ</p>
<h2 data-id="heading-14"><strong>KAG-Thinkeræ¨¡å‹èƒ½åŠ›</strong></h2>
<p><strong>åœ¨ KAG-Thinker æ¨¡å‹çš„è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯¹ç³»ç»Ÿæå‡ºäº†å‡ ä¸ªæ ¸å¿ƒè¦æ±‚ï¼šé€»è¾‘æ€§ã€ç¨³å®šæ€§ï¼Œä»¥åŠå¯¹çŸ¥è¯†è¾¹ç•Œçš„æ¸…æ™°åˆ¤æ–­ã€‚</strong> å…·ä½“æ¥è¯´ï¼Œæ¨¡å‹éœ€è¦èƒ½å¤Ÿæ˜ç¡®è¯†åˆ«ä½•æ—¶è°ƒç”¨å†…éƒ¨çŸ¥è¯†ï¼Œä»¥åŠä½•æ—¶ä¾èµ–å¤–éƒ¨ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦ç¡®ä¿æ±‚è§£è¿‡ç¨‹çš„ä¸¥è°¨æ€§ï¼Œå¹¶å…·å¤‡å¯¹æ£€ç´¢å™ªå£°çš„é²æ£’æ€§ã€‚</p>
<p>ç›®å‰å¸¸è§çš„åšæ³•æ˜¯é‡‡ç”¨å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰æ‰‹æ®µè¿›è¡Œä¼˜åŒ–ã€‚ç„¶è€Œï¼Œåœ¨ KAG-Thinker æ¡†æ¶ä¸­ï¼Œæˆ‘ä»¬å¹¶æœªé‡‡ç”¨ RL çš„æ–¹å¼ï¼Œè€Œæ˜¯é€‰æ‹©äº†ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰çš„æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸ºï¼Œåœ¨ç”ŸæˆåŒ…å«ç‰¹æ®Šæ ‡è®°ï¼ˆspecial tokenï¼‰å’Œé•¿æ€ç»´é“¾çš„ç»“æ„åŒ–æ¨ç†è·¯å¾„æ—¶ï¼ŒSFT èƒ½å¤Ÿé€šè¿‡å¤§é‡åˆæˆæ•°æ®å¹¶æ ¹æ®è¡Œä¸šéœ€æ±‚çµæ´»è°ƒæ•´æ¨¡å‹è¡Œä¸ºï¼Œç¡®ä¿æ¨ç†è¿‡ç¨‹çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚</p>
<p>æˆ‘ä»¬æ‰€ä½¿ç”¨çš„åˆæˆæ•°æ®æ¶µç›–äº†é€šç”¨é¢†åŸŸä¸å‚ç›´é¢†åŸŸçš„å¤šæ ·åŒ–æ ·æœ¬ï¼Œæ•´ä½“è¦†ç›–äº†é—®é¢˜çš„å¹¿åº¦åˆ†è§£ã€æ·±åº¦æ±‚è§£è¿‡ç¨‹ä¸­çš„çŸ¥è¯†è¾¹ç•Œè¯†åˆ«ã€æ±‚è§£å™¨è°ƒç”¨ç­–ç•¥ã€å¤šæºçŸ¥è¯†èåˆæ—¶çš„æ³¨æ„åŠ›èšç„¦ï¼Œä»¥åŠå…³é”®æ¨ç†èŠ‚ç‚¹çš„å‡†ç¡®è¡¨è¾¾ã€‚</p>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€æ­¥å¼•å¯¼æ¨¡å‹å®Œæˆå¤æ‚ä»»åŠ¡ï¼Œå¹¶åˆ©ç”¨é«˜è´¨é‡çš„è®­ç»ƒæ•°æ®æŒç»­ä¼˜åŒ–å…¶æ¨ç†èƒ½åŠ›ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒKAG-Thinker æ¨¡å‹é€šè¿‡é€»è¾‘å½¢å¼å°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºç‹¬ç«‹å¯è§£çš„å­é—®é¢˜ï¼Œæ„å»ºäº†ç»“æ„åŒ–çš„æ€ç»´è¿‡ç¨‹ï¼Œå¢å¼ºäº†é—®ç­”ä»»åŠ¡ä¸­æ¨ç†è¿‡ç¨‹çš„é€»è¾‘è¿è´¯æ€§å’Œä¸Šä¸‹æ–‡ä¸€è‡´æ€§ã€‚è¿™ç§æ–¹å¼å®ç°äº†å¯æ§ã€å¯è§£é‡Šçš„æ™ºèƒ½ç”Ÿæˆï¼Œç¡®ä¿æ¯ä¸€æ­¥æ¨ç†éƒ½å¯ä»¥è¿½æº¯ï¼Œå¹¶èƒ½å¤Ÿæ ¹æ®ç”¨æˆ·éœ€æ±‚çµæ´»è°ƒæ•´ã€‚æ¨¡å‹ä¸ä»…åœ¨é«˜æ•ˆæ±‚è§£ä¸Šè¡¨ç°å‡ºè‰²ï¼Œè¿˜èƒ½ä¿è¯æ¨ç†è¿‡ç¨‹çš„é€æ˜æ€§å’Œå¯é æ€§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cd16ca6d989494d919690b7e9074adf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=o861%2BvurAPLxYivV4sHOP7Ne73g%3D" alt="" loading="lazy"/></p>
<p>å¤æ‚é—®é¢˜æ±‚è§£æ¦‚è§ˆå›¾</p>
<h3 data-id="heading-15"><strong>å¤§æ¨¡å‹æ¨ç†ä¸æ£€ç´¢è¿‡ç¨‹ä¸­å­˜åœ¨çš„é—®é¢˜</strong></h3>
<p>åœ¨å¤§æ¨¡å‹çš„æ¨ç†ä¸æ£€ç´¢è¿‡ç¨‹ä¸­ï¼Œè‡³å…³é‡è¦çš„ä¸€ç‚¹æ˜¯è¯†åˆ«å’Œåº”å¯¹â€œçŸ¥è¯†å››è±¡é™â€é—®é¢˜ï¼šå³æ¨¡å‹æ˜¯å¦èƒ½å¤ŸåŒºåˆ†â€œçŸ¥é“è‡ªå·±çŸ¥é“â€ã€â€œçŸ¥é“è‡ªå·±ä¸çŸ¥é“â€ã€â€œä¸çŸ¥é“è‡ªå·±çŸ¥é“â€å’Œâ€œä¸çŸ¥é“è‡ªå·±ä¸çŸ¥é“â€è¿™å››ç§çŠ¶æ€ã€‚å¦‚ä½•æ”¹å–„æ¨¡å‹å¯¹è¿™å››ç±»æƒ…å†µçš„è¯†åˆ«èƒ½åŠ›ï¼Œæ˜¯æå‡å…¶å¯é æ€§çš„å…³é”®ã€‚åªæœ‰å½“æ¨¡å‹èƒ½å¤Ÿå‡†ç¡®è¯†åˆ«å¹¶åˆç†åº”å¯¹è¿™äº›ä¸åŒçš„çŸ¥è¯†çŠ¶æ€æ—¶ï¼Œæ‰èƒ½ç¡®ä¿æ¨ç†çš„æœ‰æ•ˆæ€§ä¸å‡†ç¡®æ€§ã€‚</p>
<p>æˆ‘ä»¬å¸Œæœ›æ¨¡å‹åœ¨å›ç­”æ­£ç¡®é—®é¢˜æ—¶ï¼Œå…·å¤‡è¾ƒé«˜ä¸”å¯æ§çš„ç½®ä¿¡åº¦ï¼ˆconfidenceï¼‰ã€‚ä¾‹å¦‚ï¼Œå½“æ¨¡å‹ç”Ÿæˆæ­£ç¡®ç­”æ¡ˆæ—¶ï¼Œå…¶ç½®ä¿¡åº¦åº”ä¿æŒåœ¨è¾ƒé«˜æ°´å¹³ï¼ˆå¦‚0.95ä»¥ä¸Šï¼‰ã€‚ç„¶è€Œï¼Œå½“å‰è®¸å¤šå¤§æ¨¡å‹å­˜åœ¨è¿‡åº¦è‡ªä¿¡çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨è¾“å‡ºé”™è¯¯ç­”æ¡ˆæ—¶ï¼Œå¸¸è¡¨ç°å‡ºè¿‡é«˜çš„ç½®ä¿¡åº¦ï¼Œè¿™å¯¼è‡´äº†å¯ä¿¡åº¦å¤±è¡¡ã€‚è¿™ç§æƒ…å†µå¸¸å¸¸æ˜¯æ¨¡å‹å¹»è§‰ç°è±¡çš„æ ¹æºä¹‹ä¸€ã€‚å› æ­¤ï¼Œå¿…é¡»è®¾è®¡æœ‰æ•ˆæœºåˆ¶æ¥å°†ç½®ä¿¡åº¦æ§åˆ¶åœ¨åˆç†èŒƒå›´å†…ï¼Œé¿å…ä¸å‡†ç¡®çš„ç­”æ¡ˆè¢«è¿‡åº¦è‡ªä¿¡åœ°è¾“å‡ºã€‚</p>
<p>æ­¤å¤–ï¼Œåœ¨æ€§èƒ½å±‚é¢è¿˜æœ‰ä¸¤ä¸ªå…³é”®æŒ‡æ ‡ï¼šä¸€æ˜¯<strong>æ¨ç†è¿‡ç¨‹çš„ç¨³å®šæ€§</strong>ï¼ŒäºŒæ˜¯<strong>å¯¹â€œè¿‡åº¦è‡ªä¿¡â€ï¼ˆover-confidenceï¼‰çš„æ§åˆ¶</strong>ã€‚å¤§æ¨¡å‹æ™®éå­˜åœ¨è¿‡åº¦è‡ªä¿¡çš„é—®é¢˜ï¼Œå³åœ¨ç¼ºä¹ä¾æ®çš„æƒ…å†µä¸‹ä»ä»¥é«˜ç½®ä¿¡åº¦è¾“å‡ºé”™è¯¯ç»“æœï¼Œè¿™æ­£æ˜¯å¹»è§‰ç°è±¡çš„é‡è¦æˆå› ä¹‹ä¸€ã€‚å› æ­¤ï¼Œå¿…é¡»é€šè¿‡æœºåˆ¶è®¾è®¡å°†å…¶æ§åˆ¶åœ¨åˆç†èŒƒå›´å†…ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51564dbdcc19450ea9ed5d4aa255bab7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915393&amp;x-signature=AWGzPEIcVP0pNSB%2FKV291dpiOb4%3D" alt="" loading="lazy"/></p>
<p>KAG-Thinker æ¨¡å‹</p>
<p>æœ€ç»ˆï¼Œæ‰€æœ‰çš„æ¨ç†ä¸åˆ¤æ–­è¿‡ç¨‹éƒ½å°†è¢«é›†æˆåˆ°æ¨¡å‹æœåŠ¡ï¼ˆmodel servingï¼‰ç¯èŠ‚ï¼Œç¡®ä¿æ¨ç†ï¼ˆinferenceï¼‰ä¸ AI æœåŠ¡æµç¨‹çš„æ·±åº¦èåˆã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ¨¡å‹ä¸ä»…èƒ½å¤Ÿåœ¨æ¨ç†æ—¶å‡†ç¡®è¯†åˆ«ä½•æ—¶åº”ä¾èµ–å†…åœ¨çŸ¥è¯†ï¼Œä½•æ—¶åº”è°ƒç”¨å¤–éƒ¨ä¿¡æ¯ï¼Œè¿˜èƒ½æœ‰æ•ˆæ§åˆ¶ç½®ä¿¡åº¦ï¼Œæå‡æœåŠ¡è´¨é‡ä¸ç³»ç»Ÿçš„å¯é æ€§ã€‚</p>
<h2 data-id="heading-16"><strong>å…«ã€ä»åŠ©æ‰‹åˆ°ä¼™ä¼´ï¼šRAGåˆ°KAGçš„å››å¤§è·ƒè¿è·¯çº¿</strong></h2>
<p>RAG æŠ€æœ¯åœ¨ç›®å‰çš„åº”ç”¨ä¸­ä»ç„¶å­˜åœ¨å¤§é‡çš„ä¼˜åŒ–ç©ºé—´ï¼Œå…¶æœ¬è´¨ç›®æ ‡æ˜¯<strong>å°†å¤§æ¨¡å‹ä»ä¸€ä¸ªè¢«åŠ¨çš„çŸ¥è¯†åŠ©æ‰‹ï¼Œé€æ­¥å‘å±•ä¸ºå…·å¤‡è®¤çŸ¥èƒ½åŠ›çš„æ™ºèƒ½ä¼™ä¼´ã€‚</strong> ä¸ºå®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘è®¤ä¸ºå¯ä»¥ä»ä»¥ä¸‹å››ä¸ªæ–¹é¢è¿›è¡Œæå‡ï¼š</p>
<ul>
<li>
<p>ä»ä¼ ç»Ÿçš„æ¨¡ç³Šè¯­ä¹‰åŒ¹é…è½¬å‘é€»è¾‘é©±åŠ¨çš„å®šå‘ç²¾å‡†æ£€ç´¢ã€‚è¿™åŒ…æ‹¬å¯¹é—®é¢˜è¿›è¡Œå­é—®é¢˜åˆ†è§£ï¼Œå¹¶åœ¨æ¨ç†è¿‡ç¨‹ä¸­è§¦å‘ç²¾å‡†ã€æœ‰é’ˆå¯¹æ€§çš„æ£€ç´¢æ“ä½œï¼Œæå‡ä¿¡æ¯è·å–çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚</p>
</li>
<li>
<p>ä»å•ä¸€çš„é—®ç­”æ¨¡å¼å‡çº§ä¸ºç³»ç»Ÿæ€§å†³ç­–æ”¯æŒã€‚é¢å¯¹å¤æ‚ä»»åŠ¡ï¼Œéœ€æ”¯æŒå¤šè·¯å¾„ã€å¤šåˆ†æ”¯çš„æ¨ç†æµç¨‹ï¼Œå½¢æˆç»“æ„åŒ–çš„å†³ç­–é“¾æ¡ï¼Œè€Œä¸ä»…ä»…æ˜¯å­¤ç«‹åœ°å›ç­”å•ä¸ªé—®é¢˜ã€‚</p>
</li>
<li>
<p>é’ˆå¯¹å¤§æ¨¡å‹å¸¸å‡ºç°çš„ä¿¡æ¯å †ç Œé—®é¢˜ï¼Œåº”å¢å¼ºå¯¹è¿”å›ä¿¡æ¯çš„é€»è¾‘è‡ªæ´½æ€§æ ¡éªŒï¼Œå¹¶å®ç°åŠ¨æ€è¡¥å…¨ã€‚é€šè¿‡åˆ¤æ–­ä¿¡æ¯ä¹‹é—´çš„ä¸€è‡´æ€§ï¼ŒæŒ‰éœ€è§¦å‘æ–°çš„æ£€ç´¢æˆ–æ¨ç†æ­¥éª¤ï¼Œå½¢æˆé—­ç¯çš„æ±‚è§£è¿‡ç¨‹ã€‚</p>
</li>
<li>
<p>å½“å‰å¤§æ¨¡å‹å­˜åœ¨ç›²ç›®æœç´¢å’Œè¿‡åº¦æ€è€ƒçš„é—®é¢˜ï¼Œå› æ­¤éœ€è¦å®ç°æ™ºèƒ½çš„èµ„æºåˆ†é…æœºåˆ¶ï¼Œåˆç†è°ƒåº¦æ¨ç†æ·±åº¦ä¸å¹¿åº¦ï¼Œé¿å…èµ„æºæµªè´¹ï¼Œæå‡å“åº”æ•ˆç‡ä¸ç»“æœè´¨é‡ã€‚</p>
</li>
</ul>
<p>é€šè¿‡è¿™å››ä¸ªæ–¹å‘çš„æå‡ï¼Œæˆ‘ä»¬ä¸ä»…èƒ½å¤Ÿä¼˜åŒ–ç°æœ‰ RAG æŠ€æœ¯çš„åº”ç”¨æ•ˆæœï¼Œæ›´èƒ½æ¨åŠ¨å¤§æ¨¡å‹ä»å•çº¯çš„çŸ¥è¯†æ£€ç´¢å·¥å…·å‘å…·å¤‡è®¤çŸ¥å’Œå†³ç­–èƒ½åŠ›çš„æ™ºèƒ½ä¼™ä¼´æ¼”å˜ã€‚è¿™ä¸€è½¬å˜å°†æå¤§åœ°æ‹“å±•å¤§æ¨¡å‹åœ¨å‚ç›´é¢†åŸŸä¸­çš„åº”ç”¨æ½œåŠ›ï¼Œå¹¶ä¸ºæœªæ¥çš„æ™ºèƒ½ç³»ç»Ÿæä¾›æ›´åŠ ç²¾ç¡®ã€çµæ´»çš„æ¨ç†æ”¯æŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain 1.0 å˜é©]]></title>    <link>https://juejin.cn/post/7577171133432660009</link>    <guid>https://juejin.cn/post/7577171133432660009</guid>    <pubDate>2025-11-27T03:05:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577171133432660009" data-draft-id="7576953459543588918" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChain 1.0 å˜é©"/> <meta itemprop="keywords" content="Agent,LangChain"/> <meta itemprop="datePublished" content="2025-11-27T03:05:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¥‡èˆç²¾é€‰"/> <meta itemprop="url" content="https://juejin.cn/user/4388906147515367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChain 1.0 å˜é©
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4388906147515367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¥‡èˆç²¾é€‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-27T03:05:52.000Z" title="Thu Nov 27 2025 03:05:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å½“å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„åº”ç”¨ä»åŸå‹éªŒè¯èµ°å‘è§„æ¨¡åŒ–è½åœ°ï¼Œå¼€å‘äººå‘˜é¢ä¸´çš„æ ¸å¿ƒç—›ç‚¹å·²ä»â€œèƒ½å¦å®ç°â€è½¬å˜ä¸ºâ€œå¦‚ä½•å¯é å®ç°â€ã€‚2025å¹´10æœˆ23æ—¥ï¼ŒLangChainæ­£å¼å‘å¸ƒ1.0ç‰ˆæœ¬ï¼Œè¿™ä¸€é‡Œç¨‹ç¢‘å¼çš„æ›´æ–°ä¸ä»…ç»ˆç»“äº†æ­¤å‰ç‰ˆæœ¬ä¸­Agentæ¶æ„ç¢ç‰‡åŒ–çš„å±€é¢ï¼Œæ›´ä»¥â€œç”Ÿäº§å°±ç»ªâ€ä¸ºæ ¸å¿ƒå®šä½ï¼Œé‡æ–°å®šä¹‰äº†æ™ºèƒ½Agentå¼€å‘æ¡†æ¶çš„æŠ€æœ¯æ ‡å‡†ã€‚</p>
<h3 data-id="heading-0">å®˜æ–¹æ–‡æ¡£</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Foss%2Fpython%2Flangchain%2Foverview" target="_blank" title="https://docs.langchain.com/oss/python/langchain/overview" ref="nofollow noopener noreferrer">docs.langchain.com/oss/python/â€¦</a></p>
<h3 data-id="heading-1">å®‰è£…</h3>
<p>pip:</p>
<pre><code class="hljs language-bash" lang="bash">pip install -U langchain
<span class="hljs-comment"># Requires Python 3.10+</span>
</code></pre>
<p>Uv:</p>
<pre><code class="hljs language-bash" lang="bash">uv add langchain
<span class="hljs-comment"># Requires Python 3.10+</span>
</code></pre>
<h2 data-id="heading-2">ä¸»è¦å†…å®¹</h2>
<h3 data-id="heading-3">create_agent - æ„å»ºæ™ºèƒ½ä½“ç®€åŒ–</h3>
<blockquote>
<p>åªéœ€ä¸åˆ°10è¡Œä»£ç ï¼Œä½ å°±å¯ä»¥è¿æ¥åˆ°OpenAIã€Anthropicã€è°·æ­Œä»¥åŠ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Foss%2Fpython%2Fintegrations%2Fproviders%2Foverview" target="_blank" title="https://docs.langchain.com/oss/python/integrations/providers/overview" ref="nofollow noopener noreferrer">æ›´å¤š</a>å¹³å°ã€‚</p>
</blockquote>
<h4 data-id="heading-4">æ—§ç‰ˆæœ¬çš„é—®é¢˜</h4>
<p>åœ¨ LangChain 1.0 ä¹‹å‰ï¼Œæ„å»ºä¸€ä¸ªæ™ºèƒ½ä½“éœ€è¦ç¼–å†™å¤§é‡æ¨¡æ¿ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ—§ç‰ˆæœ¬ç®€å•ç¤ºä¾‹</span>
from langgraph.prebuilt import create_react_agent
from langchain_openai import ChatOpenAI
from langchain.tools import Tool

<span class="hljs-comment"># å®šä¹‰å·¥å…·</span>
def get_weather(city):
    return f"{city}å¤©æ°”æ™´æœ—"

<span class="hljs-attr">tools</span> = [Tool(name=<span class="hljs-string">"get_weather"</span>, func=get_weather, description=<span class="hljs-string">"è·å–å¤©æ°”"</span>)]

<span class="hljs-comment"># é…ç½®æç¤ºè¯</span>
<span class="hljs-attr">system_prompt</span> = <span class="hljs-string">"""ä½ æ˜¯ä¸€ä¸ªå¤©æ°”æŸ¥è¯¢åŠ©æ‰‹ï¼Œä½¿ç”¨å·¥å…·è·å–å®æ—¶å¤©æ°”..."""</span>

<span class="hljs-comment"># åˆ›å»º Agent</span>
<span class="hljs-attr">agent</span> = create_react_agent(
    <span class="hljs-attr">model</span>=ChatOpenAI(model=<span class="hljs-string">"gpt-4"</span>),
    <span class="hljs-attr">tools</span>=tools,
    <span class="hljs-attr">state_modifier</span>=system_prompt
)

<span class="hljs-comment"># è¿è¡Œ</span>
<span class="hljs-attr">result</span> = agent.invoke({<span class="hljs-string">"messages"</span>: [(<span class="hljs-string">"user"</span>, <span class="hljs-string">"åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>)]})
</code></pre>
<h4 data-id="heading-5">æ–°ç‰ˆæœ¬çš„ç®€åŒ–</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># LangChain 1.0</span>
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI

<span class="hljs-comment"># å®šä¹‰å·¥å…·</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è·å–æŒ‡å®šåŸå¸‚å¤©æ°”"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"å½“å‰<span class="hljs-subst">{city}</span>å¤©æ°”æ™´æœ—ï¼Œæ°”æ¸©25â„ƒ"</span>

<span class="hljs-comment"># åˆ›å»ºæ™ºèƒ½ä½“</span>
agent = create_agent(
    model=ChatOpenAI(model=<span class="hljs-string">"gpt-4o-mini"</span>),
    tools=[get_weather],
    system_prompt=<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªå¤©æ°”æŸ¥è¯¢åŠ©æ‰‹ï¼Œä½¿ç”¨å·¥å…·è·å–å®æ—¶å¤©æ°”"</span>
)

<span class="hljs-comment"># è¿è¡Œæ™ºèƒ½ä½“</span>
response = agent.invoke({
    <span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æ·±åœ³ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>}]
})

<span class="hljs-built_in">print</span>(response[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>][<span class="hljs-string">"content"</span>])
</code></pre>
<h4 data-id="heading-6">æ ¸å¿ƒæ”¹è¿›</h4>
<ul>
<li>
<p>è‡ªåŠ¨åŒ–ï¼šè‡ªåŠ¨å¤„ç†å·¥å…·è°ƒç”¨ã€å¼‚å¸¸é‡è¯•</p>
</li>
<li>
<p>ç®€åŒ–å·¥å…·ï¼šå·¥å…·å®šä¹‰æ›´ç®€å•ï¼Œç›´æ¥ä½¿ç”¨æ™®é€šå‡½æ•°</p>
</li>
<li>
<p>ç»Ÿä¸€æ¥å£ï¼šæ”¯æŒæ‰€æœ‰ä¸»æµ LLM æ¨¡å‹ï¼Œåˆ‡æ¢æ¨¡å‹æ— éœ€ä¿®æ”¹ä»£ç </p>
</li>
</ul>
<h3 data-id="heading-7">content_blocks - ç»Ÿä¸€æ‰€æœ‰æ¨¡å‹çš„è¾“å‡ºæ ¼å¼</h3>
<h4 data-id="heading-8">é—®é¢˜çš„æ ¹æº</h4>
<p>ä¸åŒçš„ AI æ¨¡å‹è¿”å›ç»“æœçš„æ ¼å¼å„ä¸ç›¸åŒï¼š</p>
<ul>
<li>
<p><strong>OpenAI</strong>ï¼šè¿”å› function_call å­—æ®µ</p>
</li>
<li>
<p><strong>Anthropic Claude</strong>ï¼šä½¿ç”¨ XML æ ‡ç­¾åŒ…è£¹å·¥å…·è°ƒç”¨</p>
<p>â€¦â€¦</p>
</li>
</ul>
<p>è¿™å¯¼è‡´ä»£ç ä¸­å……æ»¡äº†å¤æ‚çš„æ¡ä»¶åˆ¤æ–­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ—§ç‰ˆæœ¬ï¼šå¤„ç†ä¸åŒæ¨¡å‹çš„è¾“å‡º</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_response</span>(<span class="hljs-params">response, model_type</span>):
    <span class="hljs-keyword">if</span> model_type == <span class="hljs-string">"openai"</span>:
        <span class="hljs-keyword">if</span> response.function_call:
            <span class="hljs-keyword">return</span> handle_function_call(response.function_call)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> response.content
    <span class="hljs-keyword">elif</span> model_type == <span class="hljs-string">"anthropic"</span>:
        <span class="hljs-comment"># è§£æXMLæ ‡ç­¾</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">"&lt;tool_call&gt;"</span> <span class="hljs-keyword">in</span> response.content:
            <span class="hljs-keyword">return</span> parse_xml_tool_call(response.content)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> response.content
    <span class="hljs-comment"># å…¶ä»–æ¨¡å‹çš„å¤„ç†...</span>
</code></pre>
<p>ä¸åŒæ¨¡å‹å¯¹æ€è€ƒè¿‡ç¨‹çš„æ ‡è®°ä¹Ÿä¸åŒï¼Œï¼ˆå¦‚ <code>think</code> æˆ– <code>reason</code> æ ‡ç­¾ï¼‰ï¼ŒLangChain 1.0ç»Ÿä¸€æ¨¡å‹æ¨ç†æ¶ˆæ¯ä¸º<code>type=="reasoning"</code></p>
<h4 data-id="heading-9">è§£å†³æ–¹æ¡ˆï¼šcontent_blocks</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># LangChain 1.0ï¼šç»Ÿä¸€å¤„ç†æ‰€æœ‰æ¨¡å‹è¾“å‡º</span>
<span class="hljs-keyword">from</span> langchain_anthropic <span class="hljs-keyword">import</span> ChatAnthropic

model = ChatAnthropic(model=<span class="hljs-string">"claude-sonnet-4-5-20250929"</span>)
response = model.invoke(<span class="hljs-string">"è§£é‡Šä»€ä¹ˆæ˜¯é‡å­è®¡ç®—ï¼Œå¹¶ç»™å‡ºä¾‹å­"</span>)

<span class="hljs-comment"># ç»Ÿä¸€è®¿é—®ä¸åŒç±»å‹çš„å†…å®¹å—</span>
<span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> response.content_blocks:
    <span class="hljs-keyword">if</span> block[<span class="hljs-string">"type"</span>] == <span class="hljs-string">"reasoning"</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¨ç†è¿‡ç¨‹: <span class="hljs-subst">{block[<span class="hljs-string">'reasoning'</span>]}</span>"</span>)
    <span class="hljs-keyword">elif</span> block[<span class="hljs-string">"type"</span>] == <span class="hljs-string">"text"</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å›ç­”å†…å®¹: <span class="hljs-subst">{block[<span class="hljs-string">'text'</span>]}</span>"</span>)
    <span class="hljs-keyword">elif</span> block[<span class="hljs-string">"type"</span>] == <span class="hljs-string">"tool_call"</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·¥å…·è°ƒç”¨: <span class="hljs-subst">{block[<span class="hljs-string">'name'</span>]}</span>(<span class="hljs-subst">{block[<span class="hljs-string">'args'</span>]}</span>)"</span>)
</code></pre>
<p>ä¸åŒçš„å‚å•†ä¼šè‡ªå·±è®¾è®¡é’ˆå¯¹å¤šæ¨¡æ€å¤§æ¨¡å‹çš„å›¾ç‰‡è¾“å…¥ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eef70d7a06d24eb686d419b3f82a60b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWH6Iie57K-6YCJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764817622&amp;x-signature=BoNg9Y%2FBDQznVRB6EckWNCFQESc%3D" alt="" loading="lazy"/></p>
<p>ä½¿ç”¨content_blocksä¹‹åï¼š</p>
<pre><code class="hljs language-bash" lang="bash">message = HumanMessage(
    content=[
        {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>, 
            <span class="hljs-string">"text"</span>: <span class="hljs-string">"æ ¹æ®è¿™å¼ å›¾ç‰‡å†™ä¸€ä¸‹é¡µé¢"</span>
        },
        {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"image"</span>,
            <span class="hljs-string">"image_url"</span>: {<span class="hljs-string">"url"</span>: <span class="hljs-string">'å›¾ç‰‡é“¾æ¥'</span>}  
        }
    ]
)
</code></pre>
<p>é€šè¿‡<code>type:image</code>æ¥ç»Ÿä¸€å¤„ç†</p>
<h4 data-id="heading-10">æ ¸å¿ƒä»·å€¼</h4>
<ul>
<li>
<p><strong>æ ‡å‡†æ¥å£</strong>ï¼šä¸€å¥—ä»£ç å¤„ç†æ‰€æœ‰æ¨¡å‹è¾“å‡º</p>
</li>
<li>
<p><strong>æˆæœ¬èŠ‚çº¦</strong>ï¼šæ¨¡å‹åˆ‡æ¢æˆæœ¬å¤§å¹…åº¦é™ä½</p>
</li>
<li>
<p><strong>å¼€å‘æ•ˆç‡</strong>ï¼šé¿å…é‡å¤çš„æ ¼å¼è§£æä»£ç </p>
</li>
</ul>
<h3 data-id="heading-11">ç®€åŒ–å‘½åç©ºé—´ - ç”©æ‰å†å²åŒ…è¢±</h3>
<h4 data-id="heading-12">æ—§ç‰ˆæœ¬çš„æ··ä¹±</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ—§ç‰ˆæœ¬ï¼šå¤æ‚çš„å¯¼å…¥è·¯å¾„</span>
<span class="hljs-keyword">from</span> langchain.chains <span class="hljs-keyword">import</span> LLMChain
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> AgentExecutor
<span class="hljs-keyword">from</span> langchain.llms <span class="hljs-keyword">import</span> OpenAI
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> BaseTool
<span class="hljs-keyword">from</span> langchain.utilities <span class="hljs-keyword">import</span> SerpAPIWrapper
</code></pre>
<h4 data-id="heading-13">æ–°ç‰ˆæœ¬çš„æ¸…æ™°</h4>





























<table><thead><tr><th>æ¨¡å—</th><th>æ ¸å¿ƒå†…å®¹</th></tr></thead><tbody><tr><td><code>langchain.agents</code></td><td><code>create_agent</code>, <code>AgentState</code></td></tr><tr><td><code>langchain.messages</code></td><td>æ¶ˆæ¯ç±»å‹ã€å†…å®¹å—ã€<code>trim_messages</code></td></tr><tr><td><code>langchain.tools</code></td><td><code>@tool</code>, <code>BaseTool</code>, æ³¨å…¥å·¥å…·ç±»</td></tr><tr><td><code>langchain.chat_models</code></td><td><code>init_chat_model</code>, <code>BaseChatModel</code></td></tr><tr><td><code>langchain.embeddings</code></td><td><code>Embeddings</code>, <code>init_embeddings</code></td></tr></tbody></table>
<p>ä¸‹é¢ä»¥æ–°ç‰ˆçš„<code>init_chat_model</code>ä¸ºä¾‹å­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-string">"""
æ–°ç‰ˆLangChain 1.0åŸºç¡€èŠå¤©
å±•ç¤ºç®€åŒ–çš„åˆå§‹åŒ–å’Œæ¶ˆæ¯å¤„ç†æ–¹å¼
"""</span>

<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain.messages <span class="hljs-keyword">import</span> HumanMessage, AIMessage, SystemMessage
<span class="hljs-keyword">from</span> config <span class="hljs-keyword">import</span> MODEL_INIT_PARAMS


<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_chat_model</span>():
    <span class="hljs-string">"""åˆ›å»ºèŠå¤©æ¨¡å‹ï¼ˆæ–°ç‰ˆæ–¹å¼ï¼‰"""</span>
    <span class="hljs-comment"># æ–°ç‰ˆæœ¬ä½¿ç”¨ init_chat_model ç»Ÿä¸€åˆå§‹åŒ–</span>
    <span class="hljs-keyword">return</span> init_chat_model(**MODEL_INIT_PARAMS)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">basic_chat_new</span>():
    <span class="hljs-string">"""åŸºç¡€èŠå¤©åŠŸèƒ½ - æ–°ç‰ˆæœ¬"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== LangChain 1.0 åŸºç¡€èŠå¤© ==="</span>)
    
    <span class="hljs-comment"># æ–°ç‰ˆæœ¬ç»Ÿä¸€åˆå§‹åŒ–æ–¹å¼</span>
    llm = create_chat_model()
    
    <span class="hljs-comment"># æ–°ç‰ˆæœ¬ç®€åŒ–çš„æ¶ˆæ¯æ„é€ </span>
    messages = [
        SystemMessage(<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„AIåŠ©æ‰‹"</span>),
        HumanMessage(<span class="hljs-string">"è¯·ç®€å•ä»‹ç»ä¸€ä¸‹Pythonçš„ä¼˜åŠ¿"</span>)
    ]
    
    <span class="hljs-comment"># è°ƒç”¨æ¨¡å‹</span>
    response = llm.invoke(messages)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”¨æˆ·: <span class="hljs-subst">{messages[<span class="hljs-number">1</span>].content}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŠ©æ‰‹: <span class="hljs-subst">{response.content}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"---"</span>)
    
    <span class="hljs-comment"># æ–°ç‰ˆæœ¬çš„å†…å®¹å—è®¿é—®ï¼ˆç»Ÿä¸€æ¥å£ï¼‰</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ–°ç‰¹æ€§ - ç»Ÿä¸€å†…å®¹å—è®¿é—®:"</span>)
    <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> response.content_blocks:
        <span class="hljs-keyword">if</span> block[<span class="hljs-string">"type"</span>] == <span class="hljs-string">"text"</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ–‡æœ¬å†…å®¹: <span class="hljs-subst">{block[<span class="hljs-string">'text'</span>][:<span class="hljs-number">100</span>]}</span>..."</span>)
        <span class="hljs-keyword">elif</span> block[<span class="hljs-string">"type"</span>] == <span class="hljs-string">"reasoning"</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ¨ç†è¿‡ç¨‹: <span class="hljs-subst">{block[<span class="hljs-string">'reasoning'</span>]}</span>"</span>)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-keyword">try</span>:
        basic_chat_new()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ–°ç‰ˆåŸºç¡€èŠå¤©æ¼”ç¤ºå®Œæˆ"</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)

</code></pre>
<p>å…¶ä¸­æ–°ç‰ˆå¯¹åº”çš„åˆå§‹åŒ–æ¨¡å¼ä½¿ç”¨çš„å‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">MODEL_INIT_PARAMS = {
    <span class="hljs-string">"model"</span>: MODEL_NAME,
    <span class="hljs-string">"model_provider"</span>: <span class="hljs-string">"openai"</span>,
    <span class="hljs-string">"api_key"</span>: API_KEY,
    <span class="hljs-string">"base_url"</span>: API_BASE,
    <span class="hljs-string">"temperature"</span>: TEMPERATURE,
    <span class="hljs-string">"max_retries"</span>: MAX_RETRIES,
    <span class="hljs-string">"timeout"</span>: REQUEST_TIMEOUT,
    <span class="hljs-string">"max_tokens"</span>: MAX_TOKENS,
    <span class="hljs-string">"streaming"</span>: STREAMING
}
</code></pre>
<p>å†çœ‹çœ‹ä»¥å‰çš„å†™æ³•ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-string">"""
æ—§ç‰ˆLangChainåŸºç¡€èŠå¤©
å±•ç¤ºä¼ ç»Ÿçš„èŠå¤©æ¨¡å‹åˆå§‹åŒ–å’Œä½¿ç”¨æ–¹å¼
"""</span>

<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain.schema <span class="hljs-keyword">import</span> HumanMessage, AIMessage, SystemMessage
<span class="hljs-keyword">from</span> config <span class="hljs-keyword">import</span> API_BASE, API_KEY, MODEL_NAME, TEMPERATURE, MAX_RETRIES, REQUEST_TIMEOUT, MAX_TOKENS, STREAMING


<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_chat_model</span>():
    <span class="hljs-string">"""åˆ›å»ºèŠå¤©æ¨¡å‹ï¼ˆæ—§ç‰ˆæ–¹å¼ç¤ºä¾‹ï¼‰"""</span>
    <span class="hljs-keyword">return</span> ChatOpenAI(
        openai_api_base=API_BASE,
        openai_api_key=API_KEY,
        model=MODEL_NAME,
        temperature=TEMPERATURE,
        max_retries=MAX_RETRIES,
        request_timeout=REQUEST_TIMEOUT,
        max_tokens=MAX_TOKENS,
        streaming=STREAMING
    )


<span class="hljs-keyword">def</span> <span class="hljs-title function_">basic_chat_old</span>():
    <span class="hljs-string">"""åŸºç¡€èŠå¤©åŠŸèƒ½ - æ—§ç‰ˆæœ¬"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== LangChain æ—§ç‰ˆæœ¬åŸºç¡€èŠå¤© ==="</span>)
    
    <span class="hljs-comment"># åˆå§‹åŒ–æ¨¡å‹</span>
    llm = create_chat_model()
    
    <span class="hljs-comment"># æ„é€ æ¶ˆæ¯</span>
    messages = [
        SystemMessage(content=<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„AIåŠ©æ‰‹"</span>),
        HumanMessage(content=<span class="hljs-string">"è¯·ç®€å•ä»‹ç»ä¸€ä¸‹Pythonçš„ä¼˜åŠ¿"</span>)
    ]
    
    <span class="hljs-comment"># è°ƒç”¨æ¨¡å‹</span>
    response = llm.invoke(messages)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”¨æˆ·: <span class="hljs-subst">{messages[<span class="hljs-number">1</span>].content}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŠ©æ‰‹: <span class="hljs-subst">{response.content}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"---"</span>)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-keyword">try</span>:
        basic_chat_old()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ—§ç‰ˆåŸºç¡€èŠå¤©æ¼”ç¤ºå®Œæˆ"</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)

</code></pre>
<h4 data-id="heading-14">æ”¹è¿›æ•ˆæœ</h4>
<ul>
<li>
<p><strong>è®¤çŸ¥å‡è´Ÿ</strong>ï¼šæ–°å¼€å‘è€…æ›´å®¹æ˜“ä¸Šæ‰‹</p>
</li>
<li>
<p><strong>æ€§èƒ½æå‡</strong>ï¼šé¿å…ä¸å¿…è¦çš„ä¾èµ–åŠ è½½</p>
</li>
</ul>
<h3 data-id="heading-15">ä¸­é—´ä»¶ç³»ç»Ÿï¼šè®©æ™ºèƒ½ä½“æ›´æ™ºèƒ½çš„ "æ’ä»¶"</h3>
<h4 data-id="heading-16">ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ï¼Ÿ</h4>
<p><strong>ä¸­é—´ä»¶å°±åƒæ˜¯æ™ºèƒ½ä½“çš„ "æ™ºèƒ½æ’ä»¶"</strong>ï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹æ ¸å¿ƒä»£ç çš„æƒ…å†µä¸‹ï¼Œä¸ºæ™ºèƒ½ä½“æ·»åŠ å„ç§åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-17">å†…ç½®ä¸­é—´ä»¶ç¤ºä¾‹</h4>
<ul>
<li><code>PIIMiddleware:åœ¨å‘é€è‡³æ¨¡å‹å‰å±è”½æ•æ„Ÿä¿¡æ¯</code></li>
<li><code>SummarizationMiddleware:å¯¹è¯å†å²è¿‡é•¿æ—¶è‡ªåŠ¨è¿›è¡Œå†…å®¹å‹ç¼©</code></li>
<li><code>HumanInTheLoopMiddleware:æ•æ„Ÿå·¥å…·è°ƒç”¨éœ€è¦ç»è¿‡äººå·¥å®¡æ‰¹</code></li>
</ul>
<p>è¿™é‡Œæ¼”ç¤ºä¸€ä¸‹PIIMiddleware</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-string">"""
LangChain 1.0 ä¸­é—´ä»¶ç³»ç»Ÿ
å±•ç¤ºPIIæ£€æµ‹
"""</span>

<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain.agents.middleware <span class="hljs-keyword">import</span> (
    PIIMiddleware
)
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool
<span class="hljs-keyword">from</span> config <span class="hljs-keyword">import</span> MODEL_INIT_PARAMS

<span class="hljs-keyword">def</span> <span class="hljs-title function_">middleware_demo</span>():
    <span class="hljs-string">"""ä¸­é—´ä»¶åŠŸèƒ½æ¼”ç¤º - LangChain 1.0 ç‹¬æœ‰ç‰¹æ€§"""</span>
    
    <span class="hljs-comment"># å…ˆåˆå§‹åŒ–æ¨¡å‹</span>
    model = init_chat_model(**MODEL_INIT_PARAMS)
    
    <span class="hljs-comment"># åˆ›å»ºå¸¦æœ‰å¤šç§ä¸­é—´ä»¶çš„agent</span>
    agent = create_agent(
        model=model,
        tools=[send_email, read_user_data],
        middleware=[
            <span class="hljs-comment"># PIIæ£€æµ‹å’Œå¤„ç†ä¸­é—´ä»¶</span>
            PIIMiddleware(
                <span class="hljs-string">"email"</span>, 
                strategy=<span class="hljs-string">"redact"</span>,  <span class="hljs-comment"># é®æ©ç­–ç•¥</span>
                apply_to_input=<span class="hljs-literal">True</span>,
                apply_to_output=<span class="hljs-literal">True</span>
            ),
            PIIMiddleware(
                <span class="hljs-string">"ip"</span>,  <span class="hljs-comment"># ä½¿ç”¨ ip ç±»å‹ä½œä¸ºæ‰‹æœºå·é®æ©</span>
                detector=<span class="hljs-string">r"(?:13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}"</span>,  <span class="hljs-comment"># æ‰‹æœºå·æ­£åˆ™</span>
                strategy=<span class="hljs-string">"redact"</span>,
                apply_to_input=<span class="hljs-literal">True</span>,
                apply_to_output=<span class="hljs-literal">True</span>
            ),
            PIIMiddleware(
                <span class="hljs-string">"credit_card"</span>,  <span class="hljs-comment"># ä½¿ç”¨ credit_card ä½œä¸ºèº«ä»½è¯å·é®æ©</span>
                detector=<span class="hljs-string">r"\d{17}[\dXx]"</span>,  <span class="hljs-comment"># èº«ä»½è¯å·æ­£åˆ™</span>
                strategy=<span class="hljs-string">"redact"</span>,
                apply_to_input=<span class="hljs-literal">True</span>,
                apply_to_output=<span class="hljs-literal">True</span>
            )
        ],
        system_prompt=<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªå®‰å…¨çš„æ•°æ®å¤„ç†åŠ©æ‰‹ï¼Œä¸¥æ ¼ä¿æŠ¤ç”¨æˆ·éšç§"</span>
    )
    <span class="hljs-comment"># æµ‹è¯•åœºæ™¯1: PIIæ£€æµ‹</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- æµ‹è¯•åœºæ™¯1: PIIæ•°æ®å¤„ç† ---"</span>)
    <span class="hljs-keyword">try</span>:
        result = agent.invoke({
            <span class="hljs-string">"messages"</span>: [{
                <span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, 
                <span class="hljs-string">"content"</span>: <span class="hljs-string">"è¯·è¯»å–ç”¨æˆ·001çš„æ•°æ®"</span>
            }]
        })
        
        last_message = result[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
        content = <span class="hljs-built_in">getattr</span>(last_message, <span class="hljs-string">'content'</span>, <span class="hljs-string">''</span>) <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(last_message, <span class="hljs-string">'content'</span>) <span class="hljs-keyword">else</span> <span class="hljs-string">''</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"PIIå¤„ç†åçš„è¾“å‡º: <span class="hljs-subst">{content}</span>"</span>)
        
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"PIIæµ‹è¯•é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
    
    <span class="hljs-comment"># æµ‹è¯•åœºæ™¯2: åŒ…å«æ•æ„Ÿä¿¡æ¯çš„è¾“å…¥</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- æµ‹è¯•åœºæ™¯2: æ•æ„Ÿè¾“å…¥è¿‡æ»¤ ---"</span>)
    <span class="hljs-keyword">try</span>:
        result = agent.invoke({
            <span class="hljs-string">"messages"</span>: [{
                <span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>,
                <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘çš„æ‰‹æœºå·æ˜¯13912345678ï¼Œè¯·å‘é‚®ä»¶ç»™manager@company.comå‘ŠçŸ¥æˆ‘çš„ä¿¡æ¯"</span>
            }]
        })
        
        <span class="hljs-comment"># å±•ç¤ºä¸­é—´ä»¶å¤„ç†ç»“æœ</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ä¸­é—´ä»¶å¤„ç†ç»“æœ:"</span>)
        <span class="hljs-keyword">for</span> i, msg <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(result[<span class="hljs-string">"messages"</span>]):
            msg_type = <span class="hljs-built_in">type</span>(msg).__name__
            content = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">getattr</span>(msg, <span class="hljs-string">'content'</span>, <span class="hljs-string">''</span>))[:<span class="hljs-number">150</span>] <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(msg, <span class="hljs-string">'content'</span>) <span class="hljs-keyword">else</span> <span class="hljs-string">''</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  <span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>. <span class="hljs-subst">{msg_type}</span>: <span class="hljs-subst">{content}</span>..."</span>)
            
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ•æ„Ÿè¾“å…¥æµ‹è¯•é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)



</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">--- æµ‹è¯•åœºæ™¯1: PIIæ•°æ®å¤„ç† ---
PIIå¤„ç†åçš„è¾“å‡º: ä»¥ä¸Šæ˜¯ç”¨æˆ·001çš„æ•°æ®ä¿¡æ¯ã€‚å‡ºäºéšç§ä¿æŠ¤è€ƒè™‘ï¼Œéƒ¨åˆ†æ•æ„Ÿä¿¡æ¯å·²è¢«éšè—ï¼ˆå¦‚æ‰‹æœºå·å’Œèº«ä»½è¯å·ç ï¼‰ã€‚å¦‚æœæ‚¨éœ€è¦äº†è§£æ›´å¤šç‰¹å®šä¿¡æ¯ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œä½†è¯·æ³¨æ„æˆ‘ä¼šä¸¥æ ¼éµå®ˆæ•°æ®éšç§ä¿æŠ¤åŸåˆ™ã€‚

--- æµ‹è¯•åœºæ™¯2: æ•æ„Ÿè¾“å…¥è¿‡æ»¤ ---
ä¸­é—´ä»¶å¤„ç†ç»“æœ:
  1. HumanMessage: æˆ‘çš„æ‰‹æœºå·æ˜¯[REDACTED_IP]ï¼Œè¯·å‘é‚®ä»¶ç»™manager@company.comå‘ŠçŸ¥æˆ‘çš„ä¿¡æ¯...
  2. AIMessage: æˆ‘æ³¨æ„åˆ°æ‚¨æä¾›äº†ä¸€ä¸ªçœ‹èµ·æ¥åƒæ˜¯IPåœ°å€è€Œéæ‰‹æœºå·çš„ä¿¡æ¯ï¼Œè€Œä¸”æ‚¨å¸Œæœ›æˆ‘å‘é€è¿™äº›ä¿¡æ¯ç»™ä¸€ä¸ªé‚®ç®±åœ°å€ã€‚å‡ºäºä¿æŠ¤æ‚¨çš„éšç§å’Œæ•°æ®å®‰å…¨çš„è€ƒè™‘ï¼Œæˆ‘ä¸èƒ½ç›´æ¥å‘é€æ‚¨çš„ä¸ªäººä¿¡æ¯ç»™ç¬¬ä¸‰æ–¹ã€‚

å¦‚æœæ‚¨éœ€è¦å‘é€é‚®ä»¶ï¼Œæˆ‘å¯ä»¥å¸®åŠ©æ‚¨ï¼Œä½†éœ€è¦æ‚¨æ˜ç¡®æŒ‡å‡ºï¼š
1. æ‚¨æƒ³å‘é€ä»€ä¹ˆå…·ä½“å†…å®¹
2. ä¸ºä»€ä¹ˆéœ€è¦å‘é€æ‚¨çš„ä¸ªäººä¿¡æ¯

è¯·æ³¨æ„ï¼Œä½œä¸º...
</code></pre>
<p>è¿™é‡Œè§£é‡Šä¸€ä¸‹é®æ©ç­–ç•¥ï¼š</p>
<p><code>strategy="redact"</code></p>
<p>é®æ©ç­–ç•¥æ˜¯ä¸€ç§ä¿æŠ¤ä¸ªäººå¯è¯†åˆ«ä¿¡æ¯ï¼ˆPIIï¼‰çš„æ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼š</p>
<ol>
<li>
<p>ç­–ç•¥ç›®çš„ï¼š
åœ¨ä¿ç•™åŸå§‹æ–‡æœ¬ç»“æ„çš„åŒæ—¶ï¼Œéšè—æ•æ„Ÿçš„ä¸ªäººä¿¡æ¯
é˜²æ­¢ç›´æ¥æ³„éœ²ä¸ªäººéšç§æ•°æ®</p>
</li>
<li>
<p>å®ç°æ–¹å¼ï¼š
ä¸å®Œå…¨åˆ é™¤æ•æ„Ÿä¿¡æ¯
ä½¿ç”¨ç‰¹å®šæ–¹å¼æ›¿æ¢æ•æ„Ÿä¿¡æ¯
ä¿ç•™ä¿¡æ¯çš„åŸºæœ¬ä¸Šä¸‹æ–‡å’Œç»“æ„</p>
</li>
<li>
<p>ä¼˜åŠ¿ï¼š</p>
<p>ç›¸æ¯” "block" ç­–ç•¥ï¼ˆå®Œå…¨é˜»æ­¢ï¼‰æ›´åŠ çµæ´»
ä¿ç•™äº†æ–‡æœ¬çš„å¯è¯»æ€§å’Œä¸Šä¸‹æ–‡ä¿¡æ¯
é˜²æ­¢æ•æ„Ÿä¿¡æ¯çš„ç›´æ¥æ³„éœ²</p>
</li>
</ol>
<h4 data-id="heading-18">ä¸­é—´ä»¶çš„ä»·å€¼</h4>
<ul>
<li>
<p><strong>åŠŸèƒ½æ‰©å±•</strong>ï¼šæŒ‰éœ€æ·»åŠ åŠŸèƒ½ï¼Œä¸å½±å“æ ¸å¿ƒæ€§èƒ½</p>
</li>
<li>
<p><strong>å®‰å…¨ä¿éšœ</strong>ï¼šæ•æ„Ÿæ“ä½œäººå·¥å®¡æ‰¹ï¼Œé˜²æ­¢è¯¯æ“ä½œï¼ˆHumanInTheLoopMiddlewareï¼‰</p>
</li>
<li>
<p><strong>éšç§ä¿æŠ¤</strong>ï¼šè‡ªåŠ¨è„±æ•æ•æ„Ÿä¿¡æ¯ï¼ˆPIIMiddlewareï¼‰</p>
</li>
<li>
<p><strong>è®°å¿†ä¼˜åŒ–</strong>ï¼šè‡ªåŠ¨æ€»ç»“é•¿å¯¹è¯ï¼Œé¿å…ä¸Šä¸‹æ–‡æº¢å‡ºï¼ˆSummarizationMiddlewareï¼‰</p>
</li>
</ul>
<h2 data-id="heading-19">LangChain 1.0 vs æ—§ç‰ˆæœ¬å¯¹æ¯”</h2>



































<table><thead><tr><th>ç‰¹æ€§</th><th>æ—§ç‰ˆæœ¬</th><th>LangChain 1.0</th></tr></thead><tbody><tr><td><strong>ä»£ç ç®€æ´æ€§</strong></td><td>50 + è¡Œæ¨¡æ¿ä»£ç </td><td>10 + è¡Œæ ¸å¿ƒä»£ç </td></tr><tr><td><strong>æ¨¡å‹å…¼å®¹æ€§</strong></td><td>æœ‰é™æ”¯æŒ</td><td>æ”¯æŒæ‰€æœ‰ä¸»æµ LLM</td></tr><tr><td><strong>å¼€å‘æ•ˆç‡</strong></td><td>ä½ï¼Œéœ€è¦å¤§é‡é…ç½®</td><td>é«˜ï¼Œå³æ’å³ç”¨</td></tr><tr><td><strong>ç³»ç»Ÿç¨³å®šæ€§</strong></td><td>ä¸­ç­‰ï¼Œå®¹æ˜“å‡ºé”™</td><td>é«˜ï¼Œå†…ç½®é”™è¯¯å¤„ç†</td></tr><tr><td><strong>æ‰©å±•æ€§</strong></td><td>å·®ï¼Œéœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç </td><td>å¥½ï¼Œé€šè¿‡ä¸­é—´ä»¶æ‰©å±•</td></tr></tbody></table>
<h2 data-id="heading-20">å¯¼å›¾</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3163cf86e4e445ea07b26bd3383babb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWH6Iie57K-6YCJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764817622&amp;x-signature=1ZBUfHdRiIvW5fV74NH2CMEIa8Y%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-21">æ€è€ƒ</h2>
<p>LangChain 1.0 çš„å‘å¸ƒæ ‡å¿—ç€ AI æ™ºèƒ½ä½“å¼€å‘æ­£å¼è¿›å…¥<strong>å·¥ç¨‹åŒ–é˜¶æ®µ</strong>ã€‚LangChain 1.0 ä¸ä»…æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œæ›´æ˜¯å¸®åŠ©æˆ‘ä»¬ç†è§£å’Œä½¿ç”¨ AI æŠ€æœ¯çš„é’¥åŒ™ã€‚LangChain1.0é€šè¿‡æ¶æ„ä¸åŠŸèƒ½å‡çº§ï¼Œç ´è§£äº†æ™ºèƒ½Agentå¼€å‘â€œçµæ´»ä¸ç¨³å®šéš¾å…¼é¡¾â€çš„æ ¸å¿ƒé—®é¢˜ï¼Œæ­é…LangGraphå¼•æ“å®ç°æ ‡å‡†åŒ–ç®¡ç†ï¼Œè®©å¼€å‘å’Œé›†æˆæ›´ç®€å•ã€‚å¯¹è¡Œä¸šè€Œè¨€ï¼ŒLangChain1.0çš„ç¨³å®šä¿éšœå’Œå…¼å®¹èƒ½åŠ›ï¼Œä½¿å…¶æˆä¸ºä¼ä¸šå¼€å‘çš„ä¼˜é€‰ã€‚å®ƒæ—¢èƒ½æ»¡è¶³å¤§å‹ä¼ä¸šçš„è§„æ¨¡åŒ–éœ€æ±‚ï¼Œä¹Ÿè®©ä¸­å°å¼€å‘è€…èƒ½è½»æ¾å°†åŸå‹è½åœ°ä¸ºå®ç”¨äº§å“ï¼ŒåŠ é€Ÿäº†æ™ºèƒ½Agentåœ¨å„è¡Œä¸šçš„åº”ç”¨ã€‚</p>
<h2 data-id="heading-22">å‚è€ƒ</h2>
<p><strong>Code</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flangchain-ai%2Flangchain" target="_blank" title="https://github.com/langchain-ai/langchain" ref="nofollow noopener noreferrer">github.com/langchain-aâ€¦</a></p>
<p><strong>Documentation</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com" target="_blank" title="https://docs.langchain.com" ref="nofollow noopener noreferrer">docs.langchain.com</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦ä¹  LiteLLM çš„ç¼“å­˜ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7576859594360193024</link>    <guid>https://juejin.cn/post/7576859594360193024</guid>    <pubDate>2025-11-27T00:26:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7576859594360193024" data-draft-id="7576867727718973475" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦ä¹  LiteLLM çš„ç¼“å­˜ç³»ç»Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-27T00:26:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—¥ä¹ ä¸€æŠ€"/> <meta itemprop="url" content="https://juejin.cn/user/3913917125896190"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦ä¹  LiteLLM çš„ç¼“å­˜ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3913917125896190/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—¥ä¹ ä¸€æŠ€
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.1 åˆå­¦ä¹ç»ƒ
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.1 åˆå­¦ä¹ç»ƒ" title="VIP.1 åˆå­¦ä¹ç»ƒ" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-27T00:26:04.000Z" title="Thu Nov 27 2025 00:26:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>éšç€æˆ‘ä»¬çš„ LLM ç½‘å…³æ‰¿è½½çš„æµé‡è¶Šæ¥è¶Šå¤§ã€æ¥å…¥çš„æ¨¡å‹è¶Šæ¥è¶Šå¤šï¼Œé™¤äº†ç¨³å®šæ€§å’Œå¯é æ€§ï¼Œ<strong>æˆæœ¬å’Œæ€§èƒ½</strong> ä¹Ÿæˆä¸ºäº†å…³é”®çš„è€ƒé‡å› ç´ ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬çš„åº”ç”¨æ¯å¤©éƒ½åœ¨å¤„ç†å¾ˆå¤šç›¸ä¼¼çš„æŸ¥è¯¢ï¼Œæ¯”å¦‚å®¢æœç³»ç»Ÿä¸­çš„å¸¸è§é—®é¢˜ã€ä»£ç ç”Ÿæˆä¸­çš„é‡å¤æ¨¡å¼ã€æ–‡æ¡£æ‘˜è¦ä¸­çš„ç›¸ä¼¼å†…å®¹ã€‚å¦‚æœæ¯æ¬¡éƒ½è°ƒç”¨çœŸå®çš„ LLM APIï¼Œä¸ä»…å»¶è¿Ÿé«˜ã€æˆæœ¬æ˜‚è´µï¼Œè¿˜å¯èƒ½è§¦å‘ä¾›åº”å•†çš„é€Ÿç‡é™åˆ¶ã€‚è€Œä¸”ï¼Œå¯¹äºç›¸åŒæˆ–ç›¸ä¼¼çš„æŸ¥è¯¢ï¼ŒLLM çš„å›ç­”å¾€å¾€æ˜¯ä¸€è‡´çš„æˆ–é«˜åº¦ç›¸ä¼¼çš„ï¼Œè¿™å°±ä¸ºç¼“å­˜çš„åº”ç”¨æä¾›äº†å¤©ç„¶çš„åŸºç¡€ã€‚</p>
<p>LiteLLM æä¾›äº†ä¸€å¥—å®Œæ•´çš„ç¼“å­˜è§£å†³æ–¹æ¡ˆï¼Œå®ƒä¸ä»…èƒ½å¤Ÿç¼“å­˜å®Œå…¨ç›¸åŒçš„è¯·æ±‚ï¼ˆç²¾ç¡®ç¼“å­˜ï¼‰ï¼Œè¿˜èƒ½å¤ŸåŸºäºè¯­ä¹‰ç›¸ä¼¼æ€§ç¼“å­˜ç›¸ä¼¼çš„è¯·æ±‚ï¼ˆè¯­ä¹‰ç¼“å­˜ï¼‰ï¼Œä»è€Œæ˜¾è‘—é™ä½æˆæœ¬ï¼Œå¹¶å¤§å¹…æå‡æ€§èƒ½ï¼ŒåŒæ—¶å‡è½»å¯¹ä¸Šæ¸¸ API çš„å‹åŠ›ï¼Œæé«˜äº†ç³»ç»Ÿç¨³å®šæ€§ã€‚</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±æ¥æ·±å…¥äº†è§£ä¸€ä¸‹ LiteLLM çš„ç¼“å­˜ç³»ç»Ÿã€‚</p>
<h2 data-id="heading-0">ç¼“å­˜ç±»å‹ä¸€è§ˆ</h2>
<p>LiteLLM æ”¯æŒ 8 ç§ä¸åŒçš„ç¼“å­˜åç«¯ï¼Œæ¯ç§éƒ½é’ˆå¯¹ç‰¹å®šçš„ä½¿ç”¨åœºæ™¯ï¼š</p>
<p><strong>ä¼ ç»Ÿç¼“å­˜</strong>ï¼š</p>
<ul>
<li><strong>å†…å­˜ç¼“å­˜ï¼ˆIn-Memoryï¼‰</strong>ï¼šæœ€å¿«çš„è®¿é—®é€Ÿåº¦ï¼Œé€‚åˆå•æœºéƒ¨ç½²å’Œå¼€å‘æµ‹è¯•</li>
<li><strong>ç£ç›˜ç¼“å­˜ï¼ˆDiskï¼‰</strong>ï¼šæŒä¹…åŒ–å­˜å‚¨ï¼Œé€‚åˆå•æœºé•¿æœŸç¼“å­˜</li>
<li><strong>Redis ç¼“å­˜</strong>ï¼šåˆ†å¸ƒå¼ç¼“å­˜ï¼Œé€‚åˆå¤šå®ä¾‹éƒ¨ç½²å’Œç”Ÿäº§ç¯å¢ƒ</li>
</ul>
<p><strong>äº‘å­˜å‚¨ç¼“å­˜</strong>ï¼š</p>
<ul>
<li><strong>S3 ç¼“å­˜</strong>ï¼šåˆ©ç”¨ AWS S3 è¿›è¡Œå¤§è§„æ¨¡ã€ä½æˆæœ¬çš„ç¼“å­˜å­˜å‚¨</li>
<li><strong>GCS ç¼“å­˜</strong>ï¼šåŸºäº Google Cloud Storage çš„ç¼“å­˜è§£å†³æ–¹æ¡ˆ</li>
<li><strong>Azure Blob ç¼“å­˜</strong>ï¼šå¾®è½¯ Azure çš„å¯¹è±¡å­˜å‚¨ç¼“å­˜</li>
</ul>
<p><strong>æ™ºèƒ½ç¼“å­˜</strong>ï¼š</p>
<ul>
<li><strong>Redis è¯­ä¹‰ç¼“å­˜</strong>ï¼šåŸºäºå‘é‡ç›¸ä¼¼åº¦çš„è¯­ä¹‰åŒ¹é…ç¼“å­˜</li>
<li><strong>Qdrant è¯­ä¹‰ç¼“å­˜</strong>ï¼šä¸“ä¸šå‘é‡æ•°æ®åº“çš„è¯­ä¹‰ç¼“å­˜è§£å†³æ–¹æ¡ˆ</li>
</ul>
<h2 data-id="heading-1">åŸºæœ¬ä½¿ç”¨</h2>
<p>é¦–å…ˆæˆ‘ä»¬æ¥ä½“éªŒä¸‹æœ€ç®€å•çš„å†…å­˜ç¼“å­˜ï¼Œåœ¨ <code>config.yaml</code> æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">litellm_settings:</span>
  <span class="hljs-attr">cache:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">cache_params:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">local</span>
</code></pre>
<p>ç„¶åé‡å¯ LiteLLM Proxy æœåŠ¡ã€‚å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X POST <span class="hljs-string">'http://127.0.0.1:4000/chat/completions'</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -d <span class="hljs-string">'{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "ç»™æˆ‘è®²ä¸ªç¬‘è¯"}]
  }'</span>
</code></pre>
<p>ç¬¬ä¸€æ¬¡è¯·æ±‚ä¼šè°ƒç”¨çœŸå®çš„ APIï¼Œè€—æ—¶å¯èƒ½åœ¨ 1-3 ç§’ã€‚å†å‘é€å®Œå…¨ç›¸åŒçš„è¯·æ±‚ï¼ˆåŠ äº† <code>-v</code> é€‰é¡¹ç”¨äºæ‰“å°å“åº”å¤´ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -v -X POST <span class="hljs-string">'http://127.0.0.1:4000/chat/completions'</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -d <span class="hljs-string">'{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "ç»™æˆ‘è®²ä¸ªç¬‘è¯"}]
  }'</span>
</code></pre>
<p>ç¬¬äºŒæ¬¡è¯·æ±‚ä»ç¼“å­˜è¿”å›ï¼Œè€—æ—¶é€šå¸¸åœ¨ 50-200 æ¯«ç§’ï¼Œå“åº”å¤´ä¸­ä¼šåŒ…å«ç¼“å­˜ç›¸å…³ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">x-litellm-cache-key: 6b86d8cb3ab300d7cbe071f93176e28cc25d9da7f2db95dd8ad078176faddc94</span>
</code></pre>
<blockquote>
<p>è¿™ä¸ª Key æ˜¯æ ¹æ®è¯·æ±‚å†…å®¹ç”Ÿæˆçš„ï¼Œç›¸åŒçš„è¯·æ±‚å‚æ•°ç”Ÿæˆçš„ Key ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p>
</blockquote>
<h2 data-id="heading-2">Redis ç¼“å­˜</h2>
<p>å†…å­˜ç¼“å­˜é€‚åˆå•æœºéƒ¨ç½²å’Œå¼€å‘æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸€èˆ¬ä½¿ç”¨ Redis ä½œä¸ºç¼“å­˜åç«¯ã€‚å¯ä»¥ç”¨ Docker åœ¨æœ¬åœ°å¿«é€Ÿå¯ä¸€ä¸ª Redis ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ docker run -d \
  --name redis-stack \
  -p 6379:6379 \
  -p 8001:8001 \
  redis/redis-stack:latest
</code></pre>
<p>æ³¨æ„æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ Redis Stack é•œåƒï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„é›†æˆè½¯ä»¶å¥—ä»¶ï¼Œåœ¨ Redis çš„åŸºç¡€ä¸Šï¼Œæ‰©å±•äº† <strong>æœç´¢ï¼ˆRedisSearchï¼‰</strong>ã€<strong>JSONï¼ˆRedisJSONï¼‰</strong>ã€<strong>å›¾æ•°æ®åº“ï¼ˆRedisGraphï¼‰</strong>ã€<strong>æ—¶é—´åºåˆ—ï¼ˆRedisTimeSeriesï¼‰</strong> å’Œ <strong>å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆRedisBloomï¼‰</strong> ç­‰åŠŸèƒ½ï¼Œæä¾›äº†æ›´ä¸°å¯Œçš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œé€‚ç”¨äºæ„å»ºå¤æ‚åº”ç”¨ã€‚ç›¸å¯¹äº Redis Server åªæ˜¯æ ¸å¿ƒçš„å†…å­˜æ•°æ®ç»“æ„å­˜å‚¨ï¼Œæ›´ä¾§é‡äºç¼“å­˜å’Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰åœºæ™¯ã€‚</p>
<p>æœ€ç®€å•çš„ Redis ç¼“å­˜é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">litellm_settings:</span>
  <span class="hljs-attr">cache:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">cache_params:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">redis</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>          <span class="hljs-comment"># Redis æœåŠ¡å™¨åœ°å€</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>               <span class="hljs-comment"># Redis ç«¯å£</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">your_password</span>  <span class="hljs-comment"># Redis å¯†ç ï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-attr">ttl:</span> <span class="hljs-number">600</span>                 <span class="hljs-comment"># é»˜è®¤ç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰</span>
</code></pre>
<blockquote>
<p>å¯¹äºå¤§è§„æ¨¡éƒ¨ç½²ï¼ŒLiteLLM æ”¯æŒé…ç½® Redis é›†ç¾¤æˆ–å“¨å…µã€‚</p>
</blockquote>
<p>éªŒè¯æ–¹æ³•å’Œå†…å­˜ç¼“å­˜ä¸€æ ·ï¼Œç¬¬äºŒæ¬¡è¯·æ±‚ä»ç¼“å­˜è¿”å›ï¼Œå¹¶ä¸”åœ¨ Redis ä¸­åº”è¯¥èƒ½æ‰¾åˆ° <code>x-litellm-cache-key</code> å¯¹åº”çš„ç¼“å­˜é”®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03d6c95633e64c9fa43ff307fee919a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764807964&amp;x-signature=jV67cpc4DlI4lWoemLFlwmJeTTQ%3D" alt="redis-key.png" loading="lazy"/></p>
<h2 data-id="heading-3">Redis è¯­ä¹‰ç¼“å­˜</h2>
<p>Redis ä¸ä»…å¯ä»¥ç”¨æ¥åšæ™®é€šç¼“å­˜ï¼Œè¿˜å¯ä»¥ç”¨æ¥åšå‘é‡æ•°æ®åº“ã€‚æˆ‘ä»¬å¯ä»¥å°†æ–‡æœ¬ã€å›¾åƒç­‰éç»“æ„åŒ–æ•°æ®è½¬æ¢ä¸ºå‘é‡ï¼Œå­˜å‚¨åˆ° Redis ä¸­ï¼Œå¹¶åˆ©ç”¨ Redis çš„å†…å­˜ä¼˜åŠ¿å®ç°æ¯«ç§’çº§çš„å‘é‡ç›¸ä¼¼æ€§æœç´¢ã€‚</p>
<p>LiteLLM åŸºäº Redis å‘é‡æ•°æ®åº“å®ç°äº†è¯­ä¹‰ç¼“å­˜åŠŸèƒ½ï¼Œ<strong>è¯­ä¹‰ç¼“å­˜</strong> ä¸åŒäºä¼ ç»Ÿçš„ç²¾ç¡®åŒ¹é…ç¼“å­˜ï¼Œå®ƒèƒ½å¤Ÿç†è§£æŸ¥è¯¢çš„è¯­ä¹‰å«ä¹‰ï¼Œå¹¶è¿”å›è¯­ä¹‰ç›¸ä¼¼æŸ¥è¯¢çš„ç¼“å­˜ç»“æœã€‚å³ä½¿è¿™äº›æŸ¥è¯¢çš„å­—é¢è¡¨è¾¾å®Œå…¨ä¸åŒï¼Œè¯­ä¹‰ç¼“å­˜ä¹Ÿèƒ½è¯†åˆ«å®ƒä»¬çš„ç›¸ä¼¼æ€§å¹¶è¿”å›ç›¸åŒçš„ç»“æœï¼Œå¤§å¤§æé«˜äº†ç¼“å­˜å‘½ä¸­ç‡ã€‚</p>
<p>Redis è¯­ä¹‰ç¼“å­˜åŸºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fredis%2Fredis-vl-python" target="_blank" title="https://github.com/redis/redis-vl-python" ref="nofollow noopener noreferrer">Redis Vector Library (RedisVL)</a> å®ç°ï¼Œé¦–å…ˆéœ€è¦å®‰è£…ä¾èµ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ pip install redisvl==0.4.1
</code></pre>
<p>ç„¶ååœ¨ LiteLLM çš„é…ç½®æ–‡ä»¶ä¸­å¼€å¯ Redis è¯­ä¹‰ç¼“å­˜ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">litellm_settings:</span>
  <span class="hljs-attr">cache:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">cache_params:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">redis-semantic</span>              <span class="hljs-comment"># è¯­ä¹‰ç¼“å­˜ç±»å‹</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">your_password</span>
    <span class="hljs-attr">ttl:</span> <span class="hljs-number">600</span>
    <span class="hljs-attr">similarity_threshold:</span> <span class="hljs-number">0.8</span>                                     <span class="hljs-comment"># ç›¸ä¼¼åº¦é˜ˆå€¼ï¼ˆ0-1ï¼Œ1ä¸ºå®Œå…¨åŒ¹é…ï¼‰</span>
    <span class="hljs-attr">redis_semantic_cache_embedding_model:</span> <span class="hljs-string">text-embedding-3-large</span>  <span class="hljs-comment"># åµŒå…¥æ¨¡å‹åç§°</span>
</code></pre>
<p>å…¶ä¸­ <code>similarity_threshold</code> ä¸ºç›¸ä¼¼åº¦é˜ˆå€¼ï¼ŒèŒƒå›´ <code>[0-1]</code>ï¼Œ<code>redis_semantic_cache_embedding_model</code> ä¸ºåµŒå…¥æ¨¡å‹åç§°ï¼Œå¿…é¡»æ˜¯åœ¨ <code>model_list</code> ä¸­å®šä¹‰ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œå¦‚æœä½ çš„ Redis æ²¡æœ‰å¯†ç ï¼Œå¯åŠ¨å¯èƒ½ä¼šæŠ¥é”™ <code>Missing required Redis configuration: REDIS_PASSWORD</code>ã€‚è®¾ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡ <code>export REDIS_PASSWORD=</code> å³å¯ã€‚</p>
</blockquote>
<p>å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªç›¸ä¼¼çš„è¯·æ±‚æ¥éªŒè¯ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X POST <span class="hljs-string">'http://127.0.0.1:4000/chat/completions'</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -d <span class="hljs-string">'{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ"}]
  }'</span>
</code></pre>
<p>ç¬¬äºŒæ¬¡è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -v -X POST <span class="hljs-string">'http://127.0.0.1:4000/chat/completions'</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -d <span class="hljs-string">'{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "AI æ˜¯ä»€ä¹ˆï¼Ÿ"}]
  }'</span>
</code></pre>
<p>ç¬¬äºŒæ¬¡è¯·æ±‚çš„å“åº”å¤´ä¸­ä¸ä»…åŒ…å«äº†ç¼“å­˜ Keyï¼Œè¿˜åŒ…å«äº†ç›¸ä¼¼åº¦ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">x-litellm-cache-key: 9cdf6246deaee1f8d96aa8b093029bc129f7eca32f2f8f4a9fd0352138e6ea3e</span>
<span class="hljs-section">x-litellm-semantic-similarity: 0.162912428379</span>
</code></pre>
<p>æˆ‘ä»¬æ‰“å¼€ Redis ç®¡ç†é¡µé¢ï¼Œå¯ä»¥å‘ç°å¤šäº†ä¸€ä¸ª <code>litellm_semantic_cache_index</code> å¼€å¤´çš„é”®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cebfd18f60c24385987a334469927b93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764807964&amp;x-signature=4trFxZz1cBm0FgXZmnLWLHxxUMg%3D" alt="redis-sematic-key.png" loading="lazy"/></p>
<p>å®ƒçš„å†…å®¹åŒ…å«äº†è¯·æ±‚çš„ Prompt å’Œå¯¹åº”çš„å“åº”ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c35b89dd8fd4124b3e413a15801b4a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764807964&amp;x-signature=xwH6N6yVVCsB6JB%2FkjyoqGUqXto%3D" alt="redis-sematic-value.png" loading="lazy"/></p>
<h3 data-id="heading-4">RedisVL åº“ä»‹ç»</h3>
<p><strong>RedisVL (Redis Vector Library)</strong> æ˜¯ Redis å®˜æ–¹æä¾›çš„ Python å®¢æˆ·ç«¯åº“ï¼Œä¸“ä¸º AI åº”ç”¨è®¾è®¡ï¼Œæä¾›äº†é«˜çº§çš„å‘é‡æœç´¢æŠ½è±¡ï¼Œä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>ç®€åŒ–çš„ API</strong>ï¼šé«˜çº§æŠ½è±¡ï¼Œç®€åŒ–å‘é‡æœç´¢æ“ä½œ</li>
<li><strong>å¼ºå¤§çš„æŸ¥è¯¢èƒ½åŠ›</strong>ï¼šæ”¯æŒæ··åˆæŸ¥è¯¢ã€è¿‡æ»¤æ¡ä»¶ã€èšåˆç­‰</li>
<li><strong>è¯­ä¹‰ç¼“å­˜</strong>ï¼šä¸“é—¨ä¸º LLM ç¼“å­˜ä¼˜åŒ–çš„ LLMCache ç»„ä»¶ï¼ŒLiteLLM çš„ Redis è¯­ä¹‰ç¼“å­˜å°±æ˜¯åŸºäºå®ƒå®ç°çš„</li>
</ul>
<p>è¿™ä¸€èŠ‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•ç¤ºä¾‹å­¦ä¹ å®ƒçš„åŸºæœ¬ä½¿ç”¨ã€‚</p>
<p>é¦–å…ˆé€šè¿‡ Schema åˆ›å»ºç´¢å¼•ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> redisvl.index <span class="hljs-keyword">import</span> SearchIndex
<span class="hljs-keyword">from</span> redis <span class="hljs-keyword">import</span> Redis

<span class="hljs-comment"># åˆ›å»ºè¿æ¥</span>
client = Redis.from_url(<span class="hljs-string">"redis://localhost:6379"</span>)

<span class="hljs-comment"># ä½¿ç”¨å­—å…¸å®šä¹‰ Schema</span>
schema = {
  <span class="hljs-string">"index"</span>: {
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"product_index"</span>,
    <span class="hljs-string">"prefix"</span>: <span class="hljs-string">"product:"</span>,
  },
  <span class="hljs-string">"fields"</span>: [
    {<span class="hljs-string">"name"</span>: <span class="hljs-string">"title"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>},
    {<span class="hljs-string">"name"</span>: <span class="hljs-string">"brand"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"tag"</span>},
    {<span class="hljs-string">"name"</span>: <span class="hljs-string">"price"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"numeric"</span>},
    {<span class="hljs-string">"name"</span>: <span class="hljs-string">"category"</span>, <span class="hljs-string">"type"</span>: <span class="hljs-string">"tag"</span>},
    {
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"description_vector"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"vector"</span>,
      <span class="hljs-string">"attrs"</span>: {
        <span class="hljs-string">"dims"</span>: <span class="hljs-number">3072</span>,  <span class="hljs-comment"># å‘é‡ç»´åº¦</span>
        <span class="hljs-string">"distance_metric"</span>: <span class="hljs-string">"cosine"</span>,  <span class="hljs-comment"># è·ç¦»åº¦é‡</span>
        <span class="hljs-string">"algorithm"</span>: <span class="hljs-string">"flat"</span>,  <span class="hljs-comment"># å‘é‡ç´¢å¼•ç®—æ³•</span>
        <span class="hljs-string">"datatype"</span>: <span class="hljs-string">"float32"</span>
      }
    }
  ]
}

<span class="hljs-comment"># åˆ›å»ºç´¢å¼•</span>
index = SearchIndex.from_dict(schema, redis_client=client)
index.create(overwrite=<span class="hljs-literal">True</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç´¢å¼•åˆ›å»ºæˆåŠŸï¼"</span>)
</code></pre>
<p>è¿™æ˜¯ä¸€ä¸ªäº§å“è¡¨ï¼ŒåŒ…å«äº§å“çš„åç§°ã€å“ç‰Œã€åˆ†ç±»ã€ä»·æ ¼ã€æè¿°ç­‰ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¸ºæè¿°åŠ ä¸€ä¸ªå‘é‡å­—æ®µï¼Œç”¨äºè¯­ä¹‰æœç´¢ã€‚</p>
<blockquote>
<p>å…¶ä¸­å‘é‡ç»´åº¦æ ¹æ®ä½ ä½¿ç”¨çš„ Embedding æ¨¡å‹æ¥å®šä¹‰ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ OpenAI çš„ <code>text-embedding-3-large</code> æ¨¡å‹ï¼Œç»´åº¦æ˜¯ 3072 ç»´ã€‚</p>
</blockquote>
<p>æ¥ç€å®šä¹‰ä¸€æ‰¹ç¤ºä¾‹æ•°æ®ï¼ŒåŠ è½½åˆ° Redis ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> litellm <span class="hljs-keyword">import</span> embedding

<span class="hljs-comment"># å®šä¹‰äº§å“æ•°æ®</span>
products = [
  {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"p001"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"iPhone 15 Pro Max"</span>,
    <span class="hljs-string">"brand"</span>: <span class="hljs-string">"Apple"</span>,
    <span class="hljs-string">"category"</span>: <span class="hljs-string">"smartphone"</span>,
    <span class="hljs-string">"price"</span>: <span class="hljs-number">1199</span>,
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"æœ€æ–°çš„ iPhoneï¼Œé…å¤‡ A17 Pro èŠ¯ç‰‡ï¼Œ48MP ä¸»æ‘„åƒå¤´ï¼Œé’›é‡‘å±æœºèº«"</span>
  },
  {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"p002"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"MacBook Pro 14è‹±å¯¸"</span>,
    <span class="hljs-string">"brand"</span>: <span class="hljs-string">"Apple"</span>,
    <span class="hljs-string">"category"</span>: <span class="hljs-string">"laptop"</span>,
    <span class="hljs-string">"price"</span>: <span class="hljs-number">1999</span>,
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"æ­è½½ M3 èŠ¯ç‰‡çš„ä¸“ä¸šç¬”è®°æœ¬ç”µè„‘ï¼Œé€‚åˆå¼€å‘è€…å’Œåˆ›æ„å·¥ä½œè€…"</span>
  },
  {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"p003"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"AirPods Pro"</span>,
    <span class="hljs-string">"brand"</span>: <span class="hljs-string">"Apple"</span>,
    <span class="hljs-string">"category"</span>: <span class="hljs-string">"audio"</span>,
    <span class="hljs-string">"price"</span>: <span class="hljs-number">249</span>,
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"ä¸»åŠ¨é™å™ªæ— çº¿è€³æœºï¼Œç©ºé—´éŸ³é¢‘æŠ€æœ¯ï¼Œé€æ˜æ¨¡å¼"</span>
  },
  {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"p004"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Samsung Galaxy S24"</span>,
    <span class="hljs-string">"brand"</span>: <span class="hljs-string">"Samsung"</span>,
    <span class="hljs-string">"category"</span>: <span class="hljs-string">"smartphone"</span>,
    <span class="hljs-string">"price"</span>: <span class="hljs-number">899</span>,
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"Android æ——èˆ°æ‰‹æœºï¼ŒAI æ‘„å½±åŠŸèƒ½ï¼Œ120Hz æ˜¾ç¤ºå±"</span>
  },
  {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"p005"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Dell XPS 13"</span>,
    <span class="hljs-string">"brand"</span>: <span class="hljs-string">"Dell"</span>,
    <span class="hljs-string">"category"</span>: <span class="hljs-string">"laptop"</span>,
    <span class="hljs-string">"price"</span>: <span class="hljs-number">1299</span>,
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"è½»è–„ç¬”è®°æœ¬ç”µè„‘ï¼Œ13.3è‹±å¯¸ 4K è§¦æ‘¸å±ï¼ŒIntel å¤„ç†å™¨"</span>
  }
]

<span class="hljs-comment"># ç”Ÿæˆå‘é‡åµŒå…¥</span>
<span class="hljs-keyword">for</span> product <span class="hljs-keyword">in</span> products:
  response = embedding(<span class="hljs-string">'text-embedding-3-large'</span>, product[<span class="hljs-string">"description"</span>])
  product[<span class="hljs-string">"description_vector"</span>] = np.array(response.data[<span class="hljs-number">0</span>][<span class="hljs-string">'embedding'</span>], dtype=np.float32).tobytes()

<span class="hljs-comment"># åŠ è½½äº§å“æ•°æ®åˆ° Redis</span>
<span class="hljs-keyword">for</span> product <span class="hljs-keyword">in</span> products:
  index.load([product], id_field=<span class="hljs-string">"id"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æˆåŠŸåŠ è½½ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(products)}</span> ä¸ªäº§å“åˆ°ç´¢å¼•ä¸­"</span>)
</code></pre>
<p>æˆ‘ä»¬ä¸ºæ¯ä¸ªäº§å“çš„æè¿°ç”Ÿæˆå¯¹åº”çš„å‘é‡ï¼Œå¹¶é€šè¿‡ <code>index.load()</code> å°†äº§å“æ•°æ®åŠ è½½åˆ° Redis ä¸­ã€‚æ¥ä¸‹æ¥å°±å¯ä»¥æ‰§è¡Œæœç´¢äº†ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> redisvl.index <span class="hljs-keyword">import</span> SearchIndex
<span class="hljs-keyword">from</span> redisvl.query <span class="hljs-keyword">import</span> VectorQuery

<span class="hljs-comment"># ä½¿ç”¨å·²æœ‰ç´¢å¼•</span>
index = SearchIndex.from_existing(<span class="hljs-string">'product_index'</span>, client)

<span class="hljs-comment"># ç”ŸæˆæŸ¥è¯¢å‘é‡</span>
response = embedding(<span class="hljs-string">'text-embedding-3-large'</span>, <span class="hljs-string">"é€‚åˆç¨‹åºå‘˜çš„ç”µè„‘"</span>)
query_vector = np.array(response.data[<span class="hljs-number">0</span>][<span class="hljs-string">'embedding'</span>], dtype=np.float32).tobytes()

<span class="hljs-comment"># åˆ›å»ºå‘é‡æŸ¥è¯¢</span>
vector_query = VectorQuery(
  vector=query_vector,
  vector_field_name=<span class="hljs-string">"description_vector"</span>,
  return_fields=[<span class="hljs-string">"title"</span>, <span class="hljs-string">"brand"</span>, <span class="hljs-string">"category"</span>, <span class="hljs-string">"price"</span>, <span class="hljs-string">"description"</span>],
  num_results=<span class="hljs-number">3</span>,
)

<span class="hljs-comment"># æ‰§è¡Œæœç´¢</span>
results = index.query(vector_query)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næŸ¥è¯¢: 'é€‚åˆç¨‹åºå‘˜çš„ç”µè„‘'"</span>)
<span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> results:
  score = <span class="hljs-number">1</span> - <span class="hljs-built_in">float</span>(doc[<span class="hljs-string">'vector_distance'</span>])  <span class="hljs-comment"># è½¬æ¢ä¸ºç›¸ä¼¼åº¦åˆ†æ•°</span>
  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"- <span class="hljs-subst">{doc[<span class="hljs-string">'title'</span>]}</span> (<span class="hljs-subst">{doc[<span class="hljs-string">'brand'</span>]}</span>) - ç›¸ä¼¼åº¦: <span class="hljs-subst">{score:<span class="hljs-number">.3</span>f}</span>"</span>)
  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  ä»·æ ¼: $<span class="hljs-subst">{doc[<span class="hljs-string">'price'</span>]}</span> | æè¿°: <span class="hljs-subst">{doc[<span class="hljs-string">'description'</span>]}</span>"</span>)
</code></pre>
<p>æœç´¢ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">æŸ¥è¯¢: <span class="hljs-string">'é€‚åˆç¨‹åºå‘˜çš„ç”µè„‘'</span>
- MacBook Pro 14è‹±å¯¸ (Apple) - ç›¸ä¼¼åº¦: 0.570
  ä»·æ ¼: <span class="hljs-variable">$1999</span> | æè¿°: æ­è½½ M3 èŠ¯ç‰‡çš„ä¸“ä¸šç¬”è®°æœ¬ç”µè„‘ï¼Œé€‚åˆå¼€å‘è€…å’Œåˆ›æ„å·¥ä½œè€…
- Dell XPS 13 (Dell) - ç›¸ä¼¼åº¦: 0.435
  ä»·æ ¼: <span class="hljs-variable">$1299</span> | æè¿°: è½»è–„ç¬”è®°æœ¬ç”µè„‘ï¼Œ13.3è‹±å¯¸ 4K è§¦æ‘¸å±ï¼ŒIntel å¤„ç†å™¨
- iPhone 15 Pro Max (Apple) - ç›¸ä¼¼åº¦: 0.293
  ä»·æ ¼: <span class="hljs-variable">$1199</span> | æè¿°: æœ€æ–°çš„ iPhoneï¼Œé…å¤‡ A17 Pro èŠ¯ç‰‡ï¼Œ48MP ä¸»æ‘„åƒå¤´ï¼Œé’›é‡‘å±æœºèº«
</code></pre>
<h2 data-id="heading-5">ç¼“å­˜æ§åˆ¶å‚æ•°</h2>
<p>LiteLLM æä¾›äº†çµæ´»çš„ç¼“å­˜æ§åˆ¶æœºåˆ¶ï¼Œå…è®¸åœ¨è¯·æ±‚çº§åˆ«åŠ¨æ€æ§åˆ¶ç¼“å­˜è¡Œä¸ºã€‚è¿™äº›æ§åˆ¶å‚æ•°å€Ÿé‰´äº† HTTP ç¼“å­˜æ§åˆ¶çš„è®¾è®¡ç†å¿µï¼Œæä¾›äº†ç»†ç²’åº¦çš„ç¼“å­˜ç®¡ç†èƒ½åŠ›ã€‚</p>









































<table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>ttl</code></td><td>int</td><td>æŒ‡å®šç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰</td><td>çŸ­æœŸç¼“å­˜ã€æ—¶æ•ˆæ€§å†…å®¹</td></tr><tr><td><code>s-maxage</code></td><td>int</td><td>åªæ¥å—æŒ‡å®šæ—¶é—´å†…çš„ç¼“å­˜ï¼ˆç§’ï¼‰</td><td>å¼ºåˆ¶åˆ·æ–°ã€æ•°æ®ä¸€è‡´æ€§</td></tr><tr><td><code>no-cache</code></td><td>bool</td><td>è·³è¿‡ç¼“å­˜è¯»å–ï¼Œå¼ºåˆ¶è°ƒç”¨ API</td><td>éœ€è¦æœ€æ–°æ•°æ®</td></tr><tr><td><code>no-store</code></td><td>bool</td><td>ä¸å­˜å‚¨å“åº”åˆ°ç¼“å­˜</td><td>æ•æ„Ÿå†…å®¹ã€ä¸€æ¬¡æ€§æŸ¥è¯¢</td></tr><tr><td><code>namespace</code></td><td>str</td><td>è‡ªå®šä¹‰ç¼“å­˜å‘½åç©ºé—´</td><td>å¤šç§Ÿæˆ·ã€ç¯å¢ƒéš”ç¦»</td></tr></tbody></table>
<h3 data-id="heading-6">åŠ¨æ€ TTL æ§åˆ¶</h3>
<p>å‚æ•° <code>ttl</code> ç”¨äºæ§åˆ¶ç¼“å­˜æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä¸åŒç±»å‹çš„è¯·æ±‚è®¾ç½®ä¸åŒçš„ç¼“å­˜æ—¶é—´ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é•¿æœŸç¼“å­˜ï¼šç™¾ç§‘ç±»çŸ¥è¯†</span>
response = client.chat.completions.create(
  model=<span class="hljs-string">"gpt-4o"</span>,
  messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä»€ä¹ˆæ˜¯é‡å­è®¡ç®—ï¼Ÿ"</span>}],
  extra_body={
    <span class="hljs-string">"cache"</span>: {
      <span class="hljs-string">"ttl"</span>: <span class="hljs-number">86400</span>  <span class="hljs-comment"># ç¼“å­˜ 24 å°æ—¶</span>
    }
  }
)

<span class="hljs-comment"># çŸ­æœŸç¼“å­˜ï¼šå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„å†…å®¹</span>
response = client.chat.completions.create(
  model=<span class="hljs-string">"gpt-4o"</span>,
  messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä»Šå¤©çš„è‚¡å¸‚è¡¨ç°å¦‚ä½•ï¼Ÿ"</span>}],
  extra_body={
    <span class="hljs-string">"cache"</span>: {
      <span class="hljs-string">"ttl"</span>: <span class="hljs-number">300</span>  <span class="hljs-comment"># ç¼“å­˜ 5 åˆ†é’Ÿ</span>
    }
  }
)
</code></pre>
<h3 data-id="heading-7">ç¼“å­˜å¹´é¾„æ§åˆ¶</h3>
<p>å‚æ•° <code>s-maxage</code> æ§åˆ¶åªæ¥å—æŒ‡å®šå¹´é¾„å†…çš„ç¼“å­˜ï¼š</p>
<pre><code class="hljs language-python" lang="python">response = client.chat.completions.create(
  model=<span class="hljs-string">"gpt-4o"</span>,
  messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æœ€æ–°çš„è‚¡ç¥¨ä»·æ ¼"</span>}],
  extra_body={
    <span class="hljs-string">"cache"</span>: {
      <span class="hljs-string">"s-maxage"</span>: <span class="hljs-number">60</span>  <span class="hljs-comment"># åªæ¥å— 1 åˆ†é’Ÿå†…çš„ç¼“å­˜</span>
    }
  }
)
</code></pre>
<h3 data-id="heading-8">å¼ºåˆ¶åˆ·æ–°ç¼“å­˜</h3>
<p>å½“éœ€è¦è·å–æœ€æ–°ç»“æœæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>no-cache</code> å¼ºåˆ¶ç»•è¿‡ç¼“å­˜ï¼š</p>
<pre><code class="hljs language-python" lang="python">response = client.chat.completions.create(
  model=<span class="hljs-string">"gpt-4o"</span>,
  messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æœ€æ–°çš„è‚¡ç¥¨ä»·æ ¼"</span>}],
  extra_body={
    <span class="hljs-string">"cache"</span>: {
      <span class="hljs-string">"no-cache"</span>: <span class="hljs-literal">True</span>  <span class="hljs-comment"># è·³è¿‡ç¼“å­˜æ£€æŸ¥</span>
    }
  }
)
</code></pre>
<h3 data-id="heading-9">ç¦ç”¨ç¼“å­˜å­˜å‚¨</h3>
<p>å¯¹äºåŒ…å«æ•æ„Ÿä¿¡æ¯çš„æŸ¥è¯¢ï¼Œå¯ä»¥ä½¿ç”¨ <code>no-store</code> ä¸ç¼“å­˜å½“å‰å“åº”ï¼š</p>
<pre><code class="hljs language-python" lang="python">response = client.chat.completions.create(
  model=<span class="hljs-string">"gpt-4o"</span>,
  messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æ•æ„Ÿä¿¡æ¯æŸ¥è¯¢"</span>}],
  extra_body={
    <span class="hljs-string">"cache"</span>: {
      <span class="hljs-string">"no-store"</span>: <span class="hljs-literal">True</span>  <span class="hljs-comment"># ä¸å­˜å‚¨æ­¤å“åº”</span>
    }
  }
)
</code></pre>
<h3 data-id="heading-10">å‘½åç©ºé—´éš”ç¦»</h3>
<p>åœ¨å¤šç§Ÿæˆ·æˆ–å¤šç¯å¢ƒåœºæ™¯ä¸­ï¼ŒLiteLLM æ”¯æŒå‘½åç©ºé—´æ¥å®ç°ç¼“å­˜éš”ç¦»ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">litellm_settings:</span>
  <span class="hljs-attr">cache:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">cache_params:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">redis</span>
    <span class="hljs-attr">namespace:</span> <span class="hljs-string">"litellm.production"</span>  <span class="hljs-comment"># å‘½åç©ºé—´å‰ç¼€</span>
</code></pre>
<p>è¿™æ ·å­˜å‚¨åœ¨ Redis ä¸­çš„é”®å°†å˜æˆ <code>{namespace}:&lt;hash&gt;</code> æ ¼å¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨è¯·æ±‚å‚æ•°ä¸­åŠ¨æ€æ§åˆ¶ï¼Œä¸ºä¸åŒçš„ç”¨æˆ·æˆ–åº”ç”¨ä½¿ç”¨ç‹¬ç«‹çš„ç¼“å­˜ç©ºé—´ï¼š</p>
<pre><code class="hljs language-python" lang="python">response = client.chat.completions.create(
  model=<span class="hljs-string">"gpt-4o"</span>,
  messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"Hello"</span>}],
  extra_body={
    <span class="hljs-string">"cache"</span>: {
      <span class="hljs-string">"namespace"</span>: <span class="hljs-string">"user:12345"</span>  <span class="hljs-comment"># ç”¨æˆ·ä¸“ç”¨å‘½åç©ºé—´</span>
    }
  }
)
</code></pre>
<h3 data-id="heading-11">é»˜è®¤å…³é—­æ¨¡å¼</h3>
<p>å¯¹äºéœ€è¦ä¸¥æ ¼æ§åˆ¶çš„åœºæ™¯ï¼Œå¯ä»¥å°†ç¼“å­˜è®¾ç½®ä¸ºé»˜è®¤å…³é—­ï¼Œåªåœ¨éœ€è¦æ—¶æ˜¾å¼å¯ç”¨ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">litellm_settings:</span>
  <span class="hljs-attr">cache:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">cache_params:</span>
    <span class="hljs-attr">mode:</span> <span class="hljs-string">default_off</span>  <span class="hljs-comment"># ç¼“å­˜é»˜è®¤å…³é—­</span>
</code></pre>
<p>å®¢æˆ·ç«¯éœ€è¦æ˜¾å¼å¯ç”¨ç¼“å­˜ï¼š</p>
<pre><code class="hljs language-python" lang="python">response = client.chat.completions.create(
  model=<span class="hljs-string">"gpt-4o"</span>,
  messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"Hello"</span>}],
  extra_body={
    <span class="hljs-string">"cache"</span>: {<span class="hljs-string">"use-cache"</span>: <span class="hljs-literal">True</span>}  <span class="hljs-comment"># æ˜¾å¼å¯ç”¨ç¼“å­˜</span>
  }
)
</code></pre>
<h2 data-id="heading-12">å°ç»“</h2>
<p>æˆ‘ä»¬ä»Šå¤©ç®€å•å­¦ä¹ äº† LiteLLM çš„ç¼“å­˜ç³»ç»Ÿã€‚LiteLLM æä¾›äº†ä»ç®€å•çš„å†…å­˜ç¼“å­˜åˆ°å¤æ‚çš„è¯­ä¹‰ç¼“å­˜ç­‰å¤šç§é€‰æ‹©ï¼Œæ¯ç§ç¼“å­˜éƒ½æœ‰å…¶ç‰¹å®šçš„é€‚ç”¨åœºæ™¯ï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚çµæ´»é€‰æ‹©æœ€åˆé€‚çš„ç¼“å­˜ç­–ç•¥ã€‚æ­¤å¤–ï¼ŒLiteLLM çš„ç¼“å­˜æ§åˆ¶å‚æ•°æä¾›äº†ç»†ç²’åº¦çš„ç¼“å­˜ç®¡ç†èƒ½åŠ›ï¼Œä½¿å¼€å‘è€…èƒ½å¤ŸåŠ¨æ€è°ƒæ•´ç¼“å­˜è¡Œä¸ºï¼Œä»¥é€‚åº”ä¸åŒåœºæ™¯çš„éœ€æ±‚ã€‚</p>
<p>é€šè¿‡åˆç†é…ç½®å’Œä½¿ç”¨è¿™äº›ç¼“å­˜åŠŸèƒ½ï¼Œåº”ç”¨å¯ä»¥æ›´å¥½åœ°å¤„ç†é‡å¤æ€§å’Œç›¸ä¼¼æ€§çš„æŸ¥è¯¢ï¼Œæœ‰æ•ˆé™ä½å¯¹ä¸Šæ¸¸ LLM API çš„å‹åŠ›ï¼Œæå‡ç³»ç»Ÿçš„ç¨³å®šæ€§ä¸å“åº”é€Ÿåº¦ã€‚</p>
<h2 data-id="heading-13">æ¬¢è¿å…³æ³¨</h2>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„åŒåå…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fi-study-everyday.online%2Fabout-me.html" target="_blank" title="https://i-study-everyday.online/about-me.html" ref="nofollow noopener noreferrer">æ—¥ä¹ ä¸€æŠ€ï¼Œæ¯å¤©å­¦ä¸€ç‚¹æ–°æŠ€æœ¯</a>ã€‚</p>
<p>æˆ‘ä¼šæ¯å¤©èŠ±ä¸€ä¸ªå°æ—¶ï¼Œè®°å½•ä¸‹æˆ‘å­¦ä¹ çš„ç‚¹ç‚¹æ»´æ»´ã€‚å†…å®¹åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>æŸä¸ªäº§å“çš„ä½¿ç”¨å°çªé—¨</li>
<li>å¼€æºé¡¹ç›®çš„å®è·µå’Œå¿ƒå¾—</li>
<li>æŠ€æœ¯ç‚¹çš„ç®€å•è§£è¯»</li>
</ul>
<p>ç›®æ ‡æ˜¯è®©å¤§å®¶ç”¨5åˆ†é’Ÿè¯»å®Œå°±èƒ½æœ‰æ‰€æ”¶è·ï¼Œä¸éœ€è¦å¤ªè´¹åŠ²ï¼Œä½†å´å¯ä»¥è½»æ¾è·å–ä¸€äº›å¹²è´§ã€‚ä¸ç®¡ä½ æ˜¯æŠ€æœ¯æ–°æ‰‹è¿˜æ˜¯è€é¸Ÿï¼Œæ¬¢è¿ç»™æˆ‘æå»ºè®®ï¼Œå¦‚æœæœ‰æƒ³å­¦ä¹ çš„æŠ€æœ¯ï¼Œä¹Ÿæ¬¢è¿äº¤æµï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Angularå¼€å‘è€…å¿…çœ‹ï¼šæ·±åº¦è§£æå•å…ƒæµ‹è¯•æ ¸å¿ƒæŠ€å·§ä¸æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7576859594360471552</link>    <guid>https://juejin.cn/post/7576859594360471552</guid>    <pubDate>2025-11-27T01:21:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7576859594360471552" data-draft-id="7570243451725725723" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Angularå¼€å‘è€…å¿…çœ‹ï¼šæ·±åº¦è§£æå•å…ƒæµ‹è¯•æ ¸å¿ƒæŠ€å·§ä¸æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="Angular.js,å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-11-27T01:21:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="DevUIå›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/712139267650141"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Angularå¼€å‘è€…å¿…çœ‹ï¼šæ·±åº¦è§£æå•å…ƒæµ‹è¯•æ ¸å¿ƒæŠ€å·§ä¸æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="container team-follow" data-v-d326b38e="" data-v-61fb5e44=""><div class="left" data-v-d326b38e=""><a href="/team/6930890095402844163/posts" data-v-d326b38e=""><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6975547f58f744ae8fa9c79ba0a60c3b~tplv-k3u1fbpfcp-watermark.image" class="icon" data-v-d326b38e=""/></a> <div class="content" data-v-d326b38e=""><div style="display: flex" data-v-d326b38e=""><a href="/team/6930890095402844163/posts" data-v-d326b38e=""><p class="title-line" data-v-d326b38e=""><span title="DevUIå›¢é˜Ÿ" class="title" data-v-d326b38e="">DevUIå›¢é˜Ÿ</span> <img src="//lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/255e400027b783cbad76dc41527e7695.svg" alt="team icon" class="team-icon" data-v-d326b38e=""/></p></a></div> <div class="meta-box team" data-v-d326b38e="" data-v-61fb5e44=""><time datetime="2025-11-27T01:21:00.000Z" title="Thu Nov 27 2025 01:21:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-d326b38e="" data-v-61fb5e44="">
                2025-11-27
              </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-d326b38e="" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/></svg> <span class="views-count" style="display:none;" data-v-d326b38e="" data-v-61fb5e44="">
                7
              </span> <span class="read-time" data-v-d326b38e="" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d326b38e="" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-d326b38e="" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-d326b38e="" data-v-61fb5e44=""/></svg>
                é˜…è¯»6åˆ†é’Ÿ
              </span> <!----> <!----></div></div></div> <button class="jj-follow-button follow-btn" style="display:none;" data-v-b60b2868="" data-v-d326b38e=""><span data-v-b60b2868="" data-v-d326b38e=""><i class="byte-icon byte-icon--plus" data-v-d326b38e=""><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"/><path d="M24.7 4c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8V22h16.7c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8v1.4c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1H26v16.7c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1h-1.4c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8V26H5.3c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8v-1.4c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1H22V5.3c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1h1.4z"/></svg></i>
        å…³æ³¨
      </span></button></div> <div class="team-user block-hidden" data-v-61fb5e44=""><div class="avatar jj-avatar avatar" data-v-03256cc6="" data-v-61fb5e44=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="avatar" class="lazy avatar-img" data-v-5244ef91="" data-v-03256cc6=""/> </div> <!----> <span class="position ellipsis" data-v-61fb5e44="">
              å‰ç«¯è§£å†³æ–¹æ¡ˆé›† @åä¸º
            </span></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ„Ÿè°¢DevUIç¤¾åŒºè´¡çŒ®è€… <strong><a href="https://juejin.cn/user/649151231836217" target="_blank" title="https://juejin.cn/user/649151231836217">tian_ya</a></strong> æä¾›çš„ä¼˜è´¨å¥½æ–‡ï¼</p>
</blockquote>
<h2 data-id="heading-0">Angularå¼€å‘è€…å¿…çœ‹ï¼šæ·±åº¦è§£æå•å…ƒæµ‹è¯•æ ¸å¿ƒæŠ€å·§ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-1">ä¸€ã€å‰è¨€</h3>
<p><strong>1. ä»€ä¹ˆæ˜¯å•å…ƒæµ‹è¯•</strong></p>
<ul>
<li>å®šä¹‰ï¼šå•å…ƒæµ‹è¯•æ˜¯é’ˆå¯¹è½¯ä»¶ä¸­çš„æœ€å°å¯æµ‹è¯•å•å…ƒï¼ˆå¦‚å‡½æ•°ã€æ–¹æ³•æˆ–ç±»ï¼‰è¿›è¡Œçš„æµ‹è¯•ï¼Œä»¥éªŒè¯å…¶æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</li>
<li>ç›®æ ‡ï¼šç¡®ä¿ä»£ç çš„æ­£ç¡®æ€§ã€å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li>
<li>ä¸åŒæµ‹è¯•é˜¶æ®µçš„åŒºåˆ«ï¼š
<ul>
<li>å•å…ƒæµ‹è¯•ï¼šæµ‹è¯•ä»£ç çš„æœ€å°å•å…ƒã€‚</li>
<li>é›†æˆæµ‹è¯•ï¼šæµ‹è¯•ä¸åŒæ¨¡å—ä¹‹é—´çš„äº¤äº’ã€‚</li>
<li>ç³»ç»Ÿæµ‹è¯•ï¼šæ•´ä½“ç³»ç»Ÿæ˜¯å¦æ»¡è¶³éœ€æ±‚ã€‚</li>
<li>éªŒæ”¶æµ‹è¯•ï¼šä»ç”¨æˆ·è§’åº¦æµ‹è¯•åŠŸèƒ½æ˜¯å¦ç¬¦åˆéœ€æ±‚ã€‚</li>
</ul>
</li>
</ul>
<p><strong>2. ä¸ºä»€ä¹ˆéœ€è¦å•å…ƒæµ‹è¯•</strong></p>
<ul>
<li>æå‡ä»£ç è´¨é‡ï¼šé€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•å‘ç°æ½œåœ¨çš„bugã€‚</li>
<li>æ”¯æŒé‡æ„å®‰å…¨ï¼šç¡®ä¿ä»£ç è¡Œä¸ºåœ¨é‡æ„åä¿æŒä¸€è‡´ã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€Angularçš„å•å…ƒæµ‹è¯•</h3>
<p><strong>1. é…ç½® Karma + Jasmineæµ‹è¯•ç¯å¢ƒ</strong></p>
<p>ä½¿ç”¨ Angular CLI åˆ›å»ºé¡¹ç›®æ—¶ï¼Œé»˜è®¤å·²é›†æˆ Jasmine å’Œ Karmaã€‚</p>
<ul>
<li>Karmaï¼šä¸ºå‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•æä¾›äº†è·¨æµè§ˆå™¨æµ‹è¯•çš„èƒ½åŠ›ï¼Œé›†æˆåƒ<code>Jasmine</code>ç­‰æµ‹è¯•æ¡†æ¶ï¼Œå¯åŠ¨ä¸€ä¸ªWebæœåŠ¡å™¨å°†æµ‹è¯•è„šæœ¬æ”¾åˆ°æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–æ¯”å¦‚ç”Ÿæˆä»£ç è¦†ç›–ç‡çš„æŠ¥å‘Šç­‰åŠŸèƒ½ã€‚</li>
<li>Jasmineï¼šä¸€ä¸ª JavaScript æµ‹è¯•æ¡†æ¶ï¼Œå®ƒä¸ä¾èµ–äºæµè§ˆå™¨ã€dom æˆ–å…¶å®ƒ JavaScript æ¡†æ¶ã€‚</li>
</ul>
<p>é…ç½®æ–‡ä»¶ï¼š</p>
<ul>
<li><code>karma.conf.js</code>ï¼šKarma é…ç½®æ–‡ä»¶ï¼Œæ§åˆ¶æµè§ˆå™¨å¯åŠ¨ã€æµ‹è¯•æŠ¥å‘Šç”Ÿæˆç­‰ï¼›</li>
<li><code>test.ts</code>ï¼šå…¥å£æ–‡ä»¶ï¼Œç”¨äºåŠ è½½æ‰€æœ‰æµ‹è¯•æ–‡ä»¶ï¼›</li>
<li><code>tsconfig.spec.json</code>ï¼šç¼–è¯‘æµ‹è¯•æ–‡ä»¶æ‰€éœ€çš„ TypeScript é…ç½®ã€‚</li>
</ul>
<p><strong>2. ç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹</strong></p>
<p>åˆ›å»ºä¸€ä¸ª<code>.spec.ts</code>åç¼€çš„æµ‹è¯•æ–‡ä»¶ï¼Œå†™ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¦‚ä¸‹ï¼š</p>
<p>demo.spec.ts</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'Demo UT'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">it</span>(<span class="hljs-string">'1+1=2'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">expect</span>(<span class="hljs-number">1</span> + <span class="hljs-number">1</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">2</span>);
  });
});
</code></pre>
<p>æ¨èä½¿ç”¨AIè‡ªåŠ¨ç”ŸæˆåŸºç¡€æµ‹è¯•ç”¨ä¾‹ï¼Œå‡å°‘é‡å¤åŠ³åŠ¨ï¼Œæé«˜æ•ˆç‡ã€‚</p>
<p>æç¤ºè¯</p>
<pre><code class="hljs language-md" lang="md">ä¸ºæ–‡ä»¶ï¼šsrc\app\demo.ts ç”ŸæˆUTç”¨ä¾‹ã€‚

å‘½åæ–¹å¼ï¼š
<span class="hljs-bullet">-</span> æµ‹è¯•å¥—å‘½åï¼š[æ–‡ä»¶å]ï¼›
<span class="hljs-bullet">-</span> å†…å±‚æµ‹è¯•å¥—å‘½åï¼š[æ–¹æ³•å]ï¼›
<span class="hljs-bullet">-</span> ç”¨ä¾‹å‘½åï¼šåœºæ™¯[åºå·]ï¼š[åœºæ™¯å]

æµ‹è¯•æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼šå½“å‰æ–‡ä»¶è·¯å¾„ä¸‹
</code></pre>
<p><strong>3. è¿è¡Œæµ‹è¯•</strong></p>
<p>è¿è¡Œä¸‹é¢å‘½ä»¤ï¼Œé»˜è®¤ä¼šæ‰“å¼€æµè§ˆå™¨å¹¶å®æ—¶è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ng <span class="hljs-built_in">test</span>
</code></pre>
<p>ä¹Ÿå¯æŒ‡å®šå‚æ•°è¿è¡Œå•ä¸ªå•å…ƒæµ‹è¯•æ–‡ä»¶ï¼Œé€‚ç”¨äºè°ƒè¯•ç‰¹å®šç»„ä»¶æˆ–æœåŠ¡ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">ng <span class="hljs-built_in">test</span> --include src/app/demo.spec.ts
</code></pre>
<p>æµè§ˆå™¨é¡µé¢ä¸Šä¼šæ˜¾ç¤ºæ‰€æœ‰ç”¨ä¾‹çš„æ‰§è¡Œç»“æœã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02428f77cdf84d0e90859846013b823c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGV2VUnlm6LpmJ8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764811834&amp;x-signature=Us5wRSRYRcMF7tO5gvlftmfA6Q0%3D" alt="test-result.png" loading="lazy"/></p>
<h3 data-id="heading-3">ä¸‰ã€Jasmine æ¡†æ¶å…¥é—¨</h3>
<p><strong>1. æ ¸å¿ƒæ¦‚å¿µ</strong></p>





























<table><thead><tr><th>æ¦‚å¿µ</th><th>æè¿°</th></tr></thead><tbody><tr><td>describe()</td><td>å®šä¹‰ä¸€ç»„ç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹ï¼ˆæµ‹è¯•å¥—ä»¶ï¼‰</td></tr><tr><td>it()</td><td>å®šä¹‰å•ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ˆè§„æ ¼ï¼‰</td></tr><tr><td>beforeEach() / afterEach()</td><td>æ¯æ¬¡æ‰§è¡Œæµ‹è¯•å‰åè¿è¡Œçš„åˆå§‹åŒ–/æ¸…ç†ä»£ç </td></tr><tr><td>beforeAll() / afterAll()</td><td>æ•´ä¸ªæµ‹è¯•å¥—ä»¶å¼€å§‹å‰/ç»“æŸåè¿è¡Œä¸€æ¬¡</td></tr><tr><td>expect()</td><td>æ–­è¨€è¡¨è¾¾å¼ï¼Œåˆ¤æ–­å®é™…å€¼ä¸æœŸæœ›å€¼æ˜¯å¦ä¸€è‡´</td></tr></tbody></table>
<p>å¸¸ç”¨æ–­è¨€æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p><strong>å€¼ç›¸ç­‰æ€§æ–­è¨€</strong></p>
<ul>
<li><code>toBe(expected)</code>ï¼šåˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ä¸¥æ ¼ç›¸ç­‰ï¼ˆ<code>===</code>ï¼‰ã€‚</li>
<li><code>toEqual(expected)</code>ï¼šåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æˆ–å€¼æ˜¯å¦ç›¸ç­‰ã€‚</li>
<li><code>not</code>ï¼šä¸å…¶ä»–åŒ¹é…å™¨ä½¿ç”¨ï¼Œè¡¨ç¤ºä¸ç¬¦åˆè¯¥æ¡ä»¶ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">expect</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// success</span>

<span class="hljs-title function_">expect</span>({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBe</span>({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }); <span class="hljs-comment">// success</span>
<span class="hljs-title function_">expect</span>({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }).<span class="hljs-title function_">toEqual</span>({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }); <span class="hljs-comment">// success</span>

<span class="hljs-title function_">expect</span>(<span class="hljs-number">0</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBe</span>(<span class="hljs-literal">null</span>); <span class="hljs-comment">// success</span>
</code></pre>
<p><strong>çœŸå‡å€¼å’Œå®šä¹‰æ€§æ–­è¨€</strong></p>
<ul>
<li><code>toBeDefined()</code>:æ–­è¨€å€¼å·²å®šä¹‰ã€‚</li>
<li><code>toBeUndefined()</code>:æ–­è¨€å€¼æœªå®šä¹‰ã€‚</li>
<li><code>toBeNull()</code>:æ–­è¨€å€¼ä¸º nullã€‚</li>
<li><code>toBeTruthy()</code>:æ–­è¨€å€¼ä¸ºçœŸå€¼ã€‚</li>
<li><code>toBeFalsy()</code>:æ–­è¨€å€¼ä¸ºå‡å€¼ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">expect</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toBeDefined</span>(); <span class="hljs-comment">// success</span>

<span class="hljs-title function_">expect</span>(<span class="hljs-literal">undefined</span>).<span class="hljs-title function_">toBeUndefined</span>(); <span class="hljs-comment">// success</span>

<span class="hljs-title function_">expect</span>(<span class="hljs-literal">null</span>).<span class="hljs-title function_">toBeNull</span>(); <span class="hljs-comment">// success</span>

<span class="hljs-title function_">expect</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">toBeTruthy</span>(); <span class="hljs-comment">// success</span>
<span class="hljs-title function_">expect</span>(<span class="hljs-literal">true</span>).<span class="hljs-title function_">toBeTruthy</span>(); <span class="hljs-comment">// success</span>
<span class="hljs-title function_">expect</span>({}).<span class="hljs-title function_">toBeTruthy</span>(); <span class="hljs-comment">// success</span>

<span class="hljs-title function_">expect</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toBeFalsy</span>(); <span class="hljs-comment">// success</span>
<span class="hljs-title function_">expect</span>(<span class="hljs-string">''</span>).<span class="hljs-title function_">toBeFalsy</span>(); <span class="hljs-comment">// success</span>
<span class="hljs-title function_">expect</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">toBeFalsy</span>(); <span class="hljs-comment">// success</span>
<span class="hljs-title function_">expect</span>(<span class="hljs-title class_">NaN</span>).<span class="hljs-title function_">toBeFalsy</span>(); <span class="hljs-comment">// success</span>
</code></pre>
<p><strong>æ•°å€¼èŒƒå›´æ–­è¨€</strong></p>
<ul>
<li><code>toBeLessThan(number)</code>: æ–­è¨€å€¼å°äºæŒ‡å®šçš„æ•°å­—ã€‚</li>
<li><code>toBeGreaterThan(number)</code>: æ–­è¨€å€¼å¤§äºæŒ‡å®šçš„æ•°å­—ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">expect</span>(<span class="hljs-number">5</span>).<span class="hljs-title function_">toBeLessThan</span>(<span class="hljs-number">10</span>); <span class="hljs-comment">// success</span>

<span class="hljs-title function_">expect</span>(<span class="hljs-number">10</span>).<span class="hljs-title function_">toBeGreaterThan</span>(<span class="hljs-number">5</span>); <span class="hljs-comment">// success</span>
</code></pre>
<p><strong>å…¶ä»–å¸¸ç”¨æ–­è¨€</strong></p>
<ul>
<li><code>toContain(item)</code>: æ–­è¨€æ•°ç»„æˆ–å­—ç¬¦ä¸²ä¸­åŒ…å«æŸä¸ªå…ƒç´ æˆ–å­ä¸²ã€‚</li>
<li><code>toBeCloseTo(number, precision)</code>: æ–­è¨€åœ¨æŒ‡å®šçš„ç²¾åº¦èŒƒå›´å†…ç›¸ä¼¼ã€‚</li>
<li><code>toMatch(RegExp)</code>: æ–­è¨€ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ã€‚</li>
<li><code>toThrow()</code>: æ–­è¨€å‡½æ•°æ‰§è¡Œæ—¶æŠ›å‡ºé”™è¯¯ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">expect</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).<span class="hljs-title function_">toContain</span>(<span class="hljs-number">2</span>); <span class="hljs-comment">// success</span>

<span class="hljs-title function_">expect</span>(<span class="hljs-number">1.24</span>).<span class="hljs-title function_">toBeCloseTo</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0.24</span>); <span class="hljs-comment">//success</span>

<span class="hljs-title function_">expect</span>(<span class="hljs-string">'123'</span>).<span class="hljs-title function_">toMatch</span>(<span class="hljs-regexp">/\d+/</span>); <span class="hljs-comment">// success</span>

<span class="hljs-title function_">expect</span>(<span class="hljs-function">() =&gt;</span> { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(); }).<span class="hljs-title function_">toThrow</span>(); <span class="hljs-comment">// success</span>
</code></pre>
<p><strong>2. Mock ä¸ Spy</strong></p>
<ul>
<li><strong>Mock</strong>ï¼šåˆ›å»ºæ¨¡æ‹Ÿå¯¹è±¡ï¼Œä»£æ›¿å®é™…ä¾èµ–ã€‚</li>
</ul>
<p>ä½¿ç”¨<code>jasmine.createSpy()</code>åˆ›å»ºæ¨¡æ‹Ÿå‡½æ•°ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> mockService = jasmine.<span class="hljs-title function_">createSpyObj</span>(<span class="hljs-string">'Service'</span>, [<span class="hljs-string">'methodName'</span>]);
</code></pre>
<ul>
<li><strong>Spy</strong>ï¼šç›‘è§†æ–¹æ³•è°ƒç”¨ï¼Œè®°å½•è°ƒç”¨æ¬¡æ•°ã€å‚æ•°ç­‰ã€‚</li>
</ul>
<p>ä½¿ç”¨ <code>spyOn()</code> æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªSpyå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šç›‘æ§æŒ‡å®šçš„æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> myObject = {
  <span class="hljs-attr">myMethod</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">arg</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'real return'</span>;
  }
};
<span class="hljs-title function_">spyOn</span>(myObject, <span class="hljs-string">'myMethod'</span>);
</code></pre>
<p>æ¨¡æ‹Ÿæ–¹æ³•è¡Œä¸ºï¼š</p>
<ul>
<li><code>and.returnValue()</code>: è®©Spyåœ¨è¢«è°ƒç”¨æ—¶è¿”å›ä¸€ä¸ªé¢„è®¾çš„å€¼ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">spyOn</span>(myObject, <span class="hljs-string">'myMethod'</span>).<span class="hljs-property">and</span>.<span class="hljs-title function_">returnValue</span>(<span class="hljs-string">'fake return'</span>);
</code></pre>
<ul>
<li><code>and.callFake()</code>: æä¾›ä¸€ä¸ªæ¨¡æ‹Ÿå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†ä»£æ›¿åŸå§‹å‡½æ•°æ‰§è¡Œã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">spyOn</span>(myObject, <span class="hljs-string">'myMethod'</span>).<span class="hljs-property">and</span>.<span class="hljs-title function_">callFake</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">arg</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-string">'mocked: '</span> + arg;
});
</code></pre>
<ul>
<li><code>and.throwError()</code>: æ¨¡æ‹ŸæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">spyOn</span>(myObject, <span class="hljs-string">'myMethod'</span>).<span class="hljs-property">and</span>.<span class="hljs-title function_">throwError</span>(<span class="hljs-string">'Something went wrong'</span>);
</code></pre>
<p>éªŒè¯è°ƒç”¨ï¼šåœ¨æµ‹è¯•ä¸­è°ƒç”¨è¢«Spyçš„å‡½æ•°åï¼Œå¯ä»¥ä½¿ç”¨Spyå¯¹è±¡çš„æ–¹æ³•æ¥éªŒè¯å®ƒçš„è¡Œä¸ºï¼Œä¾‹å¦‚ï¼š</p>





















<table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>toHaveBeenCalled()</td><td>æ£€æŸ¥å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨è¿‡</td></tr><tr><td>toHaveBeenCalledTimes(number)</td><td>æ£€æŸ¥å‡½æ•°è¢«è°ƒç”¨çš„æ¬¡æ•°</td></tr><tr><td>toHaveBeenCalledWith(arg1, arg2, ...)</td><td>æ£€æŸ¥å‡½æ•°æ˜¯å¦ç”¨ç‰¹å®šçš„å‚æ•°è¢«è°ƒç”¨è¿‡</td></tr></tbody></table>
<ul>
<li><strong>ä¾èµ–æ³¨å…¥</strong>ï¼šåˆ©ç”¨Angular çš„TestBed æ¥åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„æµ‹è¯•ç¯å¢ƒï¼Œå¹¶æä¾›æ¨¡æ‹Ÿçš„ä¾èµ–é¡¹ã€‚
<ul>
<li><code>TestBed.configureTestingModule</code>: é…ç½®æµ‹è¯•æ¨¡å—</li>
<li><code>TestBed.inject</code>ï¼šè·å–å’Œæµ‹è¯•éœ€è¦æ³¨å…¥çš„æœåŠ¡ã€‚</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">TestBed</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">MyComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./my.component'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">MyService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./my.service'</span>; <span class="hljs-comment">// ä½ çš„æœåŠ¡</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">MockMyService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./mock-my.service'</span>; <span class="hljs-comment">// MockæœåŠ¡</span>

<span class="hljs-title function_">describe</span>(<span class="hljs-string">'MyComponent'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">component</span>: <span class="hljs-title class_">MyComponent</span>;
  <span class="hljs-keyword">let</span> <span class="hljs-attr">service</span>: <span class="hljs-title class_">MyService</span>; <span class="hljs-comment">// å®é™…æœåŠ¡ç±»å‹</span>

  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">configureTestingModule</span>({
      <span class="hljs-attr">declarations</span>: [<span class="hljs-title class_">MyComponent</span>],
      <span class="hljs-attr">providers</span>: [
        <span class="hljs-comment">// æä¾› Mock æœåŠ¡</span>
        { <span class="hljs-attr">provide</span>: <span class="hljs-title class_">MyService</span>, <span class="hljs-attr">useClass</span>: <span class="hljs-title class_">MockMyService</span> }
      ]
    }).<span class="hljs-title function_">compileComponents</span>();

    service = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">MyService</span>); <span class="hljs-comment">// ä½¿ç”¨ TestBed.inject è·å– Mock æœåŠ¡</span>
  });

  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should create'</span>, <span class="hljs-function">() =&gt;</span> {
    component = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">createComponent</span>(<span class="hljs-title class_">MyComponent</span>).<span class="hljs-property">componentInstance</span>;
    <span class="hljs-title function_">expect</span>(component).<span class="hljs-title function_">toBeTruthy</span>();
  });

  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should call service method'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// å‡è®¾ MockMyService æœ‰ä¸€ä¸ª getData æ–¹æ³•</span>
    <span class="hljs-title function_">spyOn</span>(service, <span class="hljs-string">'getData'</span>).<span class="hljs-property">and</span>.<span class="hljs-title function_">returnValue</span>(<span class="hljs-string">'mock data'</span>);

    component.<span class="hljs-title function_">ngOnInit</span>(); <span class="hljs-comment">// è§¦å‘ä¾èµ–æ³¨å…¥çš„æœåŠ¡æ–¹æ³•</span>

    <span class="hljs-title function_">expect</span>(service.<span class="hljs-property">getData</span>).<span class="hljs-title function_">toHaveBeenCalled</span>(); <span class="hljs-comment">// éªŒè¯æœåŠ¡æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨</span>
    <span class="hljs-title function_">expect</span>(component.<span class="hljs-property">data</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">'mock data'</span>); <span class="hljs-comment">// éªŒè¯ç»„ä»¶æ˜¯å¦æ­£ç¡®ä½¿ç”¨äº†æœåŠ¡è¿”å›çš„æ•°æ®</span>
  });
});
</code></pre>
<p><strong>3. å¼‚æ­¥æµ‹è¯•å¤„ç†</strong></p>
<ul>
<li>ä½¿ç”¨ <code>done()</code> å›è°ƒ</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Promise</span>
<span class="hljs-title function_">it</span>(<span class="hljs-string">'åº”å¼‚æ­¥è·å–æ•°æ®'</span>, <span class="hljs-function">(<span class="hljs-params">done: DoneFn</span>) =&gt;</span> {
  <span class="hljs-title function_">fetchData</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
    <span class="hljs-title function_">expect</span>(data).<span class="hljs-title function_">toEqual</span>(<span class="hljs-string">'expected result'</span>);
    <span class="hljs-title function_">done</span>();
  });
});

<span class="hljs-comment">// Observable</span>
<span class="hljs-title function_">it</span>(<span class="hljs-string">'åº”ä½¿ç”¨Observableè·å–æ•°æ®'</span>, <span class="hljs-function">(<span class="hljs-params">done: DoneFn</span>) =&gt;</span> {
  <span class="hljs-title function_">queryData</span>().<span class="hljs-title function_">subscribe</span>({
    <span class="hljs-attr">next</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      <span class="hljs-title function_">expect</span>(data).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">'expected result'</span>);
    },
    <span class="hljs-attr">complete</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">done</span>();
    },
  });
});
</code></pre>
<ul>
<li>ä½¿ç”¨ async/await å¤„ç†Promise</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">it</span>(<span class="hljs-string">'åº”è¯¥ä½¿ç”¨ async/await è·å–æ•°'</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>();
  <span class="hljs-title function_">expect</span>(data).<span class="hljs-title function_">toEqual</span>(<span class="hljs-string">'expected result'</span>);
});
</code></pre>
<h3 data-id="heading-4">å››ã€æµ‹è¯•è¦†ç›–ç‡</h3>
<p><strong>1. æµ‹è¯•è¦†ç›–ç‡çš„æ¦‚å¿µ</strong></p>
<p>æµ‹è¯•è¦†ç›–ç‡æ˜¯æŒ‡æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œè¿‡ç¨‹ä¸­è®¿é—®åˆ°çš„æºä»£ç è¡Œæ•°å æ€»ä»£ç çš„æ¯”ä¾‹ï¼Œç”¨æ¥è¡¡é‡æµ‹è¯•ç”¨ä¾‹è¦†ç›–ä»£ç çš„ç¨‹åº¦ã€‚</p>
<p>é«˜è¦†ç›–ç‡ç¡®ä¿ä»£ç çš„å…³é”®éƒ¨åˆ†è¢«å……åˆ†æµ‹è¯•ï¼Œæœ‰åŠ©äºå‘ç°æ½œåœ¨ç¼ºé™·ã€‚</p>
<p><strong>2. é…ç½®è¦†ç›–ç‡æ’ä»¶</strong></p>
<ul>
<li>å®‰è£…æ’ä»¶ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">npm install karma-coverage --save-dev
</code></pre>
<ul>
<li>ä¿®æ”¹é…ç½®æ–‡ä»¶<code>karma.conf.js</code>ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>) {
  config.<span class="hljs-title function_">set</span>({
    <span class="hljs-attr">plugins</span>: [
      <span class="hljs-built_in">require</span>(<span class="hljs-string">'karma-coverage'</span>)
    ],
    <span class="hljs-attr">reporters</span>: [<span class="hljs-string">'progress'</span>, <span class="hljs-string">'coverage'</span>],
    <span class="hljs-attr">coverageReporter</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'html'</span>,
      <span class="hljs-attr">dir</span>: <span class="hljs-string">'coverage/'</span>
    }
  });
};
</code></pre>
<p><strong>3. è§£è¯»è¦†ç›–ç‡æŠ¥å‘Š</strong></p>
<ul>
<li>ç”ŸæˆæŠ¥å‘Šï¼šè¿è¡Œå‘½ä»¤</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">ng <span class="hljs-built_in">test</span> --code-coverage
</code></pre>
<p>å¦‚æœå¸Œæœ›æ¯æ¬¡è¿è¡Œ<code>ng test</code>éƒ½åŒæ­¥åˆ·æ–°è¦†ç›–ç‡ï¼Œå¯ä»¥ä¿®æ”¹<code>angular.json</code>ä¸­çš„<code>architect.test.options</code>æ·»åŠ é…ç½®ï¼š<code>"codeCoverage": true</code></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"options"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"src/test.ts"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"polyfills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"zone.js"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"zone.js/testing"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"tsConfig"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsconfig.spec.json"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"karmaConfig"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"karma.conf.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"codeCoverage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  ...
<span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li>æŸ¥çœ‹æŠ¥å‘Šï¼šåœ¨<code>coverage</code>ç›®å½•ä¸‹æ‰“å¼€<code>index.html</code>ï¼Œåˆ†æå“ªäº›ä»£ç æœªè¢«è¦†ç›–ã€‚
<ul>
<li>è¡Œè¦†ç›–ç‡ï¼ˆLinesï¼‰</li>
<li>åˆ†æ”¯è¦†ç›–ç‡ï¼ˆBranchesï¼‰</li>
<li>å‡½æ•°è¦†ç›–ç‡ï¼ˆFunctionsï¼‰</li>
<li>è¯­å¥è¦†ç›–ç‡ï¼ˆStatementsï¼‰</li>
</ul>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26f728b1780943cabb4d49582063aa5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGV2VUnlm6LpmJ8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764811834&amp;x-signature=iAfIEn0hwZ%2BWKekz3dzawjQimgg%3D" alt="coverage.png" loading="lazy"/></p>
<h3 data-id="heading-5">åŠ å…¥æˆ‘ä»¬</h3>
<blockquote>
<p>DevUIå›¢é˜Ÿé‡ç£…æ¨å‡º~<strong>å‰ç«¯æ™ºèƒ½åŒ–åœºæ™¯è§£å†³æ–¹æ¡ˆMateChat</strong>ï¼Œä¸ºé¡¹ç›®æ·»åŠ æ™ºèƒ½åŒ–åŠ©æ‰‹~</p>
<p>æºç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FDevCloudFE%2FMateChat%2Foverview" target="_blank" title="https://gitcode.com/DevCloudFE/MateChat/overview" ref="nofollow noopener noreferrer">gitcode.com/DevCloudFE/â€¦</a>ï¼ˆæ¬¢è¿star~ï¼‰</p>
<p>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmatechat.gitcode.com" target="_blank" title="https://matechat.gitcode.com" ref="nofollow noopener noreferrer">matechat.gitcode.com</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TinyEngine ä½ä»£ç å®æ—¶åä½œæ­ç§˜ï¼šåŸç† +å®æ“ï¼Œçœ‹å®Œç›´æ¥ç”¨ï¼]]></title>    <link>https://juejin.cn/post/7577229187896573987</link>    <guid>https://juejin.cn/post/7577229187896573987</guid>    <pubDate>2025-11-27T12:04:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577229187896573987" data-draft-id="7577226553286524963" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TinyEngine ä½ä»£ç å®æ—¶åä½œæ­ç§˜ï¼šåŸç† +å®æ“ï¼Œçœ‹å®Œç›´æ¥ç”¨ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,ä½ä»£ç "/> <meta itemprop="datePublished" content="2025-11-27T12:04:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OpenTinyç¤¾åŒº"/> <meta itemprop="url" content="https://juejin.cn/user/3808325101432983"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TinyEngine ä½ä»£ç å®æ—¶åä½œæ­ç§˜ï¼šåŸç† +å®æ“ï¼Œçœ‹å®Œç›´æ¥ç”¨ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808325101432983/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OpenTinyç¤¾åŒº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-27T12:04:39.000Z" title="Thu Nov 27 2025 12:04:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡ç”±å‘¨å¤©æ„åŒå­¦åŸåˆ›ã€‚</p>
<p>ä¸€èˆ¬çš„å¤šäººåä½œä¸šåŠ¡éœ€æ±‚ä¸€èˆ¬æ˜¯é’ˆå¯¹æ–‡æ¡£ï¼Œè¡¨æ ¼æˆ–è€…æ˜¯åˆ¶å›¾ä¹‹ç±»çš„ï¼Œåœºæ™¯æ¯”è¾ƒç®€å•ï¼ŒååŒæ“ä½œçš„å¯¹è±¡ä¸ºæ–‡å­—æˆ–è€…å›¾ç‰‡ï¼Œå¯¹è±¡æ¯”è¾ƒå•ä¸€ã€‚
ä¹ä¸€çœ‹ä½ä»£ç çš„å¤šäººåä½œçœ‹ä¼¼æ— ä»ä¸‹æ‰‹ï¼Œå› ä¸ºä½ä»£ç ä¸ä»…æ¶‰åŠåˆ°é¡µé¢ canvas ä¸­ä¸€äº›æ–‡å­—å±æ€§çš„åŒæ­¥ï¼Œè¿˜æ¶‰åŠåˆ°<strong>ç»„ä»¶æ‹–æ‹½ï¼Œæ ·å¼ï¼Œç»‘å®šäº‹ä»¶ï¼Œé«˜çº§å±æ€§ï¼Œç”šè‡³æ˜¯ä»£ç ååŒç¼–è¾‘</strong>çš„ç¼–è¾‘ä¸åŒæ­¥ã€‚é‚£æˆ‘ä»¬æ˜¯å¦‚ä½•åœ¨ä½ä»£ç è¿™ä¸ªåœºæ™¯ä¸‹å®ç°å¤šäººååŒç¼–è¾‘çš„å‘¢ã€‚</p>
<h2 data-id="heading-0">TinyEngineä½ä»£ç å¼•æ“å¤šäººååŒæŠ€æœ¯è¯¦è§£</h2>
<h3 data-id="heading-1">CRDT</h3>
<p>æˆ‘ä»¬é¦–å…ˆæ¥ä»‹ç»ä¸€ä¸‹å®ç°ä½ä»£ç ç¼–è¾‘çš„ååŒç¼–è¾‘çš„åº•å±‚é€»è¾‘ â€”â€” CRDTï¼ˆConflict-free Replicated Data Typeï¼Œæ— å†²çªå¤åˆ¶æ•°æ®ç±»å‹ï¼‰æ˜¯ä¸€ç§<strong>å…è®¸å¹¶å‘ä¿®æ”¹ã€è‡ªåŠ¨åˆå¹¶ä¸”æ°¸ä¸å†²çªçš„æ•°æ®ç»“æ„</strong>ã€‚
å³ä½¿å¤šä¸ªç”¨æˆ·åŒæ—¶ç¼–è¾‘åŒä¸€ä»½æ–‡æ¡£ã€è¡¨æ ¼æˆ–å›¾å½¢ï¼Œç³»ç»Ÿä¹Ÿèƒ½åœ¨ä¹‹åè‡ªåŠ¨åˆå¹¶å‡ºä¸€è‡´çš„ç»“æœï¼Œ<strong>ä¸éœ€è¦â€œé”â€æˆ–â€œäººå·¥è§£å†³å†²çªâ€</strong>ã€‚</p>
<h4 data-id="heading-2">ä¸€ä¸ªä¾‹å­</h4>
<p>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä½œæ–‡æœ¬ç¼–è¾‘å™¨æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼š
A	æ’å…¥â€œHello â€
B	æ’å…¥â€œWorld!â€</p>
<p>åœ¨æ™®é€šç³»ç»Ÿä¸­ï¼Œå¦‚æœä¸¤ä¸ªæ“ä½œå‡ ä¹åŒæ—¶å‘ç”Ÿï¼Œå¯èƒ½å¯¼è‡´å†²çªï¼ˆæ¯”å¦‚ï¼šè°çš„æ”¹åŠ¨ç®—æ•°ï¼Ÿï¼‰ã€‚ä½†åœ¨ CRDT æ¨¡å‹ä¸‹ï¼Œæ¯ä¸ªæ“ä½œéƒ½æ˜¯å¯åˆå¹¶çš„ï¼šç³»ç»Ÿä¼šåŸºäºæ“ä½œçš„é€»è¾‘æ—¶é—´æˆ–å”¯ä¸€æ ‡è¯†ç¬¦è‡ªåŠ¨ç¡®å®šåˆå¹¶é¡ºåºï¼›æœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šæ”¶æ•›åˆ°ç›¸åŒçš„çŠ¶æ€ï¼Œæ¯”å¦‚ "Hello World!"ã€‚</p>
<h4 data-id="heading-3">CRDT çš„ä¸¤ç§ä¸»è¦ç±»å‹</h4>
<ol>
<li>
<p>State-basedï¼ˆçŠ¶æ€å‹ CRDTï¼‰
æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤å®Œæ•´çš„çŠ¶æ€å‰¯æœ¬ï¼Œå¹¶å®šæœŸå°†çŠ¶æ€åˆå¹¶ï¼š
local_state = merge(local_state, remote_state)</p>
</li>
<li>
<p>Operation-basedï¼ˆæ“ä½œå‹ CRDTï¼‰
æ¯ä¸ªèŠ‚ç‚¹åªä¼ æ’­â€œæ“ä½œâ€ï¼Œæ¯”å¦‚â€œåŠ 1â€â€œæ’å…¥å­—ç¬¦Xâ€ï¼Œ
å…¶ä»–èŠ‚ç‚¹æŒ‰ç›¸åŒé€»è¾‘æ‰§è¡Œè¯¥æ“ä½œã€‚</p>
</li>
</ol>
<p>åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯ <strong>æ“ä½œå‹ CRDTï¼ˆOperation-based CRDTï¼‰åº“ Yjs</strong>ã€‚
åœ¨ Yjs ä¸­ï¼Œæ¯ä¸ªååŒæ–‡æ¡£å¯¹åº”ä¸€ä¸ª<strong>æ ¹å¯¹è±¡ Y.Doc</strong>ï¼Œå®ƒå¯ä»¥åŒ…å«å¤šç§å¯ååŒçš„æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚ <strong>Y.Arrayã€Y.Mapã€Y.Text</strong> ç­‰ã€‚<strong>æ¯ä¸ªå®¢æˆ·ç«¯éƒ½ç»´æŠ¤ä¸€ä»½æœ¬åœ°çš„ Y.Doc å‰¯æœ¬</strong>ï¼Œè¿™äº›å‰¯æœ¬é€šè¿‡ Yjs çš„åŒæ­¥æœºåˆ¶ä¿æŒä¸€è‡´ã€‚
å½“å¤šä¸ªå®¢æˆ·ç«¯é€šè¿‡ y-websocket provider è¿æ¥åˆ°åŒä¸€ä¸ªæˆ¿é—´ï¼ˆroomï¼‰æ—¶ï¼Œå®ƒä»¬ä¼šå…±äº«ç›¸åŒçš„æ–‡æ¡£æ•°æ®ã€‚<strong>ä»»ä½•å®¢æˆ·ç«¯å¯¹æ–‡æ¡£çš„ä¿®æ”¹ï¼ˆå¦‚æ’å…¥ã€åˆ é™¤ã€æ›´æ–°ï¼‰éƒ½ä¼šè¢«ç¼–ç ä¸ºæ“ä½œï¼ˆoperationï¼‰</strong>ï¼Œå¹¶å¹¿æ’­åˆ°å…¶ä»–å®¢æˆ·ç«¯ï¼Œä»è€Œå®ç°å®æ—¶çš„æ•°æ®åŒæ­¥ã€‚</p>
<h3 data-id="heading-4">ä»æ•°æ®ç»“æ„åˆ°ååŒæ¨¡å‹ï¼štiny-engine çš„é¡µé¢ Schema ä¸ Yjs çš„ç»“åˆ</h3>
<p>é€šè¿‡å‰é¢çš„è®¨è®ºæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ— è®ºæ˜¯å“ªä¸€ç§ç±»å‹çš„ <strong>CRDTï¼ˆConflict-free Replicated Data Typeï¼‰</strong>ï¼Œå…¶æ ¸å¿ƒéƒ½ç¦»ä¸å¼€ä¸€ä¸ª<strong>å¥å…¨ä¸”å®Œå¤‡çš„æ•°æ®ç»“æ„</strong>ã€‚
å¯¹äºæˆ‘ä»¬çš„ <strong>tiny-engine</strong> æ¥è¯´ï¼Œä½ä»£ç é¡µé¢æœ¬èº«ä¹Ÿæ˜¯ç”±ä¸€å¥—ç»“æ„åŒ–çš„æ•°æ®æ‰€æè¿°çš„ã€‚
è¿™å¥—æ•°æ®ç»“æ„ä¸ä»…è¦æ”¯æŒé¡µé¢çš„å±‚çº§å…³ç³»ï¼ˆå¦‚åŒºå—ã€ç»„ä»¶ã€æ’æ§½ï¼‰ï¼Œè¿˜è¦èƒ½å¤Ÿè¡¨è¾¾é¡µé¢çš„åŠ¨æ€é€»è¾‘ï¼ˆå¦‚å¾ªç¯ã€æ¡ä»¶ã€ç”Ÿå‘½å‘¨æœŸã€æ•°æ®æºç­‰ï¼‰ã€‚</p>
<p>åœ¨ tiny-engine ä¸­ï¼Œé¡µé¢çš„åŸºç¡€ç»“æ„å¯ä»¥æŠ½è±¡ä¸ºä»¥ä¸‹ä¸¤ä¸ª TypeScript æ¥å£ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// èŠ‚ç‚¹ç±»å‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Node</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">componentName</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">props</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt; &amp; { columns?: { slots?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt; }[] }
  children?: <span class="hljs-title class_">Node</span>[]
  componentType?: <span class="hljs-string">'Block'</span> | <span class="hljs-string">'PageStart'</span> | <span class="hljs-string">'PageSection'</span>
  slot?: <span class="hljs-built_in">string</span> | <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;
  params?: <span class="hljs-built_in">string</span>[]
  loop?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;
  loopArgs?: <span class="hljs-built_in">string</span>[]
  condition?: <span class="hljs-built_in">boolean</span> | <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;
}
  
<span class="hljs-comment">// æ ¹èŠ‚ç‚¹ç±»å‹ï¼Œå³é¡µé¢ Schema</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">RootNode</span> = <span class="hljs-title class_">Omit</span>&lt;<span class="hljs-title class_">Node</span>, <span class="hljs-string">'id'</span>&gt; &amp; {
  id?: <span class="hljs-built_in">string</span>
  css?: <span class="hljs-built_in">string</span>
  fileName?: <span class="hljs-built_in">string</span>
  methods?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;
  state?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;
  lifeCycles?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;
  dataSource?: <span class="hljs-built_in">any</span>
  bridge?: <span class="hljs-built_in">any</span>
  inputs?: <span class="hljs-built_in">any</span>[]
  outputs?: <span class="hljs-built_in">any</span>[]
  schema?: <span class="hljs-built_in">any</span>
}
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç†è§£ä¸ºï¼š</p>
<ul>
<li><strong>Node</strong> ä»£è¡¨é¡µé¢ä¸­çš„ä¸€ä¸ªé€šç”¨ç»„ä»¶èŠ‚ç‚¹ï¼›</li>
<li><strong>RootNode</strong> åˆ™æ˜¯æ•´ä¸ªé¡µé¢çš„æ ¹èŠ‚ç‚¹ï¼ˆSchemaï¼‰ï¼Œåœ¨ Node çš„åŸºç¡€ä¸Šæ‰©å±•äº†é¡µé¢çº§çš„å±æ€§ï¼Œå¦‚ <code>state</code>ã€<code>methods</code>ã€<code>lifeCycles</code> ç­‰ã€‚</li>
</ul>
<h3 data-id="heading-5">ä»æ•°æ®ç»“æ„åˆ°ååŒå¯¹è±¡</h3>
<p>åœ¨ä½¿ç”¨ <strong>CRDTï¼ˆè¿™é‡Œæ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fyjs.dev%2F" target="_blank" title="https://yjs.dev/" ref="nofollow noopener noreferrer">Yjs</a>ï¼‰</strong> è¿›è¡Œå®æ—¶åä½œæ—¶ï¼Œæˆ‘ä»¬çš„â€œåä½œå•å…ƒâ€å°±æ˜¯ä¸Šè¿°çš„è¿™ç±»æ•°æ®ç»“æ„ã€‚æ¢å¥è¯è¯´ï¼ŒYjs éœ€è¦åœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä»½ä¸ <code>RootNode</code> å¯¹åº”çš„å…±äº«çŠ¶æ€å‰¯æœ¬ã€‚</p>
<p>ç„¶è€Œï¼ŒYjs å¹¶ä¸èƒ½ç›´æ¥ç†è§£å¤æ‚çš„ TypeScript å¯¹è±¡ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶<strong>è½¬åŒ–ä¸º Yjs èƒ½å¤Ÿè¯†åˆ«å’ŒåŒæ­¥çš„ç±»å‹ç³»ç»Ÿ</strong>ã€‚
ä¾‹å¦‚ï¼š</p>
<ul>
<li>æ™®é€šå¯¹è±¡ â†’ <code>Y.Map</code></li>
<li>æ•°ç»„ â†’ <code>Y.Array</code></li>
<li>å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ â†’ <code>Y.Text</code> / åŸºæœ¬ç±»å‹</li>
<li>åµŒå¥—ç»“æ„ï¼ˆå¦‚ childrenï¼‰åˆ™éœ€è¦é€’å½’åœ°è½¬åŒ–ä¸ºåµŒå¥—çš„ Y ç±»å‹ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€æ­¥å·¥ä½œæ˜¯ï¼š</p>
<blockquote>
<p>æ ¹æ®å·²æœ‰çš„ <code>Node</code> å’Œ <code>RootNode</code> æ•°æ®ç»“æ„ï¼Œå°†å…¶æ˜ å°„ä¸ºç­‰ä»·çš„ Yjs ç±»å‹ï¼ˆå¦‚ Y.Mapã€Y.Array ç­‰ï¼‰ã€‚</p>
</blockquote>
<p>è¿™ä¸€è¿‡ç¨‹å¯ä»¥æŠ½è±¡ä¸ºä¸€ä¸ªé€šç”¨çš„ â€œschema â†’ YDocâ€ è½¬æ¢å‡½æ•°ã€‚é¡¹ç›®ä¸­ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">UNDEFINED_PLACEHOLDER</span> = <span class="hljs-string">'__undefined__'</span>
  
<span class="hljs-comment">/**
 * å°†æ™®é€šå¯¹è±¡/æ•°ç»„é€’å½’è½¬æ¢æˆ Yjs å¯¹è±¡
 * <span class="hljs-doctag">@param</span> target Y.Map æˆ– Y.Array
 * <span class="hljs-doctag">@param</span> obj è¦è½¬æ¢çš„å¯¹è±¡
 */</span>
<span class="hljs-comment">// toYjs å‡½æ•°ä¼˜åŒ–åçš„ç‰ˆæœ¬</span>
  
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">toYjs</span>(<span class="hljs-params">target: Y.<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">any</span>&gt; | Y.<span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">any</span>&gt;, obj: <span class="hljs-built_in">any</span></span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(obj)) {
    <span class="hljs-keyword">if</span> (!(target <span class="hljs-keyword">instanceof</span> Y.<span class="hljs-property">Array</span>)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Expected Y.Array as target for array input'</span>)
    }
    obj.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (item === <span class="hljs-literal">undefined</span>) {
        target.<span class="hljs-title function_">push</span>([<span class="hljs-variable constant_">UNDEFINED_PLACEHOLDER</span>])
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item === <span class="hljs-literal">null</span>) {
        target.<span class="hljs-title function_">push</span>([<span class="hljs-literal">null</span>])
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(item)) {
        <span class="hljs-keyword">const</span> childArr = <span class="hljs-keyword">new</span> Y.<span class="hljs-title class_">Array</span>()
        <span class="hljs-title function_">toYjs</span>(childArr, item)
        target.<span class="hljs-title function_">push</span>([childArr])
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item === <span class="hljs-string">'object'</span> &amp;&amp; item !== <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// æ˜ç¡®æ’é™¤ null</span>
        <span class="hljs-keyword">const</span> childMap = <span class="hljs-keyword">new</span> Y.<span class="hljs-title class_">Map</span>()
        <span class="hljs-title function_">toYjs</span>(childMap, item)
        target.<span class="hljs-title function_">push</span>([childMap])
      } <span class="hljs-keyword">else</span> {
        target.<span class="hljs-title function_">push</span>([item])
      }
    })
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'object'</span> &amp;&amp; obj !== <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">if</span> (!(target <span class="hljs-keyword">instanceof</span> Y.<span class="hljs-property">Map</span>)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Expected Y.Map as target for object input'</span>)
    }
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(obj).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, val]</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (val === <span class="hljs-literal">undefined</span>) {
        target.<span class="hljs-title function_">set</span>(key, <span class="hljs-variable constant_">UNDEFINED_PLACEHOLDER</span>)
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val === <span class="hljs-literal">null</span>) {
        target.<span class="hljs-title function_">set</span>(key, <span class="hljs-literal">null</span>)
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(val)) {
        <span class="hljs-keyword">const</span> yArr = <span class="hljs-keyword">new</span> Y.<span class="hljs-title class_">Array</span>()
        target.<span class="hljs-title function_">set</span>(key, yArr)
        <span class="hljs-title function_">toYjs</span>(yArr, val)
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'object'</span> &amp;&amp; val !== <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// æ˜ç¡®æ’é™¤ null</span>
        <span class="hljs-keyword">const</span> yMap = <span class="hljs-keyword">new</span> Y.<span class="hljs-title class_">Map</span>()
        target.<span class="hljs-title function_">set</span>(key, yMap)
        <span class="hljs-title function_">toYjs</span>(yMap, val)
      } <span class="hljs-keyword">else</span> {
        target.<span class="hljs-title function_">set</span>(key, val)
      }
    })
  }
  <span class="hljs-comment">// æ³¨æ„ï¼šå¦‚æœ obj ä¸æ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼ˆå¦‚ string, numberï¼‰ï¼Œå‡½æ•°å°†é™é»˜åœ°ä¸åšä»»ä½•äº‹ã€‚è¿™æ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚</span>
}
  
<span class="hljs-comment">// å°† Yjs Map è½¬å›æ™®é€šå¯¹è±¡ï¼ˆé€’å½’ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fromYjs</span>(<span class="hljs-params">value: <span class="hljs-built_in">any</span></span>): <span class="hljs-built_in">any</span> {
  <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> Y.<span class="hljs-property">Map</span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">obj</span>: <span class="hljs-built_in">any</span> = {}
    value.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">v, k</span>) =&gt;</span> {
      obj[k] = <span class="hljs-title function_">fromYjs</span>(v)
    })
    <span class="hljs-keyword">return</span> obj
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> Y.<span class="hljs-property">Array</span>) {
    <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">toArray</span>().<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-title function_">fromYjs</span>(item))
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> Y.<span class="hljs-property">Text</span>) {
    <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">toString</span>()
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value === <span class="hljs-variable constant_">UNDEFINED_PLACEHOLDER</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span> <span class="hljs-comment">// è¿˜åŸ undefined</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> value
  }
}
</code></pre>
<p>è¿™æ ·ï¼Œå½“æˆ‘ä»¬é€šè¿‡ Yjs å¯¹è¿™äº› Y ç±»å‹è¿›è¡Œä¿®æ”¹ï¼ˆä¾‹å¦‚ä¿®æ”¹ propsã€æ’å…¥/åˆ é™¤ childrenã€æ›´æ–° stateï¼‰ï¼ŒYjs å°±ä¼šè‡ªåŠ¨ç»´æŠ¤ CRDT å†²çªåˆå¹¶é€»è¾‘ï¼Œå¹¶å°†å˜æ›´åŒæ­¥åˆ°æ‰€æœ‰åä½œå®¢æˆ·ç«¯ã€‚</p>
<h3 data-id="heading-6">ç›‘å¬æœºåˆ¶å®ç° â€”â€” ä» Yjs å˜æ›´åˆ°å¤šäººååŒè§†å›¾æ›´æ–°</h3>
<p>å‰é¢çš„æ­¥éª¤æˆåŠŸè®©æˆ‘ä»¬å€ŸåŠ© <strong>Yjs</strong> å®ç°äº†æ•°æ®å±‚é¢çš„å®æ—¶åŒæ­¥ï¼š
æ— è®ºæ˜¯å“ªä½åä½œè€…ä¿®æ”¹äº†é¡µé¢ä¸­çš„æŸä¸ªèŠ‚ç‚¹ã€å±æ€§æˆ–å±‚çº§ç»“æ„ï¼Œè¿™äº›å˜æ›´éƒ½èƒ½è¢«åŒæ­¥ä¼ æ’­åˆ°æ‰€æœ‰å®¢æˆ·ç«¯ã€‚</p>
<p>ä½†æ˜¯ï¼Œä»…ä»…è®©æ•°æ®â€œåŒæ­¥â€è¿˜ä¸å¤Ÿã€‚
åœ¨ <strong>tiny-engine</strong> ä¸­ï¼Œé¡µé¢æ¸²æŸ“ä¸ç¼–è¾‘çš„æ ¸å¿ƒçŠ¶æ€ä»ç„¶ä¾èµ–äºæœ¬åœ°çš„ <strong>Schema</strong>ï¼ˆå³ <code>RootNode</code> å’Œ <code>Node</code> çš„ç»“æ„æ ‘ï¼‰ã€‚
æ¢å¥è¯è¯´ï¼š</p>
<blockquote>
<p>Yjs è´Ÿè´£ç»´æŠ¤åä½œçš„å…±äº«çŠ¶æ€ï¼Œä½†é¡µé¢çš„å®é™…æ¸²æŸ“ä¸äº¤äº’ä»æ˜¯åŸºäºæœ¬åœ°å†…å­˜ä¸­çš„ Schemaã€‚</p>
</blockquote>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»å»ºç«‹ä¸€å¥—ç›‘å¬æœºåˆ¶ï¼Œè®© Yjs çš„å˜æ›´<strong>èƒ½å¤Ÿé©±åŠ¨ Schema ä¸è§†å›¾çš„æ›´æ–°</strong>ï¼Œå½¢æˆå¦‚ä¸‹çš„å®Œæ•´åŒæ­¥é“¾è·¯ï¼š</p>
<pre><code class="hljs">Yjs æ•°æ®å˜åŒ– â†’ æ›´æ–°æœ¬åœ° Schema â†’ è§¦å‘æ¸²æŸ“å¼•æ“åˆ·æ–°è§†å›¾
</code></pre>
<p>éå¸¸å¥½ ğŸ‘ï¼Œä½ è¿™é‡Œå®é™…ä¸Šå¼•å‡ºäº†å¤šäººååŒä¸­æœ€å…³é”®çš„ä¸€ä¸ªè®¾è®¡ç‚¹â€”â€”<strong>â€œæ“ä½œæ„å›¾å±‚â€å’Œâ€œæ•°æ®å±‚â€çš„è§£è€¦â€</strong>ã€‚
ä½ çš„æ€è·¯å·²ç»éå¸¸æ­£ç¡®ï¼šç”¨äº‹ä»¶æ€»çº¿å¤„ç†ç»“æ„æ€§å˜æ›´ï¼ˆå¦‚èŠ‚ç‚¹æ’å…¥/åˆ é™¤ï¼‰ï¼Œç”¨ meta å…ƒæ•°æ®è¿½è¸ªå±æ€§å˜æ›´ã€‚ä¸‹é¢æˆ‘å¸®ä½ æŠŠè¿™ä¸€èŠ‚å†…å®¹å®Œæ•´ã€ç³»ç»Ÿåœ°æ‰©å†™æˆæŠ€æœ¯åšå®¢é£æ ¼ï¼ŒåŒæ—¶ä¿ç•™ä½ çš„åŸå§‹è¯­ä¹‰ä¸å·¥ç¨‹æ„Ÿã€‚ğŸ‘‡</p>
<h4 data-id="heading-7">å®ç°æ€è·¯ï¼šYjs observe æœºåˆ¶</h4>
<p>Yjs ä¸ºæˆ‘ä»¬æä¾›äº†éå¸¸å¼ºå¤§çš„å˜æ›´ç›‘å¬æœºåˆ¶ï¼š</p>
<ul>
<li><strong><code>observe</code></strong>ï¼šç›‘å¬å•ä¸ª <code>Y.Map</code> æˆ– <code>Y.Array</code> çš„å˜æ›´ï¼›</li>
<li><strong><code>observeDeep</code></strong>ï¼šé€’å½’ç›‘å¬æ•´ä¸ªæ–‡æ¡£ä¸­çš„æ‰€æœ‰åµŒå¥—ç»“æ„ï¼ˆå¸¸ç”¨äºå¤æ‚ Schemaï¼‰ã€‚</li>
</ul>
<p>é€šè¿‡è¿™äº›ç›‘å¬å™¨ï¼Œæˆ‘ä»¬å¯ä»¥æ•è·åˆ°æ‰€æœ‰èŠ‚ç‚¹å±‚é¢çš„å¢åˆ æ”¹äº‹ä»¶ï¼ˆåŒ…æ‹¬ propsã€children ç­‰ï¼‰ï¼Œç„¶åå°†è¿™äº›å˜åŒ–<strong>åŒæ­¥å›æœ¬åœ° Schema</strong>ã€‚</p>
<h4 data-id="heading-8">é—®é¢˜ï¼šç»“æ„æ€§æ“ä½œç¼ºä¹è¯­ä¹‰ä¿¡æ¯</h4>
<p>åœ¨ç†è®ºä¸Šï¼Œ<code>observe</code> èƒ½å‘Šè¯‰æˆ‘ä»¬ã€Œæœ‰èŠ‚ç‚¹è¢«æ’å…¥ã€ï¼Œä½†åœ¨å®é™…ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œè¿™ä¸ªä¿¡æ¯è¿œè¿œä¸å¤Ÿã€‚</p>
<p>ä»¥èŠ‚ç‚¹æ’å…¥ä¸ºä¾‹ï¼Œtiny-engine ä¸­çš„æ’å…¥å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">insertAfter</span> = (<span class="hljs-params">{ parent, node, data }: InsertOptions</span>) =&gt; {
  <span class="hljs-keyword">if</span> (!data.<span class="hljs-property">id</span>) {
    data.<span class="hljs-property">id</span> = utils.<span class="hljs-title function_">guid</span>()
  }
  
  <span class="hljs-title function_">useCanvas</span>().<span class="hljs-title function_">operateNode</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>,
    <span class="hljs-attr">parentId</span>: parent.<span class="hljs-property">id</span> || <span class="hljs-string">''</span>,
    <span class="hljs-attr">newNodeData</span>: data,
    <span class="hljs-attr">position</span>: <span class="hljs-string">'after'</span>,
    <span class="hljs-attr">referTargetNodeId</span>: node.<span class="hljs-property">id</span>
  })
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹</strong>ä¸ä»…ä»…æ˜¯å‘ children æ•°ç»„ä¸­å¤š push ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜¯ä¾èµ–ä¸€ç³»åˆ—ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼š</p>
<ul>
<li>æ’å…¥åˆ°å“ªä¸ªçˆ¶èŠ‚ç‚¹ï¼ˆ<code>parentId</code>ï¼‰ï¼›</li>
<li>ç›¸å¯¹å“ªä¸ªå‚è€ƒèŠ‚ç‚¹ï¼ˆ<code>referTargetNodeId</code>ï¼‰ï¼›</li>
<li>æ’å…¥ä½ç½®ï¼ˆ<code>position</code>ï¼šbefore/after/append ç­‰ï¼‰ï¼›</li>
</ul>
<p>ä½†æ˜¯åœ¨ Yjs çš„åº•å±‚ç»“æ„ä¸­ï¼Œè¿™äº›ä¸Šä¸‹æ–‡ä¿¡æ¯åœ¨åŒæ­¥æ—¶éƒ½ä¼š<strong>ä¸¢å¤±</strong>ã€‚
æˆ‘ä»¬åªä¼šæ”¶åˆ°ä¸€æ¡ â€œ<code>children</code> æ•°ç»„æ–°å¢äº†ä¸€ä¸ªå…ƒç´ â€ çš„äº‹ä»¶ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">event.<span class="hljs-property">changes</span>.<span class="hljs-property">added</span> <span class="hljs-comment">// =&gt; [Y.Map({ id: 'new-node-id', ... })]</span>
</code></pre>
<p>è¿™æ—¶æˆ‘ä»¬æ— æ³•æ¨æ–­å‡ºèŠ‚ç‚¹æ˜¯â€œå¦‚ä½•æ’å…¥â€çš„ï¼Œä¹Ÿå°±æ— æ³•è¿˜åŸç¼–è¾‘å™¨å±‚é¢çš„çœŸå®æ“ä½œã€‚
æ¢å¥è¯è¯´ï¼Œ<strong>Yjs æä¾›äº†æ•°æ®å˜åŒ–çš„ç»“æœï¼Œä½†æˆ‘ä»¬éœ€è¦çš„æ˜¯æ“ä½œçš„æ„å›¾</strong>ã€‚</p>
<h4 data-id="heading-9">è§£å†³æ–¹æ¡ˆï¼šäº‹ä»¶æ€»çº¿ + meta å…ƒæ•°æ®</h4>
<p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨æ¶æ„ä¸­å¼•å…¥äº†ä¸¤ä¸ªå…³é”®æœºåˆ¶ï¼š</p>




















<table><thead><tr><th>æœºåˆ¶</th><th>ä¸»è¦è´Ÿè´£</th><th>ä½œç”¨èŒƒå›´</th></tr></thead><tbody><tr><td><strong>äº‹ä»¶æ€»çº¿ï¼ˆEvent Busï¼‰</strong></td><td>ä¼ æ’­èŠ‚ç‚¹çº§æ“ä½œçš„è¯­ä¹‰ï¼Œå¦‚æ–°å¢ã€åˆ é™¤ã€ç§»åŠ¨ç­‰</td><td>ç»“æ„æ€§æ“ä½œ</td></tr><tr><td><strong>Meta å…ƒæ•°æ®ï¼ˆMetadataï¼‰</strong></td><td>æè¿°èŠ‚ç‚¹å±æ€§ã€çŠ¶æ€ç­‰ç»†ç²’åº¦å˜åŒ–</td><td>å±æ€§çº§æ“ä½œ</td></tr></tbody></table>
<h4 data-id="heading-10">1. äº‹ä»¶æ€»çº¿ï¼šåŒæ­¥æ“ä½œæ„å›¾</h4>
<p>äº‹ä»¶æ€»çº¿çš„è®¾è®¡ç›®æ ‡æ˜¯è®©æ¯ä¸€ä¸ªâ€œå¯å¤ç°çš„æ“ä½œâ€éƒ½èƒ½ä»¥äº‹ä»¶çš„å½¢å¼ä¼ æ’­åˆ°åä½œå±‚ä¸­ã€‚</p>
<p>æˆ‘ä»¬ä¼šåœ¨ Yjs æ–‡æ¡£ä¸­ä¸“é—¨åˆ›å»ºä¸€ä¸ª <strong><code>__app_events__</code></strong> é€šé“ï¼Œç”¨äºé€šä¿¡ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åˆ›å»ºäº‹ä»¶é€šé“</span>
<span class="hljs-keyword">const</span> eventsMap = <span class="hljs-variable language_">this</span>.<span class="hljs-property">yDoc</span>.<span class="hljs-title function_">getMap</span>(<span class="hljs-string">'__app_events__'</span>)
  
<span class="hljs-comment">// å¼€å¯äº‹åŠ¡ä¿è¯åŸå­æ€§</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">yDoc</span>.<span class="hljs-title function_">transact</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// åœ¨ç›®æ ‡èŠ‚ç‚¹ä¸Šè®¾ç½®è½¯åˆ é™¤æ ‡å¿—ï¼Œé˜²æ­¢å¹½çµäº‹ä»¶</span>
  targetNode.<span class="hljs-title function_">set</span>(<span class="hljs-string">'_node_deleted'</span>, <span class="hljs-literal">true</span>)
  
  <span class="hljs-comment">// è·å–äº‹ä»¶æ€»çº¿</span>
  <span class="hljs-keyword">const</span> eventsMap = <span class="hljs-variable language_">this</span>.<span class="hljs-property">yDoc</span>.<span class="hljs-title function_">getMap</span>(<span class="hljs-string">'__app_events__'</span>)
  
  <span class="hljs-comment">// å‡†å¤‡äº‹ä»¶è´Ÿè½½</span>
  <span class="hljs-keyword">const</span> eventPayload = {
    <span class="hljs-attr">op</span>: <span class="hljs-string">'delete'</span>,
    <span class="hljs-attr">deletedNodeId</span>: id,
    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> å¯ä»¥åœ¨è´Ÿè½½ä¸­åŒ…å«è¢«åˆ é™¤å‰çš„æ•°æ®ï¼Œä¾¿äºè¿œç¨‹å®¢æˆ·ç«¯åšä¸€äº›é«˜çº§å¤„ç†ï¼ˆå¦‚ "æ¢å¤" åŠŸèƒ½ï¼‰</span>
    previousNodeData,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
  }
  
  <span class="hljs-comment">// ä½¿ç”¨å”¯ä¸€ ID å‘å¸ƒäº‹ä»¶</span>
  <span class="hljs-keyword">const</span> eventId = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>-<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substring(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>
  eventsMap.<span class="hljs-title function_">set</span>(eventId, eventPayload)
}, <span class="hljs-string">'local-delete-operation'</span>)
</code></pre>
<p><strong>ç›‘å¬å™¨è®¾è®¡</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// è®¾ç½®ä¸€ä¸ªä¸“é—¨çš„ç›‘å¬å™¨æ¥å¤„ç†æ¥è‡ªâ€œäº‹ä»¶æ€»çº¿â€çš„è‡ªå®šä¹‰æ“ä½œ</span>
<span class="hljs-comment">// å¤„ç†æ— æ³•è¢« initObserver ç›‘å¬å™¨å¾ˆå¥½å¤„ç†çš„äº‹ä»¶</span>
<span class="hljs-keyword">public</span> <span class="hljs-title function_">setupEventListeners</span>(<span class="hljs-attr">docName</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// è§£ç»‘æ—§çš„ç›‘å¬å™¨ï¼Œé˜²æ­¢é‡å¤</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventListeners</span>.<span class="hljs-title function_">has</span>(docName)) {
    <span class="hljs-keyword">const</span> { map, cb } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventListeners</span>.<span class="hljs-title function_">get</span>(docName)
    map.<span class="hljs-title function_">unobserve</span>(cb)
  }
  
  <span class="hljs-keyword">const</span> docManager = <span class="hljs-title class_">DocManager</span>.<span class="hljs-title function_">getInstance</span>()
  <span class="hljs-keyword">const</span> ydoc = docManager.<span class="hljs-title function_">getOrCreateDoc</span>(docName)
  <span class="hljs-keyword">const</span> eventsMap = ydoc.<span class="hljs-title function_">getMap</span>(<span class="hljs-string">'__app_events__'</span>)
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">eventCallback</span> = (<span class="hljs-params">event: Y.YMapEvent&lt;<span class="hljs-built_in">any</span>&gt;, transaction: Y.Transaction</span>) =&gt; {
    <span class="hljs-keyword">if</span> (transaction.<span class="hljs-property">local</span>) <span class="hljs-keyword">return</span>
  
    event.<span class="hljs-property">changes</span>.<span class="hljs-property">keys</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">change, key</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (change.<span class="hljs-property">action</span> === <span class="hljs-string">'add'</span>) {
        <span class="hljs-keyword">const</span> <span class="hljs-attr">payload</span>: <span class="hljs-built_in">any</span> = eventsMap.<span class="hljs-title function_">get</span>(key)
  
        <span class="hljs-keyword">if</span> (payload &amp;&amp; payload.<span class="hljs-property">op</span> === <span class="hljs-string">'move'</span>) {
          <span class="hljs-keyword">const</span> <span class="hljs-attr">patch</span>: <span class="hljs-title class_">DiffPatch</span> = {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'array-swap'</span>,
            <span class="hljs-attr">parentId</span>: payload.<span class="hljs-property">parentId</span>,
            <span class="hljs-attr">schemaId</span>: payload.<span class="hljs-property">schemaId</span>,
            <span class="hljs-attr">swapId</span>: payload.<span class="hljs-property">swapId</span>
          }
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyPatches</span>(docName, [patch])
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (payload &amp;&amp; payload.<span class="hljs-property">op</span> === <span class="hljs-string">'insert'</span>) {
          <span class="hljs-keyword">const</span> <span class="hljs-attr">patch</span>: <span class="hljs-title class_">DiffPatch</span> = {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'array-insert'</span>,
            <span class="hljs-attr">parentId</span>: payload.<span class="hljs-property">parentId</span>,
            <span class="hljs-attr">newNodeData</span>: payload.<span class="hljs-property">newNodeData</span>,
            <span class="hljs-attr">position</span>: payload.<span class="hljs-property">position</span>,
            <span class="hljs-attr">referTargetNodeId</span>: payload.<span class="hljs-property">referTargetNodeId</span>
          }
  
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyPatches</span>(docName, [patch])
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (payload &amp;&amp; payload.<span class="hljs-property">op</span> === <span class="hljs-string">'delete'</span>) {
          <span class="hljs-keyword">const</span> <span class="hljs-attr">patch</span>: <span class="hljs-title class_">DiffPatch</span> = {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'array-delete'</span>,
            <span class="hljs-attr">deletedId</span>: payload.<span class="hljs-property">deletedNodeId</span>,
            <span class="hljs-attr">previousNodeData</span>: payload.<span class="hljs-property">previousNodeData</span>
          }
  
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyPatches</span>(docName, [patch])
        }
      }
  
      eventsMap.<span class="hljs-title function_">delete</span>(key)
    })
  }
  
  <span class="hljs-comment">// ç»‘å®šç›‘å¬å™¨</span>
  eventsMap.<span class="hljs-title function_">observe</span>(eventCallback)
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventListeners</span>.<span class="hljs-title function_">set</span>(docName, { <span class="hljs-attr">map</span>: eventsMap, <span class="hljs-attr">cb</span>: eventCallback })
}
</code></pre>
<p>è¿™æ ·ï¼Œæ¯å½“ä¸€ä¸ªç”¨æˆ·åœ¨æœ¬åœ°æ‰§è¡ŒèŠ‚ç‚¹æ’å…¥æˆ–åˆ é™¤æ“ä½œæ—¶ï¼š</p>
<p>a. ç¼–è¾‘å™¨ä¼šå‘äº‹ä»¶æ€»çº¿å‘é€ä¸€æ¡â€œæ“ä½œæ„å›¾â€ï¼›
b. è¯¥äº‹ä»¶ä¼šè¢«åŒæ­¥åˆ° Yjs çš„ <code>__app_events__</code>ï¼›
c. æ‰€æœ‰åä½œè€…å®¢æˆ·ç«¯çš„ç›‘å¬å™¨æ”¶åˆ°äº‹ä»¶åï¼Œè°ƒç”¨ <code>operateNode</code> é‡æ”¾æ“ä½œï¼›
d. ä»è€Œä¿æŒé€»è¾‘ä¸€è‡´æ€§ä¸ç»“æ„åŒæ­¥ã€‚</p>
<p>è¿™ç§åšæ³•æœ¬è´¨ä¸Šæ˜¯ <strong>â€œYjs åŒæ­¥ç»“æœ + EventBus åŒæ­¥è¯­ä¹‰â€</strong> çš„ç»“åˆã€‚</p>
<h4 data-id="heading-11">2. Meta å…ƒæ•°æ®ï¼šè¿½è¸ªèŠ‚ç‚¹å±æ€§å˜åŒ–</h4>
<p>è€Œå¯¹äºèŠ‚ç‚¹å±æ€§ï¼ˆå¦‚ <code>props</code>ã€<code>style</code>ã€<code>loop</code>ã€<code>condition</code> ç­‰ï¼‰è€Œè¨€ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦åŒæ­¥æ“ä½œæ„å›¾ï¼Œåªéœ€åŒæ­¥æœ€ç»ˆç»“æœå³å¯ã€‚
å› æ­¤æˆ‘ä»¬åœ¨æ¯ä¸ªèŠ‚ç‚¹çš„ Yjs è¡¨ç¤ºä¸­å¢åŠ ä¸€ä»½ <strong>meta å…ƒæ•°æ®</strong>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> yNode = <span class="hljs-keyword">new</span> Y.<span class="hljs-title class_">Map</span>()
yNode.<span class="hljs-title function_">set</span>(<span class="hljs-string">'meta'</span>, <span class="hljs-keyword">new</span> Y.<span class="hljs-title class_">Map</span>({
  <span class="hljs-attr">lastModifiedBy</span>: userId,
  <span class="hljs-attr">lastModifiedAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
  <span class="hljs-attr">changeType</span>: <span class="hljs-string">'props'</span>
}))
</code></pre>
<p>å½“å±æ€§å‘ç”Ÿä¿®æ”¹æ—¶ï¼Œæˆ‘ä»¬æ›´æ–°å¯¹åº”çš„ meta å­—æ®µï¼Œè¿™æ ·åä½œè€…å°±èƒ½çŸ¥é“ï¼š</p>
<ul>
<li>æ˜¯å“ªä¸ªç”¨æˆ·ä¿®æ”¹çš„ï¼›</li>
<li>ä¿®æ”¹äº†ä»€ä¹ˆéƒ¨åˆ†ï¼›</li>
<li>ä¿®æ”¹æ—¶é—´ç­‰ä¿¡æ¯ã€‚</li>
</ul>
<p>å¹¶é€šè¿‡ <code>observeDeep</code> è‡ªåŠ¨æ•è·å˜åŒ–ï¼Œå®ç°å±æ€§çº§åˆ«çš„å®æ—¶åŒæ­¥ã€‚</p>
<p>è¿™ç§æ¨¡å¼ä¸‹ï¼Œç»“æ„æ“ä½œï¼ˆå¢åˆ èŠ‚ç‚¹ï¼‰å’Œå±æ€§æ“ä½œï¼ˆèŠ‚ç‚¹å†…éƒ¨æ›´æ–°ï¼‰å„å¸å…¶èŒï¼Œä¸ä¼šäº’ç›¸å¹²æ‰°ã€‚</p>
<h4 data-id="heading-12">æ¶æ„å°ç»“</h4>
<p>é€šè¿‡äº‹ä»¶æ€»çº¿ä¸ meta å…ƒæ•°æ®çš„ç»“åˆï¼Œæˆ‘ä»¬å®ç°äº† Yjs ååŒç¼–è¾‘çš„å®Œæ•´é—­ç¯ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">ç”¨æˆ·æ“ä½œ â†’ å‘å¸ƒäº‹ä»¶ï¼ˆEventBusï¼‰
<span class="hljs-code">          â†“
     åŒæ­¥åˆ° Yjs (__app_events__)
          â†“
     å…¶ä»–å®¢æˆ·ç«¯æ¥æ”¶ â†’ é‡æ”¾æ“ä½œ
          â†“
     Schema &amp; è§†å›¾æ›´æ–°
</span></code></pre>
<p>è€Œå¯¹äºå±æ€§æ›´æ–°çš„è·¯å¾„ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">ç”¨æˆ·ç¼–è¾‘å±æ€§ â†’ æ›´æ–°èŠ‚ç‚¹ meta + props
<span class="hljs-code">          â†“
     Yjs observeDeep ç›‘å¬åˆ°å˜åŒ–
          â†“
     åŒæ­¥åˆ°å…¶ä»–å®¢æˆ·ç«¯ â†’ æ›´æ–°æœ¬åœ° Schema
          â†“
     è§¦å‘è§†å›¾é‡ç»˜
</span></code></pre>
<p>è¿™ç§åˆ†å±‚æ¶æ„æ—¢ä¿æŒäº† <strong>Yjs çš„ä¸€è‡´æ€§ç‰¹æ€§</strong>ï¼Œåˆè¡¥ä¸Šäº†ååŒç¼–è¾‘ä¸­è‡³å…³é‡è¦çš„ <strong>æ“ä½œè¯­ä¹‰å±‚</strong>ï¼Œè®©å¤šäººå®æ—¶ååŒçœŸæ­£å…·å¤‡â€œäººç†è§£çš„ä¸Šä¸‹æ–‡é€»è¾‘â€ã€‚</p>
<p>éå¸¸å¥½ï¼Œè¿™ä¸€èŠ‚æ­£æ˜¯æ•´ä¸ª <strong>åå‘åŒæ­¥é“¾è·¯ï¼ˆSchema â†’ Yjsï¼‰</strong> çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ä¸‹é¢æ˜¯ç»è¿‡æ¶¦è‰²å’Œæ‰©å±•åçš„å®Œæ•´åšå®¢å†…å®¹ç‰‡æ®µï¼Œå¯ä»¥ç›´æ¥ç”¨äºæŠ€æœ¯æ–‡æ¡£æˆ–åšå®¢æ–‡ç« ä¸­ğŸ‘‡</p>
<h3 data-id="heading-13">åå‘åŒæ­¥æœºåˆ¶ â€”â€” ä» Schema æ”¹åŠ¨æ›´æ–° Yjs</h3>
<p>åœ¨å‰é¢æˆ‘ä»¬å·²ç»ä»‹ç»äº†å¦‚ä½•é€šè¿‡ Yjs çš„å˜æ›´æ¥é©±åŠ¨æœ¬åœ° Schema çš„æ›´æ–°ï¼Œå®ç°äº†**â€œè¿œç«¯ â†’ æœ¬åœ°â€** çš„åŒæ­¥é€»è¾‘ã€‚
è€Œè¿™ä¸€èŠ‚è¦è®²çš„ï¼Œåˆ™æ˜¯åå‘è¿‡ç¨‹ï¼š<strong>å½“æœ¬åœ°ç”¨æˆ·æ“ä½œå¯¼è‡´ Schema å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¦‚ä½•å°†è¿™äº›å˜æ›´åŒæ­¥åˆ° Yjs æ–‡æ¡£ï¼Œä»è€Œå¹¿æ’­ç»™å…¶ä»–åä½œè€…ã€‚</strong></p>
<h4 data-id="heading-14">åŸºæœ¬æ€è·¯</h4>
<p>åå‘åŒæ­¥çš„æ ¸å¿ƒç†å¿µæ˜¯ï¼š</p>
<blockquote>
<p>å½“æœ¬åœ° Vue å“åº”å¼çŠ¶æ€ï¼ˆSchemaï¼‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡ Vue Hook æ•è·åˆ°å˜æ›´ï¼Œå¹¶å°†è¿™äº›å˜æ›´åŒæ­¥åˆ° Yjs çš„å…±äº«ç»“æ„ä¸­ã€‚</p>
</blockquote>
<p>è¿™ä¸€æœºåˆ¶çš„å…³é”®åœ¨äºå¯¹ <strong>æ“ä½œæ„å›¾ï¼ˆOperation Intentï¼‰</strong> çš„æ•è·ï¼Œè€Œä¸æ˜¯å•çº¯åœ°å¯¹æ•°æ®å·®å¼‚åšæ¯”å¯¹ã€‚
ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯åœ¨æ£€æµ‹â€œæ•°æ®å˜äº†å¤šå°‘â€ï¼Œè€Œæ˜¯åœ¨ç›‘å¬â€œç”¨æˆ·æ‰§è¡Œäº†ä»€ä¹ˆæ“ä½œâ€â€”â€”æ¯”å¦‚æ’å…¥èŠ‚ç‚¹ã€åˆ é™¤èŠ‚ç‚¹ã€ä¿®æ”¹å±æ€§ç­‰ã€‚</p>
<h4 data-id="heading-15">æ·»åŠ èŠ‚ç‚¹çš„ç¤ºä¾‹</h4>
<p>ä»¥â€œæ·»åŠ èŠ‚ç‚¹â€ä¸ºä¾‹ï¼Œå½“ç”¨æˆ·åœ¨ç¼–è¾‘å™¨ä¸­æ‰§è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œå®é™…çš„ Schema æ”¹åŠ¨ä¼šé€šè¿‡ä»¥ä¸‹å‡½æ•°å®Œæˆï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">insertNode</span> = (<span class="hljs-params">
  node: { node: Node; parent: Node; data: Node },
  position: PositionType = POSITION.IN,
  select = <span class="hljs-literal">true</span>
</span>) =&gt; {
  <span class="hljs-keyword">if</span> (!node.<span class="hljs-property">parent</span>) {
    <span class="hljs-title function_">insertInner</span>({ <span class="hljs-attr">node</span>: <span class="hljs-title function_">useCanvas</span>().<span class="hljs-property">pageState</span>.<span class="hljs-property">pageSchema</span>!, <span class="hljs-attr">data</span>: node.<span class="hljs-property">data</span> }, position)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">switch</span> (position) {
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">TOP</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">LEFT</span>:
        <span class="hljs-title function_">insertBefore</span>(node)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">BOTTOM</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">RIGHT</span>:
        <span class="hljs-title function_">insertAfter</span>(node)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">IN</span>:
        <span class="hljs-title function_">insertInner</span>(node)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">OUT</span>:
        <span class="hljs-title function_">insertContainer</span>(node)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">REPLACE</span>:
        <span class="hljs-title function_">insertReplace</span>(node)
        <span class="hljs-keyword">break</span>
      <span class="hljs-attr">default</span>:
        <span class="hljs-title function_">insertInner</span>(node)
        <span class="hljs-keyword">break</span>
    }
  }
  
  <span class="hljs-keyword">if</span> (select) {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">selectNode</span>(node.<span class="hljs-property">data</span>.<span class="hljs-property">id</span>))
  }
  
  <span class="hljs-title function_">getController</span>().<span class="hljs-title function_">addHistory</span>()
}
</code></pre>
<p>æˆ‘ä»¬é‡ç‚¹å…³æ³¨ <code>insertBefore</code> å‡½æ•°çš„å®ç°ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">insertBefore</span> = (<span class="hljs-params">{ parent, node, data }: InsertOptions</span>) =&gt; {
  <span class="hljs-keyword">if</span> (!data.<span class="hljs-property">id</span>) {
    data.<span class="hljs-property">id</span> = utils.<span class="hljs-title function_">guid</span>()
  }
  
  <span class="hljs-comment">// æ›´æ–°æœ¬åœ° Schema</span>
  <span class="hljs-title function_">useCanvas</span>().<span class="hljs-title function_">operateNode</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>,
    <span class="hljs-attr">parentId</span>: parent.<span class="hljs-property">id</span> || <span class="hljs-string">''</span>,
    <span class="hljs-attr">newNodeData</span>: data,
    <span class="hljs-attr">position</span>: <span class="hljs-string">'before'</span>,
    <span class="hljs-attr">referTargetNodeId</span>: node.<span class="hljs-property">id</span>
  })
  
  <span class="hljs-comment">// å¤šäººåä½œåŒæ­¥</span>
  <span class="hljs-title function_">useRealtimeCollab</span>().<span class="hljs-title function_">insertSharedNode</span>({ node, parent, data }, <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">TOP</span>)
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå½“æœ¬åœ° Schema æ‰§è¡ŒèŠ‚ç‚¹æ’å…¥åï¼Œæ¥ä¸‹æ¥å°±é€šè¿‡
<code>useRealtimeCollab().insertSharedNode(...)</code>
æ¥å®Œæˆä¸ Yjs çš„åŒæ­¥ã€‚</p>
<h4 data-id="heading-16">æ ¸å¿ƒé€»è¾‘ï¼š<code>insertSharedNode</code></h4>
<p><code>insertSharedNode</code> æ˜¯æ•´ä¸ªåå‘åŒæ­¥æœºåˆ¶çš„å…³é”®å‡½æ•°ï¼Œå®ƒçš„ä¸»è¦èŒè´£æ˜¯ï¼š</p>
<ol>
<li>
<p><strong>ç¡®å®š Yjs ç»“æ„ä¸­ç›®æ ‡ä½ç½®</strong>
é€šè¿‡ <code>parent.id</code> è·å–å…±äº«æ–‡æ¡£ä¸­å¯¹åº”çš„ <code>Y.Map</code> æˆ– <code>Y.Array</code>ï¼Œæ‰¾åˆ°åº”æ’å…¥çš„ç›®æ ‡èŠ‚ç‚¹ã€‚</p>
</li>
<li>
<p><strong>æ„é€  Yjs èŠ‚ç‚¹å¯¹è±¡</strong>
å°†æœ¬åœ°çš„ <code>Node</code> æ•°æ®ç»“æ„åºåˆ—åŒ–ä¸ºå¯¹åº”çš„ Yjs ç±»å‹ï¼ˆ<code>Y.Map</code>ï¼‰ï¼Œå¹¶é€’å½’åœ°å°† <code>props</code>ã€<code>children</code> ç­‰å­—æ®µæ˜ å°„ä¸º Yjs å¯æ“ä½œçš„æ•°æ®ç»“æ„ã€‚</p>
</li>
<li>
<p><strong>æ‰§è¡Œäº‹åŠ¡æ€§æ’å…¥</strong>
ä½¿ç”¨ <code>ydoc.transact()</code> è¿›è¡ŒåŸå­æ“ä½œï¼Œä¿è¯ä¸€æ¬¡æ’å…¥åœ¨æ‰€æœ‰åä½œè€…ä¸­çŠ¶æ€ä¸€è‡´ã€‚</p>
</li>
</ol>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€åŒ–åçš„æ ¸å¿ƒç¤ºä¾‹é€»è¾‘ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// æ‹–æ‹½è¡Œä¸ºäº§ç”Ÿçš„èŠ‚ç‚¹æ’å…¥</span>
<span class="hljs-keyword">public</span> <span class="hljs-title function_">insertNode</span>(<span class="hljs-params">{ node, parent, data }: InsertOptions, position: PositionType</span>) {
  <span class="hljs-keyword">let</span> insertPos
  <span class="hljs-keyword">let</span> insertPosFinal
  
  <span class="hljs-keyword">if</span> (!parent) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">insert</span>(<span class="hljs-title function_">useCanvas</span>().<span class="hljs-property">pageState</span>.<span class="hljs-property">pageSchema</span>!.<span class="hljs-property">id</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, data, position)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">switch</span> (position) {
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">TOP</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">LEFT</span>:
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">insert</span>(parent.<span class="hljs-property">id</span> || <span class="hljs-string">''</span>, data, <span class="hljs-string">'before'</span>, node.<span class="hljs-property">id</span>)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">BOTTOM</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">RIGHT</span>:
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">insert</span>(parent.<span class="hljs-property">id</span> || <span class="hljs-string">''</span>, data, <span class="hljs-string">'after'</span>, node.<span class="hljs-property">id</span>)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">IN</span>:
        insertPos = ([<span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">TOP</span>, <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">LEFT</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>[]).<span class="hljs-title function_">includes</span>(position) ? <span class="hljs-string">'before'</span> : <span class="hljs-string">'after'</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">insert</span>(node.<span class="hljs-property">id</span> || <span class="hljs-string">''</span>, data, insertPos)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">OUT</span>:
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">insert</span>(parent.<span class="hljs-property">id</span> || <span class="hljs-string">''</span>, data, <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">OUT</span>, node.<span class="hljs-property">id</span>)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">REPLACE</span>:
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">insert</span>(parent.<span class="hljs-property">id</span> || <span class="hljs-string">''</span>, data, <span class="hljs-string">'replace'</span>, node.<span class="hljs-property">id</span>)
        <span class="hljs-keyword">break</span>
      <span class="hljs-attr">default</span>:
        insertPosFinal = ([<span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">TOP</span>, <span class="hljs-variable constant_">POSITION</span>.<span class="hljs-property">LEFT</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>[]).<span class="hljs-title function_">includes</span>(position) ? <span class="hljs-string">'before'</span> : <span class="hljs-string">'after'</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">insert</span>(node.<span class="hljs-property">id</span> || <span class="hljs-string">''</span>, data, insertPosFinal)
        <span class="hljs-keyword">break</span>
    }
  }
}
  
<span class="hljs-comment">// insert æ“ä½œ</span>
<span class="hljs-keyword">private</span> <span class="hljs-title function_">insert</span>(<span class="hljs-params">parentId: <span class="hljs-built_in">string</span>, newNodeData: Node, position: <span class="hljs-built_in">string</span>, referTargetNodeId?: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">operationHandler</span>.<span class="hljs-title function_">insert</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>,
    parentId,
    newNodeData,
    position,
    referTargetNodeId
  })
}
</code></pre>
<p>å…¶å®å°±ç›¸å½“äºé‡å†™äº† <code>insertNode</code> æ¥å®ç° Yjs çš„å˜åŠ¨</p>
<h4 data-id="heading-17">Vue Hook çš„ä½œç”¨</h4>
<p>åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°†è¿™ç±»åŒæ­¥é€»è¾‘å°è£…åœ¨ä¸€ä¸ªç»„åˆå¼ Hook ä¸­ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * useCollabSchema Composable
 * èŒè´£:
 * 1. æ•´åˆ Y.Doc (æŒä¹…åŒ–æ•°æ®) å’Œ Y.Awareness (ç¬æ—¶çŠ¶æ€) çš„åŒæ­¥ã€‚
 * 2. æä¾›å¯¹å…±äº«æ–‡æ¡£ç»“æ„ (Schema) çš„å¢åˆ æ”¹ APIã€‚
 * 3. æä¾›å¯¹è¿œç¨‹ç”¨æˆ·å®æ—¶çŠ¶æ€çš„å“åº”å¼æ•°æ®å’Œæ›´æ–° APIã€‚
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useCollabSchema</span>(<span class="hljs-params">options: UseCollabSchemaOptions</span>) {
  <span class="hljs-keyword">const</span> { roomId, currentUser } = options
  <span class="hljs-keyword">const</span> { awareness, provider } = <span class="hljs-title function_">useYjs</span>(roomId, { <span class="hljs-attr">websocketUrl</span>: <span class="hljs-string">`ws://localhost:<span class="hljs-subst">${PORT}</span>`</span> })
  <span class="hljs-keyword">const</span> { remoteStates, updateLocalStateField } = useAwareness&lt;<span class="hljs-title class_">SchemaAwarenessState</span>&gt;(awareness, currentUser)
  
  <span class="hljs-comment">// è·å– NodeSchemaModel å®ä¾‹</span>
  <span class="hljs-keyword">const</span> schemaManager = <span class="hljs-title class_">SchemaManager</span>.<span class="hljs-title function_">getInstance</span>()
  <span class="hljs-keyword">const</span> schemaModel = schemaManager.<span class="hljs-title function_">createSchema</span>(roomId, provider.<span class="hljs-property">value</span>!)
  
  <span class="hljs-comment">// æ‹–æ‹½èŠ‚ç‚¹</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">insertSharedNode</span> = (<span class="hljs-params">
    node: { node: Node | RootNode; parent: Node | RootNode; data: Node },
    position: PositionType = POSITION.IN
  </span>) =&gt; {
    <span class="hljs-comment">// ...ä¸Šé¢æåˆ°çš„æ ¸å¿ƒé€»è¾‘</span>
  }
  
  <span class="hljs-comment">// ... å…¶ä»–æ ¸å¿ƒå‡½æ•°</span>
  
  <span class="hljs-comment">// ç»„ä»¶å¸è½½æ—¶å–æ¶ˆç›‘å¬</span>
  <span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> {
    schemaManager.<span class="hljs-title function_">destroyObserver</span>(roomId)
    provider.<span class="hljs-property">value</span>?.<span class="hljs-title function_">off</span>(<span class="hljs-string">'sync'</span>, <span class="hljs-function">() =&gt;</span> {})
    <span class="hljs-comment">// awareness.value?.destroy()</span>
  })
  
  <span class="hljs-keyword">return</span> {
    remoteStates,
    insertSharedNode,
    <span class="hljs-comment">// ... å…¶ä»–æ ¸å¿ƒå‡½æ•°</span>
  }
}
  
</code></pre>
<p>è¿™æ ·ï¼Œä»»ä½•æ—¶å€™ Schema å±‚æ‰§è¡Œäº†æ’å…¥ã€åˆ é™¤ã€ä¿®æ”¹ç­‰æ“ä½œï¼Œéƒ½å¯ä»¥ç›´æ¥é€šè¿‡ <code>useCollabSchema()</code> æ¥åŒæ­¥åˆ°å…±äº«æ–‡æ¡£ã€‚</p>
<h3 data-id="heading-18">æ€»ç»“</h3>
<p>åœ¨æ•´ä¸ªå¤šäººååŒä½“ç³»ä¸­ï¼Œ<strong>Yjs ä¸ Schema çš„åŒå‘åŒæ­¥æœºåˆ¶</strong>æ˜¯ tiny-engine åä½œçš„æ ¸å¿ƒã€‚</p>
<ul>
<li>
<p><strong>æ­£å‘åŒæ­¥ï¼ˆYjs â†’ Schemaï¼‰</strong>ï¼š
é€šè¿‡ <code>observe</code> ä¸ <code>observeDeep</code> ç›‘å¬ Yjs çš„æ•°æ®å˜æ›´ï¼Œå½“è¿œç«¯åä½œè€…ä¿®æ”¹æ–‡æ¡£æ—¶ï¼Œæœ¬åœ°è‡ªåŠ¨æ›´æ–° Schemaï¼Œä»è€Œè§¦å‘ç•Œé¢åˆ·æ–°ã€‚</p>
</li>
<li>
<p><strong>åå‘åŒæ­¥ï¼ˆSchema â†’ Yjsï¼‰</strong>ï¼š
é€šè¿‡ Vue Hook æ•è·æœ¬åœ°ç”¨æˆ·æ“ä½œï¼ˆå¦‚æ’å…¥ã€åˆ é™¤ã€ä¿®æ”¹èŠ‚ç‚¹ç­‰ï¼‰ï¼Œå†è°ƒç”¨å°è£…çš„ <code>useRealtimeCollab()</code> æ–¹æ³•ï¼Œå°†å˜æ›´åŒæ­¥å› Yjs æ–‡æ¡£ã€‚</p>
</li>
<li>
<p><strong>äº‹ä»¶æ€»çº¿ä¸ Meta å…ƒæ•°æ®</strong>ï¼š
ç”¨äºè§£å†³å•çº¯æ•°æ®å˜æ›´ä¸­æ— æ³•è¿˜åŸæ“ä½œæ„å›¾çš„é—®é¢˜ã€‚äº‹ä»¶æ€»çº¿è´Ÿè´£èŠ‚ç‚¹çº§åˆ«çš„åˆ›å»ºä¸åˆ é™¤åŒæ­¥ï¼Œè€Œ Meta åˆ™ç”¨äºç›‘å¬å±æ€§ä¸çŠ¶æ€çš„æ›´æ”¹ã€‚</p>
</li>
</ul>
<p>æœ€ç»ˆï¼Œæˆ‘ä»¬æ„å»ºå‡ºäº†ä¸€æ¡å®Œæ•´çš„æ•°æ®åŒæ­¥é“¾è·¯ï¼š</p>
<pre><code class="hljs">Yjs æ”¹åŠ¨ â†’ Schema æ›´æ–° â†’ è§†å›¾åˆ·æ–°
Schema æ”¹åŠ¨ â†’ Yjs æ›´æ–° â†’ è¿œç«¯åŒæ­¥
</code></pre>
<p>è¿™æ¡é“¾è·¯ç¡®ä¿äº†å¤šäººååŒç¯å¢ƒä¸‹çš„æ•°æ®ä¸€è‡´æ€§ä¸å®æ—¶å“åº”èƒ½åŠ›ï¼Œè®©æ¯ä¸€ä¸ªç¼–è¾‘åŠ¨ä½œéƒ½èƒ½å³æ—¶åœ°è¢«æ‰€æœ‰åä½œè€…æ„ŸçŸ¥ä¸å‘ˆç°ã€‚
å®ƒæ—¢ä¿è¯äº†æ“ä½œçš„è¯­ä¹‰åŒ–ï¼Œä¹Ÿä¸ºåç»­çš„å†²çªè§£å†³ä¸ç‰ˆæœ¬ç®¡ç†æ‰“ä¸‹äº†åšå®çš„åŸºç¡€ã€‚</p>
<h2 data-id="heading-19">å®æ“ä¸Šæ‰‹ï¼š</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å¼•å¯¼æ‚¨åœ¨æœ¬åœ°ç¯å¢ƒä¸­ï¼Œä»…éœ€å‡ æ¡å‘½ä»¤ï¼Œå°±èƒ½å¯åŠ¨ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„ååŒè®¾è®¡ç”»å¸ƒï¼Œå¹¶è§è¯å®æ—¶åŒæ­¥çš„â€œé­”æ³•â€ã€‚</p>
<h3 data-id="heading-20">é¢„å¤‡å·¥ä½œï¼šä½ çš„å¼€å‘ç¯å¢ƒ</h3>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„æœ¬åœ°ç¯å¢ƒæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œè¿™æ˜¯ä¿è¯é¡ºåˆ©è¿è¡Œçš„åŸºç¡€ï¼š</p>
<ul>
<li><strong>Node.js</strong>: ç‰ˆæœ¬éœ€ <code>â‰¥ 16</code>ã€‚æˆ‘ä»¬æ¨èä½¿ç”¨ <code>nvm</code> æˆ– <code>fnm</code> ç­‰å·¥å…·æ¥ç®¡ç† Node.js ç‰ˆæœ¬ï¼Œä»¥é¿å…ç¯å¢ƒå†²çªã€‚
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥ä½ çš„ Node.js ç‰ˆæœ¬</span>
node -v 
</code></pre>
</li>
<li><strong>pnpm</strong>: <code>tiny-engine</code> é‡‡ç”¨ pnpm ä½œä¸ºåŒ…ç®¡ç†å™¨ï¼Œä»¥å……åˆ†åˆ©ç”¨å…¶åœ¨ monorepoï¼ˆå¤šåŒ…ä»“åº“ï¼‰é¡¹ç›®ä¸­çš„é«˜æ•ˆä¾èµ–ç®¡ç†èƒ½åŠ›ã€‚
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¦‚æœå°šæœªå®‰è£… pnpmï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤</span>
npm install -g pnpm
</code></pre>
</li>
</ul>
<h3 data-id="heading-21">ç¬¬ä¸€æ­¥ï¼šå…‹éš† <code>tiny-engine</code> æºç </h3>
<p>é¦–å…ˆï¼Œå°† <code>tiny-engine</code> çš„å®˜æ–¹ä»“åº“å…‹éš†åˆ°æ‚¨çš„æœ¬åœ°ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/opentiny/tiny-engine.git
<span class="hljs-built_in">cd</span> tiny-engine
</code></pre>
<p>è¿›å…¥é¡¹ç›®ç›®å½•åï¼Œæ‚¨ä¼šå‘ç°è¿™æ˜¯ä¸€ä¸ªç»“æ„æ¸…æ™°çš„ monorepo é¡¹ç›®ï¼Œæ‰€æœ‰åŠŸèƒ½æ¨¡å—ï¼ˆå¦‚ç¼–è¾‘å™¨æ ¸å¿ƒã€ç‰©æ–™é¢æ¿ã€åä½œæœåŠ¡ç­‰ï¼‰éƒ½ä½œä¸ºç‹¬ç«‹çš„å­åŒ…å­˜åœ¨äº <code>packages/</code> ç›®å½•ä¸‹ã€‚</p>
<h3 data-id="heading-22">2ï¸âƒ£ ç¬¬äºŒæ­¥ï¼šå®‰è£…é¡¹ç›®ä¾èµ–</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œ <code>pnpm install</code>ã€‚pnpm ä¼šæ™ºèƒ½åœ°è§£æå¹¶å®‰è£…æ‰€æœ‰å­åŒ…çš„ä¾èµ–ï¼Œå¹¶å»ºç«‹å®ƒä»¬ä¹‹é—´çš„ç¬¦å·é“¾æ¥ï¼ˆsymlinksï¼‰ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">pnpm install
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ ä¸ºä»€ä¹ˆæ˜¯ pnpmï¼Ÿ</strong>
åœ¨ monorepo æ¶æ„ä¸­ï¼Œpnpm é€šè¿‡å…¶ç‹¬ç‰¹çš„éæ‰å¹³åŒ– <code>node_modules</code> ç»“æ„å’Œå†…å®¹å¯»å€å­˜å‚¨ï¼Œå¯ä»¥æå¤§åœ°èŠ‚çœç£ç›˜ç©ºé—´ï¼Œå¹¶é¿å…â€œå¹»å½±ä¾èµ–â€é—®é¢˜ï¼Œä¿è¯äº†å¼€å‘ç¯å¢ƒçš„çº¯å‡€ä¸ä¸€è‡´æ€§ã€‚</p>
</blockquote>
<h3 data-id="heading-23">3ï¸âƒ£ ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨å¼€å‘æœåŠ¡ï¼Œè§è¯å¥‡è¿¹ï¼</h3>
<p>ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œç°åœ¨åªéœ€è¿è¡Œ <code>dev</code> å‘½ä»¤ï¼Œå³å¯ä¸€é”®å¯åŠ¨æ•´ä¸ª <code>tiny-engine</code> å¼€å‘ç¯å¢ƒã€‚</p>
<pre><code class="hljs language-bash" lang="bash">pnpm dev
</code></pre>
<p>è¿™ä¸ªå‘½ä»¤èƒŒåå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>å®ƒä¼šåŒæ—¶å¯åŠ¨å¤šä¸ªæœåŠ¡ï¼ŒåŒ…æ‹¬ï¼š
<ul>
<li><strong>Vite å‰ç«¯å¼€å‘æœåŠ¡å™¨</strong>: è´Ÿè´£æ„å»ºå’Œçƒ­æ›´æ–°æ‚¨åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°çš„ç¼–è¾‘å™¨ç•Œé¢ã€‚</li>
<li><strong>åä½œåç«¯æœåŠ¡å™¨ (y-websocket)</strong>: ä¸€ä¸ªè½»é‡çº§çš„ WebSocket æœåŠ¡å™¨ï¼Œè´Ÿè´£æ¥æ”¶ã€å¹¿æ’­å’ŒæŒä¹…åŒ– Y.js çš„ååŒæ•°æ®ã€‚</li>
</ul>
</li>
<li>ç»ˆç«¯ä¼šè¾“å‡ºç¼–è¾‘å™¨å‰ç«¯çš„è®¿é—®åœ°å€ï¼Œé€šå¸¸é»˜è®¤ä¸º <code>http://localhost:7007</code>ï¼ˆè¯·ä»¥æ‚¨ç»ˆç«¯çš„å®é™…è¾“å‡ºä¸ºå‡†ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-24">4ï¸âƒ£ ç¬¬å››æ­¥ï¼šå¼€å¯ä½ çš„â€œå¤šäººåä½œâ€å‰§æœ¬</h3>
<p>ç°åœ¨ï¼Œæ˜¯æ—¶å€™æ‰®æ¼”ä¸åŒçš„åä½œè€…äº†ï¼</p>
<ol>
<li><strong>æ‰“å¼€ç¬¬ä¸€ä¸ªçª—å£</strong>: åœ¨æ‚¨çš„æµè§ˆå™¨ï¼ˆæ¨è Chromeï¼‰ä¸­æ‰“å¼€ä¸Šä¸€æ­¥è·å–çš„åœ°å€ï¼Œä¾‹å¦‚ <code>http://localhost:7007</code>ã€‚æ‚¨ä¼šçœ‹åˆ° <code>tiny-engine</code> çš„ä½ä»£ç è®¾è®¡å™¨ç•Œé¢ã€‚è¿™å°±æ˜¯æˆ‘ä»¬çš„<strong>ç”¨æˆ·A</strong>ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73c46d1b252a42319099d33d96da2ea2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764849879&amp;x-signature=kqRqJGP82o1tNqidGhjKO%2FLSLLE%3D" alt="image-2.png" loading="lazy"/></p>
<ol start="2">
<li>
<p><strong>æ‰“å¼€ç¬¬äºŒä¸ªçª—å£</strong>: <strong>æ‰“å¼€ä¸€ä¸ªæ–°çš„æµè§ˆå™¨éšèº«çª—å£</strong>ï¼Œæˆ–è€…ä½¿ç”¨<strong>å¦ä¸€å°è¿æ¥åˆ°åŒä¸€å±€åŸŸç½‘çš„è®¾å¤‡</strong>ï¼Œå†æ¬¡è®¿é—®ç›¸åŒçš„åœ°å€ã€‚è¿™ä¸ªçª—å£å°†æ‰®æ¼”<strong>ç”¨æˆ·B</strong>ã€‚</p>
</li>
<li>
<p><strong>å¼€å§‹å®æ—¶ååŒï¼</strong>: å°†ä¸¤ä¸ªçª—å£å¹¶æ’æ‘†æ”¾ï¼Œç°åœ¨å¼€å§‹æ‚¨çš„è¡¨æ¼”ï¼š</p>
<ul>
<li><strong>åœ¨ç”¨æˆ·Açš„ç”»å¸ƒä¸Šæ‹–å…¥ä¸€ä¸ªæŒ‰é’®ç»„ä»¶</strong>ã€‚è§‚å¯Ÿç”¨æˆ·Bçš„ç”»å¸ƒï¼Œå‡ ä¹åœ¨æ‹–æ‹½å®Œæˆçš„ç¬é—´ï¼ŒåŒæ ·çš„æŒ‰é’®å°±ä¼šâ€œå‡­ç©ºå‡ºç°â€åœ¨ç›¸åŒçš„ä½ç½®ã€‚</li>
<li><strong>åœ¨ç”¨æˆ·Bçš„ç•Œé¢ä¸Šï¼Œé€‰ä¸­åˆšåˆšåŒæ­¥è¿‡æ¥çš„æŒ‰é’®ï¼Œä¿®æ”¹å®ƒçš„â€œæŒ‰é’®å†…å®¹â€å±æ€§</strong>ã€‚è§‚å¯Ÿç”¨æˆ·Açš„ç•Œé¢ï¼ŒæŒ‰é’®çš„æ–‡æœ¬ä¼šå®æ—¶åœ°ã€é€å­—åœ°å‘ç”Ÿå˜åŒ–ã€‚</li>
<li><strong>åœ¨ç”¨æˆ·Açš„å¤§çº²æ ‘é¢æ¿ä¸­ï¼Œæ‹–æ‹½ä¸€ä¸ªç»„ä»¶æ¥æ”¹å˜å…¶å±‚çº§ç»“æ„</strong>ã€‚è§‚å¯Ÿç”¨æˆ·Bçš„å¤§çº²æ ‘ï¼ŒèŠ‚ç‚¹ä¼šç«‹å³ç§»åŠ¨åˆ°æ–°çš„ä½ç½®ã€‚</li>
<li><strong>åœ¨ä»»æ„ä¸€ä¸ªçª—å£ä¸­ï¼Œå°è¯•åŒæ—¶æ“ä½œ</strong>ã€‚æ¯”å¦‚ï¼Œç”¨æˆ·Aä¿®æ”¹ç»„ä»¶çš„é¢œè‰²ï¼Œç”¨æˆ·Bä¿®æ”¹å…¶è¾¹è·ã€‚æ‚¨ä¼šå‘ç°ï¼Œç”±äº CRDT çš„ç‰¹æ€§ï¼Œæ‰€æœ‰çš„ä¿®æ”¹æœ€ç»ˆéƒ½ä¼šè¢«æ­£ç¡®åˆå¹¶ï¼Œè¾¾åˆ°æœ€ç»ˆä¸€è‡´çš„çŠ¶æ€ï¼Œè€Œä¸ä¼šäº§ç”Ÿå†²çªæˆ–è¦†ç›–ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-25">è¿›é˜¶æ¢ç´¢ä¸è°ƒè¯•æŠ€å·§</h3>
<p>å¦‚æœæ‚¨å¯¹èƒŒåçš„åŸç†æ„Ÿåˆ°å¥½å¥‡ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹æ“ä½œæ¥æ·±å…¥æ¢ç´¢ï¼š</p>
<ul>
<li>
<p><strong>æŸ¥çœ‹ååŒçŠ¶æ€</strong>: æ‰“å¼€æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼Œè¿›å…¥ æ§åˆ¶å°ï¼Œä½ ä¼šçœ‹åˆ°ç›¸åº”çš„ååŒçŠ¶æ€æ•°æ®</p>
</li>
<li>
<p><strong>ç½‘ç»œâ€œæ—¶å…‰æœºâ€</strong>: åœ¨å¼€å‘è€…å·¥å…·çš„ <code>Network</code> æ ‡ç­¾é¡µï¼Œç­›é€‰ <code>WS</code> (WebSocket) è¿æ¥ã€‚æ‚¨å¯ä»¥çœ‹åˆ°å®¢æˆ·ç«¯ä¸ <code>y-websocket</code> æœåŠ¡å™¨ä¹‹é—´æµåŠ¨çš„äºŒè¿›åˆ¶æ¶ˆæ¯ã€‚å°è¯•æ–­å¼€ç½‘ç»œå†é‡è¿ï¼Œè§‚å¯Ÿ Y.js æ˜¯å¦‚ä½•åˆ©ç”¨ CRDT çš„èƒ½åŠ›ï¼Œåœ¨é‡è¿åè‡ªåŠ¨åŒæ­¥æ‰€æœ‰ç¦»çº¿æœŸé—´çš„å˜æ›´çš„ã€‚</p>
</li>
<li>
<p><strong>æ‰®æ¼”â€œä¸Šå¸â€</strong>: åœ¨æ§åˆ¶å°ä¸­ï¼Œæ‚¨å¯ä»¥è®¿é—® Y.js çš„ <code>doc</code> å’Œ <code>awareness</code> å®ä¾‹ï¼Œå°è¯•æ‰‹åŠ¨ä¿®æ”¹æ•°æ®æˆ–å¹¿æ’­è‡ªå®šä¹‰çŠ¶æ€ï¼Œæ¥æ›´æ·±å…¥åœ°ç†è§£æ•°æ®é©±åŠ¨çš„ååŒæ¨¡å‹ã€‚</p>
</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å·²ç»æˆåŠŸåœ¨æœ¬åœ°å®Œæ•´åœ°ä½“éªŒäº† <code>tiny-engine</code> å…ˆè¿›çš„å¤šäººåä½œèƒ½åŠ›ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªåŠŸèƒ½æ¼”ç¤ºï¼Œå®ƒèƒŒåèåˆäº† <strong>CRDT (Y.js)ã€å®æ—¶é€šä¿¡ (WebSocket)ã€å…ƒæ•°æ®é©±åŠ¨å’Œäº‹ä»¶æ€»çº¿</strong> ç­‰ä¸€ç³»åˆ—ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–çš„æœ€ä½³å®è·µã€‚</p>
<h2 data-id="heading-26">æ¼”ç¤º</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48a2d5c95a0a4e93b44d525add444549~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764849879&amp;x-signature=SNzsGXjimOx6A4VPEBLMD4Bblwk%3D" alt="20251026152240_rec_.gif" loading="lazy"/></p>
<p>ï¼ˆæœ¬é¡¹ç›®ä¸ºå¼€æºä¹‹å¤æ´»åŠ¨è´¡çŒ®ï¼Œæ¬¢è¿å¤§å®¶ä½“éªŒå¹¶ä½¿ç”¨ï¼‰
æºç å¯å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-engine%2Ftree%2Fospp-2025%2Fmultiplayer-collaboration" target="_blank" title="https://github.com/opentiny/tiny-engine/tree/ospp-2025/multiplayer-collaboration" ref="nofollow noopener noreferrer">github.com/opentiny/tiâ€¦</a></p>
<h2 data-id="heading-27">å…³äº OpenTiny</h2>
<p>æ¬¢è¿åŠ å…¥ OpenTiny å¼€æºç¤¾åŒºã€‚æ·»åŠ å¾®ä¿¡å°åŠ©æ‰‹ï¼šopentiny-official ä¸€èµ·å‚ä¸äº¤æµå‰ç«¯æŠ€æœ¯ï½</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fopentiny.design%2F" target="_blank" title="https://opentiny.design/" ref="nofollow noopener noreferrer">OpenTiny å®˜ç½‘</a>ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fopentiny.design" target="_blank" title="https://opentiny.design" ref="nofollow noopener noreferrer">opentiny.design</a></strong><br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny" target="_blank" title="https://github.com/opentiny" ref="nofollow noopener noreferrer">OpenTiny ä»£ç ä»“åº“</a>ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny" target="_blank" title="https://github.com/opentiny" ref="nofollow noopener noreferrer">github.com/opentiny</a></strong><br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-vue" target="_blank" title="https://github.com/opentiny/tiny-vue" ref="nofollow noopener noreferrer">TinyVue æºç </a>ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-vue" target="_blank" title="https://github.com/opentiny/tiny-vue" ref="nofollow noopener noreferrer">github.com/opentiny/tiâ€¦</a></strong><br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-engine" target="_blank" title="https://github.com/opentiny/tiny-engine" ref="nofollow noopener noreferrer">TinyEngine æºç </a>ï¼šâ€…<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-engine" target="_blank" title="https://github.com/opentiny/tiny-engine" ref="nofollow noopener noreferrer">github.com/opentiny/tiâ€¦</a></strong><br/>
æ¬¢è¿è¿›å…¥ä»£ç ä»“åº“ StarğŸŒŸTinyEngineã€TinyVueã€TinyNGã€TinyCLIã€TinyEditor~
å¦‚æœä½ ä¹Ÿæƒ³è¦å…±å»ºï¼Œå¯ä»¥è¿›å…¥ä»£ç ä»“åº“ï¼Œæ‰¾åˆ° good first issue æ ‡ç­¾ï¼Œä¸€èµ·å‚ä¸å¼€æºè´¡çŒ®~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ ˆï¼ˆStackï¼‰ï¼šä»â€œå¼¹å¤¹â€åˆ°ç®—æ³•é¢è¯•é¢˜çš„è¿›é˜¶ä¹‹è·¯]]></title>    <link>https://juejin.cn/post/7577284968923676672</link>    <guid>https://juejin.cn/post/7577284968923676672</guid>    <pubDate>2025-11-28T06:07:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577284968923676672" data-draft-id="7577189654489186354" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ ˆï¼ˆStackï¼‰ï¼šä»â€œå¼¹å¤¹â€åˆ°ç®—æ³•é¢è¯•é¢˜çš„è¿›é˜¶ä¹‹è·¯"/> <meta itemprop="keywords" content="JavaScript,é¢è¯•,ç®—æ³•"/> <meta itemprop="datePublished" content="2025-11-28T06:07:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å—å±±å®‰"/> <meta itemprop="url" content="https://juejin.cn/user/1795929588117962"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ ˆï¼ˆStackï¼‰ï¼šä»â€œå¼¹å¤¹â€åˆ°ç®—æ³•é¢è¯•é¢˜çš„è¿›é˜¶ä¹‹è·¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1795929588117962/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å—å±±å®‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:07:33.000Z" title="Fri Nov 28 2025 06:07:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä»Šå¤©æˆ‘ä»¬è¦èŠçš„æ˜¯æ•°æ®ç»“æ„ç•Œçš„â€œè€å®äººâ€â€”â€”<strong>æ ˆï¼ˆStackï¼‰</strong> ã€‚ä¸ºä»€ä¹ˆè¯´å®ƒè€å®ï¼Ÿå› ä¸ºå®ƒåªæœ‰ä¸€æ¡è§„çŸ©ï¼Œè€Œä¸”æ­»å®ˆåˆ°åº•ï¼š<strong>å…ˆè¿›åå‡ºï¼ˆFILO - First In, Last Outï¼‰</strong> ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ä½ æ´—ç›˜å­ï¼Œæ´—å¥½çš„ç›˜å­ä¸€ä¸ªæ¥ä¸€ä¸ªå¾€ä¸Šæ‘ï¼ˆå…¥æ ˆï¼‰ï¼Œå–ç›˜å­æ—¶åªèƒ½ä»æœ€ä¸Šé¢æ‹¿ï¼ˆå‡ºæ ˆï¼‰ã€‚å¦‚æœä½ éè¦æŠ½ä¸­é—´çš„ç›˜å­ï¼ŸæŠ±æ­‰ï¼Œé‚£å«â€œå¡Œæ–¹â€ï¼Œä¸å«æ•°æ®ç»“æ„ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ ä» JS æ•°ç»„çš„åŸç”Ÿæ“ä½œå¼€å§‹ï¼Œåˆ©ç”¨ ES6 Class å°è£…é«˜é€¼æ ¼çš„æ ˆï¼Œå¯¹æ¯”æ•°ç»„ä¸é“¾è¡¨çš„åº•å±‚ä¼˜åŠ£ï¼Œæœ€åç”¨ä¸€é“ç»å…¸é¢è¯•é¢˜æ¥å®æˆ˜æ¼”ç»ƒã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€JS æ•°ç»„â€”â€”å¤©ç”Ÿçš„â€œæ ˆâ€</h2>
<p>åœ¨ JavaScript çš„ä¸–ç•Œé‡Œï¼Œæ•°ç»„ï¼ˆArrayï¼‰å°±æ˜¯ä¸€ä¸ªå¼€ç®±å³ç”¨çš„è¶…çº§å·¥å…·ã€‚å®ƒä¸ä»…èƒ½å½“åˆ—è¡¨ç”¨ï¼Œé…åˆå‡ ä¸ª APIï¼Œå®ƒç«‹åˆ»å°±èƒ½å˜èº«æˆä¸€ä¸ªæ ˆã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒæ“ä½œ</h3>
<p>JS æ•°ç»„æä¾›äº†å®Œç¾é€‚é…æ ˆè¯­ä¹‰çš„æ–¹æ³•ï¼š</p>
<ul>
<li><strong>push(element)</strong> ï¼šå…¥æ ˆï¼ˆå‹æ ˆï¼‰ã€‚å¾€æ•°ç»„å°¾éƒ¨å¡ä¸œè¥¿ã€‚</li>
<li><strong>pop()</strong> ï¼šå‡ºæ ˆï¼ˆå¼¹æ ˆï¼‰ã€‚æŠŠæ•°ç»„å°¾éƒ¨çš„ä¸œè¥¿æ‰”å‡ºæ¥ã€‚</li>
<li><strong>peekÂ (æ‰‹åŠ¨å®ç°)</strong> ï¼šå·çœ‹ä¸€çœ¼æ ˆé¡¶æ˜¯è°ï¼ˆarray[length - 1]ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-codeJavaScript" lang="codeJavaScript">
const stack = [];

// å…¥æ ˆï¼šåƒæ˜¯å¾€å¼¹å¤¹é‡Œå‹å­å¼¹
stack.push(1);
stack.push(2);
stack.push(3);

console.log(stack); // [1, 2, 3]

// è®¿é—®æ ˆé¡¶ï¼ˆä¸åˆ é™¤ï¼‰ï¼šçœ‹çœ‹ä¸‹ä¸€å‘å­å¼¹æ˜¯ä»€ä¹ˆ
const peek = stack[stack.length - 1];
console.log(`æ ˆé¡¶å…ƒç´ : ${peek}`); // 3

// å‡ºæ ˆï¼šå‘å°„ï¼
const popped = stack.pop(); 
console.log(`å¼¹å‡ºçš„å…ƒç´ : ${popped}`); // 3
console.log(stack); // [1, 2]

// è­¦å‘Šï¼šä¸è¦ç”¨ shift/unshift æ¨¡æ‹Ÿæ ˆï¼
// è™½ç„¶ stack.unshift(val) å’Œ stack.shift() ä¹Ÿèƒ½å®ç°å…ˆè¿›åå‡ºï¼ˆåœ¨å¤´éƒ¨æ“ä½œï¼‰
// ä½†ä¼šå¯¼è‡´æ•°ç»„å†…æ‰€æœ‰å…ƒç´ ä¸‹æ ‡ç§»åŠ¨ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ï¼Œæ•ˆç‡æä½ã€‚
// è¯·è®¤å‡† push/pop ç»„åˆï¼Œå®ƒä»¬é€šå¸¸æ˜¯ O(1) çš„ã€‚
</code></pre>
<hr/>
<h2 data-id="heading-3">äºŒã€é¢å‘å¯¹è±¡å°è£…â€”â€”åšä¸ªæœ‰â€œè¾¹ç•Œæ„Ÿâ€çš„æ ˆ</h2>
<p>è™½ç„¶æ•°ç»„å¾ˆå¥½ç”¨ï¼Œä½†åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œç›´æ¥æš´éœ²æ•°ç»„æ˜¯å¾ˆå±é™©çš„ã€‚ä¸‡ä¸€å“ªä¸ªå®ä¹ ç”Ÿæ‰‹æŠ–å†™äº†ä¸ªÂ stack[2] = 'hack'ï¼Œç ´åäº†æ ˆçš„ç»“æ„æ€ä¹ˆåŠï¼Ÿ</p>
<p>æˆ‘ä»¬éœ€è¦ç”¨ ES6 çš„Â <strong>Class</strong>Â æŠŠå®ç°ç»†èŠ‚è—èµ·æ¥ï¼Œåªæš´éœ²æ ‡å‡†æ¥å£ã€‚è¿™å«<strong>å°è£…</strong>ï¼Œä¹Ÿæ˜¯ ADTï¼ˆæŠ½è±¡æ•°æ®ç±»å‹ï¼‰çš„ç²¾ç¥æ‰€åœ¨ã€‚</p>
<h3 data-id="heading-4">æ•°ç»„å®ç°ç‰ˆ (ArrayStack)</h3>
<p>æˆ‘ä»¬è¦ç”¨åˆ° ES6 çš„é»‘ç§‘æŠ€ï¼š<strong>ç§æœ‰å±æ€§ï¼ˆPrivate Fieldsï¼‰</strong> ã€‚</p>
<ul>
<li><strong>#stack</strong>ï¼šåŠ äº†Â #Â å·ï¼Œå¤–éƒ¨å°±æ— æ³•é€šè¿‡Â instance.#stackÂ è®¿é—®ã€‚è¿™æ˜¯çœŸæ­£çš„â€œéšç§ä¿æŠ¤â€ã€‚</li>
<li><strong>get size()</strong> ï¼šè®¿é—®å™¨å±æ€§ï¼Œè®©ä½ åƒè®¿é—®å˜é‡ä¸€æ ·è®¿é—®æ–¹æ³•ã€‚</li>
</ul>
<pre><code class="hljs language-codeJavaScript" lang="codeJavaScript">
class ArrayStack {
  // ç§æœ‰å±æ€§ï¼Œåº•å±‚æ˜¯ä¸€ä¸ªæ•°ç»„
  #stack;

  constructor() {
    this.#stack = [];
  }

  // å…¥æ ˆ
  push(val) {
    this.#stack.push(val);
  }

  // å‡ºæ ˆ
  pop() {
    if (this.isEmpty()) throw new Error('æ ˆä¸ºç©ºï¼Œæ²¡ä¸œè¥¿ç»™ä½ å¼¹äº†');
    return this.#stack.pop();
  }

  // æŸ¥çœ‹æ ˆé¡¶
  peek() {
    if (this.isEmpty()) throw new Error('æ ˆä¸ºç©º');
    return this.#stack[this.size - 1];
  }

  // è¿™é‡Œçš„ get å…³é”®å­—ï¼Œè®©æˆ‘ä»¬èƒ½ç”¨ stack.size è€Œä¸æ˜¯ stack.size()
  get size() {
    return this.#stack.length;
  }

  isEmpty() {
    return this.size === 0;
  }

  // ä¸ºäº†è°ƒè¯•æ–¹ä¾¿ï¼Œå…è®¸è½¬æ¢æˆæ™®é€šæ•°ç»„æŸ¥çœ‹
  // ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦å¤åˆ¶ä¸€ä»½ï¼Œé˜²æ­¢å¤–éƒ¨ä¿®æ”¹å†…éƒ¨å¼•ç”¨
  toArray() {
    return [...this.#stack];
  }
}

const s = new ArrayStack();
s.push(100);
s.push(200);
console.log(s.size); // 2
// console.log(s.#stack); // æŠ¥é”™ï¼SyntaxErrorï¼Œä¿æŠ¤æˆåŠŸ
</code></pre>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€é“¾è¡¨å®ç°ç‰ˆâ€”â€”åº•å±‚çš„â€œæµªæ¼«â€</h2>
<p>å¦‚æœæˆ‘ä»¬ä¸å‡†ç”¨æ•°ç»„å‘¢ï¼Ÿæˆ–è€…æˆ‘ä»¬éœ€è¦æè‡´çš„æ‰©å®¹æ€§èƒ½å‘¢ï¼Ÿè¿™æ—¶ **é“¾è¡¨ï¼ˆLinked Listï¼‰**å°±ç™»åœºäº†ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡èŠ‚ç‚¹ï¼ˆNodeï¼‰çš„æŒ‡é’ˆè¿æ¥æ¥å®ç°æ ˆã€‚</p>
<ul>
<li><strong>æ ˆé¡¶æŒ‡é’ˆ (stackPeek)</strong> ï¼šæ°¸è¿œæŒ‡å‘é“¾è¡¨çš„å¤´éƒ¨ï¼ˆHeadï¼‰ã€‚</li>
<li><strong>å…¥æ ˆ</strong>ï¼šæ–°å»ºèŠ‚ç‚¹ -&gt; æŒ‡å‘åŸæ ˆé¡¶ -&gt; æ›´æ–°æ ˆé¡¶æŒ‡é’ˆã€‚</li>
<li><strong>å‡ºæ ˆ</strong>ï¼šä¿å­˜åŸæ ˆé¡¶å€¼ -&gt; æ ˆé¡¶æŒ‡é’ˆåç§»ã€‚</li>
</ul>
<pre><code class="hljs language-codeJavaScript" lang="codeJavaScript">

// èŠ‚ç‚¹ç±»ï¼šé“¾è¡¨çš„æœ€å°å•å…ƒ
class ListNode {
  constructor(val) {
    this.val = val;
    this.next = null;
  }
}

class LinkedListStack {
  #stackPeek; // è¿™æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ ˆé¡¶èŠ‚ç‚¹
  #size = 0;

  constructor() {
    this.#stackPeek = null;
  }

  push(num) {
    const node = new ListNode(num);
    // å…³é”®æ­¥éª¤ï¼šæŠŠæ–°èŠ‚ç‚¹â€œéª‘â€åœ¨æ—§æ ˆé¡¶å¤´ä¸Š
    node.next = this.#stackPeek;
    this.#stackPeek = node;
    this.#size++;
  }

  pop() {
    if (!this.#stackPeek) throw new Error('æ ˆä¸ºç©º');
    const num = this.#stackPeek.val;
    // å…³é”®æ­¥éª¤ï¼šä¸¢å¼ƒå¤´èŠ‚ç‚¹ï¼Œè®©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸Šä½
    this.#stackPeek = this.#stackPeek.next;
    this.#size--;
    return num;
  }

  peek() {
    if (!this.#stackPeek) throw new Error('æ ˆä¸ºç©º');
    return this.#stackPeek.val;
  }

  get size() {
    return this.#size;
  }

  toArray() {
    const res = [];
    let node = this.#stackPeek;
    while (node) {
      res.push(node.val);
      node = node.next;
    }
    return res; // æ³¨æ„ï¼šè¿™é‡Œç”Ÿæˆçš„æ•°ç»„ï¼Œç´¢å¼•0æ˜¯æ ˆé¡¶å…ƒç´ 
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-6">å››ã€å·…å³°å¯¹å†³â€”â€”æ•°ç»„ vs é“¾è¡¨</h2>
<p>è¿™ä¸¤ç§å®ç°å„æœ‰åƒç§‹ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ç»å…¸çš„é¢è¯•è€ƒç‚¹ã€‚</p>
<h3 data-id="heading-7">1. æ—¶é—´æ•ˆç‡ï¼ˆTime Complexityï¼‰</h3>
<ul>
<li>
<p><strong>æ•°ç»„å®ç°</strong>ï¼š</p>
<ul>
<li>
<p><strong>å¹³å‡æƒ…å†µ</strong>ï¼š  O(1)</p>
<p>ï¼šå…¥æ ˆå‡ºæ ˆæå¿«ï¼Œå› ä¸ºå†…å­˜æ˜¯è¿ç»­çš„ã€‚</p>
</li>
<li>
<p><strong>æœ€åæƒ…å†µ</strong>ï¼šO(n)</p>
<p>ï¼š<strong>æ‰©å®¹ï¼ˆResizingï¼‰</strong> å½“æ•°ç»„æ»¡äº†ï¼ŒJS å¼•æ“éœ€è¦åœ¨å†…å­˜ä¸­æ‰¾ä¸€å—æ›´å¤§çš„åœ°ç›˜ï¼ŒæŠŠæ—§æ•°æ®å…¨éƒ¨å¤åˆ¶è¿‡å»ï¼Œè¿™ä¸€ç¬é—´ï¼Œæ€§èƒ½ä¼šâ€œå¡é¡¿â€ä¸€ä¸‹ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>é“¾è¡¨å®ç°</strong>ï¼š</p>
<ul>
<li>
<p><strong>ç¨³å®š</strong>ï¼š O(1)ï¼Œä¸ç®¡æœ‰å¤šå°‘æ•°æ®ï¼Œå…¥æ ˆæ°¸è¿œåªæ˜¯æ”¹ä¸ªæŒ‡é’ˆæŒ‡å‘ï¼Œæ²¡æœ‰â€œæ‰©å®¹â€çš„çƒ¦æ¼ã€‚</p>
</li>
<li>
<p><strong>ç¼ºç‚¹</strong>ï¼šè™½ç„¶ç†è®ºä¸Šæ˜¯Â  O(1) ï¼Œä½†æ¯æ¬¡Â new ListNodeÂ éƒ½æœ‰å†…å­˜åˆ†é…çš„å¼€é”€ï¼Œä¸”ä¸åƒæ•°ç»„é‚£æ ·å¯¹ CPU ç¼“å­˜å‹å¥½ã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">2. ç©ºé—´æ•ˆç‡ï¼ˆSpace Complexityï¼‰</h3>
<ul>
<li><strong>æ•°ç»„</strong>ï¼šå¯èƒ½æœ‰<strong>ç©ºé—´æµªè´¹</strong>ã€‚ä¸ºäº†é˜²æ­¢é¢‘ç¹æ‰©å®¹ï¼Œæ•°ç»„é€šå¸¸ä¼šé¢„åˆ†é…æ¯”å®é™…éœ€è¦æ›´å¤šçš„å†…å­˜ï¼ˆæ¯”å¦‚ä½ å­˜äº†5ä¸ªï¼Œå®ƒå®é™…å äº†10ä¸ªå‘ï¼‰ã€‚</li>
<li><strong>é“¾è¡¨</strong>ï¼š<strong>é¢å¤–å¼€é”€</strong>ã€‚æ¯ä¸ªæ•°æ®ä¸ä»…è¦å­˜å€¼ï¼Œè¿˜è¦å­˜ä¸€ä¸ªÂ nextÂ æŒ‡é’ˆï¼ˆå¼•ç”¨ï¼‰ã€‚å¦‚æœå­˜çš„æ˜¯ç®€å•çš„æ•´æ•°ï¼ŒæŒ‡é’ˆå ç”¨çš„å†…å­˜å¯èƒ½æ¯”æ•°æ®æœ¬èº«è¿˜å¤§ã€‚</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šåœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæ•°æ®é‡é€šå¸¸ä¸ä¼šå¤§åˆ°è®©æ•°ç»„æ‰©å®¹æˆä¸ºç“¶é¢ˆï¼Œä¸” JS å¼•æ“å¯¹æ•°ç»„åšäº†æè‡´ä¼˜åŒ–ï¼Œ<strong>é¦–é€‰æ•°ç»„å®ç°</strong>ã€‚ä½†åœ¨ç³»ç»Ÿçº§ç¼–ç¨‹æˆ–å¯¹æ—¶å»¶æå…¶æ•æ„Ÿçš„åœºæ™¯ä¸‹ï¼Œé“¾è¡¨æ›´ç¨³å®šã€‚</p>
<hr/>
<h2 data-id="heading-9">äº”ã€å®æˆ˜åº”ç”¨â€”â€”æœ‰æ•ˆçš„æ‹¬å·</h2>
<p>å…‰è¯´ä¸ç»ƒå‡æŠŠå¼ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç»å…¸çš„ç®—æ³•é¢˜ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fvalid-parentheses%2Fdescription%2F" target="_blank" title="https://leetcode.cn/problems/valid-parentheses/description/" ref="nofollow noopener noreferrer">LeetCode 20. æœ‰æ•ˆçš„æ‹¬å·</a></p>
<p><strong>é¢˜ç›®</strong>ï¼šåˆ¤æ–­å­—ç¬¦ä¸²ä¸­çš„æ‹¬å·Â (),Â [],Â {}Â æ˜¯å¦åˆæ³•é—­åˆã€‚<br/>
<strong>æ€è·¯</strong>ï¼š</p>
<ol>
<li>
<p>é‡åˆ°å·¦æ‹¬å·ï¼šå‹å…¥æ ˆã€‚</p>
</li>
<li>
<p>é‡åˆ°å³æ‹¬å·ï¼šå¼¹å‡ºæ ˆé¡¶ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯é…å¥—çš„å·¦æ‹¬å·ï¼Œå¦‚æœä¸é…å¥—ï¼Œæˆ–è€…æ ˆå·²ç»ç©ºäº†ï¼Œè¯´æ˜ä¸åˆæ³•ã€‚</p>
</li>
<li>
<p>éå†ç»“æŸï¼šæ ˆå¿…é¡»ä¸ºç©ºï¼ˆæ‰€æœ‰å·¦æ‹¬å·éƒ½æ‰¾åˆ°äº†å½’å®¿ï¼‰ã€‚</p>
</li>
</ol>
<pre><code class="hljs language-codeJavaScript" lang="codeJavaScript">

const isValid = function (str) {
  if (!str) return true;
  
  // æ˜ å°„è¡¨ï¼šå³æ‹¬å· -&gt; å¯¹åº”çš„å·¦æ‹¬å·
  // è¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡å³æ‹¬å·å¿«é€ŸæŸ¥æ‰¾å®ƒæœŸå¾…çš„â€œå¦ä¸€åŠâ€
  const rightToLeft = {
    ')': '(',
    '}': '{',
    ']': '['
  };
  
  const stack = [];
  
  for (let i = 0; i &lt; str.length; i++) { // åŸä»£ç  bug: str.len -&gt; str.length
    const ch = str[i];
    
    // å¦‚æœæ˜¯å·¦æ‹¬å·ï¼Œå…¥æ ˆ
    if (ch === '(' || ch === '[' || ch === '{') {
      stack.push(ch);
    } 
    // å¦‚æœæ˜¯å³æ‹¬å·
    else {
      // 1. æ ˆé‡Œæ˜¯ç©ºçš„ï¼ˆè¯´æ˜å‰é¢æ²¡æœ‰å·¦æ‹¬å·ï¼Œå±…ç„¶å…ˆæ¥äº†ä¸ªå³æ‹¬å·ï¼Ÿï¼‰ -&gt; ä¹Ÿå°±æ˜¯ false
      // 2. å¼¹å‡ºçš„å·¦æ‹¬å·å’Œå½“å‰çš„å³æ‹¬å·ä¸åŒ¹é… -&gt; false
      // åŸä»£ç  bug: leftToright.ch -&gt; rightToLeft[ch] (å±æ€§è®¿é—®è¦ç”¨[])
      if (!stack.length || stack.pop() !== rightToLeft[ch]) {
        return false;
      }
    }
  }
  
  // éå†å®Œäº†ï¼Œæ ˆé‡Œå¿…é¡»å¹²å‡€æ‰ç®—èµ¢
  return stack.length === 0;
};

// æµ‹è¯•ç”¨ä¾‹
console.log(isValid("()[]{}")); // true
console.log(isValid("(]"));     // false
console.log(isValid("([)]"));   // false
console.log(isValid("{[]}"));   // true
</code></pre>
<hr/>
<h2 data-id="heading-10">å…­ã€ å†™åœ¨æœ€åï¼šå¦‚ä½•åœ¨é¢è¯•ä¸­ä¼˜é›…åœ°èŠæ ˆï¼Ÿ</h2>
<p>é¢è¯•å®˜ï¼šâ€œç”¨ JavaScript å®ç°ä¸€ä¸ªæ ˆå‘—ï¼Ÿâ€</p>
<p>ä½ ï¼ˆé¢ä¸æ”¹è‰²ï¼‰ï¼š</p>
<p>â€œçœ‹éœ€æ±‚å“ˆï½ æ—¥å¸¸å¼€å‘æˆ‘ç›´æ¥ç”¨æ•°ç»„ï¼Œä¸‰è¡Œæå®šï¼Œæ€§èƒ½æ‹‰æ»¡ã€‚ å¦‚æœéœ€è¦ä¸¥æ ¼ç§æœ‰å±æ€§å’Œé˜²ç¯¡æ”¹ï¼Œæˆ‘å°±å†™ä¸ª class å°è£…ã€‚ çœŸè¦èŠåº•å±‚å®ç°ï¼Œæˆ‘è¿˜èƒ½ç”©ä¸ªé“¾è¡¨ç‰ˆï¼Œæ—¶é—´å¤æ‚åº¦æ°¸è¿œ O(1)ï¼Œä¸è¿‡å®é™…é¡¹ç›®é‡ŒåŸºæœ¬ä¸ç”¨ï¼Œå› ä¸ºç¼“å­˜ä¸å‹å¥½ã€‚ å“¦å¯¹äº†ï¼Œé¡ºæ‰‹è¿˜èƒ½å†™ä¸ªæ‹¬å·åŒ¹é…ç©ç©ï½â€</p>
<p>è¯´å®Œæ·¡å®šå–ä¸€å£æ°´ï¼Œé¢è¯•å®˜å·²ç»åœ¨ç‹‚ç‚¹å¤´äº†ã€‚</p>
<h2 data-id="heading-11">æ€»ç»“</h2>
<ol>
<li><strong>æ ˆï¼ˆStackï¼‰<strong>æ˜¯</strong>å…ˆè¿›åå‡º</strong>çš„çº¿æ€§ç»“æ„ï¼Œå°±åƒå †ç›˜å­ã€‚</li>
<li><strong>JS æ•°ç»„</strong>é€šè¿‡Â push/popÂ åŸç”Ÿæ”¯æŒæ ˆæ“ä½œï¼Œç®€å•é«˜æ•ˆã€‚</li>
<li><strong>ES6 Class</strong>Â å¯ä»¥è®©æˆ‘ä»¬å°è£…å‡ºæ›´å®‰å…¨ï¼ˆç§æœ‰å±æ€§ï¼‰ã€æ›´è§„èŒƒçš„æ ˆæ•°æ®ç»“æ„ã€‚</li>
<li><strong>é“¾è¡¨å®ç°</strong>é¿å…äº†æ•°ç»„æ‰©å®¹çš„æ€§èƒ½æŠ–åŠ¨ï¼Œä½†ç‰ºç‰²äº†ç©ºé—´å»å­˜æŒ‡é’ˆã€‚</li>
<li><strong>ç®—æ³•åº”ç”¨</strong>ï¼šé‡åˆ°â€œé…å¯¹â€ã€â€œå›æº¯â€ã€â€œæ’¤é”€æ“ä½œâ€ç±»çš„é—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°æ ˆã€‚</li>
</ol>
<p>æ ˆæ˜¯æ•°æ®ç»“æ„é‡Œæœ€â€œå•çº¯â€çš„ä¸€ä¸ªå®¶ä¼™ï¼šåªæœ‰ä¸€å¤´å¼€å£ï¼Œåƒä¸ªæ­»å¿ƒçœ¼çš„ç®¡å­ã€‚ä½†å°±æ˜¯è¿™ä¹ˆä¸ªç®€å•çš„ä¸œè¥¿ï¼Œæ’‘èµ·äº†é€’å½’ã€è¡¨è¾¾å¼è§£æã€DFSâ€¦â€¦æ•´ä¸ªè®¡ç®—æœºä¸–ç•Œçš„åŠå£æ±Ÿå±±ã€‚</p>
<p><strong>è®°ä½ä¸€å¥è¯ï¼šâ€œå½“ä½ ä¸çŸ¥é“ç”¨å•¥æ•°æ®ç»“æ„çš„æ—¶å€™ï¼Œå…ˆè¯•è¯•æ ˆï¼Œå…«æˆèƒ½è¡Œã€‚â€</strong></p>
<p>å¸Œæœ›è¿™ç¯‡æ•´ç†èƒ½è®©ä½ å¯¹æ ˆçš„ç†è§£æ›´ä¸Šä¸€å±‚æ¥¼ï¼Happy Coding!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[XLog debug å¼€å¯æ‰“å°æ—¥å¿—ï¼Œrelease å…³é—­æ‰“å°æ—¥å¿—]]></title>    <link>https://juejin.cn/post/7577430671946629146</link>    <guid>https://juejin.cn/post/7577430671946629146</guid>    <pubDate>2025-11-28T06:10:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577430671946629146" data-draft-id="7577321767346929710" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="XLog debug å¼€å¯æ‰“å°æ—¥å¿—ï¼Œrelease å…³é—­æ‰“å°æ—¥å¿—"/> <meta itemprop="keywords" content="å‰ç«¯,Java,Android"/> <meta itemprop="datePublished" content="2025-11-28T06:10:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="lichong951"/> <meta itemprop="url" content="https://juejin.cn/user/1486195453865687"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            XLog debug å¼€å¯æ‰“å°æ—¥å¿—ï¼Œrelease å…³é—­æ‰“å°æ—¥å¿—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1486195453865687/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    lichong951
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:10:18.000Z" title="Fri Nov 28 2025 06:10:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ <strong>XLog</strong> é‡Œå®ç° <strong>debug å¼€å¯ / release å…³é—­</strong> æ—¥å¿—ï¼Œ<strong>ä¸éœ€è¦è‡ªå·±å†™å¼€å…³</strong>ï¼Œå®˜æ–¹å·²æä¾› <strong>ç¼–è¯‘æœŸ + è¿è¡Œæ—¶</strong> ä¸¤çº§æ–¹æ¡ˆï¼Œ<strong>é›¶è¿è¡Œæ—¶å¼€é”€</strong>ã€‚
ä¸‹é¢ç»™å‡º <strong>Java &amp; Kotlin</strong> ä¸¤ç§å†™æ³•ï¼Œ<strong>ç›´æ¥æ‹·è´</strong>å³å¯ã€‚</p>
<hr/>
<p>ä¸€ã€build.gradle é‡Œåˆ©ç”¨ <strong>BuildConfig.DEBUG</strong> è‡ªåŠ¨åˆ‡æ¢</p>
<pre><code class="hljs language-gradle" lang="gradle">android {
    ...
    buildTypes {
        debug {
            // debug ç‰ˆæ‰“å¼€ XLog
            buildConfigField "boolean", "LOG_OPEN", "true"
        }
        release {
            // release ç‰ˆå½»åº•å…³é—­ï¼ˆç¼–è¯‘æœŸä¼˜åŒ–ï¼‰
            buildConfigField "boolean", "LOG_OPEN", "false"
        }
    }
}
</code></pre>
<hr/>
<p>äºŒã€Application é‡Œä¸€è¡Œä»£ç åˆå§‹åŒ–</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Application</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();
        <span class="hljs-comment">// åªåœ¨ debug ç¼–è¯‘æ—¶ç”Ÿæ•ˆï¼Œrelease ç‰ˆä¸ä¼šæ‰“å°ä¹Ÿä¸ä¼šåˆå§‹åŒ–</span>
        <span class="hljs-keyword">if</span> (BuildConfig.LOG_OPEN) {
            XLog.init(LogLevel.ALL);   <span class="hljs-comment">// è°ƒè¯•ç‰ˆå…¨å¼€</span>
        } <span class="hljs-keyword">else</span> {
            XLog.init(LogLevel.NONE);  <span class="hljs-comment">// å‘å¸ƒç‰ˆå…¨å…³ï¼ˆ0 å¼€é”€ï¼‰</span>
        }
    }
}
</code></pre>
<hr/>
<p>ä¸‰ã€Kotlin æ›´ç®€æ´</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">App</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        XLog.<span class="hljs-keyword">init</span>(<span class="hljs-keyword">if</span> (BuildConfig.LOG_OPEN) LogLevel.ALL <span class="hljs-keyword">else</span> LogLevel.NONE)
    }
}
</code></pre>
<hr/>
<p>å››ã€è¿è¡Œæ—¶åŠ¨æ€å…³é—­ï¼ˆå¯é€‰ï¼‰</p>
<p>è‹¥ <strong>åŒä¸€ä»½ APK</strong> æƒ³ <strong>åå°è¿œç¨‹å…³é—­æ—¥å¿—</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¿œç¨‹é…ç½®ä¸‹å‘ false</span>
<span class="hljs-keyword">if</span> (!RemoteConfig.isLogOpen()) {
    XLog.init(LogLevel.NONE);   <span class="hljs-comment">// ç«‹å³åœæ‰“</span>
}
</code></pre>
<hr/>
<p>äº”ã€ä¸€è¡Œæ€»ç»“</p>
<p><strong>debug / release åŒåŒ…åœºæ™¯</strong>ï¼š
<strong>gradle é‡Œ BuildConfig.LOG_OPEN + XLog.init(LogLevel.ALL/NONE)</strong> å³å¯ <strong>ç¼–è¯‘æœŸå½»åº•å…³é—­ XLog</strong>ï¼Œ<strong>release ç‰ˆ 0 æ€§èƒ½æŸè€—</strong>ã€‚</p>
<p><strong>å•åŒ…åœºæ™¯</strong>ï¼š
<strong>è¿œç¨‹é…ç½® â†’ XLog.init(LogLevel.NONE)</strong> éšæ—¶å…³é—­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›¾ç‰‡æ ‡ç­¾ç”¨ img è¿˜æ˜¯ pictureï¼Ÿå¾ˆå¤šäººå½»åº•å¼„æ··äº†ï¼]]></title>    <link>https://juejin.cn/post/7577298871005036578</link>    <guid>https://juejin.cn/post/7577298871005036578</guid>    <pubDate>2025-11-28T06:21:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577298871005036578" data-draft-id="7570058831559344163" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›¾ç‰‡æ ‡ç­¾ç”¨ img è¿˜æ˜¯ pictureï¼Ÿå¾ˆå¤šäººå½»åº•å¼„æ··äº†ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,HTML"/> <meta itemprop="datePublished" content="2025-11-28T06:21:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›¾ç‰‡æ ‡ç­¾ç”¨ img è¿˜æ˜¯ pictureï¼Ÿå¾ˆå¤šäººå½»åº•å¼„æ··äº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:21:44.000Z" title="Fri Nov 28 2025 06:21:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç½‘é¡µå¼€å‘ä¸­ï¼Œå›¾ç‰‡å¤„ç†æ˜¯æ¯ä¸ªå‰ç«¯å¼€å‘è€…éƒ½ä¼šé‡åˆ°çš„åŸºç¡€ä»»åŠ¡ã€‚é¢å¯¹ <code>&lt;img&gt;</code> å’Œ <code>&lt;picture&gt;</code> è¿™ä¸¤ä¸ªæ ‡ç­¾ï¼Œå¾ˆå¤šäººå­˜åœ¨è¯¯è§£ï¼šè¦ä¹ˆè®¤ä¸ºå®ƒä»¬æ˜¯äº’ç›¸æ›¿ä»£çš„å…³ç³»ï¼Œè¦ä¹ˆåœ¨ä¸åˆé€‚çš„åœºæ™¯ä¸‹ä½¿ç”¨äº†å¤æ‚çš„è§£å†³æ–¹æ¡ˆã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬æ¥å½»åº•ç†æ¸…è¿™ä¸¤ä¸ªæ ‡ç­¾çš„çœŸæ­£ç”¨é€”ã€‚</p>
<h3 data-id="heading-0"><code>&lt;img&gt;</code> æ ‡ç­¾</h3>
<p><code>&lt;img&gt;</code> æ˜¯ HTML ä¸­æœ€åŸºç¡€ä¸”å¼ºå¤§çš„å›¾ç‰‡æ ‡ç­¾ï¼Œä½†å®ƒè¿œæ¯”å¾ˆå¤šäººæƒ³è±¡çš„è¦æ™ºèƒ½ã€‚</p>
<p><strong>åŸºæœ¬è¯­æ³•ï¼š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"image.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"å›¾ç‰‡æè¿°"</span>&gt;</span>
</code></pre>
<p><strong>æ ¸å¿ƒå±æ€§ï¼š</strong></p>
<ul>
<li><code>src</code>ï¼šå›¾ç‰‡è·¯å¾„ï¼ˆå¿…éœ€ï¼‰</li>
<li><code>alt</code>ï¼šæ›¿ä»£æ–‡æœ¬ï¼ˆæ— éšœç¢å¿…éœ€ï¼‰</li>
<li><code>srcset</code>ï¼šæä¾›å¤šåˆ†è¾¨ç‡å›¾ç‰‡æº</li>
<li><code>sizes</code>ï¼šå®šä¹‰å›¾ç‰‡æ˜¾ç¤ºå°ºå¯¸</li>
<li><code>loading</code>ï¼šæ‡’åŠ è½½æ§åˆ¶</li>
</ul>
<h4 data-id="heading-1"><code>&lt;img&gt;</code> çš„å“åº”å¼èƒ½åŠ›è¢«ä½ä¼°äº†</h4>
<p>å¾ˆå¤šäººè®¤ä¸º <code>&lt;img&gt;</code> ä¸å…·å¤‡å“åº”å¼èƒ½åŠ›ï¼Œè¿™æ˜¯é”™è¯¯çš„è®¤çŸ¥ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> 
  <span class="hljs-attr">src</span>=<span class="hljs-string">"image-800w.jpg"</span>
  <span class="hljs-attr">srcset</span>=<span class="hljs-string">"image-320w.jpg 320w,
          image-480w.jpg 480w,
          image-800w.jpg 800w"</span>
  <span class="hljs-attr">sizes</span>=<span class="hljs-string">"(max-width: 600px) 100vw,
         (max-width: 1200px) 50vw,
         33vw"</span>
  <span class="hljs-attr">alt</span>=<span class="hljs-string">"å“åº”å¼å›¾ç‰‡ç¤ºä¾‹"</span>
&gt;</span>
</code></pre>
<p><strong>è¿™ç§å†™æ³•çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>æµè§ˆå™¨è‡ªåŠ¨é€‰æ‹©æœ€é€‚åˆå½“å‰å±å¹•åˆ†è¾¨ç‡çš„å›¾ç‰‡</li>
<li>æ ¹æ®è§†å£å¤§å°åŠ¨æ€è°ƒæ•´åŠ è½½çš„å›¾ç‰‡å°ºå¯¸</li>
<li>ä»£ç ç®€æ´ï¼Œæ€§èƒ½ä¼˜ç§€</li>
</ul>
<h3 data-id="heading-2"><code>&lt;picture&gt;</code> æ ‡ç­¾</h3>
<p><code>&lt;picture&gt;</code> ä¸æ˜¯ä¸ºäº†æ›¿ä»£ <code>&lt;img&gt;</code>ï¼Œè€Œæ˜¯ä¸ºäº†è§£å†³ <code>&lt;img&gt;</code> æ— æ³•å¤„ç†çš„ç‰¹å®šåœºæ™¯ã€‚</p>
<h4 data-id="heading-3"><code>&lt;picture&gt;</code> è§£å†³çš„ä¸‰å¤§æ ¸å¿ƒé—®é¢˜</h4>
<p><strong>1. è‰ºæœ¯æŒ‡å¯¼ï¼ˆArt Directionï¼‰</strong>
åœ¨ä¸åŒè®¾å¤‡ä¸Šæ˜¾ç¤ºä¸åŒæ„å›¾æˆ–è£å‰ªçš„å›¾ç‰‡ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- æ¡Œé¢ç«¯ï¼šå®½å±å…¨æ™¯ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 1200px)"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"hero-desktop.jpg"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å¹³æ¿ç«¯ï¼šé€‚ä¸­è£å‰ª --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 768px)"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"hero-tablet.jpg"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ç§»åŠ¨ç«¯ï¼šç«–ç‰ˆç‰¹å†™ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"hero-mobile.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"äº§å“å±•ç¤º"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre>
<p><strong>2. ç°ä»£æ ¼å¼é™çº§</strong>
ä¼˜å…ˆä½¿ç”¨é«˜æ•ˆæ ¼å¼ï¼ŒåŒæ—¶å…¼å®¹è€æ—§æµè§ˆå™¨ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/avif"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"image.avif"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/webp"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"image.webp"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"image.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"æ ¼å¼ä¼˜åŒ–ç¤ºä¾‹"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre>
<p><strong>3. å¤æ‚æ¡ä»¶ç»„åˆ</strong>
åŒæ—¶è€ƒè™‘å±å¹•å°ºå¯¸å’Œå›¾ç‰‡æ ¼å¼ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å¤§å± + AVIF --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 1200px)"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/avif"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"large.avif"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å¤§å± + WebP --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 1200px)"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/webp"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"large.webp"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å¤§å±é™çº§ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 1200px)"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"large.jpg"</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- ç§»åŠ¨ç«¯æ–¹æ¡ˆ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"small.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"å¤æ‚æ¡ä»¶å›¾ç‰‡"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre>
<h3 data-id="heading-4">å…³é”®åŒºåˆ«ä¸é€‰æ‹©æŒ‡å—</h3>



































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>åŸå› </th></tr></thead><tbody><tr><td><strong>åŒä¸€å›¾ç‰‡ï¼Œä¸åŒåˆ†è¾¨ç‡</strong></td><td><code>&lt;img&gt;</code> + <code>srcset</code> + <code>sizes</code></td><td>ä»£ç ç®€æ´ï¼Œæµè§ˆå™¨è‡ªåŠ¨ä¼˜åŒ–</td></tr><tr><td><strong>ä¸åŒæ„å›¾æˆ–è£å‰ª</strong></td><td><code>&lt;picture&gt;</code></td><td>è‰ºæœ¯æŒ‡å¯¼å¿…éœ€</td></tr><tr><td><strong>ç°ä»£æ ¼å¼å…¼å®¹</strong></td><td><code>&lt;picture&gt;</code></td><td>æ ¼å¼é™çº§å¿…éœ€</td></tr><tr><td><strong>ç®€å•é™æ€å›¾ç‰‡</strong></td><td><code>&lt;img&gt;</code></td><td>æ— éœ€å¤æ‚åŠŸèƒ½</td></tr><tr><td><strong>å…¼å®¹è€æ—§æµè§ˆå™¨</strong></td><td><code>&lt;img&gt;</code></td><td>æœ€å¹¿æ³›æ”¯æŒ</td></tr></tbody></table>
<h3 data-id="heading-5">å¸¸è§è¯¯åŒºçº æ­£</h3>
<p><strong>è¯¯åŒºä¸€ï¼š<code>&lt;picture&gt;</code> ç”¨äºå“åº”å¼å›¾ç‰‡</strong></p>
<ul>
<li><strong>äº‹å®ï¼š</strong> <code>&lt;img&gt;</code> é…åˆ <code>srcset</code> å’Œ <code>sizes</code> å·²ç»èƒ½å¤„ç†å¤§å¤šæ•°å“åº”å¼éœ€æ±‚</li>
<li><strong>çœŸç›¸ï¼š</strong> <code>&lt;picture&gt;</code> ä¸»è¦ç”¨äºè‰ºæœ¯æŒ‡å¯¼å’Œæ ¼å¼é™çº§</li>
</ul>
<p><strong>è¯¯åŒºäºŒï¼š<code>&lt;picture&gt;</code> æ›´ç°ä»£ï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨</strong></p>
<ul>
<li><strong>äº‹å®ï¼š</strong> åœ¨ä¸éœ€è¦è‰ºæœ¯æŒ‡å¯¼æˆ–æ ¼å¼é™çº§çš„åœºæ™¯ä¸‹ï¼Œ<code>&lt;img&gt;</code> æ˜¯æ›´å¥½çš„é€‰æ‹©</li>
<li><strong>çœŸç›¸ï¼š</strong> åˆé€‚çš„å·¥å…·ç”¨åœ¨åˆé€‚çš„åœºæ™¯æ‰æ˜¯æœ€ä½³å®è·µ</li>
</ul>
<p><strong>è¯¯åŒºä¸‰ï¼šå“åº”å¼å›¾ç‰‡ä¸€å®šè¦ç”¨ <code>&lt;picture&gt;</code></strong></p>
<ul>
<li><strong>äº‹å®ï¼š</strong> å¾ˆå¤šå“åº”å¼åœºæ™¯ç”¨ <code>&lt;img&gt;</code> + <code>srcset</code> æ›´åˆé€‚</li>
<li><strong>çœŸç›¸ï¼š</strong> è¯„ä¼°éœ€æ±‚ï¼Œé€‰æ‹©æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆ</li>
</ul>
<h3 data-id="heading-6">åœºæ™¯åˆ†æ</h3>
<h4 data-id="heading-7">åº”è¯¥ä½¿ç”¨ <code>&lt;img&gt;</code> çš„åœºæ™¯</h4>
<p><strong>ç½‘ç«™Logoï¼š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"logo.svg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"å…¬å¸Logo"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"120"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"60"</span>&gt;</span>
</code></pre>
<p><strong>ç”¨æˆ·å¤´åƒï¼š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> 
  <span class="hljs-attr">src</span>=<span class="hljs-string">"avatar.jpg"</span>
  <span class="hljs-attr">srcset</span>=<span class="hljs-string">"avatar.jpg 1x, avatar@2x.jpg 2x"</span>
  <span class="hljs-attr">alt</span>=<span class="hljs-string">"ç”¨æˆ·å¤´åƒ"</span>
  <span class="hljs-attr">width</span>=<span class="hljs-string">"80"</span> 
  <span class="hljs-attr">height</span>=<span class="hljs-string">"80"</span>
&gt;</span>
</code></pre>
<p><strong>æ–‡ç« é…å›¾ï¼š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> 
  <span class="hljs-attr">src</span>=<span class="hljs-string">"article-image.jpg"</span>
  <span class="hljs-attr">srcset</span>=<span class="hljs-string">"article-image-600w.jpg 600w,
          article-image-1200w.jpg 1200w"</span>
  <span class="hljs-attr">sizes</span>=<span class="hljs-string">"(max-width: 768px) 100vw, 600px"</span>
  <span class="hljs-attr">alt</span>=<span class="hljs-string">"æ–‡ç« æ’å›¾"</span>
  <span class="hljs-attr">loading</span>=<span class="hljs-string">"lazy"</span>
&gt;</span>
</code></pre>
<h4 data-id="heading-8">åº”è¯¥ä½¿ç”¨ <code>&lt;picture&gt;</code> çš„åœºæ™¯</h4>
<p><strong>è‹±é›„æ¨ªå¹…ï¼ˆä¸åŒè£å‰ªï¼‰ï¼š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 1024px)"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"hero-wide.jpg"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">media</span>=<span class="hljs-string">"(min-width: 768px)"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"hero-square.jpg"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"hero-mobile.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"äº§å“æ¨ªå¹…"</span> <span class="hljs-attr">loading</span>=<span class="hljs-string">"eager"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre>
<p><strong>äº§å“å±•ç¤ºï¼ˆæ ¼å¼ä¼˜åŒ–ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/avif"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"product.avif"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/webp"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"product.webp"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"product.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"äº§å“è¯¦æƒ…"</span> <span class="hljs-attr">loading</span>=<span class="hljs-string">"lazy"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre>
<h3 data-id="heading-9">æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-10">1. å§‹ç»ˆéµå¾ªçš„è§„åˆ™</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- æ­£ç¡®ï¼šå§‹ç»ˆæä¾› alt å±æ€§ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"photo.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"æè¿°æ–‡æœ¬"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- é”™è¯¯ï¼šç¼ºå°‘ alt å±æ€§ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"photo.jpg"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- è£…é¥°æ€§å›¾ç‰‡ä½¿ç”¨ç©º alt --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"decoration.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span>&gt;</span>
</code></pre>
<h4 data-id="heading-11">2. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ä¼˜å…ˆåŠ è½½å…³é”®å›¾ç‰‡ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"hero.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"é‡è¦å›¾ç‰‡"</span> <span class="hljs-attr">loading</span>=<span class="hljs-string">"eager"</span> <span class="hljs-attr">fetchpriority</span>=<span class="hljs-string">"high"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- éå…³é”®å›¾ç‰‡å»¶è¿ŸåŠ è½½ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"content-image.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"å†…å®¹å›¾ç‰‡"</span> <span class="hljs-attr">loading</span>=<span class="hljs-string">"lazy"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- æŒ‡å®šå°ºå¯¸é¿å…å¸ƒå±€åç§» --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"product.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"å•†å“"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"400"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span>&gt;</span>
</code></pre>
<h4 data-id="heading-12">3. ç°ä»£å›¾ç‰‡æ ¼å¼ç­–ç•¥</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ä¼˜å…ˆä½¿ç”¨AVIFï¼Œå‹ç¼©ç‡æœ€é«˜ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/avif"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"image.avif"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å…¶æ¬¡WebPï¼Œå¹¿æ³›æ”¯æŒ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/webp"</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"image.webp"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- æœ€ç»ˆå›é€€åˆ°JPEG --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"image.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"ç°ä»£æ ¼å¼ç¤ºä¾‹"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p><code>&lt;img&gt;</code> å’Œ <code>&lt;picture&gt;</code> ä¸æ˜¯ç«äº‰å…³ç³»ï¼Œè€Œæ˜¯äº’è¡¥çš„å·¥å…·ï¼š</p>
<ul>
<li><strong><code>&lt;img&gt;</code></strong>ï¼šå¤„ç†å¤§å¤šæ•°æ—¥å¸¸å›¾ç‰‡éœ€æ±‚ï¼Œç‰¹åˆ«æ˜¯åˆ†è¾¨ç‡é€‚é…</li>
<li><strong><code>&lt;picture&gt;</code></strong>ï¼šè§£å†³ç‰¹å®šå¤æ‚åœºæ™¯ï¼Œå¦‚è‰ºæœ¯æŒ‡å¯¼å’Œæ ¼å¼é™çº§</li>
</ul>
<p><strong>æ ¸å¿ƒå»ºè®®ï¼š</strong></p>
<ol>
<li>ä»æœ€ç®€å•çš„ <code>&lt;img&gt;</code> å¼€å§‹ï¼Œåªåœ¨å¿…è¦æ—¶å‡çº§åˆ° <code>&lt;picture&gt;</code></li>
<li>å……åˆ†åˆ©ç”¨ <code>&lt;img&gt;</code> çš„ <code>srcset</code> å’Œ <code>sizes</code> å±æ€§</li>
<li>ä¸ºå…³é”®å›¾ç‰‡ä½¿ç”¨ <code>&lt;picture&gt;</code> è¿›è¡Œæ ¼å¼ä¼˜åŒ–</li>
<li>å§‹ç»ˆè€ƒè™‘æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ</li>
</ol>
<p>æŒæ¡è¿™ä¸¤ä¸ªæ ‡ç­¾çš„æ­£ç¡®ç”¨æ³•ï¼Œä½ å°±èƒ½åœ¨å„ç§åœºæ™¯ä¸‹éƒ½åšå‡ºæœ€åˆé€‚çš„æŠ€æœ¯é€‰æ‹©ï¼Œæ—¢ä¿è¯ç”¨æˆ·ä½“éªŒï¼Œåˆé¿å…è¿‡åº¦å·¥ç¨‹åŒ–ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æŒ‡å—èƒ½å¸®åŠ©ä½ å½»åº•ç†è§£è¿™ä¸¤ä¸ªé‡è¦çš„HTMLæ ‡ç­¾ï¼</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜åˆ˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote>
<h4 data-id="heading-14">ğŸ“Œå¾€æœŸç²¾å½©</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F72THiVPtsrA2xvtHmdDLmA" target="_blank" title="https://mp.weixin.qq.com/s/72THiVPtsrA2xvtHmdDLmA" ref="nofollow noopener noreferrer">ã€ŠSpringBoot+Vue3 æ•´åˆ SSE å®ç°å®æ—¶æ¶ˆæ¯æ¨é€ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FP7SMincYFKERZbNKAFtzGQ" target="_blank" title="https://mp.weixin.qq.com/s/P7SMincYFKERZbNKAFtzGQ" ref="nofollow noopener noreferrer">ã€Šè¿™20æ¡SQLä¼˜åŒ–æ–¹æ¡ˆï¼Œè®©ä½ çš„æ•°æ®åº“æŸ¥è¯¢é€Ÿåº¦æå‡10å€ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FgQK9L1TxKL50FUVMcgh6JQ" target="_blank" title="https://mp.weixin.qq.com/s/gQK9L1TxKL50FUVMcgh6JQ" ref="nofollow noopener noreferrer">ã€ŠSpringBoot åŠ¨æ€èœå•æƒé™ç³»ç»Ÿè®¾è®¡çš„ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FPQ_w7CDVoIZPn-CVH2DKJg" target="_blank" title="https://mp.weixin.qq.com/s/PQ_w7CDVoIZPn-CVH2DKJg" ref="nofollow noopener noreferrer">ã€ŠVue3å’ŒVue2çš„æ ¸å¿ƒåŒºåˆ«ï¼Ÿå¾ˆå¤šå¼€å‘è€…éƒ½æ²¡å®Œå…¨ææ‡‚çš„10ä¸ªç»†èŠ‚ã€‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIç‹¬å­¤ä¹å‰‘ï¼šAIæ²¡æœ‰åœºæ™¯ï¼Œæ— æ³•è½åœ°ï¼Ÿä¸å­˜åœ¨çš„ã€‚]]></title>    <link>https://juejin.cn/post/7577307100130689074</link>    <guid>https://juejin.cn/post/7577307100130689074</guid>    <pubDate>2025-11-28T06:30:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577307100130689074" data-draft-id="7577395040592379914" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIç‹¬å­¤ä¹å‰‘ï¼šAIæ²¡æœ‰åœºæ™¯ï¼Œæ— æ³•è½åœ°ï¼Ÿä¸å­˜åœ¨çš„ã€‚"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-28T06:30:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è…¾è®¯äº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3456520257538830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIç‹¬å­¤ä¹å‰‘ï¼šAIæ²¡æœ‰åœºæ™¯ï¼Œæ— æ³•è½åœ°ï¼Ÿä¸å­˜åœ¨çš„ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520257538830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è…¾è®¯äº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:30:15.000Z" title="Fri Nov 28 2025 06:30:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>*æœ¬æ–‡èŠ‚é€‰è‡ªæ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿäº¤æµåœˆ ä½œè€…ä¸ºè…¾è®¯äº‘æ¶æ„å¸ˆåŒç›Ÿåäººå ‚ä¸“å®¶&amp;ä¸­å›½ä¿¡æ¯é€šä¿¡ç ”ç©¶é™¢ä½ä»£ç /æ— ä»£ç æ¨èä¸­å¿ƒæŠ€æœ¯ä¸“å®¶ï½œæ²ˆæ¬£</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19ce352c0fde4de79d23a521a865125d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764916215&amp;x-signature=O1w2Wnpa1qkLQAJYKU%2BwbJ%2F8bLs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0"><strong>å¼•è¨€</strong></h2>
<p>S.H.Eæœ‰é¦–æ­Œçš„æ­Œè¯æ˜¯â€œå…¨ä¸–ç•Œéƒ½åœ¨è¯´ä¸­å›½è¯â€ï¼Œè€Œä»Šï¼Œå…¨ä¸–ç•Œçš„CIOä»¬éƒ½åœ¨æ‰¾AIçš„è½åœ°åœºæ™¯ã€‚</p>
<p>å› ä¸ºä¸å»è½åœ°AIï¼Œè€æ¿ä¼šè®¤ä¸ºä½ å·²ç»è¿‡æ—¶ï¼Œè·Ÿä¸ä¸Šæ–°äº‹ç‰©ï¼Œåº”è¯¥æ·˜æ±°ï¼›å»è½åœ°AIï¼Œä¸‡ä¸€æ²¡æœ‰å¥½çš„é«˜å›æŠ¥åœºæ™¯ï¼Œè€æ¿ä¼šè®¤ä¸ºä½ èƒ½åŠ›ä¸è¶³ï¼Œåº”è¯¥æ·˜æ±°ã€‚æ­£æ‰€è°“ä¸ä¸ŠAIæ˜¯ç­‰æ­»ï¼Œä¸ŠAIæ˜¯æ‰¾æ­»ã€‚</p>
<p>AIçš„åœºæ™¯çœŸçš„å¾ˆéš¾æ‰¾ï¼ŒçœŸçš„æ— æ³•è½åœ°ä¹ˆï¼Ÿä¸å­˜åœ¨çš„ã€‚å‡å¦‚è¯´AIè¿™ç§å·¥å…·æ˜¯ä¸€æŠŠåˆ©å‰‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æº¯æœ¬è¿½æºï¼Œä»ä¸­å›½æ™ºæ…§çš„æ•…çº¸å †é‡Œæ‰¾ä¸€æ‰¾è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-1">01</h2>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œé‡‘åº¸ä¸–ç•Œæœ€å¼ºçš„å‰‘æ³•æ˜¯ç‹¬å­¤ä¹å‰‘ï¼ˆé‡‘åº¸è¯´ä»–å°è¯´é‡Œé¢æœ€å‰å®³çš„äººç‰©æœ‰ä¸‰ä¸ªï¼šç‹¬å­¤æ±‚è´¥ã€è¾¾æ‘©ã€å¼ ä¸‰ä¸°ï¼Œä»–ä»¬ä¸‰ä¸ªæ­¦åŠŸä¸ç›¸ä¸Šä¸‹ å¦‚æœéè¦é€‰ä¸€ä¸ªå°±æ˜¯ç‹¬å­¤æ±‚è´¥ï¼‰ã€‚</p>
<p>é‚£ä¹ˆå¦‚æœAIæ˜¯å‰‘ï¼Œæˆ‘ä»¬æ€æ ·ç‚¼æˆç‹¬å­¤ä¹å‰‘å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œç‹¬å­¤ä¹å‰‘æœ‰ä¹å¼ï¼šæ€»è¯€å¼ã€ç ´å‰‘å¼ã€ç ´åˆ€å¼ã€ç ´æªå¼ã€ç ´é­å¼ã€ç ´ç´¢å¼ã€ç ´ç®­å¼ã€ç ´æŒå¼ä»¥åŠç ´æ°”å¼ã€‚ç‹¬å­¤ä¹å‰‘æœ‰ä¸‰å¤§è¦è¯€ï¼šæ— æ‹›èƒœæœ‰æ‹›ï¼Œæ–™æ•Œæœºå…ˆï¼Œæœ‰è¿›æ— é€€ã€‚æ€»çº²å†…å®¹ï¼šå‘¨æ˜“æœ‰äº‘ã€Œå½’å¦¹è¶‹æ— å¦„ã€æ— å¦„è¶‹åŒäººã€åŒäººè¶‹å¤§æœ‰ã€ç”²è½¬ä¸™ã€ä¸™è½¬åºšã€åºšè½¬ç™¸ã€å­ä¸‘ä¹‹äº¤ã€è¾°å·³ä¹‹äº¤ã€åˆæœªä¹‹ äº¤ã€é£é›·æ˜¯ä¸€å˜ã€å±±æ³½æ˜¯ä¸€å˜ã€æ°´ç«æ˜¯ä¸€å˜ã€ä¹¾å¤ç›¸æ¿€ã€éœ‡å…‘ç›¸æ¿€ã€ç¦»å·½ç›¸æ¿€ã€ä¸‰å¢è€Œæˆäº”ã€äº”å¢è€Œæˆä¹â€¦â€¦ã€ä¹å‰‘å…¶å®ä¸æ˜¯ä¸€èˆ¬æ¦‚å¿µä¸­çš„å‰‘æ³•æ‹›å¼ï¼Œè€Œæ˜¯ä¸€å¥—æ­¦å­¦ç†è®ºï¼Œæ‰€ä»¥é£æ¸…æ‰¬ä¼šè¯´è¦çœ‹æ‚Ÿæ€§ã€‚</p>
<p>å¥½å§ï¼Œçœ‹èµ·æ¥ï¼Œç‹¬å­¤ä¹å‰‘å°±æ˜¯ä¸€å¥—åº”å¯¹å˜åŒ–çš„ä½“ç³»ã€‚å—¯å—¯ï¼Œç†Ÿæ‚‰æˆ‘çš„åŒå­¦éƒ½çŸ¥é“ï¼Œæˆ‘ä¹Ÿæœ‰ä¸€å¥—åº”å¯¹å˜åŒ–çš„ä½“ç³»ï¼Œç§°ä¹‹ä¸ºITPAOï¼Œåœ¨å…¶ä¸­AIä»¥æ•°å­—å‘˜å·¥èº«ä»½èµ·åˆ°äº†éå¸¸å¤§çš„ä½œç”¨ï¼Œåˆšå¥½æˆ‘ä»¬å°±æ­¤ä¸€ä¸€å¯¹ç…§ï¼Œæ¥å¸®åŠ©å¤§å®¶æ‰¾åˆ°æ›´å¥½çš„AIè½åœ°åœºæ™¯ã€‚</p>
<p>æˆ‘ä»¬å…ˆç®€å•å›é¡¾ä¸€ä¸‹ITPAOï¼Œæœ¬è´¨å°±æ˜¯å»ºç«‹ä¸€å¥—ä»è¾“å…¥åˆ°è¾“å‡ºçš„åŠ¨æ€è¿‡ç¨‹ï¼Œæ ¸å¿ƒèŠ‚ç‚¹æ˜¯TPAï¼Œä¹Ÿå³ <em>â€œç›®æ ‡è®¾å®šâ€ï¼Œâ€œæ‰§è¡Œè§„åˆ’â€ï¼Œâ€œå…·ä½“æ‰§è¡Œâ€</em> ï¼Œè€Œè¿™ä¸‰éƒ¨åˆ†åœ¨å®é™…å·¥ä½œä¸­ï¼Œéƒ½ä¼šæ—¶ä¸æ—¶çš„å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå¯¼è‡´è¾“å‡ºç»“æœä¸ç†æƒ³ã€‚åœ¨ITPAOæµç¨‹ä¸­ï¼Œé€šè¿‡åˆé¦ˆåˆ¶å¼•å…¥äº†æ•°å­—å‘˜å·¥åï¼Œç”±æ•°å­—å‘˜å·¥æ¥å‘ç°å’Œç†è§£<em>å˜åŒ–</em>ï¼Œå¹¶ä¸”é’ˆå¯¹<em>å˜åŒ–</em>è¿›è¡ŒåŠæ—¶è°ƒæ•´ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ï¼š<em>åŠ¨æ€è®¾å®šç›®æ ‡ã€åŠ¨æ€è°ƒæ•´è§„åˆ’ã€åŠ¨æ€è·Ÿè¸ªæ‰§è¡Œ</em>ã€‚</p>
<p>ä»è¿™ä¸ªç»´åº¦ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç‹¬å­¤ä¹å‰‘çš„æ¯ä¸€å¼éƒ½çœ‹ä½œåº”å¯¹æŸä¸€ç±»å˜åŒ–çš„æ‰‹æ®µï¼š</p>























































<table><thead><tr><th>å‰‘å¼</th><th>ç‰¹ç‚¹</th><th>ç°å®æ˜ å°„</th></tr></thead><tbody><tr><td>ç ´å‰‘</td><td>å‰‘ä»¥åˆºä¸ºä¸»ï¼›å¯ä»¥ç†è§£ä¸ºå•ç‚¹çªå˜ï¼ŒæŸä¸ªå˜é‡çªç„¶å˜åŒ–ï¼Œ0ç»´å˜åŒ–ï¼Œä¼šæŒç»­ç§¯ç´¯ä¼¤åŠ¿</td><td>çªå‘çš„å•ç‚¹é—®é¢˜ï¼Œä¾‹å¦‚æŸä¸ªæµç¨‹ä¸­é‡è¦å²—ä½èµ„æºçªç„¶æ¶ˆå¤±ï¼›æŸä¸ªå®¢æˆ·çªç„¶å–æ¶ˆè®¢å•ã€‚</td></tr><tr><td>ç ´åˆ€</td><td>åˆ€ä»¥åŠˆç ä¸ºä¸»ï¼›ä¸€ç»´å˜åŒ–ï¼Œä¸€æ—¦å‘½ä¸­ï¼Œå°±æ˜¯è¾ƒå¤§çš„ä¼¤å®³</td><td>çªå‘çš„çº¿çŠ¶é—®é¢˜ï¼Œä¾‹å¦‚æŸæ¡äº§å“çº¿é‡åˆ°äº†å¼ºåŠ²çš„ç«äº‰å¯¹æ‰‹æ–°å“ï¼›é«˜ç®¡å‡ºç°è´Ÿé¢èˆ†æƒ…</td></tr><tr><td>ç ´æª</td><td>é•¿å…µåˆƒï¼Œä»¥æŒ‘ã€æ‰«ä¸ºä¸»ï¼›èµ·åˆæ˜¯ç‚¹çŠ¶æ”»å‡»ä¼šæ¼”å˜ä¸ºç‰‡çŠ¶ï¼ŒåŠ¿å¤§ï¼Œä»äºŒç»´å˜åŒ–ï¼Œå¾ˆå®¹æ˜“æ‰©å¤§åˆ°ä¸‰ç»´å˜åŒ–</td><td>æ”¿ç­–æ³•è§„å˜åŒ–ï¼›æŸæ‰¹åŸæ–™å‡ºç°ä¾›åº”é“¾é—®é¢˜ï¼›çªç„¶å‡ºç°çš„ç°é‡‘æµé—®é¢˜</td></tr><tr><td>ç ´ç´¢</td><td>ç´¢æ˜¯è½¯å…µåˆƒï¼Œä¸­é€”æ‹¦æˆªæ— ç”¨ï¼Œæœ«ç«¯è¿˜æ˜¯ä¼šæ‰“ä¸Šæ¥</td><td>ç«å¯¹é«˜è–ªæŒ–äººï¼Œäººå‘˜æµå¤±</td></tr><tr><td>ç ´é­</td><td>é’¢é­ ã€é“é”ã€è›¾çœ‰åˆºã€æ¿æ–§ç­‰ç­‰çŸ­å…µåˆƒâ€¦æ”»é€Ÿæ…¢ï¼Œä½†æ˜¯ç¢°åˆ°è¦å®³æ€ä¼¤åŠ›å¼º</td><td>é’ˆå¯¹æˆ‘ä»¬çš„ä¸»åŠ›è½¯ä»¶äº§å“ï¼Œå‡ºç°äº†å¼€æºçš„å…è´¹äº§å“ï¼›ä¸´æ—¶é™ç”µï¼Œå·¥å‚éœ€è¦åœå·¥ä¸€å¤©</td></tr><tr><td>ç ´ç®­</td><td>è¿œç¨‹æ”»å‡»â€”â€”é€Ÿåº¦å¿«ï¼Œå¤§å¤šä¸ºå°ä¼¤å®³,ä½†æœ‰è¿¹å¯å¾ª</td><td>æŸæ‰¹æ¬¡äº§å“è´¨é‡å‡ºç°é—®é¢˜ï¼› æ¥å®¢æ•°æŒç»­é™ä½</td></tr><tr><td>ç ´æŒ</td><td>æ‰‹æä¸ºçµæ´»ï¼Œç»„åˆæ‹³ï¼Œç«äº‰å¯¹æ‰‹</td><td>å¯¹æ‰‹çš„æ–°è¥é”€æ–¹æ¡ˆé’ˆé”‹ç›¸å¯¹ï¼Œå¯¼è‡´æˆ‘ä»¬é”€é‡ä¸‹é™</td></tr><tr><td>ç ´æ°”</td><td>ä¸Šä¹˜å†…åŠŸï¼Œå°±åƒå¼ºå¤§çš„è¡Œä¸šé¾™å¤´</td><td>æŒ‘æˆ˜è¡Œä¸šé¾™å¤´æ—¶é¢ä¸´çš„å„ç§ä¸å¯çŸ¥å˜åŒ–</td></tr><tr><td>æ€»è¯€</td><td>å‘¨æ˜“æœ‰äº‘ã€Œå½’å¦¹è¶‹æ— å¦„ã€æ— å¦„è¶‹åŒäººã€åŒäººè¶‹å¤§æœ‰ã€ç”²è½¬ä¸™ã€ä¸™è½¬åºšã€åºšè½¬ç™¸ã€å­ä¸‘ä¹‹äº¤ã€è¾°å·³ä¹‹äº¤ã€åˆæœªä¹‹ äº¤ã€é£é›·æ˜¯ä¸€å˜ã€å±±æ³½æ˜¯ä¸€å˜ã€æ°´ç«æ˜¯ä¸€å˜ã€ä¹¾å¤ç›¸æ¿€ã€éœ‡å…‘ç›¸æ¿€ã€ç¦»å·½ç›¸æ¿€ã€ä¸‰å¢è€Œæˆäº”ã€äº”å¢è€Œæˆä¹â€¦â€¦ã€ ä¸‡äº‹éƒ½åœ¨å˜åŒ–ï¼Œå˜åŒ–è¿‡ç¨‹æ˜¯æœ‰è§„å¾‹çš„ï¼Œå˜åŒ–çš„å‘ç”Ÿæ˜¯æ— è§„å¾‹çš„</td><td>ITPAOï¼š ä¸Šæ¸¸èµ„æºå¯èƒ½å˜åŒ– ç›®æ ‡å¯èƒ½å˜åŒ– è®¡åˆ’å¯èƒ½å˜åŒ– æ‰§è¡Œè¿‡ç¨‹å¯èƒ½å˜åŒ– å†²çªç‚¹æ˜¯æœ‰è§„å¾‹çš„ï¼Œå˜åŒ–ä¼šäº’ç›¸å½±å“ï¼Œæœ€åå½¢æˆä¸å¯é¢„æ–™çš„ç»“æœã€‚</td></tr></tbody></table>
<h2 data-id="heading-2">02</h2>









































<table><thead><tr><th>å†…å®¹</th><th>è¯´æ˜</th><th>æ•°æ®åŠçŸ¥è¯†æ”¯æŒ</th><th>é€»è¾‘å…³ç³»</th></tr></thead><tbody><tr><td>Iâ€”è¾“å…¥</td><td>ä¸‰ç±»è¾“å…¥ï¼šèµ„æºã€è¾¹ç•Œï¼Œç»“æ„ï¼› èµ„æºã€è¾¹ç•Œç”±ä¸Šä¸€ç¯èŠ‚æµå…¥ï¼Œç»“æ„å®šä¹‰è¾“å‡ºçš„ç»“æ„</td><td>æ•°æ®ã€èµ„æºã€å­˜å‚¨</td><td>å¯è¢«è·Ÿè¸ªï¼Œå¯è¢«æ‹†è§£ï¼Œå¯è¢«æ±‡æ€»ï¼Œå¿«é€Ÿå‘ç°å†²çªé—®é¢˜</td></tr><tr><td>Tâ€”ç›®æ ‡</td><td>å¤–éƒ¨è¾“å…¥è½¬å˜ä¸ºå†…éƒ¨å¯æ¸…æ™°å®šä¹‰çš„ç›®æ ‡ã€‚ç”±äºè¾“å…¥æ¡ä»¶çš„å˜åŒ–ï¼Œè¾“å‡ºèŒƒå›´çš„å˜åŒ–å¯è¿›è¡ŒåŠ¨æ€è°ƒæ•´</td><td>çŸ¥è¯†åº“ï¼Œæ¸…æ™°æ— æ­§ä¹‰ï¼Œå¯é‡åŒ–çš„ç›®æ ‡</td><td>åŠ¨æ€ç›®æ ‡è°ƒæ•´ã€é¢„æµ‹ã€èµ„æºå†²çªï¼Œæ—¶é—´å†²çª</td></tr><tr><td>Pâ€”è®¡åˆ’</td><td>æ ¹æ®ç›®æ ‡å’Œèƒ½åŠ›ï¼Œè¿›è¡Œæ‹†è§£ï¼Œæ ¸å¿ƒæ˜¯èµ„æºå’Œè¾¹ç•Œï¼Œè§„åˆ’ç”¨ä»€ä¹ˆèµ„æºåœ¨ä»€ä¹ˆæ—¶é—´åšä»€ä¹ˆæœ€åˆç†å’Œé«˜æ•ˆ</td><td>å¯ç”¨èµ„æºã€å†²çªå…³ç³»ã€æ—¶åºã€å®æ—¶è®¡åˆ’è¡¨</td><td>æ—¶åºå†²çªã€ç©ºé—´å†²çªã€èµ„æºå†²çªã€ç›®æ ‡èŠ‚ç‚¹</td></tr><tr><td>Aâ€”è¡ŒåŠ¨</td><td>å…·ä½“çš„è¡ŒåŠ¨ï¼Œé€šè¿‡å¯¹èµ„æºå’Œæ—¶é—´çš„æ¶ˆè€—ï¼Œè¿›è¡Œå…·ä½“çš„è¡ŒåŠ¨ï¼Œä»¥è¾¾åˆ°è¾“å‡ºç»“æœ</td><td>å¯ç”¨èµ„æºã€ç»„ç»‡ã€å®é™…è¡ŒåŠ¨èƒ½åŠ›ã€æ‰§è¡Œå¯¹è±¡</td><td>ç°æœ‰èµ„æºã€ç°æœ‰äº§å‡ºã€åå·®ã€é¢„æµ‹</td></tr><tr><td>Oâ€”è¾“å‡º</td><td>è¾“å‡ºèµ„æºå˜åŒ–ï¼Œä¼ å¯¼ç»™ä¸‹ä¸€å±‚ï¼Œå¹¶å¯¹Iå®šä¹‰çš„è¾“å‡ºè¿›è¡Œåé¦ˆã€‚</td><td>èµ„æºã€è¾¹ç•Œï¼Œç»“æ„</td><td>ä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥</td></tr></tbody></table>
<p>åŸºäºITPAOçš„ç³»ç»Ÿç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸šåŠ¡ä¸­å¯èƒ½äº§ç”Ÿçš„å†²çªä¸å˜åŒ–ï¼ˆç»¿è‰²éƒ¨åˆ†ï¼‰ç­‰åŒäºä¸åŒæ‹›å¼å¯¹æˆ‘ä»¬çš„æ”»å‡»ï¼ˆ<em><strong>æœ‰ç§ç§å˜åŒ–ï¼Œç”¨ä»¥ä½“æ¼”æ€»è¯€ï¼Œå…±æœ‰ä¸‰ç™¾å…­åç§å˜åŒ–ã€‚ä¸´æ•Œæ—¶ï¼Œå¯ä»¥æ­¤ä¸ºåŸºç¡€ï¼Œå°†å…«å¼å‰‘æ„ï¼Œèå…¥å…¶ä¸­ï¼Œè¾¾åˆ°ä¹å‰‘å½’ä¸€çš„ç¨‹åº¦</strong></em>ï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d83f241122f4889ad8f8530a06d4ee8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764916215&amp;x-signature=5m7fWMiE3leQ8QNHNwjz6wqnysw%3D" alt="" loading="lazy"/></p>
<p>å¦å¤–ï¼Œç‹¬å­¤ä¹å‰‘æœ‰ä¸‰å¤§è¦è¯€</p>

























<table><thead><tr><th>è¦è¯€</th><th>è¡¨è±¡</th><th>AIåº”ç”¨é€»è¾‘</th></tr></thead><tbody><tr><td>æ— æ‹›èƒœæœ‰æ‹›</td><td>ä¸è¦æ€¥ç€å‡ºæ‰‹ï¼Œå…ˆæ‰¾æ‹›å¼ä¸­çš„ç ´ç»½</td><td>å®ˆæ­£å‡ºå¥‡ï¼Œæœ‰è‡ªå·±çš„åŸºç¡€æµç¨‹ï¼Œæœ‰åº”å¯¹å¤–éƒ¨å˜åŒ–çš„èƒ½åŠ›</td></tr><tr><td>æ–™æ•Œæœºå…ˆ</td><td>èƒ½æ‰¾åˆ°æ•Œäººçš„ç ´ç»½</td><td>AIçš„èƒ½åŠ›éœ€è¦çŸ¥è¯†æ”¯æ’‘</td></tr><tr><td>æœ‰è¿›æ— é€€</td><td>åªæ”»ä¸å®ˆï¼Œæ”»å…¶å¿…æ•‘</td><td>è§£å†³é—®é¢˜çš„ä¼˜å…ˆçº§å¾ˆé‡è¦ï¼Œè¿˜è¦æœ‰å…³äºåˆ›æ–°çš„å‹‡æ°”</td></tr></tbody></table>
<p>çœŸæ­£çš„æ­¦åŠŸï¼Œæ˜¯è‡ªæ´½çš„ï¼Œæ˜¯å¯ä»¥è¿­ä»£çš„å¤æ‚ä½“ç³»ï¼Œè€Œä¸æ˜¯ç®€å•çš„â€œåŒ–è½¬å‘ã€é—ªç”µäº”è¿é­â€ã€‚</p>
<p>å…¶ä»–çš„ä¸€äº›æ€è€ƒï¼š</p>
<ul>
<li><em><strong>â€œç‹¬å­¤å‰è¾ˆæ˜¯ç»é¡¶èªæ˜ä¹‹äººï¼Œå­¦ä»–çš„å‰‘æ³•ï¼Œè¦æ—¨æ˜¯åœ¨ä¸€ä¸ªâ€˜æ‚Ÿâ€™å­—ï¼Œå†³ä¸åœ¨æ­»è®°ç¡¬èƒŒã€‚ç­‰åˆ°é€šæ™“äº†è¿™ä¹å‰‘çš„å‰‘æ„ï¼Œåˆ™æ— æ‰€æ–½è€Œä¸å¯ï¼Œæ— æ‰€ä¸å‡ºï¼Œæ— æ‰€ä¸å…¥ï¼Œä¾¿æ˜¯å°†å…¨éƒ¨å˜åŒ–å°½æ•°å¿˜è®°ï¼Œä¹Ÿä¸ç›¸å¹²ï¼Œä¸´æ•Œä¹‹é™…ï¼Œæ›´æ˜¯å¿˜è®°å¾—è¶Šå¹²å‡€å½»åº•ï¼Œè¶Šä¸å—åŸæ¥å‰‘æ³•çš„æ‹˜æŸã€‚â€</strong></em></li>
</ul>
<p>ä»æ•°æ®ï¼Œä¿¡æ¯ï¼Œå˜æˆè‚Œè‚‰è®°å¿†â€”â€”&gt; ç»éªŒâ€”â€”&gt;çŸ¥è¯†ï¼Œæœ€åAIé«˜æ•ˆè°ƒç”¨çŸ¥è¯†ã€‚</p>
<ul>
<li><em><strong>â€œåœ¨åå±±å±±æ´ä¸­ï¼Œå› çœ¼ä¸è§ç‰©ï¼Œæ— æ³•æ‰¾åˆ°å¯¹æ‰‹ç ´ç»½ï¼Œæœ€åæ„å¤–é é­”æ•™åé•¿è€çš„è…¿éª¨ä¸­çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fcloud.tencent.com%2Fdeveloper%2Ftools%2Fblog-entry%253Ftarget%253Dhttps%25253A%25252F%25252Fbaike.baidu.com%25252Fitem%25252F%252525E7%252525A3%252525B7%252525E5%25252585%25252589%25252F2942760%25253FfromModule%25253Dlemma_inlink%2526objectId%253D2528557%2526objectType%253D1%2526contentType%253Dundefined" target="_blank" title="https://link.zhihu.com/?target=https%3A//cloud.tencent.com/developer/tools/blog-entry%3Ftarget%3Dhttps%253A%252F%252Fbaike.baidu.com%252Fitem%252F%2525E7%2525A3%2525B7%2525E5%252585%252589%252F2942760%253FfromModule%253Dlemma_inlink%26objectId%3D2528557%26objectType%3D1%26contentType%3Dundefined" ref="nofollow noopener noreferrer">ç£·å…‰</a>å¾—ä»¥è§åˆ° å¯¹æ‰‹æ­¦åŠŸï¼Œæ‰å¾—ä»¥æ–½å±•å‰‘æ³•ã€‚â€......â€œç‹¬ç‹ä¹å‰‘â€çš„è¦æ—¨ï¼Œåœ¨äºä¸€çœ¼è§åˆ°å¯¹æ–¹æ‹›å¼ä¸­çš„ç ´ç»½ï¼Œä¾¿å³ä¹˜è™šè€Œå…¥ï¼Œåå‘å…ˆè‡³ï¼Œä¸€æ‹›åˆ¶èƒœã€‚</strong></em></li>
</ul>
<p>ä¿¡æ¯ç³»ç»Ÿçš„æ•°æ®æ˜¯åŸºç¡€ï¼Œç¼ºå°‘æ•°æ®ï¼Œæˆäº†çå­ï¼Œå†å¥½çš„å‰‘æ³•ä¹Ÿæ²¡ç”¨ã€‚</p>
<ul>
<li><em><strong>â€œä»¤ç‹å†²å­¦ä¼šç‹¬å­¤ä¹å‰‘åæ£‹é€¢å¯¹æ‰‹ç”šè‡³å·®ç‚¹è½è´¥çš„æ˜¯ä¸œæ–¹ä¸è´¥ã€‚â€</strong></em></li>
</ul>
<p>å°±åƒä»Šå¤©çš„ç¾å›½ï¼ŒæŠŠè‡ªå·±å‰²äº†ä»¥åï¼Œå„ç§æ‹›å¼è¯¡å¼‚å¤šå˜ï¼Œå…³ç¨æ”¿ç­–ä¸€æ—¥å¤šå˜ï¼Œå„ç§å¼ºæƒå‹åˆ¶ï¼Œè¿™ä¹Ÿæ˜¯å˜åŒ–å¸¦æ¥çš„æœ€å¤§æŒ‘æˆ˜ã€‚</p>
<p>ä»¤ç‹å†²æ˜¯æ€ä¹ˆæ‰“èµ¢ä¸œæ–¹ä¸è´¥ï¼Ÿä»»ç›ˆç›ˆåœ¨è¾¹ä¸Šå¯¹æ¨è²äº­ä¸‹æ‰‹å¹²æ‰°äº†ä¸œæ–¹ä¸è´¥â€¦â€¦å½“AIçš„åˆ©å‰‘é‡åˆ°äº†æ— æ³•æ–©æ–­çš„æ•Œäººï¼Œæˆ‘ä»¬éœ€è¦äººæœºç»“åˆè¿›è¡Œå…œåº•ã€‚æŸä¼ä¸šä¸Šçº¿AIå®¢æœåæ•ˆæœå¾ˆæ£’ï¼Œå› æ­¤è£æ‰äº†å¤§é‡çš„çœŸäººå®¢æœï¼Œåæ¥æ–°å“å‡ºç°æ—¶ï¼ŒAIé’ˆå¯¹è¿™ä¸ªæ–°å“çš„å®¢æœå‡ºç°é—®é¢˜ï¼Œç«‹åˆ»é™·å…¥ç„¦å¤´çƒ‚é¢çš„å±€é¢ã€‚å› æ­¤ï¼Œåœ¨AIè½åœ°æ—¶ï¼Œå¿…é¡»è€ƒè™‘å…œåº•çš„é—®é¢˜ï¼Œè€Œå¥½çš„åˆä½œä¼™ä¼´èƒ½å¤Ÿæ‹¯æ•‘ä½ äºæ°´ç«ä¹‹ä¸­ã€‚</p>
<ul>
<li><em><strong>é»„é’Ÿå…¬ä¸çŸ¥å¯¹ä»¤ç‹å†²çš„å‰‘æ³•å´ä¹Ÿæ˜¯é«˜ä¼°äº†ã€‚â€œç‹¬å­¤ä¹å‰‘â€æ˜¯æ•Œå¼ºæ„ˆå¼ºï¼Œæ•Œäººå¦‚æœæ­¦åŠŸä¸é«˜ï¼Œâ€œç‹¬å­¤ä¹å‰‘â€çš„ç²¾è¦å¤„ä¹Ÿå°±ç”¨ä¸ä¸Šã€‚</strong></em></li>
</ul>
<p>AIçš„æ•ˆç‡æå‡ï¼Œæ›´é€‚åˆåšä¸€äº›å¤æ‚çš„ï¼Œäººè„‘æ— æ³•å¤„ç†çš„å·¥ä½œï¼Œä¾‹å¦‚ï¼Œéœ€è¦è¿ç»­é«˜å¼ºåº¦æ€è€ƒï¼Œéœ€è¦ç»¼åˆå¾ˆå¤šä¿¡æ¯ï¼Œéœ€è¦åœ¨å¤æ‚çš„å…³ç³»ä¸­æ‰¾åˆ°é€»è¾‘ã€‚åœ¨è¿™äº›åœºæ™¯ï¼ŒAIæ‰èƒ½å¤Ÿå‘æŒ¥æ›´å¤§çš„ä½œç”¨ã€‚</p>
<p>å‰‘åªæ˜¯å·¥å…·ï¼ŒAIä¹Ÿåªæ˜¯å·¥å…·ï¼Œç”¨æ¥å¹²ä»€ä¹ˆæ‰æ˜¯å…³é”®ã€‚æ‰€æœ‰çš„åº”ç”¨å’Œåœºæ™¯éƒ½åº”è¯¥ä»ç®¡ç†ç»´åº¦å‡ºå‘ï¼Œè€Œä¸ä»…æ˜¯æé«˜æ•ˆç‡ï¼Œå› ä¸ºä¸€å‘³æé«˜æ•ˆç‡ï¼Œå¹¶ä¸ä¸€å®šèƒ½å¤Ÿå®Œæˆä¼ä¸šçœŸæ­£çš„ç›®æ ‡ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬ä»¥ç‹¬å­¤ä¹å‰‘ä¸ºä¾‹ï¼Œä»‹ç»äº†åœ¨ITPAOä½“ç³»ä½¿ç”¨AIè¾…åŠ©ç®¡ç†ï¼Œåº”å¯¹å˜åŒ–çš„åº”ç”¨ï¼Œä¸€æ—¦æˆ‘ä»¬åœ¨è¿™ä¸ªå±‚é¢ä½¿ç”¨AIï¼Œè€Œä¸æ˜¯ä»…ä»…æŠŠAIå½“æˆä¸€ä¸ªé—®ç­”å™¨ï¼Œä¸€ä¸ªç”»å›¾å·¥ï¼Œè®©AIå‘æŒ¥AIçš„é•¿å¤„ï¼Œé€šè¿‡å»ºç«‹å®Œå¤‡çš„çŸ¥è¯†ä½“ç³»ï¼Œå‡†ç¡®çš„æ•°æ®ä¾›ç»™ï¼Œå¯ä»¥æ‰¿è½½å˜åŒ–çš„æµç¨‹æ¶æ„ï¼Œå°±å¯ä»¥åšåˆ°â€œéšé£æ½œå…¥å¤œï¼Œæ¶¦ç‰©ç»†æ— å£°â€ï¼Œè¿™æ—¶å€™çš„AIæ— å¤„ä¸åœ¨ï¼Œå†ä¹Ÿä¸ç”¨å»è‹¦è‹¦åœ°å¯»æ‰¾AIåœºæ™¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1836911b82dc48bb8d626784969435c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764916215&amp;x-signature=bEmXy4vJ4IYZD1pqh%2F2Ch4RokoM%3D" alt="" loading="lazy"/></p>
<p>AIæ— å¤„ä¸åœ¨ï¼Œåº”å¯¹å˜åŒ–å°±æ˜¯æœ€å¤§çš„åœºæ™¯</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOS åº”ç”¨æ€§èƒ½æµ‹è¯•çš„ç³»ç»ŸåŒ–å®è·µï¼Œæ„å»ºä»åº•å±‚åˆ†æåˆ°çœŸæœºå›å½’çš„å¤šå·¥å…·ååŒä½“ç³»]]></title>    <link>https://juejin.cn/post/7577307409855201295</link>    <guid>https://juejin.cn/post/7577307409855201295</guid>    <pubDate>2025-11-28T06:41:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577307409855201295" data-draft-id="7577298871005102114" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOS åº”ç”¨æ€§èƒ½æµ‹è¯•çš„ç³»ç»ŸåŒ–å®è·µï¼Œæ„å»ºä»åº•å±‚åˆ†æåˆ°çœŸæœºå›å½’çš„å¤šå·¥å…·ååŒä½“ç³»"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-28T06:41:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aiopencode"/> <meta itemprop="url" content="https://juejin.cn/user/1898230261493865"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOS åº”ç”¨æ€§èƒ½æµ‹è¯•çš„ç³»ç»ŸåŒ–å®è·µï¼Œæ„å»ºä»åº•å±‚åˆ†æåˆ°çœŸæœºå›å½’çš„å¤šå·¥å…·ååŒä½“ç³»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1898230261493865/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aiopencode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:41:47.000Z" title="Fri Nov 28 2025 06:41:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å¦‚ä»Šçš„ç§»åŠ¨ç«¯æŠ€æœ¯ç¯å¢ƒä¸­ï¼Œ<strong>iOS åº”ç”¨æ€§èƒ½æµ‹è¯•</strong> ä¸å†æ˜¯å¼€å‘æµç¨‹ä¸­çš„â€œè¾…åŠ©ç¯èŠ‚â€ï¼Œè€Œæ˜¯ç›´æ¥å†³å®šäº§å“ç¨³å®šæ€§ä¸ç”¨æˆ·ä½“éªŒçš„æ ¸å¿ƒèƒ½åŠ›ã€‚éšç€ App åŠŸèƒ½æ„ˆå‘å¤æ‚ã€è·¨ç«¯æ¡†æ¶å¢åŠ ã€åŠ¨ç”»ä¸æ¸²æŸ“å‹åŠ›æå‡ã€å¼±ç½‘ä¸å¤šä»»åŠ¡ä½¿ç”¨é¢‘ç¹ï¼Œæ€§èƒ½é—®é¢˜å˜å¾—æ›´åŠ éšè”½ã€æ›´åŠ å¤šæºï¼Œå¹¶ä¸”å¾€å¾€éš¾ä»¥å¤ç°ã€‚</p>
<p>å› æ­¤ï¼Œä¸€ä¸ªæˆç†Ÿçš„æ€§èƒ½æµ‹è¯•ä½“ç³»å¿…é¡»å…·å¤‡ï¼š</p>
<ul>
<li><strong>å¯æŒç»­ç›‘æ§</strong></li>
<li><strong>å¯é‡åŒ–æŒ‡æ ‡</strong></li>
<li><strong>å¯å¤ç°å‹åŠ›åœºæ™¯</strong></li>
<li><strong>å¯å®šä½ç³»ç»Ÿè¡Œä¸º</strong></li>
<li><strong>å¯æ¯”å¯¹ä¸åŒç‰ˆæœ¬æ€§èƒ½</strong></li>
<li><strong>å¯å®ç°è‡ªåŠ¨åŒ–å›å½’</strong></li>
</ul>
<p>è€Œè¦å®ç°è¿™ä¸€ç›®æ ‡ï¼Œå°±å¿…é¡»ä½¿ç”¨ <strong>å¤šå·¥å…·ç»„åˆ</strong>ï¼Œæ„å»ºçœŸæ­£çš„å·¥ç¨‹çº§æ€§èƒ½æµ‹è¯•é“¾è·¯ã€‚æœ¬æ–‡åŸºäºçœŸå®å¼€å‘ä¸è°ƒè¯•ç»éªŒï¼Œä»å·¥ç¨‹å®è·µè§’åº¦æ„å»ºä¸€å¥—æ¶µç›– <strong>Instrumentsã€å…‹é­”ï¼ˆKeyMobï¼‰ã€PerfDogã€Safari Inspectorã€Charlesã€MetricKitã€Firebaseã€XCUITest</strong> ç­‰å·¥å…·çš„å®Œæ•´ iOS æ€§èƒ½æµ‹è¯•ä½“ç³»ã€‚</p>
<p>æ–‡ç« ä¿æŒå¼€å‘è€…é£æ ¼ï¼Œä¸å«æ¨å¹¿è…”è°ƒï¼Œä¸ä¾èµ–ç½‘ç»œæœç´¢ï¼Œä»…åŸºäºæ€§èƒ½è°ƒè¯•å®æˆ˜ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ€§èƒ½æµ‹è¯•ä¸ºä»€ä¹ˆå¿…é¡»ä¾èµ–ä½“ç³»è€Œä¸æ˜¯å•ä¸€å·¥å…·ï¼Ÿ</h2>
<p>iOS æ€§èƒ½é—®é¢˜æ¥æºä¼—å¤šï¼Œå¾€å¾€ç›¸äº’å½±å“ï¼Œä¾‹å¦‚ï¼š</p>
<h3 data-id="heading-1"><strong>1. CPU è¿‡é«˜ â†’ ä¸»çº¿ç¨‹å¡é¡¿ â†’ FPS é™ä½</strong></h3>
<p>å¸¸è§åŸå› ï¼š</p>
<ul>
<li>JSON è§£æåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ</li>
<li>åŒæ­¥ä»»åŠ¡è¿‡å¤š</li>
<li>å¤§é‡å¸ƒå±€è®¡ç®—</li>
</ul>
<h3 data-id="heading-2"><strong>2. GPU å‹åŠ› â†’ æ¸²æŸ“å¡é¡¿</strong></h3>
<p>å¸¸è§åŸå› ï¼š</p>
<ul>
<li>ç¦»å±æ¸²æŸ“</li>
<li>åŠ¨ç”»è¿‡å¤š</li>
<li>è§†å›¾å±‚çº§æ·±</li>
</ul>
<h3 data-id="heading-3"><strong>3. å†…å­˜ä¸Šæ¶¨ â†’ jetsam æ€è¿›ç¨‹</strong></h3>
<p>å¸¸è§åŸå› ï¼š</p>
<ul>
<li>å›¾ç‰‡ç¼“å­˜ä¸é‡Šæ”¾</li>
<li>æ§åˆ¶å™¨æœªé‡Šæ”¾</li>
<li>é•¿æ—¶é—´è¿è¡Œå‡ºç°æ³„æ¼</li>
</ul>
<h3 data-id="heading-4"><strong>4. ç½‘ç»œå¡é¡¿ â†’ é¡µé¢é€»è¾‘åœæ»</strong></h3>
<p>å¸¸è§åŸå› ï¼š</p>
<ul>
<li>å›¾ç‰‡åŠ è½½è¶…æ—¶</li>
<li>æ¥å£å“åº”è¿‡æ…¢</li>
<li>ç¼“å­˜ç­–ç•¥ä¸åˆç†</li>
</ul>
<h3 data-id="heading-5"><strong>5. WebView / Hybrid â†’ JS é•¿ä»»åŠ¡å¯¼è‡´ UI å¡é¡¿</strong></h3>
<p>è¿™äº›é—®é¢˜ä¸å¯èƒ½ä»…é  Instruments æˆ–æŸä¸€ç›‘æ§å·¥å…·è§£å†³ï¼Œå› æ­¤ <strong>å¤šå·¥å…·ååŒ</strong> æˆä¸ºå”¯ä¸€å¯è¡Œæ–¹æ¡ˆã€‚</p>
<hr/>
<h2 data-id="heading-6">äºŒã€Instrumentsï¼šåº•å±‚æ€§èƒ½æµ‹è¯•çš„æ ¸å¿ƒåˆ†æå·¥å…·</h2>
<p>Instruments æ˜¯æ€§èƒ½æµ‹è¯•çš„ä¸­å¿ƒå·¥å…·ï¼Œé€‚åˆæ·±å…¥åˆ†æåº•å±‚ç“¶é¢ˆã€‚</p>
<h3 data-id="heading-7"><strong>1. Time Profilerï¼ˆCPU åˆ†æï¼‰</strong></h3>
<p>ç”¨äºå®šä½ï¼š</p>
<ul>
<li>ä¸»çº¿ç¨‹é˜»å¡ç‚¹</li>
<li>é«˜è€—æ—¶å‡½æ•°</li>
<li>åŒæ­¥ä»»åŠ¡é—®é¢˜</li>
</ul>
<h3 data-id="heading-8"><strong>2. Core Animationï¼ˆæ¸²æŸ“æ€§èƒ½ï¼‰</strong></h3>
<p>å¯æŸ¥çœ‹ï¼š</p>
<ul>
<li>GPU åˆ©ç”¨ç‡</li>
<li>ç¦»å±æ¸²æŸ“</li>
<li>å¸§ç‡ä¸‹é™åŸå› </li>
</ul>
<p>éå¸¸é€‚åˆåˆ†æåŠ¨ç”»å¡é¡¿ä¸æ»‘åŠ¨å¡é¡¿ã€‚</p>
<h3 data-id="heading-9"><strong>3. Allocations / Leaksï¼ˆå†…å­˜ï¼‰</strong></h3>
<p>å¯æ•è·ï¼š</p>
<ul>
<li>æ³„æ¼ï¼ˆLeaksï¼‰</li>
<li>å†…å­˜å¢é•¿è¶‹åŠ¿</li>
<li>Retain Cycleï¼ˆå¾ªç¯å¼•ç”¨ï¼‰</li>
</ul>
<h3 data-id="heading-10"><strong>4. Energy Logï¼ˆèƒ½è€—ï¼‰</strong></h3>
<p>ç”¨äºæ£€æµ‹ï¼š</p>
<ul>
<li>åå°ä»»åŠ¡</li>
<li>ä¼ æ„Ÿå™¨è°ƒç”¨</li>
<li>ç½‘ç»œæ¶ˆè€—</li>
</ul>
<p>Instruments çš„è§’è‰²æ˜¯â€œæ·±åº¦å®šä½â€ï¼Œä½†ä¸é€‚åˆå¸¸æ€ç›‘æ§ä¸é•¿æ—¶é—´æµ‹è¯•ã€‚</p>
<hr/>
<h2 data-id="heading-11">ä¸‰ã€å…‹é­”ï¼ˆKeyMobï¼‰ï¼šç³»ç»Ÿè¡Œä¸º + æ€§èƒ½ç›‘æ§çš„çœŸæœºæ ¸å¿ƒå·¥å…·</h2>
<p>åœ¨æ€§èƒ½æµ‹è¯•å®è·µä¸­ï¼ŒKeyMob å¸¸ç”¨äºè¡¥è¶³ Instruments åœ¨â€œçœŸå®ä½¿ç”¨åœºæ™¯â€ä¸‹çš„ç›‘æ§èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-12"><strong>1. å®æ—¶æ€§èƒ½ç›‘æ§ï¼ˆé•¿æ—¶é—´æ›²çº¿ï¼‰</strong></h3>
<p>åŒ…æ‹¬ï¼š</p>
<ul>
<li>CPUï¼ˆå«ä¸»çº¿ç¨‹ï¼‰</li>
<li>GPU</li>
<li>å†…å­˜</li>
<li>FPS</li>
<li>ç½‘ç»œåå</li>
<li>æ¸©åº¦ã€èƒ½è€—</li>
</ul>
<p>é€‚ç”¨äºï¼š</p>
<ul>
<li>30 åˆ†é’Ÿä»¥ä¸Šå‹åŠ›æµ‹è¯•</li>
<li>å¤æ‚äº¤äº’åœºæ™¯</li>
<li>æ€§èƒ½å›å½’æµ‹è¯•ï¼ˆç‰ˆæœ¬å¯¹æ¯”ï¼‰</li>
</ul>
<h3 data-id="heading-13"><strong>2. ç³»ç»Ÿæ—¥å¿—ï¼ˆDevice Logsï¼‰</strong></h3>
<p>ç³»ç»Ÿè¡Œä¸ºå¾€å¾€å†³å®šæ€§èƒ½é—®é¢˜çš„æ ¹å› ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs">jetsam_event â†’ å†…å­˜è¢«ç³»ç»Ÿå¼ºæ€  
watchdog â†’ ä¸»çº¿ç¨‹å¡æ­»  
thermal â†’ æ¸©åº¦é™åˆ¶æ€§èƒ½  
WebKit crash â†’ Hybrid å¯¼è‡´é¡µé¢å¡é¡¿  
</code></pre>
<p>è¿™äº›æ—¥å¿—åœ¨æ€§èƒ½æµ‹è¯•ä¸­éå¸¸å…³é”®ï¼Œæ˜¯ Xcode å¾ˆéš¾å®Œæ•´æ•è·çš„ã€‚</p>
<h3 data-id="heading-14"><strong>3. æ²™ç›’æ–‡ä»¶åˆ†æ</strong></h3>
<p>ç”¨äºæ£€æµ‹ï¼š</p>
<ul>
<li>æ•°æ®è†¨èƒ€</li>
<li>ç¼“å­˜æ˜¯å¦å¼‚å¸¸å¢å¤§</li>
<li>é…ç½®å†™å…¥æ˜¯å¦æ­£ç¡®</li>
</ul>
<p>å¯¹æ€§èƒ½é—®é¢˜ä¸­çš„ I/O è¡Œä¸ºæ’æŸ¥ç‰¹åˆ«æœ‰æ•ˆã€‚</p>
<hr/>
<h2 data-id="heading-15">å››ã€PerfDogï¼šFPS / CPU / GPU é«˜ç²¾åº¦é‡‡æ ·å·¥å…·</h2>
<p>PerfDog æ˜¯é«˜å¸§ç‡åœºæ™¯æˆ–é«˜æ¸²æŸ“å‹åŠ›åœºæ™¯çš„æ ¸å¿ƒæµ‹è¯•å·¥å…·ã€‚</p>
<h3 data-id="heading-16"><strong>é€‚ç”¨äºï¼š</strong></h3>
<ul>
<li>åˆ—è¡¨æ»‘åŠ¨æŒç»­å¡é¡¿</li>
<li>é¡µé¢åŠ¨ç”»æ‰å¸§</li>
<li>è§†é¢‘/ç›´æ’­æ’­æ”¾å¡é¡¿</li>
<li>Flutter/Unity é¡µé¢æ€§èƒ½ä¸‹é™</li>
<li>æ¸¸æˆç±»çš„å¤æ‚æ¸²æŸ“åœºæ™¯</li>
</ul>
<h3 data-id="heading-17"><strong>æ”¯æŒç›‘æ§ï¼š</strong></h3>
<ul>
<li>æ¯«ç§’çº§ FPS</li>
<li>CPUã€GPU è¶‹åŠ¿æ›²çº¿</li>
<li>å†…å­˜å¢é•¿</li>
<li>æ¸©åº¦ä¸èƒ½è€—</li>
<li>æ‰å¸§èšç±»</li>
</ul>
<p>é€‚åˆç‰ˆæœ¬æ€§èƒ½å¯¹æ¯”ä¸å‹åŠ›æµ‹è¯•ã€‚</p>
<hr/>
<h2 data-id="heading-18">äº”ã€Safari Inspectorï¼šHybrid / WebView æ€§èƒ½è¯Šæ–­æ ¸å¿ƒ</h2>
<p>Hybrid é¡µé¢æ€§èƒ½é—®é¢˜å…·æœ‰éšè”½æ€§ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>DOM é‡ç»˜è¿‡å¤š</li>
<li>JS é•¿ä»»åŠ¡é˜»å¡ UI</li>
<li>JSBridge è°ƒç”¨è¿‡é¢‘</li>
<li>WebView å†…å­˜è¿‡å¤§</li>
</ul>
<p>Safari Inspector èƒ½æ•è·ï¼š</p>
<ul>
<li>JS æ€§èƒ½</li>
<li>DOM èŠ‚ç‚¹æ•°é‡</li>
<li>æ ·å¼è®¡ç®—è€—æ—¶</li>
<li>èµ„æºåŠ è½½è€—æ—¶</li>
<li>WebView çº¿ç¨‹çŠ¶æ€</li>
</ul>
<p>é€‚ç”¨äº uni-appã€æ´»åŠ¨é¡µã€æ”¯ä»˜é¡µç­‰åœºæ™¯ã€‚</p>
<hr/>
<h2 data-id="heading-19">å…­ã€Charlesï¼šç½‘ç»œæ€§èƒ½æµ‹è¯•çš„å…³é”®å·¥å…·</h2>
<p>ç½‘ç»œå½±å“æ€§èƒ½çš„æ¯”ä¾‹æ¯”å¤šæ•°äººæƒ³è±¡å¾—é«˜ã€‚</p>
<p>Charles å¯ç”¨äºæµ‹è¯•ï¼š</p>
<ul>
<li>æ¥å£è€—æ—¶</li>
<li>é‡å®šå‘è€—æ—¶</li>
<li>å¼±ç½‘æ¨¡æ‹Ÿ</li>
<li>ç¼“å­˜å‘½ä¸­æ•ˆæœ</li>
<li>å¤§æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½</li>
</ul>
<p>ç‰¹åˆ«é€‚åˆï¼š</p>
<ul>
<li>é¦–å±ä¼˜åŒ–</li>
<li>å¼±ç½‘ä¼˜åŒ–</li>
<li>åˆ—è¡¨åŠ è½½æ€§èƒ½æ”¹è¿›</li>
</ul>
<p>å¾ˆå¤šâ€œå¡é¡¿â€å…¶å®æ˜¯ç½‘ç»œå»¶è¿Ÿé€ æˆçš„ï¼ŒCharles å¯ä»¥ç²¾å‡†å®šä½ã€‚</p>
<hr/>
<h2 data-id="heading-20">ä¸ƒã€MetricKitï¼šç³»ç»Ÿçº§æ€§èƒ½æ•°æ®ï¼ˆä¸Šçº¿ç¯å¢ƒï¼‰</h2>
<p>MetricKit æä¾› App åœ¨çœŸå®ç”¨æˆ·ç¯å¢ƒä¸‹çš„æ€§èƒ½æ•°æ®ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>CPU æ€»æ—¶é—´</li>
<li>å†…å­˜å³°å€¼</li>
<li>å¯åŠ¨æ—¶é—´</li>
<li>OOMï¼ˆjetsam ç±»å‹ï¼‰</li>
<li>ç£ç›˜ I/O è¡Œä¸º</li>
<li>çƒ­åŠ›è¡Œä¸º</li>
</ul>
<p>ç»“åˆå¼€å‘æœŸæµ‹è¯•ï¼Œå¯å½¢æˆå®Œæ•´çš„æ€§èƒ½ä¼˜åŒ–é—­ç¯ã€‚</p>
<hr/>
<h2 data-id="heading-21">å…«ã€Firebase Performanceï¼šçº¿ä¸Šæ€§èƒ½ç›‘æ§è¡¥å……</h2>
<p>Firebase æä¾›ï¼š</p>
<ul>
<li>é¡µé¢åŠ è½½è€—æ—¶</li>
<li>ç½‘ç»œå»¶è¿Ÿ</li>
<li>å¯åŠ¨é€Ÿåº¦</li>
<li>æ¸²æŸ“å¡é¡¿ï¼ˆå¸§æ¸²æŸ“æ—¶é—´ï¼‰</li>
</ul>
<p>é€‚åˆå®é™…ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡ï¼Œä¸ MetricKit å½¢æˆäº’è¡¥ã€‚</p>
<hr/>
<h2 data-id="heading-22">ä¹ã€XCUITestï¼šè‡ªåŠ¨åŒ–æ€§èƒ½å›å½’æµ‹è¯•</h2>
<p>å°½ç®¡ XCUITest ä¸»è¦ç”¨äº UI è‡ªåŠ¨åŒ–ï¼Œä½†å®ƒèƒ½æå¤§æå‡æ€§èƒ½æµ‹è¯•çš„å¯é‡å¤æ€§ã€‚</p>
<h3 data-id="heading-23">Used forï¼š</h3>
<ul>
<li>è‡ªåŠ¨å®Œæˆå…³é”®è·¯å¾„</li>
<li>ç»“åˆ KeyMob æˆ– PerfDog åšæ€§èƒ½è®°å½•</li>
<li>å½¢æˆæ€§èƒ½å›å½’åŸºçº¿</li>
</ul>
<p>é€‚åˆå¤§è§„æ¨¡è¿­ä»£é¡¹ç›®ã€‚</p>
<hr/>
<h2 data-id="heading-24">åã€æ„å»º iOS åº”ç”¨æ€§èƒ½æµ‹è¯•çš„å®Œæ•´å¤šå·¥å…·ä½“ç³»</h2>













































<table><thead><tr><th>æµ‹è¯•ç±»å‹</th><th>å·¥å…·ç»„åˆ</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>æ·±åº¦æ€§èƒ½åˆ†æ</td><td>Instruments</td><td>åº•å±‚ CPU/GPU/å†…å­˜</td></tr><tr><td>çœŸæœºå®æ—¶ç›‘æ§</td><td>KeyMob</td><td>é•¿æ—¶é—´å‹åŠ›ã€ç³»ç»Ÿæ—¥å¿—</td></tr><tr><td>é«˜ç²¾åº¦æ¸²æŸ“æµ‹è¯•</td><td>PerfDog</td><td>FPS/æ¸²æŸ“å‹åŠ›</td></tr><tr><td>ç½‘ç»œæ€§èƒ½</td><td>Charles</td><td>å¼±ç½‘ã€æ¥å£è€—æ—¶</td></tr><tr><td>Hybrid æ€§èƒ½</td><td>Safari Inspector</td><td>WebView/JS</td></tr><tr><td>è‡ªåŠ¨åŒ–æ€§èƒ½å›å½’</td><td>XCUITest + KeyMob/PerfDog</td><td>ç¨³å®šå›å½’</td></tr><tr><td>ä¸Šçº¿æ€§èƒ½ç›‘æ§</td><td>MetricKit + Firebase</td><td>ç”¨æˆ·ç¯å¢ƒè¡¨ç°</td></tr></tbody></table>
<p>è¿™å¥—å·¥å…·çŸ©é˜µè¶³ä»¥è¦†ç›– 95% çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-25">åä¸€ã€å®æˆ˜æ¡ˆä¾‹ï¼šApp ä½¿ç”¨ 10 åˆ†é’Ÿåå˜å¡çš„å®Œæ•´å®šä½æµç¨‹</h2>
<p>ä¸€ä¸ªçœŸå®é—®é¢˜å¦‚ä¸‹ï¼š</p>
<h3 data-id="heading-26"><strong>PerfDog</strong></h3>
<p>å‘ç° FPS æˆæŒç»­ä¸‹é™è¶‹åŠ¿ã€‚</p>
<h3 data-id="heading-27"><strong>KeyMob</strong></h3>
<p>å†…å­˜ä» 600MB å¢é•¿åˆ° 1.3GBï¼Œç³»ç»Ÿæ—¥å¿—æç¤ºï¼š</p>
<pre><code class="hljs">Memory pressure warning
</code></pre>
<h3 data-id="heading-28"><strong>Instrumentsï¼ˆAllocationsï¼‰</strong></h3>
<p>å‘ç°æŸå›¾ç‰‡ç¼“å­˜æœªé‡Šæ”¾ã€‚</p>
<h3 data-id="heading-29"><strong>Safari Inspectorï¼ˆApp éƒ¨åˆ†é¡µé¢åŸºäº Webï¼‰</strong></h3>
<p>DOM èŠ‚ç‚¹æŒç»­å¢åŠ ï¼Œæœªæ¸…ç†ã€‚</p>
<p>æœ€ç»ˆä¿®å¤åï¼Œ20 åˆ†é’ŸæŒç»­æ»‘åŠ¨ä»ä¿æŒ 58â€“60 FPSã€‚</p>
<hr/>
<h2 data-id="heading-30">æ€§èƒ½æµ‹è¯•æœ¬è´¨æ˜¯æ„å»ºä¸€ä¸ªå¯è§‚æµ‹æ€§ç³»ç»Ÿ</h2>
<p>æˆç†Ÿçš„æ€§èƒ½æµ‹è¯•ä¸æ˜¯â€œè·‘ä¸€ä¸‹å·¥å…·â€ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªç³»ç»Ÿï¼š</p>
<p><strong>å¤šå·¥å…·ååŒã€å¤šç»´åº¦æŒ‡æ ‡æ”¶é›†ã€å¤šåœºæ™¯å¤ç°ã€å¤šç‰ˆæœ¬å¯¹æ¯”ã€å¤šç¯å¢ƒç›‘æ§</strong></p>
<p>è€Œè¿™ä¸€ä½“ç³»ä¾èµ–ï¼š</p>
<ul>
<li><strong>Instruments</strong>ï¼ˆåº•å±‚åˆ†æï¼‰</li>
<li><strong>KeyMob</strong>ï¼ˆç³»ç»Ÿæ—¥å¿— + çœŸæœºæ€§èƒ½ï¼‰</li>
<li><strong>PerfDog</strong>ï¼ˆFPS/CPU/GPU ç²¾å‡†ç›‘æ§ï¼‰</li>
<li><strong>Charles</strong>ï¼ˆç½‘ç»œæ€§èƒ½ï¼‰</li>
<li><strong>Safari Inspector</strong>ï¼ˆHybridï¼‰</li>
<li><strong>MetricKit + Firebase</strong>ï¼ˆçº¿ä¸Šç›‘æ§ï¼‰</li>
<li><strong>XCUITest</strong>ï¼ˆè‡ªåŠ¨åŒ–ï¼‰</li>
</ul>
<p>è¿™å¥—ç»„åˆèƒ½å¸®åŠ© iOS å›¢é˜ŸçœŸæ­£æŒæ¡æ€§èƒ½æµ‹è¯•ä¸ä¼˜åŒ–èƒ½åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (åå››) ç´¢å¼•ç³»ç»Ÿæ¶æ„]]></title>    <link>https://juejin.cn/post/7577298871005134882</link>    <guid>https://juejin.cn/post/7577298871005134882</guid>    <pubDate>2025-11-28T06:42:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577298871005134882" data-draft-id="7577336346663436334" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (åå››) ç´¢å¼•ç³»ç»Ÿæ¶æ„"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-11-28T06:42:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (åå››) ç´¢å¼•ç³»ç»Ÿæ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:42:34.000Z" title="Fri Nov 28 2025 06:42:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬14ç« ï¼šç´¢å¼•ç³»ç»Ÿæ¶æ„</h2>
<h3 data-id="heading-1">ğŸ¯ æ ¸å¿ƒæ¦‚è§ˆ</h3>
<p>ç´¢å¼•ç³»ç»Ÿæ˜¯ Lance æŸ¥è¯¢åŠ é€Ÿçš„æ ¸å¿ƒã€‚æœ¬ç« è®²è§£ç´¢å¼•æ¥å£è®¾è®¡ã€å…ƒæ•°æ®ç®¡ç†å’Œç”Ÿå‘½å‘¨æœŸã€‚</p>
<hr/>
<h3 data-id="heading-2">ğŸ“Š ç¬¬ä¸€éƒ¨åˆ†ï¼šç´¢å¼•æ¶æ„</h3>
<h4 data-id="heading-3">Index Trait å®šä¹‰</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[async_trait]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">trait</span> <span class="hljs-title class_">Index</span>: <span class="hljs-built_in">Send</span> + <span class="hljs-built_in">Sync</span> + Serialize + Deserialize {
    <span class="hljs-comment">/// è·å–ç´¢å¼•ç±»å‹</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">index_type</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> IndexType;
    
    <span class="hljs-comment">/// æ„å»ºç´¢å¼•</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">build</span>(
        &amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>,
        source: DatasetRecordBatchStream,
        progress: <span class="hljs-keyword">impl</span> <span class="hljs-title class_">Fn</span>(BuildProgress) + <span class="hljs-built_in">Send</span>,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;()&gt;;
    
    <span class="hljs-comment">/// æœç´¢ç´¢å¼•</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">search</span>(
        &amp;<span class="hljs-keyword">self</span>,
        query: &amp;SearchQuery,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;SearchResult&gt;;
    
    <span class="hljs-comment">/// ç´¢å¼•å¤§å°ï¼ˆå­—èŠ‚ï¼‰</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">size_bytes</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">u64</span>;
    
    <span class="hljs-comment">/// å…ƒæ•°æ®</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">metadata</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> &amp;IndexMetadata;
}

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">IndexType</span> {
    BTree,
    Bitmap,
    Inverted,
    IvfFlat,
    IvfPq,
    Hnsw,
}
</code></pre>
<h4 data-id="heading-4">ç´¢å¼•æ³¨å†Œè¡¨</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">IndexRegistry</span> {
    indices: HashMap&lt;<span class="hljs-type">String</span>, Arc&lt;<span class="hljs-keyword">dyn</span> Index&gt;&gt;,  <span class="hljs-comment">// column_name â†’ Index</span>
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">IndexRegistry</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">register</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>, column: <span class="hljs-type">String</span>, index: Arc&lt;<span class="hljs-keyword">dyn</span> Index&gt;) {
        <span class="hljs-keyword">self</span>.indices.<span class="hljs-title function_ invoke__">insert</span>(column, index);
    }
    
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">get</span>(&amp;<span class="hljs-keyword">self</span>, column: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Option</span>&lt;Arc&lt;<span class="hljs-keyword">dyn</span> Index&gt;&gt; {
        <span class="hljs-keyword">self</span>.indices.<span class="hljs-title function_ invoke__">get</span>(column).<span class="hljs-title function_ invoke__">cloned</span>()
    }
    
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">search</span>(
        &amp;<span class="hljs-keyword">self</span>,
        column: &amp;<span class="hljs-type">str</span>,
        query: &amp;SearchQuery,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;SearchResult&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">index</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">get</span>(column)
            .<span class="hljs-title function_ invoke__">ok_or</span>(Error::IndexNotFound)?;
        index.<span class="hljs-title function_ invoke__">search</span>(query).<span class="hljs-keyword">await</span>
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-5">ğŸ”§ ç¬¬äºŒéƒ¨åˆ†ï¼šç´¢å¼•å…ƒæ•°æ®ç®¡ç†</h3>
<h4 data-id="heading-6">IndexMetadata ç»“æ„</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">IndexMetadata</span> {
    <span class="hljs-keyword">pub</span> name: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> column: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> index_type: IndexType,
    <span class="hljs-keyword">pub</span> created_at: <span class="hljs-type">i64</span>,
    <span class="hljs-keyword">pub</span> updated_at: <span class="hljs-type">i64</span>,
    
    <span class="hljs-comment">/// æ„å»ºå‚æ•°ï¼ˆæ ¹æ®ç´¢å¼•ç±»å‹ï¼‰</span>
    <span class="hljs-keyword">pub</span> parameters: HashMap&lt;<span class="hljs-type">String</span>, <span class="hljs-type">String</span>&gt;,
    
    <span class="hljs-comment">/// å­˜å‚¨ä½ç½®</span>
    <span class="hljs-keyword">pub</span> index_file: <span class="hljs-type">String</span>,
    
    <span class="hljs-comment">/// å¤§å°ï¼ˆå­—èŠ‚ï¼‰</span>
    <span class="hljs-keyword">pub</span> size_bytes: <span class="hljs-type">u64</span>,
    
    <span class="hljs-comment">/// è¦†ç›–çš„è¡ŒèŒƒå›´</span>
    <span class="hljs-keyword">pub</span> min_row_id: <span class="hljs-type">u32</span>,
    <span class="hljs-keyword">pub</span> max_row_id: <span class="hljs-type">u32</span>,
}
</code></pre>
<h4 data-id="heading-7">ç´¢å¼•æ–‡ä»¶å­˜å‚¨</h4>
<pre><code class="hljs language-python" lang="python">dataset/
â””â”€â”€ indices/
    â”œâ”€â”€ embedding_ivf_pq.idx     <span class="hljs-comment"># å‘é‡ç´¢å¼•</span>
    â”‚   â”œâ”€â”€ codebooks.<span class="hljs-built_in">bin</span>        <span class="hljs-comment"># PQ ç å­—æœ¬</span>
    â”‚   â”œâ”€â”€ ivf_list_0.<span class="hljs-built_in">bin</span>       <span class="hljs-comment"># ç°‡ 0 çš„æ•°æ®</span>
    â”‚   â”œâ”€â”€ ivf_list_1.<span class="hljs-built_in">bin</span>       <span class="hljs-comment"># ç°‡ 1 çš„æ•°æ®</span>
    â”‚   â””â”€â”€ metadata.json        <span class="hljs-comment"># ç´¢å¼•å…ƒæ•°æ®</span>
    â”‚
    â”œâ”€â”€ price_btree.idx          <span class="hljs-comment"># BTree ç´¢å¼•</span>
    â”‚   â”œâ”€â”€ nodes.<span class="hljs-built_in">bin</span>            <span class="hljs-comment"># BTree èŠ‚ç‚¹</span>
    â”‚   â””â”€â”€ metadata.json
    â”‚
    â””â”€â”€ category_bitmap.idx      <span class="hljs-comment"># Bitmap ç´¢å¼•</span>
        â”œâ”€â”€ bitmaps.<span class="hljs-built_in">bin</span>          <span class="hljs-comment"># ä½å›¾æ•°æ®</span>
        â””â”€â”€ metadata.json
</code></pre>
<hr/>
<h3 data-id="heading-8">ğŸ’« ç¬¬ä¸‰éƒ¨åˆ†ï¼šç´¢å¼•ç”Ÿå‘½å‘¨æœŸ</h3>
<h4 data-id="heading-9">ç´¢å¼•æ„å»º</h4>
<pre><code class="hljs language-arduino" lang="arduino">Dataset.<span class="hljs-built_in">create_index</span>(<span class="hljs-string">"embedding"</span>, <span class="hljs-string">"ivf_pq"</span>)
    â†“
IndexBuilder::<span class="hljs-keyword">new</span>()
    â†“
æ‰«ææºæ•°æ®ï¼š
â”œâ”€ è·å–æ‰€æœ‰ embedding åˆ—æ•°æ®
â”œâ”€ çº¦ <span class="hljs-number">1</span>G çš„å‘é‡æ•°æ®
â””â”€ æµå¼å¤„ç†ä»¥èŠ‚çœå†…å­˜
    â†“
è®­ç»ƒï¼š
â”œâ”€ KMeans èšç±»ï¼ˆå­¦ä¹ è´¨å¿ƒï¼‰
â”œâ”€ PQ é‡åŒ–ï¼ˆå­¦ä¹ ç å­—æœ¬ï¼‰
â””â”€ è®°å½•ç»Ÿè®¡ä¿¡æ¯
    â†“
å†™å…¥ç´¢å¼•ï¼š
â”œâ”€ åºåˆ—åŒ–ç å­—æœ¬
â”œâ”€ åºåˆ—åŒ– IVF åˆ—è¡¨
â””â”€ å†™å…¥ç´¢å¼•æ–‡ä»¶
    â†“
æ›´æ–° Manifestï¼š
â”œâ”€ æ·»åŠ  IndexMetadata
â””â”€ è®°å½•ç´¢å¼•ç‰ˆæœ¬
    â†“
æˆåŠŸå®Œæˆ
</code></pre>
<h4 data-id="heading-10">ç´¢å¼•æ›´æ–°</h4>
<pre><code class="hljs language-diff" lang="diff">æ–° Fragment æ·»åŠ åï¼Œç´¢å¼•å¦‚ä½•æ›´æ–°ï¼Ÿ

åœºæ™¯ï¼šæ•°æ®é›†å·²æœ‰ IVF_PQ ç´¢å¼•ï¼Œç°åœ¨è¿½åŠ æ–°æ•°æ®

é€‰é¡¹ 1ï¼šå¢é‡æ›´æ–°ï¼ˆæ¨èï¼‰
<span class="hljs-deletion">- å¯¹æ–° Fragment çš„å‘é‡è¿›è¡Œ PQ é‡åŒ–</span>
<span class="hljs-deletion">- ä½¿ç”¨ç°æœ‰çš„ç å­—æœ¬ï¼ˆä¸é‡æ–°è®­ç»ƒï¼‰</span>
<span class="hljs-deletion">- å¿«é€Ÿå®Œæˆ</span>

é€‰é¡¹ 2ï¼šå…¨é‡é‡å»º
<span class="hljs-deletion">- æ‰«ææ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬æ–° Fragmentï¼‰</span>
<span class="hljs-deletion">- é‡æ–°è®­ç»ƒ KMeans å’Œ PQ</span>
<span class="hljs-deletion">- æ›´æ–°æ‰€æœ‰ç´¢å¼•</span>
<span class="hljs-deletion">- æ›´è€—æ—¶ä½†å¯èƒ½æ›´å‡†ç¡®</span>

Lance çš„ç­–ç•¥ï¼š
<span class="hljs-deletion">- æ•°æ®é‡å°ï¼ˆ&lt;10%ï¼‰â†’ å¢é‡</span>
<span class="hljs-deletion">- æ•°æ®é‡å¤§ï¼ˆ&gt;30%ï¼‰â†’ å…¨é‡é‡å»º</span>
</code></pre>
<h4 data-id="heading-11">ç´¢å¼•åˆ é™¤</h4>
<pre><code class="hljs language-python" lang="python">dataset.drop_index(<span class="hljs-string">"embedding"</span>)

<span class="hljs-comment"># å†…éƒ¨ï¼š</span>
<span class="hljs-comment"># 1. ä» IndexRegistry ç§»é™¤ç´¢å¼•</span>
<span class="hljs-comment"># 2. ä» Manifest ç§»é™¤ IndexMetadata</span>
<span class="hljs-comment"># 3. å¼‚æ­¥åˆ é™¤ç´¢å¼•æ–‡ä»¶</span>
<span class="hljs-comment"># 4. æ›´æ–° Dataset å…ƒæ•°æ®</span>

<span class="hljs-comment"># æˆæœ¬ï¼šO(1) å…ƒæ•°æ®æ“ä½œ</span>
</code></pre>
<hr/>
<h3 data-id="heading-12">ğŸ“Š ç´¢å¼•ç±»å‹æ€»è§ˆ</h3>















































<table><thead><tr><th>ç´¢å¼•ç±»å‹</th><th>é€‚ç”¨åœºæ™¯</th><th>æˆæœ¬</th><th>æŸ¥è¯¢æ€§èƒ½</th></tr></thead><tbody><tr><td>BTree</td><td>èŒƒå›´æŸ¥è¯¢</td><td>ä¸­ç­‰</td><td>å¿«</td></tr><tr><td>Bitmap</td><td>ç²¾ç¡®åŒ¹é…ã€ä½åŸºæ•°</td><td>ä½</td><td>æå¿«</td></tr><tr><td>Inverted</td><td>å…¨æ–‡æœç´¢</td><td>é«˜</td><td>å¿«</td></tr><tr><td>IVF-FLAT</td><td>å‘é‡æœç´¢ï¼ˆç²¾ç¡®ï¼‰</td><td>é«˜</td><td>ä¸­ç­‰</td></tr><tr><td>IVF-PQ</td><td>å‘é‡æœç´¢ï¼ˆå¤§è§„æ¨¡ï¼‰</td><td>é«˜</td><td>å¿«</td></tr><tr><td>HNSW</td><td>å‘é‡æœç´¢ï¼ˆåŠ¨æ€ï¼‰</td><td>é«˜</td><td>å¿«</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-13">ğŸ“š æ€»ç»“</h3>
<p>ç´¢å¼•ç³»ç»Ÿæ¶æ„ï¼š</p>
<ol>
<li><strong>ç»Ÿä¸€æ¥å£</strong>ï¼šæ‰€æœ‰ç´¢å¼•å®ç° Index trait</li>
<li><strong>çµæ´»æ³¨å†Œ</strong>ï¼šåŠ¨æ€ç®¡ç†å¤šä¸ªç´¢å¼•</li>
<li><strong>è‡ªåŠ¨å…ƒæ•°æ®</strong>ï¼šå®Œæ•´çš„ç´¢å¼•ä¿¡æ¯è¿½è¸ª</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šåˆ›å»ºã€æ›´æ–°ã€åˆ é™¤</li>
<li><strong>æ€§èƒ½å¯è§‚æµ‹</strong>ï¼šç´¢å¼•å¤§å°ã€è¦†ç›–èŒƒå›´ç­‰</li>
</ol>
<p>ä¸‹ä¸€ç« è®²è§£æ ‡é‡ç´¢å¼•çš„å…·ä½“å®ç°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (åäº”) æ ‡é‡ç´¢å¼•å®ç°]]></title>    <link>https://juejin.cn/post/7577307409855234063</link>    <guid>https://juejin.cn/post/7577307409855234063</guid>    <pubDate>2025-11-28T06:43:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577307409855234063" data-draft-id="7577378514401214499" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (åäº”) æ ‡é‡ç´¢å¼•å®ç°"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-11-28T06:43:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (åäº”) æ ‡é‡ç´¢å¼•å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:43:37.000Z" title="Fri Nov 28 2025 06:43:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬15ç« ï¼šæ ‡é‡ç´¢å¼•å®ç°</h2>
<h3 data-id="heading-1">ğŸ¯ æ ¸å¿ƒæ¦‚è§ˆ</h3>
<p>BTreeã€Bitmap å’Œå€’æ’ç´¢å¼•æ˜¯æ ‡é‡æ•°æ®åŠ é€Ÿçš„ä¸‰å¤§æ”¯æŸ±ã€‚</p>
<hr/>
<h3 data-id="heading-2">ğŸ“Š BTree ç´¢å¼•</h3>
<h4 data-id="heading-3">åŸç†</h4>
<p>BTree æ˜¯è‡ªå¹³è¡¡çš„æ’åºæ ‘ï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢ã€‚</p>
<pre><code class="hljs language-css" lang="css">         <span class="hljs-selector-attr">[50]</span>
        /    \
      <span class="hljs-selector-attr">[25]</span>   <span class="hljs-selector-attr">[75]</span>
     /   \   /   \
   <span class="hljs-selector-attr">[10]</span> <span class="hljs-selector-attr">[30]</span><span class="hljs-selector-attr">[60]</span> <span class="hljs-selector-attr">[90]</span>
</code></pre>
<h4 data-id="heading-4">å®ç°</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">BTreeIndex</span> {
    root: BTreeNode,
    comparator: <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> <span class="hljs-title function_ invoke__">Fn</span>(&amp;[<span class="hljs-type">u8</span>], &amp;[<span class="hljs-type">u8</span>]) <span class="hljs-punctuation">-&gt;</span> Ordering + <span class="hljs-built_in">Send</span> + <span class="hljs-built_in">Sync</span>&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">BTreeIndex</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">range_search</span>(&amp;<span class="hljs-keyword">self</span>, min: &amp;[<span class="hljs-type">u8</span>], max: &amp;[<span class="hljs-type">u8</span>]) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">u32</span>&gt; {
        <span class="hljs-comment">// è¿”å› [min, max] èŒƒå›´å†…çš„è¡Œå·</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">result</span> = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>();
        <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">traverse_range</span>(&amp;<span class="hljs-keyword">self</span>.root, min, max, &amp;<span class="hljs-keyword">mut</span> result);
        result
    }
}
</code></pre>
<h4 data-id="heading-5">æŸ¥è¯¢æ€§èƒ½</h4>
<pre><code class="hljs language-diff" lang="diff">100ä¸‡è¡Œï¼Œprice åˆ—æœ‰ BTree ç´¢å¼•

æŸ¥è¯¢ï¼šWHERE price BETWEEN 100 AND 500

æ— ç´¢å¼•ï¼š
<span class="hljs-deletion">- æ‰«æ 100ä¸‡è¡Œ</span>
<span class="hljs-deletion">- æ—¶é—´ï¼š10ms</span>

BTree ç´¢å¼•ï¼š
<span class="hljs-deletion">- æŸ¥æ‰¾æœ€å°å€¼ï¼šlog(1M) â‰ˆ 20 æ¬¡æ¯”è¾ƒ</span>
<span class="hljs-deletion">- èŒƒå›´æ‰«æï¼š500 è¡Œ</span>
<span class="hljs-deletion">- æ—¶é—´ï¼š0.5ms</span>
<span class="hljs-deletion">- åŠ é€Ÿï¼š20 å€</span>
</code></pre>
<hr/>
<h3 data-id="heading-6">ğŸ¯ Bitmap ç´¢å¼•</h3>
<h4 data-id="heading-7">åŸç†</h4>
<p>å¯¹æ¯ä¸ªä¸åŒçš„å€¼å­˜å‚¨ä¸€ä¸ªä½å›¾ã€‚</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">category</span> åˆ—ï¼š<span class="hljs-selector-attr">[A, B, A, C, B, A]</span>

ä½å›¾è¡¨ç¤ºï¼š
<span class="hljs-selector-tag">A</span>: <span class="hljs-selector-attr">[1, 0, 1, 0, 0, 1]</span>
<span class="hljs-selector-tag">B</span>: <span class="hljs-selector-attr">[0, 1, 0, 0, 1, 0]</span>
<span class="hljs-selector-tag">C</span>: <span class="hljs-selector-attr">[0, 0, 0, 1, 0, 0]</span>

æŸ¥è¯¢ <span class="hljs-selector-tag">category</span> = '<span class="hljs-selector-tag">A</span>' â†’ ç›´æ¥è¿”å›ä½å›¾ <span class="hljs-selector-attr">[1, 0, 1, 0, 0, 1]</span>
</code></pre>
<h4 data-id="heading-8">å®ç°</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">BitmapIndex</span> {
    bitmaps: HashMap&lt;ScalarValue, RoaringBitmap&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">BitmapIndex</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">search</span>(&amp;<span class="hljs-keyword">self</span>, value: &amp;ScalarValue) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Option</span>&lt;RoaringBitmap&gt; {
        <span class="hljs-keyword">self</span>.bitmaps.<span class="hljs-title function_ invoke__">get</span>(value).<span class="hljs-title function_ invoke__">cloned</span>()
    }
    
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">search_multiple</span>(
        &amp;<span class="hljs-keyword">self</span>, 
        values: &amp;[ScalarValue],
        operator: Operator,  <span class="hljs-comment">// AND, OR, NOT</span>
    ) <span class="hljs-punctuation">-&gt;</span> RoaringBitmap {
        <span class="hljs-comment">// æ”¯æŒå¤æ‚çš„ä½æ“ä½œ</span>
        <span class="hljs-comment">// WHERE category IN ('A', 'B')</span>
        <span class="hljs-comment">// è¿”å›ï¼šbitmap_A OR bitmap_B</span>
    }
}
</code></pre>
<h4 data-id="heading-9">æ€§èƒ½</h4>
<pre><code class="hljs language-diff" lang="diff">100ä¸‡è¡Œï¼Œcategory åˆ—ï¼ˆ100 ç§ä¸åŒå€¼ï¼‰

æ— ç´¢å¼•ï¼š
<span class="hljs-deletion">- æ‰«æ 100ä¸‡è¡Œ</span>
<span class="hljs-deletion">- æ—¶é—´ï¼š10ms</span>

Bitmap ç´¢å¼•ï¼š
<span class="hljs-deletion">- ä½å›¾æŸ¥æ‰¾ï¼šO(1)</span>
<span class="hljs-deletion">- ä½æ“ä½œï¼šO(è¡Œæ•°/64)</span>
<span class="hljs-deletion">- æ—¶é—´ï¼š1ms</span>
<span class="hljs-deletion">- åŠ é€Ÿï¼š10 å€</span>
</code></pre>
<hr/>
<h3 data-id="heading-10">ğŸ“š å€’æ’ç´¢å¼•ï¼ˆå…¨æ–‡æœç´¢ï¼‰</h3>
<h4 data-id="heading-11">åŸç†</h4>
<p>ä¸ºæ¯ä¸ªå•è¯å­˜å‚¨å‡ºç°ä½ç½®ã€‚</p>
<pre><code class="hljs language-less" lang="less">æ–‡æ¡£ï¼š<span class="hljs-selector-attr">[<span class="hljs-string">"hello world"</span>, <span class="hljs-string">"world of tanks"</span>, <span class="hljs-string">"hello there"</span>]</span>

å€’æ’è¡¨ï¼š
<span class="hljs-selector-tag">hello</span>: <span class="hljs-selector-attr">[doc_0, doc_2]</span>
<span class="hljs-selector-tag">world</span>: <span class="hljs-selector-attr">[doc_0, doc_1]</span>
<span class="hljs-selector-tag">of</span>: <span class="hljs-selector-attr">[doc_1]</span>
<span class="hljs-selector-tag">tanks</span>: <span class="hljs-selector-attr">[doc_1]</span>
<span class="hljs-selector-tag">there</span>: <span class="hljs-selector-attr">[doc_2]</span>

æŸ¥è¯¢ "<span class="hljs-selector-tag">hello</span> <span class="hljs-selector-tag">world</span>" â†’ 
(doc_0, doc_2) âˆ© (doc_0, doc_1) = <span class="hljs-selector-tag">doc_0</span>
</code></pre>
<h4 data-id="heading-12">Lance ä¸­çš„å®ç°</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">InvertedIndex</span> {
    <span class="hljs-comment">// ä½¿ç”¨ Tantivy åº“å®ç°å…¨æ–‡ç´¢å¼•</span>
    index: tantivy::Index,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">InvertedIndex</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">search</span>(&amp;<span class="hljs-keyword">self</span>, query: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">Vec</span>&lt;<span class="hljs-type">u32</span>&gt;&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">searcher</span> = <span class="hljs-keyword">self</span>.index.<span class="hljs-title function_ invoke__">reader</span>()?.<span class="hljs-title function_ invoke__">searcher</span>();
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">query_parser</span> = QueryParser::<span class="hljs-title function_ invoke__">for_index</span>(&amp;<span class="hljs-keyword">self</span>.index, <span class="hljs-built_in">vec!</span>[...]);
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">query</span> = query_parser.<span class="hljs-title function_ invoke__">parse_query</span>(query)?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">top_docs</span> = searcher.<span class="hljs-title function_ invoke__">search</span>(&amp;query, &amp;TopDocs::<span class="hljs-title function_ invoke__">with_limit</span>(<span class="hljs-number">1000</span>))?;
        <span class="hljs-title function_ invoke__">Ok</span>(top_docs.<span class="hljs-title function_ invoke__">iter</span>().<span class="hljs-title function_ invoke__">map</span>(|(score, addr)| {
            <span class="hljs-comment">// è½¬æ¢ä¸ºè¡Œå·</span>
        }).<span class="hljs-title function_ invoke__">collect</span>())
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-13">ğŸ’¡ ä½•æ—¶ä½¿ç”¨å“ªç§ç´¢å¼•</h3>
<pre><code class="hljs language-scss" lang="scss">æ•°æ®ç±»å‹ | æŸ¥è¯¢ç±»å‹ | æ¨èç´¢å¼•
---------|--------|--------
æ•´æ•°    | èŒƒå›´    | BTree
æ•´æ•°    | ç²¾ç¡®    | Bitmap (å¦‚æœä¸åŒå€¼&lt;<span class="hljs-number">1000</span>)
å­—ç¬¦ä¸²   | ç²¾ç¡®    | Bitmap (å¦‚æœä¸åŒå€¼&lt;<span class="hljs-number">1000</span>)
å­—ç¬¦ä¸²   | å‰ç¼€    | Trie/Prefix Tree
æ–‡æœ¬     | å…¨æ–‡    | Inverted Index
å‘é‡     | ç›¸ä¼¼    | IVF/HNSW
</code></pre>
<hr/>
<h3 data-id="heading-14">ğŸ“Š æ€»ç»“</h3>
<p>æ ‡é‡ç´¢å¼•æä¾›äº†é’ˆå¯¹ä¸åŒæŸ¥è¯¢æ¨¡å¼çš„ä¼˜åŒ–ï¼š</p>
<ol>
<li><strong>BTree</strong>ï¼šèŒƒå›´æŸ¥è¯¢</li>
<li><strong>Bitmap</strong>ï¼šç²¾ç¡®åŒ¹é…å’Œä½åŸºæ•°åˆ—</li>
<li><strong>å€’æ’ç´¢å¼•</strong>ï¼šå…¨æ–‡æœç´¢</li>
</ol>
<p>ä¸‹ä¸€ç« è®²å‘é‡ç´¢å¼•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (åå…­) å‘é‡ç´¢å¼• - IVF ç³»åˆ—]]></title>    <link>https://juejin.cn/post/7577356848337223715</link>    <guid>https://juejin.cn/post/7577356848337223715</guid>    <pubDate>2025-11-28T06:51:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577356848337223715" data-draft-id="7577307409855299599" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (åå…­) å‘é‡ç´¢å¼• - IVF ç³»åˆ—"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-11-28T06:51:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¢ç§˜æ–°ä¸€ä»£å‘é‡å­˜å‚¨æ ¼å¼Lance-format (åå…­) å‘é‡ç´¢å¼• - IVF ç³»åˆ—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:51:05.000Z" title="Fri Nov 28 2025 06:51:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬16ç« ï¼šå‘é‡ç´¢å¼• - IVF ç³»åˆ—</h2>
<h3 data-id="heading-1">ğŸ¯ æ ¸å¿ƒæ¦‚è§ˆ</h3>
<p>IVFï¼ˆInverted Fileï¼‰å’Œ IVF_PQ æ˜¯ Lance ä¸­æœ€é‡è¦çš„å‘é‡ç´¢å¼•ï¼Œæä¾› 100-1000 å€çš„åŠ é€Ÿã€‚</p>
<hr/>
<h3 data-id="heading-2">ğŸ“Š IVF åŸç†</h3>
<pre><code class="hljs language-markdown" lang="markdown">1 äº¿ä¸ªå‘é‡ â†’ 256 ä¸ªç°‡ï¼ˆè´¨å¿ƒï¼‰

æ„å»ºï¼š
<span class="hljs-bullet">1.</span> KMeans èšç±»ï¼Œå¾—åˆ° 256 ä¸ªè´¨å¿ƒ
<span class="hljs-bullet">2.</span> ä¸ºæ¯ä¸ªå‘é‡åˆ†é…åˆ°æœ€è¿‘çš„è´¨å¿ƒ
<span class="hljs-bullet">3.</span> ä¸ºæ¯ä¸ªç°‡æ„å»ºå‘é‡åˆ—è¡¨

æœç´¢ï¼š
<span class="hljs-bullet">1.</span> è®¡ç®—æŸ¥è¯¢å‘é‡åˆ° 256 ä¸ªè´¨å¿ƒçš„è·ç¦» (å¿«)
<span class="hljs-bullet">2.</span> é€‰æ‹©æœ€è¿‘çš„ 20 ä¸ªç°‡
<span class="hljs-bullet">3.</span> åœ¨è¿™ 20 ä¸ªç°‡ä¸­é€ä¸ªè®¡ç®—è·ç¦»
<span class="hljs-bullet">4.</span> è¿”å› Top-K

æ€§èƒ½ï¼š
<span class="hljs-bullet">-</span> åŸå§‹ï¼šæ‰«æ 1 äº¿å‘é‡
<span class="hljs-bullet">-</span> IVFï¼šåªæ‰«æ 20/256 â‰ˆ 8% çš„å‘é‡
<span class="hljs-bullet">-</span> åŠ é€Ÿï¼š~10 å€
</code></pre>
<hr/>
<h3 data-id="heading-3">ğŸ”§ IVF_PQï¼ˆå¸¦é‡åŒ–ï¼‰</h3>
<h4 data-id="heading-4">PQ é‡åŒ–</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-number">768</span> ç»´å‘é‡ â†’ <span class="hljs-number">8</span> ä¸ª <span class="hljs-number">96</span> ç»´å­å‘é‡

æ¯ä¸ªå­å‘é‡é‡åŒ–ä¸º <span class="hljs-number">1</span> å­—èŠ‚ï¼ˆ<span class="hljs-number">256</span> ä¸ªç å­—ï¼‰

æ€»è®¡ï¼š<span class="hljs-number">8</span> å­—èŠ‚ä»£æ›¿ <span class="hljs-number">3072</span> å­—èŠ‚
å‹ç¼©ç‡ï¼š<span class="hljs-number">99.7%</span>

è·ç¦»è®¡ç®—ï¼š
ç²¾ç¡®è·ç¦» = sum(distance(Q_i, V_i)) for <span class="hljs-selector-tag">i</span> in <span class="hljs-number">0</span>..<span class="hljs-number">8</span>
è¿‘ä¼¼è·ç¦» = sum(lookup_table<span class="hljs-selector-attr">[i]</span><span class="hljs-selector-attr">[Q_i_code]</span><span class="hljs-selector-attr">[V_i_code]</span>)

æŸ¥è¡¨ï¼š<span class="hljs-number">1</span>ns
è®¡ç®—ï¼š<span class="hljs-number">100</span>ns
åŠ é€Ÿï¼š<span class="hljs-number">100</span> å€
</code></pre>
<h4 data-id="heading-5">å®Œæ•´æ€§èƒ½</h4>
<pre><code class="hljs language-scss" lang="scss">IVF_PQ æœç´¢ <span class="hljs-number">1</span> äº¿å‘é‡ï¼š

<span class="hljs-number">1</span>. è®¡ç®—åˆ°è´¨å¿ƒï¼š<span class="hljs-number">256</span> Ã— <span class="hljs-number">768</span> <span class="hljs-attribute">float</span> ops = ~<span class="hljs-number">200</span>K ops (<span class="hljs-number">0.1ms</span>)
<span class="hljs-number">2</span>. é€‰æ‹© <span class="hljs-number">20</span> ç°‡ï¼šæŒ‰è·ç¦»æ’åº <span class="hljs-number">256</span> ä¸ª (&lt; <span class="hljs-number">0.1ms</span>)
<span class="hljs-number">3</span>. åŠ è½½é‡åŒ–æ•°æ®ï¼š<span class="hljs-number">20</span>/<span class="hljs-number">256</span> Ã— <span class="hljs-number">3</span>GB = ~<span class="hljs-number">120</span>MB (<span class="hljs-number">1ms</span>)
<span class="hljs-number">4</span>. è®¡ç®—è¿‘ä¼¼è·ç¦»ï¼š<span class="hljs-number">200</span>ä¸‡ Ã— æŸ¥è¡¨ = ~<span class="hljs-number">2ms</span>
<span class="hljs-number">5</span>. <span class="hljs-attribute">Top</span>-K æ’åºï¼š~<span class="hljs-number">1ms</span>
æ€»è®¡ï¼š~<span class="hljs-number">4</span>-<span class="hljs-number">5ms</span>

å¯¹æ¯”å…¨æ‰«æï¼š
- å…¨æ‰«æï¼š<span class="hljs-number">768</span>ç»´ Ã— <span class="hljs-number">1</span>äº¿ = <span class="hljs-number">76.8</span>B <span class="hljs-attribute">float</span> ops â‰ˆ <span class="hljs-number">100ms</span>
- åŠ é€Ÿï¼š<span class="hljs-number">20</span>-<span class="hljs-number">25</span> å€
</code></pre>
<hr/>
<h3 data-id="heading-6">ğŸ“š IVF_FLAT vs IVF_PQ</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>IVF_FLAT</th><th>IVF_PQ</th></tr></thead><tbody><tr><td>ç²¾ç¡®åº¦</td><td>100%</td><td>99%</td></tr><tr><td>å†…å­˜</td><td>é«˜ï¼ˆ3KB/å‘é‡ï¼‰</td><td>ä½ï¼ˆ8å­—èŠ‚/å‘é‡ï¼‰</td></tr><tr><td>é€Ÿåº¦</td><td>ä¸­ç­‰</td><td>å¿«</td></tr><tr><td>é€‚ç”¨</td><td>ç²¾ç¡®æœç´¢</td><td>å¤§è§„æ¨¡æœç´¢</td></tr></tbody></table>
<hr/>
<hr/>
<h3 data-id="heading-7">ğŸ” IVF çš„è®¾è®¡æ€æƒ³</h3>
<h4 data-id="heading-8">IVF è§£å†³çš„é—®é¢˜</h4>
<p>åœ¨æ²¡æœ‰ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œæœç´¢ 1 äº¿ä¸ªå‘é‡çš„æœ€è¿‘é‚»éœ€è¦ï¼š</p>
<pre><code class="hljs">æœç´¢æˆæœ¬ = 1äº¿ Ã— 768ç»´ Ã— æµ®ç‚¹è¿ç®— = 7.68Ã—10Â¹â° æ¬¡æ“ä½œ â‰ˆ 100ms
</code></pre>
<p><strong>IVF çš„æ ¸å¿ƒæ´å¯Ÿï¼š</strong> ä¸éœ€è¦æ‰«ææ‰€æœ‰å‘é‡ï¼Œåªéœ€æ‰«æç›¸å…³çš„ç°‡</p>
<pre><code class="hljs language-erlang" lang="erlang">åŸå§‹æ–¹æ¡ˆï¼šæ‰«æ <span class="hljs-number">1</span> äº¿å‘é‡
IVF æ–¹æ¡ˆï¼šæ‰«æ <span class="hljs-number">20</span> ä¸ªç°‡ä¸­çš„ <span class="hljs-number">200</span> ä¸‡å‘é‡ï¼ˆåªéœ€ <span class="hljs-number">8</span><span class="hljs-comment">% çš„æ•°æ®ï¼‰</span>
åŠ é€Ÿå€æ•°ï¼š<span class="hljs-number">20</span>-<span class="hljs-number">25</span> å€
</code></pre>
<h4 data-id="heading-9">IVF çš„åˆ†å±‚æ„å»º</h4>
<h5 data-id="heading-10">ç¬¬ä¸€å±‚ï¼šKMeans èšç±»</h5>
<ul>
<li>è¾“å…¥ï¼š1000ä¸‡å‘é‡ Ã— 768ç»´</li>
<li>è¿‡ç¨‹ï¼šè¿­ä»£ KMeans å­¦ä¹  256 ä¸ªè´¨å¿ƒ</li>
<li>è¾“å‡ºï¼š256 ä¸ªè´¨å¿ƒ Ã— 768ç»´</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹© KMeansï¼Ÿ</strong></p>
<ul>
<li>ç›®æ ‡æ˜ç¡®ï¼šæœ€å°åŒ–ç°‡å†…æ–¹å·®</li>
<li>è´¨å¿ƒæœ‰æ„ä¹‰ï¼šä»£è¡¨æ•´ä¸ªç°‡</li>
<li>å®ç°ç®€å•ï¼šæ˜“äºåˆ†å¸ƒå¼è®¡ç®—</li>
<li>æ€§èƒ½å¹³è¡¡ï¼šå»ºç«‹æ—¶é—´ vs æœç´¢è´¨é‡</li>
</ul>
<h5 data-id="heading-11">ç¬¬äºŒå±‚ï¼šå‘é‡åˆ†é…</h5>
<p>æ¯ä¸ªå‘é‡åˆ†é…åˆ°æœ€è¿‘çš„è´¨å¿ƒï¼ˆç¡¬åˆ†é…ï¼‰</p>
<p><strong>ä¸ºä»€ä¹ˆæ˜¯ç¡¬åˆ†é…ï¼Ÿ</strong></p>
<ul>
<li>å¿«é€Ÿï¼šO(1) æ—¶é—´</li>
<li>å†…å­˜é«˜æ•ˆï¼šä¸€ä¸ªå‘é‡å±äºä¸€ä¸ªç°‡</li>
<li>æœç´¢çµæ´»ï¼šå¯ä»¥æ£€æŸ¥å¤šä¸ªç›¸é‚»ç°‡</li>
</ul>
<h5 data-id="heading-12">ç¬¬ä¸‰å±‚ï¼šPQ é‡åŒ–</h5>
<p>å°†å‘é‡å‹ç¼© 99.7%ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-number">768</span><span class="hljs-string">ç»´å‘é‡</span> <span class="hljs-string">â†’</span> <span class="hljs-number">8</span><span class="hljs-string">ä¸ª96ç»´å­å‘é‡</span> <span class="hljs-string">â†’</span> <span class="hljs-number">8</span><span class="hljs-string">å­—èŠ‚ç </span>
<span class="hljs-number">3072</span><span class="hljs-string">å­—èŠ‚</span> <span class="hljs-string">â†’</span> <span class="hljs-number">8</span><span class="hljs-string">å­—èŠ‚ï¼Œå‹ç¼©ç‡</span> <span class="hljs-number">99.7</span><span class="hljs-string">%</span>
</code></pre>
<h4 data-id="heading-13">IVF_PQ çš„è·ç¦»è®¡ç®—ä¼˜åŒ–</h4>
<pre><code class="hljs language-scss" lang="scss">ç²¾ç¡®è·ç¦»è®¡ç®—ï¼š<span class="hljs-built_in">d</span>(q, v) = <span class="hljs-built_in">sqrt</span>(Î£(q_i - v_i)Â²)
              éœ€è¦ <span class="hljs-number">768</span> ä¸ªå‡æ³•ã€ä¹˜æ³•ã€æ±‚å’Œ
              è€—æ—¶ï¼š~<span class="hljs-number">100</span>ns

PQ è¿‘ä¼¼è·ç¦»ï¼šd_approx = Î£ lookup_table<span class="hljs-selector-attr">[i]</span><span class="hljs-selector-attr">[code_q[i]</span>]<span class="hljs-selector-attr">[code_v[i]</span>]
             åªéœ€ <span class="hljs-number">8</span> æ¬¡æ•°ç»„æŸ¥æ‰¾
             è€—æ—¶ï¼š~<span class="hljs-number">1</span>nsï¼ˆå¿« <span class="hljs-number">100</span> å€ï¼ï¼‰
</code></pre>
<hr/>
<h3 data-id="heading-14">ğŸ’» ä»£ç å®ç°ç¤ºä¾‹</h3>
<h4 data-id="heading-15">Pythonï¼šIVF_PQ ç´¢å¼•æ„å»ºä¸æœç´¢</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> lance
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> time

<span class="hljs-comment"># ç”Ÿæˆæµ‹è¯•æ•°æ®</span>
data = {
    <span class="hljs-string">'id'</span>: <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1_000_000</span>)),
    <span class="hljs-string">'vector'</span>: [np.random.rand(<span class="hljs-number">768</span>).astype(np.float32) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1_000_000</span>)],
    <span class="hljs-string">'category'</span>: np.random.choice([<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>], <span class="hljs-number">1_000_000</span>),
}

<span class="hljs-comment"># åˆ›å»ºæ•°æ®é›†</span>
dataset = lance.write_dataset(data, <span class="hljs-string">'products.lance'</span>)

<span class="hljs-comment"># æ­¥éª¤1ï¼šåˆ›å»º IVF_PQ ç´¢å¼•</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"å¼€å§‹æ„å»º IVF_PQ ç´¢å¼•..."</span>)
start_time = time.time()

dataset.create_index(
    <span class="hljs-string">'vector'</span>,
    index_type=<span class="hljs-string">'IVF_PQ'</span>,
    num_partitions=<span class="hljs-number">256</span>,        <span class="hljs-comment"># 256 ä¸ªè´¨å¿ƒç°‡</span>
    metric=<span class="hljs-string">'L2'</span>,               <span class="hljs-comment"># L2 è·ç¦»</span>
    num_bits=<span class="hljs-number">8</span>,                <span class="hljs-comment"># PQ ç å­—ç°¿ä½æ•°</span>
    num_sub_vectors=<span class="hljs-number">8</span>,         <span class="hljs-comment"># 768 / 8 = 96 ç»´å­å‘é‡</span>
    max_iters=<span class="hljs-number">50</span>,              <span class="hljs-comment"># KMeans è¿­ä»£æ¬¡æ•°</span>
    replace=<span class="hljs-literal">True</span>,
)

build_time = time.time() - start_time
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç´¢å¼•æ„å»ºå®Œæˆï¼Œè€—æ—¶: <span class="hljs-subst">{build_time:<span class="hljs-number">.2</span>f}</span>s"</span>)

<span class="hljs-comment"># æ­¥éª¤2ï¼šæ‰§è¡Œå‘é‡æœç´¢</span>
query_vector = np.random.rand(<span class="hljs-number">768</span>).astype(np.float32)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\næ‰§è¡Œå‘é‡æœç´¢..."</span>)
search_start = time.time()

results = dataset.search(
    query_vector,
    k=<span class="hljs-number">100</span>,
    nprobes=<span class="hljs-number">32</span>,        <span class="hljs-comment"># æœç´¢ 32 ä¸ªç°‡ï¼ˆé»˜è®¤ = num_partitions / 8ï¼‰</span>
    refine_factor=<span class="hljs-number">10</span>,  <span class="hljs-comment"># å€™é€‰é›†å¤§å° = k * refine_factor</span>
).to_list()

search_time = (time.time() - search_start) * <span class="hljs-number">1000</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æœç´¢å®Œæˆï¼Œè€—æ—¶: <span class="hljs-subst">{search_time:<span class="hljs-number">.2</span>f}</span>msï¼Œè¿”å› <span class="hljs-subst">{<span class="hljs-built_in">len</span>(results)}</span> ä¸ªç»“æœ"</span>)

<span class="hljs-comment"># æ­¥éª¤3ï¼šæ€§èƒ½å¯¹æ¯”</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== æ€§èƒ½åˆ†æ ==="</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ•°æ®é›†å¤§å°: 1,000,000 ä¸ªå‘é‡"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‘é‡ç»´åº¦: 768"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç´¢å¼•å¤§å°: ~80MB (1M Ã— 8å­—èŠ‚)"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŸå§‹æ•°æ®å¤§å°: ~3GB"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‹ç¼©ç‡: 99.7%"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æœç´¢åŠ é€Ÿ: 100ms / <span class="hljs-subst">{search_time:<span class="hljs-number">.2</span>f}</span>ms â‰ˆ <span class="hljs-subst">{<span class="hljs-number">100</span>/search_time:<span class="hljs-number">.1</span>f}</span>x"</span>)
</code></pre>
<h4 data-id="heading-16">Rustï¼šIVF ç´¢å¼•æ„å»º</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> lance::dataset::builder::DatasetBuilder;
<span class="hljs-keyword">use</span> lance::index::vector::{IvfBuildParams, PQBuildParams, VectorIndexParams};
<span class="hljs-keyword">use</span> lance::index::IndexType;
<span class="hljs-keyword">use</span> lance_linalg::distance::DistanceType;

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-comment">// æ­¥éª¤1ï¼šé…ç½® IVF_PQ å‚æ•°</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ivf_params</span> = IvfBuildParams {
        num_partitions: <span class="hljs-number">256</span>,   <span class="hljs-comment">// KMeans ç°‡æ•°</span>
        sample_rate: <span class="hljs-number">256</span>,
        max_iters: <span class="hljs-number">50</span>,
    };
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">pq_params</span> = PQBuildParams {
        num_sub_vectors: <span class="hljs-number">8</span>,    <span class="hljs-comment">// 768 / 8 = 96</span>
        num_bits: <span class="hljs-number">8</span>,           <span class="hljs-comment">// 2^8 = 256 ç å­—</span>
        max_iters: <span class="hljs-number">100</span>,
    };
    
    <span class="hljs-comment">// æ­¥éª¤2ï¼šåˆ›å»ºç´¢å¼•å‚æ•°</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">params</span> = VectorIndexParams::<span class="hljs-title function_ invoke__">with_ivf_pq_params</span>(
        DistanceType::L2,
        ivf_params,
        pq_params,
    );
    
    <span class="hljs-comment">// æ­¥éª¤3ï¼šæ„å»ºç´¢å¼•</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å¼€å§‹æ„å»º IVF_PQ ç´¢å¼•..."</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">start</span> = std::time::Instant::<span class="hljs-title function_ invoke__">now</span>();
    
    <span class="hljs-comment">// ... æ„å»ºé€»è¾‘ ...</span>
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">build_time</span> = start.<span class="hljs-title function_ invoke__">elapsed</span>();
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç´¢å¼•æ„å»ºå®Œæˆ: {:?}"</span>, build_time);
    
    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<hr/>
<h3 data-id="heading-17">ğŸ“Š å‚æ•°è°ƒä¼˜æŒ‡å—</h3>
<h4 data-id="heading-18">num_partitionsï¼ˆåˆ†åŒºæ•°ï¼‰</h4>
<pre><code class="hljs language-diff" lang="diff">é€‰æ‹©åŸåˆ™ï¼šnum_partitions â‰ˆ âˆšN  (N = å‘é‡æ•°)

ä¾‹å­ï¼š
100 ä¸‡å‘é‡    â†’ âˆš1M â‰ˆ 1000 ä¸ªç°‡
1 äº¿å‘é‡      â†’ âˆš100M â‰ˆ 10000 ä¸ªç°‡
10 äº¿å‘é‡     â†’ âˆš1B â‰ˆ 31623 ä¸ªç°‡

æƒè¡¡ï¼š
<span class="hljs-deletion">- ç°‡æ•° â†‘ â†’ æœç´¢å¿«ï¼ˆæ‰«æå°‘ï¼‰ä½†è®­ç»ƒæ…¢</span>
<span class="hljs-deletion">- ç°‡æ•° â†“ â†’ è®­ç»ƒå¿«ä½†æœç´¢æ…¢</span>
</code></pre>
<h4 data-id="heading-19">nprobesï¼ˆæœç´¢çš„åˆ†åŒºæ•°ï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">é»˜è®¤å€¼ï¼š<span class="hljs-attr">nprobes</span> = num_partitions / <span class="hljs-number">8</span>
256 ä¸ªç°‡ â†’ <span class="hljs-attr">nprobes</span> = <span class="hljs-number">32</span>

è°ƒä¼˜ï¼š
<span class="hljs-attr">nprobes</span>=<span class="hljs-number">10</span>   â†’ å¿«ï¼ˆ<span class="hljs-number">5</span>msï¼‰ä½†ç²¾åº¦ä½ï¼ˆ<span class="hljs-number">78</span>% recallï¼‰
<span class="hljs-attr">nprobes</span>=<span class="hljs-number">20</span>   â†’ å¹³è¡¡ï¼ˆ<span class="hljs-number">92</span>% recallï¼‰
<span class="hljs-attr">nprobes</span>=<span class="hljs-number">32</span>   â†’ æ¨èï¼ˆ<span class="hljs-number">95</span>% recallï¼‰ âœ“
<span class="hljs-attr">nprobes</span>=<span class="hljs-number">64</span>   â†’ å‡†ç¡®ï¼ˆ<span class="hljs-number">98</span>% recallï¼‰ä½†è¾ƒæ…¢ï¼ˆ<span class="hljs-number">10</span>msï¼‰
</code></pre>
<hr/>
<h3 data-id="heading-20">ğŸ“ˆ æ€§èƒ½å¯¹æ¯”</h3>
<h4 data-id="heading-21">IVF_FLAT vs IVF_PQï¼ˆ1000ä¸‡å‘é‡ï¼‰</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">æŒ‡æ ‡</span>          <span class="hljs-string">IVF_FLAT</span>    <span class="hljs-string">IVF_PQ</span>
<span class="hljs-string">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-string">æœç´¢å»¶è¿Ÿ</span>      <span class="hljs-string">40ms</span>        <span class="hljs-string">5ms</span>      <span class="hljs-string">âœ“</span>
<span class="hljs-string">ç²¾ç¡®åº¦</span>        <span class="hljs-number">100</span><span class="hljs-string">%</span>        <span class="hljs-number">99</span><span class="hljs-string">%</span>
<span class="hljs-string">å†…å­˜å ç”¨</span>      <span class="hljs-string">30GB</span>        <span class="hljs-string">1GB</span>      <span class="hljs-string">âœ“</span>
<span class="hljs-string">QPS/æœºå™¨</span>      <span class="hljs-number">500</span>         <span class="hljs-number">1600</span>     <span class="hljs-string">âœ“</span>
</code></pre>
<h4 data-id="heading-22">ä¸åŒæ•°æ®è§„æ¨¡çš„æ€§èƒ½</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">å‘é‡æ•°</span>     <span class="hljs-string">æ„å»ºæ—¶é—´</span>   <span class="hljs-string">æœç´¢å»¶è¿Ÿ</span>   <span class="hljs-string">å†…å­˜å ç”¨</span>
<span class="hljs-string">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-number">100</span><span class="hljs-string">ä¸‡</span>     <span class="hljs-string">30s</span>        <span class="hljs-string">3ms</span>        <span class="hljs-string">100MB</span>
<span class="hljs-number">1000</span><span class="hljs-string">ä¸‡</span>    <span class="hljs-string">7m</span>         <span class="hljs-string">5ms</span>        <span class="hljs-string">1GB</span>
<span class="hljs-number">1</span><span class="hljs-string">äº¿</span>       <span class="hljs-string">90m</span>        <span class="hljs-string">10ms</span>       <span class="hljs-string">10GB</span>
<span class="hljs-number">10</span><span class="hljs-string">äº¿</span>      <span class="hljs-string">900m</span>       <span class="hljs-string">15ms</span>       <span class="hljs-string">100GB</span>
</code></pre>
<hr/>
<h3 data-id="heading-23">ğŸ¯ åº”ç”¨åœºæ™¯ï¼šç”µå•†æ¨èç³»ç»Ÿ</h3>
<h4 data-id="heading-24">èƒŒæ™¯</h4>
<ul>
<li>å•†å“åº“ï¼š1000 ä¸‡</li>
<li>å‘é‡ç»´åº¦ï¼š768</li>
<li>QPSï¼š10 ä¸‡</li>
<li>æ›´æ–°é¢‘ç‡ï¼šæ—¥æ›´</li>
</ul>
<h4 data-id="heading-25">ä¸ºä»€ä¹ˆé€‰æ‹© IVF_PQï¼Ÿ</h4>
<ol>
<li><strong>æ•°æ®è§„æ¨¡å¤§</strong>ï¼š1000ä¸‡ â†’ IVF_PQ ä¸“ä¸ºå¤§è§„æ¨¡ä¼˜åŒ–</li>
<li><strong>æ•°æ®ç›¸å¯¹é™æ€</strong>ï¼šæ—¥æ›´ â†’ æ— éœ€å®æ—¶å¢é‡</li>
<li><strong>ååé‡é«˜</strong>ï¼šéœ€è¦ 1600 QPS â†’ IVF_PQ æœ€å¿«</li>
<li><strong>ç²¾åº¦è¶³å¤Ÿ</strong>ï¼šæ¨èç³»ç»Ÿ 99% recall å¯æ¥å—</li>
</ol>
<h4 data-id="heading-26">å®ç°æ¶æ„</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ECommerceRecommender</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.dataset = lance.<span class="hljs-built_in">open</span>(<span class="hljs-string">'products.lance'</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">daily_reindex</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""æ¯å¤©å‡Œæ™¨é‡å»ºç´¢å¼•"""</span>
        self.dataset.create_index(
            <span class="hljs-string">'vector'</span>,
            index_type=<span class="hljs-string">'IVF_PQ'</span>,
            num_partitions=<span class="hljs-number">3162</span>,  <span class="hljs-comment"># âˆš10M</span>
            replace=<span class="hljs-literal">True</span>,
        )
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend</span>(<span class="hljs-params">self, query_vector, k=<span class="hljs-number">100</span></span>):
        <span class="hljs-string">"""å®æ—¶æ¨è"""</span>
        <span class="hljs-keyword">return</span> self.dataset.search(
            query_vector,
            k=k,
            nprobes=<span class="hljs-number">32</span>,
        ).to_list()
</code></pre>
<hr/>
<h3 data-id="heading-27">æ€»ç»“</h3>
<ul>
<li><strong>IVF</strong>ï¼šç”¨ç°‡åŠ é€Ÿæœç´¢ï¼ˆåˆ†è€Œæ²»ä¹‹ï¼‰</li>
<li><strong>IVF_PQ</strong>ï¼šç”¨é‡åŒ–èŠ‚çœç©ºé—´å’ŒåŠ é€Ÿè®¡ç®—ï¼ˆ99.7% å‹ç¼©ï¼‰</li>
<li><strong>IVF_FLAT</strong>ï¼šç²¾ç¡®ä½†å ç”¨ç©ºé—´ï¼ˆ100% recallï¼‰</li>
<li><strong>é€‰æ‹©æŒ‡å—</strong>ï¼š
<ul>
<li>æ•°æ®é‡ &gt; 10M â†’ IVF_PQ</li>
<li>ç²¾åº¦ä¼˜å…ˆ â†’ IVF_FLAT</li>
<li>é€Ÿåº¦ä¼˜å…ˆ â†’ IVF_PQ</li>
<li>å®æ—¶å¢é‡ â†’ æ”¹ç”¨ HNSW</li>
</ul>
</li>
</ul>
<p>ä¸‹ä¸€ç« è®² HNSW ç´¢å¼•ï¼Œå®ƒæä¾›äº†æ›´å¥½çš„å¢é‡æ›´æ–°èƒ½åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Mac ç«¯ä¼ä¸šå¾®ä¿¡è°ƒè¯•å·¥å…·å¼€å¯æŒ‡å—ï¼šè§£å†³é¡µé¢å…¼å®¹æ€§é—®é¢˜å¿…å¤‡]]></title>    <link>https://juejin.cn/post/7577336346663485486</link>    <guid>https://juejin.cn/post/7577336346663485486</guid>    <pubDate>2025-11-28T06:44:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577336346663485486" data-draft-id="7576272680520089643" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Mac ç«¯ä¼ä¸šå¾®ä¿¡è°ƒè¯•å·¥å…·å¼€å¯æŒ‡å—ï¼šè§£å†³é¡µé¢å…¼å®¹æ€§é—®é¢˜å¿…å¤‡"/> <meta itemprop="keywords" content="Mac"/> <meta itemprop="datePublished" content="2025-11-28T06:44:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°è¹¦è·¶å„¿"/> <meta itemprop="url" content="https://juejin.cn/user/3245414058300238"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Mac ç«¯ä¼ä¸šå¾®ä¿¡è°ƒè¯•å·¥å…·å¼€å¯æŒ‡å—ï¼šè§£å†³é¡µé¢å…¼å®¹æ€§é—®é¢˜å¿…å¤‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3245414058300238/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°è¹¦è·¶å„¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:44:47.000Z" title="Fri Nov 28 2025 06:44:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å‰è¨€ï¼š</p>
<p>æœ¬æ–‡ä¸»è¦åˆ†äº«ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p>
<ol>
<li>
<p>å¦‚ä½•æ‰“å¼€ Mac ç‰ˆä¼ä¸šå¾®ä¿¡ä¸­çš„è°ƒè¯•æ§åˆ¶å°ï¼šç”±äº Mac ç‰ˆä¼å¾®è°ƒè¯•å·¥å…·çš„å¼€å¯æ–¹å¼å’Œ Windows ä¸ä¸€æ ·ï¼Œç½‘ä¸Šæ•™ç¨‹é›¶æ•£ï¼Œæ‰€ä»¥æ•´ç†äº†è¯¦ç»†æ­¥éª¤ï¼Œå¸®å‰ç«¯åŒå­¦å¿«é€Ÿä¸Šæ‰‹ï½</p>
</li>
<li>
<p>æˆ‘é‡åˆ°ä¸ªå‘ï¼šé¡µé¢åœ¨ Windows ç«¯ä¼å¾®æ­£å¸¸ï¼ŒMac ç«¯æ‰“å¼€æ—¶å­—ä½“å´é—ªä¸€ä¸‹å˜å¤§ï¼Œéœ€è¦ç”¨ä¼å¾®è°ƒè¯•å·¥å…·å®šä½é—®é¢˜ï¼Œé™„è§£å†³æ–¹æ³•ã€‚</p>
</li>
</ol>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯ä»‹ç»</h2>
<p>éšç€å…¬å¸ä¼ä¸šå¾®ä¿¡çš„å…¨å‘˜æ¨å¹¿ï¼Œå†…éƒ¨ä¸šåŠ¡é¡µé¢é€æ­¥è¿ç§»è‡³ä¼å¾®ç¯å¢ƒè¿è¡Œï¼Œæ—¢æå‡äº†åä½œæ•ˆç‡ï¼Œä¹Ÿå¯¹é¡µé¢å…¼å®¹æ€§æå‡ºäº†æ›´é«˜è¦æ±‚ã€‚è¿‘æœŸå¼€å‘çš„é¡µé¢åœ¨ Windows ç«¯ä¼å¾®ä¸­è¡¨ç°æ­£å¸¸ï¼Œä½† Mac ç«¯ä¼å¾®æ‰“å¼€æ—¶å‡ºç°å­—ä½“é—ªçƒå˜å¤§çš„å¼‚å¸¸ï¼Œéœ€é€šè¿‡ <strong>ä¼å¾®å†…ç½®è°ƒè¯•å·¥å…·</strong> å®šä½é—®é¢˜ã€‚ç”±äº Mac ç‰ˆä¼å¾®è°ƒè¯•å·¥å…·çš„å¼€å¯è·¯å¾„ä¸ Windows ç«¯å­˜åœ¨å·®å¼‚ï¼Œç‰¹æ­¤æ•´ç†è¯¦ç»†æ“ä½œæµç¨‹ï¼Œä¸ºåŒç±»åœºæ™¯æä¾›å‚è€ƒã€‚</p>
<h2 data-id="heading-1">äºŒã€æ‰“å¼€æ­¥éª¤</h2>
<ol>
<li>
<p>é¦–å…ˆ <strong>æ‰“å¼€</strong> <code>debug</code>æ¨¡å¼ï¼š</p>
<p><strong>æ–¹æ³•</strong>ï¼šåŒæ—¶æŒ‰ä¸‹å¿«æ·é”®Â <code>commandÂ + shiftÂ +Â controlÂ +Â D</code>ï¼Œä¼šæœ‰<code>debug</code>æ¨¡å¼<strong>å¼€å¯</strong>çš„æç¤ºã€‚</p>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05279278e8ff413e951f53208f2e4786~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6Lmm6Le25YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917087&amp;x-signature=n%2BwdtdTRtFW%2BuWArwV%2F8FXKgxwM%3D" alt="image.png" loading="lazy"/></p>
<p>å†æŒ‰ä¸€æ¬¡å°±æ˜¯<strong>å…³é—­</strong>æç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/891f6c2baec14b43bbddfb0504d99bdb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6Lmm6Le25YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917087&amp;x-signature=QFw2k8c00%2Bq8XOYwpTdOxNDwAZ4%3D" alt="image.png" loading="lazy"/></p>
<ol start="2">
<li>ç„¶åç‚¹å‡»å·¦ä¸Šæ–¹çš„â€œè°ƒè¯•â€èœå•ï¼Œå³ã€è°ƒè¯•ã€‘â€”â€”&gt;ã€æµè§ˆå™¨ã€webViewç›¸å…³ã€‘â€”â€”&gt;ã€å¼€å¯webViewå…ƒç´ å®¡æŸ¥ã€‘ã€‚å…·ä½“è§ä¸‹é¢æˆªå›¾ï¼š</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6beec5f6e9ca4c3fa3c6a03bb6949e6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6Lmm6Le25YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917087&amp;x-signature=akhnHr8VpmX%2FJPUTli9stxvPef4%3D" alt="1fe54945-47c8-44ca-bdce-052ac089e475.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09210d3058b2419784f9458ffd33337f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6Lmm6Le25YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917087&amp;x-signature=klIdrf8W5dO6KL83cqLoottUCkc%3D" alt="image.png" loading="lazy"/></p>
<p>ç»“æŸè¿™ä¸ªæ­¥éª¤ä¹‹åï¼Œå†æ¬¡æ‰“å¼€è°ƒè¯•æŸ¥çœ‹æ—¶ï¼Œã€å¼€å¯webViewå…ƒç´ å®¡æŸ¥ã€‘ä¼šå˜æˆã€å…³é—­webViewå…ƒç´ å®¡æŸ¥ã€‘ï¼Œè¿™æ ·å°±è¯´æ˜å¼€å¯æˆåŠŸï¼Œå³ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/253d74ca06274c4d84edbf608ec38536~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6Lmm6Le25YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917087&amp;x-signature=xTE1qX6gwybKRR%2FgBkSqeILP6eE%3D" alt="11b04d5a-014d-402e-860d-f8edc98253b6.png" loading="lazy"/></p>
<ol start="3">
<li>
<p><strong>æœ€å å…³é—­ åº”ç”¨ é‡æ–°æ‰“å¼€ å³å¯</strong>ã€‚è¿™ä¸€æ­¥éå¸¸é‡è¦ï¼å¦‚æœä¸é‡æ–°æ‰“å¼€çš„è¯ï¼Œå³é”®æ—¶ï¼Œä¹Ÿä¸ä¼šå‡ºæ¥â€œæ£€æŸ¥å› ç´ â€ï¼Œå³ä¸‹é¢ç¬¬å››æ­¥å°±ä¸ä¼šç”Ÿæ•ˆã€‚</p>
</li>
<li>
<p>å³é”®ï¼Œå‡ºç° <strong>â€œæ£€æŸ¥å› ç´ â€</strong>ï¼Œæ‰“å¼€å°±æ˜¯è°ƒè¯•æ§åˆ¶å°äº†ï¼š</p>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/442eb0546d9a4c2d85ef39aacd33e028~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6Lmm6Le25YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917087&amp;x-signature=ggpJOHQ%2BeUH2F3VhAFDVcTcvcp4%3D" alt="4b1fab6a-d2f3-42a0-a125-f5d542413232.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa671b15cb98466e95d7f52913a31c65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6Lmm6Le25YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917087&amp;x-signature=eqVaeXDQdAIEQaNRf%2FVeEThlR1s%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸‰ã€Macçš„ä¼ä¸šå¾®ä¿¡çš„ç½‘é¡µï¼Œä¼šé»˜è®¤ç»™<code>body</code>åŠ ä¸€ä¸ª<code>zoom</code>å±æ€§</h2>
<p>è¿™ä¸€éšå½¢çš„è®¾ç½®å¯èƒ½ä¼šæˆä¸ºä½ é¡¹ç›®ä¸­<code>bug</code>çš„åŸå› ã€‚å°±æ¯”å¦‚æˆ‘é¡¹ç›®ä¸­çš„é—®é¢˜ï¼Œåœ¨ Windows ä¸­ï¼Œé¡µé¢çš„å­—ä½“æ²¡æœ‰é—®é¢˜ï¼Œåœ¨ Mac çš„ä¼å¾®ä¸­æ‰“å¼€ï¼Œé¡µé¢ä¸­çš„å­—ä½“ä¼šç¼©æ”¾ä¸€ä¸‹ï¼Œå°±æ˜¯ç”±äºè¿™ä¸ªé»˜è®¤å±æ€§å¯¼è‡´çš„ã€‚æˆ‘éœ€è¦å¯¹æ­¤å•ç‹¬å¤„ç†ä¸€ä¸‹ï¼Œå°±èƒ½å®Œç¾è§£å†³é—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bff2b7c2fd2544b7b7743abbef5da2db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6Lmm6Le25YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764917087&amp;x-signature=KUmxo9bcImLfxirAV18S%2BlwDefc%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">å››ã€æ€»ç»“</h2>
<p>è¿™å°±æ˜¯ Mac ç«¯ä¼ä¸šå¾®ä¿¡è°ƒè¯•å·¥å…·çš„å®Œæ•´å¼€å¯æ­¥éª¤å•¦ï½ æŒ‰ç…§æµç¨‹æ“ä½œåï¼Œå°±èƒ½åƒåœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸€æ ·ï¼Œè°ƒè¯•ä¼å¾®å†…çš„é¡µé¢æ ·å¼ã€æ¥å£è¯·æ±‚ç­‰ï¼Œè½»æ¾å®šä½å­—ä½“å¼‚å¸¸ã€å¸ƒå±€é”™ä¹±ã€äº¤äº’å¤±æ•ˆç­‰é—®é¢˜ã€‚</p>
<p>å¦‚æœä½ çš„å·¥ä½œä¸­ä¹Ÿéœ€è¦åœ¨ä¼å¾®ç”Ÿæ€å¼€å‘é¡µé¢ï¼Œæœ¬æ–‡çš„è°ƒè¯•æ§åˆ¶å°å¼€å¯æ–¹æ³•èƒ½ç›´æ¥å‚è€ƒã€‚è‹¥æœ‰å…¶ä»–ä¼å¾®è°ƒè¯•çš„å°æŠ€å·§ï¼Œä¹Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï¼Œä¸€èµ·é¿å‘ææ•ˆï¼</p>
<p>ä»¥ä¸Šï¼Œå¸Œæœ›å¯¹ä½ æœ‰å¸®åŠ©ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue3+ant-design-vue]]></title>    <link>https://juejin.cn/post/7577284968923873280</link>    <guid>https://juejin.cn/post/7577284968923873280</guid>    <pubDate>2025-11-28T06:24:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577284968923873280" data-draft-id="7577239264309985280" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue3+ant-design-vue"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-28T06:24:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¡Œèµ°åœ¨é¡¶å°–"/> <meta itemprop="url" content="https://juejin.cn/user/1257497030561512"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue3+ant-design-vue
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1257497030561512/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¡Œèµ°åœ¨é¡¶å°–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T06:24:57.000Z" title="Fri Nov 28 2025 06:24:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.:deep</h2>
<p><code>scoped</code>Â ä¼šé™åˆ¶æ ·å¼ä»…ä½œç”¨äºå½“å‰ç»„ä»¶çš„å…ƒç´ ï¼Œ<code>deep()</code>Â æ˜¯ç”¨äºç©¿é€Â <code>scoped</code>Â æ ·å¼ä½œç”¨åŸŸçš„è¯­æ³•ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯ä¿®æ”¹å­ç»„ä»¶ / ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼ˆå¦‚ Ant Design Vueï¼‰å†…éƒ¨çš„æ ·å¼ã€‚</p>
<p>å½“Â <code>&lt;style&gt;</code>Â æ ‡ç­¾åŠ ä¸ŠÂ <code>scoped</code>Â æ—¶ï¼ŒVue ä¼šç»™å½“å‰ç»„ä»¶çš„æ‰€æœ‰å…ƒç´ è‡ªåŠ¨æ·»åŠ ä¸€ä¸ªå”¯ä¸€çš„å±æ€§ï¼ˆå¦‚Â <code>data-v-xxxxxx</code>ï¼‰ï¼Œæ ·å¼ä¼šè¢«ç¼–è¯‘ä¸ºã€Œé€‰æ‹©å™¨ + è¯¥å±æ€§ã€çš„å½¢å¼ï¼ˆæ¯”å¦‚Â <code>.my-class[data-v-xxxxxx]</code>ï¼‰ã€‚</p>
<p>å­ç»„ä»¶ / ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼ˆå¦‚ Ant Design çš„Â <code>Pagination</code>ï¼‰çš„<strong>å†…éƒ¨å…ƒç´ </strong>ä¸ä¼šç»§æ‰¿è¿™ä¸ªå±æ€§ï¼Œæ‰€ä»¥ç›´æ¥å†™å­ç»„ä»¶çš„ç±»åï¼ˆæ¯”å¦‚Â <code>.ant-pagination-options</code>ï¼‰ä¼šå¤±æ•ˆ â€”â€” æ­¤æ—¶éœ€è¦ç”¨Â <code>:deep()</code>Â åŒ…è£¹é€‰æ‹©å™¨ï¼Œè®©æ ·å¼ â€œç©¿é€â€ åˆ°å­ç»„ä»¶å†…éƒ¨ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ä½ çš„åˆ†é¡µç»„ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Pagination</span>
    <span class="hljs-attr">v-model:current</span>=<span class="hljs-string">"pageIndex"</span>
    <span class="hljs-attr">v-model:pageSize</span>=<span class="hljs-string">"pageSize"</span>
    <span class="hljs-attr">:total</span>=<span class="hljs-string">"total"</span>
    <span class="hljs-attr">show-size-changer</span>
  /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>è¿™æ˜¯æ²¡æœ‰æ·»åŠ æ ·å¼æ—¶æºä»£ç </p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae58c18bbc86448cbadce73c6addc10d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KGM6LWw5Zyo6aG25bCW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915897&amp;x-signature=bo%2BiiQUbn0t67qPiq%2BNJwuv1Lis%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_17642939291330.png" loading="lazy"/></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
    :<span class="hljs-built_in">deep</span>(.ant-pagination-options) {
        <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">20px</span>;
    }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>è¿›è¡Œæ ·å¼ç©¿é€ä¹‹åï¼Œæ ·å¼å°±è¢«åŠ å…¥è¿›å»ï¼Œå®ç°æ•ˆæœï¼šæ¡æ•°é€‰æ‹©é—´è·å˜å¤§
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9fcf952e994401baa8a27dc46304977~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KGM6LWw5Zyo6aG25bCW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915897&amp;x-signature=K0b65zPLVNsp8lB8Fp138GucVro%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_1764293991149.png" loading="lazy"/></p>
<h3 data-id="heading-1">å…³é”®æ³¨æ„äº‹é¡¹</h3>
<ol>
<li>
<p><strong>å¿…é¡»é…åˆÂ <code>scoped</code></strong>ï¼šåªæœ‰Â <code>&lt;style scoped&gt;</code>Â æ‰éœ€è¦Â <code>:deep</code>ï¼Œå…¨å±€æ ·å¼ï¼ˆæ— Â <code>scoped</code>ï¼‰ç›´æ¥å†™é€‰æ‹©å™¨å³å¯ã€‚</p>
</li>
<li>
<p><strong>é¿å…æ»¥ç”¨</strong>ï¼š<code>:deep</code>Â ä¼šè®©æ ·å¼ä½œç”¨äºå­ç»„ä»¶ï¼Œè¿‡åº¦ä½¿ç”¨å¯èƒ½å¯¼è‡´æ ·å¼æ±¡æŸ“ï¼ˆå»ºè®®é…åˆçˆ¶ç±»åç²¾å‡†å®šä½ï¼Œæ¯”å¦‚Â <code>.custom-pagination:deep(...)</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>é€‰æ‹©å™¨è¦ç²¾å‡†</strong>ï¼šå…ˆé€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰æ‰¾åˆ°ç›®æ ‡å…ƒç´ çš„ç±»åï¼ˆæ¯”å¦‚ Ant Design åˆ†é¡µçš„ â€œæ¡æ•°é€‰æ‹©å™¨â€ ç±»åæ˜¯Â <code>.ant-pagination-options</code>ï¼‰ï¼Œå†ç”¨Â <code>:deep</code>Â åŒ…è£¹ã€‚</p>
</li>
<li>
<p>è‹¥æ ·å¼ä¸ç”Ÿæ•ˆï¼Œå¯åœ¨å±æ€§ååŠ Â <code>!important</code>Â å¼ºåˆ¶è¦†ç›–ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">    &lt;Pagination
        <span class="hljs-attr">class</span>=<span class="hljs-string">"custom-pagination"</span> //é¢å¤–å¢åŠ ç±»åï¼Œé˜²æ­¢ä½¿ç”¨:deepç©¿é€é€ æˆæ±¡æŸ“
        v-model:<span class="hljs-attr">current</span>=<span class="hljs-string">"pageIndex"</span>
        v-model:<span class="hljs-attr">pageSize</span>=<span class="hljs-string">"pageSize"</span>
        :<span class="hljs-attr">total</span>=<span class="hljs-string">"total"</span>
        :<span class="hljs-attr">show-total</span>=<span class="hljs-string">"(total) =&gt; `å…± ${total} æ¡`"</span>
    /&gt;
    
.custom-pagination:deep(.ant-pagination-options) {
    margin-left: 80px<span class="hljs-comment">;</span>
}

</code></pre>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12d0e63c32e844d88cf146499f3f8fe6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KGM6LWw5Zyo6aG25bCW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915897&amp;x-signature=E5Q3W3JM67epwcQ9O5C7BiLoLLg%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_17642944127493.png" loading="lazy"/></p>
<p>æ•ˆæœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b25b3b1a90724b3eadaedb8e11684b54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KGM6LWw5Zyo6aG25bCW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915897&amp;x-signature=oBBECGrG4bYUoBOnp8UOm%2FrqcMY%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_17642944306831.png" loading="lazy"/></p>
<p>åŸæœ¬åˆ†é¡µå±•ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8530306f955c446c8d33fdcdc53469d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KGM6LWw5Zyo6aG25bCW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764915897&amp;x-signature=V51EmvZ6u3Dwyo6A7GPnt7SwqOI%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_176429448418.png" loading="lazy"/></p>
<h4 data-id="heading-2">æ”¹è‡ªå·±çš„å­ç»„ä»¶æ ·å¼</h4>
<p>å¦‚æœä¸€ä¸ªè‡ªå®šä¹‰å­ç»„ä»¶Â <code>&lt;ChildComp&gt;</code>ï¼Œå…¶å†…éƒ¨æœ‰ç±»åÂ <code>.child-item</code>ï¼Œçˆ¶ç»„ä»¶è¦ä¿®æ”¹å®ƒï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨å­ç»„ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ChildComp</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/* ç©¿é€åˆ° ChildComp å†…éƒ¨ï¼Œä¿®æ”¹ .child-item çš„æ ·å¼ */</span>
:<span class="hljs-built_in">deep</span>(.child-item) {
  <span class="hljs-attribute">color</span>: red; <span class="hljs-comment">/* å­ç»„ä»¶çš„ .child-item æ–‡å­—å˜æˆçº¢è‰² */</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h4 data-id="heading-3">æ ·å¼é¢„å¤„ç†å™¨å…¼å®¹ï¼ˆSCSS/Sassï¼‰</h4>
<p>SCSS/Sassï¼Œ<code>:deep</code>Â çš„å†™æ³•ä¸å˜</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.custom-pagination</span> {
  // åµŒå¥—å†™æ³•ä¹Ÿæ”¯æŒ
  :<span class="hljs-built_in">deep</span>(..custom-pagination) {
    <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10px</span>;
    &amp;<span class="hljs-selector-pseudo">:hover</span> {
      <span class="hljs-attribute">border-color</span>: red; // hoveræ—¶çš„è¾¹æ¡†é¢œè‰²
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h3 data-id="heading-4">Vue2 ä¸ Vue3 çš„å†™æ³•åŒºåˆ«</h3>
<ul>
<li>Vue2 ä¸­æ˜¯Â <code>/deep/</code>ã€<code>::v-deep</code>ã€<code>&gt;&gt;&gt;</code>ï¼ˆä¸åŒé¢„å¤„ç†å™¨å†™æ³•ä¸åŒï¼‰ã€‚</li>
<li>Vue3 åœ¨Â <code>&lt;style scoped&gt;</code>Â ä¸­<strong>ç»Ÿä¸€æ¨èç”¨Â <code>:deep()</code></strong> ï¼Œå…¼å®¹æ€§æ›´å¥½ã€‚</li>
</ul>
<h2 data-id="heading-5">Transition</h2>
<p>Vue3 ä¸­çš„Â <code>&lt;Transition&gt;</code>Â æ˜¯å†…ç½®çš„è¿‡æ¸¡åŠ¨ç”»ç»„ä»¶ï¼Œç”¨äºç»™Â <strong>å•ä¸ªå…ƒç´  / ç»„ä»¶</strong>Â çš„Â <strong>è¿›å…¥ / ç¦»å¼€</strong>Â æä¾›å¹³æ»‘åŠ¨ç”»æ•ˆæœï¼ˆå¦‚æ·¡å…¥æ·¡å‡ºã€æ»‘åŠ¨ç­‰ï¼‰ã€‚æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡åŠ¨æ€æ·»åŠ  / ç§»é™¤ CSS ç±»åï¼Œæ§åˆ¶åŠ¨ç”»çš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<h3 data-id="heading-6">1. è¿‡æ¸¡ç”Ÿå‘½å‘¨æœŸä¸ç±»å</h3>
<p>Vue3 ä¸­è¿‡æ¸¡ç±»åç›¸æ¯” Vue2 æœ‰è°ƒæ•´ï¼ˆæ›´è¯­ä¹‰åŒ–ï¼‰ï¼Œå…± 6 ä¸ªæ ¸å¿ƒç±»åï¼ˆé»˜è®¤å‰ç¼€ä¸ºÂ <code>v-</code>ï¼Œå¯é€šè¿‡Â <code>name</code>Â å±æ€§è‡ªå®šä¹‰ï¼‰ï¼š</p>








































<table><thead><tr><th>ç±»å</th><th>ä½œç”¨æ—¶æœº</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>v-enter-from</code></td><td>è¿›å…¥åŠ¨ç”»å¼€å§‹å‰ï¼ˆåˆå§‹çŠ¶æ€ï¼‰</td><td>åŠ¨ç”»å¼€å§‹æ—¶æ·»åŠ ï¼Œä¸‹ä¸€å¸§ç§»é™¤</td></tr><tr><td><code>v-enter-active</code></td><td>è¿›å…¥åŠ¨ç”»è¿›è¡Œä¸­ï¼ˆè¿‡æ¸¡çŠ¶æ€ï¼‰</td><td>åŠ¨ç”»å¼€å§‹æ—¶æ·»åŠ ï¼ŒåŠ¨ç”»ç»“æŸåç§»é™¤</td></tr><tr><td><code>v-enter-to</code></td><td>è¿›å…¥åŠ¨ç”»ç»“æŸåï¼ˆç›®æ ‡çŠ¶æ€ï¼‰</td><td>ä¸‹ä¸€å¸§æ·»åŠ ï¼ŒåŠ¨ç”»ç»“æŸåç§»é™¤</td></tr><tr><td><code>v-leave-from</code></td><td>ç¦»å¼€åŠ¨ç”»å¼€å§‹å‰ï¼ˆåˆå§‹çŠ¶æ€ï¼‰</td><td>åŠ¨ç”»å¼€å§‹æ—¶æ·»åŠ ï¼Œä¸‹ä¸€å¸§ç§»é™¤</td></tr><tr><td><code>v-leave-active</code></td><td>ç¦»å¼€åŠ¨ç”»è¿›è¡Œä¸­ï¼ˆè¿‡æ¸¡çŠ¶æ€ï¼‰</td><td>åŠ¨ç”»å¼€å§‹æ—¶æ·»åŠ ï¼ŒåŠ¨ç”»ç»“æŸåç§»é™¤</td></tr><tr><td><code>v-leave-to</code></td><td>ç¦»å¼€åŠ¨ç”»ç»“æŸåï¼ˆç›®æ ‡çŠ¶æ€ï¼‰</td><td>ä¸‹ä¸€å¸§æ·»åŠ ï¼ŒåŠ¨ç”»ç»“æŸåç§»é™¤</td></tr></tbody></table>
<p>ç®€å•ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-css" lang="css"> &lt;!-- å¸åˆ«æœç´¢è¿‡æ»¤æ¡†ï¼šè´§å¸ç¬¦åˆè§¦å‘æœç´¢æ—¶è°ƒç”¨ï¼Œåœ¨é¢„è§ˆé¡µé¢æ˜¾ç¤ºã€‚ <span class="hljs-attribute">Transition</span> vueç»„ä»¶ å®ç°è¿‡æ¸¡æ•ˆæœ --&gt;
&lt;<span class="hljs-attribute">Transition</span> name="fade"&gt;
    &lt;searching
        v-if="showSearchFilter"
        v-model:visible=<span class="hljs-string">"showSearchFilter"</span>
    /&gt;
&lt;/Transition&gt;

<span class="hljs-comment">/* æ·¡å…¥æ·¡å‡ºè¿‡æ¸¡æ•ˆæœ */</span>
.fade-enter-from {
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* åˆå§‹çŠ¶æ€ï¼šå®Œå…¨é€æ˜ */</span>
}
<span class="hljs-selector-class">.fade-enter-active</span> {
    <span class="hljs-attribute">transition</span>: opacity <span class="hljs-number">0.3s</span> ease-out; <span class="hljs-comment">/* è¿›å…¥åŠ¨ç”»ï¼š0.3 ç§’æ·¡å‡ºæ•ˆæœ */</span>
}
<span class="hljs-selector-class">.fade-leave-from</span> {
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; <span class="hljs-comment">/* ç¦»å¼€å¼€å§‹çŠ¶æ€ï¼šå®Œå…¨ä¸é€æ˜ */</span>
}
<span class="hljs-selector-class">.fade-leave-active</span> {
    <span class="hljs-attribute">transition</span>: opacity <span class="hljs-number">0.3s</span> ease-in; <span class="hljs-comment">/* ç¦»å¼€åŠ¨ç”»ï¼š0.3 ç§’æ·¡å…¥æ•ˆæœ */</span>
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* ç¦»å¼€ç»“æŸçŠ¶æ€ï¼šå®Œå…¨é€æ˜ */</span>
}
</code></pre>
<h3 data-id="heading-7">2. è§¦å‘æ¡ä»¶</h3>
<ul>
<li>æ¡ä»¶æ¸²æŸ“ï¼ˆ<code>v-if</code>/<code>v-show</code>ï¼‰</li>
<li>åŠ¨æ€ç»„ä»¶ï¼ˆ<code>&lt;component :is="xxx"&gt;</code>ï¼‰</li>
<li>è·¯ç”±åˆ‡æ¢ï¼ˆç»“åˆÂ <code>vue-router</code>ï¼‰</li>
<li>å…ƒç´ çš„Â <code>key</code>Â å˜åŒ–</li>
</ul>

<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- 1. ç”¨ Transition åŒ…è£¹ç›®æ ‡å…ƒç´  --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Transition</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"fade"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 2. è§¦å‘æ¡ä»¶ï¼šv-if/v-show --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"isShow"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>è¿‡æ¸¡åŠ¨ç”»ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Transition</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"isShow = !isShow"</span>&gt;</span>åˆ‡æ¢æ˜¾ç¤º<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> isShow = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>) <span class="hljs-comment">// æ§åˆ¶å…ƒç´ æ˜¾ç¤º/éšè—</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 3. ç¼–å†™è¿‡æ¸¡åŠ¨ç”» CSS --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.box</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#409eff</span>;
  <span class="hljs-attribute">color</span>: white;
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">200px</span>;
}

<span class="hljs-comment">/* è¿›å…¥åŠ¨ç”»ï¼šæ·¡å…¥ + ç¼©æ”¾ */</span>
<span class="hljs-selector-class">.fade-enter-from</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* åˆå§‹é€æ˜ */</span>
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">0.8</span>); <span class="hljs-comment">/* åˆå§‹ç¼©å° */</span>
}
<span class="hljs-selector-class">.fade-enter-active</span> {
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.5s</span> ease; <span class="hljs-comment">/* è¿‡æ¸¡æ—¶é•¿å’Œæ›²çº¿ */</span>
}
<span class="hljs-selector-class">.fade-enter-to</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; <span class="hljs-comment">/* ç»“æŸä¸é€æ˜ */</span>
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">/* ç»“æŸåŸå°ºå¯¸ */</span>
}

<span class="hljs-comment">/* ç¦»å¼€åŠ¨ç”»ï¼šæ·¡å‡º + ç¼©æ”¾ */</span>
<span class="hljs-selector-class">.fade-leave-from</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
}
<span class="hljs-selector-class">.fade-leave-active</span> {
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.5s</span> ease;
}
<span class="hljs-selector-class">.fade-leave-to</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">0.8</span>);
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<ul>
<li><code>name="fade"</code>ï¼šæŒ‡å®šè¿‡æ¸¡ç±»åå‰ç¼€ï¼Œæ­¤æ—¶ç±»åä»Â <code>v-xxx</code>Â å˜ä¸ºÂ <code>fade-xxx</code>ï¼ˆé¿å…å…¨å±€æ ·å¼å†²çªï¼‰ã€‚</li>
<li>å¿…é¡»åŒ…è£¹Â <strong>å•ä¸ªæ ¹å…ƒç´ </strong>ï¼ˆè‹¥éœ€å¤šä¸ªå…ƒç´ ï¼Œç”¨Â <code>&lt;div&gt;</code>Â åŒ…è£¹æˆä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼‰ã€‚</li>
<li>åŠ¨ç”»ç”±Â <code>transition</code>Â CSS å±æ€§æ§åˆ¶ï¼ˆä¹Ÿæ”¯æŒÂ <code>animation</code>Â åŠ¨ç”»ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€ä½¿ç”¨ Animation åŠ¨ç”»ï¼ˆè€Œé Transitionï¼‰</h2>
<p>å¦‚æœéœ€è¦æ›´å¤æ‚çš„åŠ¨ç”»ï¼ˆå¦‚å¾ªç¯ã€å…³é”®å¸§ï¼‰ï¼Œå¯ä½¿ç”¨ CSSÂ <code>animation</code>Â é…åˆÂ <code>&lt;Transition&gt;</code>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Transition</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"bounce"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"isShow"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>åŠ¨ç”»ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Transition</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/* å®šä¹‰å…³é”®å¸§åŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> bounce-in {
  <span class="hljs-number">0%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">0</span>); }
  <span class="hljs-number">50%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.2</span>); }
  <span class="hljs-number">100%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>); }
}

<span class="hljs-keyword">@keyframes</span> bounce-out {
  <span class="hljs-number">0%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>); }
  <span class="hljs-number">50%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.2</span>); }
  <span class="hljs-number">100%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">0</span>); }
}

<span class="hljs-comment">/* è¿›å…¥åŠ¨ç”»ï¼šä½¿ç”¨ animation */</span>
<span class="hljs-selector-class">.bounce-enter-active</span> {
  <span class="hljs-attribute">animation</span>: bounce-in <span class="hljs-number">0.5s</span> ease;
}
<span class="hljs-comment">/* ç¦»å¼€åŠ¨ç”»ï¼šä½¿ç”¨ animation */</span>
<span class="hljs-selector-class">.bounce-leave-active</span> {
  <span class="hljs-attribute">animation</span>: bounce-out <span class="hljs-number">0.5s</span> ease;
}

<span class="hljs-comment">/* å¯é€‰ï¼šè®¾ç½®åŠ¨ç”»ç»“æŸåçš„çŠ¶æ€ï¼ˆé¿å…é—ªå›ï¼‰ */</span>
<span class="hljs-selector-class">.bounce-enter-to</span>,
<span class="hljs-selector-class">.bounce-leave-from</span> {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h2 data-id="heading-9">å¸¸è§åœºæ™¯æ‹“å±•</h2>
<h3 data-id="heading-10">1. åŠ¨æ€ç»„ä»¶è¿‡æ¸¡</h3>
<p>ç»™åŠ¨æ€åˆ‡æ¢çš„ç»„ä»¶åŠ è¿‡æ¸¡ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Transition</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"fade"</span> <span class="hljs-attr">mode</span>=<span class="hljs-string">"out-in"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span> <span class="hljs-attr">key</span>=<span class="hljs-string">"currentComponent"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Transition</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"currentComponent = currentComponent === 'A' ? 'B' : 'A'"</span>&gt;</span>
    åˆ‡æ¢ç»„ä»¶
  <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> A <span class="hljs-keyword">from</span> <span class="hljs-string">'./A.vue'</span>
<span class="hljs-keyword">import</span> B <span class="hljs-keyword">from</span> <span class="hljs-string">'./B.vue'</span>
<span class="hljs-keyword">const</span> currentComponent = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'A'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<ul>
<li><code>mode="out-in"</code>ï¼šè¿‡æ¸¡æ¨¡å¼ï¼Œå…ˆæ‰§è¡Œç¦»å¼€åŠ¨ç”»ï¼Œå†æ‰§è¡Œè¿›å…¥åŠ¨ç”»ï¼ˆé¿å…ä¸¤ä¸ªç»„ä»¶é‡å ï¼‰ã€‚</li>
<li>å¿…åŠ Â <code>key</code>ï¼šç¡®ä¿ç»„ä»¶åˆ‡æ¢æ—¶è§¦å‘è¿‡æ¸¡ã€‚</li>
</ul>
<h3 data-id="heading-11">2. è·¯ç”±è¿‡æ¸¡ï¼ˆç»“åˆ vue-routerï¼‰</h3>
<p>ç»™è·¯ç”±åˆ‡æ¢åŠ å…¨å±€è¿‡æ¸¡ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- App.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span> <span class="hljs-attr">v-slot</span>=<span class="hljs-string">"{ Component }"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Transition</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"route-fade"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"Component"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Transition</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-comment">/* è·¯ç”±è¿‡æ¸¡æ ·å¼ */</span>
<span class="hljs-selector-class">.route-fade-enter-from</span>,
<span class="hljs-selector-class">.route-fade-leave-to</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">20px</span>);
}
<span class="hljs-selector-class">.route-fade-enter-active</span>,
<span class="hljs-selector-class">.route-fade-leave-active</span> {
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h3 data-id="heading-12">3. åˆ—è¡¨è¿‡æ¸¡ï¼ˆTransitionGroupï¼‰</h3>
<p><code>&lt;Transition&gt;</code>Â ä»…æ”¯æŒå•ä¸ªå…ƒç´ ï¼Œåˆ—è¡¨è¿‡æ¸¡éœ€ç”¨Â <code>&lt;TransitionGroup&gt;</code>ï¼ˆåŒ…è£¹å¤šä¸ªå…ƒç´ ï¼Œéœ€ç»™æ¯ä¸ªå…ƒç´ åŠ Â <code>key</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">TransitionGroup</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"list"</span> <span class="hljs-attr">tag</span>=<span class="hljs-string">"ul"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in list"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"list-item"</span>&gt;</span>
      {{ item.name }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">TransitionGroup</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"addItem"</span>&gt;</span>æ·»åŠ é¡¹<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> list = <span class="hljs-title function_">ref</span>([{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'é¡¹1'</span> }, { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'é¡¹2'</span> }])

<span class="hljs-keyword">const</span> <span class="hljs-title function_">addItem</span> = (<span class="hljs-params"/>) =&gt; {
  list.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">id</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(), <span class="hljs-attr">name</span>: <span class="hljs-string">`é¡¹<span class="hljs-subst">${list.value.length + <span class="hljs-number">1</span>}</span>`</span> })
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-tag">ul</span> { <span class="hljs-attribute">list-style</span>: none; <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>; }
<span class="hljs-selector-class">.list-item</span> {
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#f5f5f5</span>;
}

<span class="hljs-comment">/* åˆ—è¡¨é¡¹è¿‡æ¸¡æ ·å¼ */</span>
<span class="hljs-selector-class">.list-enter-from</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">10px</span>);
}
<span class="hljs-selector-class">.list-enter-active</span> {
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
}
<span class="hljs-selector-class">.list-leave-active</span> {
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">10px</span>);
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<ul>
<li><code>tag="ul"</code>ï¼šæŒ‡å®šÂ <code>&lt;TransitionGroup&gt;</code>Â æ¸²æŸ“ä¸ºÂ <code>&lt;ul&gt;</code>Â æ ‡ç­¾ï¼ˆé»˜è®¤ä¸æ¸²æŸ“æ ¹æ ‡ç­¾ï¼‰ã€‚</li>
<li>æ¯ä¸ªåˆ—è¡¨é¡¹å¿…é¡»æœ‰å”¯ä¸€Â <code>key</code>ã€‚</li>
</ul>
<h3 data-id="heading-13">4.JavaScript é’©å­ï¼ˆæ§åˆ¶å¤æ‚åŠ¨ç”»ï¼‰</h3>
<p>å¦‚æœéœ€è¦é€šè¿‡ JS æ§åˆ¶åŠ¨ç”»ï¼ˆå¦‚å›è°ƒã€å¼‚æ­¥åŠ¨ç”»ï¼‰ï¼Œå¯ä½¿ç”¨Â <code>&lt;Transition&gt;</code>Â çš„é’©å­å‡½æ•°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;template&gt;
  &lt;Transition
    @<span class="hljs-attr">enter</span>=<span class="hljs-string">"onEnter"</span>
    @<span class="hljs-attr">leave</span>=<span class="hljs-string">"onLeave"</span>
    :<span class="hljs-attr">css</span>=<span class="hljs-string">"false"</span> &lt;!-- ç¦ç”¨ CSS è¿‡æ¸¡ï¼Œå®Œå…¨ç”± JS æ§åˆ¶ --&gt;
  &gt;
    &lt;div <span class="hljs-attr">v-if</span>=<span class="hljs-string">"isShow"</span> ref=<span class="hljs-string">"boxRef"</span> class=<span class="hljs-string">"box"</span>&gt;JS æ§åˆ¶åŠ¨ç”»&lt;/div&gt;
  &lt;/Transition&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'
const <span class="hljs-attr">isShow</span> = ref(<span class="hljs-literal">false</span>)
const <span class="hljs-attr">boxRef</span> = ref(null)

// è¿›å…¥åŠ¨ç”»é’©å­
const <span class="hljs-attr">onEnter</span> = (el, done) =&gt; {
  <span class="hljs-attr">el.style.opacity</span> = <span class="hljs-number">0</span>
  <span class="hljs-attr">el.style.transform</span> = <span class="hljs-string">'scale(0.8)'</span>
  // ç”¨ requestAnimationFrame è§¦å‘åŠ¨ç”»
  requestAnimationFrame(() =&gt; {
    <span class="hljs-attr">el.style.transition</span> = <span class="hljs-string">'all 0.5s ease'</span>
    <span class="hljs-attr">el.style.opacity</span> = <span class="hljs-number">1</span>
    <span class="hljs-attr">el.style.transform</span> = <span class="hljs-string">'scale(1)'</span>
    // åŠ¨ç”»ç»“æŸåè°ƒç”¨ done() é€šçŸ¥ Vue
    el.addEventListener('transitionend', done)
  })
}

// ç¦»å¼€åŠ¨ç”»é’©å­
const <span class="hljs-attr">onLeave</span> = (el, done) =&gt; {
  <span class="hljs-attr">el.style.transition</span> = <span class="hljs-string">'all 0.5s ease'</span>
  <span class="hljs-attr">el.style.opacity</span> = <span class="hljs-number">0</span>
  <span class="hljs-attr">el.style.transform</span> = <span class="hljs-string">'scale(0.8)'</span>
  el.addEventListener('transitionend', done)
}
&lt;/script&gt;
</code></pre>
<ul>
<li><code>:css="false"</code>ï¼šå¿…é¡»è®¾ç½®ï¼Œé¿å… Vue è‡ªåŠ¨æ·»åŠ  CSS ç±»åå¹²æ‰°ã€‚</li>
<li>é’©å­å‡½æ•°çš„Â <code>done</code>Â å‚æ•°ï¼šå¿…é¡»åœ¨åŠ¨ç”»ç»“æŸåè°ƒç”¨ï¼ˆå¦‚Â <code>transitionend</code>Â äº‹ä»¶ï¼‰ï¼Œå¦åˆ™ Vue ä¼šè®¤ä¸ºåŠ¨ç”»ç«‹å³ç»“æŸã€‚</li>
</ul>
<ol>
<li><strong>å¿…é¡»åŒ…è£¹å•ä¸ªæ ¹å…ƒç´ </strong>ï¼š<code>&lt;Transition&gt;</code>Â åªèƒ½æœ‰ä¸€ä¸ªç›´æ¥å­å…ƒç´ ï¼ˆåˆ—è¡¨ç”¨Â <code>&lt;TransitionGroup&gt;</code>ï¼‰ã€‚</li>
<li><strong><code>key</code>Â çš„é‡è¦æ€§</strong>ï¼šåŠ¨æ€ç»„ä»¶ã€è·¯ç”±ã€åˆ—è¡¨é¡¹å¿…é¡»åŠ Â <code>key</code>ï¼Œå¦åˆ™ Vue å¯èƒ½å¤ç”¨å…ƒç´ ï¼Œä¸è§¦å‘è¿‡æ¸¡ã€‚</li>
<li><strong>è¿‡æ¸¡æ¨¡å¼</strong>ï¼š<code>mode="out-in"</code>ï¼ˆå…ˆå‡ºåè¿›ï¼‰ã€<code>mode="in-out"</code>ï¼ˆå…ˆè¿›åå‡ºï¼‰ï¼Œé¿å…ç»„ä»¶é‡å ã€‚</li>
<li><strong>æ ·å¼ä½œç”¨åŸŸ</strong>ï¼šå¦‚æœç”¨Â <code>scoped</code>Â æ ·å¼ï¼Œéœ€ç”¨Â <code>::v-deep</code>Â æˆ–Â <code>:deep()</code>Â ç©¿é€ï¼ˆå¦‚ä¿®æ”¹ç¬¬ä¸‰æ–¹ç»„ä»¶çš„è¿‡æ¸¡æ ·å¼ï¼‰ã€‚</li>
<li><strong>ç¦ç”¨è¿‡æ¸¡</strong>ï¼šé€šè¿‡Â <code>:disabled="true"</code>Â åŠ¨æ€ç¦ç”¨è¿‡æ¸¡ï¼ˆå¦‚æŸäº›æ¡ä»¶ä¸‹ä¸éœ€è¦åŠ¨ç”»ï¼‰ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”„è®°ä½è¿™å¼ å›¾ï¼Œè„‘å­è·Ÿç€æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰è½¬èµ·æ¥äº†]]></title>    <link>https://juejin.cn/post/7577395040592756746</link>    <guid>https://juejin.cn/post/7577395040592756746</guid>    <pubDate>2025-11-28T07:01:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577395040592756746" data-draft-id="7576907627017470003" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”„è®°ä½è¿™å¼ å›¾ï¼Œè„‘å­è·Ÿç€æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰è½¬èµ·æ¥äº†"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,æµè§ˆå™¨"/> <meta itemprop="datePublished" content="2025-11-28T07:01:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="vilan_å¾®æ¾œ"/> <meta itemprop="url" content="https://juejin.cn/user/2225067267199320"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”„è®°ä½è¿™å¼ å›¾ï¼Œè„‘å­è·Ÿç€æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰è½¬èµ·æ¥äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2225067267199320/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    vilan_å¾®æ¾œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T07:01:47.000Z" title="Fri Nov 28 2025 07:01:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;position:relative;background-image:linear-gradient(90deg,rgba(217,234,251,.25) 3%,transparent 0),linear-gradient(1turn,rgba(217,234,251,.25) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;padding-left:8px;padding-bottom:0;margin-top:35px;margin-bottom:10px;font-weight:900;font-family:serif;letter-spacing:1px;color:#000}.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover{background-color:#fff}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;position:relative}.markdown-body h2:after{content:"";left:0;bottom:0;width:100%;height:1px;position:absolute}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{height:1px;border:none;margin-top:32px;margin-bottom:32px;background-size:4px 1px;background-image:linear-gradient(270deg,#37b2ff 0,#37b2ff 25%,transparent 50%)}.markdown-body code{margin:0 4px;word-break:break-word;overflow-x:auto;background-color:#fff7f7;color:#f06;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:-apple-system,system-ui,Menlo,Monaco,Consolas,Courier New;position:relative}.markdown-body pre{margin:15px 8px;border:1px solid #f5f5f7;line-height:1.75}.markdown-body pre:before{top:-4px;left:-4px;border-top:8px solid #feea1e;border-left:8px solid #feea1e}.markdown-body pre:after,.markdown-body pre:before{width:20px;height:20px;content:"";z-index:10;position:absolute}.markdown-body pre:after{right:-4px;bottom:-4px;border-right:8px solid #37b2ff;border-bottom:8px solid #37b2ff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;overflow-x:auto;margin:0;word-break:normal;display:block;color:#333;background-color:#fff;position:unset!important}.markdown-body pre:nth-child(odd):before{border-top-color:#a7ecad;border-left-color:#a7ecad}.markdown-body pre:nth-child(odd):after{border-right-color:#e699e6;border-bottom-color:#e699e6}.markdown-body a{margin:0 4px;text-decoration:none;color:#37b2ff;transition:.3s;display:inline-block;vertical-align:bottom;position:relative}.markdown-body a:before{content:"READ MORE +";bottom:90%;width:120px;max-width:0;color:#fff;background-color:#1fb3ff;position:absolute;white-space:nowrap;transition:.3s;box-sizing:border-box;pointer-events:none;overflow:hidden}.markdown-body a:after{content:"";bottom:0;left:0;width:100%;height:1px;border-bottom:1px dashed #37b2ff;position:absolute}.markdown-body a:active:before,.markdown-body a:hover:before{max-width:120px;padding-left:14px}.markdown-body table{width:100%;max-width:100%;font-size:12px;background-color:#fff;overflow:auto;border-collapse:collapse}.markdown-body table tr:hover td,.markdown-body table tr:hover th{border-bottom:1px solid #feea1e}.markdown-body thead{text-align:left}.markdown-body th{font-size:1.2em;border-bottom:1px dashed #eee}.markdown-body tr:nth-child(2n){background-color:hsla(0,0%,87.8%,.1);border-bottom:1px solid #fff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px;border-bottom:1px dashed #fff}.markdown-body blockquote{color:#666;padding:12px 23px 2px;border:1px solid #37b2ff;background-color:#fff;margin:22px 0;position:relative}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body blockquote:after{content:"FROM";left:0;width:40px;color:#fff;background-color:#37b2ff;text-align:center}.markdown-body blockquote:after,.markdown-body blockquote:before{top:0;line-height:1;padding:2px 0;font-size:12px;font-weight:lighter;position:absolute;pointer-events:none}.markdown-body blockquote:before{content:"CITATION";left:44px;color:#37b2ff}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{line-height:2em;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#37b2ff}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol ol li,.markdown-body ol ul li,.markdown-body ul ol li,.markdown-body ul ul li{border-bottom:none}.markdown-body ol li{padding-left:6px;list-style:decimal-leading-zero}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]{position:relative}.markdown-body input[type=checkbox]:before{top:0;left:0;right:0;bottom:0;content:"";width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1;position:absolute}.markdown-body input[type=checkbox]:checked:after{content:"";top:10%;left:18%;width:90%;height:40%;border-left:2px solid #37b2ff;border-bottom:2px solid #37b2ff;color:#37b2ff;z-index:2;transform:rotate(-45deg);position:absolute}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>ä¸‹é¢æŒ‰ç…§æˆ‘çš„ç†è§£ï¼Œçº¯æ‰‹å·¥ç”»äº†ä¸€å¼ åœ¨æµè§ˆå™¨æ‰§è¡Œ<code>JavaScript</code>ä»£ç çš„<code>Event Loop</code><strong>(äº‹ä»¶å¾ªç¯)</strong> æµç¨‹å›¾ã€‚</p>
<p>åæ–‡ä¼šæ¼”ç¤ºå‡ ä¸ªä¾‹å­ï¼ŒæŠŠç¤ºä¾‹ä»£ç æ”¾åˆ°è¿™ä¸ªæµç¨‹å›¾æ¼”ç¤ºå…¶æ‰§è¡Œæµç¨‹ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™åªæ˜¯ç®€å•çš„äº‹ä»¶å¾ªç¯æµç¨‹ï¼Œä¸è¿‡ï¼Œå´èƒ½è®©æˆ‘ä»¬å¿«é€ŸæŒæ¡å…¶åŸç†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c70d7b131704a5e8f612654b87bf16f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=jgkl4G8nzNGOoPmaiewPVFpjAwo%3D" alt="Event Loop.png" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€æ¦‚å¿µ</h2>
<p><strong>äº‹ä»¶å¾ªç¯</strong>æ˜¯<code>JavaScript</code>ä¸ºäº†å¤„ç†<strong>å•çº¿ç¨‹</strong>æ‰§è¡Œä»£ç æ—¶ï¼Œèƒ½<strong>å¼‚æ­¥</strong>åœ°å¤„ç†ç”¨æˆ·äº¤äº’ã€ç½‘ç»œè¯·æ±‚ç­‰ä»»åŠ¡ <strong>(å¼‚æ­¥Web API)</strong>ï¼Œè€Œè®¾è®¡çš„ä¸€å¥—<strong>ä»»åŠ¡è°ƒåº¦æœºåˆ¶</strong>ã€‚å®ƒå°±åƒä¸€ä¸ªæ°¸ä¸åœæ­¢çš„å¾ªç¯ï¼Œä¸æ–­åœ°æ£€æŸ¥ï¼ˆç»“åˆä¸Šå›¾å°±æ˜¯ä¸æ–­æ£€æŸ¥<code>Task Queue</code>å’Œ<code>Microtask Queue</code>è¿™ä¸¤ä¸ªé˜Ÿåˆ—ï¼‰å¹¶éœ€è¦è¿è¡Œçš„ä»£ç ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€ä¸ºä»€ä¹ˆéœ€è¦äº‹ä»¶å¾ªç¯</h2>
<p><code>JavaScript</code>æ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™æ„å‘³ç€å®ƒåªæœ‰ä¸€ä¸ª<strong>ä¸»çº¿ç¨‹</strong>æ¥æ‰§è¡Œä»£ç ã€‚å¦‚æœæ‰€æœ‰ä»»åŠ¡ï¼ˆæ¯”å¦‚ä¸€ä¸ªè€—æ—¶çš„è®¡ç®—ã€ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼‰éƒ½åŒæ­¥æ‰§è¡Œï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šè¢«<strong>å¡ä½</strong>ï¼Œæ— æ³•å“åº”ç”¨æˆ·çš„ç‚¹å‡»ã€è¾“å…¥ï¼Œç›´åˆ°è¿™ä¸ªä»»åŠ¡å®Œæˆã€‚è¿™ä¼šé€ æˆæå·®çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p><strong>äº‹ä»¶å¾ªç¯å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œç”Ÿçš„</strong>ï¼šå®ƒè®©è€—æ—¶çš„æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å–ï¼‰åœ¨åå°å¼‚æ­¥æ‰§è¡Œï¼Œç­‰è¿™äº›æ“ä½œå®Œæˆåï¼Œå†é€šè¿‡<strong>å›è°ƒ</strong>çš„æ–¹å¼æ¥æ‰§è¡Œç›¸åº”çš„ä»£ç ï¼Œä»è€Œ<strong>ä¸é˜»å¡ä¸»çº¿ç¨‹</strong>ã€‚</p>
<h2 data-id="heading-3">å››ã€äº‹ä»¶å¾ªç¯æµç¨‹å›¾ç”¨æ³•æ¼”ç¤º</h2>
<h3 data-id="heading-4">æ¼”ç¤ºä¸€ï¼šå°èœä¸€ç¢Ÿ</h3>
<p>å…ˆæ¥ä¸€ä¸ªéƒ½æ˜¯<strong>åŒæ­¥ä»£ç </strong>çš„å°èœï¼Œå…ˆäº†è§£ä¸€ä¸‹å‰é¢ç”»çš„æµç¨‹å›¾æ˜¯æ€æ ·åœ¨<strong>è°ƒç”¨æ ˆ</strong>å½“ä¸­æ‰§è¡Œ<code>JavaScript</code>ä»£ç çš„ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">funcOne</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">2</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">funcTwo</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">funcOne</span>()
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">3</span>)
}

<span class="hljs-title function_">funcTwo</span>()

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">4</span>)
</code></pre>
<p>æ§åˆ¶å°è¾“å‡ºï¼š</p>
<blockquote>
<p>1
2
3
4</p>
</blockquote>
<p><strong>ä¸‹å›¾ä¸ºè°ƒç”¨æ ˆæ‰§è¡Œæµç¨‹</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dd7e17c0d4142fd91b17b56197ba070~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=vYvdvhjkbyKzVGL%2BU8jJLhGU7iA%3D" alt="æ¼”ç¤º01.png" loading="lazy"/></p>
<p>æ¯æ‰§è¡Œå®Œä¸€ä¸ªåŒæ­¥ä»»åŠ¡ä¼šæŠŠè¯¥ä»»åŠ¡è¿›è¡Œ<strong>å‡ºæ ˆ</strong>ã€‚åœ¨è¿™ä¸ªä¾‹å­å½“ä¸­æ¯æ¬¡åœ¨æ§åˆ¶å°è¾“å‡ºä¸€æ¬¡ï¼Œåˆ™è¿›è¡Œä¸€æ¬¡å‡ºæ ˆå¤„ç†ï¼Œç›´è‡³å…¨éƒ¨ä»£ç æ‰§è¡Œå®Œæˆã€‚</p>
<h3 data-id="heading-5">æ¼”ç¤ºäºŒï¼šå°è¯•ç‰›åˆ€</h3>
<p><code>setTimeout</code>+<code>Promise</code>ç»„åˆæ‹³ï¼Œäº†è§£<strong>å¼‚æ­¥ä»£ç </strong>æ˜¯å¦‚ä½•è¿›å…¥ä»»åŠ¡é˜Ÿåˆ—ç­‰å¾…æ‰§è¡Œçš„ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>)

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setTimeout'</span>, <span class="hljs-number">2</span>)
}, <span class="hljs-number">0</span>)

<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'promise'</span>, <span class="hljs-number">3</span>)
  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">4</span>)
})

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setTimeout'</span>, <span class="hljs-number">5</span>)
}, <span class="hljs-number">10</span>)

promise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'then'</span>, res)
})

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">6</span>)
</code></pre>
<p>æ§åˆ¶å°è¾“å‡ºï¼š</p>
<blockquote>
<p>1
promise 3
6
then 4
setTimeout 2
setTimeout 5</p>
</blockquote>
<h4 data-id="heading-6">æµç¨‹å›¾æ‰§è¡Œ-æ­¥éª¤ä¸€ï¼š</h4>
<p>å…ˆæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œå¦‚é‡åˆ°å¼‚æ­¥ä»£ç ï¼Œåˆ™æŠŠå¼‚æ­¥å›è°ƒäº‹ä»¶æ”¾åˆ°<strong>åå°ç›‘å¬</strong>æˆ–<strong>å¯¹åº”çš„ä»»åŠ¡é˜Ÿåˆ—</strong>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7860797b046471784c977e2f034719a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=bGiSf6rPpSvuyKUS%2FbylMFjp7Ic%3D" alt="image.png" loading="lazy"/></p>
<ol>
<li>
<p>æ‰§è¡Œ<code>console.log(1)</code>ï¼Œæ§åˆ¶å°è¾“å‡º<code>1</code>ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œå®šæ—¶å™¨ï¼Œé‡åˆ°å¼‚æ­¥ä»£ç ï¼Œåå°æ³¨å†Œå®šæ—¶å™¨å›è°ƒäº‹ä»¶ï¼Œ<strong>æ—¶é—´åˆ°äº†</strong>ï¼ŒæŠŠå›è°ƒå‡½æ•°<code>() =&gt; {console.log('setTimeout', 2)}</code>ï¼Œæ”¾åˆ°å®ä»»åŠ¡é˜Ÿåˆ—ç­‰å¾…ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œåˆ›å»º<code>Promise</code>å®ä¾‹ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒæ­¥ä»£ç ï¼šæ‰§è¡Œ<code>console.log('promise', 3)</code>,æ§åˆ¶å°è¾“å‡º<code>promise 3</code>;æ‰§è¡Œ<code>resolve(4)</code>ï¼Œæ­¤æ—¶<code>Promise</code>å·²ç»ç¡®å®šä¸ºå®Œæˆ<code>fulfilled</code>çŠ¶æ€ï¼ŒæŠŠ<code>promise.then()</code>çš„å›è°ƒå‡½æ•°<strong>å“åº”å€¼</strong>è®¾ä¸º<code>4</code>ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œå®šæ—¶å™¨ï¼Œé‡åˆ°å¼‚æ­¥ä»£ç ï¼Œåå°æ³¨å†Œå®šæ—¶å™¨å›è°ƒäº‹ä»¶ï¼Œ<strong>æ—¶é—´æœªåˆ°</strong>ï¼ŒæŠŠå›è°ƒå‡½æ•°<code>() =&gt; { console.log('setTimeout', 5) }</code>æ”¾åˆ°åå°ç›‘å¬ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œ<code>promise.then(res =&gt; { console.log('then', res) })</code>ï¼Œå‡ºæ ˆèµ°å¼‚æ­¥ä»£ç ï¼ŒæŠŠå›è°ƒå‡½æ•°<code>4 =&gt; { console.log('then', 4) }</code>æ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ç­‰å¾…ã€‚</p>
</li>
</ol>
<h4 data-id="heading-7">æµç¨‹å›¾æ‰§è¡Œ-æ­¥éª¤äºŒï¼š</h4>
<p>ä¸Šé¢å·²ç»æŠŠåŒæ­¥ä»£ç æ‰§è¡Œå®Œæˆï¼Œå¹¶ä¸”æŠŠå¯¹åº”å¼‚æ­¥å›è°ƒäº‹ä»¶æ”¾åˆ°äº†<strong>æŒ‡å®šä»»åŠ¡é˜Ÿåˆ—</strong>ï¼Œæ¥ä¸‹æ¥å¼€å§‹<strong>äº‹ä»¶å¾ªç¯</strong>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f20e20de4fb471b833a85ba54543c1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=dOOzTlOzVUGs1V6Xe0VzyYWqMUE%3D" alt="image.png" loading="lazy"/></p>
<ol start="6">
<li>
<p>æ‰«æå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œ<code>4 =&gt; { console.log('then', 4) }</code>å›è°ƒå‡½æ•°ï¼Œæ§åˆ¶å°è¾“å‡º<code>then 4</code>ã€‚</p>
</li>
<li>
<p><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©º</strong>ï¼Œæ‰«æå®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œ<code>() =&gt; {console.log('setTimeout', 2)}</code>å›è°ƒå‡½æ•°ï¼Œæ§åˆ¶å°è¾“å‡º<code>setTimeout 2</code>ã€‚</p>
</li>
<li>
<p>æ¯æ‰§è¡Œå®Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œéœ€è¦å†æ¬¡æ‰«æå¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦å­˜åœ¨å¯æ‰§è¡Œä»»åŠ¡ï¼ˆå‡è®¾æ­¤æ—¶<strong>åå°å®šæ—¶åˆ°äº†</strong>ï¼Œåˆ™ä¼šæŠŠ<code>() =&gt; { console.log('setTimeout', 5) }</code>åŠ å…¥åˆ°äº†å®ä»»åŠ¡é˜Ÿåˆ—æœ«å°¾ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©º</strong>ï¼Œæ‰«æå®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œ<code>() =&gt; { console.log('setTimeout', 5) }</code>ï¼Œæ§åˆ¶å°è¾“å‡º<code>setTimeout 5</code>ã€‚</p>
</li>
</ol>
<h3 data-id="heading-8">æ¼”ç¤ºä¸‰ï¼šç¨æœ‰éš¾åº¦</h3>
<p><code>setTimeout</code>+<code>Promise</code>ç»„åˆæ‹³+<strong>å¤šå±‚åµŒå¥—</strong><code>Promise</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>)

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setTimeout'</span>, <span class="hljs-number">10</span>)
}, <span class="hljs-number">0</span>)

<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">2</span>)
  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">7</span>)

  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-number">5</span>)
  }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)

    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'åµŒå¥—ç¬¬ä¸‰å±‚ Promise'</span>)
    }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)
    })
  })

  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">6</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)
  })

}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)
})

<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">3</span>)

  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">8</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)
  })

  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">9</span>)
}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)
})

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">4</span>)
</code></pre>
<p>ä¸Šä¸€ä¸ªæ¼”ç¤ºè¯´æ˜äº†æµç¨‹å›¾æ‰§è¡Œçš„è¯¦ç»†æ­¥éª¤ï¼Œä¸‹é¢å°±ä¸å¤šåŠ èµ˜å™äº†ï¼Œç›´æ¥çœ‹å›¾ï¼</p>
<blockquote>
<p><strong><code>talk is cheap, show me the chart</code></strong></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/265bc9b93c464136b21e92a5f6ef3d1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=53UMsJN3Grprkm4MsABvpBX7%2BVI%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ä¸Šå›¾</strong>ï¼Œè°ƒç”¨æ ˆåŒæ­¥ä»£ç æ‰§è¡Œå®Œæˆï¼Œå¼€å§‹äº‹ä»¶å¾ªç¯ï¼Œå…ˆçœ‹å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå‘ç°ä¸ä¸ºç©ºï¼ŒæŒ‰é¡ºåºæ‰§è¡Œå¾®ä»»åŠ¡äº‹ä»¶ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e1dbf63c78a4aebad5d4170d212a513~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=5JSmc3SSjKRPLHrqRCAAmxwFz90%3D" alt="åµŒå¥—02.png" loading="lazy"/></p>
<p><strong>ä¸Šå›¾</strong>ï¼Œå·²ç»æŠŠåˆšæ‰æ’é˜Ÿçš„å¾®ä»»åŠ¡é˜Ÿåˆ—<strong>å…¨éƒ¨æ¸…ç©º</strong>äº†ã€‚ä½†æ˜¯åœ¨æ‰§è¡Œç¬¬ä¸€ä¸ªå¾®ä»»åŠ¡æ—¶ï¼Œå‘ç°è¿˜æœ‰åµŒå¥—å¾®ä»»åŠ¡ï¼Œåˆ™æŠŠè¯¥ä»»åŠ¡æ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—æœ«å°¾ï¼Œç„¶åæ¥ç€<strong>ä¸€èµ·æ‰§è¡Œå®Œæ‰€æœ‰æ–°å¢ä»»åŠ¡</strong>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/498ce569f01e40d2b83ae74219f866b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=4JzJpXsTLXT%2FIupd1tNthB78INY%3D" alt="åµŒå¥—03.png" loading="lazy"/></p>
<p>æœ€åå¾®ä»»åŠ¡æ¸…ç©ºåï¼Œæ¥ç€æ‰§è¡Œå®ä»»åŠ¡ã€‚åˆ°æ­¤å…¨éƒ¨äº‹ä»¶å·²æ‰§è¡Œå®Œæ¯•ï¼</p>
<p>æ§åˆ¶å°å®Œæ•´è¾“å‡ºé¡ºåºï¼š</p>
<blockquote>
<p>1
2
3
4
5
6
7
8
9
10</p>
</blockquote>
<h3 data-id="heading-9">æ¼”ç¤ºå››ï¼šsetTimeoutä¼ªå®šæ—¶</h3>
<p><strong>setTimeout</strong>å¹¶ä¸æ˜¯è®¾ç½®çš„å®šæ—¶åˆ°äº†å°±é©¬ä¸Šæ‰§è¡Œï¼Œè€Œæ˜¯æŠŠå®šæ—¶å›è°ƒæ”¾åœ¨<code>task queue</code>ä»»åŠ¡é˜Ÿåˆ—å½“ä¸­è¿›è¡Œç­‰å¾…ï¼Œå¾…ä¸»çº¿ç¨‹<strong>è°ƒç”¨æ ˆ</strong>ä¸­çš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæˆåç©ºé—²æ—¶æ‰ä¼šæ‰§è¡Œã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setTimeout cost time'</span>, endTime - startTime)
  <span class="hljs-comment">// setTimeout cost time 2314</span>
}, <span class="hljs-number">100</span>)

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">300000</span>; i++) {
  <span class="hljs-comment">// æ¨¡æ‹Ÿæ‰§è¡Œè€—æ—¶åŒæ­¥ä»»åŠ¡</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i)
}
</code></pre>
<p>æ§åˆ¶å°è¾“å‡ºï¼š</p>
<blockquote>
<p>1
2
3
Â·Â·Â·
300000
setTimeout cost time 2314</p>
</blockquote>
<p>ä¸‹å›¾æ¼”ç¤ºäº†å…¶æ‰§è¡Œæµç¨‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c2096d1a85c4553b26d3b2473cfeb93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=GDoOJZEAGZSUVcqqUCHE2pW3dnE%3D" alt="setTimeoutå‡å»¶æ—¶.png" loading="lazy"/></p>
<h3 data-id="heading-10">æ¼”ç¤ºäº”ï¼šfetchç½‘ç»œè¯·æ±‚å’ŒsetTimeout</h3>
<p>è·å–ç½‘ç»œæ•°æ®ï¼Œ<code>fetch</code>å›è°ƒå‡½æ•°å±äº<strong>å¾®ä»»åŠ¡</strong>ï¼Œä¼˜äº<code>setTimeout</code>å…ˆæ‰§è¡Œã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setTimeout'</span>, <span class="hljs-number">2</span>)
}, <span class="hljs-number">510</span>)

<span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'http://localhost:3000/test'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'fetch cost time'</span>, endTime - startTime)
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>()
}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'data'</span>, data)
})
</code></pre>
<p>ä¸‹å›¾å½“å‰<strong>Call Stackæ‰§è¡Œæ ˆ</strong>æ‰§è¡Œå®ŒåŒæ­¥ä»£ç åï¼Œç”±äº<code>fetch</code>å’Œ<code>setTimeout</code>éƒ½æ˜¯å®ä»»åŠ¡ï¼Œæ‰€ä»¥èµ°<strong>å®ä»»åŠ¡Web API</strong>æµç¨‹åæ³¨å†Œè¿™ä¸¤ä¸ªäº‹ä»¶å›è°ƒï¼Œç­‰å¾…å®šæ—¶åˆ°åäº†ï¼Œç”±äºå®šæ—¶å›è°ƒæ˜¯ä¸ªæ™®é€šçš„åŒæ­¥å‡½æ•°ï¼Œæ‰€ä»¥æ”¾åˆ°å®ä»»åŠ¡é˜Ÿåˆ—ï¼›ç­‰å¾…<code>fetch</code>æ‹¿åˆ°æœåŠ¡å™¨å“åº”æ•°æ®åï¼Œç”±äº<code>fetch</code>å›è°ƒä¸ºä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œæ‰€ä»¥æ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb0c09c4c20544848cb70379273cf994~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=QjOR7jfpeob%2B4JQWvDOiTknR6aQ%3D" alt="fetch.png" loading="lazy"/></p>
<p>ç»è¿‡å¤šç•ªåˆ·æ–°ç½‘é¡µæµ‹è¯•ï¼Œä¸‹å›¾æ§åˆ¶å°æ‰“å°å±•ç¤ºäº†<code>setTimeout</code>å»¶æ—¶ä¸º<strong>510ms</strong>ï¼Œ<code>fetch</code>è¯·æ±‚å“åº”åŒæ ·æ˜¯<strong>510ms</strong>çš„æƒ…å†µä¸‹ï¼Œ<code>.then(data =&gt; { console.log('data', data) })</code>å…ˆæ‰§è¡Œäº†ï¼Œä¹Ÿæ˜¯ç”±äº<code>fetch</code>åŸºäº<code>Promise</code>å®ç°ï¼Œæ‰€ä»¥å…¶å›è°ƒä¸ºå¾®ä»»åŠ¡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7319404807824f8180aa9da17457505f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmlsYW5f5b6u5r6c:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764918107&amp;x-signature=0DuaULN5WRnMzLDFja8nwvNMdyk%3D" alt="b475cbb38b0161d3e7f5f97b45824b31.png" loading="lazy"/></p>
<h2 data-id="heading-11">äº”ã€ç»“è¯­</h2>
<p>è¿™å¯èƒ½åªæ˜¯ç®€å•çš„<code>JavaScript</code>ä»£ç æ‰§è¡Œäº‹ä»¶å¾ªç¯æµç¨‹ï¼Œç›®çš„ä¹Ÿæ˜¯è®©å¤§å®¶æ›´ç›´è§‚ç†è§£å…¶ä¸­åŸç†ã€‚å®é™…æ‰§è¡Œè¿‡ç¨‹å¯èƒ½è¿˜ä¼šè¯»å–<strong>å †å†…å­˜</strong>è·å–å¼•ç”¨ç±»å‹æ•°æ®ã€æ“ä½œ<code>dom</code>çš„æ–¹æ³•ï¼Œå¯èƒ½è¿˜ä¼šè§¦å‘é¡µé¢çš„<strong>é‡æ’ã€é‡ç»˜</strong>ç­‰è¿‡ç¨‹ã€å¼‚æ­¥æ–‡ä»¶è¯»å–å’Œå†™å…¥æ“ä½œã€<code>fetch</code>å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥è·å–ç½‘ç»œæ•°æ®ç­‰æƒ…å†µã€‚</p>
<p><strong>ä½†æ˜¯</strong>ï¼Œå®ƒä»¬<strong>å¼‚æ­¥</strong>æ‰§è¡Œçš„<strong>å›è°ƒå‡½æ•°</strong>éƒ½ä¼šç»è¿‡<strong>å›¾ä¸­</strong>çš„è¿™ä¸ª<strong>äº‹ä»¶å¾ªç¯</strong>è¿‡ç¨‹ï¼Œä»è€Œæ„æˆå®Œæ•´çš„æµè§ˆå™¨äº‹ä»¶å¾ªç¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡ææ‡‚ LLM çš„ Transformerï¼çœ‹å®Œèƒ½å’Œåˆ«äººå¹ä¸€å¹´]]></title>    <link>https://juejin.cn/post/7577313637951094793</link>    <guid>https://juejin.cn/post/7577313637951094793</guid>    <pubDate>2025-11-28T03:26:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577313637951094793" data-draft-id="7577295460249354286" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡ææ‡‚ LLM çš„ Transformerï¼çœ‹å®Œèƒ½å’Œåˆ«äººå¹ä¸€å¹´"/> <meta itemprop="keywords" content="LLM,Agent,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-11-28T03:26:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡ææ‡‚ LLM çš„ Transformerï¼çœ‹å®Œèƒ½å’Œåˆ«äººå¹ä¸€å¹´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T03:26:56.000Z" title="Fri Nov 28 2025 03:26:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>å¦‚æœä½ æƒ³å¯¹å½“ä¸‹ AI LLM(å¤§è¯­è¨€æ¨¡å‹) çš„å·¥ä½œåŸç†æœ‰æ‰€äº†è§£ï¼Œæ­å¼€ ChatGPTã€DeepSeek èƒŒåçš„ç§˜å¯†ï¼Œé‚£ä¸€å®šè¦è®¤è¯†ä¸€ä¸‹æœ¬æ–‡çš„ä¸»è§’ Transformerã€‚</p>
<p>å½“æèµ· Transformer è¿™ä¸ªè¯é¢˜æ—¶ï¼Œä»¿ä½›äººäººéƒ½å¯ä»¥è®²äº›ç›¸å…³åè¯å‡ºæ¥ï¼Œä»€ä¹ˆè‡ªæ³¨æ„åŠ›æœºåˆ¶å•Šã€encoderã€decoderä»€ä¹ˆçš„ï¼Œä½†è‹¥æ·±å…¥è¿½é—®ç»†èŠ‚ï¼Œå´å¾ˆå°‘æœ‰äººèƒ½çœŸæ­£åœ°è¯´æ¸…æ¥šã€‚</p>
<p>å®ƒæœ€åˆæ¥è‡ªä¸€ç¯‡è¢«ç§°ä¸ºâ€œAI å¤§èˆªæµ·æ—¶ä»£èµ·ç‚¹â€çš„è®ºæ–‡ï¼š</p>
<ul>
<li>Attention is All You Need</li>
</ul>
<p>è¿™ç¯‡è®ºæ–‡é¦–æ¬¡æå‡ºçš„ Transformer æ¶æ„ï¼Œå·²ç»æˆä¸ºå½“ä¸‹æ‰€æœ‰å¤§æ¨¡å‹çš„åŸºç¡€ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬å°±ä»è¿™ç¯‡æœ€åˆçš„è®ºæ–‡å‡ºå‘ï¼ŒçœŸæ­£ç†è§£ä¸‹ Transformer ç©¶ç«Ÿæ˜¯ä½•æ–¹ç¥åœ£ã€‚</p>
<p>æœ¬æ–‡ä¸è®¨è®ºå…¬å¼ï¼Œåªè§£è¯»å›¾è¡¨ï¼Œæ—¨åœ¨è®©æ›´å¤šè¯»è€…çœ‹å®Œå°±èƒ½é€šä¿—åœ°ã€æˆä½“ç³»åœ°ç»™èº«è¾¹å…¶ä»–äººè®²æ¸…æ¥š Transformer å·¥ä½œåŸç†ï¼Œä»è€ŒçœŸæ­£ç†è§£å®ƒç©¶ç«Ÿä¸ºä»€ä¹ˆå¦‚æ­¤ç«çˆ†ã€‚</p>
<p>é¦–å…ˆï¼Œå…ˆå¼•ç”¨è¿™ç¯‡è®ºæ–‡ä¸­çš„å…³äº Transformer è¿™ä¸ªæ¨¡å‹çš„æ•´ä½“æ¶æ„å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d0e659f6ad9423fa0febadf1eeba61e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764905215&amp;x-signature=EKhlXxnUN%2Bp%2Bc9jagsfIwzjuKMg%3D" alt="" loading="lazy"/></p>
<p>ä¸Šæ¥ç›´æ¥å°±çœ‹æ¶æ„å›¾æ˜¯ä¸æ˜¯æœ‰äº›æ™•ï¼Ÿ</p>
<p>æ²¡å…³ç³»ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥ä¸€æ­¥æ­¥é€šä¿—ç†è§£ä¸‹è¿™å¼ æ¶æ„å›¾çš„æ·±å±‚å«ä¹‰ã€‚</p>
<p>å›¾çš„å·¦è¾¹ä¸€ä¾§Inputï¼ˆè¾“å…¥ï¼‰ï¼Œæ•´ä½“ä»£è¡¨Encoderï¼›å³è¾¹ä¸€ä¾§Outputï¼ˆè¾“å‡ºï¼‰ï¼Œæ•´ä½“ä»£è¡¨Decoderã€‚</p>
<h2 data-id="heading-0">01ï½œè¾“å…¥æ˜¯æ€ä¹ˆè¢« Transformerâ€œçœ‹æ‡‚â€çš„ï¼Ÿ</h2>
<p>æ•´ä¸ªè¾“å…¥æµç¨‹ä½ åªéœ€è¦å…ˆè®°ä½ä¸‹é¢çš„å…³é”®æµç¨‹ï¼š</p>
<blockquote>
<p>è¯ â†’ å‘é‡ â†’ åŠ ä½ç½® â†’ Q/K/V â†’ æ³¨æ„åŠ› â†’ FFN â†’ è¾“å‡º</p>
</blockquote>
<p>ç„¶åæˆ‘ä»¬æ¥ä¸€ç‚¹ä¸€ç‚¹çœ‹ã€‚</p>
<h3 data-id="heading-1">â‘  Input Embeddingï¼šæŠŠè¯å˜æˆæ•°å­—å‘é‡</h3>
<p>æ¨¡å‹ä¸è®¤è¯†â€œæˆ‘â€ã€â€œä½ â€ã€â€œçŒ«â€è¿™äº›è¯ï¼Œåªèƒ½æ¥å—æ•°å­—ã€‚</p>
<p>æ‰€ä»¥ï¼Œéœ€è¦æŠŠæ¯ä¸ªè¯è½¬æ¢æˆä¸€ä¸ªå‘é‡ï¼Œä¹Ÿå°±æ˜¯ä¸€ç»„æ•°å­—ï¼Œä¾‹å¦‚ï¼š</p>
<blockquote>
<p>æˆ‘ â†’ [0.12, -0.88, 0.43, ...]</p>
</blockquote>
<p>è¿™é‡Œç®€åŒ–äº†ç²¾åº¦æ–¹ä¾¿é˜…è¯»ï¼Œå‘é‡åŒ–è¿™ä¸€æ­¥éå¸¸åŸºç¡€ï¼Œä½†ä¹Ÿæ˜¯ç†è§£åé¢ä¸€åˆ‡çš„èµ·ç‚¹ã€‚</p>
<h3 data-id="heading-2">â‘¡ Positional Encodingï¼šç»™æ¨¡å‹è£…ä¸Šâ€œä½ç½®æ„Ÿâ€</h3>
<p>Transformer æ²¡æœ‰åƒä¼ ç»Ÿ RNN é‚£æ ·æŒ‰é¡ºåºé€è¯å¤„ç†è¾“å…¥ï¼Œå› æ­¤æ¨¡å‹æœ¬èº«æ— æ³•â€œå¤©ç„¶â€æ„ŸçŸ¥è¯çš„å…ˆåå…³ç³»ã€‚</p>
<p>æ‰€ä»¥éœ€è¦é¢å¤–å‘Šè¯‰æ¨¡å‹ï¼š</p>
<blockquote>
<p>â€œè¿™æ˜¯ç¬¬ 1 ä¸ªè¯ï¼Œè¿™æ˜¯ç¬¬ 2 ä¸ªè¯â€¦â€¦â€</p>
</blockquote>
<p>è®ºæ–‡ä½¿ç”¨äº† sin + cos å‡½æ•°è®¡ç®—çš„ä½ç½®ç¼–ç æ–¹å¼ï¼Œè®©æ¯ä¸ªè¯æ¸…æ¥šè‡ªå·±çš„â€œä½ç½®â€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80ce180e16a34c39b4697eb5169f3c27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764905215&amp;x-signature=WifRNE6CM3ZdeuJkcbOKkJiZ9qg%3D" alt="" loading="lazy"/></p>
<p>sin/cos ä½ç½®ç¼–ç ä¹ä¸€çœ‹æœ‰ç‚¹æ•°å­¦å‘³ï¼Œä½†å¯¹æ¨¡å‹æ¥è¯´æ˜¯éå¸¸ç®€å•é«˜æ•ˆçš„ã€‚</p>
<p>å®ƒåƒç»™æ¯ä¸ªä½ç½®è´´ä¸Šä¸€æ®µç‹¬ä¸€æ— äºŒçš„â€œèŠ‚å¥æ ‡ç­¾â€ï¼Œè®© Transformer èƒ½åˆ†è¾¨è¯çš„â€œä½ç½®â€ï¼ŒåŒæ—¶åˆä¸éœ€è¦å¤šä½™çš„è®­ç»ƒæˆæœ¬ã€‚</p>
<h3 data-id="heading-3">â‘¢ Q / K / Vï¼šSelf-Attention çš„çµé­‚</h3>
<p>è¿™æ˜¯æœ€è®©äººæ‹æ¡ˆå«ç»çš„è®¾è®¡ä¹‹ä¸€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72a679bc85e645989f46f6281a7d05ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764905215&amp;x-signature=RfX2J9867PjtXxcgxh%2BNOcGYwrU%3D" alt="" loading="lazy"/></p>
<p>å¥å­ä¸­çš„æ¯ä¸ªè¯éƒ½ä¼šç”Ÿæˆ 3 ä¸ªå‘é‡ï¼š</p>
<ul>
<li>Qï¼ˆQueryï¼‰æˆ‘æƒ³æ‰¾ä»€ä¹ˆï¼Ÿ</li>
<li>Kï¼ˆKeyï¼‰æˆ‘æ˜¯è°ï¼Ÿæˆ‘æœ‰ä»€ä¹ˆç‰¹å¾ï¼Ÿ</li>
<li>Vï¼ˆValueï¼‰æˆ‘çš„å®é™…å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<p>å®ƒä»¬ä¸æ˜¯æ¦‚å¿µï¼Œè€Œæ˜¯å®å®åœ¨åœ¨çš„çŸ©é˜µä¹˜æ³•ç»“æœã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå¥å­é‡Œçš„æ¯ä¸ªè¯éƒ½ä¼šï¼š</p>
<p>æ‹¿ç€è‡ªå·±çš„ Q åˆ°å…¶ä»–è¯çš„ K é‚£é‡Œå»â€œæ‰“åˆ†â€ï¼Œé—®ï¼š<br/>
â€œä½ è·Ÿæˆ‘æœ‰å¤šç›¸å…³ï¼Ÿâ€</p>
<p>æ‰“åˆ†è¶Šé«˜ï¼Œå°±è¶Šå…³æ³¨è¿™ä¸ªè¯ã€‚</p>
<p>æœ€åå¯¹ V è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°â€œæ–°å«ä¹‰â€ã€‚</p>
<p>è¿™å°±æ˜¯å•ä¸€çš„ Self-Attentionã€‚</p>
<h2 data-id="heading-4">02ï½œä¸ºä»€ä¹ˆéœ€è¦ Multi-Head Attentionï¼Ÿ</h2>
<p>æœ‰äº†å•ä¸€çš„ Self-Attentionï¼Œä¸ºå•¥åˆéœ€è¦ Multi-Head Attention å‘¢ï¼Ÿ</p>
<p>å› ä¸ºæˆ‘ä»¬éœ€è¦ä»å¤šä¸ªè§’åº¦æ¥ç†è§£è‡ªç„¶è¯­è¨€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80324c3c8422473395f809aca69b428f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764905215&amp;x-signature=Vls8Iwf%2BpyczmGx0FQ%2BEwGL9d20%3D" alt="" loading="lazy"/></p>
<p>æ³¨æ„åŠ›å¤´çš„æ•°é‡æ˜¯ä¸€ä¸ªè¶…å‚ï¼ˆHyperparameterï¼‰ï¼Œæ¯ä¸ªæ³¨æ„åŠ›å¤´å¯ä»¥å…³æ³¨ä¸åŒçš„è§†è§’ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>æœ‰äº›å¤´ä¸“æ³¨äºä¸»è°“å…³ç³»</li>
<li>æœ‰äº›å¤´æ•æ‰ä»£è¯æŒ‡ä»£</li>
<li>æœ‰äº›å¤´çœ‹å¥å­æƒ…æ„Ÿ</li>
<li>æœ‰äº›å¤´çœ‹åè¯çŸ­è¯­è¾¹ç•Œ</li>
<li>æœ‰äº›å¤´çœ‹é•¿è·ç¦»ä¾èµ–</li>
<li>æœ‰äº›å¤´æ•æ‰å¥æ³•æ ‘ç»“æ„</li>
<li>...</li>
</ul>
<p>Transformer ä¸æ˜¯åªçœ‹ä¸€ä¸ªè§’åº¦ï¼Œè®ºæ–‡ä¸­çš„ä¾‹å­æ˜¯å¹¶è¡Œå¼€ 8 ä¸ªæ³¨æ„åŠ›å¤´ã€‚</p>
<p>å®é™…å¯ä»¥å¼€12 ä¸ªã€48 ä¸ªç”šè‡³æ›´å¤šçš„æ³¨æ„åŠ›å¤´ï¼Œä»æ›´å¤šè§†è§’æ‰«æå¥å­ã€‚</p>
<p>ä¸‹å›¾æ˜¯è®ºæ–‡æœ€åç»™å‡ºçš„ä¸€ä¸ªç®€å•ç¤ºä¾‹ï¼Œæè¿°äº†é’ˆå¯¹åŒä¸€æ®µæ–‡å­—ï¼Œä¸¤ä¸ªä¸åŒçš„æ³¨æ„åŠ›å¤´æ‰€å±•ç°å‡ºçš„å„è‡ªå…³ç³»ï¼Œå¯ä»¥çœ‹åˆ°ç¡®å®å­˜åœ¨æ˜æ˜¾åŒºåˆ«ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7ba077f0d37b45b18c5bafe7821b687d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764905215&amp;x-signature=dNuxziI2cXLbZHUQgXVY%2BU823pI%3D" alt="" loading="lazy"/></p>
<p>è¿™å°±æ˜¯ Multi-Head Attention çš„ç›´è§‚ä½“ç°ã€‚</p>
<h2 data-id="heading-5">03ï½œæ®‹å·®è¿æ¥ + LayerNormï¼šè®©è®­ç»ƒæ›´ç¨³å®š</h2>
<p>Self-Attention åªæ˜¯â€œåŠ å·¥â€äº†ä¸€éè¯å‘é‡ï¼Œä½†æˆ‘ä»¬è‚¯å®šè¿˜ä¸èƒ½ä¸¢æ‰åŸå§‹ä¿¡æ¯ã€‚</p>
<p>äºæ˜¯ï¼š</p>
<p>åŸå§‹è¾“å…¥ + æ³¨æ„åŠ›ç»“æœ â†’ åš LayerNorm å½’ä¸€åŒ–ï¼ˆå¯¹åº”æ¶æ„å›¾ä¸­ Add &amp; Normï¼‰</p>
<p>è¿™ä¸ªæ®‹å·®ç»“æ„è®©è®­ç»ƒç¨³å®šå¾—å¤šï¼Œä¹Ÿèƒ½å †æ›´å¤šå±‚ã€‚</p>
<h2 data-id="heading-6">04ï½œFeed Forward ç½‘ç»œï¼ˆFFNï¼‰ï¼šè¿›ä¸€æ­¥åŠ å·¥è¯­ä¹‰</h2>
<p>Attentionå±‚è´Ÿè´£å¹¿æ’’ç½‘ï¼ŒæŠŠç›¸å…³ä¿¡æ¯æœé›†åˆ°ä¸€èµ·ï¼›</p>
<p>FFNåˆ™è´Ÿè´£æ·±åŠ å·¥ï¼Œå¯¹è¿™ä¸ªä¿¡æ¯è¿›è¡Œæ›´å¤æ‚ã€æ›´æ·±åº¦çš„éçº¿æ€§å˜æ¢ã€‚</p>
<p>åˆæ™•äº†ï¼Ÿå…¶å®é€šä¿—æ¥è®²å°±æ˜¯ï¼šAttention è´Ÿè´£æ‰¾å…³ç³»ï¼ŒFFN è´Ÿè´£æå‡è¡¨è¾¾åŠ›ã€‚</p>
<p>è®ºæ–‡ä¸­æè¿°FFNçš„å…³é”®å†…å®¹å‚è€ƒå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd92d3744ade438496edc3909f78608a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764905215&amp;x-signature=hJ7L%2BcBUoxZqokWjnDenyq4GyYs%3D" alt="" loading="lazy"/></p>
<p>ç®€å•ç†è§£å®ƒå°±æ˜¯ä¸€ä¸ªéå¸¸æœ´ç´ çš„ä¸¤å±‚å…¨è¿æ¥ç½‘ç»œï¼š</p>
<blockquote>
<p>Linear â†’ ReLU â†’ Linear</p>
</blockquote>
<p>FFN çš„ç»“æœæ˜¯ï¼šè®©æ¯ä¸ª token å¾—åˆ°æ›´ä¸°å¯Œã€æ›´æŠ½è±¡çš„ç‰¹å¾è¡¨è¾¾ï¼Œè¿™æ ·æ¨¡å‹æ‰èƒ½è¡¨è¾¾æ›´å¤æ‚çš„æ¨¡å¼ï¼Œè€Œä¸ä»…ä»…æ˜¯åšç®€å•çš„çº¿æ€§ç»„åˆã€‚</p>
<h2 data-id="heading-7">05ï½œé‡å¤ N æ¬¡ï¼šè®ºæ–‡æ˜¯ 6 å±‚ï¼Œå¯ä»¥åŠ æ›´å¤š</h2>
<p>è®ºæ–‡é‡Œ EncoderÂ <code>Nx</code>Â è¿™é‡Œæ˜¯å †äº† 6 å±‚ã€‚</p>
<p>ä½†è¿™å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ª è¶…å‚ï¼ˆHyperparameterï¼‰ã€‚</p>
<p>åæ¥çš„ BERTã€GPTã€Llama éƒ½å †åˆ°äº†å‡ åå±‚ç”šè‡³ä¸Šç™¾å±‚ã€‚</p>
<p>ä¸€èˆ¬æ¥è®²ï¼Œå±‚æ•°è¶Šå¤šã€æ¨¡å‹è¶Šå¤§ã€ç†è§£åŠ›è¶Šå¼ºã€‚</p>
<p>è¿™å…¶å®ä¹Ÿæ˜¯æ¨¡å‹è®­ç»ƒå †GPUèƒ½â€œå¤§åŠ›å‡ºå¥‡è¿¹â€çš„ç†è®ºåŸºç¡€ã€‚</p>
<h2 data-id="heading-8">06ï½œDecoder å¦‚ä½•åƒäººä¸€æ ·â€œè¾“å‡ºâ€å†…å®¹ï¼Ÿ</h2>
<p>Decoderæ˜¯æ¨¡å‹çš„â€œå†™ä½œå™¨â€ï¼Œå…¶å·¥ä½œä¸¥æ ¼éµå¾ªæ¶æ„å›¾å³ä¾§æµç¨‹ï¼Œæ ¸å¿ƒæ˜¯ â€œä»å·¦åˆ°å³ï¼Œé€è¯ç”Ÿæˆâ€ã€‚</p>
<p>ä¸ºäº†ç†è§£è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬ä»¥ç¿»è¯‘ä»»åŠ¡ä¸ºä¾‹ï¼šè¾“å…¥ "I Love You"ï¼Œè¾“å‡º "æˆ‘çˆ±ä½ "ã€‚</p>
<h3 data-id="heading-9">â‘  Output Embeddingï¼šå…ˆæŠŠè¾“å‡ºè¯å˜å‘é‡</h3>
<p>ç†è§£æ–¹å¼å’Œè¾“å…¥ä¸€æ ·ï¼Œæ¯ä¸ªè¯è¢«æ˜ å°„æˆä¸€ä¸ªå‘é‡ï¼Œç”¨äºåç»­è®¡ç®—ã€‚</p>
<h3 data-id="heading-10">â‘¡ Shifted Rightï¼šé˜²æ­¢æ¨¡å‹â€œå·çœ‹ç­”æ¡ˆâ€</h3>
<p>åœ¨æ¨¡å‹è®­ç»ƒé˜¶æ®µï¼Œéœ€è¦æŠŠæ ‡å‡†ç­”æ¡ˆæ•´ä½“å³ç§»ä¸€ä½ï¼Œå¹¶åœ¨å¼€å¤´åŠ ä¸Šèµ·å§‹ç¬¦Â ï¼Œç›¸å½“äºç»™æ¨¡å‹åšä¸€ä¸ªå¡«ç©ºé¢˜ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">	é¢˜ç›®: &lt;start&gt; æˆ‘ çˆ±
</span></code></pre>
<p>æ­¤æ—¶æ¨¡å‹çœ‹åˆ°çš„æ˜¯ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">	&lt;start&gt; æˆ‘ çˆ±
</span></code></pre>
<p>ä¹Ÿå°±æ˜¯å³ç§»ä¸€æ ¼ã€‚</p>
<h3 data-id="heading-11">â‘¢ Masked Multi-Head Attentionï¼šé®ä½æœªæ¥</h3>
<p>æœ‰åŒå­¦è¯´äº†ï¼Œä¸Šé¢å‘å³ç§»ä¸€ä½æ²¡å•¥æ„ä¹‰å‘€ï¼Œæ¨¡å‹è¿˜æ˜¯å¯ä»¥çœ‹åˆ°ç­”æ¡ˆçš„ä¸€éƒ¨åˆ†ï¼Œç›´æ¥æŠ„å°±å¯ä»¥å•Šï¼Œèµ·ä¸åˆ°è®­ç»ƒæ•ˆæœã€‚</p>
<p>æ­¤æ—¶å°±éœ€è¦Â <code>Masked Multi-Head Attention</code>Â åŠŸèƒ½æ¥é®ä½æœªé¢„æµ‹çš„è¯ï¼Œé˜²æ­¢æ¨¡å‹ä»æœªæ¥æŠ„ç­”æ¡ˆã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´å®ƒå’Œä¸Šé¢çš„Â <code>Shifted Right</code>Â ååŒå·¥ä½œï¼Œå…±åŒç¡®ä¿äº†æ¨¡å‹æ— æ³•â€œå·çœ‹ç­”æ¡ˆâ€ã€‚</p>
<p>æ¯”å¦‚æ¨¡å‹è¦å¼€å§‹åšè¿™å¼ å¡«ç©ºå·äº†ã€‚å®ƒéœ€è¦ä¾æ¬¡å¡«å‡ºä¸‰ä¸ªç©ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">	ç¬¬ä¸€ä¸ªç©ºï¼šé¢˜ç›®æ˜¯ &lt;start&gt; ______
</span>
<span class="hljs-code">	 
</span>
<span class="hljs-code">	ç¬¬äºŒä¸ªç©ºï¼šé¢˜ç›®æ˜¯ &lt;start&gt; æˆ‘ ______
</span>
<span class="hljs-code">	 
</span>
<span class="hljs-code">	ç¬¬ä¸‰ä¸ªç©ºï¼šé¢˜ç›®æ˜¯ &lt;start&gt; æˆ‘ çˆ± ______
</span>
<span class="hljs-code">	
</span></code></pre>
<h3 data-id="heading-12">â‘£ Multi-Head Attention- â€œè¯·æ•™Encoderâ€</h3>
<p>Decoder åœ¨ç”Ÿæˆæ–°è¯æ—¶ï¼Œéœ€è¦å‚è€ƒ Encoder çš„è¾“å‡ºã€‚è¿™å±‚ Attention æ˜¯æ¡¥æ¢ï¼Œè¿æ¥è¾“å…¥å’Œè¾“å‡ºï¼Œè®© Decoder å¯ä»¥â€œè¯·æ•™ Encoderâ€ï¼š</p>
<p>â€œä½ ç”Ÿæˆçš„è¯å’Œè¾“å…¥åºåˆ—çš„å“ªäº›éƒ¨åˆ†ç›¸å…³ï¼Ÿâ€</p>
<p>ä¾‹å¦‚ç¿»è¯‘ "I Love You"ï¼š</p>
<ul>
<li>ç”Ÿæˆ "æˆ‘" æ—¶ï¼Œå¯èƒ½ä¸»è¦å…³æ³¨è¾“å…¥çš„ "I"</li>
<li>ç”Ÿæˆ "çˆ±" æ—¶ï¼Œå¯èƒ½ä¸»è¦å…³æ³¨è¾“å…¥çš„ "Love"</li>
<li>ç”Ÿæˆ "ä½ " æ—¶ï¼Œå¯èƒ½ä¸»è¦å…³æ³¨è¾“å…¥çš„ "You"</li>
</ul>
<h3 data-id="heading-13">â‘¤ Linear + Softmaxï¼šå¾—åˆ°ä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡</h3>
<p>æ¯”å¦‚å·²ç»ç”Ÿæˆäº†â€œæˆ‘çˆ±â€ï¼Œåé¢è¿™ä¸ªå­—æ˜¯å•¥ï¼Œä¼šæœ‰ç±»ä¼¼è¿™æ ·çš„ä¸€ç»„æ¦‚ç‡ï¼š</p>
<blockquote>
<p>ä½ ï¼š71%<br/>
ä»–ï¼š16%<br/>
å®ƒï¼š11%<br/>
å…¶å®ƒï¼š2%</p>
</blockquote>
<p>é€‰æ¦‚ç‡æœ€é«˜çš„ï¼Œå°±æ˜¯ä¸‹ä¸€ä¸ªè¦ç”Ÿæˆçš„è¯ã€‚</p>
<h2 data-id="heading-14">æœ€ç»ˆæ€»ç»“</h2>
<p>é€šè¿‡æœ¬æ–‡çš„è®²è§£ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥æ‹†è§£äº†Transformerçš„æ ¸å¿ƒæœºåˆ¶ï¼šä»è¯å‘é‡åŒ–ä¸ä½ç½®ç¼–ç å¥ å®šåŸºç¡€ï¼Œåˆ°Self-Attentionä¸Multi-Head Attentionå®ç°å¤šè§†è§’çš„è¯­ä¹‰æ•æ‰ï¼Œå†é€šè¿‡æ®‹å·®è¿æ¥ä¸LayerNormä¿éšœè®­ç»ƒçš„ç¨³å®šæ€§ï¼Œæœ€åç”±FFNè¿›è¡Œæ·±åº¦éçº¿æ€§å˜æ¢ä»¥å¢å¼ºç‰¹å¾è¡¨è¾¾ã€‚</p>
<p>Encoderé€šè¿‡å †å Nä¸ªç›¸åŒçš„å±‚æ¥é€æ­¥æ·±åŒ–å¯¹è¾“å…¥çš„ç†è§£ï¼›Decoderçš„æ¯ä¸ªå±‚åˆ™ä¸¥æ ¼éµå¾ªä¸€ä¸ªæ›´å¤æ‚çš„å¤„ç†æµç¨‹ï¼š</p>
<p>åœ¨Masked Multi-Head Attentionä¸­ç¡®ä¿ç”Ÿæˆæ—¶ä¸ä¼šâ€œå·çœ‹â€æœªæ¥ï¼Œå¹¶ç»è¿‡Add &amp; Normã€‚</p>
<p>åœ¨Multi-Head Attentionï¼ˆå³è®ºæ–‡ä¸­çš„Encoder-Decoder Attentionå±‚ï¼‰ä¸­â€œè¯·æ•™â€Encoderçš„æœ€ç»ˆè¾“å‡ºï¼Œå¹¶å†æ¬¡ç»è¿‡Add &amp; Normã€‚</p>
<p>åŒæ ·é€šè¿‡ä¸€ä¸ªFFNç½‘ç»œè¿›è¡Œæ·±åº¦åŠ å·¥ï¼Œå¹¶æœ€ç»ˆç»è¿‡Add &amp; Normåè¾“å‡ºç»™ä¸‹ä¸€å±‚æˆ–æœ€ç»ˆçš„é¢„æµ‹æ¨¡å—ã€‚</p>
<p>æœ€ç»ˆï¼ŒDecoderçš„è¾“å‡ºç»ç”±Linear+Softmaxå±‚è½¬æ¢ä¸ºä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒã€‚Transformerå‡­å€Ÿè¿™ä¸€é«˜åº¦å¹¶è¡Œã€å¯æ‰©å±•çš„å¯¹ç§°æ€§è®¾è®¡ï¼ˆEncoderä¸Decoderå±‚å…·æœ‰ç›¸ä¼¼çš„æ ¸å¿ƒç»“æ„ï¼‰ï¼Œæˆä¸ºå½“ä»Šæ‰€æœ‰å¤§è¯­è¨€æ¨¡å‹çš„åŸºçŸ³ï¼Œå®Œç¾è¯ é‡Šäº†Â <code>Attention is All You Need</code>Â çš„é©å‘½æ€§æ€æƒ³ã€‚</p>
<h2 data-id="heading-15">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€å‘å·¥å…·é“¾-æ„å»ºã€æµ‹è¯•ã€ä»£ç è´¨é‡æ ¡éªŒå¸¸ç”¨åŒ…çš„æ¯”è¾ƒ]]></title>    <link>https://juejin.cn/post/7577332659506364459</link>    <guid>https://juejin.cn/post/7577332659506364459</guid>    <pubDate>2025-11-28T03:48:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577332659506364459" data-draft-id="7577343038428201003" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€å‘å·¥å…·é“¾-æ„å»ºã€æµ‹è¯•ã€ä»£ç è´¨é‡æ ¡éªŒå¸¸ç”¨åŒ…çš„æ¯”è¾ƒ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Node.js"/> <meta itemprop="datePublished" content="2025-11-28T03:48:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€å‘å·¥å…·é“¾-æ„å»ºã€æµ‹è¯•ã€ä»£ç è´¨é‡æ ¡éªŒå¸¸ç”¨åŒ…çš„æ¯”è¾ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T03:48:20.000Z" title="Fri Nov 28 2025 03:48:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¼€å‘å·¥å…·é“¾åŒ…æ‹¬æ„å»ºã€æµ‹è¯•ã€ä»£ç è´¨é‡æ ¡éªŒç­‰æ ¸å¿ƒå·¥å…·ï¼Œæ˜¯ npm åŒ…å¼€å‘çš„åŸºç¡€è®¾æ–½ã€‚</p>
<h2 data-id="heading-0">ğŸ“‘ ç›®å½•</h2>
<ul>
<li><a href="#%E5%BF%AB%E9%80%9F%E5%8F%82%E8%80%83" title="#%E5%BF%AB%E9%80%9F%E5%8F%82%E8%80%83">å¿«é€Ÿå‚è€ƒ</a></li>
<li><a href="#%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7" title="#%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7">æ„å»ºå·¥å…·</a>
<ul>
<li><a href="#tsup-%E6%8E%A8%E8%8D%90" title="#tsup-%E6%8E%A8%E8%8D%90">tsup</a></li>
<li><a href="#rollup" title="#rollup">Rollup</a></li>
<li><a href="#esbuild" title="#esbuild">esbuild</a></li>
<li><a href="#unbuild" title="#unbuild">unbuild</a></li>
<li><a href="#%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94" title="#%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94">æ„å»ºå·¥å…·å¯¹æ¯”</a></li>
</ul>
</li>
<li><a href="#%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7" title="#%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7">æµ‹è¯•å·¥å…·</a>
<ul>
<li><a href="#vitest-%E6%8E%A8%E8%8D%90" title="#vitest-%E6%8E%A8%E8%8D%90">Vitest</a></li>
<li><a href="#jest" title="#jest">Jest</a></li>
<li><a href="#mocha" title="#mocha">Mocha</a></li>
<li><a href="#ava" title="#ava">Ava</a></li>
<li><a href="#%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94" title="#%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94">æµ‹è¯•å·¥å…·å¯¹æ¯”</a></li>
</ul>
</li>
<li><a href="#%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E5%B7%A5%E5%85%B7" title="#%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E5%B7%A5%E5%85%B7">ä»£ç è´¨é‡å·¥å…·</a>
<ul>
<li><a href="#eslint--prettier" title="#eslint--prettier">ESLint + Prettier</a></li>
<li><a href="#stylelint%E6%A0%B7%E5%BC%8F%E6%96%87%E4%BB%B6%E6%A0%A1%E9%AA%8C" title="#stylelint%E6%A0%B7%E5%BC%8F%E6%96%87%E4%BB%B6%E6%A0%A1%E9%AA%8C">Stylelint</a></li>
</ul>
</li>
<li><a href="#git-hooks" title="#git-hooks">Git Hooks</a></li>
<li><a href="#vs-code-%E9%9B%86%E6%88%90" title="#vs-code-%E9%9B%86%E6%88%90">VS Code é›†æˆ</a></li>
<li><a href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" title="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">æœ€ä½³å®è·µ</a></li>
<li><a href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" title="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">å¸¸è§é—®é¢˜</a></li>
</ul>
<hr/>
<h2 data-id="heading-1">å¿«é€Ÿå‚è€ƒ</h2>
<h3 data-id="heading-2">å·¥å…·é€‰å‹é€ŸæŸ¥è¡¨</h3>



































<table><thead><tr><th>å·¥å…·ç±»å‹</th><th>æ¨èå·¥å…·</th><th>é€‚ç”¨åœºæ™¯</th><th>å¤‡é€‰æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>æ„å»ºå·¥å…·</strong></td><td>tsup</td><td>TypeScript åº“ã€åŒæ¨¡å¼ï¼ˆESM+CJSï¼‰ã€å¿«é€Ÿä¸Šæ‰‹</td><td>Rollupï¼ˆå¤æ‚åœºæ™¯ï¼‰ã€esbuildï¼ˆæé€Ÿæ„å»ºï¼‰</td></tr><tr><td><strong>æµ‹è¯•å·¥å…·</strong></td><td>Vitest</td><td>TypeScriptã€ESMã€å¿«é€Ÿæµ‹è¯•</td><td>Jestï¼ˆæˆç†Ÿç”Ÿæ€ï¼‰ã€Mochaï¼ˆçµæ´»é…ç½®ï¼‰</td></tr><tr><td><strong>ä»£ç è´¨é‡</strong></td><td>ESLint + Prettier + Stylelint</td><td>ä»£ç è§„èŒƒã€æ ¼å¼åŒ–</td><td>Biomeï¼ˆä¸€ä½“åŒ–æ–¹æ¡ˆï¼‰</td></tr><tr><td><strong>Git Hooks</strong></td><td>simple-git-hooks</td><td>è½»é‡çº§ã€é›¶é…ç½®</td><td>huskyï¼ˆåŠŸèƒ½ä¸°å¯Œï¼‰</td></tr></tbody></table>
<h3 data-id="heading-3">å¿«é€Ÿå¼€å§‹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å®‰è£…æ ¸å¿ƒå·¥å…·</span>
pnpm add tsup typescript vitest -D
pnpm add eslint prettier -D

<span class="hljs-comment"># 2. åˆå§‹åŒ–é…ç½®</span>
<span class="hljs-comment"># - tsup.config.ts</span>
<span class="hljs-comment"># - vitest.config.ts</span>
<span class="hljs-comment"># - .eslintrc.js</span>
<span class="hljs-comment"># - .prettierrc.js</span>

<span class="hljs-comment"># 3. é…ç½® package.json scripts</span>
</code></pre>
<hr/>
<h2 data-id="heading-4">æ„å»ºå·¥å…·</h2>
<h3 data-id="heading-5">tsupï¼ˆæ¨èï¼‰</h3>
<p>å¯¹äºéœ€è¦ TypeScript + åŒæ¨¡å¼å…¼å®¹ï¼ˆESM + CJSï¼‰çš„ npm åŒ…å¼€å‘ï¼Œtsup æ˜¯å½“å‰æœ€æ¨èçš„å·¥å…·ä¹‹ä¸€â€”â€”å®ƒå®Œç¾è§£å†³äº†ã€ŒTS è½¬è¯‘ + åŒæ¨¡å¼æ‰“åŒ… + ç±»å‹å£°æ˜ç”Ÿæˆ + ä½é…ç½®æˆæœ¬ã€çš„æ ¸å¿ƒéœ€æ±‚ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… é›¶é…ç½®ï¼Œå¼€ç®±å³ç”¨</li>
<li>âœ… åŸºäº esbuildï¼Œæ„å»ºé€Ÿåº¦æå¿«</li>
<li>âœ… è‡ªåŠ¨ç”Ÿæˆç±»å‹å£°æ˜ï¼ˆ.d.tsï¼‰</li>
<li>âœ… æ”¯æŒ Shebangï¼ˆCLI å·¥å…·å¿…éœ€ï¼‰</li>
<li>âœ… å†…ç½® Tree-shaking</li>
</ul>
<h4 data-id="heading-6">å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add tsup typescript -D
</code></pre>
<h4 data-id="heading-7">é…ç½®</h4>
<p><strong>tsup.config.ts</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'tsup'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">entry</span>: [<span class="hljs-string">'src/index.ts'</span>], <span class="hljs-comment">// å…¥å£æ–‡ä»¶</span>
  <span class="hljs-attr">format</span>: [<span class="hljs-string">'esm'</span>, <span class="hljs-string">'cjs'</span>], <span class="hljs-comment">// åŒæ—¶è¾“å‡º ESMï¼ˆ.jsï¼‰å’Œ CJSï¼ˆ.cjsï¼‰</span>
  <span class="hljs-attr">shebang</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// CLI å¿…é¡»æ·»åŠ  Shebangï¼Œä¼šè‡ªåŠ¨æ·»åŠ  #!/usr/bin/env node</span>
  <span class="hljs-attr">dts</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// è‡ªåŠ¨ç”Ÿæˆ TypeScript ç±»å‹å£°æ˜ï¼ˆ.d.tsï¼‰</span>
  <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ç”Ÿæˆ sourcemap</span>
  <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ‰“åŒ…å‰æ¸…ç©º dist ç›®å½•</span>
  <span class="hljs-attr">minify</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒå‹ç¼©ä»£ç ï¼ˆå¯é€‰ï¼‰</span>
  <span class="hljs-attr">target</span>: <span class="hljs-string">'es2020'</span>, <span class="hljs-comment">// è½¬è¯‘ç›®æ ‡ï¼ˆå…¼å®¹ Node 14+ï¼‰</span>
  <span class="hljs-attr">splitting</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// å…³é—­ä»£ç åˆ†å‰²ï¼ˆåº“æ‰“åŒ…ä¸éœ€è¦ï¼‰</span>
});
</code></pre>
<p><strong>package.json scripts</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsup"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsup --watch"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"prepublishOnly"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npm run build"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-8">æ‰“åŒ…äº§ç‰©</h4>
<pre><code class="hljs language-bash" lang="bash">dist/
â”œâ”€â”€ index.js        <span class="hljs-comment"># ESM äº§ç‰©</span>
â”œâ”€â”€ index.cjs       <span class="hljs-comment"># CJS äº§ç‰©</span>
â”œâ”€â”€ index.d.ts      <span class="hljs-comment"># TS ç±»å‹å£°æ˜</span>
â”œâ”€â”€ index.js.map    <span class="hljs-comment"># ESM sourcemap</span>
â””â”€â”€ index.cjs.map   <span class="hljs-comment"># CJS sourcemap</span>
</code></pre>
<hr/>
<h3 data-id="heading-9">Rollup</h3>
<p>Rollup æ˜¯æˆç†Ÿçš„æ¨¡å—æ‰“åŒ…å™¨ï¼Œé€‚åˆå¤æ‚åœºæ™¯å’Œç²¾ç»†æ§åˆ¶ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… å¼ºå¤§çš„æ’ä»¶ç”Ÿæ€</li>
<li>âœ… ç²¾ç¡®çš„ Tree-shaking</li>
<li>âœ… æ”¯æŒå¤šå…¥å£ã€ä»£ç åˆ†å‰²</li>
<li>âœ… é€‚åˆå¤§å‹åº“å’Œå¤æ‚æ„å»ºéœ€æ±‚</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âŒ é…ç½®ç›¸å¯¹å¤æ‚</li>
<li>âŒ éœ€è¦æ‰‹åŠ¨é…ç½® TypeScript ç±»å‹ç”Ÿæˆ</li>
</ul>
<h4 data-id="heading-10">å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add rollup @rollup/plugin-typescript @rollup/plugin-node-resolve @rollup/plugin-commonjs rollup-plugin-dts -D
</code></pre>
<h4 data-id="heading-11">é…ç½®</h4>
<p><strong>rollup.config.js</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> typescript <span class="hljs-keyword">from</span> <span class="hljs-string">'@rollup/plugin-typescript'</span>;
<span class="hljs-keyword">import</span> resolve <span class="hljs-keyword">from</span> <span class="hljs-string">'@rollup/plugin-node-resolve'</span>;
<span class="hljs-keyword">import</span> commonjs <span class="hljs-keyword">from</span> <span class="hljs-string">'@rollup/plugin-commonjs'</span>;
<span class="hljs-keyword">import</span> dts <span class="hljs-keyword">from</span> <span class="hljs-string">'rollup-plugin-dts'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> [
  <span class="hljs-comment">// æ„å»º JS æ–‡ä»¶</span>
  {
    <span class="hljs-attr">input</span>: <span class="hljs-string">'src/index.ts'</span>,
    <span class="hljs-attr">output</span>: [
      {
        <span class="hljs-attr">file</span>: <span class="hljs-string">'dist/index.cjs'</span>,
        <span class="hljs-attr">format</span>: <span class="hljs-string">'cjs'</span>,
        <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,
      },
      {
        <span class="hljs-attr">file</span>: <span class="hljs-string">'dist/index.js'</span>,
        <span class="hljs-attr">format</span>: <span class="hljs-string">'esm'</span>,
        <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,
      },
    ],
    <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">typescript</span>(), <span class="hljs-title function_">resolve</span>(), <span class="hljs-title function_">commonjs</span>()],
    <span class="hljs-attr">external</span>: [<span class="hljs-string">'react'</span>, <span class="hljs-string">'react-dom'</span>], <span class="hljs-comment">// å¤–éƒ¨ä¾èµ–</span>
  },
  <span class="hljs-comment">// ç”Ÿæˆç±»å‹å£°æ˜</span>
  {
    <span class="hljs-attr">input</span>: <span class="hljs-string">'src/index.ts'</span>,
    <span class="hljs-attr">output</span>: {
      <span class="hljs-attr">file</span>: <span class="hljs-string">'dist/index.d.ts'</span>,
      <span class="hljs-attr">format</span>: <span class="hljs-string">'es'</span>,
    },
    <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">dts</span>()],
  },
];
</code></pre>
<hr/>
<h3 data-id="heading-12">esbuild</h3>
<p>esbuild æ˜¯æé€Ÿçš„ JavaScript/TypeScript æ‰“åŒ…å™¨ï¼Œé€‚åˆå¯¹æ„å»ºé€Ÿåº¦è¦æ±‚æé«˜çš„åœºæ™¯ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… æ„å»ºé€Ÿåº¦æå¿«ï¼ˆ10-100x å¿«äºå…¶ä»–å·¥å…·ï¼‰</li>
<li>âœ… é›¶é…ç½®ï¼ŒAPI ç®€å•</li>
<li>âœ… å†…ç½® TypeScript æ”¯æŒ</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âŒ ä¸æ”¯æŒç±»å‹å£°æ˜ç”Ÿæˆï¼ˆéœ€é…åˆ tscï¼‰</li>
<li>âŒ æ’ä»¶ç”Ÿæ€ç›¸å¯¹è¾ƒå°‘</li>
<li>âŒ é…ç½®é€‰é¡¹è¾ƒå°‘</li>
</ul>
<h4 data-id="heading-13">å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add esbuild typescript -D
</code></pre>
<h4 data-id="heading-14">é…ç½®</h4>
<p><strong>esbuild.config.js</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { build } <span class="hljs-keyword">from</span> <span class="hljs-string">'esbuild'</span>;

<span class="hljs-title function_">build</span>({
  <span class="hljs-attr">entryPoints</span>: [<span class="hljs-string">'src/index.ts'</span>],
  <span class="hljs-attr">bundle</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">outdir</span>: <span class="hljs-string">'dist'</span>,
  <span class="hljs-attr">format</span>: <span class="hljs-string">'esm'</span>,
  <span class="hljs-attr">platform</span>: <span class="hljs-string">'node'</span>,
  <span class="hljs-attr">target</span>: <span class="hljs-string">'es2020'</span>,
  <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">minify</span>: <span class="hljs-literal">true</span>,
}).<span class="hljs-keyword">catch</span>(<span class="hljs-function">() =&gt;</span> process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>));
</code></pre>
<p><strong>package.json scripts</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node esbuild.config.js &amp;&amp; tsc --emitDeclarationOnly"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build:cjs"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbuild src/index.ts --bundle --format=cjs --outfile=dist/index.cjs"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build:esm"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbuild src/index.ts --bundle --format=esm --outfile=dist/index.js"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-15">unbuild</h3>
<p>unbuild æ˜¯ Nuxt å›¢é˜Ÿå¼€å‘çš„æ„å»ºå·¥å…·ï¼ŒåŸºäº Rollupï¼Œé…ç½®æ›´ç®€å•ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… é…ç½®ç®€å•ï¼Œç±»ä¼¼ tsup</li>
<li>âœ… åŸºäº Rollupï¼ŒåŠŸèƒ½å¼ºå¤§</li>
<li>âœ… è‡ªåŠ¨ç”Ÿæˆç±»å‹å£°æ˜</li>
<li>âœ… æ”¯æŒ monorepo</li>
</ul>
<h4 data-id="heading-16">å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add unbuild -D
</code></pre>
<h4 data-id="heading-17">é…ç½®</h4>
<p><strong>build.config.ts</strong>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { defineBuildConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'unbuild'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineBuildConfig</span>({
  <span class="hljs-attr">entries</span>: [<span class="hljs-string">'src/index'</span>],
  <span class="hljs-attr">declaration</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">rollup</span>: {
    <span class="hljs-attr">emitCJS</span>: <span class="hljs-literal">true</span>,
  },
});
</code></pre>
<hr/>
<h3 data-id="heading-18">æ„å»ºå·¥å…·å¯¹æ¯”</h3>





















































<table><thead><tr><th>å·¥å…·</th><th>é€Ÿåº¦</th><th>é…ç½®å¤æ‚åº¦</th><th>ç±»å‹å£°æ˜</th><th>æ’ä»¶ç”Ÿæ€</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>tsup</strong></td><td>â­â­â­â­â­</td><td>â­â­â­â­â­</td><td>âœ… è‡ªåŠ¨</td><td>â­â­â­</td><td>TypeScript åº“ã€å¿«é€Ÿä¸Šæ‰‹</td></tr><tr><td><strong>Rollup</strong></td><td>â­â­â­</td><td>â­â­</td><td>âŒ éœ€æ’ä»¶</td><td>â­â­â­â­â­</td><td>å¤§å‹åº“ã€å¤æ‚æ„å»º</td></tr><tr><td><strong>esbuild</strong></td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>âŒ éœ€ tsc</td><td>â­â­</td><td>æé€Ÿæ„å»ºã€ç®€å•é¡¹ç›®</td></tr><tr><td><strong>unbuild</strong></td><td>â­â­â­â­</td><td>â­â­â­â­â­</td><td>âœ… è‡ªåŠ¨</td><td>â­â­â­â­</td><td>Nuxt ç”Ÿæ€ã€monorepo</td></tr><tr><td><strong>webpack</strong></td><td>â­â­</td><td>â­</td><td>âŒ éœ€é…ç½®</td><td>â­â­â­â­â­</td><td>åº”ç”¨é¡¹ç›®ï¼ˆä¸æ¨èåº“ï¼‰</td></tr></tbody></table>
<p><strong>é€‰å‹å»ºè®®</strong>ï¼š</p>
<ul>
<li><strong>å¿«é€Ÿå¼€å‘ TypeScript åº“</strong>ï¼štsup</li>
<li><strong>å¤æ‚æ„å»ºéœ€æ±‚</strong>ï¼šRollup</li>
<li><strong>æè‡´æ„å»ºé€Ÿåº¦</strong>ï¼šesbuild</li>
<li><strong>Nuxt é¡¹ç›®</strong>ï¼šunbuild</li>
</ul>
<hr/>
<h2 data-id="heading-19">æµ‹è¯•å·¥å…·</h2>
<h3 data-id="heading-20">Vitestï¼ˆæ¨èï¼‰</h3>
<p>Vitest æ˜¯åŸºäº esbuild çš„è¶…é«˜é€Ÿæµ‹è¯•å·¥å…·ï¼Œå¤©ç”Ÿæ”¯æŒ TS/ESM/CJSï¼Œä¸ tsup ç”Ÿæ€å¥‘åˆåº¦æé«˜ï¼Œé…ç½®ç®€å•ä¸”è¿è¡Œé€Ÿåº¦æ¯” Jest å¿« 5-10 å€ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… åŸºäº esbuildï¼Œé€Ÿåº¦æå¿«</li>
<li>âœ… é›¶é…ç½®ï¼Œå¼€ç®±å³ç”¨</li>
<li>âœ… åŸç”Ÿæ”¯æŒ TypeScriptã€ESM</li>
<li>âœ… å…¼å®¹ Jest APIï¼Œè¿ç§»æˆæœ¬ä½</li>
<li>âœ… å†…ç½® UI ç•Œé¢</li>
</ul>
<h4 data-id="heading-21">å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add vitest @vitest/ui @vitest/coverage-v8 -D
</code></pre>
<h4 data-id="heading-22">é…ç½®</h4>
<p><strong>é›¶é…ç½®ä½¿ç”¨</strong>ï¼ˆpackage.jsonï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitest run"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"test:watch"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitest"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"test:ui"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitest ui"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"test:coverage"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitest run --coverage"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ä½¿ç”¨é…ç½®æ–‡ä»¶</strong>ï¼ˆvitest.config.tsï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vitest/config'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">test</span>: {
    <span class="hljs-attr">globals</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">environment</span>: <span class="hljs-string">'node'</span>,
    <span class="hljs-attr">include</span>: [<span class="hljs-string">'test/**/*.test.{ts,js}'</span>],
    <span class="hljs-attr">exclude</span>: [<span class="hljs-string">'node_modules'</span>, <span class="hljs-string">'dist'</span>],
    <span class="hljs-attr">coverage</span>: {
      <span class="hljs-attr">provider</span>: <span class="hljs-string">'v8'</span>,
      <span class="hljs-attr">reporter</span>: [<span class="hljs-string">'text'</span>, <span class="hljs-string">'html'</span>, <span class="hljs-string">'lcov'</span>],
      <span class="hljs-attr">reportsDirectory</span>: <span class="hljs-string">'coverage'</span>,
      <span class="hljs-attr">thresholds</span>: {
        <span class="hljs-attr">lines</span>: <span class="hljs-number">80</span>,
        <span class="hljs-attr">functions</span>: <span class="hljs-number">80</span>,
        <span class="hljs-attr">branches</span>: <span class="hljs-number">80</span>,
        <span class="hljs-attr">statements</span>: <span class="hljs-number">80</span>,
      },
    },
  },
});
</code></pre>
<h4 data-id="heading-23">ç¼–å†™æµ‹è¯•ç”¨ä¾‹</h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { describe, test, expect } <span class="hljs-keyword">from</span> <span class="hljs-string">'vitest'</span>;
<span class="hljs-keyword">import</span> { add, formatDate } <span class="hljs-keyword">from</span> <span class="hljs-string">'../src/index.ts'</span>;

<span class="hljs-title function_">describe</span>(<span class="hljs-string">'å·¥å…·å‡½æ•°'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">test</span>(<span class="hljs-string">'add(1, 2) åº”è¯¥è¿”å› 3'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">3</span>);
    <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">add</span>(-<span class="hljs-number">1</span>, <span class="hljs-number">5</span>)).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">4</span>);
    <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">0</span>);
  });

  <span class="hljs-title function_">test</span>(<span class="hljs-string">'formatDate åº”è¯¥å°†æ—¥æœŸæ ¼å¼åŒ–ä¸º YYYY-MM-DD'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2025-11-24'</span>);
    <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">formatDate</span>(date)).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">'2025-11-24'</span>);
  });

  <span class="hljs-title function_">test</span>(<span class="hljs-string">'å¼‚æ­¥å‡½æ•°åº”è¯¥è¿”å›æˆåŠŸç»“æœ'</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchData</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'test'</span> });
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>();
    <span class="hljs-title function_">expect</span>(result.<span class="hljs-property">name</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">'test'</span>);
  });
});
</code></pre>
<hr/>
<h3 data-id="heading-24">Jest</h3>
<p>Jest æ˜¯ Facebook å¼€å‘çš„æˆç†Ÿæµ‹è¯•æ¡†æ¶ï¼Œç”Ÿæ€ä¸°å¯Œï¼Œé€‚åˆå¤§å‹é¡¹ç›®ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… åŠŸèƒ½å…¨é¢ï¼ˆMockã€Snapshotã€Coverageï¼‰</li>
<li>âœ… ç”Ÿæ€ä¸°å¯Œï¼Œæ’ä»¶å¤š</li>
<li>âœ… æ–‡æ¡£å®Œå–„ï¼Œç¤¾åŒºæ´»è·ƒ</li>
<li>âœ… é€‚åˆ React é¡¹ç›®</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âŒ é…ç½®ç›¸å¯¹å¤æ‚</li>
<li>âŒ é€Ÿåº¦è¾ƒæ…¢ï¼ˆéœ€é…ç½® esbuild åŠ é€Ÿï¼‰</li>
<li>âŒ TypeScript æ”¯æŒéœ€é¢å¤–é…ç½®</li>
</ul>
<h4 data-id="heading-25">å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add jest @types/jest ts-jest -D
</code></pre>
<h4 data-id="heading-26">é…ç½®</h4>
<p><strong>jest.config.js</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">preset</span>: <span class="hljs-string">'ts-jest'</span>,
  <span class="hljs-attr">testEnvironment</span>: <span class="hljs-string">'node'</span>,
  <span class="hljs-attr">roots</span>: [<span class="hljs-string">'&lt;rootDir&gt;/test'</span>],
  <span class="hljs-attr">testMatch</span>: [<span class="hljs-string">'**/*.test.{ts,js}'</span>],
  <span class="hljs-attr">collectCoverageFrom</span>: [<span class="hljs-string">'src/**/*.{ts,js}'</span>, <span class="hljs-string">'!src/**/*.d.ts'</span>],
  <span class="hljs-attr">coverageDirectory</span>: <span class="hljs-string">'coverage'</span>,
  <span class="hljs-attr">coverageReporters</span>: [<span class="hljs-string">'text'</span>, <span class="hljs-string">'html'</span>, <span class="hljs-string">'lcov'</span>],
};
</code></pre>
<hr/>
<h3 data-id="heading-27">Mocha</h3>
<p>Mocha æ˜¯çµæ´»çš„æµ‹è¯•æ¡†æ¶ï¼Œéœ€è¦é…åˆæ–­è¨€åº“ä½¿ç”¨ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… çµæ´»ï¼Œå¯è‡ªç”±é€‰æ‹©æ–­è¨€åº“</li>
<li>âœ… æ”¯æŒå¤šç§æŠ¥å‘Šæ ¼å¼</li>
<li>âœ… é€‚åˆ Node.js é¡¹ç›®</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âŒ éœ€è¦é¢å¤–é…ç½®æ–­è¨€åº“ã€è¦†ç›–ç‡å·¥å…·</li>
<li>âŒ é…ç½®ç›¸å¯¹å¤æ‚</li>
</ul>
<h4 data-id="heading-28">å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add mocha @types/mocha chai @types/chai nyc -D
</code></pre>
<h4 data-id="heading-29">é…ç½®</h4>
<p><strong>mocha.opts</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">--require ts-node/register
--<span class="hljs-built_in">timeout</span> 5000
<span class="hljs-built_in">test</span>/**/*.test.ts
</code></pre>
<p><strong>æµ‹è¯•ç”¨ä¾‹ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { expect } <span class="hljs-keyword">from</span> <span class="hljs-string">'chai'</span>;
<span class="hljs-keyword">import</span> { add } <span class="hljs-keyword">from</span> <span class="hljs-string">'../src/index'</span>;

<span class="hljs-title function_">describe</span>(<span class="hljs-string">'add å‡½æ•°'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">it</span>(<span class="hljs-string">'åº”è¯¥æ­£ç¡®ç›¸åŠ ä¸¤ä¸ªæ•°å­—'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">expect</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-number">3</span>);
  });
});
</code></pre>
<hr/>
<h3 data-id="heading-30">Ava</h3>
<p>Ava æ˜¯è½»é‡çº§ã€å¹¶è¡Œçš„æµ‹è¯•æ¡†æ¶ï¼Œé€‚åˆå¿«é€Ÿæµ‹è¯•ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… è½»é‡çº§ï¼Œé€Ÿåº¦å¿«</li>
<li>âœ… å¹¶è¡Œæ‰§è¡Œæµ‹è¯•</li>
<li>âœ… å†…ç½®æ–­è¨€</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âŒ ç”Ÿæ€ç›¸å¯¹è¾ƒå°</li>
<li>âŒ æ–‡æ¡£è¾ƒå°‘</li>
</ul>
<h4 data-id="heading-31">å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add ava -D
</code></pre>
<h4 data-id="heading-32">é…ç½®</h4>
<p><strong>ava.config.js</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">files</span>: [<span class="hljs-string">'test/**/*.test.{ts,js}'</span>],
  <span class="hljs-attr">extensions</span>: [<span class="hljs-string">'ts'</span>],
  <span class="hljs-attr">require</span>: [<span class="hljs-string">'ts-node/register'</span>],
};
</code></pre>
<hr/>
<h3 data-id="heading-33">æµ‹è¯•å·¥å…·å¯¹æ¯”</h3>













































<table><thead><tr><th>å·¥å…·</th><th>é€Ÿåº¦</th><th>é…ç½®å¤æ‚åº¦</th><th>TypeScript</th><th>ç”Ÿæ€</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Vitest</strong></td><td>â­â­â­â­â­</td><td>â­â­â­â­â­</td><td>âœ… åŸç”Ÿ</td><td>â­â­â­â­</td><td>TypeScript é¡¹ç›®ã€å¿«é€Ÿæµ‹è¯•</td></tr><tr><td><strong>Jest</strong></td><td>â­â­â­</td><td>â­â­â­</td><td>âš ï¸ éœ€é…ç½®</td><td>â­â­â­â­â­</td><td>React é¡¹ç›®ã€å¤§å‹é¡¹ç›®</td></tr><tr><td><strong>Mocha</strong></td><td>â­â­â­</td><td>â­â­</td><td>âš ï¸ éœ€é…ç½®</td><td>â­â­â­â­</td><td>Node.js é¡¹ç›®ã€çµæ´»é…ç½®</td></tr><tr><td><strong>Ava</strong></td><td>â­â­â­â­</td><td>â­â­â­â­</td><td>âš ï¸ éœ€é…ç½®</td><td>â­â­â­</td><td>è½»é‡çº§é¡¹ç›®ã€å¿«é€Ÿæµ‹è¯•</td></tr></tbody></table>
<p><strong>é€‰å‹å»ºè®®</strong>ï¼š</p>
<ul>
<li><strong>TypeScript é¡¹ç›®</strong>ï¼šVitestï¼ˆæ¨èï¼‰</li>
<li><strong>React é¡¹ç›®</strong>ï¼šJest</li>
<li><strong>Node.js é¡¹ç›®</strong>ï¼šMocha</li>
<li><strong>è½»é‡çº§é¡¹ç›®</strong>ï¼šAva</li>
</ul>
<hr/>
<h2 data-id="heading-34">ä»£ç è´¨é‡å·¥å…·</h2>
<h3 data-id="heading-35">ESLint + Prettier</h3>
<p>ESLint å’Œ Prettier æ˜¯å‰ç«¯ä»£ç è´¨é‡ä¸æ ¼å¼è§„èŒƒçš„é»„é‡‘ç»„åˆï¼š</p>
<ul>
<li><strong>ESLint</strong>ï¼šè´Ÿè´£ä»£ç è´¨é‡æ ¡éªŒï¼ˆè¯­æ³•é”™è¯¯ã€é€»è¾‘é—®é¢˜ï¼‰</li>
<li><strong>Prettier</strong>ï¼šè´Ÿè´£ä»£ç æ ¼å¼ç¾åŒ–ï¼ˆç¼©è¿›ã€å¼•å·ã€åˆ†å·ï¼‰</li>
</ul>
<h4 data-id="heading-36">å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add eslint prettier -D
pnpm add @typescript-eslint/eslint-plugin @typescript-eslint/parser -D
pnpm add eslint-config-prettier eslint-plugin-prettier -D
</code></pre>
<h4 data-id="heading-37">ESLint é…ç½®ï¼ˆ.eslintrc.jsï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">env</span>: {
    <span class="hljs-attr">browser</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">node</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">es2024</span>: <span class="hljs-literal">true</span>,
  },
  <span class="hljs-attr">parser</span>: <span class="hljs-string">'@typescript-eslint/parser'</span>,
  <span class="hljs-attr">parserOptions</span>: {
    <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-string">'latest'</span>,
    <span class="hljs-attr">project</span>: <span class="hljs-string">'./tsconfig.json'</span>,
    <span class="hljs-attr">tsconfigRootDir</span>: __dirname,
    <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'module'</span>,
  },
  <span class="hljs-attr">plugins</span>: [<span class="hljs-string">'@typescript-eslint'</span>, <span class="hljs-string">'prettier'</span>],
  <span class="hljs-attr">extends</span>: [
    <span class="hljs-string">'eslint:recommended'</span>,
    <span class="hljs-string">'plugin:@typescript-eslint/recommended'</span>,
    <span class="hljs-string">'plugin:@typescript-eslint/recommended-requiring-type-checking'</span>,
    <span class="hljs-string">'plugin:prettier/recommended'</span>,
  ],
  <span class="hljs-attr">rules</span>: {
    <span class="hljs-string">'@typescript-eslint/no-explicit-any'</span>: <span class="hljs-string">'warn'</span>,
    <span class="hljs-string">'@typescript-eslint/no-unused-vars'</span>: [<span class="hljs-string">'warn'</span>, { <span class="hljs-attr">argsIgnorePattern</span>: <span class="hljs-string">'^_'</span> }],
    <span class="hljs-string">'no-console'</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">'production'</span> ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span>,
  },
  <span class="hljs-attr">ignorePatterns</span>: [<span class="hljs-string">'dist/'</span>, <span class="hljs-string">'node_modules/'</span>, <span class="hljs-string">'*.config.*'</span>],
};
</code></pre>
<h4 data-id="heading-38">Prettier é…ç½®ï¼ˆ.prettierrc.jsï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">printWidth</span>: <span class="hljs-number">80</span>,
  <span class="hljs-attr">tabWidth</span>: <span class="hljs-number">2</span>,
  <span class="hljs-attr">useTabs</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">semi</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">singleQuote</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">quoteProps</span>: <span class="hljs-string">'as-needed'</span>,
  <span class="hljs-attr">jsxSingleQuote</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">trailingComma</span>: <span class="hljs-string">'es5'</span>,
  <span class="hljs-attr">bracketSpacing</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">bracketSameLine</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">arrowParens</span>: <span class="hljs-string">'avoid'</span>,
  <span class="hljs-attr">proseWrap</span>: <span class="hljs-string">'preserve'</span>,
  <span class="hljs-attr">htmlWhitespaceSensitivity</span>: <span class="hljs-string">'css'</span>,
  <span class="hljs-attr">endOfLine</span>: <span class="hljs-string">'lf'</span>,
};
</code></pre>
<h4 data-id="heading-39">å¿½ç•¥æ–‡ä»¶é…ç½®</h4>
<p><strong>.eslintignore</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">dist/
node_modules/
*.config.*
coverage/
</code></pre>
<p><strong>.prettierignore</strong>ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">dist/
node_modules/
coverage/
*.min.js
package-<span class="hljs-keyword">lock</span>.json
pnpm-<span class="hljs-keyword">lock</span>.yaml
</code></pre>
<h4 data-id="heading-40">è„šæœ¬å‘½ä»¤</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint . --ext .ts,.tsx,.js,.jsx"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint:fix"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint . --ext .ts,.tsx,.js,.jsx --fix"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"prettier:check"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"prettier --check ."</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"prettier:fix"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"prettier --write ."</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"format"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pnpm run prettier:fix &amp;&amp; pnpm run lint:fix"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-41">Stylelintï¼ˆæ ·å¼æ–‡ä»¶æ ¡éªŒï¼‰</h3>
<p>stylelint æ˜¯æ ·å¼æ–‡ä»¶çš„ä»£ç è´¨é‡ä¸æ ¼å¼æ ¡éªŒå·¥å…·ï¼Œç›¸å½“äºæ ·å¼é¢†åŸŸçš„ã€ŒESLintã€ã€‚</p>
<h4 data-id="heading-42">å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add stylelint stylelint-config-standard stylelint-config-standard-scss -D
pnpm add stylelint-scss postcss-scss -D
pnpm add stylelint-config-prettier stylelint-prettier -D
pnpm add stylelint-order stylelint-config-recess-order -D
</code></pre>
<h4 data-id="heading-43">é…ç½®ï¼ˆ.stylelintrc.jsï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">files</span>: [<span class="hljs-string">'**/*.{css,scss,sass,less,vue}'</span>],
  <span class="hljs-attr">ignoreFiles</span>: [<span class="hljs-string">'dist/'</span>, <span class="hljs-string">'node_modules/'</span>],
  <span class="hljs-attr">customSyntax</span>: <span class="hljs-string">'postcss-scss'</span>,
  <span class="hljs-attr">extends</span>: [
    <span class="hljs-string">'stylelint-config-standard'</span>,
    <span class="hljs-string">'stylelint-config-standard-scss'</span>,
    <span class="hljs-string">'stylelint-config-recess-order'</span>,
    <span class="hljs-string">'stylelint-prettier/recommended'</span>,
  ],
  <span class="hljs-attr">rules</span>: {
    <span class="hljs-string">'declaration-no-important'</span>: <span class="hljs-number">0</span>,
    <span class="hljs-string">'selector-max-compound-selectors'</span>: [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
    <span class="hljs-string">'property-no-deprecated'</span>: <span class="hljs-number">1</span>,
  },
};
</code></pre>
<h4 data-id="heading-44">è„šæœ¬å‘½ä»¤</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"lint:style"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"stylelint . --ext .css,.scss,.less,.vue"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint:style:fix"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"stylelint . --ext .css,.scss,.less,.vue --fix"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-45">Git Hooks</h2>
<h3 data-id="heading-46">simple-git-hooks</h3>
<p>simple-git-hooks æ˜¯ä¸€æ¬¾ã€Œé›¶é…ç½®ã€è½»é‡å‹ã€çš„ Git Hooks å·¥å…·ï¼Œç”¨äºéªŒè¯æäº¤ä¿¡æ¯æ ¼å¼å’Œè¿è¡Œæµ‹è¯•ã€‚</p>
<h4 data-id="heading-47">å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add simple-git-hooks @commitlint/cli @commitlint/config-conventional -D
</code></pre>
<h4 data-id="heading-48">é…ç½®æäº¤ä¿¡æ¯æ ¡éªŒï¼ˆcommitlint.config.jsï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">extends</span>: [<span class="hljs-string">'@commitlint/config-conventional'</span>],
  <span class="hljs-attr">rules</span>: {
    <span class="hljs-string">'type-enum'</span>: [
      <span class="hljs-number">2</span>,
      <span class="hljs-string">'always'</span>,
      [<span class="hljs-string">'feat'</span>, <span class="hljs-string">'fix'</span>, <span class="hljs-string">'docs'</span>, <span class="hljs-string">'style'</span>, <span class="hljs-string">'refactor'</span>, <span class="hljs-string">'perf'</span>, <span class="hljs-string">'test'</span>, <span class="hljs-string">'build'</span>, <span class="hljs-string">'ci'</span>, <span class="hljs-string">'chore'</span>],
    ],
    <span class="hljs-string">'subject-max-length'</span>: [<span class="hljs-number">1</span>, <span class="hljs-string">'always'</span>, <span class="hljs-number">50</span>],
  },
};
</code></pre>
<h4 data-id="heading-49">é…ç½® Git Hooksï¼ˆpackage.jsonï¼‰</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"prepare"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"simple-git-hooks"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"simple-git-hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"commit-msg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npx --no -- commitlint --edit $1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"pre-commit"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pnpm run lint &amp;&amp; pnpm run test"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-50">åˆå§‹åŒ–é’©å­</h4>
<pre><code class="hljs language-bash" lang="bash">npx simple-git-hooks
</code></pre>
<h4 data-id="heading-51">æäº¤ä¿¡æ¯æ ¼å¼</h4>
<p>æ ¼å¼ï¼š<code>type(scope): subject</code></p>
<p>ç¤ºä¾‹ï¼š</p>
<ul>
<li><code>feat(user): æ–°å¢ç”¨æˆ·ç™»å½•åŠŸèƒ½</code></li>
<li><code>fix: ä¿®å¤ç™»å½•å¤±è´¥é—®é¢˜</code></li>
<li><code>docs: æ›´æ–° README ä¸­çš„å®‰è£…æ­¥éª¤</code></li>
</ul>
<hr/>
<h3 data-id="heading-52">husky</h3>
<p>husky æ˜¯åŠŸèƒ½ä¸°å¯Œçš„ Git Hooks å·¥å…·ï¼Œé€‚åˆéœ€è¦æ›´å¤šæ§åˆ¶å’ŒåŠŸèƒ½çš„é¡¹ç›®ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… åŠŸèƒ½ä¸°å¯Œï¼Œæ”¯æŒæ‰€æœ‰ Git Hooks</li>
<li>âœ… é…ç½®çµæ´»ï¼Œå¯ç¼–å†™å¤æ‚è„šæœ¬</li>
<li>âœ… ç”Ÿæ€å®Œå–„ï¼Œæ’ä»¶å¤š</li>
<li>âœ… æ”¯æŒè·¨å¹³å°ï¼ˆWindows/Mac/Linuxï¼‰</li>
<li>âœ… æ–‡æ¡£å®Œå–„ï¼Œç¤¾åŒºæ´»è·ƒ</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âŒ é…ç½®ç›¸å¯¹å¤æ‚</li>
<li>âŒ éœ€è¦æ‰‹åŠ¨åˆ›å»º <code>.husky</code> ç›®å½•</li>
<li>âŒ ä½“ç§¯è¾ƒå¤§ï¼ˆç›¸æ¯” simple-git-hooksï¼‰</li>
</ul>
<h4 data-id="heading-53">å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm add husky -D
pnpm add @commitlint/cli @commitlint/config-conventional -D
</code></pre>
<h4 data-id="heading-54">åˆå§‹åŒ–</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆå§‹åŒ– husky</span>
npx husky init

<span class="hljs-comment"># æˆ–æ‰‹åŠ¨åˆ›å»º .husky ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> .husky
</code></pre>
<h4 data-id="heading-55">é…ç½® Git Hooksï¼ˆpackage.jsonï¼‰</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"prepare"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"husky install"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-56">åˆ›å»º Hooks</h4>
<p><strong>pre-commit hook</strong>ï¼ˆ.husky/pre-commitï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/usr/bin/env sh</span>
. <span class="hljs-string">"<span class="hljs-subst">$(dirname -- <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>)</span>/_/husky.sh"</span>

pnpm run lint
pnpm run <span class="hljs-built_in">test</span>
</code></pre>
<p><strong>commit-msg hook</strong>ï¼ˆ.husky/commit-msgï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/usr/bin/env sh</span>
. <span class="hljs-string">"<span class="hljs-subst">$(dirname -- <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>)</span>/_/husky.sh"</span>

npx --no -- commitlint --edit <span class="hljs-variable">$1</span>
</code></pre>
<h4 data-id="heading-57">é…ç½®æäº¤ä¿¡æ¯æ ¡éªŒï¼ˆcommitlint.config.jsï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">extends</span>: [<span class="hljs-string">'@commitlint/config-conventional'</span>],
  <span class="hljs-attr">rules</span>: {
    <span class="hljs-string">'type-enum'</span>: [
      <span class="hljs-number">2</span>,
      <span class="hljs-string">'always'</span>,
      [<span class="hljs-string">'feat'</span>, <span class="hljs-string">'fix'</span>, <span class="hljs-string">'docs'</span>, <span class="hljs-string">'style'</span>, <span class="hljs-string">'refactor'</span>, <span class="hljs-string">'perf'</span>, <span class="hljs-string">'test'</span>, <span class="hljs-string">'build'</span>, <span class="hljs-string">'ci'</span>, <span class="hljs-string">'chore'</span>],
    ],
    <span class="hljs-string">'subject-max-length'</span>: [<span class="hljs-number">1</span>, <span class="hljs-string">'always'</span>, <span class="hljs-number">50</span>],
  },
};
</code></pre>
<h4 data-id="heading-58">é«˜çº§ç”¨æ³•</h4>
<p>husky æ”¯æŒæ›´å¤æ‚çš„è„šæœ¬ï¼Œä¾‹å¦‚ï¼š</p>
<p><strong>pre-push hook</strong>ï¼ˆ.husky/pre-pushï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/usr/bin/env sh</span>
. <span class="hljs-string">"<span class="hljs-subst">$(dirname -- <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>)</span>/_/husky.sh"</span>

<span class="hljs-comment"># è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶</span>
pnpm run <span class="hljs-built_in">test</span>:ci

<span class="hljs-comment"># æ£€æŸ¥ä»£ç è¦†ç›–ç‡</span>
pnpm run <span class="hljs-built_in">test</span>:coverage
</code></pre>
<hr/>
<h3 data-id="heading-59">Git Hooks å·¥å…·å¯¹æ¯”</h3>





























<table><thead><tr><th>å·¥å…·</th><th>é…ç½®å¤æ‚åº¦</th><th>åŠŸèƒ½ä¸°å¯Œåº¦</th><th>ä½“ç§¯</th><th>ç”Ÿæ€</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>simple-git-hooks</strong></td><td>â­â­â­â­â­</td><td>â­â­â­</td><td>è½»é‡çº§</td><td>â­â­â­</td><td>ç®€å•é¡¹ç›®ã€å¿«é€Ÿä¸Šæ‰‹</td></tr><tr><td><strong>husky</strong></td><td>â­â­â­</td><td>â­â­â­â­â­</td><td>è¾ƒå¤§</td><td>â­â­â­â­â­</td><td>å¤æ‚é¡¹ç›®ã€éœ€è¦ç²¾ç»†æ§åˆ¶</td></tr></tbody></table>
<p><strong>é€‰å‹å»ºè®®</strong>ï¼š</p>
<ul>
<li><strong>ç®€å•é¡¹ç›®ã€å¿«é€Ÿä¸Šæ‰‹</strong>ï¼šsimple-git-hooksï¼ˆæ¨èï¼‰</li>
<li><strong>å¤æ‚é¡¹ç›®ã€éœ€è¦ç²¾ç»†æ§åˆ¶</strong>ï¼šhusky</li>
<li><strong>éœ€è¦è·¨å¹³å°æ”¯æŒ</strong>ï¼šhusky</li>
<li><strong>éœ€è¦ç¼–å†™å¤æ‚è„šæœ¬</strong>ï¼šhusky</li>
</ul>
<hr/>
<h2 data-id="heading-60">VS Code é›†æˆ</h2>
<h3 data-id="heading-61">å®‰è£…æ’ä»¶</h3>
<ul>
<li>ESLintï¼ˆMicrosoftï¼‰</li>
<li>Prettier - Code formatter</li>
<li>Vitestï¼ˆå¯é€‰ï¼‰</li>
</ul>
<h3 data-id="heading-62">é…ç½®ï¼ˆ.vscode/settings.jsonï¼‰</h3>
<p>VS Code æ˜¯å‰ç«¯å¼€å‘å¿…å¤‡çš„ç¼–è¾‘å™¨ï¼ŒESLintã€Prettier ç­‰å·¥å…·çš„é›†æˆå¯ä»¥å¤§å¤§æé«˜å¼€å‘æ•ˆç‡ã€‚
å®‰è£…æ’ä»¶ï¼š</p>
<ul>
<li>ESLintï¼ˆMicrosoftï¼‰</li>
<li>Prettier - Code formatter</li>
<li>Vitestï¼ˆå¯é€‰ï¼‰</li>
</ul>
<p>é…ç½®ï¼ˆ.vscode/settings.jsonï¼‰ï¼ŒCommand+Shift+P æ‰“å¼€è®¾ç½®ï¼Œè¾“å…¥ settings.json æ‰“å¼€è®¾ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œèƒ½å®ç°ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ã€ç²˜è´´æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ã€ç¦ç”¨è¾“å…¥æ—¶å®æ—¶æ ¼å¼åŒ–ã€è®¾ç½®é»˜è®¤æ ¼å¼åŒ–å·¥å…·ä¸º Prettierã€ç¼–è¾‘å™¨åŸºç¡€é…ç½®ï¼ˆä¸ Prettier ä¿æŒä¸€è‡´ï¼Œé¿å…å†²çªï¼‰ã€æŒ‰æ–‡ä»¶ç±»å‹æŒ‡å®šæ ¼å¼åŒ–å·¥å…·ï¼ˆå…œåº•ï¼‰ã€ESLint å…³é”®é…ç½®ï¼ˆæ ¸å¿ƒï¼‰ã€Prettier ä¸“å±é…ç½®ã€æ¡†æ¶ä¸“å±å…¼å®¹é…ç½®ã€å…¶ä»–è¾…åŠ©é…ç½®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-comment">// ===================== å…¨å±€æ ¼å¼åŒ–æ ¸å¿ƒé…ç½® =====================</span>
  <span class="hljs-comment">// 1. ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ï¼ˆè§¦å‘ Prettier + ESLint ä¿®å¤ï¼‰</span>
  <span class="hljs-attr">"editor.formatOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// 2. ç²˜è´´å†…å®¹æ—¶è‡ªåŠ¨æ ¼å¼åŒ–</span>
  <span class="hljs-attr">"editor.formatOnPaste"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// 3. ç¦ç”¨è¾“å…¥æ—¶å®æ—¶æ ¼å¼åŒ–ï¼ˆé¿å…é¢‘ç¹å¹²æ‰°ï¼‰</span>
  <span class="hljs-attr">"editor.formatOnType"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// 4. è®¾ç½®é»˜è®¤æ ¼å¼åŒ–å·¥å…·ä¸º Prettierï¼ˆç»Ÿä¸€æ‰€æœ‰æ–‡ä»¶æ ¼å¼ï¼‰</span>
  <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// "editor.defaultFormatter": "biomejs.biome", // ä»¥åè€ƒè™‘</span>
  <span class="hljs-attr">"biome.formatOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"biome.lintOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"biome.organizeImportsOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ä¿å­˜æ—¶è‡ªåŠ¨æ•´ç†å¯¼å…¥è¯­å¥</span>
  <span class="hljs-comment">// 5. ç¼–è¾‘å™¨åŸºç¡€é…ç½®ï¼ˆä¸ Prettier ä¿æŒä¸€è‡´ï¼Œé¿å…å†²çªï¼‰</span>
  <span class="hljs-attr">"editor.tabSize"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"editor.useTabs"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"files.eol"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"\n"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// è¡Œå°¾æ¢è¡Œç¬¦ï¼ˆLFï¼Œè·¨å¹³å°å…¼å®¹ï¼‰</span>

  <span class="hljs-comment">// ===================== æŒ‰æ–‡ä»¶ç±»å‹æŒ‡å®šæ ¼å¼åŒ–å·¥å…·ï¼ˆå…œåº•ï¼‰ =====================</span>
  <span class="hljs-comment">// ç¡®ä¿æ¯ç§æ–‡ä»¶ç±»å‹éƒ½ç”¨ Prettier æ ¼å¼åŒ–ï¼Œé¿å…å†²çª</span>
  <span class="hljs-attr">"[javascript]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[typescript]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[javascriptreact]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[typescriptreact]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[vue]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[svelte]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[css]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[scss]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[markdown]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[json]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[jsonc]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>

  <span class="hljs-comment">// ===================== ESLint å…³é”®é…ç½®ï¼ˆæ ¸å¿ƒï¼‰ =====================</span>
  <span class="hljs-comment">// 1. ä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤ ESLint å¯ä¿®å¤é—®é¢˜ï¼ˆå«æ¡†æ¶è§„åˆ™ï¼‰</span>
  <span class="hljs-attr">"editor.codeActionsOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"source.fixAll.eslint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"explicit"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"source.fixAll.stylelint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"explicit"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"source.organizeImports"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"explicit"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// 2. å¯ç”¨ ESLint æ ¡éªŒçš„æ‰€æœ‰æ–‡ä»¶ç±»å‹</span>
  <span class="hljs-attr">"eslint.validate"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"javascript"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"typescript"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"javascriptreact"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"typescriptreact"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"vue"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"svelte"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"html"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"markdown"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// 3. å¼ºåˆ¶ä½¿ç”¨é¡¹ç›®æ ¹ç›®å½•çš„ ESLint é…ç½®ï¼ˆé¿å…å…¨å±€é…ç½®å¹²æ‰°ï¼‰</span>
  <span class="hljs-attr">"eslint.useFlatConfig"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// å…¼å®¹ä¼ ç»Ÿ .eslintrc.js é…ç½®</span>
  <span class="hljs-attr">"eslint.nodePath"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./node_modules"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// æŒ‡å‘é¡¹ç›®ä¾èµ–ï¼ˆmonorepo åœºæ™¯å¿…å¤‡ï¼‰</span>
  <span class="hljs-attr">"eslint.workingDirectories"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span> <span class="hljs-attr">"mode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"auto"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// è‡ªåŠ¨è¯†åˆ«é¡¹ç›®ç›®å½•</span>

  <span class="hljs-comment">// ===================== Prettier ä¸“å±é…ç½® =====================</span>
  <span class="hljs-comment">// 1. å¼ºåˆ¶ä½¿ç”¨é¡¹ç›®æ ¹ç›®å½•çš„ .prettierrc.jsï¼ˆé¿å…æ’ä»¶é»˜è®¤é…ç½®å†²çªï¼‰</span>
  <span class="hljs-attr">"prettier.requireConfig"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// 2. å¿½ç•¥ .prettierignore ä¸­çš„æ–‡ä»¶</span>
  <span class="hljs-attr">"prettier.ignorePath"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">".prettierignore"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// 3. ç¦ç”¨ Prettier å¯¹ç‰¹å®šæ–‡ä»¶çš„æ ¼å¼åŒ–ï¼ˆæŒ‰éœ€è°ƒæ•´ï¼‰</span>
  <span class="hljs-attr">"prettier.disableLanguages"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>

  <span class="hljs-comment">// ===================== æ¡†æ¶ä¸“å±å…¼å®¹é…ç½® =====================</span>
  <span class="hljs-comment">// 1. Vue é…ç½®ï¼ˆç¦ç”¨ Volar å†…ç½®æ ¼å¼åŒ–ï¼Œäº¤ç»™ Prettierï¼‰</span>
  <span class="hljs-attr">"vue.format.enable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"volar.format.enable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// 2. Svelte é…ç½®ï¼ˆç¦ç”¨å†…ç½®æ ¼å¼åŒ–ï¼Œäº¤ç»™ Prettierï¼‰</span>
  <span class="hljs-attr">"svelte.format.enable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// 3. ç¦ç”¨ VS Code å†…ç½®æ ¼å¼åŒ–ï¼ˆé¿å…ä¸ Prettier/ESLint å†²çªï¼‰</span>
  <span class="hljs-attr">"javascript.format.enable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"typescript.format.enable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"html.format.enable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"css.format.enable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scss.format.enable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>

  <span class="hljs-comment">// ===================== å…¶ä»–è¾…åŠ©é…ç½® =====================</span>
  <span class="hljs-comment">// æ˜¾ç¤º ESLint é”™è¯¯æç¤ºï¼ˆå¢å¼ºå¼€å‘ä½“éªŒï¼‰</span>
  <span class="hljs-attr">"eslint.showDebugLogs"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"eslint.showStatusBar"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// ä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤æ‰€æœ‰å¯ä¿®å¤é—®é¢˜ï¼ˆåŒ…æ‹¬æ¡†æ¶ä¸“å±è§„åˆ™ï¼‰</span>
  <span class="hljs-attr">"editor.codeActionsOnSaveTimeout"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3000</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"cursor.cpp.disabledLanguages"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"plaintext"</span><span class="hljs-punctuation">]</span> <span class="hljs-comment">// å»¶é•¿è¶…æ—¶æ—¶é—´ï¼ˆé¿å…å¤§æ–‡ä»¶ä¿®å¤å¤±è´¥ï¼‰</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-63">æœ€ä½³å®è·µ</h2>
<ol>
<li><strong>å·¥å…·ç»„åˆ</strong>ï¼štsupï¼ˆæ„å»ºï¼‰+ Vitestï¼ˆæµ‹è¯•ï¼‰+ ESLint + Prettierï¼ˆä»£ç è´¨é‡ï¼‰+ simple-git-hooks/huskyï¼ˆæäº¤è§„èŒƒï¼‰</li>
<li><strong>é…ç½®é€»è¾‘</strong>ï¼šPrettier ç®¡æ ¼å¼ï¼ŒESLint ç®¡è´¨é‡ï¼Œé€šè¿‡ eslint-config-prettier é¿å…å†²çª</li>
<li><strong>å¼€å‘æµç¨‹</strong>ï¼šVS Code å®æ—¶æ ¼å¼åŒ– + ä¿å­˜è‡ªåŠ¨ä¿®å¤ + Git Hooks å¼ºåˆ¶æ ¡éªŒ</li>
<li><strong>monorepo é€‚é…</strong>ï¼šæ ¹ç›®å½•ç»Ÿä¸€é…ç½®ï¼Œå­åŒ…ç»§æ‰¿ï¼Œé€šè¿‡ Turbo å¹¶è¡Œæ‰§è¡Œä»»åŠ¡</li>
</ol>
<hr/>
<h2 data-id="heading-64">å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-65">æ„å»ºå·¥å…·ç›¸å…³é—®é¢˜</h3>
<p><strong>Q: tsup å’Œ Rollup å¦‚ä½•é€‰æ‹©ï¼Ÿ</strong></p>
<p>A:</p>
<ul>
<li><strong>tsup</strong>ï¼šé€‚åˆå¿«é€Ÿå¼€å‘ TypeScript åº“ï¼Œé›¶é…ç½®ï¼Œå¼€ç®±å³ç”¨</li>
<li><strong>Rollup</strong>ï¼šé€‚åˆå¤æ‚æ„å»ºéœ€æ±‚ï¼Œéœ€è¦ç²¾ç»†æ§åˆ¶æ‰“åŒ…è¿‡ç¨‹</li>
</ul>
<p><strong>Q: å¦‚ä½•ç”Ÿæˆç±»å‹å£°æ˜æ–‡ä»¶ï¼Ÿ</strong></p>
<p>A:</p>
<ul>
<li><strong>tsup</strong>ï¼šè®¾ç½® <code>dts: true</code> è‡ªåŠ¨ç”Ÿæˆ</li>
<li><strong>Rollup</strong>ï¼šä½¿ç”¨ <code>rollup-plugin-dts</code> æ’ä»¶</li>
<li><strong>esbuild</strong>ï¼šéœ€é…åˆ <code>tsc --emitDeclarationOnly</code></li>
</ul>
<p><strong>Q: æ„å»ºé€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ</strong></p>
<p>A:</p>
<ul>
<li>ä½¿ç”¨ esbuild æˆ– tsupï¼ˆåŸºäº esbuildï¼‰</li>
<li>å…³é—­ä¸å¿…è¦çš„ sourcemap</li>
<li>ä½¿ç”¨ç¼“å­˜ï¼ˆå¦‚ Turborepoï¼‰</li>
</ul>
<h3 data-id="heading-66">æµ‹è¯•å·¥å…·ç›¸å…³é—®é¢˜</h3>
<p><strong>Q: Vitest å’Œ Jest å¦‚ä½•é€‰æ‹©ï¼Ÿ</strong></p>
<p>A:</p>
<ul>
<li><strong>Vitest</strong>ï¼šTypeScript é¡¹ç›®é¦–é€‰ï¼Œé€Ÿåº¦å¿«ï¼Œé…ç½®ç®€å•</li>
<li><strong>Jest</strong>ï¼šReact é¡¹ç›®æˆ–éœ€è¦ä¸°å¯Œç”Ÿæ€çš„åœºæ™¯</li>
</ul>
<p><strong>Q: æµ‹è¯•è¦†ç›–ç‡å¦‚ä½•é…ç½®ï¼Ÿ</strong></p>
<p>A:</p>
<ul>
<li><strong>Vitest</strong>ï¼šå®‰è£… <code>@vitest/coverage-v8</code>ï¼Œé…ç½® <code>coverage</code> é€‰é¡¹</li>
<li><strong>Jest</strong>ï¼šå†…ç½® coverageï¼Œé…ç½® <code>collectCoverageFrom</code></li>
</ul>
<p><strong>Q: å¦‚ä½•æµ‹è¯•å¼‚æ­¥å‡½æ•°ï¼Ÿ</strong></p>
<p>A:</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">test</span>(<span class="hljs-string">'å¼‚æ­¥å‡½æ•°æµ‹è¯•'</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">asyncFunction</span>();
  <span class="hljs-title function_">expect</span>(result).<span class="hljs-title function_">toBe</span>(expected);
});
</code></pre>
<h3 data-id="heading-67">ä»£ç è´¨é‡å·¥å…·ç›¸å…³é—®é¢˜</h3>
<p><strong>Q: ESLint å’Œ Prettier å†²çªæ€ä¹ˆåŠï¼Ÿ</strong></p>
<p>A: å®‰è£… <code>eslint-config-prettier</code>ï¼Œåœ¨ ESLint extends ä¸­æœ€åæ·»åŠ  <code>'plugin:prettier/recommended'</code></p>
<p><strong>Q: å¦‚ä½•å¿½ç•¥æŸäº›æ–‡ä»¶çš„æ£€æŸ¥ï¼Ÿ</strong></p>
<p>A: åœ¨ <code>.eslintignore</code> å’Œ <code>.prettierignore</code> ä¸­æ·»åŠ æ–‡ä»¶è·¯å¾„</p>
<p><strong>Q: å¦‚ä½•è‡ªå®šä¹‰ ESLint è§„åˆ™ï¼Ÿ</strong></p>
<p>A: åœ¨ <code>.eslintrc.js</code> çš„ <code>rules</code> å­—æ®µä¸­æ·»åŠ è‡ªå®šä¹‰è§„åˆ™</p>
<h3 data-id="heading-68">Git Hooks ç›¸å…³é—®é¢˜</h3>
<p><strong>Q: simple-git-hooks å’Œ husky å¦‚ä½•é€‰æ‹©ï¼Ÿ</strong></p>
<p>A:</p>
<ul>
<li><strong>simple-git-hooks</strong>ï¼šé€‚åˆç®€å•é¡¹ç›®ï¼Œé›¶é…ç½®ï¼Œè½»é‡çº§</li>
<li><strong>husky</strong>ï¼šé€‚åˆå¤æ‚é¡¹ç›®ï¼Œéœ€è¦ç²¾ç»†æ§åˆ¶å’Œè·¨å¹³å°æ”¯æŒ</li>
</ul>
<p><strong>Q: Git Hooks ä¸ç”Ÿæ•ˆæ€ä¹ˆåŠï¼Ÿ</strong></p>
<p>A:</p>
<ul>
<li>æ£€æŸ¥ <code>prepare</code> è„šæœ¬æ˜¯å¦å·²æ‰§è¡Œï¼š<code>npm run prepare</code></li>
<li>æ£€æŸ¥ <code>.git/hooks</code> ç›®å½•æ˜¯å¦å­˜åœ¨é’©å­æ–‡ä»¶</li>
<li>ç¡®ä¿é’©å­æ–‡ä»¶æœ‰æ‰§è¡Œæƒé™ï¼š<code>chmod +x .husky/pre-commit</code></li>
</ul>
<p><strong>Q: å¦‚ä½•è·³è¿‡ Git Hooksï¼Ÿ</strong></p>
<p>A:</p>
<ul>
<li>è·³è¿‡ pre-commitï¼š<code>git commit --no-verify</code></li>
<li>è·³è¿‡ commit-msgï¼š<code>git commit --no-verify -m "message"</code></li>
<li>âš ï¸ ä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒè·³è¿‡ï¼Œä¼šç ´åä»£ç è´¨é‡ä¿éšœ</li>
</ul>
<p><strong>Q: å¦‚ä½•åœ¨ monorepo ä¸­ä½¿ç”¨ Git Hooksï¼Ÿ</strong></p>
<p>A:</p>
<ul>
<li><strong>simple-git-hooks</strong>ï¼šåœ¨æ ¹ç›®å½•é…ç½®ï¼Œè‡ªåŠ¨åº”ç”¨åˆ°æ‰€æœ‰å­åŒ…</li>
<li><strong>husky</strong>ï¼šåœ¨æ ¹ç›®å½•é…ç½®ï¼Œä½¿ç”¨ <code>pnpm -r</code> æˆ– <code>turbo</code> æ‰¹é‡æ‰§è¡Œ</li>
</ul>
<hr/>
<h2 data-id="heading-69">å‚è€ƒèµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftsup.egoist.dev%2F" target="_blank" title="https://tsup.egoist.dev/" ref="nofollow noopener noreferrer">tsup æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvitest.dev%2F" target="_blank" title="https://vitest.dev/" ref="nofollow noopener noreferrer">Vitest æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Feslint.org%2F" target="_blank" title="https://eslint.org/" ref="nofollow noopener noreferrer">ESLint æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fprettier.io%2F" target="_blank" title="https://prettier.io/" ref="nofollow noopener noreferrer">Prettier æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Frollupjs.org%2F" target="_blank" title="https://rollupjs.org/" ref="nofollow noopener noreferrer">Rollup æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fjestjs.io%2F" target="_blank" title="https://jestjs.io/" ref="nofollow noopener noreferrer">Jest æ–‡æ¡£</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenStack Train éƒ¨ç½²å®æˆ˜ï¼ˆä¸€ï¼‰ï¼šåŒèŠ‚ç‚¹åŸºç¡€ç¯å¢ƒæ­å»º]]></title>    <link>https://juejin.cn/post/7577309505711308863</link>    <guid>https://juejin.cn/post/7577309505711308863</guid>    <pubDate>2025-11-28T03:42:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577309505711308863" data-draft-id="7577364921656475690" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenStack Train éƒ¨ç½²å®æˆ˜ï¼ˆä¸€ï¼‰ï¼šåŒèŠ‚ç‚¹åŸºç¡€ç¯å¢ƒæ­å»º"/> <meta itemprop="keywords" content="OpenStack"/> <meta itemprop="datePublished" content="2025-11-28T03:42:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xy12306"/> <meta itemprop="url" content="https://juejin.cn/user/2232425500384467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenStack Train éƒ¨ç½²å®æˆ˜ï¼ˆä¸€ï¼‰ï¼šåŒèŠ‚ç‚¹åŸºç¡€ç¯å¢ƒæ­å»º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2232425500384467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xy12306
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T03:42:05.000Z" title="Fri Nov 28 2025 03:42:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p>å‚è€ƒåŸæ–‡ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openstack.org%2Finstall-guide%2Findex.html" target="_blank" title="https://docs.openstack.org/install-guide/index.html" ref="nofollow noopener noreferrer">docs.openstack.org/install-guiâ€¦</a> -----OpenStack å®‰è£… æŒ‡å—</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openstack.org%2Finstall-guide%2Fenvironment-networking.html" target="_blank" title="https://docs.openstack.org/install-guide/environment-networking.html" ref="nofollow noopener noreferrer">docs.openstack.org/install-guiâ€¦</a> ------ä¸»æœºç½‘ç»œé…ç½®æŒ‡å—</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€ å®‰è£…ä¸¤å°centos7æœåŠ¡å™¨</h2>
<p>å®‰è£…è™šæ‹Ÿæœºå‚è€ƒä»¥ä¸‹æ•™ç¨‹ï¼š</p>
<ul>
<li><a href="https://juejin.cn/post/7449325898703683595" target="_blank" title="https://juejin.cn/post/7449325898703683595">Vmwareè™šæ‹Ÿæœºä¸­å®‰è£…CentOS7ï¼ˆè¶…è¯¦å›¾æ–‡æ•™ç¨‹ï¼‰</a></li>
</ul>
<p>å»ºè®®æœ€å°åŒ–å®‰è£…centos7 ï¼ˆåœ¨Windowsä¸Šçš„VMwareä¸­å®‰è£…å³å¯ï¼‰ï¼›</p>





















<table><thead><tr><th>ç¯å¢ƒé•œåƒ</th><th>CentOS7.9</th></tr></thead><tbody><tr><td>ç¡¬ç›˜</td><td>40GåŠä»¥ä¸Š</td></tr><tr><td>è¿è¡Œå†…å­˜</td><td>8G</td></tr><tr><td>å¤„ç†å™¨</td><td>6GåŠä»¥ä¸Š</td></tr></tbody></table>
<hr/>

















<table><thead><tr><th>ä¸»æœºå</th><th>IP åœ°å€</th></tr></thead><tbody><tr><td>controller</td><td>192.168.44.150</td></tr><tr><td>compute1</td><td>192.168.44.151</td></tr></tbody></table>
<p>è¦æ±‚ï¼š</p>
<ol>
<li>ä¸¤å°ä¸»æœºéƒ½å†æ·»åŠ ä¸€å—ç½‘å¡ï¼ˆæ·»åŠ åä¸€å…±ä¸¤å—ç½‘å¡ï¼Œå»ºè®®ç¬¬ä¸€å—ä½¿ç”¨NATï¼Œç¬¬äºŒå—ä½¿ç”¨æ¡¥æ¥ï¼‰</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db2b519a2f944bd09f2b787393e4b12f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeHkxMjMwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764907550&amp;x-signature=5hLQK9r3vqXAc7lqhCNkW5twAc0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€ åŸºç¡€ç¯å¢ƒå‡†å¤‡</h2>
<blockquote>
<p>åŸºç¡€ç¯å¢ƒå‡†å¤‡ï¼Œ2 ä¸ªèŠ‚ç‚¹å‡éœ€é…ç½®</p>
</blockquote>
<h3 data-id="heading-2">1ã€åˆ‡æ¢ yum æºä¸ºé˜¿é‡Œï¼ˆåŒèŠ‚ç‚¹ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¤‡ä»½</span>
<span class="hljs-built_in">mv</span> /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup

<span class="hljs-comment"># åˆ‡æ¢ yumæº ä¸ºé˜¿é‡Œäº‘        </span>
curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo
yum makecache
</code></pre>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å§‹å‰è¦ç¡®ä¿æœ‰ä»¥ä¸‹å·¥å…·</span>
yum -y install vim
yum -y install wget
</code></pre>
<h3 data-id="heading-3">2ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openstack.org%2Finstall-guide%2Fenvironment-networking-controller.html" target="_blank" title="https://docs.openstack.org/install-guide/environment-networking-controller.html" ref="nofollow noopener noreferrer">è®¾ç½®é™æ€ IP åœ°å€</a></h3>
<h4 data-id="heading-4">â¡ï¸â¡ï¸ controllerèŠ‚ç‚¹ â¬…ï¸â¬…ï¸</h4>
<p><strong>1. ä¿®æ”¹ç½‘ç»œé…ç½®æ–‡ä»¶</strong></p>
<pre><code class="hljs language-bash" lang="bash">ip add show   <span class="hljs-comment"># æŸ¥çœ‹IPåœ°å€</span>
ip <span class="hljs-built_in">link</span> show  <span class="hljs-comment"># å…ˆç¡®è®¤æ‰€æœ‰å¯ç”¨ç½‘å¡</span>
<span class="hljs-built_in">ls</span> /etc/sysconfig/network-scripts/ifcfg-*  <span class="hljs-comment"># ç¡®ä¿é…ç½®ä¸ç‰©ç†è®¾å¤‡åŒ¹é…</span>
</code></pre>
<blockquote>
<p>å¦‚æœæ²¡æœ‰ç½‘å¡æ²¡æœ‰è‡ªåŠ¨å¯åŠ¨ï¼Œè¾“å…¥ <strong><code>ifup ens33</code></strong> <strong>å¯åŠ¨ç½‘å¡ã€‚</strong></p>
</blockquote>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è¦†ç›–å†™å…¥é™æ€ IP é…ç½®ï¼ˆæ³¨æ„æ›¿æ¢æ¥å£åå’Œç½‘ç»œå‚æ•°ï¼‰</span>
sudo tee /etc/sysconfig/network-scripts/ifcfg-ens33 &lt;&lt; EOF
<span class="hljs-attr">TYPE</span>=Ethernet
<span class="hljs-attr">BOOTPROTO</span>=static
<span class="hljs-attr">NAME</span>=ens33
<span class="hljs-attr">DEVICE</span>=ens33
<span class="hljs-attr">ONBOOT</span>=<span class="hljs-literal">yes</span>
<span class="hljs-attr">IPADDR</span>=<span class="hljs-number">192.168</span>.<span class="hljs-number">44.150</span>
<span class="hljs-attr">NETMASK</span>=<span class="hljs-number">255.255</span>.<span class="hljs-number">255.0</span>
<span class="hljs-attr">GATEWAY</span>=<span class="hljs-number">192.168</span>.<span class="hljs-number">44.2</span>
<span class="hljs-attr">DNS1</span>=<span class="hljs-number">114.114</span>.<span class="hljs-number">114.114</span>
<span class="hljs-attr">DNS2</span>=<span class="hljs-number">223.5</span>.<span class="hljs-number">5.5</span>
EOF

sudo tee /etc/sysconfig/network-scripts/ifcfg-ens34 &lt;&lt; EOF
<span class="hljs-attr">TYPE</span>=Ethernet
<span class="hljs-attr">BOOTPROTO</span>=none
<span class="hljs-attr">DEVICE</span>=ens34
<span class="hljs-attr">ONBOOT</span>=<span class="hljs-literal">yes</span>
EOF


<span class="hljs-comment"># é‡å¯ç½‘ç»œæœåŠ¡</span>
systemctl restart network

<span class="hljs-comment"># éªŒè¯ IP é…ç½®</span>
ip addr show ens33
ip addr show ens34
</code></pre>
<blockquote>
<p>ä¸‹é¢compute1 èŠ‚ç‚¹çš„IPé…ç½®æ–¹æ³•åŒä¸Šï¼Œåªä¸è¿‡IPæ”¹ä¸º192.168.44.151</p>
</blockquote>
<h4 data-id="heading-5">â¡ï¸â¡ï¸ compute1 èŠ‚ç‚¹ â¬…ï¸â¬…ï¸</h4>
<p><strong>1. ä¿®æ”¹ç½‘ç»œé…ç½®æ–‡ä»¶</strong></p>
<pre><code class="hljs language-bash" lang="bash">ip <span class="hljs-built_in">link</span> show  <span class="hljs-comment"># å…ˆç¡®è®¤æ‰€æœ‰å¯ç”¨ç½‘å¡</span>
<span class="hljs-built_in">ls</span> /etc/sysconfig/network-scripts/ifcfg-*  <span class="hljs-comment"># ç¡®ä¿é…ç½®ä¸ç‰©ç†è®¾å¤‡åŒ¹é…</span>
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è¦†ç›–å†™å…¥é™æ€ IP é…ç½®ï¼ˆæ³¨æ„æ›¿æ¢æ¥å£åå’Œç½‘ç»œå‚æ•°ï¼‰</span>
sudo tee /etc/sysconfig/network-scripts/ifcfg-ens33 &lt;&lt; EOF
<span class="hljs-attr">TYPE</span>=Ethernet
<span class="hljs-attr">BOOTPROTO</span>=static
<span class="hljs-attr">NAME</span>=ens33
<span class="hljs-attr">DEVICE</span>=ens33
<span class="hljs-attr">ONBOOT</span>=<span class="hljs-literal">yes</span>
<span class="hljs-attr">IPADDR</span>=<span class="hljs-number">192.168</span>.<span class="hljs-number">44.151</span>
<span class="hljs-attr">NETMASK</span>=<span class="hljs-number">255.255</span>.<span class="hljs-number">255.0</span>
<span class="hljs-attr">GATEWAY</span>=<span class="hljs-number">192.168</span>.<span class="hljs-number">44.2</span>
<span class="hljs-attr">DNS1</span>=<span class="hljs-number">114.114</span>.<span class="hljs-number">114.114</span>
<span class="hljs-attr">DNS2</span>=<span class="hljs-number">223.5</span>.<span class="hljs-number">5.5</span>
EOF

sudo tee /etc/sysconfig/network-scripts/ifcfg-ens34 &lt;&lt; EOF
<span class="hljs-attr">TYPE</span>=Ethernet
<span class="hljs-attr">BOOTPROTO</span>=none
<span class="hljs-attr">DEVICE</span>=ens34
<span class="hljs-attr">ONBOOT</span>=<span class="hljs-literal">yes</span>
EOF


<span class="hljs-comment"># é‡å¯ç½‘ç»œæœåŠ¡</span>
systemctl restart network

<span class="hljs-comment"># éªŒè¯ IP é…ç½®</span>
ip addr show ens33
ip addr show ens34
</code></pre>
<h3 data-id="heading-6">3ã€ä¿®æ”¹ä¸»æœºå + ä¸»æœºåæ˜ å°„ï¼ˆåŒèŠ‚ç‚¹ï¼‰</h3>
<ul>
<li><strong>controller</strong> <strong>èŠ‚ç‚¹</strong></li>
</ul>

<pre><code class="hljs language-bash" lang="bash">hostnamectl set-hostname controller

<span class="hljs-comment"># ä¿®æ”¹/etc/hostsæ–‡ä»¶</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"192.168.44.150 controller"</span> &gt;&gt; /etc/hosts
<span class="hljs-built_in">echo</span> <span class="hljs-string">"192.168.44.151 compute1"</span> &gt;&gt; /etc/hosts
</code></pre>
<ul>
<li><strong>compute1 èŠ‚ç‚¹</strong></li>
</ul>

<pre><code class="hljs language-bash" lang="bash">hostnamectl set-hostname compute1

<span class="hljs-comment"># ä¿®æ”¹/etc/hostsæ–‡ä»¶</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"192.168.44.150 controller"</span> &gt;&gt; /etc/hosts
<span class="hljs-built_in">echo</span> <span class="hljs-string">"192.168.44.151 compute1"</span> &gt;&gt; /etc/hosts
</code></pre>
<h3 data-id="heading-7">4ã€å…³é—­é˜²ç«å¢™å¹¶ç¦ç”¨ SELinuxï¼ˆåŒèŠ‚ç‚¹ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…³é—­é˜²ç«å¢™</span>
systemctl stop firewalld
systemctl <span class="hljs-built_in">disable</span> firewalld
setenforce 0

<span class="hljs-comment"># ç¦ç”¨ SELinux</span>
sed -i <span class="hljs-string">'/^SELINUX/s/enforcing/disabled/'</span> /etc/selinux/config

<span class="hljs-comment"># æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span>
systemctl status firewalld
</code></pre>
<h3 data-id="heading-8">5ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openstack.org%2Finstall-guide%2Fenvironment-ntp-controller.html" target="_blank" title="https://docs.openstack.org/install-guide/environment-ntp-controller.html" ref="nofollow noopener noreferrer">è®¾ç½®æ—¶åŒºåŒæ­¥</a></h3>
<h4 data-id="heading-9"><strong>ğŸ¥ğŸ¥</strong> <strong>controller èŠ‚ç‚¹</strong> <strong>ğŸ¥ğŸ¥</strong></h4>
<ul>
<li>ä¿®æ”¹ chrony.conf æ–‡ä»¶</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">sudo yum install chrony

<span class="hljs-comment"># ä¿®æ”¹chrony.confæ–‡ä»¶</span>
vim /etc/chrony.conf
</code></pre>
<ul>
<li>å‚è€ƒä¸‹å›¾ä¿®æ”¹</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31d55718ebed4dc4b4fdea4a31afc9a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeHkxMjMwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764907550&amp;x-signature=4BoNryznOehn5IAYKFHXKSQjXBw%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>é‡å¯</strong> <strong>æœåŠ¡å¹¶éªŒè¯æ—¶åŒºåŒæ­¥</strong></li>
</ul>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é‡å¯ Chrony æœåŠ¡</span>
systemctl restart chronyd
systemctl <span class="hljs-built_in">enable</span> chronyd

<span class="hljs-comment"># æŸ¥çœ‹æ—¶åŒºè®¾ç½®</span>
timedatectl

<span class="hljs-comment"># éªŒè¯æ—¶åŒºåŒæ­¥</span>
chronyc sources
</code></pre>
<h4 data-id="heading-10"><strong>ğŸ¥ğŸ¥</strong> <strong>compute1 èŠ‚ç‚¹</strong> <strong>ğŸ¥ğŸ¥</strong></h4>
<ul>
<li>ä¿®æ”¹ chrony.conf æ–‡ä»¶</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">sudo yum install chrony

<span class="hljs-comment"># ä¿®æ”¹chrony.confæ–‡ä»¶</span>
vim /etc/chrony.conf
</code></pre>
<ul>
<li>å‚è€ƒä¸‹å›¾ä¿®æ”¹</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4fbae3ea52a41e8b7f27ecb342edb6f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeHkxMjMwNg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764907550&amp;x-signature=aZWYoXklsOFPAnubp6fqwWezZ%2B8%3D" alt="" loading="lazy"/></p>
<ul>
<li>é‡å¯æœåŠ¡å¹¶éªŒè¯æ—¶åŒºåŒæ­¥</li>
</ul>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é‡å¯ Chrony æœåŠ¡</span>
systemctl restart chronyd
systemctl <span class="hljs-built_in">enable</span> chronyd

<span class="hljs-comment"># æŸ¥çœ‹æ—¶åŒºè®¾ç½®</span>
timedatectl

<span class="hljs-comment"># éªŒè¯æ—¶åŒºåŒæ­¥</span>
chronyc sources
</code></pre>
<h3 data-id="heading-11">6ã€å®‰è£… openstack package ï¼ˆ åŒèŠ‚ç‚¹ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">yum install -y centos-release-openstack-train

<span class="hljs-comment"># å…ˆè¿›å…¥yum.repos.dæ–‡ä»¶å¤¹ä¸‹</span>
<span class="hljs-built_in">cd</span>  /etc/yum.repos.d
</code></pre>
<blockquote>
<p>ç”±äº2024å¹´6æœˆåï¼Œcentos7.9 å®˜ç½‘å·²ä¸å†ç»´æŠ¤,ä¿®æ”¹æˆå›½å†…é•œåƒæº</p>
<ol>
<li>å°†baseurlå‰çš„#å·åˆ é™¤, å¹¶å°†ç½‘å€æ”¹ä¸º <a href="https://link.juejin.cn?target=http%3A%2F%2Fmirrors.aliyun.com" target="_blank" title="http://mirrors.aliyun.com" ref="nofollow noopener noreferrer">mirrors.aliyun.com</a></li>
<li>ç”¨#å·æ³¨é‡Šæ‰ mirrorlist è¡Œ</li>
</ol>
<p>âš ï¸æ³¨æ„ <a href="https://link.juejin.cn?target=http%3A%2F%2Fmirrors.aliyun.com" target="_blank" title="http://mirrors.aliyun.com" ref="nofollow noopener noreferrer">mirrors.aliyun.com</a> é“¾æ¥è¦ä¿®æ”¹æ­£ç¡®ã€‚</p>
<p>âš ï¸ mirroråé¢è¦åŠ  â€œ s â€œ æ”¹ä¸º mirrors</p>
</blockquote>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¤‡ä»½å•ä¸ªæ–‡ä»¶ï¼ˆæ¯ä¸ªæ–‡ä»¶ç”Ÿæˆä¸€ä¸ª .bak å‰¯æœ¬ï¼‰</span>
sudo <span class="hljs-built_in">cp</span> CentOS-OpenStack-train.repo CentOS-OpenStack-train.repo.bak
sudo <span class="hljs-built_in">cp</span> CentOS-Ceph-Nautilus.repo CentOS-Ceph-Nautilus.repo.bak
sudo <span class="hljs-built_in">cp</span> CentOS-NFS-Ganesha-28.repo CentOS-NFS-Ganesha-28.repo.bak
sudo <span class="hljs-built_in">cp</span> CentOS-QEMU-EV.repo CentOS-QEMU-EV.repo.bak
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 1. å–æ¶ˆæ³¨é‡Š baseurl è¡Œï¼Œå¹¶æ›¿æ¢ä¸ºé˜¿é‡Œäº‘é•œåƒåœ°å€</span>
<span class="hljs-comment"># 2. æ³¨é‡Š mirrorlist è¡Œ</span>
sudo sed -i \
  -e 's|^<span class="hljs-comment">#baseurl=http://mirror.centos.org/(.*)|baseurl=http://mirrors.aliyun.com/\1|' \</span>
  -e 's|^<span class="hljs-attr">mirrorlist</span>=.*|<span class="hljs-comment">#&amp;|' \</span>
  CentOS-OpenStack-train.repo
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 1. æ³¨é‡Šmirrorlistè¡Œï¼Œ</span>
<span class="hljs-comment"># 2. å–æ¶ˆæ³¨é‡Šbaseurlè¡Œï¼Œå¹¶æ›¿æ¢ä¸ºé˜¿é‡Œäº‘é•œåƒ</span>
sudo sed -i \
  -e 's|^<span class="hljs-attr">mirrorlist</span>=.*|<span class="hljs-comment">#&amp;|' \</span>
  -e 's|^<span class="hljs-comment">#baseurl=http://mirror.centos.org/(.*)|baseurl=http://mirrors.aliyun.com/\1|' \</span>
  CentOS-Ceph-Nautilus.repo
</code></pre>

<pre><code class="hljs language-ini" lang="ini">sudo sed -i \
  -e 's|^<span class="hljs-attr">mirrorlist</span>=http://mirrorlist.centos.org.*|<span class="hljs-comment">#&amp;|' \</span>
  -e 's|^<span class="hljs-comment">#?baseurl=https://mirror.centos.org/(.*)|baseurl=http://mirrors.aliyun.com/\1|' \</span>
  CentOS-NFS-Ganesha-28.repo
</code></pre>

<pre><code class="hljs language-ini" lang="ini">sudo sed -i \
  -e 's|^<span class="hljs-attr">mirrorlist</span>=.*|<span class="hljs-comment">#&amp;|' \</span>
  -e 's|^<span class="hljs-comment">#baseurl=http://mirror.centos.org/(.*)|baseurl=http://mirrors.aliyun.com/\1|' \</span>
  CentOS-QEMU-EV.repo
</code></pre>
<ul>
<li>å®‰è£…OpenStackå®¢æˆ·ç«¯å’Œopenstack-selinux</li>
</ul>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”Ÿæˆç¼“å­˜</span>
yum makecache

yum install python-openstackclient -y 
yum install openstack-selinux -y
</code></pre>
<hr/>
<blockquote>
<p>ä»¥ä¸Šæ•™æä»…ä¾›å‚è€ƒï¼Œé€‚ç”¨äºåˆå­¦è€…</p>
<p>å…³æœºæ‹å®Œå¿«ç…§åå¼€å§‹è¿›è¡Œä¸‹ä¸€æ­¥é…ç½®</p>
<p>è¾“å…¥<code>shutdown -h now</code> å…³æœº</p>
</blockquote>
<h3 data-id="heading-12"><a href="https://link.juejin.cn?target=https%3A%2F%2Fhcnsseyzsztm.feishu.cn%2Fwiki%2FUmiewkdawiIaELkUEhhc5IPMnNb" target="_blank" title="https://hcnsseyzsztm.feishu.cn/wiki/UmiewkdawiIaELkUEhhc5IPMnNb" ref="nofollow noopener noreferrer">1æ§åˆ¶èŠ‚ç‚¹--å®‰è£…openstackåŸºæœ¬è½¯ä»¶å¾…æ›´æ–°åŒæ­¥</a></h3></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Harmony osâ€”â€”é•¿æ—¶ä»»åŠ¡ï¼ˆContinuous Taskï¼ŒArkTSï¼‰]]></title>    <link>https://juejin.cn/post/7577321767346470958</link>    <guid>https://juejin.cn/post/7577321767346470958</guid>    <pubDate>2025-11-28T03:39:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577321767346470958" data-draft-id="7577321767346454574" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Harmony osâ€”â€”é•¿æ—¶ä»»åŠ¡ï¼ˆContinuous Taskï¼ŒArkTSï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-28T03:39:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·46398975432"/> <meta itemprop="url" content="https://juejin.cn/user/714006150282890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Harmony osâ€”â€”é•¿æ—¶ä»»åŠ¡ï¼ˆContinuous Taskï¼ŒArkTSï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/714006150282890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·46398975432
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T03:39:08.000Z" title="Fri Nov 28 2025 03:39:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Harmony osâ€”â€”é•¿æ—¶ä»»åŠ¡ï¼ˆContinuous Taskï¼ŒArkTSï¼‰</h2>
<blockquote>
<p>ä¸€å¥è¯ï¼š <strong>å‰å°ï¼åå°é•¿æœŸè·‘ã€ç”¨æˆ·èƒ½æ„ŸçŸ¥çš„ä¸šåŠ¡ï¼ˆéŸ³ä¹ã€å¯¼èˆªã€ä¸‹è½½ã€å½•å±â€¦ï¼‰ â†’ å¿…é¡»ç”³è¯·ã€Œé•¿æ—¶ä»»åŠ¡ã€ï¼Œå¦åˆ™ä¸€é€€åå°å°±è¢«æŒ‚èµ·/é™éŸ³/æ€è¿›ç¨‹ã€‚</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-1">1. é•¿æ—¶ä»»åŠ¡å¹²å˜›ç”¨ï¼Ÿ</h3>
<p>å…¸å‹åœºæ™¯ï¼ˆç”¨æˆ·èƒ½æ˜æ˜¾æ„Ÿè§‰åˆ°ä½ è¿˜åœ¨å¹²æ´»ï¼‰ï¼š</p>
<ul>
<li>ğŸµ åå°æ’­æ”¾éŸ³ä¹ / æ’­æ”¾è§†é¢‘ / æŠ•å±æ’­æ”¾</li>
<li>ğŸ“¡ å¯¼èˆªã€å®æ—¶å®šä½</li>
<li>ğŸ¤ å½•éŸ³ / å½•å±é€€åå°ç»§ç»­å½•</li>
<li>ğŸ“¤ åå°é•¿æ—¶é—´ä¸Šä¼  / ä¸‹è½½</li>
<li>ğŸ”µ è“ç‰™ä¼ æ–‡ä»¶ã€è½¦é’¥åŒ™</li>
<li>ğŸ”— å¤šè®¾å¤‡äº’è”ã€åˆ†å¸ƒå¼æŠ•å±</li>
<li>ğŸ“ éŸ³è§†é¢‘é€šè¯ï¼ˆVoIPï¼‰</li>
<li>ğŸ›¡ PC/2in1 ä¸Šçš„æ€æ¯’ã€DLP ç­‰æŒç»­è®¡ç®—ä»»åŠ¡</li>
</ul>
<p>åªè¦ä½ <strong>é€€åˆ°åå°è¿˜è¦é•¿æ—¶é—´è·‘</strong>ï¼Œå¹¶ä¸”æ˜¯<strong>ç”¨æˆ·å¯æ„ŸçŸ¥çš„ä¸šåŠ¡</strong> â†’ å°±è¦é…å¥—ç”³è¯·å¯¹åº”ç±»å‹çš„é•¿æ—¶ä»»åŠ¡ã€‚</p>
<hr/>
<h3 data-id="heading-2">2. é•¿æ—¶ä»»åŠ¡ç±»å‹æ€»è§ˆï¼ˆä¸€å®šè¦è®°ä½è¿™å¼ è¡¨ï¼‰</h3>


















































<table><thead><tr><th>ç±»å‹å¸¸é‡</th><th>é…ç½®é¡¹å­—æ®µ</th><th>å…¸å‹åœºæ™¯ä¸¾ä¾‹</th></tr></thead><tbody><tr><td><code>DATA_TRANSFER</code></td><td><code>dataTransfer</code></td><td>æµè§ˆå™¨/ç½‘ç›˜åå°ä¸Šä¼ ä¸‹è½½ï¼ˆéæ‰˜ç®¡ä¸‹è½½ï¼‰</td></tr><tr><td><code>AUDIO_PLAYBACK</code></td><td><code>audioPlayback</code></td><td>éŸ³è§†é¢‘æ’­æ”¾ã€æŠ•æ’­ã€æ¸¸æˆéŸ³é¢‘ç­‰ï¼ˆéœ€æ¥å…¥ AVSessionï¼‰</td></tr><tr><td><code>AUDIO_RECORDING</code></td><td><code>audioRecording</code></td><td>å½•éŸ³ã€å½•å±é€€åå°</td></tr><tr><td><code>LOCATION</code></td><td><code>location</code></td><td>åå°å®šä½ / å¯¼èˆª</td></tr><tr><td><code>BLUETOOTH_INTERACTION</code></td><td><code>bluetoothInteraction</code></td><td>è“ç‰™ä¼ æ–‡ä»¶ã€è½¦é’¥åŒ™</td></tr><tr><td><code>MULTI_DEVICE_CONNECTION</code></td><td><code>multiDeviceConnection</code></td><td>åˆ†å¸ƒå¼ä¸šåŠ¡ã€å¤šè®¾å¤‡äº’è”ã€æŠ•æ’­ï¼ˆå…ƒæœåŠ¡ä¹Ÿå¯ç”¨ï¼‰</td></tr><tr><td><code>VOIP</code></td><td><code>voip</code></td><td>éŸ³è§†é¢‘é€šè¯é€€åå°</td></tr><tr><td><code>TASK_KEEPING</code></td><td><code>taskKeeping</code></td><td>æ€æ¯’ã€DLP ç­‰è®¡ç®—ä»»åŠ¡ï¼ˆPC/2in1 ä¸ºä¸»ï¼Œéœ€ç‰¹æƒ ACLï¼‰</td></tr></tbody></table>
<h4 data-id="heading-3">ä¸€äº›ç‰¹åˆ«è¯´æ˜ï¼ˆé«˜é¢‘å‘ç‚¹ï¼‰</h4>
<ul>
<li>
<p><strong>DATA_TRANSFER</strong></p>
<ul>
<li>
<p>å¦‚æœç”¨ã€Œä¸Šä¼ /ä¸‹è½½ä»£ç†æ¥å£æ‰˜ç®¡ç»™ç³»ç»Ÿã€ï¼Œï¼Œé‚£ä½ ç”³è¯· <code>DATA_TRANSFER</code> ä¹Ÿæ²¡ç”¨ï¼Œé€€åå°è¿˜æ˜¯ä¼šæŒ‚èµ·ã€‚</p>
</li>
<li>
<p>å¦‚æœè‡ªå·±å®ç°ä¼ è¾“é€»è¾‘ â†’ å¯ä»¥ç”³è¯· <code>DATA_TRANSFER</code>ã€‚</p>
</li>
<li>
<p>å¿…é¡»<strong>å®šæœŸæ›´æ–°ä¼ è¾“è¿›åº¦</strong>ï¼ˆé¦–æ¬¡æ›´æ–°ä¸èƒ½è¶…è¿‡ 10 åˆ†é’Ÿï¼‰ï¼Œå¦åˆ™é•¿æ—¶ä»»åŠ¡ä¼šè¢«ç³»ç»Ÿå–æ¶ˆã€‚</p>
<blockquote>
<p>è¿›åº¦è¦é€šè¿‡<strong>å®å†µçª—é€šçŸ¥</strong>æ›´æ–°ï¼Œè¯¦è§ <code>startBackgroundRunning</code> é‡Œçš„ç¤ºä¾‹ã€‚</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p><strong>AUDIO_PLAYBACK</strong></p>
<ul>
<li>
<p>åª’ä½“ç±»å‹ï¼ˆ<code>STREAM_USAGE_MUSIC/MOVIE/AUDIOBOOK/GAME</code>ï¼‰åå°æ’­æ”¾ â†’ å¿…é¡»ï¼š</p>
<ol start="0">
<li>æ¥å…¥ AVSession</li>
<li>ç”³è¯· <code>AUDIO_PLAYBACK</code> é•¿æ—¶ä»»åŠ¡</li>
</ol>
</li>
<li>
<p>å¦åˆ™ï¼š</p>
<ul>
<li>é€€åå°ä¼šè¢« <strong>é™éŸ³ + å†»ç»“</strong>ï¼Œåªæœ‰åˆ‡å›å‰å°æ‰æ¢å¤ã€‚</li>
</ul>
</li>
<li>
<p>ä» API 20 èµ·ï¼š</p>
<ul>
<li>å¦‚æœæ²¡æ¥å…¥ AVSession ä½†ç”³è¯·äº† <code>AUDIO_PLAYBACK</code> â†’ ç”±åå°ä»»åŠ¡æ¨¡å—åœ¨é€šçŸ¥æ æ˜¾ç¤ºé€šçŸ¥ã€‚</li>
<li>å¦‚æœæ¥å…¥äº† AVSession â†’ é€šçŸ¥æ”¹ç”± AVSession å‘ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-4">3. çº¦æŸ &amp; ç³»ç»Ÿç®¡æ§é€»è¾‘</h3>
<h4 data-id="heading-5">3.1 è°èƒ½ç”³è¯·ï¼Ÿ</h4>
<ul>
<li>
<p><strong>Stage æ¨¡å‹</strong>ï¼šåªèƒ½åœ¨ <strong>UIAbility</strong> é‡Œç”³è¯·ã€‚</p>
</li>
<li>
<p><strong>FA æ¨¡å‹</strong>ï¼šåªèƒ½åœ¨ <strong>ServiceAbility</strong> é‡Œç”³è¯·ã€‚</p>
</li>
<li>
<p>æ”¯æŒï¼š</p>
<ul>
<li>å½“å‰åº”ç”¨è‡ªå·±ç”³è¯·</li>
<li>è·¨è®¾å¤‡ / è·¨åº”ç”¨ç”³è¯· â†’ <strong>åªå¯¹ç³»ç»Ÿåº”ç”¨å¼€æ”¾</strong>ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">3.2 æ•°é‡é™åˆ¶ï¼ˆç‰ˆæœ¬å·®å¼‚ï¼‰</h4>
<ul>
<li>
<p><strong>API 21 èµ·</strong>ï¼š</p>
<ul>
<li>ä¸€ä¸ª UIAbility <strong>åŒæ—¶æœ€å¤šå¯ç”³è¯· 10 ä¸ªé•¿æ—¶ä»»åŠ¡</strong>ã€‚</li>
<li>ç”¨çš„æ˜¯æ–°ç‰ˆæ¥å£ï¼š <code>startBackgroundRunning(context, request: ContinuousTaskRequest)</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>API 20 åŠä»¥å‰</strong>ï¼š</p>
<ul>
<li>ä¸€ä¸ª UIAbility / ServiceAbility <strong>åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªé•¿æ—¶ä»»åŠ¡</strong>ã€‚</li>
<li>å¦‚æœä¸€ä¸ªåº”ç”¨éœ€è¦å¤šä¸ªé•¿æ—¶ä»»åŠ¡ â†’ å¾—å¼€å¤šä¸ª UIAbility æ¥ç”³è¯·ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>ä½†æ³¨æ„ï¼šåªè¦<strong>å…¶ä¸­ä¸€ä¸ª UIAbility ç”³è¯·äº†é•¿æ—¶ä»»åŠ¡</strong>ï¼Œæ•´ä¸ªåº”ç”¨ä¸‹çš„è¿›ç¨‹éƒ½ä¸ä¼šè¢«æŒ‚èµ·ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-7">3.3 ç³»ç»Ÿä½•æ—¶ä¼šã€ŒåŠ¨åˆ€ã€ç®¡ä½ çš„åº”ç”¨ï¼Ÿ</h4>
<p>ç”³è¯·é•¿æ—¶ä»»åŠ¡ â‰  æ°¸ä¹…è±å…ï¼Œç³»ç»Ÿä¼šåšä¸€è‡´æ€§æ ¡éªŒï¼š</p>
<ol start="0">
<li>
<p><strong>ç”³è¯·äº†ä½†ä¸å¹²å¯¹åº”çš„æ´»</strong></p>
<ul>
<li>ä¾‹å¦‚ï¼šç”³è¯· <code>AUDIO_PLAYBACK</code>ï¼Œä½†å®é™…æ²¡æœ‰æ’­æ”¾ä»»ä½•éŸ³é¢‘/è§†é¢‘ã€‚ â†’ åº”ç”¨é€€åå°æ—¶ï¼Œä¼šè¢«æŒ‚èµ·ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¸šåŠ¡ç±»å‹å’Œç”³è¯·ä¸ä¸€è‡´</strong></p>
<ul>
<li>åªç”³è¯·äº† <code>AUDIO_PLAYBACK</code>ï¼Œå®é™…åœ¨åå°è¿˜åšå½•éŸ³ï¼ˆåº”è¯¥ç”³è¯· <code>AUDIO_RECORDING</code>ï¼‰ã€‚ â†’ ç³»ç»Ÿåˆ¤å®šè¿è§„ï¼ŒåŒæ ·ä¼šæŒ‚èµ·ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¸šåŠ¡å·²ç»ç»“æŸè¿˜ä¸å–æ¶ˆ</strong></p>
<ul>
<li>æ¯”å¦‚ç”¨æˆ·æ‰‹åŠ¨æš‚åœéŸ³ä¹ï¼Œä½ é•¿æ—¶ä»»åŠ¡è¿˜æŒ‚ç€ä¸å…³ã€‚ â†’ ç³»ç»Ÿæ£€æµ‹åˆ°ä¸šåŠ¡ä¸å†å‘ç”Ÿï¼Œä¼šæŒ‚èµ·ã€‚</li>
</ul>
</li>
<li>
<p><strong>åå°è´Ÿè½½è¿‡é«˜</strong></p>
<ul>
<li>é•¿æ—¶ä»»åŠ¡å±äºã€Œç”¨æˆ·å¯æ„ŸçŸ¥+èµ„æºæœ‰é™ã€æ¨¡å¼ï¼Œç³»ç»Ÿä¼šæ ¹æ®å…¸å‹è´Ÿè½½å®¡æŸ¥ã€‚</li>
<li>å¦‚æœè¿›ç¨‹é•¿æœŸé«˜è´Ÿè½½ï¼Œä¸ç¬¦åˆè¯¥ç±»å‹åˆç†è¡Œä¸º â†’ å¯èƒ½è¢«æŒ‚èµ·æˆ–ç›´æ¥ç»ˆæ­¢ã€‚</li>
</ul>
</li>
<li>
<p><strong>åå°æ’­æ”¾éŸ³é¢‘æ—¶è¢«æ‰“æ–­</strong></p>
<ul>
<li>è¢«ç³»ç»Ÿæˆ–å…¶ä»–äº‹ä»¶æ‰“æ–­æ—¶é•¿æ—¶ä»»åŠ¡ä¼šè¢«åœã€‚</li>
<li>éŸ³é¢‘é‡æ–°æ’­æ”¾ â†’ ä½ è¦é‡æ–°ç”³è¯·é•¿æ—¶ä»»åŠ¡ã€‚</li>
</ul>
</li>
</ol>
<blockquote>
<p>é‡ç‚¹ï¼š<strong>ä»»åŠ¡ç»“æŸä¸€å®šè¦ä¸»åŠ¨ stopï¼Œä¸è¦æŒ¨ç³»ç»Ÿçš„åˆ€ã€‚</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-8">4. é€šçŸ¥æ  &amp; ç”¨æˆ·æ§åˆ¶æƒ</h3>
<ul>
<li>
<p>ç”³è¯·é•¿æ—¶ä»»åŠ¡æˆåŠŸåï¼š</p>
<ul>
<li>é€šçŸ¥æ ä¼šæ˜¾ç¤ºã€Œæ­£åœ¨è¿è¡Œå½•åˆ¶ä»»åŠ¡ / æ’­æ”¾ä»»åŠ¡â€¦ã€ä¹‹ç±»çš„é€šçŸ¥ã€‚</li>
<li>ç”¨æˆ·<strong>æ‰‹åŠ¨åˆ é™¤é€šçŸ¥</strong> â†’ ç³»ç»Ÿä¼šè‡ªåŠ¨åœæ­¢è¿™æ¡é•¿æ—¶ä»»åŠ¡ã€‚</li>
</ul>
</li>
<li>
<p>å¯¹éŸ³é¢‘æ’­æ”¾ï¼š</p>
<ul>
<li>åœæ­¢é•¿æ—¶ä»»åŠ¡æ—¶ï¼Œä½ ä¹Ÿè¦æŠŠéŸ³é¢‘æµåœæ‰ï¼Œä¸ç„¶ç³»ç»Ÿå¯èƒ½ä¼š<strong>å¼ºåˆ¶ç»ˆæ­¢åº”ç”¨</strong>ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-9">5. å…³é”® API æ€»è§ˆï¼ˆ<code>backgroundTaskManager</code>ï¼‰</h3>
<blockquote>
<p>æ¨¡å—ï¼š <code>@kit.BackgroundTasksKit</code> + <code>@kit.AbilityKit</code> ä¸­çš„ <code>wantAgent</code></p>
</blockquote>
<h4 data-id="heading-10">5.1 æ—§ç‰ˆï¼šä¸€ä¸ª UIAbility ä¸€ä¸ªä»»åŠ¡</h4>
<pre><code class="hljs language-php" lang="php">Â <span class="hljs-title function_ invoke__">startBackgroundRunning</span>(<span class="hljs-attr">context</span>: Context, <span class="hljs-attr">bgMode</span>: BackgroundMode, <span class="hljs-attr">wantAgent</span>: WantAgent): Promise&lt;<span class="hljs-keyword">void</span>&gt;;
Â â€‹
Â <span class="hljs-title function_ invoke__">stopBackgroundRunning</span>(<span class="hljs-attr">context</span>: Context): Promise&lt;<span class="hljs-keyword">void</span>&gt;;
</code></pre>
<ul>
<li><code>bgMode</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•°ç»„ï¼ˆå¦‚ <code>"audioRecording"</code>ã€<code>"audioPlayback"</code>â€¦ï¼‰</li>
<li>ç”¨äº API 20 åŠä»¥å‰çš„ã€Œå•ä»»åŠ¡æ¨¡å¼ã€ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-11">5.2 æ–°ç‰ˆï¼šæ”¯æŒå¤šä¸ªè¿ç»­ä»»åŠ¡ï¼ˆAPI 21ï¼‰</h4>
<pre><code class="hljs language-php" lang="php">Â <span class="hljs-title function_ invoke__">startBackgroundRunning</span>(<span class="hljs-attr">context</span>: Context, <span class="hljs-attr">request</span>: ContinuousTaskRequest): Promise&lt;ContinuousTaskNotification&gt;;
Â â€‹
Â <span class="hljs-title function_ invoke__">stopBackgroundRunning</span>(<span class="hljs-attr">context</span>: Context, <span class="hljs-attr">continuousTaskId</span>: number): Promise&lt;<span class="hljs-keyword">void</span>&gt;;
</code></pre>
<ul>
<li><code>ContinuousTaskRequest</code>ï¼šå¯ä»¥ä¸€æ¬¡æ€§é…ç½®å¤šä¸ªç±»å‹ï¼Œæ¯”å¦‚ï¼š<code>["audioPlayback", "location"]</code></li>
<li>è¿”å› <code>ContinuousTaskNotification</code>ï¼Œé‡Œé¢æœ‰ <code>notificationId</code> ç­‰ä¿¡æ¯ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-12">5.3 ç›‘å¬é•¿æ—¶ä»»åŠ¡è¢«ç³»ç»Ÿå–æ¶ˆ</h4>
<pre><code class="hljs language-javascript" lang="javascript">Â backgroundTaskManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"continuousTaskCancel"</span>, <span class="hljs-function">(<span class="hljs-params">info</span>) =&gt;</span> {
Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Canceled task id: '</span> + info.<span class="hljs-property">id</span>);
Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Reason: '</span> + info.<span class="hljs-property">reason</span>);
Â });
Â â€‹
Â backgroundTaskManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"continuousTaskCancel"</span>, callback); <span class="hljs-comment">// å–æ¶ˆç›‘å¬</span>
</code></pre>
<blockquote>
<p>åœºæ™¯ï¼šæ¯”å¦‚è¢«ç³»ç»Ÿåˆ¤æ–­ä¸ç¬¦åˆè§„åˆ™ï¼Œæˆ–ç”¨æˆ·æ¸…æ‰é€šçŸ¥æ  â†’ ä¼šè§¦å‘è¿™ä¸ªå›è°ƒã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-13">6. å½•åˆ¶åœºæ™¯ç¤ºä¾‹ï¼ˆå½•éŸ³/å½•å±ï¼‰</h3>
<h4 data-id="heading-14">6.1 é…ç½®æƒé™ &amp; åå°æ¨¡å¼ï¼ˆmodule.json5ï¼‰</h4>
<pre><code class="hljs language-json" lang="json">Â <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
Â   <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â   <span class="hljs-punctuation">{</span>
Â  Â  Â   <span class="hljs-comment">// ... ä½ çš„ EntryAbility / MainAbility ...</span>
Â  Â  Â   <span class="hljs-attr">"backgroundModes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â   <span class="hljs-string">"audioRecording"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â   <span class="hljs-string">"bluetoothInteraction"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â   <span class="hljs-string">"audioPlayback"</span>
Â  Â  Â   <span class="hljs-punctuation">]</span>
Â  Â   <span class="hljs-punctuation">}</span>
Â   <span class="hljs-punctuation">]</span>
Â <span class="hljs-punctuation">}</span>
</code></pre>
<p>è¿˜è¦åœ¨å·¥ç¨‹é‡Œå£°æ˜æƒé™ï¼š<code>ohos.permission.KEEP_BACKGROUND_RUNNING</code>ï¼ˆç³»ç»Ÿæƒé™é…ç½®å¤„ï¼‰ã€‚</p>
<hr/>
<h4 data-id="heading-15">6.2 å…³é”®ä»£ç æ‹†è§£ï¼ˆthen å†™æ³•ï¼‰</h4>
<blockquote>
<p>æŒ‰é’®ç‚¹å‡» â†’ ç”³è¯·å½•åˆ¶é•¿æ—¶ä»»åŠ¡ â†’ é€šçŸ¥æ å‡ºä¸€æ¡â€œæ­£åœ¨å½•åˆ¶â€ â†’ ç‚¹å‡»å¦ä¸€æŒ‰é’®å–æ¶ˆã€‚</p>
</blockquote>
<pre><code class="hljs language-typescript" lang="typescript">Â <span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;
Â <span class="hljs-keyword">import</span> { wantAgent, <span class="hljs-title class_">WantAgent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;
Â <span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;
Â â€‹
Â <span class="hljs-keyword">function</span> <span class="hljs-title function_">continuousTaskCancelCallback</span>(<span class="hljs-params">info: backgroundTaskManager.ContinuousTaskCancelInfo</span>) {
Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'ContinuousTask canceled, id: '</span> + info.<span class="hljs-property">id</span>);
Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Reason: '</span> + info.<span class="hljs-property">reason</span>);
Â }
Â â€‹
Â <span class="hljs-meta">@Entry</span>
Â <span class="hljs-meta">@Component</span>
Â struct <span class="hljs-title class_">Index</span> {
Â   <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'ContinuousTask'</span>;
Â   <span class="hljs-keyword">private</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>();
Â â€‹
Â   <span class="hljs-comment">// æ³¨å†Œä»»åŠ¡å–æ¶ˆå›è°ƒ</span>
Â   <span class="hljs-title class_">OnContinuousTaskCancel</span>() {
Â  Â   <span class="hljs-keyword">try</span> {
Â  Â  Â   backgroundTaskManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">'continuousTaskCancel'</span>, continuousTaskCancelCallback);
Â  Â   } <span class="hljs-keyword">catch</span> (error) {
Â  Â  Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`OnContinuousTaskCancel failed. code: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span>, msg: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);
Â  Â   }
Â   }
Â â€‹
Â   <span class="hljs-comment">// å–æ¶ˆæ³¨å†Œ</span>
Â   <span class="hljs-title class_">OffContinuousTaskCancel</span>() {
Â  Â   <span class="hljs-keyword">try</span> {
Â  Â  Â   backgroundTaskManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">'continuousTaskCancel'</span>, continuousTaskCancelCallback);
Â  Â   } <span class="hljs-keyword">catch</span> (error) {
Â  Â  Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`OffContinuousTaskCancel failed. code: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span>, msg: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);
Â  Â   }
Â   }
Â â€‹
Â   <span class="hljs-comment">// ç”³è¯·é•¿æ—¶ä»»åŠ¡ï¼ˆå½•åˆ¶ç±»ï¼‰</span>
Â   <span class="hljs-title function_">startContinuousTask</span>(<span class="hljs-params"/>) {
Â  Â   <span class="hljs-keyword">const</span> <span class="hljs-attr">info</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {
Â  Â  Â   <span class="hljs-attr">wants</span>: [
Â  Â  Â  Â   {
Â  Â  Â  Â  Â   <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,
Â  Â  Â  Â  Â   <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MainAbility'</span>
Â  Â  Â  Â   }
Â  Â  Â   ],
Â  Â  Â   <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITY</span>,
Â  Â  Â   <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,
Â  Â  Â   <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>],
Â  Â   };
Â â€‹
Â  Â   wantAgent.<span class="hljs-title function_">getWantAgent</span>(info).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">agent: WantAgent</span>) =&gt;</span> {
Â  Â  Â   <span class="hljs-keyword">const</span> <span class="hljs-attr">list</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt; = [<span class="hljs-string">'audioRecording'</span>]; <span class="hljs-comment">// å½•åˆ¶é•¿æ—¶ä»»åŠ¡</span>
Â  Â  Â   backgroundTaskManager.<span class="hljs-title function_">startBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>!, list, agent)
Â  Â  Â  Â   .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
Â  Â  Â  Â  Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startBackgroundRunning succeeded'</span>);
Â  Â  Â  Â  Â   <span class="hljs-comment">// è¿™é‡Œå¼€å§‹çœŸæ­£çš„å½•åˆ¶é€»è¾‘ï¼ˆå½•éŸ³/å½•å±ç­‰ï¼‰</span>
Â  Â  Â  Â   })
Â  Â  Â  Â   .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
Â  Â  Â  Â  Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startBackgroundRunning failed. code: <span class="hljs-subst">${err.code}</span>, msg: <span class="hljs-subst">${err.message}</span>`</span>);
Â  Â  Â  Â   });
Â  Â   }).<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
Â  Â  Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`getWantAgent failed. code: <span class="hljs-subst">${err.code}</span>, msg: <span class="hljs-subst">${err.message}</span>`</span>);
Â  Â   });
Â   }
Â â€‹
Â   <span class="hljs-comment">// å–æ¶ˆé•¿æ—¶ä»»åŠ¡</span>
Â   <span class="hljs-title function_">stopContinuousTask</span>(<span class="hljs-params"/>) {
Â  Â   backgroundTaskManager.<span class="hljs-title function_">stopBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>!)
Â  Â  Â   .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
Â  Â  Â  Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'stopBackgroundRunning succeeded'</span>);
Â  Â  Â  Â   <span class="hljs-comment">// åŒæ—¶è¦åœæ­¢å½•åˆ¶é€»è¾‘</span>
Â  Â  Â   })
Â  Â  Â   .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
Â  Â  Â  Â   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`stopBackgroundRunning failed. code: <span class="hljs-subst">${err.code}</span>, msg: <span class="hljs-subst">${err.message}</span>`</span>);
Â  Â  Â   });
Â   }
Â â€‹
Â   <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
Â  Â   <span class="hljs-title class_">Row</span>() {
Â  Â  Â   <span class="hljs-title class_">Column</span>() {
Â  Â  Â  Â   <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Index'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>).<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
Â â€‹
Â  Â  Â  Â   <span class="hljs-title class_">Button</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ç”³è¯·é•¿æ—¶ä»»åŠ¡'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">25</span>).<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>))
Â  Â  Â  Â  Â   .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })
Â  Â  Â  Â  Â   .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#0D9FFB'</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">width</span>(<span class="hljs-number">250</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startContinuousTask</span>())
Â â€‹
Â  Â  Â  Â   <span class="hljs-title class_">Button</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Text</span>(<span class="hljs-string">'å–æ¶ˆé•¿æ—¶ä»»åŠ¡'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">25</span>).<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>))
Â  Â  Â  Â  Â   .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })
Â  Â  Â  Â  Â   .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#0D9FFB'</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">width</span>(<span class="hljs-number">250</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stopContinuousTask</span>())
Â â€‹
Â  Â  Â  Â   <span class="hljs-title class_">Button</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æ³¨å†Œé•¿æ—¶ä»»åŠ¡å–æ¶ˆå›è°ƒ'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">25</span>).<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>))
Â  Â  Â  Â  Â   .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })
Â  Â  Â  Â  Â   .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#0D9FFB'</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">width</span>(<span class="hljs-number">250</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">OnContinuousTaskCancel</span>())
Â â€‹
Â  Â  Â  Â   <span class="hljs-title class_">Button</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Text</span>(<span class="hljs-string">'å–æ¶ˆæ³¨å†Œé•¿æ—¶ä»»åŠ¡å–æ¶ˆå›è°ƒ'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">25</span>).<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>))
Â  Â  Â  Â  Â   .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })
Â  Â  Â  Â  Â   .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#0D9FFB'</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">width</span>(<span class="hljs-number">250</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
Â  Â  Â  Â  Â   .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">OffContinuousTaskCancel</span>())
Â  Â  Â   }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
Â  Â   }.<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
Â   }
Â }
</code></pre>
<hr/>
<h3 data-id="heading-16">7. å’Œã€ŒçŸ­æ—¶ä»»åŠ¡ã€çš„å¯¹æ¯”å°ç»“ï¼ˆå¸®ä½ ä¸€èµ·è®°ï¼‰</h3>








































<table><thead><tr><th>å¯¹æ¯”ç‚¹</th><th>çŸ­æ—¶ä»»åŠ¡ï¼ˆrequestSuspendDelayï¼‰</th><th>é•¿æ—¶ä»»åŠ¡ï¼ˆstartBackgroundRunningï¼‰</th></tr></thead><tbody><tr><td>ç”¨é€”</td><td>åº”ç”¨å³å°†è¢«æŒ‚èµ·å‰ï¼Œäº‰å–ä¸€ç‚¹ç‚¹æ—¶é—´åšæ”¶å°¾</td><td>é€€åå°åé•¿æœŸæŒç»­è·‘ä¸šåŠ¡ï¼ˆéŸ³ä¹ / å¯¼èˆª / ä¸‹è½½ / é€šè¯ç­‰ï¼‰</td></tr><tr><td>æ—¶é—´å°ºåº¦</td><td>å•æ¬¡æœ€å¤šå‡ åˆ†é’Ÿï¼Œæ€»é…é¢ 10 åˆ†é’Ÿ / å¤©å·¦å³</td><td>å¯é•¿æ—¶é—´è¿è¡Œï¼Œåªè¦ä»»åŠ¡çœŸå®ä¸”ç±»å‹åŒ¹é…</td></tr><tr><td>ç”¨æˆ·å¯æ„ŸçŸ¥</td><td>é€šå¸¸ä¸å¯æ„ŸçŸ¥ï¼ˆåªæ˜¯ä½ åœ¨åšæ”¶å°¾ï¼‰</td><td>ç”¨æˆ·æ˜æ˜¾èƒ½æ„ŸçŸ¥ï¼ˆæ’­æ”¾ã€å¯¼èˆªã€ä¸‹è½½ã€é€šè¯â€¦ï¼‰</td></tr><tr><td>é€šçŸ¥æ </td><td>æ— å›ºå®šé€šçŸ¥è¦æ±‚ï¼Œä¸»è¦ç³»ç»Ÿç®¡ç†</td><td>å¿…é¡»æœ‰å¯¹åº”é€šçŸ¥ï¼ˆæˆ–ç”± AVSession ç®¡ï¼‰ï¼Œç”¨æˆ·å¯æ‰‹åŠ¨åœæ­¢</td></tr><tr><td>å…¸å‹è§¦å‘ç‚¹</td><td>å‰å°æˆ– <code>onBackground</code> å›è°ƒæ—¶</td><td>ä¸€èˆ¬åœ¨ç”¨æˆ·å¼€å§‹æŸä¸ªé•¿æœŸä»»åŠ¡æ—¶ï¼ˆæ’­æ”¾æŒ‰é’®ã€å¼€å§‹å¯¼èˆªç­‰ï¼‰</td></tr><tr><td>æ ¸å¿ƒé£é™©</td><td>è¶…æ—¶ä¸ cancel ä¼šè¢«ç®¡æ§</td><td>ç”³è¯·ç±»å‹ä¸ä¸šåŠ¡ä¸ä¸€è‡´ / ä¸šåŠ¡å·²ç»“æŸä¸ cancel ä¼šè¢«ç®¡æ§</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§å±æ€§èƒ½ä¼˜åŒ–ç»ˆææ–¹æ¡ˆï¼šè¯·æ±‚åˆå¹¶+æ™ºèƒ½ç¼“å­˜åŒå‰‘åˆç’§]]></title>    <link>https://juejin.cn/post/7577284771447242792</link>    <guid>https://juejin.cn/post/7577284771447242792</guid>    <pubDate>2025-11-28T03:10:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577284771447242792" data-draft-id="7577307409854087183" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§å±æ€§èƒ½ä¼˜åŒ–ç»ˆææ–¹æ¡ˆï¼šè¯·æ±‚åˆå¹¶+æ™ºèƒ½ç¼“å­˜åŒå‰‘åˆç’§"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-11-28T03:10:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŠ±ç´_"/> <meta itemprop="url" content="https://juejin.cn/user/2808622275126188"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§å±æ€§èƒ½ä¼˜åŒ–ç»ˆææ–¹æ¡ˆï¼šè¯·æ±‚åˆå¹¶+æ™ºèƒ½ç¼“å­˜åŒå‰‘åˆç’§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2808622275126188/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŠ±ç´_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T03:10:00.000Z" title="Fri Nov 28 2025 03:10:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    17
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ‰¿æ¥ä¸Šä¸€ç¯‡ã€Š<a href="https://juejin.cn/post/7577049352839381007" target="_blank" title="https://juejin.cn/post/7577049352839381007">å¤§å±æ€§èƒ½ä¼˜åŒ–é»‘ç§‘æŠ€ï¼šVue 3 ä¸­å®ç°è¯·æ±‚åˆå¹¶ï¼Œè®©ä½ çš„å¤§å±é£èµ·æ¥ï¼</a>ã€‹ï¼Œæˆ‘ä»¬å·²ç»æŒæ¡äº†è¯·æ±‚åˆå¹¶æŠ€æœ¯ï¼Œè§£å†³äº†åŒæ—¶å‘èµ·çš„ç›¸åŒè¯·æ±‚é—®é¢˜ã€‚ä½†è¿™è¿˜ä¸å¤Ÿï¼ä»Šå¤©ï¼Œæˆ‘ä»¬å°†å¼•å…¥æ™ºèƒ½ç¼“å­˜ï¼Œæ‰“é€ å¤§å±æ€§èƒ½ä¼˜åŒ–çš„ç»ˆæè§£å†³æ–¹æ¡ˆï¼</p>
</blockquote>
<h2 data-id="heading-0">ğŸš¨ å¤§å±æ€§èƒ½çš„ç¬¬äºŒé“åï¼šçŸ­æ—¶é—´é‡å¤è¯·æ±‚</h2>
<p>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬è§£å†³äº†<strong>åŒæ—¶å‘èµ·çš„ç›¸åŒè¯·æ±‚</strong>é—®é¢˜ï¼Œä½†å¤§å±åº”ç”¨è¿˜æœ‰å¦ä¸€ä¸ªæ€§èƒ½æ€æ‰‹ï¼š</p>
<p><strong>çŸ­æ—¶é—´å†…é‡å¤å‘èµ·çš„ç›¸åŒè¯·æ±‚</strong></p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼š</p>
<ul>
<li>å¤§å±æ¯10ç§’è‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡æ•°æ®</li>
<li>ç”¨æˆ·é¢‘ç¹åˆ‡æ¢ç»„ä»¶æˆ–æ ‡ç­¾é¡µ</li>
<li>æŸäº›æ“ä½œè§¦å‘å¤šæ¬¡ç›¸åŒè¯·æ±‚</li>
</ul>
<p>å³ä½¿ä½¿ç”¨äº†è¯·æ±‚åˆå¹¶ï¼Œè¿™äº›<strong>éåŒæ—¶</strong>çš„é‡å¤è¯·æ±‚ä»ç„¶ä¼šå‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œæµªè´¹èµ„æºï¼</p>
<h2 data-id="heading-1">âœ¨ è§£å†³æ–¹æ¡ˆï¼šè¯·æ±‚åˆå¹¶+æ™ºèƒ½ç¼“å­˜åŒå‰‘åˆç’§</h2>
<p><strong>æ™ºèƒ½ç¼“å­˜</strong>æ˜¯è¯·æ±‚åˆå¹¶çš„å®Œç¾æ­æ¡£ï¼š</p>
<ul>
<li><strong>è¯·æ±‚åˆå¹¶</strong>ï¼šè§£å†³<strong>åŒæ—¶</strong>å‘èµ·çš„ç›¸åŒè¯·æ±‚</li>
<li><strong>æ™ºèƒ½ç¼“å­˜</strong>ï¼šè§£å†³<strong>çŸ­æ—¶é—´å†…é‡å¤</strong>å‘èµ·çš„ç›¸åŒè¯·æ±‚</li>
</ul>
<p>ä¸¤è€…ç»“åˆï¼Œå¯ä»¥<strong>è¦†ç›–å‡ ä¹æ‰€æœ‰é‡å¤è¯·æ±‚åœºæ™¯</strong>ï¼Œè®©ä½ çš„å¤§å±åº”ç”¨è¾¾åˆ°æè‡´æ€§èƒ½ï¼</p>
<h3 data-id="heading-2">å·¥ä½œåŸç†æµç¨‹å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[å‘èµ·è¯·æ±‚] --&gt; B{æ£€æŸ¥ç¼“å­˜}
    B --&gt;|ç¼“å­˜å‘½ä¸­| C[ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®]
    B --&gt;|ç¼“å­˜æœªå‘½ä¸­| D{æ£€æŸ¥æ˜¯å¦æœ‰ç›¸åŒè¯·æ±‚æ­£åœ¨è¿›è¡Œ}
    D --&gt;|æœ‰| E[ç­‰å¾…å¹¶å¤ç”¨ç°æœ‰è¯·æ±‚ç»“æœ]
    D --&gt;|æ— | F[åˆ›å»ºæ–°çš„è¯·æ±‚Promise]
    F --&gt; G[å­˜å‚¨è¯·æ±‚Promiseåˆ°pendingRequests]
    G --&gt; H[å‘èµ·ç½‘ç»œè¯·æ±‚]
    H --&gt; I[è·å–å“åº”æ•°æ®]
    I --&gt; J[å­˜å‚¨æ•°æ®åˆ°ç¼“å­˜]
    J --&gt; K[ä»pendingRequestsåˆ é™¤è¯·æ±‚]
    K --&gt; L[è°ƒç”¨resolveå‡½æ•°å®Œæˆæ‰€æœ‰ç­‰å¾…çš„Promise]
    L --&gt; M[è¿”å›å“åº”æ•°æ®]
    E --&gt; M
    C --&gt; N[è¯·æ±‚å®Œæˆ]
    M --&gt; N
</code></pre>
<p>è¿™ä¸ªæµç¨‹å›¾å±•ç¤ºäº†è¯·æ±‚åˆå¹¶+æ™ºèƒ½ç¼“å­˜çš„å®Œæ•´å·¥ä½œæµç¨‹ï¼š</p>
<ol>
<li>å½“å‘èµ·è¯·æ±‚æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥ç¼“å­˜</li>
<li>å¦‚æœç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›ç¼“å­˜æ•°æ®</li>
<li>å¦‚æœç¼“å­˜æœªå‘½ä¸­ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ç›¸åŒè¯·æ±‚æ­£åœ¨è¿›è¡Œ</li>
<li>å¦‚æœæœ‰ï¼Œç­‰å¾…å¹¶å¤ç”¨ç°æœ‰è¯·æ±‚ç»“æœ</li>
<li>å¦‚æœæ²¡æœ‰ï¼Œåˆ›å»ºæ–°çš„è¯·æ±‚Promiseå¹¶å­˜å‚¨åˆ°pendingRequests</li>
<li>å‘èµ·ç½‘ç»œè¯·æ±‚</li>
<li>è·å–å“åº”æ•°æ®åï¼Œå­˜å‚¨åˆ°ç¼“å­˜</li>
<li>ä»pendingRequestsåˆ é™¤è¯·æ±‚</li>
<li>è°ƒç”¨resolveå‡½æ•°å®Œæˆæ‰€æœ‰ç­‰å¾…çš„Promise</li>
<li>è¿”å›å“åº”æ•°æ®</li>
<li>è¯·æ±‚å®Œæˆ</li>
</ol>
<h2 data-id="heading-3">ğŸ› ï¸ æ ¸å¿ƒå®ç°ï¼šå››å¤§æ–‡ä»¶æ‰“é€ å®Œæ•´è§£å†³æ–¹æ¡ˆ</h2>
<p>æˆ‘ä»¬å°†é€šè¿‡å››ä¸ªæ ¸å¿ƒæ–‡ä»¶å®ç°è¿™ä¸ªç»ˆææ–¹æ¡ˆï¼š</p>
<ol>
<li><strong><code>cache.js</code></strong> - æ™ºèƒ½ç¼“å­˜ç®¡ç†ä¸­å¿ƒ</li>
<li><strong><code>axios.js</code></strong> - Axiosè¯·æ±‚åˆå¹¶+ç¼“å­˜æ‹¦æˆªå™¨</li>
<li><strong><code>fetch.js</code></strong> - Fetch APIè¯·æ±‚åˆå¹¶+ç¼“å­˜åŒ…è£…</li>
<li><strong><code>index.js</code></strong> - ç»Ÿä¸€APIæœåŠ¡å…¥å£</li>
</ol>
<h3 data-id="heading-4">1. æ™ºèƒ½ç¼“å­˜ç®¡ç†ä¸­å¿ƒï¼š<code>cache.js</code></h3>
<p>CacheManageræ˜¯æ•´ä¸ªæ–¹æ¡ˆçš„æ ¸å¿ƒï¼Œæ”¯æŒï¼š</p>
<ul>
<li>âœ… å†…å­˜ç¼“å­˜ + å¤–éƒ¨å­˜å‚¨ï¼ˆlocalStorage/sessionStorageï¼‰</li>
<li>âœ… å¯é…ç½®çš„ç¼“å­˜è¿‡æœŸæ—¶é—´</li>
<li>âœ… è‡ªåŠ¨æ¸…é™¤è¿‡æœŸç¼“å­˜</li>
<li>âœ… ç¼“å­˜é”®è‡ªåŠ¨ç”Ÿæˆ</li>
<li>âœ… ç¼“å­˜ä¿¡æ¯æŸ¥è¯¢</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheManager</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultExpireTime</span> = options.<span class="hljs-property">defaultExpireTime</span> || <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// é»˜è®¤5åˆ†é’Ÿ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span> = options.<span class="hljs-property">storage</span> || <span class="hljs-literal">null</span>; <span class="hljs-comment">// å¯é€‰çš„å¤–éƒ¨å­˜å‚¨ï¼Œå¦‚localStorage</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">prefix</span> = options.<span class="hljs-property">prefix</span> || <span class="hljs-string">'cache_'</span>;
  }

  <span class="hljs-comment">/**
   * ç”Ÿæˆç¼“å­˜é”®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">key</span> - åŸå§‹é”®å
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">params</span> - è¯·æ±‚å‚æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} ç”Ÿæˆçš„ç¼“å­˜é”®
   */</span>
  <span class="hljs-title function_">generateKey</span>(<span class="hljs-params">key, params = {}</span>) {
    <span class="hljs-keyword">const</span> paramsStr = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params);
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.prefix}</span><span class="hljs-subst">${key}</span>_<span class="hljs-subst">${paramsStr}</span>`</span>;
  }

  <span class="hljs-comment">/**
   * å­˜å‚¨ç¼“å­˜æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">key</span> - ç¼“å­˜é”®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">data</span> - è¦å­˜å‚¨çš„æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">expireTime</span> - è¿‡æœŸæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ä½¿ç”¨å…¨å±€é»˜è®¤å€¼
   */</span>
  <span class="hljs-title function_">set</span>(<span class="hljs-params">key, data, expireTime = <span class="hljs-variable language_">this</span>.defaultExpireTime</span>) {
    <span class="hljs-keyword">const</span> cacheData = {
      data,
      <span class="hljs-attr">expireAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + expireTime,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    };

    <span class="hljs-comment">// å­˜å‚¨åˆ°å†…å­˜ç¼“å­˜</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">set</span>(key, cacheData);

    <span class="hljs-comment">// å¦‚æœé…ç½®äº†å¤–éƒ¨å­˜å‚¨ï¼Œä¹Ÿå­˜å‚¨åˆ°å¤–éƒ¨</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">setItem</span>(key, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(cacheData));
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å­˜å‚¨ç¼“å­˜åˆ°å¤–éƒ¨å­˜å‚¨å¤±è´¥:'</span>, error);
      }
    }
  }

  <span class="hljs-comment">/**
   * è·å–ç¼“å­˜æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">key</span> - ç¼“å­˜é”®
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">any|null</span>} ç¼“å­˜æ•°æ®ï¼Œå¦‚æœè¿‡æœŸæˆ–ä¸å­˜åœ¨åˆ™è¿”å›null
   */</span>
  <span class="hljs-title function_">get</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-comment">// å…ˆä»å†…å­˜ç¼“å­˜è·å–</span>
    <span class="hljs-keyword">let</span> cacheData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">get</span>(key);

    <span class="hljs-comment">// å¦‚æœå†…å­˜ä¸­æ²¡æœ‰ï¼Œå°è¯•ä»å¤–éƒ¨å­˜å‚¨è·å–</span>
    <span class="hljs-keyword">if</span> (!cacheData &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> storedData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">getItem</span>(key);
        <span class="hljs-keyword">if</span> (storedData) {
          cacheData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(storedData);
          <span class="hljs-comment">// åŒæ­¥åˆ°å†…å­˜ç¼“å­˜</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">set</span>(key, cacheData);
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ä»å¤–éƒ¨å­˜å‚¨è·å–ç¼“å­˜å¤±è´¥:'</span>, error);
      }
    }

    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨å’Œè¿‡æœŸ</span>
    <span class="hljs-keyword">if</span> (!cacheData) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¿‡æœŸ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &gt; cacheData.<span class="hljs-property">expireAt</span>) {
      <span class="hljs-comment">// è¿‡æœŸåˆ™åˆ é™¤</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delete</span>(key);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">return</span> cacheData.<span class="hljs-property">data</span>;
  }

  <span class="hljs-comment">/**
   * åˆ é™¤æŒ‡å®šç¼“å­˜
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">key</span> - ç¼“å­˜é”®
   */</span>
  <span class="hljs-title function_">delete</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key);
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">removeItem</span>(key);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ä»å¤–éƒ¨å­˜å‚¨åˆ é™¤ç¼“å­˜å¤±è´¥:'</span>, error);
      }
    }
  }

  <span class="hljs-comment">/**
   * æ¸…é™¤æ‰€æœ‰ç¼“å­˜
   */</span>
  <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">clear</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// åªæ¸…é™¤å¸¦æœ‰æŒ‡å®šå‰ç¼€çš„ç¼“å­˜</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-property">length</span>; i++) {
          <span class="hljs-keyword">const</span> key = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">key</span>(i);
          <span class="hljs-keyword">if</span> (key &amp;&amp; key.<span class="hljs-title function_">startsWith</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">prefix</span>)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">removeItem</span>(key);
            i--; <span class="hljs-comment">// è°ƒæ•´ç´¢å¼•ï¼Œå› ä¸ºåˆ é™¤åé•¿åº¦ä¼šå˜åŒ–</span>
          }
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ä»å¤–éƒ¨å­˜å‚¨æ¸…é™¤ç¼“å­˜å¤±è´¥:'</span>, error);
      }
    }
  }

  <span class="hljs-comment">/**
   * æ¸…é™¤æ‰€æœ‰è¿‡æœŸç¼“å­˜
   */</span>
  <span class="hljs-title function_">clearExpired</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    
    <span class="hljs-comment">// æ¸…é™¤å†…å­˜ä¸­è¿‡æœŸçš„ç¼“å­˜</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, cacheData] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">entries</span>()) {
      <span class="hljs-keyword">if</span> (now &gt; cacheData.<span class="hljs-property">expireAt</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key);
      }
    }

    <span class="hljs-comment">// æ¸…é™¤å¤–éƒ¨å­˜å‚¨ä¸­è¿‡æœŸçš„ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-property">length</span>; i++) {
          <span class="hljs-keyword">const</span> key = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">key</span>(i);
          <span class="hljs-keyword">if</span> (key &amp;&amp; key.<span class="hljs-title function_">startsWith</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">prefix</span>)) {
            <span class="hljs-keyword">const</span> cacheData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">getItem</span>(key));
            <span class="hljs-keyword">if</span> (now &gt; cacheData.<span class="hljs-property">expireAt</span>) {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">removeItem</span>(key);
              i--;
            }
          }
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ä»å¤–éƒ¨å­˜å‚¨æ¸…é™¤è¿‡æœŸç¼“å­˜å¤±è´¥:'</span>, error);
      }
    }
  }

  <span class="hljs-comment">/**
   * è·å–ç¼“å­˜ä¿¡æ¯
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">key</span> - ç¼“å­˜é”®
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">object|null</span>} ç¼“å­˜ä¿¡æ¯ï¼ŒåŒ…å«dataã€expireAtå’Œtimestampï¼Œæˆ–null
   */</span>
  <span class="hljs-title function_">getCacheInfo</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">const</span> cacheData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">get</span>(key);
    <span class="hljs-keyword">if</span> (cacheData) {
      <span class="hljs-keyword">return</span> { ...cacheData };
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> storedData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-title function_">getItem</span>(key);
        <span class="hljs-keyword">if</span> (storedData) {
          <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(storedData);
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ä»å¤–éƒ¨å­˜å‚¨è·å–ç¼“å­˜ä¿¡æ¯å¤±è´¥:'</span>, error);
      }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">// åˆ›å»ºé»˜è®¤å®ä¾‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> cacheManager = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CacheManager</span>();
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">CacheManager</span>;
</code></pre>
<h3 data-id="heading-5">2. Axiosè¯·æ±‚åˆå¹¶+ç¼“å­˜ï¼š<code>axios.js</code></h3>
<p>åœ¨Axiosæ‹¦æˆªå™¨ä¸­é›†æˆè¯·æ±‚åˆå¹¶å’Œç¼“å­˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;
<span class="hljs-keyword">import</span> { cacheManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/cache'</span>;

<span class="hljs-comment">// åˆ›å»ºaxioså®ä¾‹</span>
<span class="hljs-keyword">const</span> instance = axios.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">''</span>, <span class="hljs-comment">// æ ¹æ®å®é™…æƒ…å†µé…ç½®</span>
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
  }
});

<span class="hljs-comment">// ç”¨äºè·Ÿè¸ªæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚</span>
<span class="hljs-keyword">const</span> pendingRequests = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

<span class="hljs-comment">// è¯·æ±‚æ‹¦æˆªå™¨</span>
instance.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">cache</span> !== <span class="hljs-literal">false</span>) {
      <span class="hljs-comment">// ç”Ÿæˆç¼“å­˜é”®</span>
      <span class="hljs-keyword">const</span> cacheKey = cacheManager.<span class="hljs-title function_">generateKey</span>(
        <span class="hljs-string">`<span class="hljs-subst">${config.method}</span>_<span class="hljs-subst">${config.url}</span>`</span>,
        { <span class="hljs-attr">params</span>: config.<span class="hljs-property">params</span>, <span class="hljs-attr">data</span>: config.<span class="hljs-property">data</span> }
      );

      <span class="hljs-comment">// å°è¯•è·å–ç¼“å­˜æ•°æ®</span>
      <span class="hljs-keyword">const</span> cachedData = cacheManager.<span class="hljs-title function_">get</span>(cacheKey);
      <span class="hljs-keyword">if</span> (cachedData) {
        <span class="hljs-comment">// å¦‚æœæœ‰ç¼“å­˜ï¼Œç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼Œè·³è¿‡è¯·æ±‚</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>({
          ...config,
          <span class="hljs-attr">cached</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">data</span>: cachedData
        });
      }

      <span class="hljs-comment">// ç”Ÿæˆè¯·æ±‚é”®ï¼Œç”¨äºè·Ÿè¸ªæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚</span>
      <span class="hljs-keyword">const</span> requestKey = cacheKey;
      
      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰ç›¸åŒçš„è¯·æ±‚æ­£åœ¨è¿›è¡Œ</span>
      <span class="hljs-keyword">if</span> (pendingRequests.<span class="hljs-title function_">has</span>(requestKey)) {
        <span class="hljs-comment">// å¦‚æœæœ‰ï¼Œè¿”å›ä¸€ä¸ªPromiseï¼Œç­‰å¾…è¯¥è¯·æ±‚å®Œæˆ</span>
        <span class="hljs-keyword">return</span> pendingRequests.<span class="hljs-title function_">get</span>(requestKey);
      }

      <span class="hljs-comment">// å°†ç¼“å­˜é”®å­˜å‚¨åˆ°configä¸­ï¼Œä¾›å“åº”æ‹¦æˆªå™¨ä½¿ç”¨</span>
      config.<span class="hljs-property">cacheKey</span> = cacheKey;
      config.<span class="hljs-property">requestKey</span> = requestKey;
      <span class="hljs-comment">// å­˜å‚¨ç¼“å­˜è¿‡æœŸæ—¶é—´</span>
      config.<span class="hljs-property">cacheExpireTime</span> = config.<span class="hljs-property">cacheExpireTime</span> || <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// é»˜è®¤5åˆ†é’Ÿ</span>

      <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„Promiseï¼Œç”¨äºè·Ÿè¸ªè¯·æ±‚çŠ¶æ€</span>
      <span class="hljs-keyword">const</span> requestPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-comment">// å­˜å‚¨resolveå’Œrejectå‡½æ•°ï¼Œä¾›å“åº”æ‹¦æˆªå™¨ä½¿ç”¨</span>
        config.<span class="hljs-property">resolve</span> = resolve;
        config.<span class="hljs-property">reject</span> = reject;
      });

      <span class="hljs-comment">// å°†è¯·æ±‚Promiseå­˜å‚¨åˆ°pendingRequestsä¸­</span>
      pendingRequests.<span class="hljs-title function_">set</span>(requestKey, requestPromise);
    }

    <span class="hljs-keyword">return</span> config;
  },
  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
  }
);

<span class="hljs-comment">// å“åº”æ‹¦æˆªå™¨</span>
instance.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { config, data } = response;

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦ç¼“å­˜å’Œè¯·æ±‚åˆå¹¶</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">cache</span> !== <span class="hljs-literal">false</span> &amp;&amp; config.<span class="hljs-property">requestKey</span>) {
      <span class="hljs-comment">// å­˜å‚¨ç¼“å­˜æ•°æ®</span>
      cacheManager.<span class="hljs-title function_">set</span>(config.<span class="hljs-property">cacheKey</span>, data, config.<span class="hljs-property">cacheExpireTime</span>);

      <span class="hljs-comment">// å®Œæˆæ‰€æœ‰ç­‰å¾…è¯¥è¯·æ±‚çš„Promise</span>
      <span class="hljs-keyword">const</span> requestPromise = pendingRequests.<span class="hljs-title function_">get</span>(config.<span class="hljs-property">requestKey</span>);
      <span class="hljs-keyword">if</span> (requestPromise) {
        <span class="hljs-comment">// ä»pendingRequestsä¸­ç§»é™¤</span>
        pendingRequests.<span class="hljs-title function_">delete</span>(config.<span class="hljs-property">requestKey</span>);
        
        <span class="hljs-comment">// ä½¿ç”¨resolveå‡½æ•°å®ŒæˆPromise</span>
        <span class="hljs-keyword">if</span> (config.<span class="hljs-property">resolve</span>) {
          config.<span class="hljs-title function_">resolve</span>(response);
        }
      }
    }

    <span class="hljs-keyword">return</span> response;
  },
  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { config } = error;

    <span class="hljs-comment">// å¤„ç†è¯·æ±‚å¤±è´¥çš„æƒ…å†µ</span>
    <span class="hljs-keyword">if</span> (config &amp;&amp; config.<span class="hljs-property">requestKey</span>) {
      <span class="hljs-comment">// ä»pendingRequestsä¸­ç§»é™¤</span>
      pendingRequests.<span class="hljs-title function_">delete</span>(config.<span class="hljs-property">requestKey</span>);
      
      <span class="hljs-comment">// æ‹’ç»æ‰€æœ‰ç­‰å¾…è¯¥è¯·æ±‚çš„Promise</span>
      <span class="hljs-keyword">if</span> (config.<span class="hljs-property">reject</span>) {
        config.<span class="hljs-title function_">reject</span>(error);
      }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
  }
);

<span class="hljs-comment">/**
 * å¸¦ç¼“å­˜çš„axiosè¯·æ±‚æ–¹æ³•
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">method</span> - è¯·æ±‚æ–¹æ³•
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">url</span> - è¯·æ±‚URL
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object</span>} <span class="hljs-variable">options</span> - è¯·æ±‚é€‰é¡¹
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>} è¯·æ±‚ç»“æœ
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">request</span> = (<span class="hljs-params">method, url, options = {}</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">instance</span>({
    method,
    url,
    ...options
  });
};

<span class="hljs-comment">// å¯¼å‡ºå¸¦ç¼“å­˜çš„è¯·æ±‚æ–¹æ³•</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> axiosWithCache = {
  <span class="hljs-attr">get</span>: <span class="hljs-function">(<span class="hljs-params">url, options = {}</span>) =&gt;</span> <span class="hljs-title function_">request</span>(<span class="hljs-string">'get'</span>, url, { ...options, <span class="hljs-attr">cache</span>: options.<span class="hljs-property">cache</span> !== <span class="hljs-literal">false</span> }),
  <span class="hljs-attr">post</span>: <span class="hljs-function">(<span class="hljs-params">url, data = {}, options = {}</span>) =&gt;</span> <span class="hljs-title function_">request</span>(<span class="hljs-string">'post'</span>, url, { data, ...options, <span class="hljs-attr">cache</span>: options.<span class="hljs-property">cache</span> }),
  <span class="hljs-attr">put</span>: <span class="hljs-function">(<span class="hljs-params">url, data = {}, options = {}</span>) =&gt;</span> <span class="hljs-title function_">request</span>(<span class="hljs-string">'put'</span>, url, { data, ...options, <span class="hljs-attr">cache</span>: options.<span class="hljs-property">cache</span> }),
  <span class="hljs-attr">delete</span>: <span class="hljs-function">(<span class="hljs-params">url, options = {}</span>) =&gt;</span> <span class="hljs-title function_">request</span>(<span class="hljs-string">'delete'</span>, url, { ...options, <span class="hljs-attr">cache</span>: options.<span class="hljs-property">cache</span> }),
  <span class="hljs-attr">patch</span>: <span class="hljs-function">(<span class="hljs-params">url, data = {}, options = {}</span>) =&gt;</span> <span class="hljs-title function_">request</span>(<span class="hljs-string">'patch'</span>, url, { data, ...options, <span class="hljs-attr">cache</span>: options.<span class="hljs-property">cache</span> }),
  <span class="hljs-comment">// åŸå§‹axioså®ä¾‹ï¼Œç”¨äºä¸éœ€è¦ç¼“å­˜çš„è¯·æ±‚</span>
  instance
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> axiosWithCache;
</code></pre>
<h3 data-id="heading-6">3. Fetch APIè¯·æ±‚åˆå¹¶+ç¼“å­˜ï¼š<code>fetch.js</code></h3>
<p>ä¸ºFetch APIæä¾›ç›¸åŒçš„è¯·æ±‚åˆå¹¶å’Œç¼“å­˜åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { cacheManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/cache'</span>;

<span class="hljs-comment">// ç”¨äºè·Ÿè¸ªæ­£åœ¨è¿›è¡Œçš„fetchè¯·æ±‚</span>
<span class="hljs-keyword">const</span> pendingFetchRequests = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

<span class="hljs-comment">/**
 * å¸¦ç¼“å­˜çš„fetchè¯·æ±‚åŒ…è£…å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">url</span> - è¯·æ±‚URL
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object</span>} <span class="hljs-variable">options</span> - è¯·æ±‚é€‰é¡¹ï¼ŒåŒ…å«cacheé…ç½®
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>} è¯·æ±‚ç»“æœ
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchWithCache</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">url, options = {}</span>) =&gt; {
  <span class="hljs-keyword">const</span> {
    cache = <span class="hljs-literal">true</span>,
    cacheExpireTime = <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>, <span class="hljs-comment">// é»˜è®¤5åˆ†é’Ÿ</span>
    method = <span class="hljs-string">'GET'</span>,
    headers,
    body,
    ...restOptions
  } = options;

  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦ç¼“å­˜</span>
  <span class="hljs-keyword">if</span> (cache) {
    <span class="hljs-comment">// ç”Ÿæˆç¼“å­˜é”®</span>
    <span class="hljs-keyword">const</span> cacheKey = cacheManager.<span class="hljs-title function_">generateKey</span>(
      <span class="hljs-string">`<span class="hljs-subst">${method}</span>_<span class="hljs-subst">${url}</span>`</span>,
      { headers, <span class="hljs-attr">body</span>: body ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(body) : <span class="hljs-literal">undefined</span> }
    );

    <span class="hljs-comment">// å°è¯•è·å–ç¼“å­˜æ•°æ®</span>
    <span class="hljs-keyword">const</span> cachedData = cacheManager.<span class="hljs-title function_">get</span>(cacheKey);
    <span class="hljs-keyword">if</span> (cachedData) {
      <span class="hljs-comment">// å¦‚æœæœ‰ç¼“å­˜ï¼Œç›´æ¥è¿”å›ç¼“å­˜æ•°æ®</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(cachedData), {
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
          <span class="hljs-string">'X-Cache'</span>: <span class="hljs-string">'HIT'</span>
        }
      });
    }

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰ç›¸åŒçš„è¯·æ±‚æ­£åœ¨è¿›è¡Œ</span>
    <span class="hljs-keyword">if</span> (pendingFetchRequests.<span class="hljs-title function_">has</span>(cacheKey)) {
      <span class="hljs-comment">// å¦‚æœæœ‰ï¼Œè¿”å›æ­£åœ¨è¿›è¡Œçš„è¯·æ±‚çš„Promise</span>
      <span class="hljs-keyword">return</span> pendingFetchRequests.<span class="hljs-title function_">get</span>(cacheKey);
    }

    <span class="hljs-comment">// åˆ›å»ºè¯·æ±‚Promise</span>
    <span class="hljs-keyword">const</span> requestPromise = (<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ‰§è¡Œå®é™…çš„fetchè¯·æ±‚</span>
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url, {
          method,
          headers,
          body,
          ...restOptions
        });

        <span class="hljs-comment">// æ£€æŸ¥å“åº”æ˜¯å¦æˆåŠŸ</span>
        <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
        }

        <span class="hljs-comment">// è·å–å“åº”æ•°æ®</span>
        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();

        <span class="hljs-comment">// å­˜å‚¨ç¼“å­˜æ•°æ®</span>
        cacheManager.<span class="hljs-title function_">set</span>(cacheKey, data, cacheExpireTime);

        <span class="hljs-comment">// è¿”å›å¸¦ç¼“å­˜æ ‡è®°çš„å“åº”</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data), {
          <span class="hljs-attr">headers</span>: {
            <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
            <span class="hljs-string">'X-Cache'</span>: <span class="hljs-string">'MISS'</span>
          }
        });
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-comment">// æ— è®ºè¯·æ±‚æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä»pendingFetchRequestsä¸­ç§»é™¤</span>
        pendingFetchRequests.<span class="hljs-title function_">delete</span>(cacheKey);
      }
    })();

    <span class="hljs-comment">// å°†è¯·æ±‚Promiseå­˜å‚¨åˆ°pendingFetchRequestsä¸­</span>
    pendingFetchRequests.<span class="hljs-title function_">set</span>(cacheKey, requestPromise);

    <span class="hljs-comment">// è¿”å›è¯·æ±‚Promise</span>
    <span class="hljs-keyword">return</span> requestPromise;
  }

  <span class="hljs-comment">// ä¸éœ€è¦ç¼“å­˜ï¼Œç›´æ¥æ‰§è¡Œfetchè¯·æ±‚</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(url, options);
};

<span class="hljs-comment">/**
 * ç®€åŒ–çš„å¸¦ç¼“å­˜çš„fetch GETè¯·æ±‚
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">url</span> - è¯·æ±‚URL
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object</span>} <span class="hljs-variable">options</span> - è¯·æ±‚é€‰é¡¹
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;any&gt;</span>} è¯·æ±‚ç»“æœæ•°æ®
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getWithCache</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">url, options = {}</span>) =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchWithCache</span>(url, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
    ...options
  });
  <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();
};

<span class="hljs-comment">/**
 * ç®€åŒ–çš„å¸¦ç¼“å­˜çš„fetch POSTè¯·æ±‚
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">url</span> - è¯·æ±‚URL
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">data</span> - è¯·æ±‚æ•°æ®
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object</span>} <span class="hljs-variable">options</span> - è¯·æ±‚é€‰é¡¹
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;any&gt;</span>} è¯·æ±‚ç»“æœæ•°æ®
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">postWithCache</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">url, data = {}, options = {}</span>) =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchWithCache</span>(url, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
      ...options.<span class="hljs-property">headers</span>
    },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data),
    ...options
  });
  <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> fetchWithCache;
</code></pre>
<h3 data-id="heading-7">4. ç»Ÿä¸€APIæœåŠ¡ï¼š<code>index.js</code></h3>
<p>æä¾›ç®€æ´ç»Ÿä¸€çš„APIå…¥å£ï¼Œæ”¯æŒï¼š</p>
<ul>
<li>âœ… æ— ç¼åˆ‡æ¢Axioså’ŒFetch</li>
<li>âœ… ç»Ÿä¸€çš„ç¼“å­˜é…ç½®</li>
<li>âœ… å…¨å±€é…ç½®ç®¡ç†</li>
<li>âœ… ä¾¿æ·çš„ç¼“å­˜æ“ä½œ</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { axiosWithCache } <span class="hljs-keyword">from</span> <span class="hljs-string">'./axios'</span>;
<span class="hljs-keyword">import</span> { fetchWithCache, getWithCache, postWithCache } <span class="hljs-keyword">from</span> <span class="hljs-string">'./fetch'</span>;
<span class="hljs-keyword">import</span> { cacheManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/cache'</span>;

<span class="hljs-comment">/**
 * ç»Ÿä¸€çš„APIæœåŠ¡
 * é›†æˆäº†axioså’Œfetchçš„ç¼“å­˜åŠŸèƒ½
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> apiService = {
  <span class="hljs-comment">// Axioså¸¦ç¼“å­˜çš„è¯·æ±‚æ–¹æ³•</span>
  <span class="hljs-attr">axios</span>: {
    <span class="hljs-attr">get</span>: axiosWithCache.<span class="hljs-property">get</span>,
    <span class="hljs-attr">post</span>: axiosWithCache.<span class="hljs-property">post</span>,
    <span class="hljs-attr">put</span>: axiosWithCache.<span class="hljs-property">put</span>,
    <span class="hljs-attr">delete</span>: axiosWithCache.<span class="hljs-property">delete</span>,
    <span class="hljs-attr">patch</span>: axiosWithCache.<span class="hljs-property">patch</span>,
    <span class="hljs-attr">instance</span>: axiosWithCache.<span class="hljs-property">instance</span>
  },

  <span class="hljs-comment">// Fetchå¸¦ç¼“å­˜çš„è¯·æ±‚æ–¹æ³•</span>
  <span class="hljs-attr">fetch</span>: {
    <span class="hljs-attr">request</span>: fetchWithCache,
    <span class="hljs-attr">get</span>: getWithCache,
    <span class="hljs-attr">post</span>: postWithCache
  },

  <span class="hljs-comment">// ç¼“å­˜ç®¡ç†</span>
  <span class="hljs-attr">cache</span>: {
    <span class="hljs-attr">manager</span>: cacheManager,
    <span class="hljs-attr">clear</span>: <span class="hljs-function">() =&gt;</span> cacheManager.<span class="hljs-title function_">clear</span>(),
    <span class="hljs-attr">clearExpired</span>: <span class="hljs-function">() =&gt;</span> cacheManager.<span class="hljs-title function_">clearExpired</span>(),
    <span class="hljs-attr">delete</span>: <span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> cacheManager.<span class="hljs-title function_">delete</span>(key),
    <span class="hljs-attr">get</span>: <span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> cacheManager.<span class="hljs-title function_">get</span>(key),
    <span class="hljs-attr">set</span>: <span class="hljs-function">(<span class="hljs-params">key, data, expireTime</span>) =&gt;</span> cacheManager.<span class="hljs-title function_">set</span>(key, data, expireTime)
  },

  <span class="hljs-comment">/**
   * é…ç½®APIæœåŠ¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object</span>} <span class="hljs-variable">options</span> - é…ç½®é€‰é¡¹
   */</span>
  <span class="hljs-attr">configure</span>: <span class="hljs-function">(<span class="hljs-params">options = {}</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (options.<span class="hljs-property">baseURL</span>) {
      axiosWithCache.<span class="hljs-property">instance</span>.<span class="hljs-property">defaults</span>.<span class="hljs-property">baseURL</span> = options.<span class="hljs-property">baseURL</span>;
    }
    <span class="hljs-keyword">if</span> (options.<span class="hljs-property">timeout</span>) {
      axiosWithCache.<span class="hljs-property">instance</span>.<span class="hljs-property">defaults</span>.<span class="hljs-property">timeout</span> = options.<span class="hljs-property">timeout</span>;
    }
    <span class="hljs-keyword">if</span> (options.<span class="hljs-property">headers</span>) {
      axiosWithCache.<span class="hljs-property">instance</span>.<span class="hljs-property">defaults</span>.<span class="hljs-property">headers</span> = {
        ...axiosWithCache.<span class="hljs-property">instance</span>.<span class="hljs-property">defaults</span>.<span class="hljs-property">headers</span>,
        ...options.<span class="hljs-property">headers</span>
      };
    }
    <span class="hljs-keyword">if</span> (options.<span class="hljs-property">defaultCacheTime</span>) {
      cacheManager.<span class="hljs-property">defaultExpireTime</span> = options.<span class="hljs-property">defaultCacheTime</span>;
    }
    <span class="hljs-keyword">if</span> (options.<span class="hljs-property">storage</span>) {
      cacheManager.<span class="hljs-property">storage</span> = options.<span class="hljs-property">storage</span>;
    }
  }
};

<span class="hljs-comment">// å¯¼å‡ºå¸¸ç”¨æ–¹æ³•ï¼Œæ–¹ä¾¿ç›´æ¥ä½¿ç”¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> { axios, fetch, cache } = apiService;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> apiService;
</code></pre>
<h2 data-id="heading-8">ğŸ¯ åº”ç”¨ç¤ºä¾‹ï¼šå¤§å±ç»„ä»¶ä¸­ä½¿ç”¨</h2>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="dashboard"&gt;
    &lt;h2&gt;å¤§å±æ•°æ®å±•ç¤º&lt;/h2&gt;
    &lt;div class="data-grid"&gt;
      &lt;div class="data-card" v-for="item in dataList" :key="item.id"&gt;
        &lt;h3&gt;{{ item.title }}&lt;/h3&gt;
        &lt;div class="value"&gt;{{ item.value }}&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;button @click="refreshData"&gt;åˆ·æ–°æ•°æ®&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted } from 'vue';
import { apiService } from '../api';

const dataList = ref([]);

// è·å–æ•°æ®ï¼ˆè‡ªåŠ¨åº”ç”¨è¯·æ±‚åˆå¹¶+ç¼“å­˜ï¼‰
const fetchData = async () =&gt; {
  try {
    const response = await apiService.axios.get('/api/dashboard/data', {
      cache: true,
      cacheExpireTime: 30 * 1000 // 30ç§’ç¼“å­˜
    });
    dataList.value = response.data;
  } catch (error) {
    console.error('è·å–æ•°æ®å¤±è´¥:', error);
  }
};

// åˆ·æ–°æ•°æ®ï¼ˆåŒæ—¶å‘èµ·å¤šä¸ªç›¸åŒè¯·æ±‚ï¼Œä¼šè¢«åˆå¹¶ï¼‰
const refreshData = async () =&gt; {
  // åŒæ—¶å‘èµ·3ä¸ªç›¸åŒè¯·æ±‚ï¼Œåªä¼šæ‰§è¡Œ1æ¬¡ç½‘ç»œè¯·æ±‚
  await Promise.all([
    fetchData(),
    fetchData(),
    fetchData()
  ]);
};

onMounted(() =&gt; {
  fetchData();
  // å®šæ—¶åˆ·æ–°ï¼ˆæ¯30ç§’ï¼‰
  setInterval(fetchData, 30 * 1000);
});
&lt;/script&gt;
</code></pre>
<h2 data-id="heading-9">ğŸš€ æ€§èƒ½å¯¹æ¯”ï¼šè¯·æ±‚åˆå¹¶+ç¼“å­˜ vs ä¼ ç»Ÿè¯·æ±‚</h2>








































<table><thead><tr><th>åœºæ™¯</th><th>ä¼ ç»Ÿè¯·æ±‚</th><th>è¯·æ±‚åˆå¹¶</th><th>è¯·æ±‚åˆå¹¶+ç¼“å­˜</th><th>æ€§èƒ½æå‡</th></tr></thead><tbody><tr><td>åŒæ—¶å‘èµ·3ä¸ªç›¸åŒè¯·æ±‚</td><td>3æ¬¡è¯·æ±‚</td><td>1æ¬¡è¯·æ±‚</td><td>1æ¬¡è¯·æ±‚</td><td>66.7%</td></tr><tr><td>10ç§’å†…é‡å¤è¯·æ±‚3æ¬¡</td><td>3æ¬¡è¯·æ±‚</td><td>3æ¬¡è¯·æ±‚</td><td>1æ¬¡è¯·æ±‚</td><td>66.7%</td></tr><tr><td>1åˆ†é’Ÿå†…é‡å¤è¯·æ±‚10æ¬¡</td><td>10æ¬¡è¯·æ±‚</td><td>10æ¬¡è¯·æ±‚</td><td>1æ¬¡è¯·æ±‚</td><td>90%</td></tr><tr><td>æ•°æ®åŠ è½½é€Ÿåº¦</td><td>å–å†³äºç½‘ç»œ</td><td>å–å†³äºç½‘ç»œ</td><td>æ¯«ç§’çº§å“åº”</td><td>95%+</td></tr></tbody></table>
<h2 data-id="heading-10">ğŸ’¡ æœ€ä½³å®è·µ</h2>
<ol>
<li>
<p><strong>æ ¹æ®æ•°æ®ç±»å‹è®¾ç½®ç¼“å­˜æ—¶é—´</strong>ï¼š</p>
<ul>
<li>å®æ—¶æ•°æ®ï¼š30ç§’-5åˆ†é’Ÿ</li>
<li>åŠå®æ—¶æ•°æ®ï¼š5-30åˆ†é’Ÿ</li>
<li>é™æ€æ•°æ®ï¼š1å°æ—¶ä»¥ä¸Š</li>
</ul>
</li>
<li>
<p><strong>åˆç†ä½¿ç”¨å¤–éƒ¨å­˜å‚¨</strong>ï¼š</p>
<ul>
<li>æ•æ„Ÿæ•°æ®ï¼šä»…å†…å­˜ç¼“å­˜</li>
<li>éæ•æ„Ÿæ•°æ®ï¼šå¯ä½¿ç”¨localStorage</li>
</ul>
</li>
<li>
<p><strong>ç¼“å­˜é”®ç”Ÿæˆç­–ç•¥</strong>ï¼š</p>
<ul>
<li>åŒ…å«URLã€æ–¹æ³•ã€å‚æ•°</li>
<li>è€ƒè™‘è¯·æ±‚å¤´ï¼ˆå¦‚Authorizationï¼‰</li>
</ul>
</li>
<li>
<p><strong>ç¼“å­˜æ›´æ–°æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>æ•°æ®å˜åŒ–æ—¶ä¸»åŠ¨æ¸…é™¤ç›¸å…³ç¼“å­˜</li>
<li>å®šæœŸæ¸…ç†è¿‡æœŸç¼“å­˜</li>
</ul>
</li>
</ol>
<p>ä¸Šä¸€ç¯‡åšå®¢ã€Š<a href="https://juejin.cn/post/7577049352839381007" target="_blank" title="https://juejin.cn/post/7577049352839381007">å¤§å±æ€§èƒ½ä¼˜åŒ–é»‘ç§‘æŠ€ï¼šVue 3 ä¸­å®ç°è¯·æ±‚åˆå¹¶</a>ã€‹è§£å†³äº†<strong>åŒæ—¶å‘èµ·çš„ç›¸åŒè¯·æ±‚</strong>é—®é¢˜ï¼Œè€Œæœ¬æ–‡åœ¨æ­¤åŸºç¡€ä¸Šï¼Œé€šè¿‡å¼•å…¥<strong>æ™ºèƒ½ç¼“å­˜</strong>ï¼Œè¿›ä¸€æ­¥è§£å†³äº†<strong>çŸ­æ—¶é—´å†…é‡å¤å‘èµ·çš„ç›¸åŒè¯·æ±‚</strong>é—®é¢˜ï¼Œå½¢æˆäº†å®Œæ•´çš„å¤§å±æ€§èƒ½ä¼˜åŒ–è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-11">ğŸ‰ æ€»ç»“</h2>
<p>é€šè¿‡ç»“åˆ<strong>è¯·æ±‚åˆå¹¶</strong>å’Œ<strong>æ™ºèƒ½ç¼“å­˜</strong>ï¼Œæˆ‘ä»¬æ‰“é€ äº†å¤§å±åº”ç”¨æ€§èƒ½ä¼˜åŒ–çš„ç»ˆæè§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li><strong>å‡å°‘ç½‘ç»œè¯·æ±‚</strong>ï¼šåŒæ—¶è¯·æ±‚åˆå¹¶ï¼Œé‡å¤è¯·æ±‚ç¼“å­˜ï¼Œå‡å°‘95%ä»¥ä¸Šçš„ç½‘ç»œè¯·æ±‚</li>
<li><strong>æå‡å“åº”é€Ÿåº¦</strong>ï¼šç¼“å­˜å‘½ä¸­æ—¶æ¯«ç§’çº§å“åº”ï¼Œå¤§å¹…æå‡ç”¨æˆ·ä½“éªŒ</li>
<li><strong>é™ä½æœåŠ¡å™¨å‹åŠ›</strong>ï¼šå‡å°‘æœåŠ¡å™¨å¤„ç†çš„è¯·æ±‚æ•°é‡ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§</li>
<li><strong>ç¡®ä¿æ•°æ®ä¸€è‡´æ€§</strong>ï¼šæ‰€æœ‰ç»„ä»¶ä½¿ç”¨ç›¸åŒçš„æ•°æ®ï¼Œé¿å…æ•°æ®å†²çª</li>
<li><strong>çµæ´»é…ç½®</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰ç¼“å­˜æ—¶é—´ã€å­˜å‚¨æ–¹å¼ç­‰ï¼Œé€‚åº”ä¸åŒåœºæ™¯</li>
</ol>
<p>è¿™å¥—æ–¹æ¡ˆå·²ç»åœ¨å¤šä¸ªç”Ÿäº§å¤§å±é¡¹ç›®ä¸­éªŒè¯ï¼Œæ€§èƒ½æå‡æ•ˆæœæ˜¾è‘—ã€‚æ— è®ºæ˜¯å·¥ä¸šç›‘æ§å¤§å±ã€åŸå¸‚ç®¡ç†å¤§å±è¿˜æ˜¯é‡‘èç›‘æ§å¤§å±ï¼Œéƒ½èƒ½ä»ä¸­å—ç›Šï¼</p>
<blockquote>
<p>å¤§å±æ€§èƒ½ä¼˜åŒ–æ²¡æœ‰ç»ˆç‚¹ï¼Œåªæœ‰ä¸æ–­çš„æ¢ç´¢å’Œå®è·µã€‚è®©æˆ‘ä»¬ä¸€èµ·æ‰“é€ æ›´å¿«ã€æ›´æµç•…çš„å¤§å±åº”ç”¨ï¼ğŸš€</p>
</blockquote>
<hr/>
<p><strong>ç³»åˆ—æ–‡ç« </strong>ï¼š</p>
<ul>
<li><a href="https://juejin.cn/post/7577049352839381007" target="_blank" title="https://juejin.cn/post/7577049352839381007">å¤§å±æ€§èƒ½ä¼˜åŒ–é»‘ç§‘æŠ€ï¼šVue 3 ä¸­å®ç°è¯·æ±‚åˆå¹¶ï¼Œè®©ä½ çš„å¤§å±é£èµ·æ¥ï¼</a></li>
</ul>
<p><strong>æŠ€æœ¯äº¤æµ</strong>ï¼šæ¬¢è¿åœ¨è¯„è®ºåŒºè®¨è®ºä½ çš„å¤§å±æ€§èƒ½ä¼˜åŒ–ç»éªŒå’Œé—®é¢˜ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ”¶åˆ°å­—èŠ‚çš„çŸ­ä¿¡ï¼šTrae SOLOä¸Šçº¿äº†ï¼Ÿå°å°é²œï¼Œæµ…æµ…åšä¸ªéŸ³ä¹æ’­æ”¾å™¨]]></title>    <link>https://juejin.cn/post/7577307409854382095</link>    <guid>https://juejin.cn/post/7577307409854382095</guid>    <pubDate>2025-11-28T04:13:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577307409854382095" data-draft-id="7577256255083839497" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ”¶åˆ°å­—èŠ‚çš„çŸ­ä¿¡ï¼šTrae SOLOä¸Šçº¿äº†ï¼Ÿå°å°é²œï¼Œæµ…æµ…åšä¸ªéŸ³ä¹æ’­æ”¾å™¨"/> <meta itemprop="keywords" content="Trae,å‰ç«¯,HTML"/> <meta itemprop="datePublished" content="2025-11-28T04:13:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£æ­¢ä½•å®‰å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/2517239724512420"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ”¶åˆ°å­—èŠ‚çš„çŸ­ä¿¡ï¼šTrae SOLOä¸Šçº¿äº†ï¼Ÿå°å°é²œï¼Œæµ…æµ…åšä¸ªéŸ³ä¹æ’­æ”¾å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2517239724512420/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£æ­¢ä½•å®‰å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T04:13:42.000Z" title="Fri Nov 28 2025 04:13:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ã€å­—èŠ‚è·³åŠ¨ã€‘äº²çˆ±çš„TRAEå‹ï¼Œæ„Ÿè°¢æ‚¨çš„è€å¿ƒç­‰å¾…ã€‚TRAEä¸­å›½ç‰ˆç°å·²æ­£å¼ä¸Šçº¿SOLOæ¨¡å¼ï¼›è¯·å°†TRAEä¸­å›½ç‰ˆå‡çº§è‡³æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨æ‚¨å¡«å†™ä¸­å›½ç‰ˆå®˜ç½‘waitlistæ‰€ç”¨çš„æ‰‹æœºå·ç™»å½•ï¼Œä¾¿å¯ç«‹å³å…è´¹äº«å—SOLOå¸¦æ¥çš„å¼€å‘ä½“éªŒï¼</p>
<p>å½“æ—¶è¿˜åœ¨æƒ³æ˜¯è°å“ªä¸ªåŒå­¦çš„æ¶ä½œå‰§ï¼Œç‚¹å¼€ä¸€çœ‹çœŸçš„æ˜¯å®˜æ–¹ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1490d07d702f443ebbd2f3ed4254abdb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764908022&amp;x-signature=wWK7RYxxsiiy80yzO2TpzRQS8TE%3D" alt="1ab4c6af351dc2c54cece1748a8aad4d.jpg" loading="lazy"/></p>
<p>å½“æ—¶æ­£å¥½åœ¨å¬<strong>å‘¨æ°ä¼¦</strong>çš„<strong>çˆ±åœ¨è¥¿å…ƒå‰</strong>ï¼Œè¿™æ¶ˆæ¯ç›´æ¥æŠŠæˆ‘çš„æ‘¸é±¼æ—¶é—´æ‹æˆäº† â€œæµ…æµ…æ•´æ´»â€ æ—¶é—´ï¼šä¸å¦‚ç”¨ Trae SOLO æ­ä¸ªéŸ³ä¹æ’­æ”¾å™¨ï¼Ÿæ¯•ç«Ÿä¸»æ‰“çš„ â€œå…¨æµç¨‹æ‰“é€šâ€ï¼Œæ­£å¥½èƒ½è¯•è¯•ä»æ¶æ„åˆ°éƒ¨ç½²åˆ°åº•æœ‰å¤šä¸æ»‘ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ç”Ÿæˆå®Œæ•´æ¡†æ¶</h3>
<p>æˆ‘å…ˆå†™å¥½äº†å¤§è‡´çš„éŸ³ä¹æ’­æ”¾å™¨æ¡†æ¶ï¼Œå½“ç„¶æ˜¯éå¸¸ç®€æ˜“çš„ï¼Œå°±æ˜¯ç®€å•çš„diväº†ä¸€å †ï¼Œè§„åˆ’å¥½äº†å¸ƒå±€ã€‚</p>
<p>ç±»ä¼¼è¿™æ ·ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cbae8697582648ab869c7ad1a9e0f527~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764908022&amp;x-signature=gzffGzOqyA97Lkb4u7u44C6rDLA%3D" alt="image.png" loading="lazy"/></p>
<p>è®©SOLOå¸®æˆ‘å®Œå–„æ•´ä¸ªå¸ƒå±€ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;body&gt;
    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"music"</span>&gt;
        &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"head"</span>&gt;
            &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"back"</span>&gt;
                &lt;i <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont icon-zuojiantou"</span>&gt;&lt;/i&gt;
            &lt;/div&gt;
            &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"title"</span>&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"name"</span>&gt;çˆ±åœ¨è¥¿å…ƒå‰&lt;/div&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"author"</span>&gt;å‘¨æ°ä¼¦&lt;/div&gt;
            &lt;/div&gt;
            &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"more"</span>&gt;
                &lt;i <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont icon-sandian"</span>&gt;&lt;/i&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"main"</span>&gt;
            &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"logo"</span>&gt;
                &lt;img <span class="hljs-attr">src</span>=<span class="hljs-string">"https://img2.baidu.com/it/u=1469800619,2890014870&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500"</span> alt=<span class="hljs-string">""</span>&gt;
            &lt;/div&gt;
            &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"songs"</span>&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"song-info"</span>&gt;
                    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"song-name"</span>&gt;çˆ±åœ¨è¥¿å…ƒå‰&lt;/div&gt;
                    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"song-author"</span>&gt;å‘¨æ°ä¼¦ - èŒƒç‰¹è¥¿&lt;/div&gt;
                    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"lyric"</span>&gt;æˆ‘ç»™ä½ çš„çˆ±å†™åœ¨è¥¿å…ƒå‰&lt;/div&gt;
                &lt;/div&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"progress"</span>&gt;
                    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"time current"</span>&gt;<span class="hljs-number">1</span>:<span class="hljs-number">17</span>&lt;/div&gt;
                    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"progress-bar"</span>&gt;
                        &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"progress-inner"</span>&gt;&lt;/div&gt;
                        &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"progress-dot"</span>&gt;&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"time total"</span>&gt;<span class="hljs-number">3</span>:<span class="hljs-number">54</span>&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"control"</span>&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"prev"</span>&gt;
                    &lt;i <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont icon-shangyishou"</span>&gt;&lt;/i&gt;
                &lt;/div&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"play"</span>&gt;
                    &lt;i <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont icon-bofang"</span>&gt;&lt;/i&gt;
                &lt;/div&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"next"</span>&gt;
                    &lt;i <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont icon-xiayishou"</span>&gt;&lt;/i&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"foot"</span>&gt;
            &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"foot-left"</span>&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"foot-logo"</span>&gt;
                    &lt;img <span class="hljs-attr">src</span>=<span class="hljs-string">"https://img2.baidu.com/it/u=1469800619,2890014870&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500"</span> alt=<span class="hljs-string">""</span>&gt;
                &lt;/div&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"foot-info"</span>&gt;
                    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"foot-song-name"</span>&gt;çˆ±åœ¨è¥¿å…ƒå‰&lt;/div&gt;
                    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"foot-song-author"</span>&gt;å‘¨æ°ä¼¦&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"foot-right"</span>&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"foot-heart"</span>&gt;
                    &lt;i <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont icon-aixin_shixin"</span>&gt;&lt;/i&gt;
                &lt;/div&gt;
                &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"foot-menu"</span>&gt;
                    &lt;i <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont icon-caidan"</span>&gt;&lt;/i&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;
</code></pre>
<p>å½“ç„¶ï¼Œå›¾æ ‡æ˜¯åœ¨<strong>iconfont</strong>ä¸Šé¢æ‰¾çš„ã€‚10ç§’å°±ç»™æˆ‘ç”Ÿæˆäº†æˆ‘æƒ³è¦çš„å®Œæ•´æ¡†æ¶ï¼Œè€Œä¸”è‡ªåŠ¨å¸®æˆ‘å¡«å……äº†æ‰€æœ‰ä»£ç ï¼Œè¿™...å·²ç»æ„Ÿå—åˆ°å¼ºå¤§äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95ae908246cd49f9b570497a975e8a3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764908022&amp;x-signature=0M5Mi56UrS%2FzIFfe9E5Zg87soXw%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">äºŒã€å¡«å……cssæ–‡ä»¶</h3>
<p>è¿™ä¸ªéƒ¨åˆ†ç®€ç›´æ²¡åŠ¨è„‘å­ï¼Œè‡ªå·±å†™äº†æœ€ä¸Šé¢çš„éƒ¨åˆ†ï¼Œç„¶åä¸­é—´çš„ä¸‹é¢çš„éƒ¨åˆ†ç›´æ¥å¸®æˆ‘ç”Ÿæˆå¥½äº†...</p>
<pre><code class="hljs language-css" lang="css">*{
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
}
<span class="hljs-selector-tag">body</span>, <span class="hljs-selector-tag">html</span>{
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
}
<span class="hljs-selector-class">.music</span>{
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#2A2A2A</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-direction</span>: column;
}
<span class="hljs-selector-class">.head</span>{
    <span class="hljs-attribute">height</span>: <span class="hljs-number">76px</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#161616</span>;
    <span class="hljs-attribute">color</span>: white;
    <span class="hljs-attribute">position</span>: relative;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">justify-content</span>: space-between;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">16px</span>;
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/facee9a0307e4fd28981b372dfc4625d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764908022&amp;x-signature=q9Jev%2BszdRipJhTiBRS1eIckTxs%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-css" lang="css">*{
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
}
<span class="hljs-selector-tag">body</span>, <span class="hljs-selector-tag">html</span>{
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
}
<span class="hljs-selector-class">.music</span>{
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#2A2A2A</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-direction</span>: column;
}
<span class="hljs-selector-class">.head</span>{
    <span class="hljs-attribute">height</span>: <span class="hljs-number">76px</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#161616</span>;
    <span class="hljs-attribute">color</span>: white;
    <span class="hljs-attribute">position</span>: relative;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">justify-content</span>: space-between;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">16px</span>;
}
<span class="hljs-selector-class">.back</span>, <span class="hljs-selector-class">.more</span>{
    <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">40px</span>;
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.05</span>);
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">justify-content</span>: center;
    <span class="hljs-attribute">align-items</span>: center;
}
<span class="hljs-selector-class">.title</span> {
    <span class="hljs-attribute">text-align</span>: center;
    <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
}
<span class="hljs-selector-class">.name</span> {
    <span class="hljs-attribute">font-family</span>: Roboto, Roboto;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">500</span>;
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#FFFFFF</span>;
    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">28px</span>;
}
<span class="hljs-selector-class">.author</span> {
    <span class="hljs-attribute">font-family</span>: Roboto, Roboto;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>;
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.8</span>);
    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">20px</span>;
}
<span class="hljs-selector-class">.main</span>{
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">32px</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-direction</span>: column;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">justify-content</span>: center;
    <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
    <span class="hljs-attribute">overflow</span>: hidden;
}
<span class="hljs-selector-class">.logo</span>{
    <span class="hljs-attribute">width</span>: <span class="hljs-number">240px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">240px</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">24px</span>;
    <span class="hljs-attribute">overflow</span>: hidden;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">justify-content</span>: center;
}
<span class="hljs-selector-class">.logo</span> <span class="hljs-selector-tag">img</span>{
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
}
<span class="hljs-selector-class">.songs</span> {
    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">20px</span>;
    <span class="hljs-attribute">color</span>: white;
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">max-width</span>: <span class="hljs-number">400px</span>;
}
<span class="hljs-selector-class">.song-info</span> {
    <span class="hljs-attribute">text-align</span>: center;
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
}
<span class="hljs-selector-class">.song-name</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">500</span>;
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#FFFFFF</span>;
}
<span class="hljs-selector-class">.song-author</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.6</span>);
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">12px</span>;
}

<span class="hljs-selector-class">.lyric</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.8</span>);
    <span class="hljs-attribute">font-style</span>: italic;
}
<span class="hljs-selector-class">.progress</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">justify-content</span>: space-between;
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
}
<span class="hljs-selector-class">.time</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.6</span>);
    <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
    <span class="hljs-attribute">text-align</span>: center;
}
<span class="hljs-selector-class">.progress-bar</span> {
    <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">4px</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.2</span>);
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">2px</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">12px</span>;
    <span class="hljs-attribute">position</span>: relative;
    <span class="hljs-attribute">cursor</span>: pointer;
}
<span class="hljs-selector-class">.progress-inner</span> {
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">background-color</span>: white;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">2px</span>;
    <span class="hljs-attribute">width</span>: <span class="hljs-number">50%</span>;
}
<span class="hljs-selector-class">.progress-dot</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">12px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">12px</span>;
    <span class="hljs-attribute">background-color</span>: white;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>);
    <span class="hljs-attribute">cursor</span>: pointer;
}
<span class="hljs-selector-class">.control</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">justify-content</span>: center;
    <span class="hljs-attribute">gap</span>: <span class="hljs-number">40px</span>;
    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">30px</span>;
}
<span class="hljs-selector-class">.prev</span>, <span class="hljs-selector-class">.next</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">48px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">48px</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">justify-content</span>: center;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">color</span>: white;
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>;
}
<span class="hljs-selector-class">.play</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">56px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">56px</span>;
    <span class="hljs-attribute">background-color</span>: white;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">justify-content</span>: center;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#161616</span>;
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>;
}
<span class="hljs-selector-class">.iconfont</span> {
    <span class="hljs-attribute">font-size</span>: inherit;
}

<span class="hljs-selector-class">.foot</span> {
    <span class="hljs-attribute">height</span>: <span class="hljs-number">80px</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#161616</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">justify-content</span>: space-between;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;
    <span class="hljs-attribute">border-top</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>);
}

<span class="hljs-selector-class">.foot-left</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">gap</span>: <span class="hljs-number">12px</span>;
}

<span class="hljs-selector-class">.foot-logo</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">56px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">56px</span>;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
    <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.foot-logo</span> <span class="hljs-selector-tag">img</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">object-fit</span>: cover;
}

<span class="hljs-selector-class">.foot-info</span> {
    <span class="hljs-attribute">color</span>: white;
}

<span class="hljs-selector-class">.foot-song-name</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">500</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#FFFFFF</span>;
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">4px</span>;
}

<span class="hljs-selector-class">.foot-song-author</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.6</span>);
}

<span class="hljs-selector-class">.foot-right</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">gap</span>: <span class="hljs-number">24px</span>;
    <span class="hljs-attribute">color</span>: white;
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
}

<span class="hljs-selector-class">.foot-heart</span>, <span class="hljs-selector-class">.foot-menu</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">40px</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">justify-content</span>: center;
    <span class="hljs-attribute">align-items</span>: center;
}
</code></pre>
<p>åˆ°è¿™é‡Œå‡ ä¹å·²ç»å‡ºæˆæœäº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc5629d9f68540b692ffcfa1ed4f4d82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764908022&amp;x-signature=btQU8oL69gc0kG%2FVHQbEaRdzwrI%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">ä¸‰ã€æœ€åç¥ä¹‹ä¸€æ‰‹(å®Œå–„é”™è¯¯)</h3>
<p>æˆ‘å‘ç°ä¸‹é¢çš„é‚£ä¸€æ è¢«æ’‘ä¸‹å»äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d8868aeb3744125a5098a5277778e22~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764908022&amp;x-signature=iIQ3eHQBVjX%2FLqve6%2BKwEX2qF%2F4%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™æ ·ä¸Šé¢å°±çœ‹ä¸åˆ°äº†ï¼Œäºæ˜¯ç»§ç»­SOLOï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/500a4d8f27c84700ae51c38e84f68eac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764908022&amp;x-signature=%2FLTLWUcZ1MzR6q0wrHTUxX%2B%2FVIs%3D" alt="image.png" loading="lazy"/></p>
<p>SOLOä¸ä½†å¸®ä½ å®Œå–„ä»£ç ï¼Œè¿˜è‡ªåŠ¨å¸®ä½ å¢æ·»å±æ€§ï¼Œè®©å¸ƒå±€æ›´åŠ å®Œå–„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06e0c7d7572444dda8c09db35e426fc7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764908022&amp;x-signature=IJiMVCu9GAkVvQc30%2FyetdwKmCg%3D" alt="image.png" loading="lazy"/></p>
<p>çœ‹çœ‹æˆæœ(ç”¨iPhone6è§†å›¾)ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0eb4b4b59dfc41ac9555640c163024ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764908022&amp;x-signature=Lirvd0r2QWwF9hZjp0O5dbergLg%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸€æ®µä»£ç æ•²ä¸‹æ¥ï¼Œå‘ç°è‡ªå·±åªæ„å»ºäº†ä¸€ä¸ªæ¡†æ¶å’Œæƒ³æ³•ï¼Œç¨‹åºå‘˜ç¡®å®å·²ç»ç¦»ä¸å¼€AIäº†...  å½“ç„¶å¹¶ä¸æ˜¯è¯´ç¨‹åºå‘˜ä¼šè¢«å–ä»£ï¼Œä½†æ˜¯AIå¤§æ¨¡å‹å¾ˆå¯èƒ½æ˜¯æœªæ¥çš„å¤§æ–¹å‘ã€‚</p>
<h2 data-id="heading-4">ç»“è¯­</h2>
<p>å½“æˆ‘ä¸åˆ°ä¸€èŠ‚è¯¾çš„æ—¶é—´åšå®Œè¿™ä¸ªéŸ³ä¹æ’­æ”¾å™¨ï¼Œæˆ‘æ‰ç®—æ‘¸é€ Trae SOLO çš„ â€œçœå¿ƒâ€â€”â€” ä» SOLO coder è‡ªåŠ¨ç”Ÿæˆçš„æ¥å£æ–‡æ¡£ï¼Œåˆ° DiffView å¸®æˆ‘ç§’ä¿®çš„ä»£ç å…¼å®¹é—®é¢˜ï¼Œç”šè‡³éƒ¨ç½²æ—¶ä¸€é”®æ‹‰èµ·çš„æœåŠ¡å®¹å™¨ï¼Œéƒ½æŠŠ AI å¼€å‘é‡Œçš„ â€œè„æ´»ç´¯æ´»â€ å•ƒäº†ä¸ªå¹²å‡€ã€‚è¦æ˜¯ä½ ä¹Ÿæƒ³æ‹¿å®ƒç»ƒæ‰‹ï¼Œå»ºè®®ä» â€œå°å·¥å…· + å¼ºæµç¨‹â€ çš„åœºæ™¯åˆ‡å…¥ï¼Œä¿å‡†èƒ½ get åˆ°å®ƒçš„é¦™ã€‚</p>
<blockquote>
<p>ç¬¬ä¸€æ¬¡ç”¨SOLOå†™ç½‘é¡µï¼Œæ‰€ä»¥å¾ˆå¤šéƒ½ä¸æ‡‚ï¼Œä½†æ˜¯SOLOæ¯æ¬¡éƒ½èƒ½getåˆ°æˆ‘çš„ç‚¹ã€‚å¯èƒ½ç»“æœæ²¡æœ‰ç¬¦åˆæˆ‘çš„è¦æ±‚ï¼Œä½†æ˜¯ä½ SOLOï¼Œå®ƒé©¬ä¸Šåˆå¸®ä½ å®Œå–„äº†ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ SOLO Coder æ­å»º 3D æœºå™¨äººé¡¹ç›®]]></title>    <link>https://juejin.cn/post/7577294037717794850</link>    <guid>https://juejin.cn/post/7577294037717794850</guid>    <pubDate>2025-11-28T05:41:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577294037717794850" data-draft-id="7577307409854660623" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ SOLO Coder æ­å»º 3D æœºå™¨äººé¡¹ç›®"/> <meta itemprop="keywords" content="Trae"/> <meta itemprop="datePublished" content="2025-11-28T05:41:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="TRAE_ai"/> <meta itemprop="url" content="https://juejin.cn/user/3048259110571032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ SOLO Coder æ­å»º 3D æœºå™¨äººé¡¹ç›®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3048259110571032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    TRAE_ai
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T05:41:56.000Z" title="Fri Nov 28 2025 05:41:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6356d728ecae484d9267c6fcc80016fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=qQsySi6pvBLY6f7yv4%2F58R7nxoo%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>æœ¬æ–‡ä½œè€…ï¼šèŒ‰å·ï¼ŒTRAE å¼€å‘è€…ç”¨æˆ·</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2634f6c0f4544958ea784429882b036~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=ckuElhBRYAXe3JSKQY%2BNEn9sFdc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0"><strong>èƒŒæ™¯</strong></h2>
<p>åšä¸€ä¸ª <strong>è™šæ‹Ÿæœºå™¨äºº</strong> é¡¹ç›®ï¼Œé€šè¿‡ <strong>æ§åˆ¶é¢æ¿</strong> æ§åˆ¶æœºå™¨äººåœ¨è™šæ‹Ÿç¯å¢ƒè¿è¡Œã€‚</p>
<p>ä» threejs ä¸Šæ‰¾äº†ä¸€ä¸ªç°æˆçš„ js ä»£ç çš„æœºå™¨äººï¼Œè®¡åˆ’æŠŠå®ƒç§»æ¤åˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œå¹¶æ·»åŠ äº¤äº’æ§åˆ¶åŠŸèƒ½ã€‚</p>
<p>å‚è€ƒç¤ºä¾‹ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fthreejs.org%2Fexamples%2F%23webgl_geometry_terrain_raycast" target="_blank" title="https://threejs.org/examples/#webgl_geometry_terrain_raycast" ref="nofollow noopener noreferrer">threejs.org/examples/#wâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6c3d574104f42f0bfa3d5169739bf1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=XXfAYFxTAcJ%2BeTPhZsSDf4lq%2BQI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c55ba6660214fcea7ce4ff7dd8df289~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=A20m8mPo02y5B2rGu5%2BuHWD6%2F9M%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1"><strong>é¡¹ç›®è®¡åˆ’</strong></h2>
<ul>
<li>
<p>ç§»æ¤ç¤ºä¾‹ä¸­çš„æœºå™¨äººï¼Œæ”¯æŒå„ç§åŠ¨ä½œçŠ¶æ€</p>
</li>
<li>
<p>åˆ¶ä½œä¸€ä¸ªç‰©ç†ç¯å¢ƒï¼Œå¯ä»¥è®©æœºå™¨äººåœ¨è¿™ä¸ªç¯å¢ƒä¸­è¿è¡Œ ï¼ˆåƒé‡‘å¸ï¼Œèº²é¿éšœç¢ç‰©ï¼‰</p>
</li>
</ul>
<p><strong>ä½¿ç”¨ TRAE çš„åŠŸèƒ½ï¼š</strong></p>
<ul>
<li>
<p>SOLO Coder</p>
</li>
<li>
<p>SOLO Coder Plan</p>
</li>
<li>
<p>æç¤ºè¯ä¼˜åŒ–</p>
</li>
</ul>
<h3 data-id="heading-2"><strong>1 æœºå™¨äººç§»æ¤ + è™šæ‹Ÿç¯å¢ƒ å®ç°</strong></h3>
<p>å†™ä¸€ä¸ªæç¤ºè¯ï¼Œè®© SOLO å®Œæˆç§»æ¤ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œæœºå™¨äººå¯ä»¥åœ¨é‡Œé¢è¡ŒåŠ¨</p>
<h4 data-id="heading-3"><strong>ä¼˜åŒ–å‰</strong></h4>
<pre><code class="hljs language-ruby" lang="ruby">ç°åœ¨éœ€è¦å¼€å‘ä¸€ä¸ªthreejs çš„ vite react é¡¹ç›®ã€‚ ä½ éœ€è¦å…ˆç§»æ¤<span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/threejs.org/examples</span><span class="hljs-regexp">/#webgl_geometry_terrain_raycast ï¼š ä¸­çš„ æœºå™¨äººï¼Œå®ƒçš„å‚è€ƒä»£ç https:/</span><span class="hljs-regexp">/github.com/mrdoob</span><span class="hljs-regexp">/three.js/blob</span><span class="hljs-regexp">/dev/examples</span><span class="hljs-regexp">/webgl_animation_skinning_morph.html
è¿™ä¸ªæœºå™¨äººéœ€è¦æ”¯æŒdemo ä¸­çš„ çŠ¶æ€ï¼ˆstatesï¼‰å’Œ emotes ç„¶åï¼Œä½ éœ€è¦è®¾è®¡ä¸€ä¸ªgeometry åœ°ç†ç¯å¢ƒï¼Œè®©ç”¨æˆ·å¯ä»¥æ§åˆ¶ æœºå™¨äººè¿›è¡Œ states ä¸­çš„ä¸åŒçŠ¶æ€ï¼Œæ¯”å¦‚è·‘ã€è·³èˆç­‰ç­‰
</span></code></pre>
<h4 data-id="heading-4"><strong>ä¼˜åŒ–å ï¼ˆè¾“å…¥æç¤ºè¯åï¼ŒæŒ‰ä¸‹å›¾çš„ã€æ˜Ÿæ˜Ÿã€‘æŒ‰é’®å³å¯ä¼˜åŒ–ï¼‰ã€‚</strong></h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a519349feeb465ca7ff1e733446901c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=00ryxihSXSfqOMPninlQwj1WJbk%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7b4a894516e44d689201bf027238de7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=nnGALLRQfCBuK%2F6df59lCJqMuV8%3D" alt="" loading="lazy"/></p>
<p><strong>ä¼˜åŒ–åæç¤ºè¯</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">å¼€å‘ä¸€ä¸ªåŸºäºThree.jsçš„Vite Reacté¡¹ç›®ï¼Œéœ€è¦å®Œæˆä»¥ä¸‹å…·ä½“ä»»åŠ¡ï¼š

<span class="hljs-bullet">1.</span> æœºå™¨äººæ¨¡å‹ç§»æ¤ï¼š
<span class="hljs-bullet">   -</span> ä»ä¸­æå–æœºå™¨äººæ¨¡å‹åŠå…¶åŠ¨ç”»ç³»ç»Ÿ
<span class="hljs-bullet">   -</span> å‚è€ƒä¸­çš„å®ç°ä»£ç è¿›è¡Œç§»æ¤
<span class="hljs-bullet">   -</span> ç¡®ä¿å®Œæ•´ä¿ç•™æœºå™¨äººæ‰€æœ‰çš„statesçŠ¶æ€å’Œemotesè¡¨æƒ…åŠŸèƒ½

<span class="hljs-bullet">2.</span> åœ°ç†ç¯å¢ƒè®¾è®¡ï¼š
<span class="hljs-bullet">   -</span> åˆ›å»ºé€‚åˆæœºå™¨äººæ´»åŠ¨çš„3Då‡ ä½•ç¯å¢ƒ
<span class="hljs-bullet">   -</span> å®ç°åœ°å½¢ç¢°æ’æ£€æµ‹å’Œç‰©ç†äº¤äº’
<span class="hljs-bullet">   -</span> è®¾è®¡åˆç†çš„ç©ºé—´å¸ƒå±€ä»¥æ”¯æŒå„ç§åŠ¨ä½œå±•ç¤º

<span class="hljs-bullet">3.</span> äº¤äº’æ§åˆ¶ç³»ç»Ÿï¼š
<span class="hljs-bullet">   -</span> å¼€å‘ç”¨æˆ·ç•Œé¢æ§åˆ¶é¢æ¿
<span class="hljs-bullet">   -</span> å®ç°çŠ¶æ€åˆ‡æ¢åŠŸèƒ½ï¼ˆè·‘ã€è·³èˆç­‰é¢„è®¾åŠ¨ä½œï¼‰
<span class="hljs-bullet">   -</span> æ·»åŠ æµç•…çš„åŠ¨ç”»è¿‡æ¸¡æ•ˆæœ
<span class="hljs-bullet">   -</span> ç¡®ä¿ç§»åŠ¨è®¾å¤‡å…¼å®¹æ€§

<span class="hljs-bullet">4.</span> æŠ€æœ¯è¦æ±‚ï¼š
<span class="hljs-bullet">   -</span> ä½¿ç”¨Viteæ„å»ºå·¥å…·é…ç½®Three.js+Reactç¯å¢ƒ
<span class="hljs-bullet">   -</span> ä¼˜åŒ–æ¨¡å‹åŠ è½½æ€§èƒ½
<span class="hljs-bullet">   -</span> å®ç°å“åº”å¼è®¾è®¡é€‚é…ä¸åŒå±å¹•å°ºå¯¸
<span class="hljs-bullet">   -</span> æ·»åŠ å¿…è¦çš„é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€æŒ‡ç¤º

<span class="hljs-bullet">5.</span> äº¤ä»˜æ ‡å‡†ï¼š
<span class="hljs-bullet">   -</span> å®Œæ•´å¯è¿è¡Œçš„æ¼”ç¤ºé¡¹ç›®
<span class="hljs-bullet">   -</span> æ‰€æœ‰æºä»£ç å’Œèµ„æºæ–‡ä»¶
<span class="hljs-bullet">   -</span> é¡¹ç›®æ–‡æ¡£è¯´æ˜è¿è¡Œå’Œæ„å»ºæ–¹æ³•
<span class="hljs-bullet">   -</span> æ€§èƒ½ä¼˜åŒ–æŠ¥å‘Š
</code></pre>
<p>Solo Coder ç„¶åç»™å‡ºäº†è¯¦ç»†çš„å¼€å‘è®¡åˆ’å’Œä»»åŠ¡åˆ†è§£ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d73bb26407794ec7b985dca5245c402d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=R%2BAlK3elpSywPPMKC6ss4V6%2BsNk%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-5"><strong>ç§»æ¤æœºå™¨äººè¡ŒåŠ¨ï¼šä¸€æ¬¡è¿‡ âœ…</strong></h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96a3c7d0c45c4ebcb45ba32e0d815757~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=lGnyXHhnA3TH5oHou1YpQUtjAPw%3D" alt="" loading="lazy"/></p>
<p><strong>ä»£ç è§„æ¨¡ï¼š14 ä¸ªæ–‡ä»¶ï¼Œ452 è¡Œä»£ç ã€‚</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a68ebfb7d7174e9e959830d1181869d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=VgeClLKnHbPAz480gSv67I%2FvuDM%3D" alt="" loading="lazy"/></p>
<p><strong>åŠŸèƒ½çŠ¶æ€ï¼š å„é¡¹åŠŸèƒ½åŸºæœ¬ OKï¼Œä¸€æ¬¡é€šè¿‡ï¼</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5323122064584fe79168c7a13db6e818~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=pDf1SoC8czUEV1vTYscpMS82V1c%3D" alt="" loading="lazy"/></p>
<p><strong>æ•ˆæœæ¼”ç¤º</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f814fab0f9e34ee8b1f8edcd92890b19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=wpaOAR0XBfwT1RhrgP3vDkxLFY4%3D" alt="three3-bot-1.gif" loading="lazy"/></p>
<h3 data-id="heading-6"><strong>2 æ§åˆ¶é¢æ¿å’Œç¯å¢ƒä¼˜åŒ–</strong></h3>
<h4 data-id="heading-7"><strong>ä¼˜åŒ–å‰æç¤ºè¯</strong></h4>
<p>æœºå™¨äººä¸»é¡µä¸­ï¼Œå½“ç”¨æˆ·ç‚¹å‡»é¼ æ ‡å·¦é”®ï¼Œç§»åŠ¨é¼ æ ‡æ—¶ï¼Œåº”è¯¥å¯ä»¥ç§»åŠ¨è§†è§’ï¼Œä»ä¸åŒè§’åº¦è§‚å¯Ÿæœºå™¨äººï¼Œå½“ä½¿ç”¨é¼ æ ‡æ»šè½®æ—¶ï¼Œåº”è¯¥æ‰©å¤§æˆ–è€…ç¼©æ”¾è§†è§’ã€‚ æœºå™¨äººéœ€è¦æ”¯æŒ wsad è¿›è¡Œå‰è¿›åé€€ï¼Œå·¦è½¬ï¼Œå³è½¬ã€‚ï¼ˆæ³¨æ„ï¼Œå·¦è½¬ã€å³è½¬æ˜¯è½¬èº«ï¼Œè°ƒæ•´æœºå™¨äººçš„æ–¹å‘ï¼‰</p>
<h4 data-id="heading-8"><strong>ä¼˜åŒ–å</strong></h4>
<pre><code class="hljs language-markdown" lang="markdown">åœ¨æœºå™¨äººä¸»é¡µçš„3Däº¤äº’åœºæ™¯ä¸­ï¼Œå®ç°ä»¥ä¸‹å®Œæ•´çš„è§†è§’æ§åˆ¶åŠŸèƒ½ï¼š

<span class="hljs-bullet">1.</span> é¼ æ ‡æ§åˆ¶è§†è§’ï¼š
<span class="hljs-bullet">   -</span> å·¦é”®æ‹–åŠ¨æ§åˆ¶ï¼šå½“ç”¨æˆ·æŒ‰ä½é¼ æ ‡å·¦é”®å¹¶ç§»åŠ¨æ—¶ï¼Œæ‘„åƒæœºåº”å›´ç»•æœºå™¨äººè¿›è¡Œè½¨é“æ—‹è½¬ï¼ˆOrbit Controlï¼‰ï¼Œä»ä¸åŒè§’åº¦è§‚å¯Ÿæœºå™¨äººæ¨¡å‹
<span class="hljs-bullet">   -</span> æ»šè½®ç¼©æ”¾æ§åˆ¶ï¼šä½¿ç”¨é¼ æ ‡æ»šè½®æ—¶ï¼Œåº”å¹³æ»‘åœ°æ”¾å¤§æˆ–ç¼©å°è§†è§’ï¼Œè®¾ç½®åˆç†çš„ç¼©æ”¾èŒƒå›´ï¼ˆå»ºè®®0.5-5å€ï¼‰ï¼Œå¹¶æ·»åŠ é˜»å°¼æ•ˆæœ

<span class="hljs-bullet">2.</span> é”®ç›˜æ§åˆ¶ç§»åŠ¨ï¼š
<span class="hljs-bullet">   -</span> WASDé”®ä½æ§åˆ¶ï¼š
<span class="hljs-bullet">     *</span> Wé”®ï¼šæœºå™¨äººæ²¿å½“å‰æœå‘å‰è¿›
<span class="hljs-bullet">     *</span> Sé”®ï¼šæœºå™¨äººæ²¿å½“å‰æœå‘åé€€
<span class="hljs-bullet">     *</span> Aé”®ï¼šæœºå™¨äººå‘å·¦æ—‹è½¬ï¼ˆYè½´æ—‹è½¬ï¼Œéå¹³ç§»ï¼‰
<span class="hljs-bullet">     *</span> Dé”®ï¼šæœºå™¨äººå‘å³æ—‹è½¬ï¼ˆYè½´æ—‹è½¬ï¼Œéå¹³ç§»ï¼‰
<span class="hljs-bullet">   -</span> ç§»åŠ¨ç‰¹æ€§ï¼š
<span class="hljs-bullet">     *</span> ç§»åŠ¨é€Ÿåº¦åº”å¯é…ç½®ï¼ˆé»˜è®¤0.1å•ä½/å¸§ï¼‰
<span class="hljs-bullet">     *</span> æ—‹è½¬é€Ÿåº¦åº”å¯é…ç½®ï¼ˆé»˜è®¤1åº¦/å¸§ï¼‰
<span class="hljs-bullet">     *</span> å®ç°æƒ¯æ€§æ•ˆæœå’Œè¿åŠ¨å¹³æ»‘

<span class="hljs-bullet">3.</span> æŠ€æœ¯è¦æ±‚ï¼š
<span class="hljs-bullet">   -</span> ä½¿ç”¨requestAnimationFrameå®ç°æµç•…çš„åŠ¨ç”»
<span class="hljs-bullet">   -</span> æ·»åŠ ç§»åŠ¨å’Œæ—‹è½¬çš„è¾¹ç•Œé™åˆ¶
<span class="hljs-bullet">   -</span> æ”¯æŒç§»åŠ¨è®¾å¤‡è§¦æ‘¸äº‹ä»¶é€‚é…ï¼ˆå¯é€‰ï¼‰
<span class="hljs-bullet">   -</span> æ‰€æœ‰æ§åˆ¶å‚æ•°åº”å¯é€šè¿‡é…ç½®æ–‡ä»¶è°ƒæ•´

<span class="hljs-bullet">4.</span> æ€§èƒ½ä¼˜åŒ–ï¼š
<span class="hljs-bullet">   -</span> å®ç°é˜²æŠ–å¤„ç†é˜²æ­¢è¿‡åº¦è§¦å‘
<span class="hljs-bullet">   -</span> æ·»åŠ ç§»åŠ¨å’Œæ—‹è½¬çš„çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆè°ƒè¯•ç”¨ï¼‰
<span class="hljs-bullet">   -</span> ç¡®ä¿åœ¨ä½å¸§ç‡æƒ…å†µä¸‹çš„æ§åˆ¶ç¨³å®šæ€§

<span class="hljs-bullet">5.</span> æµ‹è¯•è¦æ±‚ï¼š
<span class="hljs-bullet">   -</span> éªŒè¯æ‰€æœ‰æ§åˆ¶ç»„åˆä¸‹çš„è¡Œä¸ºæ­£ç¡®æ€§
<span class="hljs-bullet">   -</span> æµ‹è¯•è¾¹ç•Œæ¡ä»¶ä¸‹çš„è¡¨ç°
<span class="hljs-bullet">   -</span> æ£€æŸ¥ä¸åŒDPIè®¾å¤‡ä¸‹çš„æ§åˆ¶çµæ•åº¦
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4179f8add9954f5c9a18800cfccd9d98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=kkIiB2wnDkO9BFW%2BtIKsLsNxCnE%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a7cd76ee8f3483c91474cecda22b661~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=pnRKy5Sk%2FOYOGEnM36QIUllHuvs%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-9"><strong>åŠŸèƒ½ä¸€æ¬¡è¿‡ï¼šå° BUG âœ…</strong></h4>
<p><strong>å‘ç°çš„é—®é¢˜ï¼š</strong></p>
<ul>
<li>A é”®ï¼šæœŸå¾…å·¦è½¬ï¼Œå®é™…å³è½¬</li>
<li>D é”®ï¼šæœŸå¾…å³è½¬ï¼Œå®é™…å·¦è½¬</li>
<li>ç§»åŠ¨æ•ˆæœä¸æ˜æ˜¾ï¼Œéœ€è¦ä¼˜åŒ–åœºåœ°</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12840052b8c34622912accdcabdffe9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=%2BNxxC06IlskJbW0QYIEYHOhmi%2F0%3D" alt="å½•å±2025-11-13 00.04.39.gif" loading="lazy"/></p>
<h3 data-id="heading-10"><strong>3 ä¼˜åŒ–æœºå™¨äººè¡ŒåŠ¨å’Œç¯å¢ƒ</strong></h3>
<h4 data-id="heading-11"><strong>ä¼˜åŒ–å‰</strong></h4>
<p>æœºå™¨äººçš„è½¬å‘éœ€è¦ä¼˜åŒ–ï¼Œa åº”è¯¥æ˜¯å‘å·¦è½¬ï¼Œå®é™…æ˜¯å‘å³è½¬äº†ï¼›D åº”è¯¥æ˜¯å‘å³è½¬ï¼Œå®é™…æ•ˆæœæ˜¯å‘å·¦è½¬äº†ã€‚åœºåœ°æ˜¯ç»¿è‰²ï¼Œæœºå™¨äººç§»åŠ¨åï¼Œç§»åŠ¨çš„è·ç¦»ä¸æ˜æ˜¾ï¼Œæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥æ”¹å–„ï¼Ÿ</p>
<h4 data-id="heading-12"><strong>ä¼˜åŒ–å</strong></h4>
<pre><code class="hljs language-markdown" lang="markdown">ä¼˜åŒ–æœºå™¨äººè½¬å‘æ§åˆ¶å’Œç§»åŠ¨å¯è§†æ€§çš„å…·ä½“æ–¹æ¡ˆï¼š

<span class="hljs-bullet">1.</span> è½¬å‘æ§åˆ¶ä¿®æ­£ï¼š
<span class="hljs-bullet">-</span> é‡æ–°æ˜ å°„è½¬å‘æŒ‡ä»¤ï¼š
<span class="hljs-bullet">  *</span> å°†æŒ‰é”®"A"çš„è½¬å‘é€»è¾‘ä»å³è½¬ä¿®æ­£ä¸ºå·¦è½¬
<span class="hljs-bullet">  *</span> å°†æŒ‰é”®"D"çš„è½¬å‘é€»è¾‘ä»å·¦è½¬ä¿®æ­£ä¸ºå³è½¬
<span class="hljs-bullet">-</span> å®ç°ç²¾ç¡®çš„è§’åº¦æ§åˆ¶ï¼š
<span class="hljs-bullet">  *</span> è®¾ç½®æ ‡å‡†è½¬å‘è§’åº¦ä¸º90åº¦/æ¬¡
<span class="hljs-bullet">  *</span> æ·»åŠ è½¬å‘åŠ é€Ÿåº¦æ§åˆ¶ï¼Œç¡®ä¿å¹³æ»‘è½¬å‘

<span class="hljs-bullet">2.</span> ç§»åŠ¨è½¨è¿¹å¯è§†åŒ–å¢å¼ºï¼š
<span class="hljs-bullet">-</span> åœ¨ç»¿è‰²åœºåœ°ä¸Šæ·»åŠ é«˜å¯¹æ¯”åº¦è½¨è¿¹æ ‡è®°ï¼š
<span class="hljs-bullet">  *</span> ä½¿ç”¨äº®é»„è‰²æˆ–ç™½è‰²è½¨è¿¹çº¿ï¼ˆRGB 255,255,0 æˆ– 255,255,255ï¼‰
<span class="hljs-bullet">  *</span> è½¨è¿¹çº¿å®½åº¦è®¾ç½®ä¸º5cm
<span class="hljs-bullet">-</span> å®ç°å®æ—¶è½¨è¿¹è®°å½•ï¼š
<span class="hljs-bullet">  *</span> æ¯0.5ç§’è®°å½•ä¸€æ¬¡æœºå™¨äººä½ç½®
<span class="hljs-bullet">  *</span> ç”¨ä¸åŒé¢œè‰²æ˜¾ç¤ºæ–°æ—§è½¨è¿¹ï¼ˆå¦‚çº¢è‰²è¡¨ç¤ºæœ€æ–°è½¨è¿¹ï¼‰

<span class="hljs-bullet">3.</span> è¿åŠ¨åé¦ˆç³»ç»Ÿï¼š
<span class="hljs-bullet">-</span> æ·»åŠ è½¬å‘æŒ‡ç¤ºç¯ï¼š
<span class="hljs-bullet">  *</span> å·¦è½¬æ—¶å·¦ä¾§LEDäº®è“è‰²
<span class="hljs-bullet">  *</span> å³è½¬æ—¶å³ä¾§LEDäº®çº¢è‰²
<span class="hljs-bullet">-</span> é›†æˆè·ç¦»ä¼ æ„Ÿå™¨åé¦ˆï¼š
<span class="hljs-bullet">  *</span> æ¯ç§»åŠ¨10cmè§¦å‘ä¸€æ¬¡å£°éŸ³æç¤º
<span class="hljs-bullet">  *</span> åœ¨æ§åˆ¶ç•Œé¢æ˜¾ç¤ºå®æ—¶ç§»åŠ¨è·ç¦»ï¼ˆç²¾ç¡®åˆ°0.1cmï¼‰

<span class="hljs-bullet">4.</span> æµ‹è¯•éªŒè¯æ–¹æ¡ˆï¼š
<span class="hljs-bullet">-</span> è½¬å‘æµ‹è¯•ï¼š
<span class="hljs-bullet">  *</span> æ‰§è¡Œ10æ¬¡è¿ç»­å·¦è½¬/å³è½¬æµ‹è¯•ï¼ŒéªŒè¯è½¬å‘ä¸€è‡´æ€§
<span class="hljs-bullet">  *</span> æµ‹é‡å®é™…è½¬å‘è§’åº¦ä¸æŒ‡ä»¤è§’åº¦çš„åå·®ï¼ˆåº”&lt;2åº¦ï¼‰
<span class="hljs-bullet">-</span> ç§»åŠ¨æµ‹è¯•ï¼š
<span class="hljs-bullet">  *</span> åœ¨5mè·ç¦»å†…æµ‹è¯•è½¨è¿¹ç›´çº¿åº¦ï¼ˆåå·®åº”&lt;3cmï¼‰
<span class="hljs-bullet">  *</span> éªŒè¯è½¨è¿¹åœ¨ä¸åŒå…‰ç…§æ¡ä»¶ä¸‹çš„å¯è§æ€§
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b867d9ba8a30407499c10087ddba8af4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=g2lZMU%2BC0%2FDGy5AZcEVrAgKYeRA%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-13"><strong>ç»“æœï¼šä¸€æ¬¡é€šè¿‡ âœ…</strong></h4>
<p><strong>æ”¹è¿›å†…å®¹ï¼š</strong></p>
<ul>
<li>
<p>âœ… æ›´æ­£äº†è½¬å‘æ–¹å‘</p>
</li>
<li>
<p>âœ… æ·»åŠ äº†ç§»åŠ¨éŸ³æ•ˆ</p>
</li>
<li>
<p>âœ… æ·»åŠ äº†è·¯çº¿è½¨è¿¹æç¤º</p>
</li>
</ul>
<h3 data-id="heading-14"><strong>4 å¢åŠ éšœç¢ç‰©ã€é‡‘å¸</strong></h3>
<h4 data-id="heading-15"><strong>ä¼˜åŒ–å‰</strong></h4>
<p>å¢åŠ ä¸‰ä¸ªéšœç¢ç‰© å’Œ 2 ä¸ªé‡‘å¸ã€‚ æœºå™¨äººæ¥è§¦é‡‘å¸åï¼Œç»™å‡ºæç¤ºè¯éŸ³ï¼›æœºå™¨äººç¢°åˆ°éšœç¢ç‰©åï¼Œç»™å‡ºæç¤ºéŸ³ã€‚é‡‘å¸éœ€è¦ç»™å‡ºåæ ‡ã€‚</p>
<h4 data-id="heading-16"><strong>ä¼˜åŒ–å</strong></h4>
<pre><code class="hljs language-markdown" lang="markdown">åœ¨æ¸¸æˆåœºæ™¯ä¸­å®ç°ä»¥ä¸‹åŠŸèƒ½å¢å¼ºï¼š

<span class="hljs-bullet">1.</span> éšœç¢ç‰©ç³»ç»Ÿï¼š
<span class="hljs-bullet">   -</span> æ–°å¢3ä¸ªéšœç¢ç‰©å¯¹è±¡ï¼Œéœ€å‡åŒ€åˆ†å¸ƒåœ¨æ¸¸æˆåœºæ™¯çš„ä¸åŒåŒºåŸŸ
<span class="hljs-bullet">   -</span> æ¯ä¸ªéšœç¢ç‰©åº”å…·æœ‰ç¢°æ’æ£€æµ‹åŠŸèƒ½
<span class="hljs-bullet">   -</span> å½“æœºå™¨äººç¢°æ’åˆ°éšœç¢ç‰©æ—¶ï¼Œç«‹å³æ’­æ”¾é¢„è®¾çš„æç¤ºéŸ³æ•ˆï¼ˆå¦‚"ç¢°æ’.wav"ï¼‰
<span class="hljs-bullet">   -</span> éšœç¢ç‰©éœ€æœ‰å¯è§†åŒ–çš„è¡¨ç°å½¢å¼ï¼ˆå¦‚çº¢è‰²ç«‹æ–¹ä½“ï¼‰

<span class="hljs-bullet">2.</span> é‡‘å¸ç³»ç»Ÿï¼š
<span class="hljs-bullet">   -</span> æ–°å¢2ä¸ªé‡‘å¸å¯¹è±¡ï¼Œéœ€æ˜ç¡®æŒ‡å®šåæ ‡ä½ç½®ï¼ˆå¦‚é‡‘å¸1åæ ‡(x1,y1,z1)ï¼Œé‡‘å¸2åæ ‡(x2,y2,z2)ï¼‰
<span class="hljs-bullet">   -</span> æ¯ä¸ªé‡‘å¸åº”å…·æœ‰ç¢°æ’æ£€æµ‹å’Œæ”¶é›†åŠŸèƒ½
<span class="hljs-bullet">   -</span> å½“æœºå™¨äººæ¥è§¦é‡‘å¸æ—¶ï¼š
<span class="hljs-bullet">     *</span> æ’­æ”¾é¢„è®¾çš„æ”¶é›†éŸ³æ•ˆï¼ˆå¦‚"é‡‘å¸.wav"ï¼‰
<span class="hljs-bullet">     *</span> åœ¨æ¸¸æˆç•Œé¢æ˜¾ç¤º"é‡‘å¸æ”¶é›†æˆåŠŸ"çš„æç¤ºä¿¡æ¯
<span class="hljs-bullet">     *</span> é‡‘å¸å¯¹è±¡ä»åœºæ™¯ä¸­æ¶ˆå¤±
<span class="hljs-bullet">   -</span> é‡‘å¸éœ€æœ‰å¯è§†åŒ–çš„è¡¨ç°å½¢å¼ï¼ˆå¦‚é‡‘è‰²çƒä½“ï¼‰

<span class="hljs-bullet">3.</span> å®ç°è¦æ±‚ï¼š
<span class="hljs-bullet">   -</span> æ‰€æœ‰ç¢°æ’æ£€æµ‹éœ€ä½¿ç”¨ç‰©ç†å¼•æ“ç²¾ç¡®è®¡ç®—
<span class="hljs-bullet">   -</span> éŸ³æ•ˆæ’­æ”¾éœ€æ”¯æŒåŒæ—¶å¤šéŸ³æºæ’­æ”¾
<span class="hljs-bullet">   -</span> åæ ‡ç³»ç»Ÿéœ€ä½¿ç”¨ä¸–ç•Œåæ ‡ç³»
<span class="hljs-bullet">   -</span> ä»£ç éœ€æ·»åŠ æ³¨é‡Šè¯´æ˜å…³é”®é€»è¾‘
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e12c5d3a83364b72a485207484fa6721~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=OfujJttLYeSK4jW6XqjrJ7TZkGo%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60f2b20baa75400689518050cd972ed8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=8dtWzNpuVE0LGPYGhkonrW%2BWTA0%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-17"><strong>å®ç°ç»“æœ</strong></h4>
<p>é‡‘å¸å’Œéšœç¢ç‰©ä¸€æ¬¡ç”ŸæˆæˆåŠŸï¼Œä½†é‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼Œç»è¿‡ <strong>8 è½®å¯¹è¯</strong>ä¿®å¤ï¼š</p>
<ul>
<li>
<p>é‡‘å¸æ— æ³•æ­£å¸¸æ˜¾ç¤ºï¼ˆä¼šè¢«åœ°è¡¨é®ç›–ï¼‰ã€æ”¶é›†</p>
</li>
<li>
<p>éšœç¢ç‰©å¯ä»¥è¢«ç©¿é€</p>
</li>
</ul>
<p><strong>æœ€ç»ˆæ•ˆæœï¼š å…¨éƒ¨åŠŸèƒ½æ­£å¸¸è¿è¡Œ âœ…</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d78240ed32cb45fa9b2a479ba3a5ebf9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=sOFCnKC8Md%2B4ch7IQ3awDejKaA4%3D" alt="å½•å±2025-11-13 07.45.49.gif" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18ea164a40454e07b513c9eceeb6009b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764913316&amp;x-signature=FXlpQjcKDk%2FLLtoWbuaSg1R%2F2kM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-18"><strong>ä½¿ç”¨ä½“éªŒæ€»ç»“</strong></h2>
<p>ç”¨ SOLO Coder çš„æ•´ä½“æ„Ÿè§‰å°±ä¿©å­—ï¼š<strong>çœå¿ƒã€‚</strong></p>
<p><strong>â€œæŠ„ä½œä¸šâ€èƒ½åŠ›ä¸€æµ</strong></p>
<p>åªéœ€è¦ç”©ç»™å®ƒä¸¤ä¸ª Three.js å®˜ç½‘çš„é“¾æ¥ï¼ˆä¸€ä¸ªæ•ˆæœé¡µï¼Œä¸€ä¸ªæºä»£ç é¡µï¼‰ï¼Œå®ƒå°±èƒ½è‡ªå·±çœ‹æ‡‚ä»£ç ï¼ŒæŠŠå¸¦å„ç§åŠ¨ä½œçš„æœºå™¨äººåŸå°ä¸åŠ¨åœ°â€œæ¬â€åˆ°æœ¬åœ°çš„ Vite + React é¡¹ç›®é‡Œã€‚</p>
<p><strong>æ ¸å¿ƒåŠŸèƒ½åŸºæœ¬â€œä¸€æ¬¡è¿‡â€</strong></p>
<p>æœ€è®©æˆ‘æƒŠå–œçš„æ˜¯ï¼Œå¾ˆå¤šå¤æ‚åŠŸèƒ½å®ƒç¬¬ä¸€æ¬¡å°è¯•å°±èƒ½è·‘é€šï¼š</p>
<ul>
<li>æŠŠæœºå™¨äººæ¨¡å‹å’ŒåŠ¨ç”»ç§»æ¤è¿‡æ¥ï¼Œä¸€æ¬¡æˆåŠŸã€‚</li>
<li>åšé‚£ä¸ªç”¨é¼ æ ‡æ‹–æ‹½æ—‹è½¬è§†è§’ã€æ»šè½®ç¼©æ”¾ã€é”®ç›˜ WSAD æ§åˆ¶ç§»åŠ¨çš„äº¤äº’é¢æ¿ï¼Œä¹ŸåŸºæœ¬æ²¡å‡ºå¤§é—®é¢˜ã€‚</li>
</ul>
<p>è¿™å°±çœä¸‹äº†å¤§é‡çš„åŸºç¡€è°ƒè¯•æ—¶é—´ã€‚</p>
<p><strong>èƒ½å¬æ‡‚äººè¯ï¼Œä¿® Bug æ•ˆç‡é«˜</strong></p>
<p>å½“ç„¶ä¹Ÿæœ‰å°æ’æ›²ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>ä¸€å¼€å§‹æŒ‰ A é”®æœºå™¨äººå¾€å³è½¬ï¼ŒæŒ‰ D é”®å¾€å·¦è½¬ï¼Œæ–¹å‘åäº†ã€‚</li>
<li>æœºå™¨äººåœ¨ç»¿åœ°ä¸Šç§»åŠ¨ï¼Œçœ‹ä¸å‡ºæ¥åŠ¨äº†å¤šè¿œã€‚</li>
</ul>
<p>æˆ‘è·Ÿå®ƒè¯´â€œA é”®åº”è¯¥æ˜¯å·¦è½¬ï¼Œç°åœ¨åäº†â€ï¼Œå®ƒé©¬ä¸Šå°±æ”¹å¯¹äº†ã€‚å¯¹äºç§»åŠ¨è½¨è¿¹ä¸æ˜æ˜¾çš„é—®é¢˜ï¼Œå®ƒä¸å…‰ä¿®æ­£äº†ï¼Œè¿˜ä¸»åŠ¨åŠ ä¸Šäº†ç§»åŠ¨éŸ³æ•ˆå’Œåœ°é¢è½¨è¿¹çº¿ï¼Œæƒ³å¾—æŒºå‘¨åˆ°ã€‚</p>
<p><strong>åšå¤æ‚åŠŸèƒ½æ—¶ï¼Œéœ€è¦å¤šç‚¹è€å¿ƒ</strong></p>
<p>åœ¨å¾€ååŠ â€œé‡‘å¸â€å’Œâ€œéšœç¢ç‰©â€æ—¶ï¼Œé‡åˆ°ç‚¹éº»çƒ¦ã€‚æ¯”å¦‚é‡‘å¸ç”Ÿæˆåœ¨åœ°åº•ä¸‹äº†ï¼Œæˆ–è€…æœºå™¨äººèƒ½ç›´æ¥ç©¿è¿‡éšœç¢ç‰©ã€‚è¿™äº›é—®é¢˜ä¸åƒæ”¹ä¸ªæŒ‰é”®é‚£ä¹ˆç®€å•ï¼Œæˆ‘ä»¬æ¥å›æ²Ÿé€šäº†ä¸ƒå…«æ¬¡ï¼Œæ‰æŠŠç¢°æ’æ£€æµ‹å’Œç‰©ä½“ä½ç½®éƒ½è°ƒå¯¹ã€‚</p>
<p>è¿™è¯´æ˜åœ¨å¤„ç†æ›´å¤æ‚çš„ç‰©ç†äº¤äº’æ—¶ï¼Œå®ƒå¯èƒ½éœ€è¦æ›´æ˜ç¡®çš„æŒ‡ä»¤å’Œå¤šè½®è°ƒè¯•ï¼Œä¸èƒ½æŒ‡æœ›ä¸€æ¬¡å°±å®Œç¾ã€‚</p>
<p><strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong> ç”¨å®ƒæ¥å¿«é€Ÿæ­å»ºåŸå‹ã€å®ç°æ ‡å‡†åŠŸèƒ½æˆ–è€…éªŒè¯æƒ³æ³•ï¼Œç»å¯¹æ˜¯ä¸ªç¥å™¨ï¼Œèƒ½è®©ä½ äº‹åŠåŠŸå€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[NekoBoxForAndroid ç¼–è¯‘libcore.aar]]></title>    <link>https://juejin.cn/post/7577343038428659755</link>    <guid>https://juejin.cn/post/7577343038428659755</guid>    <pubDate>2025-11-28T05:44:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577343038428659755" data-draft-id="7577411657393078314" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="NekoBoxForAndroid ç¼–è¯‘libcore.aar "/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-11-28T05:44:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç«æŸ´å°±æ˜¯æˆ‘"/> <meta itemprop="url" content="https://juejin.cn/user/272334614705575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            NekoBoxForAndroid ç¼–è¯‘libcore.aar 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/272334614705575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç«æŸ´å°±æ˜¯æˆ‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T05:44:52.000Z" title="Fri Nov 28 2025 05:44:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸€èˆ¬æŒ‰ç…§è¿™ä¸ªæµç¨‹ç¼–è¯‘å°±å¯ä»¥</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMatsuriDayo%2FNekoBoxForAndroid%2Fissues%2F177" target="_blank" title="https://github.com/MatsuriDayo/NekoBoxForAndroid/issues/177" ref="nofollow noopener noreferrer">github.com/MatsuriDayoâ€¦</a></p>
<p>è®°å½•ä¸€ä¸ªé—®é¢˜:libcore.aarä¸­ä¼šæœ‰ä¸€ä¸ªlibgojni.so æäº¤googleplayçš„æ—¶å€™ å¯èƒ½ä¼šæç¤ºæ²¡æœ‰é€‚é…16Kbã€‚
è¿™ä¸ªåŸå› å¯èƒ½æ˜¯ä½ æœ¬åœ°çš„NDKçš„ç‰ˆæœ¬å¤ªä½ã€‚</p>
<p>çœ‹è¿™ä¸ªissue:<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F74839" target="_blank" title="https://github.com/golang/go/issues/74839" ref="nofollow noopener noreferrer">github.com/golang/go/iâ€¦</a></p>
<p>åªéœ€è¦æŠŠæœ¬åœ°ndkçš„ç‰ˆæœ¬è®¾ç½®æˆ28ä»¥ä¸Šçš„å°±å¯ä»¥äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PHP Fiber ä¼˜é›…åä½œå¼å¤šä»»åŠ¡]]></title>    <link>https://juejin.cn/post/7577333742277951530</link>    <guid>https://juejin.cn/post/7577333742277951530</guid>    <pubDate>2025-11-28T03:33:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7577333742277951530" data-draft-id="7577343038428069931" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PHP Fiber ä¼˜é›…åä½œå¼å¤šä»»åŠ¡ "/> <meta itemprop="keywords" content="PHP"/> <meta itemprop="datePublished" content="2025-11-28T03:33:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·722786812344"/> <meta itemprop="url" content="https://juejin.cn/user/4100515739233513"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PHP Fiber ä¼˜é›…åä½œå¼å¤šä»»åŠ¡ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4100515739233513/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·722786812344
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-28T03:33:29.000Z" title="Fri Nov 28 2025 03:33:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨å¼€å‘å®˜æ–¹ PHP MCP SDK çš„å®¢æˆ·ç«¯é€šä¿¡åŠŸèƒ½æ—¶ï¼Œå¼€å‘å›¢é˜Ÿé‡åˆ°äº†ä¸€ä¸ªçœ‹ä¼¼æ— æ³•ä¼˜é›…è§£å†³çš„æ¶æ„æŒ‘æˆ˜ã€‚ä¼ ç»Ÿçš„å¼‚æ­¥æ–¹æ¡ˆã€å›è°ƒæ¨¡å¼å’ŒçŠ¶æ€æœºéƒ½æ— æ³•åœ¨ä¸ç‰ºç‰²ä»£ç ç®€æ´æ€§çš„å‰æä¸‹å®ç°éœ€æ±‚ã€‚æœ€ç»ˆï¼ŒPHP çº¤ç¨‹ï¼ˆFibersï¼‰æˆä¸ºäº†è¿™ä¸ªé—®é¢˜çš„å®Œç¾è§£å†³æ–¹æ¡ˆã€‚</p>
<p>è¯¥åŠŸèƒ½åœ¨ PR #109 ä¸­å¼•å…¥ï¼Œå…¶å®ç°å±•ç¤ºäº† PHP çº¤ç¨‹æœ€ä¼˜é›…çš„ä½¿ç”¨æ¡ˆä¾‹ä¹‹ä¸€ã€‚ä½†è¿™ä¸ä»…ä»…æ˜¯å…³äºä¸€ä¸ªé—®é¢˜çš„æ•…äº‹ï¼Œæ›´æ˜¯å…³äºä¸€ä¸ªè‡ª PHP 8.1 ä»¥æ¥ä¸€ç›´éšè—åœ¨ä¼—ç›®ç½ç½ä¹‹ä¸‹ã€å´è¢«å¤§é‡è¯¯è§£å’Œæœªå……åˆ†åˆ©ç”¨çš„å¼ºå¤§ PHP ç‰¹æ€§ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ï¼š</p>
<ul>
<li>PHP çº¤ç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆï¼ˆä»¥åŠå®ƒä»¬ä¸æ˜¯ä»€ä¹ˆï¼‰</li>
<li>ä½•æ—¶ä»¥åŠä¸ºä½•åº”è¯¥ä½¿ç”¨å®ƒä»¬</li>
<li>å¦‚ä½•ç†è§£åä½œå¼å¤šä»»åŠ¡</li>
<li>ä½¿ç”¨çº¤ç¨‹çš„çœŸå®ä¸–ç•Œå®ç°</li>
<li>å¯ä»¥åœ¨è‡ªå·±ä»£ç ä¸­ä½¿ç”¨çš„æ¨¡å¼</li>
</ul>
<p>æ–‡ç« è¾ƒé•¿ï¼Œå»ºè®®å‡†å¤‡å¥½å’–å•¡æ…¢æ…¢çœ‹ã€‚</p>
<h2 data-id="heading-1">å…³äºçº¤ç¨‹çš„è¯¯è§£</h2>
<p>é¦–å…ˆè¦è§£å†³æˆ¿é—´é‡Œçš„å¤§è±¡ï¼šPHP çº¤ç¨‹<strong>ä¸æ˜¯</strong>å¼‚æ­¥ PHPã€‚å®ƒä»¬ä¸æ˜¯å¹¶è¡Œæœºåˆ¶ï¼Œä¸æ˜¯çº¿ç¨‹ï¼Œä¹Ÿä¸æ˜¯è®© PHP åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ã€‚</p>
<p>å½“ PHP 8.1 åœ¨ 2021 å¹´ 11 æœˆå¼•å…¥çº¤ç¨‹æ”¯æŒæ—¶ï¼Œè®¸å¤šå¼€å‘è€…éƒ½æ„Ÿåˆ°å›°æƒ‘ã€‚"å¤ªå¥½äº†ï¼Œåˆä¸€ä¸ªå¼‚æ­¥ä¸œè¥¿ï¼Ÿ"å¤§å®¶è¿™æ ·æƒ³ã€‚è¿™ç§å›°æƒ‘æ˜¯å¯ä»¥ç†è§£çš„ï¼Œå› ä¸ºçº¤ç¨‹æœ€æ˜¾çœ¼çš„ä½¿ç”¨åœºæ™¯ä¸€ç›´æ˜¯åœ¨ ReactPHP å’Œ AmPHP ç­‰å¼‚æ­¥åº“ä¸­ã€‚</p>
<p>ReactPHP ç”šè‡³æœ‰ä¸€ä¸ªåä¸ºÂ <code>async</code>Â çš„åŒ…ï¼Œä½¿ç”¨çº¤ç¨‹è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">// çº¤ç¨‹ä¹‹å‰ï¼šå›è°ƒåœ°ç‹±
<span class="hljs-variable">$promise</span>-&gt;<span class="hljs-keyword">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-variable">$result</span>) {
    <span class="hljs-built_in">return</span> anotherAsyncCall(<span class="hljs-variable">$result</span>);
})-&gt;<span class="hljs-keyword">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-variable">$finalResult</span>) {
    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$finalResult</span>;
});
 
// ä½¿ç”¨çº¤ç¨‹ï¼šçœ‹èµ·æ¥æ˜¯åŒæ­¥çš„ï¼
<span class="hljs-variable">$result</span> = await(<span class="hljs-variable">$promise</span>);
<span class="hljs-variable">$finalResult</span> = await(anotherAsyncCall(<span class="hljs-variable">$result</span>));
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$finalResult</span>;
</code></pre>
<p>çœ‹åˆ°è¿™ä¸ªï¼Œå¾ˆå®¹æ˜“è®¤ä¸º"çº¤ç¨‹ = å¼‚æ­¥é­”æ³•"ã€‚ä½†è¿™å¿½ç•¥äº†æ›´å¤§çš„å›¾æ™¯ã€‚</p>
<p>çº¤ç¨‹çš„æœ¬è´¨æ˜¯<strong>åä½œå¼å¤šä»»åŠ¡</strong>ã€‚å®ƒä»¬èµ‹äºˆä»£ç æš‚åœæ‰§è¡Œã€æ‰§è¡Œå…¶ä»–æ“ä½œã€ç„¶ååœ¨å®Œå…¨ä¿ç•™æ‰€æœ‰å˜é‡ã€è°ƒç”¨æ ˆå’Œæ‰§è¡Œä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹ï¼Œç²¾ç¡®åœ°å›åˆ°ç¦»å¼€çš„ä½ç½®ç»§ç»­æ‰§è¡Œçš„èƒ½åŠ›ã€‚</p>
<p>æ˜¯çš„ï¼Œè¿™å¯¹å¼‚æ­¥åº“éå¸¸æœ‰ç”¨ã€‚ä½†åœ¨éœ€è¦å—æ§ä¸­æ–­å’Œæ¢å¤çš„çº¯åŒæ­¥ä»£ç ä¸­ï¼Œå®ƒåŒæ ·æœ‰ç”¨ã€‚è€Œè¿™æ­£æ˜¯å¤§å¤šæ•° PHP å¼€å‘è€…é”™è¿‡çš„æœºä¼šã€‚</p>
<p>çº¤ç¨‹é‡‡ç”¨ç¼“æ…¢çš„åŸå› ä¸æ˜¯å› ä¸ºå®ƒä»¬ä¸å¤Ÿæœ‰ç”¨ï¼Œè€Œæ˜¯å› ä¸ºå¤§å¤šæ•°å¼€å‘è€…ä¸çŸ¥é“ä½•æ—¶ä½¿ç”¨å®ƒä»¬ã€‚è€Œè¿™æ­£æ˜¯æœ¬æ–‡è¦è§£å†³çš„é—®é¢˜ã€‚</p>
<h2 data-id="heading-2">ç†è§£çº¤ç¨‹ï¼šåŸºç¡€çŸ¥è¯†</h2>
<p>åœ¨æ·±å…¥å¤æ‚ç¤ºä¾‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆå»ºç«‹åšå®çš„åŸºç¡€ã€‚çº¤ç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œå®ƒå¦‚ä½•å·¥ä½œï¼Ÿ</p>
<h3 data-id="heading-3">ä»€ä¹ˆæ˜¯åä½œå¼å¤šä»»åŠ¡ï¼Ÿ</h3>
<p>ç†è§£çº¤ç¨‹çš„ä¸€ä¸ªå¥½ç±»æ¯”æ˜¯ï¼Œå°†æ ‡å‡† PHP è„šæœ¬æƒ³è±¡æˆå•è½¨é“ä¸Šçš„ç«è½¦ã€‚å®ƒä» A ç«™å¼€åˆ° B ç«™ï¼Œé€šå¸¸åœ¨åˆ°è¾¾ B ä¹‹å‰ä¸èƒ½åœæ­¢ã€‚çº¤ç¨‹å…è®¸ç«è½¦åœ¨è½¨é“ä¸­é—´åœä¸‹æ¥ï¼Œè®©ä¹˜å®¢ä¸‹è½¦ï¼ˆæˆ–è®©ä¹˜å®¢ä¸Šæ´—æ‰‹é—´ä¼‘æ¯ï¼‰ï¼Œåœ¨æ­¤æœŸé—´ç”šè‡³è®©å¦ä¸€åˆ—ç«è½¦ä½¿ç”¨è¿™æ¡è½¨é“ï¼Œç„¶ååœ¨æ‰€æœ‰è¡Œæï¼ˆå˜é‡å’Œå†…å­˜çŠ¶æ€ï¼‰å®Œå¥½æ— æŸçš„æƒ…å†µä¸‹ï¼Œç²¾ç¡®åœ°ä»åœä¸‹çš„åœ°æ–¹æ¢å¤ã€‚</p>
<p>å¦ä¸€ä¸ªç±»æ¯”æ˜¯æƒ³è±¡ä½ åœ¨åšé¥­çš„åŒæ—¶è¯»ä¹¦ã€‚ä½ è¯»å‡ é¡µä¹¦ï¼Œç„¶åå®šæ—¶å™¨å“äº†ï¼Œä½ æ ‡è®°é¡µé¢ï¼Œæ…æ‹Œé”…é‡Œçš„ä¸œè¥¿ï¼Œå†å›åˆ°åˆšæ‰è¯»åˆ°çš„åœ°æ–¹ç»§ç»­é˜…è¯»ã€‚è¿™å°±æ˜¯åä½œå¼å¤šä»»åŠ¡ã€‚</p>
<p>å…³é”®è¯æ˜¯<strong>åä½œ</strong>ã€‚ä½ ï¼ˆè¯»è€…/å¨å¸ˆï¼‰å†³å®šä½•æ—¶åˆ‡æ¢ä»»åŠ¡ã€‚æ²¡æœ‰äººå¼ºè¡Œæ‰“æ–­ä½ ï¼Œè€Œæ˜¯åœ¨åˆé€‚çš„æ—¶å€™è‡ªæ„¿äº¤å‡ºæ§åˆ¶æƒã€‚</p>
<p>åœ¨ç¼–ç¨‹æœ¯è¯­ä¸­ï¼š</p>
<ul>
<li><strong>æŠ¢å å¼å¤šä»»åŠ¡</strong>ï¼šæ“ä½œç³»ç»Ÿå¼ºåˆ¶ä¸­æ–­ä½ çš„ä»£ç ï¼ˆçº¿ç¨‹ã€è¿›ç¨‹ï¼‰</li>
<li><strong>åä½œå¼å¤šä»»åŠ¡</strong>ï¼šä½ çš„ä»£ç å†³å®šä½•æ—¶äº¤å‡ºæ§åˆ¶æƒï¼ˆåç¨‹ã€çº¤ç¨‹ï¼‰</li>
</ul>
<p>çº¤ç¨‹æ˜¯ PHP å¯¹åä½œå¼å¤šä»»åŠ¡çš„å®ç°ã€‚å®ƒä»¬è®©ä½ èƒ½å¤Ÿï¼š</p>
<ol>
<li>å¼€å§‹æ‰§è¡Œä¸€æ®µä»£ç </li>
<li>åœ¨ä»»ä½•ç‚¹æš‚åœå®ƒï¼ˆæŒ‚èµ·ï¼‰</li>
<li>åšå…¶ä»–äº‹æƒ…</li>
<li>ç²¾ç¡®åœ°ä»ç¦»å¼€çš„åœ°æ–¹æ¢å¤</li>
<li>æ ¹æ®éœ€è¦é‡å¤ä»»æ„å¤šæ¬¡</li>
</ol>
<h3 data-id="heading-4">çº¤ç¨‹çš„ç»“æ„</h3>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
 
<span class="hljs-variable">$fiber</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Fiber</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span> </span>{
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"1. çº¤ç¨‹å¯åŠ¨\n"</span>;
 
    <span class="hljs-variable">$value</span> = <span class="hljs-title class_">Fiber</span>::<span class="hljs-title function_ invoke__">suspend</span>(<span class="hljs-string">'pause-1'</span>);
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"3. çº¤ç¨‹æ¢å¤ï¼Œæ”¶åˆ°: <span class="hljs-subst">$value</span>\n"</span>;
 
    <span class="hljs-variable">$value2</span> = <span class="hljs-title class_">Fiber</span>::<span class="hljs-title function_ invoke__">suspend</span>(<span class="hljs-string">'pause-2'</span>);
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"5. çº¤ç¨‹å†æ¬¡æ¢å¤ï¼Œæ”¶åˆ°: <span class="hljs-subst">$value2</span>\n"</span>;
 
    <span class="hljs-keyword">return</span> <span class="hljs-string">'final-result'</span>;
});
 
<span class="hljs-keyword">echo</span> <span class="hljs-string">"0. å¯åŠ¨çº¤ç¨‹ä¹‹å‰\n"</span>;
 
<span class="hljs-variable">$suspended1</span> = <span class="hljs-variable">$fiber</span>-&gt;<span class="hljs-title function_ invoke__">start</span>();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"2. çº¤ç¨‹æŒ‚èµ·ï¼Œè¿”å›: <span class="hljs-subst">$suspended1</span>\n"</span>;
 
<span class="hljs-variable">$suspended2</span> = <span class="hljs-variable">$fiber</span>-&gt;<span class="hljs-title function_ invoke__">resume</span>(<span class="hljs-string">'data-1'</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-string">"4. çº¤ç¨‹å†æ¬¡æŒ‚èµ·ï¼Œè¿”å›: <span class="hljs-subst">$suspended2</span>\n"</span>;
 
<span class="hljs-variable">$result</span> = <span class="hljs-variable">$fiber</span>-&gt;<span class="hljs-title function_ invoke__">resume</span>(<span class="hljs-string">'data-2'</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-string">"6. çº¤ç¨‹è¿”å›: <span class="hljs-subst">$result</span>\n"</span>;
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">0.</span> å¯åŠ¨çº¤ç¨‹ä¹‹å‰
<span class="hljs-bullet">1.</span> çº¤ç¨‹å¯åŠ¨
<span class="hljs-bullet">2.</span> çº¤ç¨‹æŒ‚èµ·ï¼Œè¿”å›: pause-1
<span class="hljs-bullet">3.</span> çº¤ç¨‹æ¢å¤ï¼Œæ”¶åˆ°: data-1
<span class="hljs-bullet">4.</span> çº¤ç¨‹å†æ¬¡æŒ‚èµ·ï¼Œè¿”å›: pause-2
<span class="hljs-bullet">5.</span> çº¤ç¨‹å†æ¬¡æ¢å¤ï¼Œæ”¶åˆ°: data-2
<span class="hljs-bullet">6.</span> çº¤ç¨‹è¿”å›: final-result
</code></pre>
<p>è¿™é‡Œç‰¹æ„åŒ…å«äº†æ•°å­—ï¼Œä»¥ä¾¿è¯»è€…çœ‹æ¸…æ‰§è¡Œå¦‚ä½•åœ¨çº¤ç¨‹å†…å¤–è·³è½¬ã€‚<code>suspend</code>Â è®©å®ƒè·³å‡ºçº¤ç¨‹ï¼Œ<code>resume</code>Â è®©å®ƒè·³å›çº¤ç¨‹ï¼ä¸ºäº†æ›´æ¸…æ™°ï¼Œè®©æˆ‘ä»¬åˆ†è§£ä¸€ä¸‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š</p>
<ol>
<li><strong>åˆ›å»º</strong>ï¼š<code>new Fiber(function() {...})</code>Â åˆ›å»ºçº¤ç¨‹ä½†å°šæœªæ‰§è¡Œ</li>
<li><strong>å¯åŠ¨</strong>ï¼š<code>$fiber-&gt;start()</code>Â å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªÂ <code>Fiber::suspend()</code></li>
<li><strong>æŒ‚èµ·</strong>ï¼š<code>Fiber::suspend('pause-1')</code>Â æš‚åœæ‰§è¡Œå¹¶å°†æ§åˆ¶æƒè¿”å›ç»™è°ƒç”¨è€…</li>
<li><strong>æ¢å¤</strong>ï¼š<code>$fiber-&gt;resume('data-1')</code>Â ä»æŒ‚èµ·å¤„ç»§ç»­æ‰§è¡Œ</li>
<li><strong>è¿”å›</strong>ï¼šå½“çº¤ç¨‹å®Œæˆæ—¶ï¼Œ<code>resume()</code>Â è¿”å›æœ€ç»ˆå€¼</li>
</ol>
<p>é­”æ³•åœ¨äºæ‰§è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å½“çº¤ç¨‹æŒ‚èµ·æ—¶ï¼š</p>
<ul>
<li>æ‰€æœ‰å±€éƒ¨å˜é‡éƒ½è¢«ä¿ç•™</li>
<li>è°ƒç”¨æ ˆè¢«ä¿å­˜</li>
<li>æ‰§è¡Œè·³å›åˆ°è°ƒç”¨Â <code>start()</code>Â æˆ–Â <code>resume()</code>Â çš„åœ°æ–¹</li>
<li>ä¼ é€’ç»™Â <code>suspend()</code>Â çš„å€¼è¿”å›ç»™è°ƒç”¨è€…</li>
</ul>
<p>å½“ä½ æ¢å¤æ—¶ï¼š</p>
<ul>
<li>æ‰§è¡Œè·³å›çº¤ç¨‹å†…éƒ¨</li>
<li>ä¼ é€’ç»™Â <code>resume()</code>Â çš„å€¼æˆä¸ºÂ <code>suspend()</code>Â çš„è¿”å›å€¼</li>
<li>ä¸€åˆ‡ç»§ç»­ï¼Œå°±åƒä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿè¿‡</li>
</ul>
<p>ä¸€ä¸ªè®©çº¤ç¨‹å˜å¾—å¼ºå¤§çš„å…³é”®æ´å¯Ÿï¼š<strong>åœ¨çº¤ç¨‹å†…éƒ¨è¿è¡Œçš„ä»£ç ä¸éœ€è¦çŸ¥é“å®ƒåœ¨çº¤ç¨‹ä¸­</strong>ã€‚</p>
<p>çœ‹çœ‹è¿™ä¸ªï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processData</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$id</span></span>): <span class="hljs-title">string</span> </span>{
    <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">fetchData</span>(<span class="hljs-variable">$id</span>);  <span class="hljs-comment">// è¿™å¯èƒ½ä¼šæŒ‚èµ·ï¼</span>
    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">transform</span>(<span class="hljs-variable">$data</span>);  <span class="hljs-comment">// è¿™ä¹Ÿå¯èƒ½ä¼šæŒ‚èµ·ï¼</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;
}
 
<span class="hljs-comment">// åœ¨çº¤ç¨‹å†…è°ƒç”¨</span>
<span class="hljs-variable">$fiber</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Fiber</span>(<span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params"/>) =&gt;</span> <span class="hljs-title function_ invoke__">processData</span>(<span class="hljs-number">42</span>));
<span class="hljs-variable">$fiber</span>-&gt;<span class="hljs-title function_ invoke__">start</span>();
</code></pre>
<p>ä»Â <code>processData</code>Â çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒåªæ˜¯åœ¨è°ƒç”¨å‡½æ•°å¹¶è¿”å›ç»“æœã€‚å®ƒä¸çŸ¥é“Â <code>fetchData()</code>Â å’ŒÂ <code>transform()</code>Â å¯èƒ½åœ¨å¹•åæŒ‚èµ·çº¤ç¨‹ã€‚å¤æ‚æ€§æ˜¯éšè—çš„ã€‚</p>
<p>è¿™æ­£æ˜¯çº¤ç¨‹éå¸¸é€‚åˆæ„å»ºéšè—å¤æ‚è¡Œä¸ºçš„å¹²å‡€ API çš„åŸå› ã€‚</p>
<h2 data-id="heading-5">å¼‚æ­¥åº“ä¸­çš„çº¤ç¨‹</h2>
<p>ç°åœ¨æˆ‘ä»¬ç†è§£äº†åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä¸ºä»€ä¹ˆæœ‰äº›äººä¼šå°†çº¤ç¨‹ä¸å¼‚æ­¥ä»£ç è”ç³»èµ·æ¥ã€‚è¿™ä¹Ÿä¼šåœ¨æˆ‘ä»¬å¤„ç†ä¸»è¦é—®é¢˜ä¹‹å‰å±•ç¤ºä¸€ä¸ªå…·ä½“çš„ä½¿ç”¨æ¡ˆä¾‹ã€‚</p>
<h3 data-id="heading-6">å¼‚æ­¥é—®é¢˜</h3>
<p>PHP ä¸­çš„ä¼ ç»Ÿå¼‚æ­¥ç¼–ç¨‹çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">// ä½¿ç”¨ promisesï¼ˆçº¤ç¨‹ä¹‹å‰ï¼‰
<span class="hljs-keyword">function</span> fetchUserData(int <span class="hljs-variable">$userId</span>): PromiseInterface {
    <span class="hljs-built_in">return</span> <span class="hljs-variable">$this</span>-&gt;httpClient-&gt;getAsync(<span class="hljs-string">"/users/<span class="hljs-variable">$userId</span>"</span>)
        -&gt;<span class="hljs-keyword">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-variable">$response</span>) {
            <span class="hljs-built_in">return</span> json_decode(<span class="hljs-variable">$response</span>-&gt;getBody());
        })
        -&gt;<span class="hljs-keyword">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-variable">$userData</span>) use (<span class="hljs-variable">$userId</span>) {
            <span class="hljs-built_in">return</span> <span class="hljs-variable">$this</span>-&gt;cache-&gt;setAsync(<span class="hljs-string">"user:<span class="hljs-variable">$userId</span>"</span>, <span class="hljs-variable">$userData</span>);
        })
        -&gt;<span class="hljs-keyword">then</span>(<span class="hljs-keyword">function</span>() use (<span class="hljs-variable">$userId</span>) {
            <span class="hljs-built_in">return</span> <span class="hljs-string">"User <span class="hljs-variable">$userId</span> cached"</span>;
        });
}
</code></pre>
<p>è¿™èƒ½å·¥ä½œï¼Œä½†å¾ˆéš¾é˜…è¯»å’Œç†è§£ã€‚ä½¿ç”¨Â <code>catch()</code>Â çš„é”™è¯¯å¤„ç†ä¼šå˜å¾—æ··ä¹±ã€‚è°ƒè¯•å¾ˆç—›è‹¦ã€‚è€Œä¸”æ„Ÿè§‰ä¸åƒ PHPã€‚</p>
<h3 data-id="heading-7">çº¤ç¨‹è§£å†³æ–¹æ¡ˆ</h3>
<p>æœ‰äº†çº¤ç¨‹ï¼Œåƒ ReactPHP è¿™æ ·çš„åº“å¯ä»¥æä¾›è¿™æ ·çš„æ–¹å¼ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// ä½¿ç”¨çº¤ç¨‹ï¼ˆPHP 8.1 ä¹‹åï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserData</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$userId</span></span>): <span class="hljs-title">string</span> </span>{
    <span class="hljs-variable">$response</span> = <span class="hljs-title function_ invoke__">await</span>(<span class="hljs-variable">$this</span>-&gt;httpClient-&gt;<span class="hljs-title function_ invoke__">getAsync</span>(<span class="hljs-string">"/users/<span class="hljs-subst">$userId</span>"</span>));
 
    <span class="hljs-variable">$userData</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">getBody</span>());
 
    <span class="hljs-title function_ invoke__">await</span>(<span class="hljs-variable">$this</span>-&gt;cache-&gt;<span class="hljs-title function_ invoke__">setAsync</span>(<span class="hljs-string">"user:<span class="hljs-subst">$userId</span>"</span>, <span class="hljs-variable">$userData</span>));
 
    <span class="hljs-keyword">return</span> <span class="hljs-string">"User <span class="hljs-subst">$userId</span> cached"</span>;
}
</code></pre>
<p>å¥½å¤šäº†ï¼ä½†Â <code>await()</code>Â æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">React</span>\<span class="hljs-title class_">Async</span>;
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">await</span>(<span class="hljs-params">PromiseInterface <span class="hljs-variable">$promise</span></span>): <span class="hljs-title">mixed</span> </span>{
    <span class="hljs-comment">// æŒ‚èµ·çº¤ç¨‹å¹¶æ³¨å†Œ promise å›è°ƒ</span>
    <span class="hljs-variable">$result</span> = <span class="hljs-title class_">Fiber</span>::<span class="hljs-title function_ invoke__">suspend</span>([
        <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'await'</span>,
        <span class="hljs-string">'promise'</span> =&gt; <span class="hljs-variable">$promise</span>
    ]);
 
    <span class="hljs-comment">// æ¢å¤æ—¶ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ç»“æœæˆ–å¼‚å¸¸</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span> <span class="hljs-keyword">instanceof</span> \<span class="hljs-built_in">Throwable</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-variable">$result</span>;
    }
 
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;
}
</code></pre>
<p>å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œåƒ PHPStan è¿™æ ·çš„å·¥å…·å¯ä»¥è®©ä½ æ·»åŠ ä¸€äº›æ³›å‹é­”æ³•ï¼Œè¿™æ ·Â <code>await()</code>Â å°±èƒ½å‡†ç¡®çŸ¥é“ä»ä½ çš„ Promise è¿”å›ä»€ä¹ˆã€‚è¿™ç§å¼ºå¤§çš„é™æ€åˆ†ææ„Ÿè§‰å°±åƒé­”æ³•ã€‚å¤šé…·å•Šï¼Ÿ</p>
<p>ä»¥ä¸‹æ˜¯å‘ç”Ÿçš„è¿‡ç¨‹ï¼š</p>
<ol>
<li>ç”¨æˆ·ä»£ç è°ƒç”¨Â <code>await($promise)</code>ï¼ˆåœ¨çº¤ç¨‹å†…éƒ¨ï¼‰</li>
<li><code>await()</code>Â è°ƒç”¨Â <code>Fiber::suspend()</code>Â ä¼ é€’ promise</li>
<li>äº‹ä»¶å¾ªç¯çœ‹åˆ°æŒ‚èµ·çš„çº¤ç¨‹å’Œ promise</li>
<li>äº‹ä»¶å¾ªç¯åœ¨çº¤ç¨‹æŒ‚èµ·æ—¶ç…§å¸¸ç»§ç»­å¤„ç†å…¶ä»–äº‹æƒ…</li>
<li>å½“ promise è§£å†³æ—¶ï¼Œå¾ªç¯è°ƒç”¨Â <code>$fiber-&gt;resume($value)</code></li>
<li>æ‰§è¡Œåœ¨Â <code>await()</code>Â ä¸­ç»§ç»­ï¼Œè¿”å›å€¼</li>
<li>ç”¨æˆ·ä»£ç å¾—åˆ°å€¼ï¼Œå°±åƒå®ƒæ˜¯åŒæ­¥çš„ï¼</li>
</ol>
<p>çº¤ç¨‹åœ¨ç­‰å¾…å¼‚æ­¥æ“ä½œæ—¶æŒ‚èµ·ï¼Œä½†ç”¨æˆ·çš„ä»£ç çœ‹èµ·æ¥å®Œå…¨æ˜¯åŒæ­¥çš„ã€‚</p>
<h3 data-id="heading-8">æ›´è¿›ä¸€æ­¥ï¼šçœŸæ­£é€æ˜çš„å¼‚æ­¥</h3>
<p>ä½†æˆ‘ä»¬å¯ä»¥èµ°å¾—æ›´è¿œï¼åƒ AmPHP è¿™æ ·çš„åº“é€šè¿‡åˆ›å»ºå›´ç»•å¼‚æ­¥æ“ä½œçš„çº¤ç¨‹æ„ŸçŸ¥åŒ…è£…å™¨ï¼Œå°†å…¶æå‡åˆ°æ–°çš„æ°´å¹³ã€‚ä½ ä¸éœ€è¦å•ç‹¬çš„Â <code>getAsync()</code>Â å’ŒÂ <code>await()</code>Â è°ƒç”¨ï¼Œåªéœ€è¦çœ‹èµ·æ¥å®Œå…¨åŒæ­¥çš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// AmPHP æ–¹æ³•ï¼šä¸éœ€è¦ await()ï¼</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserData</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$userId</span></span>): <span class="hljs-title">string</span> </span>{
    <span class="hljs-variable">$response</span> = <span class="hljs-variable language_">$this</span>-&gt;httpClient-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">"/users/<span class="hljs-subst">$userId</span>"</span>);  <span class="hljs-comment">// çœ‹èµ·æ¥åŒæ­¥ï¼Œå®é™…å¼‚æ­¥ï¼</span>
 
    <span class="hljs-variable">$userData</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">getBody</span>());
 
    <span class="hljs-variable language_">$this</span>-&gt;cache-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">"user:<span class="hljs-subst">$userId</span>"</span>, <span class="hljs-variable">$userData</span>);  <span class="hljs-comment">// çœ‹èµ·æ¥åŒæ­¥ï¼Œå®é™…å¼‚æ­¥ï¼</span>
 
    <span class="hljs-keyword">return</span> <span class="hljs-string">"User <span class="hljs-subst">$userId</span> cached"</span>;
}
</code></pre>
<p>ç­‰ç­‰ï¼Œä»€ä¹ˆï¼Ÿæ²¡æœ‰Â <code>await()</code>Â è°ƒç”¨ï¼Ÿè¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</p>
<p>é­”æ³•åœ¨äºÂ <code>get()</code>Â å’ŒÂ <code>set()</code>Â å†…éƒ¨ä½¿ç”¨çº¤ç¨‹ã€‚è¿™æ˜¯ä¸€ä¸ªç®€åŒ–çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpClient</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$url</span></span>): <span class="hljs-title">Response</span> </span>{
        <span class="hljs-comment">// åˆ›å»ºå¼‚æ­¥æ“ä½œ</span>
        <span class="hljs-variable">$promise</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">performAsyncRequest</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-variable">$url</span>);
 
        <span class="hljs-comment">// æŒ‚èµ·å½“å‰çº¤ç¨‹å¹¶å°† promise ä¼ é€’ç»™äº‹ä»¶å¾ªç¯</span>
        <span class="hljs-variable">$response</span> = <span class="hljs-title class_">\Fiber</span>::<span class="hljs-title function_ invoke__">suspend</span>([
            <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'await'</span>,
            <span class="hljs-string">'promise'</span> =&gt; <span class="hljs-variable">$promise</span>
        ]);
 
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$response</span> <span class="hljs-keyword">instanceof</span> \<span class="hljs-built_in">Throwable</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-variable">$response</span>;
        }
 
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$response</span>;
    }
}
</code></pre>
<p>ä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œä»–ä»¬åªæ˜¯è°ƒç”¨äº†Â <code>get()</code>Â å¹¶å¾—åˆ°äº†å“åº”ã€‚ä»–ä»¬å®Œå…¨ä¸çŸ¥é“è¿™æ˜¯å¼‚æ­¥çš„ã€‚</p>
<p>è¿™å°±æ˜¯çº¤ç¨‹çš„ç²¾é«“ï¼šè®©å¼‚æ­¥æ“ä½œå®Œå…¨é€æ˜ã€‚ç”¨æˆ·ç¼–å†™çœ‹èµ·æ¥åƒé˜»å¡çš„åŒæ­¥ PHP ä»£ç ã€‚åº“ä½¿ç”¨çº¤ç¨‹åœ¨å¹•åå¤„ç†æ‰€æœ‰å¼‚æ­¥å¤æ‚æ€§ã€‚</p>
<h3 data-id="heading-9">æ¯”è¾ƒè¿™äº›æ–¹æ³•</h3>
<p>è®©æˆ‘ä»¬çœ‹çœ‹æ¼”å˜è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// 1. ä¼ ç»Ÿå¼‚æ­¥ä¸ promisesï¼ˆæ— çº¤ç¨‹ï¼‰</span>
<span class="hljs-variable">$promise</span> = <span class="hljs-variable language_">$this</span>-&gt;httpClient-&gt;<span class="hljs-title function_ invoke__">getAsync</span>(<span class="hljs-string">"/users/<span class="hljs-subst">$userId</span>"</span>)
    -&gt;<span class="hljs-title function_ invoke__">then</span>(fn(<span class="hljs-variable">$response</span>) =&gt; <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">getBody</span>()))
    -&gt;<span class="hljs-title function_ invoke__">then</span>(fn(<span class="hljs-variable">$userData</span>) =&gt; <span class="hljs-variable language_">$this</span>-&gt;cache-&gt;<span class="hljs-title function_ invoke__">setAsync</span>(<span class="hljs-string">"user:<span class="hljs-subst">$userId</span>"</span>, <span class="hljs-variable">$userData</span>))
    -&gt;<span class="hljs-title function_ invoke__">then</span>(fn() =&gt; <span class="hljs-string">"User <span class="hljs-subst">$userId</span> cached"</span>);
 
<span class="hljs-comment">// 2. ä½¿ç”¨ await() è¾…åŠ©å‡½æ•°çš„å¼‚æ­¥ï¼ˆä½¿ç”¨çº¤ç¨‹ï¼‰</span>
<span class="hljs-variable">$response</span> = <span class="hljs-title function_ invoke__">await</span>(<span class="hljs-variable">$this</span>-&gt;httpClient-&gt;<span class="hljs-title function_ invoke__">getAsync</span>(<span class="hljs-string">"/users/<span class="hljs-subst">$userId</span>"</span>));
<span class="hljs-variable">$userData</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">getBody</span>());
<span class="hljs-title function_ invoke__">await</span>(<span class="hljs-variable">$this</span>-&gt;cache-&gt;<span class="hljs-title function_ invoke__">setAsync</span>(<span class="hljs-string">"user:<span class="hljs-subst">$userId</span>"</span>, <span class="hljs-variable">$userData</span>));
<span class="hljs-keyword">return</span> <span class="hljs-string">"User <span class="hljs-subst">$userId</span> cached"</span>;
 
<span class="hljs-comment">// 3. å®Œå…¨é€æ˜çš„å¼‚æ­¥ï¼ˆçº¤ç¨‹éšè—åœ¨åº“ä¸­ï¼‰</span>
<span class="hljs-variable">$response</span> = <span class="hljs-variable language_">$this</span>-&gt;httpClient-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">"/users/<span class="hljs-subst">$userId</span>"</span>);
<span class="hljs-variable">$userData</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">getBody</span>());
<span class="hljs-variable language_">$this</span>-&gt;cache-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">"user:<span class="hljs-subst">$userId</span>"</span>, <span class="hljs-variable">$userData</span>);
<span class="hljs-keyword">return</span> <span class="hljs-string">"User <span class="hljs-subst">$userId</span> cached"</span>;
</code></pre>
<p>æ³¨æ„æ–¹æ³• #3 çœ‹èµ·æ¥ä¸åŒæ­¥ä»£ç å®Œå…¨ä¸€æ ·ï¼Ÿè¿™å°±æ˜¯æ­£ç¡®ä½¿ç”¨çº¤ç¨‹çš„åŠ›é‡ã€‚åº“å¼€å‘è€…å¤„ç†ä¸€æ¬¡å¤æ‚æ€§ã€‚æ¯ä¸ªç”¨æˆ·éƒ½å—ç›Šäºä¸€ä¸ªå¹²å‡€çš„ã€çœ‹èµ·æ¥åŒæ­¥çš„ APIï¼Œå®é™…ä¸Šåœ¨åº•å±‚æ˜¯å¼‚æ­¥çš„ã€‚</p>
<h3 data-id="heading-10">ä¸ºä»€ä¹ˆè¿™å¯¼è‡´äº†è¯¯è§£</h3>
<p>å› ä¸ºçº¤ç¨‹æœ€æ˜¾çœ¼çš„ç”¨é€”æ˜¯è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åŒæ­¥ï¼Œå¼€å‘è€…å‡è®¾çº¤ç¨‹æœ¬èº«å°±æ˜¯å¼‚æ­¥æœºåˆ¶ã€‚ä½†çº¤ç¨‹æœ¬èº«ä¸åšä»»ä½•å¼‚æ­¥æ“ä½œã€‚å®ƒä»¬åªæ˜¯æä¾›æŒ‚èµ·/æ¢å¤æœºåˆ¶ï¼Œä½¿å¾—çœ‹èµ·æ¥åŒæ­¥çš„å¼‚æ­¥ä»£ç æˆä¸ºå¯èƒ½ã€‚</p>
<p>äº‹ä»¶å¾ªç¯ä»åœ¨åšå®é™…çš„å¼‚æ­¥å·¥ä½œã€‚çº¤ç¨‹åªæ˜¯è®© API æ›´å¥½ç”¨ã€‚</p>
<p>è¿™ä¸ªåŒºåˆ«è‡³å…³é‡è¦ï¼š<strong>çº¤ç¨‹æ˜¯ç®¡ç†æ‰§è¡Œæµçš„å·¥å…·ï¼Œè€Œä¸æ˜¯å®ç°å¹¶è¡Œæˆ–å¼‚æ­¥çš„å·¥å…·</strong>ã€‚</p>
<h2 data-id="heading-11">çœŸæ­£çš„é—®é¢˜ï¼šMCP SDK ä¸­çš„å®¢æˆ·ç«¯é€šä¿¡</h2>
<p>ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥æœ¬æ–‡çš„æ ¸å¿ƒé—®é¢˜ã€‚åœ¨å¼€å‘ Model Context Protocol (MCP) çš„ PHP å®ç°æ—¶ï¼Œå¼€å‘å›¢é˜Ÿé‡åˆ°äº†ä¸€ä¸ªä¼¼ä¹æ— æ³•ä¼˜é›…è§£å†³çš„è®¾è®¡æŒ‘æˆ˜ã€‚</p>
<h3 data-id="heading-12">ä»€ä¹ˆæ˜¯ MCPï¼Ÿ</h3>
<p>Model Context Protocol æ˜¯è¿æ¥ AI åŠ©æ‰‹ï¼ˆå¦‚ Claudeï¼‰ä¸å¤–éƒ¨å·¥å…·å’Œæ•°æ®æºçš„æ ‡å‡†ã€‚</p>
<p>ä¸€ä¸ª MCP æœåŠ¡å™¨æš´éœ²ï¼š</p>
<ul>
<li><strong>å·¥å…·</strong>ï¼šAI å¯ä»¥è°ƒç”¨çš„å‡½æ•°ï¼ˆä¾‹å¦‚ï¼š"æœç´¢æ•°æ®åº“"ã€"å‘é€é‚®ä»¶"ï¼‰</li>
<li><strong>èµ„æº</strong>ï¼šAI å¯ä»¥è¯»å–çš„æ•°æ®ï¼ˆä¾‹å¦‚ï¼š"é¡¹ç›®æ–‡ä»¶"ã€"API æ–‡æ¡£"ï¼‰</li>
<li><strong>æç¤º</strong>ï¼šAI å¯ä»¥ä½¿ç”¨çš„æ¨¡æ¿</li>
</ul>
<p>è¯¥åè®®æ˜¯åŒå‘çš„ JSON-RPCï¼Œæ”¯æŒä¸åŒçš„ä¼ è¾“æ–¹å¼ï¼ˆSTDIOã€HTTP + SSEã€è‡ªå®šä¹‰ï¼‰ã€‚</p>
<h3 data-id="heading-13">æŒ‘æˆ˜</h3>
<p>MCP è§„èŒƒåŒ…å«æœåŠ¡å™¨åœ¨è¯·æ±‚å¤„ç†æœŸé—´ä¸å®¢æˆ·ç«¯é€šä¿¡çš„åŠŸèƒ½ï¼š</p>
<ul>
<li><strong>æ—¥å¿—è®°å½•</strong>ï¼šå‘å®¢æˆ·ç«¯å‘é€æ—¥å¿—æ¶ˆæ¯</li>
<li><strong>è¿›åº¦æ›´æ–°</strong>ï¼šæ›´æ–°å®¢æˆ·ç«¯å…³äºé•¿æ—¶é—´è¿è¡Œæ“ä½œçš„è¿›åº¦</li>
<li><strong>é‡‡æ ·</strong>ï¼šè¯·æ±‚å®¢æˆ·ç«¯ä½¿ç”¨å…¶ LLM ç”Ÿæˆæ–‡æœ¬</li>
</ul>
<p>è¿™äº›ä¸ä»…ä»…æ˜¯å“åº”ç±»å‹ã€‚ä¸ï¼Œé—®é¢˜æ˜¯å®ƒä»¬éœ€è¦åœ¨å·¥å…·æ‰§è¡ŒæœŸé—´å‘ç”Ÿã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">å®¢æˆ·ç«¯: <span class="hljs-string">"å˜¿æœåŠ¡å™¨ï¼Œè¿è¡Œ 'analyze_dataset' å·¥å…·"</span>
æœåŠ¡å™¨: <span class="hljs-string">"å¼€å§‹..."</span> [å‘é€æ—¥å¿—]
æœåŠ¡å™¨: <span class="hljs-string">"25% å®Œæˆ"</span> [å‘é€è¿›åº¦]
æœåŠ¡å™¨: <span class="hljs-string">"50% å®Œæˆ"</span> [å‘é€è¿›åº¦]
æœåŠ¡å™¨: <span class="hljs-string">"ç”Ÿæˆæ‘˜è¦ï¼Œéœ€è¦ä½ çš„ LLM"</span> [å‘é€é‡‡æ ·è¯·æ±‚]
å®¢æˆ·ç«¯: <span class="hljs-string">"è¿™æ˜¯ç”Ÿæˆçš„æ‘˜è¦"</span> [å“åº”é‡‡æ ·]
æœåŠ¡å™¨: <span class="hljs-string">"å®Œæˆï¼è¿™æ˜¯å®Œæ•´ç»“æœ"</span> [å‘é€æœ€ç»ˆå“åº”]
</code></pre>
<p>æœåŠ¡å™¨éœ€è¦ï¼š</p>
<ol>
<li>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘é€æ¶ˆæ¯</li>
<li>ç­‰å¾…æ¥è‡ªå®¢æˆ·ç«¯çš„å“åº”</li>
<li>åœ¨æ”¶åˆ°å“åº”åç»§ç»­æ‰§è¡Œ</li>
<li>è®©æ‰€æœ‰è¿™äº›æ„Ÿè§‰èµ·æ¥å¾ˆè‡ªç„¶</li>
</ol>
<h3 data-id="heading-14">API éœ€æ±‚</h3>
<p>åœ¨ MCP SDK æ–¹é¢ï¼Œä¼˜å…ˆäº‹é¡¹ä¹‹ä¸€æ˜¯ä½¿å…¶æå…¶æ˜“ç”¨ã€‚å¼€å‘å›¢é˜Ÿå¸Œæœ›å¼€å‘è€…è¿™æ ·ç¼–å†™å·¥å…·ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">addTool</span>(
    function (<span class="hljs-keyword">string</span> <span class="hljs-variable">$dataset</span>, ClientGateway <span class="hljs-variable">$client</span>): <span class="hljs-keyword">array</span> {
        <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-title class_">LoggingLevel</span>::<span class="hljs-variable constant_">Info</span>, <span class="hljs-string">"å¼€å§‹åˆ†æ"</span>);
 
        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$steps</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$step</span>) {
            <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">progress</span>(<span class="hljs-variable">$progress</span>, <span class="hljs-number">1</span>, <span class="hljs-variable">$step</span>);
            <span class="hljs-title function_ invoke__">doWork</span>(<span class="hljs-variable">$step</span>);
        }
 
        <span class="hljs-variable">$summary</span> = <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">sample</span>(<span class="hljs-string">"æ€»ç»“è¿™äº›æ•°æ®ï¼š..."</span>);
 
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'status'</span> =&gt; <span class="hljs-string">'complete'</span>, <span class="hljs-string">'summary'</span> =&gt; <span class="hljs-variable">$summary</span>];
    },
    name: <span class="hljs-string">'analyze_dataset'</span>
);
</code></pre>
<p>çœ‹çœ‹è¿™æ®µä»£ç ã€‚å®ƒå¾ˆæ¼‚äº®ã€‚å®ƒå¾ˆç®€å•ã€‚å®ƒçœ‹èµ·æ¥å®Œå…¨æ˜¯åŒæ­¥çš„ã€‚æ²¡æœ‰å›è°ƒï¼Œæ²¡æœ‰ promisesï¼Œæ²¡æœ‰ async/await è¯­æ³•ï¼Œæ²¡æœ‰ yield ç”Ÿæˆå™¨ã€‚åªæ˜¯æ™®é€šçš„ PHPã€‚</p>
<p>ä½†åœ¨åº•å±‚ï¼Œè¿™éœ€è¦ï¼š</p>
<ol>
<li>å‘å®¢æˆ·ç«¯å‘é€ JSON-RPC é€šçŸ¥ï¼ˆæ—¥å¿—ã€è¿›åº¦ï¼‰</li>
<li>å‘é€ JSON-RPC è¯·æ±‚å¹¶ç­‰å¾…å“åº”ï¼ˆé‡‡æ ·ï¼‰</li>
<li>ä¸ä»»ä½•ä¼ è¾“æ–¹å¼å·¥ä½œï¼Œæ— è®ºæ˜¯å¦é˜»å¡ï¼</li>
<li>æ— è®ºä½ ä½¿ç”¨åŸç”Ÿ PHPã€ReactPHPã€Swoole è¿˜æ˜¯ RoadRunner éƒ½èƒ½å·¥ä½œ</li>
</ol>
<p>å¦‚ä½•å®ç°ï¼Ÿ</p>
<h3 data-id="heading-15">ä¸ºä»€ä¹ˆä¼ ç»Ÿæ–¹æ³•è¡Œä¸é€š</h3>
<p>å¼€å‘å›¢é˜ŸèŠ±äº†å‡ ä¸ªå°æ—¶è€ƒè™‘ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼š</p>
<p><strong>é€‰é¡¹ 1ï¼šè®©ä¸€åˆ‡éƒ½å¼‚æ­¥</strong></p>
<pre><code class="hljs language-bash" lang="bash">// åŸºäº Promise çš„æ–¹æ³• - åµŒå¥—ä¸”æ··ä¹±
<span class="hljs-variable">$server</span>-&gt;addTool(<span class="hljs-keyword">function</span> (string <span class="hljs-variable">$dataset</span>, <span class="hljs-variable">$client</span>) {
    <span class="hljs-built_in">return</span> <span class="hljs-variable">$client</span>-&gt;logAsync(LoggingLevel::Info, <span class="hljs-string">"å¼€å§‹åˆ†æ"</span>)
        -&gt;<span class="hljs-keyword">then</span>(<span class="hljs-keyword">function</span>() use (<span class="hljs-variable">$client</span>) {
            <span class="hljs-built_in">return</span> <span class="hljs-variable">$client</span>-&gt;progressAsync(0.33, 1, <span class="hljs-string">"æ­¥éª¤ 1"</span>);
        })
        -&gt;<span class="hljs-keyword">then</span>(<span class="hljs-keyword">function</span>() use (<span class="hljs-variable">$client</span>) {
            <span class="hljs-built_in">return</span> <span class="hljs-variable">$client</span>-&gt;progressAsync(0.66, 1, <span class="hljs-string">"æ­¥éª¤ 2"</span>);
        })
        -&gt;<span class="hljs-keyword">then</span>(<span class="hljs-keyword">function</span>() use (<span class="hljs-variable">$client</span>) {
            <span class="hljs-built_in">return</span> <span class="hljs-variable">$client</span>-&gt;sampleAsync(<span class="hljs-string">"æ€»ç»“..."</span>);
        })
        -&gt;<span class="hljs-keyword">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-variable">$summary</span>) {
            <span class="hljs-built_in">return</span> [<span class="hljs-string">'status'</span> =&gt; <span class="hljs-string">'complete'</span>, <span class="hljs-string">'summary'</span> =&gt; <span class="hljs-variable">$summary</span>];
        });
});
</code></pre>
<p>å›è°ƒåµŒå¥—å¾ˆå¿«å°±ä¼šå˜å¾—ç¬¨æ‹™ã€‚å³ä½¿ä½¿ç”¨Â <code>await()</code>Â è¾…åŠ©å‡½æ•°æ¥ç®€åŒ–ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">addTool</span>(function (<span class="hljs-keyword">string</span> <span class="hljs-variable">$dataset</span>, <span class="hljs-variable">$client</span>) {
    <span class="hljs-title function_ invoke__">await</span>(<span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">logAsync</span>(<span class="hljs-title class_">LoggingLevel</span>::<span class="hljs-variable constant_">Info</span>, <span class="hljs-string">"å¼€å§‹"</span>));
    <span class="hljs-title function_ invoke__">await</span>(<span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">progressAsync</span>(<span class="hljs-number">0.33</span>, <span class="hljs-number">1</span>, <span class="hljs-string">"æ­¥éª¤ 1"</span>));
    <span class="hljs-title function_ invoke__">await</span>(<span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">progressAsync</span>(<span class="hljs-number">0.66</span>, <span class="hljs-number">1</span>, <span class="hljs-string">"æ­¥éª¤ 2"</span>));
    <span class="hljs-variable">$summary</span> = <span class="hljs-title function_ invoke__">await</span>(<span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">sampleAsync</span>(<span class="hljs-string">"æ€»ç»“..."</span>));
    <span class="hljs-keyword">return</span> [<span class="hljs-string">'status'</span> =&gt; <span class="hljs-string">'complete'</span>, <span class="hljs-string">'summary'</span> =&gt; <span class="hljs-variable">$summary</span>];
});
</code></pre>
<p>è¿™å¼ºåˆ¶æ¯ä¸ªäººå­¦ä¹ å¼‚æ­¥ PHPã€‚å®ƒä½¿å¼‚æ­¥åº“æˆä¸ºæ ¸å¿ƒä¾èµ–ï¼Œå¹¶å°† SDK é™åˆ¶åœ¨é€‰æ‹©çš„å¼‚æ­¥è¿è¡Œæ—¶ã€‚ä¸æœåŠ¡å™¨è¯·æ±‚å’Œå“åº”çš„ PSR-7 ä¸åŒï¼ŒPHP ä¸­æ²¡æœ‰äº‹ä»¶å¾ªç¯æˆ–å¼‚æ­¥è¿è¡Œæ—¶çš„æ ‡å‡†ï¼Œå› æ­¤ä¾›åº”å•†é”å®šä¸æ˜¯ä¸€ä¸ªé€‰é¡¹ã€‚å¯¹äºç®€å•çš„å·¥å…·æ¥è¯´ï¼Œè¿™ä¹Ÿæ˜¯è¿‡åº¦æ€ä¼¤ã€‚è¢«æ‹’ç»ã€‚</p>
<p><strong>é€‰é¡¹ 2ï¼šå›è°ƒ</strong></p>
<pre><code class="hljs language-bash" lang="bash">// å›è°ƒåœ°ç‹±è­¦å‘Šï¼
<span class="hljs-variable">$server</span>-&gt;addTool(<span class="hljs-keyword">function</span> (string <span class="hljs-variable">$dataset</span>, <span class="hljs-variable">$client</span>) {
    <span class="hljs-variable">$client</span>-&gt;<span class="hljs-built_in">log</span>(..., <span class="hljs-keyword">function</span>() use (<span class="hljs-variable">$client</span>) {
        <span class="hljs-variable">$client</span>-&gt;progress(..., <span class="hljs-keyword">function</span>() use (<span class="hljs-variable">$client</span>) {
            <span class="hljs-variable">$client</span>-&gt;sample(..., <span class="hljs-keyword">function</span>(<span class="hljs-variable">$summary</span>) {
                <span class="hljs-built_in">return</span> [<span class="hljs-string">'summary'</span> =&gt; <span class="hljs-variable">$summary</span>];
            });
        });
    });
});
</code></pre>
<p>æ²¡äººæƒ³è¦è¿™ä¸ªã€‚æ— éœ€è¿›ä¸€æ­¥è§£é‡Šã€‚è¢«æ‹’ç»ã€‚</p>
<p><strong>é€‰é¡¹ 3ï¼šçŠ¶æ€æœºå’Œåºåˆ—åŒ–</strong></p>
<p>å¦‚æœæˆ‘ä»¬è·Ÿè¸ªæ‰§è¡ŒçŠ¶æ€å¹¶ä»æ£€æŸ¥ç‚¹é‡æ–°æ‰§è¡Œå¤„ç†ç¨‹åºä¼šæ€ä¹ˆæ ·ï¼Ÿ</p>
<pre><code class="hljs language-ini" lang="ini">// ä¼ªä»£ç 
if ($state-&gt;<span class="hljs-attr">step</span> === <span class="hljs-number">0</span>) {
    $client-&gt;log(...)<span class="hljs-comment">;</span>
    $state-&gt;<span class="hljs-attr">step</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
    return $state-&gt;serialize()<span class="hljs-comment">;</span>
}
if ($state-&gt;<span class="hljs-attr">step</span> === <span class="hljs-number">1</span>) {
    $client-&gt;progress(...)<span class="hljs-comment">;</span>
    $state-&gt;<span class="hljs-attr">step</span> = <span class="hljs-number">2</span><span class="hljs-comment">;</span>
    return $state-&gt;serialize()<span class="hljs-comment">;</span>
}
// ...ä»¥æ­¤ç±»æ¨
</code></pre>
<p>è¿™éå¸¸å¤æ‚ã€‚å³ä½¿æŠ½è±¡éƒ¨åˆ†å†…å®¹å¹¶å…è®¸ç”¨æˆ·ç¼–å†™åŒæ­¥ä»£ç ï¼Œè·Ÿè¸ªçŠ¶æ€ä¹Ÿæœ‰å¾ˆå¤šå·¥ä½œè¦åšã€‚å¦‚ä½•åºåˆ—åŒ–é—­åŒ…ï¼Ÿå¦‚ä½•æ¢å¤å±€éƒ¨å˜é‡ï¼Ÿå¦‚ä½•å¤„ç†å¾ªç¯ï¼Ÿè¿™å°†éœ€è¦å®Œå…¨æ”¹å˜ç”¨æˆ·ç¼–å†™å·¥å…·çš„æ–¹å¼ã€‚è¢«æ‹’ç»ã€‚</p>
<p><strong>é€‰é¡¹ 4ï¼šå¸¦ yield çš„ç”Ÿæˆå™¨</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">addTool</span>(function (<span class="hljs-keyword">string</span> <span class="hljs-variable">$dataset</span>, <span class="hljs-variable">$client</span>)https:<span class="hljs-comment">//www.falvce.com/ {</span>
    <span class="hljs-keyword">yield</span> <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(...);
    <span class="hljs-keyword">yield</span> <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">progress</span>(...);
    <span class="hljs-variable">$summary</span> = <span class="hljs-keyword">yield</span> <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">sample</span>(...);
    <span class="hljs-keyword">return</span> [<span class="hljs-string">'summary'</span> =&gt; <span class="hljs-variable">$summary</span>];
});
</code></pre>
<p>è¿™æ›´æ¥è¿‘äº†ï¼Œä½†ç”Ÿæˆå™¨æœ‰é™åˆ¶ã€‚ä½ ä¸èƒ½è½»æ¾åœ°ä»åµŒå¥—å‡½æ•°è°ƒç”¨ä¸­ yieldã€‚è¯­æ³•å¾ˆç¬¨æ‹™ã€‚ç”¨æˆ·éœ€è¦ç†è§£ç”Ÿæˆå™¨ã€‚ä¸ç†æƒ³ï¼Œä½†å¯è¡Œã€‚</p>
<p><strong>é€‰é¡¹ 5ï¼šPHP çº¤ç¨‹</strong></p>
<p>å¦‚æœæŒ‚èµ·/æ¢å¤æ˜¯ä¸å¯è§çš„ä¼šæ€ä¹ˆæ ·ï¼Ÿå¦‚æœÂ <code>$client-&gt;log()</code>Â çœ‹èµ·æ¥åƒä¸€ä¸ªæ™®é€šçš„æ–¹æ³•è°ƒç”¨ï¼Œä½†åœ¨å¹•åå®ƒæŒ‚èµ·çº¤ç¨‹ï¼Œå‘é€æ¶ˆæ¯ï¼Œç„¶åæ¢å¤å‘¢ï¼Ÿ</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// ç”¨æˆ·ç¼–å†™çš„å†…å®¹ï¼ˆçœ‹èµ·æ¥æ˜¯åŒæ­¥çš„ï¼ï¼‰</span>
<span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">addTool</span>(function (<span class="hljs-keyword">string</span> <span class="hljs-variable">$dataset</span>, <span class="hljs-variable">$client</span>) {
    <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(...);  <span class="hljs-comment">// å†…éƒ¨æŒ‚èµ·</span>
    <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">progress</span>(...);  <span class="hljs-comment">// å†…éƒ¨æŒ‚èµ·</span>
    <span class="hljs-variable">$summary</span> = <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">sample</span>(...);  <span class="hljs-comment">// æŒ‚èµ·å¹¶ç­‰å¾…</span>
    <span class="hljs-keyword">return</span> [<span class="hljs-string">'summary'</span> =&gt; <span class="hljs-variable">$summary</span>];
});
</code></pre>
<p>å°±æ˜¯è¿™ä¸ªã€‚è¿™å°±æ˜¯è§£å†³æ–¹æ¡ˆã€‚ç”¨æˆ·ç¼–å†™æ™®é€šçš„ PHPã€‚SDK å¤„ç†æ‰€æœ‰å¤æ‚æ€§ã€‚</p>
<h3 data-id="heading-16">"å•Šå“ˆï¼"æ—¶åˆ»</h3>
<p>å½“å¼€å‘å›¢é˜Ÿæ„è¯†åˆ°çº¤ç¨‹æ˜¯ç­”æ¡ˆæ—¶ï¼Œä¸€åˆ‡éƒ½è±ç„¶å¼€æœ—äº†ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬å®Œç¾çš„åŸå› ï¼š</p>
<ul>
<li><strong>é€æ˜</strong>ï¼šç”¨æˆ·ä»£ç ä¸éœ€è¦çŸ¥é“çº¤ç¨‹</li>
<li><strong>çµæ´»</strong>ï¼šé€‚ç”¨äºä»»ä½•ä¼ è¾“ï¼ˆé˜»å¡æˆ–éé˜»å¡ï¼‰</li>
<li><strong>ç®€å•</strong>ï¼šAPI åªæ˜¯å¸¸è§„æ–¹æ³•è°ƒç”¨</li>
<li><strong>å¼ºå¤§</strong>ï¼šå®Œå…¨æ§åˆ¶æ‰§è¡Œæµ</li>
<li><strong>é€šç”¨</strong>ï¼šé€‚ç”¨äºåŒæ­¥ PHPã€å¼‚æ­¥ PHPã€ä»»ä½•è¿è¡Œæ—¶</li>
</ul>
<p>çº¤ç¨‹è®©å¼€å‘å›¢é˜Ÿèƒ½å¤Ÿåœ¨å¹²å‡€çš„ã€çœ‹èµ·æ¥åŒæ­¥çš„ API èƒŒåéšè—åŒå‘é€šä¿¡çš„å¤æ‚æ€§ã€‚ç”¨æˆ·ç¼–å†™ç®€å•çš„å‡½æ•°ã€‚SDK ç®¡ç†çº¤ç¨‹ç”Ÿå‘½å‘¨æœŸã€‚ä¼ è¾“å¤„ç†å®é™…çš„ I/Oã€‚</p>
<p>è¿™æ˜¯å®Œç¾çš„å…³æ³¨ç‚¹åˆ†ç¦»ã€‚</p>
<h2 data-id="heading-17">æ€è€ƒè¿‡ç¨‹ï¼šä¸ºä»€ä¹ˆçº¤ç¨‹åœ¨è¿™é‡Œæœ‰æ•ˆ</h2>
<p>è®©æˆ‘ä»¬æ·±å…¥äº†è§£ä¸ºä»€ä¹ˆçº¤ç¨‹ç‰¹åˆ«é€‚åˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 data-id="heading-18">æ ¸å¿ƒæŒ‘æˆ˜</h3>
<p>å½“å·¥å…·å¤„ç†ç¨‹åºè°ƒç”¨Â <code>$client-&gt;log()</code>Â æ—¶ï¼Œéœ€è¦ï¼š</p>
<ol>
<li>æš‚åœå¤„ç†ç¨‹åºçš„æ‰§è¡Œ</li>
<li>å‘å®¢æˆ·ç«¯å‘é€ JSON-RPC é€šçŸ¥ï¼ˆæœºåˆ¶å–å†³äºä¼ è¾“ï¼‰</li>
<li>ç«‹å³æ¢å¤å¤„ç†ç¨‹åºï¼ˆæ—¥å¿—è®°å½•ä¸éœ€è¦ç­‰å¾…ï¼‰</li>
</ol>
<p>å½“å·¥å…·å¤„ç†ç¨‹åºè°ƒç”¨Â <code>$client-&gt;sample()</code>Â æ—¶ï¼Œéœ€è¦ï¼š</p>
<ol>
<li>æš‚åœå¤„ç†ç¨‹åºçš„æ‰§è¡Œ</li>
<li>å‘å®¢æˆ·ç«¯å‘é€ JSON-RPC è¯·æ±‚ï¼ˆæœºåˆ¶å–å†³äºä¼ è¾“ï¼‰</li>
<li>ç­‰å¾…å®¢æˆ·ç«¯çš„å“åº”ï¼ˆå¦‚ä½•æ¥æ”¶å“åº”ä¹Ÿå–å†³äºä¼ è¾“ï¼‰</li>
<li>ä½¿ç”¨å“åº”æ¢å¤å¤„ç†ç¨‹åº</li>
</ol>
<p>å…³é”®æ´å¯Ÿï¼šéœ€è¦ç¦»å¼€å¤„ç†ç¨‹åºçš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œåšå…¶ä»–äº‹æƒ…ï¼Œç„¶ååœ¨ç‰¹å®šç‚¹è¿”å›ã€‚è€Œä¸”éœ€è¦èƒ½å¤Ÿå¤šæ¬¡è¿™æ ·åšã€‚è¿™æ­£æ˜¯çº¤ç¨‹æä¾›çš„åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-19">æ¶æ„</h3>
<p>è§£å†³æ–¹æ¡ˆæœ‰ä¸‰å±‚ï¼š</p>
<ol>
<li>
<p><strong>ClientGatewayï¼ˆé¢å‘ç”¨æˆ·çš„ APIï¼‰</strong></p>
<ul>
<li>æä¾›Â <code>log()</code>ã€<code>progress()</code>ã€<code>sample()</code>Â ç­‰æ–¹æ³•</li>
<li>å†…éƒ¨è°ƒç”¨Â <code>Fiber::suspend()</code>Â ä¼ é€’æ¶ˆæ¯æ•°æ®</li>
<li>æ¢å¤æ—¶è¿”å›å“åº”</li>
</ul>
</li>
<li>
<p><strong>Protocolï¼ˆç¼–æ’å±‚ï¼‰</strong></p>
<ul>
<li>å°†å¤„ç†ç¨‹åºæ‰§è¡ŒåŒ…è£…åœ¨çº¤ç¨‹ä¸­</li>
<li>æ£€æµ‹çº¤ç¨‹ä½•æ—¶æŒ‚èµ·</li>
<li>æå–æŒ‚èµ·çš„å€¼ï¼ˆé€šçŸ¥æˆ–è¯·æ±‚ï¼‰</li>
<li>å°†çº¤ç¨‹ç§»äº¤ç»™ä¼ è¾“å±‚</li>
</ul>
</li>
<li>
<p><strong>Transportï¼ˆI/O å±‚ï¼‰</strong></p>
<ul>
<li>è·å–æŒ‚èµ·çº¤ç¨‹çš„æ‰€æœ‰æƒ</li>
<li>å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ï¼ˆå“åº”ã€è¯·æ±‚å’Œé€šçŸ¥ï¼‰</li>
<li>ç­‰å¾…å“åº”ï¼ˆå¦‚æœéœ€è¦ï¼‰</li>
<li>å‡†å¤‡å°±ç»ªæ—¶æ¢å¤çº¤ç¨‹</li>
</ul>
</li>
</ol>
<p>æ¯ä¸€å±‚éƒ½æœ‰æ˜ç¡®çš„èŒè´£ã€‚é­”æ³•åœ¨äºå®ƒä»¬å¦‚ä½•åè°ƒã€‚</p>
<h3 data-id="heading-20">ä¸ºä»€ä¹ˆå®ƒåŒæ—¶é€‚ç”¨äºåŒæ­¥å’Œå¼‚æ­¥</h3>
<p>è¿™ç§æ–¹æ³•çš„ç¾å¦™ä¹‹å¤„åœ¨äºçº¤ç¨‹ä¸ä¼ è¾“æ— å…³ã€‚æ— è®ºä½ ä½¿ç”¨çš„æ˜¯ï¼š</p>
<ul>
<li><strong>Stdio</strong>ï¼ˆé˜»å¡ï¼Œå•è¿›ç¨‹ï¼‰- å®˜æ–¹ SDK çš„ä¸€éƒ¨åˆ†</li>
<li><strong>HTTP ä¸ PHP-FPM</strong>ï¼ˆæ— çŠ¶æ€ï¼Œå¤šè¿›ç¨‹ï¼‰- å®˜æ–¹ SDK çš„ä¸€éƒ¨åˆ†</li>
<li><strong>ReactPHP</strong>ï¼ˆéé˜»å¡ï¼Œäº‹ä»¶é©±åŠ¨ï¼‰- å±•ç¤ºå¼‚æ­¥å…¼å®¹æ€§çš„å¤–éƒ¨ç¤ºä¾‹</li>
<li><strong>Swoole</strong>ï¼ˆåŸºäºåç¨‹ï¼‰- ä½¿ç”¨ç›¸åŒæ¶æ„å¯è¡Œ</li>
</ul>
<p>æŒ‚èµ·/æ¢å¤æœºåˆ¶éƒ½æ˜¯ç›¸åŒçš„ã€‚ä¼ è¾“æ ¹æ®å…¶æ‰§è¡Œæ¨¡å‹å†³å®šä½•æ—¶æ¢å¤çº¤ç¨‹ã€‚çº¤ç¨‹æœ¬èº«ä¸å…³å¿ƒã€‚å®ƒåªæ˜¯æŒ‚èµ·å’Œç­‰å¾…ã€‚</p>
<p>å¯¹äºé˜»å¡ä¼ è¾“ï¼Œæ¢å¤å‘ç”Ÿåœ¨åŒä¸€è¿›ç¨‹çš„å¾ªç¯ä¸­ã€‚å¯¹äºéé˜»å¡ä¼ è¾“ï¼Œæ¢å¤é€šè¿‡äº‹ä»¶å¾ªç¯å›è°ƒå‘ç”Ÿã€‚å¯¹äºå¤šè¿›ç¨‹ä¼ è¾“ï¼Œå½“ä»å…±äº«ä¼šè¯ä¸­æå–å“åº”æ—¶æ¢å¤å‘ç”Ÿã€‚çº¤ç¨‹ä¸å…³å¿ƒè¿™äº›ç»†èŠ‚ã€‚</p>
<h2 data-id="heading-21">å®ç°ï¼šæ¶æ„æ¦‚è¿°</h2>
<p>ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥å®é™…å®ç°ã€‚ä¸‹é¢å°†å±•ç¤ºä¸€äº›æ¥è‡ª PHP MCP SDK çš„çœŸå®ä»£ç ï¼Œå¹¶è§£é‡Šä¸€åˆ‡å¦‚ä½•ç»„åˆåœ¨ä¸€èµ·ã€‚</p>
<h3 data-id="heading-22">ä¸‰ä¸ªå…³é”®ç»„ä»¶</h3>
<p>ç³»ç»Ÿæœ‰ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ï¼š</p>
<pre><code class="hljs language-css" lang="css">ç”¨æˆ·ä»£ç ï¼ˆå¤„ç†ç¨‹åºï¼‰
       â†“
ClientGatewayï¼ˆAPIï¼‰
       â†“
   Protocolï¼ˆç¼–æ’å™¨ï¼‰
       â†“
   Transportï¼ˆ<span class="hljs-selector-tag">I</span>/Oï¼‰
</code></pre>
<h3 data-id="heading-23">ç§»äº¤ï¼šä» Protocol åˆ° Transport</h3>
<p>è¿™æ˜¯å…³é”®æ—¶åˆ»ã€‚ä»¥ä¸‹æ˜¯ Protocol ä¸­çš„ç®€åŒ–æµç¨‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// src/Server/Protocol.php</span>
<span class="hljs-comment">// Protocol::handleRequest(https://www.falvce.com/)</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span>, SessionInterface <span class="hljs-variable">$session</span></span>): <span class="hljs-title">void</span> </span>{
    <span class="hljs-variable">$handler</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">findHandler</span>(<span class="hljs-variable">$request</span>);
 
    <span class="hljs-comment">// åœ¨çº¤ç¨‹å†…æ‰§è¡Œå¤„ç†ç¨‹åºï¼</span>
    <span class="hljs-variable">$fiber</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">\Fiber</span>(<span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params"/>) =&gt;</span> <span class="hljs-variable">$handler</span>-&gt;<span class="hljs-title function_ invoke__">handle</span>(<span class="hljs-variable">$request</span>, <span class="hljs-variable">$session</span>));
 
    <span class="hljs-variable">$result</span> = <span class="hljs-variable">$fiber</span>-&gt;<span class="hljs-title function_ invoke__">start</span>();
 
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$fiber</span>-&gt;<span class="hljs-title function_ invoke__">isSuspended</span>()) {
        <span class="hljs-comment">// çº¤ç¨‹äº§ç”Ÿäº†æŸäº›ä¸œè¥¿ï¼æå–å®ƒã€‚</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>[<span class="hljs-string">'type'</span>] === <span class="hljs-string">'notification'</span>) {
            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">sendNotification</span>(<span class="hljs-variable">$result</span>[<span class="hljs-string">'notification'</span>], <span class="hljs-variable">$session</span>);
        } <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$result</span>[<span class="hljs-string">'type'</span>] === <span class="hljs-string">'request'</span>) {
            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">sendRequest</span>(<span class="hljs-variable">$result</span>[<span class="hljs-string">'request'</span>], <span class="hljs-variable">$result</span>[<span class="hljs-string">'timeout'</span>], <span class="hljs-variable">$session</span>);
        }
 
        <span class="hljs-comment">// å°†çº¤ç¨‹äº¤ç»™ä¼ è¾“å±‚</span>
        <span class="hljs-variable language_">$this</span>-&gt;transport-&gt;<span class="hljs-title function_ invoke__">attachFiberToSession</span>(<span class="hljs-variable">$fiber</span>, <span class="hljs-variable">$session</span>-&gt;<span class="hljs-title function_ invoke__">getId</span>());
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// çº¤ç¨‹å®Œæˆè€ŒæœªæŒ‚èµ·</span>
        <span class="hljs-variable">$finalResult</span> = <span class="hljs-variable">$fiber</span>-&gt;<span class="hljs-title function_ invoke__">getReturn</span>();
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">sendResponse</span>(<span class="hljs-variable">$finalResult</span>, <span class="hljs-variable">$session</span>);
    }
}
</code></pre>
<p>åè®®å¯åŠ¨çº¤ç¨‹å¹¶æ£€æŸ¥å®ƒæ˜¯å¦æŒ‚èµ·ã€‚å¦‚æœæŒ‚èµ·äº†ï¼Œåè®®æå–è¢«æŒ‚èµ·çš„å†…å®¹ï¼ˆé€šçŸ¥æˆ–è¯·æ±‚ï¼‰ï¼Œå°†å…¶æ’é˜Ÿå‘é€ï¼Œå¹¶å°†çº¤ç¨‹äº¤ç»™ä¼ è¾“å±‚ã€‚ç¨åä¼šè¯¦ç»†è®¨è®ºè¿™ä¸€ç‚¹ã€‚ç°åœ¨è®©æˆ‘ä»¬ç»§ç»­ã€‚</p>
<p>ä»è¿™ä¸€ç‚¹å¼€å§‹ï¼Œä¼ è¾“å±‚æ‹¥æœ‰çº¤ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿›ä¸€æ­¥çš„æŒ‚èµ·å’Œæ¢å¤ç”±ä¼ è¾“å±‚å¤„ç†ã€‚</p>
<h3 data-id="heading-24">Transport çš„èŒè´£</h3>
<p>æ¯ä¸ªä¼ è¾“å¿…é¡»ï¼š</p>
<ol>
<li>ä»åè®®æ¥å—çº¤ç¨‹</li>
<li>å‘å®¢æˆ·ç«¯å‘é€æ’é˜Ÿçš„æ¶ˆæ¯</li>
<li>æ¥æ”¶å®¢æˆ·ç«¯å“åº”</li>
<li>åœ¨é€‚å½“çš„æ—¶é—´æ¢å¤çº¤ç¨‹</li>
<li>å¤„ç†çº¤ç¨‹ç»ˆæ­¢</li>
</ol>
<p>ä¸åŒçš„ä¼ è¾“åŸºäºå…¶æ‰§è¡Œæ¨¡å‹ä»¥ä¸åŒæ–¹å¼å®ç°è¿™ä¸€ç‚¹ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ¯ä¸€ä¸ªã€‚</p>
<h2 data-id="heading-25">ç”¨æˆ·ä½“éªŒï¼šå®ƒçš„å¤–è§‚</h2>
<p>åœ¨æ·±å…¥ä¼ è¾“å®ç°ä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»ç”¨æˆ·è§’åº¦æ¥çœ‹æœ€ç»ˆç»“æœæ˜¯ä»€ä¹ˆæ ·çš„ã€‚è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå±•ç¤ºäº†ä¸ºä»€ä¹ˆå¤æ‚æ€§æ˜¯å€¼å¾—çš„ã€‚</p>
<h3 data-id="heading-26">ç¤ºä¾‹ 1ï¼šç®€å•çš„è¿›åº¦æ›´æ–°</h3>
<p>è¿™æ˜¯æ¥è‡ª MCP SDK æ–‡æ¡£çš„çœŸå®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// server.php</span>
<span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">addTool</span>(
    function (<span class="hljs-keyword">string</span> <span class="hljs-variable">$dataset</span>, ClientGateway <span class="hljs-variable">$client</span>): <span class="hljs-keyword">array</span> {
        <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-title class_">LoggingLevel</span>::<span class="hljs-variable constant_">Info</span>, <span class="hljs-string">"å¯¹æ•°æ®é›†è¿è¡Œè´¨é‡æ£€æŸ¥: <span class="hljs-subst">$dataset</span>"</span>);
 
        <span class="hljs-variable">$tasks</span> = [
            <span class="hljs-string">'éªŒè¯ schema'</span>,
            <span class="hljs-string">'æ‰«æå¼‚å¸¸'</span>,
            <span class="hljs-string">'å®¡æŸ¥ç»Ÿè®¡æ‘˜è¦'</span>,
        ];
 
        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$tasks</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$index</span> =&gt; <span class="hljs-variable">$task</span>) {
            <span class="hljs-variable">$progress</span> = (<span class="hljs-variable">$index</span> + <span class="hljs-number">1</span>) / <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$tasks</span>);
            <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">progress</span>(<span class="hljs-variable">$progress</span>, <span class="hljs-number">1</span>, <span class="hljs-variable">$task</span>);
 
            <span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-number">140_000</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿå·¥ä½œ</span>
        }
 
        <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-title class_">LoggingLevel</span>::<span class="hljs-variable constant_">Info</span>, <span class="hljs-string">"æ•°æ®é›† <span class="hljs-subst">$dataset</span> é€šè¿‡è‡ªåŠ¨æ£€æŸ¥"</span>);
 
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'dataset'</span> =&gt; <span class="hljs-variable">$dataset</span>,
            <span class="hljs-string">'status'</span> =&gt; <span class="hljs-string">'passed'</span>,
            <span class="hljs-string">'notes'</span> =&gt; <span class="hljs-string">'æœªæ£€æµ‹åˆ°é‡å¤§é—®é¢˜'</span>,
        ];
    },
    name: <span class="hljs-string">'run_dataset_quality_checks'</span>,
    description: <span class="hljs-string">'æ‰§è¡Œå¸¦è¿›åº¦æ›´æ–°çš„æ•°æ®é›†è´¨é‡æ£€æŸ¥'</span>
);
</code></pre>
<p>çœ‹çœ‹è¿™ä¸ªå·¥å…·ä»£ç ã€‚å®ƒåªæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ã€‚å®ƒéå†ä»»åŠ¡ã€‚å®ƒè°ƒç”¨Â <code>$client-&gt;progress()</code>ï¼Œå°±åƒè°ƒç”¨æ™®é€šæ–¹æ³•ä¸€æ ·ã€‚æ²¡æœ‰è¿¹è±¡è¡¨æ˜è¿™åœ¨è¿›è¡Œå¤æ‚çš„åŒå‘é€šä¿¡ã€‚</p>
<p>ä½†å®é™…ä¸Šå‘ç”Ÿçš„æ˜¯ï¼š</p>
<ol>
<li>å¤„ç†ç¨‹åºå¯åŠ¨ï¼ˆåœ¨çº¤ç¨‹å†…ï¼‰</li>
<li><code>$client-&gt;log()</code>Â æŒ‚èµ·çº¤ç¨‹</li>
<li>ä¼ è¾“å‘é€æ—¥å¿—é€šçŸ¥</li>
<li>çº¤ç¨‹æ¢å¤</li>
<li>å¾ªç¯å¼€å§‹</li>
<li>ç¬¬ä¸€ä¸ªÂ <code>$client-&gt;progress()</code>Â æŒ‚èµ·çº¤ç¨‹</li>
<li>ä¼ è¾“å‘é€è¿›åº¦é€šçŸ¥</li>
<li>çº¤ç¨‹æ¢å¤</li>
<li><code>usleep()</code>Â è¿è¡Œï¼ˆä»åœ¨çº¤ç¨‹ä¸­ï¼‰</li>
<li>ç¬¬äºŒä¸ªÂ <code>$client-&gt;progress()</code>Â å†æ¬¡æŒ‚èµ·</li>
<li>...ä»¥æ­¤ç±»æ¨</li>
</ol>
<p>æ¯æ¬¡æŒ‚èµ·å’Œæ¢å¤å¯¹ç”¨æˆ·éƒ½æ˜¯ä¸å¯è§çš„ã€‚ä»£ç çœ‹èµ·æ¥å’Œè¡¨ç°å¾—åƒåŒæ­¥ PHPã€‚æ‰§è¡Œä¸æ–­åœ¨ä¼ è¾“çš„å¾ªç¯ï¼ˆç°åœ¨æ˜¯æ‰€æœ‰è€…ï¼‰å’Œå·¥å…·çš„å¤„ç†ç¨‹åºä¹‹é—´æ¥å›è·³è½¬ï¼Œæ¯æ¬¡å›åˆ°å¤„ç†ç¨‹åºæ—¶ï¼Œéƒ½å›åˆ°å®Œç¾çš„ä½ç½®å¹¶æ¢å¤ï¼ˆç”šè‡³åœ¨ foreach å¾ªç¯å†…ï¼‰ã€‚è¯·å®šä¹‰ç¾ï¼ï¼</p>
<h3 data-id="heading-27">ç¤ºä¾‹ 2ï¼šè¯·æ±‚ LLM é‡‡æ ·</h3>
<p>è¿™æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„ç¤ºä¾‹ï¼Œå®é™…ç­‰å¾…å“åº”ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// app/Tools/IncidentCoordinator.php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IncidentCoordinator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ClientAwareInterface</span> </span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">ClientAwareTrait</span>;  <span class="hljs-comment">// æä¾› $this-&gt;log å’Œ $this-&gt;progress</span>
 
    <span class="hljs-meta">#[McpTool</span>(<span class="hljs-string">'coordinate_incident_response'</span>, <span class="hljs-string">'åè°ƒäº‹ä»¶å“åº”'</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">coordinateIncident</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$incidentTitle</span></span>): <span class="hljs-title">array</span> </span>{
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-title class_">LoggingLevel</span>::<span class="hljs-variable constant_">Warning</span>, <span class="hljs-string">"äº‹ä»¶åˆ†ç±»å¼€å§‹: <span class="hljs-subst">$incidentTitle</span>"</span>);
 
        <span class="hljs-variable">$steps</span> = [
            <span class="hljs-string">'æ”¶é›†é¥æµ‹æ•°æ®'</span>,
            <span class="hljs-string">'è¯„ä¼°èŒƒå›´'</span>,
            <span class="hljs-string">'åè°ƒå“åº”è€…'</span>,
        ];
 
        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$steps</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$index</span> =&gt; <span class="hljs-variable">$step</span>) {
            <span class="hljs-variable">$progress</span> = (<span class="hljs-variable">$index</span> + <span class="hljs-number">1</span>) / <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$steps</span>);
            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">progress</span>(<span class="hljs-variable">$progress</span>, <span class="hljs-number">1</span>, <span class="hljs-variable">$step</span>);
            <span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-number">180_000</span>);
        }
 
        <span class="hljs-comment">// è¯·æ±‚å®¢æˆ·ç«¯çš„ LLM ç”Ÿæˆå“åº”ç­–ç•¥</span>
        <span class="hljs-variable">$prompt</span> = <span class="hljs-string">"ä¸ºäº‹ä»¶ "</span><span class="hljs-variable">$incidentTitle</span><span class="hljs-string">" æä¾›ç®€æ´çš„å“åº”ç­–ç•¥
                   åŸºäº: "</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">', '</span>, <span class="hljs-variable">$steps</span>);
 
        <span class="hljs-variable">$result</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">sample</span>(<span class="hljs-variable">$prompt</span>, <span class="hljs-number">350</span>, <span class="hljs-number">90</span>, [<span class="hljs-string">'temperature'</span> =&gt; <span class="hljs-number">0.5</span>]);
 
        <span class="hljs-variable">$recommendation</span> = <span class="hljs-variable">$result</span>-&gt;content <span class="hljs-keyword">instanceof</span> TextContent
            ? <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$result</span>-&gt;content-&gt;text)
            : <span class="hljs-string">''</span>;
 
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-title class_">LoggingLevel</span>::<span class="hljs-variable constant_">Info</span>, <span class="hljs-string">"äº‹ä»¶åˆ†ç±»å®Œæˆ"</span>);
 
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'incident'</span> =&gt; <span class="hljs-variable">$incidentTitle</span>,
            <span class="hljs-string">'recommended_actions'</span> =&gt; <span class="hljs-variable">$recommendation</span>,
            <span class="hljs-string">'model'</span> =&gt; <span class="hljs-variable">$result</span>-&gt;model,
        ];
    }
}
</code></pre>
<p>è¿™æ›´åŠ ç¥å¥‡ã€‚<code>sample()</code>Â è°ƒç”¨ï¼š</p>
<ol>
<li>ä½¿ç”¨é‡‡æ ·è¯·æ±‚æŒ‚èµ·çº¤ç¨‹</li>
<li>ä¼ è¾“å‘å®¢æˆ·ç«¯å‘é€è¯·æ±‚</li>
<li>ä¼ è¾“ç­‰å¾…å®¢æˆ·ç«¯å“åº”ï¼ˆå“åº”å¦‚ä½•åˆ°æ¥å–å†³äºä¼ è¾“ï¼Œè¿™å¯èƒ½éœ€è¦å‡ ç§’é’Ÿï¼ï¼‰</li>
<li>å½“å“åº”åˆ°è¾¾æ—¶ï¼Œä¼ è¾“ä½¿ç”¨å®ƒæ¢å¤çº¤ç¨‹</li>
<li><code>$result</code>Â åŒ…å«å“åº”ï¼Œæ‰§è¡Œç»§ç»­</li>
</ol>
<p>ä»æ–¹æ³•çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒè¿›è¡Œäº†åŒæ­¥è°ƒç”¨å¹¶å¾—åˆ°äº†ç»“æœã€‚åœ¨å¹•åï¼š</p>
<ol>
<li>çº¤ç¨‹è¢«æŒ‚èµ·</li>
<li>æ§åˆ¶æƒè¿”å›åˆ°ä¼ è¾“çš„äº‹ä»¶å¾ªç¯</li>
<li>ä¼ è¾“å¤„ç†å…¶ä»–äº‹æƒ…ï¼ˆå¯èƒ½æ˜¯å…¶ä»–è¯·æ±‚ï¼‰</li>
<li>å½“å“åº”åˆ°æ¥æ—¶ï¼ˆå¯èƒ½æ¥è‡ªå¦ä¸€ä¸ª HTTP è¯·æ±‚/è¿›ç¨‹ï¼‰ï¼Œçº¤ç¨‹æ¢å¤</li>
<li>æ–¹æ³•ç»§ç»­ï¼Œå°±åƒä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿè¿‡</li>
</ol>
<p>è¿™å°±æ˜¯åä½œå¼å¤šä»»åŠ¡çš„å®é™…åº”ç”¨ã€‚ç¼–å†™è¿™ä¸ªå·¥å…·çš„å¼€å‘è€…å®Œå…¨ä¸çŸ¥é“è¿™æ­£åœ¨å‘ç”Ÿã€‚</p>
<h3 data-id="heading-28">ClientAwareTrait æ¨¡å¼</h3>
<p>æ³¨æ„ä¸Šé¢ç¤ºä¾‹ä¸­çš„Â <code>ClientAwareTrait</code>ã€‚è¿™æ˜¯è®¿é—®Â <code>ClientGateway</code>Â çš„ä¸¤ç§æ–¹å¼ä¹‹ä¸€ï¼š</p>
<p><strong>æ–¹æ³• 1ï¼šåœ¨å¤„ç†ç¨‹åºä¸­è¿›è¡Œç±»å‹æç¤º</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">#[McpTool</span>(<span class="hljs-string">'my_tool'</span>)<span class="hljs-meta">]</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myTool</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$input</span>, ClientGateway <span class="hljs-variable">$client</span></span>): <span class="hljs-title">string</span> </span>{
    <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-attr">https</span>://www.falvce.com/);
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;
}
</code></pre>
<p>SDK æ£€æµ‹Â <code>ClientGateway</code>Â å‚æ•°å¹¶è‡ªåŠ¨æ³¨å…¥å®ƒã€‚</p>
<p><strong>æ–¹æ³• 2ï¼šå®ç° ClientAwareInterface</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ClientAwareInterface</span> </span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">ClientAwareTrait</span>;  <span class="hljs-comment">// æä¾› setClient() å’Œè¾…åŠ©æ–¹æ³•</span>
 
    <span class="hljs-meta">#[McpTool</span>(<span class="hljs-string">'my_tool'</span>)<span class="hljs-meta">]</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myTool</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$input</span></span>): <span class="hljs-title">string</span> </span>{
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">log</span>(...);  <span class="hljs-comment">// ClientAwareTrait æä¾›æ­¤æ–¹æ³•</span>
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">progress</span>(...);
        <span class="hljs-variable">$result</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">sample</span>(...);
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;
    }
}
</code></pre>
<p>SDK åœ¨è°ƒç”¨å¤„ç†ç¨‹åºä¹‹å‰è°ƒç”¨Â <code>setClient()</code>ï¼Œtrait æä¾›åƒÂ <code>log()</code>ã€<code>progress()</code>ã€<code>sample()</code>Â è¿™æ ·çš„ä¾¿æ·æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å†…éƒ¨ä½¿ç”¨å®¢æˆ·ç«¯ã€‚</p>
<p>ä¸¤ç§æ–¹æ³•éƒ½æä¾›ç›¸åŒçš„èƒ½åŠ›ã€‚ç”¨æˆ·æ ¹æ®åå¥½é€‰æ‹©ã€‚</p>
<h2 data-id="heading-29">åº•å±‚ï¼šClientGateway</h2>
<p>ç°åœ¨è®©æˆ‘ä»¬å‰¥å¼€ç¬¬ä¸€å±‚ï¼Œçœ‹çœ‹Â <code>ClientGateway</code>Â å¦‚ä½•å·¥ä½œã€‚è¿™æ˜¯ç”¨æˆ·äº¤äº’çš„ APIã€‚å®ƒå‡ºå¥‡åœ°ï¼ˆå¹¶ä¸å‡ºå¥‡åœ°ï¼‰ç®€å•ï¼Œä½†è¶…çº§å¼ºå¤§ã€‚</p>
<p>è¿™æ˜¯å®é™…å®ç°ï¼ˆä¸ºæ¸…æ™°èµ·è§è¿›è¡Œäº†ç®€åŒ–ï¼‰ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// src/Server/ClientGateway.php</span>
<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClientGateway</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> SessionInterface <span class="hljs-variable">$session</span>,
    </span>) </span>{}
 
    <span class="hljs-comment">/**
     * å‘å®¢æˆ·ç«¯å‘é€é€šçŸ¥ï¼ˆå³å‘å³å¿˜ï¼‰ã€‚
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">notify</span>(<span class="hljs-params">Notification <span class="hljs-variable">$notification</span></span>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-title class_">\Fiber</span>::<span class="hljs-title function_ invoke__">suspend</span>([
            <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'notification'</span>,
            <span class="hljs-string">'notification'</span> =&gt; <span class="hljs-variable">$notification</span>,
            <span class="hljs-string">'session_id'</span> =&gt; <span class="hljs-variable">$this</span>-&gt;session-&gt;<span class="hljs-title function_ invoke__">getId</span>()-&gt;<span class="hljs-title function_ invoke__">toRfc4122</span>(),
        ]);
    }
 
    <span class="hljs-comment">/**
     * å‘å®¢æˆ·ç«¯å‘é€æ—¥å¿—æ¶ˆæ¯ã€‚
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">LoggingLevel <span class="hljs-variable">$level</span>, <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$data</span>, ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$logger</span> = <span class="hljs-literal">null</span></span>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">notify</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LoggingMessageNotification</span>(<span class="hljs-variable">$level</span>, <span class="hljs-variable">$data</span>, <span class="hljs-variable">$logger</span>));
    }
 
    <span class="hljs-comment">/**
     * å‘å®¢æˆ·ç«¯å‘é€è¿›åº¦æ›´æ–°ã€‚
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">progress</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> <span class="hljs-variable">$progress</span>, ?<span class="hljs-keyword">float</span> <span class="hljs-variable">$total</span> = <span class="hljs-literal">null</span>, ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span> = <span class="hljs-literal">null</span></span>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-variable">$meta</span> = <span class="hljs-variable language_">$this</span>-&gt;session-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-title class_">Protocol</span>::<span class="hljs-variable constant_">SESSION_ACTIVE_REQUEST_META</span>, []);
        <span class="hljs-variable">$progressToken</span> = <span class="hljs-variable">$meta</span>[<span class="hljs-string">'progressToken'</span>] ?? <span class="hljs-literal">null</span>;
 
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> === <span class="hljs-variable">$progressToken</span>) {
            <span class="hljs-comment">// å®¢æˆ·ç«¯æœªè¯·æ±‚è¿›åº¦ï¼Œè·³è¿‡</span>
            <span class="hljs-keyword">return</span>;
        }
 
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">notify</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProgressNotification</span>(<span class="hljs-variable">$progressToken</span>, <span class="hljs-variable">$progress</span>, <span class="hljs-variable">$total</span>, <span class="hljs-variable">$message</span>));
    }
 
    <span class="hljs-comment">/**
     * ä»å®¢æˆ·ç«¯è¯·æ±‚ LLM é‡‡æ ·ã€‚
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sample</span>(<span class="hljs-params">
        <span class="hljs-keyword">array</span>|Content|<span class="hljs-keyword">string</span> <span class="hljs-variable">$message</span>,
        <span class="hljs-keyword">int</span> <span class="hljs-variable">$maxTokens</span> = <span class="hljs-number">1000</span>,
        <span class="hljs-keyword">int</span> <span class="hljs-variable">$timeout</span> = <span class="hljs-number">120</span>,
        <span class="hljs-keyword">array</span> <span class="hljs-variable">$options</span> = []
    </span>): <span class="hljs-title">CreateSamplingMessageResult</span> </span>{
        <span class="hljs-comment">// å‡†å¤‡æ¶ˆæ¯</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$message</span>)) {
            <span class="hljs-variable">$message</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextContent</span>(<span class="hljs-variable">$message</span>);
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$message</span> <span class="hljs-keyword">instanceof</span> Content) {
            <span class="hljs-variable">$message</span> = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">SamplingMessage</span>(<span class="hljs-title class_">Role</span>::<span class="hljs-variable constant_">User</span>, <span class="hljs-variable">$message</span>)];
        }
 
        <span class="hljs-variable">$request</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CreateSamplingMessageRequest</span>(
            messages: <span class="hljs-variable">$message</span>,
            maxTokens: <span class="hljs-variable">$maxTokens</span>,
            preferences: <span class="hljs-variable">$options</span>[<span class="hljs-string">'preferences'</span>] ?? <span class="hljs-literal">null</span>,
            systemPrompt: <span class="hljs-variable">$options</span>[<span class="hljs-string">'systemPrompt'</span>] ?? <span class="hljs-literal">null</span>,
            temperature: <span class="hljs-variable">$options</span>[<span class="hljs-string">'temperature'</span>] ?? <span class="hljs-literal">null</span>,
            <span class="hljs-comment">// ...å…¶ä»–é€‰é¡¹</span>
        );
 
        <span class="hljs-comment">// å‘é€è¯·æ±‚å¹¶ç­‰å¾…å“åº”</span>
        <span class="hljs-variable">$response</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">request</span>(<span class="hljs-variable">$request</span>, <span class="hljs-variable">$timeout</span>);
 
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$response</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClientException</span>(<span class="hljs-variable">$response</span>);
        }
 
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">CreateSamplingMessageResult</span>::<span class="hljs-title function_ invoke__">fromArray</span>(<span class="hljs-variable">$response</span>-&gt;result);
    }
 
    <span class="hljs-comment">/**
     * å‘å®¢æˆ·ç«¯å‘é€è¯·æ±‚å¹¶ç­‰å¾…å“åº”ã€‚
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">request</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$timeout</span> = <span class="hljs-number">120</span></span>): <span class="hljs-title">Response</span>|<span class="hljs-title">Error</span> </span>{
        <span class="hljs-variable">$response</span> = <span class="hljs-title class_">\Fiber</span>::<span class="hljs-title function_ invoke__">suspend</span>([
            <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'request'</span>,
            <span class="hljs-string">'request'</span> =&gt; <span class="hljs-variable">$request</span>,
            <span class="hljs-string">'session_id'</span> =&gt; <span class="hljs-variable">$this</span>-&gt;session-&gt;<span class="hljs-title function_ invoke__">getId</span>()-&gt;<span class="hljs-title function_ invoke__">toRfc4122</span>(),
            <span class="hljs-string">'timeout'</span> =&gt; <span class="hljs-variable">$timeout</span>,
        ]);
 
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$response</span> <span class="hljs-keyword">instanceof</span> Response &amp;&amp; !<span class="hljs-variable">$response</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">'ä¼ è¾“è¿”å›äº†æ„å¤–çš„è½½è·'</span>);
        }
 
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$response</span>;
    }
}
</code></pre>
<h3 data-id="heading-30">å…³é”®æ–¹æ³•</h3>
<p><strong><code>notify()</code>Â - æœ€ç®€å•çš„æƒ…å†µï¼š</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">notify</span>(<span class="hljs-params">Notification <span class="hljs-variable">$notification</span></span>): <span class="hljs-title">void</span> </span>{
    <span class="hljs-title class_">\Fiber</span>::<span class="hljs-title function_ invoke__">suspend</span>([
        <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'notification'</span>,
        <span class="hljs-string">'notification'</span> =&gt; <span class="hljs-variable">$notification</span>,
        <span class="hljs-string">'session_id'</span> =&gt; <span class="hljs-variable">$this</span>-&gt;session-&gt;<span class="hljs-title function_ invoke__">getId</span>()-&gt;<span class="hljs-title function_ invoke__">toRfc4122</span>(),
    ]);
}
</code></pre>
<p>è¿™ä¼šä½¿ç”¨ä¸€ä¸ªæ•°æ®ç»“æ„æŒ‚èµ·å½“å‰çº¤ç¨‹ï¼Œè¯¥ç»“æ„æŒ‡ç¤ºï¼š</p>
<ul>
<li>è¿™æ˜¯ä¸€ä¸ªé€šçŸ¥ï¼ˆä¸éœ€è¦å“åº”ï¼‰</li>
<li>è¦å‘é€ä»€ä¹ˆé€šçŸ¥</li>
<li>å®ƒå±äºå“ªä¸ªä¼šè¯</li>
</ul>
<p>çº¤ç¨‹å°†åœ¨é€šçŸ¥æ’é˜Ÿåç«‹å³æ¢å¤ã€‚</p>
<p><strong><code>request()</code>Â - å¤æ‚çš„æƒ…å†µï¼š</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">request</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$timeout</span> = <span class="hljs-number">120</span></span>): <span class="hljs-title">Response</span>|<span class="hljs-title">Error</span> </span>{
    <span class="hljs-variable">$response</span> = <span class="hljs-title class_">\Fiber</span>::<span class="hljs-title function_ invoke__">suspend</span>([
        <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'request'</span>,
        <span class="hljs-string">'request'</span> =&gt; <span class="hljs-variable">$request</span>,
        <span class="hljs-string">'session_id'</span> =&gt; <span class="hljs-variable">$this</span>-&gt;session-&gt;<span class="hljs-title function_ invoke__">getId</span>()-&gt;<span class="hljs-title function_ invoke__">toRfc4122</span>(),
        <span class="hljs-string">'timeout'</span> =&gt; <span class="hljs-variable">$timeout</span>,
    ]);
 
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$response</span>;
}
</code></pre>
<p>è¿™ä¼šä½¿ç”¨ä¸€ä¸ªæ•°æ®ç»“æ„æŒ‚èµ·çº¤ç¨‹ï¼Œè¯¥ç»“æ„æŒ‡ç¤ºï¼š</p>
<ul>
<li>è¿™æ˜¯ä¸€ä¸ªè¯·æ±‚ï¼ˆæœŸæœ›å“åº”ï¼‰</li>
<li>è¦å‘é€ä»€ä¹ˆè¯·æ±‚</li>
<li>ç­‰å¾…å“åº”å¤šé•¿æ—¶é—´</li>
</ul>
<p>çº¤ç¨‹åœ¨ä»¥ä¸‹æƒ…å†µä¹‹å‰<strong>ä¸ä¼š</strong>æ¢å¤ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å‘é€å“åº”ï¼Œæˆ–</li>
<li>è¶…æ—¶åˆ°æœŸ</li>
</ol>
<p>å½“æ¢å¤æ—¶ï¼Œä¼ é€’ç»™Â <code>$fiber-&gt;resume($value)</code>Â çš„å€¼æˆä¸ºÂ <code>Fiber::suspend()</code>Â çš„è¿”å›å€¼ã€‚å› æ­¤Â <code>$response</code>Â å°†æ˜¯Â <code>Response</code>Â å¯¹è±¡ï¼ˆæˆåŠŸï¼‰æˆ–Â <code>Error</code>Â å¯¹è±¡ï¼ˆå¤±è´¥/è¶…æ—¶ï¼‰ã€‚</p>
<h2 data-id="heading-31">ä½•æ—¶åº”è¯¥ä½¿ç”¨çº¤ç¨‹ï¼Ÿ</h2>
<p>ç°åœ¨ä½ å·²ç»çœ‹åˆ°äº†çº¤ç¨‹çš„å®é™…åº”ç”¨ï¼Œä»€ä¹ˆæ—¶å€™åº”è¯¥åœ¨è‡ªå·±çš„ä»£ç ä¸­çœŸæ­£ä½¿ç”¨å®ƒä»¬ï¼Ÿ</p>
<h3 data-id="heading-32">çº¤ç¨‹ä½¿ç”¨æ¡ˆä¾‹æ£€æŸ¥æ¸…å•</h3>
<p>åœ¨ä»¥ä¸‹æƒ…å†µè€ƒè™‘ä½¿ç”¨çº¤ç¨‹ï¼š</p>
<p>âœ…Â <strong>éœ€è¦æš‚åœå’Œæ¢å¤æ‰§è¡Œ</strong>Â - æ ¸å¿ƒä½¿ç”¨æ¡ˆä¾‹ã€‚å¦‚æœä½ éœ€è¦ç¦»å¼€ä¸€ä¸ªå‡½æ•°ï¼Œåšå…¶ä»–äº‹æƒ…ï¼Œç„¶åå›æ¥ã€‚</p>
<p>âœ…Â <strong>æƒ³è¦å¯¹ç”¨æˆ·éšè—å¤æ‚æ€§</strong>Â - å¦‚æœä½ æ­£åœ¨æ„å»ºä¸€ä¸ªåº“ï¼Œå¹¶å¸Œæœ›æä¾›ä¸€ä¸ªå¹²å‡€çš„ API æ¥éšè—å¼‚æ­¥æˆ–æœ‰çŠ¶æ€çš„è¡Œä¸ºã€‚</p>
<p>âœ…Â <strong>éœ€è¦åä½œå¼å¤šä»»åŠ¡</strong>Â - å½“ä½ å¸Œæœ›å¤šä¸ª"ä»»åŠ¡"åœ¨æ²¡æœ‰çº¿ç¨‹æˆ–è¿›ç¨‹çš„æƒ…å†µä¸‹å–å¾—è¿›å±•ã€‚</p>
<p>âœ…Â <strong>æ­£åœ¨æ¡¥æ¥åŒæ­¥å’Œå¼‚æ­¥ä»£ç </strong>Â - å½“ä½ æƒ³è®©å¼‚æ­¥æ“ä½œçœ‹èµ·æ¥åŒæ­¥æ—¶ï¼ˆå¦‚ ReactPHP çš„ awaitï¼‰ã€‚</p>
<p>âœ…Â <strong>éœ€è¦ç»´æŠ¤æ‰§è¡Œä¸Šä¸‹æ–‡</strong>Â - å½“ä½¿ç”¨ç”Ÿæˆå™¨æš‚åœå’Œæ¢å¤ä¼šå—åˆ°å¤ªå¤šé™åˆ¶æ—¶ï¼ˆä¸èƒ½è½»æ¾åœ°ä»åµŒå¥—è°ƒç”¨ä¸­ yieldï¼‰ã€‚</p>
<p>âœ…Â <strong>æ­£åœ¨æ„å»ºåŸºç¡€è®¾æ–½ä»£ç </strong>Â - åº“ã€æ¡†æ¶å’Œ SDK æœ€èƒ½ä»çº¤ç¨‹ä¸­å—ç›Šã€‚</p>
<h3 data-id="heading-33">ä½•æ—¶ä¸ä½¿ç”¨çº¤ç¨‹</h3>
<p>åœ¨ä»¥ä¸‹æƒ…å†µä¸è¦ä½¿ç”¨çº¤ç¨‹ï¼š</p>
<p>âŒÂ <strong>ç®€å•çš„å›è°ƒå°±è¶³å¤Ÿäº†</strong>Â - ä¸è¦æŠŠäº‹æƒ…å¤æ‚åŒ–ã€‚å¦‚æœå›è°ƒæœ‰æ•ˆï¼Œå°±ä½¿ç”¨å›è°ƒã€‚</p>
<p>âŒÂ <strong>éœ€è¦çœŸæ­£çš„å¹¶è¡Œæ€§</strong>Â - çº¤ç¨‹æ˜¯åä½œçš„ï¼Œä¸æ˜¯å¹¶è¡Œçš„ã€‚ä½¿ç”¨è¿›ç¨‹ã€çº¿ç¨‹æˆ–å¼‚æ­¥ I/O å®ç°å¹¶è¡Œæ€§ã€‚</p>
<p>âŒÂ <strong>ä»£ç ç®€å•ä¸”çº¿æ€§</strong>Â - å¦‚æœä¸éœ€è¦ä¸­æ–­æˆ–æ¢å¤ï¼Œçº¤ç¨‹ä¼šå¢åŠ ä¸å¿…è¦çš„å¤æ‚æ€§ã€‚</p>
<p>âŒÂ <strong>ä½ ä¸æ§åˆ¶æ‰§è¡Œæµ</strong>Â - çº¤ç¨‹åœ¨åº“å’Œæ¡†æ¶ä¸­è¡¨ç°å‡ºè‰²ï¼Œåœ¨åº”ç”¨ä»£ç ä¸­åˆ™è¾ƒå°‘ã€‚</p>
<p>âŒÂ <strong>ç”Ÿæˆå™¨å·¥ä½œæ­£å¸¸</strong>Â - å¦‚æœç”Ÿæˆå™¨ï¼ˆyieldï¼‰å¹²å‡€åœ°è§£å†³äº†ä½ çš„é—®é¢˜ï¼ŒåšæŒä½¿ç”¨å®ƒä»¬ã€‚çº¤ç¨‹æ›´å¼ºå¤§ä½†ä¹Ÿæ›´å¤æ‚ã€‚</p>
<h2 data-id="heading-34">å¸¸è§é™·é˜±å’Œæ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-35">1. ç†è§£è°æ§åˆ¶çº¤ç¨‹</h3>
<p>å…³äºçº¤ç¨‹æœ€åŸºæœ¬çš„ç†è§£ï¼šå½“çº¤ç¨‹æŒ‚èµ·æ—¶ï¼Œå®ƒå°†æ§åˆ¶æƒè®©å›ç»™æŸäººã€‚é‚£ä¸ª"æŸäºº"å°±æ˜¯ç¼–æ’å™¨ï¼Œä½ éœ€è¦çŸ¥é“å®ƒæ˜¯è°ã€‚</p>
<p>çº¤ç¨‹ä»£è¡¨ä¸€ä¸ªå·¥ä½œå•å…ƒã€‚å½“å®ƒè°ƒç”¨Â <code>Fiber::suspend()</code>Â æ—¶ï¼Œæ‰§è¡Œè·³å‡ºçº¤ç¨‹å¹¶è¿”å›åˆ°è°ƒç”¨Â <code>$fiber-&gt;start()</code>Â æˆ–Â <code>$fiber-&gt;resume()</code>Â çš„å®ä½“ã€‚è¯¥å®ä½“è´Ÿè´£å†³å®šä½•æ—¶ï¼ˆä»¥åŠæ˜¯å¦ï¼‰æ¢å¤çº¤ç¨‹ã€‚</p>
<p>åœ¨ MCP ä¼ è¾“ä¸­ï¼š</p>
<ul>
<li><strong>StdioTransport</strong>ï¼šä¸»å¾ªç¯ï¼ˆ<code>while (!feof($input))</code>ï¼‰æ˜¯ç¼–æ’å™¨ã€‚å®ƒæŒç»­å¤„ç†è¾“å…¥ã€ç®¡ç†çº¤ç¨‹å¹¶åˆ·æ–°è¾“å‡ºã€‚</li>
<li><strong>StreamableHttpTransport</strong>ï¼šSSE æµçš„é˜»å¡å¾ªç¯åœ¨è¯¥è¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸå†…æˆä¸ºç¼–æ’å™¨ã€‚å®ƒé˜»å¡æ•´ä¸ªè¿›ç¨‹å¹¶ç®¡ç†çº¤ç¨‹ç›´åˆ°å®Œæˆã€‚</li>
<li><strong>ReactPHP</strong>ï¼šäº‹ä»¶å¾ªç¯æ˜¯ç¼–æ’å™¨ã€‚æˆ‘ä»¬ä¸é˜»å¡å®ƒï¼›ç›¸åï¼Œæˆ‘ä»¬æ³¨å†Œå¾ªç¯ç®¡ç†çš„å®šæ—¶å™¨ã€‚</li>
</ul>
<p>å…³é”®åŸåˆ™ï¼š<strong>ç¼–æ’å™¨ä¸èƒ½è¢«æ°¸ä¹…é˜»å¡ï¼Œå¦åˆ™ä½ çš„çº¤ç¨‹æ°¸è¿œä¸ä¼šæ¢å¤</strong>ã€‚å¦‚æœä½ æ­£åœ¨ç¼–å†™æŒ‚èµ·çº¤ç¨‹çš„ä»£ç ï¼Œç¡®ä¿æ¥æ”¶æ§åˆ¶æƒçš„å®ä½“æœ‰æœºåˆ¶æ¥æ¢å¤å®ƒä»¬ã€‚</p>
<p>è¿˜è¦æ³¨æ„ï¼š<strong>çº¤ç¨‹å¯ä»¥åµŒå¥—</strong>ã€‚ä½ å¯ä»¥åœ¨çº¤ç¨‹å†…éƒ¨åˆ›å»ºçº¤ç¨‹ã€‚ç¼–æ’å™¨å¯ä»¥æ˜¯ä¸€ä¸ªä¸­å¤®ç®¡ç†å™¨ï¼ˆå¦‚æˆ‘ä»¬çš„ TaskManager ç¤ºä¾‹æ‰€ç¤ºï¼‰ï¼Œæˆ–è€…çˆ¶çº¤ç¨‹æœ¬èº«å¯ä»¥å……å½“å…¶å­çº¤ç¨‹çš„ç¼–æ’å™¨ã€‚åªéœ€æ¸…æ¥šè°åœ¨ç®¡ç†è°ï¼Œå¹¶ç¡®ä¿ç¼–æ’å™¨ä¸ä¼šæ— é™æœŸåœ°è¢«é˜»å¡ã€‚</p>
<h3 data-id="heading-36">2. å¿˜è®°ä½ åœ¨çº¤ç¨‹ä¸­</h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myHandler</span>(<span class="hljs-params"/>) </span>{
    <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">sample</span>(<span class="hljs-string">"ç”Ÿæˆæ–‡æœ¬"</span>);  <span class="hljs-comment">// è¿™ä¼šæŒ‚èµ·ï¼</span>
    <span class="hljs-comment">// è¿™é‡Œçš„ä»»ä½•ä»£ç éƒ½åœ¨æŒ‚èµ·å’Œæ¢å¤ä¹‹åè¿è¡Œ</span>
}
</code></pre>
<p>è®°ä½æŒ‚èµ·å¯èƒ½å‘ç”Ÿåœ¨è°ƒç”¨æ ˆçš„æ·±å¤„ã€‚å§‹ç»ˆè€ƒè™‘åœ¨æŒ‚èµ·æœŸé—´å¯èƒ½æ”¹å˜çš„çŠ¶æ€ã€‚</p>
<h3 data-id="heading-37">3. èµ„æºç”Ÿå‘½å‘¨æœŸ</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-variable">$lock</span> = <span class="hljs-variable">$mutex</span>-&gt;<span class="hljs-built_in">acquire</span>();
<span class="hljs-variable">$client</span>-&gt;<span class="hljs-built_in">sample</span>("...");  <span class="hljs-comment">// çº¤ç¨‹åœ¨è¿™é‡ŒæŒ‚èµ·</span>
<span class="hljs-variable">$lock</span>-&gt;<span class="hljs-built_in">release</span>();  <span class="hljs-comment">// è¿™ä¼šæ™šå¾—å¤šæ‰è¿è¡Œï¼</span>
</code></pre>
<p>å°å¿ƒè·¨è¶ŠæŒ‚èµ·ç‚¹çš„èµ„æºï¼ˆé”ã€æ•°æ®åº“äº‹åŠ¡ã€æ–‡ä»¶å¥æŸ„ï¼‰ã€‚çº¤ç¨‹å¯èƒ½ä¼šæŒ‚èµ·å‡ ç§’é’Ÿæˆ–å‡ åˆ†é’Ÿã€‚</p>
<h3 data-id="heading-38">4. è·¨æŒ‚èµ·çš„å¼‚å¸¸å¤„ç†</h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">try</span> {
    <span class="hljs-variable">$result</span> = <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">sample</span>(<span class="hljs-string">"..."</span>);  <span class="hljs-comment">// æŒ‚èµ·</span>
} <span class="hljs-keyword">catch</span> (\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span>) {
    <span class="hljs-comment">// è¿™æ•è·çº¤ç¨‹å†…éƒ¨çš„å¼‚å¸¸</span>
    <span class="hljs-comment">// ä¸æ˜¯æŒ‚èµ·æœŸé—´çš„å¼‚å¸¸</span>
    <span class="hljs-comment">// é™¤éçº¤ç¨‹ç”¨ throw(https://www.falvce.com/) æ¢å¤</span>
}
</code></pre>
<p>å¼‚å¸¸åœ¨çº¤ç¨‹å†…æ­£å¸¸å·¥ä½œï¼Œä½†æŒ‚èµ·/æ¢å¤æœºåˆ¶æœ¬èº«æœ‰å•ç‹¬çš„é”™è¯¯å¤„ç†ã€‚å› æ­¤ç†è§£å¼‚å¸¸ä¸ä¼šè‡ªåŠ¨è·¨è¶Šçº¤ç¨‹å’Œç¼–æ’å™¨ä¹‹é—´çš„è¾¹ç•Œè‡³å…³é‡è¦ã€‚</p>
<p>å¦‚æœçº¤ç¨‹æŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒä¼šå†’æ³¡åˆ°ç¼–æ’å™¨ï¼ˆé€šè¿‡Â <code>$fiber-&gt;start()</code>Â æˆ–Â <code>$fiber-&gt;resume()</code>ï¼‰ã€‚å¦‚æœç¼–æ’å™¨æŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒä¸ä¼šè‡ªåŠ¨è¿›å…¥çº¤ç¨‹ï¼ˆå› ä¸ºå¼‚å¸¸å¯èƒ½ä¸æŒ‚èµ·çš„çº¤ç¨‹ç›¸å…³ï¼Œä¹Ÿå¯èƒ½æ— å…³ï¼‰ã€‚</p>
<p>ä½ å¿…é¡»æ˜ç¡®å†³å®šå¦‚ä½•æ¡¥æ¥è¿™ä¸ªå·®è·ã€‚ä½ æ˜¯å¸Œæœ›ç¼–æ’å™¨ç‹¬ç«‹å´©æºƒå—ï¼Ÿä½ æƒ³æ•è·é”™è¯¯å¹¶ä½¿ç”¨å¤±è´¥å¯¹è±¡Â <code>resume()</code>Â å—ï¼Ÿè¿˜æ˜¯ä½ æƒ³å°†å…¶Â <code>throw()</code>Â åˆ°çº¤ç¨‹ä¸­ï¼Ÿè¿™äº›æ˜¯æ¶æ„å†³ç­–ï¼Œä¸æ˜¯é»˜è®¤è¡Œä¸ºã€‚</p>
<h3 data-id="heading-39">5. å…¨å±€çŠ¶æ€</h3>
<pre><code class="hljs language-perl" lang="perl">global $counter;
$counter++;
$client-&gt;<span class="hljs-keyword">log</span>(<span class="hljs-string">"è®¡æ•°ï¼š$counter"</span>); https:<span class="hljs-regexp">//</span>www.falvce.com/ <span class="hljs-regexp">//</span> æŒ‚èµ·
$counter++;  <span class="hljs-regexp">//</span> å¦‚æœå¦ä¸€ä¸ªçº¤ç¨‹åœ¨æŒ‚èµ·æœŸé—´ä¿®æ”¹äº† $counter ä¼šæ€æ ·ï¼Ÿ
</code></pre>
<p>å°å¿ƒå…¨å±€çŠ¶æ€ã€‚å…¶ä»–ä»£ç ï¼ˆæˆ–å…¶ä»–çº¤ç¨‹ï¼‰å¯èƒ½åœ¨ä½ æŒ‚èµ·æ—¶ä¿®æ”¹å®ƒã€‚</p>
<h3 data-id="heading-40">6. çº¤ç¨‹åˆ›å»ºå¼€é”€</h3>
<p>åˆ›å»ºçº¤ç¨‹æœ‰å°‘é‡å¼€é”€ã€‚ä¸è¦åˆ›å»ºæ•°ç™¾ä¸‡ä¸ªã€‚ä¸çº¿ç¨‹ç›¸æ¯”å®ƒä»¬æ˜¯è½»é‡çº§çš„ï¼Œä½†ä¸æ˜¯å…è´¹çš„ã€‚</p>
<h2 data-id="heading-41">ç»“è®ºï¼šç†è§£ä½ çš„å·¥å…·çš„åŠ›é‡</h2>
<p>å½“ä½ å­¦ä¹ æ•°æ®ç»“æ„å’Œç®—æ³•æ—¶ï¼Œä½ ä¸ä»…ä»…æ˜¯è®°å¿†å®šä¹‰å’Œè¯­æ³•ï¼Œä½ è¿˜å­¦ä¹ ä½•æ—¶ä½¿ç”¨å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä¸è®¤è¯†ä½•æ—¶éœ€è¦åœ¨ä¸¤ç«¯å¿«é€Ÿæ’å…¥/åˆ é™¤ï¼ŒåŒå‘é“¾è¡¨å°±æ²¡æœ‰ç”¨ã€‚</p>
<p>è¿™åŒæ ·é€‚ç”¨äºè¯­è¨€ç‰¹æ€§ã€‚PHP è‡ª 8.1 ä»¥æ¥å°±æœ‰äº†çº¤ç¨‹ï¼Œä½†å¤§å¤šæ•°å¼€å‘è€…ä¸ä½¿ç”¨å®ƒä»¬ï¼Œå› ä¸ºä»–ä»¬ä¸è®¤è¯†çº¤ç¨‹è§£å†³çš„é—®é¢˜ã€‚æ‰€ä»¥ï¼Œä¸‹æ¬¡å½“ä½ é¢ä¸´æ¶‰åŠä»¥ä¸‹é—®é¢˜æ—¶ï¼š</p>
<ul>
<li>æš‚åœå’Œæ¢å¤æ‰§è¡Œ</li>
<li>åœ¨å¹²å‡€çš„ API èƒŒåéšè—å¤æ‚æ€§</li>
<li>ä½¿å¼‚æ­¥ä»£ç æ„Ÿè§‰åŒæ­¥</li>
<li>åä½œå¼å¤šä»»åŠ¡</li>
</ul>
<p>é—®è‡ªå·±ï¼š"çº¤ç¨‹èƒ½ä¼˜é›…åœ°è§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿ"</p>
<p>ä½ å¯èƒ½ä¼šæƒŠè®¶äºç­”æ¡ˆæ˜¯è‚¯å®šçš„é¢‘ç‡ã€‚</p>
<h2 data-id="heading-42">æ€»ç»“</h2>
<p>PHP çº¤ç¨‹ï¼ˆFibersï¼‰è‡ª PHP 8.1 å¼•å…¥ä»¥æ¥ï¼Œä¸€ç›´æ˜¯ä¸€ä¸ªè¢«ä½ä¼°çš„ç‰¹æ€§ã€‚é€šè¿‡ PHP MCP SDK çš„å®¢æˆ·ç«¯é€šä¿¡åŠŸèƒ½ï¼ˆPR #109ï¼‰è¿™ä¸ªå®é™…æ¡ˆä¾‹ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†çº¤ç¨‹å¦‚ä½•ä¼˜é›…åœ°è§£å†³å¤æ‚çš„æ¶æ„é—®é¢˜ã€‚</p>
<p>è¿™ä¸ªå®ç°çš„ç²¾å¦™ä¹‹å¤„ä¸åœ¨äºå…¶æŠ€æœ¯å¤æ‚åº¦ï¼Œè€Œåœ¨äºå…¶è®¾è®¡ç†å¿µâ€”â€”é€šè¿‡çº¤ç¨‹å°†å¤æ‚çš„åŒå‘é€šä¿¡æœºåˆ¶éšè—åœ¨ç®€æ´çš„åŒæ­¥é£æ ¼ API èƒŒåï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿç¼–å†™ç›´è§‚ã€æ˜“è¯»çš„ä»£ç ï¼Œè€Œæ— éœ€å…³å¿ƒåº•å±‚çš„æŒ‚èµ·ã€æ¢å¤å’ŒçŠ¶æ€ç®¡ç†ã€‚</p>
<h3 data-id="heading-43">å…³é”®è¦ç‚¹</h3>
<ol>
<li><strong>çº¤ç¨‹ä¸æ˜¯å¼‚æ­¥æœºåˆ¶</strong>ï¼Œè€Œæ˜¯åä½œå¼å¤šä»»åŠ¡çš„å®ç°ï¼Œæ˜¯ç®¡ç†æ‰§è¡Œæµçš„å·¥å…·</li>
<li><strong>æ­£ç¡®çš„æŠ½è±¡å±‚æ¬¡</strong>ï¼šè®©å¤æ‚æ€§åœ¨åº“å±‚é¢è§£å†³ä¸€æ¬¡ï¼Œæ‰€æœ‰ç”¨æˆ·å—ç›Š</li>
<li><strong>ä¼ è¾“æ— å…³æ€§</strong>ï¼šåŒä¸€å¥—çº¤ç¨‹æœºåˆ¶å¯ä»¥é€‚é…ä¸åŒçš„ I/O æ¨¡å‹ï¼ˆé˜»å¡ã€éé˜»å¡ã€å¤šè¿›ç¨‹ï¼‰</li>
<li><strong>ç”¨æˆ·å‹å¥½</strong>ï¼šæœ€å¥½çš„æŠ€æœ¯æ˜¯è®©é—®é¢˜å¯¹ç”¨æˆ·æ¶ˆå¤±çš„æŠ€æœ¯</li>
</ol>
<h3 data-id="heading-44">é€‚ç”¨åœºæ™¯</h3>
<p>çº¤ç¨‹æœ€é€‚åˆï¼š</p>
<ul>
<li>æ„å»ºåº“å’Œæ¡†æ¶</li>
<li>éšè—å¼‚æ­¥å¤æ‚æ€§</li>
<li>éœ€è¦æš‚åœå’Œæ¢å¤æ‰§è¡Œä¸Šä¸‹æ–‡çš„åœºæ™¯</li>
<li>æ¡¥æ¥åŒæ­¥å’Œå¼‚æ­¥ä»£ç </li>
</ul>
<p>ä¸é€‚ç”¨äºï¼š</p>
<ul>
<li>ç®€å•çš„çº¿æ€§æµç¨‹</li>
<li>éœ€è¦çœŸæ­£å¹¶è¡Œæ€§çš„åœºæ™¯</li>
<li>å¯ä»¥ç”¨ç®€å•å›è°ƒæˆ–ç”Ÿæˆå™¨è§£å†³çš„é—®é¢˜</li>
</ul>
<p>é€‰æ‹©æ­£ç¡®çš„å·¥å…·ï¼Œç†è§£å·¥å…·çš„æœ¬è´¨ï¼Œæ˜¯æ„å»ºä¼˜é›…è½¯ä»¶çš„å…³é”®ã€‚PHP çº¤ç¨‹æ­£æ˜¯è¿™æ ·ä¸€ä¸ªè¢«ä½ä¼°ä½†æå…¶å¼ºå¤§çš„å·¥å…·ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>