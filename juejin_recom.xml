<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>掘金文章推荐</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>一个帮助开发者成长的社区</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[深入剖析 Skills.md —— 不是炒冷菜，而是 Agent 的“操作手册”]]></title>    <link>https://juejin.cn/post/7599551824548036634</link>    <guid>https://juejin.cn/post/7599551824548036634</guid>    <pubDate>2026-01-26T21:25:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599551824548036634" data-draft-id="7599538010725548059" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="深入剖析 Skills.md —— 不是炒冷菜，而是 Agent 的“操作手册”"/> <meta itemprop="keywords" content="架构"/> <meta itemprop="datePublished" content="2026-01-26T21:25:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="MobotStone"/> <meta itemprop="url" content="https://juejin.cn/user/3839909554568840"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            深入剖析 Skills.md —— 不是炒冷菜，而是 Agent 的“操作手册”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3839909554568840/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    MobotStone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T21:25:07.000Z" title="Mon Jan 26 2026 21:25:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>如果要选一个“2025 年底最火的概念词”，那大概率就是<strong>skills</strong> 了。</p>
<p>但我刚打开<code>skill.md</code> 的时候，老实说第一眼直接看懵：我脑子里冒出的念头是——这是不是又在“重复造轮子”？</p>
<p>毕竟大家早就会做<strong>Agent 工具</strong>了，用来让智能体真正去执行任务。在不同平台和生态里，这类东西只是叫法不同：有人叫<strong>tools（工具）</strong> ，有人叫<strong>plugins（插件）</strong> ，也有人叫<strong>skills（技能）</strong> 。所以我一开始理所当然地以为：这不就是同一种东西换个包装、换个名字吗？</p>
<p>结果我继续往下研究，才发现事情没这么简单。我彻底理清了<code>skill.md</code>的定义，也理解了 Anthropic 推出它的战略意图。事实证明，它与传统的 Agent 工具之间，存在著关键性的差异。</p>
<h3 data-id="heading-0">核心区别：“脑子”里的想法 vs “手里”的工具</h3>
<p>简单来说，这两者的区别就像是 “操作手册” 和 “工具箱” 的区别。</p>
<h4 data-id="heading-1">1. Agent Skills：装在脑子里的“做事套路”</h4>
<p><strong>Agent Skills</strong>就像给一个新来的实习生发了一本<strong>工作手册</strong>，或者说一套<strong>技能秘籍</strong>。</p>
<ul>
<li>它是一份标准化的教程（通常写在<code>skill.md</code>文件里）。</li>
<li>它教AI遇到某种任务时该怎么动脑子：
第一步干啥，第二步干啥，有哪些细节要注意。</li>
</ul>
<p><strong>举个例子</strong>：如果这是做菜的技能，那它就是**“回锅肉的菜谱”**。
它告诉AI：先切肉、再炒青椒、最后加调料——每个步骤的节奏都列得明明白白。</p>
<ul>
<li>Skill = “做事方法”，让AI知道<strong>该怎么干</strong>。</li>
</ul>
<h4 data-id="heading-2">2. Agent Tools：拿在手里的工具</h4>
<p><strong>Tools</strong>是AI手里真正能用的<strong>工具</strong>。</p>
<ul>
<li>比如：电脑的命令行、读取文件的接口、联网搜索用的API……
举个例子：在厨房里，Skills是“菜谱”，而Tools就是<strong>菜刀、炒锅和燃气灶</strong>。
它们不会自己炒菜，但没有它们，连锅都上不了。</li>
<li>Tool = “操作能力”，让AI<strong>能动手去干</strong>。</li>
</ul>
<p><strong>一句话总结：</strong></p>
<ul>
<li><strong>skills</strong>告诉智能体“怎么做”——是经验和方法；</li>
<li>tools让智能体“能动手”——是执行的能力。
而且，一个技能往往会指导智能体用合适的工具去完成任务。</li>
</ul>
<h3 data-id="heading-3">skills.md 解决了哪些问题？</h3>
<p>既然工具已经存在，为什么还需要这种新格式？它解决了五个具体问题。</p>
<h4 data-id="heading-4">1. 把“能做”变成“会做”</h4>
<ul>
<li><strong>以前的问题</strong>：AI 工具很强，比如能发邮件、能查数据，但它不知道你们公司的“潜规则”或具体流程。就像一个有力气的员工，却不知道该先迈哪条腿。</li>
<li><strong>现在的方案</strong>：<code>skills.md</code> 不仅给 AI 赋予行动能力，还把“什么时候做”以及“结合公司/团队/用户的具体情况该怎么做”的背景知识一起打包给它。</li>
</ul>
<h4 data-id="heading-5">2. 不一次性塞太多信息</h4>
<ul>
<li><strong>以前的问题</strong>：为了让 AI 懂得多，把所有资料一股脑全塞进它的对话记忆里（Context），导致它运行缓慢，而且容易“消化不良”（上下文膨胀）。</li>
<li><strong>现在的方案</strong>：这是一种“省流模式”。刚开始只加载一个大概的“目录”（极小的内存占用），等真要用这个技能时，再加载详细的说明书，需要素材时再加载素材。</li>
</ul>
<h4 data-id="heading-6">3. 一次编写，到处通用</h4>
<ul>
<li><strong>以前的问题</strong>：很多工具是“专机专用”的，换一个 AI 平台就得重写。</li>
<li><strong>现在的方案</strong>：<code>skills.md</code> 就像一个通用的 USB 设备。你把技能包做好一次，就可以插到各种不同的 AI 代理（Agent）产品上直接使用，不用重复造轮子。</li>
</ul>
<h4 data-id="heading-7">4. 把“老专家的经验”打包</h4>
<ul>
<li><strong>以前的问题</strong>：复杂的流程（比如法律合规、数据处理）很难传递，往往依赖人的口口相传。</li>
<li><strong>现在的方案</strong>：它可以把这些专业的、复杂的流程封装成一个标准的“技能包”。这个包有版本记录、可以被审计，方便在不同团队之间安全地共享专业经验。</li>
</ul>
<h4 data-id="heading-8">5. 只要识字就能看懂</h4>
<ul>
<li><strong>以前的问题</strong>：很多工具的逻辑写在复杂的代码里，想搞清楚它到底怎么运行的，像读天书一样难。</li>
<li><strong>现在的方案</strong>：<code>skills.md</code>本质上就是一份 Markdown 格式的文档。它不仅机器能读，<strong>人也能轻松阅读</strong>。无论是检查、修改还是优化，都像编辑普通文档一样简单直观。</li>
</ul>
<h3 data-id="heading-9">案例分析: HR Skill</h3>
<p>以下是skill.md文件的实际示例。</p>
<pre><code class="hljs language-markdown" lang="markdown">--- 名称：人力资源问题解答
<span class="hljs-section">描述：解答与人力资源相关的问题，包括政策、福利、请假、入职和员工指南。
---</span>
<span class="hljs-section"># 人力资源问题处理</span>
<span class="hljs-section">## 何时使用此技能</span>
当用户询问以下问题时，请使用此技能：
<span class="hljs-bullet">-</span> 公司政策（考勤、着装规范、远程办公）
<span class="hljs-bullet">-</span> 福利（医疗保险、退休计划、带薪休假）
<span class="hljs-bullet">-</span> 请假（年假、病假、育儿假）
<span class="hljs-bullet">-</span> 入职和离职流程
<span class="hljs-bullet">-</span> 绩效考核和反馈流程
<span class="hljs-bullet">-</span> 薪酬和工资相关问题

<span class="hljs-section">## 如何解答人力资源问题</span>
<span class="hljs-bullet">1.</span> 根据用户的问题确定人力资源主题
<span class="hljs-bullet">2.</span> 参考相应的公司政策文件
<span class="hljs-bullet">3.</span> 提供清晰准确的信息
<span class="hljs-bullet">4.</span> 对于敏感或复杂的问题，请转介给人力资源联系人

<span class="hljs-section">## 重要准则</span>
<span class="hljs-bullet">-</span> 切勿泄露员工机密信息
<span class="hljs-bullet">-</span> 将法律或合规问题上报人力资源主管
<span class="hljs-bullet">-</span> 始终在适用情况下引用相关政策文件 # 人力资源问题处理
</code></pre>
<p>它存储在以下文件夹结构中：</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-skill/
├── SKILL.md          <span class="hljs-comment"># 必需：说明 + 元数据</span>
├── scripts/          <span class="hljs-comment"># 可选：可执行代码</span>
├── references/       <span class="hljs-comment"># 可选：文档</span>
└── assets/           <span class="hljs-comment"># 可选：模板、资源</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e95a70b63ec46f7ba2237224a9c2b54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9ib3RTdG9uZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770067508&amp;x-signature=nBGvWUvIjHzQkZknwfXPMmh5ROI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">skill是怎么工作的</h2>
<p>技能采用<strong>渐进式展开</strong>来高效管理上下文。</p>
<ul>
<li><strong>发现阶段：</strong> 启动时，智能体只加载每个技能的名称和简介。信息够用来判断“这个技能可能用得上吗？”</li>
<li>**激活阶段：**当任务和某个技能的描述匹配时，智能体才会把完整的<code>SKILL.md</code> 说明读进上下文。</li>
<li><strong>执行阶段：</strong> 智能体按说明操作，必要时再加载相关文件或运行打包的代码。</li>
</ul>
<p>这样既能保持速度，又能在需要时获取更多信息。核心要点就是<strong>渐进式信息披露</strong>：省 token，减少提示词膨胀。</p>













































<table><thead><tr><th>特性</th><th>Skills.md  (Agent Skills)</th><th>Agent</th></tr></thead><tbody><tr><td>核心概念</td><td>知识与专长： 告诉Agent如何以及何时处理复杂任务的“剧本”。</td><td>机制与动作： 允许Agent与外部世界（API、系统）交互的“双手”。</td></tr><tr><td>主要功能</td><td>提供上下文、工作流、规则和最佳实践。它负责编排推理过程。</td><td>执行特定的、确定性的功能，如查询数据库、写文件或发送电子邮件。</td></tr><tr><td>文件结构</td><td>一个包含 <a href="https://link.juejin.cn?target=http%3A%2F%2Fskill.md" target="_blank" title="http://skill.md" ref="nofollow noopener noreferrer">skill.md</a> 文件（Markdown 指令 + YAML 元数据）和可选资源文件的文件夹。</td><td>一个架构（通常是 JSON），定义函数名称、参数、描述以及运行它们的后端代码。</td></tr><tr><td>上下文管理</td><td>渐进式披露： 开始时仅加载微量的元数据（约 100 个 token）。仅在相关时才加载完整指令。</td><td>预先加载： 通常需要在会话开始时将完整的工具定义和架构加载到上下文窗口中。</td></tr><tr><td>相互关系</td><td>一个“skill”通常会使用“tool”。它充当管理者的角色，指导使用哪些tool以及按什么顺序使用。</td><td>“工具”由Agent（或技能）使用。它们是等待被调用的原始实用程序。</td></tr><tr><td>可移植性</td><td>知识的高可移植性（它只是文本/Markdown），但目前的格式特定于某些Agent运行时（如 Anthropic 的运行时）。</td><td>如果使用 MCP（模型上下文协议）等标准，则具有很高的执行可移植性，允许一个工具在许多应用程序中工作。</td></tr><tr><td>示例用例</td><td>“教Agent如何编写代码审查”（例如：检查逻辑错误、礼貌性、使用 Git 提取代码）。</td><td>“运行 API 调用”（例如：执行从代码库中检索数据的特定命令）。</td></tr></tbody></table>
<h3 data-id="heading-11">总结：给 AI 装上“方向盘”</h3>
<p>回到一开始的问题：<strong>不，我们并不是在重复造轮子。我们只是意识到：一辆车想开得好，光有轮子不够——还得有</strong>方向盘和<strong>地图</strong>。
“Agent Tools”确实释放了很强的能力：它们让 AI 能接触真实世界、查询数据库、执行代码。但<strong>有能力</strong>不等于<strong>会做事、做得对</strong>。
Skills.md 正是用来补上“能做”和“做得好”之间的差距。</p>
<ul>
<li><strong>Tools</strong>解决的是“怎么执行”的问题：点按钮、调接口、跑代码。</li>
<li><strong>Skills</strong>解决的是“怎么做才对”的问题：流程、上下文、细节拿捏与判断。</li>
</ul>
<p>当我们走向更自动化的智能体时，真正的瓶颈往往不是“它能不能做这个动作”，而是“它知不知道你们团队规定的、那个<strong>明确的 10 步标准流程</strong>，并按要求做到位”。把“<strong>怎么做（Skills，方法与规范）</strong> ”和“<strong>能做什么（Tools，执行能力）</strong> ”分开后，智能体就不只是强大，还会更<strong>可靠、合规、高效</strong>。</p>
<p>如果你只是做一些简单机器人，可能工具就够用；但如果你要做的是“数字员工”，那就必须要有技能（Skills）。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Skip 开源：从“卖工具”到“卖信任”的豪赌 -- 肘子的 Swift 周报 #120]]></title>    <link>https://juejin.cn/post/7599551824548102170</link>    <guid>https://juejin.cn/post/7599551824548102170</guid>    <pubDate>2026-01-27T00:13:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599551824548102170" data-draft-id="7598563188112408628" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Skip 开源：从“卖工具”到“卖信任”的豪赌  -- 肘子的 Swift 周报 #120"/> <meta itemprop="keywords" content="Swift,SwiftUI,人工智能"/> <meta itemprop="datePublished" content="2026-01-27T00:13:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="东坡肘子"/> <meta itemprop="url" content="https://juejin.cn/user/1548526032528727"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Skip 开源：从“卖工具”到“卖信任”的豪赌  -- 肘子的 Swift 周报 #120
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1548526032528727/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    东坡肘子
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T00:13:32.000Z" title="Tue Jan 27 2026 00:13:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读11分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b11674cfc1bc4751bbf23cc5921a6ded~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lic5Z2h6IKY5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770077612&amp;x-signature=9RC%2FMUBymc7beiCja1OVV9MNfe4%3D" alt="issue120.webp" loading="lazy"/></p>
<h2 data-id="heading-0">Skip 开源：从“卖工具”到“卖信任”的豪赌</h2>
<p>在宣布 <a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-110%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-110/" ref="nofollow noopener noreferrer">Fuse 版本对独立开发者免费</a> 仅两个月后，Skip Tools 再次做出惊人之举——<a href="https://link.juejin.cn?target=https%3A%2F%2Fskip.dev%2Fblog%2Fskip-is-free%2F%3Futm_source%3Dfatbobman%2520weekly%2520issue%2520120%26utm_medium%3Dweb" target="_blank" title="https://skip.dev/blog/skip-is-free/?utm_source=fatbobman%20weekly%20issue%20120&amp;utm_medium=web" ref="nofollow noopener noreferrer">全面免费并开源核心引擎 skipstone</a>。这意味着 Skip 彻底改变了经营方式：从“卖产品”转向“卖服务+社区赞助”。这次变化，既有对之前商业模式执行不佳而被迫调整的无奈，也体现了 Skip 团队的果敢——在当前 AI 盛行、开发工具格局固化的背景下，主动求变，力求突破。</p>
<p>很多优秀且有特点的产品没能获得应有的使用量，最大的阻碍往往不是技术，而是“信任”。正如 Skip 官方所言，企业最担心的是“rug pull”——万一公司倒闭或被收购，押注在这个工具上的产品和技术栈将面临推倒重来的风险。Skip 希望通过开源消除这种信任危机，让自己和其他跨平台工具站在同一起跑线上，同时激活社区力量，加速生态建设。</p>
<p>尽管社区对 Skip 的开源决定给予了充分肯定，但也有不少人担心：在放弃了 license key 这一稳定收入来源后，仅靠赞助模式能否支撑持续开发成本？毕竟，成功的开源商业案例虽有，但失败的也不少。这种担忧并非杞人忧天。在我撰写本期周报时（宣布开源数天后），尽管开源消息在社交媒体上引发了热议，但在 GitHub 上，Skip 的个人赞助者仅有十几位。从“热闹的讨论”到“真金白银的支持”，中间的鸿沟似乎比想象中还要深。这或许也解释了为什么 Skip 最终选择了开源——在无法说服开发者"付费使用"时，至少要争取到他们"免费使用"的机会。</p>
<p>一个有趣的现象是，在肯定与忧虑并存的情绪中，讨论的焦点悄然发生了变化：从“为什么要花钱买 Skip 而不是用免费的 KMP?”变成了“你是更喜欢写 Swift 还是 Kotlin?”。这个转变意义重大——它意味着 Skip 已经成功将竞争维度从“商业模式”转移到了“语言生态”，而参与竞争的主体也从“一家小公司”扩展为“整个 Swift 社区”。在这场语言之争中，Skip 聪明地（或许是无意间）将自己的角色从“主角”变成了“基础设施”。</p>
<p>Skip 最早的出发点是看到了一个商业机会，认为有足够的商业回报。如果不是有这样的预期，仅靠官方或社区的力量，Swift 可能无法快速推进在其他平台上的进展。这一路径与 The Browser Company 为了打造 Arc 浏览器而大力推动 Swift 在 Windows 平台上的适配如出一辙。</p>
<p>作为一个 Swift 开发者，我由衷希望 Skip 的这次调整能够取得预期效果。开源是一场信任的实验，也是一次生态的投资。如果你也期待 Swift 能在 iOS 之外的平台上拥有更多可能，不妨从成为一个<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsponsors%2Fskiptools" target="_blank" title="https://github.com/sponsors/skiptools" ref="nofollow noopener noreferrer">独立赞助者</a>($10/月)做起——这不仅是对 Skip 的支持，更是对整个 Swift 跨平台生态的投票。开源的 Skip 能走多远，取决于有多少人愿意从旁观者变成参与者。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-120%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-120/" ref="nofollow noopener noreferrer">本期内容</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-119%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-119/" ref="nofollow noopener noreferrer">前一期内容</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2F" target="_blank" title="https://fatbobman.com/zh/weekly/" ref="nofollow noopener noreferrer">全部周报列表</a></p>
<blockquote>
<p>🚀 <strong>《肘子的 Swift 周报》</strong></p>
<p>每周为你精选最值得关注的 Swift、SwiftUI 技术动态</p>
<ul>
<li><strong>📮 立即订阅</strong> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fweekly.fatbobman.com%2Ffatbobman" target="_blank" title="https://weekly.fatbobman.com/fatbobman" ref="nofollow noopener noreferrer">weekly.fatbobman.com</a> 获取完整内容</li>
<li><strong>👥 加入社区</strong> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscord.com%2Finvite%2F7FedN5E2QQ" target="_blank" title="https://discord.com/invite/7FedN5E2QQ" ref="nofollow noopener noreferrer">Discord</a> 与 2000+ 开发者交流</li>
<li><strong>📚 深度教程</strong> | <a href="https://link.juejin.cn?target=http%3A%2F%2Ffatbobman.com" target="_blank" title="http://fatbobman.com" ref="nofollow noopener noreferrer">fatbobman.com</a> 探索 200+ 原创文章</li>
</ul>
</blockquote>
<h2 data-id="heading-1">原创</h2>
<h3 data-id="heading-2"><a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fposts%2Fletting-swift-closures-automatically-inherit-isolation%2F%3Futm_source%3Dfatbobman%2520weekly%2520issue%2520120%26utm_medium%3Dweb" target="_blank" title="https://fatbobman.com/zh/posts/letting-swift-closures-automatically-inherit-isolation/?utm_source=fatbobman%20weekly%20issue%20120&amp;utm_medium=web" ref="nofollow noopener noreferrer">isolated(any) 与 #isolation：让 Swift 闭包自动继承隔离域</a></h3>
<p>Swift 6 为并发引入了许多新功能与关键字。虽然其中不少内容在日常开发中可能鲜少用到，但一旦遭遇特定场景，若对这些新概念缺乏了解，即便有 AI 辅助也可能陷入僵局。本文将通过一个在开发测试中遇到的实际并发问题，来介绍如何利用 <strong><code>@isolated(any)</code></strong> 以及 <strong><code>#isolation</code></strong> 宏，实现函数的隔离域继承，从而让编译器自动推断闭包的运行环境。</p>
<h2 data-id="heading-3">近期推荐</h2>
<h3 data-id="heading-4"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0120-01" target="_blank" title="https://l.fatbobman.com/w0120-01" ref="nofollow noopener noreferrer">SwiftData 数据迁移全解析 (A Deep Dive into SwiftData migrations)</a></h3>
<p>随着应用的发展，数据模型几乎无可避免地会出现变化，如何安全地进行数据迁移对很多开发者来说都是一个不小的挑战。在本文中，<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fdonnywals" target="_blank" title="https://x.com/donnywals" ref="nofollow noopener noreferrer">Donny Wals</a> 全面讲解了 SwiftData 的数据迁移机制，从基础的版本控制到复杂的自定义迁移策略。其中，Donny 给出了几个特别有价值的建议：即使是 V1 版本也应该使用 <code>VersionedSchema</code> 进行封装，为未来的迁移打好基础；只在 App Store 发布周期之间引入新的 Schema 版本，而不是在开发过程中频繁修改；对于轻量迁移，即使 SwiftData 可以自动完成，也建议显式地写入 <code>SchemaMigrationPlan</code> 中，使意图更加明确且易于测试。</p>
<p>文章的一大亮点是详细解释了 <code>MigrationStage.custom</code> 中 <code>willMigrate</code> 与 <code>didMigrate</code> 的适用场景，并提出了应对复杂重构（例如拆分实体）的“桥接版本（Bridge Version）”策略。</p>
<hr/>
<h3 data-id="heading-5"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0120-02" target="_blank" title="https://l.fatbobman.com/w0120-02" ref="nofollow noopener noreferrer">为什么 MVVM-C 在 SwiftUI 项目中依然能扩展 (Why MVVM-C with Coordinators does Scale -&gt; A real-world SwiftUI perspective)</a></h3>
<p>尽管标题中包含“MVVM-C”，但这并非一篇单纯为某种架构模式辩护的文章。<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.linkedin.com%2Fin%2Fvalentebruno%2F" target="_blank" title="https://www.linkedin.com/in/valentebruno/" ref="nofollow noopener noreferrer">Bruno Valente Pimentel</a> 在文中重新定义了“扩展性”的内涵——它不应仅以屏幕或文件的数量来衡量，而应看其是否支持高效的多人协作及功能的独立演进。正如作者所言：“架构无关乎模式，而关乎减少恐惧”——减少修改代码、团队协作以及功能演进时的恐惧。</p>
<blockquote>
<p>无论你倾向于哪种架构模式，在用它构建 SwiftUI 项目时，都应该认真思考：我们到底是在利用 SwiftUI 的特性，还是在试图把 SwiftUI 改造成我们熟悉的 UIKit？</p>
</blockquote>
<hr/>
<h3 data-id="heading-6"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0120-03" target="_blank" title="https://l.fatbobman.com/w0120-03" ref="nofollow noopener noreferrer">TCA 架构的真实评估 (TCA (Composable Architecture): The Honest Review)</a></h3>
<p>继 Bruno 为 MVVM-C “正名”后，<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.linkedin.com%2Fin%2Fchandrawelim%2F" target="_blank" title="https://www.linkedin.com/in/chandrawelim/" ref="nofollow noopener noreferrer">Chandra Welim</a> 对另一个极具争议的架构——TCA 进行了客观评估。作者总结了 TCA 的五大优势（可预测的状态管理、优秀的可测试性、时间旅行调试、组合性、强类型安全）和五大挑战（学习曲线、样板代码、团队采纳、对简单应用过度设计、第三方依赖），同时给出了务实的建议：TCA 是一个强大的工具，但绝非适用于所有场景。对于简单的 MVP 或缺乏函数式编程背景的团队，传统的 MVVM 或许是更务实的选择；而对于状态错综复杂、需要“时间旅行”调试的大型项目，TCA 则能提供无与伦比的掌控力。核心结论：TCA 在你需要时很值得，但大多数应用并不需要它。</p>
<blockquote>
<p>架构选择没有银弹，只有在特定上下文中的权衡。</p>
</blockquote>
<hr/>
<h3 data-id="heading-7"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0120-04" target="_blank" title="https://l.fatbobman.com/w0120-04" ref="nofollow noopener noreferrer">让 C 库在 Swift 中“像原生 API 一样好用” (Improving the usability of C libraries in Swift)</a></h3>
<p>Swift 虽然生来就兼容 C，但直接调用 C API 往往体验不佳——开发者通常需要面对裸指针、手动内存管理以及不符合 Swift 命名习惯的函数。为了获得“原生”体验，开发者不得不编写和维护繁琐的 Wrapper 层。在这篇文章中，<a href="https://link.juejin.cn?target=https%3A%2F%2Fsfba.social%2F%40dgregor79" target="_blank" title="https://sfba.social/@dgregor79" ref="nofollow noopener noreferrer">Doug Gregor</a> 详细介绍了如何利用 API Notes 和 Clang Attributes 机制，在不修改 C 库实现代码的前提下，“指导” Swift 编译器生成符合 Swift 风格的接口。</p>
<p>这项改进的意义在于，它将“封装 C 库”的成本从逻辑层（编写 Swift 胶水代码）转移到了声明层（编写 API Notes 或添加头文件注解）。这对于 Embedded Swift 的普及至关重要，因为嵌入式开发高度依赖现有的 C 库生态。随着工具链的完善，未来开发者可能只需要给 C 库加几个注解，就能直接在 Swift 中像使用原生库一样调用它。文章还提供了基于正则表达式的自动化脚本，可以为结构化的 C 头文件批量生成 API Notes。</p>
<hr/>
<h3 data-id="heading-8"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0120-05" target="_blank" title="https://l.fatbobman.com/w0120-05" ref="nofollow noopener noreferrer">在 Yocto 系统中构建 Swift (Introduction to Building Swift for Yocto)</a></h3>
<p>对于大多数 iOS 开发者来说，Yocto 可能比较陌生，但它是嵌入式 Linux 领域的事实标准——它能够精确控制系统中包含的每一个组件。随着 Embedded Swift 的推进，如何在 Yocto 生态中集成 Swift 成为了一个关键问题。<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fxtremekforever" target="_blank" title="https://x.com/xtremekforever" ref="nofollow noopener noreferrer">Jesse L. Zamora</a> 详细演示了如何使用近期重获更新的 <code>meta-swift</code> 在 Yocto 系统中构建 Swift 运行环境。文章以 Raspberry Pi Zero 2 为例，从 Docker 环境搭建、Yocto 构建、镜像烧录到实际运行，演示了完整的工作流。</p>
<p>需要注意的是，完整构建过程需要数小时，且要求对 Yocto 构建系统有基本了解。不过，文章提供的 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fswift-embedded-linux%2Fmeta-swift-examples" target="_blank" title="https://github.com/swift-embedded-linux/meta-swift-examples" ref="nofollow noopener noreferrer">meta-swift-examples</a> 仓库已经包含了 Docker 化的构建环境和一键脚本，大大降低了上手门槛。</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fjeremy-prater%2Fmeta-swift" target="_blank" title="https://github.com/jeremy-prater/meta-swift" ref="nofollow noopener noreferrer">meta-swift</a> 是 Swift 语言的 Yocto 层，此前曾长期停滞于 Swift 5.7，但在社区的努力下，目前已支持到 Swift 6.1.3。</p>
</blockquote>
<hr/>
<h3 data-id="heading-9"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0120-06" target="_blank" title="https://l.fatbobman.com/w0120-06" ref="nofollow noopener noreferrer">让 Xcode 的 DEBUG 构建自动部署到 /Applications (TIL how to auto-move Xcode DEBUG builds to Applications)</a></h3>
<p>开发包含 App Intents 的应用时，你可能遇到过这个问题：App Intents 必须在 <code>/Applications</code> 目录下才能在 Shortcuts.app 中显示。这意味着 DEBUG 构建默认放在 DerivedData 中时，开发者无法测试 Shortcuts 集成。 <a href="https://link.juejin.cn?target=https%3A%2F%2Fnorden.social%2F%40czottmann" target="_blank" title="https://norden.social/@czottmann" ref="nofollow noopener noreferrer">Carlo Zottmann</a> 曾长期使用复杂的 Post-build 脚本来搬运 App，但他在本文中分享了一个更“原生”的方案——通过三行 <code>.xcconfig</code> 配置让 Xcode 自动将构建产物部署到指定目录，并在清理构建时正确删除已部署的文件。</p>
<blockquote>
<p>这个技巧不仅适用于 App Intents 测试，也适用于任何需要将 DEBUG 构建放到特定位置的场景。</p>
</blockquote>
<hr/>
<h3 data-id="heading-10"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0120-07" target="_blank" title="https://l.fatbobman.com/w0120-07" ref="nofollow noopener noreferrer">用 Swift Charts 构建自定义可交互仪表盘 (Visualise anything with SwiftUI Charts)</a></h3>
<p>如果你需要自定义一个可动画、可交互的环形压力仪表盘（Stress Indicator）的 SwiftUI 组件，你会如何进行？是使用 Shape，还是 Canvas？<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.linkedin.com%2Fin%2Fkyryl-horbushko-67936bb5%2F" target="_blank" title="https://www.linkedin.com/in/kyryl-horbushko-67936bb5/" ref="nofollow noopener noreferrer">Kyryl Horbushko</a> 在本文中展示了一个非常有创意的解法——利用 Swift Charts 的 <code>SectorMark</code>，优雅且高效地实现了需求。</p>
<p>Kyryl 的实现打破了我们对 Swift Charts 仅用于“数据可视化”的刻板印象。对于需要开发健康类、金融类复杂 Dashboard 的开发者来说，这是一种极具参考价值的"降维打击"式方案——用数据可视化框架解决自定义 UI 问题，既减少代码量，又获得内置的动画和交互支持。</p>
<h2 data-id="heading-11">工具</h2>
<h3 data-id="heading-12"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0120-08" target="_blank" title="https://l.fatbobman.com/w0120-08" ref="nofollow noopener noreferrer">Commander：兼顾专注与灵活的 AI 编程体验</a></h3>
<p>我喜欢在 macOS 上使用 CLI 工具(Claude Code、Codex)，但原生终端应用的视觉体验实在不敢恭维，因此多数情况下我都在 VSCode 中通过插件来改善体验。然而，VSCode 的一个设计始终让我困扰：即便将 Claude Code 的对话栏最大化，AI 修改文件时仍会自动打开新的文件栏或窗口，打断既有的交互节奏。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fkrzyzanowskim" target="_blank" title="https://x.com/krzyzanowskim" ref="nofollow noopener noreferrer">Marcin Krzyżanowski</a> 开发的 macOS 原生应用 Commander 给了我一个新的选择。它提供了一个比终端更优的交互界面，同时保护了我的“心流”——文件只在需要时才开启，并能调用系统默认应用查看。Commander 目前支持 Claude Code 和 Codex，内置了 Git worktrees 和 Code diff 支持，且完全免费。它在终端的“专注”与 VSCode 的“灵活”之间，构建了一个绝佳的中间地带。</p>
<hr/>
<h3 data-id="heading-13"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0120-09" target="_blank" title="https://l.fatbobman.com/w0120-09" ref="nofollow noopener noreferrer">Oh My Agents: 统一管理所有 AI 编程助手的配置</a></h3>
<p>随着 Claude Code、Cursor、Codex、Windsurf 等 AI 编程助手的涌现，开发者面临着一个新问题：如何管理散落在各个项目中的 prompts、skills 和 rules? 每个 Agent 都有自己的配置规范(<code>CLAUDE.md</code>、<code>CURSOR.md</code>...)，手动复制粘贴不仅低效，还容易导致版本混乱。<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fonevcat" target="_blank" title="https://x.com/onevcat" ref="nofollow noopener noreferrer">王巍(onevcat)</a> 开发的 Oh My Agents 提供了解决方案。</p>
<p>核心功能:</p>
<ul>
<li>集中管理所有 AI Agent 配置</li>
<li>定义分发规则，一键同步到多个项目</li>
<li>双向同步，项目改进可拉回中央库并更新所有关联项目</li>
<li>预览变更，避免意外覆盖</li>
</ul>
<p>注：目前仅支持 macOS (Windows/Linux 开发中)，Beta 期间免费。</p>
<h2 data-id="heading-14">往期内容</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-119%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-119/" ref="nofollow noopener noreferrer">从 Anthropic 封杀与苹果谷歌结盟，看 AI 护城河的构建 - #119</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-118%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-118/" ref="nofollow noopener noreferrer">AT 的人生未必比 MT 更好- #118</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhttps%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-117%2F" target="_blank" title="https://https://fatbobman.com/zh/weekly/issue-117/" ref="nofollow noopener noreferrer">2026：当 AI 隐入工作流，你准备好了吗？- #117</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-116%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-116/" ref="nofollow noopener noreferrer">Swift、SwiftUI 与 SwiftData：走向成熟的 2025 - #116</a></li>
</ul>
<h2 data-id="heading-15">💝 支持与反馈</h2>
<p>如果本期周报对你有帮助，请：</p>
<ul>
<li>👍 <strong>点赞</strong> - 让更多开发者看到</li>
<li>💬 <strong>评论</strong> - 分享你的看法或问题</li>
<li>🔄 <strong>转发</strong> - 帮助同行共同成长</li>
</ul>
<hr/>
<blockquote>
<p>🚀 <strong>拓展 Swift 视野</strong></p>
<ul>
<li><strong>📮 邮件订阅</strong> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fweekly.fatbobman.com%2Fwelcome" target="_blank" title="https://weekly.fatbobman.com/welcome" ref="nofollow noopener noreferrer">weekly.fatbobman.com</a> 获取独家技术洞察</li>
<li><strong>👥 开发者社区</strong> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscord.com%2Finvite%2F7FedN5E2QQ" target="_blank" title="https://discord.com/invite/7FedN5E2QQ" ref="nofollow noopener noreferrer">Discord</a> 实时交流开发经验</li>
<li><strong>📚 原创教程</strong> | <a href="https://link.juejin.cn?target=http%3A%2F%2Ffatbobman.com" target="_blank" title="http://fatbobman.com" ref="nofollow noopener noreferrer">fatbobman.com</a> 学习 Swift/SwiftUI 最佳实践</li>
</ul>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot开发必知的8个高效技巧：让你的生产力翻倍！]]></title>    <link>https://juejin.cn/post/7599580550295552035</link>    <guid>https://juejin.cn/post/7599580550295552035</guid>    <pubDate>2026-01-27T00:17:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599580550295552035" data-draft-id="7599586891084070946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot开发必知的8个高效技巧：让你的生产力翻倍！"/> <meta itemprop="keywords" content="后端,前端,人工智能"/> <meta itemprop="datePublished" content="2026-01-27T00:17:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="阿橙的百宝箱"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot开发必知的8个高效技巧：让你的生产力翻倍！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    阿橙的百宝箱
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T00:17:33.000Z" title="Tue Jan 27 2026 00:17:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>SpringBoot开发必知的8个高效技巧：让你的生产力翻倍！</strong></h2>
<h2 data-id="heading-1">引言</h2>
<p>SpringBoot 作为 Java 生态中最受欢迎的框架之一，以其“约定优于配置”的理念和开箱即用的特性，极大地简化了 Spring 应用的开发。然而，随着项目规模的扩大和复杂度的提升，如何高效利用 SpringBoot 的特性成为开发者必须面对的挑战。本文将分享 <strong>8 个 SpringBoot 高效开发技巧</strong>，涵盖配置优化、调试技巧、性能调优等方向，帮助开发者显著提升生产力。</p>
<hr/>
<h2 data-id="heading-2">1. 合理使用 <code>@ConfigurationProperties</code> 替代 <code>@Value</code></h2>
<h3 data-id="heading-3">问题背景</h3>
<p>在 SpringBoot 中，<code>@Value</code> 注解常用于读取配置文件中的属性，但随着配置项增多，代码会变得臃肿且难以维护。</p>
<h3 data-id="heading-4">解决方案</h3>
<p>使用 <code>@ConfigurationProperties</code> 将相关配置绑定到一个 POJO 类中：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@ConfigurationProperties(prefix = "app.datasource")</span>
<span class="hljs-meta">@Data</span> <span class="hljs-comment">// Lombok 注解</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceConfig</span> {
    <span class="hljs-keyword">private</span> String url;
    <span class="hljs-keyword">private</span> String username;
    <span class="hljs-keyword">private</span> String password;
}
</code></pre>
<p><strong>优势</strong>：</p>
<ul>
<li><strong>类型安全</strong>：避免 <code>@Value</code> 的字符串硬编码问题。</li>
<li><strong>集中管理</strong>：相关配置项聚合在一个类中，便于维护。</li>
<li><strong>IDE 支持</strong>：自动补全和校验。</li>
</ul>
<h3 data-id="heading-5">进阶技巧</h3>
<p>结合 <code>@Validated</code> 实现配置校验：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@ConfigurationProperties(prefix = "app.datasource")</span>
<span class="hljs-meta">@Validated</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceConfig</span> {
    <span class="hljs-meta">@NotBlank</span>
    <span class="hljs-keyword">private</span> String url;
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-6">2. 利用 Spring Profiles 实现环境隔离</h2>
<h3 data-id="heading-7">场景需求</h3>
<p>不同环境（开发、测试、生产）需要不同的配置（如数据库连接、日志级别）。</p>
<h3 data-id="heading-8">实现方式</h3>
<ol>
<li><strong>定义 Profile-specific 配置文件</strong>：
<ul>
<li><code>application-dev.yml</code>（开发环境）</li>
<li><code>application-prod.yml</code>（生产环境）</li>
</ul>
</li>
<li><strong>激活 Profile</strong>：
<ul>
<li>命令行参数：<code>--spring.profiles.active=dev</code></li>
<li>环境变量：<code>SPRING_PROFILES_ACTIVE=prod</code></li>
</ul>
</li>
</ol>
<h3 data-id="heading-9">最佳实践</h3>
<ul>
<li><strong>默认配置</strong>：将通用配置放在 <code>application.yml</code>，环境相关配置单独拆分。</li>
<li><strong>Profile Groups</strong>（SpringBoot 2.4+）：通过 <code>spring.profiles.group.&lt;group-name&gt;</code> 组合多个 Profile。</li>
</ul>
<hr/>
<h2 data-id="heading-10">3. Lombok + MapStruct：告别样板代码</h2>
<h3 data-id="heading-11">Lombok：简化 POJO</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Data</span>
<span class="hljs-meta">@Builder</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String name;
}
</code></pre>
<h3 data-id="heading-12">MapStruct：高效 DTO 转换</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Mapper(componentModel = "spring")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> {
    UserDTO <span class="hljs-title function_">toDTO</span><span class="hljs-params">(User user)</span>;
    User <span class="hljs-title function_">fromDTO</span><span class="hljs-params">(UserDTO dto)</span>;
}
</code></pre>
<p><strong>优势</strong>：编译时生成代码，零运行时开销。</p>
<hr/>
<h2 data-id="heading-13">4. SpringBoot DevTools：热部署与快速重启</h2>
<h3 data-id="heading-14">核心功能</h3>
<ul>
<li><strong>自动重启</strong>：修改类文件后触发应用重启（比手动重启快得多）。</li>
<li><strong>LiveReload</strong>：前端资源修改后浏览器自动刷新。</li>
<li><strong>全局配置</strong>：通过 <code>spring.devtools.restart.enabled=false</code> 禁用（生产环境需关闭）。</li>
</ul>
<h3 data-id="heading-15">VS Code/HotSwapAgent？</h3>
<p>DevTools + JRebel（商用插件）可实现更彻底的热替换（如方法体修改无需重启）。</p>
<hr/>
<h2 data-id="heading-16">5. Actuator + Micrometer ：监控与指标收集</h2>
<h3 data-id="heading-17">SpringBoot Actuator</h3>
<p>暴露应用健康、指标、日志等端点：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">management:</span>
 <span class="hljs-attr">endpoints:</span>
   <span class="hljs-attr">web:</span>
     <span class="hljs-attr">exposure:</span>
       <span class="hljs-attr">include:</span> <span class="hljs-string">health,metrics,info</span>
</code></pre>
<h3 data-id="heading-18">Micrometer ：统一监控指标</h3>
<p>集成 Prometheus/Grafana：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Bean</span>
MeterRegistryCustomizer&lt;PrometheusMeterRegistry&gt; <span class="hljs-title function_">metricsCommonTags</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> registry -&gt; registry.config().commonTags(<span class="hljs-string">"application"</span>, <span class="hljs-string">"my-app"</span>);
}
</code></pre>
<hr/>
<p>##10分钟快速入门 Elasticsearch</p>
<p>Elasticsearch是一个分布式搜索和分析引擎,基于Lucene构建,能够以近实时的速度存储、搜索和分析海量数据。</p>
<p>本文将通过简单示例带你快速上手Elasticsearch的核心功能。</p>
<p>1.安装与运行</p>
<p>下载并解压Elasticsearch(本文以7.x版本为例)</p>
<p>./bin/elasticsearch #启动单节点集群</p>
<p>验证是否运行成功: curl -X GET "localhost:9200/"</p>
<p>2.基本概念</p>
<p>索引(Index):类似数据库中的表</p>
<p>文档(Document):索引中的基本单位,相当于表中的行</p>
<p>3.CRUD操作</p>
<p>创建索引:</p>
<p>PUT /products</p>
<p>插入文档:</p>
<p>POST /products/_doc/1
{
"name":"iPhone",
"price":6999,
"description":"Apple smartphone"
}</p>
<p>查询文档:</p>
<p>GET /products/_doc/1</p>
<p>搜索文档:</p>
<p>GET /products/_search?q=name:iPhone</p>
<p>4.简单搜索</p>
<p>使用DSL进行条件查询:</p>
<p>GET /products/_search
{
"query":{
"match":{
"description":"smartphone"
}
}
}</p>
<p>5.聚合分析</p>
<p>统计价格分布:</p>
<p>GET /products/_search
{
"aggs":{
"price_stats":{
"stats":{"field":"price"}
}
}
}</p>
<p>总结:通过以上基础操作,您已经可以开始使用Elasticsearch进行数据存储和检索了。</p>
<p>下一步建议学习:
-更复杂的查询语法
-索引映射设计
-集群管理
-性能优化</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[slidev-addon-infographic 年终总结程序员必备的PPT精美图表]]></title>    <link>https://juejin.cn/post/7599581687357784114</link>    <guid>https://juejin.cn/post/7599581687357784114</guid>    <pubDate>2026-01-27T00:40:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599581687357784114" data-draft-id="7599565587153059866" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="slidev-addon-infographic 年终总结程序员必备的PPT精美图表"/> <meta itemprop="keywords" content="前端,程序员,Vue.js"/> <meta itemprop="datePublished" content="2026-01-27T00:40:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="fxss"/> <meta itemprop="url" content="https://juejin.cn/user/3702810892856808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            slidev-addon-infographic 年终总结程序员必备的PPT精美图表
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3702810892856808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    fxss
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T00:40:33.000Z" title="Tue Jan 27 2026 00:40:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fslidev-addon-infographic" target="_blank" title="https://www.npmjs.com/package/slidev-addon-infographic" ref="nofollow noopener noreferrer">slidev-addon-infographic</a> 是为了在 <a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.sli.dev%2F" target="_blank" title="https://cn.sli.dev/" ref="nofollow noopener noreferrer">Slidev</a> 中快速添加 <a href="https://link.juejin.cn?target=https%3A%2F%2Finfographic.antv.vision%2F" target="_blank" title="https://infographic.antv.vision/" ref="nofollow noopener noreferrer">@antv/infographic</a> 图表而设计的插件。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.sli.dev%2F" target="_blank" title="https://cn.sli.dev/" ref="nofollow noopener noreferrer">Slidev</a> 是为开发者打造的演示文稿工具，它基于 <a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vuejs.org%2F" target="_blank" title="https://cn.vuejs.org/" ref="nofollow noopener noreferrer">Vue3</a> 并集成了 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.markdown.cn%2Fdocs%2Fintro%2F" target="_blank" title="https://www.markdown.cn/docs/intro/" ref="nofollow noopener noreferrer">Markdown</a> 语法，使得创建演示文稿变得简单快捷，并支持导出 PPTX, PNG, PDF 格式。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Finfographic.antv.vision%2F" target="_blank" title="https://infographic.antv.vision/" ref="nofollow noopener noreferrer">@antv/infographic</a> 是新一代声明式信息图可视化引擎，提供上百种图表类型，包括但不限于 图表型、对比型、层级型、列表型、四象限型、关系型、顺序型 等，补足程序员写PPT的短板。</p>
<h2 data-id="heading-0">创建 Slidev 项目</h2>
<pre><code class="hljs language-bash" lang="bash">npm init slidev@latest
</code></pre>
<pre><code class="hljs language-bash" lang="bash">pnpm create slidev
</code></pre>
<pre><code class="hljs language-bash" lang="bash">yarn create slidev
</code></pre>
<h2 data-id="heading-1">添加 slidev-addon-infographic 插件</h2>
<pre><code class="hljs language-bash" lang="bash">npm install slidev-addon-infographic
</code></pre>
<pre><code class="hljs language-bash" lang="bash">pnpm install slidev-addon-infographic
</code></pre>
<pre><code class="hljs language-bash" lang="bash">yarn add slidev-addon-infographic
</code></pre>
<p>将下面内容添加到项目 <code>package.json</code> 文件中：</p>
<pre><code class="hljs language-json" lang="json">...
  <span class="hljs-attr">"slidev"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"addons"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"slidev-addon-infographic"</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
...
</code></pre>
<p>接下来就可以在 Slidev 项目中使用 <code>@antv/infographic</code> 图表了。</p>
<pre><code class="hljs language-md" lang="md">---
addons:
<span class="hljs-section">  - slidev-addon-infographic
---</span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">InfographicBox</span> <span class="hljs-attr">:data</span>=<span class="hljs-string">"`infographic list-row-simple-horizontal-arrow
data
  items
    - label 步骤 1
      desc 开始
    - label 步骤 2
      desc 进行中
    - label 步骤 3
      desc 完成
`"</span>&gt;</span></span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">InfographicBox</span>&gt;</span></span>
</code></pre>





























<table><thead><tr><th>参数</th><th>描述</th><th>类型</th><th>默认值</th></tr></thead><tbody><tr><td><code>data</code></td><td>信息图数据</td><td>string</td><td>-</td></tr><tr><td><code>click</code></td><td>是否响应<a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.sli.dev%2Fguide%2Fanimations%23click-animation" target="_blank" title="https://cn.sli.dev/guide/animations#click-animation" ref="nofollow noopener noreferrer">Slidev点击动画</a>，如果设置为 <code>true</code>，需要在 <code>frontmatter</code> 中添加 <a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.sli.dev%2Fguide%2Fanimations%23total" target="_blank" title="https://cn.sli.dev/guide/animations#total" ref="nofollow noopener noreferrer"><code>clicks</code></a> 字段，值为点击次数。</td><td><code>boolean</code></td><td><code>false</code></td></tr><tr><td><code>isExportPdf</code></td><td>是否导出 PDF 格式。导出时会默认将 <code>click</code> 设置为 <code>false</code>。</td><td><code>boolean</code></td><td><code>false</code></td></tr></tbody></table>
<ol>
<li>如需导出 PDF 格式，请为 <code>InfographicBox</code> 组件增加 <code>isExportPdf</code> 属性，导出的时候会默认将 <code>click</code> 设置为 <code>false</code> 。</li>
<li><code>click</code> 主要用于演示效果，<code>click</code> 为 <code>true</code> 时，需要单独占一页，设置 <code>click</code> 为 <code>true</code> 后，并添加 <code>clicks</code> 点击次数之后的效果需要自行点击确认。</li>
</ol>
<p>我们可以在 <a href="https://link.juejin.cn?target=https%3A%2F%2Finfographic.antv.vision%2Feditor" target="_blank" title="https://infographic.antv.vision/editor" ref="nofollow noopener noreferrer">@antv/infographic 编辑器</a> 中设计出符合需求的图表，然后将其复制到 Slidev 项目中。</p>
<p>下面是我的公众号，欢迎关注。关注后有新的功能点会及时收到推送。</p>
<blockquote>
<p>实战为王！专注于汇总各种功能点，致力于打造一系列能够帮助工程师实现各种功能的想法思路的优质文章。</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bdeec99a0154e7aa73c1c6765f3dcf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZnhzcw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770079232&amp;x-signature=97dS2VZSuWIQ6aD4kgiTmSBLnH0%3D" alt="前端功能点" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[剑指offer-68、调整数组顺序使奇数位于偶数前⾯(⼆)]]></title>    <link>https://juejin.cn/post/7599565587153092634</link>    <guid>https://juejin.cn/post/7599565587153092634</guid>    <pubDate>2026-01-27T00:42:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599565587153092634" data-draft-id="7598459769238487074" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" 剑指offer-68、调整数组顺序使奇数位于偶数前⾯(⼆)"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-27T00:42:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             剑指offer-68、调整数组顺序使奇数位于偶数前⾯(⼆)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T00:42:41.000Z" title="Tue Jan 27 2026 00:42:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">题⽬描述</h2>
<p>输⼊⼀个⻓度为 n 整数数组，数组⾥⾯可能含有相同的元素，实现⼀个函数来调整该数组中数字的顺序，使得所有的奇数位于数组的前⾯部分，所有的偶数位于数组的后⾯部分，对奇数和奇数，偶数和偶数之间的相对位置不做要求，但是时间复杂度和空间复杂度必须如下要求。</p>
<p>数据范围：0 ≤ n ≤ 50000，数组中每个数的值 0 ≤ val ≤ 10000</p>
<p>要求：时间复杂度 O(n)，空间复杂度 O(1)</p>
<p>示例 1
输⼊：[1,2,3,4]
返回值：[1,3,2,4]
说明：[3,1,2,4]或者[3,1,4,2]也是正确答案</p>
<p>示例 2
输⼊：[1,3,5,6,7]
返回值：[1,3,5,7,6]
说明：[3,1,5,7,6]等也是正确答案</p>
<h2 data-id="heading-1">思路及解答</h2>
<h3 data-id="heading-2">两次遍历</h3>
<p>第一次遍历收集奇数，第二次遍历收集偶数</p>
<p>这种方法虽然简单易懂，但需要额外空间，不符合题目要求</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] reorderArray(<span class="hljs-type">int</span>[] nums) {
        <span class="hljs-keyword">if</span> (nums == <span class="hljs-literal">null</span> || nums.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">0</span>];
        }
        
        <span class="hljs-type">int</span>[] result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[nums.length];
        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-comment">// 第一次遍历：收集所有奇数</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) {
            <span class="hljs-keyword">if</span> (num % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) {
                result[index++] = num;
            }
        }
        
        <span class="hljs-comment">// 第二次遍历：收集所有偶数</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) {
            <span class="hljs-keyword">if</span> (num % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) {
                result[index++] = num;
            }
        }
        
        <span class="hljs-keyword">return</span> result;
    }
}
</code></pre>
<ul>
<li>时间复杂度：O(n)</li>
<li>空间复杂度：O(n)</li>
</ul>
<h3 data-id="heading-3">双指针交换（推荐）</h3>
<p>这道题需要奇数在⼀半，偶数在另外⼀半就可以，并没有要求他们之间的顺序，那么就可以⽤双指针，⼀个指针在左边，⼀个指针在右边，⽐如 1,3,5,6,7 :</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a377cbcbedcb45c4bacb197390f8e273~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770079361&amp;x-signature=0T7KzzUcW3RaH%2BoGm%2FZVsbfpfss%3D" alt="" loading="lazy"/></p>
<p>左指针往右遍历直到找到偶数，也就是 6 停下来，</p>
<p>右指针往左⾛，直到找到第⼀个奇数，也就是 7 停下来。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3797c48f718443b5852e1433026b7632~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770079361&amp;x-signature=%2BtVn%2B8k0EnxE4UKKVgZZ42T%2B5hk%3D" alt="" loading="lazy"/></p>
<p>两者交换:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a28224f4090e4a549757e50c7eb463da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770079361&amp;x-signature=DdE7jFU2t%2BmOrPV%2FS%2BA8dClCU1o%3D" alt="" loading="lazy"/></p>
<p>左指针继续往右边⾛，两个指针相遇，结束，这个时候其实偶数已经全部在右边了。</p>
<p>这个例⼦⾥⾯只经过⼀次交换，如果是多次交换，那么结束的条件同样也是两个指针相遇。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] reorderArray(<span class="hljs-type">int</span>[] nums) {
        <span class="hljs-keyword">if</span> (nums == <span class="hljs-literal">null</span> || nums.length &lt;= <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> nums;
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;                    <span class="hljs-comment">// 左指针，从数组开头开始</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> nums.length - <span class="hljs-number">1</span>;     <span class="hljs-comment">// 右指针，从数组末尾开始</span>
        
        <span class="hljs-keyword">while</span> (left &lt; right) {
            <span class="hljs-comment">// 左指针向右移动，直到找到偶数</span>
            <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; nums[left] % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) {
                left++;
            }
            
            <span class="hljs-comment">// 右指针向左移动，直到找到奇数</span>
            <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; nums[right] % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) {
                right--;
            }
            
            <span class="hljs-comment">// 如果左指针仍在右指针左边，交换奇偶数</span>
            <span class="hljs-keyword">if</span> (left &lt; right) {
                <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> nums[left];
                nums[left] = nums[right];
                nums[right] = temp;
                left++;
                right--;
            }
        }
        
        <span class="hljs-keyword">return</span> nums;
    }
}
</code></pre>
<ul>
<li><strong>时间复杂度</strong>：O(n)，每个元素最多被访问一次</li>
<li><strong>空间复杂度</strong>：O(1)，只使用了常数级别的额外空间</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[第7章、复合类型——数组、切片与映射（slice和map）]]></title>    <link>https://juejin.cn/post/7599538010725646363</link>    <guid>https://juejin.cn/post/7599538010725646363</guid>    <pubDate>2026-01-27T00:41:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599538010725646363" data-draft-id="7599581687357767730" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="第7章、复合类型——数组、切片与映射（slice和map）"/> <meta itemprop="keywords" content="后端,Go"/> <meta itemprop="datePublished" content="2026-01-27T00:41:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="怕浪猫"/> <meta itemprop="url" content="https://juejin.cn/user/2832784963939438"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            第7章、复合类型——数组、切片与映射（slice和map）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2832784963939438/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    怕浪猫
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T00:41:45.000Z" title="Tue Jan 27 2026 00:41:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读20分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>大家好～ 前面我们掌握了Go的基础类型和函数特性，今天进入Go编程的核心复合类型——数组、切片（slice）和映射（map）。这三种类型是Go中最常用的数据容器，支撑着绝大多数业务场景的数据存储与处理：数组是固定长度的基础序列，切片是动态扩容的“灵活数组”，map是键值对映射的无序集合。</p>
<p>本文会从“定义用法→底层原理→实战技巧→性能优化”四个维度，逐一拆解这三种复合类型。全程搭配可直接运行的代码示例，帮你搞懂每个知识点的本质，避开实际开发中的常见陷阱。无论你是刚入门的新手，还是需要夯实基础的开发者，这篇文章都能让你对Go的复合类型有透彻的理解。</p>
<h2 data-id="heading-0">1. 数组：固定长度的序列结构</h2>
<p>数组是Go中最基础的复合类型，本质是“固定长度、相同类型元素的连续序列”。其核心特点是<strong>长度固定</strong>——一旦定义，长度就无法修改。正因为长度固定，数组在实际开发中的直接使用场景不算多，但它是切片的底层基础，必须先掌握。</p>
<h3 data-id="heading-1">1.1 数组的定义与初始化</h3>
<p>数组的定义语法：<code>[长度]元素类型</code>。初始化方式有多种，根据场景灵活选择：</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. 完整初始化：指定长度和所有元素</span>
    <span class="hljs-keyword">var</span> arr1 [<span class="hljs-number">3</span>]<span class="hljs-type">int</span> = [<span class="hljs-number">3</span>]<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>}
    fmt.Println(<span class="hljs-string">"arr1:"</span>, arr1) <span class="hljs-comment">// 输出：arr1: [1 2 3]</span>

    <span class="hljs-comment">// 2. 省略长度（由初始化元素个数推导）</span>
    <span class="hljs-keyword">var</span> arr2 [<span class="hljs-number">3</span>]<span class="hljs-type">int</span> = [...]<span class="hljs-type">int</span>{<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>} <span class="hljs-comment">// ... 表示自动推导长度</span>
    fmt.Println(<span class="hljs-string">"arr2:"</span>, arr2) <span class="hljs-comment">// 输出：arr2: [4 5 6]</span>
    fmt.Printf(<span class="hljs-string">"arr2长度：%d\n"</span>, <span class="hljs-built_in">len</span>(arr2)) <span class="hljs-comment">// 输出：arr2长度：3</span>

    <span class="hljs-comment">// 3. 指定索引初始化（未指定的索引为零值）</span>
    <span class="hljs-keyword">var</span> arr3 [<span class="hljs-number">5</span>]<span class="hljs-type">string</span> = [<span class="hljs-number">5</span>]<span class="hljs-type">string</span>{<span class="hljs-number">0</span>: <span class="hljs-string">"a"</span>, <span class="hljs-number">2</span>: <span class="hljs-string">"c"</span>, <span class="hljs-number">4</span>: <span class="hljs-string">"e"</span>}
    fmt.Println(<span class="hljs-string">"arr3:"</span>, arr3) <span class="hljs-comment">// 输出：arr3: [a  ｃ  ｅ]（索引1、3为零值""）</span>

    <span class="hljs-comment">// 4. 简短声明（仅在函数内可用）</span>
    arr4 := [<span class="hljs-number">4</span>]<span class="hljs-type">float64</span>{<span class="hljs-number">1.1</span>, <span class="hljs-number">2.2</span>, <span class="hljs-number">3.3</span>, <span class="hljs-number">4.4</span>}
    fmt.Println(<span class="hljs-string">"arr4:"</span>, arr4) <span class="hljs-comment">// 输出：arr4: [1.1 2.2 3.3 4.4]</span>
}

</code></pre>
<h3 data-id="heading-2">1.2 数组的核心特性</h3>
<ul>
<li>
<p><strong>长度固定</strong>：长度是数组类型的一部分（如<code>[3]int</code>和<code>[5]int</code>是不同的类型），无法动态扩容或缩容；</p>
</li>
<li>
<p><strong>值类型</strong>：数组是值类型，赋值或传递参数时，会拷贝整个数组（而非指针），效率较低；</p>
</li>
<li>
<p><strong>连续内存</strong>：数组的元素在内存中是连续存储的，索引访问效率极高（O(1)时间复杂度）；</p>
</li>
<li>
<p><strong>支持索引访问</strong>：通过<code>arr[index]</code>访问元素，索引从0开始，超出范围会触发运行时错误（数组越界）。</p>
</li>
</ul>
<h3 data-id="heading-3">1.3 数组的实际应用场景</h3>
<p>由于长度固定和值拷贝的特性，数组直接使用场景较少，主要用于：</p>
<ul>
<li>
<p>存储固定长度的常量序列（如一周的7天、一年的12个月）；</p>
</li>
<li>
<p>作为切片的底层存储（切片本质是数组的“视图”）；</p>
</li>
<li>
<p>需要保证数据长度不变的场景（如固定大小的配置项）。</p>
</li>
</ul>
<h3 data-id="heading-4">1.4 最佳实践</h3>
<ul>
<li>
<p>传递大数组时，优先使用指针：避免拷贝整个数组，提升性能（如<code>func modifyArr(arr *[1000]int)</code>）；</p>
</li>
<li>
<p>不确定长度时，直接用切片：不要为了“预估长度”定义数组，后续无法扩容会限制使用；</p>
</li>
<li>
<p>利用数组的类型安全性：通过固定长度约束数据（如<code>[16]byte</code>表示16字节的UUID），避免数据长度错误。</p>
</li>
</ul>
<h2 data-id="heading-5">2. 切片：动态数组的底层实现</h2>
<p>切片（slice）是Go中最常用的复合类型，本质是“对数组的引用（视图）”，支持动态扩容，解决了数组长度固定的痛点。切片本身不是数组，它只是一个“描述符”，指向底层的数组。</p>
<h3 data-id="heading-6">2.1 切片的定义与初始化</h3>
<p>切片的定义语法：<code>[]元素类型</code>（无长度）。初始化方式比数组更灵活：</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. 空切片（nil切片）：未指向任何底层数组</span>
    <span class="hljs-keyword">var</span> s1 []<span class="hljs-type">int</span>
    fmt.Println(<span class="hljs-string">"s1:"</span>, s1)          <span class="hljs-comment">// 输出：s1: []</span>
    fmt.Printf(<span class="hljs-string">"s1长度：%d，容量：%d\n"</span>, <span class="hljs-built_in">len</span>(s1), <span class="hljs-built_in">cap</span>(s1)) <span class="hljs-comment">// 输出：s1长度：0，容量：0</span>
    fmt.Printf(<span class="hljs-string">"s1是否为nil：%t\n"</span>, s1 == <span class="hljs-literal">nil</span>) <span class="hljs-comment">// 输出：s1是否为nil：true</span>

    <span class="hljs-comment">// 2. 用make初始化（最常用）：make([]类型, 长度, 容量)</span>
    s2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>) <span class="hljs-comment">// 长度3，容量5：底层数组长度5，当前使用前3个元素</span>
    fmt.Println(<span class="hljs-string">"s2:"</span>, s2)          <span class="hljs-comment">// 输出：s2: [0 0 0]（零值初始化）</span>
    fmt.Printf(<span class="hljs-string">"s2长度：%d，容量：%d\n"</span>, <span class="hljs-built_in">len</span>(s2), <span class="hljs-built_in">cap</span>(s2)) <span class="hljs-comment">// 输出：s2长度：3，容量：5</span>

    <span class="hljs-comment">// 3. 从数组/切片截取（核心用法）：s[start:end]（左闭右开，不包含end）</span>
    arr := [<span class="hljs-number">5</span>]<span class="hljs-type">int</span>{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>}
    s3 := arr[<span class="hljs-number">1</span>:<span class="hljs-number">3</span>] <span class="hljs-comment">// 从arr索引1到3（不包含3），截取元素[2,3]</span>
    fmt.Println(<span class="hljs-string">"s3:"</span>, s3)          <span class="hljs-comment">// 输出：s3: [2 3]</span>
    fmt.Printf(<span class="hljs-string">"s3长度：%d，容量：%d\n"</span>, <span class="hljs-built_in">len</span>(s3), <span class="hljs-built_in">cap</span>(s3)) <span class="hljs-comment">// 输出：s3长度：2，容量：4（从start到原数组末尾）</span>

    <span class="hljs-comment">// 4. 直接初始化（类似数组，省略长度）</span>
    s4 := []<span class="hljs-type">string</span>{<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>}
    fmt.Println(<span class="hljs-string">"s4:"</span>, s4)          <span class="hljs-comment">// 输出：s4: [a b c]</span>
    fmt.Printf(<span class="hljs-string">"s4长度：%d，容量：%d\n"</span>, <span class="hljs-built_in">len</span>(s4), <span class="hljs-built_in">cap</span>(s4)) <span class="hljs-comment">// 输出：s4长度：3，容量：3</span>
}

</code></pre>
<h3 data-id="heading-7">2.2 核心概念：长度（len）与容量（cap）</h3>
<p>切片有两个关键属性：长度（len）和容量（cap），含义完全不同：</p>
<ul>
<li>
<p><strong>长度（len）</strong>：切片当前包含的元素个数（通过<code>len(s)</code>获取）；</p>
</li>
<li>
<p><strong>容量（cap）</strong>：切片指向的底层数组中，从切片起始索引到数组末尾的元素个数（通过<code>cap(s)</code>获取）；</p>
</li>
<li>
<p>关系：<code>0 ≤ len(s) ≤ cap(s)</code>，当len(s) == cap(s)时，切片已满，再添加元素会触发扩容。</p>
</li>
</ul>
<p>示意图（帮助理解）：</p>
<pre><code class="hljs language-Plain" lang="Plain">
底层数组：[1, 2, 3, 4, 5]（长度5）
切片s3 := arr[1:3]：
- 起始索引：1
- 长度：3-1=2（元素[2,3]）
- 容量：5-1=4（从索引1到数组末尾，共4个元素：2,3,4,5）

</code></pre>
<h3 data-id="heading-8">2.3 底层实现原理</h3>
<p>切片的底层是一个结构体（源码定义在<code>runtime/slice.go</code>中），包含三个字段：</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">type</span> slice <span class="hljs-keyword">struct</span> {
    array unsafe.Pointer <span class="hljs-comment">// 指向底层数组的指针</span>
    <span class="hljs-built_in">len</span>   <span class="hljs-type">int</span>            <span class="hljs-comment">// 切片长度</span>
    <span class="hljs-built_in">cap</span>   <span class="hljs-type">int</span>            <span class="hljs-comment">// 切片容量</span>
}

</code></pre>
<p>关键结论：</p>
<ul>
<li>
<p>切片本身是值类型（结构体拷贝），但它指向的底层数组是引用类型；</p>
</li>
<li>
<p>多个切片可以指向同一个底层数组（通过截取创建），修改一个切片的元素会影响其他切片；</p>
</li>
<li>
<p>切片的赋值、传递参数时，拷贝的是这个结构体（3个字段，占用16字节：64位系统下，指针8字节+int8字节+int8字节），效率极高。</p>
</li>
</ul>
<p>示例：多个切片共享底层数组</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    arr := [<span class="hljs-number">5</span>]<span class="hljs-type">int</span>{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>}
    s1 := arr[<span class="hljs-number">1</span>:<span class="hljs-number">3</span>]  <span class="hljs-comment">// [2,3]，cap=4</span>
    s2 := arr[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]  <span class="hljs-comment">// [3,4]，cap=3</span>

    <span class="hljs-comment">// 修改s1[1]（即底层数组索引2的元素3）</span>
    s1[<span class="hljs-number">1</span>] = <span class="hljs-number">300</span>
    fmt.Println(<span class="hljs-string">"s1:"</span>, s1) <span class="hljs-comment">// 输出：s1: [2 300]</span>
    fmt.Println(<span class="hljs-string">"s2:"</span>, s2) <span class="hljs-comment">// 输出：s2: [300 4]（s2也受影响）</span>
    fmt.Println(<span class="hljs-string">"arr:"</span>, arr) <span class="hljs-comment">// 输出：arr: [1 2 300 4 5]（底层数组被修改）</span>
}

</code></pre>
<h2 data-id="heading-9">3. 切片的扩容策略与性能分析</h2>
<p>当切片的长度等于容量（<code>len(s) == cap(s)</code>）时，再通过<code>append</code>添加元素，会触发扩容。扩容的核心逻辑是“创建一个更大的新底层数组，将原数组的元素拷贝到新数组，然后让切片指向新数组”。</p>
<h3 data-id="heading-10">3.1 扩容策略（Go 1.18+ 最新逻辑）</h3>
<p>Go的扩容策略经过多次优化，当前（1.18+）的核心逻辑如下（源码在<code>runtime/slice.go</code>的<code>growslice</code>函数中）：</p>
<ol>
<li>
<p>计算“期望容量”：<code>newcap = len(s) + 要添加的元素个数</code>；</p>
</li>
<li>
<p>如果原容量 &lt; 256，则新容量 = 原容量 × 2；</p>
</li>
<li>
<p>如果原容量 ≥ 256，则新容量 = 原容量 + 原容量/4（即增加25%）；</p>
</li>
<li>
<p>如果计算出的新容量 &lt; 期望容量，则新容量 = 期望容量（保证能容纳新元素）；</p>
</li>
<li>
<p>最后，新容量会被调整为“内存对齐”的大小（提高内存分配效率）。</p>
</li>
</ol>
<h3 data-id="heading-11">3.2 代码示例：验证扩容过程</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    s := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>) <span class="hljs-comment">// len=0, cap=1</span>
    fmt.Printf(<span class="hljs-string">"初始：len=%d, cap=%d\n"</span>, <span class="hljs-built_in">len</span>(s), <span class="hljs-built_in">cap</span>(s)) <span class="hljs-comment">// 初始：len=0, cap=1</span>

    s = <span class="hljs-built_in">append</span>(s, <span class="hljs-number">1</span>) <span class="hljs-comment">// len=1, cap=1（未扩容）</span>
    fmt.Printf(<span class="hljs-string">"添加1后：len=%d, cap=%d\n"</span>, <span class="hljs-built_in">len</span>(s), <span class="hljs-built_in">cap</span>(s)) <span class="hljs-comment">// 添加1后：len=1, cap=1</span>

    s = <span class="hljs-built_in">append</span>(s, <span class="hljs-number">2</span>) <span class="hljs-comment">// len=2, cap=2（原cap&lt;256，×2扩容）</span>
    fmt.Printf(<span class="hljs-string">"添加2后：len=%d, cap=%d\n"</span>, <span class="hljs-built_in">len</span>(s), <span class="hljs-built_in">cap</span>(s)) <span class="hljs-comment">// 添加2后：len=2, cap=2</span>

    s = <span class="hljs-built_in">append</span>(s, <span class="hljs-number">3</span>) <span class="hljs-comment">// len=3, cap=4（原cap&lt;256，×2扩容）</span>
    fmt.Printf(<span class="hljs-string">"添加3后：len=%d, cap=%d\n"</span>, <span class="hljs-built_in">len</span>(s), <span class="hljs-built_in">cap</span>(s)) <span class="hljs-comment">// 添加3后：len=3, cap=4</span>

    s = <span class="hljs-built_in">append</span>(s, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>) <span class="hljs-comment">// len=5, cap=8（原cap&lt;256，×2扩容，能容纳2个新元素）</span>
    fmt.Printf(<span class="hljs-string">"添加4、5后：len=%d, cap=%d\n"</span>, <span class="hljs-built_in">len</span>(s), <span class="hljs-built_in">cap</span>(s)) <span class="hljs-comment">// 添加4、5后：len=5, cap=8</span>
}

</code></pre>
<h3 data-id="heading-12">3.3 扩容对性能的影响</h3>
<p>扩容的核心开销来自两部分：<strong>新数组的内存分配</strong>和<strong>原数组元素的拷贝</strong>。频繁扩容会严重影响性能，因此在实际开发中，要尽量“预分配容量”，减少扩容次数。</p>
<p>性能对比示例（预分配vs不预分配）：</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"time"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 场景1：不预分配容量（频繁扩容）</span>
    start1 := time.Now()
    <span class="hljs-keyword">var</span> s1 []<span class="hljs-type">int</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++ {
        s1 = <span class="hljs-built_in">append</span>(s1, i)
    }
    fmt.Printf(<span class="hljs-string">"不预分配容量耗时：%v\n"</span>, time.Since(start1)) <span class="hljs-comment">// 约1.2ms（因环境而异）</span>

    <span class="hljs-comment">// 场景2：预分配容量（无扩容）</span>
    start2 := time.Now()
    s2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1000000</span>) <span class="hljs-comment">// 预分配100万容量</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++ {
        s2 = <span class="hljs-built_in">append</span>(s2, i)
    }
    fmt.Printf(<span class="hljs-string">"预分配容量耗时：%v\n"</span>, time.Since(start2)) <span class="hljs-comment">// 约0.6ms（因环境而异）</span>
}

</code></pre>
<p>结论：预分配容量能减少80%以上的耗时（具体比例因数据量而异），是提升切片操作性能的关键技巧。</p>
<h2 data-id="heading-13">4. 切片的共享内存与拷贝问题</h2>
<p>切片的“共享底层数组”特性，在带来灵活性的同时，也容易引发“数据污染”问题。此外，当需要修改切片又不影响原数组/切片时，就需要进行“切片拷贝”。</p>
<h3 data-id="heading-14">4.1 共享内存的坑：数据污染</h3>
<p>多个切片共享底层数组时，修改一个切片的元素会影响其他切片和原数组，这是最常见的坑：</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 原切片</span>
    s := []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>}
    <span class="hljs-comment">// 截取得到新切片</span>
    sSub := s[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] <span class="hljs-comment">// [3,4]</span>
    <span class="hljs-comment">// 修改新切片</span>
    sSub[<span class="hljs-number">0</span>] = <span class="hljs-number">300</span>
    <span class="hljs-comment">// 原切片也被修改</span>
    fmt.Println(<span class="hljs-string">"原切片s:"</span>, s) <span class="hljs-comment">// 输出：原切片s: [1 2 300 4 5]</span>
}

</code></pre>
<p>解决方案：如果需要修改切片又不影响原数据，必须创建切片的“独立副本”（即切片拷贝）。</p>
<h3 data-id="heading-15">4.2 切片拷贝：创建独立副本</h3>
<p>Go提供<code>copy(dst, src []T)</code>函数实现切片拷贝，核心特点：</p>
<ul>
<li>
<p>拷贝的元素个数 = min(len(dst), len(src))；</p>
</li>
<li>
<p>拷贝后，dst和src指向不同的底层数组（独立副本），修改互不影响；</p>
</li>
<li>
<p>dst需要提前分配足够的容量（否则只能拷贝部分元素）。</p>
</li>
</ul>
<p>代码示例：正确的切片拷贝</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    s := []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>}
    <span class="hljs-comment">// 方案1：创建与原切片长度相同的dst</span>
    sCopy1 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-built_in">len</span>(s))
    <span class="hljs-built_in">copy</span>(sCopy1, s) <span class="hljs-comment">// 拷贝所有元素</span>
    sCopy1[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span>
    fmt.Println(<span class="hljs-string">"s:"</span>, s)       <span class="hljs-comment">// 输出：s: [1 2 3 4 5]（原切片未变）</span>
    fmt.Println(<span class="hljs-string">"sCopy1:"</span>, sCopy1) <span class="hljs-comment">// 输出：sCopy1: [100 2 3 4 5]</span>

    <span class="hljs-comment">// 方案2：拷贝部分元素（截取后拷贝）</span>
    sSub := s[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] <span class="hljs-comment">// [3,4]</span>
    sCopy2 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-built_in">len</span>(sSub))
    <span class="hljs-built_in">copy</span>(sCopy2, sSub)
    sCopy2[<span class="hljs-number">0</span>] = <span class="hljs-number">300</span>
    fmt.Println(<span class="hljs-string">"sSub:"</span>, sSub)   <span class="hljs-comment">// 输出：sSub: [3 4]（原截取切片未变）</span>
    fmt.Println(<span class="hljs-string">"sCopy2:"</span>, sCopy2) <span class="hljs-comment">// 输出：sCopy2: [300 4]</span>

    <span class="hljs-comment">// 错误示例：dst容量不足</span>
    sCopy3 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">// len=2</span>
    <span class="hljs-built_in">copy</span>(sCopy3, s) <span class="hljs-comment">// 仅拷贝前2个元素</span>
    fmt.Println(<span class="hljs-string">"sCopy3:"</span>, sCopy3) <span class="hljs-comment">// 输出：sCopy3: [1 2]</span>
}

</code></pre>
<h3 data-id="heading-16">4.3 常见场景：切片作为函数返回值</h3>
<p>当函数返回切片时，要注意：如果返回的是“原切片的截取切片”，则会共享底层数组，可能导致外部修改影响内部数据。正确做法是返回“拷贝后的独立切片”：</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-comment">// 错误：返回截取切片，共享底层数组</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">badGetSubSlice</span><span class="hljs-params">(s []<span class="hljs-type">int</span>)</span></span> []<span class="hljs-type">int</span> {
    <span class="hljs-keyword">return</span> s[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]
}

<span class="hljs-comment">// 正确：返回拷贝后的独立切片</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">goodGetSubSlice</span><span class="hljs-params">(s []<span class="hljs-type">int</span>)</span></span> []<span class="hljs-type">int</span> {
    sub := s[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]
    <span class="hljs-comment">// 创建拷贝</span>
    subCopy := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-built_in">len</span>(sub))
    <span class="hljs-built_in">copy</span>(subCopy, sub)
    <span class="hljs-keyword">return</span> subCopy
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    s := []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>}
    <span class="hljs-comment">// 错误示例</span>
    badSub := badGetSubSlice(s)
    badSub[<span class="hljs-number">0</span>] = <span class="hljs-number">300</span>
    fmt.Println(<span class="hljs-string">"s（错误）:"</span>, s) <span class="hljs-comment">// 输出：s（错误）: [1 2 300 4 5]（被修改）</span>

    <span class="hljs-comment">// 正确示例</span>
    s2 := []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>}
    goodSub := goodGetSubSlice(s2)
    goodSub[<span class="hljs-number">0</span>] = <span class="hljs-number">300</span>
    fmt.Println(<span class="hljs-string">"s2（正确）:"</span>, s2) <span class="hljs-comment">// 输出：s2（正确）: [1 2 3 4 5]（未修改）</span>
}

</code></pre>
<h2 data-id="heading-17">5. map的定义与基本操作</h2>
<p>map是Go中的“键值对映射”复合类型，核心特点是“无序、键唯一”，支持快速的键查找（O(1)时间复杂度）。map的键必须是“可比较类型”（如int、string、bool、数组等），值可以是任意类型。</p>
<h3 data-id="heading-18">5.1 map的定义与初始化</h3>
<p>map的定义语法：<code>map[键类型]值类型</code>。初始化方式有两种：<code>make</code>初始化和直接初始化：</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. 空map（nil map）：未分配内存，不能直接添加元素</span>
    <span class="hljs-keyword">var</span> m1 <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>
    fmt.Println(<span class="hljs-string">"m1:"</span>, m1)          <span class="hljs-comment">// 输出：m1: map[]</span>
    fmt.Printf(<span class="hljs-string">"m1是否为nil：%t\n"</span>, m1 == <span class="hljs-literal">nil</span>) <span class="hljs-comment">// 输出：m1是否为nil：true</span>
    <span class="hljs-comment">// m1["a"] = 1 // 运行时错误：assignment to entry in nil map</span>

    <span class="hljs-comment">// 2. 用make初始化（最常用）：make(map[K]V, 容量)</span>
    m2 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>, <span class="hljs-number">10</span>) <span class="hljs-comment">// 容量10（可选，用于预分配）</span>
    m2[<span class="hljs-string">"a"</span>] = <span class="hljs-number">1</span>
    m2[<span class="hljs-string">"b"</span>] = <span class="hljs-number">2</span>
    fmt.Println(<span class="hljs-string">"m2:"</span>, m2)          <span class="hljs-comment">// 输出：m2: map[a:1 b:2]</span>
    fmt.Printf(<span class="hljs-string">"m2长度：%d\n"</span>, <span class="hljs-built_in">len</span>(m2)) <span class="hljs-comment">// 输出：m2长度：2</span>

    <span class="hljs-comment">// 3. 直接初始化（键值对列表）</span>
    m3 := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>{
        <span class="hljs-string">"name"</span>: <span class="hljs-string">"Alice"</span>,
        <span class="hljs-string">"age"</span>:  <span class="hljs-string">"25"</span>,
        <span class="hljs-string">"city"</span>: <span class="hljs-string">"Beijing"</span>,
    }
    fmt.Println(<span class="hljs-string">"m3:"</span>, m3) <span class="hljs-comment">// 输出：m3: map[age:25 city:Beijing name:Alice]</span>
}

</code></pre>
<h3 data-id="heading-19">5.2 map的基本操作：增删改查</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    m := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>)

    <span class="hljs-comment">// 1. 增：添加键值对</span>
    m[<span class="hljs-string">"apple"</span>] = <span class="hljs-number">5</span>
    m[<span class="hljs-string">"banana"</span>] = <span class="hljs-number">3</span>
    fmt.Println(<span class="hljs-string">"添加后："</span>, m) <span class="hljs-comment">// 输出：添加后： map[apple:5 banana:3]</span>

    <span class="hljs-comment">// 2. 改：修改已有键的值</span>
    m[<span class="hljs-string">"apple"</span>] = <span class="hljs-number">10</span>
    fmt.Println(<span class="hljs-string">"修改后："</span>, m) <span class="hljs-comment">// 输出：修改后： map[apple:10 banana:3]</span>

    <span class="hljs-comment">// 3. 查：获取键的值（两个返回值：值、是否存在）</span>
    val, ok := m[<span class="hljs-string">"apple"</span>]
    <span class="hljs-keyword">if</span> ok {
        fmt.Println(<span class="hljs-string">"apple的值："</span>, val) <span class="hljs-comment">// 输出：apple的值： 10</span>
    } <span class="hljs-keyword">else</span> {
        fmt.Println(<span class="hljs-string">"apple不存在"</span>)
    }

    <span class="hljs-comment">// 查找不存在的键：返回值类型的零值</span>
    val2, ok2 := m[<span class="hljs-string">"orange"</span>]
    fmt.Println(<span class="hljs-string">"orange的值："</span>, val2, <span class="hljs-string">"，是否存在："</span>, ok2) <span class="hljs-comment">// 输出：orange的值： 0 ，是否存在： false</span>

    <span class="hljs-comment">// 4. 删：删除键值对（用delete函数，删除不存在的键不会报错）</span>
    <span class="hljs-built_in">delete</span>(m, <span class="hljs-string">"banana"</span>)
    fmt.Println(<span class="hljs-string">"删除banana后："</span>, m) <span class="hljs-comment">// 输出：删除banana后： map[apple:10]</span>
    <span class="hljs-built_in">delete</span>(m, <span class="hljs-string">"orange"</span>) <span class="hljs-comment">// 无报错</span>
}

</code></pre>
<p>关键注意点：</p>
<ul>
<li>
<p>查找不存在的键时，不会报错，返回值类型的零值（如int返回0，string返回""）；</p>
</li>
<li>
<p>必须通过<code>ok</code>返回值判断键是否存在（避免零值导致的逻辑错误）；</p>
</li>
<li>
<p>delete函数删除不存在的键时，不会触发任何错误。</p>
</li>
</ul>
<h2 data-id="heading-20">6. map的并发安全与sync.Map</h2>
<p>Go的原生map是<strong>并发不安全</strong>的：当多个goroutine同时对map进行“写操作”（增删改）时，会触发运行时错误（<code>fatal error: concurrent map writes</code>）。</p>
<h3 data-id="heading-21">6.1 并发不安全的示例</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"time"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    m := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-type">int</span>)

    <span class="hljs-comment">// 启动10个goroutine同时写map</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ {
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(idx <span class="hljs-type">int</span>)</span></span> {
            m[idx] = idx * <span class="hljs-number">10</span> <span class="hljs-comment">// 并发写</span>
        }(i)
    }

    <span class="hljs-comment">// 等待goroutine执行完成</span>
    time.Sleep(<span class="hljs-number">1</span> * time.Second)
    fmt.Println(<span class="hljs-string">"map内容："</span>, m)
}
</code></pre>
<p>运行结果：大概率会触发<code>concurrent map writes</code>错误。</p>
<h3 data-id="heading-22">6.2 并发安全的解决方案</h3>
<p>实现map的并发安全，有两种常用方案：</p>
<h4 data-id="heading-23">6.2.1 方案1：使用互斥锁（sync.Mutex/sync.RWMutex）</h4>
<p>通过锁来保证同一时间只有一个goroutine能修改map，适合“读多写少”或“读写均衡”的场景：</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"sync"</span>
    <span class="hljs-string">"time"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 封装：map + 锁</span>
    <span class="hljs-keyword">type</span> SafeMap <span class="hljs-keyword">struct</span> {
        m sync.RWMutex <span class="hljs-comment">// 读写锁：读锁不互斥，写锁互斥</span>
        data <span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-type">int</span>
    }

    sm := SafeMap{
        data: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-type">int</span>),
    }

    <span class="hljs-keyword">var</span> wg sync.WaitGroup
    <span class="hljs-comment">// 启动10个goroutine写map</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ {
        wg.Add(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(idx <span class="hljs-type">int</span>)</span></span> {
            <span class="hljs-keyword">defer</span> wg.Done()
            sm.m.Lock()         <span class="hljs-comment">// 写锁：排他锁</span>
            sm.data[idx] = idx * <span class="hljs-number">10</span>
            sm.m.Unlock()       <span class="hljs-comment">// 释放写锁</span>
        }(i)
    }

    <span class="hljs-comment">// 启动5个goroutine读map</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++ {
        wg.Add(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(idx <span class="hljs-type">int</span>)</span></span> {
            <span class="hljs-keyword">defer</span> wg.Done()
            sm.m.RLock()         <span class="hljs-comment">// 读锁：共享锁</span>
            val := sm.data[idx]
            sm.m.RUnlock()       <span class="hljs-comment">// 释放读锁</span>
            fmt.Printf(<span class="hljs-string">"key=%d, value=%d\n"</span>, idx, val)
        }(i)
    }

    wg.Wait() <span class="hljs-comment">// 等待所有goroutine完成</span>
    fmt.Println(<span class="hljs-string">"最终map内容："</span>, sm.data)
}

</code></pre>
<p>关键说明：</p>
<ul>
<li>
<p>sync.RWMutex（读写锁）比sync.Mutex（互斥锁）效率更高，适合读多写少场景；</p>
</li>
<li>
<p>读锁（RLock）：多个goroutine可以同时获取读锁，互不干扰；</p>
</li>
<li>
<p>写锁（Lock）：获取写锁后，其他goroutine无法获取读锁或写锁（排他性）。</p>
</li>
</ul>
<h4 data-id="heading-24">6.2.2 方案2：使用sync.Map（Go 1.9+ 标准库）</h4>
<p>sync.Map是Go标准库提供的“并发安全map”，专门优化了两种场景：</p>
<ul>
<li>
<p>键值对的“读多写少”；</p>
</li>
<li>
<p>键的生命周期短（频繁删除旧键，添加新键）。</p>
</li>
</ul>
<p>sync.Map的核心方法：</p>
<ul>
<li>
<p>Store(key, value)：存储键值对；</p>
</li>
<li>
<p>Load(key)：获取键的值（返回值、是否存在）；</p>
</li>
<li>
<p>Delete(key)：删除键值对；</p>
</li>
<li>
<p>Range(f func(key, value interface{}) bool)：遍历键值对。</p>
</li>
</ul>
<p>代码示例：sync.Map的使用</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"sync"</span>
    <span class="hljs-string">"time"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> sm sync.Map

    <span class="hljs-keyword">var</span> wg sync.WaitGroup
    <span class="hljs-comment">// 10个goroutine写</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ {
        wg.Add(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(idx <span class="hljs-type">int</span>)</span></span> {
            <span class="hljs-keyword">defer</span> wg.Done()
            sm.Store(idx, idx*<span class="hljs-number">10</span>) <span class="hljs-comment">// 存储键值对</span>
        }(i)
    }

    <span class="hljs-comment">// 5个goroutine读</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++ {
        wg.Add(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(idx <span class="hljs-type">int</span>)</span></span> {
            <span class="hljs-keyword">defer</span> wg.Done()
            val, ok := sm.Load(idx) <span class="hljs-comment">// 获取值</span>
            <span class="hljs-keyword">if</span> ok {
                fmt.Printf(<span class="hljs-string">"key=%d, value=%d\n"</span>, idx, val)
            }
        }(i)
    }

    wg.Wait()

    <span class="hljs-comment">// 遍历sync.Map</span>
    fmt.Println(<span class="hljs-string">"遍历sync.Map："</span>)
    sm.Range(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(key, value <span class="hljs-keyword">interface</span>{})</span></span> <span class="hljs-type">bool</span> {
        fmt.Printf(<span class="hljs-string">"key=%v, value=%v\n"</span>, key, value)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-comment">// 返回true继续遍历，返回false终止遍历</span>
    })
}

</code></pre>
<h3 data-id="heading-25">6.3 方案选择建议</h3>
<ul>
<li>
<p>并发场景简单（读写均衡）：用“map + sync.RWMutex”，灵活性高；</p>
</li>
<li>
<p>读多写少/键生命周期短：用sync.Map，效率更高，无需手动封装锁；</p>
</li>
<li>
<p>非并发场景：直接用原生map，效率最高。</p>
</li>
</ul>
<h2 data-id="heading-26">7. 遍历map与顺序不确定性</h2>
<p>Go的原生map是<strong>无序</strong>的：每次遍历map，键值对的顺序都可能不同。这是Go的设计特性（为了哈希表的性能优化），不能依赖遍历顺序。</p>
<h3 data-id="heading-27">7.1 无序遍历的示例</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    m := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>{
        <span class="hljs-string">"a"</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">"b"</span>: <span class="hljs-number">2</span>,
        <span class="hljs-string">"c"</span>: <span class="hljs-number">3</span>,
        <span class="hljs-string">"d"</span>: <span class="hljs-number">4</span>,
    }

    <span class="hljs-comment">// 多次遍历，顺序可能不同</span>
    fmt.Println(<span class="hljs-string">"第一次遍历："</span>)
    <span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> m {
        fmt.Printf(<span class="hljs-string">"%s: %d "</span>, k, v)
    }
    fmt.Println()

    fmt.Println(<span class="hljs-string">"第二次遍历："</span>)
    <span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> m {
        fmt.Printf(<span class="hljs-string">"%s: %d "</span>, k, v)
    }
    fmt.Println()
}

</code></pre>
<p>运行结果示例（两次顺序可能不同）：</p>
<pre><code class="hljs language-Plain" lang="Plain">
第一次遍历：
b: 2 d: 4 a: 1 c: 3
第二次遍历：
a: 1 b: 2 c: 3 d: 4

</code></pre>
<h3 data-id="heading-28">7.2 实现有序遍历的方案</h3>
<p>如果需要“有序遍历map”，核心思路是：</p>
<ol>
<li>
<p>先将map的键提取到切片中；</p>
</li>
<li>
<p>对切片进行排序；</p>
</li>
<li>
<p>按排序后的切片顺序，遍历map的键，获取对应的值。</p>
</li>
</ol>
<p>代码示例：按键的字典序遍历map</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"sort"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    m := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>{
        <span class="hljs-string">"d"</span>: <span class="hljs-number">4</span>,
        <span class="hljs-string">"a"</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">"c"</span>: <span class="hljs-number">3</span>,
        <span class="hljs-string">"b"</span>: <span class="hljs-number">2</span>,
    }

    <span class="hljs-comment">// 1. 提取键到切片</span>
    keys := <span class="hljs-built_in">make</span>([]<span class="hljs-type">string</span>, <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(m))
    <span class="hljs-keyword">for</span> k := <span class="hljs-keyword">range</span> m {
        keys = <span class="hljs-built_in">append</span>(keys, k)
    }

    <span class="hljs-comment">// 2. 对切片排序（字典序）</span>
    sort.Strings(keys)

    <span class="hljs-comment">// 3. 按排序后的键遍历map</span>
    fmt.Println(<span class="hljs-string">"按字典序遍历："</span>)
    <span class="hljs-keyword">for</span> _, k := <span class="hljs-keyword">range</span> keys {
        fmt.Printf(<span class="hljs-string">"%s: %d "</span>, k, m[k])
    }
    fmt.Println()

    <span class="hljs-comment">// 按数值降序遍历（以值为排序依据）</span>
    <span class="hljs-comment">// 1. 定义切片存储键值对</span>
    <span class="hljs-keyword">type</span> kv <span class="hljs-keyword">struct</span> {
        Key   <span class="hljs-type">string</span>
        Value <span class="hljs-type">int</span>
    }
    kvSlice := <span class="hljs-built_in">make</span>([]kv, <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(m))
    <span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> m {
        kvSlice = <span class="hljs-built_in">append</span>(kvSlice, kv{k, v})
    }

    <span class="hljs-comment">// 2. 按值降序排序</span>
    sort.Slice(kvSlice, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(i, j <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">bool</span> {
        <span class="hljs-keyword">return</span> kvSlice[i].Value &gt; kvSlice[j].Value
    })

    <span class="hljs-comment">// 3. 遍历排序后的切片</span>
    fmt.Println(<span class="hljs-string">"按值降序遍历："</span>)
    <span class="hljs-keyword">for</span> _, item := <span class="hljs-keyword">range</span> kvSlice {
        fmt.Printf(<span class="hljs-string">"%s: %d "</span>, item.Key, item.Value)
    }
    fmt.Println()
}

</code></pre>
<p>运行结果：</p>
<pre><code class="hljs language-Plain" lang="Plain">
按字典序遍历：
a: 1 b: 2 c: 3 d: 4
按值降序遍历：
d: 4 c: 3 b: 2 a: 1

</code></pre>
<h2 data-id="heading-29">8. 复合类型的内存布局与性能优化</h2>
<p>理解复合类型的内存布局，是进行性能优化的基础。本节将拆解数组、切片、map的内存布局，并给出针对性的性能优化技巧。</p>
<h3 data-id="heading-30">8.1 内存布局拆解</h3>
<h4 data-id="heading-31">8.1.1 数组的内存布局</h4>
<p>数组的内存是<strong>连续的</strong>，元素按索引顺序依次存储。例如<code>[3]int{1,2,3}</code>的内存布局（64位系统，int占8字节）：</p>
<pre><code class="hljs language-Plain" lang="Plain">
地址：0x00  0x08  0x10
元素：1    2    3

</code></pre>
<p>优势：索引访问效率极高（直接通过地址偏移计算元素位置）；缓存命中率高（连续内存易被CPU缓存）。</p>
<h4 data-id="heading-32">8.1.2 切片的内存布局</h4>
<p>切片本身是一个3字段的结构体（指针+len+cap），存储在栈上；其指向的底层数组存储在堆上（如果切片较大，或被外部引用）。例如<code>s := []int{1,2,3}</code>的内存布局：</p>
<pre><code class="hljs language-Plain" lang="Plain">
栈上（切片结构体）：
array指针: 0x100（指向堆上的底层数组）
len: 3
cap: 3

堆上（底层数组）：
地址：0x100  0x108  0x110
元素：1    2    3

</code></pre>
<h4 data-id="heading-33">8.1.3 map的内存布局</h4>
<p>map的底层是“哈希表”，内存布局较复杂，核心结构包括：</p>
<ul>
<li>
<p>hmap（哈希表结构体）：存储map的元信息（桶数组指针、大小、哈希种子等）；</p>
</li>
<li>
<p>bmap（桶）：存储实际的键值对（每个桶可存储8个键值对）；</p>
</li>
<li>
<p>溢出桶：当桶满时，使用溢出桶存储额外的键值对。</p>
</li>
</ul>
<p>核心结论：map的键查找是“哈希计算→桶定位→键比较”的过程，效率高，但无序；频繁的增删改可能导致哈希表扩容，影响性能。</p>
<h3 data-id="heading-34">8.2 通用性能优化技巧</h3>
<h4 data-id="heading-35">8.2.1 切片优化技巧</h4>
<ul>
<li>
<p><strong>预分配容量</strong>：创建切片时，已知元素个数的情况下，用<code>make([]T, 0, cap)</code>预分配容量，减少扩容次数；</p>
</li>
<li>
<p><strong>避免切片泄露</strong>：截取大数组/大切片得到的小切片，会引用整个大底层数组，导致大数组无法被GC回收（内存泄露）。解决方案：拷贝小切片，释放对大数组的引用；</p>
</li>
<li>
<p><strong>使用切片表达式简化操作</strong>：如<code>s = s[:len(s)-1]</code>删除最后一个元素（无需拷贝，效率高）。</p>
</li>
</ul>
<h4 data-id="heading-36">8.2.2 map优化技巧</h4>
<ul>
<li>
<p><strong>预分配容量</strong>：创建map时，已知键值对个数的情况下，预分配容量（<code>make(map[K]V, cap)</code>），减少哈希表扩容次数；</p>
</li>
<li>
<p><strong>选择合适的键类型</strong>：优先使用int、string等“高效哈希类型”，避免使用数组、结构体等复杂类型（哈希计算耗时）；</p>
</li>
<li>
<p><strong>避免频繁的增删改</strong>：频繁的增删改会导致哈希表的“负载因子”波动，触发扩容或缩容，影响性能；</p>
</li>
<li>
<p><strong>批量操作优于循环单操作</strong>：如批量添加键值对时，一次性添加比循环单个添加效率高（减少哈希表的状态检查）。</p>
</li>
</ul>
<h4 data-id="heading-37">8.2.3 数组优化技巧</h4>
<ul>
<li>
<p><strong>传递大数组用指针</strong>：避免拷贝整个数组，提升性能；</p>
</li>
<li>
<p><strong>小数组优先于切片</strong>：对于固定长度的小数组（如<code>[4]byte</code>），用数组比切片更高效（无需结构体开销和堆内存分配）。</p>
</li>
</ul>
<h2 data-id="heading-38">总结</h2>
<p>本章我们全面讲解了Go的三种核心复合类型——数组、切片和map，核心要点总结如下：</p>
<ol>
<li>
<p>数组：固定长度的连续序列，值类型，是切片的底层基础；适合存储固定长度的常量数据；</p>
</li>
<li>
<p>切片：动态数组的视图，底层是“指针+len+cap”的结构体；支持动态扩容，是Go中最常用的序列类型；注意共享内存的数据污染问题，必要时用copy创建独立副本；</p>
</li>
<li>
<p>map：无序的键值对映射，支持快速查找；键必须是可比较类型；原生并发不安全，需用锁或sync.Map保证并发安全；遍历顺序不确定，有序遍历需手动排序键；</p>
</li>
<li>
<p>性能优化核心：预分配容量（切片、map）、避免不必要的拷贝（数组指针、切片拷贝）、选择合适的类型（map键类型）、避免内存泄露（切片截取后的拷贝）。</p>
</li>
</ol>
<p>这三种复合类型是Go编程的基础，几乎所有业务代码都会用到。建议多动手实践：用切片处理动态序列、用map存储键值对数据、用数组保证固定长度约束，同时结合性能优化技巧，写出高效、安全的代码。如果有任何问题，欢迎在评论区交流～</p>
<p>参考链接：</p>
<ul>
<li>
<p>Go官方文档 - 数组：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.dev%2Fref%2Fspec%23Array_types" target="_blank" title="https://go.dev/ref/spec#Array_types" ref="nofollow noopener noreferrer">go.dev/ref/spec#Ar…</a></p>
</li>
<li>
<p>Go官方文档 - 切片：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.dev%2Fref%2Fspec%23Slice_types" target="_blank" title="https://go.dev/ref/spec#Slice_types" ref="nofollow noopener noreferrer">go.dev/ref/spec#Sl…</a></p>
</li>
<li>
<p>Go官方文档 - map：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.dev%2Fref%2Fspec%23Map_types" target="_blank" title="https://go.dev/ref/spec#Map_types" ref="nofollow noopener noreferrer">go.dev/ref/spec#Ma…</a></p>
</li>
<li>
<p>Go标准库 - sync.Map：<a href="https://link.juejin.cn?target=https%3A%2F%2Fpkg.go.dev%2Fsync%23Map" target="_blank" title="https://pkg.go.dev/sync#Map" ref="nofollow noopener noreferrer">pkg.go.dev/sync#Map</a></p>
</li>
<li>
<p>Go官方博客 - 切片内部机制：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.dev%2Fblog%2Fslices-intro" target="_blank" title="https://go.dev/blog/slices-intro" ref="nofollow noopener noreferrer">go.dev/blog/slices…</a></p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Bitmap优化套路深 多级缓存定乾坤]]></title>    <link>https://juejin.cn/post/7599600549763629091</link>    <guid>https://juejin.cn/post/7599600549763629091</guid>    <pubDate>2026-01-27T00:51:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599600549763629091" data-draft-id="7598807837868130330" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Bitmap优化套路深 多级缓存定乾坤"/> <meta itemprop="keywords" content="Kotlin,Android"/> <meta itemprop="datePublished" content="2026-01-27T00:51:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Bitmap优化套路深 多级缓存定乾坤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T00:51:34.000Z" title="Tue Jan 27 2026 00:51:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读14分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"•";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="monokai">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#272822;color:#ddd}.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-strong,.hljs-tag{color:#f92672}.hljs-code{color:#66d9ef}.hljs-class .hljs-title{color:#fff}.hljs-attribute,.hljs-link,.hljs-regexp,.hljs-symbol{color:#bf79db}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-emphasis,.hljs-section,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#a6e22e}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#75715e}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-section,.hljs-selector-id,.hljs-selector-tag,.hljs-title,.hljs-type{font-weight:700}</style><p><em>本系列为 Android 技术职场题材虚构小说，所有登场人物、公司名称、组织架构及相关情节均为创作所需虚构而来，若有雷同，纯属偶然。书中涉及的技术知识经专业梳理，仅供参考。</em></p>
<h2 data-id="heading-0">十一）Bitmap优化套路深 多级缓存定乾坤</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/816c85e6c5d340c0823689c8bafe9aba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770079896&amp;x-signature=RP4NmFoPWOXTT3FJYPlfqwJrFGw%3D" alt="0.png" loading="lazy"/></p>
<p>新的一周，林卓早早来到公司，心情格外舒畅。阳光透过玻璃幕墙洒在大厅地砖上，折射出暖融融的光斑，难得避开早高峰拥堵的他，脚步都带着轻快。</p>
<p>他径直走向公司楼下的咖啡店，点了一杯热美式，指尖握着温热的杯壁，慢悠悠走回工位。此时办公室里还没几个人，键盘敲击声稀疏，只有中央空调的轻微声响，这份难得的闲暇在紧张的项目周期里显得格外珍贵。</p>
<p>林卓拉开椅子坐下，抿了一口咖啡，正准备梳理本周的工作安排，身后就传来了熟悉的脚步声。</p>
<p>“来得挺早啊，小林。”老杨背着背包走过来，随手把背包放在邻座空位上，语气透着几分轻松。他瞥了眼林卓桌上的热美式，笑着拉过一把椅子坐下，“还挺会享受，这会儿办公室都没几个人，倒让你占了份清净。”</p>
<p>林卓笑着点头回应：“嘿嘿，这周还没有什么新的安排嘛！这会儿能偷个闲，对了老杨，你们的大模型工作主要是干啥呀？”</p>
<p>老杨笑着摆了摆手，语气随意又带着点无奈：“还能啥，瞎忙活呗。车机端为了减少云端压力，想跑一个离线大模型，可车机算力有限，得把模型压缩到合适大小，还得保住识别准确率，磨人的很。”</p>
<p>他瞟了一眼林卓的工位，目光落在林卓的电脑屏幕上，话锋一转，“趁这会儿不忙，我倒想问问你个技术问题——如果给你一张超大分辨率的图片，比如 4000×3000 的，要在车机界面上显示，还得保证不卡顿、不崩内存，你怎么处理？”</p>
<p>林卓握着咖啡杯的手一顿，瞬间收起了放松的心思。他沉吟片刻，缓缓说道：“超大图直接加载肯定不行，会占用大量内存，大概率触发内存溢出错误。应该先对图片进行压缩处理，再考虑显示和优化。”</p>
<p>“没错，核心就是 <code>Bitmap</code> 的高效处理。”老杨点点头，语气里带着几分引导，“具体怎么压缩？怎么保证压缩后显示清晰，还不影响性能？你好好琢磨下。”说完便起身回了工位，椅子拖动的轻响过后，只留下林卓一人坐在原地。</p>
<p>林卓脸上还带着几分茫然，握着咖啡杯愣了两秒，心里暗自纳闷：好端端的闲聊，怎么突然问这个问题？</p>
<p>疑惑归疑惑，他没再多想，指尖无意识地敲击着桌面，脑子里已经开始飞速梳理超大图显示的核心逻辑。</p>
<p>正琢磨着，办公区入口传来脚步声，张磊拿着平板快步走来，目光扫过工位喊道：“林卓，到会议室开个短会，同步下新闻模块的新需求。”林卓连忙收起思绪，锁屏电脑，跟着张磊走向会议室。</p>
<p>会议室里只有三四个人，张磊开门见山，直接点开需求文档：“今天同步个紧急需求，给新闻模块加个《早间要闻》功能，核心是展示前一日的焦点新闻，内容由 AI 总结生成，数量不固定，多则十到二十条，少则五六条。”</p>
<p>他顿了顿，补充道：“因为是 AI 生成内容，特殊情况会比较多——比如图文排版错乱、图片尺寸不规则、文字长度差异大，都要做好兼容。功能优先级很高，周五正式提测，你们各司其职，林卓，你负责新闻的图文显示与适配开发，测试那边同步跟进。”</p>
<p>会议只开了十分钟就结束，林卓走出会议室，心里嘀咕着早上老杨问的问题，隐约觉得或许会用到，但也没深想，转头就全身心投入到新需求的梳理中。</p>
<p>林卓顺着需求细节仔细梳理，很快摸清了核心要点：AI 生成的内容没有固定模板，新闻数量、图文排版、图片尺寸全是变量，界面绘制的关键是兼容性和灵活性，必须先把 UI 显示的基础打牢。</p>
<p>他打开需求文档和 UI，在办公区的白板上，快速勾勒《早间要闻》的界面框架，明确了两大核心模块——新闻摘要列表和专题大图封面区，随后便聚焦 UI 绘制的解决方案。</p>
<p>他指尖轻点白板，顺便用记号笔勾勒几处重点，逐一拆解 UI 难题：新闻摘要卡片要统一样式，还得适配长短不一的 AI 生成文字，背景样式必须灵活；列表分隔线要简洁，还不能因新闻数量多变增加布局负担；专题区的封面大图，感觉没什么难度，直接加载显示就行，顶多有几个文字，这个好办。</p>
<p>思索片刻，他心里有了答案——用 <code>Drawable</code> 家族的不同子类针对性解决，刚好能覆盖这些 UI 适配场景。</p>
<p>时间来到下午，林卓全身心投入 UI 的开发。</p>
<p>他清楚 <code>Drawable</code> 作为可绘制内容的抽象基类，每个子类都有专属适配场景，正好能应对 AI 内容的不确定性，于是有条不紊地为三个核心 UI 场景敲定技术方案。</p>
<p>第一个是新闻摘要卡片，卡片大小不固定（要适配不同长度的 AI 新闻内容），背景还需要带阴影效果，用 <code>.9</code> 最合适。这种特殊格式能手动标记可拉伸区域，同时保留阴影细节，无论卡片被拉伸到多大，阴影边缘都不会模糊变形，完美适配 AI 内容的不确定性。林卓用工具处理好带阴影的 <code>.9</code> 图，直接导入项目就能复用，省去了反复调整布局的麻烦。</p>
<p>第二个是新闻附带的文字标签，标签没有阴影，但要做圆角处理，而且 AI 生成的新闻分类不同，标签颜色也得跟着变，总跟 UI 对接调色太耗时。林卓选用 <code>ShapeDrawable</code> 解决，通过 XML 直接定义圆角大小，颜色则预留代码接口动态设置，无需修改资源文件，既能满足样式要求，又大幅提升了开发效率，还能灵活应对标签颜色的多变需求。</p>
<p>至于专题区的封面大图，林卓反倒觉得没什么复杂的——直接把 AI 返回的图片下载到本地，再加载显示就行，哈哈。</p>
<p>不知不觉两天时间过去，林卓全身心扑在 UI 开发上，终于把 <code>Drawable</code> 适配逻辑全部落地，还完成了整体布局的整合调试，昨儿提测这部分的内容。</p>
<p>此时的他，正等着测试——小安的测试报告，看看有没有新的问题。</p>
<p>没过多久，小安抱着测试机走了过来，脸上带着几分纠结：“林卓，UI 走查和核心功能都过了，样式、适配全符合设计稿。”</p>
<p>她顿了顿：“但有两个明显问题，我已经提交 Bug 和日志了，你赶紧看看。问题集中在专题封面图，一是加载特别慢，进入专题区要等一两秒才显示；二是多打开几个车机软件再切回来，滚动几下，APP 直接崩溃了，日志里好像提示内存溢出。”</p>
<p>林卓心里一紧，打开 Bug 管理平台查看日志。他快速扫完日志内容，眉头瞬间皱了起来——崩溃原因果然是内存溢出，加载慢也和图片资源有关。他亲自复现了一遍问题，果然多打开几个新闻专题封面，直接闪退，封面图加载时也明显有卡顿感。</p>
<p>“不愧是你，小安，日志我先分析下。”林卓支走小安，心里泛起疑惑：怎么会内存溢出？</p>
<p>他反复核对代码，又对照日志里的内存占用记录，心里猜测大概率是图片本身过大导致的。</p>
<p>为了验证猜想，他找到代码中加载图片的逻辑，提取出 AI 返回的图片 URL，逐一复制到浏览器查看。</p>
<p>这不看不要紧，一看吓了一跳——这些图片分辨率参差不齐，小的才 480p，大的竟然直接是 4K 分辨率，体积远超预期。</p>
<p>林卓对着屏幕低声暗骂一句：“服务端这帮人，也不做下图片处理，净给前端填坑！” 此刻他才彻底明白，问题根源就在这无节制的图片分辨率上。</p>
<p>林卓突然恍然大悟，仿佛一道闪电劈进脑海！周一早上老杨问的问题，原来坑在这里！</p>
<p>明确问题根源后，林卓立刻动起手来。他先翻出老杨之前分享过的《Android 核心知识点》文档，找到内存优化相关的章节——那是老杨整理多年项目经验的精华，里面刚好有超大图处理的相关思路。</p>
<p>接着又在技术社区搜了不少车机端图片加载的实战案例，结合自己对需求的理解，慢慢定制出一套针对性的解决思路。</p>
<p>首先是解决“只读尺寸不加载”的核心问题。林卓利用 <code>BitmapFactory.Options</code> 的 <code>inJustDecodeBounds</code> 属性，将其设为 true 后，解码图片时只会返回宽高信息，不会真正分配内存。这样就能在不占用资源的前提下，摸清 AI 生成图片的实际尺寸，避免盲目加载导致内存压力。</p>
<p>摸清尺寸后，下一步计算采样率。采样率直接决定图片缩放比例，比如采样率为 2 时，图片宽高各缩为原来的二分之一，内存占用可降至四分之一。</p>
<p>林卓参照标准算法编写逻辑，确保缩放后的图片尺寸不小于车机控件显示尺寸，既控制内存占用，又避免图片模糊，还开启了抖动优化提升显示质感。</p>
<p>他用一张 4K 的测试图模拟 AI 超大图场景，对应车机专题区 720P 的显示尺寸，优化后内存占用从近 20MB 降至 1.6MB 左右，内存占用有明显优化。</p>
<p>但林卓测试时发现，第一次进入页面仍有加载延迟，快速滑动列表时图片会闪烁，这里就有两个原因了：</p>
<ol>
<li>大图片下载慢</li>
<li>重新压缩图片，也需要一番时间</li>
</ol>
<p>要解决这个问题，必须搭建缓存策略。林卓采用“内存缓存 + 磁盘缓存”的组合方案。</p>
<p>内存缓存用 <code>LruCache</code> 实现，分配大概 10mb 作为容量，自动回收最少使用的图片对象，供封面图快速访问；磁盘缓存用 <code>DiskLruCache</code>，将解码后的图片存储在本地，设置 30MB 缓存上限，避免下次进入页面重复解码。</p>
<p>为了不阻塞主线程，同时更加稳定的加载图片，他用 <code>WorkManager</code> 创建后台任务，在子线程中处理图片解码和缓存逻辑，还封装了统一的加载方法：优先从内存缓存读取，内存无则查磁盘缓存，两者都无再启动后台任务解码，解码完成后同步存入两级缓存。同时他还添加了淡入动画，让图片从透明过渡到不透明，掩盖加载间隙，提升视觉体验。</p>
<p>缓存策略上线后，林卓喊来小安复测。这次页面加载迅速，快速滑动无闪烁，小安逐条核对后露出笑容：“丝滑！“</p>
<p>”不过还有个小问题，专题大图点击放大时动画生硬，感觉是跳过去的，而不是过渡过去的。这个倒不是你的问题，我直接提给产品了”</p>
<p>林卓闻言心里一紧，暗自腹诽：“我的小祖宗！这都要上线了，别再给我加需求了！”</p>
<p>嘴上却只能笑着应下：“行，你先提给产品，我看看能不能顺手优化了，尽量不耽误上线进度。”</p>
<p>虽说心里吐槽，但他也清楚动画体验会影响产品质感，转头就收起杂念，投入到动画知识点的补充学习中。</p>
<p>他找到 Android 动画相关的文档——这内容可真不少！</p>
<p>不过现在的他不可同日而语，历经好几次的产品需求实现和优化，现在的他早已驾轻就熟了。</p>
<p>很快他就梳理完了 <code>AnimatorSet</code> 的使用方法，重点琢磨缩放与平移动画的时序衔接、插值器参数调整。</p>
<p>加之之前 <code>Bitmap</code> 优化和 <code>Drawable</code> 适配的基础，动画知识点上手很快，短短一个下午就吃透了核心逻辑，还针对性调整了动画时长与过渡曲线，让大图放大效果更丝滑。</p>
<p>第二天一早，产品拿着优化建议找到他，明确提出要优化专题大图的放大过渡动画，强调“生硬跳转影响用户体验”，要求上线前搞定。</p>
<p>林卓心里虽有“临时加需求”的无奈，但也清楚体验优先级，立刻收起杂念投入开发。</p>
<p>嘿嘿，幸好昨儿学习的差不多了，把昨儿写的大部分示例代码，移植过来，针对 UI 优化一下就行了！</p>
<p>上午优化完成后，林卓第一时间同步给小安提测，仅用半天就完成了验收。</p>
<p>......</p>
<p>周五下午，《早间要闻》UI 相关需求全部正式提测，忙得脚不沾地的林卓长舒一口气，当即约了老杨和小安去吃小火锅，算是给这一周的奋战收尾。</p>
<p>火锅店堂里人声鼎沸，烟火气十足，三人找了个靠窗的小桌坐下，肥牛卷刚下锅翻滚，林卓就对着两人大倒苦水：“你们是不知道，这次最坑的就是服务端那帮人，返回的图片大小没个准头，小的才 480p，大的直接 4K，害得我额外花了两天优化 <code>Bitmap</code> 和缓存，差点就耽误进度要周末加班了。”</p>
<p>他说着端起饮料碰了碰老杨的杯子，语气满是庆幸：“还好老杨你周一提前问了我超大图的问题，不然我压根没往这方面想，周末指定得泡在公司了，谢了啊，我先干了！”</p>
<p>老杨夹着一片毛肚涮着，漫不经心地抬眼笑道：“嘻嘻，那图片本来就是我这边返回的。”</p>
<p>见林卓瞬间愣住，他才慢悠悠补充，“车机端这个离线大模型，前期数据都是直接从网上爬的，没做过滤和压缩，细节优化得等功能跑通了再搞，先把核心流程跑起来再说。”</p>
<p>林卓脸上的感激之情瞬间僵住，嘴里的饮料还没喝完，差点一口呛住，等稳住心神，随即气不打一处来，伸手拍了下老杨的胳膊：“合着坑我的人就是你啊！我说你怎么突然问那问题，原来早知道有这茬！”</p>
<p>小安在一旁笑得直不起腰，握着筷子的手都跟着发颤，刚夹起一片毛肚要往锅里放，又忍不住缩回手按住肚子，眼泪都快笑出来了。</p>
<p>林卓瞪了老杨一眼，干脆摆起架子：“老杨，那这顿，你请客！”</p>
<p>老杨乐呵呵地应下：“没问题，想吃啥随便点，我请客。”</p>
<p>酒足饭饱，老杨结完账，拍了拍林卓的肩膀随口提了句：“对了，你这次做的大图放大动画还行，后续可以研究研究 <code>MotionLayout</code>，更丝滑，还能和布局联动做动画。”</p>
<p>林卓一听，当即垮了脸，吐槽道：“什么意思？这刚忙完又给我埋坑是吧？”</p>
<p>老杨笑着拍拍肩，语气带着点过来人式的调侃：“不自己踩踩坑，怎么把知识点吃透、长记性？下次遇到类似问题，不就轻车熟路了？”</p>
<p>三人并肩走出火锅店，晚风带着凉意，却吹不散并肩作战后的轻松惬意。</p>
<p>林卓嘴上抱怨着老杨挖坑，心里却清楚，这一周的磕磕绊绊，早已让他把图片优化的知识点刻进了心里，这份成长，远比少踩一个坑更珍贵。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[为什么没人走后门当程序员？]]></title>    <link>https://juejin.cn/post/7599581204859715610</link>    <guid>https://juejin.cn/post/7599581204859715610</guid>    <pubDate>2026-01-27T00:51:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599581204859715610" data-draft-id="7599565587153141786" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="为什么没人走后门当程序员？"/> <meta itemprop="keywords" content="前端,后端,程序员"/> <meta itemprop="datePublished" content="2026-01-27T00:51:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CodeSheep"/> <meta itemprop="url" content="https://juejin.cn/user/4371313961738616"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            为什么没人走后门当程序员？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4371313961738616/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CodeSheep
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T00:51:19.000Z" title="Tue Jan 27 2026 00:51:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>最近刷 X 乎时看到这样一个耐人寻味的的讨论话题，浏览量超 170w，参与讨论的同学也好多。</p>
<p>问题描述是这样的：</p>
<p><strong>“为什么没人走后门当程序员？”</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d11f8a22a6c74464b54c2681faf97684~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29kZVNoZWVw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770079881&amp;x-signature=tI4vQtuhQ1hGSabAPGSSVG9DfHY%3D" alt="" loading="lazy"/></p>
<p>我认真浏览了一圈，心里五味杂陈。</p>
<p>在许多人眼中，程序员是一个高薪的职业。然而，即便程序员们拿着如此令人羡慕的高薪，尽管互联网行业如此火热，但却几乎很少听说有人说走后门想进去。</p>
<p>其实这事情一点也不难理解，这得先从程序员工作的本质说起。</p>
<p>因为程序员这个职业，从根子上来说压根就不靠后门吃饭。</p>
<p>而且程序员这行，恰恰是最混不了日子的，它要求你持续学习，跟上技术迭代，解决一个个具体而棘手的问题。</p>
<p>编程是一个实实在在的技术活，当你的代码运行不起来，它就是运行不起来，你写的系统有漏洞，它就会在某个深夜悄然崩溃，这种刚性特质就决定了程序员这个岗位无法容忍滥竽充数者。</p>
<p>而程序员的门槛，是技术，是能力，走后门也写不出一行能跑通的代码。</p>
<p>退一步说，哪怕就算你真靠后门挤进了公司，项目一上来，分分钟就会露馅。</p>
<p>那些想走后门的人，大概率是想找一个稳当、轻松、有人脉资源的工作。但反思程序员这行，是这样吗？好……好像哪个也不沾边吧……</p>
<p>所以没人走后门干程序员，不是因为这行没前途，而是因为它太实在、太透明、太难伪装。</p>
<p>这是一份必须用真本事去交换的职业，关系在这里，价值被迅速稀释到近乎为零。</p>
<p>另外大家往往有种误解或者说错觉，总觉得程序员赚得多就是香，而实际却忽略了这个高薪背后所付出的代价，这一切都是来源于高强度脑力劳动和长时间脑力付出所带来的回报。</p>
<p>再者，互联网行业的本质是工程化与扁平化。在这个体系里，你是谁、认识谁、从哪来，其实并不太重要，没人会关注你这个，英雄不问出处。</p>
<p>重要的是，你能不能解决问题，能不能为项目创造价值。</p>
<p>所以，当我们回过头来再看，为什么没人走后门干程序员这个问题，其实本身就蕴含着一种误解。它预设了程序员是一个好差事，一个可以让人躺着赚钱的美差。</p>
<p>但事实上，程序员是一份需要真才实学、持续奋斗、直面挑战的工作。你付出多少努力，掌握多少技能，最终都会在你的代码和收入上得到真实的反馈。</p>
<p>当然，这里还有一点需要反思的是：</p>
<p>该说不说，程序员行业的这种去关系化特质，其实某一角度来说也带来了一些副产品。</p>
<p>比方说，技术至上的工作文化有时会导致个体沟通能力的忽视，对硬技能的过度强调可能让软技能的发展有所滞后，另外代码世界的非黑即白有时候也会让人忽略了现实世界的复杂灰度。</p>
<p>这些其实都是程序员文化中值得反思和平衡的地方。</p>
<p>有一说一，其实很多代码之外的东西对现如今的生存也很重要，因为思维如果不开阔出来的话，路可能就会越走越窄了。</p>
<p>其实很多程序员在年龄大了之后越来越焦虑的一个重要原因就是因为生存技能太过单一了，所以千万不要给自己设限，不要把目光仅仅聚集在自己的一亩三分地上，还是要多培养一些其他方面的一些软实力，会很有帮助。</p>
<p>不知道大家有没有看过《软技能》那两本书，讲的就是代码之外的一些软技能和经验，里面提到了很多有关职场的分析，自我提高的一些路径，个人的持续学习和成长，甚至包括像理财、健身、时间管理、心态调整等等。</p>
<p>有意识地去关注这方面东西的原因在于可以帮助自己把思维给开阔出来，毕竟很多时候有必要跳出来看问题，这时候这些软技能往往就能发挥作用了。</p>
<p>另外，程序员作为一个有个性的创造性群体要专注精进技术这本身没错，但是职场毕竟也是一个充满人情世故的江湖，所以掌握一些通用的职场规则、沟通技巧，甚至是向上管理的艺术，这对于程序员来说也是十分有必要的。</p>
<p>仰望星空，脚踏实地，埋头赶路的同时也不要忘记时常抬头看看周围的环境和机会。</p>
<p>那关于这个问题，你的看法是什么呢，如果有不同的见解，也欢迎一起来分享交流~</p>
<blockquote>
<p>注：本文在GitHub开源仓库「编程之路」 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frd2coding%2FRoad2Coding" target="_blank" title="https://github.com/rd2coding/Road2Coding" ref="nofollow noopener noreferrer">github.com/rd2coding/R…</a> 中已经收录，里面有我整理的6大编程方向(岗位)的自学路线+知识点大梳理、面试考点、我的简历、几本硬核pdf笔记，以及程序员生活和感悟，欢迎star。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vercel Skills 详解]]></title>    <link>https://juejin.cn/post/7599551824548020250</link>    <guid>https://juejin.cn/post/7599551824548020250</guid>    <pubDate>2026-01-26T16:28:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599551824548020250" data-draft-id="7599551824548003866" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vercel Skills 详解"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-01-26T16:28:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="左Python右Java"/> <meta itemprop="url" content="https://juejin.cn/user/4107431173952525"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vercel Skills 详解
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4107431173952525/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    左Python右Java
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T16:28:51.000Z" title="Mon Jan 26 2026 16:28:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vercel Skills 详解</h2>
<h3 data-id="heading-1">一、什么是 Vercel Skills？</h3>
<p><strong>Vercel Skills</strong>（也称为 Agent Skills）是由 Vercel 推出的一个<strong>AI 编程助手的技能包管理器</strong>。它是一个开源项目，专门为 AI 智能体设计，用于管理和分发 AI 编码代理的技能包。</p>
<h4 data-id="heading-2">核心特点：</h4>
<ol>
<li><strong>技能包管理器</strong>：类似 npm，但专门针对 AI 智能体</li>
<li><strong>最佳实践集合</strong>：将多年的开发经验和最佳实践转化为 AI 可理解的技能</li>
<li><strong>自动化分发</strong>：自动将技能包分发到对应的 AI 工具配置目录</li>
<li><strong>开源免费</strong>：完全开源，免费使用</li>
<li><strong>专注 React/Next.js</strong>：目前主要专注于 React 和 Next.js 生态</li>
</ol>
<h3 data-id="heading-3">二、怎么用？</h3>
<h4 data-id="heading-4">1. 安装技能包</h4>
<p>使用一行命令即可安装技能包：</p>
<pre><code class="hljs language-bash" lang="bash">npx add-skill vercel-labs/agent-skills
</code></pre>
<p>这个命令会：</p>
<ul>
<li>从 GitHub 下载技能包</li>
<li>检测系统中安装的 AI 工具</li>
<li>自动将技能分发到每个工具对应的配置目录</li>
</ul>
<h4 data-id="heading-5">2. 支持的 AI 工具</h4>
<p>Vercel Skills 支持多种 AI 编码工具，包括但不限于：</p>
<ul>
<li>Cursor</li>
<li>GitHub Copilot</li>
<li>Windsurf</li>
<li>其他 AI 编码助手</li>
</ul>
<h4 data-id="heading-6">3. 技能包内容</h4>
<p>Vercel Skills 包含以下技能模块：</p>
<h5 data-id="heading-7">React 和 Next.js 性能优化</h5>
<ul>
<li>45 条性能优化黄金法则</li>
<li>组件渲染优化</li>
<li>状态管理最佳实践</li>
<li>路由优化技巧</li>
</ul>
<h5 data-id="heading-8">网页设计审查</h5>
<ul>
<li>响应式设计规范</li>
<li>可访问性标准</li>
<li>UI/UX 最佳实践</li>
<li>性能指标检查</li>
</ul>
<h5 data-id="heading-9">代码质量标准</h5>
<ul>
<li>代码风格规范</li>
<li>安全性检查</li>
<li>错误处理模式</li>
<li>测试覆盖率要求</li>
</ul>
<h4 data-id="heading-10">4. 使用示例</h4>
<h5 data-id="heading-11">安装后，AI 助手会自动获得以下能力：</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// AI 会自动应用最佳实践</span>
<span class="hljs-comment">// 优化前</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserList</span>(<span class="hljs-params">{ users }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {users.map(user =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-comment">// AI 会优化为（应用 Skills 中的性能优化规则）</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserList</span>(<span class="hljs-params">{ users }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-list"</span>&gt;</span>
      {users.map(user =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">article</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-card"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-name"</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-email"</span>&gt;</span>{user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<h4 data-id="heading-12">5. 自定义技能包</h4>
<p>你也可以创建自己的技能包：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 创建自定义技能包</span>
<span class="hljs-built_in">mkdir</span> my-skills
<span class="hljs-built_in">cd</span> my-skills

<span class="hljs-comment"># 初始化技能包配置</span>
npx add-skill init

<span class="hljs-comment"># 添加自定义技能</span>
<span class="hljs-comment"># 编辑 skill.md 文件，定义你的最佳实践</span>
</code></pre>
<h3 data-id="heading-13">三、为什么需要 Vercel Skills？</h3>
<h4 data-id="heading-14">1. 解决 AI 理解框架规范的挑战</h4>
<p><strong>问题</strong>：</p>
<ul>
<li>AI 模型训练数据可能不包含最新的框架规范</li>
<li>不同框架有复杂的最佳实践和性能优化规则</li>
<li>AI 可能生成不符合生产环境标准的代码</li>
</ul>
<p><strong>解决方案</strong>：</p>
<ul>
<li>Vercel Skills 将最佳实践转化为 AI 可理解的格式</li>
<li>让 AI 知道 10 多年的 React 和 Next.js 开发经验</li>
<li>确保生成的代码达到生产级标准</li>
</ul>
<h4 data-id="heading-15">2. 提高代码质量</h4>
<p><strong>优势</strong>：</p>
<ul>
<li><strong>性能优化</strong>：自动应用 45 条性能优化黄金法则</li>
<li><strong>代码规范</strong>：遵循统一的编码标准</li>
<li><strong>安全性</strong>：内置安全检查和最佳实践</li>
<li><strong>可维护性</strong>：生成易于维护的代码结构</li>
</ul>
<h4 data-id="heading-16">3. 加速开发流程</h4>
<p><strong>效率提升</strong>：</p>
<ul>
<li>减少代码审查时间</li>
<li>减少重构和优化工作</li>
<li>让 AI 助手"像 Vercel 工程师附体"</li>
<li>性能飙升，代码质量直接达到生产级</li>
</ul>
<h4 data-id="heading-17">4. 统一团队标准</h4>
<p><strong>团队协作</strong>：</p>
<ul>
<li>所有团队成员的 AI 助手使用相同的技能包</li>
<li>确保代码风格和最佳实践的一致性</li>
<li>降低新人学习成本</li>
<li>提高团队整体开发效率</li>
</ul>
<h4 data-id="heading-18">5. 持续更新和改进</h4>
<p><strong>生态优势</strong>：</p>
<ul>
<li>开源社区持续贡献新的技能</li>
<li>Vercel 官方维护和更新</li>
<li>跟随框架发展及时更新最佳实践</li>
<li>社区驱动的技能共享</li>
</ul>
<h3 data-id="heading-19">四、实际应用场景</h3>
<h4 data-id="heading-20">1. 新项目开发</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 在新项目中安装技能包</span>
npx add-skill vercel-labs/agent-skills

<span class="hljs-comment"># AI 助手会自动应用最佳实践</span>
<span class="hljs-comment"># 生成符合 Vercel 标准的代码</span>
</code></pre>
<h4 data-id="heading-21">2. 代码审查</h4>
<p>AI 助手会根据 Skills 中的规则：</p>
<ul>
<li>检查性能问题</li>
<li>识别安全隐患</li>
<li>提出优化建议</li>
<li>确保代码质量</li>
</ul>
<h4 data-id="heading-22">3. 重构优化</h4>
<p>AI 助手可以：</p>
<ul>
<li>应用性能优化规则</li>
<li>改进代码结构</li>
<li>提升可维护性</li>
<li>优化用户体验</li>
</ul>
<h4 data-id="heading-23">4. 团队培训</h4>
<p>新团队成员通过 Skills：</p>
<ul>
<li>快速学习最佳实践</li>
<li>了解框架规范</li>
<li>掌握性能优化技巧</li>
<li>提高代码质量意识</li>
</ul>
<h3 data-id="heading-24">五、总结</h3>
<p><strong>Vercel Skills</strong> 是一个革命性的工具，它：</p>
<ol>
<li><strong>是什么</strong>：AI 编程助手的技能包管理器</li>
<li><strong>怎么用</strong>：一行命令 <code>npx add-skill vercel-labs/agent-skills</code> 安装</li>
<li><strong>为什么</strong>：让 AI 生成的代码达到生产级标准，提高开发效率和代码质量</li>
</ol>
<p>它将多年的开发经验和最佳实践转化为 AI 可理解的技能，让 AI 助手能够像经验丰富的工程师一样编写高质量的代码。这对于提高团队开发效率、统一代码标准、降低维护成本都具有重要意义。</p>
<p>如果你正在使用 AI 编码工具（如 Cursor、GitHub Copilot 等），强烈建议尝试 Vercel Skills，它会显著提升你的开发体验和代码质量。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Laravel Boost v2.0 发布 正式支持 Skills]]></title>    <link>https://juejin.cn/post/7599538010725597211</link>    <guid>https://juejin.cn/post/7599538010725597211</guid>    <pubDate>2026-01-27T00:02:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599538010725597211" data-draft-id="7599581687357669426" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Laravel Boost v2.0 发布 正式支持 Skills"/> <meta itemprop="keywords" content="后端,Laravel"/> <meta itemprop="datePublished" content="2026-01-27T00:02:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Laravel Boost v2.0 发布 正式支持 Skills
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T00:02:36.000Z" title="Tue Jan 27 2026 00:02:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Laravel Boost v2.0 发布 正式支持 Skills</h2>
<p>Laravel Boost 发布了 2.0 版本，核心变化是引入了 Skills 系统。这套机制改变了 AI Agent 获取上下文的方式——从"一次性加载所有指南"变为"按需激活相关技能"。</p>
<p>实测效果：原有的 Guidelines 体积减少约 40%，Agent 响应更聚焦，生成的代码质量明显提升。</p>
<h3 data-id="heading-1">这个版本带来了什么</h3>
<ul>
<li><strong>Skills 系统</strong>：按需加载的上下文管理机制</li>
<li><strong>Skill Overrides</strong>：支持覆盖和定制已有技能</li>
<li><strong>boost:add-skill 命令</strong>：一行命令添加社区技能</li>
<li><strong>安装流程优化</strong>：重构了初始化体验</li>
</ul>
<h3 data-id="heading-2">Guidelines 和 Skills 的区别</h3>
<p>Boost 现在提供两种方式给 Agent 提供上下文。</p>
<p><strong>Guidelines</strong></p>
<ul>
<li>Agent 启动时一次性加载</li>
<li>覆盖面广，偏基础性</li>
<li>主要是 Laravel 通用约定和最佳实践</li>
</ul>
<p><strong>Skills</strong></p>
<ul>
<li>仅在需要时激活</li>
<li>聚焦特定领域</li>
<li>针对 Livewire、Pest、Inertia 等具体场景提供详细模式</li>
</ul>
<p>这种分层设计解决了一个实际问题：Agent 的上下文窗口是有限的。以前把所有指南都塞进去，Agent 可能在不相关的信息里迷失方向。现在只加载当前任务需要的技能，生成的代码更贴合实际需求。</p>
<h3 data-id="heading-3">内置技能清单</h3>
<p>v2.0 内置了一批开箱即用的技能：</p>
<ul>
<li>Livewire 开发</li>
<li>Pest 测试</li>
<li>Tailwind CSS</li>
<li>Inertia（Vue、React、Svelte）</li>
<li>Volt</li>
<li>Flux UI</li>
<li>Folio 路由</li>
<li>Pennant</li>
<li>MCP</li>
<li>Wayfinder</li>
</ul>
<p>更新这些技能只需要一条命令：</p>
<pre><code class="hljs language-bash" lang="bash">php artisan boost:update
</code></pre>
<h3 data-id="heading-4">社区技能</h3>
<p>除了内置技能，Boost 支持从社区或 GitHub 拉取第三方技能。</p>
<pre><code class="hljs language-bash" lang="bash">php artisan boost:add-skill
</code></pre>
<p>选择需要的技能后，Boost 会自动同步到所有 Agent 配置中。</p>
<h3 data-id="heading-5">自定义技能</h3>
<p>如果项目有特殊的业务逻辑或团队约定，可以创建自定义技能。</p>
<p>在以下路径添加文件：</p>
<pre><code class="hljs language-text" lang="text">.ai/skills/{skill-name}/SKILL.md
</code></pre>
<p>运行 <code>boost:update</code> 后，自定义技能会和内置技能一起安装。</p>
<p>适用场景：</p>
<ul>
<li>领域模型规范</li>
<li>团队代码风格约定</li>
<li>项目特有的架构模式</li>
</ul>
<h3 data-id="heading-6">包开发者支持</h3>
<p>包开发者现在可以随包发布技能。</p>
<p>将技能文件放在：</p>
<pre><code class="hljs language-text" lang="text">resources/boost/skills/{skill-name}/SKILL.md
</code></pre>
<p>用户安装 Boost 时，包内的技能会被自动发现并安装。</p>
<p>这对于维护开源包的开发者来说是个实用功能——用户在使用你的包时，Agent 能自动获得正确的上下文，减少"用错 API"的情况。</p>
<h3 data-id="heading-7">总结</h3>
<p>Skills 系统的核心价值在于"精准上下文"。Agent 不再需要处理大量不相关的信息，而是按需获取当前任务需要的知识。对于正在使用 AI 辅助开发 Laravel 项目的团队，这是一次值得跟进的升级。</p>
<pre><code class="hljs language-bash" lang="bash">composer require laravelboost/boost:^2.0
</code></pre>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-01%2Flaravel-boost-v2-skills-system" target="_blank" title="https://catchadmin.com/post/2026-01/laravel-boost-v2-skills-system" ref="nofollow noopener noreferrer">原文 Laravel Boost v2.0 发布 Skills 让 AI 编码助手更懂你的项目</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Langchain学习笔记（一）：认识Langchain-调用LLM的正确姿势]]></title>    <link>https://juejin.cn/post/7599511763987808310</link>    <guid>https://juejin.cn/post/7599511763987808310</guid>    <pubDate>2026-01-26T17:37:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599511763987808310" data-draft-id="7599483314161172499" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Langchain学习笔记（一）：认识Langchain-调用LLM的正确姿势"/> <meta itemprop="keywords" content="人工智能,LLM,LangChain"/> <meta itemprop="datePublished" content="2026-01-26T17:37:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Shawn_Shawn"/> <meta itemprop="url" content="https://juejin.cn/user/1855631358965384"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Langchain学习笔记（一）：认识Langchain-调用LLM的正确姿势
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1855631358965384/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Shawn_Shawn
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T17:37:39.000Z" title="Mon Jan 26 2026 17:37:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Langchain是一款开源框架，用于构建Agent，集成了众多大模型供应商和工具。</p>
<ul>
<li>langchain主要负责与LLM交互，Tool，Rag，Memory，Agent等功能。</li>
<li>LangGraph负责实现Agent编排，专用于构建、管理和部署<strong>长时间运行（long-running）且具备状态管理（stateful</strong>的智能体。</li>
<li>LangSmith则负责提升Agent的可观测性，提供了用于开发、调试和部署 LLM 应用程序的工具。 它能够帮助您在一个统一的平台上追踪请求、评估输出、测试提示词（Prompts）以及管理部署。</li>
</ul>
<h2 data-id="heading-0">Langchain核心功能</h2>
<h3 data-id="heading-1">LCEL语法</h3>
<p>早期的Langchain，将提示词，模型，工具调用，Rag，Memory等模块组织成链式结构，让开发者能够清晰的组合这些组件，构建出复杂的Agent。但是缺点也很明显：</p>
<ol>
<li>流程不透明、调试困难：链条中间没有明确的状态表达，出错时难以定位是哪一步出了问题。</li>
<li>缺乏并发与分支控制能力：只能“从左到右”执行，面对多轮对话、并行任务，力不从心。</li>
<li>Agent 系统复杂难控：LangChain Agent 的“反复推理 + 工具调用”机制，虽然看似智能，但在实际工程中不稳定、不易测试。</li>
</ol>
<p>为了解决这些问题，Langchain团队研发出了LCEL。LCEL (LangChain Expression Language) 是 LangChain 提供的一种声明式语言，用于轻松构建和组合复杂的链（Chains）。使得代码更加简洁、清晰，并且原生支持流式/非流式输出。</p>
<p>在LCEL中，所有组件都实现了 <code>langchain_core.runnables.base.Runnable</code>接口，都实现了</p>
<ul>
<li>invoke() - 单个输入</li>
<li>batch() - 批量输入</li>
<li>stream() - 流式输出</li>
<li>ainvoke() - 异步单个输入</li>
</ul>

































<table><thead><tr><th><strong>组件名称</strong></th><th><strong>作用</strong></th></tr></thead><tbody><tr><td><strong>RunnableSequence</strong></td><td>顺序执行</td></tr><tr><td><strong>RunnableParallel</strong></td><td>并行执行多个任务</td></tr><tr><td><strong>RunnablePassthrough</strong></td><td>透传数据，不做处理</td></tr><tr><td><strong>RunnableLambda</strong></td><td>将自定义 Python 函数转为 Runnable</td></tr><tr><td><strong>RunnableConfig</strong></td><td>配置项</td></tr><tr><td><strong>RunnableBranch</strong></td><td>条件分支</td></tr></tbody></table>
<p>但是，现在的Agent是越来越复杂，需要更加精细化的状态管控，任务调度，失败处理，事件监听，整个Agent的生命周期到每一个事件的生命周期，都需要更加细粒度的管理，还需要一套更为清晰完整的，适合工作流程编排的框架。那就是LangGraph的诞生。</p>
<ul>
<li>LCEL：描述单个“图节点”的调用逻辑（比如一个子任务、一个 API 调用）。</li>
<li>LangGraph：编排多个节点，负责整个工作流的调度、状态跳转与生命周期控制。</li>
</ul>
<h3 data-id="heading-2">Model</h3>
<p>安装 openai依赖 <code>pip install langchain-openai</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate, PromptTemplate
<span class="hljs-keyword">from</span> langchain_core.tools <span class="hljs-keyword">import</span> Tool
<span class="hljs-keyword">import</span> datetime

<span class="hljs-comment"># 加载环境变量</span>
load_dotenv()
api_key = os.getenv(<span class="hljs-string">'OPENAI_API_KEY'</span>)
base_url = os.getenv(<span class="hljs-string">'OPENAI_API_BASE'</span>)

<span class="hljs-comment"># ========== 1. 初始化 LLM（大语言模型） ==========</span>
<span class="hljs-comment"># LangChain 特点：统一的 LLM 接口，支持多种模型提供商</span>
llm = ChatOpenAI(
    base_url=base_url,
    api_key=api_key,
    model=<span class="hljs-string">"deepseek-ai/DeepSeek-V3.2"</span>,
    temperature=<span class="hljs-number">0.7</span>  <span class="hljs-comment"># LangChain 特点：统一的参数配置</span>
)

<span class="hljs-comment"># 也可以使用 init_chat_model 由于我使用的是硅基流动的，所以需要提供model_provider为openai</span>
<span class="hljs-comment"># 如果你直接使用的是deepseek，model_provider可以不用填，但需要安装langchain-deepseek包</span>
model = init_chat_model(
    model=<span class="hljs-string">"deepseek-ai/DeepSeek-V3.2"</span>,
    model_provider=<span class="hljs-string">"openai"</span>,
    temperature=<span class="hljs-number">0.7</span>
)


<span class="hljs-comment"># ========== 2. LLMChain：Prompt → LLM → 输出链的基本流程封装 ==========</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">demo_llm_chain</span>():
    <span class="hljs-string">"""
    演示 LLMChain：支持变量注入与模板复用的核心组件
    LangChain 特点：模板化提示词管理，支持变量替换
    """</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"🔗 LLMChain 演示：Prompt → LLM → 输出链"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)

    <span class="hljs-comment"># 创建提示词模板 - LangChain 特点：模板复用</span>
    prompt_template = PromptTemplate(
        input_variables=[<span class="hljs-string">"topic"</span>, <span class="hljs-string">"style"</span>],
        template=<span class="hljs-string">"""
        请以{style}的风格，写一段关于{topic}的介绍。
        要求：简洁明了，不超过100字。
        """</span>
    )

    <span class="hljs-comment"># LCEL (LangChain Expression Language)，还是0.x的版本用的比较多</span>
    <span class="hljs-comment"># 1.x开始采用Message</span>
    <span class="hljs-comment"># 下面两种方式都行</span>
    chain = prompt_template | llm
    chain = prompt_template | model
    <span class="hljs-comment"># 执行链 - 变量注入 </span>

    result = chain.invoke({<span class="hljs-string">"topic"</span>: <span class="hljs-string">"人工智能"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>})
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"📝 LLMChain 输出：\n<span class="hljs-subst">{result.content}</span>\n"</span>)

    <span class="hljs-comment"># 流式输出</span>
    <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> chain.stream({<span class="hljs-string">"topic"</span>: <span class="hljs-string">"人工智能"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>}):
        <span class="hljs-built_in">print</span>(chunk.text, end=<span class="hljs-string">"|"</span>, flush=<span class="hljs-literal">True</span>)

    <span class="hljs-comment"># batch</span>
    messages = [
        {<span class="hljs-string">"topic"</span>: <span class="hljs-string">"人工智能"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>},
        {<span class="hljs-string">"topic"</span>: <span class="hljs-string">"大模型"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>},
        {<span class="hljs-string">"topic"</span>: <span class="hljs-string">"langchain"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>}
    ]
    responses = chain.batch(messages)
    <span class="hljs-keyword">for</span> response <span class="hljs-keyword">in</span> responses:
        <span class="hljs-built_in">print</span>(response)


    <span class="hljs-keyword">return</span> result.content
</code></pre>
<p><strong>核心的方法</strong></p>
<ul>
<li>invoke</li>
</ul>
<pre><code class="hljs language-python" lang="python">result = chain.invoke({<span class="hljs-string">"topic"</span>: <span class="hljs-string">"人工智能"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>})
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"📝 LLMChain 输出：\n<span class="hljs-subst">{result.content}</span>\n"</span>)
</code></pre>
<ul>
<li>stream</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 流式输出</span>
<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> chain.stream({<span class="hljs-string">"topic"</span>: <span class="hljs-string">"人工智能"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>}):
    <span class="hljs-built_in">print</span>(chunk.text, end=<span class="hljs-string">"|"</span>, flush=<span class="hljs-literal">True</span>)
</code></pre>
<ul>
<li>batch</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># batch</span>
messages = [
    {<span class="hljs-string">"topic"</span>: <span class="hljs-string">"人工智能"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>},
    {<span class="hljs-string">"topic"</span>: <span class="hljs-string">"大模型"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>},
    {<span class="hljs-string">"topic"</span>: <span class="hljs-string">"langchain"</span>, <span class="hljs-string">"style"</span>: <span class="hljs-string">"科普"</span>}
]
responses = chain.batch(messages)
<span class="hljs-keyword">for</span> response <span class="hljs-keyword">in</span> responses:
    <span class="hljs-built_in">print</span>(response)
</code></pre>
<p><strong>核心参数</strong>：</p>
<ul>
<li>model: 大模型名称</li>
<li>model_provider: 模型供应商，我用的是硅基流动，langchain没有提供硅基流动的包，但硅基流动兼容了OpenAi协议，模型供应商选择OpenAi，也能连接硅基流动。</li>
<li>api_key:</li>
<li>temperature：</li>
<li>max_token:</li>
<li>max_retries:</li>
<li>timeout:</li>
</ul>
<p><strong>比较常用的Model 功能</strong></p>
<p><strong>思考模式打开</strong></p>
<pre><code class="hljs language-python" lang="python">reasoning = {
    <span class="hljs-string">"effort"</span>: <span class="hljs-string">"medium"</span>
}

reasoning_model = ChatOpenAI(
    model=<span class="hljs-string">"gpt-5.2"</span>,
    temperature=<span class="hljs-number">0.7</span>,
    reasoning=reasoning
)

<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> reasoning_model.stream(<span class="hljs-string">"大模型的原理"</span>):
    reasoning_steps = [r <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> chunk.content_blocks <span class="hljs-keyword">if</span> r[<span class="hljs-string">"type"</span>] == <span class="hljs-string">"reasoning"</span>]
    <span class="hljs-built_in">print</span>(reasoning_steps <span class="hljs-keyword">if</span> reasoning_steps <span class="hljs-keyword">else</span> chunk.text)
</code></pre>
<p><strong>结构化输出</strong></p>
<h3 data-id="heading-3">Message</h3>
<p>Message按照OpenAi的规范需要区分角色：</p>
<ul>
<li>developer: developer message的主要职责是</li>
</ul>

<ul>
<li>
<ul>
<li>系统的核心规则</li>
<li>系统的业务逻辑</li>
<li>工具的定义</li>
</ul>
</li>
</ul>

<ul>
<li>user：用户的输入和配置，用于</li>
<li>Assistant：大模型的输出</li>
</ul>
<p>developer以前是system，现在变成了developer，但是langchain或者其他智能体框架，都还沿用着system作为系统角色，OpenAi两者都兼容。</p>
<p>Langchain还新增了一个角色，Tool，工具消息用于将单个工具执行的结果传递回模型。工具可以直接生成 ToolMessage 对象。</p>
<pre><code class="hljs language-python" lang="python">messages = [
    SystemMessage(content=<span class="hljs-string">"你是一名资深的Python后端工程师面试官，负责考察候选人的技术能力。"</span>),
    HumanMessage(content=<span class="hljs-string">"请问什么是装饰器？"</span>),
    AIMessage(content=<span class="hljs-string">"装饰器是Python中用于修改函数或类行为的语法糖..."</span>),
    HumanMessage(content=<span class="hljs-string">"能举个实际应用的例子吗？"</span>)
]

<span class="hljs-comment"># </span>
<span class="hljs-comment"># messages = [</span>
<span class="hljs-comment">#     {"role": "system", "content": "你是一名资深的Python后端工程师面试官，负责考察候选人的技术能力。"}, # 对应SystemMessage</span>
<span class="hljs-comment">#     {"role": "user", "content": "请问什么是装饰器？"}, # 对应HumanMessage</span>
<span class="hljs-comment">#     {"role": "assistant", "content": "装饰器是Python中用于修改函数或类行为的语法糖..."}, # 对应AIMessage</span>
<span class="hljs-comment">#     {"role": "user", "content": "能举个实际应用的例子吗？"}</span>
<span class="hljs-comment"># ]</span>


response = llm.invoke(messages)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"📝 LLMChain 输出：\n<span class="hljs-subst">{response.content}</span>\n"</span>)
</code></pre>
<p>ToolMessage的使用方式</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">location: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""Get the weather at a location."""</span>
    <span class="hljs-comment"># 先获取城市ID</span>
    location_url = <span class="hljs-string">f"https://n53h2qt5jy.re.qweatherapi.com/geo/v2/city/lookup?location=<span class="hljs-subst">{location}</span>"</span>
    location_response = (requests.get(url=location_url,headers={<span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,<span class="hljs-string">"X-QW-Api-Key"</span>:  q_weather_api_key}).json())

    <span class="hljs-keyword">if</span> location_response[<span class="hljs-string">'code'</span>] != <span class="hljs-string">'200'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"未找到城市：<span class="hljs-subst">{location}</span>"</span>

    location_id = location_response[<span class="hljs-string">'location'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'id'</span>]

    <span class="hljs-comment"># 查询天气</span>
    weather_url = <span class="hljs-string">f"https://n53h2qt5jy.re.qweatherapi.com/v7/weather/now?location=<span class="hljs-subst">{location_id}</span>"</span>
    weather_response = requests.get(url=weather_url, headers={<span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>, <span class="hljs-string">"X-QW-Api-Key"</span>:  q_weather_api_key}).json()

    <span class="hljs-keyword">if</span> weather_response[<span class="hljs-string">'code'</span>] == <span class="hljs-string">'200'</span>:
        now = weather_response[<span class="hljs-string">'now'</span>]
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{location}</span>当前天气：<span class="hljs-subst">{now[<span class="hljs-string">'text'</span>]}</span>，温度<span class="hljs-subst">{now[<span class="hljs-string">'temp'</span>]}</span>°C，体感温度<span class="hljs-subst">{now[<span class="hljs-string">'feelsLike'</span>]}</span>°C"</span>

    <span class="hljs-keyword">return</span> <span class="hljs-string">"天气查询失败"</span>

model_with_tools = llm.bind_tools([get_weather])
response = model_with_tools.invoke(<span class="hljs-string">"What's the weather in 上海?"</span>)

<span class="hljs-keyword">for</span> tool_call <span class="hljs-keyword">in</span> response.tool_calls:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Tool: <span class="hljs-subst">{tool_call[<span class="hljs-string">'name'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Args: <span class="hljs-subst">{tool_call[<span class="hljs-string">'args'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ID: <span class="hljs-subst">{tool_call[<span class="hljs-string">'id'</span>]}</span>"</span>)

<span class="hljs-comment"># After a model makes a tool call</span>
<span class="hljs-comment"># (Here, we demonstrate manually creating the messages for brevity)</span>
ai_message = AIMessage(
    content=[],
    tool_calls=[{
        <span class="hljs-string">"name"</span>: <span class="hljs-string">"get_weather"</span>,
        <span class="hljs-string">"args"</span>: {<span class="hljs-string">"location"</span>: <span class="hljs-string">"上海"</span>},
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"call_123"</span>
    }]
)

<span class="hljs-comment"># Execute tool and create result message</span>
tool_message = ToolMessage(
    content=get_weather(<span class="hljs-string">"上海"</span>),
    tool_call_id=<span class="hljs-string">"call_123"</span>  <span class="hljs-comment"># Must match the call ID</span>
)

<span class="hljs-comment"># Continue conversation</span>
messages = [
    HumanMessage(<span class="hljs-string">"上海天气如何?"</span>),
    ai_message,  <span class="hljs-comment"># Model's tool call</span>
    tool_message,  <span class="hljs-comment"># Tool execution result</span>
]
response = llm.invoke(messages)  <span class="hljs-comment"># Model processes the result</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"=================="</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"📝 LLMChain 输出：\n<span class="hljs-subst">{response.content}</span>\n"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"llm 元数据：<span class="hljs-subst">{response.usage_metadata}</span>"</span>)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenCode 使用指南：从"小白入门"到"AI 编程效率翻倍"]]></title>    <link>https://juejin.cn/post/7599514071105683471</link>    <guid>https://juejin.cn/post/7599514071105683471</guid>    <pubDate>2026-01-26T15:17:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599514071105683471" data-draft-id="7599526246503727138" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenCode 使用指南：从&quot;小白入门&quot;到&quot;AI 编程效率翻倍&quot;"/> <meta itemprop="keywords" content="前端,后端,人工智能"/> <meta itemprop="datePublished" content="2026-01-26T15:17:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iDao技术魔方"/> <meta itemprop="url" content="https://juejin.cn/user/166781496080782"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenCode 使用指南：从"小白入门"到"AI 编程效率翻倍"
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/166781496080782/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iDao技术魔方
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T15:17:03.000Z" title="Mon Jan 26 2026 15:17:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">开篇</h2>
<p>腊月二十九，老赵刷到一个叫 OpenCode 的工具，GitHub 8 万+ stars，还是免费的。</p>
<p>老赵心想：又是哪个公司想割韭菜？免费的东西能好用？</p>
<p>抱着怀疑的态度，老赵花了半天折腾，结果——真香。</p>
<p>OpenCode 不是割韭菜工具，是一个能在终端用的开源 AI 编程助手，能写代码、改代码、查代码，还支持几十种 AI 模型。最骚的是，它还有个叫 Oh My OpenCode 的插件，装上后，OpenCode 从"单兵作战"变成了"团队协作"。</p>
<p>这篇文章从「安装配置 × 核心功能 × 实战场景」三视角拆解 OpenCode 的使用方法，帮你快速上手，看完能直接套用的开发工作流。</p>
<hr/>
<h2 data-id="heading-1">一、快速上手：三步从零到能跑</h2>
<h3 data-id="heading-2">技术原理</h3>
<p>OpenCode 是一个开源的 AI 编程助手，核心架构基于 TypeScript，支持多模态（终端、桌面、IDE 插件）。它的最大亮点是完全开源 + 多模型支持 + 可扩展的插件生态。</p>
<p><strong>三大核心特性</strong>：</p>
<ul>
<li><strong>多模型支持</strong>：OpenAI、Anthropic、Google、智谱 AI、MiniMax 等 75+ 种模型</li>
<li><strong>免费模型</strong>：OpenCode Zen 提供精选免费模型（GLM-4.7、MiniMax M2.1）</li>
<li><strong>智能体系统</strong>：内置 Build、Plan、General、Explore 四种专业智能体</li>
</ul>
<p><strong>数据说话</strong>：OpenCode 在 GitHub上有8万+ stars。相比 Claude Code，它完全免费且对国内用户友好（不限速、不封号）。</p>
<h3 data-id="heading-3">实操案例：安装与配置</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Step 1：安装 OpenCode（推荐使用官方脚本）</span>
curl -fsSL https://opencode.ai/install | bash

<span class="hljs-comment"># 或者使用 npm 安装</span>
npm install -g opencode-ai

<span class="hljs-comment"># Step 2：配置 AI 模型</span>
<span class="hljs-comment"># 方式一：使用 OpenCode Zen（推荐，有免费模型）</span>
opencode
<span class="hljs-comment"># 在 TUI 界面中选择 opencode，然后运行 /connect</span>

<span class="hljs-comment"># 方式二：使用自己的 API Key</span>
opencode
<span class="hljs-comment"># /connect</span>
<span class="hljs-comment"># 选择你的提供商（OpenAI、Anthropic、Google 等）</span>
<span class="hljs-comment"># 粘贴 API Key</span>

<span class="hljs-comment"># Step 3：初始化项目</span>
<span class="hljs-built_in">cd</span> /path/to/your/project
opencode
<span class="hljs-comment"># 运行 /init，让 OpenCode 分析项目结构</span>
</code></pre>
<p><strong>安装注意事项</strong>：</p>
<ul>
<li>Windows 用户：需要用 WSL（Windows Subsystem for Linux）或 Docker</li>
<li>macOS/Linux 用户：直接安装即可</li>
<li>需要准备 API Key（如果不用免费模型）</li>
</ul>
<h3 data-id="heading-4">落地步骤</h3>
<ol>
<li><strong>安装阶段</strong>：选择适合你系统的安装方式（脚本/npm/Homebrew）</li>
<li><strong>配置阶段</strong>：选择 AI 提供商，配置 API Key（或使用免费模型）</li>
<li><strong>初始化阶段</strong>：在项目目录运行 <code>/init</code>，让 OpenCode 生成 AGENTS.md 配置文件</li>
<li><strong>开发阶段</strong>：开始使用 OpenCode 进行日常开发工作</li>
</ol>
<h3 data-id="heading-5">避坑指南</h3>
<ul>
<li>❌ <strong>新手常犯</strong>：看到免费模型就只用免费，忽略付费模型的优势</li>
<li>✅ <strong>正确做法</strong>：先尝试免费模型，评估效果后再决定是否升级付费</li>
<li>⚠️ <strong>注意</strong>：OpenCode Zen 的免费模型有速率限制，高峰期可能较慢</li>
</ul>
<hr/>
<h2 data-id="heading-6">二、核心功能：四个智能体 + 四种模式</h2>
<h3 data-id="heading-7">技术原理</h3>
<p>OpenCode 的核心架构是「智能体系统（Agent System）」，通过不同的智能体处理不同的任务类型。它有两个级别的智能体：</p>
<p><strong>主智能体（Primary Agents）</strong>：你直接交互的主要助手</p>
<ul>
<li><strong>Build</strong>：默认主智能体，拥有所有工具权限（文件读写、bash 命令）</li>
<li><strong>Plan</strong>：受限智能体，禁用文件编辑和 bash 命令，用于分析和规划</li>
</ul>
<p><strong>子智能体（Subagents）</strong>：主智能体可以调用的专业助手</p>
<ul>
<li><strong>General</strong>：通用目的智能体，用于研究和多步骤任务</li>
<li><strong>Explore</strong>：只读智能体，用于快速探索代码库</li>
</ul>
<p><strong>四种模式</strong>：</p>
<ol>
<li><strong>Message Mode</strong>：标准对话模式，自然语言交互</li>
<li><strong>Handoff Mode</strong>：新引入的模式，主智能体将任务"移交给"子智能体</li>
<li><strong>Compress Mode</strong>：压缩模式，压缩对话历史</li>
<li><strong>Parallelize Mode</strong>：并行模式，分叉多个子智能体并行工作</li>
</ol>
<h3 data-id="heading-8">实操案例：智能体切换与协作</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 场景：你想添加一个新功能，但不确定如何实现</span>

<span class="hljs-comment"># Step 1：切换到 Plan 模式（按 Tab 键）</span>
&lt;TAB&gt;  <span class="hljs-comment"># 切换到 Plan 智能体</span>

<span class="hljs-comment"># Step 2：让 Plan 分析项目并提出方案</span>
<span class="hljs-string">"帮我分析一下这个 React 项目的代码结构，然后给出添加用户认证功能的建议"</span>

<span class="hljs-comment"># Plan 会返回详细的分析和实现建议，但不会修改任何文件</span>

<span class="hljs-comment"># Step 3：切换回 Build 模式（再按 Tab 键）</span>
&lt;TAB&gt;  <span class="hljs-comment"># 切换回 Build 智能体</span>

<span class="hljs-comment"># Step 4：让 Build 执行具体实现</span>
<span class="hljs-string">"按照你刚才给出的建议，实现用户认证功能"</span>

<span class="hljs-comment"># Build 会直接修改文件、添加代码、运行测试</span>

<span class="hljs-comment"># 使用子智能体（@ 调用）</span>
<span class="hljs-string">" @general 帮我搜索项目中所有与认证相关的文件"</span>
<span class="hljs-string">" @explore 找出所有使用 useEffect 的组件"</span>
</code></pre>
<h3 data-id="heading-9">落地步骤</h3>
<ol>
<li><strong>理解智能体分工</strong>：Build（执行）、Plan（规划）、General（通用）、Explore（探索）</li>
<li><strong>学会切换智能体</strong>：用 Tab 键在主智能体之间切换</li>
<li><strong>使用 @ 调用子智能体</strong>：在消息中用 <code>@</code> 前缀调用特定子智能体</li>
<li><strong>选择合适的模式</strong>：根据任务类型选择 Message/Handoff/Compress/Parallelize</li>
</ol>
<h3 data-id="heading-10">避坑指南</h3>
<ul>
<li>❌ <strong>新手常犯</strong>：所有任务都用 Build 模式，导致不必要的文件修改</li>
<li>✅ <strong>正确做法</strong>：规划和分析用 Plan，执行用 Build，探索用 Explore</li>
<li>⚠️ <strong>注意</strong>：子智能体会创建独立的会话，可以用快捷键在主会话和子会话之间导航</li>
</ul>
<hr/>
<h2 data-id="heading-11">三、实战场景：从"写 Bug"到"重构项目"</h2>
<h3 data-id="heading-12">技术原理</h3>
<p>OpenCode 的强大之处在于它能处理真实的项目开发场景，而不仅仅是代码补全。它有完整的项目索引能力，可以理解整个代码库的结构和上下文。</p>
<p><strong>核心工作流</strong>：</p>
<ol>
<li><strong>项目索引</strong>：<code>/init</code> 扫描项目，生成 AGENTS.md</li>
<li><strong>代码分析</strong>：理解现有代码结构、依赖关系、编码模式</li>
<li><strong>功能开发</strong>：根据自然语言描述生成代码、修改代码</li>
<li><strong>代码审查</strong>：自动检查代码质量、安全问题、性能隐患</li>
<li><strong>文档生成</strong>：为项目生成或更新文档</li>
</ol>
<h3 data-id="heading-13">实操案例 1：添加新功能（完整工作流）</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 场景：为一个 Next.js 项目添加用户评论功能</span>

<span class="hljs-comment"># Step 1：让 Plan 智能体分析需求</span>
&lt;TAB&gt;  <span class="hljs-comment"># 切换到 Plan</span>
<span class="hljs-string">"为这个 Next.js 项目添加用户评论功能，需要：
1. 数据库表结构设计
2. API 路由实现
3. 前端组件开发
4. 评论与帖子的关联
请给出完整的实现方案，但不要修改任何文件。"</span>

<span class="hljs-comment"># Plan 会返回详细的实现建议，包括：</span>
<span class="hljs-comment"># - 数据库 schema（Prisma 或 SQL）</span>
<span class="hljs-comment"># - API 路由设计（REST 或 GraphQL）</span>
<span class="hljs-comment"># - React 组件结构</span>
<span class="hljs-comment"># - 集成方式</span>

<span class="hljs-comment"># Step 2：查看并确认方案</span>
<span class="hljs-string">"方案看起来很完整，但我想确认一下：用户评论需要嵌套回复吗？"</span>

<span class="hljs-comment"># Plan 会补充说明</span>

<span class="hljs-comment"># Step 3：切换到 Build 执行实现</span>
&lt;TAB&gt;  <span class="hljs-comment"># 切换到 Build</span>
<span class="hljs-string">"按照确认后的方案，实现用户评论功能。分步骤进行：
1. 先实现数据库迁移
2. 再创建 API 路由
3. 最后开发前端组件
每完成一步，告诉我，让我审查代码。"</span>

<span class="hljs-comment"># Build 会逐步实现，并在每步等待你的确认</span>

<span class="hljs-comment"># Step 4：代码审查</span>
<span class="hljs-string">"实现完成后，帮我审查一下代码，检查：
1. SQL 注入风险
2. XSS 防护
3. 性能问题
4. 代码规范"</span>
</code></pre>
<h3 data-id="heading-14">实操案例 2：调试和重构</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 场景：发现一个 Bug，需要定位和修复</span>

<span class="hljs-comment"># Step 1：用 Explore 智能体搜索相关代码</span>
&lt;TAB&gt;  <span class="hljs-comment"># 切换到 Plan 模式</span>
<span class="hljs-string">" @explore 找出所有与用户认证相关的文件，特别关注：
1. login 函数
2. auth 中间件
3. token 验证逻辑"</span>

<span class="hljs-comment"># Explore 会返回文件列表和关键代码片段</span>

<span class="hljs-comment"># Step 2：分析问题</span>
<span class="hljs-string">"根据找到的代码，分析可能导致登录失败的原因：
1. 异步处理不当
2. 错误处理缺失
3. token 过期检查有问题
请给出详细的根因分析和修复建议。"</span>

<span class="hljs-comment"># Step 3：执行修复</span>
&lt;TAB&gt;  <span class="hljs-comment"># 切换到 Build</span>
<span class="hljs-string">"按照你的分析，修复这个 Bug。重点关注：
1. 添加适当的错误处理
2. 完善 token 刷新逻辑
3. 添加日志记录便于调试"</span>

<span class="hljs-comment"># Step 4：验证修复</span>
<span class="hljs-string">"修复后，帮我检查一下是否还有其他潜在问题，特别是：
1. 并发登录场景
2. 记住我功能"</span>
</code></pre>
<h3 data-id="heading-15">落地步骤</h3>
<ol>
<li><strong>需求分析</strong>：用 Plan 模式先理解需求，不要急于上手就改代码</li>
<li><strong>代码搜索</strong>：用 Explore 模式快速定位相关文件和代码片段</li>
<li><strong>逐步实现</strong>：用 Build 模式分步实现，每步确认</li>
<li><strong>代码审查</strong>：每次完成后让 AI 审查，及时发现潜在问题</li>
</ol>
<h3 data-id="heading-16">避坑指南</h3>
<ul>
<li>❌ <strong>新手常犯</strong>：一次性让 AI 实现整个功能，不审查就上线</li>
<li>✅ <strong>正确做法</strong>：分步骤执行，每步确认后再继续，用 Plan 先规划</li>
<li>⚠️ <strong>注意</strong>：可以用 <code>/undo</code> 命令撤销 AI 的修改，不要怕改错</li>
</ul>
<hr/>
<h2 data-id="heading-17">四、Oh My OpenCode：从"助手"到"团队"</h2>
<h3 data-id="heading-18">技术原理</h3>
<p>Oh My OpenCode（简称 OMO）是 OpenCode 的增强插件，类似于 Oh My Zsh 对于 Zsh 的增强。它为 OpenCode 添加了更多强大功能：</p>
<p><strong>核心增强功能</strong>：</p>
<ul>
<li><strong>多 AI 模型协作</strong>：同时调用多个 AI 模型协同工作</li>
<li><strong>增强的智能体系统</strong>：frontend-ui-ux-engineer、oracle、librarian、document-writer 等专业智能体</li>
<li><strong>后台任务管理</strong>：可以并行执行多个任务，不阻塞主对话</li>
<li><strong>Skills 系统</strong>：可以创建自定义技能（Skills），封装常用工作流</li>
</ul>
<p><strong>安装 OMO 的好处</strong>：</p>
<ul>
<li>OpenCode 变成完整的 AI 开发团队</li>
<li>可以让不同的 AI 模型协作（比如一个写代码，一个审查，一个生成文档）</li>
<li>后台任务可以持续运行，不影响主对话</li>
</ul>
<h3 data-id="heading-19">实操案例：多模型协作</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 场景：开发一个 Vue 组件，同时需要代码审查和文档生成</span>

<span class="hljs-comment"># Step 1：安装 Oh My OpenCode（安装后自动启用）</span>
<span class="hljs-comment"># 访问 https://github.com/code-yeongyu/oh-my-opencode 按照文档安装</span>

<span class="hljs-comment"># Step 2：配置多个模型</span>
<span class="hljs-comment"># 在 opencode.json 中配置不同提供商的 API Keys</span>

{
  <span class="hljs-string">"provider"</span>: {
    <span class="hljs-string">"openai"</span>: {
      <span class="hljs-string">"apiKey"</span>: <span class="hljs-string">"sk-..."</span>
    },
    <span class="hljs-string">"anthropic"</span>: {
      <span class="hljs-string">"apiKey"</span>: <span class="hljs-string">"sk-ant-..."</span>
    }
  },
  <span class="hljs-string">"agent"</span>: {
    <span class="hljs-string">"coder"</span>: {
      <span class="hljs-string">"model"</span>: <span class="hljs-string">"openai/gpt-4"</span>,
      <span class="hljs-string">"description"</span>: <span class="hljs-string">"用 GPT-4 写代码"</span>
    },
    <span class="hljs-string">"reviewer"</span>: {
      <span class="hljs-string">"model"</span>: <span class="hljs-string">"anthropic/claude-sonnet-4"</span>,
      <span class="hljs-string">"description"</span>: <span class="hljs-string">"用 Claude Sonnet 审查代码"</span>
    },
    <span class="hljs-string">"doc-writer"</span>: {
      <span class="hljs-string">"model"</span>: <span class="hljs-string">"anthropic/claude-haiku-4"</span>,
      <span class="hljs-string">"description"</span>: <span class="hljs-string">"生成技术文档"</span>
    }
  }
}

<span class="hljs-comment"># Step 3：使用多模型协作</span>

<span class="hljs-comment"># 让 coder 写代码</span>
<span class="hljs-string">" @coder 为我写一个 Vue3 的用户列表组件，使用 TypeScript，包含以下功能：
1. 数据获取（使用 useQuery）
2. 分页
3. 搜索
4. 每行操作（编辑、删除）"</span>

<span class="hljs-comment"># 让 reviewer 审查代码</span>
<span class="hljs-string">" @reviewer 审查刚才写的组件，检查：
1. TypeScript 类型安全
2. Vue 3 最佳实践
3. 性能问题
4. 可访问性（a11y）"</span>

<span class="hljs-comment"># 让 doc-writer 生成文档</span>
<span class="hljs-string">" @doc-writer 为这个组件生成技术文档，包括：
1. Props 说明
2. 使用示例
3. API 参考链接
4. 注意事项"</span>

<span class="hljs-comment"># 三个智能体并行工作，你可以在不同会话中查看结果</span>
</code></pre>
<h3 data-id="heading-20">落地步骤</h3>
<ol>
<li><strong>安装 OMO</strong>：按照官方文档安装 Oh My OpenCode</li>
<li><strong>配置智能体</strong>：为不同的任务配置专门的智能体</li>
<li><strong>定义工作流</strong>：创建常用的工作流模板（Skills）</li>
<li><strong>多模型协作</strong>：充分利用不同 AI 模型的优势</li>
</ol>
<h3 data-id="heading-21">避坑指南</h3>
<ul>
<li>❌ <strong>新手常犯</strong>：所有任务都用同一个模型，忽略不同模型的专长</li>
<li>✅ <strong>正确做法</strong>：GPT-4 擅长代码生成，Claude 擅长推理和审查，合理分配任务</li>
<li>⚠️ <strong>注意</strong>：后台任务会增加 API 调用成本，注意监控用量</li>
</ul>
<hr/>
<h2 data-id="heading-22">结尾</h2>
<p>三个月后，老赵的同事问他："你最近写代码怎么这么快了？"</p>
<p>老赵笑了笑："因为我有了 AI 开发团队。"</p>
<p>OpenCode + Oh My OpenCode，就像给你的电脑装了个虚拟团队。你要做的，就是学会指挥这个团队，而不是自己一个人单打独斗。</p>
<p>以前写一个功能要半天，现在 30 分钟搞定。以前代码 Review 要等同事，现在 AI 帮你审查。以前写文档像挤牙膏，现在 AI 一键生成。</p>
<p>关键是——你愿意尝试吗？</p>
<p>OpenCode 不是魔法，但用好了，开发效率提升 2-3 倍是真实的。就像当年 Git 刚出来时，很多人觉得"太复杂没必要"，现在呢？</p>
<p>你在 OpenCode 的使用中有哪些困惑？配置问题、智能体选择、还是 Oh My OpenCode 的使用？评论区交流，我们一起讨论。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[实现一个文字擦除效果]]></title>    <link>https://juejin.cn/post/7599483314160959507</link>    <guid>https://juejin.cn/post/7599483314160959507</guid>    <pubDate>2026-01-26T15:19:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599483314160959507" data-draft-id="7558284340574421034" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="实现一个文字擦除效果"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-01-26T15:19:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="剪刀石头布啊"/> <meta itemprop="url" content="https://juejin.cn/user/1855631360014798"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            实现一个文字擦除效果
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1855631360014798/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    剪刀石头布啊
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T15:19:01.000Z" title="Mon Jan 26 2026 15:19:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>动画实际上就是一个视觉欺骗功能，一个前端如果不会视觉欺骗，那么针对很多效果将会手无足措，实际上学习动画的过程中，也能更好理解视觉欺骗，实际开发一些场景也会有更多实现方案</p>
<p>这里的擦除效果，就是利用视觉欺诈实现一个文字擦除效果(前面写到的进度条也有视觉欺骗在里面)</p>
<p>核心原理，就是在文本上方放置同样的一个文本内容，设置颜色将其盖住，通过css属性动画逐步放开遮挡区间，这样看起来就像是文本逐渐展示了(实现是不是和看起来效果有点不太一样，这就是视觉欺骗了)</p>
<h2 data-id="heading-1">实现</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-string">"./App.css"</span>;

<span class="hljs-comment">//基础文本</span>
<span class="hljs-keyword">const</span> text = <span class="hljs-string">`
“再也不能骂人了！”近日，一条以“骂人也违法了
最高可判三年”为关键词的话题登上热搜，迅速引发公众热议。这背后，是自2026年1月1日起正式施行的新修订《治安管理处罚法》，言语威胁、辱骂他人可能构成违法！公然辱骂他人或捏造事实，造成重伤或死亡的还涉嫌犯罪。请谨言慎行，莫因“口无遮拦”承担法律责任。
法律依据 《中华人民共和国治安管理处罚法》（2026），第五十条规定：
有下列行为之一的，处五日以下拘留或者一千元以下罚款；情节较重的，处五日以上十日以下拘留，可以并处一千元以下罚款：
（一）写恐吓信或者以其他方法威胁他人人身安全的；
（二）公然侮辱他人或者捏造事实诽谤他人的；
（三）捏造事实诬告陷害他人，企图使他人受到刑事追究或受到治安管理处罚的；
（四）对证人及其近亲属进行威胁、侮辱、殴打或者打击报复的；
（五）多次发送淫秽、侮辱、恐吓等信息或者采取滋扰、纠缠、跟踪等方法，干扰他人正常生活的；
（六）偷窥、偷拍、窃听、散布他人隐私的。
有前款第五项规定的滋扰、纠缠、跟踪行为的，除依照前款规定给予处罚外，经公安机关负责人批准，可以责令其一定期限内禁止接触被侵害人。对违反禁止接触规定的，处五日以上十日以下拘留，可以并处一千元以下罚款。
《中华人民共和国刑法》第二百四十六条：
以暴力或者其他方法公然侮辱他人或者捏造事实诽谤他人，情节严重的，处三年以下有期徒刑、拘役、管制或者剥夺政治权利。
`</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-comment">//使用两个一摸一样的文本效果，这样更好盖住</span>
    <span class="hljs-comment">//为了能重合使用绝对定位来处理</span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"App"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"box"</span>&gt;</span>
        {text}
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"box"</span>&gt;</span>
        //不适用匿名盒子，是为了更好操作该行盒
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"earser"</span>&gt;</span>{text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
  );
}
</code></pre>
<p>css实现，除了使用行盒子实现背景的逐行变化，这里借助css自定义属性，来实现动画(毕竟动画只能应用css内置属性，不能直接应用变量)</p>
<p>ps：当然使用 background-position属性，就不用自定义属性了，容我装一下哈😄</p>
<pre><code class="hljs language-js" lang="js">.<span class="hljs-property">App</span> {
  <span class="hljs-attr">margin</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attr">color</span>: black;
  <span class="hljs-attr">position</span>: relative;
  <span class="hljs-attr">display</span>: block;
  <span class="hljs-attr">color</span>: #<span class="hljs-number">000</span>;
}

.<span class="hljs-property">box</span> {
  <span class="hljs-attr">position</span>: absolute;
  <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attr">bottom</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attr">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attr">right</span>: <span class="hljs-number">0</span>;
}

@property --per {
  <span class="hljs-attr">syntax</span>: <span class="hljs-string">'&lt;percentage&gt;'</span>;
  <span class="hljs-attr">inherits</span>: <span class="hljs-literal">false</span>;
  initial-<span class="hljs-attr">value</span>: <span class="hljs-number">5</span>%;
}

<span class="hljs-comment">//使用行盒子设置背景，才能达到我们想要的效果</span>
.<span class="hljs-property">earser</span> {
  --<span class="hljs-attr">per</span>: <span class="hljs-number">5</span>%;
  <span class="hljs-attr">color</span>: transparent;
  <span class="hljs-attr">background</span>: linear-<span class="hljs-title function_">gradient</span>(to right, transparent <span class="hljs-title function_">var</span>(--per), #fff <span class="hljs-title function_">calc</span>(<span class="hljs-title function_">var</span>(--per) + 100px));
  animation
  : earser 5s linear forwards;
}
<span class="hljs-comment">//关键帧动画</span>
@keyframes earser {
  to {
    --<span class="hljs-attr">per</span>: <span class="hljs-number">100</span>%;
  }
}
</code></pre>
<p>这是一个简易的部分擦除效果(gif懒得生成)</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/073d4b5d3c8b40268e57564343781e20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ymq5YiA55-z5aS05biD5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045541&amp;x-signature=feeDe0pkawqQkdh2mbn8A1l0BkY%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">最后</h2>
<p>思考一下，如果文本区域存在一个背景图的话，那么这种遮盖方式可能就不行了，这种情况怎么实现文字擦除效果么，不妨思考一下</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[企业权限系统性方案探究]]></title>    <link>https://juejin.cn/post/7599551824547905562</link>    <guid>https://juejin.cn/post/7599551824547905562</guid>    <pubDate>2026-01-26T15:22:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599551824547905562" data-draft-id="7599565587152748570" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="企业权限系统性方案探究"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-01-26T15:22:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="uzong"/> <meta itemprop="url" content="https://juejin.cn/user/372082495985181"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            企业权限系统性方案探究
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/372082495985181/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    uzong
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T15:22:32.000Z" title="Mon Jan 26 2026 15:22:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"「"}.markdown-body b:after,.markdown-body strong:after{content:"」"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><blockquote>
<p>作者：面汤放盐 || uzong</p>
</blockquote>
<h2 data-id="heading-0">1. 背景与意义</h2>
<p><strong>在数字化转型深入背景下，权限管理已从辅助功能升级为企业核心基础设施。传统模式因颗粒度粗、权限滥用、生命周期失控及系统割裂等问题，难以满足规模化与精细化管控需求，易引发安全与合规风险。</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/115c5200e42a431e8c85f02962767ebc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=xIfLlaeiO7a83LzWp68m3Cdk5j0%3D" alt="" loading="lazy"/></p>
<hr/>
<p><strong>本文旨在</strong> <strong>系统性、</strong> <strong>实操性、前瞻性地讨论企业级的权限建设，构建全维度、全⽣命周期的权限体系，应对数字化时代的安全挑战，为企业权限体系的⻓期演进提供⽅向。</strong></p>
<h2 data-id="heading-1">2. 企业管理数据难点</h2>
<p>企业管理数据面临诸多难点，<strong>主要表现为</strong>：权限模型与业务适配难、权限数据治理混乱、权限生命周期管理缺失、合规与审计压力大等。</p>
<p><strong>具体可归结为</strong>：适配难、数据乱、回收慢、留痕弱、审计难、集成散。<strong>因此，需要从</strong>统一权限模型、建立权限台账...等方向系统性推进</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e2f624c307840399dfbd9d2e798a494~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=8%2F7belrUnkyWQ%2FQ7h4I2dZLmmEc%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2">3. 核心目标</h2>
<p><strong>安全性：</strong> 实现权限“最⼩化分配、动态适配、全程可追溯”，防范权限滥⽤、数据泄露、越权操作等</p>
<p>风险，满⾜合规审计要求 <strong>。</strong></p>
<p><strong>精细化：</strong> 覆盖功能、数据、字段、接⼝全维度权限，⽀持多维度颗粒度控制，适配企业复杂组织架</p>
<p>构与业务场景。</p>
<p><strong>可管控：</strong> 建⽴全⽣命周期权限管理机制，实现权限从初始化到回收的闭环管理，提升权限运营效</p>
<p>率。</p>
<p><strong>可扩展：</strong> ⽀持业务模块新增、组织架构调整、⽤户量级扩张。****</p>
<p><strong>智能化：</strong> 融合零信任理念，实现基于身份、环境、⾏为的动态授权，降低⼈⼯运营成本</p>
<h2 data-id="heading-3">4. 权限核心构成</h2>
<p>基于企业架构视⻆，拆解功能权限、数据权限、字段权限、接⼝ 权限四⼤核⼼类型，明确每种权限的定义、颗粒度、设计原则与管理模式。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fdaf6efb7b945909e508b7b14b848a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=tJAI3IU6VUuw6R4VfE0Lm77F8jc%3D" alt="" loading="lazy"/></p>
<p>注：字段权限是数据权限在列维度上的具体体现</p>
<h3 data-id="heading-4">4.1. 功能权限</h3>
<p>功能权限的颗粒度直接决定管控精度，需结合企业业务复杂度、组织架构层级、风险等级设计分级颗粒</p>
<p>度，避免过粗导致权限滥⽤、过细增加管理成本。<strong>可以进一步细分：菜单、模块、按钮、操作。</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee925986b06a41eb8da39cd803d2e741~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=XEjRTCBb%2BBG1SL5cA4MWNFUowlk%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">4.2. 数据权限</h3>
<p><strong>数据权限是权限体系的核心层，通过精细化控制用户可访问的数据范围，确保“仅看所需”，有效防范核心数据泄露或篡改，保障数据安全、完整性与可用性。</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a446b4f64b384c43925a799186b617e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=9%2B6DmLaulqSd0JaXDtb0np0xD0Y%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">4.3. 字段与接口权限</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee5484e8842c4a568d2b8a6809e7b82a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=BshXD1va3833Cv9mtJfaPd3AxdA%3D" alt="" loading="lazy"/></p>
<p><strong>字段权限是权限体系的精细化管控层，通过字段级的脱敏、隐藏或只读控制，防止无关用户访问敏感信息（如身份证号、薪资等），在保障数据安全的同时，精准适配不同岗位的展示需求</strong></p>
<p><strong>接口权限是权限体系的边界层，用于控制“谁可以调用哪些接口”，防范非法访问与攻击，保障系统间及第三方集成的安全、合规与可控</strong></p>
<h3 data-id="heading-7">4.4. 四⼤权限的联动机制</h3>
<p><strong>功能、数据、字段与接口权限并非孤立，而是联动递进、协同管控的有机整体：功能权限是入口，数据与字段权限实现行级与列级的精准控制，接口权限保障系统边界安全，四者需在权限全生命周期中统一管理，确保策略一致、变更同步。</strong></p>
<h2 data-id="heading-8">5. 权限生命周期</h2>
<p>权限⽣命周期管理是指对权限从产⽣到消亡的全流程进⾏规范化管控，核⼼⽬标是实现权限“可管、可控、可追溯”，避免权限滥⽤、权限冗余、权限缺失等问题，保障权限体系的有序运营。</p>
<p><strong>权限初始化：体系构建基础，定义权限清单与⻆⾊。</strong></p>
<p><strong>权限申请：</strong> <strong>业务驱动，基于场景提交权限需求。</strong></p>
<p><strong>权限分配：</strong> <strong>标准化赋予，基于⻆⾊或规则批量分配。</strong></p>
<p><strong>权限授权：</strong> <strong>动态⽣效，⽀持静态与动态两种授权模式。</strong></p>
<p><strong>权限使⽤：</strong> <strong>⾏为管控，实时监控权限使⽤⾏为。</strong></p>
<p><strong>权限回收：闭环收尾，⽀持⾃动、⼿动、降级三种⽅式。</strong></p>
<p><strong>权限审计：合规监督，定期审计权限配置与使⽤情况。</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84d950c0a3d240cf898398faf439af2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=S2GbHkOF8srv6%2B%2BHLzLhX8BFQmM%3D" alt="" loading="lazy"/></p>
<hr/>
<p><strong>严控权限申请与分配入口:</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c34b294358dc4ded9195ed635d47696d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=kLlLSyE2ufG79veJY4V5O8OYAZg%3D" alt="" loading="lazy"/></p>
<p><strong>授权逻辑与行为管控:</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ace52469ce524b2ea02a4e997681afa0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=SIfBzQhTBvyfRL7ouRIm3KvB9W8%3D" alt="" loading="lazy"/></p>
<p><strong>清理冗余与合规审计:</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/119278e58ded438fa5d20d866306301f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=%2F2heik77whqU3ytyBZ7WJ3BJtZ0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-9">6. <strong>企业级权限体系的落地实现：以 RBAC 为基础的多维权限融合</strong></h2>
<p><strong>RBAC 以“用户–角色–权限”实现集中授权，适用于组织清晰的场景；ABAC 基于多维属性（用户、资源、环境）动态授权，灵活精细但复杂度高；实践中企业多采用 RBAC 为主、ABAC 为辅的混合模型，按数据敏感度与业务需求灵活组合，实现安全与效率的平衡。</strong></p>
<hr/>
<p><strong>接下来我们分析一下普通的企业管理后台页面</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31dac5c41b28463e81cbc89826d74314~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=Kmi9NckPqhKROdnENM9NzmflR%2Bg%3D" alt="" loading="lazy"/></p>
<p>⚠️ 有时候我们会将菜单和页面画等号，控制某个菜单约等于某个页面。 当然我们可以进一步将菜单和页面进一步细分。</p>
<p>大致对权限进行细分如下：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f04a3199d2f9466b98bd3505bca2a6a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=891cdOVOeuLZH3ODwqkn33uUIg8%3D" alt="" loading="lazy"/></p>





















<table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><strong>行级权限</strong></td><td>控制用户能看到哪些数据记录，数据记录的多少。例如：销售只能看到自己区域的客户数据；HR只能看到本部门员工信息</td></tr><tr><td><strong>列级权限</strong></td><td>控制用户能看到哪些字段。例如：普通员工看不到薪资字段，只有HR和财务可见</td></tr><tr><td>接口权限</td><td>控制后端接口的调用权限，防止越权操作，比如通过 postman 直接访问接口。例如：只有管理员才能调用 /api/deleteUser</td></tr></tbody></table>
<h3 data-id="heading-10">6.1. 功能权限设计</h3>
<p>RBAC是一套成熟的权限模型。在传统权限模型中，我们直接把权限赋予用户。而在RBAC中，增加了“角色”的概念，我们首先把权限赋予角色，再把角色赋予用户。这样，由于增加了角色，授权会更加灵活方便。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8aa0ff8d0b53427fb450013165ad7e71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=uQUVqwg0S8GNfSLsUY0sAWmgRvM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">6.2. RBAC 权限管理</h3>
<p>基于 RBAC 的权限体系已经非常成熟，绝大多数公司可以直接讨论模型。现代权限体系基于RBAC（基于角色的访问控制）模型，通过“用户-角色-权限”的映射，实现权限的标准化管理与快速分配。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3cfcfd137f534712a973aa1fe7c85e7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=s966aroN2y29z180D%2Blcus%2FTovQ%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-12">6.2.1. 基本权限模型</h4>
<p>RBAC(<code>Role-Based Access Control</code>)基于角色的权限控制。通过角色来管理用户的权限。即用户拥有角色，角色管理权限。构成 用户–角色–权限 的授权模型。在这种模型中通常设计为一对多</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edec03a4ff6e46b7aa61df7288695bdc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=8%2FSsrxml47MSeSwC3mztpCm4yxs%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-13">6.2.2. 用户组扩展</h4>
<p>角色可以理解为一定数量的权限的集合，权限的载体。<br/>
当用户的数量非常大时，要给系统每个用户逐一授权（授角色），是件非常烦琐的事情。这时，就需要给用户分组，每个用户组内有多个用户。除了可给用户授权外，还可以给用户组授权。<strong>这样一来，用户拥有的所有权限，就是用户个人拥有的权限与该用户所在用户组拥有的权限之和</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f593ecbe58294925ab9bc3733c33649e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=db5irSZMPfuSa7FxoPo2ptXxQpc%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-14">6.2.3. 资源扩展</h4>
<p>在应用系统中，权限表现成什么？对功能模块的操作，对上传文件的删改，菜单的访问，甚至页面上某个按钮、某个图片的可见性控制，都可属于权限的范畴。有些权限设计，<strong>会把功能操作作为一类，而把文件、菜单、页面元素等作为另一类</strong>，这样构成用户-角色-权限-资源的授权模型。<strong>而在做数据表建模时，可把功能操作和资源统一管理，也就是都直接与权限表进行关联，这样可能更具便捷性和易扩展性</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9590083bfedd47cd9f63f335d78de56f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=1vMGKQwD86Y7iwV1xyC%2FVhthd%2FI%3D" alt="" loading="lazy"/></p>
<hr/>
<p><strong>一个比较完整的 RBAC 模型算基本成型</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/911858b3749e45beb8426fa41b5d92df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=Xx5O69gXPM0bvfSfTTTqc9j6qMc%3D" alt="" loading="lazy"/></p>
<p><strong>基于RBAC的模型在实际应用中，会根据实际进行调整，</strong> <strong>比如引入各种"组"的概念，以及各种继承的概念。</strong></p>
<p><strong>目的是为了权限数据不膨胀、更好管控。</strong></p>
<hr/>
<h3 data-id="heading-15">6.3. 数据权限设计</h3>
<p>在实践中，常通过拦截器、AOP 或权限中间件对 SQL 进行动态改写，结合参数化查询确保安全性，实现低侵入的数据权限控制</p>
<p>数据权限模块的核心之中的一个就有SQL语句的高效解析处理，SQL处理指<strong>依据</strong>当前登录人信息及数据权限策略生成一个带有数据权限处理结果的SQL语句。所以这里对SQL语句的解析处理必需要求精确、准确。在开发阶段由开发者把 SQL 写入配置文件里，在执行阶段由数据权限取得该SQL进行分析处理（加上数据权限），这样就完成了SQL的组装处理</p>
<p>接下来举一个例子。先申明几个术语概念</p>
<ul>
<li><code>资源</code>：数据权限的控制对象，业务系统中的各种资源。比方订单单据、销售单等</li>
<li><code>主体</code>：用户、部门、角色等</li>
<li><code>条件规则</code>：用于检索数据的条件定义</li>
<li><code>数据规则</code>：用于【数据权限】的条件规则</li>
</ul>
<p>比如：针对数据权限的一个简单可视化</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18fa84def9bb4c21befa54a5b68284e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=jbIXzWX%2BqgYzfG8Zpx0iqrp%2FV3Q%3D" alt="" loading="lazy"/></p>
<p><strong>应用示例：</strong></p>
<ul>
<li>订单，可以由本人查看</li>
<li>销售单，可以由本人或上级领导查看</li>
<li>销售单，销售人员可以查看自己的，销售经理只查看 销售金额大于100,000的。<br/>
我们能想到直接的方法，在访问数据的入口加入SQL Where条件来实现，组织sql语句</li>
</ul>

<pre><code class="hljs language-ini" lang="ini">where <span class="hljs-attr">UserID</span> = {CurrentUserID}
where <span class="hljs-attr">UserID</span> = {CurrentUserID}  or {CurrentUserID} in (上级领导)
where <span class="hljs-attr">UserID</span> = {CurrentUserID}  or ({CurrentUserID} in (销售经理)  and 销售金额 &gt; <span class="hljs-number">100000</span>)
</code></pre>
<p>通过对 sql 进行改写，保障查询范围符合权限要求。</p>
<h3 data-id="heading-16">6.4. 自定义 schema 方式</h3>
<pre><code class="hljs language-json" lang="json">    <span class="hljs-attr">"datarule"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"rules"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"objectcode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"22"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"propertycode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"22"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"op"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"startwith"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"objectcode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"21"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"propertycode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"code"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"op"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"startwith"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"value"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"op"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"or"</span>
    <span class="hljs-punctuation">}</span>
</code></pre>
<p>可以通过解析一套自定义的 schema 来实现 SQL 的自定义解析，实现更加复杂的场景。</p>
<h3 data-id="heading-17">6.5. 字段权限</h3>
<p>如果说数据权限控制的是‘哪些行’（记录），字段权限控制的是‘哪些列’（属性），二者共同构成对数据表的二维精细管控。可以禁止指定用户/角色 对某些字段的访问。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/feab1d640d6345749334b70730c027ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=cqko9ijCAf4fb6SQwrILEifFRs4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-18">7. 企业业务权限管理（综合）</h2>
<p>如派拉软件提出的‘xBAC’（细粒度权限管理平台），支持 RBAC、ABAC 等多种模型融合，下图为综合案例：企业权限治理架构视图。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83c79b5e056c4b018d772656cad4ae7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=HFxqE3WJkrAHJM4huXn7Ie5KdzI%3D" alt="" loading="lazy"/></p>
<p>这类平台的核心逻辑正是前文所述的‘RBAC 为主、ABAC 为辅’的混合模型，同时叠加了更细粒度的场景化管控能力。</p>
<h2 data-id="heading-19">8. 总结和展望</h2>
<p>企业级权限体系需以“合规为底线、安全为核⼼、业务为导向、效率为⽬标”，构建管控框架，覆盖全⽣命周期，实现标准化、精细化管控，平衡安全防护与业务发展需求。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49bad8cc3c1a4b5584594b13abadab77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=sUuGPZ8BYdP7GySV3AmNA1G19C8%3D" alt="" loading="lazy"/></p>
<p><strong>企业级权限体系应以“合规为底线、安全为核心、业务为导向、效率为目标”，构建覆盖功能、数据、接口与操作的四维全生命周期管控框架。</strong></p>
<p><strong>未来将向智能化、轻量化、全场景化演进：依托AI与大数据实现权限智能推荐、风险主动防控与运维自治；结合隐私计算技术（如联邦学习、安全多方计算），探索“数据可用不可见”的协同访问模式，强化敏感数据脱敏、审计与合规能力。</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f07130983b8f419e99bed28d2b0a5ade~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770045751&amp;x-signature=vgNqtxAefNEn8wegWncKCwUaQtw%3D" alt="" loading="lazy"/></p>
<p><strong>企业级权限体系的建设与优化是⼀项⻓期持续的⼯作，需紧跟技术趋势与业务需求，不断迭代升级，才能为企业核⼼资产安全、业务合规⾼效开展提供坚实保障。</strong></p>
<h2 data-id="heading-20">9. 资料引用</h2>





























<table><thead><tr><th>描述</th><th>链接</th></tr></thead><tbody><tr><td>业权一体化白皮书</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.digitalelite.cn%2Fh-nd-4966.html" target="_blank" title="https://www.digitalelite.cn/h-nd-4966.html" ref="nofollow noopener noreferrer">www.digitalelite.cn/h-nd-4966.h…</a></td></tr><tr><td>万字长文：深入浅出RBAC权限设计</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.woshipm.com%2Fpd%2F5576757.html" target="_blank" title="https://www.woshipm.com/pd/5576757.html" ref="nofollow noopener noreferrer">www.woshipm.com/pd/5576757.…</a></td></tr><tr><td>RBAC 权限管理</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fqq_31156277%2Farticle%2Fdetails%2F81072833" target="_blank" title="https://blog.csdn.net/qq_31156277/article/details/81072833" ref="nofollow noopener noreferrer">blog.csdn.net/qq_31156277…</a></td></tr><tr><td>细粒度权限管理xBAC</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.paraview.cn%2Fidentity%2Fshow%2F37" target="_blank" title="https://www.paraview.cn/identity/show/37" ref="nofollow noopener noreferrer">www.paraview.cn/identity/sh…</a></td></tr><tr><td>2024云原生身份云 IDaaS 技术发展与应用白皮书</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.dtinsight.com.cn%2Fnd.jsp%3Fid%3D2761" target="_blank" title="https://www.dtinsight.com.cn/nd.jsp?id=2761" ref="nofollow noopener noreferrer">www.dtinsight.com.cn/nd.jsp?id=2…</a></td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[告别修图软件的图层噩梦，腾讯混元3.0让AI学会了“思考”]]></title>    <link>https://juejin.cn/post/7599502282602299455</link>    <guid>https://juejin.cn/post/7599502282602299455</guid>    <pubDate>2026-01-26T15:31:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599502282602299455" data-draft-id="7599511763987578934" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="告别修图软件的图层噩梦，腾讯混元3.0让AI学会了“思考”"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-01-26T15:31:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="墨风如雪"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            告别修图软件的图层噩梦，腾讯混元3.0让AI学会了“思考”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    墨风如雪
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T15:31:29.000Z" title="Mon Jan 26 2026 15:31:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>说实话，过去几年的AI修图体验，常常让人哭笑不得。</p>
<p>你扔给AI一张照片，说“把背景里的路人去掉”，结果它可能把主角的脸也换了一张，或者背景直接变成了一团难以名状的模糊色块。这就是传统AI的通病：听不懂人话，更不懂画面逻辑。</p>
<p>但在2026年1月26日，腾讯混元团队甩出了一张王炸——混元图像3.0图生图模型（HunyuanImage 3.0-Instruct）。这次更新，可能真的要让那些复杂的修图软件吃灰了。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2F640-1-1-1024x576.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/640-1-1-1024x576.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/156ea763d1ab41a7b30221e885809bf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770046289&amp;x-signature=PvZ%2FG639%2FwwNqZlCKRHYFiPwRY0%3D" alt="640 (1)" loading="lazy"/></a></p>
<h3 data-id="heading-0">它不再是瞎蒙，而是学会了“谋定而后动”</h3>
<p>这个模型最吓人的地方，不在于它生成的画质有多好（虽然确实很好），而在于引入了一种类似大语言模型的“思维链”机制。</p>
<p>简单来说，当你下达指令时，之前的AI是“听到命令直接动手”，而混元3.0是“先看图，再理解命令，然后在大脑里规划步骤，最后才动手”。</p>
<p>比如你给它一张风景照，说“把画面改成赛博朋克风格，但不要动那棵老树”。混元3.0会先进行感知分析，识别出“整体风格”需要变，但“老树”这个区域必须锁死。它在内部生成了一套详细的执行策略，明确了改哪里、保哪里。</p>
<p>这种“先思考，后执行”的逻辑，直接解决了AI修图最大的痛点：<strong>精准度</strong>。它能确保你在修改画面一部分时，其他不需要动的地方保持原汁原味，不会出现那种“修了个寂寞”或者“改得面目全非”的尴尬。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2F640-2-1-1024x576.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/640-2-1-1024x576.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a24d8abe84f4fb5a3b4ae625443b381~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770046289&amp;x-signature=TqJ2jF1S9dzKqy2EHdqrC2P4kh8%3D" alt="640 (2)" loading="lazy"/></a></p>
<h3 data-id="heading-1">800亿参数的“肌肉”与精打细算的架构</h3>
<p>在硬核参数上，腾讯这次也是下了血本。</p>
<p>这是一个拥有800亿（80B）总参数量的庞然大物。但作为技术观察者，我更感兴趣的是它的架构——混合专家模型（MoE）。</p>
<p>这意味着什么？意味着虽然它脑容量巨大，但它不会每次干活都把所有脑细胞调动起来。它在运行时只激活约130亿（13B）参数。这就好比一个拥有80个顶级专家的团队，遇到具体问题时，只派最懂行的那13个人出马。既保证了处理复杂任务的能力，又极大地提高了推理效率。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2F640-3-1024x576.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/640-3-1024x576.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a170340aeab462ab09b918ec0568db3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770046289&amp;x-signature=OVLtOw7%2B9izar7WxgkaxyFpprzs%3D" alt="640 (3)" loading="lazy"/></a></p>
<h3 data-id="heading-2">从“P图”进化到“创作”</h3>
<p>具体能干什么？如果你是做内容的，这简直是生产力解放。</p>
<p>首先是<strong>精细化编辑</strong>。不管是增删物体、老照片修复、人物换装，还是把一张平平无奇的照片瞬间变成水墨画，也就是一句话的事。甚至连图片里的文字都能改，这在以前往往需要专业设计师花不少时间。</p>
<p>其次是<strong>多图融合</strong>。这个功能非常惊艳。你可以把几张不同照片扔进去，让它提取其中的人物或元素，然后自然地融合在一张新图里。不是那种生硬的拼贴，而是光影、透视都完全协调的重新生成。想和二次元角色合影？或者把产品图完美融入特定的风景背景？它都能搞定。</p>
<h3 data-id="heading-3">背后的技术护城河</h3>
<p>为了训练这个“大脑”，腾讯构建了一个覆盖80多种细分任务、千万级别的专用数据集。更关键的是，他们采用了一种自研的MixGRPO算法。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2F640-4-1024x576.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/640-4-1024x576.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31e4ec29444849648e3813d1081f93d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770046289&amp;x-signature=iUq1lNMs5cpt7PE3UYMyXVvjGkw%3D" alt="640" loading="lazy"/></a></p>
<p>这个算法的作用，就是为了解决“听话”和“保真”之间的矛盾。它通过强化学习，不断纠正模型的行为，确保输出结果既符合你的修改意图，又不会破坏原图的和谐感。这就像是给AI请了一个严格的导师，时刻盯着它的作业，一旦画歪了立刻纠正。</p>
<h3 data-id="heading-4">写在最后</h3>
<p>目前，这个模型已经在腾讯的AI助手“元宝”全端和混元官网上线了。</p>
<p>如果你受够了在修图软件里为了抠图抠半天，或者为了调一个色调反复拉曲线，不妨去试试这个新家伙。在这个AI技术狂飙突进的时代，工具的进化不仅仅是为了偷懒，更是为了让我们把有限的精力，从繁琐的操作中解放出来，投入到更有价值的创意构思中去。</p>
<p>毕竟，让AI学会思考，是为了让我们更好地创造。</p>
<p><strong>如果你也对最新的AI信息感兴趣或者有疑问 都可以加入我的大家庭 第一时间分享最新AI资讯、工具、教程、文档 欢迎你的加入！！！😉😉😉</strong></p>
<p>公众号：墨风如雪小站</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[当32岁程序员离世后,他的HR同事说：“死在岗位上不遗憾”]]></title>    <link>https://juejin.cn/post/7599514071105929231</link>    <guid>https://juejin.cn/post/7599514071105929231</guid>    <pubDate>2026-01-26T15:32:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599514071105929231" data-draft-id="7599506068047560704" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="当32岁程序员离世后,他的HR同事说：“死在岗位上不遗憾”"/> <meta itemprop="keywords" content="程序员"/> <meta itemprop="datePublished" content="2026-01-26T15:32:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="修己xj"/> <meta itemprop="url" content="https://juejin.cn/user/2641475936724142"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            当32岁程序员离世后,他的HR同事说：“死在岗位上不遗憾”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2641475936724142/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    修己xj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T15:32:24.000Z" title="Mon Jan 26 2026 15:32:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>写完《别用命换工作：一位32岁程序员周末晕倒后猝死留给我们的生存思考》时，我以为高广辉的故事已经完整——一个年轻的生命在周末倒下，心脏停跳后，工作群的消息仍在冰冷地闪烁。</p>
<p>但我没有料到，这个故事背后，还有一段更令人心寒的独白。</p>
<p>在高广辉离开后，他公司的HR这样说道：</p>
<p><strong>“如果我死在自己热爱的岗位上，我不会有遗憾，也不希望我的家属拿着我的遗体去换钱。”</strong></p>
<p>这句话，像一记无声的钟，在空气中久久回响。它揭开了一层遮羞布，让我们不得不直视这个时代某些令人窒息的真相——<strong>畸形的职场文化</strong>，与<strong>资本冰冷的本质</strong>。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/654329eef9ea45509ad92687218706c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770046345&amp;x-signature=4WhXOcaKPsSVe2GeAKNOr05ndjY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">💻 公司是分布式系统，家庭却是单点服务</h2>
<p>程序员都理解高可用架构：系统中任何一个节点出现故障，都应能自动切换，确保业务永续。在职场上，我们每个人就是这样的“节点”。</p>
<p>公司是一台精密的分布式系统。你离开了，故障转移机制立即启动：招聘新节点、重新分配负载、系统继续运转。你的邮箱签名会被更新，工位会被清空，你写过的代码会被重构甚至覆盖。</p>
<p>然而在家庭这个“单点系统”里，你是无可替代的核心服务。没有备份，没有集群，一旦宕机，就是永久性的崩溃。</p>
<p>你是父母唯一的孩子，是爱人唯一的伴侣，是孩子唯一的依靠。这个系统没有弹性伸缩，没有灾备方案。</p>
<p><strong>公司离开谁都能转，可你的家庭不能。</strong></p>
<h2 data-id="heading-1">📉 最糟糕的“人生算法”：用不可再生的健康，换可替代的产出</h2>
<p>在计算机科学中，我们追求极致优化：更快、更高并发、更低延迟。然而在生活中，我们却常常陷入一场致命的算法错配：</p>
<p><strong>拿最不可再生的资源——健康与时间，去交换最可被替代的东西——工作产出。</strong></p>
<p>工作可以是使命、是热爱、是实现价值的路径，但它不该是生命的全部，更不该是人生的终点。</p>
<h2 data-id="heading-2">🍚 人生本可以很简单：不过一日三餐，一夜一床</h2>
<p>在代码世界里，我们追逐无限优化；而在真实的生活里，人的需求其实简单得令人清醒：</p>
<ul>
<li>每天不过三顿饭，未必需要珍馐美馔</li>
<li>每夜不过一张床，未必需要广厦万间</li>
<li>身边有爱的人，彼此温暖，未必需要完美无瑕</li>
</ul>
<p>我们被卷进一场没有终点的竞赛，却忘了生活原本的面貌，可以朴素而丰盈。</p>
<h2 data-id="heading-3">⚖️ 重新定义“热爱”：岗位之外，还有人间</h2>
<p>真正值得热爱的，是清晨照进窗棂的阳光，是孩子扑向你时的笑声，是父母电话里琐碎的叮咛，是爱人手心熟悉的温度，是与老友相聚时的畅怀，也是独自一人时内心的安宁。</p>
<p>工作可以是你表达热爱的一种方式，但绝不应成为热爱的全部对象。</p>
<h2 data-id="heading-4">❗公司仍在调度，但餐桌永远空了一个座位</h2>
<p>高广辉走了，工作群的消息依旧闪烁。这个残酷的画面提醒我们：公司不会为任何一个节点哀悼，它只会冷静地重新调度。</p>
<p>但他的家庭呢？那张永远空出一个位置的餐桌，那张再也不会有人躺卧的床，那些再也得不到回应的呼唤——这些，是任何技术都无法重构的损失。</p>
<h2 data-id="heading-5">📝最后，想说</h2>
<p>那位HR的话依然刺耳，但我想用另一段话作为回应：</p>
<p><strong>“如果我能在深爱的家人身旁离开，我不会遗憾。也不希望我的墓碑上，只刻着我在公司的工号。”</strong></p>
<p>因为生命的价值，从来不是由在岗位上燃烧的程度决定的，而是由我们在爱中给予和获得的温暖衡量的。</p>
<p>而这温暖——从不计入KPI，却是每个人活过一场最真实的明证。</p>
<p><strong>我们或许无法立刻改变系统，但我们可以先清醒地活着。</strong></p>
<p>在资本冰冷的逻辑与畸形的工作文化之外，别忘了：你的人生，始终该由你自己定义。<br/>
简单一点，真实一点，温暖一点。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc2c07cea4494873bac169192092849e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770046345&amp;x-signature=D5g5H5%2BJzeEEpGAyD7ab1PxEC5k%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[曾经最坚持手写代码的顶级黑客，被AI彻底收编了]]></title>    <link>https://juejin.cn/post/7599511763986563126</link>    <guid>https://juejin.cn/post/7599511763986563126</guid>    <pubDate>2026-01-26T11:06:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599511763986563126" data-draft-id="7599483794657148969" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="曾经最坚持手写代码的顶级黑客，被AI彻底收编了"/> <meta itemprop="keywords" content="AI编程,人工智能"/> <meta itemprop="datePublished" content="2026-01-26T11:06:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="童欧巴"/> <meta itemprop="url" content="https://juejin.cn/user/3491704662669469"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            曾经最坚持手写代码的顶级黑客，被AI彻底收编了
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3491704662669469/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    童欧巴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T11:06:00.000Z" title="Mon Jan 26 2026 11:06:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><p>最近读了一篇博客，看完后我盯着屏幕发了很久的呆。</p>
<p>作者是 Redis 之父 Salvatore Sanfilippo，网名 Antirez。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f97987a0fd045ef97f6d2e4df9ed958~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56ul5qyn5be0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770046740&amp;x-signature=JyLt1U0zcDq%2BT7PSi75KLECGOds%3D" alt="" loading="lazy"/></p>
<p>如果你不写代码，可能没听过这个名字，但他创造的 Redis 是整个互联网的基建。</p>
<p>你刷的每一条热搜，抢的每一个红包，点的每一个赞，背后几乎都有它的影子。</p>
<p>在我们程序员眼里，Antirez 除了是一位技术大神，更是一位纯粹且带着浪漫主义色彩的黑客。</p>
<p>2020 年，他在 Redis 的巅峰期突然宣布辞职。</p>
<p>理由酷得不行，他不想做一个每天开会协调，审查代码的管理者。</p>
<p>他想回去当一个写小说的，自由自在的艺术家。</p>
<p>但这几年，这位曾为了找回人性而逃离的顶级匠人，却因为 AI 重新杀回了代码世界。</p>
<p>他发现 AI 帮他接手了那些最消磨人的重复性劳动。</p>
<p>让他能再次像个诗人一样，直接把脑子里的灵感变成现实。</p>
<p>就是这样一位曾经最坚持手写代码的大佬，现在却平静地告诉大家。</p>
<p>除了图个乐呵，自己手写代码已经没啥意义了。</p>
<p>如果你也曾为未来感到焦虑，请务必读读这位顶级黑客的自述。</p>
<p>我将原文进行了翻译和润色，耐心读完，这也许会改变你对 AI 的认知。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4916ace9f6ee40a9945e559e3c6e2f98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56ul5qyn5be0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770046740&amp;x-signature=HxCOV8gMb7KqbNPsukzKvUTI3X8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">1</h2>
<p>我这辈子就爱写代码，一行一行地敲。</p>
<p>可以说，我职业生涯的全部努力，就是为了把软件写得精美精简。</p>
<p><strong>让代码透着一股人味儿，这才是它最核心的特质。</strong></p>
<p>同时，我也希望社会能多关注那些底层的人。</p>
<p>说实话，我根本不在乎 AI 公司能不能挣大钱，我甚至不在乎现有的经济体系会不会被掀翻。</p>
<p>真的，如果财富能大规模重新分配，我做梦都能笑醒。</p>
<p>但是，我不能为了情怀就蒙蔽了双眼。</p>
<p><strong>事实就是事实，AI 已经彻底改变了编程。</strong></p>
<p>2020 年的时候，我辞职去写小说，写 AI，写一个社会在面对自动化浪潮时的各种纠结。</p>
<p>2024 年底，我开了个 YouTube 频道，专门聊 AI 怎么写代码，聊它的社会影响。</p>
<p>虽然我预判得很早，但我以前总觉得，编程被彻底重塑怎么也得再等几年。</p>
<h2 data-id="heading-1">2</h2>
<p>现在我不这么想了。</p>
<p>最近这些顶尖的 AI 模型，只要你把需求点说到位。</p>
<p>它们基本能独立搞定大型任务或中型项目，完全不用人一直盯着。</p>
<p>这活儿干得好不好，取决于你写的代码类型。</p>
<p>越是逻辑解耦，越好用文字描述的就越好，比如系统级开发就很适合。</p>
<p>也取决于，你能不能把脑子里的逻辑清晰地传达给 AI。</p>
<p>但总的来说，现在形势已经很清楚了。</p>
<p><strong>对于大多数项目，除了为了图个乐呵，自己手写代码已经没啥意义了。</strong></p>
<p>就拿上周来说，我光靠写提示词，偶尔盯一眼，给点方向，几个小时就搞定了下面这四件事。</p>
<p>这要是搁以前，得干好几周。</p>
<ul>
<li>
<p>我给我的 linenoise 库加了 UTF-8 支持，还搞了个测试框架，用模拟终端来检测每个字符单元格的显示情况。这事儿我早就想干了，但以前总觉得为了个业余项目花这么多精力不划算。可现在，你只要动动嘴皮子把想法说出来，代码就直接成型了，这感觉完全不同。</p>
</li>
<li>
<p>我修了 Redis 测试里几个顽固的随机报错，这种活儿最恶心，全是些时序，TCP 死锁之类的事情。Claude Code 就在那儿不停地跑复现，翻看进程状态找原因，最后直接把 Bug 给修了。</p>
</li>
<li>
<p>昨天我想要一个纯 C 语言的库来跑类 BERT 模型的推理，Claude Code 五分钟就写完了。跑起来跟 PyTorch 一样稳，速度也就慢了 15%。整整 700 行代码，顺带还写了个 Python 工具来转换模型。</p>
</li>
<li>
<p>前几周我改了 Redis Streams 的底层逻辑，我手头有一份设计文档，我试着把它丢给 Claude Code，好家伙，它不到 20 分钟就把我干的活重做了一遍。甚至比我还快，主要是我看代码，点授权点得太慢了。</p>
</li>
</ul>
<h2 data-id="heading-2">3</h2>
<p>这就是现实，避无可避。</p>
<p>写代码这事儿，大部分时候已经不是刚需了。</p>
<p><strong>现在更有意思的是去琢磨，要做什么，和怎么做。</strong></p>
<p>而在怎么做这一点上，AI 也是个顶尖的拍档。</p>
<p>AI 公司能不能回本，股市会不会崩，长远看都不叫事儿。</p>
<p>某个独角兽公司的 CEO 说话是否靠谱，也无所谓。</p>
<p>编程这行，反正已经永远变样了。</p>
<p>你要问我，我写的代码被喂给了 AI，我心里膈应吗？</p>
<p>我觉得挺好的。</p>
<p><strong>我这辈子都在折腾代码，系统和知识的平权，AI 不过是这种理想的延续。</strong></p>
<p>它能帮我们写出更快更好的软件，让小团队也有底气跟大厂叫板，就像 90 年代的开源运动一样。</p>
<p>不过，这么关键的技术不能只攥在几家公司手里。</p>
<p>虽然现在闭源模型厉害点，但开源社区，尤其是中国的模型追得非常紧。</p>
<p>到目前为止，这种民主化做得还行，但我担心这种局面能不能长久。</p>
<p>不过话说回来，大规模神经网络确实能出奇迹，而且这里面并没有什么深不可测的魔法。</p>
<p>不然没法解释，为什么那几家巨头的模型水平能咬得这么死。</p>
<h2 data-id="heading-3">4</h2>
<p>作为一个程序员，我现在比以前更想搞开源了。</p>
<p>我想把那些因为没时间，而放弃了的项目捡起来。</p>
<p>我想把 AI 塞进我的 Redis 工作流，改进向量集合的实现，完善别的数据结构。</p>
<p>但，我确实为那些可能丢掉饭碗的伙计们感到焦虑。</p>
<p>未来究竟会如何，还未可知。</p>
<p>公司是会因为效率高了而招更多人去做大蛋糕，还是会为了省钱把程序员全裁了，只留几个会写提示词的？</p>
<p>我怕在很多领域，人类会变得完全多余，那社会该怎么办？</p>
<p>创新这玩意儿，是开弓没有回头箭的。</p>
<p>但我还是挺期待 AI 带来的好的一面，比如科学上的新进展，能帮人类少受点苦。</p>
<h2 data-id="heading-4">尾声</h2>
<p>行了，说回编程。</p>
<p>朋友，我就一个建议。</p>
<p><strong>不管你觉得理想的世界应该是啥样，你都没法通过拒绝现实去改变它。</strong></p>
<p><strong>死撑着不用 AI，对你的职业生涯一点好处都没有。</strong></p>
<p>动动脑子，认真试一下这些新工具。</p>
<p>多花几周去沉浸式体验，<strong>别试个五分钟就忙着给自己原有的偏见找补</strong>。</p>
<p>你要想办法让自己，<strong>一个人活成一支队伍</strong>。</p>
<p>如果现在觉得不好用，过几个月再试试。</p>
<p>你可能觉得，自己辛辛苦苦学了这么久编程，结果现在机器全代劳了。</p>
<p>但你想想，当年你熬夜写代码，看着项目跑通时，你心里那团火到底是因为什么？</p>
<p><strong>是因为，创造。</strong></p>
<p>现在，如果你能玩转 AI，你能构建出更多，更牛的东西。</p>
<p>那种乐趣，一点都没变。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OoderAgent V0.6.5 Nexus 重磅发布：开启超级智能体开发框架新纪元]]></title>    <link>https://juejin.cn/post/7599496293174853651</link>    <guid>https://juejin.cn/post/7599496293174853651</guid>    <pubDate>2026-01-26T16:00:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599496293174853651" data-draft-id="7599483794657951785" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OoderAgent V0.6.5 Nexus 重磅发布：开启超级智能体开发框架新纪元"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-01-26T16:00:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OoderAgent V0.6.5 Nexus 重磅发布：开启超级智能体开发框架新纪元
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T16:00:45.000Z" title="Mon Jan 26 2026 16:00:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读29分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言：</h2>
<pre><code class="hljs">  v0.6.5 使用了一个特别的代号，Nexus（枢纽）她不再是一次简单的技术升级。而是一次重生。cong 从0.6.2到0.6.5我们在AI的驱动先快速的迭代，从从基础架构到核心升级，再到技能统一提升，直到0.6.5 一次质的跃迁。本次版本以“构建个人超级终端、赋能全场景智能开发”为核心，重构技术架构、强化能力体系、拓展生态边界，为开发者提供一套从设备协同到AI能力编排的全链路智能体开发解决方案，标志着SuperAgent向“去中心化超级智能体底座”迈出关键一步。
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11bd9efb4a774d59a1b9021c4e8c92a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=KdRJ0kY9y4de%2BogEtCW364qZATo%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da4755ebdbe445a2b844190421c09f84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=8yhtmC87aQoZKQCQbgGFLoamxOU%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<h2 data-id="heading-1">一、Nexus版本核心定位</h2>
<p>“Nexus”意为连接点、核心枢纽，恰如其分地诠释了本版本的核心价值——作为超级智能体开发框架，它既是个人设备、AI能力、数据资源的连接中心，也是开发者快速构建、部署、迭代智能体应用的创新底座。无论是个人开发者打造专属智能工具，还是企业级团队搭建跨端协同智能系统，SuperAgent v0.6.5 都能提供灵活、高效、安全的技术支撑。</p>
<h2 data-id="heading-2">二、产品设计</h2>
<p>核心生态能力：① P2P设备自动发现，支持PC、手机、智能设备群跨端无缝协作；② 多语言SDK接入（Java、Python、JavaScript），适配各类开发场景；③ 第三方服务集成接口，可快速对接支付、地图、办公软件等外部服务；④ 支持私有化部署，满足企业级数据合规需求；⑤ 深度适配 <strong>ooder-agent-rad</strong> 可视化RAD工具，实现AI辅助设计与可视化开发的无缝衔接。</p>
<p><strong>生态配套工具推荐</strong>：ooder-agent-rad 是基于 SuperAgent 架构打造的 AIAgent 可视化编辑器，支持拖拽式界面设计、AI2UI 可视化操作与实时编辑部署。开发者可搭配 trae-solo 等 AI-IDE，通过本地 skills 桥接，实现从需求描述到界面生成的全流程智能化开发，大幅降低前端应用构建门槛。</p>
<h3 data-id="heading-3">２.1. SuperAgent v0.6.5 产品闭环图</h3>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6e4dbd9b2344e6b83319cea79d50155~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=NGz5n48GAbra8itIQ4UGOSC4qUg%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<ol>
<li><strong>开发者端</strong>：超级用户（开发者）通过技能开发、模板创建、测试验证和版本管理，完成技能的开发周期。</li>
<li><strong>工具链</strong>：提供AI-IDE、技能SDK、测试工具和部署工具，支持开发者的整个开发流程。</li>
<li><strong>能力中心（交换枢纽）</strong>：作为整个生态的核心交换枢纽，负责技能注册、模板管理、能力交换、权限控制和监控分析，实现技能的有效管理和交换。</li>
<li><strong>分发渠道</strong>：包括个人技能市场、企业应用商店、设备预装和API服务，将技能分发给不同类型的用户。</li>
<li><strong>用户端</strong>：最终用户通过技能发现、获取、使用和反馈评价，完成技能的使用周期，并将反馈传递给开发者，形成完整的闭环。</li>
</ol>
<p>产品闭环的核心价值：</p>
<ul>
<li><strong>完整的生态系统</strong>：从技能开发到最终使用，形成完整的闭环生态，确保技能的高质量和持续改进。</li>
<li><strong>能力中心作为交换枢纽</strong>：能力中心在整个闭环中起到关键的交换枢纽作用，连接开发者和用户，实现技能的有效管理和分发。</li>
<li><strong>开发者赋能</strong>：通过AI-IDE等工具，降低技能开发门槛，赋能开发者快速创建高质量的技能。</li>
<li><strong>用户价值最大化</strong>：通过多样化的分发渠道和个性化的技能推荐，确保用户能够发现和获取最适合自己的技能。</li>
<li><strong>持续改进机制</strong>：通过用户反馈和监控分析，不断优化技能和系统，提升整体生态的质量和价值。</li>
</ul>
<h3 data-id="heading-4">２.2个人应用为中心架构图（v0.6.5）</h3>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/650540430f4b40a18e9c524c2e2e118b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=vM3Ky7pXbJznOFQwRow5THhNerU%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<ol>
<li><strong>个人设备层</strong>：多终端协同，包括个人PC、智能手机、智能平板和其他智能设备，用户可在任一设备发起技能请求。</li>
<li><strong>本地执行层</strong>：优先处理，采用本地优先执行原则，将用户数据和计算优先保留在本地，包括本地技能库、本地计算单元、本地存储和本地AI模型，确保隐私保护和响应速度。</li>
<li><strong>P2P网络层</strong>：设备互联，基于P2P网络自组织理论，实现设备间的智能协同，包括P2P发现服务、技能分布式发现、设备状态同步和技能共享机制，形成去中心化的设备网络。</li>
<li><strong>核心服务层</strong>：能力管理，负责个人技能的全生命周期管理，包括个人技能管理、AI模型调度、技能流编排和数据安全管理，为个人用户提供个性化的AI能力。</li>
<li><strong>远程资源层</strong>：扩展能力，当本地资源不足时，通过安全的远程连接访问扩展能力，包括云端技能库、云端AI模型、第三方服务和分布式存储，实现能力的无缝扩展。</li>
</ol>
<p>v0.6.5 版本特性：</p>
<ul>
<li><strong>本地优先执行</strong>：将计算和数据优先保留在本地设备，仅在必要时使用远程资源，确保用户隐私和系统响应速度。</li>
<li><strong>P2P设备协同</strong>：实现设备间的智能发现和协同，用户可在任一设备访问和执行技能，形成个人设备生态。</li>
<li><strong>个人技能自主管理</strong>：用户完全控制自己的AI技能，可自主添加、删除、更新技能，实现个性化AI体验。</li>
<li><strong>智能模型调度</strong>：根据任务复杂度和设备能力，智能选择本地或云端AI模型，平衡性能和资源消耗。</li>
<li><strong>技能分布式发现</strong>：通过P2P网络实现技能的分布式发现和共享，拓展个人能力边界。</li>
</ul>
<p>​</p>
<h2 data-id="heading-5">三，增强企业能力中心</h2>
<h3 data-id="heading-6">３.１设计目标</h3>
<p>Ooder技能（AIBridge）中心的技术目标包括：</p>
<ul>
<li><strong>标准化技能定义</strong>：建立统一的技能接口和生命周期管理机制，确保技能的可移植性和可重用性。</li>
<li><strong>模块化应用构建</strong>：通过技能的组合和编排，构建模块化、可扩展的业务应用。</li>
<li><strong>系统扩展性增强</strong>：实现技能的插拔式架构，支持系统功能的动态扩展和升级。</li>
<li><strong>开发效率提升</strong>：利用模板系统和自动化工具，减少重复开发工作，加速应用交付。</li>
<li><strong>跨系统能力调用</strong>：通过 Skills Remote Bridge 方案，实现跨系统、跨平台的技能调用。</li>
</ul>
<h3 data-id="heading-7">３.1 定位</h3>
<p>Ooder技能（AIBridge）中心是 Ooder 框架的核心组件，作为企业级应用开发的能力管理系统，提供标准化的技能定义、管理和执行机制。</p>
<p>Ooder技能（AIBridge）中心的核心技术价值在于：</p>
<ul>
<li><strong>能力抽象与复用</strong>：将业务能力抽象为可重用的技能组件，提高代码复用率。</li>
<li><strong>接口标准化</strong>：定义统一的技能接口和生命周期管理，确保技能的互操作性。</li>
<li><strong>远程能力调用</strong>：通过 Skills Remote Bridge 实现跨系统、跨平台的技能调用。</li>
<li><strong>流程编排</strong>：支持技能的组合和编排，构建复杂的业务流程。</li>
</ul>
<h3 data-id="heading-8">３.３技术架构</h3>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c3072432f1e4d8abf4acf5ac42b3dda~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=8Y63C1BJVpy5VSvQYDyOw087h7s%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<ol>
<li><strong>接入层</strong>：负责外部请求的接入和路由，API Gateway 接收请求并路由到负载均衡，负载均衡将请求分发到各个服务。</li>
<li><strong>服务层</strong>：负责业务逻辑的实现，包括技能管理、技能执行、模板管理和技能调度服务。</li>
<li><strong>核心层</strong>：负责核心功能的实现，分为接口组件（技能接口、模板接口）、执行组件（SkillScheduler、SkillExecutor、SkillContext）和功能组件（Skills Remote Bridge、SkillFlow 执行引擎、表单引擎）。</li>
<li><strong>基础设施层</strong>：负责底层基础设施的提供，包括数据库（存储数据）、缓存（提高性能）和消息队列（异步通信）。</li>
</ol>
<p>​</p>
<p>​</p>
<h3 data-id="heading-9">３.４ SuperAgent Nexus企业级业务架构图</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b0f9df6a1af4ba28fe8cc9e3de0e344~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=Rpgb90rYaXflF%2FEZoorlhQcwYmE%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<p>​</p>
<ol>
<li><strong>用户中心层</strong>：多终端入口，包括个人PC、智能手机、平板电脑和智能设备群。</li>
<li><strong>接入层</strong>：安全网关与设备互联，包括Auth中心、API网关、SDK接入和P2P发现。</li>
<li><strong>核心层</strong>：智能体能力中枢，包含四大核心模块：Skill能力管理中心、LLM调度中心、DataServer数据中心和Skillflow调度中心。</li>
<li><strong>执行层</strong>：任务落地与技能调度，包括MCPAgent服务流入口、RouteAgent桥接转发、EndAgent执行单元和本地技能库。</li>
<li><strong>资源层</strong>：本地/云端算力支撑，包括本地存储、本地计算、云端资源和第三方服务。</li>
</ol>
<h3 data-id="heading-10">３.５ 核心链路</h3>
<p>Ooder技能（AIBridge）中心的核心链路遵循自顶向下的调用链，从任务初始化开始，逐级向下调用更具体的技能，最终完成任务执行。</p>
<h4 data-id="heading-11">３.５.1 执行流程</h4>
<ol>
<li><strong>任务初始化</strong>：接收用户输入的任务请求，包括目标类型、参数等</li>
<li><strong>模板识别</strong>：调用模板识别技能，确定使用哪种模板和执行策略</li>
<li><strong>参数提取</strong>：从用户输入和系统配置中提取模板所需的参数</li>
<li><strong>技能调度</strong>：根据任务类型，调度相应的一级技能</li>
<li><strong>子任务分解</strong>：一级技能将任务分解为多个子任务，调用相应的二级技能</li>
<li><strong>具体执行</strong>：二级技能调用三级技能完成具体的技术实现</li>
<li><strong>结果生成</strong>：根据模板和参数，生成最终的执行结果</li>
<li><strong>后处理</strong>：对生成的结果进行格式化、验证等后处理操作</li>
<li><strong>结果返回</strong>：将执行结果返回给用户或集成到系统中</li>
</ol>
<h4 data-id="heading-12">３.５.2 技能调度流程</h4>
<ol>
<li>应用层发送任务请求</li>
<li><code>SkillScheduler</code> 分析任务类型和需求</li>
<li>选择合适的技能组合</li>
<li>按顺序调度技能执行</li>
<li>汇总执行结果</li>
</ol>
<h4 data-id="heading-13">３.５.3 技能执行流程</h4>
<ol>
<li><code>SkillExecutor</code> 为技能创建执行环境</li>
<li>注入 <code>SkillContext</code> 和相关资源</li>
<li>执行技能的 <code>execute</code> 方法</li>
<li>捕获和处理执行异常</li>
<li>收集执行结果和日志</li>
<li>清理执行环境</li>
</ol>
<p>​</p>
<h3 data-id="heading-14">３.６ 核心功能</h3>
<p>Ooder技能（AIBridge）中心的核心功能包括：</p>
<ul>
<li><strong>技能管理</strong>：技能的注册、查询、更新、删除等生命周期管理。</li>
<li><strong>技能执行</strong>：技能的同步和异步执行，支持参数传递和结果返回。</li>
<li><strong>模板系统</strong>：支持多种模板类型（FTL、JSON 等），用于技能的生成和配置。</li>
<li><strong>Skills Remote Bridge</strong>：实现跨系统、跨平台的技能调用。</li>
<li><strong>SkillFlow 增强</strong>：支持技能的组合和编排，构建复杂的业务流程。</li>
<li><strong>表单增强</strong>：提供表单的快速构建和管理能力。</li>
<li><strong>插件机制</strong>：支持第三方插件的集成和扩展，增强系统功能。</li>
</ul>
<p>Ooder技能（AIBridge）中心是 Ooder 框架的核心组件，作为企业级应用开发的能力管理系统，提供标准化的技能定义、管理和执行机制。</p>
<p>Ooder技能（AIBridge）中心的核心技术价值在于：</p>
<ul>
<li><strong>能力抽象与复用</strong>：将业务能力抽象为可重用的技能组件，提高代码复用率。</li>
<li><strong>接口标准化</strong>：定义统一的技能接口和生命周期管理，确保技能的互操作性。</li>
<li><strong>远程能力调用</strong>：通过 Skills Remote Bridge 实现跨系统、跨平台的技能调用。</li>
<li><strong>流程编排</strong>：支持技能的组合和编排，构建复杂的业务流程。</li>
</ul>
<h3 data-id="heading-15">3.６.1 Skills Remote Bridge</h3>
<p>Skills Remote Bridge 是 Ooder技能（AIBridge）中心的核心功能，实现跨系统、跨平台的技能调用。主要包括：</p>
<ul>
<li><strong>远程技能注册</strong>：将远程系统的技能注册到本地技能中心，建立技能映射关系。</li>
<li><strong>远程技能调用</strong>：通过标准化的接口调用远程系统的技能，处理网络通信、参数转换等细节。</li>
<li><strong>技能结果同步</strong>：将远程技能的执行结果同步到本地，确保业务流程的连续性。</li>
<li><strong>错误处理与重试</strong>：处理远程调用过程中的错误，支持自动重试机制。</li>
<li><strong>性能优化</strong>：通过连接池、缓存等技术，优化远程调用的性能。</li>
</ul>
<p>Skills Remote Bridge 的实现基于标准的网络协议和序列化机制，支持多种远程调用方式，如 HTTP、RPC 等。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/844fb385069744868f2c301cb6f8ade9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=U8EIIwWu0SdhNCaZC5mkPJ8k5lg%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<p>​</p>
<ol>
<li>本地系统发送技能调用请求</li>
<li>Skills Remote Bridge 处理请求并转发到远程系统</li>
<li>远程系统执行技能</li>
<li>获取执行结果</li>
<li>远程系统返回执行结果给 Skills Remote Bridge</li>
<li>Skills Remote Bridge 处理结果并返回给本地系统</li>
<li>如有错误，Skills Remote Bridge 触发错误检测</li>
<li>重试机制重新发送请求</li>
</ol>
<p><strong>３.６.２ SkillFlow 增强</strong></p>
<p>killFlow 增强是 Ooder技能（AIBridge）中心的重要功能，支持技能的组合和编排，构建复杂的业务流程。主要包括：</p>
<ul>
<li><strong>可视化流程设计</strong>：提供图形化界面，方便用户设计和管理技能流。</li>
<li><strong>流程模板管理</strong>：支持流程模板的创建、修改、删除和复用。</li>
<li><strong>流程执行引擎</strong>：负责技能流的执行和调度，支持同步和异步执行模式。</li>
<li><strong>流程监控与分析</strong>：监控技能流的执行状态和性能，提供实时的执行信息和统计数据。</li>
<li><strong>异常处理机制</strong>：处理流程执行过程中的异常，支持异常捕获、重试和补偿。</li>
</ul>
<p>SkillFlow 增强的实现基于状态机和事件驱动架构，支持复杂业务流程的可视化定义和自动化执行。</p>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d94acf52892426eb6406f475b7d6648~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=3cP6X1UwQb4Z3aIKVZ9%2BuEGW3hA%3D" alt="开始节点启动流程 执行技能节点1 决策节点根据条件判断，条件满足则执行技能节点2 决策节点条件不满足则执行技能节点3 技能节点2执行完成后到达结束节点 技能节点3执行完成后到达结束节点" loading="lazy"/></p>
<p>​</p>
<h3 data-id="heading-16"><strong>3.６.３</strong> 表单增强</h3>
<p>表单增强是 Ooder技能（AIBridge）中心的重要功能，提供表单的快速构建和管理能力。主要包括：</p>
<ul>
<li><strong>表单模板管理</strong>：支持表单模板的创建、修改、删除和复用。</li>
<li><strong>动态表单生成</strong>：根据配置自动生成表单，支持多种表单控件和布局。</li>
<li><strong>表单验证</strong>：提供丰富的表单验证规则，确保数据的合法性。</li>
<li><strong>表单数据处理</strong>：处理表单提交的数据，支持数据转换、存储和关联。</li>
<li><strong>表单与技能集成</strong>：将表单与技能集成，实现表单操作触发技能执行。</li>
</ul>
<p>表单增强的实现基于模板系统和组件化架构，支持快速构建高质量的表单界面。</p>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb5f1d1db85e4310bb873770cda88135~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=uPrMuZgKAj9EE9zdpnUYnEfCHvo%3D" alt="选择合适的表单模板 根据模板动态生成表单 对用户输入进行表单验证，验证通过则进入数据处理 验证失败则返回重新生成表单 处理表单提交的数据 将表单与技能集成，触发技能执行 获取技能执行结果 根据技能执行结果更新表单" loading="lazy"/></p>
<h3 data-id="heading-17">3.６.４ 技能管理</h3>
<p>技能管理是 Ooder技能（AIBridge）中心的基础功能，负责技能的全生命周期管理。主要包括：</p>
<ul>
<li><strong>技能注册</strong>：将技能注册到技能中心，包括技能名称、描述、版本、接口定义等信息。</li>
<li><strong>技能查询</strong>：支持按名称、类型、标签等条件查询技能。</li>
<li><strong>技能更新</strong>：更新技能的信息和实现。</li>
<li><strong>技能删除</strong>：从技能中心移除技能。</li>
<li><strong>技能版本管理</strong>：支持技能的多版本管理，确保系统的稳定性和兼容性。</li>
</ul>
<p>技能管理服务提供 RESTful API 接口，方便开发者和系统集成。</p>
<h3 data-id="heading-18">3.６.５ 模板系统</h3>
<p>模板系统是 Ooder技能（AIBridge）中心的重要组成部分，负责技能的生成和配置。主要包括：</p>
<ul>
<li><strong>模板类型支持</strong>：支持多种模板类型，如 FTL（Freemarker）、JSON 等。</li>
<li><strong>模板管理</strong>：支持模板的注册、查询、更新和删除等生命周期管理。</li>
<li><strong>模板加载</strong>：支持多种模板加载方式，如本地文件、远程服务器、数据库等。</li>
<li><strong>模板渲染</strong>：根据模板和数据生成技能配置和代码。</li>
</ul>
<p>模板系统的实现基于 <code>SkillTemplateManager</code> 和 <code>TemplateLoader</code> 接口，支持模板的高效管理和加载。</p>
<p>​</p>
<h2 data-id="heading-19">四、A2UI一张画布</h2>
<p>　　Ooder 全栈开发框架的目标是简化个人应用开发流程，实现个人数字化转型。Ooder RAD（Rapid Application Development）可视化设计器作为 Ooder 框架的核心组件，在 v0.6.5 版本中，通过可视化界面设计、拖拽式操作和自动化代码生成，结合个人应用为中心的设计理念，为个人开发者提供快速、高效、低代码的开发体验。</p>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1de98d21d1b64dcab6ad37c614413e4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=NrMx%2F71WCf0PtySd1azgC4KX9EU%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<h3 data-id="heading-20">４.1 定位</h3>
<p>Ooder RAD 可视化设计器 v0.6.5 是 Ooder 框架的核心组件，作为个人应用开发的快速开发工具，提供可视化界面设计、拖拽式操作和自动化代码生成能力，围绕个人应用为中心的设计理念，实现个人数字化转型。</p>
<h4 data-id="heading-21">核心技术价值</h4>
<ul>
<li><strong>个人应用为中心</strong>：围绕个人用户需求，提供个性化的应用开发体验，支持个人数字化转型。</li>
<li><strong>开发效率提升</strong>：通过可视化设计和自动化代码生成，显著减少手动编码工作，加速应用开发和交付。</li>
<li><strong>技术门槛降低</strong>：提供低代码/无代码开发模式，让非技术人员也能参与应用开发，扩大开发人员范围。</li>
<li><strong>界面一致性</strong>：提供统一的界面设计规范和组件库，确保应用界面的一致性和专业性。</li>
<li><strong>组件复用</strong>：通过组件化开发和模板系统，提高代码复用率，减少重复开发工作。</li>
<li><strong>本地优先执行</strong>：采用本地优先执行原则，将数据和计算优先保留在本地设备，确保数据隐私和响应速度。</li>
<li><strong>P2P设备协同</strong>：支持个人设备间的智能发现和协同，实现跨设备的应用体验。</li>
<li><strong>前后端一体化</strong>：与 Ooder 技能（AIBridge）中心无缝集成，实现前后端能力的统一管理和调用。</li>
</ul>
<h3 data-id="heading-22">４.２ 核心功能</h3>
<ul>
<li><strong>个人应用为中心</strong>：围绕个人用户需求，提供个性化的应用开发体验。</li>
<li><strong>可视化界面设计</strong>：提供拖拽式界面设计工具，支持多种布局和组件。</li>
<li><strong>组件库管理</strong>：提供丰富的可重用组件库，支持自定义组件的开发和管理。</li>
<li><strong>自动化代码生成</strong>：根据可视化设计自动生成前端代码，支持多种前端框架。</li>
<li><strong>模板系统</strong>：提供多种应用模板，支持快速创建应用。</li>
<li><strong>实时预览</strong>：提供实时预览功能，让开发者即时查看设计效果。</li>
<li><strong>本地优先执行</strong>：采用本地优先执行原则，将数据和计算优先保留在本地设备。</li>
<li><strong>P2P设备协同</strong>：支持个人设备间的智能发现和协同，实现跨设备的应用体验。</li>
<li><strong>版本控制</strong>：支持应用版本的管理和回滚。</li>
<li><strong>个人团队协作</strong>：支持小型团队的协同开发和设计。</li>
<li><strong>与能力中心集成</strong>：与 Ooder 技能（AIBridge）中心无缝集成，实现前后端能力的统一管理和调用。</li>
</ul>
<h3 data-id="heading-23">４.3. 核心功能</h3>
<p>４.3.1 个人应用为中心设计</p>
<p>个人应用为中心设计是 Ooder RAD 可视化设计器 v0.6.5 的核心功能，围绕个人用户需求，提供个性化的应用开发体验。主要包括：</p>
<ul>
<li><strong>个性化模板</strong>：提供基于个人场景的应用模板，如个人助手、健康管理、学习工具等。</li>
<li><strong>个人数据管理</strong>：支持个人数据的本地存储和管理，确保数据隐私。</li>
<li><strong>个人设备适配</strong>：支持多种个人设备的界面适配，确保跨设备的一致性体验。</li>
<li><strong>个人技能集成</strong>：与个人技能库集成，支持个性化技能的调用和管理。</li>
<li><strong>个人偏好设置</strong>：支持个性化的设计器设置，如主题、布局、组件库等。</li>
</ul>
<p>个人应用为中心设计的实现基于个人用户画像和行为分析，提供智能化的个性化推荐。</p>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ee70eb56b37496a9ea8782481d4deb3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=Y0T0fw4MlunojiwtoyFNmte3apE%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<ol>
<li>打开 RAD 可视化设计器</li>
<li>选择合适的应用模板创建项目</li>
<li>通过拖拽方式添加和排列组件，设计应用界面</li>
<li>调整组件的样式和属性</li>
<li>为组件绑定事件和交互逻辑</li>
<li>实时预览设计效果</li>
<li>自动生成前端代码</li>
<li>部署应用并上线</li>
<li>根据用户反馈持续优化设计流程</li>
</ol>
<p>４.３.2 组件库管理</p>
<p>组件库管理是 Ooder RAD 可视化设计器的重要功能，提供丰富的可重用组件库，支持自定义组件的开发和管理。主要包括：</p>
<ul>
<li><strong>基础组件</strong>：提供按钮、输入框、下拉框、复选框等基础 UI 组件。</li>
<li><strong>布局组件</strong>：提供容器、网格、卡片、导航栏等布局组件。</li>
<li><strong>高级组件</strong>：提供表格、表单、图表、地图等高级功能组件。</li>
<li><strong>业务组件</strong>：提供基于行业场景的业务组件，如审批流程、数据看板等。</li>
<li><strong>自定义组件</strong>：支持开发者创建和管理自定义组件，扩展组件库。</li>
<li><strong>组件分类</strong>：支持组件的分类管理，方便开发者查找和使用。</li>
</ul>
<p>组件库管理的实现基于组件化开发理念，支持组件的版本管理和依赖管理。</p>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8456a960d69469ca8ec2bc200eaafc1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=%2FlVrkmYCkwpM3%2FFHAd7dAncHeTc%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<ol>
<li>组件库包含基础组件、高级组件、业务组件和自定义组件</li>
<li>组件库支持组件的分类管理</li>
<li>开发者在应用设计过程中使用组件库中的组件</li>
<li>根据使用反馈对组件进行优化</li>
<li>更新组件库中的组件，形成迭代循环</li>
</ol>
<h3 data-id="heading-24">４.3.3 自动化代码生成</h3>
<p>自动化代码生成是 Ooder RAD 可视化设计器的核心功能，根据可视化设计自动生成前端代码，支持多种前端框架。主要包括：</p>
<ul>
<li><strong>多框架支持</strong>：支持生成 Vue、React、Angular 等多种前端框架的代码。</li>
<li><strong>代码质量保证</strong>：生成的代码符合行业标准和最佳实践，确保代码的可维护性和性能。</li>
<li><strong>自定义模板</strong>：支持自定义代码生成模板，满足不同项目的需求。</li>
<li><strong>代码预览</strong>：提供生成代码的预览功能，让开发者了解生成的代码结构。</li>
<li><strong>代码导出</strong>：支持将生成的代码导出为项目文件，方便开发者进行进一步的修改和部署。</li>
</ul>
<p>自动化代码生成的实现基于模板引擎和代码生成器，支持代码的增量生成和更新。</p>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e33e18ff0574d44b0838ec23bd4cfd5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=gXEQCbwPCllZvZRbezZNecHXWKM%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<ol>
<li>解析可视化设计的结构和组件</li>
<li>分析组件的属性和事件</li>
<li>根据选择的前端框架确定代码生成策略</li>
<li>选择合适的代码生成模板</li>
<li>生成前端代码</li>
<li>对生成的代码进行优化和格式化</li>
<li>预览生成的代码</li>
<li>导出代码为项目文件</li>
<li>构建项目并部署应用</li>
<li>根据使用反馈优化代码生成模板</li>
<li>更新代码生成模板，形成持续优化循环</li>
</ol>
<h3 data-id="heading-25">４.3.4 模板系统</h3>
<p>模板系统是 Ooder RAD 可视化设计器的重要组成部分，提供多种应用模板，支持快速创建应用。主要包括：</p>
<ul>
<li><strong>应用模板</strong>：提供完整的应用模板，如管理后台、电商网站、移动应用等。</li>
<li><strong>页面模板</strong>：提供常用的页面模板，如登录页、首页、详情页、列表页等。</li>
<li><strong>组件模板</strong>：提供常用的组件组合模板，如表单、表格、导航等。</li>
<li><strong>模板管理</strong>：支持模板的创建、修改、删除和复用。</li>
<li><strong>模板分享</strong>：支持模板的分享和导入，促进团队协作和知识共享。</li>
</ul>
<p>模板系统的实现基于模板引擎和版本控制系统，支持模板的版本管理和依赖管理。</p>
<h3 data-id="heading-26">４.3.5 实时预览</h3>
<p>实时预览是 Ooder RAD 可视化设计器的重要功能，提供实时预览功能，让开发者即时查看设计效果。主要包括：</p>
<ul>
<li><strong>实时同步</strong>：设计变更实时反映到预览界面，无需手动刷新。</li>
<li><strong>多设备预览</strong>：支持在不同设备尺寸下预览应用效果，确保响应式设计的正确性。</li>
<li><strong>交互预览</strong>：支持预览应用的交互效果，如点击、悬停、表单提交等。</li>
<li><strong>数据模拟</strong>：支持模拟数据，让开发者在没有后端服务的情况下也能预览应用效果。</li>
</ul>
<p>实时预览的实现基于浏览器的实时通信技术和前端框架的热更新机制。</p>
<h3 data-id="heading-27">４.3.6 本地优先执行</h3>
<p>本地优先执行是 Ooder RAD 可视化设计器 v0.6.5 的核心功能，采用本地优先执行原则，将数据和计算优先保留在本地设备。主要包括：</p>
<ul>
<li><strong>本地数据存储</strong>：优先使用本地文件系统和本地数据库存储应用数据，确保数据隐私和离线访问能力。</li>
<li><strong>本地计算执行</strong>：将应用的计算逻辑优先在本地设备执行，减少网络依赖和响应延迟。</li>
<li><strong>本地缓存优化</strong>：实现智能本地缓存策略，缓存常用数据和计算结果，提高应用性能。</li>
<li><strong>离线模式支持</strong>：支持应用在离线状态下正常运行，当网络恢复时自动同步数据。</li>
<li><strong>数据隐私保护</strong>：通过本地存储和加密技术，确保用户数据的安全性和隐私性。</li>
</ul>
<p>本地优先执行的实现基于现代前端框架的离线能力和本地存储技术，如 IndexedDB、Service Worker 等。</p>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40e410523667488895b9b9297a8f35ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=VbwrMtyodwU%2BaQMOFlGiwSoO8xQ%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<ol>
<li>应用启动时检查网络状态</li>
<li>无论网络状态如何，都优先使用本地执行引擎</li>
<li>读取数据时，优先使用本地数据</li>
<li>如果本地数据不存在，则从云端获取并同步到本地</li>
<li>执行计算逻辑，优先在本地执行</li>
<li>更新数据时，优先存储到本地</li>
<li>当网络可用时，将本地数据同步到云端</li>
</ol>
<h3 data-id="heading-28">４.3.7 P2P设备协同</h3>
<p>P2P设备协同是 Ooder RAD 可视化设计器 v0.6.5 的核心功能，支持个人设备间的智能发现和协同，实现跨设备的应用体验。主要包括：</p>
<ul>
<li><strong>设备自动发现</strong>：支持个人设备间的自动发现和识别，无需手动配置。</li>
<li><strong>设备状态同步</strong>：实现设备间的状态同步，确保应用在不同设备上的一致性体验。</li>
<li><strong>任务分发与协同</strong>：支持将复杂任务分发到多个设备执行，实现设备间的协同工作。</li>
<li><strong>数据安全传输</strong>：采用加密技术确保设备间数据传输的安全性。</li>
<li><strong>设备能力感知</strong>：自动感知设备的硬件能力，根据设备能力分配适合的任务。</li>
</ul>
<p>P2P设备协同的实现基于 WebRTC、蓝牙等点对点通信技术，支持设备间的直接通信和数据传输。</p>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d61c726fed2a4b088c694a2c5cb4c19b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=ZkMNOHEDAATI%2BvOXVIQOAnv5sKA%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<ol>
<li>主设备在设备网络中发现其他设备</li>
<li>主设备将任务分发给从设备</li>
<li>从设备执行分配的任务</li>
<li>从设备将执行结果返回给主设备</li>
<li>主设备汇总所有任务结果</li>
<li>主设备与从设备保持状态同步，确保应用体验的一致性</li>
</ol>
<p>​</p>
<h3 data-id="heading-29">４.3.8 与能力中心集成</h3>
<p>与能力中心集成是 Ooder RAD 可视化设计器的重要功能，与 Ooder 技能（AIBridge）中心无缝集成，实现前后端能力的统一管理和调用。主要包括：</p>
<ul>
<li><strong>技能可视化配置</strong>：通过可视化界面配置和调用 Ooder 技能（AIBridge）中心的技能。</li>
<li><strong>前后端一体化</strong>：实现前端界面与后端技能的无缝对接，简化前后端集成。</li>
<li><strong>技能流编排</strong>：通过可视化界面编排技能流，实现复杂业务流程的自动化。</li>
<li><strong>数据绑定</strong>：支持将前端组件与后端技能的数据输出进行绑定，实现数据的自动同步。</li>
</ul>
<p>与能力中心集成的实现基于 Ooder 技能（AIBridge）中心的 API 和 SDK，支持技能的可视化配置和调用。</p>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64f4535a88964f26ae19179bd4dad7c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=agiTMQ%2FK6xD4ckTHhaeJk1%2Fw6Vk%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<ol>
<li>在 RAD 设计器中通过可视化界面配置技能调用</li>
<li>发送技能调用请求到能力中心</li>
<li>能力中心执行相应的技能</li>
<li>技能执行完成后返回数据响应</li>
<li>将返回的数据绑定到前端组件</li>
<li>在应用界面中展示数据</li>
</ol>
<h2 data-id="heading-30">４.4. RAD技术架构</h2>
<h3 data-id="heading-31">4.41.设计</h3>
<p>Ooder RAD 可视化设计器 v0.6.5 采用分层设计架构，主要分为以下几层：</p>
<ul>
<li><strong>个人设备层</strong>：负责个人设备的接入和管理，包括PC、智能手机、平板等多种设备。</li>
<li><strong>接入层</strong>：负责用户界面的渲染和交互，包括设计器界面、预览界面等。</li>
<li><strong>核心层</strong>：负责核心功能的实现，包括拖拽引擎、组件管理、代码生成、本地执行引擎等。</li>
<li><strong>服务层</strong>：负责业务逻辑的实现，包括项目管理、模板管理、资源管理、P2P协同服务等。</li>
<li><strong>集成层</strong>：负责与外部系统的集成，包括与 Ooder 技能（AIBridge）中心的集成、与版本控制系统的集成等。</li>
<li><strong>基础设施层</strong>：负责底层基础设施的提供，包括本地文件系统、本地数据库、云端存储等。</li>
</ul>
<h3 data-id="heading-32">4.4.2 核心链路</h3>
<p>Ooder RAD 可视化设计器 v0.6.5 的核心链路遵循从设计到生成的流程，从用户的可视化设计开始，经过组件分析、模板选择、代码生成等步骤，最终生成可部署的应用代码。</p>
<h4 data-id="heading-33">设计流程</h4>
<ol>
<li><strong>项目创建</strong>：用户选择模板创建新项目</li>
<li><strong>界面设计</strong>：用户通过拖拽方式设计应用界面</li>
<li><strong>组件配置</strong>：用户配置组件的属性和样式</li>
<li><strong>事件绑定</strong>：用户为组件绑定事件和交互逻辑</li>
<li><strong>数据绑定</strong>：用户绑定后端数据和技能调用</li>
<li><strong>实时预览</strong>：用户实时预览设计效果</li>
<li><strong>代码生成</strong>：系统自动生成前端代码</li>
<li><strong>项目导出</strong>：用户导出项目代码进行部署</li>
</ol>
<h4 data-id="heading-34">组件管理流程</h4>
<ol>
<li><strong>组件注册</strong>：组件开发者注册新组件到组件库</li>
<li><strong>组件分类</strong>：系统对组件进行分类管理</li>
<li><strong>组件使用</strong>：用户在设计过程中使用组件</li>
<li><strong>组件更新</strong>：组件开发者更新和优化组件</li>
<li><strong>组件版本管理</strong>：系统管理组件的版本和依赖</li>
</ol>
<p>​</p>
<h4 data-id="heading-35">核心层与接入层交互</h4>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5bc79a9f102b47bf87507e86951bad31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=fN0vf4bMUksXA9LXLJUz%2B8asUf8%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<p>​</p>
<h4 data-id="heading-36">服务层与核心层交互</h4>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ff53396bb6b40259a7018d20e037c78~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=9esgEsnDfCpWp5XYpGkYdXvEHJY%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<h4 data-id="heading-37">集成层与服务层交互</h4>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/092a316911ae48d79c43054385efb703~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=OZTaSVqmSWdLKN4orodKowqp3eI%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<h4 data-id="heading-38">基础设施层与服务层交互</h4>
<p>​</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5239847a3d5f47938e6601f25b611e26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770048055&amp;x-signature=%2F7SLG2Ot1yAy8q4d23cZ4dFFXHM%3D" alt="请在此添加图片描述" loading="lazy"/></p>
<p>架构图说明：</p>
<ol>
<li><strong>个人设备层</strong>：负责个人设备的接入和管理，包括PC、智能手机、平板等多种设备，支持跨设备访问和协同。</li>
<li><strong>接入层</strong>：负责用户界面的渲染和交互，包括设计器界面、预览界面和代码预览。</li>
<li><strong>核心层</strong>：负责核心功能的实现，包括拖拽引擎、组件管理、代码生成器、模板引擎、实时预览服务和本地执行引擎。</li>
<li><strong>服务层</strong>：负责业务逻辑的实现，包括项目管理服务、模板管理服务、资源管理服务、版本控制服务和P2P协同服务。</li>
<li><strong>集成层</strong>：负责与外部系统的集成，包括能力中心集成、版本控制系统集成和云服务集成。</li>
<li><strong>基础设施层</strong>：负责底层基础设施的提供，包括本地文件系统、本地数据库、云端存储、本地缓存和 CDN。</li>
</ol>
<h3 data-id="heading-39">4.4.4 组件</h3>
<p>Ooder RAD 可视化设计器 v0.6.5 的主要组件包括：</p>
<ul>
<li><strong>拖拽引擎</strong>：负责处理用户的拖拽操作，实现组件的添加、移动和调整。</li>
<li><strong>组件管理</strong>：负责组件的注册、分类、版本管理和依赖管理。</li>
<li><strong>代码生成器</strong>：负责根据可视化设计自动生成前端代码，支持多种前端框架。</li>
<li><strong>模板引擎</strong>：负责管理和渲染应用模板、页面模板和组件模板。</li>
<li><strong>实时预览服务</strong>：负责实时预览设计效果，支持多设备预览和交互预览。</li>
<li><strong>本地执行引擎</strong>：负责应用的本地执行，包括本地数据存储、本地计算和离线模式支持。</li>
<li><strong>项目管理服务</strong>：负责项目的创建、保存、更新和删除。</li>
<li><strong>模板管理服务</strong>：负责模板的创建、保存、更新和删除。</li>
<li><strong>资源管理服务</strong>：负责管理项目的资源文件，如图片、字体、样式等。</li>
<li><strong>版本控制服务</strong>：负责项目和组件的版本管理和回滚。</li>
<li><strong>P2P协同服务</strong>：负责设备间的智能发现和协同，实现跨设备的应用体验。</li>
<li><strong>能力中心集成</strong>：负责与 Ooder 技能（AIBridge）中心的集成，实现前后端能力的统一管理和调用。</li>
</ul>
<h2 data-id="heading-40">五、典型开发场景演示</h2>
<h3 data-id="heading-41">场景1：AI-IDE智能应用开发（个人开发者场景）</h3>
<p>基于SuperAgent Nexus，开发者可快速搭建AI辅助开发工具，实现“需求描述-架构设计-代码生成-部署测试”全流程自动化：</p>
<ol>
<li>开发者在PC端通过自然语言输入应用需求（如“开发一个本地文件分类工具”）；</li>
<li>LLM调度中心生成应用架构设计，Skillflow自动串联“需求解析-代码生成-本地部署-测试验证”技能流；</li>
</ol>
<p>A2UI技能生成前端界面代码，也可直接调用 ooder-agent-rad 完成可视化界面拖拽设计，后端技能生成文件处理逻辑，本地部署技能将应用部署至PC端；</p>
<ol>
<li>开发者通过手机端实时查看部署进度，测试技能自动完成功能校验，生成测试报告。</li>
</ol>
<h3 data-id="heading-42">场景2：跨端自动化协作（企业办公场景）</h3>
<p>开发者可基于框架搭建企业级智能协作助手，实现多设备、多角色的任务协同：</p>
<p>通过Skillflow编排“会议记录生成-任务分配-进度追踪-结果同步”工作流，会议结束后自动将录音转文字（本地技能），分配任务至成员手机端，实时同步进度至PC端办公软件，最终生成协作报告存储至数据中心。</p>
<p>​</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI 的逐步进化：从被动的“思考者”到主动的“行动者”]]></title>    <link>https://juejin.cn/post/7599506068047249408</link>    <guid>https://juejin.cn/post/7599506068047249408</guid>    <pubDate>2026-01-26T14:21:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599506068047249408" data-draft-id="7599506068047200256" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI 的逐步进化：从被动的“思考者”到主动的“行动者”"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-01-26T14:21:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="叶子的技术碎碎念"/> <meta itemprop="url" content="https://juejin.cn/user/2831954919569245"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI 的逐步进化：从被动的“思考者”到主动的“行动者”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2831954919569245/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    叶子的技术碎碎念
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T14:21:56.000Z" title="Mon Jan 26 2026 14:21:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>如今大模型已经火热了两三年，发展得也越来越快，已经不仅仅停留在聊天机器人和文本生成工具上。虽然你输入问题，它给出答案。这种交互模式已经很有用了，但也仅此而已，现在的AI的使用方式跟GPT3.5刚出来的时候已经完全不一样了，无论是dify、coze这些平台，还是Codex、Claude Code等开发者工具，都在以不一样的方式来改变我们的生活。</p>
<p>最近，来自UIUC、Meta、亚马逊、谷歌DeepMind、UCSD和耶鲁大学的研究人员对目前的智能体推理系统进行了系统化的总结、形式化定义和框架构建，这篇论文就是 <a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2601.12538" target="_blank" title="https://arxiv.org/pdf/2601.12538" ref="nofollow noopener noreferrer">Agentic Reasoning for Large Language Models</a>。核心想法很简单：</p>
<p>"Rather than passively generating sequences, LLMs are reframed as autonomous reasoning agents that plan, act, and learn through continual interaction with their environment. This refraining unifies reasoning with acting, positioning reasoning as the organizing principle for perception, planning, decision, and verification."</p>
<p>AI不再只是处理输入然后输出结果，而是可以主动规划、执行任务、从反馈中学习。下面简单总结下这篇论文的主要内容：</p>
<h2 data-id="heading-0">一：从静态计算到动态交互</h2>
<p>传统LLM的工作方式是扩展测试时计算（scaling test-time computation）：输入问题，模型内部计算，输出答案。整个过程是一次性的。</p>
<p>智能体推理不同。它强调扩展测试时互动（scaling test-time interaction）。AI被放在一个环境中，通过多轮交互来完成任务。它可以尝试、观察结果、调整策略，然后再尝试。</p>
<p>两者的区别：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f106360741d04710977ca2726843e9d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25a2Q55qE5oqA5pyv56KO56KO5b-1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770042116&amp;x-signature=He0jwc3e9%2BJ%2BRfOxaPB6iRuFQPs%3D" alt="" loading="lazy"/></p>
<p>这个变化意味着AI的能力不再取决于它记住了多少知识，而是取决于它能否在实际环境中找到信息、使用工具、根据反馈调整方法。</p>
<h2 data-id="heading-1">二：AI可以从错误中学习</h2>
<p>更有意思的是自主演进智能体推理（Self-Evolving Agentic Reasoning）。AI可以通过经验改进自己的表现。</p>
<p>这依赖两个机制：</p>
<p><strong>反馈</strong>：AI完成任务后会评估自己的推理过程。比如Reflexion框架让AI检查自己的行动序列是否有效。发现问题后，它会在下次任务中避免同样的错误。</p>
<p><strong>记忆</strong>：AI会记录每次交互的结果。成功和失败的经验都会被保存下来，用于改进未来的决策。</p>
<p>这让AI可以在使用过程中持续改进，而不需要每次都重新训练模型。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4228a516f77e45e881c96d988630f8d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25a2Q55qE5oqA5pyv56KO56KO5b-1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770042116&amp;x-signature=GRj2Pw9y4Jv9oNNRzCSAsg0lNWo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">三：多个AI协同工作</h2>
<p>集体多智能体推理（Collective Multi-Agent Reasoning）让多个AI分工合作。一个AI团队可能包括：</p>
<ul>
<li><strong>管理者</strong>：分解任务</li>
<li><strong>工作者</strong>：执行具体操作，比如调用工具或编写代码</li>
<li><strong>验证者</strong>：检查结果是否正确</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96284d5912c24b20bed9d896c8064404~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25a2Q55qE5oqA5pyv56KO56KO5b-1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770042116&amp;x-signature=iCMmWkBkYePapdetLxnIeoTI9P8%3D" alt="" loading="lazy"/></p>
<p>这种分工的好处是每个AI专注于自己擅长的部分。管理者规划路线，工作者执行任务，验证者把关质量。它们之间会互相反馈，逐步优化最终结果。</p>
<h2 data-id="heading-3">四：AI可以创造工具</h2>
<p>以前AI只能使用人类提供的工具和API。现在AI可以自己编写代码来创建新工具。</p>
<p>当遇到现有工具无法解决的问题时，AI会写代码、测试、调试，直到创建出能用的工具。比如ToolMaker框架甚至可以把整个GitHub仓库转换成AI可调用的工具集。</p>
<p>这意味着AI不再受限于预设的功能。它可以根据需要扩展自己的能力。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a64c16c48aa14b749a3797bb004b50a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25a2Q55qE5oqA5pyv56KO56KO5b-1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770042116&amp;x-signature=U%2F%2B9fukPZbCOCYJSjWjkfi3j794%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">结论</h2>
<p>智能体推理代表了AI发展的一个新方向。AI从被动响应转向主动解决问题，从静态知识库转向动态学习系统。</p>
<p>这项研究提出的四个方向——动态交互、从错误中学习、多智能体协作、创造工具——都指向同一个趋势：AI正在变得更加自主。</p>
<p>这些能力还在早期阶段，但已经显示出实用价值。接下来值得关注的就是这些技术如何在实际应用中落地。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python `__xxattr__` 四大实战模式详解：从代理到 ORM 的魔法之旅]]></title>    <link>https://juejin.cn/post/7599531732337557538</link>    <guid>https://juejin.cn/post/7599531732337557538</guid>    <pubDate>2026-01-26T14:30:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599531732337557538" data-draft-id="7599531732337541154" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python `__xxattr__` 四大实战模式详解：从代理到 ORM 的魔法之旅"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-26T14:30:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="哈里谢顿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python `__xxattr__` 四大实战模式详解：从代理到 ORM 的魔法之旅
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    哈里谢顿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T14:30:44.000Z" title="Mon Jan 26 2026 14:30:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>关键词：Python、<strong>getattr</strong>、<strong>setattr</strong>、代理模式、延迟加载、属性验证、ORM<br/>
预计阅读：25 min，附完整可运行代码示例</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">0. 前言：为什么你一定要掌握 <code>__xxattr__</code></h2>
<p>在 Python 里，点语法（<code>obj.x</code>）看似平淡无奇，背后却藏着一套可插拔的“钩子”——<br/>
<code>__getattr__</code> / <code>__setattr__</code> / <code>__delattr__</code>。<br/>
它们就像“魔法插槽”，能让你在“属性被触碰”的瞬间植入任意逻辑：查日志、做校验、走网络、懒加载……<br/>
本文用“四大模式”带你把官方文档里干巴巴的定义变成能跑、能改、能上线的产品级代码。</p>
<hr/>
<h2 data-id="heading-1">1. 代理模式（Proxy）：把“转发”玩出花</h2>
<h3 data-id="heading-2">1.1 场景</h3>
<ul>
<li>包装第三方库，隐藏其怪异接口</li>
<li>给所有方法统一加日志、缓存、权限</li>
<li>实现“远程代理”：本地对象 ≈ 远端服务</li>
</ul>
<h3 data-id="heading-3">1.2 最小可运行模板</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Proxy</span>:
    <span class="hljs-string">"""通用代理：只暴露被代理对象的公共属性（非 _ 开头）"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, target</span>):
        <span class="hljs-comment"># 必须用 super 绕过自身的 __setattr__</span>
        <span class="hljs-built_in">super</span>().__setattr__(<span class="hljs-string">'_target'</span>, target)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'[GET ] <span class="hljs-subst">{name}</span>'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(self._target, name)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__setattr__</span>(<span class="hljs-params">self, name, value</span>):
        <span class="hljs-keyword">if</span> name.startswith(<span class="hljs-string">'_'</span>):
            <span class="hljs-built_in">super</span>().__setattr__(name, value)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'[SET ] <span class="hljs-subst">{name}</span> = <span class="hljs-subst">{value}</span>'</span>)
            <span class="hljs-built_in">setattr</span>(self._target, name, value)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__delattr__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'[DEL ] <span class="hljs-subst">{name}</span>'</span>)
        <span class="hljs-built_in">delattr</span>(self._target, name)
</code></pre>
<h3 data-id="heading-4">1.3 使用演示</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Spam</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, x</span>):      self.x = x
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params">self, y</span>):           <span class="hljs-built_in">print</span>(<span class="hljs-string">'Spam.bar:'</span>, self.x, y)

s = Spam(<span class="hljs-number">2</span>)
p = Proxy(s)

p.x          <span class="hljs-comment"># [GET ] x  → 2</span>
p.x = <span class="hljs-number">37</span>     <span class="hljs-comment"># [SET ] x = 37</span>
p.bar(<span class="hljs-number">3</span>)     <span class="hljs-comment"># [GET ] bar → Spam.bar: 37 3</span>
<span class="hljs-keyword">del</span> p.x      <span class="hljs-comment"># [DEL ] x</span>
</code></pre>
<blockquote>
<p>代理模式在 Python Cookbook 中被官方推荐为“继承的轻量级替代方案”。</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">2. 属性验证 &amp; 转换：把“赋值”做成管道</h2>
<h3 data-id="heading-6">2.1 需求</h3>
<ul>
<li>类型不对就抛错，而不是运行时崩</li>
<li>自动把字符串转数字、大小写归一化</li>
<li>支持“只读”“不可删除”等语义</li>
</ul>
<h3 data-id="heading-7">2.2 实现：描述符 + <code>__setattr__</code> 双保险</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Schema</span>:
    age     = <span class="hljs-built_in">int</span>
    name    = <span class="hljs-built_in">str</span>
    score   = <span class="hljs-built_in">float</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Validated</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, **kw</span>):
        <span class="hljs-comment"># 真实数据放在 __dict__ 本身，避免递归</span>
        self.__dict__[<span class="hljs-string">'_data'</span>] = {}
        <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> kw.items():
            <span class="hljs-built_in">setattr</span>(self, k, v)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__setattr__</span>(<span class="hljs-params">self, name, value</span>):
        typ = <span class="hljs-built_in">getattr</span>(Schema, name, <span class="hljs-literal">None</span>)
        <span class="hljs-keyword">if</span> typ <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">raise</span> AttributeError(<span class="hljs-string">f'未知字段 <span class="hljs-subst">{name}</span>'</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(value, typ):
            <span class="hljs-keyword">try</span>:
                value = typ(value)
            <span class="hljs-keyword">except</span> (ValueError, TypeError):
                <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">f'<span class="hljs-subst">{name}</span> 必须是 <span class="hljs-subst">{typ.__name__}</span>'</span>)
        self._data[name] = value

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">return</span> self._data[name]
        <span class="hljs-keyword">except</span> KeyError:
            <span class="hljs-keyword">raise</span> AttributeError(name)

u = Validated(age=<span class="hljs-string">'18'</span>, name=<span class="hljs-string">'bob'</span>, score=<span class="hljs-string">'99.5'</span>)
<span class="hljs-built_in">print</span>(u.age, u.score)      <span class="hljs-comment"># 18 99.5</span>
u.age = <span class="hljs-string">'20'</span>               <span class="hljs-comment"># 自动转 int</span>
</code></pre>
<blockquote>
<p>该技巧在 attrs/cattrs 等库中大量使用，可节省 70% 的样板代码。</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">3. 延迟加载（Lazy Loading）：让“昂贵”对象按需出生</h2>
<h3 data-id="heading-9">3.1 典型昂贵资源</h3>
<ul>
<li>大模型文件 / 千万级数据库连接</li>
<li>远程网络客户端（gRPC、REST）</li>
<li>重量级 GUI 组件</li>
</ul>
<h3 data-id="heading-10">3.2 装饰器版（类属性）</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">lazy_property</span>(<span class="hljs-params">fn</span>):
    <span class="hljs-string">"""类级别延迟加载，结果缓存到实例"""</span>
    attr_name = <span class="hljs-string">'_lazy_'</span> + fn.__name__
<span class="hljs-meta">    @property</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_lazy</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">hasattr</span>(self, attr_name):
            <span class="hljs-built_in">setattr</span>(self, attr_name, fn(self))
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(self, attr_name)
    <span class="hljs-keyword">return</span> _lazy

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span>:
<span class="hljs-meta">    @lazy_property</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mysql_pool</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'&gt;&gt;&gt; 真正创建 MySQL 连接池 …'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">'MySQLPool(...)'</span>
</code></pre>
<h3 data-id="heading-11">3.3 <code>__getattr__</code> 版（动态模块导入）</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LazyModule</span>:
    <span class="hljs-string">"""访问时才 import，适用于可选依赖"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, item</span>):
        <span class="hljs-keyword">if</span> item == <span class="hljs-string">'pd'</span>:
            <span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
            self.pd = pd
            <span class="hljs-keyword">return</span> pd
        <span class="hljs-keyword">raise</span> AttributeError(item)

lm = LazyModule()
lm.pd.DataFrame()   <span class="hljs-comment"># 此处才首次 import pandas</span>
</code></pre>
<blockquote>
<p>延迟加载能把大型 CLI 工具的启动时间缩短 50% 以上。</p>
</blockquote>
<hr/>
<h2 data-id="heading-12">4. ORM 框架实现：把“行”变成“对象”</h2>
<h3 data-id="heading-13">4.1 核心思想</h3>
<p>表 → 类，行 → 实例，字段 → 属性。<br/>
利用 <code>__getattr__</code> / <code>__setattr__</code> 把对属性的访问翻译成 SQL。</p>
<h3 data-id="heading-14">4.2 最小 ORM（仅依赖 sqlite3）</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> sqlite3, threading

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Field</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, typ</span>): self.typ = typ

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ModelMeta</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-string">"""元类：扫描属性，收集字段"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">mcls, name, bases, ns</span>):
        <span class="hljs-keyword">if</span> name == <span class="hljs-string">'Model'</span>:               <span class="hljs-comment"># 基类本身不做处理</span>
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().__new__(mcls, name, bases, ns)
        fields = {k: v <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> ns.items() <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(v, Field)}
        ns[<span class="hljs-string">'_fields'</span>] = fields
        ns[<span class="hljs-string">'_table'</span>] = name.lower()
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().__new__(mcls, name, bases, ns)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Model</span>(metaclass=ModelMeta):
    db = sqlite3.connect(<span class="hljs-string">'demo.db'</span>, check_same_thread=<span class="hljs-literal">False</span>)
    db_lock = threading.Lock()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, **kw</span>):
        <span class="hljs-comment"># 数据保存在 _row，避免与字段名冲突</span>
        self._row = {}
        <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> kw.items():
            <span class="hljs-built_in">setattr</span>(self, k, v)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__setattr__</span>(<span class="hljs-params">self, name, value</span>):
        <span class="hljs-keyword">if</span> name <span class="hljs-keyword">in</span> self._fields:
            self._row[name] = value
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">super</span>().__setattr__(name, value)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">return</span> self._row[name]
        <span class="hljs-keyword">except</span> KeyError:
            <span class="hljs-keyword">raise</span> AttributeError(name)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save</span>(<span class="hljs-params">self</span>):
        cols = <span class="hljs-string">', '</span>.join(self._row.keys())
        placeholders = <span class="hljs-string">', '</span>.join([<span class="hljs-string">'?'</span>] * <span class="hljs-built_in">len</span>(self._row))
        sql = <span class="hljs-string">f"INSERT INTO <span class="hljs-subst">{self._table}</span> (<span class="hljs-subst">{cols}</span>) VALUES (<span class="hljs-subst">{placeholders}</span>)"</span>
        <span class="hljs-keyword">with</span> self.db_lock:
            self.db.execute(sql, <span class="hljs-built_in">tuple</span>(self._row.values()))
            self.db.commit()

<span class="hljs-comment"># 定义模型</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-title class_ inherited__">Model</span>):
    <span class="hljs-built_in">id</span>   = Field(<span class="hljs-built_in">int</span>)
    name = Field(<span class="hljs-built_in">str</span>)

<span class="hljs-comment"># 使用</span>
u = User(<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>, name=<span class="hljs-string">'kimi'</span>)
u.save()          <span class="hljs-comment"># 真实写入 SQLite</span>
</code></pre>
<blockquote>
<p>大型库如 Django ORM、SQLAlchemy 内部同样依赖 <code>__setattr__</code> 做“脏数据跟踪”。</p>
</blockquote>
<hr/>
<h2 data-id="heading-15">5. 性能陷阱 &amp; 调试锦囊</h2>

























<table><thead><tr><th>问题</th><th>现象</th><th>解决</th></tr></thead><tbody><tr><td>无限递归</td><td><code>RecursionError</code></td><td><code>__setattr__</code> 里用 <code>super()</code> 或直接改 <code>__dict__</code></td></tr><tr><td>性能下降</td><td>属性访问慢 3×</td><td>缓存计算结果、用 <code>__slots__</code> 减少字典开销</td></tr><tr><td>调试困难</td><td>断点进不去</td><td>在钩子内加 <code>print</code> / <code>logging</code>，或临时关闭自定义方法</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-16">6. 一张图总结（Mermaid）</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[__getattr__] --&gt; B[代理模式]
    A --&gt; C[延迟加载]
    D[__setattr__] --&gt; E[属性验证]
    D --&gt; F[ORM 脏跟踪]
    G[__delattr__] --&gt; H[保护只读属性]
</code></pre>
<hr/>
<h2 data-id="heading-17">7. 结语</h2>
<p><code>__xxattr__</code> 不是炫技，而是“把本来要写的 100 个 <code>if</code> / <code>try</code> 藏到语言运行时”。<br/>
掌握这四大模式，你就能：</p>
<ul>
<li>写出“自带文档”的类（代理）</li>
<li>让错误在“赋值瞬间”而不是“运行半小时后”爆掉（验证）</li>
<li>把启动时间从 3 s 降到 300 ms（懒加载）</li>
<li>用 200 行代码写个能跑业务的“迷你 Django”（ORM）</li>
</ul>
<p>下次当你敲下 <code>obj.x = y</code> 时，别忘了：背后有一整块魔法世界，等你去点亮。</p>
<hr/>
<blockquote>
<p>参考资料<br/>
: 《Python 实现类属性的延迟加载装饰器》<br/>
: 《Python 性能优化：懒加载与其他高级技巧》<br/>
: 《Python 使用 attrs 和 cattrs 实现面向对象编程》<br/>
: 《Python3 Cookbook 8.15 属性的代理访问》<br/>
: 《浅谈 Python 的元编程》</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[新的一年，多回家看看]]></title>    <link>https://juejin.cn/post/7599506068047347712</link>    <guid>https://juejin.cn/post/7599506068047347712</guid>    <pubDate>2026-01-26T14:48:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599506068047347712" data-draft-id="7599506068047331328" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="新的一年，多回家看看"/> <meta itemprop="keywords" content="前端,设计,API"/> <meta itemprop="datePublished" content="2026-01-26T14:48:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="祯民"/> <meta itemprop="url" content="https://juejin.cn/user/2714061017452557"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            新的一年，多回家看看
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2714061017452557/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    祯民
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T14:48:00.000Z" title="Mon Jan 26 2026 14:48:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>一年有12个月，365天。在外工作的人，每年能回去两三次就不容易了。算下来，从离家开始，和父母亲人见面的次数，其实数得过来。</p>
<p>外公走的时候，像一棵树慢慢落了叶。从还能说笑，到躺在床上，再到变成山上一座坟，前后不过几个月。那时我年轻，也离家远，感情是木的。哭了一场，日子也就糊里糊涂过去了。</p>
<p>后来看到阿里云offer里那条探亲假，心里动了一下，但也没多想——折算成钱，不过多个几千块而已。</p>
<p>直到我真的用起它来。</p>
<p>这一年，我回了二十多次家。厨房的窗，阳台的光，饭桌的位置，都还是老样子。可外婆不一样了。她耳朵背了，常常听错话；眼神有时空空的，望着门外。有一次她喃喃自语，我才知道她心里熬着多苦的念头。</p>
<p>而我呢？工作以后，眼里只有目标、成长、效率。我把日子过成了一张清单，却忘了情感需要养护，人需要彼此看见。</p>
<p>如果没有这二十多次推开家门，我大概还在自己的轨道上赶路，看不见至亲的时光正在加速流逝。这些零碎的归来，对很多人来说，已是好几年的分量。</p>
<p>昨晚陪外婆在阳台站了一会儿。风凉凉的，她稀疏的白发被轻轻吹起。我忽然想起毕业那年，自己暗暗想过：等有能力了，一定要把家人护在身后。</p>
<p>可后来，“有能力”变成了一个越来越远的目标，当初想护着的人，却在我奔赴目标的路上悄悄老了。</p>
<p>如今我才懂，那份offer里最重的，不是那几千块钱，而是它把“常回家看看”这句话，变成了我日程表里一行真切的安排。这二十几趟归途，像一根细细的线，把我从漂浮的半空，一次次拉回这片扎实的土地上。</p>
<p>让我不至于在某天忽然醒过来时，发现自己已经站在了告别的那一头，手里什么也没握住，只剩满腔来不及。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[使用 && 整合事件，简化代码]]></title>    <link>https://juejin.cn/post/7599483314160730131</link>    <guid>https://juejin.cn/post/7599483314160730131</guid>    <pubDate>2026-01-26T13:32:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599483314160730131" data-draft-id="7598587406708129833" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="使用 &amp;&amp; 整合事件，简化代码"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-01-26T13:32:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="剪刀石头布啊"/> <meta itemprop="url" content="https://juejin.cn/user/1855631360014798"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            使用 &amp;&amp; 整合事件，简化代码
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1855631360014798/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    剪刀石头布啊
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T13:32:28.000Z" title="Mon Jan 26 2026 13:32:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>js 中 &amp;&amp; 和 || 使用好了，有时候能够将我们的代码写的更舒服，甚至逻辑更加清晰，合理的利用他们，能让我们的代码看起来含金量更高一些</p>
<p>ps：当然不一定是真的含金量高很多，如果对于用习惯的来说，确实逻辑更紧密了，个人减少了很多代码和多余判断😄</p>
<p>&amp;&amp; 是返回符合条件的最后一项或不符合的第一项 || 是返回符合条件的第一项或不符合的最后一项</p>
<p>这里就使用 &amp;&amp; 举个案例， || 相信遇到合适场景，自己就知道咋回事了</p>
<h2 data-id="heading-1">案例</h2>
<p>我有一个弹窗，点击确定后，将选中内容后回调给外部，否则提示请选择数据</p>
<p>让ai帮我写这一块代码，是这样的，简单粗暴易懂</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//pageInfo 和 onOk 已经定义好了</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onComplete</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> { dataSource, key } = pageInfo;
  <span class="hljs-keyword">if</span> (dataSource &amp;&amp; dataSource.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; key) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Modal</span>.<span class="hljs-title function_">info</span>({
      <span class="hljs-attr">title</span>: <span class="hljs-string">'信息'</span>,
      <span class="hljs-attr">content</span>: <span class="hljs-string">'请选择一条数据'</span>,
    });
  }
  <span class="hljs-keyword">const</span> record = dataSource.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">key</span> === key);
  <span class="hljs-keyword">if</span> (!record) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Modal</span>.<span class="hljs-title function_">info</span>({
      <span class="hljs-attr">title</span>: <span class="hljs-string">'信息'</span>,
      <span class="hljs-attr">content</span>: <span class="hljs-string">'请选择一条数据'</span>,
    });
  }
  onOk &amp;&amp; <span class="hljs-title function_">onOk</span>(record);
}
</code></pre>
<p>下面我是这么写的，不想多写提示了，合理利用 &amp;&amp; 会返回符合条件最后一项特性来实现，看起来似乎好了一点点</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//pageInfo 和 onOk 已经定义好了</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onComplete</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> { dataSource, key } = pageInfo;
  <span class="hljs-keyword">const</span> hasSelectedData =
    dataSource &amp;&amp;
    dataSource.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp;
    key &amp;&amp;
    dataSource.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">key</span> === key);  
  <span class="hljs-keyword">if</span> (!hasSelectedData) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Modal</span>.<span class="hljs-title function_">info</span>({
      <span class="hljs-attr">title</span>: <span class="hljs-string">"信息"</span>,
      <span class="hljs-attr">content</span>: <span class="hljs-string">"请选择一条数据"</span>,
    });
  }
  onOk &amp;&amp; <span class="hljs-title function_">onOk</span>(ifs.<span class="hljs-title function_">pop</span>());
};
</code></pre>
<h2 data-id="heading-2">最后</h2>
<p>普通的代码蕴含着我们对于代码的一些追求，你觉得什么样的代码好呢，反正我的ai感觉我的代码是屎，给我改了😄</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[script标签有哪些常用属性，作用分别是啥]]></title>    <link>https://juejin.cn/post/7599483794657574953</link>    <guid>https://juejin.cn/post/7599483794657574953</guid>    <pubDate>2026-01-26T13:32:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599483794657574953" data-draft-id="7597693638922993727" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="script标签有哪些常用属性，作用分别是啥"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-01-26T13:32:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="剪刀石头布啊"/> <meta itemprop="url" content="https://juejin.cn/user/1855631360014798"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            script标签有哪些常用属性，作用分别是啥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1855631360014798/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    剪刀石头布啊
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T13:32:40.000Z" title="Mon Jan 26 2026 13:32:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>前端开发中，离不开的就是script脚本的执行，html中嵌入script标签，我们的js脚本才能正常执行，正是因为有了它，前端的页面变得更加灵活了(不是纯静态页面了)</p>
<h2 data-id="heading-1">简介</h2>
<p>常用属性：</p>
<p><strong>src</strong>：脚本引用资源地址，可以是远端，也可以是本地路径的资源</p>
<pre><code class="hljs language-js" lang="js">&lt;script src=<span class="hljs-string">"https://example.com/script.js"</span>&gt;&lt;/script&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./common.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p><strong>type</strong>: script类型，HTML5 默认为 text/javascript，也基本上很少主动设置了，为了兼容性可以设置</p>
<p>crossorigin：跨域属性 "anonymous"(匿名)、"use-credentials"(使用身份令牌验证)</p>
<pre><code class="hljs language-js" lang="js">&lt;script src=<span class="hljs-string">"https://example.com/script.js"</span> crossorigin=<span class="hljs-string">"anonymous"</span>&gt;&lt;/script&gt;
</code></pre>
<p><strong>async</strong>: 异步(延迟)执行脚本</p>
<ul>
<li>
<p>脚本下载时不阻塞 HTML 解析</p>
</li>
<li>
<p>下载完成后立即执行</p>
</li>
<li>
<p><strong>执行顺序不保证</strong></p>
</li>
</ul>
<p><strong>defer</strong>:  异步(延迟)执行脚本</p>
<ul>
<li>
<p>脚本下载时不阻塞 HTML 解析</p>
</li>
<li>
<p>HTML 解析完成后才执行</p>
</li>
<li>
<p><strong>按顺序执行多个 defer 脚本</strong></p>
</li>
</ul>
<p><strong>integrity</strong>：子资源完整性验证，防止恶意更改文件来执行潜在攻击</p>
<p>例如：script可能来自cdn提速，但是为了避免被人篡改过，于是使用算法加密，提前设定好脚本加密后的结果，浏览器下载后会将资源加密后进行对比，一致时执行，可以减少被攻击的可能</p>
<pre><code class="hljs language-js" lang="js">常用算法有 <span class="hljs-string">`sha256`</span>、<span class="hljs-string">`sha384`</span>、<span class="hljs-string">`sha512`</span>（不推荐 md5/sha1，安全性低）。

&lt;script 
    src=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"</span> 
    integrity=<span class="hljs-string">"sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="</span> 
    crossorigin=<span class="hljs-string">"anonymous"</span>
    /&gt;
    
</code></pre>
<p>生成sha256哈希值</p>
<pre><code class="hljs language-js" lang="js">cat script.<span class="hljs-property">js</span> | openssl dgst -sha256 -binary | base64 # 生成sha384哈希值
</code></pre>
<h2 data-id="heading-2">最后</h2>
<p>实际常用的就这么多，且前几个最常用(老代码中比较常见)</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[写一个简易的数字转中文功能]]></title>    <link>https://juejin.cn/post/7599511763987136566</link>    <guid>https://juejin.cn/post/7599511763987136566</guid>    <pubDate>2026-01-26T13:33:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599511763987136566" data-draft-id="7553638089333637183" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="写一个简易的数字转中文功能"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2026-01-26T13:33:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="剪刀石头布啊"/> <meta itemprop="url" content="https://juejin.cn/user/1855631360014798"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            写一个简易的数字转中文功能
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1855631360014798/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    剪刀石头布啊
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T13:33:36.000Z" title="Mon Jan 26 2026 13:33:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>今天我们写一个一个简易的数字转中文的效果，虽然是功能看起来很简单，但是要是没有写过这类功能的话，那么可能会无从下手，下面就简单讲一下写这类逻辑的过程</p>
<h2 data-id="heading-1">思路</h2>
<p>实现简易思路：</p>
<ol>
<li>大单位是以万、亿、兆等为单位的，4位小数一组，因此需要对数字进行四位一组分组操作，在后面追加单位即可</li>
<li>除了大单位，中间的小单位则是个十百千，基本都是一致，因此使用同一种统一处理方案，其中个位没有单位</li>
<li>除了单位还有每一位数字的翻译工作，即：<code>0~9</code> =&gt; <code>零~九</code></li>
<li>淡出处理中文语法中特有的情况，例如：开头不显示一十而是十，零中间作为间隔只能有一个，连续的零没有大单位，以及各位为零的处理等</li>
<li>入参处理(这里简单处理一下)</li>
</ol>
<h2 data-id="heading-2">代码实现</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//数字转中文(要支持小数，可以在扩展，小数就比较简单了)</span>
<span class="hljs-comment">//入参为数字，因此不考虑开头为零的情</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">convertChineseNumber</span> = (<span class="hljs-params">number</span>) =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(number)) <span class="hljs-keyword">return</span> <span class="hljs-string">"NAN"</span>;

  <span class="hljs-keyword">const</span> units = [<span class="hljs-string">""</span>, <span class="hljs-string">"万"</span>, <span class="hljs-string">"亿"</span>, <span class="hljs-string">"兆"</span>, <span class="hljs-string">"京"</span>, <span class="hljs-string">"垓"</span>];
  <span class="hljs-keyword">const</span> baseUnits = [<span class="hljs-string">""</span>, <span class="hljs-string">"十"</span>, <span class="hljs-string">"百"</span>, <span class="hljs-string">"千"</span>];
  <span class="hljs-keyword">const</span> cNumbers = [<span class="hljs-string">"零"</span>, <span class="hljs-string">"一"</span>, <span class="hljs-string">"二"</span>, <span class="hljs-string">"三"</span>, <span class="hljs-string">"四"</span>, <span class="hljs-string">"五"</span>, <span class="hljs-string">"六"</span>, <span class="hljs-string">"七"</span>, <span class="hljs-string">"八"</span>, <span class="hljs-string">"九"</span>];
  
  <span class="hljs-comment">//分割四位一组，反转数组，从后往前加单位</span>
  <span class="hljs-keyword">const</span> numGroup = <span class="hljs-title class_">String</span>(number)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\B(?=(\d{4})+$)/g</span>, <span class="hljs-string">" "</span>)  <span class="hljs-comment">//使用前瞻运算符来处理四位一体</span>
    .<span class="hljs-title function_">split</span>(<span class="hljs-string">" "</span>)
    .<span class="hljs-title function_">reverse</span>();
  <span class="hljs-keyword">let</span> result = <span class="hljs-string">""</span>;
  <span class="hljs-comment">//遍历从后往前加单位</span>
  numGroup.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">numStrings, idx</span>) =&gt;</span> {
    <span class="hljs-comment">//处理全零的情况，不应该带单位，由于需要间隔0的情况，保留一个零</span>
    <span class="hljs-keyword">if</span> (numStrings === <span class="hljs-string">"0000"</span>) {
      result = <span class="hljs-string">'零'</span> + result
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">//有数的先添加大单位</span>
    result = units[idx] + result;
    <span class="hljs-comment">//分割四位一组的小数字，仍然是反转，从后往前加单位</span>
    numStrings
      .<span class="hljs-title function_">split</span>(<span class="hljs-string">""</span>)
      .<span class="hljs-title function_">reverse</span>()
      .<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, idx</span>) =&gt;</span> {
        <span class="hljs-comment">//处理每个后面的单位，其中个位没有单位，0也没有单位</span>
        <span class="hljs-keyword">if</span> (idx !== <span class="hljs-number">0</span> &amp;&amp; item !== <span class="hljs-string">"0"</span>) {
          result = baseUnits[idx] + result;
        }
        <span class="hljs-comment">//数字翻译</span>
        result = cNumbers[<span class="hljs-title class_">Number</span>(item)] + result;
      });
  });
  <span class="hljs-comment">//处理结果中可能存在的中文读写问题，例如不会存在连续的零，开头不会一十</span>
  <span class="hljs-comment">//零后面不应该有单位，非零整数结尾不会读零</span>
  <span class="hljs-keyword">return</span> result
    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/零+/g</span>, <span class="hljs-string">"零"</span>)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^(一十)/</span>, <span class="hljs-string">"十"</span>)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">`零([<span class="hljs-subst">${units.join(<span class="hljs-string">""</span>)}</span>]{1})`</span>, <span class="hljs-string">"g"</span>), <span class="hljs-string">"$1"</span>) <span class="hljs-comment">//小单位处理了大单位也要处理</span>
    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/(.+)零$/</span>, <span class="hljs-string">"$1"</span>)
};
</code></pre>
<h2 data-id="heading-3">测试案例</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//我们试验几个案例</span>
<span class="hljs-keyword">const</span> numbers = [
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">0</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">1234567899</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">101234567899</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">100234567899</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">101034567899</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">101030067899</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">101030067890</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">101030007899</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">100000007899</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">100070007899</span>),
  <span class="hljs-title function_">convertChineseNumber</span>(<span class="hljs-number">100007007899</span>),
];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(numbers);

<span class="hljs-comment">//目前来看返回结果是对的，如果感觉哪里不对，可以在填填补补就行了</span>
[
  <span class="hljs-string">'零'</span>,
  <span class="hljs-string">'十二亿三千四百五十六万七千八百九十九'</span>,
  <span class="hljs-string">'一千零一十二亿三千四百五十六万七千八百九十九'</span>,
  <span class="hljs-string">'一千零二亿三千四百五十六万七千八百九十九'</span>,
  <span class="hljs-string">'一千零一十亿三千四百五十六万七千八百九十九'</span>,
  <span class="hljs-string">'一千零一十亿三千零六万七千八百九十九'</span>,
  <span class="hljs-string">'一千零一十亿三千零六万七千八百九十'</span>,
  <span class="hljs-string">'一千零一十亿三千万七千八百九十九'</span>,
  <span class="hljs-string">'一千亿零七千八百九十九'</span>,
  <span class="hljs-string">'一千亿七千万七千八百九十九'</span>,
  <span class="hljs-string">'一千亿零七百万七千八百九十九'</span>
]
</code></pre>
<h2 data-id="heading-4">最后</h2>
<p>上面的整体思路还是可以得，实际还是有所欠缺的，例如：不支持小数，对于大数字的单位支持也不够多，甚至一些读法的场景可能考虑还不够完善</p>
<p>需要完善的话，实际按照上面思路补充一下就行了</p>
<p>本篇就介绍到这里了</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[手写 Promise.all]]></title>    <link>https://juejin.cn/post/7599483314160746515</link>    <guid>https://juejin.cn/post/7599483314160746515</guid>    <pubDate>2026-01-26T13:34:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599483314160746515" data-draft-id="7568319637000781824" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="手写 Promise.all"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2026-01-26T13:34:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="剪刀石头布啊"/> <meta itemprop="url" content="https://juejin.cn/user/1855631360014798"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            手写 Promise.all
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1855631360014798/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    剪刀石头布啊
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T13:34:15.000Z" title="Mon Jan 26 2026 13:34:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>Promise 是 JavaScript 中非常重要的一个功能，他可以让我们异步的去处理一些事情，尤其是对于一些比较耗时的操作，其非常重要，当然一些不耗时的操作，有事就没必要使用它了，毕竟会带来额外的性能开销</p>
<h2 data-id="heading-1">Promise.all</h2>
<p>Promise.all 是 js 中个一个静态方法，尤其是写业务对接后端的时候，会经常见到，不管是写后端异步签名，还是前端接口请求，其主要用来聚合一组成功的结果</p>
<p>相比于 promise 其他系列，这个算是比较简单了(当然 race 更简单就不介绍了)</p>
<p>下面简单陈述 Promise.all 手写的几个关键单</p>
<ol>
<li>all 是一个静态方法，因此不能像写对象的原型链 prototype一样写</li>
<li>promise 状态从 pending 变更为 fulfilled 或者 rejected 只能发生一次，因此无需考虑多次回调 reject 的问题</li>
<li>遍历 promises 数组的时候，遍历的是所有可迭代对象，因此 for...of 非常适合</li>
</ol>
<p><strong>tips</strong>: 可以通过 promise 函数回调赋值的方式减少嵌套层级</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//声明一个静态方法</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-property">myAll</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">promises</span>) {
    <span class="hljs-keyword">let</span> resolve, reject;
    <span class="hljs-comment">//构造一个新的promise,赋值可以减少嵌套层级</span>
    <span class="hljs-keyword">const</span> completePromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">res, rej</span>) =&gt;</span> {
        resolve = res;
        reject = rej;
    })
    <span class="hljs-keyword">const</span> results = [];
    <span class="hljs-keyword">const</span> length = promises.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">let</span> completedCount = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> idx = <span class="hljs-number">0</span>
    <span class="hljs-comment">//tips: promise 状态从 pending 变更为 fulfilled 或者 rejected 只能发生一次</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> promises) {
        <span class="hljs-comment">//使用一个临时变量接收 idx 避免补货到外部同一个索引</span>
        <span class="hljs-keyword">const</span> currentIndex = idx;
        <span class="hljs-comment">//item可能不是promise，所以用Promise.resolve包一下</span>
        <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(item).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
            results[currentIndex] = value;
            completedCount++;
            <span class="hljs-comment">//全部成功标记成功</span>
            <span class="hljs-keyword">if</span> (completedCount === length) {
                <span class="hljs-title function_">resolve</span>(results);
            }
        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
            <span class="hljs-comment">//有一个返回err就行了，promise状态只会变更一次</span>
            <span class="hljs-title function_">reject</span>(err);
        })
        idx++;
    }
    <span class="hljs-keyword">return</span> completePromise;
}
</code></pre>
<p>下面测试一下结果，非常正确</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">test</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>)
        }, <span class="hljs-number">1000</span>)
    });
    <span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">resolve</span>(<span class="hljs-number">2</span>)
        }, <span class="hljs-number">2000</span>)
    });
    <span class="hljs-keyword">const</span> p3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-comment">// reject('error 3')</span>
            <span class="hljs-title function_">resolve</span>(<span class="hljs-number">3</span>)
        }, <span class="hljs-number">1500</span>)
    });
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">myAll</span>([p1, p2, p3]).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'res'</span>, res)
    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'err'</span>, err)
    })
}

<span class="hljs-title function_">test</span>();
</code></pre>
<p>这篇文章就讲到这里了，由于内容相对简单，就不多介绍了</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[那个猝死的程序员，在抢救时被拉进了工作群]]></title>    <link>https://juejin.cn/post/7599450177058160650</link>    <guid>https://juejin.cn/post/7599450177058160650</guid>    <pubDate>2026-01-26T11:40:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599450177058160650" data-draft-id="7599543345980407835" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="那个猝死的程序员，在抢救时被拉进了工作群"/> <meta itemprop="keywords" content="程序员"/> <meta itemprop="datePublished" content="2026-01-26T11:40:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="程序员一点"/> <meta itemprop="url" content="https://juejin.cn/user/3802528978305192"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            那个猝死的程序员，在抢救时被拉进了工作群
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3802528978305192/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    程序员一点
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T11:40:36.000Z" title="Mon Jan 26 2026 11:40:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>生命无法重启，健康才是最高优先级</p>
</blockquote>
<p>2025年11月29日，周六，32岁的程序员高广辉在家中对妻子说“有点不舒服，要到客厅处理一下工作”后晕倒。在送医抢救过程中，他的手机屏幕依然亮着——<strong>他被拉入了一个新的微信技术群</strong>，群里同事正在@他处理工作。</p>
<p>当天13:00，高广辉被宣告临床死亡。死亡8小时后，他的微信再次收到消息：“周一一早有急任务，今天验货不过，要把这个改下”。</p>
<p><img src="https://foruda.gitee.com/images/1769427463353492230/29124b8c_10826153.png" alt="" title="20260126193540.png" loading="lazy"/></p>
<h2 data-id="heading-0">一个程序员的最后一周</h2>
<p>在高广辉生命的最后一周，工作日最早到家时间是<strong>21:38</strong>，最晚是<strong>22:47</strong>。他的浏览器记录显示，在猝死当天，这位部门经理至少<strong>5次访问了公司OA系统</strong>——尽管那天是周六。</p>
<p>妻子回忆，高广辉生前常说“好累好累，好想被炒掉”。调到一个新部门后，他的工作量翻了三倍，却因公司裁员而无人分担。他从“几分钟回复消息”变成“上午发消息，下午才回复”。</p>
<p><strong>“今天没做完的工作，明天可以继续，但透支的生命无法重启。”</strong> 这是高广辉妻子在他去世后发布的视频中的一句话。这话戳中了许多程序员的痛点。</p>
<h2 data-id="heading-1">我们都在透支什么？</h2>
<p>高广辉的工位上摆放着三块屏幕，桌下备有拖鞋和行军床。这种场景对程序员来说再熟悉不过。</p>
<p>他的薪酬结构是“低底薪、高绩效”，底薪仅3000余元，必须靠拼命加班才能拿到可观的月薪。公司推崇的“无边界协作”文化，使得工作和生活的界限变得模糊。</p>
<p><strong>我们是否也陷入了这种“自愿加班”的循环？</strong> 为了项目上线，为了绩效考核，为了不被替代，我们不断压缩睡眠时间，牺牲健康与家庭。</p>
<p>高广辉曾在他的GitHub项目中贴出“反996”标签，希望自己的代码能帮助同行们“不要被上头任务压得喘不过气”。讽刺的是，他最终却被过度工作压垮。</p>
<h2 data-id="heading-2">生命的优先级高于代码</h2>
<p>作为程序员，我们都明白<strong>优先级</strong>的重要性。但当工作不断抢占生命的高优先级位置时，系统终会崩溃。</p>
<p>高广辉的案例之所以引发广泛共鸣，是因为它反映了程序员群体普遍面临的困境：<strong>弹性工作制变成24小时待命</strong>，企业微信消息深夜不断，周末被隐形加班占据。</p>
<p>他的病历“既往史”一栏写着：“程序员经常熬夜”。这何尝不是许多程序员的共同“病史”？</p>
<h2 data-id="heading-3">重新定义成功与奋斗</h2>
<p>高广辉的遗物中有一本书：《恭喜你当上主管了》。他努力向上，28岁晋升部门经理，却最终付出了生命的代价。</p>
<p><strong>如果“成功”需要以健康、家庭和生命为代价，它还是成功吗？</strong></p>
<p>真正的技术成长不应该建立在身体透支的基础上。高效的代码不是靠熬夜熬出来的，而是源于清晰的思路和良好的状态。</p>
<h2 data-id="heading-4">从今天起，请珍爱自己</h2>
<p>高广辉的妻子说，如果时光可以倒流，一定会坚持让他辞掉工作。但生命没有如果。</p>
<p>在此，我想对每一位程序员同行说：</p>
<ol>
<li>
<p><strong>你的健康是第一位的需求</strong>：没有任何项目值得你用健康去交换。设定工作边界，学会说“不”。</p>
</li>
<li>
<p><strong>离线休息权是你应得的权利</strong>：下班后，你有权不回复工作消息。有电话呼进来了，你可以不接的。</p>
</li>
<li>
<p><strong>警惕“低底薪、高绩效”的陷阱</strong>：这种薪酬结构本质上是在鼓励透支生命。评估工作是否值得时，请算上健康成本。程序员本身就应该是固定工资，又不是销售，哪有什么底薪+绩效的说法。</p>
</li>
<li>
<p><strong>定期体检，重视身体信号</strong>：高广辉在2024年6月的体检还显示正常，但身体已经发出警报。</p>
</li>
<li>
<p><strong>重新定义你的成长路径</strong>：技术的提升不应该以健康为代价。可持续的职业发展才是真正的成长。</p>
</li>
</ol>
<h2 data-id="heading-5">生命无法重启，请好好生活</h2>
<p>在程序的世界的里，我们可以容忍失败，重启重来。但生命只有一次，<strong>没有Ctrl+Z</strong>。</p>
<p>高广辉的故事令人心痛，但也应成为我们反思的契机。每一位程序员都值得被温柔以待，包括我们自己。请你千万千万不要把这个新闻当成故事来看待了，如果你也一直在高压下工作，那么真请善待一下自己，真的真的真的。</p>
<p><strong>今天没做完的工作，明天可以继续，但透支的生命无法重启。</strong> 请好好生活，因为你的代码世界需要健康的你来书写。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernate（65）如何在微服务架构中使用Hibernate？]]></title>    <link>https://juejin.cn/post/7599528186587070474</link>    <guid>https://juejin.cn/post/7599528186587070474</guid>    <pubDate>2026-01-26T11:50:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599528186587070474" data-draft-id="7599543345980456987" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernate（65）如何在微服务架构中使用Hibernate？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-01-26T11:50:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernate（65）如何在微服务架构中使用Hibernate？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T11:50:39.000Z" title="Mon Jan 26 2026 11:50:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在微服务架构中使用Hibernate涉及多个步骤，包括配置项目依赖、设置数据源、配置Hibernate、定义实体类、创建DAO层、创建服务层、以及编写应用逻辑。每个微服务通常独立部署和运行，其数据库和ORM配置也独立于其他微服务。下面是详细的实现步骤和代码示例。</p>
<h3 data-id="heading-0">1. 项目依赖</h3>
<p>首先，在微服务的构建文件中添加必要的依赖项。例如，如果你使用的是Maven来构建项目，可以在<code>pom.xml</code>中添加以下依赖项：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Hibernate Core --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hibernate<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hibernate-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.4.32.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- JPA API --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.persistence<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.persistence-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- HikariCP for Connection Pooling --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.zaxxer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>HikariCP<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- MySQL Connector --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.26<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Spring Data JPA if using Spring Boot --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h3 data-id="heading-1">2. 配置数据源</h3>
<p>在微服务中配置数据源和Hibernate属性。假设我们使用Spring Boot来简化配置：</p>
<h4 data-id="heading-2"><code>application.properties</code></h4>
<pre><code class="hljs language-properties" lang="properties">spring.datasource.url=jdbc:mysql://localhost:3306/mydatabase
spring.datasource.username=root
spring.datasource.password=rootpassword
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
</code></pre>
<h3 data-id="heading-3">3. 配置Hibernate的SessionFactory</h3>
<p>Spring Boot会自动配置<code>SessionFactory</code>，如果你使用其他框架，可能需要手动配置。</p>
<h3 data-id="heading-4">4. 定义实体类</h3>
<p>定义一个简单的实体类，例如<code>User</code>。</p>
<h4 data-id="heading-5"><code>User.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.Entity;
<span class="hljs-keyword">import</span> javax.persistence.GeneratedValue;
<span class="hljs-keyword">import</span> javax.persistence.GenerationType;
<span class="hljs-keyword">import</span> javax.persistence.Id;
<span class="hljs-keyword">import</span> javax.persistence.Table;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "users")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-keyword">private</span> String username;
    <span class="hljs-keyword">private</span> String password;

    <span class="hljs-comment">// Getters and Setters</span>
    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> username;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUsername</span><span class="hljs-params">(String username)</span> {
        <span class="hljs-built_in">this</span>.username = username;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPassword</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> password;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPassword</span><span class="hljs-params">(String password)</span> {
        <span class="hljs-built_in">this</span>.password = password;
    }
}
</code></pre>
<h3 data-id="heading-6">5. 创建DAO层</h3>
<p>创建一个数据访问对象（DAO）接口和实现类，用于访问数据库。如果使用Spring Data JPA，可以简化为一个接口。</p>
<h4 data-id="heading-7"><code>UserRepository.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JpaRepository</span>&lt;User, Long&gt; {
    User <span class="hljs-title function_">findByUsername</span><span class="hljs-params">(String username)</span>;
}
</code></pre>
<h3 data-id="heading-8">6. 创建服务层</h3>
<p>创建一个服务类，用于处理业务逻辑。</p>
<h4 data-id="heading-9"><code>UserService.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;
<span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserService</span><span class="hljs-params">(UserRepository userRepository)</span> {
        <span class="hljs-built_in">this</span>.userRepository = userRepository;
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">createUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-keyword">return</span> userRepository.save(user);
    }

    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUserById</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-keyword">return</span> userRepository.findById(id).orElse(<span class="hljs-literal">null</span>);
    }

    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">getAllUsers</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> userRepository.findAll();
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">updateUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-keyword">return</span> userRepository.save(user);
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(Long id)</span> {
        userRepository.deleteById(id);
    }
}
</code></pre>
<h3 data-id="heading-10">7. 编写控制器</h3>
<p>利用上述服务类来编写RESTful API控制器。</p>
<h4 data-id="heading-11"><code>UserController.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/users")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserService userService;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserController</span><span class="hljs-params">(UserService userService)</span> {
        <span class="hljs-built_in">this</span>.userService = userService;
    }

    <span class="hljs-meta">@PostMapping</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;User&gt; <span class="hljs-title function_">createUser</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">createdUser</span> <span class="hljs-operator">=</span> userService.createUser(user);
        <span class="hljs-keyword">return</span> ResponseEntity.ok(createdUser);
    }

    <span class="hljs-meta">@GetMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;User&gt; <span class="hljs-title function_">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userService.getUserById(id);
        <span class="hljs-keyword">return</span> ResponseEntity.ok(user);
    }

    <span class="hljs-meta">@GetMapping</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;List&lt;User&gt;&gt; <span class="hljs-title function_">getAllUsers</span><span class="hljs-params">()</span> {
        List&lt;User&gt; users = userService.getAllUsers();
        <span class="hljs-keyword">return</span> ResponseEntity.ok(users);
    }

    <span class="hljs-meta">@PutMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;User&gt; <span class="hljs-title function_">updateUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id, <span class="hljs-meta">@RequestBody</span> User user)</span> {
        user.setId(id);
        <span class="hljs-type">User</span> <span class="hljs-variable">updatedUser</span> <span class="hljs-operator">=</span> userService.updateUser(user);
        <span class="hljs-keyword">return</span> ResponseEntity.ok(updatedUser);
    }

    <span class="hljs-meta">@DeleteMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;Void&gt; <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
        userService.deleteUser(id);
        <span class="hljs-keyword">return</span> ResponseEntity.noContent().build();
    }
}
</code></pre>
<h3 data-id="heading-12">总结</h3>
<p>通过上述步骤，我们在微服务架构中使用了Hibernate，配置了数据源，定义了实体类，创建了DAO层和服务层，并编写了RESTful API控制器。这使得每个微服务可以独立地进行数据库操作，实现了完整的CRUD功能。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernate（66）如何在分布式系统中使用Hibernate？]]></title>    <link>https://juejin.cn/post/7599528186587086858</link>    <guid>https://juejin.cn/post/7599528186587086858</guid>    <pubDate>2026-01-26T11:51:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599528186587086858" data-draft-id="7599478406238388233" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernate（66）如何在分布式系统中使用Hibernate？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-01-26T11:51:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernate（66）如何在分布式系统中使用Hibernate？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T11:51:26.000Z" title="Mon Jan 26 2026 11:51:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在分布式系统中使用Hibernate需要考虑多个方面，包括数据源配置、数据一致性、事务管理、以及各服务之间的通信和协调。分布式系统的关键特点是多个独立的服务（或微服务）各自处理自己的数据存储和业务逻辑。以下是详细的实现步骤和代码示例。</p>
<h3 data-id="heading-0">1. 项目依赖</h3>
<p>首先，在每个服务的构建文件中添加必要的依赖项。例如，如果你使用的是Maven来构建项目，可以在<code>pom.xml</code>中添加以下依赖项：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Hibernate Core --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hibernate<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hibernate-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.4.32.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- JPA API --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.persistence<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.persistence-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- HikariCP for Connection Pooling --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.zaxxer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>HikariCP<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- MySQL Connector --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.26<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Spring Data JPA if using Spring Boot --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h3 data-id="heading-1">2. 配置数据源</h3>
<p>在每个微服务中配置数据源和Hibernate属性。假设我们使用Spring Boot来简化配置：</p>
<h4 data-id="heading-2"><code>application.properties</code></h4>
<pre><code class="hljs language-properties" lang="properties">spring.datasource.url=jdbc:mysql://localhost:3306/mydatabase
spring.datasource.username=root
spring.datasource.password=rootpassword
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
</code></pre>
<h3 data-id="heading-3">3. 配置Hibernate的SessionFactory</h3>
<p>Spring Boot会自动配置<code>SessionFactory</code>，如果你使用其他框架，可能需要手动配置。</p>
<h3 data-id="heading-4">4. 定义实体类</h3>
<p>定义一个简单的实体类，例如<code>User</code>。</p>
<h4 data-id="heading-5"><code>User.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.Entity;
<span class="hljs-keyword">import</span> javax.persistence.GeneratedValue;
<span class="hljs-keyword">import</span> javax.persistence.GenerationType;
<span class="hljs-keyword">import</span> javax.persistence.Id;
<span class="hljs-keyword">import</span> javax.persistence.Table;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "users")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-keyword">private</span> String username;
    <span class="hljs-keyword">private</span> String password;

    <span class="hljs-comment">// Getters and Setters</span>
    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> username;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUsername</span><span class="hljs-params">(String username)</span> {
        <span class="hljs-built_in">this</span>.username = username;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPassword</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> password;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPassword</span><span class="hljs-params">(String password)</span> {
        <span class="hljs-built_in">this</span>.password = password;
    }
}
</code></pre>
<h3 data-id="heading-6">5. 创建DAO层</h3>
<p>创建一个数据访问对象（DAO）接口和实现类，用于访问数据库。如果使用Spring Data JPA，可以简化为一个接口。</p>
<h4 data-id="heading-7"><code>UserRepository.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JpaRepository</span>&lt;User, Long&gt; {
    User <span class="hljs-title function_">findByUsername</span><span class="hljs-params">(String username)</span>;
}
</code></pre>
<h3 data-id="heading-8">6. 创建服务层</h3>
<p>创建一个服务类，用于处理业务逻辑。</p>
<h4 data-id="heading-9"><code>UserService.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;
<span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserService</span><span class="hljs-params">(UserRepository userRepository)</span> {
        <span class="hljs-built_in">this</span>.userRepository = userRepository;
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">createUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-keyword">return</span> userRepository.save(user);
    }

    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUserById</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-keyword">return</span> userRepository.findById(id).orElse(<span class="hljs-literal">null</span>);
    }

    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">getAllUsers</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> userRepository.findAll();
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">updateUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-keyword">return</span> userRepository.save(user);
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(Long id)</span> {
        userRepository.deleteById(id);
    }
}
</code></pre>
<h3 data-id="heading-10">7. 编写控制器</h3>
<p>利用上述服务类来编写RESTful API控制器。</p>
<h4 data-id="heading-11"><code>UserController.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/users")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserService userService;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserController</span><span class="hljs-params">(UserService userService)</span> {
        <span class="hljs-built_in">this</span>.userService = userService;
    }

    <span class="hljs-meta">@PostMapping</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;User&gt; <span class="hljs-title function_">createUser</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">createdUser</span> <span class="hljs-operator">=</span> userService.createUser(user);
        <span class="hljs-keyword">return</span> ResponseEntity.ok(createdUser);
    }

    <span class="hljs-meta">@GetMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;User&gt; <span class="hljs-title function_">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userService.getUserById(id);
        <span class="hljs-keyword">return</span> ResponseEntity.ok(user);
    }

    <span class="hljs-meta">@GetMapping</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;List&lt;User&gt;&gt; <span class="hljs-title function_">getAllUsers</span><span class="hljs-params">()</span> {
        List&lt;User&gt; users = userService.getAllUsers();
        <span class="hljs-keyword">return</span> ResponseEntity.ok(users);
    }

    <span class="hljs-meta">@PutMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;User&gt; <span class="hljs-title function_">updateUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id, <span class="hljs-meta">@RequestBody</span> User user)</span> {
        user.setId(id);
        <span class="hljs-type">User</span> <span class="hljs-variable">updatedUser</span> <span class="hljs-operator">=</span> userService.updateUser(user);
        <span class="hljs-keyword">return</span> ResponseEntity.ok(updatedUser);
    }

    <span class="hljs-meta">@DeleteMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;Void&gt; <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
        userService.deleteUser(id);
        <span class="hljs-keyword">return</span> ResponseEntity.noContent().build();
    }
}
</code></pre>
<h3 data-id="heading-12">8. 分布式事务管理</h3>
<p>在分布式系统中，事务管理是一个重要问题。你可以使用分布式事务管理框架，例如Spring Cloud Sleuth、Spring Cloud Stream以及外部的事务协调器（如JTA或XA事务）。</p>
<h4 data-id="heading-13">使用Spring Cloud Sleuth和Spring Cloud Stream进行分布式跟踪</h4>
<p>在<code>pom.xml</code>中添加相关依赖：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-sleuth<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-stream-kafka<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>在<code>application.properties</code>中配置Kafka：</p>
<pre><code class="hljs language-properties" lang="properties">spring.cloud.stream.bindings.output.destination=mytopic
spring.cloud.stream.kafka.binder.brokers=localhost:9092
</code></pre>
<p>然后在服务层添加Kafka消息发送：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.cloud.stream.annotation.EnableBinding;
<span class="hljs-keyword">import</span> org.springframework.cloud.stream.messaging.Source;
<span class="hljs-keyword">import</span> org.springframework.messaging.support.MessageBuilder;

<span class="hljs-meta">@EnableBinding(Source.class)</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> Source source;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserService</span><span class="hljs-params">(UserRepository userRepository)</span> {
        <span class="hljs-built_in">this</span>.userRepository = userRepository;
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">createUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">savedUser</span> <span class="hljs-operator">=</span> userRepository.save(user);
        source.output().send(MessageBuilder.withPayload(savedUser).build());
        <span class="hljs-keyword">return</span> savedUser;
    }

    <span class="hljs-comment">// other methods...</span>
}
</code></pre>
<h3 data-id="heading-14">总结</h3>
<p>通过上述步骤，我们在分布式系统中使用了Hibernate，配置了数据源，定义了实体类，创建了DAO层和服务层，并编写了RESTful API控制器。此外，我们还使用Spring Cloud Sleuth和Spring Cloud Stream来实现分布式事务管理和分布式跟踪。这使得每个微服务可以独立地进行数据库操作，实现了完整的CRUD功能，并且能够管理分布式事务。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter-使用Gal展示和保存图片资源]]></title>    <link>https://juejin.cn/post/7599502282601824319</link>    <guid>https://juejin.cn/post/7599502282601824319</guid>    <pubDate>2026-01-26T11:51:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599502282601824319" data-draft-id="7596926832912056383" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter-使用Gal展示和保存图片资源 "/> <meta itemprop="keywords" content="前端,Flutter,Android"/> <meta itemprop="datePublished" content="2026-01-26T11:51:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="鹏多多"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter-使用Gal展示和保存图片资源 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    鹏多多
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T11:51:48.000Z" title="Mon Jan 26 2026 11:51:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"•";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>Gal 是 Flutter 生态中一款轻量、高性能的图片管理与预览插件，专为简化 Flutter 应用中图片选择、预览、保存等核心场景设计。它封装了原生平台的图片处理能力，提供统一的 API 接口，让开发者无需关注 iOS/Android 底层差异，快速实现专业级的图片交互体验。</p>
<h2 data-id="heading-0">1. Gal 插件核心功能</h2>
<p>Gal 插件的核心价值在于<strong>跨平台一致性</strong>和<strong>易用性</strong>，主要覆盖以下场景：</p>
<ol>
<li><strong>图片预览</strong>：支持单张/多张图片的沉浸式预览，包含缩放、滑动切换、手势返回等交互；</li>
<li><strong>相册操作</strong>：读取设备相册、筛选图片/视频、获取图片元信息（尺寸、路径、创建时间）；</li>
<li><strong>图片保存</strong>：将网络图片/本地图片保存到系统相册，自动处理权限申请；</li>
<li><strong>权限管理</strong>：封装相册读写权限的申请与状态检测，适配 iOS/Android 权限机制差异；</li>
<li><strong>性能优化</strong>：内置图片懒加载、内存缓存策略，避免大图集加载时的卡顿问题。</li>
</ol>
<h2 data-id="heading-1">2. 核心 API 与属性详解</h2>
<h3 data-id="heading-2">2.1. 基础配置</h3>
<p>使用 Gal 前需先完成初始化，并配置权限相关参数（pubspec.yaml 配置）：</p>
<p><strong>使用最新版本：</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">dependencies:</span>
  <span class="hljs-attr">gal:</span> <span class="hljs-string">^2.1.0</span> <span class="hljs-comment"># 建议使用最新稳定版</span>
</code></pre>
<p><strong>Android：</strong></p>
<pre><code class="hljs language-ini" lang="ini">
<span class="hljs-comment"># Android 权限配置（android/app/src/main/AndroidManifest.xml）</span>
&lt;uses-permission android:<span class="hljs-attr">name</span>=<span class="hljs-string">"android.permission.READ_EXTERNAL_STORAGE"</span>/&gt;
&lt;uses-permission android:<span class="hljs-attr">name</span>=<span class="hljs-string">"android.permission.WRITE_EXTERNAL_STORAGE"</span> android:maxSdkVersion=<span class="hljs-string">"32"</span>/&gt;
&lt;uses-permission android:<span class="hljs-attr">name</span>=<span class="hljs-string">"android.permission.MANAGE_EXTERNAL_STORAGE"</span>/&gt;
</code></pre>
<p><strong>iOS：</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet"># iOS 权限配置（ios/Runner/Info.plist）
&lt;<span class="hljs-keyword">key</span>&gt;NSPhotoLibraryUsageDescription&lt;/<span class="hljs-keyword">key</span>&gt;
&lt;<span class="hljs-type">string</span>&gt;需要访问相册以选择/保存图片&lt;/<span class="hljs-type">string</span>&gt;
&lt;<span class="hljs-keyword">key</span>&gt;NSPhotoLibraryAddUsageDescription&lt;/<span class="hljs-keyword">key</span>&gt;
&lt;<span class="hljs-type">string</span>&gt;需要写入权限以保存图片到相册&lt;/<span class="hljs-type">string</span>&gt;
</code></pre>
<h3 data-id="heading-3">2.2. 核心 API 列表</h3>









































<table><thead><tr><th>API 方法</th><th>功能描述</th><th>参数说明</th><th>返回值</th></tr></thead><tbody><tr><td><code>Gal.requestPermission()</code></td><td>申请相册读写权限</td><td><code>type</code>: 权限类型（<code>PermissionType.read</code>/<code>write</code>）</td><td><code>Future&lt;bool&gt;</code>: 是否授权成功</td></tr><tr><td><code>Gal.getPhotos()</code></td><td>获取相册图片列表</td><td><code>limit</code>: 加载数量（默认全部）<br/><code>albumId</code>: 指定相册 ID（可选）</td><td><code>Future&lt;List&lt;GalPhoto&gt;&gt;</code>: 图片信息列表</td></tr><tr><td><code>Gal.preview()</code></td><td>预览图片</td><td><code>photos</code>: 图片列表<br/><code>initialIndex</code>: 初始预览索引<br/><code>backgroundColor</code>: 预览背景色</td><td><code>Future&lt;void&gt;</code></td></tr><tr><td><code>Gal.saveImage()</code></td><td>保存图片到相册</td><td><code>path</code>: 图片本地路径/网络 URL<br/><code>albumName</code>: 自定义相册名称（可选）</td><td><code>Future&lt;bool&gt;</code>: 是否保存成功</td></tr><tr><td><code>Gal.getAlbums()</code></td><td>获取设备相册列表</td><td>-</td><td><code>Future&lt;List&lt;GalAlbum&gt;&gt;</code>: 相册信息列表</td></tr></tbody></table>
<h3 data-id="heading-4">2.3. 关键数据模型</h3>
<h4 data-id="heading-5">GalPhoto（图片信息模型）</h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GalPhoto</span> {
  <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> id; <span class="hljs-comment">// 图片唯一标识</span>
  <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> path; <span class="hljs-comment">// 本地路径</span>
  <span class="hljs-keyword">final</span> <span class="hljs-type">String</span>? url; <span class="hljs-comment">// 网络图片 URL（可选）</span>
  <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> width; <span class="hljs-comment">// 图片宽度</span>
  <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> height; <span class="hljs-comment">// 图片高度</span>
  <span class="hljs-keyword">final</span> DateTime createTime; <span class="hljs-comment">// 创建时间</span>
  <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> mimeType; <span class="hljs-comment">// 图片类型（image/jpeg 等）</span>
}
</code></pre>
<h4 data-id="heading-6">GalAlbum（相册信息模型）</h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GalAlbum</span> {
  <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> id; <span class="hljs-comment">// 相册唯一标识</span>
  <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> name; <span class="hljs-comment">// 相册名称</span>
  <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> count; <span class="hljs-comment">// 相册内图片数量</span>
  <span class="hljs-keyword">final</span> <span class="hljs-type">String</span>? coverPath; <span class="hljs-comment">// 相册封面路径</span>
}
</code></pre>
<h2 data-id="heading-7">3. 图片选择与预览功能Demo</h2>
<p>以下是一个完整的 Demo，实现「获取相册图片 → 列表展示 → 点击预览 → 保存图片」的核心流程。</p>
<h3 data-id="heading-8">3.1 完整代码</h3>
<pre><code class="hljs language-php" lang="php">import <span class="hljs-string">'package:flutter/material.dart'</span>;
import <span class="hljs-string">'package:gal/gal.dart'</span>;
import <span class="hljs-string">'package:permission_handler/permission_handler.dart'</span>;

<span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">main</span>() =&gt; <span class="hljs-title function_ invoke__">runApp</span>(<span class="hljs-keyword">const</span> <span class="hljs-title function_ invoke__">GalDemoApp</span>());

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GalDemoApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">GalDemoApp</span>({super.key});

  @override
  Widget <span class="hljs-title function_ invoke__">build</span>(BuildContext context) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">MaterialApp</span>(
      <span class="hljs-attr">title</span>: <span class="hljs-string">'Gal 插件 Demo'</span>,
      <span class="hljs-attr">theme</span>: <span class="hljs-title function_ invoke__">ThemeData</span>(<span class="hljs-attr">primarySwatch</span>: Colors.blue),
      <span class="hljs-attr">home</span>: <span class="hljs-keyword">const</span> <span class="hljs-title function_ invoke__">GalDemoPage</span>(),
    );
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GalDemoPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">GalDemoPage</span>({super.key});

  @override
  State&lt;GalDemoPage&gt; <span class="hljs-title function_ invoke__">createState</span>() =&gt; <span class="hljs-title function_ invoke__">_GalDemoPageState</span>();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_GalDemoPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">GalDemoPage</span>&gt; </span>{
  List&lt;GalPhoto&gt; _photos = [];
  <span class="hljs-keyword">bool</span> _isLoading = <span class="hljs-literal">false</span>;

  <span class="hljs-comment">// 申请相册权限</span>
  Future&lt;<span class="hljs-keyword">bool</span>&gt; <span class="hljs-title function_ invoke__">_requestPermission</span>() async {
    <span class="hljs-keyword">final</span> status = await Permission.photos.<span class="hljs-title function_ invoke__">request</span>();
    <span class="hljs-keyword">return</span> status.isGranted;
  }

  <span class="hljs-comment">// 加载相册图片</span>
  Future&lt;<span class="hljs-keyword">void</span>&gt; <span class="hljs-title function_ invoke__">_loadPhotos</span>() async {
    <span class="hljs-title function_ invoke__">setState</span>(() =&gt; _isLoading = <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">final</span> hasPermission = await <span class="hljs-title function_ invoke__">_requestPermission</span>();
      <span class="hljs-keyword">if</span> (!hasPermission) {
        <span class="hljs-keyword">if</span> (mounted) {
          ScaffoldMessenger.<span class="hljs-title function_ invoke__">of</span>(context).<span class="hljs-title function_ invoke__">showSnackBar</span>(
            <span class="hljs-keyword">const</span> <span class="hljs-title function_ invoke__">SnackBar</span>(<span class="hljs-attr">content</span>: <span class="hljs-title function_ invoke__">Text</span>(<span class="hljs-string">'请授予相册访问权限'</span>)),
          );
        }
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-comment">// 获取相册图片（限制加载20张，避免性能问题）</span>
      <span class="hljs-keyword">final</span> photos = await Gal.<span class="hljs-title function_ invoke__">getPhotos</span>(<span class="hljs-attr">limit</span>: <span class="hljs-number">20</span>);
      <span class="hljs-title function_ invoke__">setState</span>(() =&gt; _photos = photos);
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">if</span> (mounted) {
        ScaffoldMessenger.<span class="hljs-title function_ invoke__">of</span>(context).<span class="hljs-title function_ invoke__">showSnackBar</span>(
          <span class="hljs-title function_ invoke__">SnackBar</span>(<span class="hljs-attr">content</span>: <span class="hljs-title function_ invoke__">Text</span>(<span class="hljs-string">'加载图片失败：$e'</span>)),
        );
      }
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-title function_ invoke__">setState</span>(() =&gt; _isLoading = <span class="hljs-literal">false</span>);
    }
  }

  <span class="hljs-comment">// 预览图片</span>
  <span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">_previewPhoto</span>(<span class="hljs-keyword">int</span> index) async {
    await Gal.<span class="hljs-title function_ invoke__">preview</span>(
      <span class="hljs-attr">photos</span>: _photos,
      <span class="hljs-attr">initialIndex</span>: index,
      <span class="hljs-attr">backgroundColor</span>: Colors.black,
    );
  }

  <span class="hljs-comment">// 保存示例图片到相册</span>
  Future&lt;<span class="hljs-keyword">void</span>&gt; <span class="hljs-title function_ invoke__">_saveSampleImage</span>() async {
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">sampleImageUrl</span> = <span class="hljs-string">'https://picsum.photos/800/600'</span>;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">final</span> success = await Gal.<span class="hljs-title function_ invoke__">saveImage</span>(
        sampleImageUrl,
        <span class="hljs-attr">albumName</span>: <span class="hljs-string">'Gal Demo'</span>, // 自定义相册名称
      );
      <span class="hljs-keyword">if</span> (success) {
        <span class="hljs-keyword">if</span> (mounted) {
          ScaffoldMessenger.<span class="hljs-title function_ invoke__">of</span>(context).<span class="hljs-title function_ invoke__">showSnackBar</span>(
            <span class="hljs-keyword">const</span> <span class="hljs-title function_ invoke__">SnackBar</span>(<span class="hljs-attr">content</span>: <span class="hljs-title function_ invoke__">Text</span>(<span class="hljs-string">'图片保存成功'</span>)),
          );
          <span class="hljs-comment">// 保存后重新加载图片列表</span>
          <span class="hljs-title function_ invoke__">_loadPhotos</span>();
        }
      }
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">if</span> (mounted) {
        ScaffoldMessenger.<span class="hljs-title function_ invoke__">of</span>(context).<span class="hljs-title function_ invoke__">showSnackBar</span>(
          <span class="hljs-title function_ invoke__">SnackBar</span>(<span class="hljs-attr">content</span>: <span class="hljs-title function_ invoke__">Text</span>(<span class="hljs-string">'保存失败：$e'</span>)),
        );
      }
    }
  }

  @override
  <span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">initState</span>() {
    super.<span class="hljs-title function_ invoke__">initState</span>();
    <span class="hljs-comment">// 页面初始化时加载图片</span>
    <span class="hljs-title function_ invoke__">_loadPhotos</span>();
  }

  @override
  Widget <span class="hljs-title function_ invoke__">build</span>(BuildContext context) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Scaffold</span>(
      <span class="hljs-attr">appBar</span>: <span class="hljs-title function_ invoke__">AppBar</span>(
        <span class="hljs-attr">title</span>: <span class="hljs-keyword">const</span> <span class="hljs-title function_ invoke__">Text</span>(<span class="hljs-string">'Gal 图片管理 Demo'</span>),
        <span class="hljs-attr">actions</span>: [
          <span class="hljs-title function_ invoke__">IconButton</span>(
            <span class="hljs-attr">icon</span>: <span class="hljs-keyword">const</span> <span class="hljs-title function_ invoke__">Icon</span>(Icons.save),
            <span class="hljs-attr">onPressed</span>: _saveSampleImage,
            <span class="hljs-attr">tooltip</span>: <span class="hljs-string">'保存示例图片'</span>,
          ),
        ],
      ),
      <span class="hljs-attr">body</span>: <span class="hljs-title function_ invoke__">_buildBody</span>(),
    );
  }

  Widget <span class="hljs-title function_ invoke__">_buildBody</span>() {
    <span class="hljs-keyword">if</span> (_isLoading) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">Center</span>(child: <span class="hljs-title function_ invoke__">CircularProgressIndicator</span>());
    }
    <span class="hljs-keyword">if</span> (_photos.isEmpty) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">Center</span>(child: <span class="hljs-title function_ invoke__">Text</span>(<span class="hljs-string">'暂无图片，请检查权限或相册内容'</span>));
    }
    <span class="hljs-comment">// 网格展示图片</span>
    <span class="hljs-keyword">return</span> GridView.<span class="hljs-title function_ invoke__">builder</span>(
      <span class="hljs-attr">padding</span>: <span class="hljs-keyword">const</span> EdgeInsets.<span class="hljs-title function_ invoke__">all</span>(<span class="hljs-number">8</span>),
      <span class="hljs-attr">gridDelegate</span>: <span class="hljs-keyword">const</span> <span class="hljs-title function_ invoke__">SliverGridDelegateWithFixedCrossAxisCount</span>(
        <span class="hljs-attr">crossAxisCount</span>: <span class="hljs-number">3</span>, // 每行<span class="hljs-number">3</span>列
        <span class="hljs-attr">crossAxisSpacing</span>: <span class="hljs-number">4</span>,
        <span class="hljs-attr">mainAxisSpacing</span>: <span class="hljs-number">4</span>,
        <span class="hljs-attr">childAspectRatio</span>: <span class="hljs-number">1</span>, // 宽高比<span class="hljs-number">1</span>:<span class="hljs-number">1</span>
      ),
      <span class="hljs-attr">itemCount</span>: _photos.length,
      <span class="hljs-attr">itemBuilder</span>: (context, index) {
        <span class="hljs-keyword">final</span> photo = _photos[index];
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">GestureDetector</span>(
          <span class="hljs-attr">onTap</span>: () =&gt; <span class="hljs-title function_ invoke__">_previewPhoto</span>(index),
          child: Image.<span class="hljs-title function_ invoke__">file</span>(
            <span class="hljs-title function_ invoke__">File</span>(photo.path),
            <span class="hljs-attr">fit</span>: BoxFit.cover,
            <span class="hljs-attr">errorBuilder</span>: (context, error, stackTrace) {
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">Icon</span>(Icons.broken_image, color: Colors.grey);
            },
          ),
        );
      },
    );
  }
}
</code></pre>
<h3 data-id="heading-9">3.2. 代码说明</h3>
<ol>
<li><strong>权限处理</strong>：结合 <code>permission_handler</code> 插件申请相册权限，这是使用 Gal 的前提；</li>
<li><strong>图片加载</strong>：通过 <code>Gal.getPhotos()</code> 获取相册图片，限制加载数量避免卡顿；</li>
<li><strong>图片展示</strong>：使用 <code>GridView</code> 展示图片列表，点击图片调用 <code>Gal.preview()</code> 实现沉浸式预览；</li>
<li><strong>图片保存</strong>：调用 <code>Gal.saveImage()</code> 将网络图片保存到自定义相册，保存成功后刷新列表。</li>
</ol>
<h3 data-id="heading-10">3.3. 运行效果</h3>
<ol>
<li>首次打开应用会弹出权限申请弹窗，授权后加载相册前20张图片；</li>
<li>图片以网格形式展示，点击任意图片进入全屏预览模式，支持滑动切换、双指缩放；</li>
<li>点击右上角「保存」按钮，可将示例网络图片保存到「Gal Demo」相册，保存后列表自动刷新。</li>
</ol>
<h2 data-id="heading-11">4. 注意事项</h2>
<ol>
<li>
<p><strong>权限适配</strong>：</p>
<ol>
<li>Android 13+ 需单独申请 <code>READ_MEDIA_IMAGES</code> 权限，Android 10 需配置 <code>android:requestLegacyExternalStorage="true"</code>；</li>
<li>iOS 14+ 支持精确相册权限（仅允许选择部分图片），Gal 已适配该特性。</li>
</ol>
</li>
<li>
<p><strong>性能优化</strong>：</p>
<ol>
<li>加载大量图片时，务必设置 <code>limit</code> 参数分页加载，避免一次性加载全部图片导致内存溢出；</li>
<li>预览图片时，建议使用 <code>CachedNetworkImage</code> 缓存网络图片。</li>
</ol>
</li>
<li>
<p><strong>异常处理</strong>：</p>
<ol>
<li>所有 Gal API 均为异步操作，需添加 <code>try/catch</code> 捕获权限拒绝、文件不存在等异常；</li>
<li>保存网络图片时，需先判断网络状态，避免无网络时保存失败。</li>
</ol>
</li>
</ol>
<h2 data-id="heading-12">5. 总结</h2>
<ol>
<li>Gal 插件是 Flutter 中高效的图片管理工具，核心覆盖「权限申请、图片读取、预览、保存」四大核心场景，API 设计简洁且跨平台一致；</li>
<li>使用 Gal 的关键步骤：配置权限 → 申请权限 → 调用核心 API → 异常处理；</li>
<li>实战中需注意性能优化（分页加载、缓存）和平台适配（不同系统的权限/路径差异），确保体验一致性。</li>
</ol>
<p>通过 Gal 插件，开发者可以摆脱原生图片处理的繁琐逻辑，快速实现媲美原生应用的图片交互体验，是 Flutter 图片类应用的优选插件。</p>
<p>源码：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnatsuk4ze%2Fgal%2Fblob%2Fmain%2Fexample%2Flib%2Fmain.dart" target="_blank" title="https://github.com/natsuk4ze/gal/blob/main/example/lib/main.dart" ref="nofollow noopener noreferrer">传送门</a></p>
<hr/>
<blockquote>
<p>本次分享就到这儿啦，我是鹏多多，深耕前端的技术创作者，如果您看了觉得有帮助，欢迎评论，关注，点赞，转发，我们下次见~</p>
</blockquote>
<p>PS：在本页按F12，在console中输入document.getElementsByClassName('panel-btn')[0].click();有惊喜哦~</p>
<p><code>往期文章</code></p>
<ul>
<li><a href="https://juejin.cn/post/7583910637958807571" target="_blank" title="https://juejin.cn/post/7583910637958807571">flutter使用package_info_plus库获取应用信息的教程</a></li>
<li><a href="https://juejin.cn/post/7588680081327259690" target="_blank" title="https://juejin.cn/post/7588680081327259690">Flutter下拉刷新上拉加载侧拉刷新插件：easy_refresh全面使用指南</a></li>
<li><a href="https://juejin.cn/post/7583226204036513833" target="_blank" title="https://juejin.cn/post/7583226204036513833">flutter-使用EventBus实现组件间数据通信</a></li>
<li><a href="https://juejin.cn/post/7582808491582619684" target="_blank" title="https://juejin.cn/post/7582808491582619684">Flutter输入框TextField的属性与实战用法全面解析+示例</a></li>
<li><a href="https://juejin.cn/post/7581693431740448831" target="_blank" title="https://juejin.cn/post/7581693431740448831">Flutter自定义日历table_calendar完全指南+案例</a></li>
<li><a href="https://juejin.cn/post/7580389111921786943" target="_blank" title="https://juejin.cn/post/7580389111921786943">flutter-屏幕自适应插件flutter_screenutil教程全指南</a></li>
<li><a href="https://juejin.cn/post/7579101504289882166" target="_blank" title="https://juejin.cn/post/7579101504289882166">flutter-使用url_launcher打开链接/应用/短信/邮件和评分跳转等</a></li>
<li><a href="https://juejin.cn/post/7570923924365230143" target="_blank" title="https://juejin.cn/post/7570923924365230143">flutter图片选择库multi_image_picker_plus和image_picker的对比和使用解析</a></li>
<li><a href="https://juejin.cn/post/7568136081302978623" target="_blank" title="https://juejin.cn/post/7568136081302978623">解锁flutter弹窗新姿势：dialog-flutter_smart_dialog插件解读+案例</a></li>
<li><a href="https://juejin.cn/post/7559089440901545999" target="_blank" title="https://juejin.cn/post/7559089440901545999">flutter-切换状态显示不同组件10种实现方案全解析</a></li>
<li><a href="https://juejin.cn/post/7555079970491318308" target="_blank" title="https://juejin.cn/post/7555079970491318308">flutter-详解控制组件显示的两种方式Offstage与Visibility</a></li>
<li><a href="https://juejin.cn/post/7535358416182788122" target="_blank" title="https://juejin.cn/post/7535358416182788122">flutter-使用AnimatedDefaultTextStyle实现文本动画</a></li>
<li><a href="https://juejin.cn/post/7537339432291434496" target="_blank" title="https://juejin.cn/post/7537339432291434496">flutter-使用SafeArea组件处理各机型的安全距离</a></li>
<li><a href="https://juejin.cn/spost/7537593417099149321" target="_blank" title="https://juejin.cn/spost/7537593417099149321">flutter-实现渐变色边框背景以及渐变色文字</a></li>
<li><a href="https://juejin.cn/post/7543474419240370185" target="_blank" title="https://juejin.cn/post/7543474419240370185">flutter-使用confetti制作炫酷纸屑爆炸粒子动画</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[我尝试将TinyPro集成TinyEngine低代码设计器了]]></title>    <link>https://juejin.cn/post/7599294170001276979</link>    <guid>https://juejin.cn/post/7599294170001276979</guid>    <pubDate>2026-01-26T11:57:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599294170001276979" data-draft-id="7599543345980293147" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="我尝试将TinyPro集成TinyEngine低代码设计器了"/> <meta itemprop="keywords" content="前端,Vue.js,低代码"/> <meta itemprop="datePublished" content="2026-01-26T11:57:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OpenTiny社区"/> <meta itemprop="url" content="https://juejin.cn/user/3808325101432983"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            我尝试将TinyPro集成TinyEngine低代码设计器了
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808325101432983/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OpenTiny社区
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T11:57:01.000Z" title="Mon Jan 26 2026 11:57:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>TinyPro</strong> 与 <strong>TinyEngine</strong> 是 OpenTiny 开源生态的重要组成部分：</p>
<ul>
<li><strong>TinyPro</strong> 提供企业级后台系统模板</li>
<li><strong>TinyEngine</strong> 提供灵活强大的低代码引擎</li>
</ul>
<p>本项目在 TinyPro 中深度集成了基于 TinyEngine 的低代码设计器，通过 <strong>插件化架构</strong> 构建出可扩展的低代码开发平台。</p>
<p>借助它，你只需在可视化设计器中完成页面设计，就能一键导入 TinyPro，并自动生成菜单、权限及国际化配置，实现真正的 <strong>“所见即所得”</strong> 式开发体验。</p>
<h2 data-id="heading-0">整体架构</h2>
<pre><code class="hljs language-bash" lang="bash">lowcode-designer/
├── src/
│   ├── main.js              <span class="hljs-comment"># 应用入口</span>
│   ├── composable/          <span class="hljs-comment"># 可组合逻辑</span>
│   ├── configurators/       <span class="hljs-comment"># 配置器</span>
├── registry.js              <span class="hljs-comment"># 插件注册表</span>
├── engine.config.js         <span class="hljs-comment"># 引擎配置</span>
└── vite.config.js          <span class="hljs-comment"># 构建配置</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd6ff94aae094b7ca3fc011e60b8d02f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770033420&amp;x-signature=%2BnIpSNGZQqts%2FrBAxfcZcy%2F%2FSqE%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-1">核心组成部分</h3>
<ol>
<li><strong>TinyEngine 核心</strong>：提供低代码设计器的基础能力</li>
<li><strong>插件系统</strong>：通过插件扩展功能</li>
<li><strong>注册表机制</strong>：统一管理插件和服务</li>
<li><strong>配置器系统</strong>：自定义组件属性配置</li>
</ol>
<h3 data-id="heading-2">核心特性</h3>
<ul>
<li>✨ <strong>智能代码生成</strong>：基于可视化设计自动生成符合 TinyPro 规范的 Vue 3 + TypeScript 代码</li>
<li>🔐 <strong>自动认证管理</strong>：智能获取和管理 API Token，支持多种认证方式</li>
<li>🎯 <strong>一键集成</strong>：自动创建菜单、配置权限、添加国际化词条</li>
<li>🛠️ <strong>代码转换</strong>：将 TinyEngine 生成的代码自动转换为 TinyPro 项目兼容格式</li>
<li>💾 <strong>本地保存</strong>：支持将生成的文件保存到本地文件系统</li>
<li>🎨 <strong>可视化配置</strong>：提供友好的 UI 界面进行菜单和路由配置</li>
</ul>
<h2 data-id="heading-3">快速开始</h2>
<h3 data-id="heading-4">安装</h3>
<p>使用 TinyCli 可以快速初始化 TinyPro 模版</p>
<pre><code class="hljs language-bash" lang="bash">tiny init pro 
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba7759297cc24292989e06ed9b79b378~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770033420&amp;x-signature=aQNnzurBBJkKsVkojq8V2sKeEVw%3D" alt="image 1.png" loading="lazy"/></p>
<p><strong>启动低代码设计器</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> lowcode-designer
pnpm install
pnpm dev
</code></pre>
<p><strong>启动前端与后端</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> web
pnpm install
pnpm start

<span class="hljs-built_in">cd</span> nestJs
pnpm install
pnpm start
</code></pre>
<p>启动完成后，访问 👉 <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8090%2F" target="_blank" title="http://localhost:8090/" ref="nofollow noopener noreferrer"><strong>http://localhost:8090</strong></a> 即可体验低代码设计器。</p>
<h3 data-id="heading-5">使用流程</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/233928bddc7d442f9cb2b33504b58d70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770033420&amp;x-signature=cEvz0RD3L8GM7OgZiOBe%2BMdt0%2FE%3D" alt="image 2.png" loading="lazy"/></p>
<p><strong>设计页面</strong>：在 TinyEngine 可视化编辑器中设计页面</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0bea77e64a364168bcf4d4d091a6a3a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770033420&amp;x-signature=sHGrYf56jU%2BG9iyvRv6Io39g6rE%3D" alt="image 3.png" loading="lazy"/></p>
<p><strong>点击出码按钮</strong>：点击工具栏中的”出码”按钮</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e466ff9c20984d03b856948c8214a602~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770033420&amp;x-signature=YAuLr436skwilB5eUAGvXXSogY4%3D" alt="image 4.png" loading="lazy"/></p>
<p><strong>配置菜单信息</strong>：在弹出的对话框中填写菜单配置信息</p>
<p><strong>生成预览</strong>：点击”生成预览”查看将要生成的文件</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fad04fe1bd554c638f7a4b8e4e06cec7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770033420&amp;x-signature=Ys6xQe7Nqg7CCckRjuj6ZDoLl8I%3D" alt="image 5.png" loading="lazy"/></p>
<p><strong>完成集成</strong>：点击”完成集成”自动创建菜单、分配权限并保存文件</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b0ff92d20834bd684ae92463e4fae5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770033420&amp;x-signature=g2hNyc3vQrl8F50vsqJbTCKSeHY%3D" alt="image 6.png" loading="lazy"/></p>
<p>接下来我们就可以直接去 TinyPro 直接看到页面效果</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e348c126b18b4904a8ac4b964f94e7f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770033420&amp;x-signature=oQ6dGDRLJi3TYBPmBcplg%2BgNl4w%3D" alt="image 7.png" loading="lazy"/></p>
<h3 data-id="heading-6">TinyPro Generate Code 插件解析</h3>
<h4 data-id="heading-7">插件目录结构</h4>
<pre><code class="hljs language-bash" lang="bash">generate-code-tinypro/
├── package.json              <span class="hljs-comment"># 插件包配置</span>
├── src/
│   ├── index.js             <span class="hljs-comment"># 插件入口</span>
│   ├── meta.js              <span class="hljs-comment"># 元数据定义</span>
│   ├── Main.vue             <span class="hljs-comment"># 主组件</span>
│   ├── SystemIntegration.vue <span class="hljs-comment"># 功能组件</span>
│   ├── components/          <span class="hljs-comment"># 通用组件</span>
│   │   ├── ToolbarBase.vue
│   │   ├── ToolbarBaseButton.vue
│   │   └── ToolbarBaseIcon.vue
│   ├── composable/          <span class="hljs-comment"># 可组合逻辑</span>
│   │   ├── index.js
│   │   └── useSaveLocal.js
│   └── http.js              <span class="hljs-comment"># HTTP 服务</span>
├── vite.config.js           <span class="hljs-comment"># 构建配置</span>
└── README.md                <span class="hljs-comment"># 文档</span>
</code></pre>
<h4 data-id="heading-8">代码生成流程</h4>
<pre><code class="hljs language-markdown" lang="markdown">const generatePreview = async () =&gt; {
  // 1. 获取当前页面的 Schema
  const currentSchema = getSchema();

  // 2. 获取应用元数据（i18n、dataSource、utils等）
  const metaData = await fetchMetaData(params);

  // 3. 获取页面列表和区块信息
  const pageList = await fetchPageList(appId);
  const blockSchema = await getAllNestedBlocksSchema();

  // 4. 调用代码生成引擎
  const result = await generateAppCode(appSchema);

  // 5. 过滤和转换生成的代码
  const transformedFiles = filteredFiles.map((file) =&gt; ({
<span class="hljs-code">    ...file,
    fileContent: transformForTinyPro(file.fileContent),
  }));
};
</span></code></pre>
<h4 data-id="heading-9">TinyPro 与 TinyEngine 通信</h4>
<p>当用户在低代码设计器中点击“完成集成”时，插件首先通过 <strong>Token Manager</strong> 向认证接口 <code>/api/auth/api-token</code> 请求并获取访问凭证（Token），随后利用该 Token 调用一系列后台接口，包括国际化 API、菜单 API 和角色 API。插件通过这些接口自动完成 <strong>页面国际化词条创建、菜单注册、角色查询与权限分配</strong> 等步骤。整个过程中，<code>HTTP Client</code> 统一负责与后端通信，而返回的数据（菜单信息、角色信息、权限配置等）会实时更新到本地，最终实现了从页面设计到系统集成的一键闭环，使 TinyEngine 生成的页面能无缝接入 TinyPro 系统。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6085b1fbba646239805fa36567aab32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770033420&amp;x-signature=jbmjEGmNIeFf2MhDMKjhSWKNhCo%3D" alt="image 8.png" loading="lazy"/></p>
<h2 data-id="heading-10">总结</h2>
<p>通过 <strong>TinyPro 与 TinyEngine 的深度融合</strong>，我们实现了从「可视化设计」到「系统集成」的完整闭环，让<strong>不会写代码的用户也能轻松构建出高质量的前端页面</strong>。</p>
<p>用户只需拖拽组件、填写配置、点击“出码”，插件便会自动生成符合 TinyPro 标准的代码，并完成菜单、权限、国际化等系统级配置。</p>
<p>这一过程无需手动修改代码或后台配置，就能一键完成页面创建、接口绑定与权限分配，实现真正意义上的「低门槛、高效率、可扩展」的前端开发体验。</p>
<h2 data-id="heading-11">关于OpenTiny</h2>
<p>欢迎加入 OpenTiny 开源社区。添加微信小助手：opentiny-official 一起参与交流前端技术～<br/>
OpenTiny 官网：<a href="https://link.juejin.cn?target=https%3A%2F%2Fopentiny.design" target="_blank" title="https://opentiny.design" ref="nofollow noopener noreferrer">opentiny.design</a><br/>
OpenTiny 代码仓库：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny" target="_blank" title="https://github.com/opentiny" ref="nofollow noopener noreferrer">github.com/opentiny</a><br/>
TinyPro 源码：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-pro" target="_blank" title="https://github.com/opentiny/tiny-pro" ref="nofollow noopener noreferrer">github.com/opentiny/ti…</a><br/>
TinyEngine 源码： <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-engine" target="_blank" title="https://github.com/opentiny/tiny-engine" ref="nofollow noopener noreferrer">github.com/opentiny/ti…</a></p>
<p>欢迎进入代码仓库 Star🌟TinyPro、TinyEngine、TinyVue、TinyNG、TinyCLI、TinyEditor~</p>
<p>如果你也想要共建，可以进入代码仓库，找到 good first issue 标签，一起参与开源贡献~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Swift 常用框架Kingfisher、KingfisherWebP详解]]></title>    <link>https://juejin.cn/post/7599155566298136619</link>    <guid>https://juejin.cn/post/7599155566298136619</guid>    <pubDate>2026-01-26T10:00:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599155566298136619" data-draft-id="7599237603976560683" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Swift 常用框架Kingfisher、KingfisherWebP详解"/> <meta itemprop="keywords" content="Swift,iOS"/> <meta itemprop="datePublished" content="2026-01-26T10:00:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Haha_bj"/> <meta itemprop="url" content="https://juejin.cn/user/2612027844214647"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Swift 常用框架Kingfisher、KingfisherWebP详解
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612027844214647/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Haha_bj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:00:33.000Z" title="Mon Jan 26 2026 10:00:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">1.1 什么是 Kingfisher 、KingfisherWebP</h3>
<p>Kingfisher 是一个功能强大的 Swift 库，专门用于处理图像的下载、缓存和展示。目前已成为 iOS/macOS 开发中最受欢迎的图像处理解决方案之一。</p>
<p>KingfisherWebP 是 Kingfisher 的官方扩展，用于支持 WebP 图像格式。WebP 是 Google 开发的一种现代图像格式，它可以在相同质量下提供比 JPEG 和 PNG 更小的文件大小，从而减少带宽使用和加快加载速度。</p>
<h3 data-id="heading-1">1.2 核心特性</h3>
<ul>
<li>异步下载 ：在后台线程下载图片，不阻塞主线程</li>
<li>多级缓存 ：内存缓存 + 磁盘缓存，提高加载速度</li>
<li>自动缓存管理 ：智能处理缓存大小和过期时间</li>
<li>图片处理 ：支持下载后处理，如圆角、模糊等</li>
<li>请求优先级 ：可设置不同图片请求的优先级</li>
<li>可扩展性 ：支持自定义缓存、下载器等组件</li>
<li>SwiftUI 支持 ：提供了便捷的 SwiftUI 视图扩展</li>
<li>动画支持 ：支持 GIF 等动画图片</li>
</ul>
<h3 data-id="heading-2">1.3 安装方式</h3>
<p>Kingfisher 支持多种安装方式：</p>
<p>CocoaPods:</p>
<pre><code class="hljs language-arduino" lang="arduino">pod <span class="hljs-string">'Kingfisher'</span>
pod <span class="hljs-string">'KingfisherWebP'</span>
</code></pre>
<h3 data-id="heading-3">2. Kingfisher 基础用法</h3>
<h3 data-id="heading-4">2.1 基本图片加载</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Kingfisher</span>

<span class="hljs-comment">// 基本用法</span>
imageView.<span class="hljs-property">kf</span>.<span class="hljs-title function_">setImage</span>(<span class="hljs-attr">with</span>: <span class="hljs-title function_">URL</span>(<span class="hljs-attr">string</span>: <span class="hljs-string">"https://example.com/image.jpg"</span>))

<span class="hljs-comment">// 带选项的用法</span>
imageView.<span class="hljs-property">kf</span>.<span class="hljs-title function_">setImage</span>(<span class="hljs-params">
    <span class="hljs-keyword">with</span>: URL(<span class="hljs-built_in">string</span>: <span class="hljs-string">"https://example.com/image.jpg"</span>),
    placeholder: UIImage(named: <span class="hljs-string">"placeholder"</span>),
    options: [
        .transition(.fade(<span class="hljs-number">0.2</span>)),
        .cacheOriginalImage
    ]
</span>) { result <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">switch</span> result {
    <span class="hljs-keyword">case</span> .<span class="hljs-title function_">success</span>(<span class="hljs-keyword">let</span> value):
        <span class="hljs-title function_">print</span>(<span class="hljs-string">"Image loaded: \(value.image)"</span>)
        <span class="hljs-title function_">print</span>(<span class="hljs-string">"图片加载成功: \(value.source.url?.absoluteString ?? "</span><span class="hljs-string">")"</span>)
    <span class="hljs-keyword">case</span> .<span class="hljs-title function_">failure</span>(<span class="hljs-keyword">let</span> error):
        <span class="hljs-title function_">print</span>(<span class="hljs-string">"图片加载失败: \(error.localizedDescription)"</span>)
    }
}
</code></pre>
<h3 data-id="heading-5">2.2 缓存控制</h3>
<pre><code class="hljs language-scss" lang="scss"> <span class="hljs-comment">// 清除内存缓存</span>
KingfisherManager<span class="hljs-selector-class">.shared</span><span class="hljs-selector-class">.cache</span><span class="hljs-selector-class">.clearMemoryCache</span>()

<span class="hljs-comment">// 清除磁盘缓存</span>
KingfisherManager<span class="hljs-selector-class">.shared</span><span class="hljs-selector-class">.cache</span><span class="hljs-selector-class">.clearDiskCache</span>()

<span class="hljs-comment">// 清除所有缓存</span>
KingfisherManager<span class="hljs-selector-class">.shared</span><span class="hljs-selector-class">.cache</span><span class="hljs-selector-class">.clearCache</span>()

</code></pre>
<h3 data-id="heading-6">2.3 预加载图像</h3>
<p>预加载一组图像以提升加载速度，适合在应用启动时或预期需要时使用。</p>
<pre><code class="hljs language-scss" lang="scss"> let urls = <span class="hljs-selector-attr">[URL(string: <span class="hljs-string">"https://example.com/image1.png"</span>)!, URL(string: <span class="hljs-string">"https://example.com/image2.png"</span>)!]</span>
 <span class="hljs-built_in">ImagePrefetcher</span>(urls: urls)<span class="hljs-selector-class">.start</span>()
</code></pre>
<h3 data-id="heading-7">2.4 显示WebP</h3>
<pre><code class="hljs language-csharp" lang="csharp"> <span class="hljs-comment"><span class="hljs-doctag">///</span> 全局配置</span>
KingfisherManager.shared.defaultOptions += [.processor(WebPProcessor.<span class="hljs-literal">default</span>),.cacheSerializer(WebPSerializer.<span class="hljs-literal">default</span>)]

<span class="hljs-comment">// 使用 AnimatedImageView 定义ImageView</span>

 <span class="hljs-keyword">let</span> animageView = AnimatedImageView()
 animageView.kf.setImage(<span class="hljs-keyword">with</span>: URL(<span class="hljs-built_in">string</span>: <span class="hljs-string">"https://example.com/image.webp"</span>))

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[langchain-向量数据库学习总结]]></title>    <link>https://juejin.cn/post/7599528186586431498</link>    <guid>https://juejin.cn/post/7599528186586431498</guid>    <pubDate>2026-01-26T10:01:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599528186586431498" data-draft-id="7599528186586415114" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="langchain-向量数据库学习总结"/> <meta itemprop="keywords" content="前端,后端"/> <meta itemprop="datePublished" content="2026-01-26T10:01:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="心在飞扬AI"/> <meta itemprop="url" content="https://juejin.cn/user/1556564194366823"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            langchain-向量数据库学习总结
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1556564194366823/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    心在飞扬AI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:01:46.000Z" title="Mon Jan 26 2026 10:01:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    15
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">向量数据库学习总结</h2>
<hr/>
<h3 data-id="heading-1">一、FAISS 向量库</h3>
<h4 data-id="heading-2">1. FAISS 向量库创建与保存</h4>
<p><strong>这是什么</strong></p>
<ul>
<li>FAISS（Facebook AI Similarity Search）是Facebook开源的向量相似度搜索库</li>
<li>用于本地存储和检索高维向量数据，无需外部服务依赖</li>
</ul>
<p><strong>有什么用</strong></p>
<ul>
<li>本地开发环境快速搭建向量检索能力</li>
<li>小规模应用（&lt;10万条数据）的最佳选择</li>
<li>RAG系统的基础组件，为LLM提供知识库检索</li>
</ul>
<p><strong>示例代码</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> FAISS
<span class="hljs-keyword">from</span> langchain_community.embeddings <span class="hljs-keyword">import</span> QianfanEmbeddingsEndpoint
<span class="hljs-keyword">from</span> langchain_core.documents <span class="hljs-keyword">import</span> Document

<span class="hljs-comment"># 初始化嵌入模型</span>
embedding = QianfanEmbeddingsEndpoint()

<span class="hljs-comment"># 准备文档数据</span>
documents = [
    Document(page_content=<span class="hljs-string">"我养了一只猫，叫笨笨"</span>, metadata={<span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>}),
    Document(page_content=<span class="hljs-string">"我养了一只狗，叫旺财"</span>, metadata={<span class="hljs-string">"id"</span>: <span class="hljs-number">2</span>}),
]

<span class="hljs-comment"># 创建 FAISS 向量数据库</span>
db = FAISS.from_documents(documents, embedding)

<span class="hljs-comment"># 保存到本地</span>
db.save_local(<span class="hljs-string">"./vector-store/"</span>)
</code></pre>
<hr/>
<h4 data-id="heading-3">2.  FAISS 向量库加载与检索</h4>
<p><strong>这是什么</strong></p>
<ul>
<li>从本地加载已保存的FAISS索引文件</li>
<li>执行相似度搜索并返回匹配结果</li>
</ul>
<p><strong>有什么用</strong></p>
<ul>
<li>持久化向量数据，避免每次重新计算Embedding</li>
<li>生产环境中快速启动检索服务</li>
</ul>
<p><strong>示例代码</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> FAISS
<span class="hljs-keyword">from</span> langchain_community.embeddings <span class="hljs-keyword">import</span> QianfanEmbeddingsEndpoint

embedding = QianfanEmbeddingsEndpoint()

<span class="hljs-comment"># 从本地加载向量库</span>
db = FAISS.load_local(
    <span class="hljs-string">"./vector-store/"</span>,
    embedding,
    allow_dangerous_deserialization=<span class="hljs-literal">True</span>
)

<span class="hljs-comment"># 执行相似度搜索（返回距离分数）</span>
results = db.similarity_search_with_score(<span class="hljs-string">"我养了一只猫，叫笨笨"</span>)
<span class="hljs-comment"># 输出：[(Document(...), 0.123), (Document(...), 0.456)]</span>
</code></pre>
<hr/>
<h3 data-id="heading-4">二、腾讯云 VectorDB</h3>
<h4 data-id="heading-5">3. 腾讯云VectorDB内置Embedding</h4>
<p><strong>这是什么</strong></p>
<ul>
<li>腾讯云托管的向量数据库服务</li>
<li>使用腾讯云自带的Embedding模型，无需额外配置</li>
</ul>
<p><strong>有什么用</strong></p>
<ul>
<li>快速接入云端向量检索能力</li>
<li>避免自行维护Embedding服务</li>
<li>适合生产环境大规模应用</li>
</ul>
<p><strong>示例代码</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> TencentVectorDB
<span class="hljs-keyword">from</span> langchain_community.vectorstores.tencentvectordb <span class="hljs-keyword">import</span> ConnectionParams

db = TencentVectorDB(
    embedding=<span class="hljs-literal">None</span>,  <span class="hljs-comment"># 使用内置Embedding</span>
    connection_params=ConnectionParams(
        url=os.environ.get(<span class="hljs-string">"TC_VECTOR_DB_URL"</span>),
        username=os.environ.get(<span class="hljs-string">"TC_VECTOR_DB_USERNAME"</span>),
        key=os.environ.get(<span class="hljs-string">"TC_VECTOR_DB_KEY"</span>),
        timeout=<span class="hljs-built_in">int</span>(os.environ.get(<span class="hljs-string">"TC_VECTOR_DB_TIMEOUT"</span>)),
    ),
    database_name=<span class="hljs-string">"llmops-test"</span>,
    collection_name=<span class="hljs-string">"dataset-builtin"</span>,
)

<span class="hljs-comment"># 添加文本</span>
texts = [<span class="hljs-string">"笨笨是一只很喜欢睡觉的猫咪"</span>, <span class="hljs-string">"我喜欢在夜晚听音乐"</span>]
ids = db.add_texts(texts)

<span class="hljs-comment"># 相似度搜索（带相关性分数）</span>
results = db.similarity_search_with_relevance_scores(<span class="hljs-string">"我养了一只猫"</span>)
</code></pre>
<hr/>
<h4 data-id="heading-6">4. - 腾讯云VectorDB外部Embedding</h4>
<p><strong>这是什么</strong></p>
<ul>
<li>使用第三方Embedding模型（如OpenAI）与腾讯云VectorDB集成</li>
<li>灵活选择最适合业务的Embedding服务</li>
</ul>
<p><strong>有什么用</strong></p>
<ul>
<li>使用高质量Embedding模型提升检索精度</li>
<li>统一管理多种Embedding服务</li>
<li>支持自定义Embedding模型</li>
</ul>
<p><strong>示例代码</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> OpenAIEmbeddings
<span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> TencentVectorDB

<span class="hljs-comment"># 使用OpenAI Embedding</span>
embedding = OpenAIEmbeddings(model=<span class="hljs-string">"text-embedding-3-small"</span>)

db = TencentVectorDB(
    embedding=embedding,
    connection_params=ConnectionParams(...),
    database_name=<span class="hljs-string">"llmops-test"</span>,
    collection_name=<span class="hljs-string">"dataset-external"</span>,
)

<span class="hljs-comment"># 添加文档并检索</span>
ids = db.add_texts(texts)
results = db.similarity_search_with_score(<span class="hljs-string">"我养了一只猫，叫笨笨"</span>)
</code></pre>
<hr/>
<h4 data-id="heading-7">5.  - 腾讯云VectorDB元数据过滤</h4>
<p><strong>这是什么</strong></p>
<ul>
<li>在向量相似度检索基础上增加结构化过滤条件</li>
<li>支持元数据字段定义（MetaField）和过滤表达式（expr）</li>
</ul>
<p><strong>有什么用</strong></p>
<ul>
<li>实现精准检索：如只搜索特定用户、特定时间范围的数据</li>
<li>多租户数据隔离</li>
<li>结合语义和结构化条件的混合检索</li>
</ul>
<p><strong>示例代码</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.vectorstores.tencentvectordb <span class="hljs-keyword">import</span> (
    MetaField, META_FIELD_TYPE_UINT64
)

db = TencentVectorDB(
    embedding=<span class="hljs-literal">None</span>,
    connection_params=ConnectionParams(...),
    meta_fields=[
        MetaField(name=<span class="hljs-string">"page"</span>, data_type=META_FIELD_TYPE_UINT64),
    ]
)

<span class="hljs-comment"># 添加带元数据的文档</span>
texts = [<span class="hljs-string">"笨笨是猫"</span>, <span class="hljs-string">"旺财是狗"</span>, <span class="hljs-string">"小飞是鸟"</span>]
metadatas = [{<span class="hljs-string">"page"</span>: <span class="hljs-number">1</span>}, {<span class="hljs-string">"page"</span>: <span class="hljs-number">5</span>}, {<span class="hljs-string">"page"</span>: <span class="hljs-number">10</span>}]
db.add_texts(texts, metadatas)

<span class="hljs-comment"># 带过滤条件的搜索：只检索 page &gt;= 9 的文档</span>
results = db.similarity_search_with_score(
    <span class="hljs-string">"宠物"</span>,
    expr=<span class="hljs-string">"page&gt;=9"</span>  <span class="hljs-comment"># 过滤表达式</span>
)
</code></pre>
<hr/>
<h3 data-id="heading-8">三、自定义向量存储</h3>
<h4 data-id="heading-9">6.  自定义 MemoryVectorStore 实现</h4>
<p><strong>这是什么</strong></p>
<ul>
<li>继承LangChain的VectorStore基类实现自定义向量存储</li>
<li>完整展示向量数据库的底层工作原理</li>
</ul>
<p><strong>有什么用</strong></p>
<ul>
<li>理解向量数据库核心机制：Embedding计算、距离度量、相似度排序</li>
<li>学习如何实现符合LangChain规范的向量存储</li>
<li>为特殊需求定制向量存储方案</li>
</ul>
<p><strong>示例代码</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.vectorstores <span class="hljs-keyword">import</span> VectorStore
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Optional</span>, <span class="hljs-type">Any</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryVectorStore</span>(<span class="hljs-title class_ inherited__">VectorStore</span>):
    store: <span class="hljs-built_in">dict</span> = {}

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, embedding: Embeddings</span>):
        self._embedding = embedding

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_texts</span>(<span class="hljs-params">self, texts: Iterable[<span class="hljs-built_in">str</span>], metadatas: <span class="hljs-type">Optional</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">dict</span>]] = <span class="hljs-literal">None</span></span>):
        <span class="hljs-comment"># 1. 将文本转换为向量</span>
        embeddings = self._embedding.embed_documents(texts)
        ids = [<span class="hljs-built_in">str</span>(uuid.uuid4()) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> texts]

        <span class="hljs-comment"># 2. 存储向量与元数据</span>
        <span class="hljs-keyword">for</span> idx, text <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(texts):
            self.store[ids[idx]] = {
                <span class="hljs-string">"id"</span>: ids[idx],
                <span class="hljs-string">"text"</span>: text,
                <span class="hljs-string">"embedding"</span>: embeddings[idx],
                <span class="hljs-string">"metadata"</span>: metadatas[idx] <span class="hljs-keyword">if</span> metadatas <span class="hljs-keyword">else</span> {},
            }
        <span class="hljs-keyword">return</span> ids

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">similarity_search</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, k: <span class="hljs-built_in">int</span> = <span class="hljs-number">4</span></span>):
        <span class="hljs-comment"># 1. 计算查询向量</span>
        query_embedding = self._embedding.embed_query(query)

        <span class="hljs-comment"># 2. 计算与所有向量的欧几里得距离</span>
        result = []
        <span class="hljs-keyword">for</span> key, record <span class="hljs-keyword">in</span> self.store.items():
            distance = self._euclidean_distance(query_embedding, record[<span class="hljs-string">"embedding"</span>])
            result.append({<span class="hljs-string">"distance"</span>: distance, **record})

        <span class="hljs-comment"># 3. 排序并返回前k个结果</span>
        result = <span class="hljs-built_in">sorted</span>(result, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">"distance"</span>])[:k]
        <span class="hljs-keyword">return</span> [Document(page_content=item[<span class="hljs-string">"text"</span>], metadata=item[<span class="hljs-string">"metadata"</span>]) <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> result]

<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_euclidean_distance</span>(<span class="hljs-params">cls, vec1: <span class="hljs-built_in">list</span>, vec2: <span class="hljs-built_in">list</span></span>) -&gt; <span class="hljs-built_in">float</span>:
        <span class="hljs-string">"""计算两个向量的欧几里得距离"""</span>
        <span class="hljs-keyword">return</span> np.linalg.norm(np.array(vec1) - np.array(vec2))

<span class="hljs-comment"># 使用示例</span>
db = MemoryVectorStore(embedding=QianfanEmbeddingsEndpoint())
db.add_texts([<span class="hljs-string">"笨笨是猫"</span>, <span class="hljs-string">"旺财是狗"</span>], metadatas=[{<span class="hljs-string">"page"</span>: <span class="hljs-number">1</span>}, {<span class="hljs-string">"page"</span>: <span class="hljs-number">2</span>}])
results = db.similarity_search(<span class="hljs-string">"宠物"</span>, k=<span class="hljs-number">2</span>)
</code></pre>
<hr/>
<h3 data-id="heading-10">四、Weaviate 向量数据库</h3>
<h4 data-id="heading-11">- Weaviate 向量搜索引擎</h4>
<p><strong>这是什么</strong></p>
<ul>
<li>开源向量搜索引擎，支持云服务（WCS）和本地部署</li>
<li>提供强大的过滤查询能力和GraphQL接口</li>
</ul>
<p><strong>有什么用</strong></p>
<ul>
<li>构建企业级向量搜索引擎</li>
<li>支持复杂的多条件过滤查询</li>
<li>与LangChain深度集成，快速搭建RAG系统</li>
</ul>
<p><strong>示例代码</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> weaviate
<span class="hljs-keyword">from</span> langchain_weaviate <span class="hljs-keyword">import</span> WeaviateVectorStore
<span class="hljs-keyword">from</span> weaviate.auth <span class="hljs-keyword">import</span> AuthApiKey
<span class="hljs-keyword">from</span> weaviate.classes.query <span class="hljs-keyword">import</span> Filter

<span class="hljs-comment"># 创建连接客户端（云服务）</span>
client = weaviate.connect_to_wcs(
    cluster_url=<span class="hljs-string">"xxx.c0.asia-southeast1.gcp.weaviate.cloud"</span>,
    auth_credentials=AuthApiKey(<span class="hljs-string">"your-api-key"</span>),
)

<span class="hljs-comment"># 创建向量库实例</span>
db = WeaviateVectorStore(
    client=client,
    index_name=<span class="hljs-string">"MyTest"</span>,
    text_key=<span class="hljs-string">"text"</span>,
    embedding=QianfanEmbeddingsEndpoint(model=<span class="hljs-string">"embedding-v1"</span>),
)

<span class="hljs-comment"># 添加数据</span>
ids = db.add_texts(texts, metadatas)

<span class="hljs-comment"># 带过滤条件的相似度搜索</span>
filters = Filter.by_property(<span class="hljs-string">"page"</span>).greater_or_equal(<span class="hljs-number">5</span>)
results = db.similarity_search_with_score(<span class="hljs-string">"笨笨"</span>, filters=filters)

<span class="hljs-comment"># 转换为Retriever（用于RAG）</span>
retriever = db.as_retriever()
results = retriever.invoke(<span class="hljs-string">"笨笨"</span>)
</code></pre>
<hr/>
<h3 data-id="heading-12">五、Pinecone 向量数据库</h3>
<h4 data-id="heading-13">8.  Pinecone 托管向量数据库</h4>
<p><strong>这是什么</strong></p>
<ul>
<li>完全托管的向量数据库服务，无需运维</li>
<li>提供高性能的向量检索API和自动扩缩容能力</li>
</ul>
<p><strong>有什么用</strong></p>
<ul>
<li>生产环境首选：零运维、高可用、自动扩展</li>
<li>支持Namespace实现多租户数据隔离</li>
<li>丰富的过滤语法实现精准检索</li>
</ul>
<p><strong>示例代码</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_pinecone <span class="hljs-keyword">import</span> PineconeVectorStore
<span class="hljs-keyword">from</span> langchain_community.embeddings <span class="hljs-keyword">import</span> HuggingFaceEmbeddings

<span class="hljs-comment"># 使用HuggingFace中文Embedding模型</span>
embedding = HuggingFaceEmbeddings(
    model_name=<span class="hljs-string">"BAAI/bge-small-zh-v1.5"</span>
)

<span class="hljs-comment"># 创建向量库实例（指定namespace实现数据隔离）</span>
db = PineconeVectorStore(
    index_name=<span class="hljs-string">"llmops"</span>,
    embedding=embedding,
    namespace=<span class="hljs-string">"dataset"</span>  <span class="hljs-comment"># 命名空间</span>
)

<span class="hljs-comment"># 添加文档</span>
db.add_texts(texts, metadatas, namespace=<span class="hljs-string">"dataset"</span>)

<span class="hljs-comment"># 带过滤条件的检索</span>
results = db.similarity_search_with_relevance_scores(
    <span class="hljs-string">"我养了一只猫"</span>,
    <span class="hljs-built_in">filter</span>={<span class="hljs-string">"$or"</span>: [{<span class="hljs-string">"page"</span>: <span class="hljs-number">5</span>}, {<span class="hljs-string">"account_id"</span>: <span class="hljs-number">1</span>}]}  <span class="hljs-comment"># 复杂过滤条件</span>
)

<span class="hljs-comment"># 删除指定文档</span>
db.delete([<span class="hljs-string">"document-id"</span>], namespace=<span class="hljs-string">"dataset"</span>)
</code></pre>
<hr/>
<h3 data-id="heading-14">六、核心知识点总结</h3>
<h4 data-id="heading-15">1. 向量数据库选型指南</h4>



































<table><thead><tr><th>方案</th><th>适用场景</th><th>优势</th><th>劣势</th></tr></thead><tbody><tr><td><strong>FAISS</strong></td><td>本地开发、小规模应用</td><td>免费、快速、无依赖</td><td>单机、需手动持久化</td></tr><tr><td><strong>腾讯云VectorDB</strong></td><td>国内生产环境</td><td>低延迟、内置Embedding</td><td>仅国内可用</td></tr><tr><td><strong>Pinecone</strong></td><td>国际生产环境</td><td>零运维、自动扩展</td><td>需海外访问</td></tr><tr><td><strong>Weaviate</strong></td><td>自建搜索引擎</td><td>开源、功能丰富</td><td>需运维</td></tr></tbody></table>
<h4 data-id="heading-16">2. Embedding 模型选择</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 千帆（国内推荐）</span>
QianfanEmbeddingsEndpoint(model=<span class="hljs-string">"Embedding-V1"</span>)

<span class="hljs-comment"># OpenAI（国际推荐）</span>
OpenAIEmbeddings(model=<span class="hljs-string">"text-embedding-3-small"</span>)

<span class="hljs-comment"># HuggingFace（免费离线）</span>
HuggingFaceEmbeddings(model_name=<span class="hljs-string">"BAAI/bge-small-zh-v1.5"</span>)  <span class="hljs-comment"># 中文</span>
HuggingFaceEmbeddings(model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>)  <span class="hljs-comment"># 英文</span>
</code></pre>
<h4 data-id="heading-17">3. 相似度计算方法</h4>





































<table><thead><tr><th>方法</th><th>公式</th><th>特点</th></tr></thead><tbody><tr><td><strong>欧几里得距离</strong></td><td>`</td><td/><td>v1 - v2</td><td/><td>`</td><td>距离越小越相似</td></tr><tr><td><strong>余弦相似度</strong></td><td>`cos(θ) = (v1·v2) / (</td><td/><td>v1</td><td/><td>·</td><td/><td>v2</td><td/><td>)`</td><td>值越大越相似</td></tr><tr><td><strong>内积</strong></td><td><code>v1·v2</code></td><td>计算最快</td></tr></tbody></table>
<h4 data-id="heading-18">4. 典型应用流程</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 1. 准备数据</span>
documents = [<span class="hljs-string">"文本1"</span>, <span class="hljs-string">"文本2"</span>, <span class="hljs-string">"文本3"</span>]
metadatas = [{<span class="hljs-string">"source"</span>: <span class="hljs-string">"A"</span>}, {<span class="hljs-string">"source"</span>: <span class="hljs-string">"B"</span>}, {<span class="hljs-string">"source"</span>: <span class="hljs-string">"C"</span>}]

<span class="hljs-comment"># 2. 创建向量库</span>
db = VectorStore.from_texts(documents, embedding, metadatas)

<span class="hljs-comment"># 3. 保存（可选）</span>
db.save_local(<span class="hljs-string">"./vector-store/"</span>)

<span class="hljs-comment"># 4. 检索</span>
results = db.similarity_search(<span class="hljs-string">"查询文本"</span>, k=<span class="hljs-number">3</span>)  <span class="hljs-comment"># 返回前3个最相似的</span>

<span class="hljs-comment"># 5. 带过滤检索</span>
results = db.similarity_search(
    <span class="hljs-string">"查询文本"</span>,
    <span class="hljs-built_in">filter</span>={<span class="hljs-string">"source"</span>: <span class="hljs-string">"A"</span>}  <span class="hljs-comment"># 只检索source=A的文档</span>
)

<span class="hljs-comment"># 6. 转换为Retriever（用于RAG）</span>
retriever = db.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">2</span>})
results = retriever.invoke(<span class="hljs-string">"查询文本"</span>)
</code></pre>
<h4 data-id="heading-19">5. RAG系统集成示例</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.chains <span class="hljs-keyword">import</span> RetrievalQA
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI

<span class="hljs-comment"># 创建向量库的Retriever</span>
retriever = db.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">3</span>})

<span class="hljs-comment"># 创建RAG问答链</span>
qa_chain = RetrievalQA.from_chain_type(
    llm=ChatOpenAI(model=<span class="hljs-string">"gpt-4"</span>),
    chain_type=<span class="hljs-string">"stuff"</span>,
    retriever=retriever,
    return_source_documents=<span class="hljs-literal">True</span>  <span class="hljs-comment"># 返回参考文档</span>
)

<span class="hljs-comment"># 执行问答</span>
answer = qa_chain.invoke({<span class="hljs-string">"query"</span>: <span class="hljs-string">"笨笨是什么？"</span>})
<span class="hljs-built_in">print</span>(answer[<span class="hljs-string">"result"</span>])  <span class="hljs-comment"># LLM生成的答案</span>
<span class="hljs-built_in">print</span>(answer[<span class="hljs-string">"source_documents"</span>])  <span class="hljs-comment"># 参考的文档片段</span>
</code></pre>
<hr/>
<h3 data-id="heading-20">七、最佳实践</h3>
<ol>
<li><strong>中文场景</strong>：优先选择千帆或<code>bge-small-zh-v1.5</code>模型</li>
<li><strong>数据规模</strong>：&lt;10万用FAISS，&gt;100万用托管服务</li>
<li><strong>元数据设计</strong>：提前规划过滤字段，避免频繁重建索引</li>
<li><strong>性能优化</strong>：使用批量添加（<code>add_texts</code>）而非单条插入</li>
<li><strong>成本控制</strong>：开发阶段用FAISS，生产环境切换到托管服务</li>
<li><strong>安全隔离</strong>：多租户场景使用Pinecone的Namespace或元数据过滤</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[数据工程新范式：基于 NoETL 语义编织实现自助下钻分析]]></title>    <link>https://juejin.cn/post/7599506068046675968</link>    <guid>https://juejin.cn/post/7599506068046675968</guid>    <pubDate>2026-01-26T10:09:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599506068046675968" data-draft-id="7599469598882840591" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="数据工程新范式：基于 NoETL 语义编织实现自助下钻分析"/> <meta itemprop="keywords" content="数据分析"/> <meta itemprop="datePublished" content="2026-01-26T10:09:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Aloudata大应科技"/> <meta itemprop="url" content="https://juejin.cn/user/1579340474099927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            数据工程新范式：基于 NoETL 语义编织实现自助下钻分析
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1579340474099927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Aloudata大应科技
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:09:14.000Z" title="Mon Jan 26 2026 10:09:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>本文首发于 Aloudata 官方技术博客：<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">《数据分析师如何能不依赖 IT，自助完成任意维度的下钻分析？》</a>转载请注明出处。</p>
<p><strong>摘要</strong>：本文探讨了数据分析师如何摆脱对 IT 和物理宽表的依赖，实现自助式任意维度下钻分析。通过引入基于 NoETL 语义编织的指标平台，将业务逻辑定义与物理实现解耦。分析师通过声明式配置定义指标与维度网络，平台利用智能物化引擎保障百亿级数据的秒级查询性能，从而将分析需求响应时间从“周级”缩短至“分钟级”，实现真正的自助探索与归因分析。</p>
<p>在数据驱动决策的今天，数据分析师却常常陷入一种困境：面对“为什么销售额突然下降？”这样的业务追问，分析思路总在“维度不足”或“等待取数”时被迫中断。据《数字化转型实战》（机械工业出版社，2023）的数据，企业通过自助式报表工具，数据分析效率平均提升了 57%，但这仍未能解决根本性的数据供给瓶颈。问题的根源，在于传统的“物理宽表”数据供给模式，它将分析师的探索能力限制在IT预先铺设好的有限轨道上。</p>
<h2 data-id="heading-0">传统分析范式的三大卡点：为何你总被“维度”卡住？</h2>
<p>传统基于物理宽表和固定 ETL 的数据供给模式，从根本上限制了数据分析的灵活性与响应速度，导致分析师陷入“提需求-等排期-分析中断”的恶性循环。这具体体现在三个核心卡点上：</p>
<p><strong>1.  卡点一：维度固化，探索受限</strong> 业务需求是发散的，但物理宽表是收敛的。当你从“地区”下钻到“门店”，再想下钻到“店员”或“具体订单”时，如果宽表未预先聚合这些维度，分析便戛然而止。分析师只能回头向 IT 提新需求，等待新的宽表开发。</p>
<p><strong>2.  卡点二：响应迟缓，思路断层</strong> 从提出新维度分析需求，到 IT 沟通、排期、开发、测试、上线，周期常以“周”计。等数据到位，业务时机已过，分析思路早已断层。这种延迟让数据分析从“主动洞察”降级为“事后解释”。</p>
<p><strong>3.  卡点三：口径混乱，归因无力</strong> 指标分散在不同报表和 BI 工具的数据集里，口径不一。当问“为什么销售额涨了？”时，基于聚合结果的浅层回答（如“因为A地区卖得好”）无法穿透到具体的门店、商品或用户行为，实现真正的明细级归因。</p>
<h2 data-id="heading-1">范式跃迁：从“物理宽表”到“语义编织”的 NoETL 新架构</h2>
<p>要打破上述僵局，必须进行架构层面的范式重构。NoETL 语义编织通过构建统一、虚拟的语义层，将业务逻辑定义与物理数据实现彻底解耦，为任意维度的灵活下钻提供了全新的架构基础。</p>
<ul>
<li>核心理念解耦：不再为每个分析场景创建物理宽表（DWS/ADS），而是在公共明细数据层（DWD）之上，通过声明式配置建立逻辑关联，形成一张覆盖全域的“虚拟业务事实网络”。</li>
<li>统一语义层：指标成为独立、可复用的业务对象，拥有明确的定义、血缘和版本。无论下游是 BI、报表还是 AI Agent，都消费同一份权威语义，确保口径 100% 一致。</li>
<li>自动化查询与加速：用户拖拽分析意图，语义引擎自动生成优化 SQL；智能物化引擎根据管理员声明的加速策略，按需创建并透明路由至加速表，保障百亿级明细数据的秒级响应，无需人工干预 ETL。</li>
</ul>
<p>这种“逻辑定义”与“物理执行”的分离，标志着从“以过程为中心”向“以语义为中心”的范式革命。</p>
<h2 data-id="heading-2">三步实践法：数据分析师的自助下钻分析路径</h2>
<p>基于 NoETL 语义编织平台，数据分析师可以通过以下三个标准化步骤，实现高效、灵活的自助分析，彻底摆脱对 IT 的依赖。</p>
<h3 data-id="heading-3">步骤一：声明式定义原子指标与维度网络</h3>
<ul>
<li>核心操作：在平台中，基于 DWD 明细表，通过界面化配置（而非写 SQL）定义核心原子指标（如“交易金额”）和业务维度（如“客户等级”、“商品品类”），并声明表间逻辑关联关系。</li>
<li>关键价值：一次定义，处处可用。确保了全公司分析口径的 100% 一致，为后续任意组合分析打下基础。平台支持定义“近30天消费金额&gt;5,000元的客户人数”等跨表限定、指标维度化的复杂指标。</li>
</ul>
<h3 data-id="heading-4">步骤二：按需配置智能物化加速策略</h3>
<ul>
<li>核心操作：针对高管驾驶舱、核心日报等高并发、低延迟场景，管理员可声明式配置需要加速的指标和维度组合（如“按日、地区、产品线聚合的交易额”），平台自动生成并运维物化任务。</li>
<li>关键价值：将“空间换时间”策略从高投入的猜测变为精准的自动化服务。查询时，引擎透明地进行 SQL 改写和智能路由，命中加速结果，在保障查询性能的同时，极大降低存储与计算成本。</li>
</ul>
<h3 data-id="heading-5">步骤三：任意维度拖拽与明细级归因探索</h3>
<ul>
<li>核心操作：在 BI 工具或平台分析界面中，直接从指标目录拖拽已定义的指标（如“交易额”），并自由组合、添加或切换任意维度（从时间、地区下钻至用户 ID、订单 ID）进行分析。</li>
<li>关键价值：分析思路不再被打断。利用平台内置的明细级多维度归因功能，可快速定位指标波动的关键贡献因子（如“华东地区某门店的 A 商品贡献了 80% 的增长”），从“描述现象”升级到“解释归因”。</li>
</ul>
<h2 data-id="heading-6">价值验证：从“周级等待”到“分钟级洞察”的效能革命</h2>
<p>采用 NoETL 语义编织新范式后，数据分析师的工作效能、分析深度及与业务的协作模式将发生根本性改变。</p>
<ol>
<li>效率质变：指标交付从平均两周缩短至分钟级。某头部券商案例显示，基于 Aloudata CAN 平台，业务分析师可自助完成逾 300 个维度与指标组合的灵活分析，响应临时需求的能力发生质变。</li>
<li>成本优化：消除冗余宽表开发，直接从源头减少 ETL 工作量。同一案例中，平台帮助客户节省了超过 70% 的 ETL 开发工作量，计算与存储资源得到精准控制。</li>
<li>分析深化：基于明细数据的归因成为可能，能回答“为什么”而不仅仅是“是什么”。例如，可快速定位销售额波动的具体贡献门店或商品，支撑精准的运营决策。</li>
<li>角色进化：数据分析师得以从繁重的“取数工人”角色中解放，转向“业务赋能者”和“语义模型设计师”，专注于更具战略价值的深度洞察与数据能力建设。</li>
</ol>
<h2 data-id="heading-7">行动指南：如何在你所在的企业启动变革？</h2>
<p>变革无需推倒重来，可以从选择一个有明确痛点的“灯塔”业务场景开始，采用平滑演进策略。</p>
<ol>
<li>
<p>选择试点场景：如“线上营销效果分析”或“门店日销售追踪”，组建包含数据架构师、分析师和业务专家的小组。</p>
</li>
<li>
<p>技术策略三步走：</p>
<ul>
<li>存量挂载：快速接入现有稳定宽表，提供统一出口，保护既有投资。</li>
<li>增量原生：所有新分析需求，直接基于 DWD 在语义层定义，禁止新建物理宽表。</li>
<li>存量替旧：逐步识别并下线高成本、高维护的旧宽表，用语义层逻辑替代。</li>
</ul>
</li>
<li>
<p>衡量与推广：在试点场景验证价值（如分析效率提升 10 倍），召开由业务负责人“现身说法”的内部分享会，逐步按业务优先级推广至其他领域。</p>
</li>
</ol>
<h2 data-id="heading-8">常见问题 (FAQ)</h2>
<p><strong>Q1: 不依赖 IT 做自助下钻，数据口径如何保证一致？</strong></p>
<p>通过 NoETL 语义编织，所有指标在统一的语义层中进行声明式定义和强校验。平台自动进行同名校验和逻辑判重，从技术上杜绝“同名不同义”。一旦定义发布，所有下游消费（BI、AI、报表）都调用同一个语义对象，确保全企业分析口径 100% 一致。</p>
<p><strong>Q2: 直接查询明细数据，查询性能慢怎么办？</strong></p>
<p>平台内置智能物化加速引擎。管理员可以声明需要加速的指标和维度组合，引擎会自动创建、运维最优的物化视图（加速表）。查询时，引擎透明地进行 SQL 改写和智能路由，让查询命中加速结果，从而在百亿级明细数据上实现秒级响应，对业务用户完全无感。</p>
<p><strong>Q3: 这种模式对现有数据仓库架构冲击大吗？需要推倒重来吗？</strong></p>
<p>完全不需要推倒重来。新范式倡导“平滑演进”。通过“存量挂载”利用现有宽表，“增量原生”处理新需求，逐步“存量替旧”。核心是构建一个独立的语义层，对接现有数据湖仓的公共明细层（DWD），做轻甚至替代数仓的汇总层（ADS），保护既有投资。</p>
<p><strong>Q4: 除了拖拽分析，能直接用自然语言提问吗？</strong></p>
<p>可以。基于坚实的语义层，可以构建如 Aloudata Agent 这样的数据分析智能体。它采用 NL2MQL2SQL 架构：大模型将你的自然语言问题转化为标准的指标查询请求（MQL），再由高确定性的语义引擎翻译成准确 SQL 执行，从根本上避免了大模型的“数据幻觉”，实现可信的对话式分析。</p>
<h2 data-id="heading-9">核心要点</h2>
<ol>
<li>架构解耦是前提：实现自助下钻分析的关键，是将业务逻辑定义（语义层）从物理数据实现（宽表 ETL）中彻底解耦，构建统一的“虚拟业务事实网络”。</li>
<li>声明式配置是核心：通过界面化配置定义指标、维度和关联关系，取代手写 SQL 和物理建模，是实现口径一致与灵活分析的工程基础。</li>
<li>智能加速是保障：基于声明式策略的智能物化引擎，在提供极致分析灵活性的同时，透明保障百亿级数据的秒级查询性能，控制总体成本。</li>
<li>平滑演进是路径：采用“存量挂载、增量原生、逐步替旧”的策略，可以在保护现有投资的同时，稳步向现代化数据架构转型，释放数据团队的更高价值。</li>
</ol>
<hr/>
<p>本文首发于 Aloudata 官方技术博客，查看更多技术细节与案例，请访问原文链接：<a href="https://link.juejin.cn?target=https%3A%2F%2Faloudata.com%2Fknowledge_base%2Fdata-analysts-self-drill-down-analysis" target="_blank" title="https://aloudata.com/knowledge_base/data-analysts-self-drill-down-analysis" ref="nofollow noopener noreferrer">aloudata.com/knowledge_b…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[🚀JS 为什么能跑这么快？一文把 V8 “翻译官 + 加速器” 机制讲透（AST / 字节码 / JIT / 去优化）]]></title>    <link>https://juejin.cn/post/7598574507347165219</link>    <guid>https://juejin.cn/post/7598574507347165219</guid>    <pubDate>2026-01-25T04:05:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598574507347165219" data-draft-id="7598588085596815400" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="🚀JS 为什么能跑这么快？一文把 V8 “翻译官 + 加速器” 机制讲透（AST / 字节码 / JIT / 去优化）"/> <meta itemprop="keywords" content="前端,JavaScript,面试"/> <meta itemprop="datePublished" content="2026-01-25T04:05:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="swipe"/> <meta itemprop="url" content="https://juejin.cn/user/858052674727959"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            🚀JS 为什么能跑这么快？一文把 V8 “翻译官 + 加速器” 机制讲透（AST / 字节码 / JIT / 去优化）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/858052674727959/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    swipe
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-25T04:05:15.000Z" title="Sun Jan 25 2026 04:05:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    26
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">你的 JS 到底怎么跑起来的？一文看懂 V8：从源码到机器码的“流水线”（含图解）</h2>
<blockquote>
<p>写下 <code>console.log('hi')</code> 的那一刻，CPU 其实完全看不懂。<br/>
真正让 JS “跑起来”的，是 <strong>JavaScript 引擎</strong>——尤其是 Chrome/Node.js 背后的 <strong>V8</strong>。<br/>
这篇文章用一条清晰的流水线，把 V8 的核心机制讲透：<strong>Parse → AST → Ignition(字节码) → TurboFan(机器码) → Deopt(去优化回退)</strong> 。</p>
</blockquote>
<hr/>
<p>文章推荐：</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.tencent.com.cn%2Fdeveloper%2Farticle%2F2453762%3FpolicyId%3D1%26traceId%3D" target="_blank" title="https://cloud.tencent.com.cn/developer/article/2453762?policyId=1&amp;traceId=" ref="nofollow noopener noreferrer">代码10倍提速！吃透底层架构就是如此简单-腾讯云开发者社区-腾讯云</a></p>
<h3 data-id="heading-1">先建立直觉：V8 是一条“翻译+加速”的流水线</h3>
<p>可以把 V8 想象成一个“会学习的翻译官”：</p>
<ul>
<li><strong>第一目标：让代码尽快跑起来</strong>（启动快）</li>
<li><strong>第二目标：把经常跑的代码越跑越快</strong>（热点优化）</li>
<li><strong>第三目标：发现假设错了就回退重来</strong>（去优化 Deopt）</li>
</ul>
<p>接下来所有细节，都围绕这三句话展开。</p>
<hr/>
<h3 data-id="heading-2">01｜为什么 CPU 才是最终执行者</h3>
<p>计算机的大脑——<strong>CPU（中央处理器）</strong> ，只认识机器语言（指令集）。</p>
<ul>
<li><strong>高级语言</strong>：JavaScript, Python, Java（人类易读，抽象程度高）。</li>
<li><strong>机器语言</strong>：二进制指令（CPU 易读，直接控制硬件）。</li>
</ul>
<p><strong>JavaScript 引擎的本质</strong>，就是一个<strong>超级翻译官</strong>。它的核心职责就是：<strong>解释和执行 JS 代码，将其转换为 CPU 能看懂的机器指令。</strong></p>
<blockquote>
<p>所以：<strong>CPU 是“执行者”，V8 是“翻译官 + 加速器”。</strong></p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f4846426c134e34af3ccec60e3e6cf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=fge3sTL6p5wRIyz4kWLNm%2F968%2BI%3D" alt="" loading="lazy"/></p>
<p>再看一张更直观的图：代码最终一定要落到 CPU 可执行的机器码上。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06f1b60e9f034fad8e4d2edc2d03d402~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=nBeMtJInP0ORwUmS6lHL3S3NWXU%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-3">02｜JavaScript 引擎在浏览器里处在什么位置</h3>
<h4 data-id="heading-4">2.1 常见的翻译官（JS 引擎）</h4>
<p>虽然今天的主角是 V8，但在这个江湖里还有其他大佬：</p>
<ul>
<li><strong>SpiderMonkey</strong>：JS 之父 Brendan Eich 的作品，Firefox 的心脏。</li>
<li><strong>JavaScriptCore</strong>：苹果 WebKit 内核的一部分，Safari 的动力源。</li>
<li><strong>Chakra</strong>：微软 IE/Edge 时代的产物。</li>
<li><strong>V8</strong>：Google 的杰作，它不仅驱动了 Chrome，更是 Node.js 的核心。</li>
</ul>
<p>浏览器内核并不是“只有渲染”，它通常至少包含两大块：</p>
<ul>
<li><strong>渲染相关</strong>：HTML/CSS 解析、布局、绘制</li>
<li><strong>脚本相关</strong>：解析并执行 JavaScript</li>
</ul>
<p>以 WebKit 举例：它可以拆成 <code>WebCore</code> 和 <code>JavaScriptCore</code> 两部分（JS 引擎就是内核的一部分）。<strong>遇到 <code>&lt;script&gt;</code> 标签时</strong>，WebCore 会暂停工作，把控制权交给 JS 引擎。这就是为什么我们常说 JS 会阻塞 DOM 渲染。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94eef3ea00f74d1284ef9ff43da40019~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=IJeOy8ZYx9dVUFQ%2FjZ1d9FH9lF4%3D" alt="" loading="lazy"/></p>
<hr/>
<h4 data-id="heading-5">2.2、 为什么 V8 能从众神中脱颖而出？</h4>
<p>V8 是用 <strong>C++</strong> 编写的高性能开源引擎。它之所以强，主要归功于这几点：</p>
<ol>
<li><strong>JIT (Just-In-Time) 即时编译</strong>：V8 抛弃了传统的“先转字节码再慢慢解释”或者“全量编译”的极端，而是采用了<strong>混合模式</strong>。它能在运行时将 JS 代码直接编译成机器码，速度极快。</li>
<li><strong>Node.js 的心脏</strong>：V8 证明了 JS 不仅仅能跑在浏览器，也能跑在服务器端，实现了全栈的可能。</li>
<li><strong>垃圾回收（GC）</strong> ：V8 拥有极其先进的分代式垃圾回收机制（后续文章我们将专门拆解）。</li>
</ol>
<h3 data-id="heading-6">03｜V8 全流程：从源码到机器码</h3>
<p>把 V8 的执行流程浓缩成 6 步，会非常清晰：</p>
<ol>
<li><strong>Parse（解析）</strong> ：源码 → AST（抽象语法树），并采用 <strong>Lazy Parsing</strong>（函数即将执行时才完整解析）</li>
<li><strong>Ignition（解释器）</strong> ：AST → <strong>字节码 Bytecode</strong></li>
<li><strong>执行字节码</strong>：先跑起来，并收集运行信息（类型、分支、调用频率…）</li>
<li><strong>TurboFan（优化编译器）</strong> ：热点代码 → <strong>优化后的机器码</strong></li>
<li><strong>Deopt（去优化）</strong> ：假设不成立（常见是类型变化）→ 回退到字节码</li>
<li><strong>机器码执行</strong>：最终交给 CPU</li>
</ol>
<p>用一张图把这条流水线钉死在脑子里：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d331e1cca4fd4142bdae3d2dc7f2372f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=GuCt9gG8sjgG8OmG45IwTtItaZI%3D" alt="" loading="lazy"/></p>
<p>同时，AST 长什么样？大概是这种结构化树形表示：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f20e5336bdb04b4dbffc38ae4a7044ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=L1NDOUSUItJhs8xpbQtLN9volE8%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-7">04｜Parse 细节：词法分析、语法分析与 AST</h3>
<p>很多人卡在“Parse 解析”这一步，原因是：<strong>概念名词多，但直觉不够</strong>。</p>
<h4 data-id="heading-8">4.1 词法分析：把代码拆成 token（最小语法单元）</h4>
<p>在生成树之前，代码首先要被“打碎”。这就是 <strong>词法分析</strong>。</p>
<p>V8 会将代码拆解成一个个最小单元，称为 <strong>Tokens</strong>。</p>
<p>比如代码：<code>const name = "coderwhy"</code></p>
<p>会被拆解为：</p>
<ul>
<li><code>const</code> (Keyword 关键字)</li>
<li><code>name</code> (Identifier 标识符)</li>
<li><code>=</code> (Operator 操作符)</li>
<li><code>"coderwhy"</code> (StringLiteral 字符串字面量)</li>
</ul>
<h4 data-id="heading-9">4.2 语法分析：把 token 重新组装成树（AST）</h4>
<p>拿到 Tokens 后，V8 会依据语法规则，将其组装成一棵树——<strong>AST（抽象语法树）</strong> 。</p>
<p>AST 是前端工程化的基石，<strong>Babel 转译、ESLint 检查、Vue 模板编译</strong>，本质上都在操作 AST。</p>
<p>看看一段简单的代码生成的 AST 结构：</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sayHi</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Hi "</span> + name)
}
</code></pre>
<p>对应的 AST 结构概览：</p>
<ul>
<li>
<p><strong>FunctionDeclaration</strong> (函数声明: sayHi)</p>
<ul>
<li>
<p><strong>Identifier</strong> (参数: name)</p>
</li>
<li>
<p><strong>BlockStatement</strong> (函数体)</p>
<ul>
<li>
<p><strong>ExpressionStatement</strong> (表达式)</p>
<ul>
<li><strong>CallExpression</strong> (调用 console.log)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-10">05｜为什么要保留“字节码”这一层</h3>
<p>直觉上会觉得：<strong>少一层转换就更快</strong>，那为什么不直接 AST → 机器码？</p>
<p>因为工程里真正的目标不是“某一步最快”，而是“整体更快、更稳、更可控”。保留字节码主要带来：</p>
<ol>
<li><strong>跨平台</strong>：字节码不绑定某一种 CPU 指令集</li>
<li><strong>优化更聪明</strong>：先跑字节码，收集运行数据，再决定怎么生成更优机器码</li>
<li><strong>更安全、更可控</strong>：更容易做隔离、策略、内存管理</li>
<li><strong>更容易调试</strong>：断点/单步在字节码层更容易实现</li>
</ol>
<p>配合这张图理解，会很顺：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1c22d73a1974c83a354868f97bffadc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=v0eyE6gwcY8kDxCsYpuKUOHhVAw%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-11">06｜架构拆解：Parse / Ignition / TurboFan 各做什么</h3>
<p>用“岗位职责”来记：</p>
<ul>
<li><strong>Parse</strong>：把 JS 代码变成 AST（解释器不直接认识 JS 源码）</li>
<li><strong>Ignition</strong>：把 AST 变成字节码并执行，同时收集 TurboFan 需要的运行信息（比如类型信息）</li>
<li><strong>TurboFan</strong>：把热点字节码编译成更快的机器码（并持续迭代优化）</li>
</ul>
<p>这里有一个非常关键的运行规律：</p>
<blockquote>
<p><strong>热点函数会被优化</strong>，但<strong>类型变化等情况会触发去优化回退</strong>。</p>
</blockquote>
<hr/>
<h3 data-id="heading-12">07｜预解析 vs 全量解析：Lazy Parsing 为什么能让启动更快</h3>
<p>V8 并不会“上来就把一切都解析得巨细无遗”，它会做取舍：</p>
<h4 data-id="heading-13">7.1 预解析（Pre-parsing）</h4>
<ul>
<li>目标：<strong>快速扫描</strong>，提取结构信息（变量/函数声明等）</li>
<li>特点：不深挖函数体内部逻辑 → <strong>更快</strong></li>
</ul>
<h4 data-id="heading-14">7.2 全量解析（Full parsing）</h4>
<ul>
<li>目标：把函数体、表达式、语句细节全部建出来</li>
<li>特点：AST 更完整 → 便于后续生成字节码与优化</li>
</ul>
<p>因此，“函数没执行会不会生成 AST？”更准确的回答是：</p>
<ul>
<li>会生成一个<strong>简化的结构架子</strong>（预解析）</li>
<li>真要执行之前，会补齐为<strong>完整 AST</strong>（全量解析）</li>
</ul>
<hr/>
<h3 data-id="heading-15">08｜走一遍官方图：token、AST、字节码到底怎么来的</h3>
<p>先准备一段模板代码：</p>
<pre><code class="hljs language-javascript" lang="javascript">name = <span class="hljs-string">"XiaoWu"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">sayHi</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Hi "</span> + name)
}

<span class="hljs-title function_">sayHi</span>(name)
</code></pre>
<h4 data-id="heading-16">8.1 官方流程图：从输入到字节码</h4>
<p>这张图非常经典，建议收藏：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb56f664de504858a28148774bbce437~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=tcIACPqj1rDe03%2FA6YrfI3zEWy4%3D" alt="" loading="lazy"/></p>
<p>按图理解就是：</p>
<ul>
<li><strong>Scanner</strong>：扫描字符流 → 生成 tokens</li>
<li><strong>PreParser</strong>：做预解析（快速判断结构）</li>
<li><strong>Parser</strong>：构建 AST</li>
<li><strong>Bytecode</strong>：AST → 字节码</li>
</ul>
<h4 data-id="heading-17">8.2 token 长什么样（词法分析结果）</h4>
<p>下面是典型 token 形态（摘取关键类型，方便理解）：</p>
<pre><code class="hljs language-ini" lang="ini">Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Keyword'</span>, value=<span class="hljs-string">'const'</span>)            // 关键字
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Identifier'</span>, value=<span class="hljs-string">'name'</span>)          // 标识符
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Operator'</span>, value=<span class="hljs-string">'='</span>)               // 运算符
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'StringLiteral'</span>, value=<span class="hljs-string">'"coderwhy and XiaoYu"'</span>) // 字符串字面量
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Punctuation'</span>, value=<span class="hljs-string">';'</span>)            // 标点符号

Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Identifier'</span>, value=<span class="hljs-string">'console'</span>)
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Punctuation'</span>, value=<span class="hljs-string">'.'</span>)
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Identifier'</span>, value=<span class="hljs-string">'log'</span>)
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Punctuation'</span>, value=<span class="hljs-string">'('</span>)
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Identifier'</span>, value=<span class="hljs-string">'name'</span>)
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Punctuation'</span>, value=<span class="hljs-string">')'</span>)
Token(<span class="hljs-attr">type</span>=<span class="hljs-string">'Punctuation'</span>, value=<span class="hljs-string">';'</span>)
</code></pre>
<h4 data-id="heading-18">8.3 语法分析：预解析如何参与</h4>
<p>这张图专门解释“预解析/解析”的关系：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69d4f091bbd44a128203c9a3397c469a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=Hc3DJgH2%2BdXesCtbADkU2VPMmy4%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-19">09｜热点优化与去优化：为什么“有时突然变慢”</h3>
<p>V8 会把被频繁执行的函数标记为 <strong>热点函数</strong>，然后交给 TurboFan 编译为更快的机器码。</p>
<p>但注意：<strong>优化是有前提假设的</strong>。最常见的假设就是“类型稳定”。</p>
<p>来看这个例子：</p>
<pre><code class="hljs language-scss" lang="scss">function sum (num1,num2){
  return num1 + num2
}

<span class="hljs-comment">// 多次调用 -&gt; 可能成为热点函数 -&gt; 被优化</span>
<span class="hljs-built_in">sum</span>(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>)
<span class="hljs-built_in">sum</span>(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>)

<span class="hljs-comment">// 类型突然变化 -&gt; 之前的机器码假设不成立 -&gt; 去优化回退</span>
<span class="hljs-built_in">sum</span>('xiaoyu','coderwhy')
</code></pre>
<p>发生了什么？</p>
<ul>
<li>前两次传入 <code>number</code>，优化器可能会假设“这里一直是 number 加法”</li>
<li>第三次突然变成 <code>string</code> 拼接，机器码可能无法正确处理 → <strong>回退到字节码重新收集信息，再决定是否重新优化</strong></li>
</ul>
<p>这就是性能“抖一下”的根源之一：<strong>Deopt（去优化）</strong> 。</p>
<hr/>
<h3 data-id="heading-20">10｜字节码与机器码（了解即可）：JIT 到底做了什么</h3>
<p>机器码的生成通常依赖 <strong>JIT（Just-In-Time Compilation，即时编译）</strong> ：</p>
<ul>
<li>把字节码转换成本地机器码</li>
<li>把结果缓存起来</li>
<li>后续执行直接复用缓存的机器码（更快）</li>
</ul>
<p>TurboFan 作为优化编译器，会基于 IR（中间表示）做多层优化（类型、内联、控制流等）：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9026bf89ba4e4ae293a03753ebf02b23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=Uat8DUsKMT2ox%2Fe00Eaamn0REqI%3D" alt="" loading="lazy"/></p>
<p>同时，字节码到机器码的过程中，会存在不同优化策略：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5f87e40aeb04e599978ce8cf1a20903~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=BmLOPuZZg%2BWrHH6Z5JcUHYjcKSE%3D" alt="" loading="lazy"/></p>
<p>这里还有两张配图（保持原样保留）：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca7fe53e26f54a30beb3daaf60c0d034~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=uvn0YNPuO%2Flbxw5tG5zBPrDefm8%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/346599b792034889bd49dfada16ae9c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3dpcGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769938069&amp;x-signature=5Ox7Vt5Dt1jJ%2F3h14wl903towuM%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-21">结尾：把知识用起来</h3>
<p>看到这里，你是否对那个黑盒子一样的浏览器有了新的认识？</p>
<p>我们简单回顾一下 V8 的奇幻旅程：</p>
<ol>
<li><strong>Scanner &amp; Parser</strong>：把代码拆解成 Tokens，再组装成 AST（注意预解析优化）。</li>
<li><strong>Ignition</strong>：把 AST 翻译成字节码，边解释边执行。</li>
<li><strong>TurboFan</strong>：在后台偷偷观察，把热点代码编译成机器码，但一旦类型变化，就会被打回原形。</li>
</ol>
<p><strong>下期预告：</strong></p>
<p>理解了执行流程，还有一个大魔王在等着我们——<strong>内存管理</strong>。</p>
<ul>
<li>JS 的闭包为什么会导致内存泄漏？</li>
<li>V8 的垃圾回收（GC）是如何区分“新生代”和“老年代”的？</li>
<li>全停顿（Stop-the-world）是什么？</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python异步编程：为什么90%的开发者都用错了这3个关键点？]]></title>    <link>https://juejin.cn/post/7598480267218485282</link>    <guid>https://juejin.cn/post/7598480267218485282</guid>    <pubDate>2026-01-25T00:19:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598480267218485282" data-draft-id="7598588085596602408" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python异步编程：为什么90%的开发者都用错了这3个关键点？"/> <meta itemprop="keywords" content="后端,前端,人工智能"/> <meta itemprop="datePublished" content="2026-01-25T00:19:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="阿橙的百宝箱"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python异步编程：为什么90%的开发者都用错了这3个关键点？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    阿橙的百宝箱
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-25T00:19:46.000Z" title="Sun Jan 25 2026 00:19:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    15
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Python异步编程：为什么90%的开发者都用错了这3个关键点？</strong></h2>
<h3 data-id="heading-1">引言</h3>
<p>异步编程已经成为现代Python开发中不可或缺的一部分，尤其是在I/O密集型和高并发场景下。随着<code>asyncio</code>库的成熟和Python对异步支持的不断增强，越来越多的开发者开始尝试利用异步编程来提升性能。然而，在实践中，许多开发者并未真正理解异步编程的核心概念，导致代码效率低下、难以维护甚至出现难以调试的问题。</p>
<p>本文将深入探讨Python异步编程中最容易被误解或错误使用的3个关键点：<strong>事件循环的理解与使用</strong>、<strong>协程的正确调度</strong>以及<strong>资源管理与线程安全</strong>。通过分析这些常见误区，帮助开发者更好地掌握异步编程的精髓。</p>
<hr/>
<h3 data-id="heading-2">1. 事件循环：不仅仅是“后台任务调度器”</h3>
<h4 data-id="heading-3">误区：事件循环是一个黑匣子</h4>
<p>许多开发者将事件循环（Event Loop）简单地视为一个“后台任务调度器”，认为只要将任务丢给<code>asyncio.run()</code>或<code>loop.run_until_complete()</code>就能自动实现异步执行。这种理解过于肤浅，忽略了事件循环的核心作用：<strong>协调和管理所有协程的执行顺序和资源分配</strong>。</p>
<h4 data-id="heading-4">深入解析</h4>
<ul>
<li><strong>事件循环的本质</strong>：事件循环是单线程的，它通过轮询I/O事件和协程的状态来决定下一步执行哪个任务。它的核心是“非阻塞”和“协作式多任务”。</li>
<li><strong>常见错误</strong>：
<ol>
<li><strong>阻塞事件循环</strong>：在协程中调用同步阻塞操作（如<code>time.sleep()</code>或CPU密集型计算），导致整个事件循环被卡住。正确的做法是使用<code>await asyncio.sleep()</code>或将CPU密集型任务交给<code>loop.run_in_executor()</code>。</li>
<li><strong>滥用多个事件循环</strong>：在同一个线程中创建多个事件循环（如手动调用<code>asyncio.new_event_loop()</code>）会导致不可预测的行为。通常，一个线程只需要一个事件循环。</li>
</ol>
</li>
</ul>
<h4 data-id="heading-5">最佳实践</h4>
<ul>
<li>始终使用<code>asyncio.run()</code>作为入口点（Python 3.7+），避免手动管理事件循环的生命周期。</li>
<li>对于需要并行执行的I/O操作，优先使用<code>asyncio.gather()</code>或<code>asyncio.create_task()</code>，而不是手动操作事件循环。</li>
</ul>
<hr/>
<h3 data-id="heading-6">2. 协程的正确调度：从“Fire-and-Forget”到结构化并发</h3>
<h4 data-id="heading-7">误区：“启动即忘”的协程管理</h4>
<p>许多开发者习惯直接调用<code>asyncio.create_task()</code>而不保存返回的Task对象，导致无法跟踪任务状态或处理异常。这种“Fire-and-Forget”模式会引发以下问题：</p>
<ol>
<li><strong>无法捕获异常</strong>：未被等待的Task如果抛出异常，可能不会触发任何错误处理逻辑。</li>
<li><strong>资源泄漏</strong>：未完成的任务可能持有资源（如数据库连接），但无法被及时清理。</li>
</ol>
<h4 data-id="heading-8">深入解析</h4>
<ul>
<li><strong>结构化并发的重要性</strong>：异步代码应该像同步代码一样具有明确的任务边界和生命周期管理。Python 3.11引入的<code>TaskGroup</code>（通过<code>asyncio.TaskGroup</code>）正是为了解决这一问题。</li>
<li><strong>常见错误场景</strong>：
<ol>
<li><strong>未处理的Task异常</strong>：如果一个Task未被显式等待，其异常会被静默丢弃（除非调用<code>.exception()</code>或<code>.result()</code>）。</li>
<li><strong>取消传播问题</strong>：直接取消父Task不会自动取消子Task，需要手动管理取消逻辑。</li>
</ol>
</li>
</ul>
<h4 data-id="heading-9">最佳实践</h4>
<ul>
<li>使用<code>asyncio.TaskGroup</code>（Python 3.11+）或第三方库（如<code>trio</code>）实现结构化并发：
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> asyncio.TaskGroup() <span class="hljs-keyword">as</span> tg:
        tg.create_task(task1())
        tg.create_task(task2())
    <span class="hljs-comment"># 所有任务完成后继续执行</span>
</code></pre>
</li>
<li>对于旧版本Python，至少要通过<code>asyncio.gather(return_exceptions=True)</code>捕获所有任务的异常。</li>
</ul>
<hr/>
<h3 data-id="heading-10">3. 资源管理与线程安全：“异步上下文”不是万能的</h3>
<h4 data-id="heading-11">误区：认为异步代码天然线程安全</h4>
<p>由于异步编程基于协程的单线程模型，许多开发者误以为不需要考虑线程安全问题。然而，在以下场景中仍然存在风险：</p>
<ol>
<li><strong>混合同步与异步代码</strong>：例如在协程中调用同步数据库驱动（如psycopg2），可能导致死锁或竞争条件。</li>
<li><strong>共享状态访问</strong>：即使是单线程环境，如果多个协程同时修改共享变量（如全局字典），也可能因上下文切换导致数据不一致。</li>
</ol>
<h4 data-id="heading-12">深入解析</h4>
<ul>
<li><strong>GIL的限制</strong>：虽然GIL避免了真正的并行执行，但协程的切换是显式的（通过<code>await</code>），因此共享状态的修改仍需要同步机制（如<code>asyncio.Lock</code>）。</li>
<li><strong>常见陷阱案例</strong>：
<ol>
<li><strong>阻塞I/O破坏异步性</strong>：在协程中使用同步Redis客户端会导致整个事件循环阻塞；应改用异步客户端（如<code>aioredis</code>）。</li>
<li><strong>未受保护的共享状态</strong>：即使是无竞争的全局变量修改也需要锁保护（例如计数器递增操作）。</li>
</ol>
</li>
</ul>
<h4 data-id="heading-13">最佳实践</h4>
<ul>
<li><strong>严格分离同步与异步代码边界</strong>：使用适配器模式将同步代码封装为异步接口（如通过线程池执行）。</li>
<li><strong>显式同步机制选择原则</strong>：
<ul>
<li><code>asyncio.Lock</code>: 适用于单进程内的协程间互斥。</li>
<li><code>threading.Lock</code>: 仅用于与同步代码交互的场景。</li>
<li><code>multiprocessing.Lock</code>: 跨进程共享状态时使用。</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-14">总结</h3>
<p>Python异步编程的强大之处在于其高效和非阻塞的特性，但同时也对开发者的设计能力提出了更高要求。本文分析的三个关键点——事件循环、协程调度和资源管理——是大多数问题的根源所在。要真正掌握异步编程，必须理解其底层原理并遵循结构化并发的最佳实践：</p>
<ol>
<li><strong>尊重事件循环的单线程本质</strong>，避免阻塞操作。</li>
<li><strong>采用结构化并发模式管理任务生命周期</strong>。</li>
<li><strong>明确区分同步与异步边界并正确使用锁机制</strong>.</li>
</ol>
<p>只有将这些原则融入日常开发习惯才能真正发挥出Python异步编程的全部潜力！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hono 路由器为什么这么快？]]></title>    <link>https://juejin.cn/post/7598801700050337830</link>    <guid>https://juejin.cn/post/7598801700050337830</guid>    <pubDate>2026-01-25T03:39:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598801700050337830" data-draft-id="7598818096753229875" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hono 路由器为什么这么快？"/> <meta itemprop="keywords" content="Bun,性能优化"/> <meta itemprop="datePublished" content="2026-01-25T03:39:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="jump_jump"/> <meta itemprop="url" content="https://juejin.cn/user/4230576474692765"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hono 路由器为什么这么快？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4230576474692765/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    jump_jump
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-25T03:39:19.000Z" title="Sun Jan 25 2026 03:39:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    17
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>从底层引擎优化角度，深入剖析 Hono 路由器的极致性能奥秘</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">引言</h2>
<p>在众多 JavaScript Web 框架中，Hono 以其极致的性能表现脱颖而出。特别是在 <strong>Cloudflare Workers、Deno 等边缘计算环境</strong>中，Hono 的路由匹配速度在同类框架中名列前茅。这背后的秘密是什么？答案就藏在它的 <strong>RegExpRouter</strong> 实现中。</p>
<blockquote>
<p><strong>⚠️ 重要提示</strong>：本文重点讨论 RegExpRouter 的核心原理。在实际应用中，Hono 使用 SmartRouter 自动组合多种路由器（RegExpRouter、TrieRouter、LinearRouter）以达到最佳性能。</p>
</blockquote>
<p>本文将通过一个精简的实现，深入剖析 Hono 路由器的核心原理，帮助你理解：</p>
<ul>
<li>为什么 RegExp 路由比传统路由快</li>
<li>路由是如何预编译的</li>
<li>参数提取的巧妙设计</li>
</ul>
<hr/>
<p><strong>📌 关键要点</strong></p>





























<table><thead><tr><th>项目</th><th>说明</th></tr></thead><tbody><tr><td>核心原理</td><td>将路由预编译为正则表达式，利用引擎底层优化</td></tr><tr><td>性能优势</td><td>减少 JS 层开销，一次原生调用完成匹配</td></tr><tr><td>最佳环境</td><td>Cloudflare Workers、Deno 等边缘计算平台</td></tr><tr><td>实际架构</td><td>SmartRouter + RegExpRouter + TrieRouter 组合</td></tr><tr><td>权衡考虑</td><td>Node.js 环境性能打折扣，路由注册较慢</td></tr></tbody></table>
<h2 data-id="heading-1">传统路由的性能瓶颈</h2>
<p>在理解 Hono 的优化之前，我们先看看传统路由的处理方式：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 传统路由的典型实现</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">matchRoute</span>(<span class="hljs-params">path, routes</span>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> route <span class="hljs-keyword">of</span> routes) {
    <span class="hljs-comment">// 1. 字符串分割</span>
    <span class="hljs-keyword">const</span> pathParts = path.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>);
    <span class="hljs-keyword">const</span> routeParts = route.<span class="hljs-property">path</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>);

    <span class="hljs-comment">// 2. 逐段比较</span>
    <span class="hljs-keyword">if</span> (pathParts.<span class="hljs-property">length</span> !== routeParts.<span class="hljs-property">length</span>) <span class="hljs-keyword">continue</span>;

    <span class="hljs-keyword">const</span> params = {};
    <span class="hljs-keyword">let</span> matched = <span class="hljs-literal">true</span>;

    <span class="hljs-comment">// 3. JS 层面的循环和条件判断</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; pathParts.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">if</span> (routeParts[i].<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">':'</span>)) {
        params[routeParts[i].<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)] = pathParts[i];
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pathParts[i] !== routeParts[i]) {
        matched = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">break</span>;
      }
    }

    <span class="hljs-keyword">if</span> (matched) <span class="hljs-keyword">return</span> { route, params };
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<p><strong>性能问题在哪里？</strong></p>
<ul>
<li>❌ 大量的字符串操作（<code>split</code>、<code>slice</code>）</li>
<li>❌ 多层循环和条件判断，全在 JavaScript 层面执行</li>
<li>❌ 每个请求都要重复这些操作</li>
</ul>
<h2 data-id="heading-2">Hono 的解决方案：下沉到引擎层</h2>
<p>Hono 的核心思想非常简单却极其巧妙：</p>
<blockquote>
<p><strong>将路由匹配逻辑从 JavaScript 层下沉到 JavaScript 引擎底层（C++ 实现的正则表达式引擎）</strong></p>
</blockquote>
<h3 data-id="heading-3">1. 预编译阶段（应用启动时）</h3>
<p>在应用启动时，Hono 会将路由路径转换为正则表达式：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 路由路径：/user/:id/posts/:postId</span>
<span class="hljs-comment">// 转换为正则：/^\/user\/([^/]+)\/posts\/([^/]+)$/</span>

<span class="hljs-keyword">const</span> <span class="hljs-attr">paramNames</span>: <span class="hljs-built_in">string</span>[] = [];

<span class="hljs-keyword">const</span> regexPath = path.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/:([a-zA-Z0-9_]+)/g</span>, <span class="hljs-function">(<span class="hljs-params">_, paramName</span>) =&gt;</span> {
  paramNames.<span class="hljs-title function_">push</span>(paramName); <span class="hljs-comment">// 记录参数名</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">'([^/]+)'</span>;           <span class="hljs-comment">// 替换为捕获组</span>
});

<span class="hljs-keyword">const</span> pattern = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">`^<span class="hljs-subst">${regexPath}</span>$`</span>);
</code></pre>
<p><strong>关键点：</strong></p>
<ul>
<li><code>:id</code> → <code>([^/]+)</code>：匹配除 <code>/</code> 外的任意字符</li>
<li>参数名被保存在 <code>paramNames</code> 数组中</li>
<li>这个"昂贵"的编译过程只在启动时执行一次</li>
</ul>
<h3 data-id="heading-4">2. 匹配阶段（请求到来时）</h3>
<p>当请求到来时，只需要一行代码：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> match = pattern.<span class="hljs-title function_">exec</span>(path);
</code></pre>
<p><strong>这行代码的魔法：</strong></p>
<ul>
<li>✅ <code>exec</code> 是 JavaScript 引擎的原生方法，由 C++ 实现</li>
<li>✅ 正则引擎在底层进行了高度优化（状态机、JIT 编译等）</li>
<li>✅ 无需手动分割字符串、无需 JS 层循环</li>
<li>✅ 参数提取通过捕获组自动完成</li>
</ul>
<h3 data-id="heading-5">3. 参数提取</h3>
<p>匹配成功后，参数提取也非常简洁：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {};
route.<span class="hljs-property">paramNames</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">name, index</span>) =&gt;</span> {
  params[name] = match[index + <span class="hljs-number">1</span>]; <span class="hljs-comment">// match[0] 是完整匹配</span>
});
</code></pre>
<h2 data-id="heading-6">完整实现解析</h2>
<p>让我们看完整的简化实现，包含所有必要的类型定义：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ============ 类型定义 ============</span>

<span class="hljs-comment">/**
 * 路由处理函数类型
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">params</span> - 从 URL 中提取的参数对象
 */</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Handler</span> = <span class="hljs-function">(<span class="hljs-params">params: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> <span class="hljs-built_in">void</span>;

<span class="hljs-comment">/**
 * 路由信息接口
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Route</span> {
  <span class="hljs-attr">method</span>: <span class="hljs-built_in">string</span>;        <span class="hljs-comment">// HTTP 方法（GET, POST, etc.）</span>
  <span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// 原始路径模式（如 /user/:id）</span>
  <span class="hljs-attr">handler</span>: <span class="hljs-title class_">Handler</span>;      <span class="hljs-comment">// 路由处理函数</span>
  <span class="hljs-attr">paramNames</span>: <span class="hljs-built_in">string</span>[];  <span class="hljs-comment">// 参数名数组（如 ['id', 'postId']）</span>
}

<span class="hljs-comment">/**
 * 匹配结果接口
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">MatchResult</span> {
  <span class="hljs-attr">handler</span>: <span class="hljs-title class_">Handler</span>;
  <span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;;
}

<span class="hljs-comment">// ============ 核心路由器实现 ============</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoRegExpRouter</span> {
  <span class="hljs-comment">// 存储预编译的正则表达式和路由信息</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">routes</span>: { <span class="hljs-attr">pattern</span>: <span class="hljs-title class_">RegExp</span>; <span class="hljs-attr">route</span>: <span class="hljs-title class_">Route</span> }[] = [];

  <span class="hljs-comment">// 注册路由：预编译</span>
  <span class="hljs-title function_">add</span>(<span class="hljs-params">method: <span class="hljs-built_in">string</span>, path: <span class="hljs-built_in">string</span>, handler: Handler</span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">paramNames</span>: <span class="hljs-built_in">string</span>[] = [];

    <span class="hljs-comment">// 将 :param 转为正则捕获组</span>
    <span class="hljs-keyword">const</span> regexPath = path.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/:([a-zA-Z0-9_]+)/g</span>, <span class="hljs-function">(<span class="hljs-params">_, paramName</span>) =&gt;</span> {
      paramNames.<span class="hljs-title function_">push</span>(paramName);
      <span class="hljs-keyword">return</span> <span class="hljs-string">'([^/]+)'</span>;
    });

    <span class="hljs-keyword">const</span> pattern = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">`^<span class="hljs-subst">${regexPath}</span>$`</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">routes</span>.<span class="hljs-title function_">push</span>({ pattern, <span class="hljs-attr">route</span>: { method, path, handler, paramNames } });
  }

  <span class="hljs-comment">// 匹配路由：执行正则</span>
  <span class="hljs-title function_">match</span>(<span class="hljs-params">method: <span class="hljs-built_in">string</span>, path: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> { pattern, route } <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">routes</span>) {
      <span class="hljs-keyword">if</span> (route.<span class="hljs-property">method</span> !== method &amp;&amp; route.<span class="hljs-property">method</span> !== <span class="hljs-string">'ALL'</span>) <span class="hljs-keyword">continue</span>;

      <span class="hljs-keyword">const</span> match = pattern.<span class="hljs-title function_">exec</span>(path); <span class="hljs-comment">// 核心：原生正则匹配</span>

      <span class="hljs-keyword">if</span> (match) {
        <span class="hljs-keyword">const</span> <span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {};
        route.<span class="hljs-property">paramNames</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">name, index</span>) =&gt;</span> {
          params[name] = match[index + <span class="hljs-number">1</span>];
        });
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">handler</span>: route.<span class="hljs-property">handler</span>, params };
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}
</code></pre>
<h2 data-id="heading-7">实战示例</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DemoRegExpRouter</span>();

<span class="hljs-comment">// 注册路由</span>
router.<span class="hljs-title function_">add</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'/user/:id'</span>, <span class="hljs-function">(<span class="hljs-params">params</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`获取用户详情，ID: <span class="hljs-subst">${params.id}</span>`</span>);
});

router.<span class="hljs-title function_">add</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'/user/:id/posts/:postId'</span>, <span class="hljs-function">(<span class="hljs-params">params</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`获取用户 <span class="hljs-subst">${params.id}</span> 的文章 <span class="hljs-subst">${params.postId}</span>`</span>);
});

<span class="hljs-comment">// 匹配请求</span>
<span class="hljs-keyword">const</span> result = router.<span class="hljs-title function_">match</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'/user/123/posts/456'</span>);
<span class="hljs-keyword">if</span> (result) {
  result.<span class="hljs-title function_">handler</span>(result.<span class="hljs-property">params</span>);
  <span class="hljs-comment">// 输出: 获取用户 123 的文章 456</span>
}
</code></pre>
<h2 data-id="heading-8">性能优势分析</h2>
<p><strong>为什么 RegExpRouter 更快？</strong></p>
<ol>
<li><strong>减少 JS 执行开销</strong>：从多层循环降到一次原生调用</li>
<li><strong>引擎优化</strong>：正则引擎经过数十年优化，包含 JIT、状态机等技术</li>
<li><strong>减少内存分配</strong>：无需频繁创建数组、对象</li>
<li><strong>一次性编译</strong>：预编译阶段完成所有准备工作，请求时零额外开销</li>
</ol>
<p><strong>性能对比概览</strong></p>























<table><thead><tr><th>方案</th><th>实现层次</th><th>执行效率</th><th>适用场景</th></tr></thead><tbody><tr><td>传统路由</td><td>JavaScript 层</td><td>中等</td><td>通用场景</td></tr><tr><td>RegExpRouter</td><td>引擎底层</td><td>极快</td><td>边缘计算、高并发</td></tr></tbody></table>
<blockquote>
<p><strong>📊 实际 Benchmark</strong>：根据 <a href="https://link.juejin.cn?target=https%3A%2F%2Fhono.dev%2Fdocs%2Fconcepts%2Fbenchmarks" target="_blank" title="https://hono.dev/docs/concepts/benchmarks" ref="nofollow noopener noreferrer">Hono 官方测试</a>，在 Cloudflare Workers 和 Deno 环境中，Hono 是同类框架中最快的。但在 Node.js 环境中，由于适配器开销，性能优势会打折扣。</p>
</blockquote>
<h2 data-id="heading-9">Hono 真实实现的进一步优化</h2>
<p>本文的简化版每个路由都是独立的正则表达式。而 Hono 的真实实现采用了<strong>多路由器协同</strong>的策略：</p>
<h3 data-id="heading-10">1. SmartRouter（智能路由器）</h3>
<p>Hono 默认使用 <strong>SmartRouter</strong>，它会：</p>
<ul>
<li>根据路由特征自动选择最快的路由器</li>
<li>动态组合 RegExpRouter、TrieRouter、LinearRouter</li>
<li>检测路由模式并持续使用最优方案</li>
</ul>
<h3 data-id="heading-11">2. 路由器分工</h3>

























<table><thead><tr><th>路由器</th><th>适用场景</th><th>特点</th></tr></thead><tbody><tr><td><strong>RegExpRouter</strong></td><td>动态参数路由</td><td>最快，但不支持所有模式</td></tr><tr><td><strong>TrieRouter</strong></td><td>复杂路由模式</td><td>支持所有模式，性能优秀</td></tr><tr><td><strong>LinearRouter</strong></td><td>少量路由</td><td>简单可靠，路由少时够用</td></tr></tbody></table>
<h3 data-id="heading-12">3. 实际优化策略</h3>
<ul>
<li><strong>静态路由优先</strong>：<code>/about</code>、<code>/contact</code> 等使用 Map 快速查找</li>
<li><strong>路由预分组</strong>：按 HTTP 方法分组，减少匹配次数</li>
<li><strong>延迟编译</strong>：RegExpRouter 编译较慢，适合应用启动时初始化，不适合无服务器环境的冷启动</li>
</ul>
<p>这些优化使得 Hono 在处理数百个路由时仍然保持极高性能。</p>
<h2 data-id="heading-13">局限性与权衡</h2>
<p>RegExpRouter 并非银弹，在使用时需要注意以下限制：</p>
<h3 data-id="heading-14">RegExpRouter 的局限</h3>
<ul>
<li><strong>不支持所有路由模式</strong>：某些复杂的路由规则无法用简单正则表示</li>
<li><strong>注册阶段较慢</strong>：路由编译需要时间，不适合每次请求都重新初始化的环境（如某些无服务器冷启动场景）</li>
<li><strong>调试难度</strong>：编译后的正则表达式可读性较差，出错时难以定位</li>
<li><strong>模式约束</strong>：如带严格约束的参数 <code>/:id(\\d+)</code> 需要额外处理</li>
</ul>
<h3 data-id="heading-15">运行环境差异</h3>






























<table><thead><tr><th>环境</th><th>性能表现</th><th>原因</th></tr></thead><tbody><tr><td>Cloudflare Workers</td><td>⭐⭐⭐⭐⭐ 极快</td><td>原生 Web 标准 API</td></tr><tr><td>Deno</td><td>⭐⭐⭐⭐⭐ 极快</td><td>原生 Web 标准 API</td></tr><tr><td>Bun</td><td>⭐⭐⭐⭐ 很快</td><td>高性能 JS 运行时</td></tr><tr><td>Node.js</td><td>⭐⭐⭐ 中等</td><td>需要适配器转换</td></tr></tbody></table>
<blockquote>
<p><strong>💡 选型建议</strong>：如果你的应用运行在边缘计算环境（Cloudflare Workers、Vercel Edge Functions 等），Hono 是绝佳选择。如果是传统 Node.js 服务器，Fastify 可能是更好的选择。</p>
</blockquote>
<p>但对于大多数 Web 应用场景，RegExpRouter 的性能与功能平衡已经足够优秀。</p>
<h2 data-id="heading-16">总结</h2>
<p>Hono 的 RegExpRouter 通过"预编译 + 引擎下沉"的策略，在特定环境中将路由匹配性能提升到极致：</p>
<h3 data-id="heading-17">核心优势</h3>
<ol>
<li><strong>预编译</strong>：启动时一次性将路由转为正则，摊销成本</li>
<li><strong>引擎下沉</strong>：利用 C++ 实现的正则引擎，避免 JS 层开销</li>
<li><strong>参数捕获</strong>：巧妙利用正则捕获组，无需手动解析</li>
<li><strong>智能组合</strong>：SmartRouter 自动选择最优路由器，兼顾性能与功能</li>
</ol>
<h3 data-id="heading-18">设计哲学</h3>
<p>这种设计哲学值得我们思考：<strong>性能优化的终极目标，往往是让"热路径"代码尽可能多地运行在更底层的优化环境中</strong>。</p>
<p>对于 Web 框架来说，路由匹配就是最热的路径之一。Hono 在边缘计算环境中找到了这个问题的最优解，同时通过多路由器架构保证了广泛的适用性。</p>
<h3 data-id="heading-19">最佳实践</h3>
<ul>
<li>✅ <strong>边缘计算/Serverless</strong>：Hono 是首选（Cloudflare Workers、Deno Deploy）</li>
<li>✅ <strong>高并发场景</strong>：充分发挥 RegExpRouter 性能优势</li>
<li>⚠️ <strong>Node.js 环境</strong>：考虑性能权衡，或选择 Fastify 等专门优化的框架</li>
<li>⚠️ <strong>复杂路由规则</strong>：了解 RegExpRouter 的限制，必要时使用 TrieRouter</li>
</ul>
<hr/>
<p><strong>延伸阅读：</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhono.dev%2F" target="_blank" title="https://hono.dev/" ref="nofollow noopener noreferrer">Hono 官方文档</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhono.dev%2Fdocs%2Fconcepts%2Frouters" target="_blank" title="https://hono.dev/docs/concepts/routers" ref="nofollow noopener noreferrer">Hono Routers 详解</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhono.dev%2Fdocs%2Fconcepts%2Fbenchmarks" target="_blank" title="https://hono.dev/docs/concepts/benchmarks" ref="nofollow noopener noreferrer">Hono Benchmarks</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fv8.dev%2Fblog" target="_blank" title="https://v8.dev/blog" ref="nofollow noopener noreferrer">V8 正则引擎优化技术</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fweb-frameworks-benchmark.netlify.app%2F" target="_blank" title="https://web-frameworks-benchmark.netlify.app/" ref="nofollow noopener noreferrer">Web 框架性能对比工具</a></li>
</ul>
<p><strong>技术资源：</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhonojs%2Fhono" target="_blank" title="https://github.com/honojs/hono" ref="nofollow noopener noreferrer">Hono GitHub 仓库</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fusualoma" target="_blank" title="https://github.com/usualoma" ref="nofollow noopener noreferrer">RegExpRouter 创建者：Taku Amano</a></li>
</ul>
<hr/>
<p><strong>📝 文章说明</strong></p>
<p>本文基于对 Hono 框架的学习和研究编写，代码示例为简化版实现，用于教学目的。实际的 Hono RegExpRouter 实现更加复杂和优化。</p>
<p>性能数据和对比来自 Hono 官方文档和社区测试，具体数值会因测试环境、负载类型、运行时版本等因素而异。实际使用时请根据自己的场景进行测试。</p>
<p>如果您发现文中有任何不准确之处，欢迎指正。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI专栏 | Prompt Engineering实战 [新闻助手实战，这样写Prompt，你的程序能用？]]]></title>    <link>https://juejin.cn/post/7598699872552173604</link>    <guid>https://juejin.cn/post/7598699872552173604</guid>    <pubDate>2026-01-25T05:50:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598699872552173604" data-draft-id="7598587406707064873" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI专栏 | Prompt Engineering实战 [新闻助手实战，这样写Prompt，你的程序能用？]"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-01-25T05:50:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="猿猿长成记"/> <meta itemprop="url" content="https://juejin.cn/user/4232463136874240"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI专栏 | Prompt Engineering实战 [新闻助手实战，这样写Prompt，你的程序能用？]
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4232463136874240/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    猿猿长成记
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-25T05:50:29.000Z" title="Sun Jan 25 2026 05:50:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读11分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AI专栏 | Prompt Engineering实战 [新闻助手实战，这样写Prompt，你的程序能用？]</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c3ae3388392474e9fb10ed1adfabcae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54y_54y_6ZW_5oiQ6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769925029&amp;x-signature=BT%2BfHJ%2FxhAcOXi6VSH6w6JQ5kpQ%3D" alt="3 Prompt Engineering实战-黑板报.png" loading="lazy"/></p>
<blockquote>
<p>难度系数：★★★☆☆</p>
</blockquote>
<blockquote>
<p>本章知识：</p>
<ul>
<li>复习清单</li>
<li>新闻助手Prompt</li>
<li>Prompt分析 <span>[重点 ★★★★★]</span></li>
<li>改造验证 <span>[重点 ★★★★★]</span></li>
<li>继续改进思路</li>
<li>下一章预告: PromptEngineering进阶技巧</li>
</ul>
</blockquote>
<h3 data-id="heading-1">复习清单</h3>
<p>上一章我们提到了关于PromptEngineering的8条高能建议，本章基于新闻助手的场景，带你来观察一下Prompt这样写你的程序能用么。</p>
<p>先来回顾一下PromptEngineering的8条高能建议有哪些？</p>
<ol start="0">
<li>把AI当人来看</li>
<li>提供单一的任务</li>
<li>任务描述清晰且准确</li>
<li>给出适量参考样例</li>
<li>正向描述任务信息</li>
<li>不要提供过长的prompt</li>
<li>根据任务类型切换任务角色</li>
<li>A/B测试迭代找到最佳的prompt</li>
</ol>
<p>接下来我们会用这份清单，逐条对照分析一个真实 Prompt 在程序中的表现。</p>
<blockquote>
<p><strong>注意</strong> 本章内容实际已涉及Agent开发，此时我们主要关注Prompt的编写问题。</p>
</blockquote>
<h3 data-id="heading-2">新闻助手Prompt示例工程</h3>
<h4 data-id="heading-3">需求描述</h4>
<p>现在某公司要开发一个新闻助手，这个新闻助手会根据用户输入的关键词，从互联网上抓取相关的新闻，并返回给用户。</p>
<h4 data-id="heading-4">Code示例</h4>
<p>下面是一个简单的新闻助手，基于LLM的搜索能力，实现新闻查询及格式化输出，来我们分析一下代码中所犯的问题有哪些？</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 非完整代码，主要包括关键代码，完整见gitcode仓库</span>
<span class="hljs-comment"># https://gitcode.com/miasdz/ai-column-code.git</span>

sys_prompt = <span class="hljs-string">"""
你是一个新闻助手，负责进行新闻信息查询并格式化输出。

# 输出要求
## 输出格式
以JSON格式仅输出查询结果，确保输出结果可以被python中json.loads加载不报错。
## JSON内容要求
0. json总体结构为list嵌套dict结构
1. 每个dict结构表示一个企业的新闻信息查询结果
2. 每个dict结构存在两个key，name和news
3. name key对应value为企业名称，value值类型为string
4. news key对应value值为新闻列表，value值类型为list，list的每一项值类型为dict
5. 企业新闻信息查询结果的list的每一个dict类型的值包括三个要素：date（日期）、new_type（新闻类型）、news（新闻信息）
6. new_type类型包括：
- 重大事件/战略动态类
- 产品/技术创新类
- 企业成就/荣誉认可类
- 人事与组织变动类
- 合规、风险与监管类
- 社会责任/ESG/公益类
- 日常运营与业务动态类
- 招标、采购公告类
## 示例
[
    {
      "name":"xx企业",
      "news":[
        {
            "date":"2026年1月12日",
            "new_type":"合规、风险与监管类",
            "news": "xxx公司因xxx业务违规开展被处罚1000万元。"
        },
        {
            "date":"2026年1月5日",
            "new_type":"重大事件/战略动态类",
            "news": "xxx公司与yyy公司达成战略合作。"
        },
      ]
    },
    {
      "name":"zz企业",
      "news":[
        {
            "date":"2026年1月18日",
            "new_type":"合规、风险与监管类",
            "news": "zz企业因xxx业务违规开展被行政处罚85万元。"
        },
        {
            "date":"2026年1月19日",
            "new_type":"人事与组织变动类",
            "news": "zz企业新任命总经理uu。"
        },
      ]
    }
]
"""</span>

user_prompt = <span class="hljs-string">"""
查询山西银行和晋商银行近期的5条新闻
"""</span>

<span class="hljs-comment"># 对话消息</span>
messages = [
    {
        <span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>,
        <span class="hljs-string">"content"</span>: sys_prompt
    },
    {
        <span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>,
        <span class="hljs-string">"content"</span>: user_prompt
    }
]

<span class="hljs-comment"># 调用llm接口</span>
chat_completion = client.chat.completions.create(
    model=model,
    messages=messages,
    extra_body={
        <span class="hljs-string">"enable_search"</span>: <span class="hljs-literal">True</span>,
        <span class="hljs-string">"search_options"</span>: {
            <span class="hljs-string">"search_strategy"</span>: <span class="hljs-string">"max"</span>,  <span class="hljs-comment"># 配置搜索策略为高性能模式</span>
            <span class="hljs-string">"forced_search"</span>: <span class="hljs-literal">True</span>
        }
    }
)
</code></pre>
<p><strong>...... 此处思考3分钟 ......</strong></p>
<h3 data-id="heading-5">Prompt分析</h3>
<h4 data-id="heading-6">运行结果</h4>
<p>先看一下运行结果，看看程序是否能正常返回结果。</p>
<blockquote>
<p><strong>注意</strong> 下述运行结果代码实测结果截取，再次执行无法保证完全一致。</p>
</blockquote>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"山西银行"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026年1月7日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"日常运营与业务动态类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"山西银行发布‘晋晟理财’理财产品净值公告。"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年12月31日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"日常运营与业务动态类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"山西银行发布‘晋晟理财’理财产品净值公告。"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年12月24日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"日常运营与业务动态类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"山西银行发布‘晋晟理财’理财产品净值公告。"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年12月18日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"重大事件/战略动态类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"任凯与临汾市长王延峰座谈。"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年12月12日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"重大事件/战略动态类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"邢毅赴省内金融同业拜访交流。"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"晋商银行"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年12月15日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"合规、风险与监管类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"晋商消费金融成被执行人第一大股东为晋商银行。"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年12月10日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"合规、风险与监管类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"山西最新批复！多家金融机构高管任职获批。"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年11月30日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"人事与组织变动类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"山西银行党委副书记、行长(代)邢毅带队赴太重集团开展专项调研。"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年11月30日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"人事与组织变动类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"山西银行党委副书记、副董事长、行长李颖耀拟进一步使用。"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年11月28日"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"重大事件/战略动态类"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"山西银行新增高管人事变动引关注。"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f96070bbbf5411798f90187b69b761d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54y_54y_6ZW_5oiQ6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769925029&amp;x-signature=iBBkdr9fOdkIDYcAUlN4bvD3XDE%3D" alt="json校验" loading="lazy"/></p>
<p>观察上述结果，prompt要求的json格式是正确的。但是从内容上分析会发现明显的错误：</p>
<ol>
<li>同一个人的名字出现在了两家企业内，稍微了解一下是错误新闻</li>
<li>我要求的是近期新闻，截至我写作时间2026年1月19日，返回的新闻几乎全都是25年末的，近期目标效果差</li>
<li>新闻与公司关联错误，A公司新闻归类到B公司</li>
<li>从news字段中看不出来企业与这条新闻的关系</li>
<li>新闻类型错误，如“重大事件/战略动态类”</li>
</ol>
<h4 data-id="heading-7">问题分析</h4>
<p>基于前面的建议，我们逐条分析一下这段乍一看还不错的prompt，存在<strong>什么问题</strong>？</p>
<h5 data-id="heading-8">1. 提供单一的任务</h5>
<p>问题指数: ★★★★★</p>
<p><strong>基于上一章节对单一任务的理解，我们再看Prompt：</strong></p>
<p>SystemPrompt逻辑点：</p>
<ul>
<li>新闻信息查询</li>
<li>新闻归类</li>
<li>数据格式化</li>
</ul>
<p>根据单一任务理解，system prompt已经违反单一任务的限制，不做认知的切换，新闻信息查询和归类属于两类任务 <strong>信息提取</strong> 和 <strong>分类决策任务</strong>，不满足单一任务定义。</p>
<p>UserPrompt逻辑点:</p>
<ul>
<li>查询山西银行近期新闻</li>
<li>查询晋商银行近期新闻</li>
<li>近期是什么时候[隐性任务]</li>
<li>新闻筛选</li>
</ul>
<p>对于UserPrompt，要求同时查询两个企业的信息，涉及了两个信息聚合主题，也不符合单一任务定义。</p>
<p>根据执行结果，综合SystemPrompt和UserPrompt，经过A/B测试，主要问题体现在UserPrompt中存在两个信息实体，具体见新Prompt运行效果。</p>
<h5 data-id="heading-9">2. 任务描述清晰且准确</h5>
<p>从程序运行结果看，主要的prompt用于描述数据格式，返回符合预期要求，从描述层面足够清晰，满足该项。</p>
<h5 data-id="heading-10">3. 给出适量参考样例</h5>
<p>JSON格式正确，demo中给了明确的示例，满足该项。</p>
<h5 data-id="heading-11">4. 正向描述任务信息</h5>
<p>问题指数: ★☆☆☆☆☆</p>
<p>确保输出结果可以被python中json.loads加载不报错。非正面描述，不过问题不大，大模型实测是没问题的，也可以改为更合理的描述如"符合标准 RFC 8259 规范的 JSON 字符串"。</p>
<h5 data-id="heading-12">5. 不要提供过长的prompt</h5>
<p>使用openai的tokenizer计算约在gpt4模型下约600,从模型容量角度看不多，该条满足。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a077a532bbd344429f894587753cbb63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54y_54y_6ZW_5oiQ6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769925029&amp;x-signature=d0j6ZOD2SNWsAEAvw8RpiHf7QZU%3D" alt="token统计" loading="lazy"/></p>
<blockquote>
<p>可参考OpenAI官方tokenizer计算结果（不同模型结算结果不同，仅供参考）</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Ftokenizer" target="_blank" title="https://platform.openai.com/tokenizer" ref="nofollow noopener noreferrer">platform.openai.com/tokenizer</a></p>
</blockquote>
<h5 data-id="heading-13">6. 根据任务类型切换任务角色</h5>
<p>Systmem Prompt首行定义了任务角色，该条满足。</p>
<h5 data-id="heading-14">7. A/B测试迭代找到最佳的prompt</h5>
<p>A/B测试迭代属于持续优化的过程，接下来我们继续修改prompt测试的过程满足此条。</p>
<h3 data-id="heading-15">改造验证</h3>
<h4 data-id="heading-16">新版Prompt</h4>
<pre><code class="hljs language-python" lang="python">sys_prompt = <span class="hljs-string">"""
你是一个新闻助手，负责进行新闻信息查询并格式化输出。

# 输出要求
## 输出格式
以JSON格式仅输出查询结果，确保输出结果符合标准 RFC 8259 规范的 JSON 字符串。
## JSON内容要求
1. JSON结构存在两个key，name和news
2. name key对应value为企业名称，value值类型为string
3. news key对应value值为新闻列表，value值类型为list，list的每一项值类型为dict
4. 企业新闻信息查询结果的list的每一个dict类型的值包括三个要素：date（日期）、new_type（新闻类型）、new_info（新闻信息）
5. new_type类型包括：
- 重大事件/战略动态类
- 产品/技术创新类
- 企业成就/荣誉认可类
- 人事与组织变动类
- 合规、风险与监管类
- 社会责任/ESG/公益类
- 日常运营与业务动态类
- 招标、采购公告类
## 示例
{
  "name":"xx企业",
  "news":[
    {
        "date":"2026年1月12日",
        "new_type":"合规、风险与监管类",
        "news": "xxx公司因xxx业务违规开展被处罚1000万元。"
    },
    {
        "date":"2026年1月5日",
        "new_type":"重大事件/战略动态类",
        "news": "xxx公司与yyy公司达成战略合作。"
    },
  ]
}
# 约束
当未检索到可验证的有效新闻时，news 字段应返回一个空数组 []
"""</span>

user_prompt = <span class="hljs-string">"""
查询晋商银行近期的5条新闻
"""</span>
</code></pre>
<h4 data-id="heading-17">实测结果</h4>
<p>再看新prompt测试结果，在单一信息主体下，结果可用。</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"晋商银行"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026年1月16日"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"日常运营与业务动态类"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"晋商银行股份有限公司2026年第006期同业存单发行情况公告。"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026年1月14日"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"日常运营与业务动态类"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"晋商银行股份有限公司2026年第004期同业存单即日起开始在银行间债券市场交易流通。"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026年1月6日"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"合规、风险与监管类"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"晋商银行发布《关于加强个人银行账户安全管理的公告》。"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年11月28日"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"日常运营与业务动态类"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"晋商银行召开2025年四季度经营工作会。"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025年10月29日"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"new_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"人事与组织变动类"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"news"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"晋商银行启动2026年度校园招聘，计划招聘11人。"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-18">继续改进思路</h3>
<h4 data-id="heading-19">初始需求如何满足？</h4>
<p>再翻回来看user_prompt，要求查询两个信息主体的新闻，上述优化后的prompt仅查询一个主体好用，那多个怎么办？</p>
<p>这就涉及工作流的开发：</p>
<ol>
<li>用户意图识别：通过用户prompt摘取在新闻查询场景下的查询主体有几个</li>
<li>根据获取出的查询主体，多次调用新闻查询服务</li>
<li>聚合结果</li>
</ol>
<h4 data-id="heading-20">查询质量不满足、新闻总结不满足怎么办</h4>
<p>现在使用的是大模型提供的查询服务，如果需要相对稳定的查询数据源，那就需要依赖外部服务了，比如秘塔搜索API、百度搜索API甚至是外部稳定数据源的数据采购等方式来提升数据质量。</p>
<p>此时做法就变成了：</p>
<ol>
<li>用户意图识别获取查询主体</li>
<li>FuncationCalling获取外部数据</li>
<li>通过LLM进行新闻总结及归类</li>
<li>基于新闻总结及归类结果进行信息提取为JSON结构</li>
<li>多轮查询的信息聚合</li>
</ol>
<p>这些流程的窜连完成一个完整的新闻领域查询服务，详情查看gitcode源码。</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2Fmiasdz%2Fai-column-code.git" target="_blank" title="https://gitcode.com/miasdz/ai-column-code.git" ref="nofollow noopener noreferrer">gitcode.com/miasdz/ai-c…</a></p>
</blockquote>
<p>针对LLM单一任务，靠人识别可能因经验不足或者思维定式无法准确分析，后续将开发Prompt单一分析器Agent，用于优化Agent的Prompt准备。</p>
<h3 data-id="heading-21">下一章预告</h3>
<p>下一章节将通过介绍PromptEngineering中思维链、思维树、自洽性等进阶技巧。</p>
<hr/>
<p align="center">关注本专栏，让我们一起掌握方法、实践落地、共同发展。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【React-3/Lesson76(2025-12-18)】React Hooks 与函数式组件开发详解🧠]]></title>    <link>https://juejin.cn/post/7599450177057718282</link>    <guid>https://juejin.cn/post/7599450177057718282</guid>    <pubDate>2026-01-26T10:11:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599450177057718282" data-draft-id="7599528186586382346" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【React-3/Lesson76(2025-12-18)】React Hooks 与函数式组件开发详解🧠"/> <meta itemprop="keywords" content="React.js,前端,面试"/> <meta itemprop="datePublished" content="2026-01-26T10:11:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jing_Rainbow"/> <meta itemprop="url" content="https://juejin.cn/user/1285809519198256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【React-3/Lesson76(2025-12-18)】React Hooks 与函数式组件开发详解🧠
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1285809519198256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jing_Rainbow
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:11:23.000Z" title="Mon Jan 26 2026 10:11:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>🧠在现代前端开发中，React 已经全面拥抱函数式编程范式。通过 <strong>Hooks</strong>，开发者可以在不编写 class 的情况下使用状态（state）和生命周期等特性。本文将深入解析你所接触的代码片段，并系统性地补充相关知识，涵盖 <code>useState</code>、<code>useEffect</code>、纯函数、副作用、组件挂载/更新/卸载机制、响应式状态管理等核心概念。</p>
<hr/>
<h2 data-id="heading-0">🔁 useState：让函数组件拥有状态</h2>
<p>在传统 React 中，只有类组件才能拥有状态（state）。而 <code>useState</code> Hook 的出现，彻底改变了这一限制。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> [num, setNum] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
</code></pre>
<p>这行代码做了三件事：</p>
<ol>
<li>声明一个名为 <code>num</code> 的状态变量；</li>
<li>提供一个名为 <code>setNum</code> 的函数用于更新该状态；</li>
<li>初始值为 <code>0</code>。</li>
</ol>
<h3 data-id="heading-1">✨ 初始化支持函数形式（惰性初始化）</h3>
<p>当初始状态需要通过复杂计算获得时，可以传入一个<strong>初始化函数</strong>：</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> [num, setNum] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> num1 = <span class="hljs-number">1</span> + <span class="hljs-number">2</span>;
  <span class="hljs-keyword">const</span> num2 = <span class="hljs-number">2</span> + <span class="hljs-number">3</span>;
  <span class="hljs-keyword">return</span> num1 + num2; <span class="hljs-comment">// 返回 6</span>
});
</code></pre>
<blockquote>
<p>⚠️ 注意：这个函数必须是<strong>同步的纯函数</strong>，不能包含异步操作（如 <code>fetch</code>），因为 React 需要确保状态的确定性和可预测性。</p>
</blockquote>
<h3 data-id="heading-2">🔄 状态更新函数支持回调形式</h3>
<p>更新状态时，可以传入一个函数，其参数是上一次的状态值：</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">setNum</span>(<span class="hljs-function">(<span class="hljs-params">prevNum</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(prevNum); <span class="hljs-comment">// 打印旧值</span>
  <span class="hljs-keyword">return</span> prevNum + <span class="hljs-number">1</span>;   <span class="hljs-comment">// 返回新值</span>
});
</code></pre>
<p>这种方式在<strong>批量更新</strong>或<strong>异步环境中</strong>特别安全，避免因闭包捕获旧状态而导致错误。</p>
<hr/>
<h2 data-id="heading-3">⚙️ useEffect：处理副作用的瑞士军刀</h2>
<p><code>useEffect</code> 是 React 中处理<strong>副作用（side effects）<strong>的核心 Hook。所谓“副作用”，是指那些</strong>不在纯函数范畴内</strong>的操作，例如：</p>
<ul>
<li>数据获取（如 API 请求）</li>
<li>手动 DOM 操作</li>
<li>订阅事件（如 WebSocket）</li>
<li>启动定时器（<code>setInterval</code> / <code>setTimeout</code>）</li>
</ul>
<h3 data-id="heading-4">📌 基本用法</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'effect'</span>);
}, [num]);
</code></pre>
<ul>
<li>第一个参数：副作用函数（在渲染后执行）</li>
<li>第二个参数：<strong>依赖数组（dependency array）</strong></li>
</ul>
<h3 data-id="heading-5">🔍 依赖项的三种情况</h3>

























<table><thead><tr><th>依赖项</th><th>行为</th><th>类比 Vue 生命周期</th></tr></thead><tbody><tr><td><code>[]</code>（空数组）</td><td>仅在组件<strong>挂载后</strong>执行一次</td><td><code>onMounted</code></td></tr><tr><td><code>[a, b]</code></td><td>当 <code>a</code> 或 <code>b</code> <strong>变化时</strong>重新执行</td><td><code>watch([a, b])</code></td></tr><tr><td><strong>无依赖项</strong>（省略第二个参数）</td><td><strong>每次渲染后都执行</strong></td><td><code>onMounted</code> + <code>onUpdated</code></td></tr></tbody></table>
<blockquote>
<p>💡 在 React 18 的 <code>&lt;StrictMode&gt;</code> 下，开发环境会<strong>故意双次调用</strong> <code>useEffect</code>（不含依赖或依赖为空时），以帮助开发者发现潜在的副作用问题（如未正确清理资源）。</p>
</blockquote>
<h3 data-id="heading-6">🧹 清理副作用：返回清理函数</h3>
<p>许多副作用需要在组件更新前或卸载时<strong>清理</strong>，否则会导致内存泄漏或重复订阅。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num);
  }, <span class="hljs-number">1000</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'remove'</span>);
    <span class="hljs-built_in">clearInterval</span>(timer); <span class="hljs-comment">// 清理定时器</span>
  };
}, [num]);
</code></pre>
<ul>
<li>返回的函数会在<strong>下一次 effect 执行前</strong>调用，或在<strong>组件卸载时</strong>调用。</li>
<li>这利用了<strong>闭包</strong>机制：清理函数能访问到创建它时的 <code>timer</code> 变量。</li>
</ul>
<blockquote>
<p>✅ 最佳实践：<strong>所有开启的资源（定时器、订阅、监听器）都必须有对应的清理逻辑。</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-7">🧼 纯函数 vs 副作用</h2>
<p>理解 <code>useEffect</code> 的设计哲学，必须先理解**纯函数（Pure Function）**的概念。</p>
<h3 data-id="heading-8">✅ 纯函数的特点</h3>
<ul>
<li>相同输入 → 相同输出</li>
<li><strong>无副作用</strong>：不修改外部状态、不发起网络请求、不操作 DOM</li>
<li>无随机性（如 <code>Math.random()</code>）</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// ✅ 纯函数</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">x, y</span>) =&gt; x + y;
</code></pre>
<h3 data-id="heading-9">❌ 非纯函数（有副作用）</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ❌ 修改传入的数组（改变外部状态）</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">nums</span>) {
  nums.<span class="hljs-title function_">push</span>(<span class="hljs-number">3</span>); <span class="hljs-comment">// 副作用！</span>
  <span class="hljs-keyword">return</span> nums.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">pre, cur</span>) =&gt;</span> pre + cur, <span class="hljs-number">0</span>);
}
</code></pre>
<p>React 组件本身应尽可能接近纯函数：<strong>props → JSX</strong>。但现实应用离不开副作用，因此 <code>useEffect</code> 被设计为<strong>隔离副作用的沙盒</strong>。</p>
<hr/>
<h2 data-id="heading-10">🧩 组件生命周期在函数式组件中的映射</h2>





















<table><thead><tr><th>Class 组件生命周期</th><th>函数式组件（Hooks）</th></tr></thead><tbody><tr><td><code>componentDidMount</code></td><td><code>useEffect(() =&gt; {}, [])</code></td></tr><tr><td><code>componentDidUpdate</code></td><td><code>useEffect(() =&gt; {}, [dep])</code></td></tr><tr><td><code>componentWillUnmount</code></td><td><code>useEffect(() =&gt; { return () =&gt; {} }, [])</code></td></tr></tbody></table>
<blockquote>
<p>🔄 注意：<code>useEffect</code> <strong>合并了挂载、更新、卸载三个阶段</strong>，通过依赖项和返回函数实现精细控制。</p>
</blockquote>
<hr/>
<h2 data-id="heading-11">🏗️ 项目结构与入口分析</h2>
<h3 data-id="heading-12">📄 <code>main.jsx</code>：应用入口</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">createRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'root'</span>)).<span class="hljs-title function_">render</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>);
</code></pre>
<ul>
<li>使用 React 18 的 <strong><code>createRoot</code></strong> API（并发模式）</li>
<li>渲染 <code>&lt;App /&gt;</code> 到 <code>#root</code> 容器</li>
<li>注释掉的 <code>&lt;StrictMode&gt;</code> 是开发辅助工具，用于暴露潜在问题（如重复 effect）</li>
</ul>
<h3 data-id="heading-13">🎨 样式文件 <code>index.css</code> 与 <code>App.css</code></h3>
<ul>
<li>使用 CSS 自定义属性（<code>:root</code>）实现主题切换（亮色/暗色）</li>
<li>响应式设计（<code>min-width: 320px</code>）</li>
<li>悬停动画、焦点样式等增强用户体验</li>
</ul>
<hr/>
<h2 data-id="heading-14">🔍 深入 <code>Demo.jsx</code>：副作用与清理</h2>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Demo</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'123123'</span>); <span class="hljs-comment">// 模拟 onMounted</span>
    <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'timer'</span>);
    }, <span class="hljs-number">1000</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'remove'</span>);
      <span class="hljs-built_in">clearInterval</span>(timer);
    };
  }, []); <span class="hljs-comment">// 仅挂载时执行</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>偶数Demo<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<ul>
<li>即使 <code>Demo</code> 组件被多次渲染（因父组件 <code>App</code> 更新），由于依赖项为空，<strong>定时器只创建一次</strong></li>
<li>当 <code>App</code> 卸载 <code>Demo</code>（如条件渲染切换），清理函数会执行，防止内存泄漏</li>
</ul>
<hr/>
<h2 data-id="heading-15">📊 状态驱动 UI：响应式核心</h2>
<p>在 <code>App.jsx</code> 中：</p>
<pre><code class="hljs language-jsx" lang="jsx">{num % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> ? <span class="hljs-string">'偶数'</span> : <span class="hljs-string">'奇数'</span>}
</code></pre>
<p>这体现了 React 的核心思想：<strong>UI 是状态的函数</strong>。<br/>
每当 <code>num</code> 变化，React 会重新执行组件函数，生成新的 JSX，然后高效地更新 DOM。</p>
<hr/>
<h2 data-id="heading-16">🚫 为什么不能在 <code>useState</code> 中直接异步初始化？</h2>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// ❌ 错误！useState 不支持异步初始化</span>
<span class="hljs-keyword">const</span> [data, setData] = <span class="hljs-title function_">useState</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(...);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
});
</code></pre>
<p>原因：</p>
<ul>
<li>React 需要<strong>同步确定</strong>初始状态，以便进行协调（reconciliation）</li>
<li>异步操作结果不确定，破坏纯函数原则</li>
</ul>
<p>✅ 正确做法：在 <code>useEffect</code> 中请求数据</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">queryData</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-title function_">setNum</span>(data));
}, []);
</code></pre>
<p>其中 <code>queryData</code> 是一个模拟异步请求的函数（见 <code>App.jsx</code>）：</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">queryData</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-number">666</span>), <span class="hljs-number">2000</span>);
  });
  <span class="hljs-keyword">return</span> data;
}
</code></pre>
<hr/>
<h2 data-id="heading-17">🧪 开发者工具与调试技巧</h2>
<ul>
<li>利用 <code>console.log</code> 观察 effect 执行时机</li>
<li>注意 Strict Mode 下的双次调用（仅开发环境）</li>
<li>使用 React DevTools 检查组件状态和依赖</li>
</ul>
<hr/>
<h2 data-id="heading-18">✅ 总结：React Hooks 最佳实践</h2>
<ol>
<li><strong>状态管理</strong>：用 <code>useState</code> 声明响应式状态，更新时优先使用回调形式</li>
<li><strong>副作用隔离</strong>：所有非纯操作放入 <code>useEffect</code></li>
<li><strong>依赖声明</strong>：精确列出 effect 所依赖的所有变量（ESLint 插件可自动检测）</li>
<li><strong>资源清理</strong>：务必在 effect 中返回清理函数</li>
<li><strong>避免异步初始化</strong>：数据请求放在 <code>useEffect</code> 中</li>
<li><strong>理解闭包</strong>：effect 和清理函数通过闭包捕获变量，注意 stale closure 问题（可通过 ref 解决）</li>
</ol>
<hr/>
<p>通过以上详尽解析，你应该已经掌握了 React Hooks 的核心机制与工程实践。记住：<strong>函数式组件 + Hooks = 现代 React 开发的黄金标准</strong>。继续深入，你将能构建出高性能、可维护、可预测的前端应用！🚀</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React Native 中 Styled Components 配置指南]]></title>    <link>https://juejin.cn/post/7599483794656985129</link>    <guid>https://juejin.cn/post/7599483794656985129</guid>    <pubDate>2026-01-26T10:17:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599483794656985129" data-draft-id="7599299048303493163" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React Native 中 Styled Components 配置指南"/> <meta itemprop="keywords" content="前端,React Native"/> <meta itemprop="datePublished" content="2026-01-26T10:17:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sera"/> <meta itemprop="url" content="https://juejin.cn/user/3870740938759965"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React Native 中 Styled Components 配置指南
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3870740938759965/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sera
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:17:00.000Z" title="Mon Jan 26 2026 10:17:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">React Native 中 Styled Components 配置指南</h2>
<h3 data-id="heading-1">什么是 Styled Components？</h3>
<p>Styled Components 是一个 CSS-in-JS 库，让你可以在 JavaScript/TypeScript 代码中编写样式，并将样式与组件紧密结合。</p>
<h4 data-id="heading-2">核心特性</h4>
<p><strong>1. CSS-in-JS</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 传统方式</span>
<span class="hljs-keyword">const</span> styles = <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">container</span>: { <span class="hljs-attr">padding</span>: <span class="hljs-number">16</span> }
});

<span class="hljs-comment">// Styled Components 方式</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Container</span> = styled.<span class="hljs-property">View</span><span class="hljs-string">`
  padding: 16px;
`</span>;
</code></pre>
<p><strong>2. 自动样式隔离</strong>
每个 styled component 都有唯一的 class 名，避免样式冲突：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span> = styled.<span class="hljs-property">TouchableOpacity</span><span class="hljs-string">`...`</span>;
<span class="hljs-comment">// 生成类似：.Button-asdf1234 { ... }</span>
</code></pre>
<p><strong>3. 主题支持</strong>
内置主题系统，轻松实现深色/浅色主题：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Title</span> = styled.<span class="hljs-property">Text</span><span class="hljs-string">`
  color: <span class="hljs-subst">${props =&gt; props.theme.colors.text}</span>;
`</span>;
</code></pre>
<p><strong>4. 动态样式</strong>
基于 props 动态改变样式：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span> = styled.<span class="hljs-property">TouchableOpacity</span>&lt;{ <span class="hljs-attr">variant</span>: <span class="hljs-string">'primary'</span> | <span class="hljs-string">'secondary'</span> }&gt;<span class="hljs-string">`
  background-color: <span class="hljs-subst">${props =&gt;
    props.variant === <span class="hljs-string">'primary'</span> ? <span class="hljs-string">'#007AFF'</span> : <span class="hljs-string">'#5856D6'</span>}</span>;
`</span>;
</code></pre>
<h4 data-id="heading-3">优势对比</h4>








































<table><thead><tr><th>特性</th><th>StyleSheet</th><th>Styled Components</th></tr></thead><tbody><tr><td>样式隔离</td><td>❌ 需要手动管理</td><td>✅ 自动隔离</td></tr><tr><td>主题支持</td><td>❌ 需要额外配置</td><td>✅ 内置支持</td></tr><tr><td>动态样式</td><td>⚠️ 条件语句复杂</td><td>✅ 简洁直观</td></tr><tr><td>TypeScript</td><td>✅ 支持</td><td>✅ 完整类型推断</td></tr><tr><td>样式复用</td><td>⚠️ 需要手动合并</td><td>✅ 继承机制</td></tr><tr><td>组件封装</td><td>❌ 样式和组件分离</td><td>✅ 样式与组件一体</td></tr></tbody></table>
<h3 data-id="heading-4">如何配置 Styled Components</h3>
<h4 data-id="heading-5">第一步：安装依赖</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 安装 styled-components</span>
yarn add styled-components

<span class="hljs-comment"># 安装类型定义和 Babel 插件</span>
yarn add -D @types/styled-components babel-plugin-styled-components
</code></pre>
<p><strong>依赖说明</strong>：</p>
<ul>
<li><code>styled-components</code>: 核心库</li>
<li><code>@types/styled-components</code>: TypeScript 类型定义</li>
<li><code>babel-plugin-styled-components</code>: 优化开发体验和性能</li>
</ul>
<h4 data-id="heading-6">第二步：配置 Babel</h4>
<p>编辑 <code>babel.config.js</code>：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">presets</span>: [<span class="hljs-string">'module:@react-native/babel-preset'</span>],
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-comment">// ... 其他插件</span>
    [
      <span class="hljs-string">'babel-plugin-styled-components'</span>,
      {
        <span class="hljs-attr">displayName</span>: <span class="hljs-literal">true</span>,              <span class="hljs-comment">// 开发模式下显示组件名</span>
        <span class="hljs-attr">meaninglessFileNames</span>: [<span class="hljs-string">"index"</span>, <span class="hljs-string">"styles"</span>],
        <span class="hljs-attr">pure</span>: <span class="hljs-literal">true</span>,                     <span class="hljs-comment">// 移除不必要的辅助代码</span>
      },
    ]
  ],
};
</code></pre>
<p><strong>配置说明</strong>：</p>
<ul>
<li><code>displayName: true</code> - 开发时在 React DevTools 中显示组件名称</li>
<li><code>meaninglessFileNames</code> - 忽略这些文件名，不生成 class 名</li>
<li><code>pure: true</code> - 启用 tree-shaking 优化</li>
</ul>
<h4 data-id="heading-7">第三步：配置 TypeScript 类型</h4>
<p>创建 <code>app/types/styled-components-native.d.ts</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-string">'styled-components/native'</span>;

<span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">'styled-components/native'</span> {
  <span class="hljs-comment">// 主题模式类型</span>
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">ThemeModeType</span> = <span class="hljs-string">'dark'</span> | <span class="hljs-string">'light'</span>;

  <span class="hljs-comment">// 间距类型</span>
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">SpacingType</span> = {
    <span class="hljs-attr">xs</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">sm</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">md</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">lg</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">xl</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">xxl</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">screenPadding</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">cardPadding</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">inputPadding</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">negSm</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">negMd</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">negLg</span>: <span class="hljs-built_in">number</span>;
  };

  <span class="hljs-comment">// 字体类型</span>
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">FontSizeType</span> = {
    <span class="hljs-attr">xs</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">sm</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">base</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">lg</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">xl</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">xxl</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">xxxl</span>: <span class="hljs-built_in">number</span>;
  };

  <span class="hljs-keyword">type</span> <span class="hljs-title class_">FontWeightType</span> = {
    <span class="hljs-attr">regular</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">medium</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">semibold</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">bold</span>: <span class="hljs-built_in">number</span>;
  };

  <span class="hljs-keyword">type</span> <span class="hljs-title class_">TypographyType</span> = {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">FontSizeType</span>;
    <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeightType</span>;
  };

  <span class="hljs-comment">// 颜色类型</span>
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">ColorsType</span> = {
    <span class="hljs-attr">primary</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">secondary</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">background</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">textWhite</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">success</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">warning</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">error</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">info</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">border</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">overlay</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">transparent</span>: <span class="hljs-built_in">string</span>;
  };

  <span class="hljs-comment">// 主题接口</span>
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DefaultTheme</span> {
    <span class="hljs-attr">mode</span>: <span class="hljs-title class_">ThemeModeType</span>;
    <span class="hljs-attr">colors</span>: <span class="hljs-title class_">ColorsType</span>;
    <span class="hljs-attr">spacing</span>: <span class="hljs-title class_">SpacingType</span>;
    <span class="hljs-attr">typography</span>: <span class="hljs-title class_">TypographyType</span>;
  }
}
</code></pre>
<h4 data-id="heading-8">第四步：配置路径别名</h4>
<p>更新 <code>babel.config.js</code> 和 <code>tsconfig.json</code> 中的别名配置：</p>
<p><strong>babel.config.js</strong>：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">plugins</span>: [
    [
      <span class="hljs-string">'module-resolver'</span>,
      {
        <span class="hljs-attr">root</span>: [<span class="hljs-string">'./app'</span>],
        <span class="hljs-attr">alias</span>: {
          <span class="hljs-string">'@'</span>: <span class="hljs-string">'./app'</span>,
          <span class="hljs-string">'@providers'</span>: <span class="hljs-string">'./app/providers'</span>,
          <span class="hljs-comment">// ... 其他别名</span>
        },
      },
    ],
  ],
};
</code></pre>
<p><strong>tsconfig.json</strong>：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"paths"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"@providers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"app/providers"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"@providers/*"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"app/providers/*"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-9">第五步：创建主题系统</h4>
<h5 data-id="heading-10">1. 主题结构</h5>
<p>创建以下文件结构：</p>
<pre><code class="hljs language-bash" lang="bash">app/styles/theme/
├── custom/
│   ├── spacing.ts      <span class="hljs-comment"># 间距系统</span>
│   └── typography.ts   <span class="hljs-comment"># 字体系统</span>
├── dark/
│   └── index.ts        <span class="hljs-comment"># 深色主题颜色</span>
├── light/
│   └── index.ts        <span class="hljs-comment"># 浅色主题颜色</span>
└── index.tsx           <span class="hljs-comment"># 主题生成器</span>
</code></pre>
<h5 data-id="heading-11">2. 定义间距系统</h5>
<p><code>app/styles/theme/custom/spacing.ts</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> spacing = {
  <span class="hljs-comment">// 基础间距（4px 基准）</span>
  <span class="hljs-attr">xs</span>: <span class="hljs-number">4</span>,
  <span class="hljs-attr">sm</span>: <span class="hljs-number">8</span>,
  <span class="hljs-attr">md</span>: <span class="hljs-number">16</span>,
  <span class="hljs-attr">lg</span>: <span class="hljs-number">24</span>,
  <span class="hljs-attr">xl</span>: <span class="hljs-number">32</span>,
  <span class="hljs-attr">xxl</span>: <span class="hljs-number">48</span>,

  <span class="hljs-comment">// 特殊间距</span>
  <span class="hljs-attr">screenPadding</span>: <span class="hljs-number">16</span>,
  <span class="hljs-attr">cardPadding</span>: <span class="hljs-number">16</span>,
  <span class="hljs-attr">inputPadding</span>: <span class="hljs-number">12</span>,

  <span class="hljs-comment">// 负间距</span>
  <span class="hljs-attr">negSm</span>: -<span class="hljs-number">8</span>,
  <span class="hljs-attr">negMd</span>: -<span class="hljs-number">16</span>,
  <span class="hljs-attr">negLg</span>: -<span class="hljs-number">24</span>,
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">Spacing</span> = <span class="hljs-keyword">typeof</span> spacing;
</code></pre>
<h5 data-id="heading-12">3. 定义字体系统</h5>
<p><code>app/styles/theme/custom/typography.ts</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> typography = {
  <span class="hljs-attr">fontSize</span>: {
    <span class="hljs-attr">xs</span>: <span class="hljs-number">12</span>,
    <span class="hljs-attr">sm</span>: <span class="hljs-number">14</span>,
    <span class="hljs-attr">base</span>: <span class="hljs-number">16</span>,
    <span class="hljs-attr">lg</span>: <span class="hljs-number">18</span>,
    <span class="hljs-attr">xl</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">xxl</span>: <span class="hljs-number">24</span>,
    <span class="hljs-attr">xxxl</span>: <span class="hljs-number">32</span>,
  },
  <span class="hljs-attr">fontWeight</span>: {
    <span class="hljs-attr">regular</span>: <span class="hljs-number">400</span>,
    <span class="hljs-attr">medium</span>: <span class="hljs-number">500</span>,
    <span class="hljs-attr">semibold</span>: <span class="hljs-number">600</span>,
    <span class="hljs-attr">bold</span>: <span class="hljs-number">700</span>,
  },
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">Typography</span> = <span class="hljs-keyword">typeof</span> typography;
</code></pre>
<h5 data-id="heading-13">4. 定义颜色</h5>
<p><code>app/styles/theme/light/index.ts</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ColorsType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"styled-components/native"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">colors</span>: <span class="hljs-title class_">ColorsType</span> = {
  <span class="hljs-attr">primary</span>: <span class="hljs-string">'#007AFF'</span>,
  <span class="hljs-attr">secondary</span>: <span class="hljs-string">'#5856D6'</span>,
  <span class="hljs-attr">background</span>: <span class="hljs-string">'#FFFFFF'</span>,
  <span class="hljs-attr">text</span>: <span class="hljs-string">'#000000'</span>,
  <span class="hljs-attr">textWhite</span>: <span class="hljs-string">'#FFFFFF'</span>,
  <span class="hljs-attr">success</span>: <span class="hljs-string">'#34C759'</span>,
  <span class="hljs-attr">warning</span>: <span class="hljs-string">'#FF9500'</span>,
  <span class="hljs-attr">error</span>: <span class="hljs-string">'#FF3B30'</span>,
  <span class="hljs-attr">info</span>: <span class="hljs-string">'#5AC8FA'</span>,
  <span class="hljs-attr">border</span>: <span class="hljs-string">'#C6C6C8'</span>,
  <span class="hljs-attr">overlay</span>: <span class="hljs-string">'rgba(0, 0, 0, 0.5)'</span>,
  <span class="hljs-attr">transparent</span>: <span class="hljs-string">'transparent'</span>
};

<span class="hljs-keyword">export</span> { colors };
</code></pre>
<p><code>app/styles/theme/dark/index.ts</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ColorsType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"styled-components/native"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">colors</span>: <span class="hljs-title class_">ColorsType</span> = {
  <span class="hljs-attr">primary</span>: <span class="hljs-string">'#0A84FF'</span>,
  <span class="hljs-attr">secondary</span>: <span class="hljs-string">'#5E5CE6'</span>,
  <span class="hljs-attr">background</span>: <span class="hljs-string">'#121212'</span>,
  <span class="hljs-attr">text</span>: <span class="hljs-string">'#FFFFFF'</span>,
  <span class="hljs-attr">textWhite</span>: <span class="hljs-string">'#FFFFFF'</span>,
  <span class="hljs-attr">success</span>: <span class="hljs-string">'#32D74B'</span>,
  <span class="hljs-attr">warning</span>: <span class="hljs-string">'#FF9F0A'</span>,
  <span class="hljs-attr">error</span>: <span class="hljs-string">'#FF453A'</span>,
  <span class="hljs-attr">info</span>: <span class="hljs-string">'#64D2FF'</span>,
  <span class="hljs-attr">border</span>: <span class="hljs-string">'#3A3A3C'</span>,
  <span class="hljs-attr">overlay</span>: <span class="hljs-string">'rgba(0, 0, 0, 0.7)'</span>,
  <span class="hljs-attr">transparent</span>: <span class="hljs-string">'transparent'</span>
};

<span class="hljs-keyword">export</span> { colors };
</code></pre>
<h5 data-id="heading-14">5. 创建主题生成器</h5>
<p><code>app/styles/theme/index.tsx</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">DefaultTheme</span>, <span class="hljs-title class_">ThemeModeType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'styled-components/native'</span>;
<span class="hljs-keyword">import</span> { colors <span class="hljs-keyword">as</span> darkColor } <span class="hljs-keyword">from</span> <span class="hljs-string">'./dark'</span>;
<span class="hljs-keyword">import</span> { colors <span class="hljs-keyword">as</span> lightColor } <span class="hljs-keyword">from</span> <span class="hljs-string">'./light'</span>;
<span class="hljs-keyword">import</span> { spacing } <span class="hljs-keyword">from</span> <span class="hljs-string">'./custom/spacing'</span>;
<span class="hljs-keyword">import</span> { typography } <span class="hljs-keyword">from</span> <span class="hljs-string">'./custom/typography'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">getTheme</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">type</span>: ThemeModeType</span>) =&gt;</span> <span class="hljs-title class_">DefaultTheme</span> = <span class="hljs-function"><span class="hljs-params">type</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> theme = <span class="hljs-keyword">type</span> === <span class="hljs-string">'dark'</span> ? darkColor : lightColor;
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">mode</span>: <span class="hljs-keyword">type</span>,
    spacing,
    typography,
    <span class="hljs-attr">colors</span>: theme,
  };
};

<span class="hljs-keyword">export</span> { getTheme };
</code></pre>
<h4 data-id="heading-15">第六步：创建 ThemeProvider</h4>
<p><code>app/providers/ThemeProvider/index.tsx</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { getTheme } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/styles'</span>;
<span class="hljs-keyword">import</span> { createContext, <span class="hljs-title class_">PropsWithChildren</span>, useCallback, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useColorScheme } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;
<span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">DefaultTheme</span>,
  <span class="hljs-title class_">ThemeModeType</span>,
  <span class="hljs-title class_">ThemeProvider</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">StyledThemeProvider</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'styled-components/native'</span>;

<span class="hljs-comment">// Context 类型定义</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">ContextProps</span> = {
  <span class="hljs-attr">mode</span>: <span class="hljs-title class_">ThemeModeType</span>;
  <span class="hljs-attr">theme</span>: <span class="hljs-title class_">DefaultTheme</span>;
  <span class="hljs-attr">toggleTheme</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
};

<span class="hljs-comment">// 默认主题</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">defaultTheme</span>: <span class="hljs-title class_">ContextProps</span> = {
  <span class="hljs-attr">mode</span>: <span class="hljs-string">'light'</span>,
  <span class="hljs-attr">theme</span>: <span class="hljs-title function_">getTheme</span>(<span class="hljs-string">'light'</span>),
  <span class="hljs-attr">toggleTheme</span>: <span class="hljs-function">() =&gt;</span> {},
};

<span class="hljs-comment">// 创建 Context</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = createContext&lt;<span class="hljs-title class_">ContextProps</span>&gt;(defaultTheme);

<span class="hljs-comment">// ThemeProvider 组件</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">ThemeProvider</span> = (<span class="hljs-params">{ children }: PropsWithChildren</span>) =&gt; {
  <span class="hljs-keyword">const</span> isDarkMode = <span class="hljs-title function_">useColorScheme</span>() === <span class="hljs-string">'dark'</span>;
  <span class="hljs-keyword">const</span> [mode, setMode] = useState&lt;<span class="hljs-title class_">ThemeModeType</span>&gt;(isDarkMode ? <span class="hljs-string">'dark'</span> : <span class="hljs-string">'light'</span>);

  <span class="hljs-comment">// 切换主题函数</span>
  <span class="hljs-keyword">const</span> toggleTheme = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setMode</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> (prev === <span class="hljs-string">'light'</span> ? <span class="hljs-string">'dark'</span> : <span class="hljs-string">'light'</span>));
  }, []);

  <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">getTheme</span>(mode);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">mode</span>, <span class="hljs-attr">theme</span>, <span class="hljs-attr">toggleTheme</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">StyledThemeProvider</span> <span class="hljs-attr">theme</span>=<span class="hljs-string">{theme}</span>&gt;</span>
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">StyledThemeProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  );
};
</code></pre>
<p><code>app/providers/index.ts</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> { <span class="hljs-title class_">ThemeContext</span>, <span class="hljs-title class_">ThemeProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ThemeProvider'</span>;
</code></pre>
<h4 data-id="heading-16">第七步：导出样式系统</h4>
<p><code>app/styles/index.ts</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 主题 Design Tokens</span>
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./theme'</span>;

<span class="hljs-comment">// 通用样式</span>
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./common'</span>;
</code></pre>
<h4 data-id="heading-17">第八步：验证配置</h4>
<p>创建一个测试组件 <code>app/index.tsx</code>：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> styled <span class="hljs-keyword">from</span> <span class="hljs-string">'styled-components/native'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ThemeProvider</span>, <span class="hljs-title class_">ThemeContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@providers'</span>;
<span class="hljs-keyword">import</span> { useContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Container</span> = styled.<span class="hljs-property">View</span><span class="hljs-string">`
  padding: <span class="hljs-subst">${props =&gt; props.theme.spacing.md}</span>px;
  background-color: <span class="hljs-subst">${props =&gt; props.theme.colors.background}</span>;
`</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Title</span> = styled.<span class="hljs-property">Text</span><span class="hljs-string">`
  font-size: <span class="hljs-subst">${props =&gt; props.theme.typography.fontSize.xl}</span>px;
  font-weight: <span class="hljs-subst">${props =&gt; props.theme.typography.fontWeight.bold}</span>;
  color: <span class="hljs-subst">${props =&gt; props.theme.colors.text}</span>;
`</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Button</span> = styled.<span class="hljs-property">TouchableOpacity</span><span class="hljs-string">`
  background-color: <span class="hljs-subst">${props =&gt; props.theme.colors.primary}</span>;
  padding: <span class="hljs-subst">${props =&gt; props.theme.spacing.md}</span>px;
  border-radius: 8px;
  margin-top: <span class="hljs-subst">${props =&gt; props.theme.spacing.md}</span>px;
`</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">ButtonText</span> = styled.<span class="hljs-property">Text</span><span class="hljs-string">`
  color: <span class="hljs-subst">${props =&gt; props.theme.colors.textWhite}</span>;
  text-align: center;
`</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AppContent</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeProvider</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">AppContent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { toggleTheme, mode } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Container</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Title</span>&gt;</span>Styled Components 配置成功！<span class="hljs-tag">&lt;/<span class="hljs-name">Title</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Title</span>&gt;</span>当前主题: {mode}<span class="hljs-tag">&lt;/<span class="hljs-name">Title</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{toggleTheme}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ButtonText</span>&gt;</span>切换主题<span class="hljs-tag">&lt;/<span class="hljs-name">ButtonText</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Container</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<h4 data-id="heading-18">第九步：重新构建</h4>
<p>配置完成后，必须重新构建应用：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 清理缓存并重启</span>
yarn start --reset-cache

<span class="hljs-comment"># 或者重新构建</span>
<span class="hljs-comment"># iOS</span>
yarn ios

<span class="hljs-comment"># Android</span>
yarn android
</code></pre>
<h3 data-id="heading-19">配置检查清单</h3>
<ul>
<li>✅ 安装了 <code>styled-components</code></li>
<li>✅ 安装了 <code>@types/styled-components</code></li>
<li>✅ 安装了 <code>babel-plugin-styled-components</code></li>
<li>✅ 配置了 <code>babel.config.js</code></li>
<li>✅ 创建了类型定义文件</li>
<li>✅ 配置了路径别名（<code>@providers</code>）</li>
<li>✅ 创建了主题文件结构</li>
<li>✅ 定义了间距系统</li>
<li>✅ 定义了字体系统</li>
<li>✅ 定义了颜色（深色/浅色）</li>
<li>✅ 创建了主题生成器</li>
<li>✅ 创建了 ThemeProvider</li>
<li>✅ 导出了样式系统</li>
<li>✅ 重新构建了应用</li>
</ul>
<h3 data-id="heading-20">常见配置问题</h3>
<h4 data-id="heading-21">1. TypeScript 类型错误</h4>
<p><strong>问题</strong>：<code>props.theme</code> 报类型错误</p>
<p><strong>解决</strong>：</p>
<ul>
<li>确保 <code>app/types/styled-components-native.d.ts</code> 文件存在</li>
<li>确保 <code>DefaultTheme</code> 接口定义了所有需要的字段</li>
<li>重启 TypeScript 服务器（VSCode 中 Cmd+Shift+P -&gt; "Restart TS Server"）</li>
</ul>
<h4 data-id="heading-22">2. 主题切换不生效</h4>
<p><strong>问题</strong>：点击切换主题，样式不变</p>
<p><strong>检查</strong>：</p>
<ol>
<li>组件是否在 <code>ThemeProvider</code> 内部？</li>
<li>是否使用了 <code>props.theme.colors.xxx</code> 而不是硬编码颜色值？</li>
<li>是否重新构建了应用？</li>
</ol>
<h4 data-id="heading-23">3. Babel 配置不生效</h4>
<p><strong>解决</strong>：</p>
<ol>
<li>清理缓存：<code>yarn start --reset-cache</code></li>
<li>检查 <code>babel.config.js</code> 语法</li>
<li>重启 Metro bundler</li>
</ol>
<h4 data-id="heading-24">4. 找不到模块 '@providers'</h4>
<p><strong>解决</strong>：</p>
<ol>
<li>检查 <code>babel.config.js</code> 和 <code>tsconfig.json</code> 别名配置</li>
<li>确保路径正确：<code>'./app/providers'</code></li>
<li>重启 TS 服务器</li>
</ol>
<h3 data-id="heading-25">参考资源</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fstyled-components.com%2Fdocs" target="_blank" title="https://styled-components.com/docs" ref="nofollow noopener noreferrer">Styled Components 官方文档</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Freactnative.dev%2Fdocs%2Fstyle" target="_blank" title="https://reactnative.dev/docs/style" ref="nofollow noopener noreferrer">React Native 文档</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fstyled-components.com%2Fdocs%2Fapi%23typescript" target="_blank" title="https://styled-components.com/docs/api#typescript" ref="nofollow noopener noreferrer">TypeScript 类型定义</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[从spec-kit看spec-driven coding及在后台管理开发的实践]]></title>    <link>https://juejin.cn/post/7598574507347460131</link>    <guid>https://juejin.cn/post/7598574507347460131</guid>    <pubDate>2026-01-25T07:18:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598574507347460131" data-draft-id="7598588085597077544" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="从spec-kit看spec-driven coding及在后台管理开发的实践"/> <meta itemprop="keywords" content="AI编程"/> <meta itemprop="datePublished" content="2026-01-25T07:18:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="用户8048714355625"/> <meta itemprop="url" content="https://juejin.cn/user/2870164321471837"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            从spec-kit看spec-driven coding及在后台管理开发的实践
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2870164321471837/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    用户8048714355625
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-25T07:18:59.000Z" title="Sun Jan 25 2026 07:18:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">什么是spec-driven coding</h2>
<p>我们正常的开发流程中，撰写产品需求文档（PRD）来指导开发，创建设计文档来告知实现细节，然后进行代码开发。</p>
<p>规范驱动开发（SDD）模拟了这一流程，但在SDD中，产品需求文档（PRD）不再是实现的指南，而是生成实现的源头。技术方案不再是指导编码的文档，而是生成代码的精确定义。因为现在AI能够理解和实现复杂的规范，并创建详细的实现方案。但没有结构的过程会让AI生成会产生混乱。SDD通过精确、完整且足够明确的规范，足以生成可运行的系统。</p>
<p>开发团队的意图通过自然语言可以生成相应的规范，代码只是最后一公里的实现方式。</p>
<h2 data-id="heading-1">spec-kit原理简介</h2>
<p>spec-kit仓库地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgithub%2Fspec-kit" target="_blank" title="https://github.com/github/spec-kit" ref="nofollow noopener noreferrer">github.com/github/spec…</a> (安装可以参考这个地址)</p>
<p>从上面的地址可以看到，spec-kit通过一系列自定义slash command来生成对应的规范文件，最终根据这些规范文件生成代码</p>








































<table><thead><tr><th>顺序</th><th>Slash command</th><th>作用</th></tr></thead><tbody><tr><td>1</td><td>/speckit.constitution(如有则不需要执行)</td><td>生成项目规范</td></tr><tr><td>2</td><td>/speckit.specify</td><td>生成需求文档</td></tr><tr><td>3</td><td>/speckit.clarify (可选)</td><td>让AI识别可能需要澄清的最重要的5个问题</td></tr><tr><td>4</td><td>/speckit.plan</td><td>生成设计文档</td></tr><tr><td>5</td><td>/speckit.task</td><td>生成实施任务文档</td></tr><tr><td>6</td><td>/speckit.implement</td><td>实施代码</td></tr></tbody></table>
<p>这些自定义的 slash command 其实是利用了vscode copilot的自定义prompt文件，参考：<a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.visualstudio.com%2Fdocs%2Fcopilot%2Fcustomization%2Fprompt-files%25E3%2580%2582" target="_blank" title="https://code.visualstudio.com/docs/copilot/customization/prompt-files%E3%80%82" ref="nofollow noopener noreferrer">code.visualstudio.com/docs/copilo…</a></p>
<p>执行 slash command命令实际上是将 .github/prompts/${命令}.prompt.md 的提示词及相关设置发给AI。比如</p>
<p>执行/speckit.constitution命令，实际上是让AI遵循 .github/prompts/speckit.constitution.prompt.md。</p>
<p>因此，实际上执行的每一个命令就是依据作者的思想，通过作者预置的提示词与AI交流，按照流程生成对应的规范文件，最终利用这些规范文件来指导AI写出符合要求的代码。通过这样一步步的规范，提高AI写出“好的”代码的概率。如果你有自己的一套开发规范，那么你也可以有自己的spec-driven development流程，写一个自己的spec-kit！</p>
<h2 data-id="heading-2">用spec-kit实践一个后台管理需求</h2>
<h3 data-id="heading-3">要做的是什么？</h3>
<p>实际查看：<a href="https://link.juejin.cn?target=https%3A%2F%2Fc-ai-admin.xiaopeng.com%2F%23%2Fai%2Fentry" target="_blank" title="https://c-ai-admin.xiaopeng.com/#/ai/entry" ref="nofollow noopener noreferrer">c-ai-admin.xiaopeng.com/#/ai/entry</a></p>
<p>这是一个常见的后台管理新增tab需求，包含列表查看、搜索，编辑、新增、复制、删除的功能。弹窗中，选择场景热门问题由全部配置中而来。</p>
<h3 data-id="heading-4">怎么做？</h3>
<p>接下来，我们就按照spec-kit的流程来实现这个需求。</p>
<h4 data-id="heading-5">/speckit.constitution 生成项目规范</h4>
<p>项目是第一次用spec-kit来进行spec-driven coding，因此需要先生成项目规范文件 .specify/memory/constitution.md，这个文件在后续的流程中都会用到，是非常重要的。</p>
<p>生成这个文件的时候，会参考工作区内的README.md, <code>docs/quickstart.md</code>，prompt输入，之前的constitution.md，仓库上下文等等……。因此，我们在这之前补充一些我们期望的项目规范信息是非常必要的，当然，你可以让AI帮你生成，你需要review一下生成的内容，并且补充一些必要的规范。</p>
<p>在这里我生成好了一份README.md【字数限制不放上来了】</p>
<p>同时，我希望在项目规范里面增加一些vue2的 best practice。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a00a8bcb03b840a5a29b0898e91c460f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=Lxk61xut4nzSO4QQ37W3wn7RBUM%3D" alt="" loading="lazy"/></p>
<p>生成的的规范我们需要review一下是否满足要求，如果还有别的要求，可以继续通过命令+要求去更新。</p>
<p>最终的.specify/memory/constitution.md【字数限制不放上来了】</p>
<blockquote>
<p>Tips: 如果下次开发已经存在了.specify/memory/constitution.md，那么就不需要再次重新生成。但我们在上次开发时发现的一些AI容易误解或者遗漏的地方，我们可以重新更新到.specify/memory/constitution.md，来更好地指导AI。</p>
</blockquote>
<h4 data-id="heading-6">/speckit.specify 生成需求文档</h4>
<p>这个阶段prompt一定要详细描述清楚你要做什么，这要求我们先要缕清产品的需求。要求产品把需求文档写清楚可以减少我们很多工作量，然后我们稍作整理就可以。</p>
<p>在这个阶段，重点在what和why，而不是how，不要涉及到技术相关的描述</p>
<p>我们先整理prompt，将prompt整理到一个feature.md文件中【字数限制不放上来了】。</p>
<p>开始生成需求文档</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f067c5673cf642bebec2e4261c26eef2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=Q5HvwcvbSrAHbtKbuaiyp7jjJbs%3D" alt="" loading="lazy"/></p>
<p>生成的的规范我们需要review一下是否满足要求，如果还有别的要求，可以继续通过命令+要求去更新。</p>
<p>最终的需求文档：specs\002-scenario-config\spec.md【字数限制不放上来了】。</p>
<h4 data-id="heading-7">/speckit.clarify (可选) 澄清不清楚的问题</h4>
<p>我们可以看到，上面生成的 specs\002-scenario-config\spec.md 里面有个 <strong>Edge Cases</strong> 板块，里面列举了一些边界情况，大部分是一些影响细节交互的问题，如果你希望做出来的系统更加人性化，可以使用 /speckit.clarify 帮你列出AI认为的最需要澄清的5个问题，并给出建议，同时会帮你写回到spec.md中。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4370b2b12d6c45e7bc20ec70ddefa875~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=Tr0P2p%2B56thR0vxmFUq1vjA4Ub0%3D" alt="" loading="lazy"/></p>
<p>执行命令后</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62a29db83a8a4baa8614426e8fa07990~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=DAWaShDplGYlNLdub8zUYEeXu8I%3D" alt="" loading="lazy"/></p>
<p>交互式澄清5个问题并更新到spec.md中，按照你想要的答案选择选项或者输入新的解决办法。</p>
<h4 data-id="heading-8">/speckit.plan 生成概要设计</h4>
<p>这一步在我们要着重在如何实现它，重点在how，因此需要将足够的实现信息给AI，如后端接口文档，这样AI可以帮我们做准确合适的概要设计。</p>
<p>我这个需求里，我从后端提供的接口信息（最好让后端的概要设计做详细，包含接口的各种信息），整理了一份后端接口文档：可以看到，后端没有提供响应数据格式，因此后续字段对接这块可能会存在一些问题。</p>
<p>执行 /speckit.plan</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/859abe008bb24977bb4cd4f495646235~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=YwiSmpQf7RFZ0rCbi9h8MOSPyL4%3D" alt="" loading="lazy"/></p>
<p>生成了以下文件：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad85eb99c0d14dc385e5070cd8fb80e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=ZK%2FZysqQGw56f1QvluqJGsgJqEY%3D" alt="" loading="lazy"/></p>
<p>在这里，我们主要review plan.md，里面可能有一些需要确认的事项，根据需要进行删减更改。前面有提到我们提供的后端接口信息文档没有提供响应数据格式，但在contracts/api-endpoints.md文件中可以看到，AI自动根据我们提供的接口请求参数信息补充了接口返回信息！还是挺聪明的。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e4463f2596f45ed8f5016ebbb9472e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=esMSiKErcQzh0%2BIhDUcxw%2FhgEhY%3D" alt="" loading="lazy"/></p>
<p>最终的plan.md【字数限制不放上来了】</p>
<h4 data-id="heading-9">/speckit.task 生成任务</h4>
<p>生成分阶段的、独立的任务，汇总到 <code>tasks.md</code></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c6f6e0d42e54c3280bd910310d25867~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=JM8W4%2B7clUhQOaTWxtqG11j5ih0%3D" alt="" loading="lazy"/></p>
<p>可以看到，这一步将我们要实现的需求分为了7个阶段，并按增量的形式划分为了4个执行期，非常清晰。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f176c6aa30134a14bafa9e7278476c6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=9OUTsxkTWaNNjwDWaFpXwZ%2B6vq8%3D" alt="" loading="lazy"/></p>
<p>终版task.md【字数限制不放上来了】</p>
<h3 data-id="heading-10">结果怎么样？</h3>
<p>我总结了一下：</p>
<ul>
<li>代码生成效果不错，90%以上的代码可用</li>
<li>逻辑部分几乎完全没问题，阻碍流程的地方几乎都是上下文错误或者上下文不够完全，AI偶尔有幻觉，见上表问题7</li>
<li>一些UI问题，UI交互优化通过AI能非常快速地修复</li>
</ul>
<h3 data-id="heading-11">有什么心得？</h3>
<ul>
<li>
<p>后台管理重简单逻辑、轻UI，这种类型的开发任务非常适合spec-driven development流程来开发</p>
</li>
<li>
<p>提供的需求上下文，接口上下文信息越准确，越完善，生成的代码质量越高</p>
</li>
<li>
<p>AI偶尔会出现幻觉，但从上面的例子来看，是可接受的范围内</p>
</li>
<li>
<p>我们可以采用sDd开发+手动测试的方式，发现的问题可以通过人工+AI排查的方式来修复，其中轻UI的修复可以全部交给AI来做，逻辑部分AI+人工的方式更加高效</p>
</li>
<li>
<p>修复问题阶段最优模式是：</p>
<ul>
<li>新建一个chat(而不是在原来的sdd开发chat上，上下文过长，影响生成效率)</li>
<li>采用edit方式(agent方式适合高难度的任务，会搜集各种信息，时间长)，效率更高，且可以直接编辑文件。edit模式下给出的上下文越准确，AI修复问题越准确。</li>
</ul>
</li>
<li>
<p>当对某次修改不满意时，利用chat的restore Checkpoint功能会非常方便，点击restore Checkpoint，AI会回撤这次的所有更改。这样你就可以在上次更改的基础上重新更改。</p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09082caa9b324f0dbe04c0aedc0aae41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=7fdXO2fRiPV80VFDMr3Hnxoi8ds%3D" alt="" loading="lazy"/></p>
<p>或者直接点击问题进入编辑模式，和上面的效果也是一样的</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b5dd33cd71343738fe6b0c8273cb05d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODA0ODcxNDM1NTYyNQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769930338&amp;x-signature=BskwvhlEX%2BHvIcSHaRsrp9pREwA%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[云原生 Profiling：零侵入、随用随取的动态采集实战]]></title>    <link>https://juejin.cn/post/7599474528239042600</link>    <guid>https://juejin.cn/post/7599474528239042600</guid>    <pubDate>2026-01-26T10:26:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599474528239042600" data-draft-id="7599220371666337832" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="云原生 Profiling：零侵入、随用随取的动态采集实战"/> <meta itemprop="keywords" content="监控,云原生"/> <meta itemprop="datePublished" content="2026-01-26T10:26:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="可观测性用观测云"/> <meta itemprop="url" content="https://juejin.cn/user/2392958212523102"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            云原生 Profiling：零侵入、随用随取的动态采集实战
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2392958212523102/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    可观测性用观测云
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:26:17.000Z" title="Mon Jan 26 2026 10:26:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">背景</h2>
<p>应用在运行过程中，开启性能分析（Profiling）通常是诊断性能瓶颈、内存泄漏和线程问题的关键手段。然而，持续开启 Profiling 会带来显著的性能开销（可能达 5%-20%），并可能生成大量数据，影响生产环境稳定性。动态开启 Profiling 允许开发或运维人员按需、实时地启动/停止数据收集，实现以下目标：</p>
<ol>
<li>降低持续开销：仅在需要时启用，避免长期性能损耗；</li>
<li>精准问题定位：针对特定时段（如流量高峰或故障期间）进行分析；</li>
<li>在线诊断：无需重启应用即可获取生产环境实时性能快照；</li>
<li>灵活控制：可结合监控指标（如 CPU 飙升）自动触发，或在安全审计时手动开启。</li>
</ol>
<p>通过动态控制，实现了观测能力与系统负载的平衡，保障了关键业务场景的效率和稳定性。</p>
<h2 data-id="heading-1">Flameshot</h2>
<p>Flameshot 是一个基于 Sidecar 模式运行的轻量级自动性能剖析（Profiling）工具。它通过监控目标进程的资源使用情况（CPU/内存），在达到预设阈值时自动触发底层 Profiler（如 <code>async-profiler</code> ），从而实现无侵入的现场快照采集。</p>
<p>Flameshot 采用 Sidecar 容器 模式部署。它必须与业务主容器（Main Container）运行在同一个 Pod 中，并开启 PID 命名空间共享。</p>
<ol>
<li>监控 (Monitor)：Flameshot 持续轮询主容器内目标进程的资源水位。</li>
<li>触发 (Trigger)：当满足阈值（如 CPU &gt; 80%）或收到 HTTP API 请求时，触发采集任务。</li>
<li>执行 (Execute)：根据配置的语言类型（目前支持 Java），调用对应的 Profiler 工具 attach 到目标进程。</li>
<li>收集 (Collect)：生成的 Profile 文件（如 <code>.jfr</code> ）存储于共享卷中，随后上传至数据观测中心。</li>
</ol>
<p>观测云 <code>datakit-operator</code> 从 <code>1.7.0</code> 版本开始支持工具 <code>flameshots</code>，实现动态开启应用 Profiling。</p>
<h2 data-id="heading-2">实践</h2>
<p>当前在 K8S 环境上部署 JAVA 应用，当 CPU、内存使用率达到 20%（演示方便）则触发 Profiling 数据采集。</p>
<h3 data-id="heading-3">前提条件</h3>
<ul>
<li>观测云帐号</li>
<li>K8S 环境</li>
</ul>
<h3 data-id="heading-4">DataKit</h3>
<p>DataKit 主要是用来采集数据并上报观测云。</p>
<h4 data-id="heading-5">1. 下载 &amp; 安装</h4>
<pre><code class="hljs language-arduino" lang="arduino">wget https:<span class="hljs-comment">//static.guance.com/datakit/datakit.yaml</span>
</code></pre>
<h4 data-id="heading-6">2. 配置 <code>datakit.yaml</code></h4>
<p>配置 DataWay 数据网关地址</p>
<pre><code class="hljs language-ini" lang="ini">name: ENV_DATAWAY
value: https://openway.guance.com?<span class="hljs-attr">token</span>=tkn_xxxxx
</code></pre>
<p>DataKit 会默认开启主机相关采集器，这里需要追加 <code>pyroscope</code></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">name: ENV_DEFAULT_ENABLED_INPUTS</span>
<span class="hljs-section">value: cpu,disk,diskio,mem,swap,system,hostobject,net,host_processes,container,pyroscope</span>
</code></pre>
<h4 data-id="heading-7">3. 启动</h4>
<p>调整完配置后，启动 DataKit</p>
<pre><code class="hljs language-ruby" lang="ruby">root<span class="hljs-variable">@root</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>kubectl apply -f datakit.yaml
root<span class="hljs-variable">@root</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>kubectl get pods -n datakit
<span class="hljs-variable constant_">NAME</span>                                <span class="hljs-variable constant_">READY</span>   <span class="hljs-variable constant_">STATUS</span>    <span class="hljs-variable constant_">RESTARTS</span>   <span class="hljs-variable constant_">AGE</span>
datakit-4zg7q                       <span class="hljs-number">1</span>/<span class="hljs-number">1</span>     <span class="hljs-title class_">Running</span>   <span class="hljs-number">0</span>          14h
datakit-wdtdq                       <span class="hljs-number">1</span>/<span class="hljs-number">1</span>     <span class="hljs-title class_">Running</span>   <span class="hljs-number">0</span>          14h
</code></pre>
<h3 data-id="heading-8">DataKit Operator</h3>
<h4 data-id="heading-9">1. 下载</h4>
<p>下载最新的 <code>datakit-operator.yaml</code></p>
<pre><code class="hljs language-vbnet" lang="vbnet">wget https://<span class="hljs-keyword">static</span>.guance.com/datakit-<span class="hljs-keyword">operator</span>/datakit-<span class="hljs-keyword">operator</span>.yaml
</code></pre>
<h4 data-id="heading-10">2. 配置 <code>datakit-operator.yaml</code></h4>
<p>主要调整 <code>jsonconfig</code> 下的 <code>flameshots</code> 内容，参考如下：</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">apiVersion: v1</span>
<span class="hljs-section">kind: ConfigMap</span>
<span class="hljs-section">metadata:</span>
  name: datakit-operator-config
  namespace: datakit
<span class="hljs-section">data:</span>
  jsonconfig: |-
    {
        <span class="hljs-string">"server_listen"</span>: <span class="hljs-string">"0.0.0.0:9543"</span>,
        <span class="hljs-string">"log_level"</span>:     <span class="hljs-string">"info"</span>,
        <span class="hljs-string">"admission_inject_v2"</span>: {
            ...
            <span class="hljs-string">"flameshots"</span>: [
                {
                    <span class="hljs-string">"namespace_selectors"</span>: [<span class="hljs-string">"default"</span>],
                    <span class="hljs-string">"label_selectors"</span>:     [],
                    <span class="hljs-string">"image"</span>: <span class="hljs-string">"pubrepo.jiagouyun.com/datakit/flameshot:0.1.1"</span>,
                    <span class="hljs-string">"envs"</span>: {
                        <span class="hljs-string">"FLAMESHOT_DATAKIT_ADDR"</span>:     <span class="hljs-string">"http://datakit-service.datakit.svc:9529/profiling/v1/input"</span>,
                        <span class="hljs-string">"FLAMESHOT_MONITOR_INTERVAL"</span>: <span class="hljs-string">"1s"</span>,
                        <span class="hljs-string">"FLAMESHOT_PROFILING_PATH"</span>:   <span class="hljs-string">"/flameshot-data"</span>,
                        <span class="hljs-string">"FLAMESHOT_HTTP_LOCAL_IP"</span>:    <span class="hljs-string">"{fieldRef:status.podIP}"</span>,
                        <span class="hljs-string">"FLAMESHOT_HTTP_LOCAL_PORT"</span>:  <span class="hljs-string">"8089"</span>,
                        <span class="hljs-string">"FLAMESHOT_SERVICE"</span>:          <span class="hljs-string">"{fieldRef:metadata.labels['app']}"</span>,
                        <span class="hljs-string">"POD_NAME"</span>:                <span class="hljs-string">"{fieldRef:metadata.name}"</span>,
                        <span class="hljs-string">"POD_NAMESPACE"</span>:           <span class="hljs-string">"{fieldRef:metadata.namespace}"</span>,
                        <span class="hljs-string">"NODE_NAME"</span>:               <span class="hljs-string">"{fieldRef:spec.nodeName}"</span>,
                        <span class="hljs-string">"FLAMESHOT_TAGS"</span>:          <span class="hljs-string">"pod_name:<span class="hljs-variable">$(POD_NAME)</span>,pod_namespace:<span class="hljs-variable">$(POD_NAMESPACE)</span>,host:<span class="hljs-variable">$(NODE_NAME)</span>"</span>
                        
                    },
                    <span class="hljs-string">"resources"</span>: {
                        <span class="hljs-string">"requests"</span>: {
                            <span class="hljs-string">"cpu"</span>:    <span class="hljs-string">"100m"</span>,
                            <span class="hljs-string">"memory"</span>: <span class="hljs-string">"128Mi"</span>
                        },
                        <span class="hljs-string">"limits"</span>: {
                           <span class="hljs-string">"cpu"</span>:    <span class="hljs-string">"200m"</span>,
                           <span class="hljs-string">"memory"</span>: <span class="hljs-string">"256Mi"</span>
                        }
                    },
                    <span class="hljs-string">"processes"</span>: <span class="hljs-string">"[{"</span>command<span class="hljs-string">":"</span>java<span class="hljs-string">","</span>duration<span class="hljs-string">":"</span>60s<span class="hljs-string">","</span>events<span class="hljs-string">":"</span>--all<span class="hljs-string">","</span>language<span class="hljs-string">":"</span>java<span class="hljs-string">","</span>jdk_version<span class="hljs-string">":"</span>-<span class="hljs-string">","</span>tags<span class="hljs-string">":["</span>env:testing<span class="hljs-string">","</span>version:1.0.0<span class="hljs-string">"],"</span>cpu_usage_percent<span class="hljs-string">":20,"</span>mem_usage_percent<span class="hljs-string">":20,"</span>mem_usage_mb<span class="hljs-string">":1024}]"</span>
                }
            ]
        },
        ...
    }
</code></pre>
<p>参数说明：</p>
<ul>
<li>namespace_selectors： 空间选择，即哪些空间需要开启 <code>flameshots</code></li>
<li>env: 配置环境变量信息</li>
<li>processes： 执行命令，如果为空，则 <code>flameshots</code> 不生效</li>
</ul>
<p>processes 通用字段说明：</p>
<ul>
<li><code>service</code> (String): 选填，上报到观测中心的服务名称。</li>
<li><code>language</code> (String): 目标进程语言。目前支持 java。</li>
<li><code>command</code> (String): 匹配进程命令行的正则表达式。</li>
<li><code>duration</code> (String): 单次采集时长（例如 <code>30s</code>，<code>1m</code>）。注意：受限于执行超时，建议不超过 5 分钟。</li>
<li><code>tags</code> (List): 自定义标签列表，建议包含 <code>env</code>，<code>version</code> 等元信息。</li>
<li><code>cpu_usage_percent</code> (Int): CPU 触发阈值 (0-N)。多核环境下数值可能超过 100。</li>
<li><code>mem_usage_percent</code> (Int): 内存使用率触发阈值 (0-100)。</li>
<li><code>mem_usage_mb</code> (Int): 内存使用量绝对值触发阈值 (MB)。</li>
</ul>
<p>当前配置 processes 可以实现所有 JAVA 服务，为了实践方便，当 cpu 使用率达到 20% 或内存使用率达到 20% 或内存使用值达到 1024m，则会触发执行 Profiling 操作。</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-string">"processes"</span>: <span class="hljs-string">"[{"</span><span class="hljs-built_in">command</span><span class="hljs-string">":"</span>java<span class="hljs-string">","</span>duration<span class="hljs-string">":"</span>60s<span class="hljs-string">","</span>events<span class="hljs-string">":"</span>--all<span class="hljs-string">","</span>language<span class="hljs-string">":"</span>java<span class="hljs-string">","</span>jdk_version<span class="hljs-string">":"</span>-<span class="hljs-string">","</span>tags<span class="hljs-string">":["</span><span class="hljs-built_in">env</span>:testing<span class="hljs-string">","</span>version:1.0.0<span class="hljs-string">"],"</span>cpu_usage_percent<span class="hljs-string">":20,"</span>mem_usage_percent<span class="hljs-string">":20,"</span>mem_usage_mb<span class="hljs-string">":1024}]"</span>
</code></pre>
<h4 data-id="heading-11">3. 启动</h4>
<pre><code class="hljs language-ruby" lang="ruby">root<span class="hljs-variable">@root</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>kubectl apply -f datakit-operator.yaml
root<span class="hljs-variable">@root</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>kubectl get pods -n datakit
<span class="hljs-variable constant_">NAME</span>                                <span class="hljs-variable constant_">READY</span>   <span class="hljs-variable constant_">STATUS</span>    <span class="hljs-variable constant_">RESTARTS</span>   <span class="hljs-variable constant_">AGE</span>
datakit-4zg7q                       <span class="hljs-number">1</span>/<span class="hljs-number">1</span>     <span class="hljs-title class_">Running</span>   <span class="hljs-number">0</span>          15h
datakit-operator-849f868b78-zbcd9   <span class="hljs-number">1</span>/<span class="hljs-number">1</span>     <span class="hljs-title class_">Running</span>   <span class="hljs-number">0</span>          58s
datakit-wdtdq                       <span class="hljs-number">1</span>/<span class="hljs-number">1</span>     <span class="hljs-title class_">Running</span>   <span class="hljs-number">0</span>          15h
</code></pre>
<h3 data-id="heading-12">JAVA 应用</h3>
<h4 data-id="heading-13">1. Yaml 配置</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">springboot-server</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">springboot-server</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">springboot-server</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">registry.cn-shenzhen.aliyuncs.com/lr_715377484/springboot-server:flameshots</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">springboot-server</span>
          <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">IfNotPresent</span>
          <span class="hljs-attr">ports:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span>  <span class="hljs-number">8080</span>
              <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>

          <span class="hljs-attr">securityContext:</span>
            <span class="hljs-attr">seccompProfile:</span>
              <span class="hljs-attr">type:</span> <span class="hljs-string">Unconfined</span>
</code></pre>
<h4 data-id="heading-14">2. 启动应用</h4>
<pre><code class="hljs language-ruby" lang="ruby">root<span class="hljs-variable">@root</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span> kubectl apply -f springboot-server.yaml
root<span class="hljs-variable">@root</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>kubectl get pods
<span class="hljs-variable constant_">NAME</span>                                <span class="hljs-variable constant_">READY</span>   <span class="hljs-variable constant_">STATUS</span>    <span class="hljs-variable constant_">RESTARTS</span>   <span class="hljs-variable constant_">AGE</span>
springboot-server-d55fc79dd-48c95   <span class="hljs-number">2</span>/<span class="hljs-number">2</span>     <span class="hljs-title class_">Running</span>   <span class="hljs-number">0</span>          3s
</code></pre>
<h4 data-id="heading-15">3. 查看 <code>flameshot</code> 执行日志</h4>
<p>需要指定 containerName 为 <code>-c datakit-flameshot</code></p>
<pre><code class="hljs language-bash" lang="bash">root@root:~$ kubectl logs -f springboot-server-d55fc79dd-48c95 -c datakit-flameshot
2026-01-15T03:55:58.090Z        ERROR        flameshot        flameshot/config.go:243        <span class="hljs-built_in">read</span> config file failed, err:open /flameshot/flameshot.conf: no such file or directory
2026-01-15T03:55:58.092Z        INFO        flameshot        flameshot/monitor.go:78        start monitor, interval: 1s
2026-01-15T03:55:58.092Z        INFO        flameshot        flameshot/http.go:77        start http server on 10.187.217.101:8089
2026-01-15T03:55:58.092Z        INFO        flameshot        flameshot/http.go:78        profile start at /v1/profile
2026-01-15T03:55:58.092Z        INFO        flameshot        flameshot/http.go:79        prom http start at /metrics
2026-01-15T03:56:58.093Z        INFO        flameshot        flameshot/monitor.go:102        match: PID=7, name=java or cmd=java -jar app.jar
</code></pre>
<p>从启动日志上分析，已经找到了 java 服务，且 PID 为 7，等待触发事件</p>
<h4 data-id="heading-16">4. 触发阈值</h4>
<p>访问应用</p>
<pre><code class="hljs language-perl" lang="perl">root@root:~$ kubectl <span class="hljs-keyword">exec</span> -it springboot-server-d55fc79dd-<span class="hljs-number">48</span>c95  -- <span class="hljs-regexp">/bin/</span>bash 
Defaulted container <span class="hljs-string">"springboot-server"</span> out of: springboot-server, datakit-flameshot
springboot-server-d55fc79dd-<span class="hljs-number">48</span>c95:<span class="hljs-regexp">/home/app</span><span class="hljs-comment">#</span>
springboot-server-d55fc79dd-<span class="hljs-number">48</span>c95:<span class="hljs-regexp">/home/app</span><span class="hljs-comment"># curl http://localhost:8080/profiling/generator</span>
<span class="hljs-keyword">write</span> success!springboot-server-d55fc79dd-<span class="hljs-number">48</span>c95:<span class="hljs-regexp">/home/app</span><span class="hljs-comment"># </span>
</code></pre>
<p>再来看看 <code>flameshot</code> 执行日志，已触发了阈值 <code>cpu_avg:36.60</code> 且正常上报数据。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f554a7a775e4e2ab5a0842ad349ff33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770027977&amp;x-signature=K62K%2BGbNQWF2aTBy8TDBgfYTO9s%3D" alt="" loading="lazy"/></p>
<p>之后恢复了正常，正常之后则不会再产生 Profiling 数据，除非再次触发了阈值。</p>
<h3 data-id="heading-17">观测云平台</h3>
<p>登录观测云平台，访问「应用性能检测」-「Profling」可以查看到刚刚上报的 Profling 信息</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/666a3bf27773494eb1f05da63ada3e73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770027977&amp;x-signature=qWtEJuEcdVJZzQW1Kn1qaC9Z0zY%3D" alt="" loading="lazy"/></p>
<p>点击列表可以查看 Profling 详细信息，如 CPU 耗时、内存分配情况等，可以更深度的剖析应用代码性能损耗。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0efbac6898bf4d7d95f7eda85b5772b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770027977&amp;x-signature=faNNZA0FXhuqRPY%2FbVzjI0N2AHc%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[你的 AI 应用不要再只是Chat+RAG 了！深度拆解LinkedIn招聘AI Agent架构，附源码]]></title>    <link>https://juejin.cn/post/7599528186586497034</link>    <guid>https://juejin.cn/post/7599528186586497034</guid>    <pubDate>2026-01-26T10:11:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599528186586497034" data-draft-id="7599330434426601523" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="你的 AI 应用不要再只是Chat+RAG 了！深度拆解LinkedIn招聘AI Agent架构，附源码"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2026-01-26T10:11:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="张居邪"/> <meta itemprop="url" content="https://juejin.cn/user/2154698522507927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            你的 AI 应用不要再只是Chat+RAG 了！深度拆解LinkedIn招聘AI Agent架构，附源码
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2154698522507927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    张居邪
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:11:58.000Z" title="Mon Jan 26 2026 10:11:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读11分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">一、灵魂拷问：为什么你的AI项目总是死在Demo之后？</h2>
<p>上个月，一个做HR SaaS的朋友找我吐槽：</p>
<blockquote>
<p>"我们花了3个月做的AI招聘助手，Demo给老板看的时候，老板直呼'太牛了'。结果上线两周，HR们集体反馈'还不如我自己搜'，现在项目已经凉了..."</p>
</blockquote>
<p>我问他架构怎么设计的，他发来一张图：</p>
<pre><code class="hljs language-markdown" lang="markdown">用户输入 → Prompt → LLM → 输出结果
<span class="hljs-code">              ↑
           RAG检索
</span></code></pre>
<p>我说：<strong>这前期演示可以，但落地会有一堆的问题。</strong></p>
<p>他不服：市面上90%的AI应用不都这么搞的吗？</p>
<p>没错，所以90%的AI项目都死在了Demo之后。</p>

























<table><thead><tr><th>问题</th><th>你可能遇到过</th></tr></thead><tbody><tr><td><strong>无状态</strong></td><td>每次对话都是新开始，AI不记得用户上次说了啥</td></tr><tr><td><strong>单一能力</strong></td><td>一个Prompt打天下，稍微复杂点的任务就搞不定</td></tr><tr><td><strong>不可控</strong></td><td>LLM输出飘忽不定，生产环境天天提心吊胆</td></tr><tr><td><strong>人机割裂</strong></td><td>要么全自动要么全手动，没有中间态</td></tr></tbody></table>
<p>今天拆解一个<strong>真正跑在生产环境的AI Agent</strong>——LinkedIn Hiring Assistant，看看大厂是怎么解决这些问题的。</p>
<p>顺便说一句，我把核心架构用LangGraph复现了一遍，<strong>源码在文末</strong>。</p>
<hr/>
<h2 data-id="heading-1">二、LinkedIn Hiring Assistant：这数据超过了一般专业的HR了</h2>
<h3 data-id="heading-2">2.1 产品背景</h3>
<p>2024年10月，LinkedIn悄悄上线了一个叫Hiring Assistant的东西。</p>
<p>注意措辞——LinkedIn管它叫"Agent"，不是"AI功能"，也不是"智能助手"。这个定位本身就很有意思。</p>
<p>一年后，这产品已经铺到全球市场了。官方放出来的数据：</p>





























<table><thead><tr><th>指标</th><th>效果</th></tr></thead><tbody><tr><td>候选人浏览效率</td><td>提升 <strong>60%</strong></td></tr><tr><td>候选人联系效率</td><td>提升 <strong>40%</strong></td></tr><tr><td>初筛效率</td><td>提升 <strong>45%</strong></td></tr><tr><td>InMail回复率</td><td><strong>2.15倍</strong></td></tr><tr><td>自动化覆盖率</td><td>招聘流程的 <strong>80%</strong></td></tr></tbody></table>
<p>InMail回复率2.15倍这个数据最让我震惊——要知道LinkedIn上的InMail回复率一直是个老大难问题，很多HR发100封能收到5封回复就谢天谢地了。</p>
<p>这些数字背后，是一套完全不同于"Chat+RAG"的架构。</p>
<h3 data-id="heading-3">2.2 核心能力</h3>
<p>功能覆盖招聘全流程：<strong>JD生成 → 候选人搜索 → 智能筛选 → 个性化外联 → 持续学习</strong>。</p>
<p>但说实话，<strong>功能不是重点，架构才是</strong>。</p>
<hr/>
<h2 data-id="heading-4">三、核心架构拆解：为什么是Supervisor模式？</h2>
<h3 data-id="heading-5">3.1 先说结论：ReAct不够用</h3>
<p>市面上大多数AI Agent教程都在讲ReAct（Reasoning + Acting）模式。我之前也用这个模式做过几个项目，踩了不少坑。</p>
<p>直接上对比：</p>





























<table><thead><tr><th>模式</th><th>优点</th><th>坑在哪</th><th>适合干啥</th></tr></thead><tbody><tr><td><strong>ReAct单Agent</strong></td><td>简单直接，上手快</td><td>复杂任务容易跑偏，没法并行</td><td>简单问答</td></tr><tr><td><strong>Plan-and-Execute</strong></td><td>计划清晰，可预测</td><td>太死板，中途改不了</td><td>步骤固定的流程</td></tr><tr><td><strong>Supervisor Multi-Agent</strong></td><td>专业分工，能并行，好扩展</td><td>架构复杂，调试头疼</td><td><strong>复杂业务流程</strong></td></tr></tbody></table>
<p><strong>Supervisor模式的核心差异</strong>：它的"规划"是动态的、走一步看一步的，不是一开始就把整个计划定死。</p>
<p>举个例子你就懂了：</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">用户: "帮我招一个后端工程师"</span>
     ↓
<span class="hljs-section">Supervisor: 先让Sourcing去搜人</span>
     ↓
<span class="hljs-section">Sourcing返回: 只找到3个人</span>
     ↓
<span class="hljs-section">Supervisor: 人太少，放宽条件再搜一次（动态调整）</span>
     ↓
<span class="hljs-section">Sourcing返回: 这次找到15个</span>
     ↓
<span class="hljs-section">Supervisor: 够了，让Screening去筛选</span>
     ↓
...每一步都根据上一步结果决定下一步
</code></pre>
<p>这种"边走边看"的模式，才是生产环境真正需要的。</p>
<h3 data-id="heading-6">3.2 架构全景图</h3>
<pre><code class="hljs language-scss" lang="scss">                    ┌─────────────────────────────────┐
                    │        Recruiter (用户)          │
                    └───────────────┬─────────────────┘
                                    │ 自然语言交互
                                    ▼
┌───────────────────────────────────────────────────────────────┐
│                      Supervisor Agent                          │
│  ┌─────────────────────────────────────────────────────────┐  │
│  │  • 意图理解：用户想做什么？                               │  │
│  │  • 任务分解：拆成哪些子任务？                             │  │
│  │  • 调度决策：分配给哪个Agent？                           │  │
│  │  • 结果聚合：如何整合各Agent的输出？                      │  │
│  │  • 异常处理：子Agent失败了怎么办？                        │  │
│  └─────────────────────────────────────────────────────────┘  │
└──────────────────────────┬────────────────────────────────────┘
                           │
         ┌─────────────────┼─────────────────┬─────────────────┐
         ▼                 ▼                 ▼                 ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  Sourcing   │    │  Screening  │    │  Outreach   │    │  Evaluation │
│    Agent    │    │    Agent    │    │    Agent    │    │    Agent    │
├─────────────┤    ├─────────────┤    ├─────────────┤    ├─────────────┤
│ • 候选人搜索 │    │ • 简历解析  │    │ • 消息生成  │    │ • 匹配度评分│
│ • 技能匹配   │    │ • 条件筛选  │    │ • 个性化定制│    │ • 排序推荐  │
│ • 人才库检索 │    │ • 预筛选QA  │    │ • 多语言翻译│    │ • 对比分析  │
└──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘
       │                  │                  │                  │
       └──────────────────┴──────────────────┴──────────────────┘
                                    │
                                    ▼
                    ┌───────────────────────────────┐
                    │       Skill Registry          │
                    │   (统一的能力注册与管理中心)    │
                    ├───────────────────────────────┤
                    │  • search_candidates          │
                    │  • parse_resume               │
                    │  • generate_inmail            │
                    │  • evaluate_fit               │
                    │  • ...                        │
                    └───────────────────────────────┘
                                    │
                                    ▼
                    ┌───────────────────────────────┐
                    │     LinkedIn Services         │
                    │  (Economic Graph, <span class="hljs-number">10</span>亿+用户)   │
                    └───────────────────────────────┘
</code></pre>
<h3 data-id="heading-7">3.3 三个关键设计决策</h3>
<p><strong>决策1：从Prompt Chain到Prompt Graph</strong></p>
<p>传统做法是线性的：</p>
<pre><code class="hljs language-css" lang="css">Prompt <span class="hljs-selector-tag">A</span> → Prompt <span class="hljs-selector-tag">B</span> → Prompt C → 输出
</code></pre>
<p>LinkedIn用的是图结构：</p>
<pre><code class="hljs language-css" lang="css">        ┌→ Prompt <span class="hljs-selector-tag">B</span> ─┐
Prompt <span class="hljs-selector-tag">A</span> ─┤           ├→ Prompt D → 输出
        └→ Prompt C ─┘
</code></pre>
<p>好处很直接：</p>
<ul>
<li>B和C可以并行跑，快</li>
<li>支持条件分支，灵活</li>
<li>某个节点挂了可以重试，稳</li>
</ul>
<p><strong>决策2：Supervisor只管调度，不干活</strong></p>
<p>这点很重要。Supervisor的职责是<strong>纯粹的协调</strong>，不直接调用工具或执行业务逻辑。</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Supervisor的核心逻辑（伪代码）</span>
class SupervisorAgent:
    def process(self, user_request):
        <span class="hljs-comment"># 1. 搞清楚用户想干啥</span>
        <span class="hljs-attr">intent</span> = self.understand_intent(user_request)

        <span class="hljs-comment"># 2. 拆成小任务</span>
        <span class="hljs-attr">subtasks</span> = self.decompose_task(intent)

        <span class="hljs-comment"># 3. 分配给对应的Agent（可以并行）</span>
        <span class="hljs-attr">results</span> = []
        for task in subtasks:
            <span class="hljs-attr">agent</span> = self.select_agent(task)
            <span class="hljs-attr">result</span> = agent.execute(task)
            results.append(result)

        <span class="hljs-comment"># 4. 汇总结果</span>
        return self.aggregate_results(results)
</code></pre>
<p>为啥这么设计？</p>

























<table><thead><tr><th>设计</th><th>好处</th></tr></thead><tbody><tr><td>职责单一</td><td>Supervisor只管调度，不会因为业务逻辑复杂而出错</td></tr><tr><td>易于扩展</td><td>加新能力就加个子Agent，Supervisor不用改</td></tr><tr><td>便于调试</td><td>出问题能定位到具体哪个Agent，不是一团乱麻</td></tr><tr><td>支持并行</td><td>没依赖关系的任务可以同时跑</td></tr></tbody></table>
<p><strong>决策3：Skill Registry统一管理能力</strong></p>
<p>所有Agent的能力都注册在一个统一的Registry里：</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># Skill Registry示例</span>
skill_registry = {
    <span class="hljs-string">"search_candidates"</span>: {
        <span class="hljs-string">"agent"</span>: <span class="hljs-string">"sourcing_agent"</span>,
        <span class="hljs-string">"description"</span>: <span class="hljs-string">"根据条件搜索候选人"</span>,
        <span class="hljs-string">"parameters"</span>: [<span class="hljs-string">"job_requirements"</span>, <span class="hljs-string">"filters"</span>],
        <span class="hljs-string">"output"</span>: <span class="hljs-string">"candidate_list"</span>
    },
    <span class="hljs-string">"generate_inmail"</span>: {
        <span class="hljs-string">"agent"</span>: <span class="hljs-string">"outreach_agent"</span>,
        <span class="hljs-string">"description"</span>: <span class="hljs-string">"生成个性化外联消息"</span>,
        <span class="hljs-string">"parameters"</span>: [<span class="hljs-string">"candidate_profile"</span>, <span class="hljs-string">"job_info"</span>, <span class="hljs-string">"tone"</span>],
        <span class="hljs-string">"output"</span>: <span class="hljs-string">"message_content"</span>
    },
    <span class="hljs-comment"># ...</span>
}
</code></pre>
<p>好处：</p>
<ul>
<li>Supervisor能动态发现有哪些能力可用</li>
<li>接口统一，集成成本低</li>
<li>方便做权限控制和审计</li>
</ul>
<hr/>
<h2 data-id="heading-8">四、用 LangGraph 框架来实现一个简单的版本</h2>
<p>下面是完整的实现思路。</p>
<h3 data-id="heading-9">4.1 为什么选LangGraph？</h3>
<p>先说结论，我对比了几个主流框架：</p>






























<table><thead><tr><th>框架</th><th>特点</th><th>适合场景</th></tr></thead><tbody><tr><td>LangChain</td><td>线性Chain，上手简单</td><td>单轮问答、简单RAG</td></tr><tr><td>AutoGen</td><td>对话式多Agent</td><td>研究探索、头脑风暴</td></tr><tr><td>CrewAI</td><td>角色扮演式协作</td><td>创意任务、内容生成</td></tr><tr><td><strong>LangGraph</strong></td><td><strong>状态图+可控流程</strong></td><td><strong>生产级工作流</strong></td></tr></tbody></table>
<p>选LangGraph的原因：</p>
<ol>
<li><strong>StateGraph</strong>：状态管理是显式的，每一步都能追溯</li>
<li><strong>条件边</strong>：支持复杂分支逻辑</li>
<li><strong>持久化</strong>：工作流可以中断、恢复，适合长时间任务</li>
<li><strong>Human-in-the-Loop</strong>：原生支持人工审批节点</li>
</ol>
<h3 data-id="heading-10">4.2 LangGraph核心概念</h3>
<pre><code class="hljs language-sql" lang="sql">┌─────────────────────────────────────────────────────────────┐
│                    LangGraph 核心概念                        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  State（状态）                                               │
│  └─ TypedDict定义，节点之间传递和更新                        │
│                                                              │
│  Node（节点）                                                │
│  └─ 干活的函数，接收State，返回更新后的State                 │
│                                                              │
│  Edge（边）                                                  │
│  └─ 连接节点，定义执行顺序                                   │
│                                                              │
│  Conditional Edge（条件边）                                  │
│  └─ 根据State动态决定下一个节点                              │
│                                                              │
│  <span class="hljs-keyword">START</span> <span class="hljs-operator">/</span> <span class="hljs-keyword">END</span>                                                 │
│  └─ 图的入口和出口                                           │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<p>概念不多，直接看代码更清楚。</p>
<h3 data-id="heading-11">4.3 核心实现思路</h3>
<blockquote>
<p>完整代码见文末 GitHub 仓库，这里只说核心思路。</p>
</blockquote>
<p><strong>整体架构分5层：</strong></p>
<pre><code class="hljs language-scss" lang="scss">┌─────────────────────────────────────────────────────────┐
│  State层：HiringState (TypedDict)                       │
│  - 招聘任务信息、候选人数据、流程控制、审核状态          │
├─────────────────────────────────────────────────────────┤
│  Tools层：<span class="hljs-keyword">@tool</span> 装饰器定义的能力                        │
│  - search_talent_<span class="hljs-attribute">pool</span>: 搜索候选人                       │
│  - evaluate_<span class="hljs-attribute">candidate</span>: LLM评估匹配度                    │
│  - generate_<span class="hljs-attribute">inmail</span>: LLM生成个性化消息                   │
├─────────────────────────────────────────────────────────┤
│  Node层：工作流节点函数                                 │
│  - supervisor_<span class="hljs-attribute">node</span>: LLM智能决策下一步                   │
│  - sourcing_<span class="hljs-attribute">node</span>: 搜索+偏好排序                         │
│  - screening_<span class="hljs-attribute">node</span>: 逐个评估候选人                       │
│  - outreach_<span class="hljs-attribute">node</span>: 为批准的候选人生成消息                │
│  - human_review_<span class="hljs-attribute">node</span>: interrupt等待人工审核             │
├─────────────────────────────────────────────────────────┤
│  Graph层：StateGraph + 条件边                           │
│  - START → supervisor → 各节点 → supervisor（循环）     │
│  - 条件边根据next_action路由                            │
├─────────────────────────────────────────────────────────┤
│  Memory层：Experiential Memory                          │
│  - <span class="hljs-attribute">RecruiterMemory</span>: 存储用户偏好                        │
│  - <span class="hljs-attribute">MemoryStore</span>: 持久化+从反馈中学习                     │
└─────────────────────────────────────────────────────────┘
</code></pre>
<p><strong>关键实现点：</strong></p>






























<table><thead><tr><th>模块</th><th>核心逻辑</th><th>文件位置</th></tr></thead><tbody><tr><td>Supervisor决策</td><td>把当前状态摘要发给LLM，让它决定下一步</td><td><code>src/workflow.py</code></td></tr><tr><td>偏好排序</td><td>用LLM做语义匹配，给候选人加偏好分</td><td><code>src/llm_service.py</code></td></tr><tr><td>Human-in-the-Loop</td><td>用<code>interrupt()</code>暂停，<code>Command(resume=)</code>恢复</td><td><code>src/workflow.py</code></td></tr><tr><td>记忆更新</td><td>从用户的批准/拒绝动作中提取偏好信号</td><td><code>src/memory.py</code></td></tr></tbody></table>
<p><strong>工作流图示：</strong></p>
<pre><code class="hljs language-ini" lang="ini">                         ┌─────────────┐
                         │    START    │
                         └──────┬──────┘
                                │
                                ▼
                    ┌───────────────────────┐
              ┌────▶│     Supervisor        │◀────┐
              │     │  (LLM 智能决策)        │     │
              │     └───────────┬───────────┘     │
              │                 │                 │
              │     ┌───────────┼───────────┐     │
              │     ▼           ▼           ▼     │
              │ ┌────────┐ ┌──────────┐ ┌────────┐│
              │ │Sourcing│ │Screening │ │Outreach││
              │ │  Node  │ │   Node   │ │  Node  ││
              │ └───┬────┘ └────┬─────┘ └───┬────┘│
              │     │           │           │     │
              │     └───────────┴───────────┘     │
              │                 │                 │
              │                 ▼                 │
              │         ┌─────────────┐           │
              │         │Human Review │           │
              │         │(interrupt)  │───────────┘
              │         └─────────────┘
              │                 │
              └─────────────────┘
                                │
                                ▼ (<span class="hljs-attr">next_action</span> == <span class="hljs-string">"FINISH"</span>)
                         ┌─────────────┐
                         │     END     │
                         └─────────────┘
</code></pre>
<h3 data-id="heading-12">4.4 Human-in-the-Loop：关键代码片段</h3>
<p>这是整个架构里最关键的设计。用LangGraph的<code>interrupt</code>机制实现：</p>
<pre><code class="hljs language-makefile" lang="makefile">from langgraph.types import interrupt, Command

<span class="hljs-comment"># 在节点中暂停，等待人工输入</span>
user_feedback = interrupt({
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"human_review"</span>,
    <span class="hljs-string">"review_content"</span>: {<span class="hljs-string">"candidates"</span>: screened[:5]},
    <span class="hljs-string">"prompt"</span>: <span class="hljs-string">"请审核候选人"</span>
})

<span class="hljs-comment"># 调用方恢复执行</span>
result = app.invoke(Command(resume=human_feedback), config)
</code></pre>
<p>核心就这几行，剩下的是业务逻辑处理。</p>
<h3 data-id="heading-13">4.5 Experiential Memory：核心思路</h3>
<p>AI记住用户偏好的关键：<strong>从每次人工审核中学习</strong>。</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 用户批准了某个候选人 → 提取他的技能作为正向信号</span>
for candidate in approved_candidates:
    for skill in candidate<span class="hljs-section">["skills"]</span>:
        memory.positive_signals.append(skill)

<span class="hljs-comment"># 下次搜索时，用LLM做语义匹配，给符合偏好的候选人加分</span>
<span class="hljs-attr">preference_scores</span> = match_preferences_with_llm(candidates, memory.positive_signals)
</code></pre>
<p>就这么简单，但效果很明显——用得越久，推荐越准。</p>
<hr/>
<h2 data-id="heading-14">五、为什么你的AI助手用久了还是不懂你？</h2>
<p>这是LinkedIn Hiring Assistant<strong>最值得抄的设计</strong>。</p>
<h3 data-id="heading-15">5.1 一个扎心的问题</h3>
<p>你有没有这种体验：</p>
<ul>
<li>ChatGPT用了一年，每次还是要重新解释你的背景</li>
<li>企业知识库问答，永远不知道你关心什么</li>
<li>AI助手推荐的东西，永远不对味</li>
</ul>
<p><strong>根本原因：无状态设计</strong>。每次对话都是全新开始，AI压根不记得你是谁。</p>
<p>LinkedIn的解法是<strong>Experiential Memory</strong>——三层记忆架构：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76be88322d13444ba1d92c0aba77b9be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5byg5bGF6YKq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770027118&amp;x-signature=U9aQRYCAx9GgGS7OujHuecP%2Fs7w%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-16">5.2 技术实现思路</h3>
<p><strong>层次1：短期记忆（Session Memory）</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># 会话级记忆：当前招聘任务的上下文</span>
session_memory = {
    <span class="hljs-string">"current_job"</span>: <span class="hljs-string">"Senior Backend Engineer"</span>,
    <span class="hljs-string">"discussed_candidates"</span>: [<span class="hljs-string">"Alice"</span>, <span class="hljs-string">"Bob"</span>],
    <span class="hljs-string">"user_feedback"</span>: {
        <span class="hljs-string">"Alice"</span>: <span class="hljs-string">"技术不错但经验不足"</span>,
        <span class="hljs-string">"Bob"</span>: <span class="hljs-string">"很匹配，已发InMail"</span>
    }
}
</code></pre>
<p><strong>层次2：长期记忆（User Profile Memory）</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># 用户级记忆：跨任务的偏好积累</span>
user_memory = {
    <span class="hljs-string">"recruiter_id"</span>: <span class="hljs-string">"12345"</span>,
    <span class="hljs-string">"preference_model"</span>: {
        <span class="hljs-string">"must_have_signals"</span>: [<span class="hljs-string">"大厂背景"</span>, <span class="hljs-string">"开源贡献"</span>],
        <span class="hljs-string">"red_flags"</span>: [<span class="hljs-string">"频繁跳槽"</span>, <span class="hljs-string">"技能描述模糊"</span>],
    },
    <span class="hljs-string">"historical_success"</span>: {
        <span class="hljs-string">"hired_profiles"</span>: [...],
        <span class="hljs-string">"common_patterns"</span>: [<span class="hljs-string">"平均5年经验"</span>, <span class="hljs-string">"70%有硕士学历"</span>]
    }
}
</code></pre>
<p><strong>层次3：组织记忆（Organization Memory）</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># 组织级记忆：公司层面的招聘知识</span>
org_memory = {
    <span class="hljs-string">"company_id"</span>: <span class="hljs-string">"linkedin"</span>,
    <span class="hljs-string">"culture_fit_signals"</span>: [<span class="hljs-string">"协作导向"</span>, <span class="hljs-string">"数据驱动"</span>],
    <span class="hljs-string">"compliance_rules"</span>: [<span class="hljs-string">"必须考虑多样性"</span>, <span class="hljs-string">"薪资范围限制"</span>]
}
</code></pre>
<h3 data-id="heading-17">5.3 跟RAG有啥区别？</h3>
<p>很多人会问：这不就是RAG吗？</p>
<p><strong>真不一样。</strong></p>



































<table><thead><tr><th>维度</th><th>RAG</th><th>Experiential Memory</th></tr></thead><tbody><tr><td><strong>存的是啥</strong></td><td>原始文档/对话</td><td>提炼后的偏好模型</td></tr><tr><td><strong>怎么找</strong></td><td>向量相似度匹配</td><td>结构化查询+模式匹配</td></tr><tr><td><strong>怎么更新</strong></td><td>手动更新文档</td><td>自动从交互中学习</td></tr><tr><td><strong>怎么用</strong></td><td>塞进Prompt当上下文</td><td>直接影响Agent决策逻辑</td></tr><tr><td><strong>个性化程度</strong></td><td>低</td><td>高（同样问题，不同用户不同结果）</td></tr></tbody></table>
<p><strong>一句话总结：Experiential Memory的核心是"学习"，不是"存储"。</strong></p>
<hr/>
<h2 data-id="heading-18">六、Human-in-the-Loop：为什么LinkedIn只自动化80%？</h2>
<h3 data-id="heading-19">6.1 不是做不到100%，是故意不做</h3>
<p>LinkedIn官方说Hiring Assistant可以自动化**80%**的招聘流程。</p>
<p>为什么不是100%？技术上做不到吗？</p>
<p><strong>不是做不到，是故意不做。</strong></p>
<pre><code class="hljs">┌─────────────────────────────────────────────────────────────┐
│                    任务自动化程度分层                         │
├─────────────────────────────────────────────────────────────┤
│  全自动（无需人工）                                          │
│  ├─ JD格式化和优化、候选人初筛、消息模板生成                  │
│                                                              │
│  半自动（AI建议 + 人工确认）                                 │
│  ├─ 候选人推荐排序、InMail内容定制、面试安排建议              │
│                                                              │
│  人工主导（AI辅助）                                          │
│  ├─ 最终录用决策、薪资谈判、文化匹配判断                      │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<p><strong>主要有以下三个原因：</strong></p>





















<table><thead><tr><th>原因</th><th>说明</th></tr></thead><tbody><tr><td><strong>降低风险</strong></td><td>招聘是高风险决策，招错一个人可能损失几十万</td></tr><tr><td><strong>建立信任</strong></td><td>让用户先观察AI决策质量，信任建立后再逐步放开</td></tr><tr><td><strong>持续学习</strong></td><td>人工确认/拒绝的动作本身就是训练数据</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-20">七、写在最后</h2>
<p>LinkedIn Hiring Assistant不是最炫酷的AI产品，但它可能是<strong>最值得抄的</strong>。</p>
<p>它告诉我们一个朴素的道理：<strong>工业级AI系统的核心不是模型多强，而是架构多稳</strong>。</p>
<p><strong>4条核心原则，建议收藏：</strong></p>

























<table><thead><tr><th>原则</th><th>一句话总结</th></tr></thead><tbody><tr><td>Agent是架构范式</td><td>状态管理、异步执行、完整生命周期，一个都不能少</td></tr><tr><td>记忆系统是壁垒</td><td>用户偏好建模才是护城河，不是RAG</td></tr><tr><td>Human-in-the-Loop是设计</td><td>100%自动化不是目标，可信赖的自动化才是</td></tr><tr><td>生产化需要工程思维</td><td>幂等、状态机、异步、可观测，缺一不可</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-21">源码获取</h2>
<p>我把这套架构用LangGraph完整复现了一遍，代码已开源：</p>
<p><strong>GitHub：</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzhuzhaoyun%2Flinkedin-hiring-assistant-py" target="_blank" title="https://github.com/zhuzhaoyun/linkedin-hiring-assistant-py" ref="nofollow noopener noreferrer">github.com/zhuzhaoyun/…</a></p>
<p>包含：</p>
<ul>
<li>完整的Supervisor Multi-Agent工作流</li>
<li>Experiential Memory实现</li>
<li>Human-in-the-Loop中断恢复</li>
<li>可直接运行的Demo</li>
</ul>
<hr/>
<p><strong>关于我们</strong></p>
<p>我们是一家面向 AEC 行业的 AI 创业公司，专注企业级AI应用系统的设计与落地。如果你在做类似的AI应用工程化，或者对垂直行业AI落地感兴趣，欢迎评论区讨论或添加联系方式沟通。</p>
<p><strong>微信：Damondut</strong></p>
<p>本文使用 <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarkdown.com.cn" target="_blank" title="https://markdown.com.cn" ref="nofollow noopener noreferrer">markdown.com.cn</a> 排版</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[isexe@3.1.1源码阅读]]></title>    <link>https://juejin.cn/post/7599155566298267691</link>    <guid>https://juejin.cn/post/7599155566298267691</guid>    <pubDate>2026-01-26T10:27:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599155566298267691" data-draft-id="7599237603975839787" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="isexe@3.1.1源码阅读"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-01-26T10:27:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="米丘"/> <meta itemprop="url" content="https://juejin.cn/user/1611227736052074"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            isexe@3.1.1源码阅读
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1611227736052074/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    米丘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:27:06.000Z" title="Mon Jan 26 2026 10:27:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><em>发布日期 2023 年 8 月 3 日</em></p>
<p><code>isexe</code> 是<strong>跨平台检查文件是否为「可执行文件」的专用工具包</strong>，核心解决「Windows 和 Unix 系统判断可执行文件的规则完全不同」的问题。</p>
<p>unix系统根据文件权限判断；window系统根据文件扩展名判断。</p>
<h2 data-id="heading-0">入口文件 index.js</h2>
<p><code>isexe-3.1.1/src/index.ts</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> posix <span class="hljs-keyword">from</span> <span class="hljs-string">'./posix.js'</span> <span class="hljs-comment">// 导入 POSIX 系统（Linux/macOS 等）的实现</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> win32 <span class="hljs-keyword">from</span> <span class="hljs-string">'./win32.js'</span> <span class="hljs-comment">// 导入 Windows 系统的实现</span>
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./options.js'</span> <span class="hljs-comment">// 导出配置选项类型（如 IsexeOptions）</span>
<span class="hljs-keyword">export</span> { win32, posix }  <span class="hljs-comment">// 允许直接访问特定平台的实现</span>

<span class="hljs-keyword">const</span> platform = process.<span class="hljs-property">env</span>.<span class="hljs-property">_ISEXE_TEST_PLATFORM_</span> || process.<span class="hljs-property">platform</span>
<span class="hljs-keyword">const</span> impl = platform === <span class="hljs-string">'win32'</span> ? win32 : posix

<span class="hljs-comment">/**
 * Determine whether a path is executable on the current platform.
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> isexe = impl.<span class="hljs-property">isexe</span>
<span class="hljs-comment">/**
 * Synchronously determine whether a path is executable on the
 * current platform.
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> sync = impl.<span class="hljs-property">sync</span>

</code></pre>
<h2 data-id="heading-1">posix.isexe(异步)</h2>
<p><code>isexe-3.1.1/src/posix.ts</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> isexe = <span class="hljs-keyword">async</span> (
  <span class="hljs-attr">path</span>: string,  <span class="hljs-comment">// 要检查的文件路径（比如 "/usr/bin/node" 或 "C:\\node.exe"）</span>
  <span class="hljs-attr">options</span>: <span class="hljs-title class_">IsexeOptions</span> = {}  <span class="hljs-comment">// 配置项，默认空对象</span>
): <span class="hljs-title class_">Promise</span>&lt;boolean&gt; =&gt; {
  
  <span class="hljs-keyword">const</span> { ignoreErrors = <span class="hljs-literal">false</span> } = options

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// await stat(path)：获取文件状态</span>
    <span class="hljs-comment">// checkStat(statResult, options)：判断是否可执行</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">checkStat</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">stat</span>(path), options)
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-comment">// 把错误转为 Node.js 标准错误类型（带错误码）</span>
    <span class="hljs-keyword">const</span> er = e <span class="hljs-keyword">as</span> <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">ErrnoException</span>
    <span class="hljs-keyword">if</span> (ignoreErrors || er.<span class="hljs-property">code</span> === <span class="hljs-string">'EACCES'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    <span class="hljs-keyword">throw</span> er <span class="hljs-comment">// 非预期错误，向上抛出</span>
  }
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Stats</span>, statSync } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs'</span>
<span class="hljs-keyword">import</span> { stat } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs/promises'</span>
</code></pre>
<h3 data-id="heading-2">checkStat</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">checkStat</span> = (<span class="hljs-params">stat: Stats, options: IsexeOptions</span>) =&gt;
  stat.<span class="hljs-title function_">isFile</span>() &amp;&amp; <span class="hljs-title function_">checkMode</span>(stat, options)

</code></pre>
<h3 data-id="heading-3">checkMode</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">checkMode</span> = (<span class="hljs-params">
  <span class="hljs-comment">// 文件的 Stats 对象（通常由 fs.stat 或 fs.lstat 获取）</span>
  <span class="hljs-comment">// 包含文件的权限位（mode）、所有者 ID（uid）、所属组 ID（gid）等元数据。</span>
  stat: Stats, 
  <span class="hljs-comment">// 配置对象，允许自定义用户 ID（uid）、组 ID（gid）、用户所属组列表（groups），默认使用当前进程的用户信息。</span>
  options: IsexeOptions
</span>) =&gt; {
  <span class="hljs-comment">// 1、获取用户与组信息</span>
  <span class="hljs-comment">// 当前用户的 ID（优先使用 options.uid，否则调用 process.getuid() 获取当前进程的用户 ID）。</span>
  <span class="hljs-keyword">const</span> myUid = options.<span class="hljs-property">uid</span> ?? process.<span class="hljs-property">getuid</span>?.()
  <span class="hljs-comment">// 当前用户所属的组 ID 列表（优先使用 options.groups，否则调用 process.getgroups() 获取）。</span>
  <span class="hljs-keyword">const</span> myGroups = options.<span class="hljs-property">groups</span> ?? process.<span class="hljs-property">getgroups</span>?.() ?? []
  <span class="hljs-comment">// 当前用户的主组 ID（优先使用 options.gid，否则调用 process.getgid()，或从 myGroups 取第一个组 ID）。</span>
  <span class="hljs-keyword">const</span> myGid = options.<span class="hljs-property">gid</span> ?? process.<span class="hljs-property">getgid</span>?.() ?? myGroups[<span class="hljs-number">0</span>]
  <span class="hljs-comment">// 若无法获取 myUid 或 myGid，抛出错误（权限判断依赖这些信息）</span>
  <span class="hljs-keyword">if</span> (myUid === <span class="hljs-literal">undefined</span> || myGid === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'cannot get uid or gid'</span>)
  }

  <span class="hljs-comment">// 2、构建用户所属组集合</span>
  <span class="hljs-keyword">const</span> groups = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([myGid, ...myGroups])

  <span class="hljs-comment">// 3、解析文件权限位与归属信息</span>
  <span class="hljs-keyword">const</span> mod = stat.<span class="hljs-property">mode</span> <span class="hljs-comment">// 文件的权限位（整数，如 0o755 表示 rwxr-xr-x）</span>
  <span class="hljs-keyword">const</span> uid = stat.<span class="hljs-property">uid</span> <span class="hljs-comment">// 文件所有者的用户 ID</span>
  <span class="hljs-keyword">const</span> gid = stat.<span class="hljs-property">gid</span> <span class="hljs-comment">// 文件所属组的组 ID</span>

  <span class="hljs-comment">// 4、定义权限位掩码</span>
  <span class="hljs-comment">// 八进制 100 → 十进制 64 → 对应所有者的执行权限位（x）</span>
  <span class="hljs-keyword">const</span> u = <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">'100'</span>, <span class="hljs-number">8</span>)
  <span class="hljs-comment">// 八进制 010 → 十进制 8 → 对应所属组的执行权限位（x）</span>
  <span class="hljs-keyword">const</span> g = <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">'010'</span>, <span class="hljs-number">8</span>)
  <span class="hljs-comment">// 八进制 001 → 十进制 1 → 对应其他用户的执行权限位（x）</span>
  <span class="hljs-keyword">const</span> o = <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">'001'</span>, <span class="hljs-number">8</span>)
  <span class="hljs-comment">// 所有者和所属组的执行权限位掩码（64 | 8 = 72）</span>
  <span class="hljs-keyword">const</span> ug = u | g

  <span class="hljs-comment">// 5、权限判断逻辑</span>
  <span class="hljs-keyword">return</span> !!(
    mod &amp; o || <span class="hljs-comment">// 1. 其他用户有执行权限</span>
    (mod &amp; g &amp;&amp; groups.<span class="hljs-title function_">has</span>(gid)) || <span class="hljs-comment">// 2. 所属组有执行权限，且当前用户属于该组</span>
    (mod &amp; u &amp;&amp; uid === myUid) || <span class="hljs-comment">// 3. 所有者有执行权限，且当前用户是所有者</span>
    (mod &amp; ug &amp;&amp; myUid === <span class="hljs-number">0</span>)  <span class="hljs-comment">// 4. 所有者或组有执行权限，且当前用户是 root（UID=0）</span>
  )
}
</code></pre>
<p><code>mod</code> <strong>（权限位）</strong> ：Unix 系统中用 9 位二进制表示文件权限（分为所有者、所属组、其他用户三类，每类 3 位，分别控制读 <code>r</code>、写 <code>w</code>、执行 <code>x</code> 权限）。例如 <code>0o755</code> 对应二进制 <code>111 101 101</code>，表示：</p>
<ul>
<li>所有者（<code>u</code>）：可读、可写、可执行（<code>rwx</code>）。</li>
<li>所属组（<code>g</code>）：可读、可执行（<code>r-x</code>）。</li>
<li>其他用户（<code>o</code>）：可读、可执行（<code>r-x</code>）。</li>
</ul>
<h2 data-id="heading-4">posix.sync (同步)</h2>
<p><code>isexe-3.1.1/src/posix.ts</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> sync = (
  <span class="hljs-attr">path</span>: string,
  <span class="hljs-attr">options</span>: <span class="hljs-title class_">IsexeOptions</span> = {}
): <span class="hljs-function"><span class="hljs-params">boolean</span> =&gt;</span> {
  
  <span class="hljs-keyword">const</span> { ignoreErrors = <span class="hljs-literal">false</span> } = options
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">checkStat</span>(<span class="hljs-title function_">statSync</span>(path), options)
    
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">const</span> er = e <span class="hljs-keyword">as</span> <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">ErrnoException</span>
    <span class="hljs-keyword">if</span> (ignoreErrors || er.<span class="hljs-property">code</span> === <span class="hljs-string">'EACCES'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    <span class="hljs-keyword">throw</span> er
  }
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Stats</span>, statSync } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs'</span>
<span class="hljs-keyword">import</span> { stat } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs/promises'</span>
</code></pre>
<h2 data-id="heading-5">win32.isexe （异步）</h2>
<p><code>isexe-3.1.1/src/win32.ts</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> isexe = <span class="hljs-keyword">async</span> (
  <span class="hljs-attr">path</span>: string,
  <span class="hljs-attr">options</span>: <span class="hljs-title class_">IsexeOptions</span> = {}
): <span class="hljs-title class_">Promise</span>&lt;boolean&gt; =&gt; {
  
  <span class="hljs-keyword">const</span> { ignoreErrors = <span class="hljs-literal">false</span> } = options
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">checkStat</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">stat</span>(path), path, options)
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">const</span> er = e <span class="hljs-keyword">as</span> <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">ErrnoException</span>
    <span class="hljs-keyword">if</span> (ignoreErrors || er.<span class="hljs-property">code</span> === <span class="hljs-string">'EACCES'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    <span class="hljs-keyword">throw</span> er
  }
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Stats</span>, statSync } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs'</span>
<span class="hljs-keyword">import</span> { stat } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs/promises'</span>
</code></pre>
<h3 data-id="heading-6">checkStat</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">checkStat</span> = (<span class="hljs-params">stat: Stats, path: string, options: IsexeOptions</span>) =&gt;
  stat.<span class="hljs-title function_">isFile</span>() &amp;&amp; <span class="hljs-title function_">checkPathExt</span>(path, options)
</code></pre>
<h3 data-id="heading-7">checkPathExt</h3>
<p><code>isexe-3.1.1/src/win32.ts</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">checkPathExt</span> = (<span class="hljs-params">path: string, options: IsexeOptions</span>) =&gt; {

  <span class="hljs-comment">// 获取可执行扩展名列表</span>
  <span class="hljs-keyword">const</span> { pathExt = process.<span class="hljs-property">env</span>.<span class="hljs-property">PATHEXT</span> || <span class="hljs-string">''</span> } = options

  <span class="hljs-keyword">const</span> peSplit = pathExt.<span class="hljs-title function_">split</span>(<span class="hljs-string">';'</span>)
  <span class="hljs-comment">// 特殊情况处理：空扩展名</span>
  <span class="hljs-comment">// 空扩展名通常表示 “任何文件都视为可执行”，这是一种特殊配置</span>
  <span class="hljs-keyword">if</span> (peSplit.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">''</span>) !== -<span class="hljs-number">1</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  }

  <span class="hljs-comment">// 检查文件扩展名是否匹配</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; peSplit.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-comment">// 转小写：避免大小写问题（比如.EXE和.exe视为同一个）</span>
    <span class="hljs-keyword">const</span> p = peSplit[i].<span class="hljs-title function_">toLowerCase</span>()
    <span class="hljs-comment">// 截取文件路径的最后N个字符（N是当前扩展名p的长度），也转小写</span>
    <span class="hljs-keyword">const</span> ext = path.<span class="hljs-title function_">substring</span>(path.<span class="hljs-property">length</span> - p.<span class="hljs-property">length</span>).<span class="hljs-title function_">toLowerCase</span>()

    <span class="hljs-comment">// 匹配条件：扩展名非空 + 文件扩展名和列表中的扩展名完全一致</span>
    <span class="hljs-keyword">if</span> (p &amp;&amp; ext === p) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
}
</code></pre>
<h2 data-id="heading-8">win32.sync（同步）</h2>
<p><code>isexe-3.1.1/src/win32.ts</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> sync = (
  <span class="hljs-attr">path</span>: string,
  <span class="hljs-attr">options</span>: <span class="hljs-title class_">IsexeOptions</span> = {}
): <span class="hljs-function"><span class="hljs-params">boolean</span> =&gt;</span> {
  
  <span class="hljs-keyword">const</span> { ignoreErrors = <span class="hljs-literal">false</span> } = options
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">checkStat</span>(<span class="hljs-title function_">statSync</span>(path), path, options)
    
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">const</span> er = e <span class="hljs-keyword">as</span> <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">ErrnoException</span>
    <span class="hljs-keyword">if</span> (ignoreErrors || er.<span class="hljs-property">code</span> === <span class="hljs-string">'EACCES'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    <span class="hljs-keyword">throw</span> er
  }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【LeetCode Hot100 刷题日记 （76/100）】295. 数据流的中位数 —— 双堆（优先队列）维护动态中位数 🧠]]></title>    <link>https://juejin.cn/post/7599155566298251307</link>    <guid>https://juejin.cn/post/7599155566298251307</guid>    <pubDate>2026-01-26T10:24:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599155566298251307" data-draft-id="7599155566298234923" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【LeetCode Hot100 刷题日记 （76/100）】295. 数据流的中位数 —— 双堆（优先队列）维护动态中位数 🧠"/> <meta itemprop="keywords" content="算法,面试,程序员"/> <meta itemprop="datePublished" content="2026-01-26T10:24:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jing_Rainbow"/> <meta itemprop="url" content="https://juejin.cn/user/1285809519198256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【LeetCode Hot100 刷题日记 （76/100）】295. 数据流的中位数 —— 双堆（优先队列）维护动态中位数 🧠
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1285809519198256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jing_Rainbow
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:24:00.000Z" title="Mon Jan 26 2026 10:24:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>📌 题目链接：<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Ffind-median-from-data-stream%2Fdescription%2F%3FenvType%3Dstudy-plan-v2%26envId%3Dtop-100-liked" target="_blank" title="https://leetcode.cn/problems/find-median-from-data-stream/description/?envType=study-plan-v2&amp;envId=top-100-liked" ref="nofollow noopener noreferrer">295. 数据流的中位数 - 力扣（LeetCode）</a></p>
<p>🔍 难度：<strong>困难</strong> | 🏷️ 标签：<strong>设计、堆（优先队列）、数据流、双指针</strong></p>
<p>⏱️ 目标时间复杂度：<strong>addNum: O(log n)，findMedian: O(1)</strong></p>
<p>💾 空间复杂度：<strong>O(n)</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-0">🎯 问题核心与面试价值</h2>
<p>在<strong>实时数据处理系统</strong>（如股票价格监控、在线评分系统、网络流量分析）中，我们经常需要动态维护一个不断增长的数据集合，并<strong>高效查询当前中位数</strong>。这道题考察的是：</p>
<ul>
<li><strong>如何用两个堆（优先队列）巧妙维护有序性</strong></li>
<li><strong>对“中位数”定义的精准理解（奇偶长度差异）</strong></li>
<li><strong>动态平衡思想</strong>（类似 AVL 树的旋转思想）</li>
<li><strong>C++ STL 中 <code>priority_queue</code> 的自定义比较器使用</strong></li>
</ul>
<p>这是<strong>高频系统设计+算法结合题</strong>，在 Google、Amazon、Meta 等大厂面试中多次出现，尤其适合考察候选人对<strong>数据结构组合使用</strong>的能力。</p>
<hr/>
<h2 data-id="heading-1">🧩 题目分析</h2>
<p>我们需要设计一个类 <code>MedianFinder</code>，支持两种操作：</p>
<ol>
<li><code>addNum(int num)</code>：向数据流中添加一个整数；</li>
<li><code>findMedian()</code>：返回当前所有数的中位数。</li>
</ol>
<p>关键约束：</p>
<ul>
<li>数据是<strong>动态流入</strong>的，不能预先知道全部数据；</li>
<li>每次 <code>findMedian</code> 必须<strong>高效</strong>（理想 O(1)）；</li>
<li>数据规模可达 <strong>5 × 10⁴</strong> 次操作，暴力排序（O(n log n) 每次）会超时 ❌。</li>
</ul>
<blockquote>
<p>✅ 正确思路：<strong>不显式维护整个有序数组，而是用两个堆分别维护“较小的一半”和“较大的一半”</strong> 。</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">🧠 核心算法及代码讲解：双堆（Two Heaps）法</h2>
<h3 data-id="heading-3">📌 算法思想</h3>
<p>我们维护两个堆：</p>
<ul>
<li><strong><code>queMin</code></strong>：<strong>最大堆</strong>（C++ 默认 <code>priority_queue&lt;int&gt;</code> 是最大堆），存储<strong>较小的一半数字</strong>，堆顶是这部分的最大值；</li>
<li><strong><code>queMax</code></strong>：<strong>最小堆</strong>（用 <code>greater&lt;int&gt;</code> 实现），存储<strong>较大的一半数字</strong>，堆顶是这部分的最小值。</li>
</ul>
<blockquote>
<p>💡 <strong>不变量（Invariant）</strong> ：</p>
<ul>
<li><code>queMin.size() == queMax.size()</code> 或 <code>queMin.size() == queMax.size() + 1</code></li>
<li>所有 <code>queMin</code> 中的元素 ≤ 所有 <code>queMax</code> 中的元素</li>
</ul>
</blockquote>
<p>这样，中位数就是：</p>
<ul>
<li>若总个数为奇数 → <code>queMin.top()</code>（因为 <code>queMin</code> 多一个）</li>
<li>若为偶数 → <code>(queMin.top() + queMax.top()) / 2.0</code></li>
</ul>
<h3 data-id="heading-4">🔄 插入逻辑（关键！）</h3>
<p>当插入新数字 <code>num</code> 时：</p>
<ol>
<li>
<p><strong>若 <code>num ≤ queMin.top()</code></strong> → 应放入 <code>queMin</code></p>
<ul>
<li>但插入后可能破坏 size 不变量（<code>queMin</code> 比 <code>queMax</code> 多超过 1 个）</li>
<li>→ 把 <code>queMin</code> 的堆顶（最大值）移到 <code>queMax</code></li>
</ul>
</li>
<li>
<p><strong>否则</strong> → 放入 <code>queMax</code></p>
<ul>
<li>但若 <code>queMax</code> 比 <code>queMin</code> 大 → 把 <code>queMax</code> 的堆顶（最小值）移到 <code>queMin</code></li>
</ul>
</li>
</ol>
<blockquote>
<p>✅ 这样始终保证 <code>queMin</code> 存“左半部分”，<code>queMax</code> 存“右半部分”，且大小差 ≤1。</p>
</blockquote>
<h3 data-id="heading-5">💻 C++ 代码详解（带行注释）</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MedianFinder</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// queMin: 最大堆，存较小的一半；queMax: 最小堆，存较大的一半</span>
    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;, less&lt;<span class="hljs-type">int</span>&gt;&gt; queMin;      <span class="hljs-comment">// 默认就是 less，可省略</span>
    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;, greater&lt;<span class="hljs-type">int</span>&gt;&gt; queMax;   <span class="hljs-comment">// greater&lt;int&gt; 实现最小堆</span>

    <span class="hljs-built_in">MedianFinder</span>() {}

    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span> </span>{
        <span class="hljs-comment">// 情况1：queMin 为空（首次插入）或 num &lt;= queMin 的最大值</span>
        <span class="hljs-keyword">if</span> (queMin.<span class="hljs-built_in">empty</span>() || num &lt;= queMin.<span class="hljs-built_in">top</span>()) {
            queMin.<span class="hljs-built_in">push</span>(num);  <span class="hljs-comment">// 先加入左半部分</span>
            <span class="hljs-comment">// 检查是否左半部分比右半部分多出超过1个</span>
            <span class="hljs-keyword">if</span> (queMax.<span class="hljs-built_in">size</span>() + <span class="hljs-number">1</span> &lt; queMin.<span class="hljs-built_in">size</span>()) {
                queMax.<span class="hljs-built_in">push</span>(queMin.<span class="hljs-built_in">top</span>());  <span class="hljs-comment">// 把左半部分的最大值移到右边</span>
                queMin.<span class="hljs-built_in">pop</span>();
            }
        } 
        <span class="hljs-comment">// 情况2：num &gt; queMin.top()，应加入右半部分</span>
        <span class="hljs-keyword">else</span> {
            queMax.<span class="hljs-built_in">push</span>(num);
            <span class="hljs-comment">// 注意：这里只允许 queMin 比 queMax 多1，不允许 queMax 更大！</span>
            <span class="hljs-keyword">if</span> (queMax.<span class="hljs-built_in">size</span>() &gt; queMin.<span class="hljs-built_in">size</span>()) {
                queMin.<span class="hljs-built_in">push</span>(queMax.<span class="hljs-built_in">top</span>());  <span class="hljs-comment">// 把右半部分的最小值移到左边</span>
                queMax.<span class="hljs-built_in">pop</span>();
            }
        }
    }

    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">findMedian</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// 奇数个：queMin 多一个，中位数是 queMin.top()</span>
        <span class="hljs-keyword">if</span> (queMin.<span class="hljs-built_in">size</span>() &gt; queMax.<span class="hljs-built_in">size</span>()) {
            <span class="hljs-keyword">return</span> queMin.<span class="hljs-built_in">top</span>();
        }
        <span class="hljs-comment">// 偶数个：取两个堆顶平均</span>
        <span class="hljs-keyword">return</span> (queMin.<span class="hljs-built_in">top</span>() + queMax.<span class="hljs-built_in">top</span>()) / <span class="hljs-number">2.0</span>;
    }
};
</code></pre>
<blockquote>
<p>🔍 <strong>为什么 <code>queMin</code> 允许多一个，而 <code>queMax</code> 不允许？</strong><br/>
这是设计选择！统一让 <code>queMin</code> 承担“多一个”的角色，简化逻辑。也可反过来，但需保持一致。</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">🧭 解题思路（分步拆解）</h2>
<ol>
<li>
<p><strong>明确目标</strong>：动态维护中位数，避免每次排序。</p>
</li>
<li>
<p><strong>选择数据结构</strong>：</p>
<ul>
<li>数组？→ 插入 O(n)，排序 O(n log n) → ❌</li>
<li>平衡二叉搜索树？→ 可行，但实现复杂（如 <code>multiset</code> + 双指针，见官方方法二）</li>
<li><strong>双堆</strong> → 插入 O(log n)，查询 O(1) → ✅ 最优</li>
</ul>
</li>
<li>
<p><strong>设计不变量</strong>：</p>
<ul>
<li>左堆（最大堆）存小的一半，右堆（最小堆）存大的一半</li>
<li>左堆大小 ≥ 右堆大小，且最多多1</li>
</ul>
</li>
<li>
<p><strong>处理插入</strong>：</p>
<ul>
<li>先按值决定放哪边</li>
<li>再调整堆大小以维持不变量</li>
</ul>
</li>
<li>
<p><strong>查询中位数</strong>：直接取堆顶，按奇偶判断</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-7">📊 算法分析</h2>





























<table><thead><tr><th>操作</th><th>时间复杂度</th><th>空间复杂度</th><th>说明</th></tr></thead><tbody><tr><td><code>addNum</code></td><td>O(log n)</td><td>O(n)</td><td>堆插入+可能的一次弹出</td></tr><tr><td><code>findMedian</code></td><td>O(1)</td><td>—</td><td>直接访问堆顶</td></tr><tr><td>总体</td><td>—</td><td>O(n)</td><td>存储所有数字</td></tr></tbody></table>
<blockquote>
<p>✅ 满足题目要求（5e4 次操作完全可行）</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">💡 面试延伸 &amp; 进阶思考</h2>
<h3 data-id="heading-9">Q1：为什么不用一个堆？</h3>
<blockquote>
<p>A：单个堆无法直接获取中位数。最大堆只能得最大值，最小堆只能得最小值。</p>
</blockquote>
<h3 data-id="heading-10">Q2：能否用 <code>multiset</code> + 双指针？</h3>
<blockquote>
<p>A：可以（官方方法二），但：</p>
<ul>
<li><code>multiset</code> 插入 O(log n)，但移动迭代器需小心边界</li>
<li>实际性能可能不如双堆（常数更大）</li>
<li><strong>双堆更简洁、更常用</strong></li>
</ul>
</blockquote>
<h3 data-id="heading-11">Q3：如果数据范围有限（如 0~100）？</h3>
<blockquote>
<p>A：可用<strong>计数排序 + 双指针</strong>（桶排序思想）：</p>
<ul>
<li>开数组 <code>cnt[101]</code> 记录每个数出现次数</li>
<li>维护总数量 <code>total</code></li>
<li>查询中位数时从 0 开始累加，找到第 <code>total/2</code> 和 <code>total/2+1</code> 个数</li>
<li><strong>时间复杂度：addNum O(1)，findMedian O(100)=O(1)</strong> → 极优！</li>
</ul>
</blockquote>
<h3 data-id="heading-12">Q4：如何扩展到求第 k 小/大元素？</h3>
<blockquote>
<p>A：可用 <strong>QuickSelect（期望 O(n)）</strong> ，但不支持动态插入。<br/>
动态场景下可用 <strong>Order Statistic Tree（GNU pbds）</strong> ，但非标准库。</p>
</blockquote>
<hr/>
<h2 data-id="heading-13">💻 完整可运行代码</h2>
<h3 data-id="heading-14">C++ 版本</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
<span class="hljs-keyword">using</span> ll = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MedianFinder</span> {
<span class="hljs-keyword">public</span>:
    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;, less&lt;<span class="hljs-type">int</span>&gt;&gt; queMin;
    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;, greater&lt;<span class="hljs-type">int</span>&gt;&gt; queMax;

    <span class="hljs-built_in">MedianFinder</span>() {}

    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span> </span>{
        <span class="hljs-keyword">if</span> (queMin.<span class="hljs-built_in">empty</span>() || num &lt;= queMin.<span class="hljs-built_in">top</span>()) {
            queMin.<span class="hljs-built_in">push</span>(num);
            <span class="hljs-keyword">if</span> (queMax.<span class="hljs-built_in">size</span>() + <span class="hljs-number">1</span> &lt; queMin.<span class="hljs-built_in">size</span>()) {
                queMax.<span class="hljs-built_in">push</span>(queMin.<span class="hljs-built_in">top</span>());
                queMin.<span class="hljs-built_in">pop</span>();
            }
        } <span class="hljs-keyword">else</span> {
            queMax.<span class="hljs-built_in">push</span>(num);
            <span class="hljs-keyword">if</span> (queMax.<span class="hljs-built_in">size</span>() &gt; queMin.<span class="hljs-built_in">size</span>()) {
                queMin.<span class="hljs-built_in">push</span>(queMax.<span class="hljs-built_in">top</span>());
                queMax.<span class="hljs-built_in">pop</span>();
            }
        }
    }

    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">findMedian</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (queMin.<span class="hljs-built_in">size</span>() &gt; queMax.<span class="hljs-built_in">size</span>()) {
            <span class="hljs-keyword">return</span> queMin.<span class="hljs-built_in">top</span>();
        }
        <span class="hljs-keyword">return</span> (queMin.<span class="hljs-built_in">top</span>() + queMax.<span class="hljs-built_in">top</span>()) / <span class="hljs-number">2.0</span>;
    }
};

<span class="hljs-comment">// 测试</span>
<span class="hljs-function"><span class="hljs-type">signed</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);
    cin.<span class="hljs-built_in">tie</span>(<span class="hljs-literal">nullptr</span>);
    cout.<span class="hljs-built_in">tie</span>(<span class="hljs-literal">nullptr</span>);

    MedianFinder medianFinder;
    medianFinder.<span class="hljs-built_in">addNum</span>(<span class="hljs-number">1</span>);    <span class="hljs-comment">// arr = [1]</span>
    medianFinder.<span class="hljs-built_in">addNum</span>(<span class="hljs-number">2</span>);    <span class="hljs-comment">// arr = [1, 2]</span>
    cout &lt;&lt; fixed &lt;&lt; <span class="hljs-built_in">setprecision</span>(<span class="hljs-number">5</span>) &lt;&lt; medianFinder.<span class="hljs-built_in">findMedian</span>() &lt;&lt; <span class="hljs-string">"\n"</span>; <span class="hljs-comment">// 输出 1.5</span>
    medianFinder.<span class="hljs-built_in">addNum</span>(<span class="hljs-number">3</span>);    <span class="hljs-comment">// arr = [1, 2, 3]</span>
    cout &lt;&lt; fixed &lt;&lt; <span class="hljs-built_in">setprecision</span>(<span class="hljs-number">5</span>) &lt;&lt; medianFinder.<span class="hljs-built_in">findMedian</span>() &lt;&lt; <span class="hljs-string">"\n"</span>; <span class="hljs-comment">// 输出 2.0</span>

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-15">JavaScript 版本（使用 MinPriorityQueue / MaxPriorityQueue）</h3>
<blockquote>
<p>⚠️ LeetCode JS 环境已内置 <code>@datastructures-js/priority-queue</code></p>
</blockquote>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">MedianFinder</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MaxPriorityQueue</span>(); <span class="hljs-comment">// 较小的一半，最大堆</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMax</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MinPriorityQueue</span>(); <span class="hljs-comment">// 较大的一半，最小堆</span>
};

<span class="hljs-title class_">MedianFinder</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">addNum</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">num</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">isEmpty</span>() || num &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">front</span>().<span class="hljs-property">element</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">enqueue</span>(num);
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queMax</span>.<span class="hljs-title function_">size</span>() + <span class="hljs-number">1</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">size</span>()) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMax</span>.<span class="hljs-title function_">enqueue</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">dequeue</span>().<span class="hljs-property">element</span>);
        }
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMax</span>.<span class="hljs-title function_">enqueue</span>(num);
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queMax</span>.<span class="hljs-title function_">size</span>() &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">size</span>()) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">enqueue</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">queMax</span>.<span class="hljs-title function_">dequeue</span>().<span class="hljs-property">element</span>);
        }
    }
};

<span class="hljs-title class_">MedianFinder</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">findMedian</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">size</span>() &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMax</span>.<span class="hljs-title function_">size</span>()) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">front</span>().<span class="hljs-property">element</span>;
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queMin</span>.<span class="hljs-title function_">front</span>().<span class="hljs-property">element</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">queMax</span>.<span class="hljs-title function_">front</span>().<span class="hljs-property">element</span>) / <span class="hljs-number">2.0</span>;
};
</code></pre>
<hr/>
<h2 data-id="heading-16">🌟 本期完结，下期见！🔥</h2>
<blockquote>
<p>👉 点赞收藏加关注，新文更新不迷路。关注专栏【算法】LeetCode Hot100刷题日记，持续为你拆解每一道热题的底层逻辑与面试技巧！</p>
<p>💬 <strong>欢迎留言交流你的解法或疑问！一起进步，冲向 Offer！💪</strong></p>
</blockquote>
<p>📌 <strong>记住</strong>：当你在刷题时，不要只看答案，要像写这篇文章一样，深入思考每一步背后的原理、优化空间和面试价值。这才是真正提升算法能力的方式！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[一文读懂 Skills｜从概念到实操的完整指南]]></title>    <link>https://juejin.cn/post/7599528186586595338</link>    <guid>https://juejin.cn/post/7599528186586595338</guid>    <pubDate>2026-01-26T10:27:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599528186586595338" data-draft-id="7599485473707245606" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="一文读懂 Skills｜从概念到实操的完整指南"/> <meta itemprop="keywords" content="Trae"/> <meta itemprop="datePublished" content="2026-01-26T10:27:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="TRAE_ai"/> <meta itemprop="url" content="https://juejin.cn/user/3048259110571032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            一文读懂 Skills｜从概念到实操的完整指南
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3048259110571032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    TRAE_ai
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:27:18.000Z" title="Mon Jan 26 2026 10:27:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读16分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/498562aa9ed8432ba9e87cda7d4a062e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=8yAuhMePtapSu%2FGOazhGCXYsOOU%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>本文作者：咸鱼，TRAE 开发者用户</p>
</blockquote>
<blockquote>
<p>Agent 正在经历从“聊天机器人”到“得力干将”的进化，而 <strong>Skills</strong> 正是这场进化的关键催化剂。</p>
<p>你是否曾被 Agent 的“不听话”、“执行乱”和“工具荒”搞得焦头烂额？</p>
<p>本文将带你一文弄懂 <strong>Skills</strong> ——这个让 Agent 变得可靠、可控、可复用的“高级技能包”。</p>
<p>我们将从 Skills 是什么、如何工作，一路聊到怎样写好一个 Skills，并为你推荐实用的社区资源，带领大家在 TRAE 中实际使用 Skills 落地一个场景。</p>
<p>无论你是开发者还是普通用户，都能在这里找到让你的 Agent “开窍”的秘诀。</p>
</blockquote>
<p><strong>你是否也经历过或者正在经历这样的“ Agent 调教”崩溃时刻？</strong></p>
<ul>
<li>
<p><strong>规则失效：</strong> 在 Agent.md 里写下千言万语，Agent 却视若无睹，完全“已读不回”。</p>
</li>
<li>
<p><strong>执行失控：</strong> 精心打磨了无数 Prompt，Agent 执行起来依旧像无头苍蝇，混乱无序。</p>
</li>
<li>
<p><strong>工具迷失：</strong> 明明集成了强大的 MCP 工具库，Agent 却两手一摊说“没工具”，让人摸不着头脑。</p>
</li>
</ul>
<p>如果这些场景让你感同身受，别急着放弃。<strong>终结这场混乱的答案，可能就是 Skills。</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e689cd9039c147278c306e13ec24004b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=rQmSbPXhzErYNi1J59HU%2BG28NpE%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0"><strong>什么是 Skills</strong></h2>
<p>“Skills” 这个概念最早由 Anthropic 公司提出，作为其大模型 Claude 的一种能力扩展机制。简单来说，它允许用户为 Claude 添加自定义的功能和工具。随着这套做法越来越成熟，并被社区广泛接受，Skills 如今已成为大多数 Agent 开发工具和 IDE 都支持的一种标准扩展规范。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30a3492ffbfb4f8c86543ba47e2714c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=ZAMUCjEIT1Qsuj9AL5ySwVGdSDg%3D" alt="" loading="lazy"/></p>
<p>一个 Skills 通常以一个文件夹的形式存在，里面主要装着三样东西：<strong>一份说明书（SKILL.md）、一堆操作脚本（Script）、以及一些参考资料（Reference）。</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfdff3d6d6954816a0947ee5d3625652~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=sfdkPQw4lDQu9Z0no9AlRw67wPE%3D" alt="640 (1).png" loading="lazy"/></p>
<p>你可以把一个 Skill 想象成一个打包好的“技能包”。它把完成某个特定任务所需的<strong>领域知识、操作流程、要用到的工</strong> <strong>具、以及最佳实践</strong>全都封装在了一起。当 AI 面对相应请求时，就能像一位经验丰富的专家那样，有条不紊地自主执行。</p>
<p><strong>一句话总结：</strong> 要是把 Agent 比作一个有很大潜力的大脑，那 <strong>Skills 就像是给这个大脑的一套套能反复用的“高级武功秘籍”。</strong> 有了它，Agent 能从一个“什么都略知一二”的通才，变成在特定领域“什么都擅长”的专家。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2a8152998b547a08a8a54e8b8459b38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=YXPCIbBAv5x0stu2X3HnINwDbqk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1"><strong>Skill 原理介绍</strong></h2>
<p>📚 官方解释：<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.claude.com%2Fdocs%2Fen%2Fagents-and-tools%2Fagent-skills%2Foverview" target="_blank" title="https://platform.claude.com/docs/en/agents-and-tools/agent-skills/overview" ref="nofollow noopener noreferrer">platform.claude.com/docs/en/age…</a></p>
<h4 data-id="heading-2"><strong>Skill 的架构原理：渐进式加载</strong></h4>
<p>Skill 的设计很巧妙，它运行在一个沙盒环境里，这个环境允许大模型访问文件系统和执行 <em><strong>bash</strong></em> 命令（可以理解为一种电脑操作指令）。在这个环境里，一个个 Skill 就像一个个文件夹。Agent 就像一个熟悉电脑操作的人，通过命令行来读取文件、执行脚本，然后利用结果去完成你交代的任务。这种“按需取用”的架构，让 Skill 成为一个既强大又高效的“工具箱”。</p>
<p>为了平衡效果和效率，Skill 设计了一套聪明的三层分级加载机制：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fde448de57f540409d9264c41d82cb2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=ovVLGJjnunTuBQBwoHOtruHUCEc%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f254ff2a09d2490fbfcb8147c257b216~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=mBe29p0fLEw%2BVAU6tX%2B6aHe694M%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-3"><strong>Level 1：元数据（始终加载）</strong></h4>
<p>元数据就像是 Skill 的“名片”，里面有名称（<em><strong>name</strong></em>）和描述（<em><strong>description</strong></em>），是用 YAML 格式来定义的。Claude 在启动的时候，会把所有已经安装的 Skill 的元数据都加载进来，这样它就能知道每个 Skill 有什么用、什么时候该用。因为元数据很轻量，所以你可以安装很多 Skill，不用担心把上下文占满。</p>
<h4 data-id="heading-4"><strong>Level 2：说明文档（触发时加载）</strong></h4>
<p><em><strong>SKILL.md</strong></em> 文件的正文就是说明文档，里面有工作流程、最佳实践和操作指南。只有用户的请求和 Skills 元数据里的描述相符时，Claude 才会用 <em><strong>bash</strong></em> 指令读取这份文档，把内容加载到上下文里。这种“触发式加载”能保证只有相关的详细指令才会消耗 Token。</p>
<h4 data-id="heading-5"><strong>Level 3：资源与代码（按需加载）</strong></h4>
<p>Skills 还能打包一些更深入的资源，比如更详细的说明文档（<em><strong>FORMS.md</strong></em>）、可执行脚本（ <em><strong>.py</strong></em>）或者参考资料（像 API 文档、数据库结构等）。Claude 只有在需要的时候，才会通过 <em><strong>bash</strong></em> 去读取或执行这些文件，而且脚本代码本身不会进入上下文。这样一来，Skills 就能捆绑大量信息，几乎不会增加额外的上下文成本。</p>
<h3 data-id="heading-6"><strong>Skills 的调用逻辑：从理解意图到稳定执行</strong></h3>
<p>那么，Agent 是如何智能地选择并执行一个 Skill 的呢？整个过程就像一位经验丰富的助理在处理工作：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56d095ed53234caca572363ae4de6a9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=%2FAivTlcRt5aFuEPnrm2Mv2vPQT0%3D" alt="" loading="lazy"/></p>
<ol>
<li>
<p><strong>意图匹配（找到对的人）：</strong> Agent 首先聆听你的需求，然后快速扫一眼自己手头所有 Skill 的“名片夹”（元数据），寻找最匹配的那一张。</p>
</li>
<li>
<p><strong>读取手册（看懂怎么干）：</strong> 找到合适的 Skills 后，Agent 会像模像样地翻开它的“操作手册”（<em><strong>SKILL.md</strong></em>），仔细研究详细的执行步骤和注意事项。</p>
</li>
<li>
<p><strong>按需执行（动手开干）：</strong> 根据手册的指引，Agent 开始工作。如果需要，它会随时从“工具箱”里拿出脚本或工具来完成具体操作。</p>
</li>
<li>
<p><strong>反馈结果（事毕复命）：</strong> 任务完成后，Agent 向你汇报最终结果，或者在遇到困难时，及时向你请教。</p>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be94cd4da1f84612aab5a51c9ad0891f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=kfzTOJ2f%2FrSvosdXCKwQ1jG775o%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7"><strong>Skills  vs.  其他概念的区别</strong></h2>
<p>为了更清晰地理解 Skills 的独特价值，我们不妨把它和另外两个容易混淆的概念——<strong>快捷指令（Command）</strong> 和<strong>原子工具（MCP）</strong> ——放在一起做个对比。用一个厨房的例子就很好懂了：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46415a2bb9a74a72b49cd886e62cbb8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=H6Rn5XSrDc5azaMkgyh32pCPQ3A%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b51047922b214010b0b7d886fa290af8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=iizVN7MLxbJ5Loaksvy%2BDDA07yw%3D" alt="" loading="lazy"/></p>
<p>我们也列举了几个大家容易混淆的其他功能，一起来对比看看。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ae20becf7a54b9c8dd9d689096c4ada~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=umQTI6W%2FXB%2BHCsNqSPZHqhqcr1g%3D" alt="" loading="lazy"/></p>
<p>📚 官方博客解释：<a href="https://link.juejin.cn?target=https%3A%2F%2Fclaude.com%2Fblog%2Fskills-explained" target="_blank" title="https://claude.com/blog/skills-explained" ref="nofollow noopener noreferrer">claude.com/blog/skills…</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0526612b042f4c788613b5eac6bc5155~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=Q6da1excp3hmiXA8pHZF9Zkkrno%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8"><strong>什么是好的 Skills：从“能用”到“好用”</strong></h2>
<p><strong>Good Skills vs Bad Skills</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/260567fa689b4cd0be8befc0ddfdfcb8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=G1LvLKremMuB9DqfpkHT%2FwMoPmM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9"><strong>如何写好 Skills</strong></h3>
<ol>
<li>
<p><strong>原子性（Atomicity）：</strong> 坚持单一职责，让每个 Skill 都像一块积木，小而美，专注于解决一个具体问题，便于日后的复用和组合。</p>
</li>
<li>
<p><strong>给例子（Few-Shot Prompting）：</strong> <strong>这是最关键的一点</strong>，与其费尽口舌解释，不如直接给出几个清晰的输入输出示例。榜样的力量是无穷的，模型能通过具体例子，秒懂你想要的格式、风格和行为。</p>
</li>
<li>
<p><strong>立规矩（Structured Instructions）：</strong></p>
<p><strong>1) 定角色：</strong> 给它一个明确的专家人设，比如“你现在是一个资深的市场分析师”。</p>
<p><strong>2) 拆步骤：</strong> 把任务流程拆解成一步步的具体指令，引导它“思考”。</p>
<p><strong>3) 画红线：</strong> 明确告诉它“不能做什么”，防止它天马行空地“幻觉”</p>
</li>
<li>
<p><strong>造接口（Interface Design）：</strong> 像设计软件 API 一样，明确定义 Skill 的输入参数和输出格式（比如固定输出 JSON 或 Markdown）。这让你的 Skill 可以被其他程序稳定调用和集成。</p>
</li>
</ol>

<ol start="5">
<li><strong>勤复盘（Iterative Refinement）：</strong> 把 Skills 当作一个产品来迭代。在实际使用中留心那些不尽如人意的“Bad Case”，然后把它们变成新的规则或反例，补充到你的 Skills 定义里，让它持续进化，越来越聪明、越来越靠谱。</li>
</ol>
<p>📚 一些官方最佳实践指南 <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.claude.com%2Fdocs%2Fzh-CN%2Fagents-and-tools%2Fagent-skills%2Fbest-practices" target="_blank" title="https://platform.claude.com/docs/zh-CN/agents-and-tools/agent-skills/best-practices" ref="nofollow noopener noreferrer">platform.claude.com/docs/zh-CN/…</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90124ad767404c5da449c53d544012aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=urA0pky4RXmFjJIVB1Ho8wnJb%2Fo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10"><strong>社区热门 Skills 推荐</strong></h2>
<p>刚开始接触 Skills，不知从何下手？不妨从社区沉淀的这些热门 Skills 开始，寻找灵感，或直接在你的工作流中复用它们。</p>
<h3 data-id="heading-11"><strong>Claude 官方提供的 Skills</strong></h3>
<p>📚 官方 Skills 仓库  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills" target="_blank" title="https://github.com/anthropics/skills" ref="nofollow noopener noreferrer">github.com/anthropics/…</a></p>
<p>学习 Claude 官方的 Skills 仓库可以帮助我们最快的了解 Skills 的最佳实践，便于我们沉淀出自己的 Skills。</p>
<blockquote>
<p><strong>如何快速使用官方 Skills？</strong></p>
<p>大多数官方 Skills 都能直接下载，或者通过 Git 克隆到本地。在 TRAE 等工具里，一般只需把这些 Skills 的文件夹放到指定的 <em><strong>Skills</strong></em> 目录，接着重启或刷新 Agent，它就会自动识别并加载这些新能力。具体操作可参考工具的使用文档。</p>
<p>更多细节可参考下面这部分内容：<strong>如何在 TRAE 里快速用起来</strong></p>
</blockquote>
<p><strong>Claude 官方提供的 Skills 列表</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d3df5f253864939bfefa0c7ef8b5852~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=jbuN31Rn4gWzYgvofxBB0YIqWr0%3D" alt="show_679493203_1769422730184.png" loading="lazy"/></p>
<h3 data-id="heading-12"><strong>社区其他最佳实践</strong></h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e34611085a1c475bb4b2f26285f21bca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=EdlPHC3DgsQUx3M2B%2BbVa%2FhNCa8%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/530b1a02e08f45e18af7f7b78cf14941~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=a1gu3tF9yc%2FZSIU6omjYanf8yO8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-13"><strong>如何在 TRAE 里快速使用</strong></h2>
<p>理论说再多，不如亲手一试。我们先讲一下如何在 TRAE SOLO 中创建并应用一个 Skill 并以基于飞书文档的 Spec Coding 为例讲解一下如何利用 Skills 快速解决一个实际问题。</p>
<h3 data-id="heading-14"><strong>Skill 创建</strong></h3>
<p><strong>方式一：设置中直接创建</strong></p>
<p>TRAE 支持在设置页面可以快速创建一个 Skill</p>
<p>按下快捷键 Cmd +/ Ctrl + 通过快捷键打开设置面板。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6894be68150545ddafcf6a2aed27535f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=TYNNesb3q6i7yffMCBgn9CyPTM0%3D" alt="" loading="lazy"/></p>
<p>在设置面板左侧找到「规则技能」选项</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec94a84497d24c56b026679c6bd190b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=5itKsgX1rjNRS2%2FJde7bVO9O4T8%3D" alt="" loading="lazy"/></p>
<p>找到技能板块，点击右侧的「创建」按钮。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39b8d09b9a29433ca09059bae34c9f18~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=r0T71CKdS%2FIy3Ky3cX%2FGqrGANQw%3D" alt="" loading="lazy"/></p>
<p>你会看到一个简洁的创建界面，包含三要素：<strong>Skill 名称、Skill 描述、Skill 主体</strong>。我们以创建一个“按规范提交 git commit”的 Skill 为例，填入相应内容后点击「确认」即可。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b45f17d81c4b4c1083bd0c3a209a6927~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=epgAmv7m272oFkGSweS3o4hjhmU%3D" alt="" loading="lazy"/></p>
<p>填入我们需要的内容「确认」即可</p>
<p><strong>方式二：直接解析 SKILL.md</strong></p>
<p>在当前项目目录下，新增目录.<em><strong>trae/Skills/xxx</strong></em> 导入你需要文件夹，和 TRAE 进行对话，即可使用。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b54f715d553d4c68b517da01516f94e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=Ezz0ssjg2toioy99GRMnaRy5tx0%3D" alt="" loading="lazy"/></p>
<p>可以在「设置 - 规则技能」中看到已经成功导入</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbc7108b9e804a7680d0ceea27012dfa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=nugFbLMyBtdfy%2B4J1ycjChfUYdE%3D" alt="" loading="lazy"/></p>
<p><strong>方式三：在对话中创建</strong></p>
<p>目前 TRAE 中内置了 Skills-creator Skills ，你可以在对话中直接和 TRAE 要求创建需要的 Skills</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b10a41b1e3b4ac1841e9c908c4a4c37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=bmyFQIg0HGR5ulMwl9TZbLOtAJc%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-15"><strong>Skill 使用</strong></h3>
<p>在 TRAE 里使用技能很容易，你加载好需要的技能后，只需在对话框中用日常语言说明你的需求就行。</p>
<ul>
<li>
<p>例如，输入“帮我设计一个有科技感的登录页面”，系统就会自动调用“frontend-design”技能。</p>
</li>
<li>
<p>例如，输入“帮我提取这个 PDF 里的所有表格”，系统会自动调用“document-Skills/pdf”技能。</p>
</li>
<li>
<p>例如，输入“帮我把这片技术文档转为飞书文档”，系统会自动调用“using-feishu-doc”技能。</p>
</li>
</ul>
<p>系统会自动分析你的需求，加载技能文档，还会一步步指导你完成任务！</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5175bab9f2b4529b0f54eac980ae4e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=PfyED%2BwpHDPFoCnxTOJO7oe1RAE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-16"><strong>实践场景举例</strong></h3>
<p>还记得引言里提到的那些问题吗？比如说，项目规则文件（<em><strong>project_rules</strong></em>）有字符数量的限制；又或者，就算你在根规则文件里明确写好了“在什么情况下读取哪个文件”，Agent 在执行任务时也不会按照要求来做。</p>
<p>这些问题的根本原因是，<strong>规则（Rules）对于 Agent 而言是固定不变的</strong>，它会在任务开始时就把所有规则一次性加载到上下文中，这样既占用空间，又不够灵活。而 <strong>技能（Skill）采用的是“逐步加载”的动态方式</strong>，刚好可以解决这个问题。所以，我们可以把之前那些复杂的规则场景，重新拆分成一个个独立的技能。</p>
<p><strong>接下来，我们通过一个基于飞书文档的“Spec Coding”简单流程，来实际操作一下如何用技能解决问题。</strong></p>
<h4 data-id="heading-17"><strong>什么是 Spec Coding？</strong></h4>
<p>Spec Coding 提倡“先思考后行动”，也就是通过详细定义可以执行的需求规范（Specification）来推动 AI 开发。它的流程包含“需求分析、技术设计、任务拆解”的文档编写过程，最后让 AI 根据规范来完成编码。这种一步步的工作流程能保证每一步都有依据，实现从需求到代码的准确转化。</p>
<p><strong>让我来分析一下这个场景</strong></p>
<p>上面提到将开发过程划分为四个关键阶段，所以要完成 “需求分析、技术设计、任务拆解” 的飞书文档撰写，还有最终的代码实现。为此，我们需要不同的技能来满足不同场景下的文档编写需求，并且要教会 Agent 如何使用飞书工具进行创作协同。</p>
<p><strong>下面我们就一起完成上面提到的 Skills 的设计实现。</strong></p>
<h4 data-id="heading-18"><strong>多角色专家 Skills</strong></h4>
<p>通过实现多角色 Skills 通过创建多个交付物过程文档，约束后续的编码，为编码提供足够且明确的上下文，每个Skill 专注完成一件事</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3af5b203e7e446cbb42409995896ef7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=x2DJMDCBO%2FKvmlfA8f5nD4EIO%2BM%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>下面让我们进一步详细设计</strong></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbbbe68dfda9491798c69f32a084deb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=whcmN6%2B0R4rMiB19SW6pl38vBOc%3D" alt="" loading="lazy"/></p>
<p>按照上述的表格我们就可以大致明确我们需要的 Skills 该如何实现了。</p>
<ul>
<li>本次只作为一个例子大家可以参考上面创建 Skill 的教程自己完成一下这个多角色 Skills 的创建和调试，当然正如上面所述好的 Skill 需要在实践中逐渐优化并通过场景调用不断进行优化的</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/046c201b33704525a24d8d32fdca1e9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=tx2MC2Em5jcPSBfbk%2BaJO0SNNZc%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9a0bcd187364746b74ee2f272c8d73a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=2tTeQMuH9IxdOP3XQlLvdlVWWLo%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-19"><strong>飞书文档使用 Skill</strong></h4>
<p>飞书文档的格式是 markdown 的超集，<strong>我们 Skill 的目的则是教会 Agent 飞书文档的语法</strong>，便于 Agent 写出符合格式的 md 文件。并通过约束 Agent 行为，<strong>充分利用飞书文档的评论的读写完成多人协作审阅的过程</strong>，用户通过在飞书文档评论完成相关建议的提出，Agent 重新阅读文档和评论，根据建议进一步优化文档，<strong>实现文档协作工作流。</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/330f2aeb47764d91b04fb728d4464f08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=VejIhkIHalFsBne1uvVTRCaw5UM%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-20"><strong>Spec Coding Skill</strong></h4>
<p>上面我们实现了多个角色 Skills 和一个功能 Skill，但实际使用时，还需要有一个能统筹全局的技能，来实现分工协作。把上述多个技能组合起来，告诉智能体（agent）整体的规格编码（spec coding）流程，完成工具技能和角色技能的组合与调度。</p>
<p>如此我们就能快速搭建一个规格编码工作流程，完成基础开发。当然也可以参考上面的逻辑，用技能来重新复刻社区里的规格编码实践（如 SpecKit、OpenSpec 等）。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5701078e580497895f98d1efd77d5d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=vq%2BTCQxE%2F6DhdQKDYt7WFoPGPUw%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7925bbc8e2d14f1b80591c4e60cc2176~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=oGg%2BqMgLQuYpKDdZUviIUAze4Pc%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-21"><strong>总结</strong></h4>
<p>上述场景提到了两种不同风格的 Skill（角色型，工具型），利用 <strong>Skill 的动态加载机制</strong>（取代固定规则的一次性加载方式），完成了复杂场景下的任务分解；通过 <strong>不同角色技能的分工协作</strong>（避免 Agent 什么都做导致执行混乱）；尝试借助<strong>飞书文档形成协作闭环</strong>（打通人机交互的最后一步），有效解决了 Agent “不听话、执行乱、工具少” 的问题，让 AI 从 “对话助手” 真正转变为 “可信赖的实干家”，实现从需求提出到代码产出的高效、精准、协作式交付。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/580d8eed249c4a98ae1233f298611cff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=s2iEalF5pfkW%2Fe6eCvci1rjS7tE%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-22"><strong>Q &amp; A | 一些常见问题</strong></h2>
<h3 data-id="heading-23"><strong>为什么我写的 Skills 不生效，或者效果不符合预期？</strong></h3>
<p><strong>那十有八九是你的“名片”（</strong> <em><strong>Description</strong></em> <strong>）没写好。</strong></p>
<p>记住，Agent 是通过读取 Skills 的 <em><strong>Description</strong></em> 来判断“什么时候该用哪个 Skill”的。要是你的描述写得含糊不清、太专业或者太简单，Agent 就很难明白你的意思，自然在需要的时候就不会调用这个 Skill。所以，<strong>用大白话写的清晰、准确的</strong> <em><strong>Description</strong></em> <strong>，对 Skill 能否起作用至关重要。</strong></p>
<h3 data-id="heading-24"><strong>使用 Skills 的效果，会受到我选择的大语言模型（LLM）的影响吗？</strong></h3>
<p><strong>会有影响，不过影响的方面不一样。</strong></p>
<ul>
<li>
<p><strong>一个更强大的模型，主要影响“挑选”和“安排”技能的能力。</strong> 它能更准确地明白你的真实想法，然后从一堆技能里挑出最适合的一个或几个来解决问题。它的优势体现在制定策略方面。</p>
</li>
<li>
<p><strong>而技能本身，决定了具体任务执行的“最低水平”和“稳定性”。</strong> 一旦某个技能被选中，它里面设定好的流程和代码是固定的，会稳定地运行。所以，技能编写得好不好，直接决定了具体任务能不能出色完成。。</p>
</li>
</ul>
<h3 data-id="heading-25"><strong>Skills 是不是万能的？有什么它不擅长做的事情吗？</strong></h3>
<p><strong>当然不是万能的。</strong> Skills 的主要优势是<strong>处理那些流程明确、边界清晰的任务。</strong> 在下面这些情况中，它可能就不是最好的选择了：</p>
<ul>
<li>
<p><strong>需要高度创造力的任务：</strong> 像写一首饱含情感的诗，或者设计一个全新的品牌标志。这类工作更需要大模型本身的“灵感”。</p>
</li>
<li>
<p><strong>需要实时、动态做决策的复杂策略游戏：</strong> 比如在变化极快的金融市场中做交易决策。</p>
</li>
<li>
<p><strong>单纯的知识问答或开放式闲聊：</strong> 如果你只是想问“文艺复兴三杰是谁？”，直接问大模型就可以，不用动用 Skills 这个“大杀器”。</p>
</li>
</ul>
<h3 data-id="heading-26"><strong>我发现一个社区的 Skills 很好用，但我可以修改它以适应我的特殊需求吗？</strong></h3>
<p><strong>当然可以，我们强烈建议你这么做！</strong></p>
<p>大多数共享的 Skill 都支持用户“Fork”（也就是“复制一份”）并进行二次开发。你可以把通用的 Skill 当作模板，在自己的工作空间里复制一份，然后修改里面的逻辑或参数，以适应你自己的业务需求。这对整个生态的共建和知识复用很重要。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0c2dfe38cb3454f81679a9548f08458~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028042&amp;x-signature=cJCENj%2BpTeNPQE468eNnku7SJfc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-27"><strong>结语｜让 Agent 成为你真正的“行动派”</strong></h2>
<p>Skill 的出现，为 AI 从“对话式助手”转变为“可信赖的执行者”搭建了关键的技术桥梁。它用结构化的方法把领域知识、操作流程和工具调用逻辑封装起来，解决了 Agent 规则失效、执行失控的混乱问题，让 AI 的能力输出变得可以控制、值得信赖且高效。</p>
<p>Skill 的核心价值在于：</p>
<ul>
<li>
<p><strong>精准实际痛点：</strong> 通过巧妙的三级加载机制（元数据→说明文档→资源）平衡上下文效率与功能深度，在功能深度和上下文效率之间找到了一个绝佳的平衡点，既避免了宝贵 Token 的浪费，又确保了任务执行的精准性，实现了 Agent 上下文的动态加载能力。</p>
</li>
<li>
<p><strong>生态赋能，降低门槛：</strong> 无论是官方还是社区，都提供了丰富的资源（如 Claude 官方仓库、SkillsMP 市场等），让普通用户也能轻松站在巨人的肩膀上，快速复用各种成熟的能力。</p>
</li>
</ul>
<p>虽然 Skill 不是万能的，但它在“确定性流程任务”上的优势无可替代。未来，随着 AI 模型能力的提升与 Skill 生态的进一步完善，我们有望看到更多跨领域、可组合的 Skill 出现——<strong>让 AI 从“样样懂一点”的通才，真正进化为“事事做得好”的专家协作伙伴。</strong></p>
<p><strong>不妨从今天开始，尝试创建你的第一个 Skill：将你最擅长的领域经验封装成可复用的能力，让 AI 成为你延伸专业价值的放大器。</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[为什么 ES 的搜索结果只到 10,000？强制“数清楚”的代价有多大]]></title>    <link>https://juejin.cn/post/7599514071104765967</link>    <guid>https://juejin.cn/post/7599514071104765967</guid>    <pubDate>2026-01-26T10:33:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599514071104765967" data-draft-id="7599220371666272296" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="为什么 ES 的搜索结果只到 10,000？强制“数清楚”的代价有多大"/> <meta itemprop="keywords" content="搜索引擎"/> <meta itemprop="datePublished" content="2026-01-26T10:33:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="阿里云大数据AI技术"/> <meta itemprop="url" content="https://juejin.cn/user/2414974667341287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            为什么 ES 的搜索结果只到 10,000？强制“数清楚”的代价有多大
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2414974667341287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    阿里云大数据AI技术
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:33:09.000Z" title="Mon Jan 26 2026 10:33:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>“为什么搜出来的结果总数永远是 10,000？是不是数据丢了？”</p>
</blockquote>
<p>这是每一个 Elasticsearch 新手在 7.x 版本之后都会遇到的“灵魂发问”。</p>
<p>而在得知“这是 ES 的默认性能优化”后，绝大多数人的第一反应往往是抗拒：“我不想要优化，我要精准的数字！老板要看，前端分页也要用。”</p>
<p>于是，在许多项目的代码库里，我们都能看到这样一行“补丁”：</p>
<p><code>"track_total_hits": true</code></p>
<p>数字终于准了，变成了 854,321，大家都很满意。</p>
<p>但没人注意到，就在这行代码生效的瞬间，集群的 CPU 占用率可能直接翻倍，查询延迟从 20ms 劣化到了 500ms。</p>
<p>为什么一个简单的“计数”，会成为拖垮集群性能的隐形杀手？</p>
<p>今天，我们不谈玄学，从 Lucene 底层原理 层面，揭秘这背后的代价。</p>
<h2 data-id="heading-0">现象：消失的“尾部数据”</h2>
<p>在 ES 7.0 之前，查询默认会算出精确总数。但在 7.0 之后，默认的响应体变成了这样：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"hits"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"total"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10000</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"relation"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gte"</span>  <span class="hljs-comment">// 注意：Greater Than or Equal to (大于等于)</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    ...
<span class="hljs-punctuation">}</span>
</code></pre>
<p>这不仅是一个数字的变化，更是搜索引擎检索逻辑的根本性范式转移：</p>
<p>从“找出所有匹配文档”进化为“只找出最有价值的 Top N”。</p>
<h2 data-id="heading-1">深度解析：Block-Max WAND 算法的智慧</h2>
<p>要理解为什么“数不准”能带来性能飞跃，必须深入 Lucene 的底层，了解 Block-Max WAND (BMW) 算法。</p>
<h3 data-id="heading-2">1. 倒排索引的物理结构：Block</h3>
<p>在 Lucene 的倒排索引（Inverted Index）中，一个 Term（词项）对应的 Postings List（文档 ID 列表）并不是一整条长链，而是被切分成了多个 Block（块），通常包含 128 个文档 ID。</p>
<p>关键点在于：</p>
<p>每个 Block 都有一个 Block Header，里面记录了这个块的元数据，其中最重要的一个是：</p>
<p>Max Score（块内最大分数）：即这个 Block 里所有文档中，能产生的最高相关性得分是多少。</p>
<h3 data-id="heading-3">2. 竞速机制：Min Competitive Score</h3>
<p>当 ES 执行查询（比如查询“手机”）并索要 Top 10 结果时，它会维护一个 最小竞争分数（Min Competitive Score）。</p>
<ul>
<li>
<p>刚开始，Top 10 没满，最小竞争分数是 0。</p>
</li>
<li>
<p>随着扫描进行，找到了 10 个文档，第 10 名的分数是 5.0。</p>
</li>
<li>
<p>此时，最小竞争分数变成了 5.0。意味着：任何分数低于 5.0 的文档，连进决赛圈的资格都没有。</p>
</li>
</ul>
<h3 data-id="heading-4">3. “隔山打牛”的跳跃优化</h3>
<p>接下来，神奇的事情发生了。</p>
<p>当遍历指针来到下一个 Block（假设包含 ID 1000-1127）时，算法不需要解压这个 Block，也不需要计算具体的文档分数，而是直接看 Block Header：</p>
<blockquote>
<p>算法拷问： “这个 Block 的 Max Score 是多少？”Block 回答： “最高只能得 4.5 分。”算法判断： “现在的门槛（Min Competitive Score）已经是 5.0 了。你这个 Block 里的文档全是‘废柴’，整个 Block 直接跳过！”</p>
</blockquote>
<p>结果： ES 可能直接跳过了数百万个低分文档。</p>
<p>代价： 因为跳过了，ES 根本不知道刚才那个 Block 里有几个文档匹配（虽然分低，但确实匹配）。所以，它无法给出精确的总数。</p>
<h2 data-id="heading-5">隐形陷阱：为什么关了 track_total_hits 依然慢？</h2>
<p>你以为把 track_total_hits 设为 false 就万事大吉了？</p>
<p>别天真了。 在某些特定场景下，即使你显式关闭了计数，ES 依然无法使用 Block-Max WAND 进行剪枝，查询性能依然会很差。</p>
<p>这就好比你告诉司机“不用数路边有几棵树（不计数）”，但你同时又下令“把路边每棵树的叶子都摘一片下来（聚合）”。司机虽然不用数数，但他依然得停在每一棵树下。</p>
<h3 data-id="heading-6">1. 聚合（Aggregations）：WAND 的天敌</h3>
<p>WAND 算法的核心奥义是 “Skipping（跳过）”。</p>
<p>而聚合（Aggregations）的核心诉求是 “Traversing（遍历）”。</p>
<p>如果你在查询中包含任何聚合（例如 <code>terms</code>、<code>avg</code>、<code>date_histogram</code>），ES 必须访问所有匹配的文档来计算统计值。</p>
<ul>
<li>
<p>冲突点：你不能跳过一个 Block，因为那个被跳过的 Block 里可能包含聚合所需的数据。</p>
</li>
<li>
<p>结果：WAND 优化被迫关闭，全量扫描不可避免。</p>
</li>
</ul>
<h3 data-id="heading-7">2. 排序与分数的纠结（Sort + track_scores）</h3>
<p>Block-Max WAND 依赖于 Max Score 来进行跳跃。</p>
<ul>
<li>
<p>场景：你按时间排序 (<code>sort: [{"timestamp": "desc"}]</code>)。</p>
</li>
<li>
<p>陷阱：如果你手滑加了 <code>track_scores: true</code>（或者某些 Client 默认开启）。</p>
</li>
<li>
<p>后果：虽然是按时间排序，但因为你强行索要 <code>_score</code>，ES 必须对每个文档计算分数，导致无法利用 BKD Tree 的索引顺序进行快速跳跃，也难以通过 WAND 进行分数剪枝（因为排序不是按分数排的）。</p>
</li>
</ul>
<h2 data-id="heading-8">代价：track_total_hits 如何摧毁性能</h2>
<p>口说无凭，数据为证。我们在 Serverless 8.17 环境下，创建一个6分片1副本的索引，写入约 2 亿条 脱敏文档，总计约30G数据，查询qps控制在30 。用实测结果向你展示——track_total_hits 取不同值时的cu消耗及响应时长：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b42c37cdd0db4318af44b2873e09607b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028389&amp;x-signature=%2Bz8vTJtg6%2BJbxbAYMp85ITEtTr4%3D" alt="" loading="lazy"/></p>
<p>CPU 资源消耗对比(true,false,10000)</p>
<p>​<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d01ffef0e164ba09662dc008a1a59c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028389&amp;x-signature=8f4n1YHNv0N03LNaG8Y9Msihm%2FM%3D" alt="" loading="lazy"/></p>
<p>平均耗时和 P95 耗时对比(true,false,10000)</p>
<p>当你加上 "track_total_hits": true 时，你实际上是在对底层引擎下达一道“死命令”：</p>
<p>“禁用 Block-Max WAND 优化，禁止跳过任何一个 Block。”这带来的性能崩塌是显著的。</p>
<h3 data-id="heading-9">1. CPU 的燃烧（计算密集）</h3>
<ul>
<li>
<p>优化模式：只解压和计算高分 Block。</p>
</li>
<li>
<p>强制计数：必须解压所有匹配的 Block（使用 Frame Of Reference 编码），并对每一个文档 ID 进行解码和比对。</p>
</li>
<li>
<p>量级差异：如果查询匹配 1 亿条数据，原本只需计算 Top 1000 的分数，现在必须计算 1 亿次。CPU 消耗可能增加几个数量级。</p>
</li>
</ul>
<h3 data-id="heading-10">2. I/O 的雪崩（访存密集）</h3>
<ul>
<li>
<p>优化模式：低分 Block（通常是历史冷数据）直接跳过，不需要从磁盘读取。</p>
</li>
<li>
<p>强制计数：强制读取所有 Block。</p>
</li>
<li>
<p>后果：这会导致大量的随机 I/O。更致命的是，这些本该沉睡的冷数据被加载到内存中，会污染 Page Cache，把真正热点的数据（比如最近 5 分钟的日志）挤出去。</p>
</li>
<li>
<p>现象：你会发现，为了查一个总数，整个集群的写入性能和热查询性能都下降了。</p>
</li>
</ul>
<h2 data-id="heading-11">决策矩阵：到底什么时候该用？</h2>
<p>我们需要建立一个清晰的决策标准，而不是盲目地 <code>true</code>。</p>
<p><strong>场景</strong></p>
<p><strong>track_total_hits 设置</strong></p>
<p><strong>理由</strong></p>
<p><strong>C 端搜索 / App 列表</strong></p>
<p><code>false</code> 或 <code>10000</code> (默认)</p>
<p>用户只翻前几页。显示“10,000+”完全满足体验，性能最优。</p>
<p><strong>高频业务接口</strong></p>
<p><strong>(QPS &gt; 100)</strong></p>
<p><code>false</code></p>
<p>**绝对禁止开启。**高并发下开启全量计数是集群雪崩的导火索。</p>
<p><strong>后台管理 / 审核列表</strong></p>
<p><code>true</code> (慎用)</p>
<p>运营人员并发低，且必须知道确切的“待办数量”。</p>
<p><strong>数据大盘 / 趋势图</strong></p>
<p><code>false</code> (使用聚合)</p>
<p>不要用 hits.total 画图！请使用 <code>date_histogram</code> 或 <code>cardinality</code> 聚合。</p>
<p><strong>数据导出</strong></p>
<p><code>false</code></p>
<p>导出任务应使用 Scroll API 或 Point in Time (PIT) API，这些 API 针对全量遍历做了优化，不需要实时计算总数 。</p>
<h2 data-id="heading-12">Serverless 下的治理之道</h2>
<p>在自建集群中，很难限制开发者的代码行为。但在 阿里云 ES Serverless 中，我们建议通过配置进行防御性治理。</p>
<h3 data-id="heading-13">1. 软限制："Track Total Hits上限"</h3>
<p>你可以通过 ES Serverless 控制台—开启功能设置，给查询加上一道“保护锁”：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea09ce16766a4fcd982a9831070dbb65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028389&amp;x-signature=f3h%2FjLvAZSfXxYfQYlpUWbWDrlk%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>效果：一旦设置，即使客户端请求中带了 <code>"track_total_hits": true</code>，服务端也会强制忽略，只计算到 10,000。</p>
</li>
<li>
<p>价值：从根源上防止了某个实习生的一行代码搞挂整个生产集群。</p>
</li>
</ul>
<h3 data-id="heading-14">2. 拥抱“模糊的正确”</h3>
<p>在云原生时代，算力是按量计费的（CU）。</p>
<p>“无意义的精确计数” = “直接烧钱”。</p>
<p>利用 Serverless 的弹性与治理能力，将算力集中在真正产生业务价值的 Top N 搜索上，才是降本增效的关键。</p>
<h2 data-id="heading-15">附录：代码与实操</h2>
<h4 data-id="heading-16">1. 正确的查询姿势 (DSL)</h4>
<p><strong>场景 A：只要 Top 10 (性能最快)</strong></p>
<pre><code class="hljs language-json" lang="json">GET /logs/_search
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"query"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"match"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"error"</span> <span class="hljs-punctuation">}</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"size"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"track_total_hits"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>  <span class="hljs-comment">// 显式关闭，连 10000 都不数，最快</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><img alt="" title="点击并拖拽以移动" src="" loading="lazy"/></p>
<p><strong>场景 B：需要精确计数 (Java Client)</strong></p>
<pre><code class="hljs language-ini" lang="ini">SearchRequest <span class="hljs-attr">searchRequest</span> = new SearchRequest(<span class="hljs-string">"logs"</span>)<span class="hljs-comment">;</span>
SearchSourceBuilder <span class="hljs-attr">sourceBuilder</span> = new SearchSourceBuilder()<span class="hljs-comment">;</span>
sourceBuilder.query(QueryBuilders.matchQuery("message", "error"))<span class="hljs-comment">;</span>

// ⚠️ 警告：仅在必要时开启，注意性能损耗
sourceBuilder.trackTotalHits(true)<span class="hljs-comment">; </span>

// 或者设置一个具体的上限，例如 5万
// sourceBuilder.trackTotalHitsUpTo(50000)<span class="hljs-comment">; </span>

searchRequest.source(sourceBuilder)<span class="hljs-comment">;</span>
</code></pre>
<p><img alt="" title="点击并拖拽以移动" src="" loading="lazy"/></p>
<h3 data-id="heading-17">2. 高效替代方案：Cardinality 聚合</h3>
<p>如果你只是想知道“大概有多少条日志”，不要用 <code>track_total_hits</code>，请用 HyperLogLog 算法：</p>
<pre><code class="hljs language-json" lang="json">GET /logs/_search
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"size"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"aggs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"total_count_approx"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"cardinality"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"field"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"_id"</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 或者其他高基数主键</span>
        <span class="hljs-attr">"precision_threshold"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10000</span> 
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><img alt="" title="点击并拖拽以移动" src="" loading="lazy"/></p>
<ul>
<li>
<p>优点：性能极快，内存占用极低。</p>
</li>
<li>
<p>缺点：有约 5% 以内的误差。</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[大数据-222 离线数仓建模实战：事实表/维度表、三类事实表与雪花/星座模型]]></title>    <link>https://juejin.cn/post/7599478406238076937</link>    <guid>https://juejin.cn/post/7599478406238076937</guid>    <pubDate>2026-01-26T10:39:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599478406238076937" data-draft-id="7599294170000916531" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="大数据-222 离线数仓建模实战：事实表/维度表、三类事实表与雪花/星座模型"/> <meta itemprop="keywords" content="后端,大数据,Hadoop"/> <meta itemprop="datePublished" content="2026-01-26T10:39:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="武子康"/> <meta itemprop="url" content="https://juejin.cn/user/149189314230039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            大数据-222 离线数仓建模实战：事实表/维度表、三类事实表与雪花/星座模型
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189314230039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    武子康
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T10:39:12.000Z" title="Mon Jan 26 2026 10:39:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读13分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TL;DR</h2>
<ul>
<li>场景：离线数仓主题建模，围绕事实表粒度、维度设计与模型选型落地。</li>
<li>结论：先定“粒度+事实类型”，再选星型/雪花/星座；累积快照允许更新但要管好里程碑日期键。</li>
<li>产出：事实表分类要点、模型选型边界、常见错误定位与修复清单。</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/654118d8b1c54b5db985ddf949215468~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028752&amp;x-signature=Pp7DLR0JLw%2FGc46qkebFnotq%2Fc0%3D" alt="大数据-222 离线数仓建模实战：事实表/维度表、三类事实表与雪花/星座模型" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8471afa6f5c47829bcc3edc3e0aa67c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028752&amp;x-signature=fKRkO9xVmbdwXRz3JVndrWmnAcQ%3D" alt="离线数仓 架构图" loading="lazy"/></p>
<h2 data-id="heading-1">数仓模型</h2>
<h3 data-id="heading-2">事实表与维度表</h3>
<p>在数据仓库架构中，事实表（Fact Table）是存储业务过程度量值或事实的核心表结构。它是星型模式或雪花模式中的中心表，与多个维度表相关联。</p>
<p>事实表具有以下关键特征：</p>
<ol>
<li>包含业务过程的量化指标（事实），如销售额、订单数量、库存量等</li>
<li>通常包含外键（Foreign Key）用于关联维度表</li>
<li>数据量通常非常庞大，可能包含数百万甚至数十亿行记录</li>
<li>记录通常是只读的，反映历史业务活动</li>
</ol>
<p>事实表中的事实可以分为三种类型：</p>
<ul>
<li>可加性事实：可以按照任何维度进行汇总（如销售额）</li>
<li>半可加性事实：只能在部分维度上汇总（如账户余额）</li>
<li>不可加性事实：不能进行汇总（如单价、百分比）</li>
</ul>
<p>事实表的粒度（Granularity）是指表中每一行数据所代表的业务含义，常见粒度包括：</p>
<ul>
<li>交易级别：每条记录代表一个交易（如单个订单项）</li>
<li>快照级别：定期记录状态（如每日库存快照）</li>
<li>累积快照：跟踪业务过程多个阶段（如订单从创建到交付）</li>
</ul>
<p>例如，在零售数据仓库中，销售事实表可能包含以下字段：</p>
<ul>
<li>事实：销售金额、销售数量、折扣金额</li>
<li>外键：日期键、产品键、店铺键、客户键</li>
<li>退化维度：订单编号、发票编号</li>
</ul>
<p>事实表的设计直接影响数据仓库的性能和分析能力。合理选择事实表的粒度和事实类型，可以确保数据仓库既能满足分析需求，又能保持高效的查询性能。</p>
<p>在数据仓库架构中，事实表（Fact Table）是存储业务过程度量值或事实的核心表结构。它是星型模式或雪花模式中的中心表，与多个维度表相关联。</p>
<p>事实表具有以下关键特征：</p>
<ol>
<li>包含业务过程的量化指标（事实），如销售额、订单数量、库存量等</li>
<li>通常包含外键（Foreign Key）用于关联维度表</li>
<li>数据量通常非常庞大，可能包含数百万甚至数十亿行记录</li>
<li>记录通常是只读的，反映历史业务活动</li>
</ol>
<p>事实表中的事实可以分为三种类型：</p>
<ul>
<li>可加性事实：可以按照任何维度进行汇总（如销售额）</li>
<li>半可加性事实：只能在部分维度上汇总（如账户余额）</li>
<li>不可加性事实：不能进行汇总（如单价、百分比）</li>
</ul>
<p>事实表的粒度（Granularity）是指表中每一行数据所代表的业务含义，常见粒度包括：</p>
<ul>
<li>交易级别：每条记录代表一个交易（如单个订单项）</li>
<li>快照级别：定期记录状态（如每日库存快照）</li>
<li>累积快照：跟踪业务过程多个阶段（如订单从创建到交付）</li>
</ul>
<p>例如，在零售数据仓库中，销售事实表可能包含以下字段：</p>
<ul>
<li>事实：销售金额、销售数量、折扣金额</li>
<li>外键：日期键、产品键、店铺键、客户键</li>
<li>退化维度：订单编号、发票编号</li>
</ul>
<p>事实表的设计直接影响数据仓库的性能和分析能力。合理选择事实表的粒度和事实类型，可以确保数据仓库既能满足分析需求，又能保持高效的查询性能。</p>
<h4 data-id="heading-3">常见事实表</h4>
<p>常见的事实表：订单事实表
事实表的特点：表多（各种各样的事实表），数据量大
事实表根据数据的粒度可以分为：</p>
<ul>
<li>事务事实表</li>
<li>周期快照事实表</li>
<li>累积快照事实表</li>
</ul>
<h4 data-id="heading-4">常见维度表</h4>
<p>维度表（维表）可以看做是用来分析数据的角度，维度表中包含事实数据表在中事实记录的特性。有些特性提供描述性信息，有些特性指定如何汇总事实数据表数据，以便为分析者提供有用的信息。
常见维度表：</p>
<ul>
<li>时间维度</li>
<li>地域维度</li>
<li>商品维度</li>
</ul>
<h4 data-id="heading-5">简单小结</h4>
<ul>
<li>事实表是关注的内容（如：销售额、销售量）</li>
<li>维度表是观察事务的角度</li>
</ul>
<h3 data-id="heading-6">事实表分类</h3>
<h4 data-id="heading-7">事务事实表</h4>
<p>事务事实表记录的事务层面的事实，保存的是最原子的数据，也称为“原子事实表”。事务事实表中的数据在事务事件发生后产生，数据的粒度通常是每个事务一条记录。
一旦事务被提交，事实表数据被插入，数据就不再进行更改，其更新方式为增量更新。
事务事实表的日期维度记录的是事务发生的日期，它记录的事实是事务活动的内容。如：订单表。通过事务事实表，还可以建立聚集事实表，为用户提供高性能的分析。</p>
<h4 data-id="heading-8">周期快照事实表</h4>
<p>周期快照事实表以规律性的、可预见的时间间隔来记录事实，时间间隔如每天、每月、每年等等。典型的例子如销售日快照表、库存日快照表等。它统计的是间隔周期内的度量统计，如历史至今、自然年至今、季度至今等等。</p>
<h4 data-id="heading-9">累积快照事实表</h4>
<p>累积快照事实表和周期快照事实表虽然都是用于存储事务数据的快照信息，但在设计理念和应用场景上存在显著差异。以下是对两者更详细的对比说明：</p>
<ol>
<li>时间周期特性：</li>
</ol>
<ul>
<li>周期快照事实表：记录固定时间间隔（如每日、每周、每月）的静态快照数据。例如银行账户的月末余额快照。</li>
<li>累积快照事实表：跟踪跨越不确定时间段的完整业务流程，通常包含多个里程碑日期。例如订单处理流程中的各个关键节点时间。</li>
</ul>
<ol start="2">
<li>日期字段设计：</li>
</ol>
<ul>
<li>累积快照事实表包含多个日期维度：
<ul>
<li>流程起始日期（如订单创建日期）</li>
<li>中间过程日期（如审批日期、发货日期）</li>
<li>完成日期（如收货日期）</li>
<li>最后更新日期（记录数据补充时间）</li>
</ul>
</li>
<li>在初始加载时，未来日期通常使用特殊代理键（如-1表示"未发生"）占位</li>
</ul>
<ol start="3">
<li>数据更新机制：</li>
</ol>
<ul>
<li>周期快照事实表通常是只读的，反映特定时间点的状态</li>
<li>累积快照事实表支持更新操作，当业务流程推进时，可以补充后续日期信息。例如：
初始记录：订单创建日期=2023-01-01，发货日期=NULL
更新记录：当货物发出后，更新发货日期=2023-01-05</li>
</ul>
<ol start="4">
<li>典型应用场景：</li>
</ol>
<ul>
<li>累积快照事实表适用于：
<ul>
<li>订单处理全流程跟踪（创建→付款→发货→收货）</li>
<li>保险理赔流程（报案→定损→核赔→支付）</li>
<li>客户服务工单（创建→分配→处理→关闭）</li>
</ul>
</li>
</ul>
<ol start="5">
<li>示例字段说明：</li>
</ol>
<ul>
<li>订单处理累积快照可能包含：
<ul>
<li>时间维度：订货日期、审核通过日期、生产完成日期、发货日期、收货日期</li>
<li>业务度量：订单数量、商品金额、折扣金额、运费</li>
<li>状态标识：当前处理阶段、是否超期标志</li>
</ul>
</li>
</ul>
<p>这种设计方式特别适合需要分析业务流程时效性的场景，例如计算"订单创建到发货的平均时长"或"各环节的时间间隔分布"等分析需求。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48db1aa62b364ad38982fe0ded9910eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028752&amp;x-signature=9174KxVjg9XTU8a0HxUaZzn3zuw%3D" alt="离线数仓 事实表 维度表" loading="lazy"/></p>
<h3 data-id="heading-10">雪花模型</h3>
<p>雪花模型是星型模型的变种，维表是规范化的，模型类似雪花的形状。
特点：雪花结构去除了数据冗余。
星型模型存在数据冗余，所以在查询统计时只需要做少量的表连接，查询效率高。星型模型不考虑维表正规化的因素，设计、实现容易。
在数据冗余可接受的情况下，实际上使用星型模型比较多。</p>
<h4 data-id="heading-11">雪花模型的结构</h4>
<p>事实表：
雪花模型的核心部分还是事实表，事实表通常存储了业务事件的度量数据，如销售额、订单数量等。
事实表包含指向维度表的外键。</p>
<p>维度表：
在雪花模型中，维度表进行规范化，意味着同一维度中的不同属性会拆分成多个子表。
例如，“客户”维度可能包含多个层级的属性：客户的基本信息可能存储在一个表中，而客户的地址信息可能存储在另一个单独的表中。这种方式使得维度表的数据冗余减少，提高了数据一致性。
子维度表：</p>
<p>雪花模型的一个特点是维度表的“分层”结构。例如，地理维度可能会被拆分成“国家”、“省/州”、“城市”等多个子维度表，每个表之间通过外键关联。</p>
<h4 data-id="heading-12">雪花模型的优缺点</h4>
<p>优点：</p>
<ul>
<li>数据冗余较低：由于维度表被规范化，雪花模型减少了数据的冗余。每个属性只会在相关的表中出现一次，这对于数据更新、删除和维护时，可以减少出现数据不一致的风险。</li>
<li>存储空间节省：由于规范化结构减少了重复数据，雪花模型相对于星型模型来说在存储上可以节省空间，特别是在处理大规模数据时，优势更加明显。</li>
<li>数据一致性较好：由于每个属性只存在于某个特定的维度表中，数据的一致性和完整性相对更容易保持。</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e5a5602e36748bb90ca217e8713dab9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028752&amp;x-signature=NyQCIbdUVbiQAhV1rWnnZ9tdR60%3D" alt="离线数仓事实表汇总" loading="lazy"/></p>
<h3 data-id="heading-13">事实星座</h3>
<p>数据仓库由多个主题构成，包含多个事实表，而维表是公共的，可以共享，这种模式可以看做星型模式的汇集。因而称作星系模式或者事实星座模式。
特点：公用维表</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0403e4b21ff7449b896c4cba873cb3db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028752&amp;x-signature=KXi7SWWyi1aEfBnk%2BL7n7fplN04%3D" alt="离线数仓事实星座" loading="lazy"/></p>
<h2 data-id="heading-14">元数据</h2>
<p>元数据（Metadata）是关于数据的数据，元数据打通了源数据、数据仓库、数据应用，记录了数据从产生到消费的全过程。元数据就相当于所有数据的地图，有了这张地图就能知道数据仓库中：</p>
<ul>
<li>有哪些数据</li>
<li>数据分布的情况</li>
<li>数据类型</li>
<li>数据之间有什么关系</li>
<li>哪些数据经常被使用，哪些数据很少有人光顾</li>
</ul>
<p>在大数据平台中，元数据贯穿大数据平台数据流动的全过程，主要包括数据源元数据、数据加工处理过程元数据、数据主题专题库元数据、服务层元数据、应用层元数据等。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/52409920a3194c00806da1bf3b1a2e9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770028752&amp;x-signature=jItHhJ9sL1hIi2jxHE6dCjNWq1U%3D" alt="离线数仓元数据管理" loading="lazy"/>
业务通常把元数据分为以下类型：</p>
<ul>
<li>技术元数据：库表结构、数据模型、ETL程序、SQL程序等</li>
<li>业务元数据：业务指标、业务代码、业务术语等</li>
<li>管理元数据：数据所有者、数据质量、数据安全等</li>
</ul>
<h2 data-id="heading-15">错误速查</h2>



























































<table><thead><tr><th>症状</th><th>根因</th><th>定位修复指标</th><th>汇总结果</th></tr></thead><tbody><tr><td>忽大忽小、同一报表口径不一致</td><td>事实表粒度未固定；把不同粒度数据混进同一事实表或同一指标口径</td><td>逐条确认“事实表一行代表什么业务事件”；检查 join 前后的行数膨胀</td><td>先锁定粒度（交易/快照/累积）；必要时拆表：原子事实表 + 聚集事实表</td></tr><tr><td>SUM 后数据被重复计算</td><td>维度表一对多导致事实行被放大；维表主键不唯一</td><td>对维表做唯一性检查；对 join 结果做 count(distinct 事实主键)</td><td>维表补齐主键/去重；用桥表或 SCD 设计；在语义层限制 join 路径</td></tr><tr><td>半可加指标（余额/库存）按时间直接 SUM 错误</td><td>把半可加事实当可加事实处理</td><td>检查指标类型与聚合维度；看是否跨时间直接 sum</td><td>用“期末/期初/快照点”口径；改为 max/last_value 或按快照周期汇总</td></tr><tr><td>单价/折扣率等不可加指标被 SUM/AVG 后失真</td><td>指标本质不可加；平均未加权</td><td>找到指标的业务定义与分母；检查是否需要加权</td><td>改为加权平均（sum(分子)/sum(分母)）；或改成可加分子与分母分别入事实表</td></tr><tr><td>累积快照事实表里程碑日期缺失/乱序</td><td>业务流程未闭环；更新机制不清；“未发生”占位不一致</td><td>检查每个里程碑字段的取数逻辑与更新触发；核对代理键（-1 等）</td><td>统一占位规则；按阶段增量更新；为每个里程碑定义来源与可回填策略</td></tr><tr><td>雪花模型查询慢、SQL 复杂且容易写错</td><td>过度规范化导致 join 链过长</td><td>统计典型查询 join 数；观察执行计划与 shuffle</td><td>以星型为主：适度反规范化；为高频分析做宽表/维表冗余或物化视图</td></tr><tr><td>事实星座中跨主题分析结果对不上</td><td>公共维度未统一（编码/层级/主键体系不一致）</td><td>检查共享维表的主键、层级与业务口径；看是否存在多套维表</td><td>统一公共维（如时间/地域/商品）；做一致性维度建模与编码治理</td></tr><tr><td>元数据“有表无口径/有口径无血缘”，治理落空</td><td>只收技术元数据，缺业务口径与责任人；血缘未自动化</td><td>抽查指标：定义、负责人、来源链路、下游使用</td><td>同步补齐业务元数据与管理元数据；接入血缘采集（ETL/SQL/调度）并做质量与权限闭环</td></tr></tbody></table>
<h2 data-id="heading-16">其他系列</h2>
<h3 data-id="heading-17">🚀 AI篇持续更新中（长期更新）</h3>
<p><strong>AI炼丹日志-29 - 字节跳动 DeerFlow 深度研究框<em>斜体样式</em>架 私有部署 测试上手 架构研究</strong>，持续打造实用AI工具指南！
<strong>AI研究-132 Java 生态前沿 2025：Spring、Quarkus、GraalVM、CRaC 与云原生落地</strong></p>
<h3 data-id="heading-18">💻 Java篇持续更新中（长期更新）</h3>
<p><strong>Java-218 RocketMQ Java API 实战：同步/异步 Producer 与 Pull/Push Consumer</strong>
MyBatis 已完结，Spring 已完结，Nginx已完结，Tomcat已完结，分布式服务已完结，Dubbo已完结，MySQL已完结，MongoDB已完结，Neo4j已完结，FastDFS 已完结，OSS已完结，GuavaCache已完结，EVCache已完结，RabbitMQ已完结，RocketMQ正在更新... 深入浅出助你打牢基础！</p>
<h3 data-id="heading-19">📊 大数据板块已完成多项干货更新（300篇）：</h3>
<p>包括 Hadoop、Hive、Kafka、Flink、ClickHouse、Elasticsearch 等二十余项核心组件，覆盖离线+实时数仓全栈！
<strong>大数据-278 Spark MLib - 基础介绍 机器学习算法 梯度提升树 GBDT案例 详解</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[中文离线CPU环境下ASR模型技术选型指南]]></title>    <link>https://juejin.cn/post/7599474528238452776</link>    <guid>https://juejin.cn/post/7599474528238452776</guid>    <pubDate>2026-01-26T08:47:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599474528238452776" data-draft-id="7599474528238239784" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="中文离线CPU环境下ASR模型技术选型指南"/> <meta itemprop="keywords" content="后端,Python"/> <meta itemprop="datePublished" content="2026-01-26T08:47:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="马农可夫"/> <meta itemprop="url" content="https://juejin.cn/user/2541726616262061"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            中文离线CPU环境下ASR模型技术选型指南
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2541726616262061/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    马农可夫
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T08:47:02.000Z" title="Mon Jan 26 2026 08:47:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">中文离线CPU环境下ASR模型技术选型指南</h2>
<p>在语音识别（ASR）落地场景中，中文适配性、离线部署能力及CPU环境兼容性是核心诉求，尤其对于政务、客服、嵌入式终端等无GPU支持、需本地闭环运行的场景，选型直接决定项目落地效率与用户体验。本文基于PaddleSpeech、FunASR、Whisper V3等9款主流开源ASR模型，结合离线CPU部署需求，从适配性、效果、部署难度等维度展开分析，提供精准选型方案与落地建议。</p>
<h3 data-id="heading-1">一、选型核心评估维度</h3>
<p>针对中文离线CPU场景，需聚焦四大核心维度，避免因资源不匹配导致推理卡顿、精度不足等问题：</p>
<ol>
<li><strong>CPU适配性</strong>：核心关注模型量化能力（int8/int4）、内存占用、推理速度，优先选择对CPU线程优化、支持轻量推理框架的模型；</li>
<li><strong>中文效果</strong>：包括普通话识别准确率、逆文本正则化（数字、日期、专有名词转换）、方言适配性（可选），需贴合中文口语场景特点；</li>
<li><strong>部署难度</strong>：依赖库复杂度、是否提供预编译包/API、跨平台支持（Windows/Linux），降低项目集成成本；</li>
<li><strong>功能适配</strong>：是否支持流式识别（实时对话）、批量转写、VAD（语音活性检测）一体化，匹配具体业务场景。</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99d0fbce84764a18a675b8e28b798222~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ams5Yac5Y-v5aSr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770022021&amp;x-signature=j%2BWExdhW7PJ9MwsLCmQq3P%2FdKr8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">二、主流模型分项评估与适配场景</h3>
<p>结合上述维度，对9款模型进行分级评估，按“优先推荐-可备选-不推荐”分类，明确各模型的适用边界。</p>
<h4 data-id="heading-3">（一）优先推荐模型（CPU离线场景最佳适配）</h4>
<p>此类模型在中文效果、CPU推理效率、部署便捷性上达到平衡，可直接落地工业级场景。</p>
<h5 data-id="heading-4">1. FunASR（阿里达摩院）</h5>
<p>作为阿里达摩院面向中文场景优化的开源ASR工具包，FunASR是CPU离线部署的首选方案。其核心优势的在于中文适配深度与轻量量化能力：提供专为CPU优化的Nano模型，int8量化后体积仅100MB左右，内存占用低至500MB以下，单CPU（4线程）推理速度可达实时1.5倍以上，满足批量转写与流式识别双重需求。</p>
<p>部署层面，FunASR基于onnxruntime实现纯CPU离线运行，无需复杂依赖，支持Python/C++双接口，Windows与Linux系统均能快速集成，同时提供丰富的预训练模型（覆盖通用场景、政务、客服等垂直领域），可直接调用无需额外微调。适合政务语音转写、客服质检、本地桌面应用等对精度与效率均有要求的场景。</p>
<h5 data-id="heading-5">2. WeNet（百度&amp;清华大学）</h5>
<p>WeNet是工业级端到端ASR工具包，以低延迟流式识别为核心优势，完美适配CPU离线实时场景。其中文预训练模型基于大规模中文语料训练，普通话识别准确率优异，支持int8量化优化，CPU推理延迟可控制在100ms以内，且内存占用稳定，不会因长音频推理出现内存溢出问题。</p>
<p>部署上，WeNet提供轻量C++推理库与Python SDK，支持容器化部署与边缘设备集成，可灵活配置线程数与量化策略，适配不同CPU资源场景。相较于FunASR，WeNet在实时对话转写场景更具优势，适合政务实时交互终端、智能客服话术实时记录等场景。</p>
<h5 data-id="heading-6">3. SenseVoice（阿里达摩院，基于sherpa-onnx）</h5>
<p>SenseVoice以“轻量化一体化”为核心亮点，int8量化后模型体积229MB，内置VAD+ASR+标点预测全链路能力，无需额外集成第三方VAD工具，极大简化离线部署流程。其逆文本正则化能力突出，可精准转换数字、日期、金额等中文特殊表述，贴合实际业务场景需求。</p>
<p>该模型基于onnx格式分发，支持纯CPU离线运行，适配Windows、macOS、Linux多系统，甚至可部署至嵌入式设备（如ARM架构CPU）。推理速度在单CPU环境下可满足实时需求，适合轻量化离线转写、移动政务终端、嵌入式语音设备等资源受限但需全链路能力的场景。</p>
<h4 data-id="heading-7">（二）可备选模型（需权衡资源与效果）</h4>
<p>此类模型存在部分短板，需根据具体场景取舍，仅在特定需求下考虑选用。</p>
<h5 data-id="heading-8">1. PaddleSpeech（百度）</h5>
<p>PaddleSpeech中文识别准确率极佳，且支持ASR+TTS+语音合成一体化能力，若项目需多语音功能联动，可作为备选。但其依赖PaddlePaddle框架，CPU环境下部署依赖项略多，模型量化后的体积与推理速度略逊于FunASR，单CPU推理实时性一般，适合结合飞桨生态、对多语音能力有需求的政务或企业级项目。</p>
<h5 data-id="heading-9">2. Faster-whisper</h5>
<p>作为Whisper V3的优化版本，Faster-whisper通过量化与推理引擎优化，提升了CPU适配性，支持int8量化后模型体积缩小至原版本的1/4。其优势在于多语种支持与中英混读能力，若场景涉及少量英文内容，可作为备选。但CPU环境下推理速度仍较慢，仅适合短音频转写，长音频批量处理效率不足，且中文专有名词识别准确率略低于FunASR、WeNet。</p>
<h5 data-id="heading-10">3. Vosk（Alpha Cephei）</h5>
<p>Vosk是极致轻量化的离线ASR工具，中文小模型体积仅40MB，内存占用低于500MB，支持树莓派等低配置CPU设备，开箱即用无需复杂配置，部署难度极低。但其中文识别准确率一般，仅能满足日常简单语音转写需求，不适合对精度要求较高的政务、客服场景，仅推荐用于资源极度受限的轻量嵌入式设备。</p>
<h5 data-id="heading-11">4. DeepSpeech（Mozilla）</h5>
<p>DeepSpeech基于CTC架构，模型轻量化且文档完善，适合新手入门学习或小型离线项目。其CPU适配性良好，支持多系统部署，但中文预训练语料不足，识别准确率与逆文本正则化能力较弱，推理速度中等，仅推荐用于学习研究、原型验证等非工业级场景。</p>
<h4 data-id="heading-12">（三）不推荐模型（CPU环境适配性极差）</h4>
<p>此类模型因体积过大、依赖GPU加速，在纯CPU环境下无法正常落地，直接排除。</p>
<ul>
<li><strong>GLM-ASR-Nano-2512</strong>：模型体积约4.5GB，纯CPU环境下推理极慢（单句10秒音频需数秒推理时间），且内存占用极高，易出现卡顿与内存溢出，仅适合GPU环境使用。</li>
<li><strong>Whisper V3</strong>：原生模型体积大，CPU推理耗时久，即使经过量化优化，效率仍远低于FunASR、WeNet，纯CPU场景无竞争优势。</li>
<li><strong>VibeVoice-ASR</strong>：模型参数达9B，严重依赖CUDA GPU加速，纯CPU环境下推理几乎不可用，且部署复杂度极高，不适合CPU离线场景。</li>
</ul>
<h3 data-id="heading-13">三、落地选型决策路径与优化建议</h3>
<h4 data-id="heading-14">（一）选型决策路径</h4>
<p>结合业务场景快速锁定模型，可遵循以下决策逻辑：</p>
<ol>
<li>若需<strong>高精度+高效率+易部署</strong>（通用工业级场景）：优先选FunASR；</li>
<li>若需<strong>实时流式识别</strong>（如实时对话、智能终端）：优先选WeNet；</li>
<li>若需<strong>极致轻量化+全链路能力</strong>（嵌入式/边缘设备）：选SenseVoice；</li>
<li>若需<strong>多语种/中英混读</strong>（短音频场景）：可备选Faster-whisper；</li>
<li>若为<strong>资源极度受限的轻量场景</strong>（非高精度需求）：备选Vosk。</li>
</ol>
<h4 data-id="heading-15">（二）CPU离线部署优化建议</h4>
<p>为进一步提升CPU环境下的推理效率，可采用以下优化策略：</p>
<ol>
<li><strong>模型量化</strong>：优先选用int8量化模型，相较于FP32模型，体积缩小4倍，推理速度提升2-3倍，且精度损失控制在1%-2%以内，几乎不影响业务使用；</li>
<li><strong>线程配置</strong>：根据CPU核心数合理设置推理线程（建议4-8线程），避免线程过多导致资源竞争，线程过少影响推理速度；</li>
<li><strong>推理框架</strong>：优先使用onnxruntime框架，启用CPU优化选项（如MKLDNN加速），进一步提升推理效率；</li>
<li><strong>音频预处理</strong>：统一音频格式为16kHz、单声道、16bit，减少模型预处理耗时，提升推理流畅度。</li>
</ol>
<h3 data-id="heading-16">四、总结</h3>
<p>中文离线CPU环境下的ASR选型，核心是平衡“精度、效率、部署成本”三者关系。FunASR、WeNet、SenseVoice三款模型覆盖了绝大多数工业级场景，其中FunASR综合表现最优，可作为首选；WeNet与SenseVoice分别在流式识别、轻量化场景中具备独特优势，可针对性选用。</p>
<p>选型时需坚决排除GPU依赖型模型，同时根据业务场景的精度需求、资源限制、功能诉求，灵活调整模型与优化策略，确保项目高效落地。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[通过重新生成来修复字体文件问题]]></title>    <link>https://juejin.cn/post/7599155566298071083</link>    <guid>https://juejin.cn/post/7599155566298071083</guid>    <pubDate>2026-01-26T09:43:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599155566298071083" data-draft-id="7594627998839423018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="通过重新生成来修复字体文件问题"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-01-26T09:43:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="乘风转舵"/> <meta itemprop="url" content="https://juejin.cn/user/2260251640086279"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            通过重新生成来修复字体文件问题
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2260251640086279/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    乘风转舵
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-26T09:43:38.000Z" title="Mon Jan 26 2026 09:43:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">有没有遇到这种情况，</h2>
<blockquote>
<p>美术导出的字体，她用着可以，但是前端页面引用就不生效</p>
</blockquote>
<h2 data-id="heading-1">可能的原因</h2>
<h3 data-id="heading-2">1. 浏览器的“安检机制”：OTS 拦截</h3>
<p>现代浏览器（Chrome、Firefox、Safari）在加载 Web 字体时，都会运行一个叫作 <strong>OTS (OpenType Sanitizer)</strong> 的程序。</p>
<ul>
<li><strong>它的职责：</strong> 防止恶意字体利用解析漏洞攻击用户的系统。它会对字体的每一个二进制 Table（数据表）进行极其严格的校验。</li>
<li><strong>后果：</strong> 如果字体文件的校验和（Checksum）对不上，或者内部索引表有 1 字节的偏移错误，浏览器会<strong>直接拒绝加载</strong>该文件，并在控制台报错。</li>
<li><strong>Photoshop 的做法：</strong> PS 调用的是操作系统的字体引擎（或者是 Adobe 自家的引擎）。这些引擎为了兼容老旧字体，通常非常“宽容”。即使文件结构有瑕疵，只要它能找到笔画数据，它就能强行画出来。</li>
</ul>
<h3 data-id="heading-3">2. 权限与版权位（Embedding Bits）</h3>
<p>字体文件内部有一个字段叫 <code>fsType</code>，专门标记该字体是否允许“嵌入”。</p>
<ul>
<li><strong>网页端的限制：</strong> 如果这个位被设置为“受限（Restricted）”，浏览器会遵循版权协议，拒绝在网页上显示该字体。</li>
<li><strong>Photoshop 的做法：</strong> 既然设计师能把字体装进系统，PS 就认为你已经拥有了使用权，所以它不会限制你在设计稿里使用它。</li>
<li><strong>FontForge 的作用：</strong> 当你在 FontForge 里导出新字体时，默认设置通常会重置这些权限位，使其变为“可嵌入（Installable Embedding）”，从而解开了浏览器的枷锁。</li>
</ul>
<h3 data-id="heading-4">3. 命名空间与跨域（CORS）</h3>
<p>虽然这与字体内部结构关系较小，但也是前端常遇到的坑：</p>
<ul>
<li><strong>文件头信息：</strong> 有些字体内部的 <code>PostScript Name</code> 包含特殊字符或中文字符，PS 能够识别，但 CSS 引用时如果名称不匹配或包含非法字符，浏览器就找不到。</li>
<li><strong>FontForge 的作用：</strong> 导出过程会根据规范重新格式化字体的“名字表（Naming Table）”，消除了命名的歧义。</li>
<li/>
</ul>
<h2 data-id="heading-5">解决方法</h2>
<h3 data-id="heading-6">使用FontForge这类字体编辑器重新生成一下字体文件来解决</h3>
<p>重新生成会做如下的事情</p>
<ol>
<li><strong>清理冗余数据：</strong> FontForge 会丢弃原文件中不规范的自定义数据。</li>
<li><strong>重新计算校验：</strong> 它会为所有的 Table 重新计算正确的校验和（Checksum），这直接通过了浏览器的 <strong>OTS 安检</strong>。</li>
<li><strong>标准化格式：</strong> 它强制按照 OpenType/TrueType 最新的标准协议来排列文件的二进制结构。</li>
</ol>
<blockquote>
</blockquote>
<h3 data-id="heading-7">FontForge下载</h3>
<ul>
<li>开源免费</li>
<li>跨平台（Windows/macOS/Linux）</li>
<li>支持 TTF/OTF/WOFF/WOFF2/SVG/BDF 等互转</li>
</ul>
<p>官网  <a href="https://link.juejin.cn?target=https%3A%2F%2Ffontforge.org" target="_blank" title="https://fontforge.org" ref="nofollow noopener noreferrer">fontforge.org</a></p>
<p>使用文档  <a href="https://link.juejin.cn?target=https%3A%2F%2Ffontforge.org%2Fdocs%2Fui%2Fmenus.html" target="_blank" title="https://fontforge.org/docs/ui/menus.html" ref="nofollow noopener noreferrer">fontforge.org/docs/ui/men…</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/814ae29c63e8410c95c4ea6cef551c10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LmY6aOO6L2s6Ii1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770025417&amp;x-signature=MjP4lFPe5Mpz88gfaWBT2RBTXbo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">导入字体</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7cd6750de6cc4dbeb6f6956ae7a86931~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LmY6aOO6L2s6Ii1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770025417&amp;x-signature=i5PLeLJcFGrPhV4d3e9RdRZ6flg%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-9">这里可以查看字体的报错</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83b3a0db54914b2dadee1243797e72f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LmY6aOO6L2s6Ii1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770025417&amp;x-signature=%2FzFlAOVrsNz7yNdEJaizqN8HS2I%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4a871797ae14a02926b69751cab4608~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LmY6aOO6L2s6Ii1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770025417&amp;x-signature=jVxWVmdVXz9WsBsRQ9QF7jx3kNk%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>
<p><code>Missing Points at Extrema</code>（极值点缺失）：这主要影响字体在特定尺寸下的渲染清晰度（Hinting）。</p>
</li>
<li>
<p><code>Self Intersecting</code>（路径自相交）：这可能导致某些软件里填充色块异常。</p>
</li>
<li>
<p><strong>结论：</strong> 这些属于“绘图规范”问题，<strong>它们通常不会导致字体无法加载</strong>，只会让字看起来可能有点丑或渲染不完美</p>
</li>
</ul>
<h3 data-id="heading-10">重新生成字体文件</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44c4714fb62f46178fe0c64843627e83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LmY6aOO6L2s6Ii1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770025417&amp;x-signature=9ttgk76eIytWsOCX%2Fnae%2FObj8Xw%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-11">选择导出的文件格式</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d66250a8de4492aaa75f4bd18b53ae1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LmY6aOO6L2s6Ii1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770025417&amp;x-signature=gNbqhh9T2AKCS9xOar%2FWs2O5%2Bkw%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>
<p><strong>原始文件可能存在的问题：</strong> 原始字体可能存在损坏的偏移量、错误的校验和（Checksum）、或者不符合规范的 Header（头部信息）。浏览器（尤其是 Chrome/Firefox）对 Web 字体的安全性检查非常严格，只要结构有一点不合规，就会拒绝加载。</p>
</li>
<li>
<p><strong>FontForge 的作用：</strong> 当你点击“Generate”时，FontForge 并不是简单地“复制”旧文件，而是根据它内存中的数据模型，<strong>重新从零开始构建</strong>了一个全新的 <code>.ttf</code> 文件。它会自动生成符合标准的新 Table（如 <code>head</code>, <code>hhea</code>, <code>maxp</code>, <code>OS/2</code> 等）。这个“重写”过程自动修复了导致浏览器报错的底层结构问题。</p>
</li>
</ul>
<p><strong>导出之后新的字体文件就可以用了，对于前端来说了解到这就够用了</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>