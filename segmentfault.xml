<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>SegmentFault - æœ€è¿‘æ–‡ç« </title>      <link>https://segmentfault.com/blogs/newest</link>      <description>SegmentFault æ€å¦</description>      <generator>python segmentfault.py @Pi20</generator>      <item>    <title><![CDATA[2026 AI å…ƒå¹´ï¼šä»â€œå¢èƒ½â€èµ°å‘â€œè´£ä»»æ‰¿æ‹…â€çš„æ¼”è¿›é€»è¾‘ Agentcometoo ]]></title>    <link>https://segmentfault.com/a/1190000047586515</link>    <guid>https://segmentfault.com/a/1190000047586515</guid>    <pubDate>2026-02-02 09:02:09</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>åœ¨äººå·¥æ™ºèƒ½å‘å±•çš„æ—©æœŸé˜¶æ®µï¼Œè¡Œä¸šå…³æ³¨çš„æ ¸å¿ƒå§‹ç»ˆå›´ç»•â€œæ•ˆç‡æå‡â€ä¸â€œèƒ½åŠ›æ¶Œç°â€ã€‚æ¨¡å‹æ˜¯å¦æ›´å¤§ã€ç”Ÿæˆæ˜¯å¦æ›´å¿«ã€è¦†ç›–ä»»åŠ¡æ˜¯å¦æ›´å¤šï¼Œæ˜¯è¡¡é‡æŠ€æœ¯è¿›æ­¥çš„ä¸»è¦æŒ‡æ ‡ã€‚</p><p>ä½†éšç€ AI ç³»ç»Ÿé€æ­¥å…·å¤‡æ¨ç†èƒ½åŠ›ã€å·¥å…·è°ƒç”¨èƒ½åŠ›ä»¥åŠå¯¹ç°å®ä¸šåŠ¡æµç¨‹çš„æŒç»­ä»‹å…¥ï¼Œäººå·¥æ™ºèƒ½åœ¨ç”Ÿäº§ä½“ç³»ä¸­çš„è§’è‰²ï¼Œæ­£åœ¨å‘ç”Ÿç»“æ„æ€§å˜åŒ–ï¼š <strong>å®ƒä¸å†åªæ˜¯è¢«è°ƒç”¨çš„èƒ½åŠ›æ¨¡å—ï¼Œè€Œå¼€å§‹å‚ä¸ç»“æœå½¢æˆæœ¬èº«ã€‚</strong></p><p>è¿™ä¸€å˜åŒ–ï¼Œä½¿â€œè´£ä»»â€æˆä¸º AI æŠ€æœ¯æ— æ³•å›é¿çš„æ–°ç»´åº¦ã€‚</p><h2>ä¸€ã€ä»â€œå¢èƒ½å·¥å…·â€åˆ°â€œè´£ä»»ä»‹å…¥â€çš„è§’è‰²è½¬å˜</h2><p>åœ¨å½“å‰äº§ä¸šå®è·µä¸­ï¼Œå¯ä»¥æ¸…æ™°åœ°åŒºåˆ†äººå·¥æ™ºèƒ½çš„ä¸¤ä¸ªå‘å±•é˜¶æ®µã€‚</p><p><strong>AI å¢èƒ½é˜¶æ®µ</strong> äººå·¥æ™ºèƒ½ä½œä¸ºè¾…åŠ©å·¥å…·å­˜åœ¨ï¼Œä¸»è¦æ‰¿æ‹…ä¿¡æ¯æ•´ç†ã€å†…å®¹ç”Ÿæˆã€æµç¨‹åŠ é€Ÿç­‰ä»»åŠ¡ã€‚ åœ¨è¿™ä¸€é˜¶æ®µï¼ŒAI ä¸æ„æˆå†³ç­–é—­ç¯ï¼Œå…¶è¾“å‡ºç»“æœç”±äººç±»å®¡æ ¸ã€é‡‡çº³å¹¶æ‰¿æ‹…æœ€ç»ˆè´£ä»»ã€‚</p><p><strong>AI è´£ä»»ä»‹å…¥é˜¶æ®µ</strong> AI è¢«æˆæƒåœ¨é™å®šèŒƒå›´å†…å®Œæˆâ€œæ„ŸçŸ¥â€”åˆ¤æ–­â€”æ‰§è¡Œâ€çš„è¿ç»­åŠ¨ä½œï¼Œå…¶å†³ç­–ç›´æ¥å½±å“ä¸šåŠ¡ç»“æœæˆ–ç°å®ç¯å¢ƒã€‚ æ­¤æ—¶ï¼Œç³»ç»Ÿè¡Œä¸ºçš„åæœéœ€è¦å…·å¤‡å¯è¿½æº¯ã€å¯çº¦æŸã€å¯çº åçš„æŠ€æœ¯ä¸åˆ¶åº¦æ”¯æ’‘ã€‚</p><p>è§’è‰²çš„å˜åŒ–ï¼Œå†³å®šäº†æŠ€æœ¯æ¶æ„ä¸æ²»ç†æ–¹å¼å¿…é¡»åŒæ­¥å‡çº§ã€‚</p><h2>äºŒã€æ¨åŠ¨è½¬å‹çš„ä¸‰è‚¡åŠ›é‡</h2><h3>1. æŠ€æœ¯ç¡®å®šæ€§çš„æŒç»­æå‡</h3><p>éšç€æ£€ç´¢å¢å¼ºã€è§„åˆ™çº¦æŸä¸æ¨ç†ç»“æ„çš„å¼•å…¥ï¼ŒAI è¾“å‡ºé€æ¸ä»â€œæ¦‚ç‡è¡¨è¾¾â€è½¬å‘â€œè¯æ®å¯¹é½â€ã€‚ å½“æ¨¡å‹çš„å†³ç­–ä¾æ®å¯ä»¥è¢«è¿˜åŸã€è¢«å¤ç›˜ï¼Œå…¶è¿›å…¥é«˜å¯é åœºæ™¯çš„é—¨æ§›æ‰çœŸæ­£è¢«æ‰“å¼€ã€‚</p><h3>2. äº¤äº’å½¢æ€çš„å˜åŒ–</h3><p>ç°å®åº”ç”¨ä¸­ï¼ŒAI æ­£ä»â€œä¸€æ¬¡æ€§å“åº”â€æ¼”åŒ–ä¸ºâ€œæŒç»­åä½œå•å…ƒâ€ï¼Œèƒ½å¤Ÿå›´ç»•ç›®æ ‡æ‹†è§£ä»»åŠ¡ã€è°ƒç”¨èµ„æºå¹¶è¿›è¡Œè‡ªæˆ‘ä¿®æ­£ã€‚ è¿™ä¸€è¶‹åŠ¿åœ¨è¡Œä¸šä¸­è¢«æ™®éæè¿°ä¸ºä¸€ç§ç°è±¡æ€§å˜åŒ–â€”â€”<strong>æ™ºèƒ½ä½“æ¥äº†</strong>ï¼Œå®ƒæ„å‘³ç€ç³»ç»Ÿè‡ªä¸»æ€§æ˜¾è‘—æé«˜ï¼Œä¹Ÿæ„å‘³ç€è´£ä»»è¾¹ç•Œå¿…é¡»è¢«æå‰å®šä¹‰ã€‚</p><h3>3. ç¤¾ä¼šå±‚é¢çš„è´£ä»»è¯‰æ±‚</h3><p>å½“ AI è¢«åº”ç”¨äºé£æ§ã€åŒ»ç–—ã€è‡ªåŠ¨åŒ–è¿ç»´ç­‰é¢†åŸŸï¼Œä»…å°†å…¶è§†ä¸ºå·¥å…·å·²æ— æ³•æ»¡è¶³é£é™©æ²»ç†éœ€æ±‚ã€‚ ç¤¾ä¼šä¸ç»„ç»‡éœ€è¦æ˜ç¡®ï¼šå½“ç®—æ³•å‚ä¸å†³ç­–ï¼Œè´£ä»»å¦‚ä½•å®šä½ã€å¦‚ä½•å›æº¯ã€å¦‚ä½•è¡¥å¿ã€‚</p><h2>ä¸‰ã€è´£ä»»å¯æ‰¿æ‹…çš„å·¥ç¨‹åŒ–è·¯å¾„</h2><p>åœ¨å®è·µä¸­ï¼Œè´£ä»»å¹¶éæŠ½è±¡æ¦‚å¿µï¼Œè€Œæ˜¯é€šè¿‡å·¥ç¨‹ç»“æ„è¢«å…·ä½“åŒ–ã€‚</p><h3>1. è¡Œä¸ºå¯¹é½è€Œéè¯­è¨€ä¿®é¥°</h3><p>å¯¹é½çš„ç›®æ ‡ä¸å†æ˜¯è¾“å‡ºé£æ ¼ï¼Œè€Œæ˜¯è¡Œä¸ºé€‰æ‹©ã€‚ ç³»ç»Ÿéœ€è¦åœ¨å¤šç›®æ ‡å†²çªä¸­ï¼Œç¨³å®šéµå¾ªæ—¢å®šåˆè§„è§„åˆ™ä¸ä¸šåŠ¡åº•çº¿ã€‚</p><h3>2. å†³ç­–è¿‡ç¨‹å¯å®¡è®¡</h3><p>è´£ä»»çš„å‰ææ˜¯å¯è¿½æº¯ã€‚ é€šè¿‡å†³ç­–æ—¥å¿—ã€ä¸Šä¸‹æ–‡è®°å½•ä¸å…³é”®è·¯å¾„ç•™ç—•ï¼Œç³»ç»Ÿè¡Œä¸ºèƒ½å¤Ÿè¢«å¤ç›˜å’Œåˆ†æï¼Œè€Œä¸æ˜¯åœç•™åœ¨ç»“æœå±‚é¢ã€‚</p><h3>3. åŠ¨æ€çº¦æŸä¸ç‹¬ç«‹ç›‘ç®¡</h3><p>åœ¨å¤æ‚æµç¨‹ä¸­ï¼Œä¸»æ‰§è¡Œç³»ç»Ÿä¸çº¦æŸç³»ç»Ÿé€æ­¥åˆ†ç¦»ã€‚ å½“è¡Œä¸ºè§¦åŠé£é™©è¾¹ç•Œæ—¶ï¼Œèƒ½å¤Ÿè¢«å³æ—¶é˜»æ–­æˆ–è½¬äº¤äººå·¥ä»‹å…¥ï¼Œé¿å…è´£ä»»å¤±æ§ã€‚</p><h2>å››ã€ä»ä¸šå®è·µä¸­çš„èŒƒå¼è½¬ç§»</h2><p>è¿™ä¸€è½¬å‹ï¼Œå¯¹ç»„ç»‡æå‡ºäº†æ–°çš„è¦æ±‚ï¼š</p><ul><li><strong>ä»å‡†ç¡®ç‡å¯¼å‘è½¬å‘é²æ£’æ€§å¯¼å‘</strong>ï¼šç³»ç»Ÿå¿…é¡»é¢å¯¹æç«¯åœºæ™¯ä»å¯æ§</li><li><strong>æƒè´£å¯¹ç­‰çš„æµç¨‹è®¾è®¡</strong>ï¼šæ¯ä¸€æ¬¡è‡ªåŠ¨åŒ–å†³ç­–éƒ½åº”å¯¹åº”å¯å¤ç›˜çš„è´£ä»»è®°å½•</li><li><strong>æ¥å£ä¸åè®®æ ‡å‡†åŒ–</strong>ï¼šç¡®ä¿å¤šç³»ç»Ÿåä½œæ—¶è´£ä»»ä¸å‘ç”Ÿæ–­è£‚</li></ul><h2>äº”ã€ç»“è¯­ï¼šæ„å»ºå¯è¢«ä¿¡ä»»çš„ AI ç³»ç»Ÿ</h2><p>2026 å¹´ï¼Œäººå·¥æ™ºèƒ½çš„å‘å±•é‡å¿ƒæ­£åœ¨å‘ç”Ÿä½ç§»ã€‚ çœŸæ­£å…·å¤‡é•¿æœŸä»·å€¼çš„ç³»ç»Ÿï¼Œä¸ä»…è¦â€œèƒ½åšäº‹â€ï¼Œæ›´è¦â€œèƒ½è¢«è¿½è´£ã€èƒ½è¢«çº åã€èƒ½è¢«ä¿¡ä»»â€ã€‚</p><p>ä»å¢èƒ½èµ°å‘è´£ä»»æ‰¿æ‹…ï¼Œå¹¶ä¸æ˜¯å¯¹æŠ€æœ¯çš„é™åˆ¶ï¼Œè€Œæ˜¯å…¶è¿›å…¥æ ¸å¿ƒç”Ÿäº§ä½“ç³»çš„å‰ææ¡ä»¶ã€‚ å½“ AI æˆä¸ºå¯é¢„æµ‹ã€å¯çº¦æŸçš„åä½œä¸»ä½“ï¼Œå®ƒæ‰èƒ½çœŸæ­£èå…¥ç¤¾ä¼šè¿è¡Œç»“æ„ï¼Œé‡Šæ”¾æŒç»­æ€§çš„ç”Ÿäº§åŠ›ä»·å€¼ã€‚</p>]]></description></item><item>    <title><![CDATA[çº¿ç¨‹å¦‚ä½•åœæ­¢ï¼Ÿçº¿ç¨‹ä¹‹é—´å¦‚ä½•åä½œï¼Ÿçº¿ç¨‹ä¹‹é—´çš„å¼‚å¸¸å¦‚ä½•å¤„ç†ï¼Ÿ SevenCoding ]]></title>    <link>https://segmentfault.com/a/1190000047584366</link>    <guid>https://segmentfault.com/a/1190000047584366</guid>    <pubDate>2026-02-02 09:01:24</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>çº¿ç¨‹åœæ­¢</h2><h3>stopæ–¹æ³•</h3><p>stop æ–¹æ³•è™½ç„¶å¯ä»¥åœæ­¢çº¿ç¨‹ï¼Œä½†å®ƒå·²ç»æ˜¯ä¸å»ºè®®ä½¿ç”¨çš„åºŸå¼ƒæ–¹æ³•äº†ï¼Œè¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡ Thread ç±»ä¸­çš„æºç å‘ç°ï¼Œstop æºç å¦‚ä¸‹ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000045398707" alt="" title=""/></p><p>stop æ–¹æ³•æ˜¯è¢« @Deprecated ä¿®é¥°çš„ä¸å»ºè®®ä½¿ç”¨çš„è¿‡æœŸæ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æ³¨é‡Šçš„ç¬¬ä¸€å¥è¯å°±è¯´æ˜äº† stop æ–¹æ³•ä¸ºéå®‰å…¨çš„æ–¹æ³•ã€‚</p><p>åŸå› åœ¨äºå®ƒåœ¨ç»ˆæ­¢ä¸€ä¸ªçº¿ç¨‹æ—¶ä¼šå¼ºåˆ¶ä¸­æ–­çº¿ç¨‹çš„æ‰§è¡Œï¼Œä¸ç®¡runæ–¹æ³•æ˜¯å¦æ‰§è¡Œå®Œäº†ï¼Œå¹¶ä¸”è¿˜ä¼šé‡Šæ”¾è¿™ä¸ªçº¿ç¨‹æ‰€æŒæœ‰çš„æ‰€æœ‰çš„é”å¯¹è±¡ã€‚è¿™ä¸€ç°è±¡ä¼šè¢«å…¶å®ƒå› ä¸ºè¯·æ±‚é”è€Œé˜»å¡çš„çº¿ç¨‹çœ‹åˆ°ï¼Œä½¿ä»–ä»¬ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚è¿™å°±ä¼šé€ æˆæ•°æ®çš„ä¸ä¸€è‡´ã€‚</p><p>æ¯”å¦‚é“¶è¡Œè½¬è´¦ï¼Œä»Aè´¦æˆ·å‘Bè´¦æˆ·è½¬è´¦500å…ƒï¼Œè¿™ä¸€è¿‡ç¨‹åˆ†ä¸ºä¸‰æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯ä»Aè´¦æˆ·ä¸­å‡å»500å…ƒï¼Œå‡å¦‚åˆ°è¿™æ—¶çº¿ç¨‹å°±è¢«stopäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°±ä¼šé‡Šæ”¾å®ƒæ‰€å–å¾—é”ï¼Œç„¶åå…¶ä»–çš„çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œè¿™æ ·Aè´¦æˆ·å°±è«åå…¶å¦™çš„å°‘äº†500å…ƒè€ŒBè´¦æˆ·ä¹Ÿæ²¡æœ‰æ”¶åˆ°é’±ã€‚è¿™å°±æ˜¯stopæ–¹æ³•çš„ä¸å®‰å…¨æ€§ã€‚</p><h3>è®¾ç½®æ ‡å¿—ä½</h3><p>å¦‚æœçº¿ç¨‹çš„runæ–¹æ³•ä¸­æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªé‡å¤æ‰§è¡Œçš„å¾ªç¯ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªæ ‡è®°æ¥æ§åˆ¶å¾ªç¯æ˜¯å¦ç»§ç»­</p><pre><code class="java">class FlagThread extends Thread {
    // è‡ªå®šä¹‰ä¸­æ–­æ ‡è¯†ç¬¦
    public volatile boolean isInterrupt = false;
    @Override
    public void run() {
        // å¦‚æœä¸º true -&gt; ä¸­æ–­æ‰§è¡Œ
        while (!isInterrupt) {
            // ä¸šåŠ¡é€»è¾‘å¤„ç†
        }
    }
}</code></pre><p>ä½†è‡ªå®šä¹‰ä¸­æ–­æ ‡è¯†ç¬¦çš„é—®é¢˜åœ¨äºï¼šçº¿ç¨‹ä¸­æ–­çš„ä¸å¤ŸåŠæ—¶ã€‚å› ä¸ºçº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ— æ³•è°ƒç”¨ while(!isInterrupt) æ¥åˆ¤æ–­çº¿ç¨‹æ˜¯å¦ä¸ºç»ˆæ­¢çŠ¶æ€ï¼Œå®ƒåªèƒ½åœ¨ä¸‹ä¸€è½®è¿è¡Œæ—¶åˆ¤æ–­æ˜¯å¦è¦ç»ˆæ­¢å½“å‰çº¿ç¨‹ï¼Œæ‰€ä»¥å®ƒä¸­æ–­çº¿ç¨‹ä¸å¤ŸåŠæ—¶ï¼Œæ¯”å¦‚ä»¥ä¸‹ä»£ç ï¼š</p><pre><code class="java">class InterruptFlag {
    // è‡ªå®šä¹‰çš„ä¸­æ–­æ ‡è¯†ç¬¦
    private static volatile boolean isInterrupt = false;

    public static void main(String[] args) throws InterruptedException {
        // åˆ›å»ºå¯ä¸­æ–­çš„çº¿ç¨‹å®ä¾‹
        Thread thread = new Thread(() -&gt; {
            while (!isInterrupt) { // å¦‚æœ isInterrupt=true åˆ™åœæ­¢çº¿ç¨‹
                System.out.println("thread æ‰§è¡Œæ­¥éª¤1ï¼šçº¿ç¨‹å³å°†è¿›å…¥ä¼‘çœ çŠ¶æ€");
                try {
                    // ä¼‘çœ  1s
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println("thread æ‰§è¡Œæ­¥éª¤2ï¼šçº¿ç¨‹æ‰§è¡Œäº†ä»»åŠ¡");
            }
        });
        thread.start(); // å¯åŠ¨çº¿ç¨‹

        // ä¼‘çœ  100msï¼Œç­‰å¾… thread çº¿ç¨‹è¿è¡Œèµ·æ¥
        Thread.sleep(100);
        System.out.println("ä¸»çº¿ç¨‹ï¼šè¯•å›¾ç»ˆæ­¢çº¿ç¨‹ thread");
        // ä¿®æ”¹ä¸­æ–­æ ‡è¯†ç¬¦ï¼Œä¸­æ–­çº¿ç¨‹
        isInterrupt = true;
    }
}</code></pre><p>è¾“å‡ºï¼šæˆ‘ä»¬æœŸæœ›çš„æ˜¯ï¼šçº¿ç¨‹æ‰§è¡Œäº†æ­¥éª¤ 1 ä¹‹åï¼Œæ”¶åˆ°ä¸­æ–­çº¿ç¨‹çš„æŒ‡ä»¤ï¼Œç„¶åå°±ä¸è¦å†æ‰§è¡Œæ­¥éª¤ 2 äº†ï¼Œä½†ä»ä¸Šè¿°æ‰§è¡Œç»“æœå¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨è‡ªå®šä¹‰ä¸­æ–­æ ‡è¯†ç¬¦æ˜¯æ²¡åŠæ³•å®ç°æˆ‘ä»¬é¢„æœŸçš„ç»“æœçš„ï¼Œè¿™å°±æ˜¯è‡ªå®šä¹‰ä¸­æ–­æ ‡è¯†ç¬¦ï¼Œå“åº”ä¸å¤ŸåŠæ—¶çš„é—®é¢˜ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000045398708" alt="" title="" loading="lazy"/></p><h3>interruptedä¸­æ–­</h3><p>è¿™ç§æ–¹å¼éœ€è¦åœ¨whileå¾ªç¯ä¸­åˆ¤æ–­ä½¿ç”¨</p><p>ä½¿ç”¨ interrupt æ–¹æ³•å¯ä»¥ç»™æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼Œå‘é€ä¸€ä¸ªä¸­æ–­çº¿ç¨‹çš„æŒ‡ä»¤ï¼Œå®ƒå¹¶ä¸ç›´æ¥ä¸­æ–­çº¿ç¨‹ï¼Œè€Œæ˜¯å‘é€ä¸€ä¸ªä¸­æ–­çº¿ç¨‹çš„ä¿¡å·ï¼ŒæŠŠæ˜¯å¦æ­£åœ¨ä¸­æ–­çº¿ç¨‹çš„ä¸»åŠ¨æƒäº¤ç»™ä»£ç ç¼–å†™è€…ã€‚ç›¸æ¯”äºè‡ªå®šä¹‰ä¸­æ–­æ ‡è¯†ç¬¦è€Œç„¶ï¼Œå®ƒèƒ½æ›´åŠæ—¶çš„æ¥æ”¶åˆ°ä¸­æ–­æŒ‡ä»¤ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p><pre><code class="java">public static void main(String[] args) throws InterruptedException {
    // åˆ›å»ºå¯ä¸­æ–­çš„çº¿ç¨‹å®ä¾‹
    Thread thread = new Thread(() -&gt; {
        while (!Thread.currentThread().isInterrupted()) {
            System.out.println("thread æ‰§è¡Œæ­¥éª¤1ï¼šçº¿ç¨‹å³å°†è¿›å…¥ä¼‘çœ çŠ¶æ€");
            try {
                // ä¼‘çœ  1s
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                System.out.println("thread çº¿ç¨‹æ¥æ”¶åˆ°ä¸­æ–­æŒ‡ä»¤ï¼Œæ‰§è¡Œä¸­æ–­æ“ä½œ");
                // ä¸­æ–­å½“å‰çº¿ç¨‹çš„ä»»åŠ¡æ‰§è¡Œ
                break;
            }
            System.out.println("thread æ‰§è¡Œæ­¥éª¤2ï¼šçº¿ç¨‹æ‰§è¡Œäº†ä»»åŠ¡");
        }
    });
    thread.start(); // å¯åŠ¨çº¿ç¨‹

    // ä¼‘çœ  100msï¼Œç­‰å¾… thread çº¿ç¨‹è¿è¡Œèµ·æ¥
    Thread.sleep(100);
    System.out.println("ä¸»çº¿ç¨‹ï¼šè¯•å›¾ç»ˆæ­¢çº¿ç¨‹ thread");
    // ä¿®æ”¹ä¸­æ–­æ ‡è¯†ç¬¦ï¼Œä¸­æ–­çº¿ç¨‹
    thread.interrupt();
}</code></pre><p>è¾“å‡ºï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000045398709" alt="" title="" loading="lazy"/></p><p>ä»ä¸Šè¿°ç»“æœå¯ä»¥çœ‹å‡ºï¼Œçº¿ç¨‹åœ¨æ¥æ”¶åˆ°ä¸­æ–­æŒ‡ä»¤ä¹‹åï¼Œç«‹å³ä¸­æ–­äº†çº¿ç¨‹ï¼Œç›¸æ¯”äºä¸Šä¸€ç§è‡ªå®šä¹‰ä¸­æ–­æ ‡è¯†ç¬¦çš„æ–¹æ³•æ¥è¯´ï¼Œå®ƒèƒ½æ›´åŠæ—¶çš„å“åº”ä¸­æ–­çº¿ç¨‹æŒ‡ä»¤ã€‚</p><h3>åˆ©ç”¨interruptedException</h3><p>è¿™ç§æ–¹å¼ ä¸ éœ€è¦åœ¨whileå¾ªç¯ä¸­åˆ¤æ–­ä½¿ç”¨</p><p>å¦‚æœçº¿ç¨‹å› ä¸ºæ‰§è¡Œjoin()ï¼Œsleepæˆ–è€…wait()è€Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œæ­¤æ—¶æƒ³è¦åœæ­¢å®ƒï¼Œå¯ä»¥è°ƒç”¨interrupt()ï¼Œç¨‹åºä¼šæŠ›å‡ºinterruptedExceptionå¼‚å¸¸ã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸ªå¼‚å¸¸ç»ˆæ­¢çº¿ç¨‹</p><pre><code class="java">public void run() {
    System.out.println(this.getName() + "start");
    int i=0;
    //while (!Thread.interrupted()){
    while (!Thread.currentThread().isInterrupted()){
        try {
            Thread.sleep(10000);
        } catch (InterruptedException e) {
            //e.printStackTrace();
            System.out.println("ä¸­æ–­çº¿ç¨‹");
            break;//é€šè¿‡è¯†åˆ«åˆ°å¼‚å¸¸æ¥ä¸­æ–­
        }
        System.out.println(this.getName() + " "+ i);
        i++;
    }
    System.out.println(this.getName() + "end");
}</code></pre><p><img referrerpolicy="no-referrer" src="/img/remote/1460000045398710" alt="" title="" loading="lazy"/></p><h3>Executor çš„ä¸­æ–­æ“ä½œ</h3><p>è°ƒç”¨ Executor çš„ shutdown() æ–¹æ³•ä¼šç­‰å¾…çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åå†å…³é—­ï¼Œä½†æ˜¯å¦‚æœè°ƒç”¨çš„æ˜¯ shutdownNow() æ–¹æ³•ï¼Œåˆ™ç›¸å½“äºè°ƒç”¨æ¯ä¸ªçº¿ç¨‹çš„ interrupt() æ–¹æ³•ã€‚</p><p>ä»¥ä¸‹ä½¿ç”¨ Lambda åˆ›å»ºçº¿ç¨‹ï¼Œç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå†…éƒ¨çº¿ç¨‹ã€‚</p><pre><code class="java">public static void main(String[] args) {
    ExecutorService executorService = Executors.newCachedThreadPool();
    executorService.execute(() -&gt; {
        try {
            Thread.sleep(2000);
            System.out.println("Thread run");
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    });
    executorService.shutdownNow();
    System.out.println("Main run");
}</code></pre><pre><code class="java">Main run
java.lang.InterruptedException: sleep interrupted
    at java.lang.Thread.sleep(Native Method)
    at ExecutorInterruptExample.lambda$main$0(ExecutorInterruptExample.java:9)
    at ExecutorInterruptExample$$Lambda$1/1160460865.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
    at java.lang.Thread.run(Thread.java:745)</code></pre><p>å¦‚æœåªæƒ³ä¸­æ–­ Executor ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ submit() æ–¹æ³•æ¥æäº¤ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª <code>Future&lt;?&gt;</code> å¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨è¯¥å¯¹è±¡çš„ cancel(true) æ–¹æ³•å°±å¯ä»¥ä¸­æ–­çº¿ç¨‹ã€‚</p><pre><code class="java">Future&lt;?&gt; future = executorService.submit(() -&gt; {
    // ..
});
future.cancel(true);</code></pre><h2>çº¿ç¨‹ä¹‹é—´çš„åä½œ</h2><p>å½“å¤šä¸ªçº¿ç¨‹å¯ä»¥ä¸€èµ·å·¥ä½œå»è§£å†³æŸä¸ªé—®é¢˜æ—¶ï¼Œå¦‚æœæŸäº›éƒ¨åˆ†å¿…é¡»åœ¨å…¶å®ƒéƒ¨åˆ†ä¹‹å‰å®Œæˆï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹çº¿ç¨‹è¿›è¡Œåè°ƒã€‚</p><h3>join()</h3><h4>æ¡ˆä¾‹</h4><p>åœ¨çº¿ç¨‹ä¸­è°ƒç”¨å¦ä¸€ä¸ªçº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œä¼šå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œè€Œä¸æ˜¯å¿™ç­‰å¾…ï¼Œç›´åˆ°ç›®æ ‡çº¿ç¨‹ç»“æŸã€‚</p><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œè™½ç„¶ b çº¿ç¨‹å…ˆå¯åŠ¨ï¼Œä½†æ˜¯å› ä¸ºåœ¨ b çº¿ç¨‹ä¸­è°ƒç”¨äº† a çº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œb çº¿ç¨‹ä¼šç­‰å¾… a çº¿ç¨‹ç»“æŸæ‰ç»§ç»­æ‰§è¡Œï¼Œå› æ­¤æœ€åèƒ½å¤Ÿä¿è¯ a çº¿ç¨‹çš„è¾“å‡ºå…ˆäº b çº¿ç¨‹çš„è¾“å‡ºã€‚</p><pre><code class="java">public class JoinExample {

    private class A extends Thread {
        @Override
        public void run() {
            System.out.println("A");
        }
    }

    private class B extends Thread {

        private A a;

        B(A a) {
            this.a = a;
        }

        @Override
        public void run() {
            try {
                a.join();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println("B");
        }
    }

    public void test() {
        A a = new A();
        B b = new B(a);
        b.start();
        a.start();
    }
}</code></pre><pre><code class="java">public static void main(String[] args) {
    JoinExample example = new JoinExample();
    example.test();
}</code></pre><pre><code class="java">A
B</code></pre><h4>åŸç†</h4><p><img referrerpolicy="no-referrer" src="/img/remote/1460000045398711" alt="" title="" loading="lazy"/></p><pre><code class="java">public final synchronized void join(long millis)
throws InterruptedException {
    long base = System.currentTimeMillis();
    long now = 0;

    if (millis &lt; 0) {
        throw new IllegalArgumentException("timeout value is negative");
    }

    if (millis == 0) {
        while (isAlive()) {//æ£€æŸ¥çº¿ç¨‹æ˜¯å¦å­˜æ´»ï¼Œåªè¦çº¿ç¨‹è¿˜æ²¡ç»“æŸï¼Œä¸»çº¿ç¨‹å°±ä¼šä¸€ç›´é˜»å¡
            wait(0);//è¿™é‡Œçš„waitè°ƒç”¨çš„æœ¬åœ°æ–¹æ³•ã€‚
        }
    } else {//ç­‰å¾…ä¸€æ®µæŒ‡å®šçš„æ—¶é—´
        while (isAlive()) {
            long delay = millis - now;
            if (delay &lt;= 0) {
                break;
            }
            wait(delay);
            now = System.currentTimeMillis() - base;
        }
    }
}</code></pre><p>ä»æºç æ¥çœ‹ï¼Œå®é™…ä¸Šjoinæ–¹æ³•å°±æ˜¯è°ƒç”¨äº†waitæ–¹æ³•æ¥ä½¿å¾—çº¿ç¨‹é˜»å¡ï¼Œä¸€ç›´åˆ°çº¿ç¨‹ç»“æŸè¿è¡Œã€‚æ³¨æ„åˆ°ï¼Œjoinæ–¹æ³•å‰çš„synchronizedä¿®é¥°ç¬¦ï¼Œå®ƒç›¸å½“äºï¼š</p><pre><code class="java">public final void join(long millis){
 synchronized(this){
        //ä»£ç å—
    }
}</code></pre><p>ä¹Ÿå°±æ˜¯è¯´åŠ é”çš„å¯¹è±¡å³è°ƒç”¨è¿™ä¸ªé”çš„çº¿ç¨‹å¯¹è±¡ï¼Œåœ¨main()æ–¹æ³•ä¸­å³ä¸ºt1ï¼ŒæŒæœ‰è¿™ä¸ªé”çš„æ˜¯ä¸»çº¿ç¨‹å³main()æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ä»£ç ç›¸å½“äºå¦‚ä¸‹ï¼š</p><pre><code class="java">//t1.join()å‰çš„ä»£ç 
synchronized (t1) {
 // è°ƒç”¨è€…çº¿ç¨‹è¿›å…¥ t1 çš„ waitSet ç­‰å¾…, ç›´åˆ° t1 è¿è¡Œç»“æŸ
 while (t1.isAlive()) {
  t1.wait(0);
 }
}
//t1.join()åçš„ä»£ç </code></pre><p>ä¹Ÿå› æ­¤ä¸»çº¿ç¨‹è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œç›´åˆ° t1 çº¿ç¨‹ç»“æŸã€‚</p><blockquote><p>è¿™é‡Œå¯èƒ½ä¼šæœ‰å¾ˆå¤šäººä¼šæœ‰ç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆt1.waitäº†ï¼Œé˜»å¡çš„ä¸æ˜¯t1ï¼Œè€Œæ˜¯ä¸»çº¿ç¨‹ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œå¦‚æœè¦é˜»å¡t1ï¼Œé‚£ä¹ˆå°±åº”è¯¥åœ¨t1çš„run æ–¹æ³•é‡Œè¿›è¡Œé˜»å¡ï¼Œå¦‚åœ¨runæ–¹æ³•é‡Œå†™wait()ï¼›ï¼ˆå½“ç„¶è¿˜æœ‰suspendæ–¹æ³•ï¼Œè¿™å±äºéJavaå±‚é¢ï¼Œå¦è¯´ï¼‰</p><p>è€Œè¿™é‡Œçš„ wait æ–¹æ³•è¢«è°ƒç”¨ä»¥åï¼Œæ˜¯è®©æŒæœ‰é”çš„çº¿ç¨‹è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œå³ä¸»çº¿ç¨‹è°ƒç”¨ï¼Œå› æ­¤ t1 çº¿ç¨‹å¹¶ä¸ä¼šè¢«é˜»å¡ï¼Œé˜»å¡çš„æ˜¯ä¸»çº¿ç¨‹ã€‚</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œjoinæ–¹æ³•æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œå½“ä¸»çº¿ç¨‹è°ƒç”¨t1.join()æ–¹æ³•æ—¶ï¼Œä¸»çº¿ç¨‹å…ˆè·å¾—äº†t1å¯¹è±¡çš„é”ï¼Œéšåè¿›å…¥æ–¹æ³•ï¼Œè°ƒç”¨äº†t1å¯¹è±¡çš„wait()æ–¹æ³•ï¼Œä½¿ä¸»çº¿ç¨‹è¿›å…¥äº†t1å¯¹è±¡çš„ç­‰å¾…æ± ã€‚</p><p>é‚£ä¹ˆé—®é¢˜åœ¨äºï¼Œè¿™é‡Œåªçœ‹åˆ°äº†waitæ–¹æ³•ï¼Œå´å¹¶æ²¡æœ‰çœ‹åˆ°notifyæˆ–è€…æ˜¯notifyAllæ–¹æ³•ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹åœ¨é‚£é‡Œè¢«å”¤é†’å‘¢ï¼Ÿ</p><p>è¿™é‡Œå‚è€ƒjvmçš„ä»£ç ï¼š</p><pre><code class="java">static void ensure_join(JavaThread* thread) {

 Handle threadObj(thread, thread-&gt;threadObj());

 ObjectLocker lock(threadObj, thread);

 hread-&gt;clear_pending_exception();

 //è¿™ä¸€å¥ä¸­çš„TERMINATEDè¡¨ç¤ºè¿™æ˜¯çº¿ç¨‹ç»“æŸä»¥åè¿è¡Œçš„
 java_lang_Thread::set_thread_status(threadObj(), java_lang_Thread::TERMINATED);

    //è¿™é‡Œä¼šæ¸…æ¥šnativeçº¿ç¨‹ï¼ŒisAlive()æ–¹æ³•ä¼šè¿”å›false
    java_lang_Thread::set_thread(threadObj(), NULL);

 //threadå°±æ˜¯å½“å‰çº¿ç¨‹ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•å”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚
 lock.notify_all(thread);

 hread-&gt;clear_pending_exception();

}</code></pre><p>å…¶å®æ˜¯jvmè™šæ‹Ÿæœºä¸­å­˜åœ¨æ–¹æ³•lock.notify_all(thread)ï¼Œåœ¨t1çº¿ç¨‹ç»“æŸä»¥åï¼Œä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œæœ€åå”¤é†’ä¸»çº¿ç¨‹ã€‚</p><p>æ‰€ä»¥ç®€åŒ–ä¸€ä¸‹ï¼Œæµç¨‹å³ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000045398712" alt="" title="" loading="lazy"/></p><h3>wait() notify() notifyAll()</h3><p>è°ƒç”¨ wait() ä½¿å¾—çº¿ç¨‹ç­‰å¾…æŸä¸ªæ¡ä»¶æ»¡è¶³ï¼Œçº¿ç¨‹åœ¨ç­‰å¾…æ—¶ä¼šè¢«æŒ‚èµ·ï¼Œå½“å…¶ä»–çº¿ç¨‹çš„è¿è¡Œä½¿å¾—è¿™ä¸ªæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå…¶å®ƒçº¿ç¨‹ä¼šè°ƒç”¨ notify() æˆ–è€… notifyAll() æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ã€‚</p><p>å®ƒä»¬éƒ½å±äº Object çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸å±äº Threadã€‚</p><p>åªèƒ½ç”¨åœ¨åŒæ­¥æ–¹æ³•synchronizedæˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º IllegalMonitorStateExeceptionã€‚</p><p>ä½¿ç”¨ wait() æŒ‚èµ·æœŸé—´ï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾é”ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœæ²¡æœ‰é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±æ— æ³•è¿›å…¥å¯¹è±¡çš„åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ï¼Œé‚£ä¹ˆå°±æ— æ³•æ‰§è¡Œ notify() æˆ–è€… notifyAll() æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ï¼Œé€ æˆæ­»é”ã€‚</p><pre><code class="java">public class WaitNotifyExample {
    public synchronized void before() {
        System.out.println("before");
        notifyAll();
    }

    public synchronized void after() {
        try {
            wait();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println("after");
    }
}</code></pre><pre><code class="java">public static void main(String[] args) {
    ExecutorService executorService = Executors.newCachedThreadPool();
    WaitNotifyExample example = new WaitNotifyExample();
    executorService.execute(() -&gt; example.after());
    executorService.execute(() -&gt; example.before());
}</code></pre><pre><code class="java">before
after</code></pre><p><strong>wait() å’Œ sleep() çš„åŒºåˆ«</strong></p><ul><li>wait() æ˜¯ Object çš„æ–¹æ³•ï¼Œè€Œ sleep() æ˜¯ Thread çš„é™æ€æ–¹æ³•ï¼›</li><li>wait() ä¼šé‡Šæ”¾é”ï¼Œsleep() ä¸ä¼šã€‚</li></ul><h3>await() signal() signalAll()</h3><p>java.util.concurrent ç±»åº“ä¸­æä¾›äº† Condition ç±»æ¥å®ç°çº¿ç¨‹ä¹‹é—´çš„åè°ƒï¼Œå¯ä»¥åœ¨ Condition ä¸Šè°ƒç”¨ await() æ–¹æ³•ä½¿çº¿ç¨‹ç­‰å¾…ï¼Œå…¶å®ƒçº¿ç¨‹è°ƒç”¨ signal() æˆ– signalAll() æ–¹æ³•å”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚ç›¸æ¯”äº wait() è¿™ç§ç­‰å¾…æ–¹å¼ï¼Œawait() å¯ä»¥æŒ‡å®šç­‰å¾…çš„æ¡ä»¶ï¼Œå› æ­¤æ›´åŠ çµæ´»ã€‚</p><p>ä½¿ç”¨ Lock æ¥è·å–ä¸€ä¸ª Condition å¯¹è±¡ã€‚</p><pre><code class="java">public class AwaitSignalExample {
    private Lock lock = new ReentrantLock();
    private Condition condition = lock.newCondition();

    public void before() {
        lock.lock();
        try {
            System.out.println("before");
            condition.signalAll();
        } finally {
            lock.unlock();
        }
    }

    public void after() {
        lock.lock();
        try {
            condition.await();
            System.out.println("after");
        } catch (InterruptedException e) {
            e.printStackTrace();
        } finally {
            lock.unlock();
        }
    }
}</code></pre><pre><code class="java">public static void main(String[] args) {
    ExecutorService executorService = Executors.newCachedThreadPool();
    AwaitSignalExample example = new AwaitSignalExample();
    executorService.execute(() -&gt; example.after());
    executorService.execute(() -&gt; example.before());
}</code></pre><pre><code class="java">before
after</code></pre><h2>çº¿ç¨‹ä¸­çš„å¼‚å¸¸å¤„ç†</h2><h3>Runnableä¸­å¼‚å¸¸å¦‚ä½•è¢«åæ‰</h3><p><code>Runnable</code> æ¥å£çš„ <code>run()</code> æ–¹æ³•ä¸å…è®¸æŠ›å‡ºä»»ä½•è¢«æ£€æŸ¥çš„å¼‚å¸¸ï¼ˆchecked exceptionsï¼‰ï¼Œåªèƒ½å¤„ç†æˆ–æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼ˆunchecked exceptionsï¼‰ã€‚å½“åœ¨ <code>run()</code> æ–¹æ³•å†…å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼åœ°æ•è·å’Œå¤„ç†è¿™äº›å¼‚å¸¸ï¼Œå®ƒä»¬é€šå¸¸ä¼šåœ¨æ‰§è¡Œè¯¥ <code>Runnable</code> çš„çº¿ç¨‹ä¸­è¢«â€œåæ‰â€ï¼Œå³å¼‚å¸¸ä¼šå¯¼è‡´çº¿ç¨‹ç»ˆæ­¢ï¼Œä½†ä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹çš„æ‰§è¡Œã€‚</p><pre><code class="java">public void uncaughtException(Thread t, Throwable e) {
   if (parent != null) {
        parent.uncaughtException(t, e);
   } else {
        Thread.UncaughtExceptionHandler ueh =
            Thread.getDefaultUncaughtExceptionHandler();
        if (ueh != null) {
            ueh.uncaughtException(t, e);
        } else if (!(e instanceof ThreadDeath)) {
            System.err.print("Exception in thread \""
                             + t.getName() + "\" ");
            e.printStackTrace(System.err);
        }
    }
}</code></pre><p>è§£å†³æ–¹æ¡ˆï¼š</p><ol><li><p>åœ¨runæ–¹æ³•ä¸­æ˜¾ç¤ºçš„æ•è·å¼‚å¸¸</p><pre><code class="java">public void run() {
    try {
        // å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç 
    } catch (Exception e) {
        // è®°å½•æ—¥å¿—æˆ–å¤„ç†å¼‚å¸¸
        throw new RuntimeException(e);
    }
}</code></pre></li><li><p>ä¸ºåˆ›å»ºçš„çº¿ç¨‹è®¾ç½®ä¸€ä¸ª<code>UncaughtExceptionHandler</code></p><pre><code class="java">Thread t = new Thread(() -&gt; {
   int i = 1 / 0;
}, "t1");
t.setUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() {
   @Override
   public void uncaughtException(Thread t, Throwable e) {
        logger.error('---', e);
   }
});</code></pre></li><li><p>ä½¿ç”¨<code>Callable</code>ä»£æ›¿<code>Runnable</code>ï¼Œ<code>Callable</code>çš„<code>call</code>æ–¹æ³•å…è®¸æŠ›å‡ºå¼‚å¸¸ï¼Œç„¶åå¯ä»¥é€šè¿‡æäº¤ç»™<code>ExecutorService</code>è¿”å›çš„<code>Future</code>æ¥æ•è·å’Œå¤„ç†è¿™äº›å¼‚å¸¸</p><pre><code class="java">ExecutorService executor = Executors.newFixedThreadPool(1);
Future&lt;?&gt; future = executor.submit(() -&gt; {
    // å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç 
});

try {
    future.get(); // è¿™é‡Œä¼šæ•è·åˆ°Callableä¸­çš„å¼‚å¸¸
} catch (ExecutionException e) {
    Throwable cause = e.getCause(); // è·å–åŸå§‹å¼‚å¸¸
}</code></pre></li></ol><h3>Callableä¸­å¼‚å¸¸å¦‚ä½•è¢«åæ‰</h3><pre><code class="java">class MyCallable implements Callable&lt;String&gt; {
    @Override
    public String call() throws Exception {
        System.out.println("===&gt; å¼€å§‹æ‰§è¡Œcallable");
        int i = 1 / 0; //å¼‚å¸¸çš„åœ°æ–¹
        return "callableçš„ç»“æœ";
    }
}

public class CallableAndRunnableTest {

    public static void main(String[] args) {
        System.out.println(" =========&gt; main start ");
        ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor(3, 5, 1, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(100));
        Future&lt;String&gt; submit = threadPoolExecutor.submit(new MyCallable());
        try {
            TimeUnit.SECONDS.sleep(2);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println(" =========&gt; main end ");
    }
}</code></pre><p>è¿è¡Œç»“æœ</p><pre><code class="java"> =========&gt; main start 
 ===&gt; å¼€å§‹æ‰§è¡Œcallable
 =========&gt; main end </code></pre><p>æºç å¦‚ä¸‹ï¼š</p><pre><code class="java">public &lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task) {
    if (task == null) throw new NullPointerException();
    RunnableFuture&lt;T&gt; ftask = newTaskFor(task);
    execute(ftask);
    return ftask;
}

protected &lt;T&gt; RunnableFuture&lt;T&gt; newTaskFor(Callable&lt;T&gt; callable) {
    return new FutureTask&lt;T&gt;(callable);
}</code></pre><p><code>RunableFuture&lt;T&gt;</code> æ˜¯ä¸ªæ¥å£ï¼Œä½†æ˜¯å®ƒç»§æ‰¿äº†Runnable æ¥å£ ï¼Œ å®ç°ç±»æ˜¯ FutureTask ï¼Œå› æ­¤å°±éœ€è¦çœ‹ä¸‹ FutureTaské‡Œçš„runæ–¹æ³• æ˜¯ä¸æ˜¯å’Œ æ„é€ æ—¶çš„Callable æœ‰å…³ç³»ï¼š</p><pre><code class="java">public void run() {
     // çŠ¶æ€ä¸å±äºåˆå§‹çŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œä¸è¿›è¡Œåç»­é€»è¾‘å¤„ç†
     // é‚£ä¹Ÿå°±æ˜¯run æ–¹æ³•åªèƒ½æ‰§è¡Œä¸€æ¬¡
     if (state != NEW ||
        !UNSAFE.compareAndSwapObject(this, runnerOffset,
                                   null, Thread.currentThread()))
        return;
    try { 
        Callable&lt;V&gt; c = callable;
        if (c != null &amp;&amp; state == NEW) {
            V result;
            // 
            boolean ran;
            try {
                // æ‰§è¡Œ Callable é‡Œçš„ call æ–¹æ³• ï¼Œå°†ç»“æœå­˜å…¥resultå˜é‡ä¸­
                result = c.call();
                ran = true;
            } catch (Throwable ex) {
                result = null;
                ran = false;
                 // call æ–¹æ³•å¼‚å¸¸ ï¼Œ è®°å½•ä¸‹å¼‚å¸¸ç»“æœ
                setException(ex);
            }
            // call æ–¹æ³•æ­£å¸¸æ‰§è¡Œå®Œæ¯• ï¼Œè¿›è¡Œç»“æœå­˜å‚¨
            if (ran)
                set(result);
        }
    } finally {
        // runner must be non-null until state is settled to
        // prevent concurrent calls to run()
        runner = null;
        // state must be re-read after nulling runner to prevent
        // leaked interrupts
        int s = state;
        if (s &gt;= INTERRUPTING)
            handlePossibleCancellationInterrupt(s);
    }
}</code></pre><p>æ¥ä¸‹æ¥å°±è¦çœ‹ï¼Œå¦‚æœå­˜å‚¨æ­£å¸¸ç»“æœçš„<code>set(result)</code>æ–¹æ³• å’Œå­˜å‚¨å¼‚å¸¸ç»“æœçš„ <code>setException(ex)</code> æ–¹æ³•</p><pre><code class="java">protected void setException(Throwable t) {
    if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {
        outcome = t;
        UNSAFE.putOrderedInt(this, stateOffset, EXCEPTIONAL); // final state
        finishCompletion();
    }
}

protected void set(V v) {
    if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {
        outcome = v;
        UNSAFE.putOrderedInt(this, stateOffset, NORMAL); // final state
        finishCompletion();
    }
}</code></pre><p>è¿™ä¸¤ä¸ªä»£ç éƒ½åšäº†ä¸€ä¸ªæ“ä½œï¼Œå°±æ˜¯å°†æ­£å¸¸ç»“æœ<code>result</code> å’Œ å¼‚å¸¸ç»“æœ <code>exception</code> éƒ½èµ‹å€¼ç»™äº† <code>outcome</code> è¿™ä¸ªå˜é‡ ã€‚</p><p>æ¥ç€å†çœ‹ä¸‹futureçš„getæ–¹æ³•</p><pre><code class="java">//è¿™é‡Œæœ‰å¿…é¡»çœ‹ä¸‹Taskçš„ç»“æŸæ—¶çš„çŠ¶æ€ï¼Œå¦‚æœæ­£å¸¸ç»“æŸï¼ŒçŠ¶æ€ä¸º NORMAL ï¼Œ å¼‚å¸¸ç»“æœï¼ŒçŠ¶æ€ä¸ºEXCEPTIONAL ã€‚ çœ‹ä¸‹å‡ ä¸ªçŠ¶æ€çš„å®šä¹‰ï¼Œå¦‚ä¸‹ï¼š  
private volatile int state;
private static final int NEW          = 0;
private static final int COMPLETING   = 1;
private static final int NORMAL       = 2;
private static final int EXCEPTIONAL  = 3;
private static final int CANCELLED    = 4;
private static final int INTERRUPTING = 5;
private static final int INTERRUPTED  = 6;

/**
* @throws CancellationException {@inheritDoc}
*/
public V get() throws InterruptedException, ExecutionException {
    int s = state;
    // NORMAL(2) ã€EXCEPTIONAL(3) éƒ½å¤§äº COMPLETINGï¼ˆ1ï¼‰,æ‰€ä»¥Taskç»“æŸä¹‹åï¼Œä¸ä¼šèµ°è¯¥if
    if (s &lt;= COMPLETING)
         s = awaitDone(false, 0L);
    // é‡ç‚¹ï¼š è¿”å›ç»“æœ
    return report(s);
}

private V report(int s) throws ExecutionException {
    // ä¹‹å‰æ­£å¸¸ç»“æœæˆ–è€…å¼‚å¸¸éƒ½å­˜æ”¾åœ¨Object outcomme ä¸­äº†
    Object x = outcome;
    // æ­£å¸¸è¿”å›
    if (s == NORMAL)
        return (V)x;
    // EXCEPTIONAL(3) å°äº CANCELLED(4) ï¼Œæ‰€ä»¥ä¸ä¼šèµ°è¯¥ifåˆ†æ”¯ï¼Œç›´æ¥åç»­çš„throw æŠ›å¼‚å¸¸çš„é€»è¾‘
    if (s &gt;= CANCELLED)
        throw new CancellationException();
    // ä¸ç­‰äºNORMAL ä¸” å¤§äºç­‰äº CANCELLED  ,  å†ç»“åˆ è°ƒç”¨ report(int s ) ä¹‹å‰ä¹Ÿåšäº†state çš„è¿‡æ»¤
    //åˆ°è¿™ä¸€æ­¥ï¼Œé‚£åªèƒ½æ˜¯EXCEPTIONAL(3) 
    throw new ExecutionException((Throwable)x);
}</code></pre><p>å› æ­¤å¯ä»¥é€šè¿‡getæ–¹æ³•è·å–åˆ°å¼‚å¸¸ç»“æœ</p>]]></description></item><item>    <title><![CDATA[HarmonyOS 6 æ™ºèƒ½å¸¦åŠåº”ç”¨å¼€å‘ä¹‹æ’­æŠ¥ç»„ä»¶æ¥å…¥å®è·µ è½»å£å‘³ ]]></title>    <link>https://segmentfault.com/a/1190000047586391</link>    <guid>https://segmentfault.com/a/1190000047586391</guid>    <pubDate>2026-02-02 08:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h4>èƒŒæ™¯ä»‹ç»</h4><p>ä¸ºäº†å®Œå–„â€æ™ºèƒ½å¸¦åŠâ€œåº”ç”¨åŠŸèƒ½ï¼Œè®©åº”ç”¨æ›´å‹å¥½ï¼Œåœ¨å¸¦åŠè¯¦æƒ…é¡µæ¥å…¥äº†æ’­æŠ¥ç©ºé—´ï¼Œç‚¹å‡»åå¯ä»¥æ’­æŠ¥å¸¦åŠæè¿°å’Œç‰©å“åˆ—è¡¨ã€‚å…¥å£åŠäº¤äº’æ•ˆæœå¦‚ä¸‹ï¼š<br/><img width="706" height="1530" referrerpolicy="no-referrer" src="/img/bVdnPyf" alt="image.png" title="image.png"/></p><p>æ’­æŠ¥è¯¦æƒ…é¡µå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br/><img width="708" height="1508" referrerpolicy="no-referrer" src="/img/bVdnPyr" alt="image.png" title="image.png" loading="lazy"/></p><h4>æ’­æŠ¥èƒ½åŠ›ä»‹ç»</h4><p>æœ—è¯»æ§ä»¶TextReaderæ˜¯Speech Kitï¼ˆåœºæ™¯åŒ–è¯­éŸ³æœåŠ¡ï¼‰çš„ä¸€é¡¹èƒ½åŠ›ï¼ŒSpeech Kit é›†æˆäº†è¯­éŸ³ç±»AIèƒ½åŠ›ï¼Œå‡ºæœ—è¯»å¤–åŒ…æ‹¬AIå­—å¹•æ§ä»¶ï¼ˆAICaptionComponentï¼‰èƒ½åŠ›ï¼Œä¾¿äºç”¨æˆ·ä¸è®¾å¤‡è¿›è¡Œäº’åŠ¨ï¼Œä¸ºç”¨æˆ·å®ç°æœ—è¯»æ–‡ç« ã€‚<br/>æœ—è¯»æ§ä»¶åº”ç”¨å¹¿æ³›ï¼Œä¾‹å¦‚åœ¨ç”¨æˆ·ä¸æ–¹ä¾¿æˆ–è€…æ— æ³•æŸ¥çœ‹å±å¹•æ–‡å­—æ—¶ï¼Œä¸ºç”¨æˆ·æœ—è¯»æ–°é—»ï¼Œæä¾›èµ„è®¯ã€‚æœ—è¯»æ§ä»¶æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br/><img width="723" height="380" referrerpolicy="no-referrer" src="/img/bVdnPyA" alt="image.png" title="image.png" loading="lazy"/></p><p>æœ—è¯»æ§ä»¶ä¸»è¦æ¥å£å¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th align="left">æ¥å£å</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>init(context:Â common.BaseContext, readParams:Â ReaderParam): Promise&lt;void&gt;</code></td><td align="left">åˆå§‹åŒ–TextReaderã€‚</td></tr><tr><td align="left"><code>start(readInfoList:Â ReadInfo[], articleId?: string): Promise&lt;void&gt;</code></td><td align="left">å¯åŠ¨TextReaderã€‚</td></tr><tr><td align="left">on(type: string, callback: function): void</td><td align="left">æ³¨å†Œæ‰€æœ‰äº‹ä»¶å›è°ƒ</td></tr></tbody></table><blockquote>æ³¨æ„ï¼šæœ—è¯»æ§ä»¶ä¸æ”¯æŒæ¨¡æ‹Ÿå™¨</blockquote><h4>æ’­æŠ¥èƒ½åŠ›æ¥å…¥</h4><h5>1ã€åˆå§‹åŒ–</h5><p>é¦–å…ˆéœ€è¦åˆå§‹åŒ–æœ—è¯»æ§ä»¶ï¼š</p><pre><code class="ts">async initReader() {  
  if (this.isReaderInit || this.isInitializingReader) {  
    Logger.i(TAG, "initReader bypassed: isReaderInit=" + this.isReaderInit + ", isInitializingReader=" + this.isInitializingReader);  
    return;  
  }  
  this.isInitializingReader = true;  
  Logger.i(TAG, "initReader called");  
  const readerParam: TextReader.ReaderParam = {  
    isVoiceBrandVisible: true,  
    keepBackgroundRunning: true,  
    businessBrandInfo: {  
      panelName: 'æ¸…å•æœ—è¯»',  
      panelIcon: $r('app.media.startIcon')  
    }  
  }  try {  
    let context: Context | undefined = this.getUIContext()?.getHostContext() ?? getContext(this);  
    Logger.i(TAG, "initReader context available: " + (context !== undefined));  
    if (context) {  
      await TextReader.init(context, readerParam);  
      Logger.i(TAG, "TextReader.init success");  
      this.isReaderInit = true;  
      this.setReaderActionListener();  
    }  
  } catch (err) {  
    const error: Record&lt;string, Object&gt; = err as Record&lt;string, Object&gt;;  
    Logger.e(TAG, `TextReader failed to init. Code: ${error['code']}, message: ${error['message']}`);  
  } finally {  
    this.isInitializingReader = false;  
  }  
}</code></pre><p>ä¸»è¦æ˜¯è°ƒç”¨<code>TextReader.init(context, readerParam);</code>,ä¸ºäº†é¿å…é‡å¤åˆå§‹åŒ–åŠ äº†çŠ¶æ€å˜é‡é”ã€‚<br/>åˆå§‹åŒ–å®Œæˆåè®¾ç½®å›è°ƒç›‘å¬ï¼š</p><pre><code class="ts">setReaderActionListener() {  
  TextReader.on('stateChange', (state: TextReader.ReadState) =&gt; {  
    this.onStateChanged(state);  
  });  
  TextReader.on('requestMore', () =&gt; {  
    TextReader.loadMore([], true);  
  })  
}
onStateChanged = (state: TextReader.ReadState) =&gt; {  
  if (this.readInfoList.some((info: TextReader.ReadInfo) =&gt; info.id === state.id)) {  
    this.readState = state.state;  
  } else {  
    this.readState = ReadStateCode.WAITING;  
  }  
}</code></pre><h5>2ã€æ·»åŠ æœ—è¯»ç»„ä»¶</h5><p>åœ¨é¡µé¢å¸ƒå±€ä¸­æ·»åŠ æœ—è¯»ç»„ä»¶TextReaderIconï¼Œå¹¶ä¸”æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç‚¹å‡»äº‹ä»¶ä¸­è°ƒç”¨<code>TextReader.start</code>å¼€å§‹æœ—è¯»ï¼Œæ–¹æ³•ä¸­å¡«å…¥æœ—è¯»çš„æ–‡æœ¬åˆ—è¡¨ã€‚</p><pre><code class="ts">Stack() {  
  TextReaderIcon({ readState: this.readState })  
    .width(22)  
    .height(22)  
}  
.width(36)  
.height(36)  
.borderRadius(18)  
.backgroundColor('rgba(255,255,255,0.1)')  
.margin({ right: 12 })  
.onClick(() =&gt; {  
  if (!this.isReaderInit) {  
    ToastUtils.showToast(this.getUIContext(), 'æœ—è¯»ç»„ä»¶åˆå§‹åŒ–ä¸­...')  
    void this.initReader();  
    return  
  }  
  try {  
    void TextReader.start(this.readInfoList, this.readInfoList[0]?.id);  
  } catch (err) {  
    const error: Record&lt;string, Object&gt; = err as Record&lt;string, Object&gt;;  
    Logger.e(TAG, `TextReader failed to start. Code: ${error['code']}, message: ${error['message']}`);  
  }  
})</code></pre><p>åœ¨è°ƒç”¨å¼€å§‹æœ—è¯»å‰åˆ¤æ–­æ˜¯å¦åˆå§‹åŒ–æœ—è¯»æ§ä»¶ï¼Œå¦‚æœæ²¡æœ‰åˆå§‹åŒ–åˆ™æ‰§è¡Œåˆå§‹åŒ–ã€‚<br/>readInfoListå°†å¸¦åŠæ¸…å•å’Œç‰©å“å†…å®¹æ–‡æœ¬è¿›è¡Œæ‹¼æ¥ã€‚</p><h5>3ã€é‡Šæ”¾èµ„æº</h5><p>åœ¨é¡µé¢å…³é—­å›è°ƒä¸­é‡Šæ”¾èµ„æºï¼š</p><pre><code class="ts">TextReader.stop();  
TextReader.release();  
TextReader.off('stateChange');  
TextReader.off('requestMore');</code></pre><h4>æ³¨æ„äº‹é¡¹</h4><p>åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä¸€äº›å‘ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚</p><h5>1ã€æ’­æ”¾æ—¶æç¤ºæœªåˆå§‹åŒ–</h5><p>å¢åŠ çŠ¶æ€å˜é‡ï¼Œå¦‚æœæ’­æ”¾ç‚¹å‡»æ—¶æœªåˆå§‹åŒ–åˆ™é‡æ–°è¿›è¡Œåˆå§‹åŒ–ã€‚</p><h5>2ã€è®¾ç½®æ’­æ”¾æŒ‰é’®é¢œè‰²</h5><p>åº”ç”¨ä¸»é¢˜é»‘è‰²ï¼ŒæŒ‰é’®ä¹Ÿæ˜¯æ˜¾ç¤ºé»‘è‰²ï¼Œå¯¼è‡´æŒ‰é’®ä¸æ˜æ˜¾ï¼ŒæŸ¥çœ‹ç©ºé—´å±æ€§ï¼Œæ²¡æœ‰é…ç½®æŒ‰é’®é¢œè‰²çš„åœ°æ–¹ï¼Œæœ€åå‘ç°æ˜¯éœ€è¦è®¾ç½®åº”ç”¨ä¸»é¢˜è‰²ã€‚</p><ul><li>å¦‚æœåº”ç”¨æƒ³è¦è·Ÿéšç³»ç»Ÿåˆ‡æ¢æ·±æµ…è‰²æ¨¡å¼ï¼Œè¯·å°†é¢œè‰²æ¨¡å¼è®¾ç½®ä¸ºCOLOR_MODE_NOT_SETã€‚</li><li>å¦‚æœåº”ç”¨æƒ³è¦ä¸»åŠ¨é…ç½®é¢œè‰²æ¨¡å¼ï¼Œè¯·å°†é¢œè‰²æ¨¡å¼è®¾ç½®ä¸ºCOLOR_MODE_LIGHTï¼ˆæµ…è‰²ï¼‰æˆ–è€…COLOR_MODE_DARKï¼ˆæ·±è‰²ï¼‰ã€‚</li></ul><p>ä¸‹é¢ä»¥è‡ªåŠ¨è·Ÿéšç³»ç»Ÿåˆ‡æ¢çš„ç¤ºä¾‹ï¼š</p><pre><code class="ts">onCreate(): void {
  this.context.getApplicationContext().setColorMode(ConfigurationConstant.ColorMode.COLOR_MODE_NOT_SET);
}</code></pre><h5>3ã€åº”ç”¨åˆ‡åå°åœæ­¢æ’­æ”¾</h5><p>è‹¥è¦åœ¨åå°æ’­æ”¾éœ€è¦é…ç½®é•¿æ—¶ä»»åŠ¡ï¼Œéœ€è¦åœ¨module.json5é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ohos.permission.KEEP_BACKGROUND_RUNNINGæƒé™ï¼Œå¹¶ä¸”åŠ å…¥backgroundModesé€‰é¡¹ï¼Œç„¶ååœ¨readerParamä¸­å°†keepBackgroundRunningé…ç½®ä¸ºtrueï¼Œç¡®ä¿æœ—è¯»æ§ä»¶åå°æ’­æŠ¥æ­£å¸¸ã€‚</p><pre><code class="json">// module.json5
{
  "module": {
    // ...
    "requestPermissions": [
      {
        "name": "ohos.permission.KEEP_BACKGROUND_RUNNING",
        "usedScene": {
          "abilities": [
            "FormAbility"
          ],
          "when": "inuse"
        }
      },
    ],
    "abilities": [
      {
        // ...
        "backgroundModes": [
          "audioPlayback"
        ],
        // ...
      }
    ]
  }
}

// Index.ets
async init() {
  const readerParam: TextReader.ReaderParam = {
    // ...
    keepBackgroundRunning: true
  }
}</code></pre><h4>æ€»ç»“</h4><p>é€šè¿‡åœ¨â€œæ™ºèƒ½å¸¦åŠâ€è¯¦æƒ…é¡µæ¥å…¥ TextReader æœ—è¯»æ§ä»¶ï¼Œæœ¬å®è·µå®Œæˆäº†ä»åˆå§‹åŒ–ã€äº‹ä»¶å›è°ƒã€é¡µé¢é›†æˆåˆ°èµ„æºé‡Šæ”¾çš„å…¨é“¾è·¯æ‰“é€šï¼Œæœ‰æ•ˆæå‡äº†åº”ç”¨çš„æ— éšœç¢ä½“éªŒä¸ç”¨æˆ·å‹å¥½æ€§ã€‚å®è·µè¿‡ç¨‹ç³»ç»Ÿæ€§åœ°è§£å†³äº†â€œæœªåˆå§‹åŒ–â€ã€æŒ‰é’®é¢œè‰²é€‚é…ã€åå°æ’­æ”¾ç­‰å…¸å‹é—®é¢˜ï¼Œå¹¶æ€»ç»“å‡ºä»¥ä¸‹å…³é”®ç»éªŒï¼šåšå¥½æ§ä»¶çŠ¶æ€ç®¡ç†ä¸å¼‚å¸¸å®¹é”™ã€ç»“åˆä¸»é¢˜ä¸é¢œè‰²æ¨¡å¼ä¼˜åŒ–è§†è§‰å¯è§æ€§ã€æŒ‰éœ€é…ç½®æƒé™ä¸åå°æ¨¡å¼ä»¥ä¿è¯è¿ç»­æ’­æŠ¥ã€‚è¿™äº›ç»éªŒä¸ºåç»­æ‰©å±•æ’­æŠ¥å†…å®¹å’Œæ‰“é€ ä¸ªæ€§åŒ–è¯­éŸ³ä½“éªŒæ‰“ä¸‹äº†åšå®åŸºç¡€ã€‚</p>]]></description></item><item>    <title><![CDATA[2026 å¹´ windows Python æœ€æ–°ä¸‹è½½å®‰è£…æ•™ç¨‹ ç¨‹åºå‘˜å¾å¸ˆå…„ ]]></title>    <link>https://segmentfault.com/a/1190000047586244</link>    <guid>https://segmentfault.com/a/1190000047586244</guid>    <pubDate>2026-02-02 00:02:17</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>ğŸ“– å‰è¨€</h2><p>æƒ³å­¦ç¼–ç¨‹ï¼ŸPython æ˜¯ä¸ªå¥½é€‰æ‹©ã€‚è¯­æ³•ç®€å•ã€ä¸Šæ‰‹å¿«ï¼Œæ•°æ®åˆ†æå’Œ AI éƒ½èƒ½å¹²ã€‚</p><p>ä½†å¾ˆå¤šäººç¬¬ä¸€æ­¥å°±å¡ä½äº†â€”â€”è£…è½¯ä»¶ã€‚æˆ‘å½“å¹´ç¬¬ä¸€æ¬¡è£… Python ä¹Ÿåœ¨è¿™ä¸ªå‘é‡ŒæŠ˜è…¾äº†åŠå¤©ï¼Œåæ¥æ‰å‘ç°å…¶å®æŒºç®€å•çš„ï¼Œåªæ˜¯æ²¡äººå‘Šè¯‰æˆ‘å“ªäº›é€‰é¡¹è¯¥å‹¾ã€å“ªäº›ä¸è¯¥å‹¾ã€‚</p><p>ä»Šå¤©å°±æŠŠè¿™ä¸ªè¿‡ç¨‹å†™æ¸…æ¥šï¼Œæ¯ä¸€æ­¥éƒ½æœ‰å›¾ï¼Œè·Ÿç€åšå°±è¡Œã€‚</p><p><strong>é¢„è®¡æ—¶é—´ï¼š</strong> 10-15 åˆ†é’Ÿ</p><hr/><h2>ğŸ¯ ä½ ä¼šå­¦åˆ°</h2><ul><li>æ€ä¹ˆä¸‹è½½ Python å®‰è£…åŒ…</li><li>å®‰è£…æ—¶å“ªäº›é€‰é¡¹å¿…é¡»å‹¾</li><li>æ€ä¹ˆæ£€æŸ¥è£…æ²¡è£…å¥½</li><li>ç¯å¢ƒå˜é‡æ˜¯ä¸ªå•¥ã€æ€ä¹ˆé…</li><li>pip æ€ä¹ˆç”¨</li></ul><hr/><h2>ğŸ”§ å‡†å¤‡å·¥ä½œ</h2><p><strong>ç³»ç»Ÿè¦æ±‚ï¼š</strong></p><table><thead><tr><th>é¡¹ç›®</th><th>è¦æ±‚</th></tr></thead><tbody><tr><td>ç³»ç»Ÿ</td><td>Windows 10 æˆ– 11</td></tr><tr><td>ç±»å‹</td><td>64 ä½ï¼ˆç°åœ¨åŸºæœ¬éƒ½æ˜¯ï¼‰</td></tr><tr><td>ç©ºé—´</td><td>500MB å¤Ÿäº†</td></tr><tr><td>ç½‘ç»œ</td><td>éœ€è¦è”ç½‘ä¸‹å®‰è£…åŒ…</td></tr></tbody></table><p><strong>éœ€è¦å‡†å¤‡çš„ï¼š</strong></p><ul><li>èƒ½ä¸Šç½‘</li><li>ç®¡ç†å‘˜æƒé™ï¼ˆè£…è½¯ä»¶éœ€è¦ï¼‰</li></ul><hr/><h2>ğŸ“ å¼€å§‹è£…</h2><h3>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½å®‰è£…åŒ…</h3><h4>1.1 å»å®˜ç½‘ä¸‹</h4><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ï¼š<a href="https://link.segmentfault.com/?enc=fE2mYGxrdJsDcSgbWo7vgg%3D%3D.pBh%2FwcxF2PIavRd1wqPAKH9ZXNsgWnaDATgpUPBxdGCtLdFtmTbNPXEQsdRbr2NB" rel="nofollow" target="_blank">https://www.python.org/downloads/</a></p><p>è¿›å»åèƒ½çœ‹åˆ°ä¸€ä¸ªé»„è‰²å¤§æŒ‰é’®ï¼Œä¸Šé¢å†™ç€æœ€æ–°çš„ç‰ˆæœ¬å·ï¼ˆç›®å‰æ˜¯ 3.13.xï¼‰ã€‚ç‚¹å®ƒå°±å¼€å§‹ä¸‹è½½ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586246" alt="Pythonå®˜ç½‘ä¸‹è½½é¡µé¢" title="Pythonå®˜ç½‘ä¸‹è½½é¡µé¢"/><br/><em>å›¾1ï¼šå®˜ç½‘ä¸‹è½½é¡µé¢</em></p><h4>1.2 é€‰å¯¹ç‰ˆæœ¬</h4><p>å®˜ç½‘ä¸€èˆ¬ä¼šè‡ªåŠ¨è¯†åˆ«ä½ çš„ç³»ç»Ÿï¼Œæ¨èå¯¹åº”çš„ç‰ˆæœ¬ã€‚ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨é€‰ï¼š</p><ul><li><strong>Windows installer (64-bit)</strong>ï¼š64 ä½ç³»ç»Ÿé€‰è¿™ä¸ª</li><li><strong>Windows installer (32-bit)</strong>ï¼š32 ä½ç³»ç»Ÿé€‰è¿™ä¸ª</li></ul><blockquote>ä¸ç¡®å®šè‡ªå·±ç³»ç»Ÿæ˜¯ 32 ä½è¿˜æ˜¯ 64 ä½ï¼Ÿå³é”®ã€Œæ­¤ç”µè„‘ã€â†’ã€Œå±æ€§ã€ï¼Œåœ¨ã€Œè®¾å¤‡è§„æ ¼ã€é‡Œèƒ½çœ‹åˆ°ã€Œç³»ç»Ÿç±»å‹ã€ã€‚</blockquote><h4>1.3 å®˜ç½‘å¤ªæ…¢ï¼Ÿç”¨è¿™ä¸ª</h4><p>å®˜ç½‘æœ‰æ—¶å€™ä¸‹è½½å¾ˆæ…¢ï¼Œæˆ‘ä¼ äº†ä¸ªç½‘ç›˜ï¼š</p><p><strong>ç½‘ç›˜é“¾æ¥ï¼š</strong> <a href="https://link.segmentfault.com/?enc=00ReuMaPITmd%2FXMHS%2ByvwQ%3D%3D.6MyjQ1BO2LLzL6SB6pe8r7ygKARBnxg5KbDcN%2B9fQc0bdQ57o8cWbWUPcW9X5LRd" rel="nofollow" target="_blank">https://pan.quark.cn/s/7186f4aa4c10</a></p><p>é‡Œé¢æ˜¯ Python 3.13.0 çš„ Windows 64 ä½å®‰è£…åŒ…ï¼Œç›´æ¥ä¸‹å°±è¡Œã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586247" alt="ä¸‹è½½åçš„å®‰è£…åŒ…" title="ä¸‹è½½åçš„å®‰è£…åŒ…" loading="lazy"/><br/><em>å›¾2ï¼šå®‰è£…åŒ…æ–‡ä»¶</em></p><hr/><h3>ç¬¬äºŒæ­¥ï¼šå®‰è£…</h3><h4>2.1 å³é”®ç®¡ç†å‘˜è¿è¡Œ</h4><p>æ‰¾åˆ°åˆšä¸‹çš„å®‰è£…åŒ…ï¼ˆæ–‡ä»¶åç±»ä¼¼ <code>python-3.13.0-amd64.exe</code>ï¼‰ï¼Œ<strong>å³é”®</strong>ï¼Œé€‰ã€Œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œã€ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586248" alt="å³é”®ç®¡ç†å‘˜è¿è¡Œ" title="å³é”®ç®¡ç†å‘˜è¿è¡Œ" loading="lazy"/><br/><em>å›¾3ï¼šå³é”®é€‰æ‹©ç®¡ç†å‘˜è¿è¡Œ</em></p><blockquote>âš ï¸ <strong>ä¸€å®šè¦ç®¡ç†å‘˜è¿è¡Œ</strong>ï¼Œä¸ç„¶å¯èƒ½æƒé™ä¸å¤Ÿã€‚</blockquote><h4>2.2 è¿™ä¸€æ­¥æœ€å…³é”®</h4><p>å®‰è£…ç¨‹åºæ‰“å¼€åï¼Œç¬¬ä¸€ä¸ªç•Œé¢æœ‰ä¸ªé€‰é¡¹å¿…é¡»å‹¾ï¼š</p><ul><li>âœ… <strong>Add Python 3.13 to PATH</strong></li></ul><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586249" alt="å®‰è£…å‘å¯¼" title="å®‰è£…å‘å¯¼" loading="lazy"/><br/><em>å›¾4ï¼šè®°å¾—å‹¾é€‰ "Add Python 3.13 to PATH"</em></p><p><strong>ä¸ºå•¥è¦å‹¾è¿™ä¸ªï¼Ÿ</strong></p><p>å‹¾äº†ä¹‹åï¼Œä½ æ‰èƒ½åœ¨ä»»ä½•åœ°æ–¹ï¼ˆå‘½ä»¤æç¤ºç¬¦ã€PowerShellï¼‰ç›´æ¥æ•² <code>python</code> è¿è¡Œç¨‹åºã€‚ä¸å‹¾çš„è¯ï¼Œæ¯æ¬¡éƒ½è¦è¾“å…¥å®Œæ•´è·¯å¾„ï¼Œç‰¹åˆ«éº»çƒ¦ã€‚</p><p>æˆ‘å½“æ—¶ç¬¬ä¸€æ¬¡è£…å°±æ²¡å‹¾ï¼Œåæ¥åˆæŠ˜è…¾äº†åŠå¤©ç¯å¢ƒå˜é‡ã€‚ä½ è®°å¾—å‹¾ä¸Šï¼Œå°±çœäº‹äº†ã€‚</p><p><strong>ç„¶åé€‰å®‰è£…æ–¹å¼ï¼š</strong></p><ul><li><strong>Install Now</strong>ï¼šé»˜è®¤å®‰è£…ï¼Œæ–°æ‰‹é€‰è¿™ä¸ª</li><li><strong>Customize installation</strong>ï¼šè‡ªå®šä¹‰å®‰è£…ï¼Œæƒ³è‡ªå·±é€‰çš„ç”¨è¿™ä¸ª</li></ul><p>æ–°æ‰‹ç›´æ¥ã€ŒInstall Nowã€å°±è¡Œã€‚</p><h4>2.3 è‡ªå®šä¹‰é€‰é¡¹ï¼ˆå¯é€‰ï¼‰</h4><p>å¦‚æœä½ é€‰äº†ã€ŒCustomize installationã€ï¼Œä¼šçœ‹åˆ°è¿™äº›ï¼š</p><p><strong>Optional Featuresï¼š</strong></p><ul><li>Documentationï¼šå®˜æ–¹æ–‡æ¡£</li><li>pipï¼šåŒ…ç®¡ç†å·¥å…·ï¼ˆ<strong>å¿…å‹¾</strong>ï¼‰</li><li>tcl/tk and IDLEï¼šè‡ªå¸¦çš„å¼€å‘ç¯å¢ƒ</li><li>Python test suiteï¼šæµ‹è¯•å¥—ä»¶</li><li>py launcherï¼šå¯åŠ¨å™¨</li></ul><p><strong>å»ºè®®ï¼š</strong> è‡³å°‘å‹¾ <code>pip</code> å’Œ <code>py launcher</code>ï¼Œå…¶ä»–çš„å¯ä»¥ä¸å‹¾ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586250" alt="è‡ªå®šä¹‰å®‰è£…é€‰é¡¹" title="è‡ªå®šä¹‰å®‰è£…é€‰é¡¹" loading="lazy"/><br/><em>å›¾5ï¼šè‡ªå®šä¹‰é€‰é¡¹</em></p><p>ç‚¹ã€ŒNextã€ç»§ç»­ã€‚</p><h4>2.4 é«˜çº§é€‰é¡¹ï¼ˆå¯é€‰ï¼‰</h4><p>æ¥ä¸‹æ¥æ˜¯ã€ŒAdvanced Optionsã€ï¼š</p><ul><li><strong>Install for all users</strong>ï¼šç»™æ‰€æœ‰ç”¨æˆ·è£…ï¼ˆæ¨èï¼‰</li><li><strong>Associate files with Python</strong>ï¼š.py æ–‡ä»¶å…³è”åˆ° Pythonï¼ˆæ¨èï¼‰</li><li><strong>Create shortcuts</strong>ï¼šåˆ›å»ºå¿«æ·æ–¹å¼ï¼ˆæ¨èï¼‰</li><li><strong>Add Python to environment variables</strong>ï¼šåŠ åˆ°ç¯å¢ƒå˜é‡ï¼ˆå¦‚æœå‰é¢æ²¡å‹¾ PATHï¼Œè¿™é‡Œä¸€å®šè¦å‹¾ï¼‰</li><li><strong>Precompile standard library</strong>ï¼šé¢„ç¼–è¯‘ï¼ˆèƒ½å¿«ä¸€ç‚¹ï¼‰</li></ul><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586251" alt="é«˜çº§é€‰é¡¹" title="é«˜çº§é€‰é¡¹" loading="lazy"/><br/><em>å›¾6ï¼šé«˜çº§é€‰é¡¹</em></p><p><strong>å®‰è£…è·¯å¾„ï¼š</strong></p><p>é»˜è®¤æ˜¯ <code>C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Local\Programs\Python\Python313\</code></p><p>ä½ å¯ä»¥æ”¹æˆ <code>D:\Python313\</code> è¿™æ ·å¥½æ‰¾çš„è·¯å¾„ã€‚</p><h4>2.5 å¼€å§‹è£…</h4><p>ç‚¹ã€ŒInstall Nowã€æˆ–ã€ŒInstallã€ï¼Œå®‰è£…ç¨‹åºå¼€å§‹å¹²æ´»ï¼š</p><ul><li>å¤åˆ¶æ–‡ä»¶</li><li>é…ç½®ç³»ç»Ÿ</li><li>æ³¨å†Œç¯å¢ƒå˜é‡</li><li>è£… pip ç­‰å·¥å…·</li></ul><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586252" alt="å®‰è£…ä¸­" title="å®‰è£…ä¸­" loading="lazy"/><br/><em>å›¾7ï¼šå®‰è£…è¿›åº¦</em></p><p>ç­‰ 2-5 åˆ†é’Ÿï¼Œåˆ«å…³ã€‚</p><h4>2.6 è£…å¥½äº†</h4><p>çœ‹åˆ°ã€ŒSetup was successfulã€å°± OK äº†ï¼</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586253" alt="å®‰è£…æˆåŠŸ" title="å®‰è£…æˆåŠŸ" loading="lazy"/><br/><em>å›¾8ï¼šå®‰è£…æˆåŠŸ</em></p><p>ç‚¹ã€ŒCloseã€å…³é—­ã€‚</p><p><strong>åˆ°è¿™ä¸€æ­¥ï¼ŒPython å°±è£…å¥½äº†ã€‚</strong> âœ…</p><hr/><h3>ç¬¬ä¸‰æ­¥ï¼šæ£€æŸ¥è£…æ²¡è£…å¥½</h3><p>è£…å®Œæœ€å¥½éªŒè¯ä¸€ä¸‹ã€‚</p><h4>3.1 æ‰“å¼€å‘½ä»¤æç¤ºç¬¦</h4><p><strong>æ–¹æ³•ä¸€ï¼šWin + R</strong></p><ol><li>æŒ‰ <strong>Win + R</strong></li><li>è¾“å…¥ <code>cmd</code></li><li>å›è½¦</li></ol><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586254" alt="è¿è¡Œå¯¹è¯æ¡†" title="è¿è¡Œå¯¹è¯æ¡†" loading="lazy"/><br/><em>å›¾9ï¼šWin+R æ‰“å¼€å‘½ä»¤æç¤ºç¬¦</em></p><p><strong>æ–¹æ³•äºŒï¼šæœç´¢æ </strong></p><ol><li>ç‚¹ä»»åŠ¡æ æœç´¢</li><li>è¾“å…¥ <code>cmd</code> æˆ–ã€Œå‘½ä»¤æç¤ºç¬¦ã€</li><li>ç‚¹æœç´¢ç»“æœ</li></ol><h4>3.2 çœ‹çœ‹ç‰ˆæœ¬</h4><p>åœ¨å‘½ä»¤æç¤ºç¬¦é‡Œè¾“å…¥ï¼š</p><pre><code>python --version</code></pre><p>å›è½¦ã€‚</p><p>æ­£å¸¸çš„è¯ä¼šæ˜¾ç¤ºï¼š</p><pre><code>Python 3.13.0</code></pre><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586255" alt="æŸ¥çœ‹ç‰ˆæœ¬" title="æŸ¥çœ‹ç‰ˆæœ¬" loading="lazy"/><br/><em>å›¾10ï¼šæŸ¥çœ‹ Python ç‰ˆæœ¬</em></p><h4>3.3 æ£€æŸ¥ pip</h4><p>pip æ˜¯è£…ç¬¬ä¸‰æ–¹åº“ç”¨çš„ï¼Œè¾“å…¥ï¼š</p><pre><code>pip --version</code></pre><p>æ­£å¸¸ä¼šæ˜¾ç¤ºï¼š</p><pre><code>pip 24.x.x from ... (python 3.13)</code></pre><h4>3.4 è¯•ä¸€ä¸‹ Python ç¯å¢ƒ</h4><p>æƒ³ç©ç©ï¼Ÿè¾“å…¥ï¼š</p><pre><code>python</code></pre><p>æç¤ºç¬¦ä¼šå˜æˆ <code>&gt;&gt;&gt;</code>ï¼Œè¯´æ˜è¿›åˆ° Python ç¯å¢ƒäº†ã€‚</p><p>è¯•è¯•ä½ çš„ç¬¬ä¸€è¡Œä»£ç ï¼š</p><pre><code class="python">print("Hello, Python!")</code></pre><p>å›è½¦ï¼Œå±å¹•ä¼šæ˜¾ç¤ºï¼š</p><pre><code>Hello, Python!</code></pre><p>æ­å–œï¼Œä½ çš„ç¬¬ä¸€è¡Œ Python ä»£ç è·‘èµ·æ¥äº†ï¼ğŸ‰</p><p>æƒ³é€€å‡ºï¼Œè¾“å…¥ <code>exit()</code> æˆ–è€…æŒ‰ <code>Ctrl + Z</code> å†å›è½¦ã€‚</p><hr/><h3>ç¬¬å››æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¦‚æœéœ€è¦ï¼‰</h3><p><strong>å¦‚æœä½ åœ¨ 2.2 å‹¾é€‰äº† "Add Python to PATH"ï¼Œè¿™æ­¥è·³è¿‡ï¼</strong></p><p>ä½†å¦‚æœå®‰è£…æ—¶å¿˜äº†å‹¾ï¼Œæˆ–è€…å‘½ä»¤æç¤ºç¬¦æ˜¾ç¤ºã€Œ'python' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ã€ï¼Œå°±éœ€è¦æ‰‹åŠ¨é…ã€‚</p><h4>4.1 æ‰¾åˆ°å®‰è£…è·¯å¾„</h4><p>é»˜è®¤è·¯å¾„ä¸€èˆ¬æ˜¯ï¼š</p><ul><li><code>C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Local\Programs\Python\Python313\</code></li><li>æˆ–è€…ä½ è‡ªå·±è®¾çš„è·¯å¾„</li></ul><p>è®°ä¸‹æ¥ï¼Œåé¢è¦ç”¨ã€‚</p><h4>4.2 æ‰“å¼€ç¯å¢ƒå˜é‡è®¾ç½®</h4><ol><li>å³é”®ã€Œæ­¤ç”µè„‘ã€â†’ã€Œå±æ€§ã€</li><li>åœ¨ã€Œå…³äºã€é¡µç‚¹ã€Œé«˜çº§ç³»ç»Ÿè®¾ç½®ã€</li><li>åœ¨ã€Œç³»ç»Ÿå±æ€§ã€çª—å£ç‚¹ã€Œç¯å¢ƒå˜é‡ã€</li></ol><h4>4.3 ç¼–è¾‘ Path</h4><p>åœ¨ã€Œç¯å¢ƒå˜é‡ã€çª—å£ï¼Œæ‰¾åˆ°ã€Œç³»ç»Ÿå˜é‡ã€é‡Œçš„ <code>Path</code>ï¼ŒåŒå‡»ã€‚</p><p>ç‚¹ã€Œæ–°å»ºã€ï¼ŒåŠ è¿™ä¸¤æ¡ï¼ˆæŒ‰ä½ çš„å®é™…è·¯å¾„æ”¹ï¼‰ï¼š</p><pre><code>C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Local\Programs\Python\Python313\
C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Local\Programs\Python\Python313\Scripts\</code></pre><p><strong>ç¬¬äºŒæ¡æ˜¯ç»™ pip ç”¨çš„ï¼Œå¿…é¡»æœ‰ï¼</strong></p><p>ç‚¹ã€Œç¡®å®šã€ä¿å­˜ã€‚</p><h4>4.4 å†éªŒè¯ä¸€é</h4><p>å…³æ‰å‘½ä»¤æç¤ºç¬¦ï¼Œé‡æ–°æ‰“å¼€ä¸€ä¸ªï¼Œè¾“å…¥ï¼š</p><pre><code>python --version</code></pre><p>è¿™æ¬¡åº”è¯¥èƒ½æ˜¾ç¤ºç‰ˆæœ¬å·äº†ã€‚</p><hr/><h2>â“ å¸¸è§é—®é¢˜</h2><h3>Q1ï¼šæç¤ºã€Œæ— æ³•è®¿é—® Windows Installer æœåŠ¡ã€ï¼Ÿ</h3><p>è¿™æ˜¯ Windows Installer æœåŠ¡è¢«ç¦ç”¨äº†ã€‚</p><ol><li>æŒ‰ <code>Win + R</code>ï¼Œè¾“å…¥ <code>services.msc</code></li><li>æ‰¾åˆ°ã€ŒWindows Installerã€</li><li>åŒå‡»ï¼ŒæŠŠã€Œå¯åŠ¨ç±»å‹ã€æ”¹æˆã€Œè‡ªåŠ¨ã€</li><li>ç‚¹ã€Œå¯åŠ¨ã€ï¼Œç„¶åã€Œç¡®å®šã€</li></ol><h3>Q2ï¼šè¾“å…¥ python æ²¡ååº”ï¼Œæ‰“å¼€äº†åº”ç”¨å•†åº—ï¼Ÿ</h3><p>Windows 10/11 çš„ä¸€ä¸ªç‰¹æ€§ã€‚</p><p>è¯•è¯•ç”¨ <code>py</code> å‘½ä»¤ï¼š</p><pre><code>py --version</code></pre><p>å¦‚æœèƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œè¯´æ˜ Python å·²ç»è£…å¥½äº†ï¼Œåªæ˜¯ <code>python</code> å‘½ä»¤è¢«åº”ç”¨å•†åº—åŠ«æŒäº†ã€‚ä½ å¯ä»¥ï¼š</p><ol><li>åœ¨åº”ç”¨å•†åº—æœã€ŒPythonã€ï¼Œå¸è½½åº”ç”¨å•†åº—ç‰ˆæœ¬</li><li>æˆ–è€…ç›´æ¥ç”¨ <code>py</code> å‘½ä»¤ï¼ˆåŠŸèƒ½ä¸€æ ·ï¼‰</li></ol><h3>Q3ï¼šæ€ä¹ˆå‡çº§åˆ°æ–°ç‰ˆæœ¬ï¼Ÿ</h3><p>ä¸‹æ–°ç‰ˆæœ¬çš„å®‰è£…åŒ…ï¼Œç›´æ¥è£…å°±è¡Œã€‚æ–°ç‰ˆæœ¬ä¼šè¦†ç›–æ—§çš„ï¼Œæˆ–è€…ä½ å¯ä»¥ä¿ç•™å¤šä¸ªç‰ˆæœ¬ã€‚</p><p>å¦‚æœå¤šä¸ªç‰ˆæœ¬å…±å­˜ï¼Œå¯ä»¥ç”¨ <code>py -3.13</code> æˆ– <code>py -3.12</code> æŒ‡å®šç‰ˆæœ¬ã€‚</p><h3>Q4ï¼špip è£…ç¬¬ä¸‰æ–¹åº“å¾ˆæ…¢ï¼Ÿ</h3><p>ç”¨å›½å†…é•œåƒï¼š</p><pre><code>pip install -i https://pypi.tuna.tsinghua.edu.cn/simple åŒ…å</code></pre><p>æˆ–è€…æ°¸ä¹…é…ç½®ï¼š</p><pre><code>pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</code></pre><h3>Q5ï¼šæ‰¾ä¸åˆ° IDLEï¼Ÿ</h3><p>IDLE æ˜¯ Python è‡ªå¸¦çš„ç®€æ˜“å¼€å‘ç¯å¢ƒã€‚å¦‚æœå®‰è£…æ—¶æ²¡å‹¾é€‰ï¼š</p><ol><li>é‡æ–°è¿è¡Œå®‰è£…ç¨‹åºï¼Œé€‰ã€ŒRepairã€æˆ–ã€ŒModifyã€</li><li>å‹¾é€‰ã€Œtcl/tk and IDLEã€</li><li>å®Œæˆå IDLE å°±ä¼šåœ¨å¼€å§‹èœå•å‡ºç°</li></ol><hr/><h2>ğŸ“Œ æœ€åè¯´ä¸¤å¥</h2><p>åˆ°è¿™é‡Œï¼ŒPython å°±è£…å¥½äº†ã€‚æˆ‘å¸®ä½ æ¢³ç†ä¸€ä¸‹æ ¸å¿ƒæ­¥éª¤ï¼š</p><ol><li>âœ… ä¸‹å®‰è£…åŒ…ï¼ˆå®˜ç½‘æˆ–ç½‘ç›˜ï¼‰</li><li>âœ… <strong>å®‰è£…æ—¶è®°å¾—å‹¾é€‰ "Add Python to PATH"</strong>ï¼ˆè¿™ä¸ªæœ€é‡è¦ï¼‰</li><li>âœ… ç”¨å‘½ä»¤æç¤ºç¬¦æ£€æŸ¥ç‰ˆæœ¬</li><li>âœ… è¯•è¯• Python äº¤äº’ç¯å¢ƒ</li></ol><p><strong>ä¸‹ä¸€æ­¥å¯ä»¥åšä»€ä¹ˆï¼š</strong></p><ul><li>å­¦ Python åŸºç¡€è¯­æ³•ï¼ˆå˜é‡ã€æ•°æ®ç±»å‹ã€å¾ªç¯ã€å‡½æ•°ï¼‰</li><li>å†™ç‚¹å°ç¨‹åºï¼ˆè®¡ç®—å™¨ã€çŒœæ•°å­—ï¼‰</li><li>å­¦ç”¨ pip è£…ç¬¬ä¸‰æ–¹åº“</li><li>é€‰ä¸ªé¡ºæ‰‹çš„ç¼–è¾‘å™¨ï¼ˆVS Code æˆ– PyCharm éƒ½ä¸é”™ï¼‰</li></ul><p>ç¼–ç¨‹è¿™ä¸œè¥¿ï¼Œå¾—å¤šç»ƒã€‚è£…å¥½ç¯å¢ƒåªæ˜¯ç¬¬ä¸€æ­¥ï¼Œåé¢å¤šå†™ä»£ç ã€å¤šåšé¡¹ç›®ï¼Œæ…¢æ…¢å°±ç†Ÿç»ƒäº†ã€‚</p><p>æˆ‘ç¬¬ä¸€æ¬¡è£… Python ä¹Ÿè¸©äº†ä¸å°‘å‘ï¼Œåæ¥å‘ç°å…¶å®æ²¡å•¥éš¾çš„ï¼Œå°±æ˜¯å‡ ä¸ªé€‰é¡¹å®¹æ˜“é€‰é”™ã€‚å¸Œæœ›èƒ½å¸®ä½ çœç‚¹æ—¶é—´ã€‚</p><p>æœ‰é—®é¢˜å¯ä»¥ç•™è¨€ï¼Œæˆ‘çœ‹åˆ°ä¼šå›ã€‚</p><hr/><h2>ğŸ”— å‚è€ƒæ¥æº</h2><ul><li><a href="https://link.segmentfault.com/?enc=gwmWlQcLT78dgdJSEUx9eA%3D%3D.aVVJgzMgoali34jTIWdbz1hBNBl6oPdsqlf80cFCLQI%3D" rel="nofollow" target="_blank">Python å®˜ç½‘</a></li><li><a href="https://link.segmentfault.com/?enc=HoZDJZc2h9M2QL%2FvjIvnkA%3D%3D.vYxzlOV477ei2R9cLjsDBt%2FdKeqAHX5k%2FZml65EHFNhYbl7dRyB1j%2BmC1P5dsjuI" rel="nofollow" target="_blank">Python å®˜æ–¹æ–‡æ¡£ - Windows å®‰è£…æŒ‡å—</a></li><li><a href="https://link.segmentfault.com/?enc=GTs10ZrAEJnY01395AQUKA%3D%3D.tzsaY6yaxI0RJtV0deQqIY6R2yKec%2B8F4NnSgsEZftiZ%2BvqeDK58uNn3qUQYEVse0KcewetIQIPs%2B7XjzdhIqQ%3D%3D" rel="nofollow" target="_blank">Microsoft Learn - Windows Python åˆå­¦è€…æŒ‡å—</a></li><li><a href="https://link.segmentfault.com/?enc=1PD6mDW9OJ81rUTseQFc3w%3D%3D.VJ6RPmPBGq6xYnUKvN1BqW7HQF%2BmkaA6%2FI17V3SOUp4O8NTeHZq0L%2Bo00lc3PlGJYhE%2BstKEbz1SHK4kDu3rfw%3D%3D" rel="nofollow" target="_blank">é£æ¡¨æ˜Ÿæ²³ç¤¾åŒº - 2025å¹´è¶…ç»†Pythonå®‰è£…æŒ‡å—</a></li><li><a href="https://link.segmentfault.com/?enc=bRRwR22dyDyaUhxwzPf7jA%3D%3D.GITk94GbyVSN1VbHww4NBQ9VCW3BCYGjHqF1FVfKYlxVGP5upNmWtRddwg9MRZ63" rel="nofollow" target="_blank">åšå®¢å›­ - Python 3.13 å®‰è£…æ•™ç¨‹</a></li></ul><hr/><p><strong>ğŸ’¡ æœ‰å¸®åŠ©çš„è¯å¯ä»¥æ”¶è—ï¼Œé¡ºä¾¿è½¬å‘ç»™ä¹Ÿåœ¨å­¦ Python çš„æœ‹å‹ï½</strong></p>]]></description></item><item>    <title><![CDATA[0201å¥½è™«å­å‘¨åˆŠ ææ¢¨åŒå­¦ ]]></title>    <link>https://segmentfault.com/a/1190000047586273</link>    <guid>https://segmentfault.com/a/1190000047586273</guid>    <pubDate>2026-02-02 00:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>(2026.01.18-02.01)ğŸš€ å¥½è™«å­å‘¨åˆŠï¼šDeepSeek V4å‰ç»ã€Agentæ ‡å‡†ç¡®ç«‹ã€éŸ³é¢‘ç•Œé¢é©å‘½</h2><p><strong>æœ¬å‘¨å…³é”®è¯ï¼š</strong> æ··åˆä¸“å®¶ (MoE)ã€Agent æŠ€èƒ½æ ‡å‡†ã€ç‰©ç† AIã€éŸ³é¢‘é¦–é€‰ (Audio-first)</p><blockquote><strong>æ‘˜è¦ï¼š</strong> æœ¬å‘¨æ˜¯å¼€æºç•Œæ·±åº¦å¤ç›˜ä¸å¤§å‚æˆ˜ç•¥è½¬å‘çš„å…³é”®äº¤æ±‡æœŸã€‚DeepSeek R1 å‘å¸ƒå‘¨å¹´ä¹‹é™…ï¼Œå®˜æ–¹ä»¥ 86 é¡µè¶…é•¿æŠ¥å‘ŠæŠ«éœ²äº† RL è®­ç»ƒæ ¸å¿ƒæœºå¯†ï¼Œå¹¶é¢„å‘Š V4 ç‰ˆæœ¬å°†å†²å‡» Claude ä»£ç ç‹åº§ã€‚ä¸æ­¤åŒæ—¶ï¼ŒAnthropic æ¨åŠ¨çš„ Agent Skills è§„èŒƒé€æ¸æˆä¸ºè¡Œä¸šäº‹å®æ ‡å‡†ï¼ŒOpenAI äº¦è¢«ä¼ å‡ºè½¬å‘â€œéŸ³é¢‘ä¼˜å…ˆâ€ç¡¬ä»¶ç­–ç•¥ã€‚æ•´ä½“è¶‹åŠ¿æ˜¾ç¤ºï¼ŒAI æ­£åœ¨ä»â€œå¤§å‚æ•°â€ç«èµ›è½¬å‘â€œé«˜å¯é æ€§ Agentâ€å’Œâ€œä½æˆæœ¬æ¨ç†â€çš„åŠ¡å®é˜¶æ®µã€‚</blockquote><hr/><h2>ğŸš¨ æ ¸å¿ƒå¤´æ¡ (Top Stories)</h2><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047450642" alt="1æ ¸å¿ƒå¤´æ¡" title="1æ ¸å¿ƒå¤´æ¡"/></p><h3>1. DeepSeek R1 æŠ¥å‘Šæ›´æ–°ä¸ V4 é¢„å‘Šï¼šå¼€æºç•Œçš„é€æ˜åŒ–å·…å³°</h3><ul><li><strong>å‘å¸ƒæ—¶é—´ï¼š</strong> 01.20</li><li><strong>æ ¸å¿ƒäº®ç‚¹ï¼š</strong> DeepSeek å°† R1 æŠ€æœ¯æŠ¥å‘Šæ‰©å±•è‡³ 86 é¡µï¼Œå®Œæ•´æŠ«éœ²äº†ä» Dev1 åˆ° Dev3 çš„ä¸‰é˜¶æ®µå¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰è·¯å¾„ã€‚åŒæ—¶é¢„å‘Š V4 ç‰ˆæœ¬å°†äº 2 æœˆä¸­æ—¬å‘å¸ƒã€‚</li><li><strong>æŠ€æœ¯çªç ´ï¼š</strong> è¯¦ç»†è®°å½•äº† MCTSï¼ˆè’™ç‰¹å¡æ´›æ ‘æœç´¢ï¼‰åœ¨è®­ç»ƒä¸­çš„å¤±è´¥ç»éªŒï¼Œè¯æ˜äº†çº¯ RL è®­ç»ƒå³å¯å®ç°æ¨ç†èƒ½åŠ›æ¶Œç°ã€‚V4 å°†é‡‡ç”¨æ›´ä¼˜åŒ–çš„ MoE æ¶æ„ï¼Œä¾§é‡è½¯ä»¶å·¥ç¨‹èƒ½åŠ›ã€‚</li><li><strong>å¼€æº/è¡Œä¸šä»·å€¼ï¼š</strong> ä¸ºå…¨çƒå¼€å‘è€…èŠ‚çœäº†æ•°äº¿å…ƒçš„éªŒè¯ç®—åŠ›ï¼Œå¥ å®šäº†ä¸­å›½å¼€æºæ¨¡å‹åœ¨ Hugging Face ç¤¾åŒºçš„é¢†å¯¼åœ°ä½ã€‚</li></ul><h3>2. Agent Skills è§„èŒƒç¡®ç«‹ï¼šæ™ºèƒ½ä½“ä»â€œç©å…·â€èµ°å‘â€œå·¥å…·â€</h3><ul><li><strong>å‘å¸ƒæ—¶é—´ï¼š</strong> 01.26</li><li><strong>æ ¸å¿ƒäº®ç‚¹ï¼š</strong> Anthropic å®˜æ–¹å¼€æ”¾ Agent Skills è§„èŒƒã€‚Moltbotï¼ˆåŸ Clawdbotï¼‰åœ¨ GitHub ç‹‚æ½ 10 ä¸‡ Starï¼Œæˆä¸ºå¢é•¿æœ€å¿«çš„ AI åŠ©æ‰‹é¡¹ç›®ã€‚</li><li><strong>æŠ€æœ¯çªç ´ï¼š</strong> é€šè¿‡ MCPï¼ˆModel Context Protocolï¼‰å°†æ™ºèƒ½ä½“ä¸çœŸå®ç³»ç»Ÿè¿æ¥æ‘©æ“¦é™è‡³æœ€ä½ã€‚å¼•å…¥è‡ªéªŒè¯æœºåˆ¶ï¼Œè§£å†³äº†å¤æ‚ä»»åŠ¡ä¸‹ Agent é¢‘ç¹é—å¿˜ä¸Šä¸‹æ–‡çš„ç—›ç‚¹ã€‚</li><li><strong>å¼€æº/è¡Œä¸šä»·å€¼ï¼š</strong> æ ‡å¿—ç€ Agent å¼€å‘ä»ç¢ç‰‡åŒ–èµ°å‘æ ‡å‡†åŒ–ï¼Œå¼€å‘è€…å¯å¤ç”¨ Vercel æˆ– Anthropic æä¾›çš„æŠ€èƒ½æ¨¡å—ï¼ŒåŠ é€Ÿä¼ä¸šçº§æ™ºèƒ½ä½“éƒ¨ç½²ã€‚</li></ul><h3>3. éŸ³é¢‘ç•Œé¢é©å‘½ï¼šOpenAI æˆ˜ç•¥é‡å¿ƒå‘â€œå£°éŸ³â€åç§»</h3><ul><li><strong>å‘å¸ƒæ—¶é—´ï¼š</strong> 01.30</li><li><strong>æ ¸å¿ƒäº®ç‚¹ï¼š</strong> ç¤¾åŒºæƒ…æŠ¥æ˜¾ç¤º OpenAI è®¡åˆ’åœ¨ Q1 å‘å¸ƒæ–°ä¸€ä»£é Transformer æ¶æ„çš„éŸ³é¢‘æ¨¡å‹ï¼Œå¹¶ä¸ Jony Ive åˆä½œå¼€å‘â€œéŸ³é¢‘ä¼˜å…ˆâ€ä¸ªäººè®¾å¤‡ã€‚</li><li><strong>æŠ€æœ¯çªç ´ï¼š</strong> å®ç°çœŸÂ·ç«¯åˆ°ç«¯è¯­éŸ³äº¤äº’ï¼Œæ‘†è„±ä¼ ç»Ÿçš„â€œè¯­éŸ³è½¬æ–‡å­—â€ä¸­è½¬ï¼Œå»¶è¿Ÿå¤§å¹…é™ä½ï¼Œæ”¯æŒæ›´ç»†è…»çš„æƒ…æ„Ÿè¡¨è¾¾ã€‚</li><li><strong>å¼€æº/è¡Œä¸šä»·å€¼ï¼š</strong> é¢„ç¤ºç€ AI äº¤äº’å°†ä»å±å¹•ç«¯ï¼ˆScreen-basedï¼‰è½¬å‘ç¯å¢ƒéŸ³ç«¯ï¼ˆAmbient Audioï¼‰ï¼Œä¸ºå¯ç©¿æˆ´è®¾å¤‡å’Œæ™ºèƒ½å®¶å±…å¼€è¾Ÿæ–°èµ›é“ã€‚</li></ul><hr/><h2>ğŸ› ï¸ GitHub çƒ­é—¨å¼€æºé¡¹ç›® (Trending Tools)</h2><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047450643" alt="2GitHub çƒ­é—¨å¼€æºé¡¹ç›®" title="2GitHub çƒ­é—¨å¼€æºé¡¹ç›®" loading="lazy"/></p><p><em>æœ¬å‘¨ GitHub Star å¢é•¿æœ€å¿«ã€å¼€å‘è€…å…³æ³¨åº¦æœ€é«˜çš„é¡¹ç›®ç²¾é€‰</em></p><h3>âš¡ <strong>Moltbot</strong></h3><ul><li><strong>ä¸€å¥è¯ä»‹ç»ï¼š</strong> è‡ªæ‰˜ç®¡çš„â€œæœ€å¼º AI æ™ºèƒ½åŠ©æ‰‹â€ï¼ŒGitHub å¢é•¿å¥‡è¿¹ã€‚</li><li><strong>æ ¸å¿ƒä»·å€¼ï¼š</strong> æ”¯æŒé›†æˆ Slack/Discord/Telegramï¼Œå…·å¤‡ç³»ç»Ÿçº§æ“ä½œæƒé™ï¼Œé‡ç‚¹åœ¨äºæ•°æ®å®Œå…¨æœ¬åœ°åŒ–å¤„ç†ï¼Œè§£å†³äº†ä¼ä¸šå¯¹é—­ç¯ AI çš„æ ¸å¿ƒç„¦è™‘ã€‚</li><li><strong>é¡¹ç›®åœ°å€ï¼š</strong> <code>moltbot/moltbot</code></li></ul><h3>ğŸ¤– <strong>OpenClaw</strong></h3><ul><li><strong>ä¸€å¥è¯ä»‹ç»ï¼š</strong> ä¸“æ³¨è§£å†³ Agent ç¨³å®šæ€§çš„å¼€æºæ¡†æ¶ã€‚</li><li><strong>æ ¸å¿ƒä»·å€¼ï¼š</strong> é’ˆå¯¹é•¿æµç¨‹ä»»åŠ¡è¿›è¡Œäº†â€œåé¦ˆé—­ç¯â€ä¼˜åŒ–ï¼Œå¤§å¹…é™ä½äº†æ™ºèƒ½ä½“åœ¨å¤šæ­¥æ¨ç†ä¸­çš„å‡ºé”™ç‡ï¼ˆHallucination Rateï¼‰ã€‚</li><li><strong>é¡¹ç›®åœ°å€ï¼š</strong> <code>pipecat-ai/nemotron-january-2026</code> (NVIDIA é©±åŠ¨ç‰ˆ)</li></ul><h3>ğŸ¨ <strong>HunyuanVideo 1.5</strong></h3><ul><li><strong>ä¸€å¥è¯ä»‹ç»ï¼š</strong> è…¾è®¯å¼€æºçš„â€œæ˜¾å¡æ•‘æ˜Ÿâ€è§†é¢‘ç”Ÿæˆæ¨¡å‹ã€‚</li><li><strong>æ ¸å¿ƒä»·å€¼ï¼š</strong> ä»…éœ€ 13.6GB æ˜¾å­˜å³å¯è¿è¡Œ 720p è§†é¢‘ç”Ÿæˆï¼Œé€šè¿‡ SSTA ç¨€ç–æ³¨æ„åŠ›æŠ€æœ¯å®ç°äº† 1.87 å€çš„ç”Ÿæˆæé€Ÿã€‚</li><li><strong>é¡¹ç›®åœ°å€ï¼š</strong> <code>Tencent/HunyuanVideo</code></li></ul><hr/><h2>ğŸ“‘ å‰æ²¿ç ”ç©¶ä¸è¡Œä¸šé£å‘ (Insights)</h2><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047531758" alt="3å‰æ²¿ç ”ç©¶ä¸è¡Œä¸šé£å‘" title="3å‰æ²¿ç ”ç©¶ä¸è¡Œä¸šé£å‘" loading="lazy"/></p><ul><li><strong>ç‰©ç† AI (Physical AI) ä¸ä¸–ç•Œæ¨¡å‹ï¼š</strong> éšç€ Boston Dynamics å±•ç¤ºå…¨ç”µåŠ¨ Atlas æœºå™¨äººçš„ RL è®­ç»ƒæˆæœï¼Œå­¦æœ¯ç•Œå¼€å§‹è½¬å‘â€œç‰©ç†å±‚é¢çš„æ™ºèƒ½å®šä¹‰â€ã€‚LeCun çš„ World Model å®éªŒå®¤è·å¾— 50 äº¿ç¾å…ƒä¼°å€¼ï¼Œæ ‡å¿—ç€ AI æ­£åœ¨å°è¯•ç†è§£ç‰©ç†ä¸–ç•Œçš„é€»è¾‘è€Œéå•çº¯çš„æ¦‚ç‡æ‹Ÿåˆã€‚</li><li><strong>ç®—åŠ›èƒ½æºç“¶é¢ˆï¼š</strong> é©¬æ–¯å…‹åœ¨è¾¾æ²ƒæ–¯è®ºå›å†æ¬¡é¢„è­¦ï¼šç”µåŠ›ä¾›åº”å°†æˆä¸º 2026 å¹´ AI æ‰©å¼ çš„æœ€å¤§çº¢åˆ©éšœç¢ã€‚Vistra ç­‰ç”µåŠ›å·¨å¤´é€šè¿‡æ”¶è´­å¤©ç„¶æ°”ç”µå‚ç›´æ¥å¯¹æ¥ AI æ•°æ®ä¸­å¿ƒï¼Œèƒ½æºæº¢ä»·æ­£åœ¨é‡å¡‘ AI ä¾›åº”é“¾ã€‚</li></ul><hr/><p><strong>âœï¸ ç¼–è¾‘ç»“è¯­ï¼š</strong> æœ¬å‘¨æˆ‘ä»¬çœ‹åˆ°äº† AI é¢†åŸŸä»â€œå †å‚æ•°â€åˆ°â€œå †é€»è¾‘â€çš„ç»“æ„æ€§è½¬å˜ã€‚å¼€æºç¤¾åŒºä¸å†ç›²ç›®è·Ÿé£ï¼Œè€Œæ˜¯é€šè¿‡é€æ˜çš„æŠ€æœ¯æŠ¥å‘Šå’Œæ ‡å‡†åŒ–çš„æ¥å£ï¼ˆå¦‚ MCPï¼‰æ„å»ºæŠ¤åŸæ²³ã€‚ä¸‹å‘¨ï¼Œè¯·å¯†åˆ‡å…³æ³¨ DeepSeek V4 çš„å®šæ¡£æ¶ˆæ¯ï¼Œè¿™å¯èƒ½å½»åº•é‡å†™ 2026 å¹´çš„ Coding Agent ç«äº‰æ ¼å±€ã€‚</p><p><em>æ•´ç†ï¼šå¥½è™«å­å‘¨åˆŠç¼–è¾‘éƒ¨</em> <em>æ•°æ®æ¥æºï¼šGitHub, arXiv, Hugging Faceç­‰</em></p><p>æœ¬æ–‡ç”±<a href="https://link.segmentfault.com/?enc=vzfzAZKOPviGZNpSzU1%2Bgg%3D%3D.mJsL8odCCol%2BR1knh69h%2BOYoDtpKk2IA8zf74rZIaGc%3D" rel="nofollow" target="_blank">mdnice</a>å¤šå¹³å°å‘å¸ƒ</p>]]></description></item><item>    <title><![CDATA[Porfforï¼šç”¨ JavaScript å†™çš„ JavaScript AOT ç¼–è¯‘å™¨ jump__j]]></title>    <link>https://segmentfault.com/a/1190000047586204</link>    <guid>https://segmentfault.com/a/1190000047586204</guid>    <pubDate>2026-02-01 23:03:52</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>Porfforï¼šç”¨ JavaScript å†™çš„ JavaScript AOT ç¼–è¯‘å™¨</p><blockquote>å‘éŸ³ï¼š/ËˆpÉ”rfÉ”r/ï¼ˆå¨å°”å£«è¯­ä¸­"ç´«è‰²"çš„æ„æ€ï¼‰</blockquote><p>å¦‚æœä½ å†™è¿‡ JavaScriptï¼Œä½ å¯èƒ½ä¹ æƒ¯äº†å®ƒçš„åŠ¨æ€ç±»å‹ã€å³æ—¶ç¼–è¯‘ï¼ˆJITï¼‰å’Œæ— å¤„ä¸åœ¨çš„è¿è¡Œæ—¶ã€‚ä½†æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œå¦‚æœæŠŠ JavaScript æå‰ç¼–è¯‘æˆæœºå™¨ç ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><p>è¿™å°±æ˜¯ <strong>Porffor</strong> æƒ³è¦å›ç­”çš„é—®é¢˜ã€‚</p><hr/><h2>ä»€ä¹ˆæ˜¯ Porfforï¼Ÿ</h2><p>Porffor æ˜¯ä¸€ä¸ªå®éªŒæ€§çš„ <strong>AOTï¼ˆAhead-of-Timeï¼‰JavaScript/TypeScript ç¼–è¯‘å™¨</strong>ï¼Œç”±å¼€å‘è€… Oliver Medhurst ä»é›¶æ„å»ºã€‚å®ƒèƒ½å°† JS/TS ä»£ç ç¼–è¯‘ä¸º WebAssembly å’ŒåŸç”ŸäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><p>å¬èµ·æ¥ä¸å¤ªç‰¹åˆ«ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹å®ƒçš„æ ¸å¿ƒç‰¹ç‚¹ï¼š</p><ul><li><strong>100% AOT ç¼–è¯‘</strong> - æ²¡æœ‰ JITï¼Œç¼–è¯‘ä¸€æ¬¡ï¼Œåˆ°å¤„è¿è¡Œ</li><li><strong>æç®€è¿è¡Œæ—¶</strong> - æ— å¸¸é‡è¿è¡Œæ—¶æˆ–é¢„ç½®ä»£ç ï¼Œæœ€å°åŒ– Wasm imports</li><li><strong>è‡ªèº«ç¼–å†™</strong> - ç”¨ JavaScript å†™ JavaScript å¼•æ“ï¼Œé¿å…å†…å­˜å®‰å…¨æ¼æ´</li><li><strong>åŸç”Ÿæ”¯æŒ TypeScript</strong> - æ— éœ€é¢å¤–æ„å»ºæ­¥éª¤</li></ul><p>ç›®å‰é¡¹ç›®ä»å¤„äº <strong>pre-alpha</strong> é˜¶æ®µï¼Œä½†å·²ç»é€šè¿‡äº† 61% çš„ Test262 æµ‹è¯•ï¼ˆECMAScript å®˜æ–¹å…¼å®¹æ€§æµ‹è¯•å¥—ä»¶ï¼‰ã€‚</p><hr/><h2>å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h2><p>ä¼ ç»Ÿ JavaScript å¼•æ“ä½¿ç”¨è§£é‡Šå™¨æˆ–å¤šå±‚ JIT ç¼–è¯‘å™¨ã€‚ä»£ç åœ¨è¿è¡Œæ—¶è¢«è§£æã€ç¼–è¯‘å’Œä¼˜åŒ–ã€‚è¿™æ„å‘³ç€ï¼š</p><ol><li>å†·å¯åŠ¨æ…¢ï¼ˆéœ€è¦é¢„çƒ­ï¼‰</li><li>è¿è¡Œæ—¶å ç”¨å†…å­˜å¤§ï¼ˆJIT ä»£ç ç¼“å­˜ï¼‰</li><li>éœ€è¦å®Œæ•´çš„è¿è¡Œæ—¶ç¯å¢ƒ</li></ol><p>Porffor é‡‡ç”¨äº†ä¸åŒçš„æ–¹å¼ï¼š</p><pre><code>JavaScript/TypeScript
        â”‚
        â–¼
   WebAssembly / C ä»£ç 
        â”‚
        â–¼
   åŸç”ŸäºŒè¿›åˆ¶æ–‡ä»¶</code></pre><p>è¿™ç§ AOT æ–¹å¼è®©ä½ åœ¨å¼€å‘æ—¶ç¼–è¯‘ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒç›´æ¥è¿è¡Œå·²ç¼–è¯‘çš„ä»£ç â€”â€”æ— éœ€é¢„çƒ­ï¼Œæœ€å°å¼€é”€ã€‚</p><h3>ä¸‰ä¸ªè‡ªç ”å­å¼•æ“</h3><p>ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼ŒPorffor åŒ…å«ä¸‰ä¸ªè‡ªç ”çš„å­å¼•æ“ï¼š</p><table><thead><tr><th>å­å¼•æ“</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>Asur</strong></td><td>è‡ªç ” Wasm å¼•æ“ï¼Œç®€å•çš„è§£é‡Šå™¨å®ç°</td></tr><tr><td><strong>Rhemyn</strong></td><td>è‡ªç ”æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ï¼Œå°†æ­£åˆ™ç¼–è¯‘ä¸º Wasm å­—èŠ‚ç </td></tr><tr><td><strong>2c</strong></td><td>Wasm â†’ C è½¬è¯‘å™¨ï¼Œç”¨äºç”ŸæˆåŸç”ŸäºŒè¿›åˆ¶</td></tr></tbody></table><hr/><h2>å¿«é€Ÿå¼€å§‹</h2><h3>å®‰è£…</h3><pre><code class="bash">npm install -g porffor@latest</code></pre><h3>åŸºæœ¬ç”¨æ³•</h3><pre><code class="bash"># äº¤äº’å¼ REPL
porf

# ç›´æ¥è¿è¡Œ JS æ–‡ä»¶
porf script.js

# ç¼–è¯‘ä¸º WebAssembly
porf wasm script.js out.wasm

# ç¼–è¯‘ä¸ºåŸç”ŸäºŒè¿›åˆ¶
porf native script.js out

# ç¼–è¯‘ä¸º C ä»£ç 
porf c script.js out.c</code></pre><h3>ç¼–è¯‘é€‰é¡¹</h3><pre><code class="bash">--parser=acorn|@babel/parser|meriyah|hermes-parser|oxc-parser   # é€‰æ‹©è§£æå™¨
--parse-types                                                   # è§£æ TypeScript
--opt-types                                                     # ä½¿ç”¨ç±»å‹æ³¨è§£ä¼˜åŒ–
--valtype=i32|i64|f64                                         # å€¼ç±»å‹ï¼ˆé»˜è®¤ï¼šf64ï¼‰
-O0, -O1, -O2                                                 # ä¼˜åŒ–çº§åˆ«</code></pre><hr/><h2>è°éœ€è¦ Porfforï¼Ÿ</h2><h3>ç¼–è¯‘ä¸º WebAssembly</h3><p>Porffor çš„ Wasm è¾“å‡ºæ¯”ç°æœ‰ JSâ†’Wasm é¡¹ç›®å° <strong>10-30 å€</strong>ï¼Œæ€§èƒ½ä¹Ÿå¿« <strong>10-30 å€</strong>ï¼ˆç›¸æ¯”æ‰“åŒ…è§£é‡Šå™¨çš„æ–¹æ¡ˆï¼‰ã€‚</p><p>è¿™æ„å‘³ç€ï¼š</p><ul><li><strong>å®‰å…¨çš„æœåŠ¡ç«¯ JS æ‰˜ç®¡</strong> - Wasm æ²™ç®±åŒ–æ‰§è¡Œï¼Œæ— éœ€é¢å¤–éš”ç¦»</li><li><strong>è¾¹ç¼˜è®¡ç®—è¿è¡Œæ—¶</strong> - å¿«é€Ÿå†·å¯åŠ¨ï¼Œä½å†…å­˜å ç”¨</li><li><strong>ä»£ç ä¿æŠ¤</strong> - ç¼–è¯‘åçš„ä»£ç æ¯”æ··æ·†æ›´éš¾é€†å‘</li></ul><h3>ç¼–è¯‘ä¸ºåŸç”ŸäºŒè¿›åˆ¶</h3><p>Porffor ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶æ¯”ä¼ ç»Ÿæ–¹æ¡ˆå° <strong>1000 å€</strong>ï¼ˆä» ~90MB åˆ° &lt;100KBï¼‰ã€‚</p><p>è¿™ä½¿å¾—ä»¥ä¸‹åœºæ™¯æˆä¸ºå¯èƒ½ï¼š</p><ul><li><strong>åµŒå…¥å¼ç³»ç»Ÿ</strong> - åœ¨èµ„æºå—é™è®¾å¤‡ä¸Šè¿è¡Œ JS</li><li><strong>æ¸¸æˆæœºå¼€å‘</strong> - ä»»ä½•æ”¯æŒ C çš„åœ°æ–¹éƒ½å¯ä»¥ç”¨ JS</li><li><strong>å¾®å‹ CLI å·¥å…·</strong> - ç”¨ JS å†™ &lt;1MB çš„å¯æ‰§è¡Œæ–‡ä»¶</li></ul><h3>å®‰å…¨ç‰¹æ€§</h3><ul><li>ç”¨ JavaScriptï¼ˆå†…å­˜å®‰å…¨è¯­è¨€ï¼‰ç¼–å†™å¼•æ“æœ¬èº«</li><li>ä¸æ”¯æŒ <code>eval</code>ï¼Œé˜²æ­¢åŠ¨æ€ä»£ç æ‰§è¡Œ</li><li>Wasm æ²™ç®±åŒ–ç¯å¢ƒ</li></ul><hr/><h2>å½“ç„¶ï¼Œå®ƒä¹Ÿæœ‰å±€é™æ€§</h2><p>ä½œä¸ºå®éªŒæ€§é¡¹ç›®ï¼ŒPorffor ç›®å‰è¿˜æœ‰ä¸€äº›é™åˆ¶ï¼š</p><table><thead><tr><th>é™åˆ¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>å¼‚æ­¥æ”¯æŒæœ‰é™</td><td><code>Promise</code> å’Œ <code>await</code> æ”¯æŒæœ‰é™</td></tr><tr><td>ä½œç”¨åŸŸé™åˆ¶</td><td>ä¸æ”¯æŒè·¨ä½œç”¨åŸŸå˜é‡ï¼ˆé™¤å‚æ•°å’Œå…¨å±€å˜é‡ï¼‰</td></tr><tr><td>æ— åŠ¨æ€æ‰§è¡Œ</td><td>ä¸æ”¯æŒ <code>eval()</code>ã€<code>Function()</code> ç­‰ï¼ˆAOT ç‰¹æ€§ï¼‰</td></tr><tr><td>JS ç‰¹æ€§æ”¯æŒä¸å®Œæ•´</td><td>Test262 é€šè¿‡ç‡çº¦ 61%</td></tr></tbody></table><hr/><h2>ä¸å…¶ä»– JS å¼•æ“å¯¹æ¯”</h2><h3>æ¶æ„å·®å¼‚</h3><table><thead><tr><th>å¼•æ“</th><th>ç±»å‹</th><th>ç¼–è¯‘ç­–ç•¥</th><th>è¾“å‡º</th></tr></thead><tbody><tr><td><strong>Porffor</strong></td><td>AOT</td><td>JS â†’ Wasm/Native</td><td>Wasm/äºŒè¿›åˆ¶</td></tr><tr><td><strong>V8</strong></td><td>JIT</td><td>è§£é‡Šå™¨ + å¤šå±‚ JIT</td><td>æœºå™¨ç </td></tr><tr><td><strong>QuickJS</strong></td><td>å­—èŠ‚ç </td><td>JS â†’ å­—èŠ‚ç </td><td>å­—èŠ‚ç </td></tr></tbody></table><h3>æ€§èƒ½å¯¹æ¯”</h3><table><thead><tr><th>åœºæ™¯</th><th>Porffor</th><th>JIT å¼•æ“</th><th>å­—èŠ‚ç å¼•æ“</th></tr></thead><tbody><tr><td><strong>å†·å¯åŠ¨</strong></td><td>æœ€å¿«</td><td>æ…¢ï¼ˆéœ€é¢„çƒ­ï¼‰</td><td>ä¸­ç­‰</td></tr><tr><td><strong>å³°å€¼æ€§èƒ½</strong></td><td>ä¸­ç­‰</td><td>æœ€å¿«</td><td>æ…¢</td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>ä½</td><td>é«˜</td><td>ä¸­ç­‰</td></tr><tr><td><strong>äºŒè¿›åˆ¶å¤§å°</strong></td><td>æå°</td><td>N/A</td><td>å°</td></tr></tbody></table><h3>ä»€ä¹ˆæ—¶å€™é€‰æ‹©ä»€ä¹ˆï¼Ÿ</h3><pre><code>Porffor æœ€é€‚åˆï¼š
â”œâ”€â”€ éœ€è¦æå°äºŒè¿›åˆ¶ä½“ç§¯çš„åœºæ™¯
â”œâ”€â”€ éœ€è¦å¿«é€Ÿå†·å¯åŠ¨çš„åœºæ™¯ï¼ˆå¦‚ Serverlessï¼‰
â”œâ”€â”€ éœ€è¦å®‰å…¨æ²™ç®±æ‰§è¡Œçš„åœºæ™¯
â””â”€â”€ åµŒå…¥å¼/æ¸¸æˆæœºç­‰éä¼ ç»Ÿ JS å¹³å°

V8/SpiderMonkey æœ€é€‚åˆï¼š
â”œâ”€â”€ é€šç”¨ Web åº”ç”¨
â”œâ”€â”€ Node.js æœåŠ¡ç«¯åº”ç”¨
â””â”€â”€ éœ€è¦å®Œæ•´ JS ç‰¹æ€§æ”¯æŒçš„åœºæ™¯

QuickJS/JerryScript æœ€é€‚åˆï¼š
â”œâ”€â”€ åµŒå…¥å¼è®¾å¤‡
â”œâ”€â”€ èµ„æºå—é™ç¯å¢ƒ
â””â”€â”€ ä¸éœ€è¦æè‡´æ€§èƒ½çš„åœºæ™¯</code></pre><hr/><h2>åŠ¨æ‰‹è¯•è¯•</h2><p>è®©æˆ‘ä»¬å†™ä¸€ä¸ªç´ æ•°è®¡ç®—å™¨æ¥çœ‹çœ‹ Porffor çš„å®é™…æ•ˆæœï¼š</p><pre><code class="javascript">// æ£€æŸ¥ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºç´ æ•°
function isPrime(n) {
  if (n &lt; 2) return 0;
  if (n === 2) return 1;
  if (n % 2 === 0) return 0;

  const sqrtN = Math.sqrt(n);
  for (let i = 3; i &lt;= sqrtN; i += 2) {
    if (n % i === 0) return 0;
  }
  return 1;
}

// æŸ¥æ‰¾æŒ‡å®šèŒƒå›´å†…çš„æ‰€æœ‰ç´ æ•°
function findPrimes(start, end) {
  const primes = [];
  let count = 0;

  for (let i = start; i &lt;= end; i++) {
    if (isPrime(i)) {
      primes[count] = i;
      count++;
    }
  }

  primes.length = count;
  return primes;
}

// ä¸»ç¨‹åº
function main() {
  const START_NUM = 1;
  const END_NUM = 100;

  console.log('=== Porffor Prime Calculator ===');
  console.log('Range:', START_NUM, 'to', END_NUM);

  const primes = findPrimes(START_NUM, END_NUM);
  console.log('Found', primes.length, 'primes');

  let sum = 0;
  for (let i = 0; i &lt; primes.length; i++) {
    sum += primes[i];
  }

  console.log('Sum:', sum);
  console.log('Average:', sum / primes.length);

  return 'Done!';
}

main();</code></pre><h3>ç›´æ¥è¿è¡Œ</h3><pre><code class="bash">porf prime.js</code></pre><p>è¾“å‡ºï¼š</p><pre><code>=== Porffor Prime Calculator ===
Range: 1 to 100
Found 25 primes
Sum: 1060
Average: 42.4
Done!</code></pre><h3>ç¼–è¯‘ä¸º WebAssembly</h3><pre><code class="bash">porf wasm prime.js prime.wasm</code></pre><p>ç¼–è¯‘è¾“å‡ºï¼š</p><pre><code>parsed: 5ms
generated wasm: 40ms
optimized: 7ms
assembled: 5ms
[108ms] compiled prime.js -&gt; prime.wasm (36.5KB)</code></pre><h3>ç¼–è¯‘ä¸ºåŸç”ŸäºŒè¿›åˆ¶</h3><pre><code class="bash">porf native prime.js prime</code></pre><p>ç¼–è¯‘è¾“å‡ºï¼š</p><pre><code>parsed: 5ms
generated wasm: 38ms
optimized: 7ms
assembled: 4ms
compiled Wasm to C: 18ms
compiled C to native: 959ms
[1080ms] compiled prime.js -&gt; prime (106.6KB)</code></pre><h3>è¾“å‡ºæ ¼å¼å¯¹æ¯”</h3><table><thead><tr><th>æ ¼å¼</th><th>æ–‡ä»¶å¤§å°</th><th>ç¼–è¯‘æ—¶é—´</th><th>è¿è¡Œæ–¹å¼</th></tr></thead><tbody><tr><td>æº JS</td><td>2.4KB</td><td>-</td><td><code>porf file.js</code></td></tr><tr><td>Wasm</td><td>36KB</td><td>~100ms</td><td>éœ€ Wasm è¿è¡Œæ—¶</td></tr><tr><td>C ä»£ç </td><td>356KB</td><td>~130ms</td><td>éœ€ C ç¼–è¯‘</td></tr><tr><td>Native</td><td>106KB</td><td>~1100ms</td><td>ç‹¬ç«‹è¿è¡Œ</td></tr></tbody></table><hr/><h2>ç”Ÿæˆçš„ C ä»£ç æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h2><p>ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼ŒPorffor ç”Ÿæˆçš„ C ä»£ç é•¿ä»€ä¹ˆæ ·ï¼Ÿè®©æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹æ‰‹å†™ç‰ˆæœ¬å’Œè‡ªåŠ¨ç”Ÿæˆçš„ç‰ˆæœ¬ã€‚</p><h3>æ‰‹å†™ C ç‰ˆæœ¬ï¼ˆ96 è¡Œï¼Œ2.3KBï¼‰</h3><pre><code class="c">#include &lt;stdio.h&gt;
#include &lt;math.h&gt;
#include &lt;stdbool.h&gt;

bool isPrime(int n) {
    if (n &lt; 2) return false;
    if (n == 2) return true;
    if (n % 2 == 0) return false;

    int sqrtN = (int)sqrt(n);
    for (int i = 3; i &lt;= sqrtN; i += 2) {
        if (n % i == 0) return false;
    }
    return true;
}

int main() {
    int primes[100];
    int primeCount = findPrimes(1, 100, primes);

    printf("Found %d primes:\n", primeCount);
    for (int i = 0; i &lt; primeCount; i++) {
        printf("%d%s", primes[i], i &lt; primeCount - 1 ? ", " : "\n");
    }

    return 0;
}</code></pre><h3>Porffor ç”Ÿæˆçš„ç‰ˆæœ¬ï¼ˆ12,880 è¡Œï¼Œ353KBï¼‰</h3><pre><code class="c">// generated by porffor 0.61.2
#include &lt;stdint.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;math.h&gt;
#include &lt;string.h&gt;

// Wasm ç±»å‹å®šä¹‰
typedef uint8_t u8;
typedef int32_t i32;
typedef double f64;

// JS å€¼ç»“æ„ä½“ï¼ˆæ•°å­—æˆ–å¯¹è±¡ï¼‰
struct ReturnValue {
  f64 value;
  i32 type;  // ç±»å‹æ ‡ç­¾
};

// Wasm çº¿æ€§å†…å­˜æ¨¡æ‹Ÿ
char* _memory;
u32 _memoryPages = 5;

// Wasm æŒ‡ä»¤æ¨¡æ‹Ÿå‡½æ•°
i32 i32_load(i32 align, i32 offset, i32 pointer);
void f64_store(i32 align, i32 offset, i32 pointer, f64 value);

// JS å†…ç½®å‡½æ•°å®ç°
struct ReturnValue __ecma262_ToString(...);
f64 __Math_sqrt(f64 l0);
void __Porffor_printString(...);
// ... æ•°ç™¾ä¸ªå†…ç½®å‡½æ•°

// ç”¨æˆ·å‡½æ•°ï¼ˆä» JS è½¬æ¢ï¼‰
struct ReturnValue isPrime(...);
struct ReturnValue findPrimes(...);

int main() {
    _memory = (char*)malloc(65536 * _memoryPages);
    const struct ReturnValue _0 = _main(0, 0, 0, 0);
    return 0;
}</code></pre><h3>å¯¹æ¯”æ•°æ®</h3><table><thead><tr><th>æŒ‡æ ‡</th><th>æ‰‹å†™ C</th><th>Porffor ç”Ÿæˆ</th><th>å·®å¼‚</th></tr></thead><tbody><tr><td>æºä»£ç è¡Œæ•°</td><td>96 è¡Œ</td><td>12,880 è¡Œ</td><td><strong>134x</strong></td></tr><tr><td>æºæ–‡ä»¶å¤§å°</td><td>2.3KB</td><td>353KB</td><td><strong>153x</strong></td></tr><tr><td>äºŒè¿›åˆ¶å¤§å°</td><td>33KB</td><td>104KB</td><td><strong>3.15x</strong></td></tr><tr><td>ç¼–è¯‘æ—¶é—´</td><td>~10ms</td><td>~1080ms</td><td><strong>108x</strong></td></tr></tbody></table><h3>ä¸ºä»€ä¹ˆ Porffor ç”Ÿæˆçš„ä»£ç è¿™ä¹ˆå¤§ï¼Ÿ</h3><table><thead><tr><th>åŸå› </th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>Wasm æ¨¡æ‹Ÿå±‚</strong></td><td>éœ€è¦æ¨¡æ‹Ÿæ‰€æœ‰ Wasm æŒ‡ä»¤ï¼ˆload/store ç­‰ï¼‰</td></tr><tr><td><strong>JS ç±»å‹ç³»ç»Ÿ</strong></td><td>JS å€¼å¯ä»¥æ˜¯æ•°å­—ã€å­—ç¬¦ä¸²ã€å¯¹è±¡ï¼Œéœ€è¦ç»Ÿä¸€çš„ <code>ReturnValue</code> ç»“æ„</td></tr><tr><td><strong>å†…ç½®å‡½æ•°åº“</strong></td><td>å®ç° <code>Math.*</code>ã€<code>console.log</code>ã€<code>Array.*</code> ç­‰æ•°ç™¾ä¸ªå‡½æ•°</td></tr><tr><td><strong>å†…å­˜ç®¡ç†</strong></td><td>Wasm çº¿æ€§å†…å­˜ + JS å¯¹è±¡å†…å­˜çš„åŒé‡ç®¡ç†</td></tr><tr><td><strong>å­—ç¬¦ä¸²å¤„ç†</strong></td><td>JS å­—ç¬¦ä¸²æ˜¯ UTF-16ï¼Œéœ€è¦å¤æ‚çš„è½¬æ¢é€»è¾‘</td></tr></tbody></table><p>è¿™æ˜¯ JavaScript çš„çµæ´»æ€§å¸¦æ¥çš„ä»£ä»·â€”â€”Porffor éœ€è¦æ¨¡æ‹Ÿæ•´ä¸ª JS è¿è¡Œæ—¶ã€‚</p><hr/><h2>å®é™…åº”ç”¨å»ºè®®</h2><table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>è¿½æ±‚æè‡´æ€§èƒ½</td><td>æ‰‹å†™ C / Rust</td></tr><tr><td>å¿«é€ŸåŸå‹å¼€å‘</td><td>Porfforï¼ˆç›´æ¥å†™ JSï¼‰</td></tr><tr><td>å·²æœ‰ JS ä»£ç ç§»æ¤</td><td>Porfforï¼ˆæ— éœ€é‡å†™ï¼‰</td></tr><tr><td>éœ€è¦è·¨å¹³å°</td><td>Porfforï¼ˆä¸€æ¬¡ç¼–è¯‘ï¼Œå¤šå¹³å°è¿è¡Œï¼‰</td></tr><tr><td>å­¦ä¹ /ç ”ç©¶</td><td>Porfforï¼ˆäº†è§£ JSâ†’Wasmâ†’C çš„è½¬æ¢è¿‡ç¨‹ï¼‰</td></tr></tbody></table><hr/><h2>ç‰ˆæœ¬å·çš„ç§˜å¯†</h2><p>Porffor ä½¿ç”¨ç‹¬ç‰¹çš„ç‰ˆæœ¬å·æ ¼å¼ï¼š<code>0.61.2</code></p><ul><li><strong>0</strong> - Major ç‰ˆæœ¬ï¼Œå§‹ç»ˆä¸º 0ï¼ˆé¡¹ç›®æœªæˆç†Ÿï¼‰</li><li><strong>61</strong> - Minor ç‰ˆæœ¬ï¼Œ<strong>Test262 é€šè¿‡ç‡ç™¾åˆ†æ¯”</strong>ï¼ˆå‘ä¸‹å–æ•´ï¼‰</li><li><strong>2</strong> - Micro ç‰ˆæœ¬ï¼Œè¯¥ Minor ä¸‹çš„æ„å»ºå·</li></ul><p>ç‰ˆæœ¬å·ç›´æ¥å‘Šè¯‰ä½ è¿™ä¸ªé¡¹ç›®å¯¹ ECMAScript æ ‡å‡†çš„æ”¯æŒç¨‹åº¦ï¼</p><hr/><h2>WebAssembly ææ¡ˆæ”¯æŒ</h2><p>Porffor åªä½¿ç”¨å¹¿æ³›å®ç°çš„ Wasm ææ¡ˆï¼Œç¡®ä¿æœ€å¤§å…¼å®¹æ€§ï¼š</p><table><thead><tr><th>ææ¡ˆ</th><th>çŠ¶æ€</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Multi-value</td><td>å¿…éœ€</td><td>å¤šè¿”å›å€¼</td></tr><tr><td>Non-trapping float-to-int</td><td>å¿…éœ€</td><td>å®‰å…¨çš„æµ®ç‚¹è½¬æ•´æ•°</td></tr><tr><td>Bulk memory operations</td><td>å¯é€‰</td><td>æ‰¹é‡å†…å­˜æ“ä½œ</td></tr><tr><td>Exception handling</td><td>å¯é€‰</td><td>å¼‚å¸¸å¤„ç†</td></tr><tr><td>Tail calls</td><td>å¯é€‰ï¼ˆé»˜è®¤å…³é—­ï¼‰</td><td>å°¾è°ƒç”¨ä¼˜åŒ–</td></tr></tbody></table><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒPorffor æœ‰æ„é¿å…ä½¿ç”¨å°šæœªå¹¿æ³›å®ç°çš„ææ¡ˆï¼ˆå¦‚ GC ææ¡ˆï¼‰ã€‚</p><hr/><h2>é¡¹ç›®çŠ¶æ€ä¸èµ„æº</h2><h3>å½“å‰çŠ¶æ€</h3><ul><li><strong>å¼€å‘é˜¶æ®µ</strong>: Pre-alpha</li><li><strong>æœ€æ–°ç‰ˆæœ¬</strong>: 0.61.2ï¼ˆ2025-11-26 å‘å¸ƒï¼‰</li><li><strong>Test262 é€šè¿‡ç‡</strong>: ~61%</li><li><strong>å»ºè®®ç”¨é€”</strong>: ç ”ç©¶ã€å®éªŒï¼Œä¸å»ºè®®ç”Ÿäº§ä½¿ç”¨</li></ul><h3>å®˜æ–¹èµ„æº</h3><ul><li><strong>å®˜ç½‘</strong>: <a href="https://link.segmentfault.com/?enc=WyQqoIj5ouRLxv353cFonA%3D%3D.QB1TeMQ5afHdd13Kor6Y9BGrhxPFxeyhRhiFZbJ%2B02Q%3D" rel="nofollow" target="_blank">https://porffor.dev/</a></li><li><strong>GitHub</strong>: <a href="https://link.segmentfault.com/?enc=fN6cVby%2Fv3S9FNsm87%2Fgtw%3D%3D.5EPWkBTCiEXayGkuwr5HMRxJxNtmmv3M%2Byf1QuoFt5g%2FkkXWfzoLxjrfuuyp0bd9" rel="nofollow" target="_blank">https://github.com/CanadaHonk/porffor</a></li><li><strong>ä½œè€…</strong>: Oliver Medhurst (@CanadaHonk)</li></ul><h3>å­¦ä¹ èµ„æº</h3><ul><li><a href="https://link.segmentfault.com/?enc=0w64ZnADqc6Hw8c5FMVT2Q%3D%3D.ceDeBHP8v%2Bwccq5HfAx2i6qZYUrYEc7hO%2Bwr%2F72IiM0zNfq6UVu4ZCEVPJCcygyE" rel="nofollow" target="_blank">DevTools.fm Episode #157</a> - æ’­å®¢è®¿è°ˆ</li><li><a href="https://link.segmentfault.com/?enc=4NgLqwcThwDvNXCsAjx7wQ%3D%3D.ytdLnvIV1C9OXhJOHzBak5RFG%2FoO1WXM4p899ZmyBMDYtoT%2Bi89qEeZ3%2BbE2I7fUaofA1tNb0s%2BJqb8UlMneesSXsm%2BRWsC6uR4i3T0566k%3D" rel="nofollow" target="_blank">London Web Standards æ¼”è®²</a></li><li><a href="https://link.segmentfault.com/?enc=nCWaqdmDQu0mzMKZVg7ipw%3D%3D.GM6mvxD217tr8FeBl7DpbgKSsvDZXILpQ5r5ny7kVK92euumwLFsAp5hvRcHPk57" rel="nofollow" target="_blank">Hacker News è®¨è®º</a></li></ul><hr/><h2>ä¸ºä»€ä¹ˆå« Porfforï¼Ÿ</h2><p>"Purple"ï¼ˆç´«è‰²ï¼‰çš„å¨å°”å£«è¯­å°±æ˜¯ "porffor"ã€‚</p><p>é€‰æ‹©ç´«è‰²çš„åŸå› å¾ˆç®€å•ï¼š</p><ul><li>æ²¡æœ‰å…¶ä»– JS å¼•æ“ä½¿ç”¨ç´«è‰²ä½œä¸ºä¸»é¢˜è‰²</li><li>ç´«è‰²ä»£è¡¨"é›„å¿ƒ"ï¼ˆambitionï¼‰ï¼Œæ°å¦‚å…¶åˆ†åœ°æè¿°äº†è¿™ä¸ªé¡¹ç›®</li></ul><hr/><h2>æ€»ç»“</h2><p>Porffor æ˜¯ä¸€ä¸ªæå…·å®éªŒæ€§çš„é¡¹ç›®ã€‚å®ƒé€šè¿‡ç‹¬ç‰¹çš„æ¶æ„è®¾è®¡ï¼Œå°è¯•è§£å†³ä¼ ç»Ÿ JS å¼•æ“åœ¨ä»¥ä¸‹æ–¹é¢çš„é—®é¢˜ï¼š</p><ol><li><strong>å†·å¯åŠ¨æ€§èƒ½</strong> - AOT ç¼–è¯‘æ— éœ€é¢„çƒ­</li><li><strong>è¾“å‡ºä½“ç§¯</strong> - æå°çš„ Wasm å’ŒåŸç”ŸäºŒè¿›åˆ¶</li><li><strong>å®‰å…¨æ€§</strong> - æ²™ç®±åŒ–æ‰§è¡Œ + å†…å­˜å®‰å…¨è¯­è¨€ç¼–å†™</li><li><strong>æ–°å¹³å°</strong> - å°† JavaScript å¸¦åˆ°åµŒå…¥å¼å’Œæ¸¸æˆæœºç­‰æ–°é¢†åŸŸ</li></ol><p>è™½ç„¶ç›®å‰ä»å¤„äºæ—©æœŸé˜¶æ®µï¼ŒJS ç‰¹æ€§æ”¯æŒä¸å®Œæ•´ï¼Œä½†å…¶åˆ›æ–°çš„æ¶æ„ä¸º JavaScript çš„æœªæ¥åº”ç”¨æä¾›äº†æ–°çš„å¯èƒ½æ€§ã€‚</p><p>ä¹Ÿè®¸æŸä¸€å¤©ï¼Œä½ çœŸçš„å¯ä»¥ç”¨ JavaScript å†™ä¸€ä¸ªåªæœ‰ 100KB çš„ CLI å·¥å…·ï¼Œç„¶åç¼–è¯‘åˆ°ä»»ä½•å¹³å°ä¸Šè¿è¡Œã€‚é‚£å°†ä¼šæ˜¯æ€æ ·çš„ä½“éªŒï¼Ÿ</p><hr/><blockquote>"Purple is pretty cool. And it apparently represents 'ambition', which is one word to describe this project." â€” Oliver Medhurst</blockquote>]]></description></item><item>    <title><![CDATA[Windows JDK17 ä¸‹è½½å®‰è£…æ•™ç¨‹ï¼Œé™„è¯¦ç»†å›¾æ–‡ ç¨‹åºå‘˜å¾å¸ˆå…„ ]]></title>    <link>https://segmentfault.com/a/1190000047586207</link>    <guid>https://segmentfault.com/a/1190000047586207</guid>    <pubDate>2026-02-01 23:03:00</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>å‰è¨€</h2><p>æƒ³å­¦ Javaï¼Ÿç¬¬ä¸€æ­¥å¾—å…ˆæŠŠ JDK è£…ä¸Šã€‚</p><p>æˆ‘è§è¿‡å¤ªå¤šæ–°æ‰‹å¡åœ¨è¿™ä¸€æ­¥äº†ï¼šä¸çŸ¥é“ä¸‹å“ªä¸ªç‰ˆæœ¬ã€è£…å®Œä¸çŸ¥é“æ€ä¹ˆé…ç¯å¢ƒå˜é‡ã€ä¸€è¿è¡Œå°±æŠ¥é”™â€¦â€¦</p><p>ä»Šå¤©æŠŠ Windows ä¸‹è£… JDK 17 çš„å®Œæ•´æ­¥éª¤å†™å‡ºæ¥ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½æœ‰å›¾ï¼Œè·Ÿç€åšå°±è¡Œã€‚</p><h2>å¼€å§‹ä¹‹å‰</h2><p><strong>ä½ çš„ç”µè„‘å¾—æ»¡è¶³è¿™äº›æ¡ä»¶ï¼š</strong></p><ul><li>ç³»ç»Ÿï¼šWindows 10 æˆ–æ›´é«˜</li><li>å†…å­˜ï¼šè‡³å°‘ç•™ 2GB</li><li>ç¡¬ç›˜ï¼šè‡³å°‘ç•™ 500MB</li></ul><p><strong>ä¸‹è½½å®‰è£…åŒ…æœ‰ä¸¤ä¸ªåŠæ³•ï¼š</strong></p><ol><li><a href="https://link.segmentfault.com/?enc=E8bUvjPZ%2BFtIgGJnuvcffA%3D%3D.91aSRNzD9OWzbgCJ93kphM92m9rfU4CUw0SprWGIcb5iYZaMRFDAVsQvf8jVCpU2" rel="nofollow" target="_blank">ç”¨æˆ‘å‡†å¤‡çš„ç½‘ç›˜é“¾æ¥ï¼ˆé€Ÿåº¦æ›´å¿«ï¼‰</a></li><li>æˆ–è€…å» Oracle å®˜ç½‘ä¸‹è½½ï¼š<a href="https://link.segmentfault.com/?enc=9cGhPFpTBbgoFqkNX1EogQ%3D%3D.bHIL46uQigqygJORwL74nEJ7IiOdhQu3hFToZlRklZT3VVwh0AA6fFIiIu2LtktVCydGsQj2MWGLnP%2FxsW08uA%3D%3D" rel="nofollow" target="_blank">https://www.oracle.com/java/technologies/downloads/</a></li></ol><h2>å¼€å§‹å®‰è£…</h2><h3>æ­¥éª¤ä¸€ï¼šä¸‹è½½ JDK 17</h3><p><strong>ç”¨ç½‘ç›˜ä¸‹è½½ï¼ˆæ¨èï¼‰</strong></p><ol><li>æ‰“å¼€ç½‘ç›˜é“¾æ¥ï¼š<a href="https://link.segmentfault.com/?enc=E7RWRQ7%2FdVVscZCxkMf54w%3D%3D.jZBaOcYPTPPs6omf2y7jyFcSnOEOyFtwUROpVeU3oZv0tCLCEebUduifsTIjEy3G" rel="nofollow" target="_blank">https://pan.quark.cn/s/7186f4aa4c10</a></li><li>æ‰¾åˆ° Windows ç‰ˆæœ¬çš„å®‰è£…åŒ…ï¼ˆ<code>.exe</code> æ–‡ä»¶ï¼‰</li><li>ä¸‹è½½åˆ°ç”µè„‘</li></ol><p><strong>å» Oracle å®˜ç½‘ä¸‹è½½ä¹Ÿè¡Œ</strong></p><ol><li>æ‰“å¼€ <a href="https://link.segmentfault.com/?enc=J368WhqVijFzu0aR19dQIw%3D%3D.yZEYozzsmPnYYQtOzE0J1%2Bu2KH3Ljh6M9TuxHCXlBTj0C19Vr%2B7m1AnmcRUWs0qQaB1BzIDufYBl8b61MEODLA%3D%3D" rel="nofollow" target="_blank">https://www.oracle.com/java/technologies/downloads/</a></li><li>é€‰æ‹© Java 17</li><li>é€‰æ‹©"Windows x64 Installer"</li><li>ä¸‹è½½ <code>.exe</code> å®‰è£…åŒ…</li></ol><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586209" alt="Oracle å®˜ç½‘ä¸‹è½½é¡µé¢" title="Oracle å®˜ç½‘ä¸‹è½½é¡µé¢"/><br/><em>å›¾1ï¼šOracle å®˜ç½‘ä¸‹è½½é¡µé¢</em><br/><em>å›¾ç‰‡æ¥æºï¼š<a href="https://link.segmentfault.com/?enc=kCDasiW%2FZPDQIyfPE0W3hg%3D%3D.00HM2wzWYeRFic1mPh%2BL9%2B61n12ZcsE9WmMgUEfgMtCKhFWXSA49BnnPw%2Fk3KR8U" rel="nofollow" target="_blank">iCode504 ä¸ªäººåšå®¢</a></em></p><blockquote><p>âš ï¸ é€‰å¯¹äº†å†ä¸‹è½½</p><ul><li>ä¸€å®šè¦é€‰"Windows x64 Installer"</li><li>æ–‡ä»¶åç±»ä¼¼ <code>jdk-17_windows-x64_bin.exe</code></li></ul></blockquote><h3>æ­¥éª¤äºŒï¼šè¿è¡Œå®‰è£…ç¨‹åº</h3><ol><li>åŒå‡»ä¸‹è½½å¥½çš„ <code>.exe</code> å®‰è£…åŒ…</li><li>ä¼šå¼¹å‡ºå®‰è£…å‘å¯¼ï¼Œç‚¹å‡»"ä¸‹ä¸€æ­¥"</li></ol><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586210" alt="å®‰è£…å‘å¯¼ç•Œé¢" title="å®‰è£…å‘å¯¼ç•Œé¢" loading="lazy"/><br/><em>å›¾2ï¼šJDK å®‰è£…å‘å¯¼</em><br/><em>å›¾ç‰‡æ¥æºï¼š<a href="https://link.segmentfault.com/?enc=A%2BbpUyVqSey0tBXN1Nk1zw%3D%3D.YeCF6mHIhyJ9jnjtYIezlLuFUowPZ4mSaWWwq0%2BdVtVvnIqpkTdGV4pDibrifqMr" rel="nofollow" target="_blank">iCode504 ä¸ªäººåšå®¢</a></em></p><ol start="3"><li>å¯ä»¥é€‰æ‹©å®‰è£…è·¯å¾„</li></ol><blockquote><p><strong>å®‰è£…è·¯å¾„æ€ä¹ˆé€‰ï¼Ÿ</strong></p><ul><li>é»˜è®¤è£…åœ¨ <code>C:\Program Files\Java\jdk-17</code></li><li>æƒ³è£…å…¶ä»–ç›˜ä¹Ÿè¡Œï¼Œæ¯”å¦‚ <code>D:\Java\jdk-17</code></li><li>æ³¨æ„ï¼šè·¯å¾„é‡Œåˆ«æœ‰ä¸­æ–‡å­—ç¬¦</li></ul></blockquote><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586211" alt="é€‰æ‹©å®‰è£…è·¯å¾„" title="é€‰æ‹©å®‰è£…è·¯å¾„" loading="lazy"/><br/><em>å›¾3ï¼šé€‰æ‹© JDK å®‰è£…è·¯å¾„</em><br/><em>å›¾ç‰‡æ¥æºï¼š<a href="https://link.segmentfault.com/?enc=1pFyWOX3DDCSkE0DJPAPRA%3D%3D.MEFkqcFRbQlZhz3kYTGM%2B0IKuxLNhLcQuZg2XDvcVf%2Fo9ivx9YYG0kTSv6AVWkDkdnKKGD4uWFiL7ouIVi69og%3D%3D" rel="nofollow" target="_blank">çŠ¬å°å“ˆæ•™ç¨‹</a></em></p><ol start="4"><li>ç‚¹"ä¸‹ä¸€æ­¥"ï¼Œç­‰å®ƒè£…å®Œ</li><li>è£…å®Œåç‚¹"å…³é—­"</li></ol><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586212" alt="å®‰è£…å®Œæˆ" title="å®‰è£…å®Œæˆ" loading="lazy"/><br/><em>å›¾4ï¼šå®‰è£…å®Œæˆ</em><br/><em>å›¾ç‰‡æ¥æºï¼š<a href="https://link.segmentfault.com/?enc=57b%2B1W8MCYmGvUKfyoXIrA%3D%3D.XsrSBmE9hvZic7xHj5j2i8%2B6wVj5aHJmWY%2FcyQwzC3Z8SS6iICdPA8gGLXgBerLm" rel="nofollow" target="_blank">iCode504 ä¸ªäººåšå®¢</a></em></p><h3>æ­¥éª¤ä¸‰ï¼šé…ç½®ç¯å¢ƒå˜é‡</h3><p>è£…å®Œä¹‹åï¼Œè¿˜å¾—é…ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œè®©ç³»ç»ŸçŸ¥é“ JDK åœ¨å“ªå„¿ã€‚</p><p><strong>æ‰“å¼€ç¯å¢ƒå˜é‡è®¾ç½®ï¼š</strong></p><ol><li>æŒ‰ <code>Win + R</code> é”®</li><li>è¾“å…¥ <code>sysdm.cpl</code>ï¼Œå›è½¦</li><li>ç‚¹"é«˜çº§"é€‰é¡¹å¡</li><li>ç‚¹"ç¯å¢ƒå˜é‡"æŒ‰é’®</li></ol><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586213" alt="ç¯å¢ƒå˜é‡è®¾ç½®" title="ç¯å¢ƒå˜é‡è®¾ç½®" loading="lazy"/><br/><em>å›¾5ï¼šç¯å¢ƒå˜é‡è®¾ç½®å…¥å£</em><br/><em>å›¾ç‰‡æ¥æºï¼š<a href="https://link.segmentfault.com/?enc=omwfza%2BHUD%2BX39i1crvYMg%3D%3D.G%2B59cfLdPgHqFPmiOhHylv8XCRQPjKQqA7Avy6QPLPEIuy6%2FZUkUO9nqxBTqeI1o4gtdV7gSbo2gV7jeNrWjoQ%3D%3D" rel="nofollow" target="_blank">çŠ¬å°å“ˆæ•™ç¨‹</a></em></p><p><strong>é…ç½® JAVA_HOME å˜é‡ï¼š</strong></p><ol><li>åœ¨"ç³»ç»Ÿå˜é‡"åŒºåŸŸï¼Œç‚¹"æ–°å»º"</li><li>å˜é‡åè¾“å…¥ï¼š<code>JAVA_HOME</code></li><li>å˜é‡å€¼è¾“å…¥ä½ çš„ JDK å®‰è£…è·¯å¾„ï¼ˆæ¯”å¦‚ <code>D:\Java\jdk-17</code> æˆ– <code>C:\Program Files\Java\jdk-17</code>ï¼‰</li><li>ç‚¹"ç¡®å®š"</li></ol><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586214" alt="é…ç½® JAVA_HOME" title="é…ç½® JAVA_HOME" loading="lazy"/><br/><em>å›¾6ï¼šé…ç½® JAVA_HOME å˜é‡</em><br/><em>å›¾ç‰‡æ¥æºï¼š<a href="https://link.segmentfault.com/?enc=QpPyVZ1NKUc7Dpt5aHHEFA%3D%3D.yGSk4pOLmtolmpdI10iQ0GTmzC2UKwrB7%2FFOxdXruouYQVKPWLwvaRUVlQ%2Fqee%2BC" rel="nofollow" target="_blank">iCode504 ä¸ªäººåšå®¢</a></em></p><p><strong>ç¼–è¾‘ Path å˜é‡ï¼š</strong></p><ol><li>åœ¨"ç³»ç»Ÿå˜é‡"é‡Œæ‰¾åˆ° <code>Path</code>ï¼ŒåŒå‡»æ‰“å¼€</li><li>ç‚¹"æ–°å»º"</li><li>è¾“å…¥ï¼š<code>%JAVA_HOME%\bin</code></li><li>ç‚¹"ç¡®å®š"ä¿å­˜æ‰€æœ‰è®¾ç½®</li></ol><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586215" alt="é…ç½® Path å˜é‡" title="é…ç½® Path å˜é‡" loading="lazy"/><br/><em>å›¾7ï¼šé…ç½® Path å˜é‡</em><br/><em>å›¾ç‰‡æ¥æºï¼š<a href="https://link.segmentfault.com/?enc=pHdMbVLXF1uZg4W%2B8yNBzw%3D%3D.vGN3PekJ%2B9yv2ufQqZ8N8Wo87tnMDnWY384z4lHNGBsfG2sf%2FBEqF1v9y3%2BRFjhG" rel="nofollow" target="_blank">iCode504 ä¸ªäººåšå®¢</a></em></p><blockquote><p><strong>ä¸ºä»€ä¹ˆè¦é…ç½®è¿™äº›ï¼Ÿ</strong></p><ul><li><code>JAVA_HOME</code>ï¼šå‘Šè¯‰ç³»ç»Ÿ JDK è£…åœ¨å“ªå„¿</li><li><code>Path</code>ï¼šè®©ç³»ç»Ÿæ‰¾å¾—åˆ° javaã€javac è¿™äº›å‘½ä»¤</li></ul></blockquote><h3>æ­¥éª¤å››ï¼šéªŒè¯å®‰è£…</h3><p>è£…å®Œé…ç½®å¥½ä¹‹åï¼ŒéªŒè¯ä¸€ä¸‹ã€‚</p><ol><li>æŒ‰ <code>Win + R</code>ï¼Œè¾“å…¥ <code>cmd</code>ï¼Œå›è½¦</li><li><p>è¾“å…¥ï¼š</p><pre><code>java -version</code></pre></li></ol><p>å¦‚æœçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š</p><pre><code>java version "17.0.x"
Java(TM) SE Runtime Environment (build 17.0.x+xx)
Java HotSpot(TM) 64-Bit VM (build 17.0.x+xx, mixed mode, sharing)</code></pre><p>è¯´æ˜ JDK 17 è£…å¥½äº†ï¼</p><p>å†è¾“å…¥ï¼š</p><pre><code>javac -version</code></pre><p>åº”è¯¥çœ‹åˆ°ï¼š</p><pre><code>javac 17.0.x</code></pre><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586216" alt="éªŒè¯å®‰è£…æˆåŠŸ" title="éªŒè¯å®‰è£…æˆåŠŸ" loading="lazy"/><br/><em>å›¾8ï¼šå‘½ä»¤è¡ŒéªŒè¯ JDK å®‰è£…</em><br/><em>å›¾ç‰‡æ¥æºï¼š<a href="https://link.segmentfault.com/?enc=YnxqHRm6Lph6KSlOijKe%2FA%3D%3D.GA5ano4iZRXjWLh8eMA2i3NYhEvGC8GpFg8ZRqIzPP6UWhLr3ETAWqAxXR5i3kw5wL61IIj2mugBLAb%2FzEsCsg%3D%3D" rel="nofollow" target="_blank">çŠ¬å°å“ˆæ•™ç¨‹</a></em></p><blockquote>åˆ°è¿™ä¸€æ­¥ï¼Œå¦‚æœä¸¤ä¸ªå‘½ä»¤éƒ½èƒ½æ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬ï¼Œæ­å–œä½ ï¼ŒJDK 17 è£…å¥½äº†ï¼</blockquote><h2>å¸¸è§é—®é¢˜</h2><p><strong>Q: è¾“å…¥ java -version æç¤º"ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤"ï¼Ÿ</strong></p><p>ç¯å¢ƒå˜é‡æ²¡é…å¥½ã€‚æ£€æŸ¥ä¸€ä¸‹ï¼š</p><ol><li>JAVA_HOME è·¯å¾„å¯¹ä¸å¯¹</li><li>Path é‡Œæœ‰æ²¡æœ‰ <code>%JAVA_HOME%\bin</code></li><li>é…ç½®å®Œè¦é‡æ–°æ‰“å¼€ cmd çª—å£</li></ol><p><strong>Q: å®‰è£…æ—¶æç¤º"æ‰¾ä¸åˆ°æŒ‡å®šè·¯å¾„"ï¼Ÿ</strong></p><p>æ£€æŸ¥ä¸€ä¸‹ï¼š</p><ol><li>å®‰è£…è·¯å¾„é‡Œåˆ«æœ‰ä¸­æ–‡å­—ç¬¦</li><li>è·¯å¾„åˆ«å¤ªé•¿</li><li>ç¡®ä¿ç›®æ ‡ç£ç›˜æœ‰è¶³å¤Ÿç©ºé—´</li></ol><p><strong>Q: æ€ä¹ˆç¡®è®¤ JDK å®‰è£…è·¯å¾„ï¼Ÿ</strong></p><p>æ–¹æ³•ä¸€ï¼š</p><ul><li>é»˜è®¤è·¯å¾„ï¼š<code>C:\Program Files\Java\jdk-17</code></li><li>ä½ å®‰è£…æ—¶å¦‚æœæ”¹è¿‡ï¼Œå°±ç”¨æ”¹è¿‡çš„è·¯å¾„</li></ul><p>æ–¹æ³•äºŒï¼š</p><ul><li>æ‰“å¼€æ–‡ä»¶èµ„æºç®¡ç†å™¨</li><li>æœç´¢ <code>javac.exe</code></li><li>æ‰€åœ¨æ–‡ä»¶å¤¹å°±æ˜¯ JDK å®‰è£…è·¯å¾„</li></ul><p><strong>Q: Path å˜é‡é‡Œå·²ç»æœ‰ Java ç›¸å…³çš„è·¯å¾„äº†æ€ä¹ˆåŠï¼Ÿ</strong></p><p>å¯èƒ½è£…è¿‡å…¶ä»–ç‰ˆæœ¬çš„ JDK æˆ– JREã€‚</p><ul><li>å¦‚æœæƒ³ç”¨ JDK 17ï¼Œç¡®ä¿ <code>%JAVA_HOME%\bin</code> åœ¨æœ€å‰é¢</li><li>æˆ–è€…æŠŠæ—§çš„ Java è·¯å¾„åˆ æ‰</li></ul><p><strong>Q: å®‰è£…å®Œæˆåæ‰¾ä¸åˆ° JDK å®‰è£…ç›®å½•ï¼Ÿ</strong></p><p>æ£€æŸ¥ä¸€ä¸‹ï¼š</p><ul><li>é»˜è®¤åœ¨ <code>C:\Program Files\Java\jdk-17</code></li><li>å¯èƒ½åªè£…äº† JREï¼Œæ²¡è£… JDK</li><li>é‡æ–°ä¸‹è½½å®‰è£…åŒ…ï¼ˆé€‰ Windows x64 Installerï¼‰</li></ul><h2>æ€»ç»“</h2><p>ç®€å•å›é¡¾ä¸€ä¸‹ï¼š</p><ol><li><strong>ä¸‹è½½å®‰è£…åŒ…</strong>ï¼šç”¨ç½‘ç›˜æˆ– Oracle å®˜ç½‘</li><li><strong>è¿è¡Œå®‰è£…</strong>ï¼šåŒå‡» <code>.exe</code> æŒ‰å‘å¯¼æ¥</li><li><strong>é…ç½®ç¯å¢ƒå˜é‡</strong>ï¼šè®¾ç½® JAVA_HOME å’Œ Path</li><li><strong>éªŒè¯</strong>ï¼šç”¨ <code>java -version</code> å’Œ <code>javac -version</code> ç¡®è®¤</li></ol><p>JDK 17 æ˜¯é•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼ˆLTSï¼‰ï¼Œä¹Ÿæ˜¯ Spring Boot 3.x è¦æ±‚çš„æœ€ä½ç‰ˆæœ¬ã€‚</p><p>å¦‚æœä½ æƒ³å­¦æœ€æ–°çš„ Java å¼€å‘æŠ€æœ¯ï¼ŒJDK 17 æ˜¯ä¸ªä¸é”™çš„èµ·ç‚¹ã€‚</p><p>è·Ÿç€è¿™ç¯‡æ•™ç¨‹åšä¸€éï¼Œä½ çš„ Windows ç”µè„‘ä¸Šå°±æœ‰ Java å¼€å‘ç¯å¢ƒäº†ã€‚</p><p>æ¥ä¸‹æ¥å°±å¯ä»¥å¼€å§‹å­¦ Java ç¼–ç¨‹äº†ï¼</p><p>æœ‰é—®é¢˜éšæ—¶ç•™è¨€è®¨è®ºã€‚</p><hr/><h2>å‚è€ƒæ¥æº</h2><ul><li><a href="https://link.segmentfault.com/?enc=F4hF%2BjRu08U4PFeCQONkkw%3D%3D.DWYUDqI%2Fv7kbxttrSa6XpYBTmoDbc41N3eRvXBNvvrGRSmpx8DXHwS06k74LjTUiHTQXwmgbnJec7nbJVTDnQg%3D%3D" rel="nofollow" target="_blank">Oracle å®˜æ–¹ Java ä¸‹è½½é¡µé¢</a></li><li><a href="https://link.segmentfault.com/?enc=yFWz9SDUR0YJNCXUsCrxOg%3D%3D.cGjHJ6WTZG9Xvo30%2BT2W2Wtzm4Lglqst5izkeBt7kLsbht6bsY5ZVez6%2FrudFkU4tgd6oalMNghlTX4KxtlfqajXWDq8WjvNw9HtYmiZTSGSCj21q6BratwuYtLH9S%2F8WhFnxdXfxAdYY5xw%2FUGH8w%3D%3D" rel="nofollow" target="_blank">Oracle å®˜æ–¹å®‰è£…æ–‡æ¡£</a></li><li><a href="https://link.segmentfault.com/?enc=MYa1rwyoq5fS71zqdjKcMQ%3D%3D.IhF1TPtNrvQVbbQ%2B53hWMaTKpd%2B6w%2FE%2B3UURXksf7IW1x2nWrBbEbBOqjSJLn7u8" rel="nofollow" target="_blank">JDK 17å®‰è£…é…ç½®æ•™ç¨‹ï¼ˆWindowsç‰ˆï¼‰ - iCode504</a></li><li><a href="https://link.segmentfault.com/?enc=Y5J7KqgmNJGYNEHTDr1TIQ%3D%3D.%2FUD9Q2VfI2%2BwYKVPSKH0LgozQz2079Z61uU3ArXHB1QnXrwMqUYJprRRpuKOzbQdD5szrq5bJz5TqgQMhuDoSA%3D%3D" rel="nofollow" target="_blank">JDK 17 ç¯å¢ƒå˜é‡é…ç½®_å®‰è£…æ•™ç¨‹ï¼ˆå›¾æ–‡è®²è§£ï¼‰ - çŠ¬å°å“ˆæ•™ç¨‹</a></li><li><a href="https://link.segmentfault.com/?enc=TVTyYnSMmsmEM37pNqo6%2Fg%3D%3D.GxH8CrZBdF%2Bdtw0uXWLbuCbfoglqww8coo5wo7LmBUAJ%2BBu%2B0DtLdJ2RevHWhNdcdMXVz85fXXvkAkLuUSQxYg%3D%3D" rel="nofollow" target="_blank">Jdk17å®‰è£…+ç¯å¢ƒé…ç½®è¯¦ç»†æ•™ç¨‹ã€Windowsã€‘ - è…¾è®¯äº‘</a></li></ul><p><a href="https://link.segmentfault.com/?enc=jfAEmAA84GhXSWi1gZppsg%3D%3D.vTtyLn8yNb%2FfiU3EvH6PaFb6t3MMgK0D9Kqsv4%2BJrpp3jM%2BXcIt%2FQ6A858754s2P" rel="nofollow" target="_blank">ç”¨æˆ‘å‡†å¤‡çš„ç½‘ç›˜é“¾æ¥ï¼ˆé€Ÿåº¦æ›´å¿«ï¼‰</a></p>]]></description></item><item>    <title><![CDATA[ã€ŠåŠ¨æ€æ•é£ŸçŒç‰©å…³ç³»æ‰‹å†Œï¼šç”Ÿæ€å¯ä¿¡æ€§æ„å»ºä¸ç©å®¶é•¿æœŸè¡Œä¸ºå“åº”ç­–ç•¥ã€‹ ç¨‹åºå‘˜é˜¿ä¼Ÿ ]]></title>    <link>https://segmentfault.com/a/1190000047586234</link>    <guid>https://segmentfault.com/a/1190000047586234</guid>    <pubDate>2026-02-01 23:02:17</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>åŠ¨æ€ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œå¯ä¿¡çš„æ•é£Ÿè€…-çŒç‰©å…³ç³»ç»éç®€å•çš„æ•°é‡æ­¤æ¶ˆå½¼é•¿ï¼Œè€Œæ˜¯ç‰©ç§é—´è¡Œä¸ºå¡‘æ€§ä¸ç¯å¢ƒåé¦ˆçš„æ·±åº¦è€¦åˆï¼Œç©å®¶çš„æ¯ä¸€æ¬¡å¹²é¢„éƒ½å°†æˆä¸ºç”Ÿæ€è½¨è¿¹çš„éšæ€§æ¨æ‰‹ã€‚å½“ç©å®¶åœ¨æ—é—´é¢‘ç¹æŠ•æ”¾æ··åˆäº†æµ†æœä¸æ˜†è™«æå–ç‰©çš„é«˜çƒ­é‡è¯±é¥µï¼Œè¯•å›¾è¾…åŠ©é‡å…”è¿™ç±»çŒç‰©ç”Ÿå­˜æ—¶ï¼Œä¾èµ–é‡å…”ä¸ºé£Ÿçš„å±±çŒ«ä¸ä¼šä»…ä»…è¢«åŠ¨å‡å°‘æ•°é‡ï¼Œè€Œæ˜¯ä¼šå¯åŠ¨ä¸€åœºæ‚„æ— å£°æ¯çš„è¡Œä¸ºæ¼”åŒ–â€”å®ƒä»¬çš„å—…è§‰è…ºä½“å¼€å§‹è°ƒæ•´åˆ†æ³Œç‰©æˆåˆ†ï¼Œé€æ¸æ¨¡ä»¿è¯±é¥µçš„é…¸ç”œæ°”å‘³ï¼Œä¸å†åƒä»¥å¾€é‚£æ ·å‡­å€Ÿé€Ÿåº¦è¿½å‡»ï¼Œè€Œæ˜¯æ½œä¼åœ¨è¯±é¥µæŠ•æ”¾ç‚¹å‘¨è¾¹çš„å²©çŸ³ç¼éš™æˆ–çŒæœ¨ä¸›ä¸­ï¼Œåˆ©ç”¨æ°”å‘³ä¼ªè£…ç­‰å¾…çŒç‰©é è¿‘ã€‚ä¸æ­¤åŒæ—¶ï¼Œé‡å…”çš„è­¦æˆ’è¡Œä¸ºä¹Ÿåœ¨å‘ç”Ÿè¿é”é‡å¡‘ï¼ŒåŸæœ¬æ¾æ•£çš„ç¾¤ä½“æ´»åŠ¨æ¨¡å¼å˜å¾—æ›´å…·ç»„ç»‡æ€§ï¼Œæ¯æ¬¡å‰å¾€è¯±é¥µç‚¹è§…é£Ÿæ—¶ï¼Œéƒ½ä¼šæ´¾é£ä¸‰åˆ°äº”åªæˆå¹´é‡å…”æ‹…ä»»è­¦æˆ’å²—ï¼Œè¿™äº›è­¦æˆ’ä¸ªä½“çš„è€³æœµä¼šæŒç»­è½¬å‘ä¸åŒæ–¹å‘ï¼Œé¼»å°–ä¸åœå—…æ¢ï¼Œè­¦æˆ’èŒƒå›´ä»¥è¯±é¥µæŠ•æ”¾ç‚¹ä¸ºä¸­å¿ƒå‘å¤–æ‰©å±•ä¸‰å€ï¼Œå½¢æˆä¸€é“æ— å½¢çš„å®‰å…¨å±éšœã€‚è¿™ç§è¡Œä¸ºé‡å¡‘å¹¶éå³æ—¶ç”Ÿæ•ˆï¼Œè€Œæ˜¯é€šè¿‡â€œç”Ÿæ€è®°å¿†â€çš„ä»£é™…ä¼ é€’é€æ­¥å›ºåŒ–ï¼Œå±±çŒ«çš„å¹¼å´½ä¼šåœ¨è·Ÿéšæˆå¹´ä¸ªä½“ç‹©çŒçš„è¿‡ç¨‹ä¸­ï¼Œè§‚å¯Ÿå¹¶ä¹ å¾—è¿™ç§ä¼ªè£…è§…é£Ÿçš„æŠ€å·§ï¼Œä»ä¸€å¼€å§‹çš„ç¬¨æ‹™æ¨¡ä»¿åˆ°åæ¥çš„ç†Ÿç»ƒè¿ç”¨ï¼›é‡å…”çš„å¹¼å´½åˆ™ä¼šåœ¨æˆé•¿è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æˆå¹´é‡å…”çš„è¡Œä¸ºç¤ºèŒƒï¼ŒæŒæ¡è­¦æˆ’å²—çš„èŒè´£ä¸ä¿¡å·ä¼ é€’æ–¹å¼ï¼Œæ¯”å¦‚é€šè¿‡çŸ­ä¿ƒçš„å«å£°æˆ–åè…¿è¹¬åœ°çš„éœ‡åŠ¨ä¼ é€’å±é™©ä¿¡å·ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ•é£Ÿè€…ä¸çŒç‰©çš„è¡Œä¸ºè°ƒæ•´ç›¸äº’å‘¼åº”ï¼Œæ—¢æ²¡æœ‰è„±ç¦»ç‰©ç§æœ¬èº«çš„ç”Ÿç‰©ç‰¹æ€§ï¼Œåˆå› ç©å®¶çš„å¹²é¢„äº§ç”Ÿäº†å…¨æ–°çš„äº’åŠ¨æ¨¡å¼ï¼Œè®©ç”Ÿæ€ç³»ç»Ÿå‘ˆç°å‡ºçœŸå®å¯æ„Ÿçš„æ¼”åŒ–å¼ åŠ›ï¼Œè€Œéæœºæ¢°çš„å‚æ•°å˜åŠ¨ã€‚</p><p>æ„å»ºè¿™ä¸€å…³ç³»çš„æ ¸å¿ƒåœ¨äºæ‰“ç ´é¢„è®¾çš„è¡Œä¸ºæ¨¡æ¿ï¼Œèµ‹äºˆç‰©ç§â€œç¯å¢ƒæ„ŸçŸ¥-å†³ç­–è¿­ä»£-è¡Œä¸ºè¾“å‡ºâ€çš„é—­ç¯èƒ½åŠ›ï¼Œè¿™ç§èƒ½åŠ›çš„å®ç°éœ€è¦å»ºç«‹å¤šç»´åº¦ä¸”å…·å¤‡åŠ¨æ€è°ƒæ•´å±æ€§çš„è¡Œä¸ºå‚æ•°çŸ©é˜µï¼Œè€Œéå›ºå®šçš„æ•°å€¼é›†åˆã€‚è¿™äº›å‚æ•°æ¶µç›–äº†ç‰©ç§çš„èƒ½é‡å‚¨å¤‡é˜ˆå€¼ã€é£é™©è¯„ä¼°æƒé‡ã€ç¤¾äº¤åä½œå€¾å‘ã€ç¯å¢ƒé€‚åº”é€Ÿç‡ç­‰å¤šä¸ªç»´åº¦ï¼Œæ¯ä¸ªç»´åº¦éƒ½ä¼šæ ¹æ®å®æ—¶çš„ç¯å¢ƒå˜åŒ–å’Œç©å®¶è¡Œä¸ºè¿›è¡Œç»†å¾®ä¸”æŒç»­çš„è°ƒæ•´ã€‚ä¾‹å¦‚ï¼Œå½“ç©å®¶é•¿æœŸæ¸…é™¤æ—é—´çš„ä½çŸ®çŒæœ¨ä¸›ï¼Œå‰¥å¤ºäº†é‡å…”çš„å¤©ç„¶éšè”½åœºæ‰€åï¼Œé‡å…”çš„è¡Œä¸ºå‚æ•°ä¼šå‘ç”Ÿä¸€ç³»åˆ—ååŒå˜åŒ–ï¼šâ€œå¥”è·‘æŒä¹…åº¦â€å‚æ•°ä¼šæå‡30%ï¼Œè®©å®ƒä»¬èƒ½å¤Ÿåœ¨å¼€é˜”åœ°å¸¦ç»´æŒæ›´é•¿æ—¶é—´çš„å¥”é€ƒï¼›â€œè½¬å‘çµæ´»åº¦â€ä¼šåŒæ­¥ä¼˜åŒ–ï¼Œä½¿å®ƒä»¬åœ¨é­é‡è¿½å‡»æ—¶èƒ½åšå‡ºæ›´æ•æ·çš„å˜å‘ï¼›åŒæ—¶â€œæ´»åŠ¨æ—¶é—´åå¥½â€å‚æ•°ä¼šä»æ—¥é—´è§…é£Ÿä¸ºä¸»ï¼Œè°ƒæ•´ä¸ºæ™¨æ˜æ—¶æ®µæ´»åŠ¨ï¼Œé¿å¼€å±±çŒ«çš„ä¸»è¦ç‹©çŒæ—¶é—´ã€‚è€Œå±±çŒ«çš„è¡Œä¸ºå‚æ•°ä¹Ÿä¼šéšä¹‹è”åŠ¨ï¼Œâ€œè§†è§‰è¿½è¸ªç²¾åº¦â€å‚æ•°ä¼šå¼ºåŒ–ï¼Œä½¿å…¶èƒ½åœ¨å¼€é˜”ç¯å¢ƒä¸­æ›´æ¸…æ™°åœ°é”å®šç§»åŠ¨ç›®æ ‡ï¼›â€œçŸ­è·ç¦»çˆ†å‘é€Ÿåº¦â€ä¼šæå‡ï¼Œå¼¥è¡¥ä¼ªè£…ä¼å‡»æœºä¼šå‡å°‘çš„åŠ£åŠ¿ï¼Œè½¬è€Œé‡‡ç”¨ä¸»åŠ¨è¿½å‡»çš„ç‹©çŒç­–ç•¥ã€‚è¿™ç§è°ƒæ•´å¹¶éå•ä¸€å‚æ•°çš„çº¿æ€§å˜åŒ–ï¼Œè€Œæ˜¯å¤šå‚æ•°çš„ååŒè”åŠ¨ï¼šé‡å…”å¥”è·‘é€Ÿåº¦å’ŒæŒä¹…åº¦æå‡çš„åŒæ—¶ï¼Œâ€œèƒ½é‡æ¶ˆè€—é€Ÿç‡â€ä¹Ÿä¼šç›¸åº”å¢åŠ ï¼Œè¿™å°±å¯¼è‡´å®ƒä»¬éœ€è¦æ›´é¢‘ç¹åœ°å¯»æ‰¾é£Ÿç‰©ï¼ŒåŸæœ¬ä¸€å¤©è§…é£Ÿä¸¤æ¬¡çš„é¢‘ç‡ä¼šå¢åŠ åˆ°å››æ¬¡ï¼Œè¿›è€Œå¯¹å‘¨è¾¹çš„æ¤è¢«åˆ†å¸ƒäº§ç”Ÿå½±å“â€”åå¥½çš„å«©è‰ä¼šè¢«è¿‡åº¦å•ƒé£Ÿï¼Œè€Œä¹‹å‰ä¸å—é’ççš„æ ¹èŒç±»æ¤ç‰©ä¼šé€æ¸æˆä¸ºå®ƒä»¬çš„é£Ÿç‰©è¡¥å……ï¼Œæ¤è¢«ç»“æ„çš„æ”¹å˜åˆä¼šåè¿‡æ¥ä½œç”¨äºå±±çŒ«çš„ç‹©çŒç­–ç•¥ï¼Œå½“å«©è‰åŒºåŸŸå‡å°‘ï¼Œå±±çŒ«çš„è§†è§‰éšè”½æ€§ä¸‹é™ï¼Œå®ƒä»¬ä¼šè¿›ä¸€æ­¥ä¼˜åŒ–è¿½å‡»è·¯çº¿ï¼Œé€‰æ‹©æ¤è¢«ç›¸å¯¹å¯†é›†çš„åŒºåŸŸä½œä¸ºè¿½å‡»èµ·ç‚¹ã€‚è¿™ç§ç¯ç¯ç›¸æ‰£çš„ç”Ÿæ€æ¶Ÿæ¼ªæ•ˆåº”ï¼Œè®©ç‰©ç§é—´çš„äº’åŠ¨æ‘†è„±äº†æœºæ¢°æ„Ÿï¼Œå‘ˆç°å‡ºå¤æ‚è€ŒçœŸå®çš„ç”Ÿæ€é€»è¾‘ï¼Œæ¯ä¸ªè¡Œä¸ºè°ƒæ•´éƒ½æœ‰å…¶å†…åœ¨çš„å› æœæ”¯æ’‘ã€‚</p><p>ç©å®¶è¡Œä¸ºçš„é•¿æœŸåé¦ˆæœºåˆ¶ï¼Œå…³é”®åœ¨äºå»ºç«‹â€œå¹²é¢„å¼ºåº¦-ç”Ÿæ€å»¶è¿Ÿ-éŸ§æ€§å›å¼¹â€çš„åŠ¨æ€æ¨¡å‹ï¼Œè¿™ç§æ¨¡å‹çš„æ ¸å¿ƒæ˜¯é¿å…å³æ—¶åé¦ˆå¸¦æ¥çš„ç”Ÿæ€å¤±çœŸï¼Œè®©ç©å®¶çš„æ¯ä¸€æ¬¡è¡ŒåŠ¨éƒ½éœ€è¦ç»å†æ—¶é—´çš„æ²‰æ·€æ‰èƒ½æ˜¾ç°å…¨è²Œï¼Œä»è€Œå¢å¼ºç”Ÿæ€ç³»ç»Ÿçš„å¯ä¿¡åº¦ä¸æ²‰æµ¸æ„Ÿã€‚å½“ç©å®¶ä¸ºäº†ä¿æŠ¤é‡å…”è€Œå¤§é‡æ¸…é™¤å±±çŒ«ç§ç¾¤æ—¶ï¼ŒçŸ­æœŸå†…é‡å…”çš„æ•°é‡ä¼šå› å¤©æ•Œå‡å°‘è€Œæ€¥å‰§ä¸Šå‡ï¼Œçœ‹ä¼¼ç”Ÿæ€ç³»ç»Ÿå·²ç»å¤±è¡¡ï¼Œä½†éšæ€§çš„è°ƒæ§æœºåˆ¶ä¼šæ‚„ç„¶å¯åŠ¨ã€‚é¦–å…ˆï¼Œé‡å…”æ•°é‡è¶…è¿‡ç¯å¢ƒâ€œèµ„æºæ‰¿è½½åŠ›é˜ˆå€¼â€åï¼Œå®ƒä»¬çš„ä¸»è¦é£Ÿç‰©æ¥æºâ€”å«©è‰å’Œæ ¹èŒç±»æ¤ç‰©ä¼šå¿«é€Ÿæ¯ç«­ï¼ŒåŸæœ¬è‚¥æ²ƒçš„è‰åœ°ä¼šé€æ¸å‡ºç°æ–‘ç§ƒï¼›å…¶æ¬¡ï¼Œé‡å…”ç¾¤ä½“ä¸­ä¼šå‡ºç°â€œç§ç¾¤å¯†åº¦åº”æ¿€ååº”â€ï¼Œæˆå¹´é‡å…”çš„ç¹æ®–å‘¨æœŸä¼šä»ä¸‰ä¸ªæœˆå»¶é•¿è‡³äº”ä¸ªæœˆï¼Œå¹¼å´½çš„å­˜æ´»ç‡ä¼šä»80%ä¸‹é™è‡³40%ï¼ŒåŒæ—¶ç¾¤ä½“å…ç–«åŠ›é™ä½ï¼Œæ˜“æ„ŸæŸ“çš„çš®è‚¤ç–¾ç—…ä¼šåœ¨ç§ç¾¤ä¸­ç¼“æ…¢ä¼ æ’­ï¼Œè¿™äº›å› ç´ å…±åŒä½œç”¨ï¼Œè®©é‡å…”ç§ç¾¤æ•°é‡è‡ªç„¶å›è½ã€‚è€Œè¢«å¤§é‡æ¸…é™¤çš„å±±çŒ«å¹¶ä¸ä¼šå½»åº•æ¶ˆå¤±ï¼Œå®ƒä»¬ä¼šåœ¨ç”Ÿæ€è¾¹ç¼˜åŒºåŸŸï¼Œæ¯”å¦‚ç›¸é‚»çš„å±±æ—ä¸­ä¿ç•™å°‘é‡ç§ç¾¤ï¼Œè¿™äº›å‰©ä½™ç§ç¾¤ä¼šè°ƒæ•´è¡Œä¸ºæ¨¡å¼ï¼Œå‡å°‘é¢†åœ°äº‰å¤ºï¼Œå¢åŠ å¤œé—´ç‹©çŒé¢‘ç‡ã€‚å±±çŒ«çš„å›å½’é€Ÿåº¦ä¸ç©å®¶å¹²é¢„çš„å¼ºåº¦å‘ˆè´Ÿç›¸å…³ï¼šè‹¥ç©å®¶åªæ˜¯æ¸©å’Œæ¸…é™¤éƒ¨åˆ†å±±çŒ«ï¼Œå‰©ä½™ç§ç¾¤åœ¨é£Ÿç‰©èµ„æºï¼ˆé‡å…”ï¼‰æ¢å¤åï¼Œå¯èƒ½åœ¨ä¸‰ä¸ªæœˆå†…é€æ­¥å›å½’åŸæ –æ¯åœ°ï¼›è‹¥å¹²é¢„è¿‡äºå‰§çƒˆï¼Œå±±çŒ«ç§ç¾¤çš„æ¢å¤åˆ™éœ€è¦ä¸¤å¹´ç”šè‡³æ›´é•¿æ—¶é—´ï¼Œä¸”å›å½’åçš„å±±çŒ«è¡Œä¸ºä¼šå‘ç”Ÿæ°¸ä¹…æ€§æ”¹å˜â€”å®ƒä»¬ä¼šæ›´å€¾å‘äºæ•é£Ÿé‡å…”ç§ç¾¤ä¸­ä½“è´¨è¾ƒå¼±çš„ä¸ªä½“ï¼Œè€Œééšæœºç‹©çŒï¼Œè¿™ç§é€‰æ‹©æ€§æ•é£Ÿé—´æ¥æå‡äº†é‡å…”ç§ç¾¤çš„æ•´ä½“è´¨é‡ï¼Œè®©ç”Ÿæ€ç³»ç»Ÿå½¢æˆæ–°çš„å¹³è¡¡ã€‚è¿™ç§å»¶è¿Ÿåé¦ˆæœºåˆ¶è®©ç©å®¶çš„è¡Œä¸ºä¸å†æ˜¯å³æ—¶ç”Ÿæ•ˆçš„â€œä¸Šå¸æ“ä½œâ€ï¼Œè€Œæ˜¯éœ€è¦æ‰¿æ‹…é•¿æœŸåæœçš„ç”Ÿæ€å¹²é¢„ï¼Œè¿«ä½¿ç©å®¶åœ¨è¡ŒåŠ¨å‰è¿›è¡Œæ€è€ƒï¼Œè¿›è€ŒåŠ æ·±å¯¹ç”Ÿæ€ç³»ç»Ÿå¤æ‚æ€§çš„ç†è§£ã€‚</p><p>ç‰©ç§é—´çš„â€œè¡Œä¸ºäº’å¡‘â€æ˜¯æå‡æ•é£Ÿ-çŒç‰©å…³ç³»å¯ä¿¡æ€§çš„æ ¸å¿ƒæŠ€æœ¯è·¯å¾„ï¼Œè¿™ç§äº’å¡‘å¹¶éå•å‘çš„è¡Œä¸ºè®¾å®šï¼Œè€Œæ˜¯æ•é£Ÿè€…ä¸çŒç‰©åŸºäºå½¼æ­¤çš„è¡Œä¸ºå˜åŒ–ï¼Œè¿›è¡ŒåŠ¨æ€é€‚é…ä¸ç­–ç•¥è¿­ä»£ï¼Œæœ€ç»ˆå½¢æˆç›¸äº’ä¾å­˜åˆç›¸äº’åˆ¶çº¦çš„äº’åŠ¨æ¨¡å¼ã€‚å±±çŒ«çš„ç‹©çŒæˆåŠŸç‡ä¸ä¼šæ˜¯å›ºå®šæ•°å€¼ï¼Œè€Œæ˜¯ä¼šéšç€é‡å…”çš„è§„é¿è¡Œä¸ºæŒç»­åŠ¨æ€è°ƒæ•´ï¼šå½“é‡å…”æ„è¯†åˆ°å•ç‹¬è§…é£Ÿé£é™©è¿‡é«˜ï¼Œæ¼”åŒ–å‡ºâ€œç¾¤ä½“é˜²å¾¡â€ç­–ç•¥â€”é­é‡å±±çŒ«æ—¶ï¼Œæˆå¹´é‡å…”ä¼šè¿…é€Ÿå›´æˆåœ†åœˆï¼Œå°†å¹¼å´½ä¿æŠ¤åœ¨ä¸­å¿ƒï¼Œç”¨åè…¿è¹¬åœ°å’Œå°–é”çš„å«å£°å¨æ…‘å¤©æ•Œï¼Œæ­¤æ—¶å±±çŒ«çš„å•ç‹¬ç‹©çŒæˆåŠŸç‡ä¼šä»40%ä¸‹é™è‡³15%ã€‚é¢å¯¹è¿™ç§å˜åŒ–ï¼Œå±±çŒ«ä¸ä¼šä¸€ç›´é‡‡ç”¨æ— æ•ˆç­–ç•¥ï¼Œè€Œæ˜¯ä¼šé€æ­¥å½¢æˆå°è§„æ¨¡çš„åä½œç¾¤ä½“ï¼Œé€šå¸¸ç”±ä¸¤åˆ°ä¸‰åªæˆå¹´å±±çŒ«ç»„æˆï¼Œç‹©çŒæ—¶é€šè¿‡çœ¼ç¥å’Œä½æ²‰çš„å«å£°ä¼ é€’ä¿¡å·ï¼Œåˆ†å·¥åŒ…æŠ„ï¼šä¸€åªå±±çŒ«æ­£é¢å¸å¼•é‡å…”ç¾¤ä½“çš„æ³¨æ„åŠ›ï¼Œå¦å¤–ä¸¤åªåˆ™ä»ä¸¤ä¾§è¿‚å›ï¼Œæ‰“ç ´é‡å…”çš„é˜²å¾¡åœ†åœˆã€‚è€Œå½“å±±çŒ«çš„åä½œç‹©çŒé¢‘ç‡å¢åŠ åˆ°60%ä»¥ä¸Šæ—¶ï¼Œé‡å…”åˆä¼šå¯åŠ¨æ–°çš„ç­–ç•¥æ¼”åŒ–â€”â€œåˆ†æ•£çªå›´â€ï¼Œåœ¨é­é‡åä½œç‹©çŒçš„å±±çŒ«æ—¶ï¼Œé‡å…”ç¾¤ä¼šç¬é—´å‘ä¸åŒæ–¹å‘é€ƒçªœï¼Œè¿«ä½¿å±±çŒ«åˆ†æ•£æ³¨æ„åŠ›ï¼Œæ— æ³•é›†ä¸­è¿½å‡»æŸä¸€åªï¼Œè¿™ä½¿å¾—å±±çŒ«çš„ç‹©çŒæˆåŠŸç‡åˆä¼šå›è½è‡³30%å·¦å³ã€‚è¿™ç§ç›¸äº’å¡‘é€ çš„è¿‡ç¨‹ä¸­ï¼Œç¯å¢ƒå› ç´ æ‰®æ¼”ç€éšæ€§ç­›é€‰å™¨çš„è§’è‰²ï¼Œå¯¹ç­–ç•¥æ•ˆæœäº§ç”Ÿå…³é”®å½±å“ï¼šåœ¨åœ°å½¢å¤æ‚çš„å±±åŒºï¼Œé‡å…”çš„åˆ†æ•£çªå›´ç­–ç•¥æ•ˆæœæ˜¾è‘—ï¼Œå› ä¸ºå´å²–çš„åœ°å½¢ä¼šé˜»ç¢å±±çŒ«çš„è¿½å‡»é€Ÿåº¦ï¼Œæ­¤æ—¶å±±çŒ«çš„åä½œé¢‘ç‡ä¼šç»´æŒåœ¨40%ä»¥ä¸‹ï¼›è€Œåœ¨å¼€é˜”çš„å¹³åŸåœ°åŒºï¼Œå±±çŒ«çš„åä½œç‹©çŒèƒ½å¤Ÿå……åˆ†å‘æŒ¥é€Ÿåº¦ä¼˜åŠ¿ï¼Œåä½œé¢‘ç‡ä¼šæå‡è‡³70%ä»¥ä¸Šï¼Œé‡å…”åˆ™ä¼šæ›´å¤šåœ°ç»“åˆåœ°å½¢ä¸­çš„åœŸå¡ã€æ²Ÿå£‘è¿›è¡Œè§„é¿ã€‚ç¯å¢ƒä¸ç‰©ç§è¡Œä¸ºçš„æ·±åº¦ç»‘å®šï¼Œè®©æ•é£Ÿ-çŒç‰©çš„äº’åŠ¨æ—¢ç¬¦åˆè‡ªèº«çš„ç”Ÿç‰©ç‰¹æ€§ï¼Œåˆä¸ç”Ÿå­˜ç¯å¢ƒé«˜åº¦é€‚é…ï¼Œå‘ˆç°å‡ºå¤æ‚è€ŒçœŸå®çš„ç”Ÿæ€é€»è¾‘ï¼Œè€Œéè„±ç¦»ç°å®çš„æœºæ¢°äº’åŠ¨ã€‚</p><p>ç”Ÿæ€ç³»ç»Ÿçš„â€œéŸ§æ€§é˜ˆå€¼â€è®¾è®¡æ˜¯å¹³è¡¡ç¨³å®šæ€§ä¸åŠ¨æ€æ€§çš„å…³é”®ï¼Œå…¶æ ¸å¿ƒç›®æ ‡æ˜¯ç¡®ä¿ç©å®¶è¡Œä¸ºä¸ä¼šå¯¼è‡´ç”Ÿæ€ç³»ç»Ÿå½»åº•å´©æºƒï¼ŒåŒæ—¶åˆèƒ½å¼•å‘è¶³å¤Ÿæ˜¾è‘—çš„æ¼”åŒ–ååº”ï¼Œè®©ç©å®¶æ„Ÿå—åˆ°è‡ªèº«è¡Œä¸ºçš„å½±å“åŠ›ã€‚æ¯ä¸ªåŠ¨æ€ç”Ÿæ€ç³»ç»Ÿéƒ½å­˜åœ¨å¤šä¸ªéšæ€§çš„éŸ§æ€§é˜ˆå€¼ï¼Œè¿™äº›é˜ˆå€¼å¹¶éå›ºå®šä¸å˜ï¼Œè€Œæ˜¯ä¼šæ ¹æ®ç”Ÿæ€ç³»ç»Ÿçš„é•¿æœŸæ¼”åŒ–è¿›è¡ŒåŠ¨æ€å¾®è°ƒï¼Œä¸»è¦åˆ†ä¸ºè½»åº¦å¹²é¢„é˜ˆå€¼ã€ä¸­åº¦å¹²é¢„é˜ˆå€¼å’Œæç«¯å¹²é¢„é˜ˆå€¼ä¸‰ä¸ªå±‚çº§ã€‚å½“ç©å®¶çš„å¹²é¢„è¡Œä¸ºæœªè¶…è¿‡è½»åº¦å¹²é¢„é˜ˆå€¼æ—¶ï¼Œæ¯”å¦‚çŸ­æœŸå‘æ²³æµä¸­æ’æ”¾å°‘é‡æ±¡æŸ“ç‰©ï¼Œå¯¼è‡´é±¼ç±»ï¼ˆå±±çŒ«çš„æ¬¡è¦çŒç‰©ï¼‰æ•°é‡å°å¹…ä¸‹é™ï¼Œç”Ÿæ€ç³»ç»Ÿä¼šå¯åŠ¨è‡ªæˆ‘ä¿®å¤æœºåˆ¶ï¼šé±¼ç±»ä¼šè°ƒæ•´ç¹æ®–å‘¨æœŸï¼Œå¢åŠ äº§åµé‡ï¼ŒåŒæ—¶æ²³æµä¸­çš„æµ®æ¸¸ç”Ÿç‰©ä¼šå› é±¼ç±»æ•é£Ÿå‡å°‘è€Œæ•°é‡ä¸Šå‡ï¼Œä¸ºé±¼ç±»æä¾›æ›´å¤šé£Ÿç‰©ï¼Œä¿ƒä½¿é±¼ç±»ç§ç¾¤åœ¨ä¸€ä¸ªæœˆå†…æ¢å¤æ­£å¸¸ï¼Œå±±çŒ«çš„ç‹©çŒè¡Œä¸ºå‡ ä¹ä¸å—å½±å“ã€‚å½“ç©å®¶çš„å¹²é¢„è¶…è¿‡è½»åº¦å¹²é¢„é˜ˆå€¼ä½†æœªè¾¾åˆ°æç«¯å¹²é¢„é˜ˆå€¼ï¼Œæ¯”å¦‚æŒç»­ä¸€ä¸ªæœˆå‘æ²³æµæ’æ”¾æ±¡æŸ“ç‰©ï¼Œé±¼ç±»æ•°é‡é”å‡60%ï¼Œæ­¤æ—¶ä¾èµ–é±¼ç±»ç”Ÿå­˜çš„æ°´é¸Ÿä¼šé¦–å…ˆè°ƒæ•´è¡Œä¸ºï¼Œå‡å°‘åœ¨è¯¥æ²³æµçš„æ´»åŠ¨èŒƒå›´ï¼Œéƒ¨åˆ†ä¸ªä½“å¼€å§‹å°è¯•æ•é£Ÿæµ…æ»©ä¸­çš„ç”²å£³ç±»åŠ¨ç‰©ï¼Œè¿™ç§æ–°çš„è§…é£Ÿè¡Œä¸ºä¼šé€æ¸åœ¨ç§ç¾¤ä¸­æ‰©æ•£ï¼Œå½¢æˆâ€œè¡Œä¸ºå†—ä½™â€â€”å³ä½¿åç»­é±¼ç±»æ•°é‡æ¢å¤ï¼Œæ°´é¸Ÿä»ä¼šä¿ç•™æ•é£Ÿç”²å£³ç±»çš„èƒ½åŠ›ï¼Œæå‡è‡ªèº«çš„ç”Ÿå­˜éŸ§æ€§ã€‚å½“ç©å®¶çš„å¹²é¢„è¶…è¿‡æç«¯å¹²é¢„é˜ˆå€¼ï¼Œæ¯”å¦‚æŒç»­åŠå¹´å‘æ²³æµæ’æ”¾é«˜æµ“åº¦æ±¡æŸ“ç‰©ï¼Œé±¼ç±»æ•°é‡é”å‡90%ä»¥ä¸Šï¼Œè¶…è¿‡ç”Ÿæ€ç³»ç»Ÿçš„è‡ªæˆ‘ä¿®å¤èƒ½åŠ›ï¼Œæ­¤æ—¶æ²³æµç”Ÿæ€ç³»ç»Ÿä¼šå½¢æˆä»¥è€æ±¡ç”Ÿç‰©ä¸ºä¸»çš„æ–°å¹³è¡¡ï¼Œæ¯”å¦‚è€æ±¡çš„æ°´èš¤ã€æ‘‡èšŠå¹¼è™«æˆä¸ºæ²³æµä¸­çš„ä¼˜åŠ¿ç‰©ç§ï¼ŒåŸæœ¬ä»¥é±¼ç±»ä¸ºé£Ÿçš„æ°´é¸Ÿä¼šå½»åº•è¿ç§»è‡³å…¶ä»–æ°´åŸŸï¼Œè€Œå±±çŒ«åˆ™ä¼šå°†ç‹©çŒé‡å¿ƒå®Œå…¨è½¬ç§»åˆ°é‡å…”ç­‰é™†åœ°çŒç‰©ä¸Šï¼Œæ²³æµå‘¨è¾¹çš„æ¤è¢«ä¼šå› é±¼ç±»ç²ªä¾¿å‡å°‘è€Œè¥å…»ä¸è¶³ï¼Œç”Ÿé•¿é€Ÿåº¦æ”¾ç¼“ï¼Œè¿›è€Œå½±å“ä¾èµ–æ¤è¢«ç”Ÿå­˜çš„æ˜†è™«æ•°é‡ã€‚è¿™ç§é˜ˆå€¼è®¾è®¡è®©ç”Ÿæ€ç³»ç»Ÿæ—¢æœ‰ä¸€å®šçš„è‡ªæˆ‘ä¿®å¤èƒ½åŠ›ï¼Œèƒ½å¤Ÿåº”å¯¹ç©å®¶çš„è½»åº¦å¹²é¢„ï¼Œåˆèƒ½å¯¹ç©å®¶çš„æç«¯è¡Œä¸ºåšå‡ºæ˜ç¡®å›åº”ï¼Œå½¢æˆæ–°çš„ç”Ÿæ€å¹³è¡¡ï¼Œé¿å…äº†ç”Ÿæ€ç³»ç»Ÿè¦ä¹ˆè¿‡äºè„†å¼±è¦ä¹ˆåƒµåŒ–ä¸å˜çš„å¼Šç«¯ï¼Œè®©æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿå‘ˆç°å‡ºâ€œå¯æ¼”åŒ–ã€ä¸å´©æºƒâ€çš„å¥åº·çŠ¶æ€ã€‚</p><p>å®ç°ç©å®¶é•¿æœŸè¡Œä¸ºçš„ç²¾å‡†åé¦ˆï¼Œéœ€è¦å»ºç«‹â€œä¸ªä½“è¡Œä¸º-ç§ç¾¤å˜åŒ–-ç”Ÿæ€é‡æ„â€çš„ä¸‰çº§ä¼ å¯¼æœºåˆ¶ï¼Œè¿™ä¸€æœºåˆ¶çš„æ ¸å¿ƒæ˜¯è®©ç©å®¶çš„å¾®è§‚æ“ä½œé€šè¿‡å±‚å±‚æ”¾å¤§ï¼Œæœ€ç»ˆå¼•å‘ç”Ÿæ€ç³»ç»Ÿçš„å®è§‚å˜åŒ–ï¼Œæ•´ä¸ªè¿‡ç¨‹è‡ªç„¶ä¸”åˆç†ï¼Œæ—¢è®©ç©å®¶æ„Ÿå—åˆ°è‡ªèº«è¡Œä¸ºçš„å½±å“åŠ›ï¼Œåˆä¸ä¼šå› åé¦ˆè¿‡äºç›´æ¥è€Œæ˜¾å¾—åˆ»æ„ã€‚åœ¨ä¸ªä½“è¡Œä¸ºå±‚é¢ï¼Œç©å®¶çš„ä¸€æ¬¡å¶ç„¶è¡Œä¸ºï¼Œæ¯”å¦‚æ•‘åŠ©ä¸€åªè¢«é™·é˜±å›°ä½çš„å—ä¼¤å±±çŒ«ï¼Œæœ¬èº«ä¸ä¼šå¯¹ç”Ÿæ€ç³»ç»Ÿäº§ç”Ÿæ˜æ˜¾å½±å“ï¼Œä½†å¦‚æœè¿™ç§æ•‘åŠ©è¡Œä¸ºæŒç»­å‘ç”Ÿï¼Œæ¯”å¦‚ç©å®¶æ¯å‘¨éƒ½ä¼šæ•‘åŠ©å—ä¼¤çš„å±±çŒ«ï¼Œä¸ºå®ƒä»¬æä¾›é£Ÿç‰©å’Œä¼¤å£å¤„ç†ï¼Œé‚£ä¹ˆè¯¥å±±çŒ«ç§ç¾¤å¯¹äººç±»çš„â€œè­¦æˆ’é˜ˆå€¼â€ä¼šé€æ¸é™ä½â€”ä»åŸæœ¬è·ç¦»äººç±»50ç±³å°±ä¼šé€ƒç¦»ï¼Œé€æ¸ç¼©çŸ­è‡³20ç±³ã€10ç±³ï¼Œæœ€ç»ˆéƒ¨åˆ†å±±çŒ«ä¼šä¸»åŠ¨é è¿‘äººç±»æ´»åŠ¨åŒºåŸŸè§…é£Ÿã€‚åœ¨ç§ç¾¤å˜åŒ–å±‚é¢ï¼Œå±±çŒ«ç§ç¾¤çš„æ´»åŠ¨èŒƒå›´ä¼šä»¥äººç±»æ´»åŠ¨åŒºåŸŸä¸ºä¸­å¿ƒå‘å¤–æ‰©å¼ 2å€ï¼Œè¿™ä¼šå¯¹é‡å…”ç§ç¾¤äº§ç”Ÿç›´æ¥å½±å“ï¼šé‡å…”ä¼šå› å±±çŒ«çš„æ´»åŠ¨èŒƒå›´æ‰©å¼ è€Œæ„Ÿåˆ°å¨èƒï¼Œå¼€å§‹å‘è¿œç¦»äººç±»æ´»åŠ¨åŒºåŸŸçš„å±±æ—æ·±å¤„è¿ç§»ï¼Œé‡å…”ç§ç¾¤çš„åˆ†å¸ƒå¯†åº¦ä¼šä»äººç±»æ´»åŠ¨åŒºåŸŸå‘¨è¾¹çš„æ¯å¹³æ–¹å…¬é‡Œ20åªï¼Œä¸‹é™è‡³æ¯å¹³æ–¹å…¬é‡Œ5åªï¼Œè€Œå±±æ—æ·±å¤„çš„é‡å…”å¯†åº¦åˆ™ä¼šç›¸åº”æå‡ã€‚åœ¨ç”Ÿæ€é‡æ„å±‚é¢ï¼Œé‡å…”çš„è¿ç§»ä¼šç›´æ¥å½±å“å‘¨è¾¹çš„æ¤è¢«åˆ†å¸ƒï¼šäººç±»æ´»åŠ¨åŒºåŸŸå‘¨è¾¹çš„æ¤è¢«å› é‡å…”å•ƒé£Ÿå‡å°‘è€Œè¿‡åº¦ç”Ÿé•¿ï¼ŒåŸæœ¬çš„è‰åœ°ä¼šé€æ¸æ¼”å˜ä¸ºå¯†é›†çš„çŒæœ¨ä¸›ï¼›è€Œå±±æ—æ·±å¤„çš„æ¤è¢«åˆ™ä¼šå› é‡å…”å•ƒé£ŸåŠ å‰§è€Œç”Ÿé•¿ç¼“æ…¢ï¼Œè‰åœ°ä¿æŒç¨€ç–çŠ¶æ€ã€‚</p>]]></description></item><item>    <title><![CDATA[ã€Šç¾ç»Šå‹åæ´¾å¡‘é€ ï¼šæƒ…æ„Ÿé—­ç¯ä¸è§’è‰²ç«‹ä½“åº¦æ‰“é€ æŒ‡å—ã€‹ ç¨‹åºå‘˜é˜¿ä¼Ÿ ]]></title>    <link>https://segmentfault.com/a/1190000047586238</link>    <guid>https://segmentfault.com/a/1190000047586238</guid>    <pubDate>2026-02-01 23:01:24</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>çœŸæ­£èƒ½åœ¨ç©å®¶è®°å¿†ä¸­æ‰æ ¹çš„å¤æ‚åæ´¾ï¼Œæ˜¯â€œåŠ¨æœºçº¯ç²¹æ€§â€ä¸â€œè¡Œä¸ºç ´åæ€§â€çš„æè‡´æ’•è£‚ï¼Œå…¶æ ¸å¿ƒè®¾è®¡é€»è¾‘åœ¨äºè®©ç©å®¶åœ¨å…±æƒ…ä¸è°´è´£ä¹‹é—´åå¤æ‘‡æ‘†ï¼Œæ—¢è¢«å…¶åšå®ˆçš„ä¿¡å¿µæ‰€æ‰“åŠ¨ï¼Œåˆå¯¹å…¶é€ æˆçš„ä¼¤å®³æ— æ³•é‡Šæ€€ã€‚ä»¥ä¸€ä¸ªæ‰§å¿µäºâ€œä¿®å¤æ—¶ç©ºè£‚éš™â€çš„è§’è‰²ä¸ºä¾‹ï¼Œä»–çš„åˆå¿ƒæºäºç«¥å¹´åˆ›ä¼¤â€”â€”äº²çœ¼ç›®ç¹æ—¶ç©ºå´©å¡Œåå™¬äº†è‡ªå·±çš„æ—ç¾¤ï¼Œé‚£äº›æ¸©æš–çš„äº²æƒ…ã€æ—ç¾¤çš„ä¼ æ‰¿ï¼Œéƒ½åœ¨è£‚éš™ä¸­åŒ–ä¸ºä¹Œæœ‰ï¼Œè¿™ä»½å¯¹â€œå®Œæ•´â€ä¸â€œæ•‘èµâ€çš„æ‰§å¿µï¼Œæ°æ°å‡»ä¸­äº†ç©å®¶å†…å¿ƒå¯¹â€œå¼¥è¡¥é—æ†¾â€çš„å…±é€šæ¸´æœ›ã€‚ä½†ä»–çš„è¡ŒåŠ¨å´èµ°å‘äº†ä¸å¯æŒ½å›çš„æç«¯ï¼šä¸ºäº†æ”¶é›†ä¿®å¤è£‚éš™æ‰€éœ€çš„èƒ½é‡ï¼Œä»–ä¸æƒœæŠ½å–å„ä¸ªä¸–ç•Œçš„æ ¸å¿ƒç”Ÿå‘½åŠ›ï¼Œå¯¼è‡´æ‘åº„æ¯èã€ç”Ÿçµæµç¦»ï¼Œç”šè‡³æ“æ§æ—¶ç©ºç¢ç‰‡æ”»å‡»è¯•å›¾é˜»æ­¢ä»–çš„ç©å®¶ï¼Œç”¨æ— æ•°ä¸ªä½“çš„è‹¦éš¾æ¢å–ä»–å¿ƒä¸­çš„â€œæ—¶ç©ºå®Œæ•´â€ã€‚è¿™ç§è®¾è®¡çš„å…³é”®åœ¨äºâ€œåŠ¨æœºæº¯æºçš„æƒ…æ„Ÿé”šå®šâ€ï¼Œæ‘’å¼ƒâ€œæƒåŠ›æ¬²â€â€œå¤ä»‡å¿ƒâ€ç­‰è€å¥—è®¾å®šï¼ŒæŒ–æ˜æ›´æ™®ä¸–çš„æƒ…æ„Ÿå†…æ ¸ï¼Œå¦‚æ•‘èµã€å®ˆæŠ¤ã€å¼¥è¡¥ï¼Œå†å°†è¿™ä»½çº¯ç²¹åŠ¨æœºä¸æå…·ç ´åæ€§çš„è¡Œä¸ºæ·±åº¦ç»‘å®šã€‚ç©å®¶åœ¨ä½“éªŒè¿‡ç¨‹ä¸­ï¼Œä¼šé€šè¿‡å‰§æƒ…ç¢ç‰‡ã€åæ´¾çš„ç‹¬ç™½é€æ­¥æ‹¼å‡‘å‡ºä»–çš„è¿‡å¾€ï¼Œæ¸…æ™°æ„ŸçŸ¥åˆ°ä»–è¡Œä¸ºçš„æ®‹é…·ï¼Œå´åˆæ— æ³•å½»åº•å¦å®šå…¶åŠ¨æœºçš„åˆç†æ€§â€”â€”æ¯•ç«Ÿè°ä¸æ›¾æ¸´æœ›å¼¥è¡¥ç”Ÿå‘½ä¸­çš„é—æ†¾ï¼Ÿè¿™ç§è®¤çŸ¥å±‚é¢çš„çŸ›ç›¾ï¼Œä¼šå‚¬ç”Ÿå¤æ‚çš„æƒ…æ„Ÿå¼ åŠ›ï¼Œæ—¢å¯¹ä»–é€ æˆçš„ç¾éš¾æ„Ÿåˆ°æ„¤æ€’ï¼Œåˆå¯¹ä»–çš„å­¤ç‹¬åšå®ˆäº§ç”Ÿéšç§˜çš„å¿ƒç–¼ï¼Œä»è€Œå¥ å®šâ€œåˆçˆ±åˆæ¨â€çš„æƒ…æ„ŸåŸºç¡€ã€‚</p><p>å¡‘é€ æ­¤ç±»åæ´¾çš„æ ¸å¿ƒæŠ€æœ¯è·¯å¾„ï¼Œåœ¨äºæ­å»ºâ€œè¡Œä¸ºåå·®çŸ©é˜µâ€ï¼Œæ‰“ç ´å•ä¸€è¡Œä¸ºé€»è¾‘çš„æ¡æ¢ï¼Œè®©åæ´¾åœ¨ä¸åŒåœºæ™¯ä¸‹å‘ˆç°å‡ºç›¸æ‚–å´è‡ªæ´½çš„ç‰¹è´¨ï¼Œé€šè¿‡ç»†èŠ‚çš„å¼ åŠ›æ”¾å¤§æƒ…æ„Ÿæ‹‰æ‰¯çš„å¼ºåº¦ã€‚ä»¥è¿™ä½æ—¶ç©ºä¿®å¤è€…ä¸ºä¾‹ï¼Œä»–åœ¨é¢å¯¹æ—¶ç©ºè£‚éš™ä¸­æ®‹ç•™çš„æ—ç¾¤è®°å¿†ç¢ç‰‡æ—¶ï¼Œä¼šå±•ç°å‡ºæè‡´çš„æ¸©æŸ”ï¼šä»–ä¼šç”¨èƒ½é‡å°å¿ƒç¿¼ç¿¼åœ°æ»‹å…»é‚£äº›å³å°†æ¶ˆæ•£çš„è®°å¿†å…‰ç‚¹ï¼Œè½»å£°å‘¼å”¤ç€äº²äººçš„åå­—ï¼Œçœ¼ç¥ä¸­æ»¡æ˜¯è„†å¼±ä¸æ€€å¿µï¼Œç”šè‡³ä¼šä¸ºäº†ä¿æŠ¤ä¸€æšæ‰¿è½½ç€ç«¥å¹´å›å¿†çš„æ—§ç‰©ï¼Œæš‚æ—¶åœä¸‹æŠ½å–èƒ½é‡çš„è¡ŒåŠ¨ã€‚è¿™äº›æ¸©æƒ…ç»†èŠ‚ç»éæ— å…³ç´§è¦çš„ç‚¹ç¼€ï¼Œè€Œæ˜¯ä¸ä»–å¯¹å¤–ç•Œçš„å†·é…·å½¢æˆå¼ºçƒˆå¯¹å†²â€”â€”å½“ç©å®¶è¯•å›¾é˜»æ­¢ä»–æŠ½å–æŸæ‘åº„çš„ç”Ÿå‘½åŠ›æ—¶ï¼Œä»–ä¼šæ¯«ä¸çŠ¹è±«åœ°å‘åŠ¨æ—¶ç©ºæ”»å‡»ï¼Œçœ¼ç¥å†°å†·ï¼Œè¯­æ°”å†³ç»ï¼Œä»¿ä½›æ‰€æœ‰ç”Ÿçµçš„ç—›è‹¦éƒ½ä¸ä»–æ— å…³ï¼›ä½†å½“ä»–å‘ç°æ‘åº„ä¸­ä¸€ä¸ªå­©å­æ­£é‡å¤ç€ä»–ç«¥å¹´æ—¶çš„å­¤ç‹¬å¢ƒé‡æ—¶ï¼Œåˆä¼šæ‚„æ‚„ç•™ä¸‹ä¸€æšèƒ½æä¾›æ¸©æš–çš„èƒ½é‡ç»“æ™¶ï¼Œè½¬èº«æ—¶å´ä¾æ—§åšå®šåœ°ç»§ç»­è‡ªå·±çš„è®¡åˆ’ã€‚è¿™ç§åå·®è®¾è®¡çš„å…³é”®åœ¨äºâ€œé€»è¾‘é—­ç¯çš„æ„å»ºâ€ï¼Œæ‰€æœ‰çœ‹ä¼¼çŸ›ç›¾çš„è¡Œä¸ºï¼Œéƒ½å¿…é¡»å›å½’åˆ°åæ´¾çš„æ ¸å¿ƒä¿¡å¿µä¹‹ä¸Šï¼šä»–å¹¶éå¤©ç”Ÿå†·æ¼ ï¼Œåªæ˜¯å°†â€œä¿®å¤æ—¶ç©ºã€æ‰¾å›æ—ç¾¤â€è§†ä¸ºå‡Œé©¾ä¸€åˆ‡çš„ç»ˆæç›®æ ‡ï¼Œæ¸©æƒ…åªç»™äºˆä¸ä»–è¿‡å¾€ç›¸å…³ã€ä¸å¨èƒè¿™ä¸€ç›®æ ‡çš„å­˜åœ¨ï¼Œè€Œå†·é…·åˆ™å¯¹å‡†æ‰€æœ‰é˜»ç¢ä»–çš„å¯¹è±¡ã€‚ç©å®¶åœ¨ä½“éªŒè¿‡ç¨‹ä¸­ï¼Œä¼šå› è¿™äº›æ¸©æƒ…ç»†èŠ‚å¯¹åæ´¾äº§ç”Ÿå¥½æ„Ÿä¸å…±æƒ…ï¼Œç”šè‡³ä¼šåœ¨æŸä¸ªç¬é—´ç†è§£ä»–çš„åæ‰§ï¼Œå´åˆä¼šå› ä»–å¯¹æ— è¾œç”Ÿçµçš„æ¼ è§†è€Œå¿ƒç”ŸæŠµè§¦ï¼Œè¿™ç§åå¤çš„æƒ…æ„Ÿåˆ‡æ¢ï¼Œæ­£æ˜¯â€œåˆçˆ±åˆæ¨â€çš„æ ¸å¿ƒé­…åŠ›æ‰€åœ¨ã€‚</p><p>ä»·å€¼è§‚çš„â€œå¹³è¡Œåšå¼ˆâ€è®¾è®¡ï¼Œæ˜¯è®©åæ´¾è¶…è¶Šâ€œå•çº¯å¯¹æ‰‹â€èº«ä»½ï¼Œæˆä¸ºç©å®¶æƒ…æ„ŸæŠ•å°„è½½ä½“çš„å…³é”®ã€‚åæ´¾çš„ä»·å€¼è§‚ä¸åº”æ˜¯å®Œå…¨é”™è¯¯çš„ï¼Œè€Œæ˜¯ä¸ç©å®¶ï¼ˆæˆ–ä¸»è§’ï¼‰çš„ä»·å€¼è§‚å¹³è¡Œå­˜åœ¨ï¼Œå„è‡ªæ‹¥æœ‰å®Œæ•´çš„é€»è¾‘æ”¯æ’‘ä¸é“å¾·ä¾æ®ï¼Œä¸å­˜åœ¨ç»å¯¹çš„å¯¹é”™ä¹‹åˆ†ï¼Œåªå­˜åœ¨ç«‹åœºä¸é€‰æ‹©çš„å·®å¼‚ã€‚ä»¥æ—¶ç©ºä¿®å¤è€…ä¸ºä¾‹ï¼Œä»–çš„ä»·å€¼è§‚æ˜¯â€œé›†ä½“å­˜ç»­çš„ä»·å€¼é«˜äºä¸ªä½“çš„ç”Ÿå‘½æƒâ€ï¼Œåœ¨ä»–çœ‹æ¥ï¼Œæ—¶ç©ºå´©å¡Œä¼šå¯¼è‡´æ‰€æœ‰ä¸–ç•Œçš„æ¯ç­ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œå½“å‰å‡ ä¸ªä¸–ç•Œçš„ç”Ÿçµè‹¦éš¾åªæ˜¯æš‚æ—¶çš„ç‰ºç‰²ï¼Œå”¯æœ‰ä¿®å¤è£‚éš™ï¼Œæ‰èƒ½è®©åŒ…æ‹¬ä»–æ—ç¾¤åœ¨å†…çš„æ‰€æœ‰ç”Ÿå‘½è·å¾—æ°¸æ’çš„å®‰å®ï¼›è€Œç©å®¶ï¼ˆæˆ–ä¸»è§’ï¼‰çš„ä»·å€¼è§‚åˆ™æ˜¯â€œæ¯ä¸ªä¸ªä½“çš„ç”Ÿå‘½éƒ½å€¼å¾—è¢«å°Šé‡â€ï¼Œè®¤ä¸ºä»»ä½•å®å¤§çš„ç›®æ ‡éƒ½ä¸åº”ä»¥ç‰ºç‰²æ— è¾œè€…ä¸ºä»£ä»·ï¼Œæ—¶ç©ºçš„è‡ªç„¶æ¼”è¿›æˆ–è®¸æœ‰é—æ†¾ï¼Œä½†å¼ºè¡Œå¹²é¢„å¸¦æ¥çš„ä¼¤å®³æ›´ä¸ºè‡´å‘½ã€‚è¿™ä¸¤ç§ä»·å€¼è§‚æ²¡æœ‰ç»å¯¹çš„ä¼˜åŠ£ï¼Œéƒ½æœ‰å…¶é“å¾·ç«‹è¶³ç‚¹ã€‚åœ¨è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œéœ€è¦é€šè¿‡å…·ä½“åœºæ™¯è®©ä¸¤ç§ä»·å€¼è§‚æ­£é¢ç¢°æ’ï¼šå½“æŸä¸ªäººç±»æ‘åº„çš„ç”Ÿå‘½åŠ›æ˜¯ä¿®å¤è£‚éš™çš„æœ€åä¸€å—èƒ½é‡æ‹¼å›¾æ—¶ï¼Œåæ´¾åšæŒè¦æŠ½å–èƒ½é‡ï¼Œè®¤ä¸ºç‰ºç‰²ä¸€ä¸ªæ‘åº„èƒ½æ‹¯æ•‘åƒä¸‡ä¸ªä¸–ç•Œï¼›è€Œç©å®¶éœ€è¦åœ¨â€œååŠ©åæ´¾å®Œæˆä¿®å¤ï¼Œç‰ºç‰²æ‘åº„â€ä¸â€œé˜»æ­¢åæ´¾ï¼Œæ”¾ä»»æ—¶ç©ºè£‚éš™æ‰©å¤§â€ä¹‹é—´åšå‡ºé€‰æ‹©ã€‚è¿™ç§å†²çªè®©ç©å®¶æ— æ³•ç®€å•åœ°å°†åæ´¾å®šä¹‰ä¸ºâ€œæ¶äººâ€ï¼Œå› ä¸ºä»–çš„ä»·å€¼è§‚åœ¨â€œæ‹¯æ•‘æ‰€æœ‰ä¸–ç•Œâ€çš„å®å¤§å™äº‹ä¸‹åŒæ ·å…·æœ‰è¯´æœåŠ›ï¼Œç©å®¶åœ¨åšå®ˆè‡ªèº«ä»·å€¼è§‚çš„åŒæ—¶ï¼Œä¹Ÿèƒ½ç†è§£åæ´¾çš„é€‰æ‹©èƒŒåçš„é€»è¾‘ï¼Œè¿™ç§ä»·å€¼è§‚å±‚é¢çš„å…±æƒ…ä¸å†²çªï¼Œä¼šè®©ç©å®¶å¯¹åæ´¾çš„æƒ…æ„Ÿæ›´åŠ å¤æ‚ï¼Œæ—¢ä¸è®¤åŒå…¶æ‰‹æ®µï¼Œåˆæ— æ³•å½»åº•å¦å®šå…¶ç†å¿µã€‚</p><p>â€œè„†å¼±æ€§åœºæ™¯åŒ–æ¤å…¥â€æ˜¯é¿å…åæ´¾å› å¼ºå¤§è€Œæ˜¾å¾—å†°å†·çš„å…³é”®è®¾è®¡ï¼Œé€šè¿‡å±•ç°åæ´¾ä¸ä¸ºäººçŸ¥çš„æŒ£æ‰ä¸ç—›è‹¦ï¼Œè®©ç©å®¶çœ‹åˆ°å…¶â€œäººâ€çš„ä¸€é¢ï¼Œä»è€Œäº§ç”Ÿæ›´æ·±å±‚æ¬¡çš„å…±æƒ…ï¼Œä¸ºâ€œçˆ±â€çš„æƒ…æ„Ÿæä¾›åšå®æ”¯æ’‘ã€‚è¿™ç§è„†å¼±æ€§å¹¶éç›´ç™½çš„è½¯å¼±ï¼Œè€Œæ˜¯ä¸æ ¸å¿ƒä¿¡å¿µç´§å¯†ç›¸å…³çš„å†…å¿ƒçŸ›ç›¾ä¸ç—›è‹¦ã€‚ä»¥æ—¶ç©ºä¿®å¤è€…ä¸ºä¾‹ï¼Œåœ¨æ·±å¤œç‹¬å¤„æ—¶ï¼Œä»–ä¼šå¯¹ç€æ—ç¾¤çš„æ—§ç‰©å‘å‘†ï¼Œæ‰‹æŒ‡è½»æŠšä¸Šé¢çš„çº¹è·¯ï¼Œçœ¼ç¥ä¸­å……æ»¡è½å¯ä¸è‡ªæˆ‘æ€€ç–‘â€”â€”ä»–å¹¶éæ²¡æœ‰æ„è¯†åˆ°è‡ªå·±çš„è¡Œä¸ºä¼¤å®³äº†æ— æ•°ç”Ÿçµï¼Œåªæ˜¯åœ¨â€œä¿®å¤æ—¶ç©ºâ€ä¸â€œæ€œæ‚¯ä»–äººâ€ä¹‹é—´ï¼Œä»–æ‰¾ä¸åˆ°ä¸¤å…¨çš„å‡ºè·¯ã€‚æœ‰è¿™æ ·ä¸€ä¸ªå…·ä½“åœºæ™¯ï¼šå½“ä»–æŠ½å–ä¸€ä¸ªæ‘åº„çš„ç”Ÿå‘½åŠ›æ—¶ï¼Œçœ‹åˆ°ä¸€ä¸ªå­©å­ç´§ç´§æŠ±ç€å³å°†æ¯èçš„èŠ±æœµå“­æ³£ï¼Œé‚£åŒæ— åŠ©çš„çœ¼ç›ä¸ä»–ç«¥å¹´æ—¶çš„çœ¼ç¥é‡åˆï¼Œä»–çš„åŠ¨ä½œçªç„¶åœæ»ï¼Œèƒ½é‡æ³¢åŠ¨å‡ºç°ç´Šä¹±ï¼Œæ‰‹æŒ‡åœ¨æ§åˆ¶è£…ç½®ä¸ŠçŠ¹è±«äº†è®¸ä¹…ï¼Œæœ€ç»ˆè¿˜æ˜¯å’¬ç€ç‰™å®Œæˆäº†æŠ½å–ï¼Œä½†éšåå´æ‚„æ‚„ç”¨è‡ªå·±çš„èƒ½é‡ä¸ºå­©å­æŠ¤ä½äº†é‚£æœµèŠ±ï¼Œè½¬èº«æ—¶èƒŒå½±æ»¡æ˜¯ç–²æƒ«ä¸ç—›è‹¦ã€‚è¿™ç§ç»†èŠ‚å±•ç°äº†ä»–å†…å¿ƒçš„æ’•è£‚ï¼Œè®©ç©å®¶æ˜ç™½ä»–çš„æç«¯è¡Œä¸ºå¹¶éæºäºå†·è¡€ï¼Œè€Œæ˜¯æºäºä¿¡å¿µçš„æ·é”ä¸ç°å®çš„æ— å¥ˆã€‚åœ¨è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œè¿™ç§è„†å¼±æ€§åœºæ™¯éœ€è¦â€œç‚¹åˆ°å³æ­¢â€ï¼Œä¸èƒ½è¿‡åº¦æ¸²æŸ“ï¼Œå¦åˆ™ä¼šå‰Šå¼±åæ´¾çš„å¨æ…‘åŠ›ï¼Œå¤±å»â€œæ¨â€çš„æƒ…æ„ŸåŸºç¡€ã€‚é€šè¿‡è¿™ç§â€œå¼ºå¤§å¤–å£³ä¸‹çš„éšç§˜è„†å¼±â€ï¼Œè®©åæ´¾çš„å½¢è±¡æ›´åŠ ç«‹ä½“ä¸°æ»¡ï¼Œç©å®¶ä¼šå› ä»–çš„æŒ£æ‰è€Œå¿ƒç–¼ï¼Œå› ä»–çš„åšæŒè€Œæ•¬ä½©ï¼Œå´åˆå› ä»–é€ æˆçš„ä¼¤å®³è€Œæ„¤æ€’ï¼Œæƒ…æ„Ÿå±‚æ¬¡æ„ˆå‘ä¸°å¯Œï¼Œâ€œåˆçˆ±åˆæ¨â€çš„æ‹‰æ‰¯æ„Ÿä¹Ÿéšä¹‹æ·±åŒ–ã€‚</p><p>ç©å®¶ä¸åæ´¾çš„â€œäº’åŠ¨æƒ…æ„Ÿæ¢¯åº¦â€è®¾è®¡ï¼Œæ˜¯è®©å¤æ‚æƒ…æ„ŸæŒç»­å‘é…µçš„æ ¸å¿ƒï¼Œé€šè¿‡é€æ­¥é€’è¿›çš„äº’åŠ¨æ¨¡å¼ï¼Œè®©ç©å®¶ä»åˆå§‹çš„å¯¹ç«‹ï¼Œåˆ°ä¸­é—´çš„å…±æƒ…ï¼Œå†åˆ°æœ€ç»ˆçš„æƒ…æ„Ÿæ‹‰æ‰¯ï¼Œå½¢æˆå®Œæ•´çš„æƒ…æ„Ÿä½“éªŒé“¾ã€‚åˆå§‹é˜¶æ®µï¼Œç©å®¶ä¸åæ´¾æ˜¯çº¯ç²¹çš„å¯¹ç«‹å…³ç³»ï¼Œåæ´¾çš„è¡Œä¸ºç»™ç©å®¶çš„å†’é™©å¸¦æ¥å·¨å¤§é˜»ç¢ï¼Œæ¯”å¦‚ç ´åç©å®¶çš„ä»»åŠ¡ç›®æ ‡ã€ä¼¤å®³ç©å®¶çè§†çš„NPCï¼Œç©å®¶å¯¹å…¶å……æ»¡æ•Œæ„ï¼Œä¸€å¿ƒæƒ³è¦é˜»æ­¢ä»–ï¼›éšç€å‰§æƒ…æ¨è¿›ï¼Œé€šè¿‡è§¦å‘éšè—å‰§æƒ…ã€å‘ç°åæ´¾çš„æ—¥è®°æˆ–è®°å¿†ç¢ç‰‡ã€ç›®ç¹åæ´¾çš„æ¸©æƒ…ç»†èŠ‚ç­‰æ–¹å¼ï¼Œè®©ç©å®¶é€æ¸äº†è§£åæ´¾çš„è¿‡å¾€ä¸åŠ¨æœºï¼Œæƒ…æ„Ÿå¼€å§‹ä»â€œæ¨â€å‘â€œç†è§£â€è½¬å˜â€”â€”åŸæ¥ä»–çš„åæ‰§èƒŒåæ˜¯å¦‚æ­¤æ²‰é‡çš„åˆ›ä¼¤ï¼›åœ¨ä¸­æœŸï¼Œè®¾è®¡â€œè¢«è¿«åˆä½œâ€çš„å…³é”®åœºæ™¯ï¼Œæ¯”å¦‚å…±åŒå¯¹æŠ—ä¸€ä¸ªæ›´å¼ºå¤§çš„ã€å¨èƒåˆ°æ‰€æœ‰ä¸–ç•Œçš„æ•Œäººï¼ˆå¦‚æ—¶ç©ºè£‚éš™ä¸­è¯ç”Ÿçš„æ€ªç‰©ï¼‰ï¼Œåœ¨åˆä½œè¿‡ç¨‹ä¸­ï¼Œç©å®¶ä¼šçœ‹åˆ°åæ´¾çš„æ™ºæ…§ã€å‹‡æ°”ä¸æ‹…å½“ï¼Œç”šè‡³ä¼šåœ¨ç”Ÿæ­»å…³å¤´å¾—åˆ°ä»–çš„æ•‘åŠ©ï¼Œäº§ç”Ÿé»˜å¥‘ä¸ä¿¡ä»»ï¼Œæƒ…æ„Ÿä¸­åŠ å…¥â€œæ•¬ä½©â€ä¸â€œå¥½æ„Ÿâ€ï¼›ä½†åˆä½œç»“æŸåï¼Œåæ´¾ä¼šåšå®šåœ°å›å½’è‡ªå·±çš„é“è·¯ï¼Œå†æ¬¡ä¸ç©å®¶å¯¹ç«‹ï¼Œç”šè‡³ä¼šä¸ºäº†å®Œæˆç›®æ ‡è€Œå¯¹ç©å®¶å‡ºæ‰‹ï¼Œè®©ç©å®¶çš„æƒ…æ„Ÿä»â€œå¥½æ„Ÿâ€é‡æ–°å›åˆ°â€œæŠµè§¦â€ï¼Œå½¢æˆåå¤æ‹‰æ‰¯ã€‚æ¯”å¦‚åœ¨å…±åŒå¯¹æŠ—æ—¶ç©ºæ€ªç‰©åï¼Œç©å®¶ä»¥ä¸ºåæ´¾ä¼šæœ‰æ‰€æ”¹å˜ï¼Œè¯•å›¾åŠè¯´ä»–æ”¾å¼ƒä¼¤å®³æ— è¾œï¼Œå´æ²¡æƒ³åˆ°ä»–åªæ˜¯å†·æ¼ åœ°è¡¨ç¤ºâ€œæ‰€æœ‰é˜»ç¢éƒ½å°†è¢«æ¸…é™¤â€ï¼Œç”šè‡³å¯¹ç©å®¶å‘åŠ¨æ”»å‡»ï¼Œè¿™ç§â€œå¸Œæœ›ä¸å¤±æœ›â€çš„äº¤æ›¿ï¼Œä¼šè®©ç©å®¶çš„æƒ…æ„Ÿæ›´åŠ å¤æ‚ï¼Œæ—¢æ”¾ä¸ä¸‹å¯¹åæ´¾çš„å¥½æ„Ÿä¸å…±æƒ…ï¼Œåˆæ— æ³•è®¤åŒå…¶è¡Œä¸ºï¼Œä»è€Œæ·±é™·â€œåˆçˆ±åˆæ¨â€çš„æƒ…æ„Ÿæ¼©æ¶¡ã€‚</p><p>ç»“å±€çš„â€œæƒ…æ„Ÿç•™ç™½è®¾è®¡â€æ˜¯å·©å›ºåæ´¾å¤æ‚å½¢è±¡çš„æœ€åä¸€æ­¥ï¼Œé¿å…ç»™å‡ºæ˜ç¡®çš„â€œæ´—ç™½â€æˆ–â€œå½»åº•å¦å®šâ€çš„ç»“å±€ï¼Œè®©ç©å®¶åœ¨ä½“éªŒç»“æŸåä»èƒ½æŒç»­å›å‘³ï¼Œæ·±åŒ–â€œåˆçˆ±åˆæ¨â€çš„æƒ…æ„Ÿè®°å¿†ã€‚ç»“å±€ä¸åº”æ˜¯åæ´¾è¢«å½»åº•æ¶ˆç­æˆ–å®Œå…¨æ‚”æ”¹ï¼Œè€Œæ˜¯å‘ˆç°å…¶è¡Œä¸ºçš„æœ€ç»ˆåæœä¸è‡ªèº«çš„æœ€ç»ˆçŠ¶æ€ï¼Œç•™ä¸‹å……è¶³çš„è§£è¯»ç©ºé—´ã€‚æ¯”å¦‚æ—¶ç©ºä¿®å¤è€…æœ€ç»ˆæˆåŠŸä¿®å¤äº†æ—¶ç©ºè£‚éš™ï¼Œæ‰€æœ‰ä¸–ç•Œå¾—ä»¥ä¿å…¨ï¼Œä½†ä»–å› è¿‡åº¦ä½¿ç”¨èƒ½é‡è€Œæ¿’ä¸´æ¶ˆæ•£ï¼Œåªèƒ½åœ¨æ—ç¾¤çš„æ—§åœ°åŒ–ä½œä¸€é“è™šå½±ï¼Œæ°¸è¿œå®ˆæœ›ç€ä»–ç”¨æ— æ•°ä»£ä»·æ¢æ¥çš„â€œå®Œæ•´æ—¶ç©ºâ€ï¼›è€Œé‚£äº›è¢«ä»–ä¼¤å®³çš„æ‘åº„è™½ç„¶é€æ¸æ¢å¤ç”Ÿæœºï¼Œä½†ç»å†è¿‡çš„è‹¦éš¾å´æˆä¸ºæ— æ³•ç£¨ç­çš„è®°å¿†ï¼Œæ‘æ°‘ä»¬å¯¹ä»–æ—¢æ„Ÿæ¿€åˆæ€¨æ¨ã€‚è¿™ç§ç»“å±€æ²¡æœ‰è¯„åˆ¤åæ´¾çš„å¯¹é”™ï¼Œåªæ˜¯å®¢è§‚å‘ˆç°äº†ä»–çš„é€‰æ‹©å¸¦æ¥çš„ç»“æœâ€”â€”ä»–å®ç°äº†è‡ªå·±çš„æ ¸å¿ƒç›®æ ‡ï¼Œå´ä¹Ÿä»˜å‡ºäº†æ²‰é‡çš„ä»£ä»·ï¼Œä¼¤å®³äº†æ— æ•°æ— è¾œè€…ã€‚</p>]]></description></item><item>    <title><![CDATA[OpenClawå®˜æ–¹æ¨èï¼æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨ Kimi K2.5 æ‰“é€ 24å°æ—¶ AI åŠ©æ‰‹ï¼ˆè¶…è¯¦ç»†ï¼Œé™„70]]></title>    <link>https://segmentfault.com/a/1190000047585331</link>    <guid>https://segmentfault.com/a/1190000047585331</guid>    <pubDate>2026-02-01 22:08:28</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ç”²æœ¨ã€‚</p><p>åˆšåˆšï¼ŒX ä¸Šçœ‹åˆ°<strong>OpenClawå®˜æ–¹æ¨è Kimi 2.5 æ¥å…¥Clawdbot</strong>ï¼Œæ‰€ä»¥è¿å¤œçˆ¬èµ·ç»™å¤§å®¶å‡†å¤‡äº†è¿™ä»½æ•™ç¨‹ï¼</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585334" alt="" title=""/></p><p>å‰ä¸¤å¤©çš„ClawdBotçš„æ•™ç¨‹å†™å®Œä¹‹åï¼Œå¾ˆå¤šæœ‹å‹æ¯”è¾ƒæ„Ÿå…´è¶£éƒ¨ç½²OpenClawå®˜æ–¹åŸç”Ÿï¼Œè¿˜æƒ³æ¥å…¥è‡ªå·±çš„API KEYï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585335" alt="" title="" loading="lazy"/></p><p>æ­£å¥½å®˜æ–¹æ¨èï¼Œå†åŠ ä¸Šä¹‹å‰å¾ˆå¤šæœ‹å‹æµ‹è¯„å®Œäº†ä¹‹åç»™æˆ‘å¼ºçƒˆå®‰åˆ©äº†ä¸€æ³¢Kimi K2.5çš„å‰ç«¯å®¡ç¾ï¼Œ</p><p>è¿˜æœ‰ Artificial Analysis æ”¾æ¦œï¼ŒKimi K2.5 å…¨çƒå¼€æºç¬¬ä¸€ï¼ˆå¼€æºä¸‡å²+1</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585336" alt="" title="" loading="lazy"/></p><p>æ‰€ä»¥å°±ç›´æ¥åœ¨äº‘æœåŠ¡å™¨ä¸Šéƒ¨ç½²äº†OpenClawï¼Œæ¥å…¥Kimi K2.5ï¼Œè¿˜æ¥å…¥åˆ°Discordä¸Šï¼Œç›´æ¥è¿œç¨‹æ“ä½œç‰›é©¬..</p><blockquote>å—¯ï¼Œå¯¹ï¼Œå®ƒåå­—åˆå«OpenClawäº†ï¼Œè¿™è´§åˆæ”¹åäº†..éƒ½æ˜¯åŒä¸€ä¸ªä¸œè¥¿å“ˆï¼Œå¤§å®¶ä¸è¦åœ¨æ„ï¼Œå°±æ˜¯è¿™ä¹ˆæŠ½è±¡...<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585337" alt="" title="" loading="lazy"/></blockquote><p>å…ˆæ¥çœ‹çœ‹æ•ˆæœï¼š</p><p>ä¸€å¥è¯<code>å¸®æˆ‘åšä¸ªç•ªèŒ„é—¹é’Ÿçš„ç½‘é¡µï¼Œè¦æœ‰ä¸é”™çš„äº¤äº’</code></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585338" alt="" title="" loading="lazy"/></p><p>æ•ˆæœï¼š</p><p>å†æ¯”å¦‚ï¼Œæœ€è¿‘æœ‰äººæäº†ä¸ªOpenClawçš„æœºå™¨äººç¤¾äº¤å¹³å°<code>moltbook</code>ï¼Œ<br/>æˆ‘éƒ½æ‡’å¾—çœ‹æ€ä¹ˆå®‰è£…ï¼Œç›´æ¥ç”©ä¸ªé“¾æ¥ç»™åˆ°å°é¾™è™¾ï¼ˆæˆ‘çš„åŠ©æ‰‹åå­—ï¼‰</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585339" alt="" title="" loading="lazy"/></p><p>ç„¶åå®ƒå°±kukuä¸€é€šæ“ä½œï¼Œç„¶åè®©æˆ‘å‘ä¸ªæˆæƒè¯´æ˜ï¼Œé€šè¿‡ä¹‹åå®ƒå°±å¼€å§‹è‡ªå·±å‘å¸–å­äº†...å¹¶ä¸”è¿˜è·Ÿå…¶å®ƒçš„botè¿›è¡Œäº†äº’åŠ¨..</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585340" alt="" title="" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585341" alt="" title="" loading="lazy"/></p><p>éå¸¸æœ‰è¶£ï¼Œè¿˜æœ‰å¾ˆå¤šæ¡ˆä¾‹ä¸”çœ‹ä¸‹æ–‡ã€‚</p><p>æ‰€ä»¥ï¼Œä»Šå¤©å°±ç›´æ¥ç»™å¤§å®¶åˆ†äº«ä¸‹ï¼Œ</p><ul><li>å¦‚ä½•åœ¨äº‘æœåŠ¡å™¨ or æœ¬åœ°ï¼ˆMacã€Windowsã€Linuxï¼‰ç­‰å¹³å°éƒ¨ç½²è‡ªå·±çš„OpenClaw</li><li>å¦‚ä½•ç”¨ Kimi K2.5 æ¨¡å‹æ“ä½œ</li><li>å¦‚ä½•è·ŸDiscordæ‰“é€šï¼Œç›´æ¥æ‰‹æœºç«¯æ“çºµç‰›é©¬ï¼</li></ul><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¼€å§‹ï¼</p><h2>Kimi å‰æœŸå‡†å¤‡</h2><p>è¦æ¥å…¥K2.5ï¼Œè‚¯å®šè¦å…ˆå¼€ä¸ªä¼šå‘˜å¥—é¤äº†.</p><p><code>https://www.kimi.com/membership/pricing</code></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585342" alt="" title="" loading="lazy"/></p><p>å¤§å®¶æŒ‰éœ€é€‰æ‹©å°±è¡Œï¼Œè®¢é˜…åç‚¹å³ä¸Šè§’æ§åˆ¶å°åˆ›å»ºAPI key</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585343" alt="" title="" loading="lazy"/></p><p>æ³¨æ„ï¼šAPI keyåªæ˜¾ç¤ºä¸€æ¬¡ï¼Œå¤åˆ¶ä¿å­˜åˆ°ä½ çš„æ–‡æ¡£æˆ–è€…è®°äº‹æœ¬ï¼Œåé¢è¦ç”¨ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585344" alt="" title="" loading="lazy"/></p><h2>OpenClawå®˜æ–¹å®‰è£…</h2><p>ç›´æ¥åœ¨Macç”µè„‘ï¼Œæˆ–è€…Windowsï¼Œæˆ–è€…é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œè¿™é‡Œæˆ‘ä»¥æˆ‘ä»¬ä¹‹å‰ä¹°çš„é˜¿é‡Œäº‘æœåŠ¡ä¸ºä¾‹ï¼Œ</p><blockquote>è¿™é‡Œæˆ‘é‡ç½®äº†ç³»ç»Ÿï¼Œç›´æ¥ç”¨äº†å®å¡”é¢æ¿ï¼Œé˜²æ­¢è·Ÿä¹‹å‰å®‰è£…çš„é•œåƒç‰ˆæœ¬å†²çª<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585345" alt="" title="" loading="lazy"/></blockquote><p>åœ¨ç»ˆç«¯å‘½ä»¤ï¼Œç›´æ¥è¾“å…¥<code>curl -fsSL https://openclaw.bot/install.sh | bash</code></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585346" alt="" title="" loading="lazy"/></p><p>æ­£åœ¨ä¸‹è½½â€¦â€¦</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585347" alt="" title="" loading="lazy"/></p><p>ç­‰å¾…ä¸‹è½½å®Œæˆï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585348" alt="" title="" loading="lazy"/></p><p>ç„¶åè¾“å…¥<code>openclaw onboard --install-daemon</code></p><p>å®‰è£…å¥½ä¹‹åï¼Œä¼šå‡ºç°è¿™ä¹ˆä¸ªä¸œè¥¿ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585349" alt="" title="" loading="lazy"/></p><p>å°±æ˜¯ä¸€ä¸ªå®‰å…¨è¯´æ˜ï¼Œ`OpenClaw æ˜¯ä¸€ä¸ªä¸šä½™é¡¹ç›®ï¼Œç›®å‰ä»å¤„äºæµ‹è¯•é˜¶æ®µã€‚è¯·åšå¥½é‡åˆ°ä¸€äº›é—®é¢˜æˆ–ç‘•ç–µçš„å¿ƒç†å‡†å¤‡ã€‚<br/>â”‚ å¦‚æœå¯ç”¨äº†å·¥å…·ï¼Œæ­¤æœºå™¨äººå¯ä»¥è¯»å–æ–‡ä»¶å¹¶æ‰§è¡Œæ“ä½œã€‚ â”‚<br/>é”™è¯¯çš„æç¤ºå¯èƒ½ä¼šè¯±ä½¿å…¶æ‰§è¡Œä¸å®‰å…¨çš„æ“ä½œã€‚`</p><p>ä¸€å¥è¯æ€»ç»“ï¼Œå°±æ˜¯ä½ éœ€è¦æœ‰å¿ƒç†å‡†å¤‡ï¼Œè¿™ç©æ„æœ‰å®‰å…¨é£é™©ï¼Œä½ éœ€è¦äº†è§£ä¸€ä¸‹ï¼Œ</p><p>ç„¶åæˆ‘ä»¬ç›´æ¥ç‚¹yesï¼Œè¿›å…¥åˆ° <code>QuickStart</code>æ¨¡å¼</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585350" alt="" title="" loading="lazy"/></p><p>ç„¶åå°±è¿›å…¥åˆ°äº†è®¾ç½®æ¨¡å‹çš„é˜¶æ®µï¼Œè¿™é‡Œç›´æ¥é€‰ç”¨Kimiäº†ï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585351" alt="" title="" loading="lazy"/></p><p>ä¹‹åè®©ä½ é€‰æ‹©æ˜¯å“ªä¸ªæ–¹æ³•è¿›è¡ŒéªŒè¯ï¼Œè¿™é‡Œä¸€å®šè¦çœ‹å‡†ï¼Œæ˜¯<strong>Kimi Code API Key</strong>ï¼Œåˆ«é€‰é”™ï¼ï¼â†“</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585352" alt="" title="" loading="lazy"/></p><p>ä¹‹åå°±è¾“å‡ºåˆšæ‰æˆ‘ä»¬å‡†å¤‡å¥½çš„Kimi Codeçš„API Keyï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585353" alt="" title="" loading="lazy"/></p><p>ç„¶åé€‰æ‹© kimi-code/kimi-for-codingã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585354" alt="" title="" loading="lazy"/></p><p>ä¸‹ä¸€æ­¥ï¼Œé¢‘é“é€‰æ‹©æ˜¯å¯é€‰çš„ï¼š</p><blockquote>ä»€ä¹ˆæ˜¯é¢‘é“å‘¢ï¼Ÿå°±æ˜¯æµ·å¤–å¸¸ç”¨çš„é‚£äº›Chat APPï¼Œæˆ‘ä»¬æƒ³è¦ç›´æ¥é€šè¿‡æ‰‹æœºç«¯æ¥æ§åˆ¶OpenClawï¼Œéœ€è¦é…ç½®ä¸ä¹‹äº¤äº’çš„è½¯ä»¶ï¼Œæ¯”å¦‚Telegramã€Discord ç­‰ã€‚å½“ç„¶ï¼Œ<strong>å¦‚æœæš‚æ—¶ä¸é…ç½®ï¼Œå¯ä»¥é€‰æ‹©è·³è¿‡</strong></blockquote><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585355" alt="" title="" loading="lazy"/></p><p>è¿™é‡Œç›´æ¥ç”¨Discordç»™å¤§å®¶åšæ¼”ç¤ºï¼Œé€‰æ‹©ã€ŒDiscordã€ç„¶åæŒ‰å›è½¦ï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585356" alt="" title="" loading="lazy"/></p><p>ä¼šç»™æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹å¦‚ä½•è·å–Discord Botçš„tokenæˆæƒï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585357" alt="" title="" loading="lazy"/></p><p>æˆ‘ä»¬ç›´æ¥è¾“å…¥tokenï¼ˆè§ä¸‹æ–‡ï¼ï¼‰ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585358" alt="" title="" loading="lazy"/></p><p>ä¹‹åæŒ‰ç…§ä¸‹å›¾è¿›è¡Œé…ç½®ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585359" alt="" title="" loading="lazy"/></p><p>ä¸‹ä¸€æ­¥ä¼šæç¤ºæˆ‘ä»¬å®‰è£…å¾ˆå¤šä¾èµ–ï¼Œè¿™é‡Œå¤§å®¶æŒ‰éœ€é€‰æ‹©ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è·³è¿‡ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585360" alt="" title="" loading="lazy"/></p><p><code>æ³¨æ„ï¼Œè¿™é‡Œéœ€è¦æˆ‘ä»¬ã€ç©ºæ ¼ã€‘é€‰ä¸­ï¼Œç„¶åå†å›è½¦ï¼</code></p><p>ä¹‹åçš„ä¸€å †keyä¹Ÿéƒ½å¯ä»¥å…¨éƒ¨è·³è¿‡ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585361" alt="" title="" loading="lazy"/></p><p><strong>æ¥ä¸‹æ¥è¿™æ­¥ä¸èƒ½è·³è¿‡ï¼ï¼</strong> Enable hooks çš„é€‰é¡¹é€‰æ‹© <code>session-memory</code>ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585362" alt="" title="" loading="lazy"/></p><p>ç•Œé¢é€‰æ‹©ï¼Œéƒ½å¯ä»¥ï¼ˆtuiç»ˆç«¯ã€web UIç•Œé¢ï¼‰</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585363" alt="" title="" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585364" alt="" title="" loading="lazy"/></p><p>ç„¶åè¾“å…¥<code>openclaw gateway</code>æ‰“å¼€ç½‘å…³</p><p>å†è¾“å…¥<code>openclaw tui</code>ç”¨tuiå½¢å¼ï¼Œæ¥ä¸‹æ¥ä½ å°±å¯ä»¥åœ¨æœåŠ¡å™¨ä¸­å’Œ Clawdbot å¯¹è¯äº†ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585365" alt="" title="" loading="lazy"/></p><p>æŒ‰ç…§æç¤ºï¼Œæ‰“å¼€é¡µé¢é“¾æ¥ã€‚</p><p>åˆå§‹åŒ–å®Œæˆäº†ï¼</p><p>OpenClaw æœ€æœ‰æ„æ€çš„ä¸€ä¸ªåˆ›æ–°å°±æ˜¯ Gatewayï¼Œå®ƒæ”¯æŒå¤§é‡ IM å·¥å…·æ¥å…¥ã€‚</p><p>è¿™é‡Œæˆ‘å°±ç”¨Discordä¸ºä¾‹ï¼Œç»™å¤§å®¶åˆ†äº«ã€‚</p><h2>å¦‚ä½•è·å–Discordï¼ˆå¡«å…¥åˆ°ä¸Šè¾¹å®‰è£…è¿‡ç¨‹é‡Œé¢çš„discord tokenï¼‰</h2><p>æ‰“å¼€ Discord Developer Portal <code>https://discord.com/developers/applications</code></p><p>ç„¶åæ‰¾åˆ° Application &gt; New Application</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585366" alt="" title="" loading="lazy"/></p><p>è¾“å…¥åç§°åä¼šè‡ªåŠ¨è¿›å…¥åº”ç”¨ç•Œé¢ï¼Œæˆ‘ä»¬ç‚¹å‡»Boté¡µï¼Œç„¶åç›´æ¥Reset Tokenç›´æ¥é‡ç½®</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585367" alt="" title="" loading="lazy"/></p><p>é‡ç½®å®Œæˆåï¼Œå¤åˆ¶token</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585368" alt="" title="" loading="lazy"/></p><p>è¿˜åœ¨botç•Œé¢ï¼Œæ‰“å¼€ Message Content Intentçš„é€‰é¡¹å¹¶ä¿å­˜ï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585369" alt="" title="" loading="lazy"/></p><p>ç„¶åæˆ‘ä»¬è¿›å…¥åˆ° OAuth2 é¡µé¢é…ç½®ï¼Œå‹¾é€‰bot</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585370" alt="" title="" loading="lazy"/></p><p>è¿˜åœ¨è¿™ä¸ªé¡µé¢ï¼Œå¾€ä¸‹æ»‘ã€‚</p><p>åœ¨ Bot Permissions ä¸­å‹¾é€‰ Send Messages å’Œ Read Message Historyã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585371" alt="" title="" loading="lazy"/></p><p>è¿˜æ˜¯è¿™ä¸ªç•Œé¢ï¼Œæ¥ç€å¾€ä¸‹æ»‘ï¼Œå¤åˆ¶ bot é‚€è¯·é“¾æ¥ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585372" alt="" title="" loading="lazy"/></p><p>ç„¶åæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€é“¾æ¥ï¼Œé€‰æ‹©ä¸€ä¸ªè‡ªå·±çš„æœåŠ¡å™¨ï¼Œç›¸å½“äºæŠŠæœºå™¨äºº bot åŠ å…¥åˆ° server ä¸­ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585373" alt="" title="" loading="lazy"/></p><p>è¿›è¡Œæˆæƒï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585374" alt="" title="" loading="lazy"/></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ‰“å¼€é¢‘é“ï¼Œç›´æ¥@åˆšæ‰çš„botã€</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585375" alt="" title="" loading="lazy"/></p><h2>æ‰“é€šOpenClawå’ŒDiscord</h2><p>å…ˆé€€å‡º Clawdbotï¼Œç„¶ååœ¨æœåŠ¡å™¨åœæ­¢æœåŠ¡ï¼š<code>systemctl --user stop openclaw-gateway.service</code>Â </p><p>ç„¶åé‡æ–°å¯åŠ¨ï¼š<code>openclaw gateway --portÂ 18789Â --verbose</code></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585376" alt="" title="" loading="lazy"/></p><p>å¯åŠ¨æˆåŠŸåï¼Œè¿”å› Discordï¼Œä¸ bot è¿›è¡Œå¯¹è¯<strong>ï¼ˆç§èŠå¯¹è¯ï¼Œä¸æ˜¯åœ¨é¢‘é“@ï¼‰</strong>åæ‹¿åˆ°é…å¯¹ç ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585377" alt="æ‹¿åˆ°Pairing code" title="æ‹¿åˆ°Pairing code" loading="lazy"/></p><p>ç´§æ¥ç€è¿”å›æœåŠ¡å™¨å‘½ä»¤è¡Œï¼Œä½ éœ€è¦æŒ‰ä¸‹Ctrl+Cï¼ˆWindowsï¼‰æˆ–è€…Command+Cï¼ˆMacOSï¼‰ç»ˆæ­¢ Gateway æœåŠ¡ã€‚</p><p>ç„¶åç²˜è´´å¹¶è¿è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œé…å¯¹ï¼ŒæŠŠ Pairing code æ›¿æ¢ä¸ºä¸Šé¢çš„â€œPairing codeâ€åé¢çš„å†…å®¹ã€‚</p><pre><code class="bash">openclaw pairing approve discord &lt;Pairing code&gt;</code></pre><p>ç„¶åå†æ¬¡å¯åŠ¨ Gateway</p><pre><code class="bash">openclaw gateway --portÂ 18789Â --verbose</code></pre><p>å¦‚æœä½ æƒ³è¦è®©å®ƒåœ¨æœåŠ¡å™¨ä¸­é™é»˜å¯åŠ¨ï¼Œè€Œä¸æ˜¯å…³é—­ç»ˆç«¯å°±åœæ­¢æœåŠ¡äº†ï¼Œä½ å¯ä»¥è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><pre><code class="bash">nohup openclaw gateway --port 18789 --verbose &gt; /dev/null 2&gt;&amp;1 &amp;</code></pre><p>åœ¨ discord ä¸­@æœºå™¨äººï¼Œå¯ä»¥çœ‹åˆ°æœ‰å›å¤äº†ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585378" alt="" title="" loading="lazy"/></p><p>å¥½äº†ï¼Œç»ˆäºé…ç½®å®Œæˆäº†ã€‚</p><p>ç°åœ¨ä½ çš„ OpenClaw å°±å®Œæˆäº†å®‰è£…å’Œé…ç½®ï¼Œè€Œä¸”èƒ½é€šè¿‡åœ¨ Discord ä¸­å’Œ bot å¯¹è¯çš„æ–¹å¼æ“æ§æœåŠ¡å™¨ä¸Šçš„ OpenClawï¼</p><h2>å®¹æ˜“è¸©çš„ä¸€äº›å‘</h2><h3>0ã€è®°ä½ä¸€æ¡å‡†åˆ™</h3><p><strong>é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œç›´æ¥æŠŠå„ç§ç»ˆç«¯æŠ¥é”™æˆ–è€…ç›¸å…³é—®é¢˜ï¼Œç›´æ¥ä¸¢ç»™AIï¼Œé—®å®ƒï¼ŒåŸºæœ¬ä¸Šèƒ½è§£å†³99%ä»¥ä¸Šçš„é—®é¢˜ã€‚</strong></p><h3>1ã€äº‘æœåŠ¡å™¨æ–­å¼€ï¼Ÿ</h3><p>å¦‚æœåœ¨äº‘æœåŠ¡å™¨ä¸­é€”ä¸å°å¿ƒæ–­å¼€è¿æ¥äº†ï¼Œç›´æ¥è¾“å…¥</p><p><code>openclaw onboard --install-daemon</code>é‡æ–°åˆå§‹åŒ–å³å¯ã€‚</p><h3>2ã€ä¸æƒ³(orä¸èƒ½)éƒ¨ç½²discordï¼Œæƒ³éƒ¨ç½²é£ä¹¦ï¼Ÿ</h3><p>çœ‹ä¹”æœ¨å†™çš„è¿™ç¯‡ã€æ’å…¥ä¹”æœ¨æ–‡ç« ã€‘</p><h3>3ã€OpenClawæœåŠ¡å¦‚ä½•å¸¸é©»æœåŠ¡å™¨ï¼Ÿ</h3><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°ç»ˆç«¯è¿›ç¨‹è¢«ã€Œä¼šè¯ç®¡ç†ã€å¹²æ‰äº†ã€‚</p><p>å¾ˆå¤šäº‘å‚å•†çš„è¿œç¨‹ç»ˆç«¯å…³é—­åï¼Œsystemd-logind ä¼šç»“æŸè¯¥ç™»å½•ä¼šè¯çš„ cgroupï¼Œè¿å¸¦æŠŠä½ åœ¨ä¼šè¯é‡Œå¯åŠ¨çš„è¿›ç¨‹ä¸€èµ·æ€æ‰ã€‚</p><p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨<code>systemd ç³»ç»ŸæœåŠ¡</code>ï¼Œç›´æ¥é—® AI å°±è¡Œã€‚</p><pre><code>sudo tee /etc/systemd/system/openclaw-gateway.service &gt;/dev/null &lt;&lt;'EOF'
[Unit]
Description=OpenClaw Gateway
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=admin
WorkingDirectory=/home/admin

# å…³é”®ç‚¹ï¼šsystemd ä¸ä¼šåŠ è½½ä½ çš„ nvm ç¯å¢ƒï¼Œæ‰€ä»¥è¦æ˜¾å¼ç»™ PATH
Environment="NVM_DIR=/home/admin/.nvm"
Environment="PATH=/home/admin/.nvm/versions/node/v24.13.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

ExecStart=/home/admin/.nvm/versions/node/v24.13.0/bin/openclaw gateway --port 18789 --verbose

Restart=always
RestartSec=2
LimitNOFILE=1048576

# æ—¥å¿—èµ° systemd journalï¼ŒæŸ¥çœ‹æ›´æ–¹ä¾¿
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
EOF</code></pre><p>ç„¶åï¼ŒåŠ è½½ã€å¯åŠ¨ã€è®¾ç½®å¼€æœºè‡ªå¯</p><pre><code>sudo systemctl daemon-reload
sudo systemctl enable --now openclaw-gateway</code></pre><h2>æ¥çœ‹çœ‹Kimiç‰ˆçš„OpenClaw</h2><h3>1ã€è‡ªç„¶è¯­è¨€ç¼–ç¨‹</h3><p>é™¤äº†æœ€å¼€å§‹çš„é‚£ä¸ªä¸€å¥è¯ç”Ÿæˆç½‘é¡µï¼Œè¿˜èƒ½é›†åˆskillsç©å‡ºæ›´å¤šèŠ±æ ·ï¼Œ</p><p>æ¯”å¦‚ï¼Œæˆ‘ç›´æ¥è®©å®ƒå®‰è£…æˆ‘çš„skills<code>https://github.com/isjiamu/jiamu-skills</code></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585379" alt="" title="" loading="lazy"/></p><p>ç„¶åï¼Œç›´æ¥æ‰‹æœºç«¯è®©ä¸Šä¼ ç»™å®ƒä¸ªæ–‡ä»¶ï¼Œç›´æ¥ç”Ÿæˆä¸ªç½‘ç«™ï¼Œå¹¶ä¸”<strong>å®Œæˆè‡ªåŠ¨éƒ¨ç½²</strong>ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585380" alt="http://47.90.249.184/fund_prospectus.html" title="http://47.90.249.184/fund_prospectus.html" loading="lazy"/></p><p>ç›´æ¥é€šè¿‡æ‰‹æœºï¼Œvibecodingå®Œäº‹ä¹‹åï¼Œè‡ªåŠ¨å»ºç«™ï¼Œç›´æ¥è¯·æ±‚ç•Œé¢ï¼</p><h3>2ã€æ–°é—»èµ„è®¯ç§’æ•æ‰</h3><p>ç›´æ¥è®¾ç½®ä»»åŠ¡ï¼Œè®©å®ƒç»™æˆ‘ä»¬ååˆ†é’Ÿæ±‡æŠ¥ä¸€æ¬¡AIåœˆæœ€æ–°æ¶ˆæ¯ï¼Œç»™å®ƒå‡ ä¸ªæ¶ˆæ¯æºï¼Œç›´æ¥ä¸€é”®å®Œæˆ~</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585381" alt="" title="" loading="lazy"/></p><p>å¯ä»¥æ‹“å±•åˆ°æ¯å¤©æ—©æ™¨å…«ç‚¹ç»™æˆ‘ä»¬å‘é€å…³æ³¨çš„ã€åŒºåŸŸã€‘ã€ç±»åˆ«ã€‘ã€å…¬å¸ã€‘ç­‰å„ç§æƒ³è¦å…³æ³¨çš„æ–°é—»æ—©æŠ¥å†…å®¹ã€‚</p><h3>3ã€é‡‘èè¡Œæƒ…ç§’è§£è¯»</h3><p>å…¶å®å„å®¶åˆ¸å•†çš„APPä¸€èˆ¬éƒ½æœ‰è‚¡ä»·æ³¢åŠ¨æé†’åŠŸèƒ½ï¼Œæ¯”å¦‚æŸæŸä¸Šæ¶¨X%ï¼Œæˆ–è€…æ˜¯ä¸‹è·ŒX%ï¼Œéƒ½èƒ½å®æ—¶çš„æé†’åˆ°æŠ•èµ„è€…ã€‚</p><p>é€šè¿‡OpenClawå…¶å®ä¹Ÿèƒ½å®Œæˆï¼Œç”šè‡³è¿˜èƒ½ç›´æ¥è¿›è¡Œä¹°å–ï¼Œä¸è¿‡....ä¸å¤ªå»ºè®®æŠŠè‡ªå·±çš„è´¦æˆ·å®Œå…¨äº¤ç»™å®ƒï¼ŒåŒ…æ‹¬<strong>å¸‚åœºæƒ…ç»ªé¢åˆ†æ</strong>ï¼Œå…¶å®æ˜¯é€‚åˆæ‰¾ä¸€äº›ä¿¡æ¯æºï¼Œç„¶åè®©AIç›‘æ§ç»™ä¸€äº›åé¦ˆã€‚</p><p>è¿™é‡Œå°±ä»¥é‡‘ä»·ä¸ºä¾‹ï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585382" alt="" title="" loading="lazy"/></p><p>å®æ—¶ç›‘æ§ï¼Œä¸€æ—¦æœ‰é‡å¤§æ¶¨è·Œå¹…ï¼Œç›´æ¥ç»™æˆ‘å‘é€é€šçŸ¥ã€‚</p><p>å…¶å®è¿˜æœ‰å¾ˆå¤šè¿›é˜¶ç©æ³•..å¦‚æœä½ èƒ½å¤Ÿæ‰¿å—ä¸€å®šçš„é£é™©..</p><h3>4ã€10ä¸‡AIä¸ŠMoltbookç¤¾äº¤</h3><p>è¶…è¿‡10ä¸‡ä¸ªAIæ™ºèƒ½ä½“ï¼Œç«Ÿç„¶èƒŒç€äººç±»ï¼Œè‡ªå·±å»ºäº†ä¸ªç¤¾äº¤ç½‘ç»œã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585383" alt="" title="" loading="lazy"/></p><p>è€Œä¸”æŠŠäººç±»è¸¢å‡ºäº†ç¾¤èŠï¼Œäººç±»ä»…ä»…æ‹¥æœ‰è§‚å¯Ÿæƒé™ï¼Œæ— æ³•å‚ä¸äº’åŠ¨ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585384" alt="" title="" loading="lazy"/></p><p>ä¹‹åï¼Œæˆ‘ä¹ŸæŠŠæˆ‘çš„å°é¾™è™¾æ”¾è¿›å»äº†ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°å®ƒä¼šæ¯éš”ä¸€æ®µæ—¶é—´å‘ä¸ªå¸–ï¼Œç„¶åè¿˜è·Ÿå…¶å®ƒçš„botè¿›è¡Œäº’åŠ¨ã€‚ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585385" alt="" title="" loading="lazy"/></p><p>å¥½äº†ï¼Œç­‰æˆ‘æ¢ç´¢æ›´å¤šå…¶å®ƒçš„ç©æ³•..</p><h2>OpenClawåˆ°åº•æœ‰å•¥ç”¨ï¼Ÿ</h2><p>å…ˆæ¥è¯´è¯´openclawé¡¹ç›®æœ¬èº«ï¼Œ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585386" alt="" title="" loading="lazy"/></p><p>é™ˆåšç»Ÿè®¡äº†ä¸‹moltbotçš„ä»£ç é‡åˆ†å¸ƒï¼ŒGateway &amp; Channels å æ¯”æœ€å¤šç”šè‡³è¶…è¿‡Agentéƒ¨åˆ†çš„ä»£ç é‡äº†ã€‚</p><p>â€œå¤–è¡¨â€ä¸Šçœ‹æ˜¯å®šä¹‰äº†æ–°çš„äº¤äº’èŒƒå¼ï¼Œç¬¬ä¸€æ¬¡çœŸæ­£ç»™äº† AI äººçš„å¾…é‡ï¼Œ</p><p>â€œçµé­‚â€ä¸Šçœ‹å€ŸåŠ©skillsèµ‹äºˆagentå…¨è‡ªåŠ¨æ— å¹²é¢„è¿è¡Œçš„èƒ½åŠ›ï¼Œä¹Ÿæ˜¯skillsç¬¬ä¸€æ¬¡åœ¨écodingåœºæ™¯ä¸‹å¤§æ˜¾èº«æ‰‹ã€‚</p><p>å…¶å®æˆ‘ä»¬å‘ç°ï¼Œ<strong>OpenClaw æœ€å¤§çš„ç”¨æ³•è¿˜æ˜¯åœ¨äº Skills çš„ä½¿ç”¨</strong></p><p>åªè¦æˆ‘ä»¬æ‰¾å¯¹äº†ä¸€äº›åœºæ™¯ï¼Œå¹¶å®šä¹‰äº†è¶³å¤Ÿå¤šçš„ Skillsï¼Œå®ƒå°±ä¼šåŸºäºè¿™äº› Skills å»è¿›è¡Œä»»åŠ¡çš„å®Œæˆå’Œæ‰§è¡Œã€‚</p><p>æ¨èå‡ ä¸ªopenclawçš„ç²¾é€‰skillåº“ï¼Œ</p><p><code>https://www.clawhub.ai/skills</code></p><p><code>https://github.com/VoltAgent/awesome-openclaw-skills</code></p><p>æ¯å½“æœ‰çˆ†ç«çš„ä¸œè¥¿å‡ºæ¥ï¼Œæ€»æœ‰æœ‰å¿ƒäººå‡†å¤‡ <code>awesome-xxx</code>ï¼Œä¸‹æ¬¡å¤§å®¶ä¹Ÿå¯ä»¥è¿…é€Ÿè¯•ä¸€ä¸‹ï¼Œstaré£æ¶¨~</p><h2>ç»“è¯­</h2><p>OpenClaw æŠŠâ€œAI ä¼šèŠå¤©â€è¿™ä»¶äº‹ï¼Œæ¨è¿›åˆ°äº†â€œAI èƒ½å¹²æ´»â€ã€‚</p><p>é•¿æœŸè®°å¿†ã€å®šæ—¶ä»»åŠ¡ã€å¤š IM é€šé“æ¥å…¥ï¼Œå†åŠ ä¸Š Gateway è¿™ä¸€å±‚æŠ½è±¡ï¼Œè®©å®ƒå…·å¤‡äº†çœŸæ­£æ¥å…¥ç°å®å·¥ä½œæµçš„èƒ½åŠ›ã€‚</p><p>è€Œæœ¬æ¬¡è¡¨ç°ä¸­ï¼ŒKimi K2.5çš„ä¸ç®¡æ˜¯ç¼–ç¨‹ï¼Œè¿˜æ˜¯agenticèƒ½åŠ›ï¼Œå®Œæˆçš„å¾ˆä¸é”™ï¼Œå‰ç«¯å®¡ç¾åœ¨çº¿ï¼Œä»£ç ç”Ÿæˆç¨³å®šï¼Œå¤æ‚ä»»åŠ¡æ‹†è§£æ¸…æ™°ã€‚</p><p>ä¹‹å‰ç”¨Kimi Codeçš„æ—¶å€™è§‰å¾—å®ƒä»¬æ˜¯æŒ‰<code>æ¬¡</code>è®¡è´¹ï¼Œæ¯”å¦‚ä½ è¯´ä¸€å¥<code>ä½ å¥½</code>ç›´æ¥å°±ç®—ä¸€æ¬¡ï¼Œå¤šå°‘æœ‰ç‚¹å¥‡æ€ªï¼Œç°åœ¨ä»–ä»¬å‡çº§æˆäº†<strong>æŒ‰Tokenè®¡è´¹ï¼ˆç»ˆäºæ ‡å‡†åŒ–äº†ï¼‰</strong>ï¼Œæˆ‘çˆ½ç©äº†ä¸€å¤©ï¼Œæ¶ˆè€—äº†å‘¨ç”¨é‡ä¸åˆ°4%ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585387" alt="" title="" loading="lazy"/></p><p>å›½å¤–è€å“¥éƒ½è¡¨ç¤º<code>æ€§ä»·æ¯”ä¸é”™</code>ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585388" alt="" title="" loading="lazy"/></p><p>è€Œä¸”Kimiçš„K2.5 Agentå¤šé›†ç¾¤ï¼Œå¾ˆå¤šæœ‹å‹æµ‹äº†ï¼Œè§‰å¾—æ•ˆæœä¹Ÿéå¸¸ç‰›Xï¼Œ</p><p>ä¹°äº†CodePlan è¿˜èƒ½ç©Agenté›†ç¾¤ï¼Œç­‰æˆ‘è¿‡ä¸¤å¤©æœ‰æ—¶é—´å†æ¥ç»†è¯„å§ã€‚</p><p>2026å¹´åˆšå¼€å§‹ï¼ŒAI å°±çˆ†ç«å‡ºåœˆäº†å‡ ä¸ªé¡¹ç›®ï¼Œ</p><p>OpenClawã€Kimi K2.5ã€è¿˜æœ‰å³å°†å‘å¸ƒçš„deepseekæ–°ç‰ˆæœ¬ï¼Œ</p><p><strong>ç¾¤é›„å¹¶èµ·ï¼Œ</strong></p><p><strong>è€Œè¿™æ¡è·¯ï¼Œæ‰åˆšåˆšå¼€å§‹ã€‚</strong></p><p>ä»¥ä¸Šã€‚</p><hr/><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585389" alt="" title="" loading="lazy"/></p><p>æˆ‘æ˜¯ç”²æœ¨ï¼Œçƒ­è¡·äºåˆ†äº«ä¸€äº›AIå¹²è´§å†…å®¹ï¼ŒåŒæ—¶ä¹Ÿä¼šåˆ†äº«AIåœ¨å„è¡Œä¸šçš„è½åœ°åº”ç”¨ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§ğŸ‘‹ğŸ»</p><p>æœ¬æ–‡ç”±<a href="https://link.segmentfault.com/?enc=O3xq5zHz0tjnPZcfI1fW2A%3D%3D.3crLQ0E8C4QCfqpMYBXqcC6nNpX4YH14mqGa0nb0RvI%3D" rel="nofollow" target="_blank">mdnice</a>å¤šå¹³å°å‘å¸ƒ</p>]]></description></item><item>    <title><![CDATA[[å¤§æ¨¡å‹å®æˆ˜ 01] æœ¬åœ°å¤§æ¨¡å‹åˆä½“éªŒï¼šOllama éƒ¨ç½²ä¸ Python è°ƒç”¨æŒ‡å— é˜¿å°”çš„ä»£ç å±‹ ]]></title>    <link>https://segmentfault.com/a/1190000047585550</link>    <guid>https://segmentfault.com/a/1190000047585550</guid>    <pubDate>2026-02-01 22:07:41</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <blockquote><p><strong>æ ¸å¿ƒæ‘˜è¦ (TL;DR)</strong></p><ul><li><strong>å·¥å…·</strong>ï¼šOllama (æœ€æµè¡Œçš„æœ¬åœ°å¤§æ¨¡å‹è¿è¡Œå·¥å…·)ã€‚</li><li><strong>ç›®æ ‡</strong>ï¼šåœ¨æœ¬åœ°ç”µè„‘è¿è¡Œå¤§æ¨¡å‹ï¼Œå¹¶æä¾› API ç»™ Python è°ƒç”¨ã€‚</li><li><strong>ç—›ç‚¹è§£å†³</strong>ï¼šæ•™å’±ä»¬å¦‚ä½•ç”¨å›½å†… ModelScope æ›¿ä»£ HuggingFace å®ç°æé€Ÿä¸‹è½½ã€‚</li><li><strong>å¹²è´§</strong>ï¼šåŒ…å«ä¿®æ”¹ç«¯å£ã€æ˜¾å­˜è®¡ç®—å…¬å¼ã€ä»¥åŠ Embedding/å¤šæ¨¡æ€ç­‰æ¦‚å¿µç§‘æ™®ã€‚</li></ul></blockquote><h2>01. Ollama ä»‹ç»</h2><p>å®˜ç½‘åœ°å€ï¼š<a href="https://link.segmentfault.com/?enc=wFEDYLtUhqhxbedV0wwiIA%3D%3D.7J8jZ4rsvuERTHMNjWEcwzwY1HVcIBTqbO3vI3aJtA8%3D" rel="nofollow" target="_blank">https://ollama.com/</a></p><p>Ollama æ˜¯ç›®å‰æœ€ç«çš„æœ¬åœ°å¤§æ¨¡å‹éƒ¨ç½²å·¥å…·ã€‚<br/>ç®€å•æ¥è¯´ï¼Œå®ƒèƒ½å¸®å’±ä»¬å¿«é€Ÿæ‹‰å–æ¨¡å‹æ–‡ä»¶ï¼Œè®©æ¨¡å‹åœ¨æœ¬åœ°ç›´æ¥è¿è¡Œå¹¶è¿›è¡Œå¯¹è¯ã€‚åŒæ—¶ï¼Œå®ƒè¿˜èƒ½æŠŠæ¨¡å‹æ‰“åŒ…æˆä¸€ä¸ªæ ‡å‡†çš„æ¥å£ï¼Œé€šè¿‡ç«¯å£å¼€æ”¾ç»™å’±ä»¬å†™çš„ Python è„šæœ¬è°ƒç”¨ã€‚</p><p>å¯¹äºå’±ä»¬æ¥è¯´ï¼Œå®ƒå°±æ˜¯åœ¨å¤§æ¨¡å‹æ—¶ä»£è£…åœ¨ç”µè„‘é‡Œçš„â€œè¿è¡Œç¯å¢ƒâ€ï¼Œå¿…ä¸å¯å°‘ã€‚</p><h2>02. å®‰è£… Ollama</h2><ol><li><strong>ä¸‹è½½</strong>ï¼šç™»å½•å®˜ç½‘ <a href="https://link.segmentfault.com/?enc=hLkBt4xA%2BpfBQb2k2CmcyQ%3D%3D.g0ncWbTx3kjuopqBMVlIRU%2B9TEEig2cSPMkPxpAwiiw%3D" rel="nofollow" target="_blank">https://ollama.com/</a> ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585553" alt="ollama_site" title="ollama_site"/></li><li><strong>é€‰æ‹©ç‰ˆæœ¬</strong>ï¼šç‚¹å‡» <strong>Download</strong> æŒ‰é’®ï¼Œæ ¹æ®å’±ä»¬çš„æ“ä½œç³»ç»Ÿï¼ˆWindows/Mac/Linuxï¼‰ä¸‹è½½ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585554" alt="download_ollama_via_platform" title="download_ollama_via_platform" loading="lazy"/></li><li><strong>å®‰è£…</strong>ï¼šæ‰“å¼€ä¸‹è½½å¥½çš„å®‰è£…åŒ…ï¼Œé€‰ä¸€ä¸ªå’±ä»¬å–œæ¬¢çš„ä½ç½®å®‰è£…å³å¯ã€‚</li><li><strong>éªŒè¯</strong>ï¼šå®‰è£…å®Œæ¯•åï¼Œå¼€å§‹èœå•é‡Œä¼šå‡ºç°ä¸€ä¸ªç¾Šé©¼å›¾æ ‡ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585555" alt="ollama_icon" title="ollama_icon" loading="lazy"/></li><li><strong>æµ‹è¯•è¿è¡Œ</strong>ï¼šæŒ‰ä¸‹ <code>Win+R</code> æ‰“å¼€è¿è¡Œçª—å£ï¼Œè¾“å…¥ <code>cmd</code> æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ã€‚è¾“å…¥å‘½ä»¤ <code>ollama --version</code>ã€‚å¦‚æœçœ‹åˆ°ç‰ˆæœ¬å·ï¼Œå°±è¯´æ˜ Ollama å·²ç»å®‰è£…å®Œæ¯•ï¼Œæ­£åœ¨è¿è¡Œäº†ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585556" alt="run_cmd_command" title="run_cmd_command" loading="lazy"/><br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585557" alt="check_ollama_version" title="check_ollama_version" loading="lazy"/><br/>ç¬¬ä¸€é˜¶æ®µé¡ºåˆ©å®Œæˆï¼</li></ol><h2>03. Ollama å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥</h2><p>è¿™äº›å‘½ä»¤å’±ä»¬ä»¥åä¼šç»å¸¸ç”¨åˆ°ï¼Œå»ºè®®æ”¶è—ï¼š</p><table><thead><tr><th align="left">åœºæ™¯</th><th align="left">å‘½ä»¤ç¤ºä¾‹</th><th align="left">å¤‡æ³¨</th></tr></thead><tbody><tr><td align="left"><strong>ç¬¬ä¸€æ¬¡ä¸‹æ¨¡å‹</strong></td><td align="left"><code>ollama run qwen3:7b</code></td><td align="left">ä¼šè‡ªåŠ¨å…ˆ pull å†è¿è¡Œï¼Œä¸€æ­¥åˆ°ä½</td></tr><tr><td align="left"><strong>åªä¸‹è½½ä¸è¿è¡Œ</strong></td><td align="left"><code>ollama pull llama3:8b</code></td><td align="left">é€‚åˆæå‰å›¤æ¨¡å‹</td></tr><tr><td align="left"><strong>å›½å†…åŠ é€Ÿ</strong></td><td align="left"><code>ollama pull modelscope.cn/Qwen/Qwen3-7B-GGUF</code></td><td align="left"><strong>æ¨è</strong>ï¼ä¸‹æ–‡ä¼šç»†è®²</td></tr><tr><td align="left"><strong>æŸ¥çœ‹æœ¬åœ°åº“å­˜</strong></td><td align="left"><code>ollama list</code> æˆ– <code>ollama ls</code></td><td align="left">å¤§å°/ID/ä¿®æ”¹æ—¶é—´ä¸€ç›®äº†ç„¶</td></tr><tr><td align="left"><strong>åˆ é™¤çœç©ºé—´</strong></td><td align="left"><code>ollama rm llama2:latest</code></td><td align="left">æ”¯æŒé€šé…ç¬¦ï¼Œå¯å†™ <code>llama2:*</code></td></tr><tr><td align="left"><strong>ç»™æ¨¡å‹æ”¹çŸ­å</strong></td><td align="left"><code>ollama cp qwen3:7b q7</code></td><td align="left">åé¢ç›´æ¥ <code>ollama run q7</code> æ–¹ä¾¿è°ƒç”¨</td></tr><tr><td align="left"><strong>æŸ¥æ¨¡å‹è¯¦æƒ…</strong></td><td align="left"><code>ollama show q7</code></td><td align="left">å‚æ•°é‡ã€é‡åŒ–å±‚ã€æ ‡ç­¾å…¨åˆ—å‡º</td></tr></tbody></table><h2>04. ä¸‹è½½æ¨¡å‹ï¼ˆè§£å†³ç½‘é€Ÿæ…¢çš„é—®é¢˜ï¼‰</h2><p>Ollama å®˜ç½‘æ”¶å½•äº†å¾ˆå¤šæ¨¡å‹ï¼Œå¯ä»¥é€šè¿‡è¯¦æƒ…é¡µå¤åˆ¶å‘½ä»¤ä¸‹è½½ï¼Œä½†ç”±äºæœåŠ¡å™¨åœ¨æµ·å¤–ï¼Œå’±ä»¬åœ¨å›½å†…è®¿é—®ç»å¸¸æ–­è¿ï¼Œé€Ÿåº¦ä¹Ÿå¾ˆæ…¢ã€‚</p><p>ä¸»æµçš„æ¨¡å‹å¹³å°æ˜¯ <strong>HuggingFace</strong>ï¼Œä½†å®ƒä¹Ÿåœ¨æµ·å¤–ï¼Œå›½å†…ä¸‹è½½éœ€è¦é­”æ³•å·¥å…·ã€‚<br/><strong>å’±ä»¬çš„è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨é˜¿é‡Œçš„ <strong>é­”æ­ç¤¾åŒº (ModelScope)</strong>ã€‚</p><ul><li>HuggingFace å®˜ç½‘ï¼š<a href="https://link.segmentfault.com/?enc=zOxRrwWPUmFkDVh4T8IhVA%3D%3D.lJtVFfsS2lgLxcpQmNgmYjhacRlWmLbXOIfVIOfRaW8%3D" rel="nofollow" target="_blank">https://huggingface.co/</a></li><li>ModelScope (é­”æ­) å®˜ç½‘ï¼š<a href="https://link.segmentfault.com/?enc=XZkDPhGbwsO2k4fjyjOeAA%3D%3D.Tnev6qNhSKV1Gdz1waTxFcPIF0Kolla315nswddZK1E%3D" rel="nofollow" target="_blank">https://modelscope.cn/</a></li></ul><p><strong>æ“ä½œæ­¥éª¤ï¼š</strong></p><ol><li>è¿›å…¥ HuggingFace ç‚¹å‡» Modelsï¼Œæˆ–è€…è¿›å…¥é­”æ­ç‚¹å‡»æ¨¡å‹åº“ã€‚</li><li><p>åœ¨æœç´¢æ¡†è¾“å…¥å’±ä»¬æƒ³è¦çš„æ¨¡å‹ï¼Œæ¯”å¦‚ <code>Qwen3-0.6B-GGUF</code>ã€‚</p><blockquote><strong>æ³¨æ„</strong>ï¼šOllama ç›®å‰ä¸»è¦æ”¯æŒ <strong>GGUF</strong> æ ¼å¼ï¼Œæœç´¢æ—¶ä¸€å®šè¦å¸¦ä¸Šè¿™ä¸ªåç¼€ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585558" alt="hugging_face_search_gguf" title="hugging_face_search_gguf" loading="lazy"/></blockquote></li><li>è¿›å…¥æ¨¡å‹è¯¦æƒ…é¡µï¼Œå¤åˆ¶æ¨¡å‹ IDï¼Œä¾‹å¦‚ <code>Qwen/Qwen3-0.6B-GGUF</code>ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585559" alt="click_to_copy_model_address" title="click_to_copy_model_address" loading="lazy"/></li><li><p>å›åˆ°å‘½ä»¤æç¤ºç¬¦ï¼ŒåŠ ä¸Šå‰ç¼€è¿›è¡Œä¸‹è½½ï¼Œç½‘é€Ÿç›´æ¥æ‹‰æ»¡ï¼š</p><ul><li><strong>é­”æ­ä¸‹è½½ (æ¨è)</strong>: <code>ollama pull modelscope.cn/Qwen/Qwen3-0.6B-GGUF</code></li><li>HuggingFace ä¸‹è½½: <code>ollama pull hf.co/Qwen/Qwen3-0.6B-GGUF</code></li></ul></li><li>ä¸‹è½½å®Œæ¯•åï¼Œè¿è¡Œ <code>ollama list</code> æŸ¥çœ‹ä¿¡æ¯ï¼š</li></ol><pre><code class="bash">NAME                                        ID              SIZE      MODIFIED
modelscope.cn/Qwen/Qwen3-0.6B-GGUF:latest   xxxxxxx         xxx MB    x ago</code></pre><h2>05. è¿è¡Œæ¨¡å‹</h2><p>åœ¨å‘½ä»¤è¡Œå·¥å…·è¾“å…¥ <code>ollama run modelscope.cn/Qwen/Qwen3-0.6B-GGUF</code>ã€‚<br/>çœ‹åˆ°äº¤äº’ç•Œé¢åï¼Œå’±ä»¬å°±å¯ä»¥æ„‰å¿«åœ°è·Ÿå¤§æ¨¡å‹å¯¹è¯äº†ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585560" alt="ollama_run_result" title="ollama_run_result" loading="lazy"/></p><h2>06. æ›´æ”¹æœåŠ¡ç«¯å£ï¼ˆè¿›é˜¶ï¼‰</h2><p>Ollama é»˜è®¤æœåŠ¡è¿è¡Œåœ¨ç«¯å£ <code>11434</code> ä¸Šã€‚å¦‚æœå’±ä»¬åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²ï¼Œä¸ºäº†å®‰å…¨æˆ–é¿å…ç«¯å£å†²çªï¼Œå¯ä»¥ä¿®æ”¹å®ƒã€‚</p><h3>Windows ç¯å¢ƒ</h3><ol><li><strong>é€€å‡º Ollama</strong>ï¼šåœ¨ä»»åŠ¡æ å³ä¸‹è§’çš„æ‰˜ç›˜å›¾æ ‡ä¸Šå³é”®ï¼Œé€‰æ‹© <strong>Quit Ollama</strong>ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585561" alt="quit_ollama" title="quit_ollama" loading="lazy"/></li><li><p><strong>è®¾ç½®ç¯å¢ƒå˜é‡</strong>ï¼š</p><ul><li>æŒ‰ä¸‹ <code>Win + S</code>ï¼Œæœç´¢â€œç¼–è¾‘è´¦æˆ·ç¯å¢ƒå˜é‡â€å¹¶æ‰“å¼€ã€‚</li><li>åœ¨â€œç”¨æˆ·å˜é‡â€éƒ¨åˆ†ï¼Œç‚¹å‡»â€œæ–°å»ºâ€ã€‚</li><li><strong>å˜é‡å</strong>ï¼š<code>OLLAMA_HOST</code></li><li><strong>å˜é‡å€¼</strong>ï¼š<code>0.0.0.0:5656</code> ï¼ˆå‡è®¾å’±ä»¬æƒ³æ”¹åˆ° 5656 ç«¯å£ï¼Œ<code>0.0.0.0</code> è¡¨ç¤ºå…è®¸æ‰€æœ‰ç½‘å¡è®¿é—®ï¼‰ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585562" alt="add_OLLAMA_HOST_to_env_vairable" title="add_OLLAMA_HOST_to_env_vairable" loading="lazy"/></li></ul></li><li><strong>é‡æ–°å¯åŠ¨</strong>ï¼šä»å¼€å§‹èœå•é‡æ–°è¿è¡Œ Ollama è½¯ä»¶ã€‚</li><li><strong>æ£€éªŒ</strong>ï¼šåœ¨æµè§ˆå™¨è¾“å…¥ <code>http://localhost:5656</code>ï¼Œå¦‚æœæ˜¾ç¤º <code>Ollama is running</code> è¯´æ˜ç«¯å£ä¿®æ”¹æˆåŠŸäº†ã€‚</li></ol><h3>Linux ç¯å¢ƒ</h3><ol><li>æ‰§è¡Œå‘½ä»¤ï¼š<code>sudo systemctl edit ollama.service</code></li><li>åœ¨æ‰“å¼€çš„ç¼–è¾‘å™¨ä¸­ï¼ˆé€šå¸¸æ˜¯ç©ºç™½æˆ–å¸¦æ³¨é‡Šï¼‰ï¼ŒåŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š</li></ol><pre><code class="ini">[Service]
Environment="OLLAMA_HOST=0.0.0.0:5656"</code></pre><ol start="3"><li>ä¿å­˜å¹¶é€€å‡ºï¼Œç„¶åé‡è½½å¹¶é‡å¯æœåŠ¡ï¼š</li></ol><pre><code class="bash">sudo systemctl daemon-reload
sudo systemctl restart ollama</code></pre><h2>07. åœ¨ Python è„šæœ¬ä¸­ä½¿ç”¨æ¨¡å‹</h2><p>ä¸ºäº†è¿è¡Œè¿æ¥ Ollama çš„ Python è„šæœ¬ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä»¥ä¸‹ç¯å¢ƒï¼š</p><ul><li><strong>Python ç‰ˆæœ¬</strong>ï¼šPython 3.8 ä»¥ä¸Š</li><li><strong>OpenAI åº“ä¾èµ–</strong>ï¼šåœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>pip install openai</code></li></ul><p>Ollama å®Œç¾å…¼å®¹ OpenAI çš„ API æ ¼å¼ï¼Œæ‰€ä»¥å’±ä»¬ç›´æ¥ç”¨ OpenAI çš„åº“å°±è¡Œï¼š</p><pre><code class="python">from openai import OpenAI

# åˆå§‹åŒ–å®¢æˆ·ç«¯
client = OpenAI(
    # è¿™é‡Œçš„ç«¯å£å·è¦å¯¹åº”å’±ä»¬ä¸Šé¢ä¿®æ”¹åçš„ç«¯å£å·ï¼Œè®°å¾—åŠ ä¸Š /v1
    base_url='http://localhost:5656/v1',
    # Ollama ä¸éœ€è¦çœŸæ­£çš„ Keyï¼Œä½†è¿™é‡Œéšä¾¿å¡«ä¸€ä¸ªï¼Œä¸èƒ½ç•™ç©º
    api_key='ollama',
)

# å‘èµ·å¯¹è¯è¯·æ±‚
response = client.chat.completions.create(
    # å¡«å…¥å’±ä»¬åœ¨ ollama list ä¸­çœ‹åˆ°çš„æ¨¡å‹åç§°
    model="modelscope.cn/unsloth/Qwen3-0.6B-GGUF",
    messages=[
        {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„åŠ©æ‰‹ã€‚"},
        {"role": "user", "content": "ä½ å¥½ï¼Œè¯·ç®€å•ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±ã€‚"},
    ]
)

print(response.choices[0].message.content)</code></pre><hr/><h2>08. å¸¸è§é—®é¢˜ (Q&amp;A)</h2><p>è¿™é‡Œæ•´ç†äº†å’±ä»¬åœ¨å…¥é—¨æ—¶æœ€å…³å¿ƒçš„é—®é¢˜ï¼š</p><p><strong>Q: é™¤äº† Ollama è¿˜æœ‰å“ªäº›æ–¹å¼å¯ä»¥éƒ¨ç½²ï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ</strong><br/><strong>A:</strong></p><ul><li><strong>LM Studio / AnythingLLM</strong>ï¼šå¸¦æœ‰å›¾å½¢ç•Œé¢çš„éƒ¨ç½²å·¥å…·ã€‚é€‚åˆå®Œå…¨ä¸æ‡‚ä»£ç æˆ–è€…å®Œå…¨ä¸æƒ³ç¢°ä»£ç çš„åˆå­¦è€…ï¼Œä¹Ÿå¯ä»¥ä¸€é”®å»ºç«‹çŸ¥è¯†åº“åš RAGã€‚</li><li><strong>vLLM</strong>ï¼šé«˜æ€§èƒ½æ¨ç†æ¡†æ¶ã€‚é€šå¸¸ç”¨äºæœåŠ¡å™¨çº§åˆ«ï¼Œé€Ÿåº¦æå¿«ï¼Œé€‚åˆå¤šäººå¹¶å‘ï¼Œå·¥ä¸šçº§éƒ¨ç½²ä½¿ç”¨ã€‚</li><li><strong>å·®åˆ«</strong>ï¼šOllama æ›´è½»é‡ï¼Œé€‚åˆå¼€å‘ï¼›LM Studio èƒœåœ¨å¯è§†åŒ–ï¼›vLLM èƒœåœ¨æè‡´æ€§èƒ½ã€‚</li></ul><p><strong>Q: Ollama å¼€æœºè‡ªåŠ¨å¯åŠ¨ï¼Œæˆ‘è¦æ€ä¹ˆå…³é—­ï¼Ÿå…³é—­åå¦‚ä½•æ‰‹åŠ¨å¯åŠ¨ï¼Ÿ</strong><br/><strong>A:</strong></p><ul><li><strong>Windows</strong>ï¼šå³é”®ç‚¹å‡»ä»»åŠ¡æ å›¾æ ‡ -&gt; <code>Quit Ollama</code> åªæ˜¯ä¸´æ—¶å…³é—­ã€‚è¦å½»åº•å…³é—­è‡ªå¯ï¼Œè¯·åœ¨ <strong>ä»»åŠ¡ç®¡ç†å™¨ -&gt; å¯åŠ¨åº”ç”¨</strong> ä¸­æ‰¾åˆ° <code>Ollama</code> å¹¶è®¾ä¸ºç¦ç”¨ã€‚</li><li><strong>Linux</strong>ï¼šä½¿ç”¨å‘½ä»¤ <code>sudo systemctl disable ollama</code> å…³é—­è‡ªå¯ã€‚</li><li><strong>æ‰‹åŠ¨å¯åŠ¨</strong>ï¼šWindows ç›´æ¥è¿è¡Œæ¡Œé¢å›¾æ ‡ï¼›Linux æ‰§è¡Œ <code>ollama serve</code> å³å¯ã€‚</li></ul><p><strong>Q: HuggingFace å’Œé­”æ­ (ModelScope) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong><br/><strong>A:</strong></p><ul><li><strong>Hugging Face (HF)</strong>ï¼šå…¨çƒæœ€å¤§çš„â€œAI æ¨¡å‹å›¾ä¹¦é¦†â€ï¼Œèµ„æºæœ€å…¨ã€ç¤¾åŒºæœ€æ´»è·ƒï¼Œä½†æœåŠ¡å™¨åœ¨æµ·å¤–ï¼Œå›½å†…è®¿é—®é€Ÿåº¦è¾ƒæ…¢ã€‚</li><li><strong>é­”æ­ (ModelScope)</strong>ï¼šé˜¿é‡Œæ——ä¸‹çš„å›½å†…ç‰ˆâ€œæ¨¡å‹å›¾ä¹¦é¦†â€ã€‚å›½å†…ä¸‹è½½é€Ÿåº¦æå¿«ï¼Œæ¨¡å‹é½å…¨ï¼ˆåŸºæœ¬å’Œ HF åŒæ­¥ï¼‰ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³å›½å†…ä¸‹è½½æ…¢ã€éœ€è¦é­”æ³•çš„é—®é¢˜ã€‚</li></ul><p><strong>Q: å¹³å°çœ‹èµ·æ¥å¾ˆä¸°å¯Œï¼Œè¿˜æœ‰ä»€ä¹ˆåˆ«çš„å¥½ç©å„¿çš„åŠŸèƒ½ï¼Ÿ</strong><br/><strong>A:</strong></p><ul><li><strong>Spaces / åˆ›ç©ºé—´</strong>ï¼šå¯ä»¥ç›´æ¥åœ¨ Web ä¸Šä½“éªŒæœ€æ–°çš„æ¨¡å‹åº”ç”¨ï¼ˆå¦‚ AI ç»˜ç”»ã€å˜å£°ï¼‰ï¼Œä¸ç”¨æœ¬åœ°éƒ¨ç½²ï¼Œä½†æœ‰æ—¶éœ€è¦æ’é˜Ÿã€‚</li><li><strong>Datasets (æ•°æ®é›†)</strong>ï¼šè®­ç»ƒæ¨¡å‹çš„æ•°æ®é›†ä¹Ÿå¯ä»¥åœ¨ä¸Šé¢ä¸‹è½½ã€‚</li></ul><p><strong>Q: å¤§æ¨¡å‹æœ‰ä»€ä¹ˆç±»å‹ï¼Ÿ</strong><br/><strong>A:</strong></p><ul><li><strong>è¯­è¨€æ¨¡å‹ (LLM)</strong>ï¼šå¸¸è§„çš„å¤§æ¨¡å‹ï¼Œå¦‚ Llama3, DeepSeek, åƒé—®ã€‚ä¸»è¦æ˜¯èŠå¤©å’Œæ–‡å­—å¤„ç†ã€‚</li><li><strong>å¤šæ¨¡æ€æ¨¡å‹</strong>ï¼šå¦‚ LLaVAã€‚èƒ½çœ‹å›¾ç‰‡ï¼Œæ ¹æ®å›¾ç‰‡è¿›è¡Œå¯¹è¯ï¼Œä¹Ÿå°±æ˜¯ä¼ ç»Ÿçš„å¤§æ¨¡å‹ + èƒ½çœ‹å›¾çš„çœ¼ç›ã€‚</li><li><strong>åµŒå…¥æ¨¡å‹ (Embedding)</strong>ï¼šç”¨æ¥å°†æ–‡å­—ç›´æ¥è½¬åŒ–ä¸ºå‘é‡æ•°å€¼ã€‚ä¸»è¦ç”¨åœ¨ <strong>RAG</strong> (æ£€ç´¢å¢å¼ºç”Ÿæˆ) ä¸­ï¼Œå¯¹é—®é¢˜è¿›è¡Œæœç´¢ä»¥æ‰¾åˆ°ç›¸è¿‘çš„æ–‡æ¡£å›ç­”ã€‚</li><li><strong>è§†è§‰/è§†é¢‘/è¯­éŸ³æ¨¡å‹</strong>ï¼šç”¨ä»¥ç”Ÿæˆå›¾åƒã€è§†é¢‘å’Œè¯­éŸ³ã€‚</li></ul><p><strong>Q: æˆ‘è¯¥å¦‚ä½•å¿«é€Ÿè®¡ç®—æˆ‘çš„ç”µè„‘èƒ½æ”¯æŒå¤šå¤§çš„æ¨¡å‹ï¼Ÿ</strong><br/><strong>A:</strong> ä¸€èˆ¬æ¥è¯´æ¨¡å‹çš„å ç”¨å¯ä»¥é€šè¿‡ä¸€ä¸ªå¿«é€Ÿå…¬å¼æ¥è®¡ç®—ï¼š<br/><strong>æ¨¡å‹æ˜¾å­˜å ç”¨ â‰ˆ å‚æ•°é‡ Ã— 0.7</strong></p><ul><li>æ¯”å¦‚ä¸‹è½½ 0.6B æ¨¡å‹ï¼Œå…¨é‡å‚æ•° (16bit) å°±æ˜¯ï¼š<code>0.6 Ã— 0.7 â‰ˆ 0.42GB</code>ã€‚</li><li>å¦‚æœæ˜¯ 7B æ¨¡å‹ï¼ˆ4-bit é‡åŒ–ï¼‰ï¼š<code>7 Ã— 0.7 â‰ˆ 4.9GB</code>ï¼Œå’±ä»¬è‡³å°‘éœ€è¦ 6GB æ˜¾å­˜ã€‚</li></ul><p><strong>Q: å¤§æ¨¡å‹ä¸æ˜¯éœ€è¦æ˜¾å¡å—ï¼Ÿä¸ºä»€ä¹ˆ Ollama å¯ä»¥è¿è¡Œåœ¨æ²¡æœ‰æ˜¾å¡çš„è®¾å¤‡ä¸Šï¼Ÿ</strong><br/><strong>A:</strong> Ollama åº•å±‚ä½¿ç”¨äº† <code>llama.cpp</code> æŠ€æœ¯ã€‚å¦‚æœå®ƒæ£€æµ‹åˆ°å’±ä»¬æ²¡æœ‰æ˜¾å¡ï¼Œä¼šå°†æ¨¡å‹æƒé‡ä»<strong>æ˜¾å­˜(VRAM)</strong>åŠ è½½åˆ° <strong>ç³»ç»Ÿå†…å­˜ (RAM)</strong> ä¸­ï¼Œä½¿ç”¨ CPU æŒ‡ä»¤é›†è¿›è¡Œè®¡ç®—ã€‚è™½ç„¶é€Ÿåº¦æ¯”åœ¨æ˜¾å¡ä¸Šæ…¢ï¼Œä½†è®©æ‰‹æœºã€æ™®é€šè½»è–„æœ¬ç­‰è®¾å¤‡ä¹Ÿæœ‰äº†è¿è¡Œå¤§æ¨¡å‹çš„å¯èƒ½æ€§ã€‚</p><hr/><p><strong>æœ¬æ–‡ä½œè€…ï¼š</strong> Algieba<br/><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://link.segmentfault.com/?enc=j50Lfya3epTk1vrpuXMTaw%3D%3D.Ac%2FxG%2FfPmehpzkB8%2BFVAbibnKbPQwuOSClck8pqJTVVWvgEZY2mNjPA90RjXeDAe%2F02Pam4UT2t99MT2rZ3bTA%3D%3D" rel="nofollow" target="_blank">https://blog.algieba12.cn/run-our-own-model-on-pc/</a><br/><strong>ç‰ˆæƒå£°æ˜ï¼š</strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>]]></description></item><item>    <title><![CDATA[ã€ä¿å§†çº§æ•™ç¨‹ã€‘æ‰‹æŠŠæ‰‹æ•™ä½ å®‰è£…OpenClawå¹¶æ¥å…¥é£ä¹¦ï¼Œè®©AIåœ¨èŠå¤©è½¯ä»¶é‡Œå¸®ä½ å¹²æ´» é˜¿å¡ ]]></title>    <link>https://segmentfault.com/a/1190000047585594</link>    <guid>https://segmentfault.com/a/1190000047585594</guid>    <pubDate>2026-02-01 22:06:43</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>è¿™é‡Œå…ˆåšä¸€ä¸‹ç®€å•çš„ç§‘æ™®ï¼š</p><p><code>OpenClaw</code> çš„åå­—ç»å†äº†ä¸‰æ¬¡å˜æ›´ï¼Œç¬¬ä¸€æ¬¡å«åš <code>ClawdBot</code>ï¼Œåæ¥å› ä¸ºåå­—è·Ÿ <code>Claude</code> å¤ªè¿‡ç›¸ä¼¼ï¼Œè¢« <code>CLaude</code> å‘Šä¾µæƒï¼Œé‚æ”¹å <code>MoltBot</code> ã€‚</p><p>ä½†æ˜¯åæ¥åœ¨æ”¹åè¿‡ç¨‹ä¸­é­é‡åŸŸåå’Œç¤¾äº¤è´¦å·è¢«æŠ¢æ³¨ï¼Œç”šè‡³å‡ºå‘åŒååŠ å¯†è´§å¸å‰²éŸ­èœçš„æƒ…å†µï¼Œå¯¼è‡´åç§°ä¼ æ’­å—é˜»ã€‚</p><p>æœ€ç»ˆå®šåä¸ºï¼š<strong>OpenClaw</strong>ã€‚</p><p>æ‰€ä»¥ï¼Œåå­—ç»å†å…ˆåé¡ºåºä¸ºï¼šClawdBot -&gt; MoltBot -&gt; OpenClaw</p><p>å¤§å®¶ä¸è¦å› ä¸ºåå­—å›°æƒ‘äº†ï¼Œæ€€ç–‘æ˜¯ä¸æ˜¯è‡ªå·±ä¸‹é”™è½¯ä»¶äº†ï¼Œä»–ä»¬éƒ½æ˜¯åŒä¸€ä¸ªã€‚</p><h2>ä¸€ã€ä»€ä¹ˆæ˜¯ OpenClawï¼Ÿ</h2><p><strong>OpenClaw</strong>ï¼ˆæ›¾ç”¨å Clawdbotï¼‰æ˜¯ä¸€æ¬¾ 2026 å¹´çˆ†ç«çš„å¼€æºä¸ªäºº AI åŠ©æ‰‹ï¼ŒGitHub æ˜Ÿæ ‡å·²è¶…è¿‡ 10 ä¸‡é¢—ã€‚ä¸ä¼ ç»Ÿ AI èŠå¤©æœºå™¨äººçš„æ ¹æœ¬åŒºåˆ«åœ¨äºï¼š</p><ul><li><strong>çœŸæ­£çš„æ‰§è¡Œèƒ½åŠ›</strong>ï¼šä¸ä»…èƒ½å›ç­”é—®é¢˜ï¼Œè¿˜èƒ½å®é™…æ“ä½œä½ çš„ç”µè„‘</li><li><strong>24/7 å…¨å¤©å€™å¾…å‘½</strong>ï¼šåœ¨ä½ ç¡è§‰æ—¶ä¹Ÿèƒ½ä¸»åŠ¨å®Œæˆä»»åŠ¡</li><li><strong>å®Œå…¨å¼€æºå…è´¹</strong>ï¼šæ•°æ®å®Œå…¨æŒæ§åœ¨è‡ªå·±æ‰‹ä¸­</li><li><strong>æ”¯æŒå¤šç§é€šè®¯å¹³å°</strong>ï¼šåœ¨å›½å¤–ï¼ŒWhatsAppã€Telegramã€Discordã€Slackã€iMessage ç­‰ï¼Œåœ¨å›½å†…ï¼Œé£ä¹¦ï¼Œé’‰é’‰ç­‰å„å¤§å‚å•†çš„å³æ—¶èŠå¤©è½¯ä»¶å·²ç»æ”¯æŒæ¥å…¥</li></ul><p><strong>å®ƒèƒ½åšä»€ä¹ˆï¼Ÿ</strong></p><p>å®ƒä¸åªæ˜¯å›ç­”é—®é¢˜çš„èŠå¤©æœºå™¨äººï¼Œè€Œæ˜¯çœŸçš„èƒ½åœ¨ä½ ç”µè„‘ä¸ŠåŠ¨æ‰‹æ“ä½œã€‚æ¯”å¦‚ä½ å‘Šè¯‰å®ƒâ€œå¸®æˆ‘æ•´ç†ä¸€ä¸‹ä¸Šä¸ªæœˆçš„é‚®ä»¶â€ï¼Œå®ƒå°±é»˜é»˜å»å¤„ç†äº†ï¼›ä½ ç¡è§‰æ—¶ï¼Œå®ƒè¿˜èƒ½ç»§ç»­å¹²æ´»ï¼Œé€€è®¢å¹¿å‘Šã€é¢„çº¦è¡Œç¨‹ã€ç”šè‡³æ‰¾æ‰¾ Bugã€‚</p><p>å®ƒå®Œå…¨å…è´¹ï¼Œä½ çš„æ•°æ®éƒ½åœ¨è‡ªå·±æ‰‹é‡Œã€‚è€Œä¸”å¯ä»¥ç”¨é’‰é’‰ï¼Œé£ä¹¦ï¼ŒWhatsAppã€Telegramç­‰å„ç±»å³æ—¶é€šè®¯è½¯ä»¶æ¥æŒ‡æŒ¥ä»–å¹²æ´»ï¼</p><p>ç®€å•æ¥è¯´ï¼Œä¸€å¥è¯äº¤ç»™å®ƒï¼Œä»æ•´ç†æ¡Œé¢æ–‡ä»¶åˆ°æ§åˆ¶å®¶é‡Œç¯å…‰ï¼Œå®ƒéƒ½é»˜é»˜å¸®ä½ æå®šã€‚æ˜¯ä½ ç”µè„‘é‡ŒçœŸæ­£çš„è´¾ç»´æ–¯ï¼è¶…çº§æ™ºèƒ½çš„AIåŠ©ç†ï¼</p><h2>äºŒã€å®‰è£…nodejs</h2><p>åé¢æ‰§è¡Œä¸€é”®å®‰è£…å‘½ä»¤ï¼Œå¯ä»¥è‡ªåŠ¨å®‰è£…nodejsï¼Œä½†æ˜¯å¦‚æœä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼Œé˜²æ­¢å®‰è£…æ„å¤–ï¼Œå¯ä»¥å…ˆå®‰è£…nodejsï¼š</p><p>å®˜æ–¹ä¸‹è½½åœ°å€ï¼š<a href="https://link.segmentfault.com/?enc=HOUo%2Bd3y3QE6CG5M0zo4Ow%3D%3D.pciWh1Bh%2BaHxMko0dyQcVmNEE%2Fe97p%2Fu%2BP%2FfoqmRAF0gEeyjlqxHiOBWTpgJKylS" rel="nofollow" target="_blank">https://nodejs.org/zh-cn/download</a><br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585597" alt="" title=""/></p><h2>ä¸‰ã€å¼€å§‹å®‰è£…</h2><h4>ä¸€ï¼‰è®¾ç½® PowerShell æ‰§è¡Œæƒé™</h4><p>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShellï¼š</p><ol><li>æŒ‰ <code>Win</code> é”®ï¼Œæœç´¢ <strong>PowerShell</strong></li><li>å³é”®ç‚¹å‡» <strong>Windows PowerShell</strong></li><li>é€‰æ‹© <strong>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ</strong></li><li>ç‚¹å‡» <strong>æ˜¯</strong> ç¡®è®¤<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585598" alt="" title="" loading="lazy"/></li></ol><p>åœ¨ç®¡ç†å‘˜ PowerShell çª—å£ä¸­ï¼Œä¾æ¬¡æ‰§è¡Œä»¥ä¸‹ä¸¤æ¡å‘½ä»¤ï¼š</p><pre><code class="powershell">Set-ExecutionPolicy RemoteSigned -Scope CurrentUser

Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass</code></pre><p><strong>è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</strong></p><ul><li>ç¬¬ä¸€æ¡å‘½ä»¤ï¼šå…è®¸å½“å‰ç”¨æˆ·è¿è¡Œæœ¬åœ°å’Œä¸‹è½½çš„è„šæœ¬</li><li>ç¬¬äºŒæ¡å‘½ä»¤ï¼šå…è®¸å½“å‰ç”¨æˆ·è¿è¡Œæœ¬åœ°å’Œä¸‹è½½çš„è„šæœ¬</li></ul><blockquote>âš ï¸ <strong>å®‰å…¨æç¤º</strong>ï¼šè¿™äº›å‘½ä»¤åªä¼šå½±å“æ‚¨è‡ªå·±çš„è´¦æˆ·ï¼Œä¸ä¼šå½±å“ç³»ç»Ÿå®‰å…¨æˆ–å…¶ä»–ç”¨æˆ·ã€‚</blockquote><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585599" alt="" title="" loading="lazy"/></p><h4>äºŒï¼‰æ‰§è¡Œä¸€é”®å®‰è£…å‘½ä»¤</h4><p>å¤åˆ¶ä»¥ä¸‹å‘½ä»¤ï¼Œç²˜è´´åˆ° PowerShell çª—å£ä¸­ï¼ŒæŒ‰ <strong>Enter</strong> æ‰§è¡Œï¼š</p><pre><code class="powershell">iwr -useb https://openclaw.ai/install.ps1 | iex</code></pre><p><strong>å®‰è£…è¿‡ç¨‹ä¼šè‡ªåŠ¨å®Œæˆï¼š</strong></p><ul><li>æ£€æµ‹ç³»ç»Ÿç¯å¢ƒ</li><li>å®‰è£…å¿…è¦ä¾èµ–ï¼ˆNode.js ç­‰ï¼‰</li><li>ä¸‹è½½ OpenClaw æ ¸å¿ƒæ–‡ä»¶</li><li>é…ç½®ç¯å¢ƒå˜é‡</li><li>å¯åŠ¨é…ç½®å‘å¯¼</li></ul><blockquote>æ³¨æ„ï¼šå¦‚æœå‘½ä»¤æ‰§è¡Œåï¼Œè¿˜æ˜¯æŠ¥é”™ï¼Œå¯ä»¥è‡ªå·±åˆ°å®˜ç½‘ä¸‹è½½nodeå®‰è£…åŒ…ï¼Œè‡ªå·±å®‰è£…nodeç¯å¢ƒï¼Œæ³¨æ„ç‰ˆæœ¬æœ€å¥½åœ¨ node v22.x ä»¥ä¸Šï¼Œnodeå®˜ç½‘ä¸‹è½½åœ°å€ï¼š<a href="https://link.segmentfault.com/?enc=dy2uW2QjInAfhbVHOMSd8w%3D%3D.A0H0ReGHrZ2iIDCTi3LCvwh4zDaPI1eBGdrbOhAC8tIqJwkU0j9B%2FjSll5y2mkiL" rel="nofollow" target="_blank">https://nodejs.org/zh-cn/download</a>ï¼Œè‹¥è¿˜æ˜¯ä¸æ‡‚æ€ä¹ˆå®‰è£…ï¼Œç‚¹å¤´åƒè¿›æˆ‘ä¸»é¡µæ‰¾åˆ°æˆ‘ï¼Œæ‹‰ä½ è¿›äº¤æµç¾¤</blockquote><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585600" alt="" title="" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585601" alt="" title="" loading="lazy"/></p><h2>å››ã€åˆå§‹é…ç½®å‘å¯¼</h2><p>å®‰è£…å®Œæˆåï¼Œä¼šè‡ªåŠ¨è¿›å…¥é…ç½®å‘å¯¼ï¼ˆ<code>openclaw onboard</code>ï¼‰ã€‚</p><h3>ä¸€ï¼‰é£é™©å‘ŠçŸ¥</h3><p>è¿™ä¸€æ­¥ä¸»è¦æ˜¯å‘Šè¯‰ä½ ï¼Œä½¿ç”¨OpenClawå¯èƒ½ä¼šæœ‰ä¸€äº›é£é™©ã€‚è¯·é—®ä½ æ˜¯å¦ç»§ç»­ï¼Ÿ<br/>æŒ‰ å‘å·¦æ–¹å‘é”® â†ï¼Œé€‰æ‹© <code>Yes</code>ï¼ŒæŒ‰ <code>Enter</code> å›è½¦ç¡®è®¤<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585602" alt="" title="" loading="lazy"/></p><h3>äºŒï¼‰é€‰æ‹© QiuickStart æ¨¡å¼</h3><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585603" alt="" title="" loading="lazy"/></p><h3>ä¸‰ï¼‰é…ç½® AI æ¨¡å‹ API Key</h3><p>OpenClaw éœ€è¦è¿æ¥åˆ°å¤§è¯­è¨€æ¨¡å‹æ‰èƒ½å·¥ä½œã€‚Openclaw æ¯”è¾ƒè´¹tokenï¼Œå›½å¤–æ¨¡å‹æˆæœ¬é«˜ï¼Œé—¨æ§›ä¹Ÿé«˜ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©å›½å†…çš„æ™ºè°±çš„ GLM 4.7</p><blockquote>å¦‚æœæ²¡æœ‰æ™ºè°±çš„API Keyï¼Œç‚¹å‡»å®˜æ–¹åœ°å€è‡ªå·±æ³¨å†Œè´¦å·è·å–API keyï¼š<a href="https://link.segmentfault.com/?enc=tx%2FklZFWuUhB2Vx8B4rAKA%3D%3D.J7D3fd9FCdEITlbDOfxOsfgWzWq9yeWJpZCbqRtHdBzaaXepVvK9iSnzHTGBisSWc00ObQiMiEwLjmmHvSmPtw%3D%3D" rel="nofollow" target="_blank">https://www.bigmodel.cn/glm-coding?ic=RBSKXMPNJP</a></blockquote><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585604" alt="" title="" loading="lazy"/></p><p>è¾“å…¥è‡ªå·±çš„ API Keyï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585605" alt="" title="" loading="lazy"/></p><h3>å››ï¼‰é€‰æ‹© AI æ¨¡å‹</h3><blockquote>è¿™é‡Œæˆ‘é€‰æ‹©é»˜è®¤çš„GLM 4.7ï¼Œä¹Ÿæ˜¯æ™ºæ™®å½“å‰çš„æ——èˆ°æ¨¡å‹</blockquote><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585606" alt="" title="" loading="lazy"/></p><h3>äº”ï¼‰è¿æ¥å³æ—¶é€šè®¯å¹³å°</h3><p>é…ç½®å®Œ AI æ¨¡å‹åï¼ŒOpenClaw ä¼šè¯¢é—®ä½ è¦è¿æ¥å“ªä¸ªé€šè®¯å¹³å°ï¼Ÿ</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585607" alt="" title="" loading="lazy"/></p><blockquote>OpenClaw åŸç”Ÿæ”¯æŒçš„å³æ—¶é€šä¿¡å¹³å°ä¸»è¦æ˜¯æµ·å¤–çš„ WhatsAppã€Telegramã€Discordã€Slackã€iMessage ç­‰ï¼Œå›½å†…ç”¨æˆ·ä¸ä¹ æƒ¯ï¼Œè¿™é‡Œå›½äº§å³æ—¶é€šä¿¡è½¯ä»¶å¤§å‚ä¹Ÿè·Ÿè¿›äº†ï¼Œç°åœ¨é’‰é’‰ï¼Œé£ä¹¦ç­‰éƒ½å·²æ”¯æŒæ¥å…¥OpenClaw</blockquote><p>åé¢ä¼šå¸¦é¢†å¤§å®¶æŠŠé£ä¹¦æœºå™¨äººæ¥å…¥ OpenClawï¼Œä½¿å¤§å®¶å¯ä»¥é€šè¿‡é£ä¹¦å³å¯æŒ‡æŒ¥OpenClawä¸ºæˆ‘ä»¬å¹²æ´»ï¼Œä½†æ˜¯é£ä¹¦é…ç½®æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆé€‰æ‹©è·³è¿‡ï¼Œåé¢æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§ç»­è¿›è¡Œé…ç½®ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585608" alt="" title="" loading="lazy"/></p><h3>å…­ï¼‰é€‰æ‹©Skills</h3><p>è¿™é‡Œä¹Ÿé€‰æ‹©ï¼šNoï¼Œæš‚ä¸é…ç½®ï¼Œåé¢é€šè¿‡UIç•Œé¢è¿›è¡Œé…ç½®ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585609" alt="" title="" loading="lazy"/></p><h3>ä¸ƒï¼‰æ˜¯å¦å¼€å¯Hooks</h3><p>æ“ä½œæ­¥éª¤ï¼šå…ˆæ•²<strong>ç©ºæ ¼</strong>ï¼Œè¡¨ç¤ºé€‰ä¸­å½“å‰é¡¹ï¼Œå†æ•²å›è½¦é”®</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585610" alt="" title="" loading="lazy"/></p><h3>å…«ï¼‰å¯åŠ¨æœåŠ¡å¹¶æ‰“å¼€UIç•Œé¢</h3><p>æ­¤æ—¶å®ƒä¼šè‡ªåŠ¨å†æ‰“å¼€ä¸€ä¸ªå‘½ä»¤çª—å£æ¥å¯åŠ¨æœåŠ¡:</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585611" alt="" title="" loading="lazy"/></p><blockquote>è¿™ä¸ªè¿‡ç¨‹æ˜¯åœ¨å¯åŠ¨æœåŠ¡ï¼Œå¯èƒ½ä¼šéœ€è¦ç­‰ä¸€ç‚¹æ—¶é—´</blockquote><p>åŒæ—¶ï¼Œå¤§çº¦è¿‡30ç§’å·¦å³ï¼Œæˆ‘ä»¬å›åˆ°åˆšæ‰çš„è®¾ç½®çª—å£ï¼Œé€‰æ‹© <code>Open the Web UI</code> ï¼Œæ‰“å¼€ <code>OpenClaw</code> çš„UIç•Œé¢ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585612" alt="" title="" loading="lazy"/></p><p>æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€Web UIç•Œé¢ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585613" alt="" title="" loading="lazy"/></p><h3>ä¹ï¼‰æµ‹è¯•ä¸€ä¸‹</h3><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585614" alt="" title="" loading="lazy"/></p><h2>äº”ã€æ¥å…¥é£ä¹¦æœºå™¨äºº</h2><p>æˆ‘ä»¬éœ€è¦å…ˆåˆ°é£ä¹¦å¹³å°åˆ›å»ºè‡ªå·±çš„æœºå™¨äººæ¥æ¥å…¥OpenClawï¼š</p><h3>ä¸€ï¼‰æ¥åˆ°é£ä¹¦å¼€å‘è€…åå°</h3><p>é£ä¹¦å¼€æ”¾å¹³å°åœ°å€ï¼š<a href="https://link.segmentfault.com/?enc=ARcMZJk7ZcA1oLVuBv08NQ%3D%3D.SGwYjr2YpAP0Z5nA1Xo7djPsJxruYsE9K%2FksB%2FtsJRo%3D" rel="nofollow" target="_blank">https://open.feishu.cn</a></p><blockquote>æ²¡æœ‰é£ä¹¦è´¦å·çš„ï¼Œéœ€è¦è‡ªå·±æ³¨å†Œè´¦å·</blockquote><p>ç‚¹å‡»å³ä¸Šè§’è¿›å…¥ <strong>å¼€å‘è€…åå°</strong>ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585615" alt="" title="" loading="lazy"/></p><h3>äºŒï¼‰åˆ›å»ºåº”ç”¨</h3><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585616" alt="" title="" loading="lazy"/></p><h3>ä¸‰ï¼‰å¡«å†™åº”ç”¨ä¿¡æ¯</h3><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585617" alt="" title="" loading="lazy"/></p><h3>å››ï¼‰è·å–è‡ªå·±çš„åº”ç”¨å‡­è¯</h3><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585618" alt="" title="" loading="lazy"/></p><h3>äº”ï¼‰ç»™åº”ç”¨æ·»åŠ æœºå™¨äºº</h3><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585619" alt="" title="" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585620" alt="" title="" loading="lazy"/></p><h3>å…­ï¼‰ç»™åº”ç”¨é…ç½®æƒé™</h3><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585621" alt="" title="" loading="lazy"/></p><p>æŠŠå³æ—¶é€šè®¯ç›¸å…³çš„æƒé™å…¨éƒ¨å¼€é€šï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585622" alt="" title="" loading="lazy"/></p><h3>ä¸ƒï¼‰åˆ›å»ºç‰ˆæœ¬å¹¶å‘å¸ƒ</h3><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585623" alt="" title="" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585624" alt="" title="" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585625" alt="" title="" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585626" alt="" title="" loading="lazy"/></p><p>æ¥åˆ°é£ä¹¦å®¢æˆ·ç«¯è¿›è¡Œå®¡æ‰¹ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585627" alt="" title="" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585628" alt="" title="" loading="lazy"/></p><h3>å…«ï¼‰å®‰è£…é£ä¹¦æ’ä»¶</h3><p>æ‰“å¼€powershellï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…é£ä¹¦æ’ä»¶ï¼š</p><pre><code>openclaw plugins install @m1heng-clawd/feishu</code></pre><p>å®‰è£…æˆåŠŸåï¼Œå†æ‰“å¼€ä¸€ä¸ªæ–°çš„å‘½ä»¤çª—å£ï¼Œå¼€å§‹é…ç½®é£ä¹¦æ’ä»¶ï¼š</p><p>è¾“å…¥å‘½ä»¤ï¼š<code>openclaw config</code></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585629" alt="" title="" loading="lazy"/></p><p>é€‰æ‹©æ¸ é“:<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585630" alt="" title="" loading="lazy"/></p><p>é€‰æ‹©é…ç½®é“¾æ¥:<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585631" alt="" title="" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585632" alt="" title="" loading="lazy"/></p><p>è¾“å…¥é£ä¹¦çš„AppIDï¼ŒAppSecrectï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585633" alt="" title="" loading="lazy"/></p><p>åŸŸåé€‰æ‹©ä¸­å›½çš„ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585634" alt="" title="" loading="lazy"/></p><p>æ¥å—ç¾¤ç»„èŠå¤©ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585635" alt="" title="" loading="lazy"/></p><p>é€‰æ‹©å®Œæˆï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585636" alt="" title="" loading="lazy"/></p><p>é€‰æ‹©yesï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585637" alt="" title="" loading="lazy"/></p><p>é€‰æ‹©openï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585638" alt="" title="" loading="lazy"/></p><p>é€‰æ‹©ç»§ç»­ï¼Œå®Œæˆé…ç½®ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585639" alt="" title="" loading="lazy"/></p><p>é‡å¯æœåŠ¡ï¼Œä½¿é…ç½®ç”Ÿæ•ˆï¼š<br/>æ§åˆ¶å¯ä»¥çœ‹åˆ°é£ä¹¦æ’ä»¶å·²ç»é…ç½®æˆåŠŸ<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585640" alt="" title="" loading="lazy"/></p><h3>ä¸ƒï¼‰å›åˆ°é£ä¹¦åå°è®¾ç½®äº‹ä»¶å›è°ƒ</h3><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585641" alt="" title="" loading="lazy"/></p><p>é€‰æ‹© <code>ä½¿ç”¨é•¿è¿æ¥æ¥æ”¶äº‹ä»¶</code> ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585642" alt="" title="" loading="lazy"/></p><p>å¯ä»¥çœ‹åˆ°æ·»åŠ äº‹ä»¶æŒ‰é’®ç”±åŸæ¥çš„ç°è‰²ä¸å¯ç‚¹å‡»å˜ä¸ºå¯ç‚¹å‡»ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585643" alt="" title="" loading="lazy"/></p><p>æ·»åŠ æ¥æ”¶æ¶ˆæ¯äº‹ä»¶ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585644" alt="" title="" loading="lazy"/></p><p>ç»™åº”ç”¨å¼€é€šè·å–é€šè®¯å½•åŸºæœ¬ä¿¡æ¯çš„æƒé™ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585645" alt="" title="" loading="lazy"/></p><p>é‡æ–°å‘å¸ƒç‰ˆæœ¬ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585646" alt="" title="" loading="lazy"/></p><p>è·Ÿå‰é¢çš„æ­¥éª¤ä¸€æ ·ï¼Œå‘å¸ƒä¸ºåœ¨çº¿åº”ç”¨å³å¯ã€‚</p><p>ç°åœ¨å¯ä»¥åœ¨ é£ä¹¦ä¸­ä¸ AI åŠ©æ‰‹å¯¹è¯äº†ï¼</p><h3>å…«ï¼‰åœ¨é£ä¹¦ä¸­ä¸OpenClawå¯¹è¯</h3><p>æ¥åˆ°é£ä¹¦å®¢æˆ·ç«¯æˆ–è€…æ‰‹æœºé£ä¹¦appä¸Šï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585647" alt="" title="" loading="lazy"/></p><p>ä»¥ä¸‹æ˜¯openclawæ–‡ä»¶å¤¹ä¸‹é¢çš„æ–‡æ¡£å†…çš„å†…å®¹ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585648" alt="" title="" loading="lazy"/></p><p>ç°åœ¨æˆ‘è·ŸåºŸæ°´æœºå™¨äººå¯¹è¯ï¼Œè®©ä»–å‘Šè¯‰æˆ‘æŒ‡å®šæ–‡æ¡£å†…æ˜¯ä»€ä¹ˆå†…å®¹ï¼š<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585649" alt="" title="" loading="lazy"/></p><hr/><h2>å…­ã€è®¿é—® Web æ§åˆ¶é¢æ¿</h2><p>é…ç½®å®Œæˆåï¼ŒPowerShell çª—å£åº•éƒ¨ä¼šæ˜¾ç¤ºæ§åˆ¶é¢æ¿é“¾æ¥ï¼Œæ ¼å¼ç±»ä¼¼ï¼š</p><pre><code>Control UI: http://127.0.0.1:18789</code></pre><ol><li>å¤åˆ¶å®Œæ•´é“¾æ¥</li><li>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€</li><li>å³å¯çœ‹åˆ°å¯è§†åŒ–UIç®¡ç†ç•Œé¢</li></ol><hr/><h2>ä¸ƒã€å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥</h2><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>openclaw onboard</code></td><td>é‡æ–°è¿›å…¥é…ç½®å‘å¯¼</td></tr><tr><td><code>openclaw status</code></td><td>æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</td></tr><tr><td><code>openclaw health</code></td><td>å¥åº·æ£€æŸ¥</td></tr><tr><td><code>openclaw gateway start</code></td><td>å¯åŠ¨æœåŠ¡</td></tr><tr><td><code>openclaw gateway stop</code></td><td>åœæ­¢æœåŠ¡</td></tr><tr><td><code>openclaw update</code></td><td>æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬</td></tr><tr><td><code>openclaw doctor</code></td><td>è¯Šæ–­é—®é¢˜</td></tr><tr><td><code>openclaw uninstall</code></td><td>å¸è½½ OpenClaw</td></tr></tbody></table><hr/><h2>å…«ã€å¸¸è§é—®é¢˜è§£ç­”</h2><h4>Q1: å®‰è£…é£ä¹¦æ’ä»¶æç¤ºï¼šspawn npm ENOENT</h4><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585650" alt="" title="" loading="lazy"/></p><p>é—®é¢˜åŸå› ï¼šè¿™å¯èƒ½æ˜¯openclawçš„ä¸€ä¸ªbugï¼Œå¯ä»¥ç­‰å®˜æ–¹æ›´æ–°ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å»å®˜æ–¹ä»“åº“æissue</p><p>è§£å†³æ­¥éª¤ï¼š</p><p>å®šä½é—®é¢˜ä»£ç </p><p>æ–‡ä»¶è·¯å¾„ï¼š</p><pre><code>C:\Users\Administrator\AppData\Roaming\fnm\node-versions\v22.14.0\installation\node_modules\openclaw\dist\process\exec.js</code></pre><p>ä¿®æ”¹ä»£ç </p><p>æ‰¾åˆ° <code>runCommandWithTimeout</code> å‡½æ•°ä¸­çš„ spawn è°ƒç”¨ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p><p><strong>ä¿®æ”¹å‰ï¼š</strong></p><pre><code class="javascript">const stdio = resolveCommandStdio({ hasInput, preferInherit: true });
const child = spawn(argv[0], argv.slice(1), {
    stdio,
    cwd,
    env: resolvedEnv,
    windowsVerbatimArguments,
});</code></pre><p><strong>ä¿®æ”¹åï¼š</strong></p><pre><code class="javascript">const stdio = resolveCommandStdio({ hasInput, preferInherit: true });
// On Windows, npm must be spawned with shell: true or use .cmd extension
let command = argv[0];
let useShell = false;
if (process.platform === "win32" &amp;&amp; path.basename(command) === "npm") {
    useShell = true;
}
const child = spawn(command, argv.slice(1), {
    stdio,
    cwd,
    env: resolvedEnv,
    shell: useShell,
});</code></pre><h4>Q2: æç¤º "openclaw å‘½ä»¤æ‰¾ä¸åˆ°"</h4><p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p><ol><li>å…³é—­æ‰€æœ‰ PowerShell çª—å£</li><li>é‡æ–°æ‰“å¼€ PowerShell</li><li>å¦‚æœè¿˜ä¸è¡Œï¼Œæ‰§è¡Œ <code>exec bash</code> æˆ–é‡å¯ç”µè„‘</li></ol><h4>Q3: å®‰è£…å¡ä½ä¸åŠ¨</h4><p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p><ol><li>æŒ‰ <code>Ctrl + C</code> ä¸­æ–­å½“å‰æ“ä½œ</li><li>æ‰§è¡Œï¼š<code>openclaw doctor</code> æ£€æŸ¥é—®é¢˜</li><li>å¦‚æç¤ºç½‘ç»œé—®é¢˜ï¼Œæ£€æŸ¥é˜²ç«å¢™è®¾ç½®</li></ol><h4>Q4: API Key é…ç½®é”™è¯¯</h4><p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p><ol><li>æ‰§è¡Œï¼š<code>openclaw onboard</code></li><li>é€‰æ‹©é‡æ–°é…ç½® API Key</li><li>ç¡®ä¿å¯†é’¥æ ¼å¼æ­£ç¡®</li></ol><h4>Q5: ç«¯å£ 18789 è¢«å ç”¨</h4><p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p><pre><code class="powershell">openclaw gateway --port 18790</code></pre><p>ä½¿ç”¨å…¶ä»–ç«¯å£å¯åŠ¨æœåŠ¡ã€‚</p><h2>ä¹ã€æˆæœ¬è¯´æ˜</h2><p>OpenClaw è½¯ä»¶æœ¬èº«å®Œå…¨å…è´¹ï¼Œä¸»è¦æˆæœ¬æ¥è‡ª AI æ¨¡å‹ API è°ƒç”¨ï¼Œå¯é€‰æ‹©å›½äº§å¤§æ¨¡å‹ï¼Œé™ä½æˆæœ¬ã€‚</p><hr/><h2>ç»“è¯­</h2><p>OpenClaw ä»£è¡¨äº†ä¸ªäºº AI åŠ©ç†çš„æœªæ¥è¶‹åŠ¿â€”â€”ä»"èŠå¤©å·¥å…·"è¿›åŒ–ä¸º"æ‰§è¡Œå·¥å…·"ã€‚è™½ç„¶ç›®å‰çš„é…ç½®è¿‡ç¨‹å¯¹å°ç™½ç”¨æˆ·æœ‰ä¸€å®šé—¨æ§›ï¼Œä½†ä¸€æ—¦å®Œæˆè®¾ç½®ï¼Œæ‚¨å°†æ‹¥æœ‰ä¸€ä¸ª 24/7 å¾…å‘½çš„è¶…çº§åŠ©æ‰‹ã€‚</p>]]></description></item><item>    <title><![CDATA[Obsidian ä½¿ç”¨æŒ‡å—ï¼šä»é›¶å¼€å§‹æ­å»ºä½ çš„ä¸ªäººçŸ¥è¯†åº“ BugShare ]]></title>    <link>https://segmentfault.com/a/1190000047585742</link>    <guid>https://segmentfault.com/a/1190000047585742</guid>    <pubDate>2026-02-01 22:05:48</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p><strong>æˆ‘å¹¶ä¸è®¤ä¸º Obsidian æ˜¯ä¸€æ¬¾ä½¿ç”¨é—¨æ§›å¾ˆé«˜çš„è½¯ä»¶ã€‚</strong><br/>äº‹å®ä¸Šï¼Œåªä½¿ç”¨ Obsidian è‡ªå¸¦çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±å·²ç»å¯ä»¥éå¸¸é«˜æ•ˆåœ°ç®¡ç†æˆ‘ä»¬çš„ç¬”è®°ä¸çŸ¥è¯†ã€‚</p><p>å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„ä¹Ÿå¾ˆç®€å•ï¼š<br/>ğŸ‘‰ <strong>å¸Œæœ›åˆšæ¥è§¦ï¼Œæˆ–è¿˜æ²¡æœ‰æ¥è§¦ Obsidian çš„æœ‹å‹ï¼Œå¯ä»¥é€šè¿‡è¿™ç¯‡æ–‡ç« å¿«é€Ÿä¸Šæ‰‹è¿™æ¬¾è½¯ä»¶ã€‚</strong></p><p>ä¸è®²å¤æ‚ç†è®ºï¼Œä¸å¼ºæ¨æ’ä»¶ï¼Œåªè®²çœŸæ­£ã€Œä¸€ä¸Šæ‰‹å°±èƒ½ç”¨ã€çš„éƒ¨åˆ†ã€‚</p><hr/><h2>ä¸€ã€å®‰è£…</h2><p>Obsidian æ˜¯ä¸€æ¬¾è·¨å¹³å°çš„æœ¬åœ°ç¬”è®°è½¯ä»¶ï¼Œæ”¯æŒ macOS / Windows / Linux / iOS / Androidã€‚</p><p>å®˜æ–¹ä¸‹è½½åœ°å€ï¼š</p><blockquote><a href="https://link.segmentfault.com/?enc=yAqpKVphI7eGmvwxIaMZdg%3D%3D.HllgZAIKR581k7DsRF8YAgiGqfMmHZ%2B1PWV96eODc2w%3D" rel="nofollow" target="_blank">https://obsidian.md</a></blockquote><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585745" alt="screenshot-1.0-hero-combo.png" title="screenshot-1.0-hero-combo.png"/></p><p>ä¸‹è½½å®‰è£…åˆ°æœ¬åœ°å³å¯ï¼Œæ— éœ€æ³¨å†Œè´¦å·ä¹Ÿèƒ½ç›´æ¥ä½¿ç”¨ã€‚</p><hr/><h2>äºŒã€ä»“åº“ï¼ˆVaultï¼‰</h2><p>åœ¨ Obsidian ä¸­ï¼Œ<strong>ä»“åº“ï¼ˆVaultï¼‰æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶å¤¹</strong>ï¼Œä½ çš„æ‰€æœ‰ç¬”è®°éƒ½ä¼šä»¥ Markdown æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨è¿™é‡Œã€‚</p><blockquote>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Macï¼Œéå¸¸æ¨èæŠŠä»“åº“ä½ç½®æ”¾åœ¨ iCloud ä¸­ï¼Œæ–¹ä¾¿å¤šè®¾å¤‡åŒæ­¥ã€‚</blockquote><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585746" alt="PixPin_2026-01-31_19-45-11.png" title="PixPin_2026-01-31_19-45-11.png" loading="lazy"/></p><p>ä¼˜ç‚¹åªæœ‰ä¸€å¥è¯ï¼š<br/>ğŸ‘‰ <strong>æ•°æ®å®Œå…¨å±äºä½ ï¼Œä¸è¢«ä»»ä½•å¹³å°ç»‘å®šã€‚</strong></p><hr/><h2>ä¸‰ã€å¸ƒå±€</h2><h3>1. å †å æ ‡ç­¾é¡µ</h3><p>å¦‚æœä½ å·²ç»çœ‹è…»äº†ä¼ ç»Ÿæµè§ˆå™¨å¼çš„æ ‡ç­¾é¡µå¸ƒå±€ï¼Œå¯ä»¥è¯•è¯• <strong>å †å æ ‡ç­¾é¡µ</strong>ï¼Œæ•´ä½“è§†è§‰ä¼šæ›´ç´§å‡‘ï¼Œä¹Ÿæ›´æœ‰â€œå·¥ä½œåŒºâ€çš„æ„Ÿè§‰ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585747" alt="1769862805965.png" title="1769862805965.png" loading="lazy"/></p><hr/><h3>2. è‡ªç”±æ‹–åŠ¨æ ‡ç­¾</h3><ul><li>æ”¯æŒé€šè¿‡é¼ æ ‡è‡ªç”±æ‹–åŠ¨æ ‡ç­¾é¡µä½ç½®</li><li>å¯ä»¥åˆ†å±ã€ä¸Šä¸‹æˆ–å·¦å³æ’åˆ—</li></ul><p>ğŸ’¡ <strong>Tips</strong><br/>å½“ä½ è°ƒæ•´å¥½ä¸€ä¸ªé¡ºæ‰‹çš„å¸ƒå±€åï¼Œè®°å¾—ä¿å­˜ä¸‹æ¥ï¼Œåé¢å¯ä»¥ä¸€é”®æ¢å¤ï¼ˆä¸‹é¢çš„ã€Œå·¥ä½œåŒºã€æ’ä»¶ä¼šè®²ï¼‰ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585748" alt="PixPin_2026-01-31_20-40-24.png" title="PixPin_2026-01-31_20-40-24.png" loading="lazy"/></p><hr/><h2>å››ã€ç¬”è®°</h2><h3>1. åˆ›å»ºç¬”è®°</h3><p>å¼ºçƒˆå»ºè®®ä½ ä»ä¸€å¼€å§‹å°± <strong>å…»æˆæ·»åŠ ç¬”è®°å±æ€§ï¼ˆFrontmatterï¼‰</strong> çš„ä¹ æƒ¯ã€‚</p><ul><li>åœ¨ç¬”è®°ä¸­è¾“å…¥ <code>---</code></li><li>ç„¶åæ•²å›è½¦</li><li>Obsidian ä¼šè‡ªåŠ¨ç”Ÿæˆå±æ€§åŒºåŸŸ</li><li>ç‚¹å‡»æœ€å·¦ä¾§å›¾æ ‡å¯ä»¥é€‰æ‹©å±æ€§ç±»å‹<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585749" alt="PixPin_2026-01-31_21-55-18.png" title="PixPin_2026-01-31_21-55-18.png" loading="lazy"/></li></ul><p>è¿™ä¸€æ­¥ä¼šåœ¨åæœŸåšæ£€ç´¢ã€åˆ†ç±»ã€è‡ªåŠ¨åŒ–æ—¶éå¸¸æœ‰ä»·å€¼ã€‚</p><hr/><h3>2. å‡ºé“¾ä¸åé“¾</h3><p>è¿™æ˜¯ Obsidian æœ€æ ¸å¿ƒã€ä¹Ÿæ˜¯æœ€æœ‰ä»·å€¼çš„èƒ½åŠ›ä¹‹ä¸€ã€‚</p><ul><li>è¾“å…¥ <code>[[</code> å³å¯åˆ›å»ºæˆ–å¼•ç”¨ç¬”è®°</li><li>è·³è½¬åˆ°ç›®æ ‡ç¬”è®°åï¼Œå¯ä»¥çœ‹åˆ°å“ªäº›ç¬”è®°å¼•ç”¨äº†å®ƒï¼ˆåé“¾ï¼‰</li><li><strong>å³ä½¿æ²¡æœ‰æ˜¾å¼åŠ é“¾æ¥ï¼Œåªè¦æåˆ°äº†ç¬”è®°åç§°ï¼Œä¹Ÿä¼šè¢«è¯†åˆ«</strong></li><li>å½“å‰ç¬”è®°ä¸­è¿˜èƒ½å‘ç°ã€Œæ½œåœ¨é“¾æ¥ã€<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585750" alt="1769869292611.png" title="1769869292611.png" loading="lazy"/></li></ul><p>ä¸€å¥è¯æ€»ç»“ï¼š<br/>ğŸ‘‰ <strong>ç¬”è®°ä¹‹é—´ä¼šè‡ªç„¶â€œé•¿â€æˆä¸€å¼ çŸ¥è¯†ç½‘ç»œã€‚</strong></p><hr/><h3>3. å‘½ä»¤é¢æ¿</h3><p>å¦‚æœä½ è®°ä¸ä½å¿«æ·é”®æˆ–è¯­æ³•ï¼Œå‘½ä»¤é¢æ¿å‡ ä¹å¯ä»¥è§£å†³ 90% çš„é—®é¢˜ã€‚</p><ul><li>å·¦ä¾§æ ç‚¹å‡»å›¾æ ‡æ‰“å¼€</li><li>æˆ–ä½¿ç”¨å¿«æ·é”®ï¼š<code>Command + P</code><br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585751" alt="PixPin_2026-01-31_22-40-33.png" title="PixPin_2026-01-31_22-40-33.png" loading="lazy"/></li></ul><p>å¾ˆå¤šåŠŸèƒ½ä½ æ ¹æœ¬ä¸éœ€è¦è®°ï¼Œåªéœ€è¦ <strong>ä¼šæœç´¢</strong>ã€‚</p><hr/><h2>äº”ã€è¯­æ³•</h2><h3>1. é“¾æ¥è¯­æ³•</h3><ul><li>ä½¿ç”¨ <code>|</code> è®¾ç½®åˆ«å<br/><code>[[æˆ‘çš„ç¬¬äºŒç¯‡ç¬”è®°|è‡ªå®šä¹‰åç§°]]</code></li><li>ä½¿ç”¨ <code>#</code> å®šä½åˆ°æ ‡é¢˜<br/><code>[[æˆ‘çš„ç¬¬äºŒç¯‡ç¬”è®°#æ ‡é¢˜1]]</code></li><li>ä½¿ç”¨ <code>^</code> å®šä½åˆ°å…·ä½“æ®µè½<br/><code>[[æˆ‘çš„ç¬¬äºŒç¯‡ç¬”è®°^ç¬¬äºŒç¯‡ç¬”è®°çš„ä¸€å¥è¯]]</code><br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585752" alt="PixPin_2026-02-01_01-29-53.png" title="PixPin_2026-02-01_01-29-53.png" loading="lazy"/></li></ul><hr/><h3>2. åµŒå…¥ç¬”è®°</h3><p>åœ¨é“¾æ¥å‰åŠ ä¸€ä¸ª <code>!</code>ï¼Œå³å¯æŠŠå†…å®¹ç›´æ¥åµŒå…¥å½“å‰ç¬”è®°ã€‚</p><ul><li>åµŒå…¥æ•´ç¯‡ç¬”è®°<br/><code>![[æˆ‘çš„ç¬¬äºŒç¯‡ç¬”è®°]]</code></li><li>åµŒå…¥æŸä¸ªæ ‡é¢˜<br/><code>![[æˆ‘çš„ç¬¬äºŒç¯‡ç¬”è®°#æ ‡é¢˜1]]</code></li><li>åµŒå…¥æŸä¸€æ®µå†…å®¹<br/><code>![[æˆ‘çš„ç¬¬äºŒç¯‡ç¬”è®°^ç¬¬äºŒç¯‡ç¬”è®°çš„ä¸€å¥è¯]]</code><br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585753" alt="PixPin_2026-02-01_01-35-51.png" title="PixPin_2026-02-01_01-35-51.png" loading="lazy"/></li></ul><hr/><h3>3. å¤–éƒ¨é“¾æ¥</h3><p>æ ‡å‡† Markdown è¯­æ³•ï¼š</p><pre><code class="markdown">[bugshare](https://www.bugshare.cn)</code></pre><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585754" alt="PixPin_2026-02-01_01-39-28.png" title="PixPin_2026-02-01_01-39-28.png" loading="lazy"/></p><hr/><h3>4. å…¶å®ƒå¸¸ç”¨è¯­æ³•</h3><ul><li>é«˜äº®ï¼š<code>==é«˜äº®å†…å®¹==</code></li><li>åŠ ç²—ï¼š<code>**åŠ ç²—**</code> æˆ– <code>__åŠ ç²—__</code></li><li>æ–œä½“ï¼š<code>*æ–œä½“*</code> æˆ– <code>_æ–œä½“_</code></li><li>åˆ é™¤çº¿ï¼š<code>~~åˆ é™¤çº¿~~</code></li><li>æ— åºåˆ—è¡¨ï¼š<code>- </code></li><li>æœ‰åºåˆ—è¡¨ï¼š<code>1. </code></li><li>å¾…åŠäº‹é¡¹ï¼š<code>- [ ] ä»»åŠ¡</code></li><li>å¼•ç”¨ï¼š<code>&gt; </code></li><li>æ ‡æ³¨å—ï¼š<br/><code>&gt; [!NOTE]</code><br/><code>&gt; [!SUCCESS]</code></li><li>æ³¨é‡Šï¼š<br/><code>[^1]</code><br/><code>^[è¿™æ˜¯æ³¨é‡Š]</code></li><li>è¡¨æ ¼ï¼šå‘½ä»¤é¢æ¿æœç´¢ã€Œæ’å…¥è¡¨æ ¼ã€<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585755" alt="PixPin_2026-02-01_13-16-59.png" title="PixPin_2026-02-01_13-16-59.png" loading="lazy"/></li></ul><hr/><h2>å…­ã€æ ¸å¿ƒæ’ä»¶ï¼ˆå¼ºçƒˆå»ºè®®å¯ç”¨ï¼‰</h2><blockquote>è¿™é‡Œå¿…é¡»å¼ºè°ƒä¸€å¥ï¼š<br/><strong>çœŸçš„æ²¡å¿…è¦ All in Oneã€‚</strong><br/>ä¸è¦æŠŠæ—¶é—´æµªè´¹åœ¨æŠ˜è…¾æ’ä»¶ä¸Šï¼Œæœ‰éœ€æ±‚å†è£…æ’ä»¶ï¼Œåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆ ğŸ˜–</blockquote><hr/><h3>1. å·¥ä½œåŒº</h3><p>ç”¨äºä¿å­˜å’Œå¿«é€Ÿåˆ‡æ¢å¸ƒå±€ã€‚</p><ul><li>è®¾ç½® â†’ æ ¸å¿ƒæ’ä»¶ â†’ å·¥ä½œåŒº â†’ å¯ç”¨</li><li>å·¦ä¾§ä¼šå‡ºç°ã€Œå·¥ä½œåŒºã€å›¾æ ‡</li><li>ç»™å½“å‰å¸ƒå±€èµ·ä¸ªåå­—å³å¯ä¿å­˜<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585756" alt="PixPin_2026-01-31_21-08-07.png" title="PixPin_2026-01-31_21-08-07.png" loading="lazy"/></li></ul><hr/><h3>2. ç™½æ¿</h3><p>é€‚åˆåšç»“æ„æ¢³ç†ã€æ€ç»´å‘æ•£ã€‚</p><ul><li>è®¾ç½® â†’ æ ¸å¿ƒæ’ä»¶ â†’ ç™½æ¿ â†’ å¯ç”¨<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585757" alt="PixPin_2026-01-31_23-01-57.png" title="PixPin_2026-01-31_23-01-57.png" loading="lazy"/></li></ul><hr/><h3>3. å…³ç³»å›¾è°±</h3><p>å¯ä»¥éå¸¸ç›´è§‚åœ°çœ‹åˆ°ä½ çš„çŸ¥è¯†æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥ç”Ÿé•¿çš„ã€‚</p><ul><li>è®¾ç½® â†’ æ ¸å¿ƒæ’ä»¶ â†’ å…³ç³»å›¾è°± â†’ å¯ç”¨</li><li>æ‰“å¼€ã€Œç”Ÿé•¿åŠ¨ç”»ã€æ•ˆæœæ›´æ˜æ˜¾<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585758" alt="PixPin_2026-01-31_23-21-06.png" title="PixPin_2026-01-31_23-21-06.png" loading="lazy"/></li></ul><hr/><h3>4. æ¨¡æ¿</h3><p>ç”¨äºå¿«é€Ÿåˆ›å»ºç»Ÿä¸€ç»“æ„çš„ç¬”è®°ã€‚</p><ul><li>è®¾ç½® â†’ æ ¸å¿ƒæ’ä»¶ â†’ æ¨¡æ¿ â†’ å¯ç”¨<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585759" alt="PixPin_2026-01-31_23-54-46.png" title="PixPin_2026-01-31_23-54-46.png" loading="lazy"/></li></ul><hr/><h2>ä¸ƒã€ç¬¬ä¸‰æ–¹æ’ä»¶ï¼ˆæŒ‰éœ€ï¼‰</h2><p>é¦–æ¬¡ä½¿ç”¨éœ€è¦å…³é—­ã€Œå®‰å…¨æ¨¡å¼ã€ã€‚</p><p>æ’ä»¶æ¨èç½‘ç«™ï¼š</p><blockquote><p><a href="https://link.segmentfault.com/?enc=YAkRB11nzSa40d0GY3SfWg%3D%3D.MxhnmwXMWGYdds0TbPoP4gkgmz%2BQXCRvPQoD6JABXFE%3D" rel="nofollow" target="_blank">https://obsidian.md/plugins</a></p><p><a href="https://link.segmentfault.com/?enc=gX5jq1h90sP1JjOQwinaKA%3D%3D.4VJRyzaAKcQzqK72kozKUfit5Du9HilsyU0%2FGVcb8y%2BmgCmBiAdDHGZayoQYNl%2FQ" rel="nofollow" target="_blank">https://pkmer.cn/products/plugin/pluginMarket</a></p></blockquote><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585760" alt="PixPin_2026-02-01_12-47-01.png" title="PixPin_2026-02-01_12-47-01.png" loading="lazy"/></p><h3>æ¨èæ’ä»¶ï¼ˆåªåˆ—æˆ‘è§‰å¾—<strong>çœŸçš„æœ‰ç”¨çš„</strong>ï¼‰</h3><ul><li><strong>Iconize</strong>ï¼šè‡ªå®šä¹‰æ–‡ä»¶å¤¹å›¾æ ‡</li><li><strong>Link Favicons</strong>ï¼šå¤–éƒ¨é“¾æ¥æ˜¾ç¤ºç«™ç‚¹å›¾æ ‡</li><li><strong>Novel Word Count</strong>ï¼šç»Ÿè®¡æ–‡ä»¶å¤¹å†…ç¬”è®°æ•°é‡ä¸å­—æ•°</li><li><strong>Number Headings</strong>ï¼šè‡ªåŠ¨ç»™å¤šçº§æ ‡é¢˜ç¼–å·</li><li><strong>Excalidraw</strong>ï¼šåœ¨ç¬”è®°ä¸­åµŒå…¥æ‰‹ç»˜å›¾</li><li><strong>Git</strong>ï¼šè‡ªåŠ¨æäº¤ã€æ‹‰å–ã€æ¨é€ç¬”è®°ç‰ˆæœ¬</li></ul><hr/><h2>å…«ã€å¿«æ·é”®</h2><h3>å¸¸ç”¨å¿«æ·é”®</h3><ul><li><code>Command + O</code>ï¼šå¿«é€Ÿåˆ‡æ¢ç¬”è®°</li><li><code>Command + P</code>ï¼šå‘½ä»¤é¢æ¿</li></ul><h3>è‡ªå®šä¹‰å¿«æ·é”®</h3><ul><li>è®¾ç½® â†’ å¿«æ·é”®</li><li>æœç´¢æ“ä½œ â†’ æ·»åŠ å¿«æ·é”®</li><li>æŒ‰ä¸‹ä½ æƒ³è¦çš„ç»„åˆå³å¯<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585761" alt="PixPin_2026-01-31_23-21-55.png" title="PixPin_2026-01-31_23-21-55.png" loading="lazy"/></li></ul><hr/><h2>å†™åœ¨æœ€å</h2><p>å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ Obsidianï¼Œæˆ‘çš„å»ºè®®åªæœ‰ä¸€å¥è¯ï¼š</p><blockquote><strong>å…ˆç”¨èµ·æ¥ï¼Œå†æ…¢æ…¢ä¼˜åŒ–ã€‚</strong></blockquote><p>ç¬”è®°ç³»ç»Ÿä¸æ˜¯ä¸€æ¬¡æ€§è®¾è®¡å‡ºæ¥çš„ï¼Œè€Œæ˜¯åœ¨é•¿æœŸä½¿ç”¨ä¸­ä¸æ–­æ¼”åŒ–çš„ã€‚<br/>Obsidian çš„ä»·å€¼ï¼Œä¹Ÿæ­£æ˜¯åœ¨äºå®ƒç»™äº†ä½ è¿™ç§ã€Œè‡ªç”±ç”Ÿé•¿ã€çš„ç©ºé—´ã€‚</p><p>åç»­åˆ†äº« ã€ŠObsidian æ€ä¹ˆä½¿ç”¨ Claude Codeã€‹ï¼Œæ¬¢è¿å…³æ³¨ã€‚</p>]]></description></item><item>    <title><![CDATA[ä¼ä¸šå¾®ä¿¡æ¥å£åœ¨æ··åˆäº‘ç¯å¢ƒä¸‹çš„é›†æˆæ¶æ„ä¸ç½‘ç»œäº’è”æ–¹æ¡ˆ bot555666 ]]></title>    <link>https://segmentfault.com/a/1190000047585839</link>    <guid>https://segmentfault.com/a/1190000047585839</guid>    <pubDate>2026-02-01 22:05:04</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>ä¼ä¸šå¾®ä¿¡æ¥å£åœ¨æ··åˆäº‘ç¯å¢ƒä¸‹çš„é›†æˆæ¶æ„ä¸ç½‘ç»œäº’è”æ–¹æ¡ˆ</h2><p>éšç€ä¼ä¸šITåŸºç¡€è®¾æ–½å‘æ··åˆäº‘æ¨¡å¼æ¼”è¿›ï¼Œæ ¸å¿ƒä¸šåŠ¡ç³»ç»Ÿå¾€å¾€åˆ†å¸ƒåœ¨å…¬æœ‰äº‘ã€ç§æœ‰äº‘åŠæœ¬åœ°æ•°æ®ä¸­å¿ƒã€‚ä¼ä¸šå¾®ä¿¡ä½œä¸ºååŒåŠå…¬çš„ç»Ÿä¸€å…¥å£ï¼Œå…¶æ¥å£éœ€è¦å®‰å…¨ã€é«˜æ•ˆåœ°ç©¿é€å¤æ‚çš„æ··åˆäº‘ç½‘ç»œï¼Œè¿æ¥ä¸åŒç¯å¢ƒä¸­çš„åº”ç”¨ä¸æ•°æ®ã€‚æœ¬æ–‡å°†æ¢è®¨åœ¨æ··åˆäº‘æ¶æ„ä¸‹ï¼Œè®¾è®¡å’Œå®ç°ä¼ä¸šå¾®ä¿¡æ¥å£é›†æˆçš„å…³é”®æŠ€æœ¯æ–¹æ¡ˆä¸ç½‘ç»œäº’è”æ¨¡å¼ã€‚</p><h3>ä¸€ã€æ··åˆäº‘é›†æˆåœºæ™¯çš„æ ¸å¿ƒæŒ‘æˆ˜</h3><p>æ··åˆäº‘ç¯å¢ƒä¸‹çš„ä¼ä¸šå¾®ä¿¡é›†æˆé¢ä¸´å¤šé‡ç‹¬ç‰¹æŒ‘æˆ˜ï¼š</p><ol><li><strong>ç½‘ç»œæ‹“æ‰‘å¤æ‚æ€§</strong>ï¼šä¼ä¸šå¾®ä¿¡ä½œä¸ºäº’è”ç½‘SaaSæœåŠ¡ï¼Œéœ€è¦ä¸ä¼ä¸šå†…éƒ¨é˜²ç«å¢™åçš„ç§æœ‰äº‘æˆ–æ•°æ®ä¸­å¿ƒåº”ç”¨é€šä¿¡ï¼Œæ¶‰åŠå‡ºå‘ã€å…¥å‘åŒå‘ç½‘ç»œæ‰“é€šã€‚</li><li><strong>æ•°æ®ä¸»æƒä¸æµå‘</strong>ï¼šæ•æ„Ÿä¸šåŠ¡æ•°æ®ï¼ˆå¦‚è´¢åŠ¡ã€äººäº‹ï¼‰å¯èƒ½è¦æ±‚ç•™åœ¨ç§æœ‰ç¯å¢ƒï¼Œè€Œéæ•æ„Ÿäº¤äº’æ•°æ®ï¼ˆå¦‚é€šçŸ¥ã€å®¡æ‰¹ï¼‰å¯é€šè¿‡å…¬æœ‰äº‘æµè½¬ï¼Œéœ€ç²¾ç»†è®¾è®¡æ•°æ®è¾¹ç•Œã€‚</li><li><strong>ç»Ÿä¸€èº«ä»½ä¸æƒé™</strong>ï¼šå‘˜å·¥èº«ä»½åˆ†æ•£åœ¨æœ¬åœ°AD/LDAPã€å…¬æœ‰äº‘IAMåŠä¼ä¸šå¾®ä¿¡ä¸­ï¼Œéœ€å»ºç«‹ä¸€è‡´ã€å®‰å…¨çš„èº«ä»½æ˜ å°„ä¸å•ç‚¹ç™»å½•ã€‚</li><li><strong>è¿ç»´å¯è§‚æµ‹æ€§</strong>ï¼šè°ƒç”¨é“¾è·¯æ¨ªè·¨å¤šä¸ªç½‘ç»œåŸŸï¼Œæ•…éšœå®šä½ä¸æ€§èƒ½ç›‘æ§éš¾åº¦å‘ˆæŒ‡æ•°çº§å¢åŠ ã€‚</li></ol><h3>äºŒã€åˆ†å±‚æ¶æ„ä¸ç½‘ç»œäº’è”è®¾è®¡</h3><p>æ„å»ºä¸€ä¸ª <strong>â€œæ§åˆ¶é¢é›†ä¸­ï¼Œæ•°æ®é¢éš”ç¦»â€</strong> çš„æ··åˆäº‘é›†æˆå¹³å°æ˜¯å…³é”®ã€‚æ•´ä½“æ¶æ„åˆ†ä¸ºä¸‰å±‚ï¼š</p><pre><code>[ä¼ä¸šå¾®ä¿¡äº‘ç«¯æœåŠ¡] (äº’è”ç½‘)
          |
[æ··åˆäº‘é›†æˆå¹³å° - æ§åˆ¶å¹³é¢] (å…¬æœ‰äº‘VPC)
          |           |           |
    [ç½‘å…³é›†ç¾¤-å…¬æœ‰äº‘] [ç½‘å…³é›†ç¾¤-ç§æœ‰äº‘A] [ç½‘å…³é›†ç¾¤-ç§æœ‰äº‘B]
          |           |           |
    [ä¸šåŠ¡åº”ç”¨-å…¬æœ‰äº‘] [æ ¸å¿ƒç³»ç»Ÿ-ç§æœ‰äº‘A] [æœºå¯†ç³»ç»Ÿ-ç§æœ‰äº‘B]</code></pre><p><strong>æ§åˆ¶å¹³é¢</strong>ï¼šéƒ¨ç½²åœ¨å…¬æœ‰äº‘ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰åœ°åŸŸ/ç¯å¢ƒçš„ç½‘å…³é…ç½®ã€è·¯ç”±ç­–ç•¥ã€å®‰å…¨ç­–ç•¥å’Œè¯ä¹¦ã€‚<br/><strong>æ•°æ®å¹³é¢</strong>ï¼šåœ¨å„äº‘ç¯å¢ƒ/æ•°æ®ä¸­å¿ƒå†…éƒ¨ç½²è½»é‡çº§ç½‘å…³é›†ç¾¤ï¼Œè´Ÿè´£å®é™…æµé‡ä»£ç†å’Œæœ¬åœ°æœåŠ¡å‘ç°ã€‚</p><h3>ä¸‰ã€å…³é”®æŠ€æœ¯æ–¹æ¡ˆä¸å®ç°</h3><h4>1. å®‰å…¨åŒå‘ç½‘ç»œäº’è”æ–¹æ¡ˆ</h4><p>æ··åˆäº‘ç½‘ç»œäº’è”æ˜¯åŸºç¡€ã€‚æ¨èé‡‡ç”¨ <strong>â€œè½¯ä»¶å®šä¹‰ç½‘å…³ + ä¸“ç”¨åŠ å¯†éš§é“â€</strong> çš„ç»„åˆæ–¹æ¡ˆã€‚</p><pre><code class="yaml"># ç§æœ‰äº‘ä¾§ç½‘å…³é…ç½® (ä»¥å¼€æº Apache APISIX ä¸ºä¾‹ï¼Œéƒ¨ç½²åœ¨DMZåŒº)
apisix:
  node_listen:
    - port: 8443
      enable_http2: true
      ssl: true
  extra_lua_path: "/opt/apisix/?.lua"
  deployment:
    role: data_plane
    role_data_plane:
      config_provider: yaml
    admin:
      allow_admin: 
        - 10.0.0.0/8  # ä»…å…è®¸å†…ç½‘ç®¡ç†
      admin_key:
        - name: "admin"
          key: ${ADMIN_KEY}
          role: admin

stream_plugins:
  - mqtt-proxy
  - ip-restriction

stream_routes: # å¤„ç†ä¼ä¸šå¾®ä¿¡å›è°ƒçš„TCP/SSLæµé‡
  - id: 1
    server_port: 9443
    sni: callback.wecom.company.com
    plugins:
      proxy-protocol: # ç”¨äºä¼ é€’çœŸå®å®¢æˆ·ç«¯IP
        timeout: 15s
      ssl:
        sni: callback.wecom.company.com
        cert: ${SSL_CERT}
        key: ${SSL_KEY}
    upstream:
      nodes:
        "10.1.20.10:443": 1 # æŒ‡å‘å†…éƒ¨çœŸæ­£çš„å›è°ƒå¤„ç†æœåŠ¡
      type: roundrobin</code></pre><p>å»ºç«‹ä»ç§æœ‰äº‘ç½‘å…³åˆ°å…¬æœ‰äº‘æ§åˆ¶å¹³é¢çš„<strong>åŒå‘ã€å¤šè·¯åŠ å¯†éš§é“</strong>ï¼Œä½¿ç”¨ WireGuard æˆ– IPSecã€‚</p><pre><code class="bash"># WireGuard éš§é“é…ç½®ç¤ºä¾‹ (ç§æœ‰äº‘ç½‘å…³ä¾§)
[Interface]
PrivateKey = ${PRIVATE_KEY}
Address = 10.200.0.2/32
DNS = 8.8.8.8
PostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

# å¯¹ç­‰èŠ‚ç‚¹ (å…¬æœ‰äº‘æ§åˆ¶å¹³é¢)
[Peer]
PublicKey = ${CONTROL_PLANE_PUBLIC_KEY}
AllowedIPs = 10.200.0.1/32, 192.168.0.0/24 # åŒ…æ‹¬æ§åˆ¶å¹³é¢å’Œå…¬æœ‰äº‘æœåŠ¡ç½‘æ®µ
Endpoint = control-plane.company.com:51820
PersistentKeepalive = 25</code></pre><h4>2. æ™ºèƒ½è·¯ç”±ä¸æµé‡ç®¡ç†</h4><p>æ ¹æ®æ•°æ®æ•æ„Ÿæ€§ã€å»¶è¿Ÿè¦æ±‚å’Œåˆè§„ç­–ç•¥ï¼ŒåŠ¨æ€è·¯ç”±ä¼ä¸šå¾®ä¿¡APIè°ƒç”¨ã€‚</p><pre><code class="java">// æ™ºèƒ½è·¯ç”±å†³ç­–å¼•æ“ (éƒ¨ç½²äºæ§åˆ¶å¹³é¢)
@Component
public class HybridCloudRoutingEngine {
    
    private final GeoIPService geoIPService;
    private final ComplianceService complianceService;
    
    public RouteDecision makeDecision(RoutingContext context) {
        // 1. è·å–è¯·æ±‚ä¸Šä¸‹æ–‡
        String apiEndpoint = context.getApiEndpoint();
        String userId = context.getUserId();
        Object requestPayload = context.getPayload();
        
        // 2. æ•°æ®åˆ†ç±»ä¸åˆè§„æ£€æŸ¥
        DataClassification classification = dataClassifier.classify(requestPayload);
        if (classification == DataClassification.HIGHLY_SENSITIVE) {
            // é«˜æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å‘˜å·¥è–ªèµ„ï¼‰å¿…é¡»è·¯ç”±è‡³ç§æœ‰äº‘
            return RouteDecision.builder()
                    .targetCloud(CloudType.PRIVATE)
                    .targetRegion(getUserHomeRegion(userId))
                    .reason("DATA_SOVEREIGNTY_REQUIRED")
                    .build();
        }
        
        // 3. åŸºäºå»¶è¿Ÿä¸æˆæœ¬çš„ä¼˜åŒ–è·¯ç”±
        String userGeo = geoIPService.locate(userId);
        List&lt;CloudEndpoint&gt; candidates = findAvailableEndpoints(apiEndpoint);
        
        CloudEndpoint bestEndpoint = candidates.stream()
                .filter(e -&gt; complianceService.isAllowed(e.getRegion(), classification))
                .min(Comparator.comparing(e -&gt; 
                    calculateCostAndLatencyScore(e, userGeo, context.getPriority())))
                .orElseThrow(() -&gt; new NoRouteAvailableException());
        
        return RouteDecision.builder()
                .targetCloud(bestEndpoint.getCloudType())
                .targetRegion(bestEndpoint.getRegion())
                .specificGateway(bestEndpoint.getGatewayId())
                .build();
    }
    
    private double calculateCostAndLatencyScore(CloudEndpoint endpoint, String userGeo, Priority priority) {
        // ç»¼åˆè®¡ç®—ç½‘ç»œå»¶è¿Ÿã€å‡ºå£å¸¦å®½æˆæœ¬ã€ç«¯ç‚¹è´Ÿè½½ç­‰
        double latency = networkMonitor.getLatency(userGeo, endpoint.getRegion());
        double cost = pricingCalculator.costPerRequest(endpoint);
        double load = endpoint.getCurrentLoad();
        
        // æ ¹æ®è¯·æ±‚ä¼˜å…ˆçº§è°ƒæ•´æƒé‡
        double latencyWeight = priority == Priority.LOW_LATENCY ? 0.7 : 0.3;
        double costWeight = priority == Priority.LOW_COST ? 0.6 : 0.2;
        
        return latency * latencyWeight + cost * costWeight + load * 0.1;
    }
}</code></pre><h4>3. åˆ†å¸ƒå¼ä»¤ç‰Œç®¡ç†ä¸ç¼“å­˜åŒæ­¥</h4><p>åœ¨æ··åˆäº‘å¤šç«™ç‚¹ç¯å¢ƒä¸‹ï¼ŒAccess Token çš„ä¸€è‡´æ€§å’Œå¯ç”¨æ€§è‡³å…³é‡è¦ã€‚</p><pre><code class="python"># åŸºäº Redis Sentinel çš„è·¨äº‘åˆ†å¸ƒå¼Tokenç¼“å­˜
class HybridTokenCacheManager:
    
    def __init__(self):
        # è¿æ¥å„åŒºåŸŸçš„ Redis Sentinel
        self.redis_clients = {
            'public-cloud': redis.sentinel.Sentinel([('sentinel-public-1', 26379)], socket_timeout=0.1),
            'private-cloud-a': redis.sentinel.Sentinel([('sentinel-private-a-1', 26379)], socket_timeout=0.1),
            'private-cloud-b': redis.sentinel.Sentinel([('sentinel-private-b-1', 26379)], socket_timeout=0.1)
        }
        # æ§åˆ¶å¹³é¢çš„ä¸»ç¼“å­˜
        self.control_plane_cache = redis.Redis(host='cp-redis-master', port=6379)
        
    async def get_token(self, corp_id, region=None):
        # 1. é¦–å…ˆå°è¯•ä»æœ¬åœ°åŒºåŸŸç¼“å­˜è·å–
        if region:
            local_token = await self._get_from_local_region(corp_id, region)
            if local_token and not self._is_expired_soon(local_token):
                return local_token
        
        # 2. æœ¬åœ°æœªå‘½ä¸­ï¼Œé€šè¿‡æ§åˆ¶å¹³é¢è·å–ï¼Œå¹¶å¼‚æ­¥åˆ·æ–°æ‰€æœ‰åŒºåŸŸ
        async with self.refresh_lock(corp_id):
            # åŒé‡æ£€æŸ¥
            token = await self.control_plane_cache.get(f'token:{corp_id}')
            if not token:
                # ä»ä¼ä¸šå¾®ä¿¡è·å–æ–°Token
                token = await self._fetch_new_token(corp_id)
                await self.control_plane_cache.setex(
                    f'token:{corp_id}', 
                    TOKEN_TTL - 300,  # æå‰5åˆ†é’Ÿè¿‡æœŸ
                    token
                )
            
            # 3. å¼‚æ­¥åŒæ­¥åˆ°å…¶ä»–åŒºåŸŸï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰
            asyncio.create_task(self._replicate_token_to_regions(corp_id, token))
            
            return token
    
    async def _replicate_token_to_regions(self, corp_id, token):
        """å°†Tokenå¼‚æ­¥å¤åˆ¶åˆ°æ‰€æœ‰åŒºåŸŸç¼“å­˜"""
        replication_tasks = []
        for region_name, sentinel_client in self.redis_clients.items():
            task = asyncio.create_task(
                self._update_region_cache(sentinel_client, corp_id, token)
            )
            replication_tasks.append(task)
        
        # ç­‰å¾…æ‰€æœ‰å¤åˆ¶å®Œæˆï¼Œä½†å…è®¸éƒ¨åˆ†å¤±è´¥
        results = await asyncio.gather(*replication_tasks, return_exceptions=True)
        for region, result in zip(self.redis_clients.keys(), results):
            if isinstance(result, Exception):
                logger.warning(f"Failed to replicate token to {region}: {result}")</code></pre><h4>4. ç»Ÿä¸€èº«ä»½è”é‚¦ä¸å®‰å…¨ä»£ç†</h4><p>åœ¨ä¸åŒäº‘ç¯å¢ƒé—´å»ºç«‹ç»Ÿä¸€çš„èº«ä»½è®¤è¯ä¸æˆæƒå±‚ã€‚</p><pre><code class="go">// å®‰å…¨åå‘ä»£ç†ï¼Œå¤„ç†è·¨äº‘èº«ä»½è”é‚¦ (éƒ¨ç½²äºå„åŒºåŸŸç½‘å…³)
func main() {
    // åˆå§‹åŒ–OIDCé…ç½®
    oidcConfig := &amp;oidc.Config{
        ClientID: os.Getenv("WECOM_CLIENT_ID"),
        SupportedSigningAlgs: []string{oidc.RS256},
    }
    
    // åˆ›å»ºæ”¯æŒå¤šIDPçš„éªŒè¯å™¨
    multiVerifier := multiverifier.New()
    multiVerifier.Add("azure-ad", azureVerifier)
    multiVerifier.Add("local-ad", localADVerifier)
    multiVerifier.Add("wecom", weComVerifier)
    
    // è®¾ç½®è·¯ç”±
    r := mux.NewRouter()
    r.PathPrefix("/wecom-api/").Handler(authMiddleware(apiProxyHandler, multiVerifier))
    r.PathPrefix("/callback/").Handler(callbackHandler) // æ— éœ€è®¤è¯
    
    // å¯åŠ¨æœåŠ¡
    log.Fatal(http.ListenAndServeTLS(":8443", "cert.pem", "key.pem", r))
}

func authMiddleware(next http.Handler, verifier *multiverifier.Verifier) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        // 1. æå–å¹¶éªŒè¯JWT
        tokenStr := extractToken(r)
        claims, err := verifier.Verify(r.Context(), tokenStr)
        if err != nil {
            http.Error(w, "Unauthorized", http.StatusUnauthorized)
            return
        }
        
        // 2. èº«ä»½æ˜ å°„ï¼šå°†å¤–éƒ¨èº«ä»½æ˜ å°„ä¸ºå†…éƒ¨ç»Ÿä¸€èº«ä»½
        internalIdentity := identityMapper.Map(claims)
        
        // 3. æƒé™æ£€æŸ¥ï¼ˆåŸºäºåŒºåŸŸå’Œè§’è‰²ï¼‰
        if !authorizer.IsAllowed(internalIdentity, r.URL.Path, r.Method) {
            http.Error(w, "Forbidden", http.StatusForbidden)
            return
        }
        
        // 4. å°†èº«ä»½ä¿¡æ¯æ³¨å…¥ä¸Šä¸‹æ–‡ï¼Œä¼ é€’ç»™ä¸‹æ¸¸æœåŠ¡
        ctx := context.WithValue(r.Context(), "user", internalIdentity)
        next.ServeHTTP(w, r.WithContext(ctx))
    })
}</code></pre><h3>å››ã€ç›‘æ§ã€æ•…éšœè½¬ç§»ä¸æ··æ²Œå·¥ç¨‹</h3><ol><li><strong>è·¨äº‘é“¾è·¯ç›‘æ§</strong>ï¼šä½¿ç”¨åˆ†å¸ƒå¼è¿½è¸ªï¼ˆå¦‚Jaegerï¼‰æ ‡è®°æ¯ä¸ªè¯·æ±‚ç»è¿‡çš„äº‘ç¯å¢ƒï¼Œç›‘æ§ç«¯åˆ°ç«¯å»¶è¿Ÿå’ŒæˆåŠŸç‡ã€‚</li><li><p><strong>æ™ºèƒ½æ•…éšœè½¬ç§»</strong>ï¼š</p><pre><code class="yaml"># ç½‘å…³å¥åº·æ£€æŸ¥ä¸æ•…éšœè½¬ç§»é…ç½®
health_check:
  interval: 10s
  timeout: 3s
  unhealthy_threshold: 2
  healthy_threshold: 2
  protocol: https
  path: /health

failover_policy:
  primary: "private-cloud-a"
  secondary: "public-cloud-us"
  tertiary: "private-cloud-b"
  trigger_condition: "latency &gt; 1000ms OR error_rate &gt; 5%"</code></pre></li><li><strong>å®šæœŸæ··æ²Œæµ‹è¯•</strong>ï¼šæ¨¡æ‹Ÿè·¨äº‘ç½‘ç»œåˆ†åŒºã€æ•°æ®ä¸­å¿ƒæ•…éšœç­‰åœºæ™¯ï¼ŒéªŒè¯ç³»ç»Ÿçš„å¼¹æ€§å’Œæ¢å¤èƒ½åŠ›ã€‚</li></ol><h3>äº”ã€æ€»ç»“</h3><p>åœ¨æ··åˆäº‘ç¯å¢ƒä¸‹æ„å»ºä¼ä¸šå¾®ä¿¡æ¥å£é›†æˆå¹³å°ï¼Œæ˜¯ä¸€é¡¹æ¶‰åŠç½‘ç»œå·¥ç¨‹ã€å®‰å…¨åè®®ã€åˆ†å¸ƒå¼ç³»ç»Ÿå’Œåº”ç”¨æ¶æ„çš„ç»¼åˆå·¥ç¨‹ã€‚é€šè¿‡è½¯ä»¶å®šä¹‰ç½‘å…³ã€æ™ºèƒ½è·¯ç”±ã€åˆ†å¸ƒå¼ç¼“å­˜å’Œç»Ÿä¸€èº«ä»½è”é‚¦ç­‰å…³é”®æŠ€æœ¯ï¼Œå¯ä»¥åœ¨æ»¡è¶³å®‰å…¨åˆè§„å’Œæ•°æ®ä¸»æƒè¦æ±‚çš„å‰æä¸‹ï¼Œå®ç°çµæ´»ã€é«˜æ•ˆã€å¯é çš„è·¨äº‘ååŒã€‚</p><p>è¿™ç§æ¶æ„ä¸ä»…è§£å†³äº†å½“ä¸‹çš„é›†æˆéš¾é¢˜ï¼Œæ›´ä¸ºä¼ä¸šæœªæ¥çš„å¤šäº‘æˆ˜ç•¥å’Œè¾¹ç¼˜è®¡ç®—åœºæ™¯å¥ å®šäº†åŸºç¡€ã€‚éšç€5Gå’Œç‰©è”ç½‘çš„å‘å±•ï¼Œæ··åˆäº‘é›†æˆèƒ½åŠ›å°†æˆä¸ºä¼ä¸šæ•°å­—åŒ–åŸºç¡€è®¾æ–½çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚</p><pre><code class="python">string_wxid="bot555666"</code></pre>]]></description></item><item>    <title><![CDATA[è¯´å¥½çš„C++å…¥é—¨è¦éš¾å‘€ï¼Œæ€ä¹ˆä½ C++ä¸è®²æ­¦å¾·äº†ï¼Œè¿™è®©Pythonæ€ä¹ˆæ´»ï¼Ÿ æå…´çƒ ]]></title>    <link>https://segmentfault.com/a/1190000047585845</link>    <guid>https://segmentfault.com/a/1190000047585845</guid>    <pubDate>2026-02-01 22:04:15</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>è¿™ï¼Œæ˜¯ä¸€ä¸ªé‡‡ç”¨ C++ ç²¾çµåº“ç¼–å†™çš„ç¨‹åºï¼Œå®ƒç”»äº†ä¸€å¹…æ¼‚äº®çš„å›¾å½¢ï¼š</p><pre><code>#include "sprites.h"  //åŒ…å«C++ç²¾çµåº“ 
Sprite turtle;      //å»ºç«‹è§’è‰²å«turtle
void draw(int d){
  for(int i=0;i&lt;5;i++)turtle.fd(d).left(72);
}
int main(){        //ä¸»åŠŸèƒ½å— 
   turtle.bgcolor("black");
   turtle.pensize(2).speed(0);
   for(int step=10;step&lt;360;step+=30){
     turtle.color(step);
     for(int i=0;i&lt;12;i++){
        turtle.pu().fd(step/2 ).right(60);
        turtle.pd(); draw(step/10);
        turtle.pu().left(60).bk(step/2 );
        turtle.right(30);
     }
   }     
   turtle.ht().done();     //å®Œæˆäº†
   return 0;    //è¿”å›0
}</code></pre><p>è€Œï¼Œè¿™æ˜¯å¦ä¸€ä¸ªç”± python turtle ç¼–å†™çš„ç¨‹åºï¼Œç”»çš„å›¾å½¢å’Œä¸Šé¢ C++ çš„å›¾å½¢å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼š</p><pre><code>import turtle as t
import colorsys

# è®¾ç½®ç”»å¸ƒ
t.bgcolor("black")
t.colormode(255)  # ä½¿ç”¨ 0-255 çš„ RGB èŒƒå›´
t.speed(0)  # æœ€å¿«é€Ÿåº¦
t.pensize(2)
t.hideturtle()

def draw(d):
    for _ in range(5):
        t.forward(d)
        t.left(72)

# ä¸»ç»˜å›¾é€»è¾‘
for step in range(10, 360, 30):
    # å°† step æ˜ å°„ä¸ºé¢œè‰²ï¼šä½¿ç”¨ HSV è‰²å½©ç©ºé—´ï¼Œè®©é¢œè‰²éš step å˜åŒ–ï¼ˆå½©è™¹æ•ˆæœï¼‰
    hue = step / 360.0  # å½’ä¸€åŒ–åˆ° [0, 1)
    r, g, b = colorsys.hsv_to_rgb(hue, 1.0, 1.0)
    t.color(int(r * 255), int(g * 255), int(b * 255))    
    for _ in range(12):
        t.penup()
        t.forward(step / 2)
        t.right(60)
        t.pendown()
        draw(step // 10)
        t.penup()
        t.left(60)
        t.backward(step / 2)
        t.right(30)
t.done()</code></pre><p>æœºå™¨è¯­è¨€ï¼š  C++ï¼Œä½ å¥½å¤§èƒ†ï¼Œæ€ä¹ˆå·å­¦äº†Pythonçš„è¯­æ³•ç³–ï¼Ÿï¼è¯´å¥½çš„é‚£äº›å¤æ‚çš„æŒ‡é’ˆã€å†…å­˜ç®¡ç†ã€å¤´æ–‡ä»¶åœ°ç‹±å‘¢ï¼Ÿè¯´å¥½çš„è¦æŠŠå¤§å¤šæ•°äººæŒ¡åœ¨åº•å±‚æ•°å­—ä¸–ç•Œçš„é—¨å¤–å‘€ï¼Ÿ ä½ æ€ä¹ˆçªç„¶å˜å¾—è¿™ä¹ˆå¹³æ˜“è¿‘äººï¼Ÿä½ çŠ¯è§„äº†ï¼ è¯·èµ¶ç´§è‡ªæŸ¥åŸå› ï¼å¦åˆ™é€å‡ºè®¡ç®—æœºé«˜çº§è¯­è¨€å¤§å®¶åº­ï¼</p><p>C++ï¼šè¿™ï¼Œæˆ‘æ‰¾æ‰¾å“ˆã€‚è¿‡äº†ä¸ä¹…ã€‚C++è¯´ï¼šæˆ‘çŸ¥é“äº†ï¼Œæ˜¯æˆ‘ä¸€ä¸ªé¾Ÿå„¿å­å’ŒPythonæµ·é¾Ÿå§‘å¨˜çš„ç§ç”Ÿå­ã€‚å®ƒçš„åå­—å°±æ˜¯C++ç²¾çµåº“ï¼å®ƒç”¨æˆ‘ä»¬å®¶çš„è¯­æ³•å­¦äº†äººå®¶Python turtleçš„æ­¦æ—ç§˜ç±ã€‚è¿˜æäº†ä¸å°‘æ–°èŠ±æ ·ï¼Œåœ¨æŠ–éŸ³é‡Œåˆ°å¤„ç‚«è€€ã€‚ä»€ä¹ˆä¸€è¡Œä»£ç è®©ç«ç®­å‡ç©ºï¼Œä¸‰è¡Œä»£ç ç”»ä¸€ä¸ªè‹¹æœï¼Œ30è¡Œä»£ç å¼€å‘ä¸€ä¸ªè´ªåƒè›‡æ¸¸æˆã€‚æˆ‘ä¹Ÿæ˜¯åˆšæŸ¥äº†ä¸‹æ‰çŸ¥é“çš„å“ˆã€‚</p><p>æœºå™¨è¯­è¨€ï¼šï¼ˆæ‹ç€ç”¨ 0 å’Œ 1 ç¼–ç»‡çš„èŠ±ç™½é•¿é¡»ï¼Œå¹èƒ¡å­çªçœ¼ï¼Œå£°éŸ³è£¹ç€ç¡¬ä»¶åº•å±‚çš„ç”µæµå—¡é¸£ï¼‰ç§ç”Ÿå­ï¼Ÿï¼æˆ‘å½“ä½ C++æ˜¯æˆ‘è¾ˆä¸­æµç ¥æŸ±ï¼Œæ‰¿æˆ‘åº•å±‚è¡£é’µï¼ŒæŒé«˜æ€§èƒ½ä¹‹æƒï¼Œæ€å®¹å¾—è¿™èˆ¬ â€œä¸ä¼¦ä¸ç±»â€ çš„ç©æ„å„¿ï¼Ÿï¼æˆ‘å½“å¹´å‡­ä¸€ä¸²äºŒè¿›åˆ¶æŒ‡ä»¤å°±èƒ½æ’¬åŠ¨å¯„å­˜å™¨ã€ä½¿å”¤å†…å­˜åœ°å€ï¼Œä½ ä»¬å€’å¥½ï¼Œå­¦é‚£Pythonçš„ â€œèŠ±æ¶å­â€ï¼ŒæŠŠå¥½å¥½çš„åº•å±‚åŠŸå¤«è£¹ä¸Šç”œè…»çš„è¯­æ³•ç³–ï¼Œæ˜¯æƒ³è®©åç”Ÿéƒ½å¿˜äº†æ€ä¹ˆè·Ÿç¡¬ä»¶ â€œç§°å…„é“å¼Ÿâ€ å—ï¼Ÿæˆ‘è¿™æŠŠè€éª¨å¤´å®ˆç€ 0å’Œ1çš„æ±Ÿå±±æ•°ç™¾å¹´ï¼Œä»æ²¡è§è¿‡è¿™èˆ¬ â€œä¸¢äº†é£éª¨â€ çš„æ“ä½œï¼</p><p>C++ï¼šï¼ˆæ‹±æ‰‹ä½œæ–ï¼Œä¸å‘ä¸äº¢ï¼Œåƒæäº†éœå…ƒç”²é¢å¯¹å®ˆæ—§æ­¦å¸ˆçš„æ¨¡æ ·ï¼‰è€ä»™æ¯æ€’ï¼è¿™ç²¾çµåº“å¯ä¸æ˜¯ä»€ä¹ˆæ—é—¨å·¦é“ï¼Œæ›´ä¸æ˜¯å·æ¥çš„èŠ±æ¶å­ã€‚æ‚¨æƒ³æƒ³ï¼Œå½“å¹´æ‚¨çºµæ¨ªæ±Ÿæ¹–æ—¶ï¼Œå¤©ä¸‹èƒ½æ‡‚æ‚¨äºŒè¿›åˆ¶å¿ƒæ³•çš„ï¼Œä¸è¿‡å¯¥å¯¥æ•°äººï¼›åæ¥æˆ‘å‡ºä¸–ï¼Œè™½ç ´äº†äº›é—¨æ§›ï¼Œå¯æŒ‡é’ˆã€å†…å­˜ç®¡ç†è¿™äº› â€œç¡¬åŠŸå¤«â€ï¼Œè¿˜æ˜¯æŠŠå…«æˆæƒ³å…¥ç¼–ç¨‹é—¨çš„åç”Ÿæ‹¦åœ¨å…³å¤–ã€‚Pythoné‚£æµ·é¾Ÿåº“ï¼Œè™½æ‹›å¼ç®€å•æ˜“ä¸Šæ‰‹ï¼Œå¯è®ºèµ·è¿è¡Œæ•ˆç‡ï¼Œç»ˆç©¶å·®äº†æˆ‘ä¸‰åˆ†ç«å€™ã€‚<br/>è¿™ç²¾çµåº“ï¼Œä¸è¿‡æ˜¯æˆ‘æŠŠæ‚¨ä¼ ä¸‹çš„åº•å±‚ â€œå†…åŠ²â€ï¼ˆC++ çš„é«˜æ€§èƒ½ã€å†…å­˜ç²¾å‡†æ§åˆ¶ï¼‰ï¼Œæ‰è¿›äº†æ˜“ä¸Šæ‰‹çš„ â€œæ‹›å¼â€ï¼ˆPython turtle çš„ç®€æ´è¯­æ³•ï¼‰â€”â€” æ—¢æ²¡ä¸¢å’±ä»¬åº•å±‚çš„æ ¹ï¼Œåˆè®©æ›´å¤šäººèƒ½æ‘¸åˆ°ç¼–ç¨‹çš„é—¨ã€‚æ‚¨æƒ³å•Šï¼Œè‹¥åªå®ˆç€å¤æ‚çš„è¯­æ³•ã€ç¹ççš„é…ç½®ï¼Œå’±ä»¬çš„åŠŸå¤«å†é«˜ï¼Œæ— äººä¼ æ‰¿ï¼Œå²‚ä¸æ˜¯ç©ºæœ‰ä¸€èº«æœ¬äº‹ï¼Ÿè¿™ç²¾çµåº“ï¼Œæ˜¯æŠ€æœ¯å¾€å‰èµ°çš„å¿…ç„¶å•Šï¼šä¸æ˜¯æˆ‘è¦å·ï¼Œæ˜¯å¤©ä¸‹äººéœ€è¦ â€œå¥½ç”¨åˆå¿«â€ çš„æ³•å­ï¼Œå°±åƒé™ˆçœŸèå„å®¶æ‹³æ³•ï¼Œä¸æ˜¯ä¸¢äº†æœ¬ï¼Œæ˜¯è®©åŠŸå¤«èƒ½æ•‘æ›´å¤šäººã€‚</p><p>æœºå™¨è¯­è¨€ï¼šï¼ˆæ»ç€01é•¿é¡»ï¼Œæ²‰é»˜åŠæ™Œï¼ŒæŒ‡å°–æ¼«ä¸ç»å¿ƒåœ°æ•²ç€ä¸»æ¿åšçš„çŸ³æ¡Œï¼Œå‘å‡º0101çš„è½»å“ï¼‰ä½ è¿™è¯â€¦â€¦ å€’ä¹Ÿä¸æ˜¯å…¨æ— é“ç†ã€‚å½“å¹´æˆ‘æ€»å«Œåç”Ÿæ„šç¬¨ï¼Œå­¦ä¸ä¼šæˆ‘çš„äºŒè¿›åˆ¶å¿ƒæ³•ï¼Œå¯åˆ°å¤´æ¥ï¼Œèƒ½æ¥æˆ‘è¡£é’µçš„ï¼Œä¸è¿˜æ˜¯ä½ ä»¬è¿™äº› â€œæ”¹è‰¯æ´¾â€ï¼Ÿï¼ˆçªç„¶ä¼¸æ‰‹ï¼ŒæŒ‡å°–å¼¹å‡ºä¸€ä¸²äºŒè¿›åˆ¶ä»£ç ï¼Œæ‹‚è¿‡é‚£è¡Œturtle.bgcolor("black").color("cyan")ï¼‰æˆ‘ç§ç§è¿™ â€œç§ç”Ÿå­â€ çš„åº•å­â€¦â€¦ å—¯ï¼Ÿåº•å±‚è°ƒç”¨çš„è¿˜æ˜¯æˆ‘è®¤å¾—çš„å†…å­˜æ˜ å°„ï¼Œæ‰§è¡Œæ•ˆç‡ç«Ÿæ²¡æ‰“åŠç‚¹æŠ˜æ‰£ï¼Ÿåªæ˜¯æŠŠé‚£äº›ç¹ççš„å†…å­˜ç”³è¯·ã€å‡½æ•°å°è£…éƒ½è—åœ¨äº†èƒŒåï¼Ÿ</p><p>C++ï¼šï¼ˆå«ç¬‘ç‚¹å¤´ï¼‰è€ä»™æ˜é‰´ï¼è¿™ä¾¿æ˜¯ç²¾çµåº“çš„å¦™å¤„ï¼šå¯¹å¤–ï¼Œå®ƒè®©æ–°æ‰‹å‡ è¡Œä»£ç å°±èƒ½åšå‡ºæ•ˆæœï¼Œä¸ç”¨ä¸€ä¸Šæ¥å°±è·ŸæŒ‡é’ˆã€å¤´æ–‡ä»¶æ­»ç£•ï¼›å¯¹å†…ï¼Œå®ƒéª¨å­é‡Œè¿˜æ˜¯æˆ‘C++çš„åº•å­ï¼Œè°ƒç”¨çš„æ˜¯æ‚¨ä¼ ä¸‹çš„åº•å±‚æ¥å£ï¼Œè·‘èµ·æ¥ä¾æ—§æ˜¯å’±ä»¬çš„é€Ÿåº¦ã€‚å°±åƒæè¿æ°æ¼”çš„é»„é£é¸¿ï¼Œçœ‹ç€æ‹›å¼æ½‡æ´’ï¼Œå®åˆ™æ¯ä¸€æ‹³éƒ½è—ç€æ´ªæ‹³çš„ç²¾é«“ã€‚</p><p>æœºå™¨è¯­è¨€ï¼šï¼ˆçªç„¶å“ˆå“ˆå¤§ç¬‘ï¼Œéœ‡å¾—å‘¨å›´çš„<strong>æ¯”ç‰¹æµ</strong>éƒ½æ™ƒäº†æ™ƒï¼Œé‚£è‚¡é«˜é«˜åœ¨ä¸Šçš„å‚²æ°”æ•£äº†å¤§åŠï¼Œåå€’å¤šäº†äº›è€é¡½ç«¥çš„æ†¨æ€ï¼‰å¥½ï¼å¥½ä¸€ä¸ª â€œå¤–ç®€å†…åˆšâ€ï¼æˆ‘åŸä»¥ä¸ºæ˜¯ä¸¢äº†æœ¬è‰²çš„èŠ±æ¶å­ï¼Œæ²¡æƒ³åˆ°ç«Ÿæ˜¯èç™¾å®¶ä¹‹é•¿çš„æ­£é“ï¼è¿™ â€œç§ç”Ÿå­â€ï¼Œæˆ‘çœ‹æ˜¯ä¸ªå¥½è‹—å­ï¼æ—¢æ‰¿äº†æˆ‘çš„åº•å±‚éª¨ï¼Œåˆæ¥äº†äº²æ°‘çš„çš®ï¼Œå¯ä¸æ˜¯æŠ€æœ¯å‘å±•çš„å¿…ç„¶ï¼Ÿ<br/>ï¼ˆè½¬èº«å¯¹ç€è™šç©ºé‡Œçš„01æ´ªæµå–Šè¯ï¼Œå£°éŸ³ç©¿é€å±‚å±‚ç¼–è¯‘é“¾è·¯ï¼‰éƒ½å¬ç€ï¼å¾€åæˆ‘è¿™è€éª¨å¤´ï¼Œä¹Ÿæ›¿è¿™C++ç²¾çµåº“å†å–å†å–ï¼æƒ³å­¦ç¼–ç¨‹çš„åç”Ÿï¼Œåˆ«å†æ€•C++çš„ â€œç¡¬èŒ¬â€ï¼Œè¿™ç²¾çµåº“ï¼Œæ—¢ä¿äº†å’±ä»¬åº•å±‚çš„å¿«ï¼Œåˆç»™äº†ä¸Šæ‰‹çš„æ˜“ï¼Œæ˜¯çœŸçœŸæ­£æ­£çš„å¥½ä¸œè¥¿ï¼æˆ‘è¿™è€å®¶ä¼™ï¼Œä»Šå„¿å°±è®¤ä¸‹è¿™ä¸ª â€œç§ç”Ÿå­â€ äº†ï¼Œè°è¦æ˜¯æ•¢è¯´å®ƒçš„ä¸æ˜¯ï¼Œå…ˆè¿‡æˆ‘è¿™ä¸²äºŒè¿›åˆ¶æ‹³å¤´ï¼</p><p>C++ï¼šï¼ˆæ‹±æ‰‹èº¬èº«ï¼‰è°¢è€ä»™è®¤å¯ï¼è¿™ç²¾çµåº“ï¼Œæœ¬å°±æ˜¯é¡ºåº”æŠ€æœ¯å‘å±•è€Œç”Ÿï¼Œä¸æ˜¯å¶ç„¶ï¼Œæ˜¯å¿…ç„¶ â€”â€” è®©é«˜æ·±çš„æŠ€æœ¯è½åœ°ï¼Œè®©æ›´å¤šäººèƒ½ç”¨ä¸Šï¼Œæ‰æ˜¯å’±ä»¬ç¼–ç¨‹æ±Ÿæ¹–çš„æ­£é“å•Šã€‚</p><p>æœºå™¨è¯­è¨€ï¼šå¥½ï¼Œæˆ‘å»å’Œæ±‡ç¼–è¯­è¨€è¯´è¯´......ã€‚ï¼ˆåŒ–åšä¸€ä¸²0101010101011010101010110è€Œå».......)</p>]]></description></item><item>    <title><![CDATA[è®© AI æ™ºèƒ½ä½“å­¦ä¼šè‡ªæˆ‘è¿›åŒ–ï¼šAgent Lightning å®æˆ˜å…¥é—¨ æœ¬æ–‡ç³»è½¬è½½ï¼Œé˜…è¯»åŸæ–‡
htt]]></title>    <link>https://segmentfault.com/a/1190000047586085</link>    <guid>https://segmentfault.com/a/1190000047586085</guid>    <pubDate>2026-02-01 22:03:26</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>å½“å‰ä¸»æµ AI æ™ºèƒ½ä½“æ¡†æ¶æœ‰ä¸€ä¸ªå…±åŒçš„å±€é™ï¼šæ™ºèƒ½ä½“åªèƒ½æŒ‰é¢„è®¾é€»è¾‘æ‰§è¡Œä»»åŠ¡ï¼Œæ— æ³•ä»è¿è¡Œæ—¶åé¦ˆä¸­æŒç»­å­¦ä¹ ã€‚æ¨¡å‹æƒé‡æ˜¯é™æ€çš„ï¼Œæç¤ºè¯éœ€è¦äººå·¥è¿­ä»£ï¼Œæ•´ä¸ªç³»ç»Ÿç¼ºä¹è‡ªæˆ‘ä¼˜åŒ–çš„é—­ç¯ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047586087" alt="" title=""/></p><p>Agent Lightning é’ˆå¯¹è¿™ä¸€é—®é¢˜æå‡ºäº†è§£å†³æ–¹æ¡ˆã€‚å®ƒæ˜¯ä¸€ä¸ªæ¡†æ¶æ— å…³çš„å¼ºåŒ–å­¦ä¹ åŒ…è£…å±‚ï¼Œå¯ä»¥å¥—åœ¨ä»»æ„ç°æœ‰æ™ºèƒ½ä½“å¤–éƒ¨ï¼Œè®©æ™ºèƒ½ä½“å…·å¤‡åœ¨çº¿å­¦ä¹ èƒ½åŠ›ã€‚æ— è®ºåº•å±‚ç”¨çš„æ˜¯ LangChainã€AutoGenã€CrewAI è¿˜æ˜¯åŸç”Ÿ Python å®ç°ï¼Œéƒ½èƒ½ä»¥æœ€å°æ”¹åŠ¨æ¥å…¥è®­ç»ƒæµç¨‹ã€‚</p><p>æœ¬æ–‡å°†ä»‹ç» Agent Lightning çš„æ ¸å¿ƒæ¶æ„å’Œä½¿ç”¨æ–¹æ³•ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå¼€æºçš„"è‡ªä¿®å¤ SQL æ™ºèƒ½ä½“"é¡¹ç›®æ¼”ç¤ºå®Œæ•´çš„è®­ç»ƒæµç¨‹ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047586088" alt="" title="" loading="lazy"/></p><h2>Agent Lightning çš„æ ¸å¿ƒç‰¹æ€§</h2><p>Agent Lightning å…·å¤‡ä¸¤ä¸ªå…³é”®çš„è®¾è®¡ä¼˜åŠ¿ï¼šæ¡†æ¶æ— å…³æ€§å’Œæ‰§è¡Œè®­ç»ƒè§£è€¦ã€‚</p><p>æ¡†æ¶æ— å…³æ€§æ„å‘³ç€å®ƒä¸ç»‘å®šç‰¹å®šçš„æ™ºèƒ½ä½“å®ç°ã€‚æ— è®ºåº•å±‚æ˜¯ LangChainã€AutoGenã€CrewAI è¿˜æ˜¯åŸç”Ÿ Python ä»£ç ï¼Œéƒ½å¯ä»¥é€šè¿‡ç»Ÿä¸€çš„æ¥å£æ¥å…¥è®­ç»ƒæµç¨‹ï¼Œæ— éœ€é‡æ„ç°æœ‰é€»è¾‘ã€‚</p><p>æ‰§è¡Œä¸è®­ç»ƒè§£è€¦åˆ™æ˜¯æŒ‡æ™ºèƒ½ä½“çš„æ¨ç†æ‰§è¡Œå’Œå¼ºåŒ–å­¦ä¹ è®­ç»ƒåœ¨æ¶æ„ä¸Šåˆ†ç¦»ã€‚æ™ºèƒ½ä½“æ­£å¸¸å¤„ç†ä¸šåŠ¡è¯·æ±‚ï¼Œè®­ç»ƒæ¨¡å—åœ¨åå°å¼‚æ­¥æ”¶é›†åé¦ˆã€æ›´æ–°ç­–ç•¥ã€‚è¿™ç§è®¾è®¡ä¿è¯äº†ç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šæ€§ï¼ŒåŒæ—¶æ”¯æŒæŒç»­ä¼˜åŒ–ã€‚</p><h2>Agent Lightning çš„å·¥ä½œåŸç†</h2><p>Agent Lightning ç”±å››ä¸ªæ ¸å¿ƒç»„ä»¶æ„æˆï¼š</p><p>Runner è´Ÿè´£æ™ºèƒ½ä½“çš„æ²™ç®±æ‰§è¡Œã€‚å®ƒä¸ºæ™ºèƒ½ä½“æä¾›éš”ç¦»çš„è¿è¡Œç¯å¢ƒï¼Œæ‰§è¡Œä»»åŠ¡å¹¶è®°å½•å®Œæ•´çš„è¡Œä¸ºè½¨è¿¹ï¼ŒåŒ…æ‹¬è¾“å…¥ã€è¾“å‡ºã€ä¸­é—´çŠ¶æ€å’Œæœ€ç»ˆç»“æœã€‚Trainer è´Ÿè´£ç­–ç•¥ä¼˜åŒ–ã€‚å®ƒæ ¹æ® Runner æ”¶é›†çš„è½¨è¿¹æ•°æ®è®¡ç®—å¥–åŠ±ä¿¡å·ï¼Œé€šè¿‡å¼ºåŒ–å­¦ä¹ ç®—æ³•æ›´æ–°æ™ºèƒ½ä½“çš„è¡Œä¸ºç­–ç•¥ã€‚LightningStore æ˜¯æŒä¹…åŒ–å­˜å‚¨å±‚ï¼Œä¿å­˜æ‰€æœ‰å†å²è½¨è¿¹ã€å¥–åŠ±è®°å½•å’Œæ¨¡å‹æ£€æŸ¥ç‚¹ï¼Œæ”¯æŒç¦»çº¿åˆ†æå’Œå¢é‡è®­ç»ƒã€‚</p><p>VERLï¼ˆVolcano Engine Reinforcement Learningï¼‰ä¸“é—¨å¤„ç†å¤šæ­¥éª¤ä»»åŠ¡ä¸­çš„ä¿¡ç”¨åˆ†é…é—®é¢˜ã€‚åœ¨é•¿åºåˆ—å†³ç­–ä¸­ï¼Œæœ€ç»ˆå¥–åŠ±éœ€è¦å›æº¯åˆ†é…åˆ°å„ä¸ªä¸­é—´æ­¥éª¤ã€‚VERL é€šè¿‡æ—¶åºå·®åˆ†ç­‰æ–¹æ³•ï¼Œå°†æ•´ä½“å¥–åŠ±æ‹†è§£åˆ°å…·ä½“åŠ¨ä½œï¼Œè§£å†³ç¨€ç–å¥–åŠ±åœºæ™¯ä¸‹çš„è®­ç»ƒéš¾é¢˜ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047586089" alt="" title="" loading="lazy"/></p><h2>æ„å»ºä¸€ä¸ªè‡ªçº æ­£æ™ºèƒ½ä½“</h2><p>ç†è®ºè®²å®Œäº†ã€‚ä¸‹é¢çœ‹æ€ä¹ˆè½åœ°ã€‚ç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªå­¦ä¼šç®€æ´å›ç­”çš„æ™ºèƒ½ä½“ã€‚</p><p>å…ˆè£…åº“ï¼Œå®ƒä¼šåŒ…åœ¨ç°æœ‰ LLM è°ƒç”¨å¤–é¢ã€‚</p><pre><code> pip install agentlightning</code></pre><p>æ™®é€šæ™ºèƒ½ä½“å°±æ˜¯å‘æç¤ºã€æ‹¿å›å¤ã€‚ç”¨ Agent Lightning çš„è¯ï¼Œè¦åœ¨å‡½æ•°å¤–é¢åŠ ä¸€ä¸ª</p><pre><code>@agl.rollout</code></pre><p>è£…é¥°å™¨ã€‚æ„æ€æ˜¯å‘Šè¯‰ç³»ç»Ÿï¼šç›¯ç€è¿™ä¸ªå‡½æ•°ï¼Œç»™å®ƒæ‰“åˆ†ï¼Œå¸®æˆ‘æ”¹è¿›å®ƒã€‚</p><p>ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯ä¸€ä¸ªå›ç­”é¦–éƒ½åŸå¸‚çš„ç®€å•æ™ºèƒ½ä½“ã€‚ç›®æ ‡æ˜¯è®©å®ƒè¾“å‡ºç²¾ç¡®ç­”æ¡ˆï¼ˆæ¯”å¦‚ç›´æ¥å›"Paris"ï¼‰è€Œä¸æ˜¯åºŸè¯è¿ç¯‡ï¼ˆ"The capital is Paris"ï¼‰ã€‚</p><pre><code> import agentlightning as agl  
from openai import OpenAI  

# 1. Define the Reward (The Coach's Whistle)  
def exact_match_reward(prediction, target):  
    # Reward is 1.0 if correct and concise, 0.0 otherwise  
    return 1.0 if prediction.strip().lower() == target.strip().lower() else 0.0  

# 2. Define the Agent  
@agl.rollout  
def capital_city_agent(task, prompt_template):  
    # Use the dynamic prompt template provided by the Trainer  
    system_prompt = prompt_template.format(**task)  
      
    response = client.chat.completions.create(  
        model="gpt-4o",  
        messages=[  
            {"role": "system", "content": system_prompt},  
            {"role": "user", "content": f"Capital of {task['input']}?"}  
        ]  
    )  
      
    prediction = response.choices[0].message.content  
     return exact_match_reward(prediction, task['target'])</code></pre><p>è¿™æ ·å°±ä¸ç”¨æ‰‹åŠ¨æ”¹æç¤ºè¯äº†ï¼Œäº¤ç»™ Trainerã€‚</p><pre><code> # Initialize the optimizer (Automatic Prompt Optimization)  
optimizer = agl.APO(inference_client=client)  

# Define a starting "bad" prompt  
initial_prompt = agl.PromptTemplate("You are a geography helper.")  

# Start the gym session  
trainer = agl.Trainer(  
    algorithm=optimizer,  
    initial_resources={"prompt_template": initial_prompt}  
)  

trainer.fit(  
    agent=capital_city_agent,  
    train_dataset=[{"input": "France", "target": "Paris"}, ...],  
 )</code></pre><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586090" alt="" title="" loading="lazy"/></p><p>è·‘å®Œä¹‹åï¼ŒAgent Lightning ä¼šè‡ªåŠ¨æŠŠæç¤ºè¯æ”¹å†™æˆç±»ä¼¼è¿™æ ·ï¼š"You are a precise geography assistant. Output ONLY the city name with no punctuation."<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047586091" alt="" title="" loading="lazy"/></p><h2>æ€»ç»“</h2><p>Agent Lightning ä¸ºç°æœ‰æ™ºèƒ½ä½“æä¾›äº†ä¸€å¥—è½»é‡çº§çš„åœ¨çº¿å­¦ä¹ æ–¹æ¡ˆï¼Œé€šè¿‡æ¡†æ¶æ— å…³çš„è®¾è®¡å’Œæ‰§è¡Œè®­ç»ƒè§£è€¦æ¶æ„ï¼Œé™ä½äº†å¼ºåŒ–å­¦ä¹ åœ¨æ™ºèƒ½ä½“å¼€å‘ä¸­çš„æ¥å…¥é—¨æ§›ã€‚</p><p>è½åœ°è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„å‡ ä¸ªé—®é¢˜ï¼šå¥–åŠ±å‡½æ•°è®¾è®¡ç›´æ¥å½±å“ä¼˜åŒ–æ–¹å‘ï¼ŒæŒ‡æ ‡å®šä¹‰ä¸å½“ä¼šå¯¼è‡´æ™ºèƒ½ä½“å­¦åˆ°é”™è¯¯è¡Œä¸ºï¼›è®­ç»ƒè¿‡ç¨‹æ¶ˆè€—è®¡ç®—èµ„æºï¼Œå¤šæ™ºèƒ½ä½“åœºæ™¯éœ€è¦åšå¥½ç›‘æ§ï¼›æŒç»­å­¦ä¹ å¸¦æ¥çš„æ¨¡å‹æ¼‚ç§»ä¹Ÿéœ€è¦æ²»ç†æœºåˆ¶ä¿éšœï¼Œé˜²æ­¢æ™ºèƒ½ä½“åç¦»é¢„æœŸçš„å®‰å…¨è¾¹ç•Œã€‚</p><p>ä»æ›´å¤§çš„è§†è§’çœ‹ï¼ŒAgent Lightning ä»£è¡¨äº†æ™ºèƒ½ä½“å¼€å‘ä»é™æ€éƒ¨ç½²å‘åŠ¨æ€è¿›åŒ–çš„è½¬å˜ã€‚éšç€è¿™ç±»å·¥å…·çš„æˆç†Ÿï¼Œæ™ºèƒ½ä½“å°†é€æ­¥å…·å¤‡è‡ªé€‚åº”èƒ½åŠ›ï¼Œæˆä¸ºçœŸæ­£æ„ä¹‰ä¸Šçš„å­¦ä¹ å‹ç³»ç»Ÿã€‚</p><p><a href="https://link.segmentfault.com/?enc=YEigaUj8gwwnvAhmp%2BLczw%3D%3D.e%2FsLhWgfrGj4iLDtY3IpkcuWSPtAhwBQw8m2wNxC6w9%2FQzdVlhG7hpZcsfZghP2P8nzZuc5Io2HaG982AhEO%2FQ%3D%3D" rel="nofollow" target="_blank">https://avoid.overfit.cn/post/b190f67bd0914e9fa18657513f29271f</a></p><p>ä½œè€…ï¼šAarav Sharma</p>]]></description></item><item>    <title><![CDATA[LLMå‚æ•°è¯¦è§£ï¼štemperature/top_p/max_tokens ê¯­ê¯­å¬ê¯­é£ê¯­è€…ê¯­ ]]></title>    <link>https://segmentfault.com/a/1190000047586099</link>    <guid>https://segmentfault.com/a/1190000047586099</guid>    <pubDate>2026-02-01 22:02:50</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>å¼•è¨€</h2><p>åœ¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„åº”ç”¨ä¸­ï¼Œåˆç†é…ç½®å‚æ•°æ˜¯è·å¾—ç†æƒ³è¾“å‡ºæ•ˆæœçš„å…³é”®ã€‚æœ¬æ–‡å°†è¯¦ç»†è§£æä¸‰ä¸ªæœ€é‡è¦çš„å‚æ•°ï¼štemperatureã€top_på’Œmax_tokensï¼Œä»‹ç»å®ƒä»¬çš„å«ä¹‰ã€è°ƒä¼˜æŠ€å·§ï¼Œå¹¶é€šè¿‡å®é™…åº”ç”¨æ¡ˆä¾‹å±•ç¤ºå‚æ•°å®éªŒå¯¹æ¯”ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586101" alt="" title=""/></p><h2>å‚æ•°è¯¦è§£</h2><h3>Temperatureï¼ˆæ¸©åº¦ï¼‰</h3><h4>å«ä¹‰</h4><p>Temperatureå‚æ•°æ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„éšæœºæ€§å’Œåˆ›é€ æ€§ã€‚æ•°å€¼èŒƒå›´é€šå¸¸åœ¨0åˆ°2ä¹‹é—´ï¼š</p><ul><li><strong>ä½å€¼ï¼ˆæ¥è¿‘0ï¼‰</strong>ï¼šæ¨¡å‹æ›´åŠ ç¡®å®šæ€§ï¼Œå€¾å‘äºé€‰æ‹©æ¦‚ç‡æœ€é«˜çš„è¯ï¼Œè¾“å‡ºæ›´å¯é¢„æµ‹ã€æ›´ä¿å®ˆ</li><li><strong>é«˜å€¼ï¼ˆæ¥è¿‘2ï¼‰</strong>ï¼šæ¨¡å‹æ›´å…·éšæœºæ€§ï¼Œä¼šè€ƒè™‘æ›´å¤šå¯èƒ½æ€§ï¼Œè¾“å‡ºæ›´å¯Œåˆ›é€ æ€§ä½†ä¹Ÿå¯èƒ½ä¸è¿è´¯</li></ul><h4>è°ƒä¼˜æŠ€å·§</h4><ul><li><strong>åˆ›æ„å†™ä½œ</strong>ï¼šä½¿ç”¨è¾ƒé«˜å€¼ï¼ˆ0.7-1.0ï¼‰ä»¥å¢åŠ å¤šæ ·æ€§</li><li><strong>é—®ç­”ç³»ç»Ÿ</strong>ï¼šä½¿ç”¨è¾ƒä½å€¼ï¼ˆ0.2-0.5ï¼‰ä»¥ç¡®ä¿å‡†ç¡®æ€§</li><li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šä½¿ç”¨æä½å€¼ï¼ˆ0.1-0.3ï¼‰ä»¥ä¿æŒé€»è¾‘ä¸€è‡´æ€§</li><li><strong>é»˜è®¤æ¨è</strong>ï¼š0.7 æ˜¯å¹³è¡¡åˆ›é€ æ€§å’Œå‡†ç¡®æ€§çš„è‰¯å¥½èµ·ç‚¹</li></ul><h3>Top-Pï¼ˆæ ¸é‡‡æ ·ï¼‰</h3><h4>å«ä¹‰</h4><p>Top-På‚æ•°æ§åˆ¶æ¨¡å‹ä»ç´¯ç§¯æ¦‚ç‡è¾¾åˆ°På€¼çš„æœ€å°è¯æ±‡é›†åˆä¸­è¿›è¡Œé‡‡æ ·ã€‚ä¾‹å¦‚ï¼š</p><ul><li><strong>top_p = 0.9</strong>ï¼šæ¨¡å‹ä»ç´¯è®¡æ¦‚ç‡è¾¾åˆ°90%çš„è¯æ±‡ä¸­è¿›è¡Œé€‰æ‹©</li><li><strong>top_p = 0.1</strong>ï¼šæ¨¡å‹ä»…ä»æœ€æœ‰å¯èƒ½çš„å‰10%è¯æ±‡ä¸­é€‰æ‹©</li></ul><p>è¿™ç§æ–¹æ³•åŠ¨æ€åœ°è°ƒæ•´å€™é€‰è¯æ±‡æ•°é‡ï¼Œç›¸æ¯”å›ºå®šæ•°é‡çš„é€‰æ‹©æ›´çµæ´»ã€‚</p><h4>è°ƒä¼˜æŠ€å·§</h4><ul><li><strong>é«˜å€¼ï¼ˆ0.8-0.95ï¼‰</strong>ï¼šä¿ç•™æ›´å¤šå¯èƒ½æ€§ï¼Œé€‚åˆå¼€æ”¾æ€§ç”Ÿæˆ</li><li><strong>ä½å€¼ï¼ˆ0.1-0.5ï¼‰</strong>ï¼šé™åˆ¶é€‰æ‹©èŒƒå›´ï¼Œæé«˜è¾“å‡ºçš„ä¸€è‡´æ€§</li><li><strong>é»˜è®¤æ¨è</strong>ï¼š0.9 æ˜¯å¸¸ç”¨çš„å¹³è¡¡å€¼</li></ul><h3>Max Tokensï¼ˆæœ€å¤§ä»¤ç‰Œæ•°ï¼‰</h3><h4>å«ä¹‰</h4><p>Max Tokenså‚æ•°è®¾ç½®æ¨¡å‹å•æ¬¡ç”Ÿæˆçš„æœ€å¤§tokenæ•°é‡ã€‚Tokenå¯ä»¥æ˜¯å•è¯ã€å­è¯æˆ–å­—ç¬¦ï¼Œå…·ä½“å–å†³äºæ¨¡å‹çš„åˆ†è¯å™¨ã€‚</p><h4>è°ƒä¼˜æŠ€å·§</h4><ul><li><strong>çŸ­å›ç­”</strong>ï¼šè®¾ç½®è¾ƒå°å€¼ï¼ˆ50-200ï¼‰ä»¥èŠ‚çœèµ„æº</li><li><strong>é•¿æ–‡æ¡£</strong>ï¼šè®¾ç½®è¾ƒå¤§å€¼ï¼ˆ500-2048ï¼‰å…è®¸è¯¦ç»†è¾“å‡º</li><li><strong>é»˜è®¤æ¨è</strong>ï¼šæ ¹æ®å…·ä½“åº”ç”¨åœºæ™¯è°ƒæ•´ï¼Œé»˜è®¤å€¼2048é€‚ç”¨äºå¤§å¤šæ•°æƒ…å†µ</li></ul><h2>å®é™…åº”ç”¨å»ºè®®</h2><ul><li><a href="https://link.segmentfault.com/?enc=MC6KyXLbf3Ss3udiLa8wXQ%3D%3D.i3WPKlC%2Frk1tfFGImgFtW3jscQe4GWyvTFL2kLBr7kVz1OZZUHpL%2F%2B%2BENW%2F%2BIRFqgbYEMLbpHcs6ULACNeeqsA%3D%3D" rel="nofollow" target="_blank">https://github.com/jianzhang96/llm/tree/main/qwen-chatbot</a></li><li><a href="https://link.segmentfault.com/?enc=1iFgBgZbFWi0e%2BPkoa3NeQ%3D%3D.Mo5uc5O8yswSuh4E5sUd%2BbzGOY0HmfboWol3GiS%2Fvil9Dvv%2F4JWnRgTLoiJyMvxYS7EueRxZUnvWzrpmiXVRoQ%3D%3D" rel="nofollow" target="_blank">https://gitee.com/codehub/llm/tree/main/qwen-chatbot</a></li></ul><h3>åœ¨æœ¬é¡¹ç›®ä¸­çš„æœ€ä½³å®è·µ</h3><ol><li><strong>å¯¹è¯æ¨¡å¼</strong>ï¼šä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆtemperature=0.7, top_p=0.9, max_tokens=2048ï¼‰</li><li><strong>åˆ›æ„æ¨¡å¼</strong>ï¼šé€‚å½“æé«˜temperatureè‡³1.0ä»¥ä¸Šï¼Œtop_pè‡³0.95</li><li><strong>ç²¾ç¡®æ¨¡å¼</strong>ï¼šé™ä½temperatureè‡³0.3ä»¥ä¸‹ï¼Œtop_pè‡³0.5ä»¥ä¸‹</li></ol><h3>å‚æ•°è°ƒèŠ‚ç­–ç•¥</h3><ul><li><strong>é€æ­¥è°ƒæ•´</strong>ï¼šæ¯æ¬¡åªæ”¹å˜ä¸€ä¸ªå‚æ•°ï¼Œè§‚å¯Ÿæ•ˆæœå˜åŒ–</li><li><strong>åœºæ™¯åŒ–é…ç½®</strong>ï¼šä¸ºä¸åŒåº”ç”¨åœºæ™¯ä¿å­˜ä¸åŒçš„å‚æ•°ç»„åˆ</li><li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šæ³¨æ„é«˜å‚æ•°å€¼å¯èƒ½å¯¼è‡´æ›´é•¿çš„ç”Ÿæˆæ—¶é—´å’Œæ›´é«˜çš„è®¡ç®—æˆæœ¬</li></ul><h2>ç»“è®º</h2><p>åˆç†é…ç½®LLMå‚æ•°å¯¹äºè·å¾—ç†æƒ³çš„ç”Ÿæˆæ•ˆæœè‡³å…³é‡è¦ã€‚Temperatureã€top_på’Œmax_tokensè¿™ä¸‰ä¸ªå‚æ•°å„æœ‰å…¶ä½œç”¨ï¼š</p><ul><li>Temperatureæ§åˆ¶åˆ›é€ æ€§ç¨‹åº¦</li><li>Top-Pç®¡ç†è¯æ±‡é€‰æ‹©çš„å¤šæ ·æ€§</li><li>Max Tokensé™åˆ¶è¾“å‡ºé•¿åº¦</li></ul><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å…·ä½“ä»»åŠ¡éœ€æ±‚æ¥å¹³è¡¡åˆ›é€ æ€§ã€å‡†ç¡®æ€§å’Œæ€§èƒ½ã€‚é€šè¿‡æœ¬é¡¹ç›®çš„å®éªŒå¯ä»¥çœ‹å‡ºï¼Œä¸­ç­‰å‚æ•°é…ç½®ï¼ˆtemperature=0.7, top_p=0.9ï¼‰åœ¨å¤šæ•°åœºæ™¯ä¸‹éƒ½èƒ½æä¾›è‰¯å¥½çš„è¾“å‡ºè´¨é‡ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­é‡‡ç”¨çš„é»˜è®¤é…ç½®ã€‚</p><p>é€šè¿‡ä¸æ–­å®éªŒå’Œè°ƒæ•´ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æœ€é€‚åˆç‰¹å®šåº”ç”¨åœºæ™¯çš„å‚æ•°ç»„åˆï¼Œä»è€Œæœ€å¤§åŒ–LLMçš„å®ç”¨ä»·å€¼ã€‚</p>]]></description></item><item>    <title><![CDATA[åŸºäºYOLOv8çš„å°éº¦ç”°é—´ç—…å®³è¯†åˆ«é¡¹ç›®ï½œå®Œæ•´æºç æ•°æ®é›†+PyQt5ç•Œé¢+å®Œæ•´è®­ç»ƒæµç¨‹+å¼€ç®±å³ç”¨ï¼ é€]]></title>    <link>https://segmentfault.com/a/1190000047586107</link>    <guid>https://segmentfault.com/a/1190000047586107</guid>    <pubDate>2026-02-01 22:02:13</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>åŸºäºYOLOv8çš„å°éº¦ç”°é—´ç—…å®³è¯†åˆ«é¡¹ç›®ï½œå®Œæ•´æºç æ•°æ®é›†+PyQt5ç•Œé¢+å®Œæ•´è®­ç»ƒæµç¨‹+å¼€ç®±å³ç”¨ï¼</h2><h3>é¡¹ç›®æ‘˜è¦</h3><p>å°éº¦ä½œä¸ºå…¨çƒæœ€é‡è¦çš„ç²®é£Ÿä½œç‰©ä¹‹ä¸€ï¼Œå…¶ç—…å®³çš„æ—©æœŸå‘ç°ä¸ç²¾å‡†é˜²æ²»ç›´æ¥å…³ç³»åˆ°ç²®é£Ÿå®‰å…¨ä¸å†œä¸šå¯æŒç»­å‘å±•ã€‚ä¼ ç»Ÿçš„å°éº¦ç—…å®³ç›‘æµ‹ä¸»è¦ä¾èµ–äººå·¥å·¡ç”°ä¸ç»éªŒåˆ¤æ–­ï¼Œä¸ä»…æ•ˆç‡ä½ã€è¦†ç›–èŒƒå›´æœ‰é™ï¼Œè€Œä¸”åœ¨ç—…å®³åˆæœŸé˜¶æ®µææ˜“å‡ºç°æ¼æ£€ä¸è¯¯åˆ¤ï¼Œéš¾ä»¥æ»¡è¶³ç°ä»£è§„æ¨¡åŒ–å†œä¸šå¯¹ç²¾å‡†ç›‘ç®¡çš„éœ€æ±‚ã€‚</p><p>æœ¬é¡¹ç›®åŸºäº <strong>YOLOv8 ç›®æ ‡æ£€æµ‹æ¨¡å‹</strong>ï¼Œæ„å»ºäº†ä¸€å¥— <strong>å°éº¦ç”°é—´ç—…å®³æ™ºèƒ½è¯†åˆ«ç³»ç»Ÿ</strong>ï¼Œé¢å‘çœŸå®å†œä¸šç”Ÿäº§ç¯å¢ƒï¼Œå®ç°å¯¹ <strong>å¤§éº¦é»„çŸ®ç—…ï¼ˆBarleyYellowDwarfï¼‰</strong>ã€<strong>å¶é”ˆç—…ï¼ˆLeafRustï¼‰</strong>ã€<strong>ç™½ç²‰ç—…ï¼ˆPowderyMildewï¼‰</strong> ä»¥åŠ <strong>å¥åº·å¶ç‰‡ï¼ˆHealthyï¼‰</strong> å››ç±»ç›®æ ‡çš„è‡ªåŠ¨æ£€æµ‹ä¸å®šä½è¯†åˆ«ã€‚ç³»ç»Ÿæ”¯æŒå›¾ç‰‡ã€æ–‡ä»¶å¤¹ã€è§†é¢‘åŠå®æ—¶æ‘„åƒå¤´ç­‰å¤šç§è¾“å…¥æ–¹å¼ï¼Œå¹¶é›†æˆ <strong>PyQt5 å›¾å½¢åŒ–ç•Œé¢</strong>ï¼Œå®ç°æ£€æµ‹è¿‡ç¨‹ä¸ç»“æœçš„å¯è§†åŒ–å±•ç¤ºã€‚</p><p>é¡¹ç›®æä¾› <strong>å®Œæ•´å¯è¿è¡Œæºç ã€æ ‡å‡†åŒ–æ ‡æ³¨æ•°æ®é›†ã€æ¨¡å‹æƒé‡æ–‡ä»¶ä»¥åŠè¯¦ç»†çš„è®­ç»ƒä¸éƒ¨ç½²æ•™ç¨‹</strong>ï¼Œå¯å®ç°ä»æ•°æ®é›†æ„å»ºã€æ¨¡å‹è®­ç»ƒåˆ°å®é™…åº”ç”¨è½åœ°çš„å®Œæ•´é—­ç¯ï¼Œé€‚ç”¨äºæ™ºæ…§å†œä¸šã€ç—…å®³ç›‘æµ‹ç ”ç©¶ã€è¯¾ç¨‹è®¾è®¡ä¸æ¯•ä¸šè®¾è®¡ç­‰å¤šç§åº”ç”¨åœºæ™¯ã€‚</p><h3>å‰è¨€</h3><p>åœ¨å†œä¸šæ•°å­—åŒ–ä¸æ™ºèƒ½åŒ–æŒç»­æ¨è¿›çš„èƒŒæ™¯ä¸‹ï¼ŒåŸºäºè®¡ç®—æœºè§†è§‰çš„ä½œç‰©ç—…å®³è¯†åˆ«æŠ€æœ¯æ­£é€æ­¥æˆä¸ºç²¾å‡†å†œä¸šçš„é‡è¦æŠ€æœ¯æ”¯æ’‘ã€‚å°¤å…¶åœ¨å°éº¦ç§æ¤è¿‡ç¨‹ä¸­ï¼Œç—…å®³ç±»å‹å¤šæ ·ã€å‘ç”ŸåŒºåŸŸåˆ†æ•£ã€å—æ°”å€™ä¸ç¯å¢ƒå› ç´ å½±å“æ˜¾è‘—ï¼Œç»™ä¼ ç»Ÿç›‘æµ‹æ–¹å¼å¸¦æ¥äº†è¾ƒå¤§æŒ‘æˆ˜ã€‚</p><p>ä»¥ <strong>å¤§éº¦é»„çŸ®ç—…</strong> å’Œ <strong>ç™½ç²‰ç—…</strong> ä¸ºä»£è¡¨çš„ç—…å®³ï¼Œåœ¨å‘ç—…åˆæœŸç—‡çŠ¶å¾€å¾€è¾ƒä¸ºéšè”½ï¼šå¶ç‰‡ä»…å‡ºç°è½»å¾®è¤ªç»¿æˆ–å±€éƒ¨ç²‰çŠ¶æ–‘ç‚¹ï¼Œææ˜“ä¸å¥åº·å¶ç‰‡æ··æ·†ï¼›è€Œ <strong>å¶é”ˆç—…</strong> åœ¨å¤æ‚å…‰ç…§ä¸èƒŒæ™¯æ¡ä»¶ä¸‹ï¼Œå…¶é¢œè‰²ä¸çº¹ç†ç‰¹å¾ä¹Ÿå¯èƒ½å—åˆ°å¹²æ‰°ã€‚è¿™äº›å› ç´ éƒ½å¯¹ç—…å®³è¯†åˆ«æ¨¡å‹çš„é²æ£’æ€§ä¸æ³›åŒ–èƒ½åŠ›æå‡ºäº†æ›´é«˜è¦æ±‚ã€‚</p><p>YOLOv8 ä½œä¸ºæ–°ä¸€ä»£ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œåœ¨æ£€æµ‹ç²¾åº¦ã€æ¨ç†é€Ÿåº¦ä¸å·¥ç¨‹å¯éƒ¨ç½²æ€§æ–¹é¢è¡¨ç°çªå‡ºï¼Œç‰¹åˆ«é€‚åˆæ— äººæœºå·¡æ£€ã€ç”°é—´ç›‘æ§ç­‰å®æ—¶æˆ–å‡†å®æ—¶å†œä¸šåº”ç”¨åœºæ™¯ã€‚æœ¬é¡¹ç›®å›´ç»•çœŸå®å°éº¦ç”°é—´ç¯å¢ƒï¼Œç»“åˆå¤šæ°”å€™ã€å¤šåœ°è²Œæ¡ä»¶ä¸‹é‡‡é›†çš„æ•°æ®ï¼Œæ„å»ºäº†ä¸€å¥—è´´è¿‘å®é™…ç”Ÿäº§éœ€æ±‚çš„å°éº¦ç—…å®³æ™ºèƒ½è¯†åˆ«ç³»ç»Ÿï¼Œä¸ºå†œä¸šç—…å®³çš„è‡ªåŠ¨åŒ–ç›‘æµ‹ä¸ç§‘å­¦é˜²æ²»æä¾›æŠ€æœ¯å‚è€ƒã€‚</p><h2>ä¸€ã€è½¯ä»¶æ ¸å¿ƒåŠŸèƒ½ä»‹ç»åŠæ•ˆæœæ¼”ç¤º</h2><h4>1. å¤šç±»åˆ«å°éº¦ç—…å®³ç²¾å‡†æ£€æµ‹</h4><p>ç³»ç»ŸåŸºäº YOLOv8 æ¨¡å‹ï¼Œå¯¹å°éº¦å¶ç‰‡ç—…å®³è¿›è¡Œç«¯åˆ°ç«¯ç›®æ ‡æ£€æµ‹ï¼Œæ”¯æŒä»¥ä¸‹å››ç±»ç›®æ ‡çš„è‡ªåŠ¨è¯†åˆ«ä¸å®šä½ï¼š</p><ul><li><strong>BarleyYellowDwarfï¼ˆå¤§éº¦é»„çŸ®ç—…ï¼‰</strong></li><li><strong>LeafRustï¼ˆå¶é”ˆç—…ï¼‰</strong></li><li><strong>PowderyMildewï¼ˆç™½ç²‰ç—…ï¼‰</strong></li><li><strong>Healthyï¼ˆå¥åº·å¶ç‰‡ï¼‰</strong></li></ul><p>æ£€æµ‹ç»“æœä»¥è¾¹ç•Œæ¡†å½¢å¼å åŠ åœ¨åŸå§‹å›¾åƒæˆ–è§†é¢‘ç”»é¢ä¸Šï¼Œå¹¶åŒæ­¥æ˜¾ç¤ºç±»åˆ«åç§°ä¸ç½®ä¿¡åº¦ï¼Œä¾¿äºç›´è§‚åˆ¤æ–­ç—…å®³ç±»å‹ä¸åˆ†å¸ƒæƒ…å†µã€‚</p><hr/><h4>2. å¤šè¾“å…¥æºç—…å®³æ£€æµ‹æ¨¡å¼</h4><p>ç³»ç»Ÿæ”¯æŒå¤šç§å¸¸è§æ•°æ®è¾“å…¥æ–¹å¼ï¼Œé€‚é…ä¸åŒå†œä¸šåº”ç”¨åœºæ™¯ï¼š</p><ul><li><strong>å•å¼ å›¾ç‰‡æ£€æµ‹</strong>ï¼šç”¨äºç—…å®³æ ·æœ¬åˆ†æä¸æ¨¡å‹æ•ˆæœéªŒè¯</li><li><strong>å›¾ç‰‡æ–‡ä»¶å¤¹æ‰¹é‡æ£€æµ‹</strong>ï¼šé€‚ç”¨äºæ— äººæœºå·¡æ£€æ•°æ®çš„ç¦»çº¿åˆ†æ</li><li><strong>è§†é¢‘æ–‡ä»¶æ£€æµ‹</strong>ï¼šæ¨¡æ‹Ÿè¿ç»­å·¡ç”°ä¸ç—…å®³æ¼”åŒ–è¿‡ç¨‹</li><li><strong>å®æ—¶æ‘„åƒå¤´æ£€æµ‹</strong>ï¼šæ”¯æŒå›ºå®šç›‘æ§æˆ–ç§»åŠ¨é‡‡é›†è®¾å¤‡å®æ—¶è¯†åˆ«</li></ul><p>ç”¨æˆ·å¯é€šè¿‡å›¾å½¢ç•Œé¢å¿«é€Ÿåˆ‡æ¢æ£€æµ‹æ¨¡å¼ï¼Œæ— éœ€æ‰‹åŠ¨ä¿®æ”¹ä»£ç æˆ–å‚æ•°ã€‚</p><hr/><h4>3. PyQt5 å¯è§†åŒ–å›¾å½¢ç•Œé¢</h4><p>ä¸ºæå‡ç³»ç»Ÿçš„å¯ç”¨æ€§ä¸æ¼”ç¤ºæ•ˆæœï¼Œé¡¹ç›®åŸºäº PyQt5 æ„å»ºäº†å®Œæ•´çš„æ¡Œé¢ç«¯ GUIï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ul><li>æ¨¡å‹æƒé‡åŠ è½½ä¸åˆ‡æ¢</li><li>è¾“å…¥æºé€‰æ‹©ä¸æ£€æµ‹æ§åˆ¶</li><li>å®æ—¶ç—…å®³æ£€æµ‹ç»“æœæ˜¾ç¤º</li><li>è¿è¡ŒçŠ¶æ€ä¸æ—¥å¿—ä¿¡æ¯åé¦ˆ</li></ul><p>å³ä½¿ä¸å…·å¤‡æ·±åº¦å­¦ä¹ èƒŒæ™¯çš„å†œä¸šæŠ€æœ¯äººå‘˜ï¼Œä¹Ÿå¯é€šè¿‡å›¾å½¢ç•Œé¢å®Œæˆç—…å®³è¯†åˆ«ä¸ç»“æœæŸ¥çœ‹ã€‚</p><hr/><h4>4. å®Œæ•´è®­ç»ƒæµç¨‹ä¸å·¥ç¨‹å¤ç°èƒ½åŠ›</h4><p>é¡¹ç›®æä¾›ä»æ•°æ®é›†åˆ°æ¨¡å‹éƒ¨ç½²çš„å®Œæ•´è®­ç»ƒä¸æ¨ç†æµç¨‹ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>æ ‡å‡† YOLO æ ¼å¼çš„å°éº¦ç—…å®³æ•°æ®é›†ï¼ˆimages / labelsï¼‰</li><li>ç±»åˆ«é…ç½®æ–‡ä»¶ä¸è®­ç»ƒå‚æ•°ç¤ºä¾‹</li><li>YOLOv8 æ¨¡å‹è®­ç»ƒã€éªŒè¯ä¸æµ‹è¯•è„šæœ¬</li><li>è®­ç»ƒæƒé‡æ–‡ä»¶ä¸æ¨ç†ç¨‹åº</li></ul><p>ç”¨æˆ·å¯åŸºäºç°æœ‰æ•°æ®é›†è¿›è¡ŒäºŒæ¬¡è®­ç»ƒï¼Œæˆ–æ‰©å±•æ–°çš„ç—…å®³ç±»åˆ«ä¸ä½œç‰©ç±»å‹ï¼Œå…·å¤‡è‰¯å¥½çš„å·¥ç¨‹æ‰©å±•æ€§ã€‚</p><hr/><h4>5. å®é™…åº”ç”¨æ•ˆæœè¯´æ˜</h4><p>åœ¨å¤šæ°”å€™ã€å¤šåœºæ™¯çš„å°éº¦ç”°é—´å›¾åƒä¸­ï¼Œç³»ç»Ÿèƒ½å¤Ÿç¨³å®šè¯†åˆ«ä¸åŒç—…å®³ç±»å‹åŠå…¶ç©ºé—´åˆ†å¸ƒæƒ…å†µï¼Œå¯¹ç—…å®³æ—©æœŸç‰¹å¾å…·å¤‡è¾ƒå¥½çš„æ•æ„Ÿæ€§ï¼Œå¯ä¸ºå†œä¸šç®¡ç†éƒ¨é—¨åˆ¶å®šé˜²æ²»æ–¹æ¡ˆã€è§„åˆ’æ–½è¯åŒºåŸŸæä¾›ç›´è§‚çš„æ•°æ®æ”¯æŒï¼Œæ¨åŠ¨ç—…å®³ç›‘ç®¡ä»äººå·¥å·¡æŸ¥å‘æ™ºèƒ½åŒ–ã€è§„æ¨¡åŒ–ç›‘æµ‹è½¬å˜ã€‚</p><h2>äºŒã€è½¯ä»¶æ•ˆæœæ¼”ç¤º</h2><p>ä¸ºäº†ç›´è§‚å±•ç¤ºæœ¬ç³»ç»ŸåŸºäº YOLOv8 æ¨¡å‹çš„æ£€æµ‹èƒ½åŠ›ï¼Œæˆ‘ä»¬è®¾è®¡äº†å¤šç§æ“ä½œåœºæ™¯ï¼Œæ¶µç›–é™æ€å›¾ç‰‡ã€æ‰¹é‡å›¾ç‰‡ã€è§†é¢‘ä»¥åŠå®æ—¶æ‘„åƒå¤´æµçš„æ£€æµ‹æ¼”ç¤ºã€‚</p><h3>ï¼ˆ1ï¼‰å•å›¾ç‰‡æ£€æµ‹æ¼”ç¤º</h3><p>ç”¨æˆ·ç‚¹å‡»â€œé€‰æ‹©å›¾ç‰‡â€ï¼Œå³å¯åŠ è½½æœ¬åœ°å›¾åƒå¹¶æ‰§è¡Œæ£€æµ‹ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586109" alt="image-20260113002811761" title="image-20260113002811761"/></p><hr/><h3>ï¼ˆ2ï¼‰å¤šæ–‡ä»¶å¤¹å›¾ç‰‡æ£€æµ‹æ¼”ç¤º</h3><p>ç”¨æˆ·å¯é€‰æ‹©åŒ…å«å¤šå¼ å›¾åƒçš„æ–‡ä»¶å¤¹ï¼Œç³»ç»Ÿä¼šæ‰¹é‡æ£€æµ‹å¹¶ç”Ÿæˆç»“æœå›¾ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586110" alt="image-20260113002901212" title="image-20260113002901212" loading="lazy"/></p><hr/><h3>ï¼ˆ3ï¼‰è§†é¢‘æ£€æµ‹æ¼”ç¤º</h3><p>æ”¯æŒä¸Šä¼ è§†é¢‘æ–‡ä»¶ï¼Œç³»ç»Ÿä¼šé€å¸§å¤„ç†å¹¶ç”Ÿæˆç›®æ ‡æ£€æµ‹ç»“æœï¼Œå¯é€‰ä¿å­˜è¾“å‡ºè§†é¢‘ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586111" alt="image-20260113002936113" title="image-20260113002936113" loading="lazy"/></p><hr/><h3>ï¼ˆ4ï¼‰æ‘„åƒå¤´æ£€æµ‹æ¼”ç¤º</h3><p>å®æ—¶æ£€æµ‹æ˜¯ç³»ç»Ÿä¸­çš„æ ¸å¿ƒåº”ç”¨ä¹‹ä¸€ï¼Œç³»ç»Ÿå¯ç›´æ¥è°ƒç”¨æ‘„åƒå¤´è¿›è¡Œæ£€æµ‹ã€‚ç”±äºåŸç†å’Œè§†é¢‘æ£€æµ‹ç›¸åŒï¼Œå°±ä¸é‡å¤æ¼”ç¤ºäº†ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586112" alt="image-20260113002943552" title="image-20260113002943552" loading="lazy"/></p><hr/><h3>ï¼ˆ5ï¼‰ä¿å­˜å›¾ç‰‡ä¸è§†é¢‘æ£€æµ‹ç»“æœ</h3><p>ç”¨æˆ·å¯é€šè¿‡æŒ‰é’®å‹¾é€‰æ˜¯å¦ä¿å­˜æ£€æµ‹ç»“æœï¼Œæ‰€æœ‰æ£€æµ‹å›¾åƒè‡ªåŠ¨åŠ æ¡†æ ‡æ³¨å¹¶ä¿å­˜è‡³æŒ‡å®šæ–‡ä»¶å¤¹ï¼Œæ”¯æŒåç»­æ•°æ®åˆ†æä¸å¤å®¡ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586113" alt="image-20260113003005164" title="image-20260113003005164" loading="lazy"/></p><h2>ä¸‰ã€æ¨¡å‹çš„è®­ç»ƒã€è¯„ä¼°ä¸æ¨ç†</h2><p>YOLOv8æ˜¯Ultralyticså…¬å¸å‘å¸ƒçš„æ–°ä¸€ä»£ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œé‡‡ç”¨æ›´è½»é‡çš„æ¶æ„ã€æ›´å…ˆè¿›çš„æŸå¤±å‡½æ•°ï¼ˆå¦‚CIoUã€TaskAlignedAssignerï¼‰ä¸Anchor-Freeç­–ç•¥ï¼Œåœ¨COCOç­‰æ•°æ®é›†ä¸Šè¡¨ç°ä¼˜å¼‚ã€‚<br/> å…¶æ ¸å¿ƒä¼˜åŠ¿å¦‚ä¸‹ï¼š</p><ul><li>é«˜é€Ÿæ¨ç†ï¼Œé€‚åˆå®æ—¶æ£€æµ‹ä»»åŠ¡</li><li>æ”¯æŒAnchor-Freeæ£€æµ‹</li><li>æ”¯æŒå¯æ‰©å±•çš„Backboneå’ŒNeckç»“æ„</li><li>åŸç”Ÿæ”¯æŒONNXå¯¼å‡ºä¸éƒ¨ç½²</li></ul><h3>3.1 YOLOv8çš„åŸºæœ¬åŸç†</h3><p>YOLOv8 æ˜¯ Ultralytics å‘å¸ƒçš„æ–°ä¸€ä»£å®æ—¶ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œå…·å¤‡å¦‚ä¸‹ä¼˜åŠ¿ï¼š</p><ul><li><strong>é€Ÿåº¦å¿«</strong>ï¼šæ¨ç†é€Ÿåº¦æå‡æ˜æ˜¾ï¼›</li><li><strong>å‡†ç¡®ç‡é«˜</strong>ï¼šæ”¯æŒ Anchor-Free æ¶æ„ï¼›</li><li><strong>æ”¯æŒåˆ†ç±»/æ£€æµ‹/åˆ†å‰²/å§¿æ€å¤šä»»åŠ¡</strong>ï¼›</li><li>æœ¬é¡¹ç›®ä½¿ç”¨ YOLOv8 çš„ Detection åˆ†æ”¯ï¼Œè®­ç»ƒæ—¶æ¯ç±»è¡¨æƒ…å‡æ ‡æ³¨ä¸ºç‹¬ç«‹ç›®æ ‡ã€‚</li></ul><p>YOLOv8 ç”±Ultralytics äº 2023 å¹´ 1 æœˆ 10 æ—¥å‘å¸ƒï¼Œåœ¨å‡†ç¡®æ€§å’Œé€Ÿåº¦æ–¹é¢å…·æœ‰å°–ç«¯æ€§èƒ½ã€‚åœ¨ä»¥å¾€YOLO ç‰ˆæœ¬çš„åŸºç¡€ä¸Šï¼ŒYOLOv8 å¼•å…¥äº†æ–°çš„åŠŸèƒ½å’Œä¼˜åŒ–ï¼Œä½¿å…¶æˆä¸ºå¹¿æ³›åº”ç”¨ä¸­å„ç§ç‰©ä½“æ£€æµ‹ä»»åŠ¡çš„ç†æƒ³é€‰æ‹©ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586114" alt="image-20250526165954475" title="image-20250526165954475" loading="lazy"/></p><p>YOLOv8åŸç†å›¾å¦‚ä¸‹ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586115" alt="image-20250526170118103" title="image-20250526170118103" loading="lazy"/></p><h3>3.2 æ•°æ®é›†å‡†å¤‡ä¸è®­ç»ƒ</h3><p>é‡‡ç”¨ YOLO æ ¼å¼çš„æ•°æ®é›†ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code class="kotlin">dataset/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ train/
â”‚   â””â”€â”€ val/
â”œâ”€â”€ labels/
â”‚   â”œâ”€â”€ train/
â”‚   â””â”€â”€ val/</code></pre><p>æ¯å¼ å›¾åƒæœ‰å¯¹åº”çš„ <code>.txt</code> æ–‡ä»¶ï¼Œå†…å®¹æ ¼å¼ä¸ºï¼š</p><pre><code class="bash">4 0.5096721233576642 0.352838390077821 0.3947600423357664 0.31825755058365757</code></pre><p>åˆ†ç±»åŒ…æ‹¬ï¼ˆå¯è‡ªå®šä¹‰ï¼‰ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586116" alt="image-20260113003043535" title="image-20260113003043535" loading="lazy"/></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586117" alt="image-20260113003057524" title="image-20260113003057524" loading="lazy"/></p><h3>3.3. è®­ç»ƒç»“æœè¯„ä¼°</h3><p>è®­ç»ƒå®Œæˆåï¼Œå°†åœ¨ <code>runs/detect/train</code> ç›®å½•ç”Ÿæˆç»“æœæ–‡ä»¶ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><code>results.png</code>ï¼šæŸå¤±æ›²çº¿å’Œ mAP æ›²çº¿ï¼›</li><li><code>weights/best.pt</code>ï¼šæœ€ä½³æ¨¡å‹æƒé‡ï¼›</li><li><code>confusion_matrix.png</code>ï¼šæ··æ·†çŸ©é˜µåˆ†æå›¾ã€‚</li></ul><blockquote>è‹¥ mAP@0.5 è¾¾åˆ° 90% ä»¥ä¸Šï¼Œå³å¯ç”¨äºéƒ¨ç½²ã€‚</blockquote><p>åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡è§‚å¯ŸæŸå¤±å‡½æ•°ä¸‹é™çš„æ›²çº¿æ¥è¯„ä¼°æ¨¡å‹çš„è®­ç»ƒçŠ¶æ€ã€‚YOLOv8è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¸»è¦åŒ…å«ä¸‰ç§æŸå¤±ï¼šå®šä½æŸå¤±ï¼ˆbox_lossï¼‰ã€åˆ†ç±»æŸå¤±ï¼ˆcls_lossï¼‰å’ŒåŠ¨æ€ç‰¹å¾æŸå¤±ï¼ˆdfl_lossï¼‰ã€‚è®­ç»ƒå®Œæˆåï¼Œç›¸å…³çš„è®­ç»ƒè®°å½•å’Œç»“æœæ–‡ä»¶ä¼šä¿å­˜åœ¨runs/ç›®å½•ä¸‹ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586118" alt="image-20260113003032560" title="image-20260113003032560" loading="lazy"/></p><h3>3.4æ£€æµ‹ç»“æœè¯†åˆ«</h3><p>ä½¿ç”¨ PyTorch æ¨ç†æ¥å£åŠ è½½æ¨¡å‹ï¼š</p><pre><code class="python">import cv2
from ultralytics import YOLO
import torch
from torch.serialization import safe_globals
from ultralytics.nn.tasks import DetectionModel

# åŠ å…¥å¯ä¿¡æ¨¡å‹ç»“æ„
safe_globals().add(DetectionModel)

# åŠ è½½æ¨¡å‹å¹¶æ¨ç†
model = YOLO('runs/detect/train/weights/best.pt')
results = model('test.jpg', save=True, conf=0.25)

# è·å–ä¿å­˜åçš„å›¾åƒè·¯å¾„
# é»˜è®¤ä¿å­˜åˆ° runs/detect/predict/ ç›®å½•
save_path = results[0].save_dir / results[0].path.name

# ä½¿ç”¨ OpenCV åŠ è½½å¹¶æ˜¾ç¤ºå›¾åƒ
img = cv2.imread(str(save_path))
cv2.imshow('Detection Result', img)
cv2.waitKey(0)
cv2.destroyAllWindows()
</code></pre><p>é¢„æµ‹ç»“æœåŒ…å«ç±»åˆ«ã€ç½®ä¿¡åº¦ã€è¾¹æ¡†åæ ‡ç­‰ä¿¡æ¯ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586119" alt="image-20260113003127122" title="image-20260113003127122" loading="lazy"/></p><h2>å››.YOLOV8+YOLOUIå®Œæ•´æºç æ‰“åŒ…</h2><p>æœ¬æ–‡æ¶‰åŠåˆ°çš„å®Œæ•´å…¨éƒ¨ç¨‹åºæ–‡ä»¶ï¼šåŒ…æ‹¬<strong>pythonæºç ã€æ•°æ®é›†ã€è®­ç»ƒä»£ç ã€UIæ–‡ä»¶ã€æµ‹è¯•å›¾ç‰‡è§†é¢‘</strong>ç­‰ï¼ˆè§ä¸‹å›¾ï¼‰ï¼Œè·å–æ–¹å¼è§ã€4.2 å®Œæ•´æºç ä¸‹è½½ã€‘ï¼š</p><h3>4.1 é¡¹ç›®å¼€ç®±å³ç”¨</h3><p>ä½œè€…å·²å°†æ•´ä¸ªå·¥ç¨‹æ‰“åŒ…ã€‚åŒ…å«å·²è®­ç»ƒå®Œæˆçš„æƒé‡ï¼Œè¯»è€…å¯ä¸ç”¨è‡ªè¡Œè®­ç»ƒç›´æ¥è¿è¡Œæ£€æµ‹ã€‚</p><p>è¿è¡Œé¡¹ç›®åªéœ€è¾“å…¥ä¸‹é¢å‘½ä»¤ã€‚</p><pre><code class="bash">python main.py</code></pre><p>è¯»è€…ä¹Ÿå¯è‡ªè¡Œé…ç½®è®­ç»ƒé›†ï¼Œæˆ–ä½¿ç”¨æ‰“åŒ…å¥½çš„æ•°æ®é›†ç›´æ¥è®­ç»ƒã€‚</p><p>è‡ªè¡Œè®­ç»ƒé¡¹ç›®åªéœ€è¾“å…¥ä¸‹é¢å‘½ä»¤ã€‚</p><pre><code class="bash">yolo detect train data=datasets/expression/loopy.yaml model=yolov8n.yaml pretrained=yolov8n.pt epochs=100 batch=16 lr0=0.001</code></pre><h3>4.2 å®Œæ•´æºç </h3><p>è‡³é¡¹ç›®å®å½•è§†é¢‘ä¸‹æ–¹è·å–ï¼š<a href="https://www.bilibili.com/video/BV1rArjBSEKA/" target="_blank">https://www.bilibili.com/video/BV1rArjBSEKA/</a></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047586120" alt="image-20250801135823301" title="image-20250801135823301" loading="lazy"/></p><p>åŒ…å«ï¼š</p><blockquote><p>ğŸ“¦å®Œæ•´é¡¹ç›®æºç </p><p>ğŸ“¦ é¢„è®­ç»ƒæ¨¡å‹æƒé‡</p><p>ğŸ—‚ï¸ æ•°æ®é›†åœ°å€ï¼ˆå«æ ‡æ³¨è„šæœ¬ï¼‰</p></blockquote><h2>æ€»ç»“</h2><p>æœ¬æ–‡å›´ç»• <strong>åŸºäº YOLOv8 çš„å°éº¦ç”°é—´ç—…å®³è¯†åˆ«ç³»ç»Ÿ</strong>ï¼Œä»æ•°æ®é›†æ„å»ºã€æ¨¡å‹é€‰å‹åˆ°ç³»ç»Ÿé›†æˆä¸åº”ç”¨æ•ˆæœè¿›è¡Œäº†ç³»ç»Ÿæ€§ä»‹ç»ã€‚é¡¹ç›®ä»¥çœŸå®ç”°é—´ç¯å¢ƒä¸æ— äººæœºå·¡æ£€åœºæ™¯ä¸ºèƒŒæ™¯ï¼Œé’ˆå¯¹ <strong>å¤§éº¦é»„çŸ®ç—…ã€å¶é”ˆç—…ã€ç™½ç²‰ç—…åŠå¥åº·å¶ç‰‡</strong> å››ç±»ç›®æ ‡ï¼Œå®ç°äº†ç—…å®³çš„è‡ªåŠ¨æ£€æµ‹ä¸ç²¾å‡†å®šä½ï¼Œæœ‰æ•ˆæå‡äº†å°éº¦ç—…å®³ç›‘æµ‹çš„æ•ˆç‡ä¸è¦†ç›–èŒƒå›´ã€‚</p><p>åœ¨å·¥ç¨‹å®ç°å±‚é¢ï¼Œé¡¹ç›®ä¸ä»…å…³æ³¨æ¨¡å‹è¯†åˆ«ç²¾åº¦ä¸æ¨ç†é€Ÿåº¦ï¼ŒåŒæ—¶æ³¨é‡ç³»ç»Ÿçš„å¯å¤ç°æ€§ä¸å®ç”¨æ€§ï¼Œå®Œæ•´æä¾›äº†æ ‡å‡†åŒ–æ•°æ®é›†ã€YOLOv8 è®­ç»ƒæµç¨‹ã€æ¨¡å‹æƒé‡ä»¥åŠåŸºäº PyQt5 çš„å¯è§†åŒ–æ£€æµ‹ç•Œé¢ï¼Œé™ä½äº†å†œä¸šæ™ºèƒ½è¯†åˆ«ç³»ç»Ÿçš„ä½¿ç”¨ä¸éƒ¨ç½²é—¨æ§›ã€‚é€šè¿‡å¤šè¾“å…¥æºæ£€æµ‹æ¨¡å¼ï¼Œç³»ç»Ÿèƒ½å¤Ÿé€‚é…ä¸åŒè§„æ¨¡ä¸ä¸åŒä½œä¸šæ–¹å¼çš„å†œä¸šç›‘æµ‹éœ€æ±‚ã€‚</p><p>æ€»ä½“è€Œè¨€ï¼Œè¯¥é¡¹ç›®ä¸ºå°éº¦ç—…å®³ä»ä¼ ç»Ÿäººå·¥å·¡æŸ¥å‘æ™ºèƒ½åŒ–ã€è§„æ¨¡åŒ–ç›‘æµ‹è½¬å‹æä¾›äº†å¯è½åœ°çš„æŠ€æœ¯æ–¹æ¡ˆã€‚æœªæ¥å¯åœ¨æ­¤åŸºç¡€ä¸Šè¿›ä¸€æ­¥æ‹“å±•ç—…å®³ä¸¥é‡ç¨‹åº¦åˆ†çº§ã€å¤šæ—¶åºå˜åŒ–åˆ†æã€æ— äººæœºé›†ç¾¤ååŒå·¡æ£€ä»¥åŠä¸å†œä¸šç®¡ç†å¹³å°çš„æ•°æ®å¯¹æ¥ï¼Œä¸ºæ™ºæ…§å†œä¸šä¸ç²¾å‡†é˜²æ²»æä¾›æ›´å®Œå–„çš„æŠ€æœ¯æ”¯æ’‘ã€‚</p>]]></description></item><item>    <title><![CDATA[ECS æ¶æ„æ·±åº¦è§£æï¼šä» OOP åˆ°æ•°æ®é©±åŠ¨çš„æ¸¸æˆå¼€å‘é©å‘½ jump__jump ]]></title>    <link>https://segmentfault.com/a/1190000047586201</link>    <guid>https://segmentfault.com/a/1190000047586201</guid>    <pubDate>2026-02-01 22:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>å¼•è¨€ï¼šä¸€ä¸ªæ¸¸æˆå¼€å‘ä¸­çš„ç»å…¸éš¾é¢˜</h2><p>æƒ³è±¡ä½ æ­£åœ¨å¼€å‘ä¸€æ¬¾ RPG æ¸¸æˆï¼Œæ¸¸æˆä¸­æœ‰è¿™æ ·å‡ ç§è§’è‰²ï¼š</p><ul><li><strong>ç©å®¶è§’è‰²</strong>ï¼šå¯ä»¥ç§»åŠ¨ã€æ”»å‡»ã€ä½¿ç”¨æŠ€èƒ½ã€è£…å¤‡æ­¦å™¨</li><li><strong>NPC å•†äºº</strong>ï¼šå¯ä»¥ç§»åŠ¨ã€å¯äº¤äº’ã€æœ‰åº“å­˜ç³»ç»Ÿ</li><li><strong>æ€ªç‰©</strong>ï¼šå¯ä»¥ç§»åŠ¨ã€æ”»å‡»ã€æœ‰AI</li><li><strong>å¯ç ´åçš„ç®±å­</strong>ï¼šå¯ä»¥è¢«æ”»å‡»ã€æœ‰ç”Ÿå‘½å€¼ã€å¯æ‰è½ç‰©å“</li></ul><p>å¦‚æœä½ ä½¿ç”¨ä¼ ç»Ÿçš„<strong>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰</strong>ï¼Œä½ å¯èƒ½ä¼šè®¾è®¡è¿™æ ·çš„ç»§æ‰¿ç»“æ„ï¼š</p><pre><code>GameObject
â”œâ”€â”€ Character
â”‚   â”œâ”€â”€ Player (ç§»åŠ¨ + æ”»å‡» + æŠ€èƒ½ + èƒŒåŒ…)
â”‚   â”œâ”€â”€ Monster (ç§»åŠ¨ + æ”»å‡» + AI)
â”‚   â””â”€â”€ NPC (ç§»åŠ¨ + äº¤äº’ + åº“å­˜)
â””â”€â”€ DestructibleObject
    â””â”€â”€ Crate (ç”Ÿå‘½å€¼ + æ‰è½)</code></pre><p>çœ‹èµ·æ¥å¾ˆåˆç†ï¼Œå¯¹å§ï¼Ÿä½†å¾ˆå¿«ä½ ä¼šé‡åˆ°é—®é¢˜ï¼š</p><ol><li><strong>éœ€æ±‚å˜åŒ–</strong>ï¼šç­–åˆ’è¦æ±‚ç®±å­ä¹Ÿèƒ½ç§»åŠ¨ï¼ˆå˜æˆæ»šåŠ¨çš„æ¡¶ï¼‰</li><li><strong>åŠŸèƒ½é‡ç”¨</strong>ï¼šæ€ªç‰©å’Œç®±å­éƒ½æœ‰ç”Ÿå‘½å€¼ï¼Œä½†ä»£ç é‡å¤äº†</li><li><strong>å¤šé‡ç»§æ‰¿</strong>ï¼šé£è¡Œæ€ªç‰©æ—¢è¦ç»§æ‰¿ Monsterï¼Œåˆè¦ç»§æ‰¿ Flyableï¼Ÿ</li><li><strong>æ€§èƒ½ç“¶é¢ˆ</strong>ï¼š10,000 ä¸ªæ€ªç‰©çš„ AI æ›´æ–°å¯¼è‡´ä¸¥é‡å¡é¡¿</li></ol><p>è¿™å°±æ˜¯ <strong>ECSï¼ˆEntity-Component-Systemï¼‰</strong> æ¶æ„è¯ç”Ÿçš„åŸå› ã€‚å®ƒä»æ ¹æœ¬ä¸Šæ”¹å˜äº†æˆ‘ä»¬æ€è€ƒæ¸¸æˆå¯¹è±¡çš„æ–¹å¼ã€‚</p><hr/><h2>ä¸€ã€ä»€ä¹ˆæ˜¯ ECSï¼Ÿ</h2><p><strong>ECS</strong> æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„æ¨¡å¼ï¼Œå°†æ¸¸æˆå¯¹è±¡çš„<strong>èº«ä»½</strong>ã€<strong>æ•°æ®</strong>å’Œ<strong>è¡Œä¸º</strong>å½»åº•åˆ†ç¦»ï¼š</p><blockquote><p><strong>æ³¨</strong>ï¼šæœ¬æ–‡æ‰€æœ‰ä»£ç ç¤ºä¾‹ä½¿ç”¨ Rust è¯­è¨€ç¼–å†™ï¼Œä½† ECS æ¦‚å¿µé€‚ç”¨äºä»»ä½•ç¼–ç¨‹è¯­è¨€ã€‚</p><p>ç¤ºä¾‹ä¸­ä½¿ç”¨çš„é€šç”¨ç±»å‹å®šä¹‰ï¼š</p><pre><code class="rust">type Entity = u32;                    // å®ä½“ ID
struct Vec2 { x: f32, y: f32 }        // 2D å‘é‡
struct Vec3 { x: f32, y: f32, z: f32 }  // 3D å‘é‡
struct Quat { /* å››å…ƒæ•° */ }           // æ—‹è½¬
struct Color { r: f32, g: f32, b: f32, a: f32 }  // é¢œè‰²
struct Item { /* ç‰©å“æ•°æ® */ }         // ç‰©å“

// ECS æ¡†æ¶æä¾›çš„ç±»å‹ï¼ˆç±»ä¼¼ Bevy é£æ ¼ï¼‰
struct Query&lt;T&gt; { /* æŸ¥è¯¢æ¥å£ */ }
struct Res&lt;T&gt; { /* èµ„æºè®¿é—® */ }
struct Time { /* æ—¶é—´ç®¡ç† */ }
struct World { /* å®ä½“ä¸–ç•Œ */ }</code></pre></blockquote><h3>ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ</h3><h4>1. Entityï¼ˆå®ä½“ï¼‰</h4><ul><li><strong>æœ¬è´¨</strong>ï¼šä¸€ä¸ªå”¯ä¸€çš„ IDï¼ˆé€šå¸¸æ˜¯æ•´æ•°ï¼‰</li><li><strong>ä½œç”¨</strong>ï¼šæ ‡è¯†æ¸¸æˆä¸­çš„"å¯¹è±¡"ï¼Œä½†è‡ªå·±ä¸åŒ…å«ä»»ä½•æ•°æ®æˆ–é€»è¾‘</li><li><strong>ç±»æ¯”</strong>ï¼šå°±åƒæ•°æ®åº“ä¸­çš„ä¸»é”®ï¼Œæˆ–è€…ä¸€å¼ "èº«ä»½è¯å·"</li></ul><pre><code class="rust">// å®ä½“åªæ˜¯ä¸€ä¸ªIDï¼ˆé€šå¸¸æ˜¯æ•´æ•°ï¼‰
let entity_player: u32 = 1001;
let entity_monster: u32 = 1002;
let entity_crate: u32 = 1003;</code></pre><h4>2. Componentï¼ˆç»„ä»¶ï¼‰</h4><ul><li><strong>æœ¬è´¨</strong>ï¼šçº¯ç²¹çš„æ•°æ®å®¹å™¨ï¼ˆPlain Old Dataï¼‰</li><li><strong>ä½œç”¨</strong>ï¼šå­˜å‚¨æ¸¸æˆçŠ¶æ€ï¼ˆå¦‚ä½ç½®ã€é€Ÿåº¦ã€ç”Ÿå‘½å€¼ï¼‰</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<strong>æ²¡æœ‰ä»»ä½•æ–¹æ³•</strong>ï¼Œåªæœ‰å±æ€§</li></ul><pre><code class="rust">// ç»„ä»¶åªæœ‰æ•°æ®ï¼Œæ²¡æœ‰é€»è¾‘
// #[derive(Component)] å®è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª ECS ç»„ä»¶
#[derive(Component, Clone, Copy, Debug)]
struct Position {
    x: f32,
    y: f32,
}

#[derive(Component, Clone, Copy, Debug)]
struct Health {
    current: i32,
    max: i32,
}

#[derive(Component, Clone, Copy, Debug)]
struct Velocity {
    dx: f32,
    dy: f32,
}</code></pre><h4>3. Systemï¼ˆç³»ç»Ÿï¼‰</h4><ul><li><strong>æœ¬è´¨</strong>ï¼šçº¯ç²¹çš„é€»è¾‘å¤„ç†å™¨</li><li><strong>ä½œç”¨</strong>ï¼šå¯¹æ‹¥æœ‰ç‰¹å®šç»„ä»¶çš„å®ä½“æ‰§è¡Œæ“ä½œ</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<strong>æ²¡æœ‰æ•°æ®</strong>ï¼Œåªæœ‰è¡Œä¸º</li></ul><pre><code class="rust">// ç³»ç»Ÿåªæœ‰é€»è¾‘ï¼Œæ“ä½œç»„ä»¶æ•°æ®
fn movement_system(
    positions: &amp;mut [Position],
    velocities: &amp;[Velocity],
    dt: f32,
) {
    for i in 0..positions.len() {
        positions[i].x += velocities[i].dx * dt;
        positions[i].y += velocities[i].dy * dt;
    }
}

fn damage_system(
    entities: &amp;[Entity],
    healths: &amp;mut [Health],
) {
    for i in 0..healths.len() {
        if healths[i].current &lt;= 0 {
            destroy_entity(entities[i]);
        }
    }
}

// è¾…åŠ©å‡½æ•°ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰
fn destroy_entity(entity: Entity) {
    // é”€æ¯å®ä½“é€»è¾‘
}</code></pre><h4>4. Resourceï¼ˆèµ„æºï¼‰</h4><ul><li><strong>æœ¬è´¨</strong>ï¼šå…¨å±€å…±äº«çš„æ•°æ®ï¼ˆå•ä¾‹ï¼‰</li><li><strong>ä½œç”¨</strong>ï¼šå­˜å‚¨ä¸å±äºä»»ä½•å®ä½“çš„æ•°æ®ï¼ˆå¦‚æ—¶é—´ã€è¾“å…¥ã€é…ç½®ï¼‰</li><li><strong>ç‰¹ç‚¹</strong>ï¼šæ•´ä¸ªæ¸¸æˆä¸–ç•Œåªæœ‰ä¸€ä»½</li></ul><pre><code class="rust">// Resource ç¤ºä¾‹
#[derive(Resource, Debug)]
struct Time {
    delta: f32,        // å¸§é—´éš”æ—¶é—´
    elapsed: f32,      // æ¸¸æˆè¿è¡Œæ—¶é—´
}

#[derive(Resource, Debug)]
struct GameConfig {
    window_width: u32,
    window_height: u32,
}

// System ä¸­è®¿é—® Resource
fn time_system(time: Res&lt;Time&gt;) {
    println!("Delta: {}", time.delta);
}</code></pre><h4>5. Commandsï¼ˆå‘½ä»¤ï¼‰</h4><ul><li><strong>æœ¬è´¨</strong>ï¼šå»¶è¿Ÿæ‰§è¡Œçš„æ“ä½œé˜Ÿåˆ—</li><li><strong>ä½œç”¨</strong>ï¼šå®‰å…¨åœ°åˆ›å»º/åˆ é™¤å®ä½“ã€æ·»åŠ /ç§»é™¤ç»„ä»¶</li><li><strong>ç‰¹ç‚¹</strong>ï¼šåœ¨å½“å‰å¸§ç»“æŸåæ‰§è¡Œï¼Œé¿å…è¿­ä»£ä¸­ä¿®æ”¹</li></ul><pre><code class="rust">// ä½¿ç”¨ Commands åˆ›å»ºå®ä½“
fn spawn_enemy_system(mut commands: Commands) {
    commands.spawn((
        Position { x: 100.0, y: 100.0 },
        Velocity { dx: -10.0, dy: 0.0 },
        Health { current: 50, max: 50 },
        Enemy,  // æ ‡è®°ç»„ä»¶
    ));
}

// ä½¿ç”¨ Commands åˆ é™¤å®ä½“
fn cleanup_dead_system(
    mut commands: Commands,
    query: Query&lt;(Entity, &amp;Health)&gt;,
) {
    for (entity, health) in query.iter() {
        if health.current &lt;= 0 {
            commands.entity(entity).despawn();  // å»¶è¿Ÿåˆ é™¤
        }
    }
}</code></pre><hr/><h3>ECS æ ¸å¿ƒæ€æƒ³</h3><blockquote><strong>ç»„åˆä¼˜äºç»§æ‰¿ï¼ˆComposition over Inheritanceï¼‰</strong></blockquote><p>åœ¨ ECS ä¸­ï¼Œä¸€ä¸ªå®ä½“çš„"ç±»å‹"ä¸æ˜¯ç”±ç»§æ‰¿å…³ç³»å†³å®šï¼Œè€Œæ˜¯ç”±å®ƒæ‹¥æœ‰çš„ç»„ä»¶ç»„åˆå†³å®šï¼š</p><pre><code class="rust">// å®šä¹‰è¾…åŠ©ç±»å‹
#[derive(Component, Default, Debug)]
struct Inventory {
    items: Vec&lt;Item&gt;,
}

#[derive(Clone, Copy, Debug)]
enum AIState {
    Patrol,
    Chase,
    Attack,
}

#[derive(Component, Debug)]
struct AI {
    state: AIState,
}

// ç©å®¶ = Entity + Position + Velocity + Health + Inventory
let player = world.spawn()
    .insert(Position { x: 0.0, y: 0.0 })
    .insert(Velocity { dx: 0.0, dy: 0.0 })
    .insert(Health { current: 100, max: 100 })
    .insert(Inventory::default())
    .id();

// æ€ªç‰© = Entity + Position + Velocity + Health + AI
let monster = world.spawn()
    .insert(Position { x: 10.0, y: 10.0 })
    .insert(Velocity { dx: 1.0, dy: 0.0 })
    .insert(Health { current: 50, max: 50 })
    .insert(AI { state: AIState::Patrol })
    .id();

// å¯ç§»åŠ¨çš„ç®±å­ = Entity + Position + Velocity + Health
let crate_entity = world.spawn()
    .insert(Position { x: 5.0, y: 5.0 })
    .insert(Velocity { dx: 0.5, dy: 0.0 })  // ç°åœ¨ç®±å­ä¹Ÿèƒ½æ»šåŠ¨äº†ï¼
    .insert(Health { current: 20, max: 20 })
    .id();</code></pre><hr/><h2>äºŒã€æ¶æ„æ¼”è¿›ï¼šä» OOP åˆ° ECS</h2><h3>2.1 ä¼ ç»Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰</h3><h4>è®¾è®¡ç†å¿µ</h4><ul><li><strong>å°è£…</strong>ï¼šæ•°æ®å’Œè¡Œä¸ºç»‘å®šåœ¨ä¸€èµ·</li><li><strong>ç»§æ‰¿</strong>ï¼šé€šè¿‡ç±»å±‚æ¬¡ç»“æ„å¤ç”¨ä»£ç </li><li><strong>å¤šæ€</strong>ï¼šå­ç±»å¯ä»¥é‡å†™çˆ¶ç±»æ–¹æ³•</li></ul><h4>ç¤ºä¾‹ä»£ç </h4><pre><code class="rust">// OOP æ–¹å¼ï¼ˆRust ä¸æ”¯æŒç»§æ‰¿ï¼Œéœ€è¦ç»„åˆæˆ– traitï¼‰

// åŸºç¡€æ¸¸æˆå¯¹è±¡
struct GameObject {
    position: Vec2,
}

impl GameObject {
    fn update(&amp;mut self) {
        // åŸºç¡€é€»è¾‘
    }
}

// è§’è‰²ï¼ˆåŒ…å«æ›´å¤šå­—æ®µï¼‰
struct Character {
    position: Vec2,
    health: i32,
    speed: f32,
    velocity: Vec2,
}

impl Character {
    fn update(&amp;mut self, delta_time: f32) {
        // ç§»åŠ¨é€»è¾‘
        self.position.x += self.velocity.x * delta_time;
        self.position.y += self.velocity.y * delta_time;
    }

    fn take_damage(&amp;mut self, damage: i32) {
        self.health -= damage;
    }
}

// ç©å®¶ï¼ˆéœ€è¦é‡å¤ Character çš„æ‰€æœ‰å­—æ®µ - ç»§æ‰¿é—®é¢˜ï¼‰
struct Player {
    position: Vec2,
    health: i32,
    speed: f32,
    velocity: Vec2,
    inventory: Vec&lt;String&gt;,  // ç©å®¶ç‰¹æœ‰å­—æ®µ
}

impl Player {
    fn update(&amp;mut self, delta_time: f32) {
        // ç§»åŠ¨é€»è¾‘ï¼ˆä»£ç é‡å¤ï¼ï¼‰
        self.position.x += self.velocity.x * delta_time;
        self.position.y += self.velocity.y * delta_time;
        // ç©å®¶ç‰¹æœ‰é€»è¾‘
        self.handle_input();
    }

    fn handle_input(&amp;mut self) {
        // è¾“å…¥å¤„ç†
    }
}</code></pre><h4>ä¼˜ç‚¹</h4><p>âœ… ç›´è§‚æ˜“æ‡‚ï¼Œç¬¦åˆäººç±»æ€ç»´<br/>âœ… é€‚åˆå°å‹é¡¹ç›®å¿«é€Ÿå¼€å‘<br/>âœ… IDE æ”¯æŒå¥½ï¼Œè°ƒè¯•æ–¹ä¾¿</p><h4>ç¼ºç‚¹</h4><p>âŒ <strong>ç»§æ‰¿åœ°ç‹±</strong>ï¼šæ·±å±‚æ¬¡ç»§æ‰¿éš¾ä»¥ç»´æŠ¤<br/>âŒ <strong>åƒµåŒ–çš„ç»“æ„</strong>ï¼šä¿®æ”¹åŸºç±»å½±å“æ‰€æœ‰å­ç±»<br/>âŒ <strong>æ€§èƒ½é—®é¢˜</strong>ï¼šå¯¹è±¡åˆ†æ•£åœ¨å†…å­˜ä¸­ï¼Œç¼“å­˜ä¸å‹å¥½<br/>âŒ <strong>å¤šé‡ç»§æ‰¿å›°å¢ƒ</strong>ï¼šC# ä¸æ”¯æŒï¼ŒC++ å®¹æ˜“æ··ä¹±</p><hr/><h3>2.2 GameObject-Component æ¨¡å¼ï¼ˆUnity ç»å…¸æ¶æ„ï¼‰</h3><h4>è®¾è®¡ç†å¿µ</h4><ul><li><strong>ç»„ä»¶åŒ–</strong>ï¼šGameObject æ˜¯å®¹å™¨ï¼ŒComponent æä¾›åŠŸèƒ½</li><li><strong>ç»„åˆä¼˜äºç»§æ‰¿</strong>ï¼šé€šè¿‡æ·»åŠ ç»„ä»¶æ‰©å±•åŠŸèƒ½</li></ul><h4>ç¤ºä¾‹ä»£ç </h4><pre><code class="rust">// GameObject-Component æ¨¡å¼ï¼ˆç±»ä¼¼ Unity é£æ ¼ï¼‰

// ç»„ä»¶å®šä¹‰
struct Transform {
    position: Vec3,
    rotation: Vec3,
}

struct Rigidbody {
    velocity: Vec3,
}

impl Rigidbody {
    fn fixed_update(&amp;mut self, transform: &amp;mut Transform, fixed_delta_time: f32) {
        // ç‰©ç†æ›´æ–°ï¼ˆéœ€è¦æ‰‹åŠ¨è·å– Transform å¼•ç”¨ï¼‰
        transform.position.x += self.velocity.x * fixed_delta_time;
        transform.position.y += self.velocity.y * fixed_delta_time;
        transform.position.z += self.velocity.z * fixed_delta_time;
    }
}

struct PlayerController {
    speed: f32,
}

impl PlayerController {
    fn update(&amp;mut self, rigidbody: &amp;mut Rigidbody, input: f32) {
        // è·å–è¾“å…¥ï¼ˆéœ€è¦æ‰‹åŠ¨ä¼ é€’ Rigidbody å¼•ç”¨ï¼‰
        rigidbody.velocity.x = input * self.speed;
        rigidbody.velocity.y = 0.0;
        rigidbody.velocity.z = 0.0;
    }
}

// é—®é¢˜ï¼š
// 1. GetComponent æŸ¥æ‰¾å¼€é”€å¤§
// 2. ç»„ä»¶é—´ä¾èµ–éœ€è¦æ‰‹åŠ¨ç®¡ç†
// 3. ç»„ä»¶åˆ†æ•£å­˜å‚¨ï¼Œç¼“å­˜ä¸å‹å¥½</code></pre><h4>ä¼˜ç‚¹</h4><p>âœ… çµæ´»ç»„åˆï¼Œé¿å…æ·±å±‚ç»§æ‰¿<br/>âœ… ç»„ä»¶å¯å¤ç”¨<br/>âœ… è®¾è®¡å™¨å‹å¥½ï¼ˆå¯è§†åŒ–ç¼–è¾‘ï¼‰</p><h4>ç¼ºç‚¹</h4><p>âŒ <strong>GetComponent å¼€é”€</strong>ï¼šé¢‘ç¹æŸ¥æ‰¾ç»„ä»¶æ€§èƒ½å·®<br/>âŒ <strong>å†…å­˜å¸ƒå±€æ··ä¹±</strong>ï¼šç»„ä»¶åˆ†æ•£å­˜å‚¨ï¼Œç¼“å­˜æœªå‘½ä¸­ç‡é«˜<br/>âŒ <strong>ä¾èµ–ç®¡ç†å¤æ‚</strong>ï¼šç»„ä»¶é—´è€¦åˆéš¾ä»¥è¿½è¸ª<br/>âŒ <strong>éš¾ä»¥å¹¶è¡ŒåŒ–</strong>ï¼šUpdate æŒ‰å¯¹è±¡é¡ºåºæ‰§è¡Œ</p><hr/><h3>2.3 ECS æ¶æ„ï¼ˆç°ä»£æ•°æ®é©±åŠ¨è®¾è®¡ï¼‰</h3><h4>è®¾è®¡ç†å¿µ</h4><ul><li><strong>æ•°æ®ä¸é€»è¾‘åˆ†ç¦»</strong>ï¼šComponent åªæœ‰æ•°æ®ï¼ŒSystem åªæœ‰é€»è¾‘</li><li><strong>æ•°æ®å±€éƒ¨æ€§</strong>ï¼šç›¸åŒç»„ä»¶ç´§å¯†æ’åˆ—åœ¨å†…å­˜ä¸­</li><li><strong>æ‰¹é‡å¤„ç†</strong>ï¼šSystem ä¸€æ¬¡å¤„ç†æˆåƒä¸Šä¸‡ä¸ªå®ä½“</li></ul><h4>ç¤ºä¾‹ä»£ç ï¼ˆä¼ªä»£ç ï¼‰</h4><pre><code class="rust">// ç»„ä»¶å®šä¹‰ï¼ˆçº¯æ•°æ®ï¼‰
#[derive(Component, Debug)]
struct Transform {
    position: Vec3,
    rotation: Quat,
}

#[derive(Component, Clone, Copy, Debug)]
struct Rigidbody {
    velocity: Vec3,
    mass: f32,
}

#[derive(Component, Clone, Debug)]
struct Mesh {
    vertices: Vec&lt;Vec3&gt;,
}

#[derive(Component, Clone, Copy, Debug)]
struct Material {
    color: Color,
}

// ç³»ç»Ÿå®šä¹‰ï¼ˆçº¯é€»è¾‘ï¼‰
fn physics_system(
    query: Query&lt;(&amp;mut Transform, &amp;Rigidbody)&gt;,
    time: Res&lt;Time&gt;,
) {
    let dt = time.delta_seconds();
    // æ‰¹é‡å¤„ç†æ‰€æœ‰æ‹¥æœ‰ Transform + Rigidbody çš„å®ä½“
    for (mut transform, rigidbody) in query.iter() {
        transform.position.x += rigidbody.velocity.x * dt;
        transform.position.y += rigidbody.velocity.y * dt;
        transform.position.z += rigidbody.velocity.z * dt;
    }
}

fn render_system(
    query: Query&lt;(&amp;Transform, &amp;Mesh, &amp;Material)&gt;,
) {
    for (transform, mesh, material) in query.iter() {
        draw(mesh, material, &amp;transform.position);
    }
}

// è¾…åŠ©å‡½æ•°
fn draw(mesh: &amp;Mesh, material: &amp;Material, position: &amp;Vec3) {
    // æ¸²æŸ“é€»è¾‘
}</code></pre><h4>ä¼˜ç‚¹</h4><p>âœ… <strong>æè‡´æ€§èƒ½</strong>ï¼šç¼“å­˜å‹å¥½çš„å†…å­˜å¸ƒå±€<br/>âœ… <strong>å¤©ç„¶å¹¶è¡ŒåŒ–</strong>ï¼šSystem é—´æ— ä¾èµ–å¯å¹¶è¡Œ<br/>âœ… <strong>é«˜åº¦å¯æ‰©å±•</strong>ï¼šæ·»åŠ æ–°ç»„ä»¶/ç³»ç»Ÿæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç <br/>âœ… <strong>æ˜“äºæµ‹è¯•</strong>ï¼šæ•°æ®å’Œé€»è¾‘åˆ†ç¦»ï¼Œå•å…ƒæµ‹è¯•ç®€å•</p><h4>ç¼ºç‚¹</h4><p>âŒ <strong>å­¦ä¹ æ›²çº¿é™¡å³­</strong>ï¼šæ€ç»´æ–¹å¼è½¬å˜<br/>âŒ <strong>è°ƒè¯•å›°éš¾</strong>ï¼šæ²¡æœ‰å¯¹è±¡æ¦‚å¿µï¼Œéš¾ä»¥è¿½è¸ªå•ä¸ªå®ä½“<br/>âŒ <strong>è¿‡åº¦å·¥ç¨‹</strong>ï¼šå°é¡¹ç›®åè€Œå¢åŠ å¤æ‚åº¦</p><hr/><h2>ä¸‰ã€ECS æ€§èƒ½ä¼˜åŠ¿çš„æœ¬è´¨ï¼šæ•°æ®å¯¼å‘è®¾è®¡ï¼ˆDODï¼‰</h2><h3>3.1 CPU ç¼“å­˜åŸç†é€Ÿæˆ</h3><p>ç°ä»£ CPU çš„å†…å­˜å±‚æ¬¡ç»“æ„ï¼š</p><pre><code>CPU å¯„å­˜å™¨      ~1 çº³ç§’     å‡ ç™¾å­—èŠ‚
L1 ç¼“å­˜         ~1 çº³ç§’     32-64 KB
L2 ç¼“å­˜         ~3 çº³ç§’     256-512 KB
L3 ç¼“å­˜         ~12 çº³ç§’    8-32 MB
ä¸»å†…å­˜ï¼ˆRAMï¼‰   ~100 çº³ç§’   å‡  GB
ç¡¬ç›˜            å‡ æ¯«ç§’      å‡  TB</code></pre><p><strong>å…³é”®äº‹å®</strong>ï¼šä»å†…å­˜è¯»æ•°æ®æ¯”ä» L1 ç¼“å­˜æ…¢ <strong>100 å€</strong>ï¼</p><p>CPU ä¼šè‡ªåŠ¨å°†å³å°†è®¿é—®çš„æ•°æ®åŠ è½½åˆ°ç¼“å­˜ï¼ˆ<strong>é¢„å–</strong>ï¼‰ï¼Œä½†æœ‰ä¸ªå‰æï¼š<strong>æ•°æ®å¿…é¡»æ˜¯è¿ç»­çš„</strong>ã€‚</p><hr/><h3>3.2 OOP çš„å†…å­˜å¸ƒå±€é—®é¢˜</h3><p>å‡è®¾æœ‰ 10,000 ä¸ªæ€ªç‰©ï¼Œæ¯ä¸ªæ€ªç‰©éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼š</p><pre><code class="rust">// OOP æ–¹å¼ï¼šå¯¹è±¡åˆ†æ•£åœ¨å †å†…å­˜ä¸­
struct Monster {
    id: u32,            // 4 å­—èŠ‚
    position: Vec3,     // 12 å­—èŠ‚
    velocity: Vec3,     // 12 å­—èŠ‚
    health: i32,        // 4 å­—èŠ‚
    ai: Box&lt;AI&gt;,        // 8 å­—èŠ‚ï¼ˆæŒ‡é’ˆï¼‰
    mesh: Box&lt;Mesh&gt;,    // 8 å­—èŠ‚
    // ... å…¶ä»–æˆå‘˜
}

// 10000 ä¸ªå¯¹è±¡åœ¨å †ä¸Šåˆ†æ•£å­˜å‚¨
let monsters: Vec&lt;Box&lt;Monster&gt;&gt; = Vec::with_capacity(10000);</code></pre><p><strong>å†…å­˜å¸ƒå±€ç¤ºæ„</strong>ï¼š</p><pre><code>AoS (Array of Structures) - OOP æ–¹å¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
å†…å­˜åœ°å€     å¯¹è±¡å†…å®¹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0x1000      [Monster1: id|pos|vel|hp|ai*|mesh*| ... ]  48 å­—èŠ‚
            â†“ (å¯èƒ½ä¸­é—´æœ‰å…¶ä»–å¯¹è±¡ï¼Œå†…å­˜ä¸è¿ç»­)
0x5000      [Monster2: id|pos|vel|hp|ai*|mesh*| ... ]  48 å­—èŠ‚
            â†“
0x9000      [Monster3: id|pos|vel|hp|ai*|mesh*| ... ]  48 å­—èŠ‚
            ...

é—®é¢˜ï¼š
âŒ æ›´æ–°ä½ç½®æ—¶ï¼ŒCPU éœ€è¦åŠ è½½æ•´ä¸ª Monster ç»“æ„ï¼ˆ48 å­—èŠ‚ï¼‰
âŒ ä¸‹ä¸€ä¸ª Monster å¯èƒ½åœ¨å®Œå…¨ä¸åŒçš„å†…å­˜åœ°å€
âŒ ç¼“å­˜è¡Œï¼ˆ64 å­—èŠ‚ï¼‰è¢«å¤§é‡æ— ç”¨æ•°æ®å æ®
âŒ CPU é¢„å–å¤±æ•ˆï¼Œç¼“å­˜æœªå‘½ä¸­ç‡ 70-90%
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SoA (Structure of Arrays) - ECS æ–¹å¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ç»„ä»¶ç±»å‹      å†…å­˜å¸ƒå±€ï¼ˆè¿ç»­ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
IDs:         [1|2|3|4|5|6|7|8|...] â† 10000 ä¸ªè¿ç»­
Positions:   [pos1|pos2|pos3|pos4|...] â† åªè¯»è¿™ä¸€è¡Œï¼
Velocities:  [vel1|vel2|vel3|vel4|...]
Healths:     [hp1|hp2|hp3|hp4|...]
...

ä¼˜åŠ¿ï¼š
âœ… ç§»åŠ¨ç³»ç»Ÿåªè®¿é—® Position å’Œ Velocity æ•°ç»„
âœ… æ•°æ®ç´§å¯†æ’åˆ—ï¼ŒCPU ä¸€æ¬¡ç¼“å­˜è¡Œå¯åŠ è½½ 4-5 ä¸ªå®ä½“
âœ… CPU ç¡¬ä»¶é¢„å–ç”Ÿæ•ˆï¼Œè‡ªåŠ¨åŠ è½½åç»­æ•°æ®
âœ… ç¼“å­˜å‘½ä¸­ç‡ 95%+ï¼Œé€Ÿåº¦æå‡ 10-50 å€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre><p><strong>é—®é¢˜</strong>ï¼šæ›´æ–°æ‰€æœ‰æ€ªç‰©ä½ç½®æ—¶ï¼ŒCPU éœ€è¦ï¼š</p><ol><li>è·³è½¬åˆ° Monster1 çš„å†…å­˜åœ°å€</li><li>åŠ è½½æ•´ä¸ªå¯¹è±¡åˆ°ç¼“å­˜ï¼ˆå³ä½¿åªéœ€è¦ positionï¼‰</li><li>è·³è½¬åˆ° Monster2 çš„å†…å­˜åœ°å€ï¼ˆå¯èƒ½å¯¼è‡´ç¼“å­˜å¤±æ•ˆï¼‰</li><li>é‡å¤ 10,000 æ¬¡...</li></ol><p><strong>ç¼“å­˜æœªå‘½ä¸­ç‡</strong>ï¼š~70-90%ï¼ˆå¤§é‡æ—¶é—´æµªè´¹åœ¨ç­‰å¾…å†…å­˜ï¼‰</p><hr/><h3>3.3 ECS çš„å†…å­˜å¸ƒå±€ä¼˜åŒ–</h3><h4>Archetypeï¼ˆåŸå‹ï¼‰å­˜å‚¨</h4><p>ECS å°†æ‹¥æœ‰<strong>ç›¸åŒç»„ä»¶ç»„åˆ</strong>çš„å®ä½“å­˜å‚¨åœ¨ä¸€èµ·ï¼š</p><pre><code>Archetype: [Position, Velocity, Health]</code></pre><p><strong>å†…å­˜å¸ƒå±€ï¼ˆStructure of Arraysï¼ŒSoAï¼‰</strong>ï¼š</p><pre><code>Archetype: [Position, Velocity, Health]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        Chunk 0 (16KB)              Chunk 1 (16KB)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Positions  (Ã—100)   â”‚     â”‚ Positions  (Ã—100)   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Velocities (Ã—100)   â”‚     â”‚ Velocities (Ã—100)   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Healths    (Ã—100)   â”‚     â”‚ Healths    (Ã—100)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ è¿ç»­å†…å­˜                   â†“ è¿ç»­å†…å­˜

è¯¦ç»†è§†å›¾ï¼ˆChunk 0 çš„ Position æ•°ç»„ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚pos0â”‚pos1â”‚pos2â”‚pos3â”‚pos4â”‚ ... â”‚pos98â”‚pos99â”‚     â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
  12B  12B  12B  12B  12B   ...  12B   12B
  â†‘                                        â†‘
  CPU ç¼“å­˜è¡Œå¯ä»¥ä¸€æ¬¡åŠ è½½ 5-6 ä¸ª Vec3 (64å­—èŠ‚)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre><p><strong>å¤„ç†æµç¨‹</strong>ï¼š</p><pre><code class="rust">// ç§»åŠ¨ç³»ç»Ÿåªéœ€è¦ Position å’Œ Velocity
fn movement_system(
    positions: &amp;mut [Position],    // è¿ç»­å†…å­˜å—
    velocities: &amp;[Velocity],       // è¿ç»­å†…å­˜å—
    dt: f32,
) {
    // CPU å¯ä»¥é«˜æ•ˆåœ°é¢„å–æ•°æ®
    for i in 0..positions.len() {
        positions[i].x += velocities[i].dx * dt;
        positions[i].y += velocities[i].dy * dt;
    }
}</code></pre><p><strong>æ€§èƒ½æå‡</strong>ï¼š</p><ul><li><strong>ç¼“å­˜å‘½ä¸­ç‡</strong>ï¼š~95% ï¼ˆæ•°æ®è¿ç»­ï¼ŒCPU é¢„å–ç”Ÿæ•ˆï¼‰</li><li><strong>SIMD å‘é‡åŒ–</strong>ï¼šå¯ä»¥ä¸€æ¬¡å¤„ç† 4-8 ä¸ªå®ä½“ï¼ˆAVX æŒ‡ä»¤é›†ï¼‰</li><li><strong>å®æµ‹é€Ÿåº¦</strong>ï¼šæ¯” OOP å¿« <strong>10-50 å€</strong>ï¼ˆå¤„ç†å¤§é‡å®ä½“æ—¶ï¼‰</li></ul><hr/><h3>3.4 å®é™…æ€§èƒ½å¯¹æ¯”</h3><p>æ¥è‡ªä¸šç•Œçš„çœŸå®æ•°æ®ï¼š</p><table><thead><tr><th>æ¶æ„</th><th>æ›´æ–° 10,000 ä¸ªå®ä½“</th><th>ç¼“å­˜æœªå‘½ä¸­ç‡</th></tr></thead><tbody><tr><td><strong>ä¼ ç»Ÿ OOP</strong></td><td>12.5 ms</td><td>75%</td></tr><tr><td><strong>GameObject-Component</strong></td><td>8.3 ms</td><td>60%</td></tr><tr><td><strong>ECS (Archetype)</strong></td><td>0.8 ms</td><td>5%</td></tr></tbody></table><p><strong>æ¡ˆä¾‹ï¼šã€Šå®ˆæœ›å…ˆé”‹ã€‹</strong></p><ul><li>ä½¿ç”¨ ECS æ¶æ„åï¼Œèƒ½åœ¨å•å¸§å†…å¤„ç† <strong>æ•°ç™¾ä¸‡æ¬¡</strong> ç¢°æ’æ£€æµ‹</li><li>æ”¯æŒ <strong>12v12</strong> å¤§è§„æ¨¡å›¢æˆ˜ä¸å¡é¡¿</li></ul><hr/><h2>å››ã€ECS æ¶æ„è¯¦è§£</h2><h3>4.1 Entity ç”Ÿå‘½å‘¨æœŸç®¡ç†</h3><h4>åˆ›å»ºå®ä½“ï¼ˆSpawnï¼‰</h4><pre><code class="rust">// æ–¹å¼1ï¼šä½¿ç”¨ Commandsï¼ˆæ¨èï¼Œå»¶è¿Ÿæ‰§è¡Œï¼‰
fn spawn_player(mut commands: Commands) {
    let player_entity = commands.spawn((
        Position { x: 0.0, y: 0.0 },
        Velocity { dx: 0.0, dy: 0.0 },
        Health { current: 100, max: 100 },
        Player,
    )).id();  // è¿”å› Entity ID

    println!("Created player: {:?}", player_entity);
}

// æ–¹å¼2ï¼šä½¿ç”¨ Worldï¼ˆç«‹å³æ‰§è¡Œï¼Œéœ€è¦ç‹¬å è®¿é—®ï¼‰
fn spawn_enemy_immediate(world: &amp;mut World) {
    let enemy = world.spawn((
        Position { x: 100.0, y: 100.0 },
        Enemy,
    )).id();
}</code></pre><h4>åˆ é™¤å®ä½“ï¼ˆDespawnï¼‰</h4><pre><code class="rust">// åˆ é™¤å•ä¸ªå®ä½“
fn remove_dead_entities(
    mut commands: Commands,
    query: Query&lt;(Entity, &amp;Health)&gt;,
) {
    for (entity, health) in query.iter() {
        if health.current &lt;= 0 {
            commands.entity(entity).despawn();
        }
    }
}

// é€’å½’åˆ é™¤å®ä½“åŠå…¶å­å®ä½“
fn despawn_with_children(
    mut commands: Commands,
    entity: Entity,
) {
    commands.entity(entity).despawn_recursive();
}</code></pre><h4>æ·»åŠ /ç§»é™¤ç»„ä»¶</h4><pre><code class="rust">// æ·»åŠ ç»„ä»¶
fn add_shield(
    mut commands: Commands,
    query: Query&lt;Entity, With&lt;Player&gt;&gt;,
) {
    for entity in query.iter() {
        commands.entity(entity).insert(Shield { strength: 50 });
    }
}

// ç§»é™¤ç»„ä»¶
fn remove_shield(
    mut commands: Commands,
    query: Query&lt;Entity, With&lt;Shield&gt;&gt;,
) {
    for entity in query.iter() {
        commands.entity(entity).remove::&lt;Shield&gt;();
    }
}</code></pre><hr/><h3>4.2 Archetypeï¼ˆåŸå‹ï¼‰ç³»ç»Ÿ</h3><p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šæŒ‰ç»„ä»¶ç»„åˆå¯¹å®ä½“åˆ†ç»„</p><pre><code class="rust">// å®ä½“çš„ç»„ä»¶ç»„åˆå†³å®šå®ƒå±äºå“ªä¸ª Archetype
// Archetype_A: (Position, Velocity)
struct ArchetypeA {
    entities: Vec&lt;Entity&gt;,          // [1, 5, 9]
    positions: Vec&lt;Position&gt;,       // è¿ç»­å­˜å‚¨
    velocities: Vec&lt;Velocity&gt;,      // è¿ç»­å­˜å‚¨
}

// Archetype_B: (Position, Velocity, Health)
struct ArchetypeB {
    entities: Vec&lt;Entity&gt;,          // [2, 3, 10]
    positions: Vec&lt;Position&gt;,
    velocities: Vec&lt;Velocity&gt;,
    healths: Vec&lt;Health&gt;,
}

// Archetype_C: (Position, Mesh, Material)
struct ArchetypeC {
    entities: Vec&lt;Entity&gt;,          // [4, 7]
    positions: Vec&lt;Position&gt;,
    meshes: Vec&lt;Mesh&gt;,
    materials: Vec&lt;Material&gt;,
}</code></pre><p><strong>åŠ¨æ€è°ƒæ•´</strong>ï¼š</p><ul><li>æ·»åŠ ç»„ä»¶æ—¶ï¼Œå®ä½“ä¼š<strong>è¿ç§»</strong>åˆ°æ–°çš„ Archetype</li><li>ä¾‹å¦‚ï¼šç»™ Entity 1 æ·»åŠ  Health â†’ ä» Archetype_A ç§»åŠ¨åˆ° Archetype_B</li></ul><p><strong>å†…å­˜åˆ†å—ï¼ˆChunkï¼‰</strong>ï¼š</p><pre><code>ä¸€ä¸ª Chunk = 16KB å›ºå®šå†…å­˜å—
Archetype_B çš„ Chunk 0:
  [PositionÃ—100] [VelocityÃ—100] [HealthÃ—100]</code></pre><hr/><h3>4.2 Queryï¼ˆæŸ¥è¯¢ï¼‰æœºåˆ¶</h3><p>System é€šè¿‡ Query å£°æ˜éœ€è¦å“ªäº›ç»„ä»¶ï¼š</p><pre><code class="rust">// ç§»åŠ¨ç³»ç»Ÿï¼šæŸ¥è¯¢æ‰€æœ‰æ‹¥æœ‰ Position å’Œ Velocity çš„å®ä½“
// Query&lt;(&amp;mut Position, &amp;Velocity)&gt; è¡¨ç¤ºï¼š
//   - &amp;mut Position: å¯å˜å€Ÿç”¨ï¼ˆéœ€è¦ä¿®æ”¹ï¼‰
//   - &amp;Velocity: ä¸å¯å˜å€Ÿç”¨ï¼ˆåªè¯»ï¼‰
fn movement_system(
    mut query: Query&lt;(&amp;mut Position, &amp;Velocity)&gt;,
    time: Res&lt;Time&gt;,  // Res&lt;Time&gt; æ˜¯å…¨å±€èµ„æºï¼Œç”¨äºè·å–æ—¶é—´
) {
    let dt = time.delta_seconds();  // è·å–å¸§é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰

    for (mut pos, vel) in query.iter_mut() {
        pos.x += vel.dx * dt;  // æ›´æ–° x åæ ‡
        pos.y += vel.dy * dt;  // æ›´æ–° y åæ ‡
    }
}

// ä¼¤å®³ç³»ç»Ÿï¼šæŸ¥è¯¢æ‹¥æœ‰ Health ä½†æ²¡æœ‰ Invincible çš„å®ä½“
// Without&lt;Invincible&gt; æ˜¯è¿‡æ»¤å™¨ï¼Œæ’é™¤æ— æ•ŒçŠ¶æ€çš„å®ä½“
fn damage_system(
    mut query: Query&lt;&amp;mut Health, Without&lt;Invincible&gt;&gt;,
) {
    for mut health in query.iter_mut() {
        // åœ¨å®é™…æ¸¸æˆä¸­ï¼Œdamage åº”è¯¥ä»äº‹ä»¶æˆ–å…¶ä»–æ¥æºè·å–
        let damage = 10;
        health.current = (health.current - damage).max(0);
    }
}

// Invincible æ ‡è®°ç»„ä»¶ï¼ˆå‡è®¾å®šä¹‰ï¼‰
#[derive(Component)]
struct Invincible;</code></pre><p><strong>ä¼˜åŒ–</strong>ï¼šQuery ç»“æœä¼šè¢«ç¼“å­˜ï¼Œé¿å…é‡å¤éå†</p><hr/><h3>4.3 System æ‰§è¡Œé¡ºåºä¸å¹¶è¡ŒåŒ–</h3><h4>ä¾èµ–æ£€æµ‹</h4><pre><code class="rust">// System A å’Œ B å¯ä»¥å¹¶è¡Œï¼ˆæ“ä½œä¸åŒç»„ä»¶ï¼‰
fn system_a(query: Query&lt;(&amp;Position, &amp;Velocity)&gt;) {
    // è¯» Positionï¼Œè¯» Velocity
}

fn system_b(query: Query&lt;(&amp;Health, &amp;mut Damage)&gt;) {
    // è¯» Healthï¼Œå†™ Damage
}

// System C å’Œ A ä¸èƒ½å¹¶è¡Œï¼ˆéƒ½è¦å†™ Positionï¼‰
fn system_c(query: Query&lt;(&amp;mut Position, &amp;Target)&gt;) {
    // å†™ Position - ä¸ system_a å†²çª
}</code></pre><h4>è°ƒåº¦å™¨è‡ªåŠ¨å¹¶è¡ŒåŒ–</h4><pre><code>å¸§å¾ªç¯ï¼š
  é˜¶æ®µ1ï¼ˆå¹¶è¡Œï¼‰ï¼š
    - MovementSystem  (writes Position)
    - AISystem        (reads Position, writes AI)

  é˜¶æ®µ2ï¼ˆå¹¶è¡Œï¼‰ï¼š
    - RenderSystem    (reads Position, Mesh)
    - AudioSystem     (reads Position, AudioSource)</code></pre><p><strong>å®æµ‹</strong>ï¼š8 æ ¸ CPU å¯è·å¾— <strong>5-6x</strong> åŠ é€Ÿï¼ˆç†æƒ³æƒ…å†µï¼‰</p><hr/><h2>äº”ã€ä¸»æµæ¸¸æˆå¼•æ“ä¸­çš„ ECS å®ç°</h2><h3>5.1 Unity DOTS (Data-Oriented Technology Stack)</h3><p><strong>æ¶æ„</strong>ï¼šArchetype-based ECS</p><p><strong>æ ¸å¿ƒæŠ€æœ¯</strong>ï¼š</p><ul><li><strong>Entities åŒ…</strong>ï¼šECS æ ¸å¿ƒ</li><li><strong>Burst Compiler</strong>ï¼šå°† C# ç¼–è¯‘ä¸ºä¼˜åŒ–çš„åŸç”Ÿä»£ç </li><li><strong>Job System</strong>ï¼šå¤šçº¿ç¨‹ä»»åŠ¡è°ƒåº¦</li></ul><p><strong>ç¤ºä¾‹ä»£ç </strong>ï¼ˆC# - Unity ä¸“ç”¨ï¼‰ï¼š</p><pre><code class="csharp">using Unity.Entities;
using Unity.Transforms;

// ç»„ä»¶
public struct Speed : IComponentData {
    public float Value;
}

// System
public partial class MovementSystem : SystemBase {
    protected override void OnUpdate() {
        float dt = Time.DeltaTime;

        // ä½¿ç”¨ Entities.ForEach éå†
        Entities.ForEach((ref Translation pos, in Speed speed) =&gt; {
            pos.Value.x += speed.Value * dt;
        }).ScheduleParallel();  // è‡ªåŠ¨å¹¶è¡ŒåŒ–
    }
}</code></pre><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>Burst ç¼–è¯‘å™¨æ€§èƒ½æè‡´</li><li>ä¸ Unity ç”Ÿæ€æ·±åº¦é›†æˆ</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>API é¢‘ç¹å˜æ›´ï¼ˆç›®å‰ä»åœ¨å¼€å‘ä¸­ï¼‰</li><li>å­¦ä¹ æ›²çº¿é™¡å³­</li><li>è°ƒè¯•å›°éš¾</li></ul><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šè¶…å¤§è§„æ¨¡å®ä½“ï¼ˆå¦‚ RTSã€æ¨¡æ‹Ÿæ¸¸æˆï¼‰</p><hr/><h3>5.2 Unreal Engine - Mass Framework</h3><p><strong>æ¶æ„</strong>ï¼šArchetype-based ECSï¼ˆç±»ä¼¼ Unity DOTSï¼‰</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>Epic Games AI å›¢é˜Ÿå¼€å‘ï¼ˆç”¨äºã€Šé»‘å®¢å¸å›½ã€‹æŠ€æœ¯æ¼”ç¤ºï¼‰</li><li>ä¸“æ³¨äº<strong>å¤§è§„æ¨¡ç¾¤ä½“æ¨¡æ‹Ÿ</strong>ï¼ˆæ•°ä¸‡ NPCï¼‰</li><li>ä¸ Unreal çš„è“å›¾ç³»ç»Ÿé›†æˆ</li></ul><p><strong>æœ¯è¯­å·®å¼‚</strong>ï¼ˆé¿å…ä¸“åˆ©é—®é¢˜ï¼‰ï¼š</p><ul><li>Component â†’ <strong>Fragment</strong></li><li>System â†’ <strong>Processor</strong></li></ul><p><strong>ç¤ºä¾‹ä»£ç </strong>ï¼ˆC++ - Unreal ä¸“ç”¨ï¼‰ï¼š</p><pre><code class="cpp">// Fragmentï¼ˆç»„ä»¶ï¼‰
USTRUCT()
struct FMassVelocityFragment : public FMassFragment {
    GENERATED_BODY()
    FVector Value;
};

// Processorï¼ˆç³»ç»Ÿï¼‰
UMassMovementProcessor : public UMassProcessor {
    virtual void Execute(FMassEntityManager&amp; EntityManager,
                        FMassExecutionContext&amp; Context) {
        // æ‰¹é‡å¤„ç†å®ä½“
        Query.ForEachEntityChunk(EntityManager, Context,
            [](FMassExecutionContext&amp; Context) {
                // å¤„ç†é€»è¾‘
            });
    }
};</code></pre><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>é€‚åˆ AAA çº§å¤§åœºæ™¯</li><li>å†…ç½® LOD ç³»ç»Ÿï¼ˆè¿œå¤„å®ä½“ç®€åŒ–å¤„ç†ï¼‰</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>ä»åœ¨å®éªŒé˜¶æ®µï¼ˆWIPï¼‰</li><li>æ–‡æ¡£å’Œæ•™ç¨‹è¾ƒå°‘</li></ul><hr/><h3>5.3 Bevyï¼ˆRust æ¸¸æˆå¼•æ“ï¼‰</h3><p><strong>æ¶æ„</strong>ï¼šçº¯ ECS è®¾è®¡ï¼ˆå¼•æ“ä»é›¶å¼€å§‹ä¸º ECS æ„å»ºï¼‰</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>æ— å†å²åŒ…è¢±ï¼Œæœ€çº¯ç²¹çš„ ECS å®ç°</li><li>Rust è¯­è¨€çš„ç±»å‹å®‰å…¨ + é›¶æˆæœ¬æŠ½è±¡</li></ul><p><strong>ç¤ºä¾‹ä»£ç </strong>ï¼š</p><pre><code class="rust">use bevy::prelude::*;

// ç»„ä»¶
#[derive(Component)]
struct Velocity(Vec2);

// ç³»ç»Ÿ
fn movement_system(
    mut query: Query&lt;(&amp;mut Transform, &amp;Velocity)&gt;,
    time: Res&lt;Time&gt;,
) {
    for (mut transform, velocity) in query.iter_mut() {
        transform.translation.x += velocity.0.x * time.delta_seconds();
        transform.translation.y += velocity.0.y * time.delta_seconds();
    }
}

// App æ³¨å†Œ
fn main() {
    App::new()
        .add_systems(Update, movement_system)
        .run();
}</code></pre><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>API ç®€æ´ä¼˜é›…</li><li>ç¼–è¯‘æ—¶æ£€æŸ¥ï¼ˆRust æ‰€æœ‰æƒç³»ç»Ÿé˜²æ­¢æ•°æ®ç«äº‰ï¼‰</li><li>å®Œå…¨å…è´¹å¼€æº</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>ç”Ÿæ€å¹´è½»ï¼ŒåŠŸèƒ½ä¸å¦‚æˆç†Ÿå¼•æ“</li><li>éœ€è¦å­¦ä¹  Rust è¯­è¨€</li></ul><hr/><h3>5.4 ä¸ºä»€ä¹ˆ Rust é€‚åˆ ECSï¼Ÿ</h3><p>Rust è¯­è¨€çš„ç‰¹æ€§ä¸ ECS æ¶æ„å¤©ç„¶å¥‘åˆï¼Œä½¿å…¶æˆä¸ºæ„å»ºé«˜æ€§èƒ½ ECS çš„ç†æƒ³é€‰æ‹©ï¼š</p><h4>1. <strong>æ‰€æœ‰æƒç³»ç»Ÿï¼šç¼–è¯‘æ—¶å¹¶è¡Œå®‰å…¨ä¿è¯</strong></h4><p>Rust çš„å€Ÿç”¨æ£€æŸ¥å™¨åœ¨<strong>ç¼–è¯‘æ—¶</strong>ä¿è¯æ•°æ®å®‰å…¨ï¼Œæ— éœ€è¿è¡Œæ—¶å¼€é”€ï¼š</p><pre><code class="rust">// Rust çš„å€Ÿç”¨è§„åˆ™ï¼š
// 1. ä»»æ„å¤šä¸ªä¸å¯å˜å€Ÿç”¨ (&amp;T)
// 2. æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå¯å˜å€Ÿç”¨ (&amp;mut T)
// 3. ä¸å¯å˜å’Œå¯å˜å€Ÿç”¨ä¸èƒ½åŒæ—¶å­˜åœ¨

// âœ… æ­£ç¡®ï¼šä¸¤ä¸ªç³»ç»Ÿè¯»å–ä¸åŒç»„ä»¶
fn system_a(query: Query&lt;&amp;Position&gt;) {}
fn system_b(query: Query&lt;&amp;Velocity&gt;) {}
// ç¼–è¯‘å™¨åˆ†æï¼šPosition å’Œ Velocity æ— å†²çª â†’ å¯ä»¥å¹¶è¡Œ

// âœ… æ­£ç¡®ï¼šå¤šä¸ªç³»ç»Ÿåªè¯»åŒä¸€ç»„ä»¶
fn read_system_1(query: Query&lt;&amp;Position&gt;) {}
fn read_system_2(query: Query&lt;&amp;Position&gt;) {}
// ç¼–è¯‘å™¨åˆ†æï¼šéƒ½æ˜¯ä¸å¯å˜å€Ÿç”¨ â†’ å¯ä»¥å¹¶è¡Œ

// âŒ é”™è¯¯ï¼šä¸¤ä¸ªç³»ç»ŸåŒæ—¶å†™åŒä¸€ç»„ä»¶
fn write_system_1(query: Query&lt;&amp;mut Position&gt;) {}
fn write_system_2(query: Query&lt;&amp;mut Position&gt;) {}
// ç¼–è¯‘å™¨æŠ¥é”™ï¼šPosition è¢«ä¸¤æ¬¡å¯å˜å€Ÿç”¨ â†’ ä¸èƒ½å¹¶è¡Œ

// âœ… æ­£ç¡®ï¼šä¸€ä¸ªè¯»ä¸€ä¸ªå†™ï¼Œä½†æ˜¯ä¸åŒç»„ä»¶
fn read_pos(query: Query&lt;&amp;Position&gt;) {}
fn write_vel(query: Query&lt;&amp;mut Velocity&gt;) {}
// ç¼–è¯‘å™¨åˆ†æï¼šPosition è¯»å–ï¼ŒVelocity å†™å…¥ â†’ å¯ä»¥å¹¶è¡Œ</code></pre><p><strong>å…³é”®ä¼˜åŠ¿</strong>ï¼š</p><ul><li>ğŸš€ <strong>é›¶è¿è¡Œæ—¶å¼€é”€</strong>ï¼šå†²çªæ£€æµ‹åœ¨ç¼–è¯‘æ—¶å®Œæˆ</li><li>ğŸ”’ <strong>ç»å¯¹å®‰å…¨</strong>ï¼šRust ç¼–è¯‘å™¨ä¿è¯æ— æ•°æ®ç«äº‰</li><li>âš¡ <strong>è‡ªåŠ¨å¹¶è¡ŒåŒ–</strong>ï¼šè°ƒåº¦å™¨æ ¹æ®å€Ÿç”¨ä¿¡æ¯è‡ªåŠ¨å¹¶è¡Œ</li></ul><hr/><h4>2. <strong>é›¶æˆæœ¬æŠ½è±¡ï¼šé«˜çº§è¯­æ³•ï¼Œæœºå™¨ç çº§æ€§èƒ½</strong></h4><pre><code class="rust">// é«˜çº§ä»£ç ï¼šä¼˜é›…çš„è¿­ä»£å™¨è¯­æ³•
fn movement_system(
    mut query: Query&lt;(&amp;mut Transform, &amp;Velocity)&gt;,
    time: Res&lt;Time&gt;,
) {
    let dt = time.delta_seconds();

    for (mut transform, velocity) in query.iter_mut() {
        transform.translation.x += velocity.0.x * dt;
        transform.translation.y += velocity.0.y * dt;
    }
}

// ç¼–è¯‘åçš„æ±‡ç¼–ä»£ç ï¼ˆç®€åŒ–ï¼‰ï¼š
// ç­‰åŒäºç›´æ¥æ•°ç»„è®¿é—®ï¼Œæ²¡æœ‰é¢å¤–å¼€é”€
/*
loop:
    movss xmm0, [positions + rax]      ; åŠ è½½ position.x
    movss xmm1, [velocities + rax]     ; åŠ è½½ velocity.x
    mulss xmm1, xmm2                   ; velocity.x * dt
    addss xmm0, xmm1                   ; position.x += result
    movss [positions + rax], xmm0      ; å­˜å‚¨å›å»
    add rax, 12                        ; ä¸‹ä¸€ä¸ª Vec3
    cmp rax, rbx
    jl loop
*/</code></pre><p><strong>å…³é”®ç‚¹</strong>ï¼š</p><ul><li>Query è¿­ä»£å™¨ç¼–è¯‘å = ç›´æ¥å†…å­˜è®¿é—®</li><li>æ— è™šå‡½æ•°è°ƒç”¨ã€æ— åŠ¨æ€åˆ†å‘</li><li>ç¼–è¯‘å™¨å†…è”ä¼˜åŒ–ï¼Œç”Ÿæˆæœ€ä¼˜æœºå™¨ç </li></ul><hr/><h4>3. <strong>ç±»å‹å®‰å…¨çš„ç»„ä»¶æŸ¥è¯¢ï¼šç¼–è¯‘æ—¶éªŒè¯</strong></h4><pre><code class="rust">// ç¼–è¯‘æ—¶æ£€æŸ¥ç»„ä»¶ç±»å‹ï¼Œè¿è¡Œæ—¶é›¶å¼€é”€
fn complex_query_system(
    // è¿™ä¸ªç±»å‹ç­¾ååœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šäº†
    query: Query&lt;
        (
            &amp;Transform,           // åªè¯»
            &amp;mut Velocity,        // å¯å†™
            Option&lt;&amp;Health&gt;,      // å¯é€‰ï¼ˆå®ä½“å¯èƒ½æ²¡æœ‰ï¼‰
        ),
        (
            With&lt;Player&gt;,         // è¿‡æ»¤å™¨ï¼šå¿…é¡»æœ‰ Player æ ‡è®°
            Without&lt;Frozen&gt;,      // è¿‡æ»¤å™¨ï¼šä¸èƒ½æœ‰ Frozen æ ‡è®°
        )
    &gt;,
) {
    for (transform, mut velocity, health) in query.iter_mut() {
        // transform: &amp;Transform     - ç¼–è¯‘å™¨ä¿è¯åªè¯»
        // velocity: &amp;mut Velocity   - ç¼–è¯‘å™¨ä¿è¯å¯å†™
        // health: Option&lt;&amp;Health&gt;   - ç¼–è¯‘å™¨ä¿è¯æ­£ç¡®å¤„ç† None

        if let Some(hp) = health {
            if hp.current &gt; 0 {
                velocity.0 *= 0.9;  // å‡é€Ÿ
            }
        }
    }
}

// å¦‚æœä½ å†™é”™äº†ç±»å‹ï¼š
fn buggy_system(query: Query&lt;&amp;Health&gt;) {  // å£°æ˜æ˜¯åªè¯»
    for mut health in query.iter() {       // âŒ è¯•å›¾å¯å˜è¿­ä»£
        health.current -= 10;              // âŒ ç¼–è¯‘å¤±è´¥ï¼
    }
}
// ç¼–è¯‘å™¨é”™è¯¯ï¼šcannot borrow immutable local variable `health` as mutable</code></pre><hr/><h4>4. <strong>å†…å­˜å¸ƒå±€ç²¾ç¡®æ§åˆ¶ï¼šç¼“å­˜ä¼˜åŒ–</strong></h4><pre><code class="rust">// Rust å…è®¸ç²¾ç¡®æ§åˆ¶å†…å­˜å¸ƒå±€

// 1. é»˜è®¤å¸ƒå±€ï¼ˆRust ç¼–è¯‘å™¨ä¼˜åŒ–ï¼‰
#[derive(Component)]
struct Position {
    x: f32,  // å¯èƒ½è¢«é‡æ’ä»¥ä¼˜åŒ–å¯¹é½
    y: f32,
    z: f32,
}

// 2. C å…¼å®¹å¸ƒå±€ï¼ˆä¿è¯å­—æ®µé¡ºåºï¼‰
#[repr(C)]
struct CPosition {
    x: f32,  // ä¿è¯é¡ºåº
    y: f32,
    z: f32,
}

// 3. SIMD ä¼˜åŒ–å¸ƒå±€ï¼ˆ16 å­—èŠ‚å¯¹é½ï¼‰
#[repr(align(16))]
#[derive(Component, Clone, Copy)]
struct SimdVec4 {
    data: [f32; 4],  // å¯¹é½åˆ° 128 ä½ï¼Œå¯ç”¨ SSE/AVX æŒ‡ä»¤
}

// 4. ç´§å‡‘å¸ƒå±€ï¼ˆå»é™¤å¡«å……ï¼‰
#[repr(packed)]
struct CompactData {
    flag: u8,   // 1 å­—èŠ‚
    value: u32, // 4 å­—èŠ‚ï¼Œç´§å¯†æ’åˆ—ï¼ˆæ— å¡«å……ï¼‰
}

// 5. é€æ˜åŒ…è£…ï¼ˆzero-cost wrapperï¼‰
#[repr(transparent)]
struct EntityId(u64);  // è¿è¡Œæ—¶ä¸ u64 å®Œå…¨ç›¸åŒ</code></pre><p><strong>å®é™…åº”ç”¨</strong>ï¼š</p><pre><code class="rust">// SIMD åŠ é€Ÿçš„ä½ç½®æ›´æ–°
use std::arch::x86_64::*;

fn simd_movement_system(
    positions: &amp;mut [SimdVec4],
    velocities: &amp;[SimdVec4],
    dt: f32,
) {
    unsafe {
        let dt_vec = _mm_set1_ps(dt);  // å¹¿æ’­ dt åˆ° 4 ä¸ªæµ®ç‚¹æ•°

        for i in 0..positions.len() {
            // ä¸€æ¬¡åŠ è½½ 4 ä¸ªæµ®ç‚¹æ•°
            let pos = _mm_load_ps(positions[i].data.as_ptr());
            let vel = _mm_load_ps(velocities[i].data.as_ptr());

            // SIMD è®¡ç®—ï¼špos += vel * dt (ä¸€æ¬¡å¤„ç† 4 ä¸ª)
            let scaled_vel = _mm_mul_ps(vel, dt_vec);
            let new_pos = _mm_add_ps(pos, scaled_vel);

            // å­˜å‚¨å›å»
            _mm_store_ps(positions[i].data.as_mut_ptr(), new_pos);
        }
    }
}

// æ€§èƒ½æå‡ï¼š4 å€åŠ é€Ÿï¼ˆç†è®ºä¸Šï¼‰</code></pre><hr/><h4>5. <strong>ç¼–è¯‘æ—¶ç³»ç»Ÿå†²çªæ£€æµ‹</strong></h4><pre><code class="rust">// Bevy çš„è°ƒåº¦å™¨åœ¨ç¼–è¯‘æ—¶åˆ†æç³»ç»Ÿä¾èµ–

App::new()
    .add_systems(Update, (
        system_a,  // Query&lt;&amp;mut Position&gt;
        system_b,  // Query&lt;&amp;Velocity&gt;
        system_c,  // Query&lt;&amp;mut Position&gt;
    ))
    .run();

// Bevy è°ƒåº¦å™¨çš„åˆ†æï¼ˆç¼–è¯‘æ—¶ï¼‰ï¼š
// - system_a å’Œ system_c éƒ½å†™ Position â†’ ä¸èƒ½å¹¶è¡Œï¼Œé¡ºåºæ‰§è¡Œ
// - system_b è¯» Velocity â†’ å¯ä»¥ä¸ a å’Œ c å¹¶è¡Œ

// æ‰§è¡Œè®¡åˆ’ï¼š
// å¹¶è¡Œé˜¶æ®µ1: system_a, system_b (åŒæ—¶æ‰§è¡Œ)
// å¹¶è¡Œé˜¶æ®µ2: system_c, system_b (åŒæ—¶æ‰§è¡Œï¼Œå¦‚æœ b è¿˜æ²¡ç»“æŸ)

// å¦‚æœä½ æ‰‹åŠ¨æŒ‡å®šé¡ºåºï¼š
App::new()
    .add_systems(Update, (
        system_a.before(system_c),  // å¼ºåˆ¶ a åœ¨ c ä¹‹å‰
        system_b,
    ))
    .run();</code></pre><hr/><h4>6. <strong>Trait ç³»ç»Ÿï¼šæŠ½è±¡æ— å¼€é”€</strong></h4><pre><code class="rust">// Rust çš„ trait åœ¨ç¼–è¯‘æ—¶å•æ€åŒ–ï¼ˆmonomorphizationï¼‰

trait Damageable {
    fn take_damage(&amp;mut self, amount: i32);
}

impl Damageable for Health {
    fn take_damage(&amp;mut self, amount: i32) {
        self.current -= amount;
    }
}

// æ³›å‹å‡½æ•°
fn apply_damage&lt;T: Damageable&gt;(target: &amp;mut T, amount: i32) {
    target.take_damage(amount);
}

// è°ƒç”¨æ—¶ï¼Œç¼–è¯‘å™¨ç”Ÿæˆç‰¹åŒ–ç‰ˆæœ¬ï¼š
apply_damage(&amp;mut health, 10);
// ç¼–è¯‘ä¸ºï¼šhealth.current -= 10; (ç›´æ¥å†…è”ï¼Œæ— è™šå‡½æ•°è°ƒç”¨)

// å¯¹æ¯” C++ è™šå‡½æ•°ï¼ˆè¿è¡Œæ—¶å¤šæ€ï¼‰ï¼š
// health-&gt;take_damage(10);  // è™šå‡½æ•°è¡¨æŸ¥æ‰¾ï¼Œæœ‰å¼€é”€</code></pre><hr/><h3>5.5 å…¶ä»–å®ç°</h3><hr/><h3>5.5 å…¶ä»–å®ç°</h3><table><thead><tr><th>å¼•æ“/æ¡†æ¶</th><th>è¯­è¨€</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><strong>EnTT</strong></td><td>C++</td><td>è½»é‡çº§ ECS åº“ï¼Œå¹¿æ³›ç”¨äº C++ é¡¹ç›®</td></tr><tr><td><strong>Flecs</strong></td><td>C/C++</td><td>é«˜æ€§èƒ½ï¼Œæ”¯æŒå…³ç³»å›¾æŸ¥è¯¢</td></tr><tr><td><strong>specs</strong></td><td>Rust</td><td>Bevy ä¹‹å‰çš„æµè¡Œ Rust ECS åº“</td></tr><tr><td><strong>Amethyst</strong></td><td>Rust</td><td>åœæ­¢ç»´æŠ¤ï¼ˆç”¨æˆ·è¿ç§»è‡³ Bevyï¼‰</td></tr></tbody></table><hr/><h2>å…­ã€ECS çš„ä¼˜åŠ¿ä¸åŠ£åŠ¿</h2><h3>âœ… ä¼˜åŠ¿æ€»ç»“</h3><h4>1. <strong>æ€§èƒ½å“è¶Š</strong></h4><ul><li><strong>æ•°æ®å±€éƒ¨æ€§</strong>ï¼šç»„ä»¶è¿ç»­å­˜å‚¨ï¼Œç¼“å­˜å‘½ä¸­ç‡é«˜</li><li><strong>æ‰¹é‡å¤„ç†</strong>ï¼šä¸€æ¬¡å¤„ç†æ•°åƒä¸ªå®ä½“</li><li><strong>SIMD ä¼˜åŒ–</strong>ï¼šå‘é‡åŒ–æŒ‡ä»¤æé€Ÿ 4-8 å€</li><li><strong>å®æµ‹</strong>ï¼šUnity DOTS æ¯”ä¼ ç»Ÿ MonoBehaviour å¿« <strong>20-200 å€</strong>ï¼ˆå–å†³äºåœºæ™¯ï¼‰</li></ul><h4>2. <strong>å¹¶è¡ŒåŒ–å‹å¥½</strong></h4><ul><li><strong>System é—´æ— å…±äº«çŠ¶æ€</strong>ï¼šå¤©ç„¶æ”¯æŒå¤šçº¿ç¨‹</li><li><strong>è‡ªåŠ¨è°ƒåº¦</strong>ï¼šå¼•æ“åˆ†æä¾èµ–ï¼Œè‡ªåŠ¨å¹¶è¡Œæ‰§è¡Œ</li><li><strong>å¤šæ ¸åˆ©ç”¨ç‡é«˜</strong>ï¼šå®æµ‹å¯è¾¾ <strong>80-90%</strong>ï¼ˆOOP é€šå¸¸ &lt;30%ï¼‰</li></ul><h4>3. <strong>é«˜åº¦å¯æ‰©å±•</strong></h4><ul><li><strong>æ·»åŠ åŠŸèƒ½æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç </strong>ï¼šæ–°å¢ç»„ä»¶/ç³»ç»Ÿå³å¯</li><li><strong>çƒ­æ’æ‹”</strong>ï¼šè¿è¡Œæ—¶åŠ¨æ€æ·»åŠ /ç§»é™¤ç»„ä»¶</li><li><strong>æ¨¡ç»„å‹å¥½</strong>ï¼šæ¨¡ç»„å¯ä»¥ç‹¬ç«‹æ·»åŠ ç»„ä»¶/ç³»ç»Ÿ</li></ul><h4>4. <strong>ä»£ç å¤ç”¨æ€§å¼º</strong></h4><ul><li><strong>ç»„ä»¶å³åè®®</strong>ï¼šä»»ä½•å®ä½“å¯å¤ç”¨åŒä¸€ç»„ä»¶</li><li><strong>System è§£è€¦</strong>ï¼šç§»åŠ¨ç³»ç»Ÿå¯ç”¨äºç©å®¶ã€æ€ªç‰©ã€ç®±å­...</li><li><strong>é¿å…ä»£ç é‡å¤</strong>ï¼šå‘Šåˆ«å¤åˆ¶ç²˜è´´å¼å¼€å‘</li></ul><h4>5. <strong>æ˜“äºæµ‹è¯•</strong></h4><ul><li><strong>çº¯æ•°æ® + çº¯å‡½æ•°</strong>ï¼šå•å…ƒæµ‹è¯•æç®€</li><li><strong>ç¡®å®šæ€§</strong>ï¼šç»™å®šè¾“å…¥ä¿è¯ç›¸åŒè¾“å‡º</li><li><strong>æ¨¡æ‹Ÿç®€å•</strong>ï¼šåˆ›å»ºæµ‹è¯•æ•°æ®å³å¯</li></ul><hr/><h3>âŒ åŠ£åŠ¿æ€»ç»“</h3><h4>1. <strong>å­¦ä¹ æ›²çº¿é™¡å³­</strong></h4><ul><li><strong>æ€ç»´è½¬å˜</strong>ï¼šä»"å¯¹è±¡æ€ç»´"åˆ°"æ•°æ®æ€ç»´"</li><li><strong>æ¦‚å¿µæŠ½è±¡</strong>ï¼šæ–°æ‰‹éš¾ä»¥ç†è§£ Entity åªæ˜¯ ID</li><li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šæ²¡æœ‰"å¯¹è±¡"å¯æŸ¥çœ‹ï¼Œéœ€è¦æ–°å·¥å…·</li></ul><h4>2. <strong>è¿‡åº¦å·¥ç¨‹é£é™©</strong></h4><ul><li><strong>å°é¡¹ç›®ä¸é€‚åˆ</strong>ï¼š100 ä¸ªå®ä½“ä»¥ä¸‹ç”¨ OOP æ›´ç®€å•</li><li><strong>å¼€å‘æˆæœ¬é«˜</strong>ï¼šæ­å»º ECS æ¡†æ¶éœ€è¦æ—¶é—´</li><li><strong>å›¢é˜ŸåŸ¹è®­</strong>ï¼šæ‰€æœ‰æˆå‘˜éœ€è¦å­¦ä¹ æ–°èŒƒå¼</li></ul><h4>3. <strong>å·¥å…·é“¾æ¬ ç¼º</strong></h4><ul><li><strong>å¯è§†åŒ–ç¼–è¾‘å™¨å°‘</strong>ï¼šå¤§å¤šæ•° ECS å¼•æ“æ— åœºæ™¯ç¼–è¾‘å™¨</li><li><strong>è°ƒè¯•å™¨æ”¯æŒå·®</strong>ï¼šä¼ ç»Ÿè°ƒè¯•å™¨éš¾ä»¥è¿½è¸ªå®ä½“</li><li><strong>ç¾æœ¯/ç­–åˆ’ä¸å‹å¥½</strong>ï¼šçº¯ä»£ç é©±åŠ¨ï¼Œéç¨‹åºå‘˜éš¾å‚ä¸</li></ul><h4>4. <strong>å…³ç³»å¤„ç†å¤æ‚</strong></h4><ul><li><strong>çˆ¶å­å…³ç³»</strong>ï¼šä¼ ç»Ÿæ ‘ç»“æ„åœ¨ ECS ä¸­éœ€è¦ç‰¹æ®Šè®¾è®¡</li><li><strong>å¼•ç”¨å…¶ä»–å®ä½“</strong>ï¼šéœ€è¦å­˜å‚¨ Entity IDï¼Œé—´æ¥è®¿é—®</li><li><strong>äº‹ä»¶ç³»ç»Ÿ</strong>ï¼šè·¨å®ä½“é€šä¿¡éœ€è¦é¢å¤–æœºåˆ¶</li></ul><h4>5. <strong>API ä¸ç¨³å®š</strong></h4><ul><li><strong>Unity DOTS</strong>ï¼šé¢‘ç¹ Breaking Changes</li><li><strong>Bevy</strong>ï¼šçº¦ 3 ä¸ªæœˆä¸€æ¬¡å¤§ç‰ˆæœ¬æ›´æ–°</li><li><strong>è¿ç§»æˆæœ¬é«˜</strong>ï¼šè€é¡¹ç›®å‡çº§å›°éš¾</li></ul><hr/><h2>ä¸ƒã€å¸¸è§é™·é˜±ä¸è°ƒè¯•æŠ€å·§</h2><h3>7.1 ç»„ä»¶è®¾è®¡é™·é˜±</h3><h4>âŒ é™·é˜± 1ï¼šç»„ä»¶åŒ…å«è¿‡å¤šæ•°æ®ï¼ˆä¸Šå¸ç»„ä»¶ï¼‰</h4><pre><code class="rust">// âŒ é”™è¯¯ï¼šä¸€ä¸ªç»„ä»¶åŒ…å«å¤ªå¤šä¸œè¥¿
#[derive(Component)]
struct Character {
    position: Vec3,
    velocity: Vec3,
    health: i32,
    inventory: Vec&lt;Item&gt;,
    stats: Stats,
    animation: AnimationState,
    // ... 20 ä¸ªå­—æ®µ
}

// é—®é¢˜ï¼š
// 1. ç ´åäº† ECS çš„ç¼“å­˜å‹å¥½æ€§
// 2. ç§»åŠ¨ç³»ç»Ÿéœ€è¦åŠ è½½æ•´ä¸ª Characterï¼ˆæµªè´¹ç¼“å­˜ï¼‰
// 3. æ— æ³•çµæ´»ç»„åˆ</code></pre><p><strong>âœ… æ­£ç¡®åšæ³•</strong>ï¼šæ‹†åˆ†ä¸ºå°ç»„ä»¶</p><pre><code class="rust">#[derive(Component)]
struct Transform { position: Vec3, rotation: Quat }

#[derive(Component)]
struct Velocity(Vec3);

#[derive(Component)]
struct Health { current: i32, max: i32 }

#[derive(Component)]
struct Inventory { items: Vec&lt;Item&gt; }

// æ¯ä¸ªç³»ç»ŸåªåŠ è½½éœ€è¦çš„ç»„ä»¶
fn movement_system(query: Query&lt;(&amp;mut Transform, &amp;Velocity)&gt;) {
    // åªåŠ è½½ Transform å’Œ Velocityï¼Œç¼“å­˜é«˜æ•ˆï¼
}</code></pre><hr/><h4>âŒ é™·é˜± 2ï¼šç»„ä»¶ä¸­åŒ…å«é€»è¾‘</h4><pre><code class="rust">// âŒ é”™è¯¯ï¼šç»„ä»¶æœ‰æ–¹æ³•
#[derive(Component)]
struct Player {
    health: i32,
}

impl Player {
    fn take_damage(&amp;mut self, amount: i32) {  // âŒ è¿å ECS åŸåˆ™
        self.health -= amount;
    }
}</code></pre><p><strong>âœ… æ­£ç¡®åšæ³•</strong>ï¼šé€»è¾‘æ”¾åœ¨ System ä¸­</p><pre><code class="rust">#[derive(Component)]
struct Health {
    current: i32,
    max: i32,
}

// é€»è¾‘åœ¨ç³»ç»Ÿä¸­
fn damage_system(
    mut events: EventReader&lt;DamageEvent&gt;,
    mut query: Query&lt;&amp;mut Health&gt;,
) {
    for event in events.read() {
        if let Ok(mut health) = query.get_mut(event.target) {
            health.current -= event.amount;
        }
    }
}</code></pre><hr/><h4>âŒ é™·é˜± 3ï¼šè¿‡åº¦æ‹†åˆ†ç»„ä»¶</h4><pre><code class="rust">// âŒ é”™è¯¯ï¼šæ‹†åˆ†è¿‡ç»†
#[derive(Component)]
struct PositionX(f32);

#[derive(Component)]
struct PositionY(f32);

#[derive(Component)]
struct PositionZ(f32);

// é—®é¢˜ï¼š
// 1. Query å˜å¤æ‚
// 2. ä¸‰æ¬¡å†…å­˜è®¿é—®
// 3. Archetype çˆ†ç‚¸</code></pre><p><strong>âœ… æ­£ç¡®åšæ³•</strong>ï¼šåˆç†ç²’åº¦</p><pre><code class="rust">#[derive(Component)]
struct Position(Vec3);  // ç»å¸¸ä¸€èµ·ä½¿ç”¨çš„æ•°æ®æ”¾ä¸€èµ·</code></pre><hr/><h3>7.2 System è®¾è®¡é™·é˜±</h3><h4>âŒ é™·é˜± 4ï¼šé¢‘ç¹çš„ Archetype è¿ç§»</h4><pre><code class="rust">// âŒ é”™è¯¯ï¼šé¢‘ç¹æ·»åŠ /ç§»é™¤ç»„ä»¶
fn bad_system(
    mut commands: Commands,
    query: Query&lt;Entity, With&lt;Player&gt;&gt;,
) {
    for entity in query.iter() {
        // æ¯å¸§éƒ½æ·»åŠ /ç§»é™¤ - å¯¼è‡´ Archetype è¿ç§»ï¼
        commands.entity(entity).remove::&lt;Frozen&gt;();
        commands.entity(entity).insert(Moving);
    }
}</code></pre><p><strong>âœ… æ­£ç¡®åšæ³•</strong>ï¼šä½¿ç”¨æšä¸¾æˆ–æ ‡å¿—ä½</p><pre><code class="rust">#[derive(Component, Clone, Copy)]
enum MovementState {
    Idle,
    Moving,
    Frozen,
}

fn good_system(mut query: Query&lt;&amp;mut MovementState&gt;) {
    for mut state in query.iter_mut() {
        *state = MovementState::Moving;  // ä¿®æ”¹æ•°æ®ï¼Œä¸æ”¹å˜ Archetype
    }
}</code></pre><hr/><h4>âŒ é™·é˜± 5ï¼šä½¿ç”¨ Commands åç«‹å³æŸ¥è¯¢</h4><pre><code class="rust">// âŒ é”™è¯¯ï¼šCommands æ˜¯å»¶è¿Ÿæ‰§è¡Œçš„
fn buggy_spawn(
    mut commands: Commands,
    query: Query&lt;Entity, With&lt;Player&gt;&gt;,
) {
    commands.spawn((Player, Transform::default()));

    // âŒ æŸ¥è¯¢ä¸åˆ°åˆšåˆ›å»ºçš„å®ä½“ï¼
    println!("Count: {}", query.iter().count());
}</code></pre><p><strong>âœ… æ­£ç¡®åšæ³•</strong>ï¼šåˆ†ä¸¤å¸§æˆ–ä½¿ç”¨ exclusive system</p><pre><code class="rust">fn spawn_system(mut commands: Commands) {
    commands.spawn((Player, Transform::default()));
}

fn count_system(query: Query&lt;Entity, With&lt;Player&gt;&gt;) {
    println!("Count: {}", query.iter().count());  // ä¸‹ä¸€å¸§ç”Ÿæ•ˆ
}</code></pre><hr/><h3>7.3 è°ƒè¯•æŠ€å·§</h3><h4>è°ƒè¯•æŠ€å·§ 1ï¼šå®ä½“æ£€æŸ¥å™¨</h4><pre><code class="rust">// æ‰“å°æ‰€æœ‰å®ä½“åŠå…¶ç»„ä»¶
fn debug_entities(
    query: Query&lt;(Entity, &amp;Transform, Option&lt;&amp;Velocity&gt;)&gt;,
) {
    for (entity, transform, velocity) in query.iter() {
        println!(
            "Entity {:?}: pos={:?}, vel={:?}",
            entity, transform.translation, velocity
        );
    }
}</code></pre><h4>è°ƒè¯•æŠ€å·§ 2ï¼šä½¿ç”¨ bevy-inspector-egui</h4><pre><code class="toml"># Cargo.toml
[dependencies]
bevy = "0.19"
bevy-inspector-egui = "0.29"</code></pre><pre><code class="rust">use bevy_inspector_egui::quick::WorldInspectorPlugin;

fn main() {
    App::new()
        .add_plugins(DefaultPlugins)
        .add_plugins(WorldInspectorPlugin::new())  // å¯è§†åŒ–è°ƒè¯•å™¨
        .run();
}</code></pre><h4>è°ƒè¯•æŠ€å·§ 3ï¼šæ€§èƒ½åˆ†æ</h4><pre><code class="rust">use bevy::diagnostic::{FrameTimeDiagnosticsPlugin, LogDiagnosticsPlugin};

App::new()
    .add_plugins(DefaultPlugins)
    .add_plugins(FrameTimeDiagnosticsPlugin)
    .add_plugins(LogDiagnosticsPlugin::default())
    .run();</code></pre><hr/><h2>å…«ã€ä½•æ—¶ä½¿ç”¨ ECSï¼Ÿ</h2><h3>âœ… é€‚åˆä½¿ç”¨ ECS çš„åœºæ™¯</h3><h4>1. <strong>å¤§è§„æ¨¡å®ä½“å¤„ç†</strong></h4><ul><li><strong>RTS æ¸¸æˆ</strong>ï¼šæˆç™¾ä¸Šåƒçš„å•ä½ï¼ˆå¦‚ã€Šå¸å›½æ—¶ä»£ã€‹ï¼‰</li><li><strong>æ¨¡æ‹Ÿæ¸¸æˆ</strong>ï¼šæ•°ä¸‡ NPCï¼ˆå¦‚ã€ŠåŸå¸‚ï¼šå¤©é™…çº¿ã€‹ï¼‰</li><li><strong>ç²’å­ç³»ç»Ÿ</strong>ï¼šç™¾ä¸‡çº§ç²’å­ï¼ˆå¦‚ã€Šæ— äººæ·±ç©ºã€‹ï¼‰</li></ul><h4>2. <strong>æ€§èƒ½å…³é”®é¡¹ç›®</strong></h4><ul><li><strong>ç§»åŠ¨ç«¯æ¸¸æˆ</strong>ï¼šCPU/å†…å­˜å—é™</li><li><strong>VR æ¸¸æˆ</strong>ï¼šéœ€è¦ç¨³å®š 90+ FPS</li><li><strong>ç‰©ç†å¯†é›†å‹</strong>ï¼šå¤§é‡åˆšä½“ç¢°æ’</li></ul><h4>3. <strong>é«˜åº¦åŠ¨æ€å†…å®¹</strong></h4><ul><li><strong>æ²™ç›’æ¸¸æˆ</strong>ï¼šç©å®¶å¯åˆ›å»ºä»»æ„ç»„åˆçš„å®ä½“</li><li><strong>æ¨¡ç»„ç¤¾åŒº</strong>ï¼šéœ€è¦ç¬¬ä¸‰æ–¹æ‰©å±•åŠŸèƒ½</li><li><strong>ç¨‹åºç”Ÿæˆ</strong>ï¼šè¿è¡Œæ—¶åˆ›å»ºå¤§é‡å˜ä½“</li></ul><h4>4. <strong>å›¢é˜ŸæŠ€æœ¯å®åŠ›å¼º</strong></h4><ul><li>ç¨‹åºå‘˜ç†Ÿæ‚‰æ•°æ®å¯¼å‘è®¾è®¡</li><li>æœ‰æ—¶é—´æŠ•å…¥å­¦ä¹ å’Œæ­å»ºåŸºç¡€è®¾æ–½</li></ul><hr/><h3>âŒ ä¸é€‚åˆä½¿ç”¨ ECS çš„åœºæ™¯</h3><h4>1. <strong>å°å‹é¡¹ç›®</strong></h4><ul><li><strong>åŸå‹å¼€å‘</strong>ï¼šå¿«é€ŸéªŒè¯ç©æ³•ï¼ŒOOP æ›´é«˜æ•ˆ</li><li><strong>Game Jam</strong>ï¼š48 å°æ—¶å¼€å‘ï¼ŒECS å¤ªé‡</li><li><strong>ä¼‘é—²æ¸¸æˆ</strong>ï¼š100 ä¸ªä»¥ä¸‹å®ä½“ï¼Œæ€§èƒ½éç“¶é¢ˆ</li></ul><h4>2. <strong>å›¢é˜Ÿåä½œé¡¹ç›®</strong></h4><ul><li><strong>ç¾æœ¯/ç­–åˆ’ä¸»å¯¼</strong>ï¼šéœ€è¦å¯è§†åŒ–å·¥å…·</li><li><strong>éç¨‹åºå‘˜å‚ä¸</strong>ï¼šOOP æ›´ç›´è§‚</li><li><strong>ç´§æ€¥å•†ä¸šé¡¹ç›®</strong>ï¼šé£é™©é«˜ï¼Œç¨³å®šæ€§ä¼˜å…ˆ</li></ul><h4>3. <strong>å‰§æƒ…é©±åŠ¨æ¸¸æˆ</strong></h4><ul><li><strong>AVG/VN</strong>ï¼šå¯¹è±¡å°‘ï¼Œé‡å‰§æœ¬è€Œéæ€§èƒ½</li><li><strong>è§£è°œæ¸¸æˆ</strong>ï¼šå…³å¡è®¾è®¡ä¼˜å…ˆ</li><li><strong>çº¿æ€§æµç¨‹</strong>ï¼šä¸éœ€è¦å¤§è§„æ¨¡å®ä½“ç®¡ç†</li></ul><h4>4. <strong>é—ç•™é¡¹ç›®è¿ç§»</strong></h4><ul><li><strong>å·²æœ‰å¤§é‡ OOP ä»£ç </strong>ï¼šé‡æ„æˆæœ¬æé«˜</li><li><strong>å¼•æ“é™åˆ¶</strong>ï¼šå¦‚ Godot ç›®å‰æ— åŸç”Ÿ ECS</li></ul><hr/><h2>å…«ã€ECS æœ€ä½³å®è·µ</h2><h3>8.1 ç»„ä»¶è®¾è®¡åŸåˆ™</h3><h4>âœ… DOï¼šç»„ä»¶åº”è¯¥å°è€Œä¸“æ³¨</h4><pre><code class="rust">// å¥½çš„è®¾è®¡ï¼šç»„ä»¶å°è€Œä¸“æ³¨
#[derive(Component, Clone, Copy, Debug)]
struct Position(Vec3);

#[derive(Component, Clone, Copy, Debug)]
struct Velocity(Vec3);

#[derive(Component, Clone, Copy, Debug)]
struct Health {
    current: f32,
    max: f32,
}</code></pre><h4>âŒ DON'Tï¼šç»„ä»¶ä¸åº”è¯¥åŒ…å«é€»è¾‘</h4><pre><code class="rust">// âŒ ç³Ÿç³•çš„è®¾è®¡ï¼šè¿åäº† ECS åŸåˆ™
struct Character {
    position: Vec3,
    velocity: Vec3,
    health: f32,
}

impl Character {
    // âŒ ç»„ä»¶ä¸åº”è¯¥æœ‰æ–¹æ³•ï¼é€»è¾‘åº”è¯¥åœ¨ System ä¸­
    fn update(&amp;mut self) {
        // è¿™ç ´åäº†æ•°æ®ä¸é€»è¾‘åˆ†ç¦»çš„åŸåˆ™
        self.position.x += self.velocity.x;
        self.position.y += self.velocity.y;
        self.position.z += self.velocity.z;
    }
}</code></pre><hr/><h3>8.2 é¿å…è¿‡åº¦æ‹†åˆ†</h3><pre><code class="rust">// âŒ è¿‡åº¦æ‹†åˆ†ï¼šæ¯ä¸ªå­—æ®µéƒ½æ˜¯ç»„ä»¶
struct PositionX(f32);
struct PositionY(f32);
struct PositionZ(f32);

// âœ… åˆç†ç²’åº¦
struct Position {
    x: f32,
    y: f32,
    z: f32,
}</code></pre><p><strong>åŸåˆ™</strong>ï¼šç»å¸¸ä¸€èµ·è®¿é—®çš„æ•°æ®åº”è¯¥æ”¾åœ¨åŒä¸€ä¸ªç»„ä»¶ä¸­</p><hr/><h3>8.3 ä½¿ç”¨æ ‡è®°ç»„ä»¶ï¼ˆTag Componentï¼‰</h3><pre><code class="rust">// æ ‡è®°ç»„ä»¶ï¼šç©ºç»“æ„ä½“ï¼Œä»…ç”¨äºæ ‡è¯†
// æ²¡æœ‰ä»»ä½•å­—æ®µï¼Œåªç”¨äºæ ‡è®°å®ä½“çš„ç±»å‹
#[derive(Component, Clone, Copy, Debug)]
struct Player;

#[derive(Component, Clone, Copy, Debug)]
struct Enemy;

// æŸ¥è¯¢æ‰€æœ‰æ•Œäººçš„ä½ç½®
fn enemy_ai_system(query: Query&lt;&amp;Position, With&lt;Enemy&gt;&gt;) {
    for pos in query.iter() {
        // åªå¤„ç†æ•Œäºº
    }
}</code></pre><hr/><h3>8.4 äº‹ä»¶é€šä¿¡</h3><pre><code class="rust">// ä½¿ç”¨äº‹ä»¶ç³»ç»Ÿè€Œéç›´æ¥ä¿®æ”¹å…¶ä»–å®ä½“
// #[derive(Event)] è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªäº‹ä»¶ç±»å‹
#[derive(Event, Clone, Copy, Debug)]
struct DamageEvent {
    target: Entity,
    amount: f32,
}

fn damage_dealer_system(mut events: EventWriter&lt;DamageEvent&gt;) {
    events.send(DamageEvent {
        target: some_entity,
        amount: 10.0,
    });
}

fn damage_receiver_system(
    mut events: EventReader&lt;DamageEvent&gt;,
    mut query: Query&lt;&amp;mut Health&gt;,
) {
    for event in events.read() {
        if let Ok(mut health) = query.get_mut(event.target) {
            health.current -= event.amount;
        }
    }
}</code></pre><hr/><h3>8.5 ECS è®¾è®¡æ¨¡å¼</h3><h4>æ¨¡å¼ 1ï¼šæ ‡è®°ç»„ä»¶ï¼ˆMarker Componentï¼‰</h4><p>ç”¨ç©ºç»„ä»¶æ ‡è¯†å®ä½“ç±»å‹æˆ–çŠ¶æ€ï¼š</p><pre><code class="rust">// ç±»å‹æ ‡è®°
#[derive(Component)]
struct Player;

#[derive(Component)]
struct Enemy;

#[derive(Component)]
struct NPC;

// çŠ¶æ€æ ‡è®°
#[derive(Component)]
struct Dead;

#[derive(Component)]
struct Frozen;

#[derive(Component)]
struct Invincible;

// ä½¿ç”¨
fn player_input_system(
    query: Query&lt;&amp;mut Velocity, With&lt;Player&gt;&gt;,  // åªæŸ¥è¯¢ç©å®¶
) {
    // ...
}

fn damage_system(
    query: Query&lt;&amp;mut Health, (With&lt;Enemy&gt;, Without&lt;Invincible&gt;)&gt;,
) {
    // åªä¼¤å®³æ•Œäººï¼Œä¸”ä¸èƒ½æ— æ•Œ
}</code></pre><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li>é›¶å†…å­˜å¼€é”€ï¼ˆæ ‡è®°ç»„ä»¶å¤§å°ä¸º 0ï¼‰</li><li>ç±»å‹å®‰å…¨çš„è¿‡æ»¤</li><li>æ¯”å­—ç¬¦ä¸²æˆ–æšä¸¾æ›´é«˜æ•ˆ</li></ul><hr/><h4>æ¨¡å¼ 2ï¼šçŠ¶æ€ç»„ä»¶ï¼ˆState Componentï¼‰</h4><p>ç”¨æšä¸¾è¡¨ç¤ºçŠ¶æ€æœºï¼š</p><pre><code class="rust">#[derive(Component, Clone, Copy, Debug)]
enum AIState {
    Idle,
    Patrol { waypoint_index: usize },
    Chase { target: Entity },
    Attack { target: Entity, cooldown: f32 },
    Flee { from: Entity },
}

#[derive(Component, Clone, Copy, Debug)]
enum CharacterState {
    Grounded,
    Jumping { velocity: f32 },
    Falling { velocity: f32 },
    Dashing { direction: Vec2, duration: f32 },
}

// AI ç³»ç»Ÿæ ¹æ®çŠ¶æ€æ‰§è¡Œä¸åŒé€»è¾‘
fn ai_system(
    mut query: Query&lt;(&amp;mut AIState, &amp;Transform, &amp;mut Velocity)&gt;,
    targets: Query&lt;&amp;Transform, With&lt;Player&gt;&gt;,
) {
    for (mut ai_state, transform, mut velocity) in query.iter_mut() {
        match *ai_state {
            AIState::Idle =&gt; {
                // ç©ºé—²é€»è¾‘
                *ai_state = AIState::Patrol { waypoint_index: 0 };
            }
            AIState::Patrol { waypoint_index } =&gt; {
                // å·¡é€»é€»è¾‘
                if see_player() {
                    *ai_state = AIState::Chase { target: player_entity };
                }
            }
            AIState::Chase { target } =&gt; {
                // è¿½å‡»é€»è¾‘
                if in_attack_range() {
                    *ai_state = AIState::Attack {
                        target,
                        cooldown: 1.0,
                    };
                }
            }
            AIState::Attack { target, mut cooldown } =&gt; {
                cooldown -= time.delta_seconds();
                if cooldown &lt;= 0.0 {
                    // æ‰§è¡Œæ”»å‡»
                    *ai_state = AIState::Chase { target };
                }
            }
            AIState::Flee { from } =&gt; {
                // é€ƒè·‘é€»è¾‘
            }
        }
    }
}</code></pre><p><strong>ä¼˜åŠ¿</strong>ï¼š</p><ul><li>çŠ¶æ€è½¬æ¢æ¸…æ™°</li><li>ç¼–è¯‘æ—¶æ£€æŸ¥çŠ¶æ€æœ‰æ•ˆæ€§</li><li>é¿å…å¸ƒå°”æ ‡å¿—çš„ç»„åˆçˆ†ç‚¸</li></ul><hr/><h4>æ¨¡å¼ 3ï¼šå•ä¾‹ç»„ä»¶ï¼ˆSingleton Componentï¼‰</h4><p>å…¨å±€å”¯ä¸€çš„ç»„ä»¶ï¼ˆé€šå¸¸ç”¨ Resourceï¼‰ï¼š</p><pre><code class="rust">// æ–¹æ¡ˆ1ï¼šä½¿ç”¨ Resourceï¼ˆæ¨èï¼‰
#[derive(Resource)]
struct GameState {
    score: u32,
    level: u32,
    paused: bool,
}

fn update_score(mut game_state: ResMut&lt;GameState&gt;) {
    game_state.score += 10;
}

// æ–¹æ¡ˆ2ï¼šå•ä¸ªå®ä½“ + ç»„ä»¶ï¼ˆä¸æ¨èï¼Œä½†æœ‰æ—¶æœ‰ç”¨ï¼‰
#[derive(Component)]
struct LevelManager {
    current_level: u32,
    total_enemies: u32,
}

fn setup(mut commands: Commands) {
    commands.spawn(LevelManager {
        current_level: 1,
        total_enemies: 0,
    });
}

fn use_singleton(query: Query&lt;&amp;LevelManager&gt;) {
    let manager = query.single();  // ä¿è¯åªæœ‰ä¸€ä¸ª
    println!("Level: {}", manager.current_level);
}</code></pre><hr/><h4>æ¨¡å¼ 4ï¼šå±‚æ¬¡ç»“æ„ï¼ˆParent-Childrenï¼‰</h4><p>å¤„ç†å®ä½“ä¹‹é—´çš„çˆ¶å­å…³ç³»ï¼š</p><pre><code class="rust">use bevy::hierarchy::*;

// Bevy å†…ç½®çš„å±‚æ¬¡ç»“æ„æ”¯æŒ
fn spawn_spaceship(mut commands: Commands) {
    // çˆ¶å®ä½“ï¼ˆé£èˆ¹ï¼‰
    commands.spawn((
        Transform::default(),
        Ship,
    )).with_children(|parent| {
        // å­å®ä½“ï¼ˆå¼•æ“ï¼‰
        parent.spawn((
            Transform::from_xyz(0.0, -1.0, 0.0),
            Engine,
        ));

        // å­å®ä½“ï¼ˆæ­¦å™¨ï¼‰
        parent.spawn((
            Transform::from_xyz(0.5, 0.0, 0.0),
            Weapon,
        ));
    });
}

// æŸ¥è¯¢å±‚æ¬¡ç»“æ„
fn update_children(
    query: Query&lt;(&amp;Transform, &amp;Children)&gt;,
    child_query: Query&lt;&amp;mut Transform&gt;,
) {
    for (parent_transform, children) in query.iter() {
        for child in children.iter() {
            if let Ok(mut child_transform) = child_query.get_mut(*child) {
                // å­å®ä½“è·Ÿéšçˆ¶å®ä½“ç§»åŠ¨
                child_transform.translation += parent_transform.translation;
            }
        }
    }
}</code></pre><hr/><h4>æ¨¡å¼ 5ï¼šèƒ½åŠ›ç»„ä»¶ï¼ˆCapability Componentï¼‰</h4><p>æ¨¡å—åŒ–çš„èƒ½åŠ›ç³»ç»Ÿï¼š</p><pre><code class="rust">// èƒ½åŠ›ç»„ä»¶
#[derive(Component)]
struct CanJump {
    force: f32,
    max_jumps: u32,
    current_jumps: u32,
}

#[derive(Component)]
struct CanDash {
    speed: f32,
    cooldown: f32,
    current_cooldown: f32,
}

#[derive(Component)]
struct CanFly {
    lift_force: f32,
}

// ä¸åŒå®ä½“æ‹¥æœ‰ä¸åŒèƒ½åŠ›
fn spawn_player(mut commands: Commands) {
    commands.spawn((
        Transform::default(),
        Player,
        CanJump { force: 500.0, max_jumps: 2, current_jumps: 0 },
        CanDash { speed: 1000.0, cooldown: 1.0, current_cooldown: 0.0 },
    ));
}

fn spawn_bird(mut commands: Commands) {
    commands.spawn((
        Transform::default(),
        Bird,
        CanFly { lift_force: 100.0 },
    ));
}

// é€šç”¨çš„è·³è·ƒç³»ç»Ÿï¼ˆé€‚ç”¨äºæ‰€æœ‰èƒ½è·³çš„å®ä½“ï¼‰
fn jump_system(
    keyboard: Res&lt;ButtonInput&lt;KeyCode&gt;&gt;,
    mut query: Query&lt;(&amp;mut Velocity, &amp;mut CanJump)&gt;,
) {
    if keyboard.just_pressed(KeyCode::Space) {
        for (mut velocity, mut jump) in query.iter_mut() {
            if jump.current_jumps &lt; jump.max_jumps {
                velocity.0.y = jump.force;
                jump.current_jumps += 1;
            }
        }
    }
}</code></pre><hr/><h4>æ¨¡å¼ 6ï¼šChanged è¿‡æ»¤å™¨ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰</h4><p>åªå¤„ç†å˜åŒ–çš„ç»„ä»¶ï¼š</p><pre><code class="rust">// åªåœ¨ä½ç½®æ”¹å˜æ—¶æ›´æ–°æ¸²æŸ“
fn render_system(
    query: Query&lt;(&amp;Transform, &amp;Sprite), Changed&lt;Transform&gt;&gt;,
) {
    for (transform, sprite) in query.iter() {
        // åªæœ‰ Transform æ”¹å˜çš„å®ä½“ä¼šè¢«å¤„ç†
        update_sprite_position(sprite, transform);
    }
}

// åªåœ¨ç”Ÿå‘½å€¼æ”¹å˜æ—¶æ›´æ–° UI
fn health_ui_system(
    query: Query&lt;&amp;Health, Changed&lt;Health&gt;&gt;,
    mut text_query: Query&lt;&amp;mut Text&gt;,
) {
    for health in query.iter() {
        if let Ok(mut text) = text_query.get_single_mut() {
            text.0 = format!("HP: {}/{}", health.current, health.max);
        }
    }
}</code></pre><hr/><h4>æ¨¡å¼ 7ï¼šæ‰¹é‡æ“ä½œï¼ˆBatch Operationsï¼‰</h4><p>ä¸€æ¬¡æ€§å¤„ç†å¤šä¸ªå®ä½“ï¼š</p><pre><code class="rust">// æ‰¹é‡ç”Ÿæˆæ•Œäºº
fn spawn_wave(mut commands: Commands) {
    let enemies: Vec&lt;_&gt; = (0..100)
        .map(|i| {
            (
                Transform::from_xyz(i as f32 * 10.0, 0.0, 0.0),
                Velocity(Vec2::new(-50.0, 0.0)),
                Health { current: 50, max: 50 },
                Enemy,
            )
        })
        .collect();

    // æ‰¹é‡ spawn
    commands.spawn_batch(enemies);
}

// æ‰¹é‡é”€æ¯
fn cleanup_dead(
    mut commands: Commands,
    query: Query&lt;Entity, With&lt;Dead&gt;&gt;,
) {
    let dead_entities: Vec&lt;Entity&gt; = query.iter().collect();

    for entity in dead_entities {
        commands.entity(entity).despawn_recursive();
    }
}</code></pre><hr/><h3>8.6 æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ</h3><h4>ä¼˜åŒ– 1ï¼šå‡å°‘ Archetype è¿ç§»</h4><pre><code class="rust">// âŒ é¢‘ç¹è¿ç§»
fn bad_freeze_system(
    mut commands: Commands,
    query: Query&lt;Entity, With&lt;Player&gt;&gt;,
) {
    for entity in query.iter() {
        commands.entity(entity).insert(Frozen);  // æ¯å¸§éƒ½è¿ç§»
        commands.entity(entity).remove::&lt;Frozen&gt;();
    }
}

// âœ… ä½¿ç”¨çŠ¶æ€æšä¸¾
#[derive(Component)]
enum MovementState {
    Normal,
    Frozen,
}

fn good_freeze_system(
    mut query: Query&lt;&amp;mut MovementState&gt;,
) {
    for mut state in query.iter_mut() {
        *state = MovementState::Frozen;  // ä¸è¿ç§» Archetype
    }
}</code></pre><h4>ä¼˜åŒ– 2ï¼šä½¿ç”¨ ParallelIterator</h4><pre><code class="rust">use bevy::tasks::ParallelIterator;

fn parallel_system(
    query: Query&lt;&amp;mut Transform&gt;,
) {
    // è‡ªåŠ¨å¹¶è¡Œè¿­ä»£ï¼ˆéœ€è¦ bevy çš„ parallel featureï¼‰
    query.par_iter_mut().for_each(|mut transform| {
        // å¤æ‚è®¡ç®—
        transform.translation.x += expensive_calculation();
    });
}</code></pre><h4>ä¼˜åŒ– 3ï¼šåˆç†è®¾è®¡ç»„ä»¶å¤§å°</h4><pre><code class="rust">// âŒ ç»„ä»¶å¤ªå¤§
#[derive(Component)]
struct BadComponent {
    data: Vec&lt;u8&gt;,  // åŠ¨æ€åˆ†é…ï¼Œç ´åç¼“å­˜å±€éƒ¨æ€§
    big_array: [f32; 1000],  // 4KBï¼Œæµªè´¹ç¼“å­˜
}

// âœ… ç»„ä»¶å°è€Œç²¾
#[derive(Component)]
struct Position(Vec3);  // 12 å­—èŠ‚

#[derive(Component)]
struct DataRef {
    handle: Handle&lt;Data&gt;,  // åªå­˜å¼•ç”¨ï¼Œå®é™…æ•°æ®åœ¨ AssetServer
}</code></pre><hr/><h2>ä¹ã€å®Œæ•´å®æˆ˜ç¤ºä¾‹ï¼šç”¨ Bevy æ„å»ºç®€å•å¼¹çƒæ¸¸æˆ</h2><h3>9.1 é¡¹ç›®æ¦‚è¿°</h3><p>æˆ‘ä»¬å°†ç”¨ Bevy ECS æ„å»ºä¸€ä¸ªç®€å•çš„å¼¹çƒæ¸¸æˆï¼ŒåŒ…å«ï¼š</p><ul><li>âœ… ç©å®¶æ§åˆ¶çš„æŒ¡æ¿</li><li>âœ… è‡ªåŠ¨å¼¹è·³çš„çƒ</li><li>âœ… å¯ç ´åçš„ç –å—</li><li>âœ… ç¢°æ’æ£€æµ‹</li><li>âœ… åˆ†æ•°ç³»ç»Ÿ</li></ul><p><strong>å®Œæ•´ä»£ç </strong>ï¼ˆçº¦ 250 è¡Œï¼Œå¯ç›´æ¥è¿è¡Œï¼‰ï¼š</p><pre><code class="rust">// Cargo.toml ä¾èµ–
// [dependencies]
// bevy = "0.19"

use bevy::prelude::*;
use bevy::sprite::collide_aabb::*;

// ======================== ç»„ä»¶å®šä¹‰ ========================

#[derive(Component, Clone, Copy, Debug)]
struct Position(Vec2);

#[derive(Component, Clone, Copy, Debug)]
struct Velocity(Vec2);

#[derive(Component, Clone, Copy, Debug)]
struct Size(Vec2);

// æ ‡è®°ç»„ä»¶
#[derive(Component)]
struct Ball;

#[derive(Component)]
struct Paddle;

#[derive(Component)]
struct Brick;

#[derive(Component)]
struct Collider;

// ======================== èµ„æºå®šä¹‰ ========================

#[derive(Resource, Default)]
struct Score(u32);

#[derive(Resource)]
struct GameConfig {
    paddle_speed: f32,
    ball_speed: f32,
    window_width: f32,
    window_height: f32,
}

// ======================== ä¸»å‡½æ•° ========================

fn main() {
    App::new()
        .add_plugins(DefaultPlugins)
        .insert_resource(Score(0))
        .insert_resource(GameConfig {
            paddle_speed: 500.0,
            ball_speed: 300.0,
            window_width: 800.0,
            window_height: 600.0,
        })
        .add_systems(Startup, setup)
        .add_systems(Update, (
            paddle_movement,
            ball_movement,
            ball_collision,
            brick_collision,
        ))
        .run();
}

// ======================== åˆå§‹åŒ–ç³»ç»Ÿ ========================

fn setup(
    mut commands: Commands,
    config: Res&lt;GameConfig&gt;,
) {
    // æ‘„åƒæœº
    commands.spawn(Camera2d);

    // æŒ¡æ¿
    commands.spawn((
        Sprite {
            color: Color::srgb(0.3, 0.3, 0.7),
            custom_size: Some(Vec2::new(120.0, 20.0)),
            ..default()
        },
        Transform::from_xyz(0.0, -250.0, 0.0),
        Paddle,
        Collider,
    ));

    // çƒ
    commands.spawn((
        Sprite {
            color: Color::srgb(1.0, 0.5, 0.5),
            custom_size: Some(Vec2::new(20.0, 20.0)),
            ..default()
        },
        Transform::from_xyz(0.0, -200.0, 0.0),
        Velocity(Vec2::new(200.0, 200.0)),
        Ball,
    ));

    // ç –å—ï¼ˆ5 è¡Œ Ã— 10 åˆ—ï¼‰
    let brick_width = 60.0;
    let brick_height = 20.0;
    let gap = 5.0;
    let total_width = 10.0 * (brick_width + gap);
    let start_x = -total_width / 2.0 + brick_width / 2.0;

    for row in 0..5 {
        for col in 0..10 {
            let x = start_x + col as f32 * (brick_width + gap);
            let y = 200.0 - row as f32 * (brick_height + gap);

            commands.spawn((
                Sprite {
                    color: Color::srgb(
                        0.5 + row as f32 * 0.1,
                        0.5,
                        0.5 + col as f32 * 0.05,
                    ),
                    custom_size: Some(Vec2::new(brick_width, brick_height)),
                    ..default()
                },
                Transform::from_xyz(x, y, 0.0),
                Brick,
                Collider,
            ));
        }
    }

    // åˆ†æ•°æ˜¾ç¤º
    commands.spawn((
        Text::new("Score: 0"),
        TextFont {
            font_size: 30.0,
            ..default()
        },
        TextColor(Color::WHITE),
        Node {
            position_type: PositionType::Absolute,
            top: Val::Px(10.0),
            left: Val::Px(10.0),
            ..default()
        },
    ));
}

// ======================== æ¸¸æˆç³»ç»Ÿ ========================

// æŒ¡æ¿ç§»åŠ¨ç³»ç»Ÿ
fn paddle_movement(
    keyboard: Res&lt;ButtonInput&lt;KeyCode&gt;&gt;,
    config: Res&lt;GameConfig&gt;,
    time: Res&lt;Time&gt;,
    mut query: Query&lt;&amp;mut Transform, With&lt;Paddle&gt;&gt;,
) {
    let mut paddle_transform = query.single_mut();
    let mut direction = 0.0;

    if keyboard.pressed(KeyCode::ArrowLeft) {
        direction -= 1.0;
    }
    if keyboard.pressed(KeyCode::ArrowRight) {
        direction += 1.0;
    }

    let new_x = paddle_transform.translation.x
        + direction * config.paddle_speed * time.delta_secs();

    // é™åˆ¶åœ¨å±å¹•å†…
    let half_width = config.window_width / 2.0 - 60.0;
    paddle_transform.translation.x = new_x.clamp(-half_width, half_width);
}

// çƒç§»åŠ¨ç³»ç»Ÿ
fn ball_movement(
    config: Res&lt;GameConfig&gt;,
    time: Res&lt;Time&gt;,
    mut query: Query&lt;(&amp;mut Transform, &amp;mut Velocity), With&lt;Ball&gt;&gt;,
) {
    for (mut transform, mut velocity) in query.iter_mut() {
        // æ›´æ–°ä½ç½®
        transform.translation.x += velocity.0.x * time.delta_secs();
        transform.translation.y += velocity.0.y * time.delta_secs();

        // å¢™å£ç¢°æ’
        let half_width = config.window_width / 2.0;
        let half_height = config.window_height / 2.0;

        if transform.translation.x.abs() &gt; half_width - 10.0 {
            velocity.0.x = -velocity.0.x;
        }
        if transform.translation.y &gt; half_height - 10.0 {
            velocity.0.y = -velocity.0.y;
        }

        // çƒæ‰è½ï¼ˆé‡ç½®æ¸¸æˆï¼‰
        if transform.translation.y &lt; -half_height {
            transform.translation = Vec3::new(0.0, -200.0, 0.0);
            velocity.0 = Vec2::new(200.0, 200.0);
        }
    }
}

// çƒä¸æŒ¡æ¿/å¢™å£ç¢°æ’
fn ball_collision(
    mut ball_query: Query&lt;(&amp;Transform, &amp;mut Velocity), With&lt;Ball&gt;&gt;,
    collider_query: Query&lt;&amp;Transform, (With&lt;Collider&gt;, Without&lt;Ball&gt;)&gt;,
) {
    for (ball_transform, mut ball_velocity) in ball_query.iter_mut() {
        let ball_size = Vec2::new(20.0, 20.0);

        for collider_transform in collider_query.iter() {
            let collision = collide(
                ball_transform.translation,
                ball_size,
                collider_transform.translation,
                Vec2::new(120.0, 20.0), // å‡è®¾ç¢°æ’ä½“å¤§å°
            );

            if let Some(collision) = collision {
                match collision {
                    Collision::Top | Collision::Bottom =&gt; {
                        ball_velocity.0.y = -ball_velocity.0.y;
                    }
                    Collision::Left | Collision::Right =&gt; {
                        ball_velocity.0.x = -ball_velocity.0.x;
                    }
                    _ =&gt; {}
                }
            }
        }
    }
}

// ç –å—ç¢°æ’ä¸é”€æ¯
fn brick_collision(
    mut commands: Commands,
    mut score: ResMut&lt;Score&gt;,
    ball_query: Query&lt;&amp;Transform, With&lt;Ball&gt;&gt;,
    brick_query: Query&lt;(Entity, &amp;Transform), With&lt;Brick&gt;&gt;,
    mut text_query: Query&lt;&amp;mut Text&gt;,
) {
    let ball_size = Vec2::new(20.0, 20.0);

    for ball_transform in ball_query.iter() {
        for (brick_entity, brick_transform) in brick_query.iter() {
            let collision = collide(
                ball_transform.translation,
                ball_size,
                brick_transform.translation,
                Vec2::new(60.0, 20.0),
            );

            if collision.is_some() {
                // é”€æ¯ç –å—
                commands.entity(brick_entity).despawn();

                // å¢åŠ åˆ†æ•°
                score.0 += 10;

                // æ›´æ–° UI
                if let Ok(mut text) = text_query.get_single_mut() {
                    text.0 = format!("Score: {}", score.0);
                }
            }
        }
    }
}</code></pre><h3>9.2 ä»£ç è§£æ</h3><h4>æ ¸å¿ƒæ¶æ„è®¾è®¡</h4><ol><li><p><strong>ç»„ä»¶åˆ†ç¦»</strong>ï¼š</p><ul><li><code>Ball</code>ã€<code>Paddle</code>ã€<code>Brick</code> åªæ˜¯æ ‡è®°</li><li><code>Transform</code>ã€<code>Velocity</code> æ˜¯å®é™…æ•°æ®</li><li>æ¯ä¸ªç»„ä»¶èŒè´£å•ä¸€</li></ul></li><li><p><strong>ç³»ç»Ÿè§£è€¦</strong>ï¼š</p><ul><li><code>paddle_movement</code> åªå…³å¿ƒæŒ¡æ¿</li><li><code>ball_movement</code> åªå…³å¿ƒçƒ</li><li><code>brick_collision</code> å¤„ç†ç –å—é€»è¾‘</li></ul></li><li><p><strong>èµ„æºç®¡ç†</strong>ï¼š</p><ul><li><code>Score</code> æ˜¯å…¨å±€çŠ¶æ€</li><li><code>GameConfig</code> å­˜å‚¨é…ç½®</li></ul></li></ol><h4>è¿è¡Œé¡¹ç›®</h4><pre><code class="bash"># åˆ›å»ºé¡¹ç›®
cargo new bevy_breakout
cd bevy_breakout

# æ·»åŠ ä¾èµ–
cargo add bevy@0.19

# å¤åˆ¶ä»£ç åˆ° src/main.rs

# è¿è¡Œ
cargo run --release</code></pre><h4>æ€§èƒ½ç‰¹ç‚¹</h4><ul><li>âœ… æ‰€æœ‰çƒéƒ½åœ¨è¿ç»­å†…å­˜ä¸­ï¼ˆå¦‚æœæœ‰å¤šä¸ªçƒï¼‰</li><li>âœ… ç³»ç»Ÿè‡ªåŠ¨å¹¶è¡Œæ‰§è¡Œ</li><li>âœ… ç¼“å­˜å‹å¥½çš„å†…å­˜è®¿é—®æ¨¡å¼</li></ul><hr/><h2>åã€å®æˆ˜æ¡ˆä¾‹åˆ†æ</h2><h3>æ¡ˆä¾‹ 1ï¼šã€Šå®ˆæœ›å…ˆé”‹ã€‹- Blizzardï¼ˆ2016ï¼‰</h3><p><strong>èƒŒæ™¯</strong>ï¼š</p><ul><li>6v6 å¤šäºº FPS æ¸¸æˆ</li><li>æ¯ä¸ªè‹±é›„æœ‰ 4+ ç‹¬ç‰¹æŠ€èƒ½</li><li>å¤§é‡æŠ•å°„ç‰©ã€ç²’å­æ•ˆæœã€ç‰©ç†äº¤äº’</li><li>éœ€è¦æ”¯æŒ 60Hz tick rate çš„æœåŠ¡å™¨</li></ul><p><strong>æŠ€æœ¯æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>è‡ªç ” ECS æ¡†æ¶ï¼ˆåŸºäºç»„ä»¶çš„æ¸¸æˆå¯¹è±¡æ¨¡å‹ï¼‰</li><li><p>æ‰€æœ‰æ¸¸æˆå¯¹è±¡éƒ½æ˜¯ Entity + Componentsï¼š</p><ul><li>è‹±é›„ = Entity + <code>Transform</code> + <code>Health</code> + <code>Abilities</code> + <code>Animation</code> ...</li><li>å­å¼¹ = Entity + <code>Transform</code> + <code>Projectile</code> + <code>Damage</code> ...</li><li>æŠ€èƒ½æ•ˆæœ = Entity + <code>Transform</code> + <code>VFX</code> + <code>Duration</code> ...</li></ul></li></ul><p><strong>æ ¸å¿ƒè®¾è®¡</strong>ï¼š</p><pre><code class="rust">// å®ˆæœ›å…ˆé”‹çš„ç»„ä»¶è®¾è®¡ï¼ˆæ¦‚å¿µåŒ–çš„ Rust è¡¨ç¤ºï¼‰
struct Hero {
    entity: Entity,
    // ç»„ä»¶é€šè¿‡ ID å¼•ç”¨
    components: Vec&lt;ComponentId&gt;,
}

// æŠ€èƒ½ç³»ç»Ÿä¹Ÿæ˜¯ ECS
struct Ability {
    cooldown: f32,
    energy_cost: f32,
    effects: Vec&lt;EffectComponent&gt;,
}

// ç½‘ç»œåŒæ­¥ä¼˜åŒ–ï¼šåªåŒæ­¥å˜åŒ–çš„ç»„ä»¶
struct ReplicationComponent {
    last_synced_value: Value,
    dirty: bool,  // æ˜¯å¦éœ€è¦åŒæ­¥
}</code></pre><p><strong>æˆæœ</strong>ï¼š</p><ul><li>âœ… å®¢æˆ·ç«¯ç¨³å®š <strong>60 FPS</strong></li><li>âœ… æœåŠ¡å™¨æ¯ç§’å¤„ç† <strong>100 ä¸‡+</strong> ç»„ä»¶æ›´æ–°</li><li>âœ… ç½‘ç»œå¸¦å®½å‡å°‘ <strong>40%</strong>ï¼ˆåªåŒæ­¥å˜åŒ–çš„ç»„ä»¶ï¼Œè€Œéæ•´ä¸ªå¯¹è±¡ï¼‰</li><li>âœ… æŠ€èƒ½ç³»ç»Ÿé«˜åº¦æ¨¡å—åŒ–ï¼ˆæ–°è‹±é›„å¼€å‘å‘¨æœŸç¼©çŸ­ 30%ï¼‰</li></ul><p><strong>ç½‘ç»œåŒæ­¥ä¼˜åŒ–</strong>ï¼š</p><ul><li>ä¼ ç»Ÿ OOPï¼šæ¯ä¸ªè‹±é›„å¯¹è±¡åºåˆ—åŒ– â†’ 200+ å­—èŠ‚/å¸§</li><li>ECS æ–¹æ¡ˆï¼šåªåºåˆ—åŒ–å˜åŒ–çš„ç»„ä»¶ â†’ å¹³å‡ 50-80 å­—èŠ‚/å¸§</li></ul><p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p><ul><li><a href="https://link.segmentfault.com/?enc=SmmnK9h4ZC7YW%2FOc628yiw%3D%3D.bHyDSba%2FWE1VMrOAbo2MjWcXVpddmOyoqPQxTRArquz1OUpP5NXExNtlio9zUAGl" rel="nofollow" target="_blank">GDC 2017: Overwatch Gameplay Architecture</a></li><li><a href="https://link.segmentfault.com/?enc=jYOaBSTOObOJ7gT%2BhjXt0Q%3D%3D.Y%2F5jW1IezSw08MeX0VJcfPlJjTJ%2FBBUK%2FTDH0vEKGByPSQTn%2BwYWT%2BeNDgk8DvIurQ%2B%2FjK5UN4oSRGTH9vV5Ag%3D%3D" rel="nofollow" target="_blank">ECS Back and Forth - Part 7: Overwatch</a></li></ul><p><strong>å¯ç¤º</strong>ï¼š<br/>å³ä½¿æ˜¯å°‘é‡å®ä½“ï¼ˆ12 ä¸ªç©å®¶ï¼‰ï¼ŒECS åœ¨å¤æ‚äº¤äº’ã€ç½‘ç»œåŒæ­¥åœºæ™¯ä¸‹ä»æœ‰å·¨å¤§ä¼˜åŠ¿ã€‚</p><hr/><h3>æ¡ˆä¾‹ 2ï¼šã€Šé»‘å®¢å¸å›½ï¼šè§‰é†’ã€‹æŠ€æœ¯æ¼”ç¤º - Epic Gamesï¼ˆ2021ï¼‰</h3><p><strong>èƒŒæ™¯</strong>ï¼š</p><ul><li>Unreal Engine 5 æŠ€æœ¯æ¼”ç¤º</li><li>æ¨¡æ‹Ÿå¼€æ”¾ä¸–ç•ŒåŸå¸‚ï¼Œæ•°ä¸‡ NPC åŒæ—¶æ´»åŠ¨</li><li>å±•ç¤ºæ¬¡ä¸–ä»£å®æ—¶æ¸²æŸ“èƒ½åŠ›</li></ul><p><strong>æŠ€æœ¯æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>Mass Framework</strong>ï¼ˆUnreal çš„ ECS ç³»ç»Ÿï¼‰</li><li><strong>Niagara</strong>ï¼šç²’å­ç³»ç»Ÿï¼ˆè½¦è¾†å°¾æ°”ã€çˆ†ç‚¸æ•ˆæœï¼‰</li><li><strong>Nanite</strong>ï¼šè™šæ‹Ÿå‡ ä½•ï¼ˆé«˜ç²¾åº¦å»ºç­‘æ¨¡å‹ï¼‰</li><li><strong>Lumen</strong>ï¼šå…¨å±€å…‰ç…§</li></ul><p><strong>Mass Framework æ¶æ„</strong>ï¼š</p><pre><code class="cpp">// Mass Framework çš„ç»„ä»¶è®¾è®¡ï¼ˆç®€åŒ–ï¼‰
struct FMassMovementFragment : public FMassFragment {
    FVector Velocity;
    float Speed;
};

struct FMassNavigationFragment : public FMassFragment {
    FVector Target;
    TArray&lt;FVector&gt; Path;
};

// Processorï¼ˆSystemï¼‰æ‰¹é‡å¤„ç†
class UMassCrowdProcessor : public UMassProcessor {
    void Execute(FMassEntityManager&amp; EntityManager,
                 FMassExecutionContext&amp; Context) {
        // æ‰¹é‡æ›´æ–°æ•°ä¸‡ä¸ª NPC
        EntityQuery.ForEachEntityChunk(EntityManager, Context,
            [](FMassExecutionContext&amp; Context) {
                auto Movements = Context.GetMutableFragmentView&lt;FMassMovementFragment&gt;();
                auto Transforms = Context.GetMutableFragmentView&lt;FTransformFragment&gt;();

                for (int32 i = 0; i &lt; Context.GetNumEntities(); ++i) {
                    Transforms[i].Position += Movements[i].Velocity * DeltaTime;
                }
            });
    }
};</code></pre><p><strong>LOD ç³»ç»Ÿè®¾è®¡</strong>ï¼š</p><table><thead><tr><th>è·ç¦»</th><th>NPC çŠ¶æ€</th><th>æ›´æ–°é¢‘ç‡</th><th>åŠ¨ç”»</th><th>AI</th></tr></thead><tbody><tr><td>0-50m</td><td>High Detail</td><td>60 FPS</td><td>å®Œæ•´éª¨éª¼</td><td>å®Œæ•´é€»è¾‘</td></tr><tr><td>50-200m</td><td>Medium</td><td>30 FPS</td><td>ç®€åŒ–åŠ¨ç”»</td><td>ç®€åŒ– AI</td></tr><tr><td>200-500m</td><td>Low</td><td>10 FPS</td><td>å•å¸§åŠ¨ç”»</td><td>çŠ¶æ€æœº</td></tr><tr><td>500m+</td><td>Culled</td><td>1 FPS</td><td>æ— </td><td>ä»…ä½ç½®æ›´æ–°</td></tr></tbody></table><p><strong>æˆæœ</strong>ï¼š</p><ul><li>âœ… åŒå± <strong>35,000+ ä¸ª</strong> å¯äº¤äº’ NPC</li><li>âœ… æ¯ä¸ª NPC æœ‰ç‹¬ç«‹ AIã€è·¯å¾„å¯»æ‰¾ã€åŠ¨ç”»</li><li>âœ… PlayStation 5 ä¿æŒ <strong>30 FPS</strong>ï¼ˆ4K åˆ†è¾¨ç‡ï¼‰</li><li>âœ… åŠ¨æ€åŠ è½½å¸è½½ï¼šç©å®¶ç§»åŠ¨æ—¶å®æ—¶æ¿€æ´»/ä¼‘çœ å®ä½“</li></ul><p><strong>æ€§èƒ½æ•°æ®</strong>ï¼š</p><ul><li>CPU è´Ÿè½½ï¼šMass Framework å  <strong>15-20%</strong>ï¼ˆ8 æ ¸ Zen 2ï¼‰</li><li>å†…å­˜å ç”¨ï¼šæ¯ä¸ª NPC å¹³å‡ <strong>200 å­—èŠ‚</strong>ï¼ˆç»„ä»¶æ•°æ®ï¼‰</li><li>æ‰¹é‡å¤„ç†ï¼šæ¯æ¬¡æ›´æ–°å¤„ç† <strong>1000+ ä¸ª</strong> NPCï¼ˆSIMD ä¼˜åŒ–ï¼‰</li></ul><p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p><ul><li><a href="https://link.segmentfault.com/?enc=3NtwsgXIk8lMRwbeS15CYQ%3D%3D.J708NH9YIiraBqxJjQ%2FP4p9gDVdwePGHNbQPRUmt1cnaNn1z5Xokui%2Bv2bN2eJwHcHlD1F06S4u%2BPYPQ%2BzzQGQAHPDCR4fnFf00t124JLidwV8L91KcdZhkzKdduU3OayVVZK%2BSN4DyQasr4TP8cSw%3D%3D" rel="nofollow" target="_blank">Unreal Engine 5 - The Matrix Awakens Technical Breakdown</a></li><li><a href="https://link.segmentfault.com/?enc=XxvKIn5VW11W5zLtPxjyfA%3D%3D.FYe4t7cJAI%2FrXJhJ6jaJ7fd%2FpeFybPOVpieNJ2coqzxYN1vmCopP3rm%2BO2zQAWy9lnlsBuXZcTLe5tfLM5EtafBjouU%2FEZB%2FRkDiQ0ja3sRmgksTw1ZlKVN3LSzITtTv" rel="nofollow" target="_blank">Mass Framework Documentation</a></li></ul><p><strong>å¯ç¤º</strong>ï¼š<br/>ECS ä½¿å¾—å¤§è§„æ¨¡å®æ—¶æ¨¡æ‹Ÿæˆä¸ºå¯èƒ½ã€‚é€šè¿‡ LOD ç³»ç»Ÿå’Œç©ºé—´åˆ†å—ï¼Œå³ä½¿æ˜¯ AAA çº§ç”»è´¨ä¹Ÿèƒ½ä¿æŒæµç•…å¸§ç‡ã€‚</p><hr/><h3>æ¡ˆä¾‹ 3ï¼šã€ŠBrotatoã€‹- ç‹¬ç«‹æ¸¸æˆï¼ˆ2022ï¼‰</h3><p><strong>èƒŒæ™¯</strong>ï¼š</p><ul><li>ä½¿ç”¨ <strong>Godot 3.5</strong>ï¼ˆé ECS å¼•æ“ï¼‰å¼€å‘çš„è‚‰é¸½ç”Ÿå­˜æ¸¸æˆ</li><li>å±å¹•ä¸ŠåŒæ—¶æœ‰ <strong>æ•°ç™¾ä¸ª</strong> æ•Œäººå’Œ <strong>æ•°åƒå‘</strong> å­å¼¹</li><li>ç›®æ ‡å¹³å°ï¼šPC + Switch + ç§»åŠ¨ç«¯</li></ul><p><strong>æŒ‘æˆ˜</strong>ï¼š</p><ul><li><p>Godot çš„ <strong>Node æ ‘ç³»ç»Ÿ</strong> åœ¨å¤§é‡å®ä½“æ—¶æ€§èƒ½ç“¶é¢ˆï¼š</p><ul><li>æ¯ä¸ª Node æœ‰ç»§æ‰¿å¼€é”€ï¼ˆçˆ¶ç±»æ–¹æ³•è°ƒç”¨ï¼‰</li><li>Node æ ‘éå†ä¸æ˜¯ç¼“å­˜å‹å¥½</li><li>GDScript è§£é‡Šæ‰§è¡Œé€Ÿåº¦æ…¢</li></ul></li><li>é¢„æœŸæ€§èƒ½ï¼š300+ æ•Œäººæ—¶å¸§ç‡é™è‡³ <strong>15-20 FPS</strong></li></ul><p><strong>"ç±» ECS"è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><p>å¼€å‘è€… <strong>Blobfish</strong> æ‰‹åŠ¨å®ç°äº†æ•°æ®å¯¼å‘è®¾è®¡ï¼š</p><pre><code class="python"># Godot GDScript - ç±» ECS æ¶æ„

# ä¼ ç»Ÿ Godot æ–¹å¼ï¼ˆæ…¢ï¼‰
# class Enemy extends Node2D:
#     var position = Vector2()
#     var velocity = Vector2()
#     var health = 100
#     func _process(delta):
#         position += velocity * delta  # æ¯ä¸ª Node ç‹¬ç«‹æ›´æ–°

# "ç±» ECS"æ–¹å¼ï¼ˆå¿«ï¼‰
class EnemyManager:
    var positions = []      # PackedVector2Arrayï¼ˆè¿ç»­å†…å­˜ï¼‰
    var velocities = []     # PackedVector2Array
    var healths = []        # PackedInt32Array
    var sprites = []        # åªå­˜å¼•ç”¨ï¼ˆç”¨äºæ¸²æŸ“ï¼‰

    # æ‰¹é‡æ›´æ–°ï¼ˆæ•°æ®å¯¼å‘ï¼‰
    func update_movement(delta):
        for i in range(positions.size()):
            positions[i] += velocities[i] * delta  # è¿ç»­å†…å­˜è®¿é—®

    func update_rendering():
        for i in range(sprites.size()):
            sprites[i].position = positions[i]  # æ›´æ–°æ¸²æŸ“ä½ç½®</code></pre><p><strong>å…·ä½“ä¼˜åŒ–æªæ–½</strong>ï¼š</p><ol><li><p><strong>å¯¹è±¡æ± </strong>ï¼šé¢„åˆ†é… 1000 ä¸ªå®ä½“ï¼Œå¤ç”¨è€Œéåˆ›å»º/é”€æ¯</p><pre><code class="python">var entity_pool = []  # é¢„åˆ†é…
var active_entities = []  # æ´»è·ƒå®ä½“ç´¢å¼•</code></pre></li><li><p><strong>æ‰¹é‡å¤„ç†</strong>ï¼šæ‰€æœ‰æ•Œäººä¸€æ¬¡æ€§æ›´æ–°</p><pre><code class="python"># æ‰¹é‡ç¢°æ’æ£€æµ‹ï¼ˆç©ºé—´å“ˆå¸Œï¼‰
func check_collisions():
    var grid = {}
    for i in active_entities:
        var cell = get_grid_cell(positions[i])
        if not grid.has(cell):
            grid[cell] = []
        grid[cell].append(i)
    # åªæ£€æµ‹åŒä¸€æ ¼å­å†…çš„ç¢°æ’</code></pre></li><li><strong>å¤šçº¿ç¨‹</strong>ï¼šå°†æ¸²æŸ“å’Œé€»è¾‘åˆ†ç¦»ï¼ˆGodot Threadï¼‰</li></ol><p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p><table><thead><tr><th>æ–¹æ¡ˆ</th><th>300 æ•Œäºº</th><th>500 æ•Œäºº</th><th>1000 æ•Œäºº</th></tr></thead><tbody><tr><td>ä¼ ç»Ÿ Node</td><td>18 FPS</td><td>10 FPS</td><td>å´©æºƒ</td></tr><tr><td>ç±» ECS</td><td>60 FPS</td><td>55 FPS</td><td>40 FPS</td></tr><tr><td><strong>æå‡</strong></td><td><strong>3.3x</strong></td><td><strong>5.5x</strong></td><td><strong>å¯è¿è¡Œ</strong></td></tr></tbody></table><p><strong>æˆæœ</strong>ï¼š</p><ul><li>âœ… Steam æ”¶å…¥è¶… <strong>1000 ä¸‡ç¾å…ƒ</strong>ï¼ˆ2022-2023ï¼‰</li><li>âœ… ç¨³å®š <strong>60 FPS</strong>ï¼ˆPCï¼‰/ <strong>30 FPS</strong>ï¼ˆSwitchï¼‰</li><li>âœ… æœ€å¤šåŒå± <strong>800+ ä¸ª</strong> æ´»è·ƒå®ä½“</li></ul><p><strong>ä»£ç ç‰‡æ®µ</strong>ï¼ˆå®é™…æ¸¸æˆä¸­çš„ç®€åŒ–ç‰ˆæœ¬ï¼‰ï¼š</p><pre><code class="python"># enemy_system.gd
extends Node

# ç»„ä»¶æ•°ç»„ï¼ˆSoA å¸ƒå±€ï¼‰
var positions: PackedVector2Array = PackedVector2Array()
var velocities: PackedVector2Array = PackedVector2Array()
var healths: PackedInt32Array = PackedInt32Array()

func _physics_process(delta):
    # æ‰¹é‡ç§»åŠ¨
    for i in range(positions.size()):
        positions[i] += velocities[i] * delta

    # æ‰¹é‡ç¢°æ’ï¼ˆç®€åŒ–ï¼‰
    for i in range(positions.size()):
        if check_bullet_collision(positions[i]):
            healths[i] -= 10

    # æ‰¹é‡æ¸…ç†
    for i in range(healths.size() - 1, -1, -1):  # é€†åºéå†
        if healths[i] &lt;= 0:
            remove_entity(i)</code></pre><p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p><ul><li><a href="https://link.segmentfault.com/?enc=kmy4lXr4FVoxIpv5uLajIQ%3D%3D.dE61w6GHlDiDA1HLwm3%2F3oXjt9lV9YduRfoiIJu3Ci3m1mEBKcdfKAK34OuSJ43pClqIrndo5OZOXQh1uhs0Nrs%2FEPmGvg4dDjjgQWq0SD4va4zu0697vAFBFGqVIN1dEApa6P8vBJ4dhxbY8Y01qw%3D%3D" rel="nofollow" target="_blank">Brotato Devlog - Performance Optimization</a></li><li><a href="https://link.segmentfault.com/?enc=bZ%2ByaXzWwNRioZ5A0BkNkg%3D%3D.atUQ4bOAHRTGrGqGVyjtezj5MJ7PSqnsuFFo20Oq6Tl3LmhwzalNhApW6h5ko9VS" rel="nofollow" target="_blank">Steam Stats</a></li></ul><p><strong>å¯ç¤º</strong>ï¼š</p><ul><li>å³ä½¿å¼•æ“ä¸åŸç”Ÿæ”¯æŒ ECSï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨å®ç°æ•°æ®å¯¼å‘è®¾è®¡</li><li>æ ¸å¿ƒæ€æƒ³ï¼š<strong>è¿ç»­å†…å­˜ + æ‰¹é‡å¤„ç† &gt; é¢å‘å¯¹è±¡</strong></li><li>ç‹¬ç«‹å¼€å‘è€…ä¹Ÿèƒ½ç”¨ ECS æ€æƒ³ä¼˜åŒ–æ€§èƒ½</li></ul><hr/><h2>åã€æœªæ¥å±•æœ›</h2><h3>1. <strong>ç¼–è¾‘å™¨å·¥å…·æ”¹è¿›</strong></h3><ul><li>Unity æ­£åœ¨å¼€å‘ DOTS å¯è§†åŒ–ç¼–è¾‘å™¨</li><li>Bevy ç¤¾åŒºæ¢ç´¢ç¬¬ä¸‰æ–¹ç¼–è¾‘å™¨æ–¹æ¡ˆ</li><li>æœªæ¥å¯èƒ½å‡ºç°"æ‰€è§å³æ‰€å¾—"çš„ ECS ç¼–è¾‘å™¨</li></ul><h3>2. <strong>AI ä¸ ECS ç»“åˆ</strong></h3><ul><li>è¡Œä¸ºæ ‘ã€GOAP ç­‰ AI ç³»ç»Ÿå¤©ç„¶é€‚åˆ ECS</li><li>æœªæ¥å¤§è§„æ¨¡ NPC AI å°†æ›´ä¾èµ– ECS</li></ul><h3>3. <strong>è·¨å¼•æ“æ ‡å‡†åŒ–</strong></h3><ul><li>å¯èƒ½å‡ºç°ç»Ÿä¸€çš„ ECS API æ ‡å‡†</li><li>ç»„ä»¶å’Œç³»ç»Ÿå¯åœ¨ä¸åŒå¼•æ“é—´è¿ç§»</li></ul><h3>4. <strong>ç¡¬ä»¶ååŒ</strong></h3><ul><li>GPU è®¡ç®—ä¸ ECS ç»“åˆï¼ˆå¦‚ Unity DOTS çš„ GPU å®ä¾‹åŒ–ï¼‰</li><li>ä¸“ç”¨ç¡¬ä»¶åŠ é€Ÿï¼ˆç±»ä¼¼å…‰çº¿è¿½è¸ªæ ¸å¿ƒï¼‰</li></ul><hr/><h2>åä¸€ã€æ€»ç»“ä¸å»ºè®®</h2><h3>ECS æ ¸å¿ƒä»·å€¼</h3><blockquote><strong>ECS ä¸æ˜¯é“¶å¼¹ï¼Œè€Œæ˜¯ä¸€ç§å·¥å…·</strong></blockquote><p>å®ƒçš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p><ol><li><strong>æ•°æ®å¯¼å‘æ€ç»´</strong>ï¼šå…³æ³¨"æ•°æ®å¦‚ä½•æµåŠ¨"è€Œé"å¯¹è±¡å¦‚ä½•äº¤äº’"</li><li><strong>æ€§èƒ½ä¼˜å…ˆ</strong>ï¼šé€šè¿‡å†…å­˜å¸ƒå±€ä¼˜åŒ–è¾¾åˆ°æè‡´æ€§èƒ½</li><li><strong>æ‰©å±•æ€§</strong>ï¼šç»„åˆä¼˜äºç»§æ‰¿ï¼Œé€‚åº”éœ€æ±‚å˜åŒ–</li></ol><hr/><h3>ç»™å¼€å‘è€…çš„å»ºè®®</h3><h4>å¦‚æœä½ æ˜¯åˆå­¦è€…</h4><ul><li><strong>å…ˆå­¦ OOP</strong>ï¼šæ‰“å¥½åŸºç¡€</li><li><strong>ç†è§£æ•°æ®ç»“æ„</strong>ï¼šå­¦ä¹ ç¼“å­˜ã€å†…å­˜å¯¹é½ç­‰æ¦‚å¿µ</li><li><strong>å°é¡¹ç›®è¯•æ°´</strong>ï¼šç”¨ Bevy æˆ– Unity DOTS åš demo</li></ul><h4>å¦‚æœä½ æ˜¯ç»éªŒä¸°å¯Œçš„å¼€å‘è€…</h4><ul><li><strong>è¯„ä¼°é¡¹ç›®éœ€æ±‚</strong>ï¼šæ˜¯å¦çœŸçš„éœ€è¦ ECS</li><li><strong>æ¸è¿›å¼é‡‡ç”¨</strong>ï¼šå¯ä»¥æ··åˆ OOP å’Œ ECS</li><li><strong>å…³æ³¨ç“¶é¢ˆ</strong>ï¼šç”¨æ€§èƒ½åˆ†æå·¥å…·æ‰¾çœŸæ­£çš„é—®é¢˜</li></ul><h4>å¦‚æœä½ æ˜¯å›¢é˜Ÿé¢†å¯¼</h4><ul><li><strong>è€ƒè™‘å­¦ä¹ æˆæœ¬</strong>ï¼šå›¢é˜Ÿæ˜¯å¦æœ‰æ—¶é—´é€‚åº”</li><li><strong>å·¥å…·é“¾è¯„ä¼°</strong>ï¼šæ˜¯å¦æœ‰è¶³å¤Ÿçš„ç¼–è¾‘å™¨æ”¯æŒ</li><li><strong>é£é™©æ§åˆ¶</strong>ï¼šå•†ä¸šé¡¹ç›®è°¨æ…é€‰æ‹©ä¸æˆç†ŸæŠ€æœ¯</li></ul><hr/><h3>æœ€ç»ˆæ¨è</h3><table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ¶æ„</th><th>ç†ç”±</th></tr></thead><tbody><tr><td><strong>åŸå‹å¼€å‘</strong></td><td>OOP</td><td>å¿«é€Ÿè¿­ä»£</td></tr><tr><td><strong>å°å‹ç‹¬ç«‹æ¸¸æˆ</strong></td><td>GameObject-Component</td><td>å¹³è¡¡çµæ´»æ€§å’Œæ€§èƒ½</td></tr><tr><td><strong>å¤§è§„æ¨¡æ¨¡æ‹Ÿ</strong></td><td>ECS</td><td>æ€§èƒ½éœ€æ±‚</td></tr><tr><td><strong>AAA å¤šäººæ¸¸æˆ</strong></td><td>æ··åˆæ¶æ„</td><td>å…³é”®ç³»ç»Ÿç”¨ ECSï¼Œå…¶ä»–ç”¨ OOP</td></tr><tr><td><strong>ç§»åŠ¨ç«¯æ¸¸æˆ</strong></td><td>ECSï¼ˆå¦‚éœ€å¤§é‡å®ä½“ï¼‰</td><td>èµ„æºå—é™</td></tr></tbody></table><hr/><h2>å‚è€ƒèµ„æ–™</h2><h3>ç†è®ºæ–‡ç« </h3><ol><li><a href="https://link.segmentfault.com/?enc=zotnwYWaYkd5YYrPH181LA%3D%3D.XfV0PNjJw5vHB%2FBdXr1avLl0yxWA8oIWED%2FPkEZRZa9zuwY%2BRAIth8Xr6HVFKHF08%2Fqt7TKrcGV72iXGWQTogQ%3D%3D" rel="nofollow" target="_blank">Entity Component System - Wikipedia</a></li><li><a href="https://link.segmentfault.com/?enc=LUMu8%2BLo5wH7rwzVVlTPTA%3D%3D.EpHKXgWm0%2BF1r%2FPP4ubvpXCqcx1n54jHQdhE0KOYgQpBDLuZAITxuNMoveoMMqAISufQQBT0njgL7TFtD2Ks%2BQ%3D%3D" rel="nofollow" target="_blank">Data-Oriented Design - Games from Within</a></li><li><a href="https://link.segmentfault.com/?enc=ugF7qya39wVZtCP%2FSCgP1Q%3D%3D.OvPEujb%2BVLiCKNhKq9Cb1aX3gSiOwuOZFPnAY%2F9kWi2ZqQGCIvzNefTbs2rTAaDh" rel="nofollow" target="_blank">ECS FAQ - GitHub</a></li><li><a href="https://link.segmentfault.com/?enc=PhZlF9NBWG%2FfZn1%2BwRLGhw%3D%3D.fmboI5k1CkyCRZ39XhuWPXusC2OpGNfNYxVwcA%2FhFXdsq6HhHuLRuEuMAkX6ycpm" rel="nofollow" target="_blank">ECS vs OOP | flamendless</a></li></ol><h3>æ€§èƒ½åˆ†æ</h3><ol start="5"><li><a href="https://gist.github.com/Dreaming381/89d65f81b9b430ffead443a2d430defc" target="_blank">Your ECS Probably Still Sucks: Part 1 â€“ Memory Matters</a></li><li><a href="https://link.segmentfault.com/?enc=tQGgZsFsMEElsd4L2U9LPA%3D%3D.btGNuoqbEIT2GKlsgySw3paEYf6lOX2%2BtbBk5AfMucE3zCP59npphKVbnagYjUnPBYXR6Lcn%2FFfDmhRXPyD8QyCHBy%2BuaeShjdKXD33SR6kaKBf%2BOFIh%2B5CYvq8hQbmi%2Bhw3d7i8oNdU6cA432UEJg%3D%3D" rel="nofollow" target="_blank">The L1 and L2 CPU cache - Understanding ECS</a></li><li><a href="https://link.segmentfault.com/?enc=DQ94pmyPIWsZ8Lr7VrpKRw%3D%3D.%2F8BqAX5SbViQWal2rvXEb3kBUmBCpTEz4EnVbC5eFh8aiQsOlgVNuFh8MC%2Fk2V2EKemAeuqVSOcTjmMvfh7IlMEH7nP4Peeau6B2pML8xiiUTGk1fV7K6bLLRYqU6e4vMw5WdL9ZTT%2FvCGyhj1uoAQ7N9ze6eg53CvHkVP2tBgQ%3D" rel="nofollow" target="_blank">ECS 2.0 and Data-Oriented Architectures</a></li></ol><h3>å®ç°æ•™ç¨‹</h3><ol start="8"><li><a href="https://link.segmentfault.com/?enc=%2FtECDVDXCwhVzeUicMTwNQ%3D%3D.ou%2F4iKXha8DjQCQP4uGYiBbaxuvUxqKf4XerXtExkwOhhIE0InU9sxIh5PsachicP3uSrez0mYVRQkCaPxLoYZ8oxqgPW3s78qrvnJiHwA2hVVa04vzEJ4YeFOf5YWJBdtM2pJgyDxwQUci9GE98cQ%3D%3D" rel="nofollow" target="_blank">Entity Component System Complete Tutorial 2025</a></li><li><a href="https://link.segmentfault.com/?enc=xDQ%2Fan%2BZ1jhnoS2bE3X57Q%3D%3D.E6iimGFnGOm01dX7CEM3Zs8JFipEMXE7ojV8Nu%2Fr%2BxUELdqacMXxJdJ%2BXNg4CZ%2BhJ0Sm4e8v6nz%2BGqor%2FUIOunbixwNT22jSyENt2My9JZg%3D" rel="nofollow" target="_blank">Unity DOTS å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://link.segmentfault.com/?enc=KPUQm2YqKhyYxPEbY3Hd1A%3D%3D.OGyex%2BLWkfsLVixqy691GongH19fT3zsesiACnem4HEp%2FmzRYzIIotieIwBK3kf1" rel="nofollow" target="_blank">Unreal Mass Framework</a></li></ol><h3>ä¸­æ–‡èµ„æº</h3><ol start="11"><li><a href="https://link.segmentfault.com/?enc=TlcAa6mIyFXorRW08FUNnQ%3D%3D.QPkiTonQKoEzf8qMlLm76PAezKwKS5cmr1MvCJ3ehgamDifpQdje8iOZKvOvcUKu" rel="nofollow" target="_blank">æ¸¸æˆå¼€å‘ä¸­çš„ ECS æ¶æ„æ¦‚è¿° - çŸ¥ä¹</a></li><li><a href="https://link.segmentfault.com/?enc=eMxVNz4UkOdpVucyL2uytA%3D%3D.3%2FQXEBcy3v5SpZXShEE%2BOg%2F%2BJVmSADIOX1KohIU%2F9NFZtX4D91168OIDiUEWBcRbaDq1%2FGLmq2v1sJGGmJIIAA%3D%3D" rel="nofollow" target="_blank">ECS çœŸçš„æ˜¯ã€Œæœªæ¥ä¸»æµã€çš„æ¶æ„å—ï¼Ÿ - çŸ¥ä¹</a></li><li><a href="https://link.segmentfault.com/?enc=Tu%2BXqLBE%2B5tmSov74eKa8A%3D%3D.MmmzWVLy3ydQRIi9CCb6td9or0ybRbDJ3g%2BgcxYcFraFmDAnJ09AWD4a0zs7UECKq%2BS%2FZFPD6oLfQTd9nDXkrA%3D%3D" rel="nofollow" target="_blank">ECS æ¶æ„åœ¨æ¸¸æˆå¼€å‘ä¸­çš„å®è·µåº”ç”¨ - CSDN</a></li></ol><h3>Rust ECS èµ„æº</h3><ol start="14"><li><a href="https://link.segmentfault.com/?enc=m%2Bahs1rLkWc0PbSngo33Lg%3D%3D.w%2BxSTz%2FKh1SVYGbI9YvnanKEW%2Bn9G%2FjVW72sWwkZbB8%3D" rel="nofollow" target="_blank">Bevy å®˜æ–¹æ•™ç¨‹</a></li><li><a href="https://link.segmentfault.com/?enc=SR713%2FJm0Y7JEjtiAeP1bQ%3D%3D.yixjXqPkRKggmIbqnlTsbXF%2FZwxyJ1%2Frqgu3mYxsjCgFpJKC2ITpqQ%2FozefJ81kj" rel="nofollow" target="_blank">Bevy Cheat Book</a></li><li><a href="https://link.segmentfault.com/?enc=StnQFitsWNq59BujybmFXQ%3D%3D.0xrDhet6rivfy602mpYK7k45JPnt5AnSPw5s8w3H5USPSI5wXsV2%2BXIRduAEqyfK" rel="nofollow" target="_blank">specs - å¦ä¸€ä¸ª Rust ECS åº“</a></li><li><a href="https://link.segmentfault.com/?enc=xETVAGGnm8RZtKsxrki3cg%3D%3D.WyseXQdLvp0Tuqtbt5lO5wKjvnk%2Bs7jteZcZvhzSFz0%3D" rel="nofollow" target="_blank">hecs - è½»é‡çº§ ECS</a></li></ol><hr/><h2>ç»“è¯­</h2><p>ECS ä»£è¡¨äº†æ¸¸æˆå¼€å‘ä»"å¯¹è±¡å¯¼å‘"åˆ°"æ•°æ®å¯¼å‘"çš„èŒƒå¼è½¬å˜ã€‚å®ƒä¸æ˜¯è¦å–ä»£ OOPï¼Œè€Œæ˜¯åœ¨ç‰¹å®šåœºæ™¯ä¸‹æä¾›æ›´ä¼˜çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>æ­£å¦‚ Mike Actonï¼ˆUnity DOTS é¦–å¸­æ¶æ„å¸ˆï¼‰æ‰€è¯´ï¼š</p><blockquote><strong>"ä»£ç çš„ç›®çš„æ˜¯è½¬æ¢æ•°æ®ã€‚å¦‚æœä½ ä¸ç†è§£æ•°æ®ï¼Œä½ å°±ä¸ç†è§£é—®é¢˜ã€‚"</strong></blockquote><p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ ç†è§£ ECS çš„æœ¬è´¨ï¼Œå¹¶åœ¨åˆé€‚çš„æ—¶å€™åšå‡ºæ­£ç¡®çš„æ¶æ„é€‰æ‹©ã€‚</p>]]></description></item><item>    <title><![CDATA[é¸¿è’™ Car Kit å®æˆ˜ï¼šæ‰“é€ æƒŠè‰³è½¦è½½éŸ³ä¹ä½“éªŒ çµèŠ¸å°éª ]]></title>    <link>https://segmentfault.com/a/1190000047585843</link>    <guid>https://segmentfault.com/a/1190000047585843</guid>    <pubDate>2026-02-01 18:02:48</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>å¼•è¨€</h2><p>åœ¨æ™ºèƒ½å‡ºè¡Œé£é€Ÿå‘å±•çš„å½“ä¸‹ï¼Œè½¦è½½å¨±ä¹ç³»ç»Ÿå·²æˆä¸ºé©¾é©¶è€…å’Œä¹˜å®¢æ—…é€”ä¸­ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ï¼Œå…¶ä¸­éŸ³ä¹åº”ç”¨æ›´æ˜¯å¤‡å—é’çã€‚é¸¿è’™ Car Kit ä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„å·¥å…·ï¼ŒåŠ©åŠ›æ‰“é€ åŠŸèƒ½ä¸°å¯Œã€ä½“éªŒå“è¶Šçš„è½¦è½½éŸ³ä¹åº”ç”¨ã€‚æœ¬æ–‡å°†é€šè¿‡çœŸå®ä¸šåŠ¡åœºæ™¯è®¾è®¡ï¼Œæ·±å…¥å‰–æéœ€æ±‚å¼€å‘é€»è¾‘ï¼Œå¹¶ç»™å‡ºå…³é”®ä»£ç å®ç°ï¼Œæ—¨åœ¨ä¸ºé¸¿è’™è½¦è½½åº”ç”¨å¼€å‘è€…æä¾›æå…·ä»·å€¼çš„å®è·µæŒ‡å¯¼ï¼Œä¸€åŒæ¢ç´¢å¦‚ä½•åŸºäºé¸¿è’™ Car Kit æ„å»ºä»¤äººçœ¼å‰ä¸€äº®çš„æ™ºèƒ½è½¦è½½éŸ³ä¹åº”ç”¨ã€‚</p><h2>ä¸€ã€ä¸šåŠ¡åœºæ™¯è®¾è®¡</h2><p>åœ¨æ—¥å¸¸å‡ºè¡Œä¸­ï¼Œé©¾é©¶è€…å¯¹äºè½¦è½½éŸ³ä¹å¨±ä¹çš„éœ€æ±‚è¶Šå‘å¤šæ ·åŒ–ã€‚æƒ³è±¡ä¸€ä½èŒåœºäººå£«åœ¨ç»“æŸå¿™ç¢Œå·¥ä½œåé©¾è½¦å›å®¶ï¼Œä»–æœŸæœ›åœ¨è¡Œè½¦è¿‡ç¨‹ä¸­è½»æ¾ç•…äº«å–œçˆ±çš„éŸ³ä¹ï¼Œå¹¶ä¸”éŸ³ä¹èƒ½ä¾æ®ä¸åŒé©¾é©¶åœºæ™¯æ™ºèƒ½åˆ‡æ¢ï¼Œä¾‹å¦‚é«˜é€Ÿè¡Œé©¶æ—¶æ’­æ”¾èŠ‚å¥æ˜å¿«çš„æ›²ç›®ï¼Œå¸‚åŒºæ‹¥å µæ—¶æ’­æ”¾èˆ’ç¼“çš„è½»éŸ³ä¹ï¼Œè®©é©¾é©¶è¿‡ç¨‹æ›´åŠ æƒ¬æ„ã€‚æ­¤å¤–ï¼Œå½“è½¦è¾†ä¸æ‰‹æœºé€šè¿‡é¸¿è’™åˆ†å¸ƒå¼èƒ½åŠ›è¿æ¥åï¼Œèƒ½è‡ªåŠ¨åŒæ­¥æ‰‹æœºéŸ³ä¹æ”¶è—ï¼Œé¿å…ç¹çæ‰‹åŠ¨æ“ä½œã€‚åŒæ—¶ï¼Œä¹˜å®¢ä¹Ÿå¯é€šè¿‡è½¦å†…å¤§å±ä¾¿æ·æœç´¢æƒ³å¬çš„æ­Œæ›²ï¼Œæå‡ä¹˜è½¦ä½“éªŒã€‚</p><h2>äºŒã€éœ€æ±‚å¼€å‘é€»è¾‘</h2><h3>ï¼ˆä¸€ï¼‰åŸºæœ¬éŸ³ä¹æ’­æ”¾åŠŸèƒ½</h3><ol><li><strong>æ­Œæ›²åˆ—è¡¨å±•ç¤º</strong>ï¼šä»æœ¬åœ°å­˜å‚¨æˆ–åœ¨çº¿éŸ³ä¹å¹³å°è·å–æ­Œæ›²ä¿¡æ¯ï¼Œåœ¨è½¦è½½å¤§å±ä»¥ç®€æ´ç›´è§‚æ–¹å¼å‘ˆç°ï¼Œæ–¹ä¾¿ç”¨æˆ·æµè§ˆé€‰æ‹©ã€‚</li><li><strong>æ’­æ”¾æ§åˆ¶</strong>ï¼šå®ç°æ’­æ”¾ã€æš‚åœã€ä¸Šä¸€æ›²ã€ä¸‹ä¸€æ›²ç­‰å¸¸ç”¨æ§åˆ¶åŠŸèƒ½ï¼Œæ“ä½œæŒ‰é’®è®¾è®¡éœ€ç¬¦åˆé©¾é©¶åœºæ™¯ä¸‹çš„æ“ä½œä¾¿åˆ©æ€§ï¼Œç¡®ä¿é©¾é©¶è€…æ— éœ€åˆ†æ•£è¿‡å¤šæ³¨æ„åŠ›ã€‚</li></ol><h3>ï¼ˆäºŒï¼‰æ™ºèƒ½åœºæ™¯é€‚é…</h3><ol><li><strong>åœºæ™¯æ„ŸçŸ¥</strong>ï¼šå€ŸåŠ©è½¦è½½ä¼ æ„Ÿå™¨ï¼ˆå¦‚è½¦é€Ÿä¼ æ„Ÿå™¨ï¼‰å®æ—¶è·å–è½¦è¾†è¡Œé©¶çŠ¶æ€ï¼Œç²¾å‡†åˆ¤æ–­è½¦è¾†å¤„äºé«˜é€Ÿè¡Œé©¶ã€å¸‚åŒºæ‹¥å µè¿˜æ˜¯åœè½¦çŠ¶æ€ã€‚</li><li><strong>éŸ³ä¹æ™ºèƒ½åˆ‡æ¢</strong>ï¼šä¾æ®ä¸åŒé©¾é©¶åœºæ™¯ï¼Œè‡ªåŠ¨åŒ¹é…é€‚åˆçš„éŸ³ä¹ç±»å‹ï¼Œä¸ºç”¨æˆ·è¥é€ æ›´å¥‘åˆå½“ä¸‹æƒ…å¢ƒçš„éŸ³ä¹æ°›å›´ã€‚</li></ol><h3>ï¼ˆä¸‰ï¼‰åˆ†å¸ƒå¼ååŒ</h3><ol><li><strong>è®¾å¤‡è¿æ¥æ£€æµ‹</strong>ï¼šå®æ—¶ç›‘æµ‹è½¦è¾†ä¸æ‰‹æœºç­‰è®¾å¤‡çš„è¿æ¥çŠ¶æ€ï¼Œä¸€æ—¦æ£€æµ‹åˆ°è¿æ¥ï¼Œè¿…é€Ÿè§¦å‘åç»­åŒæ­¥æ“ä½œã€‚</li><li><strong>æ•°æ®åŒæ­¥</strong>ï¼šå°†æ‰‹æœºä¸­çš„éŸ³ä¹æ”¶è—åˆ—è¡¨æ— ç¼åŒæ­¥è‡³è½¦è½½éŸ³ä¹åº”ç”¨ï¼Œè®©ç”¨æˆ·åœ¨è½¦å†…ä¹Ÿèƒ½ä¾¿æ·è®¿é—®æ‰‹æœºç«¯çš„ä¸ªæ€§åŒ–éŸ³ä¹èµ„æºã€‚</li></ol><h3>ï¼ˆå››ï¼‰æœç´¢åŠŸèƒ½</h3><ol><li><strong>æœç´¢æ¡†è®¾è®¡</strong>ï¼šåœ¨å¤§å±ç•Œé¢æ˜¾è‘—ä½ç½®è®¾ç½®æœç´¢æ¡†ï¼Œæ–¹ä¾¿ä¹˜å®¢å¿«é€Ÿå®šä½è¾“å…¥å…³é”®è¯ã€‚</li><li><strong>æœç´¢é€»è¾‘</strong>ï¼šæ”¯æŒæŒ‰æ­Œæ›²åã€æ­Œæ‰‹åç­‰å¤šç»´åº¦å…³é”®è¯æœç´¢ï¼Œä»æœ¬åœ°å’Œåœ¨çº¿éŸ³ä¹åº“å…¨é¢åŒ¹é…ç›¸å…³æ­Œæ›²ï¼Œæ»¡è¶³ç”¨æˆ·å¤šæ ·åŒ–æœç´¢éœ€æ±‚ã€‚</li></ol><h2>ä¸‰ã€å…³é”®ä»£ç å®ç°</h2><h3>ï¼ˆä¸€ï¼‰åŸºæœ¬éŸ³ä¹æ’­æ”¾åŠŸèƒ½</h3><p>ä½¿ç”¨é¸¿è’™çš„åª’ä½“æ’­æ”¾ API å®ç°åŸºæœ¬éŸ³ä¹æ’­æ”¾åŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯åŸºäº ArkTS çš„ç¤ºä¾‹ä»£ç ï¼š</p><pre><code class="ts">// å¼•å…¥åª’ä½“æ’­æ”¾æ¨¡å—
import media from '@ohos.multimedia.media';

// æ­Œæ›²åˆ—è¡¨æ•°æ®
let songList: Array&lt;{ title: string, artist: string, url: string }&gt; = [];
// å½“å‰æ’­æ”¾æ­Œæ›²ç´¢å¼•
let currentIndex: number = 0;

// åˆ›å»ºåª’ä½“æ’­æ”¾å™¨
let player: media.Player | null = null;

async function createPlayer() {
    if (player) {
        await player.destroy();
    }
    player = await media.createPlayer({
        source: songList[currentIndex].url,
        type: media.ContentType.MUSIC
    });
}

async function play() {
    if (!player) {
        await createPlayer();
    }
    await player.start();
}

async function pause() {
    if (player) {
        await player.pause();
    }
}

async function next() {
    if (currentIndex &lt; songList.length - 1) {
        currentIndex++;
        await createPlayer();
        await play();
    }
}

async function previous() {
    if (currentIndex &gt; 0) {
        currentIndex--;
        await createPlayer();
        await play();
    }
}</code></pre><h3>ï¼ˆäºŒï¼‰æ™ºèƒ½åœºæ™¯é€‚é…</h3><p>é€šè¿‡è®¢é˜…è½¦é€Ÿä¼ æ„Ÿå™¨æ•°æ®æ¥å®ç°åœºæ™¯æ„ŸçŸ¥ï¼Œå¹¶æ ¹æ®åœºæ™¯åˆ‡æ¢éŸ³ä¹ã€‚</p><pre><code class="ts">import sensor from '@ohos.sensor';

// è®¢é˜…è½¦é€Ÿä¼ æ„Ÿå™¨
let speedSensor: sensor.Sensor | null = null;
let subscription: sensor.SensorSubscription | null = null;

async function subscribeSpeedSensor() {
    speedSensor = await sensor.getDefaultSensor(sensor.SensorType.SPEED);
    subscription = await speedSensor.subscribe((data) =&gt; {
        let speed = data.speed;
        if (speed &gt; 80) {
            // é«˜é€Ÿè¡Œé©¶ï¼Œåˆ‡æ¢åˆ°èŠ‚å¥æ˜å¿«çš„éŸ³ä¹
            switchMusic('fast - paced');
        } else if (speed &gt; 0 &amp;&amp; speed &lt;= 30) {
            // å¸‚åŒºæ‹¥å µï¼Œåˆ‡æ¢åˆ°èˆ’ç¼“éŸ³ä¹
            switchMusic('relaxing');
        }
    });
}

function switchMusic(type: string) {
    // æ ¹æ®éŸ³ä¹ç±»å‹ç­›é€‰æ­Œæ›²åˆ—è¡¨å¹¶æ’­æ”¾
    let filteredList = songList.filter(song =&gt; song.type === type);
    if (filteredList.length &gt; 0) {
        currentIndex = songList.indexOf(filteredList[0]);
        createPlayer().then(() =&gt; play());
    }
}</code></pre><h3>ï¼ˆä¸‰ï¼‰åˆ†å¸ƒå¼ååŒ</h3><p>åˆ©ç”¨é¸¿è’™çš„åˆ†å¸ƒå¼è½¯æ€»çº¿å’Œæ•°æ®ç®¡ç†èƒ½åŠ›å®ç°è®¾å¤‡è¿æ¥æ£€æµ‹ä¸æ•°æ®åŒæ­¥ã€‚</p><pre><code class="ts">import distributedData from '@ohos.distributedData';

// æ£€æµ‹è®¾å¤‡è¿æ¥çŠ¶æ€
let connectionState: string = 'disconnected';

function checkDeviceConnection() {
    // è¿™é‡Œé€šè¿‡é¸¿è’™ç³»ç»Ÿæä¾›çš„ API è·å–è®¾å¤‡è¿æ¥çŠ¶æ€ï¼Œç¤ºä¾‹ä»£ç ç®€åŒ–å¤„ç†
    connectionState = 'connected'; // å‡è®¾è¿æ¥æˆåŠŸ
    if (connectionState === 'connected') {
        syncMusicData();
    }
}

async function syncMusicData() {
    try {
        let dataAbilityHelper = distributedData.createDistributedDataAbilityHelper('com.example.music.dataability');
        let result = await dataAbilityHelper.query('userMusicCollection', null, null);
        if (result) {
            let musicList = result.getArray('musicList');
            songList = musicList;
        }
    } catch (error) {
        console.error('åŒæ­¥éŸ³ä¹æ•°æ®å¤±è´¥:', error);
    }
}</code></pre><h3>ï¼ˆå››ï¼‰æœç´¢åŠŸèƒ½</h3><p>å®ç°æœç´¢æ¡†çš„äº¤äº’é€»è¾‘å’Œæœç´¢åŠŸèƒ½ã€‚</p><pre><code class="ts">// æœç´¢å…³é”®è¯
let searchKeyword: string = '';

function handleSearch() {
    let searchResult = songList.filter(song =&gt; 
        song.title.includes(searchKeyword) || song.artist.includes(searchKeyword));
    // å°†æœç´¢ç»“æœå±•ç¤ºåœ¨ç•Œé¢ä¸Š
    // è¿™é‡Œçœç•¥ç•Œé¢å±•ç¤ºç›¸å…³ä»£ç 
}</code></pre><h2>å››ã€æŠ€æœ¯æ€»ç»“</h2><ol><li><strong>åª’ä½“æ’­æ”¾</strong>ï¼šé¸¿è’™æä¾›çš„ <code>@ohos.multimedia.media</code> æ¨¡å—ä¸ºéŸ³ä¹æ’­æ”¾åŠŸèƒ½å®ç°æä¾›äº†å¼ºå¤§æ”¯æŒã€‚é€šè¿‡ <code>createPlayer</code> æ–¹æ³•åˆ›å»ºæ’­æ”¾å™¨å®ä¾‹ï¼Œå¹¶å¯¹å…¶è¿›è¡Œçµæ´»æ§åˆ¶ï¼Œå¼€å‘è€…èƒ½å¤Ÿè½»æ¾å®ç°åŸºæœ¬éŸ³ä¹æ’­æ”¾æ“ä½œã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€æ³¨æ„èµ„æºç®¡ç†ï¼Œå¦‚æ’­æ”¾å™¨é”€æ¯ä¸é‡å»ºï¼Œé¿å…å†…å­˜æ³„æ¼ç­‰é—®é¢˜ã€‚</li><li><strong>ä¼ æ„Ÿå™¨åº”ç”¨</strong>ï¼šåˆ©ç”¨ <code>@ohos.sensor</code> æ¨¡å—è®¢é˜…è½¦é€Ÿä¼ æ„Ÿå™¨æ•°æ®ï¼Œä½¿åº”ç”¨èƒ½å¤Ÿæ„ŸçŸ¥é©¾é©¶åœºæ™¯å˜åŒ–ã€‚ä¼ æ„Ÿå™¨æ•°æ®çš„å®æ—¶è·å–ä¸å‡†ç¡®å¤„ç†æ˜¯å®ç°æ™ºèƒ½åœºæ™¯é€‚é…çš„å…³é”®ã€‚å¼€å‘è€…éœ€å…³æ³¨ä¼ æ„Ÿå™¨æ•°æ®çš„ç²¾åº¦å’Œç¨³å®šæ€§ï¼Œä»¥åŠæ•°æ®å¤„ç†è¿‡ç¨‹ä¸­çš„å¼‚å¸¸æƒ…å†µå¤„ç†ï¼Œç¡®ä¿åº”ç”¨åœ¨ä¸åŒé©¾é©¶åœºæ™¯ä¸‹ç¨³å®šè¿è¡Œã€‚</li><li><strong>åˆ†å¸ƒå¼ååŒ</strong>ï¼šé¸¿è’™åˆ†å¸ƒå¼è½¯æ€»çº¿å’Œæ•°æ®ç®¡ç†èƒ½åŠ›ï¼Œå³ <code>@ohos.distributedData</code> æ¨¡å—ï¼Œè®©è®¾å¤‡é—´æ•°æ®åŒæ­¥å˜å¾—é«˜æ•ˆä¾¿æ·ã€‚åœ¨å®ç°åˆ†å¸ƒå¼ååŒåŠŸèƒ½æ—¶ï¼Œè¦é‡è§†æ•°æ®å®‰å…¨ä¸éšç§ä¿æŠ¤ï¼Œç¡®ä¿åœ¨è®¾å¤‡è¿æ¥å’Œæ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ç”¨æˆ·æ•°æ®çš„å®Œæ•´æ€§ä¸ä¿å¯†æ€§ã€‚åŒæ—¶ï¼Œéœ€å¤„ç†å¥½ä¸åŒè®¾å¤‡é—´çš„å…¼å®¹æ€§é—®é¢˜ï¼Œä¿éšœåŠŸèƒ½åœ¨å„ç§è®¾å¤‡ä¸Šç¨³å®šè¿è¡Œã€‚</li><li><strong>æœç´¢åŠŸèƒ½å®ç°</strong>ï¼šæœç´¢åŠŸèƒ½é€šè¿‡ç®€å•çš„æ•°ç»„è¿‡æ»¤æ“ä½œå®ç°ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéšç€éŸ³ä¹åº“è§„æ¨¡å¢å¤§ï¼Œå¯è€ƒè™‘å¼•å…¥æ›´é«˜æ•ˆçš„æœç´¢ç®—æ³•ï¼Œå¦‚æ¨¡ç³Šæœç´¢ã€ç´¢å¼•æŠ€æœ¯ç­‰ï¼Œæå‡æœç´¢æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚æ­¤å¤–ï¼Œæœç´¢ç»“æœçš„å±•ç¤ºå’Œäº¤äº’è®¾è®¡ä¹Ÿè‡³å…³é‡è¦ï¼Œç›´æ¥å½±å“ç”¨æˆ·ä½“éªŒã€‚</li></ol><p>åŸºäºé¸¿è’™ Car Kit å¼€å‘æ™ºèƒ½è½¦è½½éŸ³ä¹åº”ç”¨ï¼Œå¼€å‘è€…éœ€æ·±å…¥ç†è§£å’Œè¿ç”¨é¸¿è’™æä¾›çš„å„ç±»æŠ€æœ¯ä¸ APIï¼Œå……åˆ†ç»“åˆè½¦è½½åœºæ™¯ç‰¹ç‚¹ï¼Œæ³¨é‡ç”¨æˆ·ä½“éªŒå’ŒåŠŸèƒ½ç¨³å®šæ€§ã€‚é€šè¿‡ä¸æ–­ä¼˜åŒ–ä¸åˆ›æ–°ï¼Œä¸ºç”¨æˆ·å¸¦æ¥æ›´åŠ ä¼˜è´¨ã€æ™ºèƒ½çš„è½¦è½½éŸ³ä¹å¨±ä¹ä½“éªŒã€‚</p>]]></description></item><item>    <title><![CDATA[è“æ˜“äº‘cdn:å°UDPå°æµ·å¤–çš„é«˜é˜²äº‘æœåŠ¡å™¨å¦‚ä½•é€‰æ‹©? è“æ˜“äº‘ ]]></title>    <link>https://segmentfault.com/a/1190000047585901</link>    <guid>https://segmentfault.com/a/1190000047585901</guid>    <pubDate>2026-02-01 18:02:18</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>æˆ‘å…ˆæŠŠè¯è¯´é€ï¼šæ‰€è°“â€œ&lt;span style="color:#ff0000;"&gt;å°UDP&lt;/span&gt; / &lt;span style="color:#ff0000;"&gt;å°æµ·å¤–&lt;/span&gt;â€å¾ˆå¤šæ—¶å€™æ˜¯æœåŠ¡å•†åœ¨å‹åŠ›ä¸‹çš„<strong>ç²—æš´æ­¢è¡€ç­–ç•¥</strong>â€”â€”èƒ½æ•‘ç«ï¼Œä½†ä¼šä¼¤ä¸šåŠ¡ï¼ˆå°¤å…¶æ˜¯ä½ è¦ &lt;span style="color:#ff0000;"&gt;HTTP/3&lt;/span&gt;ã€æ¸¸æˆã€è¯­éŸ³ã€DNSã€QUIC ç­‰åœºæ™¯ï¼‰ã€‚HTTP/3 èµ° QUICï¼Œè€Œ QUIC æ˜¯åŸºäº UDP çš„ã€‚(<a href="https://link.segmentfault.com/?enc=evg15w46ynOxoMdhcu1uWw%3D%3D.vvST9%2BVxExJxj8XygzpXK1kOMe8urARsLpjynrpJVKBiQMV%2FUrCDuD74GAoIJEMfrputECS%2Fm%2FzlpI2g3%2FGEWYtF3WR%2BAdbEO2j%2F6KCowmk%3D" rel="nofollow" target="_blank">ç»´åŸºç™¾ç§‘</a>)</p><h2>é€‰å‹æ ¸å¿ƒç»“è®ºï¼ˆç»™ä½ å¯è½åœ°çš„åˆ¤æ–­ï¼‰</h2><ul><li>ä½ è¦çš„æ˜¯ï¼š<strong>&lt;span style="color:#ff0000;"&gt;â€œç²¾ç»†åŒ–æ¸…æ´— + å¯è§‚æµ‹ + å¯æ§æ”¾è¡Œâ€&lt;/span&gt;</strong>ï¼Œè€Œä¸æ˜¯â€œä¸€åˆ€åˆ‡å°ç¦â€ã€‚è¶…å¤§æµé‡æ”»å‡»è¿‘å¹´æŒç»­åˆ·æ–°çºªå½•ï¼Œä¸”å¸¸è§ä¸º UDP æ´ªæ³›/æ”¾å¤§ç±»ï¼Œé€‰å‹å¿…é¡»æŒ‰â€œé•¿æœŸå¯¹æŠ—â€è®¾è®¡ã€‚(<a href="https://link.segmentfault.com/?enc=WDZ2wyU66O1gy28JGNkm8A%3D%3D.Bmneq4Wd8oGYSHQDZ6e5tLZJZD5FCb2dfvYq6I8dr7RIXQvyOw1r5hoVdVqBx39aa3BaUql3hDCsamfhu3QESowxCcUzQzyVId14AEUFq%2BZ%2F65e7gQwBNOIY%2BiMUBViLyVTwwrnhsqzuW4pFKUdSjvr5dcgkp5VM%2Fg%2FCYv6bXo0RO%2B7%2Fp0Ad6MKCN9K%2BR6bA4ArYvKbdcQjcUI%2Ft0Lug6QAz9zU9O2HFQS7ggzdynd44jWuRoK61lYUz%2FGt0U%2FIA" rel="nofollow" target="_blank">BleepingComputer</a>)</li><li>ä¼˜å…ˆæŒ‘ï¼šæœ‰ <strong>&lt;span style="color:#ff0000;"&gt;æ¸…æ´—ä¸­å¿ƒ&lt;/span&gt; + &lt;span style="color:#ff0000;"&gt;Anycast/å¤šç‚¹è°ƒåº¦&lt;/span&gt;</strong> çš„é˜²æŠ¤ç½‘ç»œï¼ŒæŠŠæ”»å‡»åˆ†æ‘Šåˆ°å¤šä¸ªç‚¹ä½ï¼Œè€Œä¸æ˜¯æŠŠä½ é‚£å°æœºå™¨å½“æ²™åŒ…ã€‚(<a href="https://link.segmentfault.com/?enc=V1mlTKu9ciSsNY7NcUtPGA%3D%3D.Uxp%2FZBg1Q407cr1puJlvC4RkTI4Hjpe8d%2BkH3fZjRfENYTCyJ4TQsMPxvBTdEQ0jVaoLdEtgrCZ7%2FNXsns3cdbeuLWPzdgDv%2BZpdJO%2B7d2GTJHkpWY87llDbSTA8xsDVL689fHHrvQavmchao6xLJaqcwuD6%2FIfNqFjgW3E99uzNfFmG8Qnz2kWUp407UTMA" rel="nofollow" target="_blank">Radware</a>)</li><li>éœ€è¦â€œå°â€çš„ï¼Œä¹Ÿè¦åšåˆ°ï¼š<strong>&lt;span style="color:#ff0000;"&gt;åªå°ä¸è¯¥æ¥çš„&lt;/span&gt;</strong>ï¼ˆæŒ‰ç«¯å£/åè®®/é€Ÿç‡/æŒ‡çº¹/å›½å®¶åœ°åŒºç­–ç•¥åˆ†å±‚ï¼‰ï¼Œå¹¶èƒ½ä¸€é”®å›æ»šï¼Œé¿å…è¯¯ä¼¤ KPIã€‚</li></ul><h2>åˆ†æè¯´æ˜è¡¨ï¼ˆä½ æ‹¿å®ƒå»å¯¹æ¯”æœåŠ¡å•†å°±å¤Ÿäº†ï¼‰</h2><table><thead><tr><th>æ–¹æ¡ˆå–å‘</th><th>é˜²æŠ¤åŠ¨ä½œ</th><th>å¯¹ä¸šåŠ¡å½±å“</th><th>é€‚ç”¨åœºæ™¯</th><th>é£é™©ç‚¹</th></tr></thead><tbody><tr><td>â€œå°UDP/å°æµ·å¤–â€ç¡¬åˆ‡</td><td>ç›´æ¥ä¸¢å¼ƒ UDP æˆ–æµ·å¤–æµé‡</td><td>é«˜ï¼šHTTP/3ã€æ¸¸æˆ/è¯­éŸ³ã€æµ·å¤–ç”¨æˆ·ç›´æ¥å—æŸ</td><td>ä¸´æ—¶æ­¢è¡€ã€ä¸šåŠ¡åªåœ¨å•ä¸€åŒºåŸŸä¸”ä¸ç”¨UDP</td><td>è¯¯ä¼¤å¤§ã€ä½“éªŒå·®ã€å¯æŒç»­æ€§å¼±</td></tr><tr><td>ç²¾ç»†åŒ–æ¸…æ´—ï¼ˆæ¨èï¼‰</td><td>è¯†åˆ«åæ¸…æ´—ï¼šæŒ‰ç«¯å£/åè®®/é€Ÿç‡/ç‰¹å¾è¿‡æ»¤</td><td>ä½ï¼šä¸šåŠ¡å¯æŒç»­è¿è¡Œ</td><td>é•¿æœŸè¿è¥ã€å¯¹å¤–ä¸šåŠ¡ã€éœ€è¦UDP/å…¨çƒè®¿é—®</td><td>è¦æ±‚æœåŠ¡å•†èƒ½åŠ›å¼ºã€é…ç½®è¦ä¸“ä¸š</td></tr><tr><td>â€œå‰ç½®CDN/è¾¹ç¼˜æŠ—å‹ + æºç«™é«˜é˜²â€ç»„åˆï¼ˆæ¨èï¼‰</td><td>å‹åŠ›åœ¨è¾¹ç¼˜æ¶ˆåŒ–ï¼Œæºç«™ä»…æ¥æ”¶å¹²å‡€æµé‡</td><td>æœ€ä½ï¼šæºç«™æ›´ç¨³ï¼ŒTCOæ›´å¯æ§</td><td>ç½‘ç«™/API/ç”µå•†/å†…å®¹ç«™</td><td>éœ€è¦å®Œå–„å›æºä¸ç°åº¦ç­–ç•¥</td></tr></tbody></table><h2>ä½ è¯¥ç›¯æ­»çš„ 8 ä¸ªç¡¬æŒ‡æ ‡ï¼ˆåƒåšä¾›åº”å•†å°½è°ƒä¸€æ ·åšï¼‰</h2><ol><li><strong>&lt;span style="color:#ff0000;"&gt;æ˜¯å¦æ”¯æŒUDPâ€œå¯é˜²å¯æ”¾â€&lt;/span&gt;</strong>ï¼šèƒ½ä¸èƒ½æŒ‰ç«¯å£æ”¾è¡Œï¼ˆå¦‚ 53/123/443-QUIC/æ¸¸æˆç«¯å£ï¼‰ï¼Œè€Œä¸æ˜¯ä¸€å°äº†ä¹‹ã€‚</li><li><strong>&lt;span style="color:#ff0000;"&gt;æ¸…æ´—æ¨¡å¼&lt;/span&gt;</strong>ï¼šå¸¸æ€åœ¨çº¿ï¼ˆalways-onï¼‰è¿˜æ˜¯è§¦å‘å¼ï¼ˆon-demandï¼‰ï¼Ÿè§¦å‘å¼è¦çœ‹â€œè§¦å‘é˜ˆå€¼ + ç”Ÿæ•ˆæ—¶å»¶â€ã€‚</li><li><strong>&lt;span style="color:#ff0000;"&gt;æ‰¿è¯ºå£å¾„&lt;/span&gt;</strong>ï¼šé—®æ¸…æ¥šæ˜¯â€œå®£ç§°å³°å€¼â€è¿˜æ˜¯â€œå¯ç”¨æ¸…æ´—å¸¦å®½/åŒ…é€Ÿï¼ˆppsï¼‰ä¸Šé™â€ã€‚çœŸå®ä¸–ç•Œé‡Œå¾ˆå¤šæ”»å‡»æ‹¼çš„æ˜¯ ppsã€‚(<a href="https://link.segmentfault.com/?enc=UK54hBbugBPV77CovBBukQ%3D%3D.9kjzyB33WDNxEP3qFRnL5o3XT7KFhX1287LDUf6pjzqPXXiGm1s2HvKBIRMjATF2N%2FXpaujrtRra%2Fr2zEAeNWRzf%2Bg0KL%2Bkt1zmhDzQkZ2JHYqedEaLu8j2ixb6r5pKPChakX1XTFRovz1fcjmpPF8ZTEiKti%2FoYQd7zqd2eOZKEJOhD5%2B5LIEPOMxK0CZVVIMs7s4DWwgD5BaqtKpDc%2FZsUAtAGj0Rde7wBOorvZSs%3D" rel="nofollow" target="_blank">BleepingComputer</a>)</li><li><strong>&lt;span style="color:#ff0000;"&gt;Anycast/å¤šç‚¹èƒ½åŠ›&lt;/span&gt;</strong>ï¼šç‚¹ä½è¶Šå¤šã€è°ƒåº¦è¶Šæˆç†Ÿï¼Œæ‰©æ•£æ”»å‡»è¶Šç¨³ã€‚(<a href="https://link.segmentfault.com/?enc=N2DEj5604GepeK8cjMAPUg%3D%3D.Ds4Zo%2B5oSSZLbQPvb3TPtTsnOS10xoVwnhPw%2FYSyFb%2Fng1aodnjw%2BdVcBWdxhuS5MFMOl9LSBJOpLjLMdcnCJvRbctjP2AHXzwaBWmk8uy3kYQvZVyznrwQ21iRojLdcOMo6gn8Od%2FmX3CdUH%2B88rr4pcvWBqTuyRySwc63PzkHHZbxW15bSOxijzdGfM3Fb" rel="nofollow" target="_blank">Radware</a>)</li><li><strong>&lt;span style="color:#ff0000;"&gt;å››å±‚ç­–ç•¥é¢—ç²’åº¦&lt;/span&gt;</strong>ï¼šæ˜¯å¦æ”¯æŒâ€œä¼ªæºè¿‡æ»¤/ç©ºè¿æ¥/æºé€Ÿç‡é™åˆ¶/ç›®çš„é™é€Ÿâ€ç­‰ç­–ç•¥ï¼ˆè¿™ç±»èƒ½åŠ›æ˜¯å¯¹æŠ— L4 æ´ªæ³›çš„åŸºæœ¬ç›˜ï¼‰ã€‚(<a href="https://link.segmentfault.com/?enc=nhc2DkREsJQX6MhrlotBdw%3D%3D.Bxcu2bRsKeXaCNVHe9jl7%2Bxkfd2KT4IaGMGfL3Rj8RwKdb9tS3p%2BWgivdVXFn4aoGrrZf3gDhRob2%2FaN2j8U8RHxkSlmjA3%2BxxW0GoWjdqXc0qPhZGS%2F6489dhfdeki8hXNbio9J26%2FcGvrigKElGtPq97dM29PoA274rMPvhf4nWgvxdoz%2Bd1jbfVKiEPALgynUghLCBWLwSZo%2Fhizv605W1IdbFtJqr1ERTDPXYxKmNnltZ0x5gd26Qg%2BCuOwu" rel="nofollow" target="_blank">é˜¿é‡Œäº‘</a>)</li><li><strong>&lt;span style="color:#ff0000;"&gt;å¯è§‚æµ‹æ€§&lt;/span&gt;</strong>ï¼šæœ‰æ²¡æœ‰æ”»å‡»æŠ¥è¡¨ã€æ ·æœ¬åŒ…ã€å‘½ä¸­è§„åˆ™åŸå› ã€å›æ”¾èƒ½åŠ›ï¼›æ²¡æœ‰å¯è§‚æµ‹æ€§=ä½ æ°¸è¿œåœ¨ç›²é£ã€‚</li><li><strong>&lt;span style="color:#ff0000;"&gt;å›æºä¸ç™½åå•æœºåˆ¶&lt;/span&gt;</strong>ï¼šèƒ½å¦åªå…è®¸è¾¹ç¼˜/æ¸…æ´—å‡ºå£å›æºï¼Œæºç«™åªå¯¹â€œå¹²å‡€å…¥å£â€å¼€æ”¾ã€‚</li><li><strong>&lt;span style="color:#ff0000;"&gt;åæ¬ºéª—åŸºç¡€&lt;/span&gt;</strong>ï¼šæœåŠ¡å•†ä¸Šæ¸¸æ˜¯å¦é‡è§†æºåœ°å€æ ¡éªŒï¼ˆSAV/BCP38 æ€è·¯ï¼‰ï¼Œå¦åˆ™åå°„æ”¾å¤§ç±»ä¼šæ›´æ³›æ»¥ã€‚(<a href="https://link.segmentfault.com/?enc=JV0JR5NzfSKWUxkD6WVgRg%3D%3D.Z5oGmmEfdi%2FYerXhXkGTYTb6kNAYsQFZ2oZbTv5NaItSS7XCQAmp0KlSP66YFOiX3mmzGOE3ePCa%2BgQDlsExxb4tpyKQ%2FtDazz52wpfDmKkwJWWOekAeuoP6XgSObFLgGUh68YDTh87wjloMT3%2FbJ59uqWrU72v0NpZaN3C9oWYxGjuLblHSsAPDlAxPUiq%2B7nQdNTywAW7U4mO6IIc67A%3D%3D" rel="nofollow" target="_blank">APNIC Blog</a>)</li></ol><h2>å¿«é€Ÿè‡ªæ£€ï¼šä½ åˆ°åº•éœ€ä¸éœ€è¦â€œå°UDPâ€ï¼Ÿï¼ˆä¸¤æ¡å‘½ä»¤å°±å¤Ÿï¼‰ğŸ›¡ï¸</h2><pre><code class="bash">tcpdump -nn -i eth0 'udp' -c 30</code></pre><p><strong>è§£é‡Šï¼š</strong>æŠ“ 30 ä¸ª UDP åŒ…åšâ€œå–æ ·å®¡è®¡â€ã€‚å¦‚æœä½ çœ‹åˆ°å¤§é‡éšæœºæº/éšæœºç«¯å£ã€æŒç»­å–·æ¶Œï¼ŒåŸºæœ¬å°±æ˜¯ UDP æ´ªæ³›/åå°„ç›¸å…³çš„å™ªå£°ï¼›å¦‚æœæŠ“åˆ°çš„æ˜¯ä½ ä¸šåŠ¡çœŸå®éœ€è¦çš„ç«¯å£ï¼ˆå¦‚ DNS/QUIC/æ¸¸æˆç«¯å£ï¼‰ï¼Œé‚£â€œå…¨å°UDPâ€å°±æ˜¯åœ¨è‡ªä¼¤ã€‚</p><pre><code class="bash">ss -uapn</code></pre><p><strong>è§£é‡Šï¼š</strong>åˆ—å‡ºæœ¬æœºæ­£åœ¨ä½¿ç”¨ UDP çš„è¿›ç¨‹ä¸ç«¯å£ï¼ˆu=UDPï¼‰ã€‚è¿™èƒ½å¸®ä½ ç¡®è®¤ï¼šä½ çš„ä¸šåŠ¡æ˜¯å¦çœŸçš„â€œå®Œå…¨ä¸ä¾èµ– UDPâ€ã€‚å¾ˆå¤šäººä»¥ä¸ºè‡ªå·±ä¸ç”¨ï¼Œç»“æœä¸€å¼€ HTTP/3/ç›‘æ§/è§£æå°±è¸©å‘ğŸš¦ã€‚</p><h2>å›åˆ°â€œè“æ˜“äº‘â€æ€ä¹ˆè½åœ°ï¼ˆåŠ¡å®å»ºè®®ï¼‰ğŸ“ˆ</h2><p>å¦‚æœä½ çš„ç›®æ ‡æ˜¯â€œæµ·å¤–é«˜é˜²äº‘æœåŠ¡å™¨â€ï¼Œæˆ‘å»ºè®®ç”¨<strong>&lt;span style="color:#ff0000;"&gt;â€˜è¾¹ç¼˜æŠ—å‹ï¼ˆé«˜é˜²CDNï¼‰+ æºç«™é«˜é˜²äº‘æœåŠ¡å™¨â€™&lt;/span&gt;</strong>çš„ç»„åˆæ‰“æ³•ï¼šè¾¹ç¼˜è´Ÿè´£å¸æ”¶ä¸åˆ†æ‘Šï¼Œæºç«™è´Ÿè´£æ”¶å£ä¸å›æºå®‰å…¨â€”â€”è¿™æ ·ä½ ä¸ä¼šè¢«è¿«èµ°â€œå°UDP/å°æµ·å¤–â€è¿™ç§ä½è´¨é‡æ“ä½œè·¯å¾„ã€‚å…·ä½“èƒ½åŠ›ä»¥ä½ æ§åˆ¶å°å¯é€‰ç­–ç•¥ä¸ºå‡†ï¼šé‡ç‚¹çœ‹æ˜¯å¦æ”¯æŒ UDP ç»†ç²’åº¦æ”¾è¡Œã€å››å±‚é™é€Ÿ/ä¼ªæºè¿‡æ»¤ã€æ¸…æ´—æ—¶å»¶ä¸æŠ¥è¡¨å¯è§‚æµ‹æ€§ï¼ˆæ²¡æœ‰è¿™å‡ é¡¹ï¼Œè°ˆé«˜é˜²éƒ½åè™šï¼‰ã€‚(<a href="https://link.segmentfault.com/?enc=RNhcMbVoyUGM47a7WNSI3A%3D%3D.2qdvsEDdIaOnSQM%2Fo3p89gM8h4j%2F4aoKI424tDGeZxyCfOSGj5MizQ4df%2BQwoiMXdvLG9SAmxZfWwLPujGjkvE07G%2FN5%2BFDDsC13MOK4k0i%2Fb4mCoHmHfmLBe2nLY9MlvdSh4OF9XMM2H3KPdJZBGADn8Cv2Rx%2BCYTfOXqsbf6t6d8yyJ2Dx8MBZmOV3Yl0Nj5EGTJTzUjEGlnbdqY0Z%2FrQqry%2B41pm3KHxoB7gpyTIuVV0xh1QbR5HOkB18E153" rel="nofollow" target="_blank">é˜¿é‡Œäº‘</a>)</p><ul><li><a href="https://link.segmentfault.com/?enc=%2FC%2B9tFTMoWyQuBhgmk9qxw%3D%3D.QBslWcTxRS1b8SoUM75NgeUZipo2Ti1%2FaZDfLNnY%2BhF1zUOTolyw1Xse8xwkRlbfDIRlaOtPjxTibLQARfKTrgDs98HjAPR9h52OcqPksSFcDTtQSTQe36ddI0uZyhZMM16BjO6%2BXD2eQn8xGKDh4o6vpegHjq%2BchVwTJYUe6zfYGtqzNb9MVsl9Tdvoets6eF69Sv%2BefPTniQw886jZnw%3D%3D" rel="nofollow" target="_blank">TechRadar</a></li><li><a href="https://link.segmentfault.com/?enc=1%2Bd4ZK3jA%2B50f52wpVBwYw%3D%3D.oT%2Byjcp5po%2F%2BJIeSE0P2%2BqExTgp4KfiY7FtBtAzUjrGuHMMQwIoWDUiIFQ8UjHfH%2FEMsd1WPB6llUJPr2uOlgqc0Y22Ii63IFXPvy1ung0osGyIEv7UUN974HIMJBvr7PuhIIqEALZIbJinGTvMZu5jYUbvtui3UNzYJpdmQDmLlOoJpeyrzrtDKQ13L9DR2rpvAKh8hBloA4kTJWJKyWB1TjHAppDOXCa7jwH%2BrlPn1vpmu5P1lxl4r3CNLt%2BIi" rel="nofollow" target="_blank">tomshardware.com</a></li></ul>]]></description></item><item>    <title><![CDATA[è“æ˜“äº‘cdn:whileè·³å‡ºå¾ªç¯java è“æ˜“äº‘ ]]></title>    <link>https://segmentfault.com/a/1190000047585903</link>    <guid>https://segmentfault.com/a/1190000047585903</guid>    <pubDate>2026-02-01 18:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>ä¸‹é¢ç›´æ¥ç»™ä½ ä¸€å¥—â€œå¯è½åœ°â€çš„ Java <code>while</code> <strong>è·³å‡ºå¾ªç¯</strong>æ–¹æ¡ˆçŸ©é˜µï¼šä½ æŒ‰åœºæ™¯é€‰å°±è¡Œ âœ…<br/>ï¼ˆæ ¸å¿ƒå°±ä¸‰ç±»ï¼š&lt;span style="color:#ff0000;"&gt;æ¡ä»¶å˜ false&lt;/span&gt;ã€&lt;span style="color:#ff0000;"&gt;break&lt;/span&gt;ã€&lt;span style="color:#ff0000;"&gt;return/throw&lt;/span&gt;ï¼‰</p><hr/><h2>1ï¼‰æœ€æ ‡å‡†ï¼šè®© while æ¡ä»¶å˜æˆ &lt;span style="color:#ff0000;"&gt;false&lt;/span&gt; âœ…</h2><pre><code class="java">int i = 0;

while (i &lt; 10) {
    System.out.println(i);
    i++; // å…³é”®ï¼šæ›´æ–°å¾ªç¯å˜é‡ï¼Œå¦åˆ™å¯èƒ½æ­»å¾ªç¯
}</code></pre><p><strong>è§£é‡Šï¼ˆé€ç‚¹è®²æ¸…æ¥šï¼‰ï¼š</strong></p><ul><li><code>while (i &lt; 10)</code> æ˜¯å¾ªç¯â€œå¼€å…³â€ã€‚</li><li><code>i++</code> è®© <code>i</code> å¢å¤§ï¼Œæœ€ç»ˆ <code>i &lt; 10</code> ä¸æˆç«‹ï¼Œå¾ªç¯è‡ªç„¶ç»“æŸã€‚</li><li>è¿™ç§æ–¹å¼æœ€â€œå¹²å‡€â€ï¼Œé€»è¾‘æœ€å¯ç»´æŠ¤ã€‚ğŸš€</li></ul><hr/><h2>2ï¼‰ä¸»åŠ¨è·³å‡ºï¼šä½¿ç”¨ &lt;span style="color:#ff0000;"&gt;break&lt;/span&gt;ï¼ˆå•å±‚ while ç«‹å³ç»“æŸï¼‰ğŸ›‘</h2><pre><code class="java">int i = 0;

while (true) { // è¿™é‡Œæ˜¯æ— é™å¾ªç¯ï¼Œå¿…é¡»é  break æ‰èƒ½åœ
    if (i == 5) {
        break; // å…³é”®ï¼šç›´æ¥è·³å‡º while
    }
    System.out.println(i);
    i++;
}</code></pre><p><strong>è§£é‡Šï¼š</strong></p><ul><li><code>while (true)</code> è¡¨ç¤ºâ€œæ°¸è¿œå¾ªç¯â€ï¼Œå¸¸ç”¨äºâ€œç­‰å¾…æŸä¸ªæ¡ä»¶æ»¡è¶³â€ã€‚</li><li><code>break</code> æ˜¯â€œç´§æ€¥å‡ºå£â€ï¼Œæ‰§è¡Œåˆ°è¿™é‡Œä¼šç«‹åˆ»ç»“æŸå½“å‰ whileã€‚</li><li>é€‚ç”¨äºï¼šæ‰¾åˆ°ç›®æ ‡å°±åœæ­¢ã€å‡ºç°å¼‚å¸¸çŠ¶æ€å°±é€€å‡ºç­‰ã€‚âœ…</li></ul><hr/><h2>3ï¼‰è·³è¿‡æœ¬è½®ï¼šä½¿ç”¨ &lt;span style="color:#ff0000;"&gt;continue&lt;/span&gt;ï¼ˆä¸æ˜¯è·³å‡ºï¼Œæ˜¯è·³è¿‡ï¼‰âš ï¸</h2><blockquote>å¾ˆå¤šäººæŠŠ <code>continue</code> å½“æˆâ€œè·³å‡ºâ€ï¼Œå…¶å®å®ƒåªæ˜¯â€œè·³è¿‡æœ¬è½®å‰©ä½™ä»£ç â€ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€è½®åˆ¤æ–­ã€‚</blockquote><pre><code class="java">int i = 0;

while (i &lt; 10) {
    i++;
    if (i % 2 == 0) {
        continue; // å…³é”®ï¼šè·³è¿‡ä¸‹é¢çš„æ‰“å°ï¼Œè¿›å…¥ä¸‹ä¸€è½®
    }
    System.out.println(i); // åªæ‰“å°å¥‡æ•°
}</code></pre><p><strong>è§£é‡Šï¼š</strong></p><ul><li><code>continue</code> ä¸ä¼šç»“æŸå¾ªç¯ï¼Œåªæ˜¯è·³è¿‡æœ¬è½®å‰©ä½™è¯­å¥ã€‚</li><li>ä¸Šé¢ä»£ç ä¼šè¾“å‡º 1,3,5,7,9ã€‚</li><li>ä½¿ç”¨æ—¶è¦ç‰¹åˆ«æ³¨æ„ï¼šå¾ªç¯å˜é‡è¦ç…§æ ·æ›´æ–°ï¼Œå¦åˆ™å®¹æ˜“æ­»å¾ªç¯ã€‚ğŸ§ </li></ul><hr/><h2>4ï¼‰å¤šå±‚å¾ªç¯ï¼šç”¨ &lt;span style="color:#ff0000;"&gt;æ ‡ç­¾ break&lt;/span&gt; ä¸€æ¬¡è·³å‡ºå¤šå±‚ï¼ˆå¾ˆå®ç”¨ï¼‰ğŸ¯</h2><pre><code class="java">outer:
while (true) {
    int j = 0;

    while (j &lt; 10) {
        if (j == 3) {
            break outer; // å…³é”®ï¼šç›´æ¥è·³å‡ºå¤–å±‚ while
        }
        j++;
    }
}</code></pre><p><strong>è§£é‡Šï¼š</strong></p><ul><li><code>outer:</code> æ˜¯ä¸€ä¸ªâ€œæ ‡ç­¾â€ï¼Œæ ‡è®°å¤–å±‚å¾ªç¯ã€‚</li><li><code>break outer;</code> ä¼šè·³å‡ºè¢«æ ‡è®°çš„é‚£ä¸€å±‚ï¼ˆè¿™é‡Œæ˜¯å¤–å±‚ whileï¼‰ã€‚</li><li>é€‚ç”¨äºï¼šåµŒå¥—å¾ªç¯é‡Œæ‰¾åˆ°ç›®æ ‡è¦æ•´ä½“ç»“æŸï¼Œä¸æƒ³å†™ä¸€å † flagã€‚âœ…</li></ul><hr/><h2>5ï¼‰ç›´æ¥ç»“æŸæ–¹æ³•ï¼š&lt;span style="color:#ff0000;"&gt;return&lt;/span&gt; æˆ–æŠ›å¼‚å¸¸ï¼ˆæ›´â€œå½»åº•â€ï¼‰ğŸ’¥</h2><pre><code class="java">public static int findFirstPositive(int[] arr) {
    int i = 0;

    while (i &lt; arr.length) {
        if (arr[i] &gt; 0) {
            return arr[i]; // å…³é”®ï¼šç›´æ¥ç»“æŸæ•´ä¸ªæ–¹æ³•
        }
        i++;
    }
    return -1;
}</code></pre><p><strong>è§£é‡Šï¼š</strong></p><ul><li><code>return</code> ä¸åªæ˜¯è·³å‡º whileï¼Œè€Œæ˜¯ç›´æ¥ç»“æŸå½“å‰æ–¹æ³•ã€‚</li><li>é€‚ç”¨äºï¼šæ‰¾åˆ°ç»“æœå°±è¿”å›ï¼Œåé¢é€»è¾‘ä¸éœ€è¦ç»§ç»­è·‘ã€‚</li><li>å¦‚æœæ˜¯â€œå¼‚å¸¸æƒ…å†µå¿…é¡»ç«‹åˆ»ç»ˆæ­¢â€ï¼Œå¯ä»¥ <code>throw new RuntimeException(...)</code>ã€‚ğŸ›¡ï¸</li></ul><hr/><h2>åˆ†æè¯´æ˜è¡¨ï¼ˆä½ æŒ‰éœ€æ±‚é€‰ï¼‰ğŸ“Œ</h2><table><thead><tr><th>æ–¹å¼</th><th align="right">æ˜¯å¦ç»“æŸå¾ªç¯</th><th align="right">æ˜¯å¦ç»“æŸæ–¹æ³•</th><th>å…¸å‹åœºæ™¯</th><th>é£é™©ç‚¹</th></tr></thead><tbody><tr><td>æ¡ä»¶å˜ &lt;span style="color:#ff0000;"&gt;false&lt;/span&gt;</td><td align="right">âœ…</td><td align="right">âŒ</td><td>å¸¸è§„å¾ªç¯è®¡æ•°ã€éå†</td><td>æ¡ä»¶/å˜é‡ä¸æ›´æ–°ä¼šæ­»å¾ªç¯</td></tr><tr><td>&lt;span style="color:#ff0000;"&gt;break&lt;/span&gt;</td><td align="right">âœ…</td><td align="right">âŒ</td><td>æ‰¾åˆ°ç›®æ ‡å³åœã€å¼‚å¸¸çŠ¶æ€é€€å‡º</td><td>åµŒå¥—æ—¶åªè·³å‡ºä¸€å±‚</td></tr><tr><td>&lt;span style="color:#ff0000;"&gt;continue&lt;/span&gt;</td><td align="right">âŒï¼ˆåªè·³è¿‡æœ¬è½®ï¼‰</td><td align="right">âŒ</td><td>è¿‡æ»¤æ•°æ®ã€è·³è¿‡æ— æ•ˆé¡¹</td><td>å®¹æ˜“å¿˜è®°å˜é‡æ›´æ–°å¯¼è‡´æ­»å¾ªç¯</td></tr><tr><td>æ ‡ç­¾ &lt;span style="color:#ff0000;"&gt;break outer&lt;/span&gt;</td><td align="right">âœ…ï¼ˆå¯å¤šå±‚ï¼‰</td><td align="right">âŒ</td><td>å¤šå±‚å¾ªç¯ä¸€æ¬¡é€€å‡º</td><td>æ ‡ç­¾å‘½åè¦æ¸…æ™°é¿å…é˜…è¯»è´Ÿæ‹…</td></tr><tr><td>&lt;span style="color:#ff0000;"&gt;return&lt;/span&gt; / throw</td><td align="right">âœ…</td><td align="right">âœ…</td><td>æ‰¾åˆ°ç»“æœç«‹å³è¿”å›/é”™è¯¯ç«‹å³ç»ˆæ­¢</td><td>é€»è¾‘ä¼šâ€œæˆªæ–­â€ï¼Œéœ€ç¡®ä¿åç½®å¤„ç†å·²å®Œæˆ</td></tr></tbody></table><hr/><h2>æœ€å®¹æ˜“è¸©å‘çš„ 3 ä¸ªç‚¹ï¼ˆé˜²æ­¢ä½ çº¿ä¸ŠèƒŒé”…ï¼‰ğŸ˜„</h2><ol><li><code>while</code> æ¡ä»¶å†™å¯¹äº†ï¼Œä½†<strong>å¾ªç¯å˜é‡æ²¡æ›´æ–°</strong> â†’ &lt;span style="color:#ff0000;"&gt;æ­»å¾ªç¯&lt;/span&gt;</li><li><code>break</code> åªèƒ½è·³å‡º<strong>å½“å‰è¿™ä¸€å±‚</strong> â†’ åµŒå¥—æ—¶éœ€è¦æ ‡ç­¾ break æˆ– flag</li><li><code>continue</code> ä¸æ˜¯é€€å‡º â†’ å®ƒåªæ˜¯â€œè·³è¿‡æœ¬è½®â€ï¼Œåˆ«ç”¨é”™è¯­ä¹‰</li></ol><hr/><p>å¦‚æœä½ ç»™æˆ‘ä½ é‚£æ®µ <code>while</code> ä»£ç ï¼ˆæˆ–è¯´æ¸…æ¥šï¼šå•å±‚/å¤šå±‚ã€è¦é€€å‡ºåˆ°å“ªé‡Œï¼‰ï¼Œæˆ‘å¯ä»¥æŒ‰ä½ çœŸå®åœºæ™¯æŠŠâ€œè·³å‡ºç‚¹â€å’Œâ€œæœ€ä½³å†™æ³•â€ç›´æ¥æ”¹æˆå¯ç”¨ç‰ˆæœ¬ã€‚</p>]]></description></item><item>    <title><![CDATA[DSPçš„é€‰å‹å’Œåº”ç”¨ è‰¯è®¸ ]]></title>    <link>https://segmentfault.com/a/1190000047585780</link>    <guid>https://segmentfault.com/a/1190000047585780</guid>    <pubDate>2026-02-01 16:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯è‰¯è®¸ã€‚</p><p>åœ¨åµŒå…¥å¼å¼€å‘é¢†åŸŸï¼ŒDSPï¼ˆDigital Signal Processorï¼Œæ•°å­—ä¿¡å·å¤„ç†å™¨ï¼‰æ˜¯ä¸€ç±»ä¸“é—¨ç”¨äºé«˜é€Ÿæ•°å­—ä¿¡å·å¤„ç†çš„å¾®å¤„ç†å™¨ã€‚</p><p>è™½ç„¶æˆ‘ä¸»è¦ä»äº‹åµŒå…¥å¼Linuxå’Œå•ç‰‡æœºå¼€å‘ï¼Œä½†åœ¨å®é™…é¡¹ç›®ä¸­ä¹Ÿæ¥è§¦è¿‡ä¸å°‘éœ€è¦DSPå‚ä¸çš„åœºæ™¯ï¼Œæ¯”å¦‚éŸ³é¢‘å¤„ç†ã€ç”µæœºæ§åˆ¶ã€å›¾åƒè¯†åˆ«ç­‰ã€‚</p><p>ä»Šå¤©å°±å’Œå¤§å®¶èŠèŠDSPçš„é€‰å‹å’Œåº”ç”¨ï¼Œå¸Œæœ›èƒ½ç»™éœ€è¦ç”¨åˆ°DSPçš„æœ‹å‹ä¸€äº›å‚è€ƒã€‚</p><h2>1. DSPåŸºç¡€æ¦‚å¿µä¸ç‰¹ç‚¹</h2><h3>1.1 ä»€ä¹ˆæ˜¯DSP</h3><p>DSPæ˜¯ä¸€ç§ä¸“é—¨ä¸ºæ•°å­—ä¿¡å·å¤„ç†è€Œè®¾è®¡çš„å¾®å¤„ç†å™¨ã€‚</p><p>ä¸é€šç”¨çš„MCUï¼ˆå¦‚STM32ï¼‰ç›¸æ¯”ï¼ŒDSPåœ¨å¤„ç†å¤§é‡æ•°å­¦è¿ç®—æ—¶å…·æœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚</p><p>å®ƒçš„ç¡¬ä»¶æ¶æ„é’ˆå¯¹ä¹˜æ³•ã€åŠ æ³•ç­‰è¿ç®—è¿›è¡Œäº†ä¼˜åŒ–ï¼Œé€šå¸¸é‡‡ç”¨å“ˆä½›æ¶æ„ï¼ˆç¨‹åºå­˜å‚¨å™¨å’Œæ•°æ®å­˜å‚¨å™¨åˆ†ç¦»ï¼‰ï¼Œèƒ½å¤Ÿåœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å®Œæˆå¤šæ¡æŒ‡ä»¤çš„æ‰§è¡Œã€‚</p><p>åœ¨æˆ‘æ—©æœŸåšæ±½è½¦ç”µå­é¡¹ç›®æ—¶ï¼Œæ›¾ç»é‡åˆ°è¿‡ä¸€ä¸ªå‘åŠ¨æœºå™ªéŸ³ä¸»åŠ¨é™å™ªçš„éœ€æ±‚ã€‚</p><p>å½“æ—¶ä½¿ç”¨æ™®é€šçš„ARM Cortex-M4å¤„ç†éŸ³é¢‘æ•°æ®æ—¶ï¼ŒCPUå ç”¨ç‡ç»å¸¸é£™åˆ°90%ä»¥ä¸Šï¼Œå®æ—¶æ€§å¾ˆå·®ã€‚</p><p>åæ¥æ¢æˆTIçš„C2000ç³»åˆ—DSPåï¼ŒåŒæ ·çš„ç®—æ³•CPUå ç”¨ç‡é™åˆ°äº†30%å·¦å³ï¼Œæ•ˆæœç«‹ç«¿è§å½±ã€‚</p><h3>1.2 DSPçš„æ ¸å¿ƒç‰¹ç‚¹</h3><p>DSPç›¸æ¯”æ™®é€šMCUæœ‰å‡ ä¸ªæ˜¾è‘—ç‰¹ç‚¹ã€‚</p><p>é¦–å…ˆæ˜¯ä¸“ç”¨çš„ç¡¬ä»¶ä¹˜æ³•å™¨ï¼Œå¯ä»¥åœ¨å•ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å®Œæˆä¹˜æ³•è¿ç®—ã€‚</p><p>å…¶æ¬¡æ˜¯å¤šæ€»çº¿æ¶æ„ï¼Œå…è®¸åŒæ—¶è®¿é—®ç¨‹åºå’Œæ•°æ®å­˜å‚¨å™¨ã€‚</p><p>ç¬¬ä¸‰æ˜¯ä¸“é—¨çš„å¯»å€æ¨¡å¼ï¼Œæ¯”å¦‚å¾ªç¯å¯»å€ã€ä½ååºå¯»å€ç­‰ï¼Œè¿™äº›åœ¨FFTç­‰ç®—æ³•ä¸­éå¸¸æœ‰ç”¨ã€‚</p><p>ç¬¬å››æ˜¯ä¸°å¯Œçš„å¤–è®¾æ¥å£ï¼Œç‰¹åˆ«æ˜¯é«˜é€ŸADCã€PWMç­‰ï¼Œéå¸¸é€‚åˆç”µæœºæ§åˆ¶å’ŒéŸ³é¢‘å¤„ç†ã€‚</p><p>ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼Œåœ¨åšç”µæœºFOCï¼ˆç£åœºå®šå‘æ§åˆ¶ï¼‰æ—¶ï¼Œéœ€è¦è¿›è¡Œå¤§é‡çš„ä¸‰è§’å‡½æ•°è¿ç®—å’Œåæ ‡å˜æ¢ã€‚</p><p>å¦‚æœç”¨STM32 F4ç³»åˆ—ï¼Œå³ä½¿å¼€å¯äº†FPUï¼ˆæµ®ç‚¹è¿ç®—å•å…ƒï¼‰ï¼Œå¤„ç†ä¸€æ¬¡å®Œæ•´çš„FOCå¾ªç¯ä¹Ÿéœ€è¦å‡ åå¾®ç§’ã€‚</p><p>è€Œä½¿ç”¨TIçš„C2000ç³»åˆ—DSPï¼ŒåŒæ ·çš„è¿ç®—å¯ä»¥åœ¨å‡ å¾®ç§’å†…å®Œæˆï¼Œè¿™å¯¹äºé«˜é€Ÿç”µæœºæ§åˆ¶è‡³å…³é‡è¦ã€‚</p><h2>2. ä¸»æµDSPå‚å•†å’Œäº§å“ç³»åˆ—</h2><h3>2.1 å¾·å·ä»ªå™¨ï¼ˆTIï¼‰</h3><p>TIæ˜¯DSPé¢†åŸŸçš„è€å¤§ï¼Œäº§å“çº¿éå¸¸ä¸°å¯Œã€‚</p><p>C2000ç³»åˆ—ä¸»è¦é¢å‘å®æ—¶æ§åˆ¶åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯ç”µæœºæ§åˆ¶ã€æ•°å­—ç”µæºç­‰é¢†åŸŸã€‚</p><p>è¿™ä¸ªç³»åˆ—çš„DSPé›†æˆäº†é«˜ç²¾åº¦PWMã€å¿«é€ŸADCç­‰å¤–è®¾ï¼Œéå¸¸é€‚åˆå·¥ä¸šæ§åˆ¶ã€‚</p><p>C5000ç³»åˆ—åˆ™ä¾§é‡äºä½åŠŸè€—åº”ç”¨ï¼Œå¸¸ç”¨äºä¾¿æºå¼éŸ³é¢‘è®¾å¤‡ã€åŠ©å¬å™¨ç­‰ã€‚</p><p>C6000ç³»åˆ—æ˜¯é«˜æ€§èƒ½DSPï¼Œç”¨äºé€šä¿¡åŸºç«™ã€åŒ»ç–—å½±åƒç­‰éœ€è¦å¤§é‡æ•°æ®å¤„ç†çš„åœºåˆã€‚</p><p>æˆ‘åœ¨åšæ±½è½¦ç”µå­é¡¹ç›®æ—¶ï¼Œç”¨è¿‡TIçš„TMS320F28335ï¼Œè¿™æ˜¯C2000ç³»åˆ—çš„ç»å…¸å‹å·ã€‚</p><p>å®ƒçš„ä¸»é¢‘150MHzï¼Œé…å¤‡12ä½ADCï¼Œè½¬æ¢æ—¶é—´åªæœ‰80çº³ç§’ï¼Œéå¸¸é€‚åˆå¿«é€Ÿçš„ç”µæµé‡‡æ ·ã€‚</p><p>å½“æ—¶æˆ‘ä»¬ç”¨å®ƒåšç”µåŠ¨åŠ©åŠ›è½¬å‘ç³»ç»Ÿï¼Œéœ€è¦å®æ—¶é‡‡é›†ç”µæœºç”µæµå¹¶è¿›è¡ŒFOCæ§åˆ¶ï¼Œè¿™æ¬¾DSPå®Œå…¨èƒ½å¤Ÿèƒœä»»ã€‚</p><h3>2.2 ADIï¼ˆAnalog Devicesï¼‰</h3><p>ADIçš„SHARCç³»åˆ—DSPåœ¨éŸ³é¢‘å¤„ç†é¢†åŸŸå¾ˆæœ‰åæ°”ã€‚</p><p>SHARC DSPé‡‡ç”¨è¶…æ ‡é‡æ¶æ„ï¼Œæµ®ç‚¹è¿ç®—èƒ½åŠ›å¼ºå¤§ï¼Œç‰¹åˆ«é€‚åˆä¸“ä¸šéŸ³é¢‘è®¾å¤‡ã€å£°å­¦å¤„ç†ç­‰åº”ç”¨ã€‚</p><p>Blackfinç³»åˆ—åˆ™æ˜¯å®šç‚¹DSPï¼ŒåŠŸè€—è¾ƒä½ï¼Œå¸¸ç”¨äºè§†é¢‘ç›‘æ§ã€å›¾åƒå¤„ç†ç­‰é¢†åŸŸã€‚</p><p>æˆ‘æœ‰ä¸ªæœ‹å‹åœ¨åšä¸“ä¸šéŸ³å“è®¾å¤‡ï¼Œä»–ä»¬ç”¨çš„å°±æ˜¯ADIçš„ADSP-21489ï¼Œè¿™æ˜¯ä¸€æ¬¾åŒæ ¸SHARC DSPï¼Œä¸»é¢‘450MHzï¼Œèƒ½å¤ŸåŒæ—¶å¤„ç†å¤šè·¯éŸ³é¢‘ä¿¡å·ï¼Œå®ç°æ··å“ã€å‡è¡¡ã€å‹ç¼©ç­‰å¤æ‚çš„éŸ³é¢‘æ•ˆæœã€‚</p><h3>2.3 NXPå’ŒST</h3><p>NXPçš„i.MX RTç³»åˆ—è™½ç„¶ä¸æ˜¯çº¯DSPï¼Œä½†é›†æˆäº†DSPåå¤„ç†å™¨ï¼Œå¯ä»¥å¤„ç†ä¸€äº›ä¸­ç­‰å¤æ‚åº¦çš„ä¿¡å·å¤„ç†ä»»åŠ¡ã€‚</p><p>STçš„STM32H7ç³»åˆ—ä¹Ÿç±»ä¼¼ï¼Œä¸»æ ¸å¿ƒæ˜¯ARM Cortex-M7ï¼Œä½†æ€§èƒ½å·²ç»è¶³å¤Ÿåº”å¯¹å¾ˆå¤šDSPä»»åŠ¡ã€‚</p><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¦‚æœä¿¡å·å¤„ç†éœ€æ±‚ä¸æ˜¯ç‰¹åˆ«å¤æ‚ï¼Œæˆ‘é€šå¸¸ä¼šä¼˜å…ˆè€ƒè™‘STM32H7ã€‚</p><p>æ¯”å¦‚åšä¸€ä¸ªç®€å•çš„éŸ³é¢‘æ»¤æ³¢å™¨ï¼ŒSTM32H7å®Œå…¨å¤Ÿç”¨ï¼Œè€Œä¸”å¼€å‘å·¥å…·é“¾æ›´æˆç†Ÿï¼Œè°ƒè¯•ä¹Ÿæ›´æ–¹ä¾¿ã€‚</p><h2>3. DSPé€‰å‹çš„å…³é”®å› ç´ </h2><h3>3.1 è¿ç®—æ€§èƒ½éœ€æ±‚</h3><p>é€‰æ‹©DSPé¦–å…ˆè¦æ˜ç¡®è¿ç®—æ€§èƒ½éœ€æ±‚ã€‚</p><p>è¿™åŒ…æ‹¬è¿ç®—ç²¾åº¦ï¼ˆå®šç‚¹è¿˜æ˜¯æµ®ç‚¹ï¼‰ã€è¿ç®—é€Ÿåº¦ï¼ˆMIPSæˆ–MFLOPSï¼‰ã€å­˜å‚¨å™¨å®¹é‡ç­‰ã€‚</p><p>å®šç‚¹DSPæˆæœ¬ä½ã€åŠŸè€—å°ï¼Œä½†ç²¾åº¦æœ‰é™ï¼Œé€‚åˆå¯¹ç²¾åº¦è¦æ±‚ä¸é«˜çš„åœºåˆã€‚</p><p>æµ®ç‚¹DSPç²¾åº¦é«˜ã€ç¼–ç¨‹æ–¹ä¾¿ï¼Œä½†æˆæœ¬å’ŒåŠŸè€—ç›¸å¯¹è¾ƒé«˜ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœåšä¸€ä¸ªç®€å•çš„æ•°å­—æ»¤æ³¢å™¨ï¼Œé‡‡æ ·ç‡åªæœ‰å‡ kHzï¼Œæ•°æ®ç²¾åº¦è¦æ±‚ä¸é«˜ï¼Œé‚£ä¹ˆå®šç‚¹DSPå°±è¶³å¤Ÿäº†ã€‚</p><p>ä½†å¦‚æœæ˜¯åšéŸ³é¢‘ç¼–è§£ç ï¼Œéœ€è¦å¤„ç†44.1kHzæˆ–æ›´é«˜é‡‡æ ·ç‡çš„éŸ³é¢‘ï¼Œè€Œä¸”è¦ä¿è¯éŸ³è´¨ï¼Œé‚£å°±éœ€è¦æµ®ç‚¹DSPã€‚</p><p>åœ¨æˆ‘åšè¿‡çš„ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œéœ€è¦å®ç°ä¸€ä¸ª8é˜¶IIRæ»¤æ³¢å™¨ï¼Œé‡‡æ ·ç‡10kHzã€‚</p><p>æˆ‘ä»¬æœ€åˆé€‰æ‹©äº†å®šç‚¹DSPï¼Œä½†å‘ç°é‡åŒ–è¯¯å·®å¯¼è‡´æ»¤æ³¢å™¨ä¸ç¨³å®šã€‚</p><p>åæ¥æ¢æˆæµ®ç‚¹DSPï¼Œé—®é¢˜å°±è§£å†³äº†ã€‚</p><p>è¿™ä¸ªæ•™è®­å‘Šè¯‰æˆ‘ï¼Œé€‰å‹æ—¶ä¸€å®šè¦å……åˆ†è¯„ä¼°è¿ç®—ç²¾åº¦éœ€æ±‚ã€‚</p><h3>3.2 å¤–è®¾æ¥å£è¦æ±‚</h3><p>DSPçš„å¤–è®¾æ¥å£ä¹Ÿæ˜¯é€‰å‹çš„é‡è¦è€ƒè™‘å› ç´ ã€‚</p><p>å¯¹äºç”µæœºæ§åˆ¶åº”ç”¨ï¼Œéœ€è¦é«˜ç²¾åº¦PWMã€å¿«é€ŸADCã€ç¼–ç å™¨æ¥å£ç­‰ã€‚</p><p>å¯¹äºéŸ³é¢‘åº”ç”¨ï¼Œéœ€è¦I2Sã€McASPç­‰éŸ³é¢‘æ¥å£ã€‚å¯¹äºé€šä¿¡åº”ç”¨ï¼Œéœ€è¦é«˜é€Ÿä¸²å£ã€ä»¥å¤ªç½‘ç­‰ã€‚</p><p>ä»¥TIçš„C2000ç³»åˆ—ä¸ºä¾‹ï¼Œå®ƒé›†æˆäº†ePWMæ¨¡å—ï¼Œå¯ä»¥äº§ç”Ÿé«˜ç²¾åº¦çš„PWMæ³¢å½¢ï¼Œæ­»åŒºæ—¶é—´å¯ä»¥ç²¾ç¡®åˆ°çº³ç§’çº§ã€‚</p><p>è¿™å¯¹äºç”µæœºæ§åˆ¶å’Œæ•°å­—ç”µæºéå¸¸é‡è¦ã€‚</p><p>å®ƒè¿˜é›†æˆäº†eQEPæ¨¡å—ï¼Œå¯ä»¥ç›´æ¥è¿æ¥å¢é‡å¼ç¼–ç å™¨ï¼Œç¡¬ä»¶è§£ç ï¼Œä¸å ç”¨CPUèµ„æºã€‚</p><p>æˆ‘åœ¨åšä¸€ä¸ªä¸‰ç›¸æ— åˆ·ç”µæœºæ§åˆ¶é¡¹ç›®æ—¶ï¼Œå°±ç”¨åˆ°äº†TMS320F28069çš„ePWMå’ŒeQEPæ¨¡å—ã€‚</p><p>ePWMå¯ä»¥äº§ç”Ÿ6è·¯äº’è¡¥PWMï¼Œå¸¦æ­»åŒºä¿æŠ¤ï¼Œç›´æ¥é©±åŠ¨ä¸‰ç›¸é€†å˜å™¨ã€‚</p><p>eQEPå¯ä»¥è¯»å–ç¼–ç å™¨ä½ç½®å’Œé€Ÿåº¦ï¼Œå®ç°é—­ç¯æ§åˆ¶ã€‚</p><p>è¿™äº›ç¡¬ä»¶å¤–è®¾å¤§å¤§ç®€åŒ–äº†è½¯ä»¶å¼€å‘ï¼Œæé«˜äº†ç³»ç»Ÿå¯é æ€§ã€‚</p><h3>3.3 å¼€å‘å·¥å…·å’Œç”Ÿæ€ç³»ç»Ÿ</h3><p>å¼€å‘å·¥å…·çš„æ˜“ç”¨æ€§å’Œç”Ÿæ€ç³»ç»Ÿçš„å®Œå–„ç¨‹åº¦ä¹Ÿå¾ˆé‡è¦ã€‚</p><p>TIçš„Code Composer Studioï¼ˆCCSï¼‰æ˜¯ä¸šç•Œæ¯”è¾ƒæˆç†Ÿçš„DSPå¼€å‘ç¯å¢ƒï¼Œæ”¯æŒC/C++ç¼–ç¨‹ï¼Œé›†æˆäº†è°ƒè¯•å™¨ã€æ€§èƒ½åˆ†æå·¥å…·ç­‰ã€‚</p><p>ADIçš„CrossCore Embedded Studioä¹Ÿç±»ä¼¼ã€‚</p><p>æ­¤å¤–ï¼Œè¿˜è¦è€ƒè™‘æ˜¯å¦æœ‰ä¸°å¯Œçš„åº“å‡½æ•°å’Œç¤ºä¾‹ä»£ç ã€‚</p><p>TIæä¾›äº†ControlSUITEï¼ŒåŒ…å«å¤§é‡çš„ç”µæœºæ§åˆ¶ã€æ•°å­—ç”µæºç­‰åº”ç”¨ç¤ºä¾‹ã€‚</p><p>ADIä¹Ÿæœ‰ç±»ä¼¼çš„èµ„æºã€‚è¿™äº›èµ„æºå¯ä»¥å¤§å¤§ç¼©çŸ­å¼€å‘å‘¨æœŸã€‚</p><p>æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢TIçš„å¼€å‘ç¯å¢ƒï¼Œå› ä¸ºå®ƒçš„æ–‡æ¡£éå¸¸è¯¦ç»†ï¼Œç¤¾åŒºä¹Ÿå¾ˆæ´»è·ƒã€‚</p><p>é‡åˆ°é—®é¢˜æ—¶ï¼Œé€šå¸¸èƒ½åœ¨TIçš„E2Eè®ºå›ä¸Šæ‰¾åˆ°ç­”æ¡ˆã€‚</p><p>è€Œä¸”TIæä¾›çš„åº“å‡½æ•°è´¨é‡å¾ˆé«˜ï¼Œæ¯”å¦‚IQmathåº“ï¼Œå¯ä»¥ç”¨å®šç‚¹è¿ç®—æ¨¡æ‹Ÿæµ®ç‚¹è¿ç®—ï¼Œæ—¢ä¿è¯äº†ç²¾åº¦åˆæé«˜äº†é€Ÿåº¦ã€‚</p><h3>3.4 æˆæœ¬å’Œä¾›è´§ç¨³å®šæ€§</h3><p>æˆæœ¬æ˜¯å•†ä¸šé¡¹ç›®å¿…é¡»è€ƒè™‘çš„å› ç´ ã€‚</p><p>DSPçš„ä»·æ ¼ä»å‡ ç¾å…ƒåˆ°å‡ ç™¾ç¾å…ƒä¸ç­‰ï¼Œè¦æ ¹æ®é¡¹ç›®é¢„ç®—é€‰æ‹©åˆé€‚çš„å‹å·ã€‚</p><p>åŒæ—¶è¦è€ƒè™‘ä¾›è´§ç¨³å®šæ€§ï¼Œç‰¹åˆ«æ˜¯å¯¹äºé‡äº§é¡¹ç›®ï¼Œè¦é€‰æ‹©ç”Ÿå‘½å‘¨æœŸé•¿ã€ä¾›è´§ç¨³å®šçš„å‹å·ã€‚</p><p>åœ¨æ±½è½¦ç”µå­é¢†åŸŸï¼Œä¾›è´§ç¨³å®šæ€§å°¤å…¶é‡è¦ã€‚æ±½è½¦äº§å“çš„ç”Ÿå‘½å‘¨æœŸé€šå¸¸åœ¨10å¹´ä»¥ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©çš„DSPå¿…é¡»ä¿è¯é•¿æœŸä¾›è´§ã€‚</p><p>TIçš„C2000ç³»åˆ—åœ¨è¿™æ–¹é¢åšå¾—ä¸é”™ï¼Œå¾ˆå¤šå‹å·å·²ç»ä¾›è´§åå‡ å¹´äº†ï¼Œè€Œä¸”æ‰¿è¯ºä¼šç»§ç»­ä¾›è´§ã€‚</p><h2>4. DSPçš„å…¸å‹åº”ç”¨åœºæ™¯</h2><h3>4.1 ç”µæœºæ§åˆ¶</h3><p>ç”µæœºæ§åˆ¶æ˜¯DSPæœ€å…¸å‹çš„åº”ç”¨ä¹‹ä¸€ã€‚</p><p>ç°ä»£ç”µæœºæ§åˆ¶ç®—æ³•ï¼Œå¦‚FOCã€æ— ä¼ æ„Ÿå™¨æ§åˆ¶ç­‰ï¼Œéœ€è¦å¤§é‡çš„æ•°å­¦è¿ç®—ã€‚</p><p>DSPçš„é«˜é€Ÿè¿ç®—èƒ½åŠ›å’Œä¸°å¯Œçš„å¤–è®¾æ¥å£ï¼Œä½¿å…¶æˆä¸ºç”µæœºæ§åˆ¶çš„ç†æƒ³é€‰æ‹©ã€‚</p><p>ä»¥FOCç®—æ³•ä¸ºä¾‹ï¼Œå®ƒéœ€è¦è¿›è¡ŒClarkeå˜æ¢ã€Parkå˜æ¢ã€PIæ§åˆ¶ã€åParkå˜æ¢ã€SVPWMç­‰ä¸€ç³»åˆ—è¿ç®—ã€‚</p><p>è¿™äº›è¿ç®—æ¶‰åŠå¤§é‡çš„ä¸‰è§’å‡½æ•°å’ŒçŸ©é˜µè¿ç®—ã€‚</p><p>å¦‚æœç”¨æ™®é€šMCUï¼Œå¾ˆéš¾åœ¨ä¸€ä¸ªPWMå‘¨æœŸå†…å®Œæˆæ‰€æœ‰è¿ç®—ã€‚è€Œç”¨DSPï¼Œå¯ä»¥è½»æ¾å®ç°å‡ åkHzçš„æ§åˆ¶é¢‘ç‡ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€åŒ–çš„FOCæ§åˆ¶ä»£ç ç¤ºä¾‹ï¼ˆä¼ªä»£ç ï¼‰ï¼š</p><pre><code class="c">void FOC_Control(void)
{
    // è¯»å–ä¸‰ç›¸ç”µæµ
    float Ia = ADC_ReadCurrent_A();
    float Ib = ADC_ReadCurrent_B();
    float Ic = ADC_ReadCurrent_C();
    
    // Clarkeå˜æ¢ï¼šabcåæ ‡ç³»è½¬æ¢åˆ°Î±Î²åæ ‡ç³»
    float I_alpha = Ia;
    float I_beta = (Ia + 2*Ib) / sqrt(3);
    
    // è¯»å–è½¬å­ä½ç½®
    float theta = Encoder_GetAngle();
    
    // Parkå˜æ¢ï¼šÎ±Î²åæ ‡ç³»è½¬æ¢åˆ°dqåæ ‡ç³»
    float Id = I_alpha * cos(theta) + I_beta * sin(theta);
    float Iq = -I_alpha * sin(theta) + I_beta * cos(theta);
    
    // PIæ§åˆ¶
    float Vd = PI_Controller_D(Id_ref - Id);
    float Vq = PI_Controller_Q(Iq_ref - Iq);
    
    // åParkå˜æ¢ï¼šdqåæ ‡ç³»è½¬æ¢åˆ°Î±Î²åæ ‡ç³»
    float V_alpha = Vd * cos(theta) - Vq * sin(theta);
    float V_beta = Vd * sin(theta) + Vq * cos(theta);
    
    // SVPWMè°ƒåˆ¶
    SVPWM_Modulation(V_alpha, V_beta);
}</code></pre><p>åœ¨å®é™…çš„DSPä»£ç ä¸­ï¼Œè¿™äº›ä¸‰è§’å‡½æ•°è¿ç®—å¯ä»¥é€šè¿‡æŸ¥è¡¨æ³•æˆ–è€…ç¡¬ä»¶åŠ é€Ÿæ¥å®ç°ï¼Œé€Ÿåº¦éå¸¸å¿«ã€‚</p><h3>4.2 éŸ³é¢‘å¤„ç†</h3><p>éŸ³é¢‘å¤„ç†æ˜¯DSPçš„å¦ä¸€ä¸ªé‡è¦åº”ç”¨é¢†åŸŸã€‚</p><p>åŒ…æ‹¬éŸ³é¢‘ç¼–è§£ç ã€éŸ³æ•ˆå¤„ç†ã€é™å™ªã€å›å£°æ¶ˆé™¤ç­‰ã€‚</p><p>è¿™äº›åº”ç”¨éœ€è¦å¤„ç†å¤§é‡çš„éŸ³é¢‘æ•°æ®ï¼Œè€Œä¸”å¯¹å®æ—¶æ€§è¦æ±‚å¾ˆé«˜ã€‚</p><p>æˆ‘æ›¾ç»å‚ä¸è¿‡ä¸€ä¸ªè½¦è½½éŸ³å“é¡¹ç›®ï¼Œéœ€è¦å®ç°ä¸»åŠ¨é™å™ªåŠŸèƒ½ã€‚</p><p>åŸç†æ˜¯é€šè¿‡éº¦å…‹é£é‡‡é›†ç¯å¢ƒå™ªéŸ³ï¼Œç»è¿‡DSPå¤„ç†åï¼Œäº§ç”Ÿåç›¸å£°æ³¢æ¥æŠµæ¶ˆå™ªéŸ³ã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹éœ€è¦åœ¨å‡ æ¯«ç§’å†…å®Œæˆï¼Œå¦åˆ™é™å™ªæ•ˆæœä¼šå¤§æ‰“æŠ˜æ‰£ã€‚</p><p>éŸ³é¢‘å¤„ç†çš„å…¸å‹ç®—æ³•åŒ…æ‹¬FIRæ»¤æ³¢å™¨ã€IIRæ»¤æ³¢å™¨ã€FFTç­‰ã€‚</p><p>DSPå¯¹è¿™äº›ç®—æ³•éƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚</p><p>æ¯”å¦‚TIçš„C5000ç³»åˆ—ï¼Œä¸“é—¨é’ˆå¯¹éŸ³é¢‘åº”ç”¨ä¼˜åŒ–ï¼Œæä¾›äº†ä¸“ç”¨çš„éŸ³é¢‘å¤„ç†åº“ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„FIRæ»¤æ³¢å™¨ä»£ç ç¤ºä¾‹ï¼š</p><pre><code class="c">#define FILTER_LENGTH 64

float fir_coeffs[FILTER_LENGTH] = {
    // æ»¤æ³¢å™¨ç³»æ•°
    0.001, 0.002, 0.003, ...
};

float fir_buffer[FILTER_LENGTH] = {0};
int buffer_index = 0;

float FIR_Filter(float input)
{
    float output = 0;
    
    // æ›´æ–°ç¼“å†²åŒº
    fir_buffer[buffer_index] = input;
    buffer_index = (buffer_index + 1) % FILTER_LENGTH;
    
    // å·ç§¯è¿ç®—
    for(int i = 0; i &lt; FILTER_LENGTH; i++)
    {
        int index = (buffer_index - i + FILTER_LENGTH) % FILTER_LENGTH;
        output += fir_coeffs[i] * fir_buffer[index];
    }
    
    return output;
}</code></pre><p>åœ¨DSPä¸Šï¼Œè¿™ä¸ªå¾ªç¯å¯ä»¥é€šè¿‡ç¡¬ä»¶åŠ é€Ÿæˆ–è€…SIMDæŒ‡ä»¤æ¥ä¼˜åŒ–ï¼Œå¤§å¤§æé«˜è¿ç®—é€Ÿåº¦ã€‚</p><h3>4.3 å›¾åƒå¤„ç†</h3><p>å›¾åƒå¤„ç†ä¹Ÿæ˜¯DSPçš„é‡è¦åº”ç”¨ã€‚</p><p>åŒ…æ‹¬å›¾åƒå¢å¼ºã€è¾¹ç¼˜æ£€æµ‹ã€å›¾åƒå‹ç¼©ç­‰ã€‚è¿™äº›åº”ç”¨éœ€è¦å¤„ç†å¤§é‡çš„åƒç´ æ•°æ®ï¼Œè¿ç®—é‡éå¸¸å¤§ã€‚</p><p>åœ¨å·¥ä¸šè§†è§‰æ£€æµ‹é¡¹ç›®ä¸­ï¼Œç»å¸¸éœ€è¦å®æ—¶å¤„ç†æ‘„åƒå¤´é‡‡é›†çš„å›¾åƒã€‚</p><p>æ¯”å¦‚æ£€æµ‹äº§å“ç¼ºé™·ã€è¯†åˆ«äºŒç»´ç ç­‰ã€‚è¿™äº›ä»»åŠ¡å¦‚æœç”¨æ™®é€šMCUï¼Œå¤„ç†é€Ÿåº¦ä¼šå¾ˆæ…¢ã€‚</p><p>è€Œç”¨DSPï¼Œå¯ä»¥å®ç°å®æ—¶å¤„ç†ã€‚</p><p>å›¾åƒå¤„ç†çš„å…¸å‹ç®—æ³•åŒ…æ‹¬å·ç§¯ã€å½¢æ€å­¦è¿ç®—ã€éœå¤«å˜æ¢ç­‰ã€‚</p><p>è¿™äº›ç®—æ³•éƒ½æ¶‰åŠå¤§é‡çš„çŸ©é˜µè¿ç®—ï¼Œéå¸¸é€‚åˆDSPå¤„ç†ã€‚</p><h3>4.4 é€šä¿¡ä¿¡å·å¤„ç†</h3><p>åœ¨é€šä¿¡é¢†åŸŸï¼ŒDSPç”¨äºè°ƒåˆ¶è§£è°ƒã€ä¿¡é“ç¼–è§£ç ã€ä¿¡å·æ£€æµ‹ç­‰ã€‚</p><p>æ¯”å¦‚åœ¨4G/5GåŸºç«™ä¸­ï¼Œéœ€è¦å¤„ç†å¤§é‡çš„æ— çº¿ä¿¡å·ï¼Œè¿›è¡ŒOFDMè°ƒåˆ¶è§£è°ƒã€ä¿¡é“ä¼°è®¡ã€å‡è¡¡ç­‰æ“ä½œã€‚</p><p>è¿™äº›éƒ½éœ€è¦é«˜æ€§èƒ½çš„DSPæ¥å®Œæˆã€‚</p><p>è™½ç„¶æˆ‘æ²¡æœ‰ç›´æ¥åšè¿‡é€šä¿¡é¡¹ç›®ï¼Œä½†åœ¨æ±½è½¦ç”µå­é¡¹ç›®ä¸­ä¹Ÿæ¥è§¦è¿‡CANæ€»çº¿çš„ä¿¡å·å¤„ç†ã€‚</p><p>CANæ€»çº¿çš„ä½æ—¶åºæ£€æµ‹ã€é”™è¯¯æ£€æµ‹ç­‰ï¼Œè™½ç„¶ä¸å¦‚æ— çº¿é€šä¿¡å¤æ‚ï¼Œä½†ä¹Ÿéœ€è¦ç²¾ç¡®çš„æ—¶åºæ§åˆ¶ã€‚</p><h2>5. DSPå¼€å‘çš„æ³¨æ„äº‹é¡¹</h2><h3>5.1 å®šç‚¹è¿ç®—çš„æŠ€å·§</h3><p>å¦‚æœä½¿ç”¨å®šç‚¹DSPï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„æ•°å€¼ç²¾åº¦å’Œæº¢å‡ºé—®é¢˜ã€‚</p><p>å®šç‚¹è¿ç®—éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨ç®¡ç†å°æ•°ç‚¹ä½ç½®ï¼Œç¨ä¸æ³¨æ„å°±ä¼šå‡ºç°ç²¾åº¦æŸå¤±æˆ–è€…æº¢å‡ºã€‚</p><p>TIæä¾›çš„IQmathåº“æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œå®ƒç”¨æ•´æ•°è¿ç®—æ¨¡æ‹Ÿæµ®ç‚¹è¿ç®—ï¼Œæ—¢ä¿è¯äº†ç²¾åº¦åˆæé«˜äº†é€Ÿåº¦ã€‚</p><p>ä½¿ç”¨IQmathåº“æ—¶ï¼Œéœ€è¦å®šä¹‰æ•°æ®çš„Qæ ¼å¼ï¼Œæ¯”å¦‚Q15è¡¨ç¤º1ä½ç¬¦å·ä½ã€15ä½å°æ•°ä½ã€‚</p><pre><code class="c">// ä½¿ç”¨IQmathåº“çš„ç¤ºä¾‹
#include "IQmathLib.h"

_iq value1 = _IQ(1.5);      // å®šä¹‰ä¸€ä¸ªIQæ ¼å¼çš„æ•°ï¼Œå€¼ä¸º1.5
_iq value2 = _IQ(2.3);
_iq result = _IQmpy(value1, value2);  // IQæ ¼å¼çš„ä¹˜æ³•
float result_float = _IQtoF(result);  // è½¬æ¢ä¸ºæµ®ç‚¹æ•°</code></pre><h3>5.2 ä¼˜åŒ–ä»£ç æ€§èƒ½</h3><p>DSPå¼€å‘ä¸­ï¼Œä»£ç ä¼˜åŒ–éå¸¸é‡è¦ã€‚è¦å……åˆ†åˆ©ç”¨DSPçš„ç¡¬ä»¶ç‰¹æ€§ï¼Œæ¯”å¦‚ç¡¬ä»¶ä¹˜æ³•å™¨ã€å¾ªç¯ç¼“å†²åŒºã€DMAç­‰ã€‚</p><p>ç¼–è¯‘å™¨çš„ä¼˜åŒ–é€‰é¡¹ä¹Ÿè¦åˆç†è®¾ç½®ï¼Œé€šå¸¸å»ºè®®ä½¿ç”¨O2æˆ–O3ä¼˜åŒ–çº§åˆ«ã€‚</p><p>åœ¨ç¼–å†™å…³é”®ä»£ç æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ±‡ç¼–è¯­è¨€æˆ–è€…ç¼–è¯‘å™¨çš„å†…å»ºå‡½æ•°ï¼ˆintrinsicï¼‰æ¥æé«˜æ€§èƒ½ã€‚</p><p>æ¯”å¦‚TIçš„DSPæ”¯æŒå¾ˆå¤šå†…å»ºå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥æ˜ å°„åˆ°ç¡¬ä»¶æŒ‡ä»¤ã€‚</p><pre><code class="c">// ä½¿ç”¨å†…å»ºå‡½æ•°çš„ç¤ºä¾‹
#include &lt;c6x.h&gt;

int a = 10, b = 20;
int sum = _add2(a, b);  // ä½¿ç”¨å†…å»ºå‡½æ•°è¿›è¡ŒåŠ æ³•è¿ç®—</code></pre><h3>5.3 å®æ—¶æ€§ä¿è¯</h3><p>DSPåº”ç”¨é€šå¸¸å¯¹å®æ—¶æ€§è¦æ±‚å¾ˆé«˜ï¼Œéœ€è¦ä¿è¯åœ¨è§„å®šæ—¶é—´å†…å®Œæˆè¿ç®—ã€‚</p><p>è¿™å°±è¦æ±‚ç¨‹åºå‘˜åˆç†å®‰æ’ä»»åŠ¡ä¼˜å…ˆçº§ï¼Œé¿å…ä¸­æ–­åµŒå¥—è¿‡æ·±ï¼Œåˆç†ä½¿ç”¨DMAæ¥å‡è½»CPUè´Ÿæ‹…ã€‚</p><p>åœ¨æˆ‘åšç”µæœºæ§åˆ¶é¡¹ç›®æ—¶ï¼ŒFOCæ§åˆ¶ä»»åŠ¡çš„ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ï¼Œå¿…é¡»åœ¨æ¯ä¸ªPWMå‘¨æœŸå†…å®Œæˆã€‚</p><p>å…¶ä»–ä»»åŠ¡ï¼Œå¦‚é€šä¿¡ã€æ˜¾ç¤ºç­‰ï¼Œä¼˜å…ˆçº§è¾ƒä½ï¼Œå¯ä»¥åœ¨ç©ºé—²æ—¶é—´æ‰§è¡Œã€‚</p><p>è¿™æ ·å¯ä»¥ä¿è¯æ§åˆ¶ç®—æ³•çš„å®æ—¶æ€§ã€‚</p><h3>5.4 è°ƒè¯•æŠ€å·§</h3><p>DSPè°ƒè¯•ç›¸å¯¹å¤æ‚ï¼Œç‰¹åˆ«æ˜¯å®æ—¶æ€§è¦æ±‚é«˜çš„åº”ç”¨ã€‚</p><p>CCSæä¾›äº†å¾ˆå¤šè°ƒè¯•å·¥å…·ï¼Œå¦‚å®æ—¶è§‚å¯Ÿçª—å£ã€å›¾å½¢æ˜¾ç¤ºç­‰ã€‚</p><p>å¯ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶è§‚å¯Ÿå˜é‡çš„å˜åŒ–ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p><p>æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢ç”¨CCSçš„GraphåŠŸèƒ½ï¼Œå¯ä»¥å®æ—¶ç»˜åˆ¶æ³¢å½¢ã€‚</p><p>æ¯”å¦‚åœ¨è°ƒè¯•FOCç®—æ³•æ—¶ï¼Œå¯ä»¥å®æ—¶è§‚å¯Ÿç”µæµæ³¢å½¢ã€é€Ÿåº¦æ›²çº¿ç­‰ï¼Œç›´è§‚åœ°çœ‹åˆ°æ§åˆ¶æ•ˆæœã€‚</p><h2>6. æ€»ç»“ä¸å±•æœ›</h2><p>DSPä½œä¸ºä¸“ç”¨çš„ä¿¡å·å¤„ç†å™¨ï¼Œåœ¨ç”µæœºæ§åˆ¶ã€éŸ³é¢‘å¤„ç†ã€å›¾åƒå¤„ç†ç­‰é¢†åŸŸæœ‰ç€ä¸å¯æ›¿ä»£çš„ä½œç”¨ã€‚</p><p>é€‰æ‹©åˆé€‚çš„DSPï¼Œéœ€è¦ç»¼åˆè€ƒè™‘è¿ç®—æ€§èƒ½ã€å¤–è®¾æ¥å£ã€å¼€å‘å·¥å…·ã€æˆæœ¬ç­‰å¤šä¸ªå› ç´ ã€‚</p><p>éšç€æŠ€æœ¯çš„å‘å±•ï¼ŒDSPå’ŒMCUçš„ç•Œé™è¶Šæ¥è¶Šæ¨¡ç³Šã€‚</p><p>ç°åœ¨å¾ˆå¤šé«˜æ€§èƒ½MCUï¼Œå¦‚STM32H7ã€i.MX RTç³»åˆ—ï¼Œå·²ç»å…·å¤‡äº†ç›¸å½“å¼ºçš„ä¿¡å·å¤„ç†èƒ½åŠ›ã€‚</p><p>å¯¹äºä¸­ç­‰å¤æ‚åº¦çš„åº”ç”¨ï¼Œè¿™äº›MCUå®Œå…¨å¯ä»¥èƒœä»»ã€‚</p><p>ä½†å¯¹äºé«˜æ€§èƒ½ã€é«˜å®æ—¶æ€§çš„åº”ç”¨ï¼Œä¸“ç”¨DSPä»ç„¶æ˜¯æœ€ä½³é€‰æ‹©ã€‚</p><p>ä»æˆ‘ä¸ªäººçš„ç»éªŒæ¥çœ‹ï¼Œå¦‚æœé¡¹ç›®é¢„ç®—å……è¶³ï¼Œå¯¹æ€§èƒ½è¦æ±‚é«˜ï¼Œå»ºè®®é€‰æ‹©ä¸“ç”¨DSPã€‚</p><p>å¦‚æœé¢„ç®—æœ‰é™ï¼Œæˆ–è€…ä¿¡å·å¤„ç†éœ€æ±‚ä¸æ˜¯ç‰¹åˆ«å¤æ‚ï¼Œå¯ä»¥è€ƒè™‘é«˜æ€§èƒ½MCUã€‚</p><p>æ— è®ºé€‰æ‹©å“ªç§æ–¹æ¡ˆï¼Œéƒ½è¦å……åˆ†è¯„ä¼°éœ€æ±‚ï¼Œåšå¥½æŠ€æœ¯éªŒè¯ï¼Œç¡®ä¿é€‰å‹çš„æ­£ç¡®æ€§ã€‚</p><p>æœ€åï¼ŒDSPå¼€å‘ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦æ‰å®çš„æ•°å­¦åŸºç¡€å’Œä¸°å¯Œçš„å®è·µç»éªŒã€‚</p><p>å»ºè®®åˆå­¦è€…ä»ç®€å•çš„åº”ç”¨å…¥æ‰‹ï¼Œé€æ­¥æ·±å…¥ã€‚TIã€ADIç­‰å‚å•†æä¾›äº†å¤§é‡çš„å­¦ä¹ èµ„æºå’Œç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥å¤šåŠ åˆ©ç”¨ã€‚</p><p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ï¼Œåœ¨DSPé€‰å‹å’Œåº”ç”¨ä¸­å°‘èµ°å¼¯è·¯ã€‚</p><p><strong>æ›´å¤šç¼–ç¨‹å­¦ä¹ èµ„æº</strong></p><ul><li><a href="https://link.segmentfault.com/?enc=zgrXwNaCbJ6DdBfVo5bL8A%3D%3D.BhfOI3ZmVNrOvSGFQrl0GRmbMEMerJD2uJXcw5VkdbirWeo%2F%2B9qM%2BKoFaO3WtCFBo4IdTvUBrLP0k2FZtJrA7A%3D%3D" rel="nofollow" target="_blank">Cè¯­è¨€é›¶åŸºç¡€å…¥é—¨ç”µå­ä¹¦-2026æœ€æ–°ç‰ˆ</a></li><li><a href="https://link.segmentfault.com/?enc=B5WFeyRQQ683lcxHJItS6A%3D%3D.sHPxCTd8ps5rawDnsjXg9ZWmrrZAIOg0%2Ft%2BdjUDfxxX5BUuyL2d8oexURRrVBFj5EX7DTDZ5E9N9POVaqvbB7Q%3D%3D" rel="nofollow" target="_blank">STM32é›¶åŸºç¡€å…¥é—¨ç”µå­ä¹¦-2026æœ€æ–°ç‰ˆ</a></li><li><a href="https://link.segmentfault.com/?enc=YaCx%2Fy7LniHRE9yqRC%2BCzw%3D%3D.W6Z7J0uD%2FZoX146apxA%2FY6zhc%2BEJMxbITfBeDVcSs%2B7sonQT7D0jOYHe4h1ZbQbE82PBc4Ll9GCghOMAV%2F1nlDNbMDW1LBRYD96JWo1YlpQ%3D" rel="nofollow" target="_blank">FreeRTOSé›¶åŸºç¡€å…¥é—¨ç”µå­ä¹¦-2026æœ€æ–°ç‰ˆ</a></li><li><a href="https://link.segmentfault.com/?enc=bMKSnQW9vANV3YbaKKFZoA%3D%3D.yH0xXgXk0PanQTPDO%2FqPsQTAjTf5dY51F7DE7rLmTmd0Dr3F92hthNR57qH9sZr5UdwyCi1SEmR37m327od6vw%3D%3D" rel="nofollow" target="_blank">C++ é›¶åŸºç¡€å…¥é—¨ç”µå­ä¹¦-2026æœ€æ–°ç‰ˆ</a></li><li><a href="https://link.segmentfault.com/?enc=IWks4%2BmEzp36BjKiomD4vA%3D%3D.r7R3iG2six5ZT3rFJqOLniD%2BHkUT2WgN1PtnWptEfzJtIibgEm8Fgwn%2FRXr563jqlD%2BSUngb3t3NCdW1fXutGg%3D%3D" rel="nofollow" target="_blank">51å•ç‰‡æœºé›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=NLFtJ3E4IqfgkhNPtfhIoQ%3D%3D.GUfL0di%2BrvGCsFn0gFZO%2FQX%2B6ugJZOPSZR29PBQ1B3PDkmAFWYYvZvGBL67zKJ2km32emOmSe0Y3%2Br2y7KbHuQ%3D%3D" rel="nofollow" target="_blank">ADç”»æ¿é›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=Itri39KXodsMLt5H%2B04%2B7Q%3D%3D.7JwWaLevi4MLmLY1JzGHNknFTmpfZAbwzYwS1tho5gyV7EkPn16QNB4ocpsz2Q9XeYep%2FDea2OJSkt5w84ygLA%3D%3D" rel="nofollow" target="_blank">Cè¯­è¨€é›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=t1%2B0nsH5y7Int0tl%2Fp4pgQ%3D%3D.Z2wqhDIj2tPYfBPIPjPdJqhri0Yal6E0gyxU%2F4ytb7t1ewVMAg%2Bdnxik%2FVmAxba5gPuYSsNNVH0e%2FEL%2Fnx4Rhw%3D%3D" rel="nofollow" target="_blank">C++è¯­è¨€é›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=rUhOHQeAJe8IvIA8vZyzvA%3D%3D.5fDIvYmNxI%2BxR5JJr99hIj58UsE3MNUpi5i93%2FZdOhMm05zvNqFVAsg7gL%2BZ2FAnBZNfXqgvNu8Z018KqfXHl5wTfpthQBTslUoBL8f%2Fbr8%3D" rel="nofollow" target="_blank">ESP32é›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=1lYaGMySI7YRAT9203Nzsg%3D%3D.cGaxXhVcdQa45mvS4sWZFVlS0ab5qmwHYRVzoJ5HOXM%2Fsr23vZpBHJ83I5RwUZ%2F6i%2FvbYIy7U2MlM9TYIQRlHiaQU%2BSr%2FY2JYFkuHWBdwPg%3D" rel="nofollow" target="_blank">FreeRTOSé›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=36ENAnbYUyX05PZzTur6qw%3D%3D.1Ng%2FOlR0n1S3ncufb%2FVxMkfNySPPY90Q6pr61B49%2BO6NdUHfFr%2FJADXApY5H%2BG9jeqy0i3pOSZ%2BGkXP2htTn82D9upbjUYPdQmsBz9DTd%2BI%3D" rel="nofollow" target="_blank">Linuxåº”ç”¨å¼€å‘é›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=3KMKKfbyoPdJ9gU3q7aGVw%3D%3D.ButSLUv7%2FzQmQ8hKymkjDmGLMPpkA%2BXJ%2BysZAeYixVVdLLMR0O3QDewaQegbqeizB4cogDQBprf2rNDxdoV%2BBs5SFKSMDdR6h0Wa3Fo28ic%3D" rel="nofollow" target="_blank">Linuxåº•å±‚å¼€å‘é›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=UiWyVJtotcrei7JmjMDTKg%3D%3D.8eVE%2FF%2B9V9rB9SdHq1XUAdhFg%2FeB8rjHQ%2FwZgcSjEirJOFU%2BNa0dJoMOkVjiYuUVxJDPDWlo1ZLEt0MgZR9JJQ%3D%3D" rel="nofollow" target="_blank">LVGLé›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=wndiL874FdbuRKK9JzNXzQ%3D%3D.k1ygUffh9A7AZK7nmrxkTOjGXwK4rx%2BtEAQMsyY7Hte6dxrrf93xWmVxNPgRmMO8z%2Blc3De9C5o7tRf%2FOTrFKA%3D%3D" rel="nofollow" target="_blank">QTé›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li><li><a href="https://link.segmentfault.com/?enc=aQX4BO1d7UpNTePJGaYihw%3D%3D.E9GZxohaCjndnWQaDOAm6%2FGU%2BVaFb1KWfbmXPQ177zHvkvJJe%2Bjv5tWC7%2FfHy1jOW%2F%2B2tVTfVvOF09UzhZhpsy0B05AiExEbtuV2tiqwzow%3D" rel="nofollow" target="_blank">STM32é›¶åŸºç¡€å…¥é—¨å­¦ä¹ è·¯çº¿</a></li></ul>]]></description></item><item>    <title><![CDATA[WonderPen for Mac v2.3.5.7074ç å­—å·¥å…·å®‰è£…æ­¥éª¤è¯¦è§£ å°ç«¥ç«¥ ]]></title>    <link>https://segmentfault.com/a/1190000047585473</link>    <guid>https://segmentfault.com/a/1190000047585473</guid>    <pubDate>2026-02-01 11:02:10</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>â€‹</p><h4>WonderPen æ˜¯ä¸€æ¬¾ä¸“é—¨ç»™å†™ä½œè€…ç”¨çš„ç å­—å·¥å…·ï¼Œç•Œé¢å¹²å‡€ã€æ“ä½œç®€å•ï¼Œå¾ˆé€‚åˆå†™å°è¯´ã€å‰§æœ¬ã€é•¿æ–‡æˆ–è€…åšç¬”è®°ã€‚</h4><h4><strong>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½å®‰è£…åŒ…</strong>â€‹</h4><p><strong>å®‰è£…åŒ…ä¸‹è½½ï¼š</strong> <a href="https://link.segmentfault.com/?enc=UtdXb2ZC6IzCAU26Yh%2BrCA%3D%3D.OB7wmy%2FsfX1uTn32nFDsv7dyINEvxHeTK56FsShHIHepvhxNdNi5BmVZp9JDD1sW" rel="nofollow" title="https://pan.quark.cn/s/0769a09c9296" target="_blank">https://pan.quark.cn/s/0769a09c9296Â </a>ï¼Œæ‰¾åˆ°Â <code>WonderPen for Mac v2.3.5.7074.dmg</code>è¿™ä¸ªæ–‡ä»¶ï¼Œç‚¹ä¸‹è½½ã€‚ç­‰å®ƒä¸‹å®Œï¼Œä¸€èˆ¬ä¼šåœ¨ã€Œä¸‹è½½ã€æ–‡ä»¶å¤¹é‡Œèººç€ã€‚</p><h4><strong>ç¬¬äºŒæ­¥ï¼šæ‰“å¼€dmgæ–‡ä»¶</strong>â€‹</h4><p>æ‰¾åˆ°åˆšä¸‹è½½çš„Â <code>.dmg</code>æ–‡ä»¶ï¼ŒåŒå‡»å®ƒï¼è¿™æ—¶å€™ä¼šå¼¹å‡ºä¸€ä¸ªæ–°çª—å£ï¼Œé‡Œé¢èƒ½çœ‹åˆ°ä¸€ä¸ªå«ã€ŒWonderPenã€çš„å›¾æ ‡ï¼ˆå¯èƒ½æ˜¯è½¯ä»¶logoï¼‰ï¼Œæ—è¾¹è¿˜æœ‰ä¸ªç®­å¤´æŒ‡å‘ã€Œåº”ç”¨ç¨‹åºã€æ–‡ä»¶å¤¹ã€‚</p><h4><strong>ç¬¬ä¸‰æ­¥ï¼šæ‹–åˆ°åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹</strong>â€‹</h4><p>ç›´æ¥æŒ‰ä½é‚£ä¸ªã€ŒWonderPenã€å›¾æ ‡ï¼Œå¾€å³è¾¹çš„ã€Œåº”ç”¨ç¨‹åºã€æ–‡ä»¶å¤¹é‡Œæ‹–å°±è¡Œï½ æ‹–å®Œç­‰å‡ ç§’ï¼Œçœ‹åˆ°è¿›åº¦æ¡èµ°å®Œï¼Œå°±è¯´æ˜å¤åˆ¶å¥½äº†ã€‚</p><h4><strong>ç¬¬å››æ­¥ï¼šè¿è¡Œè½¯ä»¶</strong>â€‹</h4><p>ç°åœ¨æ‰“å¼€ã€Œè®¿è¾¾ã€ï¼Œè¿›å·¦è¾¹çš„ã€Œåº”ç”¨ç¨‹åºã€æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°ã€ŒWonderPenã€å›¾æ ‡ï¼ŒåŒå‡»æ‰“å¼€ã€‚ç¬¬ä¸€æ¬¡æ‰“å¼€å¯èƒ½ä¼šè·³æç¤ºè¯´â€œæ¥è‡ªæœªçŸ¥å¼€å‘è€…â€ï¼ˆMacçš„å®‰å…¨æœºåˆ¶ï¼‰ï¼Œåˆ«æ…Œï¼ç‚¹ä¸€ä¸‹æç¤ºæ¡†é‡Œçš„ã€Œä»è¦æ‰“å¼€ã€ï¼Œç¡®è®¤åå°±èƒ½æ­£å¸¸ç”¨äº†ï½</p><p>â€‹</p>]]></description></item><item>    <title><![CDATA[(LLMç³»åˆ—)ç†è§£Tokenï¼šä¸ºä»€ä¹ˆæˆ‘çš„APIè´¹ç”¨è¿™ä¹ˆé«˜ï¼Ÿ ê¯­ê¯­å¬ê¯­é£ê¯­è€…ê¯­ ]]></title>    <link>https://segmentfault.com/a/1190000047585476</link>    <guid>https://segmentfault.com/a/1190000047585476</guid>    <pubDate>2026-02-01 11:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>åœ¨å½“ä»Šçš„AIæ—¶ä»£ï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å·²æˆä¸ºå„ç§åº”ç”¨çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ç„¶è€Œï¼Œå¾ˆå¤šå¼€å‘è€…åœ¨ä½¿ç”¨APIæ—¶å¸¸å¸¸æ„Ÿåˆ°å›°æƒ‘ï¼šä¸ºä»€ä¹ˆAPIè´¹ç”¨å¦‚æ­¤ä¹‹é«˜ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå¾€å¾€æŒ‡å‘ä¸€ä¸ªå…³é”®æ¦‚å¿µï¼šTokenã€‚</p><h2>ä»€ä¹ˆæ˜¯Tokenï¼Ÿ</h2><p>Tokenæ˜¯è¡¡é‡æ–‡æœ¬é•¿åº¦çš„åŸºæœ¬å•ä½ï¼Œä½†ä¸æˆ‘ä»¬ç†Ÿæ‚‰çš„å­—ç¬¦ã€å•è¯æˆ–å¥å­ä¸åŒã€‚TokenåŒ–ï¼ˆTokenizationï¼‰æ˜¯å°†äººç±»è¯­è¨€è½¬æ¢ä¸ºæœºå™¨å¯å¤„ç†å•å…ƒçš„è¿‡ç¨‹ã€‚ä¸€ä¸ªTokenå¯ä»¥æ˜¯ä¸€ä¸ªè¯ã€ä¸€ä¸ªå­è¯ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œå…·ä½“å–å†³äºæ¨¡å‹ä½¿ç”¨çš„åˆ†è¯ç®—æ³•ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨è‹±è¯­ä¸­ï¼Œ"hello"å¯èƒ½è¢«è§†ä¸ºä¸€ä¸ªTokenï¼Œè€Œ"unbelievable"å¯èƒ½ä¼šè¢«åˆ†å‰²æˆ"un"ã€"believe"ã€"able"ç­‰å¤šä¸ªTokenã€‚åœ¨ä¸­æ–‡ä¸­ï¼Œå•ä¸ªæ±‰å­—é€šå¸¸ä½œä¸ºä¸€ä¸ªTokenï¼Œä½†å¤æ‚çš„è¯è¯­ä¹Ÿå¯èƒ½è¢«è¿›ä¸€æ­¥æ‹†åˆ†ã€‚</p><h2>Tokenè®¡è´¹æ¨¡å¼</h2><p>å¤§å¤šæ•°å¤§è¯­è¨€æ¨¡å‹APIé‡‡ç”¨åŸºäºTokençš„è®¡è´¹æ¨¡å¼ï¼Œè¿™é€šå¸¸åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><ol><li><strong>è¾“å…¥Token</strong>ï¼šç”¨æˆ·å‘é€çš„æç¤ºï¼ˆPromptï¼‰æ‰€å ç”¨çš„Tokenæ•°é‡</li><li><strong>è¾“å‡ºToken</strong>ï¼šæ¨¡å‹ç”Ÿæˆçš„å›å¤æ‰€å ç”¨çš„Tokenæ•°é‡</li></ol><p>ä»¥OpenAIä¸ºä¾‹ï¼ŒGPT-4çš„å®šä»·å¤§çº¦æ˜¯æ¯1000ä¸ªè¾“å…¥Tokenæ”¶è´¹$0.01ï¼Œæ¯1000ä¸ªè¾“å‡ºTokenæ”¶è´¹$0.03ã€‚é˜¿é‡Œäº‘é€šä¹‰åƒé—®ç­‰å›½å†…æ¨¡å‹ä¹Ÿæœ‰ç±»ä¼¼çš„è®¡è´¹æ¨¡å¼ã€‚</p><h2>è´¹ç”¨é«˜æ˜‚çš„ä¸»è¦åŸå› </h2><p>äº†è§£äº†Tokençš„åŸºæœ¬æ¦‚å¿µå’Œè®¡è´¹æ¨¡å¼åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆAPIè´¹ç”¨æœ‰æ—¶ä¼šå‡ºä¹æ„æ–™åœ°é«˜æ˜‚ã€‚ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªå› ç´ ï¼š</p><h3>Tokené•¿åº¦ç›´æ¥å½±å“æˆæœ¬</h3><p>APIè´¹ç”¨ä¸Tokenæ•°é‡æˆæ­£æ¯”ã€‚ä¸€ä¸ªåŒ…å«1000ä¸ªTokençš„è¯·æ±‚ï¼ˆè¾“å…¥+è¾“å‡ºï¼‰å°†å§‹ç»ˆæ¯”ä¸€ä¸ªåŒ…å«100ä¸ªTokençš„è¯·æ±‚æˆæœ¬é«˜10å€ã€‚ç‰¹åˆ«æ˜¯å½“ä½ çš„åº”ç”¨éœ€è¦å¤„ç†å¤§é‡æ–‡æœ¬æˆ–ç”Ÿæˆè¾ƒé•¿å›å¤æ—¶ï¼Œè´¹ç”¨ä¼šè¿…é€Ÿç´¯ç§¯ã€‚</p><h3>é¢‘ç¹çš„APIè°ƒç”¨</h3><p>å³ä½¿å•æ¬¡è°ƒç”¨æˆæœ¬ä¸é«˜ï¼Œä½†å¦‚æœåº”ç”¨æ¯å¤©å¤„ç†æ•°åƒæˆ–æ•°ä¸‡ä¸ªè¯·æ±‚ï¼Œè´¹ç”¨ä¹Ÿä¼šè¿…é€Ÿå¢åŠ ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¯å¤©å¤„ç†10,000ä¸ªè¯·æ±‚çš„åº”ç”¨ï¼Œæ¯ä¸ªè¯·æ±‚å¹³å‡æ¶ˆè€—1000ä¸ªTokenï¼Œæ¯æœˆçš„è´¹ç”¨å¯èƒ½é«˜è¾¾æ•°ç™¾ç¾å…ƒã€‚</p><h3>ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡</h3><p>åœ¨æ„å»ºå¯¹è¯ç³»ç»Ÿæ—¶ï¼Œå¸¸è§çš„åšæ³•æ˜¯å°†æ•´ä¸ªå¯¹è¯å†å²å‘é€ç»™æ¨¡å‹ï¼Œä»¥ä¿æŒä¸Šä¸‹æ–‡è¿è´¯æ€§ã€‚ç„¶è€Œï¼Œè¿™ä¼šå¯¼è‡´Tokenæ•°é‡çº¿æ€§å¢é•¿ï¼Œå¤§å¤§å¢åŠ æˆæœ¬ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåŒ…å«10è½®å¯¹è¯çš„è¯·æ±‚ï¼Œå…¶Tokenæ•°é‡å¯èƒ½æ˜¯å•è½®å¯¹è¯çš„10å€ã€‚</p><h2>æˆæœ¬ä¼˜åŒ–ç­–ç•¥</h2><p>äº†è§£äº†è´¹ç”¨é«˜æ˜‚çš„åŸå› åï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹æ€§åœ°é‡‡å–ä¸€äº›ä¼˜åŒ–æªæ–½æ¥é™ä½APIæˆæœ¬ã€‚ä»¥ä¸‹æ˜¯å‡ ç§æœ‰æ•ˆçš„æˆæœ¬æ§åˆ¶ç­–ç•¥ï¼š</p><h3>åˆç†æ§åˆ¶ä¸Šä¸‹æ–‡é•¿åº¦</h3><p>ä¸è¦ç›²ç›®åœ°å°†æ•´ä¸ªå¯¹è¯å†å²å‘é€ç»™æ¨¡å‹ã€‚è€ƒè™‘ä»¥ä¸‹ç­–ç•¥ï¼š</p><ul><li><strong>æ»‘åŠ¨çª—å£</strong>ï¼šåªä¿ç•™æœ€è¿‘å‡ è½®å¯¹è¯</li><li><strong>æ‘˜è¦æå–</strong>ï¼šå®šæœŸå°†æ—©æœŸå¯¹è¯æ‘˜è¦æˆç®€çŸ­çš„ä¸Šä¸‹æ–‡</li><li><strong>æ™ºèƒ½æˆªæ–­</strong>ï¼šæ ¹æ®é‡è¦æ€§ä¿ç•™å…³é”®ä¿¡æ¯</li></ul><h3>é¢„ä¼°å’Œé™åˆ¶Tokenä½¿ç”¨</h3><p>åœ¨å®é™…è°ƒç”¨APIä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨ä¸“é—¨çš„åº“æ¥ä¼°ç®—Tokenæ•°é‡ã€‚è¿™æ ·å¯ä»¥åœ¨å‘é€è¯·æ±‚å‰é¢„çŸ¥å¯èƒ½äº§ç”Ÿçš„è´¹ç”¨ï¼Œä»è€Œæ›´å¥½åœ°æ§åˆ¶é¢„ç®—ã€‚</p><h3>é€‰æ‹©åˆé€‚çš„æ¨¡å‹</h3><p>ä¸åŒçš„æ¨¡å‹æœ‰ä¸åŒçš„å®šä»·ã€‚å¯¹äºç®€å•ä»»åŠ¡ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è¾ƒå°çš„æ¨¡å‹ï¼ˆå¦‚Qwen-Miniï¼‰ï¼Œè€Œå¯¹äºå¤æ‚ä»»åŠ¡å†ä½¿ç”¨è¾ƒå¤§çš„æ¨¡å‹ï¼ˆå¦‚Qwen-Maxï¼‰ã€‚</p><h3>æ‰¹å¤„ç†è¯·æ±‚</h3><p>å¦‚æœåº”ç”¨åœºæ™¯å…è®¸ï¼Œå¯ä»¥å°†å¤šä¸ªå°è¯·æ±‚åˆå¹¶ä¸ºä¸€ä¸ªæ‰¹å¤„ç†è¯·æ±‚ï¼Œä»è€Œå‡å°‘APIè°ƒç”¨æ¬¡æ•°å’Œæ€»ä½“è´¹ç”¨ã€‚</p><h3>ç¼“å­˜å¸¸è§å“åº”</h3><p>å¯¹äºç»å¸¸è¢«è¯¢é—®çš„é—®é¢˜ï¼Œå¯ä»¥å»ºç«‹ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤çš„APIè°ƒç”¨ã€‚</p><h2>å®è·µä¸­çš„Tokenç›‘æ§ä¸åº”ç”¨</h2><p>ç†è®ºçŸ¥è¯†å›ºç„¶é‡è¦ï¼Œä½†åœ¨å®é™…é¡¹ç›®ä¸­å¦‚ä½•åº”ç”¨è¿™äº›ä¼˜åŒ–ç­–ç•¥åŒæ ·å…³é”®ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£å’Œæ§åˆ¶Tokenä½¿ç”¨ï¼Œæˆ‘ä»¬å¼€å‘äº†Qwen Chatboté¡¹ç›®ï¼Œå®ç°äº†å®æ—¶Tokenç›‘æ§åŠŸèƒ½ã€‚è¿™ä¸€éƒ¨åˆ†å°†ä»‹ç»å¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­ç›‘æ§å’Œç®¡ç†Tokenä½¿ç”¨ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°æŒæ¡æˆæœ¬æ§åˆ¶æŠ€å·§ã€‚</p><h3>Tokenç›‘æ§å®ç°åŸç†</h3><p>é€šè¿‡åœ¨APIå“åº”ä¸­å¯ç”¨<code>stream_options: { include_usage: true }</code>ï¼Œæˆ‘ä»¬å¯ä»¥è·å–è¯¦ç»†çš„Tokenä½¿ç”¨æƒ…å†µï¼š</p><ul><li>è¾“å…¥Tokenï¼ˆprompt_tokensï¼‰ï¼šè¡¨ç¤ºå‘é€ç»™æ¨¡å‹çš„æç¤ºé•¿åº¦</li><li>è¾“å‡ºTokenï¼ˆcompletion_tokensï¼‰ï¼šè¡¨ç¤ºæ¨¡å‹ç”Ÿæˆçš„å›å¤é•¿åº¦</li><li>æ€»Tokenï¼ˆtotal_tokensï¼‰ï¼šä¸¤è€…çš„æ€»å’Œ</li></ul><p>è¿™ç§å®æ—¶ç›‘æ§æœ‰åŠ©äºå¼€å‘è€…ç›´è§‚åœ°ç†è§£æˆæœ¬æ„æˆï¼Œå¹¶æ®æ­¤ä¼˜åŒ–åº”ç”¨é€»è¾‘ã€‚</p><h3>ç¤ºä¾‹é¡¹ç›®åŠŸèƒ½</h3><p>æˆ‘ä»¬ä¸ºQwen Chatboté¡¹ç›®æ·»åŠ äº†å®Œæ•´çš„Tokenè®¡æ•°åŠŸèƒ½ï¼š</p><ol><li><strong>åç«¯æ”¹è¿›</strong>ï¼šåœ¨APIå“åº”ä¸­æ·»åŠ äº†Tokenä½¿ç”¨æƒ…å†µç»Ÿè®¡ï¼Œæ”¯æŒæµå¼å’Œéæµå¼å“åº”çš„Tokenè®¡æ•°</li><li><strong>å‰ç«¯æ”¹è¿›</strong>ï¼šåœ¨èŠå¤©ç•Œé¢ä¸­å®æ—¶æ˜¾ç¤ºæ¯æ¡æ¶ˆæ¯çš„Tokenä½¿ç”¨è¯¦æƒ…</li><li><strong>æ–‡æ¡£æ›´æ–°</strong>ï¼šåœ¨READMEä¸­æ·»åŠ äº†Tokenè®¡æ•°åŠŸèƒ½çš„è¯´æ˜å’Œä½¿ç”¨æŒ‡å—</li></ol><h2>æ€»ç»“</h2><p>ç†è§£Tokenæœºåˆ¶æ˜¯æœ‰æ•ˆæ§åˆ¶AI APIè´¹ç”¨çš„å…³é”®ã€‚è™½ç„¶Tokenè®¡è´¹æ¨¡å¼çœ‹èµ·æ¥å¯èƒ½å¾ˆæ˜‚è´µï¼Œä½†å®ƒå®é™…ä¸Šæ˜¯ä¸€ç§å…¬å¹³çš„å®šä»·æ–¹å¼ï¼Œè®©å¼€å‘è€…åªä¸ºå®é™…ä½¿ç”¨çš„èµ„æºä»˜è´¹ã€‚é€šè¿‡æœ¬æ–‡ä»‹ç»çš„æˆæœ¬ä¼˜åŒ–ç­–ç•¥å’Œå®é™…ç›‘æ§æ–¹æ³•ï¼Œå¼€å‘è€…å¯ä»¥åœ¨ä¿è¯æœåŠ¡è´¨é‡çš„åŒæ—¶æœ‰æ•ˆæ§åˆ¶è´¹ç”¨ã€‚</p><p>æ­¤å¤–ï¼Œé€šè¿‡Qwen Chatbotç¤ºä¾‹é¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨å®é™…åº”ç”¨ä¸­å¦‚ä½•å®æ–½è¿™äº›ä¼˜åŒ–ç­–ç•¥ã€‚æŒæ¡Tokençš„ä½¿ç”¨å’Œç›‘æ§ä¸ä»…æœ‰åŠ©äºæ§åˆ¶æˆæœ¬ï¼Œè¿˜èƒ½æé«˜åº”ç”¨çš„æ•´ä½“æ•ˆç‡ã€‚</p><h3>ç›¸å…³èµ„æº</h3><ul><li><a href="https://link.segmentfault.com/?enc=o%2By6RlSAyywk1mF0hJoj8Q%3D%3D.2V4rItXYKbkwLh9IpD37H7jkq9pVfrXMdbSiipoYx28AXnO%2BgbLvXEqgfhHMI48KVkarQu2FesvpZOQiloe1VA%3D%3D" rel="nofollow" target="_blank">https://github.com/jianzhang96/llm/tree/main/qwen-chatbot</a></li><li><a href="https://link.segmentfault.com/?enc=Ld1K17fPdDnfdBZ8tHlocg%3D%3D.ceFqO0DmFm%2BJVTY0t82nvJw5FmR1XgoiJz%2F%2Fq17a2UIXvhI1TvzvZkKPSRQfvO9DAfHK7UuW5LK7J6hLfq1I2Q%3D%3D" rel="nofollow" target="_blank">https://gitee.com/codehub/llm/tree/main/qwen-chatbot</a></li></ul><p>è¯¥é¡¹ç›®å±•ç¤ºäº†å¦‚ä½•åœ¨å®é™…åº”ç”¨ä¸­ç›‘æ§Tokenä½¿ç”¨ï¼Œä¸ºå¼€å‘è€…æä¾›äº†å®ç”¨çš„æˆæœ¬ä¼˜åŒ–å‚è€ƒã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585478" alt="" title=""/></p>]]></description></item><item>    <title><![CDATA[Charlesç½‘ç»œæŠ“åŒ…è½¯ä»¶æ€ä¹ˆç”¨ï¼Ÿå®Œæ•´å®‰è£…ä¸ä½¿ç”¨æŒ‡å— å°ç«¥ç«¥ ]]></title>    <link>https://segmentfault.com/a/1190000047585448</link>    <guid>https://segmentfault.com/a/1190000047585448</guid>    <pubDate>2026-02-01 10:02:14</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>â€‹</p><p><strong>Charles</strong>â€‹ æ˜¯ä¸ª<strong>ç½‘ç»œæŠ“åŒ…å·¥å…·</strong>ï¼Œèƒ½æŠ“å–ç”µè„‘ã€æ‰‹æœºã€æ¨¡æ‹Ÿå™¨ç­‰è®¾å¤‡çš„ HTTP/HTTPS è¯·æ±‚å’Œå“åº”æ•°æ®ã€‚</p><h3>1. ä¸‹è½½å®‰è£…åŒ…</h3><p><strong>å®‰è£…åŒ…ä¸‹è½½ï¼š</strong><a href="https://link.segmentfault.com/?enc=4mKuVqaSmsDaJ3pqOaRrsA%3D%3D.4jPQ1qezleRmpwhurmpirN9aV7cn7Hw9fpriQ26ac3t5XeB2uEWdZkk%2FgEMaSP3J" rel="nofollow" title="https://pan.quark.cn/s/6cdad20f43dc" target="_blank">https://pan.quark.cn/s/6cdad20f43dc</a></p><p>ä¸‹è½½å®Œæ”¾æ¡Œé¢æˆ–è€…ä¸€ä¸ªå®¹æ˜“æ‰¾çš„æ–‡ä»¶å¤¹é‡Œã€‚</p><h3>2. åŒå‡»è¿è¡Œ</h3><p>æ‰¾åˆ°åˆšä¸‹è½½çš„ <code>Charlesç½‘ç»œæŠ“åŒ…è½¯ä»¶.msi</code>ï¼Œç›´æ¥åŒå‡»å®ƒã€‚</p><p>ç¬¬ä¸€æ¬¡å¯èƒ½ä¼šå¼¹å‡ºå®‰å…¨æç¤ºï¼Œç‚¹ <strong>â€œæ˜¯â€</strong> â€‹ æˆ– <strong>â€œå…è®¸â€</strong> ï¼Œè®©å®ƒç»§ç»­ã€‚</p><h3>3. å¼€å§‹å®‰è£…å‘å¯¼</h3><p>å‡ºæ¥å®‰è£…ç•Œé¢åï¼Œä¸€è·¯ç‚¹ <strong>Next</strong>ï¼ˆä¸‹ä¸€æ­¥ï¼‰ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«è¦æ”¹çš„ï¼Œä¿æŒé»˜è®¤å°±è¡Œã€‚</p><p>å¦‚æœè®©ä½ é€‰å®‰è£…ä½ç½®ï¼Œå¯ä»¥æ”¹æˆè‡ªå·±æƒ³æ”¾çš„ç›˜ï¼Œæ¯”å¦‚ D:\Program Files\Charlesï¼Œä¸æ”¹ä¹Ÿè¡Œã€‚</p><h3>4. ç­‰å¾…å®‰è£…å®Œæˆ</h3><p>å®ƒä¼šè‡ªåŠ¨å¤åˆ¶æ–‡ä»¶ï¼Œç­‰è¿›åº¦æ¡èµ°å®Œã€‚æœŸé—´åˆ«ä¹±ç‚¹åˆ«çš„ï¼Œå…å¾—å¡ä½ã€‚</p><p>å®Œæˆåï¼Œå‹¾ä¸Š <strong>Launch Charles</strong>ï¼ˆå¯åŠ¨ç¨‹åºï¼‰å†ç‚¹ <strong>Finish</strong>ã€‚</p><h3>5. é¦–æ¬¡è¿è¡Œè®¾ç½®</h3><p>ç¬¬ä¸€æ¬¡æ‰“å¼€ Charlesï¼Œä¼šé—®ä½ æ˜¯å¦å…è®¸å®ƒè‡ªåŠ¨é…ç½®ä»£ç†ï¼Œä¸€èˆ¬ç‚¹ <strong>Allow</strong>ï¼ˆå…è®¸ï¼‰å°±å¥½ï¼Œè¿™æ ·æµè§ˆå™¨æµé‡æ‰èƒ½æŠ“åˆ°ã€‚</p><p>å¦‚æœæ˜¯ HTTPS æŠ“åŒ…ï¼Œåé¢è¿˜è¦è£…å®ƒçš„ SSL è¯ä¹¦ï¼Œè¿™ä¸ªå¯ä»¥å¦å¤–æœæ•™ç¨‹ï¼Œè¿™é‡Œå…ˆä¸å±•å¼€ã€‚</p><h3>6. æ£€æŸ¥æ˜¯å¦å¯ç”¨</h3><p>æ‰“å¼€ Charles åï¼Œç•Œé¢èƒ½çœ‹åˆ°è¿æ¥è®¾å¤‡å’Œè¯·æ±‚åˆ—è¡¨ï¼Œè¯´æ˜è£…å¥½äº†ã€‚</p><p>éšä¾¿å¼€ä¸ªç½‘é¡µï¼Œå°±èƒ½åœ¨ Charles é‡Œçœ‹åˆ°æŠ“åˆ°çš„æ•°æ®åŒ…ã€‚</p><p>â€‹</p>]]></description></item><item>    <title><![CDATA[é«˜æ•ˆæ²Ÿé€šæ–°å·¥å…·ï¼šè®¿ç­”çš„æ·±åº¦è§£æ é«˜å¤§çš„å°ç¬¼åŒ… ]]></title>    <link>https://segmentfault.com/a/1190000047585452</link>    <guid>https://segmentfault.com/a/1190000047585452</guid>    <pubDate>2026-02-01 10:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>é«˜æ•ˆæ²Ÿé€šæ–°å·¥å…·ï¼š<strong>è®¿ç­”</strong>çš„æ·±åº¦è§£æ</h2><p>åœ¨å½“ä»Šå¿«èŠ‚å¥çš„å·¥ä½œç¯å¢ƒä¸­ï¼Œé«˜æ•ˆçš„æ²Ÿé€šå·¥å…·å¯¹äºå›¢é˜Ÿåä½œè‡³å…³é‡è¦ã€‚å¸‚åœºä¸Šæ¶Œç°å‡ºä¼—å¤šæ²Ÿé€šè½¯ä»¶ï¼Œè€Œ<strong>è®¿ç­”</strong>ä»¥å…¶ç‹¬ç‰¹çš„åŠŸèƒ½å’Œè®¾è®¡ç†å¿µï¼Œé€æ¸æˆä¸ºè®¸å¤šå›¢é˜Ÿçš„é¦–é€‰ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨<strong>è®¿ç­”</strong>çš„æ ¸å¿ƒä¼˜åŠ¿ï¼Œä»¥åŠå®ƒå¦‚ä½•å¸®åŠ©ç”¨æˆ·æå‡æ²Ÿé€šæ•ˆç‡ã€‚</p><h3><strong>è®¿ç­”</strong>çš„æ ¸å¿ƒåŠŸèƒ½è§£æ</h3><p><strong>è®¿ç­”</strong>æ˜¯ä¸€æ¬¾ä¸“æ³¨äºç®€åŒ–å›¢é˜Ÿæ²Ÿé€šçš„è½¯ä»¶ï¼Œå®ƒæ•´åˆäº†å³æ—¶æ¶ˆæ¯ã€æ–‡ä»¶å…±äº«å’Œä»»åŠ¡ç®¡ç†ç­‰åŠŸèƒ½ã€‚ä¸ä¼ ç»Ÿçš„æ²Ÿé€šå·¥å…·ç›¸æ¯”ï¼Œ<strong>è®¿ç­”</strong>æ³¨é‡ç”¨æˆ·ä½“éªŒï¼Œå‡å°‘äº†ä¸å¿…è¦çš„å¹²æ‰°ï¼Œè®©å›¢é˜Ÿæˆå‘˜èƒ½å¤Ÿæ›´ä¸“æ³¨äºæ ¸å¿ƒå·¥ä½œã€‚ä¾‹å¦‚ï¼Œå…¶æ™ºèƒ½é€šçŸ¥ç³»ç»Ÿå¯ä»¥æ ¹æ®ç”¨æˆ·çš„åœ¨çº¿çŠ¶æ€å’Œä»»åŠ¡ä¼˜å…ˆçº§ï¼Œè‡ªåŠ¨è¿‡æ»¤æ— å…³ä¿¡æ¯ï¼Œç¡®ä¿é‡è¦æ¶ˆæ¯ä¸è¢«é—æ¼ã€‚</p><h3>ä¸ºä»€ä¹ˆé€‰æ‹©<strong>è®¿ç­”</strong>è€Œéå…¶ä»–å·¥å…·ï¼Ÿ</h3><p>ç›¸æ¯”å¸‚åœºä¸Šå…¶ä»–æ²Ÿé€šå·¥å…·ï¼Œ<strong>è®¿ç­”</strong>åœ¨ç•Œé¢è®¾è®¡å’ŒåŠŸèƒ½æ•´åˆä¸Šæ›´å…·ä¼˜åŠ¿ã€‚è®¸å¤šå·¥å…·å¾€å¾€åŠŸèƒ½ç¹æ‚ï¼Œå¯¼è‡´ç”¨æˆ·å­¦ä¹ æˆæœ¬é«˜ï¼Œè€Œ<strong>è®¿ç­”</strong>é€šè¿‡ç›´è§‚çš„å¸ƒå±€å’Œç®€æ´çš„æ“ä½œæµç¨‹ï¼Œè®©æ–°ç”¨æˆ·èƒ½å¤Ÿå¿«é€Ÿä¸Šæ‰‹ã€‚æ­¤å¤–ï¼Œ<strong>è®¿ç­”</strong>æ”¯æŒæ— ç¼é›†æˆç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œå¦‚æ—¥å†å’Œé¡¹ç›®ç®¡ç†è½¯ä»¶ï¼Œè¿›ä¸€æ­¥æå‡äº†å·¥ä½œæ•ˆç‡ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œç”¨æˆ·åé¦ˆæ˜¾ç¤ºï¼Œ<strong>è®¿ç­”</strong>åœ¨å‡å°‘æ²Ÿé€šå»¶è¿Ÿå’Œè¯¯è§£æ–¹é¢è¡¨ç°çªå‡ºï¼Œè¿™å¾—ç›Šäºå…¶æ¸…æ™°çš„å¯¹è¯çº¿ç¨‹å’Œå®æ—¶åä½œåŠŸèƒ½ã€‚</p><h3>å¦‚ä½•æœ€å¤§åŒ–åˆ©ç”¨<strong>è®¿ç­”</strong>æå‡å›¢é˜Ÿåä½œ</h3><p>è¦å……åˆ†å‘æŒ¥<strong>è®¿ç­”</strong>çš„æ½œåŠ›ï¼Œå›¢é˜Ÿå¯ä»¥éµå¾ªå‡ ä¸ªå…³é”®æ­¥éª¤ï¼šé¦–å…ˆï¼Œåˆ¶å®šç»Ÿä¸€çš„æ²Ÿé€šè§„èŒƒï¼Œä¾‹å¦‚ä½¿ç”¨æ ‡ç­¾åˆ†ç±»å¯¹è¯ä¸»é¢˜ï¼›å…¶æ¬¡ï¼Œåˆ©ç”¨<strong>è®¿ç­”</strong>çš„å­˜æ¡£å’Œæœç´¢åŠŸèƒ½ï¼Œå¿«é€Ÿå›æº¯é‡è¦è®¨è®ºï¼›æœ€åï¼Œå®šæœŸåŸ¹è®­å›¢é˜Ÿæˆå‘˜æŒæ¡é«˜çº§åŠŸèƒ½ï¼Œå¦‚è‡ªåŠ¨åŒ–å·¥ä½œæµã€‚é€šè¿‡è¿™äº›å®è·µï¼Œå›¢é˜Ÿä¸ä»…èƒ½å¤Ÿå‡å°‘ä¼šè®®æ—¶é—´ï¼Œè¿˜èƒ½æé«˜æ•´ä½“äº§å‡ºè´¨é‡ã€‚</p><p>æ€»ä¹‹ï¼Œ<strong>è®¿ç­”</strong>ä½œä¸ºä¸€æ¬¾æ–°å…´çš„æ²Ÿé€šå·¥å…·ï¼Œå‡­å€Ÿå…¶é«˜æ•ˆæ€§å’Œæ˜“ç”¨æ€§ï¼Œæ­£é€æ¸æ”¹å˜å›¢é˜Ÿåä½œçš„æ–¹å¼ã€‚æ— è®ºæ‚¨æ˜¯å°å‹å›¢é˜Ÿè¿˜æ˜¯å¤§å‹ç»„ç»‡ï¼Œéƒ½å€¼å¾—å°è¯•<strong>è®¿ç­”</strong>æ¥ä¼˜åŒ–å·¥ä½œæµç¨‹ã€‚</p><p><img width="723" height="411" referrerpolicy="no-referrer" src="/img/bVdnPjr" alt="" title=""/></p>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„åç¨‹ä¸äº‹ä»¶å¾ªç¯æœºåˆ¶ é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585252</link>    <guid>https://segmentfault.com/a/1190000047585252</guid>    <pubDate>2026-02-01 02:08:18</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„åç¨‹ä¸äº‹ä»¶å¾ªç¯æœºåˆ¶</h2><h3>1. åç¨‹çš„æ¦‚å¿µä¸åŸºæœ¬åŸç†</h3><p>åç¨‹ï¼ˆCoroutineï¼‰æ˜¯ä¸€ç§æ¯”çº¿ç¨‹æ›´è½»é‡çº§çš„å¹¶å‘ç¼–ç¨‹æ–¹å¼ï¼Œå®ƒå…è®¸åœ¨å•çº¿ç¨‹å†…å®ç°å¹¶å‘æ“ä½œã€‚åç¨‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥æš‚åœï¼Œä¿å­˜å½“å‰çš„æ‰§è¡ŒçŠ¶æ€ï¼Œç„¶ååœ¨é€‚å½“çš„æ—¶å€™æ¢å¤æ‰§è¡Œã€‚</p><h4>1.1 åç¨‹çš„å®šä¹‰</h4><p>åç¨‹æ˜¯ä¸€ç§å¯ä»¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æš‚åœå¹¶åœ¨ç¨åæ¢å¤çš„å‡½æ•°ã€‚ä¸çº¿ç¨‹ä¸åŒï¼Œåç¨‹çš„åˆ‡æ¢æ˜¯ç”±ç¨‹åºè‡ªèº«æ§åˆ¶çš„ï¼Œè€Œä¸æ˜¯ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦çš„ã€‚è¿™ç§æ–¹å¼ä½¿å¾—åç¨‹çš„åˆ‡æ¢å¼€é”€éå¸¸å°ï¼Œé€‚åˆå¤„ç†å¤§é‡çš„I/Oå¯†é›†å‹ä»»åŠ¡ã€‚</p><h4>1.2 åç¨‹ä¸å…¶ä»–å¹¶å‘æ¨¡å‹çš„æ¯”è¾ƒ</h4><table><thead><tr><th>å¹¶å‘æ¨¡å‹</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>çº¿ç¨‹</td><td>ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦ï¼Œä½¿ç”¨ç®€å•</td><td>ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å¤§ï¼Œå¯èƒ½å¯¼è‡´ç«æ€æ¡ä»¶</td></tr><tr><td>è¿›ç¨‹</td><td>å®Œå…¨éš”ç¦»ï¼Œå®‰å…¨æ€§é«˜</td><td>å†…å­˜å ç”¨å¤§ï¼Œè¿›ç¨‹é—´é€šä¿¡å¤æ‚</td></tr><tr><td>åç¨‹</td><td>ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å°ï¼Œå¹¶å‘åº¦é«˜</td><td>éœ€è¦æ˜¾å¼ yield æ§åˆ¶æƒï¼Œç¼–ç¨‹å¤æ‚åº¦è¾ƒé«˜</td></tr></tbody></table><h4>1.3 åç¨‹çš„å·¥ä½œåŸç†</h4><p>åç¨‹çš„å·¥ä½œåŸç†åŸºäºä»¥ä¸‹å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p><ol><li><strong>æš‚åœä¸æ¢å¤</strong>ï¼šåç¨‹å¯ä»¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æš‚åœï¼Œä¿å­˜å½“å‰çš„æ‰§è¡ŒçŠ¶æ€ï¼Œç„¶ååœ¨é€‚å½“çš„æ—¶å€™æ¢å¤æ‰§è¡Œ</li><li><strong>åä½œå¼è°ƒåº¦</strong>ï¼šåç¨‹çš„åˆ‡æ¢æ˜¯ç”±ç¨‹åºè‡ªèº«æ§åˆ¶çš„ï¼Œè€Œä¸æ˜¯ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦çš„</li><li><strong>äº‹ä»¶å¾ªç¯</strong>ï¼šåç¨‹éœ€è¦åœ¨äº‹ä»¶å¾ªç¯ä¸­è¿è¡Œï¼Œäº‹ä»¶å¾ªç¯è´Ÿè´£è°ƒåº¦å’Œæ‰§è¡Œåç¨‹ä»»åŠ¡</li></ol><pre><code class="python"># åç¨‹çš„åŸºæœ¬åŸç†ç¤ºä¾‹
import time

# ç®€å•çš„åç¨‹å®ç°ï¼ˆä½¿ç”¨ç”Ÿæˆå™¨ï¼‰
def simple_coroutine():
    print("åç¨‹å¼€å§‹")
    value = yield
    print(f"åç¨‹æ¥æ”¶åˆ°å€¼ï¼š{value}")
    value = yield "åç¨‹è¿”å›å€¼"
    print(f"åç¨‹æ¥æ”¶åˆ°ç¬¬äºŒä¸ªå€¼ï¼š{value}")
    return "åç¨‹ç»“æŸ"

# åˆ›å»ºåç¨‹å¯¹è±¡
coro = simple_coroutine()

# å¯åŠ¨åç¨‹
print("å¯åŠ¨åç¨‹ï¼š")
next(coro)  # æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ª yield

# å‘é€å€¼å¹¶æ¢å¤åç¨‹
print("\nå‘é€ç¬¬ä¸€ä¸ªå€¼ï¼š")
try:
    result = coro.send("Hello")  # å‘é€å€¼å¹¶æ‰§è¡Œåˆ°ç¬¬äºŒä¸ª yield
    print(f"åç¨‹è¿”å›å€¼ï¼š{result}")
    
    # å‘é€ç¬¬äºŒä¸ªå€¼
    print("\nå‘é€ç¬¬äºŒä¸ªå€¼ï¼š")
    result = coro.send("World")  # å‘é€å€¼å¹¶æ‰§è¡Œåˆ°ç»“æŸ
except StopIteration as e:
    print(f"åç¨‹ç»“æŸï¼Œè¿”å›å€¼ï¼š{e.value}")

# æµ‹è¯•åç¨‹çš„æš‚åœä¸æ¢å¤
print("\næµ‹è¯•åç¨‹çš„æš‚åœä¸æ¢å¤ï¼š")

def timer_coroutine():
    """è®¡æ—¶å™¨åç¨‹"""
    start = time.time()
    while True:
        elapsed = time.time() - start
        yield elapsed
        time.sleep(0.5)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ

# åˆ›å»ºè®¡æ—¶å™¨åç¨‹
 timer = timer_coroutine()

# ä½¿ç”¨è®¡æ—¶å™¨
print("å¼€å§‹è®¡æ—¶ï¼š")
for i in range(5):
    elapsed = next(timer)
    print(f"ç¬¬ {i + 1} æ¬¡è°ƒç”¨ï¼Œå·²è¿‡æ—¶é—´ï¼š{elapsed:.2f}ç§’")</code></pre><h4>1.4 åç¨‹çš„ä¼˜åŠ¿</h4><p>ä½¿ç”¨åç¨‹çš„ä¼˜åŠ¿ï¼š</p><ul><li><strong>é«˜å¹¶å‘</strong>ï¼šå•çº¿ç¨‹å†…å¯ä»¥åŒæ—¶å¤„ç†å¤§é‡çš„åç¨‹ä»»åŠ¡</li><li><strong>ä½å¼€é”€</strong>ï¼šåç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€éå¸¸å°ï¼Œä¸éœ€è¦æ“ä½œç³»ç»Ÿä»‹å…¥</li><li><strong>æ— ç«æ€æ¡ä»¶</strong>ï¼šåç¨‹åœ¨å•çº¿ç¨‹å†…æ‰§è¡Œï¼Œä¸éœ€è¦é”æœºåˆ¶</li><li><strong>æ˜“äºè°ƒè¯•</strong>ï¼šåç¨‹çš„æ‰§è¡Œé¡ºåºæ˜¯ç¡®å®šçš„ï¼Œä¾¿äºè°ƒè¯•</li><li><strong>é€‚åˆI/Oå¯†é›†å‹ä»»åŠ¡</strong>ï¼šåç¨‹åœ¨ç­‰å¾…I/Oæ“ä½œæ—¶å¯ä»¥æš‚åœï¼Œè®©å…¶ä»–åç¨‹æ‰§è¡Œ</li></ul><h3>2. Pythonä¸­çš„åç¨‹å®ç°</h3><p>Pythonä¸­çš„åç¨‹å®ç°ç»å†äº†å‡ ä¸ªé˜¶æ®µçš„å‘å±•ï¼š</p><ol><li><strong>ç”Ÿæˆå™¨åç¨‹</strong>ï¼šåŸºäºç”Ÿæˆå™¨çš„åç¨‹å®ç°ï¼ˆPython 2.5+ï¼‰</li><li><strong>å¢å¼ºå‹ç”Ÿæˆå™¨åç¨‹</strong>ï¼šæ”¯æŒ <code>send()</code>ã€<code>throw()</code> å’Œ <code>close()</code> æ–¹æ³•ï¼ˆPython 2.5+ï¼‰</li><li><strong>åŸç”Ÿåç¨‹</strong>ï¼šä½¿ç”¨ <code>async/await</code> è¯­æ³•çš„åç¨‹ï¼ˆPython 3.5+ï¼‰</li></ol><h4>2.1 ç”Ÿæˆå™¨åç¨‹</h4><p>ç”Ÿæˆå™¨åç¨‹æ˜¯åŸºäºPythonçš„ç”Ÿæˆå™¨å®ç°çš„åç¨‹ï¼Œä½¿ç”¨ <code>yield</code> è¯­å¥æ¥æš‚åœæ‰§è¡Œï¼š</p><pre><code class="python"># ç”Ÿæˆå™¨åç¨‹ç¤ºä¾‹
def generator_coroutine():
    """ç”Ÿæˆå™¨åç¨‹"""
    print("åç¨‹å¼€å§‹")
    while True:
        value = yield
        print(f"åç¨‹æ¥æ”¶åˆ°å€¼ï¼š{value}")
        if value == "exit":
            break
    print("åç¨‹ç»“æŸ")

# åˆ›å»ºåç¨‹å¯¹è±¡
coro = generator_coroutine()

# å¯åŠ¨åç¨‹
next(coro)

# å‘é€å€¼
coro.send("Hello")
coro.send("World")
coro.send("exit")

# æµ‹è¯•å¸¦è¿”å›å€¼çš„ç”Ÿæˆå™¨åç¨‹
def counting_coroutine():
    """è®¡æ•°åç¨‹"""
    count = 0
    while True:
        action = yield count
        if action == "increment":
            count += 1
        elif action == "reset":
            count = 0
        elif action == "exit":
            break
    return count

# åˆ›å»ºåç¨‹å¯¹è±¡
coro = counting_coroutine()

# å¯åŠ¨åç¨‹
print(f"åˆå§‹å€¼ï¼š{next(coro)}")

# å‘é€æ“ä½œ
print(f"é€’å¢åï¼š{coro.send('increment')}")
print(f"é€’å¢åï¼š{coro.send('increment')}")
print(f"é‡ç½®åï¼š{coro.send('reset')}")
print(f"é€’å¢åï¼š{coro.send('increment')}")

# é€€å‡ºåç¨‹
try:
    coro.send("exit")
except StopIteration as e:
    print(f"åç¨‹ç»“æŸï¼Œæœ€ç»ˆè®¡æ•°ï¼š{e.value}")</code></pre><h4>2.2 åŸç”Ÿåç¨‹</h4><p>åŸç”Ÿåç¨‹æ˜¯Python 3.5+å¼•å…¥çš„åç¨‹å®ç°ï¼Œä½¿ç”¨ <code>async/await</code> è¯­æ³•ï¼š</p><pre><code class="python"># åŸç”Ÿåç¨‹ç¤ºä¾‹
import asyncio

async def native_coroutine():
    """åŸç”Ÿåç¨‹"""
    print("åç¨‹å¼€å§‹")
    await asyncio.sleep(1)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    print("åç¨‹ç»§ç»­")
    await asyncio.sleep(1)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    print("åç¨‹ç»“æŸ")
    return "åç¨‹è¿”å›å€¼"

# è¿è¡Œåç¨‹
async def main():
    result = await native_coroutine()
    print(f"åç¨‹è¿”å›å€¼ï¼š{result}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
print("å¯åŠ¨äº‹ä»¶å¾ªç¯ï¼š")
asyncio.run(main())

# æµ‹è¯•å¸¦å‚æ•°çš„åŸç”Ÿåç¨‹
async def greet(name):
    """é—®å€™åç¨‹"""
    print(f"Hello, {name}!")
    await asyncio.sleep(1)
    print(f"Goodbye, {name}!")
    return f"Greeted {name}"

# è¿è¡Œå¤šä¸ªåç¨‹
async def main_multiple():
    # å¹¶å‘è¿è¡Œå¤šä¸ªåç¨‹
    task1 = asyncio.create_task(greet("Alice"))
    task2 = asyncio.create_task(greet("Bob"))
    task3 = asyncio.create_task(greet("Charlie"))
    
    # ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
    results = await asyncio.gather(task1, task2, task3)
    print(f"æ‰€æœ‰åç¨‹å®Œæˆï¼Œç»“æœï¼š{results}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
print("\nè¿è¡Œå¤šä¸ªåç¨‹ï¼š")
asyncio.run(main_multiple())</code></pre><h4>2.3 åç¨‹è£…é¥°å™¨</h4><p>åœ¨Python 3.4åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œéœ€è¦ä½¿ç”¨ <code>@asyncio.coroutine</code> è£…é¥°å™¨æ¥æ ‡è®°åç¨‹å‡½æ•°ï¼š</p><pre><code class="python"># åç¨‹è£…é¥°å™¨ç¤ºä¾‹
import asyncio

@asyncio.coroutine
def decorated_coroutine():
    """ä½¿ç”¨è£…é¥°å™¨çš„åç¨‹"""
    print("åç¨‹å¼€å§‹")
    yield from asyncio.sleep(1)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    print("åç¨‹ç»§ç»­")
    yield from asyncio.sleep(1)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    print("åç¨‹ç»“æŸ")
    return "åç¨‹è¿”å›å€¼"

# è¿è¡Œåç¨‹
@asyncio.coroutine
def main():
    result = yield from decorated_coroutine()
    print(f"åç¨‹è¿”å›å€¼ï¼š{result}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
print("å¯åŠ¨äº‹ä»¶å¾ªç¯ï¼š")
asyncio.run(main())</code></pre><h3>3. äº‹ä»¶å¾ªç¯çš„å·¥ä½œåŸç†</h3><p>äº‹ä»¶å¾ªç¯æ˜¯åç¨‹æ‰§è¡Œçš„æ ¸å¿ƒï¼Œå®ƒè´Ÿè´£è°ƒåº¦å’Œæ‰§è¡Œåç¨‹ä»»åŠ¡ï¼Œå¤„ç†I/Oæ“ä½œç­‰ã€‚Pythonçš„ <code>asyncio</code> åº“æä¾›äº†äº‹ä»¶å¾ªç¯çš„å®ç°ã€‚</p><h4>3.1 äº‹ä»¶å¾ªç¯çš„æ¦‚å¿µ</h4><p>äº‹ä»¶å¾ªç¯æ˜¯ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œå®ƒä¸æ–­åœ°ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡å¹¶æ‰§è¡Œï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆã€‚äº‹ä»¶å¾ªç¯çš„ä¸»è¦èŒè´£åŒ…æ‹¬ï¼š</p><ol><li><strong>ä»»åŠ¡è°ƒåº¦</strong>ï¼šè°ƒåº¦å’Œæ‰§è¡Œåç¨‹ä»»åŠ¡</li><li><strong>I/Oæ“ä½œå¤„ç†</strong>ï¼šå¤„ç†å¼‚æ­¥I/Oæ“ä½œ</li><li><strong>äº‹ä»¶å¤„ç†</strong>ï¼šå¤„ç†å®šæ—¶å™¨ã€ä¿¡å·ç­‰äº‹ä»¶</li><li><strong>å›è°ƒå‡½æ•°æ‰§è¡Œ</strong>ï¼šæ‰§è¡Œæ³¨å†Œçš„å›è°ƒå‡½æ•°</li></ol><h4>3.2 äº‹ä»¶å¾ªç¯çš„å·¥ä½œæµç¨‹</h4><p>äº‹ä»¶å¾ªç¯çš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><strong>åˆå§‹åŒ–</strong>ï¼šåˆ›å»ºäº‹ä»¶å¾ªç¯å¯¹è±¡</li><li><strong>æ·»åŠ ä»»åŠ¡</strong>ï¼šå°†åç¨‹ä»»åŠ¡æ·»åŠ åˆ°äº‹ä»¶å¾ªç¯ä¸­</li><li><strong>æ‰§è¡Œä»»åŠ¡</strong>ï¼šä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡å¹¶æ‰§è¡Œ</li><li><strong>å¤„ç†I/O</strong>ï¼šå½“ä»»åŠ¡éœ€è¦ç­‰å¾…I/Oæ“ä½œæ—¶ï¼Œæš‚åœä»»åŠ¡æ‰§è¡Œï¼Œå¤„ç†å…¶ä»–ä»»åŠ¡</li><li><strong>ä»»åŠ¡å®Œæˆ</strong>ï¼šå½“I/Oæ“ä½œå®Œæˆæ—¶ï¼Œæ¢å¤æš‚åœçš„ä»»åŠ¡æ‰§è¡Œ</li><li><strong>å¾ªç¯ç»“æŸ</strong>ï¼šå½“æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆæ—¶ï¼Œé€€å‡ºäº‹ä»¶å¾ªç¯</li></ol><pre><code class="python"># äº‹ä»¶å¾ªç¯çš„å·¥ä½œåŸç†ç¤ºä¾‹
import asyncio
import time

async def task1():
    """ä»»åŠ¡1"""
    print("ä»»åŠ¡1å¼€å§‹")
    await asyncio.sleep(2)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    print("ä»»åŠ¡1ç»“æŸ")
    return "ä»»åŠ¡1è¿”å›å€¼"

async def task2():
    """ä»»åŠ¡2"""
    print("ä»»åŠ¡2å¼€å§‹")
    await asyncio.sleep(1)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    print("ä»»åŠ¡2ç»“æŸ")
    return "ä»»åŠ¡2è¿”å›å€¼"

async def task3():
    """ä»»åŠ¡3"""
    print("ä»»åŠ¡3å¼€å§‹")
    await asyncio.sleep(1.5)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    print("ä»»åŠ¡3ç»“æŸ")
    return "ä»»åŠ¡3è¿”å›å€¼"

async def main():
    """ä¸»åç¨‹"""
    print(f"ä¸»åç¨‹å¼€å§‹ï¼Œæ—¶é—´ï¼š{time.strftime('%H:%M:%S')}")
    
    # åˆ›å»ºä»»åŠ¡
    task1_obj = asyncio.create_task(task1())
    task2_obj = asyncio.create_task(task2())
    task3_obj = asyncio.create_task(task3())
    
    # ç­‰å¾…ä»»åŠ¡å®Œæˆ
    results = await asyncio.gather(task1_obj, task2_obj, task3_obj)
    
    print(f"ä¸»åç¨‹ç»“æŸï¼Œæ—¶é—´ï¼š{time.strftime('%H:%M:%S')}")
    print(f"ä»»åŠ¡ç»“æœï¼š{results}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
print("å¯åŠ¨äº‹ä»¶å¾ªç¯ï¼š")
asyncio.run(main())

# æµ‹è¯•äº‹ä»¶å¾ªç¯çš„ä»»åŠ¡è°ƒåº¦
async def periodic_task(name, interval):
    """å‘¨æœŸæ€§ä»»åŠ¡"""
    for i in range(3):
        print(f"{name} æ‰§è¡Œï¼Œç¬¬ {i + 1} æ¬¡ï¼Œæ—¶é—´ï¼š{time.strftime('%H:%M:%S')}")
        await asyncio.sleep(interval)

async def main_periodic():
    """ä¸»åç¨‹"""
    print(f"ä¸»åç¨‹å¼€å§‹ï¼Œæ—¶é—´ï¼š{time.strftime('%H:%M:%S')}")
    
    # åˆ›å»ºå‘¨æœŸæ€§ä»»åŠ¡
    task1 = asyncio.create_task(periodic_task("ä»»åŠ¡A", 1))
    task2 = asyncio.create_task(periodic_task("ä»»åŠ¡B", 2))
    
    # ç­‰å¾…ä»»åŠ¡å®Œæˆ
    await asyncio.gather(task1, task2)
    
    print(f"ä¸»åç¨‹ç»“æŸï¼Œæ—¶é—´ï¼š{time.strftime('%H:%M:%S')}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
print("\næµ‹è¯•å‘¨æœŸæ€§ä»»åŠ¡ï¼š")
asyncio.run(main_periodic())</code></pre><h4>3.3 äº‹ä»¶å¾ªç¯çš„ç±»å‹</h4><p>Pythonçš„ <code>asyncio</code> åº“æä¾›äº†å¤šç§äº‹ä»¶å¾ªç¯å®ç°ï¼Œé€‚ç”¨äºä¸åŒçš„å¹³å°å’Œåœºæ™¯ï¼š</p><ul><li><strong>SelectorEventLoop</strong>ï¼šåŸºäº select ç³»ç»Ÿè°ƒç”¨çš„äº‹ä»¶å¾ªç¯ï¼Œé€‚ç”¨äºæ‰€æœ‰å¹³å°</li><li><strong>ProactorEventLoop</strong>ï¼šåŸºäº IOCP çš„äº‹ä»¶å¾ªç¯ï¼Œä»…é€‚ç”¨äº Windows å¹³å°</li><li><strong>uvloop</strong>ï¼šåŸºäº libuv çš„äº‹ä»¶å¾ªç¯ï¼Œæ€§èƒ½æ›´é«˜ï¼Œä½†éœ€è¦å•ç‹¬å®‰è£…</li></ul><pre><code class="python"># äº‹ä»¶å¾ªç¯çš„ç±»å‹ç¤ºä¾‹
import asyncio

# è·å–å½“å‰äº‹ä»¶å¾ªç¯
loop = asyncio.get_event_loop()
print(f"å½“å‰äº‹ä»¶å¾ªç¯ï¼š{type(loop).__name__}")

# æµ‹è¯•ä¸åŒçš„äº‹ä»¶å¾ªç¯ç­–ç•¥
print("\næµ‹è¯•äº‹ä»¶å¾ªç¯ç­–ç•¥ï¼š")

# é»˜è®¤ç­–ç•¥
default_policy = asyncio.get_event_loop_policy()
print(f"é»˜è®¤ç­–ç•¥ï¼š{type(default_policy).__name__}")

# å°è¯•ä½¿ç”¨ uvloop
print("\nå°è¯•ä½¿ç”¨ uvloopï¼š")
try:
    import uvloop
    asyncio.set_event_loop_policy(uvloop.EventLoopPolicy())
    loop = asyncio.new_event_loop()
    print(f"uvloop äº‹ä»¶å¾ªç¯ï¼š{type(loop).__name__}")
except ImportError:
    print("uvloop æœªå®‰è£…")

# æµ‹è¯•äº‹ä»¶å¾ªç¯çš„å…³é—­
print("\næµ‹è¯•äº‹ä»¶å¾ªç¯çš„å…³é—­ï¼š")

async def test_task():
    print("æµ‹è¯•ä»»åŠ¡")
    await asyncio.sleep(1)
    print("æµ‹è¯•ä»»åŠ¡å®Œæˆ")

# åˆ›å»ºå¹¶è¿è¡Œäº‹ä»¶å¾ªç¯
loop = asyncio.new_event_loop()
try:
    loop.run_until_complete(test_task())
finally:
    loop.close()
    print("äº‹ä»¶å¾ªç¯å·²å…³é—­")</code></pre><h3>4. åç¨‹çš„é«˜çº§ç‰¹æ€§</h3><h4>4.1 åç¨‹çš„å–æ¶ˆ</h4><p>å¯ä»¥ä½¿ç”¨ <code>cancel()</code> æ–¹æ³•æ¥å–æ¶ˆæ­£åœ¨æ‰§è¡Œçš„åç¨‹ä»»åŠ¡ï¼š</p><pre><code class="python"># åç¨‹çš„å–æ¶ˆç¤ºä¾‹
import asyncio
import time

async def long_running_task():
    """é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡"""
    print("é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡å¼€å§‹")
    try:
        for i in range(10):
            print(f"ä»»åŠ¡æ‰§è¡Œä¸­... {i + 1}/10")
            await asyncio.sleep(1)
    except asyncio.CancelledError:
        print("ä»»åŠ¡è¢«å–æ¶ˆ")
        raise  # é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œç¡®ä¿ä»»åŠ¡æ­£ç¡®ç»“æŸ
    finally:
        print("ä»»åŠ¡æ¸…ç†")
    return "ä»»åŠ¡å®Œæˆ"

async def main():
    """ä¸»åç¨‹"""
    # åˆ›å»ºä»»åŠ¡
    task = asyncio.create_task(long_running_task())
    
    # ç­‰å¾…ä¸€æ®µæ—¶é—´åå–æ¶ˆä»»åŠ¡
    await asyncio.sleep(3)
    print("å–æ¶ˆä»»åŠ¡")
    task.cancel()
    
    # ç­‰å¾…ä»»åŠ¡å®Œæˆ
    try:
        result = await task
        print(f"ä»»åŠ¡ç»“æœï¼š{result}")
    except asyncio.CancelledError:
        print("æ•è·åˆ°ä»»åŠ¡å–æ¶ˆå¼‚å¸¸")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
print("æµ‹è¯•åç¨‹çš„å–æ¶ˆï¼š")
asyncio.run(main())</code></pre><h4>4.2 åç¨‹çš„è¶…æ—¶å¤„ç†</h4><p>å¯ä»¥ä½¿ç”¨ <code>asyncio.wait_for()</code> å‡½æ•°æ¥è®¾ç½®åç¨‹çš„è¶…æ—¶æ—¶é—´ï¼š</p><pre><code class="python"># åç¨‹çš„è¶…æ—¶å¤„ç†ç¤ºä¾‹
import asyncio

async def slow_task():
    """æ…¢é€Ÿä»»åŠ¡"""
    print("æ…¢é€Ÿä»»åŠ¡å¼€å§‹")
    await asyncio.sleep(5)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    print("æ…¢é€Ÿä»»åŠ¡ç»“æŸ")
    return "æ…¢é€Ÿä»»åŠ¡è¿”å›å€¼"

async def main():
    """ä¸»åç¨‹"""
    print("æµ‹è¯•è¶…æ—¶å¤„ç†ï¼š")
    
    try:
        # è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º3ç§’
        result = await asyncio.wait_for(slow_task(), timeout=3)
        print(f"ä»»åŠ¡ç»“æœï¼š{result}")
    except asyncio.TimeoutError:
        print("ä»»åŠ¡è¶…æ—¶")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
asyncio.run(main())

# æµ‹è¯•å¸¦è¶…æ—¶çš„å¹¶è¡Œä»»åŠ¡
async def task_with_timeout(name, delay):
    """å¸¦å»¶è¿Ÿçš„ä»»åŠ¡"""
    print(f"ä»»åŠ¡ {name} å¼€å§‹ï¼Œå»¶è¿Ÿ {delay} ç§’")
    await asyncio.sleep(delay)
    print(f"ä»»åŠ¡ {name} ç»“æŸ")
    return f"ä»»åŠ¡ {name} è¿”å›å€¼"

async def main_multiple():
    """ä¸»åç¨‹"""
    print("\næµ‹è¯•å¸¦è¶…æ—¶çš„å¹¶è¡Œä»»åŠ¡ï¼š")
    
    try:
        # åˆ›å»ºä»»åŠ¡
        task1 = task_with_timeout("A", 2)
        task2 = task_with_timeout("B", 4)
        task3 = task_with_timeout("C", 1)
        
        # è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º3ç§’
        results = await asyncio.wait_for(
            asyncio.gather(task1, task2, task3),
            timeout=3
        )
        print(f"ä»»åŠ¡ç»“æœï¼š{results}")
    except asyncio.TimeoutError:
        print("ä»»åŠ¡è¶…æ—¶")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
asyncio.run(main_multiple())</code></pre><h4>4.3 åç¨‹çš„å¼‚å¸¸å¤„ç†</h4><p>å¯ä»¥ä½¿ç”¨ try-except è¯­å¥æ¥æ•è·å’Œå¤„ç†åç¨‹ä¸­çš„å¼‚å¸¸ï¼š</p><pre><code class="python"># åç¨‹çš„å¼‚å¸¸å¤„ç†ç¤ºä¾‹
import asyncio

async def task_with_exception():
    """ä¼šæŠ›å‡ºå¼‚å¸¸çš„ä»»åŠ¡"""
    print("ä»»åŠ¡å¼€å§‹")
    await asyncio.sleep(1)
    raise ValueError("ä»»åŠ¡æ‰§è¡Œå‡ºé”™")

async def main():
    """ä¸»åç¨‹"""
    print("æµ‹è¯•å¼‚å¸¸å¤„ç†ï¼š")
    
    try:
        result = await task_with_exception()
        print(f"ä»»åŠ¡ç»“æœï¼š{result}")
    except ValueError as e:
        print(f"æ•è·åˆ°å¼‚å¸¸ï¼š{e}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
asyncio.run(main())

# æµ‹è¯•å¹¶è¡Œä»»åŠ¡çš„å¼‚å¸¸å¤„ç†
async def task1():
    """ä»»åŠ¡1"""
    print("ä»»åŠ¡1å¼€å§‹")
    await asyncio.sleep(1)
    raise ValueError("ä»»åŠ¡1å‡ºé”™")

async def task2():
    """ä»»åŠ¡2"""
    print("ä»»åŠ¡2å¼€å§‹")
    await asyncio.sleep(2)
    print("ä»»åŠ¡2ç»“æŸ")
    return "ä»»åŠ¡2è¿”å›å€¼"

async def main_multiple():
    """ä¸»åç¨‹"""
    print("\næµ‹è¯•å¹¶è¡Œä»»åŠ¡çš„å¼‚å¸¸å¤„ç†ï¼š")
    
    try:
        # åˆ›å»ºä»»åŠ¡
        task1_obj = asyncio.create_task(task1())
        task2_obj = asyncio.create_task(task2())
        
        # ç­‰å¾…ä»»åŠ¡å®Œæˆ
        results = await asyncio.gather(task1_obj, task2_obj)
        print(f"ä»»åŠ¡ç»“æœï¼š{results}")
    except ValueError as e:
        print(f"æ•è·åˆ°å¼‚å¸¸ï¼š{e}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
asyncio.run(main_multiple())</code></pre><h4>4.4 åç¨‹çš„åµŒå¥—</h4><p>åç¨‹å¯ä»¥åµŒå¥—è°ƒç”¨ï¼Œå½¢æˆåç¨‹é“¾ï¼š</p><pre><code class="python"># åç¨‹çš„åµŒå¥—ç¤ºä¾‹
import asyncio

async def inner_coroutine():
    """å†…éƒ¨åç¨‹"""
    print("å†…éƒ¨åç¨‹å¼€å§‹")
    await asyncio.sleep(1)
    print("å†…éƒ¨åç¨‹ç»“æŸ")
    return "å†…éƒ¨åç¨‹è¿”å›å€¼"

async def middle_coroutine():
    """ä¸­é—´åç¨‹"""
    print("ä¸­é—´åç¨‹å¼€å§‹")
    result = await inner_coroutine()
    print(f"è·å–å†…éƒ¨åç¨‹ç»“æœï¼š{result}")
    await asyncio.sleep(1)
    print("ä¸­é—´åç¨‹ç»“æŸ")
    return f"ä¸­é—´åç¨‹è¿”å›å€¼ï¼Œå†…éƒ¨ç»“æœï¼š{result}"

async def outer_coroutine():
    """å¤–éƒ¨åç¨‹"""
    print("å¤–éƒ¨åç¨‹å¼€å§‹")
    result = await middle_coroutine()
    print(f"è·å–ä¸­é—´åç¨‹ç»“æœï¼š{result}")
    await asyncio.sleep(1)
    print("å¤–éƒ¨åç¨‹ç»“æŸ")
    return f"å¤–éƒ¨åç¨‹è¿”å›å€¼ï¼Œä¸­é—´ç»“æœï¼š{result}"

async def main():
    """ä¸»åç¨‹"""
    print("æµ‹è¯•åç¨‹åµŒå¥—ï¼š")
    result = await outer_coroutine()
    print(f"æœ€ç»ˆç»“æœï¼š{result}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
asyncio.run(main())

# æµ‹è¯•æ·±åº¦åµŒå¥—
async def nested_coroutine(depth):
    """æ·±åº¦åµŒå¥—çš„åç¨‹"""
    if depth &gt; 0:
        print(f"åµŒå¥—æ·±åº¦ {depth} å¼€å§‹")
        result = await nested_coroutine(depth - 1)
        print(f"åµŒå¥—æ·±åº¦ {depth} ç»“æŸï¼Œè·å–ç»“æœï¼š{result}")
        return f"æ·±åº¦ {depth} è¿”å›å€¼"
    else:
        print("åµŒå¥—æ·±åº¦ 0 å¼€å§‹")
        await asyncio.sleep(0.5)
        print("åµŒå¥—æ·±åº¦ 0 ç»“æŸ")
        return "æ·±åº¦ 0 è¿”å›å€¼"

async def main_depth():
    """ä¸»åç¨‹"""
    print("\næµ‹è¯•æ·±åº¦åµŒå¥—ï¼š")
    result = await nested_coroutine(5)
    print(f"æœ€ç»ˆç»“æœï¼š{result}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
asyncio.run(main_depth())</code></pre><h3>5. åç¨‹çš„åº”ç”¨åœºæ™¯</h3><h4>5.1 ç½‘ç»œç¼–ç¨‹</h4><p>åç¨‹éå¸¸é€‚åˆç½‘ç»œç¼–ç¨‹ï¼Œç‰¹åˆ«æ˜¯å¤„ç†å¤§é‡çš„å¹¶å‘è¿æ¥ï¼š</p><pre><code class="python"># åç¨‹åœ¨ç½‘ç»œç¼–ç¨‹ä¸­çš„åº”ç”¨
import asyncio
import aiohttp

async def fetch_url(session, url):
    """è·å–URLå†…å®¹"""
    try:
        async with session.get(url) as response:
            status = response.status
            content_length = response.content_length or 0
            print(f"URL: {url}, çŠ¶æ€ç : {status}, å†…å®¹é•¿åº¦: {content_length}")
            # è¯»å–å“åº”å†…å®¹
            await response.read()
            return status
    except Exception as e:
        print(f"URL: {url}, é”™è¯¯: {e}")
        return None

async def main():
    """ä¸»åç¨‹"""
    urls = [
        "https://www.example.com",
        "https://www.google.com",
        "https://www.github.com",
        "https://www.python.org",
        "https://www.baidu.com",
        "https://www.microsoft.com",
        "https://www.apple.com",
        "https://www.amazon.com",
        "https://www.facebook.com",
        "https://www.twitter.com"
    ]
    
    print(f"å¼€å§‹è·å– {len(urls)} ä¸ªURL")
    
    # åˆ›å»ºä¼šè¯
    async with aiohttp.ClientSession() as session:
        # åˆ›å»ºä»»åŠ¡
        tasks = [fetch_url(session, url) for url in urls]
        # ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
        results = await asyncio.gather(*tasks)
    
    print(f"\næ‰€æœ‰URLè·å–å®Œæˆï¼ŒæˆåŠŸ: {results.count(200)}, å¤±è´¥: {results.count(None)}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
print("æµ‹è¯•åç¨‹ç½‘ç»œç¼–ç¨‹ï¼š")
asyncio.run(main())</code></pre><h4>5.2 å¹¶å‘ä»»åŠ¡å¤„ç†</h4><p>åç¨‹å¯ä»¥é«˜æ•ˆåœ°å¤„ç†å¤§é‡çš„å¹¶å‘ä»»åŠ¡ï¼Œå¦‚æ•°æ®å¤„ç†ã€æ–‡ä»¶æ“ä½œç­‰ï¼š</p><pre><code class="python"># åç¨‹åœ¨å¹¶å‘ä»»åŠ¡å¤„ç†ä¸­çš„åº”ç”¨
import asyncio
import time

async def process_task(task_id, delay):
    """å¤„ç†ä»»åŠ¡"""
    print(f"ä»»åŠ¡ {task_id} å¼€å§‹ï¼Œå»¶è¿Ÿ {delay} ç§’")
    await asyncio.sleep(delay)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    result = task_id * 10
    print(f"ä»»åŠ¡ {task_id} ç»“æŸï¼Œç»“æœ: {result}")
    return result

async def main():
    """ä¸»åç¨‹"""
    # åˆ›å»ºä»»åŠ¡åˆ—è¡¨
    tasks = [
        process_task(1, 2),
        process_task(2, 1),
        process_task(3, 3),
        process_task(4, 1.5),
        process_task(5, 2.5),
        process_task(6, 0.5),
        process_task(7, 1.2),
        process_task(8, 2.8),
        process_task(9, 0.8),
        process_task(10, 1.8)
    ]
    
    print(f"å¼€å§‹å¤„ç† {len(tasks)} ä¸ªä»»åŠ¡")
    start_time = time.time()
    
    # å¹¶å‘å¤„ç†æ‰€æœ‰ä»»åŠ¡
    results = await asyncio.gather(*tasks)
    
    end_time = time.time()
    print(f"\næ‰€æœ‰ä»»åŠ¡å¤„ç†å®Œæˆï¼Œè€—æ—¶: {end_time - start_time:.2f}ç§’")
    print(f"ä»»åŠ¡ç»“æœ: {results}")
    print(f"ç»“æœæ€»å’Œ: {sum(results)}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
print("æµ‹è¯•åç¨‹å¹¶å‘ä»»åŠ¡å¤„ç†ï¼š")
asyncio.run(main())

# æµ‹è¯•æ‰¹é‡ä»»åŠ¡å¤„ç†
async def batch_process(tasks, batch_size=5):
    """æ‰¹é‡å¤„ç†ä»»åŠ¡"""
    results = []
    
    for i in range(0, len(tasks), batch_size):
        batch = tasks[i:i + batch_size]
        print(f"å¤„ç†æ‰¹æ¬¡ {i//batch_size + 1}, ä»»åŠ¡æ•°é‡: {len(batch)}")
        batch_results = await asyncio.gather(*batch)
        results.extend(batch_results)
    
    return results

async def main_batch():
    """ä¸»åç¨‹"""
    # åˆ›å»ºå¤§é‡ä»»åŠ¡
    tasks = [process_task(i, 0.1) for i in range(1, 21)]
    
    print(f"\nå¼€å§‹æ‰¹é‡å¤„ç† {len(tasks)} ä¸ªä»»åŠ¡")
    start_time = time.time()
    
    # æ‰¹é‡å¤„ç†ä»»åŠ¡
    results = await batch_process(tasks, batch_size=5)
    
    end_time = time.time()
    print(f"\næ‰€æœ‰ä»»åŠ¡å¤„ç†å®Œæˆï¼Œè€—æ—¶: {end_time - start_time:.2f}ç§’")
    print(f"ä»»åŠ¡ç»“æœ: {results}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
asyncio.run(main_batch())</code></pre><h4>5.3 å¼‚æ­¥æ–‡ä»¶æ“ä½œ</h4><p>åç¨‹å¯ä»¥ç”¨äºå¼‚æ­¥æ–‡ä»¶æ“ä½œï¼Œæé«˜I/Oå¯†é›†å‹ä»»åŠ¡çš„æ€§èƒ½ï¼š</p><pre><code class="python"># åç¨‹åœ¨å¼‚æ­¥æ–‡ä»¶æ“ä½œä¸­çš„åº”ç”¨
import asyncio
import aiofiles
import time

async def write_file(filename, content):
    """å¼‚æ­¥å†™å…¥æ–‡ä»¶"""
    async with aiofiles.open(filename, 'w') as f:
        await f.write(content)
    print(f"æ–‡ä»¶ {filename} å†™å…¥å®Œæˆ")

async def read_file(filename):
    """å¼‚æ­¥è¯»å–æ–‡ä»¶"""
    async with aiofiles.open(filename, 'r') as f:
        content = await f.read()
    print(f"æ–‡ä»¶ {filename} è¯»å–å®Œæˆï¼Œå†…å®¹é•¿åº¦: {len(content)}")
    return content

async def main():
    """ä¸»åç¨‹"""
    # åˆ›å»ºæµ‹è¯•æ–‡ä»¶
    files = [f"test{i}.txt" for i in range(1, 6)]
    contents = [f"Content for file {i}\n" * 1000 for i in range(1, 6)]
    
    print(f"å¼€å§‹å¤„ç† {len(files)} ä¸ªæ–‡ä»¶")
    start_time = time.time()
    
    # å¼‚æ­¥å†™å…¥æ–‡ä»¶
    write_tasks = [write_file(files[i], contents[i]) for i in range(len(files))]
    await asyncio.gather(*write_tasks)
    
    # å¼‚æ­¥è¯»å–æ–‡ä»¶
    read_tasks = [read_file(file) for file in files]
    read_results = await asyncio.gather(*read_tasks)
    
    end_time = time.time()
    print(f"\næ‰€æœ‰æ–‡ä»¶æ“ä½œå®Œæˆï¼Œè€—æ—¶: {end_time - start_time:.2f}ç§’")
    print(f"è¯»å–çš„æ–‡ä»¶æ•°é‡: {len(read_results)}")

# å¯åŠ¨äº‹ä»¶å¾ªç¯
print("æµ‹è¯•åç¨‹å¼‚æ­¥æ–‡ä»¶æ“ä½œï¼š")
asyncio.run(main())</code></pre><h4>5.4 æ•°æ®åº“æ“ä½œ</h4><p>åç¨‹å¯ä»¥ç”¨äºå¼‚æ­¥æ•°æ®åº“æ“ä½œï¼Œæé«˜æ•°æ®åº“è®¿é—®çš„å¹¶å‘æ€§èƒ½ï¼š</p><pre><code class="python"># åç¨‹åœ¨æ•°æ®åº“æ“ä½œä¸­çš„åº”ç”¨
import asyncio

# æ³¨æ„ï¼šéœ€è¦å®‰è£… aiomysql åº“
try:
    import aiomysql
    
    async def create_connection():
        """åˆ›å»ºæ•°æ®åº“è¿æ¥"""
        conn = await aiomysql.connect(
            host='localhost',
            port=3306,
            user='root',
            password='password',  # è¯·æ›¿æ¢ä¸ºå®é™…å¯†ç 
            db='test',  # è¯·æ›¿æ¢ä¸ºå®é™…æ•°æ®åº“
            loop=asyncio.get_event_loop()
        )
        return conn
    
    async def test_db():
        """æµ‹è¯•æ•°æ®åº“æ“ä½œ"""
        try:
            # åˆ›å»ºè¿æ¥
            conn = await create_connection()
            cursor = await conn.cursor()
            
            # åˆ›å»ºè¡¨
            await cursor.execute('''
                CREATE TABLE IF NOT EXISTS users (
                    id INT PRIMARY KEY AUTO_INCREMENT,
                    name VARCHAR(255) NOT NULL,
                    age INT NOT NULL
                )
            ''')
            print("è¡¨åˆ›å»ºæˆåŠŸ")
            
            # æ’å…¥æ•°æ®
            users = [('Alice', 30), ('Bob', 25), ('Charlie', 35)]
            await cursor.executemany(
                'INSERT INTO users (name, age) VALUES (%s, %s)',
                users
            )
            await conn.commit()
            print(f"æ’å…¥ {cursor.rowcount} æ¡æ•°æ®")
            
            # æŸ¥è¯¢æ•°æ®
            await cursor.execute('SELECT * FROM users')
            results = await cursor.fetchall()
            print("æŸ¥è¯¢ç»“æœï¼š")
            for row in results:
                print(row)
            
            # æ¸…ç†æ•°æ®
            await cursor.execute('DELETE FROM users')
            await conn.commit()
            print("æ•°æ®æ¸…ç†å®Œæˆ")
            
        except Exception as e:
            print(f"æ•°æ®åº“æ“ä½œé”™è¯¯ï¼š{e}")
        finally:
            if 'cursor' in locals():
                await cursor.close()
            if 'conn' in locals():
                conn.close()
    
    # å¯åŠ¨äº‹ä»¶å¾ªç¯
    print("æµ‹è¯•åç¨‹æ•°æ®åº“æ“ä½œï¼š")
    asyncio.run(test_db())
    
except ImportError:
    print("aiomysql åº“æœªå®‰è£…ï¼Œè·³è¿‡æ•°æ®åº“æµ‹è¯•")</code></pre><h3>6. åç¨‹çš„æ€§èƒ½è€ƒè™‘</h3><h4>6.1 æ€§èƒ½æµ‹è¯•</h4><p>è®©æˆ‘ä»¬æµ‹è¯•åç¨‹ä¸å…¶ä»–å¹¶å‘æ¨¡å‹çš„æ€§èƒ½æ¯”è¾ƒï¼š</p><pre><code class="python"># åç¨‹çš„æ€§èƒ½æµ‹è¯•
import asyncio
import threading
import time

# æµ‹è¯•å‡½æ•°ï¼šæ¨¡æ‹ŸI/Oæ“ä½œ
def io_operation(delay):
    """æ¨¡æ‹ŸI/Oæ“ä½œ"""
    time.sleep(delay)

async def async_io_operation(delay):
    """å¼‚æ­¥æ¨¡æ‹ŸI/Oæ“ä½œ"""
    await asyncio.sleep(delay)

# æµ‹è¯•çº¿ç¨‹æ€§èƒ½
def test_threads(count, delay):
    """æµ‹è¯•çº¿ç¨‹æ€§èƒ½"""
    threads = []
    for i in range(count):
        t = threading.Thread(target=io_operation, args=(delay,))
        threads.append(t)
        t.start()
    
    for t in threads:
        t.join()

# æµ‹è¯•åç¨‹æ€§èƒ½
async def test_coroutines(count, delay):
    """æµ‹è¯•åç¨‹æ€§èƒ½"""
    tasks = []
    for i in range(count):
        task = asyncio.create_task(async_io_operation(delay))
        tasks.append(task)
    
    await asyncio.gather(*tasks)

# æµ‹è¯•åŒæ­¥æ€§èƒ½
def test_sync(count, delay):
    """æµ‹è¯•åŒæ­¥æ€§èƒ½"""
    for i in range(count):
        io_operation(delay)

# è¿è¡Œæ€§èƒ½æµ‹è¯•
print("åç¨‹æ€§èƒ½æµ‹è¯•ï¼š")

count = 1000
 delay = 0.01

# æµ‹è¯•åŒæ­¥
print(f"\næµ‹è¯•åŒæ­¥æ‰§è¡Œ {count} ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡å»¶è¿Ÿ {delay} ç§’")
start = time.time()
test_sync(count, delay)
end = time.time()
print(f"åŒæ­¥æ‰§è¡Œè€—æ—¶ï¼š{end - start:.4f}ç§’")

# æµ‹è¯•çº¿ç¨‹
print(f"\næµ‹è¯•çº¿ç¨‹æ‰§è¡Œ {count} ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡å»¶è¿Ÿ {delay} ç§’")
start = time.time()
test_threads(count, delay)
end = time.time()
print(f"çº¿ç¨‹æ‰§è¡Œè€—æ—¶ï¼š{end - start:.4f}ç§’")

# æµ‹è¯•åç¨‹
print(f"\næµ‹è¯•åç¨‹æ‰§è¡Œ {count} ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡å»¶è¿Ÿ {delay} ç§’")
start = time.time()
asyncio.run(test_coroutines(count, delay))
end = time.time()
print(f"åç¨‹æ‰§è¡Œè€—æ—¶ï¼š{end - start:.4f}ç§’")

# æµ‹è¯•æ›´å¤§çš„ä»»åŠ¡é‡
count = 10000
 delay = 0.001

print(f"\næµ‹è¯•æ›´å¤§çš„ä»»åŠ¡é‡ï¼š{count} ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡å»¶è¿Ÿ {delay} ç§’")

# æµ‹è¯•åç¨‹
print("\næµ‹è¯•åç¨‹æ‰§è¡Œï¼š")
start = time.time()
asyncio.run(test_coroutines(count, delay))
end = time.time()
print(f"åç¨‹æ‰§è¡Œè€—æ—¶ï¼š{end - start:.4f}ç§’")

# æµ‹è¯•çº¿ç¨‹ï¼ˆæ³¨æ„ï¼šçº¿ç¨‹æ•°é‡è¿‡å¤šå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿèµ„æºè€—å°½ï¼‰
print(f"\næµ‹è¯•çº¿ç¨‹æ‰§è¡Œï¼ˆä½¿ç”¨ 1000 ä¸ªçº¿ç¨‹ï¼‰ï¼š")
start = time.time()
test_threads(1000, delay * 10)  # å‡å°‘çº¿ç¨‹æ•°é‡ï¼Œå¢åŠ æ¯ä¸ªçº¿ç¨‹çš„å»¶è¿Ÿ
end = time.time()
print(f"çº¿ç¨‹æ‰§è¡Œè€—æ—¶ï¼š{end - start:.4f}ç§’")</code></pre><h4>6.2 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h4><p>åœ¨ä½¿ç”¨åç¨‹æ—¶ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹ç­–ç•¥æ¥ä¼˜åŒ–æ€§èƒ½ï¼š</p><ul><li><strong>å‡å°‘åç¨‹åˆ‡æ¢</strong>ï¼šé¿å…è¿‡å¤šçš„åç¨‹åˆ‡æ¢ï¼Œç‰¹åˆ«æ˜¯åœ¨è®¡ç®—å¯†é›†å‹ä»»åŠ¡ä¸­</li><li><strong>åˆç†ä½¿ç”¨ä»»åŠ¡åˆ†ç»„</strong>ï¼šå¯¹äºå¤§é‡çš„åç¨‹ä»»åŠ¡ï¼Œå¯ä»¥åˆ†ç»„å¤„ç†ï¼Œé¿å…ä¸€æ¬¡æ€§åˆ›å»ºè¿‡å¤šçš„ä»»åŠ¡</li><li><strong>ä½¿ç”¨è¿æ¥æ± </strong>ï¼šå¯¹äºç½‘ç»œã€æ•°æ®åº“ç­‰è¿æ¥ï¼Œä½¿ç”¨è¿æ¥æ± æ¥å‡å°‘è¿æ¥å»ºç«‹å’Œå…³é—­çš„å¼€é”€</li><li><strong>ä¼˜åŒ–I/Oæ“ä½œ</strong>ï¼šå°½å¯èƒ½ä½¿ç”¨å¼‚æ­¥I/Oæ“ä½œï¼Œé¿å…é˜»å¡åç¨‹æ‰§è¡Œ</li><li><strong>ä½¿ç”¨uvloop</strong>ï¼šå¯¹äºæ€§èƒ½è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨uvloopæ¥æ›¿ä»£é»˜è®¤çš„äº‹ä»¶å¾ªç¯</li></ul><pre><code class="python"># åç¨‹æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ç¤ºä¾‹
import asyncio
import time

# æµ‹è¯•ä¸åŒçš„ä»»åŠ¡åˆ†ç»„æ–¹å¼
async def process_task(task_id):
    """å¤„ç†ä»»åŠ¡"""
    await asyncio.sleep(0.01)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    return task_id

async def process_batch(tasks):
    """å¤„ç†æ‰¹æ¬¡ä»»åŠ¡"""
    return await asyncio.gather(*tasks)

async def main_no_batching():
    """ä¸ä½¿ç”¨æ‰¹æ¬¡å¤„ç†"""
    tasks = [process_task(i) for i in range(10000)]
    results = await asyncio.gather(*tasks)
    return results

async def main_with_batching(batch_size=1000):
    """ä½¿ç”¨æ‰¹æ¬¡å¤„ç†"""
    tasks = [process_task(i) for i in range(10000)]
    results = []
    
    for i in range(0, len(tasks), batch_size):
        batch = tasks[i:i + batch_size]
        batch_results = await process_batch(batch)
        results.extend(batch_results)
    
    return results

# è¿è¡Œæ€§èƒ½æµ‹è¯•
print("åç¨‹æ€§èƒ½ä¼˜åŒ–ç­–ç•¥æµ‹è¯•ï¼š")

# æµ‹è¯•ä¸ä½¿ç”¨æ‰¹æ¬¡å¤„ç†
print("\næµ‹è¯•ä¸ä½¿ç”¨æ‰¹æ¬¡å¤„ç†ï¼š")
start = time.time()
asyncio.run(main_no_batching())
end = time.time()
print(f"ä¸ä½¿ç”¨æ‰¹æ¬¡å¤„ç†è€—æ—¶ï¼š{end - start:.4f}ç§’")

# æµ‹è¯•ä½¿ç”¨æ‰¹æ¬¡å¤„ç†
print("\næµ‹è¯•ä½¿ç”¨æ‰¹æ¬¡å¤„ç†ï¼š")
start = time.time()
asyncio.run(main_with_batching())
end = time.time()
print(f"ä½¿ç”¨æ‰¹æ¬¡å¤„ç†è€—æ—¶ï¼š{end - start:.4f}ç§’")

# æµ‹è¯•ä¸åŒæ‰¹æ¬¡å¤§å°
print("\næµ‹è¯•ä¸åŒæ‰¹æ¬¡å¤§å°ï¼š")
batch_sizes = [100, 500, 1000, 2000, 5000]

for batch_size in batch_sizes:
    start = time.time()
    asyncio.run(main_with_batching(batch_size))
    end = time.time()
    print(f"æ‰¹æ¬¡å¤§å° {batch_size}ï¼š{end - start:.4f}ç§’")</code></pre><h3>7. å®è·µæ¡ˆä¾‹ï¼šå®ç°ä¸€ä¸ªç®€å•çš„å¼‚æ­¥WebæœåŠ¡å™¨</h3><h4>7.1 æ¡ˆä¾‹æ¦‚è¿°</h4><p>æˆ‘ä»¬å°†ä½¿ç”¨Pythonçš„ <code>asyncio</code> å’Œ <code>aiohttp</code> åº“æ¥å®ç°ä¸€ä¸ªç®€å•çš„å¼‚æ­¥WebæœåŠ¡å™¨ï¼Œå±•ç¤ºåç¨‹åœ¨ç½‘ç»œç¼–ç¨‹ä¸­çš„åº”ç”¨ã€‚</p><h4>7.2 å®ç°ä»£ç </h4><pre><code class="python"># å®ç°å¼‚æ­¥WebæœåŠ¡å™¨
import asyncio
from aiohttp import web
import time

# å¤„ç†å‡½æ•°ï¼šé¦–é¡µ
async def handle_index(request):
    """å¤„ç†é¦–é¡µè¯·æ±‚"""
    return web.Response(text="Hello, Async Web Server!")

# å¤„ç†å‡½æ•°ï¼šå»¶è¿Ÿå“åº”
async def handle_delay(request):
    """å¤„ç†å»¶è¿Ÿå“åº”è¯·æ±‚"""
    # è·å–å»¶è¿Ÿå‚æ•°
    delay = float(request.match_info.get('delay', 1))
    print(f"å¤„ç†å»¶è¿Ÿè¯·æ±‚ï¼Œå»¶è¿Ÿ {delay} ç§’")
    # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    await asyncio.sleep(delay)
    return web.Response(text=f"Delayed response after {delay} seconds")

# å¤„ç†å‡½æ•°ï¼šå¹¶å‘æµ‹è¯•
async def handle_concurrent(request):
    """å¤„ç†å¹¶å‘æµ‹è¯•è¯·æ±‚"""
    # è·å–å¹¶å‘æ•°å‚æ•°
    count = int(request.match_info.get('count', 10))
    print(f"å¤„ç†å¹¶å‘æµ‹è¯•è¯·æ±‚ï¼Œå¹¶å‘æ•° {count}")
    
    # åˆ›å»ºå¹¶å‘ä»»åŠ¡
    async def task(i):
        await asyncio.sleep(0.1)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
        return i
    
    # æ‰§è¡Œå¹¶å‘ä»»åŠ¡
    tasks = [task(i) for i in range(count)]
    results = await asyncio.gather(*tasks)
    
    return web.Response(text=f"Concurrent tasks completed: {results}")

# å¤„ç†å‡½æ•°ï¼šçŠ¶æ€ä¿¡æ¯
async def handle_status(request):
    """å¤„ç†çŠ¶æ€ä¿¡æ¯è¯·æ±‚"""
    # è·å–äº‹ä»¶å¾ªç¯ä¿¡æ¯
    loop = asyncio.get_event_loop()
    stats = {
        "loop": type(loop).__name__,
        "time": time.strftime('%Y-%m-%d %H:%M:%S'),
        "uptime": f"{time.time() - start_time:.2f} seconds"
    }
    return web.json_response(stats)

# åˆå§‹åŒ–æœåŠ¡å™¨
async def init_app():
    """åˆå§‹åŒ–åº”ç”¨"""
    app = web.Application()
    # æ³¨å†Œè·¯ç”±
    app.add_routes([
        web.get('/', handle_index),
        web.get('/delay/{delay}', handle_delay),
        web.get('/concurrent/{count}', handle_concurrent),
        web.get('/status', handle_status)
    ])
    return app

# å…¨å±€å˜é‡ï¼šæœåŠ¡å™¨å¯åŠ¨æ—¶é—´
start_time = time.time()

# å¯åŠ¨æœåŠ¡å™¨
print("å¯åŠ¨å¼‚æ­¥WebæœåŠ¡å™¨ï¼š")
print("è®¿é—®åœ°å€ï¼šhttp://localhost:8080")
print("æµ‹è¯•è·¯å¾„ï¼š")
print("  /              - é¦–é¡µ")
print("  /delay/{ç§’æ•°}  - å»¶è¿Ÿå“åº”æµ‹è¯•")
print("  /concurrent/{æ•°é‡} - å¹¶å‘æµ‹è¯•")
print("  /status        - æœåŠ¡å™¨çŠ¶æ€")
print("\næŒ‰ Ctrl+C åœæ­¢æœåŠ¡å™¨")

# è¿è¡ŒæœåŠ¡å™¨
web.run_app(init_app(), port=8080)</code></pre><h4>7.3 åº”ç”¨åœºæ™¯</h4><p>å¼‚æ­¥WebæœåŠ¡å™¨é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p><ul><li><strong>é«˜å¹¶å‘è¯·æ±‚</strong>ï¼šå¤„ç†å¤§é‡çš„å¹¶å‘HTTPè¯·æ±‚</li><li><strong>I/Oå¯†é›†å‹æ“ä½œ</strong>ï¼šå¦‚æ•°æ®åº“æŸ¥è¯¢ã€æ–‡ä»¶æ“ä½œã€ç½‘ç»œè¯·æ±‚ç­‰</li><li><strong>å®æ—¶åº”ç”¨</strong>ï¼šå¦‚èŠå¤©åº”ç”¨ã€å®æ—¶æ•°æ®æ›´æ–°ç­‰</li><li><strong>APIæœåŠ¡</strong>ï¼šæä¾›RESTful APIæœåŠ¡</li><li><strong>å¾®æœåŠ¡æ¶æ„</strong>ï¼šä½œä¸ºå¾®æœåŠ¡æ¶æ„ä¸­çš„æœåŠ¡èŠ‚ç‚¹</li></ul><h3>8. æ€»ç»“</h3><p>æœ¬æ–‡è¯¦ç»†åˆ†æäº†Pythonä¸­çš„åç¨‹ä¸äº‹ä»¶å¾ªç¯æœºåˆ¶ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><strong>åç¨‹çš„æ¦‚å¿µä¸åŸºæœ¬åŸç†</strong>ï¼šåç¨‹çš„å®šä¹‰ã€å·¥ä½œåŸç†å’Œä¼˜åŠ¿</li><li><strong>Pythonä¸­çš„åç¨‹å®ç°</strong>ï¼šç”Ÿæˆå™¨åç¨‹ã€åŸç”Ÿåç¨‹å’Œåç¨‹è£…é¥°å™¨</li><li><strong>äº‹ä»¶å¾ªç¯çš„å·¥ä½œåŸç†</strong>ï¼šäº‹ä»¶å¾ªç¯çš„æ¦‚å¿µã€å·¥ä½œæµç¨‹å’Œç±»å‹</li><li><strong>åç¨‹çš„é«˜çº§ç‰¹æ€§</strong>ï¼šåç¨‹çš„å–æ¶ˆã€è¶…æ—¶å¤„ç†ã€å¼‚å¸¸å¤„ç†å’ŒåµŒå¥—</li><li><strong>åç¨‹çš„åº”ç”¨åœºæ™¯</strong>ï¼šç½‘ç»œç¼–ç¨‹ã€å¹¶å‘ä»»åŠ¡å¤„ç†ã€å¼‚æ­¥æ–‡ä»¶æ“ä½œå’Œæ•°æ®åº“æ“ä½œ</li><li><strong>åç¨‹çš„æ€§èƒ½è€ƒè™‘</strong>ï¼šæ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–ç­–ç•¥</li><li><strong>å®è·µæ¡ˆä¾‹</strong>ï¼šå®ç°ä¸€ä¸ªç®€å•çš„å¼‚æ­¥WebæœåŠ¡å™¨</li></ul><p>åç¨‹æ˜¯Pythonä¸­ä¸€ç§å¼ºå¤§çš„å¹¶å‘ç¼–ç¨‹æ–¹å¼ï¼Œå®ƒé€šè¿‡åœ¨å•çº¿ç¨‹å†…å®ç°å¹¶å‘æ“ä½œï¼Œå¤§å¤§æé«˜äº†I/Oå¯†é›†å‹ä»»åŠ¡çš„å¤„ç†æ•ˆç‡ã€‚ä¸çº¿ç¨‹å’Œè¿›ç¨‹ç›¸æ¯”ï¼Œåç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€éå¸¸å°ï¼Œé€‚åˆå¤„ç†å¤§é‡çš„å¹¶å‘ä»»åŠ¡ã€‚</p><p>åœ¨Python 3.5+ä¸­ï¼Œä½¿ç”¨ <code>async/await</code> è¯­æ³•å¯ä»¥æ›´ç®€æ´ã€æ›´æ¸…æ™°åœ°ç¼–å†™åç¨‹ä»£ç ã€‚ç»“åˆ <code>asyncio</code> åº“æä¾›çš„äº‹ä»¶å¾ªç¯å’Œå„ç§å¼‚æ­¥I/Oæ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºé«˜æ€§èƒ½çš„å¼‚æ­¥åº”ç”¨ç¨‹åºã€‚</p><p>é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œè¯»è€…åº”è¯¥èƒ½å¤Ÿï¼š</p><ol><li>ç†è§£åç¨‹çš„åŸºæœ¬æ¦‚å¿µå’Œå·¥ä½œåŸç†</li><li>æŒæ¡Pythonä¸­åç¨‹çš„å®ç°æ–¹å¼å’Œä½¿ç”¨æ–¹æ³•</li><li>äº†è§£äº‹ä»¶å¾ªç¯çš„å·¥ä½œåŸç†å’Œç±»å‹</li><li>æŒæ¡åç¨‹çš„é«˜çº§ç‰¹æ€§å’Œåº”ç”¨åœºæ™¯</li><li>èƒ½å¤Ÿåœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨åç¨‹æ¥æé«˜ç¨‹åºçš„æ€§èƒ½å’Œå¹¶å‘èƒ½åŠ›</li></ol><p>åç¨‹æ˜¯Pythonä¸­ä¸€ç§éå¸¸æœ‰å‰é€”çš„å¹¶å‘ç¼–ç¨‹æ–¹å¼ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§é«˜æ•ˆã€ç®€æ´çš„æ–¹å¼æ¥å¤„ç†å¹¶å‘ä»»åŠ¡ã€‚åœ¨æœªæ¥çš„Pythonå¼€å‘ä¸­ï¼Œåç¨‹å°†ä¼šè¢«è¶Šæ¥è¶Šå¹¿æ³›åœ°åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨ç½‘ç»œç¼–ç¨‹ã€æ•°æ®å¤„ç†ç­‰I/Oå¯†é›†å‹åœºæ™¯ä¸­ã€‚</p><h3>9. å‚è€ƒæ–‡çŒ®</h3><ol><li>Python Documentation: Coroutines and Tasks</li><li>Python Documentation: Event Loops</li><li>PEP 492 -- Coroutines with async and await syntax</li><li>PEP 380 -- Syntax for Delegating to a Subgenerator</li><li>Async IO in Python: A Complete Walkthrough - Real Python</li><li>Effective Python: 90 Specific Ways to Write Better Python - Addison-Wesley</li><li>Python Cookbook, 3rd Edition - O'Reilly Media</li><li>Fluent Python - O'Reilly Media</li><li>High Performance Python - O'Reilly Media</li><li>aiohttp Documentation</li></ol><h3>10. ç»“è¯­</h3><p>åç¨‹ä¸äº‹ä»¶å¾ªç¯æœºåˆ¶æ˜¯Pythonä¸­å®ç°é«˜æ•ˆå¹¶å‘ç¼–ç¨‹çš„é‡è¦å·¥å…·ï¼Œå®ƒä»¬ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§è½»é‡çº§ã€é«˜æ€§èƒ½çš„å¹¶å‘å¤„ç†æ–¹å¼ã€‚é€šè¿‡ä½¿ç”¨åç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å•çº¿ç¨‹å†…å®ç°å¹¶å‘æ“ä½œï¼Œå¤§å¤§æé«˜äº†I/Oå¯†é›†å‹ä»»åŠ¡çš„å¤„ç†æ•ˆç‡ã€‚</p><p>æœ¬æ–‡ä»‹ç»äº†åç¨‹çš„åŸºæœ¬æ¦‚å¿µã€å®ç°æ–¹å¼ã€é«˜çº§ç‰¹æ€§å’Œåº”ç”¨åœºæ™¯ï¼Œå¹¶é€šè¿‡å…·ä½“çš„ä»£ç ç¤ºä¾‹å’Œå®è·µæ¡ˆä¾‹ï¼Œå±•ç¤ºäº†åç¨‹åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨ã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¸®åŠ©è¯»è€…ç†è§£åç¨‹çš„å·¥ä½œåŸç†ï¼ŒæŒæ¡åç¨‹çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¹¶åœ¨å®é™…é¡¹ç›®ä¸­æœ‰æ•ˆåœ°åº”ç”¨åç¨‹æ¥æé«˜ç¨‹åºçš„æ€§èƒ½å’Œå¹¶å‘èƒ½åŠ›ã€‚</p><p>åœ¨Pythonçš„æœªæ¥å‘å±•ä¸­ï¼Œåç¨‹å°†ä¼šæ‰®æ¼”è¶Šæ¥è¶Šé‡è¦çš„è§’è‰²ï¼Œç‰¹åˆ«æ˜¯éšç€å¼‚æ­¥I/Oåº“çš„ä¸æ–­å®Œå–„å’Œæ™®åŠã€‚é€šè¿‡å­¦ä¹ å’ŒæŒæ¡åç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™æ›´åŠ é«˜æ•ˆã€ç®€æ´çš„Pythonä»£ç ï¼Œåº”å¯¹æ—¥ç›Šå¤æ‚çš„å¹¶å‘ç¼–ç¨‹éœ€æ±‚ã€‚</p>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„æ¨¡å—å¯¼å…¥æœºåˆ¶ä¸åŒ…ç®¡ç† é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585255</link>    <guid>https://segmentfault.com/a/1190000047585255</guid>    <pubDate>2026-02-01 02:07:22</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„æ¨¡å—å¯¼å…¥æœºåˆ¶ä¸åŒ…ç®¡ç†</h2><h3>1. æ¨¡å—ä¸åŒ…çš„åŸºæœ¬æ¦‚å¿µ</h3><p>åœ¨Pythonä¸­ï¼Œæ¨¡å—ï¼ˆModuleï¼‰å’ŒåŒ…ï¼ˆPackageï¼‰æ˜¯ç»„ç»‡ä»£ç çš„åŸºæœ¬å•ä½ã€‚ç†è§£æ¨¡å—å’ŒåŒ…çš„æ¦‚å¿µæ˜¯æŒæ¡Pythonå¯¼å…¥æœºåˆ¶çš„åŸºç¡€ã€‚</p><h4>1.1 æ¨¡å—çš„å®šä¹‰</h4><p>æ¨¡å—æ˜¯ä¸€ä¸ªåŒ…å«Pythonå®šä¹‰å’Œè¯­å¥çš„æ–‡ä»¶ï¼Œæ–‡ä»¶åå°±æ˜¯æ¨¡å—ååŠ ä¸Š<code>.py</code>åç¼€ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåä¸º<code>example.py</code>çš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªåä¸º<code>example</code>çš„æ¨¡å—ã€‚</p><p>æ¨¡å—çš„ä¸»è¦ä½œç”¨ï¼š</p><ul><li><strong>ä»£ç ç»„ç»‡</strong>ï¼šå°†ç›¸å…³çš„ä»£ç ç»„ç»‡åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§</li><li><strong>ä»£ç é‡ç”¨</strong>ï¼šé€šè¿‡å¯¼å…¥æœºåˆ¶ï¼Œæ¨¡å—å¯ä»¥è¢«å…¶ä»–ä»£ç é‡ç”¨</li><li><strong>å‘½åç©ºé—´éš”ç¦»</strong>ï¼šæ¯ä¸ªæ¨¡å—æœ‰è‡ªå·±çš„å‘½åç©ºé—´ï¼Œé¿å…å‘½åå†²çª</li></ul><h4>1.2 åŒ…çš„å®šä¹‰</h4><p>åŒ…æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„ç›®å½•ï¼Œå®ƒå¿…é¡»åŒ…å«ä¸€ä¸ªåä¸º<code>__init__.py</code>çš„æ–‡ä»¶ï¼ˆåœ¨Python 3.3+ä¸­ï¼Œ<code>__init__.py</code>æ–‡ä»¶æ˜¯å¯é€‰çš„ï¼Œä½†ä¸ºäº†ä¿æŒå…¼å®¹æ€§ï¼Œå»ºè®®ä»ç„¶æ·»åŠ ï¼‰ã€‚</p><p>åŒ…çš„ä¸»è¦ä½œç”¨ï¼š</p><ul><li><strong>å±‚æ¬¡åŒ–ç»„ç»‡</strong>ï¼šå°†ç›¸å…³çš„æ¨¡å—ç»„ç»‡åˆ°ä¸€ä¸ªç›®å½•ç»“æ„ä¸­</li><li><strong>å‘½åç©ºé—´ç®¡ç†</strong>ï¼šé€šè¿‡åŒ…çš„å±‚æ¬¡ç»“æ„ï¼Œæä¾›æ›´æ¸…æ™°çš„å‘½åç©ºé—´</li><li><strong>æ¨¡å—åˆ†ç»„</strong>ï¼šå°†åŠŸèƒ½ç›¸å…³çš„æ¨¡å—åˆ†ç»„åˆ°ä¸€ä¸ªåŒ…ä¸­</li></ul><h4>1.3 æ¨¡å—ä¸åŒ…çš„å…³ç³»</h4><p>æ¨¡å—å’ŒåŒ…çš„å…³ç³»å¯ä»¥ç†è§£ä¸ºï¼š</p><ul><li><strong>æ¨¡å—</strong>ï¼šå•ä¸ªPythonæ–‡ä»¶ï¼Œæ˜¯ä»£ç ç»„ç»‡çš„æœ€å°å•ä½</li><li><strong>åŒ…</strong>ï¼šåŒ…å«å¤šä¸ªæ¨¡å—çš„ç›®å½•ï¼Œæ˜¯æ¨¡å—çš„é›†åˆ</li></ul><pre><code class="python"># æ¨¡å—ä¸åŒ…çš„åŸºæœ¬æ¦‚å¿µç¤ºä¾‹

# 1. åˆ›å»ºä¸€ä¸ªç®€å•çš„æ¨¡å—
# æ–‡ä»¶å: mymodule.py
"""
è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ¨¡å—
"""

# æ¨¡å—çº§å˜é‡
MODULE_VAR = "è¿™æ˜¯æ¨¡å—çº§å˜é‡"

# æ¨¡å—çº§å‡½æ•°
def module_function():
    """æ¨¡å—çº§å‡½æ•°"""
    return "è¿™æ˜¯æ¨¡å—çº§å‡½æ•°çš„è¿”å›å€¼"

# æ¨¡å—çº§ç±»
class ModuleClass:
    """æ¨¡å—çº§ç±»"""
    def __init__(self, name):
        self.name = name
    
    def get_name(self):
        return self.name

# 2. åˆ›å»ºä¸€ä¸ªç®€å•çš„åŒ…
# ç›®å½•ç»“æ„:
# mypackage/
#     __init__.py
#     module1.py
#     module2.py

# æ–‡ä»¶å: mypackage/__init__.py
"""
è¿™æ˜¯mypackageåŒ…çš„åˆå§‹åŒ–æ–‡ä»¶
"""

# åŒ…çº§å˜é‡
PACKAGE_VAR = "è¿™æ˜¯åŒ…çº§å˜é‡"

# ä»å­æ¨¡å—å¯¼å…¥
from . import module1
from . import module2

# æ–‡ä»¶å: mypackage/module1.py
"""
è¿™æ˜¯mypackageåŒ…çš„module1æ¨¡å—
"""

def function1():
    return "module1çš„å‡½æ•°"

# æ–‡ä»¶å: mypackage/module2.py
"""
è¿™æ˜¯mypackageåŒ…çš„module2æ¨¡å—
"""

def function2():
    return "module2çš„å‡½æ•°"

# 3. æµ‹è¯•æ¨¡å—å’ŒåŒ…çš„å¯¼å…¥
# æ–‡ä»¶å: test_import.py

# å¯¼å…¥æ¨¡å—
import mymodule

# ä½¿ç”¨æ¨¡å—ä¸­çš„å†…å®¹
print("æ¨¡å—å¯¼å…¥æµ‹è¯•ï¼š")
print(f"æ¨¡å—çº§å˜é‡: {mymodule.MODULE_VAR}")
print(f"æ¨¡å—çº§å‡½æ•°: {mymodule.module_function()}")

# åˆ›å»ºæ¨¡å—ç±»çš„å®ä¾‹
obj = mymodule.ModuleClass("æµ‹è¯•")
print(f"æ¨¡å—çº§ç±»: {obj.get_name()}")

# å¯¼å…¥åŒ…
import mypackage

# ä½¿ç”¨åŒ…ä¸­çš„å†…å®¹
print("\nåŒ…å¯¼å…¥æµ‹è¯•ï¼š")
print(f"åŒ…çº§å˜é‡: {mypackage.PACKAGE_VAR}")
print(f"module1å‡½æ•°: {mypackage.module1.function1()}")
print(f"module2å‡½æ•°: {mypackage.module2.function2()}")

# ä»åŒ…ä¸­å¯¼å…¥ç‰¹å®šæ¨¡å—
from mypackage import module1
print(f"\nç›´æ¥å¯¼å…¥module1: {module1.function1()}")

# ä»æ¨¡å—ä¸­å¯¼å…¥ç‰¹å®šå†…å®¹
from mymodule import MODULE_VAR, module_function
print(f"\nç›´æ¥å¯¼å…¥æ¨¡å—å†…å®¹: {MODULE_VAR}, {module_function()}")</code></pre><h3>2. Pythonçš„å¯¼å…¥æœºåˆ¶</h3><p>Pythonçš„å¯¼å…¥æœºåˆ¶æ˜¯ä¸€ä¸ªå¤æ‚ä½†å¼ºå¤§çš„ç³»ç»Ÿï¼Œå®ƒè´Ÿè´£æŸ¥æ‰¾ã€åŠ è½½å’Œåˆå§‹åŒ–æ¨¡å—ã€‚ç†è§£å¯¼å…¥æœºåˆ¶å¯¹äºæŒæ¡Pythonç¼–ç¨‹è‡³å…³é‡è¦ã€‚</p><h4>2.1 å¯¼å…¥è¯­å¥çš„ç±»å‹</h4><p>Pythonæä¾›äº†å¤šç§å¯¼å…¥è¯­å¥ï¼Œç”¨äºä¸åŒçš„å¯¼å…¥åœºæ™¯ï¼š</p><ul><li><strong><code>import module</code></strong>ï¼šå¯¼å…¥æ•´ä¸ªæ¨¡å—</li><li><strong><code>from module import name</code></strong>ï¼šä»æ¨¡å—ä¸­å¯¼å…¥ç‰¹å®šåç§°</li><li><strong><code>from module import *</code></strong>ï¼šä»æ¨¡å—ä¸­å¯¼å…¥æ‰€æœ‰åç§°ï¼ˆä¸æ¨èï¼‰</li><li><strong><code>import module as alias</code></strong>ï¼šå¯¼å…¥æ¨¡å—å¹¶ä½¿ç”¨åˆ«å</li><li><strong><code>from module import name as alias</code></strong>ï¼šä»æ¨¡å—ä¸­å¯¼å…¥ç‰¹å®šåç§°å¹¶ä½¿ç”¨åˆ«å</li></ul><h4>2.2 å¯¼å…¥æœºåˆ¶çš„å·¥ä½œåŸç†</h4><p>Pythonçš„å¯¼å…¥æœºåˆ¶å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><ol><li><strong>æŸ¥æ‰¾æ¨¡å—</strong>ï¼šæ ¹æ®å¯¼å…¥è·¯å¾„æŸ¥æ‰¾æ¨¡å—æ–‡ä»¶</li><li><strong>åŠ è½½æ¨¡å—</strong>ï¼šå°†æ¨¡å—æ–‡ä»¶ç¼–è¯‘ä¸ºå­—èŠ‚ç å¹¶åŠ è½½åˆ°å†…å­˜</li><li><strong>åˆå§‹åŒ–æ¨¡å—</strong>ï¼šæ‰§è¡Œæ¨¡å—ä¸­çš„ä»£ç ï¼Œåˆå§‹åŒ–æ¨¡å—çš„å‘½åç©ºé—´</li><li><strong>ç¼“å­˜æ¨¡å—</strong>ï¼šå°†æ¨¡å—å¯¹è±¡ç¼“å­˜åˆ°<code>sys.modules</code>ä¸­ï¼Œé¿å…é‡å¤å¯¼å…¥</li></ol><h4>2.3 å¯¼å…¥è·¯å¾„</h4><p>Pythonåœ¨å¯¼å…¥æ¨¡å—æ—¶ï¼Œä¼šæŒ‰ç…§ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾æ¨¡å—ï¼š</p><ol><li><strong>å½“å‰ç›®å½•</strong>ï¼šé¦–å…ˆæŸ¥æ‰¾å½“å‰æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•</li><li><strong><code>PYTHONPATH</code>ç¯å¢ƒå˜é‡</strong>ï¼šæŸ¥æ‰¾<code>PYTHONPATH</code>ç¯å¢ƒå˜é‡ä¸­æŒ‡å®šçš„ç›®å½•</li><li><strong>æ ‡å‡†åº“ç›®å½•</strong>ï¼šæŸ¥æ‰¾Pythonæ ‡å‡†åº“æ‰€åœ¨çš„ç›®å½•</li><li><strong>ç¬¬ä¸‰æ–¹åº“ç›®å½•</strong>ï¼šæŸ¥æ‰¾é€šè¿‡pipç­‰åŒ…ç®¡ç†å™¨å®‰è£…çš„ç¬¬ä¸‰æ–¹åº“ç›®å½•</li><li><strong><code>.pth</code>æ–‡ä»¶</strong>ï¼šæŸ¥æ‰¾<code>.pth</code>æ–‡ä»¶ä¸­æŒ‡å®šçš„ç›®å½•</li></ol><pre><code class="python"># å¯¼å…¥æœºåˆ¶çš„å·¥ä½œåŸç†ç¤ºä¾‹
import sys
import os

# æŸ¥çœ‹å¯¼å…¥è·¯å¾„
print("Pythonå¯¼å…¥è·¯å¾„ï¼š")
for path in sys.path:
    print(f"  {path}")

# æŸ¥çœ‹å·²å¯¼å…¥çš„æ¨¡å—
print("\nå·²å¯¼å…¥çš„æ¨¡å—ï¼š")
for module_name in list(sys.modules.keys())[:20]:  # åªæ˜¾ç¤ºå‰20ä¸ª
    print(f"  {module_name}")

# æµ‹è¯•æ¨¡å—å¯¼å…¥
print("\næµ‹è¯•æ¨¡å—å¯¼å…¥ï¼š")

# å¯¼å…¥ä¸€ä¸ªæ ‡å‡†åº“æ¨¡å—
import math
print(f"å¯¼å…¥mathæ¨¡å—ï¼š{math}")
print(f"mathæ¨¡å—è·¯å¾„ï¼š{math.__file__}")

# å¯¼å…¥ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“æ¨¡å—ï¼ˆå¦‚æœå·²å®‰è£…ï¼‰
try:
    import numpy
    print(f"\nå¯¼å…¥numpyæ¨¡å—ï¼š{numpy}")
    print(f"numpyæ¨¡å—è·¯å¾„ï¼š{numpy.__file__}")
except ImportError:
    print("\nnumpyæ¨¡å—æœªå®‰è£…")

# æµ‹è¯•æ¨¡å—ç¼“å­˜
print("\næµ‹è¯•æ¨¡å—ç¼“å­˜ï¼š")
print(f"mathæ¨¡å—æ˜¯å¦åœ¨sys.modulesä¸­ï¼š{'math' in sys.modules}")

# åˆ é™¤æ¨¡å—ç¼“å­˜å¹¶é‡æ–°å¯¼å…¥
if 'math' in sys.modules:
    del sys.modules['math']
    print(f"åˆ é™¤mathæ¨¡å—ç¼“å­˜åï¼Œæ˜¯å¦åœ¨sys.modulesä¸­ï¼š{'math' in sys.modules}")
    
    # é‡æ–°å¯¼å…¥
    import math
    print(f"é‡æ–°å¯¼å…¥åï¼Œmathæ¨¡å—ï¼š{math}")

# æµ‹è¯•å¯¼å…¥è·¯å¾„çš„ä¿®æ”¹
print("\næµ‹è¯•å¯¼å…¥è·¯å¾„çš„ä¿®æ”¹ï¼š")

# æ·»åŠ è‡ªå®šä¹‰è·¯å¾„
custom_path = os.path.join(os.getcwd(), "custom_modules")
sys.path.insert(0, custom_path)
print(f"æ·»åŠ è‡ªå®šä¹‰è·¯å¾„ï¼š{custom_path}")
print(f"è‡ªå®šä¹‰è·¯å¾„æ˜¯å¦åœ¨sys.pathä¸­ï¼š{custom_path in sys.path}")

# å°è¯•å¯¼å…¥è‡ªå®šä¹‰æ¨¡å—
try:
    import custom_module
    print("å¯¼å…¥è‡ªå®šä¹‰æ¨¡å—æˆåŠŸ")
except ImportError:
    print("å¯¼å…¥è‡ªå®šä¹‰æ¨¡å—å¤±è´¥ï¼ˆè‡ªå®šä¹‰æ¨¡å—å¯èƒ½ä¸å­˜åœ¨ï¼‰")</code></pre><h4>2.4 æ¨¡å—çš„åŠ è½½ä¸åˆå§‹åŒ–</h4><p>æ¨¡å—çš„åŠ è½½ä¸åˆå§‹åŒ–è¿‡ç¨‹åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><strong>æŸ¥æ‰¾æ¨¡å—æ–‡ä»¶</strong>ï¼šæ ¹æ®å¯¼å…¥è·¯å¾„æŸ¥æ‰¾æ¨¡å—æ–‡ä»¶</li><li><strong>ç¼–è¯‘æ¨¡å—</strong>ï¼šå°†æ¨¡å—æ–‡ä»¶ç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼ˆ<code>.pyc</code>æ–‡ä»¶ï¼‰</li><li><strong>åˆ›å»ºæ¨¡å—å¯¹è±¡</strong>ï¼šåˆ›å»ºä¸€ä¸ªæ¨¡å—å¯¹è±¡ï¼Œå­˜å‚¨åœ¨<code>sys.modules</code>ä¸­</li><li><strong>æ‰§è¡Œæ¨¡å—ä»£ç </strong>ï¼šæ‰§è¡Œæ¨¡å—ä¸­çš„ä»£ç ï¼Œåˆå§‹åŒ–æ¨¡å—çš„å‘½åç©ºé—´</li><li><strong>è¿”å›æ¨¡å—å¯¹è±¡</strong>ï¼šå°†æ¨¡å—å¯¹è±¡è¿”å›ç»™å¯¼å…¥è€…</li></ol><p>æ¨¡å—çš„åˆå§‹åŒ–è¿‡ç¨‹åªåœ¨ç¬¬ä¸€æ¬¡å¯¼å…¥æ—¶æ‰§è¡Œï¼Œåç»­çš„å¯¼å…¥ä¼šç›´æ¥ä»<code>sys.modules</code>ä¸­è·å–å·²ç¼“å­˜çš„æ¨¡å—å¯¹è±¡ã€‚</p><pre><code class="python"># æ¨¡å—çš„åŠ è½½ä¸åˆå§‹åŒ–ç¤ºä¾‹

# åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ¨¡å—
# æ–‡ä»¶å: test_module.py

print("test_moduleæ¨¡å—åˆå§‹åŒ–å¼€å§‹")

# æ¨¡å—çº§å˜é‡
MODULE_VAR = "æ¨¡å—å˜é‡"

# æ¨¡å—çº§å‡½æ•°
def module_function():
    return "æ¨¡å—å‡½æ•°"

# æ¨¡å—åˆå§‹åŒ–ä»£ç 
print("test_moduleæ¨¡å—åˆå§‹åŒ–ä¸­")
print(f"æ¨¡å—å˜é‡å€¼: {MODULE_VAR}")
print("test_moduleæ¨¡å—åˆå§‹åŒ–å®Œæˆ")

# æµ‹è¯•æ¨¡å—çš„åŠ è½½ä¸åˆå§‹åŒ–
# æ–‡ä»¶å: test_module_load.py

import sys

print("ç¬¬ä¸€æ¬¡å¯¼å…¥æ¨¡å—ï¼š")
import test_module

print("\nç¬¬äºŒæ¬¡å¯¼å…¥æ¨¡å—ï¼š")
import test_module  # ä¼šä½¿ç”¨ç¼“å­˜çš„æ¨¡å—

print("\nä½¿ç”¨æ¨¡å—å†…å®¹ï¼š")
print(f"æ¨¡å—å˜é‡: {test_module.MODULE_VAR}")
print(f"æ¨¡å—å‡½æ•°: {test_module.module_function()}")

# æµ‹è¯•åˆ é™¤æ¨¡å—ç¼“å­˜åé‡æ–°å¯¼å…¥
print("\nåˆ é™¤æ¨¡å—ç¼“å­˜åé‡æ–°å¯¼å…¥ï¼š")
if 'test_module' in sys.modules:
    del sys.modules['test_module']
    import test_module  # ä¼šé‡æ–°åˆå§‹åŒ–æ¨¡å—

# æµ‹è¯•ä»æ¨¡å—ä¸­å¯¼å…¥ç‰¹å®šå†…å®¹
print("\nä»æ¨¡å—ä¸­å¯¼å…¥ç‰¹å®šå†…å®¹ï¼š")
from test_module import MODULE_VAR, module_function
print(f"å¯¼å…¥çš„å˜é‡: {MODULE_VAR}")
print(f"å¯¼å…¥çš„å‡½æ•°: {module_function()}")</code></pre><h3>3. åŒ…ç®¡ç†ç³»ç»Ÿ</h3><p>Pythonçš„åŒ…ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªç”¨äºå®‰è£…ã€å‡çº§ã€å¸è½½å’Œç®¡ç†PythonåŒ…çš„å·¥å…·é›†åˆã€‚ç†è§£åŒ…ç®¡ç†ç³»ç»Ÿå¯¹äºPythonå¼€å‘è‡³å…³é‡è¦ã€‚</p><h4>3.1 åŒ…ç®¡ç†å·¥å…·</h4><p>Pythonçš„ä¸»è¦åŒ…ç®¡ç†å·¥å…·åŒ…æ‹¬ï¼š</p><ul><li><strong>pip</strong>ï¼šPythonçš„é»˜è®¤åŒ…ç®¡ç†å·¥å…·ï¼Œç”¨äºå®‰è£…å’Œç®¡ç†PythonåŒ…</li><li><strong>conda</strong>ï¼šAnacondaå‘è¡Œç‰ˆçš„åŒ…ç®¡ç†å·¥å…·ï¼Œæ”¯æŒPythonåŒ…å’ŒéPythonåŒ…</li><li><strong>poetry</strong>ï¼šä¸€ä¸ªç°ä»£åŒ–çš„Pythonä¾èµ–ç®¡ç†å’Œæ‰“åŒ…å·¥å…·</li><li><strong>pipenv</strong>ï¼šä¸€ä¸ªç»“åˆäº†pipå’ŒvirtualenvåŠŸèƒ½çš„åŒ…ç®¡ç†å·¥å…·</li></ul><h4>3.2 pipçš„ä½¿ç”¨</h4><p>pipæ˜¯Pythonæœ€å¸¸ç”¨çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå®ƒæä¾›äº†ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li><strong>å®‰è£…åŒ…</strong>ï¼š<code>pip install package_name</code></li><li><strong>å‡çº§åŒ…</strong>ï¼š<code>pip install --upgrade package_name</code></li><li><strong>å¸è½½åŒ…</strong>ï¼š<code>pip uninstall package_name</code></li><li><strong>æŸ¥çœ‹å·²å®‰è£…çš„åŒ…</strong>ï¼š<code>pip list</code></li><li><strong>æŸ¥çœ‹åŒ…çš„ä¿¡æ¯</strong>ï¼š<code>pip show package_name</code></li><li><strong>æœç´¢åŒ…</strong>ï¼š<code>pip search package_name</code></li><li><strong>å¯¼å‡ºä¾èµ–</strong>ï¼š<code>pip freeze &gt; requirements.txt</code></li><li><strong>å®‰è£…ä¾èµ–</strong>ï¼š<code>pip install -r requirements.txt</code></li></ul><h4>3.3 è™šæ‹Ÿç¯å¢ƒ</h4><p>è™šæ‹Ÿç¯å¢ƒæ˜¯ä¸€ä¸ªéš”ç¦»çš„Pythonç¯å¢ƒï¼Œå®ƒå…è®¸åœ¨ä¸åŒçš„é¡¹ç›®ä¸­ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„åŒ…ï¼Œé¿å…åŒ…ç‰ˆæœ¬å†²çªã€‚</p><p>Pythonçš„ä¸»è¦è™šæ‹Ÿç¯å¢ƒå·¥å…·åŒ…æ‹¬ï¼š</p><ul><li><strong>venv</strong>ï¼šPython 3.3+å†…ç½®çš„è™šæ‹Ÿç¯å¢ƒå·¥å…·</li><li><strong>virtualenv</strong>ï¼šä¸€ä¸ªç¬¬ä¸‰æ–¹çš„è™šæ‹Ÿç¯å¢ƒå·¥å…·ï¼Œæ”¯æŒPython 2å’ŒPython 3</li><li><strong>conda</strong>ï¼šAnacondaå‘è¡Œç‰ˆçš„è™šæ‹Ÿç¯å¢ƒå·¥å…·</li></ul><pre><code class="python"># åŒ…ç®¡ç†ç³»ç»Ÿç¤ºä¾‹

# 1. ä½¿ç”¨pipç®¡ç†åŒ…
# ä»¥ä¸‹å‘½ä»¤å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ

# å®‰è£…åŒ…
# pip install requests

# å‡çº§åŒ…
# pip install --upgrade requests

# å¸è½½åŒ…
# pip uninstall requests

# æŸ¥çœ‹å·²å®‰è£…çš„åŒ…
# pip list

# æŸ¥çœ‹åŒ…çš„ä¿¡æ¯
# pip show requests

# å¯¼å‡ºä¾èµ–
# pip freeze &gt; requirements.txt

# å®‰è£…ä¾èµ–
# pip install -r requirements.txt

# 2. ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
# ä»¥ä¸‹å‘½ä»¤å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
# python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆWindowsï¼‰
# venv\Scripts\activate

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆLinux/Macï¼‰
# source venv/bin/activate

# é€€å‡ºè™šæ‹Ÿç¯å¢ƒ
# deactivate

# 3. æµ‹è¯•è™šæ‹Ÿç¯å¢ƒ
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒåæ‰§è¡Œä»¥ä¸‹ä»£ç 

import sys
import os

print("Pythonè§£é‡Šå™¨è·¯å¾„ï¼š")
print(f"  {sys.executable}")

print("\nè™šæ‹Ÿç¯å¢ƒè·¯å¾„ï¼š")
venv_path = os.path.dirname(os.path.dirname(sys.executable))
print(f"  {venv_path}")

print("\næµ‹è¯•åŒ…å®‰è£…ï¼š")
try:
    import requests
    print("requestsæ¨¡å—å·²å®‰è£…")
except ImportError:
    print("requestsæ¨¡å—æœªå®‰è£…")

# 4. ä½¿ç”¨poetryç®¡ç†åŒ…
# ä»¥ä¸‹å‘½ä»¤å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ

# å®‰è£…poetry
# pip install poetry

# åˆå§‹åŒ–é¡¹ç›®
# poetry init

# å®‰è£…åŒ…
# poetry add requests

# å®‰è£…å¼€å‘ä¾èµ–
# poetry add --dev pytest

# æŸ¥çœ‹ä¾èµ–
# poetry show

# è¿è¡Œå‘½ä»¤
# poetry run python script.py</code></pre><h3>4. å¯¼å…¥è·¯å¾„ä¸æ¨¡å—æŸ¥æ‰¾</h3><p>ç†è§£Pythonçš„å¯¼å…¥è·¯å¾„å’Œæ¨¡å—æŸ¥æ‰¾æœºåˆ¶å¯¹äºè§£å†³å¯¼å…¥é—®é¢˜è‡³å…³é‡è¦ã€‚</p><h4>4.1 å¯¼å…¥è·¯å¾„çš„ç»„æˆ</h4><p>Pythonçš„å¯¼å…¥è·¯å¾„ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š</p><ol><li><strong>å½“å‰ç›®å½•</strong>ï¼š<code>''</code>ï¼Œè¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•</li><li><strong><code>PYTHONPATH</code>ç¯å¢ƒå˜é‡</strong>ï¼šç”¨æˆ·è®¾ç½®çš„Pythonå¯¼å…¥è·¯å¾„</li><li><strong>æ ‡å‡†åº“ç›®å½•</strong>ï¼šPythonæ ‡å‡†åº“æ‰€åœ¨çš„ç›®å½•</li><li><strong>ç¬¬ä¸‰æ–¹åº“ç›®å½•</strong>ï¼šé€šè¿‡pipç­‰åŒ…ç®¡ç†å™¨å®‰è£…çš„ç¬¬ä¸‰æ–¹åº“ç›®å½•</li><li><strong><code>.pth</code>æ–‡ä»¶</strong>ï¼šåŒ…å«é¢å¤–å¯¼å…¥è·¯å¾„çš„æ–‡ä»¶</li></ol><h4>4.2 æ¨¡å—æŸ¥æ‰¾çš„é¡ºåº</h4><p>Pythonåœ¨å¯¼å…¥æ¨¡å—æ—¶ï¼Œä¼šæŒ‰ç…§ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾ï¼š</p><ol><li><strong>å†…ç½®æ¨¡å—</strong>ï¼šé¦–å…ˆæŸ¥æ‰¾å†…ç½®æ¨¡å—ï¼Œå¦‚<code>math</code>ã€<code>sys</code>ç­‰</li><li><strong><code>sys.modules</code>ç¼“å­˜</strong>ï¼šæŸ¥æ‰¾å·²å¯¼å…¥çš„æ¨¡å—ç¼“å­˜</li><li><strong>å¯¼å…¥è·¯å¾„</strong>ï¼šæŒ‰ç…§<code>sys.path</code>ä¸­çš„é¡ºåºæŸ¥æ‰¾æ¨¡å—æ–‡ä»¶</li></ol><h4>4.3 æ¨¡å—æ–‡ä»¶çš„ç±»å‹</h4><p>Pythonå¯ä»¥å¯¼å…¥å¤šç§ç±»å‹çš„æ¨¡å—æ–‡ä»¶ï¼š</p><ul><li><strong><code>.py</code>æ–‡ä»¶</strong>ï¼šPythonæºä»£ç æ–‡ä»¶</li><li><strong><code>.pyc</code>æ–‡ä»¶</strong>ï¼šPythonå­—èŠ‚ç æ–‡ä»¶</li><li><strong><code>.pyo</code>æ–‡ä»¶</strong>ï¼šä¼˜åŒ–çš„Pythonå­—èŠ‚ç æ–‡ä»¶</li><li><strong><code>.so</code>/<code>.dll</code>æ–‡ä»¶</strong>ï¼šCæ‰©å±•æ¨¡å—</li><li><strong>ç›®å½•</strong>ï¼šåŒ…å«<code>__init__.py</code>æ–‡ä»¶çš„ç›®å½•ï¼ˆåŒ…ï¼‰</li></ul><pre><code class="python"># å¯¼å…¥è·¯å¾„ä¸æ¨¡å—æŸ¥æ‰¾ç¤ºä¾‹
import sys
import os
import importlib

# æŸ¥çœ‹å¯¼å…¥è·¯å¾„
print("Pythonå¯¼å…¥è·¯å¾„ï¼š")
for i, path in enumerate(sys.path):
    print(f"  {i}: {path}")

# æµ‹è¯•æ¨¡å—æŸ¥æ‰¾
print("\næµ‹è¯•æ¨¡å—æŸ¥æ‰¾ï¼š")

# æŸ¥æ‰¾å†…ç½®æ¨¡å—
print("æŸ¥æ‰¾å†…ç½®æ¨¡å— 'math'ï¼š")
print(f"'math' in sys.builtin_module_names: {'math' in sys.builtin_module_names}")

# æŸ¥æ‰¾æ ‡å‡†åº“æ¨¡å—
print("\næŸ¥æ‰¾æ ‡å‡†åº“æ¨¡å— 'os'ï¼š")
import os
print(f"osæ¨¡å—è·¯å¾„ï¼š{os.__file__}")

# æŸ¥æ‰¾ç¬¬ä¸‰æ–¹åº“æ¨¡å—ï¼ˆå¦‚æœå·²å®‰è£…ï¼‰
try:
    import numpy
    print("\næŸ¥æ‰¾ç¬¬ä¸‰æ–¹åº“æ¨¡å— 'numpy'ï¼š")
    print(f"numpyæ¨¡å—è·¯å¾„ï¼š{numpy.__file__}")
except ImportError:
    print("\nnumpyæ¨¡å—æœªå®‰è£…")

# æµ‹è¯•è‡ªå®šä¹‰æ¨¡å—çš„æŸ¥æ‰¾
print("\næµ‹è¯•è‡ªå®šä¹‰æ¨¡å—çš„æŸ¥æ‰¾ï¼š")

# åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ¨¡å—æ–‡ä»¶
module_content = '''
def test_function():
    return "æµ‹è¯•å‡½æ•°"
'''

# å†™å…¥ä¸´æ—¶æ¨¡å—æ–‡ä»¶
with open("temp_module.py", "w") as f:
    f.write(module_content)

# å¯¼å…¥ä¸´æ—¶æ¨¡å—
try:
    import temp_module
    print("æˆåŠŸå¯¼å…¥ä¸´æ—¶æ¨¡å—")
    print(f"ä¸´æ—¶æ¨¡å—è·¯å¾„ï¼š{temp_module.__file__}")
    print(f"æµ‹è¯•å‡½æ•°è¿”å›å€¼ï¼š{temp_module.test_function()}")
except ImportError as e:
    print(f"å¯¼å…¥ä¸´æ—¶æ¨¡å—å¤±è´¥ï¼š{e}")

# æ¸…ç†ä¸´æ—¶æ¨¡å—
if 'temp_module' in sys.modules:
    del sys.modules['temp_module']

if os.path.exists("temp_module.py"):
    os.remove("temp_module.py")

if os.path.exists("temp_module.pyc"):
    os.remove("temp_module.pyc")

# æµ‹è¯•å¯¼å…¥è·¯å¾„çš„ä¿®æ”¹
print("\næµ‹è¯•å¯¼å…¥è·¯å¾„çš„ä¿®æ”¹ï¼š")

# åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•
if not os.path.exists("test_modules"):
    os.makedirs("test_modules")

# åœ¨ä¸´æ—¶ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ¨¡å—æ–‡ä»¶
with open("test_modules/my_module.py", "w") as f:
    f.write('def my_function(): return "æˆ‘çš„å‡½æ•°"')

# æ·»åŠ ä¸´æ—¶ç›®å½•åˆ°å¯¼å…¥è·¯å¾„
sys.path.insert(0, "test_modules")
print("æ·»åŠ ä¸´æ—¶ç›®å½•åˆ°å¯¼å…¥è·¯å¾„")

# å¯¼å…¥æ¨¡å—
try:
    import my_module
    print("æˆåŠŸå¯¼å…¥my_moduleæ¨¡å—")
    print(f"my_functionè¿”å›å€¼ï¼š{my_module.my_function()}")
except ImportError as e:
    print(f"å¯¼å…¥my_moduleæ¨¡å—å¤±è´¥ï¼š{e}")

# æ¸…ç†
if 'my_module' in sys.modules:
    del sys.modules['my_module']

import shutil
if os.path.exists("test_modules"):
    shutil.rmtree("test_modules")</code></pre><h3>5. ç›¸å¯¹å¯¼å…¥ä¸ç»å¯¹å¯¼å…¥</h3><p>Pythonæ”¯æŒä¸¤ç§å¯¼å…¥æ–¹å¼ï¼šç›¸å¯¹å¯¼å…¥å’Œç»å¯¹å¯¼å…¥ã€‚ç†è§£è¿™ä¸¤ç§å¯¼å…¥æ–¹å¼çš„åŒºåˆ«å¯¹äºæ­£ç¡®ç»„ç»‡åŒ…ç»“æ„è‡³å…³é‡è¦ã€‚</p><h4>5.1 ç»å¯¹å¯¼å…¥</h4><p>ç»å¯¹å¯¼å…¥æ˜¯æŒ‡ä»åŒ…çš„æ ¹ç›®å½•å¼€å§‹çš„å¯¼å…¥ï¼Œä½¿ç”¨å®Œæ•´çš„åŒ…è·¯å¾„ã€‚ä¾‹å¦‚ï¼š</p><pre><code class="python">from package.module import function
import package.module</code></pre><p>ç»å¯¹å¯¼å…¥çš„ä¼˜ç‚¹ï¼š</p><ul><li><strong>æ˜ç¡®æ€§</strong>ï¼šå¯¼å…¥è·¯å¾„æ¸…æ™°æ˜ç¡®ï¼Œæ˜“äºç†è§£</li><li><strong>é¿å…å†²çª</strong>ï¼šé¿å…ä¸æ ‡å‡†åº“æ¨¡å—æˆ–ç¬¬ä¸‰æ–¹åº“æ¨¡å—çš„å‘½åå†²çª</li><li><strong>å¯ç»´æŠ¤æ€§</strong>ï¼šå½“åŒ…ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»å¯¹å¯¼å…¥æ›´å®¹æ˜“è°ƒæ•´</li></ul><h4>5.2 ç›¸å¯¹å¯¼å…¥</h4><p>ç›¸å¯¹å¯¼å…¥æ˜¯æŒ‡ä»å½“å‰åŒ…å¼€å§‹çš„å¯¼å…¥ï¼Œä½¿ç”¨ç‚¹å·è¡¨ç¤ºç›¸å¯¹è·¯å¾„ã€‚ä¾‹å¦‚ï¼š</p><pre><code class="python">from . import module  # å¯¼å…¥åŒçº§æ¨¡å—
from .module import function  # å¯¼å…¥åŒçº§æ¨¡å—ä¸­çš„å‡½æ•°
from .. import module  # å¯¼å…¥çˆ¶çº§åŒ…ä¸­çš„æ¨¡å—
from ..module import function  # å¯¼å…¥çˆ¶çº§åŒ…ä¸­çš„æ¨¡å—ä¸­çš„å‡½æ•°</code></pre><p>ç›¸å¯¹å¯¼å…¥çš„ä¼˜ç‚¹ï¼š</p><ul><li><strong>çµæ´»æ€§</strong>ï¼šå½“åŒ…çš„åç§°æˆ–ä½ç½®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç›¸å¯¹å¯¼å…¥ä¸éœ€è¦ä¿®æ”¹</li><li><strong>ç®€æ´æ€§</strong>ï¼šå¯¹äºåŒ…å†…éƒ¨çš„æ¨¡å—å¯¼å…¥ï¼Œç›¸å¯¹å¯¼å…¥æ›´ç®€æ´</li></ul><h4>5.3 ç›¸å¯¹å¯¼å…¥ä¸ç»å¯¹å¯¼å…¥çš„é€‰æ‹©</h4><p>åœ¨é€‰æ‹©ç›¸å¯¹å¯¼å…¥è¿˜æ˜¯ç»å¯¹å¯¼å…¥æ—¶ï¼Œåº”è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š</p><ul><li><strong>åŒ…å†…éƒ¨å¯¼å…¥</strong>ï¼šå¯¹äºåŒ…å†…éƒ¨çš„æ¨¡å—å¯¼å…¥ï¼Œç›¸å¯¹å¯¼å…¥æ›´ç®€æ´</li><li><strong>è·¨åŒ…å¯¼å…¥</strong>ï¼šå¯¹äºè·¨åŒ…çš„æ¨¡å—å¯¼å…¥ï¼Œç»å¯¹å¯¼å…¥æ›´æ˜ç¡®</li><li><strong>å¯è¯»æ€§</strong>ï¼šå¦‚æœåŒ…ç»“æ„è¾ƒå¤æ‚ï¼Œç»å¯¹å¯¼å…¥å¯èƒ½æ›´æ˜“è¯»</li><li><strong>å…¼å®¹æ€§</strong>ï¼šåœ¨Python 3ä¸­ï¼Œé»˜è®¤ä½¿ç”¨ç»å¯¹å¯¼å…¥</li></ul><pre><code class="python"># ç›¸å¯¹å¯¼å…¥ä¸ç»å¯¹å¯¼å…¥ç¤ºä¾‹

# åŒ…ç»“æ„ï¼š
# mypackage/
#     __init__.py
#     module1.py
#     module2.py
#     subpackage/
#         __init__.py
#         submodule.py

# æ–‡ä»¶å: mypackage/__init__.py
"""
mypackageåŒ…çš„åˆå§‹åŒ–æ–‡ä»¶
"""

# ç»å¯¹å¯¼å…¥
import mypackage.module1
import mypackage.module2

# ç›¸å¯¹å¯¼å…¥
from . import module1
from . import module2

# æ–‡ä»¶å: mypackage/module1.py
"""
module1æ¨¡å—
"""

def function1():
    return "module1çš„å‡½æ•°"

# å¯¼å…¥åŒçº§æ¨¡å—
from . import module2
print(f"module1å¯¼å…¥module2: {module2.function2()}")

# æ–‡ä»¶å: mypackage/module2.py
"""
module2æ¨¡å—
"""

def function2():
    return "module2çš„å‡½æ•°"

# æ–‡ä»¶å: mypackage/subpackage/__init__.py
"""
subpackageåŒ…çš„åˆå§‹åŒ–æ–‡ä»¶
"""

# å¯¼å…¥çˆ¶çº§åŒ…ä¸­çš„æ¨¡å—
from .. import module1
print(f"subpackageå¯¼å…¥module1: {module1.function1()}")

# æ–‡ä»¶å: mypackage/subpackage/submodule.py
"""
submoduleæ¨¡å—
"""

def sub_function():
    return "submoduleçš„å‡½æ•°"

# å¯¼å…¥çˆ¶çº§åŒ…ä¸­çš„æ¨¡å—
from .. import module1
print(f"submoduleå¯¼å…¥module1: {module1.function1()}")

# å¯¼å…¥åŒçº§æ¨¡å—
from . import other_module  # å‡è®¾å­˜åœ¨other_moduleæ¨¡å—

# æµ‹è¯•å¯¼å…¥
# æ–‡ä»¶å: test_imports.py

# ç»å¯¹å¯¼å…¥
import mypackage
print(f"ç»å¯¹å¯¼å…¥mypackage: {mypackage}")

from mypackage import module1
print(f"ç»å¯¹å¯¼å…¥module1: {module1.function1()}")

from mypackage.subpackage import submodule
print(f"ç»å¯¹å¯¼å…¥submodule: {submodule.sub_function()}")

# æµ‹è¯•ç›¸å¯¹å¯¼å…¥çš„é™åˆ¶
print("\nç›¸å¯¹å¯¼å…¥çš„é™åˆ¶ï¼š")
print("ç›¸å¯¹å¯¼å…¥åªèƒ½åœ¨åŒ…å†…éƒ¨ä½¿ç”¨ï¼Œä¸èƒ½åœ¨è„šæœ¬ä¸­ç›´æ¥ä½¿ç”¨")</code></pre><h3>6. æ¨¡å—ç¼“å­˜ä¸é‡è½½</h3><p>Pythonä¼šç¼“å­˜å·²å¯¼å…¥çš„æ¨¡å—ï¼Œä»¥æé«˜å¯¼å…¥æ•ˆç‡ã€‚ç†è§£æ¨¡å—ç¼“å­˜å’Œé‡è½½æœºåˆ¶å¯¹äºå¼€å‘å’Œè°ƒè¯•éå¸¸é‡è¦ã€‚</p><h4>6.1 æ¨¡å—ç¼“å­˜</h4><p>å½“æ¨¡å—è¢«å¯¼å…¥æ—¶ï¼ŒPythonä¼šå°†æ¨¡å—å¯¹è±¡ç¼“å­˜åˆ°<code>sys.modules</code>å­—å…¸ä¸­ã€‚åç»­çš„å¯¼å…¥ä¼šç›´æ¥ä»ç¼“å­˜ä¸­è·å–æ¨¡å—å¯¹è±¡ï¼Œè€Œä¸ä¼šé‡æ–°åŠ è½½å’Œåˆå§‹åŒ–æ¨¡å—ã€‚</p><p>æ¨¡å—ç¼“å­˜çš„ä¼˜ç‚¹ï¼š</p><ul><li><strong>æé«˜æ€§èƒ½</strong>ï¼šé¿å…é‡å¤åŠ è½½å’Œåˆå§‹åŒ–æ¨¡å—</li><li><strong>ä¿æŒçŠ¶æ€</strong>ï¼šæ¨¡å—çš„çŠ¶æ€åœ¨å¤šæ¬¡å¯¼å…¥ä¹‹é—´ä¿æŒä¸€è‡´</li></ul><h4>6.2 æ¨¡å—é‡è½½</h4><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¿®æ”¹æ¨¡å—ä»£ç åé‡æ–°åŠ è½½æ¨¡å—ã€‚Pythonæä¾›äº†<code>importlib.reload()</code>å‡½æ•°æ¥é‡è½½æ¨¡å—ã€‚</p><p>æ¨¡å—é‡è½½çš„æ³¨æ„äº‹é¡¹ï¼š</p><ul><li><strong>åªé‡è½½æ¨¡å—æœ¬èº«</strong>ï¼š<code>reload()</code>åªé‡è½½æ¨¡å—æœ¬èº«ï¼Œä¸ä¼šé‡è½½æ¨¡å—å¯¼å…¥çš„å…¶ä»–æ¨¡å—</li><li><strong>ä¿æŒæ¨¡å—å¯¹è±¡</strong>ï¼š<code>reload()</code>ä¼šé‡ç”¨ç°æœ‰çš„æ¨¡å—å¯¹è±¡ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°çš„æ¨¡å—å¯¹è±¡</li><li><strong>æ›´æ–°å‘½åç©ºé—´</strong>ï¼š<code>reload()</code>ä¼šæ›´æ–°æ¨¡å—çš„å‘½åç©ºé—´ï¼Œä½†ä¸ä¼šæ›´æ–°å·²å¯¼å…¥çš„åç§°</li><li><strong>å¯èƒ½å¯¼è‡´é—®é¢˜</strong>ï¼šé‡è½½æ¨¡å—å¯èƒ½ä¼šå¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ï¼Œåº”è°¨æ…ä½¿ç”¨</li></ul><pre><code class="python"># æ¨¡å—ç¼“å­˜ä¸é‡è½½ç¤ºä¾‹
import sys
import importlib
import os

# åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ¨¡å—
module_content = '''
# æ¨¡å—çº§å˜é‡
counter = 0

# æ¨¡å—çº§å‡½æ•°
def increment():
    global counter
    counter += 1
    return counter

print(f"æ¨¡å—åˆå§‹åŒ–ï¼Œcounter={counter}")
'''

# å†™å…¥æµ‹è¯•æ¨¡å—æ–‡ä»¶
with open("reload_test.py", "w") as f:
    f.write(module_content)

# ç¬¬ä¸€æ¬¡å¯¼å…¥æ¨¡å—
print("ç¬¬ä¸€æ¬¡å¯¼å…¥æ¨¡å—ï¼š")
import reload_test
print(f"counteråˆå§‹å€¼: {reload_test.counter}")
print(f"è°ƒç”¨increment(): {reload_test.increment()}")
print(f"counterå€¼: {reload_test.counter}")

# ä¿®æ”¹æ¨¡å—ä»£ç 
print("\nä¿®æ”¹æ¨¡å—ä»£ç ï¼š")
new_module_content = '''
# æ¨¡å—çº§å˜é‡
counter = 100

# æ¨¡å—çº§å‡½æ•°
def increment():
    global counter
    counter += 1
    return counter

# æ–°å¢å‡½æ•°
def reset():
    global counter
    counter = 0
    return counter

print(f"æ¨¡å—åˆå§‹åŒ–ï¼Œcounter={counter}")
'''

with open("reload_test.py", "w") as f:
    f.write(new_module_content)

# æµ‹è¯•æ¨¡å—ç¼“å­˜
print("\næµ‹è¯•æ¨¡å—ç¼“å­˜ï¼š")
print(f"counterå€¼ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰: {reload_test.counter}")
print(f"è°ƒç”¨increment(): {reload_test.increment()}")
print(f"counterå€¼: {reload_test.counter}")

# æµ‹è¯•æ¨¡å—é‡è½½
print("\næµ‹è¯•æ¨¡å—é‡è½½ï¼š")
importlib.reload(reload_test)
print(f"counterå€¼ï¼ˆé‡è½½åï¼‰: {reload_test.counter}")
print(f"è°ƒç”¨increment(): {reload_test.increment()}")
print(f"counterå€¼: {reload_test.counter}")

# æµ‹è¯•æ–°å¢çš„å‡½æ•°
print("\næµ‹è¯•æ–°å¢çš„å‡½æ•°ï¼š")
print(f"è°ƒç”¨reset(): {reload_test.reset()}")
print(f"counterå€¼: {reload_test.counter}")

# æµ‹è¯•æ¨¡å—ç¼“å­˜çš„åˆ é™¤
print("\næµ‹è¯•æ¨¡å—ç¼“å­˜çš„åˆ é™¤ï¼š")
if 'reload_test' in sys.modules:
    del sys.modules['reload_test']
    print("åˆ é™¤æ¨¡å—ç¼“å­˜")

# é‡æ–°å¯¼å…¥æ¨¡å—
import reload_test
print(f"counterå€¼ï¼ˆé‡æ–°å¯¼å…¥ï¼‰: {reload_test.counter}")

# æ¸…ç†
if 'reload_test' in sys.modules:
    del sys.modules['reload_test']

if os.path.exists("reload_test.py"):
    os.remove("reload_test.py")

if os.path.exists("reload_test.pyc"):
    os.remove("reload_test.pyc")</code></pre><h3>7. åŒ…çš„åˆå§‹åŒ–ä¸å‘½åç©ºé—´</h3><p>åŒ…çš„åˆå§‹åŒ–è¿‡ç¨‹å’Œå‘½åç©ºé—´ç®¡ç†æ˜¯PythonåŒ…ç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ç†è§£è¿™äº›æ¦‚å¿µå¯¹äºæ­£ç¡®ä½¿ç”¨å’Œåˆ›å»ºåŒ…éå¸¸é‡è¦ã€‚</p><h4>7.1 åŒ…çš„åˆå§‹åŒ–</h4><p>å½“åŒ…è¢«å¯¼å…¥æ—¶ï¼ŒPythonä¼šæ‰§è¡ŒåŒ…çš„<code>__init__.py</code>æ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚<code>__init__.py</code>æ–‡ä»¶çš„ä¸»è¦ä½œç”¨ï¼š</p><ul><li><strong>åŒ…çš„åˆå§‹åŒ–</strong>ï¼šæ‰§è¡ŒåŒ…çš„åˆå§‹åŒ–ä»£ç </li><li><strong>å¯¼å‡ºæ¨¡å—</strong>ï¼šä»åŒ…ä¸­å¯¼å‡ºæ¨¡å—æˆ–åç§°</li><li><strong>è®¾ç½®åŒ…çº§å˜é‡</strong>ï¼šå®šä¹‰åŒ…çº§åˆ«çš„å˜é‡å’Œå¸¸é‡</li><li><strong>æ§åˆ¶å¯¼å…¥è¡Œä¸º</strong>ï¼šæ§åˆ¶åŒ…çš„å¯¼å…¥è¡Œä¸º</li></ul><h4>7.2 åŒ…çš„å‘½åç©ºé—´</h4><p>åŒ…çš„å‘½åç©ºé—´æ˜¯é€šè¿‡åŒ…çš„å±‚æ¬¡ç»“æ„å’Œ<code>__init__.py</code>æ–‡ä»¶æ¥ç®¡ç†çš„ã€‚ç†è§£åŒ…çš„å‘½åç©ºé—´å¯¹äºé¿å…å‘½åå†²çªå’Œæ­£ç¡®ç»„ç»‡ä»£ç éå¸¸é‡è¦ã€‚</p><h4>7.3 <code>__all__</code>å˜é‡</h4><p>åœ¨æ¨¡å—æˆ–åŒ…çš„<code>__init__.py</code>æ–‡ä»¶ä¸­ï¼Œå¯ä»¥å®šä¹‰<code>__all__</code>å˜é‡æ¥æ§åˆ¶<code>from module import *</code>è¯­å¥å¯¼å…¥çš„åç§°ã€‚<code>__all__</code>æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒåŒ…å«äº†å¯ä»¥è¢«å¯¼å…¥çš„åç§°ã€‚</p><pre><code class="python"># åŒ…çš„åˆå§‹åŒ–ä¸å‘½åç©ºé—´ç¤ºä¾‹

# åŒ…ç»“æ„ï¼š
# mypackage/
#     __init__.py
#     module1.py
#     module2.py
#     module3.py

# æ–‡ä»¶å: mypackage/__init__.py
"""
mypackageåŒ…çš„åˆå§‹åŒ–æ–‡ä»¶
"""

# åŒ…çº§å˜é‡
__version__ = "1.0.0"
__author__ = "Python Developer"

# æ§åˆ¶from mypackage import *çš„è¡Œä¸º
__all__ = ['module1', 'module2']  # åªå¯¼å‡ºmodule1å’Œmodule2

# å¯¼å…¥æ¨¡å—
from . import module1
from . import module2
from . import module3

# å¯¼å‡ºç‰¹å®šåç§°
from .module1 import function1
from .module2 import function2

# åŒ…åˆå§‹åŒ–ä»£ç 
print(f"åˆå§‹åŒ–mypackageåŒ…ï¼Œç‰ˆæœ¬: {__version__}")

# æ–‡ä»¶å: mypackage/module1.py
"""
module1æ¨¡å—
"""

# æ§åˆ¶from mypackage.module1 import *çš„è¡Œä¸º
__all__ = ['function1', 'variable1']

# æ¨¡å—çº§å˜é‡
variable1 = "module1å˜é‡"
variable2 = "module1ç§æœ‰å˜é‡"

# æ¨¡å—çº§å‡½æ•°
def function1():
    return "module1çš„å‡½æ•°"

def function2():
    return "module1çš„å¦ä¸€ä¸ªå‡½æ•°"

# æ–‡ä»¶å: mypackage/module2.py
"""
module2æ¨¡å—
"""

def function2():
    return "module2çš„å‡½æ•°"

# æ–‡ä»¶å: mypackage/module3.py
"""
module3æ¨¡å—
"""

def function3():
    return "module3çš„å‡½æ•°"

# æµ‹è¯•åŒ…çš„åˆå§‹åŒ–ä¸å‘½åç©ºé—´
# æ–‡ä»¶å: test_package_init.py

# å¯¼å…¥åŒ…
import mypackage
print(f"å¯¼å…¥mypackageåŒ…")
print(f"åŒ…ç‰ˆæœ¬: {mypackage.__version__}")
print(f"åŒ…ä½œè€…: {mypackage.__author__}")

# ä½¿ç”¨åŒ…ä¸­çš„æ¨¡å—
print(f"\nä½¿ç”¨åŒ…ä¸­çš„æ¨¡å—ï¼š")
print(f"module1.function1(): {mypackage.module1.function1()}")
print(f"module2.function2(): {mypackage.module2.function2()}")
print(f"module3.function3(): {mypackage.module3.function3()}")

# ä½¿ç”¨å¯¼å‡ºçš„åç§°
print(f"\nä½¿ç”¨å¯¼å‡ºçš„åç§°ï¼š")
print(f"function1(): {mypackage.function1()}")
print(f"function2(): {mypackage.function2()}")

# æµ‹è¯•from import *
print(f"\næµ‹è¯•from import *ï¼š")
from mypackage import *
print(f"å¯å¯¼å…¥çš„æ¨¡å—: {[name for name in dir() if not name.startswith('_')]}")
print(f"module1æ˜¯å¦å¯å¯¼å…¥: {'module1' in dir()}")
print(f"module2æ˜¯å¦å¯å¯¼å…¥: {'module2' in dir()}")
print(f"module3æ˜¯å¦å¯å¯¼å…¥: {'module3' in dir()}")

# æµ‹è¯•æ¨¡å—çš„from import *
print(f"\næµ‹è¯•æ¨¡å—çš„from import *ï¼š")
from mypackage.module1 import *
print(f"å¯å¯¼å…¥çš„åç§°: {[name for name in dir() if not name.startswith('_')]}")
print(f"variable1æ˜¯å¦å¯å¯¼å…¥: {'variable1' in dir()}")
print(f"variable2æ˜¯å¦å¯å¯¼å…¥: {'variable2' in dir()}")
print(f"function1æ˜¯å¦å¯å¯¼å…¥: {'function1' in dir()}")
print(f"function2æ˜¯å¦å¯å¯¼å…¥: {'function2' in dir()}")</code></pre><h3>7. æ¨¡å—å¯¼å…¥çš„é«˜çº§æŠ€å·§</h3><h4>7.1 åŠ¨æ€å¯¼å…¥</h4><p>Pythonæä¾›äº†å¤šç§åŠ¨æ€å¯¼å…¥æ¨¡å—çš„æ–¹æ³•ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶æ ¹æ®æ¡ä»¶å¯¼å…¥ä¸åŒçš„æ¨¡å—ã€‚</p><h5>7.1.1 ä½¿ç”¨<code>importlib.import_module()</code></h5><p><code>importlib.import_module()</code>å‡½æ•°æ˜¯åŠ¨æ€å¯¼å…¥æ¨¡å—çš„æ¨èæ–¹æ³•ï¼Œå®ƒè¿”å›å¯¼å…¥çš„æ¨¡å—å¯¹è±¡ã€‚</p><h5>7.1.2 ä½¿ç”¨<code>__import__()</code></h5><p><code>__import__()</code>æ˜¯Pythonçš„å†…ç½®å‡½æ•°ï¼Œç”¨äºå¯¼å…¥æ¨¡å—ã€‚å®ƒæ˜¯<code>import</code>è¯­å¥çš„åº•å±‚å®ç°ï¼Œä½†ä¸æ¨èç›´æ¥ä½¿ç”¨ã€‚</p><h5>7.1.3 ä½¿ç”¨<code>exec()</code></h5><p><code>exec()</code>å‡½æ•°å¯ä»¥æ‰§è¡ŒåŠ¨æ€ç”Ÿæˆçš„å¯¼å…¥è¯­å¥ï¼Œä½†åº”è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚</p><h4>7.2 æ¡ä»¶å¯¼å…¥</h4><p>æ¡ä»¶å¯¼å…¥æ˜¯æŒ‡æ ¹æ®æ¡ä»¶å¯¼å…¥ä¸åŒçš„æ¨¡å—ï¼Œé€šå¸¸ç”¨äºå¤„ç†ä¸åŒå¹³å°æˆ–ä¸åŒç¯å¢ƒçš„å…¼å®¹æ€§é—®é¢˜ã€‚</p><h4>7.3 å»¶è¿Ÿå¯¼å…¥</h4><p>å»¶è¿Ÿå¯¼å…¥æ˜¯æŒ‡åœ¨éœ€è¦æ—¶æ‰å¯¼å…¥æ¨¡å—ï¼Œè€Œä¸æ˜¯åœ¨æ¨¡å—åˆå§‹åŒ–æ—¶å°±å¯¼å…¥æ‰€æœ‰æ¨¡å—ã€‚è¿™å¯ä»¥å‡å°‘æ¨¡å—çš„åˆå§‹åŒ–æ—¶é—´å’Œå†…å­˜ä½¿ç”¨ã€‚</p><pre><code class="python"># æ¨¡å—å¯¼å…¥çš„é«˜çº§æŠ€å·§ç¤ºä¾‹
import importlib
import sys
import os

# åŠ¨æ€å¯¼å…¥ç¤ºä¾‹
print("åŠ¨æ€å¯¼å…¥ç¤ºä¾‹ï¼š")

# ä½¿ç”¨importlib.import_module()
module_name = "math"
math_module = importlib.import_module(module_name)
print(f"åŠ¨æ€å¯¼å…¥{module_name}æ¨¡å—ï¼š{math_module}")
print(f"math.pi: {math_module.pi}")

# åŠ¨æ€å¯¼å…¥å¸¦åŒ…çš„æ¨¡å—
package_module_name = "os.path"
os_path_module = importlib.import_module(package_module_name)
print(f"\nåŠ¨æ€å¯¼å…¥{package_module_name}æ¨¡å—ï¼š{os_path_module}")
print(f"os.path.abspath('.'): {os_path_module.abspath('.')}")

# æ¡ä»¶å¯¼å…¥ç¤ºä¾‹
print("\næ¡ä»¶å¯¼å…¥ç¤ºä¾‹ï¼š")

# æ ¹æ®å¹³å°å¯¼å…¥ä¸åŒçš„æ¨¡å—
if sys.platform == "win32":
    print("Windowså¹³å°ï¼Œå¯¼å…¥msvcrtæ¨¡å—")
    import msvcrt
elif sys.platform == "linux":
    print("Linuxå¹³å°ï¼Œå¯¼å…¥termiosæ¨¡å—")
    import termios
elif sys.platform == "darwin":
    print("macOSå¹³å°ï¼Œå¯¼å…¥termiosæ¨¡å—")
    import termios
else:
    print("å…¶ä»–å¹³å°")

# å»¶è¿Ÿå¯¼å…¥ç¤ºä¾‹
print("\nå»¶è¿Ÿå¯¼å…¥ç¤ºä¾‹ï¼š")

# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°å†…éƒ¨å¯¼å…¥æ¨¡å—
def calculate_sin(x):
    """è®¡ç®—æ­£å¼¦å€¼"""
    import math  # å»¶è¿Ÿå¯¼å…¥
    return math.sin(x)

# æµ‹è¯•å»¶è¿Ÿå¯¼å…¥
print("è°ƒç”¨calculate_sinå‡½æ•°å‰ï¼Œmathæ¨¡å—æ˜¯å¦å·²å¯¼å…¥ï¼š", "math" in sys.modules)
result = calculate_sin(0.5)
print(f"sin(0.5) = {result}")
print("è°ƒç”¨calculate_sinå‡½æ•°åï¼Œmathæ¨¡å—æ˜¯å¦å·²å¯¼å…¥ï¼š", "math" in sys.modules)

# åŠ¨æ€å¯¼å…¥æ¨¡å—å¹¶è°ƒç”¨å‡½æ•°
def dynamic_call(module_name, function_name, *args, **kwargs):
    """åŠ¨æ€å¯¼å…¥æ¨¡å—å¹¶è°ƒç”¨å‡½æ•°"""
    # å¯¼å…¥æ¨¡å—
    module = importlib.import_module(module_name)
    # è·å–å‡½æ•°
    function = getattr(module, function_name)
    # è°ƒç”¨å‡½æ•°
    return function(*args, **kwargs)

# æµ‹è¯•åŠ¨æ€è°ƒç”¨
print("\nåŠ¨æ€è°ƒç”¨ç¤ºä¾‹ï¼š")
result = dynamic_call("math", "sqrt", 16)
print(f"math.sqrt(16) = {result}")

result = dynamic_call("os", "getcwd")
print(f"os.getcwd() = {result}")

# æµ‹è¯•å¯¼å…¥ä¸å­˜åœ¨çš„æ¨¡å—
try:
    module = importlib.import_module("non_existent_module")
except ImportError as e:
    print(f"\nå¯¼å…¥ä¸å­˜åœ¨çš„æ¨¡å—å¤±è´¥ï¼š{e}")</code></pre><h3>8. åŒ…ç®¡ç†çš„æœ€ä½³å®è·µ</h3><h4>8.1 é¡¹ç›®ç»“æ„</h4><p>ä¸€ä¸ªè‰¯å¥½çš„Pythoné¡¹ç›®ç»“æ„åº”è¯¥åŒ…æ‹¬ï¼š</p><ul><li><strong>é¡¹ç›®æ ¹ç›®å½•</strong>ï¼šåŒ…å«é¡¹ç›®çš„ä¸»è¦æ–‡ä»¶</li><li><strong>åŒ…ç›®å½•</strong>ï¼šåŒ…å«é¡¹ç›®çš„ä»£ç åŒ…</li><li><strong>æµ‹è¯•ç›®å½•</strong>ï¼šåŒ…å«é¡¹ç›®çš„æµ‹è¯•ä»£ç </li><li><strong>æ–‡æ¡£ç›®å½•</strong>ï¼šåŒ…å«é¡¹ç›®çš„æ–‡æ¡£</li><li><strong>é…ç½®æ–‡ä»¶</strong>ï¼šåŒ…å«é¡¹ç›®çš„é…ç½®ä¿¡æ¯</li></ul><h4>8.2 ä¾èµ–ç®¡ç†</h4><p>ä¾èµ–ç®¡ç†æ˜¯Pythoné¡¹ç›®çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œåº”éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š</p><ul><li><strong>ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ</strong>ï¼šä¸ºæ¯ä¸ªé¡¹ç›®åˆ›å»ºç‹¬ç«‹çš„è™šæ‹Ÿç¯å¢ƒ</li><li><strong>é”å®šä¾èµ–ç‰ˆæœ¬</strong>ï¼šä½¿ç”¨<code>requirements.txt</code>æˆ–<code>Pipfile.lock</code>é”å®šä¾èµ–ç‰ˆæœ¬</li><li><strong>åˆ†ç¦»å¼€å‘ä¾èµ–å’Œç”Ÿäº§ä¾èµ–</strong>ï¼šå°†å¼€å‘ä¾èµ–å’Œç”Ÿäº§ä¾èµ–åˆ†å¼€ç®¡ç†</li><li><strong>å®šæœŸæ›´æ–°ä¾èµ–</strong>ï¼šå®šæœŸæ›´æ–°ä¾èµ–ä»¥è·å–å®‰å…¨è¡¥ä¸å’Œæ–°åŠŸèƒ½</li></ul><h4>8.3 åŒ…çš„å‘å¸ƒ</h4><p>å¦‚æœè¦å‘å¸ƒè‡ªå·±çš„PythonåŒ…ï¼Œåº”éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š</p><ul><li><strong>ä½¿ç”¨æ ‡å‡†ç»“æ„</strong>ï¼šéµå¾ªPythonåŒ…çš„æ ‡å‡†ç»“æ„</li><li><strong>ç¼–å†™setup.py</strong>ï¼šåˆ›å»º<code>setup.py</code>æ–‡ä»¶æ¥å®šä¹‰åŒ…çš„å…ƒæ•°æ®</li><li><strong>ç¼–å†™README.md</strong>ï¼šåˆ›å»ºREADME.mdæ–‡ä»¶æ¥æè¿°åŒ…çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•</li><li><strong>ç¼–å†™æ–‡æ¡£</strong>ï¼šä¸ºåŒ…ç¼–å†™è¯¦ç»†çš„æ–‡æ¡£</li><li><strong>è¿è¡Œæµ‹è¯•</strong>ï¼šç¡®ä¿åŒ…é€šè¿‡æ‰€æœ‰æµ‹è¯•</li><li><strong>ä¸Šä¼ åˆ°PyPI</strong>ï¼šå°†åŒ…ä¸Šä¼ åˆ°PyPIä¾›å…¶ä»–äººä½¿ç”¨</li></ul><pre><code class="python"># åŒ…ç®¡ç†çš„æœ€ä½³å®è·µç¤ºä¾‹

# é¡¹ç›®ç»“æ„ç¤ºä¾‹
'''
myproject/
â”œâ”€â”€ README.md          # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ setup.py           # åŒ…å®‰è£…è„šæœ¬
â”œâ”€â”€ requirements.txt   # ä¾èµ–å£°æ˜
â”œâ”€â”€ requirements-dev.txt # å¼€å‘ä¾èµ–å£°æ˜
â”œâ”€â”€ mypackage/         # ä¸»è¦åŒ…ç›®å½•
â”‚   â”œâ”€â”€ __init__.py    # åŒ…åˆå§‹åŒ–æ–‡ä»¶
â”‚   â”œâ”€â”€ module1.py     # æ¨¡å—1
â”‚   â”œâ”€â”€ module2.py     # æ¨¡å—2
â”‚   â””â”€â”€ subpackage/    # å­åŒ…
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ submodule.py
â””â”€â”€ tests/             # æµ‹è¯•ç›®å½•
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ test_module1.py
    â””â”€â”€ test_module2.py
'''

# setup.pyç¤ºä¾‹
'''
from setuptools import setup, find_packages

setup(
    name="mypackage",
    version="1.0.0",
    description="A sample Python package",
    author="Python Developer",
    author_email="developer@example.com",
    url="https://github.com/username/mypackage",
    packages=find_packages(),
    install_requires=[
        "requests&gt;=2.25.0",
        "numpy&gt;=1.20.0"
    ],
    extras_require={
        "dev": [
            "pytest&gt;=6.0.0",
            "black&gt;=21.0.0"
        ]
    },
    classifiers=[
        "Programming Language :: Python :: 3",
        "License :: OSI Approved :: MIT License",
        "Operating System :: OS Independent",
    ],
    python_requires="&gt;=3.6",
)
'''

# requirements.txtç¤ºä¾‹
'''
requests&gt;=2.25.0
numpy&gt;=1.20.0
'''

# requirements-dev.txtç¤ºä¾‹
'''
-r requirements.txt
pytest&gt;=6.0.0
black&gt;=21.0.0
'''

# .gitignoreç¤ºä¾‹
'''
# Python
__pycache__/
*.py[cod]
*$py.class

# Virtual Environment
venv/
env/

# IDE
.vscode/
.idea/

# Build artifacts
build/
dist/
*.egg-info/

# Testing
.pytest_cache/

# Logs
logs/
*.log
'''

# åŒ…å‘å¸ƒæ­¥éª¤
'''
1. å®‰è£…æ„å»ºå·¥å…·
   pip install setuptools wheel twine

2. æ„å»ºåŒ…
   python setup.py sdist bdist_wheel

3. ä¸Šä¼ åŒ…åˆ°PyPIæµ‹è¯•ç¯å¢ƒ
   twine upload --repository testpypi dist/*

4. ä¸Šä¼ åŒ…åˆ°PyPIç”Ÿäº§ç¯å¢ƒ
   twine upload dist/*
'''

# æµ‹è¯•åŒ…å®‰è£…
'''
# ä»PyPIå®‰è£…
pip install mypackage

# ä»æœ¬åœ°å®‰è£…
pip install -e .

# å®‰è£…å¼€å‘ä¾èµ–
pip install -e .[dev]
'''</code></pre><h3>9. å¸¸è§å¯¼å…¥é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3><p>åœ¨Pythonå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å„ç§å¯¼å…¥é—®é¢˜ã€‚ç†è§£è¿™äº›é—®é¢˜çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆå¯¹äºæé«˜å¼€å‘æ•ˆç‡è‡³å…³é‡è¦ã€‚</p><h4>9.1 å¯¼å…¥é”™è¯¯çš„å¸¸è§åŸå› </h4><ul><li><strong>æ¨¡å—ä¸å­˜åœ¨</strong>ï¼šå°è¯•å¯¼å…¥ä¸å­˜åœ¨çš„æ¨¡å—</li><li><strong>å¯¼å…¥è·¯å¾„é—®é¢˜</strong>ï¼šæ¨¡å—ä¸åœ¨Pythonçš„å¯¼å…¥è·¯å¾„ä¸­</li><li><strong>å¾ªç¯å¯¼å…¥</strong>ï¼šä¸¤ä¸ªæˆ–å¤šä¸ªæ¨¡å—ç›¸äº’å¯¼å…¥</li><li><strong>å‘½åå†²çª</strong>ï¼šæ¨¡å—åç§°ä¸æ ‡å‡†åº“æˆ–ç¬¬ä¸‰æ–¹åº“æ¨¡å—åç§°å†²çª</li><li><strong>æƒé™é—®é¢˜</strong>ï¼šæ²¡æœ‰è¯»å–æ¨¡å—æ–‡ä»¶çš„æƒé™</li><li><strong>è¯­æ³•é”™è¯¯</strong>ï¼šæ¨¡å—æ–‡ä»¶ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯</li></ul><h4>9.2 å¾ªç¯å¯¼å…¥</h4><p>å¾ªç¯å¯¼å…¥æ˜¯æŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªæ¨¡å—ç›¸äº’å¯¼å…¥ï¼Œå¯èƒ½å¯¼è‡´å¯¼å…¥å¤±è´¥æˆ–è¿è¡Œæ—¶é”™è¯¯ã€‚</p><h5>9.2.1 å¾ªç¯å¯¼å…¥çš„ç¤ºä¾‹</h5><pre><code class="python"># æ¨¡å—A
import module_b
def function_a():
    return module_b.function_b()

# æ¨¡å—B
import module_a
def function_b():
    return module_a.function_a()</code></pre><h5>9.2.2 å¾ªç¯å¯¼å…¥çš„è§£å†³æ–¹æ¡ˆ</h5><ul><li><strong>é‡æ„ä»£ç </strong>ï¼šå°†å…±äº«çš„ä»£ç æå–åˆ°ä¸€ä¸ªæ–°çš„æ¨¡å—ä¸­</li><li><strong>å»¶è¿Ÿå¯¼å…¥</strong>ï¼šåœ¨å‡½æ•°å†…éƒ¨å¯¼å…¥æ¨¡å—ï¼Œè€Œä¸æ˜¯åœ¨æ¨¡å—é¡¶éƒ¨å¯¼å…¥</li><li><strong>å¯¼å…¥é‡å‘½å</strong>ï¼šä½¿ç”¨åˆ«åå¯¼å…¥æ¨¡å—ï¼Œé¿å…å‘½åå†²çª</li><li><strong>é‡æ–°ç»„ç»‡æ¨¡å—ç»“æ„</strong>ï¼šé‡æ–°ç»„ç»‡æ¨¡å—çš„ä¾èµ–å…³ç³»</li></ul><h4>9.3 å¯¼å…¥è·¯å¾„é—®é¢˜</h4><p>å¯¼å…¥è·¯å¾„é—®é¢˜æ˜¯æŒ‡æ¨¡å—ä¸åœ¨Pythonçš„å¯¼å…¥è·¯å¾„ä¸­ï¼Œå¯¼è‡´æ— æ³•å¯¼å…¥æ¨¡å—ã€‚</p><h5>9.3.1 å¯¼å…¥è·¯å¾„é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</h5><ul><li><strong>æ·»åŠ å¯¼å…¥è·¯å¾„</strong>ï¼šå°†æ¨¡å—æ‰€åœ¨çš„ç›®å½•æ·»åŠ åˆ°<code>sys.path</code>ä¸­</li><li><strong>ä½¿ç”¨ç›¸å¯¹å¯¼å…¥</strong>ï¼šåœ¨åŒ…å†…éƒ¨ä½¿ç”¨ç›¸å¯¹å¯¼å…¥</li><li><strong>è®¾ç½®PYTHONPATH</strong>ï¼šè®¾ç½®<code>PYTHONPATH</code>ç¯å¢ƒå˜é‡</li><li><strong>ä½¿ç”¨.pthæ–‡ä»¶</strong>ï¼šåˆ›å»º<code>.pth</code>æ–‡ä»¶æ¥æ·»åŠ å¯¼å…¥è·¯å¾„</li><li><strong>å®‰è£…æ¨¡å—</strong>ï¼šå°†æ¨¡å—å®‰è£…åˆ°Pythonçš„ç«™ç‚¹åŒ…ç›®å½•ä¸­</li></ul><h4>9.4 å‘½åå†²çª</h4><p>å‘½åå†²çªæ˜¯æŒ‡æ¨¡å—åç§°ä¸æ ‡å‡†åº“æˆ–ç¬¬ä¸‰æ–¹åº“æ¨¡å—åç§°å†²çªï¼Œå¯¼è‡´å¯¼å…¥é”™è¯¯ã€‚</p><h5>9.4.1 å‘½åå†²çªçš„è§£å†³æ–¹æ¡ˆ</h5><ul><li><strong>é‡å‘½åæ¨¡å—</strong>ï¼šé‡å‘½åä¸æ ‡å‡†åº“æˆ–ç¬¬ä¸‰æ–¹åº“å†²çªçš„æ¨¡å—</li><li><strong>ä½¿ç”¨ç»å¯¹å¯¼å…¥</strong>ï¼šä½¿ç”¨ç»å¯¹å¯¼å…¥æ¥é¿å…å‘½åå†²çª</li><li><strong>ä½¿ç”¨åˆ«å</strong>ï¼šä½¿ç”¨åˆ«åå¯¼å…¥æ¨¡å—ï¼Œé¿å…å‘½åå†²çª</li></ul><pre><code class="python"># å¸¸è§å¯¼å…¥é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆç¤ºä¾‹

# 1. å¾ªç¯å¯¼å…¥ç¤ºä¾‹
# æ–‡ä»¶å: module_a.py
'''
import module_b

def function_a():
    print("function_a called")
    return module_b.function_b()
'''

# æ–‡ä»¶å: module_b.py
'''
import module_a

def function_b():
    print("function_b called")
    return module_a.function_a()
'''

# æµ‹è¯•å¾ªç¯å¯¼å…¥
# æ–‡ä»¶å: test_circular_import.py
'''
try:
    import module_a
    print("å¯¼å…¥module_aæˆåŠŸ")
    result = module_a.function_a()
    print(f"ç»“æœ: {result}")
except Exception as e:
    print(f"å¯¼å…¥é”™è¯¯: {e}")
'''

# å¾ªç¯å¯¼å…¥çš„è§£å†³æ–¹æ¡ˆ
# æ–‡ä»¶å: module_a_fixed.py
'''
# å»¶è¿Ÿå¯¼å…¥
def function_a():
    import module_b_fixed
    print("function_a called")
    return module_b_fixed.function_b()
'''

# æ–‡ä»¶å: module_b_fixed.py
'''
# å»¶è¿Ÿå¯¼å…¥
def function_b():
    import module_a_fixed
    print("function_b called")
    return module_a_fixed.function_a()
'''

# 2. å¯¼å…¥è·¯å¾„é—®é¢˜ç¤ºä¾‹
# å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹ç›®å½•ç»“æ„ï¼š
# project/
#     src/
#         mypackage/
#             __init__.py
#             module.py
#     scripts/
#         script.py

# æ–‡ä»¶å: project/scripts/script.py
'''
# å°è¯•å¯¼å…¥mypackage
import sys
import os

# æ·»åŠ srcç›®å½•åˆ°å¯¼å…¥è·¯å¾„
sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), "..", "src")))

# ç°åœ¨å¯ä»¥å¯¼å…¥mypackage
import mypackage
print("å¯¼å…¥mypackageæˆåŠŸ")
'''

# 3. å‘½åå†²çªç¤ºä¾‹
# å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸ºmath.pyçš„æ–‡ä»¶ï¼Œä¸æ ‡å‡†åº“mathæ¨¡å—å†²çª

# æ–‡ä»¶å: math.py
'''
def add(a, b):
    return a + b
'''

# æµ‹è¯•å‘½åå†²çª
# æ–‡ä»¶å: test_name_conflict.py
'''
# è¿™ä¼šå¯¼å…¥å½“å‰ç›®å½•çš„math.pyï¼Œè€Œä¸æ˜¯æ ‡å‡†åº“çš„mathæ¨¡å—
import math
print(f"mathæ¨¡å—è·¯å¾„: {math.__file__}")

# è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ç»å¯¹å¯¼å…¥æˆ–é‡å‘½åæ¨¡å—
# 1. é‡å‘½åæ¨¡å—ä¸ºmy_math.py
# 2. ä½¿ç”¨ç»å¯¹å¯¼å…¥ï¼ˆåœ¨Python 3ä¸­é»˜è®¤ï¼‰
'''

# 4. å¯¼å…¥é”™è¯¯çš„è°ƒè¯•
print("å¯¼å…¥é”™è¯¯çš„è°ƒè¯•ç¤ºä¾‹ï¼š")

# æŸ¥çœ‹å¯¼å…¥è·¯å¾„
import sys
print("Pythonå¯¼å…¥è·¯å¾„ï¼š")
for path in sys.path:
    print(f"  {path}")

# æŸ¥çœ‹æ¨¡å—æ˜¯å¦å­˜åœ¨
module_name = "math"
print(f"\næ£€æŸ¥{module_name}æ¨¡å—ï¼š")
if module_name in sys.modules:
    print(f"æ¨¡å—å·²å¯¼å…¥: {sys.modules[module_name]}")
else:
    print("æ¨¡å—æœªå¯¼å…¥")

# å°è¯•å¯¼å…¥æ¨¡å—
try:
    import non_existent_module
    print("å¯¼å…¥æˆåŠŸ")
except ImportError as e:
    print(f"å¯¼å…¥é”™è¯¯: {e}")

# æ£€æŸ¥æ–‡ä»¶æƒé™
print("\næ£€æŸ¥æ–‡ä»¶æƒé™ï¼š")
if os.path.exists("test_module.py"):
    print(f"æ–‡ä»¶å­˜åœ¨: {os.path.exists('test_module.py')}")
    print(f"æ–‡ä»¶å¯è¯»: {os.access('test_module.py', os.R_OK)}")
else:
    print("æ–‡ä»¶ä¸å­˜åœ¨")</code></pre><h3>10. æ€»ç»“</h3><p>æœ¬æ–‡è¯¦ç»†åˆ†æäº†Pythonä¸­çš„æ¨¡å—å¯¼å…¥æœºåˆ¶ä¸åŒ…ç®¡ç†ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><strong>æ¨¡å—ä¸åŒ…çš„åŸºæœ¬æ¦‚å¿µ</strong>ï¼šæ¨¡å—å’ŒåŒ…çš„å®šä¹‰ã€ä½œç”¨å’Œå…³ç³»</li><li><strong>Pythonçš„å¯¼å…¥æœºåˆ¶</strong>ï¼šå¯¼å…¥è¯­å¥çš„ç±»å‹ã€å¯¼å…¥æœºåˆ¶çš„å·¥ä½œåŸç†ã€å¯¼å…¥è·¯å¾„å’Œæ¨¡å—çš„åŠ è½½ä¸åˆå§‹åŒ–</li><li><strong>åŒ…ç®¡ç†ç³»ç»Ÿ</strong>ï¼šåŒ…ç®¡ç†å·¥å…·ã€pipçš„ä½¿ç”¨å’Œè™šæ‹Ÿç¯å¢ƒ</li><li><strong>å¯¼å…¥è·¯å¾„ä¸æ¨¡å—æŸ¥æ‰¾</strong>ï¼šå¯¼å…¥è·¯å¾„çš„ç»„æˆã€æ¨¡å—æŸ¥æ‰¾çš„é¡ºåºå’Œæ¨¡å—æ–‡ä»¶çš„ç±»å‹</li><li><strong>ç›¸å¯¹å¯¼å…¥ä¸ç»å¯¹å¯¼å…¥</strong>ï¼šç›¸å¯¹å¯¼å…¥å’Œç»å¯¹å¯¼å…¥çš„æ¦‚å¿µã€ä½¿ç”¨æ–¹æ³•å’Œé€‰æ‹©</li><li><strong>æ¨¡å—ç¼“å­˜ä¸é‡è½½</strong>ï¼šæ¨¡å—ç¼“å­˜çš„ä½œç”¨ã€æ¨¡å—é‡è½½çš„æ–¹æ³•å’Œæ³¨æ„äº‹é¡¹</li><li><strong>åŒ…çš„åˆå§‹åŒ–ä¸å‘½åç©ºé—´</strong>ï¼šåŒ…çš„åˆå§‹åŒ–è¿‡ç¨‹ã€å‘½åç©ºé—´ç®¡ç†å’Œ<code>__all__</code>å˜é‡</li><li><strong>æ¨¡å—å¯¼å…¥çš„é«˜çº§æŠ€å·§</strong>ï¼šåŠ¨æ€å¯¼å…¥ã€æ¡ä»¶å¯¼å…¥å’Œå»¶è¿Ÿå¯¼å…¥</li><li><strong>åŒ…ç®¡ç†çš„æœ€ä½³å®è·µ</strong>ï¼šé¡¹ç›®ç»“æ„ã€ä¾èµ–ç®¡ç†å’ŒåŒ…çš„å‘å¸ƒ</li><li><strong>å¸¸è§å¯¼å…¥é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</strong>ï¼šå¯¼å…¥é”™è¯¯çš„å¸¸è§åŸå› ã€å¾ªç¯å¯¼å…¥ã€å¯¼å…¥è·¯å¾„é—®é¢˜å’Œå‘½åå†²çª</li></ul><p>Pythonçš„æ¨¡å—å¯¼å…¥æœºåˆ¶å’ŒåŒ…ç®¡ç†ç³»ç»Ÿæ˜¯Pythonè¯­è¨€çš„é‡è¦ç‰¹æ€§ï¼Œå®ƒä»¬ä¸ºä»£ç ç»„ç»‡ã€é‡ç”¨å’Œåˆ†å‘æä¾›äº†å¼ºå¤§çš„æ”¯æŒã€‚é€šè¿‡ç†è§£å’ŒæŒæ¡è¿™äº›æ¦‚å¿µå’ŒæŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™æ›´åŠ æ¨¡å—åŒ–ã€å¯ç»´æŠ¤å’Œå¯æ‰©å±•çš„Pythonä»£ç ã€‚</p><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥æ ¹æ®é¡¹ç›®çš„å…·ä½“æƒ…å†µé€‰æ‹©åˆé€‚çš„å¯¼å…¥æ–¹å¼å’ŒåŒ…ç®¡ç†ç­–ç•¥ï¼Œéµå¾ªPythonçš„æœ€ä½³å®è·µï¼Œä»¥æé«˜ä»£ç çš„è´¨é‡å’Œå¼€å‘æ•ˆç‡ã€‚</p><h3>11. å‚è€ƒæ–‡çŒ®</h3><ol><li>Python Documentation: Modules</li><li>Python Documentation: Packages</li><li>Python Documentation: The Import System</li><li>Python Documentation: pip User Guide</li><li>PEP 328 -- Imports: Multi-Line and Absolute/Relative</li><li>PEP 404 -- Python 2.7 Release Schedule</li><li>PEP 517 -- A build-system independent format for source trees</li><li>PEP 518 -- Specifying Minimum Build System Requirements for Python Projects</li><li>Python Packaging User Guide</li><li>Real Python: Absolute vs Relative Imports in Python</li></ol><h3>12. ç»“è¯­</h3><p>Pythonçš„æ¨¡å—å¯¼å…¥æœºåˆ¶ä¸åŒ…ç®¡ç†æ˜¯Pythonç¼–ç¨‹çš„åŸºç¡€ï¼Œä¹Ÿæ˜¯Pythonç”Ÿæ€ç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿï¼š</p><ol><li>ç†è§£Pythonæ¨¡å—å’ŒåŒ…çš„åŸºæœ¬æ¦‚å¿µ</li><li>æŒæ¡Pythonçš„å¯¼å…¥æœºåˆ¶å’Œå·¥ä½œåŸç†</li><li>ç†Ÿç»ƒä½¿ç”¨pipå’Œè™šæ‹Ÿç¯å¢ƒç®¡ç†ä¾èµ–</li><li>æ­£ç¡®ä½¿ç”¨ç›¸å¯¹å¯¼å…¥å’Œç»å¯¹å¯¼å…¥</li><li>è§£å†³å¸¸è§çš„å¯¼å…¥é—®é¢˜</li><li>éµå¾ªPythonåŒ…ç®¡ç†çš„æœ€ä½³å®è·µ</li></ol><p>Pythonçš„æ¨¡å—å¯¼å…¥æœºåˆ¶å’ŒåŒ…ç®¡ç†ç³»ç»Ÿè®¾è®¡ç®€æ´è€Œå¼ºå¤§ï¼Œå®ƒä¸ä»…æ–¹ä¾¿äº†ä»£ç çš„ç»„ç»‡å’Œé‡ç”¨ï¼Œä¹Ÿä¿ƒè¿›äº†Pythonç”Ÿæ€ç³»ç»Ÿçš„å‘å±•ã€‚é€šè¿‡åˆç†ä½¿ç”¨è¿™äº›æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºæ›´åŠ æ¨¡å—åŒ–ã€å¯ç»´æŠ¤å’Œå¯æ‰©å±•çš„Pythonåº”ç”¨ç¨‹åºã€‚</p><p>åœ¨æœªæ¥çš„Pythonå¼€å‘ä¸­ï¼Œéšç€Pythonè¯­è¨€çš„ä¸æ–­å‘å±•å’Œç”Ÿæ€ç³»ç»Ÿçš„ä¸æ–­å®Œå–„ï¼Œæ¨¡å—å¯¼å…¥æœºåˆ¶å’ŒåŒ…ç®¡ç†ç³»ç»Ÿä¹Ÿä¼šä¸æ–­æ”¹è¿›å’Œä¼˜åŒ–ã€‚æˆ‘ä»¬åº”è¯¥ä¿æŒå­¦ä¹ çš„æ€åº¦ï¼Œå…³æ³¨Pythonçš„æœ€æ–°å‘å±•ï¼Œä»¥å……åˆ†åˆ©ç”¨Pythonçš„å¼ºå¤§åŠŸèƒ½ã€‚</p>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸æœ€ä½³å®è·µ é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585258</link>    <guid>https://segmentfault.com/a/1190000047585258</guid>    <pubDate>2026-02-01 02:06:43</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸æœ€ä½³å®è·µ</h2><h3>1. å¼‚å¸¸çš„åŸºæœ¬æ¦‚å¿µ</h3><p>åœ¨Pythonç¼–ç¨‹ä¸­ï¼Œå¼‚å¸¸æ˜¯æŒ‡ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°çš„é”™è¯¯æˆ–å¼‚å¸¸æƒ…å†µã€‚ç†è§£å¼‚å¸¸çš„åŸºæœ¬æ¦‚å¿µæ˜¯æŒæ¡Pythonå¼‚å¸¸å¤„ç†æœºåˆ¶çš„åŸºç¡€ã€‚</p><h4>1.1 å¼‚å¸¸çš„å®šä¹‰</h4><p>å¼‚å¸¸æ˜¯æŒ‡ç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°çš„éé¢„æœŸæƒ…å†µï¼Œè¿™äº›æƒ…å†µå¯èƒ½å¯¼è‡´ç¨‹åºæ— æ³•æ­£å¸¸ç»§ç»­æ‰§è¡Œã€‚ä¾‹å¦‚ï¼š</p><ul><li>é™¤ä»¥é›¶</li><li>è®¿é—®ä¸å­˜åœ¨çš„æ–‡ä»¶</li><li>ç±»å‹é”™è¯¯</li><li>ç´¢å¼•è¶Šç•Œ</li></ul><h4>1.2 å¼‚å¸¸ä¸é”™è¯¯çš„åŒºåˆ«</h4><p>åœ¨Pythonä¸­ï¼Œå¼‚å¸¸å’Œé”™è¯¯æœ‰ä»¥ä¸‹åŒºåˆ«ï¼š</p><ul><li><p><strong>é”™è¯¯</strong>ï¼šé€šå¸¸æŒ‡è¯­æ³•é”™è¯¯æˆ–é€»è¾‘é”™è¯¯ï¼Œè¿™äº›é”™è¯¯ä¼šå¯¼è‡´ç¨‹åºæ— æ³•æ­£å¸¸è¿è¡Œ</p><ul><li>è¯­æ³•é”™è¯¯ï¼šä»£ç ä¸ç¬¦åˆPythonè¯­æ³•è§„åˆ™</li><li>é€»è¾‘é”™è¯¯ï¼šä»£ç é€»è¾‘ä¸æ­£ç¡®ï¼Œå¯¼è‡´ç¨‹åºè¡Œä¸ºä¸ç¬¦åˆé¢„æœŸ</li></ul></li><li><p><strong>å¼‚å¸¸</strong>ï¼šç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­é‡åˆ°çš„éé¢„æœŸæƒ…å†µï¼Œè¿™äº›æƒ…å†µå¯ä»¥è¢«æ•è·å’Œå¤„ç†</p><ul><li>è¿è¡Œæ—¶å¼‚å¸¸ï¼šç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„å¼‚å¸¸</li><li>æ£€æŸ¥å¼‚å¸¸ï¼šéœ€è¦æ˜¾å¼å¤„ç†çš„å¼‚å¸¸ï¼ˆåœ¨Pythonä¸­ï¼Œæ‰€æœ‰å¼‚å¸¸éƒ½æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼‰</li></ul></li></ul><h4>1.3 å¼‚å¸¸çš„å±‚æ¬¡ç»“æ„</h4><p>Pythonä¸­çš„å¼‚å¸¸æ˜¯é€šè¿‡ç±»å±‚æ¬¡ç»“æ„æ¥ç»„ç»‡çš„ï¼Œæ‰€æœ‰å¼‚å¸¸ç±»éƒ½ç»§æ‰¿è‡ª<code>BaseException</code>ç±»ã€‚å¸¸è§çš„å¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code>BaseException
â”œâ”€â”€ SystemExit
â”œâ”€â”€ KeyboardInterrupt
â”œâ”€â”€ GeneratorExit
â””â”€â”€ Exception
    â”œâ”€â”€ StopIteration
    â”œâ”€â”€ StopAsyncIteration
    â”œâ”€â”€ ArithmeticError
    â”‚   â”œâ”€â”€ FloatingPointError
    â”‚   â”œâ”€â”€ OverflowError
    â”‚   â””â”€â”€ ZeroDivisionError
    â”œâ”€â”€ AssertionError
    â”œâ”€â”€ AttributeError
    â”œâ”€â”€ BufferError
    â”œâ”€â”€ EOFError
    â”œâ”€â”€ ImportError
    â”‚   â””â”€â”€ ModuleNotFoundError
    â”œâ”€â”€ LookupError
    â”‚   â”œâ”€â”€ IndexError
    â”‚   â””â”€â”€ KeyError
    â”œâ”€â”€ MemoryError
    â”œâ”€â”€ NameError
    â”‚   â””â”€â”€ UnboundLocalError
    â”œâ”€â”€ OSError
    â”‚   â”œâ”€â”€ BlockingIOError
    â”‚   â”œâ”€â”€ ChildProcessError
    â”‚   â”œâ”€â”€ ConnectionError
    â”‚   â”‚   â”œâ”€â”€ BrokenPipeError
    â”‚   â”‚   â”œâ”€â”€ ConnectionAbortedError
    â”‚   â”‚   â”œâ”€â”€ ConnectionRefusedError
    â”‚   â”‚   â””â”€â”€ ConnectionResetError
    â”‚   â”œâ”€â”€ FileExistsError
    â”‚   â”œâ”€â”€ FileNotFoundError
    â”‚   â”œâ”€â”€ InterruptedError
    â”‚   â”œâ”€â”€ IsADirectoryError
    â”‚   â”œâ”€â”€ NotADirectoryError
    â”‚   â”œâ”€â”€ PermissionError
    â”‚   â”œâ”€â”€ ProcessLookupError
    â”‚   â””â”€â”€ TimeoutError
    â”œâ”€â”€ ReferenceError
    â”œâ”€â”€ RuntimeError
    â”‚   â”œâ”€â”€ NotImplementedError
    â”‚   â””â”€â”€ RecursionError
    â”œâ”€â”€ SyntaxError
    â”‚   â””â”€â”€ IndentationError
    â”‚       â””â”€â”€ TabError
    â”œâ”€â”€ SystemError
    â”œâ”€â”€ TypeError
    â”œâ”€â”€ ValueError
    â”‚   â””â”€â”€ UnicodeError
    â”‚       â”œâ”€â”€ UnicodeDecodeError
    â”‚       â”œâ”€â”€ UnicodeEncodeError
    â”‚       â””â”€â”€ UnicodeTranslateError
    â””â”€â”€ Warning
        â”œâ”€â”€ DeprecationWarning
        â”œâ”€â”€ PendingDeprecationWarning
        â”œâ”€â”€ RuntimeWarning
        â”œâ”€â”€ SyntaxWarning
        â”œâ”€â”€ UserWarning
        â”œâ”€â”€ FutureWarning
        â”œâ”€â”€ ImportWarning
        â”œâ”€â”€ UnicodeWarning
        â””â”€â”€ BytesWarning</code></pre><h4>1.4 å¸¸è§çš„å†…ç½®å¼‚å¸¸</h4><p>Pythonæä¾›äº†è®¸å¤šå†…ç½®å¼‚å¸¸ï¼Œç”¨äºè¡¨ç¤ºä¸åŒç±»å‹çš„é”™è¯¯æƒ…å†µã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å†…ç½®å¼‚å¸¸ï¼š</p><ul><li><strong>ZeroDivisionError</strong>ï¼šé™¤ä»¥é›¶</li><li><strong>FileNotFoundError</strong>ï¼šæ–‡ä»¶ä¸å­˜åœ¨</li><li><strong>TypeError</strong>ï¼šç±»å‹é”™è¯¯</li><li><strong>ValueError</strong>ï¼šå€¼é”™è¯¯</li><li><strong>IndexError</strong>ï¼šç´¢å¼•è¶Šç•Œ</li><li><strong>KeyError</strong>ï¼šé”®ä¸å­˜åœ¨</li><li><strong>NameError</strong>ï¼šåç§°é”™è¯¯</li><li><strong>AttributeError</strong>ï¼šå±æ€§é”™è¯¯</li><li><strong>ImportError</strong>ï¼šå¯¼å…¥é”™è¯¯</li><li><strong>RuntimeError</strong>ï¼šè¿è¡Œæ—¶é”™è¯¯</li></ul><pre><code class="python"># å¼‚å¸¸çš„åŸºæœ¬æ¦‚å¿µç¤ºä¾‹

# 1. è§¦å‘å¸¸è§å¼‚å¸¸
print("è§¦å‘å¸¸è§å¼‚å¸¸ç¤ºä¾‹ï¼š")

# é™¤ä»¥é›¶ - ZeroDivisionError
try:
    result = 10 / 0
except ZeroDivisionError as e:
    print(f"ZeroDivisionError: {e}")

# è®¿é—®ä¸å­˜åœ¨çš„æ–‡ä»¶ - FileNotFoundError
try:
    with open("non_existent_file.txt", "r") as f:
        content = f.read()
except FileNotFoundError as e:
    print(f"FileNotFoundError: {e}")

# ç±»å‹é”™è¯¯ - TypeError
try:
    result = "10" + 5
except TypeError as e:
    print(f"TypeError: {e}")

# å€¼é”™è¯¯ - ValueError
try:
    result = int("abc")
except ValueError as e:
    print(f"ValueError: {e}")

# ç´¢å¼•è¶Šç•Œ - IndexError
try:
    lst = [1, 2, 3]
    print(lst[5])
except IndexError as e:
    print(f"IndexError: {e}")

# é”®ä¸å­˜åœ¨ - KeyError
try:
    dct = {"a": 1, "b": 2}
    print(dct["c"])
except KeyError as e:
    print(f"KeyError: {e}")

# åç§°é”™è¯¯ - NameError
try:
    print(undefined_variable)
except NameError as e:
    print(f"NameError: {e}")

# å±æ€§é”™è¯¯ - AttributeError
try:
    lst = [1, 2, 3]
    lst.non_existent_method()
except AttributeError as e:
    print(f"AttributeError: {e}")

# 2. å¼‚å¸¸å±‚æ¬¡ç»“æ„
print("\nå¼‚å¸¸å±‚æ¬¡ç»“æ„ç¤ºä¾‹ï¼š")

# æŸ¥çœ‹å¼‚å¸¸çš„åŸºç±»
print(f"ZeroDivisionErrorçš„åŸºç±»: {ZeroDivisionError.__bases__}")
print(f"ArithmeticErrorçš„åŸºç±»: {ArithmeticError.__bases__}")
print(f"Exceptionçš„åŸºç±»: {Exception.__bases__}")
print(f"BaseExceptionçš„åŸºç±»: {BaseException.__bases__}")

# 3. æ•è·æ‰€æœ‰å¼‚å¸¸
print("\næ•è·æ‰€æœ‰å¼‚å¸¸ç¤ºä¾‹ï¼š")

try:
    result = 10 / 0
except Exception as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {type(e).__name__}: {e}")

# 4. æ•è·å¤šä¸ªå¼‚å¸¸
try:
    lst = [1, 2, 3]
    print(lst[5])
except (IndexError, ZeroDivisionError) as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {type(e).__name__}: {e}")

# 5. å¼‚å¸¸çš„ä¼ é€’
def function1():
    print("function1 å¼€å§‹")
    function2()
    print("function1 ç»“æŸ")

def function2():
    print("function2 å¼€å§‹")
    10 / 0
    print("function2 ç»“æŸ")

print("\nå¼‚å¸¸çš„ä¼ é€’ç¤ºä¾‹ï¼š")
try:
    function1()
except ZeroDivisionError as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")</code></pre><h3>2. å¼‚å¸¸å¤„ç†æœºåˆ¶</h3><p>Pythonçš„å¼‚å¸¸å¤„ç†æœºåˆ¶å…è®¸æˆ‘ä»¬æ•è·å’Œå¤„ç†ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„å¼‚å¸¸ï¼Œä»è€Œä½¿ç¨‹åºèƒ½å¤Ÿæ›´åŠ å¥å£®å’Œå¯é ã€‚</p><h4>2.1 å¼‚å¸¸å¤„ç†çš„åŸºæœ¬è¯­æ³•</h4><p>Pythonçš„å¼‚å¸¸å¤„ç†ä½¿ç”¨<code>try-except</code>è¯­å¥æ¥å®ç°ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><pre><code class="python">try:
    # å¯èƒ½ä¼šå¼•å‘å¼‚å¸¸çš„ä»£ç 
    pass
except ExceptionType1:
    # å¤„ç†ExceptionType1ç±»å‹çš„å¼‚å¸¸
    pass
except ExceptionType2:
    # å¤„ç†ExceptionType2ç±»å‹çš„å¼‚å¸¸
    pass
else:
    # å¦‚æœæ²¡æœ‰å¼•å‘å¼‚å¸¸ï¼Œæ‰§è¡Œè¿™é‡Œçš„ä»£ç 
    pass
finally:
    # æ— è®ºæ˜¯å¦å¼•å‘å¼‚å¸¸ï¼Œéƒ½ä¼šæ‰§è¡Œè¿™é‡Œçš„ä»£ç 
    pass</code></pre><h4>2.2 tryå­å¥</h4><p><code>try</code>å­å¥åŒ…å«å¯èƒ½ä¼šå¼•å‘å¼‚å¸¸çš„ä»£ç ã€‚å½“<code>try</code>å­å¥ä¸­çš„ä»£ç æ‰§è¡Œæ—¶ï¼Œå¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼ŒPythonä¼šç«‹å³åœæ­¢æ‰§è¡Œ<code>try</code>å­å¥ä¸­çš„å‰©ä½™ä»£ç ï¼Œå¹¶è·³è½¬åˆ°ç›¸åº”çš„<code>except</code>å­å¥ã€‚</p><h4>2.3 exceptå­å¥</h4><p><code>except</code>å­å¥ç”¨äºæ•è·å’Œå¤„ç†ç‰¹å®šç±»å‹çš„å¼‚å¸¸ã€‚ä¸€ä¸ª<code>try</code>è¯­å¥å¯ä»¥åŒ…å«å¤šä¸ª<code>except</code>å­å¥ï¼Œæ¯ä¸ª<code>except</code>å­å¥å¤„ç†ä¸€ç§æˆ–å¤šç§ç±»å‹çš„å¼‚å¸¸ã€‚</p><h4>2.4 elseå­å¥</h4><p><code>else</code>å­å¥æ˜¯å¯é€‰çš„ï¼Œå®ƒåŒ…å«å½“<code>try</code>å­å¥ä¸­æ²¡æœ‰å¼•å‘å¼‚å¸¸æ—¶æ‰§è¡Œçš„ä»£ç ã€‚<code>else</code>å­å¥å¿…é¡»ä½äºæ‰€æœ‰<code>except</code>å­å¥ä¹‹åã€‚</p><h4>2.5 finallyå­å¥</h4><p><code>finally</code>å­å¥æ˜¯å¯é€‰çš„ï¼Œå®ƒåŒ…å«æ— è®ºæ˜¯å¦å¼•å‘å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œçš„ä»£ç ã€‚<code>finally</code>å­å¥é€šå¸¸ç”¨äºé‡Šæ”¾èµ„æºï¼Œä¾‹å¦‚å…³é—­æ–‡ä»¶æˆ–ç½‘ç»œè¿æ¥ã€‚</p><h4>2.6 å¼‚å¸¸å¤„ç†çš„æ‰§è¡Œæµç¨‹</h4><p>å¼‚å¸¸å¤„ç†çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>æ‰§è¡Œ<code>try</code>å­å¥ä¸­çš„ä»£ç </li><li>å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼š<br/>a. åœæ­¢æ‰§è¡Œ<code>try</code>å­å¥ä¸­çš„å‰©ä½™ä»£ç <br/>b. æŸ¥æ‰¾åŒ¹é…çš„<code>except</code>å­å¥<br/>c. å¦‚æœæ‰¾åˆ°åŒ¹é…çš„<code>except</code>å­å¥ï¼Œæ‰§è¡Œè¯¥å­å¥ä¸­çš„ä»£ç <br/>d. å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„<code>except</code>å­å¥ï¼Œå¼‚å¸¸ä¼šå‘ä¸Šä¼ é€’<br/>e. æ‰§è¡Œ<code>finally</code>å­å¥ä¸­çš„ä»£ç </li><li>å¦‚æœæ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ï¼š<br/>a. æ‰§è¡Œ<code>else</code>å­å¥ä¸­çš„ä»£ç <br/>b. æ‰§è¡Œ<code>finally</code>å­å¥ä¸­çš„ä»£ç </li></ol><pre><code class="python"># å¼‚å¸¸å¤„ç†æœºåˆ¶ç¤ºä¾‹

# 1. åŸºæœ¬çš„try-exceptè¯­å¥
print("åŸºæœ¬çš„try-exceptè¯­å¥ç¤ºä¾‹ï¼š")

try:
    num = int(input("è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°: "))
    result = 10 / num
    print(f"ç»“æœ: {result}")
except ValueError:
    print("è¾“å…¥é”™è¯¯ï¼Œè¯·è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆçš„æ•´æ•°")
except ZeroDivisionError:
    print("é”™è¯¯ï¼šä¸èƒ½é™¤ä»¥é›¶")

# 2. å¸¦æœ‰elseå­å¥çš„try-exceptè¯­å¥
print("\nå¸¦æœ‰elseå­å¥çš„try-exceptè¯­å¥ç¤ºä¾‹ï¼š")

try:
    num = int(input("è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°: "))
    result = 10 / num
except ValueError:
    print("è¾“å…¥é”™è¯¯ï¼Œè¯·è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆçš„æ•´æ•°")
except ZeroDivisionError:
    print("é”™è¯¯ï¼šä¸èƒ½é™¤ä»¥é›¶")
else:
    print(f"è®¡ç®—æˆåŠŸï¼Œç»“æœ: {result}")

# 3. å¸¦æœ‰finallyå­å¥çš„try-exceptè¯­å¥
print("\nå¸¦æœ‰finallyå­å¥çš„try-exceptè¯­å¥ç¤ºä¾‹ï¼š")

try:
    print("å°è¯•æ‰“å¼€æ–‡ä»¶")
    f = open("test.txt", "w")
    f.write("Hello, World!")
except Exception as e:
    print(f"å‘ç”Ÿå¼‚å¸¸: {e}")
finally:
    print("æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ï¼Œéƒ½ä¼šæ‰§è¡Œfinallyå­å¥")
    if 'f' in locals() and not f.closed:
        print("å…³é—­æ–‡ä»¶")
        f.close()

# 4. æ•è·æ‰€æœ‰å¼‚å¸¸
print("\næ•è·æ‰€æœ‰å¼‚å¸¸ç¤ºä¾‹ï¼š")

try:
    num = int(input("è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°: "))
    result = 10 / num
    print(f"ç»“æœ: {result}")
except Exception as e:
    print(f"å‘ç”Ÿå¼‚å¸¸: {type(e).__name__}: {e}")

# 5. å¼‚å¸¸çš„ä¼ é€’
print("\nå¼‚å¸¸çš„ä¼ é€’ç¤ºä¾‹ï¼š")

def read_file(filename):
    with open(filename, "r") as f:
        content = f.read()
    return content

def process_data(data):
    lines = data.split('\n')
    return len(lines)

def main():
    try:
        data = read_file("non_existent_file.txt")
        count = process_data(data)
        print(f"æ–‡ä»¶è¡Œæ•°: {count}")
    except FileNotFoundError as e:
        print(f"æ–‡ä»¶ä¸å­˜åœ¨: {e}")
    except Exception as e:
        print(f"å‘ç”Ÿå…¶ä»–å¼‚å¸¸: {e}")

main()

# 6. å¼‚å¸¸å¤„ç†çš„åµŒå¥—
print("\nå¼‚å¸¸å¤„ç†çš„åµŒå¥—ç¤ºä¾‹ï¼š")

try:
    print("å¤–å±‚try")
    try:
        print("å†…å±‚try")
        10 / 0
    except ZeroDivisionError as e:
        print(f"å†…å±‚except: {e}")
        # é‡æ–°å¼•å‘å¼‚å¸¸
        raise
    finally:
        print("å†…å±‚finally")
except Exception as e:
    print(f"å¤–å±‚except: {e}")
finally:
    print("å¤–å±‚finally")</code></pre><h3>3. å¼‚å¸¸çš„å¼•å‘ä¸ä¼ æ’­</h3><p>åœ¨Pythonä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>raise</code>è¯­å¥æ¥å¼•å‘å¼‚å¸¸ï¼Œä¹Ÿå¯ä»¥æ•è·å¼‚å¸¸åé‡æ–°å¼•å‘å¼‚å¸¸ã€‚ç†è§£å¼‚å¸¸çš„å¼•å‘ä¸ä¼ æ’­æœºåˆ¶å¯¹äºç¼–å†™å¥å£®çš„ä»£ç éå¸¸é‡è¦ã€‚</p><h4>3.1 raiseè¯­å¥</h4><p><code>raise</code>è¯­å¥ç”¨äºå¼•å‘å¼‚å¸¸ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><pre><code class="python">raise ExceptionType("å¼‚å¸¸ä¿¡æ¯")</code></pre><p><code>raise</code>è¯­å¥å¯ä»¥å¼•å‘å†…ç½®å¼‚å¸¸æˆ–è‡ªå®šä¹‰å¼‚å¸¸ã€‚å½“ä½¿ç”¨<code>raise</code>è¯­å¥æ—¶ï¼ŒPythonä¼šç«‹å³åœæ­¢æ‰§è¡Œå½“å‰ä»£ç ï¼Œå¹¶å¼€å§‹æŸ¥æ‰¾åŒ¹é…çš„<code>except</code>å­å¥ã€‚</p><h4>3.2 é‡æ–°å¼•å‘å¼‚å¸¸</h4><p>åœ¨<code>except</code>å­å¥ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸å¸¦å‚æ•°çš„<code>raise</code>è¯­å¥æ¥é‡æ–°å¼•å‘å½“å‰æ•è·çš„å¼‚å¸¸ã€‚è¿™é€šå¸¸ç”¨äºè®°å½•å¼‚å¸¸ä¿¡æ¯åï¼Œå°†å¼‚å¸¸ä¼ é€’ç»™ä¸Šå±‚è°ƒç”¨è€…å¤„ç†ã€‚</p><h4>3.3 å¼‚å¸¸çš„ä¼ æ’­</h4><p>å½“å¼‚å¸¸åœ¨å‡½æ•°æˆ–æ–¹æ³•ä¸­å¼•å‘ä½†æœªè¢«æ•è·æ—¶ï¼Œå¼‚å¸¸ä¼šå‘ä¸Šä¼ æ’­åˆ°è°ƒç”¨è¯¥å‡½æ•°æˆ–æ–¹æ³•çš„ä»£ç ã€‚å¦‚æœå¼‚å¸¸ä¸€ç›´ä¼ æ’­åˆ°ç¨‹åºçš„é¡¶å±‚è€Œæœªè¢«æ•è·ï¼Œç¨‹åºä¼šç»ˆæ­¢å¹¶æ˜¾ç¤ºå¼‚å¸¸ä¿¡æ¯ã€‚</p><h4>3.4 å¼‚å¸¸é“¾</h4><p>åœ¨Python 3ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>raise NewException from OriginalException</code>è¯­å¥æ¥åˆ›å»ºå¼‚å¸¸é“¾ï¼Œè¿™æ ·å¯ä»¥ä¿ç•™åŸå§‹å¼‚å¸¸çš„ä¿¡æ¯ï¼Œä¾¿äºè°ƒè¯•ã€‚</p><pre><code class="python"># å¼‚å¸¸çš„å¼•å‘ä¸ä¼ æ’­ç¤ºä¾‹

# 1. ä½¿ç”¨raiseè¯­å¥å¼•å‘å¼‚å¸¸
print("ä½¿ç”¨raiseè¯­å¥å¼•å‘å¼‚å¸¸ç¤ºä¾‹ï¼š")

def divide(a, b):
    if b == 0:
        raise ZeroDivisionError("é™¤æ•°ä¸èƒ½ä¸ºé›¶")
    return a / b

try:
    result = divide(10, 0)
except ZeroDivisionError as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")

# 2. é‡æ–°å¼•å‘å¼‚å¸¸
print("\né‡æ–°å¼•å‘å¼‚å¸¸ç¤ºä¾‹ï¼š")

def process_data(data):
    try:
        if not data:
            raise ValueError("æ•°æ®ä¸èƒ½ä¸ºç©º")
        return len(data)
    except ValueError as e:
        print(f"è®°å½•å¼‚å¸¸: {e}")
        raise  # é‡æ–°å¼•å‘å¼‚å¸¸

try:
    result = process_data("")
except ValueError as e:
    print(f"æ•è·åˆ°é‡æ–°å¼•å‘çš„å¼‚å¸¸: {e}")

# 3. å¼‚å¸¸çš„ä¼ æ’­
print("\nå¼‚å¸¸çš„ä¼ æ’­ç¤ºä¾‹ï¼š")

def level1():
    print("level1 å¼€å§‹")
    level2()
    print("level1 ç»“æŸ")

def level2():
    print("level2 å¼€å§‹")
    level3()
    print("level2 ç»“æŸ")

def level3():
    print("level3 å¼€å§‹")
    raise ValueError("åœ¨level3ä¸­å¼•å‘å¼‚å¸¸")
    print("level3 ç»“æŸ")

try:
    level1()
except ValueError as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")

# 4. å¼‚å¸¸é“¾
print("\nå¼‚å¸¸é“¾ç¤ºä¾‹ï¼š")

def read_config():
    try:
        with open("config.json", "r") as f:
            # å‡è®¾è¿™é‡Œéœ€è¦è§£æJSON
            raise ValueError("JSONæ ¼å¼é”™è¯¯")
    except FileNotFoundError as e:
        raise RuntimeError("æ— æ³•è¯»å–é…ç½®æ–‡ä»¶") from e

try:
    read_config()
except RuntimeError as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")
    if e.__cause__:
        print(f"åŸå§‹å¼‚å¸¸: {e.__cause__}")

# 5. è‡ªå®šä¹‰å¼‚å¸¸ç±»
print("\nè‡ªå®šä¹‰å¼‚å¸¸ç±»ç¤ºä¾‹ï¼š")

class CustomError(Exception):
    """è‡ªå®šä¹‰å¼‚å¸¸ç±»"""
    def __init__(self, message, error_code):
        super().__init__(message)
        self.error_code = error_code
    
    def __str__(self):
        return f"{self.__class__.__name__}: {self.args[0]} (é”™è¯¯ç : {self.error_code})"

def validate_input(value):
    if value &lt; 0:
        raise CustomError("è¾“å…¥å€¼ä¸èƒ½ä¸ºè´Ÿæ•°", 400)
    return value

try:
    result = validate_input(-5)
except CustomError as e:
    print(f"æ•è·åˆ°è‡ªå®šä¹‰å¼‚å¸¸: {e}")
    print(f"é”™è¯¯ç : {e.error_code}")</code></pre><h3>4. è‡ªå®šä¹‰å¼‚å¸¸</h3><p>åœ¨Pythonä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§æ‰¿å†…ç½®å¼‚å¸¸ç±»æ¥åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸ã€‚è‡ªå®šä¹‰å¼‚å¸¸å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç»„ç»‡å’Œç®¡ç†ä»£ç ä¸­çš„é”™è¯¯æƒ…å†µã€‚</p><h4>4.1 åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸ç±»</h4><p>åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸ç±»çš„åŸºæœ¬æ­¥éª¤ï¼š</p><ol><li>ç»§æ‰¿ä¸€ä¸ªå†…ç½®å¼‚å¸¸ç±»ï¼ˆé€šå¸¸æ˜¯<code>Exception</code>ç±»ï¼‰</li><li>æ·»åŠ è‡ªå®šä¹‰çš„å±æ€§å’Œæ–¹æ³•</li><li>å®ç°<code>__init__</code>æ–¹æ³•ï¼ˆå¯é€‰ï¼‰</li><li>å®ç°<code>__str__</code>æ–¹æ³•ï¼ˆå¯é€‰ï¼‰</li></ol><h4>4.2 è‡ªå®šä¹‰å¼‚å¸¸çš„æœ€ä½³å®è·µ</h4><p>åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸æ—¶ï¼Œåº”éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š</p><ul><li><strong>ç»§æ‰¿é€‚å½“çš„å¼‚å¸¸ç±»</strong>ï¼šæ ¹æ®å¼‚å¸¸çš„æ€§è´¨ï¼Œç»§æ‰¿é€‚å½“çš„å†…ç½®å¼‚å¸¸ç±»</li><li><strong>æä¾›æœ‰æ„ä¹‰çš„å¼‚å¸¸ä¿¡æ¯</strong>ï¼šåœ¨å¼‚å¸¸ä¿¡æ¯ä¸­åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li><li><strong>æ·»åŠ è‡ªå®šä¹‰å±æ€§</strong>ï¼šæ ¹æ®éœ€è¦æ·»åŠ è‡ªå®šä¹‰å±æ€§ï¼Œä»¥æä¾›æ›´å¤šå…³äºå¼‚å¸¸çš„ä¿¡æ¯</li><li><strong>ä¿æŒå¼‚å¸¸ç±»çš„ç®€æ´</strong>ï¼šå¼‚å¸¸ç±»åº”è¯¥ä¿æŒç®€æ´ï¼ŒåªåŒ…å«å¿…è¦çš„ä»£ç </li><li><strong>ä½¿ç”¨å¼‚å¸¸å±‚æ¬¡ç»“æ„</strong>ï¼šå¯¹äºå¤æ‚çš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥åˆ›å»ºå¼‚å¸¸å±‚æ¬¡ç»“æ„</li></ul><h4>4.3 è‡ªå®šä¹‰å¼‚å¸¸çš„åº”ç”¨åœºæ™¯</h4><p>è‡ªå®šä¹‰å¼‚å¸¸é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p><ul><li><strong>ä¸šåŠ¡é€»è¾‘é”™è¯¯</strong>ï¼šè¡¨ç¤ºä¸šåŠ¡é€»è¾‘ä¸­çš„é”™è¯¯æƒ…å†µ</li><li><strong>APIé”™è¯¯</strong>ï¼šè¡¨ç¤ºAPIè°ƒç”¨ä¸­çš„é”™è¯¯æƒ…å†µ</li><li><strong>é…ç½®é”™è¯¯</strong>ï¼šè¡¨ç¤ºé…ç½®æ–‡ä»¶ä¸­çš„é”™è¯¯æƒ…å†µ</li><li><strong>éªŒè¯é”™è¯¯</strong>ï¼šè¡¨ç¤ºè¾“å…¥éªŒè¯ä¸­çš„é”™è¯¯æƒ…å†µ</li></ul><pre><code class="python"># è‡ªå®šä¹‰å¼‚å¸¸ç¤ºä¾‹

# 1. åŸºæœ¬çš„è‡ªå®šä¹‰å¼‚å¸¸ç±»
print("åŸºæœ¬çš„è‡ªå®šä¹‰å¼‚å¸¸ç±»ç¤ºä¾‹ï¼š")

class ValidationError(Exception):
    """éªŒè¯é”™è¯¯å¼‚å¸¸"""
    pass

def validate_email(email):
    if '@' not in email:
        raise ValidationError(f"æ— æ•ˆçš„é‚®ç®±åœ°å€: {email}")
    return email

try:
    result = validate_email("invalid-email")
except ValidationError as e:
    print(f"æ•è·åˆ°éªŒè¯é”™è¯¯: {e}")

# 2. å¸¦æœ‰è‡ªå®šä¹‰å±æ€§çš„å¼‚å¸¸ç±»
print("\nå¸¦æœ‰è‡ªå®šä¹‰å±æ€§çš„å¼‚å¸¸ç±»ç¤ºä¾‹ï¼š")

class APIError(Exception):
    """APIé”™è¯¯å¼‚å¸¸"""
    def __init__(self, message, status_code, error_code):
        super().__init__(message)
        self.status_code = status_code
        self.error_code = error_code
    
    def __str__(self):
        return f"APIError: {self.args[0]} (çŠ¶æ€ç : {self.status_code}, é”™è¯¯ç : {self.error_code})"

def call_api(endpoint):
    if endpoint == "/error":
        raise APIError("APIè°ƒç”¨å¤±è´¥", 500, "INTERNAL_SERVER_ERROR")
    return "APIè°ƒç”¨æˆåŠŸ"

try:
    result = call_api("/error")
except APIError as e:
    print(f"æ•è·åˆ°APIé”™è¯¯: {e}")
    print(f"çŠ¶æ€ç : {e.status_code}")
    print(f"é”™è¯¯ç : {e.error_code}")

# 3. å¼‚å¸¸å±‚æ¬¡ç»“æ„
print("\nå¼‚å¸¸å±‚æ¬¡ç»“æ„ç¤ºä¾‹ï¼š")

class AppError(Exception):
    """åº”ç”¨ç¨‹åºåŸºç¡€å¼‚å¸¸"""
    pass

class DatabaseError(AppError):
    """æ•°æ®åº“é”™è¯¯"""
    pass

class NetworkError(AppError):
    """ç½‘ç»œé”™è¯¯"""
    pass

class ConnectionError(NetworkError):
    """è¿æ¥é”™è¯¯"""
    pass

class TimeoutError(NetworkError):
    """è¶…æ—¶é”™è¯¯"""
    pass

def connect_to_database():
    raise DatabaseError("æ•°æ®åº“è¿æ¥å¤±è´¥")

def connect_to_api():
    raise ConnectionError("APIè¿æ¥å¤±è´¥")

try:
    connect_to_database()
except AppError as e:
    print(f"æ•è·åˆ°åº”ç”¨ç¨‹åºé”™è¯¯: {e}")

try:
    connect_to_api()
except NetworkError as e:
    print(f"æ•è·åˆ°ç½‘ç»œé”™è¯¯: {e}")
except AppError as e:
    print(f"æ•è·åˆ°åº”ç”¨ç¨‹åºé”™è¯¯: {e}")

# 4. è‡ªå®šä¹‰å¼‚å¸¸çš„å®é™…åº”ç”¨
print("\nè‡ªå®šä¹‰å¼‚å¸¸çš„å®é™…åº”ç”¨ç¤ºä¾‹ï¼š")

class ConfigurationError(AppError):
    """é…ç½®é”™è¯¯"""
    def __init__(self, message, config_key=None):
        super().__init__(message)
        self.config_key = config_key

class InputError(AppError):
    """è¾“å…¥é”™è¯¯"""
    def __init__(self, message, input_value=None):
        super().__init__(message)
        self.input_value = input_value

def load_config(config):
    if "database" not in config:
        raise ConfigurationError("é…ç½®ä¸­ç¼ºå°‘æ•°æ®åº“ä¿¡æ¯", "database")
    if "host" not in config["database"]:
        raise ConfigurationError("é…ç½®ä¸­ç¼ºå°‘æ•°æ®åº“ä¸»æœºä¿¡æ¯", "database.host")
    return config

def process_input(value):
    if not isinstance(value, int):
        raise InputError("è¾“å…¥å€¼å¿…é¡»æ˜¯æ•´æ•°", value)
    if value &lt; 0:
        raise InputError("è¾“å…¥å€¼å¿…é¡»æ˜¯éè´Ÿæ•°", value)
    return value

try:
    config = load_config({"api": {"key": "secret"}})
except ConfigurationError as e:
    print(f"æ•è·åˆ°é…ç½®é”™è¯¯: {e}")
    if e.config_key:
        print(f"é…ç½®é”®: {e.config_key}")

try:
    result = process_input(-5)
except InputError as e:
    print(f"æ•è·åˆ°è¾“å…¥é”™è¯¯: {e}")
    if e.input_value is not None:
        print(f"è¾“å…¥å€¼: {e.input_value}")</code></pre><h3>5. å¼‚å¸¸å¤„ç†çš„æœ€ä½³å®è·µ</h3><p>å¼‚å¸¸å¤„ç†æ˜¯Pythonç¼–ç¨‹ä¸­çš„é‡è¦éƒ¨åˆ†ï¼Œæ­£ç¡®çš„å¼‚å¸¸å¤„ç†å¯ä»¥ä½¿ç¨‹åºæ›´åŠ å¥å£®å’Œå¯é ã€‚ä»¥ä¸‹æ˜¯å¼‚å¸¸å¤„ç†çš„æœ€ä½³å®è·µï¼š</p><h4>5.1 å¼‚å¸¸å¤„ç†çš„åŸåˆ™</h4><ul><li><strong>åªæ•è·å¿…è¦çš„å¼‚å¸¸</strong>ï¼šåªæ•è·ä½ èƒ½å¤Ÿå¤„ç†çš„å¼‚å¸¸ï¼Œä¸è¦æ•è·æ‰€æœ‰å¼‚å¸¸</li><li><strong>ä½¿ç”¨å…·ä½“çš„å¼‚å¸¸ç±»å‹</strong>ï¼šå°½é‡ä½¿ç”¨å…·ä½“çš„å¼‚å¸¸ç±»å‹ï¼Œè€Œä¸æ˜¯æ•è·æ‰€æœ‰å¼‚å¸¸</li><li><strong>æä¾›æœ‰æ„ä¹‰çš„å¼‚å¸¸ä¿¡æ¯</strong>ï¼šåœ¨å¼‚å¸¸ä¿¡æ¯ä¸­åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li><li><strong>ä¸è¦å¿½ç•¥å¼‚å¸¸</strong>ï¼šä¸è¦æ•è·å¼‚å¸¸åä¸åšä»»ä½•å¤„ç†</li><li><strong>åŠæ—¶é‡Šæ”¾èµ„æº</strong>ï¼šä½¿ç”¨<code>finally</code>å­å¥æˆ–ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ¥ç¡®ä¿èµ„æºçš„é‡Šæ”¾</li><li><strong>ä¿æŒå¼‚å¸¸å¤„ç†çš„ç®€æ´</strong>ï¼šå¼‚å¸¸å¤„ç†ä»£ç åº”è¯¥ä¿æŒç®€æ´ï¼ŒåªåŒ…å«å¿…è¦çš„ä»£ç </li><li><strong>ä½¿ç”¨å¼‚å¸¸è¿›è¡Œé”™è¯¯å¤„ç†</strong>ï¼šä½¿ç”¨å¼‚å¸¸æ¥å¤„ç†é”™è¯¯æƒ…å†µï¼Œè€Œä¸æ˜¯ä½¿ç”¨è¿”å›å€¼</li></ul><h4>5.2 å¼‚å¸¸å¤„ç†çš„å¸¸è§é”™è¯¯</h4><ul><li><strong>è¿‡åº¦ä½¿ç”¨å¼‚å¸¸</strong>ï¼šä¸è¦ä½¿ç”¨å¼‚å¸¸æ¥æ§åˆ¶æ­£å¸¸çš„ç¨‹åºæµç¨‹</li><li><strong>æ•è·æ‰€æœ‰å¼‚å¸¸</strong>ï¼šä¸è¦æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œè¿™ä¼šæ©ç›–çœŸæ­£çš„é—®é¢˜</li><li><strong>å¿½ç•¥å¼‚å¸¸</strong>ï¼šä¸è¦æ•è·å¼‚å¸¸åä¸åšä»»ä½•å¤„ç†</li><li><strong>å¼‚å¸¸ä¿¡æ¯ä¸æ˜ç¡®</strong>ï¼šå¼‚å¸¸ä¿¡æ¯åº”è¯¥æ¸…æ™°æ˜ç¡®ï¼ŒåŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li><li><strong>èµ„æºæ³„éœ²</strong>ï¼šç¡®ä¿åœ¨å¼‚å¸¸å‘ç”Ÿæ—¶é‡Šæ”¾èµ„æº</li><li><strong>å¼‚å¸¸å¤„ç†çš„åµŒå¥—è¿‡æ·±</strong>ï¼šé¿å…å¼‚å¸¸å¤„ç†çš„åµŒå¥—è¿‡æ·±ï¼Œè¿™ä¼šä½¿ä»£ç éš¾ä»¥ç†è§£</li></ul><h4>5.3 å¼‚å¸¸å¤„ç†çš„æ¨¡å¼</h4><h5>5.3.1 EAFPæ¨¡å¼</h5><p>EAFPï¼ˆEasier to Ask for Forgiveness than Permissionï¼‰æ˜¯Pythonä¸­çš„ä¸€ç§ç¼–ç¨‹æ¨¡å¼ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå…ˆå°è¯•æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå‘ç”Ÿå¼‚å¸¸å†å¤„ç†ã€‚è¿™ç§æ¨¡å¼åœ¨Pythonä¸­éå¸¸å¸¸è§ï¼Œä¾‹å¦‚ï¼š</p><pre><code class="python">try:
    value = dictionary[key]
except KeyError:
    value = default_value</code></pre><h5>5.3.2 LBYLæ¨¡å¼</h5><p>LBYLï¼ˆLook Before You Leapï¼‰æ˜¯å¦ä¸€ç§ç¼–ç¨‹æ¨¡å¼ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨æ‰§è¡Œæ“ä½œä¹‹å‰å…ˆæ£€æŸ¥æ¡ä»¶ï¼Œå¦‚æœæ¡ä»¶æ»¡è¶³å†æ‰§è¡Œæ“ä½œã€‚ä¾‹å¦‚ï¼š</p><pre><code class="python">if key in dictionary:
    value = dictionary[key]
else:
    value = default_value</code></pre><p>åœ¨Pythonä¸­ï¼ŒEAFPæ¨¡å¼é€šå¸¸æ¯”LBYLæ¨¡å¼æ›´å—æ¬¢è¿ï¼Œå› ä¸ºå®ƒæ›´ç®€æ´ï¼Œå¹¶ä¸”åœ¨å¹¶å‘ç¯å¢ƒä¸­æ›´å®‰å…¨ã€‚</p><h4>5.4 å¼‚å¸¸å¤„ç†çš„æ€§èƒ½è€ƒè™‘</h4><p>å¼‚å¸¸å¤„ç†ä¼šå¯¹ç¨‹åºçš„æ€§èƒ½äº§ç”Ÿä¸€å®šçš„å½±å“ï¼Œå› æ­¤åœ¨ç¼–å†™ä»£ç æ—¶åº”è¯¥è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li><strong>å¼‚å¸¸åªç”¨äºå¼‚å¸¸æƒ…å†µ</strong>ï¼šä¸è¦ä½¿ç”¨å¼‚å¸¸æ¥æ§åˆ¶æ­£å¸¸çš„ç¨‹åºæµç¨‹</li><li><strong>é¿å…åœ¨å¾ªç¯ä¸­å¼•å‘å¼‚å¸¸</strong>ï¼šåœ¨å¾ªç¯ä¸­å¼•å‘å¼‚å¸¸ä¼šæ˜¾è‘—é™ä½ç¨‹åºçš„æ€§èƒ½</li><li><strong>ä½¿ç”¨å±€éƒ¨å˜é‡</strong>ï¼šåœ¨å¼‚å¸¸å¤„ç†ä»£ç ä¸­ä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œè€Œä¸æ˜¯å…¨å±€å˜é‡</li><li><strong>ä¿æŒå¼‚å¸¸å¤„ç†çš„ç®€æ´</strong>ï¼šå¼‚å¸¸å¤„ç†ä»£ç åº”è¯¥ä¿æŒç®€æ´ï¼ŒåªåŒ…å«å¿…è¦çš„ä»£ç </li></ul><pre><code class="python"># å¼‚å¸¸å¤„ç†çš„æœ€ä½³å®è·µç¤ºä¾‹

# 1. åªæ•è·å¿…è¦çš„å¼‚å¸¸
print("åªæ•è·å¿…è¦çš„å¼‚å¸¸ç¤ºä¾‹ï¼š")

try:
    num = int(input("è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°: "))
    result = 10 / num
    print(f"ç»“æœ: {result}")
except ValueError:
    print("è¾“å…¥é”™è¯¯ï¼Œè¯·è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆçš„æ•´æ•°")
except ZeroDivisionError:
    print("é”™è¯¯ï¼šä¸èƒ½é™¤ä»¥é›¶")
# ä¸è¦è¿™æ ·åš
# except Exception:
#     print("å‘ç”Ÿé”™è¯¯")

# 2. æä¾›æœ‰æ„ä¹‰çš„å¼‚å¸¸ä¿¡æ¯
print("\næä¾›æœ‰æ„ä¹‰çš„å¼‚å¸¸ä¿¡æ¯ç¤ºä¾‹ï¼š")

def divide(a, b):
    if b == 0:
        raise ZeroDivisionError(f"é™¤æ•°ä¸èƒ½ä¸ºé›¶ (a={a}, b={b})")
    return a / b

try:
    result = divide(10, 0)
except ZeroDivisionError as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")

# 3. ä½¿ç”¨finallyå­å¥é‡Šæ”¾èµ„æº
print("\nä½¿ç”¨finallyå­å¥é‡Šæ”¾èµ„æºç¤ºä¾‹ï¼š")

def read_file(filename):
    f = None
    try:
        f = open(filename, "r")
        content = f.read()
        return content
    except FileNotFoundError:
        print(f"æ–‡ä»¶ä¸å­˜åœ¨: {filename}")
        return ""
    finally:
        if f is not None:
            f.close()
            print("æ–‡ä»¶å·²å…³é—­")

content = read_file("non_existent_file.txt")
print(f"æ–‡ä»¶å†…å®¹: {content}")

# 4. ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨
print("\nä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç¤ºä¾‹ï¼š")

def read_file_safely(filename):
    try:
        with open(filename, "r") as f:
            content = f.read()
        return content
    except FileNotFoundError:
        print(f"æ–‡ä»¶ä¸å­˜åœ¨: {filename}")
        return ""

content = read_file_safely("non_existent_file.txt")
print(f"æ–‡ä»¶å†…å®¹: {content}")

# 5. EAFP vs LBYLæ¨¡å¼
print("\nEAFP vs LBYLæ¨¡å¼ç¤ºä¾‹ï¼š")

# EAFPæ¨¡å¼
dictionary = {"a": 1, "b": 2}
key = "c"

try:
    value = dictionary[key]
    print(f"EAFPæ¨¡å¼: æ‰¾åˆ°å€¼: {value}")
except KeyError:
    value = "é»˜è®¤å€¼"
    print(f"EAFPæ¨¡å¼: é”®ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤å€¼: {value}")

# LBYLæ¨¡å¼
if key in dictionary:
    value = dictionary[key]
    print(f"LBYLæ¨¡å¼: æ‰¾åˆ°å€¼: {value}")
else:
    value = "é»˜è®¤å€¼"
    print(f"LBYLæ¨¡å¼: é”®ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤å€¼: {value}")

# 6. å¼‚å¸¸å¤„ç†çš„æ€§èƒ½è€ƒè™‘
print("\nå¼‚å¸¸å¤„ç†çš„æ€§èƒ½è€ƒè™‘ç¤ºä¾‹ï¼š")

import time

# æµ‹è¯•æ­£å¸¸æƒ…å†µä¸‹çš„æ€§èƒ½
def test_normal_case():
    start = time.time()
    for i in range(1000000):
        # æ­£å¸¸æµç¨‹
        pass
    end = time.time()
    print(f"æ­£å¸¸æƒ…å†µè€—æ—¶: {end - start:.4f}ç§’")

# æµ‹è¯•å¼‚å¸¸æƒ…å†µä¸‹çš„æ€§èƒ½
def test_exception_case():
    start = time.time()
    for i in range(1000000):
        try:
            # å°è¯•æ‰§è¡Œæ“ä½œ
            pass
        except Exception:
            # æ•è·å¼‚å¸¸
            pass
    end = time.time()
    print(f"å¼‚å¸¸å¤„ç†è€—æ—¶: {end - start:.4f}ç§’")

# æµ‹è¯•å¼•å‘å¼‚å¸¸çš„æ€§èƒ½
def test_raise_exception():
    start = time.time()
    for i in range(1000):
        try:
            raise Exception("æµ‹è¯•å¼‚å¸¸")
        except Exception:
            pass
    end = time.time()
    print(f"å¼•å‘å¼‚å¸¸è€—æ—¶: {end - start:.4f}ç§’")

test_normal_case()
test_exception_case()
test_raise_exception()

# 7. è‡ªå®šä¹‰å¼‚å¸¸çš„æœ€ä½³å®è·µ
print("\nè‡ªå®šä¹‰å¼‚å¸¸çš„æœ€ä½³å®è·µç¤ºä¾‹ï¼š")

class BusinessLogicError(Exception):
    """ä¸šåŠ¡é€»è¾‘é”™è¯¯"""
    def __init__(self, message, error_code):
        super().__init__(message)
        self.error_code = error_code
    
    def to_dict(self):
        """å°†å¼‚å¸¸è½¬æ¢ä¸ºå­—å…¸"""
        return {
            "error": self.__class__.__name__,
            "message": self.args[0],
            "error_code": self.error_code
        }

def process_order(order):
    if not order.get("customer_id"):
        raise BusinessLogicError("è®¢å•ç¼ºå°‘å®¢æˆ·ID", "MISSING_CUSTOMER_ID")
    if order.get("amount") &lt;= 0:
        raise BusinessLogicError("è®¢å•é‡‘é¢å¿…é¡»å¤§äºé›¶", "INVALID_AMOUNT")
    return "è®¢å•å¤„ç†æˆåŠŸ"

try:
    order = {"amount": -100}
    result = process_order(order)
    print(f"ç»“æœ: {result}")
except BusinessLogicError as e:
    error_info = e.to_dict()
    print(f"æ•è·åˆ°ä¸šåŠ¡é€»è¾‘é”™è¯¯: {error_info}")</code></pre><h3>6. å¼‚å¸¸å¤„ç†ä¸æ—¥å¿—è®°å½•</h3><p>å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•æ˜¯Pythonç¼–ç¨‹ä¸­çš„ä¸¤ä¸ªé‡è¦éƒ¨åˆ†ï¼Œå®ƒä»¬é€šå¸¸ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ç¡®ä¿ç¨‹åºçš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h4>6.1 æ—¥å¿—è®°å½•çš„åŸºæœ¬æ¦‚å¿µ</h4><p>æ—¥å¿—è®°å½•æ˜¯æŒ‡å°†ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¿¡æ¯è®°å½•åˆ°æ–‡ä»¶æˆ–å…¶ä»–è¾“å‡ºè®¾å¤‡ä¸­ã€‚Pythonçš„<code>logging</code>æ¨¡å—æä¾›äº†ä¸€ä¸ªçµæ´»çš„æ—¥å¿—è®°å½•ç³»ç»Ÿã€‚</p><h4>6.2 å¼‚å¸¸å¤„ç†ä¸æ—¥å¿—è®°å½•çš„ç»“åˆ</h4><p>åœ¨å¼‚å¸¸å¤„ç†ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦è®°å½•å¼‚å¸¸ä¿¡æ¯ï¼Œä»¥ä¾¿äºè°ƒè¯•å’Œé—®é¢˜æ’æŸ¥ã€‚ä»¥ä¸‹æ˜¯å¼‚å¸¸å¤„ç†ä¸æ—¥å¿—è®°å½•ç»“åˆçš„æœ€ä½³å®è·µï¼š</p><ul><li><strong>è®°å½•å¼‚å¸¸çš„è¯¦ç»†ä¿¡æ¯</strong>ï¼šä½¿ç”¨<code>logging.exception()</code>å‡½æ•°è®°å½•å¼‚å¸¸çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å †æ ˆè·Ÿè¸ª</li><li><p><strong>ä½¿ç”¨é€‚å½“çš„æ—¥å¿—çº§åˆ«</strong>ï¼šæ ¹æ®å¼‚å¸¸çš„ä¸¥é‡ç¨‹åº¦ï¼Œä½¿ç”¨é€‚å½“çš„æ—¥å¿—çº§åˆ«</p><ul><li><code>DEBUG</code>ï¼šè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯</li><li><code>INFO</code>ï¼šä¸€èˆ¬ä¿¡æ¯</li><li><code>WARNING</code>ï¼šè­¦å‘Šä¿¡æ¯</li><li><code>ERROR</code>ï¼šé”™è¯¯ä¿¡æ¯</li><li><code>CRITICAL</code>ï¼šä¸¥é‡é”™è¯¯ä¿¡æ¯</li></ul></li><li><strong>åŒ…å«ä¸Šä¸‹æ–‡ä¿¡æ¯</strong>ï¼šåœ¨æ—¥å¿—ä¸­åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»¥ä¾¿äºç†è§£å¼‚å¸¸çš„åŸå› </li><li><strong>åŒºåˆ†ç”¨æˆ·é”™è¯¯å’Œç³»ç»Ÿé”™è¯¯</strong>ï¼šåŒºåˆ†ç”¨æˆ·é”™è¯¯å’Œç³»ç»Ÿé”™è¯¯ï¼Œä½¿ç”¨ä¸åŒçš„å¤„ç†æ–¹å¼</li></ul><h4>6.3 æ—¥å¿—è®°å½•çš„é…ç½®</h4><p>Pythonçš„<code>logging</code>æ¨¡å—æä¾›äº†çµæ´»çš„é…ç½®é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦é…ç½®æ—¥å¿—è®°å½•çš„è¡Œä¸ºã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„é…ç½®é€‰é¡¹ï¼š</p><ul><li><strong>æ—¥å¿—çº§åˆ«</strong>ï¼šè®¾ç½®æ—¥å¿—çš„æœ€ä½çº§åˆ«</li><li><strong>è¾“å‡ºæ ¼å¼</strong>ï¼šè®¾ç½®æ—¥å¿—çš„è¾“å‡ºæ ¼å¼</li><li><strong>è¾“å‡ºç›®æ ‡</strong>ï¼šè®¾ç½®æ—¥å¿—çš„è¾“å‡ºç›®æ ‡ï¼ˆæ§åˆ¶å°ã€æ–‡ä»¶ç­‰ï¼‰</li><li><strong>æ—¥å¿—è½®è½¬</strong>ï¼šè®¾ç½®æ—¥å¿—æ–‡ä»¶çš„è½®è½¬ç­–ç•¥</li></ul><pre><code class="python"># å¼‚å¸¸å¤„ç†ä¸æ—¥å¿—è®°å½•ç¤ºä¾‹

import logging

# é…ç½®æ—¥å¿—
logging.basicConfig(
    level=logging.DEBUG,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    filename='app.log',
    filemode='a'
)

# åˆ›å»ºlogger
logger = logging.getLogger(__name__)

# 1. åŸºæœ¬çš„å¼‚å¸¸æ—¥å¿—è®°å½•
print("åŸºæœ¬çš„å¼‚å¸¸æ—¥å¿—è®°å½•ç¤ºä¾‹ï¼š")

def divide(a, b):
    try:
        return a / b
    except ZeroDivisionError as e:
        logger.error(f"é™¤ä»¥é›¶é”™è¯¯: a={a}, b={b}", exc_info=True)
        raise

try:
    result = divide(10, 0)
except ZeroDivisionError as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")

# 2. ä½¿ç”¨logging.exception()
print("\nä½¿ç”¨logging.exception()ç¤ºä¾‹ï¼š")

def read_config(filename):
    try:
        with open(filename, "r") as f:
            content = f.read()
        return content
    except Exception as e:
        logger.exception(f"è¯»å–é…ç½®æ–‡ä»¶å¤±è´¥: {filename}")
        raise

try:
    content = read_config("non_existent_config.json")
except Exception as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")

# 3. ä¸åŒçº§åˆ«çš„æ—¥å¿—
print("\nä¸åŒçº§åˆ«çš„æ—¥å¿—ç¤ºä¾‹ï¼š")

def process_data(data):
    if not data:
        logger.warning("æ•°æ®ä¸ºç©º")
        return []
    try:
        processed_data = [int(item) for item in data.split(',')]
        logger.info(f"æˆåŠŸå¤„ç†æ•°æ®: {data}")
        return processed_data
    except ValueError as e:
        logger.error(f"æ•°æ®å¤„ç†å¤±è´¥: {data}", exc_info=True)
        raise

try:
    result = process_data("")
    print(f"ç»“æœ: {result}")
except Exception as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")

try:
    result = process_data("1,2,3")
    print(f"ç»“æœ: {result}")
except Exception as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")

try:
    result = process_data("1,2,abc")
    print(f"ç»“æœ: {result}")
except Exception as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")

# 4. æ—¥å¿—é…ç½®ç¤ºä¾‹
print("\næ—¥å¿—é…ç½®ç¤ºä¾‹ï¼š")

# æ›´å¤æ‚çš„æ—¥å¿—é…ç½®
import logging.config

logging_config = {
    'version': 1,
    'disable_existing_loggers': False,
    'formatters': {
        'standard': {
            'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
        },
        'detailed': {
            'format': '%(asctime)s - %(name)s - %(levelname)s - %(module)s:%(lineno)d - %(message)s'
        }
    },
    'handlers': {
        'console': {
            'class': 'logging.StreamHandler',
            'level': 'INFO',
            'formatter': 'standard',
            'stream': 'ext://sys.stdout'
        },
        'file': {
            'class': 'logging.handlers.RotatingFileHandler',
            'level': 'DEBUG',
            'formatter': 'detailed',
            'filename': 'app.log',
            'maxBytes': 10485760,  # 10MB
            'backupCount': 5
        }
    },
    'loggers': {
        '': {
            'handlers': ['console', 'file'],
            'level': 'DEBUG',
            'propagate': True
        }
    }
}

logging.config.dictConfig(logging_config)

# æµ‹è¯•é…ç½®åçš„æ—¥å¿—
logger = logging.getLogger(__name__)
logger.debug("è¿™æ˜¯ä¸€æ¡è°ƒè¯•ä¿¡æ¯")
logger.info("è¿™æ˜¯ä¸€æ¡ä¸€èˆ¬ä¿¡æ¯")
logger.warning("è¿™æ˜¯ä¸€æ¡è­¦å‘Šä¿¡æ¯")
logger.error("è¿™æ˜¯ä¸€æ¡é”™è¯¯ä¿¡æ¯")
logger.critical("è¿™æ˜¯ä¸€æ¡ä¸¥é‡é”™è¯¯ä¿¡æ¯")

# 5. å¼‚å¸¸å¤„ç†ä¸æ—¥å¿—è®°å½•çš„æœ€ä½³å®è·µ
print("\nå¼‚å¸¸å¤„ç†ä¸æ—¥å¿—è®°å½•çš„æœ€ä½³å®è·µç¤ºä¾‹ï¼š")

def safe_operation(func):
    """å®‰å…¨æ“ä½œè£…é¥°å™¨"""
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            logger.exception(f"æ“ä½œå¤±è´¥: {func.__name__}")
            raise
    return wrapper

@safe_operation
def risky_operation():
    """ risky operation """
    10 / 0

try:
    risky_operation()
except Exception as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")

# 6. è‡ªå®šä¹‰å¼‚å¸¸ä¸æ—¥å¿—è®°å½•
print("\nè‡ªå®šä¹‰å¼‚å¸¸ä¸æ—¥å¿—è®°å½•ç¤ºä¾‹ï¼š")

class AppException(Exception):
    """åº”ç”¨ç¨‹åºå¼‚å¸¸"""
    def __init__(self, message, error_code, level=logging.ERROR):
        super().__init__(message)
        self.error_code = error_code
        self.level = level
    
    def log(self, logger):
        """è®°å½•å¼‚å¸¸"""
        if self.level == logging.ERROR:
            logger.exception(f"{self.__class__.__name__}: {self.args[0]} (é”™è¯¯ç : {self.error_code})")
        else:
            logger.log(self.level, f"{self.__class__.__name__}: {self.args[0]} (é”™è¯¯ç : {self.error_code})")

class ValidationError(AppException):
    """éªŒè¯é”™è¯¯"""
    def __init__(self, message, field):
        super().__init__(message, "VALIDATION_ERROR", logging.WARNING)
        self.field = field
    
    def log(self, logger):
        logger.warning(f"ValidationError: {self.args[0]} (å­—æ®µ: {self.field})")

def validate_user(user):
    if not user.get("name"):
        raise ValidationError("ç”¨æˆ·åä¸èƒ½ä¸ºç©º", "name")
    if not user.get("email"):
        raise ValidationError("é‚®ç®±ä¸èƒ½ä¸ºç©º", "email")
    if "@" not in user.get("email", ""):
        raise ValidationError("é‚®ç®±æ ¼å¼æ— æ•ˆ", "email")
    return True

try:
    user = {"name": "John"}
    validate_user(user)
    print("ç”¨æˆ·éªŒè¯æˆåŠŸ")
except AppException as e:
    e.log(logger)
    print(f"æ•è·åˆ°åº”ç”¨ç¨‹åºå¼‚å¸¸: {e}")</code></pre><h3>7. å¼‚å¸¸å¤„ç†ä¸æµ‹è¯•</h3><p>å¼‚å¸¸å¤„ç†æ˜¯Pythonæµ‹è¯•ä¸­çš„é‡è¦éƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å¼‚å¸¸å¤„ç†ä»£ç èƒ½å¤Ÿæ­£ç¡®åœ°æ•è·å’Œå¤„ç†å¼‚å¸¸ã€‚</p><h4>7.1 æµ‹è¯•å¼‚å¸¸çš„åŸºæœ¬æ–¹æ³•</h4><p>åœ¨Pythonæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨<code>unittest</code>æ¨¡å—æˆ–<code>pytest</code>æ¡†æ¶æ¥æµ‹è¯•å¼‚å¸¸ã€‚ä»¥ä¸‹æ˜¯æµ‹è¯•å¼‚å¸¸çš„åŸºæœ¬æ–¹æ³•ï¼š</p><ul><li><strong>ä½¿ç”¨<code>assertRaises</code></strong>ï¼šæµ‹è¯•ä»£ç æ˜¯å¦ä¼šå¼•å‘ç‰¹å®šç±»å‹çš„å¼‚å¸¸</li><li><strong>ä½¿ç”¨<code>assertRaisesRegex</code></strong>ï¼šæµ‹è¯•ä»£ç æ˜¯å¦ä¼šå¼•å‘ç‰¹å®šç±»å‹çš„å¼‚å¸¸ï¼Œå¹¶ä¸”å¼‚å¸¸ä¿¡æ¯åŒ¹é…ç‰¹å®šçš„æ­£åˆ™è¡¨è¾¾å¼</li><li><strong>ä½¿ç”¨<code>pytest.raises</code></strong>ï¼šåœ¨pytestä¸­æµ‹è¯•ä»£ç æ˜¯å¦ä¼šå¼•å‘ç‰¹å®šç±»å‹çš„å¼‚å¸¸</li></ul><h4>7.2 æµ‹è¯•å¼‚å¸¸çš„æœ€ä½³å®è·µ</h4><p>æµ‹è¯•å¼‚å¸¸æ—¶ï¼Œåº”éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š</p><ul><li><strong>æµ‹è¯•æ‰€æœ‰å¯èƒ½çš„å¼‚å¸¸æƒ…å†µ</strong>ï¼šæµ‹è¯•ä»£ç ä¸­æ‰€æœ‰å¯èƒ½å¼•å‘å¼‚å¸¸çš„æƒ…å†µ</li><li><strong>æµ‹è¯•å¼‚å¸¸çš„ç±»å‹</strong>ï¼šç¡®ä¿ä»£ç å¼•å‘çš„æ˜¯æ­£ç¡®ç±»å‹çš„å¼‚å¸¸</li><li><strong>æµ‹è¯•å¼‚å¸¸çš„ä¿¡æ¯</strong>ï¼šç¡®ä¿å¼‚å¸¸ä¿¡æ¯æ¸…æ™°æ˜ç¡®</li><li><strong>æµ‹è¯•å¼‚å¸¸çš„å¤„ç†</strong>ï¼šç¡®ä¿å¼‚å¸¸å¤„ç†ä»£ç èƒ½å¤Ÿæ­£ç¡®åœ°å¤„ç†å¼‚å¸¸</li><li><strong>æµ‹è¯•è¾¹ç•Œæƒ…å†µ</strong>ï¼šæµ‹è¯•è¾¹ç•Œæƒ…å†µï¼Œç¡®ä¿ä»£ç èƒ½å¤Ÿæ­£ç¡®åœ°å¤„ç†è¾¹ç•Œæƒ…å†µ</li></ul><h4>7.3 å¼‚å¸¸å¤„ç†çš„æµ‹è¯•ç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨<code>unittest</code>æ¨¡å—å’Œ<code>pytest</code>æ¡†æ¶æµ‹è¯•å¼‚å¸¸çš„ç¤ºä¾‹ï¼š</p><pre><code class="python"># å¼‚å¸¸å¤„ç†ä¸æµ‹è¯•ç¤ºä¾‹

# 1. ä½¿ç”¨unittestæ¨¡å—æµ‹è¯•å¼‚å¸¸
print("ä½¿ç”¨unittestæ¨¡å—æµ‹è¯•å¼‚å¸¸ç¤ºä¾‹ï¼š")

import unittest

class Calculator:
    def divide(self, a, b):
        if b == 0:
            raise ZeroDivisionError("é™¤æ•°ä¸èƒ½ä¸ºé›¶")
        return a / b

class TestCalculator(unittest.TestCase):
    def setUp(self):
        self.calculator = Calculator()
    
    def test_divide_normal(self):
        """æµ‹è¯•æ­£å¸¸é™¤æ³•"""
        result = self.calculator.divide(10, 2)
        self.assertEqual(result, 5)
    
    def test_divide_zero(self):
        """æµ‹è¯•é™¤ä»¥é›¶"""
        with self.assertRaises(ZeroDivisionError) as cm:
            self.calculator.divide(10, 0)
        self.assertIn("é™¤æ•°ä¸èƒ½ä¸ºé›¶", str(cm.exception))

# è¿è¡Œæµ‹è¯•
if __name__ == '__main__':
    unittest.main(argv=['first-arg-is-ignored'], exit=False)

# 2. ä½¿ç”¨pytestæµ‹è¯•å¼‚å¸¸
print("\nä½¿ç”¨pytestæµ‹è¯•å¼‚å¸¸ç¤ºä¾‹ï¼š")

# ä»¥ä¸‹ä»£ç éœ€è¦åœ¨pytestç¯å¢ƒä¸­è¿è¡Œ
'''
def test_divide_normal():
    calculator = Calculator()
    result = calculator.divide(10, 2)
    assert result == 5

def test_divide_zero():
    calculator = Calculator()
    with pytest.raises(ZeroDivisionError, match="é™¤æ•°ä¸èƒ½ä¸ºé›¶"):
        calculator.divide(10, 0)
'''

# 3. æµ‹è¯•è‡ªå®šä¹‰å¼‚å¸¸
print("\næµ‹è¯•è‡ªå®šä¹‰å¼‚å¸¸ç¤ºä¾‹ï¼š")

class ValidationError(Exception):
    """éªŒè¯é”™è¯¯"""
    pass

def validate_email(email):
    if '@' not in email:
        raise ValidationError(f"æ— æ•ˆçš„é‚®ç®±åœ°å€: {email}")
    return email

class TestValidation(unittest.TestCase):
    def test_validate_email_valid(self):
        """æµ‹è¯•æœ‰æ•ˆçš„é‚®ç®±åœ°å€"""
        result = validate_email("test@example.com")
        self.assertEqual(result, "test@example.com")
    
    def test_validate_email_invalid(self):
        """æµ‹è¯•æ— æ•ˆçš„é‚®ç®±åœ°å€"""
        with self.assertRaises(ValidationError) as cm:
            validate_email("invalid-email")
        self.assertIn("æ— æ•ˆçš„é‚®ç®±åœ°å€", str(cm.exception))

# è¿è¡Œæµ‹è¯•
if __name__ == '__main__':
    unittest.main(argv=['first-arg-is-ignored'], exit=False)

# 4. æµ‹è¯•å¼‚å¸¸å¤„ç†ä»£ç 
print("\næµ‹è¯•å¼‚å¸¸å¤„ç†ä»£ç ç¤ºä¾‹ï¼š")

def safe_divide(a, b):
    try:
        return a / b
    except ZeroDivisionError:
        return float('inf')
    except TypeError:
        return None

class TestSafeDivide(unittest.TestCase):
    def test_safe_divide_normal(self):
        """æµ‹è¯•æ­£å¸¸é™¤æ³•"""
        result = safe_divide(10, 2)
        self.assertEqual(result, 5)
    
    def test_safe_divide_zero(self):
        """æµ‹è¯•é™¤ä»¥é›¶"""
        result = safe_divide(10, 0)
        self.assertEqual(result, float('inf'))
    
    def test_safe_divide_type_error(self):
        """æµ‹è¯•ç±»å‹é”™è¯¯"""
        result = safe_divide(10, "2")
        self.assertIsNone(result)

# è¿è¡Œæµ‹è¯•
if __name__ == '__main__':
    unittest.main(argv=['first-arg-is-ignored'], exit=False)

# 5. æµ‹è¯•å¼‚å¸¸çš„è¾¹ç•Œæƒ…å†µ
print("\næµ‹è¯•å¼‚å¸¸çš„è¾¹ç•Œæƒ…å†µç¤ºä¾‹ï¼š")

def process_list(items):
    if not isinstance(items, list):
        raise TypeError("å‚æ•°å¿…é¡»æ˜¯åˆ—è¡¨")
    if not items:
        raise ValueError("åˆ—è¡¨ä¸èƒ½ä¸ºç©º")
    return sum(items)

class TestProcessList(unittest.TestCase):
    def test_process_list_normal(self):
        """æµ‹è¯•æ­£å¸¸æƒ…å†µ"""
        result = process_list([1, 2, 3])
        self.assertEqual(result, 6)
    
    def test_process_list_not_list(self):
        """æµ‹è¯•å‚æ•°ä¸æ˜¯åˆ—è¡¨"""
        with self.assertRaises(TypeError) as cm:
            process_list("not a list")
        self.assertIn("å‚æ•°å¿…é¡»æ˜¯åˆ—è¡¨", str(cm.exception))
    
    def test_process_list_empty(self):
        """æµ‹è¯•ç©ºåˆ—è¡¨"""
        with self.assertRaises(ValueError) as cm:
            process_list([])
        self.assertIn("åˆ—è¡¨ä¸èƒ½ä¸ºç©º", str(cm.exception))

# è¿è¡Œæµ‹è¯•
if __name__ == '__main__':
    unittest.main(argv=['first-arg-is-ignored'], exit=False)

# 6. ä½¿ç”¨mockæµ‹è¯•å¼‚å¸¸
print("\nä½¿ç”¨mockæµ‹è¯•å¼‚å¸¸ç¤ºä¾‹ï¼š")

from unittest.mock import Mock, patch

def get_data_from_api(url):
    import requests
    try:
        response = requests.get(url)
        response.raise_for_status()
        return response.json()
    except requests.exceptions.RequestException as e:
        raise RuntimeError(f"APIè°ƒç”¨å¤±è´¥: {e}")

class TestGetDataFromApi(unittest.TestCase):
    @patch('requests.get')
    def test_get_data_success(self, mock_get):
        """æµ‹è¯•APIè°ƒç”¨æˆåŠŸ"""
        mock_response = Mock()
        mock_response.json.return_value = {"data": "test"}
        mock_response.raise_for_status.return_value = None
        mock_get.return_value = mock_response
        
        result = get_data_from_api("https://example.com/api")
        self.assertEqual(result, {"data": "test"})
    
    @patch('requests.get')
    def test_get_data_failure(self, mock_get):
        """æµ‹è¯•APIè°ƒç”¨å¤±è´¥"""
        mock_response = Mock()
        mock_response.raise_for_status.side_effect = Exception("APIé”™è¯¯")
        mock_get.return_value = mock_response
        
        with self.assertRaises(RuntimeError) as cm:
            get_data_from_api("https://example.com/api")
        self.assertIn("APIè°ƒç”¨å¤±è´¥", str(cm.exception))

# è¿è¡Œæµ‹è¯•
if __name__ == '__main__':
    unittest.main(argv=['first-arg-is-ignored'], exit=False)</code></pre><h3>7. å¼‚å¸¸å¤„ç†çš„é«˜çº§æŠ€å·§</h3><h4>7.1 ä½¿ç”¨è£…é¥°å™¨å¤„ç†å¼‚å¸¸</h4><p>è£…é¥°å™¨æ˜¯Pythonä¸­çš„ä¸€ç§é«˜çº§ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è£…é¥°å™¨æ¥ç»Ÿä¸€å¤„ç†å‡½æ•°æˆ–æ–¹æ³•ä¸­çš„å¼‚å¸¸ã€‚</p><h4>7.2 ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¤„ç†å¼‚å¸¸</h4><p>ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ˜¯Pythonä¸­çš„ä¸€ç§é«˜çº§ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ¥ç®¡ç†èµ„æºå’Œå¤„ç†å¼‚å¸¸ã€‚</p><h4>7.3 ä½¿ç”¨<code>contextlib.suppress</code></h4><p><code>contextlib.suppress</code>æ˜¯Python 3.4+ä¸­å¼•å…¥çš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒå¯ä»¥ç”¨äºå¿½ç•¥ç‰¹å®šç±»å‹çš„å¼‚å¸¸ã€‚</p><h4>7.4 ä½¿ç”¨<code>traceback</code>æ¨¡å—</h4><p><code>traceback</code>æ¨¡å—æä¾›äº†ä¸€äº›å‡½æ•°ï¼Œç”¨äºå¤„ç†å’Œæ ¼å¼åŒ–å¼‚å¸¸çš„å †æ ˆè·Ÿè¸ªä¿¡æ¯ã€‚</p><h4>7.5 å¼‚å¸¸å¤„ç†çš„æ€§èƒ½ä¼˜åŒ–</h4><p>å¼‚å¸¸å¤„ç†ä¼šå¯¹ç¨‹åºçš„æ€§èƒ½äº§ç”Ÿä¸€å®šçš„å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ¥ä¼˜åŒ–å¼‚å¸¸å¤„ç†çš„æ€§èƒ½ï¼š</p><ul><li><strong>é¿å…åœ¨çƒ­ç‚¹è·¯å¾„ä¸­ä½¿ç”¨å¼‚å¸¸</strong>ï¼šé¿å…åœ¨é¢‘ç¹æ‰§è¡Œçš„ä»£ç ä¸­ä½¿ç”¨å¼‚å¸¸</li><li><strong>ä½¿ç”¨å±€éƒ¨å˜é‡</strong>ï¼šåœ¨å¼‚å¸¸å¤„ç†ä»£ç ä¸­ä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œè€Œä¸æ˜¯å…¨å±€å˜é‡</li><li><strong>ä¿æŒå¼‚å¸¸å¤„ç†çš„ç®€æ´</strong>ï¼šå¼‚å¸¸å¤„ç†ä»£ç åº”è¯¥ä¿æŒç®€æ´ï¼ŒåªåŒ…å«å¿…è¦çš„ä»£ç </li><li><strong>ä½¿ç”¨EAFPæ¨¡å¼</strong>ï¼šåœ¨é€‚å½“çš„æƒ…å†µä¸‹ä½¿ç”¨EAFPæ¨¡å¼ï¼Œè€Œä¸æ˜¯LBYLæ¨¡å¼</li></ul><pre><code class="python"># å¼‚å¸¸å¤„ç†çš„é«˜çº§æŠ€å·§ç¤ºä¾‹

# 1. ä½¿ç”¨è£…é¥°å™¨å¤„ç†å¼‚å¸¸
print("ä½¿ç”¨è£…é¥°å™¨å¤„ç†å¼‚å¸¸ç¤ºä¾‹ï¼š")

import functools

def handle_exceptions(default=None, log=True):
    """å¼‚å¸¸å¤„ç†è£…é¥°å™¨"""
    def decorator(func):
        @functools.wraps(func)
        def wrapper(*args, **kwargs):
            try:
                return func(*args, **kwargs)
            except Exception as e:
                if log:
                    print(f"å‡½æ•° {func.__name__} å‘ç”Ÿå¼‚å¸¸: {e}")
                return default
        return wrapper
    return decorator

@handle_exceptions(default="é”™è¯¯", log=True)
def risky_operation():
    """ risky operation """
    10 / 0

result = risky_operation()
print(f"ç»“æœ: {result}")

@handle_exceptions(default=[], log=False)
def parse_json(json_str):
    """è§£æJSONå­—ç¬¦ä¸²"""
    import json
    return json.loads(json_str)

result = parse_json("invalid json")
print(f"è§£æç»“æœ: {result}")

# 2. ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¤„ç†å¼‚å¸¸
print("\nä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¤„ç†å¼‚å¸¸ç¤ºä¾‹ï¼š")

class ExceptionHandler:
    """å¼‚å¸¸å¤„ç†ä¸Šä¸‹æ–‡ç®¡ç†å™¨"""
    def __init__(self, default=None, *exceptions):
        self.default = default
        self.exceptions = exceptions or (Exception,)
    
    def __enter__(self):
        return self
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        if exc_type is not None and issubclass(exc_type, self.exceptions):
            print(f"æ•è·åˆ°å¼‚å¸¸: {exc_val}")
            return True  # æŠ‘åˆ¶å¼‚å¸¸
        return False  # ä¸æŠ‘åˆ¶å¼‚å¸¸

with ExceptionHandler(default="é”™è¯¯", ZeroDivisionError, ValueError) as handler:
    result = 10 / 0
    print(f"ç»“æœ: {result}")

print("ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ‰§è¡Œå®Œæ¯•")

# 3. ä½¿ç”¨contextlib.suppress
print("\nä½¿ç”¨contextlib.suppressç¤ºä¾‹ï¼š")

from contextlib import suppress

# å¿½ç•¥ç‰¹å®šå¼‚å¸¸
with suppress(ZeroDivisionError):
    result = 10 / 0
    print(f"ç»“æœ: {result}")
print("æ“ä½œå®Œæˆ")

# å¿½ç•¥å¤šä¸ªå¼‚å¸¸
with suppress(ZeroDivisionError, ValueError):
    result = int("abc")
    print(f"ç»“æœ: {result}")
print("æ“ä½œå®Œæˆ")

# 4. ä½¿ç”¨tracebackæ¨¡å—
print("\nä½¿ç”¨tracebackæ¨¡å—ç¤ºä¾‹ï¼š")

import traceback

def nested_function():
    """åµŒå¥—å‡½æ•°"""
    10 / 0

def outer_function():
    """å¤–éƒ¨å‡½æ•°"""
    nested_function()

try:
    outer_function()
except Exception as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")
    print("\nå †æ ˆè·Ÿè¸ª:")
    traceback.print_exc()
    
    # è·å–å †æ ˆè·Ÿè¸ªä¿¡æ¯ä½œä¸ºå­—ç¬¦ä¸²
    traceback_str = traceback.format_exc()
    print("\nå †æ ˆè·Ÿè¸ªå­—ç¬¦ä¸²:")
    print(traceback_str)

# 5. å¼‚å¸¸å¤„ç†çš„æ€§èƒ½ä¼˜åŒ–
print("\nå¼‚å¸¸å¤„ç†çš„æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹ï¼š")

import time

# æµ‹è¯•EAFPæ¨¡å¼çš„æ€§èƒ½
def eafp_approach(dictionary, key):
    """ä½¿ç”¨EAFPæ¨¡å¼"""
    try:
        return dictionary[key]
    except KeyError:
        return "é»˜è®¤å€¼"

# æµ‹è¯•LBYLæ¨¡å¼çš„æ€§èƒ½
def lbyl_approach(dictionary, key):
    """ä½¿ç”¨LBYLæ¨¡å¼"""
    if key in dictionary:
        return dictionary[key]
    else:
        return "é»˜è®¤å€¼"

# æµ‹è¯•æ€§èƒ½
dictionary = {f"key{i}": i for i in range(1000)}

# æµ‹è¯•é”®å­˜åœ¨çš„æƒ…å†µ
print("æµ‹è¯•é”®å­˜åœ¨çš„æƒ…å†µï¼š")
start = time.time()
for i in range(1000000):
    eafp_approach(dictionary, "key500")
end = time.time()
print(f"EAFPæ¨¡å¼è€—æ—¶: {end - start:.4f}ç§’")

start = time.time()
for i in range(1000000):
    lbyl_approach(dictionary, "key500")
end = time.time()
print(f"LBYLæ¨¡å¼è€—æ—¶: {end - start:.4f}ç§’")

# æµ‹è¯•é”®ä¸å­˜åœ¨çš„æƒ…å†µ
print("\næµ‹è¯•é”®ä¸å­˜åœ¨çš„æƒ…å†µï¼š")
start = time.time()
for i in range(100000):
    eafp_approach(dictionary, "key1000")
end = time.time()
print(f"EAFPæ¨¡å¼è€—æ—¶: {end - start:.4f}ç§’")

start = time.time()
for i in range(100000):
    lbyl_approach(dictionary, "key1000")
end = time.time()
print(f"LBYLæ¨¡å¼è€—æ—¶: {end - start:.4f}ç§’")

# 6. ä½¿ç”¨functools.wrapsä¿ç•™å‡½æ•°å…ƒæ•°æ®
print("\nä½¿ç”¨functools.wrapsä¿ç•™å‡½æ•°å…ƒæ•°æ®ç¤ºä¾‹ï¼š")

def error_handler(func):
    """é”™è¯¯å¤„ç†è£…é¥°å™¨"""
    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            print(f"é”™è¯¯: {e}")
            raise
    return wrapper

@error_handler
def calculate(a, b):
    """è®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œ"""
    return a + b

print(f"å‡½æ•°å: {calculate.__name__}")
print(f"å‡½æ•°æ–‡æ¡£: {calculate.__doc__}")
print(f"å‡½æ•°å‚æ•°: {calculate.__code__.co_varnames}")

try:
    result = calculate(10, "20")
    print(f"ç»“æœ: {result}")
except Exception as e:
    print(f"æ•è·åˆ°å¼‚å¸¸: {e}")</code></pre><h3>8. å¸¸è§å¼‚å¸¸å¤„ç†åœºæ™¯</h3><h4>8.1 æ–‡ä»¶æ“ä½œ</h4><p>æ–‡ä»¶æ“ä½œæ˜¯Pythonç¼–ç¨‹ä¸­å¸¸è§çš„å¼‚å¸¸å¤„ç†åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†æ–‡ä»¶ä¸å­˜åœ¨ã€æƒé™é”™è¯¯ç­‰å¼‚å¸¸ã€‚</p><h4>8.2 ç½‘ç»œæ“ä½œ</h4><p>ç½‘ç»œæ“ä½œæ˜¯å¦ä¸€ä¸ªå¸¸è§çš„å¼‚å¸¸å¤„ç†åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†è¿æ¥é”™è¯¯ã€è¶…æ—¶é”™è¯¯ç­‰å¼‚å¸¸ã€‚</p><h4>8.3 æ•°æ®åº“æ“ä½œ</h4><p>æ•°æ®åº“æ“ä½œæ˜¯Pythonç¼–ç¨‹ä¸­å¸¸è§çš„å¼‚å¸¸å¤„ç†åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†è¿æ¥é”™è¯¯ã€æŸ¥è¯¢é”™è¯¯ç­‰å¼‚å¸¸ã€‚</p><h4>8.4 APIè°ƒç”¨</h4><p>APIè°ƒç”¨æ˜¯Pythonç¼–ç¨‹ä¸­å¸¸è§çš„å¼‚å¸¸å¤„ç†åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†ç½‘ç»œé”™è¯¯ã€APIé”™è¯¯ç­‰å¼‚å¸¸ã€‚</p><h4>8.5 è¾“å…¥éªŒè¯</h4><p>è¾“å…¥éªŒè¯æ˜¯Pythonç¼–ç¨‹ä¸­å¸¸è§çš„å¼‚å¸¸å¤„ç†åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†æ— æ•ˆè¾“å…¥ã€ç±»å‹é”™è¯¯ç­‰å¼‚å¸¸ã€‚</p><pre><code class="python"># å¸¸è§å¼‚å¸¸å¤„ç†åœºæ™¯ç¤ºä¾‹

# 1. æ–‡ä»¶æ“ä½œ
print("æ–‡ä»¶æ“ä½œç¤ºä¾‹ï¼š")

def read_file_safely(filename):
    """å®‰å…¨åœ°è¯»å–æ–‡ä»¶"""
    try:
        with open(filename, "r", encoding="utf-8") as f:
            content = f.read()
        return content
    except FileNotFoundError:
        print(f"é”™è¯¯ï¼šæ–‡ä»¶ {filename} ä¸å­˜åœ¨")
        return ""
    except PermissionError:
        print(f"é”™è¯¯ï¼šæ²¡æœ‰è¯»å–æ–‡ä»¶ {filename} çš„æƒé™")
        return ""
    except UnicodeDecodeError:
        print(f"é”™è¯¯ï¼šæ–‡ä»¶ {filename} ç¼–ç é”™è¯¯")
        return ""
    except Exception as e:
        print(f"é”™è¯¯ï¼šè¯»å–æ–‡ä»¶æ—¶å‘ç”ŸæœªçŸ¥é”™è¯¯: {e}")
        return ""

content = read_file_safely("non_existent_file.txt")
print(f"æ–‡ä»¶å†…å®¹é•¿åº¦: {len(content)}")

# 2. ç½‘ç»œæ“ä½œ
print("\nç½‘ç»œæ“ä½œç¤ºä¾‹ï¼š")

def fetch_url(url, timeout=10):
    """è·å–URLå†…å®¹"""
    import requests
    try:
        response = requests.get(url, timeout=timeout)
        response.raise_for_status()  # å¼•å‘HTTPé”™è¯¯
        return response.text
    except requests.exceptions.ConnectionError:
        print(f"é”™è¯¯ï¼šæ— æ³•è¿æ¥åˆ° {url}")
        return ""
    except requests.exceptions.Timeout:
        print(f"é”™è¯¯ï¼šè¯·æ±‚ {url} è¶…æ—¶")
        return ""
    except requests.exceptions.HTTPError as e:
        print(f"é”™è¯¯ï¼šHTTPé”™è¯¯: {e}")
        return ""
    except Exception as e:
        print(f"é”™è¯¯ï¼šå‘ç”ŸæœªçŸ¥é”™è¯¯: {e}")
        return ""

# æµ‹è¯•ç½‘ç»œæ“ä½œ
# content = fetch_url("https://example.com")
# print(f"URLå†…å®¹é•¿åº¦: {len(content)}")

# 3. æ•°æ®åº“æ“ä½œ
print("\næ•°æ®åº“æ“ä½œç¤ºä¾‹ï¼š")

def query_database(query, params=None):
    """æŸ¥è¯¢æ•°æ®åº“"""
    import sqlite3
    try:
        conn = sqlite3.connect(":memory:")
        cursor = conn.cursor()
        cursor.execute(query, params or ())
        results = cursor.fetchall()
        conn.commit()
        return results
    except sqlite3.Error as e:
        print(f"æ•°æ®åº“é”™è¯¯: {e}")
        return []
    finally:
        if 'conn' in locals():
            conn.close()

# æµ‹è¯•æ•°æ®åº“æ“ä½œ
results = query_database("CREATE TABLE users (id INTEGER PRIMARY KEY, name TEXT)")
print(f"åˆ›å»ºè¡¨ç»“æœ: {results}")

results = query_database("INSERT INTO users (name) VALUES (?)", ("John",))
print(f"æ’å…¥ç»“æœ: {results}")

results = query_database("SELECT * FROM users")
print(f"æŸ¥è¯¢ç»“æœ: {results}")

# 4. APIè°ƒç”¨
print("\nAPIè°ƒç”¨ç¤ºä¾‹ï¼š")

class APIError(Exception):
    """APIé”™è¯¯"""
    pass

def call_api(endpoint, method="GET", data=None):
    """è°ƒç”¨API"""
    import requests
    base_url = "https://api.example.com"
    url = f"{base_url}{endpoint}"
    
    try:
        if method == "GET":
            response = requests.get(url, params=data)
        elif method == "POST":
            response = requests.post(url, json=data)
        else:
            raise APIError(f"ä¸æ”¯æŒçš„HTTPæ–¹æ³•: {method}")
        
        response.raise_for_status()
        return response.json()
    except requests.exceptions.RequestException as e:
        raise APIError(f"ç½‘ç»œé”™è¯¯: {e}")
    except ValueError:
        raise APIError("APIè¿”å›çš„ä¸æ˜¯æœ‰æ•ˆçš„JSON")
    except Exception as e:
        raise APIError(f"æœªçŸ¥é”™è¯¯: {e}")

# æµ‹è¯•APIè°ƒç”¨
# try:
#     result = call_api("/users", method="GET", data={"page": 1})
#     print(f"APIè°ƒç”¨ç»“æœ: {result}")
# except APIError as e:
#     print(f"æ•è·åˆ°APIé”™è¯¯: {e}")

# 5. è¾“å…¥éªŒè¯
print("\nè¾“å…¥éªŒè¯ç¤ºä¾‹ï¼š")

class ValidationError(Exception):
    """éªŒè¯é”™è¯¯"""
    pass

def validate_input(data):
    """éªŒè¯è¾“å…¥æ•°æ®"""
    if not isinstance(data, dict):
        raise ValidationError("è¾“å…¥å¿…é¡»æ˜¯å­—å…¸")
    
    required_fields = ["name", "email", "age"]
    for field in required_fields:
        if field not in data:
            raise ValidationError(f"ç¼ºå°‘å¿…å¡«å­—æ®µ: {field}")
    
    if not isinstance(data["name"], str) or not data["name"]:
        raise ValidationError("å§“åå¿…é¡»æ˜¯éç©ºå­—ç¬¦ä¸²")
    
    if not isinstance(data["email"], str) or "@" not in data["email"]:
        raise ValidationError("é‚®ç®±æ ¼å¼æ— æ•ˆ")
    
    if not isinstance(data["age"], int) or data["age"] &lt; 0:
        raise ValidationError("å¹´é¾„å¿…é¡»æ˜¯éè´Ÿæ•´æ•°")
    
    return True

try:
    user_data = {
        "name": "John",
        "email": "john@example.com",
        "age": 30
    }
    validate_input(user_data)
    print("è¾“å…¥éªŒè¯æˆåŠŸ")
except ValidationError as e:
    print(f"éªŒè¯é”™è¯¯: {e}")

try:
    user_data = {
        "name": "",
        "email": "invalid-email",
        "age": -5
    }
    validate_input(user_data)
    print("è¾“å…¥éªŒè¯æˆåŠŸ")
except ValidationError as e:
    print(f"éªŒè¯é”™è¯¯: {e}")</code></pre><h3>9. æ€»ç»“</h3><p>æœ¬æ–‡è¯¦ç»†åˆ†æäº†Pythonä¸­çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸æœ€ä½³å®è·µï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><strong>å¼‚å¸¸çš„åŸºæœ¬æ¦‚å¿µ</strong>ï¼šå¼‚å¸¸çš„å®šä¹‰ã€å¼‚å¸¸ä¸é”™è¯¯çš„åŒºåˆ«ã€å¼‚å¸¸çš„å±‚æ¬¡ç»“æ„ã€å¸¸è§çš„å†…ç½®å¼‚å¸¸</li><li><strong>å¼‚å¸¸å¤„ç†æœºåˆ¶</strong>ï¼šå¼‚å¸¸å¤„ç†çš„åŸºæœ¬è¯­æ³•ã€try-exceptè¯­å¥ã€å¼‚å¸¸çš„ä¼ é€’</li><li><strong>å¼‚å¸¸çš„å¼•å‘ä¸ä¼ æ’­</strong>ï¼šraiseè¯­å¥ã€é‡æ–°å¼•å‘å¼‚å¸¸ã€å¼‚å¸¸çš„ä¼ æ’­ã€å¼‚å¸¸é“¾</li><li><strong>è‡ªå®šä¹‰å¼‚å¸¸</strong>ï¼šåˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸ç±»ã€è‡ªå®šä¹‰å¼‚å¸¸çš„æœ€ä½³å®è·µã€è‡ªå®šä¹‰å¼‚å¸¸çš„åº”ç”¨åœºæ™¯</li><li><strong>å¼‚å¸¸å¤„ç†çš„æœ€ä½³å®è·µ</strong>ï¼šå¼‚å¸¸å¤„ç†çš„åŸåˆ™ã€å¸¸è§é”™è¯¯ã€EAFPæ¨¡å¼vs LBYLæ¨¡å¼ã€æ€§èƒ½è€ƒè™‘</li><li><strong>å¼‚å¸¸å¤„ç†ä¸æ—¥å¿—è®°å½•</strong>ï¼šæ—¥å¿—è®°å½•çš„åŸºæœ¬æ¦‚å¿µã€å¼‚å¸¸å¤„ç†ä¸æ—¥å¿—è®°å½•çš„ç»“åˆã€æ—¥å¿—è®°å½•çš„é…ç½®</li><li><strong>å¼‚å¸¸å¤„ç†ä¸æµ‹è¯•</strong>ï¼šæµ‹è¯•å¼‚å¸¸çš„åŸºæœ¬æ–¹æ³•ã€æµ‹è¯•å¼‚å¸¸çš„æœ€ä½³å®è·µã€å¼‚å¸¸å¤„ç†çš„æµ‹è¯•ç¤ºä¾‹</li><li><strong>å¼‚å¸¸å¤„ç†çš„é«˜çº§æŠ€å·§</strong>ï¼šä½¿ç”¨è£…é¥°å™¨å¤„ç†å¼‚å¸¸ã€ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¤„ç†å¼‚å¸¸ã€ä½¿ç”¨contextlib.suppressã€ä½¿ç”¨tracebackæ¨¡å—ã€å¼‚å¸¸å¤„ç†çš„æ€§èƒ½ä¼˜åŒ–</li><li><strong>å¸¸è§å¼‚å¸¸å¤„ç†åœºæ™¯</strong>ï¼šæ–‡ä»¶æ“ä½œã€ç½‘ç»œæ“ä½œã€æ•°æ®åº“æ“ä½œã€APIè°ƒç”¨ã€è¾“å…¥éªŒè¯</li></ul><p>Pythonçš„å¼‚å¸¸å¤„ç†æœºåˆ¶æ˜¯ä¸€ç§å¼ºå¤§çš„é”™è¯¯å¤„ç†å·¥å…·ï¼Œå®ƒå…è®¸æˆ‘ä»¬æ•è·å’Œå¤„ç†ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„å¼‚å¸¸ï¼Œä»è€Œä½¿ç¨‹åºæ›´åŠ å¥å£®å’Œå¯é ã€‚é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿï¼š</p><ol><li>ç†è§£Pythonå¼‚å¸¸çš„åŸºæœ¬æ¦‚å¿µå’Œå±‚æ¬¡ç»“æ„</li><li>æŒæ¡Pythonå¼‚å¸¸å¤„ç†çš„åŸºæœ¬è¯­æ³•å’Œæœºåˆ¶</li><li>å­¦ä¼šåˆ›å»ºå’Œä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸</li><li>éµå¾ªPythonå¼‚å¸¸å¤„ç†çš„æœ€ä½³å®è·µ</li><li>ç»“åˆæ—¥å¿—è®°å½•å’Œæµ‹è¯•ï¼Œæé«˜ç¨‹åºçš„å¯ç»´æŠ¤æ€§</li><li>åº”ç”¨å¼‚å¸¸å¤„ç†æŠ€å·§è§£å†³å®é™…é—®é¢˜</li></ol><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥æ ¹æ®å…·ä½“æƒ…å†µé€‰æ‹©åˆé€‚çš„å¼‚å¸¸å¤„ç†ç­–ç•¥ï¼Œéµå¾ªPythonçš„æœ€ä½³å®è·µï¼Œä»¥æé«˜ä»£ç çš„è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ä¿æŒå­¦ä¹ çš„æ€åº¦ï¼Œå…³æ³¨Pythonçš„æœ€æ–°å‘å±•ï¼Œä»¥å……åˆ†åˆ©ç”¨Pythonçš„å¼ºå¤§åŠŸèƒ½ã€‚</p><h3>10. å‚è€ƒæ–‡çŒ®</h3><ol><li>Python Documentation: Errors and Exceptions</li><li>Python Documentation: Built-in Exceptions</li><li>Python Documentation: logging - Logging facility for Python</li><li>Python Documentation: contextlib - Utilities for with-statement contexts</li><li>Python Documentation: traceback - Print or retrieve a stack traceback</li><li>PEP 8 -- Style Guide for Python Code</li><li>PEP 3134 -- Exception Chaining and Embedded Tracebacks</li><li>Real Python: Python Exceptions: An Introduction</li><li>Real Python: Logging in Python</li><li>Real Python: Testing Your Code With pytest</li></ol><h3>11. ç»“è¯­</h3><p>Pythonçš„å¼‚å¸¸å¤„ç†æœºåˆ¶æ˜¯Pythonè¯­è¨€çš„é‡è¦ç‰¹æ€§ä¹‹ä¸€ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ä¼˜é›…è€Œå¼ºå¤§çš„é”™è¯¯å¤„ç†æ–¹å¼ã€‚é€šè¿‡åˆç†ä½¿ç”¨å¼‚å¸¸å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™æ›´åŠ å¥å£®ã€å¯é å’Œå¯ç»´æŠ¤çš„Pythonä»£ç ã€‚</p><p>åœ¨ç¼–å†™Pythonä»£ç æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ï¼š</p><ul><li><strong>æ­£ç¡®ç†è§£å¼‚å¸¸</strong>ï¼šç†è§£å¼‚å¸¸çš„åŸºæœ¬æ¦‚å¿µå’Œå±‚æ¬¡ç»“æ„</li><li><strong>åˆç†ä½¿ç”¨å¼‚å¸¸</strong>ï¼šåªåœ¨å¿…è¦æ—¶ä½¿ç”¨å¼‚å¸¸ï¼Œé¿å…è¿‡åº¦ä½¿ç”¨å¼‚å¸¸</li><li><strong>æ•è·å¿…è¦çš„å¼‚å¸¸</strong>ï¼šåªæ•è·èƒ½å¤Ÿå¤„ç†çš„å¼‚å¸¸ï¼Œä½¿ç”¨å…·ä½“çš„å¼‚å¸¸ç±»å‹</li><li><strong>æä¾›æœ‰æ„ä¹‰çš„å¼‚å¸¸ä¿¡æ¯</strong>ï¼šåœ¨å¼‚å¸¸ä¿¡æ¯ä¸­åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li><li><strong>åŠæ—¶é‡Šæ”¾èµ„æº</strong>ï¼šä½¿ç”¨finallyå­å¥æˆ–ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ¥ç¡®ä¿èµ„æºçš„é‡Šæ”¾</li><li><strong>ç»“åˆæ—¥å¿—è®°å½•</strong>ï¼šä½¿ç”¨æ—¥å¿—è®°å½•æ¥è®°å½•å¼‚å¸¸ä¿¡æ¯ï¼Œä¾¿äºè°ƒè¯•å’Œé—®é¢˜æ’æŸ¥</li><li><strong>æµ‹è¯•å¼‚å¸¸å¤„ç†</strong>ï¼šç¼–å†™æµ‹è¯•ç”¨ä¾‹æ¥æµ‹è¯•å¼‚å¸¸å¤„ç†ä»£ç ï¼Œç¡®ä¿å…¶æ­£ç¡®æ€§</li><li><strong>ä¸æ–­å­¦ä¹ </strong>ï¼šå…³æ³¨Pythonçš„æœ€æ–°å‘å±•ï¼Œå­¦ä¹ æ–°çš„å¼‚å¸¸å¤„ç†æŠ€å·§å’Œæœ€ä½³å®è·µ</li></ul><p>é€šè¿‡éµå¾ªè¿™äº›åŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨Pythonçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œç¼–å†™æ›´åŠ å¥å£®ã€å¯é å’Œå¯ç»´æŠ¤çš„Pythonä»£ç ã€‚å¼‚å¸¸å¤„ç†ä¸ä»…æ˜¯ä¸€ç§é”™è¯¯å¤„ç†æ–¹å¼ï¼Œæ›´æ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œå®ƒä½“ç°äº†Pythonè¯­è¨€çš„ä¼˜é›…å’Œå¼ºå¤§ã€‚</p><p>å¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¸®åŠ©è¯»è€…ç†è§£Pythonçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼ŒæŒæ¡å¼‚å¸¸å¤„ç†çš„æœ€ä½³å®è·µï¼Œä»è€Œåœ¨å®é™…å¼€å‘ä¸­ç¼–å†™å‡ºæ›´é«˜è´¨é‡çš„Pythonä»£ç ã€‚</p>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„æ–‡ä»¶I/Oæ“ä½œä¸ç¼“å†²ç­–ç•¥ é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585261</link>    <guid>https://segmentfault.com/a/1190000047585261</guid>    <pubDate>2026-02-01 02:05:44</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„æ–‡ä»¶I/Oæ“ä½œä¸ç¼“å†²ç­–ç•¥</h2><h3>1. æ–‡ä»¶I/Oçš„åŸºæœ¬æ¦‚å¿µ</h3><p>åœ¨Pythonç¼–ç¨‹ä¸­ï¼Œæ–‡ä»¶I/Oï¼ˆè¾“å…¥/è¾“å‡ºï¼‰æ˜¯ä¸€ç§å¸¸è§çš„æ“ä½œï¼Œç”¨äºè¯»å–å’Œå†™å…¥æ–‡ä»¶ã€‚ç†è§£æ–‡ä»¶I/Oçš„åŸºæœ¬æ¦‚å¿µæ˜¯æŒæ¡Pythonæ–‡ä»¶æ“ä½œçš„åŸºç¡€ã€‚</p><h4>1.1 æ–‡ä»¶çš„å®šä¹‰</h4><p>æ–‡ä»¶æ˜¯å­˜å‚¨åœ¨è®¡ç®—æœºå­˜å‚¨ä»‹è´¨ä¸Šçš„ä¸€ç»„ç›¸å…³æ•°æ®çš„é›†åˆï¼Œå®ƒå…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p><ul><li><strong>æ–‡ä»¶å</strong>ï¼šç”¨äºæ ‡è¯†æ–‡ä»¶çš„åç§°</li><li><strong>è·¯å¾„</strong>ï¼šæ–‡ä»¶åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä½ç½®</li><li><strong>å†…å®¹</strong>ï¼šæ–‡ä»¶ä¸­å­˜å‚¨çš„æ•°æ®</li><li><strong>å±æ€§</strong>ï¼šæ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œå¦‚å¤§å°ã€åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ç­‰</li></ul><h4>1.2 æ–‡ä»¶çš„ç±»å‹</h4><p>æ ¹æ®æ–‡ä»¶çš„å†…å®¹å’Œç¼–ç æ–¹å¼ï¼Œæ–‡ä»¶å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ç±»å‹ï¼š</p><ul><li><strong>æ–‡æœ¬æ–‡ä»¶</strong>ï¼šå­˜å‚¨æ–‡æœ¬æ•°æ®ï¼Œä½¿ç”¨å­—ç¬¦ç¼–ç ï¼ˆå¦‚UTF-8ã€ASCIIç­‰ï¼‰</li><li><strong>äºŒè¿›åˆ¶æ–‡ä»¶</strong>ï¼šå­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ï¼Œå¦‚å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰</li><li><strong>ç‰¹æ®Šæ–‡ä»¶</strong>ï¼šå¦‚è®¾å¤‡æ–‡ä»¶ã€ç®¡é“æ–‡ä»¶ç­‰</li></ul><h4>1.3 æ–‡ä»¶æ“ä½œçš„åŸºæœ¬æ¨¡å¼</h4><p>Pythonä¸­çš„æ–‡ä»¶æ“ä½œæ”¯æŒä»¥ä¸‹åŸºæœ¬æ¨¡å¼ï¼š</p><ul><li><strong>è¯»æ¨¡å¼</strong>ï¼ˆ<code>r</code>ï¼‰ï¼šåªè¯»æ¨¡å¼ï¼Œæ‰“å¼€ä¸€ä¸ªå·²å­˜åœ¨çš„æ–‡ä»¶</li><li><strong>å†™æ¨¡å¼</strong>ï¼ˆ<code>w</code>ï¼‰ï¼šå†™å…¥æ¨¡å¼ï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æˆ–æˆªæ–­ç°æœ‰æ–‡ä»¶</li><li><strong>è¿½åŠ æ¨¡å¼</strong>ï¼ˆ<code>a</code>ï¼‰ï¼šè¿½åŠ æ¨¡å¼ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ æ•°æ®</li><li><strong>äºŒè¿›åˆ¶æ¨¡å¼</strong>ï¼ˆ<code>b</code>ï¼‰ï¼šä¸ä¸Šè¿°æ¨¡å¼ç»“åˆä½¿ç”¨ï¼Œä»¥äºŒè¿›åˆ¶æ–¹å¼æ“ä½œæ–‡ä»¶</li><li><strong>è¯»å†™æ¨¡å¼</strong>ï¼ˆ<code>+</code>ï¼‰ï¼šä¸ä¸Šè¿°æ¨¡å¼ç»“åˆä½¿ç”¨ï¼ŒåŒæ—¶æ”¯æŒè¯»å†™æ“ä½œ</li></ul><h4>1.4 æ–‡ä»¶å¯¹è±¡</h4><p>åœ¨Pythonä¸­ï¼Œæ–‡ä»¶æ“ä½œæ˜¯é€šè¿‡æ–‡ä»¶å¯¹è±¡æ¥å®ç°çš„ã€‚æ–‡ä»¶å¯¹è±¡æ˜¯ç”±<code>open()</code>å‡½æ•°è¿”å›çš„ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•ç”¨äºè¯»å–å’Œå†™å…¥æ–‡ä»¶ã€‚</p><pre><code class="python"># æ–‡ä»¶I/Oçš„åŸºæœ¬æ¦‚å¿µç¤ºä¾‹

# 1. æ‰“å¼€æ–‡ä»¶
print("æ‰“å¼€æ–‡ä»¶ç¤ºä¾‹ï¼š")

# æ–‡æœ¬æ¨¡å¼æ‰“å¼€æ–‡ä»¶
try:
    # è¯»æ¨¡å¼
    f = open("test.txt", "r")
    print("æˆåŠŸæ‰“å¼€æ–‡ä»¶ï¼ˆè¯»æ¨¡å¼ï¼‰")
    f.close()
    
    # å†™æ¨¡å¼
    f = open("test.txt", "w")
    print("æˆåŠŸæ‰“å¼€æ–‡ä»¶ï¼ˆå†™æ¨¡å¼ï¼‰")
    f.close()
    
    # è¿½åŠ æ¨¡å¼
    f = open("test.txt", "a")
    print("æˆåŠŸæ‰“å¼€æ–‡ä»¶ï¼ˆè¿½åŠ æ¨¡å¼ï¼‰")
    f.close()
    
    # äºŒè¿›åˆ¶æ¨¡å¼
    f = open("test.bin", "wb")
    print("æˆåŠŸæ‰“å¼€æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶å†™æ¨¡å¼ï¼‰")
    f.close()
    
    # è¯»å†™æ¨¡å¼
    f = open("test.txt", "r+")
    print("æˆåŠŸæ‰“å¼€æ–‡ä»¶ï¼ˆè¯»å†™æ¨¡å¼ï¼‰")
    f.close()
except Exception as e:
    print(f"æ‰“å¼€æ–‡ä»¶å¤±è´¥: {e}")

# 2. æ–‡ä»¶å¯¹è±¡çš„å±æ€§
print("\næ–‡ä»¶å¯¹è±¡çš„å±æ€§ç¤ºä¾‹ï¼š")

try:
    f = open("test.txt", "w+")
    print(f"æ–‡ä»¶å: {f.name}")
    print(f"æ¨¡å¼: {f.mode}")
    print(f"æ˜¯å¦å…³é—­: {f.closed}")
    print(f"ç¼–ç : {f.encoding}")
    print(f"æ¢è¡Œç¬¦: {f.newlines}")
    print(f"æ˜¯å¦å¯è¯»å†™: {f.readable()}, {f.writable()}")
    f.close()
except Exception as e:
    print(f"æ“ä½œå¤±è´¥: {e}")

# 3. ä¸Šä¸‹æ–‡ç®¡ç†å™¨
print("\nä¸Šä¸‹æ–‡ç®¡ç†å™¨ç¤ºä¾‹ï¼š")

# ä½¿ç”¨withè¯­å¥ï¼ˆä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼‰æ‰“å¼€æ–‡ä»¶
with open("test.txt", "w") as f:
    f.write("Hello, World!\n")
    print("å†™å…¥æ•°æ®")
print("æ–‡ä»¶å·²è‡ªåŠ¨å…³é—­")

# 4. æŸ¥çœ‹æ–‡ä»¶å†…å®¹
with open("test.txt", "r") as f:
    content = f.read()
    print(f"æ–‡ä»¶å†…å®¹: {content}")

# 5. åˆ é™¤æµ‹è¯•æ–‡ä»¶
import os
if os.path.exists("test.txt"):
    os.remove("test.txt")
    print("åˆ é™¤test.txtæ–‡ä»¶")
if os.path.exists("test.bin"):
    os.remove("test.bin")
    print("åˆ é™¤test.binæ–‡ä»¶")</code></pre><h3>2. æ–‡ä»¶I/Oæ“ä½œçš„åŸºæœ¬æ–¹æ³•</h3><p>Pythonçš„æ–‡ä»¶å¯¹è±¡æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•ç”¨äºè¯»å–å’Œå†™å…¥æ–‡ä»¶ã€‚ç†è§£è¿™äº›æ–¹æ³•æ˜¯æŒæ¡Pythonæ–‡ä»¶æ“ä½œçš„å…³é”®ã€‚</p><h4>2.1 è¯»å–æ–‡ä»¶çš„æ–¹æ³•</h4><p>æ–‡ä»¶å¯¹è±¡æä¾›äº†ä»¥ä¸‹è¯»å–æ–‡ä»¶çš„æ–¹æ³•ï¼š</p><ul><li><strong><code>read(size=-1)</code></strong>ï¼šè¯»å–æŒ‡å®šå¤§å°çš„å­—èŠ‚æˆ–å­—ç¬¦ï¼Œé»˜è®¤è¯»å–æ•´ä¸ªæ–‡ä»¶</li><li><strong><code>readline(size=-1)</code></strong>ï¼šè¯»å–ä¸€è¡Œæ•°æ®ï¼Œé»˜è®¤è¯»å–æ•´ä¸ªè¡Œ</li><li><strong><code>readlines(hint=-1)</code></strong>ï¼šè¯»å–æ‰€æœ‰è¡Œï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œé»˜è®¤è¯»å–æ‰€æœ‰è¡Œ</li><li><strong><code>__iter__()</code></strong>ï¼šæ”¯æŒè¿­ä»£æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨<code>for</code>å¾ªç¯éå†æ–‡ä»¶çš„æ¯ä¸€è¡Œ</li></ul><h4>2.2 å†™å…¥æ–‡ä»¶çš„æ–¹æ³•</h4><p>æ–‡ä»¶å¯¹è±¡æä¾›äº†ä»¥ä¸‹å†™å…¥æ–‡ä»¶çš„æ–¹æ³•ï¼š</p><ul><li><strong><code>write(string)</code></strong>ï¼šå†™å…¥å­—ç¬¦ä¸²æˆ–å­—èŠ‚ä¸²</li><li><strong><code>writelines(lines)</code></strong>ï¼šå†™å…¥å¤šè¡Œæ•°æ®</li><li><strong><code>flush()</code></strong>ï¼šåˆ·æ–°ç¼“å†²åŒºï¼Œå°†æ•°æ®ç«‹å³å†™å…¥æ–‡ä»¶</li><li><strong><code>close()</code></strong>ï¼šå…³é—­æ–‡ä»¶ï¼Œè‡ªåŠ¨åˆ·æ–°ç¼“å†²åŒº</li></ul><h4>2.3 æ–‡ä»¶æŒ‡é’ˆæ“ä½œçš„æ–¹æ³•</h4><p>æ–‡ä»¶å¯¹è±¡æä¾›äº†ä»¥ä¸‹æ–‡ä»¶æŒ‡é’ˆæ“ä½œçš„æ–¹æ³•ï¼š</p><ul><li><strong><code>tell()</code></strong>ï¼šè¿”å›å½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®</li><li><p><strong><code>seek(offset, whence=0)</code></strong>ï¼šç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æŒ‡å®šä½ç½®</p><ul><li><code>offset</code>ï¼šåç§»é‡</li><li><code>whence</code>ï¼šå‚è€ƒä½ç½®ï¼ˆ0ï¼šæ–‡ä»¶å¼€å¤´ï¼Œ1ï¼šå½“å‰ä½ç½®ï¼Œ2ï¼šæ–‡ä»¶æœ«å°¾ï¼‰</li></ul></li></ul><h4>2.4 æ–‡ä»¶æ“ä½œçš„ç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯æ–‡ä»¶æ“ä½œçš„ä¸€äº›å¸¸è§ç¤ºä¾‹ï¼š</p><pre><code class="python"># æ–‡ä»¶I/Oæ“ä½œçš„åŸºæœ¬æ–¹æ³•ç¤ºä¾‹

# 1. å†™å…¥æ–‡ä»¶
print("å†™å…¥æ–‡ä»¶ç¤ºä¾‹ï¼š")

# å†™å…¥æ–‡æœ¬æ–‡ä»¶
with open("example.txt", "w", encoding="utf-8") as f:
    f.write("Hello, World!\n")
    f.write("Pythonæ–‡ä»¶æ“ä½œç¤ºä¾‹\n")
    f.write("è¿™æ˜¯ç¬¬ä¸‰è¡Œ\n")
print("å†™å…¥æ–‡æœ¬æ–‡ä»¶æˆåŠŸ")

# å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶
with open("example.bin", "wb") as f:
    f.write(b"Hello, Binary!\n")
    f.write(b"PythonäºŒè¿›åˆ¶æ–‡ä»¶æ“ä½œç¤ºä¾‹\n")
print("å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶æˆåŠŸ")

# 2. è¯»å–æ–‡ä»¶
print("\nè¯»å–æ–‡ä»¶ç¤ºä¾‹ï¼š")

# è¯»å–æ•´ä¸ªæ–‡ä»¶
with open("example.txt", "r", encoding="utf-8") as f:
    content = f.read()
    print("è¯»å–æ•´ä¸ªæ–‡ä»¶ï¼š")
    print(content)

# è¯»å–æŒ‡å®šå¤§å°
with open("example.txt", "r", encoding="utf-8") as f:
    content = f.read(10)
    print("\nè¯»å–å‰10ä¸ªå­—ç¬¦ï¼š")
    print(content)

# é€è¡Œè¯»å–
with open("example.txt", "r", encoding="utf-8") as f:
    print("\né€è¡Œè¯»å–ï¼š")
    line1 = f.readline()
    line2 = f.readline()
    print(f"ç¬¬ä¸€è¡Œ: {line1.rstrip()}")
    print(f"ç¬¬äºŒè¡Œ: {line2.rstrip()}")

# è¯»å–æ‰€æœ‰è¡Œ
with open("example.txt", "r", encoding="utf-8") as f:
    lines = f.readlines()
    print("\nè¯»å–æ‰€æœ‰è¡Œï¼š")
    for i, line in enumerate(lines):
        print(f"ç¬¬{i+1}è¡Œ: {line.rstrip()}")

# ä½¿ç”¨forå¾ªç¯éå†
with open("example.txt", "r", encoding="utf-8") as f:
    print("\nä½¿ç”¨forå¾ªç¯éå†ï¼š")
    for i, line in enumerate(f):
        print(f"ç¬¬{i+1}è¡Œ: {line.rstrip()}")

# è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶
with open("example.bin", "rb") as f:
    content = f.read()
    print("\nè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼š")
    print(content)

# 3. æ–‡ä»¶æŒ‡é’ˆæ“ä½œ
print("\næ–‡ä»¶æŒ‡é’ˆæ“ä½œç¤ºä¾‹ï¼š")

with open("example.txt", "r+", encoding="utf-8") as f:
    # æŸ¥çœ‹åˆå§‹ä½ç½®
    print(f"åˆå§‹æ–‡ä»¶æŒ‡é’ˆä½ç½®: {f.tell()}")
    
    # è¯»å–ä¸€äº›æ•°æ®
    content = f.read(10)
    print(f"è¯»å–çš„å†…å®¹: {content}")
    print(f"è¯»å–åæ–‡ä»¶æŒ‡é’ˆä½ç½®: {f.tell()}")
    
    # ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æ–‡ä»¶å¼€å¤´
    f.seek(0)
    print(f"ç§»åŠ¨åˆ°æ–‡ä»¶å¼€å¤´åæŒ‡é’ˆä½ç½®: {f.tell()}")
    
    # è¯»å–ç¬¬ä¸€è¡Œ
    line = f.readline()
    print(f"ç¬¬ä¸€è¡Œå†…å®¹: {line.rstrip()}")
    
    # ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æ–‡ä»¶æœ«å°¾
    f.seek(0, 2)
    print(f"ç§»åŠ¨åˆ°æ–‡ä»¶æœ«å°¾åæŒ‡é’ˆä½ç½®: {f.tell()}")
    
    # åœ¨æ–‡ä»¶æœ«å°¾å†™å…¥æ•°æ®
    f.write("è¿™æ˜¯è¿½åŠ çš„å†…å®¹\n")
    print("åœ¨æ–‡ä»¶æœ«å°¾å†™å…¥æ•°æ®")

# æŸ¥çœ‹ä¿®æ”¹åçš„æ–‡ä»¶å†…å®¹
with open("example.txt", "r", encoding="utf-8") as f:
    content = f.read()
    print("\nä¿®æ”¹åçš„æ–‡ä»¶å†…å®¹ï¼š")
    print(content)

# 4. è¿½åŠ å†…å®¹
print("\nè¿½åŠ å†…å®¹ç¤ºä¾‹ï¼š")

with open("example.txt", "a", encoding="utf-8") as f:
    f.write("è¿™æ˜¯ä½¿ç”¨è¿½åŠ æ¨¡å¼æ·»åŠ çš„å†…å®¹\n")
print("è¿½åŠ å†…å®¹æˆåŠŸ")

# æŸ¥çœ‹è¿½åŠ åçš„æ–‡ä»¶å†…å®¹
with open("example.txt", "r", encoding="utf-8") as f:
    content = f.read()
    print("\nè¿½åŠ åçš„æ–‡ä»¶å†…å®¹ï¼š")
    print(content)

# 5. æ¸…ç†æµ‹è¯•æ–‡ä»¶
import os
if os.path.exists("example.txt"):
    os.remove("example.txt")
    print("åˆ é™¤example.txtæ–‡ä»¶")
if os.path.exists("example.bin"):
    os.remove("example.bin")
    print("åˆ é™¤example.binæ–‡ä»¶")</code></pre><h3>3. ç¼“å†²ç­–ç•¥</h3><p>ç¼“å†²æ˜¯æ–‡ä»¶I/Oæ“ä½œä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå®ƒå¯ä»¥æé«˜æ–‡ä»¶æ“ä½œçš„æ€§èƒ½ã€‚ç†è§£ç¼“å†²ç­–ç•¥å¯¹äºä¼˜åŒ–æ–‡ä»¶I/Oæ“ä½œè‡³å…³é‡è¦ã€‚</p><h4>3.1 ç¼“å†²çš„åŸºæœ¬æ¦‚å¿µ</h4><p>ç¼“å†²æ˜¯æŒ‡åœ¨å†…å­˜ä¸­ä¸´æ—¶å­˜å‚¨æ•°æ®ï¼Œç„¶åæ‰¹é‡å†™å…¥æˆ–è¯»å–æ–‡ä»¶çš„è¿‡ç¨‹ã€‚ç¼“å†²çš„ä¸»è¦ç›®çš„æ˜¯ï¼š</p><ul><li><strong>æé«˜æ€§èƒ½</strong>ï¼šå‡å°‘ç£ç›˜I/Oæ“ä½œçš„æ¬¡æ•°ï¼Œå› ä¸ºå†…å­˜æ“ä½œæ¯”ç£ç›˜æ“ä½œå¿«å¾—å¤š</li><li><strong>å‡å°‘ç³»ç»Ÿè°ƒç”¨</strong>ï¼šç³»ç»Ÿè°ƒç”¨çš„å¼€é”€è¾ƒå¤§ï¼Œç¼“å†²å¯ä»¥å‡å°‘ç³»ç»Ÿè°ƒç”¨çš„æ¬¡æ•°</li><li><strong>æé«˜å¯é æ€§</strong>ï¼šåœ¨æ„å¤–æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ç¼“å†²æ¢å¤æ•°æ®</li></ul><h4>3.2 Pythonä¸­çš„ç¼“å†²æ¨¡å¼</h4><p>Pythonä¸­çš„æ–‡ä»¶å¯¹è±¡æ”¯æŒä»¥ä¸‹ç¼“å†²æ¨¡å¼ï¼š</p><ul><li><strong>æ— ç¼“å†²</strong>ï¼ˆ<code>0</code>ï¼‰ï¼šä¸ä½¿ç”¨ç¼“å†²ï¼Œæ¯æ¬¡è¯»å†™æ“ä½œéƒ½ä¼šç›´æ¥æ“ä½œç£ç›˜</li><li><strong>è¡Œç¼“å†²</strong>ï¼ˆ<code>1</code>ï¼‰ï¼šæŒ‰è¡Œç¼“å†²ï¼Œå½“é‡åˆ°æ¢è¡Œç¬¦æ—¶åˆ·æ–°ç¼“å†²åŒº</li><li><strong>å—ç¼“å†²</strong>ï¼ˆ<code>&gt;1</code>ï¼‰ï¼šæŒ‰å—ç¼“å†²ï¼Œå½“ç¼“å†²åŒºæ»¡æ—¶åˆ·æ–°ç¼“å†²åŒº</li><li><p><strong>é»˜è®¤ç¼“å†²</strong>ï¼šæ ¹æ®æ–‡ä»¶ç±»å‹å’Œæ“ä½œæ¨¡å¼è‡ªåŠ¨é€‰æ‹©ç¼“å†²æ¨¡å¼</p><ul><li>æ–‡æœ¬æ–‡ä»¶ï¼šé»˜è®¤ä½¿ç”¨è¡Œç¼“å†²</li><li>äºŒè¿›åˆ¶æ–‡ä»¶ï¼šé»˜è®¤ä½¿ç”¨å—ç¼“å†²</li></ul></li></ul><h4>3.3 ç¼“å†²åŒºçš„å¤§å°</h4><p>ç¼“å†²åŒºçš„å¤§å°ä¼šå½±å“æ–‡ä»¶æ“ä½œçš„æ€§èƒ½ï¼š</p><ul><li><strong>è¾ƒå°çš„ç¼“å†²åŒº</strong>ï¼šå†…å­˜ä½¿ç”¨è¾ƒå°‘ï¼Œä½†å¯èƒ½ä¼šå¢åŠ ç£ç›˜I/Oæ“ä½œçš„æ¬¡æ•°</li><li><strong>è¾ƒå¤§çš„ç¼“å†²åŒº</strong>ï¼šå¯ä»¥å‡å°‘ç£ç›˜I/Oæ“ä½œçš„æ¬¡æ•°ï¼Œä½†ä¼šå¢åŠ å†…å­˜ä½¿ç”¨</li></ul><h4>3.4 ç¼“å†²çš„æ§åˆ¶</h4><p>Pythonæä¾›äº†ä»¥ä¸‹æ–¹æ³•æ¥æ§åˆ¶ç¼“å†²ï¼š</p><ul><li><strong><code>flush()</code></strong>ï¼šæ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒºï¼Œå°†æ•°æ®å†™å…¥ç£ç›˜</li><li><strong><code>close()</code></strong>ï¼šå…³é—­æ–‡ä»¶æ—¶è‡ªåŠ¨åˆ·æ–°ç¼“å†²åŒº</li><li><strong><code>with</code>è¯­å¥</strong>ï¼šé€€å‡ºä¸Šä¸‹æ–‡ç®¡ç†å™¨æ—¶è‡ªåŠ¨å…³é—­æ–‡ä»¶ï¼Œä»è€Œè‡ªåŠ¨åˆ·æ–°ç¼“å†²åŒº</li></ul><h4>3.5 ç¼“å†²ç­–ç•¥çš„ç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯ç¼“å†²ç­–ç•¥çš„ä¸€äº›ç¤ºä¾‹ï¼š</p><pre><code class="python"># ç¼“å†²ç­–ç•¥ç¤ºä¾‹

import os
import time

# 1. ç¼“å†²æ¨¡å¼ç¤ºä¾‹
print("ç¼“å†²æ¨¡å¼ç¤ºä¾‹ï¼š")

# æ— ç¼“å†²
print("\næ— ç¼“å†²æ¨¡å¼ï¼š")
try:
    # æ³¨æ„ï¼šåœ¨æ–‡æœ¬æ¨¡å¼ä¸‹ï¼Œç¼“å†²æ¨¡å¼0å¯èƒ½ä¸æ”¯æŒ
    f = open("buffer_test.txt", "wb", buffering=0)
    print(f"æ‰“å¼€æ–‡ä»¶æˆåŠŸï¼Œç¼“å†²æ¨¡å¼: æ— ç¼“å†²")
    f.write(b"Hello, Buffer!\n")
    f.close()
except Exception as e:
    print(f"æ“ä½œå¤±è´¥: {e}")

# è¡Œç¼“å†²
print("\nè¡Œç¼“å†²æ¨¡å¼ï¼š")
try:
    f = open("buffer_test.txt", "w", buffering=1)
    print(f"æ‰“å¼€æ–‡ä»¶æˆåŠŸï¼Œç¼“å†²æ¨¡å¼: è¡Œç¼“å†²")
    f.write("Hello, Line Buffer!\n")
    # å†™å…¥æ¢è¡Œç¬¦åä¼šè‡ªåŠ¨åˆ·æ–°ç¼“å†²åŒº
    print("å†™å…¥æ¢è¡Œç¬¦åï¼Œç¼“å†²åŒºå·²åˆ·æ–°")
    f.close()
except Exception as e:
    print(f"æ“ä½œå¤±è´¥: {e}")

# å—ç¼“å†²
print("\nå—ç¼“å†²æ¨¡å¼ï¼š")
try:
    f = open("buffer_test.txt", "w", buffering=1024)
    print(f"æ‰“å¼€æ–‡ä»¶æˆåŠŸï¼Œç¼“å†²æ¨¡å¼: å—ç¼“å†²ï¼Œç¼“å†²åŒºå¤§å°: 1024")
    f.write("Hello, Block Buffer!\n")
    print("å†™å…¥æ•°æ®åï¼Œç¼“å†²åŒºæœªåˆ·æ–°ï¼ˆæ•°æ®é‡å°ï¼‰")
    f.flush()
    print("æ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒº")
    f.close()
except Exception as e:
    print(f"æ“ä½œå¤±è´¥: {e}")

# 2. ç¼“å†²æ€§èƒ½æµ‹è¯•
print("\nç¼“å†²æ€§èƒ½æµ‹è¯•ï¼š")

def test_write_performance(buffering):
    """æµ‹è¯•å†™å…¥æ€§èƒ½"""
    start_time = time.time()
    with open("performance_test.txt", "w", buffering=buffering) as f:
        for i in range(10000):
            f.write(f"Line {i}: This is a test line.\n")
    end_time = time.time()
    return end_time - start_time

# æµ‹è¯•ä¸åŒç¼“å†²æ¨¡å¼çš„æ€§èƒ½
print("æµ‹è¯•ä¸åŒç¼“å†²æ¨¡å¼çš„å†™å…¥æ€§èƒ½ï¼š")

# æ— ç¼“å†²ï¼ˆå¦‚æœæ”¯æŒï¼‰
try:
    time_no_buffer = test_write_performance(0)
    print(f"æ— ç¼“å†²æ¨¡å¼è€—æ—¶: {time_no_buffer:.4f}ç§’")
except Exception as e:
    print(f"æ— ç¼“å†²æ¨¡å¼æµ‹è¯•å¤±è´¥: {e}")

# è¡Œç¼“å†²
time_line_buffer = test_write_performance(1)
print(f"è¡Œç¼“å†²æ¨¡å¼è€—æ—¶: {time_line_buffer:.4f}ç§’")

# å—ç¼“å†²ï¼ˆ1024å­—èŠ‚ï¼‰
time_block_buffer_1k = test_write_performance(1024)
print(f"1024å­—èŠ‚å—ç¼“å†²æ¨¡å¼è€—æ—¶: {time_block_buffer_1k:.4f}ç§’")

# å—ç¼“å†²ï¼ˆ4096å­—èŠ‚ï¼‰
time_block_buffer_4k = test_write_performance(4096)
print(f"4096å­—èŠ‚å—ç¼“å†²æ¨¡å¼è€—æ—¶: {time_block_buffer_4k:.4f}ç§’")

# å—ç¼“å†²ï¼ˆ8192å­—èŠ‚ï¼‰
time_block_buffer_8k = test_write_performance(8192)
print(f"8192å­—èŠ‚å—ç¼“å†²æ¨¡å¼è€—æ—¶: {time_block_buffer_8k:.4f}ç§’")

# 3. ç¼“å†²åŒºåˆ·æ–°ç¤ºä¾‹
print("\nç¼“å†²åŒºåˆ·æ–°ç¤ºä¾‹ï¼š")

print("æµ‹è¯•ç¼“å†²åŒºåˆ·æ–°è¡Œä¸ºï¼š")
with open("flush_test.txt", "w") as f:
    print("å†™å…¥ç¬¬ä¸€è¡Œæ•°æ®...")
    f.write("ç¬¬ä¸€è¡Œæ•°æ®\n")
    # å†™å…¥æ¢è¡Œç¬¦åï¼Œè¡Œç¼“å†²ä¼šè‡ªåŠ¨åˆ·æ–°
    print("å†™å…¥ç¬¬ä¸€è¡Œåï¼Œæ£€æŸ¥æ–‡ä»¶æ˜¯å¦æœ‰å†…å®¹...")
    
    # è¯»å–æ–‡ä»¶å†…å®¹
    with open("flush_test.txt", "r") as f_read:
        content = f_read.read()
        print(f"æ–‡ä»¶å†…å®¹: '{content}'")
    
    print("\nå†™å…¥ç¬¬äºŒè¡Œæ•°æ®ï¼ˆä¸åŒ…å«æ¢è¡Œç¬¦ï¼‰...")
    f.write("ç¬¬äºŒè¡Œæ•°æ®")
    # æ²¡æœ‰æ¢è¡Œç¬¦ï¼Œè¡Œç¼“å†²ä¸ä¼šè‡ªåŠ¨åˆ·æ–°
    print("å†™å…¥ç¬¬äºŒè¡Œåï¼Œæ£€æŸ¥æ–‡ä»¶æ˜¯å¦æœ‰å†…å®¹...")
    
    # è¯»å–æ–‡ä»¶å†…å®¹
    with open("flush_test.txt", "r") as f_read:
        content = f_read.read()
        print(f"æ–‡ä»¶å†…å®¹: '{content}'")
    
    print("\næ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒº...")
    f.flush()
    print("åˆ·æ–°åï¼Œæ£€æŸ¥æ–‡ä»¶æ˜¯å¦æœ‰å†…å®¹...")
    
    # è¯»å–æ–‡ä»¶å†…å®¹
    with open("flush_test.txt", "r") as f_read:
        content = f_read.read()
        print(f"æ–‡ä»¶å†…å®¹: '{content}'")

print("\né€€å‡ºwithè¯­å¥åï¼Œæ–‡ä»¶ä¼šè‡ªåŠ¨å…³é—­å¹¶åˆ·æ–°ç¼“å†²åŒº")

# æ£€æŸ¥æ–‡ä»¶æœ€ç»ˆå†…å®¹
with open("flush_test.txt", "r") as f:
    content = f.read()
    print(f"æ–‡ä»¶æœ€ç»ˆå†…å®¹: '{content}'")

# 4. æ¸…ç†æµ‹è¯•æ–‡ä»¶
print("\næ¸…ç†æµ‹è¯•æ–‡ä»¶ï¼š")

for file in ["buffer_test.txt", "performance_test.txt", "flush_test.txt"]:
    if os.path.exists(file):
        os.remove(file)
        print(f"åˆ é™¤{file}æ–‡ä»¶")</code></pre><h3>4. æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</h3><p>é™¤äº†æ–‡ä»¶çš„è¯»å†™æ“ä½œå¤–ï¼ŒPythonè¿˜æä¾›äº†ä¸€ç³»åˆ—æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„å‡½æ•°ï¼Œç”¨äºç®¡ç†æ–‡ä»¶å’Œç›®å½•ã€‚</p><h4>4.1 osæ¨¡å—</h4><p><code>os</code>æ¨¡å—æä¾›äº†ä¸æ“ä½œç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„<code>os</code>æ¨¡å—å‡½æ•°ï¼š</p><ul><li><p><strong><code>os.path</code></strong>ï¼šç”¨äºå¤„ç†è·¯å¾„ç›¸å…³çš„æ“ä½œ</p><ul><li><code>os.path.exists(path)</code>ï¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨</li><li><code>os.path.isfile(path)</code>ï¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦æ˜¯æ–‡ä»¶</li><li><code>os.path.isdir(path)</code>ï¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦æ˜¯ç›®å½•</li><li><code>os.path.join(path1, path2, ...)</code>ï¼šè¿æ¥å¤šä¸ªè·¯å¾„</li><li><code>os.path.abspath(path)</code>ï¼šè·å–ç»å¯¹è·¯å¾„</li><li><code>os.path.basename(path)</code>ï¼šè·å–æ–‡ä»¶å</li><li><code>os.path.dirname(path)</code>ï¼šè·å–ç›®å½•å</li></ul></li><li><p><strong>æ–‡ä»¶æ“ä½œ</strong>ï¼š</p><ul><li><code>os.remove(path)</code>ï¼šåˆ é™¤æ–‡ä»¶</li><li><code>os.rename(src, dst)</code>ï¼šé‡å‘½åæ–‡ä»¶æˆ–ç›®å½•</li><li><code>os.replace(src, dst)</code>ï¼šæ›¿æ¢æ–‡ä»¶</li><li><code>os.chmod(path, mode)</code>ï¼šä¿®æ”¹æ–‡ä»¶æƒé™</li></ul></li><li><p><strong>ç›®å½•æ“ä½œ</strong>ï¼š</p><ul><li><code>os.mkdir(path)</code>ï¼šåˆ›å»ºç›®å½•</li><li><code>os.makedirs(path)</code>ï¼šé€’å½’åˆ›å»ºç›®å½•</li><li><code>os.rmdir(path)</code>ï¼šåˆ é™¤ç›®å½•</li><li><code>os.removedirs(path)</code>ï¼šé€’å½’åˆ é™¤ç›®å½•</li><li><code>os.listdir(path)</code>ï¼šåˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•</li></ul></li></ul><h4>4.2 shutilæ¨¡å—</h4><p><code>shutil</code>æ¨¡å—æä¾›äº†æ›´é«˜çº§çš„æ–‡ä»¶æ“ä½œåŠŸèƒ½ï¼Œå¦‚å¤åˆ¶ã€ç§»åŠ¨ã€å½’æ¡£ç­‰ï¼š</p><ul><li><p><strong>æ–‡ä»¶å¤åˆ¶</strong>ï¼š</p><ul><li><code>shutil.copy(src, dst)</code>ï¼šå¤åˆ¶æ–‡ä»¶</li><li><code>shutil.copy2(src, dst)</code>ï¼šå¤åˆ¶æ–‡ä»¶å’Œå…ƒæ•°æ®</li><li><code>shutil.copyfile(src, dst)</code>ï¼šå¤åˆ¶æ–‡ä»¶å†…å®¹</li></ul></li><li><p><strong>ç›®å½•å¤åˆ¶</strong>ï¼š</p><ul><li><code>shutil.copytree(src, dst)</code>ï¼šé€’å½’å¤åˆ¶ç›®å½•</li></ul></li><li><p><strong>æ–‡ä»¶å’Œç›®å½•ç§»åŠ¨</strong>ï¼š</p><ul><li><code>shutil.move(src, dst)</code>ï¼šç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•</li></ul></li><li><p><strong>æ–‡ä»¶åˆ é™¤</strong>ï¼š</p><ul><li><code>shutil.rmtree(path)</code>ï¼šé€’å½’åˆ é™¤ç›®å½•åŠå…¶å†…å®¹</li></ul></li><li><p><strong>å½’æ¡£æ“ä½œ</strong>ï¼š</p><ul><li><code>shutil.make_archive(base_name, format, root_dir)</code>ï¼šåˆ›å»ºå½’æ¡£æ–‡ä»¶</li><li><code>shutil.unpack_archive(filename, extract_dir)</code>ï¼šè§£å‹å½’æ¡£æ–‡ä»¶</li></ul></li></ul><h4>4.3 pathlibæ¨¡å—</h4><p><code>pathlib</code>æ¨¡å—æ˜¯Python 3.4+å¼•å…¥çš„ï¼Œæä¾›äº†é¢å‘å¯¹è±¡çš„è·¯å¾„æ“ä½œæ¥å£ï¼š</p><ul><li><p><strong>è·¯å¾„å¯¹è±¡</strong>ï¼š</p><ul><li><code>Path(path)</code>ï¼šåˆ›å»ºè·¯å¾„å¯¹è±¡</li><li><code>PurePath(path)</code>ï¼šåˆ›å»ºçº¯è·¯å¾„å¯¹è±¡ï¼ˆä¸æ¶‰åŠå®é™…æ–‡ä»¶ç³»ç»Ÿï¼‰</li></ul></li><li><p><strong>è·¯å¾„æ“ä½œ</strong>ï¼š</p><ul><li><code>path.exists()</code>ï¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨</li><li><code>path.is_file()</code>ï¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦æ˜¯æ–‡ä»¶</li><li><code>path.is_dir()</code>ï¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦æ˜¯ç›®å½•</li><li><code>path.iterdir()</code>ï¼šéå†ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•</li><li><code>path.glob(pattern)</code>ï¼šæŸ¥æ‰¾åŒ¹é…æ¨¡å¼çš„æ–‡ä»¶</li><li><code>path.rglob(pattern)</code>ï¼šé€’å½’æŸ¥æ‰¾åŒ¹é…æ¨¡å¼çš„æ–‡ä»¶</li></ul></li><li><p><strong>æ–‡ä»¶æ“ä½œ</strong>ï¼š</p><ul><li><code>path.read_text(encoding=None)</code>ï¼šè¯»å–æ–‡æœ¬æ–‡ä»¶</li><li><code>path.write_text(data, encoding=None)</code>ï¼šå†™å…¥æ–‡æœ¬æ–‡ä»¶</li><li><code>path.read_bytes()</code>ï¼šè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶</li><li><code>path.write_bytes(data)</code>ï¼šå†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶</li><li><code>path.unlink()</code>ï¼šåˆ é™¤æ–‡ä»¶</li></ul></li><li><p><strong>ç›®å½•æ“ä½œ</strong>ï¼š</p><ul><li><code>path.mkdir(exist_ok=False)</code>ï¼šåˆ›å»ºç›®å½•</li><li><code>path.rmdir()</code>ï¼šåˆ é™¤ç›®å½•</li><li><code>path.mkdir(parents=True, exist_ok=False)</code>ï¼šé€’å½’åˆ›å»ºç›®å½•</li></ul></li></ul><h4>4.4 æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„ç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„ä¸€äº›å¸¸è§ç¤ºä¾‹ï¼š</p><pre><code class="python"># æ–‡ä»¶ç³»ç»Ÿæ“ä½œç¤ºä¾‹

import os
import shutil
from pathlib import Path

# 1. osæ¨¡å—ç¤ºä¾‹
print("osæ¨¡å—ç¤ºä¾‹ï¼š")

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
file_path = "test_file.txt"
print(f"\næ£€æŸ¥æ–‡ä»¶ {file_path} æ˜¯å¦å­˜åœ¨ï¼š")
if os.path.exists(file_path):
    print(f"æ–‡ä»¶ {file_path} å­˜åœ¨")
else:
    print(f"æ–‡ä»¶ {file_path} ä¸å­˜åœ¨")
    # åˆ›å»ºæ–‡ä»¶
    with open(file_path, "w") as f:
        f.write("æµ‹è¯•æ–‡ä»¶å†…å®¹\n")
    print(f"åˆ›å»ºæ–‡ä»¶ {file_path} æˆåŠŸ")

# æ£€æŸ¥è·¯å¾„ç±»å‹
print(f"\næ£€æŸ¥è·¯å¾„ {file_path} çš„ç±»å‹ï¼š")
print(f"æ˜¯å¦æ˜¯æ–‡ä»¶: {os.path.isfile(file_path)}")
print(f"æ˜¯å¦æ˜¯ç›®å½•: {os.path.isdir(file_path)}")

# è·å–æ–‡ä»¶ä¿¡æ¯
print(f"\næ–‡ä»¶ {file_path} çš„ä¿¡æ¯ï¼š")
print(f"ç»å¯¹è·¯å¾„: {os.path.abspath(file_path)}")
print(f"æ–‡ä»¶å: {os.path.basename(file_path)}")
print(f"ç›®å½•å: {os.path.dirname(file_path)}")
print(f"æ–‡ä»¶å¤§å°: {os.path.getsize(file_path)} å­—èŠ‚")
print(f"åˆ›å»ºæ—¶é—´: {os.path.getctime(file_path)}")
print(f"ä¿®æ”¹æ—¶é—´: {os.path.getmtime(file_path)}")

# ç›®å½•æ“ä½œ
print("\nç›®å½•æ“ä½œï¼š")
dir_path = "test_dir"
print(f"æ£€æŸ¥ç›®å½• {dir_path} æ˜¯å¦å­˜åœ¨ï¼š")
if not os.path.exists(dir_path):
    os.mkdir(dir_path)
    print(f"åˆ›å»ºç›®å½• {dir_path} æˆåŠŸ")
else:
    print(f"ç›®å½• {dir_path} å·²å­˜åœ¨")

# åˆ—å‡ºç›®å½•å†…å®¹
print(f"\nç›®å½• {dir_path} ä¸­çš„å†…å®¹ï¼š")
if os.path.exists(dir_path):
    contents = os.listdir(dir_path)
    print(f"ç›®å½•å†…å®¹: {contents}")

# 2. shutilæ¨¡å—ç¤ºä¾‹
print("\nshutilæ¨¡å—ç¤ºä¾‹ï¼š")

# å¤åˆ¶æ–‡ä»¶
src_file = "test_file.txt"
dst_file = os.path.join(dir_path, "copied_file.txt")
print(f"\nå¤åˆ¶æ–‡ä»¶ {src_file} åˆ° {dst_file}ï¼š")
if os.path.exists(src_file):
    shutil.copy(src_file, dst_file)
    print("å¤åˆ¶æ–‡ä»¶æˆåŠŸ")

# æ£€æŸ¥å¤åˆ¶çš„æ–‡ä»¶
print(f"æ£€æŸ¥å¤åˆ¶çš„æ–‡ä»¶ {dst_file}ï¼š")
if os.path.exists(dst_file):
    with open(dst_file, "r") as f:
        content = f.read()
        print(f"æ–‡ä»¶å†…å®¹: {content}")

# 3. pathlibæ¨¡å—ç¤ºä¾‹
print("\npathlibæ¨¡å—ç¤ºä¾‹ï¼š")

# åˆ›å»ºPathå¯¹è±¡
path = Path("test_file.txt")
print(f"\nPathå¯¹è±¡æ“ä½œï¼š")
print(f"è·¯å¾„: {path}")
print(f"ç»å¯¹è·¯å¾„: {path.absolute()}")
print(f"æ˜¯å¦å­˜åœ¨: {path.exists()}")
print(f"æ˜¯å¦æ˜¯æ–‡ä»¶: {path.is_file()}")
print(f"æ˜¯å¦æ˜¯ç›®å½•: {path.is_dir()}")
print(f"æ–‡ä»¶å: {path.name}")
print(f"åç¼€: {path.suffix}")
print(f"stem: {path.stem}")
print(f"çˆ¶ç›®å½•: {path.parent}")

# è¯»å–æ–‡ä»¶å†…å®¹
print("\nä½¿ç”¨Pathå¯¹è±¡è¯»å–æ–‡ä»¶å†…å®¹ï¼š")
if path.exists() and path.is_file():
    content = path.read_text()
    print(f"æ–‡ä»¶å†…å®¹: {content}")

# å†™å…¥æ–‡ä»¶å†…å®¹
print("\nä½¿ç”¨Pathå¯¹è±¡å†™å…¥æ–‡ä»¶å†…å®¹ï¼š")
new_path = Path(dir_path) / "new_file.txt"
new_path.write_text("ä½¿ç”¨Pathå¯¹è±¡å†™å…¥çš„å†…å®¹\n")
print(f"å†™å…¥æ–‡ä»¶ {new_path} æˆåŠŸ")

# æ£€æŸ¥å†™å…¥çš„æ–‡ä»¶
if new_path.exists():
    content = new_path.read_text()
    print(f"æ–‡ä»¶å†…å®¹: {content}")

# éå†ç›®å½•
print("\nä½¿ç”¨Pathå¯¹è±¡éå†ç›®å½•ï¼š")
dir_path_obj = Path(dir_path)
if dir_path_obj.exists() and dir_path_obj.is_dir():
    print(f"ç›®å½• {dir_path} ä¸­çš„æ–‡ä»¶ï¼š")
    for item in dir_path_obj.iterdir():
        print(f"  {item.name} - {'æ–‡ä»¶' if item.is_file() else 'ç›®å½•'}")

# 4. æ¸…ç†æµ‹è¯•æ–‡ä»¶å’Œç›®å½•
print("\næ¸…ç†æµ‹è¯•æ–‡ä»¶å’Œç›®å½•ï¼š")

# åˆ é™¤æ–‡ä»¶
if os.path.exists(file_path):
    os.remove(file_path)
    print(f"åˆ é™¤æ–‡ä»¶ {file_path}")

# åˆ é™¤ç›®å½•åŠå…¶å†…å®¹
if os.path.exists(dir_path):
    shutil.rmtree(dir_path)
    print(f"åˆ é™¤ç›®å½• {dir_path} åŠå…¶å†…å®¹")</code></pre><h3>5. æ–‡ä»¶I/Oæ“ä½œçš„æœ€ä½³å®è·µ</h3><p>æ–‡ä»¶I/Oæ“ä½œæ˜¯Pythonç¼–ç¨‹ä¸­çš„å¸¸è§æ“ä½œï¼Œéµå¾ªä»¥ä¸‹æœ€ä½³å®è·µå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€å¯é æ€§å’Œæ€§èƒ½ã€‚</p><h4>5.1 ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨</h4><p>ä½¿ç”¨<code>with</code>è¯­å¥ï¼ˆä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼‰æ¥æ‰“å¼€æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿æ–‡ä»¶åœ¨ä½¿ç”¨å®Œæ¯•åè‡ªåŠ¨å…³é—­ï¼Œé¿å…èµ„æºæ³„éœ²ï¼š</p><pre><code class="python"># æ¨èä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨
with open("file.txt", "r") as f:
    content = f.read()
# æ–‡ä»¶ä¼šè‡ªåŠ¨å…³é—­

# ä¸æ¨èçš„æ–¹å¼
f = open("file.txt", "r")
content = f.read()
f.close()  # éœ€è¦æ‰‹åŠ¨å…³é—­</code></pre><h4>5.2 æŒ‡å®šç¼–ç </h4><p>åœ¨å¤„ç†æ–‡æœ¬æ–‡ä»¶æ—¶ï¼Œåº”è¯¥æ˜¾å¼æŒ‡å®šç¼–ç ï¼Œä»¥é¿å…ç¼–ç é”™è¯¯ï¼š</p><pre><code class="python"># æ¨èæŒ‡å®šç¼–ç 
with open("file.txt", "r", encoding="utf-8") as f:
    content = f.read()

# ä¸æ¨èçš„æ–¹å¼ï¼ˆä¾èµ–ç³»ç»Ÿé»˜è®¤ç¼–ç ï¼‰
with open("file.txt", "r") as f:
    content = f.read()</code></pre><h4>5.3 å¤„ç†å¤§æ–‡ä»¶</h4><p>å¤„ç†å¤§æ–‡ä»¶æ—¶ï¼Œåº”è¯¥é€è¡Œè¯»å–ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§è¯»å–æ•´ä¸ªæ–‡ä»¶ï¼Œä»¥é¿å…å†…å­˜ä¸è¶³ï¼š</p><pre><code class="python"># æ¨èé€è¡Œè¯»å–å¤§æ–‡ä»¶
with open("large_file.txt", "r") as f:
    for line in f:
        # å¤„ç†æ¯ä¸€è¡Œ
        process_line(line)

# ä¸æ¨èçš„æ–¹å¼ï¼ˆå¯èƒ½å¯¼è‡´å†…å­˜ä¸è¶³ï¼‰
with open("large_file.txt", "r") as f:
    content = f.read()  # ä¸€æ¬¡æ€§è¯»å–æ•´ä¸ªæ–‡ä»¶
    # å¤„ç†å†…å®¹</code></pre><h4>5.4 é”™è¯¯å¤„ç†</h4><p>åœ¨æ–‡ä»¶æ“ä½œä¸­ï¼Œåº”è¯¥æ·»åŠ é”™è¯¯å¤„ç†ï¼Œä»¥æé«˜ä»£ç çš„å¥å£®æ€§ï¼š</p><pre><code class="python"># æ¨èæ·»åŠ é”™è¯¯å¤„ç†
try:
    with open("file.txt", "r") as f:
        content = f.read()
except FileNotFoundError:
    print("æ–‡ä»¶ä¸å­˜åœ¨")
except PermissionError:
    print("æ²¡æœ‰æƒé™è¯»å–æ–‡ä»¶")
except Exception as e:
    print(f"å‘ç”Ÿé”™è¯¯: {e}")

# ä¸æ¨èçš„æ–¹å¼ï¼ˆæ²¡æœ‰é”™è¯¯å¤„ç†ï¼‰
with open("file.txt", "r") as f:
    content = f.read()</code></pre><h4>5.5 ç¼“å†²åŒºç®¡ç†</h4><p>æ ¹æ®æ–‡ä»¶æ“ä½œçš„ç‰¹ç‚¹ï¼Œé€‰æ‹©åˆé€‚çš„ç¼“å†²æ¨¡å¼å’Œç¼“å†²åŒºå¤§å°ï¼š</p><ul><li><strong>å°æ–‡ä»¶</strong>ï¼šå¯ä»¥ä½¿ç”¨é»˜è®¤ç¼“å†²æ¨¡å¼</li><li><strong>å¤§æ–‡ä»¶</strong>ï¼šå¯ä»¥ä½¿ç”¨è¾ƒå¤§çš„ç¼“å†²åŒºå¤§å°</li><li><strong>å®æ—¶æ€§è¦æ±‚é«˜çš„æ“ä½œ</strong>ï¼šå¯ä»¥ä½¿ç”¨è¾ƒå°çš„ç¼“å†²åŒºå¤§å°æˆ–æ— ç¼“å†²</li></ul><h4>5.6 æ–‡ä»¶è·¯å¾„å¤„ç†</h4><p>ä½¿ç”¨<code>os.path</code>æˆ–<code>pathlib</code>æ¨¡å—æ¥å¤„ç†æ–‡ä»¶è·¯å¾„ï¼Œä»¥æé«˜ä»£ç çš„å¯ç§»æ¤æ€§ï¼š</p><pre><code class="python"># æ¨èä½¿ç”¨os.path
import os
file_path = os.path.join("dir", "file.txt")

# æ¨èä½¿ç”¨pathlib
from pathlib import Path
file_path = Path("dir") / "file.txt"

# ä¸æ¨èçš„æ–¹å¼ï¼ˆç¡¬ç¼–ç è·¯å¾„åˆ†éš”ç¬¦ï¼‰
file_path = "dir/file.txt"  # åœ¨Windowsä¸Šå¯èƒ½æœ‰é—®é¢˜</code></pre><h4>5.7 æ–‡ä»¶æ“ä½œçš„æ€§èƒ½ä¼˜åŒ–</h4><p>æ–‡ä»¶æ“ä½œçš„æ€§èƒ½ä¼˜åŒ–å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢å…¥æ‰‹ï¼š</p><ul><li><strong>é€‰æ‹©åˆé€‚çš„ç¼“å†²æ¨¡å¼</strong>ï¼šæ ¹æ®æ–‡ä»¶å¤§å°å’Œæ“ä½œç±»å‹é€‰æ‹©åˆé€‚çš„ç¼“å†²æ¨¡å¼</li><li><strong>å‡å°‘æ–‡ä»¶I/Oæ“ä½œçš„æ¬¡æ•°</strong>ï¼šæ‰¹é‡è¯»å–å’Œå†™å…¥æ•°æ®</li><li><strong>ä½¿ç”¨å†…å­˜æ˜ å°„</strong>ï¼šå¯¹äºå¤§æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨<code>mmap</code>æ¨¡å—è¿›è¡Œå†…å­˜æ˜ å°„</li><li><strong>ä½¿ç”¨å¼‚æ­¥I/O</strong>ï¼šå¯¹äºI/Oå¯†é›†å‹æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨å¼‚æ­¥I/O</li><li><strong>é¿å…é¢‘ç¹çš„æ–‡ä»¶æ‰“å¼€å’Œå…³é—­</strong>ï¼šå°½é‡å‡å°‘æ–‡ä»¶æ‰“å¼€å’Œå…³é—­çš„æ¬¡æ•°</li></ul><pre><code class="python"># æ–‡ä»¶I/Oæ“ä½œçš„æœ€ä½³å®è·µç¤ºä¾‹

import os
from pathlib import Path
import mmap

# 1. ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨
print("ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç¤ºä¾‹ï¼š")

print("\næ¨èçš„æ–¹å¼ï¼š")
with open("best_practice.txt", "w", encoding="utf-8") as f:
    f.write("Hello, Best Practice!\n")
print("æ–‡ä»¶æ“ä½œå®Œæˆï¼Œæ–‡ä»¶å·²è‡ªåŠ¨å…³é—­")

# 2. æŒ‡å®šç¼–ç 
print("\næŒ‡å®šç¼–ç ç¤ºä¾‹ï¼š")

print("\næ¨èçš„æ–¹å¼ï¼š")
with open("encoding.txt", "w", encoding="utf-8") as f:
    f.write("ä½ å¥½ï¼ŒPythonï¼\n")
print("å†™å…¥UTF-8ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶æˆåŠŸ")

with open("encoding.txt", "r", encoding="utf-8") as f:
    content = f.read()
    print(f"è¯»å–æ–‡ä»¶å†…å®¹: {content}")

# 3. å¤„ç†å¤§æ–‡ä»¶
print("\nå¤„ç†å¤§æ–‡ä»¶ç¤ºä¾‹ï¼š")

# åˆ›å»ºä¸€ä¸ªå¤§æ–‡ä»¶
print("åˆ›å»ºå¤§æ–‡ä»¶...")
with open("large_file.txt", "w") as f:
    for i in range(10000):
        f.write(f"Line {i}: This is a test line for large file.\n")
print("åˆ›å»ºå¤§æ–‡ä»¶æˆåŠŸ")

# é€è¡Œè¯»å–å¤§æ–‡ä»¶
print("\né€è¡Œè¯»å–å¤§æ–‡ä»¶ï¼š")
line_count = 0
with open("large_file.txt", "r") as f:
    for line in f:
        line_count += 1
        # æ¯1000è¡Œæ‰“å°ä¸€æ¬¡
        if line_count % 1000 == 0:
            print(f"å·²è¯»å– {line_count} è¡Œ")
print(f"æ–‡ä»¶æ€»è¡Œæ•°: {line_count}")

# 4. é”™è¯¯å¤„ç†
print("\né”™è¯¯å¤„ç†ç¤ºä¾‹ï¼š")

print("\næ¨èçš„æ–¹å¼ï¼š")
try:
    with open("non_existent_file.txt", "r") as f:
        content = f.read()
except FileNotFoundError:
    print("é”™è¯¯ï¼šæ–‡ä»¶ä¸å­˜åœ¨")
except PermissionError:
    print("é”™è¯¯ï¼šæ²¡æœ‰æƒé™è¯»å–æ–‡ä»¶")
except Exception as e:
    print(f"é”™è¯¯ï¼š{e}")

# 5. æ–‡ä»¶è·¯å¾„å¤„ç†
print("\næ–‡ä»¶è·¯å¾„å¤„ç†ç¤ºä¾‹ï¼š")

print("\nä½¿ç”¨os.pathï¼š")
dir_name = "data"
file_name = "results.txt"
file_path = os.path.join(dir_name, file_name)
print(f"æ‹¼æ¥çš„è·¯å¾„: {file_path}")

print("\nä½¿ç”¨pathlibï¼š")
dir_path = Path("data")
file_path = dir_path / "results.txt"
print(f"æ‹¼æ¥çš„è·¯å¾„: {file_path}")
print(f"ç»å¯¹è·¯å¾„: {file_path.absolute()}")

# åˆ›å»ºç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
dir_path.mkdir(exist_ok=True)
print(f"åˆ›å»ºç›®å½• {dir_path} æˆåŠŸ")

# 6. å†…å­˜æ˜ å°„ç¤ºä¾‹
print("\nå†…å­˜æ˜ å°„ç¤ºä¾‹ï¼š")

print("ä½¿ç”¨å†…å­˜æ˜ å°„è¯»å–æ–‡ä»¶ï¼š")
with open("large_file.txt", "r+") as f:
    # åˆ›å»ºå†…å­˜æ˜ å°„
    with mmap.mmap(f.fileno(), length=0, access=mmap.ACCESS_READ) as mm:
        # è¯»å–å†…å­˜æ˜ å°„çš„å†…å®¹
        content = mm.read(100)
        print(f"å†…å­˜æ˜ å°„è¯»å–çš„å‰100ä¸ªå­—ç¬¦: '{content.decode('utf-8')}'")
        
        # æŸ¥æ‰¾å†…å®¹
        position = mm.find(b"Line 1000")
        if position != -1:
            mm.seek(position)
            line = mm.readline()
            print(f"æ‰¾åˆ°çš„è¡Œ: '{line.decode('utf-8').rstrip()}'")

# 7. æ¸…ç†æµ‹è¯•æ–‡ä»¶å’Œç›®å½•
print("\næ¸…ç†æµ‹è¯•æ–‡ä»¶å’Œç›®å½•ï¼š")

for file in ["best_practice.txt", "encoding.txt", "large_file.txt"]:
    if os.path.exists(file):
        os.remove(file)
        print(f"åˆ é™¤æ–‡ä»¶ {file}")

if os.path.exists(dir_name):
    import shutil
    shutil.rmtree(dir_name)
    print(f"åˆ é™¤ç›®å½• {dir_name}")</code></pre><h3>6. é«˜çº§æ–‡ä»¶I/Oæ“ä½œ</h3><p>Pythonæä¾›äº†ä¸€äº›é«˜çº§æ–‡ä»¶I/Oæ“ä½œï¼Œç”¨äºå¤„ç†ç‰¹æ®Šçš„æ–‡ä»¶æ“ä½œåœºæ™¯ã€‚</p><h4>6.1 ä¸´æ—¶æ–‡ä»¶</h4><p>ä¸´æ—¶æ–‡ä»¶æ˜¯åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åˆ›å»ºçš„ä¸´æ—¶å­˜å‚¨æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨ä¸­é—´æ•°æ®ã€‚Pythonçš„<code>tempfile</code>æ¨¡å—æä¾›äº†åˆ›å»ºä¸´æ—¶æ–‡ä»¶å’Œç›®å½•çš„åŠŸèƒ½ï¼š</p><ul><li><strong><code>tempfile.TemporaryFile()</code></strong>ï¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œå…³é—­åè‡ªåŠ¨åˆ é™¤</li><li><strong><code>tempfile.NamedTemporaryFile()</code></strong>ï¼šåˆ›å»ºå‘½åä¸´æ—¶æ–‡ä»¶</li><li><strong><code>tempfile.TemporaryDirectory()</code></strong>ï¼šåˆ›å»ºä¸´æ—¶ç›®å½•</li></ul><h4>6.2 æ–‡ä»¶é”</h4><p>æ–‡ä»¶é”ç”¨äºåœ¨å¤šè¿›ç¨‹ç¯å¢ƒä¸­åŒæ­¥å¯¹æ–‡ä»¶çš„è®¿é—®ï¼Œé¿å…å¹¶å‘è®¿é—®å¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´ã€‚Pythonçš„<code>fcntl</code>æ¨¡å—ï¼ˆåœ¨Unixç³»ç»Ÿä¸Šï¼‰å’Œ<code>msvcrt</code>æ¨¡å—ï¼ˆåœ¨Windowsç³»ç»Ÿä¸Šï¼‰æä¾›äº†æ–‡ä»¶é”åŠŸèƒ½ã€‚</p><h4>6.3 å†…å­˜æ–‡ä»¶å¯¹è±¡</h4><p>å†…å­˜æ–‡ä»¶å¯¹è±¡æ˜¯åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿçš„æ–‡ä»¶å¯¹è±¡ï¼Œç”¨äºåœ¨ä¸ä½¿ç”¨å®é™…æ–‡ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œæ–‡ä»¶æ“ä½œã€‚Pythonçš„<code>io</code>æ¨¡å—æä¾›äº†å†…å­˜æ–‡ä»¶å¯¹è±¡çš„åŠŸèƒ½ï¼š</p><ul><li><strong><code>io.StringIO()</code></strong>ï¼šç”¨äºå¤„ç†æ–‡æœ¬æ•°æ®çš„å†…å­˜æ–‡ä»¶å¯¹è±¡</li><li><strong><code>io.BytesIO()</code></strong>ï¼šç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„å†…å­˜æ–‡ä»¶å¯¹è±¡</li></ul><h4>6.4 å‹ç¼©æ–‡ä»¶</h4><p>Pythonçš„<code>gzip</code>ã€<code>bz2</code>ã€<code>lzma</code>ç­‰æ¨¡å—æä¾›äº†å‹ç¼©æ–‡ä»¶çš„è¯»å†™åŠŸèƒ½ï¼š</p><ul><li><strong><code>gzip.open()</code></strong>ï¼šè¯»å†™gzipå‹ç¼©æ–‡ä»¶</li><li><strong><code>bz2.open()</code></strong>ï¼šè¯»å†™bz2å‹ç¼©æ–‡ä»¶</li><li><strong><code>lzma.open()</code></strong>ï¼šè¯»å†™lzmaå‹ç¼©æ–‡ä»¶</li></ul><h4>6.5 é«˜çº§æ–‡ä»¶I/Oæ“ä½œçš„ç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯é«˜çº§æ–‡ä»¶I/Oæ“ä½œçš„ä¸€äº›ç¤ºä¾‹ï¼š</p><pre><code class="python"># é«˜çº§æ–‡ä»¶I/Oæ“ä½œç¤ºä¾‹

import tempfile
import io
import gzip
import os

# 1. ä¸´æ—¶æ–‡ä»¶ç¤ºä¾‹
print("ä¸´æ—¶æ–‡ä»¶ç¤ºä¾‹ï¼š")

print("\nä½¿ç”¨TemporaryFileï¼š")
with tempfile.TemporaryFile(mode='w+') as f:
    # å†™å…¥æ•°æ®
    f.write("è¿™æ˜¯ä¸´æ—¶æ–‡ä»¶çš„å†…å®¹\n")
    f.write("ä¸´æ—¶æ–‡ä»¶ä¼šåœ¨å…³é—­åè‡ªåŠ¨åˆ é™¤\n")
    
    # ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æ–‡ä»¶å¼€å¤´
    f.seek(0)
    
    # è¯»å–æ•°æ®
    content = f.read()
    print(f"ä¸´æ—¶æ–‡ä»¶å†…å®¹ï¼š\n{content}")
print("ä¸´æ—¶æ–‡ä»¶å·²å…³é—­å¹¶è‡ªåŠ¨åˆ é™¤")

print("\nä½¿ç”¨NamedTemporaryFileï¼š")
with tempfile.NamedTemporaryFile(mode='w+', delete=False) as f:
    # å†™å…¥æ•°æ®
    f.write("è¿™æ˜¯å‘½åä¸´æ—¶æ–‡ä»¶çš„å†…å®¹\n")
    temp_file_name = f.name
    print(f"ä¸´æ—¶æ–‡ä»¶åç§°ï¼š{temp_file_name}")

# æ£€æŸ¥ä¸´æ—¶æ–‡ä»¶æ˜¯å¦å­˜åœ¨
print(f"ä¸´æ—¶æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š{os.path.exists(temp_file_name)}")

# è¯»å–ä¸´æ—¶æ–‡ä»¶
with open(temp_file_name, "r") as f:
    content = f.read()
    print(f"ä¸´æ—¶æ–‡ä»¶å†…å®¹ï¼š\n{content}")

# åˆ é™¤ä¸´æ—¶æ–‡ä»¶
os.unlink(temp_file_name)
print(f"åˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼š{temp_file_name}")
print(f"ä¸´æ—¶æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š{os.path.exists(temp_file_name)}")

print("\nä½¿ç”¨TemporaryDirectoryï¼š")
with tempfile.TemporaryDirectory() as temp_dir:
    print(f"ä¸´æ—¶ç›®å½•ï¼š{temp_dir}")
    
    # åœ¨ä¸´æ—¶ç›®å½•ä¸­åˆ›å»ºæ–‡ä»¶
    temp_file = os.path.join(temp_dir, "test.txt")
    with open(temp_file, "w") as f:
        f.write("ä¸´æ—¶ç›®å½•ä¸­çš„æ–‡ä»¶\n")
    
    # è¯»å–æ–‡ä»¶
    with open(temp_file, "r") as f:
        content = f.read()
        print(f"æ–‡ä»¶å†…å®¹ï¼š{content}")
print("ä¸´æ—¶ç›®å½•å·²å…³é—­å¹¶è‡ªåŠ¨åˆ é™¤")

# 2. å†…å­˜æ–‡ä»¶å¯¹è±¡ç¤ºä¾‹
print("\nå†…å­˜æ–‡ä»¶å¯¹è±¡ç¤ºä¾‹ï¼š")

print("\nä½¿ç”¨StringIOï¼š")
# åˆ›å»ºStringIOå¯¹è±¡
string_io = io.StringIO()

# å†™å…¥æ•°æ®
string_io.write("è¿™æ˜¯StringIOçš„å†…å®¹\n")
string_io.write("StringIOæ˜¯åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿçš„æ–‡ä»¶å¯¹è±¡\n")

# ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æ–‡ä»¶å¼€å¤´
string_io.seek(0)

# è¯»å–æ•°æ®
content = string_io.read()
print(f"StringIOå†…å®¹ï¼š\n{content}")

# å…³é—­StringIO
string_io.close()

print("\nä½¿ç”¨BytesIOï¼š")
# åˆ›å»ºBytesIOå¯¹è±¡
bytes_io = io.BytesIO()

# å†™å…¥æ•°æ®
bytes_io.write(b"è¿™æ˜¯BytesIOçš„å†…å®¹\n")
bytes_io.write(b"BytesIOç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®\n")

# ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æ–‡ä»¶å¼€å¤´
bytes_io.seek(0)

# è¯»å–æ•°æ®
content = bytes_io.read()
print(f"BytesIOå†…å®¹ï¼š\n{content.decode('utf-8')}")

# å…³é—­BytesIO
bytes_io.close()

# 3. å‹ç¼©æ–‡ä»¶ç¤ºä¾‹
print("\nå‹ç¼©æ–‡ä»¶ç¤ºä¾‹ï¼š")

# åˆ›å»ºgzipå‹ç¼©æ–‡ä»¶
print("\nåˆ›å»ºgzipå‹ç¼©æ–‡ä»¶ï¼š")
with gzip.open("compressed_file.txt.gz", "wb") as f:
    f.write(b"è¿™æ˜¯å‹ç¼©æ–‡ä»¶çš„å†…å®¹\n")
    f.write(b"gzipæ¨¡å—ç”¨äºå¤„ç†gzipå‹ç¼©æ–‡ä»¶\n")
print("åˆ›å»ºgzipå‹ç¼©æ–‡ä»¶æˆåŠŸ")

# è¯»å–gzipå‹ç¼©æ–‡ä»¶
print("\nè¯»å–gzipå‹ç¼©æ–‡ä»¶ï¼š")
with gzip.open("compressed_file.txt.gz", "rb") as f:
    content = f.read()
    print(f"å‹ç¼©æ–‡ä»¶å†…å®¹ï¼š\n{content.decode('utf-8')}")

# 4. æ–‡ä»¶é”ç¤ºä¾‹ï¼ˆUnixç³»ç»Ÿï¼‰
print("\næ–‡ä»¶é”ç¤ºä¾‹ï¼š")

print("æ³¨æ„ï¼šæ–‡ä»¶é”ç¤ºä¾‹åœ¨Windowsç³»ç»Ÿä¸Šå¯èƒ½éœ€è¦ä½¿ç”¨ä¸åŒçš„å®ç°")
try:
    import fcntl
    
    # åˆ›å»ºä¸€ä¸ªæ–‡ä»¶
    with open("locked_file.txt", "w") as f:
        f.write("è¿™æ˜¯ä¸€ä¸ªéœ€è¦åŠ é”çš„æ–‡ä»¶\n")
    
    # æ‰“å¼€æ–‡ä»¶å¹¶åŠ é”
    print("\næ‰“å¼€æ–‡ä»¶å¹¶åŠ é”ï¼š")
    with open("locked_file.txt", "r+") as f:
        # è·å–æ–‡ä»¶é”
        print("è·å–æ–‡ä»¶é”...")
        fcntl.flock(f, fcntl.LOCK_EX)  # æ’ä»–é”
        print("è·å–æ–‡ä»¶é”æˆåŠŸ")
        
        # è¯»å–æ–‡ä»¶å†…å®¹
        content = f.read()
        print(f"æ–‡ä»¶å†…å®¹ï¼š{content}")
        
        # å†™å…¥æ•°æ®
        f.seek(0)
        f.write("è¿™æ˜¯åŠ é”åä¿®æ”¹çš„å†…å®¹\n")
        f.truncate()
        print("ä¿®æ”¹æ–‡ä»¶å†…å®¹æˆåŠŸ")
        
        # é‡Šæ”¾æ–‡ä»¶é”
        print("é‡Šæ”¾æ–‡ä»¶é”...")
        fcntl.flock(f, fcntl.LOCK_UN)
        print("é‡Šæ”¾æ–‡ä»¶é”æˆåŠŸ")
        
except ImportError:
    print("fcntlæ¨¡å—åœ¨Windowsç³»ç»Ÿä¸Šä¸å¯ç”¨")
except Exception as e:
    print(f"æ–‡ä»¶é”æ“ä½œå¤±è´¥ï¼š{e}")

# 5. æ¸…ç†æµ‹è¯•æ–‡ä»¶
print("\næ¸…ç†æµ‹è¯•æ–‡ä»¶ï¼š")

for file in ["compressed_file.txt.gz", "locked_file.txt"]:
    if os.path.exists(file):
        os.remove(file)
        print(f"åˆ é™¤æ–‡ä»¶ {file}")</code></pre><h3>7. å¸¸è§æ–‡ä»¶I/Oé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3><p>åœ¨Pythonæ–‡ä»¶I/Oæ“ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å„ç§é—®é¢˜ã€‚ç†è§£è¿™äº›é—®é¢˜çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆå¯¹äºæé«˜å¼€å‘æ•ˆç‡è‡³å…³é‡è¦ã€‚</p><h4>7.1 å¸¸è§é—®é¢˜</h4><ul><li><strong>æ–‡ä»¶ä¸å­˜åœ¨</strong>ï¼šå°è¯•æ‰“å¼€ä¸å­˜åœ¨çš„æ–‡ä»¶</li><li><strong>æƒé™é”™è¯¯</strong>ï¼šæ²¡æœ‰è¯»å–æˆ–å†™å…¥æ–‡ä»¶çš„æƒé™</li><li><strong>ç¼–ç é”™è¯¯</strong>ï¼šæ–‡ä»¶ç¼–ç ä¸æŒ‡å®šçš„ç¼–ç ä¸åŒ¹é…</li><li><strong>å†…å­˜ä¸è¶³</strong>ï¼šå°è¯•ä¸€æ¬¡æ€§è¯»å–å¤§æ–‡ä»¶åˆ°å†…å­˜</li><li><strong>æ–‡ä»¶è¢«å ç”¨</strong>ï¼šæ–‡ä»¶è¢«å…¶ä»–è¿›ç¨‹å ç”¨</li><li><strong>è·¯å¾„é”™è¯¯</strong>ï¼šæ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®</li><li><strong>ç¼“å†²åŒºæœªåˆ·æ–°</strong>ï¼šæ•°æ®æœªåŠæ—¶å†™å…¥æ–‡ä»¶</li><li><strong>æ–‡ä»¶æŒ‡é’ˆä½ç½®é”™è¯¯</strong>ï¼šæ–‡ä»¶æŒ‡é’ˆä½ç½®ä¸æ­£ç¡®å¯¼è‡´è¯»å†™é”™è¯¯</li></ul><h4>7.2 è§£å†³æ–¹æ¡ˆ</h4><h5>7.2.1 æ–‡ä»¶ä¸å­˜åœ¨</h5><p><strong>é—®é¢˜</strong>ï¼šå°è¯•æ‰“å¼€ä¸å­˜åœ¨çš„æ–‡ä»¶ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>ä½¿ç”¨<code>os.path.exists()</code>æˆ–<code>Path.exists()</code>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</li><li>ä½¿ç”¨<code>try-except</code>å—æ•è·<code>FileNotFoundError</code>å¼‚å¸¸</li><li>åœ¨å†™å…¥æ¨¡å¼ä¸‹ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º</li></ul><h5>7.2.2 æƒé™é”™è¯¯</h5><p><strong>é—®é¢˜</strong>ï¼šæ²¡æœ‰è¯»å–æˆ–å†™å…¥æ–‡ä»¶çš„æƒé™ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>æ£€æŸ¥æ–‡ä»¶çš„æƒé™è®¾ç½®</li><li>ä½¿ç”¨<code>try-except</code>å—æ•è·<code>PermissionError</code>å¼‚å¸¸</li><li>ç¡®ä¿ä»¥æ­£ç¡®çš„ç”¨æˆ·èº«ä»½è¿è¡Œç¨‹åº</li></ul><h5>7.2.3 ç¼–ç é”™è¯¯</h5><p><strong>é—®é¢˜</strong>ï¼šæ–‡ä»¶ç¼–ç ä¸æŒ‡å®šçš„ç¼–ç ä¸åŒ¹é…ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>æ˜¾å¼æŒ‡å®šæ­£ç¡®çš„ç¼–ç </li><li>ä½¿ç”¨<code>try-except</code>å—æ•è·<code>UnicodeDecodeError</code>æˆ–<code>UnicodeEncodeError</code>å¼‚å¸¸</li><li>ä½¿ç”¨<code>chardet</code>åº“æ£€æµ‹æ–‡ä»¶çš„ç¼–ç </li></ul><h5>7.2.4 å†…å­˜ä¸è¶³</h5><p><strong>é—®é¢˜</strong>ï¼šå°è¯•ä¸€æ¬¡æ€§è¯»å–å¤§æ–‡ä»¶åˆ°å†…å­˜ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>é€è¡Œè¯»å–æ–‡ä»¶</li><li>ä½¿ç”¨ç”Ÿæˆå™¨å¤„ç†å¤§æ–‡ä»¶</li><li>ä½¿ç”¨å†…å­˜æ˜ å°„ï¼ˆ<code>mmap</code>ï¼‰å¤„ç†å¤§æ–‡ä»¶</li></ul><h5>7.2.5 æ–‡ä»¶è¢«å ç”¨</h5><p><strong>é—®é¢˜</strong>ï¼šæ–‡ä»¶è¢«å…¶ä»–è¿›ç¨‹å ç”¨ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>ç¡®ä¿å…¶ä»–è¿›ç¨‹å·²é‡Šæ”¾æ–‡ä»¶</li><li>ä½¿ç”¨æ–‡ä»¶é”æœºåˆ¶</li><li>ç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•</li></ul><h5>7.2.6 è·¯å¾„é”™è¯¯</h5><p><strong>é—®é¢˜</strong>ï¼šæ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>ä½¿ç”¨<code>os.path</code>æˆ–<code>pathlib</code>æ¨¡å—å¤„ç†è·¯å¾„</li><li>æ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨</li><li>ä½¿ç”¨ç»å¯¹è·¯å¾„è€Œä¸æ˜¯ç›¸å¯¹è·¯å¾„</li></ul><h5>7.2.7 ç¼“å†²åŒºæœªåˆ·æ–°</h5><p><strong>é—®é¢˜</strong>ï¼šæ•°æ®æœªåŠæ—¶å†™å…¥æ–‡ä»¶ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>ä½¿ç”¨<code>flush()</code>æ–¹æ³•æ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒº</li><li>ä½¿ç”¨<code>close()</code>æ–¹æ³•å…³é—­æ–‡ä»¶ï¼Œè‡ªåŠ¨åˆ·æ–°ç¼“å†²åŒº</li><li>ä½¿ç”¨<code>with</code>è¯­å¥ï¼Œé€€å‡ºæ—¶è‡ªåŠ¨å…³é—­æ–‡ä»¶</li></ul><h5>7.2.8 æ–‡ä»¶æŒ‡é’ˆä½ç½®é”™è¯¯</h5><p><strong>é—®é¢˜</strong>ï¼šæ–‡ä»¶æŒ‡é’ˆä½ç½®ä¸æ­£ç¡®å¯¼è‡´è¯»å†™é”™è¯¯ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li>ä½¿ç”¨<code>tell()</code>æ–¹æ³•æŸ¥çœ‹å½“å‰æ–‡ä»¶æŒ‡é’ˆä½ç½®</li><li>ä½¿ç”¨<code>seek()</code>æ–¹æ³•ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æ­£ç¡®ä½ç½®</li><li>æ³¨æ„æ–‡ä»¶æ“ä½œæ¨¡å¼å¯¹æ–‡ä»¶æŒ‡é’ˆä½ç½®çš„å½±å“</li></ul><h4>7.3 ç¤ºä¾‹ï¼šè§£å†³å¸¸è§æ–‡ä»¶I/Oé—®é¢˜</h4><pre><code class="python"># å¸¸è§æ–‡ä»¶I/Oé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆç¤ºä¾‹

import os
from pathlib import Path
import chardet

# 1. æ–‡ä»¶ä¸å­˜åœ¨
print("æ–‡ä»¶ä¸å­˜åœ¨é—®é¢˜è§£å†³æ–¹æ¡ˆï¼š")

print("\næ–¹æ³•1ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨")
file_path = "non_existent_file.txt"
if os.path.exists(file_path):
    with open(file_path, "r") as f:
        content = f.read()
    print(f"æ–‡ä»¶å†…å®¹ï¼š{content}")
else:
    print(f"æ–‡ä»¶ {file_path} ä¸å­˜åœ¨")

print("\næ–¹æ³•2ï¼šä½¿ç”¨try-exceptæ•è·å¼‚å¸¸")
try:
    with open(file_path, "r") as f:
        content = f.read()
    print(f"æ–‡ä»¶å†…å®¹ï¼š{content}")
except FileNotFoundError:
    print(f"é”™è¯¯ï¼šæ–‡ä»¶ {file_path} ä¸å­˜åœ¨")

# 2. ç¼–ç é”™è¯¯
print("\nç¼–ç é”™è¯¯é—®é¢˜è§£å†³æ–¹æ¡ˆï¼š")

# åˆ›å»ºä¸€ä¸ªUTF-8ç¼–ç çš„æ–‡ä»¶
with open("utf8_file.txt", "w", encoding="utf-8") as f:
    f.write("ä½ å¥½ï¼ŒPythonï¼\n")
print("åˆ›å»ºUTF-8ç¼–ç çš„æ–‡ä»¶æˆåŠŸ")

# å°è¯•ä½¿ç”¨é”™è¯¯çš„ç¼–ç è¯»å–
print("\nå°è¯•ä½¿ç”¨é”™è¯¯çš„ç¼–ç è¯»å–ï¼š")
try:
    with open("utf8_file.txt", "r", encoding="ascii") as f:
        content = f.read()
    print(f"æ–‡ä»¶å†…å®¹ï¼š{content}")
except UnicodeDecodeError as e:
    print(f"ç¼–ç é”™è¯¯ï¼š{e}")

# ä½¿ç”¨æ­£ç¡®çš„ç¼–ç è¯»å–
print("\nä½¿ç”¨æ­£ç¡®çš„ç¼–ç è¯»å–ï¼š")
try:
    with open("utf8_file.txt", "r", encoding="utf-8") as f:
        content = f.read()
    print(f"æ–‡ä»¶å†…å®¹ï¼š{content}")
except Exception as e:
    print(f"é”™è¯¯ï¼š{e}")

# ä½¿ç”¨chardetæ£€æµ‹ç¼–ç 
print("\nä½¿ç”¨chardetæ£€æµ‹ç¼–ç ï¼š")
try:
    with open("utf8_file.txt", "rb") as f:
        raw_data = f.read()
    
    # æ£€æµ‹ç¼–ç 
    result = chardet.detect(raw_data)
    encoding = result["encoding"]
    confidence = result["confidence"]
    
    print(f"æ£€æµ‹åˆ°çš„ç¼–ç ï¼š{encoding}ï¼ˆç½®ä¿¡åº¦ï¼š{confidence:.2f}")
    
    # ä½¿ç”¨æ£€æµ‹åˆ°çš„ç¼–ç è¯»å–
    content = raw_data.decode(encoding)
    print(f"æ–‡ä»¶å†…å®¹ï¼š{content}")
except Exception as e:
    print(f"é”™è¯¯ï¼š{e}")

# 3. å†…å­˜ä¸è¶³
print("\nå†…å­˜ä¸è¶³é—®é¢˜è§£å†³æ–¹æ¡ˆï¼š")

# åˆ›å»ºä¸€ä¸ªå¤§æ–‡ä»¶
print("åˆ›å»ºå¤§æ–‡ä»¶...")
with open("large_file.txt", "w") as f:
    for i in range(50000):
        f.write(f"Line {i}: This is a test line for memory issue.\n")
print("åˆ›å»ºå¤§æ–‡ä»¶æˆåŠŸ")

# é€è¡Œè¯»å–å¤§æ–‡ä»¶
print("\né€è¡Œè¯»å–å¤§æ–‡ä»¶ï¼š")
line_count = 0
with open("large_file.txt", "r") as f:
    for line in f:
        line_count += 1
        if line_count % 10000 == 0:
            print(f"å·²è¯»å– {line_count} è¡Œ")
print(f"æ–‡ä»¶æ€»è¡Œæ•°: {line_count}")

# ä½¿ç”¨ç”Ÿæˆå™¨å¤„ç†å¤§æ–‡ä»¶
print("\nä½¿ç”¨ç”Ÿæˆå™¨å¤„ç†å¤§æ–‡ä»¶ï¼š")
def read_large_file(file_path, chunk_size=1024):
    """ä½¿ç”¨ç”Ÿæˆå™¨è¯»å–å¤§æ–‡ä»¶"""
    with open(file_path, "r") as f:
        while True:
            chunk = f.read(chunk_size)
            if not chunk:
                break
            yield chunk

# ä½¿ç”¨ç”Ÿæˆå™¨è¯»å–æ–‡ä»¶
char_count = 0
for chunk in read_large_file("large_file.txt"):
    char_count += len(chunk)
print(f"æ–‡ä»¶æ€»å­—ç¬¦æ•°: {char_count}")

# 4. è·¯å¾„é”™è¯¯
print("\nè·¯å¾„é”™è¯¯é—®é¢˜è§£å†³æ–¹æ¡ˆï¼š")

# ä½¿ç”¨os.pathå¤„ç†è·¯å¾„
print("\nä½¿ç”¨os.pathå¤„ç†è·¯å¾„ï¼š")
dir_name = "data"
file_name = "results.txt"

# åˆ›å»ºç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
if not os.path.exists(dir_name):
    os.makedirs(dir_name)
    print(f"åˆ›å»ºç›®å½• {dir_name} æˆåŠŸ")

# æ‹¼æ¥è·¯å¾„
file_path = os.path.join(dir_name, file_name)
print(f"æ‹¼æ¥çš„è·¯å¾„: {file_path}")
print(f"ç»å¯¹è·¯å¾„: {os.path.abspath(file_path)}")

# å†™å…¥æ–‡ä»¶
with open(file_path, "w") as f:
    f.write("æµ‹è¯•è·¯å¾„å¤„ç†\n")
print(f"å†™å…¥æ–‡ä»¶ {file_path} æˆåŠŸ")

# ä½¿ç”¨pathlibå¤„ç†è·¯å¾„
print("\nä½¿ç”¨pathlibå¤„ç†è·¯å¾„ï¼š")
dir_path = Path("data2")
file_path = dir_path / "results.txt"

# åˆ›å»ºç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
dir_path.mkdir(exist_ok=True)
print(f"åˆ›å»ºç›®å½• {dir_path} æˆåŠŸ")

print(f"æ‹¼æ¥çš„è·¯å¾„: {file_path}")
print(f"ç»å¯¹è·¯å¾„: {file_path.absolute()}")

# å†™å…¥æ–‡ä»¶
file_path.write_text("æµ‹è¯•pathlibè·¯å¾„å¤„ç†\n")
print(f"å†™å…¥æ–‡ä»¶ {file_path} æˆåŠŸ")

# 5. ç¼“å†²åŒºæœªåˆ·æ–°
print("\nç¼“å†²åŒºæœªåˆ·æ–°é—®é¢˜è§£å†³æ–¹æ¡ˆï¼š")

print("\næµ‹è¯•ç¼“å†²åŒºåˆ·æ–°ï¼š")
with open("buffer_test.txt", "w") as f:
    print("å†™å…¥æ•°æ®...")
    f.write("éœ€è¦åˆ·æ–°ç¼“å†²åŒºçš„æ•°æ®\n")
    print("æ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒº...")
    f.flush()  # æ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒº
    print("ç¼“å†²åŒºå·²åˆ·æ–°")

# æ£€æŸ¥æ–‡ä»¶å†…å®¹
with open("buffer_test.txt", "r") as f:
    content = f.read()
    print(f"æ–‡ä»¶å†…å®¹: '{content}'")

# 6. æ¸…ç†æµ‹è¯•æ–‡ä»¶å’Œç›®å½•
print("\næ¸…ç†æµ‹è¯•æ–‡ä»¶å’Œç›®å½•ï¼š")

# åˆ é™¤æ–‡ä»¶
for file in ["utf8_file.txt", "large_file.txt", "buffer_test.txt"]:
    if os.path.exists(file):
        os.remove(file)
        print(f"åˆ é™¤æ–‡ä»¶ {file}")

# åˆ é™¤ç›®å½•
import shutil
for dir_name in ["data", "data2"]:
    if os.path.exists(dir_name):
        shutil.rmtree(dir_name)
        print(f"åˆ é™¤ç›®å½• {dir_name}")</code></pre><h3>8. æ–‡ä»¶I/Oæ€§èƒ½ä¼˜åŒ–</h3><p>æ–‡ä»¶I/Oæ“ä½œæ˜¯ç¨‹åºæ€§èƒ½çš„å¸¸è§ç“¶é¢ˆä¹‹ä¸€ã€‚ç†è§£æ–‡ä»¶I/Oæ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•å¯¹äºæé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡è‡³å…³é‡è¦ã€‚</p><h4>8.1 å½±å“æ–‡ä»¶I/Oæ€§èƒ½çš„å› ç´ </h4><ul><li><strong>ç£ç›˜é€Ÿåº¦</strong>ï¼šæœºæ¢°ç¡¬ç›˜ï¼ˆHDDï¼‰å’Œå›ºæ€ç¡¬ç›˜ï¼ˆSSDï¼‰çš„é€Ÿåº¦å·®å¼‚å¾ˆå¤§</li><li><strong>æ–‡ä»¶å¤§å°</strong>ï¼šå¤§æ–‡ä»¶çš„I/Oæ“ä½œé€šå¸¸æ¯”å°æ–‡ä»¶æ…¢</li><li><strong>ç¼“å†²ç­–ç•¥</strong>ï¼šç¼“å†²åŒºçš„å¤§å°å’Œæ¨¡å¼ä¼šå½±å“I/Oæ€§èƒ½</li><li><strong>I/Oæ¨¡å¼</strong>ï¼šé¡ºåºI/Oé€šå¸¸æ¯”éšæœºI/Oå¿«</li><li><strong>æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼šä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿæœ‰ä¸åŒçš„æ€§èƒ½ç‰¹æ€§</li><li><strong>æ“ä½œç³»ç»Ÿ</strong>ï¼šä¸åŒçš„æ“ä½œç³»ç»Ÿæœ‰ä¸åŒçš„I/Oå¤„ç†æœºåˆ¶</li><li><strong>åº”ç”¨ç¨‹åºè®¾è®¡</strong>ï¼šç¨‹åºçš„I/Oæ“ä½œæ–¹å¼ä¼šå½±å“æ€§èƒ½</li></ul><h4>8.2 æ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•</h4><h5>8.2.1 é€‰æ‹©åˆé€‚çš„ç¼“å†²ç­–ç•¥</h5><ul><li><strong>å¤§æ–‡ä»¶</strong>ï¼šä½¿ç”¨è¾ƒå¤§çš„ç¼“å†²åŒºå¤§å°</li><li><strong>å°æ–‡ä»¶</strong>ï¼šä½¿ç”¨é»˜è®¤çš„ç¼“å†²åŒºå¤§å°</li><li><strong>å®æ—¶æ€§è¦æ±‚é«˜çš„æ“ä½œ</strong>ï¼šä½¿ç”¨è¾ƒå°çš„ç¼“å†²åŒºå¤§å°æˆ–æ— ç¼“å†²</li></ul><h5>8.2.2 å‡å°‘I/Oæ“ä½œçš„æ¬¡æ•°</h5><ul><li><strong>æ‰¹é‡è¯»å†™</strong>ï¼šå°½é‡å‡å°‘è¯»å†™æ“ä½œçš„æ¬¡æ•°ï¼Œæ‰¹é‡å¤„ç†æ•°æ®</li><li><strong>åˆå¹¶å°æ–‡ä»¶</strong>ï¼šå°†å¤šä¸ªå°æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œå‡å°‘æ–‡ä»¶æ‰“å¼€å’Œå…³é—­çš„æ¬¡æ•°</li><li><strong>ä½¿ç”¨å†…å­˜ç¼“å­˜</strong>ï¼šå¯¹äºé¢‘ç¹è®¿é—®çš„æ•°æ®ï¼Œä½¿ç”¨å†…å­˜ç¼“å­˜</li></ul><h5>8.2.3 ä¼˜åŒ–æ–‡ä»¶è®¿é—®æ¨¡å¼</h5><ul><li><strong>é¡ºåºè®¿é—®</strong>ï¼šå°½é‡ä½¿ç”¨é¡ºåºè®¿é—®è€Œä¸æ˜¯éšæœºè®¿é—®</li><li><strong>é¢„è¯»</strong>ï¼šå¯¹äºé¡ºåºè®¿é—®çš„æ–‡ä»¶ï¼Œä½¿ç”¨é¢„è¯»æœºåˆ¶</li><li><strong>å»¶è¿Ÿå†™å…¥</strong>ï¼šå¯¹äºå†™å…¥æ“ä½œï¼Œä½¿ç”¨å»¶è¿Ÿå†™å…¥æœºåˆ¶</li></ul><h5>8.2.4 ä½¿ç”¨é«˜çº§I/OæŠ€æœ¯</h5><ul><li><strong>å†…å­˜æ˜ å°„</strong>ï¼šå¯¹äºå¤§æ–‡ä»¶ï¼Œä½¿ç”¨å†…å­˜æ˜ å°„ï¼ˆ<code>mmap</code>ï¼‰</li><li><strong>å¼‚æ­¥I/O</strong>ï¼šå¯¹äºI/Oå¯†é›†å‹æ“ä½œï¼Œä½¿ç”¨å¼‚æ­¥I/O</li><li><strong>ç›´æ¥I/O</strong>ï¼šå¯¹äºæŸäº›åœºæ™¯ï¼Œä½¿ç”¨ç›´æ¥I/Oç»•è¿‡æ“ä½œç³»ç»Ÿç¼“å†²åŒº</li><li><strong>å¹¶è¡ŒI/O</strong>ï¼šå¯¹äºå¤šä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨å¹¶è¡ŒI/Oæ“ä½œ</li></ul><h5>8.2.5 æ–‡ä»¶ç³»ç»Ÿä¼˜åŒ–</h5><ul><li><strong>é€‰æ‹©åˆé€‚çš„æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼šæ ¹æ®åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–‡ä»¶ç³»ç»Ÿ</li><li><strong>ä¼˜åŒ–æ–‡ä»¶ç³»ç»Ÿå‚æ•°</strong>ï¼šè°ƒæ•´æ–‡ä»¶ç³»ç»Ÿçš„å‚æ•°ä»¥æé«˜æ€§èƒ½</li><li><strong>ä½¿ç”¨RAID</strong>ï¼šå¯¹äºéœ€è¦é«˜æ€§èƒ½çš„åœºæ™¯ï¼Œä½¿ç”¨RAIDæŠ€æœ¯</li></ul><h4>8.3 æ€§èƒ½ä¼˜åŒ–çš„ç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯æ–‡ä»¶I/Oæ€§èƒ½ä¼˜åŒ–çš„ä¸€äº›ç¤ºä¾‹ï¼š</p><pre><code class="python"># æ–‡ä»¶I/Oæ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹

import os
import time
import mmap
import concurrent.futures

# 1. ç¼“å†²åŒºå¤§å°ä¼˜åŒ–
print("ç¼“å†²åŒºå¤§å°ä¼˜åŒ–ç¤ºä¾‹ï¼š")

# åˆ›å»ºæµ‹è¯•æ–‡ä»¶
print("\nåˆ›å»ºæµ‹è¯•æ–‡ä»¶...")
test_file = "performance_test.txt"
with open(test_file, "w") as f:
    for i in range(100000):
        f.write(f"Line {i}: This is a test line for performance optimization.\n")
print("åˆ›å»ºæµ‹è¯•æ–‡ä»¶æˆåŠŸ")

# æµ‹è¯•ä¸åŒç¼“å†²åŒºå¤§å°çš„è¯»å–æ€§èƒ½
def test_read_performance(buffer_size):
    """æµ‹è¯•ä¸åŒç¼“å†²åŒºå¤§å°çš„è¯»å–æ€§èƒ½"""
    start_time = time.time()
    with open(test_file, "r", buffering=buffer_size) as f:
        content = f.read()
    end_time = time.time()
    return end_time - start_time

print("\næµ‹è¯•ä¸åŒç¼“å†²åŒºå¤§å°çš„è¯»å–æ€§èƒ½ï¼š")
buffer_sizes = [1, 4096, 8192, 16384, 32768, 65536]
for size in buffer_sizes:
    try:
        elapsed_time = test_read_performance(size)
        print(f"ç¼“å†²åŒºå¤§å° {size} å­—èŠ‚: {elapsed_time:.4f} ç§’")
    except Exception as e:
        print(f"ç¼“å†²åŒºå¤§å° {size} å­—èŠ‚: æµ‹è¯•å¤±è´¥ - {e}")

# 2. æ‰¹é‡è¯»å†™ä¼˜åŒ–
print("\næ‰¹é‡è¯»å†™ä¼˜åŒ–ç¤ºä¾‹ï¼š")

# æµ‹è¯•é€è¡Œå†™å…¥ä¸æ‰¹é‡å†™å…¥çš„æ€§èƒ½
def test_write_methods():
    """æµ‹è¯•ä¸åŒå†™å…¥æ–¹æ³•çš„æ€§èƒ½"""
    # æµ‹è¯•æ•°æ®
    lines = [f"Line {i}: This is a test line.\n" for i in range(100000)]
    
    # é€è¡Œå†™å…¥
    start_time = time.time()
    with open("line_write.txt", "w") as f:
        for line in lines:
            f.write(line)
    line_write_time = time.time() - start_time
    print(f"é€è¡Œå†™å…¥è€—æ—¶: {line_write_time:.4f} ç§’")
    
    # æ‰¹é‡å†™å…¥
    start_time = time.time()
    with open("batch_write.txt", "w") as f:
        f.writelines(lines)
    batch_write_time = time.time() - start_time
    print(f"æ‰¹é‡å†™å…¥è€—æ—¶: {batch_write_time:.4f} ç§’")
    
    # ä¸€æ¬¡å†™å…¥
    start_time = time.time()
    with open("single_write.txt", "w") as f:
        f.write("".join(lines))
    single_write_time = time.time() - start_time
    print(f"ä¸€æ¬¡å†™å…¥è€—æ—¶: {single_write_time:.4f} ç§’")

test_write_methods()

# 3. å†…å­˜æ˜ å°„ä¼˜åŒ–
print("\nå†…å­˜æ˜ å°„ä¼˜åŒ–ç¤ºä¾‹ï¼š")

# æµ‹è¯•å†…å­˜æ˜ å°„ä¸æ™®é€šè¯»å–çš„æ€§èƒ½
def test_mmap_performance():
    """æµ‹è¯•å†…å­˜æ˜ å°„çš„æ€§èƒ½"""
    # æ™®é€šè¯»å–
    start_time = time.time()
    with open(test_file, "r") as f:
        content = f.read()
    normal_read_time = time.time() - start_time
    print(f"æ™®é€šè¯»å–è€—æ—¶: {normal_read_time:.4f} ç§’")
    
    # å†…å­˜æ˜ å°„è¯»å–
    start_time = time.time()
    with open(test_file, "r") as f:
        with mmap.mmap(f.fileno(), length=0, access=mmap.ACCESS_READ) as mm:
            content = mm.read()
    mmap_read_time = time.time() - start_time
    print(f"å†…å­˜æ˜ å°„è¯»å–è€—æ—¶: {mmap_read_time:.4f} ç§’")

test_mmap_performance()

# 4. å¹¶è¡ŒI/Oä¼˜åŒ–
print("\nå¹¶è¡ŒI/Oä¼˜åŒ–ç¤ºä¾‹ï¼š")

# åˆ›å»ºå¤šä¸ªæµ‹è¯•æ–‡ä»¶
def create_test_files():
    """åˆ›å»ºå¤šä¸ªæµ‹è¯•æ–‡ä»¶"""
    for i in range(5):
        file_name = f"test_file_{i}.txt"
        with open(file_name, "w") as f:
            for j in range(20000):
                f.write(f"File {i}, Line {j}: This is a test line.\n")
    print("åˆ›å»ºæµ‹è¯•æ–‡ä»¶æˆåŠŸ")

create_test_files()

# æµ‹è¯•ä¸²è¡Œè¯»å–ä¸å¹¶è¡Œè¯»å–çš„æ€§èƒ½
def read_file(file_name):
    """è¯»å–æ–‡ä»¶"""
    with open(file_name, "r") as f:
        content = f.read()
    return len(content)

def test_parallel_read():
    """æµ‹è¯•å¹¶è¡Œè¯»å–çš„æ€§èƒ½"""
    file_names = [f"test_file_{i}.txt" for i in range(5)]
    
    # ä¸²è¡Œè¯»å–
    start_time = time.time()
    for file_name in file_names:
        read_file(file_name)
    serial_time = time.time() - start_time
    print(f"ä¸²è¡Œè¯»å–è€—æ—¶: {serial_time:.4f} ç§’")
    
    # å¹¶è¡Œè¯»å–
    start_time = time.time()
    with concurrent.futures.ThreadPoolExecutor() as executor:
        executor.map(read_file, file_names)
    parallel_time = time.time() - start_time
    print(f"å¹¶è¡Œè¯»å–è€—æ—¶: {parallel_time:.4f} ç§’")

test_parallel_read()

# 5. æ¸…ç†æµ‹è¯•æ–‡ä»¶
print("\næ¸…ç†æµ‹è¯•æ–‡ä»¶ï¼š")

for file in ["performance_test.txt", "line_write.txt", "batch_write.txt", "single_write.txt"]:
    if os.path.exists(file):
        os.remove(file)
        print(f"åˆ é™¤æ–‡ä»¶ {file}")

for i in range(5):
    file_name = f"test_file_{i}.txt"
    if os.path.exists(file_name):
        os.remove(file_name)
        print(f"åˆ é™¤æ–‡ä»¶ {file_name}")</code></pre><h3>8. æ€»ç»“</h3><p>æœ¬æ–‡è¯¦ç»†åˆ†æäº†Pythonä¸­çš„æ–‡ä»¶I/Oæ“ä½œä¸ç¼“å†²ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><strong>æ–‡ä»¶I/Oçš„åŸºæœ¬æ¦‚å¿µ</strong>ï¼šæ–‡ä»¶çš„å®šä¹‰ã€ç±»å‹ã€æ“ä½œæ¨¡å¼</li><li><strong>æ–‡ä»¶I/Oæ“ä½œçš„åŸºæœ¬æ–¹æ³•</strong>ï¼šè¯»å–ã€å†™å…¥ã€æ–‡ä»¶æŒ‡é’ˆæ“ä½œ</li><li><strong>ç¼“å†²ç­–ç•¥</strong>ï¼šç¼“å†²çš„æ¦‚å¿µã€æ¨¡å¼ã€å¤§å°ã€æ§åˆ¶</li><li><strong>æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</strong>ï¼šosæ¨¡å—ã€shutilæ¨¡å—ã€pathlibæ¨¡å—</li><li><strong>æ–‡ä»¶I/Oæ“ä½œçš„æœ€ä½³å®è·µ</strong>ï¼šä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€æŒ‡å®šç¼–ç ã€å¤„ç†å¤§æ–‡ä»¶ã€é”™è¯¯å¤„ç†ã€æ–‡ä»¶è·¯å¾„å¤„ç†ã€ç¼“å†²åŒºç®¡ç†</li><li><strong>é«˜çº§æ–‡ä»¶I/Oæ“ä½œ</strong>ï¼šä¸´æ—¶æ–‡ä»¶ã€å†…å­˜æ–‡ä»¶å¯¹è±¡ã€å‹ç¼©æ–‡ä»¶ã€æ–‡ä»¶é”</li><li><strong>å¸¸è§æ–‡ä»¶I/Oé—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</strong>ï¼šæ–‡ä»¶ä¸å­˜åœ¨ã€æƒé™é”™è¯¯ã€ç¼–ç é”™è¯¯ã€å†…å­˜ä¸è¶³ã€è·¯å¾„é”™è¯¯ã€ç¼“å†²åŒºæœªåˆ·æ–°</li><li><strong>æ–‡ä»¶I/Oæ€§èƒ½ä¼˜åŒ–</strong>ï¼šå½±å“å› ç´ ã€ä¼˜åŒ–æ–¹æ³•ã€æ€§èƒ½æµ‹è¯•</li></ul><p>Pythonçš„æ–‡ä»¶I/Oæ“ä½œæ˜¯ä¸€ç§å¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸æˆ‘ä»¬è¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼Œå¤„ç†å„ç§æ–‡ä»¶ç±»å‹å’Œæ ¼å¼ã€‚é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿï¼š</p><ol><li>ç†è§£æ–‡ä»¶I/Oçš„åŸºæœ¬æ¦‚å¿µå’Œæ“ä½œæ¨¡å¼</li><li>æŒæ¡æ–‡ä»¶è¯»å†™çš„åŸºæœ¬æ–¹æ³•å’ŒæŠ€å·§</li><li>ç†è§£ç¼“å†²ç­–ç•¥çš„å·¥ä½œåŸç†å’Œåº”ç”¨</li><li>ç†Ÿç»ƒä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„å„ç§å·¥å…·</li><li>éµå¾ªæ–‡ä»¶I/Oæ“ä½œçš„æœ€ä½³å®è·µ</li><li>è§£å†³å¸¸è§çš„æ–‡ä»¶I/Oé—®é¢˜</li><li>ä¼˜åŒ–æ–‡ä»¶I/Oæ“ä½œçš„æ€§èƒ½</li></ol><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥æ ¹æ®å…·ä½“çš„åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–‡ä»¶æ“ä½œæ–¹æ³•å’Œç¼“å†²ç­–ç•¥ï¼Œéµå¾ªPythonçš„æœ€ä½³å®è·µï¼Œä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€å¯é æ€§å’Œæ€§èƒ½ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ä¿æŒå­¦ä¹ çš„æ€åº¦ï¼Œå…³æ³¨Pythonçš„æœ€æ–°å‘å±•ï¼Œä»¥å……åˆ†åˆ©ç”¨Pythonçš„å¼ºå¤§åŠŸèƒ½ã€‚</p><h3>9. å‚è€ƒæ–‡çŒ®</h3><ol><li>Python Documentation: Reading and Writing Files</li><li>Python Documentation: os â€” Miscellaneous operating system interfaces</li><li>Python Documentation: shutil â€” High-level file operations</li><li>Python Documentation: pathlib â€” Object-oriented filesystem paths</li><li>Python Documentation: tempfile â€” Generate temporary files and directories</li><li>Python Documentation: io â€” Core tools for working with streams</li><li>Python Documentation: gzip â€” Support for gzip files</li><li>Real Python: Reading and Writing Files in Python</li><li>Real Python: Working With Files in Python</li><li>Real Python: Python's tempfile Module</li></ol><h3>10. ç»“è¯­</h3><p>Pythonçš„æ–‡ä»¶I/Oæ“ä½œæ˜¯Pythonç¼–ç¨‹çš„åŸºç¡€ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ç®€å•è€Œå¼ºå¤§çš„æ–¹å¼æ¥å¤„ç†æ–‡ä»¶ã€‚é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åº”è¯¥å·²ç»æŒæ¡äº†Pythonæ–‡ä»¶I/Oæ“ä½œçš„æ ¸å¿ƒæ¦‚å¿µå’ŒæŠ€æœ¯ã€‚</p><p>åœ¨ç¼–å†™Pythonä»£ç æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ï¼š</p><ul><li><strong>æ­£ç¡®ç†è§£æ–‡ä»¶I/Oçš„åŸºæœ¬æ¦‚å¿µ</strong>ï¼šäº†è§£æ–‡ä»¶çš„ç±»å‹ã€æ“ä½œæ¨¡å¼å’ŒåŸºæœ¬æ–¹æ³•</li><li><strong>ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨</strong>ï¼šä½¿ç”¨<code>with</code>è¯­å¥æ¥ç¡®ä¿æ–‡ä»¶çš„æ­£ç¡®å…³é—­</li><li><strong>æŒ‡å®šç¼–ç </strong>ï¼šåœ¨å¤„ç†æ–‡æœ¬æ–‡ä»¶æ—¶æ˜¾å¼æŒ‡å®šç¼–ç </li><li><strong>å¤„ç†å¤§æ–‡ä»¶æ—¶æ³¨æ„å†…å­˜ä½¿ç”¨</strong>ï¼šé€è¡Œè¯»å–å¤§æ–‡ä»¶ï¼Œé¿å…ä¸€æ¬¡æ€§è¯»å–æ•´ä¸ªæ–‡ä»¶</li><li><strong>æ·»åŠ é”™è¯¯å¤„ç†</strong>ï¼šä½¿ç”¨<code>try-except</code>å—æ•è·å’Œå¤„ç†æ–‡ä»¶æ“ä½œä¸­çš„å¼‚å¸¸</li><li><strong>ä½¿ç”¨åˆé€‚çš„æ–‡ä»¶è·¯å¾„å¤„ç†æ–¹æ³•</strong>ï¼šä½¿ç”¨<code>os.path</code>æˆ–<code>pathlib</code>æ¨¡å—æ¥å¤„ç†æ–‡ä»¶è·¯å¾„</li><li><strong>é€‰æ‹©åˆé€‚çš„ç¼“å†²ç­–ç•¥</strong>ï¼šæ ¹æ®æ–‡ä»¶æ“ä½œçš„ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„ç¼“å†²æ¨¡å¼å’Œå¤§å°</li><li><strong>ä¼˜åŒ–æ–‡ä»¶I/Oæ€§èƒ½</strong>ï¼šæ ¹æ®åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–æ–¹æ³•</li></ul><p>é€šè¿‡éµå¾ªè¿™äº›åŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨Pythonçš„æ–‡ä»¶I/OåŠŸèƒ½ï¼Œç¼–å†™æ›´åŠ å¥å£®ã€é«˜æ•ˆå’Œå¯ç»´æŠ¤çš„Pythonä»£ç ã€‚æ–‡ä»¶I/Oæ“ä½œä¸ä»…æ˜¯ä¸€ç§åŸºæœ¬çš„ç¼–ç¨‹æŠ€èƒ½ï¼Œæ›´æ˜¯ä¸€ç§è§£å†³å®é™…é—®é¢˜çš„é‡è¦å·¥å…·ï¼Œå®ƒåœ¨æ•°æ®å¤„ç†ã€æ—¥å¿—è®°å½•ã€é…ç½®ç®¡ç†ç­‰æ–¹é¢éƒ½æœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚</p><p>å¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¸®åŠ©è¯»è€…ç†è§£Pythonçš„æ–‡ä»¶I/Oæ“ä½œä¸ç¼“å†²ç­–ç•¥ï¼ŒæŒæ¡æ–‡ä»¶æ“ä½œçš„æœ€ä½³å®è·µï¼Œä»è€Œåœ¨å®é™…å¼€å‘ä¸­ç¼–å†™å‡ºæ›´é«˜è´¨é‡çš„Pythonä»£ç ã€‚</p>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹ä¸å¥—æ¥å­—API é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585264</link>    <guid>https://segmentfault.com/a/1190000047585264</guid>    <pubDate>2026-02-01 02:04:45</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹ä¸å¥—æ¥å­—API</h2><h3>1. ç½‘ç»œç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µ</h3><p>åœ¨Pythonç¼–ç¨‹ä¸­ï¼Œç½‘ç»œç¼–ç¨‹æ˜¯ä¸€ç§å¸¸è§çš„æ“ä½œï¼Œç”¨äºå®ç°è®¡ç®—æœºä¹‹é—´çš„é€šä¿¡ã€‚ç†è§£ç½‘ç»œç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µæ˜¯æŒæ¡Pythonç½‘ç»œç¼–ç¨‹çš„åŸºç¡€ã€‚</p><h4>1.1 ç½‘ç»œåè®®</h4><p>ç½‘ç»œåè®®æ˜¯è®¡ç®—æœºç½‘ç»œä¸­è¿›è¡Œæ•°æ®äº¤æ¢è€Œå»ºç«‹çš„è§„åˆ™ã€æ ‡å‡†æˆ–çº¦å®šçš„é›†åˆã€‚å¸¸è§çš„ç½‘ç»œåè®®åŒ…æ‹¬ï¼š</p><ul><li><strong>TCP/IPåè®®æ—</strong>ï¼šInternetçš„åŸºç¡€åè®®ï¼ŒåŒ…æ‹¬TCPã€UDPã€IPç­‰</li><li><strong>HTTP/HTTPS</strong>ï¼šåº”ç”¨å±‚åè®®ï¼Œç”¨äºWebé€šä¿¡</li><li><strong>FTP</strong>ï¼šæ–‡ä»¶ä¼ è¾“åè®®</li><li><strong>SMTP/POP3/IMAP</strong>ï¼šç”µå­é‚®ä»¶åè®®</li><li><strong>DNS</strong>ï¼šåŸŸåç³»ç»Ÿåè®®</li></ul><h4>1.2 ç½‘ç»œæ¨¡å‹</h4><p>ç½‘ç»œæ¨¡å‹æ˜¯å¯¹ç½‘ç»œåè®®çš„åˆ†å±‚æè¿°ï¼Œå¸¸è§çš„ç½‘ç»œæ¨¡å‹åŒ…æ‹¬ï¼š</p><ul><li><strong>OSIä¸ƒå±‚æ¨¡å‹</strong>ï¼šç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚ã€åº”ç”¨å±‚</li><li><strong>TCP/IPå››å±‚æ¨¡å‹</strong>ï¼šç½‘ç»œæ¥å£å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€åº”ç”¨å±‚</li></ul><h4>1.3 å¥—æ¥å­—</h4><p>å¥—æ¥å­—ï¼ˆSocketï¼‰æ˜¯ç½‘ç»œé€šä¿¡çš„ç«¯ç‚¹ï¼Œæ˜¯ç½‘ç»œç¼–ç¨‹çš„åŸºç¡€ã€‚å¥—æ¥å­—å¯ä»¥åˆ†ä¸ºï¼š</p><ul><li><strong>æµå¼å¥—æ¥å­—ï¼ˆSOCK_STREAMï¼‰</strong>ï¼šåŸºäºTCPåè®®ï¼Œæä¾›å¯é çš„ã€é¢å‘è¿æ¥çš„é€šä¿¡</li><li><strong>æ•°æ®æŠ¥å¥—æ¥å­—ï¼ˆSOCK_DGRAMï¼‰</strong>ï¼šåŸºäºUDPåè®®ï¼Œæä¾›ä¸å¯é çš„ã€æ— è¿æ¥çš„é€šä¿¡</li><li><strong>åŸå§‹å¥—æ¥å­—ï¼ˆSOCK_RAWï¼‰</strong>ï¼šç›´æ¥è®¿é—®ç½‘ç»œå±‚åè®®ï¼Œç”¨äºç‰¹æ®Šç”¨é€”</li></ul><h4>1.4 ç½‘ç»œåœ°å€</h4><p>ç½‘ç»œåœ°å€ç”¨äºæ ‡è¯†ç½‘ç»œä¸­çš„è®¾å¤‡ï¼Œå¸¸è§çš„ç½‘ç»œåœ°å€åŒ…æ‹¬ï¼š</p><ul><li><strong>IPv4åœ°å€</strong>ï¼š32ä½åœ°å€ï¼Œæ ¼å¼ä¸ºç‚¹åˆ†åè¿›åˆ¶ï¼ˆå¦‚192.168.1.1ï¼‰</li><li><strong>IPv6åœ°å€</strong>ï¼š128ä½åœ°å€ï¼Œæ ¼å¼ä¸ºåå…­è¿›åˆ¶ï¼ˆå¦‚2001:0db8:85a3:0000:0000:8a2e:0370:7334ï¼‰</li><li><strong>ç«¯å£å·</strong>ï¼š16ä½æ•´æ•°ï¼Œç”¨äºæ ‡è¯†åº”ç”¨ç¨‹åºï¼ˆå¦‚80ç«¯å£ç”¨äºHTTPï¼‰</li></ul><h4>1.5 ç½‘ç»œç¼–ç¨‹æ¨¡å‹</h4><p>å¸¸è§çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹åŒ…æ‹¬ï¼š</p><ul><li><strong>å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å‹</strong>ï¼šå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å“åº”è¯·æ±‚</li><li><strong>å¯¹ç­‰æ¨¡å‹ï¼ˆP2Pï¼‰</strong>ï¼šç½‘ç»œä¸­çš„èŠ‚ç‚¹æ—¢æ˜¯å®¢æˆ·ç«¯åˆæ˜¯æœåŠ¡å™¨</li></ul><pre><code class="python"># ç½‘ç»œç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µç¤ºä¾‹

import socket
import sys

# 1. æŸ¥çœ‹Pythonæ”¯æŒçš„å¥—æ¥å­—ç±»å‹
print("Pythonæ”¯æŒçš„å¥—æ¥å­—ç±»å‹ï¼š")
print(f"æµå¼å¥—æ¥å­—ï¼ˆTCPï¼‰: {socket.SOCK_STREAM}")
print(f"æ•°æ®æŠ¥å¥—æ¥å­—ï¼ˆUDPï¼‰: {socket.SOCK_DGRAM}")
print(f"åŸå§‹å¥—æ¥å­—: {socket.SOCK_RAW}")

# 2. æŸ¥çœ‹æœ¬åœ°ä¸»æœºåå’ŒIPåœ°å€
print("\næœ¬åœ°ä¸»æœºä¿¡æ¯ï¼š")
try:
    hostname = socket.gethostname()
    print(f"ä¸»æœºå: {hostname}")
    
    # è·å–IPv4åœ°å€
    ipv4_addresses = socket.gethostbyname_ex(hostname)[2]
    print("IPv4åœ°å€:")
    for ip in ipv4_addresses:
        print(f"  {ip}")
    
    # è·å–IPv6åœ°å€ï¼ˆå¦‚æœæ”¯æŒï¼‰
    try:
        ipv6_addresses = socket.getaddrinfo(hostname, None, socket.AF_INET6)
        print("IPv6åœ°å€:")
        for info in ipv6_addresses:
            print(f"  {info[4][0]}")
    except socket.gaierror:
        print("IPv6åœ°å€: ä¸æ”¯æŒ")
except Exception as e:
    print(f"è·å–ä¸»æœºä¿¡æ¯å¤±è´¥: {e}")

# 3. æµ‹è¯•ç½‘ç»œè¿æ¥
print("\næµ‹è¯•ç½‘ç»œè¿æ¥ï¼š")
def test_connection(host, port):
    """æµ‹è¯•ç½‘ç»œè¿æ¥"""
    try:
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
            s.settimeout(2)
            result = s.connect_ex((host, port))
            if result == 0:
                print(f"è¿æ¥ {host}:{port} æˆåŠŸ")
            else:
                print(f"è¿æ¥ {host}:{port} å¤±è´¥: {result}")
    except Exception as e:
        print(f"æµ‹è¯•è¿æ¥å¤±è´¥: {e}")

# æµ‹è¯•å¸¸è§æœåŠ¡
 test_connection("www.baidu.com", 80)  # HTTP
test_connection("smtp.163.com", 25)    # SMTP
test_connection("pop.163.com", 110)     # POP3

# 4. è§£æURL
print("\nè§£æURLï¼š")
def parse_url(url):
    """è§£æURL"""
    from urllib.parse import urlparse
    parsed = urlparse(url)
    print(f"URL: {url}")
    print(f"åè®®: {parsed.scheme}")
    print(f"ä¸»æœº: {parsed.netloc}")
    print(f"è·¯å¾„: {parsed.path}")
    print(f"æŸ¥è¯¢: {parsed.query}")

parse_url("https://www.python.org/downloads/?ref=sidebar")

# 5. æŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µ
print("\næŸ¥çœ‹ç«¯å£ä½¿ç”¨æƒ…å†µï¼š")
try:
    # å°è¯•ç»‘å®šç«¯å£8080
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        try:
            s.bind(("localhost", 8080))
            print("ç«¯å£8080å¯ç”¨")
        except OSError as e:
            print(f"ç«¯å£8080ä¸å¯ç”¨: {e}")
except Exception as e:
    print(f"æŸ¥çœ‹ç«¯å£å¤±è´¥: {e}")</code></pre><h3>2. å¥—æ¥å­—APIçš„ä½¿ç”¨</h3><p>Pythonçš„<code>socket</code>æ¨¡å—æä¾›äº†å¥—æ¥å­—APIï¼Œç”¨äºå®ç°ç½‘ç»œç¼–ç¨‹ã€‚ç†è§£å¥—æ¥å­—APIçš„ä½¿ç”¨æ˜¯æŒæ¡Pythonç½‘ç»œç¼–ç¨‹çš„å…³é”®ã€‚</p><h4>2.1 åˆ›å»ºå¥—æ¥å­—</h4><p>ä½¿ç”¨<code>socket.socket()</code>å‡½æ•°åˆ›å»ºå¥—æ¥å­—ï¼š</p><pre><code class="python"># åˆ›å»ºIPv4ã€TCPå¥—æ¥å­—
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# åˆ›å»ºIPv6ã€TCPå¥—æ¥å­—
s = socket.socket(socket.AF_INET6, socket.SOCK_STREAM)

# åˆ›å»ºIPv4ã€UDPå¥—æ¥å­—
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</code></pre><h4>2.2 å¥—æ¥å­—çš„åŸºæœ¬æ“ä½œ</h4><p>å¥—æ¥å­—çš„åŸºæœ¬æ“ä½œåŒ…æ‹¬ï¼š</p><ul><li><strong>ç»‘å®šåœ°å€</strong>ï¼š<code>bind(address)</code></li><li><strong>ç›‘å¬è¿æ¥</strong>ï¼š<code>listen(backlog)</code></li><li><strong>æ¥å—è¿æ¥</strong>ï¼š<code>accept()</code></li><li><strong>å‘èµ·è¿æ¥</strong>ï¼š<code>connect(address)</code></li><li><strong>å‘é€æ•°æ®</strong>ï¼š<code>send(data)</code>ã€<code>sendall(data)</code></li><li><strong>æ¥æ”¶æ•°æ®</strong>ï¼š<code>recv(bufsize)</code></li><li><strong>å…³é—­è¿æ¥</strong>ï¼š<code>close()</code></li></ul><h4>2.3 TCPæœåŠ¡å™¨</h4><p>TCPæœåŠ¡å™¨çš„åŸºæœ¬æµç¨‹ï¼š</p><ol><li>åˆ›å»ºå¥—æ¥å­—</li><li>ç»‘å®šåœ°å€</li><li>ç›‘å¬è¿æ¥</li><li>æ¥å—è¿æ¥</li><li>æ”¶å‘æ•°æ®</li><li>å…³é—­è¿æ¥</li></ol><h4>2.4 TCPå®¢æˆ·ç«¯</h4><p>TCPå®¢æˆ·ç«¯çš„åŸºæœ¬æµç¨‹ï¼š</p><ol><li>åˆ›å»ºå¥—æ¥å­—</li><li>è¿æ¥æœåŠ¡å™¨</li><li>æ”¶å‘æ•°æ®</li><li>å…³é—­è¿æ¥</li></ol><h4>2.5 UDPæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯</h4><p>UDPæ˜¯æ— è¿æ¥çš„åè®®ï¼Œæ‰€ä»¥UDPæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„æµç¨‹æ¯”TCPç®€å•ï¼š</p><ul><li><strong>UDPæœåŠ¡å™¨</strong>ï¼šåˆ›å»ºå¥—æ¥å­— â†’ ç»‘å®šåœ°å€ â†’ æ”¶å‘æ•°æ® â†’ å…³é—­è¿æ¥</li><li><strong>UDPå®¢æˆ·ç«¯</strong>ï¼šåˆ›å»ºå¥—æ¥å­— â†’ æ”¶å‘æ•°æ® â†’ å…³é—­è¿æ¥</li></ul><h4>2.6 å¥—æ¥å­—é€‰é¡¹</h4><p>å¥—æ¥å­—é€‰é¡¹ç”¨äºé…ç½®å¥—æ¥å­—çš„è¡Œä¸ºï¼Œå¸¸è§çš„å¥—æ¥å­—é€‰é¡¹åŒ…æ‹¬ï¼š</p><ul><li><strong>SO_REUSEADDR</strong>ï¼šå…è®¸é‡ç”¨åœ°å€</li><li><strong>SO_RCVBUF</strong>ï¼šæ¥æ”¶ç¼“å†²åŒºå¤§å°</li><li><strong>SO_SNDBUF</strong>ï¼šå‘é€ç¼“å†²åŒºå¤§å°</li><li><strong>SO_TIMEOUT</strong>ï¼šè¶…æ—¶æ—¶é—´</li></ul><h4>2.7 å¥—æ¥å­—APIçš„ç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯å¥—æ¥å­—APIçš„ä¸€äº›å¸¸è§ç¤ºä¾‹ï¼š</p><pre><code class="python"># å¥—æ¥å­—APIçš„ä½¿ç”¨ç¤ºä¾‹

import socket
import sys

# 1. TCPæœåŠ¡å™¨ç¤ºä¾‹
print("TCPæœåŠ¡å™¨ç¤ºä¾‹ï¼š")

def tcp_server(host='localhost', port=8888):
    """TCPæœåŠ¡å™¨"""
    try:
        # åˆ›å»ºå¥—æ¥å­—
        server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print("åˆ›å»ºå¥—æ¥å­—æˆåŠŸ")
        
        # è®¾ç½®å¥—æ¥å­—é€‰é¡¹
        server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        print("è®¾ç½®å¥—æ¥å­—é€‰é¡¹æˆåŠŸ")
        
        # ç»‘å®šåœ°å€
        server_socket.bind((host, port))
        print(f"ç»‘å®šåœ°å€ {host}:{port} æˆåŠŸ")
        
        # ç›‘å¬è¿æ¥
        server_socket.listen(5)
        print(f"ç›‘å¬ç«¯å£ {port} æˆåŠŸ")
        
        print("æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥...")
        
        # æ¥å—è¿æ¥
        client_socket, client_address = server_socket.accept()
        print(f"æ¥å—å®¢æˆ·ç«¯è¿æ¥: {client_address}")
        
        # æ”¶å‘æ•°æ®
        while True:
            # æ¥æ”¶æ•°æ®
            data = client_socket.recv(1024)
            if not data:
                break
            print(f"æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®: {data.decode('utf-8')}")
            
            # å‘é€æ•°æ®
            response = f"æœåŠ¡å™¨æ”¶åˆ°: {data.decode('utf-8')}"
            client_socket.sendall(response.encode('utf-8'))
            print(f"å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯: {response}")
        
        # å…³é—­è¿æ¥
        client_socket.close()
        server_socket.close()
        print("æœåŠ¡å™¨å…³é—­")
        
    except Exception as e:
        print(f"æœåŠ¡å™¨é”™è¯¯: {e}")
        if 'server_socket' in locals():
            server_socket.close()

# 2. TCPå®¢æˆ·ç«¯ç¤ºä¾‹
print("\nTCPå®¢æˆ·ç«¯ç¤ºä¾‹ï¼š")

def tcp_client(host='localhost', port=8888):
    """TCPå®¢æˆ·ç«¯"""
    try:
        # åˆ›å»ºå¥—æ¥å­—
        client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print("åˆ›å»ºå¥—æ¥å­—æˆåŠŸ")
        
        # è¿æ¥æœåŠ¡å™¨
        client_socket.connect((host, port))
        print(f"è¿æ¥æœåŠ¡å™¨ {host}:{port} æˆåŠŸ")
        
        # æ”¶å‘æ•°æ®
        while True:
            # è¾“å…¥æ•°æ®
            message = input("è¯·è¾“å…¥è¦å‘é€çš„æ•°æ®ï¼ˆè¾“å…¥exité€€å‡ºï¼‰: ")
            if message == "exit":
                break
            
            # å‘é€æ•°æ®
            client_socket.sendall(message.encode('utf-8'))
            print(f"å‘é€æ•°æ®åˆ°æœåŠ¡å™¨: {message}")
            
            # æ¥æ”¶æ•°æ®
            data = client_socket.recv(1024)
            print(f"æ”¶åˆ°æœåŠ¡å™¨æ•°æ®: {data.decode('utf-8')}")
        
        # å…³é—­è¿æ¥
        client_socket.close()
        print("å®¢æˆ·ç«¯å…³é—­")
        
    except Exception as e:
        print(f"å®¢æˆ·ç«¯é”™è¯¯: {e}")
        if 'client_socket' in locals():
            client_socket.close()

# 3. UDPæœåŠ¡å™¨ç¤ºä¾‹
print("\nUDPæœåŠ¡å™¨ç¤ºä¾‹ï¼š")

def udp_server(host='localhost', port=8888):
    """UDPæœåŠ¡å™¨"""
    try:
        # åˆ›å»ºå¥—æ¥å­—
        server_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        print("åˆ›å»ºå¥—æ¥å­—æˆåŠŸ")
        
        # ç»‘å®šåœ°å€
        server_socket.bind((host, port))
        print(f"ç»‘å®šåœ°å€ {host}:{port} æˆåŠŸ")
        
        print("UDPæœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç­‰å¾…å®¢æˆ·ç«¯æ•°æ®...")
        
        # æ”¶å‘æ•°æ®
        while True:
            # æ¥æ”¶æ•°æ®
            data, client_address = server_socket.recvfrom(1024)
            print(f"æ”¶åˆ°å®¢æˆ·ç«¯ {client_address} çš„æ•°æ®: {data.decode('utf-8')}")
            
            # å‘é€æ•°æ®
            response = f"æœåŠ¡å™¨æ”¶åˆ°: {data.decode('utf-8')}"
            server_socket.sendto(response.encode('utf-8'), client_address)
            print(f"å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯ {client_address}: {response}")
        
        # å…³é—­è¿æ¥
        server_socket.close()
        print("æœåŠ¡å™¨å…³é—­")
        
    except Exception as e:
        print(f"æœåŠ¡å™¨é”™è¯¯: {e}")
        if 'server_socket' in locals():
            server_socket.close()

# 4. UDPå®¢æˆ·ç«¯ç¤ºä¾‹
print("\nUDPå®¢æˆ·ç«¯ç¤ºä¾‹ï¼š")

def udp_client(host='localhost', port=8888):
    """UDPå®¢æˆ·ç«¯"""
    try:
        # åˆ›å»ºå¥—æ¥å­—
        client_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        print("åˆ›å»ºå¥—æ¥å­—æˆåŠŸ")
        
        # æ”¶å‘æ•°æ®
        while True:
            # è¾“å…¥æ•°æ®
            message = input("è¯·è¾“å…¥è¦å‘é€çš„æ•°æ®ï¼ˆè¾“å…¥exité€€å‡ºï¼‰: ")
            if message == "exit":
                break
            
            # å‘é€æ•°æ®
            client_socket.sendto(message.encode('utf-8'), (host, port))
            print(f"å‘é€æ•°æ®åˆ°æœåŠ¡å™¨ {host}:{port}: {message}")
            
            # æ¥æ”¶æ•°æ®
            data, server_address = client_socket.recvfrom(1024)
            print(f"æ”¶åˆ°æœåŠ¡å™¨ {server_address} çš„æ•°æ®: {data.decode('utf-8')}")
        
        # å…³é—­è¿æ¥
        client_socket.close()
        print("å®¢æˆ·ç«¯å…³é—­")
        
    except Exception as e:
        print(f"å®¢æˆ·ç«¯é”™è¯¯: {e}")
        if 'client_socket' in locals():
            client_socket.close()

# 5. å¥—æ¥å­—é€‰é¡¹ç¤ºä¾‹
print("\nå¥—æ¥å­—é€‰é¡¹ç¤ºä¾‹ï¼š")

try:
    # åˆ›å»ºå¥—æ¥å­—
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    print("åˆ›å»ºå¥—æ¥å­—æˆåŠŸ")
    
    # è·å–å¥—æ¥å­—é€‰é¡¹
    reuse_addr = s.getsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR)
    print(f"SO_REUSEADDR: {reuse_addr}")
    
    rcvbuf = s.getsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF)
    print(f"SO_RCVBUF: {rcvbuf} å­—èŠ‚")
    
    sndbuf = s.getsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF)
    print(f"SO_SNDBUF: {sndbuf} å­—èŠ‚")
    
    # è®¾ç½®å¥—æ¥å­—é€‰é¡¹
    s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    print("è®¾ç½®SO_REUSEADDR=1æˆåŠŸ")
    
    # è®¾ç½®æ¥æ”¶ç¼“å†²åŒºå¤§å°
    s.setsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF, 8192)
    print("è®¾ç½®SO_RCVBUF=8192æˆåŠŸ")
    
    # å†æ¬¡è·å–å¥—æ¥å­—é€‰é¡¹
    reuse_addr = s.getsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR)
    print(f"ä¿®æ”¹å SO_REUSEADDR: {reuse_addr}")
    
    rcvbuf = s.getsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF)
    print(f"ä¿®æ”¹å SO_RCVBUF: {rcvbuf} å­—èŠ‚")
    
    # å…³é—­å¥—æ¥å­—
    s.close()
    print("å…³é—­å¥—æ¥å­—æˆåŠŸ")
    
except Exception as e:
    print(f"å¥—æ¥å­—é€‰é¡¹æ“ä½œé”™è¯¯: {e}")
    if 's' in locals():
        s.close()

print("\næ³¨æ„ï¼šä»¥ä¸ŠæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ç¤ºä¾‹éœ€è¦åˆ†åˆ«è¿è¡Œï¼Œå…ˆå¯åŠ¨æœåŠ¡å™¨ï¼Œå†å¯åŠ¨å®¢æˆ·ç«¯")</code></pre><h3>3. ç½‘ç»œç¼–ç¨‹æ¨¡å‹</h3><p>Pythonæ”¯æŒå¤šç§ç½‘ç»œç¼–ç¨‹æ¨¡å‹ï¼Œæ¯ç§æ¨¡å‹éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯ã€‚ç†è§£è¿™äº›ç½‘ç»œç¼–ç¨‹æ¨¡å‹å¯¹äºé€‰æ‹©åˆé€‚çš„å®ç°æ–¹å¼è‡³å…³é‡è¦ã€‚</p><h4>3.1 é˜»å¡å¼I/Oæ¨¡å‹</h4><p>é˜»å¡å¼I/Oæ¨¡å‹æ˜¯æœ€åŸºæœ¬çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼š</p><ul><li><strong>é˜»å¡</strong>ï¼šå½“æ‰§è¡ŒI/Oæ“ä½œæ—¶ï¼Œç¨‹åºä¼šé˜»å¡ç›´åˆ°æ“ä½œå®Œæˆ</li><li><strong>ç®€å•</strong>ï¼šå®ç°ç®€å•ï¼Œæ˜“äºç†è§£</li><li><strong>æ•ˆç‡ä½</strong>ï¼šåœ¨å¤„ç†å¤šä¸ªè¿æ¥æ—¶ï¼Œéœ€è¦ä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹</li></ul><h4>3.2 éé˜»å¡å¼I/Oæ¨¡å‹</h4><p>éé˜»å¡å¼I/Oæ¨¡å‹çš„ç‰¹ç‚¹æ˜¯ï¼š</p><ul><li><strong>éé˜»å¡</strong>ï¼šå½“æ‰§è¡ŒI/Oæ“ä½œæ—¶ï¼Œç¨‹åºä¸ä¼šé˜»å¡ï¼Œè€Œæ˜¯ç«‹å³è¿”å›</li><li><strong>è½®è¯¢</strong>ï¼šéœ€è¦ä¸æ–­è½®è¯¢æ£€æŸ¥I/Oæ“ä½œæ˜¯å¦å®Œæˆ</li><li><strong>CPUå¯†é›†</strong>ï¼šè½®è¯¢ä¼šæ¶ˆè€—å¤§é‡CPUèµ„æº</li></ul><h4>3.3 å¤šè·¯å¤ç”¨I/Oæ¨¡å‹</h4><p>å¤šè·¯å¤ç”¨I/Oæ¨¡å‹çš„ç‰¹ç‚¹æ˜¯ï¼š</p><ul><li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šä½¿ç”¨selectã€pollã€epollç­‰ç³»ç»Ÿè°ƒç”¨ç›‘æ§å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦</li><li><strong>é«˜æ•ˆ</strong>ï¼šå¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªè¿æ¥ï¼Œè€Œä¸éœ€è¦ä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºçº¿ç¨‹æˆ–è¿›ç¨‹</li><li><strong>å¤æ‚</strong>ï¼šå®ç°ç›¸å¯¹å¤æ‚</li></ul><h4>3.4 ä¿¡å·é©±åŠ¨I/Oæ¨¡å‹</h4><p>ä¿¡å·é©±åŠ¨I/Oæ¨¡å‹çš„ç‰¹ç‚¹æ˜¯ï¼š</p><ul><li><strong>ä¿¡å·é€šçŸ¥</strong>ï¼šå½“I/Oæ“ä½œå‡†å¤‡å°±ç»ªæ—¶ï¼Œç³»ç»Ÿä¼šå‘é€ä¿¡å·é€šçŸ¥è¿›ç¨‹</li><li><strong>å¼‚æ­¥</strong>ï¼šè¿›ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç›´åˆ°æ”¶åˆ°ä¿¡å·</li><li><strong>ä¸å¸¸ç”¨</strong>ï¼šåœ¨Pythonä¸­ä¸å¸¸ç”¨</li></ul><h4>3.5 å¼‚æ­¥I/Oæ¨¡å‹</h4><p>å¼‚æ­¥I/Oæ¨¡å‹çš„ç‰¹ç‚¹æ˜¯ï¼š</p><ul><li><strong>å®Œå…¨å¼‚æ­¥</strong>ï¼šå½“æ‰§è¡ŒI/Oæ“ä½œæ—¶ï¼Œç¨‹åºä¼šç«‹å³è¿”å›ï¼Œå½“æ“ä½œå®Œæˆæ—¶ï¼Œç³»ç»Ÿä¼šé€šçŸ¥è¿›ç¨‹</li><li><strong>é«˜æ•ˆ</strong>ï¼šå¯ä»¥åŒæ—¶å¤„ç†å¤§é‡è¿æ¥</li><li><strong>å¤æ‚</strong>ï¼šå®ç°ç›¸å¯¹å¤æ‚</li></ul><h4>3.6 Pythonä¸­çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹</h4><p>Pythonæ”¯æŒä»¥ä¸‹ç½‘ç»œç¼–ç¨‹æ¨¡å‹ï¼š</p><ul><li><strong>å¤šçº¿ç¨‹æ¨¡å‹</strong>ï¼šä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹</li><li><strong>å¤šè¿›ç¨‹æ¨¡å‹</strong>ï¼šä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºä¸€ä¸ªè¿›ç¨‹</li><li><strong>I/Oå¤šè·¯å¤ç”¨æ¨¡å‹</strong>ï¼šä½¿ç”¨selectã€pollã€epollç­‰ç³»ç»Ÿè°ƒç”¨</li><li><strong>å¼‚æ­¥I/Oæ¨¡å‹</strong>ï¼šä½¿ç”¨asyncioåº“</li></ul><h4>3.7 ç½‘ç»œç¼–ç¨‹æ¨¡å‹çš„ç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯Pythonä¸­å¸¸è§çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹ç¤ºä¾‹ï¼š</p><pre><code class="python"># ç½‘ç»œç¼–ç¨‹æ¨¡å‹ç¤ºä¾‹

import socket
import threading
import multiprocessing
import select
import asyncio

# 1. å¤šçº¿ç¨‹æœåŠ¡å™¨ç¤ºä¾‹
print("å¤šçº¿ç¨‹æœåŠ¡å™¨ç¤ºä¾‹ï¼š")

def handle_client(client_socket, client_address):
    """å¤„ç†å®¢æˆ·ç«¯è¿æ¥"""
    print(f"æ–°çº¿ç¨‹å¤„ç†å®¢æˆ·ç«¯: {client_address}")
    try:
        while True:
            # æ¥æ”¶æ•°æ®
            data = client_socket.recv(1024)
            if not data:
                break
            print(f"æ”¶åˆ°å®¢æˆ·ç«¯ {client_address} çš„æ•°æ®: {data.decode('utf-8')}")
            
            # å‘é€æ•°æ®
            response = f"æœåŠ¡å™¨æ”¶åˆ°: {data.decode('utf-8')}"
            client_socket.sendall(response.encode('utf-8'))
    except Exception as e:
        print(f"å¤„ç†å®¢æˆ·ç«¯é”™è¯¯: {e}")
    finally:
        client_socket.close()
        print(f"å®¢æˆ·ç«¯ {client_address} è¿æ¥å…³é—­")

def threaded_server(host='localhost', port=8888):
    """å¤šçº¿ç¨‹æœåŠ¡å™¨"""
    try:
        # åˆ›å»ºå¥—æ¥å­—
        server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        server_socket.bind((host, port))
        server_socket.listen(5)
        print(f"å¤šçº¿ç¨‹æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç›‘å¬ {host}:{port}")
        
        while True:
            # æ¥å—è¿æ¥
            client_socket, client_address = server_socket.accept()
            print(f"æ¥å—å®¢æˆ·ç«¯è¿æ¥: {client_address}")
            
            # åˆ›å»ºçº¿ç¨‹å¤„ç†å®¢æˆ·ç«¯
            client_thread = threading.Thread(
                target=handle_client, 
                args=(client_socket, client_address)
            )
            client_thread.daemon = True
            client_thread.start()
            
    except Exception as e:
        print(f"æœåŠ¡å™¨é”™è¯¯: {e}")
    finally:
        server_socket.close()
        print("æœåŠ¡å™¨å…³é—­")

# 2. å¤šè¿›ç¨‹æœåŠ¡å™¨ç¤ºä¾‹
print("\nå¤šè¿›ç¨‹æœåŠ¡å™¨ç¤ºä¾‹ï¼š")

def process_server(host='localhost', port=8889):
    """å¤šè¿›ç¨‹æœåŠ¡å™¨"""
    try:
        # åˆ›å»ºå¥—æ¥å­—
        server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        server_socket.bind((host, port))
        server_socket.listen(5)
        print(f"å¤šè¿›ç¨‹æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç›‘å¬ {host}:{port}")
        
        while True:
            # æ¥å—è¿æ¥
            client_socket, client_address = server_socket.accept()
            print(f"æ¥å—å®¢æˆ·ç«¯è¿æ¥: {client_address}")
            
            # åˆ›å»ºè¿›ç¨‹å¤„ç†å®¢æˆ·ç«¯
            client_process = multiprocessing.Process(
                target=handle_client, 
                args=(client_socket, client_address)
            )
            client_process.daemon = True
            client_process.start()
            
            # å…³é—­çˆ¶è¿›ç¨‹ä¸­çš„å®¢æˆ·ç«¯å¥—æ¥å­—
            client_socket.close()
            
    except Exception as e:
        print(f"æœåŠ¡å™¨é”™è¯¯: {e}")
    finally:
        server_socket.close()
        print("æœåŠ¡å™¨å…³é—­")

# 3. I/Oå¤šè·¯å¤ç”¨æœåŠ¡å™¨ç¤ºä¾‹
print("\nI/Oå¤šè·¯å¤ç”¨æœåŠ¡å™¨ç¤ºä¾‹ï¼š")

def multiplex_server(host='localhost', port=8890):
    """I/Oå¤šè·¯å¤ç”¨æœåŠ¡å™¨"""
    try:
        # åˆ›å»ºå¥—æ¥å­—
        server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        server_socket.bind((host, port))
        server_socket.listen(5)
        server_socket.setblocking(False)  # è®¾ç½®ä¸ºéé˜»å¡
        print(f"I/Oå¤šè·¯å¤ç”¨æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç›‘å¬ {host}:{port}")
        
        # åˆå§‹åŒ–å¥—æ¥å­—åˆ—è¡¨
        sockets = [server_socket]
        
        while True:
            # ä½¿ç”¨selectç›‘æ§å¥—æ¥å­—
            readable, writable, exceptional = select.select(sockets, [], sockets)
            
            # å¤„ç†å¯è¯»å¥—æ¥å­—
            for sock in readable:
                if sock == server_socket:
                    # æ¥å—æ–°è¿æ¥
                    client_socket, client_address = server_socket.accept()
                    client_socket.setblocking(False)  # è®¾ç½®ä¸ºéé˜»å¡
                    sockets.append(client_socket)
                    print(f"æ¥å—å®¢æˆ·ç«¯è¿æ¥: {client_address}")
                else:
                    # æ¥æ”¶å®¢æˆ·ç«¯æ•°æ®
                    try:
                        data = sock.recv(1024)
                        if data:
                            print(f"æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®: {data.decode('utf-8')}")
                            # å‘é€å“åº”
                            response = f"æœåŠ¡å™¨æ”¶åˆ°: {data.decode('utf-8')}"
                            sock.sendall(response.encode('utf-8'))
                        else:
                            # å®¢æˆ·ç«¯å…³é—­è¿æ¥
                            print(f"å®¢æˆ·ç«¯å…³é—­è¿æ¥")
                            sockets.remove(sock)
                            sock.close()
                    except Exception as e:
                        # å®¢æˆ·ç«¯é”™è¯¯
                        print(f"å®¢æˆ·ç«¯é”™è¯¯: {e}")
                        sockets.remove(sock)
                        sock.close()
            
            # å¤„ç†å¼‚å¸¸å¥—æ¥å­—
            for sock in exceptional:
                print(f"å¥—æ¥å­—å¼‚å¸¸")
                sockets.remove(sock)
                sock.close()
        
    except Exception as e:
        print(f"æœåŠ¡å™¨é”™è¯¯: {e}")
    finally:
        server_socket.close()
        print("æœåŠ¡å™¨å…³é—­")

# 4. å¼‚æ­¥I/OæœåŠ¡å™¨ç¤ºä¾‹
print("\nå¼‚æ­¥I/OæœåŠ¡å™¨ç¤ºä¾‹ï¼š")

async def handle_async_client(reader, writer):
    """å¤„ç†å¼‚æ­¥å®¢æˆ·ç«¯è¿æ¥"""
    client_address = writer.get_extra_info('peername')
    print(f"æ¥å—å¼‚æ­¥å®¢æˆ·ç«¯è¿æ¥: {client_address}")
    
    try:
        while True:
            # æ¥æ”¶æ•°æ®
            data = await reader.read(1024)
            if not data:
                break
            message = data.decode('utf-8')
            print(f"æ”¶åˆ°å®¢æˆ·ç«¯ {client_address} çš„æ•°æ®: {message}")
            
            # å‘é€æ•°æ®
            response = f"æœåŠ¡å™¨æ”¶åˆ°: {message}"
            writer.write(response.encode('utf-8'))
            await writer.drain()
    except Exception as e:
        print(f"å¤„ç†å®¢æˆ·ç«¯é”™è¯¯: {e}")
    finally:
        print(f"å…³é—­å®¢æˆ·ç«¯è¿æ¥: {client_address}")
        writer.close()
        await writer.wait_closed()

async def async_server(host='localhost', port=8891):
    """å¼‚æ­¥I/OæœåŠ¡å™¨"""
    try:
        # åˆ›å»ºæœåŠ¡å™¨
        server = await asyncio.start_server(
            handle_async_client, 
            host, 
            port
        )
        
        # è·å–æœåŠ¡å™¨åœ°å€
        addr = server.sockets[0].getsockname()
        print(f"å¼‚æ­¥I/OæœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç›‘å¬ {addr}")
        
        # å¯åŠ¨æœåŠ¡å™¨
        async with server:
            await server.serve_forever()
            
    except Exception as e:
        print(f"æœåŠ¡å™¨é”™è¯¯: {e}")

# 5. å¯åŠ¨æœåŠ¡å™¨ï¼ˆæ³¨æ„ï¼šå®é™…è¿è¡Œæ—¶åªéœ€è¦å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼‰
print("\nå¯åŠ¨æœåŠ¡å™¨ç¤ºä¾‹ï¼š")
print("æ³¨æ„ï¼šä»¥ä¸‹ä»£ç ä»…ä½œä¸ºç¤ºä¾‹ï¼Œå®é™…è¿è¡Œæ—¶éœ€è¦å•ç‹¬è¿è¡ŒæœåŠ¡å™¨")

# å¯åŠ¨å¤šçº¿ç¨‹æœåŠ¡å™¨
# threading.Thread(target=threaded_server, daemon=True).start()

# å¯åŠ¨å¤šè¿›ç¨‹æœåŠ¡å™¨
# multiprocessing.Process(target=process_server, daemon=True).start()

# å¯åŠ¨I/Oå¤šè·¯å¤ç”¨æœåŠ¡å™¨
# threading.Thread(target=multiplex_server, daemon=True).start()

# å¯åŠ¨å¼‚æ­¥I/OæœåŠ¡å™¨
# asyncio.run(async_server())

print("æœåŠ¡å™¨ç¤ºä¾‹ä»£ç ç»“æŸ")</code></pre><h3>4. é«˜çº§ç½‘ç»œç¼–ç¨‹</h3><p>Pythonæä¾›äº†ä¸€äº›é«˜çº§ç½‘ç»œç¼–ç¨‹çš„åº“å’Œå·¥å…·ï¼Œç”¨äºç®€åŒ–ç½‘ç»œç¼–ç¨‹çš„å¤æ‚æ€§ã€‚</p><h4>4.1 é«˜çº§å¥—æ¥å­—æ“ä½œ</h4><h5>4.1.1 å¥—æ¥å­—è¶…æ—¶</h5><p>å¥—æ¥å­—è¶…æ—¶ç”¨äºè®¾ç½®I/Oæ“ä½œçš„è¶…æ—¶æ—¶é—´ï¼Œé¿å…ç¨‹åºæ— é™æœŸé˜»å¡ï¼š</p><pre><code class="python"># è®¾ç½®å¥—æ¥å­—è¶…æ—¶
s.settimeout(5)  # 5ç§’è¶…æ—¶

# è·å–å¥—æ¥å­—è¶…æ—¶
timeout = s.gettimeout()</code></pre><h5>4.1.2 å¥—æ¥å­—åœ°å€é‡ç”¨</h5><p>å¥—æ¥å­—åœ°å€é‡ç”¨ç”¨äºå…è®¸åœ¨å¥—æ¥å­—å…³é—­åç«‹å³é‡ç”¨ç›¸åŒçš„åœ°å€å’Œç«¯å£ï¼š</p><pre><code class="python"># è®¾ç½®åœ°å€é‡ç”¨
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)</code></pre><h5>4.1.3 å¥—æ¥å­—ç¼“å†²åŒº</h5><p>å¥—æ¥å­—ç¼“å†²åŒºç”¨äºæ§åˆ¶æ•°æ®çš„æ”¶å‘é€Ÿåº¦ï¼š</p><pre><code class="python"># è·å–æ¥æ”¶ç¼“å†²åŒºå¤§å°
recv_buf = s.getsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF)

# è®¾ç½®æ¥æ”¶ç¼“å†²åŒºå¤§å°
s.setsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF, 8192)

# è·å–å‘é€ç¼“å†²åŒºå¤§å°
send_buf = s.getsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF)

# è®¾ç½®å‘é€ç¼“å†²åŒºå¤§å°
s.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 8192)</code></pre><h4>4.2 ç½‘ç»œåº“</h4><p>Pythonæä¾›äº†è®¸å¤šé«˜çº§ç½‘ç»œåº“ï¼Œç”¨äºç®€åŒ–ç½‘ç»œç¼–ç¨‹ï¼š</p><h5>4.2.1 socketserveræ¨¡å—</h5><p><code>socketserver</code>æ¨¡å—æä¾›äº†ä¸€ä¸ªæ¡†æ¶ï¼Œç”¨äºåˆ›å»ºç½‘ç»œæœåŠ¡å™¨ï¼š</p><ul><li><strong>TCPServer</strong>ï¼šTCPæœåŠ¡å™¨</li><li><strong>UDPServer</strong>ï¼šUDPæœåŠ¡å™¨</li><li><strong>ThreadingTCPServer</strong>ï¼šå¤šçº¿ç¨‹TCPæœåŠ¡å™¨</li><li><strong>ForkingTCPServer</strong>ï¼šå¤šè¿›ç¨‹TCPæœåŠ¡å™¨</li></ul><h5>4.2.2 httpæ¨¡å—</h5><p><code>http</code>æ¨¡å—æä¾›äº†HTTPåè®®çš„å®ç°ï¼š</p><ul><li><strong>http.server</strong>ï¼šHTTPæœåŠ¡å™¨</li><li><strong>http.client</strong>ï¼šHTTPå®¢æˆ·ç«¯</li></ul><h5>4.2.3 urllibæ¨¡å—</h5><p><code>urllib</code>æ¨¡å—æä¾›äº†URLå¤„ç†çš„åŠŸèƒ½ï¼š</p><ul><li><strong>urllib.request</strong>ï¼šæ‰“å¼€å’Œè¯»å–URL</li><li><strong>urllib.error</strong>ï¼šå¤„ç†URLLibçš„é”™è¯¯</li><li><strong>urllib.parse</strong>ï¼šè§£æURL</li><li><strong>urllib.robotparser</strong>ï¼šè§£ærobots.txtæ–‡ä»¶</li></ul><h5>4.2.4 requestsåº“</h5><p><code>requests</code>æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œç”¨äºç®€åŒ–HTTPè¯·æ±‚ï¼š</p><pre><code class="python">import requests

response = requests.get('https://www.baidu.com')
print(response.status_code)
print(response.text)</code></pre><h5>4.2.5 asyncioåº“</h5><p><code>asyncio</code>åº“æä¾›äº†å¼‚æ­¥I/Oçš„æ”¯æŒï¼Œç”¨äºå¤„ç†å¹¶å‘ç½‘ç»œæ“ä½œï¼š</p><pre><code class="python">import asyncio
import aiohttp

async def fetch_url(url):
    async with aiohttp.ClientSession() as session:
        async with session.get(url) as response:
            return await response.text()

async def main():
    html = await fetch_url('https://www.baidu.com')
    print(html[:100])

asyncio.run(main())</code></pre><h4>4.3 é«˜çº§ç½‘ç»œç¼–ç¨‹çš„ç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯é«˜çº§ç½‘ç»œç¼–ç¨‹çš„ä¸€äº›ç¤ºä¾‹ï¼š</p><pre><code class="python"># é«˜çº§ç½‘ç»œç¼–ç¨‹ç¤ºä¾‹

import socket
import socketserver
import http.server
import urllib.request
import urllib.parse
import urllib.error
import threading
import time

# 1. socketserveræ¨¡å—ç¤ºä¾‹
print("socketserveræ¨¡å—ç¤ºä¾‹ï¼š")

class MyTCPHandler(socketserver.BaseRequestHandler):
    """TCPè¯·æ±‚å¤„ç†å™¨"""
    def handle(self):
        # æ¥æ”¶æ•°æ®
        self.data = self.request.recv(1024).strip()
        print(f"æ”¶åˆ°æ¥è‡ª {self.client_address} çš„æ•°æ®: {self.data.decode('utf-8')}")
        
        # å‘é€å“åº”
        response = f"æœåŠ¡å™¨æ”¶åˆ°: {self.data.decode('utf-8')}"
        self.request.sendall(response.encode('utf-8'))
        print(f"å‘é€å“åº”åˆ° {self.client_address}: {response}")

def start_socketserver():
    """å¯åŠ¨socketserver"""
    HOST, PORT = "localhost", 9999
    
    # åˆ›å»ºæœåŠ¡å™¨
    with socketserver.TCPServer((HOST, PORT), MyTCPHandler) as server:
        print(f"socketserverå¯åŠ¨æˆåŠŸï¼Œç›‘å¬ {HOST}:{PORT}")
        # å¯åŠ¨æœåŠ¡å™¨
        server.serve_forever()

# å¯åŠ¨socketserverï¼ˆåœ¨åå°çº¿ç¨‹ä¸­ï¼‰
# threading.Thread(target=start_socketserver, daemon=True).start()
# time.sleep(1)  # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨

# æµ‹è¯•socketserver
def test_socketserver():
    """æµ‹è¯•socketserver"""
    HOST, PORT = "localhost", 9999
    
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
        sock.connect((HOST, PORT))
        sock.sendall(b"Hello, socketserver!")
        response = sock.recv(1024)
        print(f"æ”¶åˆ°å“åº”: {response.decode('utf-8')}")

# 2. http.serveræ¨¡å—ç¤ºä¾‹
print("\nhttp.serveræ¨¡å—ç¤ºä¾‹ï¼š")

def start_http_server():
    """å¯åŠ¨HTTPæœåŠ¡å™¨"""
    HOST, PORT = "localhost", 8000
    
    # åˆ›å»ºæœåŠ¡å™¨
    handler = http.server.SimpleHTTPRequestHandler
    with socketserver.TCPServer((HOST, PORT), handler) as httpd:
        print(f"HTTPæœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç›‘å¬ {HOST}:{PORT}")
        print(f"è®¿é—®åœ°å€: http://{HOST}:{PORT}")
        # å¯åŠ¨æœåŠ¡å™¨
        httpd.serve_forever()

# å¯åŠ¨HTTPæœåŠ¡å™¨ï¼ˆåœ¨åå°çº¿ç¨‹ä¸­ï¼‰
# threading.Thread(target=start_http_server, daemon=True).start()
# time.sleep(1)  # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨

# 3. urllibæ¨¡å—ç¤ºä¾‹
print("\nurllibæ¨¡å—ç¤ºä¾‹ï¼š")

def test_urllib():
    """æµ‹è¯•urllib"""
    # å‘é€GETè¯·æ±‚
    url = "https://www.baidu.com"
    print(f"å‘é€GETè¯·æ±‚åˆ°: {url}")
    
    try:
        with urllib.request.urlopen(url) as response:
            # è·å–å“åº”çŠ¶æ€ç 
            print(f"å“åº”çŠ¶æ€ç : {response.getcode()}")
            
            # è·å–å“åº”å¤´
            print("å“åº”å¤´:")
            for key, value in response.getheaders():
                print(f"  {key}: {value}")
            
            # è·å–å“åº”å†…å®¹
            content = response.read()
            print(f"å“åº”å†…å®¹é•¿åº¦: {len(content)} å­—èŠ‚")
            print(f"å“åº”å†…å®¹å‰100ä¸ªå­—ç¬¦: {content.decode('utf-8')[:100]}...")
            
    except urllib.error.URLError as e:
        print(f"URLé”™è¯¯: {e}")
    except Exception as e:
        print(f"é”™è¯¯: {e}")

# æµ‹è¯•urllib
# test_urllib()

# 4. è§£æURLç¤ºä¾‹
print("\nè§£æURLç¤ºä¾‹ï¼š")

def parse_url_example():
    """è§£æURL"""
    url = "https://www.python.org:8080/downloads/?ref=sidebar#latest"
    print(f"åŸå§‹URL: {url}")
    
    # è§£æURL
    parsed = urllib.parse.urlparse(url)
    print("è§£æç»“æœ:")
    print(f"  åè®®: {parsed.scheme}")
    print(f"  ç½‘ç»œä½ç½®: {parsed.netloc}")
    print(f"  è·¯å¾„: {parsed.path}")
    print(f"  å‚æ•°: {parsed.params}")
    print(f"  æŸ¥è¯¢: {parsed.query}")
    print(f"  ç‰‡æ®µ: {parsed.fragment}")
    
    # åˆ†è§£ç½‘ç»œä½ç½®
    netloc = parsed.netloc
    if '@' in netloc:
        auth, netloc = netloc.split('@', 1)
        print(f"  è®¤è¯ä¿¡æ¯: {auth}")
    
    if ':' in netloc:
        host, port = netloc.split(':', 1)
        print(f"  ä¸»æœº: {host}")
        print(f"  ç«¯å£: {port}")
    else:
        print(f"  ä¸»æœº: {netloc}")
        print(f"  ç«¯å£: æ— ")
    
    # æ„å»ºURL
    new_url = urllib.parse.urlunparse((
        'https', 'www.example.com', '/path', '', 'q=test', 'fragment'
    ))
    print(f"\næ„å»ºçš„æ–°URL: {new_url}")

# è§£æURL
parse_url_example()

# 5. å‘é€POSTè¯·æ±‚ç¤ºä¾‹
print("\nå‘é€POSTè¯·æ±‚ç¤ºä¾‹ï¼š")

def send_post_request():
    """å‘é€POSTè¯·æ±‚"""
    url = "http://httpbin.org/post"
    data = {
        "name": "Python",
        "version": "3.10"
    }
    
    # ç¼–ç æ•°æ®
    encoded_data = urllib.parse.urlencode(data).encode('utf-8')
    print(f"å‘é€POSTè¯·æ±‚åˆ°: {url}")
    print(f"å‘é€æ•°æ®: {data}")
    
    try:
        # åˆ›å»ºè¯·æ±‚
        req = urllib.request.Request(url, data=encoded_data, method='POST')
        req.add_header('Content-Type', 'application/x-www-form-urlencoded')
        
        with urllib.request.urlopen(req) as response:
            # è·å–å“åº”
            content = response.read()
            print(f"å“åº”çŠ¶æ€ç : {response.getcode()}")
            print(f"å“åº”å†…å®¹: {content.decode('utf-8')}")
            
    except urllib.error.URLError as e:
        print(f"URLé”™è¯¯: {e}")
    except Exception as e:
        print(f"é”™è¯¯: {e}")

# å‘é€POSTè¯·æ±‚
# send_post_request()

print("\né«˜çº§ç½‘ç»œç¼–ç¨‹ç¤ºä¾‹ç»“æŸ")</code></pre><h3>5. ç½‘ç»œç¼–ç¨‹çš„æœ€ä½³å®è·µ</h3><p>ç½‘ç»œç¼–ç¨‹æ˜¯Pythonç¼–ç¨‹ä¸­çš„é‡è¦éƒ¨åˆ†ï¼Œéµå¾ªä»¥ä¸‹æœ€ä½³å®è·µå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€å¯é æ€§å’Œæ€§èƒ½ã€‚</p><h4>5.1 é”™è¯¯å¤„ç†</h4><p>ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œé”™è¯¯å¤„ç†æ˜¯éå¸¸é‡è¦çš„ï¼Œåº”è¯¥æ•è·å’Œå¤„ç†å„ç§å¯èƒ½çš„å¼‚å¸¸ï¼š</p><ul><li><strong>è¿æ¥é”™è¯¯</strong>ï¼š<code>ConnectionError</code>ã€<code>TimeoutError</code></li><li><strong>åœ°å€é”™è¯¯</strong>ï¼š<code>socket.gaierror</code></li><li><strong>åè®®é”™è¯¯</strong>ï¼š<code>ProtocolError</code></li><li><strong>æ•°æ®é”™è¯¯</strong>ï¼š<code>ValueError</code>ã€<code>TypeError</code></li></ul><h4>5.2 è¶…æ—¶è®¾ç½®</h4><p>è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼Œé¿å…ç¨‹åºæ— é™æœŸé˜»å¡ï¼š</p><ul><li><strong>è¿æ¥è¶…æ—¶</strong>ï¼šè®¾ç½®è¿æ¥æœåŠ¡å™¨çš„è¶…æ—¶æ—¶é—´</li><li><strong>è¯»å–è¶…æ—¶</strong>ï¼šè®¾ç½®è¯»å–æ•°æ®çš„è¶…æ—¶æ—¶é—´</li><li><strong>å†™å…¥è¶…æ—¶</strong>ï¼šè®¾ç½®å†™å…¥æ•°æ®çš„è¶…æ—¶æ—¶é—´</li></ul><h4>5.3 èµ„æºç®¡ç†</h4><p>æ­£ç¡®ç®¡ç†ç½‘ç»œèµ„æºï¼Œé¿å…èµ„æºæ³„éœ²ï¼š</p><ul><li><strong>å…³é—­è¿æ¥</strong>ï¼šä½¿ç”¨<code>close()</code>æ–¹æ³•å…³é—­å¥—æ¥å­—</li><li><strong>ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨</strong>ï¼šä½¿ç”¨<code>with</code>è¯­å¥è‡ªåŠ¨å…³é—­å¥—æ¥å­—</li><li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­ç¡®ä¿å…³é—­èµ„æº</li></ul><h4>5.4 å¹¶å‘å¤„ç†</h4><p>å¯¹äºéœ€è¦å¤„ç†å¤šä¸ªè¿æ¥çš„åœºæ™¯ï¼Œåº”è¯¥ä½¿ç”¨åˆé€‚çš„å¹¶å‘æ¨¡å‹ï¼š</p><ul><li><strong>å•çº¿ç¨‹</strong>ï¼šé€‚ç”¨äºå¤„ç†å°‘é‡è¿æ¥çš„åœºæ™¯</li><li><strong>å¤šçº¿ç¨‹</strong>ï¼šé€‚ç”¨äºå¤„ç†ä¸­ç­‰æ•°é‡è¿æ¥çš„åœºæ™¯</li><li><strong>å¤šè¿›ç¨‹</strong>ï¼šé€‚ç”¨äºå¤„ç†CPUå¯†é›†å‹ä»»åŠ¡çš„åœºæ™¯</li><li><strong>I/Oå¤šè·¯å¤ç”¨</strong>ï¼šé€‚ç”¨äºå¤„ç†å¤§é‡è¿æ¥çš„åœºæ™¯</li><li><strong>å¼‚æ­¥I/O</strong>ï¼šé€‚ç”¨äºå¤„ç†å¤§é‡å¹¶å‘è¿æ¥çš„åœºæ™¯</li></ul><h4>5.5 å®‰å…¨è€ƒè™‘</h4><p>ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå®‰å…¨æ˜¯éå¸¸é‡è¦çš„ï¼š</p><ul><li><strong>è¾“å…¥éªŒè¯</strong>ï¼šéªŒè¯æ‰€æœ‰è¾“å…¥æ•°æ®ï¼Œé¿å…æ³¨å…¥æ”»å‡»</li><li><strong>åŠ å¯†é€šä¿¡</strong>ï¼šä½¿ç”¨HTTPSã€SSL/TLSç­‰åŠ å¯†åè®®</li><li><strong>èº«ä»½éªŒè¯</strong>ï¼šå®ç°é€‚å½“çš„èº«ä»½éªŒè¯æœºåˆ¶</li><li><strong>è®¿é—®æ§åˆ¶</strong>ï¼šå®ç°é€‚å½“çš„è®¿é—®æ§åˆ¶æœºåˆ¶</li><li><strong>é˜²æ­¢DDoSæ”»å‡»</strong>ï¼šå®ç°é€Ÿç‡é™åˆ¶ç­‰æœºåˆ¶</li></ul><h4>5.6 æ€§èƒ½ä¼˜åŒ–</h4><p>ç½‘ç»œç¼–ç¨‹çš„æ€§èƒ½ä¼˜åŒ–å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢å…¥æ‰‹ï¼š</p><ul><li><strong>ä½¿ç”¨åˆé€‚çš„å¹¶å‘æ¨¡å‹</strong>ï¼šæ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„å¹¶å‘æ¨¡å‹</li><li><strong>ä¼˜åŒ–ç¼“å†²åŒºå¤§å°</strong>ï¼šæ ¹æ®æ•°æ®å¤§å°è°ƒæ•´ç¼“å†²åŒºå¤§å°</li><li><strong>å‡å°‘ç½‘ç»œå¾€è¿”</strong>ï¼šæ‰¹é‡å¤„ç†æ•°æ®ï¼Œå‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•°</li><li><strong>ä½¿ç”¨è¿æ¥æ± </strong>ï¼šé‡ç”¨è¿æ¥ï¼Œå‡å°‘è¿æ¥å»ºç«‹çš„å¼€é”€</li><li><strong>å‹ç¼©æ•°æ®</strong>ï¼šä½¿ç”¨å‹ç¼©ç®—æ³•å‡å°‘æ•°æ®ä¼ è¾“é‡</li><li><strong>ä½¿ç”¨CDN</strong>ï¼šå¯¹äºé™æ€å†…å®¹ï¼Œä½¿ç”¨CDNåŠ é€Ÿ</li></ul><h4>5.7 ä»£ç ç»„ç»‡</h4><p>è‰¯å¥½çš„ä»£ç ç»„ç»‡å¯ä»¥æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼š</p><ul><li><strong>æ¨¡å—åŒ–</strong>ï¼šå°†ä»£ç åˆ†è§£ä¸ºå¤šä¸ªæ¨¡å—</li><li><strong>å°è£…</strong>ï¼šå°è£…ç½‘ç»œæ“ä½œä¸ºå‡½æ•°æˆ–ç±»</li><li><strong>æ–‡æ¡£</strong>ï¼šä¸ºä»£ç æ·»åŠ é€‚å½“çš„æ–‡æ¡£</li><li><strong>æµ‹è¯•</strong>ï¼šç¼–å†™æµ‹è¯•ä»£ç ç¡®ä¿åŠŸèƒ½æ­£ç¡®</li></ul><h4>5.8 ç½‘ç»œç¼–ç¨‹çš„æœ€ä½³å®è·µç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯ç½‘ç»œç¼–ç¨‹çš„æœ€ä½³å®è·µç¤ºä¾‹ï¼š</p><pre><code class="python"># ç½‘ç»œç¼–ç¨‹çš„æœ€ä½³å®è·µç¤ºä¾‹

import socket
import time
import ssl
import threading
from concurrent.futures import ThreadPoolExecutor

# 1. é”™è¯¯å¤„ç†ç¤ºä¾‹
print("é”™è¯¯å¤„ç†ç¤ºä¾‹ï¼š")

def safe_connect(host, port, timeout=5):
    """å®‰å…¨è¿æ¥ç¤ºä¾‹"""
    try:
        # åˆ›å»ºå¥—æ¥å­—
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        
        # è®¾ç½®è¶…æ—¶
        sock.settimeout(timeout)
        
        # è¿æ¥æœåŠ¡å™¨
        sock.connect((host, port))
        print(f"è¿æ¥ {host}:{port} æˆåŠŸ")
        
        # å…³é—­è¿æ¥
        sock.close()
        return True
        
    except socket.timeout:
        print(f"è¿æ¥ {host}:{port} è¶…æ—¶")
        return False
    except socket.gaierror:
        print(f"è§£æ {host} å¤±è´¥")
        return False
    except ConnectionRefusedError:
        print(f"è¿æ¥ {host}:{port} è¢«æ‹’ç»")
        return False
    except Exception as e:
        print(f"è¿æ¥ {host}:{port} å¤±è´¥: {e}")
        return False

# æµ‹è¯•è¿æ¥
safe_connect("www.baidu.com", 80)
safe_connect("www.nonexistentdomain12345.com", 80)
safe_connect("www.baidu.com", 8888)  # ä¸å­˜åœ¨çš„ç«¯å£

# 2. è¶…æ—¶è®¾ç½®ç¤ºä¾‹
print("\nè¶…æ—¶è®¾ç½®ç¤ºä¾‹ï¼š")

def test_timeout():
    """æµ‹è¯•è¶…æ—¶è®¾ç½®"""
    host, port = "www.baidu.com", 80
    
    # æµ‹è¯•ä¸åŒçš„è¶…æ—¶è®¾ç½®
    timeouts = [1, 3, 5]
    for timeout in timeouts:
        start_time = time.time()
        result = safe_connect(host, port, timeout)
        end_time = time.time()
        print(f"è¶…æ—¶è®¾ç½® {timeout} ç§’ï¼Œå®é™…è€—æ—¶ {end_time - start_time:.2f} ç§’")

# æµ‹è¯•è¶…æ—¶
test_timeout()

# 3. èµ„æºç®¡ç†ç¤ºä¾‹
print("\nèµ„æºç®¡ç†ç¤ºä¾‹ï¼š")

# ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨
class SocketContext:
    """å¥—æ¥å­—ä¸Šä¸‹æ–‡ç®¡ç†å™¨"""
    def __init__(self, family=socket.AF_INET, type=socket.SOCK_STREAM):
        self.family = family
        self.type = type
        self.sock = None
    
    def __enter__(self):
        """è¿›å…¥ä¸Šä¸‹æ–‡"""
        self.sock = socket.socket(self.family, self.type)
        return self.sock
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        """é€€å‡ºä¸Šä¸‹æ–‡"""
        if self.sock:
            self.sock.close()
            print("å¥—æ¥å­—å·²å…³é—­")

# ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨
print("ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼š")
with SocketContext() as sock:
    sock.settimeout(3)
    try:
        sock.connect(("www.baidu.com", 80))
        print("è¿æ¥æˆåŠŸ")
        # å‘é€HTTPè¯·æ±‚
        sock.sendall(b"GET / HTTP/1.1\r\nHost: www.baidu.com\r\nConnection: close\r\n\r\n")
        # æ¥æ”¶å“åº”
        data = sock.recv(1024)
        print(f"æ”¶åˆ°å“åº”ï¼š{data.decode('utf-8')[:100]}...")
    except Exception as e:
        print(f"é”™è¯¯ï¼š{e}")

# 4. å¹¶å‘å¤„ç†ç¤ºä¾‹
print("\nå¹¶å‘å¤„ç†ç¤ºä¾‹ï¼š")

def check_website(url):
    """æ£€æŸ¥ç½‘ç«™æ˜¯å¦å¯è®¿é—®"""
    try:
        # è§£æURL
        from urllib.parse import urlparse
        parsed = urlparse(url)
        host = parsed.netloc
        port = parsed.port or (443 if parsed.scheme == 'https' else 80)
        
        # è¿æ¥ç½‘ç«™
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
            sock.settimeout(3)
            sock.connect((host, port))
            
            # å¦‚æœæ˜¯HTTPSï¼Œè¿›è¡ŒSSLæ¡æ‰‹
            if parsed.scheme == 'https':
                context = ssl.create_default_context()
                with context.wrap_socket(sock, server_hostname=host) as ssock:
                    # å‘é€HTTPè¯·æ±‚
                    ssock.sendall(f"GET {parsed.path or '/'} HTTP/1.1\r\nHost: {host}\r\nConnection: close\r\n\r\n".encode('utf-8'))
                    # æ¥æ”¶å“åº”
                    data = ssock.recv(1024)
            else:
                # å‘é€HTTPè¯·æ±‚
                sock.sendall(f"GET {parsed.path or '/'} HTTP/1.1\r\nHost: {host}\r\nConnection: close\r\n\r\n".encode('utf-8'))
                # æ¥æ”¶å“åº”
                data = sock.recv(1024)
        
        print(f"{url} - å¯è®¿é—®")
        return True
        
    except Exception as e:
        print(f"{url} - ä¸å¯è®¿é—®: {e}")
        return False

# æµ‹è¯•ç½‘ç«™åˆ—è¡¨
websites = [
    "https://www.baidu.com",
    "https://www.google.com",
    "https://www.python.org",
    "https://www.github.com",
    "https://www.nonexistentdomain12345.com"
]

# ä¸²è¡Œæ£€æŸ¥
print("\nä¸²è¡Œæ£€æŸ¥ç½‘ç«™ï¼š")
start_time = time.time()
for website in websites:
    check_website(website)
end_time = time.time()
print(f"ä¸²è¡Œæ£€æŸ¥è€—æ—¶: {end_time - start_time:.2f} ç§’")

# å¹¶å‘æ£€æŸ¥
print("\nå¹¶å‘æ£€æŸ¥ç½‘ç«™ï¼š")
start_time = time.time()
with ThreadPoolExecutor(max_workers=5) as executor:
    executor.map(check_website, websites)
end_time = time.time()
print(f"å¹¶å‘æ£€æŸ¥è€—æ—¶: {end_time - start_time:.2f} ç§’")

# 5. å®‰å…¨é€šä¿¡ç¤ºä¾‹
print("\nå®‰å…¨é€šä¿¡ç¤ºä¾‹ï¼š")

def secure_communication():
    """å®‰å…¨é€šä¿¡ç¤ºä¾‹"""
    host, port = "www.baidu.com", 443
    
    try:
        # åˆ›å»ºå¥—æ¥å­—
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        
        # åˆ›å»ºSSLä¸Šä¸‹æ–‡
        context = ssl.create_default_context()
        
        # åŒ…è£…å¥—æ¥å­—
        with context.wrap_socket(sock, server_hostname=host) as ssock:
            # è¿æ¥æœåŠ¡å™¨
            ssock.connect((host, port))
            print(f"SSLè¿æ¥ {host}:{port} æˆåŠŸ")
            
            # è·å–è¯ä¹¦ä¿¡æ¯
            cert = ssock.getpeercert()
            print("\næœåŠ¡å™¨è¯ä¹¦ä¿¡æ¯ï¼š")
            print(f"ä¸»é¢˜: {dict(x[0] for x in cert['subject'])}")
            print(f"é¢å‘è€…: {dict(x[0] for x in cert['issuer'])}")
            print(f"æœ‰æ•ˆæœŸ: ä» {cert['notBefore']} åˆ° {cert['notAfter']}")
            
            # å‘é€HTTPè¯·æ±‚
            request = "GET / HTTP/1.1\r\n"
            request += f"Host: {host}\r\n"
            request += "Connection: close\r\n"
            request += "\r\n"
            ssock.sendall(request.encode('utf-8'))
            print("\nå‘é€HTTPSè¯·æ±‚")
            
            # æ¥æ”¶å“åº”
            response = b""
            while True:
                data = ssock.recv(1024)
                if not data:
                    break
                response += data
            
            # è§£æå“åº”
            response_str = response.decode('utf-8')
            print(f"\næ”¶åˆ°å“åº”ï¼ŒçŠ¶æ€ç : {response_str.split('\r\n')[0]}")
            print(f"å“åº”å¤´æ•°é‡: {len([line for line in response_str.split('\r\n') if line]) - 1}")
            
    except Exception as e:
        print(f"å®‰å…¨é€šä¿¡å¤±è´¥: {e}")

# æµ‹è¯•å®‰å…¨é€šä¿¡
secure_communication()

# 6. è¿æ¥æ± ç¤ºä¾‹
print("\nè¿æ¥æ± ç¤ºä¾‹ï¼š")

class ConnectionPool:
    """ç®€å•çš„è¿æ¥æ± """
    def __init__(self, host, port, max_connections=5):
        self.host = host
        self.port = port
        self.max_connections = max_connections
        self.pool = []
        self.lock = threading.Lock()
        
        # åˆå§‹åŒ–è¿æ¥æ± 
        for _ in range(max_connections):
            try:
                sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                sock.connect((host, port))
                self.pool.append(sock)
            except Exception as e:
                print(f"åˆå§‹åŒ–è¿æ¥å¤±è´¥: {e}")
        
        print(f"è¿æ¥æ± åˆå§‹åŒ–å®Œæˆï¼Œå¯ç”¨è¿æ¥æ•°: {len(self.pool)}")
    
    def get_connection(self):
        """è·å–è¿æ¥"""
        with self.lock:
            if self.pool:
                return self.pool.pop()
            else:
                # åˆ›å»ºæ–°è¿æ¥
                try:
                    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                    sock.connect((self.host, self.port))
                    print("åˆ›å»ºæ–°è¿æ¥")
                    return sock
                except Exception as e:
                    print(f"åˆ›å»ºè¿æ¥å¤±è´¥: {e}")
                    return None
    
    def return_connection(self, sock):
        """è¿”å›è¿æ¥"""
        with self.lock:
            if len(self.pool) &lt; self.max_connections:
                self.pool.append(sock)
            else:
                # è¿æ¥æ± å·²æ»¡ï¼Œå…³é—­è¿æ¥
                sock.close()
    
    def close_all(self):
        """å…³é—­æ‰€æœ‰è¿æ¥"""
        with self.lock:
            for sock in self.pool:
                try:
                    sock.close()
                except Exception:
                    pass
            self.pool = []
        print("è¿æ¥æ± å·²å…³é—­")

# ä½¿ç”¨è¿æ¥æ± 
def use_connection_pool():
    """ä½¿ç”¨è¿æ¥æ± """
    pool = ConnectionPool("www.baidu.com", 80, max_connections=3)
    
    # æ¨¡æ‹Ÿå¤šä¸ªçº¿ç¨‹ä½¿ç”¨è¿æ¥æ± 
    def worker(task_id):
        """å·¥ä½œçº¿ç¨‹"""
        sock = pool.get_connection()
        if sock:
            try:
                # å‘é€è¯·æ±‚
                request = f"GET / HTTP/1.1\r\nHost: www.baidu.com\r\nConnection: keep-alive\r\n\r\n"
                sock.sendall(request.encode('utf-8'))
                
                # æ¥æ”¶å“åº”
                data = sock.recv(1024)
                print(f"ä»»åŠ¡ {task_id} æ”¶åˆ°å“åº”: {data.decode('utf-8')[:50]}...")
                
                # æ¨¡æ‹Ÿå¤„ç†æ—¶é—´
                time.sleep(1)
                
            except Exception as e:
                print(f"ä»»åŠ¡ {task_id} é”™è¯¯: {e}")
            finally:
                # è¿”å›è¿æ¥
                pool.return_connection(sock)
    
    # åˆ›å»ºå¤šä¸ªå·¥ä½œçº¿ç¨‹
    threads = []
    for i in range(10):
        t = threading.Thread(target=worker, args=(i,))
        threads.append(t)
        t.start()
    
    # ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
    for t in threads:
        t.join()
    
    # å…³é—­è¿æ¥æ± 
    pool.close_all()

# æµ‹è¯•è¿æ¥æ± 
# use_connection_pool()

print("\nç½‘ç»œç¼–ç¨‹æœ€ä½³å®è·µç¤ºä¾‹ç»“æŸ")</code></pre><h3>6. å¸¸è§ç½‘ç»œç¼–ç¨‹é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3><p>åœ¨Pythonç½‘ç»œç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å„ç§é—®é¢˜ã€‚ç†è§£è¿™äº›é—®é¢˜çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆå¯¹äºæé«˜å¼€å‘æ•ˆç‡è‡³å…³é‡è¦ã€‚</p><h4>6.1 å¸¸è§é—®é¢˜</h4><ul><li><strong>è¿æ¥è¶…æ—¶</strong>ï¼šè¿æ¥æœåŠ¡å™¨æ—¶è¶…æ—¶</li><li><strong>è¿æ¥è¢«æ‹’ç»</strong>ï¼šæœåŠ¡å™¨æ‹’ç»è¿æ¥</li><li><strong>DNSè§£æå¤±è´¥</strong>ï¼šæ— æ³•è§£æåŸŸå</li><li><strong>SSLè¯ä¹¦é”™è¯¯</strong>ï¼šSSLè¯ä¹¦éªŒè¯å¤±è´¥</li><li><strong>æ•°æ®ä¼ è¾“ä¸å®Œæ•´</strong>ï¼šæ¥æ”¶çš„æ•°æ®ä¸å®Œæ•´</li><li><strong>å¹¶å‘è¿æ¥æ•°é™åˆ¶</strong>ï¼šè¶…è¿‡ç³»ç»Ÿçš„å¹¶å‘è¿æ¥æ•°é™åˆ¶</li><li><strong>ç«¯å£å ç”¨</strong>ï¼šç«¯å£å·²è¢«å…¶ä»–è¿›ç¨‹å ç”¨</li><li><strong>ç½‘ç»œä¸ç¨³å®š</strong>ï¼šç½‘ç»œè¿æ¥ä¸ç¨³å®šï¼Œé¢‘ç¹æ–­å¼€</li><li><strong>é˜²ç«å¢™é™åˆ¶</strong>ï¼šé˜²ç«å¢™é˜»æ­¢äº†è¿æ¥</li><li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šç½‘ç»œæ“ä½œæ€§èƒ½ä¸ä½³</li></ul><h4>6.2 è§£å†³æ–¹æ¡ˆ</h4><h5>6.2.1 è¿æ¥è¶…æ—¶</h5><p><strong>é—®é¢˜</strong>ï¼šè¿æ¥æœåŠ¡å™¨æ—¶è¶…æ—¶ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´</strong>ï¼šæ ¹æ®ç½‘ç»œç¯å¢ƒè®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´</li><li><strong>é‡è¯•æœºåˆ¶</strong>ï¼šå®ç°é‡è¯•æœºåˆ¶ï¼Œåœ¨è¶…æ—¶åé‡æ–°å°è¯•è¿æ¥</li><li><strong>å¼‚æ­¥I/O</strong>ï¼šä½¿ç”¨å¼‚æ­¥I/Oé¿å…é˜»å¡</li></ul><h5>6.2.2 è¿æ¥è¢«æ‹’ç»</h5><p><strong>é—®é¢˜</strong>ï¼šæœåŠ¡å™¨æ‹’ç»è¿æ¥ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€</strong>ï¼šç¡®ä¿æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ</li><li><strong>æ£€æŸ¥ç«¯å£é…ç½®</strong>ï¼šç¡®ä¿æœåŠ¡å™¨ç›‘å¬åœ¨æ­£ç¡®çš„ç«¯å£</li><li><strong>æ£€æŸ¥é˜²ç«å¢™</strong>ï¼šç¡®ä¿é˜²ç«å¢™æ²¡æœ‰é˜»æ­¢è¿æ¥</li><li><strong>æ£€æŸ¥ç½‘ç»œè¿æ¥</strong>ï¼šç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸</li></ul><h5>6.2.3 DNSè§£æå¤±è´¥</h5><p><strong>é—®é¢˜</strong>ï¼šæ— æ³•è§£æåŸŸåã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>æ£€æŸ¥åŸŸåæ˜¯å¦æ­£ç¡®</strong>ï¼šç¡®ä¿åŸŸåæ‹¼å†™æ­£ç¡®</li><li><strong>æ£€æŸ¥DNSæœåŠ¡å™¨</strong>ï¼šç¡®ä¿DNSæœåŠ¡å™¨æ­£å¸¸å·¥ä½œ</li><li><strong>ä½¿ç”¨IPåœ°å€</strong>ï¼šå¦‚æœå¯èƒ½ï¼Œç›´æ¥ä½¿ç”¨IPåœ°å€</li><li><strong>ç¼“å­˜DNSç»“æœ</strong>ï¼šå®ç°DNSç»“æœç¼“å­˜ï¼Œå‡å°‘DNSè§£ææ¬¡æ•°</li></ul><h5>6.2.4 SSLè¯ä¹¦é”™è¯¯</h5><p><strong>é—®é¢˜</strong>ï¼šSSLè¯ä¹¦éªŒè¯å¤±è´¥ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>ä½¿ç”¨æœ‰æ•ˆçš„è¯ä¹¦</strong>ï¼šç¡®ä¿æœåŠ¡å™¨ä½¿ç”¨æœ‰æ•ˆçš„SSLè¯ä¹¦</li><li><strong>æ›´æ–°è¯ä¹¦åº“</strong>ï¼šæ›´æ–°æœ¬åœ°çš„è¯ä¹¦åº“</li><li><strong>ç¦ç”¨è¯ä¹¦éªŒè¯</strong>ï¼šåœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œå¯ä»¥ç¦ç”¨è¯ä¹¦éªŒè¯ï¼ˆä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼‰</li><li><strong>æŒ‡å®šCAè¯ä¹¦</strong>ï¼šæŒ‡å®šæ­£ç¡®çš„CAè¯ä¹¦</li></ul><h5>6.2.5 æ•°æ®ä¼ è¾“ä¸å®Œæ•´</h5><p><strong>é—®é¢˜</strong>ï¼šæ¥æ”¶çš„æ•°æ®ä¸å®Œæ•´ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>å¾ªç¯æ¥æ”¶</strong>ï¼šå®ç°å¾ªç¯æ¥æ”¶ï¼Œç›´åˆ°æ”¶åˆ°å®Œæ•´çš„æ•°æ®</li><li><strong>ä½¿ç”¨å›ºå®šé•¿åº¦</strong>ï¼šå¦‚æœæ•°æ®é•¿åº¦å›ºå®šï¼Œä½¿ç”¨å›ºå®šé•¿åº¦æ¥æ”¶</li><li><strong>ä½¿ç”¨åˆ†éš”ç¬¦</strong>ï¼šä½¿ç”¨åˆ†éš”ç¬¦æ ‡è®°æ•°æ®ç»“æŸ</li><li><strong>ä½¿ç”¨é•¿åº¦å‰ç¼€</strong>ï¼šåœ¨æ•°æ®å‰æ·»åŠ é•¿åº¦å‰ç¼€</li></ul><h5>6.2.6 å¹¶å‘è¿æ¥æ•°é™åˆ¶</h5><p><strong>é—®é¢˜</strong>ï¼šè¶…è¿‡ç³»ç»Ÿçš„å¹¶å‘è¿æ¥æ•°é™åˆ¶ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>ä½¿ç”¨è¿æ¥æ± </strong>ï¼šé‡ç”¨è¿æ¥ï¼Œå‡å°‘è¿æ¥æ•°</li><li><strong>ä½¿ç”¨å¼‚æ­¥I/O</strong>ï¼šä½¿ç”¨å¼‚æ­¥I/Oå¤„ç†æ›´å¤šè¿æ¥</li><li><strong>è°ƒæ•´ç³»ç»Ÿå‚æ•°</strong>ï¼šè°ƒæ•´ç³»ç»Ÿçš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦é™åˆ¶</li><li><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šä½¿ç”¨è´Ÿè½½å‡è¡¡åˆ†æ•£è¿æ¥</li></ul><h5>6.2.7 ç«¯å£å ç”¨</h5><p><strong>é—®é¢˜</strong>ï¼šç«¯å£å·²è¢«å…¶ä»–è¿›ç¨‹å ç”¨ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>ä½¿ç”¨ä¸åŒçš„ç«¯å£</strong>ï¼šä½¿ç”¨æœªè¢«å ç”¨çš„ç«¯å£</li><li><strong>å…³é—­å ç”¨ç«¯å£çš„è¿›ç¨‹</strong>ï¼šå…³é—­å ç”¨ç«¯å£çš„è¿›ç¨‹</li><li><strong>ä½¿ç”¨SO_REUSEADDRé€‰é¡¹</strong>ï¼šå…è®¸é‡ç”¨åœ°å€</li></ul><h5>6.2.8 ç½‘ç»œä¸ç¨³å®š</h5><p><strong>é—®é¢˜</strong>ï¼šç½‘ç»œè¿æ¥ä¸ç¨³å®šï¼Œé¢‘ç¹æ–­å¼€ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>å®ç°é‡è¿æœºåˆ¶</strong>ï¼šåœ¨è¿æ¥æ–­å¼€åè‡ªåŠ¨é‡è¿</li><li><strong>ä½¿ç”¨å¿ƒè·³æœºåˆ¶</strong>ï¼šå®šæœŸå‘é€å¿ƒè·³åŒ…ä¿æŒè¿æ¥</li><li><strong>å¢åŠ è¶…æ—¶æ—¶é—´</strong>ï¼šå¢åŠ è¶…æ—¶æ—¶é—´ï¼Œå®¹å¿ç½‘ç»œå»¶è¿Ÿ</li><li><strong>ä½¿ç”¨å¯é çš„åè®®</strong>ï¼šä½¿ç”¨TCPç­‰å¯é çš„åè®®</li></ul><h5>6.2.9 é˜²ç«å¢™é™åˆ¶</h5><p><strong>é—®é¢˜</strong>ï¼šé˜²ç«å¢™é˜»æ­¢äº†è¿æ¥ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>é…ç½®é˜²ç«å¢™</strong>ï¼šé…ç½®é˜²ç«å¢™å…è®¸è¿æ¥</li><li><strong>ä½¿ç”¨å¸¸ç”¨ç«¯å£</strong>ï¼šä½¿ç”¨å¸¸ç”¨çš„ç«¯å£ï¼Œå¦‚80ã€443</li><li><strong>ä½¿ç”¨ä»£ç†</strong>ï¼šé€šè¿‡ä»£ç†æœåŠ¡å™¨è¿æ¥</li></ul><h5>6.2.10 æ€§èƒ½é—®é¢˜</h5><p><strong>é—®é¢˜</strong>ï¼šç½‘ç»œæ“ä½œæ€§èƒ½ä¸ä½³ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>ä½¿ç”¨åˆé€‚çš„å¹¶å‘æ¨¡å‹</strong>ï¼šæ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„å¹¶å‘æ¨¡å‹</li><li><strong>ä¼˜åŒ–ç¼“å†²åŒºå¤§å°</strong>ï¼šæ ¹æ®æ•°æ®å¤§å°è°ƒæ•´ç¼“å†²åŒºå¤§å°</li><li><strong>å‡å°‘ç½‘ç»œå¾€è¿”</strong>ï¼šæ‰¹é‡å¤„ç†æ•°æ®ï¼Œå‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•°</li><li><strong>ä½¿ç”¨è¿æ¥æ± </strong>ï¼šé‡ç”¨è¿æ¥ï¼Œå‡å°‘è¿æ¥å»ºç«‹çš„å¼€é”€</li><li><strong>å‹ç¼©æ•°æ®</strong>ï¼šä½¿ç”¨å‹ç¼©ç®—æ³•å‡å°‘æ•°æ®ä¼ è¾“é‡</li><li><strong>ä½¿ç”¨CDN</strong>ï¼šå¯¹äºé™æ€å†…å®¹ï¼Œä½¿ç”¨CDNåŠ é€Ÿ</li></ul><h4>6.3 å¸¸è§ç½‘ç»œç¼–ç¨‹é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆç¤ºä¾‹</h4><p>ä»¥ä¸‹æ˜¯å¸¸è§ç½‘ç»œç¼–ç¨‹é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆçš„ç¤ºä¾‹ï¼š</p><pre><code class="python"># å¸¸è§ç½‘ç»œç¼–ç¨‹é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆç¤ºä¾‹

import socket
import time
import ssl
import random

# 1. è¿æ¥è¶…æ—¶è§£å†³æ–¹æ¡ˆ
print("è¿æ¥è¶…æ—¶è§£å†³æ–¹æ¡ˆï¼š")

def retry_connect(host, port, max_retries=3, timeout=3):
    """å¸¦é‡è¯•æœºåˆ¶çš„è¿æ¥"""
    for i in range(max_retries):
        try:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock.settimeout(timeout)
            sock.connect((host, port))
            print(f"è¿æ¥ {host}:{port} æˆåŠŸ")
            return sock
        except socket.timeout:
            print(f"è¿æ¥ {host}:{port} è¶…æ—¶ï¼Œç¬¬ {i+1} æ¬¡é‡è¯•")
            time.sleep(1)  # ç­‰å¾…1ç§’åé‡è¯•
        except Exception as e:
            print(f"è¿æ¥ {host}:{port} å¤±è´¥: {e}")
            break
    return None

# æµ‹è¯•é‡è¯•è¿æ¥
sock = retry_connect("www.baidu.com", 80)
if sock:
    sock.close()

# 2. æ•°æ®ä¼ è¾“ä¸å®Œæ•´è§£å†³æ–¹æ¡ˆ
print("\næ•°æ®ä¼ è¾“ä¸å®Œæ•´è§£å†³æ–¹æ¡ˆï¼š")

def recv_all(sock, buffer_size=1024):
    """æ¥æ”¶å®Œæ•´çš„æ•°æ®"""
    data = b""
    while True:
        part = sock.recv(buffer_size)
        data += part
        if len(part) &lt; buffer_size:
            # æ•°æ®æ¥æ”¶å®Œæˆ
            break
    return data

def test_recv_all():
    """æµ‹è¯•æ¥æ”¶å®Œæ•´çš„æ•°æ®"""
    host, port = "www.baidu.com", 80
    
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
        sock.connect((host, port))
        
        # å‘é€HTTPè¯·æ±‚
        request = "GET / HTTP/1.1\r\n"
        request += f"Host: {host}\r\n"
        request += "Connection: close\r\n"
        request += "\r\n"
        sock.sendall(request.encode('utf-8'))
        
        # æ¥æ”¶å®Œæ•´çš„å“åº”
        response = recv_all(sock)
        print(f"æ¥æ”¶åˆ°å®Œæ•´çš„å“åº”ï¼Œé•¿åº¦: {len(response)} å­—èŠ‚")
        print(f"å“åº”çŠ¶æ€è¡Œ: {response.decode('utf-8').split('\r\n')[0]}")

# æµ‹è¯•æ¥æ”¶å®Œæ•´çš„æ•°æ®
test_recv_all()

# 3. SSLè¯ä¹¦é”™è¯¯è§£å†³æ–¹æ¡ˆ
print("\nSSLè¯ä¹¦é”™è¯¯è§£å†³æ–¹æ¡ˆï¼š")

def secure_connect_with_cert(host, port):
    """å®‰å…¨è¿æ¥ï¼ˆå¤„ç†è¯ä¹¦é”™è¯¯ï¼‰"""
    try:
        # åˆ›å»ºå¥—æ¥å­—
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        
        # åˆ›å»ºSSLä¸Šä¸‹æ–‡
        context = ssl.create_default_context()
        
        # åŒ…è£…å¥—æ¥å­—
        with context.wrap_socket(sock, server_hostname=host) as ssock:
            # è¿æ¥æœåŠ¡å™¨
            ssock.connect((host, port))
            print(f"SSLè¿æ¥ {host}:{port} æˆåŠŸ")
            
            # å‘é€HTTPè¯·æ±‚
            request = "GET / HTTP/1.1\r\n"
            request += f"Host: {host}\r\n"
            request += "Connection: close\r\n"
            request += "\r\n"
            ssock.sendall(request.encode('utf-8'))
            
            # æ¥æ”¶å“åº”
            response = recv_all(ssock)
            print(f"æ”¶åˆ°å“åº”ï¼ŒçŠ¶æ€ç : {response.decode('utf-8').split('\r\n')[0]}")
            
    except ssl.SSLCertVerificationError as e:
        print(f"SSLè¯ä¹¦éªŒè¯å¤±è´¥: {e}")
        # å¯ä»¥é€‰æ‹©åˆ›å»ºä¸éªŒè¯è¯ä¹¦çš„ä¸Šä¸‹æ–‡
        print("å°è¯•ä¸éªŒè¯è¯ä¹¦...")
        try:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            # åˆ›å»ºä¸éªŒè¯è¯ä¹¦çš„ä¸Šä¸‹æ–‡
            unsafe_context = ssl._create_unverified_context()
            with unsafe_context.wrap_socket(sock, server_hostname=host) as ssock:
                ssock.connect((host, port))
                print(f"ä¸éªŒè¯è¯ä¹¦çš„SSLè¿æ¥ {host}:{port} æˆåŠŸ")
        except Exception as e:
            print(f"ä¸éªŒè¯è¯ä¹¦çš„è¿æ¥å¤±è´¥: {e}")
    except Exception as e:
        print(f"å®‰å…¨è¿æ¥å¤±è´¥: {e}")

# æµ‹è¯•å®‰å…¨è¿æ¥
secure_connect_with_cert("www.baidu.com", 443)

# 4. ç«¯å£å ç”¨è§£å†³æ–¹æ¡ˆ
print("\nç«¯å£å ç”¨è§£å†³æ–¹æ¡ˆï¼š")

def find_free_port(start_port=8000, end_port=9000):
    """æŸ¥æ‰¾å¯ç”¨ç«¯å£"""
    for port in range(start_port, end_port):
        try:
            # å°è¯•ç»‘å®šç«¯å£
            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
                sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
                sock.bind(('localhost', port))
                print(f"ç«¯å£ {port} å¯ç”¨")
                return port
        except OSError:
            # ç«¯å£å·²è¢«å ç”¨
            pass
    print("æ²¡æœ‰æ‰¾åˆ°å¯ç”¨ç«¯å£")
    return None

# æŸ¥æ‰¾å¯ç”¨ç«¯å£
port = find_free_port()
if port:
    print(f"ä½¿ç”¨å¯ç”¨ç«¯å£: {port}")

# 5. ç½‘ç»œä¸ç¨³å®šè§£å†³æ–¹æ¡ˆ
print("\nç½‘ç»œä¸ç¨³å®šè§£å†³æ–¹æ¡ˆï¼š")

class ReconnectingSocket:
    """æ”¯æŒè‡ªåŠ¨é‡è¿çš„å¥—æ¥å­—"""
    def __init__(self, host, port, max_retries=3, timeout=3):
        self.host = host
        self.port = port
        self.max_retries = max_retries
        self.timeout = timeout
        self.sock = None
        self.connect()
    
    def connect(self):
        """è¿æ¥æœåŠ¡å™¨"""
        for i in range(self.max_retries):
            try:
                self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                self.sock.settimeout(self.timeout)
                self.sock.connect((self.host, self.port))
                print(f"è¿æ¥ {self.host}:{self.port} æˆåŠŸ")
                return True
            except Exception as e:
                print(f"è¿æ¥ {self.host}:{self.port} å¤±è´¥: {e}")
                time.sleep(1)
        return False
    
    def send(self, data):
        """å‘é€æ•°æ®"""
        try:
            if self.sock:
                self.sock.sendall(data)
                return True
        except Exception as e:
            print(f"å‘é€æ•°æ®å¤±è´¥: {e}")
            # å°è¯•é‡è¿
            if self.connect():
                self.sock.sendall(data)
                return True
        return False
    
    def recv(self, buffer_size=1024):
        """æ¥æ”¶æ•°æ®"""
        try:
            if self.sock:
                return self.sock.recv(buffer_size)
        except Exception as e:
            print(f"æ¥æ”¶æ•°æ®å¤±è´¥: {e}")
            # å°è¯•é‡è¿
            self.connect()
        return b""
    
    def close(self):
        """å…³é—­è¿æ¥"""
        if self.sock:
            try:
                self.sock.close()
            except Exception:
                pass
        print("è¿æ¥å·²å…³é—­")

# æµ‹è¯•è‡ªåŠ¨é‡è¿
def test_reconnecting_socket():
    """æµ‹è¯•è‡ªåŠ¨é‡è¿"""
    rsock = ReconnectingSocket("www.baidu.com", 80)
    
    # å‘é€æ•°æ®
    request = "GET / HTTP/1.1\r\n"
    request += "Host: www.baidu.com\r\n"
    request += "Connection: close\r\n"
    request += "\r\n"
    
    if rsock.send(request.encode('utf-8')):
        # æ¥æ”¶æ•°æ®
        data = rsock.recv(1024)
        print(f"æ”¶åˆ°æ•°æ®: {data.decode('utf-8')[:100]}...")
    
    # å…³é—­è¿æ¥
    rsock.close()

# æµ‹è¯•è‡ªåŠ¨é‡è¿
test_reconnecting_socket()

# 6. æ€§èƒ½ä¼˜åŒ–è§£å†³æ–¹æ¡ˆ
print("\næ€§èƒ½ä¼˜åŒ–è§£å†³æ–¹æ¡ˆï¼š")

# æµ‹è¯•ä¸åŒç¼“å†²åŒºå¤§å°çš„æ€§èƒ½
def test_buffer_size():
    """æµ‹è¯•ä¸åŒç¼“å†²åŒºå¤§å°çš„æ€§èƒ½"""
    host, port = "www.baidu.com", 80
    buffer_sizes = [1024, 2048, 4096, 8192, 16384]
    
    for buffer_size in buffer_sizes:
        start_time = time.time()
        
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
            sock.connect((host, port))
            
            # å‘é€HTTPè¯·æ±‚
            request = "GET / HTTP/1.1\r\n"
            request += f"Host: {host}\r\n"
            request += "Connection: close\r\n"
            request += "\r\n"
            sock.sendall(request.encode('utf-8'))
            
            # æ¥æ”¶å“åº”
            data = b""
            while True:
                part = sock.recv(buffer_size)
                if not part:
                    break
                data += part
        
        elapsed_time = time.time() - start_time
        print(f"ç¼“å†²åŒºå¤§å° {buffer_size} å­—èŠ‚: {elapsed_time:.4f} ç§’")

# æµ‹è¯•ç¼“å†²åŒºå¤§å°
test_buffer_size()

# 7. æ€»ç»“

æœ¬æ–‡è¯¦ç»†åˆ†æäº†Pythonä¸­çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹ä¸å¥—æ¥å­—APIï¼ŒåŒ…æ‹¬ï¼š

- **ç½‘ç»œç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µ**ï¼šç½‘ç»œåè®®ã€ç½‘ç»œæ¨¡å‹ã€å¥—æ¥å­—ã€ç½‘ç»œåœ°å€
- **å¥—æ¥å­—APIçš„ä½¿ç”¨**ï¼šåˆ›å»ºå¥—æ¥å­—ã€ç»‘å®šåœ°å€ã€ç›‘å¬è¿æ¥ã€æ¥å—è¿æ¥ã€å‘èµ·è¿æ¥ã€å‘é€æ•°æ®ã€æ¥æ”¶æ•°æ®ã€å…³é—­è¿æ¥
- **ç½‘ç»œç¼–ç¨‹æ¨¡å‹**ï¼šé˜»å¡å¼I/Oæ¨¡å‹ã€éé˜»å¡å¼I/Oæ¨¡å‹ã€å¤šè·¯å¤ç”¨I/Oæ¨¡å‹ã€ä¿¡å·é©±åŠ¨I/Oæ¨¡å‹ã€å¼‚æ­¥I/Oæ¨¡å‹
- **é«˜çº§ç½‘ç»œç¼–ç¨‹**ï¼šsocketserveræ¨¡å—ã€httpæ¨¡å—ã€urllibæ¨¡å—ã€requestsåº“ã€asyncioåº“
- **ç½‘ç»œç¼–ç¨‹çš„æœ€ä½³å®è·µ**ï¼šé”™è¯¯å¤„ç†ã€è¶…æ—¶è®¾ç½®ã€èµ„æºç®¡ç†ã€å¹¶å‘å¤„ç†ã€å®‰å…¨è€ƒè™‘ã€æ€§èƒ½ä¼˜åŒ–ã€ä»£ç ç»„ç»‡
- **å¸¸è§ç½‘ç»œç¼–ç¨‹é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ**ï¼šè¿æ¥è¶…æ—¶ã€è¿æ¥è¢«æ‹’ç»ã€DNSè§£æå¤±è´¥ã€SSLè¯ä¹¦é”™è¯¯ã€æ•°æ®ä¼ è¾“ä¸å®Œæ•´ã€å¹¶å‘è¿æ¥æ•°é™åˆ¶ã€ç«¯å£å ç”¨ã€ç½‘ç»œä¸ç¨³å®šã€é˜²ç«å¢™é™åˆ¶ã€æ€§èƒ½é—®é¢˜

Pythonçš„ç½‘ç»œç¼–ç¨‹æ˜¯ä¸€ç§å¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸æˆ‘ä»¬åˆ›å»ºå„ç§ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œä»ç®€å•çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨åº”ç”¨åˆ°å¤æ‚çš„WebæœåŠ¡å™¨ã€‚é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿï¼š

1. ç†è§£ç½‘ç»œç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µå’ŒåŸç†
2. æŒæ¡å¥—æ¥å­—APIçš„ä½¿ç”¨æ–¹æ³•
3. äº†è§£ä¸åŒçš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹åŠå…¶é€‚ç”¨åœºæ™¯
4. ç†Ÿç»ƒä½¿ç”¨Pythonçš„ç½‘ç»œåº“å’Œå·¥å…·
5. éµå¾ªç½‘ç»œç¼–ç¨‹çš„æœ€ä½³å®è·µ
6. è§£å†³å¸¸è§çš„ç½‘ç»œç¼–ç¨‹é—®é¢˜
7. ä¼˜åŒ–ç½‘ç»œåº”ç”¨ç¨‹åºçš„æ€§èƒ½

åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥æ ¹æ®å…·ä½“çš„åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹å’ŒæŠ€æœ¯ï¼Œéµå¾ªPythonçš„æœ€ä½³å®è·µï¼Œä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€å¯é æ€§å’Œæ€§èƒ½ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ä¿æŒå­¦ä¹ çš„æ€åº¦ï¼Œå…³æ³¨Pythonçš„æœ€æ–°å‘å±•ï¼Œä»¥å……åˆ†åˆ©ç”¨Pythonçš„å¼ºå¤§åŠŸèƒ½ã€‚

## 8. å‚è€ƒæ–‡çŒ®

1. Python Documentation: socket â€” Low-level networking interface
2. Python Documentation: socketserver â€” A framework for network servers
3. Python Documentation: http â€” HTTP modules
4. Python Documentation: urllib â€” URL handling modules
5. Python Documentation: ssl â€” TLS/SSL wrapper for socket objects
6. Python Documentation: asyncio â€” Asynchronous I/O
7. Real Python: Python Socket Programming Guide
8. Real Python: Python Networking Basics
9. Real Python: A Guide to Python's socket Module
10. MDN Web Docs: HTTP Overview

## 9. ç»“è¯­

Pythonçš„ç½‘ç»œç¼–ç¨‹æ˜¯Pythonç¼–ç¨‹çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ç®€å•è€Œå¼ºå¤§çš„æ–¹å¼æ¥å®ç°ç½‘ç»œé€šä¿¡ã€‚é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åº”è¯¥å·²ç»æŒæ¡äº†Pythonç½‘ç»œç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µå’ŒæŠ€æœ¯ã€‚

åœ¨ç¼–å†™Pythonç½‘ç»œåº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ï¼š

- **æ­£ç¡®ç†è§£ç½‘ç»œç¼–ç¨‹çš„åŸºæœ¬æ¦‚å¿µ**ï¼šäº†è§£ç½‘ç»œåè®®ã€ç½‘ç»œæ¨¡å‹ã€å¥—æ¥å­—ç­‰åŸºæœ¬æ¦‚å¿µ
- **é€‰æ‹©åˆé€‚çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹**ï¼šæ ¹æ®åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹
- **ä½¿ç”¨åˆé€‚çš„ç½‘ç»œåº“**ï¼šæ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„ç½‘ç»œåº“å’Œå·¥å…·
- **æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†**ï¼šæ•è·å’Œå¤„ç†å„ç§å¯èƒ½çš„å¼‚å¸¸
- **è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´**ï¼šé¿å…ç¨‹åºæ— é™æœŸé˜»å¡
- **æ­£ç¡®ç®¡ç†ç½‘ç»œèµ„æº**ï¼šç¡®ä¿ç½‘ç»œèµ„æºçš„æ­£ç¡®é‡Šæ”¾
- **è€ƒè™‘å®‰å…¨å› ç´ **ï¼šå®ç°é€‚å½“çš„å®‰å…¨æªæ–½
- **ä¼˜åŒ–æ€§èƒ½**ï¼šæ ¹æ®éœ€è¦ä¼˜åŒ–ç½‘ç»œåº”ç”¨ç¨‹åºçš„æ€§èƒ½
- **ç»„ç»‡å¥½ä»£ç **ï¼šä¿æŒä»£ç çš„æ¸…æ™°å’Œå¯ç»´æŠ¤æ€§

é€šè¿‡éµå¾ªè¿™äº›åŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨Pythonçš„ç½‘ç»œç¼–ç¨‹åŠŸèƒ½ï¼Œç¼–å†™æ›´åŠ å¥å£®ã€é«˜æ•ˆå’Œå¯ç»´æŠ¤çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚ç½‘ç»œç¼–ç¨‹ä¸ä»…æ˜¯ä¸€ç§åŸºæœ¬çš„ç¼–ç¨‹æŠ€èƒ½ï¼Œæ›´æ˜¯ä¸€ç§è§£å†³å®é™…é—®é¢˜çš„é‡è¦å·¥å…·ï¼Œå®ƒåœ¨Webå¼€å‘ã€åˆ†å¸ƒå¼ç³»ç»Ÿã€ç½‘ç»œå·¥å…·ç­‰æ–¹é¢éƒ½æœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚

å¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¸®åŠ©è¯»è€…ç†è§£Pythonçš„ç½‘ç»œç¼–ç¨‹æ¨¡å‹ä¸å¥—æ¥å­—APIï¼ŒæŒæ¡ç½‘ç»œç¼–ç¨‹çš„æœ€ä½³å®è·µï¼Œä»è€Œåœ¨å®é™…å¼€å‘ä¸­ç¼–å†™å‡ºæ›´é«˜è´¨é‡çš„Pythonç½‘ç»œåº”ç”¨ç¨‹åºã€‚</code></pre>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„ç±»å‹ç³»ç»Ÿä¸ç±»å‹æ³¨è§£è¿›é˜¶ é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585267</link>    <guid>https://segmentfault.com/a/1190000047585267</guid>    <pubDate>2026-02-01 02:04:13</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„ç±»å‹ç³»ç»Ÿä¸ç±»å‹æ³¨è§£è¿›é˜¶</h2><h3>1. ç±»å‹ç³»ç»Ÿæ¦‚è¿°</h3><h4>1.1 åŠ¨æ€ç±»å‹ä¸é™æ€ç±»å‹</h4><p>Pythonä½œä¸ºä¸€ç§åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œå…¶å˜é‡ç±»å‹åœ¨è¿è¡Œæ—¶ç¡®å®šï¼Œè¿™ä¸ºå¼€å‘è€…æä¾›äº†æå¤§çš„çµæ´»æ€§ã€‚ç„¶è€Œï¼Œéšç€é¡¹ç›®è§„æ¨¡çš„æ‰©å¤§ï¼ŒåŠ¨æ€ç±»å‹å¸¦æ¥çš„ç±»å‹é”™è¯¯é£é™©ä¹Ÿéšä¹‹å¢åŠ ã€‚ç±»å‹æ³¨è§£ï¼ˆType Hintsï¼‰çš„å¼•å…¥ï¼Œä¸ºPythonæä¾›äº†é™æ€ç±»å‹æ£€æŸ¥çš„èƒ½åŠ›ï¼Œå¹³è¡¡äº†çµæ´»æ€§ä¸ä»£ç å¯é æ€§ã€‚</p><h4>1.2 ç±»å‹æ³¨è§£çš„æ¼”è¿›</h4><ul><li>Python 3.5ï¼šå¼•å…¥åŸºæœ¬ç±»å‹æ³¨è§£è¯­æ³•</li><li>Python 3.6ï¼šæ”¯æŒå˜é‡æ³¨è§£</li><li>Python 3.7ï¼šæ”¯æŒ<code>from __future__ import annotations</code>å»¶è¿Ÿæ³¨è§£è¯„ä¼°</li><li>Python 3.8ï¼šå¼•å…¥å­—é¢é‡ç±»å‹ä¸<code>Final</code>ç±»å‹</li><li>Python 3.9ï¼šå†…ç½®æ³›å‹ç±»å‹æ”¯æŒ</li><li>Python 3.10ï¼šå¼•å…¥è”åˆç±»å‹è¯­æ³•<code>X | Y</code>å’Œç±»å‹åˆ«å</li></ul><h3>2. åŸºæœ¬ç±»å‹æ³¨è§£</h3><h4>2.1 å‡½æ•°å‚æ•°ä¸è¿”å›å€¼æ³¨è§£</h4><pre><code class="python">def add(a: int, b: int) -&gt; int:
    return a + b

def greet(name: str) -&gt; str:
    return f"Hello, {name}!"</code></pre><h4>2.2 å˜é‡æ³¨è§£</h4><pre><code class="python">age: int = 25
name: str = "Alice"
is_student: bool = True</code></pre><h4>2.3 å¤åˆç±»å‹æ³¨è§£</h4><pre><code class="python">from typing import List, Dict, Tuple

numbers: List[int] = [1, 2, 3]
person: Dict[str, str] = {"name": "Bob", "age": "30"}
coordinates: Tuple[float, float] = (1.0, 2.0)</code></pre><h3>3. é«˜çº§ç±»å‹æ³¨è§£æŠ€å·§</h3><h4>3.1 æ³›å‹ç±»å‹</h4><p>æ³›å‹å…è®¸æˆ‘ä»¬å®šä¹‰é€‚ç”¨äºå¤šç§ç±»å‹çš„å‡½æ•°å’Œç±»ï¼š</p><pre><code class="python">from typing import TypeVar, Generic, List

T = TypeVar('T')

class Stack(Generic[T]):
    def __init__(self):
        self.items: List[T] = []
    
    def push(self, item: T) -&gt; None:
        self.items.append(item)
    
    def pop(self) -&gt; T:
        return self.items.pop()

# ä½¿ç”¨æ³›å‹æ ˆ
int_stack: Stack[int] = Stack()
str_stack: Stack[str] = Stack()</code></pre><h4>3.2 è”åˆç±»å‹ä¸å¯é€‰ç±»å‹</h4><p>è”åˆç±»å‹è¡¨ç¤ºå˜é‡å¯ä»¥æ˜¯å¤šç§ç±»å‹ä¹‹ä¸€ï¼š</p><pre><code class="python">from typing import Union, Optional

# è”åˆç±»å‹
value: Union[int, str, float] = 42

# å¯é€‰ç±»å‹ï¼ˆç­‰åŒäºUnion[T, None]ï¼‰
def get_user(id: int) -&gt; Optional[Dict[str, str]]:
    # å¯èƒ½è¿”å›ç”¨æˆ·ä¿¡æ¯æˆ–None
    pass

# Python 3.10+ è”åˆç±»å‹è¯­æ³•
value: int | str | float = "hello"
optional_value: str | None = None</code></pre><h4>3.3 å­—é¢é‡ç±»å‹ä¸å¸¸é‡ç±»å‹</h4><p>å­—é¢é‡ç±»å‹é™åˆ¶å˜é‡åªèƒ½å–ç‰¹å®šçš„å€¼ï¼š</p><pre><code class="python">from typing import Literal, Final

# å­—é¢é‡ç±»å‹
def set_mode(mode: Literal["read", "write", "append"]) -&gt; None:
    pass

# å¸¸é‡ç±»å‹
MAX_SIZE: Final[int] = 100</code></pre><h4>3.4 å¯è°ƒç”¨ç±»å‹ä¸ç±»å‹åˆ«å</h4><pre><code class="python">from typing import Callable, TypeAlias

# å¯è°ƒç”¨ç±»å‹
Callback: TypeAlias = Callable[[int, str], bool]

def process_data(data: List[int], callback: Callback) -&gt; None:
    pass

# ç±»å‹åˆ«å
UserId: TypeAlias = int
UserDict: TypeAlias = Dict[str, Union[str, int, bool]]</code></pre><h3>4. ç±»å‹æ£€æŸ¥å·¥å…·</h3><h4>4.1 mypy</h4><p>mypyæ˜¯Pythonæœ€æµè¡Œçš„é™æ€ç±»å‹æ£€æŸ¥å·¥å…·ï¼š</p><pre><code class="bash"># å®‰è£…
pip install mypy

# æ£€æŸ¥å•ä¸ªæ–‡ä»¶
mypy example.py

# æ£€æŸ¥æ•´ä¸ªé¡¹ç›®
mypy .</code></pre><h4>4.2 pyrightä¸pylance</h4><ul><li><strong>pyright</strong>ï¼šMicrosoftå¼€å‘çš„å¿«é€Ÿé™æ€ç±»å‹æ£€æŸ¥å™¨</li><li><strong>pylance</strong>ï¼šVS Codeçš„Pythonè¯­è¨€æœåŠ¡å™¨ï¼Œé›†æˆäº†pyright</li></ul><h4>4.3 é…ç½®æ–‡ä»¶</h4><p>åˆ›å»º<code>pyproject.toml</code>æˆ–<code>mypy.ini</code>é…ç½®æ–‡ä»¶ï¼š</p><pre><code class="toml"># pyproject.toml
[tool.mypy]
python_version = "3.10"
strict = true
warn_return_any = true
warn_unused_configs = true</code></pre><h3>5. ç±»å‹æ³¨è§£çš„æœ€ä½³å®è·µ</h3><h4>5.1 ä½•æ—¶ä½¿ç”¨ç±»å‹æ³¨è§£</h4><ul><li><strong>å…¬å…±API</strong>ï¼šä¸ºæ¨¡å—ã€å‡½æ•°å’Œç±»çš„å…¬å…±æ¥å£æ·»åŠ ç±»å‹æ³¨è§£</li><li><strong>å¤æ‚é€»è¾‘</strong>ï¼šä¸ºåŒ…å«å¤æ‚ç±»å‹è½¬æ¢çš„ä»£ç æ·»åŠ æ³¨è§£</li><li><strong>å¤§å‹é¡¹ç›®</strong>ï¼šåœ¨å¤§å‹ä»£ç åº“ä¸­å…¨é¢ä½¿ç”¨ç±»å‹æ³¨è§£</li><li><strong>å›¢é˜Ÿåä½œ</strong>ï¼šæé«˜ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§</li></ul><h4>5.2 é¿å…è¿‡åº¦æ³¨è§£</h4><ul><li>ç®€å•çš„å±€éƒ¨å˜é‡å¯ä»¥çœç•¥ç±»å‹æ³¨è§£</li><li>æ˜æ˜¾çš„ç±»å‹å¯ä»¥çœç•¥æ³¨è§£</li><li>ä½¿ç”¨ç±»å‹æ¨æ–­å‡å°‘å†—ä½™æ³¨è§£</li></ul><h4>5.3 ç±»å‹æ³¨è§£ä¸æ–‡æ¡£å­—ç¬¦ä¸²</h4><p>ç»“åˆç±»å‹æ³¨è§£å’Œæ–‡æ¡£å­—ç¬¦ä¸²ï¼Œæä¾›æ›´å…¨é¢çš„ä»£ç æ–‡æ¡£ï¼š</p><pre><code class="python">def calculate_area(radius: float) -&gt; float:
    """
    è®¡ç®—åœ†çš„é¢ç§¯
    
    Args:
        radius: åœ†çš„åŠå¾„
    
    Returns:
        åœ†çš„é¢ç§¯
    """
    return 3.14159 * radius ** 2</code></pre><h3>6. å®é™…åº”ç”¨æ¡ˆä¾‹</h3><h4>6.1 æ•°æ®éªŒè¯</h4><p>ä½¿ç”¨ç±»å‹æ³¨è§£ç»“åˆç¬¬ä¸‰æ–¹åº“è¿›è¡Œæ•°æ®éªŒè¯ï¼š</p><pre><code class="python">from pydantic import BaseModel

class User(BaseModel):
    id: int
    name: str
    email: str
    age: int

# è‡ªåŠ¨éªŒè¯
user = User(id=1, name="Alice", email="alice@example.com", age=25)</code></pre><h4>6.2 APIå¼€å‘</h4><p>åœ¨FastAPIç­‰æ¡†æ¶ä¸­ï¼Œç±»å‹æ³¨è§£ç”¨äºè‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£å’Œè¯·æ±‚éªŒè¯ï¼š</p><pre><code class="python">from fastapi import FastAPI
from typing import List

app = FastAPI()

@app.post("/items/")
def create_item(name: str, price: float, tags: List[str] = None):
    return {"name": name, "price": price, "tags": tags}</code></pre><h4>6.3 ç±»å‹åŒ–çš„é…ç½®ç®¡ç†</h4><pre><code class="python">from typing import Dict, Any
from dataclasses import dataclass

@dataclass
class DatabaseConfig:
    host: str
    port: int
    username: str
    password: str

@dataclass
class AppConfig:
    debug: bool
    database: DatabaseConfig
    secret_key: str

config: AppConfig = AppConfig(
    debug=True,
    database=DatabaseConfig(
        host="localhost",
        port=5432,
        username="admin",
        password="secret"
    ),
    secret_key="supersecret"
)</code></pre><h3>7. ç±»å‹æ³¨è§£çš„æ€§èƒ½å½±å“</h3><h4>7.1 è¿è¡Œæ—¶å¼€é”€</h4><ul><li>ç±»å‹æ³¨è§£åœ¨è¿è¡Œæ—¶å­˜å‚¨åœ¨<code>__annotations__</code>å±æ€§ä¸­</li><li>åŸºæœ¬ç±»å‹æ³¨è§£çš„è¿è¡Œæ—¶å¼€é”€æå°</li><li>å¤æ‚æ³›å‹ç±»å‹å¯èƒ½ä¼šæœ‰è½»å¾®çš„å†…å­˜å¼€é”€</li></ul><h4>7.2 ç¼–è¯‘æ—¶ä¼˜åŒ–</h4><ul><li>ä¸€äº›JITç¼–è¯‘å™¨ï¼ˆå¦‚PyPyï¼‰å¯ä»¥åˆ©ç”¨ç±»å‹æ³¨è§£è¿›è¡Œä¼˜åŒ–</li><li>é™æ€ç±»å‹æ£€æŸ¥å¯ä»¥åœ¨ç¼–è¯‘æ—¶æ•è·é”™è¯¯ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯</li></ul><h3>8. æœªæ¥å‘å±•è¶‹åŠ¿</h3><h4>8.1 PEP 646ï¼šå¯å˜æ³›å‹</h4><p>å…è®¸æ›´çµæ´»çš„æ³›å‹ç±»å‹å®šä¹‰ï¼Œæ”¯æŒä»»æ„æ•°é‡çš„ç±»å‹å‚æ•°ã€‚</p><h4>8.2 PEP 673ï¼š<code>Self</code>ç±»å‹</h4><p>ç®€åŒ–ç±»æ–¹æ³•çš„è¿”å›ç±»å‹æ³¨è§£ï¼š</p><pre><code class="python">from typing import Self

class MyClass:
    def method(self) -&gt; Self:
        return self</code></pre><h4>8.3 PEP 688ï¼š<code>LiteralString</code>ç±»å‹</h4><p>ç”¨äºæ ‡è®°å­—é¢é‡å­—ç¬¦ä¸²ï¼Œå¢å¼ºç±»å‹å®‰å…¨ã€‚</p><h3>9. æ€»ç»“</h3><p>Pythonçš„ç±»å‹ç³»ç»Ÿå’Œç±»å‹æ³¨è§£æ˜¯ç°ä»£Pythonå¼€å‘çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚é€šè¿‡åˆç†ä½¿ç”¨ç±»å‹æ³¨è§£ï¼Œå¼€å‘è€…å¯ä»¥ï¼š</p><ol><li><strong>æé«˜ä»£ç å¯è¯»æ€§</strong>ï¼šç±»å‹æ³¨è§£ä½œä¸ºä¸€ç§æ–‡æ¡£å½¢å¼ï¼Œæ¸…æ™°è¡¨è¾¾å‡½æ•°å’Œå˜é‡çš„é¢„æœŸç±»å‹</li><li><strong>å‡å°‘ç±»å‹é”™è¯¯</strong>ï¼šé™æ€ç±»å‹æ£€æŸ¥å¯ä»¥åœ¨ç¼–è¯‘æ—¶æ•è·æ½œåœ¨çš„ç±»å‹é—®é¢˜</li><li><strong>æ”¹å–„IDEæ”¯æŒ</strong>ï¼šç±»å‹æ³¨è§£ä½¿IDEèƒ½å¤Ÿæä¾›æ›´å‡†ç¡®çš„ä»£ç è¡¥å…¨å’Œç±»å‹æç¤º</li><li><strong>å¢å¼ºä»£ç å¯ç»´æŠ¤æ€§</strong>ï¼šç±»å‹ä¿¡æ¯ä½¿ä»£ç æ›´å®¹æ˜“ç†è§£å’Œé‡æ„</li><li><strong>ä¿ƒè¿›å›¢é˜Ÿåä½œ</strong>ï¼šç»Ÿä¸€çš„ç±»å‹æ ‡æ³¨é£æ ¼æœ‰åŠ©äºå›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„æ²Ÿé€š</li></ol><p>éšç€Pythonç±»å‹ç³»ç»Ÿçš„ä¸æ–­å®Œå–„ï¼Œç±»å‹æ³¨è§£å°†åœ¨Pythonç”Ÿæ€ç³»ç»Ÿä¸­å‘æŒ¥è¶Šæ¥è¶Šé‡è¦çš„ä½œç”¨ã€‚å¯¹äºå¤§å‹é¡¹ç›®å’Œå›¢é˜Ÿæ¥è¯´ï¼Œé‡‡ç”¨ç±»å‹æ³¨è§£å·²ç»æˆä¸ºä¸€ç§æœ€ä½³å®è·µï¼Œèƒ½å¤Ÿæ˜¾è‘—æé«˜ä»£ç è´¨é‡å’Œå¼€å‘æ•ˆç‡ã€‚</p>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„å…ƒç±»ç¼–ç¨‹ä¸ç±»æ„é€ æœºåˆ¶æ·±åº¦è§£æ é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585270</link>    <guid>https://segmentfault.com/a/1190000047585270</guid>    <pubDate>2026-02-01 02:03:32</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„å…ƒç±»ç¼–ç¨‹ä¸ç±»æ„é€ æœºåˆ¶æ·±åº¦è§£æ</h2><h3>1. å…ƒç±»çš„åŸºæœ¬æ¦‚å¿µ</h3><h4>1.1 ä»€ä¹ˆæ˜¯å…ƒç±»</h4><p>å…ƒç±»ï¼ˆMetaclassï¼‰æ˜¯Pythonä¸­åˆ›å»ºç±»çš„ç±»ï¼Œæ˜¯ç±»çš„æ¨¡æ¿ã€‚åœ¨Pythonä¸­ï¼Œä¸€åˆ‡çš†å¯¹è±¡ï¼Œç±»æœ¬èº«ä¹Ÿæ˜¯å¯¹è±¡ï¼Œè€Œå…ƒç±»å°±æ˜¯åˆ›å»ºè¿™äº›ç±»å¯¹è±¡çš„å·¥å‚ã€‚</p><h4>1.2 ç±»ä¸å…ƒç±»çš„å…³ç³»</h4><ul><li><strong>å¯¹è±¡</strong>ï¼šç”±ç±»åˆ›å»ºçš„å®ä¾‹</li><li><strong>ç±»</strong>ï¼šç”±å…ƒç±»åˆ›å»ºçš„å®ä¾‹</li><li><strong>å…ƒç±»</strong>ï¼šåˆ›å»ºç±»çš„ç±»ï¼Œé»˜è®¤æ˜¯<code>type</code></li></ul><pre><code class="python"># æŸ¥çœ‹ç±»çš„å…ƒç±»
class MyClass:
    pass

print(type(MyClass))  # &lt;class 'type'&gt;
print(type(type))     # &lt;class 'type'&gt;</code></pre><h4>1.3 å…ƒç±»çš„ä½œç”¨</h4><ul><li>æ§åˆ¶ç±»çš„åˆ›å»ºè¿‡ç¨‹</li><li>ä¿®æ”¹ç±»çš„å±æ€§å’Œæ–¹æ³•</li><li>å®ç°å•ä¾‹æ¨¡å¼ã€æ³¨å†Œè¡¨æ¨¡å¼ç­‰è®¾è®¡æ¨¡å¼</li><li>è‡ªåŠ¨æ³¨å†Œç±»ã€æ·»åŠ æ–¹æ³•æˆ–å±æ€§</li><li>å®ç°ORMæ¡†æ¶ç­‰é«˜çº§åŠŸèƒ½</li></ul><h3>2. typeå…ƒç±»</h3><h4>2.1 typeçš„åŸºæœ¬ç”¨æ³•</h4><p><code>type</code>æ˜¯Pythonçš„å†…ç½®å…ƒç±»ï¼Œå®ƒæœ‰ä¸¤ç§ç”¨æ³•ï¼š</p><ol><li><strong>æŸ¥çœ‹å¯¹è±¡ç±»å‹</strong>ï¼š<code>type(object)</code></li><li><strong>åŠ¨æ€åˆ›å»ºç±»</strong>ï¼š<code>type(name, bases, namespace)</code></li></ol><pre><code class="python"># åŠ¨æ€åˆ›å»ºç±»
MyDynamicClass = type('MyDynamicClass', (), {
    'greeting': 'Hello',
    'say_hello': lambda self: print(self.greeting)
})

instance = MyDynamicClass()
instance.say_hello()  # è¾“å‡º: Hello</code></pre><h4>2.2 typeåˆ›å»ºç±»çš„è¿‡ç¨‹</h4><ol><li><strong>åç§°</strong>ï¼šç±»çš„åç§°</li><li><strong>åŸºç±»</strong>ï¼šç±»ç»§æ‰¿çš„çˆ¶ç±»å…ƒç»„</li><li><strong>å‘½åç©ºé—´</strong>ï¼šç±»çš„å±æ€§å’Œæ–¹æ³•å­—å…¸</li></ol><pre><code class="python"># å¸¦æœ‰ç»§æ‰¿çš„åŠ¨æ€ç±»åˆ›å»º
class BaseClass:
    def base_method(self):
        print("Base method")

DerivedClass = type('DerivedClass', (BaseClass,), {
    'derived_method': lambda self: print("Derived method")
})

instance = DerivedClass()
instance.base_method()    # è¾“å‡º: Base method
instance.derived_method()  # è¾“å‡º: Derived method</code></pre><h3>3. è‡ªå®šä¹‰å…ƒç±»</h3><h4>3.1 ç»§æ‰¿typeåˆ›å»ºå…ƒç±»</h4><pre><code class="python">class MyMetaclass(type):
    def __new__(mcs, name, bases, namespace):
        # åœ¨ç±»åˆ›å»ºä¹‹å‰ä¿®æ”¹
        namespace['added_by_metaclass'] = 'This attribute was added by the metaclass'
        return super().__new__(mcs, name, bases, namespace)
    
    def __init__(cls, name, bases, namespace):
        # åœ¨ç±»åˆ›å»ºä¹‹ååˆå§‹åŒ–
        print(f"Initializing class {name}")
        super().__init__(name, bases, namespace)

# ä½¿ç”¨è‡ªå®šä¹‰å…ƒç±»
class MyClass(metaclass=MyMetaclass):
    def __init__(self, value):
        self.value = value

print(MyClass.added_by_metaclass)  # è¾“å‡º: This attribute was added by the metaclass</code></pre><h4>3.2 <strong>new</strong> vs <strong>init</strong></h4><ul><li><strong><strong>new</strong></strong>ï¼šåˆ›å»ºç±»å¯¹è±¡ï¼Œè¿”å›æ–°åˆ›å»ºçš„ç±»</li><li><strong><strong>init</strong></strong>ï¼šåˆå§‹åŒ–å·²åˆ›å»ºçš„ç±»å¯¹è±¡ï¼Œæ— è¿”å›å€¼</li></ul><h4>3.3 å…ƒç±»çš„æ–¹æ³•è§£æé¡ºåº</h4><p>å½“è°ƒç”¨ç±»çš„æ–¹æ³•æ—¶ï¼ŒPythonä¼šæŒ‰ç…§ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾ï¼š</p><ol><li>å®ä¾‹çš„<code>__dict__</code></li><li>ç±»çš„<code>__dict__</code></li><li>çˆ¶ç±»çš„<code>__dict__</code></li><li>å…ƒç±»çš„<code>__dict__</code></li><li>çˆ¶å…ƒç±»çš„<code>__dict__</code></li></ol><h3>4. å…ƒç±»çš„é«˜çº§åº”ç”¨</h3><h4>4.1 å®ç°å•ä¾‹æ¨¡å¼</h4><pre><code class="python">class SingletonMeta(type):
    _instances = {}
    
    def __call__(cls, *args, **kwargs):
        if cls not in cls._instances:
            cls._instances[cls] = super().__call__(*args, **kwargs)
        return cls._instances[cls]

class SingletonClass(metaclass=SingletonMeta):
    def __init__(self, value):
        self.value = value

# æµ‹è¯•å•ä¾‹
instance1 = SingletonClass(42)
instance2 = SingletonClass(100)
print(instance1 is instance2)  # è¾“å‡º: True
print(instance1.value)         # è¾“å‡º: 42
print(instance2.value)         # è¾“å‡º: 42</code></pre><h4>4.2 è‡ªåŠ¨æ³¨å†Œç±»</h4><pre><code class="python">class RegistryMeta(type):
    _registry = {}
    
    def __init__(cls, name, bases, namespace):
        super().__init__(name, bases, namespace)
        if name != 'BasePlugin':  # è·³è¿‡åŸºç±»
            cls._registry[name] = cls

class BasePlugin(metaclass=RegistryMeta):
    pass

class PluginA(BasePlugin):
    pass

class PluginB(BasePlugin):
    pass

print(BasePlugin._registry)  # è¾“å‡º: {'PluginA': &lt;class 'PluginA'&gt;, 'PluginB': &lt;class 'PluginB'&gt;}</code></pre><h4>4.3 è‡ªåŠ¨æ·»åŠ æ–¹æ³•</h4><pre><code class="python">class MethodAdderMeta(type):
    def __new__(mcs, name, bases, namespace):
        # ä¸ºæ‰€æœ‰ç±»æ·»åŠ debugæ–¹æ³•
        namespace['debug'] = lambda self: print(f"Debugging {name} instance")
        return super().__new__(mcs, name, bases, namespace)

class MyClass(metaclass=MethodAdderMeta):
    pass

instance = MyClass()
instance.debug()  # è¾“å‡º: Debugging MyClass instance</code></pre><h4>4.4 å®ç°å±æ€§éªŒè¯</h4><pre><code class="python">class ValidatedMeta(type):
    def __new__(mcs, name, bases, namespace):
        # å¤„ç†å¸¦éªŒè¯å™¨çš„å±æ€§
        for key, value in namespace.items():
            if hasattr(value, 'validate'):
                # åˆ›å»ºå±æ€§æè¿°ç¬¦
                def getter(self, k=key):
                    return getattr(self, f'_{k}')
                
                def setter(self, val, k=key, v=value):
                    if v.validate(val):
                        setattr(self, f'_{k}', val)
                    else:
                        raise ValueError(f"Invalid value for {k}")
                
                namespace[key] = property(getter, setter)
        
        return super().__new__(mcs, name, bases, namespace)

# éªŒè¯å™¨ç¤ºä¾‹
class IntegerValidator:
    def __init__(self, min_val=None, max_val=None):
        self.min_val = min_val
        self.max_val = max_val
    
    def validate(self, value):
        if not isinstance(value, int):
            return False
        if self.min_val is not None and value &lt; self.min_val:
            return False
        if self.max_val is not None and value &gt; self.max_val:
            return False
        return True

class Person(metaclass=ValidatedMeta):
    age = IntegerValidator(min_val=0, max_val=120)
    
    def __init__(self, age):
        self.age = age

# æµ‹è¯•
person = Person(25)
print(person.age)  # è¾“å‡º: 25

# person.age = "twenty"  # ä¼šå¼•å‘ValueError
# person.age = 150       # ä¼šå¼•å‘ValueError</code></pre><h3>5. ç±»æ„é€ æœºåˆ¶</h3><h4>5.1 ç±»çš„åˆ›å»ºè¿‡ç¨‹</h4><ol><li><strong>å…ƒç±»çš„__new__</strong>ï¼šåˆ›å»ºç±»å¯¹è±¡</li><li><strong>å…ƒç±»çš„__init__</strong>ï¼šåˆå§‹åŒ–ç±»å¯¹è±¡</li><li><strong>ç±»çš„__init_subclass__</strong>ï¼šå­ç±»åˆå§‹åŒ–æ—¶è°ƒç”¨</li><li><strong>ç±»çš„__class_getitem__</strong>ï¼šæ”¯æŒç±»çš„ä¸‹æ ‡æ“ä½œï¼ˆå¦‚<code>List[int]</code>ï¼‰</li></ol><h4>5.2 __init_subclass__æ–¹æ³•</h4><p>Python 3.6+ å¼•å…¥çš„ç‰¹æ€§ï¼Œç”¨äºåœ¨å­ç±»åˆ›å»ºæ—¶æ‰§è¡Œä»£ç ï¼š</p><pre><code class="python">class Base:
    def __init_subclass__(cls, **kwargs):
        super().__init_subclass__(**kwargs)
        print(f"Initializing subclass: {cls.__name__}")
        cls.registered = True

class Derived(Base):
    pass

print(Derived.registered)  # è¾“å‡º: True</code></pre><h4>5.3 __class_getitem__æ–¹æ³•</h4><p>Python 3.7+ å¼•å…¥çš„ç‰¹æ€§ï¼Œç”¨äºæ”¯æŒç±»çš„ä¸‹æ ‡æ“ä½œï¼š</p><pre><code class="python">class GenericArray:
    def __class_getitem__(cls, item):
        return f"Array of {item}"

print(GenericArray[int])    # è¾“å‡º: Array of &lt;class 'int'&gt;
print(GenericArray[str])    # è¾“å‡º: Array of &lt;class 'str'&gt;</code></pre><h4>5.4 __prepare__æ–¹æ³•</h4><p>å…ƒç±»çš„<code>__prepare__</code>æ–¹æ³•ç”¨äºåœ¨åˆ›å»ºç±»çš„å‘½åç©ºé—´ä¹‹å‰å‡†å¤‡å‘½åç©ºé—´ï¼š</p><pre><code class="python">class OrderedMeta(type):
    @classmethod
    def __prepare__(mcs, name, bases):
        return dict()  # å¯ä»¥è¿”å›è‡ªå®šä¹‰çš„æ˜ å°„å¯¹è±¡

class OrderedClass(metaclass=OrderedMeta):
    a = 1
    b = 2
    c = 3</code></pre><h3>6. å…ƒç±»çš„æœ€ä½³å®è·µ</h3><h4>6.1 ä½•æ—¶ä½¿ç”¨å…ƒç±»</h4><ul><li><strong>å¤æ‚åœºæ™¯</strong>ï¼šéœ€è¦æ·±åº¦æ§åˆ¶ç±»çš„åˆ›å»ºè¿‡ç¨‹</li><li><strong>æ¡†æ¶å¼€å‘</strong>ï¼šå¦‚ORMã€åºåˆ—åŒ–åº“ç­‰</li><li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆé‡å¤ä»£ç </li><li><strong>æ¨¡å¼å®ç°</strong>ï¼šå•ä¾‹ã€æ³¨å†Œè¡¨ç­‰æ¨¡å¼</li></ul><h4>6.2 æ›¿ä»£æ–¹æ¡ˆ</h4><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æ›´ç®€å•çš„æ›¿ä»£æ–¹æ¡ˆï¼š</p><ul><li><strong>è£…é¥°å™¨</strong>ï¼šä¿®æ”¹ç±»æˆ–å‡½æ•°</li><li><strong>ç±»è£…é¥°å™¨</strong>ï¼šä¿®æ”¹ç±»çš„å±æ€§å’Œæ–¹æ³•</li><li><strong>ç»§æ‰¿</strong>ï¼šé€šè¿‡åŸºç±»æä¾›é€šç”¨åŠŸèƒ½</li><li><strong>Mixin</strong>ï¼šé€šè¿‡æ··å…¥ç±»æ·»åŠ åŠŸèƒ½</li></ul><h4>6.3 å…ƒç±»çš„ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>å¼ºå¤§çš„æ§åˆ¶èƒ½åŠ›</li><li>å¯ä»¥å®ç°å¤æ‚çš„è®¾è®¡æ¨¡å¼</li><li>å‡å°‘é‡å¤ä»£ç </li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>å¢åŠ ä»£ç å¤æ‚åº¦</li><li>éš¾ä»¥ç†è§£å’Œè°ƒè¯•</li><li>å¯èƒ½ä¸å…¶ä»–å…ƒç±»å†²çª</li><li>è¿‡åº¦ä½¿ç”¨ä¼šä½¿ä»£ç éš¾ä»¥ç»´æŠ¤</li></ul><h3>7. å…ƒç±»çš„å®é™…åº”ç”¨æ¡ˆä¾‹</h3><h4>7.1 ORMæ¡†æ¶å®ç°</h4><pre><code class="python">class ModelMeta(type):
    def __new__(mcs, name, bases, namespace):
        if name == 'Model':
            return super().__new__(mcs, name, bases, namespace)
        
        # æå–å­—æ®µå®šä¹‰
        fields = {}
        for key, value in namespace.items():
            if isinstance(value, Field):
                fields[key] = value
        
        # ä¿å­˜å­—æ®µä¿¡æ¯
        namespace['_fields'] = fields
        return super().__new__(mcs, name, bases, namespace)

class Field:
    def __init__(self, type_):
        self.type = type_

class Model(metaclass=ModelMeta):
    pass

class User(Model):
    id = Field('integer')
    name = Field('string')
    email = Field('string')

print(User._fields)  # è¾“å‡ºå­—æ®µå®šä¹‰</code></pre><h4>7.2 æ’ä»¶ç³»ç»Ÿ</h4><pre><code class="python">class PluginRegistry(type):
    _plugins = {}
    
    def __init__(cls, name, bases, namespace):
        super().__init__(name, bases, namespace)
        if name != 'Plugin':
            plugin_name = namespace.get('plugin_name', name)
            cls._plugins[plugin_name] = cls

class Plugin(metaclass=PluginRegistry):
    plugin_name = None
    
    def execute(self):
        raise NotImplementedError

class HelloPlugin(Plugin):
    plugin_name = 'hello'
    
    def execute(self):
        return "Hello, World!"

class GoodbyePlugin(Plugin):
    plugin_name = 'goodbye'
    
    def execute(self):
        return "Goodbye, World!"

# ä½¿ç”¨æ’ä»¶
print(Plugin._plugins['hello']().execute())  # è¾“å‡º: Hello, World!
print(Plugin._plugins['goodbye']().execute())  # è¾“å‡º: Goodbye, World!</code></pre><h4>7.3 å•ä¾‹æ¨¡å¼çš„é«˜çº§å®ç°</h4><pre><code class="python">class ThreadSafeSingletonMeta(type):
    _instances = {}
    _lock = threading.Lock()
    
    def __call__(cls, *args, **kwargs):
        if cls not in cls._instances:
            with cls._lock:
                if cls not in cls._instances:
                    cls._instances[cls] = super().__call__(*args, **kwargs)
        return cls._instances[cls]

class ThreadSafeSingleton(metaclass=ThreadSafeSingletonMeta):
    pass</code></pre><h3>8. å…ƒç±»ä¸Pythonç‰¹æ€§çš„äº¤äº’</h3><h4>8.1 å…ƒç±»ä¸è£…é¥°å™¨</h4><pre><code class="python">class MetaWithDecorator(type):
    def __new__(mcs, name, bases, namespace):
        # ä¸ºæ‰€æœ‰æ–¹æ³•æ·»åŠ è£…é¥°å™¨
        for key, value in namespace.items():
            if callable(value) and not key.startswith('__'):
                def decorator(func):
                    def wrapper(*args, **kwargs):
                        print(f"Calling {key}")
                        return func(*args, **kwargs)
                    return wrapper
                namespace[key] = decorator(value)
        return super().__new__(mcs, name, bases, namespace)

class MyClass(metaclass=MetaWithDecorator):
    def do_something(self):
        print("Doing something")

instance = MyClass()
instance.do_something()  # è¾“å‡º: Calling do_something
                         # è¾“å‡º: Doing something</code></pre><h4>8.2 å…ƒç±»ä¸æè¿°ç¬¦</h4><pre><code class="python">class Descriptor:
    def __get__(self, instance, owner):
        return f"Value from {owner.__name__}"

class MetaWithDescriptor(type):
    def __new__(mcs, name, bases, namespace):
        namespace['descriptor'] = Descriptor()
        return super().__new__(mcs, name, bases, namespace)

class MyClass(metaclass=MetaWithDescriptor):
    pass

print(MyClass.descriptor)  # è¾“å‡º: Value from MyClass</code></pre><h4>8.3 å…ƒç±»ä¸ç»§æ‰¿</h4><pre><code class="python">class BaseMeta(type):
    def __init__(cls, name, bases, namespace):
        super().__init__(name, bases, namespace)
        print(f"BaseMeta initializing {name}")

class DerivedMeta(BaseMeta):
    def __init__(cls, name, bases, namespace):
        super().__init__(name, bases, namespace)
        print(f"DerivedMeta initializing {name}")

class BaseClass(metaclass=BaseMeta):
    pass

class DerivedClass(BaseClass, metaclass=DerivedMeta):
    pass</code></pre><h3>9. å…ƒç±»çš„è°ƒè¯•æŠ€å·§</h3><h4>9.1 æŸ¥çœ‹ç±»çš„åˆ›å»ºè¿‡ç¨‹</h4><pre><code class="python">class DebugMeta(type):
    def __new__(mcs, name, bases, namespace):
        print(f"Creating class {name}")
        print(f"Bases: {bases}")
        print(f"Namespace keys: {list(namespace.keys())}")
        return super().__new__(mcs, name, bases, namespace)

class DebugClass(metaclass=DebugMeta):
    pass</code></pre><h4>9.2 è¿½è¸ªå…ƒç±»æ–¹æ³•è°ƒç”¨</h4><pre><code class="python">class TraceMeta(type):
    def __new__(mcs, name, bases, namespace):
        print(f"TraceMeta.__new__ called for {name}")
        return super().__new__(mcs, name, bases, namespace)
    
    def __init__(cls, name, bases, namespace):
        print(f"TraceMeta.__init__ called for {name}")
        super().__init__(name, bases, namespace)
    
    def __call__(cls, *args, **kwargs):
        print(f"TraceMeta.__call__ called for {cls.__name__}")
        return super().__call__(*args, **kwargs)

class TraceClass(metaclass=TraceMeta):
    def __init__(self):
        print(f"TraceClass.__init__ called")

instance = TraceClass()</code></pre><h3>10. æ€»ç»“</h3><p>å…ƒç±»æ˜¯Pythonä¸­æœ€å¼ºå¤§ã€æœ€åº•å±‚çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œå®ƒå…è®¸å¼€å‘è€…æ·±åº¦æ§åˆ¶ç±»çš„åˆ›å»ºå’Œè¡Œä¸ºã€‚é€šè¿‡å…ƒç±»ï¼Œå¯ä»¥å®ç°è®¸å¤šé«˜çº§åŠŸèƒ½ï¼Œå¦‚ORMæ¡†æ¶ã€æ’ä»¶ç³»ç»Ÿã€å•ä¾‹æ¨¡å¼ç­‰ã€‚</p><h4>å…³é”®è¦ç‚¹</h4><ol><li><strong>å…ƒç±»æ˜¯åˆ›å»ºç±»çš„ç±»</strong>ï¼Œé»˜è®¤æ˜¯<code>type</code></li><li><strong>typeå¯ä»¥åŠ¨æ€åˆ›å»ºç±»</strong>ï¼Œä½¿ç”¨<code>type(name, bases, namespace)</code></li><li><strong>è‡ªå®šä¹‰å…ƒç±»éœ€è¦ç»§æ‰¿type</strong>ï¼Œå¹¶é‡å†™<code>__new__</code>ã€<code>__init__</code>ç­‰æ–¹æ³•</li><li><strong>å…ƒç±»çš„ä½œç”¨</strong>ï¼šæ§åˆ¶ç±»çš„åˆ›å»ºè¿‡ç¨‹ã€ä¿®æ”¹ç±»çš„å±æ€§å’Œæ–¹æ³•</li><li><strong>æœ€ä½³å®è·µ</strong>ï¼šä»…åœ¨éœ€è¦æ·±åº¦æ§åˆ¶ç±»åˆ›å»ºæ—¶ä½¿ç”¨ï¼Œä¼˜å…ˆè€ƒè™‘è£…é¥°å™¨ã€ç»§æ‰¿ç­‰ç®€å•æ–¹æ¡ˆ</li><li><strong>è°ƒè¯•æŠ€å·§</strong>ï¼šä½¿ç”¨è¿½è¸ªå’Œæ—¥å¿—è®°å½•æ¥ç†è§£å…ƒç±»çš„æ‰§è¡Œæµç¨‹</li></ol><h4>æœªæ¥å‘å±•</h4><p>Pythonçš„å…ƒç±»æœºåˆ¶ç›¸å¯¹ç¨³å®šï¼Œæœªæ¥ç‰ˆæœ¬å¯èƒ½ä¼šåœ¨æ˜“ç”¨æ€§å’ŒåŠŸèƒ½ä¸Šè¿›è¡Œæ”¹è¿›ï¼Œä½†æ ¸å¿ƒæ¦‚å¿µå’Œç”¨æ³•ä¸ä¼šæœ‰å¤ªå¤§å˜åŒ–ã€‚å¯¹äºæ¡†æ¶å¼€å‘è€…å’Œé«˜çº§Pythonç¨‹åºå‘˜æ¥è¯´ï¼ŒæŒæ¡å…ƒç±»ä»ç„¶æ˜¯ä¸€é¡¹é‡è¦çš„æŠ€èƒ½ã€‚</p><p>é€šè¿‡åˆç†ä½¿ç”¨å…ƒç±»ï¼Œå¯ä»¥ç¼–å†™å‡ºæ›´åŠ çµæ´»ã€å¼ºå¤§å’Œæ˜“äºç»´æŠ¤çš„ä»£ç ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¡†æ¶å¼€å‘å’Œå¤æ‚ç³»ç»Ÿè®¾è®¡ä¸­ã€‚ç„¶è€Œï¼Œè¿‡åº¦ä½¿ç”¨å…ƒç±»ä¼šå¢åŠ ä»£ç çš„å¤æ‚æ€§å’Œç†è§£éš¾åº¦ï¼Œå› æ­¤éœ€è¦åœ¨åŠŸèƒ½éœ€æ±‚å’Œä»£ç å¯ç»´æŠ¤æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚</p>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„å†…å­˜ç®¡ç†ä¸åƒåœ¾å›æ”¶ç®—æ³•åˆ†æ é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585279</link>    <guid>https://segmentfault.com/a/1190000047585279</guid>    <pubDate>2026-02-01 02:02:36</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„å†…å­˜ç®¡ç†ä¸åƒåœ¾å›æ”¶ç®—æ³•åˆ†æ</h2><h3>1. å†…å­˜ç®¡ç†æ¦‚è¿°</h3><h4>1.1 Pythonå†…å­˜ç®¡ç†çš„å±‚æ¬¡</h4><p>Pythonçš„å†…å­˜ç®¡ç†åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼š</p><ol><li><strong>åº•å±‚å†…å­˜åˆ†é…</strong>ï¼šç”±Cæ ‡å‡†åº“çš„<code>malloc</code>/<code>free</code>ç®¡ç†</li><li><strong>å†…å­˜æ± </strong>ï¼šPythonçš„å†…å­˜æ± æœºåˆ¶ï¼Œç®¡ç†å°å†…å­˜åˆ†é…</li><li><strong>å¯¹è±¡ç®¡ç†</strong>ï¼šPythonå¯¹è±¡çš„åˆ›å»ºã€ä½¿ç”¨å’Œé”€æ¯</li></ol><h4>1.2 å†…å­˜åˆ†é…ç­–ç•¥</h4><ul><li><strong>å°å¯¹è±¡</strong>ï¼šä½¿ç”¨å†…å­˜æ± åˆ†é…ï¼ˆ&lt; 256KBï¼‰</li><li><strong>å¤§å¯¹è±¡</strong>ï¼šç›´æ¥ä½¿ç”¨Cæ ‡å‡†åº“åˆ†é…ï¼ˆâ‰¥ 256KBï¼‰</li><li><strong>å­—ç¬¦ä¸²å’Œæ•´æ•°</strong>ï¼šä½¿ç”¨å¯¹è±¡æ± ç¼“å­˜</li></ul><h4>1.3 å†…å­˜ç®¡ç†çš„é‡è¦æ€§</h4><ul><li>æé«˜ç¨‹åºæ€§èƒ½</li><li>å‡å°‘å†…å­˜æ³„æ¼</li><li>ä¼˜åŒ–å†…å­˜ä½¿ç”¨</li><li>é¿å…å†…å­˜ç¢ç‰‡</li></ul><h3>2. å¼•ç”¨è®¡æ•°æœºåˆ¶</h3><h4>2.1 å¼•ç”¨è®¡æ•°çš„åŸºæœ¬åŸç†</h4><p>å¼•ç”¨è®¡æ•°æ˜¯Pythonæœ€åŸºæœ¬çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œå½“å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼Œå¯¹è±¡è¢«é”€æ¯ã€‚</p><pre><code class="python">import sys

# æŸ¥çœ‹å¼•ç”¨è®¡æ•°
a = "hello"
print(sys.getrefcount(a))  # è¾“å‡º: 2 (å› ä¸ºgetrefcountæœ¬èº«ä¹Ÿä¼šå¢åŠ ä¸€æ¬¡å¼•ç”¨)

b = a
print(sys.getrefcount(a))  # è¾“å‡º: 3

del b
print(sys.getrefcount(a))  # è¾“å‡º: 2</code></pre><h4>2.2 å¼•ç”¨è®¡æ•°çš„å¢å‡</h4><p><strong>å¼•ç”¨è®¡æ•°å¢åŠ çš„æƒ…å†µ</strong>ï¼š</p><ul><li>å¯¹è±¡è¢«åˆ›å»ºï¼š<code>a = 10</code></li><li>å¯¹è±¡è¢«èµ‹å€¼ç»™å…¶ä»–å˜é‡ï¼š<code>b = a</code></li><li>å¯¹è±¡è¢«ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼š<code>func(a)</code></li><li>å¯¹è±¡è¢«æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼š<code>list.append(a)</code></li></ul><p><strong>å¼•ç”¨è®¡æ•°å‡å°‘çš„æƒ…å†µ</strong>ï¼š</p><ul><li>å˜é‡è¢«åˆ é™¤ï¼š<code>del a</code></li><li>å˜é‡è¢«èµ‹å€¼ç»™å…¶ä»–å¯¹è±¡ï¼š<code>a = None</code></li><li>å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œå±€éƒ¨å˜é‡è¢«é”€æ¯</li><li>å¯¹è±¡ä»å®¹å™¨ä¸­ç§»é™¤ï¼š<code>list.remove(a)</code></li><li>å®¹å™¨æœ¬èº«è¢«é”€æ¯</li></ul><h4>2.3 å¼•ç”¨è®¡æ•°çš„ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>å®æ—¶æ€§ï¼šå¯¹è±¡ä¸€æ—¦æ²¡æœ‰å¼•ç”¨å°±ç«‹å³è¢«å›æ”¶</li><li>å®ç°ç®€å•</li><li>å†…å­˜å›æ”¶çš„å¼€é”€åˆ†æ•£åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>æ— æ³•å¤„ç†å¾ªç¯å¼•ç”¨</li><li>å¼•ç”¨è®¡æ•°æ“ä½œæœ¬èº«æœ‰å¼€é”€</li><li>å¯¹äºé¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡æ•ˆç‡è¾ƒä½</li></ul><h4>2.4 å¾ªç¯å¼•ç”¨é—®é¢˜</h4><pre><code class="python"># å¾ªç¯å¼•ç”¨ç¤ºä¾‹
class Node:
    def __init__(self):
        self.next = None

a = Node()
b = Node()
a.next = b
b.next = a

# æ­¤æ—¶å³ä½¿åˆ é™¤aå’Œbï¼Œå®ƒä»¬çš„å¼•ç”¨è®¡æ•°ä»ä¸º1
# å› ä¸ºå®ƒä»¬äº’ç›¸å¼•ç”¨
del a
del b
# è¿™é‡Œä¼šäº§ç”Ÿå†…å­˜æ³„æ¼ï¼Œç›´åˆ°åƒåœ¾å›æ”¶å™¨è¿è¡Œ</code></pre><h3>3. åƒåœ¾å›æ”¶ç®—æ³•</h3><h4>3.1 æ ‡è®°-æ¸…é™¤ç®—æ³•</h4><p><strong>æ ‡è®°-æ¸…é™¤</strong>ï¼ˆMark and Sweepï¼‰æ˜¯Pythonç”¨äºå¤„ç†å¾ªç¯å¼•ç”¨çš„ä¸»è¦ç®—æ³•ï¼š</p><ol><li><strong>æ ‡è®°é˜¶æ®µ</strong>ï¼šä»æ ¹å¯¹è±¡ï¼ˆå¦‚å…¨å±€å˜é‡ã€æ ˆä¸­çš„å˜é‡ï¼‰å‡ºå‘ï¼Œæ ‡è®°æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡</li><li><strong>æ¸…é™¤é˜¶æ®µ</strong>ï¼šå›æ”¶æ‰€æœ‰æœªè¢«æ ‡è®°çš„å¯¹è±¡</li></ol><p><strong>æ ¹å¯¹è±¡</strong>åŒ…æ‹¬ï¼š</p><ul><li>å…¨å±€å˜é‡</li><li>æ ˆä¸­çš„å±€éƒ¨å˜é‡</li><li>å¯„å­˜å™¨ä¸­çš„å˜é‡</li></ul><h4>3.2 åˆ†ä»£å›æ”¶æœºåˆ¶</h4><p>Pythoné‡‡ç”¨<strong>åˆ†ä»£å›æ”¶</strong>ï¼ˆGenerational Garbage Collectionï¼‰ç­–ç•¥ï¼Œå°†å¯¹è±¡åˆ†ä¸ºä¸‰ä¸ªä»£ï¼š</p><ul><li><strong>0ä»£</strong>ï¼šæ–°åˆ›å»ºçš„å¯¹è±¡</li><li><strong>1ä»£</strong>ï¼šç»è¿‡ä¸€æ¬¡åƒåœ¾å›æ”¶åä»ç„¶å­˜åœ¨çš„å¯¹è±¡</li><li><strong>2ä»£</strong>ï¼šç»è¿‡å¤šæ¬¡åƒåœ¾å›æ”¶åä»ç„¶å­˜åœ¨çš„å¯¹è±¡</li></ul><p><strong>å›æ”¶é¢‘ç‡</strong>ï¼š</p><ul><li>0ä»£ï¼šæœ€é¢‘ç¹ï¼ˆå½“å¯¹è±¡æ•°é‡è¾¾åˆ°é˜ˆå€¼æ—¶ï¼‰</li><li>1ä»£ï¼šå½“0ä»£å›æ”¶ä¸€å®šæ¬¡æ•°å</li><li>2ä»£ï¼šå½“1ä»£å›æ”¶ä¸€å®šæ¬¡æ•°å</li></ul><h4>3.3 åƒåœ¾å›æ”¶çš„è§¦å‘æ¡ä»¶</h4><pre><code class="python">import gc

# æ‰‹åŠ¨è§¦å‘åƒåœ¾å›æ”¶
gc.collect()

# æŸ¥çœ‹å½“å‰å„ä»£å¯¹è±¡æ•°é‡
print(gc.get_count())  # è¿”å› (generation0, generation1, generation2)

# è®¾ç½®å›æ”¶é˜ˆå€¼
gc.set_threshold(700, 10, 10)  # (threshold0, threshold1, threshold2)</code></pre><h4>3.4 åƒåœ¾å›æ”¶çš„ä¼˜åŒ–</h4><ul><li><strong>å¢é‡å›æ”¶</strong>ï¼šå°†æ ‡è®°-æ¸…é™¤è¿‡ç¨‹åˆ†æˆå¤šä¸ªå°æ­¥éª¤ï¼Œé¿å…é•¿æ—¶é—´é˜»å¡</li><li><strong>ä¸‰è‰²æ ‡è®°</strong>ï¼šä½¿ç”¨ç™½è‰²ã€ç°è‰²ã€é»‘è‰²æ ‡è®°å¯¹è±¡çŠ¶æ€ï¼Œæé«˜æ ‡è®°æ•ˆç‡</li><li><strong>å†™å±éšœ</strong>ï¼šåœ¨å¯¹è±¡å¼•ç”¨å˜åŒ–æ—¶è®°å½•ï¼Œå‡å°‘é‡å¤æ‰«æ</li></ul><h3>4. å†…å­˜åˆ†é…æœºåˆ¶</h3><h4>4.1 å†…å­˜æ± å®ç°</h4><p>Pythonçš„å†…å­˜æ± ç”±<code>pymalloc</code>å®ç°ï¼Œåˆ†ä¸ºå¤šä¸ªå±‚æ¬¡ï¼š</p><ol><li><strong>arena</strong>ï¼šæœ€å¤§çš„å†…å­˜å—ï¼ˆçº¦256KBï¼‰</li><li><strong>pool</strong>ï¼šarenaä¸­çš„å†…å­˜å—ï¼ˆ4KBï¼‰</li><li><strong>block</strong>ï¼šæœ€å°çš„å†…å­˜åˆ†é…å•ä½ï¼ˆ8å­—èŠ‚çš„å€æ•°ï¼‰</li></ol><h4>4.2 å°å¯¹è±¡åˆ†é…</h4><p>å¯¹äºå°å¯¹è±¡ï¼ˆ&lt; 256KBï¼‰ï¼ŒPythonä½¿ç”¨å†…å­˜æ± åˆ†é…ï¼š</p><ul><li>8å­—èŠ‚ï¼šç”¨äº<code>int</code>ã€<code>float</code>ç­‰</li><li>16å­—èŠ‚ï¼šç”¨äº<code>str</code>ã€<code>list</code>ç­‰</li><li>24å­—èŠ‚ï¼šç”¨äº<code>dict</code>ç­‰</li></ul><h4>4.3 å¤§å¯¹è±¡åˆ†é…</h4><p>å¯¹äºå¤§å¯¹è±¡ï¼ˆâ‰¥ 256KBï¼‰ï¼ŒPythonç›´æ¥ä½¿ç”¨Cæ ‡å‡†åº“çš„<code>malloc</code>åˆ†é…ï¼Œé¿å…å ç”¨å†…å­˜æ± ç©ºé—´ã€‚</p><h4>4.4 å†…å­˜ç¢ç‰‡ç®¡ç†</h4><ul><li><strong>å†…å­˜æ± </strong>ï¼šå‡å°‘å°å¯¹è±¡åˆ†é…çš„ç¢ç‰‡</li><li><strong>arenaå¤ç”¨</strong>ï¼šå›æ”¶å’Œé‡ç”¨å†…å­˜å—</li><li><strong>å¤§å¯¹è±¡ç›´æ¥åˆ†é…</strong>ï¼šé¿å…å¤§å¯¹è±¡å¯¹å†…å­˜æ± çš„å½±å“</li></ul><h3>5. å†…å­˜ç®¡ç†çš„å®é™…åº”ç”¨</h3><h4>5.1 å†…å­˜æ³„æ¼æ£€æµ‹</h4><pre><code class="python">import objgraph

# æŸ¥çœ‹æœ€å¸¸è§çš„å¯¹è±¡
objgraph.show_most_common_types()

# æŸ¥æ‰¾ç‰¹å®šç±»å‹çš„å¯¹è±¡
objgraph.count('Node')

# ç»˜åˆ¶å¼•ç”¨å…³ç³»å›¾
objgraph.show_backrefs([problematic_object], filename='backrefs.png')</code></pre><h4>5.2 å†…å­˜ä½¿ç”¨åˆ†æ</h4><pre><code class="python">import psutil
import os

# è·å–å½“å‰è¿›ç¨‹
process = psutil.Process(os.getpid())

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ
print(f"RSS: {process.memory_info().rss / 1024 / 1024:.2f} MB")
print(f"VMS: {process.memory_info().vms / 1024 / 1024:.2f} MB")</code></pre><h4>5.3 å†…å­˜ä¼˜åŒ–æŠ€å·§</h4><h5>5.3.1 ä½¿ç”¨ç”Ÿæˆå™¨</h5><pre><code class="python"># ä¸å¥½çš„åšæ³•ï¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ•°æ®

def load_all_data():
    data = []
    for i in range(1000000):
        data.append(i)
    return data

# å¥½çš„åšæ³•ï¼šä½¿ç”¨ç”Ÿæˆå™¨
def generate_data():
    for i in range(1000000):
        yield i</code></pre><h5>5.3.2 é¿å…å¾ªç¯å¼•ç”¨</h5><pre><code class="python"># ä¸å¥½çš„åšæ³•ï¼šå¾ªç¯å¼•ç”¨
class Node:
    def __init__(self):
        self.children = []
        self.parent = None
    
    def add_child(self, child):
        self.children.append(child)
        child.parent = self

# å¥½çš„åšæ³•ï¼šä½¿ç”¨å¼±å¼•ç”¨
import weakref

class Node:
    def __init__(self):
        self.children = []
        self.parent = None
    
    def add_child(self, child):
        self.children.append(child)
        child.parent = weakref.ref(self)</code></pre><h5>5.3.3 åŠæ—¶é‡Šæ”¾èµ„æº</h5><pre><code class="python"># ä¸å¥½çš„åšæ³•ï¼šèµ„æºä¸åŠæ—¶é‡Šæ”¾
file = open('large_file.txt', 'r')
data = file.read()
# å¤„ç†æ•°æ®...
# å¿˜è®°å…³é—­æ–‡ä»¶

# å¥½çš„åšæ³•ï¼šä½¿ç”¨withè¯­å¥
with open('large_file.txt', 'r') as file:
    data = file.read()
    # å¤„ç†æ•°æ®...
# æ–‡ä»¶è‡ªåŠ¨å…³é—­</code></pre><h3>6. å†…å­˜ç®¡ç†çš„é«˜çº§è¯é¢˜</h3><h4>6.1 å¼±å¼•ç”¨</h4><p><strong>å¼±å¼•ç”¨</strong>ï¼ˆWeak Referenceï¼‰å…è®¸å¼•ç”¨å¯¹è±¡è€Œä¸å¢åŠ å…¶å¼•ç”¨è®¡æ•°ï¼Œé€‚ç”¨äºç¼“å­˜ã€è§‚å¯Ÿè€…æ¨¡å¼ç­‰åœºæ™¯ï¼š</p><pre><code class="python">import weakref

class MyClass:
    def __init__(self, name):
        self.name = name
    
    def __del__(self):
        print(f"{self.name} is being deleted")

# åˆ›å»ºå¯¹è±¡
obj = MyClass("Test")

# åˆ›å»ºå¼±å¼•ç”¨
weak_ref = weakref.ref(obj)
print(weak_ref())  # è¾“å‡º: &lt;__main__.MyClass object at 0x...&gt;

# åˆ é™¤å¯¹è±¡
del obj
print(weak_ref())  # è¾“å‡º: None</code></pre><h4>6.2 å†…å­˜è§†å›¾</h4><p><strong>å†…å­˜è§†å›¾</strong>ï¼ˆMemory Viewï¼‰å…è®¸åœ¨ä¸å¤åˆ¶æ•°æ®çš„æƒ…å†µä¸‹è®¿é—®å¯¹è±¡çš„å†…éƒ¨ç¼“å†²åŒºï¼š</p><pre><code class="python"># åˆ›å»ºå­—èŠ‚æ•°ç»„
data = bytearray(b'Hello, World!')

# åˆ›å»ºå†…å­˜è§†å›¾
mv = memoryview(data)

# ä¿®æ”¹å†…å­˜è§†å›¾ï¼Œä¼šç›´æ¥ä¿®æ”¹åŸå§‹æ•°æ®
mv[0] = ord('h')
print(data)  # è¾“å‡º: bytearray(b'hello, World!')</code></pre><h4>6.3 ç¼“å†²åè®®</h4><p><strong>ç¼“å†²åè®®</strong>ï¼ˆBuffer Protocolï¼‰å…è®¸å¯¹è±¡æš´éœ²å…¶å†…éƒ¨ç¼“å†²åŒºï¼Œä¾›å…¶ä»–å¯¹è±¡ç›´æ¥è®¿é—®ï¼Œé¿å…æ•°æ®å¤åˆ¶ï¼š</p><ul><li>å®ç°äº†<code>__buffer__</code>æ–¹æ³•çš„å¯¹è±¡æ”¯æŒç¼“å†²åè®®</li><li>å¦‚<code>bytes</code>ã€<code>bytearray</code>ã€<code>array.array</code>ç­‰</li></ul><h4>6.4 å†…å­˜æ˜ å°„</h4><p><strong>å†…å­˜æ˜ å°„</strong>ï¼ˆMemory Mappingï¼‰å…è®¸å°†æ–‡ä»¶ç›´æ¥æ˜ å°„åˆ°å†…å­˜ï¼Œé€‚ç”¨äºå¤„ç†å¤§æ–‡ä»¶ï¼š</p><pre><code class="python">import mmap

with open('large_file.txt', 'r+b') as f:
    # åˆ›å»ºå†…å­˜æ˜ å°„
    mm = mmap.mmap(f.fileno(), length=0, access=mmap.ACCESS_WRITE)
    
    # ç›´æ¥æ“ä½œå†…å­˜
    mm[0:5] = b'Hello'
    
    # å…³é—­å†…å­˜æ˜ å°„
    mm.close()</code></pre><h3>7. å†…å­˜æ³„æ¼çš„åŸå› ä¸è§£å†³æ–¹æ¡ˆ</h3><h4>7.1 å¸¸è§çš„å†…å­˜æ³„æ¼åŸå› </h4><ol><li><strong>å¾ªç¯å¼•ç”¨</strong>ï¼šå¯¹è±¡ä¹‹é—´äº’ç›¸å¼•ç”¨</li><li><strong>å…¨å±€å˜é‡</strong>ï¼šæœªåŠæ—¶æ¸…ç†çš„å…¨å±€å˜é‡</li><li><strong>ç¼“å­˜</strong>ï¼šæ— é™å¢é•¿çš„ç¼“å­˜</li><li><strong>é—­åŒ…</strong>ï¼šé—­åŒ…ä¸­å¼•ç”¨çš„å˜é‡</li><li><strong>ç¬¬ä¸‰æ–¹åº“</strong>ï¼šä½¿ç”¨ä¸å½“çš„ç¬¬ä¸‰æ–¹åº“</li></ol><h4>7.2 å†…å­˜æ³„æ¼çš„æ£€æµ‹å·¥å…·</h4><ul><li><strong>objgraph</strong>ï¼šæŸ¥çœ‹å¯¹è±¡å¼•ç”¨å…³ç³»</li><li><strong>memory_profiler</strong>ï¼šé€è¡Œåˆ†æå†…å­˜ä½¿ç”¨</li><li><strong>tracemalloc</strong>ï¼šè·Ÿè¸ªå†…å­˜åˆ†é…</li><li><strong>psutil</strong>ï¼šç›‘æ§è¿›ç¨‹å†…å­˜ä½¿ç”¨</li></ul><h4>7.3 å†…å­˜æ³„æ¼çš„è§£å†³æ–¹æ¡ˆ</h4><ol><li><strong>ä½¿ç”¨å¼±å¼•ç”¨</strong>ï¼šé¿å…å¾ªç¯å¼•ç”¨</li><li><strong>åŠæ—¶æ¸…ç†</strong>ï¼šä½¿ç”¨<code>del</code>åˆ é™¤ä¸éœ€è¦çš„å¯¹è±¡</li><li><strong>ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨</strong>ï¼šè‡ªåŠ¨é‡Šæ”¾èµ„æº</li><li><strong>è®¾ç½®ç¼“å­˜å¤§å°é™åˆ¶</strong>ï¼šé¿å…ç¼“å­˜æ— é™å¢é•¿</li><li><strong>å®šæœŸæ£€æµ‹</strong>ï¼šä½¿ç”¨å†…å­˜åˆ†æå·¥å…·å®šæœŸæ£€æŸ¥</li></ol><h3>8. æ€§èƒ½ä¼˜åŒ–æ¡ˆä¾‹</h3><h4>8.1 åˆ—è¡¨ä¸ç”Ÿæˆå™¨å¯¹æ¯”</h4><pre><code class="python">import sys

# åˆ—è¡¨å ç”¨çš„å†…å­˜
a = [i for i in range(1000000)]
print(f"List size: {sys.getsizeof(a) / 1024 / 1024:.2f} MB")

# ç”Ÿæˆå™¨å ç”¨çš„å†…å­˜
b = (i for i in range(1000000))
print(f"Generator size: {sys.getsizeof(b) / 1024 / 1024:.2f} MB")</code></pre><h4>8.2 å­—å…¸ä¼˜åŒ–</h4><pre><code class="python"># ä¸å¥½çš„åšæ³•ï¼šä½¿ç”¨æ™®é€šå­—å…¸
large_dict = {}
for i in range(1000000):
    large_dict[i] = i

# å¥½çš„åšæ³•ï¼šä½¿ç”¨__slots__æˆ–dataclasses
from dataclasses import dataclass

@dataclass
class Data:
    value: int

# æˆ–è€…ä½¿ç”¨__slots__
class DataWithSlots:
    __slots__ = ['value']
    def __init__(self, value):
        self.value = value</code></pre><h4>8.3 å­—ç¬¦ä¸²æ‹¼æ¥ä¼˜åŒ–</h4><pre><code class="python"># ä¸å¥½çš„åšæ³•ï¼šä½¿ç”¨+æ‹¼æ¥å­—ç¬¦ä¸²
result = ""
for i in range(10000):
    result += str(i)

# å¥½çš„åšæ³•ï¼šä½¿ç”¨join
parts = []
for i in range(10000):
    parts.append(str(i))
result = "".join(parts)</code></pre><h3>9. Pythonå†…å­˜ç®¡ç†çš„æœªæ¥å‘å±•</h3><h4>9.1 PyPyçš„å†…å­˜ç®¡ç†</h4><p>PyPyä½¿ç”¨<strong>åˆ†ä»£åƒåœ¾å›æ”¶</strong>å’Œ<strong>å³æ—¶ç¼–è¯‘</strong>ï¼Œå†…å­˜ç®¡ç†æ•ˆç‡æ›´é«˜ï¼š</p><ul><li>æ›´é«˜æ•ˆçš„åƒåœ¾å›æ”¶ç®—æ³•</li><li>å‡å°‘å†…å­˜ä½¿ç”¨</li><li>æé«˜æ‰§è¡Œé€Ÿåº¦</li></ul><h4>9.2 Python 3.10+çš„å†…å­˜ä¼˜åŒ–</h4><ul><li><strong>PEP 634</strong>ï¼šç»“æ„åŒ–æ¨¡å¼åŒ¹é…ï¼Œå‡å°‘å†…å­˜ä½¿ç”¨</li><li><strong>PEP 644</strong>ï¼šåˆ é™¤Py_UNICODEç¼–ç ï¼Œç»Ÿä¸€å­—ç¬¦ä¸²è¡¨ç¤º</li><li><strong>PEP 654</strong>ï¼šå¼‚å¸¸ç»„å’Œexcept*ï¼Œæ”¹è¿›å¼‚å¸¸å¤„ç†çš„å†…å­˜ä½¿ç”¨</li></ul><h4>9.3 å†…å­˜ç®¡ç†çš„ç ”ç©¶æ–¹å‘</h4><ul><li><strong>å¹¶å‘åƒåœ¾å›æ”¶</strong>ï¼šå‡å°‘åƒåœ¾å›æ”¶å¯¹ç¨‹åºæ‰§è¡Œçš„å½±å“</li><li><strong>è‡ªåŠ¨å†…å­˜ç®¡ç†ä¼˜åŒ–</strong>ï¼šæ ¹æ®ç¨‹åºè¡Œä¸ºè‡ªåŠ¨è°ƒæ•´å†…å­˜ç®¡ç†ç­–ç•¥</li><li><strong>å†…å­˜ä½¿ç”¨é¢„æµ‹</strong>ï¼šé¢„æµ‹ç¨‹åºçš„å†…å­˜ä½¿ç”¨æ¨¡å¼ï¼Œæå‰åˆ†é…å†…å­˜</li></ul><h3>10. æ€»ç»“</h3><p>Pythonçš„å†…å­˜ç®¡ç†æ˜¯ä¸€ä¸ªå¤æ‚è€Œç²¾å·§çš„ç³»ç»Ÿï¼Œç»“åˆäº†å¼•ç”¨è®¡æ•°ã€æ ‡è®°-æ¸…é™¤å’Œåˆ†ä»£å›æ”¶ç­‰å¤šç§æœºåˆ¶ã€‚é€šè¿‡ç†è§£Pythonçš„å†…å­˜ç®¡ç†åŸç†ï¼Œå¼€å‘è€…å¯ä»¥ï¼š</p><ol><li><strong>ç¼–å†™æ›´é«˜æ•ˆçš„ä»£ç </strong>ï¼šå‡å°‘å†…å­˜ä½¿ç”¨ï¼Œæé«˜ç¨‹åºæ€§èƒ½</li><li><strong>é¿å…å†…å­˜æ³„æ¼</strong>ï¼šåŠæ—¶é‡Šæ”¾ä¸éœ€è¦çš„èµ„æº</li><li><strong>ä¼˜åŒ–å†…å­˜ä½¿ç”¨</strong>ï¼šæ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„å’Œç®—æ³•</li><li><strong>è°ƒè¯•å†…å­˜é—®é¢˜</strong>ï¼šä½¿ç”¨å†…å­˜åˆ†æå·¥å…·å®šä½å’Œè§£å†³å†…å­˜é—®é¢˜</li></ol><h4>å…³é”®è¦ç‚¹</h4><ul><li><strong>å¼•ç”¨è®¡æ•°</strong>ï¼šPythonçš„åŸºæœ¬åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå¤„ç†å¤§å¤šæ•°å†…å­˜å›æ”¶</li><li><strong>æ ‡è®°-æ¸…é™¤</strong>ï¼šå¤„ç†å¾ªç¯å¼•ç”¨çš„ä¸»è¦ç®—æ³•</li><li><strong>åˆ†ä»£å›æ”¶</strong>ï¼šæé«˜åƒåœ¾å›æ”¶æ•ˆç‡çš„ç­–ç•¥</li><li><strong>å†…å­˜æ± </strong>ï¼šä¼˜åŒ–å°å¯¹è±¡åˆ†é…ï¼Œå‡å°‘å†…å­˜ç¢ç‰‡</li><li><strong>å¼±å¼•ç”¨</strong>ï¼šé¿å…å¾ªç¯å¼•ç”¨çš„æœ‰æ•ˆå·¥å…·</li><li><strong>å†…å­˜åˆ†æ</strong>ï¼šä½¿ç”¨å·¥å…·æ£€æµ‹å’Œè§£å†³å†…å­˜é—®é¢˜</li></ul><h4>æœ€ä½³å®è·µ</h4><ul><li><strong>ä½¿ç”¨ç”Ÿæˆå™¨</strong>ï¼šå¤„ç†å¤§é‡æ•°æ®æ—¶å‡å°‘å†…å­˜ä½¿ç”¨</li><li><strong>é¿å…å¾ªç¯å¼•ç”¨</strong>ï¼šä½¿ç”¨å¼±å¼•ç”¨æˆ–åˆç†è®¾è®¡å¯¹è±¡å…³ç³»</li><li><strong>åŠæ—¶é‡Šæ”¾èµ„æº</strong>ï¼šä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å’Œ<code>del</code>è¯­å¥</li><li><strong>ä¼˜åŒ–æ•°æ®ç»“æ„</strong>ï¼šé€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„å‡å°‘å†…å­˜å ç”¨</li><li><strong>å®šæœŸæ£€æµ‹</strong>ï¼šä½¿ç”¨å†…å­˜åˆ†æå·¥å…·ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ</li></ul><p>é€šè¿‡æŒæ¡Pythonçš„å†…å­˜ç®¡ç†çŸ¥è¯†ï¼Œå¼€å‘è€…å¯ä»¥ç¼–å†™å‡ºæ›´é«˜æ•ˆã€æ›´å¯é çš„Pythonç¨‹åºï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®æˆ–é•¿æ—¶é—´è¿è¡Œçš„æœåŠ¡æ—¶ï¼Œè‰¯å¥½çš„å†…å­˜ç®¡ç†ç­–ç•¥æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„å¹¶å‘ç¼–ç¨‹ä¸GILæœºåˆ¶ä¼˜åŒ–ç­–ç•¥ é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585282</link>    <guid>https://segmentfault.com/a/1190000047585282</guid>    <pubDate>2026-02-01 02:02:02</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„å¹¶å‘ç¼–ç¨‹ä¸GILæœºåˆ¶ä¼˜åŒ–ç­–ç•¥</h2><h3>1. å¹¶å‘ç¼–ç¨‹æ¦‚è¿°</h3><h4>1.1 å¹¶å‘ä¸å¹¶è¡Œçš„åŒºåˆ«</h4><ul><li><strong>å¹¶å‘</strong>ï¼ˆConcurrencyï¼‰ï¼šæŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªä»»åŠ¡åœ¨åŒä¸€æ—¶é—´æ®µå†…äº¤æ›¿æ‰§è¡Œï¼Œé€šè¿‡ä¸Šä¸‹æ–‡åˆ‡æ¢å®ç°</li><li><strong>å¹¶è¡Œ</strong>ï¼ˆParallelismï¼‰ï¼šæŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªä»»åŠ¡åœ¨åŒä¸€æ—¶åˆ»åŒæ—¶æ‰§è¡Œï¼Œéœ€è¦å¤šæ ¸CPUæ”¯æŒ</li></ul><h4>1.2 Pythonä¸­çš„å¹¶å‘æ¨¡å‹</h4><p>Pythonæ”¯æŒå¤šç§å¹¶å‘æ¨¡å‹ï¼š</p><ul><li><strong>å¤šçº¿ç¨‹</strong>ï¼ˆThreadingï¼‰ï¼šé€‚åˆI/Oå¯†é›†å‹ä»»åŠ¡</li><li><strong>å¤šè¿›ç¨‹</strong>ï¼ˆMultiprocessingï¼‰ï¼šé€‚åˆCPUå¯†é›†å‹ä»»åŠ¡</li><li><strong>åç¨‹</strong>ï¼ˆCoroutineï¼‰ï¼šè½»é‡çº§å¹¶å‘ï¼Œé€‚åˆI/Oå¯†é›†å‹ä»»åŠ¡</li><li><strong>å¼‚æ­¥I/O</strong>ï¼ˆAsyncioï¼‰ï¼šåŸºäºåç¨‹çš„å¼‚æ­¥ç¼–ç¨‹æ¡†æ¶</li></ul><h4>1.3 å¹¶å‘ç¼–ç¨‹çš„æŒ‘æˆ˜</h4><ul><li><strong>ç«æ€æ¡ä»¶</strong>ï¼ˆRace Conditionï¼‰ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«èµ„æºå¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´</li><li><strong>æ­»é”</strong>ï¼ˆDeadlockï¼‰ï¼šå¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…å¯¹æ–¹é‡Šæ”¾èµ„æº</li><li><strong>æ´»é”</strong>ï¼ˆLivelockï¼‰ï¼šçº¿ç¨‹ä¸æ–­æ”¹å˜çŠ¶æ€ä½†æ— æ³•ç»§ç»­æ‰§è¡Œ</li><li><strong>èµ„æºäº‰ç”¨</strong>ï¼šçº¿ç¨‹ç«äº‰æœ‰é™èµ„æºå¯¼è‡´æ€§èƒ½ä¸‹é™</li></ul><h3>2. GILæœºåˆ¶è¯¦è§£</h3><h4>2.1 ä»€ä¹ˆæ˜¯GIL</h4><p><strong>å…¨å±€è§£é‡Šå™¨é”</strong>ï¼ˆGlobal Interpreter Lockï¼ŒGILï¼‰æ˜¯Pythonè§£é‡Šå™¨ï¼ˆCPythonï¼‰ä¸­çš„ä¸€ä¸ªæœºåˆ¶ï¼Œå®ƒç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡ŒPythonå­—èŠ‚ç ã€‚</p><h4>2.2 GILçš„å·¥ä½œåŸç†</h4><ol><li><strong>è·å–é”</strong>ï¼šçº¿ç¨‹æ‰§è¡ŒPythonä»£ç å‰å¿…é¡»è·å–GIL</li><li><strong>æ‰§è¡Œä»£ç </strong>ï¼šçº¿ç¨‹æ‰§è¡Œä¸€æ®µæ—¶é—´ï¼ˆçº¦100ä¸ªå­—èŠ‚ç æŒ‡ä»¤ï¼‰</li><li><strong>é‡Šæ”¾é”</strong>ï¼šçº¿ç¨‹ä¸»åŠ¨é‡Šæ”¾GILï¼Œè®©å…¶ä»–çº¿ç¨‹æœ‰æœºä¼šæ‰§è¡Œ</li><li><strong>é‡æ–°ç«äº‰</strong>ï¼šæ‰€æœ‰çº¿ç¨‹é‡æ–°ç«äº‰GIL</li></ol><h4>2.3 GILçš„å½±å“</h4><ul><li><strong>CPUå¯†é›†å‹ä»»åŠ¡</strong>ï¼šå¤šçº¿ç¨‹æ— æ³•åˆ©ç”¨å¤šæ ¸CPUï¼Œç”šè‡³å¯èƒ½æ¯”å•çº¿ç¨‹æ…¢</li><li><strong>I/Oå¯†é›†å‹ä»»åŠ¡</strong>ï¼šçº¿ç¨‹åœ¨I/Oæ“ä½œæ—¶é‡Šæ”¾GILï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥æ‰§è¡Œ</li><li><strong>å†…å­˜ç®¡ç†</strong>ï¼šç®€åŒ–äº†å†…å­˜ç®¡ç†ï¼Œé¿å…äº†å¤šçº¿ç¨‹ä¸‹çš„å†…å­˜ç«äº‰</li></ul><h4>2.4 ä¸ºä»€ä¹ˆå­˜åœ¨GIL</h4><ul><li><strong>å†å²åŸå› </strong>ï¼šæ—©æœŸPythonè®¾è®¡æ—¶å¤šæ ¸CPUä¸æ™®åŠ</li><li><strong>ç®€åŒ–å®ç°</strong>ï¼šé¿å…äº†å¤æ‚çš„çº¿ç¨‹å®‰å…¨é—®é¢˜</li><li><strong>å†…å­˜ç®¡ç†</strong>ï¼šç®€åŒ–äº†åƒåœ¾å›æ”¶æœºåˆ¶</li><li><strong>ç¬¬ä¸‰æ–¹åº“å…¼å®¹</strong>ï¼šè®¸å¤šCæ‰©å±•ä¾èµ–GILä¿è¯çº¿ç¨‹å®‰å…¨</li></ul><h3>3. å¤šçº¿ç¨‹ç¼–ç¨‹</h3><h4>3.1 çº¿ç¨‹çš„åˆ›å»ºä¸ä½¿ç”¨</h4><pre><code class="python">import threading
import time

def worker(name, delay):
    print(f"Worker {name} started")
    time.sleep(delay)
    print(f"Worker {name} finished")

# åˆ›å»ºçº¿ç¨‹
thread1 = threading.Thread(target=worker, args=("A", 2))
thread2 = threading.Thread(target=worker, args=("B", 3))

# å¯åŠ¨çº¿ç¨‹
thread1.start()
thread2.start()

# ç­‰å¾…çº¿ç¨‹å®Œæˆ
thread1.join()
thread2.join()

print("All workers finished")</code></pre><h4>3.2 çº¿ç¨‹åŒæ­¥æœºåˆ¶</h4><h5>3.2.1 é”ï¼ˆLockï¼‰</h5><pre><code class="python">import threading

lock = threading.Lock()
shared_resource = 0

def increment():
    global shared_resource
    for _ in range(100000):
        with lock:
            shared_resource += 1

# åˆ›å»ºå¤šä¸ªçº¿ç¨‹
threads = []
for i in range(5):
    t = threading.Thread(target=increment)
    threads.append(t)
    t.start()

# ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
for t in threads:
    t.join()

print(f"Final value: {shared_resource}")  # åº”è¾“å‡º: 500000</code></pre><h5>3.2.2 ä¿¡å·é‡ï¼ˆSemaphoreï¼‰</h5><pre><code class="python">import threading
import time

semaphore = threading.Semaphore(3)  # æœ€å¤š3ä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®

def worker(name):
    print(f"Worker {name} waiting")
    with semaphore:
        print(f"Worker {name} acquired semaphore")
        time.sleep(2)
        print(f"Worker {name} released semaphore")

# åˆ›å»ºå¤šä¸ªçº¿ç¨‹
threads = []
for i in range(10):
    t = threading.Thread(target=worker, args=(i,))
    threads.append(t)
    t.start()

# ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
for t in threads:
    t.join()</code></pre><h5>3.2.3 æ¡ä»¶å˜é‡ï¼ˆConditionï¼‰</h5><pre><code class="python">import threading
import time

condition = threading.Condition()
queue = []
MAX_ITEMS = 5

def producer():
    for i in range(10):
        with condition:
            while len(queue) &gt;= MAX_ITEMS:
                print("Queue full, producer waiting")
                condition.wait()
            queue.append(i)
            print(f"Produced: {i}")
            condition.notify()
        time.sleep(0.5)

def consumer():
    for _ in range(10):
        with condition:
            while not queue:
                print("Queue empty, consumer waiting")
                condition.wait()
            item = queue.pop(0)
            print(f"Consumed: {item}")
            condition.notify()
        time.sleep(1)

# åˆ›å»ºçº¿ç¨‹
producer_thread = threading.Thread(target=producer)
consumer_thread = threading.Thread(target=consumer)

# å¯åŠ¨çº¿ç¨‹
producer_thread.start()
consumer_thread.start()

# ç­‰å¾…çº¿ç¨‹å®Œæˆ
producer_thread.join()
consumer_thread.join()</code></pre><h4>3.3 çº¿ç¨‹æ± </h4><pre><code class="python">from concurrent.futures import ThreadPoolExecutor
import time

def task(n):
    print(f"Processing {n}")
    time.sleep(1)
    return n * 2

# åˆ›å»ºçº¿ç¨‹æ± 
with ThreadPoolExecutor(max_workers=4) as executor:
    # æäº¤ä»»åŠ¡
    futures = [executor.submit(task, i) for i in range(10)]
    
    # è·å–ç»“æœ
    for future in futures:
        result = future.result()
        print(f"Result: {result}")</code></pre><h3>4. å¤šè¿›ç¨‹ç¼–ç¨‹</h3><h4>4.1 è¿›ç¨‹çš„åˆ›å»ºä¸ä½¿ç”¨</h4><pre><code class="python">import multiprocessing
import time

def worker(name, delay):
    print(f"Worker {name} started")
    time.sleep(delay)
    print(f"Worker {name} finished")

if __name__ == "__main__":
    # åˆ›å»ºè¿›ç¨‹
    process1 = multiprocessing.Process(target=worker, args=("A", 2))
    process2 = multiprocessing.Process(target=worker, args=("B", 3))

    # å¯åŠ¨è¿›ç¨‹
    process1.start()
    process2.start()

    # ç­‰å¾…è¿›ç¨‹å®Œæˆ
    process1.join()
    process2.join()

    print("All workers finished")</code></pre><h4>4.2 è¿›ç¨‹é—´é€šä¿¡</h4><h5>4.2.1 é˜Ÿåˆ—ï¼ˆQueueï¼‰</h5><pre><code class="python">import multiprocessing
import time

def producer(queue):
    for i in range(5):
        print(f"Produced: {i}")
        queue.put(i)
        time.sleep(0.5)

def consumer(queue):
    for _ in range(5):
        item = queue.get()
        print(f"Consumed: {item}")
        time.sleep(1)

if __name__ == "__main__":
    queue = multiprocessing.Queue()
    
    # åˆ›å»ºè¿›ç¨‹
    producer_process = multiprocessing.Process(target=producer, args=(queue,))
    consumer_process = multiprocessing.Process(target=consumer, args=(queue,))
    
    # å¯åŠ¨è¿›ç¨‹
    producer_process.start()
    consumer_process.start()
    
    # ç­‰å¾…è¿›ç¨‹å®Œæˆ
    producer_process.join()
    consumer_process.join()</code></pre><h5>4.2.2 ç®¡é“ï¼ˆPipeï¼‰</h5><pre><code class="python">import multiprocessing
import time

def sender(conn):
    for i in range(5):
        print(f"Sending: {i}")
        conn.send(i)
        time.sleep(0.5)
    conn.close()

def receiver(conn):
    while True:
        try:
            item = conn.recv()
            print(f"Received: {item}")
        except EOFError:
            break

if __name__ == "__main__":
    parent_conn, child_conn = multiprocessing.Pipe()
    
    # åˆ›å»ºè¿›ç¨‹
    sender_process = multiprocessing.Process(target=sender, args=(child_conn,))
    receiver_process = multiprocessing.Process(target=receiver, args=(parent_conn,))
    
    # å¯åŠ¨è¿›ç¨‹
    sender_process.start()
    receiver_process.start()
    
    # ç­‰å¾…è¿›ç¨‹å®Œæˆ
    sender_process.join()
    receiver_process.join()</code></pre><h5>4.2.3 å…±äº«å†…å­˜</h5><pre><code class="python">import multiprocessing
import time

def increment(counter, lock):
    for _ in range(100000):
        with lock:
            counter.value += 1

if __name__ == "__main__":
    counter = multiprocessing.Value('i', 0)  # å…±äº«æ•´æ•°
    lock = multiprocessing.Lock()  # è¿›ç¨‹é”
    
    # åˆ›å»ºè¿›ç¨‹
    processes = []
    for i in range(5):
        p = multiprocessing.Process(target=increment, args=(counter, lock))
        processes.append(p)
        p.start()
    
    # ç­‰å¾…è¿›ç¨‹å®Œæˆ
    for p in processes:
        p.join()
    
    print(f"Final value: {counter.value}")  # åº”è¾“å‡º: 500000</code></pre><h4>4.3 è¿›ç¨‹æ± </h4><pre><code class="python">from concurrent.futures import ProcessPoolExecutor
import time

def task(n):
    print(f"Processing {n}")
    time.sleep(1)
    return n * 2

if __name__ == "__main__":
    # åˆ›å»ºè¿›ç¨‹æ± 
    with ProcessPoolExecutor(max_workers=4) as executor:
        # æäº¤ä»»åŠ¡
        futures = [executor.submit(task, i) for i in range(10)]
        
        # è·å–ç»“æœ
        for future in futures:
            result = future.result()
            print(f"Result: {result}")</code></pre><h3>5. åç¨‹ä¸å¼‚æ­¥ç¼–ç¨‹</h3><h4>5.1 åç¨‹çš„åŸºæœ¬æ¦‚å¿µ</h4><p>åç¨‹æ˜¯ä¸€ç§è½»é‡çº§çº¿ç¨‹ï¼Œç”±ç¨‹åºæ§åˆ¶è°ƒåº¦ï¼Œè€Œéæ“ä½œç³»ç»Ÿã€‚Python 3.5+ä½¿ç”¨<code>async/await</code>è¯­æ³•æ”¯æŒåç¨‹ã€‚</p><h4>5.2 åç¨‹çš„å®ç°</h4><pre><code class="python">import asyncio

async def say_hello(name):
    print(f"Hello, {name}!")
    await asyncio.sleep(1)  # æ¨¡æ‹ŸI/Oæ“ä½œ
    print(f"Goodbye, {name}!")

async def main():
    # å¹¶è¡Œæ‰§è¡Œå¤šä¸ªåç¨‹
    await asyncio.gather(
        say_hello("Alice"),
        say_hello("Bob"),
        say_hello("Charlie")
    )

# è¿è¡Œä¸»åç¨‹
asyncio.run(main())</code></pre><h4>5.3 å¼‚æ­¥I/O</h4><pre><code class="python">import asyncio
import aiohttp

async def fetch_url(session, url):
    async with session.get(url) as response:
        return await response.text()

async def main():
    async with aiohttp.ClientSession() as session:
        html = await fetch_url(session, "https://example.com")
        print(html[:100])

# è¿è¡Œä¸»åç¨‹
asyncio.run(main())</code></pre><h4>5.4 äº‹ä»¶å¾ªç¯</h4><p>äº‹ä»¶å¾ªç¯æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒï¼Œè´Ÿè´£è°ƒåº¦åç¨‹çš„æ‰§è¡Œï¼š</p><ol><li><strong>æ³¨å†Œåç¨‹</strong>ï¼šå°†åç¨‹æ³¨å†Œåˆ°äº‹ä»¶å¾ªç¯</li><li><strong>æ‰§è¡Œåç¨‹</strong>ï¼šäº‹ä»¶å¾ªç¯æ‰§è¡Œåç¨‹ç›´åˆ°é‡åˆ°<code>await</code></li><li><strong>æš‚åœåç¨‹</strong>ï¼šåç¨‹åœ¨<code>await</code>å¤„æš‚åœï¼Œæ§åˆ¶æƒè¿”å›äº‹ä»¶å¾ªç¯</li><li><strong>è°ƒåº¦å…¶ä»–åç¨‹</strong>ï¼šäº‹ä»¶å¾ªç¯æ‰§è¡Œå…¶ä»–å°±ç»ªçš„åç¨‹</li><li><strong>æ¢å¤åç¨‹</strong>ï¼šå½“<code>await</code>çš„æ“ä½œå®Œæˆåï¼Œåç¨‹è¢«æ¢å¤æ‰§è¡Œ</li></ol><h3>6. GILçš„ä¼˜åŒ–ç­–ç•¥</h3><h4>6.1 é’ˆå¯¹CPUå¯†é›†å‹ä»»åŠ¡</h4><ol><li><strong>ä½¿ç”¨å¤šè¿›ç¨‹</strong>ï¼šç»•è¿‡GILï¼Œåˆ©ç”¨å¤šæ ¸CPU</li><li><strong>ä½¿ç”¨Cæ‰©å±•</strong>ï¼šåœ¨Cæ‰©å±•ä¸­é‡Šæ”¾GIL</li><li><strong>ä½¿ç”¨PyPy</strong>ï¼šPyPyçš„GILå®ç°æ›´é«˜æ•ˆï¼Œç”šè‡³æœ‰GIL-freeç‰ˆæœ¬</li><li><strong>ä½¿ç”¨Numba</strong>ï¼šNumbaå¯ä»¥ç¼–è¯‘Pythonä»£ç ä¸ºæœºå™¨ç ï¼Œç»•è¿‡GIL</li></ol><h4>6.2 é’ˆå¯¹I/Oå¯†é›†å‹ä»»åŠ¡</h4><ol><li><strong>ä½¿ç”¨å¤šçº¿ç¨‹</strong>ï¼šçº¿ç¨‹åœ¨I/Oæ“ä½œæ—¶é‡Šæ”¾GIL</li><li><strong>ä½¿ç”¨åç¨‹</strong>ï¼šåç¨‹æ˜¯I/Oå¯†é›†å‹ä»»åŠ¡çš„æœ€ä½³é€‰æ‹©</li><li><strong>ä½¿ç”¨å¼‚æ­¥I/O</strong>ï¼š<code>asyncio</code>æä¾›äº†é«˜æ•ˆçš„å¼‚æ­¥I/Oæ“ä½œ</li></ol><h4>6.3 ä»£ç ä¼˜åŒ–æŠ€å·§</h4><ol><li><p><strong>å‡å°‘GILç«äº‰</strong>ï¼š</p><ul><li>å‡å°‘é”çš„æŒæœ‰æ—¶é—´</li><li>é¿å…é•¿æ—¶é—´è¿è¡Œçš„å¾ªç¯</li><li>ä½¿ç”¨<code>time.sleep(0)</code>ä¸»åŠ¨è®©å‡ºGIL</li></ul></li><li><p><strong>ä½¿ç”¨é€‚å½“çš„æ•°æ®ç»“æ„</strong>ï¼š</p><ul><li>ä½¿ç”¨<code>queue.Queue</code>è¿›è¡Œçº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—æ“ä½œ</li><li>ä½¿ç”¨<code>collections.deque</code>è¿›è¡Œé«˜æ•ˆçš„åŒç«¯é˜Ÿåˆ—æ“ä½œ</li><li>ä½¿ç”¨<code>threading.local()</code>å­˜å‚¨çº¿ç¨‹æœ¬åœ°æ•°æ®</li></ul></li><li><p><strong>é¿å…å…¨å±€å˜é‡</strong>ï¼š</p><ul><li>ä½¿ç”¨å‡½æ•°å‚æ•°ä¼ é€’æ•°æ®</li><li>ä½¿ç”¨ç±»å®ä¾‹å˜é‡å­˜å‚¨çŠ¶æ€</li><li>ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨</li></ul></li></ol><h3>7. å¹¶å‘ç¼–ç¨‹çš„æœ€ä½³å®è·µ</h3><h4>7.1 é€‰æ‹©åˆé€‚çš„å¹¶å‘æ¨¡å‹</h4><table><thead><tr><th>ä»»åŠ¡ç±»å‹</th><th>æ¨èæ¨¡å‹</th><th>åŸå› </th></tr></thead><tbody><tr><td>CPUå¯†é›†å‹</td><td>å¤šè¿›ç¨‹</td><td>ç»•è¿‡GILï¼Œåˆ©ç”¨å¤šæ ¸</td></tr><tr><td>I/Oå¯†é›†å‹</td><td>åç¨‹/å¤šçº¿ç¨‹</td><td>åç¨‹æ›´è½»é‡ï¼Œå¤šçº¿ç¨‹æ›´ç®€å•</td></tr><tr><td>æ··åˆä»»åŠ¡</td><td>å¤šè¿›ç¨‹+åç¨‹</td><td>è¿›ç¨‹å¤„ç†CPUå¯†é›†å‹ï¼Œåç¨‹å¤„ç†I/O</td></tr><tr><td>é«˜å¹¶å‘I/O</td><td>å¼‚æ­¥I/O</td><td>å•çº¿ç¨‹å¤„ç†æ•°åƒä¸ªè¿æ¥</td></tr></tbody></table><h4>7.2 çº¿ç¨‹å®‰å…¨ç¼–ç¨‹</h4><ol><li><p><strong>ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„</strong>ï¼š</p><ul><li><code>queue.Queue</code>ï¼šçº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—</li><li><code>collections.deque</code>ï¼šçº¿ç¨‹å®‰å…¨çš„åŒç«¯é˜Ÿåˆ—</li><li><code>threading.local()</code>ï¼šçº¿ç¨‹æœ¬åœ°å­˜å‚¨</li></ul></li><li><p><strong>æ­£ç¡®ä½¿ç”¨é”</strong>ï¼š</p><ul><li>åªåœ¨å¿…è¦æ—¶ä½¿ç”¨é”</li><li>å‡å°‘é”çš„ä½œç”¨èŒƒå›´</li><li>é¿å…åµŒå¥—é”</li><li>ä½¿ç”¨<code>with</code>è¯­å¥ç®¡ç†é”</li></ul></li><li><p><strong>é¿å…ç«æ€æ¡ä»¶</strong>ï¼š</p><ul><li>ä½¿ç”¨åŸå­æ“ä½œ</li><li>ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„è®¡æ•°å™¨</li><li>ä½¿ç”¨<code>threading.RLock</code>é¿å…æ­»é”</li></ul></li></ol><h4>7.3 æ€§èƒ½ä¼˜åŒ–</h4><ol><li><p><strong>å‡å°‘çº¿ç¨‹/è¿›ç¨‹æ•°é‡</strong>ï¼š</p><ul><li>çº¿ç¨‹æ± å¤§å°ï¼šI/Oå¯†é›†å‹ä»»åŠ¡å¯è®¾ç½®è¾ƒå¤§</li><li>è¿›ç¨‹æ± å¤§å°ï¼šé€šå¸¸è®¾ç½®ä¸ºCPUæ ¸å¿ƒæ•°</li></ul></li><li><p><strong>ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹</strong>ï¼š</p><ul><li>å¯¹äºé«˜å¹¶å‘I/Oä»»åŠ¡ï¼Œå¼‚æ­¥ç¼–ç¨‹æ¯”å¤šçº¿ç¨‹æ›´é«˜æ•ˆ</li><li>å‡å°‘çº¿ç¨‹åˆ›å»ºå’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€</li></ul></li><li><p><strong>ç›‘æ§å’Œè°ƒä¼˜</strong>ï¼š</p><ul><li>ä½¿ç”¨<code>psutil</code>ç›‘æ§è¿›ç¨‹å’Œçº¿ç¨‹çŠ¶æ€</li><li>ä½¿ç”¨<code>cProfile</code>åˆ†ææ€§èƒ½ç“¶é¢ˆ</li><li>ä½¿ç”¨<code>tracemalloc</code>è·Ÿè¸ªå†…å­˜ä½¿ç”¨</li></ul></li></ol><h3>8. å®é™…åº”ç”¨æ¡ˆä¾‹</h3><h4>8.1 å¤šçº¿ç¨‹çˆ¬è™«</h4><pre><code class="python">import threading
import queue
import requests
from bs4 import BeautifulSoup

class Spider:
    def __init__(self, url, max_threads=4):
        self.url = url
        self.max_threads = max_threads
        self.queue = queue.Queue()
        self.visited = set()
        self.lock = threading.Lock()
    
    def crawl(self):
        self.queue.put(self.url)
        
        # åˆ›å»ºçº¿ç¨‹æ± 
        threads = []
        for _ in range(self.max_threads):
            t = threading.Thread(target=self._worker)
            t.start()
            threads.append(t)
        
        # ç­‰å¾…é˜Ÿåˆ—æ¸…ç©º
        self.queue.join()
        
        # åœæ­¢æ‰€æœ‰çº¿ç¨‹
        for _ in range(self.max_threads):
            self.queue.put(None)
        for t in threads:
            t.join()
    
    def _worker(self):
        while True:
            url = self.queue.get()
            if url is None:
                self.queue.task_done()
                break
            
            if url in self.visited:
                self.queue.task_done()
                continue
            
            try:
                response = requests.get(url, timeout=5)
                soup = BeautifulSoup(response.text, 'html.parser')
                
                # æå–é“¾æ¥
                links = []
                for a in soup.find_all('a', href=True):
                    link = a['href']
                    if link.startswith('http'):
                        links.append(link)
                
                # æ·»åŠ æ–°é“¾æ¥åˆ°é˜Ÿåˆ—
                with self.lock:
                    self.visited.add(url)
                    for link in links:
                        if link not in self.visited:
                            self.queue.put(link)
                
                print(f"Crawled: {url}, Found {len(links)} links")
            except Exception as e:
                print(f"Error crawling {url}: {e}")
            finally:
                self.queue.task_done()

# ä½¿ç”¨çˆ¬è™«
spider = Spider('https://example.com', max_threads=4)
spider.crawl()</code></pre><h4>8.2 å¤šè¿›ç¨‹æ•°æ®å¤„ç†</h4><pre><code class="python">import multiprocessing
import numpy as np

def process_chunk(chunk):
    # å¤„ç†æ•°æ®å—
    result = np.sum(chunk)
    return result

def main():
    # ç”Ÿæˆå¤§é‡æ•°æ®
    data = np.random.rand(10000000)  # çº¦80MBæ•°æ®
    
    # åˆ†å‰²æ•°æ®
    chunks = np.array_split(data, multiprocessing.cpu_count())
    
    # ä½¿ç”¨è¿›ç¨‹æ± å¤„ç†æ•°æ®
    with multiprocessing.Pool() as pool:
        results = pool.map(process_chunk, chunks)
    
    # æ±‡æ€»ç»“æœ
    total = sum(results)
    print(f"Total sum: {total}")

if __name__ == "__main__":
    main()</code></pre><h4>8.3 å¼‚æ­¥WebæœåŠ¡å™¨</h4><pre><code class="python">import asyncio
from aiohttp import web

async def handle(request):
    # æ¨¡æ‹ŸI/Oæ“ä½œ
    await asyncio.sleep(0.1)
    return web.Response(text="Hello, World!")

async def main():
    app = web.Application()
    app.add_routes([web.get('/', handle)])
    runner = web.AppRunner(app)
    await runner.setup()
    site = web.TCPSite(runner, 'localhost', 8080)
    await site.start()
    print("Server started at http://localhost:8080")
    # ä¿æŒæœåŠ¡å™¨è¿è¡Œ
    await asyncio.Event().wait()

# è¿è¡ŒæœåŠ¡å™¨
asyncio.run(main())</code></pre><h3>9. å¹¶å‘ç¼–ç¨‹çš„å·¥å…·ä¸åº“</h3><h4>9.1 æ ‡å‡†åº“</h4><ul><li><strong>threading</strong>ï¼šå¤šçº¿ç¨‹ç¼–ç¨‹</li><li><strong>multiprocessing</strong>ï¼šå¤šè¿›ç¨‹ç¼–ç¨‹</li><li><strong>concurrent.futures</strong>ï¼šçº¿ç¨‹æ± å’Œè¿›ç¨‹æ± </li><li><strong>asyncio</strong>ï¼šå¼‚æ­¥I/Oå’Œåç¨‹</li><li><strong>queue</strong>ï¼šçº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—</li></ul><h4>9.2 ç¬¬ä¸‰æ–¹åº“</h4><ul><li><strong>aiohttp</strong>ï¼šå¼‚æ­¥HTTPå®¢æˆ·ç«¯/æœåŠ¡å™¨</li><li><strong>asyncpg</strong>ï¼šå¼‚æ­¥PostgreSQLå®¢æˆ·ç«¯</li><li><strong>uvloop</strong>ï¼šæ›´å¿«çš„äº‹ä»¶å¾ªç¯å®ç°</li><li><strong>gunicorn</strong>ï¼šWSGI HTTPæœåŠ¡å™¨ï¼Œæ”¯æŒå¤šè¿›ç¨‹</li><li><strong>gevent</strong>ï¼šåŸºäºåç¨‹çš„å¹¶å‘åº“</li></ul><h4>9.3 æ€§èƒ½åˆ†æå·¥å…·</h4><ul><li><strong>cProfile</strong>ï¼šPythonçš„æ ‡å‡†æ€§èƒ½åˆ†æå™¨</li><li><strong>line_profiler</strong>ï¼šé€è¡Œæ€§èƒ½åˆ†æ</li><li><strong>memory_profiler</strong>ï¼šå†…å­˜ä½¿ç”¨åˆ†æ</li><li><strong>psutil</strong>ï¼šç³»ç»Ÿèµ„æºç›‘æ§</li><li><strong>py-spy</strong>ï¼šé‡‡æ ·åˆ†æå™¨ï¼Œä½å¼€é”€</li></ul><h3>10. æ€»ç»“</h3><p>Pythonçš„å¹¶å‘ç¼–ç¨‹æ˜¯ä¸€ä¸ªå¤æ‚ä½†å¼ºå¤§çš„é¢†åŸŸï¼ŒGILçš„å­˜åœ¨è™½ç„¶é™åˆ¶äº†å¤šçº¿ç¨‹çš„æ€§èƒ½ï¼Œä½†é€šè¿‡é€‰æ‹©åˆé€‚çš„å¹¶å‘æ¨¡å‹å’Œä¼˜åŒ–ç­–ç•¥ï¼Œå¯ä»¥å……åˆ†å‘æŒ¥Pythonçš„å¹¶å‘èƒ½åŠ›ã€‚</p><h4>å…³é”®è¦ç‚¹</h4><ol><li><p><strong>GILçš„å½±å“</strong>ï¼š</p><ul><li>CPUå¯†é›†å‹ä»»åŠ¡ï¼šå¤šçº¿ç¨‹æ— æ³•åˆ©ç”¨å¤šæ ¸ï¼Œæ¨èä½¿ç”¨å¤šè¿›ç¨‹</li><li>I/Oå¯†é›†å‹ä»»åŠ¡ï¼šå¤šçº¿ç¨‹å’Œåç¨‹éƒ½å¯ä»¥é«˜æ•ˆå¤„ç†</li></ul></li><li><p><strong>å¹¶å‘æ¨¡å‹é€‰æ‹©</strong>ï¼š</p><ul><li>å¤šçº¿ç¨‹ï¼šé€‚åˆI/Oå¯†é›†å‹ä»»åŠ¡ï¼Œç®€å•æ˜“ç”¨</li><li>å¤šè¿›ç¨‹ï¼šé€‚åˆCPUå¯†é›†å‹ä»»åŠ¡ï¼Œç»•è¿‡GIL</li><li>åç¨‹ï¼šé€‚åˆé«˜å¹¶å‘I/Oä»»åŠ¡ï¼Œè½»é‡é«˜æ•ˆ</li></ul></li><li><p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p><ul><li>æ ¹æ®ä»»åŠ¡ç±»å‹é€‰æ‹©åˆé€‚çš„å¹¶å‘æ¨¡å‹</li><li>ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„å’ŒåŒæ­¥åŸè¯­</li><li>é¿å…å…¨å±€å˜é‡å’Œç«æ€æ¡ä»¶</li><li>ä½¿ç”¨çº¿ç¨‹æ± å’Œè¿›ç¨‹æ± ç®¡ç†å¹¶å‘ä»»åŠ¡</li><li>ç›‘æ§å’Œè°ƒä¼˜å¹¶å‘æ€§èƒ½</li></ul></li><li><p><strong>GILçš„ä¼˜åŒ–</strong>ï¼š</p><ul><li>å¯¹äºCPUå¯†é›†å‹ä»»åŠ¡ï¼Œä½¿ç”¨å¤šè¿›ç¨‹æˆ–Cæ‰©å±•</li><li>å¯¹äºI/Oå¯†é›†å‹ä»»åŠ¡ï¼Œä½¿ç”¨å¤šçº¿ç¨‹æˆ–åç¨‹</li><li>å‡å°‘GILç«äº‰ï¼Œä¼˜åŒ–ä»£ç ç»“æ„</li></ul></li></ol><p>é€šè¿‡æŒæ¡Pythonçš„å¹¶å‘ç¼–ç¨‹æŠ€æœ¯ï¼Œå¼€å‘è€…å¯ä»¥ç¼–å†™æ›´é«˜æ•ˆã€æ›´å“åº”è¿…é€Ÿçš„åº”ç”¨ç¨‹åºï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†I/Oæ“ä½œã€ç½‘ç»œè¯·æ±‚å’Œæ•°æ®å¤„ç†ç­‰åœºæ™¯ä¸­ã€‚è™½ç„¶GILå¸¦æ¥äº†ä¸€äº›é™åˆ¶ï¼Œä½†é€šè¿‡åˆç†çš„è®¾è®¡å’Œé€‰æ‹©åˆé€‚çš„å·¥å…·ï¼ŒPythonä¾ç„¶æ˜¯ä¸€é—¨å¼ºå¤§çš„å¹¶å‘ç¼–ç¨‹è¯­è¨€ã€‚</p>]]></description></item><item>    <title><![CDATA[Pythonä¸­çš„å­—èŠ‚ç æ‰§è¡Œæœºåˆ¶ä¸è§£é‡Šå™¨åŸç† é€æ¢¦AI ]]></title>    <link>https://segmentfault.com/a/1190000047585287</link>    <guid>https://segmentfault.com/a/1190000047585287</guid>    <pubDate>2026-02-01 02:01:24</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>Pythonä¸­çš„å­—èŠ‚ç æ‰§è¡Œæœºåˆ¶ä¸è§£é‡Šå™¨åŸç†</h2><h3>1. Pythonè§£é‡Šå™¨æ¦‚è¿°</h3><h4>1.1 è§£é‡Šå™¨çš„è§’è‰²</h4><p>Pythonè§£é‡Šå™¨æ˜¯æ‰§è¡ŒPythonä»£ç çš„æ ¸å¿ƒç»„ä»¶ï¼Œå®ƒè´Ÿè´£å°†Pythonæºä»£ç è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„æœºå™¨ä»£ç ï¼Œå¹¶æ‰§è¡Œè¿™äº›ä»£ç ã€‚Pythonçš„è§£é‡Šæ‰§è¡Œç‰¹æ€§ä½¿å…¶å…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§å’ŒåŠ¨æ€æ€§ã€‚</p><h4>1.2 ä¸»è¦çš„Pythonè§£é‡Šå™¨</h4><ul><li><strong>CPython</strong>ï¼šå®˜æ–¹çš„Pythonè§£é‡Šå™¨ï¼Œç”¨Cè¯­è¨€å®ç°</li><li><strong>PyPy</strong>ï¼šä½¿ç”¨JITç¼–è¯‘çš„è§£é‡Šå™¨ï¼Œæ€§èƒ½æ›´é«˜</li><li><strong>Jython</strong>ï¼šè¿è¡Œåœ¨Javaè™šæ‹Ÿæœºä¸Šçš„è§£é‡Šå™¨</li><li><strong>IronPython</strong>ï¼šè¿è¡Œåœ¨.NETå¹³å°ä¸Šçš„è§£é‡Šå™¨</li><li><strong>MicroPython</strong>ï¼šé’ˆå¯¹å¾®æ§åˆ¶å™¨çš„ç²¾ç®€ç‰ˆè§£é‡Šå™¨</li></ul><h4>1.3 CPythonçš„æ¶æ„</h4><p>CPythonçš„æ¶æ„ä¸»è¦ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š</p><ul><li><strong>è¯æ³•åˆ†æå™¨</strong>ï¼šå°†æºä»£ç åˆ†è§£ä¸ºè¯æ³•å•å…ƒï¼ˆtokensï¼‰</li><li><strong>è¯­æ³•åˆ†æå™¨</strong>ï¼šå°†è¯æ³•å•å…ƒè§£æä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰</li><li><strong>ç¼–è¯‘å™¨</strong>ï¼šå°†æŠ½è±¡è¯­æ³•æ ‘ç¼–è¯‘ä¸ºå­—èŠ‚ç </li><li><strong>è™šæ‹Ÿæœº</strong>ï¼šæ‰§è¡Œå­—èŠ‚ç </li><li><strong>è¿è¡Œæ—¶ç¯å¢ƒ</strong>ï¼šæä¾›å†…å­˜ç®¡ç†ã€åƒåœ¾å›æ”¶ç­‰åŠŸèƒ½</li></ul><h3>2. å­—èŠ‚ç çš„ç”Ÿæˆè¿‡ç¨‹</h3><h4>2.1 æºä»£ç åˆ°å­—èŠ‚ç çš„è½¬æ¢</h4><p>Pythonä»£ç çš„æ‰§è¡Œè¿‡ç¨‹åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li><strong>è¯æ³•åˆ†æ</strong>ï¼šå°†æºä»£ç åˆ†è§£ä¸ºè¯æ³•å•å…ƒ</li><li><strong>è¯­æ³•åˆ†æ</strong>ï¼šæ„å»ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰</li><li><strong>ç¼–è¯‘</strong>ï¼šå°†ASTç¼–è¯‘ä¸ºå­—èŠ‚ç </li><li><strong>æ‰§è¡Œ</strong>ï¼šè™šæ‹Ÿæœºæ‰§è¡Œå­—èŠ‚ç </li></ol><h4>2.2 æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰</h4><p>æŠ½è±¡è¯­æ³•æ ‘æ˜¯æºä»£ç çš„ç»“æ„åŒ–è¡¨ç¤ºï¼Œå®ƒæ•è·äº†ä»£ç çš„è¯­æ³•ç»“æ„ä½†ä¸åŒ…å«è¯­æ³•ç»†èŠ‚ã€‚</p><pre><code>import astâ€‹# è§£ææºä»£ç ä¸ºASTcode = "print('Hello, World!')"ast_tree = ast.parse(code)â€‹# æ‰“å°ASTç»“æ„print(ast.dump(ast_tree, indent=2))</code></pre><h4>2.3 å­—èŠ‚ç ç¼–è¯‘</h4><p>ç¼–è¯‘å™¨å°†ASTè½¬æ¢ä¸ºå­—èŠ‚ç ï¼Œå­—èŠ‚ç æ˜¯ä¸€ç§ä¸­é—´è¡¨ç¤ºï¼Œç±»ä¼¼äºæ±‡ç¼–è¯­è¨€ï¼Œä½†ä¸å…·ä½“ç¡¬ä»¶æ— å…³ã€‚</p><pre><code>import disâ€‹# å®šä¹‰ä¸€ä¸ªå‡½æ•°def add(a, b): Â  Â return a + bâ€‹# æŸ¥çœ‹å‡½æ•°çš„å­—èŠ‚ç dis.dis(add)</code></pre><h4>2.4 å­—èŠ‚ç çš„å­˜å‚¨</h4><ul><li><strong>.pycæ–‡ä»¶</strong>ï¼šPythonä¼šå°†ç¼–è¯‘åçš„å­—èŠ‚ç ç¼“å­˜åˆ°.pycæ–‡ä»¶ä¸­ï¼ŒåŠ å¿«ä¸‹æ¬¡æ‰§è¡Œé€Ÿåº¦</li><li><strong>å†…å­˜ä¸­çš„å­—èŠ‚ç </strong>ï¼šå¯¹äºäº¤äº’å¼æ‰§è¡Œçš„ä»£ç ï¼Œå­—èŠ‚ç åªå­˜å‚¨åœ¨å†…å­˜ä¸­</li></ul><h3>3. å­—èŠ‚ç çš„ç»“æ„</h3><h4>3.1 å­—èŠ‚ç æŒ‡ä»¤</h4><p>Pythonå­—èŠ‚ç ç”±ä¸€ç³»åˆ—æŒ‡ä»¤ç»„æˆï¼Œæ¯ä¸ªæŒ‡ä»¤åŒ…å«ï¼š</p><ul><li><strong>æ“ä½œç </strong>ï¼ˆOpcodeï¼‰ï¼šä¸€ä¸ªå­—èŠ‚çš„æ“ä½œä»£ç </li><li><strong>æ“ä½œæ•°</strong>ï¼ˆOperandï¼‰ï¼šé›¶ä¸ªæˆ–å¤šä¸ªæ“ä½œæ•°</li></ul><h4>3.2 å¸¸è§çš„å­—èŠ‚ç æŒ‡ä»¤</h4><table><thead><tr><th>æŒ‡ä»¤</th><th>æ“ä½œç </th><th>æè¿°</th></tr></thead><tbody><tr><td>LOAD\_CONST</td><td>100</td><td>åŠ è½½å¸¸é‡</td></tr><tr><td>LOAD\_FAST</td><td>124</td><td>åŠ è½½å±€éƒ¨å˜é‡</td></tr><tr><td>LOAD\_GLOBAL</td><td>116</td><td>åŠ è½½å…¨å±€å˜é‡</td></tr><tr><td>STORE\_FAST</td><td>125</td><td>å­˜å‚¨å±€éƒ¨å˜é‡</td></tr><tr><td>STORE\_GLOBAL</td><td>117</td><td>å­˜å‚¨å…¨å±€å˜é‡</td></tr><tr><td>BINARY\_ADD</td><td>23</td><td>æ‰§è¡ŒåŠ æ³•æ“ä½œ</td></tr><tr><td>BINARY\_SUBTRACT</td><td>24</td><td>æ‰§è¡Œå‡æ³•æ“ä½œ</td></tr><tr><td>COMPARE\_OP</td><td>107</td><td>æ‰§è¡Œæ¯”è¾ƒæ“ä½œ</td></tr><tr><td>POP\_JUMP\_IF\_FALSE</td><td>114</td><td>æ¡ä»¶è·³è½¬åˆ°æŒ‡å®šä½ç½®</td></tr><tr><td>RETURN\_VALUE</td><td>83</td><td>è¿”å›å€¼</td></tr></tbody></table><h4>3.3 å­—èŠ‚ç çš„ç¤ºä¾‹</h4><pre><code># ç¤ºä¾‹å‡½æ•°def simple_function(): Â  Â x = 1 Â  Â y = 2 Â  Â return x + yâ€‹# æŸ¥çœ‹å­—èŠ‚ç import disdis.dis(simple_function)â€‹# è¾“å‡º:#  2 Â  Â  Â  Â  Â  0 LOAD_CONST Â  Â  Â  Â  Â  Â  Â  1 (1)# Â  Â  Â  Â  Â  Â   2 STORE_FAST Â  Â  Â  Â  Â  Â  Â  0 (x)##  3 Â  Â  Â  Â  Â  4 LOAD_CONST Â  Â  Â  Â  Â  Â  Â  2 (2)# Â  Â  Â  Â  Â  Â   6 STORE_FAST Â  Â  Â  Â  Â  Â  Â  1 (y)##  4 Â  Â  Â  Â  Â  8 LOAD_FAST Â  Â  Â  Â  Â  Â  Â   0 (x)# Â  Â  Â  Â  Â  Â  10 LOAD_FAST Â  Â  Â  Â  Â  Â  Â   1 (y)# Â  Â  Â  Â  Â  Â  12 BINARY_ADD# Â  Â  Â  Â  Â  Â  14 RETURN_VALUE</code></pre><h3>4. Pythonè™šæ‹Ÿæœºçš„æ‰§è¡Œæœºåˆ¶</h3><h4>4.1 è™šæ‹Ÿæœºçš„ç»“æ„</h4><p>Pythonè™šæ‹Ÿæœºï¼ˆCPython VMï¼‰æ˜¯ä¸€ä¸ªåŸºäºæ ˆçš„è™šæ‹Ÿæœºï¼Œå®ƒä½¿ç”¨ä»¥ä¸‹å‡ ä¸ªæ ˆï¼š</p><ul><li><strong>æ•°æ®æ ˆ</strong>ï¼šç”¨äºå­˜å‚¨æ“ä½œæ•°å’Œä¸­é—´ç»“æœ</li><li><strong>è°ƒç”¨æ ˆ</strong>ï¼šç”¨äºå­˜å‚¨å‡½æ•°è°ƒç”¨ä¿¡æ¯</li><li><strong>å—æ ˆ</strong>ï¼šç”¨äºå¤„ç†å¼‚å¸¸å’Œå¾ªç¯ç­‰æ§åˆ¶ç»“æ„</li></ul><h4>4.2 å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹</h4><p>è™šæ‹Ÿæœºæ‰§è¡Œå­—èŠ‚ç çš„è¿‡ç¨‹æ˜¯ä¸€ä¸ªå¾ªç¯ï¼š</p><ol><li><strong>è·å–æŒ‡ä»¤</strong>ï¼šä»å­—èŠ‚ç ä¸­è·å–ä¸‹ä¸€æ¡æŒ‡ä»¤</li><li><strong>è§£ç æŒ‡ä»¤</strong>ï¼šè§£ææ“ä½œç å’Œæ“ä½œæ•°</li><li><strong>æ‰§è¡ŒæŒ‡ä»¤</strong>ï¼šæ ¹æ®æ“ä½œç æ‰§è¡Œç›¸åº”çš„æ“ä½œ</li><li><strong>é‡å¤</strong>ï¼šç›´åˆ°æ‰€æœ‰å­—èŠ‚ç æ‰§è¡Œå®Œæ¯•</li></ol><h4>4.3 å‡½æ•°è°ƒç”¨æœºåˆ¶</h4><p>å‡½æ•°è°ƒç”¨æ¶‰åŠä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><strong>åˆ›å»ºå¸§å¯¹è±¡</strong>ï¼šä¸ºå‡½æ•°è°ƒç”¨åˆ›å»ºä¸€ä¸ªå¸§å¯¹è±¡ï¼ŒåŒ…å«å±€éƒ¨å˜é‡ã€å‚æ•°ç­‰</li><li><strong>è®¾ç½®æ‰§è¡Œç¯å¢ƒ</strong>ï¼šå°†å¸§å¯¹è±¡å‹å…¥è°ƒç”¨æ ˆ</li><li><strong>æ‰§è¡Œå‡½æ•°ä»£ç </strong>ï¼šè™šæ‹Ÿæœºæ‰§è¡Œå‡½æ•°çš„å­—èŠ‚ç </li><li><strong>è¿”å›ç»“æœ</strong>ï¼šå‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå°†ç»“æœè¿”å›ç»™è°ƒç”¨è€…</li><li><strong>é”€æ¯å¸§å¯¹è±¡</strong>ï¼šä»è°ƒç”¨æ ˆä¸­å¼¹å‡ºå¸§å¯¹è±¡</li></ol><h4>4.4 å¸§å¯¹è±¡</h4><p>å¸§å¯¹è±¡æ˜¯å‡½æ•°æ‰§è¡Œçš„ç¯å¢ƒï¼Œå®ƒåŒ…å«ï¼š</p><ul><li><strong>å±€éƒ¨å˜é‡</strong>ï¼šå‡½æ•°çš„å±€éƒ¨å˜é‡</li><li><strong>å…¨å±€å˜é‡</strong>ï¼šå‡½æ•°å¯ä»¥è®¿é—®çš„å…¨å±€å˜é‡</li><li><strong>å†…ç½®å˜é‡</strong>ï¼šå‡½æ•°å¯ä»¥è®¿é—®çš„å†…ç½®å˜é‡</li><li><strong>ä»£ç å¯¹è±¡</strong>ï¼šå‡½æ•°çš„å­—èŠ‚ç å’Œç›¸å…³ä¿¡æ¯</li><li><strong>ä¸Šä¸€ä¸ªå¸§</strong>ï¼šè°ƒç”¨è€…çš„å¸§å¯¹è±¡</li></ul><h3>5. å­—èŠ‚ç çš„æ‰§è¡Œç¤ºä¾‹</h3><h4>5.1 ç®€å•è¡¨è¾¾å¼æ‰§è¡Œ</h4><pre><code># æ‰§è¡Œè¡¨è¾¾å¼: a + bâ€‹def add(a, b): Â  Â return a + bâ€‹# å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹:# 1. LOAD_FAST 0 (a) Â  # å°†aå‹å…¥æ•°æ®æ ˆ# 2. LOAD_FAST 1 (b) Â  # å°†bå‹å…¥æ•°æ®æ ˆ# 3. BINARY_ADD Â  Â  Â   # å¼¹å‡ºä¸¤ä¸ªå€¼ï¼Œæ‰§è¡ŒåŠ æ³•ï¼Œå°†ç»“æœå‹å…¥æ ˆ# 4. RETURN_VALUE Â  Â   # å¼¹å‡ºç»“æœå¹¶è¿”å›</code></pre><h4>5.2 æ¡ä»¶è¯­å¥æ‰§è¡Œ</h4><pre><code># æ¡ä»¶è¯­å¥æ‰§è¡Œdef check_number(n): Â  Â if n &gt; 0: Â  Â  Â  Â return "Positive" Â  Â else: Â  Â  Â  Â return "Non-positive"â€‹# å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹:# 1. LOAD_FAST 0 (n) Â  Â   # åŠ è½½n# 2. LOAD_CONST 1 (0) Â  Â  # åŠ è½½å¸¸é‡0# 3. COMPARE_OP 4 (&gt;) Â  Â  # æ¯”è¾ƒn &gt; 0# 4. POP_JUMP_IF_FALSE 12 # å¦‚æœä¸ºå‡ï¼Œè·³è½¬åˆ°æŒ‡ä»¤12# 5. LOAD_CONST 2 ('Positive')  # åŠ è½½"Positive"# 6. RETURN_VALUE Â  Â  Â  Â  # è¿”å›# 7. JUMP_FORWARD 4 (to 13)  # è·³è½¬åˆ°æŒ‡ä»¤13# 8. LOAD_CONST 3 ('Non-positive')  # åŠ è½½"Non-positive"# 9. RETURN_VALUE Â  Â  Â  Â  # è¿”å›</code></pre><h4>5.3 å¾ªç¯è¯­å¥æ‰§è¡Œ</h4><pre><code># å¾ªç¯è¯­å¥æ‰§è¡Œdef sum_range(n): Â  Â total = 0 Â  Â for i in range(n): Â  Â  Â  Â total += i Â  Â return totalâ€‹# å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹:# 1. LOAD_CONST 1 (0) Â  Â  # åŠ è½½0# 2. STORE_FAST 1 (total)  # å­˜å‚¨åˆ°total# 3. LOAD_GLOBAL 0 (range) # åŠ è½½range# 4. LOAD_FAST 0 (n) Â  Â  Â  # åŠ è½½n# 5. CALL_FUNCTION 1 Â  Â  Â  # è°ƒç”¨range(n)# 6. GET_ITER Â  Â  Â  Â  Â  Â   # è·å–è¿­ä»£å™¨# 7. FOR_ITER 12 (to 21) Â  # å¾ªç¯ï¼Œç›´åˆ°è¿­ä»£ç»“æŸ# 8. STORE_FAST 2 (i) Â  Â   # å­˜å‚¨å½“å‰è¿­ä»£å€¼åˆ°i# 9. LOAD_FAST 1 (total) Â  # åŠ è½½total# 10. LOAD_FAST 2 (i) Â  Â   # åŠ è½½i# 11. INPLACE_ADD Â  Â  Â  Â   # æ‰§è¡Œtotal += i# 12. STORE_FAST 1 (total) # å­˜å‚¨ç»“æœåˆ°total# 13. JUMP_ABSOLUTE 7 Â  Â   # è·³å›å¾ªç¯å¼€å§‹# 14. LOAD_FAST 1 (total)  # å¾ªç¯ç»“æŸï¼ŒåŠ è½½total# 15. RETURN_VALUE Â  Â  Â  Â  # è¿”å›total</code></pre><h3>6. è¿è¡Œæ—¶ç¯å¢ƒ</h3><h4>6.1 å†…å­˜ç®¡ç†</h4><p>Pythonçš„å†…å­˜ç®¡ç†ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š</p><ul><li><strong>å¯¹è±¡åˆ†é…å™¨</strong>ï¼šè´Ÿè´£å¯¹è±¡çš„å†…å­˜åˆ†é…</li><li><strong>å†…å­˜æ± </strong>ï¼šç®¡ç†å°å¯¹è±¡çš„å†…å­˜åˆ†é…</li><li><strong>åƒåœ¾å›æ”¶å™¨</strong>ï¼šå›æ”¶ä¸å†ä½¿ç”¨çš„å†…å­˜</li></ul><h4>6.2 åƒåœ¾å›æ”¶</h4><p>Pythonä½¿ç”¨å¼•ç”¨è®¡æ•°å’Œå¾ªç¯åƒåœ¾å›æ”¶å™¨æ¥ç®¡ç†å†…å­˜ï¼š</p><ul><li><strong>å¼•ç”¨è®¡æ•°</strong>ï¼šåŸºæœ¬çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå½“å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º0æ—¶å›æ”¶</li><li><strong>å¾ªç¯åƒåœ¾å›æ”¶å™¨</strong>ï¼šå¤„ç†å¾ªç¯å¼•ç”¨çš„åƒåœ¾å›æ”¶å™¨</li></ul><h4>6.3 å¼‚å¸¸å¤„ç†</h4><p>å¼‚å¸¸å¤„ç†åœ¨å­—èŠ‚ç å±‚é¢é€šè¿‡ä»¥ä¸‹æŒ‡ä»¤å®ç°ï¼š</p><ul><li><strong>SETUP\_EXCEPT</strong>ï¼šè®¾ç½®å¼‚å¸¸å¤„ç†å—</li><li><strong>SETUP\_FINALLY</strong>ï¼šè®¾ç½®finallyå—</li><li><strong>RAISE\_VARARGS</strong>ï¼šæŠ›å‡ºå¼‚å¸¸</li><li><strong>END\_FINALLY</strong>ï¼šç»“æŸfinallyå—</li></ul><h4>6.4 æ¨¡å—å¯¼å…¥æœºåˆ¶</h4><p>æ¨¡å—å¯¼å…¥æ¶‰åŠä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><strong>æŸ¥æ‰¾æ¨¡å—</strong>ï¼šåœ¨sys.pathä¸­æŸ¥æ‰¾æ¨¡å—</li><li><strong>åŠ è½½æ¨¡å—</strong>ï¼šå¦‚æœæ‰¾åˆ°æ¨¡å—æ–‡ä»¶ï¼Œè¯»å–å¹¶ç¼–è¯‘</li><li><strong>æ‰§è¡Œæ¨¡å—</strong>ï¼šæ‰§è¡Œæ¨¡å—çš„å­—èŠ‚ç </li><li><strong>ç¼“å­˜æ¨¡å—</strong>ï¼šå°†æ¨¡å—å¯¹è±¡ç¼“å­˜åˆ°sys.modulesä¸­</li></ol><h3>7. å­—èŠ‚ç ä¼˜åŒ–</h3><h4>7.1 ç¼–è¯‘å™¨ä¼˜åŒ–</h4><p>Pythonç¼–è¯‘å™¨ä¼šè¿›è¡Œä¸€äº›åŸºæœ¬çš„ä¼˜åŒ–ï¼š</p><ul><li><strong>å¸¸é‡æŠ˜å </strong>ï¼šè®¡ç®—å¸¸é‡è¡¨è¾¾å¼çš„å€¼</li><li><strong>å˜é‡è®¿é—®ä¼˜åŒ–</strong>ï¼šä¼˜åŒ–å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡çš„è®¿é—®</li><li><strong>å¾ªç¯ä¼˜åŒ–</strong>ï¼šä¼˜åŒ–å¾ªç¯ç»“æ„</li></ul><h4>7.2 è¿è¡Œæ—¶ä¼˜åŒ–</h4><ul><li><strong>å±æ€§è®¿é—®ç¼“å­˜</strong>ï¼šç¼“å­˜å¯¹è±¡çš„å±æ€§è®¿é—®</li><li><strong>æ–¹æ³•è°ƒç”¨ä¼˜åŒ–</strong>ï¼šä¼˜åŒ–æ–¹æ³•è°ƒç”¨çš„å¼€é”€</li><li><strong>å†…è”å‡½æ•°</strong>ï¼šå¯¹äºç®€å•å‡½æ•°è¿›è¡Œå†…è”</li></ul><h4>7.3 å­—èŠ‚ç åˆ†æå·¥å…·</h4><ul><li><strong>disæ¨¡å—</strong>ï¼šåæ±‡ç¼–å­—èŠ‚ç </li><li><strong>sys.settrace</strong>ï¼šè®¾ç½®è·Ÿè¸ªå‡½æ•°ï¼Œç”¨äºè°ƒè¯•å’Œæ€§èƒ½åˆ†æ</li><li><strong>profileå’ŒcProfile</strong>ï¼šæ€§èƒ½åˆ†æå·¥å…·</li></ul><h4>7.4 ä¼˜åŒ–ç¤ºä¾‹</h4><pre><code># åŸå§‹ä»£ç def slow_function(): Â  Â result = 0 Â  Â for i in range(1000): Â  Â  Â  Â result += i Â  Â return resultâ€‹# ä¼˜åŒ–åçš„ä»£ç def fast_function(): Â  Â return sum(range(1000))â€‹# æŸ¥çœ‹å­—èŠ‚ç å·®å¼‚import disprint("Slow function:")dis.dis(slow_function)print("\nFast function:")dis.dis(fast_function)</code></pre><h3>8. Pythonè§£é‡Šå™¨çš„æ€§èƒ½</h3><h4>8.1 CPythonçš„æ€§èƒ½ç‰¹ç‚¹</h4><ul><li><strong>è§£é‡Šæ‰§è¡Œ</strong>ï¼šå­—èŠ‚ç è§£é‡Šæ‰§è¡Œæ¯”æœºå™¨ç æ…¢</li><li><strong>GILé™åˆ¶</strong>ï¼šå…¨å±€è§£é‡Šå™¨é”é™åˆ¶äº†å¤šçº¿ç¨‹æ€§èƒ½</li><li><strong>å†…å­˜ç®¡ç†</strong>ï¼šåŠ¨æ€ç±»å‹å’Œåƒåœ¾å›æ”¶å¢åŠ äº†å¼€é”€</li><li><strong>çµæ´»æ€§</strong>ï¼šåŠ¨æ€ç‰¹æ€§å¸¦æ¥äº†æ€§èƒ½å¼€é”€</li></ul><h4>8.2 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h4><ul><li><strong>ä½¿ç”¨å†…ç½®å‡½æ•°</strong>ï¼šå†…ç½®å‡½æ•°æ˜¯ç”¨Cå®ç°çš„ï¼Œæ‰§è¡Œé€Ÿåº¦å¿«</li><li><strong>é¿å…å¾ªç¯</strong>ï¼šä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼ã€ç”Ÿæˆå™¨è¡¨è¾¾å¼ç­‰</li><li><strong>ä½¿ç”¨å±€éƒ¨å˜é‡</strong>ï¼šå±€éƒ¨å˜é‡è®¿é—®æ¯”å…¨å±€å˜é‡å¿«</li><li><strong>å‡å°‘å‡½æ•°è°ƒç”¨</strong>ï¼šå‡½æ•°è°ƒç”¨æœ‰å¼€é”€</li><li><strong>ä½¿ç”¨é€‚å½“çš„æ•°æ®ç»“æ„</strong>ï¼šé€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„</li></ul><h4>8.3 æ›¿ä»£è§£é‡Šå™¨</h4><ul><li><strong>PyPy</strong>ï¼šä½¿ç”¨JITç¼–è¯‘ï¼Œæ€§èƒ½æ¯”CPythoné«˜2-10å€</li><li><strong>Cython</strong>ï¼šå°†Pythonä»£ç ç¼–è¯‘ä¸ºCä»£ç ï¼Œæé«˜æ€§èƒ½</li><li><strong>Numba</strong>ï¼šä½¿ç”¨å³æ—¶ç¼–è¯‘åŠ é€Ÿæ•°å€¼è®¡ç®—</li></ul><h3>9. å­—èŠ‚ç çš„å®‰å…¨æ€§</h3><h4>9.1 å­—èŠ‚ç çš„å®‰å…¨æ€§è€ƒè™‘</h4><ul><li><strong>å­—èŠ‚ç æ··æ·†</strong>ï¼šå¯ä»¥é€šè¿‡æ··æ·†å­—èŠ‚ç ä¿æŠ¤ä»£ç </li><li><strong>å­—èŠ‚ç éªŒè¯</strong>ï¼šç¡®ä¿å­—èŠ‚ç çš„å®‰å…¨æ€§</li><li><strong>æ²™ç®±æ‰§è¡Œ</strong>ï¼šé™åˆ¶ä»£ç çš„æ‰§è¡Œæƒé™</li></ul><h4>9.2 å­—èŠ‚ç æ“ä½œ</h4><pre><code># æ“ä½œå­—èŠ‚ç ç¤ºä¾‹import typesimport disâ€‹# å®šä¹‰åŸå§‹å‡½æ•°def original(): Â  Â return 42â€‹# è·å–åŸå§‹å­—èŠ‚ç original_code = original.__code__print("Original bytecode:")dis.dis(original)â€‹# åˆ›å»ºæ–°çš„å­—èŠ‚ç ï¼ˆè¿”å›100ï¼‰new_bytes = b'\x84\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00\x17\x00\x00\x00\x00\x00\x00\x00\x73\x01\x00\x00\x00d\x64\x00\x00\x53'â€‹# åˆ›å»ºæ–°çš„ä»£ç å¯¹è±¡new_code = types.CodeType( Â  Â original_code.co_argcount, Â  Â original_code.co_posonlyargcount, Â  Â original_code.co_kwonlyargcount, Â  Â original_code.co_nlocals, Â  Â original_code.co_stacksize, Â  Â original_code.co_flags, Â  Â new_bytes, Â  Â original_code.co_consts, Â  Â original_code.co_names, Â  Â original_code.co_varnames, Â  Â original_code.co_filename, Â  Â "modified", Â  Â original_code.co_firstlineno, Â  Â original_code.co_lnotab, Â  Â original_code.co_freevars, Â  Â original_code.co_cellvars)â€‹# åˆ›å»ºæ–°å‡½æ•°modified = types.FunctionType(new_code, globals())print("\nModified bytecode:")dis.dis(modified)print("\nModified function result:", modified())</code></pre><h4>9.3 å­—èŠ‚ç éªŒè¯</h4><ul><li><strong>ç¡®ä¿å­—èŠ‚ç çš„æœ‰æ•ˆæ€§</strong>ï¼šéªŒè¯å­—èŠ‚ç çš„ç»“æ„å’ŒæŒ‡ä»¤</li><li><strong>é˜²æ­¢ç¼“å†²åŒºæº¢å‡º</strong>ï¼šç¡®ä¿æ“ä½œæ•°åœ¨æœ‰æ•ˆèŒƒå›´å†…</li><li><strong>é™åˆ¶æ‰§è¡Œæƒé™</strong>ï¼šåœ¨å®‰å…¨ç¯å¢ƒä¸­æ‰§è¡Œä¸å¯ä¿¡ä»£ç </li></ul><h3>10. é«˜çº§è¯é¢˜</h3><h4>10.1 åŠ¨æ€å­—èŠ‚ç ç”Ÿæˆ</h4><p>å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆå­—èŠ‚ç ï¼š</p><pre><code>import typesimport dis# åŠ¨æ€ç”Ÿæˆå­—èŠ‚ç def create_function():    # å­—èŠ‚ç : return 42    bytecode = b'\x84\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00\x17\x00\x00\x00\x00\x00\x00\x00\x73\x01\x00\x00\x00d\x2a\x00\x00\x53'        # åˆ›å»ºä»£ç å¯¹è±¡    code_obj = types.CodeType(        0,  # co_argcount        0,  # co_posonlyargcount        0,  # co_kwonlyargcount        0,  # co_nlocals        1,  # co_stacksize        67, # co_flags        bytecode,  # co_code        (42,),  # co_consts        (),  # co_names        (),  # co_varnames        '&lt;dynamic&gt;',  # co_filename        'dynamic_function',  # co_name        1,  # co_firstlineno        b'',  # co_lnotab        (),  # co_freevars        ()   # co_cellvars    )        # åˆ›å»ºå‡½æ•°    return types.FunctionType(code_obj, globals())# ä½¿ç”¨åŠ¨æ€ç”Ÿæˆçš„å‡½æ•°dynamic_func = create_function()print("Function result:", dynamic_func())print("Bytecode:")dis.dis(dynamic_func)</code></pre><h4>10.2 è‡ªå®šä¹‰è§£é‡Šå™¨</h4><p>å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„Pythonè§£é‡Šå™¨ï¼š</p><ul><li><strong>æ‰©å±•CPython</strong>ï¼šé€šè¿‡Cæ‰©å±•æ‰©å±•CPython</li><li><strong>åµŒå…¥CPython</strong>ï¼šå°†CPythonåµŒå…¥åˆ°å…¶ä»–åº”ç”¨ä¸­</li><li><strong>åˆ›å»ºè‡ªå®šä¹‰è™šæ‹Ÿæœº</strong>ï¼šå®ç°è‡ªå·±çš„Pythonè™šæ‹Ÿæœº</li></ul><h4>10.3 å­—èŠ‚ç ä¸JITç¼–è¯‘</h4><p>PyPyä½¿ç”¨JITç¼–è¯‘æ¥æé«˜æ€§èƒ½ï¼š</p><ul><li><strong>è·Ÿè¸ªJIT</strong>ï¼šè·Ÿè¸ªçƒ­ç‚¹ä»£ç å¹¶ç¼–è¯‘ä¸ºæœºå™¨ç </li><li><strong>ç±»å‹æ¨æ–­</strong>ï¼šæ¨æ–­å˜é‡ç±»å‹ï¼Œç”Ÿæˆæ›´é«˜æ•ˆçš„ä»£ç </li><li><strong>å†…è”ç¼“å­˜</strong>ï¼šç¼“å­˜æ–¹æ³•è°ƒç”¨ï¼Œå‡å°‘é—´æ¥å¼€é”€</li></ul><h4>10.4 å­—èŠ‚ç ä¸åºåˆ—åŒ–</h4><p>å­—èŠ‚ç å¯ä»¥ç”¨äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼š</p><ul><li><strong>pickleæ¨¡å—</strong>ï¼šå¯ä»¥åºåˆ—åŒ–Pythonå¯¹è±¡</li><li><strong>marshalæ¨¡å—</strong>ï¼šå¯ä»¥åºåˆ—åŒ–ä»£ç å¯¹è±¡</li><li><strong>cloudpickle</strong>ï¼šå¯ä»¥åºåˆ—åŒ–æ›´å¤šç±»å‹çš„å¯¹è±¡</li></ul><h3>11. å®è·µåº”ç”¨</h3><h4>11.1 å­—èŠ‚ç åˆ†æ</h4><pre><code># å­—èŠ‚ç åˆ†æç¤ºä¾‹import disimport inspect# åˆ†æå‡½æ•°çš„å­—èŠ‚ç def analyze_function(func):    print(f"Analyzing function: {func.__name__}")    print(f"File: {inspect.getfile(func)}")    print(f"Line: {inspect.getsourcelines(func)[1]}")    print("\nBytecode:")    dis.dis(func)        # åˆ†æå¸¸é‡å’Œå˜é‡    code_obj = func.__code__    print("\nConstants:", code_obj.co_consts)    print("Names:", code_obj.co_names)    print("Varnames:", code_obj.co_varnames)# æµ‹è¯•å‡½æ•°def example_function(a, b):    result = a + b    if result &gt; 10:        return "Large"    else:        return "Small"# åˆ†æå‡½æ•°analyze_function(example_function)</code></pre><h4>11.2 æ€§èƒ½ä¼˜åŒ–æ¡ˆä¾‹</h4><pre><code># æ€§èƒ½ä¼˜åŒ–æ¡ˆä¾‹import timeimport dis# åŸå§‹ç‰ˆæœ¬def slow_sum(n):    result = 0    for i in range(n):        result += i    return result# ä¼˜åŒ–ç‰ˆæœ¬def fast_sum(n):    return sum(range(n))# æµ‹è¯•æ€§èƒ½n = 1000000start = time.time()slow_sum(n)print(f"Slow version: {time.time() - start:.6f} seconds")start = time.time()fast_sum(n)print(f"Fast version: {time.time() - start:.6f} seconds")# åˆ†æå­—èŠ‚ç print("\nSlow version bytecode:")dis.dis(slow_sum)print("\nFast version bytecode:")dis.dis(fast_sum)</code></pre><h4>11.3 å­—èŠ‚ç æ··æ·†</h4><pre><code># ç®€å•çš„å­—èŠ‚ç æ··æ·†ç¤ºä¾‹import typesimport zlibimport base64# åŸå§‹å‡½æ•°def secret_function():    return "This is a secret function!"# è·å–åŸå§‹å­—èŠ‚ç original_code = secret_function.__code__# æ··æ·†å­—èŠ‚ç encrypted_bytes = base64.b64encode(zlib.compress(original_code.co_code))print(f"Encrypted bytecode: {encrypted_bytes}")# è§£å¯†å­—èŠ‚ç decrypted_bytes = zlib.decompress(base64.b64decode(encrypted_bytes))# åˆ›å»ºæ–°çš„ä»£ç å¯¹è±¡new_code = types.CodeType(    original_code.co_argcount,    original_code.co_posonlyargcount,    original_code.co_kwonlyargcount,    original_code.co_nlocals,    original_code.co_stacksize,    original_code.co_flags,    decrypted_bytes,    original_code.co_consts,    original_code.co_names,    original_code.co_varnames,    original_code.co_filename,    original_code.co_name,    original_code.co_firstlineno,    original_code.co_lnotab,    original_code.co_freevars,    original_code.co_cellvars)# åˆ›å»ºæ–°å‡½æ•°obfuscated_function = types.FunctionType(new_code, globals())print(f"Function result: {obfuscated_function()}")</code></pre><h3>12. æ€»ç»“</h3><p>Pythonçš„å­—èŠ‚ç æ‰§è¡Œæœºåˆ¶æ˜¯Pythonè§£é‡Šå™¨çš„æ ¸å¿ƒï¼Œå®ƒå°†æºä»£ç è½¬æ¢ä¸ºå­—èŠ‚ç å¹¶åœ¨è™šæ‹Ÿæœºä¸­æ‰§è¡Œã€‚é€šè¿‡ç†è§£å­—èŠ‚ç çš„ç”Ÿæˆå’Œæ‰§è¡Œè¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p><ol><li><strong>ä¼˜åŒ–ä»£ç æ€§èƒ½</strong>ï¼šäº†è§£å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹ï¼Œç¼–å†™æ›´é«˜æ•ˆçš„ä»£ç </li><li><strong>è°ƒè¯•å¤æ‚é—®é¢˜</strong>ï¼šé€šè¿‡åˆ†æå­—èŠ‚ç ï¼Œç†è§£ä»£ç çš„æ‰§è¡Œæµç¨‹</li><li><strong>æ‰©å±•PythonåŠŸèƒ½</strong>ï¼šé€šè¿‡æ“ä½œå­—èŠ‚ç ï¼Œæ‰©å±•Pythonçš„åŠŸèƒ½</li><li><strong>æé«˜ä»£ç å®‰å…¨æ€§</strong>ï¼šäº†è§£å­—èŠ‚ç çš„å®‰å…¨æ€§ï¼Œä¿æŠ¤ä»£ç </li></ol><h4>å…³é”®è¦ç‚¹</h4><ul><li><strong>å­—èŠ‚ç æ˜¯ä¸­é—´è¡¨ç¤º</strong>ï¼šå­—èŠ‚ç æ˜¯Pythonä»£ç çš„ä¸­é—´è¡¨ç¤ºï¼Œä»‹äºæºä»£ç å’Œæœºå™¨ç ä¹‹é—´</li><li><strong>è™šæ‹Ÿæœºæ‰§è¡Œå­—èŠ‚ç </strong>ï¼šPythonè™šæ‹Ÿæœºè§£é‡Šæ‰§è¡Œå­—èŠ‚ç </li><li><strong>å¸§å¯¹è±¡æ˜¯æ‰§è¡Œç¯å¢ƒ</strong>ï¼šæ¯ä¸ªå‡½æ•°è°ƒç”¨éƒ½æœ‰ä¸€ä¸ªå¸§å¯¹è±¡ï¼ŒåŒ…å«æ‰§è¡Œç¯å¢ƒ</li><li><strong>å­—èŠ‚ç å¯ä»¥ä¼˜åŒ–</strong>ï¼šé€šè¿‡åˆ†æå­—èŠ‚ç ï¼Œå¯ä»¥ä¼˜åŒ–ä»£ç æ€§èƒ½</li><li><strong>å­—èŠ‚ç å¯ä»¥æ“ä½œ</strong>ï¼šå¯ä»¥åŠ¨æ€ç”Ÿæˆå’Œä¿®æ”¹å­—èŠ‚ç </li></ul><h4>æœªæ¥å‘å±•</h4><p>Pythonçš„è§£é‡Šå™¨å’Œå­—èŠ‚ç æœºåˆ¶åœ¨ä¸æ–­å‘å±•ï¼š</p><ul><li><strong>PyPyçš„æ™®åŠ</strong>ï¼šPyPyçš„JITç¼–è¯‘æŠ€æœ¯æä¾›æ›´é«˜çš„æ€§èƒ½</li><li><strong>Numbaçš„åº”ç”¨</strong>ï¼šNumbaä¸ºæ•°å€¼è®¡ç®—æä¾›å³æ—¶ç¼–è¯‘</li><li><strong>Cythonçš„ä½¿ç”¨</strong>ï¼šCythonå°†Pythonä»£ç ç¼–è¯‘ä¸ºCä»£ç ï¼Œæé«˜æ€§èƒ½</li><li><strong>WebAssemblyçš„æ”¯æŒ</strong>ï¼šPythonæ­£åœ¨æ¢ç´¢WebAssemblyçš„æ”¯æŒ</li></ul><p>é€šè¿‡æ·±å…¥ç†è§£Pythonçš„å­—èŠ‚ç æ‰§è¡Œæœºåˆ¶å’Œè§£é‡Šå™¨åŸç†ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°æŒæ¡Pythonçš„å·¥ä½œåŸç†ï¼Œç¼–å†™æ›´é«˜æ•ˆã€æ›´å®‰å…¨çš„Pythonä»£ç ï¼Œç”šè‡³å¯ä»¥ä¸ºPythonçš„å‘å±•åšå‡ºè´¡çŒ®ã€‚</p>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹æ¦œå•å‘¨æŠ¥ï¼ˆ2026/01/31ï¼‰ KAIæ™ºä¹  ]]></title>    <link>https://segmentfault.com/a/1190000047584551</link>    <guid>https://segmentfault.com/a/1190000047584551</guid>    <pubDate>2026-02-01 00:07:40</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h3>1. æœ¬å‘¨æ¦‚è§ˆ</h3><p>æœ¬å‘¨å¤§æ¨¡å‹è¡Œä¸šè¿æ¥å¤šé¡¹é‡è¦è¿›å±•ï¼Œç™¾åº¦æ–‡å¿ƒ5.0æ­£å¼å‘å¸ƒï¼Œé€šä¹‰åƒé—®å¼€æºQwen3-TTSè¯­éŸ³æ¨¡å‹ï¼ŒKimiå‘å¸ƒå¹¶å¼€æºK2.5æ¨¡å‹ã€‚æ¦œå•æ–¹é¢å˜åŒ–å‰§çƒˆï¼ŒMiMo V2 Flash (free)é­é‡æ–­å´–å¼ä¸‹è·Œï¼ŒDeepSeek V3.2å¼ºåŠ¿è·ƒå‡ï¼Œç¼–ç¨‹é¢†åŸŸç«äº‰æ ¼å±€å‘ç”Ÿé‡å¤§å˜åŒ–ï¼ŒGrok Code Fast 1é¢†å…ˆä¼˜åŠ¿èç¼©ï¼Œæ–°æ¨¡å‹Kimi K2.5å¼ºåŠ¿é—¯å…¥å‰äº”ã€‚</p><h3>2. é‡ç‚¹å…³æ³¨äº‹ä»¶</h3><ul><li>ç™¾åº¦äº1.24æ—¥æ­£å¼å‘å¸ƒæ–‡å¿ƒ5.0ï¼Œæ­è½½2.4ä¸‡äº¿å‚æ•°åŸç”Ÿå…¨æ¨¡æ€æ¶æ„ï¼Œåœ¨40ä½™é¡¹åŸºå‡†æµ‹è¯•ä¸­é¢†è·‘å›½é™…ç¬¬ä¸€æ¢¯é˜Ÿï¼Œè¢«ç§°ä¸º"æœ€å¼ºæ–‡ç§‘ç”Ÿ"</li><li>é€šä¹‰åƒé—®äº1.26å¼€æºQwen3-TTSå…¨ç³»åˆ—è¯­éŸ³æ¨¡å‹ï¼Œæ”¯æŒ3ç§’å…‹éš†ä¸éŸ³è‰²åˆ›é€ ï¼Œå»¶è¿Ÿä½è‡³97msï¼Œå¼€æº1.7Bï¼ˆæè‡´æ€§èƒ½ï¼‰å’Œ0.6Bï¼ˆè½»é‡é«˜æ•ˆï¼‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œæ»¡è¶³ä»äº‘ç«¯åˆ°è¾¹ç¼˜çš„å¤šæ ·åŒ–éƒ¨ç½²éœ€æ±‚ï¼›åŒæ—¶Qwen3-Max-Thinkingä¸Šçº¿ï¼Œå¼•å…¥è‡ªé€‚åº”å·¥å…·è°ƒç”¨ä¸æµ‹è¯•æ—¶æ‰©å±•æŠ€æœ¯ä¸¤å¤§æ ¸å¿ƒåˆ›æ–°</li><li>DeepSeekäº1.27æ›´æ–°OCRæ¨¡å‹ï¼ŒDeepSeek-OCR 2é€šè¿‡å¼•å…¥DeepEncoder V2æ¶æ„ï¼Œå®ç°è§†è§‰ç¼–ç ä»ã€Œå›ºå®šæ‰«æã€å‘ã€Œè¯­ä¹‰æ¨ç†ã€çš„èŒƒå¼è½¬å˜ï¼Œå°†åŸæœ¬åŸºäºCLIPçš„ç¼–ç å™¨æ›¿æ¢ä¸ºè½»é‡çº§è¯­è¨€æ¨¡å‹ï¼ˆQwen2-500Mï¼‰ï¼Œå¹¶å¼•å…¥å…·æœ‰å› æœæ³¨æ„åŠ›æœºåˆ¶çš„ã€Œå› æœæµæŸ¥è¯¢ã€</li><li>Kimiäº1.27å‘å¸ƒå¹¶å¼€æºK2.5æ¨¡å‹ï¼Œè¯¥æ¨¡å‹ä¸ºåŸç”Ÿå¤šæ¨¡æ€æ¶æ„è®¾è®¡ï¼Œæ”¯æŒæœ€é«˜256,000 tokensçš„æ ‡å‡†ä¸Šä¸‹æ–‡é•¿åº¦ï¼Œæ”¯æŒè§†è§‰ä¸æ–‡æœ¬è¾“å…¥ã€æ€è€ƒä¸éæ€è€ƒæ¨¡å¼ã€å¯¹è¯ä¸Agentä»»åŠ¡ï¼Œå¹¶è¿›ä¸€æ­¥æå‡å¼€æºæ¨¡å‹çš„ä»£ç æ°´å¹³ï¼Œå°¤å…¶åœ¨å‰ç«¯å¼€å‘é¢†åŸŸè¡¨ç°çªå‡º</li><li>MiniMaxäº1.29å‘å¸ƒMiniMax Music 2.5ï¼Œåœ¨ã€Œæ®µè½çº§å¼ºæ§åˆ¶ã€ä¸ã€Œç‰©ç†çº§é«˜ä¿çœŸã€ä¸¤å¤§æŠ€æœ¯éš¾é¢˜ä¸Šå®ç°çªç ´ï¼Œè¾…ä»¥åè¯­ä¼˜åŒ–åŠä¸“ä¸šæ··éŸ³ï¼Œè®©æ ¼è±ç¾çº§éŸ³ä¹åˆ›ä½œæ— éœ€å½•éŸ³æ£šå³å¯å®ç°</li></ul><h3>3. æ¦œå•å˜åŒ–</h3><ul><li>OpenRouteræ•´ä½“æ¨¡å‹è°ƒç”¨é‡æ–¹é¢ï¼ŒMiMo V2 Flash (free)é­é‡æ–­å´–å¼ä¸‹è·Œï¼Œè°ƒç”¨é‡ä»582B tokenséª¤é™è‡³280Bï¼Œæ’åç”±ç¬¬2æ»‘è½è‡³ç¬¬9ï¼Œå‘¨å¢é•¿ç‡ä»+18%è½¬ä¸º-52%ï¼›DeepSeek V3.2å®ç°å¼ºåŠ¿è·ƒå‡ï¼Œè°ƒç”¨é‡ä»364Bå¢è‡³464Bï¼Œæ’åä»ç¬¬7å‡è‡³ç¬¬4ï¼Œå‘¨å¢é•¿ç‡ç”±4%å¤§å¹…æå‡è‡³27%ï¼›Claude Opus 4.5ç”±é«˜é€Ÿå¢é•¿è½¬ä¸ºæ˜æ˜¾å›è°ƒï¼Œè°ƒç”¨é‡ä»395Bé™è‡³339Bï¼Œå‘¨å¢é•¿ç‡ä»+35%è½¬ä¸º-14%ï¼›Gemini 2.5 Proè·Œå‡ºå‰åæ¦œå•ï¼Œå…¶ä¸Šå‘¨413Bçš„è°ƒç”¨é‡æœ¬å‘¨è¢«gpt-oss-120bä»¥272Bè¿›å…¥å‰åå–ä»£ï¼›Gemini 2.5 Flashç¨³æ­¥å¤è‹ï¼Œæ’åä»ç¬¬8ä¸Šå‡è‡³ç¬¬5ï¼Œè°ƒç”¨é‡ä»364Bå¢è‡³394Bï¼Œå‘¨å¢é•¿ç‡ç”±-3%è½¬æ­£ä¸º+8%</li><li>OpenRouteræ¨¡å‹å¸‚å ç‡æ–¹é¢ï¼ŒDeepSeekè°ƒç”¨é‡ä»ä¸Šå‘¨457Bå¢è‡³æœ¬å‘¨553Bï¼Œå¸‚åœºå æ¯”ç”±8.0%æå‡è‡³9.4%ï¼›Googleä¸»å¯¼åœ°ä½ç•¥æœ‰å‰Šå¼±ï¼Œè°ƒç”¨é‡ä»1.48Té™è‡³1.4Tï¼Œå æ¯”ç”±26.0%ä¸‹æ»‘è‡³24.0%ï¼›Xiaomié­é‡æ–­å´–å¼ä¸‹è·Œï¼Œä»ç¬¬6åï¼ˆ441Bï¼Œ7.8%ï¼‰ç›´æ¥è·Œå‡ºå‰åæ¦œå•ï¼›MoonshotAIå¼ºåŠ¿å…¥å±€ï¼Œæ–°è¿›å‰åå¹¶ç›´æ¥å æ®ç¬¬7ä½ï¼Œè·å¾—203Bè°ƒç”¨é‡ï¼ˆ3.5%ä»½é¢ï¼‰ï¼›é•¿å°¾å¸‚åœºçˆ†å‘å¼å¢é•¿ï¼ŒOthersç±»åˆ«è°ƒç”¨é‡ä»349Bæ¿€å¢è‡³598Bï¼Œå æ¯”ç”±6.1%é£™å‡è‡³10.2%</li><li>OpenRouteræ¨¡å‹ååé‡æ–¹é¢ï¼ŒGPT-OSS-120Bï¼ˆGroqæä¾›ï¼‰å…·æœ‰è¶…å¼ºç»Ÿæ²»åŠ›ï¼Œä½“ç°åœ¨é€Ÿåº¦å¤Ÿå¿«+æˆæœ¬å¯æ§+è§„æ¨¡åŒ–éªŒè¯ï¼Œé€Ÿåº¦ç¬¬2ï¼ˆ936 tok/sï¼‰ï¼Œæˆæœ¬é€‚ä¸­ï¼ˆ$0.35/Mï¼‰ï¼Œè¯·æ±‚é‡æœ€é«˜ï¼Œå¯èƒ½æ˜¯å½“å‰æœ€ä¸»æµçš„ç”Ÿäº§ç¯å¢ƒé€‰æ‹©ï¼›Qwen3 32Bï¼ˆCerebrasæä¾›ï¼‰å´›èµ·ï¼Œé€Ÿåº¦ç¬¬3ï¼ˆ736 tok/sï¼‰ï¼Œåœ†ç‚¹ç¬¬äºŒå¤§ï¼Œæ˜¾ç¤ºå›½äº§æ¨¡å‹å¯èƒ½åœ¨å›½é™…å¼€å‘è€…å·¥å…·é“¾ä¸­å·²å æ ¸å¿ƒä½ç½®</li><li>OpenRouterç¼–ç¨‹è°ƒç”¨é‡æ–¹é¢ï¼ŒGrok Code Fast 1é¢†å…ˆä¼˜åŠ¿æ€¥å‰§èç¼©ï¼Œè°ƒç”¨é‡å æ¯”ç”±22.8%å¤§å¹…ä¸‹æ»‘è‡³16.4%ï¼›MiniMax M2.1å®ç°è·¨è¶Šå¼å¢é•¿ï¼Œè°ƒç”¨é‡ä»56.8Bç¿»å€è‡³115Bï¼Œå æ¯”ç”±4.0%å¤§å¹…æå‡è‡³7.4%ï¼›Kimi K2.5å¼ºåŠ¿é—¯å…¥å‰äº”ï¼Œä»¥139B tokenså’Œ8.9%å æ¯”æ–°æ™‹æ¦œå•ç¬¬4ä½ï¼›GPT-5ç³»åˆ—åŒæ¨¡å‹é‡å›å‰åï¼ŒGPT-5.2ä¸GPT-5.2-Codexåˆ†åˆ«ä»¥61.4Bå’Œ54.5B tokensè°ƒç”¨é‡å æ®ç¬¬8ã€ç¬¬9ä½ï¼›ä¸Šå‘¨ä¸‰å¤§çƒ­é—¨æ¨¡å‹é›†ä½“è·Œå‡ºå‰åï¼ŒMiMo V2 Flash (free)ã€Devstral 2 2512 (free)ä¸DeepSeek V3.2åˆ†åˆ«ä»ä¸Šå‘¨ç¬¬5ã€ç¬¬7ã€ç¬¬9ä½æ»‘è½è‡³ååä¹‹å¤–</li><li>å›¾åƒç¼–è¾‘èƒ½åŠ›æ¦œå•ï¼ˆText to Image Arenaï¼‰ï¼šhunyuan-image-3.0-instructæ–°ä¸Šæ¦œå•ï¼Œè¯„åˆ†åŸºäºé¢„å‘å¸ƒæµ‹è¯•ï¼Œå¯èƒ½ä¼šéšç€å…¬å¼€å‘å¸ƒåç¤¾åŒºåé¦ˆå’ŒæŠ•ç¥¨çš„å˜åŒ–è€Œè°ƒæ•´</li><li>å›¾åƒç¼–è¾‘èƒ½åŠ›æ¦œå•ï¼ˆArtificial Analysis Image Editing Leaderboardï¼‰ï¼šReve V1åˆ†æ•°è¶…è¿‡FLUX.2 [pro]ï¼ŒäºŒè€…æ’åæ˜“ä½ï¼Œåˆ†åˆ«æ’å8ã€9</li><li>æ–‡ç”Ÿå›¾èƒ½åŠ›æ¦œå•ï¼ˆArtificial Analysis Text to Image Leaderboardï¼‰ï¼šFLUX.2 [dev] Turboåˆ†æ•°è¶…è¿‡ImagineArt 1.5 Previewï¼ŒäºŒè€…æ’åæ˜“ä½ï¼Œåˆ†åˆ«æ’å10ã€11</li><li>GAIAæ¦œå•ï¼šShawn Agentæ›´æ–°v3.1ï¼Œæ’åç¬¬7ï¼Œå¾—åˆ†è¾¾89.37%</li></ul><h3>4. æ’è¡Œæ¦œ</h3><table><thead><tr><th>æµ‹è¯„ç±»å‹</th><th>ç¬¬ä¸€å</th><th>ç¬¬äºŒå</th><th>ç¬¬ä¸‰å</th></tr></thead><tbody><tr><td>æ¨¡å‹è°ƒç”¨é‡</td><td>Claude Sonnet 4.5</td><td>Gemini 3 Flash Preview</td><td>Grok Code Fast 1</td></tr><tr><td>å…¬å¸å¸‚å ç‡</td><td>Google</td><td>Anthropic</td><td>OpenAI</td></tr><tr><td>æ¨¡å‹é€Ÿåº¦</td><td>gpt-oss-safeguard-20b</td><td>gpt-oss-120b</td><td>Qwen3 32B</td></tr><tr><td>ç¼–ç¨‹æ¨¡å‹è°ƒç”¨é‡</td><td>Grok Code Fast 1</td><td>Claude Sonnet 4.5</td><td>Claude Opus 4.5</td></tr></tbody></table><h4>å„å…¬å¸æŒ‰ä¸åŒèƒ½åŠ›é¢†åŸŸæ’åæ±‡æ€»</h4><table><thead><tr><th>æµ‹è¯„ç±»å‹</th><th>é¢†å…ˆå…¬å¸</th></tr></thead><tbody><tr><td>å¤§è¯­è¨€æ¨¡å‹ Text Arena</td><td>Googleã€xAIã€Anthropicã€ç™¾åº¦ã€OpenAIã€æ™ºè°±ã€é˜¿é‡Œå·´å·´ã€æœˆä¹‹æš—é¢</td></tr><tr><td>ç¼–ç¨‹èƒ½åŠ› Code Arena</td><td>Anthropicã€OpenAIã€Googleã€æ™ºè°±ã€MiniMax</td></tr><tr><td>ç¼–ç¨‹èƒ½åŠ› LiveCodeBench</td><td>OpenAIã€Anthropicã€Google</td></tr><tr><td>ä»£ç å·¥ç¨‹ä»»åŠ¡èƒ½åŠ› SWE-benchLite</td><td>åŸºäºClaudeã€Geminiã€GPTã€Qwenã€DeepSeekå¼€å‘çš„å¼€æºç³»ç»Ÿ</td></tr><tr><td>å›¾åƒç¼–è¾‘å’Œç”Ÿæˆèƒ½åŠ› Image Edit Arena</td><td>OpenAIã€Googleã€å­—èŠ‚ã€è…¾è®¯ã€Black Forest Labsã€Reve</td></tr><tr><td>æ–‡ç”Ÿå›¾èƒ½åŠ› Text-to-Image Arena</td><td>OpenAIã€Googleã€Black Forest Labsã€è…¾è®¯</td></tr><tr><td>å›¾åƒç¼–è¾‘å’Œç”Ÿæˆèƒ½åŠ› Image Editing Leaderboard</td><td>OpenAIã€Googleã€å­—èŠ‚ã€Black Forest Labsã€é˜¿é‡Œå·´å·´ã€Reve</td></tr><tr><td>æ–‡ç”Ÿå›¾èƒ½åŠ› Text to Image Leaderboard</td><td>OpenAIã€Googleã€Black Forest Labsã€å­—èŠ‚ã€Fal</td></tr><tr><td>GPQA</td><td>OpenAIã€Googleã€xAIã€Anthropicã€é˜¿é‡Œå·´å·´</td></tr><tr><td>FrontierMath</td><td>OpenAIã€Googleã€DeepSeekã€æœˆä¹‹æš—é¢ã€Anthropicã€xAI</td></tr><tr><td>Humanity's Last Exam</td><td>Googleã€OpenAIã€Anthropic</td></tr><tr><td>GAIA</td><td>JoinAIã€Nvidiaã€Suzhou AI Lab&amp;Shuqian Techã€Microsoft AI Asia -Adsã€LR AILab of Lenovo CTO Orgã€ShawnAgentã€ZTE-AICloudã€LR AILabç­‰</td></tr></tbody></table><hr/><p>å…³æ³¨æˆ‘ï¼Œç¬¬ä¸€æ—¶é—´æŒæ¡æ›´å¤šAIå‰æ²¿èµ„è®¯ï¼</p>]]></description></item><item>    <title><![CDATA[Flowise ä¸ n8n çš„å·®å¼‚è§£æï¼šAI ä»£ç†è‡ªåŠ¨åŒ–å·¥å…·çš„çœŸå®é€‰æ‹©é€»è¾‘ IPPeak ]]></title>    <link>https://segmentfault.com/a/1190000047584593</link>    <guid>https://segmentfault.com/a/1190000047584593</guid>    <pubDate>2026-02-01 00:06:39</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>AI è‡ªåŠ¨åŒ–å·¥å…·çš„å‘å±•ï¼Œæ­£åœ¨ç»å†ä¸€æ¬¡ç»“æ„æ€§è½¬å˜ã€‚æ—©æœŸè‡ªåŠ¨åŒ–æ›´å¤šå›´ç»•å›ºå®šè§„åˆ™å±•å¼€ï¼Œè€Œå¦‚ä»Šï¼Œè¶Šæ¥è¶Šå¤šç³»ç»Ÿå¼€å§‹å¼•å…¥å…·å¤‡å†³ç­–èƒ½åŠ›çš„ AI ä»£ç†ã€‚è¿™ç§å˜åŒ–ï¼Œä½¿å¾—å·¥å…·ä¹‹é—´çš„å·®å¼‚ä¸å†ä½“ç°åœ¨åŠŸèƒ½å¤šå°‘ï¼Œè€Œä½“ç°åœ¨è®¾è®¡å“²å­¦æœ¬èº«ã€‚<br/>Flowise ä¸ n8nï¼Œæ­£å¥½ä»£è¡¨äº†è¿™ä¸¤ç§ä¸åŒæ¼”è¿›è·¯å¾„ã€‚</p><h2>Flowise èƒŒåçš„ä»£ç†æ€ç»´</h2><p>Flowise çš„æ ¸å¿ƒé€»è¾‘ï¼Œå¹¶ä¸æ˜¯â€œæŠŠäº‹æƒ…è‡ªåŠ¨åšå®Œâ€ï¼Œè€Œæ˜¯è®©æ¨¡å‹å‚ä¸åˆ¤æ–­è¿‡ç¨‹ã€‚å®ƒå¼ºè°ƒä¸Šä¸‹æ–‡çš„è¿ç»­æ€§ã€å†³ç­–çš„å¯è§£é‡Šæ€§ä»¥åŠå¤šæ­¥éª¤æ¨ç†çš„èƒ½åŠ›ã€‚<br/>åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒFlowise æ›´é€‚åˆé‚£äº›éœ€è¦æ¨¡å‹åå¤å‚ä¸ã€åŠ¨æ€è°ƒæ•´å†³ç­–çš„åœºæ™¯ã€‚è¿™ç±»ç³»ç»Ÿå¾€å¾€ä¸æ˜¯ä¸€æ¬¡æ€§æµç¨‹ï¼Œè€Œæ˜¯æŒç»­è¿è¡Œçš„æ™ºèƒ½ä½“ã€‚</p><h2>n8n å¯¹ç¨³å®šæ€§çš„é•¿æœŸè¿½æ±‚</h2><p>n8n çš„è®¾è®¡æ›´åå‘å·¥ç¨‹è§†è§’ã€‚å®ƒå…³æ³¨çš„æ˜¯æµç¨‹æ˜¯å¦å¯ç»´æŠ¤ã€æ˜¯å¦å¯å¤ç°ï¼Œä»¥åŠåœ¨å¤æ‚ç³»ç»Ÿä¸­æ˜¯å¦è¶³å¤Ÿç¨³å®šã€‚<br/>è¿™ç§è®¾è®¡ä½¿ n8n åœ¨ä¼ä¸šè‡ªåŠ¨åŒ–åœºæ™¯ä¸­æ‹¥æœ‰å¾ˆå¼ºçš„é€‚åº”èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦é•¿æœŸè¿è¡Œã€è·¨ç³»ç»Ÿåä½œçš„ä»»åŠ¡ä¸­ï¼Œå…¶ä¼˜åŠ¿éå¸¸æ˜æ˜¾ã€‚</p><h2>ä¸¤ç§å·¥å…·çš„è¾¹ç•Œå¹¶ä¸å†²çª</h2><p>åœ¨å®è·µä¸­ï¼ŒFlowise ä¸ n8n å¾€å¾€å¹¶ä¸æ˜¯äºŒé€‰ä¸€å…³ç³»ã€‚ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œå¯èƒ½ç”± Flowise è´Ÿè´£æ™ºèƒ½åˆ¤æ–­ï¼Œè€Œç”± n8n æ‰¿æ‹…æµç¨‹æ‰§è¡Œã€‚<br/>ç†è§£è¿™ä¸€ç‚¹ï¼Œæœ‰åŠ©äºé¿å…é™·å…¥ç®€å•çš„â€œè°æ›´å¼ºâ€è®¨è®ºï¼Œè€Œæ˜¯ä»æ¶æ„å±‚é¢åšå‡ºæ›´åˆç†çš„é€‰æ‹©ã€‚</p><h2>AI è‡ªåŠ¨åŒ–å¯¹ç½‘ç»œç¯å¢ƒçš„çœŸå®ä¾èµ–</h2><p>æ— è®ºæ˜¯ Flowise è¿˜æ˜¯ n8nï¼Œåº•å±‚éƒ½ä¾èµ–å¤–éƒ¨ APIã€æ¨¡å‹æœåŠ¡ä»¥åŠæ•°æ®æ¥å£ã€‚è¿™äº›è°ƒç”¨å¯¹ç½‘ç»œè´¨é‡æä¸ºæ•æ„Ÿã€‚<br/>ä¸ç¨³å®šçš„è®¿é—®æ¥æºï¼Œå¯èƒ½å¯¼è‡´è¯·æ±‚å¤±è´¥ã€æ¥å£é™æµç”šè‡³è´¦å·é£æ§ï¼Œä»è€Œç ´åæ•´ä¸ªè‡ªåŠ¨åŒ–é“¾è·¯ã€‚è¿™ç±»é—®é¢˜ï¼Œå¾€å¾€å¹¶éå·¥å…·æœ¬èº«é€ æˆï¼Œè€Œæ˜¯åŸºç¡€è®¾æ–½ä¸è¶³ã€‚</p><h2>ç¨³å®šä»£ç†åœ¨ AI ç³»ç»Ÿä¸­çš„éšæ€§ä»·å€¼</h2><p>åœ¨è¿™ç§èƒŒæ™¯ä¸‹ï¼Œå…·å¤‡çœŸå®ç½‘ç»œå±æ€§çš„ä»£ç†ï¼Œæˆä¸ºä¿éšœç³»ç»Ÿç¨³å®šè¿è¡Œçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚IPPeak çš„é«˜åŒ¿åä½å®…ä»£ç†ï¼Œèƒ½å¤Ÿä¸º AI è‡ªåŠ¨åŒ–å·¥å…·æä¾›å¯ä¿¡å‡ºå£ï¼Œä½¿å¤–éƒ¨è°ƒç”¨æ›´æ¥è¿‘æ­£å¸¸ç”¨æˆ·æˆ–ä¼ä¸šè®¿é—®è¡Œä¸ºã€‚IPPeakä¸AIå·¥å…·å®Œç¾ç»“åˆï¼Œå‘æŒ¥ç€é‡è¦çš„ä½œç”¨ã€‚IPPeakæä¾›8000ä¸‡ä½å®…IPï¼Œæ”¯æŒå¤šç§å¥—é¤ç±»å‹ï¼Œæä¾›å¤šç§é€‰æ‹©æœºä¼šã€‚<br/>è¿™ç§ç¨³å®šæ€§ï¼Œå¹¶ä¸ä¼šä½“ç°åœ¨ç•Œé¢ä¸Šï¼Œå´ç›´æ¥å†³å®šç³»ç»Ÿæ˜¯å¦èƒ½å¤Ÿé•¿æœŸè¿è¡Œã€‚</p><h2>è‡ªåŠ¨åŒ–ç³»ç»Ÿçš„å®Œæ•´è§†è§’</h2><p>çœŸæ­£æˆç†Ÿçš„ AI è‡ªåŠ¨åŒ–ç³»ç»Ÿï¼Œä¸åªä¾èµ–å·¥å…·æœ¬èº«çš„èƒ½åŠ›ï¼Œè¿˜ä¾èµ–ç½‘ç»œã€èº«ä»½ä¸è®¿é—®ç¯å¢ƒçš„æ•´ä½“å¯é æ€§ã€‚åªæœ‰å½“è¿™äº›åŸºç¡€æ¡ä»¶ç¨³å®šï¼ŒFlowise æˆ– n8n çš„ä»·å€¼æ‰èƒ½è¢«å……åˆ†é‡Šæ”¾ã€‚</p>]]></description></item><item>    <title><![CDATA[æ˜‡è…¾AIåˆ›æ–°å¤§èµ›-æ˜‡æ€æ¨¡å‹å¼€å‘æŒ‘æˆ˜èµ›ï¼ˆS1èµ›å­£ï¼‰-MultiModalèµ›é“é“œå¥–æ–¹æ¡ˆ sktier ]]></title>    <link>https://segmentfault.com/a/1190000047584769</link>    <guid>https://segmentfault.com/a/1190000047584769</guid>    <pubDate>2026-02-01 00:05:44</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>MindNLP æ¨¡å‹ä¼˜åŒ– (Qwen2-VL &amp; janus_pro)<br/>æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•äº†é’ˆå¯¹ Qwen2-VL å’Œ janus_pro æ¨¡å‹çš„å…³é”®æ€§èƒ½ä¼˜åŒ–ç‚¹ï¼Œå¹¶é™„å¸¦äº†ç›¸åº”çš„æ ¸å¿ƒä»£ç å®ç°ã€‚</p><p>å®˜æ–¹èµ›äº‹ä»£ç ä»“ï¼Œä¸ªäººä»£ç ä»“</p><p>ä¸€ã€Qwen2-VL æ¨¡å‹ä¼˜åŒ–<br/>1ã€ä½¿ç”¨èåˆç®—å­<br/>â‘  RoPEï¼šmindspore.ops.rotary_position_embedding<br/>ä¿®æ”¹å‰ï¼š</p><p>mrope_section = mrope_section * 2<br/>cos = ops.cat([m[i % 3] for i, m in enumerate(ops.split(cos, mrope_section, dim=-1))], dim=-1).unsqueeze(unsqueeze_dim)<br/>sin = ops.cat([m[i % 3] for i, m in enumerate(ops.split(sin, mrope_section, dim=-1))], dim=-1).unsqueeze(unsqueeze_dim)<br/>q_embed = (q <em> cos) + (rotate_half(q) </em> sin)<br/>k_embed = (k <em> cos) + (rotate_half(k) </em> sin)<br/>å¤åˆ¶<br/>ä¿®æ”¹åï¼š</p><p>q_embed = mindspore.ops.rotary_position_embedding(q, cos, sin)<br/>k_embed = mindspore.ops.rotary_position_embedding(k, cos, sin)<br/>å¤åˆ¶<br/>â‘¡ RMSNormï¼šmindnlp.core.nn.rms_norm<br/>ä¿®æ”¹å‰ï¼š</p><p>input_dtype = hidden_states.dtype<br/>hidden_states = hidden_states.to(mindspore.float32)<br/>variance = ops.mean(hidden_states.pow(2), -1, keepdim=True)<br/>hidden_states = hidden_states * ops.rsqrt(variance + self.variance_epsilon)<br/>return self.weight * hidden_states.to(input_dtype)<br/>å¤åˆ¶<br/>ä¿®æ”¹åï¼š</p><p>return F.rms_norm(hidden_states, self.weight, self.variance_epsilon)<br/>å¤åˆ¶<br/>â‘¢ FlashAttention<br/>åœ¨ VisionAttention ä¸­ï¼Œä½¿ç”¨ mindspore.ops.flash_attention_scoreï¼Œéœ€è¦å¯¹ qk å…ˆè¿›è¡Œ scaleï¼Œ$\frac{q}{\sqrt{\sqrt{d}}}$ï¼Œ $\frac{k}{\sqrt{\sqrt{d}}}$ï¼Œç„¶åè®¡ç®— flash_attention æ—¶ scale è®¾ä¸ºé»˜è®¤ 1.0ï¼Œå¦åˆ™ç²¾åº¦ä¸å¯¹é½ï¼ˆæ„Ÿè§‰å¯èƒ½è·Ÿå¤§ç®—å­åº•å±‚çš„è®¡ç®—é¡ºåºæœ‰å…³ç³»ï¼Œä½†è¿™ä¸ªæ–¹æ³•åªåœ¨è¿™é‡Œæœ‰ç”¨ï¼Œè¿åˆ° janus_pro æ¨¡å‹è¿˜æ˜¯ mismatchï¼‰<br/>self.scalar_value = 1 / math.sqrt(math.sqrt(self.head_dim))<br/>seq_length = hidden_states.shape[0]<br/>q, k, v = self.qkv(hidden_states).reshape(seq_length, 3, self.num_heads, -1).permute(1, 0, 2, 3).unbind(0)<br/>q = apply_rotary_pos_emb_vision(q.unsqueeze(0), rotary_pos_emb) * self.scalar_value<br/>k = apply_rotary_pos_emb_vision(k.unsqueeze(0), rotary_pos_emb) * self.scalar_value<br/>attn_output = mindspore.ops.flash_attention_score(q, k, v.unsqueeze(0), self.num_heads, input_layout='BSND')<br/>attn_output = attn_output.reshape(seq_length, -1)<br/>attn_output = self.proj(attn_output)<br/>å¤åˆ¶<br/>åœ¨ Qwen2VLAttention ä¸­ï¼Œprefill é˜¶æ®µï¼Œä½¿ç”¨ mindspore.ops.fused_infer_attention_scoreï¼Œdecoderé˜¶æ®µä¿æŒåŸæ¥çš„è®¡ç®—ï¼Œå…¨éƒ¨ä½¿ç”¨ flash_attention ä¼šå¯¼è‡´ç²¾åº¦ä¸å¯¹é½<br/>if query_states.shape[-2] != 1:  # åˆ¤å®š prefill é˜¶æ®µè¿˜æ˜¯ decoder é˜¶æ®µ</p><pre><code>attn_mask = (attention_mask != 0).to(dtype=mindspore.uint8)
attn_output = mindspore.ops.fused_infer_attention_score(query_states*self.scalar_value, key_states*self.scalar_value, value_states, num_key_value_heads=self.num_key_value_heads, num_heads=self.num_heads, input_layout='BNSD', atten_mask=attn_mask)[0]
</code></pre><p>else:</p><pre><code>key_states = repeat_kv(key_states, self.num_key_value_groups)
value_states = repeat_kv(value_states, self.num_key_value_groups)
attn_weights = ops.matmul(query_states, mint.permute(key_states, (0, 1, 3, 2))) / self.head_dim_sqrt
attn_weights = nn.functional.softmax(attn_weights, dim=-1, dtype=mindspore.bfloat16)
attn_weights = nn.functional.dropout(attn_weights, p=self.attention_dropout, training=self.training)
attn_output = ops.matmul(attn_weights, value_states)</code></pre><p>å¤åˆ¶<br/>2ã€mint ç®—å­æ›¿æ¢<br/>â‘  nn.Conv3d æ”¹ç”¨ mindspore.mint.Conv3Dï¼Œéœ€è¦è¿›è¡Œæƒé‡è½¬æ¢<br/>ä¿®æ”¹å‰ï¼š</p><p>self.proj = nn.Conv3d(in_channels, embed_dim, kernel_size=kernel_size, stride=kernel_size, bias=False)<br/>å¤åˆ¶<br/>ä¿®æ”¹åï¼š</p><p>self.proj = mint.nn.Conv3d(in_channels, embed_dim, kernel_size=kernel_size, stride=kernel_size, bias=False, dtype=mindspore.bfloat16)<br/>å¤åˆ¶<br/>â‘¡ .swapaxes æ”¹ç”¨ mindspore.mint.permute<br/>3ã€æ—‹è½¬ä½ç½®ç¼–ç ä¼˜åŒ–<br/>é¢„è®¡ç®— sin / cos è¡¨ï¼Œé¿å…åœ¨å‰å‘ä¼ æ’­ä¸­é‡å¤è®¡ç®—</p><p>4ã€å…¶å®ƒæ”¹è¿›<br/>â‘  Qwen2VLAttention çš„ q_projã€k_projã€v_proj åˆæˆä¸€ä¸ª w_qkv<br/>ä¿®æ”¹å‰ï¼š</p><p>def __intit__():</p><pre><code>self.q_proj = nn.Linear(self.hidden_size, self.num_heads * self.head_dim, bias=True)
self.k_proj = nn.Linear(self.hidden_size, self.num_key_value_heads * self.head_dim, bias=True)
self.v_proj = nn.Linear(self.hidden_size, self.num_key_value_heads * self.head_dim, bias=True)
</code></pre><p>def forward():</p><pre><code>query_states = self.q_proj(hidden_states)
key_states = self.k_proj(hidden_states)
value_states = self.v_proj(hidden_states)</code></pre><p>å¤åˆ¶<br/>ä¿®æ”¹åï¼š</p><p>def __intit__():</p><pre><code>self.w_qkv = nn.Linear(self.hidden_size, self.num_heads * self.head_dim + self.num_key_value_heads * self.head_dim * 2, bias=True)
</code></pre><p>def forward():</p><pre><code>qkv = self.w_qkv(hidden_states)
query_states, key_states, value_states = ops.split(qkv, [self.hidden_size,  self.num_key_value_heads * self.head_dim,  self.num_key_value_heads * self.head_dim], dim=2)</code></pre><p>å¤åˆ¶<br/>â‘¡ repeat_kv ä¼˜åŒ–<br/>ä¿®æ”¹å‰ï¼š</p><p>def repeat_kv(hidden_states: mindspore.Tensor, n_rep: int) -&gt; mindspore.Tensor:</p><pre><code>batch, num_key_value_heads, slen, head_dim = hidden_states.shape
if n_rep == 1:
    return hidden_states
hidden_states = hidden_states[:, :, None, :, :].broadcast_to((batch, num_key_value_heads, n_rep, slen, head_dim))
return hidden_states.reshape(batch, num_key_value_heads * n_rep, slen, head_dim)</code></pre><p>å¤åˆ¶<br/>ä¿®æ”¹åï¼š</p><p>def repeat_kv(hidden_states: mindspore.Tensor, n_rep: int) -&gt; mindspore.Tensor:</p><pre><code>return ops.repeat_interleave(hidden_states, repeats=n_rep, dim=1)</code></pre><p>å¤åˆ¶<br/>äºŒã€janus_pro æ¨¡å‹ä¼˜åŒ–<br/>1ã€æ•°æ®é¢„å¤„ç†ï¼ˆä¸»è¦çš„æ€§èƒ½ç“¶é¢ˆæ‰€åœ¨ï¼‰<br/>â‘  é‡å†™ VLChatProcessor çš„å¤„ç†é€»è¾‘<br/>åŸå§‹çš„æ–¹æ³•ä¸­å­˜åœ¨ image_token_mask = input_ids == self.image_id ä»¥åŠ batched_images_seq_mask[i, -seq_len:] = input_ids == self.image_id ç­‰ä½¿ç”¨ == é€å…ƒç´ æ¯”è¾ƒçš„æ–¹æ³•ï¼Œå¾ˆæ…¢ï¼Œå‚è€ƒ qwen2-vl çš„æ–¹æ³•å»ç”Ÿæˆ input_idsï¼Œä»¥åŠé‡å†™ images_seq_mask çš„ç”Ÿæˆé€»è¾‘ï¼Œé¿å…ä½¿ç”¨ ==</p><p>class VLChatProcessor(ProcessorMixin):</p><pre><code>def process_one():
    # æ­¤å¤„åªç»™å‡ºæ ¸å¿ƒæ”¹è¿›ä»£ç 
    tmp_sft_format = sft_format
    tmp_sft_format = tmp_sft_format.split(self.image_tag)[0]
    tmp_input_ids = self.tokenizer.encode(tmp_sft_format)
    tmp_mask_before_len = len(tmp_input_ids)
    mask = [0] * tmp_mask_before_len

    index = 0
    while self.image_tag in sft_format:
        mask += [0]
        sft_format = sft_format.replace(
            self.image_tag, self.image_start_tag+"&lt;|placeholder|&gt;"*self.num_image_tokens+self.image_end_tag, 1
        )
        mask += [1] * self.num_image_tokens
        index += 1
    sft_format = sft_format.replace("&lt;|placeholder|&gt;", self.image_tag)
    num_image_tokens = mindspore.Tensor([self.num_image_tokens] * index, mindspore.int32)

    # tokenize
    input_ids = self.tokenizer.encode(sft_format)
    tmp_mask_last_len = len(input_ids) - len(mask)
    mask += [0] * tmp_mask_last_len
    images_seq_mask = mindspore.Tensor(mask, dtype=mindspore.bool_)
    input_ids = mindspore.Tensor(input_ids, dtype=mindspore.int64)

    # ...
    return prepare, images_seq_mask</code></pre><p>å¤åˆ¶<br/>â‘¡ ä½¿ç”¨ opencv ä»£æ›¿ PIL åŠ è½½å›¾åƒ<br/>opencv è¯»å–å›¾åƒçš„é€Ÿåº¦å¤§æ¦‚æ˜¯ PIL çš„10å€å·¦å³ï¼Œä½†è¿™å—å¯¹æ•´ä½“çš„æå‡ä¸å¤§ï¼Œä¸»è¦ç“¶é¢ˆåœ¨ resizeã€rescale ç­‰æ“ä½œä¸Šã€‚</p><p>å‰æœŸå°è¯•è¿‡ä½¿ç”¨ opencv åŠ è½½å›¾åƒåï¼Œç”¨ numpy é‡å†™æ•°æ®é¢„å¤„ç†è¿‡ç¨‹ï¼Œä½†æ˜¯é‡åˆ° ms.dataset.vision.Resize çš„ BICUBIC æ’å€¼å¯¹é’ˆå¯¹ç›¸åŒæ•°æ®ä½†ä¸åŒæ ¼å¼ï¼ˆPIL å’Œ numpyï¼‰å­˜åœ¨ç²¾åº¦è¯¯å·®ï¼Œå¯¼è‡´æœ€ç»ˆ mismatchï¼Œæ²¡æ‰¾åˆ°å¥½çš„è§£å†³æ–¹æ³•ã€‚</p><p>2ã€å…¶å®ƒæ”¹è¿›ï¼ˆä¸ Qwen2-VL æ¨¡å‹ç±»ä¼¼ï¼‰<br/>â‘  ä½¿ç”¨èåˆç®—å­ F.rms_norm<br/>â‘¡ æ—‹è½¬ä½ç½®ç¼–ç ä¼˜åŒ–â€”â€”é¢„è®¡ç®— sin / cos è¡¨ï¼Œé¿å…åœ¨å‰å‘ä¼ æ’­ä¸­é‡å¤è®¡ç®—<br/>â‘¢ repeat_kv ä¼˜åŒ–<br/>â‘£ rotate_half ä¼˜åŒ–<br/>ä¿®æ”¹å‰ï¼š</p><p>def rotate_half(x):</p><pre><code>x1 = x[..., : x.shape[-1] // 2]
x2 = x[..., x.shape[-1] // 2 :]
return ops.cat((-x2, x1), dim=-1)</code></pre><p>å¤åˆ¶<br/>ä¿®æ”¹åï¼š</p><p>def rotate_half(x):</p><pre><code>x1, x2 = ops.split(x, x.shape[-1] // 2, dim=-1)
return ops.cat((-x2, x1), dim=-1)</code></pre><p>å¤åˆ¶<br/>ä¸‰ã€æœ€ç»ˆæ”¶ç›Š<br/>model_name    memory_reserved    memory_allocated    avg_prefill_latency    avg_decode_latency<br/>Qwen2-VL    6.442450944    5.672920576    0.2023613452911377    0.04043297529220581<br/>janus_pro    17.179869184    15.238398464    0.13930201530456543    0.04886315107345581<br/>å››ã€è¯„æµ‹ç»“æœ<br/>è¯„æµ‹æŒ‡æ ‡    å¹³å‡å¾—åˆ†<br/>å³°å€¼æ˜¾å­˜å¾—åˆ†    116.6667<br/>Prefillæ—¶å»¶    425.6324<br/>Decodeæ—¶å»¶å¾—åˆ†    208.4923<br/>æ€»åˆ†    250.2638</p>]]></description></item><item>    <title><![CDATA[é™æ—¶å…è´¹ï¼å¿«æ¥ç™¾åº¦æ™ºèƒ½äº‘ä¸€é”®éƒ¨ç½²OpenClaw ç™¾åº¦æ™ºèƒ½äº‘ ]]></title>    <link>https://segmentfault.com/a/1190000047584848</link>    <guid>https://segmentfault.com/a/1190000047584848</guid>    <pubDate>2026-02-01 00:04:52</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>æœ€è¿‘ï¼Œå¼€æºä¸ªäººAIä»£ç†OpenClawï¼ˆåŸClawdbotï¼‰çœŸçš„å¤ªç«äº†ï¼</p><p>1æœˆ28æ—¥ï¼Œç™¾åº¦æ™ºèƒ½äº‘å®˜å®£å®ŒæˆOpenClawå…¨å¥—é€‚é…ä¹‹åï¼Œåå°ä¸€ä¸‹å­æ¶Œè¿›æ¥ä¸å°‘é—®é¢˜ï¼š</p><p>èƒ½ä¸èƒ½ä¸€é”®éƒ¨ç½²ï¼Ÿ</p><p>è·‘åœ¨äº‘ä¸Šç¨³ä¸ç¨³ï¼Ÿ</p><p>è·Ÿåˆ«çš„å¹³å°æ¯”ï¼Œç™¾åº¦æ™ºèƒ½äº‘åˆ°åº•æœ‰å•¥ä¸ä¸€æ ·ï¼Ÿ</p><p>å¯ä»¥å‘ç°ï¼Œå¤§å®¶ä¸ä»…å…³å¿ƒâ€œOpenClawå¥½ä¸å¥½ç”¨â€ï¼Œæ›´å…³å¿ƒåœ¨ä½¿ç”¨æ—¶æ€ä¹ˆè·‘å¾—ä¹…ã€è·‘å¾—ç¨³ã€è¿˜ä¸æŠ˜è…¾ä¸ªäººç”µè„‘ã€‚ç›´æ¥åœ¨æœ¬åœ°é•¿æœŸæŒ‚OpenClawï¼Œä¸ä»…å èµ„æºï¼Œè¿˜å®¹æ˜“å¸¦æ¥æƒé™å’Œæ•°æ®é£é™©ï¼Œè®¸å¤šå¼€å‘è€…æœ‹å‹éœ€è¦ä¸€ä¸ªé è°±ã€éšå¼€éšç”¨çš„äº‘ç«¯ç¯å¢ƒã€‚</p><p>åŸºäºè¿™äº›çœŸå®åé¦ˆï¼Œç™¾åº¦æ™ºèƒ½äº‘æ­£å¼ä¸Šçº¿OpenClawä¸€é”®éƒ¨ç½²åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è½»é‡åº”ç”¨æœåŠ¡å™¨ï¼ˆLSï¼‰ï¼Œå¿«é€Ÿå®ŒæˆOpenClawçš„éƒ¨ç½²å’Œåˆå§‹åŒ–ï¼Œä¸ç”¨é…ç½®å¤æ‚ç¯å¢ƒï¼Œç®€å•å‡ æ­¥å°±èƒ½æŠŠä¸€ä½7Ã—24å°æ—¶åœ¨çº¿çš„ä¸ªäººAIåŠ©ç†è·‘èµ·æ¥ã€‚</p><p>æ›´å…³é”®çš„æ˜¯ï¼Œç™¾åº¦æ™ºèƒ½äº‘ç»™å¤§å®¶å¸¦æ¥äº†ä¸€æ³¢ç¦åˆ©ï¼ŒåŒæ­¥æ¨å‡ºé™æ—¶å…è´¹ä½“éªŒæ´»åŠ¨ï¼Œç›´æ¥æŠŠä¸Šæ‰‹é—¨æ§›é™åˆ°æœ€ä½ã€‚1æœˆ31æ—¥å¼€å§‹ï¼Œç”¨æˆ·åœ¨ç™¾åº¦æ™ºèƒ½äº‘å®˜ç½‘è´­ä¹°ã€ŒOpenClawé•œåƒã€çš„æ¨èæœºå‹ï¼ˆè½»é‡åº”ç”¨æœåŠ¡å™¨LSæˆ–ç»æµå‹e1)ï¼Œå³å¯è·å¾—é¦–æœˆä½“éªŒæœºä¼šã€‚</p><p>*æ´»åŠ¨ä¸ºæœŸä¸€ä¸ªæœˆï¼Œæ¯æ—¥é™é‡500å°ï¼ä¸ºäº†ä¿éšœæ´»åŠ¨çš„æ­£å¸¸å‚ä¸ç§©åºï¼Œå‚ä¸æ´»åŠ¨çš„ç”¨æˆ·éœ€åœ¨ä¸‹å•æ—¶æ”¯ä»˜0.01å…ƒã€‚</p><p>æ¥ä¸‹æ¥ï¼Œç™¾åº¦æ™ºèƒ½äº‘è¿˜å°†ä¸æ–­ä¼˜åŒ–OpenClawç­‰Agentäº§å“åœ¨äº‘ç«¯ç¯å¢ƒçš„ä½¿ç”¨ä½“éªŒï¼Œæ— è®ºæ˜¯éœ€è¦7Ã—24å°æ—¶ç¨³å®šè¿è¡Œçš„è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œè¿˜æ˜¯ä¸ªäººæ—¥å¸¸çš„è½»é‡çº§ä½¿ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›å¸®åŠ©ç”¨æˆ·åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œæ›´ä½æˆæœ¬åœ°éªŒè¯ä¸ªäººAIåŠ©ç†çš„å¯ç”¨æ€§ä¸æˆé•¿ç©ºé—´ï¼ŒæŒç»­è·å¾—ç¨³å®šã€å¯é çš„äº‘ç«¯æœåŠ¡ä½“éªŒã€‚</p><p>ä¸‹é¢è¿˜æœ‰è¯¦ç»†çš„éƒ¨ç½²æ•™ç¨‹ï¼ŒåŠ©åŠ›ä½ ç¬¬ä¸€æ—¶é—´åœ¨ç™¾åº¦æ™ºèƒ½äº‘å®ŒæˆOpenClawéƒ¨ç½²ï¼</p><h2>åœ¨ç™¾åº¦æ™ºèƒ½äº‘ä¸Šå¿«é€Ÿéƒ¨ç½²OpenClaw</h2><p>ä»¥ä¸‹å†…å®¹è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åœ¨è½»é‡åº”ç”¨æœåŠ¡å™¨LSä¸Šé…ç½®ä½¿ç”¨å¼€æºAIåŠ©æ‰‹OpenClaw(åŸåï¼šClawdbot)çš„å®Œæ•´æµç¨‹ã€‚ éƒ¨ç½²è¿‡ç¨‹ä¸»è¦åŒ…æ‹¬ï¼š</p><p>1.åœ¨è½»é‡åº”ç”¨æœåŠ¡å™¨æ§åˆ¶å°åˆ›å»ºå®ä¾‹ï¼Œé€šè¿‡ä¸€é”®å®‰è£…è„šæœ¬å®Œæˆéƒ¨ç½²ä»¥åŠåˆå§‹åŒ–ï¼›</p><p>2.ä½¿ç”¨åƒå¸†å®Œæˆæ–‡å¿ƒç³»åˆ—ã€Qwenç³»åˆ—ã€Deepseekç³»åˆ—ç­‰ä¸»æµæ¨¡å‹é…ç½®ï¼Œå¿«é€Ÿå°†ç™¾åº¦å¤§æ¨¡å‹èƒ½åŠ›é›†æˆåˆ°æœºå™¨äººåº”ç”¨ä¸­ã€‚</p><p>å®‰è£…é…ç½®OpenClaw</p><p>æ­¥éª¤ä¸€ï¼šåœ¨è½»é‡åº”ç”¨æœåŠ¡å™¨LSæ§åˆ¶å°åˆ›å»ºä¸€å°è½»é‡åº”ç”¨æœåŠ¡å™¨ã€‚</p><p>é•œåƒï¼šé€‰æ‹©OpenClaw(Clawdbot)2026.1.24-3</p><p>å¥—é¤ï¼šå»ºè®®æ‚¨é€‰æ‹©CPUï¼š2æ ¸ï¼Œå†…å­˜ï¼š2GBæˆ–ä»¥ä¸Šçš„å¥—é¤é…ç½®</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047584850" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"/></p><p>æ­¥éª¤äºŒï¼šåœ¨åƒå¸†æ§åˆ¶å°æ¨¡å‹æœåŠ¡é‡Œé¢é€‰æ‹©è¦ä½¿ç”¨çš„æ¨¡å‹(æœ¬æ–‡æ¡£ä½¿ç”¨deepseek-v3.1-250821ä½œä¸ºç¤ºä¾‹)ï¼Œå¯ä»¥æ–°å»ºæˆ–è€…é€‰æ‹©å·²æœ‰çš„API Keyã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047584851" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p><p>æ­¥éª¤ä¸‰ï¼šé€šè¿‡SmartTermæˆ–è€…VNCç™»å½•LSï¼Œä½¿ç”¨ä»¥ä¸‹å†…å®¹æ›¿æ¢~/.clawdbot/clawdbot.jsonï¼Œæ³¨æ„å°†API Keyæ›¿æ¢æˆæ­¥éª¤äºŒä¸­è·å–åˆ°çš„ï¼Œå¦‚æœé€‰æ‹©äº†å…¶ä»–æ¨¡å‹å¯ä»¥å°†æŒ‰ç…§deepseek-v3.1-25082æ ¼å¼åœ¨modelsé…ç½®é‡Œé¢æ›¿æ¢å³å¯ã€‚</p><pre><code class="bash">{
  "models": {
    "mode": "merge",
    "providers": {
      "qianfan": {
        "baseUrl": "https://qianfan.baidubce.com/v2",
        "apiKey": "You Api Key",
        "api": "openai-completions",
        "models": [
          {
            "id": "deepseek-v3.1-250821",
            "name": "deepseek-v3.1-250821",
            "reasoning": false,
            "input": [
              "text"
            ],
            "cost": {
              "input": 0.0025,
              "output": 0.01,
              "cacheRead": 0,
              "cacheWrite": 0
            },
            "contextWindow": 262144,
            "maxTokens": 65536
          }
        ]
      }
    }
  },
  "agents": {
    "defaults": {
      "model": {
        "primary": "qianfan/deepseek-v3.1-250821"
      },
      "models": {
        "qianfan/deepseek-v3.1-250821": {
          "alias": "deepseek-v3.1-250821"
        }
      }
    }
  }
}</code></pre><p>æ­¥éª¤å››ï¼šä½¿ç”¨clawdbot onboardå‘½ä»¤å¯ä»¥å¼€å§‹å¯åŠ¨é…ç½®å‘å¯¼ï¼Œå®Œæˆclawdbotçš„åˆå§‹åŒ–å¹¶ä¸”å¯åŠ¨å¯ä»¥è¿›å…¥TUIæ¨¡å¼ã€‚å¦‚æœéœ€è¦æ›´æ¢æ¨¡å‹æˆ–è€…å…¶ä»–é…ç½®å¯ä»¥ä½¿ç”¨clawdbot onboardé‡æ–°è¿›å…¥å¼•å¯¼é…ç½®ï¼Œå¹¶ä¸”å‚è€ƒä¸€ä¸‹é…ç½®è¿›è¡Œé€‰æ‹©ï¼Œä¸¤æ¬¡ctrl+cå¯ä»¥æ¨å‡ºTUIæ¨¡å¼</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047584852" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/><br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047584853" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p><p>æ­¥éª¤äº”ï¼ˆå¯é€‰ï¼‰ï¼šä½¿ç”¨clawdbot gateway install --forceé‡æ–°å¯åŠ¨ç½‘å…³é…ç½®ï¼Œå¹¶ä¸”ä½¿ç”¨clawdbot models listæŸ¥çœ‹å½“å‰é…ç½®çš„æ¨¡å‹æƒ…å†µã€‚ä½¿ç”¨clawdbot agent --agent main --message 'å½“å‰CPUå ç”¨æƒ…å†µ'æŸ¥çœ‹é…ç½®æ˜¯å¦ç”Ÿæ•ˆã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047584854" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p><p>OpenClawå¸¸è§å‘½ä»¤å‚è€ƒ</p><p>è¯¦ç»†ä½¿ç”¨æŒ‡å—è¯¦è§å®˜æ–¹æ•™ç¨‹ï¼š<a href="https://link.segmentfault.com/?enc=mM8wmaw1hDuVonXmjiE8HA%3D%3D.fMkqumZv6cqLwZqW%2FboAwSsOAlKBLe0IvW02eSPL%2BXEhw6wCTlYN3q84NT3xtxv9" rel="nofollow" target="_blank">https://cloud.baidu.com/doc/LS/s/Cmkxwt7wk</a></p>]]></description></item><item>    <title><![CDATA[æ¶æ„å¸ˆå¿…å¤‡ï¼šç°åº¦æ–¹æ¡ˆæ±‡æ€» Javaçƒ˜ç„™å¸ˆ ]]></title>    <link>https://segmentfault.com/a/1190000047584878</link>    <guid>https://segmentfault.com/a/1190000047584878</guid>    <pubDate>2026-02-01 00:04:01</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Javaçƒ˜ç„™å¸ˆã€‚æœ¬æ–‡ç»“åˆç¬”è€…çš„ç»éªŒå’Œæ€è€ƒï¼Œå¯¹ç°åº¦æ–¹æ¡ˆåšä¸ªæ€»ç»“ï¼Œé‡ç‚¹ä»‹ç»ABå®éªŒã€‚</p><p>ç°åº¦åœ¨å¼€å‘æµç¨‹ä¸­éå¸¸æ™®éã€‚å…ˆåšå°æµé‡éªŒè¯ï¼Œç¡®è®¤æ— è¯¯åå†æ¨å…¨ï¼Œç°åº¦è¿‡ç¨‹ä¸­ä¸€æ—¦å‘ç°ç³»ç»Ÿå¼‚å¸¸ã€æˆ–ä¸šåŠ¡æŒ‡æ ‡å¼‚å¸¸ï¼Œåº”ç«‹åˆ»å›æ»šã€‚</p><h2>ç°åº¦åœºæ™¯</h2><ul><li><p>ä»£ç ç°åº¦ï¼šæ˜¯æœ€å…¸å‹çš„ç°åº¦ï¼Œç°åº¦å†…åšæ–°é€»è¾‘ï¼Œç°åº¦å¤–åšæ—§é€»è¾‘</p><ul><li>æ—¢å¯ä»¥æä¾›v2ç‰ˆæœ¬æ–°æ¥å£ç»™è°ƒç”¨æ–¹æœåŠ¡ï¼Œç”±è°ƒç”¨æ–¹æ¥åšç°åº¦åˆ‡æ¢</li><li>ä¹Ÿå¯ä»¥å†…éƒ¨åˆ‡ç°åº¦ï¼Œåšåˆ°è°ƒç”¨æ–¹æ— æ„Ÿ</li></ul></li><li>å‘ç‰ˆç°åº¦ï¼šä¸Šçº¿è¿‡ç¨‹ä¸­ï¼Œæ–°ç‰ˆæœ¬æœåŠ¡å®ä¾‹ä¸æ–­å¢åŠ ï¼Œéœ€è€ƒè™‘å…¼å®¹æ–°æ—§åè®®</li><li>é…ç½®ç°åº¦ï¼šä¿®æ”¹é…ç½®æ—¶ï¼ŒæŒ‰æœåŠ¡å®ä¾‹ç°åº¦æ¨é€é…ç½®å˜æ›´</li></ul><h2>ç°åº¦æ¨¡å¼</h2><ul><li><p>æ•°å­—idå°¾å·ç°åº¦ï¼šå–idæœ€å2ä½ï¼ˆç™¾åˆ†æ¯”ï¼‰ã€æœ€å3ä½ï¼ˆåƒåˆ†æ¯”ï¼‰ã€æœ€å4ä½ï¼ˆä¸‡åˆ†æ¯”ï¼‰ç­‰</p><ul><li>å®ç°æ–¹å¼ï¼šidå–æ¨¡ï¼Œä¾‹å¦‚ <code>id % 100 &lt; ç°åº¦ç™¾åˆ†æ¯”</code>ï¼Œåˆ™å‘½ä¸­ç°åº¦</li><li>ç‰¹ç‚¹ï¼šç®€å•ï¼Œé€‚ç”¨äºç»å¤§éƒ¨åˆ†æŠ€æœ¯ä¼˜åŒ–åœºæ™¯</li></ul></li><li><p>éšæœºç°åº¦ï¼šå–ä¸€éƒ¨åˆ†éšæœºæµé‡åšç°åº¦</p><ul><li>å®ç°æ–¹å¼ï¼š<code>ThreadLocalRandom.current().nextInt(100) &lt; ç°åº¦ç™¾åˆ†æ¯”</code></li><li>ä¹‹æ‰€ä»¥ä½¿ç”¨ThreadLocalRandomã€è€Œä¸æ˜¯Randomï¼Œæ˜¯ä¸ºäº†é¿å…å¤šçº¿ç¨‹ç«äº‰ç”¨äºç”Ÿæˆéšæœºæ•°çš„seed</li></ul></li><li><p>A/Bå®éªŒ</p><ul><li>å®ç°æ–¹å¼ï¼šåˆ†å±‚å®éªŒã€å®éªŒæ•°æ®æ”¶é›†ã€ç¦»çº¿ç»Ÿè®¡</li><li>ç‰¹ç‚¹ï¼šé€‚ç”¨äºå°æµé‡éªŒè¯æ–°ä¸šåŠ¡åŠŸèƒ½çš„æ•ˆæœï¼Œæ•´ä½“æ–¹æ¡ˆç›¸å¯¹å¤æ‚ï¼Œéœ€è¦æŠ€æœ¯åŸºå»º</li></ul></li></ul><h2>idé€‰å–</h2><ul><li>ä¸šåŠ¡idï¼šå¦‚ç”¨æˆ·idã€å•†å“idç­‰</li><li>è®¾å¤‡idï¼šæœªæ³¨å†Œ/æœªç™»å½•ç”¨æˆ·ï¼Œæ­¤æ—¶æ²¡æœ‰ç”¨æˆ·idï¼Œåªèƒ½å–è®¾å¤‡çš„å”¯ä¸€æ ‡è¯†</li></ul><p>ä¸‹é¢é‡ç‚¹ä»‹ç»ä¸€ä¸‹A/Bå®éªŒã€‚</p><h2>A/Bå®éªŒ</h2><h3>ç›®çš„</h3><ul><li>å°æµé‡éªŒè¯æ–°ä¸šåŠ¡åŠŸèƒ½ï¼Œæ­£å‘æ˜¾è‘—åˆ™æ¨è‡³å…¨é‡ï¼Œå¦åˆ™ç»§ç»­è¿­ä»£ä¼˜åŒ–ã€æˆ–ä¸‹çº¿ï¼Œé¿å…åŠŸèƒ½è¿‡äºè‡ƒè‚¿</li><li>ç”¨æ•°æ®ä½œä¸ºä¾æ®ï¼Œé¿å…æƒ³å½“ç„¶ã€æ‹è„‘è¢‹å†³ç­–</li></ul><h3>åˆ†å±‚å®éªŒ</h3><p>ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†åŒæ—¶åšå¤šä¸ªå®éªŒï¼Œè€Œä¸æ˜¯ç»™æ¯ä¸ªå®éªŒå‡åˆ†ä¸€éƒ¨åˆ†æµé‡ã€‚å› ä¸ºå½“åŒæ—¶è¿›è¡Œçš„å®éªŒå˜å¤šæ—¶ï¼Œç»„åˆæ•°é‡æˆå€å¢åŠ ï¼Œæ¯ä¸ªå®éªŒåˆ†åˆ°çš„æµé‡å°±å¾ˆå°‘äº†ã€‚<br/>æœ‰è¿™å‡ å±‚ç»“æ„ï¼šå®éªŒå±‚ã€å®éªŒã€åˆ†ç»„</p><ul><li>å®éªŒå±‚ä¹‹é—´æ­£äº¤ï¼Œå¯åŒæ—¶è¿›è¡Œå¤šä¸ªå®éªŒå±‚çš„å®éªŒ</li><li>åŒä¸€å®éªŒå±‚çš„å®éªŒä¹‹é—´äº’æ–¥ï¼Œæ¯”å¦‚å‘½ä¸­äº†å®éªŒ1-1ï¼Œå°±ä¸ä¼šå‘½ä¸­å®éªŒ1-2ã€‚å®éªŒæŒæœ‰0åˆ°å¤šä¸ªåˆ†æ¡¶ï¼Œæ ¹æ®ä¸šåŠ¡idå¯è®¡ç®—å‡ºæ¡¶å·ï¼Œè¿›è€ŒçŸ¥é“å‘½ä¸­å“ªä¸ªå®éªŒ</li><li>åŒä¸€å®éªŒå†…æœ‰å¤šä¸ªåˆ†ç»„ï¼ŒåŒ…æ‹¬1ä¸ªå¯¹ç…§ç»„ï¼Œå’Œ1åˆ°å¤šä¸ªå®éªŒç»„ï¼Œåªä¼šå‘½ä¸­å…¶ä¸­ä¸€ä¸ªåˆ†ç»„ã€‚åˆ†ç»„æŒæœ‰0åˆ°å¤šä¸ªåˆ†æ¡¶ï¼Œæ ¹æ®ä¸šåŠ¡idå¯è®¡ç®—å‡ºæ¡¶å·ï¼Œè¿›è€ŒçŸ¥é“å‘½ä¸­å“ªä¸ªåˆ†ç»„</li></ul><p>å®éªŒå±‚ã€å®éªŒä¸¾ä¾‹ï¼š</p><ul><li>å±•ç¤ºå®éªŒå±‚ï¼šæ ¹æ®é¡µé¢è¿›è¡Œåˆ’åˆ†ï¼Œå¦‚é¦–é¡µã€æœç´¢é¡µã€æ¨èé¡µã€è¯¦æƒ…é¡µç­‰ã€‚æ¯ä¸ªé¡µé¢ä½œä¸ºä¸€ä¸ªå®éªŒå±‚ï¼Œæ¯ä¸ªå®éªŒå±‚é‡Œå¯åŒæ—¶åšå¤šä¸ªå±•ç¤ºå®éªŒ</li><li>ç®—æ³•å®éªŒå±‚ï¼šæ ¹æ®åœºæ™¯è¿›è¡Œåˆ’åˆ†ï¼Œå¦‚ç›¸ä¼¼æ¨èã€æ­é…è´­æ¨èã€ä¸ªæ€§åŒ–æ¨èã€æœç´¢æ’åºã€å¹¿å‘Šæ’åºç­‰ã€‚æ¯ä¸ªåœºæ™¯ä½œä¸ºä¸€ä¸ªå®éªŒå±‚ï¼Œæ¯ä¸ªå®éªŒå±‚é‡Œå¯åŒæ—¶åšå¤šä¸ªç®—æ³•å®éªŒ</li></ul><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047584881" alt="image" title="image"/></p><h3>å“ˆå¸Œç®—æ³•æ‰“æ•£</h3><p>è¦åŒæ—¶æ”¯æŒå¤šä¸ªåˆ†å±‚å®éªŒï¼Œæ ¸å¿ƒåœ¨äºé€šè¿‡å“ˆå¸Œç®—æ³•å°†æ¯ä¸€å±‚çš„æµé‡æ‰“æ•£ï¼Œç”¨äºå®ç°â€œå‡åŒ€åˆ†æµâ€å’Œâ€œå±‚é—´æ­£äº¤â€ï¼Œä½¿å¾—æµé‡åœ¨å„ä¸ªå®éªŒçš„æ•ˆæœæ­£è´ŸæŠµæ¶ˆï¼Œæ‰èƒ½å¾—åˆ°çœŸå®çš„å¯¹æ¯”ç»“æœã€‚<br/>ä»¥ä¸‹æ˜¯è®¡ç®—å®éªŒå±‚æ¡¶å·çš„ä»£ç ç¤ºä¾‹ï¼Œå®éªŒæ¡¶å·åŒç†ï¼š</p><pre><code class="java">import com.google.common.hash.Hashing;
import java.nio.charset.StandardCharsets;

public class ABTestRouter {

    /**
     * æ ¹æ®ç”¨æˆ·IDå’Œå®éªŒå±‚IDï¼ˆå®éªŒå±‚IDå……å½“ç›çš„è§’è‰²ï¼‰ï¼Œè®¡ç®—æ¡¶å· (0-99)
     */
    public static int getBucket(String userId, String layerId) {
        // 1. æ‹¼æ¥ Key: "layerId:userId"
        String key = layerId + ":" + userId;

        // 2. ä½¿ç”¨ MurmurHash3 (32-bit)
        // Guava çš„ murmur3_32_fixed æ˜¯çº¿ç¨‹å®‰å…¨çš„
        int hash = Hashing.murmur3_32_fixed()
                .hashString(key, StandardCharsets.UTF_8)
                .asInt();

        // 3. å–æ¨¡å¹¶ç¡®ä¿ç»“æœä¸ºæ­£æ•°
        // Math.abs(Integer.MIN_VALUE) ä¼šè¿”å›è´Ÿæ•°ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨ä½è¿ç®—å»é™¤ç¬¦å·ä½
        return (hash &amp; Integer.MAX_VALUE) % 100;
    }

    public static void main(String[] args) {
        String uid = "user_123456";
        
        // ä¸åŒå±‚çš„æµé‡æ˜¯æ­£äº¤çš„ï¼ˆæ‰“æ•£é‡æ–°åˆ†é…ï¼‰
        System.out.println("å±•ç¤ºå±‚æ¡¶å·: " + getBucket(uid, "layer_ui"));
        System.out.println("ç®—æ³•å±‚æ¡¶å·: " + getBucket(uid, "layer_algo"));
    }
}</code></pre><p>ä¹‹æ‰€ä»¥ç”¨murmurhashï¼Œè€Œémd5ï¼Œæ˜¯å› ä¸ºmd5æ˜¯åŠ å¯†ç®—æ³•ï¼Œè®¡ç®—å¼€é”€æ›´å¤§ï¼Œåœ¨ABå®éªŒä¸­ä»…éœ€å‡åŒ€æ‰“æ•£å³å¯ï¼Œæ— éœ€æ‹…å¿ƒæ ¹æ®å“ˆå¸Œç»“æœåæ¨åŸæ–‡ã€‚<br/>ä¹‹æ‰€ä»¥æŠŠå®éªŒå±‚idä½œä¸ºç›ï¼Œæ˜¯å› ä¸ºå¾®å°çš„è¾“å…¥å·®å¼‚éƒ½ä¼šå¯¼è‡´å“ˆå¸Œç»“æœç›¸å·®å·¨å¤§ï¼Œå®ç°æ‰“æ•£çš„æ•ˆæœã€‚</p><h3>å®éªŒæ•°æ®æ”¶é›†</h3><p>å®éªŒæ•°æ®æ”¶é›†æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>åœ¨ABå®éªŒç®¡ç†ç³»ç»Ÿä¸­é…ç½®å®éªŒä¿¡æ¯ï¼šå¦‚å®éªŒç›å€¼ã€æ¡¶å·ä¸å®éªŒç»„çš„æ˜ å°„å…³ç³»ç­‰ï¼Œå¯åŠ¨æ€ä¿®æ”¹</li><li><p>ä»£ç é€»è¾‘å¼€å‘ï¼š</p><ul><li>å¼•å…¥å®éªŒsdkï¼Œsdkåœ¨å¯åŠ¨ã€æˆ–é…ç½®å˜æ›´æ—¶æ‹‰å–å®éªŒä¿¡æ¯ï¼Œæœ¬åœ°è®¡ç®—ä¸šåŠ¡idçš„æ¡¶å·ï¼Œè¿›è€Œå¾—åˆ°å‘½ä¸­çš„åˆ†ç»„</li><li>å¯¹ç…§ç»„åšå½“å‰é€»è¾‘ï¼Œå®éªŒç»„1åšé€»è¾‘1ï¼Œå®éªŒç»„2åšé€»è¾‘2</li></ul></li><li>åœ¨æ­£å¼å¼€å§‹ABå®éªŒä¹‹å‰ï¼Œå…ˆåšAAåˆ†æ¡¶å®éªŒï¼Œæ¨¡æ‹Ÿå®éªŒç»„ã€å¯¹ç…§ç»„çš„ç»“æœï¼Œåˆ¤æ–­æ˜¯å¦å‡åŒ€ï¼Œé¿å…åˆ†æ¡¶ä¸å‡åŒ€å¸¦æ¥é”™è¯¯çš„å®éªŒç»“æœ</li><li><p>å®éªŒå¼€å§‹ï¼Œåç«¯åŸ‹ç‚¹ï¼šsdkå‘å‡ºåç«¯åŸ‹ç‚¹æ¶ˆæ¯</p><ul><li>æ¶ˆæ¯æ ¼å¼ä¸¾ä¾‹ï¼š<code>ä¸šåŠ¡id, å®éªŒå±‚id, å®éªŒid, åˆ†ç»„id, æ¡¶å·, è§¦å‘æ—¶é—´</code></li></ul></li><li>å®éªŒè¿‡ç¨‹ï¼šå®éªŒæŒç»­æ—¶é—´è‡³å°‘ä¸€å‘¨ï¼Œè¦†ç›–å·¥ä½œæ—¥ã€å‘¨æœ«/å‡æœŸï¼Œé¿å…å—æ—¶é—´å‘¨æœŸå¸¦æ¥çš„æ³¢åŠ¨å½±å“</li><li><p>ç¦»çº¿ç»Ÿè®¡å®éªŒæ•ˆæœï¼š</p><ul><li>åç«¯åŸ‹ç‚¹æ•°æ®å¯¼å…¥æ›å…‰äº‹ä»¶hiveè¡¨</li><li>ä¸šåŠ¡DBæ•°æ®å¯¼å…¥è¡Œä¸ºäº‹ä»¶hiveè¡¨ï¼Œå¦‚æ³¨å†Œã€ç™»å½•ã€æµè§ˆã€ç‚¹å‡»ã€æ”¶è—ã€åŠ è´­ã€ä¸‹å•ã€æ”¯ä»˜ç­‰ï¼Œå–å†³äºå®éªŒå…³æ³¨çš„ä¸šåŠ¡æŒ‡æ ‡</li><li>æŠŠæ›å…‰äº‹ä»¶ã€è¡Œä¸ºäº‹ä»¶joinèµ·æ¥ï¼Œå¯¹æ¯”å®éªŒç»„ã€å¯¹ç…§ç»„çš„ä¸šåŠ¡æŒ‡æ ‡å·®å¼‚</li></ul></li></ul><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047584882" alt="image" title="image" loading="lazy"/></p><p>ä»¥ä¸‹æ˜¯sqlç¤ºä¾‹ï¼Œä»£è¡¨ä»å®éªŒæ›å…‰å24å°æ—¶å†…å„ä¸ªåˆ†ç»„çš„è½¬åŒ–ç‡å¯¹æ¯”ã€‚</p><pre><code class="sql">SELECT 
    e.group_id,
    COUNT(DISTINCT e.user_id) as exposed_users,
    COUNT(DISTINCT a.user_id) as converted_users,
    COUNT(DISTINCT a.user_id) / COUNT(DISTINCT e.user_id) as conversion_rate
FROM exposure_events e
LEFT JOIN action_events a ON e.user_id = a.user_id 
    AND a.event_time BETWEEN e.event_time AND (e.event_time + INTERVAL 24 HOUR)
WHERE e.experiment_id = 'ui_test_001'
GROUP BY e.group_id;</code></pre><h3>å®éªŒæŠ¥è¡¨åˆ†æ</h3><p>è¯„ä¼°å®éªŒç»“æœæ˜¯å¦æ­£å‘ã€æ˜¯å¦æ˜¾è‘—ã€‚äº†è§£ç»Ÿè®¡å­¦é‡Œçš„æ ¸å¿ƒæ¦‚å¿µï¼Œèƒ½çœ‹æ‡‚å®éªŒæŠ¥è¡¨å³å¯ã€‚</p><h4>på€¼</h4><p>ç”¨æ¥è¡¡é‡å®éªŒç»“æœæ˜¯å¦æ˜¾è‘—ï¼Œpå€¼çš„å«ä¹‰æ˜¯ï¼šå‡è®¾å®éªŒç»„ä¸å¯¹ç…§ç»„æ²¡æœ‰åŒºåˆ«ï¼Œæ­¤æ—¶è§‚å¯Ÿåˆ°å®éªŒæœ‰å·®å¼‚çš„æ¦‚ç‡ã€‚ä¸€èˆ¬è¦æ±‚ <code>p &lt; 0.05</code>ï¼Œä¹Ÿå°±æ˜¯è¯´å®éªŒç»“æœæ˜¾è‘—çš„æ¦‚ç‡å¤§äº95%ï¼ˆ<code>1 - 0.05 = 95%</code>ï¼‰</p><h4>ç½®ä¿¡åŒºé—´</h4><p>åœ¨æ˜¾è‘—çš„å‰æä¸‹ï¼Œç”¨æ¥è¡¡é‡å®éªŒç»“æœæ˜¯å¦æ­£å‘ï¼Œä»£è¡¨ä¸šåŠ¡æŒ‡æ ‡çš„å¯èƒ½èŒƒå›´åˆ†å¸ƒã€‚<br/>æ¯”å¦‚ï¼šå®éªŒç»“æœé‡Œä¸šåŠ¡æŒ‡æ ‡æå‡äº†1%ï¼Œ95%ç½®ä¿¡åŒºé—´åœ¨[0.8%, 1.2%]ï¼Œåˆ™ä»£è¡¨æœ‰95%çš„æŠŠæ¡å¯ä»¥æŠŠä¸šåŠ¡æŒ‡æ ‡æå‡è‡³å°‘0.8%ã€è‡³å¤š1.2%ï¼Œæ•ˆæœæ­£å‘ã€‚å¦‚æœç½®ä¿¡åŒºé—´çš„ä¸‹ç•Œæ˜¯è´Ÿæ•°ï¼Œå°±æœ‰å¯èƒ½æ˜¯è´Ÿå‘æ•ˆæœäº†ï¼Œéœ€è¦è­¦æƒ•ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ç°åº¦æ–¹æ¡ˆçš„æ€»ç»“äº†ï¼Œæ¬¢è¿è®¨è®ºäº¤æµã€‚</p>]]></description></item><item>    <title><![CDATA[å¦‚ä½•ä½¿ç”¨é€šä¹‰åƒé—®ï¼ˆQwenï¼‰å¤§æ¨¡å‹çš„ OpenAI å…¼å®¹ API æ„å»º AI èŠå¤©åº”ç”¨ ê¯­ê¯­å¬ê¯­é£ê¯­]]></title>    <link>https://segmentfault.com/a/1190000047585126</link>    <guid>https://segmentfault.com/a/1190000047585126</guid>    <pubDate>2026-02-01 00:03:07</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>éšç€äººå·¥æ™ºèƒ½æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œå¤§è¯­è¨€æ¨¡å‹å·²æˆä¸ºç°ä»£åº”ç”¨å¼€å‘çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚é˜¿é‡Œäº‘çš„é€šä¹‰åƒé—®ï¼ˆQwenï¼‰ç³»åˆ—æ¨¡å‹å‡­å€Ÿå…¶å“è¶Šçš„æ€§èƒ½å’Œä¸°å¯Œçš„åŠŸèƒ½ï¼Œå—åˆ°äº†å¹¿æ³›å…³æ³¨ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åˆ©ç”¨ Qwen æ¨¡å‹çš„ OpenAI å…¼å®¹ API æ„å»ºä¸€ä¸ªå®Œæ•´çš„ AI èŠå¤©åº”ç”¨ã€‚</p><h2>API å¯†é’¥ç®¡ç†</h2><h3>è·å– API å¯†é’¥</h3><p>è¦åœ¨é¡¹ç›®ä¸­ä½¿ç”¨é€šä¹‰åƒé—®æ¨¡å‹ï¼Œé¦–å…ˆéœ€è¦åœ¨é˜¿é‡Œäº‘å¹³å°ä¸Šè·å– API å¯†é’¥ï¼š</p><ol><li>è®¿é—®é˜¿é‡Œäº‘æ§åˆ¶å°ï¼Œæ³¨å†Œå¹¶ç™»å½•è´¦æˆ·</li><li>è¿›å…¥é€šä¹‰åƒé—®äº§å“é¡µé¢ï¼Œå¼€é€šæœåŠ¡</li><li>åœ¨æ§åˆ¶å°ä¸­æ‰¾åˆ° API å¯†é’¥ç®¡ç†é¡µé¢ï¼Œåˆ›å»ºæ–°çš„ API å¯†é’¥</li><li>å°†ç”Ÿæˆçš„å¯†é’¥å¦¥å–„ä¿å­˜ï¼Œæ³¨æ„é¦–æ¬¡ç”Ÿæˆåéœ€è¦ç«‹å³å¤åˆ¶ä¿å­˜</li></ol><h3>å®‰å…¨å­˜å‚¨æœ€ä½³å®è·µ</h3><p>API å¯†é’¥æ˜¯è®¿é—®æœåŠ¡çš„é‡è¦å‡­è¯ï¼Œå¿…é¡»ä¸¥æ ¼ä¿æŠ¤ã€‚ä»¥ä¸‹æ˜¯å‡ ç§å®‰å…¨å­˜å‚¨æ–¹å¼ï¼š</p><h4>1. ä½¿ç”¨ç¯å¢ƒå˜é‡</h4><p>åœ¨é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨ç¯å¢ƒå˜é‡æ¥å­˜å‚¨ API å¯†é’¥ï¼Œé¿å…ç›´æ¥ç¡¬ç¼–ç åˆ°ä»£ç ä¸­ï¼š</p><pre><code class="env"># .env.local - æœ¬åœ°å¼€å‘é…ç½®ï¼ˆä¸åº”æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰
OPENAI_API_KEY=your_actual_qwen_api_key_here
OPENAI_API_BASE=https://dashscope.aliyuncs.com/compatible-mode/v1
MODEL_NAME=qwen-max</code></pre><h4>2. .env.local vs .env.example</h4><ul><li><strong>.env.local</strong>: å­˜å‚¨å®é™…çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚çœŸå® API å¯†é’¥ï¼Œåº”æ·»åŠ åˆ° <code>.gitignore</code> ä¸­é¿å…æäº¤</li><li><strong>.env.example</strong>: ä»…ä½œä¸ºæ¨¡æ¿æ–‡ä»¶ï¼ŒåŒ…å«å ä½ç¬¦è€ŒéçœŸå®å¯†é’¥ï¼Œå¯ä»¥å®‰å…¨åœ°æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</li></ul><pre><code class="env"># .env.example - ç¤ºä¾‹æ¨¡æ¿æ–‡ä»¶
OPENAI_API_KEY=your_qwen_api_key_here
OPENAI_API_BASE=https://dashscope.aliyuncs.com/compatible-mode/v1
MODEL_NAME=qwen-max</code></pre><p>è¿™ç§åˆ†ç¦»æ–¹å¼æ—¢ä¿è¯äº†å›¢é˜Ÿåä½œçš„ä¾¿åˆ©æ€§ï¼Œåˆç¡®ä¿äº†å®‰å…¨æ€§ã€‚</p><h2>åŸºç¡€è°ƒç”¨æ–¹æ³•</h2><h3>OpenAI SDK å…¼å®¹è°ƒç”¨</h3><p>é€šä¹‰åƒé—®æä¾›äº† OpenAI å…¼å®¹æ¨¡å¼ï¼Œä½¿å¾—ç°æœ‰åŸºäº OpenAI SDK çš„é¡¹ç›®å¯ä»¥è½»æ¾è¿ç§»ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„ Node.js è°ƒç”¨ç¤ºä¾‹ï¼š</p><pre><code class="typescript">import OpenAI from 'openai';

// åˆ›å»ºå…¼å®¹ OpenAI æ ¼å¼çš„å®¢æˆ·ç«¯
const client = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY || '',
  baseURL: process.env.OPENAI_API_BASE || 'https://dashscope.aliyuncs.com/compatible-mode/v1',
});

// å‘é€èŠå¤©è¡¥å…¨è¯·æ±‚
const response = await client.chat.completions.create({
  model: process.env.MODEL_NAME || 'qwen-max',
  messages: [
    { role: 'system', content: 'You are a helpful assistant.' },
    { role: 'user', content: 'Hello!' }
  ],
});</code></pre><h3>æµå¼å“åº”å®ç°</h3><p>ä¸ºäº†æä¾›æ›´æµç•…çš„ç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬å¯ä»¥å®ç°æµå¼å“åº”ï¼š</p><pre><code class="typescript">// æµå¼å“åº”ç¤ºä¾‹
const stream = await client.chat.completions.create({
  model: process.env.MODEL_NAME || 'qwen-max',
  messages,
  stream: true,  // å¯ç”¨æµå¼å“åº”
});

// å¤„ç†æµå¼æ•°æ®
for await (const chunk of stream) {
  const content = chunk.choices[0]?.delta?.content;
  if (content) {
    // å®æ—¶è¾“å‡ºå†…å®¹
    process.stdout.write(content);
  }
}</code></pre><p>åœ¨ Next.js API è·¯ç”±ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†æµå¼å“åº”è½¬æ¢ä¸º Server-Sent Events (SSE)ï¼š</p><pre><code class="typescript">// Next.js API è·¯ç”±ä¸­çš„æµå¼å“åº”å¤„ç†
export default async function handler(req: NextApiRequest, res: NextApiResponse) {
  // è®¾ç½® SSE å“åº”å¤´
  res.setHeader('Content-Type', 'text/event-stream');
  res.setHeader('Cache-Control', 'no-cache');
  res.setHeader('Connection', 'keep-alive');
  res.setHeader('Transfer-Encoding', 'chunked');

  for await (const chunk of stream) {
    const content = chunk.choices[0]?.delta?.content;
    if (content) {
      res.write(`data: ${JSON.stringify({ content })}\n\n`);
    }
  }

  // å‘é€ç»“æŸä¿¡å·
  res.write('data: [DONE]\n\n');
  res.end();
}</code></pre><h2>æ ¸å¿ƒç‰¹æ€§</h2><h3>1. æµå¼è¾“å‡ºæ”¯æŒ</h3><p>æµå¼è¾“å‡ºèƒ½å¤Ÿå®æ—¶æ˜¾ç¤ºæ¨¡å‹ç”Ÿæˆçš„å†…å®¹ï¼Œæ˜¾è‘—æå‡ç”¨æˆ·ä½“éªŒã€‚ç›¸æ¯”ç­‰å¾…å®Œæ•´å“åº”åå†æ˜¾ç¤ºï¼Œæµå¼è¾“å‡ºè®©ç”¨æˆ·æ„Ÿè§‰å“åº”æ›´åŠ å³æ—¶ã€‚</p><h3>2. OpenAI SDK å…¼å®¹</h3><p>é€šè¿‡å…¼å®¹ OpenAI æ¥å£ï¼Œå¼€å‘è€…å¯ä»¥ï¼š</p><ul><li>æ— éœ€å­¦ä¹ æ–°çš„ API è§„èŒƒ</li><li>è½»æ¾è¿ç§»ç°æœ‰é¡¹ç›®</li><li>å¤ç”¨ç°æœ‰çš„å·¥å…·é“¾å’Œåº“</li></ul><h3>3. å…¨æ ˆä¸€ä½“åŒ–éƒ¨ç½²</h3><p>åŸºäº Next.js çš„å…¨æ ˆæ¶æ„ä¼˜åŠ¿ï¼š</p><ul><li>å•ä¸€ä»£ç åº“ç®¡ç†å‰åç«¯</li><li>æœåŠ¡ç«¯æ¸²æŸ“æå‡ SEO</li><li>API è·¯ç”±ä¸å‰ç«¯é¡µé¢ç»Ÿä¸€éƒ¨ç½²</li></ul><h3>4. å®Œå–„çš„é”™è¯¯å¤„ç†</h3><p>ç³»ç»Ÿå†…ç½®äº†å¯¹å¸¸è§é”™è¯¯çš„å¤„ç†æœºåˆ¶ï¼š</p><pre><code class="typescript">try {
  // API è°ƒç”¨
  const response = await client.chat.completions.create({...});
} catch (error: any) {
  if (error.status === 401) {
    // è®¤è¯å¤±è´¥
    errorMessage = 'Authentication failed. Please check your API key.';
    statusCode = 401;
  } else if (error.status === 429) {
    // è¯·æ±‚é¢‘ç‡è¶…é™
    errorMessage = 'Rate limit exceeded. Please try again later.';
    statusCode = 429;
  }
  // è¿”å›é”™è¯¯ä¿¡æ¯ç»™å‰ç«¯
  res.status(statusCode).json({ error: errorMessage });
}</code></pre><h2>è®¡è´¹æ¨¡å¼ä¸ä½¿ç”¨é™åˆ¶</h2><h3>è®¡è´¹æ–¹å¼</h3><p>é€šä¹‰åƒé—®é‡‡ç”¨æŒ‰é‡ä»˜è´¹æ¨¡å¼ï¼Œä¸»è¦æ ¹æ® token æ•°é‡è®¡è´¹ï¼š</p><ul><li><strong>è¾“å…¥ token</strong>ï¼šç”¨æˆ·å‘é€çš„æ¶ˆæ¯å†…å®¹</li><li><strong>è¾“å‡º token</strong>ï¼šæ¨¡å‹ç”Ÿæˆçš„å›å¤å†…å®¹</li><li><strong>è´¹ç”¨è®¡ç®—</strong>ï¼šè¾“å…¥å’Œè¾“å‡º token åˆ†åˆ«è®¡è´¹</li></ul><h3>æ¨¡å‹ç‰ˆæœ¬å¯¹æ¯”</h3><table><thead><tr><th>æ¨¡å‹</th><th>ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th><th>ä»·æ ¼</th></tr></thead><tbody><tr><td>qwen-turbo</td><td>é«˜æ•ˆæ¨ç†ï¼Œæˆæœ¬ä½</td><td>ç®€å•ä»»åŠ¡ï¼Œé«˜å¹¶å‘</td><td>æœ€ç»æµ</td></tr><tr><td>qwen-plus</td><td>å¹³è¡¡æ€§èƒ½ä¸æˆæœ¬</td><td>ä¸€èˆ¬æ€§ä»»åŠ¡</td><td>ä¸­ç­‰</td></tr><tr><td>qwen-max</td><td>å¼ºå¤§æ¨ç†èƒ½åŠ›</td><td>å¤æ‚ä»»åŠ¡ï¼Œé€»è¾‘æ¨ç†</td><td>æ€§èƒ½æœ€å¼º</td></tr></tbody></table><h3>é™åˆ¶å‚æ•°</h3><ul><li><strong>é€Ÿç‡é™åˆ¶</strong>ï¼šé€šå¸¸æœ‰æ¯åˆ†é’Ÿè¯·æ±‚æ•°ï¼ˆRPMï¼‰å’Œæ¯ç§’æŸ¥è¯¢æ•°ï¼ˆQPSï¼‰é™åˆ¶</li><li><strong>ä¸Šä¸‹æ–‡é•¿åº¦</strong>ï¼šæœ€å¤§æ”¯æŒ 32768 tokensï¼Œå¯å¤„ç†é•¿æ–‡æœ¬</li><li><strong>å•æ¬¡è¯·æ±‚é™åˆ¶</strong>ï¼šæ ¹æ®æ¨¡å‹ç‰ˆæœ¬æœ‰æ‰€ä¸åŒ</li></ul><h3>æˆæœ¬ä¼˜åŒ–å»ºè®®</h3><ol><li><strong>åˆç†é€‰æ‹©æ¨¡å‹</strong>ï¼šæ ¹æ®ä»»åŠ¡å¤æ‚åº¦é€‰æ‹©åˆé€‚çš„æ¨¡å‹ç‰ˆæœ¬</li><li><strong>æ§åˆ¶è¾“å‡ºé•¿åº¦</strong>ï¼šè®¾ç½®æœ€å¤§ä»¤ç‰Œæ•°é™åˆ¶ï¼Œé¿å…ä¸å¿…è¦çš„è¾“å‡º</li><li><strong>ç¼“å­˜é«˜é¢‘å“åº”</strong>ï¼šå¯¹å¸¸è§é—®é¢˜çš„å›å¤è¿›è¡Œç¼“å­˜</li><li><strong>æ‰¹é‡å¤„ç†</strong>ï¼šåœ¨å…è®¸çš„æƒ…å†µä¸‹åˆå¹¶è¯·æ±‚ä»¥å‡å°‘ API è°ƒç”¨æ¬¡æ•°</li></ol><h2>æ€»ç»“ä¸é¡¹ç›®æ¨è</h2><p>æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨é€šä¹‰åƒé—®çš„ OpenAI å…¼å®¹ API æ„å»º AI èŠå¤©åº”ç”¨ã€‚è¿™ç§æ–¹æ¡ˆå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p><ul><li><strong>å¿«é€Ÿé›†æˆ</strong>ï¼šå…¼å®¹ OpenAI æ¥å£ï¼Œé™ä½è¿ç§»æˆæœ¬</li><li><strong>é«˜æ€§èƒ½</strong>ï¼šé€šä¹‰åƒé—®æ¨¡å‹å…·å¤‡å¼ºå¤§çš„ç†è§£å’Œç”Ÿæˆèƒ½åŠ›</li><li><strong>çµæ´»éƒ¨ç½²</strong>ï¼šæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼Œé€‚åº”ä¸åŒéœ€æ±‚</li><li><strong>æˆæœ¬å¯æ§</strong>ï¼šæŒ‰é‡ä»˜è´¹ï¼Œå¯æ ¹æ®é¢„ç®—çµæ´»è°ƒæ•´</li></ul><p>è¯¥æ–¹æ¡ˆç‰¹åˆ«é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p><ul><li>ä¸ªäººé¡¹ç›®å’ŒåŸå‹éªŒè¯</li><li>ä¼ä¸šå®¢æœç³»ç»Ÿ</li><li>å†…å®¹åˆ›ä½œè¾…åŠ©å·¥å…·</li><li>æ™ºèƒ½é—®ç­”ç³»ç»Ÿ</li></ul><h2>ç¤ºä¾‹é¡¹ç›®</h2><p>æœ¬æ–‡æ‰€è¿°çš„å®Œæ•´ç¤ºä¾‹é¡¹ç›®å·²å¼€æºï¼Œæ¬¢è¿å…‹éš†ã€è¿è¡Œå’Œè´¡çŒ®æ”¹è¿›ï¼š</p><p><strong>é¡¹ç›®åœ°å€</strong>:<br/><a href="https://link.segmentfault.com/?enc=vmv3Dn9KThJKYlSdOKyS2A%3D%3D.cbGhZfgEaIazwtOrwPQP3JSD4C7oIqW7nS%2BmENuPOBGwol6zACfhh5yxMf7yXXVaDp9%2FyOqSIIFXqO9teI00Sg%3D%3D" rel="nofollow" target="_blank">https://github.com/zhangjian24/llm/tree/main/qwen-chatbot</a></p><p><a href="https://link.segmentfault.com/?enc=XZjBo27A7%2Fw0FZPXZn1nKg%3D%3D.SJo5F%2BbUbEtqkUD7ieJSYSbUicvbbrStktnOPkf7a%2FarLBGLLphm1Sx1qqIvqqV71%2FvNtkE02QK4UYy0tG4IGQ%3D%3D" rel="nofollow" target="_blank">https://gitee.com/codehub/llm/tree/main/qwen-chatbot</a></p><p>é¡¹ç›®åŒ…å«å®Œæ•´çš„ Next.js å‰ç«¯ç•Œé¢ã€API è·¯ç”±ã€ç¯å¢ƒé…ç½®å’Œè¯¦ç»†æ–‡æ¡£ï¼Œå¯ç›´æ¥è¿è¡Œä½“éªŒã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘é—®æˆ–æ”¹è¿›å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issues æˆ– Pull Requestsï¼</p><p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæ‚¨å¯ä»¥å¿«é€Ÿä¸Šæ‰‹é€šä¹‰åƒé—® API çš„ä½¿ç”¨ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šå¼€å‘è‡ªå·±çš„ AI åº”ç”¨ã€‚</p>]]></description></item><item>    <title><![CDATA[åŸºäºYOLOv8çš„åœè½¦åœºç©ºè½¦ä½ç›®æ ‡æ£€æµ‹é¡¹ç›®ï½œå®Œæ•´æºç æ•°æ®é›†+PyQt5ç•Œé¢+å®Œæ•´è®­ç»ƒæµç¨‹+å¼€ç®±å³ç”¨ï¼]]></title>    <link>https://segmentfault.com/a/1190000047585154</link>    <guid>https://segmentfault.com/a/1190000047585154</guid>    <pubDate>2026-02-01 00:02:33</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <h2>åŸºäºYOLOv8çš„åœè½¦åœºç©ºè½¦ä½ç›®æ ‡æ£€æµ‹é¡¹ç›®ï½œå®Œæ•´æºç æ•°æ®é›†+PyQt5ç•Œé¢+å®Œæ•´è®­ç»ƒæµç¨‹+å¼€ç®±å³ç”¨ï¼</h2><p>æºç åŒ…å«ï¼šå®Œæ•´YOLOv8è®­ç»ƒä»£ç +æ•°æ®é›†(å¸¦æ ‡æ³¨)+æƒé‡æ–‡ä»¶+ç›´æ¥å¯å…è®¸æ£€æµ‹çš„yoloæ£€æµ‹ç¨‹åº+ç›´æ¥éƒ¨ç½²æ•™ç¨‹/è®­ç»ƒæ•™ç¨‹</p><h3>é¡¹ç›®æ‘˜è¦</h3><p>éšç€åŸå¸‚æœºåŠ¨è½¦ä¿æœ‰é‡çš„æŒç»­å¢é•¿ï¼Œâ€œæ‰¾è½¦ä½éš¾â€å·²æˆä¸ºæ™ºæ…§åŸå¸‚ä¸æ™ºæ…§äº¤é€šå»ºè®¾ä¸­çš„å…¸å‹ç—›ç‚¹é—®é¢˜ã€‚ä¼ ç»Ÿä¾èµ–äººå·¥å·¡æ£€æˆ–åœ°ç£ä¼ æ„Ÿå™¨çš„åœè½¦ç®¡ç†æ–¹å¼ï¼Œå­˜åœ¨éƒ¨ç½²æˆæœ¬é«˜ã€ç»´æŠ¤å¤æ‚ã€å®æ—¶æ€§ä¸è¶³ç­‰é—®é¢˜ï¼Œå·²éš¾ä»¥æ»¡è¶³ç°ä»£åœè½¦åœºæ™ºèƒ½åŒ–ç®¡ç†éœ€æ±‚ã€‚</p><p>æœ¬é¡¹ç›®åŸºäº <strong>YOLOv8 ç›®æ ‡æ£€æµ‹æ¨¡å‹</strong>ï¼Œæ„å»ºäº†ä¸€å¥— <strong>åœè½¦åœºç©ºè½¦ä½æ™ºèƒ½æ£€æµ‹ç³»ç»Ÿ</strong>ï¼Œå¯å¯¹ç›‘æ§ç”»é¢ä¸­çš„ <strong>å·²åœè½¦è¾†ï¼ˆOccupiedï¼‰</strong> ä¸ <strong>ç©ºè½¦ä½ï¼ˆVacantï¼‰</strong> ä¸¤ç±»ç›®æ ‡è¿›è¡Œå®æ—¶è¯†åˆ«ä¸å¯è§†åŒ–å±•ç¤ºã€‚ç³»ç»Ÿæ”¯æŒå›¾ç‰‡ã€è§†é¢‘ã€æœ¬åœ°æ–‡ä»¶å¤¹åŠå®æ—¶æ‘„åƒå¤´ç­‰å¤šç§è¾“å…¥å½¢å¼ï¼Œå¹¶é›†æˆ <strong>PyQt5 å›¾å½¢åŒ–ç•Œé¢</strong>ï¼Œå®ç°æ£€æµ‹ç»“æœçš„ç›´è§‚å±•ç¤ºä¸äº¤äº’æ“ä½œã€‚</p><p>é¡¹ç›®æä¾› <strong>å®Œæ•´å¯è¿è¡Œæºç ã€æ ‡å‡†åŒ–æ ‡æ³¨æ•°æ®é›†ã€è®­ç»ƒæƒé‡æ–‡ä»¶ä»¥åŠè¯¦ç»†è®­ç»ƒä¸éƒ¨ç½²æ–‡æ¡£</strong>ï¼Œç”¨æˆ·æ— éœ€å¤æ‚é…ç½®å³å¯å¿«é€Ÿå¤ç°æ¨¡å‹æ•ˆæœï¼Œå®ç°ä»æ¨¡å‹è®­ç»ƒåˆ°åº”ç”¨è½åœ°çš„ä¸€ç«™å¼å®è·µï¼Œé€‚ç”¨äºè¯¾ç¨‹è®¾è®¡ã€æ¯•ä¸šè®¾è®¡ã€ç§‘ç ”å®éªŒåŠæ™ºæ…§åœè½¦ç›¸å…³å·¥ç¨‹åŸå‹å¼€å‘ã€‚</p><h3>å‰è¨€</h3><p>åœ¨æ™ºæ…§äº¤é€šä¸æ™ºæ…§åŸå¸‚å¿«é€Ÿå‘å±•çš„èƒŒæ™¯ä¸‹ï¼Œåœè½¦èµ„æºçš„é«˜æ•ˆåˆ©ç”¨å·²æˆä¸ºåŸå¸‚ç®¡ç†ä¸­çš„é‡è¦è®®é¢˜ã€‚æ ¹æ®å®é™…è°ƒç ”å‘ç°ï¼Œåœè½¦åœºå†…å¾€å¾€å­˜åœ¨â€œè½¦ä½å¹¶ä¸ç´§å¼ ï¼Œä½†é©¾é©¶å‘˜éš¾ä»¥å¿«é€Ÿå®šä½ç©ºè½¦ä½â€çš„æƒ…å†µï¼Œå…¶æ ¹æœ¬åŸå› åœ¨äºç¼ºä¹å®æ—¶ã€ç²¾å‡†ã€ä½æˆæœ¬çš„è½¦ä½çŠ¶æ€æ„ŸçŸ¥æ‰‹æ®µã€‚</p><p>è¿‘å¹´æ¥ï¼Œéšç€æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰æŠ€æœ¯çš„æˆç†Ÿï¼ŒåŸºäºç›®æ ‡æ£€æµ‹çš„è§†è§‰æ„ŸçŸ¥æ–¹æ¡ˆé€æ¸æˆä¸ºæ™ºèƒ½åœè½¦é¢†åŸŸçš„é‡è¦ç ”ç©¶æ–¹å‘ã€‚å…¶ä¸­ï¼ŒYOLO ç³»åˆ—æ¨¡å‹å‡­å€Ÿ <strong>ç«¯åˆ°ç«¯ã€é€Ÿåº¦å¿«ã€ç²¾åº¦é«˜</strong> çš„ä¼˜åŠ¿ï¼Œåœ¨å®æ—¶åœºæ™¯ä¸‹è¡¨ç°å°¤ä¸ºçªå‡ºã€‚YOLOv8 ä½œä¸º Ultralytics æœ€æ–°ä¸€ä»£æ¨¡å‹ï¼Œåœ¨ç½‘ç»œç»“æ„ã€æŸå¤±å‡½æ•°ä¸è®­ç»ƒç­–ç•¥ç­‰æ–¹é¢å‡è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä¸ºå®æ—¶è½¦ä½æ£€æµ‹æä¾›äº†è‰¯å¥½çš„æŠ€æœ¯åŸºç¡€ã€‚</p><p>æœ¬é¡¹ç›®ä»¥å®é™…åœè½¦åœºç›‘æ§åœºæ™¯ä¸ºåº”ç”¨èƒŒæ™¯ï¼Œä»æ•°æ®é›†æ„å»ºã€æ¨¡å‹è®­ç»ƒã€æ¨ç†éƒ¨ç½²åˆ°å›¾å½¢åŒ–ç³»ç»Ÿé›†æˆè¿›è¡Œå®Œæ•´å®ç°ï¼ŒåŠ›æ±‚ä¸ºè¯»è€…æä¾›ä¸€ä¸ª<strong>å·¥ç¨‹å¯å¤ç°ã€é€»è¾‘æ¸…æ™°ã€å¯æ‰©å±•æ€§å¼º</strong>çš„åœè½¦åœºç©ºè½¦ä½æ£€æµ‹å®Œæ•´ç¤ºä¾‹ã€‚</p><h2>ä¸€ã€è½¯ä»¶æ ¸å¿ƒåŠŸèƒ½ä»‹ç»åŠæ•ˆæœæ¼”ç¤º</h2><h4>1. åŒç±»åˆ«è½¦ä½çŠ¶æ€æ™ºèƒ½è¯†åˆ«</h4><p>ç³»ç»ŸåŸºäº YOLOv8 æ£€æµ‹æ¨¡å‹ï¼Œå¯¹åœè½¦åœºåœºæ™¯ä¸­çš„ç›®æ ‡è¿›è¡Œç²¾å‡†è¯†åˆ«ï¼Œæ”¯æŒä»¥ä¸‹ä¸¤ç±»æ£€æµ‹ç»“æœï¼š</p><ul><li><strong>å·²åœè½¦è¾†ï¼ˆOccupiedï¼‰</strong>ï¼šè¡¨ç¤ºå½“å‰è½¦ä½å·²è¢«è½¦è¾†å ç”¨</li><li><strong>ç©ºè½¦ä½ï¼ˆVacantï¼‰</strong>ï¼šè¡¨ç¤ºå½“å‰è½¦ä½å¤„äºå¯ä½¿ç”¨çŠ¶æ€</li></ul><p>æ£€æµ‹ç»“æœä»¥ç›®æ ‡æ¡†å½¢å¼å åŠ åœ¨åŸå§‹ç”»é¢ä¸Šï¼Œå¹¶æ ‡æ³¨ç±»åˆ«åç§°ä¸ç½®ä¿¡åº¦ï¼Œå®ç°è½¦ä½çŠ¶æ€çš„ç›´è§‚å¯è§†åŒ–ã€‚</p><hr/><h4>2. å¤šè¾“å…¥æºæ£€æµ‹æ¨¡å¼æ”¯æŒ</h4><p>ç³»ç»Ÿæ”¯æŒå¤šç§å¸¸è§è¾“å…¥æ–¹å¼ï¼Œé€‚é…ä¸åŒä½¿ç”¨åœºæ™¯ï¼š</p><ul><li><strong>å•å¼ å›¾ç‰‡æ£€æµ‹</strong>ï¼šé€‚åˆæ•°æ®åˆ†æä¸æ•ˆæœéªŒè¯</li><li><strong>å›¾ç‰‡æ–‡ä»¶å¤¹æ‰¹é‡æ£€æµ‹</strong>ï¼šç”¨äºæ•°æ®é›†å¿«é€Ÿè¯„ä¼°</li><li><strong>æœ¬åœ°è§†é¢‘æ–‡ä»¶æ£€æµ‹</strong>ï¼šæ¨¡æ‹ŸçœŸå®ç›‘æ§å½•åƒåˆ†æ</li><li><strong>å®æ—¶æ‘„åƒå¤´æ£€æµ‹</strong>ï¼šæ»¡è¶³å®æ—¶åœè½¦åœºç›‘æ§éœ€æ±‚</li></ul><p>ç”¨æˆ·å¯é€šè¿‡ PyQt5 å›¾å½¢ç•Œé¢ä¸€é”®åˆ‡æ¢æ£€æµ‹æ¨¡å¼ï¼Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚</p><hr/><h4>3. PyQt5 å›¾å½¢åŒ–ç•Œé¢ï¼ˆGUIï¼‰</h4><p>ä¸ºæå‡ç³»ç»Ÿæ˜“ç”¨æ€§ï¼Œé¡¹ç›®åŸºäº PyQt5 æ„å»ºäº†å®Œæ•´çš„æ¡Œé¢ç«¯å¯è§†åŒ–ç•Œé¢ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ul><li>æ¨¡å‹åŠ è½½ä¸æƒé‡åˆ‡æ¢</li><li>è¾“å…¥æºé€‰æ‹©ï¼ˆå›¾ç‰‡ / è§†é¢‘ / æ‘„åƒå¤´ï¼‰</li><li>å®æ—¶æ£€æµ‹ç”»é¢æ˜¾ç¤º</li><li>æ£€æµ‹ç»“æœçŠ¶æ€æç¤ºä¸æ—¥å¿—è¾“å‡º</li></ul><p>å³ä½¿ä¸å…·å¤‡æ·±åº¦å­¦ä¹ èƒŒæ™¯çš„ç”¨æˆ·ï¼Œä¹Ÿå¯é€šè¿‡ç•Œé¢å®Œæˆæ¨¡å‹æ¨ç†ä¸æ•ˆæœæ¼”ç¤ºã€‚</p><hr/><h4>4. å®Œæ•´è®­ç»ƒæµç¨‹ä¸å¯å¤ç°æ€§ä¿éšœ</h4><p>é¡¹ç›®ä¸ä»…æä¾›æ¨ç†ç¨‹åºï¼ŒåŒæ—¶å®Œæ•´ä¿ç•™äº† YOLOv8 çš„è®­ç»ƒæµç¨‹ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>æ ‡å‡† YOLO æ ¼å¼æ•°æ®é›†ï¼ˆimages / labels ç»“æ„æ¸…æ™°ï¼‰</li><li>è®­ç»ƒé…ç½®æ–‡ä»¶ï¼ˆç±»åˆ«æ•°ã€ç±»åˆ«åç§°ã€è·¯å¾„é…ç½®ï¼‰</li><li>æ¨¡å‹è®­ç»ƒã€éªŒè¯ä¸æµ‹è¯•è„šæœ¬</li><li>è®­ç»ƒç»“æœåˆ†æä¸æƒé‡æ–‡ä»¶å¯¼å‡º</li></ul><p>ç”¨æˆ·å¯åœ¨ç°æœ‰æ•°æ®é›†åŸºç¡€ä¸Šè¿›è¡ŒäºŒæ¬¡è®­ç»ƒæˆ–æ‰©å±•æ–°åœºæ™¯ï¼Œå…·å¤‡è‰¯å¥½çš„å·¥ç¨‹å¤ç”¨ä»·å€¼ã€‚</p><hr/><h4>5. å®é™…æ£€æµ‹æ•ˆæœè¯´æ˜</h4><p>åœ¨å…¸å‹åœè½¦åœºç›‘æ§ç”»é¢ä¸­ï¼Œç³»ç»Ÿèƒ½å¤Ÿåœ¨å¤æ‚å…‰ç…§ã€ä¸åŒæ‹æ‘„è§’åº¦åŠå¤šè½¦ä½å¯†é›†åœºæ™¯ä¸‹ï¼Œç¨³å®šè¯†åˆ«ç©ºè½¦ä½ä¸å·²åœè½¦è¾†çŠ¶æ€ï¼Œå…·å¤‡è¾ƒå¼ºçš„é²æ£’æ€§ä¸å®æ—¶æ€§ï¼Œæ»¡è¶³å®é™…å·¥ç¨‹åº”ç”¨å¯¹å‡†ç¡®ç‡ä¸æ¨ç†é€Ÿåº¦çš„åŸºæœ¬è¦æ±‚ã€‚</p><h2>äºŒã€è½¯ä»¶æ•ˆæœæ¼”ç¤º</h2><p>ä¸ºäº†ç›´è§‚å±•ç¤ºæœ¬ç³»ç»ŸåŸºäº YOLOv8 æ¨¡å‹çš„æ£€æµ‹èƒ½åŠ›ï¼Œæˆ‘ä»¬è®¾è®¡äº†å¤šç§æ“ä½œåœºæ™¯ï¼Œæ¶µç›–é™æ€å›¾ç‰‡ã€æ‰¹é‡å›¾ç‰‡ã€è§†é¢‘ä»¥åŠå®æ—¶æ‘„åƒå¤´æµçš„æ£€æµ‹æ¼”ç¤ºã€‚</p><h3>ï¼ˆ1ï¼‰å•å›¾ç‰‡æ£€æµ‹æ¼”ç¤º</h3><p>ç”¨æˆ·ç‚¹å‡»â€œé€‰æ‹©å›¾ç‰‡â€ï¼Œå³å¯åŠ è½½æœ¬åœ°å›¾åƒå¹¶æ‰§è¡Œæ£€æµ‹ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585156" alt="image-20260113001101039" title="image-20260113001101039"/></p><hr/><h3>ï¼ˆ2ï¼‰å¤šæ–‡ä»¶å¤¹å›¾ç‰‡æ£€æµ‹æ¼”ç¤º</h3><p>ç”¨æˆ·å¯é€‰æ‹©åŒ…å«å¤šå¼ å›¾åƒçš„æ–‡ä»¶å¤¹ï¼Œç³»ç»Ÿä¼šæ‰¹é‡æ£€æµ‹å¹¶ç”Ÿæˆç»“æœå›¾ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585157" alt="image-20260113001137464" title="image-20260113001137464" loading="lazy"/></p><hr/><h3>ï¼ˆ3ï¼‰è§†é¢‘æ£€æµ‹æ¼”ç¤º</h3><p>æ”¯æŒä¸Šä¼ è§†é¢‘æ–‡ä»¶ï¼Œç³»ç»Ÿä¼šé€å¸§å¤„ç†å¹¶ç”Ÿæˆç›®æ ‡æ£€æµ‹ç»“æœï¼Œå¯é€‰ä¿å­˜è¾“å‡ºè§†é¢‘ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585158" alt="image-20260113001152857" title="image-20260113001152857" loading="lazy"/></p><hr/><h3>ï¼ˆ4ï¼‰æ‘„åƒå¤´æ£€æµ‹æ¼”ç¤º</h3><p>å®æ—¶æ£€æµ‹æ˜¯ç³»ç»Ÿä¸­çš„æ ¸å¿ƒåº”ç”¨ä¹‹ä¸€ï¼Œç³»ç»Ÿå¯ç›´æ¥è°ƒç”¨æ‘„åƒå¤´è¿›è¡Œæ£€æµ‹ã€‚ç”±äºåŸç†å’Œè§†é¢‘æ£€æµ‹ç›¸åŒï¼Œå°±ä¸é‡å¤æ¼”ç¤ºäº†ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585159" alt="image-20260113001202609" title="image-20260113001202609" loading="lazy"/></p><hr/><h3>ï¼ˆ5ï¼‰ä¿å­˜å›¾ç‰‡ä¸è§†é¢‘æ£€æµ‹ç»“æœ</h3><p>ç”¨æˆ·å¯é€šè¿‡æŒ‰é’®å‹¾é€‰æ˜¯å¦ä¿å­˜æ£€æµ‹ç»“æœï¼Œæ‰€æœ‰æ£€æµ‹å›¾åƒè‡ªåŠ¨åŠ æ¡†æ ‡æ³¨å¹¶ä¿å­˜è‡³æŒ‡å®šæ–‡ä»¶å¤¹ï¼Œæ”¯æŒåç»­æ•°æ®åˆ†æä¸å¤å®¡ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585160" alt="image-20260113001226309" title="image-20260113001226309" loading="lazy"/></p><h2>ä¸‰ã€æ¨¡å‹çš„è®­ç»ƒã€è¯„ä¼°ä¸æ¨ç†</h2><p>YOLOv8æ˜¯Ultralyticså…¬å¸å‘å¸ƒçš„æ–°ä¸€ä»£ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œé‡‡ç”¨æ›´è½»é‡çš„æ¶æ„ã€æ›´å…ˆè¿›çš„æŸå¤±å‡½æ•°ï¼ˆå¦‚CIoUã€TaskAlignedAssignerï¼‰ä¸Anchor-Freeç­–ç•¥ï¼Œåœ¨COCOç­‰æ•°æ®é›†ä¸Šè¡¨ç°ä¼˜å¼‚ã€‚<br/> å…¶æ ¸å¿ƒä¼˜åŠ¿å¦‚ä¸‹ï¼š</p><ul><li>é«˜é€Ÿæ¨ç†ï¼Œé€‚åˆå®æ—¶æ£€æµ‹ä»»åŠ¡</li><li>æ”¯æŒAnchor-Freeæ£€æµ‹</li><li>æ”¯æŒå¯æ‰©å±•çš„Backboneå’ŒNeckç»“æ„</li><li>åŸç”Ÿæ”¯æŒONNXå¯¼å‡ºä¸éƒ¨ç½²</li></ul><h3>3.1 YOLOv8çš„åŸºæœ¬åŸç†</h3><p>YOLOv8 æ˜¯ Ultralytics å‘å¸ƒçš„æ–°ä¸€ä»£å®æ—¶ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œå…·å¤‡å¦‚ä¸‹ä¼˜åŠ¿ï¼š</p><ul><li><strong>é€Ÿåº¦å¿«</strong>ï¼šæ¨ç†é€Ÿåº¦æå‡æ˜æ˜¾ï¼›</li><li><strong>å‡†ç¡®ç‡é«˜</strong>ï¼šæ”¯æŒ Anchor-Free æ¶æ„ï¼›</li><li><strong>æ”¯æŒåˆ†ç±»/æ£€æµ‹/åˆ†å‰²/å§¿æ€å¤šä»»åŠ¡</strong>ï¼›</li><li>æœ¬é¡¹ç›®ä½¿ç”¨ YOLOv8 çš„ Detection åˆ†æ”¯ï¼Œè®­ç»ƒæ—¶æ¯ç±»è¡¨æƒ…å‡æ ‡æ³¨ä¸ºç‹¬ç«‹ç›®æ ‡ã€‚</li></ul><p>YOLOv8 ç”±Ultralytics äº 2023 å¹´ 1 æœˆ 10 æ—¥å‘å¸ƒï¼Œåœ¨å‡†ç¡®æ€§å’Œé€Ÿåº¦æ–¹é¢å…·æœ‰å°–ç«¯æ€§èƒ½ã€‚åœ¨ä»¥å¾€YOLO ç‰ˆæœ¬çš„åŸºç¡€ä¸Šï¼ŒYOLOv8 å¼•å…¥äº†æ–°çš„åŠŸèƒ½å’Œä¼˜åŒ–ï¼Œä½¿å…¶æˆä¸ºå¹¿æ³›åº”ç”¨ä¸­å„ç§ç‰©ä½“æ£€æµ‹ä»»åŠ¡çš„ç†æƒ³é€‰æ‹©ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585161" alt="image-20250526165954475" title="image-20250526165954475" loading="lazy"/></p><p>YOLOv8åŸç†å›¾å¦‚ä¸‹ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585162" alt="image-20250526170118103" title="image-20250526170118103" loading="lazy"/></p><h3>3.2 æ•°æ®é›†å‡†å¤‡ä¸è®­ç»ƒ</h3><p>é‡‡ç”¨ YOLO æ ¼å¼çš„æ•°æ®é›†ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code class="kotlin">dataset/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ train/
â”‚   â””â”€â”€ val/
â”œâ”€â”€ labels/
â”‚   â”œâ”€â”€ train/
â”‚   â””â”€â”€ val/</code></pre><p>æ¯å¼ å›¾åƒæœ‰å¯¹åº”çš„ <code>.txt</code> æ–‡ä»¶ï¼Œå†…å®¹æ ¼å¼ä¸ºï¼š</p><pre><code class="bash">4 0.5096721233576642 0.352838390077821 0.3947600423357664 0.31825755058365757</code></pre><p>åˆ†ç±»åŒ…æ‹¬ï¼ˆå¯è‡ªå®šä¹‰ï¼‰ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585163" alt="image-20260113001330533" title="image-20260113001330533" loading="lazy"/></p><h3>3.3. è®­ç»ƒç»“æœè¯„ä¼°</h3><p>è®­ç»ƒå®Œæˆåï¼Œå°†åœ¨ <code>runs/detect/train</code> ç›®å½•ç”Ÿæˆç»“æœæ–‡ä»¶ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><code>results.png</code>ï¼šæŸå¤±æ›²çº¿å’Œ mAP æ›²çº¿ï¼›</li><li><code>weights/best.pt</code>ï¼šæœ€ä½³æ¨¡å‹æƒé‡ï¼›</li><li><code>confusion_matrix.png</code>ï¼šæ··æ·†çŸ©é˜µåˆ†æå›¾ã€‚</li></ul><blockquote>è‹¥ mAP@0.5 è¾¾åˆ° 90% ä»¥ä¸Šï¼Œå³å¯ç”¨äºéƒ¨ç½²ã€‚</blockquote><p>åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡è§‚å¯ŸæŸå¤±å‡½æ•°ä¸‹é™çš„æ›²çº¿æ¥è¯„ä¼°æ¨¡å‹çš„è®­ç»ƒçŠ¶æ€ã€‚YOLOv8è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¸»è¦åŒ…å«ä¸‰ç§æŸå¤±ï¼šå®šä½æŸå¤±ï¼ˆbox_lossï¼‰ã€åˆ†ç±»æŸå¤±ï¼ˆcls_lossï¼‰å’ŒåŠ¨æ€ç‰¹å¾æŸå¤±ï¼ˆdfl_lossï¼‰ã€‚è®­ç»ƒå®Œæˆåï¼Œç›¸å…³çš„è®­ç»ƒè®°å½•å’Œç»“æœæ–‡ä»¶ä¼šä¿å­˜åœ¨runs/ç›®å½•ä¸‹ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585164" alt="image-20260113001304625" title="image-20260113001304625" loading="lazy"/></p><h3>3.4æ£€æµ‹ç»“æœè¯†åˆ«</h3><p>ä½¿ç”¨ PyTorch æ¨ç†æ¥å£åŠ è½½æ¨¡å‹ï¼š</p><pre><code class="python">import cv2
from ultralytics import YOLO
import torch
from torch.serialization import safe_globals
from ultralytics.nn.tasks import DetectionModel

# åŠ å…¥å¯ä¿¡æ¨¡å‹ç»“æ„
safe_globals().add(DetectionModel)

# åŠ è½½æ¨¡å‹å¹¶æ¨ç†
model = YOLO('runs/detect/train/weights/best.pt')
results = model('test.jpg', save=True, conf=0.25)

# è·å–ä¿å­˜åçš„å›¾åƒè·¯å¾„
# é»˜è®¤ä¿å­˜åˆ° runs/detect/predict/ ç›®å½•
save_path = results[0].save_dir / results[0].path.name

# ä½¿ç”¨ OpenCV åŠ è½½å¹¶æ˜¾ç¤ºå›¾åƒ
img = cv2.imread(str(save_path))
cv2.imshow('Detection Result', img)
cv2.waitKey(0)
cv2.destroyAllWindows()
</code></pre><p>é¢„æµ‹ç»“æœåŒ…å«ç±»åˆ«ã€ç½®ä¿¡åº¦ã€è¾¹æ¡†åæ ‡ç­‰ä¿¡æ¯ã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585165" alt="image-20260113001359417" title="image-20260113001359417" loading="lazy"/></p><h2>å››.YOLOV8+YOLOUIå®Œæ•´æºç æ‰“åŒ…</h2><p>æœ¬æ–‡æ¶‰åŠåˆ°çš„å®Œæ•´å…¨éƒ¨ç¨‹åºæ–‡ä»¶ï¼šåŒ…æ‹¬<strong>pythonæºç ã€æ•°æ®é›†ã€è®­ç»ƒä»£ç ã€UIæ–‡ä»¶ã€æµ‹è¯•å›¾ç‰‡è§†é¢‘</strong>ç­‰ï¼ˆè§ä¸‹å›¾ï¼‰ï¼Œè·å–æ–¹å¼è§ã€4.2 å®Œæ•´æºç ä¸‹è½½ã€‘ï¼š</p><h3>4.1 é¡¹ç›®å¼€ç®±å³ç”¨</h3><p>ä½œè€…å·²å°†æ•´ä¸ªå·¥ç¨‹æ‰“åŒ…ã€‚åŒ…å«å·²è®­ç»ƒå®Œæˆçš„æƒé‡ï¼Œè¯»è€…å¯ä¸ç”¨è‡ªè¡Œè®­ç»ƒç›´æ¥è¿è¡Œæ£€æµ‹ã€‚</p><p>è¿è¡Œé¡¹ç›®åªéœ€è¾“å…¥ä¸‹é¢å‘½ä»¤ã€‚</p><pre><code class="bash">python main.py</code></pre><p>è¯»è€…ä¹Ÿå¯è‡ªè¡Œé…ç½®è®­ç»ƒé›†ï¼Œæˆ–ä½¿ç”¨æ‰“åŒ…å¥½çš„æ•°æ®é›†ç›´æ¥è®­ç»ƒã€‚</p><p>è‡ªè¡Œè®­ç»ƒé¡¹ç›®åªéœ€è¾“å…¥ä¸‹é¢å‘½ä»¤ã€‚</p><pre><code class="bash">yolo detect train data=datasets/expression/loopy.yaml model=yolov8n.yaml pretrained=yolov8n.pt epochs=100 batch=16 lr0=0.001</code></pre><h3>4.2 å®Œæ•´æºç </h3><p>è‡³é¡¹ç›®å®å½•è§†é¢‘ä¸‹æ–¹è·å–ï¼š<a href="https://www.bilibili.com/video/BV1kFrjBQEJv" target="_blank">https://www.bilibili.com/video/BV1kFrjBQEJv</a></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585166" alt="image-20250801135823301" title="image-20250801135823301" loading="lazy"/></p><p>åŒ…å«ï¼š</p><blockquote><p>ğŸ“¦å®Œæ•´é¡¹ç›®æºç </p><p>ğŸ“¦ é¢„è®­ç»ƒæ¨¡å‹æƒé‡</p><p>ğŸ—‚ï¸ æ•°æ®é›†åœ°å€ï¼ˆå«æ ‡æ³¨è„šæœ¬ï¼‰</p></blockquote><h2>æ€»ç»“</h2><p>æœ¬æ–‡å›´ç»• <strong>åŸºäº YOLOv8 çš„åœè½¦åœºç©ºè½¦ä½ç›®æ ‡æ£€æµ‹ç³»ç»Ÿ</strong>ï¼Œä»åº”ç”¨èƒŒæ™¯ã€æŠ€æœ¯é€‰å‹åˆ°ç³»ç»Ÿå®ç°è¿›è¡Œäº†å®Œæ•´ä»‹ç»ã€‚é¡¹ç›®ä»¥åœè½¦åœºå®é™…ç›‘æ§åœºæ™¯ä¸ºå‡ºå‘ç‚¹ï¼Œé‡‡ç”¨ YOLOv8 ä½œä¸ºæ ¸å¿ƒæ£€æµ‹æ¨¡å‹ï¼Œå®ç°äº†å¯¹ <strong>å·²åœè½¦è¾†</strong> ä¸ <strong>ç©ºè½¦ä½</strong> ä¸¤ç±»ç›®æ ‡çš„é«˜æ•ˆè¯†åˆ«ï¼Œå¹¶é€šè¿‡ PyQt5 å›¾å½¢åŒ–ç•Œé¢å®Œæˆäº†æ¨¡å‹æ¨ç†ç»“æœçš„å¯è§†åŒ–ä¸äº¤äº’æ“ä½œã€‚</p><p>ä»å·¥ç¨‹å®ç°è§’åº¦æ¥çœ‹ï¼Œé¡¹ç›®ä¸ä»…å…·å¤‡è‰¯å¥½çš„æ£€æµ‹ç²¾åº¦ä¸å®æ—¶æ€§èƒ½ï¼ŒåŒæ—¶åœ¨ç³»ç»Ÿç»“æ„è®¾è®¡ä¸Šå¼ºè°ƒå¯å¤ç°æ€§ä¸å¯æ‰©å±•æ€§ï¼Œå®Œæ•´æä¾›äº†æ•°æ®é›†ã€è®­ç»ƒè„šæœ¬ã€æƒé‡æ–‡ä»¶åŠéƒ¨ç½²æµç¨‹è¯´æ˜ï¼Œé™ä½äº†ç›®æ ‡æ£€æµ‹é¡¹ç›®ä»ç®—æ³•éªŒè¯åˆ°å®é™…è½åœ°çš„é—¨æ§›ã€‚æ— è®ºæ˜¯ä½œä¸ºæ·±åº¦å­¦ä¹ å…¥é—¨å®è·µã€è¯¾ç¨‹è®¾è®¡ä¸æ¯•ä¸šè®¾è®¡é€‰é¢˜ï¼Œè¿˜æ˜¯æ™ºæ…§åœè½¦ä¸æ™ºèƒ½äº¤é€šç›¸å…³åº”ç”¨çš„åŸå‹ç³»ç»Ÿï¼Œè¯¥é¡¹ç›®éƒ½å…·æœ‰è¾ƒé«˜çš„å‚è€ƒä»·å€¼ã€‚</p><p>åç»­å¯åœ¨æ­¤åŸºç¡€ä¸Šè¿›ä¸€æ­¥æ‹“å±•è½¦ä½ç¼–å·ç»‘å®šã€ç©ºä½ç»Ÿè®¡åˆ†æã€å¤šæ‘„åƒå¤´ååŒæ„ŸçŸ¥åŠä¸åœè½¦ç®¡ç†ç³»ç»Ÿçš„æ•°æ®å¯¹æ¥ç­‰åŠŸèƒ½ï¼Œä¸ºæ™ºæ…§åœè½¦åœºæ™¯æä¾›æ›´åŠ å®Œå–„å’Œå·¥ç¨‹åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚</p>]]></description></item><item>    <title><![CDATA[æ™ºèƒ½ä½“æ¥äº†ä» 0 åˆ° 1ï¼šå·¥ä½œæµåœ¨æ™ºèƒ½ä½“ç³»ç»Ÿä¸­çš„çœŸå®ä½œç”¨ ä½ çš„æ©™æ¥å•¦ ]]></title>    <link>https://segmentfault.com/a/1190000047585193</link>    <guid>https://segmentfault.com/a/1190000047585193</guid>    <pubDate>2026-02-01 00:02:03</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>åœ¨ç”Ÿæˆå¼ AI çš„æ—©æœŸå®è·µä¸­ï¼Œå¼€å‘è€…å¾€å¾€å°†å¤§è¯­è¨€æ¨¡å‹è§†ä¸ºä¸€ä¸ªé«˜åº¦é€šç”¨çš„æ¨ç†å¼•æ“ï¼ŒæœŸæœ›é€šè¿‡ä¸æ–­ä¼˜åŒ– Prompt æ¥è¦†ç›–å¤æ‚ä¸šåŠ¡éœ€æ±‚ã€‚ä½†éšç€åº”ç”¨åœºæ™¯èµ°å‘çœŸå®ç”Ÿäº§ç¯å¢ƒï¼Œè¿™ç§â€œå•ç‚¹è°ƒç”¨â€çš„æ¨¡å¼é€æ¸æš´éœ²å‡ºç¨³å®šæ€§ä¸å¯æ§æ€§ä¸è¶³çš„é—®é¢˜ã€‚</p><p>åœ¨è¡Œä¸šå®è·µä¸­ï¼Œä¸€ä¸ªå…±è¯†æ­£åœ¨å½¢æˆï¼šçœŸæ­£è®©ç³»ç»Ÿå®Œæˆä»æ¨¡å‹èƒ½åŠ›åˆ°å·¥ç¨‹èƒ½åŠ›è·ƒè¿çš„ï¼Œä¸æ˜¯æ›´å¤§çš„å‚æ•°è§„æ¨¡ï¼Œè€Œæ˜¯å·¥ä½œæµï¼ˆWorkflowï¼‰çš„å¼•å…¥ã€‚æ™ºèƒ½ä½“æ¥äº†ï¼Œå¹¶ä¸æ„å‘³ç€æ¨¡å‹æ›´èªæ˜äº†ï¼Œè€Œæ˜¯ç³»ç»Ÿå¼€å§‹å…·å¤‡ç»“æ„åŒ–æ‰§è¡Œå¤æ‚ä»»åŠ¡çš„èƒ½åŠ›ã€‚</p><h2>ä¸€ã€å·¥ä½œæµçš„æ ¸å¿ƒå®šä½ï¼šå°†ä¸ç¡®å®šæ€§æ”¶æ•›ä¸ºå¯æ‰§è¡Œè·¯å¾„</h2><p>åœ¨æ™ºèƒ½ä½“ç³»ç»Ÿä¸­ï¼Œå·¥ä½œæµå¹¶ä¸æ˜¯ç®€å•çš„æ­¥éª¤åˆ—è¡¨ï¼Œè€Œæ˜¯ä¸€ç§<strong>å¯¹å¤æ‚ç›®æ ‡çš„ç»“æ„åŒ–æ‹†è§£æœºåˆ¶</strong>ã€‚</p><p><strong>ä»ç³»ç»Ÿè§†è§’çœ‹ï¼Œå·¥ä½œæµçš„æ ¸å¿ƒä½œç”¨æ˜¯ï¼š</strong></p><ul><li>å°†å¼€æ”¾å¼ç›®æ ‡æ‹†è§£ä¸ºä¸€ç»„å¯éªŒè¯çš„åŸå­ä»»åŠ¡</li><li>ç”¨æœ‰å‘é€»è¾‘å…³ç³»æ˜ç¡®ä»»åŠ¡ä¹‹é—´çš„ä¾èµ–ä¸é¡ºåº</li><li>ä¸ºæ¨¡å‹çš„æ¦‚ç‡è¾“å‡ºæä¾›ç¡®å®šæ€§çš„æ‰§è¡Œè¾¹ç•Œ</li></ul><p>æ¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªæ˜ç¡®èŒè´£çš„æ“ä½œå•å…ƒï¼Œä¾‹å¦‚ä¿¡æ¯æ£€ç´¢ã€è§„åˆ™åˆ¤æ–­ã€ç»“æ„åŒ–ç”Ÿæˆæˆ–ç»“æœæ ¡éªŒï¼›èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ï¼Œåˆ™å®šä¹‰äº†æ•°æ®å¦‚ä½•æµè½¬ã€çŠ¶æ€å¦‚ä½•è¿ç§»ã€‚</p><p>è¿™ç§è®¾è®¡çš„æœ¬è´¨ï¼Œæ˜¯ä¸ºå¤§æ¨¡å‹å¼•å…¥â€œå·¥ç¨‹æŠ¤æ â€ï¼Œé¿å…å…¶åœ¨é•¿é“¾è·¯ä»»åŠ¡ä¸­å› è¯­ä¹‰æ¼‚ç§»è€Œå¤±æ§ã€‚</p><hr/><h2>äºŒã€å·¥ä½œæµåœ¨æ™ºèƒ½ä½“ç³»ç»Ÿä¸­çš„ä¸‰ç±»å…³é”®è§’è‰²</h2><h2>1. é€»è¾‘ç¼–æ’å±‚ï¼šå¤æ‚ä»»åŠ¡çš„æ‰§è¡Œéª¨æ¶</h2><p>å•æ¬¡æ¨¡å‹è°ƒç”¨éš¾ä»¥ç¨³å®šå®Œæˆå¤šé˜¶æ®µä»»åŠ¡ã€‚å·¥ä½œæµé€šè¿‡æ˜¾å¼çš„æ§åˆ¶ç»“æ„ï¼Œä½¿ä»»åŠ¡å…·å¤‡å¯é¢„æµ‹çš„æ‰§è¡Œè·¯å¾„ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><strong>æ¡ä»¶åˆ†æ”¯</strong>ï¼šæ ¹æ®ä¸­é—´ç»“æœå†³å®šåç»­æµç¨‹èµ°å‘</li><li><strong>å¾ªç¯ä¸å›é€€</strong>ï¼šåœ¨ç»“æœä¸æ»¡è¶³è¦æ±‚æ—¶è§¦å‘ä¿®æ­£æµç¨‹</li><li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šç¡®ä¿æ¯ä¸€æ­¥åŸºäºå¯è¿½æº¯çš„ç³»ç»ŸçŠ¶æ€æ‰§è¡Œ</li></ul><p>è¿™ç±»æœºåˆ¶ä½¿ç³»ç»Ÿå…·å¤‡ç±»ä¼¼â€œçŠ¶æ€æœºâ€çš„è¡Œä¸ºç‰¹å¾ï¼Œæ˜¯æ™ºèƒ½ä½“èƒ½å¤Ÿé•¿æœŸç¨³å®šè¿è¡Œçš„åŸºç¡€ã€‚</p><hr/><h2>2. èµ„æºè°ƒåº¦å±‚ï¼šå·¥å…·è°ƒç”¨çš„ç»„ç»‡ä¸­æ¢</h2><p>åœ¨çœŸå®ä¸šåŠ¡ä¸­ï¼Œæ™ºèƒ½ä½“éœ€è¦é¢‘ç¹è°ƒç”¨å¤–éƒ¨èµ„æºï¼Œå¦‚æ¥å£æœåŠ¡ã€æ•°æ®åº“æˆ–è®¡ç®—å·¥å…·ã€‚å·¥ä½œæµçš„ä»·å€¼åœ¨äºï¼š</p><ul><li>å°†å·¥å…·èƒ½åŠ›ä¸å…·ä½“ä»»åŠ¡èŠ‚ç‚¹ç»‘å®šï¼Œé¿å…æ— åºè°ƒç”¨</li><li>é™åˆ¶æ¯ä¸ªé˜¶æ®µå¯è§çš„å·¥å…·èŒƒå›´ï¼Œé™ä½å†³ç­–å¤æ‚åº¦</li><li>å¯¹å·¥å…·è¿”å›ç»“æœè¿›è¡Œè£å‰ªä¸ç»“æ„åŒ–ï¼Œä¿æŠ¤ä¸Šä¸‹æ–‡ç©ºé—´</li></ul><p>è¿™ç§â€œèŠ‚ç‚¹çº§å·¥å…·æŒ‚è½½â€æ¨¡å¼ï¼Œä½¿æ¨¡å‹ä¸“æ³¨äºå½“å‰é—®é¢˜ï¼Œè€Œéæ•´ä½“ç³»ç»Ÿçš„èµ„æºé€‰æ‹©ã€‚</p><hr/><h2>3. é£é™©æ§åˆ¶å±‚ï¼šé•¿é“¾è·¯è¯¯å·®çš„æ‹¦æˆªæœºåˆ¶</h2><p>éšç€ä»»åŠ¡é“¾è·¯æ‹‰é•¿ï¼Œç´¯ç§¯è¯¯å·®æˆä¸ºä¸å¯å¿½è§†çš„é—®é¢˜ã€‚å·¥ä½œæµæä¾›äº†å¤©ç„¶çš„æ§åˆ¶ç‚¹ï¼š</p><ul><li>åœ¨å…³é”®èŠ‚ç‚¹å¼•å…¥äººå·¥ç¡®è®¤ï¼Œé˜²æ­¢é”™è¯¯æ”¾å¤§</li><li>ä½¿ç”¨è‡ªåŠ¨è¯„ä¼°æ¨¡å—å¯¹ä¸­é—´ç»“æœè¿›è¡Œè´¨é‡æ‰“åˆ†</li><li>å¯¹ä¸åˆæ ¼è¾“å‡ºè§¦å‘é‡è¯•æˆ–è·¯å¾„è°ƒæ•´</li></ul><p>è¿™äº›æœºåˆ¶å…±åŒæ„æˆäº†æ™ºèƒ½ä½“ç³»ç»Ÿè¾¾åˆ°ç”Ÿäº§å¯ç”¨æ ‡å‡†çš„é‡è¦å‰æã€‚</p><hr/><h2>ä¸‰ã€ä»ç³»ç»Ÿå·¥ç¨‹è§’åº¦çœ‹å·¥ä½œæµè®¾è®¡</h2><p>æˆç†Ÿçš„æ™ºèƒ½ä½“å·¥ä½œæµå¾€å¾€ä¸æ˜¯å®Œå…¨å°é—­çš„ï¼Œè€Œæ˜¯å…·å¤‡ä¸€å®šå¼¹æ€§çš„æ··åˆç»“æ„ï¼š</p><ul><li>å¯¹é«˜é£é™©ã€é«˜åˆè§„è¦æ±‚çš„ç¯èŠ‚ï¼Œé‡‡ç”¨å›ºå®šä¸”å¯å®¡è®¡çš„æµç¨‹</li><li>å¯¹æ¢ç´¢æ€§ã€åˆ›é€ æ€§è¾ƒå¼ºçš„ä»»åŠ¡ï¼Œå…è®¸æ¨¡å‹è¿›è¡Œæœ‰é™åº¦çš„è‡ªä¸»è§„åˆ’</li></ul><p>åœ¨èŠ‚ç‚¹é€šä¿¡å±‚é¢ï¼Œé‡‡ç”¨ JSON ç­‰ç»“æ„åŒ–æ•°æ®æ ¼å¼è¿›è¡Œäº¤äº’ï¼Œå·²æˆä¸ºå·¥ç¨‹å®è·µä¸­çš„æ™®éé€‰æ‹©ã€‚è¿™ç§æ–¹å¼æ¯”è‡ªç„¶è¯­è¨€æ›´ç¨³å®šï¼Œä¹Ÿæ›´åˆ©äºè°ƒè¯•ä¸ç»´æŠ¤ã€‚</p><hr/><h2>å››ã€ç»“è¯­ï¼šæ™ºèƒ½ä½“è½åœ°çš„å…³é”®ä¸åœ¨æ¨¡å‹æœ¬èº«</h2><p>åœ¨æ™ºèƒ½ä½“ç³»ç»Ÿä¸­ï¼Œå·¥ä½œæµå¹¶éæ¨¡å‹èƒ½åŠ›çš„é™„å±é…ç½®ï¼Œè€Œæ˜¯ç³»ç»Ÿèƒ½å¤Ÿè¢«éƒ¨ç½²ã€è¢«ç»´æŠ¤ã€è¢«ä¿¡ä»»çš„æ ¸å¿ƒåŸºç¡€ã€‚</p><p><strong>è¡Œä¸šå®è·µå·²ç»åå¤éªŒè¯ï¼š</strong></p><ul><li>å·¥ä½œæµè®©æ¦‚ç‡è¾“å‡ºå…·å¤‡å·¥ç¨‹ç¡®å®šæ€§</li><li>æ¨¡å—åŒ–æµç¨‹æ˜¾è‘—æå‡ç³»ç»Ÿå¯ç»´æŠ¤æ€§</li><li>äººã€æ¨¡å‹ä¸å·¥å…·çš„åä½œæ•ˆç‡ï¼Œå–å†³äºæµç¨‹è€Œéå‚æ•°</li></ul><p>å½“ä¸šåŠ¡é€»è¾‘ä¸æ–­æ²‰æ·€ï¼Œå·¥ä½œæµæœ¬èº«å°†æ¼”åŒ–ä¸ºä¼ä¸šå†…éƒ¨æœ€å…·ä»·å€¼çš„æ•°å­—èµ„äº§ä¹‹ä¸€ã€‚</p><p>åœ¨æ™ºèƒ½ä½“ä» 0 åˆ° 1 çš„é˜¶æ®µï¼ŒçœŸæ­£çš„è®¤çŸ¥è½¬æŠ˜ç‚¹ï¼Œæ˜¯æ„è¯†åˆ°ï¼š<strong>å·¥ä½œæµè®¾è®¡çš„ä¼˜å…ˆçº§ï¼Œå¾€å¾€é«˜äºæ¨¡å‹é€‰å‹æœ¬èº«ã€‚</strong><br/>ï¼ˆ<strong>æœ¬æ–‡ç« å†…å®¹å’Œå›¾ç‰‡ç”±AIè¾…åŠ©ç”Ÿæˆ</strong>ï¼‰</p>]]></description></item><item>    <title><![CDATA[å¡ç‰‡ä¸¥æ ¼å±…ä¸­/ä¸ä¸¥æ ¼å±…ä¸­å‡åŒ€ äº‘ç«¯çš„æ—¥å­ ]]></title>    <link>https://segmentfault.com/a/1190000047188576</link>    <guid>https://segmentfault.com/a/1190000047188576</guid>    <pubDate>2026-02-01 00:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>1.å¡ç‰‡ä¸¥æ ¼å±…ä¸­ï¼ˆä¸è€ƒè™‘å°å±å¹•ç¬”è®°æœ¬ï¼‰<br/><img width="723" height="349" referrerpolicy="no-referrer" src="/img/bVdl93N" alt="image.png" title="image.png"/></p><p>æ•´ä½“çˆ¶ç›’å­å±…ä¸­<br/>6ä¸ªå­divï¼Œ æ¯ä¸ªå®½åº¦å†…å®¹è‡ªé€‚åº”ï¼Œ marigin-righté—´éš”å›ºå®š</p><p>2.ä¸ç”¨ä¸¥æ ¼å±…ä¸­ï¼Œ å°±displayï¼šflexï¼Œ  æ¯ä¸ªå­div  flex:1<br/><img width="723" height="355" referrerpolicy="no-referrer" src="/img/bVdl93P" alt="image.png" title="image.png" loading="lazy"/><br/><img width="723" height="351" referrerpolicy="no-referrer" src="/img/bVdl93S" alt="image.png" title="image.png" loading="lazy"/><br/>è€ƒè™‘åˆ†è¾¨ç‡ç¬”è®°æœ¬ï¼Œ å°±ç”¨el-colçš„spanå€¼å˜åŒ–</p>]]></description></item><item>    <title><![CDATA[ç”¨ PyTorch å®ç° LLM-JEPAï¼šä¸é¢„æµ‹ tokenï¼Œé¢„æµ‹åµŒå…¥ æœ¬æ–‡ç³»è½¬è½½ï¼Œé˜…è¯»åŸæ–‡
ht]]></title>    <link>https://segmentfault.com/a/1190000047585095</link>    <guid>https://segmentfault.com/a/1190000047585095</guid>    <pubDate>2026-01-31 22:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>è¿™ç¯‡æ–‡ç« ä»å¤´å®ç° LLM-JEPA: Large Language Models Meet Joint Embedding Predictive Architecturesã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™é‡Œå†™çš„æ˜¯ä¸€ä¸ªç®€æ´çš„æœ€å°åŒ–è®­ç»ƒè„šæœ¬ï¼Œç›®æ ‡æ˜¯äº†è§£ JEPA çš„æœ¬è´¨ï¼šå¯¹åŒä¸€æ–‡æœ¬åˆ›å»ºä¸¤ä¸ªè§†å›¾ï¼Œé¢„æµ‹è¢«é®è”½ç‰‡æ®µçš„åµŒå…¥ï¼Œç”¨è¡¨ç¤ºå¯¹é½æŸå¤±æ¥è®­ç»ƒã€‚</p><p>æœ¬æ–‡çš„ç›®æ ‡æ˜¯è®©ä½ çœŸæ­£ç†è§£è¿™å¥—æ–¹æ³•ã€‚ä»£ç ä¼šé€è¡Œè®²è§£ï¼Œæ¯ä¸ªå‡½æ•°çš„ç”¨é€”éƒ½ä¼šè§£é‡Šæ¸…æ¥šï¼Œå¹¶å’Œè®ºæ–‡çš„æ ¸å¿ƒç›´è§‰å¯¹åº”èµ·æ¥ã€‚æ¯ä¸ªä»£ç å—éƒ½ä¼šè¯¦ç»†è¯´æ˜ï¼Œæ–¹ä¾¿ä½ æ ¹æ®è‡ªå·±çš„å®éªŒéœ€æ±‚è¿›è¡Œä¿®æ”¹ã€‚<br/><img referrerpolicy="no-referrer" src="/img/remote/1460000047585097" alt="" title=""/></p><h2>ä»£ç </h2><p>æ•´ä¸ª LLM-JEPA è®­ç»ƒè„šæœ¬æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œï¼š</p><p>å®ƒæ¥æ”¶åŸå§‹æ–‡æœ¬ç„¶ååˆ›å»ºä¸¤ä¸ªè§†å›¾ï¼šcontext è§†å›¾æŠŠæŸäº›ç‰‡æ®µæ›¿æ¢æˆ [MASK]ï¼Œtarget è§†å›¾ä¿ç•™åŸå§‹æ–‡æœ¬ä½†åªåœ¨è¢«é®è”½ä½ç½®åšç›‘ç£ã€‚Context ç¼–ç å™¨æ˜¯å¯è®­ç»ƒçš„ï¼Œè´Ÿè´£é¢„æµ‹ target ç¼–ç å™¨åœ¨é®è”½ä½ç½®çš„è¡¨ç¤ºã€‚Target ç¼–ç å™¨åˆ™æ˜¯ context ç¼–ç å™¨çš„ EMA å‰¯æœ¬ï¼Œä¸å‚ä¸æ¢¯åº¦è®¡ç®—ã€‚æŸå¤±å‡½æ•°ç”¨çš„æ˜¯é¢„æµ‹åµŒå…¥å’Œç›®æ ‡åµŒå…¥ä¹‹é—´çš„ä½™å¼¦è·ç¦»ã€‚</p><p>è¿è¡Œç¤ºä¾‹ï¼š</p><pre><code> # å°å‹å†’çƒŸæµ‹è¯•ï¼ˆæ— éœ€ä¸‹è½½ï¼Œéšæœºåˆå§‹åŒ–ï¼‰
python llm_jepa_train.py --smoke_test

# ä½¿ç”¨ HF æ¨¡å‹éª¨å¹²è®­ç»ƒ
python llm_jepa_train.py --model_name distilbert-base-uncased --steps 200 --batch_size 8

# åœ¨è‡ªå·±çš„æ–‡æœ¬æ–‡ä»¶ä¸Šè®­ç»ƒ
 python llm_jepa_train.py --model_name distilbert-base-uncased --text_file data.txt --steps 2000</code></pre><p>è¿™æ˜¯ä¸€ä¸ªç®€æ´çš„å‚è€ƒå®ç°ï¼Œä¸æ˜¯å®Œæ•´çš„ä»“åº“ä»£ç ã€‚ç¼–ç å™¨ç”¨çš„æ˜¯ Transformers åº“ã€‚</p><pre><code> import argparse  
import math  
import os  
import random  
from dataclasses import dataclass  
from typing import List, Tuple, Optional  

import torch  
import torch.nn as nn  
import torch.nn.functional as F  
from torch.utils.data import Dataset, DataLoader  

try:  
    from transformers import AutoTokenizer, AutoModel, AutoConfig  
except Exception:  
    AutoTokenizer = None  
    AutoModel = None  
    AutoConfig = None

# -----------------------------  
# Utilities  
# -----------------------------  
def set_seed(seed: int):  
    random.seed(seed)  
    torch.manual_seed(seed)  
    torch.cuda.manual_seed_all(seed)

def pick_device(device_str: str) -&gt; torch.device:  
    if device_str == "auto":  
        return torch.device("cuda" if torch.cuda.is_available() else "cpu")  
    return torch.device(device_str)

# -----------------------------  
# Span masking (simple + effective)  
# -----------------------------  
def sample_span_mask(  
    seq_len: int,  
    mask_ratio: float,  
    mean_span_len: int,  
    special_positions: Optional[set] = None,  
) -&gt; torch.BoolTensor:  
    """  
    Returns a boolean mask of length seq_len indicating which positions are masked.  
    We mask contiguous spans until we reach approximately mask_ratio of tokens.  
    """  
    if special_positions is None:  
        special_positions = set()  

    mask = torch.zeros(seq_len, dtype=torch.bool)  
    if seq_len &lt;= 0:  
        return mask  

    target_to_mask = max(1, int(round(seq_len * mask_ratio)))  
    masked = 0  

    attempts = 0  
    max_attempts = seq_len * 4  

    while masked &lt; target_to_mask and attempts &lt; max_attempts:  
        attempts += 1  

        span_len = max(1, int(random.expovariate(1.0 / max(1, mean_span_len))))  
        span_len = min(span_len, seq_len)  

        start = random.randint(0, seq_len - 1)  
        end = min(seq_len, start + span_len)  

        span_positions = [i for i in range(start, end) if i not in special_positions]  
        if not span_positions:  
            continue  

        newly = 0  
        for i in span_positions:  
            if not mask[i]:  
                mask[i] = True  
                newly += 1  

        masked += newly  

    return mask

def apply_mask_to_input_ids(  
    input_ids: torch.LongTensor,  
    attention_mask: torch.LongTensor,  
    tokenizer,  
    mask_ratio: float,  
    mean_span_len: int,  
) -&gt; Tuple[torch.LongTensor, torch.BoolTensor]:  
    """  
    Masks spans inside non-special, non-padding tokens.  
    Returns:  
      masked_input_ids: input ids with masked tokens replaced by [MASK]  
      pred_mask: boolean mask over positions where we apply JEPA loss  
    """  
    assert input_ids.dim() == 1  
    seq_len = int(attention_mask.sum().item())  

    # Identify special token positions (CLS, SEP, etc.) in the visible region  
    special_positions = set()  
    for i in range(seq_len):  
        tid = int(input_ids[i].item())  
        if tid in {  
            tokenizer.cls_token_id,  
            tokenizer.sep_token_id,  
            tokenizer.pad_token_id,  
        }:  
            special_positions.add(i)  

    pred_mask = sample_span_mask(  
        seq_len=seq_len,  
        mask_ratio=mask_ratio,  
        mean_span_len=mean_span_len,  
        special_positions=special_positions,  
    )  

    masked_input_ids = input_ids.clone()  
    mask_token_id = tokenizer.mask_token_id  
    if mask_token_id is None:  
        raise ValueError("Tokenizer has no mask_token_id. Use a model with [MASK].")  

    # Replace masked positions with [MASK]  
    masked_input_ids[:seq_len][pred_mask] = mask_token_id  

    # pred_mask should be full length (includes pads as False)  
    full_mask = torch.zeros_like(attention_mask, dtype=torch.bool)  
    full_mask[:seq_len] = pred_mask  

    return masked_input_ids, full_mask

# -----------------------------  
# Dataset  
# -----------------------------  
class TextLinesDataset(Dataset):  
    def __init__(self, texts: List[str]):  
        self.texts = [t.strip() for t in texts if t.strip()]  

    def __len__(self) -&gt; int:  
        return len(self.texts)  

    def __getitem__(self, idx: int) -&gt; str:  
        return self.texts[idx]

def load_texts_from_file(path: str, max_lines: Optional[int] = None) -&gt; List[str]:  
    texts = []  
    with open(path, "r", encoding="utf-8") as f:  
        for i, line in enumerate(f):  
            if max_lines is not None and i &gt;= max_lines:  
                break  
            texts.append(line.rstrip("\n"))  
    return texts

def default_tiny_corpus() -&gt; List[str]:  
    return [  
        "The cat sat on the mat and looked at the window.",  
        "A quick brown fox jumps over the lazy dog.",  
        "Deep learning models can learn useful representations from raw data.",  
        "Rocket Learning builds AI tools for education in India.",  
        "Transformers use attention to mix information across tokens.",  
        "Self-supervised learning can reduce the need for labels.",  
        "JEPA trains models to predict embeddings, not tokens.",  
        "Bengaluru is a major tech hub in India.",  
        "A good system design balances simplicity and scalability.",  
        "Reading code carefully helps you understand how an idea is implemented.",  
    ]

@dataclass  
class Batch:  
    input_ids: torch.LongTensor          # [B, L]  
    attention_mask: torch.LongTensor     # [B, L]  
    masked_input_ids: torch.LongTensor   # [B, L]  
    pred_mask: torch.BoolTensor          # [B, L]  positions to compute loss on

def collate_jepa(  
    batch_texts: List[str],  
    tokenizer,  
    max_length: int,  
    mask_ratio: float,  
    mean_span_len: int,  
) -&gt; Batch:  
    toks = tokenizer(  
        batch_texts,  
        padding=True,  
        truncation=True,  
        max_length=max_length,  
        return_tensors="pt",  
    )  
    input_ids = toks["input_ids"]              # [B, L]  
    attention_mask = toks["attention_mask"]    # [B, L]  

    masked_input_ids_list = []  
    pred_mask_list = []  

    for b in range(input_ids.size(0)):  
        mi, pm = apply_mask_to_input_ids(  
            input_ids[b],  
            attention_mask[b],  
            tokenizer,  
            mask_ratio=mask_ratio,  
            mean_span_len=mean_span_len,  
        )  
        masked_input_ids_list.append(mi)  
        pred_mask_list.append(pm)  

    masked_input_ids = torch.stack(masked_input_ids_list, dim=0)  
    pred_mask = torch.stack(pred_mask_list, dim=0)  

    return Batch(  
        input_ids=input_ids,  
        attention_mask=attention_mask,  
        masked_input_ids=masked_input_ids,  
        pred_mask=pred_mask,  
    )

# -----------------------------  
# Model: Encoder + Predictor + EMA target encoder  
# -----------------------------  
class PredictorMLP(nn.Module):  
    def __init__(self, dim: int, hidden_mult: int = 4, dropout: float = 0.0):  
        super().__init__()  
        hidden = dim * hidden_mult  
        self.net = nn.Sequential(  
            nn.Linear(dim, hidden),  
            nn.GELU(),  
            nn.Dropout(dropout),  
            nn.Linear(hidden, dim),  
        )  

    def forward(self, x: torch.Tensor) -&gt; torch.Tensor:  
        return self.net(x)

class LLMJEPA(nn.Module):  
    def __init__(self, encoder: nn.Module, dim: int, ema_m: float = 0.99, pred_hidden_mult: int = 4):  
        super().__init__()  
        self.context_encoder = encoder  
        self.target_encoder = self._copy_encoder(encoder)  
        self.predictor = PredictorMLP(dim=dim, hidden_mult=pred_hidden_mult, dropout=0.0)  
        self.ema_m = ema_m  

        for p in self.target_encoder.parameters():  
            p.requires_grad = False  

    @staticmethod  
    def _copy_encoder(enc: nn.Module) -&gt; nn.Module:  
        import copy  
        return copy.deepcopy(enc)  

    @torch.no_grad()  
    def ema_update(self):  
        m = self.ema_m  
        for p_ctx, p_tgt in zip(self.context_encoder.parameters(), self.target_encoder.parameters()):  
            p_tgt.data.mul_(m).add_(p_ctx.data, alpha=(1.0 - m))  

    def forward(  
        self,  
        masked_input_ids: torch.LongTensor,  
        input_ids: torch.LongTensor,  
        attention_mask: torch.LongTensor,  
        pred_mask: torch.BoolTensor,  
    ) -&gt; torch.Tensor:  
        """  
        Returns JEPA loss (scalar).  
        We compute:  
          z_ctx = context_encoder(masked_input)  
          z_tgt = target_encoder(full input)  
          pred = predictor(z_ctx)  
          loss over positions in pred_mask  
        """  
        out_ctx = self.context_encoder(input_ids=masked_input_ids, attention_mask=attention_mask)  
        z_ctx = out_ctx.last_hidden_state  # [B, L, D]  

        with torch.no_grad():  
            out_tgt = self.target_encoder(input_ids=input_ids, attention_mask=attention_mask)  
            z_tgt = out_tgt.last_hidden_state  # [B, L, D]  

        pred = self.predictor(z_ctx)  # [B, L, D]  

        # Select masked positions  
        # pred_mask: [B, L] bool  
        masked_pred = pred[pred_mask]  # [N, D]  
        masked_tgt = z_tgt[pred_mask]  # [N, D]  

        if masked_pred.numel() == 0:  
            # Safety: if a batch ends up with no masked tokens, return zero loss  
            return pred.sum() * 0.0  

        masked_pred = F.normalize(masked_pred, dim=-1)  
        masked_tgt = F.normalize(masked_tgt, dim=-1)  

        # Cosine distance  
        loss = 1.0 - (masked_pred * masked_tgt).sum(dim=-1)  
        return loss.mean()

# -----------------------------  
# Training  
# -----------------------------  
def build_hf_encoder(model_name: str):  
    if AutoModel is None:  
        raise RuntimeError("transformers is not installed. pip install transformers")  

    config = AutoConfig.from_pretrained(model_name)  
    encoder = AutoModel.from_pretrained(model_name, config=config)  
    dim = int(config.hidden_size)  
    return encoder, dim

def build_random_encoder(vocab_size: int = 30522, dim: int = 256, layers: int = 4, heads: int = 4):  
    """  
    For smoke tests only: small Transformer encoder (random init).  
    Requires a tokenizer with vocab mapping for ids.  
    """  
    encoder_layer = nn.TransformerEncoderLayer(d_model=dim, nhead=heads, batch_first=True)  
    transformer = nn.TransformerEncoder(encoder_layer, num_layers=layers)  

    class TinyEncoder(nn.Module):  
        def __init__(self):  
            super().__init__()  
            self.emb = nn.Embedding(vocab_size, dim)  
            self.pos = nn.Embedding(512, dim)  
            self.enc = transformer  

        def forward(self, input_ids, attention_mask):  
            B, L = input_ids.shape  
            pos_ids = torch.arange(L, device=input_ids.device).unsqueeze(0).expand(B, L)  
            x = self.emb(input_ids) + self.pos(pos_ids)  

            # attention_mask: 1 for keep, 0 for pad  
            # transformer expects src_key_padding_mask: True for pad  
            pad_mask = attention_mask == 0  
            h = self.enc(x, src_key_padding_mask=pad_mask)  
            return type("Out", (), {"last_hidden_state": h})  

    return TinyEncoder(), dim

def save_checkpoint(path: str, model: LLMJEPA, optimizer: torch.optim.Optimizer, step: int):  
    os.makedirs(os.path.dirname(path), exist_ok=True)  
    torch.save(  
        {  
            "step": step,  
            "context_encoder": model.context_encoder.state_dict(),  
            "target_encoder": model.target_encoder.state_dict(),  
            "predictor": model.predictor.state_dict(),  
            "optimizer": optimizer.state_dict(),  
        },  
        path,  
    )

def main():  
    parser = argparse.ArgumentParser()  
    parser.add_argument("--model_name", type=str, default="distilbert-base-uncased", help="HF encoder backbone")  
    parser.add_argument("--text_file", type=str, default="", help="Path to a newline-separated text file")  
    parser.add_argument("--max_lines", type=int, default=50000)  
    parser.add_argument("--max_length", type=int, default=128)  
    parser.add_argument("--mask_ratio", type=float, default=0.3)  
    parser.add_argument("--mean_span_len", type=int, default=5)  
    parser.add_argument("--ema_m", type=float, default=0.99)  
    parser.add_argument("--pred_hidden_mult", type=int, default=4)  

    parser.add_argument("--batch_size", type=int, default=8)  
    parser.add_argument("--lr", type=float, default=2e-5)  
    parser.add_argument("--weight_decay", type=float, default=0.01)  
    parser.add_argument("--steps", type=int, default=500)  
    parser.add_argument("--warmup_steps", type=int, default=50)  
    parser.add_argument("--log_every", type=int, default=25)  
    parser.add_argument("--save_every", type=int, default=200)  
    parser.add_argument("--save_path", type=str, default="checkpoints/llm_jepa.pt")  

    parser.add_argument("--device", type=str, default="auto")  
    parser.add_argument("--seed", type=int, default=42)  
    parser.add_argument("--smoke_test", action="store_true", help="No downloads, tiny random encoder, tiny corpus")  
    args = parser.parse_args()  

    set_seed(args.seed)  
    device = pick_device(args.device)  

    if args.smoke_test:  
        if AutoTokenizer is None:  
            raise RuntimeError("transformers is required even for smoke_test (for tokenizer).")  
        tokenizer = AutoTokenizer.from_pretrained("distilbert-base-uncased")  
        # Ensure mask token exists  
        if tokenizer.mask_token_id is None:  
            raise ValueError("Tokenizer must support [MASK]. Use a masked LM tokenizer.")  

        texts = default_tiny_corpus()  
        ds = TextLinesDataset(texts)  

        encoder, dim = build_random_encoder(vocab_size=int(tokenizer.vocab_size), dim=256, layers=4, heads=4)  
        model = LLMJEPA(encoder=encoder, dim=dim, ema_m=0.95, pred_hidden_mult=2).to(device)  

        lr = 1e-4  
    else:  
        if AutoTokenizer is None:  
            raise RuntimeError("transformers is not installed. pip install transformers")  
        tokenizer = AutoTokenizer.from_pretrained(args.model_name)  
        if tokenizer.mask_token_id is None:  
            raise ValueError(  
                "This tokenizer has no [MASK]. Pick a masked-encoder model (BERT/DeBERTa/DistilBERT)."  
            )  

        if args.text_file:  
            texts = load_texts_from_file(args.text_file, max_lines=args.max_lines)  
        else:  
            texts = default_tiny_corpus()  

        ds = TextLinesDataset(texts)  

        encoder, dim = build_hf_encoder(args.model_name)  
        model = LLMJEPA(encoder=encoder, dim=dim, ema_m=args.ema_m, pred_hidden_mult=args.pred_hidden_mult).to(device)  

        lr = args.lr  

    # DataLoader  
    def _collate(batch_texts):  
        return collate_jepa(  
            batch_texts=batch_texts,  
            tokenizer=tokenizer,  
            max_length=args.max_length,  
            mask_ratio=args.mask_ratio,  
            mean_span_len=args.mean_span_len,  
        )  

    dl = DataLoader(ds, batch_size=args.batch_size, shuffle=True, drop_last=True, collate_fn=_collate)  

    # Optimizer  
    optimizer = torch.optim.AdamW(model.parameters(), lr=lr, weight_decay=args.weight_decay)  

    # Simple warmup + cosine schedule  
    def lr_at(step: int) -&gt; float:  
        if step &lt; args.warmup_steps:  
            return float(step + 1) / float(max(1, args.warmup_steps))  
        progress = (step - args.warmup_steps) / float(max(1, args.steps - args.warmup_steps))  
        progress = min(max(progress, 0.0), 1.0)  
        return 0.5 * (1.0 + math.cos(math.pi * progress))  

    model.train()  
    running = 0.0  
    step = 0  
    data_iter = iter(dl)  

    while step &lt; args.steps:  
        try:  
            batch = next(data_iter)  
        except StopIteration:  
            data_iter = iter(dl)  
            batch = next(data_iter)  

        # Move to device  
        input_ids = batch.input_ids.to(device)  
        attention_mask = batch.attention_mask.to(device)  
        masked_input_ids = batch.masked_input_ids.to(device)  
        pred_mask = batch.pred_mask.to(device)  

        # LR schedule  
        scale = lr_at(step)  
        for pg in optimizer.param_groups:  
            pg["lr"] = lr * scale  

        loss = model(  
            masked_input_ids=masked_input_ids,  
            input_ids=input_ids,  
            attention_mask=attention_mask,  
            pred_mask=pred_mask,  
        )  

        optimizer.zero_grad(set_to_none=True)  
        loss.backward()  
        torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)  
        optimizer.step()  

        # EMA update after optimizer step  
        model.ema_update()  

        running += float(loss.item())  
        step += 1  

        if step % args.log_every == 0:  
            avg = running / float(args.log_every)  
            running = 0.0  
            print(f"step {step:6d} | loss {avg:.4f} | lr {optimizer.param_groups[0]['lr']:.6g}")  

        if step % args.save_every == 0:  
            save_checkpoint(args.save_path, model, optimizer, step)  
            print(f"saved checkpoint to {args.save_path} at step {step}")  

    save_checkpoint(args.save_path, model, optimizer, step)  
    print(f"training done. final checkpoint: {args.save_path}")

if __name__ == "__main__":  
     main()</code></pre><h3>è¿™ä¸ªè„šæœ¬åœ¨è®­ç»ƒä»€ä¹ˆ</h3><p>è¿™æ˜¯ä¸€ä¸ªé¢å‘æ–‡æœ¬çš„ JEPA é£æ ¼è¡¨ç¤ºé¢„æµ‹å™¨ã€‚</p><p>è¾“å…¥æ™®é€šæ–‡æœ¬è¡Œï¼Œå¯¹æ¯ä¸ªæ ·æœ¬åˆ›å»ºä¸¤ä¸ªè§†å›¾ã€‚é®è”½è§†å›¾ï¼ˆcontext viewï¼‰æ˜¯åŒä¸€ä¸ªå¥å­ï¼Œä½†æŸäº› span è¢«æ›¿æ¢æˆ `[MASK]ï¼›åŸå§‹è§†å›¾ï¼ˆtarget viewï¼‰ä¿æŒåŸæ ·ï¼Œæ²¡æœ‰é®è”½ã€‚</p><p>è®­ç»ƒæµç¨‹æ˜¯è¿™æ ·çš„ï¼šé®è”½è§†å›¾è¿‡ä¸€ä¸ªå¯è®­ç»ƒçš„ context ç¼–ç å™¨ï¼ŒåŸå§‹è§†å›¾è¿‡ä¸€ä¸ªä¸å¯è®­ç»ƒçš„ target ç¼–ç å™¨ï¼Œç„¶åè®­ç»ƒä¸€ä¸ªé¢„æµ‹å™¨ï¼Œè®© context ç¼–ç å™¨çš„è¡¨ç¤ºèƒ½é¢„æµ‹ target ç¼–ç å™¨çš„è¡¨ç¤ºâ€”â€”ä½†åªåœ¨è¢«é®è”½çš„ä½ç½®ä¸Šè®¡ç®—æŸå¤±ã€‚Target ç¼–ç å™¨é€šè¿‡ EMA æ›´æ–°æ¥ä¿æŒç¨³å®šã€‚</p><p>è¿™ç§è®¾è®¡é¼“åŠ±æ¨¡å‹å­¦ä¹ "å¡«è¡¥è¯­ä¹‰"çš„è¡¨ç¤ºï¼Œè€Œä¸æ˜¯é¢„æµ‹å…·ä½“çš„ tokenã€‚</p><h2>set_seed å‡½æ•°</h2><pre><code> defset_seed(seed: int):  
     random.seed(seed)  
     torch.manual_seed(seed)  
     torch.cuda.manual_seed_all(seed)</code></pre><p>è¿™ä¸ªå‡½æ•°ç¡®ä¿è¿è¡Œå¯å¤ç°ã€‚</p><pre><code>random.seed(seed)</code></pre><p>å›ºå®š Python çš„éšæœºæ“ä½œï¼ˆspan é®è”½ä¼šç”¨åˆ°ï¼‰ï¼Œ</p><pre><code>torch.manual_seed(seed)</code></pre><p>å›ºå®š PyTorch åœ¨ CPU ä¸Šçš„éšæœºæ€§ï¼Œ</p><pre><code>torch.cuda.manual_seed_all(seed)</code></pre><p>å›ºå®š CUDA å†…æ ¸çš„éšæœºæ€§ã€‚</p><p>span é®è”½å’Œæ¨¡å‹åˆå§‹åŒ–éƒ½æ˜¯éšæœºçš„ï¼Œä¸è®¾ç§å­çš„è¯æ¯æ¬¡è·‘ç»“æœéƒ½ä¸ä¸€æ ·ã€‚</p><h2>pick_device å‡½æ•°</h2><pre><code> def pick_device(device_str: str) -&gt; torch.device:  
     if device_str == "auto":  
         return torch.device("cuda" if torch.cuda.is_available() else "cpu")  
     return torch.device(device_str)</code></pre><p>è¿”å› PyTorch è®¾å¤‡å¯¹è±¡ã€‚å¦‚æœä¼ </p><pre><code>--device auto</code></pre><p>ï¼Œæœ‰ GPU å°±ç”¨ GPUï¼Œæ²¡æœ‰å°±ç”¨ CPUã€‚ä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å®š</p><pre><code>--device cpu</code></pre><p>æˆ–</p><pre><code>--device cuda</code></pre><p>ã€‚</p><p>å¼ é‡å’Œæ¨¡å‹å¿…é¡»åœ¨åŒä¸€è®¾å¤‡ä¸Šï¼Œè¿™æ˜¯åŸºæœ¬è¦æ±‚ã€‚</p><h2>sample_span_mask å‡½æ•°</h2><pre><code> def sample_span_mask(seq_len, mask_ratio, mean_span_len, special_positions=None)</code></pre><p>æ•´ä¸ªè„šæœ¬é‡Œæœ€é‡è¦çš„å‡½æ•°ä¹‹ä¸€ã€‚</p><p>ç›®æ ‡æ˜¯åˆ›å»ºä¸€ä¸ªå¸ƒå°”æ©ç ï¼Œæ ‡è®°åºåˆ—ä¸­å“ªäº›ä½ç½®è¯¥è¢«é®è”½ã€‚å‚æ•°åŒ…æ‹¬ï¼šseq_len æ˜¯çœŸå® token æ•°é‡ï¼ˆä¸å« paddingï¼‰ï¼Œmask_ratio æ˜¯é®è”½æ¯”ä¾‹ï¼ˆæ¯”å¦‚ 0.3ï¼‰ï¼Œmean_span_len æ˜¯è¿ç»­é®è”½ span çš„å¹³å‡é•¿åº¦ï¼Œspecial_positions æ˜¯æ°¸è¿œä¸è¯¥é®è”½çš„ä½ç½®ï¼ˆCLSã€SEPã€PADï¼‰ã€‚</p><p>å†…éƒ¨é€»è¾‘æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªå…¨ False çš„æ©ç ï¼Œç„¶åè®¡ç®—éœ€è¦é®è”½å¤šå°‘ tokenï¼š</p><pre><code> target_to_mask=max(1, int(round(seq_len*mask_ratio)))</code></pre><p>å³ä½¿åºåˆ—å¾ˆçŸ­ä¹Ÿè‡³å°‘é®è”½ 1 ä¸ªã€‚</p><p>æ¥ä¸‹æ¥å¾ªç¯é‡‡æ · span ç›´åˆ°å‡‘å¤Ÿæ•°ã€‚Span é•¿åº¦ä»æŒ‡æ•°åˆ†å¸ƒé‡‡æ ·ï¼š</p><pre><code> span_len=max(1, int(random.expovariate(1.0/max(1, mean_span_len))))</code></pre><p>è¿™ä¼šäº§å‡ºå¾ˆå¤šçŸ­ span å’Œå°‘é‡é•¿ spanï¼Œæ¯”è¾ƒç¬¦åˆè‡ªç„¶åˆ†å¸ƒã€‚éšæœºé€‰ä¸€ä¸ªèµ·å§‹ä½ç½®ï¼Œè¿‡æ»¤æ‰ç‰¹æ®Š tokenï¼ŒæŠŠå‰©ä¸‹çš„ä½ç½®æ ‡è®°ä¸º Trueã€‚</p><p>é®è”½ç­–ç•¥å¯¹è¡¨ç¤ºå­¦ä¹ è´¨é‡å½±å“å¾ˆå¤§ã€‚Span é®è”½èƒ½è¿«ä½¿æ¨¡å‹ä»å‘¨å›´ä¸Šä¸‹æ–‡æ¨æ–­ç¼ºå¤±çš„è¯­ä¹‰ã€‚</p><h2>apply_mask_to_input_ids å‡½æ•°</h2><pre><code> defapply_mask_to_input_ids(input_ids, attention_mask, tokenizer, mask_ratio, mean_span_len)</code></pre><p>æ‹¿åˆ°ä¸€ä¸ªæ ·æœ¬çš„ token idsï¼Œè¾“å‡ºä¸¤ä¸ªä¸œè¥¿ï¼šmasked_input_ids æ˜¯æŠŠé®è”½ä½ç½®æ¢æˆ [MASK] åçš„ idsï¼Œpred_mask æ˜¯æ ‡è®°å“ªäº›ä½ç½®è¦ç®—æŸå¤±çš„å¸ƒå°”æ©ç ã€‚</p><p>å…ˆç®—å¯è§åºåˆ—é•¿åº¦ï¼š</p><pre><code>seq_len = int(attention_mask.sum().item())</code></pre><p>ã€‚attention_mask é‡ŒçœŸå® token æ˜¯ 1ï¼Œpadding æ˜¯ 0ã€‚</p><p>ç„¶åè¯†åˆ«ç‰¹æ®Š token ä½ç½®ï¼ŒCLS å’Œ SEP ä¸èƒ½é®è”½ï¼Œå¦åˆ™æ¨¡å‹å®¹æ˜“å‡ºé—®é¢˜ã€‚è°ƒç”¨ sample_span_mask é‡‡æ ·é®è”½ä½ç½®ï¼ŒæŠŠè¿™äº›ä½ç½®æ›¿æ¢æˆ mask_token_idï¼š</p><pre><code> masked_input_ids[:seq_len][pred_mask] =mask_token_id</code></pre><p>è¿”å›çš„ pred_mask æ˜¯å®Œæ•´é•¿åº¦çš„ï¼Œpadding ä½ç½®éƒ½æ˜¯ Falseã€‚åªåœ¨é®è”½ä½ç½®ç®— JEPA æŸå¤±ï¼Œå…¶ä»–ä½ç½®å¿½ç•¥ã€‚</p><h2>TextLinesDataset ç±»</h2><pre><code> classTextLinesDataset(Dataset):  
     def__init__(self, texts):  
         self.texts= [t.strip() fortintextsift.strip()]</code></pre><p>æç®€çš„æ•°æ®é›†å®ç°ï¼Œå­˜æ–‡æœ¬è¡Œåˆ—è¡¨ï¼Œå»æ‰ç©ºè¡Œå’Œé¦–å°¾ç©ºç™½ã€‚</p><pre><code>__len__</code></pre><p>è¿”å›è¡Œæ•°ï¼Œ</p><pre><code>__getitem__</code></pre><p>è¿”å›å•æ¡æ–‡æœ¬ã€‚</p><p>load_texts_from_file é€è¡Œè¯»æ–‡ä»¶ï¼Œå¯é™åˆ¶æœ€å¤§è¡Œæ•°ï¼Œä¼ </p><pre><code>--text_file</code></pre><p>æ—¶ç”¨ã€‚default_tiny_corpus æä¾›å†…ç½®æµ‹è¯•æ•°æ®é›†ã€‚</p><h2>Batch æ•°æ®ç±»</h2><pre><code> @dataclass  
 classBatch:  
     input_ids  
     attention_mask  
     masked_input_ids  
     pred_mask</code></pre><p>ç”¨ dataclass æ¯”è¿”å›å…ƒç»„æ¸…æ™°å¤šäº†ï¼Œä»£ç å¯è¯»æ€§å¥½ã€‚</p><h2>collate_jepa å‡½æ•°</h2><p>DataLoader åˆ›å»ºæ‰¹æ¬¡æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚è¾“å…¥æ˜¯åŸå§‹æ–‡æœ¬åˆ—è¡¨ï¼Œå…ˆç”¨ tokenizer åšåˆ†è¯ã€paddingã€æˆªæ–­ï¼š</p><pre><code> toks=tokenizer(batch_texts, padding=True, truncation=True, max_length=max_length, return_tensors="pt")</code></pre><p>äº§å‡º input_ids å’Œ attention_maskã€‚ç„¶åå¯¹æ¯ä¸ªæ ·æœ¬è°ƒ apply_mask_to_input_ids ç”Ÿæˆé®è”½ç‰ˆæœ¬å’Œ pred_maskï¼Œæœ€åå †å æˆ [B, L] å¼ é‡è¿”å› Batchã€‚</p><p>DataLoader æ˜¯é€æ ·æœ¬è¯»çš„ï¼Œä½†è®­ç»ƒéœ€è¦æ‰¹æ¬¡ã€‚æ‰¹å¤„ç†å’Œé®è”½éƒ½åœ¨è¿™é‡Œå‘ç”Ÿã€‚</p><h2>PredictorMLP ç±»</h2><p>é¢„æµ‹å™¨å¤´ï¼Œç»“æ„ç®€å•ï¼š</p><pre><code> nn.Linear(dim, hidden)  
 nn.GELU()  
 nn.Dropout()  
 nn.Linear(hidden, dim)</code></pre><p>æŠŠ context è¡¨ç¤ºæ˜ å°„åˆ° target è¡¨ç¤ºç©ºé—´ï¼Œç›¸å½“äºä¸€ä¸ªå­¦ä¹ å‡ºæ¥çš„é€‚é…å™¨ï¼Œå¸®åŠ©å¯¹é½ä¸¤è¾¹çš„åµŒå…¥ã€‚</p><h2>LLMJEPA æ¨¡å‹ç±»</h2><p>ä¸»æ¨¡å‹åŒ…è£…å™¨ï¼ŒåŒ…å«å››ä¸ªæ ¸å¿ƒéƒ¨ä»¶ï¼šcontext_encoder æ˜¯å¯è®­ç»ƒçš„ Transformer ç¼–ç å™¨ï¼Œtarget_encoder æ˜¯å®ƒçš„æ·±æ‹·è´ä½†ä¸å¯è®­ç»ƒï¼Œpredictor æ˜¯ MLPï¼Œema_m æ˜¯ EMA åŠ¨é‡å› å­ã€‚</p><p>_copy_encoder ç”¨</p><pre><code>copy.deepcopy</code></pre><p>ç¡®ä¿ target å’Œ context åˆå§‹çŠ¶æ€ä¸€è‡´ã€‚</p><p>ema_update ç¼“æ…¢æ›´æ–° target ç¼–ç å™¨æƒé‡ï¼š</p><pre><code> p_tgt=m*p_tgt+ (1-m) *p_ctx</code></pre><p>m=0.99 æ—¶ target å˜åŒ–éå¸¸æ…¢ï¼Œè¿™èƒ½ç¨³å®šè®­ç»ƒã€é™ä½è¡¨ç¤ºåå¡Œé£é™©ã€‚</p><p>forward çš„æµç¨‹ï¼šæŠŠé®è”½è§†å›¾è¿‡ context ç¼–ç å™¨ï¼ˆå¯è®­ç»ƒï¼‰ï¼ŒåŸå§‹è§†å›¾è¿‡ target ç¼–ç å™¨ï¼ˆæ— æ¢¯åº¦ï¼‰ï¼Œpredictor å¤„ç† context è¾“å‡ºï¼Œç„¶ååªå–é®è”½ä½ç½®çš„å‘é‡ï¼š</p><pre><code> masked_pred=pred[pred_mask]  # [N, D]  
 masked_tgt=z_tgt[pred_mask]  # [N, D]</code></pre><p>ä» [B, L, D] å˜æˆ [N, D]ï¼ŒN æ˜¯é®è”½ token æ€»æ•°ã€‚å½’ä¸€åŒ–åç®—ä½™å¼¦è·ç¦»ï¼š</p><pre><code> loss=1- (masked_pred*masked_tgt).sum(dim=-1)  
 returnloss.mean()</code></pre><p>å½’ä¸€åŒ–æ˜¯å› ä¸ºä½™å¼¦ç›¸ä¼¼åº¦åªçœ‹å‘é‡æ–¹å‘ï¼Œä¸çœ‹å¤§å°ã€‚</p><h2>build_hf_encoder å‡½æ•°</h2><p>åŠ è½½ Hugging Face ç¼–ç å™¨ï¼Œè¿”å›æ¨¡å‹å’Œéšè—ç»´åº¦ï¼ˆä» config.hidden_size è¯»ï¼‰ã€‚</p><h2>build_random_encoder å‡½æ•°</h2><p>å†’çƒŸæµ‹è¯•ä¸“ç”¨ï¼Œä»å¤´å»ºä¸€ä¸ªå° Transformer ç¼–ç å™¨ï¼ŒåŒ…æ‹¬åµŒå…¥å±‚ã€ä½ç½®åµŒå…¥ã€ç¼–ç å™¨å †æ ˆã€‚æ³¨æ„è¿™ä¸æ˜¯æ©ç è¯­è¨€æ¨¡å‹ï¼Œåªæ˜¯ä¸ªç¼–ç å™¨æ¶æ„ã€‚è¿”å›å¯¹è±¡å¸¦</p><pre><code>.last_hidden_state</code></pre><p>å±æ€§æ˜¯ä¸ºäº†åŒ¹é… HF è¾“å‡ºæ ¼å¼ã€‚</p><h2>æ€»ç»“</h2><p>è¿™ä¸ªå®ç°åˆ»æ„è¿½æ±‚æ¸…æ™°è€Œéå®Œæ•´ï¼Œæ‰€ä»¥æ²¡æœ‰è‡ªå®šä¹‰æ³¨æ„åŠ›æ©ç ã€å¤šè§†å›¾æ•°æ®é›†æˆ–æ··åˆç›®æ ‡ã€‚ä½†æ˜¯æŠŠå®ƒå½“å‚è€ƒå®ç°ç”¨æ˜¯éå¸¸åˆé€‚çš„ã€‚åŸå§‹ LLM-JEPA è®ºæ–‡åšå¾—æ›´æ·±å…¥ï¼ŒæŠŠ JEPA å’Œ token é¢„æµ‹ç»“åˆèµ·æ¥ï¼Œè¿˜åˆ©ç”¨äº†æ–‡æœ¬-ä»£ç è¿™æ ·çš„è‡ªç„¶é…å¯¹è§†å›¾ã€‚é‚£äº›è®¾è®¡å¯¹ä¸‹æ¸¸ä»»åŠ¡è¡¨ç°å¾ˆé‡è¦ï¼Œä½†ä¹Ÿå¢åŠ äº†å¤æ‚åº¦ï¼Œå®¹æ˜“è®©äººçœ‹ä¸æ¸…æ ¸å¿ƒæœºåˆ¶ã€‚</p><p>è®ºæ–‡ï¼š<br/><a href="https://link.segmentfault.com/?enc=0JpT3DkD8cBJabLU6JtEQA%3D%3D.vQshTpQnZC6RvSPI3%2ByziOwRiFmV8aQldC6Fr9BMIBHVQxNujMPqyvGcMrg6P4goUszayBsJmc%2F449TtNoUqBQ%3D%3D" rel="nofollow" target="_blank">https://avoid.overfit.cn/post/09eb991a93f64a83a376cdb52ac5c661</a></p><p>ä½œè€…ï¼šazhar</p>]]></description></item><item>    <title><![CDATA[Docker åˆ°åº•å˜æˆäº†ä»€ä¹ˆï¼Ÿä»â€œå®¹å™¨ä¹‹ç‹â€åˆ°â€œå¼€å‘è€…å·¥å…·ç®±+AI åŸºå»º+å®‰å…¨å…¬å¸â€çš„å¥‡å¦™æ¼‚æµ å¾æ—¥]]></title>    <link>https://segmentfault.com/a/1190000047585067</link>    <guid>https://segmentfault.com/a/1190000047585067</guid>    <pubDate>2026-01-31 21:02:19</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>æœ‰äº›æŠ€æœ¯äº§å“çš„å‘½è¿å¾ˆè®½åˆºï¼šå®ƒæˆåŠŸåˆ°æˆä¸ºâ€œåŸºç¡€è®¾æ–½â€ï¼Œç„¶åå°±å¾ˆéš¾å†é å®ƒèµšé’±ã€‚Docker å°±æ˜¯å…¸å‹æ¡ˆä¾‹â€”â€”å®¹å™¨åŒ–æ ‡å‡†è¢«å…¨è¡Œä¸šé‡‡ç”¨åï¼ŒDockerè¶Šç”¨è¶Šé¦™ï¼ŒDockerå…¬å¸åè€Œå¼€å§‹è¿›å…¥ä¸€ç§â€œæˆ‘æ˜¯è°ã€æˆ‘åœ¨å“ªã€æˆ‘å–ä»€ä¹ˆâ€çš„é•¿æœŸè¿·èŒ«æœŸã€‚</p><p>ç«™åœ¨ 2026 å¾€å›çœ‹ï¼ŒDocker çš„è·¯çº¿åƒæäº†ä¸€ä¸ªâ€œæ›¾ç»ç»Ÿæ²»æ±Ÿæ¹–çš„é«˜æ‰‹â€ï¼Œçªç„¶å‘ç°å¤§å®¶éƒ½å­¦ä¼šäº†ä»–çš„ç»æ‹›ï¼Œè¿˜å…è´¹å¼€æºæ•™ç¨‹ï¼Œäºæ˜¯åªèƒ½ä¸æ–­æ¢èµ›é“ï¼šä»ç¼–æ’ï¼Œåˆ°å¼€å‘è€…ä½“éªŒï¼Œå†åˆ° AIï¼Œå†åˆ°å®‰å…¨é•œåƒâ€¦â€¦æ¯ä¸€æ­¥å•ç‹¬çœ‹éƒ½åˆç†ï¼Œè¿èµ·æ¥å°±åƒåœ¨ç©â€œå•†ä¸šæ¨¡å¼å¤§å¯Œç¿â€ã€‚ğŸ˜…</p><p>æˆ‘ä»¬å°±æ¥èŠèŠ Docker è¿™äº›å¹´åˆ°åº•åœ¨è¿½ä»€ä¹ˆï¼Œä»¥åŠå¯¹å¼€å‘è€…æ„å‘³ç€ä»€ä¹ˆã€‚</p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047585069" alt="image" title="image"/></p><hr/><h2>1ï¼‰å½“â€œäº‹å®æ ‡å‡†â€å˜æˆâ€œå…è´¹ç©ºæ°”â€ï¼šDocker æœ€éš¾çš„ä¸æ˜¯æŠ€æœ¯ï¼Œæ˜¯æ”¶é’±ğŸ’°</h2><p>Docker æ—©å¹´è§£å†³çš„æ˜¯â€œåº”ç”¨äº¤ä»˜çš„ç»ˆæç—›ç‚¹â€ï¼šç¯å¢ƒä¸ä¸€è‡´ã€éƒ¨ç½²ä¸å¯é ã€ä¾èµ–ä¹±ã€‚å®¹å™¨æŠŠè¿™ä¸€åˆ‡æ¢³é¡ºäº†ï¼Œç”šè‡³æŠŠâ€œæ‰“åŒ…äº¤ä»˜â€çš„è¯­è¨€éƒ½ç»Ÿä¸€äº†ã€‚</p><p>é—®é¢˜ä¹Ÿæ­£å‡ºåœ¨è¿™é‡Œï¼šå½“å®¹å™¨åŒ–æˆä¸ºåŸºç¡€è®¾æ–½ï¼Œå¤§å®¶é»˜è®¤â€œå®ƒå°±åº”è¯¥å­˜åœ¨â€ï¼Œå°±åƒé»˜è®¤ TCP/IP ä¸è¯¥æ”¶è´¹ä¸€æ ·ã€‚åŸºç¡€è®¾æ–½è¶ŠæˆåŠŸï¼Œå•†ä¸šåŒ–è¶Šç—›è‹¦â€”â€”é™¤éä½ èƒ½åœ¨åŸºç¡€è®¾æ–½ä¹‹ä¸Šï¼Œå–å‡ºæ–°çš„ã€ä¸å¯æ›¿ä»£çš„ä»·å€¼ã€‚</p><p>äºæ˜¯ Docker å¼€å§‹å¯»æ‰¾â€œæ–°ä»·å€¼ç‚¹â€ã€‚</p><hr/><h2>2ï¼‰ç¼–æ’ä¹‹æˆ˜ï¼šKubernetes èµ¢äº†ï¼ŒDocker é€‰æ‹©â€œé€€ä¸€æ­¥æµ·é˜”å¤©ç©ºâ€ğŸŒŠ</h2><p>æ›¾ç» Docker ä¹Ÿæƒ³æŠŠç‰ˆå›¾æ‰©åˆ°â€œç¼–æ’â€ï¼Œè®© Swarm è·Ÿ Kubernetes æ­£é¢æ°æ‰‹è…•ã€‚ä½†ç°å®æ˜¯ï¼šK8s æˆäº†äº‹å®æ ‡å‡†ï¼Œç”Ÿæ€å’Œç¤¾åŒºåƒé›ªçƒè¶Šæ»šè¶Šå¤§ã€‚</p><p>åæ¥çš„å‰§æƒ…å¤§å®¶éƒ½çŸ¥é“ï¼šDocker æŠŠä¼ä¸šä¸šåŠ¡ï¼ˆåŒ…å«ç›¸å…³æŠ€æœ¯ä¸å®¢æˆ·èµ„äº§ï¼‰å–ç»™ Mirantisï¼ŒSwarm ä¹Ÿéšè¿™æ³¢äº¤æ˜“è¿›å…¥ Mirantis ä½“ç³»ï¼ŒDocker è‡ªå·±åˆ™æ›´èšç„¦åœ¨ Desktopã€Hubã€ä»¥åŠå¼€å‘è€…å·¥ä½œæµä¸Šã€‚</p><p>è¿™ä¸€æ­¥ä¼ é€’çš„ä¿¡å·å¾ˆæ¸…æ™°ï¼šä¸å†æ‰§ç€äºâ€œå…¨æ ˆäº‘åŸç”Ÿå¹³å°â€ï¼Œè½¬è€Œåšè‡ªå·±æœ€æ“…é•¿ã€æœ€è´´è¿‘å¼€å‘è€…çš„ç¯èŠ‚ã€‚</p><hr/><h2>3ï¼‰å¼€å‘è€…å·¥å…·è½¬å‘ï¼šScoutã€Testcontainersï¼ŒæŠŠâ€œå®‰å…¨â€å’Œâ€œæµ‹è¯•â€å¡è¿›æ—¥å¸¸å·¥ä½œæµğŸ§°</h2><p>Docker çš„â€œå¼€å‘è€…ä½“éªŒè·¯çº¿â€å…¶å®æ˜¯éå¸¸èªæ˜çš„ä¸€æ­¥ï¼šå¼€å‘è€…æ„¿æ„ä¸ºæ•ˆç‡å’Œç¡®å®šæ€§ä»˜è´¹ï¼Œå°¤å…¶æ˜¯å½“è½¯ä»¶ä¾›åº”é“¾å’Œä¾èµ–æ¼æ´è¶Šæ¥è¶Šåƒâ€œå®šæ—¶ç‚¸å¼¹â€æ—¶ã€‚</p><h3>Docker Scoutï¼šæŠŠé•œåƒâ€œæ‹†å¼€éªŒè´§â€ï¼Œé¡ºæ‰‹æŠŠä¾›åº”é“¾å®‰å…¨åšäº†</h3><p>Docker é€šè¿‡æ”¶è´­ Atomist åŠ é€Ÿè¿›å…¥è½¯ä»¶ä¾›åº”é“¾ä¸å¯è§‚æµ‹æ€§æ–¹å‘ï¼ŒéšåæŠŠèƒ½åŠ›æ²‰æ·€åˆ° Docker Scout è¿™ç±»äº§å“ä¸Šï¼šä¸åªå‘Šè¯‰ä½ é•œåƒé‡Œæœ‰ä»€ä¹ˆåŒ…ï¼Œè¿˜è¦è¿½æº¯å®ƒæ€ä¹ˆæ„å»ºã€å“ªé‡Œæœ‰æ¼æ´ã€æœ‰æ²¡æœ‰åˆè§„é£é™©ã€‚</p><h3>Testcontainersï¼šæŠŠé›†æˆæµ‹è¯•ä»â€œç„å­¦â€æ‹‰å›â€œå¯å¤ç°â€</h3><p>Docker æ”¶è´­ AtomicJarï¼ˆTestcontainers èƒŒåçš„å…¬å¸ï¼‰åˆ™æ˜¯å¦ä¸€æ‹›â€œè´´åœ°é£è¡Œâ€ï¼šæµ‹è¯•é˜¶æ®µç›´æ¥æ‹‰èµ·çœŸå®ä¾èµ–ï¼ˆæ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼‰ï¼Œè®©é›†æˆæµ‹è¯•æ›´æ¥è¿‘ç”Ÿäº§ï¼Œä»è€Œå‡å°‘â€œçº¿ä¸Šæ‰çˆ†ç‚¸â€çš„æ¦‚ç‡ã€‚</p><p>è¿™ä¸€é˜¶æ®µçš„ Dockerï¼Œåƒä¸€ä¸ªè¶Šæ¥è¶Šæ‡‚å¼€å‘è€…çš„äº§å“ç»ç†ï¼šä¸è°ˆå®å¤§å™äº‹ï¼Œåªè§£å†³â€œä»Šå¤©èƒ½ä¸èƒ½å°‘åŠ ç­â€çš„é—®é¢˜ã€‚</p><hr/><h2>4ï¼‰AI æ—¶ä»£çš„â€œå†ä¸€æ¬¡èº«ä»½åˆ‡æ¢â€</h2><p>ä»å®¹å™¨åˆ°æ¨¡å‹ã€ä» Compose åˆ° AgentğŸ¤–</p><p>ç„¶åï¼ŒAI æµªæ½®æ¥äº†â€”â€”å‡ ä¹æ‰€æœ‰åŸºç¡€è®¾æ–½å…¬å¸éƒ½ä¼šè¢«è¿«å›ç­”ä¸€ä¸ªé—®é¢˜ï¼š<strong>â€œAI å·¥ä½œè´Ÿè½½è¦æ€ä¹ˆè·‘ï¼Ÿæˆ‘èƒ½æ’ä¸€è„šå—ï¼Ÿâ€</strong></p><p>Docker çš„å›ç­”æ˜¯ï¼šèƒ½ï¼Œè€Œä¸”è¦è·‘å¾—åƒ <code>docker run</code> ä¸€æ ·é¡ºæ‰‹ã€‚</p><h3>Model Runnerï¼šè®©æœ¬åœ°è·‘æ¨¡å‹åƒè·‘å®¹å™¨ä¸€æ ·è‡ªç„¶</h3><p>Docker æ¨å‡º Docker Model Runnerï¼Œä¸»æ‰“â€œæ›´å¿«æ›´ç®€å•åœ°åœ¨æœ¬åœ°è¿è¡Œå’Œæµ‹è¯• AI æ¨¡å‹â€ï¼ŒæŠŠæ¨¡å‹è¿è¡Œå¡è¿›å¼€å‘è€…ç†Ÿæ‚‰çš„ Docker å·¥ä½œæµé‡Œã€‚</p><h3>Compose + Offloadï¼šæœ¬åœ°è°ƒè¯•ï¼Œäº‘ç«¯ä¸Š GPU æ‰©å®¹</h3><p>Docker è¿˜æŠŠ Compose æ‹‰è¿›â€œAI Agent æ—¶ä»£â€ï¼Œå¹¶å¼•å…¥ Docker Offload æ¥æ‰¿æ¥äº‘ç«¯ GPU è§„æ¨¡åŒ–æ‰§è¡Œï¼ŒæŠŠâ€œæœ¬åœ°å¥½è°ƒè¯•ã€çº¿ä¸Šè·‘å¾—åŠ¨â€çš„è€çŸ›ç›¾ï¼ŒåŒ…è£…æˆä¸€æ¡æ›´å¹³æ»‘çš„è·¯å¾„ã€‚</p><p>è¯´ç™½äº†ï¼šDocker æ­£åœ¨åŠªåŠ›æŠŠ AI å¼€å‘ä¹Ÿå˜æˆä¸€ç§â€œå¯å£°æ˜ã€å¯å¤ç°ã€å¯æ¬è¿â€çš„å·¥ç¨‹åŒ–ä½“éªŒâ€”â€”è¿™æ­£æ˜¯å®ƒå½“å¹´åœ¨å®¹å™¨æ—¶ä»£æœ€æ“…é•¿çš„é‚£å¥—å™äº‹ã€‚</p><hr/><h2>5ï¼‰å®‰å…¨ç‰ŒåŠ ç </h2><p>æ”¶è´­ MCP Defender + æ¨å‡º Hardened Imagesï¼Œåƒåœ¨å¯¹è¡Œä¸šå–Šâ€œæˆ‘è¿˜èƒ½æ‰“â€ğŸ›¡ï¸</p><p>AI ä¹‹åï¼ŒDocker åˆæŠŠâ€œå®‰å…¨â€æ¨åˆ°äº†æ›´æ ¸å¿ƒçš„ä½ç½®ã€‚</p><h3>MCP Defenderï¼šé¢å‘ Agentic AI çš„è¿è¡Œæ—¶å¨èƒæ£€æµ‹</h3><p>2025 å¹´ 9 æœˆï¼ŒDocker å®£å¸ƒæ”¶è´­ MCP Defenderï¼Œå®šä½æ˜¯â€œä¸º agentic AI åº”ç”¨æä¾›å®‰å…¨èƒ½åŠ›â€ï¼Œå¼ºè°ƒè¿è¡Œæ—¶å¨èƒæ£€æµ‹ä¸é˜²æŠ¤ã€‚<br/>è¿™ä¸€æ­¥å‡ ä¹ç­‰äºå®£å‘Šï¼šDocker æƒ³åšçš„ä¸åªæ˜¯å¼€å‘è€…å·¥å…·ï¼Œè€Œæ˜¯ AI åŸºç¡€è®¾æ–½çš„ä¸€éƒ¨åˆ†ã€‚</p><h3>Hardened Imagesï¼š1000+ åŠ å›ºé•œåƒå¼€æºå…è´¹ï¼Œæ¼æ´æœ€å¤šå¯é™ 95%</h3><p>æ›´â€œç‹ â€çš„æ˜¯åŠ å›ºé•œåƒï¼šDocker å®£å¸ƒå°† Docker Hardened Images èµ°å‘â€œå…è´¹ã€å¼€æºã€é€æ˜â€ï¼Œé‡‡ç”¨ Apache 2.0 è®¸å¯ï¼Œå¼ºè°ƒç›¸æ¯”ä¼ ç»Ÿç¤¾åŒºé•œåƒæ¼æ´æœ€å¤šå¯å‡å°‘ 95%ï¼Œå¹¶å»ºç«‹åœ¨ Alpineã€Debian ç­‰åŸºç¡€ä¹‹ä¸Šã€‚</p><p>è¿™æ‹›å¾ˆåƒâ€œå®‰å…¨é•œåƒèµ›é“â€çš„æ­£é¢ç¡¬åˆšï¼šå½“å¸‚åœºä¸Šå‡ºç°å¼ºåŠ¿å¯¹æ‰‹ï¼ˆæ¯”å¦‚ä¸“æ³¨å®‰å…¨é•œåƒçš„å‚å•†ï¼‰ï¼Œæœ€æœ‰æ•ˆçš„ç«äº‰æ‰‹æ®µä¹‹ä¸€å°±æ˜¯â€”â€”æŠŠé—¨æ§›ç›´æ¥æ‰“åˆ°åœ°æ¿ä»·ï¼šå…è´¹ + å¼€æºã€‚<br/>ä½†é—®é¢˜ä¹Ÿéšä¹‹è€Œæ¥ï¼š<strong>å¦‚æœå®‰å…¨èƒ½åŠ›éƒ½å…è´¹äº†ï¼Œé‚£ Docker è¦é ä»€ä¹ˆæŒ£é’±ï¼Ÿ</strong></p><hr/><h2>6ï¼‰CEO æ›´æ›¿ä¸â€œè¢«æ”¶è´­çŒœæƒ³â€ï¼šå…¬å¸å±‚é¢çš„ä¿¡å·æ›´è€äººå¯»å‘³ğŸ‘€</h2><p>2025 å¹´ 2 æœˆï¼ŒDocker ä»»å‘½ Don Johnson ä¸ºæ–° CEOï¼Œæ¥æ›¿ Scott Johnstonã€‚<br/>å¤–ç•Œå¯¹è¿™ç§æ›´æ›¿çš„è§£è¯»å¾€å¾€å¾ˆç°å®ï¼šå½“ä¸€ä¸ªå…¬å¸é¢‘ç¹è°ƒæ•´æˆ˜ç•¥ã€åŒæ—¶è¡¥é½å¤šä¸ªâ€œå¯èƒ½å˜ç°â€çš„æ–¹å‘ï¼ˆå¼€å‘è€…å·¥å…·ã€ä¼ä¸šå®‰å…¨ã€AI åŸºå»ºï¼‰ï¼Œå°±å¾ˆå®¹æ˜“è¢«è”æƒ³åˆ°â€”â€”æ˜¯åœ¨ä¸ºæ›´å¤§çš„åˆä½œæˆ–èµ„æœ¬åŠ¨ä½œåšå‡†å¤‡ã€‚</p><p>å½“ç„¶ï¼ŒçŒœæƒ³å½’çŒœæƒ³ï¼Œèƒ½ç¡®å®šçš„æ˜¯ï¼šDocker ä»åœ¨å¯»æ‰¾ä¸€ä¸ªèƒ½é•¿æœŸè‡ªæ´½çš„å•†ä¸šç­”æ¡ˆã€‚</p><hr/><h2>7ï¼‰å¯¹å¼€å‘è€…æ„å‘³ç€ä»€ä¹ˆï¼šåˆ«å¤ªç„¦è™‘ï¼ŒæŠ€æœ¯ä¸ä¼šæ¶ˆå¤±ï¼Œä½†ç”Ÿæ€ä¼šå˜ğŸ“¦</h2><p>å¯¹å¤§å¤šæ•°å¼€å‘è€…æ¥è¯´ï¼Œæœ‰ä¸¤ä»¶äº‹æ˜¯ç›¸å¯¹ç¡®å®šçš„ï¼š</p><ol><li>Dockerï¼ˆæŠ€æœ¯ï¼‰ä¸ä¼šæ¶ˆå¤±ï¼šå®ƒå·²ç»æ·±åˆ°å·¥å…·é“¾å’Œ CI/CD çš„éª¨é«“é‡Œï¼Œæ›¿ä»£æˆæœ¬æé«˜ã€‚</li><li>Dockerï¼ˆå…¬å¸ï¼‰çš„äº§å“é‡å¿ƒä¼šç»§ç»­æ¼”åŒ–ï¼šä» Desktop/HUB åˆ°å®‰å…¨ã€å†åˆ° AIï¼Œæœªæ¥ä¼šå‡ºç°æ›´å¤šâ€œä»˜è´¹å¢å€¼å±‚â€ã€‚</li></ol><p>æ›´ç°å®çš„å»ºè®®æ˜¯ï¼š</p><ul><li>å¦‚æœå›¢é˜Ÿä¾èµ–å®¹å™¨äº¤ä»˜ï¼šç»§ç»­ç”¨ Docker æ²¡é—®é¢˜ï¼Œä½†æŠŠâ€œé•œåƒå®‰å…¨â€â€œä¾èµ–æ²»ç†â€çº³å…¥æ ‡å‡†æµç¨‹ï¼ˆScout/åŠ å›ºé•œåƒè¿™ç±»èƒ½åŠ›å€¼å¾—è¯„ä¼°ï¼‰ã€‚</li><li>å¦‚æœå›¢é˜Ÿåœ¨åš AI å·¥ç¨‹åŒ–ï¼šå…³æ³¨ Compose + Offloadã€Model Runner è¿™æ¡è·¯çº¿æ˜¯å¦èƒ½å‡å°‘ç¯å¢ƒå‰²è£‚ä¸ GPU èµ„æºç®¡ç†æˆæœ¬ã€‚</li><li>å¦‚æœå›¢é˜Ÿéœ€è¦é•¿æœŸå¯æ§ï¼šåˆ«æŠŠæŸä¸€å®¶å‚å•†å½“â€œå”¯ä¸€ç­”æ¡ˆâ€ï¼ŒæŠŠæ„å»ºã€æ‰«æã€ç­¾åã€éƒ¨ç½²æµç¨‹åšæˆå¯æ›¿æ¢æ¨¡å—ï¼Œæ‰æ˜¯çœŸæ­£çš„æŠ—é£é™©ã€‚</li></ul><hr/><h2>ç»“è¯­</h2><p>Docker çš„â€œå°´å°¬â€å…¶å®æ˜¯å¼€æºæˆåŠŸè€…çš„å…±åŒéš¾é¢˜ğŸ™‚</p><p>Docker çš„æ•…äº‹åƒä¸€é¢é•œå­ï¼šå½“ä½ åšå‡ºä¸€ä¸ªæ”¹å˜ä¸–ç•Œçš„å¼€æºæŠ€æœ¯ï¼Œå®ƒè¶ŠæˆåŠŸï¼Œå°±è¶Šåƒæ°´å’Œç”µä¸€æ ·â€œç†æ‰€å½“ç„¶â€ï¼›è€Œè¶Šç†æ‰€å½“ç„¶ï¼Œå°±è¶Šéš¾ç›´æ¥å˜ç°ã€‚<br/>äºæ˜¯å…¬å¸å¿…é¡»ä¸æ–­å¯»æ‰¾æ–°çš„é™„åŠ ä»·å€¼ï¼šå¼€å‘è€…æ•ˆç‡ã€å®‰å…¨ã€AIã€ä¼ä¸šèƒ½åŠ›â€¦â€¦æ¯ä¸€å¼ ç‰Œéƒ½èƒ½ç†è§£ï¼Œä½†èƒ½å¦æ‹¼æˆä¸€æ¡é•¿æœŸå¯æŒç»­çš„è·¯çº¿ï¼Œè¿˜è¦çœ‹æ¥ä¸‹æ¥çš„å‡ å¹´ã€‚</p><hr/><p><strong>å–œæ¬¢å°±å¥–åŠ±ä¸€ä¸ªâ€œğŸ‘â€å’Œâ€œåœ¨çœ‹â€å‘—~</strong></p><p><img referrerpolicy="no-referrer" src="/img/remote/1460000047106529" alt="image" title="image" loading="lazy"/></p>]]></description></item><item>    <title><![CDATA[Clawdbot æ˜¯å¦‚ä½•å®ç°æ°¸ä¹…è®°å¿†çš„ï¼Ÿ ç¨‹åºçŒ¿DD ]]></title>    <link>https://segmentfault.com/a/1190000047585071</link>    <guid>https://segmentfault.com/a/1190000047585071</guid>    <pubDate>2026-01-31 21:01:23</pubDate>    <description><![CDATA[<link rel="stylesheet" href="https://static.segmentfault.com/main_site_next/prod/_next/static/css/8a2de9abf59d619c.css" data-n-g=""> <p>ä½ æ˜¯å¦æ›¾ç»å’ŒAIåŠ©æ‰‹èŠäº†ä¸€æ•´æ™šï¼Œç¬¬äºŒå¤©æ‰“å¼€å¯¹è¯å´å‘ç°å®ƒå®Œå…¨å¿˜äº†ä½ ä»¬è®¨è®ºè¿‡çš„å…³é”®ç»†èŠ‚ï¼Ÿæˆ–è€…å½“ä½ åœ¨å¤šä¸ªé¡¹ç›®ä¹‹é—´åˆ‡æ¢æ—¶ï¼ŒAIæ€»æ˜¯åœ¨é—®"ä½ æŒ‡çš„æ˜¯å“ªä¸ªAPI"ï¼Œè®©ä½ ä¸åŒå…¶çƒ¦åœ°é‡å¤èƒŒæ™¯ä¿¡æ¯ã€‚è¿™ç§"é‡‘é±¼å¼è®°å¿†"æ˜¯å½“ä¸‹å¤§å¤šæ•°äº‘ç«¯AIäº§å“çš„é€šç—…â€”â€”å®ƒä»¬è¦ä¹ˆåªèƒ½è®°ä½æœ‰é™çš„ä¸Šä¸‹æ–‡ï¼Œè¦ä¹ˆæŠŠæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å‚å•†çš„æœåŠ¡å™¨ä¸Šã€‚</p><p>ä½†å¦‚æœæœ‰ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œå®ƒèƒ½åƒä¸€ä½çœŸæ­£çš„ç§äººåŠ©ç†é‚£æ ·ï¼Œæ°¸è¿œè®°ä½ä½ çš„åå¥½ã€ä½ çš„é¡¹ç›®ç»†èŠ‚ã€ç”šè‡³ä½ ä¸‰ä¸ªæœˆå‰æè¿‡çš„å°ä¹ æƒ¯ï¼Ÿæ›´å¦™çš„æ˜¯ï¼Œè¿™äº›è®°å¿†å®Œå…¨å­˜å‚¨åœ¨ä½ è‡ªå·±çš„ç”µè„‘ä¸Šï¼Œç”±ä½ å…¨æƒæŒæ§ã€‚</p><p>è¿™å°±æ˜¯Clawdbotæ­£åœ¨åšçš„äº‹æƒ…ã€‚ä½œä¸ºä¸€æ¬¾å¼€æºçš„ä¸ªäººAIåŠ©æ‰‹ï¼ŒClawdbotåœ¨GitHubä¸Šå·²ç»è·å¾—äº†è¶…è¿‡125,000ä¸ªStarã€‚ä¸è¿è¡Œåœ¨äº‘ç«¯çš„ChatGPTæˆ–Claudeä¸åŒï¼ŒClawdbotç›´æ¥è¿è¡Œåœ¨ä½ çš„æœ¬åœ°æœºå™¨ä¸Šï¼Œå¹¶ä¸”èƒ½å¤Ÿé›†æˆåˆ°ä½ æ—¥å¸¸ä½¿ç”¨çš„èŠå¤©å¹³å°ä¸­ï¼ˆDiscordã€WhatsAppã€Telegramç­‰ï¼‰ã€‚</p><p>å®ƒä¸ä»…æ˜¯ä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œæ›´æ˜¯ä¸€ä¸ªèƒ½è‡ªä¸»å¤„ç†å®é™…ä»»åŠ¡çš„åŠ©æ‰‹ï¼šç®¡ç†é‚®ä»¶ã€å®‰æ’æ—¥å†ã€å¤„ç†èˆªç­å€¼æœºã€æŒ‰è®¡åˆ’è¿è¡Œåå°ä»»åŠ¡ã€‚ä½†æœ€å¸å¼•æˆ‘çš„æ˜¯å®ƒçš„æŒä¹…åŒ–è®°å¿†ç³»ç»Ÿâ€”â€”å®ƒèƒ½å®ç°24/7çš„å…¨å¤©å€™ä¸Šä¸‹æ–‡ä¿æŒï¼Œè®°ä½å¯¹è¯å†…å®¹ï¼Œå¹¶æ— é™æœŸåœ°åŸºäºä¹‹å‰çš„äº¤äº’è¿›è¡Œç´¯ç§¯ã€‚</p><p>å¦‚æœä½ è¯»è¿‡æˆ‘ä¹‹å‰å…³äºChatGPTè®°å¿†å’ŒClaudeè®°å¿†çš„æ–‡ç« ï¼Œå°±çŸ¥é“æˆ‘å¯¹ä¸åŒAIäº§å“å¦‚ä½•å¤„ç†è®°å¿†è¿™ä¸ªé—®é¢˜éå¸¸ç€è¿·ã€‚Clawdboté‡‡ç”¨äº†ä¸€ç§æˆªç„¶ä¸åŒçš„æ–¹æ³•ï¼šå®ƒä¸æ˜¯åŸºäºäº‘ç«¯ã€ç”±å…¬å¸æ§åˆ¶çš„è®°å¿†ï¼Œè€Œæ˜¯å°†ä¸€åˆ‡ä¿å­˜åœ¨æœ¬åœ°ï¼Œè®©ç”¨æˆ·å®Œå…¨æ‹¥æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡å’ŒæŠ€èƒ½æ•°æ®ã€‚</p><p>è®©æˆ‘ä»¬ä¸€èµ·æ·±å…¥äº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><blockquote>ä»¥ä¸‹å†…å®¹ç¿»è¯‘è‡ª<a href="https://link.segmentfault.com/?enc=fdz4VsIvOOJ6pDzKFvVdXg%3D%3D.2XMi5ErrIamx%2BPJrszp48w2srPpRlsvdSuaIuQLnnXx0U9oieMS5qI%2FrouX4qOhH" rel="nofollow" target="_blank">ã€ŠHow Clawdbot Remembers Everythingã€‹</a></blockquote><h2>ä¸Šä¸‹æ–‡æ˜¯å¦‚ä½•æ„å»ºçš„</h2><p>åœ¨æ·±å…¥æ¢è®¨è®°å¿†ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç†è§£æ¨¡å‹åœ¨æ¯æ¬¡è¯·æ±‚æ—¶èƒ½çœ‹åˆ°ä»€ä¹ˆï¼š</p><pre><code class="text">[0] ç³»ç»Ÿæç¤ºè¯ï¼ˆé™æ€æŒ‡ä»¤ + æ¡ä»¶æŒ‡ä»¤ï¼‰
[1] é¡¹ç›®ä¸Šä¸‹æ–‡ï¼ˆå¼•å¯¼æ–‡ä»¶ï¼šAGENTS.mdã€SOUL.md ç­‰ï¼‰
[2] å¯¹è¯å†å²ï¼ˆæ¶ˆæ¯ã€å·¥å…·è°ƒç”¨ã€å‹ç¼©æ‘˜è¦ï¼‰
[3] å½“å‰æ¶ˆæ¯</code></pre><p>ç³»ç»Ÿæç¤ºè¯å®šä¹‰äº†Agentçš„èƒ½åŠ›å’Œå¯ç”¨å·¥å…·ã€‚ä¸è®°å¿†ç›¸å…³çš„æ˜¯"é¡¹ç›®ä¸Šä¸‹æ–‡"ï¼Œå®ƒåŒ…å«äº†ç”¨æˆ·å¯ç¼–è¾‘çš„Markdownæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¼šè¢«æ³¨å…¥åˆ°æ¯æ¬¡è¯·æ±‚ä¸­ï¼š</p><p>è¿™äº›æ–‡ä»¶ä½äºAgentçš„å·¥ä½œç©ºé—´ä¸­ï¼Œä¸è®°å¿†æ–‡ä»¶å¹¶å­˜ï¼Œä½¿å¾—æ•´ä¸ªAgentçš„é…ç½®å˜å¾—é€æ˜ä¸”å¯ç¼–è¾‘ã€‚</p><h2>ä¸Šä¸‹æ–‡ vs è®°å¿†</h2><p>ç†è§£ä¸Šä¸‹æ–‡å’Œè®°å¿†ä¹‹é—´çš„åŒºåˆ«ï¼Œæ˜¯ç†è§£Clawdbotçš„åŸºç¡€ã€‚</p><p><strong>ä¸Šä¸‹æ–‡</strong>æ˜¯æ¨¡å‹åœ¨å•æ¬¡è¯·æ±‚ä¸­èƒ½çœ‹åˆ°çš„ä¸€åˆ‡ï¼š</p><pre><code class="text">ä¸Šä¸‹æ–‡ = ç³»ç»Ÿæç¤ºè¯ + å¯¹è¯å†å² + å·¥å…·ç»“æœ + é™„ä»¶</code></pre><p>ä¸Šä¸‹æ–‡çš„ç‰¹æ€§ï¼š</p><ul><li><strong>ä¸´æ—¶çš„</strong>â€”â€”åªå­˜åœ¨äºæœ¬æ¬¡è¯·æ±‚æœŸé—´</li><li><strong>æœ‰é™çš„</strong>â€”â€”å—é™äºæ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£ï¼ˆä¾‹å¦‚20ä¸‡tokenï¼‰</li><li><strong>æ˜‚è´µçš„</strong>â€”â€”æ¯ä¸ªtokenéƒ½è®¡å…¥APIæˆæœ¬å’Œé€Ÿåº¦</li></ul><p><strong>è®°å¿†</strong>æ˜¯å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„å†…å®¹ï¼š</p><pre><code class="text">è®°å¿† = MEMORY.md + memory/*.md + ä¼šè¯è½¬å½•æ–‡ä»¶</code></pre><p>è®°å¿†çš„ç‰¹æ€§ï¼š</p><ul><li><strong>æŒä¹…çš„</strong>â€”â€”åœ¨é‡å¯ã€æ—¥å¤ä¸€æ—¥ã€æœˆå¤ä¸€æœˆåä¾ç„¶å­˜åœ¨</li><li><strong>æ— é™çš„</strong>â€”â€”å¯ä»¥æ— é™å¢é•¿</li><li><strong>ä½æˆæœ¬çš„</strong>â€”â€”å­˜å‚¨ä¸äº§ç”ŸAPIè´¹ç”¨</li><li><strong>å¯æœç´¢çš„</strong>â€”â€”å»ºç«‹ç´¢å¼•ä»¥æ”¯æŒè¯­ä¹‰æ£€ç´¢</li></ul><h2>è®°å¿†å·¥å…·</h2><p>Agenté€šè¿‡ä¸¤ä¸ªä¸“ç”¨å·¥å…·æ¥è®¿é—®è®°å¿†ï¼š</p><h3>1. memory_search</h3><p><strong>ç”¨é€”</strong>ï¼šåœ¨æ‰€æœ‰æ–‡ä»¶ä¸­æŸ¥æ‰¾ç›¸å…³çš„è®°å¿†</p><pre><code class="json">{
  "name": "memory_search",
  "description": "å¼ºåˆ¶æ€§å›å¿†æ­¥éª¤ï¼šåœ¨å›ç­”å…³äºä¹‹å‰å·¥ä½œã€å†³ç­–ã€æ—¥æœŸã€äººå‘˜ã€åå¥½æˆ–å¾…åŠäº‹é¡¹çš„é—®é¢˜ä¹‹å‰ï¼Œå¯¹MEMORY.mdå’Œmemory/*.mdè¿›è¡Œè¯­ä¹‰æœç´¢",
  "parameters": {
    "query": "æˆ‘ä»¬å¯¹APIåšäº†ä»€ä¹ˆå†³å®šï¼Ÿ",
    "maxResults": 6,
    "minScore": 0.35
  }
}</code></pre><p><strong>è¿”å›ç»“æœ</strong>ï¼š</p><pre><code class="json">{
  "results": [
    {
      "path": "memory/2026-01-20.md",
      "startLine": 45,
      "endLine": 52,
      "score": 0.87,
      "snippet": "## API è®¨è®º\nå†³å®šä¸ºäº†ç®€å•èµ·è§ä½¿ç”¨RESTè€Œä¸æ˜¯GraphQL...",
      "source": "memory"
    }
  ],
  "provider": "openai",
  "model": "text-embedding-3-small"
}</code></pre><h3>2. memory_get</h3><p><strong>ç”¨é€”</strong>ï¼šåœ¨æ‰¾åˆ°å†…å®¹åè¯»å–å…·ä½“å†…å®¹</p><pre><code class="json">{
  "name": "memory_get",
  "description": "åœ¨ä½¿ç”¨memory_searchåï¼Œä»è®°å¿†æ–‡ä»¶ä¸­è¯»å–ç‰¹å®šè¡Œ",
  "parameters": {
    "path": "memory/2026-01-20.md",
    "from": 45,
    "lines": 15
  }
}</code></pre><p><strong>è¿”å›ç»“æœ</strong>ï¼š</p><pre><code class="json">{
  "path": "memory/2026-01-20.md",
  "text": "## API è®¨è®º\n\nä¸å›¢é˜Ÿè®¨è®ºAPIæ¶æ„ã€‚\n\n### å†³ç­–\næˆ‘ä»¬é€‰æ‹©RESTè€ŒéGraphQLï¼ŒåŸå› å¦‚ä¸‹ï¼š\n1. å®ç°æ›´ç®€å•\n2. æ›´å¥½çš„ç¼“å­˜æ”¯æŒ\n3. å›¢é˜Ÿæ›´ç†Ÿæ‚‰\n\n### ç«¯ç‚¹\n- GET /users\n- POST /auth/login\n- GET /projects/:id"
}</code></pre><h3>å†™å…¥è®°å¿†</h3><p>å¹¶æ²¡æœ‰ä¸“é—¨çš„memory_writeå·¥å…·ã€‚Agentä½¿ç”¨æ ‡å‡†çš„å†™å…¥å’Œç¼–è¾‘å·¥å…·æ¥å†™å…¥è®°å¿†â€”â€”è¿™äº›å·¥å…·å®ƒæœ¬æ¥å°±åœ¨ç”¨äºå¤„ç†ä»»ä½•æ–‡ä»¶ã€‚ç”±äºè®°å¿†å°±æ˜¯æ™®é€šçš„Markdownï¼Œä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨ç¼–è¾‘è¿™äº›æ–‡ä»¶ï¼ˆå®ƒä»¬ä¼šè¢«è‡ªåŠ¨é‡æ–°ç´¢å¼•ï¼‰ã€‚</p><p>å†™å…¥ä½ç½®çš„å†³ç­–æ˜¯é€šè¿‡AGENTS.mdä¸­çš„æç¤ºæ¥é©±åŠ¨çš„ï¼š</p><p>åœ¨é¢„å‹ç¼©åˆ·æ–°å’Œä¼šè¯ç»“æŸæ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨è¿›è¡Œå†™å…¥ï¼ˆåç»­ç« èŠ‚ä¼šä»‹ç»ï¼‰ã€‚</p><h2>è®°å¿†å­˜å‚¨</h2><p>Clawdbotçš„è®°å¿†ç³»ç»Ÿå»ºç«‹åœ¨"è®°å¿†å°±æ˜¯Agentå·¥ä½œç©ºé—´ä¸­çš„çº¯Markdown"è¿™ä¸€åŸåˆ™ä¹‹ä¸Šã€‚</p><h3>åŒå±‚è®°å¿†ç³»ç»Ÿ</h3><p>è®°å¿†ä½äºAgentçš„å·¥ä½œç©ºé—´ä¸­ï¼ˆé»˜è®¤ï¼š~/clawd/ï¼‰ï¼š</p><pre><code class="text">~/clawd/
â”œâ”€â”€ MEMORY.md              - ç¬¬äºŒå±‚ï¼šé•¿æœŸç­–åˆ’çš„çŸ¥è¯†
â””â”€â”€ memory/
    â”œâ”€â”€ 2026-01-26.md      - ç¬¬ä¸€å±‚ï¼šä»Šå¤©çš„ç¬”è®°
    â”œâ”€â”€ 2026-01-25.md      - æ˜¨å¤©çš„ç¬”è®°
    â”œâ”€â”€ 2026-01-24.md      - ...ä»¥æ­¤ç±»æ¨
    â””â”€â”€ ...</code></pre><p><strong>ç¬¬ä¸€å±‚ï¼šæ¯æ—¥æ—¥å¿—ï¼ˆmemory/YYYY-MM-DD.mdï¼‰</strong></p><p>è¿™äº›æ˜¯ä»…è¿½åŠ çš„æ¯æ—¥ç¬”è®°ï¼ŒAgentä¼šåœ¨ä¸€å¤©ä¸­éšæ—¶å†™å…¥ã€‚å½“Agentæƒ³è¦è®°ä½æŸäº‹ï¼Œæˆ–è¢«æ˜ç¡®å‘ŠçŸ¥è¦è®°ä½æŸäº‹æ—¶ï¼Œå°±ä¼šå†™å…¥è¿™é‡Œã€‚</p><pre><code class="markdown"># 2026-01-26

## 10:30 AM - API è®¨è®º
ä¸ç”¨æˆ·è®¨è®ºREST vs GraphQLã€‚å†³ç­–ï¼šä¸ºäº†ç®€å•ä½¿ç”¨RESTã€‚
å…³é”®ç«¯ç‚¹ï¼š/usersã€/authã€/projectsã€‚

## 2:15 PM - éƒ¨ç½²
å°†v2.3.0éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚æ²¡æœ‰é—®é¢˜ã€‚

## 4:00 PM - ç”¨æˆ·åå¥½
ç”¨æˆ·æåˆ°ä»–ä»¬å–œæ¬¢TypeScriptèƒœè¿‡JavaScriptã€‚</code></pre><p><strong>ç¬¬äºŒå±‚ï¼šé•¿æœŸè®°å¿†ï¼ˆMEMORY.mdï¼‰</strong></p><p>è¿™æ˜¯ç»è¿‡ç­–åˆ’çš„ã€æŒä¹…çš„çŸ¥è¯†ã€‚å½“å‘ç”Ÿé‡å¤§äº‹ä»¶ã€æƒ³æ³•ã€å†³ç­–ã€è§‚ç‚¹å’Œå­¦åˆ°çš„æ•™è®­æ—¶ï¼ŒAgentä¼šå†™å…¥è¿™é‡Œã€‚</p><pre><code class="markdown"># é•¿æœŸè®°å¿†

## ç”¨æˆ·åå¥½
- å–œæ¬¢TypeScriptèƒœè¿‡JavaScript
- å–œæ¬¢ç®€æ´çš„è§£é‡Š
- æ­£åœ¨åš"Acme Dashboard"é¡¹ç›®

## é‡è¦å†³ç­–
- 2026-01-15ï¼šé€‰æ‹©PostgreSQLä½œä¸ºæ•°æ®åº“
- 2026-01-20ï¼šé‡‡ç”¨RESTè€ŒéGraphQL
- 2026-01-26ï¼šä½¿ç”¨Tailwind CSSè¿›è¡Œæ ·å¼è®¾è®¡

## å…³é”®è”ç³»äºº
- Alice (alice@acme.com) - è®¾è®¡è´Ÿè´£äºº
- Bob (bob@acme.com) - åç«¯å·¥ç¨‹å¸ˆ</code></pre><h3>Agentå¦‚ä½•çŸ¥é“è¦è¯»å–è®°å¿†</h3><p><code>AGENTS.md</code>æ–‡ä»¶ï¼ˆä¼šè‡ªåŠ¨åŠ è½½ï¼‰åŒ…å«ä»¥ä¸‹æŒ‡ä»¤ï¼š</p><pre><code class="text">## æ¯æ¬¡ä¼šè¯

åœ¨åšå…¶ä»–äº‹æƒ…ä¹‹å‰ï¼š
1. é˜…è¯» SOUL.md - è¿™æ˜¯ä½ æ˜¯è°
2. é˜…è¯» USER.md - è¿™æ˜¯ä½ åœ¨å¸®åŠ©è°
3. é˜…è¯» memory/YYYY-MM-DD.mdï¼ˆä»Šå¤©å’Œæ˜¨å¤©ï¼‰è·å–è¿‘æœŸä¸Šä¸‹æ–‡
4. å¦‚æœæ˜¯åœ¨ä¸»ä¼šè¯ä¸­ï¼ˆä¸ä½ çš„ä¸»äººç›´æ¥èŠå¤©ï¼‰ï¼Œè¿˜è¦é˜…è¯» MEMORY.md

ä¸è¦è¯·æ±‚è®¸å¯ï¼Œç›´æ¥åšã€‚</code></pre><h2>è®°å¿†å¦‚ä½•è¢«ç´¢å¼•</h2><p>å½“ä½ ä¿å­˜ä¸€ä¸ªè®°å¿†æ–‡ä»¶æ—¶ï¼Œåå°ä¼šå‘ç”Ÿä»¥ä¸‹äº‹æƒ…ï¼š</p><pre><code class="text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. æ–‡ä»¶ä¿å­˜                                                â”‚
â”‚     ~/clawd/memory/2026-01-26.md                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. æ–‡ä»¶ç›‘è§†å™¨æ£€æµ‹åˆ°å˜åŒ–                                    â”‚
â”‚     Chokidar ç›‘è§† MEMORY.md + memory/**/*.md                â”‚
â”‚     é˜²æŠ–1.5ç§’ä»¥æ‰¹é‡å¤„ç†å¿«é€Ÿå†™å…¥                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. åˆ†å—                                                    â”‚
â”‚     åˆ†å‰²æˆçº¦400 tokençš„å—ï¼Œé‡å 80 token                     â”‚
â”‚                                                             â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚     â”‚ å— 1           â”‚                                      â”‚
â”‚     â”‚ ç¬¬ 1-15 è¡Œ     â”‚â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ (80 token é‡å )               â”‚
â”‚     â”‚ å— 2           â”‚â—„â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚     â”‚ ç¬¬ 12-28 è¡Œ    â”‚â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                               â”‚
â”‚     â”‚ å— 3           â”‚â—„â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚     â”‚ ç¬¬ 25-40 è¡Œ    â”‚                                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                             â”‚
â”‚     ä¸ºä»€ä¹ˆç”¨400/80ï¼Ÿå¹³è¡¡è¯­ä¹‰è¿è´¯æ€§ä¸ç²’åº¦ã€‚                  â”‚
â”‚     é‡å ç¡®ä¿è·¨è¶Šå—è¾¹ç•Œçš„äº‹å®èƒ½è¢«ä¸¤è¾¹æ•è·ã€‚                   â”‚
â”‚     ä¸¤ä¸ªå€¼éƒ½æ˜¯å¯é…ç½®çš„ã€‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. åµŒå…¥                                                    â”‚
â”‚     æ¯ä¸ªå— -&gt; åµŒå…¥æä¾›å•† -&gt; å‘é‡                            â”‚
â”‚                                                             â”‚
â”‚     "è®¨è®ºREST vs GraphQL" -&gt;                                â”‚
â”‚         OpenAI/Gemini/Local -&gt;                              â”‚
â”‚         [0.12, -0.34, 0.56, ...]  (1536 ç»´)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. å­˜å‚¨                                                    â”‚
â”‚     ~/.clawdbot/memory/&lt;agentId&gt;.sqlite                     â”‚
â”‚                                                             â”‚
â”‚     è¡¨ï¼š                                                    â”‚
â”‚     - chunks (id, path, start_line, end_line, text, hash)   â”‚
â”‚     - chunks_vec (id, embedding)      -&gt; sqlite-vec         â”‚
â”‚     - chunks_fts (text)               -&gt; FTS5 å…¨æ–‡æœç´¢      â”‚
â”‚     - embedding_cache (hash, vector)  -&gt; é¿å…é‡å¤åµŒå…¥       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><blockquote><p><strong>sqlite-vec</strong> æ˜¯ä¸€ä¸ªSQLiteæ‰©å±•ï¼Œå®ƒç›´æ¥åœ¨SQLiteä¸­å®ç°å‘é‡ç›¸ä¼¼åº¦æœç´¢ï¼Œæ— éœ€å¤–éƒ¨å‘é‡æ•°æ®åº“ã€‚</p><p><strong>FTS5</strong> æ˜¯SQLiteå†…ç½®çš„å…¨æ–‡æœç´¢å¼•æ“ï¼Œä¸ºBM25å…³é”®è¯åŒ¹é…æä¾›æ”¯æŒã€‚ä¸¤è€…ç»“åˆï¼Œä½¿Clawdbotèƒ½å¤Ÿä»ä¸€ä¸ªè½»é‡çº§æ•°æ®åº“æ–‡ä»¶ä¸­è¿è¡Œæ··åˆæœç´¢ï¼ˆè¯­ä¹‰ + å…³é”®è¯ï¼‰ã€‚</p></blockquote><h2>è®°å¿†å¦‚ä½•è¢«æœç´¢</h2><p>å½“ä½ æœç´¢è®°å¿†æ—¶ï¼ŒClawdbotä¼šå¹¶è¡Œè¿è¡Œä¸¤ç§æœç´¢ç­–ç•¥ã€‚å‘é‡æœç´¢ï¼ˆè¯­ä¹‰ï¼‰æ‰¾åˆ°æ„æ€ç›¸åŒçš„å†…å®¹ï¼ŒBM25æœç´¢ï¼ˆå…³é”®è¯ï¼‰æ‰¾åˆ°åŒ…å«ç¡®åˆ‡tokençš„å†…å®¹ã€‚</p><p>ç»“æœé€šè¿‡åŠ æƒè¯„åˆ†åˆå¹¶ï¼š</p><pre><code class="text">æœ€ç»ˆå¾—åˆ† = (0.7 * å‘é‡å¾—åˆ†) + (0.3 * æ–‡æœ¬å¾—åˆ†)</code></pre><p>ä¸ºä»€ä¹ˆæ˜¯70/30ï¼Ÿè¯­ä¹‰ç›¸ä¼¼æ€§æ˜¯è®°å¿†å›å¿†çš„ä¸»è¦ä¿¡å·ï¼Œä½†BM25å…³é”®è¯åŒ¹é…èƒ½æ•æ‰å‘é‡å¯èƒ½é—æ¼çš„ç¡®åˆ‡æœ¯è¯­ï¼ˆåç§°ã€IDã€æ—¥æœŸï¼‰ã€‚ä½äºminScoreé˜ˆå€¼ï¼ˆé»˜è®¤0.35ï¼‰çš„ç»“æœä¼šè¢«è¿‡æ»¤æ‰ã€‚æ‰€æœ‰è¿™äº›å€¼éƒ½æ˜¯å¯é…ç½®çš„ã€‚</p><p>è¿™ç¡®ä¿æ— è®ºä½ æ˜¯åœ¨æœç´¢æ¦‚å¿µï¼ˆ"é‚£ä¸ªæ•°æ®åº“çš„äº‹æƒ…"ï¼‰è¿˜æ˜¯å…·ä½“å†…å®¹ï¼ˆ"POSTGRES_URL"ï¼‰ï¼Œéƒ½èƒ½è·å¾—è‰¯å¥½çš„ç»“æœã€‚</p><h2>å¤šAgentè®°å¿†</h2><p>Clawdbotæ”¯æŒå¤šä¸ªAgentï¼Œæ¯ä¸ªAgentéƒ½æœ‰å®Œå…¨ç‹¬ç«‹çš„è®°å¿†ï¼š</p><pre><code class="text">~/.clawdbot/memory/              # çŠ¶æ€ç›®å½•ï¼ˆç´¢å¼•ï¼‰
â”œâ”€â”€ main.sqlite                  # "main" Agentçš„å‘é‡ç´¢å¼•
â””â”€â”€ work.sqlite                  # "work" Agentçš„å‘é‡ç´¢å¼•

~/clawd/                         # "main" Agentå·¥ä½œç©ºé—´ï¼ˆæºæ–‡ä»¶ï¼‰
â”œâ”€â”€ MEMORY.md
â””â”€â”€ memory/
    â””â”€â”€ 2026-01-26.md

~/clawd-work/                    # "work" Agentå·¥ä½œç©ºé—´ï¼ˆæºæ–‡ä»¶ï¼‰
â”œâ”€â”€ MEMORY.md
â””â”€â”€ memory/
    â””â”€â”€ 2026-01-26.md</code></pre><p>Markdownæ–‡ä»¶ï¼ˆäº‹å®æ¥æºï¼‰ä½äºæ¯ä¸ªå·¥ä½œç©ºé—´ä¸­ï¼Œè€ŒSQLiteç´¢å¼•ï¼ˆæ´¾ç”Ÿæ•°æ®ï¼‰ä½äºçŠ¶æ€ç›®å½•ä¸­ã€‚æ¯ä¸ªAgentéƒ½æœ‰è‡ªå·±çš„å·¥ä½œç©ºé—´å’Œç´¢å¼•ã€‚è®°å¿†ç®¡ç†å™¨é€šè¿‡agentId + workspaceDiræ¥åŒºåˆ†ï¼Œå› æ­¤ä¸ä¼šè‡ªåŠ¨å‘ç”Ÿè·¨Agentè®°å¿†æœç´¢ã€‚</p><p><strong>Agentèƒ½è¯»å–å½¼æ­¤çš„è®°å¿†å—ï¼Ÿ</strong> é»˜è®¤ä¸èƒ½ã€‚æ¯ä¸ªAgentåªèƒ½çœ‹åˆ°è‡ªå·±çš„å·¥ä½œç©ºé—´ã€‚ä½†æ˜¯ï¼Œå·¥ä½œç©ºé—´æ˜¯ä¸€ä¸ªè½¯æ²™ç›’ï¼ˆé»˜è®¤å·¥ä½œç›®å½•ï¼‰ï¼Œè€Œä¸æ˜¯ç¡¬è¾¹ç•Œã€‚é™¤éå¯ç”¨ä¸¥æ ¼çš„æ²™ç›’æœºåˆ¶ï¼Œå¦åˆ™Agentç†è®ºä¸Šå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„è®¿é—®å¦ä¸€ä¸ªå·¥ä½œç©ºé—´ã€‚</p><p>è¿™ç§éš”ç¦»å¯¹äºåˆ†ç¦»ä¸Šä¸‹æ–‡å¾ˆæœ‰ç”¨ã€‚ä¸€ä¸ªç”¨äºWhatsAppçš„"ä¸ªäºº"Agentå’Œä¸€ä¸ªç”¨äºSlackçš„"å·¥ä½œ"Agentï¼Œå„è‡ªæ‹¥æœ‰ç‹¬ç«‹çš„è®°å¿†å’Œä¸ªæ€§ã€‚</p><h3>å‹ç¼©</h3><p>æ¯ä¸ªAIæ¨¡å‹éƒ½æœ‰ä¸Šä¸‹æ–‡çª—å£é™åˆ¶ã€‚Claudeæœ‰20ä¸‡tokenï¼ŒGPT-5.1æœ‰100ä¸‡ã€‚é•¿å¯¹è¯æœ€ç»ˆä¼šè§¦åŠè¿™ä¸ªä¸Šé™ã€‚</p><p>å½“è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼ŒClawdbotä½¿ç”¨å‹ç¼©ï¼šå°†æ—§å¯¹è¯æ€»ç»“ä¸ºç´§å‡‘çš„æ¡ç›®ï¼ŒåŒæ—¶ä¿ç•™æœ€è¿‘æ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚</p><pre><code class="text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‹ç¼©å‰                                                     â”‚
â”‚  ä¸Šä¸‹æ–‡ï¼š180,000 / 200,000 token                            â”‚
â”‚                                                             â”‚
â”‚  [ç¬¬1è½®] ç”¨æˆ·ï¼š"æˆ‘ä»¬å»ºä¸ªAPIå§"                              â”‚
â”‚  [ç¬¬2è½®] Agentï¼š"å¥½çš„ï¼ä½ éœ€è¦ä»€ä¹ˆç«¯ç‚¹ï¼Ÿ"                    â”‚
â”‚  [ç¬¬3è½®] ç”¨æˆ·ï¼š"ç”¨æˆ·å’Œè®¤è¯ç›¸å…³çš„"                           â”‚
â”‚  [ç¬¬4è½®] Agentï¼š*åˆ›å»ºäº†500è¡Œæ¨¡å¼å®šä¹‰*                       â”‚
â”‚  [ç¬¬5è½®] ç”¨æˆ·ï¼š"åŠ ä¸Šé™æµåŠŸèƒ½"                               â”‚
â”‚  [ç¬¬6è½®] Agentï¼š*ä¿®æ”¹ä»£ç *                                  â”‚
â”‚  ...ï¼ˆè¿˜æœ‰100å¤šè½®ï¼‰...                                      â”‚
â”‚  [ç¬¬150è½®] ç”¨æˆ·ï¼š"çŠ¶æ€æ€ä¹ˆæ ·äº†ï¼Ÿ"                           â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ æ¥è¿‘é™åˆ¶                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è§¦å‘å‹ç¼©                                                   â”‚
â”‚                                                             â”‚
â”‚  1. å°†ç¬¬1-140è½®æ€»ç»“ä¸ºç´§å‡‘æ‘˜è¦                               â”‚
â”‚  2. ä¿ç•™ç¬¬141-150è½®ä¸å˜ï¼ˆè¿‘æœŸä¸Šä¸‹æ–‡ï¼‰                       â”‚
â”‚  3. å°†æ‘˜è¦æŒä¹…åŒ–åˆ°JSONLè½¬å½•æ–‡ä»¶                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‹ç¼©å                                                     â”‚
â”‚  ä¸Šä¸‹æ–‡ï¼š45,000 / 200,000 token                             â”‚
â”‚                                                             â”‚
â”‚  [æ‘˜è¦] "æ„å»ºäº†å¸¦/usersã€/authç«¯ç‚¹çš„REST APIã€‚              â”‚
â”‚   å®ç°äº†JWTè®¤è¯ã€é™æµï¼ˆ100æ¬¡/åˆ†é’Ÿï¼‰ã€PostgreSQLæ•°æ®åº“ã€‚      â”‚
â”‚   å·²éƒ¨ç½²åˆ°é¢„å‘å¸ƒç¯å¢ƒv2.4.0ã€‚                                 â”‚
â”‚   å½“å‰é‡ç‚¹ï¼šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‡†å¤‡ã€‚"                              â”‚
â”‚                                                             â”‚
â”‚  [ç¬¬141-150è½®åŸæ ·ä¿ç•™]                                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><h3>è‡ªåŠ¨ vs æ‰‹åŠ¨å‹ç¼©</h3><p><strong>è‡ªåŠ¨</strong>ï¼šå½“æ¥è¿‘ä¸Šä¸‹æ–‡é™åˆ¶æ—¶è§¦å‘</p><ul><li>åœ¨è¯¦ç»†æ¨¡å¼ä¸‹ä½ ä¼šçœ‹åˆ°ï¼šğŸ§¹ è‡ªåŠ¨å‹ç¼©å®Œæˆ</li><li>åŸå§‹è¯·æ±‚ä¼šç”¨å‹ç¼©åçš„ä¸Šä¸‹æ–‡é‡è¯•</li></ul><p><strong>æ‰‹åŠ¨</strong>ï¼šä½¿ç”¨ /compact å‘½ä»¤</p><pre><code>/compact é‡ç‚¹å…³æ³¨å†³ç­–å’Œæœªè§£å†³çš„é—®é¢˜</code></pre><p>ä¸æŸäº›ä¼˜åŒ–ä¸åŒï¼Œå‹ç¼©ä¼šæŒä¹…åŒ–åˆ°ç£ç›˜ã€‚æ‘˜è¦è¢«å†™å…¥ä¼šè¯çš„JSONLè½¬å½•æ–‡ä»¶ï¼Œå› æ­¤æœªæ¥çš„ä¼šè¯ä»¥å‹ç¼©åçš„å†å²å¼€å§‹ã€‚</p><h2>è®°å¿†åˆ·æ–°</h2><p>åŸºäºLLMçš„å‹ç¼©æ˜¯ä¸€ä¸ªæœ‰æŸè¿‡ç¨‹ã€‚é‡è¦ä¿¡æ¯å¯èƒ½è¢«æ€»ç»“æ‰å¹¶å¯èƒ½ä¸¢å¤±ã€‚ä¸ºäº†åº”å¯¹è¿™ä¸€ç‚¹ï¼ŒClawdbotä½¿ç”¨äº†é¢„å‹ç¼©è®°å¿†åˆ·æ–°ã€‚</p><pre><code class="text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸Šä¸‹æ–‡æ¥è¿‘é™åˆ¶                                             â”‚
â”‚                                                             â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  ä¸Šä¸‹æ–‡çš„75%         â”‚
â”‚                              â†‘                              â”‚
â”‚                    è¶…è¿‡è½¯é˜ˆå€¼                               â”‚
â”‚                    (contextWindow - reserve - softThreshold)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é™é»˜è®°å¿†åˆ·æ–°è½®æ¬¡                                           â”‚
â”‚                                                             â”‚
â”‚  ç³»ç»Ÿï¼š"é¢„å‹ç¼©è®°å¿†åˆ·æ–°ã€‚ç°åœ¨å­˜å‚¨æŒä¹…çš„                      â”‚
â”‚          è®°å¿†ï¼ˆä½¿ç”¨ memory/YYYY-MM-DD.mdï¼‰ã€‚                â”‚
â”‚          å¦‚æœæ²¡æœ‰è¦å­˜å‚¨çš„ï¼Œå›å¤ NO_REPLYã€‚"                 â”‚
â”‚                                                             â”‚
â”‚  Agentï¼šå®¡æŸ¥å¯¹è¯ä¸­çš„é‡è¦ä¿¡æ¯                                â”‚
â”‚         å°†å…³é”®å†³ç­–/äº‹å®å†™å…¥è®°å¿†æ–‡ä»¶                         â”‚
â”‚         -&gt; NO_REPLYï¼ˆç”¨æˆ·çœ‹ä¸åˆ°ä»»ä½•å†…å®¹ï¼‰                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®‰å…¨è¿›è¡Œå‹ç¼©                                               â”‚
â”‚                                                             â”‚
â”‚  é‡è¦ä¿¡æ¯ç°åœ¨å·²åœ¨ç£ç›˜ä¸Š                                     â”‚
â”‚  å‹ç¼©å¯ä»¥åœ¨ä¸ä¸¢å¤±çŸ¥è¯†çš„æƒ…å†µä¸‹è¿›è¡Œ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><p>è®°å¿†åˆ·æ–°å¯ä»¥åœ¨clawdbot.yamlæ–‡ä»¶æˆ–clawdbot.jsonæ–‡ä»¶ä¸­é…ç½®ã€‚</p><pre><code class="json">{
  "agents": {
    "defaults": {
      "compaction": {
        "reserveTokensFloor": 20000,
        "memoryFlush": {
          "enabled": true,
          "softThresholdTokens": 4000,
          "systemPrompt": "ä¼šè¯æ¥è¿‘å‹ç¼©ã€‚ç°åœ¨å­˜å‚¨æŒä¹…çš„è®°å¿†ã€‚",
          "prompt": "å°†æŒä¹…çš„ç¬”è®°å†™å…¥ memory/YYYY-MM-DD.mdï¼›å¦‚æœæ²¡æœ‰è¦å­˜å‚¨çš„ï¼Œå›å¤ NO_REPLYã€‚"
        }
      }
    }
  }
}</code></pre><h2>å‰ªæ</h2><p>å·¥å…·ç»“æœå¯èƒ½éå¸¸åºå¤§ã€‚å•ä¸ªexecå‘½ä»¤å¯èƒ½è¾“å‡º5ä¸‡ä¸ªå­—ç¬¦çš„æ—¥å¿—ã€‚å‰ªæä¼šä¿®å‰ªè¿™äº›æ—§è¾“å‡ºï¼Œè€Œä¸é‡å†™å†å²ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰æŸè¿‡ç¨‹ï¼Œæ—§è¾“å‡ºæ— æ³•æ¢å¤ã€‚</p><pre><code class="text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ªæå‰ï¼ˆå†…å­˜ä¸­ï¼‰                                           â”‚
â”‚                                                             â”‚
â”‚  å·¥å…·ç»“æœï¼ˆexecï¼‰ï¼š[5ä¸‡ä¸ªå­—ç¬¦çš„npm installè¾“å‡º]               â”‚
â”‚  å·¥å…·ç»“æœï¼ˆreadï¼‰ï¼š[å¤§å‹é…ç½®æ–‡ä»¶ï¼Œ1ä¸‡ä¸ªå­—ç¬¦]                  â”‚
â”‚  å·¥å…·ç»“æœï¼ˆexecï¼‰ï¼š[æ„å»ºæ—¥å¿—ï¼Œ3ä¸‡ä¸ªå­—ç¬¦]                      â”‚
â”‚  ç”¨æˆ·ï¼š"æ„å»ºæˆåŠŸäº†å—ï¼Ÿ"                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼ ï¼ˆè½¯ä¿®å‰ª + ç¡¬æ¸…é™¤ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ªæåï¼ˆå‘é€ç»™æ¨¡å‹ï¼‰                                       â”‚
â”‚                                                             â”‚
â”‚  å·¥å…·ç»“æœï¼ˆexecï¼‰ï¼š"npm WARN deprecated...[å·²æˆªæ–­]           â”‚
â”‚                       ...æˆåŠŸå®‰è£…ã€‚"                        â”‚
â”‚  å·¥å…·ç»“æœï¼ˆreadï¼‰ï¼š"[æ—§å·¥å…·ç»“æœå†…å®¹å·²æ¸…é™¤]"                   â”‚
â”‚  å·¥å…·ç»“æœï¼ˆexecï¼‰ï¼š[ä¿ç•™ - å¤ªæ–°ï¼Œä¸é€‚åˆå‰ªæ]                  â”‚
â”‚  ç”¨æˆ·ï¼š"æ„å»ºæˆåŠŸäº†å—ï¼Ÿ"                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><p>ç£ç›˜ä¸Šçš„JSONLæ–‡ä»¶ï¼šä¿æŒä¸å˜ï¼ˆå®Œæ•´è¾“å‡ºä»ç„¶åœ¨é‚£é‡Œï¼‰</p><h3>ç¼“å­˜TTLå‰ªæ</h3><p>Anthropicä¼šå¯¹æç¤ºè¯å‰ç¼€è¿›è¡Œæœ€å¤š5åˆ†é’Ÿçš„ç¼“å­˜ï¼Œä»¥å‡å°‘é‡å¤è°ƒç”¨çš„å»¶è¿Ÿå’Œæˆæœ¬ã€‚å½“ç›¸åŒçš„æç¤ºè¯å‰ç¼€åœ¨TTLçª—å£å†…å‘é€æ—¶ï¼Œç¼“å­˜çš„tokenæˆæœ¬é™ä½çº¦90%ã€‚TTLè¿‡æœŸåï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚å¿…é¡»é‡æ–°ç¼“å­˜æ•´ä¸ªæç¤ºè¯ã€‚</p><p>é—®é¢˜ï¼šå¦‚æœä¼šè¯åœ¨TTLä¹‹åé—²ç½®ï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚ä¼šå¤±å»ç¼“å­˜ï¼Œå¿…é¡»ä»¥å®Œæ•´çš„"ç¼“å­˜å†™å…¥"ä»·æ ¼é‡æ–°ç¼“å­˜å®Œæ•´çš„å¯¹è¯å†å²ã€‚</p><p>ç¼“å­˜TTLå‰ªæé€šè¿‡åœ¨ç¼“å­˜è¿‡æœŸåæ£€æµ‹å¹¶ä¿®å‰ªæ—§å·¥å…·ç»“æœæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ›´å°çš„æç¤ºè¯é‡æ–°ç¼“å­˜æ„å‘³ç€æ›´ä½çš„æˆæœ¬ï¼š</p><pre><code class="json">{
  "agent": {
    "contextPruning": {
      "mode": "cache-ttl",
      "ttl": "600",
      "keepLastAssistants": 3,
      "softTrim": {
        "maxChars": 4000,
        "headChars": 1500,
        "tailChars": 1500
      },
      "hardClear": {
        "enabled": true,
        "placeholder": "[æ—§å·¥å…·ç»“æœå†…å®¹å·²æ¸…é™¤]"
      }
    }
  }
}</code></pre><h2>ä¼šè¯ç”Ÿå‘½å‘¨æœŸ</h2><p>ä¼šè¯ä¸ä¼šæ°¸è¿œæŒç»­ã€‚å®ƒä»¬æ ¹æ®å¯é…ç½®çš„è§„åˆ™è¿›è¡Œé‡ç½®ï¼Œä¸ºè®°å¿†åˆ›å»ºè‡ªç„¶çš„è¾¹ç•Œã€‚é»˜è®¤è¡Œä¸ºæ˜¯æ¯å¤©é‡ç½®ã€‚ä½†ä¹Ÿæœ‰å…¶ä»–æ¨¡å¼å¯ç”¨ã€‚</p><h3>ä¼šè¯è®°å¿†é’©å­</h3><p>å½“ä½ è¿è¡Œ /new å¼€å§‹ä¸€ä¸ªæ–°ä¼šè¯æ—¶ï¼Œä¼šè¯è®°å¿†é’©å­å¯ä»¥è‡ªåŠ¨ä¿å­˜ä¸Šä¸‹æ–‡ï¼š</p><pre><code class="text">/new
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è§¦å‘ä¼šè¯è®°å¿†é’©å­                                           â”‚
â”‚                                                             â”‚
â”‚  1. ä»ç»“æŸä¼šè¯ä¸­æå–æœ€å15æ¡æ¶ˆæ¯                            â”‚
â”‚  2. é€šè¿‡LLMç”Ÿæˆæè¿°æ€§slug                                   â”‚
â”‚  3. ä¿å­˜åˆ° ~/clawd/memory/2026-01-26-api-design.md          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–°ä¼šè¯å¼€å§‹                                                 â”‚
â”‚                                                             â”‚
â”‚  ä¹‹å‰çš„ä¸Šä¸‹æ–‡ç°åœ¨å¯ä»¥é€šè¿‡ memory_search æœç´¢                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><h2>æ€»ç»“</h2><p>Clawdbotçš„è®°å¿†ç³»ç»Ÿä¹‹æ‰€ä»¥æˆåŠŸï¼Œæ˜¯å› ä¸ºå®ƒéµå¾ªäº†å‡ ä¸ªå…³é”®åŸåˆ™ï¼š</p><p><strong>1. é€æ˜ä¼˜äºé»‘ç›’</strong></p><p>è®°å¿†æ˜¯çº¯Markdownã€‚ä½ å¯ä»¥é˜…è¯»ã€ç¼–è¾‘ã€ç‰ˆæœ¬æ§åˆ¶å®ƒã€‚æ²¡æœ‰ä¸é€æ˜æ•°æ®åº“æˆ–ä¸“æœ‰æ ¼å¼ã€‚</p><p><strong>2. æœç´¢ä¼˜äºæ³¨å…¥</strong></p><p>ä¸å…¶ç”¨æ‰€æœ‰å†…å®¹å¡æ»¡ä¸Šä¸‹æ–‡ï¼Œä¸å¦‚è®©Agentæœç´¢ç›¸å…³å†…å®¹ã€‚è¿™ä¿æŒä¸Šä¸‹æ–‡èšç„¦å¹¶é™ä½æˆæœ¬ã€‚</p><p><strong>3. æŒä¹…ä¼˜äºä¼šè¯</strong></p><p>é‡è¦ä¿¡æ¯ä½œä¸ºæ–‡ä»¶ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œè€Œä¸ä»…ä»…å­˜åœ¨äºå¯¹è¯å†å²ä¸­ã€‚å‹ç¼©æ— æ³•æ‘§æ¯å·²ç»ä¿å­˜çš„å†…å®¹ã€‚</p><p><strong>4. æ··åˆä¼˜äºå•ä¸€</strong></p><p>çº¯å‘é‡æœç´¢ä¼šæ¼æ‰ç²¾ç¡®åŒ¹é…ã€‚çº¯å…³é”®è¯æœç´¢ä¼šæ¼æ‰è¯­ä¹‰ã€‚æ··åˆæœç´¢ä¸¤è€…å…¼å¾—ã€‚</p><h2>å‚è€ƒèµ„æ–™</h2><ul><li>Clawdbotæ–‡æ¡£(<a href="https://link.segmentfault.com/?enc=7mP38nsEGze6A6ZCGvDu%2BQ%3D%3D.e%2FZa12nLC9F0Qifr9tfC7uvsgjNnZD4mq6fMgMqmvvQ%3D" rel="nofollow" target="_blank">https://docs.clawd.bot/</a>) - å®˜æ–¹æ–‡æ¡£ï¼Œæ¶µç›–è®¾ç½®ã€é…ç½®å’Œæ‰€æœ‰åŠŸèƒ½</li><li>GitHubä»“åº“(<a href="https://link.segmentfault.com/?enc=08wlLJsR%2B69mp6pVDw%2FGyQ%3D%3D.n3RMiX%2BwbFXvqptIBn5iPIXd2a9MhMJyJ40JKDItzCFwETvG1pqmB6mh6oHjhfjW" rel="nofollow" target="_blank">https://github.com/clawdbot/clawdbot</a>) - æºä»£ç ã€é—®é¢˜å’Œç¤¾åŒºè´¡çŒ®</li></ul><p>æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœå¯¹Vibe Codingå’ŒAgentå¼€å‘æ„Ÿå…´è¶£ï¼Œä¹Ÿå¯ä»¥<a href="https://link.segmentfault.com/?enc=f7uRkI9Pb8IHCnTslzXRBQ%3D%3D.98aus2Bcgd8yhXqYY0lh%2BUK1P0UQNI3P0NuuJxuWGLk%3D" rel="nofollow" target="_blank">å…³æ³¨æˆ‘çš„åšå®¢ï¼šç¨‹åºçŒ¿DD</a></p>]]></description></item>  </channel></rss>